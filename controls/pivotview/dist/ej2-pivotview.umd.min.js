!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("@syncfusion/ej2-base"),require("@syncfusion/ej2-data"),require("@syncfusion/ej2-popups"),require("@syncfusion/ej2-grids"),require("@syncfusion/ej2-excel-export"),require("@syncfusion/ej2-pdf-export"),require("@syncfusion/ej2-navigations"),require("@syncfusion/ej2-inputs"),require("@syncfusion/ej2-dropdowns"),require("@syncfusion/ej2-calendars"),require("@syncfusion/ej2-buttons")):"function"==typeof define&&define.amd?define(["exports","@syncfusion/ej2-base","@syncfusion/ej2-data","@syncfusion/ej2-popups","@syncfusion/ej2-grids","@syncfusion/ej2-excel-export","@syncfusion/ej2-pdf-export","@syncfusion/ej2-navigations","@syncfusion/ej2-inputs","@syncfusion/ej2-dropdowns","@syncfusion/ej2-calendars","@syncfusion/ej2-buttons"],t):t(e.ej={},e.ej2Base,e.ej2Data,e.ej2Popups,e.ej2Grids,e.ej2ExcelExport,e.ej2PdfExport,e.ej2Navigations,e.ej2Inputs,e.ej2Dropdowns,e.ej2Calendars,e.ej2Buttons)}(this,function(e,t,i,r,a,n,o,l,s,d,p,h){"use strict";var u=function(){function e(){}return e.getType=function(e){return e&&e.getDay?e.getHours()>0||e.getMinutes()>0||e.getSeconds()>0||e.getMilliseconds()>0?"datetime":"date":typeof e},e.resetTime=function(e){return e.setHours(0,0,0,0),e},e}(),c=function(){function e(e,i,r,a,n,o){this.formatFields={},this.calculatedFields={},this.calculatedFormulas={},this.valueAxis=0,this.saveDataHeaders={},this.columnCount=0,this.rowCount=0,this.colFirstLvl=0,this.rowFirstLvl=0,this.rowStartPos=0,this.colStartPos=0,this.enableValueSorting=!1,this.headerCollection={rowHeaders:[],columnHeaders:[],rowHeadersCount:0,columnHeadersCount:0},this.valueMatrix=[],this.indexMatrix=[],this.rMembers=[],this.cMembers=[],this.memberCnt=-1,this.pageInLimit=!1,this.endPos=0,this.removeCount=0,this.colHdrBufferCalculated=!1,this.colValuesLength=1,this.rowValuesLength=1,this.slicedHeaders=[],this.fieldFilterMem={},this.filterPosObj={},this.selectedHeaders={selectedHeader:[],values:[]},this.rawIndexObject={},this.isEditing=!1;var l;return this.globalize=new t.Internationalization,this.enableSort=e.enableSorting,this.showSubTotals=!!t.isNullOrUndefined(e.showSubTotals)||e.showSubTotals,this.showRowSubTotals=!!t.isNullOrUndefined(e.showRowSubTotals)||e.showRowSubTotals,this.showColumnSubTotals=!!t.isNullOrUndefined(e.showColumnSubTotals)||e.showColumnSubTotals,this.showGrandTotals=!!t.isNullOrUndefined(e.showGrandTotals)||e.showGrandTotals,this.showRowGrandTotals=!!t.isNullOrUndefined(e.showRowGrandTotals)||e.showRowGrandTotals,this.showColumnGrandTotals=!!t.isNullOrUndefined(e.showColumnGrandTotals)||e.showColumnGrandTotals,this.allowValueFilter=e.allowValueFilter,this.isValueFilterEnabled=!1,this.enableValueSorting=n,l=e.data[0],this.fields=Object.keys(l),this.rows=e.rows?e.rows:[],this.columns=e.columns?e.columns:[],this.filters=e.filters?e.filters:[],this.formats=e.formatSettings?e.formatSettings:[],this.values=e.values?e.values:[],this.calculatedFieldSettings=e.calculatedFieldSettings?e.calculatedFieldSettings:[],this.enableSort=void 0===e.enableSorting||e.enableSorting,this.validateFilters(e),this.isExpandAll=!(!this.isValueFiltersAvail||!e.allowValueFilter)||e.expandAll,this.drilledMembers=e.drilledMembers?this.isValueFiltersAvail&&e.allowValueFilter?[]:e.drilledMembers:[],this.isMutiMeasures=this.values.length>1,this.valueAxis="row"===e.valueAxis?1:0,this.rowValuesLength=1===this.valueAxis?this.values.length:1,this.colValuesLength=0===this.valueAxis?this.values.length:1,this.valueSortSettings=e.valueSortSettings||{sortOrder:"None",headerDelimiter:".",headerText:"",columnIndex:void 0},this.valueSortData=[],this.savedFieldList=r,this.isDrillThrough=o||!1,this.getFieldList(l,this.enableSort,e.allowValueFilter),this.fillFieldMembers(e.data,this.indexMatrix),this.updateSortSettings(e.sortSettings,this.enableSort),this.pageSettings=a||this.pageSettings,this.valueMatrix=this.generateValueMatrix(e.data),this.filterMembers=[],this.updateFilterMembers(e),this.generateGridData(e),this}return e.prototype.getFormattedFields=function(e){for(var t=this.formats.length;t--;)this.formatFields[this.formats[t].name]=this.formats[t]},e.prototype.getFieldList=function(e,i,r){var a,n=this.fields,o=t.extend([],this.rows,null,!0);o=o.concat(this.columns,this.values,this.filters),this.getFormattedFields(o),this.getCalculatedField(n);var l=n.length;if(this.savedFieldList)for(this.fieldList=this.savedFieldList;l--;){var s=n[l];this.fieldList[s]?(this.fieldList[s].isSelected=!1,this.fieldList[s].index=l,this.fieldList[s].filter=[],this.fieldList[s].isExcelFilter=!1,this.fieldList[s].filterType="",this.isValueFiltersAvail&&r&&(this.fieldList[s].dateMember=[],this.fieldList[s].formattedMembers={},this.fieldList[s].members={})):this.fieldList[s]={id:s,caption:s,type:void 0===a||"undefined"===a?"number":a,filterType:"",index:l,filter:[],sort:i?"Ascending":"None",isSelected:!1}}else for(;l--;){s=n[l];a=u.getType(e[s]),this.fieldList||(this.fieldList={}),this.fieldList[s]={id:s,caption:s,type:void 0===a||"undefined"===a?"number":a,filterType:"",index:l,filter:[],sort:i?"Ascending":"None",isSelected:!1}}this.updateTreeViewData(o)},e.prototype.updateFieldList=function(e){for(var t=this.fields,i=t.length;i--;)this.fieldList[t[i]].isExcelFilter=e[t[i]].isExcelFilter},e.prototype.updateTreeViewData=function(e){for(var t=e.length,i=this.calculatedFieldSettings.length;t--;)if(this.fieldList[e[t].name]){var r=this.fieldList[e[t].name];r.caption=e[t].caption?e[t].caption:e[t].name,r.isSelected=!0,r.showNoDataItems=e[t].showNoDataItems,r.aggregateType=e[t].type,r.baseField=e[t].baseField,r.baseItem=e[t].baseItem}for(;i--;)this.fieldList[this.calculatedFieldSettings[i].name].aggregateType="CalculatedField",this.fieldList[this.calculatedFieldSettings[i].name].formula=this.calculatedFieldSettings[i].formula},e.prototype.getCalculatedField=function(e){for(var i=0,r=this.calculatedFieldSettings;i<r.length;i++){var a=r[i];this.calculatedFields[a.name]=t.extend({},a,null,!0),this.calculatedFields[a.name].actualFormula=a.formula}for(var n=Object.keys(this.calculatedFields),o=0,l=n.length;o<l;o++){var s=(a=this.calculatedFields[n[o]]).properties,d=(s?s.formula:a.formula).replace(/ +/g,""),p=d.replace(/"/g,"");a.formula=p.indexOf("^")>-1?this.powerFunction(p):p,a.name=s?s.name:a.name,e.push(a.name);for(var h=d.split('"'),u=0,c=h.length;u<c;u++){var m=h[u],g=m.split(/[ .:;?!~,`"&|()<>{}\[\]\r\n/\\]+/),v="DistinctCount"===g[0]?"DistinctCount":"PopulationStDev"===g[0]?"PopulationStDev":"SampleStDev"===g[0]?"SampleStDev":"PopulationVar"===g[0]?"PopulationVar":"SampleVar"===g[0]?"SampleVar":g[0];if(-1!==["Sum","Count","Min","Max","Avg","Product","DistinctCount","PopulationStDev","SampleStDev","PopulationVar","SampleVar"].indexOf(v)){var f=e.indexOf(g[1]);this.calculatedFormulas[a.name]?this.calculatedFormulas[a.name].push({index:f,type:v,formula:m}):this.calculatedFormulas[a.name]=[{index:f,type:v,formula:m}]}}}},e.prototype.validateFilters=function(e){this.isValueFiltersAvail=!1;var i=e.filterSettings?e.filterSettings:[],r=t.extend([],this.rows,null,!0);r=r.concat(this.columns);for(var a=0,n=i;a<n.length;a++){for(var o=n[a],l=0,s=r;l<s.length;l++){var d=s[l];if(o.name===d.name&&"Value"===o.type){this.isValueFiltersAvail=!0;break}}if(this.isValueFiltersAvail)break}},e.prototype.fillFieldMembers=function(e,i){for(var r=this.fields,a=e.length,n=this.fieldList,o=r.length,l=0;l<o;l++){var s=r[l];n[s].members||(n[s].members={}),n[s].formattedMembers||(n[s].formattedMembers={}),n[s].dateMember||(n[s].dateMember=[]);for(var d=n[s].members,p=Object.keys(d).length>0,h=n[s].formattedMembers,u=n[s].dateMember,c=0,m=0,g=0;g<a;g++){var v=e[g][s];if(!t.isNullOrUndefined(v)){if(!p){var f=v,y=this.getFormattedValue(v,s);y.formattedText&&(f=y.formattedText),d.hasOwnProperty(v)?d[v].index.push(g):(c++,d[v]={index:[g],ordinal:c,isDrilled:!!this.isExpandAll},u.push({formattedText:y.formattedText,actualText:y.actualText})),h.hasOwnProperty(f)?h[f].index.push(g):(m++,h[f]={index:[g],ordinal:m,isDrilled:!!this.isExpandAll})}i[g]?i[g][l]=d[v].ordinal:(i[g]=[],i[g][l]=d[v].ordinal)}}}this.fillDrilledInfo()},e.prototype.fillDrilledInfo=function(){for(var e=0;e<this.drilledMembers.length;e++)for(var t=this.drilledMembers[e].name,i=0;i<this.drilledMembers[e].items.length;i++){var r=this.drilledMembers[e].items[i],a=this.fieldList[t];a&&a.members[r]&&(a.members[r].isDrilled=!this.isExpandAll)}},e.prototype.generateValueMatrix=function(e){for(var t=this.fields,i=e.length,r=[],a=t.length,n=this.fieldList;i--;){e[i];var o=a;for(r[i]=[];o--;){var l=t[o];r[i][o]="number"===n[l].type?e[i][l]:1}}return r},e.prototype.updateSortSettings=function(e,t){for(var i=0,r=e?e.length:0;i<r&&t;i++)this.fieldList[e[i].name].sort=e[i].order},e.prototype.updateFilterMembers=function(e){var t=this.filterMembers,i={},r=this.getFilters(e,i),a=this.indexMatrix.length;if(r)for(var n=i.include.index,o=0;o<n.length;o++)void 0!==i.exclude&&void 0!==i.exclude.indexObject[n[o]]||t.push(n[o]);else for(o=0;o<a;o++)void 0!==i.exclude&&void 0!==i.exclude.indexObject[o]||t.push(o)},e.prototype.getFilters=function(e,t){for(var i=e.filterSettings?e.filterSettings:[],r=(this.filters,!1),a=[],n=0,o=i.length;n<o;n++){var l=i[n].properties?i[n].properties:i[n];this.fieldList[l.name].isSelected&&this.isValidFilterField(l,e.allowLabelFilter)&&(this.applyLabelFilter(l),a=l?l.items:[],l.type&&"Include"===l.type?(this.frameFilterList(a,l.name,t,"include",l.showLabelFilter,r),r=!0):this.frameFilterList(a,l.name,t,"exclude",l.showLabelFilter),l.showLabelFilter&&(l.items=[],l.type=l.showDateFilter?"Date":l.showNumberFilter?"Number":"Label"))}return r},e.prototype.isValidFilterField=function(e,i){var r=!1,a=t.extend([],this.rows,null,!0);if(a=a.concat(this.columns),this.fieldList[e.name].isSelected&&["Include","Exclude"].indexOf(e.type)>=0){for(var n=!1,o=0,l=this.values;o<l.length;o++){var s=l[o];if(e.name===s.name){n=!0;break}}n||(r=!0)}else for(var d=0,p=a;d<p.length;d++){s=p[d];if(e.name===s.name&&i&&["Label","Date","Number"].indexOf(e.type)>=0){r=!0;break}}return r},e.prototype.applyLabelFilter=function(e){if(["Label","Date","Number"].indexOf(e.type)>=0){var t=Object.keys(this.fieldList[e.name].members);if(e.showLabelFilter=!0,"Label"===e.type)e.items=this.getLabelFilterMembers(t,e.condition,e.value1,e.value2);else if("Date"===e.type)e.showDateFilter=!0,e.items=this.getDateFilterMembers(t,e.name,e.condition,e.value1,e.value2);else{e.showNumberFilter=!0,e.items=[];for(var i=0,r=t;i<r.length;i++){var a=r[i],n=this.getParsedValue(e.name,e.value1),o=this.getParsedValue(e.name,e.value2);this.validateFilterValue(parseInt(a,10),e.condition,n,o)&&e.items.push(a)}}e.type=["DoesNotBeginWith","DoesNotContains","DoesNotEndsWith","DoesNotEquals","NotBetween"].indexOf(e.condition)>-1&&!e.showNumberFilter?"Exclude":"Include"}else e.showLabelFilter=!1},e.prototype.getLabelFilterMembers=function(e,t,i,r){for(var a=[],n=0,o=e;n<o.length;n++){var l=o[n],s=l.toLowerCase();if(i.toString())switch(t){case"Equals":case"DoesNotEquals":s===i.toLowerCase()&&a.push(l);break;case"BeginWith":case"DoesNotBeginWith":0===s.indexOf(i.toLowerCase())&&a.push(l);break;case"EndsWith":case"DoesNotEndsWith":null!=s.match(i.toLowerCase()+"$")&&a.push(l);break;case"Contains":case"DoesNotContains":s.indexOf(i.toLowerCase())>-1&&a.push(l);break;case"GreaterThan":s>i.toLowerCase()&&a.push(l);break;case"GreaterThanOrEqualTo":s>=i.toLowerCase()&&a.push(l);break;case"LessThan":s<i.toLowerCase()&&a.push(l);break;case"LessThanOrEqualTo":s<=i.toLowerCase()&&a.push(l);break;case"Between":case"NotBetween":s>=i.toLowerCase()&&s<=r.toLowerCase()&&a.push(l)}}return a},e.prototype.getDateFilterMembers=function(e,t,i,r,a){for(var n=[],o=0,l=e;o<l.length;o++){var s=l[o],d=new Date(s);if(r)switch(i){case"Equals":case"DoesNotEquals":u.resetTime(d).getTime()===u.resetTime(r).getTime()&&n.push(this.getFormattedValue(s,t).formattedText);break;case"After":u.resetTime(d).getTime()>u.resetTime(r).getTime()&&n.push(this.getFormattedValue(s,t).formattedText);break;case"AfterOrEqualTo":u.resetTime(d).getTime()>=u.resetTime(r).getTime()&&n.push(this.getFormattedValue(s,t).formattedText);break;case"Before":u.resetTime(d).getTime()<u.resetTime(r).getTime()&&n.push(this.getFormattedValue(s,t).formattedText);break;case"BeforeOrEqualTo":u.resetTime(d).getTime()<=u.resetTime(r).getTime()&&n.push(this.getFormattedValue(s,t).formattedText);break;case"Between":case"NotBetween":u.resetTime(d).getTime()>=u.resetTime(r).getTime()&&u.resetTime(d).getTime()<=u.resetTime(a).getTime()&&n.push(this.getFormattedValue(s,t).formattedText)}}return n},e.prototype.validateFilterValue=function(e,t,i,r){var a=!1;if("number"==typeof i)switch(t){case"Equals":e===i&&(a=!0);break;case"DoesNotEquals":e!==i&&(a=!0);break;case"GreaterThan":e>i&&(a=!0);break;case"GreaterThanOrEqualTo":e>=i&&(a=!0);break;case"LessThan":e<i&&(a=!0);break;case"LessThanOrEqualTo":e<=i&&(a=!0);break;case"Between":e>=i&&e<=r&&(a=!0);break;case"NotBetween":e>=i&&e<=r||(a=!0)}return a},e.prototype.frameFilterList=function(e,t,i,r,a,n){var o=this,l=function(){var l=0,s=o.fieldList[t];s.filter=e,s.filterType=r,s.isExcelFilter=a;var d=s.formattedMembers,p=n,h={},u={};for(h[r]={indexObject:{},index:[]},o.fieldFilterMem[t]={memberObj:{}};e[l];){var c=d[e[l]].index;if("include"===r)for(var m=0,g=c.length;m<g;m++)p&&void 0===i[r].indexObject[c[m]]||(h[r].indexObject[c[m]]=c[m],h[r].index.push(c[m]));else{for(m=0,g=c.length;m<g;m++)void 0===i[r].indexObject[c[m]]&&(i[r].indexObject[c[m]]=c[m],i[r].index.push(c[m]));o.fieldFilterMem[t].memberObj[e[l]]=e[l]}l++}if("include"===r){i[r]=h[r];for(m=0;m<e.length;m++)u[e[m]]=e[m];var v=Object.keys(d);for(m=0,g=v.length;m<g;m++)void 0===u[v[m]]&&(o.fieldFilterMem[t].memberObj[v[m]]=v[m])}};i[r]?l():(i[r]={indexObject:{},index:[]},l())},e.prototype.applyValueFiltering=function(e,i,r,a,n,o,l){this.isValueFiltered=!1;var s=t.extend({},r[r.length-1],null,!0);return this.getFilteredData(r,a,n,o,i,e.name,s,l),this.isValueFiltered&&(o.push(s),r=o),r},e.prototype.getFilteredData=function(e,i,r,a,n,o,l,s){for(var d=e.length,p=0;p<d;p++)if(r[o])if(e[p].level===n){this.isValueFiltered=!0,this.fieldList[o].isExcelFilter=!0;var h=0,u=r[o].measure,c=this.fieldList[u].index,m=this.fieldList[u].aggregateType;h="row"===s?this.getAggregateValue(e[p].index,i.indexObject,c,m):this.getAggregateValue(i.index,e[p].indexObject,c,m);var g=this.getParsedValue(u,r[o].value1),v=this.getParsedValue(u,r[o].value2);if(this.validateFilterValue(h,r[o].condition,g,v)||"grand sum"===e[p].type)"grand sum"!==e[p].type&&(a.push(t.extend({},e[p],null,!0)),a[a.length-1].isLevelFiltered=!0);else{var f=this.removefilteredData(e[p],this.valueFilteredData),y=f||e[p];this.validateFilteredParentData(y,this.valueFilteredData,l,0,n,s)}}else e[p].hasChild&&e[p].members.length>0&&"grand sum"!==e[p].type&&(a.push(t.extend({},e[p],null,!0)),a[a.length-1].members=[],a[a.length-1].isLevelFiltered=!0,this.getFilteredData(e[p].members,i,r,a[a.length-1].members,n,o,l,s))},e.prototype.getParsedValue=function(e,i){if(this.formatFields[e]&&i){var r=t.extend({},this.formatFields[e],null,!0);return delete r.name,this.globalize.parseNumber(i,r)}return parseInt(i,10)},e.prototype.removefilteredData=function(e,i){for(var r,a=t.extend([],i,null,!0),n=0;n<a.length;n++){if(e.isLevelFiltered&&e.axis===a[n].axis&&e.valueSort.levelName===a[n].valueSort.levelName&&e.actualText===a[n].actualText&&e.axis===a[n].axis&&e.level===a[n].level&&e.ordinal===a[n].ordinal){r=a[n],i.splice(n,1);break}i[n].hasChild&&i[n].members.length>0&&this.removefilteredData(e,i[n].members)}return r},e.prototype.validateFilteredParentData=function(e,t,i,r,a,n){if(t.length>0)for(var o=0,l=t;o<l.length;o++){var s=l[o];if(s.level===r){if("row"===n)for(var d=0,p=u=e.index;d<p.length;d++){var h=p[d];i.index.indexOf(h)>=0&&i.index.splice(i.index.indexOf(h),1),e.valueSort.levelName.toString().indexOf(s.valueSort.levelName.toString())>=0&&s.level!==a&&s.index.indexOf(h)>=0&&s.index.splice(s.index.indexOf(h),1)}else for(var u=e.indexObject,c=0,m=Object.keys(u);c<m.length;c++){h=m[c];u.hasOwnProperty(h)&&(delete i.indexObject[h],e.valueSort.levelName.toString().indexOf(s.valueSort.levelName.toString())>=0&&s.level!==a&&delete s.indexObject[h])}s&&s.members.length>0&&s.members[0].level===r+1&&s.members[0].level!==a&&this.validateFilteredParentData(e,s.members,i,r+1,a,n)}}else if("row"===n)for(var g=0,v=u=e.index;g<v.length;g++){h=v[g];i.index.indexOf(h)>=0&&i.index.splice(i.index.indexOf(h),1)}else{u=e.indexObject;for(var f=0,y=Object.keys(u);f<y.length;f++){h=y[f];u.hasOwnProperty(h)&&delete i.indexObject[h]}}},e.prototype.updateFramedHeaders=function(e,i,r,a,n){for(var o=0,l=e;o<l.length;o++){var s=l[o];this.isHeaderAvail=!1,(this.validateFilteredHeaders(s,r,n)||"grand sum"===s.type)&&("row"===n?this.rowCount+=this.rowValuesLength:this.columnCount+=this.colValuesLength,a.push(t.extend({},s,null,!0)),a[a.length-1].members=[],s.hasChild&&s.isDrilled&&s.members.length>0&&this.updateFramedHeaders(s.members,i,r,a[a.length-1].members,n))}return this.filterFramedHeaders},e.prototype.validateFilteredHeaders=function(e,t,i){for(var r=0,a=t;r<a.length;r++){var n=a[r];if(!this.isHeaderAvail){if(e.actualText===n.actualText&&e.level===n.level&&e.valueSort.levelName===n.valueSort.levelName)return"row"===i?n.index.length>0?(this.isHeaderAvail=!0,e.index=n.index,!0):(this.isHeaderAvail=!1,e.index=n.index,!1):Object.keys(n.indexObject).length>0?(this.isHeaderAvail=!0,e.indexObject=n.indexObject,!0):(this.isHeaderAvail=!1,e.indexObject=n.indexObject,!1);n.hasChild&&n.members.length>0&&"grand sum"!==n.type&&this.validateFilteredHeaders(e,n.members,i)}}return this.isHeaderAvail},e.prototype.isEmptyDataAvail=function(e,t){this.isEmptyData=!1,e.length>0&&"grand sum"===e[e.length-1].type&&0===e[e.length-1].index.length&&(this.isEmptyData=!0),t.length>0&&"grand sum"===t[t.length-1].type&&0===Object.keys(t[t.length-1].indexObject).length&&(this.isEmptyData=!0)},e.prototype.updateGridData=function(e){this.indexMatrix=[];for(var t=0,i=this.fields;t<i.length;t++){var r=i[t];this.fieldList[r].members={},this.fieldList[r].formattedMembers={},this.fieldList[r].dateMember=[]}this.fillFieldMembers(e.data,this.indexMatrix),this.valueMatrix=this.generateValueMatrix(e.data),this.filterMembers=[],this.cMembers=[],this.rMembers=[],this.updateFilterMembers(e),this.isEditing=!0,this.isDrillThrough=!0,this.generateGridData(e),this.isEditing=!1},e.prototype.generateGridData=function(e,i){this.fields;var r=e.columns?e.columns:[],a=e.data,n=e.rows?e.rows:[],o=e.filterSettings,l=e.values?e.values:[];this.removeCount=0,this.isExpandAll=e.expandAll,this.drilledMembers=e.drilledMembers?e.drilledMembers:[],this.isEmptyData=!1;var s=[];if(n[0]&&n[0].showNoDataItems||r[0]&&r[0].showNoDataItems)for(var d=0;d<this.indexMatrix.length;d++)s.push(d);for(d=0;d<this.filterMembers.length;d++)this.filterPosObj[this.filterMembers[d]]=this.filterMembers[d];this.valueSortSettings.columnIndex=void 0;(new Date).getTime();this.isValueFilterEnabled&&!this.isEditing||(i&&!this.enableValueSorting||(this.columnCount=0,this.rowCount=0,this.cMembers=[],this.rMembers=[],0!==n.length&&(this.rMembers=this.getIndexedHeaders(n,a,0,n[0].showNoDataItems?s:this.filterMembers,"row","")),0!==r.length&&(this.cMembers=this.getIndexedHeaders(r,a,0,r[0].showNoDataItems?s:this.filterMembers,"column","")),this.insertAllMembersCommon()),this.saveDataHeaders=this.isValueFiltersAvail&&e.allowValueFilter?{rowHeaders:t.extend([],this.rMembers,null,!0),columnHeaders:t.extend([],this.cMembers,null,!0)}:{}),this.pivotValues=[],this.headerContent=[],this.valueContent=[],this.valueFilteredData=[],this.filterFramedHeaders=[];var p=[],h=[],u=[],c=[],m=this.values.length;if(this.isValueFiltersAvail&&e.allowValueFilter){this.valueFilteredData=[];var g=this.saveDataHeaders.rowHeaders,v=this.saveDataHeaders.columnHeaders;if(o.length>0){for(var f={},y={},b=0,S=l;b<S.length;b++){var C=S[b];y[C.name]=C}for(var w=0,x=o;w<x.length;w++){var D=x[w];g=u.length>0?u:g,v=c.length>0?c:v,this.valueFilteredData=[];var T=D.properties?D.properties:D;if("Value"===T.type&&this.fieldList[D.name].isSelected){f[D.name]=D,T.items=[];for(var E=!1,M=n.length,P=r.length,O=0;O<M;O++)if(T.name===n[O].name&&y[T.measure]&&!E){E=!0,u=this.applyValueFiltering(n[O],O,g,v[v.length-1],f,this.valueFilteredData,"row");break}for(var L=0;L<P;L++)if(T.name===r[L].name&&y[T.measure]&&!E){E=!0,c=this.applyValueFiltering(r[L],L,v,g[g.length-1],f,this.valueFilteredData,"column");break}}}}u=u.length>0?u:g,c=c.length>0?c:v,this.isEmptyDataAvail(u,c);var F=t.extend({},this.fieldList,null,!0);this.indexMatrix=[];var A=e.data[0];this.getFieldList(A,this.enableSort,e.allowValueFilter),this.fillFieldMembers(e.data,this.indexMatrix),this.updateSortSettings(e.sortSettings,this.enableSort),this.valueMatrix=this.generateValueMatrix(e.data),this.filterMembers=[],this.updateFilterMembers(e),this.rMembers=0!==n.length?this.getIndexedHeaders(n,a,0,n[0].showNoDataItems?s:this.filterMembers,"row",""):this.rMembers,this.cMembers=0!==r.length?this.getIndexedHeaders(r,a,0,r[0].showNoDataItems?s:this.filterMembers,"column",""):this.cMembers,this.insertAllMembersCommon(),this.updateFieldList(F),this.rowCount=0,this.columnCount=0,this.rMembers=this.updateFramedHeaders(this.rMembers,this.rMembers,u,this.filterFramedHeaders,"row"),this.filterFramedHeaders=[],this.cMembers=this.updateFramedHeaders(this.cMembers,this.cMembers,c,this.filterFramedHeaders,"column"),this.isValueFilterEnabled=!0}this.applyValueSorting(),this.pageSettings&&(!i||this.enableValueSorting?(this.headerCollection.rowHeaders=t.extend([],this.rMembers,null,!0),this.headerCollection.columnHeaders=t.extend([],this.cMembers,null,!0),this.headerCollection.rowHeadersCount=this.rowCount,this.headerCollection.columnHeadersCount=this.columnCount):(this.rMembers=i.rowHeaders,this.cMembers=i.columnHeaders,this.rowCount=i.rowHeadersCount,this.columnCount=i.columnHeadersCount,(this.columns.length>1||this.rows.length>1||this.allowValueFilter)&&(this.headerCollection=t.extend({},i,null,!0))),this.calculatePagingValues(),this.enableValueSorting&&this.allowValueFilter||(n.length>0&&this.insertPosition(n,a,0,this.filterMembers,"row","",this.rMembers),r.length>0&&this.insertPosition(r,a,0,this.filterMembers,"column","",this.cMembers),this.rMembers=this.insertTotalPosition(this.rMembers),this.cMembers=this.insertTotalPosition(this.cMembers))),this.getAggregatedHeaders(n,r,this.rMembers,this.cMembers,l),this.getHeaderData(this.cMembers,h,this.pivotValues,0,this.valueAxis?1:m),0!==this.removeCount&&this.values.length>0&&(this.columnCount=this.columnCount-this.removeCount*(0===this.valueAxis?this.values.length:1)),this.showGrandTotals&&this.showColumnGrandTotals||!(this.columns.length>0)||(this.columnCount=this.columnCount-1*(0===this.valueAxis?this.values.length:1)),this.insertSubTotals(),this.getTableData(this.rMembers,p,h,0,this.pivotValues,m,this.rMembers[this.rMembers.length-1],this.cMembers[this.cMembers.length-1]),this.applyAdvancedAggregate(p,h,this.pivotValues),this.pageSettings&&this.removeIndexProperties(),this.isEngineUpdated=!0;(new Date).getTime()},e.prototype.applyValueSorting=function(){if(this.valueSortSettings.headerText&&""!==this.valueSortSettings.headerText&&this.values.length>0){for(var e=this.valueSortSettings.headerText.split(this.valueSortSettings.headerDelimiter),t="",i=void 0,r=void 0,a=void 0,n=0;n<this.values.length;n++){if(this.values[n].caption===e[e.length-1]){a=this.values[n].name;break}a=e[e.length-1]}if(this.values.length>1&&a&&this.fieldList[a]){for(n=0;n<e.length-1;n++)t=""===t?e[n]:t+this.valueSortSettings.headerDelimiter+e[n];i=this.fieldList[a].index,r=this.fieldList[a].aggregateType}else t=this.valueSortSettings.headerText,i=this.fieldList[this.values[0].name].index,r=this.fieldList[this.values[0].name].aggregateType;var o=void 0;0===this.valueAxis?(o=this.getMember(this.cMembers,t))&&this.sortByValueRow(this.rMembers,o,this.valueSortSettings.sortOrder,i,r):(o=this.getMember(this.rMembers,t))&&this.sortByValueRow(this.cMembers,o,this.valueSortSettings.sortOrder,i,r)}},e.prototype.getMember=function(e,t){for(var i,r=e.length,a=0;a<r;a++){if(e[a].valueSort.levelName===t){i=e[a];break}if(e[a].members.length>0&&(i=this.getMember(e[a].members,t)),i)return i}return i},e.prototype.sortByValueRow=function(e,t,i,r,a){for(var n=e.length,o=0;o<n;o++){for(var l=o;l<n&&"grand sum"!==e[o].type&&"grand sum"!==e[l].type;l++)if("Descending"===i?this.getAggregateValue(e[o].index,t.indexObject,r,a)<this.getAggregateValue(e[l].index,t.indexObject,r,a):this.getAggregateValue(e[o].index,t.indexObject,r,a)>this.getAggregateValue(e[l].index,t.indexObject,r,a)){var s={};s=e[o],e[o]=e[l],e[l]=s}e[o].members.length>0&&this.sortByValueRow(e[o].members,t,i,r,a)}},e.prototype.insertAllMembersCommon=function(){(!(!this.showGrandTotals||!this.showRowGrandTotals)||!(this.rows.length>0))&&this.insertAllMember(this.rMembers,this.filterMembers,"","row");(!(!this.showGrandTotals||!this.showColumnGrandTotals)||!(this.columns.length>0))&&this.insertAllMember(this.cMembers,this.filterMembers,"","column")},e.prototype.removeIndexProperties=function(){for(var e=0;e<this.headerContent.length;e++)if(this.headerContent[e])for(var t=0;t<Object.keys(this.headerContent[e]).length;t++){var i=Number(Object.keys(this.headerContent[e])[t]);this.headerContent[e][i].index=[],this.headerContent[e][i].indexObject={},this.pivotValues[e][i].index=[],this.pivotValues[e][i].indexObject={}}for(e=this.headerContent.length;e<this.pivotValues.length;e++)this.headerContent[e]&&(this.valueContent[e-this.headerContent.length][0].index=[],this.valueContent[e-this.headerContent.length][0].indexObject={},this.pivotValues[e][0].index=[],this.pivotValues[e][0].indexObject={})},e.prototype.insertSubTotals=function(){for(var e=this.pivotValues.length,i=0;i<e;i++){var r=this.pivotValues[i];if(r)for(var a=void 0,n=1,o=void 0,l=r.length-1;l>0;l--){var s=r[l];if(s){a&&(a.colSpan=n,a.colIndex=a.colIndex-(n-1)),o={index:s.index,indexObject:s.indexObject},s.index=[],s.indexObject={},a=t.extend({},s,null,!0),s.index=o.index,s.indexObject=o.indexObject;for(var d=i+1;this.pivotValues[d]&&!this.pivotValues[d][l];){this.pivotValues[i][l].isDrilled||(this.pivotValues[i][l].rowSpan=d-i+1,a.rowSpan=d-i+1);var p="sum"===s.type||"grand sum"===s.type?s.type:"sum";this.pivotValues[d][l]=this.headerContent[d][l]={type:p,formattedText:"sum"===s.type||"grand sum"===s.type?s.formattedText:s.formattedText+" Total",axis:"column",level:-1,colIndex:l,rowIndex:d,valueSort:s.valueSort},s.valueSort&&s.valueSort[this.valueSortSettings.headerText]&&(this.valueSortSettings.columnIndex=l);var h=!1;"grand sum"===p?(this.pivotValues[i][l].rowSpan=d-i+1,a.rowSpan=d-i+1):"sum"!==this.pivotValues[i][l].type&&this.pivotValues[i][l].isDrilled?(this.pivotValues[i+1][l].rowSpan=d-i,h=!0):this.pivotValues[d][l].rowSpan=-1,d>i+1&&("sum"===this.pivotValues[i][l].type||h)&&(this.pivotValues[d][l].rowSpan=-1),d++}n=1}else r[l]=this.headerContent[i][l]=t.extend({},a,null,!0),r[l].index=this.headerContent[i][l].index=o.index,r[l].indexObject=this.headerContent[i][l].indexObject=o.indexObject,n++,r[l].colSpan=n,r[l].colIndex=r[l].colIndex-(n-1);1===l&&a&&(a.colSpan=n,a.colIndex=a.colIndex-(n-1))}}},e.prototype.getIndexedHeaders=function(e,r,a,n,o,l){var s=[],d=this.enableValueSorting||this.allowValueFilter||!this.pageSettings;if(e){var p=e.length,h={},u=e[a].name,c=e[a],m=this.fieldList[u],g={},v=!1,f=n.length<1&&a>0||c.showNoDataItems,y={};if(f){for(var b=Object.keys(m.members),S=0,C=b.length;S<C;S++)y[b[S]]=b[S];n.length<1&&(v=!0,n.length=b.length)}for(S=0,C=n.length;S<C;S++){var w={};t.isNullOrUndefined(e[a].showSubTotals)||e[a].showSubTotals||(w.showSubTotals=!1),w.hasChild=a<p-1,w.level=a,w.axis=o,w.colSpan=1;var x=v?m.members[Object.keys(y)[0]].ordinal:this.indexMatrix[n[S]][m.index],D=v?Object.keys(y)[0]:r[n[S]][u];if(!t.isNullOrUndefined(D)&&(delete y[D],!f||!this.fieldFilterMem[u]||this.fieldFilterMem[u].memberObj[D]!==D)){w.isDrilled=!!w.hasChild&&m.members[D].isDrilled;var T=this.getFormattedValue(D,u);w.actualText=T.actualText,w.formattedText=T.formattedText;var E=!f||void 0!==this.filterPosObj[n[S]]&&!v;h&&h[x]?E&&(d?(h[x].index.push(n[S]),h[x].indexObject[n[S]]=n[S]):void 0===g[x]?g[x]=[n[S]]:g[x].push(n[S])):(h[x]={index:[],indexObject:{}},w.index=h[x].index,w.indexObject=h[x].indexObject,E&&(d?(w.index=h[x].index=[n[S]],h[x].indexObject[n[S]]=n[S],w.indexObject=h[x].indexObject):g[x]=[n[S]]),w.ordinal=x,w.valueSort={},d&&(w.valueSort.axis=u,0!==a?(w.valueSort.levelName=l+this.valueSortSettings.headerDelimiter+w.formattedText,w.valueSort[l+this.valueSortSettings.headerDelimiter+w.formattedText]=1):(w.valueSort[w.formattedText]=1,w.valueSort.levelName=w.formattedText)),w.members=[],s.push(w)),f&&!v&&a>0&&S+1===n.length&&Object.keys(y).length>0&&(v=!0,C=Object.keys(y).length,S=-1)}}for(var M=0,P=s.length;M<P;M++)if("row"===o?this.rowCount+=this.rowValuesLength:this.columnCount+=this.colValuesLength,p-1>a&&s[M].isDrilled){if(d){var O=null;s[M].valueSort&&s[M].valueSort.levelName&&(O=s[M].valueSort.levelName),l=O||s[M].formattedText}var L=d?s[M].index:g[s[M].ordinal];s[M].members=this.getIndexedHeaders(e,r,a+1,void 0===L?[]:L,o,l)}return this.enableSort?new i.DataManager(s).executeLocal((new i.Query).sortBy("actualText",m.sort.toLowerCase())):s}return s},e.prototype.getOrderedIndex=function(e){for(var t={},i=0;i<e.length;i++)"grand sum"!==e[i].type&&(t[e[i].ordinal]=i);return t},e.prototype.insertPosition=function(e,t,i,r,a,n,o){var l=[],s=this.getOrderedIndex(o);if(e){for(var d={},p=e[i].name,h=this.fieldList[p],u=0,c=r.length;u<c;u++){var m={},g=this.indexMatrix[r[u]][h.index],v=o[s[g]],f=this.getFormattedValue(t[r[u]][p],p);v&&v.formattedText===f.formattedText&&(d&&d[g]?(d[g].index.push(r[u]),d[g].indexObject[r[u]]=r[u]):(d[g]={index:[],indexObject:{}},v.index=d[g].index=[r[u]],d[g].indexObject[r[u]]=r[u],v.indexObject=d[g].indexObject,v.valueSort={},v.valueSort.axis=p,0!==i?(v.valueSort.levelName=n+this.valueSortSettings.headerDelimiter+v.formattedText,v.valueSort[n+this.valueSortSettings.headerDelimiter+v.formattedText]=1):(v.valueSort[v.formattedText]=1,v.valueSort.levelName=v.formattedText),m.members=[],l.push(m)))}for(var y=o.length-l.length;y>0;)l.push({members:[]}),y--;for(var b=0,S=l.length;b<S;b++)if(o[b].members.length>0){var C=null;o[b].valueSort&&o[b].valueSort.levelName&&(C=o[b].valueSort.levelName),n=C||o[b].formattedText,l[b].members=this.insertPosition(e,t,i+1,o[b].index,a,n,o[b].members)}return l}return l},e.prototype.insertTotalPosition=function(e){var t=e[e.length-1];if(t&&"grand sum"===t.type){t.index=this.filterMembers;for(var i=0,r=this.filterMembers.length;i<r;i++)t.indexObject[this.filterMembers[i]]=this.filterMembers[i]}return e},e.prototype.calculatePagingValues=function(){var e=!!("None"!==this.valueSortSettings.sortOrder&&""!==this.valueSortSettings.headerText||this.enableValueSorting);if(this.pageSettings){1===this.valueAxis?this.rowValuesLength=this.values.length:this.colValuesLength=this.values.length,this.memberCnt=-this.rowValuesLength,this.rowStartPos=(this.pageSettings.rowCurrentPage*this.pageSettings.rowSize-this.pageSettings.rowSize)*this.rowValuesLength;var t=this.rowStartPos+3*this.pageSettings.rowSize*this.rowValuesLength>this.rowCount?this.rowCount-3*this.pageSettings.rowSize*this.rowValuesLength:this.rowStartPos;t<0&&(t=this.rowStartPos=0,this.pageSettings.rowCurrentPage=1),this.rowFirstLvl=(this.rowStartPos-t)%this.pageSettings.rowSize,this.rowStartPos=t,this.endPos=this.rowStartPos+3*this.pageSettings.rowSize*this.rowValuesLength,this.endPos=this.endPos>this.rowCount?this.rowCount:this.endPos,this.rMembers=e?this.rMembers:this.performSlicing(this.rMembers,[],this.rowStartPos,"row"),this.memberCnt=-this.colValuesLength,this.pageInLimit=!1,this.colHdrBufferCalculated=!1,this.colStartPos=(this.pageSettings.columnCurrentPage*this.pageSettings.columnSize-this.pageSettings.columnSize)*this.colValuesLength,(t=this.colStartPos+3*this.pageSettings.columnSize*this.colValuesLength>this.columnCount?this.columnCount-3*this.pageSettings.columnSize*this.colValuesLength:this.colStartPos)<0&&(t=this.colStartPos=0,this.pageSettings.columnCurrentPage=1),this.colFirstLvl=(this.colStartPos-t)%this.pageSettings.columnSize,this.colStartPos=t,e||(this.endPos=this.colStartPos+3*this.pageSettings.columnSize*this.colValuesLength,this.endPos=this.endPos>this.columnCount?this.columnCount:this.endPos,this.cMembers=this.performSlicing(this.cMembers,[],this.colStartPos,"column")),this.memberCnt=-1,this.pageInLimit=!1}},e.prototype.performSlicing=function(e,t,i,r){for(var a=0;e[a];){if(this.memberCnt+="column"===r?this.colValuesLength:this.rowValuesLength,i<=this.memberCnt&&this.endPos>=this.memberCnt&&!this.pageInLimit&&("column"===r?this.colFirstLvl=this.colFirstLvl+e[a].level:this.rowFirstLvl=this.rowFirstLvl+e[a].level,this.pageInLimit=!0),this.pageInLimit&&this.endPos<=this.memberCnt){if("column"!==r)break;if(0===e[a].members.length){if(this.colHdrBufferCalculated)break;this.colHdrBufferCalculated=!0,this.endPos+=e[a].level*this.colValuesLength}else if(this.colHdrBufferCalculated)break}var n=e[a].members;if(t.push(e[a]),e[a].members.length>0&&(t[t.length-1].members=[],t[t.length-1].members=this.performSlicing(n,[],i,r)),this.pageInLimit||t.pop(),0===e[a].level&&this.pageInLimit&&this.endPos<=this.memberCnt)break;a++}return t},e.prototype.insertAllMember=function(e,t,i,r){var a=e.length,n=this.enableValueSorting||this.allowValueFilter||!this.pageSettings;if(i=" Total",e[a]={hasChild:!1,index:n?t:[],level:0,axis:r,isDrilled:!1,indexObject:{},members:[],formattedText:"Grand"+i,ordinal:a,type:"grand sum",valueSort:{}},e[a].valueSort[e[a].formattedText]=1,e[a].valueSort.levelName=e[a].formattedText,n)for(var o=0,l=t.length;o<l;o++)e[a].indexObject[t[o]]=t[o];"row"===r?this.rowCount+=this.rowValuesLength:this.columnCount+=this.colValuesLength},e.prototype.getTableData=function(e,i,r,a,n,o,l,s){for(var d=e.length,p=0;p<d;p++){i[a=n.length]=e[p];var h=a-Number(Object.keys(i)[0]),u=!i[a].members.length;if(e[p].colIndex=0,e[p].rowIndex=a,n[a]?n[a][0]=this.valueContent[h][0]=e[p]:(n[a]=[],this.valueContent[h]={},n[a][0]=this.valueContent[h][0]=e[p]),this.valueAxis&&this.isMutiMeasures&&(!e[p].isDrilled||(t.isNullOrUndefined(e[p].showSubTotals)||e[p].showSubTotals)&&this.showSubTotals&&this.showRowSubTotals)){for(var c=a,m=h,g=0;g<o;g++){a++,h++;var v=this.values[g].caption?this.values[g].caption:this.values[g].name,f={axis:"row",actualText:this.values[g].name,formattedText:v,level:0,valueSort:{},colIndex:0,rowIndex:a,type:"value"};n[a]||(n[a]=[],this.valueContent[h]={},n[a][0]=this.valueContent[h][0]=f);var y=n[a][0].valueSort;y[n[a-g-1][0].valueSort.levelName+this.valueSortSettings.headerDelimiter+v]=1,y.levelName=n[a-g-1][0].valueSort.levelName+this.valueSortSettings.headerDelimiter+v;for(var b=0,S=1,C=r.length;b<C;++b)this.updateRowData(e,r,a,n,g,p,b,S,h,l,s),S=n[a].length,n[c][S-1]=this.valueContent[m][S-1]={axis:"value",actualText:"",colSpan:1,colIndex:S,formattedText:"",hasChild:!1}}this.recursiveRowData(e,i,r,a,n,o,u,p,o,l,s)}else{for(b=0,S=1,C=r.length;b<C;++b)for(g=0;g<o;g++)this.updateRowData(e,r,a,n,g,p,b,S,h,l,s),S=n[a].length;this.recursiveRowData(e,i,r,a,n,o,u,p,0,l,s)}}},e.prototype.getAggregatedHeaders=function(e,t,i,r,a){this.selectedHeaders={selectedHeader:[],values:[]};for(var n=a.length,o=0;o<n;o++)switch(a[o].type){case"DifferenceFrom":case"PercentageOfDifferenceFrom":var l=void 0,s=void 0;this.selectedHeaders.values.push(a[o].name),a[o].baseField&&a[o].baseItem?(l=a[o].baseField,s=a[o].baseItem):this.valueAxis&&this.isMutiMeasures&&t.length>0?(l=t[0].name,s=Object.keys(this.fieldList[t[0].name].members)[0]):e.length>0&&(l=e[0].name,s=Object.keys(this.fieldList[e[0].name].members)[0]);for(var d=!1,p=0,h=e;p<h.length;p++){if(h[p].name===l){this.getAggregatedHeaderData(i,a[o].name,s,!1,"row",a[o].type,this.selectedHeaders.selectedHeader,o),d=!0;break}}if(!d)for(var u=0,c=t;u<c.length;u++){if(c[u].name===l){this.getAggregatedHeaderData(r,a[o].name,s,!1,"column",a[o].type,this.selectedHeaders.selectedHeader,o);break}}break;case"PercentageOfParentRowTotal":case"PercentageOfParentColumnTotal":this.selectedHeaders.values.push(a[o].name),this.getAggregatedHeaderData("PercentageOfParentRowTotal"===a[o].type?i:r,a[o].name,void 0,!1,"PercentageOfParentRowTotal"===a[o].type?"row":"column",a[o].type,this.selectedHeaders.selectedHeader,o);break;case"RunningTotals":this.selectedHeaders.values.push(a[o].name),this.getAggregatedHeaderData(this.valueAxis&&this.isMutiMeasures?r:i,a[o].name,void 0,!1,this.valueAxis&&this.isMutiMeasures?"column":"row",a[o].type,this.selectedHeaders.selectedHeader,o);break;case"PercentageOfParentTotal":l=void 0;this.selectedHeaders.values.push(a[o].name),a[o].baseField?l=a[o].baseField:this.valueAxis&&this.isMutiMeasures&&t.length>0?l=t[0].name:e.length>0&&(l=e[0].name);d=!1;for(var m=e.length,g=0;g<m;g++)if(e[g].name===l){this.getAggregatedHeaderData(i,a[o].name,void 0,!1,"row",a[o].type,this.selectedHeaders.selectedHeader,o,g),d=!0;break}if(!d)for(m=t.length,g=0;g<m;g++)if(t[g].name===l){this.getAggregatedHeaderData(r,a[o].name,void 0,!1,"column",a[o].type,this.selectedHeaders.selectedHeader,o,g);break}}},e.prototype.getAggregatedHeaderData=function(e,i,r,a,n,o,l,s,d){for(var p=0,h=e;p<h.length;p++){var u=h[p];switch(o){case"DifferenceFrom":case"PercentageOfDifferenceFrom":-1!==u.valueSort.levelName.toString().split(".").indexOf(r)?(l.push(this.updateSelectedHeaders(r,u.level,n,a,i,o,u.valueSort.levelName,a?[u]:e,s+1)),u.members.length>0&&this.getAggregatedHeaderData(u.members,i,r,!0,n,o,l[l.length-1].childMembers,s)):u.members.length>0&&this.getAggregatedHeaderData(u.members,i,r,!1,n,o,l,s);break;case"RunningTotals":case"PercentageOfParentRowTotal":case"PercentageOfParentColumnTotal":"grand sum"===u.type?l.push(this.updateSelectedHeaders(void 0,u.level,n,!1,i,o,u.valueSort.levelName,e,s+1)):u.members.length>0&&(l.push(this.updateSelectedHeaders(void 0,u.level,n,!1,i,o,u.valueSort.levelName,u.members,s+1)),this.getAggregatedHeaderData(u.members,i,void 0,!1,n,o,l,s));break;case"PercentageOfParentTotal":if("grand sum"!==u.type)if(u.level===d)if(u.members.length>0){if(a)for(var c=l[l.length-1].aggregateHeaders,m=0,g=u.members;m<g.length;m++){var v=g[m];c.push(v)}else{var f=t.extend([],u.members,null,!0);l.push(this.updateSelectedHeaders(void 0,u.level,n,!1,i,o,u.valueSort.levelName,f,s+1));(c=l[l.length-1].aggregateHeaders).push(u)}this.getAggregatedHeaderData(u.members,i,void 0,!0,n,o,l,s,d+1)}else a||l.push(this.updateSelectedHeaders(void 0,u.level,n,!1,i,o,u.valueSort.levelName,[u],s+1));else u.members.length>0&&this.getAggregatedHeaderData(u.members,i,void 0,!1,n,o,l,s,d)}}},e.prototype.updateSelectedHeaders=function(e,t,i,r,a,n,o,l,s){return{name:e,level:t,axis:i,isChild:r,value:a,type:n,uniqueName:o,aggregateHeaders:l,childMembers:[],valueCount:s}},e.prototype.applyAdvancedAggregate=function(e,t,i){if(this.selectedHeaders.values.length>0){for(var r={},a=[],n=!1,o=i.length,l=0;l<o;l++)if(void 0!==i[l]&&void 0!==i[l][0]){if(!n)for(var s=i[l].length,d=0;d<s;d++)"value"===i[l][d].axis&&-1!==this.selectedHeaders.values.indexOf(i[l][d].actualText)&&(a.push(d),n=!0);if(a.length>0&&"value"===i[l][a[0]].axis&&-1!==this.selectedHeaders.values.indexOf(i[l][a[0]].actualText))for(var p=0,h=a;p<h.length;p++){r[l+","+(m=h[p])]=[l,m]}}this.updateAggregates(e,t,i,this.selectedHeaders.selectedHeader,a,r);for(var u=0,c=Object.keys(r);u<c.length;u++){var m;i[r[m=c[u]][0]][r[m][1]].formattedText=this.selectedHeaders.selectedHeader.length>0?"0":"#N/A"}}},e.prototype.updateAggregates=function(e,t,i,r,a,n){for(var o=0,l=r;o<l.length;o++){var s=l[o],d=s.aggregateHeaders,p=s.value,h=this.valueAxis&&this.isMutiMeasures?s.valueCount:0,u=s.type,c=s.uniqueName,m="row"===s.axis,g=void 0,v=[],f=[],y=[],b=[],S=[],C=[];if(-1!==["DifferenceFrom","PercentageOfDifferenceFrom","PercentageOfParentRowTotal","PercentageOfParentColumnTotal","PercentageOfParentTotal","RunningTotals"].indexOf(s.type))if(m){if("RunningTotals"!==s.type)for(var w=e.length,x=0;x<w;x++)if(void 0!==e[x]&&e[x].valueSort[c]){g=e[x],S=i[x+h];break}}else{for(var D=i.length,T=0;T<D&&(void 0!==i[T]&&void 0===i[T][0]);T++)y.push(i[T]);for(var E=y.length;E--;){var M=(A=y[E][a[0]]).actualText;-1===this.selectedHeaders.values.indexOf(M)&&(f=y[E],E=0)}if("RunningTotals"!==s.type)for(var P=f.length,O=0;O<P;O++){var L=!1;if(void 0!==f[O]&&f[O].valueSort[c]){g=f[O];var F=i.length;for(T=0;T<F;T++){var A;void 0!==(A=i[T])&&void 0!==A[0]&&"value"===A[O].axis&&-1!==this.selectedHeaders.values.indexOf(A[O].actualText)&&(L=!0,C[T]=A[O],b.push(T))}if(L)break}}}switch(s.type){case"DifferenceFrom":case"PercentageOfDifferenceFrom":var N=s.isChild;if(m){if(N){for(var I=c.split("."),k=(w=e.length,0);k<w;k++)if(void 0!==e[k]){if(-1!==e[k].valueSort.levelName.toString().split(".").indexOf(I[I.length-1])&&e[k].level===g.level)for(var j=0,q=a;j<q.length;j++){G=q[j];"value"===(Se=i[k+h][G]).axis&&Se.actualText===p&&(v.push([k+h,G]),n[k+h+","+G]&&delete n[k+h+","+G])}}}else for(var V=0,R=d;V<R.length;V++){var H=R[V],w=e.length;for(x=0;x<w;x++)if(void 0!==e[x]&&e[x].valueSort[H.valueSort.levelName]&&e[x].level===g.level&&"grand sum"!==e[x].type)for(var B=0,U=a;B<U.length;B++){var G=U[B];"value"===(Se=i[x+h][G]).axis&&Se.actualText===p&&(v.push([x+h,G]),n[x+h+","+G]&&delete n[x+h+","+G])}}for(var z=0,_=v;z<_.length;z++){var W=(Se=i[(G=_[z])[0]][G[1]]).value-S[G[1]].value;W=isNaN(W)?0:W,"DifferenceFrom"===u?Se.formattedText=this.getFormattedValue(W,p).formattedText:(W=0===S[G[1]].value?0:W/S[G[1]].value,Se.formattedText=0!==W?this.globalize.formatNumber(W,{format:"P",maximumFractionDigits:2}):"0")}}else{if(N){I=c.split("."),P=f.length;for(var Q=0;Q<P;Q++){L=!1;if(void 0!==f[Q]){if(-1!==f[Q].valueSort.levelName.toString().split(".").indexOf(I[I.length-1])&&f[Q].level===g.level){for(var Y=0,X=b;Y<X.length;Y++){"value"===(Se=i[G=X[Y]][Q]).axis&&Se.actualText===p&&(L=!0,v.push([G,Q]),n[G+","+Q]&&delete n[G+","+Q])}if(L)break}}}}else for(var K=0,Z=d;K<Z.length;K++){H=Z[K];var P=f.length;for(O=0;O<P;O++){var L=!1;if(void 0!==f[O]&&f[O].valueSort[H.valueSort.levelName]&&f[O].level===g.level&&"grand sum"!==f[O].type){for(var $=0,J=b;$<J.length;$++){"value"===(Se=i[G=J[$]][O]).axis&&Se.actualText===p&&(L=!0,v.push([G,O]),n[G+","+O]&&delete n[G+","+O])}if(L)break}}}for(var ee=0,te=v;ee<te.length;ee++){W=(Se=i[(G=te[ee])[0]][G[1]]).value-C[G[0]].value;W=isNaN(W)?0:W,"DifferenceFrom"===u?Se.formattedText=this.getFormattedValue(W,p).formattedText:(W=0===C[G[0]].value?0:W/C[G[0]].value,Se.formattedText=0!==W?this.globalize.formatNumber(W,{format:"P",maximumFractionDigits:2}):"0")}}s.childMembers.length>0&&this.updateAggregates(e,t,i,s.childMembers,a,n);break;case"PercentageOfParentRowTotal":case"PercentageOfParentColumnTotal":case"PercentageOfParentTotal":if(m){for(var ie=0,re=d;ie<re.length;ie++)for(H=re[ie],w=e.length,T=0;T<w;T++)if(void 0!==e[T]&&e[T].valueSort[H.valueSort.levelName]&&e[T].level===H.level)for(var ae=0,ne=a;ae<ne.length;ae++){G=ne[ae];"value"===(Se=i[T+h][G]).axis&&Se.actualText===p&&(v.push([T+h,G]),n[T+h+","+G]&&delete n[T+h+","+G])}for(var oe=0,le=v;oe<le.length;oe++){W=(Se=i[(T=le[oe])[0]][T[1]]).value/S[T[1]].value;W=isNaN(W)?0:W,Se.formattedText=0!==W?this.globalize.formatNumber(W,{format:"P",maximumFractionDigits:2}):"0"}}else{for(var se=0,de=d;se<de.length;se++){H=de[se],P=f.length;for(var pe=0;pe<P;pe++){L=!1;if(void 0!==f[pe]&&f[pe].valueSort[H.valueSort.levelName]){for(var he=0,ue=b;he<ue.length;he++){"value"===(Se=i[G=ue[he]][pe]).axis&&Se.actualText===p&&(L=!0,v.push([G,pe]),n[G+","+pe]&&delete n[G+","+pe])}if(L)break}}}for(var ce=0,me=v;ce<me.length;ce++){var ge=(Se=i[(T=me[ce])[0]][T[1]]).value/C[T[0]].value;ge=isNaN(ge)?0:ge,Se.formattedText=0!==ge?this.globalize.formatNumber(ge,{format:"P",maximumFractionDigits:2}):"0"}}break;case"RunningTotals":if(m)for(var ve=0,fe=a;ve<fe.length;ve++){G=fe[ve],W=0;for(var ye=0,be=d;ye<be.length;ye++)for(H=be[ye],w=e.length,k=0;k<w;k++)if(void 0!==e[k]){var Se=i[k+h][G];if(void 0!==e[k]&&e[k].valueSort[H.valueSort.levelName]&&e[k].level===H.level&&"value"===Se.axis&&Se.actualText===p){"grand sum"!==e[k].type&&(W+=Se.value,Se.formattedText=this.getFormattedValue(W,p).formattedText),n[k+h+","+G]&&delete n[k+h+","+G];break}}}else for(w=e.length,x=0;x<w;x++)if(void 0!==e[x]){W=0;for(var Ce=0,we=d;Ce<we.length;Ce++)for(H=we[Ce],P=f.length,O=0;O<P;O++){Se=i[x+h][O];if(void 0!==f[O]&&f[O].valueSort[H.valueSort.levelName]&&"value"===Se.axis&&Se.actualText===p){"grand sum"!==f[O].type&&(W+=Se.value,Se.formattedText=this.getFormattedValue(W,p).formattedText),n[x+h+","+O]&&delete n[x+h+","+O];break}}}}}},e.prototype.recursiveRowData=function(e,t,i,r,a,n,o,l,s,d,p){o||this.getTableData(t[r-s].members,t,i,r,a,n,d,p),t[r-s].members=[]},e.prototype.updateRowData=function(e,i,r,a,n,o,l,s,d,p,h){var u=this.fieldList[this.values[n].name].index,c=this.fieldList[this.values[n].name].aggregateType,m=this.values[n].name,g=[],v={},f=0;switch(c){case"Index":for(var y=["cVal","rTotalVal","cTotalVal","gTotalVal"],b=0,S=0,C=g=[[e[o],i[l]],[e[o],h],[p,i[l]],[p,h]];S<C.length;S++){var w=C[S];v[y[b]]=this.getAggregateValue(w[0].index,w[1].indexObject,u,c),b++}var x=v.cVal*v.gTotalVal/(v.rTotalVal*v.cTotalVal);f=!e[o].isDrilled||(t.isNullOrUndefined(e[o].showSubTotals)||e[o].showSubTotals)&&this.showSubTotals&&this.showRowSubTotals?isNaN(x)?0:x:void 0;break;case"PercentageOfGrandTotal":case"PercentageOfColumnTotal":case"PercentageOfRowTotal":(g=[[e[o],i[l]]]).push("PercentageOfGrandTotal"===c?[p,h]:"PercentageOfColumnTotal"===c?[p,i[l]]:[e[o],h]);y=["cVal","gTotalVal"],b=0;for(var D=0,T=g;D<T.length;D++){w=T[D];v[y[b]]=this.getAggregateValue(w[0].index,w[1].indexObject,u,c),b++}x=v.cVal/v.gTotalVal;f=!e[o].isDrilled||(t.isNullOrUndefined(e[o].showSubTotals)||e[o].showSubTotals)&&this.showSubTotals&&this.showRowSubTotals?isNaN(x)?0:x:void 0;break;default:f=!e[o].isDrilled||(t.isNullOrUndefined(e[o].showSubTotals)||e[o].showSubTotals)&&this.showSubTotals&&this.showRowSubTotals?this.getAggregateValue(e[o].index,i[l].indexObject,u,c):void 0}var E=e[o].hasChild||i[l].hasChild||"grand sum"===e[o].type||"grand sum"===i[l].type,M=e[o].isDrilled&&(!t.isNullOrUndefined(e[o].showSubTotals)&&!e[o].showSubTotals||!this.showSubTotals||!this.showRowSubTotals),P=M?"":"Count"===c?f.toLocaleString():this.getFormattedValue(f,m).formattedText;f&&["PercentageOfGrandTotal","PercentageOfColumnTotal","PercentageOfRowTotal"].indexOf(c)>=0?P=this.globalize.formatNumber(f,{format:"P",maximumFractionDigits:2}):!M&&isNaN(f)&&-1!==["PopulationStDev","SampleStDev","PopulationVar","SampleVar"].indexOf(c)&&(P="#DIV/0!"),a[r][s]=this.valueContent[d][s]={axis:"value",actualText:m,indexObject:this.isDrillThrough?this.rawIndexObject:{},rowHeaders:"grand sum"===e[o].type?"":e[o].valueSort.levelName,columnHeaders:"grand sum"===i[l].type?"":i[l].valueSort.levelName,formattedText:P,value:f,rowIndex:r,colIndex:s,isSum:E},this.rawIndexObject={}},e.prototype.getHeaderData=function(e,i,r,a,n){for(var o=e.length,l=this.columns.length,s=this.valueSortSettings.headerText,d=0;d<o;d++){e[d].members.length&&this.getHeaderData(e[d].members,i,r,a,n),(t.isNullOrUndefined(e[d].showSubTotals)||e[d].showSubTotals)&&this.showSubTotals&&this.showColumnSubTotals?i[a=i.length]=e[d]:(e[d].isDrilled?this.removeCount++:i[i.length]=e[d],a=i.length-1);var p=e[d].level;if(e[d].rowIndex=p,e[d].colIndex=a*n+n,r[p]?r[p][a*n+n]=this.headerContent[p][a*n+n]=e[d]:(r[p]=[],this.headerContent[p]={},r[p][a*n+n]=this.headerContent[p][a*n+n]=e[d]),this.isMutiMeasures&&!this.valueAxis)for(var h=0;h<n;h++){var u=this.values[h].caption?this.values[h].caption:this.values[h].name,c={axis:"column",actualText:this.values[h].name,formattedText:u,level:0,valueSort:{},colIndex:a*n+1+h,rowIndex:l};r[l]?r[l][a*n+1+h]=this.headerContent[l][a*n+1+h]=c:(r[l]=[],this.headerContent[l]={},r[l][a*n+1+h]=this.headerContent[l][a*n+1+h]=c);var m=r[l][a*n+1+h].valueSort;m[e[d].valueSort.levelName+this.valueSortSettings.headerDelimiter+u]=1,m.levelName=e[d].valueSort.levelName+this.valueSortSettings.headerDelimiter+u,m&&m[s]&&(this.valueSortSettings.columnIndex=a*n+1+h)}else e[d].valueSort&&e[d].valueSort[s]&&(this.valueSortSettings.columnIndex=a*n+1);i[a].members=[]}},e.prototype.getAggregateValue=function(e,t,i,r){e.length;var a=0,n=0,o=0,l=!0;if(r&&"count"===r.toLowerCase())for(;void 0!==e[a];)void 0!==t[e[a]]&&(this.rawIndexObject[e[a]]=e[a],n+=void 0===this.valueMatrix[e[a]][i]?0:1),a++;else if(r&&"distinctcount"===r.toLowerCase())for(var s=[];void 0!==e[a];){if(void 0!==t[e[a]]){this.rawIndexObject[e[a]]=e[a];void 0!==(O=this.valueMatrix[e[a]][i])&&(0===s.length||s.length>0&&-1===s.indexOf(O))&&(n+=1,s.push(O))}a++}else if(r&&"product"===r.toLowerCase())for(;void 0!==e[a];){if(void 0!==t[e[a]]){this.rawIndexObject[e[a]]=e[a];void 0!==(O=this.valueMatrix[e[a]][i])&&(n=l?1:0===n?1:n,n*=O),l=!1}a++}else if(r&&-1!==["populationstdev","samplestdev","populationvar","samplevar"].indexOf(r.toLowerCase())){for(var d=0,p=0,h=[],u=0,c=0,m=0;void 0!==e[a];){if(void 0!==t[e[a]]){this.rawIndexObject[e[a]]=e[a];void 0!==(O=this.valueMatrix[e[a]][i])&&(p+=O,h.push(O),d++)}a++}if(d>0){u=p/d;for(var g=0,v=h;g<v.length;g++){var f=v[g];m+=Math.pow(f-u,2)}n=0===(c=-1!==["populationstdev","samplestdev"].indexOf(r.toLowerCase())?Math.sqrt(m/("populationstdev"===r.toLowerCase()?d:d-1)):m/("populationvar"===r.toLowerCase()?d:d-1))?NaN:c}else n=p}else if(r&&"min"===r.toLowerCase())for(var y=!0;void 0!==e[a];)void 0!==t[e[a]]&&(this.rawIndexObject[e[a]]=e[a],y?(n=this.valueMatrix[e[a]][i],y=!1):n=this.valueMatrix[e[a]][i]<n?this.valueMatrix[e[a]][i]:n),a++;else if(r&&"max"===r.toLowerCase())for(var b=!0;void 0!==e[a];)void 0!==t[e[a]]&&(this.rawIndexObject[e[a]]=e[a],b?(n=this.valueMatrix[e[a]][i],b=!1):n=this.valueMatrix[e[a]][i]>n?this.valueMatrix[e[a]][i]:n),a++;else if(r&&"calculatedfield"===r.toLowerCase())for(;void 0!==e[a];){if(void 0!==t[e[a]]){this.rawIndexObject[e[a]]=e[a];var S=this.calculatedFields[this.fields[i]],C=S.formula,w={};if(this.calculatedFormulas[S.name])for(var x=this.calculatedFormulas[S.name],D=0,T=x.length;D<T;D++){var E=x[D],M=w[E.formula];if(void 0===M){var P=E.type;M=this.getAggregateValue(e,t,E.index,P),w[E.formula]=M}C=C.replace(E.formula,M.toString())}n=this.evaluate(C),JSON.parse(n.toString())}a++}else for(;void 0!==e[a];){if(void 0!==t[e[a]]){this.rawIndexObject[e[a]]=e[a];var O;n+=void 0===(O=this.valueMatrix[e[a]][i])?0:O,o++}a++}return r&&"avg"===r.toLowerCase()&&0!==n?n/o:n},e.prototype.getFormattedValue=function(e,i){var r={formattedText:void 0!==e?null===e?"null":e.toString():void 0,actualText:void 0!==e?null===e?"null":e:void 0};if(this.formatFields[i]&&e){var a=t.extend({},this.formatFields[i],null,!0);delete a.name,!a.minimumSignificantDigits&&a.minimumSignificantDigits<1&&delete a.minimumSignificantDigits,!a.maximumSignificantDigits&&a.maximumSignificantDigits<1&&delete a.maximumSignificantDigits,a.type?r.formattedText=this.globalize.formatDate(new Date(e),a):r.formattedText=this.globalize.formatNumber(e,a),r.actualText=e,a.type&&"date"===this.formatFields[i].type&&(a.format="yyyy/MM/dd/HH/mm/ss",r.actualText=this.globalize.formatDate(new Date(e),a))}return r},e.prototype.powerFunction=function(e){if(e.indexOf("^")>-1){for(var t=[];e.indexOf("(")>-1;)e=e.replace(/(\([^\(\)]*\))/g,function(e,i){return t.push(i),"~"+(t.length-1)});for(t.push(e),e="~"+(t.length-1);e.indexOf("~")>-1;)e=e.replace(new RegExp("~(\\d+)","g"),function(e,i){return t[i].replace(/(\w*)\^(\w*)/g,"Math.pow($1,$2)")})}return e},e.prototype.evaluate=function(e){return Function('"use strict";return ('+e+")")()},e}(),m="enginePopulating",g="enginePopulated",v="onFieldDropped",f="beforeExport",y="excelHeaderQueryCellInfo",b="pdfHeaderQueryCellInfo",S="excelQueryCellInfo",C="pdfQueryCellInfo",w="dataBound",x="queryCellInfo",D="headerCellInfo",T="hyperlinkCellClick",E="beforeColumnsRender",M="cellDeselected",P="rowDeselected",O="initial-load",L="ui-update",F="content-ready",A="data-ready",N="init-groupingbar",I="tree-view-update",k="pivot-button-update",j="init-calculatedfield",q="e-pivotfieldlist",V="e-rtl",R="e-device",H="e-icons",B="e-disable",U="e-hide",G="e-dropdown-icon",z="e-toggle-field-list",_="e-static",W="e-field-list",Q="e-field-list-footer",Y="e-flat e-primary",X="e-left-axis-fields",K="e-right-axis-fields",Z="e-axis-content",$="e-draggable-prompt",J="e-pvt-btn-div",ee="e-pivot-button",te="e-sort",ie="e-descend",re="e-btn-filter",ae="e-pv-filter",ne="e-pv-filtered",oe="e-remove",le="e-drag",se="e-drop-indicator",de="e-drop-hover",pe="e-member-editor-wrapper",he="e-member-editor-container",ue="e-drillthrough-body-header",ce="e-drillthrough-body-header-common",me="e-drillthrough-body-header-value",ge="e-check",ve="e-ok-btn",fe="e-cancel-btn",ye="e-pivot-error-dialog",be="e-droppable",Se="e-rows",Ce="e-columns",we="e-values",xe="e-filters",De="e-grouping-bar",Te="e-group-rows",Ee="e-group-columns",Me="e-group-values",Pe="e-group-filters",Oe="e-drag-restrict",Le="e-list-selected",Fe="e-title-header",Ae="e-text-content",Ne="e-field-list-btn",Ie="e-calculated-field-btn",ke="e-small",je="e-round",qe="e-add-icon",Ve="e-flat",Re="e-list-text",He="e-selected-node",Be="e-selected-option-icon",Ue="e-between-text-div",Ge="e-filter-input-div-2",ze="e-value-options",_e="e-filter-operator",We="e-collapse",Qe="e-expand",Ye="e-cellvalue",Xe="e-tooltipheader",Ke="e-tooltipcontent",Ze="e-editor-search-wrapper",$e="e-editor-search",Je="e-pivot-calc-input",et="e-flat",tt="e-format",it="e-pivot-formula",rt="e-pivot-treeview-outer",at="e-pivot-button-div",nt="e-axis",ot="e-axis-filter",lt="e-edit",st="e-edited",dt="e-empty-field",pt="e-pivot-formatting-dialog",ht="e-format-condition-button",ut="e-format-table",ct="e-format-color-picker",mt="e-virtualtrack",gt="e-movablecontent",vt="e-frozencontent",ft="e-movableheader",yt="e-defer-apply-button",bt="e-defer-cancel-button",St="e-defer-update-btn",Ct=function(){function e(e){this.colPos=0,this.lastSpan=0,this.parent=e,this.engine=e.engineModule,this.gridSettings=e.gridSettings,this.formatList=this.getFormatList()}return e.prototype.render=function(){var e=this.parent,i=this.parent.engineModule;if(this.injectGridModules(e),this.rowStartPos=this.getRowStartPos(),this.parent.grid&&this.parent.grid.element&&this.parent.element.querySelector(".e-grid")){i.isEngineUpdated?(this.parent.enableValueSorting&&(i.valueContent=this.frameDataSource("value")),i.isEngineUpdated=!1):(i.headerContent=this.frameDataSource("header"),i.valueContent=this.frameDataSource("value")),this.parent.grid.setProperties({columns:this.frameStackedHeaders(),dataSource:e.dataSource.values.length>0&&!this.engine.isEmptyData?i.valueContent:this.frameDataSource("value")},!0),this.parent.grid.notify("datasource-modified",{}),this.parent.grid.refreshColumns();this.parent.element.querySelector(".e-movablecontent").querySelector("colGroup").innerHTML=this.parent.grid.getHeaderContent().querySelector(".e-movableheader").querySelector("colgroup").innerHTML,this.parent.grid.width=this.calculateGridWidth(),this.parent.height>this.engine.valueContent.length*this.gridSettings.rowHeight?this.parent.grid.height="auto":this.parent.grid.height=this.parent.height}else this.parent.element.innerHTML="",this.bindGrid(this.parent,!!this.engine.isEmptyData),this.parent.element.appendChild(t.createElement("div",{id:this.parent.element.id+"_grid"})),this.parent.grid.appendTo("#"+this.parent.element.id+"_grid");this.parent.grid.on(a.headerRefreshed,function(){if(this.parent.enableVirtualization){var e=this.parent.element.querySelector("."+ft),i=this.parent.element.querySelector("."+gt),r=i.querySelector("."+mt);this.parent.virtualHeaderDiv=e.querySelector("."+mt),e.querySelector("."+mt)?t.remove(e.querySelector("."+mt)):this.parent.virtualHeaderDiv=t.createElement("div",{className:mt}),e.appendChild(this.parent.virtualHeaderDiv),r&&t.setStyleAttribute(this.parent.virtualHeaderDiv,{height:0,width:r.style.width}),t.setStyleAttribute(e.querySelector(".e-table"),{transform:i.querySelector(".e-table").style.transform.split(",")[0]+",0px)"}),e.scrollLeft=i.scrollLeft}},this)},e.prototype.bindGrid=function(e,t){var i=this;this.injectGridModules(e),this.parent.grid=new a.Grid({frozenColumns:1,frozenRows:0,dataSource:t?this.frameEmptyData():this.frameDataSource("value"),columns:t?this.frameEmptyColumns():this.frameStackedHeaders(),height:this.engine&&e.height>this.engine.valueContent.length*this.gridSettings.rowHeight||t?"auto":e.height,width:t?this.parent.width:this.calculateGridWidth(),locale:e.locale,enableRtl:e.enableRtl,allowExcelExport:e.allowExcelExport,allowPdfExport:e.allowPdfExport,allowResizing:this.gridSettings.allowResizing,allowTextWrap:this.gridSettings.allowTextWrap,allowReordering:this.gridSettings.allowReordering,allowSelection:this.gridSettings.allowSelection,contextMenuItems:this.gridSettings.contextMenuItems,selectedRowIndex:this.gridSettings.selectedRowIndex,selectionSettings:this.gridSettings.selectionSettings,printMode:this.gridSettings.printMode,rowHeight:this.gridSettings.rowHeight,gridLines:this.gridSettings.gridLines,contextMenuClick:this.gridSettings.contextMenuClick?this.gridSettings.contextMenuClick.bind(this.parent):void 0,contextMenuOpen:this.gridSettings.contextMenuOpen?this.gridSettings.contextMenuOpen.bind(this.parent):void 0,beforeCopy:this.gridSettings.beforeCopy?this.gridSettings.beforeCopy.bind(this.parent):void 0,beforePrint:this.gridSettings.beforePrint?this.gridSettings.beforePrint.bind(this.parent):void 0,printComplete:this.gridSettings.printComplete?this.gridSettings.printComplete.bind(this.parent):void 0,rowSelecting:this.gridSettings.rowSelecting?this.gridSettings.rowSelecting.bind(this.parent):void 0,rowSelected:function(t){e.renderModule.selected(t),e.trigger("rowSelected",t)},rowDeselecting:this.gridSettings.rowDeselecting?this.gridSettings.rowDeselecting.bind(this.parent):void 0,rowDeselected:function(t){e.renderModule.selected(t),e.trigger(P,t)},cellSelecting:this.gridSettings.cellSelecting?this.gridSettings.cellSelecting.bind(this.parent):void 0,cellSelected:function(t){e.renderModule.selected(t),e.trigger("selected",t)},cellDeselecting:this.gridSettings.cellDeselecting?this.gridSettings.cellDeselecting.bind(this.parent):void 0,cellDeselected:function(t){e.renderModule.selected(t),e.trigger(M,t)},resizeStart:this.gridSettings.resizeStart?this.gridSettings.resizeStart.bind(this.parent):void 0,columnDragStart:this.gridSettings.columnDragStart?this.gridSettings.columnDragStart.bind(this):void 0,columnDrag:this.gridSettings.columnDrag?this.gridSettings.columnDrag.bind(this):void 0,columnDrop:this.gridSettings.columnDrop?this.gridSettings.columnDrop.bind(this):void 0,resizing:this.setGroupWidth.bind(this),resizeStop:this.onResizeStop.bind(this),queryCellInfo:function(t){e.renderModule.rowCellBoundEvent(t)},dataBound:function(t){e.element.querySelector(".e-firstcell")&&(e.enableRtl?e.element.querySelector(".e-firstcell").style.borderRight="none":e.element.querySelector(".e-firstcell").style.borderLeft="none"),i.parent.grid.widthService.setWidthToTable(),e.notify(F,{})},headerCellInfo:function(t){e.renderModule.columnCellBoundEvent(t)},excelHeaderQueryCellInfo:function(t){e.renderModule.excelColumnEvent(t)},pdfHeaderQueryCellInfo:function(t){e.renderModule.pdfColumnEvent(t)},excelQueryCellInfo:function(t){e.renderModule.excelRowEvent(t)},pdfQueryCellInfo:function(t){e.renderModule.pdfRowEvent(t)}})},e.prototype.injectGridModules=function(e){a.Grid.Inject(a.Freeze),e.allowExcelExport&&a.Grid.Inject(a.ExcelExport),e.allowPdfExport&&a.Grid.Inject(a.PdfExport),this.gridSettings.allowSelection&&a.Grid.Inject(a.Selection),this.gridSettings.allowReordering&&a.Grid.Inject(a.Reorder),this.gridSettings.allowResizing&&a.Grid.Inject(a.Resize),this.gridSettings.contextMenuItems&&a.Grid.Inject(a.ContextMenu)},e.prototype.updateGridSettings=function(){this.injectGridModules(this.parent),this.parent.grid.allowResizing=this.gridSettings.allowResizing,this.parent.grid.allowTextWrap=this.gridSettings.allowTextWrap,this.parent.grid.allowReordering=this.gridSettings.allowReordering,this.parent.grid.allowSelection=this.gridSettings.allowSelection,this.parent.grid.contextMenuItems=this.gridSettings.contextMenuItems,this.parent.grid.selectedRowIndex=this.gridSettings.selectedRowIndex,this.parent.grid.selectionSettings=this.gridSettings.selectionSettings,this.parent.grid.printMode=this.gridSettings.printMode,this.parent.grid.rowHeight=this.gridSettings.rowHeight,this.parent.grid.gridLines=this.gridSettings.gridLines},e.prototype.appendValueSortIcon=function(e,i,r,a){var n=this.parent.dataSource.valueSortSettings,o="grand sum"===e.type&&1===this.parent.dataSource.values.length?0:this.parent.dataSource.values.length>1?this.parent.engineModule.headerContent.length-1:0===this.parent.dataSource.columns.length?0:this.parent.engineModule.headerContent.length-1,l=n&&n.headerText?e.valueSort.levelName===n.headerText:a===n.columnIndex;if(void 0!==n&&l&&r===o&&"column"===this.parent.dataSource.valueAxis&&(i.querySelector(".e-sortfilterdiv")?(i.querySelector(".e-sortfilterdiv").classList.add("Descending"===n.sortOrder?"e-descending":"e-ascending"),i.querySelector(".e-sortfilterdiv").classList.add("Descending"===n.sortOrder?"e-icon-descending":"e-icon-ascending")):i.appendChild(t.createElement("div",{className:"Descending"===n.sortOrder?"e-icon-descending e-icons e-descending e-sortfilterdiv":"e-icon-ascending e-icons e-ascending e-sortfilterdiv"})),!t.isNullOrUndefined(e.hasChild)&&"grand sum"!==e.type&&i.querySelector(".e-expand")&&(i.querySelector(".e-icon-descending")||i.querySelector(".e-icon-ascending")))){var s=i.querySelector(".e-icon-descending")||i.querySelector(".e-icon-ascending");t.setStyleAttribute(s,{"padding-top":"12px"})}return i},e.prototype.onResizeStop=function(e){var t="0.formattedText"===e.column.field?"0.formattedText":e.column.customAttributes.cell.valueSort.levelName;this.parent.resizeInfo[t]=Number(e.column.width.toString().split("px")[0]),this.parent.grid.headerModule.refreshUI(),this.setGroupWidth(e)},e.prototype.setGroupWidth=function(e){if(this.parent.showGroupingBar&&this.parent.groupingBarModule&&this.parent.element.querySelector("."+De)){if(this.parent.groupingBarModule.refreshUI(),this.parent.element.querySelector(".e-group-row").offsetWidth<245&&!this.parent.firstColWidth){e.cancel=!0;var t=this.parent.grid.columns,i=this.parent.isAdaptive?180:250;t&&t.length>0&&(t[0].width=i),this.parent.element.querySelector(".e-frozenheader").querySelector("col").style.width=i+"px",this.parent.element.querySelector(".e-frozencontent").querySelector("col").style.width=i+"px"}this.parent.element.querySelector(".e-group-values").style.width=this.parent.element.querySelector(".e-group-row").offsetWidth+"px",this.parent.element.querySelector(".e-group-row").style.height=this.parent.element.querySelector(".e-headercontent").offsetHeight+"px"}this.parent.trigger("touchend"===e.e.type||"mouseup"===e.e.type?"resizeStop":"resizing",e)},e.prototype.selected=function(e){var t=this;clearTimeout(this.timeOutObj),this.timeOutObj=setTimeout(function(){for(var e={selectedCellsInfo:[],pivotValues:t.parent.pivotValues},i=t.parent.element.querySelectorAll(".e-cellselectionbackground"),r=0,a=i=0===i.length?t.parent.element.querySelectorAll(".e-selectionbackground"):i;r<a.length;r++){var n=a[r],o=Number(n.getAttribute("aria-colindex")),l=Number(n.getAttribute("index")),s=t.engine.pivotValues[l][o];"value"===s.axis?e.selectedCellsInfo.push({currentCell:s,value:s.value,columnHeaders:s.columnHeaders,rowHeaders:s.rowHeaders,measure:s.actualText.toString()}):"column"===s.axis?e.selectedCellsInfo.push({currentCell:s,value:s.formattedText,columnHeaders:s.valueSort.levelName,rowHeaders:"",measure:""}):e.selectedCellsInfo.push({currentCell:s,value:s.formattedText,columnHeaders:"",rowHeaders:s.valueSort.levelName,measure:""})}t.parent.trigger("cellSelected",e)},300)},e.prototype.rowCellBoundEvent=function(e){var i=e.cell;if(i&&this.engine){var r=this.parent.hyperlinkSettings.cssClass;i.setAttribute("index",(Number(i.getAttribute("index"))+this.engine.headerContent.length).toString());var a=e.data[0];if("0"===i.getAttribute("aria-colindex")){var n=a.type&&"value"===a.type;i.innerText="";var o=a.level?a.level:n?this.lastSpan+1:0;do{o>0&&i.appendChild(t.createElement("span",{className:0===o?"":"e-nextspan"})),o--}while(o>-1);o=a.level?a.level:0,this.lastSpan=n?this.lastSpan:o,!a.hasChild&&o>0&&i.appendChild(t.createElement("span",{className:"e-lastspan"}));var l=void 0;this.parent.dataSource.rows.length>0&&(!a.valueSort||Object.keys(a.valueSort).length>0)&&(l=o>-1?this.parent.dataSource.rows[o].name:"",i.setAttribute("fieldname",l));var s=a.formattedText;a.type&&("grand sum"===a.type?(i.classList.add("e-gtot"),s=this.parent.localeObj.getConstant("grandTotal")):i.classList.add("e-stot")),i.classList.add("e-rowsheader"),!0===a.hasChild&&i.appendChild(t.createElement("div",{className:(!0===a.isDrilled?We:Qe)+" "+H,attrs:{title:!0===a.isDrilled?this.parent.localeObj.getConstant("collapse"):this.parent.localeObj.getConstant("expand")}})),i.appendChild(t.createElement("span",{className:Ye,innerHTML:this.parent.isRowCellHyperlink||a.enableHyperlink?'<a  data-url="'+s+'" class="e-hyperlinkcell '+r+'">'+s+"</a>":s}));var d=this.parent.pivotView.dataSource.valueSortSettings;if(d&&d.headerText&&"row"===this.parent.dataSource.valueAxis&&this.parent.pivotValues[Number(i.getAttribute("index"))][0].valueSort.levelName&&this.parent.pivotValues[Number(i.getAttribute("index"))][0].valueSort.levelName===d.headerText){var p=i.querySelector(".e-expand")||i.querySelector(".e-collapse")?"padding-top: 18px":"padding-top: 12px";i.appendChild(t.createElement("div",{className:"Descending"===d.sortOrder?"e-icon-descending e-icons e-descending e-sortfilterdiv":"e-icon-ascending e-icons e-ascending e-sortfilterdiv",styles:p}))}}else{var h="0"===i.innerText.toString()?"":i.innerText;i.innerText="",i.classList.add("e-valuescontent"),(a=e.data[Number(i.getAttribute("aria-colindex"))]).isSum&&i.classList.add("e-summary"),a.cssClass&&i.classList.add(a.cssClass),i.appendChild(t.createElement("span",{className:Ye,innerHTML:-1!==i.className.indexOf("e-summary")&&this.parent.isSummaryCellHyperlink||-1===i.className.indexOf("e-summary")&&this.parent.isValueCellHyperlink||a.enableHyperlink?'<a data-url="'+h+'" class="e-hyperlinkcell '+r+'">'+h+"</a>":h}))}this.unWireEvents(i),this.wireEvents(i)}this.parent.trigger(x,e)},e.prototype.columnCellBoundEvent=function(e){if(e.cell.column&&e.cell.column.customAttributes){var i=e.cell.column.customAttributes.cell,r=e.node;if(i){var a=this.parent.hyperlinkSettings.cssClass,n=i.level?i.level:0;-1===i.level&&!i.rowSpan&&i.rowIndex!==this.engine.headerContent.length-1||-1===i.rowSpan?e.node.style.display="none":i.rowSpan>1&&(e.node.setAttribute("rowspan",i.rowSpan.toString()),e.node.setAttribute("aria-rowspan",i.rowSpan.toString()),i.rowIndex+i.rowSpan===this.engine.headerContent.length&&(e.node.style.borderBottomWidth="0px")),e.node.setAttribute("aria-colindex",i.colIndex.toString()),e.node.setAttribute("index",i.rowIndex.toString());var o=void 0;if(!(this.parent.dataSource.values&&"column"===this.parent.dataSource.valueAxis&&this.parent.dataSource.values.length>1&&i.rowIndex===this.engine.headerContent.length-1)&&this.parent.dataSource.columns&&this.parent.dataSource.columns.length>0&&(o=n>-1?this.parent.dataSource.columns[n].name:"",r.setAttribute("fieldname",o)),i.type){r.classList.add("grand sum"===i.type?"e-gtot":"e-stot");var l="grand sum"===i.type?this.parent.localeObj.getConstant("grandTotal"):i.formattedText.split("Total")[0]+this.parent.localeObj.getConstant("total");null!==r.querySelector(".e-headertext")?r.querySelector(".e-headertext").innerText=l:r.querySelector(".e-stackedheadercelldiv").innerText=l}if(r.classList.add("e-columnsheader"),this.parent.isColumnCellHyperlink||i.enableHyperlink)if(r.querySelector(".e-stackedheadercelldiv")){var s=r.querySelector(".e-stackedheadercelldiv").innerText;r.querySelector(".e-stackedheadercelldiv").innerHTML='<a data-url="'+s+'" class="e-hyperlinkcell '+a+'">'+s+"</a>"}else if(r.querySelector(".e-headertext")){s=r.querySelector(".e-headertext").innerText;r.querySelector(".e-headertext").innerHTML='<a data-url="'+s+'" class="e-hyperlinkcell '+a+'">'+s+"</a>"}if(!0===i.hasChild){var d=r.querySelector(".e-headercelldiv");d&&(d.style.height="auto",d.style.lineHeight="normal");var p=t.createElement("div",{className:(!0===i.isDrilled?We:Qe)+" "+H,attrs:{title:!0===i.isDrilled?this.parent.localeObj.getConstant("collapse"):this.parent.localeObj.getConstant("expand")}});r.children[0].classList.add(Ye),window.navigator.userAgent.indexOf("Edge")>-1||window.navigator.userAgent.indexOf("Trident")>-1?r.children[0].style.display="table":r.children[0].style.display="block",r.insertBefore(p,r.children[0])}r=this.appendValueSortIcon(i,r,i.rowIndex,i.colIndex),this.unWireEvents(r),this.wireEvents(r)}}this.parent.trigger(D,e)},e.prototype.onHyperCellClick=function(e){var t=e.target.parentElement.parentElement,i={currentCell:t=t.className.indexOf("e-headercelldiv")>-1?t.parentElement:t,data:this.engine.pivotValues[Number(t.getAttribute("index"))][Number(t.getAttribute("aria-colindex"))],cancel:!0};this.parent.trigger(T,i),i.cancel||window.open(e.target.getAttribute("data-url"))},e.prototype.getRowStartPos=function(){for(var e,t=this.parent.pivotValues,i=0;i<t.length;i++)if(t[i]&&t[i][0]&&"row"===t[i][0].axis){e=i;break}return e},e.prototype.frameDataSource=function(e){var t=[];if(this.parent.dataSource.values.length>0&&!this.engine.isEmptyData)if(this.parent.enableValueSorting||!this.engine.isEngineUpdated){for(var i=0,r=this.parent.pivotValues,a="value"===e?this.rowStartPos:0,n="value"===e?r.length:this.rowStartPos,o=a;o<n;o++)if(r[o]){t[i="header"===e?o:i]={};for(var l=0;l<r[o].length;l++)r[o][l]&&(t[i][l]=r[o][l]);i++}}else t="value"===e?this.engine.valueContent:this.engine.headerContent;else t=this.frameEmptyData();return t},e.prototype.frameEmptyData=function(){return[{0:{formattedText:this.parent.localeObj.getConstant("grandTotal")},1:{formattedText:this.parent.localeObj.getConstant("emptyData")}}]},e.prototype.calculateColWidth=function(e){var t=isNaN(this.parent.width)?this.parent.width.toString().indexOf("%")>-1?parseFloat(this.parent.width.toString())/100*this.parent.element.offsetWidth:this.parent.element.offsetWidth:Number(this.parent.width),i=this.parent.showGroupingBar&&this.parent.groupingBarModule?this.parent.isAdaptive?180:250:this.parent.isAdaptive?140:200;this.parent.showGroupingBar&&this.parent.groupingBarModule&&this.parent.grid&&this.parent.dataSource.rows.length>0&&(t-=this.gridSettings.columnWidth>i?this.gridSettings.columnWidth:i,e-=1);return e*this.gridSettings.columnWidth+78<t?t/e:this.gridSettings.columnWidth},e.prototype.calculateGridWidth=function(){var e=this.parent.width;return"auto"===this.parent.width&&this.parent.element.offsetWidth<this.parent.totColWidth&&(e=this.parent.element.offsetWidth),e},e.prototype.frameStackedHeaders=function(){var e=[];if(this.parent.dataSource.values.length>0&&!this.engine.isEmptyData){var t=this.engine.headerContent.length,i=[],r=[],a=this.calculateColWidth(this.engine.pivotValues[0].length);do{var n=[],o=0;t--;var l=this.engine.headerContent[t];if(l)for(var s=0;s<Object.keys(l).length+(l[0]?0:1);s++){var d=l[s]&&l[s].colSpan?l[s].colSpan:1,p=(l[s]&&l[s].rowSpan&&l[s].rowSpan,l[s]?"grand sum"===l[s].type?this.parent.localeObj.getConstant("grandTotal"):"sum"===l[s].type?l[s].formattedText.split("Total")[0]+this.parent.localeObj.getConstant("total"):l[s].formattedText:"");if(t===this.engine.headerContent.length-1)n[o]={field:s+".formattedText",headerText:p,customAttributes:{cell:l[s]},width:l[s]?this.setSavedWidth(l[s].valueSort.levelName,a):a,minWidth:30,format:0===s?"":this.formatList[(s-1)%this.parent.dataSource.values.length],allowReordering:this.parent.gridSettings.allowReordering,allowResizing:this.parent.gridSettings.allowResizing,visible:!0};else if(i[s]){for(var h=d,u=[],c=s;h>0;){if(n[o]){if(!e[r[c]])break;u.push(e[r[c]])}else n[o]={headerText:p,customAttributes:{cell:l[s]},width:l[s]?this.setSavedWidth(l[s].valueSort.levelName,a):a,minWidth:30,allowReordering:this.parent.gridSettings.allowReordering,allowResizing:this.parent.gridSettings.allowResizing,visible:!0},u=[e[r[c]]];h-=i[c],c+=i[c]}n[o].columns=u}n[o]&&(n[o].clipMode=this.gridSettings.clipMode),i[s]=d,r[s]=o,o++,s=s+d-1}e=n.length>0?n:e}while(t>0);var m=this.parent.showGroupingBar&&this.parent.groupingBarModule?this.parent.isAdaptive?180:250:this.parent.isAdaptive?140:200;e[0]={field:"0.formattedText",width:this.setSavedWidth("0.formattedText",a<m?m:a),minWidth:30,headerText:"",allowReordering:!1,allowResizing:this.parent.gridSettings.allowResizing,visible:!0}}else e=this.frameEmptyColumns();return this.parent.triggerColumnRenderEvent(e),e},e.prototype.setSavedWidth=function(e,t){return t=this.parent.resizeInfo[e]?this.parent.resizeInfo[e]:t},e.prototype.frameEmptyColumns=function(){var e=[],t=this.calculateColWidth(2);return e.push({field:"0.formattedText",headerText:"",minWidth:30,width:t}),e.push({field:"1.formattedText",headerText:this.parent.localeObj.getConstant("grandTotal"),minWidth:30,width:t}),e},e.prototype.getFormatList=function(){for(var e=[],t=0;t<this.parent.dataSource.values.length;t++){var i=this.parent.dataSource.values[t];if(this.parent.dataSource.formatSettings.length>0){for(var r="",a=0;a<this.parent.dataSource.formatSettings.length;a++){var n=this.parent.dataSource.formatSettings[a];if(i.name===n.name){r=n.format;break}}e.push(r)}else e.push("N")}return e},e.prototype.excelColumnEvent=function(e){e=this.exportHeaderEvent(e),this.parent.trigger(y,e)},e.prototype.pdfColumnEvent=function(e){e=this.exportHeaderEvent(e),this.parent.trigger(b,e)},e.prototype.excelRowEvent=function(e){if("0.formattedText"===e.column.field){var t="value"===e.data[0].type,i=t?this.lastSpan+1:e.data[0].level;this.colPos=0,e.style={hAlign:"Left",indent:2*i},this.lastSpan=t?this.lastSpan:i}else this.colPos++,e.value=e.data[this.colPos].value||e.data[this.colPos].formattedText;e=this.exportContentEvent(e),this.parent.trigger(S,e)},e.prototype.pdfRowEvent=function(e){if("0.formattedText"===(e=this.exportContentEvent(e)).column.field){var t="value"===e.data[0].type,i=t?this.lastSpan+1:e.data[0].level;e.style={paragraphIndent:10*i},this.lastSpan=t?this.lastSpan:i}this.parent.trigger(C,e)},e.prototype.exportHeaderEvent=function(e){var t=1;if(e.gridCell.column.customAttributes){var i=e.gridCell.column.customAttributes.cell;t=i.rowSpan?i.rowSpan:1}else t=Object.keys(this.engine.headerContent).length;return e.cell.rowSpan&&e.cell.rowSpan!==t&&t>-1&&(e.cell.rowSpan=t),e},e.prototype.exportContentEvent=function(e){return"0"===e.value&&(e.value=""),e.value="grand sum"===e.data[Number(e.column.field.split(".formattedText")[0])].type?this.parent.localeObj.getConstant("grandTotal"):e.value,e},e.prototype.unWireEvents=function(e){e.querySelector(".e-hyperlinkcell")&&t.EventHandler.remove(e.querySelector(".e-hyperlinkcell"),this.parent.isAdaptive?"touchend":"click",this.onHyperCellClick)},e.prototype.wireEvents=function(e){e.querySelector(".e-hyperlinkcell")&&t.EventHandler.add(e.querySelector(".e-hyperlinkcell"),this.parent.isAdaptive?"touchend":"click",this.onHyperCellClick,this)},e}(),wt=function(){var e=function(t,i){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(t,i)};return function(t,i){function r(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),xt=function(e,t,i,r){var a,n=arguments.length,o=n<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,r);else for(var l=e.length-1;l>=0;l--)(a=e[l])&&(o=(n<3?a(o):n>3?a(t,i,o):a(t,i))||o);return n>3&&o&&Object.defineProperty(t,i,o),o},Dt=function(e){function i(){return null!==e&&e.apply(this,arguments)||this}return wt(i,e),xt([t.Property()],i.prototype,"name",void 0),xt([t.Property()],i.prototype,"caption",void 0),xt([t.Property("Sum")],i.prototype,"type",void 0),xt([t.Property()],i.prototype,"axis",void 0),xt([t.Property(!1)],i.prototype,"showNoDataItems",void 0),xt([t.Property()],i.prototype,"baseField",void 0),xt([t.Property()],i.prototype,"baseItem",void 0),xt([t.Property(!0)],i.prototype,"showSubTotals",void 0),i}(t.ChildProperty),Tt=(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}wt(t,e)}(Dt),function(e){function i(){return null!==e&&e.apply(this,arguments)||this}wt(i,e),xt([t.Property()],i.prototype,"backgroundColor",void 0),xt([t.Property()],i.prototype,"color",void 0),xt([t.Property()],i.prototype,"fontFamily",void 0),xt([t.Property()],i.prototype,"fontSize",void 0)}(t.ChildProperty),function(e){function i(){return null!==e&&e.apply(this,arguments)||this}return wt(i,e),xt([t.Property()],i.prototype,"name",void 0),xt([t.Property("Include")],i.prototype,"type",void 0),xt([t.Property()],i.prototype,"items",void 0),xt([t.Property("DoesNotEquals")],i.prototype,"condition",void 0),xt([t.Property()],i.prototype,"value1",void 0),xt([t.Property()],i.prototype,"value2",void 0),xt([t.Property()],i.prototype,"measure",void 0),i}(t.ChildProperty)),Et=function(e){function i(){return null!==e&&e.apply(this,arguments)||this}return wt(i,e),xt([t.Property()],i.prototype,"measure",void 0),xt([t.Property()],i.prototype,"label",void 0),xt([t.Property()],i.prototype,"conditions",void 0),xt([t.Property()],i.prototype,"value1",void 0),xt([t.Property()],i.prototype,"value2",void 0),xt([t.Property()],i.prototype,"style",void 0),i}(t.ChildProperty),Mt=function(e){function i(){return null!==e&&e.apply(this,arguments)||this}return wt(i,e),xt([t.Property()],i.prototype,"name",void 0),xt([t.Property("Ascending")],i.prototype,"order",void 0),i}(t.ChildProperty),Pt=(function(e){function i(){return null!==e&&e.apply(this,arguments)||this}wt(i,e),xt([t.Property()],i.prototype,"name",void 0),xt([t.Property()],i.prototype,"minimumFractionDigits",void 0),xt([t.Property()],i.prototype,"maximumFractionDigits",void 0),xt([t.Property()],i.prototype,"minimumSignificantDigits",void 0),xt([t.Property()],i.prototype,"maximumSignificantDigits",void 0),xt([t.Property(!0)],i.prototype,"useGrouping",void 0),xt([t.Property()],i.prototype,"skeleton",void 0),xt([t.Property()],i.prototype,"type",void 0),xt([t.Property()],i.prototype,"currency",void 0),xt([t.Property()],i.prototype,"minimumIntegerDigits",void 0),xt([t.Property()],i.prototype,"format",void 0)}(t.ChildProperty),function(e){function i(){return null!==e&&e.apply(this,arguments)||this}return wt(i,e),xt([t.Property()],i.prototype,"name",void 0),xt([t.Property()],i.prototype,"formula",void 0),i}(t.ChildProperty)),Ot=function(e){function i(){return null!==e&&e.apply(this,arguments)||this}return wt(i,e),xt([t.Property()],i.prototype,"name",void 0),xt([t.Property()],i.prototype,"items",void 0),i}(t.ChildProperty),Lt=function(e){function i(){return null!==e&&e.apply(this,arguments)||this}return wt(i,e),xt([t.Property()],i.prototype,"headerText",void 0),xt([t.Property(".")],i.prototype,"headerDelimiter",void 0),xt([t.Property("None")],i.prototype,"sortOrder",void 0),i}(t.ChildProperty),Ft=function(e){function i(){return null!==e&&e.apply(this,arguments)||this}return wt(i,e),xt([t.Property()],i.prototype,"data",void 0),xt([t.Collection([],Dt)],i.prototype,"rows",void 0),xt([t.Collection([],Dt)],i.prototype,"columns",void 0),xt([t.Collection([],Dt)],i.prototype,"values",void 0),xt([t.Collection([],Dt)],i.prototype,"filters",void 0),xt([t.Property(!1)],i.prototype,"expandAll",void 0),xt([t.Property("column")],i.prototype,"valueAxis",void 0),xt([t.Collection([],Tt)],i.prototype,"filterSettings",void 0),xt([t.Collection([],Mt)],i.prototype,"sortSettings",void 0),xt([t.Property(!0)],i.prototype,"enableSorting",void 0),xt([t.Property(!1)],i.prototype,"allowLabelFilter",void 0),xt([t.Property(!1)],i.prototype,"allowValueFilter",void 0),xt([t.Property(!0)],i.prototype,"showSubTotals",void 0),xt([t.Property(!0)],i.prototype,"showRowSubTotals",void 0),xt([t.Property(!0)],i.prototype,"showColumnSubTotals",void 0),xt([t.Property(!0)],i.prototype,"showGrandTotals",void 0),xt([t.Property(!0)],i.prototype,"showRowGrandTotals",void 0),xt([t.Property(!0)],i.prototype,"showColumnGrandTotals",void 0),xt([t.Property([])],i.prototype,"formatSettings",void 0),xt([t.Collection([],Ot)],i.prototype,"drilledMembers",void 0),xt([t.Complex({},Lt)],i.prototype,"valueSortSettings",void 0),xt([t.Collection([],Pt)],i.prototype,"calculatedFieldSettings",void 0),xt([t.Collection([],Et)],i.prototype,"conditionalFormatSettings",void 0),i}(t.ChildProperty),At=function(){var e=function(t,i){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(t,i)};return function(t,i){function r(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),Nt=function(e,t,i,r){var a,n=arguments.length,o=n<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,r);else for(var l=e.length-1;l>=0;l--)(a=e[l])&&(o=(n<3?a(o):n>3?a(t,i,o):a(t,i))||o);return n>3&&o&&Object.defineProperty(t,i,o),o},It=function(e){function i(){return null!==e&&e.apply(this,arguments)||this}return At(i,e),Nt([t.Property("Both")],i.prototype,"gridLines",void 0),Nt([t.Property(!1)],i.prototype,"allowTextWrap",void 0),Nt([t.Property(!1)],i.prototype,"allowReordering",void 0),Nt([t.Property(!0)],i.prototype,"allowResizing",void 0),Nt([t.Property(null)],i.prototype,"rowHeight",void 0),Nt([t.Property(110)],i.prototype,"columnWidth",void 0),Nt([t.Property("Ellipsis")],i.prototype,"clipMode",void 0),Nt([t.Property(!1)],i.prototype,"allowSelection",void 0),Nt([t.Property(-1)],i.prototype,"selectedRowIndex",void 0),Nt([t.Property({mode:"Row",cellSelectionMode:"Flow",type:"Single"})],i.prototype,"selectionSettings",void 0),Nt([t.Property("AllPages")],i.prototype,"printMode",void 0),Nt([t.Property()],i.prototype,"contextMenuItems",void 0),Nt([t.Event()],i.prototype,"beforeCopy",void 0),Nt([t.Event()],i.prototype,"printComplete",void 0),Nt([t.Event()],i.prototype,"beforePrint",void 0),Nt([t.Event()],i.prototype,"contextMenuOpen",void 0),Nt([t.Event()],i.prototype,"contextMenuClick",void 0),Nt([t.Event()],i.prototype,"queryCellInfo",void 0),Nt([t.Event()],i.prototype,"headerCellInfo",void 0),Nt([t.Event()],i.prototype,"rowSelecting",void 0),Nt([t.Event()],i.prototype,"rowSelected",void 0),Nt([t.Event()],i.prototype,"rowDeselecting",void 0),Nt([t.Event()],i.prototype,"rowDeselected",void 0),Nt([t.Event()],i.prototype,"cellSelecting",void 0),Nt([t.Event()],i.prototype,"cellSelected",void 0),Nt([t.Event()],i.prototype,"cellDeselecting",void 0),Nt([t.Event()],i.prototype,"cellDeselected",void 0),Nt([t.Event()],i.prototype,"resizeStart",void 0),Nt([t.Event()],i.prototype,"resizing",void 0),Nt([t.Event()],i.prototype,"resizeStop",void 0),Nt([t.Event()],i.prototype,"pdfHeaderQueryCellInfo",void 0),Nt([t.Event()],i.prototype,"pdfQueryCellInfo",void 0),Nt([t.Event()],i.prototype,"excelHeaderQueryCellInfo",void 0),Nt([t.Event()],i.prototype,"excelQueryCellInfo",void 0),Nt([t.Event()],i.prototype,"columnDragStart",void 0),Nt([t.Event()],i.prototype,"columnDrag",void 0),Nt([t.Event()],i.prototype,"columnDrop",void 0),Nt([t.Event()],i.prototype,"beforeColumnsRender",void 0),i}(t.ChildProperty),kt=function(){function e(e){this.parent=e}return e.prototype.getModuleName=function(){return"excelExport"},e.prototype.exportToExcel=function(e){if(this.parent.enableVirtualization){var t=this.parent.engineModule.pageSettings;this.parent.engineModule.pageSettings=null,this.parent.engineModule.generateGridData(this.parent.dataSource),this.parent.engineModule.pageSettings=t}var i={fileName:"default",header:"",footer:"",dataCollections:[this.parent.engineModule.pivotValues]};this.parent.trigger(f,i);for(var r=i.fileName,a=i.dataCollections,o=[],l=0;l<a.length;l++){for(var s=a[l],d=0,p=s.length,h=0,u=this.parent.renderModule.getFormatList(),c=[],m=0,g=0;g<p;g++)if(s[g]){h++,d=s[g].length;for(var v=[],y=0;y<d;y++)if(s[g][y]){var b=s[g][y];if(-1!==b.level||b.rowSpan){var S="value"===b.axis?b.value:b.formattedText;S="grand sum"===b.type?this.parent.localeObj.getConstant("grandTotal"):"sum"===b.type?S.toString().replace("Total",this.parent.localeObj.getConstant("total")):"0"===S?"":S,(-1!==b.level||b.rowSpan)&&(v.push({index:y+1,value:S,colSpan:b.colSpan,rowSpan:b.rowSpan}),"value"===b.axis?(v[v.length-1].style={numberFormat:u[(y-1)%this.parent.dataSource.values.length],bold:!1,wrapText:!0},b.style&&(v[v.length-1].style.backColor=b.style.backgroundColor,v[v.length-1].style.fontColor=b.style.color,v[v.length-1].style.fontName=b.style.fontFamily,v[v.length-1].style.fontSize=Number(b.style.fontSize.split("px")[0]))):(v[v.length-1].style={bold:!0,vAlign:"Center",wrapText:!0,indent:1===y?10*b.level:0},"row"===b.axis&&0===y&&(v[v.length-1].style.hAlign="Left",v[v.length-1].style.indent=2*b.level,m=b.level>m?b.level:m)),v[v.length-1].style.borders={color:"#000000",lineStyle:"Thin"})}y+=b.colSpan?b.colSpan-1:0}else v.push({index:y+1,value:"",colSpan:1,rowSpan:1});c.push({index:h,cells:v})}var C=[];for(y=0;y<d;y++)C.push({index:y+1,width:100});m>0&&(C[0].width=100+20*m),o.push({columns:C,rows:c})}new n.Workbook({worksheets:o},"Excel"===e?"xlsx":"csv").save(r+("Excel"===e?".xlsx":".csv"))},e}(),jt=function(){function e(e){this.parent=e}return e.prototype.getModuleName=function(){return"pdfExport"},e.prototype.exportToPDF=function(){var e,t=this.applyEvent(),i=0,r=t.args.dataCollections[i],a=r&&r.length>0?r[0].length:0,n=0;do{var l=new o.PdfGrid;if(r&&r.length>0){l.columns.add(r[0].length-n>=6?6:r[0].length-n);for(var s=r.length,d=0,p=0,h=0;h<s;h++)if(r[h]){var u=!(r[h][0]&&"row"===r[h][0].axis),c=r[h].length>n+6?n+6:r[h].length;u&&l.headers.add(1);for(var m=u?l.headers.getHeader(d):l.rows.addRow(),g=0,v=!0,f=n;f<c;f++){var y=!1;if(r[h][f]){var b=r[h][f];if(-1!==b.level||b.rowSpan){var S=b.formattedText;S="grand sum"===b.type?this.parent.localeObj.getConstant("grandTotal"):"sum"===b.type?S.toString().replace("Total",this.parent.localeObj.getConstant("total")):"0"===S?"":S,(-1!==b.level||b.rowSpan)&&(m.cells.getCell(g).columnSpan=b.colSpan?6-g<b.colSpan?6-g:b.colSpan:1,u&&b.rowSpan&&b.rowSpan>1&&(m.cells.getCell(g).rowSpan=b.rowSpan?b.rowSpan:1),m.cells.getCell(g).value=S?S.toString():""),""!==S&&(v=!1)}p=b.level>p&&0===f?b.level:p,y="value"===b.axis,f+=m.cells.getCell(g).columnSpan?m.cells.getCell(g).columnSpan-1:0,g+=m.cells.getCell(g).columnSpan?m.cells.getCell(g).columnSpan-1:0,b.style&&(m=this.applyStyle(m,b,g))}else m.cells.getCell(g).value="",0===f&&u&&this.parent.dataSource.columns&&this.parent.dataSource.columns.length>0&&l.headers.getHeader(0).cells.getCell(0).rowSpan++;var C=new o.PdfStringFormat;C.paragraphIndent=!u&&0===f&&r[h][f]?15*r[h][f].level:0,C.alignment=y?o.PdfTextAlignment.Right:o.PdfTextAlignment.Left,C.lineAlignment=o.PdfVerticalAlignment.Middle,m.cells.getCell(g).style.stringFormat=C,g++}v&&(m.height=16),d++}0===n&&(l.columns.getColumn(0).width=100+20*p)}var w=new o.PdfLayoutFormat;w.paginateBounds=new o.RectangleF(0,0,0,0),0===n&&this.parent.dataSource.columns&&this.parent.dataSource.columns.length>0&&l.headers.getHeader(0).cells.getCell(0).rowSpan--,e=e?l.draw(e.page,new o.PointF(10,e.bounds.y+e.bounds.height+10),w):l.draw(t.page,new o.PointF(10,20),w),(n+=6)>=a&&t.args.dataCollections.length>i+1&&(i++,a=(r=t.args.dataCollections[i])&&r.length>0?r[0].length:0,n=0)}while(n<a);t.document.save(t.args.fileName+".pdf"),t.document.destroy()},e.prototype.applyStyle=function(e,t,i){var r=this.parent.conditionalFormattingModule.hexToRgb(t.style.backgroundColor),a=new o.PdfSolidBrush(new o.PdfColor(r.r,r.g,r.b));e.cells.getCell(i).style.backgroundBrush=a;var n=Number(t.style.fontSize.split("px")[0]),l=new o.PdfStandardFont(o.PdfFontFamily.TimesRoman,n,o.PdfFontStyle.Regular);return e.cells.getCell(i).style.font=l,r=this.parent.conditionalFormattingModule.hexToRgb(t.style.color),a=new o.PdfSolidBrush(new o.PdfColor(r.r,r.g,r.b)),e.cells.getCell(i).style.textBrush=a,e},e.prototype.applyEvent=function(){if(this.parent.enableVirtualization){var e=this.parent.engineModule.pageSettings;this.parent.engineModule.pageSettings=null,this.parent.engineModule.generateGridData(this.parent.dataSource),this.parent.engineModule.pageSettings=e}var t={fileName:"default",header:"",footer:"",dataCollections:[this.parent.engineModule.pivotValues]};this.parent.trigger(f,t);var i=t.header,r=t.footer,a=new o.PdfDocument,n=a.pages.add(),l=new o.PdfStandardFont(o.PdfFontFamily.TimesRoman,15,o.PdfFontStyle.Regular),s=new o.PdfSolidBrush(new o.PdfColor(0,0,0)),d=new o.PdfPen(new o.PdfColor(0,0,0),.5),p=new o.PdfPageTemplateElement(new o.RectangleF(0,0,n.graphics.clientSize.width,20));p.graphics.drawString(i,l,d,s,0,0,new o.PdfStringFormat(o.PdfTextAlignment.Center)),a.template.top=p;var h=new o.PdfPageTemplateElement(new o.RectangleF(0,0,n.graphics.clientSize.width,20));return h.graphics.drawString(r,l,d,s,0,0,new o.PdfStringFormat(o.PdfTextAlignment.Center)),a.template.bottom=h,{document:a,page:n,args:t}},e}(),qt=function(){function e(e){this.keyConfigs={tab:"tab",enter:"enter"},this.parent=e,this.parent.element.tabIndex=-1===this.parent.element.tabIndex?0:this.parent.element.tabIndex,this.pivotViewKeyboardModule=new t.KeyboardEvents(this.parent.element,{keyAction:this.keyActionHandler.bind(this),keyConfigs:this.keyConfigs,eventName:"keydown"})}return e.prototype.keyActionHandler=function(e){switch(e.action){case"tab":this.processTab(e);break;case"enter":this.processEnter(e)}},e.prototype.getNextButton=function(e){var t=[].slice.call(this.parent.element.querySelectorAll("."+ee)),i=e;if(this.parent.grid.element.querySelector("."+ee))for(var r=t.length,a=0;a<r;a++)if(t[a].getAttribute("data-uid")===e.getAttribute("data-uid")){i=t[a+1]?t[a+1]:i;break}return i},e.prototype.processTab=function(e){var i=e.target;if(i&&t.closest(i,"."+ee)){var r=this.parent.grid.serviceLocator.getService("focus"),a=this.getNextButton(i);if(a.getAttribute("data-uid")!==i.getAttribute("data-uid"))r.currentInfo.skipAction=!0,a.focus();else{r.focus();var n=r.getFocusedElement();t.addClass([n],["e-focused","e-focus"]),n.setAttribute("tabindex","0")}e.preventDefault()}else if(!this.parent.showGroupingBar&&this.parent.showFieldList){if(i&&t.closest(i,"."+z)){(r=this.parent.grid.serviceLocator.getService("focus")).focus();n=r.getFocusedElement();t.addClass([n],["e-focused","e-focus"]),n.setAttribute("tabindex","0")}}else if(!this.parent.showGroupingBar&&!this.parent.showFieldList&&i&&t.closest(i,".e-pivotview")){var o=t.closest(i,".e-pivotview"),l=(r=this.parent.grid.serviceLocator.getService("focus"),[].slice.call(o.getElementsByTagName("tr")));if(i.innerHTML===l[l.length-1].lastChild.innerHTML)r.currentInfo.skipAction=!0;else{r.focus();n=r.getFocusedElement();t.addClass([n],["e-focused","e-focus"]),n.setAttribute("tabindex","0")}}},e.prototype.processEnter=function(e){var i=e.target;if(i&&t.closest(i,".e-grid"))return i.querySelector("."+H)?i.querySelector("."+H).click():i.classList.contains("e-valuescontent")&&i.dispatchEvent(new MouseEvent("dblclick",{view:window,bubbles:!0,cancelable:!0})),void e.preventDefault()},e.prototype.destroy=function(){this.pivotViewKeyboardModule&&this.pivotViewKeyboardModule.destroy()},e}(),Vt=function(){function e(e){this.parent=e,this.parent.contextMenuModule=this}return e.prototype.render=function(){this.renderContextMenu()},e.prototype.renderContextMenu=function(){var e={cssClass:"e-pivot-context-menu",items:[{text:this.parent.localeObj.getConstant("addToFilter"),id:"Context_Filters"},{text:this.parent.localeObj.getConstant("addToRow"),id:"Context_Rows"},{text:this.parent.localeObj.getConstant("addToColumn"),id:"Context_Columns"},{text:this.parent.localeObj.getConstant("addToValue"),id:"Context_Values"}],enableRtl:this.parent.enableRtl,beforeOpen:this.onBeforeMenuOpen.bind(this),select:this.onSelectContextMenu.bind(this)};this.parent.element.appendChild(t.createElement("ul",{id:this.parent.element.id+"_PivotContextMenu"})),this.menuObj=new l.ContextMenu(e),this.menuObj.appendTo("#"+this.parent.element.id+"_PivotContextMenu")},e.prototype.onBeforeMenuOpen=function(e){var i=[].slice.call(e.element.querySelectorAll("li")),r=this.fieldElement.querySelector(".e-content").getAttribute("data-type");if(t.removeClass(i,"e-disabled"),"CalculatedField"===r)for(var a=0,n=i;a<n.length;a++){var o=n[a];o.textContent!==this.parent.localeObj.getConstant("addToValue")&&t.addClass([o],"e-disabled")}},e.prototype.onSelectContextMenu=function(e){if(null!==e.element.textContent){var t=this.fieldElement.getAttribute("data-uid"),i=e.item.id.replace("Context_","").toLowerCase();this.parent.pivotCommon.dataSourceUpdate.updateDataSource(t,i,-1),this.parent.updateDataSource(!0),this.fieldElement=void 0}},e.prototype.destroy=function(){this.parent.isDestroyed&&this.menuObj&&!this.menuObj.isDestroyed&&this.menuObj.destroy()},e}(),Rt=function(){function e(e){this.previousValues={top:0,left:0},this.frozenPreviousValues={top:0,left:0},this.eventType="",this.parent=e,this.addInternalEvents()}return e.prototype.getModuleName=function(){return"virtualscroll"},e.prototype.addInternalEvents=function(){this.parent.on(F,this.wireEvents,this)},e.prototype.wireEvents=function(){var e=this.parent.element.querySelector("."+gt),i=this.parent.element.querySelector("."+vt),r=this.parent.element.querySelector("."+ft);t.EventHandler.clearEvents(e),t.EventHandler.clearEvents(i),this.parent.engineModule&&(t.EventHandler.add(e,"scroll touchmove pointermove",this.onHorizondalScroll(r,e,i),this),t.EventHandler.add(e,"scroll wheel touchmove pointermove",this.onVerticalScroll(i,e),this),t.EventHandler.add(e,"mouseup touchend",this.common(r,e,i),this),t.EventHandler.add(i,"wheel",this.onWheelScroll(e,i),this),t.EventHandler.add(i,"touchstart pointerdown",this.setPageXY(),this),t.EventHandler.add(i,"touchmove pointermove",this.onTouchScroll(r,e,i),this),t.EventHandler.add(r,"touchstart pointerdown",this.setPageXY(),this),t.EventHandler.add(r,"touchmove pointermove",this.onTouchScroll(r,e,i),this)),this.parent.grid.isPreventScrollEvent=!0},e.prototype.onWheelScroll=function(e,t){var i=this,r=e;return function(e){var a=r.scrollTop+(1===e.deltaMode?30*e.deltaY:e.deltaY);i.frozenPreviousValues.top!==a&&(e.preventDefault(),t.scrollTop=a,r.scrollTop=a,i.frozenPreviousValues.top=a,i.eventType=e.type)}},e.prototype.onTouchScroll=function(e,t,i){var r=this,a=t;return function(t){if("mouse"!==t.pointerType){var n=r.getPointXY(t),o=a.scrollTop+(r.pageXY.y-n.y),l=a.scrollLeft+(r.pageXY.x-n.x);if(r.parent.element.querySelector(".e-headercontent").contains(t.target)){if(r.frozenPreviousValues.left===l||l<0)return;e.scrollLeft=l,a.scrollLeft=l,r.pageXY.x=n.x,r.frozenPreviousValues.left=l}else{if(r.frozenPreviousValues.top===o||o<0)return;i.scrollTop=o,a.scrollTop=o,r.pageXY.y=n.y,r.frozenPreviousValues.top=o}r.eventType=t.type}}},e.prototype.setPageXY=function(){var e=this;return function(t){"mouse"!==t.pointerType&&(e.pageXY=e.getPointXY(t))}},e.prototype.getPointXY=function(e){var t={x:0,y:0};return e.touches&&e.touches.length?(t.x=e.touches[0].pageX,t.y=e.touches[0].pageY):(t.x=e.pageX,t.y=e.pageY),t},e.prototype.update=function(e,t,i,a,n){if("vertical"===this.direction){var o="row"===this.parent.dataSource.valueAxis?this.parent.dataSource.values.length:1,l=this.parent.pageSettings.rowSize*o*this.parent.gridSettings.rowHeight,s=Math.ceil(i/l);if(this.parent.scrollPosObject.vertical===s)return void r.hideSpinner(this.parent.element);r.showSpinner(this.parent.element),this.parent.scrollPosObject.vertical=s,this.parent.engineModule.pageSettings.rowCurrentPage=s>1?s:1,this.parent.engineModule.generateGridData(this.parent.dataSource,this.parent.engineModule.headerCollection),this.parent.pivotValues=this.parent.engineModule.pivotValues;var d=l*Math.ceil(this.parent.engineModule.rowStartPos/(this.parent.pageSettings.rowSize*o))-this.parent.engineModule.rowFirstLvl*o*this.parent.gridSettings.rowHeight;this.parent.scrollPosObject.verticalSection=d}else{var p="column"===this.parent.dataSource.valueAxis?this.parent.dataSource.values.length:1;l=this.parent.pageSettings.columnSize*p*this.parent.gridSettings.columnWidth,s=Math.ceil(a/l);if(this.parent.scrollPosObject.horizontal===s)return void r.hideSpinner(this.parent.element);r.showSpinner(this.parent.element),this.parent.scrollPosObject.horizontal=s,this.parent.engineModule.pageSettings.columnCurrentPage=s>1?s:1,this.parent.engineModule.generateGridData(this.parent.dataSource,this.parent.engineModule.headerCollection),this.parent.pivotValues=this.parent.engineModule.pivotValues;d=l*Math.ceil(this.parent.engineModule.colStartPos/(this.parent.pageSettings.columnSize*p))-this.parent.engineModule.colFirstLvl*p*this.parent.gridSettings.columnWidth;this.parent.scrollPosObject.horizontalSection=d}},e.prototype.common=function(e,t,i){var r=this;return function(i){r.update(e,t,t.scrollTop,t.scrollLeft,i)}},e.prototype.onHorizondalScroll=function(e,i,r){var a,n=this;return function(o){var l=i.scrollLeft;if("wheel"!==o.type&&"touchmove"!==o.type&&"wheel"!==n.eventType&&"touchmove"!==n.eventType||(clearTimeout(a),a=setTimeout(function(){l="touchmove"===o.type?i.scrollLeft:l,n.update(e,i,i.scrollTop,l,o)},300)),n.previousValues.left!==l){n.direction="horizondal";var s=n.parent.scrollPosObject.horizontalSection>l?-(n.parent.scrollPosObject.horizontalSection-l):l+e.offsetWidth-(n.parent.scrollPosObject.horizontalSection+i.querySelector(".e-table").offsetWidth);(n.parent.scrollPosObject.horizontalSection>l||s>1)&&(l>e.clientWidth?(n.parent.scrollPosObject.left<1&&(n.parent.scrollPosObject.left=e.clientWidth),n.parent.scrollPosObject.left=n.parent.scrollPosObject.left-50,s=n.parent.scrollPosObject.horizontalSection>l?s-n.parent.scrollPosObject.left:s+n.parent.scrollPosObject.left):s=-n.parent.scrollPosObject.horizontalSection,t.setStyleAttribute(i.querySelector(".e-table"),{transform:"translate("+(n.parent.scrollPosObject.horizontalSection+s)+"px,"+n.parent.scrollPosObject.verticalSection+"px)"}),t.setStyleAttribute(e.querySelector(".e-table"),{transform:"translate("+(n.parent.scrollPosObject.horizontalSection+s)+"px,0px)"}),n.parent.scrollPosObject.horizontalSection=n.parent.scrollPosObject.horizontalSection+s),n.previousValues.left=l,n.frozenPreviousValues.left=l,n.eventType="",e.scrollLeft=i.scrollLeft}else r.scrollTop=i.scrollTop}},e.prototype.onVerticalScroll=function(e,i){var r,a=this;return function(n){var o=i.scrollTop;if("wheel"!==n.type&&"touchmove"!==n.type&&"wheel"!==a.eventType&&"touchmove"!==a.eventType||(clearTimeout(r),r=setTimeout(function(){a.update(null,i,i.scrollTop,i.scrollLeft,n)},300)),a.previousValues.top!==o){a.direction="vertical";var l=a.parent.scrollPosObject.verticalSection>o?-(a.parent.scrollPosObject.verticalSection-o):o+e.clientHeight-(a.parent.scrollPosObject.verticalSection+e.querySelector(".e-table").offsetHeight);(a.parent.scrollPosObject.verticalSection>o||l>1)&&(o>e.clientHeight?(a.parent.scrollPosObject.top<1&&(a.parent.scrollPosObject.top=e.clientHeight),a.parent.scrollPosObject.top=a.parent.scrollPosObject.top-50,l=a.parent.scrollPosObject.verticalSection>o?l-a.parent.scrollPosObject.top:l+a.parent.scrollPosObject.top):l=-a.parent.scrollPosObject.verticalSection,t.setStyleAttribute(e.querySelector(".e-table"),{transform:"translate(0px,"+(a.parent.scrollPosObject.verticalSection+l)+"px)"}),t.setStyleAttribute(i.querySelector(".e-table"),{transform:"translate("+a.parent.scrollPosObject.horizontalSection+"px,"+(a.parent.scrollPosObject.verticalSection+l)+"px)"}),a.parent.scrollPosObject.verticalSection=a.parent.scrollPosObject.verticalSection+l),a.previousValues.top=o,a.frozenPreviousValues.top=o,a.eventType="",e.scrollTop=i.scrollTop,i.scrollTop=e.scrollTop}}},e.prototype.removeInternalEvents=function(){this.parent.isDestroyed||this.parent.off(F,this.wireEvents)},e.prototype.destroy=function(){this.removeInternalEvents()},e}(),Ht=function(){function e(e){this.isUpdated=!1,this.gridIndexObjects={},this.parent=e}return e.prototype.showDrillThroughDialog=function(e){var i=this;this.removeDrillThroughDialog();var a=t.createElement("div",{id:this.parent.element.id+"_drillthrough",className:"e-drillthrough-dialog",styles:"visibility:hidden;"});this.parent.element.appendChild(a),this.dialogPopUp=new r.Dialog({animationSettings:{effect:"Fade"},allowDragging:!1,header:this.parent.localeObj.getConstant("details"),content:this.createDrillThroughGrid(e),beforeOpen:function(){i.drillThroughGrid.setProperties({dataSource:i.parent.editSettings.allowEditing?i.dataWithPrimarykey(e):e.rawData,height:300},!0),i.drillThroughGrid.enableVirtualization=!i.parent.editSettings.allowEditing},beforeClose:function(){if(i.parent.editSettings.allowEditing&&i.isUpdated){for(var e=Object.keys(i.gridIndexObjects).length,r=[],a=0,n=i.drillThroughGrid.dataSource;a<n.length;a++){var o=n[a];if(t.isNullOrUndefined(o.__index)||""===o.__index){for(var l=0,s=i.parent.engineModule.fields;l<s.length;l++){var d=s[l];t.isNullOrUndefined(o[d])&&delete o[d]}delete o.__index,r.push(o)}else e>0&&(delete i.gridIndexObjects[o.__index.toString()],e--)}e=0;for(var p=[],h=0,u=i.parent.dataSource.data;h<u.length;h++){delete(o=u[h]).__index,void 0===i.gridIndexObjects[e.toString()]&&p.push(o),e++}p=p.concat(r),i.parent.setProperties({dataSource:{data:p}},!0),i.parent.engineModule.updateGridData(i.parent.dataSource),i.parent.pivotValues=i.parent.engineModule.pivotValues}i.isUpdated=!1,i.gridIndexObjects={}},isModal:!0,visible:!0,showCloseIcon:!0,enableRtl:this.parent.enableRtl,width:this.parent.isAdaptive?"100%":"60%",position:{X:"center",Y:"center"},closeOnEscape:!0,target:document.body,close:this.removeDrillThroughDialog.bind(this)}),this.dialogPopUp.appendTo(a),t.setStyleAttribute(this.dialogPopUp.element,{visibility:"visible"})},e.prototype.removeDrillThroughDialog=function(){this.dialogPopUp&&!this.dialogPopUp.isDestroyed&&this.dialogPopUp.destroy();var e=document.getElementById(this.parent.element.id+"_drillthrough");e&&t.remove(e),document.getElementById(this.parent.element.id+"_drillthroughgrid_ccdlg")&&t.remove(document.getElementById(this.parent.element.id+"_drillthroughgrid_ccdlg"))},e.prototype.createDrillThroughGrid=function(e){var i=t.createElement("div",{id:this.parent.element.id+"_drillthroughbody",className:"e-drillthrough-body"}),r=t.createElement("div",{id:this.parent.element.id+"_drillthroughbodyheader",className:"e-drillthrough-body-header-container"});if(""!==e.rowHeaders&&(r.innerHTML="<span class="+ce+"><span class="+ue+">"+this.parent.localeObj.getConstant("row")+"</span> :<span class="+me+">"+e.rowHeaders+"</span></span>"),""!==e.columnHeaders&&(r.innerHTML=r.innerHTML+"<span class="+ce+"><span class="+ue+">"+this.parent.localeObj.getConstant("column")+"</span> :<span class="+me+">"+e.columnHeaders+"</span></span>"),""!==e.value){var n=e.value.split("(")[0],o=e.value.split("(")[1].split(")")[0];"0"!==o&&(r.innerHTML=r.innerHTML+"<span class="+ce+"><span class="+ue+">"+n+"</span> :<span class="+me+">"+o+"</span></span>")}var l=["ColumnChooser"];this.parent.editSettings.allowEditing&&(l=this.parent.editSettings.allowCommandColumns?["ColumnChooser","Add"]:"Batch"===this.parent.editSettings.mode?["ColumnChooser","Add","Delete","Update","Cancel"]:"Dialog"===this.parent.editSettings.mode?["ColumnChooser","Add","Edit","Delete"]:["ColumnChooser","Add","Edit","Delete","Update","Cancel"]);var s=t.createElement("div",{id:this.parent.element.id+"_drillthroughgrid",className:"e-drillthrough-grid"});a.Grid.Inject(a.Selection,a.Reorder,a.Resize,a.Toolbar,a.ColumnChooser),this.drillThroughGrid=new a.Grid({gridLines:"Default",allowResizing:!0,allowReordering:!0,showColumnChooser:!0,toolbar:l,columns:this.frameGridColumns(),enableRtl:this.parent.enableRtl,enableVirtualization:this.parent.editSettings.allowEditing,allowPaging:this.parent.editSettings.allowEditing});var d=this;return this.parent.editSettings.allowEditing?(a.Grid.Inject(a.Edit,a.Page),this.drillThroughGrid.editSettings=this.parent.editSettings,this.parent.editSettings.allowCommandColumns?(this.drillThroughGrid.editSettings.mode="Normal",this.drillThroughGrid.editSettings.allowEditOnDblClick=!1,a.Grid.Inject(a.CommandColumn),this.drillThroughGrid.columns.push({headerText:this.parent.localeObj.getConstant("manageRecords"),width:160,showInColumnChooser:!1,commands:[{type:"Edit",buttonOption:{iconCss:" e-icons e-edit",cssClass:"e-flat"}},{type:"Delete",buttonOption:{iconCss:"e-icons e-delete",cssClass:"e-flat"}},{type:"Save",buttonOption:{iconCss:"e-icons e-update",cssClass:"e-flat"}},{type:"Cancel",buttonOption:{iconCss:"e-icons e-cancel-icon",cssClass:"e-flat"}}]})):this.drillThroughGrid.editSettings.allowEditOnDblClick=this.parent.editSettings.allowEditOnDblClick,this.drillThroughGrid.columns.push({field:"__index",visible:!1,isPrimaryKey:!0,type:"number",showInColumnChooser:!1}),this.drillThroughGrid.actionComplete=function(e){"batchsave"!==e.requestType&&"save"!==e.requestType&&"delete"!==e.requestType||(d.isUpdated=!0),("Normal"===d.drillThroughGrid.editSettings.mode&&"save"===e.requestType&&d.drillThroughGrid.element.querySelectorAll(".e-tbar-btn:hover").length>0&&!d.parent.editSettings.allowCommandColumns||"batchsave"===e.requestType)&&d.dialogPopUp.hide()},this.drillThroughGrid.beforeBatchSave=function(){d.isUpdated=!0}):a.Grid.Inject(a.VirtualScroll),this.drillThroughGrid.appendTo(s),i.appendChild(r),i.appendChild(s),i},e.prototype.frameGridColumns=function(){for(var e=[],t=0,i=Object.keys(this.parent.engineModule.fieldList);t<i.length;t++){var r=i[t];if("CalculatedField"!==this.parent.engineModule.fieldList[r].aggregateType){var a="";a="number"===this.parent.engineModule.fieldList[r].type?"numericedit":"date"===this.parent.engineModule.fieldList[r].type?"datepickeredit":"",e.push({field:r,headerText:this.parent.engineModule.fieldList[r].caption,width:120,visible:this.parent.engineModule.fieldList[r].isSelected,validationRules:{required:!0},editType:a})}}return e},e.prototype.dataWithPrimarykey=function(e){for(var t=Object.keys(e.currentCell.indexObject),i=e.rawData,r=0,a=0,n=i;a<n.length;a++){n[a].__index=t[r],this.gridIndexObjects[t[r].toString()]=Number(t[r]),r++}return i},e}(),Bt=function(){function e(e){this.parent=e,this.drillThroughDialog=new Ht(this.parent),this.addInternalEvents()}return e.prototype.getModuleName=function(){return"drillthrough"},e.prototype.addInternalEvents=function(){this.parent.on(F,this.wireEvents,this)},e.prototype.wireEvents=function(){this.unWireEvents(),t.EventHandler.add(this.parent.element,"dblclick",this.mouseClickHandler,this)},e.prototype.unWireEvents=function(){t.EventHandler.remove(this.parent.element,"dblclick",this.mouseClickHandler)},e.prototype.mouseClickHandler=function(e){var t=e.target,i=null;t.classList.contains("e-stackedheadercelldiv")||t.classList.contains("e-cellvalue")||t.classList.contains("e-headercelldiv")?i=t.parentElement:t.classList.contains("e-headercell")||t.classList.contains("e-rowcell")?i=t:t.classList.contains("e-headertext")&&(i=t.parentElement.parentElement),i&&(this.parent.allowDrillThrough&&i.classList.contains("e-valuescontent")||this.parent.editSettings.allowEditing)&&this.executeDrillThrough(i)},e.prototype.executeDrillThrough=function(e){var t=Number(e.getAttribute("aria-colindex")),i=Number(e.getAttribute("index")),r=this.parent.pivotValues[i][t],a=this.parent.engineModule.fieldList[r.actualText.toString()]?this.parent.engineModule.fieldList[r.actualText.toString()].caption:r.actualText.toString(),n=[];if(void 0!==r.rowHeaders&&void 0!==r.columnHeaders&&void 0!==r.value){for(var o=0,l=Object.keys(r.indexObject);o<l.length;o++){var s=l[o];n.push(this.parent.dataSource.data[Number(s)])}var d=this.parent.engineModule.fieldList[r.actualText].aggregateType,p="CalculatedField"===d?a.toString():d+" of "+a,h={currentTarget:e,currentCell:r,rawData:n,rowHeaders:""===r.rowHeaders?"":r.rowHeaders.toString().split(".").join(" - "),columnHeaders:""===r.columnHeaders?"":r.columnHeaders.toString().split(".").join(" - "),value:p+"("+r.formattedText+")"};this.parent.trigger("drillThrough",h),this.drillThroughDialog.showDrillThroughDialog(h)}},e}(),Ut=function(){var e=function(t,i){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(t,i)};return function(t,i){function r(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),Gt=function(e,t,i,r){var a,n=arguments.length,o=n<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,r);else for(var l=e.length-1;l>=0;l--)(a=e[l])&&(o=(n<3?a(o):n>3?a(t,i,o):a(t,i))||o);return n>3&&o&&Object.defineProperty(t,i,o),o},zt=function(e){function i(){return null!==e&&e.apply(this,arguments)||this}return Ut(i,e),Gt([t.Property(!0)],i.prototype,"showFilterIcon",void 0),Gt([t.Property(!0)],i.prototype,"showSortIcon",void 0),Gt([t.Property(!0)],i.prototype,"showRemoveIcon",void 0),Gt([t.Property(!0)],i.prototype,"showValueTypeIcon",void 0),i}(t.ChildProperty),_t=function(e){function i(){return null!==e&&e.apply(this,arguments)||this}return Ut(i,e),Gt([t.Property(!1)],i.prototype,"allowAdding",void 0),Gt([t.Property(!1)],i.prototype,"allowEditing",void 0),Gt([t.Property(!1)],i.prototype,"allowDeleting",void 0),Gt([t.Property(!1)],i.prototype,"allowCommandColumns",void 0),Gt([t.Property("Normal")],i.prototype,"mode",void 0),Gt([t.Property(!0)],i.prototype,"allowEditOnDblClick",void 0),Gt([t.Property(!0)],i.prototype,"showConfirmDialog",void 0),Gt([t.Property(!1)],i.prototype,"showDeleteConfirmDialog",void 0),i}(t.ChildProperty),Wt=function(e){function i(){return null!==e&&e.apply(this,arguments)||this}return Ut(i,e),Gt([t.Property()],i.prototype,"measure",void 0),Gt([t.Property()],i.prototype,"label",void 0),Gt([t.Property("NotEquals")],i.prototype,"conditions",void 0),Gt([t.Property()],i.prototype,"value1",void 0),Gt([t.Property()],i.prototype,"value2",void 0),i}(t.ChildProperty),Qt=function(e){function i(){return null!==e&&e.apply(this,arguments)||this}return Ut(i,e),Gt([t.Property(!1)],i.prototype,"showHyperlink",void 0),Gt([t.Property(!1)],i.prototype,"showRowHeaderHyperlink",void 0),Gt([t.Property(!1)],i.prototype,"showColumnHeaderHyperlink",void 0),Gt([t.Property(!1)],i.prototype,"showValueCellHyperlink",void 0),Gt([t.Property(!1)],i.prototype,"showSummaryCellHyperlink",void 0),Gt([t.Collection([],Wt)],i.prototype,"conditionalSettings",void 0),Gt([t.Property()],i.prototype,"headerText",void 0),Gt([t.Property("")],i.prototype,"cssClass",void 0),i}(t.ChildProperty),Yt=function(e){function n(t,i){var r=e.call(this,t,i)||this;return r.resizeInfo={},r.scrollPosObject={vertical:0,horizontal:0,verticalSection:0,horizontalSection:0,top:0,left:0,scrollDirection:{direction:"",position:0}},r.pivotColumns=[],r.totColWidth=0,r.posCount=0,r.needsID=!0,r.pivotView=r,r}Ut(n,e),o=n,n.prototype.requiredModules=function(){var e,t=[];return this.allowConditionalFormatting&&t.push({args:[this],member:"conditionalformatting"}),this.allowCalculatedField&&(e=!0,t.push({args:[this],member:"calculatedfield"})),this.showGroupingBar&&(e=!0,t.push({args:[this],member:"grouping"})),this.showFieldList&&(e=!0,t.push({args:[this],member:"fieldlist"})),this.allowExcelExport&&t.push({args:[this],member:"excelExport"}),this.allowPdfExport&&t.push({args:[this],member:"pdfExport"}),this.enableVirtualization&&t.push({args:[this],member:"virtualscroll"}),e&&t.push({args:[this],member:"common"}),t},n.prototype.preRender=function(){this.initProperties(),this.isAdaptive=t.Browser.isDevice,this.renderToolTip(),this.keyboardModule=new qt(this),this.contextMenuModule=new Vt(this),this.globalize=new t.Internationalization(this.locale),this.defaultLocale={grandTotal:"Grand Total",total:"Total",value:"Value",noValue:"No value",row:"Row",column:"Column",collapse:"Collapse",expand:"Expand",rowAxisPrompt:"Drop row here",columnAxisPrompt:"Drop column here",valueAxisPrompt:"Drop value here",filterAxisPrompt:"Drop filter here",filter:"Filter",filtered:"Filtered",sort:"Sort",filters:"Filters",rows:"Rows",columns:"Columns",values:"Values",close:"Close",cancel:"Cancel",delete:"Delete",calculatedField:"Calculated Field",createCalculatedField:"Create Calculated Field",fieldName:"Enter the field name",error:"Error",invalidFormula:"Invalid formula.",dropText:'Example: ("Sum(Order_Count)" + "Sum(In_Stock)") * 250',dropTextMobile:"Add fields and edit formula here.",dropAction:"Calculated field cannot be place in any other region except value axis.",alert:"Alert",warning:"Warning",ok:"OK",search:"Search",drag:"Drag",remove:"Remove",sum:"Sum",average:"Average",count:"Count",min:"Min",max:"Max",allFields:"All Fields",formula:"Formula",addToRow:"Add to Row",addToColumn:"Add to Column",addToValue:"Add to Value",addToFilter:"Add to Filter",emptyData:"No records to display",fieldExist:"A field already exists in this name. Please enter a different name.",confirmText:"A calculation field already exists in this name. Do you want to replace it?",noMatches:"No matches",format:"Summaries values by",edit:"Edit",clear:"Clear",formulaField:"Drag and drop fields to formula",dragField:"Drag field to formula",clearFilter:"Clear",by:"by",member:"Member",label:"Label",date:"Date",enterValue:"Enter value",chooseDate:"Enter date",Before:"Before",BeforeOrEqualTo:"Before Or Equal To",After:"After",AfterOrEqualTo:"After Or Equal To",labelTextContent:"Show the items for which the label",dateTextContent:"Show the items for which the date",valueTextContent:"Show the items for which",Equals:"Equals",DoesNotEquals:"Does Not Equal",BeginWith:"Begins With",DoesNotBeginWith:"Does Not Begin With",EndsWith:"Ends With",DoesNotEndsWith:"Does Not End With",Contains:"Contains",DoesNotContains:"Does Not Contain",GreaterThan:"Greater Than",GreaterThanOrEqualTo:"Greater Than Or Equal To",LessThan:"Less Than",LessThanOrEqualTo:"Less Than Or Equal To",Between:"Between",NotBetween:"Not Between",And:"and",Sum:"Sum",Count:"Count",DistinctCount:"Distinct Count",Product:"Product",Avg:"Avg",Min:"Min",SampleVar:"Sample Var",PopulationVar:"Population Var",RunningTotals:"Running Totals",Max:"Max",Index:"Index",SampleStDev:"Sample StDev",PopulationStDev:"Population StDev",PercentageOfRowTotal:"% of Row Total",PercentageOfParentTotal:"% of Parent Total",PercentageOfParentColumnTotal:"% of Parent Column Total",PercentageOfParentRowTotal:"% of Parent Row Total",DifferenceFrom:"Difference From",PercentageOfDifferenceFrom:"% of Difference From",PercentageOfGrandTotal:"% of Grand Total",PercentageOfColumnTotal:"% of Column Total",NotEquals:"Not Equals",AllValues:"All Values",conditionalFormating:"Conditional Formatting",apply:"APPLY",condition:"Add Condition",formatLabel:"Format",valueFieldSettings:"Value field settings",baseField:"Base field :",baseItem:"Base item :",summarizeValuesBy:"Summarize values by :",sourceName:"Field name :",sourceCaption:"Field caption :",example:"e.g:",editorDataLimitMsg:" more items. Search to refine further.",details:"Details",manageRecords:"Manage Records"},this.localeObj=new t.L10n(this.getModuleName(),this.defaultLocale,this.locale),this.isDragging=!1,this.addInternalEvents()},n.prototype.onBeforeTooltipOpen=function(e){e.element.classList.add("e-pivottooltipwrap")},n.prototype.renderToolTip=function(){this.showTooltip?(this.toolTip=new r.Tooltip({target:"td.e-valuescontent",showTipPointer:!1,enableRtl:this.enableRtl,beforeRender:this.setToolTip.bind(this),beforeOpen:this.onBeforeTooltipOpen}),this.toolTip.appendTo(this.element)):this.toolTip&&this.toolTip.destroy()},n.prototype.initProperties=function(){if(this.setProperties({pivotValues:[]},!0),this.queryCellInfo=this.gridSettings.queryCellInfo?this.gridSettings.queryCellInfo.bind(this):void 0,this.headerCellInfo=this.gridSettings.headerCellInfo?this.gridSettings.headerCellInfo.bind(this):void 0,this.resizing=this.gridSettings.resizing?this.gridSettings.resizing.bind(this):void 0,this.resizeStop=this.gridSettings.resizeStop?this.gridSettings.resizeStop.bind(this):void 0,this.pdfHeaderQueryCellInfo=this.gridSettings.pdfHeaderQueryCellInfo?this.gridSettings.pdfHeaderQueryCellInfo.bind(this):void 0,this.pdfQueryCellInfo=this.gridSettings.pdfQueryCellInfo?this.gridSettings.pdfQueryCellInfo.bind(this):void 0,this.excelHeaderQueryCellInfo=this.gridSettings.excelHeaderQueryCellInfo?this.gridSettings.excelHeaderQueryCellInfo.bind(this):void 0,this.excelQueryCellInfo=this.gridSettings.excelQueryCellInfo?this.gridSettings.excelQueryCellInfo.bind(this):void 0,this.columnDragStart=this.gridSettings.columnDragStart?this.gridSettings.columnDragStart.bind(this):void 0,this.columnDrag=this.gridSettings.columnDrag?this.gridSettings.columnDrag.bind(this):void 0,this.columnDrop=this.gridSettings.columnDrop?this.gridSettings.columnDrop.bind(this):void 0,this.beforeColumnsRender=this.gridSettings.beforeColumnsRender?this.gridSettings.beforeColumnsRender:void 0,this.selected=this.gridSettings.cellSelected?this.gridSettings.cellSelected:void 0,this.cellDeselected=this.gridSettings.cellDeselected?this.gridSettings.cellDeselected:void 0,this.rowSelected=this.gridSettings.rowSelected?this.gridSettings.rowSelected:void 0,this.rowDeselected=this.gridSettings.rowDeselected?this.gridSettings.rowDeselected:void 0,null===this.gridSettings.rowHeight&&this.setProperties({gridSettings:{rowHeight:this.isAdaptive?48:36}},!0),this.enableVirtualization&&(this.height="string"==typeof this.height&&-1===this.height.indexOf("%")?Number(this.height.split("px")[0]):this.height,this.width="string"==typeof this.width&&-1===this.width.indexOf("%")?Number(this.width.split("px")[0]):this.width,this.height="number"==typeof this.height?this.height:300,this.width="number"==typeof this.width?this.width:800),this.enableVirtualization){var e=1,t=1;"row"===this.dataSource.valueAxis?t=this.dataSource.values.length:e=this.dataSource.values.length,this.pageSettings={columnCurrentPage:1,rowCurrentPage:1,columnSize:Math.ceil((Math.floor(this.width/this.gridSettings.columnWidth)-1)/e),rowSize:Math.ceil(Math.floor(this.height/this.gridSettings.rowHeight)/t)},this.allowExcelExport&&o.Inject(kt),this.allowPdfExport&&o.Inject(jt),this.editSettings.allowEditing&&o.Inject(Bt)}},n.prototype.render=function(){r.createSpinner({target:this.element},this.createElement),this.trigger("load",{dataSource:this.dataSource}),this.updateClass(),this.notify(N,{}),this.notify(O,{}),this.isAdaptive&&this.contextMenuModule.render()},n.prototype.addInternalEvents=function(){this.on(O,this.generateData,this),this.on(A,this.renderPivotGrid,this),this.on(F,this.onContentReady,this)},n.prototype.removeInternalEvents=function(){this.off(O,this.generateData),this.off(A,this.renderPivotGrid),this.off(F,this.onContentReady)},n.prototype.getPersistData=function(){return this.addOnPersist(["dataSource","pivotValues","gridSettings"])},n.prototype.getModuleName=function(){return"pivotview"},n.prototype.copy=function(e){this.grid.copy(e)},n.prototype.onPropertyChanged=function(t,i){for(var r=0,a=Object.keys(t);r<a.length;r++){switch(a[r]){case"dataSource":case"hyperlinkSettings":case"allowDrillThrough":case"editSettings":this.notify(O,{});break;case"pivotValues":this.notify(A,{});break;case"gridSettings":this.renderModule.updateGridSettings();break;case"locale":case"currencyCode":this.toolTip&&this.toolTip.destroy(),e.prototype.refresh.call(this);break;case"enableRtl":this.notify(A,{}),this.updateClass();break;case"groupingBarSettings":this.axisFieldModule.render();break;case"showTooltip":this.renderToolTip()}}},n.prototype.renderPivotGrid=function(){this.enableVirtualization&&(this.virtualscrollModule=new Rt(this)),this.hyperlinkSettings&&(this.isRowCellHyperlink=!!this.hyperlinkSettings.showRowHeaderHyperlink||!!this.hyperlinkSettings.showHyperlink,this.isColumnCellHyperlink=!!this.hyperlinkSettings.showColumnHeaderHyperlink||!!this.hyperlinkSettings.showHyperlink,this.isValueCellHyperlink=!!this.hyperlinkSettings.showValueCellHyperlink||!!this.hyperlinkSettings.showHyperlink,this.isSummaryCellHyperlink=!!this.hyperlinkSettings.showSummaryCellHyperlink||!!this.hyperlinkSettings.showHyperlink,this.applyHyperlinkSettings()),(this.allowDrillThrough||this.editSettings.allowEditing)&&(this.drillThroughModule=new Bt(this)),this.renderModule=new Ct(this),this.renderModule.render(),(this.showFieldList||this.showGroupingBar)&&(this.notify(L,this),this.pivotFieldListModule&&this.allowDeferLayoutUpdate&&(this.pivotFieldListModule.clonedDataSource=t.extend({},this.dataSource,null,!0))),this.trigger(w),this.allowConditionalFormatting&&this.applyFormatting()},n.prototype.updateDataSource=function(e){r.showSpinner(this.element),this.engineModule=new c(this.dataSource,"",this.engineModule.fieldList,this.pageSettings,this.enableValueSorting,this.allowDrillThrough||this.editSettings.allowEditing);var t={dataSource:this.dataSource,pivotValues:this.engineModule.pivotValues};this.trigger(g,t),this.pivotCommon.engineModule=this.engineModule,this.pivotCommon.dataSource=this.dataSource,this.setProperties({pivotValues:this.engineModule.pivotValues},!0),this.renderPivotGrid()},n.prototype.destroy=function(){this.removeInternalEvents(),this.showGroupingBar&&this.groupingBarModule&&this.groupingBarModule.destroy(),this.enableVirtualization&&this.virtualscrollModule&&this.virtualscrollModule.destroy(),this.allowConditionalFormatting&&this.conditionalFormattingModule&&this.conditionalFormattingModule.destroy(),this.isAdaptive&&this.contextMenuModule&&this.contextMenuModule.destroy(),this.keyboardModule&&this.keyboardModule.destroy(),this.unwireEvents(),t.removeClass([this.element],q),t.removeClass([this.element],V),t.removeClass([this.element],R),this.element.innerHTML="",e.prototype.destroy.call(this)},n.prototype.excelExport=function(e,t,i,r){this.enableVirtualization?this.excelExportModule.exportToExcel("Excel"):this.grid.excelExport(e,t,i,r)},n.prototype.csvExport=function(e,t,i,r){this.enableVirtualization?this.excelExportModule.exportToExcel("CSV"):this.grid.csvExport(e,t,i,r)},n.prototype.pdfExport=function(e,t,i,r){this.enableVirtualization?this.pdfExportModule.exportToPDF():this.grid.pdfExport(e,t,i,r)},n.prototype.onDrill=function(e){var i=e.parentElement.getAttribute("fieldname"),a=this.engineModule.pivotValues[Number(e.parentElement.getAttribute("index"))][Number(e.parentElement.getAttribute("aria-colindex"))].actualText;this.engineModule.fieldList[i].members[a].isDrilled=!e.classList.contains(We);var n=!1,o=t.extend({},this.dataSource,null,!0).properties;if(o.drilledMembers&&0!==o.drilledMembers.length){for(var l=0;l<o.drilledMembers.length;l++){var s=o.drilledMembers[l];if(s.name===i){n=!0;var d=s.items.indexOf(a);d>-1?s.items.splice(d,1):s.items.push(a)}}n||o.drilledMembers.push({name:i,items:[a]})}else o.drilledMembers=[{name:i,items:[a]}];this.setProperties({dataSource:{drilledMembers:o.drilledMembers}},!0),r.showSpinner(this.element),this.engineModule.generateGridData(this.dataSource),this.setProperties({pivotValues:this.engineModule.pivotValues},!0),this.renderPivotGrid()},n.prototype.onContentReady=function(){if(this.showFieldList?r.hideSpinner(this.pivotFieldListModule.fieldListSpinnerElement):this.fieldListSpinnerElement&&r.hideSpinner(this.fieldListSpinnerElement),this.isEmptyGrid?this.isEmptyGrid=!1:r.hideSpinner(this.element),this.enableVirtualization&&this.engineModule){this.element.querySelector("."+gt)&&!this.element.querySelector("."+gt).querySelector("."+mt)&&(this.virtualDiv=t.createElement("div",{className:mt}),this.element.querySelector("."+gt).appendChild(this.virtualDiv)),this.element.querySelector("."+ft)&&!this.element.querySelector("."+ft).querySelector("."+mt)?(this.virtualHeaderDiv=t.createElement("div",{className:mt}),this.element.querySelector("."+ft).appendChild(this.virtualHeaderDiv)):this.virtualHeaderDiv=this.element.querySelector("."+ft).querySelector("."+mt);var e=this.element.querySelector("."+gt).querySelector(".e-table"),i=this.gridSettings.rowHeight*this.engineModule.rowCount+.1-e.clientHeight,a=this.gridSettings.columnWidth*this.engineModule.columnCount-this.grid.columns[0].width;t.setStyleAttribute(this.virtualDiv,{height:(i>.1?i:.1)+"px",width:(a>.1?a:.1)+"px"}),t.setStyleAttribute(this.virtualHeaderDiv,{height:0,width:(a>.1?a:.1)+"px"});var n=this.element.querySelector("."+gt),o=this.element.querySelector("."+vt),l=this.element.querySelector("."+ft);t.setStyleAttribute(o.querySelector(".e-table"),{transform:"translate(0px,"+this.scrollPosObject.verticalSection+"px)"}),t.setStyleAttribute(n.querySelector(".e-table"),{transform:"translate("+this.scrollPosObject.horizontalSection+"px,"+this.scrollPosObject.verticalSection+"px)"}),t.setStyleAttribute(l.querySelector(".e-table"),{transform:"translate("+this.scrollPosObject.horizontalSection+"px,0px)"})}this.showGroupingBar&&(this.element.style.minWidth="400px",this.grid.element.style.minWidth="400px"),this.unwireEvents(),this.wireEvents()},n.prototype.setToolTip=function(e){var t=Number(e.target.getAttribute("aria-colindex")),i=Number(e.target.getAttribute("index")),r=this.pivotValues[i][t];this.toolTip.content="",r?this.toolTip.content="<div class=e-pivottooltip><p class="+Xe+">"+this.localeObj.getConstant("row")+":</p><p class="+Ke+">"+this.getRowText(i,0)+"</p></br><p class="+Xe+">"+this.localeObj.getConstant("column")+":</p><p class="+Ke+">"+this.getColText(0,t,i)+"</p></br><p class="+Xe+">"+this.localeObj.getConstant("value")+":</p><p class="+Ke+">"+("0"===r.formattedText||""===r.formattedText?this.localeObj.getConstant("noValue"):r.formattedText)+"</p></div>":e.cancel=!0},n.prototype.getRowText=function(e,t){for(var i=this.pivotValues[e][t],r=i.level,a="grand sum"===i.type?this.localeObj.getConstant("grandTotal"):i.formattedText;r>0||void 0===i.index;)e--,void 0!==(i=this.pivotValues[e][t]).index&&(r>i.level&&(a=a+" - "+i.formattedText),r=i.level);return a.split(" - ").reverse().join(" - ")},n.prototype.getColText=function(e,t,i){for(var r=this.pivotValues[0][t],a=r.axis,n="grand sum"===r.type?this.localeObj.getConstant("grandTotal"):r.formattedText;"value"!==a&&i>e;)e++,this.pivotValues[e]&&(a=(r=this.pivotValues[e][t]).axis,"sum"!==r.type&&"grand sum"!==r.type&&"value"!==a&&(n=n+" - "+r.formattedText));return n},n.prototype.updateClass=function(){this.enableRtl?t.addClass([this.element],V):t.removeClass([this.element],V),this.isAdaptive?t.addClass([this.element],R):t.removeClass([this.element],R)},n.prototype.wireEvents=function(){t.EventHandler.add(this.element,this.isAdaptive?"touchend":"click",this.mouseClickHandler,this),window.addEventListener("resize",this.onWindowResize.bind(this),!0)},n.prototype.mouseClickHandler=function(e){var t=e.target;if((t.classList.contains("e-headercell")||t.classList.contains("e-headercelldiv")||t.classList.contains("e-rowsheader")||t.classList.contains("e-rowcell")||t.classList.contains("e-stackedheadercelldiv")||t.classList.contains("e-headertext")||t.classList.contains("e-ascending")||t.classList.contains("e-descending"))&&this.enableValueSorting){var i=null;if(t.classList.contains("e-headercell")||t.classList.contains("e-rowsheader")||t.classList.contains("e-rowcell")?i=t:t.classList.contains("e-stackedheadercelldiv")||t.classList.contains("e-headercelldiv")||t.classList.contains("e-ascending")||t.classList.contains("e-descending")?i=t.parentElement:t.classList.contains("e-headertext")&&(i=t.parentElement.parentElement),this.CellClicked(t),i.parentElement.parentElement.parentElement.parentElement.classList.contains("e-movableheader")&&"column"===this.dataSource.valueAxis||i.parentElement.classList.contains("e-row")&&"row"===this.dataSource.valueAxis){var a=Number(i.getAttribute("aria-colindex")),n=Number(i.getAttribute("index"));"row"===this.dataSource.valueAxis&&this.dataSource.values.length>1?n="value"===this.pivotValues[n][a].type?n:n+1:"column"===this.dataSource.valueAxis&&this.dataSource.values.length>1&&(a=Number(i.getAttribute("aria-colindex"))+Number(i.getAttribute("aria-colspan"))-1,n=this.engineModule.headerContent.length-1),this.setProperties({dataSource:{valueSortSettings:{columnIndex:Number(i.getAttribute("aria-colindex"))+Number(i.getAttribute("aria-colspan"))-1,sortOrder:"Descending"===this.dataSource.valueSortSettings.sortOrder?"Ascending":"Descending",headerText:this.pivotValues[n][a].valueSort.levelName,headerDelimiter:this.dataSource.valueSortSettings.headerDelimiter?this.dataSource.valueSortSettings.headerDelimiter:"."}}},!0),r.showSpinner(this.element),this.engineModule.enableValueSorting=!0,this.engineModule.generateGridData(this.dataSource,this.engineModule.headerCollection),this.setProperties({pivotValues:this.engineModule.pivotValues},!0),this.renderPivotGrid()}}else{if(!t.classList.contains(We)&&!t.classList.contains(Qe))return void this.CellClicked(t);this.onDrill(t)}},n.prototype.framePivotColumns=function(e){for(var t=0,i=e;t<i.length;t++){var r=i[t];if(r.columns&&r.columns.length>0)this.framePivotColumns(r.columns);else{var a="0.formattedText"===r.field?"":r.customAttributes?r.customAttributes.cell.valueSort.levelName:"",n=this.renderModule.setSavedWidth("0.formattedText"===r.field?r.field:a,Number(r.width));this.pivotColumns.push({allowReordering:r.allowReordering,allowResizing:r.allowResizing,headerText:a,width:n}),this.totColWidth=this.totColWidth+Number(n)}}},n.prototype.setGridColumns=function(e){if(this.element.offsetWidth<this.totColWidth){for(var t=0,i=e;t<i.length;t++){var r=i[t];if(r.columns&&r.columns.length>0)this.setGridColumns(r.columns);else{var n="0.formattedText"===r.field?"":r.customAttributes?r.customAttributes.cell.valueSort.levelName:"";r.allowReordering=this.pivotColumns[this.posCount].allowReordering,r.allowResizing=this.pivotColumns[this.posCount].allowResizing,r.width=this.renderModule.setSavedWidth("0.formattedText"===r.field?r.field:n,Number(this.pivotColumns[this.posCount].width)),this.posCount++,r.allowReordering&&(this.gridSettings.allowReordering=!0),r.allowResizing&&(this.gridSettings.allowResizing=!0)}}this.gridSettings.allowReordering&&a.Grid.Inject(a.Reorder),this.gridSettings.allowResizing&&a.Grid.Inject(a.Resize)}},n.prototype.triggerColumnRenderEvent=function(e){this.pivotColumns=[],this.totColWidth=0,this.framePivotColumns(e);var t=this.pivotColumns[0].width,i={columns:this.pivotColumns,dataSource:this.dataSource};this.trigger(E,i),t!==this.pivotColumns[0].width&&this.element.offsetWidth<this.totColWidth&&(this.firstColWidth=this.pivotColumns[0].width),this.posCount=0,this.setGridColumns(e)},n.prototype.setCommonColumnsWidth=function(e,t){for(var i=0,r=e;i<r.length;i++){var a=r[i];"0.formattedText"!==a.field?a.columns?this.setCommonColumnsWidth(a.columns,t):a.width=t:a.width=t<this.firstColWidth?this.firstColWidth:t}},n.prototype.onWindowResize=function(){var e=this;clearTimeout(this.timeOutObj),this.timeOutObj=setTimeout(function(){if(e.element&&e.element.classList.contains("e-pivotview")&&e.engineModule){var t=e.renderModule.calculateColWidth(e.dataSource.values.length>0?e.engineModule.pivotValues[0].length:2);e.grid.width=e.renderModule.calculateGridWidth(),e.setCommonColumnsWidth(e.grid.columns,t),e.posCount=0,e.showGroupingBar||e.setGridColumns(e.grid.columns),e.grid.headerModule.refreshUI(),e.showGroupingBar&&e.groupingBarModule&&e.element.querySelector("."+De)&&e.groupingBarModule.setGridRowWidth()}},500)},n.prototype.CellClicked=function(e){var t=null;e.classList.contains("e-headercell")||e.classList.contains("e-rowcell")?t=e:e.classList.contains("e-stackedheadercelldiv")||e.classList.contains("e-cellvalue")||e.classList.contains("e-headercelldiv")?t=e.parentElement:e.classList.contains("e-headertext")&&(t=e.parentElement.parentElement),t&&this.cellClick&&this.trigger("cellClick",{currentCell:t,data:this.pivotValues[Number(t.getAttribute("index"))][Number(t.getAttribute("aria-colindex"))]})},n.prototype.unwireEvents=function(){t.EventHandler.remove(this.element,this.isAdaptive?"touchend":"click",this.mouseClickHandler),window.removeEventListener("resize",this.onWindowResize.bind(this),!0)},n.prototype.renderEmptyGrid=function(){this.isEmptyGrid=!0,this.element.querySelector(".e-grid")&&t.remove(this.element.querySelector(".e-grid")),this.renderModule=new Ct(this),this.renderModule.bindGrid(this,!0),this.grid.showSpinner=function(){},this.grid.hideSpinner=function(){},this.element.appendChild(t.createElement("div",{id:this.element.id+"_grid"})),this.grid.appendTo("#"+this.element.id+"_grid")},n.prototype.initEngine=function(){this.trigger(m,{dataSource:this.dataSource}),this.engineModule=new c(this.dataSource,"",void 0,this.pageSettings,this.enableValueSorting,this.allowDrillThrough||this.editSettings.allowEditing),this.setProperties({pivotValues:this.engineModule.pivotValues},!0),this.trigger(g,{pivotValues:this.pivotValues}),this.notify(A,{}),this.isEmptyGrid=!1},n.prototype.generateData=function(){var e=this;this.renderEmptyGrid(),r.showSpinner(this.element),this.dataSource&&this.dataSource.data?this.dataSource.data instanceof i.DataManager?setTimeout(function(){e.dataSource.data.executeQuery(new i.Query).then(function(t){e.element.querySelector(".e-spinner-pane")||r.showSpinner(e.element),e.setProperties({dataSource:{data:t.result}},!0),e.initEngine()})},100):this.dataSource.data.length>0?this.initEngine():r.hideSpinner(this.element):r.hideSpinner(this.element)},n.prototype.applyFormatting=function(){if(this.pivotValues){for(var e=[],t=this.pivotValues.length,i=0;i<t;i++)void 0!==this.pivotValues[i]&&void 0===this.pivotValues[i][0]&&e.push(i);for(i=0;i<this.pivotValues.length;i++)for(var r=1;this.pivotValues[i]&&r<this.pivotValues[i].length;r++)if("value"===this.pivotValues[i][r].axis){this.pivotValues[i][r].style=void 0,this.pivotValues[i][r].cssClass=void 0;for(var a=this.dataSource.conditionalFormatSettings,n=0;n<a.length;n++)if(this.checkCondition(this.pivotValues[i][r].value,a[n].conditions,a[n].value1,a[n].value2)){var o="row"===this.dataSource.valueAxis?i:this.engineModule.headerContent.length-1,l="row"===this.dataSource.valueAxis?0:r;(!a[n].measure||1===this.dataSource.values.length||this.pivotValues[o][l].valueSort&&this.pivotValues[o][l].valueSort.levelName.indexOf(a[n].measure)>-1)&&(!a[n].label||this.pivotValues[e[a[n].label.split(".").length-1]]&&this.pivotValues[e[a[n].label.split(".").length-1]][r]&&this.pivotValues[e[a[n].label.split(".").length-1]][r].valueSort&&this.pivotValues[e[a[n].label.split(".").length-1]][r].valueSort[a[n].label]||this.pivotValues[i][0].valueSort.levelName.indexOf(a[n].label)>-1)&&(a[n].style&&a[n].style.backgroundColor&&(a[n].style.backgroundColor=this.conditionalFormattingModule.isHex(a[n].style.backgroundColor.substr(1))?a[n].style.backgroundColor:this.conditionalFormattingModule.colourNameToHex(a[n].style.backgroundColor)),a[n].style&&a[n].style.color&&(a[n].style.color=this.conditionalFormattingModule.isHex(a[n].style.color.substr(1))?a[n].style.color:this.conditionalFormattingModule.colourNameToHex(a[n].style.color)),this.pivotValues[i][r].style=a[n].style,this.pivotValues[i][r].cssClass="format"+this.element.id+n)}}var s=this.dataSource.conditionalFormatSettings;for(n=0;n<s.length;n++){var d=function(){var e=document.createElement("style");return e.appendChild(document.createTextNode("")),document.head.appendChild(e),e.sheet}(),p="color: "+s[n].style.color+"!important;background-color: "+s[n].style.backgroundColor+"!important;font-size: "+s[n].style.fontSize+"!important;font-family: "+s[n].style.fontFamily+" !important;";d.insertRule(".format"+this.element.id+n+"{"+p+"}",0)}}},n.prototype.applyHyperlinkSettings=function(){if(this.pivotValues){for(var e=this.pivotValues,i=[],r=e.length,a=0;a<r;a++)void 0!==e[a]&&void 0===e[a][0]&&i.push(a);if(this.hyperlinkSettings.conditionalSettings.length>0)for(a=0;a<e.length;a++)for(var n=1;e[a]&&n<e[a].length;n++)if("value"===e[a][n].axis){e[a][n].enableHyperlink=!1;for(var o=this.hyperlinkSettings.conditionalSettings,l=0;l<o.length;l++)if(this.checkCondition(e[a][n].value,o[l].conditions,o[l].value1,o[l].value2)){var s="row"===this.dataSource.valueAxis?a:this.engineModule.headerContent.length-1,d="row"===this.dataSource.valueAxis?0:n;(!o[l].measure||1===this.dataSource.values.length||e[s][d].valueSort&&e[s][d].valueSort.levelName.indexOf(o[l].measure)>-1)&&(!o[l].label||e[i[o[l].label.split(".").length-1]]&&e[i[o[l].label.split(".").length-1]][n]&&e[i[o[l].label.split(".").length-1]][n].valueSort&&e[i[o[l].label.split(".").length-1]][n].valueSort[o[l].label]||e[a][0].valueSort.levelName.indexOf(o[l].label)>-1)&&(e[a][n].enableHyperlink=!0)}}if(t.isNullOrUndefined(this.hyperlinkSettings.headerText))return;for(a=0;a<e.length;a++)for(n=1;e[a]&&n<e[a].length;n++)if("value"===e[a][n].axis){var p=this.hyperlinkSettings.headerText;s="row"===this.dataSource.valueAxis?a:this.engineModule.headerContent.length-1,d="row"===this.dataSource.valueAxis?0:n;if(e[i[p.split(".").length-1]]&&e[i[p.split(".").length-1]][n]&&e[i[p.split(".").length-1]][n].valueSort&&e[i[p.split(".").length-1]][n].valueSort[p]){for(var h=0,u=i;h<u.length;h++){var c=u[h];e[c][n]&&"column"===e[c][n].axis&&e[c][n].valueSort.levelName.indexOf(p)>-1&&(e[c][n].enableHyperlink=!0)}e[a][n].enableHyperlink=!0}else e[a][0].valueSort.levelName.indexOf(p)>-1&&(e[a][0].enableHyperlink=!0,e[a][n].enableHyperlink=!0)}}},n.prototype.checkCondition=function(e,t,i,r){switch(t){case"LessThan":return e<i;case"LessThanOrEqualTo":return e<=i;case"GreaterThan":return e>i;case"GreaterThanOrEqualTo":return e>=i;case"Equals":return e===i;case"NotEquals":return e!==i;case"Between":return i<r&&e>=i&&e<=r||i>r&&e<=i&&e>=r;case"NotBetween":return!(i<r&&e>=i&&e<=r||i>r&&e<=i&&e>=r);default:return!1}};var o;return Gt([t.Property("USD")],n.prototype,"currencyCode",void 0),Gt([t.Property(!1)],n.prototype,"showFieldList",void 0),Gt([t.Complex({},It)],n.prototype,"gridSettings",void 0),Gt([t.Complex({},zt)],n.prototype,"groupingBarSettings",void 0),Gt([t.Complex({},Qt)],n.prototype,"hyperlinkSettings",void 0),Gt([t.Complex({},Ft)],n.prototype,"dataSource",void 0),Gt([t.Complex({},_t)],n.prototype,"editSettings",void 0),Gt([t.Property()],n.prototype,"pivotValues",void 0),Gt([t.Property(!1)],n.prototype,"showGroupingBar",void 0),Gt([t.Property(!0)],n.prototype,"showTooltip",void 0),Gt([t.Property(!1)],n.prototype,"showValuesButton",void 0),Gt([t.Property(!1)],n.prototype,"allowCalculatedField",void 0),Gt([t.Property(!1)],n.prototype,"enableValueSorting",void 0),Gt([t.Property(!1)],n.prototype,"allowConditionalFormatting",void 0),Gt([t.Property("auto")],n.prototype,"height",void 0),Gt([t.Property("auto")],n.prototype,"width",void 0),Gt([t.Property(!1)],n.prototype,"allowExcelExport",void 0),Gt([t.Property(!1)],n.prototype,"enableVirtualization",void 0),Gt([t.Property(!1)],n.prototype,"allowDrillThrough",void 0),Gt([t.Property(!1)],n.prototype,"allowPdfExport",void 0),Gt([t.Property(!1)],n.prototype,"allowDeferLayoutUpdate",void 0),Gt([t.Property(1e3)],n.prototype,"maxNodeLimitInMemberEditor",void 0),Gt([t.Event()],n.prototype,"queryCellInfo",void 0),Gt([t.Event()],n.prototype,"headerCellInfo",void 0),Gt([t.Event()],n.prototype,"resizing",void 0),Gt([t.Event()],n.prototype,"resizeStop",void 0),Gt([t.Event()],n.prototype,"pdfHeaderQueryCellInfo",void 0),Gt([t.Event()],n.prototype,"pdfQueryCellInfo",void 0),Gt([t.Event()],n.prototype,"excelHeaderQueryCellInfo",void 0),Gt([t.Event()],n.prototype,"excelQueryCellInfo",void 0),Gt([t.Event()],n.prototype,"columnDragStart",void 0),Gt([t.Event()],n.prototype,"columnDrag",void 0),Gt([t.Event()],n.prototype,"columnDrop",void 0),Gt([t.Event()],n.prototype,"beforeColumnsRender",void 0),Gt([t.Event()],n.prototype,"selected",void 0),Gt([t.Event()],n.prototype,"cellDeselected",void 0),Gt([t.Event()],n.prototype,"rowSelected",void 0),Gt([t.Event()],n.prototype,"rowDeselected",void 0),Gt([t.Event()],n.prototype,"load",void 0),Gt([t.Event()],n.prototype,"enginePopulating",void 0),Gt([t.Event()],n.prototype,"enginePopulated",void 0),Gt([t.Event()],n.prototype,"onFieldDropped",void 0),Gt([t.Event()],n.prototype,"dataBound",void 0),Gt([t.Event()],n.prototype,"created",void 0),Gt([t.Event()],n.prototype,"destroyed",void 0),Gt([t.Event()],n.prototype,"beforeExport",void 0),Gt([t.Event()],n.prototype,"cellClick",void 0),Gt([t.Event()],n.prototype,"drillThrough",void 0),Gt([t.Event()],n.prototype,"hyperlinkCellClick",void 0),Gt([t.Event()],n.prototype,"cellSelected",void 0),n=o=Gt([t.NotifyPropertyChanges],n)}(t.Component),Xt=function(){function e(e){this.keyConfigs={shiftF:"shift+F",shiftS:"shift+S",delete:"delete",enter:"enter"},this.parent=e,this.parent.element.tabIndex=-1===this.parent.element.tabIndex?0:this.parent.element.tabIndex,this.keyboardModule=new t.KeyboardEvents(this.parent.element,{keyAction:this.keyActionHandler.bind(this),keyConfigs:this.keyConfigs,eventName:"keydown"})}return e.prototype.keyActionHandler=function(e){switch(e.action){case"shiftF":this.processFilter(e);break;case"shiftS":this.processSort(e);break;case"delete":this.processDelete(e);break;case"enter":this.processOpenContextMenu(e)}},e.prototype.processOpenContextMenu=function(e){var i=e.target;if(i&&t.closest(i,"."+ee)&&t.closest(i,"."+we))return i.querySelector("."+G).click(),void e.preventDefault()},e.prototype.processSort=function(e){var i=e.target;if(i&&t.closest(i,"."+ee)&&!t.closest(i,"."+we)&&!t.closest(i,"."+ot))return i.querySelector("."+te).click(),void e.preventDefault()},e.prototype.processFilter=function(e){var i=e.target;if(i&&t.closest(i,"."+ee)&&!t.closest(i,"."+we))return i.querySelector("."+re).click(),void e.preventDefault()},e.prototype.processDelete=function(e){var i=e.target;if(i&&t.closest(i,"."+ee))return i.querySelector("."+oe).click(),void e.preventDefault()},e.prototype.destroy=function(){this.keyboardModule&&this.keyboardModule.destroy()},e}(),Kt=function(){function e(e){this.parent=e}return e.prototype.updateSorting=function(e){this.parent.filterDialog.dialogPopUp&&this.parent.filterDialog.dialogPopUp.close();var i=e.target,r=i.parentElement.id,a=i.classList.contains(ie),n=this.getSortItemByName(r);if(t.isNullOrUndefined(n)){l={name:r,order:a?"Ascending":"Descending"};this.parent.dataSource.sortSettings.push(l)}else{for(var o=0;o<this.parent.dataSource.sortSettings.length;o++)if(this.parent.dataSource.sortSettings[o].name===r){this.parent.dataSource.sortSettings.splice(o,1);break}var l={name:r,order:a?"Ascending":"Descending"};this.parent.dataSource.sortSettings.push(l)}a?t.removeClass([i],ie):t.addClass([i],ie)},e.prototype.updateFiltering=function(e){var r=e.target,a=r.parentElement.id,n=r.parentElement.textContent,o=!1,l=[];this.parent.engineModule.fieldList[a].dateMember=new i.DataManager(this.parent.engineModule.fieldList[a].dateMember).executeLocal((new i.Query).sortBy("actualText",this.parent.engineModule.fieldList[a].sort.toLowerCase()));var s=this.getFilterItemByName(a);t.isNullOrUndefined(s)||(o="Include"===s.type,l=s.items);var d=this.getTreeData(o,this.parent.engineModule.fieldList[a].dateMember,l);this.parent.filterDialog.dialogPopUp&&this.parent.filterDialog.dialogPopUp.close();var p;p=p="pivotfieldlist"!==this.parent.moduleName?this.parent.element:document.getElementById(this.parent.parentID+"_Wrapper"),this.parent.filterDialog.createFilterDialog(d,a,n,p)},e.prototype.getSortItemByName=function(e){var t=this.parent.dataSource.sortSettings;return new i.DataManager({json:t}).executeLocal((new i.Query).where("name","equal",e))[0]},e.prototype.getFilterItemByName=function(e){var t=this.parent.dataSource.filterSettings;return new i.DataManager({json:t}).executeLocal((new i.Query).where("name","equal",e))[0]},e.prototype.getFieldByName=function(e,t){return new i.DataManager({json:t}).executeLocal((new i.Query).where("name","equal",e))[0]},e.prototype.getFormatItemByName=function(e){var t=this.parent.dataSource.formatSettings;return new i.DataManager({json:t}).executeLocal((new i.Query).where("name","equal",e))[0]},e.prototype.searchTreeNodes=function(e,t,i){if(i){for(var r=[],a=[],n=0,o=[].slice.call(t.element.querySelectorAll("li"));n<o.length;n++){var l=o[n];l.querySelector(".e-list-text").textContent.toLowerCase().indexOf(e.value.toLowerCase())>-1?r.push(l):a.push(l)}t.enableNodes(r),t.disableNodes(a)}else{r=[];for(var s=0,d=0,p=this.parent.currentTreeItems;d<p.length;d++){(c=p[d]).checkedStatus=void 0===this.parent.savedTreeFilterPos[s],s++}s=1;for(var h=0,u=this.parent.currentTreeItems;h<u.length;h++){var c;(c=u[h]).name.toLowerCase().indexOf(e.value.toLowerCase())>-1&&(s<=this.parent.control.maxNodeLimitInMemberEditor&&r.push(c),s++)}--s>this.parent.control.maxNodeLimitInMemberEditor?(this.parent.editorLabelElement.innerText=s-this.parent.control.maxNodeLimitInMemberEditor+this.parent.control.localeObj.getConstant("editorDataLimitMsg"),this.parent.filterDialog.dialogPopUp.height=this.parent.filterDialog.allowExcelLikeFilter?"440px":"400px",this.parent.isDataOverflow=!0):(this.parent.editorLabelElement.innerText="",this.parent.filterDialog.dialogPopUp.height=this.parent.filterDialog.allowExcelLikeFilter?"400px":"350px",this.parent.isDataOverflow=!1),this.parent.isDataOverflow=s>this.parent.control.maxNodeLimitInMemberEditor,this.parent.editorLabelElement.parentElement.style.display=this.parent.isDataOverflow?"inline-block":"none",t.fields={dataSource:r,id:"id",text:"name",isChecked:"checkedStatus"},t.dataBind()}},e.prototype.getTreeData=function(e,t,i){this.parent.currentTreeItems=[],this.parent.currentTreeItemsPos={},this.parent.savedTreeFilterPos={};for(var r=[],a=1,n={},o=0,l=i;o<l.length;o++){var s=l[o];n[s]=s}for(var d=0,p=t;d<p.length;d++){var h=p[d],u={id:h.formattedText,name:h.formattedText,checkedStatus:!e};void 0!==n[h.formattedText]&&(u.checkedStatus=!!e),a<=this.parent.control.maxNodeLimitInMemberEditor&&r.push(u),u.checkedStatus||(this.parent.savedTreeFilterPos[a-1]=h.formattedText),this.parent.currentTreeItems.push(u),this.parent.currentTreeItemsPos[h.formattedText]=a-1,a++}return this.parent.isDataOverflow=a>this.parent.control.maxNodeLimitInMemberEditor,r},e}(),Zt=function(){function e(e){this.parent=e}return e.prototype.onStateModified=function(e,i){var r="",a=!0,n=t.closest(e.target,"."+be),o=-1;if(this.parent.dataSourceUpdate.btnElement=e.element?e.element.parentElement:void 0,n&&(r=n.classList[1]===Se?"rows":n.classList[1]===Ce?"columns":n.classList[1]===we?"values":n.classList[1]===xe?"filters":""),e.cancel&&""===r||this.parent.dataSourceUpdate.btnElement&&"true"===this.parent.dataSourceUpdate.btnElement.getAttribute("isValue")&&("filters"===r||"values"===r||r.indexOf(this.parent.dataSource.valueAxis)>-1))return a=!1;if(""!==r){if(this.parent.engineModule.fieldList[i]&&"CalculatedField"===this.parent.engineModule.fieldList[i].aggregateType&&"values"!==r){var l=this.parent.localeObj.getConstant("warning"),s=this.parent.localeObj.getConstant("dropAction");return this.parent.errorDialog.createErrorDialog(l,s),a=!1}o=this.getButtonPosition(e.target,r)}else this.parent.engineModule.fieldList[i]&&(this.parent.engineModule.fieldList[i].isSelected=!1);return this.parent.dataSourceUpdate.updateDataSource(i,r,o),a},e.prototype.getButtonPosition=function(e,i){var r=-1,a=t.closest(e,"."+J);if(!t.isNullOrUndefined(a)){a=a.querySelector("."+ee);for(var n=this.parent.element.querySelector(".e-"+i),o=[].slice.call(n.querySelectorAll("."+ee)),l=0,s=o.length;l<s;l++)if(o[l].id===a.id){r=l;break}}return r},e}(),$t=function(){function e(e){this.parent=e}return e.prototype.updateDataSource=function(e,t,i){var r;if(this.control&&this.btnElement&&"true"===this.btnElement.getAttribute("isvalue"))switch(t){case"":this.control.setProperties({dataSource:{values:[]}},!0);break;case"rows":this.control.setProperties({dataSource:{valueAxis:"row"}},!0);break;case"columns":this.control.setProperties({dataSource:{valueAxis:"column"}},!0)}else"CalculatedField"===(r=(r=this.removeFieldFromReport(e.toString()))||this.getNewField(e.toString())).type&&""!==t&&(t="values");if(this.control){var a={droppedField:r,dataSource:this.parent.dataSource,droppedAxis:t};this.control.trigger(v,a)}if(r)switch(t){case"filters":-1!==i?this.parent.dataSource.filters.splice(i,0,r):this.parent.dataSource.filters.push(r);break;case"rows":-1!==i?this.parent.dataSource.rows.splice(i,0,r):this.parent.dataSource.rows.push(r);break;case"columns":-1!==i?this.parent.dataSource.columns.splice(i,0,r):this.parent.dataSource.columns.push(r);break;case"values":-1!==i?this.parent.dataSource.values.splice(i,0,r):this.parent.dataSource.values.push(r)}},e.prototype.removeFieldFromReport=function(e){for(var t,i=!1,r=[this.parent.dataSource.rows,this.parent.dataSource.columns,this.parent.dataSource.values,this.parent.dataSource.filters],a=this.parent.engineModule.fieldList[e],n=0,o=r.length;n<o;n++)if(!i&&r[n])for(var l=0,s=r[n].length;l<s;l++)if(r[n][l].name===e){(t=r[n][l].properties?r[n][l].properties:r[n][l]).type="number"===a.type?t.type:"Count",r[n].splice(l,1),i=!0;break}return t},e.prototype.getNewField=function(e){var t=this.parent.engineModule.fieldList[e];return{name:e,caption:t.caption,type:void 0===t.aggregateType?"number"===t.type?"Sum":"Count":t.aggregateType,showNoDataItems:t.showNoDataItems,baseField:t.baseField,baseItem:t.baseItem}},e}(),Jt=function(){function e(e){this.parent=e}return e.prototype.createErrorDialog=function(e,i){var a=t.createElement("div",{id:this.parent.parentID+"_ErrorDialog",className:ye});this.parent.element.appendChild(a),this.errorPopUp=new r.Dialog({animationSettings:{effect:"Fade"},allowDragging:!1,header:e,content:i,isModal:!0,visible:!0,showCloseIcon:!0,enableRtl:this.parent.enableRtl,width:"auto",height:"auto",zIndex:1000001,position:{X:"center",Y:"center"},buttons:[{click:this.closeErrorDialog.bind(this),buttonModel:{cssClass:ve,content:this.parent.localeObj.getConstant("ok"),isPrimary:!0}}],closeOnEscape:!0,target:document.body,close:this.removeErrorDialog.bind(this)}),this.errorPopUp.appendTo(a)},e.prototype.closeErrorDialog=function(){this.errorPopUp.close()},e.prototype.removeErrorDialog=function(){this.errorPopUp&&!this.errorPopUp.isDestroyed&&this.errorPopUp.destroy(),document.getElementById(this.parent.parentID+"_ErrorDialog")&&t.remove(document.getElementById(this.parent.parentID+"_ErrorDialog"))},e}(),ei=function(){function e(e){this.parent=e}return e.prototype.createFilterDialog=function(e,i,a,n){var o=t.createElement("div",{id:this.parent.parentID+"_EditorTreeView",className:"e-member-editor-dialog",attrs:{"data-fieldName":i,"aria-label":a},styles:"visibility:hidden;"}),l=this.parent.localeObj.getConstant("filter")+' "'+a+'" '+this.parent.localeObj.getConstant("by");this.filterObject=this.getFilterObject(i),this.allowExcelLikeFilter=this.isExcelFilter(i),this.parent.element.appendChild(o),this.dialogPopUp=new r.Dialog({animationSettings:{effect:this.allowExcelLikeFilter?"None":"Fade"},allowDragging:!1,header:this.allowExcelLikeFilter?l:a,content:this.allowExcelLikeFilter?"":this.createTreeView(e,a,i),isModal:"Popup"===this.parent.renderMode||!!this.parent.isAdaptive,visible:!0,showCloseIcon:!!this.allowExcelLikeFilter,enableRtl:this.parent.enableRtl,width:"auto",height:this.parent.isDataOverflow?this.allowExcelLikeFilter?"440px":"400px":this.allowExcelLikeFilter?"400px":"350px",position:{X:"center",Y:"center"},buttons:[{buttonModel:{cssClass:ve,content:this.parent.localeObj.getConstant("ok"),isPrimary:!0}},{buttonModel:{cssClass:"e-clear-filter-button"+(this.allowExcelLikeFilter?"":" "+B),iconCss:"e-icons e-clear-filter-icon",enableRtl:this.parent.enableRtl,content:this.parent.localeObj.getConstant("clearFilter"),disabled:!this.filterObject}},{click:this.closeFilterDialog.bind(this),buttonModel:{cssClass:fe,content:this.parent.localeObj.getConstant("cancel")}}],closeOnEscape:!0,target:n,close:this.removeFilterDialog.bind(this),open:function(e){this.element.querySelector(".e-editor-label-wrapper")&&(this.element.querySelector(".e-editor-label-wrapper").style.width=this.element.offsetWidth+"px")}}),this.dialogPopUp.appendTo(o),this.allowExcelLikeFilter?(this.createTabMenu(e,a,i),t.addClass([this.dialogPopUp.element],"e-excel-filter"),this.updateCheckedState(a)):this.updateCheckedState(a),t.setStyleAttribute(this.dialogPopUp.element,{visibility:"visible"}),this.allowExcelLikeFilter&&this.dialogPopUp.element.querySelector(".e-dlg-closeicon-btn").focus()},e.prototype.createTreeView=function(e,i,r){var a=this,n=t.createElement("div",{id:this.parent.parentID+"EditorDiv",className:pe+(this.allowExcelLikeFilter?" e-excelfilter":"")}),o=t.createElement("div",{id:this.parent.parentID+"_SearchDiv",attrs:{tabindex:"-1"},className:Ze}),d=t.createElement("input",{attrs:{type:"text"}}),p=t.createElement("div",{id:this.parent.parentID+"_LabelDiv",attrs:{tabindex:"-1"},className:"e-editor-label-wrapper"});this.parent.editorLabelElement=t.createElement("label",{className:"e-editor-label"}),this.parent.editorLabelElement.innerText=this.parent.isDataOverflow?this.parent.currentTreeItems.length-this.parent.control.maxNodeLimitInMemberEditor+this.parent.control.localeObj.getConstant("editorDataLimitMsg"):"",p.style.display=this.parent.isDataOverflow?"inline-block":"none",p.appendChild(this.parent.editorLabelElement),o.appendChild(d);var h=t.createElement("div",{id:this.parent.parentID+"_AllDiv",attrs:{tabindex:"-1"},className:"e-select-all-wrapper"}),u=t.createElement("div",{className:"e-select-all"}),c=t.createElement("div",{className:he}),m=t.createElement("div",{className:"e-member-prompt "+B,innerHTML:this.parent.localeObj.getConstant("noMatches")});h.appendChild(u),n.appendChild(o),n.appendChild(h),n.appendChild(m),this.editorSearch=new s.MaskedTextBox({placeholder:this.parent.localeObj.getConstant("search")+' "'+i+'"',enableRtl:this.parent.enableRtl,cssClass:$e,change:function(e){a.parent.eventBase.searchTreeNodes(e,a.memberTreeView,!1);var r=a.dialogPopUp.element;0===[].slice.call(a.memberTreeView.element.querySelectorAll("li")).length?(a.allMemberSelect.disableNodes([a.allMemberSelect.element.querySelector("li")]),r.querySelector("."+ve).setAttribute("disabled","disabled"),t.removeClass([m],B)):(a.allMemberSelect.enableNodes([a.allMemberSelect.element.querySelector("li")]),r.querySelector("."+ve).removeAttribute("disabled"),t.addClass([m],B)),a.updateCheckedState(i)}}),this.editorSearch.appendTo(d);return this.allMemberSelect=new l.TreeView({fields:{dataSource:[{id:"all",name:"All",checkedStatus:!0}],id:"id",text:"name",isChecked:"checkedStatus"},showCheckBox:!0,enableRtl:this.parent.enableRtl}),this.allMemberSelect.appendTo(u),n.appendChild(c),this.memberTreeView=new l.TreeView({fields:{dataSource:e,id:"id",text:"name",isChecked:"checkedStatus"},showCheckBox:!0,enableRtl:this.parent.enableRtl,nodeChecking:this.validateTreeNode.bind(this)}),this.memberTreeView.appendTo(c),n.appendChild(p),n},e.prototype.createTabMenu=function(e,i,r){var a=t.createElement("div",{className:"e-filter-tab-wrapper"});this.dialogPopUp.content=a,this.dialogPopUp.dataBind();for(var n=["Label","Value","Include","Exclude"],o="((-|\\+)?[0-9]+(\\.[0-9]+)?)+",s=Object.keys(this.parent.engineModule.fieldList[r].members)[0],d=this.parent.eventBase.getFormatItemByName(r),p=[{header:{text:this.parent.localeObj.getConstant("member"),iconCss:this.filterObject&&n.indexOf(this.filterObject.type)>1?Be:""},content:this.createTreeView(e,i,r)}],h=0,u=n;h<u.length;h++){var c=u[h];if("Label"===c&&this.parent.dataSource.allowLabelFilter||"Value"===c&&this.parent.dataSource.allowValueFilter){var m="Label"===c&&s.match(o)&&s.match(o)[0].length===s.length?"Number":"Label"===c&&"Invalid Date"!==new Date(s).toString()&&(d&&d.type||this.filterObject&&"Date"===this.filterObject.type)?"Date":c,g={header:{text:"Number"===m?this.parent.localeObj.getConstant("label"):this.parent.localeObj.getConstant(m.toLowerCase()),iconCss:this.filterObject&&this.filterObject.type===m?Be:""},content:this.createCustomFilter(r,this.filterObject&&this.filterObject.type===m?this.filterObject:void 0,m.toLowerCase())};p.push(g)}}var v=this.filterObject?["Label","Date","Number"].indexOf(this.filterObject.type)>=0?1:"Value"===this.filterObject.type?this.parent.dataSource.allowLabelFilter&&this.parent.dataSource.allowValueFilter?2:1:0:0;this.tabObj=new l.Tab({heightAdjustMode:"Auto",items:p,height:"100%",selectedItem:v,enableRtl:this.parent.enableRtl}),this.tabObj.appendTo(a),v>0&&t.addClass([this.dialogPopUp.element.querySelector(".e-filter-div-content."+(1===v&&this.parent.dataSource.allowLabelFilter?"e-label-filter":"e-value-filter"))],"e-selected-tab")},e.prototype.createCustomFilter=function(e,i,r){for(var a=[],n=[],o=this.parent.dataSource.values,l="DoesNotEquals",s=0,d=["Between","NotBetween"],p="label"===r?["Equals","DoesNotEquals","BeginWith","DoesNotBeginWith","EndsWith","DoesNotEndsWith","Contains","DoesNotContains","GreaterThan","GreaterThanOrEqualTo","LessThan","LessThanOrEqualTo","Between","NotBetween"]:"date"===r?["Equals","DoesNotEquals","Before","BeforeOrEqualTo","After","AfterOrEqualTo","Between","NotBetween"]:["Equals","DoesNotEquals","GreaterThan","GreaterThanOrEqualTo","LessThan","LessThanOrEqualTo","Between","NotBetween"],h=0,u=p;h<u.length;h++){var c=u[h];l=i&&c===i.condition?p.indexOf(i.condition)>=0?i.condition:p[0]:l,a.push({value:c,text:this.parent.localeObj.getConstant(c)})}for(var m=o.length;m--;)n.unshift({value:o[m].name,text:o[m].caption?o[m].caption:o[m].name}),s=i&&"Value"===i.type&&i.measure===o[m].name&&i.condition===l?m:s;var g=t.createElement("div",{className:"e-filter-div-content e-"+(["date","number"].indexOf(r)>=0?"label":r)+"-filter",id:this.parent.parentID+"_"+r+"_filter_div_content",attrs:{"data-type":r,"data-fieldName":e,"data-operator":l,"data-measure":this.parent.dataSource.values.length>0?this.parent.dataSource.values[s].name:"","data-value1":i&&l===i.condition?i.value1.toString():"","data-value2":i&&l===i.condition?i.value1.toString():""}}),v=t.createElement("div",{className:"e-filter-text-div",innerHTML:this.parent.localeObj.getConstant(r+"TextContent")}),f=t.createElement("div",{className:Ue+" "+(-1===d.indexOf(l)?B:""),innerHTML:this.parent.localeObj.getConstant("And")}),y=t.createElement("div",{className:"e-separator-div"}),b=t.createElement("div",{className:"e-filter-option-wrapper-1"}),S=t.createElement("div",{className:"e-measure-option-wrapper "+(["label","date","number"].indexOf(r)>=0?B:"")}),C=t.createElement("div",{className:"e-condition-option-wrapper"}),w=t.createElement("div",{className:"e-filter-option-wrapper-2"}),x=t.createElement("div",{id:this.parent.parentID+"_"+r+"_measure_option_wrapper"}),D=t.createElement("div",{id:this.parent.parentID+"_"+r+"_contition_option_wrapper"}),T=t.createElement("div",{className:"e-filter-input-div-1"}),E=t.createElement("div",{className:Ge+" "+(-1===d.indexOf(l)?B:"")}),M=t.createElement("input",{id:this.parent.parentID+"_"+r+"_input_option_1",attrs:{type:"text"}}),P=t.createElement("input",{id:this.parent.parentID+"_"+r+"_input_option_2",attrs:{type:"text"}});return T.appendChild(M),E.appendChild(P),S.appendChild(x),S.appendChild(y),C.appendChild(D),b.appendChild(S),b.appendChild(C),w.appendChild(T),w.appendChild(f),w.appendChild(E),this.createElements(i,d,x,D,M,P,n,a,s,l,r),g.appendChild(v),g.appendChild(b),g.appendChild(w),g},e.prototype.createElements=function(e,i,r,n,o,l,h,u,c,m,g){var v=this;new d.DropDownList({dataSource:h,enableRtl:this.parent.enableRtl,fields:{value:"value",text:"text"},index:c,cssClass:ze,width:"100%",change:function(e){var t=v.dialogPopUp.element.querySelector(".e-selected-tab");v.updateInputValues(t,g,o,l),a.setStyleAndAttributes(t,{"data-measure":e.value})}}).appendTo(r);if(new d.DropDownList({dataSource:u,enableRtl:this.parent.enableRtl,fields:{value:"value",text:"text"},value:m,cssClass:_e,width:"100%",change:function(e){var r=v.dialogPopUp.element.querySelector(".e-selected-tab");v.updateInputValues(r,g,o,l);for(var n=0,s=[Ue,Ge];n<s.length;n++){var d=s[n];i.indexOf(e.value)>=0?t.removeClass([r.querySelector("."+d)],B):t.addClass([r.querySelector("."+d)],B)}a.setStyleAndAttributes(r,{"data-operator":e.value})}}).appendTo(n),"date"===g){var f=new p.DatePicker({placeholder:this.parent.localeObj.getConstant("chooseDate"),enableRtl:this.parent.enableRtl,format:"dd/MM/yyyy",value:e&&m===e.condition?e.value1:null,change:function(e){var t=v.dialogPopUp.element.querySelector(".e-selected-tab");a.setStyleAndAttributes(t,{"data-value1":e.value,"data-value2":y.value})},width:"100%"}),y=new p.DatePicker({placeholder:this.parent.localeObj.getConstant("chooseDate"),enableRtl:this.parent.enableRtl,format:"dd/MM/yyyy",value:e&&m===e.condition?e.value2:null,change:function(e){var t=v.dialogPopUp.element.querySelector(".e-selected-tab");a.setStyleAndAttributes(t,{"data-value1":f.value,"data-value2":e.value})},width:"100%"});f.appendTo(o),y.appendTo(l)}else{var b=new s.MaskedTextBox({placeholder:this.parent.localeObj.getConstant("enterValue"),enableRtl:this.parent.enableRtl,value:e&&m===e.condition?e.value1:"",change:function(e){var t=v.dialogPopUp.element.querySelector(".e-selected-tab");a.setStyleAndAttributes(t,{"data-value1":e.value,"data-value2":S.value})},width:"100%"}),S=new s.MaskedTextBox({placeholder:this.parent.localeObj.getConstant("enterValue"),enableRtl:this.parent.enableRtl,value:e&&m===e.condition?e.value2:"",change:function(e){var t=v.dialogPopUp.element.querySelector(".e-selected-tab");a.setStyleAndAttributes(t,{"data-value1":b.value,"data-value2":e.value})},width:"100%"});b.appendTo(o),S.appendTo(l)}},e.prototype.updateInputValues=function(e,i,r,n){var o,l;if("date"===i){var s=r.ej2_instances[0],d=n.ej2_instances[0];o=t.isNullOrUndefined(s.value)?"":s.value.toString(),l=t.isNullOrUndefined(d.value)?"":d.value.toString()}else{s=r.ej2_instances[0],d=n.ej2_instances[0];o=s.value,l=d.value}a.setStyleAndAttributes(e,{"data-value1":o,"data-value2":l})},e.prototype.validateTreeNode=function(e){e.node.classList.contains(B)&&(e.cancel=!0)},e.prototype.updateCheckedState=function(e){var i=this.dialogPopUp.element;a.setStyleAndAttributes(i,{role:"menu","aria-haspopup":"true"});var r=[].slice.call(this.memberTreeView.element.querySelectorAll("li")),n=this.getUnCheckedNodes(),o=this.getCheckedNodes(),l=this.allMemberSelect.element.querySelector("li").querySelector("span.e-frame");r.length>0?o.length>0?(n.length>0?(t.removeClass([l],ge),t.addClass([l],"e-stop")):0===n.length&&(t.removeClass([l],"e-stop"),t.addClass([l],ge)),i.querySelector("."+ve).removeAttribute("disabled")):n.length>0&&0===o.length&&(t.removeClass([l],[ge,"e-stop"]),this.getCheckedNodes().length===o.length&&i.querySelector("."+ve).setAttribute("disabled","disabled")):i.querySelector("."+ve).setAttribute("disabled","disabled")},e.prototype.getCheckedNodes=function(){return this.parent.currentTreeItems.filter(function(e){return e.checkedStatus})},e.prototype.getUnCheckedNodes=function(){return this.parent.currentTreeItems.filter(function(e){return!e.checkedStatus})},e.prototype.isExcelFilter=function(e){for(var t=!1,i=0,r=this.parent.dataSource.filters;i<r.length;i++){if(r[i].name===e){t=!0;break}}return!(t||!this.parent.dataSource.allowLabelFilter&&!this.parent.dataSource.allowValueFilter)},e.prototype.getFilterObject=function(e){var t=this.parent.eventBase.getFilterItemByName(e);if(t&&(["Label","Date","Number"].indexOf(t.type)>=0&&this.parent.dataSource.allowLabelFilter||"Value"===t.type&&this.parent.dataSource.allowValueFilter||["Include","Exclude"].indexOf(t.type)>=0))return t},e.prototype.closeFilterDialog=function(){this.allowExcelLikeFilter&&this.tabObj&&!this.tabObj.isDestroyed&&this.tabObj.destroy(),this.dialogPopUp.close()},e.prototype.removeFilterDialog=function(){this.dialogPopUp&&!this.dialogPopUp.isDestroyed&&this.dialogPopUp.destroy(),document.getElementById(this.parent.parentID+"_EditorTreeView")&&t.remove(document.getElementById(this.parent.parentID+"_EditorTreeView"))},e}(),ti=function(){function e(e){return this.currentTreeItems=[],this.savedTreeFilterPos={},this.currentTreeItemsPos={},this.isDataOverflow=!1,this.element=e.element,this.moduleName=e.moduleName,this.dataSource=e.dataSource,this.engineModule=e.pivotEngine,this.enableRtl=e.enableRtl,this.isAdaptive=e.isAdaptive,this.renderMode=e.renderMode,this.parentID=e.id,this.localeObj=e.localeObj,this.nodeStateModified=new Zt(this),this.dataSourceUpdate=new $t(this),this.eventBase=new Kt(this),this.filterDialog=new ei(this),this.errorDialog=new Jt(this),this.keyboardModule=new Xt(this),this}return e.prototype.destroy=function(){this.keyboardModule&&this.keyboardModule.destroy()},e}(),ii=function(){function e(e){this.parent=e}return e.prototype.render=function(){var e=t.createElement("div",{id:this.parent.element.id+"_Wrapper",className:"e-pivotfieldlist-wrapper",styles:"width:"+this.parent.element.style.width});this.parent.isAdaptive?t.addClass([e],R):t.removeClass([e],R),this.parent.enableRtl?t.addClass([e],V):t.removeClass([e],V),this.parent.cssClass&&t.addClass([e],this.parent.cssClass),this.parentElement=t.createElement("div",{className:"e-field-list-container"}),this.parent.element.appendChild(e),this.parent.isAdaptive&&(e.removeAttribute("style"),this.parentElement=t.createElement("div",{className:"e-adaptive-container"}),this.renderAdaptiveLayout(e)),"Popup"===this.parent.renderMode?(this.renderFieldListDialog(e),this.unWireDialogEvent(this.parent.element.querySelector("."+z)),this.wireDialogEvent(this.parent.element.querySelector("."+z))):this.renderStaticLayout(e)},e.prototype.renderStaticLayout=function(e){if(!this.parent.isAdaptive){var i=t.createElement("div",{className:"e-field-list-title"}),r=t.createElement("div",{className:"e-title-content",innerHTML:this.parent.localeObj.getConstant("staticFieldList")});i.appendChild(r),i.appendChild(this.createCalculatedButton()),t.addClass([e],_),e.appendChild(i),e.appendChild(this.parentElement),t.addClass([e],_),this.parent.allowDeferLayoutUpdate&&(e.appendChild(this.createDeferUpdateButtons()),this.renderDeferUpdateButtons())}},e.prototype.renderDeferUpdateButtons=function(){if(this.parent.allowDeferLayoutUpdate){new h.CheckBox({label:this.parent.localeObj.getConstant("deferLayoutUpdate"),checked:!0,enableRtl:this.parent.enableRtl,change:this.onCheckChange.bind(this)}).appendTo("#"+this.parent.element.id+"DeferUpdateCheckBox"),this.deferUpdateApplyButton=new h.Button({cssClass:yt+" "+St+("Popup"===this.parent.renderMode?" "+Ve:""),content:this.parent.localeObj.getConstant("apply"),enableRtl:this.parent.enableRtl,isPrimary:!0}),this.deferUpdateApplyButton.appendTo("#"+this.parent.element.id+"_DeferUpdateButton1"),this.deferUpdateApplyButton.element.onclick="Fixed"===this.parent.renderMode?this.applyButtonClick.bind(this):this.onDeferUpdateClick.bind(this)}this.deferUpdateCancelButton=new h.Button({cssClass:bt+" "+fe+("Popup"===this.parent.renderMode?" "+Ve:""),content:this.parent.allowDeferLayoutUpdate?this.parent.localeObj.getConstant("cancel"):this.parent.localeObj.getConstant("close"),enableRtl:this.parent.enableRtl,isPrimary:!this.parent.allowDeferLayoutUpdate}),this.deferUpdateCancelButton.appendTo("#"+this.parent.element.id+"_DeferUpdateButton2"),this.deferUpdateCancelButton.element.onclick="Fixed"===this.parent.renderMode?this.cancelButtonClick.bind(this):this.onCloseFieldList.bind(this)},e.prototype.createDeferUpdateButtons=function(){var e=t.createElement("div",{className:"e-layout-footer"});if(this.parent.allowDeferLayoutUpdate){var i=t.createElement("div",{className:"e-checkbox-layout"}),r=t.createElement("input",{id:this.parent.element.id+"DeferUpdateCheckBox"});i.appendChild(r),e.appendChild(i)}var a=t.createElement("div",{className:"e-button-layout"});if(this.parent.allowDeferLayoutUpdate){var n=t.createElement("button",{id:this.parent.element.id+"_DeferUpdateButton1"});a.appendChild(n)}var o=t.createElement("button",{id:this.parent.element.id+"_DeferUpdateButton2"});return a.appendChild(o),e.appendChild(a),e},e.prototype.onCheckChange=function(e){e.checked&&(this.parent.clonedDataSource=t.extend({},this.parent.dataSource,null,!0),this.parent.clonedFieldList=t.extend({},this.parent.pivotFieldList,null,!0)),this.parent.allowDeferLayoutUpdate=!this.parent.allowDeferLayoutUpdate,"Fixed"===this.parent.renderMode?(this.deferUpdateApplyButton.setProperties({disabled:!this.parent.allowDeferLayoutUpdate}),this.deferUpdateCancelButton.setProperties({disabled:!this.parent.allowDeferLayoutUpdate})):this.parent.allowDeferLayoutUpdate?(this.deferUpdateApplyButton.element.style.display="",this.deferUpdateCancelButton.setProperties({content:this.parent.localeObj.getConstant("cancel")}),this.deferUpdateCancelButton.isPrimary=!1):(this.deferUpdateApplyButton.element.style.display="none",this.deferUpdateCancelButton.setProperties({content:this.parent.localeObj.getConstant("close")}),this.deferUpdateCancelButton.isPrimary=!0),this.cancelButtonClick()},e.prototype.applyButtonClick=function(){this.parent.updateDataSource(!1),this.parent.clonedDataSource=t.extend({},this.parent.dataSource,null,!0),this.parent.clonedFieldList=t.extend({},this.parent.pivotFieldList,null,!0)},e.prototype.cancelButtonClick=function(){this.parent.setProperties({dataSource:this.parent.clonedDataSource.properties},!0),this.parent.engineModule.fieldList=t.extend({},this.parent.clonedFieldList,null,!0),this.parent.updateDataSource(!1,!0)},e.prototype.renderFieldListDialog=function(e){var i=t.createElement("div",{className:z+" "+H+" e-select-table",attrs:{tabindex:"0",title:this.parent.localeObj.getConstant("fieldList"),"aria-disabled":"false","aria-label":this.parent.localeObj.getConstant("fieldList")}});if(this.parent.element.appendChild(i),this.parent.isAdaptive){var a=[{click:this.showFieldListDialog.bind(this),buttonModel:{cssClass:Ne+" "+ke+" "+je,iconCss:H+" "+qe,isPrimary:!0}},{click:this.showCalculatedField.bind(this),buttonModel:{cssClass:Ie+" "+ke+" "+je+" "+B,iconCss:H+" "+qe,enableRtl:this.parent.enableRtl,isPrimary:!0}},{click:this.onDeferUpdateClick.bind(this),buttonModel:{content:this.parent.localeObj.getConstant("apply"),enableRtl:this.parent.enableRtl,cssClass:yt+" "+St+" "+Ve,isPrimary:!0}},{click:this.onCloseFieldList.bind(this),buttonModel:{cssClass:bt+" "+fe+" "+Ve,content:this.parent.allowDeferLayoutUpdate?this.parent.localeObj.getConstant("cancel"):this.parent.localeObj.getConstant("close"),enableRtl:this.parent.enableRtl}}];this.parent.allowDeferLayoutUpdate||a.splice(2,1),this.fieldListDialog=new r.Dialog({animationSettings:{effect:"Zoom"},content:this.parentElement,isModal:!0,showCloseIcon:!1,visible:!1,allowDragging:!1,closeOnEscape:!1,enableRtl:this.parent.enableRtl,width:"100%",height:"100%",position:{X:"center",Y:"center"},buttons:a,target:document.body,close:this.removeFieldListIcon.bind(this)}),this.fieldListDialog.appendTo(e),t.setStyleAttribute(e.querySelector("#"+e.id+"_dialog-content"),{padding:"0"});var n=e.querySelector(".e-footer-content");t.addClass([n],Q),t.removeClass([n.querySelector("."+Ie)],Ve),t.removeClass([n.querySelector("."+Ne)],Ve)}else{var o=this.createDeferUpdateButtons().outerHTML,l="<div class="+Fe+"><div class=e-title-content>"+this.parent.localeObj.getConstant("fieldList")+"</div></div>";this.fieldListDialog=new r.Dialog({animationSettings:{effect:"Zoom"},header:l,content:this.parentElement,isModal:!1,showCloseIcon:!1,visible:!1,allowDragging:!0,enableRtl:this.parent.enableRtl,width:this.parent.element.style.width,position:{X:"center",Y:this.parent.element.offsetTop},footerTemplate:o,closeOnEscape:!0,target:t.isNullOrUndefined(this.parent.target)?document.body:"string"==typeof this.parent.target?document.querySelector(this.parent.target):this.parent.target,close:this.removeFieldListIcon.bind(this)}),this.fieldListDialog.appendTo(e),this.renderDeferUpdateButtons(),t.setStyleAttribute(e.querySelector("#"+e.id+"_title"),{width:"100%"}),e.querySelector("."+Fe).appendChild(this.createCalculatedButton())}},e.prototype.updateDataSource=function(e){for(var t=["filters","columns","rows","values"],i=0,r=e;i<r.length;i++){var a=r[i],n=t[this.adaptiveElement.selectedItem];this.parent.pivotCommon.dataSourceUpdate.control="pivotview"===this.parent.getModuleName()?this.parent:this.parent.pivotGridModule?this.parent.pivotGridModule:this.parent,this.parent.pivotCommon.dataSourceUpdate.updateDataSource(a,n,-1)}this.parent.axisFieldModule.render(),this.parent.allowDeferLayoutUpdate?this.parent.triggerPopulateEvent():this.parent.updateDataSource(!0)},e.prototype.onDeferUpdateClick=function(){this.parent.updateDataSource(),this.parent.dialogRenderer.fieldListDialog.hide()},e.prototype.renderAdaptiveLayout=function(e){var i=this,r=t.createElement("div",{className:Q});e.appendChild(this.parentElement);var a=[{header:{text:this.parent.localeObj.getConstant("filters")},content:this.createAxisTable("filters")},{header:{text:this.parent.localeObj.getConstant("columns")},content:this.createAxisTable("columns")},{header:{text:this.parent.localeObj.getConstant("rows")},content:this.createAxisTable("rows")},{header:{text:this.parent.localeObj.getConstant("values")},content:this.createAxisTable("values")},{header:{text:this.parent.localeObj.getConstant("createCalculatedField")},content:"Calculated Field Related UI"}];this.parent.allowCalculatedField||a.pop(),this.adaptiveElement=new l.Tab({heightAdjustMode:"Auto",items:a,height:"100%",enableRtl:this.parent.enableRtl,selected:function(r){e.querySelector("."+Ne)&&(4!==r.selectedIndex?(t.addClass([e.querySelector("."+Ie)],B),t.removeClass([e.querySelector("."+Ne)],B)):(t.removeClass([e.querySelector("."+Ie)],B),t.addClass([e.querySelector("."+Ne)],B))),4===r.selectedIndex?(i.adaptiveElement.items[4].content="",i.adaptiveElement.dataBind(),i.parent.notify(j,{})):i.parent.axisFieldModule.render()}}),"Fixed"===this.parent.renderMode?(r.appendChild(this.createAddButton()),t.addClass([e],_),this.adaptiveElement.appendTo(this.parentElement),this.parentElement.appendChild(r)):this.adaptiveElement.appendTo(this.parentElement)},e.prototype.createCalculatedButton=function(){var e=t.createElement("div",{id:this.parent.element.id+"_CalculatedField"}),i=new h.Button({cssClass:"e-calculated-field "+B,content:this.parent.localeObj.getConstant("calculatedField"),enableRtl:this.parent.enableRtl});return i.appendTo(e),this.parent.calculatedFieldModule&&t.removeClass([e],B),i.element.onclick=this.showCalculatedField.bind(this),e},e.prototype.createAddButton=function(){var e=t.createElement("div",{className:Q+"-content"}),i=t.createElement("div",{}),r=t.createElement("div",{}),a=new h.Button({cssClass:Ie+" "+ke+" "+je+" "+B,iconCss:H+" "+qe,enableRtl:this.parent.enableRtl}),n=new h.Button({cssClass:Ne+" "+ke+" "+je,iconCss:H+" "+qe,enableRtl:this.parent.enableRtl});return n.appendTo(i),a.appendTo(r),e.appendChild(i),e.appendChild(r),a.element.onclick=this.showCalculatedField.bind(this),n.element.onclick=this.showFieldListDialog.bind(this),e},e.prototype.createAxisTable=function(e){var i=t.createElement("div",{className:W+"-"+e}),r=t.createElement("div",{className:Z+" e-"+e}),a=t.createElement("span",{className:$,innerHTML:this.parent.localeObj.getConstant("addPrompt")});return i.appendChild(r),i.appendChild(a),i},e.prototype.showCalculatedField=function(e){this.parent.isAdaptive||this.parent.dialogRenderer.fieldListDialog&&(this.parent.dialogRenderer.fieldListDialog.hide(),t.addClass([this.parent.element.querySelector("."+z)],U)),this.parent.notify(j,{})},e.prototype.showFieldListDialog=function(e){var t=this.adaptiveElement.selectedItem;this.parent.treeViewModule.render(t)},e.prototype.onShowFieldList=function(){this.parent.allowDeferLayoutUpdate&&(this.parent.isAdaptive&&this.parent.axisFieldModule.render(),this.parent.clonedDataSource=t.extend({},this.parent.dataSource,null,!0),this.parent.clonedFieldList=t.extend({},this.parent.pivotFieldList,null,!0)),t.addClass([this.parent.element.querySelector("."+z)],U),this.parent.dialogRenderer.fieldListDialog.show(),this.parent.dialogRenderer.fieldListDialog.element.style.top=parseInt(this.parent.dialogRenderer.fieldListDialog.element.style.top,10)<0?"0px":this.parent.dialogRenderer.fieldListDialog.element.style.top},e.prototype.onCloseFieldList=function(){this.parent.allowDeferLayoutUpdate&&(this.parent.dataSource=t.extend({},this.parent.clonedDataSource.properties,null,!0),this.parent.pivotGridModule.engineModule=this.parent.engineModule,this.parent.pivotGridModule.setProperties({dataSource:this.parent.clonedDataSource.properties},!0),this.parent.engineModule.fieldList=t.extend({},this.parent.clonedFieldList,null,!0),this.parent.pivotGridModule.notify(L,this),this.parent.pivotGridModule.notify(F,this)),this.parent.dialogRenderer.fieldListDialog.hide()},e.prototype.removeFieldListIcon=function(){document.getElementById(this.parent.element.id+"calculateddialog")||t.removeClass([this.parent.element.querySelector("."+z)],U)},e.prototype.keyPress=function(e){e.target;if(13===e.keyCode&&e.target)return e.target.click(),void e.preventDefault()},e.prototype.wireDialogEvent=function(e){t.EventHandler.add(e,"keydown",this.keyPress,this),t.EventHandler.add(e,"click",this.onShowFieldList,this)},e.prototype.unWireDialogEvent=function(e){t.EventHandler.remove(e,"keydown",this.keyPress),t.EventHandler.remove(e,"click",this.onShowFieldList)},e}(),ri=function(){function e(e){this.selectedNodes=[],this.parent=e,this.addEventListener()}return e.prototype.render=function(e){if(this.parentElement=this.parent.dialogRenderer.parentElement,this.parent.isAdaptive)this.renderTreeDialog(e);else{var i=t.createElement("div",{className:"e-field-table"}),r=t.createElement("div",{className:"e-field-header",innerHTML:this.parent.localeObj.getConstant("allFields")});if(this.treeViewElement=t.createElement("div",{id:this.parent.element.id+"_TreeView",className:W}),i.appendChild(r),i.appendChild(this.treeViewElement),this.parentElement.appendChild(i),"Fixed"===this.parent.renderMode){var a=t.createElement("div",{className:"e-center-div"}),n=t.createElement("div",{className:"e-center-title",innerHTML:this.parent.localeObj.getConstant("centerHeader")});this.parentElement.appendChild(a),this.parentElement.appendChild(n)}this.renderTreeView()}},e.prototype.renderTreeView=function(){this.fieldTable=new l.TreeView({fields:{dataSource:this.getTreeData(),id:"id",text:"caption",isChecked:"isSelected"},nodeChecked:this.nodeStateChange.bind(this),cssClass:"e-field-list-tree",showCheckBox:!0,allowDragAndDrop:!0,sortOrder:"Ascending",enableRtl:this.parent.enableRtl,nodeDragStart:this.dragStart.bind(this),nodeDragStop:this.dragStop.bind(this)}),this.treeViewElement.innerHTML="",this.fieldTable.appendTo(this.treeViewElement),this.getTreeUpdate()},e.prototype.renderTreeDialog=function(e){var i=this,a=t.createElement("div",{id:this.parent.element.id+"_FieldListTreeView",className:"e-adaptive-field-list-dialog"});this.parentElement.appendChild(a),this.fieldDialog=new r.Dialog({animationSettings:{effect:"Fade"},allowDragging:!1,header:this.parent.localeObj.getConstant("adaptiveFieldHeader"),content:this.createTreeView(this.getTreeData(e)),isModal:!0,visible:!0,showCloseIcon:!1,enableRtl:this.parent.enableRtl,width:"auto",height:"350px",position:{X:"center",Y:"center"},buttons:[{click:this.closeTreeDialog.bind(this),buttonModel:{cssClass:fe,content:this.parent.localeObj.getConstant("cancel")}},{click:this.onFieldAdd.bind(this),buttonModel:{cssClass:ve,content:this.parent.localeObj.getConstant("add"),isPrimary:!0}}],closeOnEscape:!0,target:this.parentElement.parentElement,close:function(){document.getElementById(i.parent.element.id+"_FieldListTreeView")&&t.remove(document.getElementById(i.parent.element.id+"_FieldListTreeView"))}}),this.fieldDialog.appendTo(a)},e.prototype.createTreeView=function(e){var i=this,r=t.createElement("div",{id:this.parent.element.id+"EditorDiv",className:pe}),a=t.createElement("div",{id:this.parent.element.id+"_SearchDiv",attrs:{tabindex:"-1"},className:Ze}),n=t.createElement("input",{attrs:{type:"text"}});a.appendChild(n);var o=t.createElement("div",{className:he});return r.appendChild(a),this.editorSearch=new s.MaskedTextBox({placeholder:this.parent.localeObj.getConstant("search"),enableRtl:this.parent.enableRtl,cssClass:$e,change:function(e){i.parent.pivotCommon.eventBase.searchTreeNodes(e,i.fieldTable,!0)}}),this.editorSearch.appendTo(n),r.appendChild(o),this.fieldTable=new l.TreeView({fields:{dataSource:e,id:"id",text:"caption",isChecked:"isSelected"},showCheckBox:!0,sortOrder:"Ascending",enableRtl:this.parent.enableRtl,nodeChecked:this.addNode.bind(this)}),this.fieldTable.appendTo(o),r},e.prototype.dragStart=function(e){if(e.event.target.classList.contains(le)){this.parent.isDragging=!0,t.addClass([e.draggedNode.querySelector("."+Re)],Le);var i=this.parent.engineModule.fieldList[e.draggedNode.getAttribute("data-uid")],r=[Se,Ce,xe];if(i&&"CalculatedField"===i.aggregateType)for(var a=0,n=r;a<n.length;a++){var o=n[a];t.addClass([this.parentElement.querySelector("."+o)],Oe)}}else e.cancel=!0},e.prototype.dragStop=function(e){e.cancel=!0,this.parent.isDragging=!1;for(var i=0,r=[Se,Ce,xe];i<r.length;i++){var a=r[i];t.removeClass([this.parentElement.querySelector("."+a)],Oe)}t.removeClass([e.draggedNode.querySelector("."+Re)],Le),this.parent.pivotCommon.filterDialog.dialogPopUp&&this.parent.pivotCommon.filterDialog.dialogPopUp.close();var n=e.draggedNodeData.id.toString();this.isNodeDropped(e,n)&&(this.parent.pivotCommon.dataSourceUpdate.control="pivotview"===this.parent.getModuleName()?this.parent:this.parent.pivotGridModule?this.parent.pivotGridModule:this.parent,this.parent.pivotCommon.nodeStateModified.onStateModified(e,n)&&(this.parent.allowDeferLayoutUpdate?this.updateDataSource():this.parent.updateDataSource(),this.parent.axisFieldModule.render()))},e.prototype.isNodeDropped=function(e,i){var r=!0;if("true"===e.draggedNodeData.isChecked){var a=this.getButton(i),n=t.closest(a,"."+be),o=t.closest(e.target,"."+be);if(a&&n===o){for(var l=[].slice.call(n.querySelectorAll("."+ee)),s=t.closest(e.target,"."+J),d=void 0,p=-1,h=0,u=l.length;h<u;h++)if(l[h].id===a.id&&(d=h),s){var c=s.querySelector("."+ee);l[h].id===c.id&&(p=h)}if(d===p||d===l.length-1&&-1===p){var m=document.getElementById(this.parent.element.id+"_Wrapper");t.removeClass([].slice.call(m.querySelectorAll("."+se)),de),r=!1}}}return r},e.prototype.getButton=function(e){for(var t,i=document.getElementById(this.parent.element.id+"_Wrapper"),r=[].slice.call(i.querySelectorAll("."+ee)),a=0,n=r.length;a<n;a++)if(r[a].id===e){t=r[a];break}return t},e.prototype.nodeStateChange=function(e){this.parent.pivotCommon.filterDialog.dialogPopUp&&this.parent.pivotCommon.filterDialog.dialogPopUp.close();var i=t.closest(e.node,"."+Ae),r=this.parent.pivotFieldList[e.data[0].id.toString()];if("check"===e.action){t.addClass([i.querySelector("."+Re)],He);var a=this.parent.pivotCommon.dataSourceUpdate.getNewField(e.data[0].id.toString());"number"===r.type?this.parent.dataSource.values.push(a):this.parent.dataSource.rows.push(a)}else t.removeClass([i.querySelector("."+Re)],He),this.parent.pivotCommon.dataSourceUpdate.removeFieldFromReport(e.data[0].id.toString());this.parent.allowDeferLayoutUpdate?("check"===e.action?r.isSelected=!0:r.isSelected=!1,this.updateDataSource()):this.parent.updateDataSource(!0),this.parent.axisFieldModule.render()},e.prototype.updateDataSource=function(){"pivotfieldlist"===this.parent.getModuleName()&&"Popup"===this.parent.renderMode?(this.parent.pivotGridModule.engineModule=this.parent.engineModule,this.parent.pivotGridModule.setProperties({dataSource:this.parent.dataSource.properties},!0),this.parent.pivotGridModule.notify(L,this)):this.parent.triggerPopulateEvent()},e.prototype.addNode=function(e){var t=this.parent.pivotFieldList[e.data[0].id.toString()];if("check"===e.action)this.selectedNodes.push(t.id.toString());else for(var i=this.selectedNodes.length;i--;)if(this.selectedNodes[i]===t.id.toString()){this.selectedNodes.splice(i,1);break}},e.prototype.getTreeUpdate=function(){for(var e=0,i=[].slice.call(this.treeViewElement.querySelectorAll("."+Ae));e<i.length;e++){var r=i[e],a=t.createElement("span",{attrs:{tabindex:"-1",title:this.parent.localeObj.getConstant("drag"),"aria-disabled":"false"},className:H+" "+le});t.prepend([a],r),r.querySelector("."+ge)&&t.addClass([r.querySelector("."+Re)],He)}},e.prototype.refreshTreeView=function(){this.fieldTable&&(this.fieldTable.fields={dataSource:this.getTreeData(),id:"id",text:"caption",isChecked:"isSelected"},this.fieldTable.dataBind(),this.getTreeUpdate())},e.prototype.getTreeData=function(e){var i=[],r=Object.keys(this.parent.pivotFieldList),a=t.extend({},this.parent.pivotFieldList,null,!0);if(this.parent.isAdaptive){for(var n=[this.parent.dataSource.filters,this.parent.dataSource.columns,this.parent.dataSource.rows,this.parent.dataSource.values][e],o=r.length;o--;)a[r[o]].isSelected=!1;for(var l=0,s=n;l<s.length;l++){a[s[l].name].isSelected=!0}}for(var d=a,p=0,h=r;p<h.length;p++){var u=d[h[p]];i.push(u)}return i},e.prototype.onFieldAdd=function(e){this.parent.dialogRenderer.updateDataSource(this.selectedNodes),this.closeTreeDialog()},e.prototype.closeTreeDialog=function(){this.selectedNodes=[],this.fieldDialog.hide()},e.prototype.addEventListener=function(){this.parent.on(I,this.refreshTreeView,this)},e.prototype.removeEventListener=function(){this.parent.isDestroyed||this.parent.off(I,this.refreshTreeView)},e.prototype.destroy=function(){this.removeEventListener()},e}(),ai=function(){function e(e){this.parent=e}return e.prototype.render=function(){if(!this.parent.isAdaptive){var e=t.createElement("div",{className:"e-axis-table"});this.leftAxisPanel=t.createElement("div",{className:X}),this.rightAxisPanel=t.createElement("div",{className:K}),this.parent.dialogRenderer.parentElement.appendChild(e),e.appendChild(this.leftAxisPanel),e.appendChild(this.rightAxisPanel),this.axisTable=e,this.renderAxisTable()}this.parent.axisFieldModule.render()},e.prototype.renderAxisTable=function(){for(var e=["filters","rows","columns","values"],i=0,r=e.length;i<r;i++){var a=t.createElement("div",{className:W+"-"+e[i]}),n=t.createElement("div",{className:nt+"-wrapper"}),o=t.createElement("div",{className:"e-axis-header",innerHTML:this.parent.localeObj.getConstant(e[i])});n.appendChild(this.getIconupdate(e[i])),n.appendChild(o);var l=t.createElement("div",{className:Z+" e-"+e[i]}),s=void 0;s="rows"===e[i]?this.parent.localeObj.getConstant("dropRowPrompt"):"columns"===e[i]?this.parent.localeObj.getConstant("dropColPrompt"):"values"===e[i]?this.parent.localeObj.getConstant("dropValPrompt"):this.parent.localeObj.getConstant("dropFilterPrompt");var d=t.createElement("span",{className:$,innerHTML:s});new t.Droppable(l,{});a.appendChild(n),a.appendChild(l),a.appendChild(d),i<=1?this.leftAxisPanel.appendChild(a):this.rightAxisPanel.appendChild(a),this.unWireEvent(l),this.wireEvent(l)}},e.prototype.getIconupdate=function(e){var i=t.createElement("span",{attrs:{tabindex:"-1","aria-disabled":"false"},className:nt+"-icon-wrapper"}),r=t.createElement("span",{attrs:{tabindex:"-1","aria-disabled":"false"},className:"e-icons e-axis-"+e});return i.appendChild(r),i},e.prototype.wireEvent=function(e){t.EventHandler.add(e,"mouseover",this.updateDropIndicator,this),t.EventHandler.add(e,"mouseleave",this.updateDropIndicator,this)},e.prototype.unWireEvent=function(e){t.EventHandler.remove(e,"mouseover",this.updateDropIndicator),t.EventHandler.remove(e,"mouseleave",this.updateDropIndicator)},e.prototype.updateDropIndicator=function(e){var i=this.parent.dialogRenderer.parentElement;if(this.parent.isDragging&&e.target.classList.contains(Z)&&"mouseover"===e.type){t.removeClass([].slice.call(i.querySelectorAll("."+se)),de),t.removeClass([].slice.call(i.querySelectorAll("."+se+"-last")),de);var r=[].slice.call(e.target.querySelectorAll("."+J));r.length>0&&t.addClass([r[r.length-1].querySelector("."+se+"-last")],de)}else"mouseleave"===e.type&&(t.removeClass([].slice.call(i.querySelectorAll("."+se)),de),t.removeClass([].slice.call(i.querySelectorAll("."+se+"-last")),de))},e}(),ni=function(){function e(e){this.parent=e}return e.prototype.render=function(e,t){this.parentElement=t,this.openContextMenu(e)},e.prototype.openContextMenu=function(e){void 0===this.menuInfo&&this.createContextMenu(),this.currentMenu=e.currentTarget;var t=this.currentMenu.getBoundingClientRect();this.parent.enableRtl?this.menuInfo.open(t.top,t.left-105):this.menuInfo.open(t.top,t.left)},e.prototype.createContextMenu=function(){var e={items:[{text:"Count",id:"Count"},{text:"DistinctCount",id:"DistinctCount"},{text:"Avg",id:"Avg"},{text:"Min",id:"Min"},{text:"Max",id:"Max"},{text:"Sum",id:"Sum"},{text:"Product",id:"Product"},{text:"More...",id:"MoreOption"}],enableRtl:this.parent.enableRtl,beforeOpen:this.beforeMenuOpen.bind(this),select:this.selectOptionInContextMenu.bind(this)},i=document.getElementById(this.parent.element.id+"valueFieldContextMenu");null!==i&&(i.innerHTML=""),this.parent.element.appendChild(t.createElement("ul",{id:this.parent.element.id+"valueFieldContextMenu"})),this.menuInfo=new l.ContextMenu(e),this.menuInfo.appendTo("#"+this.parent.element.id+"valueFieldContextMenu")},e.prototype.beforeMenuOpen=function(e){e.element.style.zIndex=(this.menuInfo.element.style.zIndex+3).toString(),e.element.style.display="inline"},e.prototype.createValueSettingsDialog=function(e){var i=this,a=t.createElement("div",{id:this.parentElement.id+"_ValueDialog",className:"e-value-field-settings",attrs:{"data-field":e.id}});this.parentElement.appendChild(a),this.valueDialog=new r.Dialog({animationSettings:{effect:"Fade"},allowDragging:!0,header:this.parent.localeObj.getConstant("valueFieldSettings"),content:this.createFieldOptions(e),isModal:!0,visible:!0,showCloseIcon:!0,enableRtl:this.parent.enableRtl,width:"auto",height:"auto",position:{X:"center",Y:"center"},buttons:[{click:this.updateValueSettings.bind(this),buttonModel:{cssClass:ve,content:this.parent.localeObj.getConstant("ok"),isPrimary:!0}},{click:function(){i.valueDialog.hide()},buttonModel:{cssClass:fe,content:this.parent.localeObj.getConstant("cancel")}}],closeOnEscape:!0,target:this.parentElement,overlayClick:function(){i.removeDialog()},close:this.removeDialog.bind(this)}),this.valueDialog.appendTo(a)},e.prototype.createFieldOptions=function(e){var i=e.getAttribute("data-caption"),r=e.getAttribute("data-type"),a=e.getAttribute("data-basefield"),n=e.getAttribute("data-baseitem");r="undefined"!==r.toString()?r:"Sum";for(var o=["DifferenceFrom","PercentageOfDifferenceFrom"],l=["DifferenceFrom","PercentageOfDifferenceFrom","PercentageOfParentTotal"],p=t.extend([],this.parent.dataSource.rows,null,!0),h=[],u=[],c=0,m=p=p.concat(this.parent.dataSource.columns);c<m.length;c++){var g=m[c],v=g.name,f=g.caption?g.caption:g.name;h.push({value:v,text:f})}a="undefined"!==a.toString()?a:h[0].value,u=Object.keys(this.parent.engineModule.fieldList["undefined"!==a.toString()?a:h[0].value].formattedMembers),n="undefined"!==n.toString()?n:u[0];var y=t.createElement("div",{className:"e-value-field-div-content",id:this.parentElement.id+"_field_div_content",attrs:{"data-type":r,"data-caption":i,"data-basefield":a,"data-baseitem":n}}),b=t.createElement("div",{className:"e-field-name-text-wrapper"}),S=t.createElement("div",{className:"e-field-option-wrapper"}),C=t.createElement("div",{className:"e-type-option-wrapper"}),w=t.createElement("div",{className:"e-base-field-option-wrapper"}),x=t.createElement("div",{className:"e-base-item-option-wrapper"}),D=t.createElement("div",{className:"e-field-name-title",innerHTML:this.parent.localeObj.getConstant("sourceName")+"&nbsp;"}),T=t.createElement("div",{className:"e-field-name-content",innerHTML:e.id.toString()}),E=t.createElement("div",{className:"e-type-option-text",innerHTML:this.parent.localeObj.getConstant("sourceCaption")}),M=t.createElement("div",{className:"e-base-field-option-text",innerHTML:this.parent.localeObj.getConstant("summarizeValuesBy")}),P=t.createElement("div",{className:"e-base-item-option-text",innerHTML:this.parent.localeObj.getConstant("baseField")}),O=t.createElement("div",{className:"e-type-option-text",innerHTML:this.parent.localeObj.getConstant("baseItem")}),L=t.createElement("div",{className:"e-caption-input-wrapper"}),F=t.createElement("div",{id:this.parentElement.id+"_type_option"}),A=t.createElement("div",{id:this.parentElement.id+"_base_field_option"}),N=t.createElement("div",{id:this.parentElement.id+"_base_item_option"}),I=t.createElement("input",{id:this.parentElement.id+"type_input_option",className:"e-caption-input-text",attrs:{type:"text"}});b.appendChild(D),b.appendChild(T),L.appendChild(E),L.appendChild(I),C.appendChild(M),w.appendChild(P),x.appendChild(O),C.appendChild(F),w.appendChild(A),x.appendChild(N),S.appendChild(b),S.appendChild(L),S.appendChild(C),S.appendChild(w),S.appendChild(x),y.appendChild(S);var k=this;new d.DropDownList({dataSource:[{value:"Sum",text:"Sum"},{value:"Count",text:"Count"},{value:"DistinctCount",text:"Distinct Count"},{value:"Product",text:"Product"},{value:"Avg",text:"Avg"},{value:"Min",text:"Min"},{value:"Max",text:"Max"},{value:"Index",text:"Index"},{value:"SampleStDev",text:"Sample StDev"},{value:"PopulationStDev",text:"Population StDev"},{value:"SampleVar",text:"Sample Var"},{value:"PopulationVar",text:"Population Var"},{value:"RunningTotals",text:"Running Totals"},{value:"DifferenceFrom",text:"Difference From"},{value:"PercentageOfDifferenceFrom",text:"% of Difference From"},{value:"PercentageOfGrandTotal",text:"% of Grand Total"},{value:"PercentageOfColumnTotal",text:"% of Column Total"},{value:"PercentageOfRowTotal",text:"% of Row Total"},{value:"PercentageOfParentTotal",text:"% of Parent Total"},{value:"PercentageOfParentColumnTotal",text:"% of Parent Column Total"},{value:"PercentageOfParentRowTotal",text:"% of Parent Row Total"}],fields:{value:"value",text:"text"},value:r,cssClass:ze,width:"100%",change:function(e){j.enabled=-1!==l.indexOf(e.value),q.enabled=-1!==o.indexOf(e.value)}}).appendTo(F);var j=new d.DropDownList({dataSource:h,enableRtl:this.parent.enableRtl,fields:{value:"value",text:"text"},value:a,enabled:-1!==l.indexOf(r),cssClass:ze,width:"100%",change:function(e){u=Object.keys(k.parent.engineModule.fieldList[e.value].formattedMembers),q.dataSource=u,q.value=u[0],q.filterBarPlaceholder=k.parent.localeObj.getConstant("example")+" "+u[0],q.dataBind()}});j.appendTo(A);var q=new d.DropDownList({dataSource:u,enableRtl:this.parent.enableRtl,value:n,allowFiltering:!0,filterBarPlaceholder:this.parent.localeObj.getConstant("example")+" "+u[0],enabled:-1!==o.indexOf(r),cssClass:_e,width:"100%"});q.appendTo(N);return new s.MaskedTextBox({placeholder:"Enter field caption",enableRtl:this.parent.enableRtl,value:i,width:"100%"}).appendTo(I),y},e.prototype.selectOptionInContextMenu=function(e){if(null!==e.item.text){var t=this.currentMenu.parentElement;if("MoreOption"===e.item.id)this.createValueSettingsDialog(t);else{var i=t.getAttribute("data-uid"),r=this.parent.dataSource.values;t.querySelector(".e-content").innerHTML=e.item.text+" of "+this.parent.engineModule.fieldList[i].caption,t.setAttribute("data-type",e.item.id);for(var a=0;a<this.parent.dataSource.values.length;a++)if(this.parent.dataSource.values[a].name===i){(r[a].properties?r[a].properties:r[a]).type=e.item.id}this.updateDataSource()}}},e.prototype.updateDataSource=function(e){this.parent.allowDeferLayoutUpdate&&"pivotview"!==this.parent.getModuleName()?"pivotfieldlist"===this.parent.getModuleName()&&"Popup"===this.parent.renderMode?(this.parent.pivotGridModule.setProperties({dataSource:this.parent.dataSource.properties},!0),this.parent.pivotGridModule.notify(L,this),this.parent.pivotGridModule.engineModule=this.parent.engineModule):this.parent.triggerPopulateEvent():this.parent.updateDataSource(e)},e.prototype.updateValueSettings=function(){var e=this.valueDialog.element,i=t.getInstance("#"+this.parentElement.id+"type_input_option",s.MaskedTextBox),r=t.getInstance("#"+this.parentElement.id+"_type_option",d.DropDownList),a=t.getInstance("#"+this.parentElement.id+"_base_field_option",d.DropDownList),n=t.getInstance("#"+this.parentElement.id+"_base_item_option",d.DropDownList),o=e.getAttribute("data-field"),l=this.parentElement.querySelector("."+ee+"#"+o);l.querySelector(".e-content").innerHTML=this.parent.localeObj.getConstant(r.value)+" of "+i.value,l.setAttribute("data-type",r.value),l.setAttribute("data-caption",i.value),l.setAttribute("data-basefield",a.value),l.setAttribute("data-baseitem",n.value);var p=this.parent.pivotCommon.eventBase.getFieldByName(o,this.parent.dataSource.values);(p=p.properties?p.properties:p).caption=i.value,p.type=r.value,p.baseField=a.value,p.baseItem=n.value,this.valueDialog.close(),this.updateDataSource(!0)},e.prototype.removeDialog=function(){this.valueDialog&&!this.valueDialog.isDestroyed&&this.valueDialog.destroy(),document.getElementById(this.parentElement.id+"_ValueDialog")&&t.remove(document.getElementById(this.parentElement.id+"_ValueDialog"))},e.prototype.destroy=function(){this.parent.isDestroyed||this.menuInfo&&!this.menuInfo.isDestroyed&&this.menuInfo.destroy()},e}(),oi=function(){function e(e){this.parent=e,this.menuOption=new ni(this.parent),this.parent.pivotButtonModule=this,this.addEventListener()}return e.prototype.renderPivotButton=function(e){var i,r=t.extend([],e.field,null,!0),a=e.axis,n=-1,o="pivotfieldlist"==this.parent.getModuleName()&&this.parent.pivotGridModule?this.parent.pivotGridModule.showValuesButton:this.parent.showValuesButton;if(("row"===this.parent.dataSource.valueAxis&&"rows"===e.axis||"column"===this.parent.dataSource.valueAxis&&"columns"===e.axis)&&o&&this.parent.dataSource.values.length>1&&(n=r.length,r.push({name:this.parent.localeObj.getConstant("values"),caption:this.parent.localeObj.getConstant("values"),axis:e.axis})),this.parentElement="pivotview"===this.parent.getModuleName()?this.parent.element:document.getElementById(this.parent.element.id+"_Wrapper"),"pivotfieldlist"===this.parent.getModuleName()){if(this.parentElement=document.getElementById(this.parent.element.id+"_Wrapper"),!this.parentElement.querySelector("."+W+"-"+a))return;var l=this.parentElement.querySelector("."+W+"-"+a).querySelector("."+$);0===r.length?t.removeClass([l],B):t.addClass([l],B),i=this.parentElement.querySelector("."+W+"-"+a).querySelector("."+Z)}else this.parentElement=this.parent.element,i=this.parentElement.querySelector(".e-group-"+a);if(i)if("pivotview"===this.parent.getModuleName()&&0===r.length){l=t.createElement("span",{className:$,innerHTML:"rows"===a?this.parent.localeObj.getConstant("rowAxisPrompt"):"columns"===a?this.parent.localeObj.getConstant("columnAxisPrompt"):"values"===a?this.parent.localeObj.getConstant("valueAxisPrompt"):this.parent.localeObj.getConstant("filterAxisPrompt")});i.appendChild(l)}else for(var s=0,d=r.length;s<d;s++){var p=t.createElement("div",{className:J+(0===s?" e-first-btn":""),attrs:{"data-tag":a+":"+r[s].name}}),u=t.createElement("div",{id:r[s].name,className:ee,attrs:{"data-uid":r[s].name,tabindex:"0",isvalue:s===n?"true":"false","aria-disabled":"false","aria-label":r[s].caption?r[s].caption:r[s].name,"data-type":r[s].type,"data-caption":r[s].caption?r[s].caption:r[s].name,"data-basefield":r[s].baseField,"data-baseitem":r[s].baseItem}}),c=t.createElement("span",{attrs:{tabindex:"-1","aria-disabled":"false"},className:se}),m=t.createElement("span",{attrs:{tabindex:"-1","aria-disabled":"false"},className:se+"-last"}),g=this.createButtonDragIcon(u),v=this.createButtonText(r,s,a,n);u.appendChild(v),-1===["filters","values"].indexOf(a)&&n!==s&&this.createSortOption(u,r[s].name),"values"!==a&&n!==s&&this.createFilterOption(u,r[s].name),"values"===a&&this.getTypeStatus(r,s,u);var f=t.createElement("span",{attrs:{tabindex:"-1","aria-disabled":"false"},className:H+" "+oe});"pivotview"===this.parent.getModuleName()&&(this.parent.groupingBarSettings.showRemoveIcon?t.removeClass([f],B):t.addClass([f],B)),u.appendChild(f),p.appendChild(c),p.appendChild(u),p.appendChild(m),i.appendChild(p);new h.Button({enableRtl:this.parent.enableRtl}).appendTo(u),this.unWireEvent(p,s===n?"values":a),this.wireEvent(p,s===n?"values":a),("pivotview"===this.parent.getModuleName()&&!this.parent.isAdaptive||"pivotfieldlist"===this.parent.getModuleName())&&this.createDraggable("pivotview"===this.parent.getModuleName()?v:g)}},e.prototype.createButtonText=function(e,i,r,a){var n;void 0!==this.parent.engineModule.fieldList[e[i].name]&&(void 0!==(n=this.parent.engineModule.fieldList[e[i].name].aggregateType)||"string"!==this.parent.engineModule.fieldList[e[i].name].type&&"include"!==this.parent.engineModule.fieldList[e[i].name].type&&"exclude"!==this.parent.engineModule.fieldList[e[i].name].type?void 0===n&&(n=void 0!==this.parent.engineModule.fieldList[e[i].name].aggregateType?this.parent.engineModule.fieldList[e[i].name].aggregateType:"Sum"):n="Count");var o=e[i].caption?e[i].caption:e[i].name;return t.createElement("span",{attrs:{tabindex:"-1","aria-disabled":"false",oncontextmenu:"return false;","data-type":a===i?"":n},className:"e-content",innerHTML:"values"!==r||"CalculatedField"===n?o:this.parent.localeObj.getConstant(n)+" of "+o})},e.prototype.getTypeStatus=function(e,t,i){var r=this.parent.engineModule.fieldList[e[t].name];"CalculatedField"!==r.aggregateType&&"number"===r.type&&this.createSummaryType(i,e[t].name)},e.prototype.createSummaryType=function(e,i){var r=t.createElement("span",{attrs:{tabindex:"-1","aria-disabled":"false"},className:H+" "+G});return"pivotview"===this.parent.getModuleName()&&(this.parent.groupingBarSettings.showValueTypeIcon?t.removeClass([r],B):t.addClass([r],B)),e.appendChild(r),r},e.prototype.createMenuOption=function(e){this.menuOption.render(e,this.parentElement),this.parent.pivotButtonModule=this},e.prototype.createDraggable=function(e){this.draggable=new t.Draggable(e,{clone:!0,enableTailMode:!0,enableAutoScroll:!0,helper:this.createDragClone.bind(this),dragStart:this.onDragStart.bind(this),drag:this.onDragging.bind(this),dragStop:this.onDragStop.bind(this)})},e.prototype.createButtonDragIcon=function(e){var i=t.createElement("span",{attrs:{tabindex:"-1","aria-disabled":"false"}}),r=t.createElement("span",{attrs:{tabindex:"-1","aria-disabled":"false"},className:H+" "+le});return i.appendChild(r),e.appendChild(i),i},e.prototype.createSortOption=function(e,i){var r;if(this.parent.allowDeferLayoutUpdate){r="";for(var a=0;a<this.parent.dataSource.sortSettings.length;a++)this.parent.dataSource.sortSettings[a].name===i&&(r="Descending"===this.parent.dataSource.sortSettings[a].order?ie:"")}else r="Descending"===this.parent.engineModule.fieldList[i].sort?ie:"";var n=t.createElement("span",{attrs:{tabindex:"-1","aria-disabled":"false"},className:"e-icons e-sort "+r});return this.parent.dataSource.enableSorting?t.removeClass([n],B):t.addClass([n],B),"pivotview"===this.parent.getModuleName()&&(this.parent.groupingBarSettings.showSortIcon?t.removeClass([n],B):t.addClass([n],B)),e.appendChild(n),n},e.prototype.createFilterOption=function(e,i){var r;if(this.parent.allowDeferLayoutUpdate){r=ae;for(var a=0;a<this.parent.dataSource.filterSettings.length;a++)this.parent.dataSource.filterSettings[a].name===i&&(r=ne)}else r=0===this.parent.engineModule.fieldList[i].filter.length?this.parent.engineModule.fieldList[i].isExcelFilter?ne:ae:ne;var n=t.createElement("span",{attrs:{tabindex:"-1","aria-disabled":"false"},className:re+" "+H+" "+r});return"pivotview"===this.parent.getModuleName()&&(this.parent.groupingBarSettings.showFilterIcon?t.removeClass([n],B):t.addClass([n],B)),e.appendChild(n),n},e.prototype.createDragClone=function(e){var i=t.closest(e.element,"."+ee),r=t.createElement("div",{id:this.parent.element.id+"_DragClone",className:"e-button-drag-clone"}),a=t.createElement("span",{className:Ae,innerHTML:i.textContent});return r.appendChild(a),document.body.appendChild(r),r},e.prototype.onDragStart=function(e){this.parent.isDragging=!0;var i=t.closest(e.element,"."+ee),r=this.parent.engineModule.fieldList[i.getAttribute("data-uid")],a=[Se,Ce,xe];if(t.addClass([i],Le),r&&"CalculatedField"===r.aggregateType)for(var n=0,o=a;n<o.length;n++){var l=o[n];t.addClass([this.parentElement.querySelector("."+l)],Oe)}},e.prototype.onDragging=function(e){this.draggable.setProperties({cursorAt:{top:!t.isNullOrUndefined(e.event.targetTouches)||t.Browser.isDevice?60:-20}})},e.prototype.onDragStop=function(e){this.parent.isDragging=!1;var i=t.closest(e.element,"."+ee);t.removeClass([].slice.call(this.parentElement.querySelectorAll("."+ee)),Le),t.removeClass([].slice.call(this.parentElement.querySelectorAll("."+se)),de);for(var r=0,a=[Se,Ce,xe];r<a.length;r++){var n=a[r];t.removeClass([this.parentElement.querySelector("."+n)],Oe)}this.parent.pivotCommon.filterDialog.dialogPopUp&&this.parent.pivotCommon.filterDialog.dialogPopUp.close(),document.getElementById(this.parent.element.id+"_DragClone")&&t.remove(document.getElementById(this.parent.element.id+"_DragClone")),document.body.style.cursor="auto",this.isButtonDropped(e.target,i)&&(this.parent.pivotCommon.dataSourceUpdate.control="pivotview"===this.parent.getModuleName()?this.parent:this.parent.pivotGridModule?this.parent.pivotGridModule:this.parent,this.parent.pivotCommon.nodeStateModified.onStateModified(e,i.id)&&(this.updateDataSource(),this.parent.axisFieldModule.render()))},e.prototype.isButtonDropped=function(e,i){var r=t.closest(i,"."+be),a=!0;if(r===t.closest(e,"."+be)){for(var n=[].slice.call(r.querySelectorAll("."+ee)),o=t.closest(e,"."+J),l=void 0,s=-1,d=0,p=n.length;d<p;d++)if(n[d].id===i.id&&(l=d),o){var h=o.querySelector("."+ee);n[d].id===h.id&&(s=d)}(l===s||l===n.length-1&&-1===s)&&(t.removeClass([].slice.call(this.parentElement.querySelectorAll("."+se)),de),a=!1)}return a},e.prototype.updateSorting=function(e){("pivotview"===this.parent.getModuleName()&&this.parent.enableValueSorting||"pivotfieldlist"===this.parent.getModuleName()&&void 0!==this.parent.pivotGridModule&&this.parent.pivotGridModule.enableValueSorting)&&"rows"===e.target.parentElement.parentElement.getAttribute("data-tag").split(":")[0]&&(this.parent.dataSource.valueSortSettings.headerText=""),this.parent.pivotCommon.eventBase.updateSorting(e),this.updateDataSource(!0)},e.prototype.updateDataSource=function(e){this.parent.allowDeferLayoutUpdate&&"pivotview"!==this.parent.getModuleName()?"pivotfieldlist"===this.parent.getModuleName()&&"Popup"===this.parent.renderMode?(this.parent.pivotGridModule.engineModule=this.parent.engineModule,this.parent.pivotGridModule.notify(L,this),this.parent.pivotGridModule.setProperties({dataSource:this.parent.dataSource.properties},!0)):this.parent.triggerPopulateEvent():this.parent.updateDataSource(e)},e.prototype.updateFiltering=function(e){this.parent.pivotCommon.eventBase.updateFiltering(e);var t=e.target.parentElement.id;this.dialogPopUp=this.parent.pivotCommon.filterDialog.dialogPopUp,this.memberTreeView=this.parent.pivotCommon.filterDialog.memberTreeView,this.parent.pivotCommon.filterDialog.memberTreeView.nodeChecked=this.nodeStateModified.bind(this),this.parent.pivotCommon.filterDialog.allMemberSelect.nodeChecked=this.nodeStateModified.bind(this),this.bindDialogEvents(t)},e.prototype.bindDialogEvents=function(e){var i=this;this.parent.pivotCommon.filterDialog.allowExcelLikeFilter&&this.parent.pivotCommon.filterDialog.tabObj?(this.updateDialogButtonEvents(this.parent.pivotCommon.filterDialog.tabObj.selectedItem,e),this.dialogPopUp.buttons[1].click=this.ClearFilter.bind(this),this.parent.pivotCommon.filterDialog.tabObj.selected=function(r){i.updateDialogButtonEvents(r.selectedIndex,e),t.removeClass([].slice.call(i.dialogPopUp.element.querySelectorAll(".e-selected-tab")),"e-selected-tab"),r.selectedIndex>0&&t.addClass([i.dialogPopUp.element.querySelector(".e-filter-div-content."+(1===r.selectedIndex&&i.parent.dataSource.allowLabelFilter?"e-label-filter":"e-value-filter"))],"e-selected-tab")}):this.updateDialogButtonEvents(0,e)},e.prototype.updateDialogButtonEvents=function(e,t){this.dialogPopUp.buttons[0].click=0===e?this.updateFilterState.bind(this,t):this.updateCustomFilter.bind(this)},e.prototype.updateCustomFilter=function(e){var t=this.dialogPopUp.element.querySelector(".e-selected-tab"),i=t.getAttribute("data-fieldname"),r=t.getAttribute("data-type"),a=t.getAttribute("data-measure"),n=t.getAttribute("data-operator"),o=t.getAttribute("data-value1"),l=t.getAttribute("data-value2"),s="value"===r?"Value":"date"===r?"Date":"number"===r?"Number":"Label",d={name:i,type:s,measure:a,condition:n,value1:"date"===r?new Date(o):o,value2:"date"===r?new Date(l):l},p=this.parent.pivotCommon.eventBase.getFilterItemByName(i);p?((p=p.properties?p.properties:p).type=s,p.measure=a,p.condition=n,p.value1="date"===r?new Date(o):o,p.value2="date"===r?new Date(l):l):this.parent.dataSource.filterSettings.push(d),this.dialogPopUp.close(),this.refreshPivotButtonState(i,!0),this.updateDataSource(!0)},e.prototype.ClearFilter=function(e){var t=this.dialogPopUp.element.getAttribute("data-fieldname");this.dialogPopUp.close(),this.removeDataSourceSettings(t),this.refreshPivotButtonState(t,!1),this.updateDataSource(!0)},e.prototype.removeButton=function(e){var t=e.target,i=t.parentElement.id;"true"===t.parentElement.getAttribute("isvalue")?this.parent.setProperties({dataSource:{values:[]}},!0):this.parent.pivotCommon.dataSourceUpdate.removeFieldFromReport(i),"pivotfieldlist"===this.parent.getModuleName()&&this.parent.axisFieldModule.render(),this.updateDataSource()},e.prototype.nodeStateModified=function(e){if("all"===e.node.parentElement.parentElement.getAttribute("data-uid"))this.memberTreeView.nodeChecked=null,"check"===e.action?this.memberTreeView.checkAll():this.memberTreeView.uncheckAll(),this.checkedStateAll(e.action),this.memberTreeView.nodeChecked=this.nodeStateModified.bind(this);else{var t=this.parent.pivotCommon.currentTreeItemsPos[e.data[0].id];"check"===e.action?this.parent.pivotCommon.currentTreeItems[t].checkedStatus=!0:this.parent.pivotCommon.currentTreeItems[t].checkedStatus=!1}this.parent.pivotCommon.filterDialog.updateCheckedState()},e.prototype.checkedStateAll=function(e){if("check"===e)for(var t=0,i=this.parent.pivotCommon.currentTreeItems;t<i.length;t++){i[t].checkedStatus=!0}else for(var r=0,a=this.parent.pivotCommon.currentTreeItems;r<a.length;r++){a[r].checkedStatus=!1}},e.prototype.updateFilterState=function(e,t){for(var i=0,r={items:[],name:e,type:"Include"},a=0,n=this.parent.pivotCommon.currentTreeItems;a<n.length;a++){var o=n[a];o.checkedStatus?r.items.push(o.id):i+=1}if(this.parent.pivotCommon.eventBase.getFilterItemByName(e)){for(var l=0;l<this.parent.dataSource.filterSettings.length;l++)if(this.parent.dataSource.filterSettings[l].name===e){this.parent.dataSource.filterSettings.splice(l,1);break}this.parent.dataSource.filterSettings.push(r)}else this.parent.dataSource.filterSettings.push(r);this.dialogPopUp.close(),this.refreshPivotButtonState(e,i>0),0===i&&this.removeDataSourceSettings(e),this.updateDataSource(!0)},e.prototype.refreshPivotButtonState=function(e,i){for(var r,a=0,n=[].slice.call(this.parentElement.querySelectorAll(".e-pivot-button"));a<n.length;a++){var o=n[a];if(o.getAttribute("data-uid")===e){r=o.querySelector("."+re);break}}i?(t.removeClass([r],ae),t.addClass([r],ne)):(t.removeClass([r],ne),t.addClass([r],ae))},e.prototype.removeDataSourceSettings=function(e){for(var t=this.parent.dataSource.filterSettings,i=0,r=t.length;i<r;i++)if(t[i].name===e){t.splice(i,1);break}},e.prototype.updateDropIndicator=function(e){if(this.parent.isDragging){t.removeClass([].slice.call(this.parentElement.querySelectorAll("."+se+"-last")),de),t.removeClass([].slice.call(this.parentElement.querySelectorAll("."+se)),de);var i=t.closest(e.target,"."+J);t.addClass([i.querySelector("."+se)],de)}},e.prototype.wireEvent=function(e,i){t.EventHandler.add(e,"mouseover",this.updateDropIndicator,this),-1===["filters","values"].indexOf(i)&&t.EventHandler.add(e.querySelector("."+te),"click",this.updateSorting,this),"values"!==i&&t.EventHandler.add(e.querySelector("."+re),"click",this.updateFiltering,this),"values"===i&&null!==e.querySelector("."+G)&&t.EventHandler.add(e.querySelector("."+G),"click",this.createMenuOption,this),t.EventHandler.add(e.querySelector("."+oe),"click",this.removeButton,this)},e.prototype.unWireEvent=function(e,i){t.EventHandler.remove(e,"mouseover",this.updateDropIndicator),-1===["filters","values"].indexOf(i)&&t.EventHandler.remove(e.querySelector("."+te),"click",this.updateSorting),"values"!==i&&t.EventHandler.remove(e.querySelector("."+re),"click",this.updateFiltering),"values"===i&&null!==e.querySelector("."+G)&&t.EventHandler.remove(e.querySelector("."+G),"click",this.createMenuOption),t.EventHandler.remove(e.querySelector("."+oe),"click",this.removeButton)},e.prototype.addEventListener=function(){this.handlers={load:this.renderPivotButton},this.parent.isDestroyed||this.parent.on(k,this.handlers.load,this)},e.prototype.removeEventListener=function(){this.parent.isDestroyed||this.parent.off(k,this.handlers.load)},e.prototype.destroy=function(){this.menuOption.destroy(),this.removeEventListener()},e}(),li=function(){function e(e){this.parent=e}return e.prototype.render=function(){this.pivotButton=new oi(this.parent),this.createPivotButtons()},e.prototype.createPivotButtons=function(){var e=[this.parent.dataSource.rows,this.parent.dataSource.columns,this.parent.dataSource.values,this.parent.dataSource.filters],t=this.parent.dialogRenderer.parentElement;t.querySelector("."+W+"-filters")&&(t.querySelector("."+W+"-filters").querySelector("."+Z).innerHTML=""),t.querySelector("."+W+"-rows")&&(t.querySelector("."+W+"-rows").querySelector("."+Z).innerHTML=""),t.querySelector("."+W+"-columns")&&(t.querySelector("."+W+"-columns").querySelector("."+Z).innerHTML=""),t.querySelector("."+W+"-values")&&(t.querySelector("."+W+"-values").querySelector("."+Z).innerHTML="");for(var i=["rows","columns","values","filters"],r=0,a=e.length;r<a;r++)if(e[r]){var n={field:e[r],axis:i[r].toString()};this.parent.notify(k,n)}},e}(),si=function(){function e(e){this.parent=e,this.parent.dialogRenderer=new ii(this.parent),this.parent.treeViewModule=new ri(this.parent),this.parent.axisTableModule=new ai(this.parent),this.parent.axisFieldModule=new li(this.parent)}return e.prototype.render=function(){this.parent.dialogRenderer.render(),this.parent.isAdaptive||this.parent.treeViewModule.render(),this.parent.axisTableModule.render()},e}(),di=function(){var e=function(t,i){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(t,i)};return function(t,i){function r(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),pi=function(e,t,i,r){var a,n=arguments.length,o=n<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,r);else for(var l=e.length-1;l>=0;l--)(a=e[l])&&(o=(n<3?a(o):n>3?a(t,i,o):a(t,i))||o);return n>3&&o&&Object.defineProperty(t,i,o),o},hi=function(e){function i(t,i){var r=e.call(this,t,i)||this;return r.isRequiredUpdate=!0,r}return di(i,e),i.prototype.requiredModules=function(){var e=[];return this.allowCalculatedField&&e.push({args:[this],member:"calculatedfield"}),e},i.prototype.preRender=function(){this.isAdaptive=t.Browser.isDevice,this.globalize=new t.Internationalization(this.locale),this.renderModule=new si(this),this.defaultLocale={staticFieldList:"Pivot Field List",fieldList:"Field List",dropFilterPrompt:"Drop filter here",dropColPrompt:"Drop column here",dropRowPrompt:"Drop row here",dropValPrompt:"Drop value here",addPrompt:"Add field here",adaptiveFieldHeader:"Choose field",centerHeader:"Drag fields between axes below:",add:"add",drag:"Drag",filter:"Filter",filtered:"Filtered",sort:"Sort",remove:"Remove",filters:"Filters",rows:"Rows",columns:"Columns",values:"Values",calculatedField:"Calculated Field",createCalculatedField:"Create Calculated Field",fieldName:"Enter the field name",error:"Error",invalidFormula:"Invalid formula.",dropText:'Example: ("Sum(Order_Count)" + "Sum(In_Stock)") * 250',dropTextMobile:"Add fields and edit formula here.",dropAction:"Calculated field cannot be place in any other region except value axis.",search:"Search",close:"Close",cancel:"Cancel",delete:"Delete",alert:"Alert",warning:"Warning",ok:"OK",sum:"Sum",average:"Average",count:"Count",min:"Min",max:"Max",allFields:"All Fields",formula:"Formula",fieldExist:"A field already exists in this name. Please enter a different name.",confirmText:"A calculation field already exists in this name. Do you want to replace it?",noMatches:"No matches",format:"Summaries values by",edit:"Edit",clear:"Clear",formulaField:"Drag and drop fields to formula",dragField:"Drag field to formula",clearFilter:"Clear",by:"by",enterValue:"Enter value",chooseDate:"Enter date",Equals:"Equals",DoesNotEquals:"Does Not Equal",BeginWith:"Begins With",DoesNotBeginWith:"Does Not Begin With",EndsWith:"Ends With",DoesNotEndsWith:"Does Not End With",Contains:"Contains",DoesNotContains:"Does Not Contain",GreaterThan:"Greater Than",GreaterThanOrEqualTo:"Greater Than Or Equal To",LessThan:"Less Than",LessThanOrEqualTo:"Less Than Or Equal To",Between:"Between",NotBetween:"Not Between",Before:"Before",BeforeOrEqualTo:"Before Or Equal To",After:"After",AfterOrEqualTo:"After Or Equal To",member:"Member",label:"Label",date:"Date",value:"Value",labelTextContent:"Show the items for which the label",dateTextContent:"Show the items for which the date",valueTextContent:"Show the items for which",And:"and",Sum:"Sum",Count:"Count",DistinctCount:"Distinct Count",Product:"Product",Avg:"Avg",Min:"Min",Max:"Max",Index:"Index",SampleStDev:"Sample StDev",PopulationStDev:"Population StDev",SampleVar:"Sample Var",PopulationVar:"Population Var",RunningTotals:"Running Totals",DifferenceFrom:"Difference From",PercentageOfDifferenceFrom:"% of Difference From",PercentageOfGrandTotal:"% of Grand Total",PercentageOfColumnTotal:"% of Column Total",PercentageOfRowTotal:"% of Row Total",PercentageOfParentTotal:"% of Parent Total",PercentageOfParentColumnTotal:"% of Parent Column Total",PercentageOfParentRowTotal:"% of Parent Row Total",apply:"APPLY",valueFieldSettings:"Value field settings",sourceName:"Field name :",sourceCaption:"Field caption :",summarizeValuesBy:"Summarize values by :",baseField:"Base field :",baseItem:"Base item :",example:"e.g:",editorDataLimitMsg:" more items. Search to refine further.",deferLayoutUpdate:"Defer Layout Update"},this.localeObj=new t.L10n(this.getModuleName(),this.defaultLocale,this.locale),this.isDragging=!1,this.captionData=[],this.wireEvent()},i.prototype.render=function(){this.trigger("load",{dataSource:this.dataSource}),t.addClass([this.element],q),this.enableRtl?t.addClass([this.element],V):t.removeClass([this.element],V),this.isAdaptive?t.addClass([this.element],R):t.removeClass([this.element],R),this.cssClass&&t.addClass([this.element],this.cssClass),this.notify(O,{})},i.prototype.wireEvent=function(){this.on(O,this.generateData,this),this.on(A,this.fieldListRender,this)},i.prototype.unWireEvent=function(){this.pivotGridModule&&this.pivotGridModule.isDestroyed||(this.off(O,this.generateData),this.off(A,this.fieldListRender))},i.prototype.getPersistData=function(){return this.addOnPersist(["dataSource"])},i.prototype.getModuleName=function(){return"pivotfieldlist"},i.prototype.onPropertyChanged=function(e,i){for(var r=!1,a=0,n=Object.keys(e);a<n.length;a++){switch(n[a]){case"locale":this.refresh();break;case"enableRtl":this.enableRtl?t.addClass([this.element],V):t.removeClass([this.element],V),r=!0}r&&this.fieldListRender()}},i.prototype.generateData=function(){if(this.pivotFieldList={},this.dataSource&&this.dataSource.data){this.trigger(m,{dataSource:this.dataSource});var e=this.pivotGridModule?this.pivotGridModule.pageSettings:void 0,t=!this.pivotGridModule||(this.pivotGridModule.allowDrillThrough||this.pivotGridModule.editSettings.allowEditing),i=this.pivotGridModule?this.pivotGridModule.enableValueSorting:void 0;this.engineModule=new c(this.dataSource,"",void 0,e,i,t),this.pivotFieldList=this.engineModule.fieldList;var r={pivotFieldList:this.pivotFieldList,pivotValues:this.engineModule.pivotValues};this.trigger(g,r)}this.notify(A,{}),this.trigger(w)},i.prototype.fieldListRender=function(){this.element.innerHTML="","Popup"===this.renderMode&&this.dialogRenderer.fieldListDialog&&!this.dialogRenderer.fieldListDialog.isDestroyed&&(this.dialogRenderer.fieldListDialog.destroy(),t.remove(document.getElementById(this.element.id+"_Wrapper"))),this.renderModule.render(),this.fieldListSpinnerElement="Popup"===this.renderMode?this.dialogRenderer.fieldListDialog.element:this.element.querySelector(".e-pivotfieldlist-wrapper"),r.createSpinner({target:this.fieldListSpinnerElement},this.createElement);var e={pivotEngine:this.engineModule,dataSource:this.dataSource,id:this.element.id,element:document.getElementById(this.element.id+"_Wrapper"),moduleName:this.getModuleName(),enableRtl:this.enableRtl,isAdaptive:this.isAdaptive,renderMode:this.renderMode,localeObj:this.localeObj};this.pivotCommon=new ti(e),this.pivotCommon.control=this,this.allowDeferLayoutUpdate&&(this.clonedDataSource=t.extend({},this.dataSource,null,!0),this.clonedFieldList=t.extend({},this.pivotFieldList,null,!0))},i.prototype.getFieldCaption=function(e){if(this.getFields(e),this.captionData.length>0)for(var t=this.captionData.length;t--;)if(this.captionData[t])for(var i=0,r=this.captionData[t];i<r.length;i++){var a=r[i].properties;a&&(this.engineModule.fieldList[a.name]&&a.caption?this.engineModule.fieldList[a.name].caption=a.caption:this.engineModule.fieldList[a.name].caption=a.name)}},i.prototype.getFields=function(e){var i=t.extend({},e,null,!0).properties;this.captionData=[i.rows,i.columns,i.values,i.filters]},i.prototype.updateDataSource=function(e,i){if(this.pivotGridModule&&r.showSpinner(this.pivotGridModule.element),r.showSpinner(this.fieldListSpinnerElement),t.isNullOrUndefined(i)){var a=this.pivotGridModule?this.pivotGridModule.pageSettings:void 0,n=this.pivotGridModule?this.pivotGridModule.enableValueSorting:void 0,o=this.pivotGridModule?this.pivotGridModule.allowDrillThrough||this.pivotGridModule.editSettings.allowEditing:void 0;this.engineModule=new c(this.dataSource,"",this.pivotFieldList,a,n,o),this.getFieldCaption(this.dataSource)}else this.axisFieldModule.render(),this.isRequiredUpdate=!1;var l={dataSource:this.dataSource,pivotFieldList:this.pivotFieldList,pivotValues:this.engineModule.pivotValues};this.trigger(g,l),this.pivotCommon.engineModule=this.engineModule,this.pivotCommon.dataSource=this.dataSource,this.pivotFieldList=this.engineModule.fieldList,e||!this.treeViewModule.fieldTable||this.isAdaptive||this.notify(I,{}),this.isRequiredUpdate?(this.allowDeferLayoutUpdate&&(this.clonedDataSource=t.extend({},this.dataSource,null,!0),this.clonedFieldList=t.extend({},this.pivotFieldList,null,!0)),this.updateView(this.pivotGridModule)):"Popup"===this.renderMode&&this.allowDeferLayoutUpdate&&(this.pivotGridModule.engineModule=this.engineModule,this.pivotGridModule.setProperties({dataSource:this.dataSource.properties},!0),this.pivotGridModule.notify(L,this),r.hideSpinner(this.fieldListSpinnerElement)),this.isRequiredUpdate=!0,this.pivotGridModule?this.pivotGridModule.fieldListSpinnerElement=this.fieldListSpinnerElement:r.hideSpinner(this.fieldListSpinnerElement)},i.prototype.update=function(e){e&&(this.setProperties({dataSource:e.dataSource},!0),this.engineModule=e.engineModule,this.pivotFieldList=e.engineModule.fieldList,"Popup"===this.renderMode&&(this.pivotGridModule=e),this.getFieldCaption(e.dataSource),this.pivotCommon.engineModule=this.engineModule,this.pivotCommon.dataSource=this.dataSource,this.pivotCommon.control=e,this.treeViewModule.fieldTable&&!this.isAdaptive&&this.notify(I,{}),this.axisFieldModule.render(),"Fixed"===this.renderMode&&this.allowDeferLayoutUpdate&&(this.clonedDataSource=t.extend({},this.dataSource,null,!0),this.clonedFieldList=t.extend({},this.pivotFieldList,null,!0)))},i.prototype.updateView=function(e){e&&(e.setProperties({dataSource:this.dataSource},!0),e.engineModule=this.engineModule,e.pivotValues=this.engineModule.pivotValues,e.dataBind())},i.prototype.triggerPopulateEvent=function(){var e={dataSource:this.dataSource,pivotFieldList:this.pivotFieldList,pivotValues:this.engineModule.pivotValues};this.trigger(g,e)},i.prototype.destroy=function(){this.unWireEvent(),this.treeViewModule&&this.treeViewModule.destroy(),this.pivotButtonModule&&this.pivotButtonModule.destroy(),e.prototype.destroy.call(this),this.element.innerHTML="",t.removeClass([this.element],q),t.removeClass([this.element],V),t.removeClass([this.element],R),"Popup"===this.renderMode&&(this.dialogRenderer.fieldListDialog&&!this.dialogRenderer.fieldListDialog.isDestroyed&&this.dialogRenderer.fieldListDialog.destroy(),document.getElementById(this.element.id+"_Wrapper")&&t.remove(document.getElementById(this.element.id+"_Wrapper")))},pi([t.Complex({},Ft)],i.prototype,"dataSource",void 0),pi([t.Property("Popup")],i.prototype,"renderMode",void 0),pi([t.Property()],i.prototype,"target",void 0),pi([t.Property("")],i.prototype,"cssClass",void 0),pi([t.Property(!1)],i.prototype,"allowCalculatedField",void 0),pi([t.Property(!1)],i.prototype,"showValuesButton",void 0),pi([t.Property(!1)],i.prototype,"allowDeferLayoutUpdate",void 0),pi([t.Property(1e3)],i.prototype,"maxNodeLimitInMemberEditor",void 0),pi([t.Event()],i.prototype,"load",void 0),pi([t.Event()],i.prototype,"enginePopulating",void 0),pi([t.Event()],i.prototype,"enginePopulated",void 0),pi([t.Event()],i.prototype,"onFieldDropped",void 0),pi([t.Event()],i.prototype,"dataBound",void 0),pi([t.Event()],i.prototype,"created",void 0),pi([t.Event()],i.prototype,"destroyed",void 0),i=pi([t.NotifyPropertyChanges],i)}(t.Component),ui="DistinctCount",ci="SampleStDev",mi="Popultion StDev",gi="PopulationVar",vi="CalculatedField",fi=function(){function e(e){this.parent=e,this.existingReport=null,this.parent.calculatedFieldModule=this,this.removeEventListener(),this.addEventListener(),this.parentID=this.parent.element.id,this.dialog=null,this.inputObj=null,this.treeObj=null,this.droppable=null,this.menuObj=null,this.newFields=null,this.isFieldExist=!0,this.formulaText=null,this.fieldText=null,this.isEdit=!1,this.currentFieldName=null,this.confirmPopUp=null}return e.prototype.getModuleName=function(){return"calculatedfield"},e.prototype.keyActionHandler=function(e){var t=e.currentTarget.querySelector(".e-hover.e-node-focus");if(t)switch(e.action){case"moveRight":this.displayMenu(t.previousSibling);break;case"enter":var i=t.getAttribute("data-field"),r=t.getAttribute("data-type"),a=this.dialog.element.querySelector("#"+this.parentID+"droppable");""===a.value?a.value=r===vi?t.getAttribute("data-uid"):'"'+r+"("+i+')"':""!==a.value&&(a.value=r===vi?a.value+t.getAttribute("data-uid"):a.value+'"'+r+"("+i+')"')}},e.prototype.fieldClickHandler=function(e){var t=e.event.target.parentElement;(e.event.target.classList.contains(tt)||e.event.target.classList.contains(lt)||e.event.target.classList.contains(st))&&this.displayMenu(t.parentElement)},e.prototype.displayMenu=function(e){null===document.querySelector("."+this.parentID+"calculatedmenu")||!e.querySelector(".e-list-icon").classList.contains(H)||e.querySelector(".e-list-icon").classList.contains(st)||e.querySelector(".e-list-icon").classList.contains(lt)||"LI"!==e.tagName?e.querySelector(".e-list-icon").classList.contains(lt)&&"LI"===e.tagName?(t.addClass([e.querySelector(".e-list-icon")],st),t.removeClass([e.querySelector(".e-list-icon")],lt),e.querySelector("."+st).setAttribute("title",this.parent.localeObj.getConstant("clear")),this.isEdit=!0,this.currentFieldName=e.getAttribute("data-field"),this.inputObj.value=e.getAttribute("data-caption"),this.dialog.element.querySelector("."+Je).value=e.getAttribute("data-caption"),document.querySelector("#"+this.parentID+"droppable").value=e.getAttribute("data-uid")):e.querySelector(".e-list-icon").classList.contains(st)&&"LI"===e.tagName&&(t.addClass([e.querySelector(".e-list-icon")],lt),t.removeClass([e.querySelector(".e-list-icon")],st),e.querySelector("."+lt).setAttribute("title",this.parent.localeObj.getConstant("edit")),this.isEdit=!1,this.inputObj.value="",this.dialog.element.querySelector("."+Je).value="",document.querySelector("#"+this.parentID+"droppable").value=""):(this.menuObj.close(),this.curMenu=e.querySelector("."+Re),this.openContextMenu())},e.prototype.openContextMenu=function(){var e=this.curMenu.getBoundingClientRect();this.parent.enableRtl?this.menuObj.open(e.top+30,e.left-100):this.menuObj.open(e.top+30,e.left+150)},e.prototype.selectContextMenu=function(e){if(null!==e.element.textContent){var i=t.closest(this.curMenu,".e-list-item").getAttribute("data-caption");t.closest(this.curMenu,".e-list-item").setAttribute("data-type",e.element.textContent),this.curMenu.textContent=i+" ("+e.element.textContent+")",t.addClass([this.curMenu.parentElement.parentElement],["e-node-focus","e-hover"]),this.curMenu.parentElement.parentElement.setAttribute("tabindex","-1"),this.curMenu.parentElement.parentElement.focus()}},e.prototype.createMenu=function(){var e=[{text:"Count"},{text:"Avg"},{text:"Min"},{text:"Max"},{text:"Sum"},{text:ui},{text:"Product"},{text:ci},{text:mi},{text:"SampleVar"},{text:gi}],i={cssClass:this.parentID+"calculatedmenu",items:e,enableRtl:this.parent.enableRtl,beforeOpen:this.beforeMenuOpen.bind(this),select:this.selectContextMenu.bind(this)};this.parent.element.appendChild(t.createElement("ul",{id:this.parentID+"contextmenu"})),this.menuObj=new l.ContextMenu(i),this.menuObj.appendTo("#"+this.parentID+"contextmenu")},e.prototype.applyFormula=function(){var e=this,i=!1;if(t.removeClass([document.getElementById(this.parentID+"ddlelement")],dt),Object.keys(e.parent.engineModule.fieldList).forEach(function(t,r){e.inputObj.value&&e.inputObj.value===t&&"CalculatedField"!==e.parent.engineModule.fieldList[t].aggregateType&&(i=!0)}),i)e.parent.pivotCommon.errorDialog.createErrorDialog(e.parent.localeObj.getConstant("error"),e.parent.localeObj.getConstant("fieldExist"));else{this.newFields=t.extend([],this.parent.dataSource.calculatedFieldSettings,null,!0),this.existingReport=t.extend({},this.parent.dataSource,null,!0);var r=this.parent.dataSource,a=document.querySelector("#"+this.parentID+"droppable");if(null!==this.inputObj.value&&""!==this.inputObj.value&&""!==a.value){var n={name:this.inputObj.value,type:"CalculatedField"},o={name:this.inputObj.value,formula:a.value};if(this.isFieldExist=!0,this.isEdit){for(l=0;l<r.values.length;l++)if(r.values[l].type===vi&&null!==this.currentFieldName&&r.values[l].name===this.currentFieldName&&this.isEdit)for(s=0;s<r.calculatedFieldSettings.length;s++)r.calculatedFieldSettings[s].name===this.currentFieldName&&(r.values[l].caption=this.inputObj.value,r.calculatedFieldSettings[s].formula=a.value,this.parent.engineModule.fieldList[this.currentFieldName].caption=this.inputObj.value,this.isFieldExist=!1)}else for(var l=0;l<r.values.length;l++)if(r.values[l].type===vi&&r.values[l].name===n.name){for(var s=0;s<r.calculatedFieldSettings.length;s++)if(r.calculatedFieldSettings[s].name===n.name)return void this.createConfirmDialog(e.parent.localeObj.getConstant("alert"),e.parent.localeObj.getConstant("confirmText"));this.isFieldExist=!1}this.isFieldExist&&(r.values.push(n),r.calculatedFieldSettings.push(o)),this.addFormula(r,n.name)}else null===this.inputObj.value||""===this.inputObj.value?(t.addClass([document.getElementById(this.parentID+"ddlelement")],dt),document.getElementById(this.parentID+"ddlelement").focus()):this.parent.pivotCommon.errorDialog.createErrorDialog(this.parent.localeObj.getConstant("error"),this.parent.localeObj.getConstant("invalidFormula"))}},e.prototype.addFormula=function(e,t){try{this.parent.setProperties({dataSource:e},!0),"pivotfieldlist"===this.parent.getModuleName()&&this.parent.allowDeferLayoutUpdate&&(this.parent.isRequiredUpdate=!1),this.parent.updateDataSource(!1),this.isEdit=!1,this.dialog?this.dialog.close():(this.inputObj.value="",this.formulaText=null,this.fieldText=null,this.parent.dialogRenderer.parentElement.querySelector("."+Je).value="",this.parent.dialogRenderer.parentElement.querySelector("#"+this.parentID+"droppable").value="")}catch(e){this.parent.engineModule.fieldList[t]&&delete this.parent.engineModule.fieldList[t],this.parent.pivotCommon.errorDialog.createErrorDialog(this.parent.localeObj.getConstant("error"),this.parent.localeObj.getConstant("invalidFormula")),this.parent.setProperties({dataSource:this.existingReport},!0),this.parent.updateDataSource(!1)}},e.prototype.getFieldListData=function(e){var t=[];return Object.keys(e.engineModule.fieldList).forEach(function(i){var r=null;r="string"===e.engineModule.fieldList[i].type||"include"===e.engineModule.fieldList[i].type||"exclude"===e.engineModule.fieldList[i].type?"Count":void 0!==e.engineModule.fieldList[i].aggregateType?e.engineModule.fieldList[i].aggregateType:"Sum",t.push({index:e.engineModule.fieldList[i].index,name:e.engineModule.fieldList[i].caption+" ("+r+")",type:r,icon:tt+" "+H,formula:e.engineModule.fieldList[i].formula,field:i,caption:e.engineModule.fieldList[i].caption?e.engineModule.fieldList[i].caption:i})}),t},e.prototype.beforeMenuOpen=function(e){e.element.style.zIndex=(this.dialog.zIndex+1).toString(),e.element.style.display="inline"},e.prototype.fieldDropped=function(e){e.cancel=!0;var t=e.draggedNode.getAttribute("data-field"),i=e.draggedNode.getAttribute("data-type"),r=this.dialog.element.querySelector("#"+this.parentID+"droppable");if(e.target.id===this.parentID+"droppable"&&""===r.value)r.value=i===vi?e.draggedNodeData.id.toString():'"'+i+"("+t+')"',r.focus();else if(e.target.id===this.parentID+"droppable"&&""!==r.value){var a=void 0,n=r.selectionStart,o=r.value,l=o.substring(0,n),s=o.substring(n,o.length);i===vi?(a=l+e.draggedNodeData.id.toString(),r.value=l+e.draggedNodeData.id.toString()+s):(a=l+'"'+i+"("+t+')"',r.value=l+'"'+i+"("+t+')"'+s),r.focus(),r.setSelectionRange(a.length,a.length)}else e.cancel=!0},e.prototype.createDialog=function(){var e=this;null!==document.querySelector("#"+this.parentID+"calculateddialog")&&t.remove(document.querySelector("#"+this.parentID+"calculateddialog")),this.parent.element.appendChild(t.createElement("div",{id:this.parentID+"calculateddialog",className:"e-pivot-calc-dialog-div"})),this.dialog=new r.Dialog({allowDragging:!0,position:{X:"center",Y:"center"},buttons:[{click:function(){return e.applyFormula()},buttonModel:{content:this.parent.localeObj.getConstant("ok"),isPrimary:!0}},{click:function(){e.dialog.close(),e.isEdit=!1},buttonModel:{content:this.parent.localeObj.getConstant("cancel")}}],close:function(i){"pivotfieldlist"===e.parent.getModuleName()&&(e.parent.axisFieldModule.render(),"Fixed"!==e.parent.renderMode&&(t.addClass([e.parent.element.querySelector("."+z)],U),e.parent.dialogRenderer.fieldListDialog.show())),e.treeObj.destroy(),e.dialog.destroy(),e.newFields=null,t.remove(document.getElementById(e.parentID+"calculateddialog")),t.remove(document.querySelector("."+e.parentID+"calculatedmenu"))},beforeOpen:function(t){e.dialog.element.querySelector(".e-dlg-header").setAttribute("title",e.parent.localeObj.getConstant("createCalculatedField"))},animationSettings:{effect:"Zoom"},width:"25%",isModal:!1,closeOnEscape:!0,enableRtl:this.parent.enableRtl,showCloseIcon:!0,header:this.parent.localeObj.getConstant("createCalculatedField"),target:document.body}),this.dialog.appendTo("#"+this.parentID+"calculateddialog")},e.prototype.renderDialogElements=function(){var e=t.createElement("div",{id:this.parentID+"outerDiv",className:"e-pivot-calc-outer-div"});if("pivotfieldlist"===this.parent.getModuleName()&&null!==this.parent.dialogRenderer.parentElement.querySelector("."+it)&&this.parent.isAdaptive){var i=t.createElement("div",{id:this.parentID+"accordDiv",className:"e-pivot-accord"});e.appendChild(i);var r=t.createElement("div",{id:this.parentID+"buttonDiv",className:at}),a=t.createElement("button",{id:this.parentID+"addBtn",innerHTML:"ADD",className:"e-pivot-add-button"}),n=t.createElement("button",{id:this.parentID+"cancelBtn",innerHTML:"CANCEL",className:"e-pivot-cancel-button"});r.appendChild(n),r.appendChild(a),e.appendChild(r)}else{var o=t.createElement("div",{id:this.parentID+"outerDiv",className:"e-pivot-calc-input-div"}),l=t.createElement("input",{id:this.parentID+"ddlelement",attrs:{type:"text",tabindex:"1"},className:Je});if(o.appendChild(l),e.appendChild(o),!this.parent.isAdaptive){var s=t.createElement("div",{className:"e-pivot-all-field-title",innerHTML:this.parent.localeObj.getConstant("formulaField")});e.appendChild(s)}var d=t.createElement("div",{id:this.parentID+"control_wrapper",className:rt});if(d.appendChild(t.createElement("div",{id:this.parentID+"tree",className:"e-pivot-treeview"})),e.appendChild(d),!this.parent.isAdaptive){var p=t.createElement("div",{className:"e-pivot-formula-title",innerHTML:this.parent.localeObj.getConstant("formula")});e.appendChild(p)}var h=t.createElement("textarea",{id:this.parentID+"droppable",className:it,attrs:{placeholder:this.parent.isAdaptive?this.parent.localeObj.getConstant("dropTextMobile"):this.parent.localeObj.getConstant("dropText")}});if(e.appendChild(h),this.parent.isAdaptive){r=t.createElement("div",{id:this.parentID+"buttonDiv",className:at});var u=t.createElement("button",{id:this.parentID+"okBtn",innerHTML:this.parent.localeObj.getConstant("apply"),className:"e-pivot-ok-button"});r.appendChild(u),e.appendChild(r)}}return e},e.prototype.renderAdaptiveLayout=function(){document.querySelector("#"+this.parentID+"droppable")&&(this.formulaText=document.querySelector("#"+this.parentID+"droppable").value,this.fieldText=this.inputObj.value),this.renderMobileLayout(this.parent.dialogRenderer.adaptiveElement)},e.prototype.createTreeView=function(){var e=this;this.treeObj=new l.TreeView({fields:{dataSource:this.getFieldListData(this.parent),id:"formula",text:"name",iconCss:"icon"},allowDragAndDrop:!0,enableRtl:this.parent.enableRtl,nodeCollapsing:function(e){e.cancel=!0},nodeDragStart:function(i){if(i.event.target.classList.contains(le)){var r=document.querySelector(".e-drag-item.e-treeview");t.addClass([r],"e-pivot-calc"),r.style.zIndex=(e.dialog.zIndex+1).toString(),r.style.display="inline"}else i.cancel=!0},nodeClicked:this.fieldClickHandler.bind(this),nodeDragStop:this.fieldDropped.bind(this),drawNode:this.drawTreeNode.bind(this),sortOrder:"Ascending"}),this.treeObj.appendTo("#"+this.parentID+"tree")},e.prototype.drawTreeNode=function(e){var i=e.nodeData.field;e.node.setAttribute("data-field",i),e.node.setAttribute("data-caption",e.nodeData.caption),e.node.setAttribute("data-type",e.nodeData.type);var r=t.createElement("span",{attrs:{tabindex:"-1","aria-disabled":"false",title:this.parent.localeObj.getConstant("dragField")},className:H+" e-drag"});t.prepend([r],e.node.querySelector("."+Ae)),t.append([e.node.querySelector("."+tt)],e.node.querySelector("."+Ae)),"number"!==this.parent.engineModule.fieldList[i].type&&this.parent.engineModule.fieldList[i].aggregateType!==vi?t.removeClass([e.node.querySelector("."+tt)],H):e.node.querySelector("."+tt).setAttribute("title",this.parent.localeObj.getConstant("format")),this.parent.engineModule.fieldList[i].aggregateType===vi&&(e.node.querySelector("."+tt).setAttribute("title",this.parent.localeObj.getConstant("edit")),t.addClass([e.node.querySelector("."+tt)],lt),t.removeClass([e.node.querySelector("."+tt)],tt))},e.prototype.createTypeContainer=function(e){for(var i=t.createElement("div",{id:this.parentID+"control_wrapper",className:rt}),r=["Sum","Count","Avg","Min","Max",ui,"Product",ci,mi,"SampleVar",gi],a=0;a<5;a++){var n=t.createElement("input",{id:this.parentID+"radio"+e+r[a],attrs:{type:"radio","data-ftxt":e},className:"e-pivot-calc-radio"});i.appendChild(n)}return i},e.prototype.getAccordionData=function(e){var t=this,i=[];return Object.keys(e.engineModule.fieldList).forEach(function(r,a){i.push({header:"<input id="+t.parentID+"_"+a+' class=e-pivot-calc-check type="checkbox" data-field='+r+" data-caption="+t.parent.engineModule.fieldList[r].caption+" data-type="+t.parent.engineModule.fieldList[r].type+"/>",content:e.engineModule.fieldList[r].aggregateType===vi||"number"!==t.parent.engineModule.fieldList[r].type?"":t.createTypeContainer(r).outerHTML})}),i},e.prototype.renderMobileLayout=function(e){var t=this;e.items[4].content=this.renderDialogElements().outerHTML,e.dataBind();var i=new h.Button({cssClass:et,isPrimary:!0});if(i.appendTo("#"+this.parentID+"cancelBtn"),i.element&&(i.element.onclick=this.cancelBtnClick.bind(this)),null!==this.parent.dialogRenderer.parentElement.querySelector("."+it)&&this.parent.isAdaptive){var r=new h.Button({cssClass:et+" e-outline",isPrimary:!0});if(r.appendTo("#"+this.parentID+"okBtn"),this.inputObj=new s.MaskedTextBox({placeholder:this.parent.localeObj.getConstant("fieldName")}),this.inputObj.appendTo("#"+this.parentID+"ddlelement"),null!==this.formulaText&&null!==this.parent.dialogRenderer.parentElement.querySelector("#"+this.parentID+"droppable")){this.parent.dialogRenderer.parentElement.querySelector("#"+this.parentID+"droppable").value=this.formulaText}null!==this.fieldText&&null!==this.parent.dialogRenderer.parentElement.querySelector("."+Je)&&(this.parent.dialogRenderer.parentElement.querySelector("."+Je).value=this.fieldText,this.inputObj.value=this.fieldText),r.element&&(r.element.onclick=this.applyFormula.bind(this))}else if(this.parent.isAdaptive){var a=new l.Accordion({items:this.getAccordionData(this.parent),enableRtl:this.parent.enableRtl,expanding:function(e){0===e.element.querySelectorAll(".e-radio-wrapper").length&&Object.keys(t.parent.engineModule.fieldList).forEach(function(i){var r=["Sum","Count","Avg","Min","Max",ui,"Product",ci,mi,"SampleVar",gi];if(i===e.element.querySelector("[data-field").getAttribute("data-field"))for(var a=0;a<5;a++)new h.RadioButton({label:r[a],name:"AggregateType"+i,change:function(e){var t=e.event.target.parentElement.querySelector(".e-label").innerText,i=e.event.target.closest(".e-acrdn-item").querySelector("[data-field").getAttribute("data-caption");e.event.target.closest(".e-acrdn-item").querySelector(".e-label").innerText=i+" ("+t+")",e.event.target.closest(".e-acrdn-item").querySelector("[data-type").setAttribute("data-type",t)}}).appendTo("#"+t.parentID+"radio"+i+r[a])})}}),n=new h.Button({cssClass:et,isPrimary:!0});n.appendTo("#"+this.parentID+"addBtn"),a.appendTo("#"+this.parentID+"accordDiv"),Object.keys(this.parent.engineModule.fieldList).forEach(function(e,i){var r=null;r="string"===t.parent.engineModule.fieldList[e].type||"include"===t.parent.engineModule.fieldList[e].type||"exclude"===t.parent.engineModule.fieldList[e].type?"Count":void 0!==t.parent.engineModule.fieldList[e].aggregateType?t.parent.engineModule.fieldList[e].aggregateType:"Sum";new h.CheckBox({label:t.parent.engineModule.fieldList[e].caption+" ("+r+")"}).appendTo("#"+t.parentID+"_"+i),document.querySelector("#"+t.parentID+"_"+i).setAttribute("data-field",e),document.querySelector("#"+t.parentID+"_"+i).setAttribute("data-type",r)}),n.element&&(n.element.onclick=this.addBtnClick.bind(this))}},e.prototype.cancelBtnClick=function(){this.renderMobileLayout(this.parent.dialogRenderer.adaptiveElement)},e.prototype.addBtnClick=function(){for(var e=document.querySelectorAll(".e-accordion .e-check"),t="",i=null,r=null,a=0;a<e.length;a++)if(i=e[a].parentElement.querySelector("[data-field]").getAttribute("data-field"),-1===(r=e[a].parentElement.querySelector("[data-field]").getAttribute("data-type")).indexOf(vi))t=t+'"'+r+"("+i+')"';else for(var n=0;n<this.parent.dataSource.calculatedFieldSettings.length;n++)if(this.parent.dataSource.calculatedFieldSettings[n].name===i){t+=this.parent.dataSource.calculatedFieldSettings[n].formula;break}this.formulaText=null!==this.formulaText?this.formulaText+t:t,this.renderMobileLayout(this.parent.dialogRenderer.adaptiveElement)},e.prototype.createCalculatedFieldDialog=function(){this.parent.isAdaptive&&"pivotfieldlist"===this.parent.getModuleName()?this.renderAdaptiveLayout():this.parent.isAdaptive||(this.renderDialogLayout(),this.dialog.element.style.top=parseInt(this.dialog.element.style.top,10)<0?"0px":this.dialog.element.style.top)},e.prototype.renderDialogLayout=function(){this.newFields=t.extend([],this.parent.dataSource.calculatedFieldSettings,null,!0),this.createDialog(),this.dialog.content=this.renderDialogElements(),this.dialog.refresh(),this.inputObj=new s.MaskedTextBox({placeholder:this.parent.localeObj.getConstant("fieldName")}),this.inputObj.appendTo("#"+this.parentID+"ddlelement"),this.createTreeView(),this.createMenu(),this.droppable=new t.Droppable(this.dialog.element.querySelector("#"+this.parentID+"droppable")),this.keyboardEvents=new t.KeyboardEvents(this.parent.calculatedFieldModule.dialog.element,{keyAction:this.keyActionHandler.bind(this),keyConfigs:{moveRight:"rightarrow",enter:"enter"},eventName:"keydown"})},e.prototype.createConfirmDialog=function(e,i){var a=t.createElement("div",{id:this.parentID+"_ErrorDialog",className:ye});this.parent.element.appendChild(a),this.confirmPopUp=new r.Dialog({animationSettings:{effect:"Fade"},allowDragging:!1,showCloseIcon:!0,enableRtl:this.parent.enableRtl,width:"auto",height:"auto",position:{X:"center",Y:"center"},buttons:[{click:this.replaceFormula.bind(this),buttonModel:{cssClass:ve+" e-outline",content:this.parent.localeObj.getConstant("ok"),isPrimary:!0}},{click:this.removeErrorDialog.bind(this),buttonModel:{cssClass:fe,content:this.parent.localeObj.getConstant("cancel"),isPrimary:!0}}],header:e,content:i,isModal:!0,visible:!0,closeOnEscape:!0,target:document.body,close:this.removeErrorDialog.bind(this)}),this.confirmPopUp.appendTo(a)},e.prototype.replaceFormula=function(){for(var e=this.parent.dataSource,t=document.querySelector("#"+this.parentID+"droppable"),i=0;i<e.values.length;i++)if(e.values[i].type===vi&&e.values[i].name===this.inputObj.value)for(var r=0;r<e.calculatedFieldSettings.length;r++)e.calculatedFieldSettings[r].name===this.inputObj.value&&(e.calculatedFieldSettings[r].formula=t.value);this.addFormula(e,this.inputObj.value),this.removeErrorDialog()},e.prototype.removeErrorDialog=function(){document.getElementById(this.parentID+"_ErrorDialog")&&t.remove(document.getElementById(this.parentID+"_ErrorDialog").parentElement)},e.prototype.addEventListener=function(){this.parent.isDestroyed||this.parent.on(j,this.createCalculatedFieldDialog,this)},e.prototype.removeEventListener=function(){this.parent.isDestroyed||this.parent.off(j,this.createCalculatedFieldDialog)},e.prototype.destroy=function(){this.removeEventListener()},e}();hi.Inject(fi);var yi=function(){function e(e){this.parent=e,this.addEventListener()}return e.prototype.getModuleName=function(){return"fieldlist"},e.prototype.initiateModule=function(){this.element=t.createElement("div",{id:this.parent.element.id+"_PivotFieldList",styles:"position:"+(this.parent.enableRtl?"static":"absolute")+";height:0;width:"+this.parent.element.style.width}),this.parent.element.parentElement.setAttribute("id","ContainerWrapper"),this.parent.element.parentElement.appendChild(this.element),this.parent.element.parentElement.appendChild(this.parent.element),this.parent.pivotFieldListModule=new hi({dataSource:{rows:[],columns:[],values:[],filters:[]},allowDeferLayoutUpdate:this.parent.allowDeferLayoutUpdate,renderMode:"Popup",allowCalculatedField:this.parent.allowCalculatedField,enableRtl:this.parent.enableRtl,locale:this.parent.locale,target:this.parent.element.parentElement}),this.parent.pivotFieldListModule.appendTo("#"+this.element.id)},e.prototype.updateControl=function(){var e=this;this.element&&(t.prepend([this.element],this.parent.element),this.parent.grid&&this.parent.showGroupingBar&&this.parent.groupingBarModule?(clearTimeout(this.timeOutObj),this.timeOutObj=setTimeout(function(){if(e.parent.grid&&e.parent.grid.element){var i=e.parent.grid.element.offsetWidth<400?400:e.parent.grid.element.offsetWidth;t.setStyleAttribute(e.element.querySelector("."+z),{left:t.formatUnit(e.parent.enableRtl?-Math.abs(i-e.element.querySelector("."+z).offsetWidth):i-e.element.querySelector("."+z).offsetWidth)}),e.parent.enableRtl?t.addClass([e.element.querySelector("."+z)],"e-fieldlist-left"):t.removeClass([e.element.querySelector("."+z)],"e-fieldlist-left")}})):this.parent.enableRtl?t.removeClass([this.element.querySelector("."+z)],"e-fieldlist-left"):t.addClass([this.element.querySelector("."+z)],"e-fieldlist-left"),t.setStyleAttribute(this.element,{width:t.formatUnit(this.parent.element.offsetWidth)})),this.parent.pivotFieldListModule.update(this.parent)},e.prototype.addEventListener=function(){this.handlers={load:this.initiateModule,update:this.updateControl},this.parent.isDestroyed||(this.parent.on(N,this.handlers.load,this),this.parent.on(L,this.handlers.update,this))},e.prototype.removeEventListener=function(){this.parent.isDestroyed||(this.parent.off(N,this.handlers.load),this.parent.off(L,this.handlers.update))},e.prototype.destroy=function(){this.removeEventListener(),this.parent.pivotFieldListModule&&this.parent.pivotFieldListModule.destroy()},e}(),bi=function(){function e(e){this.parent=e,this.parent.commonModule=this,this.addEventListener()}return e.prototype.getModuleName=function(){return"common"},e.prototype.initiateCommonModule=function(){if(this.parent.pivotCommon)this.parent.pivotCommon.element=this.parent.element,this.parent.pivotCommon.engineModule=this.parent.engineModule,this.parent.pivotCommon.parentID=this.parent.element.id,this.parent.pivotCommon.dataSource=this.parent.dataSource.properties?this.parent.dataSource.properties:this.parent.dataSource,this.parent.pivotCommon.moduleName=this.parent.getModuleName(),this.parent.pivotCommon.enableRtl=this.parent.enableRtl,this.parent.pivotCommon.isAdaptive=t.Browser.isDevice,this.parent.pivotCommon.renderMode="Popup",this.parent.pivotCommon.localeObj=this.parent.localeObj;else{var e={pivotEngine:this.parent.engineModule,dataSource:this.parent.dataSource.properties?this.parent.dataSource.properties:this.parent.dataSource,id:this.parent.element.id,element:this.parent.element,moduleName:this.parent.getModuleName(),enableRtl:this.parent.enableRtl,isAdaptive:t.Browser.isDevice,renderMode:"Popup",localeObj:this.parent.localeObj};this.parent.pivotCommon=new ti(e)}this.parent.pivotCommon.control=this.parent},e.prototype.addEventListener=function(){this.handlers={load:this.initiateCommonModule},this.parent.isDestroyed||this.parent.on(L,this.handlers.load,this)},e.prototype.removeEventListener=function(){this.parent.isDestroyed||this.parent.off(L,this.handlers.load)},e.prototype.destroy=function(){this.removeEventListener(),this.parent.pivotCommon&&this.parent.pivotCommon.destroy()},e}(),Si=function(){function e(e){this.parent=e}return e.prototype.render=function(){this.pivotButton=new oi(this.parent),this.createPivotButtons();for(var e=[].slice.call(this.parent.element.querySelector("."+Te).querySelectorAll("."+J)),i=e.length,r=0;r<i;r++){var a=t.createElement("span",{className:"e-indent-div",styles:"width:"+24*r+"px"});t.prepend([a],e[r])}},e.prototype.createPivotButtons=function(){var e=[this.parent.dataSource.rows,this.parent.dataSource.columns,this.parent.dataSource.values,this.parent.dataSource.filters];this.parent.element.querySelector("."+Te).innerHTML="",this.parent.element.querySelector("."+Ee).innerHTML="",this.parent.element.querySelector("."+Me).innerHTML="",this.parent.element.querySelector("."+Pe).innerHTML="";for(var t=["rows","columns","values","filters"],i=0,r=e.length;i<r;i++)if(e[i]){var a={field:e[i],axis:t[i].toString()};this.parent.notify(k,a)}},e}();Yt.Inject(bi);var Ci=function(){function e(e){this.parent=e,this.parent.groupingBarModule=this,this.addEventListener(),this.parent.axisFieldModule=new Si(this.parent),this.touchObj=new t.Touch(this.parent.element,{tapHold:this.tapHoldHandler.bind(this)})}return e.prototype.getModuleName=function(){return"grouping"},e.prototype.renderLayout=function(){this.groupingTable=t.createElement("div",{className:De}),this.leftAxisPanel=t.createElement("div",{className:X}),this.rightAxisPanel=t.createElement("div",{className:K});var e=t.createElement("div",{className:"e-axis-row e-axiswrapper"}),i=t.createElement("div",{className:"e-axis-column e-axiswrapper"}),r=t.createElement("div",{className:"e-axis-value e-axiswrapper"}),a=t.createElement("div",{className:ot+" "+nt+"wrapper"});this.rowPanel=t.createElement("div",{className:Te+" "+Se}),this.columnPanel=t.createElement("div",{className:Ee+" "+Ce}),this.valuePanel=t.createElement("div",{className:Me+" "+we}),this.filterPanel=t.createElement("div",{className:Pe+" "+xe}),e.appendChild(this.rowPanel),i.appendChild(this.columnPanel),r.appendChild(this.valuePanel),a.appendChild(this.filterPanel),this.rowAxisPanel=e,this.columnAxisPanel=i,this.valueAxisPanel=r,this.filterAxisPanel=a,this.leftAxisPanel.appendChild(r),this.leftAxisPanel.appendChild(e),this.rightAxisPanel.appendChild(a),this.rightAxisPanel.appendChild(i),this.groupingTable.appendChild(this.leftAxisPanel),this.groupingTable.appendChild(this.rightAxisPanel);for(var n=0,o=[this.rowPanel,this.columnPanel,this.valuePanel,this.filterPanel];n<o.length;n++){var l=o[n];new t.Droppable(l,{}),this.unWireEvent(l),this.wireEvent(l)}},e.prototype.appendToElement=function(){this.parent.element.querySelector("."+De)&&t.remove(this.parent.element.querySelector("."+De)),this.parent.isAdaptive&&(this.leftAxisPanel.style.minWidth="180px",this.valuePanel.style.minWidth="180px"),this.parent.firstColWidth&&(this.leftAxisPanel.style.minWidth="auto",this.valuePanel.style.minWidth="auto"),this.filterPanel.removeAttribute("style"),this.columnPanel.removeAttribute("style"),this.rowPanel.removeAttribute("style"),this.filterPanel.removeAttribute("style");if(Object.keys(this.parent.engineModule.headerContent).length){var e=this.parent.element.querySelector(".e-frozenheader").querySelector(".e-columnheader");t.addClass([e],"e-row"),e.removeAttribute("style"),t.addClass([e.querySelector(".e-headercell")],"e-group-row"),e.querySelector(".e-group-row").appendChild(this.rowAxisPanel),e.querySelector(".e-group-row").querySelector(".e-headercelldiv").style.display="none",e.querySelector(".e-group-row").querySelector(".e-sortfilterdiv").style.display="none"}t.prepend([this.groupingTable],this.parent.element),t.setStyleAttribute(this.groupingTable,{width:t.formatUnit(this.parent.grid.width)}),this.groupingTable.style.minWidth="400px",this.parent.axisFieldModule.render(),this.setGridRowWidth();var i=this.parent.element.querySelector(".e-frozenheader").querySelector("colgroup").children[0],r=t.formatUnit(this.groupingTable.offsetWidth-parseInt(i.style.width,10));t.setStyleAttribute(this.valuePanel,{width:i.style.width}),t.setStyleAttribute(this.rightAxisPanel,{width:r});var a=this.valuePanel.offsetHeight/2;a>this.columnPanel.offsetHeight&&(t.setStyleAttribute(this.filterPanel,{height:t.formatUnit(a)}),t.setStyleAttribute(this.columnPanel,{height:t.formatUnit(a+1)}));var n=this.parent.element.querySelector(".e-headercontent").offsetHeight;t.setStyleAttribute(this.rowPanel,{height:n+"px"}),this.parent.element.querySelector(".e-frozenheader").querySelector(".e-rhandler")&&(this.parent.element.querySelector(".e-frozenheader").querySelector(".e-rhandler").style.height=n+"px");for(var o=[].slice.call(this.parent.element.querySelector(".e-movableheader").querySelector("thead").querySelectorAll("tr")).filter(function(e){return e.childNodes.length>0}),l=n/o.length,s=0,d=o;s<d.length;s++){var p=d[s];t.setStyleAttribute(p,{height:l+"px"});for(var h=0,u=[].slice.call(p.querySelectorAll(".e-rhandler"));h<u.length;h++){var c=u[h];t.setStyleAttribute(c,{height:l+"px"})}}},e.prototype.refreshUI=function(){var e=this;t.setStyleAttribute(this.groupingTable,{width:t.formatUnit(this.parent.grid.width)}),this.groupingTable.style.minWidth="400px";var i=this.parent.element.querySelector(".e-frozenheader").querySelector("colgroup").children[0],r=t.formatUnit(this.groupingTable.offsetWidth-parseInt(i.style.width,10));if(t.setStyleAttribute(this.valuePanel,{width:i.style.width}),t.setStyleAttribute(this.rightAxisPanel,{width:r}),this.parent.showFieldList&&this.parent.pivotFieldListModule&&this.parent.pivotFieldListModule.element){var a=this.parent.pivotFieldListModule.element;clearTimeout(this.timeOutObj),this.timeOutObj=setTimeout(function(){var i=e.parent.grid.element.offsetWidth<400?400:e.parent.grid.element.offsetWidth;t.setStyleAttribute(a.querySelector("."+z),{left:t.formatUnit(e.parent.enableRtl?-Math.abs(i-a.querySelector("."+z).offsetWidth):i-a.querySelector("."+z).offsetWidth)})})}if(!this.parent.grid.element.querySelector(".e-group-row")){var n=this.parent.element.querySelector(".e-frozenheader").querySelector(".e-columnheader");t.addClass([n],"e-row"),t.addClass([n.querySelector(".e-headercell")],"e-group-row"),n.querySelector(".e-group-row").appendChild(this.rowAxisPanel),t.setStyleAttribute(n.querySelector(".e-group-row").querySelector(".e-headercelldiv"),{display:"none"}),t.setStyleAttribute(n.querySelector(".e-group-row").querySelector(".e-sortfilterdiv"),{display:"none"});var o=this.parent.element.querySelector(".e-headercontent").offsetHeight;t.setStyleAttribute(this.rowPanel,{height:o+"px"}),this.parent.element.querySelector(".e-frozenheader").querySelector(".e-rhandler")&&(this.parent.element.querySelector(".e-frozenheader").querySelector(".e-rhandler").style.height=o+"px");for(var l=[].slice.call(this.parent.element.querySelector(".e-movableheader").querySelector("thead").querySelectorAll("tr")).filter(function(e){return e.childNodes.length>0}),s=o/l.length,d=0,p=l;d<p.length;d++){var h=p[d];t.setStyleAttribute(h,{height:s+"px"});for(var u=0,c=[].slice.call(h.querySelectorAll(".e-rhandler"));u<c.length;u++){var m=c[u];t.setStyleAttribute(m,{height:s+"px"})}}}},e.prototype.setGridRowWidth=function(){var e=this.parent.element.querySelector(".e-frozenheader").querySelector("colgroup").children[0];if(this.rowPanel.querySelector("."+ee))if(this.parent.isAdaptive)for(var i=0,r=a=[].slice.call(this.rowPanel.querySelectorAll("."+J));i<r.length;i++){r[i].style.width="140px"}else{var a,n=(a=[].slice.call(this.rowPanel.querySelectorAll("."+J)))[a.length-1],o=n.querySelector("."+ee).offsetWidth+n.querySelector(".e-indent-div").offsetWidth+20,l=this.parent.isAdaptive?180:250,s=t.formatUnit(o<l?l:o),d=this.parent.element.querySelector(".e-frozenheader").querySelector("table"),p=this.parent.element.querySelector(".e-frozencontent").querySelector("table"),h=this.parent.element.querySelector(".e-frozencontent").querySelector("colgroup").children[0],u=parseInt(s,10),c=this.parent.grid.columns;c&&c.length>0&&(c[0].width=(c[0].width,u>l?u:l));for(var m=this.parent.renderModule.calculateColWidth(this.parent.dataSource.values.length>0?this.parent.engineModule.pivotValues[0].length:2),g=0;g<c.length;g++)0!==g&&(c[g].columns?this.setColWidth(c[g].columns,m):c[g].width=m);this.parent.posCount=0,this.parent.setGridColumns(this.parent.grid.columns),this.parent.grid.headerModule.refreshUI(),this.parent.firstColWidth||(e.style.width=s,h.style.width=s,d.style.width=s,p.style.width=s,t.setStyleAttribute(d,{width:s}),t.setStyleAttribute(p,{width:s}))}this.refreshUI()},e.prototype.setColWidth=function(e,t){for(var i=0;i<e.length;i++)e[i].columns?this.setColWidth(e[i].columns,t):e[i].width=t},e.prototype.wireEvent=function(e){t.EventHandler.add(e,"mouseover",this.dropIndicatorUpdate,this),t.EventHandler.add(e,"mouseleave",this.dropIndicatorUpdate,this)},e.prototype.unWireEvent=function(e){t.EventHandler.remove(e,"mouseover",this.dropIndicatorUpdate),t.EventHandler.remove(e,"mouseleave",this.dropIndicatorUpdate)},e.prototype.dropIndicatorUpdate=function(e){(this.parent.isDragging&&e.target.classList.contains(be)&&"mouseover"===e.type||"mouseleave"===e.type)&&(t.removeClass([].slice.call(this.parent.element.querySelectorAll("."+se)),de),t.removeClass([].slice.call(this.parent.element.querySelectorAll("."+se+"-last")),de))},e.prototype.tapHoldHandler=function(e){var i=t.closest(e.originalEvent.target,"."+ee);if(!t.isNullOrUndefined(i)&&this.parent.isAdaptive){var r=i.getBoundingClientRect();return this.parent.contextMenuModule.fieldElement=i,void this.parent.contextMenuModule.menuObj.open(r.top,r.left)}},e.prototype.addEventListener=function(){this.handlers={load:this.renderLayout,end:this.appendToElement},this.parent.isDestroyed||(this.parent.on(N,this.handlers.load,this),this.parent.on(L,this.handlers.end,this))},e.prototype.removeEventListener=function(){this.parent.isDestroyed||(this.parent.off(N,this.handlers.end),this.parent.off(L,this.handlers.load))},e.prototype.destroy=function(){this.removeEventListener(),this.parent.pivotButtonModule&&(this.parent.pivotButtonModule.destroy(),this.touchObj&&!this.touchObj.isDestroyed&&this.touchObj.destroy())},e}(),wi=function(){function e(e){this.parent=e,this.parent.conditionalFormattingModule=this,this.parentID=this.parent.element.id,this.dialog=null,this.fieldsDropDown=[],this.conditionsDropDown=[],this.fontNameDropDown=[],this.fontSizeDropDown=[],this.fontColor=[],this.backgroundColor=[],this.newFormat=[]}return e.prototype.getModuleName=function(){return"conditionalformatting"},e.prototype.createDialog=function(){var e=this;null!==document.querySelector("#"+this.parentID+"conditionalformatting")&&t.remove(document.querySelector("#"+this.parentID+"conditionalformatting")),this.parent.element.appendChild(t.createElement("div",{id:this.parentID+"conditionalformatting"}));var i=[{click:function(){e.refreshConditionValues(),e.newFormat.push({conditions:"LessThan",value1:0,style:{backgroundColor:"white",color:"black",fontFamily:"Arial",fontSize:"12px"}}),e.addFormat()},buttonModel:{cssClass:this.parent.isAdaptive?"e-small e-round "+ht:ht,iconCss:H+" "+qe,content:this.parent.isAdaptive?"":this.parent.localeObj.getConstant("condition")}},{click:function(){e.refreshConditionValues(),e.parent.setProperties({dataSource:{conditionalFormatSettings:e.newFormat}},!0),e.parent.renderPivotGrid(),e.destroy()},buttonModel:{cssClass:Y+" e-format-apply-button",content:this.parent.localeObj.getConstant("apply")}},{click:function(){e.destroy(),e.newFormat=[]},buttonModel:{cssClass:Y+" e-format-cancel-button",content:this.parent.localeObj.getConstant("cancel")}}];this.parent.isAdaptive?this.dialog=new r.Dialog({animationSettings:{effect:"Zoom"},isModal:!0,width:"100%",height:"100%",showCloseIcon:!1,closeOnEscape:!1,enableRtl:this.parent.enableRtl,position:{X:"center",Y:"center"},allowDragging:!0,buttons:i,beforeOpen:function(t){e.dialog.element.querySelector(".e-dlg-header").setAttribute("title",e.parent.localeObj.getConstant("conditionalFormating"))},cssClass:pt,header:this.parent.localeObj.getConstant("conditionalFormating"),target:document.body}):this.dialog=new r.Dialog({allowDragging:!0,position:{X:"center",Y:this.parent.element.offsetTop},buttons:i,beforeOpen:function(t){e.dialog.element.querySelector(".e-dlg-header").setAttribute("title",e.parent.localeObj.getConstant("conditionalFormating"))},cssClass:pt,isModal:!1,closeOnEscape:!0,enableRtl:this.parent.enableRtl,showCloseIcon:!0,header:this.parent.localeObj.getConstant("conditionalFormating"),target:this.parent.element}),this.dialog.appendTo("#"+this.parentID+"conditionalformatting")},e.prototype.refreshConditionValues=function(){for(var e=0;e<this.newFormat.length;e++)this.newFormat[e].value1=Number(document.querySelector("#"+this.parentID+"conditionvalue1"+e).value),this.newFormat[e].value2=Number(document.querySelector("#"+this.parentID+"conditionvalue2"+e).value)},e.prototype.addFormat=function(){for(var e=t.createElement("div",{id:this.parentID+"formatDiv",className:"e-new-format"}),i=0;i<this.newFormat.length;i++)e.appendChild(this.createDialogElements(i));this.dialog.setProperties({content:e},!1);for(i=0;i<this.newFormat.length;i++)this.renderDropDowns(i),this.renderColorPicker(i)},e.prototype.createDialogElements=function(e){var i=this.newFormat[e],r=t.createElement("div",{id:this.parentID+"outerDiv"+e,className:"e-format-outer-div"}),a=t.createElement("button",{id:this.parentID+"removeButton"+e,className:"e-format-delete-button",attrs:{title:this.parent.localeObj.getConstant("delete")}});r.appendChild(a);var n=t.createElement("div",{id:this.parentID+"innerDiv",className:"e-format-inner-div"}),o=t.createElement("table",{id:this.parentID+"cftable",className:ut}),l=t.createElement("tr"),s=t.createElement("td"),d=t.createElement("span",{id:this.parentID+"valuelabel"+e,className:"e-format-value-label",innerHTML:this.parent.localeObj.getConstant("value")});s.appendChild(d),l.appendChild(s),o.appendChild(l),l=t.createElement("tr"),s=t.createElement("td");var p=t.createElement("div",{id:this.parentID+"measure"+e}),h=t.createElement("input",{id:this.parentID+"measureinput"+e,attrs:{type:"text",tabindex:"1"}});p.appendChild(h),s.appendChild(p),l.appendChild(s),s=t.createElement("td");var u=t.createElement("div",{id:this.parentID+"condition"}),c=t.createElement("input",{id:this.parentID+"conditioninput"+e,attrs:{type:"text",tabindex:"1"}});u.appendChild(c),s.appendChild(u),l.appendChild(s),s=t.createElement("td");var m="Between"!==i.conditions&&"NotBetween"!==i.conditions?"display:none; width:10px":"",g=t.createElement("input",{id:this.parentID+"conditionvalue1"+e,attrs:{type:"text",tabindex:"1",value:t.isNullOrUndefined(i.value1)?"0":i.value1.toString()},styles:this.parent.isAdaptive?""===m?"width: 28%":"width: 100%":""===m?"width: 45px":"width: 120px",className:"e-input e-format-value1"});s.appendChild(g);var v=t.createElement("span",{id:this.parentID+"valuespan"+e,className:"e-format-value-span",innerHTML:"&",styles:m});s.appendChild(v);var f=t.createElement("input",{id:this.parentID+"conditionvalue2"+e,attrs:{type:"text",tabindex:"1",value:t.isNullOrUndefined(i.value2)?"0":i.value2.toString()},styles:this.parent.isAdaptive&&""===m?"width: 28%":""===m?"width: 45px":m,className:"e-input e-format-value2"});s.appendChild(f),l.appendChild(s),o.appendChild(l),this.parent.isAdaptive&&(n.appendChild(o),o=t.createElement("table",{id:this.parentID+"cftable",className:ut})),l=t.createElement("tr"),s=t.createElement("td");var y=t.createElement("span",{id:this.parentID+"formatlabel"+e,className:"e-format-label",innerHTML:this.parent.localeObj.getConstant("formatLabel")});s.appendChild(y),l.appendChild(s),o.appendChild(l),l=t.createElement("tr"),s=t.createElement("td");var b=t.createElement("div",{id:this.parentID+"fontname"}),S=t.createElement("input",{id:this.parentID+"fontnameinput"+e,attrs:{type:"text",tabindex:"1"}});b.appendChild(S),s.appendChild(b),l.appendChild(s),s=t.createElement("td");var C=t.createElement("div",{id:this.parentID+"fontsize"}),w=t.createElement("input",{id:this.parentID+"fontsizeinput"+e,attrs:{type:"text",tabindex:"1"}});C.appendChild(w),s.appendChild(C),l.appendChild(s),this.parent.isAdaptive&&(o.appendChild(l),l=t.createElement("tr"),o.appendChild(l),l=t.createElement("tr")),s=t.createElement("td");var x=t.createElement("input",{id:this.parentID+"fontcolor"+e,attrs:{type:"color",tabindex:"1"},className:"e-format-font-color"});s.appendChild(x);var D=t.createElement("input",{id:this.parentID+"backgroundcolor"+e,attrs:{type:"color",tabindex:"1"},className:"e-format-back-color"});s.appendChild(D),l.appendChild(s),s=t.createElement("td");var T=t.createElement("div",{id:this.parentID+"valuepreview"+e,className:"e-input e-format-value-preview",innerHTML:"123.45"});return s.appendChild(T),l.appendChild(s),o.appendChild(l),n.appendChild(o),r.appendChild(n),r},e.prototype.renderDropDowns=function(e){var i=this,r=this.newFormat[e],a=[];a.push({index:0,name:this.parent.localeObj.getConstant("AllValues"),field:this.parent.localeObj.getConstant("AllValues")});for(var n=0;n<this.parent.dataSource.values.length;n++)a.push({index:n+1,name:this.parent.dataSource.values[n].caption||this.parent.dataSource.values[n].name,field:this.parent.dataSource.values[n].name});var o=t.isNullOrUndefined(r.measure)?this.parent.localeObj.getConstant("AllValues"):r.measure;this.fieldsDropDown[e]=new d.DropDownList({dataSource:a,fields:{text:"name"},value:o,width:this.parent.isAdaptive?"100%":"120px",popupHeight:"200px",change:function(t){i.newFormat[e].measure=t.value.toString()===i.parent.localeObj.getConstant("AllValues")?void 0:t.value.toString()}}),this.fieldsDropDown[e].appendTo("#"+this.parentID+"measureinput"+e);var l=[{value:"LessThan",name:this.parent.localeObj.getConstant("LessThan")},{value:"LessThanOrEqualTo",name:this.parent.localeObj.getConstant("LessThanOrEqualTo")},{value:"GreaterThan",name:this.parent.localeObj.getConstant("GreaterThan")},{value:"GreaterThanOrEqualTo",name:this.parent.localeObj.getConstant("GreaterThanOrEqualTo")},{value:"Equals",name:this.parent.localeObj.getConstant("Equals")},{value:"NotEquals",name:this.parent.localeObj.getConstant("NotEquals")},{value:"Between",name:this.parent.localeObj.getConstant("Between")},{value:"NotBetween",name:this.parent.localeObj.getConstant("NotBetween")}];o=t.isNullOrUndefined(r.conditions)?"LessThan":r.conditions,this.conditionsDropDown[e]=new d.DropDownList({dataSource:l,fields:{value:"value",text:"name"},value:o,width:this.parent.isAdaptive?"100%":"120px",popupHeight:"200px",popupWidth:"200px",change:function(t){i.newFormat[e].conditions=t.value,"Between"===t.value||"NotBetween"===t.value?(document.querySelector("#"+i.parentID+"valuespan"+e).style.display="inline-block",document.querySelector("#"+i.parentID+"valuespan"+e).style.width=i.parent.isAdaptive?"10%":"10px",document.querySelector("#"+i.parentID+"conditionvalue2"+e).style.display="inline-block",document.querySelector("#"+i.parentID+"conditionvalue2"+e).style.width=i.parent.isAdaptive?"28%":"45px",document.querySelector("#"+i.parentID+"conditionvalue1"+e).style.width=i.parent.isAdaptive?"28%":"45px"):(document.querySelector("#"+i.parentID+"valuespan"+e).style.display="none",document.querySelector("#"+i.parentID+"conditionvalue2"+e).style.display="none",document.querySelector("#"+i.parentID+"conditionvalue1"+e).style.width=i.parent.isAdaptive?"100%":"120px")}}),this.conditionsDropDown[e].appendTo("#"+this.parentID+"conditioninput"+e);o=t.isNullOrUndefined(r.style.fontFamily)?"Arial":r.style.fontFamily,this.fontNameDropDown[e]=new d.DropDownList({dataSource:[{index:0,name:"Arial"},{index:1,name:"San Serif"},{index:2,name:"Impact"},{index:3,name:"Trebuchet MS"},{index:4,name:"Serif"},{index:5,name:"Verdana"},{index:6,name:"Courier New"},{index:7,name:"Times New Roman"},{index:8,name:"Tahoma"},{index:9,name:"Gerogia"}],fields:{text:"name"},value:o,width:this.parent.isAdaptive?"100%":"120px",popupWidth:"150px",popupHeight:"200px",change:function(t){i.newFormat[e].style.fontFamily=t.value.toString(),document.querySelector("#"+i.parentID+"valuepreview"+e).style.fontFamily=t.value}}),this.fontNameDropDown[e].appendTo("#"+this.parentID+"fontnameinput"+e);o=t.isNullOrUndefined(r.style.fontSize)?"12px":r.style.fontSize,this.fontSizeDropDown[e]=new d.DropDownList({dataSource:[{index:0,name:"9px"},{index:1,name:"10px"},{index:2,name:"11px"},{index:3,name:"12px"},{index:4,name:"13px"},{index:5,name:"14px"},{index:6,name:"15px"},{index:6,name:"16px"}],fields:{text:"name"},popupHeight:"200px",value:o,width:this.parent.isAdaptive?"100%":"120px",change:function(t){i.newFormat[e].style.fontSize=t.value.toString(),document.querySelector("#"+i.parentID+"valuepreview"+e).style.fontSize=t.value}}),this.fontSizeDropDown[e].appendTo("#"+this.parentID+"fontsizeinput"+e)},e.prototype.renderColorPicker=function(e){var i=this,r=this.newFormat[e],a=t.isNullOrUndefined(r.style.color)?"black":r.style.color,n=this.isHex(a.substr(1))?a:this.colourNameToHex(a);document.querySelector("#"+this.parentID+"valuepreview"+e).style.color=n,this.fontColor[e]=new s.ColorPicker({cssClass:ct,value:n,mode:"Palette",change:function(t){i.newFormat[e].style.color=t.currentValue.hex,document.querySelector("#"+i.parentID+"valuepreview"+e).style.color=t.currentValue.hex}}),this.fontColor[e].appendTo("#"+this.parentID+"fontcolor"+e),t.addClass([this.fontColor[e].element.nextElementSibling.querySelector(".e-selected-color")],H),a=t.isNullOrUndefined(r.style.backgroundColor)?"white":r.style.backgroundColor,n=this.isHex(a.substr(1))?a:this.colourNameToHex(a),document.querySelector("#"+this.parentID+"valuepreview"+e).style.backgroundColor=n,document.querySelector("#"+this.parentID+"valuepreview"+e).style.fontFamily=r.style.fontFamily,document.querySelector("#"+this.parentID+"valuepreview"+e).style.fontSize=r.style.fontSize,this.backgroundColor[e]=new s.ColorPicker({cssClass:ct,value:n,mode:"Palette",change:function(t){i.newFormat[e].style.backgroundColor=t.currentValue.hex,document.querySelector("#"+i.parentID+"valuepreview"+e).style.backgroundColor=t.currentValue.hex}}),this.backgroundColor[e].appendTo("#"+this.parentID+"backgroundcolor"+e),t.addClass([this.backgroundColor[e].element.nextElementSibling.querySelector(".e-selected-color")],H);var o=new h.Button({iconCss:H+" e-format-delete-icon",cssClass:et});o.appendTo("#"+this.parentID+"removeButton"+e),o.element.onclick=function(){i.newFormat.splice(e,1),i.addFormat()}},e.prototype.isHex=function(e){for(var t=parseInt(e,16);"0"===e.charAt(0);)e=e.substr(1);return t.toString(16)===e.toLowerCase()||0===t&&""===e},e.prototype.hexToRgb=function(e){var t=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(e);return t?{r:parseInt(t[1],16),g:parseInt(t[2],16),b:parseInt(t[3],16)}:null},e.prototype.colourNameToHex=function(e){var t={aliceblue:"#f0f8ff",antiquewhite:"#faebd7",aqua:"#00ffff",aquamarine:"#7fffd4",azure:"#f0ffff",beige:"#f5f5dc",bisque:"#ffe4c4",black:"#000000",blanchedalmond:"#ffebcd",blue:"#0000ff",blueviolet:"#8a2be2",brown:"#a52a2a",burlywood:"#deb887",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",cornflowerblue:"#6495ed",cornsilk:"#fff8dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkgray:"#a9a9a9",darkgreen:"#006400",darkkhaki:"#bdb76b",darkmagenta:"#8b008b",darkolivegreen:"#556b2f",darkorange:"#ff8c00",darkorchid:"#9932cc",darkred:"#8b0000",darksalmon:"#e9967a",darkseagreen:"#8fbc8f",darkslateblue:"#483d8b",darkslategray:"#2f4f4f",darkturquoise:"#00ced1",darkviolet:"#9400d3",deeppink:"#ff1493",deepskyblue:"#00bfff",dimgray:"#696969",dodgerblue:"#1e90ff",firebrick:"#b22222",floralwhite:"#fffaf0",forestgreen:"#228b22",fuchsia:"#ff00ff",gainsboro:"#dcdcdc",ghostwhite:"#f8f8ff",gold:"#ffd700",goldenrod:"#daa520",gray:"#808080",green:"#008000",greenyellow:"#adff2f",honeydew:"#f0fff0",hotpink:"#ff69b4","indianred ":"#cd5c5c",indigo:"#4b0082",ivory:"#fffff0",khaki:"#f0e68c",lavender:"#e6e6fa",lavenderblush:"#fff0f5",lawngreen:"#7cfc00",lemonchiffon:"#fffacd",lightblue:"#add8e6",lightcoral:"#f08080",lightcyan:"#e0ffff",lightgoldenrodyellow:"#fafad2",lightgrey:"#d3d3d3",lightgreen:"#90ee90",lightpink:"#ffb6c1",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",lightskyblue:"#87cefa",lightslategray:"#778899",lightsteelblue:"#b0c4de",lightyellow:"#ffffe0",lime:"#00ff00",limegreen:"#32cd32",linen:"#faf0e6",magenta:"#ff00ff",maroon:"#800000",mediumaquamarine:"#66cdaa",mediumblue:"#0000cd",mediumorchid:"#ba55d3",mediumpurple:"#9370d8",mediumseagreen:"#3cb371",mediumslateblue:"#7b68ee",mediumspringgreen:"#00fa9a",mediumturquoise:"#48d1cc",mediumvioletred:"#c71585",midnightblue:"#191970",mintcream:"#f5fffa",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",navajowhite:"#ffdead",navy:"#000080",oldlace:"#fdf5e6",olive:"#808000",olivedrab:"#6b8e23",orange:"#ffa500",orangered:"#ff4500",orchid:"#da70d6",palegoldenrod:"#eee8aa",palegreen:"#98fb98",paleturquoise:"#afeeee",palevioletred:"#d87093",papayawhip:"#ffefd5",peachpuff:"#ffdab9",peru:"#cd853f",pink:"#ffc0cb",plum:"#dda0dd",powderblue:"#b0e0e6",purple:"#800080",rebeccapurple:"#663399",red:"#ff0000",rosybrown:"#bc8f8f",royalblue:"#4169e1",saddlebrown:"#8b4513",salmon:"#fa8072",sandybrown:"#f4a460",seagreen:"#2e8b57",seashell:"#fff5ee",sienna:"#a0522d",silver:"#c0c0c0",skyblue:"#87ceeb",slateblue:"#6a5acd",slategray:"#708090",snow:"#fffafa",springgreen:"#00ff7f",steelblue:"#4682b4",tan:"#d2b48c",teal:"#008080",thistle:"#d8bfd8",tomato:"#ff6347",turquoise:"#40e0d0",violet:"#ee82ee",wheat:"#f5deb3",white:"#ffffff",whitesmoke:"#f5f5f5",yellow:"#ffff00",yellowgreen:"#9acd32"};return void 0!==t[e.toLowerCase()]?t[e.toLowerCase()]:"#d5d5d5"},e.prototype.showConditionalFormattingDialog=function(){this.newFormat=[];for(var e=0;e<this.parent.dataSource.conditionalFormatSettings.length;e++)this.newFormat.push(t.extend({},this.parent.dataSource.conditionalFormatSettings[e].properties,null,!0));this.createDialog(),this.dialog.refresh(),this.addFormat()},e.prototype.destroy=function(){if(this.dialog&&!this.dialog.isDestroyed){this.dialog.hide();for(var e=0;e<this.newFormat.length;e++)this.fontColor[e]&&!this.fontColor[e].isDestroyed&&this.fontColor[e].destroy(),this.backgroundColor[e]&&!this.backgroundColor[e].isDestroyed&&this.backgroundColor[e].destroy();this.dialog.destroy()}},e}();e.GroupingBarSettings=zt,e.CellEditSettings=_t,e.ConditionalSettings=Wt,e.HyperlinkSettings=Qt,e.PivotView=Yt,e.Render=Ct,e.ExcelExport=kt,e.PDFExport=jt,e.KeyboardInteraction=qt,e.VirtualScroll=Rt,e.DrillThrough=Bt,e.PivotFieldList=hi,e.TreeViewRenderer=ri,e.AxisFieldRenderer=li,e.AxisTableRenderer=ai,e.DialogRenderer=ii,e.EventBase=Kt,e.NodeStateModified=Zt,e.DataSourceUpdate=$t,e.FieldList=yi,e.CommonKeyboardInteraction=Xt,e.GroupingBar=Ci,e.CalculatedField=fi,e.ConditionalFormatting=wi,e.PivotCommon=ti,e.load="load",e.enginePopulating=m,e.enginePopulated=g,e.onFieldDropped=v,e.beforePivotTableRender="beforePivotTableRender",e.afterPivotTableRender="afterPivotTableRender",e.beforeExport=f,e.excelHeaderQueryCellInfo=y,e.pdfHeaderQueryCellInfo=b,e.excelQueryCellInfo=S,e.pdfQueryCellInfo=C,e.dataBound=w,e.queryCellInfo=x,e.headerCellInfo=D,e.hyperlinkCellClick=T,e.resizing="resizing",e.resizeStop="resizeStop",e.cellClick="cellClick",e.drillThrough="drillThrough",e.beforeColumnsRender=E,e.selected="selected",e.cellSelected="cellSelected",e.cellDeselected=M,e.rowSelected="rowSelected",e.rowDeselected=P,e.initialLoad=O,e.uiUpdate=L,e.scroll="scroll",e.contentReady=F,e.dataReady=A,e.initSubComponent=N,e.treeViewUpdate=I,e.pivotButtonUpdate=k,e.initCalculatedField=j,e.click="click",e.ErrorDialog=Jt,e.FilterDialog=ei,e.PivotContextMenu=Vt,e.AggregateMenu=ni,e.PivotEngine=c,e.PivotUtil=u,Object.defineProperty(e,"__esModule",{value:!0})});
//# sourceMappingURL=ej2-pivotview.umd.min.js.map
