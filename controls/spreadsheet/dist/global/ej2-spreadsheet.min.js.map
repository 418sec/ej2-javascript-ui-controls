{"version":3,"file":"ej2-spreadsheet.min.js","sources":["../../src/workbook/common/address.js","../../src/workbook/common/worker.js","../../src/workbook/common/math.js","../../src/workbook/integrations/number-format.js","../../src/calculate/common/common.js","../../src/calculate/common/module.js","../../src/calculate/common/module-loader.js","../../src/calculate/base/calculate.js","../../src/workbook/common/module.js","../../src/workbook/common/util.js","../../src/workbook/base/cell.js","../../src/workbook/base/row.js","../../src/workbook/base/column.js","../../src/workbook/base/data.js","../../src/workbook/base/sheet.js","../../src/spreadsheet/common/module.js","../../src/spreadsheet/common/util.js","../../src/workbook/common/event.js","../../src/workbook/integrations/data-bind.js","../../src/spreadsheet/common/event.js","../../src/workbook/integrations/open.js","../../src/workbook/workers/save-worker.js","../../src/workbook/integrations/save.js","../../src/calculate/common/enum.js","../../src/calculate/formulas/basic.js","../../src/calculate/base/parser.js","../../src/workbook/integrations/formula.js","../../src/workbook/integrations/sort.js","../../src/workbook/integrations/filter.js","../../src/workbook/actions/cell-format.js","../../src/workbook/actions/edit.js","../../src/workbook/actions/hyperlink.js","../../src/workbook/common/basic-module.js","../../src/workbook/common/all-module.js","../../src/workbook/common/class.js","../../src/workbook/common/constant.js","../../src/workbook/services/service-locator.js","../../src/workbook/base/workbook.js","../../src/spreadsheet/actions/clipboard.js","../../src/spreadsheet/actions/edit.js","../../src/spreadsheet/actions/selection.js","../../src/spreadsheet/actions/scroll.js","../../src/spreadsheet/actions/virtual-scroll.js","../../src/spreadsheet/actions/keyboard-navigation.js","../../src/spreadsheet/actions/keyboard-shortcut.js","../../src/spreadsheet/actions/cell-format.js","../../src/spreadsheet/actions/resize.js","../../src/spreadsheet/actions/collaborative-editing.js","../../src/spreadsheet/actions/show-hide.js","../../src/spreadsheet/actions/hyperlink.js","../../src/spreadsheet/actions/undo-redo.js","../../src/ribbon/ribbon.js","../../src/spreadsheet/integrations/color-picker.js","../../src/spreadsheet/integrations/ribbon.js","../../src/spreadsheet/integrations/formula-bar.js","../../src/spreadsheet/integrations/formula.js","../../src/spreadsheet/integrations/sheet-tabs.js","../../src/spreadsheet/integrations/open.js","../../src/spreadsheet/integrations/save.js","../../src/spreadsheet/integrations/context-menu.js","../../src/spreadsheet/integrations/number-format.js","../../src/spreadsheet/integrations/sort.js","../../src/spreadsheet/integrations/filter.js","../../src/spreadsheet/common/basic-module.js","../../src/spreadsheet/common/all-module.js","../../src/spreadsheet/common/class.js","../../src/spreadsheet/common/constant.js","../../src/spreadsheet/renderer/sheet.js","../../src/spreadsheet/renderer/row.js","../../src/spreadsheet/renderer/cell.js","../../src/spreadsheet/renderer/render.js","../../src/spreadsheet/services/dialog.js","../../src/spreadsheet/services/action-events.js","../../src/spreadsheet/base/spreadsheet.js","../../src/global.js"],"sourcesContent":["import { isNullOrUndefined } from '@syncfusion/ej2-base';\n/**\n * To get range indexes.\n */\nexport function getRangeIndexes(range) {\n    var cellindexes;\n    var indexes = [];\n    range = range.indexOf(':') === -1 ? range + ':' + range : range;\n    range.split(':').forEach(function (address) {\n        cellindexes = getCellIndexes(address);\n        indexes.push(cellindexes[0]);\n        indexes.push(cellindexes[1]);\n    });\n    return indexes;\n}\n/**\n * To get single cell indexes\n */\nexport function getCellIndexes(address) {\n    return [parseInt(address.match(/\\d+/)[0], 10) - 1, getColIndex(address.match(/[A-Z]+/i)[0])];\n}\n/**\n * To get column index from text.\n * @hidden\n */\nfunction getColIndex(text) {\n    var colIdx = 0;\n    text = text.split('').reverse().join('');\n    for (var i = text.length - 1; i >= 0; i--) {\n        colIdx += (text[i].charCodeAt(0) - 64) * (Math.pow(26, i));\n    }\n    return colIdx - 1;\n}\n/**\n * To get cell address from given row and column index.\n */\nexport function getCellAddress(sRow, sCol) {\n    return getColumnHeaderText(sCol + 1) + (sRow + 1);\n}\n/**\n * To get range address from given range indexes.\n */\nexport function getRangeAddress(range) {\n    return getCellAddress(range[0], range[1]) + ':' + (!isNullOrUndefined(range[2]) ?\n        getCellAddress(range[2], range[3]) : getCellAddress(range[0], range[1]));\n}\n/**\n * To get column header cell text\n */\nexport function getColumnHeaderText(colIndex) {\n    var alphabet = 'Z';\n    if (colIndex / 26 > 1) {\n        return getColumnHeaderText((colIndex % 26 === 0) ? (colIndex / 26 - 1) : Math.floor(colIndex / 26))\n            + String.fromCharCode((colIndex % 26) === 0 ? alphabet.charCodeAt(0) : 64 + (colIndex % 26));\n    }\n    else {\n        return String.fromCharCode(64 + (colIndex));\n    }\n}\n/**\n * @hidden\n */\nexport function getIndexesFromAddress(address) {\n    return getRangeIndexes(getRangeFromAddress(address));\n}\n/**\n * @hidden\n */\nexport function getRangeFromAddress(address) {\n    return address.split('!')[1] || address;\n}\n/**\n * Given range will be swapped/arranged in increasing order.\n * @hidden\n */\nexport function getSwapRange(range) {\n    var clonedRange = range.slice();\n    if (range[0] > range[2]) {\n        swap(clonedRange, 0, 2);\n    }\n    if (range[1] > range[3]) {\n        swap(clonedRange, 1, 3);\n    }\n    return clonedRange;\n}\n/**\n * Interchange values in an array\n */\nfunction swap(range, x, y) {\n    var tmp = range[x];\n    range[x] = range[y];\n    range[y] = tmp;\n}\n/**\n * @hidden\n */\nexport function isSingleCell(range) {\n    return range[0] === range[2] && range[1] === range[3];\n}\n","/**\n * Worker task.\n */\nexport function executeTaskAsync(context, taskFn, callbackFn, data, preventCallback) {\n    return new WorkerHelper(context, taskFn, callbackFn, data, preventCallback);\n}\n/**\n * @hidden\n * The `WorkerHelper` module is used to perform multiple actions using Web Worker asynchronously.\n */\nvar WorkerHelper = /** @class */ (function () {\n    /**\n     * Constructor for WorkerHelper module in Workbook library.\n     * @private\n     */\n    function WorkerHelper(context, task, defaultListener, taskData, preventCallback) {\n        this.preventCallback = false;\n        this.context = context;\n        this.workerTask = task;\n        this.defaultListener = defaultListener;\n        this.workerData = taskData;\n        if (preventCallback) {\n            this.preventCallback = true;\n        }\n        this.initWorker();\n    }\n    /**\n     * To terminate the worker task.\n     * @private\n     */\n    WorkerHelper.prototype.terminate = function () {\n        this.worker.terminate();\n        URL.revokeObjectURL(this.workerUrl);\n    };\n    /**\n     * To initiate the worker.\n     * @private\n     */\n    WorkerHelper.prototype.initWorker = function () {\n        var taskBlob = new Blob([this.getFnCode()], { type: 'text/javascript' });\n        this.workerUrl = URL.createObjectURL(taskBlob);\n        this.worker = new Worker(this.workerUrl);\n        this.worker.onmessage = this.messageFromWorker.bind(this);\n        this.worker.onerror = this.onError.bind(this);\n        this.worker.postMessage(this.workerData);\n    };\n    /**\n     * Method for getting response from worker.\n     * @private\n     */\n    WorkerHelper.prototype.messageFromWorker = function (args) {\n        this.terminate();\n        this.defaultListener.apply(this.context, [args.data]);\n    };\n    /**\n     * Method for getting error message from worker if failed.\n     * @private\n     */\n    WorkerHelper.prototype.onError = function (args) {\n        this.terminate();\n        throw args.message || args;\n    };\n    /**\n     * Construct function code for worker.\n     * @private\n     */\n    WorkerHelper.prototype.getFnCode = function () {\n        var workerCode = '';\n        var i;\n        var keys;\n        var workerFunction = '';\n        var isHaveFunction = false;\n        if (typeof this.workerTask === 'function') {\n            if (this.workerTask.toString().indexOf('function') < 0) {\n                workerFunction = 'function ' + this.workerTask.toString();\n            }\n            else {\n                workerFunction = this.workerTask.toString();\n                isHaveFunction = true;\n            }\n            workerCode += ('self.workerTask = ' + workerFunction + '; \\n');\n        }\n        else {\n            if (typeof this.workerTask === 'object') {\n                keys = Object.keys(this.workerTask);\n                for (i = 0; i < keys.length; i++) {\n                    if (this.workerTask[keys[i]].toString().indexOf('function') < 0) {\n                        workerFunction = 'function ' + this.workerTask[keys[i]].toString();\n                    }\n                    else {\n                        workerFunction = this.workerTask[keys[i]].toString();\n                        isHaveFunction = true;\n                    }\n                    workerCode += ((i === 0 ? 'self.workerTask' : keys[i]) + '= ' + workerFunction + '; \\n');\n                }\n            }\n        }\n        workerCode += 'self.onmessage = ' + (isHaveFunction ? '' : ' function ') +\n            (this.preventCallback ? this.getMessageFn.toString() : this.getCallbackMessageFn.toString()) + '; \\n';\n        return workerCode;\n    };\n    /**\n     * Get default worker task with callback.\n     * @private\n     */\n    WorkerHelper.prototype.getCallbackMessageFn = function (args) {\n        postMessage(this.workerTask.apply(this, args.data));\n    };\n    /**\n     * Get default worker task without callback.\n     * @private\n     */\n    WorkerHelper.prototype.getMessageFn = function (args) {\n        this.workerTask.apply(this, args.data);\n    };\n    return WorkerHelper;\n}());\n","import { isNullOrUndefined, getDefaultDateObject } from '@syncfusion/ej2-base';\n/**\n * @hidden\n */\nexport function toFraction(val) {\n    var strVal = val.toString();\n    if (val === parseInt(strVal, 10)) {\n        return parseInt(strVal, 10) + '  ';\n    }\n    else {\n        var top_1 = strVal.indexOf('.') > -1 ? strVal.split('.')[1] : 0;\n        var bottom = Math.pow(10, top_1.toString().replace('-', '').length);\n        var abs = Math.abs(getGcd(top_1, bottom));\n        return (top_1 / abs) + '/' + (bottom / abs);\n    }\n}\n/**\n * @hidden\n */\nexport function getGcd(a, b) {\n    a = Number(a);\n    b = Number(b);\n    return (b) ? getGcd(b, a % b) : a;\n}\n/**\n * @hidden\n */\nexport function intToDate(val) {\n    val = Number(val);\n    val = (val > 0 && val < 1) ? (1 + val) : (val === 0) ? 1 : val;\n    if (val > 60) {\n        val -= 1; // Due to leap year issue of 1900 in MSExcel.\n    }\n    return new Date(((val - 1) * (1000 * 3600 * 24)) + new Date('01/01/1900').getTime());\n}\n/**\n * @hidden\n */\n/* tslint:disable no-any */\nexport function dateToInt(val, isTime) {\n    var startDate = new Date('01/01/1900');\n    var date = isDateTime(val) ? val : new Date(val);\n    var timeDiff = (date.getTime() - startDate.getTime());\n    var diffDays = (timeDiff / (1000 * 3600 * 24)) + 1;\n    return isTime ? diffDays + 1 : parseInt(diffDays.toString(), 10) + 2;\n}\n/**\n * @hidden\n */\nexport function isDateTime(date) {\n    return Object.prototype.toString.call(date) === '[object Date]' && !isNaN(date.valueOf());\n}\n/**\n * @hidden\n */\nexport function isNumber(val) {\n    return val - parseFloat(val) >= 0;\n}\n/**\n * @hidden\n */\nexport function toDate(text, intl) {\n    var defaultDateFormats = getDefaultDateObject();\n    var availabelDateTimeFormat = defaultDateFormats.dateTimeFormats.availableFormats;\n    var dObj = { dateObj: null, isCustom: false, type: '' };\n    if (typeof text === 'string') {\n        text = text.toUpperCase();\n    }\n    for (var _i = 0, _a = Object.keys(defaultDateFormats.dateFormats); _i < _a.length; _i++) {\n        var key = _a[_i];\n        dObj.dateObj = intl.parseDate(text, { format: defaultDateFormats.dateFormats[key], skeleton: key });\n        if (dObj.dateObj) {\n            dObj.type = 'date';\n            dObj.isCustom = false;\n            break;\n        }\n    }\n    if (isNullOrUndefined(dObj.dateObj)) {\n        for (var _b = 0, _c = Object.keys(availabelDateTimeFormat); _b < _c.length; _b++) {\n            var key = _c[_b];\n            dObj.dateObj = intl.parseDate(text, { format: availabelDateTimeFormat[key], skeleton: key });\n            if (dObj.dateObj) {\n                dObj.type = text.toString().indexOf(':') > -1 ? 'time' : 'datetime';\n                dObj.isCustom = true;\n                break;\n            }\n        }\n    }\n    if (isNullOrUndefined(dObj.dateObj)) {\n        for (var _d = 0, _e = Object.keys(defaultDateFormats.timeFormats); _d < _e.length; _d++) {\n            var key = _e[_d];\n            dObj.dateObj = intl.parseDate(text, { format: defaultDateFormats.timeFormats[key], skeleton: key });\n            if (dObj.dateObj) {\n                dObj.type = 'time';\n                dObj.isCustom = false;\n                break;\n            }\n        }\n    }\n    if (text !== '#DIV/0!' && !dObj.dateObj && new Date(text).toString() !== 'Invalid Date') {\n        dObj.dateObj = new Date(text);\n    }\n    return dObj;\n}\n","import { getRangeIndexes } from '../common/index';\nimport { getCell, getSheet, setCell, getSheetIndex } from '../base/index';\nimport { Internationalization, getNumberDependable, getNumericObject, isNullOrUndefined } from '@syncfusion/ej2-base';\nimport { isNumber, toFraction, intToDate, toDate, dateToInt } from '../common/math';\nimport { applyNumberFormatting, getFormattedCellObject, refreshCellElement, checkDateFormat, getFormattedBarText } from '../common/event';\n/**\n * Specifies number format.\n */\nvar WorkbookNumberFormat = /** @class */ (function () {\n    function WorkbookNumberFormat(parent) {\n        this.parent = parent;\n        this.localeObj = getNumericObject(this.parent.locale);\n        /* tslint:disable:no-any */\n        this.decimalSep = this.localeObj.decimal;\n        this.groupSep = this.localeObj.group;\n        this.addEventListener();\n    }\n    WorkbookNumberFormat.prototype.numberFormatting = function (args) {\n        var activeSheetTab = this.parent.activeSheetTab;\n        if (args.range && args.range.indexOf('!') > -1) {\n            activeSheetTab = getSheetIndex(this.parent, args.range.split('!')[0]) + 1;\n        }\n        var sheet = this.parent.sheets[activeSheetTab - 1];\n        var formatRange = args.range ? ((args.range.indexOf('!') > -1) ?\n            args.range.split('!')[1] : args.range) : sheet.selectedRange;\n        var selectedRange = getRangeIndexes(formatRange);\n        var cell;\n        for (var i = selectedRange[0]; i <= selectedRange[2]; i++) {\n            for (var j = selectedRange[1]; j <= selectedRange[3]; j++) {\n                setCell(i, j, sheet, { format: args.format }, true);\n                cell = getCell(i, j, sheet, true);\n                this.parent.setProperties({ 'sheets': this.parent.sheets }, true);\n                this.getFormattedCell({\n                    type: getTypeFromFormat(cell.format), value: cell.value,\n                    format: cell.format, rowIndex: i, colIndex: j,\n                    sheetIndex: activeSheetTab, cell: cell\n                });\n            }\n        }\n    };\n    /**\n     * @hidden\n     */\n    WorkbookNumberFormat.prototype.getFormattedCell = function (args) {\n        var fResult = isNullOrUndefined(args.value) ? '' : args.value;\n        var sheet = args.sheetIndex ? this.parent.sheets[args.sheetIndex - 1] : this.parent.getActiveSheet();\n        var range = getRangeIndexes(sheet.activeCell);\n        var cell = args.cell ? args.cell : getCell(range[0], range[1], sheet);\n        var rightAlign = false;\n        var currencySymbol = getNumberDependable(this.parent.locale, 'USD');\n        if (args.format === '' || args.format === 'General') {\n            cell = cell ? cell : {};\n            var dateEventArgs = {\n                value: args.value, rowIndex: range[0], colIndex: range[1], sheetIndex: this.parent.activeSheetTab,\n                updatedVal: args.value, isDate: false, isTime: false\n            };\n            this.checkDateFormat(dateEventArgs);\n            if (dateEventArgs.isDate) {\n                rightAlign = true;\n                cell.value = args.value = dateEventArgs.updatedVal;\n                cell.format = args.format = getFormatFromType('ShortDate');\n            }\n            else if (dateEventArgs.isTime) {\n                rightAlign = true;\n                cell.value = args.value = dateEventArgs.updatedVal;\n                cell.format = args.format = getFormatFromType('Time');\n            }\n        }\n        args.type = args.format ? getTypeFromFormat(args.format) : 'General';\n        var result = this.processFormats(args, fResult, rightAlign, cell);\n        if (!args.onLoad && (this.parent.getActiveSheet().id - 1 === args.sheetIndex - 1)) {\n            this.parent.notify(refreshCellElement, {\n                isRightAlign: result.rightAlign, result: result.fResult || args.value,\n                rowIndex: args.rowIndex, colIndex: args.colIndex, sheetIndex: args.sheetIndex,\n                type: args.type, curSymbol: currencySymbol, value: args.value || ''\n            });\n        }\n        if (!args.onLoad && (args.rowIndex > sheet.usedRange.rowIndex || args.colIndex > sheet.usedRange.colIndex)) {\n            this.parent.setUsedRange(args.rowIndex, args.colIndex);\n            this.parent.setProperties({ 'sheets': this.parent.sheets }, true);\n        }\n        args.formattedText = result.fResult || args.value;\n        args.isRightAlign = result.rightAlign;\n        args.curSymbol = currencySymbol;\n        return args.formattedText;\n    };\n    WorkbookNumberFormat.prototype.processFormats = function (args, fResult, isRightAlign, cell) {\n        var intl = new Internationalization();\n        var currencySymbol = getNumberDependable(this.parent.locale, 'USD');\n        var result;\n        args.format = args.format ? args.format : 'General';\n        if (fResult !== '') {\n            switch (args.type) {\n                case 'General':\n                    result = this.autoDetectGeneralFormat({\n                        args: args, currencySymbol: currencySymbol, fResult: fResult, intl: intl,\n                        isRightAlign: isRightAlign, curCode: 'USD', cell: cell\n                    });\n                    fResult = result.fResult;\n                    isRightAlign = result.isRightAlign;\n                    break;\n                case 'Number':\n                    if (isNumber(fResult)) {\n                        fResult = this.applyNumberFormat(args, intl);\n                        isRightAlign = true;\n                    }\n                    break;\n                case 'Currency':\n                    if (isNumber(fResult)) {\n                        fResult = this.currencyFormat(args, intl);\n                        isRightAlign = true;\n                    }\n                    break;\n                case 'Percentage':\n                    if (isNumber(fResult)) {\n                        fResult = this.percentageFormat(args, intl);\n                        isRightAlign = true;\n                    }\n                    break;\n                case 'Accounting':\n                    if (isNumber(fResult)) {\n                        fResult = this.accountingFormat(args, intl);\n                        isRightAlign = true;\n                    }\n                    break;\n                case 'ShortDate':\n                    fResult = this.shortDateFormat(args, intl);\n                    isRightAlign = fResult ? true : false;\n                    break;\n                case 'LongDate':\n                    fResult = this.longDateFormat(args, intl);\n                    isRightAlign = fResult ? true : false;\n                    break;\n                case 'Time':\n                    fResult = this.timeFormat(args, intl);\n                    isRightAlign = fResult ? true : false;\n                    break;\n                case 'Fraction':\n                    if (isNumber(fResult)) {\n                        fResult = this.fractionFormat(args);\n                        isRightAlign = true;\n                    }\n                    break;\n                case 'Scientific':\n                    if (isNumber(fResult)) {\n                        fResult = this.scientificFormat(args);\n                        isRightAlign = true;\n                    }\n                    break;\n                case 'Text':\n                    isRightAlign = false;\n                    break;\n            }\n        }\n        return { fResult: fResult, rightAlign: isRightAlign };\n    };\n    WorkbookNumberFormat.prototype.autoDetectGeneralFormat = function (options) {\n        if (isNumber(options.fResult)) {\n            if (options.args.format && options.args.format !== '') {\n                if (options.args.format.toString().indexOf('%') > -1) {\n                    options.fResult = this.percentageFormat(options.args, options.intl);\n                }\n                else if (options.args.format.toString().indexOf(options.currencySymbol) > -1) {\n                    options.fResult = this.currencyFormat(options.args, options.intl);\n                }\n                else {\n                    options.fResult = this.applyNumberFormat(options.args, options.intl);\n                }\n            }\n            if (options.fResult && options.fResult.toString().split(this.decimalSep)[0].length > 11) {\n                options.fResult = this.scientificFormat(options.args);\n            }\n            options.isRightAlign = true;\n        }\n        if (!isNullOrUndefined(options.fResult)) {\n            var res = options.fResult.toString();\n            if (res.indexOf('%') > -1 && res.split('%')[0] !== '' && res.split('%')[1].trim() === '' &&\n                Number(res.split('%')[0].split(this.groupSep).join('')).toString() !== 'NaN') {\n                options.args.value = Number(res.split('%')[0].split(this.groupSep).join(''));\n                options.cell.format = options.args.format = getFormatFromType('Percentage');\n                options.fResult = this.percentageFormat(options.args, options.intl);\n                options.cell.value = options.args.value.toString();\n                options.isRightAlign = true;\n            }\n            else if (res.indexOf(options.currencySymbol) > -1 && res.split(options.currencySymbol)[1] !== '' &&\n                Number(res.split(options.currencySymbol)[1].split(this.groupSep).join('')).toString() !== 'NaN') {\n                options.args.value = Number(res.split(options.currencySymbol)[1].split(this.groupSep).join(''));\n                options.cell.format = options.args.format = getFormatFromType('Currency');\n                options.fResult = this.currencyFormat(options.args, options.intl);\n                options.cell.value = options.args.value.toString();\n                options.isRightAlign = true;\n            }\n            this.parent.setProperties({ 'sheets': this.parent.sheets }, true);\n        }\n        return { isRightAlign: options.isRightAlign, fResult: options.fResult };\n    };\n    WorkbookNumberFormat.prototype.findSuffix = function (zeros, resultSuffix) {\n        var len = zeros.length;\n        var suffixLen = len - resultSuffix.length;\n        return zeros.substr(0, suffixLen < 0 ? 0 : suffixLen) + resultSuffix;\n    };\n    WorkbookNumberFormat.prototype.applyNumberFormat = function (args, intl) {\n        args.format = args.format === '' ? getFormatFromType('Number') : args.format;\n        args.format = args.format.toString().split('_)').join(' ').split('_(').join(' ').split('[Red]').join('');\n        var formatArr = args.format.toString().split(';');\n        if (Number(args.value) >= 0) {\n            args.format = formatArr[0];\n        }\n        else {\n            args.format = !isNullOrUndefined(formatArr[1]) ? formatArr[1].split('*').join(' ') : formatArr[0];\n        }\n        return intl.formatNumber(Number(args.value), {\n            format: args.format\n        });\n    };\n    WorkbookNumberFormat.prototype.currencyFormat = function (args, intl) {\n        args.format = args.format === '' ? getFormatFromType('Currency') : args.format;\n        args.format = args.format.toString().split('_(').join(' ').split('_)').join(' ').split('[Red]').join('');\n        var formatArr = args.format.toString().split(';');\n        if (Number(args.value) >= 0) {\n            args.format = formatArr[0];\n        }\n        else {\n            args.format = isNullOrUndefined(formatArr[1]) ? formatArr[0] : formatArr[1].split('*').join(' ');\n        }\n        return intl.formatNumber(Number(args.value), {\n            format: args.format,\n            currency: 'USD'\n        });\n    };\n    WorkbookNumberFormat.prototype.percentageFormat = function (args, intl) {\n        args.format = args.format === '' ? getFormatFromType('Percentage') : args.format;\n        return intl.formatNumber(Number(args.value), {\n            format: args.format\n        });\n    };\n    WorkbookNumberFormat.prototype.accountingFormat = function (args, intl) {\n        args.format = args.format === '' ? getFormatFromType('Accounting') : args.format;\n        args.format = args.format.split('_(').join(' ').split('_)').join(' ').split('[Red]').join('');\n        var currencySymbol = getNumberDependable(this.parent.locale, 'USD');\n        var formatArr = args.format.split(';');\n        if (Number(args.value) >= 0) {\n            args.format = formatArr[0];\n        }\n        else {\n            args.format = formatArr[1].split('*').join(' ');\n        }\n        if (Number(args.value) === 0) {\n            return currencySymbol + '- ';\n        }\n        else {\n            return intl.formatNumber(Number(args.value), {\n                format: args.format,\n                currency: 'USD'\n            }).split('-').join('');\n        }\n    };\n    WorkbookNumberFormat.prototype.shortDateFormat = function (args, intl) {\n        var shortDate = intToDate(args.value);\n        var code = (args.format === '' || args.format === 'General') ? getFormatFromType('ShortDate')\n            : args.format.toString();\n        var dateObj;\n        if (code === getFormatFromType('ShortDate')) {\n            code = 'M/d/yy';\n            dateObj = {\n                type: 'date',\n                skeleton: 'yMd'\n            };\n        }\n        else {\n            dateObj = {\n                type: 'date',\n                format: code\n            };\n        }\n        return intl.formatDate(shortDate, dateObj);\n    };\n    WorkbookNumberFormat.prototype.longDateFormat = function (args, intl) {\n        var longDate = intToDate(args.value);\n        var code = (args.format === '' || args.format === 'General') ? getFormatFromType('LongDate')\n            : args.format.toString();\n        if (code === getFormatFromType('LongDate')) {\n            code = 'EEEE, MMMM d, y';\n        }\n        return intl.formatDate(longDate, {\n            type: 'date',\n            format: code\n        });\n    };\n    WorkbookNumberFormat.prototype.timeFormat = function (args, intl) {\n        if (isNullOrUndefined(args.value)) {\n            return '';\n        }\n        if (!isNullOrUndefined(args.value.toString().split(this.decimalSep)[1])) {\n            args.value = parseFloat('1' + this.decimalSep + args.value.split(this.decimalSep)[1]) || args.value;\n        }\n        var time = intToDate(args.value);\n        var code = (args.format === '' || args.format === 'General') ? getFormatFromType('Time')\n            : args.format.toString();\n        if (code === getFormatFromType('Time')) {\n            code = 'h:mm:ss a';\n        }\n        return intl.formatDate(time, {\n            type: 'time',\n            skeleton: 'medium',\n            format: code\n        });\n    };\n    WorkbookNumberFormat.prototype.scientificFormat = function (args) {\n        args.format = args.format === '' ? getFormatFromType('Scientific') : args.format;\n        var zeros = args.format.split('+')[1];\n        var prefix = this.findDecimalPlaces(args.format, 'Scientific');\n        var fResult = Number(args.value).toExponential(prefix);\n        if (fResult.indexOf('e+') > -1) {\n            fResult = fResult.split('e+')[0] + 'E+' + this.findSuffix(zeros, fResult.split('e+')[1]);\n        }\n        else if (fResult.indexOf('e-') > -1) {\n            fResult = fResult.split('e-')[0] + 'E-' + +this.findSuffix(zeros, fResult.split('e-')[1]);\n        }\n        return fResult;\n    };\n    WorkbookNumberFormat.prototype.fractionFormat = function (args) {\n        args.format = args.format === '' ? getFormatFromType('Fraction') : args.format;\n        var suffix = '';\n        var fractionResult;\n        if (args.value.toString().indexOf(this.decimalSep) > -1 && isNumber(args.value)) {\n            suffix = args.value.toString().split(this.decimalSep)[0];\n            fractionResult = toFraction(Number(args.value));\n            return (Number(suffix) === 0) ? ' ' + fractionResult : suffix + ' ' + fractionResult;\n        }\n        return suffix;\n    };\n    WorkbookNumberFormat.prototype.findDecimalPlaces = function (code, type) {\n        switch (type) {\n            case 'Scientific':\n                var eIndex = code.toUpperCase().indexOf('E');\n                var decIndex = code.indexOf(this.decimalSep);\n                if (eIndex > -1) {\n                    return code.substring(decIndex + 1, eIndex).length;\n                }\n        }\n        return 2;\n    };\n    WorkbookNumberFormat.prototype.checkDateFormat = function (args) {\n        var dateObj;\n        var intl = new Internationalization();\n        var value = !isNullOrUndefined(args.value) ? args.value.toString() : '';\n        var cell = getCell(args.rowIndex, args.colIndex, getSheet(this.parent, (args.sheetIndex || this.parent.activeSheetTab) - 1));\n        if (value && value.indexOf('/') > -1 || value.indexOf('-') > -1 || value.indexOf(':') > -1) {\n            dateObj = toDate(value, intl);\n            if (!isNullOrUndefined(dateObj.dateObj) && dateObj.dateObj.toString() !== 'Invalid Date') {\n                cell = cell ? cell : {};\n                value = dateToInt(dateObj.dateObj, value.indexOf(':') > -1).toString();\n                if (!cell.format || cell.format === '') {\n                    if (dateObj.type === 'time') {\n                        cell.format = getFormatFromType('Time');\n                    }\n                    else {\n                        cell.format = getFormatFromType('ShortDate');\n                    }\n                }\n                this.parent.setProperties({ 'sheets': this.parent.sheets }, true);\n                args.isDate = dateObj.type === 'date' || dateObj.type === 'datetime';\n                args.isTime = dateObj.type === 'time';\n                args.dateObj = dateObj.dateObj;\n            }\n        }\n        args.updatedVal = value;\n    };\n    WorkbookNumberFormat.prototype.formattedBarText = function (args) {\n        var type = getTypeFromFormat(args.cell ? args.cell.format : '');\n        var intl = new Internationalization();\n        var beforeText = args.value;\n        var date = getFormatFromType('ShortDate');\n        var time = getFormatFromType('Time');\n        switch (type) {\n            case 'ShortDate':\n            case 'LongDate':\n                args.value = this.shortDateFormat({ type: type, value: args.value, format: date }, intl);\n                break;\n            case 'Time':\n                args.value = this.shortDateFormat({ type: type, value: args.value, format: date }, intl) + ' ' +\n                    this.timeFormat({ type: type, value: args.value, format: time }, intl);\n                break;\n        }\n        if (!args.value || (args.value && args.value.toString().indexOf('null') > -1)) {\n            args.value = beforeText;\n        }\n    };\n    /**\n     * Adding event listener for number format.\n     */\n    WorkbookNumberFormat.prototype.addEventListener = function () {\n        this.parent.on(applyNumberFormatting, this.numberFormatting, this);\n        this.parent.on(getFormattedCellObject, this.getFormattedCell, this);\n        this.parent.on(checkDateFormat, this.checkDateFormat, this);\n        this.parent.on(getFormattedBarText, this.formattedBarText, this);\n    };\n    /**\n     * Removing event listener for number format.\n     */\n    WorkbookNumberFormat.prototype.removeEventListener = function () {\n        if (!this.parent.isDestroyed) {\n            this.parent.off(applyNumberFormatting, this.numberFormatting);\n            this.parent.off(getFormattedCellObject, this.getFormattedCell);\n            this.parent.off(checkDateFormat, this.checkDateFormat);\n            this.parent.off(getFormattedBarText, this.formattedBarText);\n        }\n    };\n    /**\n     * To Remove the event listeners.\n     */\n    WorkbookNumberFormat.prototype.destroy = function () {\n        this.removeEventListener();\n        this.parent = null;\n    };\n    /**\n     * Get the workbook number format module name.\n     */\n    WorkbookNumberFormat.prototype.getModuleName = function () {\n        return 'workbookNumberFormat';\n    };\n    return WorkbookNumberFormat;\n}());\nexport { WorkbookNumberFormat };\n/**\n * To Get the number built-in format code from the number format type.\n * @param {string} type - Specifies the type of the number formatting.\n */\nexport function getFormatFromType(type) {\n    var code = 'General';\n    switch (type.split(' ').join('')) {\n        case 'Number':\n            code = '0.00';\n            break;\n        case 'Currency':\n            code = '$#,##0.00';\n            break;\n        case 'Accounting':\n            code = '_($* #,##0.00_);_($* (#,##0.00);_($* \"-\"??_);_(@_)';\n            break;\n        case 'ShortDate':\n            code = 'mm-dd-yyyy';\n            break;\n        case 'LongDate':\n            code = 'dddd, mmmm dd, yyyy';\n            break;\n        case 'Time':\n            code = 'h:mm:ss AM/PM';\n            break;\n        case 'Percentage':\n            code = '0.00%';\n            break;\n        case 'Fraction':\n            code = '# ?/?';\n            break;\n        case 'Scientific':\n            code = '0.00E+00';\n            break;\n        case 'Text':\n            code = '@';\n            break;\n    }\n    return code;\n}\n/**\n * @hidden\n */\nexport function getTypeFromFormat(format) {\n    var code = 'General';\n    switch (format) {\n        case '0.00':\n            code = 'Number';\n            break;\n        case '$#,##0.00':\n        case '$#,##0_);[Red]($#,##0)':\n        case '$#,##0.00_);[Red]($#,##0.00)':\n        case '$#,##0.00_);($#,##0.00)':\n        case '$#,##0_);($#,##0)':\n            code = 'Currency';\n            break;\n        case '_($*#,##0.00_);_($*(#,##0.00);_($*\"-\"??_);_(@_)':\n        case '_($*#,##0.00_);_($* (#,##0.00);_($*\"-\"??_);_(@_)':\n        case '_($* #,##0.00_);_($* (#,##0.00);_($* \"-\"??_);_(@_)':\n            code = 'Accounting';\n            break;\n        case 'mm-dd-yyyy':\n        case 'dd-mm-yyyy':\n        case 'dd-mm-yy':\n        case 'mm-dd-yy':\n            code = 'ShortDate';\n            break;\n        case 'dddd, mmmm dd, yyyy':\n            code = 'LongDate';\n            break;\n        case 'h:mm:ss AM/PM':\n            code = 'Time';\n            break;\n        case '0.00%':\n        case '0%':\n            code = 'Percentage';\n            break;\n        case '# ?/?':\n        case '# ??/??':\n        case '# ???/???':\n            code = 'Fraction';\n            break;\n        case '0.00E+00':\n            code = 'Scientific';\n            break;\n        case '@':\n            code = 'Text';\n            break;\n    }\n    return code;\n}\n","/**\n * Represent the common codes for calculate\n */\nvar CalculateCommon = /** @class */ (function () {\n    function CalculateCommon(parent) {\n        this.parent = parent;\n    }\n    /**\n     * For internal use only - Get the module name.\n     * @private\n     */\n    CalculateCommon.prototype.getModuleName = function () {\n        return 'calc-common';\n    };\n    return CalculateCommon;\n}());\nexport { CalculateCommon };\n/**\n * To check whether the object is undefined.\n * @param {Object} value - To check the object is undefined\n * @return {boolean}\n * @private\n */\nexport function isUndefined(value) {\n    return ('undefined' === typeof value);\n}\n","/**\n * Represents the getModules function.\n * @param {Calculate} context\n */\nexport function getModules(context) {\n    var modules = [];\n    if (context.includeBasicFormulas) {\n        modules.push({\n            member: 'basic-formulas',\n            args: [context]\n        });\n    }\n    return modules;\n}\n","/**\n * Module loading operations\n */\nimport { isNullOrUndefined, isUndefined } from '@syncfusion/ej2-base';\nvar MODULE_SUFFIX = 'Module';\n/**\n * To get nameSpace value from the desired object.\n * @param {string} nameSpace - String value to the get the inner object\n * @param {any} obj - Object to get the inner object value.\n * @return {any}\n * @private\n */\nexport function getValue(nameSpace, obj) {\n    /* tslint:disable no-any */\n    var value = obj;\n    var splits = nameSpace.replace(/\\[/g, '.').replace(/\\]/g, '').split('.');\n    for (var j = 0; j < splits.length && !isUndefined(value); j++) {\n        value = value[splits[j]];\n    }\n    return value;\n}\n/**\n * To set value for the nameSpace in desired object.\n * @param {string} nameSpace - String value to get the inner object\n * @param {any} value - Value that you need to set.\n * @param {any} obj - Object to get the inner object value.\n * @return {void}\n * @private\n */\nexport function setValue(nameSpace, value, obj) {\n    var keyValues = nameSpace.replace(/\\[/g, '.').replace(/\\]/g, '').split('.');\n    var start = obj || {};\n    var fromObj = start;\n    var j;\n    var length = keyValues.length;\n    var key;\n    for (j = 0; j < length; j++) {\n        key = keyValues[j];\n        if (j + 1 === length) {\n            fromObj[key] = value === undefined ? {} : value;\n        }\n        else if (isNullOrUndefined(fromObj[key])) {\n            fromObj[key] = {};\n        }\n        fromObj = fromObj[key];\n    }\n    return start;\n}\nvar ModuleLoader = /** @class */ (function () {\n    function ModuleLoader(parent) {\n        this.loadedModules = [];\n        this.parent = parent;\n    }\n    ;\n    /**\n     * Inject required modules in component library\n     * @hidden\n     */\n    ModuleLoader.prototype.inject = function (requiredModules, moduleList) {\n        var reqLengthVal = requiredModules.length;\n        if (reqLengthVal === 0) {\n            this.clean();\n            return;\n        }\n        if (this.loadedModules.length) {\n            this.clearUnusedModule(requiredModules);\n        }\n        for (var i = 0; i < reqLengthVal; i++) {\n            var modl = requiredModules[i];\n            for (var _i = 0, moduleList_1 = moduleList; _i < moduleList_1.length; _i++) {\n                var module = moduleList_1[_i];\n                var modName = modl.member;\n                if (module.prototype.getModuleName() === modl.member && !this.isModuleLoaded(modName)) {\n                    var moduleObject = this.createInstance(module, modl.args);\n                    var memberName = this.getMemberName(modName);\n                    if (modl.isProperty) {\n                        setValue(memberName, module, this.parent);\n                    }\n                    else {\n                        setValue(memberName, moduleObject, this.parent);\n                    }\n                    var loadedModule = modl;\n                    loadedModule.member = memberName;\n                    this.loadedModules.push(loadedModule);\n                }\n            }\n        }\n    };\n    /**\n     * Create Instance from constructor function with desired parameters.\n     * @param {Function} classFunction - Class function to which need to create instance\n     * @param {any[]} params - Parameters need to passed while creating instance\n     * @return {any}\n     * @private\n     */\n    ModuleLoader.prototype.createInstance = function (classFunction, params) {\n        var arrayParam = params;\n        arrayParam.unshift(undefined);\n        return new (Function.prototype.bind.apply(classFunction, arrayParam));\n    };\n    /**\n     * To remove the created object while control is destroyed\n     * @hidden\n     */\n    ModuleLoader.prototype.clean = function () {\n        for (var _i = 0, _a = this.loadedModules; _i < _a.length; _i++) {\n            var modules = _a[_i];\n            if (!modules.isProperty) {\n                getValue(modules.member, this.parent).destroy();\n            }\n        }\n        this.loadedModules = [];\n    };\n    /**\n     * Removes all unused modules\n     * @param {ModuleDeclaration[]} moduleListName\n     * @returns {void}\n     */\n    ModuleLoader.prototype.clearUnusedModule = function (moduleListName) {\n        var _this = this;\n        var usedModule = moduleListName.map(function (arg) { return _this.getMemberName(arg.member); });\n        var removeModule = this.loadedModules.filter(function (module) {\n            return usedModule.indexOf(module.member) === -1;\n        });\n        for (var _i = 0, removeModule_1 = removeModule; _i < removeModule_1.length; _i++) {\n            var moduleName = removeModule_1[_i];\n            if (!moduleName.isProperty) {\n                getValue(moduleName.member, this.parent).destroy();\n            }\n            this.loadedModules.splice(this.loadedModules.indexOf(moduleName), 1);\n            this.deleteObject(this.parent, moduleName.member);\n        }\n    };\n    /**\n     * To get the name of the member.\n     * @param {string} name\n     * @returns {string}\n     */\n    ModuleLoader.prototype.getMemberName = function (name) {\n        return name[0].toLowerCase() + name.substring(1) + MODULE_SUFFIX;\n    };\n    /**\n     * Delete an item from Object\n     * @param {any} obj - Object in which we need to delete an item.\n     * @param {string} params - String value to the get the inner object\n     * @return {void}\n     * @private\n     */\n    ModuleLoader.prototype.deleteObject = function (obj, key) {\n        delete obj[key];\n    };\n    /**\n     * Returns boolean based on whether the module specified is loaded or not\n     * @param {string} modName\n     * @returns {boolean}\n     */\n    ModuleLoader.prototype.isModuleLoaded = function (modName) {\n        for (var _i = 0, _a = this.loadedModules; _i < _a.length; _i++) {\n            var mod = _a[_i];\n            if (mod.member === this.getMemberName(modName)) {\n                return true;\n            }\n        }\n        return false;\n    };\n    return ModuleLoader;\n}());\nexport { ModuleLoader };\n","var __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    }\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\n/* tslint:disable-next-line:max-line-length */\nimport { getValue, Event, NotifyPropertyChanges, Base, Property, isNullOrUndefined, isUndefined } from '@syncfusion/ej2-base';\nimport { BasicFormulas } from './../formulas/index';\nimport { getModules, ModuleLoader } from '../common/index';\nimport { CommonErrors, FormulasErrorsStrings } from '../common/enum';\nimport { Parser } from './parser';\n/**\n * Represents the calculate library.\n */\nvar Calculate = /** @class */ (function (_super) {\n    __extends(Calculate, _super);\n    /**\n     * Base constructor for creating Calculate library.\n     */\n    function Calculate(parent) {\n        var _this = _super.call(this, null, null) || this;\n        _this.lFormulas = new Map();\n        /** @hidden */\n        _this.storedData = new Map();\n        _this.keyToRowsMap = new Map();\n        _this.rowsToKeyMap = new Map();\n        /** @hidden */\n        _this.rightBracket = String.fromCharCode(161);\n        /** @hidden */\n        _this.leftBracket = String.fromCharCode(162);\n        /** @hidden */\n        _this.sheetToken = '!';\n        _this.emptyString = '';\n        _this.leftBrace = '{';\n        _this.rightBrace = '}';\n        _this.cell = _this.emptyString;\n        _this.cellPrefix = '!0!A';\n        _this.treatEmptyStringAsZero = false;\n        /** @hidden */\n        _this.tic = '\\\"';\n        /** @hidden */\n        _this.singleTic = '\\'';\n        /** @hidden */\n        _this.trueValue = 'TRUE';\n        /** @hidden */\n        _this.falseValue = 'FALSE';\n        _this.parseDecimalSeparator = '.';\n        /** @hidden */\n        _this.arithMarker = String.fromCharCode(180);\n        /** @hidden */\n        _this.arithMarker2 = _this.arithMarker + _this.arithMarker;\n        _this.dependentCells = null;\n        _this.dependentFormulaCells = null;\n        _this.minValue = Number.MIN_SAFE_INTEGER;\n        _this.maxValue = Number.MAX_SAFE_INTEGER;\n        _this.categoryCollection = ['All'];\n        _this.dependencyLevel = 0;\n        _this.refreshedCells = new Map();\n        _this.computedValues = null;\n        /** @hidden */\n        _this.randomValues = new Map();\n        /** @hidden */\n        _this.isRandomVal = false;\n        /** @hidden */\n        _this.randCollection = [];\n        /**\n         * @hidden\n         */\n        _this.formulaErrorStrings = [\n            'binary operators cannot start an expression',\n            'cannot parse',\n            'bad library',\n            'invalid char in front of',\n            'number contains 2 decimal points',\n            'expression cannot end with an operator',\n            'invalid characters following an operator',\n            'invalid character in number',\n            'mismatched parentheses',\n            'unknown formula name',\n            'requires a single argument',\n            'requires 3 arguments',\n            'invalid Math argument',\n            'requires 2 arguments',\n            '#NAME?',\n            'too complex',\n            'circular reference: ',\n            'missing formula',\n            'improper formula',\n            'invalid expression',\n            'cell empty',\n            'bad formula',\n            'empty expression',\n            '',\n            'mismatched string quotes',\n            'wrong number of arguments',\n            'invalid arguments',\n            'iterations do not converge',\n            'Control is already registered',\n            'Calculation overflow',\n            'Missing sheet',\n            'cannot_parse',\n            'expression_cannot_end_with_an_operator'\n        ];\n        _this.errorStrings = null;\n        _this.parseArgumentSeparator = ',';\n        _this.dateTime1900 = new Date(1900, 0, 1, 0, 0, 0);\n        _this.isParseDecimalSeparatorChanged = false;\n        _this.isArgumentSeparatorChanged = false;\n        _this.sheetFamilyID = 0;\n        _this.defaultFamilyItem = null;\n        _this.sheetFamiliesList = null;\n        _this.modelToSheetID = null;\n        /** @hidden */\n        _this.tokenCount = 0;\n        _this.sortedSheetNames = null;\n        _this.tempSheetPlaceHolder = String.fromCharCode(133);\n        /** @hidden */\n        _this.namedRanges = new Map();\n        _this.formulaInfoTable = null;\n        _this.oaDate = new Date(1899, 11, 30);\n        _this.millisecondsOfaDay = 24 * 60 * 60 * 1000;\n        _this.parseDateTimeSeparator = '/';\n        var moduleLoader = new ModuleLoader(_this);\n        if (_this.includeBasicFormulas) {\n            Calculate_1.Inject(BasicFormulas);\n        }\n        if (_this.injectedModules && _this.injectedModules.length) {\n            moduleLoader.inject(_this.requiredModules(), _this.injectedModules);\n        }\n        _this.parentObject = isNullOrUndefined(parent) ? _this : parent;\n        _this.grid = _this.parentObject;\n        _this.parser = new Parser(_this);\n        return _this;\n    }\n    Calculate_1 = Calculate;\n    Object.defineProperty(Calculate.prototype, \"libraryFormulas\", {\n        /* tslint:disable-next-line:no-any */\n        get: function () {\n            return this.lFormulas;\n        },\n        /* tslint:disable-next-line:no-any */\n        set: function (formulaColl) {\n            this.lFormulas.set(formulaColl.fName, { handler: formulaColl.handler, category: formulaColl.category, description: formulaColl.description });\n        },\n        enumerable: true,\n        configurable: true\n    });\n    /**\n     * To get the argument separator to split the formula arguments.\n     * @returns string\n     */\n    Calculate.prototype.getParseArgumentSeparator = function () {\n        var seperator = ',';\n        if (!this.isArgumentSeparatorChanged && seperator !== this.parseArgumentSeparator) {\n            this.parseArgumentSeparator = seperator;\n        }\n        return this.parseArgumentSeparator;\n    };\n    /**\n     * To set the argument separator to split the formula arguments.\n     * @param {string} value - Argument separator based on the culture.\n     * @returns void\n     */\n    Calculate.prototype.setParseArgumentSeparator = function (value) {\n        this.parseArgumentSeparator = value;\n        this.isArgumentSeparatorChanged = true;\n    };\n    /**\n     * To get the date separator to split the date value.\n     * @returns string\n     */\n    Calculate.prototype.getParseDateTimeSeparator = function () {\n        return this.parseDateTimeSeparator;\n    };\n    /**\n     * To set whether the empty string is treated as zero or not.\n     * @param {boolean} value\n     * @returns boolean\n     */\n    Calculate.prototype.setTreatEmptyStringAsZero = function (value) {\n        this.treatEmptyStringAsZero = value;\n    };\n    /**\n     * To get whether the empty string is treated as zero or not.\n     * @returns boolean\n     */\n    Calculate.prototype.getTreatEmptyStringAsZero = function () {\n        return this.treatEmptyStringAsZero;\n    };\n    /**\n     * To set the date separator to split the date value.\n     * @param {string} value - Argument separator based on the culture.\n     * @returns void\n     */\n    Calculate.prototype.setParseDateTimeSeparator = function (value) {\n        this.parseDateTimeSeparator = value;\n    };\n    /**\n     * To provide the array of modules needed.\n     * @hidden\n     */\n    Calculate.prototype.requiredModules = function () {\n        return getModules(this);\n    };\n    /**\n     * Dynamically injects the required modules to the library.\n     * @hidden\n     */\n    Calculate.Inject = function () {\n        var moduleList = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            moduleList[_i] = arguments[_i];\n        }\n        if (!this.prototype.injectedModules) {\n            this.prototype.injectedModules = [];\n        }\n        for (var j = 0; j < moduleList.length; j++) {\n            if (this.prototype.injectedModules.indexOf(moduleList[j]) === -1) {\n                this.prototype.injectedModules.push(moduleList[j]);\n            }\n        }\n    };\n    /**\n     * Get injected modules\n     * @hidden\n     */\n    Calculate.prototype.getInjectedModules = function () {\n        return this.injectedModules;\n    };\n    Calculate.prototype.onPropertyChanged = function (newProp, oldProp) {\n        /** code snippets */\n    };\n    Calculate.prototype.getModuleName = function () {\n        return 'calculate';\n    };\n    /** @hidden */\n    Calculate.prototype.getFormulaCharacter = function () {\n        return '=';\n    };\n    /** @hidden */\n    Calculate.prototype.isUpperChar = function (text) {\n        var charCode = text.charCodeAt(0);\n        return ((charCode > 64) && (charCode < 91));\n    };\n    Calculate.prototype.resetKeys = function () {\n        this.storedData.clear();\n        this.keyToRowsMap.clear();\n        this.rowsToKeyMap.clear();\n    };\n    /**\n     * @hidden\n     */\n    Calculate.prototype.updateDependentCell = function (cellRef) {\n        var family = this.getSheetFamilyItem(this.grid);\n        var cell = this.cell;\n        if (family.sheetNameToParentObject !== null) {\n            var token = family.parentObjectToToken.get(this.grid);\n            if (cell.indexOf(this.sheetToken) === -1) {\n                cell = token + cell;\n            }\n            if (cellRef.indexOf(this.sheetToken) === -1) {\n                cellRef = token + cellRef;\n            }\n        }\n        if (this.getDependentCells().has(cellRef)) {\n            var formulaCells = this.getDependentCells().get(cellRef);\n            if (formulaCells.indexOf(cell) < 0) {\n                formulaCells.push(cell);\n            }\n        }\n        else {\n            this.getDependentCells().set(cellRef, [cell]);\n        }\n    };\n    /**\n     * @hidden\n     */\n    Calculate.prototype.getDependentCells = function () {\n        if (this.isSheetMember()) {\n            var family = this.getSheetFamilyItem(this.grid);\n            if (family.sheetDependentCells == null) {\n                family.sheetDependentCells = new Map();\n            }\n            return family.sheetDependentCells;\n        }\n        else {\n            if (this.dependentCells == null) {\n                this.dependentCells = new Map();\n            }\n            return this.dependentCells;\n        }\n    };\n    /**\n     * @hidden\n     */\n    Calculate.prototype.getDependentFormulaCells = function () {\n        if (this.isSheetMember()) {\n            var family = this.getSheetFamilyItem(this.grid);\n            if (family.sheetDependentFormulaCells == null) {\n                family.sheetDependentFormulaCells = new Map();\n            }\n            return family.sheetDependentFormulaCells;\n        }\n        else {\n            if (this.dependentFormulaCells == null) {\n                this.dependentFormulaCells = new Map();\n            }\n            return this.dependentFormulaCells;\n        }\n    };\n    /**\n     * To get library formulas collection.\n     * @returns Map<string, Function>\n     */\n    Calculate.prototype.getLibraryFormulas = function () {\n        return this.lFormulas;\n    };\n    /**\n     * To get library function.\n     * @param {string} libFormula - Library formula to get a corresponding function.\n     * @returns Function\n     */\n    Calculate.prototype.getFunction = function (libFormula) {\n        if (this.getLibraryFormulas().has(libFormula.toUpperCase())) {\n            return this.getLibraryFormulas().get(libFormula.toUpperCase()).handler;\n        }\n        else {\n            return null;\n        }\n    };\n    Calculate.prototype.getFormulaInfoTable = function () {\n        if (this.isSheetMember()) {\n            var family = this.getSheetFamilyItem(this.grid);\n            if (family.sheetFormulaInfotable === null) {\n                family.sheetFormulaInfotable = new Map();\n            }\n            return family.sheetFormulaInfotable;\n        }\n        else {\n            if (this.formulaInfoTable === null) {\n                this.formulaInfoTable = new Map();\n            }\n            return this.formulaInfoTable;\n        }\n    };\n    /**\n     * To get the formula text.\n     * @private\n     */\n    Calculate.prototype.getFormula = function (key) {\n        key = key.toUpperCase();\n        if (this.storedData.has(key)) {\n            return this.storedData.get(key).getFormulaText();\n        }\n        return '';\n    };\n    /**\n     * To get the formula text.\n     * @returns void\n     */\n    Calculate.prototype.getParseDecimalSeparator = function () {\n        var seperator = '.';\n        if (!this.isParseDecimalSeparatorChanged && seperator !== this.parseDecimalSeparator) {\n            this.parseDecimalSeparator = seperator;\n        }\n        return this.parseDecimalSeparator;\n    };\n    /**\n     * To get the formula text.\n     * @param {string} value - Specifies the decimal separator value.\n     * @returns void\n     */\n    Calculate.prototype.setParseDecimalSeparator = function (value) {\n        this.parseDecimalSeparator = value;\n        this.isParseDecimalSeparatorChanged = true;\n    };\n    /** @hidden */\n    Calculate.prototype.getSheetToken = function (cellRef) {\n        var i = 0;\n        var temp = this.emptyString;\n        if (i < cellRef.length && cellRef[i] === this.sheetToken) {\n            i++;\n            while (i < cellRef.length && cellRef[i] !== this.sheetToken) {\n                i++;\n            }\n            temp = cellRef.substring(0, i + 1);\n        }\n        if (i < cellRef.length) {\n            return temp;\n        }\n        throw this.formulaErrorStrings[FormulasErrorsStrings.bad_index];\n    };\n    /** @hidden */\n    Calculate.prototype.getSheetID = function (grd) {\n        var family = this.getSheetFamilyItem(grd);\n        if (family.sheetNameToParentObject != null && family.sheetNameToParentObject.size > 0) {\n            var token = family.parentObjectToToken.get(grd);\n            token = token.split(this.sheetToken).join(this.emptyString);\n            var id = this.parseFloat(token);\n            if (!this.isNaN(id)) {\n                return id;\n            }\n        }\n        return -1;\n    };\n    /** @hidden */\n    Calculate.prototype.parseFloat = function (value) {\n        return Number(value);\n    };\n    /**\n     * To get the row index of the given cell.\n     * @param {string} cell - Cell address for getting row index.\n     * @returns number\n     */\n    Calculate.prototype.rowIndex = function (cell) {\n        var i = 0;\n        var result;\n        var isLetter = false;\n        if (i < cell.length && cell[i] === this.sheetToken) {\n            i++;\n            while (i < cell.length && cell[i] !== this.sheetToken) {\n                i++;\n            }\n            i++;\n        }\n        while (i < cell.length && this.isChar(cell[i])) {\n            isLetter = true;\n            i++;\n        }\n        result = parseInt(cell.substring(i), 10);\n        if (i < cell.length && !this.isNaN(result)) {\n            return result;\n        }\n        if (isLetter) {\n            return -1;\n        }\n        throw this.formulaErrorStrings[FormulasErrorsStrings.bad_index];\n    };\n    /**\n     * To get the column index of the given cell.\n     * @param {string} cell - Cell address for getting column index.\n     * @returns number\n     */\n    Calculate.prototype.colIndex = function (cell) {\n        var j = 0;\n        var k = 0;\n        cell = cell.toUpperCase();\n        if (j < cell.length && cell[j] === this.sheetToken) {\n            j++;\n            while (j < cell.length && cell[j] !== this.sheetToken) {\n                j++;\n            }\n            j++;\n        }\n        while (j < cell.length && this.isChar(cell[j])) {\n            var charCode = cell[j].charCodeAt(0);\n            k = k * 26 + charCode - 64;\n            j++;\n        }\n        if (k === 0) {\n            return -1;\n        }\n        return k;\n    };\n    /**\n     * To get the valid error strings.\n     * @hidden\n     */\n    Calculate.prototype.getErrorStrings = function () {\n        if (this.errorStrings === null) {\n            this.errorStrings = ['#N/A', '#VALUE!', '#REF!', '#DIV/0!', '#NUM!', '#NAME?', '#NULL!'];\n        }\n        return this.errorStrings;\n    };\n    /** @hidden */\n    Calculate.prototype.substring = function (text, startIndex, length) {\n        return text.substring(startIndex, length + startIndex);\n    };\n    /** @hidden */\n    Calculate.prototype.isChar = function (c) {\n        if ((c.charCodeAt(0) >= 65 && c.charCodeAt(0) <= 90) || (c.charCodeAt(0) >= 97 && c.charCodeAt(0) <= 122)) {\n            return true;\n        }\n        return false;\n    };\n    /** @hidden */\n    Calculate.prototype.getSheetFamilyItem = function (model) {\n        if (this.sheetFamilyID === 0) {\n            if (this.defaultFamilyItem == null) {\n                this.defaultFamilyItem = new CalcSheetFamilyItem();\n            }\n            return this.defaultFamilyItem;\n        }\n        if (this.sheetFamiliesList == null) {\n            this.sheetFamiliesList = new Map();\n        }\n        var i = this.modelToSheetID.get(model);\n        if (!this.sheetFamiliesList.has(i)) {\n            this.sheetFamiliesList.set(i, new CalcSheetFamilyItem());\n        }\n        return this.sheetFamiliesList.get(i);\n    };\n    /**\n     * Register a key value pair for formula.\n     * @param {string} key - Key for formula reference .\n     * @param {string | number} value - Value for the corresponding key.\n     * @returns void\n     */\n    Calculate.prototype.setKeyValue = function (key, value) {\n        key = key.toUpperCase();\n        var str = value.toString().trim();\n        if (!this.storedData.get(key) || str.indexOf(this.leftBrace) === 0) {\n            this.storedData.set(key, new FormulaInfo());\n            this.keyToRowsMap.set(key, this.keyToRowsMap.size + 1);\n            this.rowsToKeyMap.set(this.rowsToKeyMap.size + 1, key);\n        }\n        var fInfo = this.storedData.get(key);\n        if (fInfo.getFormulaText() != null && fInfo.getFormulaText().length > 0 && fInfo.getFormulaText() !== str) {\n            var s1 = this.cellPrefix + this.keyToRowsMap.get(key).toString();\n            var formulaDependent = this.getDependentFormulaCells().get(s1);\n            if (formulaDependent != null) {\n                this.clearFormulaDependentCells(s1);\n            }\n        }\n        if (str.length > 0 && str[0] === this.getFormulaCharacter()) {\n            fInfo.setFormulaText(str);\n        }\n        else if (fInfo.getFormulaValue() !== str) {\n            fInfo.setFormulaText('');\n            fInfo.setParsedFormula('');\n            fInfo.setFormulaValue(str);\n        }\n    };\n    /**\n     * @hidden\n     */\n    Calculate.prototype.clearFormulaDependentCells = function (cell) {\n        var _this = this;\n        var dependentFormula = this.getDependentFormulaCells().get(cell);\n        if (dependentFormula != null) {\n            dependentFormula.forEach(function (value, key) {\n                var s = key;\n                var dependent = _this.getDependentCells().get(s);\n                _this.arrayRemove(dependent, cell);\n                if (dependent.length === 0) {\n                    _this.getDependentCells().delete(s);\n                }\n            });\n            this.getDependentFormulaCells().delete(cell);\n        }\n    };\n    Calculate.prototype.arrayRemove = function (array, value) {\n        var index = null;\n        while (index !== -1) {\n            index = array.indexOf(value);\n            array.splice(index, 1);\n        }\n        return array;\n    };\n    /**\n     * Register a key value pair for formula.\n     * @param {string} key - Key for getting the corresponding value.\n     * @returns string | number\n     */\n    Calculate.prototype.getKeyValue = function (key) {\n        key = key.toUpperCase();\n        if (this.storedData.has(key) !== null) {\n            var fInfo = this.storedData.get(key);\n            var fText = fInfo.getFormulaText();\n            if (fText.length > 0 && fText[0] === this.getFormulaCharacter()) {\n                this.cell = this.cellPrefix + this.keyToRowsMap.get(key).toString();\n                fText = fText.substring(1);\n                try {\n                    fInfo.setParsedFormula(this.parser.parseFormula(fText, key));\n                }\n                catch (ex) {\n                    var args = {\n                        message: ex.message, exception: ex, isForceCalculable: false,\n                        computeForceCalculate: false\n                    };\n                    this.trigger('onFailure', args);\n                    fInfo.setFormulaValue(args.message);\n                    return this.storedData.get(key).getFormulaValue();\n                }\n                try {\n                    fInfo.setFormulaValue(this.computeFormula(fInfo.getParsedFormula()));\n                }\n                catch (ex) {\n                    var args = {\n                        message: ex.message, exception: ex, isForceCalculable: false,\n                        computeForceCalculate: false\n                    };\n                    this.trigger('onFailure', args);\n                    var errorMessage = (typeof args.exception === 'string') ? args.exception : args.message;\n                    return (isNullOrUndefined(this.getErrorLine(ex)) ? '' : '#' + this.getErrorLine(ex) + ': ') + errorMessage;\n                }\n            }\n            return this.storedData.get(key).getFormulaValue();\n        }\n        else {\n            return this.emptyString;\n        }\n    };\n    Calculate.prototype.getNamedRanges = function () {\n        return this.namedRanges;\n    };\n    /**\n     * Adds a named range to the NamedRanges collection.\n     * @param {string} name - Name of the named range.\n     * @param {string} range - Range for the specified name.\n     * @param {number} sheetIndex - Defined scope for the specified name. Default - Workbook scope.\n     * @returns boolean\n     */\n    Calculate.prototype.addNamedRange = function (name, range) {\n        var sheetScopeName = name.split(this.sheetToken);\n        if (sheetScopeName.length > 1) {\n            var family = this.getSheetFamilyItem(this.grid);\n            if (!family.parentObjectToToken.get(sheetScopeName[0])) {\n                return false;\n            }\n            name = sheetScopeName[0] + this.sheetToken + sheetScopeName[1].toUpperCase();\n        }\n        else {\n            name = name.toUpperCase();\n        }\n        this.namedRanges.set(name, range);\n        return true;\n    };\n    /**\n     * Remove the specified named range form the named range collection.\n     * @param {string} name - Name of the specified named range.\n     * @returns boolean\n     */\n    Calculate.prototype.removeNamedRange = function (name) {\n        name = name.toUpperCase();\n        if (this.namedRanges.get(name) != null) {\n            this.namedRanges.delete(name);\n            return true;\n        }\n        return false;\n    };\n    /** @hidden */\n    Calculate.prototype.convertAlpha = function (col) {\n        var arrCol = [];\n        var n = 0;\n        var charText = 'A';\n        while (col > 0) {\n            col--;\n            var aCharValue = charText.charCodeAt(0);\n            arrCol[n] = String.fromCharCode(col % 26 + aCharValue);\n            col = parseInt((col / 26).toString(), 10);\n            n++;\n        }\n        return arrCol.join('');\n    };\n    /** @hidden */\n    Calculate.prototype.getCellCollection = function (cellRange) {\n        if (cellRange.indexOf(':') < 0 && !this.isCellReference(cellRange)) {\n            return cellRange.split(this.getParseArgumentSeparator());\n        }\n        var token = this.emptyString;\n        var sheetTokenIndex = cellRange.indexOf(this.sheetToken);\n        if (sheetTokenIndex > -1) {\n            var index = sheetTokenIndex;\n            var s = index + 1;\n            while (s < cellRange.length) {\n                if (cellRange[s] === this.sheetToken) {\n                    token = cellRange.substr(0, s + 1);\n                    break;\n                }\n                s++;\n            }\n        }\n        var i = cellRange.indexOf(':');\n        var row1;\n        var row2;\n        var col1;\n        var col2;\n        if (i > 0 && this.isChar(cellRange[i - 1])) {\n            var k = i - 2;\n            while (k >= 0 && this.isDigit(cellRange[k])) {\n                k--;\n            }\n        }\n        row1 = this.rowIndex(this.substring(cellRange, 0, i));\n        row2 = this.rowIndex(this.substring(cellRange, i + 1, i + cellRange.length - i - 1));\n        col1 = this.colIndex(this.substring(cellRange, 0, i));\n        col2 = this.colIndex(this.substring(cellRange, i + 1, i + cellRange.length - i - 1));\n        if (row1 > row2) {\n            i = row2;\n            row2 = row1;\n            row1 = i;\n        }\n        if (col1 > col2) {\n            i = col2;\n            col2 = col1;\n            col1 = i;\n        }\n        var cells = [];\n        var j;\n        var c = 0;\n        for (i = row1; i <= row2; i++) {\n            for (j = col1; j <= col2; j++) {\n                cells[c] = token + this.emptyString + this.convertAlpha(j) + i.toString();\n                c++;\n            }\n        }\n        return cells;\n    };\n    /**\n     * Compute the given formula.\n     * @param {string} formulaText - Specifies to compute the given formula.\n     * @returns string | number\n     */\n    Calculate.prototype.computeFormula = function (formulaText) {\n        var parsedText;\n        var lastIndexOfq;\n        var formulatResult;\n        var nestedFormula = false;\n        var fNested;\n        if (this.parser.isError) {\n            return formulaText;\n        }\n        if (!this.parser.isFormulaParsed) {\n            parsedText = this.parser.parseFormula(formulaText);\n        }\n        else {\n            parsedText = formulaText;\n        }\n        this.parser.isFormulaParsed = false;\n        try {\n            lastIndexOfq = this.findLastIndexOfq(parsedText);\n            if (lastIndexOfq > 0) {\n                nestedFormula = true;\n            }\n            if (parsedText !== this.emptyString && lastIndexOfq > -1) {\n                var i = lastIndexOfq + 1;\n                while (i > -1) {\n                    if (parsedText[i] !== this.rightBracket) {\n                        i++;\n                        continue;\n                    }\n                    var sFormula = parsedText.substring(lastIndexOfq, i + 1);\n                    var libFormula = sFormula.split(this.leftBracket)[0].split('q').join(this.emptyString);\n                    var args = sFormula.substring(sFormula.indexOf(this.leftBracket) + 1, sFormula.indexOf(this.rightBracket))\n                        .split(this.getParseArgumentSeparator());\n                    formulatResult = isNullOrUndefined(this.getFunction(libFormula)) ? this.getErrorStrings()[CommonErrors.name] : this.getFunction(libFormula).apply(void 0, args);\n                    if (nestedFormula) {\n                        fNested = this.processNestedFormula(parsedText, sFormula, formulatResult);\n                        var q = this.findLastIndexOfq(fNested);\n                        if (q === 0) {\n                            nestedFormula = false;\n                        }\n                        if (q === -1) {\n                            formulatResult = this.computeValue(fNested);\n                        }\n                        lastIndexOfq = i = q;\n                        parsedText = fNested;\n                        continue;\n                    }\n                    break;\n                }\n            }\n            else if (this.formulaErrorStrings.indexOf(parsedText) > -1) {\n                formulatResult = parsedText;\n            }\n            else if (parsedText !== this.emptyString && lastIndexOfq === -1) {\n                formulatResult = this.computeValue(parsedText);\n            }\n        }\n        catch (ex) {\n            var args = { message: ex.message, exception: ex, isForceCalculable: false, computeForceCalculate: false };\n            this.trigger('onFailure', args);\n            var errorMessage = (typeof args.exception === 'string') ? args.exception : args.message;\n            formulatResult = (isNullOrUndefined(this.getErrorLine(ex)) ? '' : '#' + this.getErrorLine(ex) + ': ') + errorMessage;\n        }\n        return formulatResult;\n    };\n    /** @hidden */\n    Calculate.prototype.computeSumIfAndAvgIf = function (range) {\n        if (isNullOrUndefined(range) || range[0] === this.emptyString || range.length === 0) {\n            return this.formulaErrorStrings[FormulasErrorsStrings.wrong_number_arguments];\n        }\n        var argArr = range;\n        var argCount = argArr.length;\n        if (argCount !== 2 && argCount !== 3 && argCount === 0) {\n            return this.formulaErrorStrings[FormulasErrorsStrings.wrong_number_arguments];\n        }\n        var rangevalue = argArr[0];\n        var criteria = argCount > 2 ? argArr[2].trim() : argArr[1].trim();\n        criteria = criteria.split(this.tic).join(this.emptyString);\n        if (criteria.length > 255) {\n            return this.getErrorStrings()[CommonErrors.value];\n        }\n        var opt = this.parser.tokenEqual;\n        if (criteria.startsWith('<=')) {\n            opt = this.parser.tokenLessEq;\n            criteria = criteria.substring(2);\n        }\n        else if (criteria.startsWith('>=')) {\n            opt = this.parser.tokenGreaterEq;\n            criteria = criteria.substring(2);\n        }\n        else if (criteria.startsWith('<>')) {\n            opt = this.parser.tokenNotEqual;\n            criteria = criteria.substring(2);\n        }\n        else if (criteria.startsWith('<')) {\n            opt = this.parser.tokenLess;\n            criteria = criteria.substring(1);\n        }\n        else if (criteria.startsWith('>')) {\n            opt = this.parser.tokenGreater;\n            criteria = criteria.substring(1);\n        }\n        else if (criteria.startsWith('=')) {\n            opt = this.parser.tokenEqual;\n            criteria = criteria.substring(1);\n        }\n        var checkCriteria = this.parseFloat(criteria);\n        var criteriaRangeArray = argCount === 2 ? rangevalue : argArr[1];\n        var sumRange = this.getCellCollection(argArr[0]);\n        var criteriaRange = this.getCellCollection(criteriaRangeArray);\n        var result = this.getComputeSumIfValue(criteriaRange, sumRange, criteria, checkCriteria, opt);\n        return [result[0], result[1]];\n    };\n    /** @hidden */\n    Calculate.prototype.computeLookup = function (range) {\n        if (range.length === 0) {\n            return this.formulaErrorStrings[FormulasErrorsStrings.wrong_number_arguments];\n        }\n        var checkCrte = [];\n        var findMaxVal = [];\n        var argArr = range;\n        var argCount = argArr.length;\n        var criterias = argArr[0].split(this.tic).join(this.emptyString);\n        var rangevalue = argArr[1];\n        var lookupRangeArray = argCount === 2 ? rangevalue : argArr[2];\n        var criteriaRange = this.getCellCollection(argArr[1]);\n        var lookupRange = this.getCellCollection(lookupRangeArray);\n        for (var i = 0; i < criteriaRange.length; i++) {\n            findMaxVal[i] = this.getValueFromArg(criteriaRange[i]).split(this.tic).join('');\n        }\n        var s = findMaxVal.toString().split(this.getParseArgumentSeparator());\n        var maxVal = this.parseFloat(s[s.sort().length - 1]);\n        var minVal = this.parseFloat(s[0]);\n        for (var j = 0; j < criteriaRange.length; j++) {\n            checkCrte[j] = this.getValueFromArg(criteriaRange[j]).split(this.tic).join('');\n            if (criterias === checkCrte[j]) {\n                return this.getValueFromArg(lookupRange[j]).split(this.tic).join('');\n            }\n            else if (this.parseFloat(criterias) === this.parseFloat(checkCrte[j])) {\n                return this.getValueFromArg(lookupRange[j]).split(this.tic).join('');\n            }\n            else if (this.parseFloat(criterias) < minVal) {\n                return this.getErrorStrings()[CommonErrors.na];\n            }\n            else if (this.parseFloat(criterias) > maxVal) {\n                var index = findMaxVal.indexOf(maxVal.toString());\n                return this.getValueFromArg(lookupRange[index]).split(this.tic).join('');\n            }\n        }\n        if (findMaxVal.indexOf(criterias) < 0) {\n            var temp = [];\n            for (var n = 0; n < s.length; n++) {\n                if (this.parseFloat(criterias) > this.parseFloat(s[n])) {\n                    temp.push(s[n]);\n                }\n            }\n            var index = findMaxVal.indexOf(temp[temp.length - 1]);\n            return this.getValueFromArg(lookupRange[index]).split(this.tic).join('');\n        }\n        return this.getErrorStrings()[CommonErrors.na];\n    };\n    Calculate.prototype.computeVLookup = function (range) {\n        var argArr = range;\n        var findMaxValue = [];\n        var lookupValue = argArr[0].split(this.tic).join('');\n        if (lookupValue.indexOf(':') > -1) {\n            return this.getErrorStrings()[CommonErrors.value];\n        }\n        if (this.isCellReference(lookupValue)) {\n            lookupValue = this.getValueFromArg(lookupValue);\n        }\n        if (argArr[1].indexOf(':') < -1) {\n            return this.getErrorStrings()[CommonErrors.na];\n        }\n        var lookupRange = [];\n        var firstCol = '';\n        var secCol = '';\n        if (this.isCellReference(argArr[1])) {\n            lookupRange = this.getCellCollection(argArr[1]);\n            if (argArr[1].indexOf(':') > -1) {\n                var index = argArr[1].indexOf(':');\n                for (var i = 0; i < index; i++) {\n                    var tempCell = this.isChar(argArr[1][i]) ? argArr[1][i] : '';\n                    firstCol = firstCol + tempCell;\n                }\n                for (var j = index; j < argArr[1].length; j++) {\n                    var tempCell2 = this.isChar(argArr[1][j]) ? argArr[1][j] : '';\n                    secCol = secCol + tempCell2;\n                }\n            }\n        }\n        var lookupCol = this.colIndex(firstCol) + this.parseFloat(argArr[2]);\n        if (lookupCol > this.colIndex(secCol)) {\n            return this.getErrorStrings()[CommonErrors.na];\n        }\n        if (lookupCol === this.colIndex(firstCol)) {\n            return this.getErrorStrings()[CommonErrors.na];\n        }\n        var lookupCell = this.convertAlpha(lookupCol);\n        argArr[3] = isNullOrUndefined(argArr[3]) ? this.trueValue : argArr[3].split(this.tic).join('');\n        var cellValue = '';\n        for (var i = 0; i < lookupRange.length; i++) {\n            findMaxValue[i] = this.getValueFromArg(lookupRange[i]).split(this.tic).join('');\n        }\n        var s = findMaxValue.toString().split(this.getParseArgumentSeparator());\n        var maxValue = this.parseFloat(s[s.sort().length - 1]);\n        var minValue = this.parseFloat(s[0]);\n        for (var j = 0; j < lookupRange.length; j++) {\n            cellValue = this.getValueFromArg(lookupRange[j]);\n            if (argArr[3].toUpperCase() === this.trueValue) {\n                if (lookupValue === cellValue) {\n                    return this.getValueFromArg(lookupCell + j).split(this.tic).join('');\n                }\n                else if (this.parseFloat(lookupValue) === this.parseFloat(cellValue)) {\n                    return this.getValueFromArg(lookupCell + j).split(this.tic).join('');\n                }\n                else if (this.parseFloat(lookupValue) < minValue) {\n                    return this.getErrorStrings()[CommonErrors.na];\n                }\n                else if (this.parseFloat(lookupValue) > maxValue) {\n                    var index = findMaxValue.indexOf(maxValue.toString());\n                    return this.getValueFromArg(lookupCell + index).split(this.tic).join('');\n                }\n            }\n            if (argArr[3] === this.falseValue) {\n                if (lookupValue === cellValue) {\n                    return this.getValueFromArg(lookupCell + j);\n                }\n            }\n        }\n        return this.getErrorStrings()[CommonErrors.na];\n    };\n    Calculate.prototype.findWildCardValue = function (lookVal, cellValue) {\n        var finalText = '';\n        if (lookVal.indexOf('?') > -1) {\n            var index = lookVal.indexOf('?');\n            var checStr1 = lookVal[index - 1];\n            var checStr2 = lookVal[index + 1];\n            if (cellValue.indexOf(checStr1) > -1 && cellValue.indexOf(checStr2) > -1) {\n                var newIndex = cellValue.indexOf(checStr1);\n                if (cellValue[newIndex] === checStr1 && cellValue[newIndex + 2] === checStr2) {\n                    finalText = lookVal;\n                }\n                else {\n                    finalText = cellValue;\n                }\n            }\n            else {\n                finalText = cellValue;\n            }\n        }\n        else if (lookVal.indexOf('*') > -1) {\n            var index = lookVal.indexOf('*');\n            var left = '';\n            var right = '';\n            var compRight = this.falseValue;\n            var compLeft = this.falseValue;\n            for (var i = index - 1; i >= 0; i--) {\n                left = left + lookVal[i];\n                compLeft = this.trueValue;\n            }\n            for (var i = index + 1; i < lookVal.length; i++) {\n                right = right + lookVal[i];\n                compRight = this.trueValue;\n            }\n            var leftVal = left === '' ? -1 : cellValue.indexOf(left.split('').reverse().join(''));\n            var rightVal = right === '' ? -1 : cellValue.indexOf(right);\n            if (leftVal > -1 || rightVal > -1) {\n                if (compLeft === this.trueValue) {\n                    finalText = (left.split('').reverse().join('') === cellValue.substr(0, left.length)) ? lookVal : cellValue;\n                }\n                else if (compRight === this.trueValue) {\n                    finalText = (right === cellValue.substring(cellValue.length - right.length, cellValue.length)) ? lookVal : cellValue;\n                }\n            }\n            else {\n                finalText = cellValue;\n            }\n        }\n        return finalText;\n    };\n    /** @hidden */\n    /* tslint:disable-next-line */\n    Calculate.prototype.getComputeSumIfValue = function (criteriaRange, sumRange, criteria, checkCriteria, op) {\n        var sum = 0;\n        var count = 0;\n        switch (op) {\n            case this.parser.tokenEqual:\n                {\n                    for (var i = 0; i < criteriaRange.length; i++) {\n                        var value = this.getValueFromArg(criteriaRange[i].split(this.tic).join(''));\n                        var val = this.parseFloat(value);\n                        if (value === criteria && val === checkCriteria) {\n                            var value1 = this.getValueFromArg(sumRange[i].split(this.tic).join(''));\n                            var val1 = this.parseFloat(value1);\n                            sum = sum + val1;\n                            count = count + 1;\n                        }\n                    }\n                }\n                break;\n            case this.parser.tokenLess:\n                {\n                    for (var i = 0; i < criteriaRange.length; i++) {\n                        var value = this.getValueFromArg(criteriaRange[i].split(this.tic).join(''));\n                        var val = this.parseFloat(value);\n                        if (val < checkCriteria) {\n                            var value1 = this.getValueFromArg(sumRange[i].split(this.tic).join(''));\n                            var val1 = this.parseFloat(value1);\n                            sum = sum + val1;\n                            count = count + 1;\n                        }\n                    }\n                }\n                break;\n            case this.parser.tokenGreater:\n                {\n                    for (var i = 0; i < criteriaRange.length; i++) {\n                        var value = this.getValueFromArg(criteriaRange[i].split(this.tic).join(''));\n                        var val = this.parseFloat(value);\n                        if (val > checkCriteria) {\n                            var value1 = this.getValueFromArg(sumRange[i].split(this.tic).join(''));\n                            var val1 = this.parseFloat(value1);\n                            sum = sum + val1;\n                            count = count + 1;\n                        }\n                    }\n                }\n                break;\n            case this.parser.tokenLessEq:\n                {\n                    for (var i = 0; i < criteriaRange.length; i++) {\n                        var value = this.getValueFromArg(criteriaRange[i].split(this.tic).join(''));\n                        var val = this.parseFloat(value);\n                        if (val <= checkCriteria) {\n                            var value1 = this.getValueFromArg(sumRange[i].split(this.tic).join(''));\n                            var val1 = this.parseFloat(value1);\n                            sum = sum + val1;\n                            count = count + 1;\n                        }\n                    }\n                }\n                break;\n            case this.parser.tokenGreaterEq:\n                {\n                    for (var i = 0; i < criteriaRange.length; i++) {\n                        var value = this.getValueFromArg(criteriaRange[i].split(this.tic).join(''));\n                        var val = this.parseFloat(value);\n                        if (val >= checkCriteria) {\n                            var value1 = this.getValueFromArg(sumRange[i].split(this.tic).join(''));\n                            var val1 = this.parseFloat(value1);\n                            sum = sum + val1;\n                            count = count + 1;\n                        }\n                    }\n                }\n                break;\n            case this.parser.tokenNotEqual:\n                {\n                    for (var i = 0; i < criteriaRange.length; i++) {\n                        var value = this.getValueFromArg(criteriaRange[i].split(this.tic).join(''));\n                        var val = this.parseFloat(value);\n                        if (value !== criteria && val !== checkCriteria) {\n                            var value1 = this.getValueFromArg(sumRange[i].split(this.tic).join(''));\n                            var val1 = this.parseFloat(value1);\n                            sum = sum + val1;\n                            count = count + 1;\n                        }\n                    }\n                }\n                break;\n        }\n        return [sum, count];\n    };\n    /** @hidden */\n    Calculate.prototype.computeAndOr = function (args, op) {\n        var result = op === 'and' ? true : false;\n        var value;\n        var parseVal;\n        if (args.length === 0) {\n            return this.formulaErrorStrings[FormulasErrorsStrings.wrong_number_arguments];\n        }\n        for (var l = 0, len = args.length; l < len; l++) {\n            if (args[l].split(this.tic).join('').trim() === this.emptyString) {\n                return this.getErrorStrings()[CommonErrors.value];\n            }\n        }\n        var ranges = args;\n        for (var i = 0; i < ranges.length; i++) {\n            if (ranges[i] === (this.tic)) {\n                return this.getErrorStrings()[CommonErrors.value];\n            }\n            if (ranges[i].indexOf(':') > -1 && this.isCellReference(ranges[i])) {\n                var cells = this.getCellCollection(ranges[i]);\n                for (var j = 0; j < cells.length; j++) {\n                    if (this.getErrorStrings().indexOf(cells[j]) > -1) {\n                        return cells[j];\n                    }\n                    else if (cells[j][0] === this.tic) {\n                        return this.getErrorStrings()[CommonErrors.name];\n                    }\n                    value = this.getValueFromArg(cells[j]);\n                    if (value === '') {\n                        value = this.trueValue;\n                    }\n                    if (this.getErrorStrings().indexOf(value) > -1) {\n                        return value;\n                    }\n                    parseVal = this.parseFloat(value);\n                }\n            }\n            else {\n                value = this.getValueFromArg(ranges[i]).split(this.tic).join('').toUpperCase();\n                if (this.getErrorStrings().indexOf(value) > -1) {\n                    return value;\n                }\n                var tempdate = Date.parse(value.split(this.tic).join(''));\n                if (!isNaN(tempdate)) {\n                    result = true;\n                }\n                else if (!(value === this.trueValue || value === this.falseValue)) {\n                    return this.getErrorStrings()[CommonErrors.value].toString();\n                }\n                parseVal = this.parseFloat(value);\n            }\n            result = op === 'and' ? (result && ((value === this.trueValue) || !(isNaN(parseVal)))) :\n                (result || ((value === this.trueValue) || !(isNaN(parseVal))));\n        }\n        return result ? this.trueValue : this.falseValue;\n    };\n    /** @hidden */\n    // To strip out the tic from the formula arguments.\n    Calculate.prototype.removeTics = function (text) {\n        if (text.length > 1 && text[0] === this.tic[0] && text[text.length - 1] === this.tic[0]) {\n            text = this.substring(text, 1, text.length - 2);\n        }\n        return text;\n    };\n    /* tslint:disable-next-line:max-func-body-length */\n    Calculate.prototype.computeValue = function (pFormula) {\n        try {\n            var stack = [];\n            var i = 0;\n            var sheet = '';\n            stack.length = 0;\n            while (i < pFormula.length) {\n                var uFound = pFormula[i] === 'u'; // for 3*-2\n                if (pFormula[i] === this.arithMarker) {\n                    i = i + 1;\n                    continue;\n                }\n                else if (this.isDigit(pFormula[i])) {\n                    var s = this.emptyString;\n                    while (i < pFormula.length && this.isDigit(pFormula[i])) {\n                        s = s + pFormula[i];\n                        i = i + 1;\n                    }\n                    stack.push(s);\n                }\n                if (pFormula[i] === this.sheetToken) {\n                    sheet = pFormula[i];\n                    i = i + 1;\n                    while (i < pFormula.length && pFormula[i] !== this.sheetToken) {\n                        sheet = sheet + pFormula[i];\n                        i = i + 1;\n                    }\n                    if (i < pFormula.length) {\n                        sheet = sheet + pFormula[i];\n                        i = i + 1;\n                    }\n                }\n                else if (this.isUpperChar(pFormula[i])) {\n                    var s = this.emptyString;\n                    var textName = '';\n                    while (i < pFormula.length && this.isUpperChar(pFormula[i])) {\n                        s = s + pFormula[i];\n                        i = i + 1;\n                    }\n                    while (i < pFormula.length && this.isDigit(pFormula[i])) {\n                        s = s + pFormula[i];\n                        i = i + 1;\n                    }\n                    s = sheet + s;\n                    textName = this.getParentObjectCellValue(s).toString();\n                    if (typeof textName === 'string' && this.getErrorStrings().indexOf(textName) > -1) {\n                        return textName;\n                    }\n                    stack.push(textName);\n                }\n                else if (pFormula[i] === 'q') {\n                    var leftIdx = pFormula.substring(i + 1).indexOf(this.leftBracket);\n                    var j = pFormula.substring(i + leftIdx + 1).indexOf(this.rightBracket);\n                    pFormula = this.substring(pFormula, i + leftIdx + 2, j - 1);\n                }\n                else if (pFormula[i] === this.tic[0]) {\n                    var s = pFormula[i].toString();\n                    i = i + 1;\n                    while (i < pFormula.length && pFormula[i] !== this.tic[0]) {\n                        s = s + pFormula[i];\n                        i = i + 1;\n                    }\n                    stack.push(s.split(this.tic).join(this.emptyString));\n                    i = i + 1;\n                }\n                else if (pFormula[i] === '%' && stack.length > 0) {\n                    var stackValue = stack[0];\n                    var value = this.parseFloat(stackValue);\n                    if (!this.isNaN(value)) {\n                        stack.pop();\n                        stack.push((value / 100).toString());\n                    }\n                    i = i + 1;\n                }\n                else if ((pFormula.substring(i)).indexOf(this.trueValue) === 0) {\n                    stack.push(this.trueValue);\n                    i += this.trueValue.length;\n                }\n                else if (pFormula.substring(i).indexOf(this.falseValue) === 0) {\n                    stack.push(this.falseValue);\n                    i += this.falseValue.length;\n                }\n                else if (pFormula[i] === this.tic[0] || pFormula[i] === '|') {\n                    var s = pFormula[i].toString();\n                    i++;\n                    while (i < pFormula.length && pFormula[i] !== this.tic[0]) {\n                        s = s + pFormula[i];\n                        i = i + 1;\n                    }\n                    stack.push(s + this.tic);\n                    i += 1;\n                }\n                else {\n                    switch (pFormula[i]) {\n                        case '#':\n                            {\n                                var errIndex = 0;\n                                if (this.getErrorStrings().indexOf(pFormula.substring(i)) > -1) {\n                                    if (pFormula.indexOf('!') === -1 || pFormula.substring(i).indexOf('!') === -1) {\n                                        errIndex = pFormula.indexOf('#N/A') > -1 ?\n                                            (pFormula.indexOf('#N/A') + 4 + i) : pFormula.indexOf('?') + 1 + i;\n                                    }\n                                    else {\n                                        errIndex = pFormula.indexOf('!') + 1 + i;\n                                    }\n                                    stack.push(this.substring(pFormula, i, errIndex - i));\n                                }\n                                else {\n                                    errIndex = i + 1;\n                                    stack.push(this.substring(pFormula, i, errIndex - i));\n                                }\n                                i = errIndex;\n                            }\n                            break;\n                        case 'n':\n                            {\n                                i = i + 1;\n                                var s = '';\n                                if (pFormula.substring(i).indexOf('Infinity') === 0) {\n                                    s = 'Infinity';\n                                    i += s.length;\n                                }\n                                else {\n                                    if (pFormula[i] === 'u' || uFound) {\n                                        s = '-';\n                                        if (!uFound) {\n                                            i = i + 1;\n                                        }\n                                        else {\n                                            uFound = false;\n                                        }\n                                    }\n                                    while (i < pFormula.length && (this.isDigit(pFormula[i]))\n                                        || pFormula[i] === this.getParseDecimalSeparator()) {\n                                        s = s + pFormula[i];\n                                        i = i + 1;\n                                    }\n                                }\n                                stack.push(s);\n                            }\n                            break;\n                        case this.parser.tokenAdd:\n                            {\n                                this.getValArithmetic(stack, 'add');\n                                i = i + 1;\n                            }\n                            break;\n                        case this.parser.tokenSubtract:\n                            {\n                                this.getValArithmetic(stack, 'sub');\n                                i = i + 1;\n                            }\n                            break;\n                        case this.parser.tokenMultiply:\n                            {\n                                this.getValArithmetic(stack, 'mul');\n                                i = i + 1;\n                            }\n                            break;\n                        case this.parser.tokenDivide:\n                            {\n                                this.getValArithmetic(stack, 'div');\n                                i = i + 1;\n                            }\n                            break;\n                        case this.parser.tokenLess:\n                            {\n                                this.processLogical(stack, 'less');\n                                i = i + 1;\n                            }\n                            break;\n                        case this.parser.tokenGreater:\n                            {\n                                this.processLogical(stack, 'greater');\n                                i = i + 1;\n                            }\n                            break;\n                        case this.parser.tokenGreaterEq:\n                            {\n                                this.processLogical(stack, 'greaterEq');\n                                i = i + 1;\n                            }\n                            break;\n                        case this.parser.tokenLessEq:\n                            {\n                                this.processLogical(stack, 'lessEq');\n                                i = i + 1;\n                            }\n                            break;\n                        case this.parser.tokenNotEqual:\n                            {\n                                this.processLogical(stack, 'notEq');\n                                i = i + 1;\n                            }\n                            break;\n                        case this.parser.tokenOr:\n                            {\n                                this.processLogical(stack, 'or');\n                                i = i + 1;\n                            }\n                            break;\n                        case this.parser.tokenAnd:\n                            {\n                                this.processLogical(stack, 'and');\n                                i = i + 1;\n                            }\n                            break;\n                        case this.parser.tokenEqual:\n                            {\n                                this.processLogical(stack, 'equal');\n                                i = i + 1;\n                            }\n                            break;\n                        default: {\n                            return this.getErrorStrings()[CommonErrors.value];\n                        }\n                    }\n                }\n            }\n            if (stack.length === 0) {\n                return this.emptyString;\n            }\n            else {\n                var s = this.emptyString;\n                var countValue = stack.length;\n                while (countValue > 0) {\n                    s = stack.pop() + s;\n                    if (s === this.emptyString && this.isCellReference(pFormula) &&\n                        this.getTreatEmptyStringAsZero()) {\n                        return '0';\n                    }\n                    countValue--;\n                }\n                return s;\n            }\n        }\n        catch (ex) {\n            if (this.getErrorStrings().indexOf(ex) > -1 || this.formulaErrorStrings.indexOf(ex) > -1) {\n                throw ex;\n            }\n            throw new FormulaError(this.formulaErrorStrings[FormulasErrorsStrings.invalid_expression]);\n        }\n    };\n    Calculate.prototype.getValArithmetic = function (stack, operator) {\n        var num1 = stack.pop();\n        num1 = num1 === this.emptyString ? '0' : num1;\n        var num = Number(num1);\n        if (isNaN(num)) {\n            throw this.getErrorStrings()[CommonErrors.value];\n        }\n        var num2 = stack.pop();\n        num2 = num2 === this.emptyString ? '0' : num2;\n        num = Number(num2);\n        if (isNaN(num)) {\n            throw this.getErrorStrings()[CommonErrors.value];\n        }\n        if (operator === 'add') {\n            stack.push((Number(num2) + Number(num1)).toString());\n        }\n        if (operator === 'sub') {\n            stack.push((Number(num2) - Number(num1)).toString());\n        }\n        if (operator === 'mul') {\n            stack.push((Number(num2) * Number(num1)).toString());\n        }\n        if (operator === 'div') {\n            if (this.isNaN(this.parseFloat(num1)) || this.isNaN(this.parseFloat(num2))) {\n                stack.push(this.getErrorStrings()[CommonErrors.value]);\n            }\n            else if (this.parseFloat(num1) === 0) {\n                stack.push(this.getErrorStrings()[CommonErrors.divzero]);\n            }\n            else {\n                stack.push((Number(num2) / Number(num1)).toString());\n            }\n        }\n    };\n    /** @hidden */\n    Calculate.prototype.processLogical = function (stack, operator) {\n        var val1;\n        var val2;\n        var value1;\n        var value2;\n        if (operator !== 'and' && operator !== 'equal') {\n            val1 = stack.pop();\n            val2 = stack.pop();\n            value1 = val1.indexOf(this.tic) > -1 ? val1 : this.parseFloat(val1);\n            value2 = val2.indexOf(this.tic) > -1 ? val2 : this.parseFloat(val2);\n        }\n        var result;\n        if (operator === 'less') {\n            if (!this.isNaN(value1) && !this.isNaN(value2)) {\n                result = (value2 < value1) ? this.trueValue : this.falseValue;\n            }\n            else {\n                result = (val2.toUpperCase().split(this.tic).join('').localeCompare(val1.toUpperCase().split(this.tic).join('')) < 0) ?\n                    this.trueValue : this.falseValue;\n            }\n        }\n        if (operator === 'greater') {\n            if (!this.isNaN(value1) && !this.isNaN(value2)) {\n                result = (value2 > value1) ? this.trueValue : this.falseValue;\n            }\n            else {\n                result = (val2.toUpperCase().split(this.tic).join('').localeCompare(val1.toUpperCase().split(this.tic).join('')) > 0) ?\n                    this.trueValue : this.falseValue;\n            }\n        }\n        if (operator === 'lessEq') {\n            if (!this.isNaN(value1) && !this.isNaN(value2)) {\n                result = (value2 <= value1) ? this.trueValue : this.falseValue;\n            }\n            else {\n                result = (val2.toUpperCase().split(this.tic).join('').localeCompare(val1.toUpperCase().split(this.tic).join('')) <= 0) ?\n                    this.trueValue : this.falseValue;\n            }\n        }\n        if (operator === 'greaterEq') {\n            if (!this.isNaN(value1) && !this.isNaN(value2)) {\n                result = (value2 >= value1) ? this.trueValue : this.falseValue;\n            }\n            else {\n                result = (val2.toUpperCase().split(this.tic).join('').localeCompare(val1.toUpperCase().split(this.tic).join('')) >= 0) ?\n                    this.trueValue : this.falseValue;\n            }\n        }\n        if (operator === 'notEq') {\n            result = (val2 !== val1) ? this.trueValue : this.falseValue;\n        }\n        if (operator === 'and') {\n            val1 = stack.pop().toString();\n            val2 = '';\n            if (stack.length > 0) {\n                val2 = stack.pop().toString();\n            }\n            result = this.emptyString + val2 + val1 + this.emptyString;\n            result = result.split(this.tic).join('');\n        }\n        if (operator === 'equal') {\n            val1 = stack.pop().toString();\n            val2 = stack.pop().toString();\n            result = val1 === val2 ? this.trueValue : this.falseValue;\n        }\n        if (operator === 'or') {\n            result = Math.pow(this.parseFloat(value2), this.parseFloat(value1)).toString();\n        }\n        stack.push(result);\n        return result;\n    };\n    /** @hidden */\n    Calculate.prototype.computeStoreCells = function (sCell) {\n        var cellValue = sCell.cellValue;\n        var cellRanges = sCell.cellRange;\n        var criterias = sCell.criteria;\n        var argArr = sCell.argArray;\n        var isCriteria = sCell.isCriteria;\n        var storeCell = sCell.storedCells;\n        var isCountIfs = sCell.isCountIfS;\n        var i = sCell.countVal;\n        var rangeLength = isCriteria === this.trueValue ? storeCell : cellValue;\n        var tempStoredCell = [];\n        for (var j = 0; j < rangeLength.length; j++) {\n            var stack = [];\n            var cellVal = this.getValueFromArg(cellValue[j]);\n            var criteria = void 0;\n            var newCell = '';\n            criteria = argArr[2].split(this.tic).join(this.emptyString);\n            isCriteria = isCountIfs === this.trueValue ? this.trueValue : isCriteria;\n            if (isCriteria === this.trueValue) {\n                var cell = '';\n                var count = 0;\n                var newCount = 0;\n                storeCell[j] = isCountIfs === this.trueValue && i === 0 ? cellValue[j] : storeCell[j];\n                cell = storeCell[j];\n                // convert the new cell ranges  for find in range with criteria.\n                while (!this.isDigit(cell[count])) {\n                    count = count + 1;\n                }\n                if (this.isCellReference(cellRanges[i]) && cellRanges[i].indexOf(':') > -1) {\n                    var k = cellRanges[i].indexOf(':');\n                    newCell = this.substring(cellRanges[i], k);\n                    while (!this.isDigit(newCell[newCount])) {\n                        newCount = newCount + 1;\n                    }\n                }\n                var cellAlpha = this.substring(cell, count);\n                var newCellAlpha = this.substring(newCell, newCount);\n                newCell = storeCell[j].split(cellAlpha).join(newCellAlpha);\n                cellVal = this.getValueFromArg(newCell);\n                criteria = isCountIfs === this.trueValue ? criterias[i].split(this.tic).join(this.emptyString) :\n                    criterias[i - 1].split(this.tic).join(this.emptyString);\n            }\n            var op = 'equal';\n            if (criteria.startsWith('<=')) {\n                op = 'lessEq';\n                criteria = criteria.substring(2);\n            }\n            else if (criteria.startsWith('>=')) {\n                op = 'greaterEq';\n                criteria = criteria.substring(2);\n            }\n            else if (criteria.startsWith('<>')) {\n                op = 'notEq';\n                criteria = criteria.substring(2);\n            }\n            else if (criteria.startsWith('<')) {\n                op = 'less';\n                criteria = criteria.substring(1);\n            }\n            else if (criteria.startsWith('>')) {\n                op = 'greater';\n                criteria = criteria.substring(1);\n            }\n            else if (criteria.startsWith('=')) {\n                op = 'equal';\n                criteria = criteria.substring(1);\n            }\n            if (criteria.indexOf('*') > -1 || criteria.indexOf('?') > -1) {\n                cellVal = this.findWildCardValue(criteria, cellVal);\n            }\n            stack.push(cellVal.toLowerCase());\n            stack.push(criteria.toLowerCase());\n            if (this.processLogical(stack, op) === this.trueValue) {\n                if (isCriteria === this.falseValue) {\n                    tempStoredCell.push(cellValue[j]);\n                }\n                else {\n                    tempStoredCell.push(newCell);\n                }\n            }\n        }\n        storeCell = tempStoredCell;\n        tempStoredCell = [];\n        return storeCell;\n    };\n    Calculate.prototype.computeIfsFormulas = function (range, isCountIfs, isAvgIfs) {\n        if (isNullOrUndefined(range) || range[0] === '' || range.length === 0) {\n            return this.formulaErrorStrings[FormulasErrorsStrings.wrong_number_arguments];\n        }\n        var argArr = range;\n        var argCount = argArr.length;\n        if (argCount < 2 || argCount > 127) {\n            return this.formulaErrorStrings[FormulasErrorsStrings.wrong_number_arguments];\n        }\n        var cellRanges = [];\n        var criterias = [];\n        var storedCell = [];\n        var storedCellLength = 0;\n        var sum = 0;\n        for (var i = 0; i < argArr.length; i++) {\n            if (argArr[i].indexOf(':') > -1 && this.isCellReference(argArr[i])) {\n                cellRanges.push(argArr[i]);\n            }\n            else {\n                criterias.push(argArr[i]);\n            }\n        }\n        cellRanges = cellRanges.toString().split(',,').join(',');\n        cellRanges = cellRanges.split(this.getParseArgumentSeparator());\n        var cellvalue;\n        var isCriteria;\n        if (isCountIfs === this.falseValue) {\n            isCriteria = this.falseValue;\n            cellvalue = this.getCellCollection(cellRanges[1]);\n            var sCell = {\n                cellValue: cellvalue, cellRange: cellRanges, criteria: criterias,\n                argArray: argArr, isCriteria: isCriteria, storedCells: storedCell, isCountIfS: isCountIfs\n            };\n            storedCell = this.computeStoreCells(sCell);\n            storedCellLength = storedCell.length;\n            if (storedCellLength === 0) {\n                return 0;\n            }\n        }\n        // Compare criteria and convert the new cell ranges.\n        var startRange;\n        startRange = isCountIfs === this.trueValue ? 0 : 2;\n        for (var i = startRange; i < cellRanges.length; i++) {\n            isCriteria = this.trueValue;\n            isCriteria = isCountIfs === this.trueValue && i === 0 ? this.falseValue : this.trueValue;\n            cellvalue = this.getCellCollection(cellRanges[i]);\n            var sCell = {\n                cellValue: cellvalue, cellRange: cellRanges, criteria: criterias,\n                argArray: argArr, isCriteria: isCriteria, storedCells: storedCell, isCountIfS: isCountIfs, countVal: i\n            };\n            storedCell = this.computeStoreCells(sCell);\n            storedCellLength = storedCell.length;\n            if (storedCellLength === 0) {\n                return 0;\n            }\n        }\n        for (var j = 0; j < storedCell.length; j++) {\n            // convert the new cell ranges  for find sum in range 0(first range)\n            var cell = '';\n            var newCell = '';\n            var count = 0;\n            var newCount = 0;\n            cell = storedCell[j];\n            while (!this.isDigit(cell[count])) {\n                count = count + 1;\n            }\n            if (this.isCellReference(cellRanges[0]) && cellRanges[0].indexOf(':') > -1) {\n                var k = cellRanges[0].indexOf(':');\n                newCell = this.substring(cellRanges[0], k);\n                while (!this.isDigit(newCell[newCount])) {\n                    newCount = newCount + 1;\n                }\n            }\n            var cellAlpha = this.substring(cell, count);\n            var newCellAlpha = this.substring(newCell, newCount);\n            cellvalue = storedCell[j].split(cellAlpha).join(newCellAlpha);\n            if (isCountIfs === this.trueValue) {\n                sum = sum + 1;\n            }\n            else {\n                var argValue = this.getValueFromArg(cellvalue);\n                sum = sum + parseFloat(argValue === '' ? '0' : argValue);\n            }\n        }\n        if (isAvgIfs === this.trueValue) {\n            sum = sum / cellvalue.length;\n        }\n        return sum;\n    };\n    Calculate.prototype.processNestedFormula = function (pText, sFormula, fResult) {\n        var lastIndexq = this.findLastIndexOfq(pText);\n        var interiorCalcFString = pText.split(sFormula).join('n' + fResult);\n        return interiorCalcFString;\n    };\n    /** @hidden */\n    Calculate.prototype.isNaN = function (value) {\n        if (value.toString() === 'NaN' || typeof value === 'string') {\n            return true;\n        }\n        return false;\n    };\n    /** @hidden */\n    Calculate.prototype.fromOADate = function (doubleNumber) {\n        var result = new Date();\n        result.setTime((doubleNumber * this.millisecondsOfaDay) + Date.parse(this.oaDate.toString()));\n        return result;\n    };\n    /** @hidden */\n    Calculate.prototype.getSerialDateFromDate = function (year, month, day) {\n        var days = 0;\n        if (year < 1900) {\n            year += 1900;\n        }\n        var isValidMonth = false;\n        while (!isValidMonth) {\n            while (month > 12) {\n                year++;\n                month -= 12;\n            }\n            isValidMonth = true;\n            var tempDay = new Date(year, month, 1, -1).getDate();\n            while (day > tempDay) {\n                tempDay = new Date(year, month, 1, -1).getDate();\n                month++;\n                day -= tempDay;\n                isValidMonth = false;\n            }\n            if (day < 1) {\n                month--;\n                tempDay = new Date(year, month, 1, -1).getDate();\n                day = tempDay - day;\n            }\n        }\n        var dateTime = Date.parse(year.toString() + this.getParseDateTimeSeparator() + month.toString() +\n            this.getParseDateTimeSeparator() + day.toString());\n        if (!this.isNaN(dateTime)) {\n            days = this.toOADate(new Date(dateTime));\n        }\n        return days;\n    };\n    /** @hidden */\n    Calculate.prototype.toOADate = function (dateTime) {\n        var result = (dateTime.getTime() - Date.parse(this.oaDate.toString())) / this.millisecondsOfaDay;\n        return result;\n    };\n    /** @hidden */\n    Calculate.prototype.calculateDate = function (date) {\n        return (this.parseFloat(date) < 10) ? '0' + date : date;\n    };\n    /** @hidden */\n    Calculate.prototype.isTextEmpty = function (s) {\n        return s === null || s === '';\n    };\n    /** @hidden */\n    Calculate.prototype.isDigit = function (text) {\n        var charCode = text.charCodeAt(0);\n        if ((charCode > 47) && (charCode < 58)) {\n            return true;\n        }\n        return false;\n    };\n    Calculate.prototype.findLastIndexOfq = function (fString) {\n        return fString.lastIndexOf('q');\n    };\n    /**\n     * To get the exact value from argument.\n     * @param {string} arg - Formula argument for getting a exact value.\n     * @returns string\n     */\n    Calculate.prototype.getValueFromArg = function (arg) {\n        arg = arg.trim();\n        var s = arg;\n        var dateTime = this.dateTime1900;\n        var pObjCVal = s;\n        if (isNullOrUndefined(s) || this.isTextEmpty(s)) {\n            return s;\n        }\n        else if (arg[0] === this.tic || arg[0] === this.singleTic) {\n            dateTime = this.isDate(arg.split(this.tic).join(''));\n            if (this.isNaN(this.parseFloat(arg.split(this.tic).join(''))) && !isNullOrUndefined(dateTime) &&\n                !this.isNaN(dateTime.getDate()) && this.dateTime1900 <= dateTime) {\n                return this.toOADate(dateTime).toString();\n            }\n            return arg;\n        }\n        else {\n            arg = arg.split('u').join('-');\n            /* tslint:disable:max-line-length */\n            if (!this.isUpperChar(s[0]) && (this.isDigit(s[0]) || s[0] === this.getParseDecimalSeparator() || s[0] === '-' || s[0] === 'n')) {\n                if (s[0] === 'n') {\n                    s = s.substring(1);\n                }\n                return s;\n            }\n        }\n        var symbolArray = ['+', '-', '/', '*', ')', ')', '{'];\n        if ((this.parser.indexOfAny(s, symbolArray) === -1 && this.isUpperChar(s[0])) || s[0] === this.sheetToken) {\n            if (s !== this.trueValue && s !== this.falseValue && this.isCellReference(s)) {\n                var f = this.getSheetFamilyItem(this.grid);\n                if (f.sheetNameToParentObject !== null && f.sheetNameToParentObject.size > 0 && s.indexOf(this.sheetToken) === -1) {\n                    var token = f.parentObjectToToken.get(this.grid);\n                    s = token + s;\n                }\n            }\n            if (s === this.cell) {\n                var dependent = this.getDependentCells().get(s);\n                if (dependent != null && dependent.indexOf(s) > -1) {\n                    this.arrayRemove(dependent, s);\n                }\n                if (!this.getDependentFormulaCells().has(this.cell)) {\n                    this.clearFormulaDependentCells(this.cell);\n                }\n                throw this.formulaErrorStrings[FormulasErrorsStrings.circular_reference] + s;\n            }\n            pObjCVal = this.getParentObjectCellValue(s);\n            this.updateDependentCell(s);\n            return pObjCVal.toString();\n        }\n        if (this.getErrorStrings().indexOf(arg) > -1) {\n            return arg;\n        }\n        return this.computeValue(pObjCVal.toString());\n    };\n    /* tslint:disable-next-line */\n    Calculate.prototype.isDate = function (date) {\n        if (typeof date === 'object' || Date.parse(date) !== null) {\n            var dateval = new Date(Date.parse(date));\n            if (dateval >= this.dateTime1900) {\n                return dateval;\n            }\n            else {\n                return null;\n            }\n        }\n        else {\n            return null;\n        }\n    };\n    Calculate.prototype.isValidCellReference = function (text) {\n        var start = 0;\n        var end = 0;\n        var j = 0;\n        var numArr = [89, 71, 69];\n        var cellTxt = this.emptyString;\n        if (this.namedRanges.has(text)) {\n            return false;\n        }\n        for (var i = 0; i < text.length; i++) {\n            if (this.isChar(text[i])) {\n                end++;\n            }\n        }\n        cellTxt = text.substring(start, end);\n        if (cellTxt.length < 4) {\n            while (j < cellTxt.length) {\n                if (!isNullOrUndefined(cellTxt[j]) && cellTxt[j].charCodeAt(0) < numArr[j]) {\n                    j++;\n                    continue;\n                }\n                else if (isNullOrUndefined(cellTxt[j]) && j > 0) {\n                    break;\n                }\n                else {\n                    return false;\n                }\n            }\n            var cellNum = this.parseFloat(text.substring(end, text.length));\n            if (cellNum < 1048576) { // Maximum number of rows in excel.\n                return true;\n            }\n        }\n        return false;\n    };\n    /** @hidden */\n    /* tslint:disable-next-line */\n    Calculate.prototype.parseDate = function (date) {\n        if (!this.isNaN(date)) {\n            if (date instanceof Date) {\n                return new Date(date);\n            }\n            var d = parseInt(date, 10);\n            if (d < 0) {\n                return this.getErrorStrings()[CommonErrors.num];\n            }\n            if (d <= 60) {\n                return new Date(this.dateTime1900.getTime() + (d - 1) * 86400000);\n            }\n            return new Date(this.dateTime1900.getTime() + (d - 2) * 86400000);\n        }\n        if (typeof date === 'string') {\n            date = new Date(date);\n            if (!this.isNaN(date)) {\n                return date;\n            }\n        }\n        return this.getErrorStrings()[CommonErrors.value];\n    };\n    /** @hidden */\n    Calculate.prototype.isCellReference = function (args) {\n        if (args === this.emptyString) {\n            return false;\n        }\n        args = args.trim();\n        args = this.setTokensForSheets(args);\n        var sheetToken1 = this.getSheetToken(args);\n        var containsBoth = false;\n        if (sheetToken1 !== '') {\n            args = args.split(sheetToken1).join(this.emptyString);\n        }\n        var isAlpha = false;\n        var isNum = false;\n        if (args.indexOf(':') !== args.lastIndexOf(':')) {\n            return false;\n        }\n        var charArray = (args.split('').join(this.getParseArgumentSeparator())).split(this.getParseArgumentSeparator());\n        for (var c = 0; c < charArray.length; c++) {\n            if (this.isChar(charArray[c])) {\n                isAlpha = true;\n            }\n            else if (this.isDigit(charArray[c])) {\n                isNum = true;\n            }\n            else if (charArray[c] === ':') {\n                if (isAlpha && isNum) {\n                    containsBoth = true;\n                }\n                isAlpha = false;\n                isNum = false;\n            }\n            else {\n                return false;\n            }\n        }\n        if (args.indexOf(':') > -1 && args.indexOf(this.tic) === -1) {\n            if (containsBoth && isAlpha && isNum) {\n                return true;\n            }\n            else if (((isAlpha && !isNum) || (!isAlpha && isNum)) && !containsBoth) {\n                return true;\n            }\n            else {\n                return false;\n            }\n        }\n        if (isAlpha && isNum && args.indexOf(this.tic) === -1) {\n            return true;\n        }\n        return false;\n    };\n    /** @hidden */\n    Calculate.prototype.setTokensForSheets = function (text) {\n        var family = this.getSheetFamilyItem(this.grid);\n        var sortedSheetNamesCollection = this.getSortedSheetNames();\n        if (sortedSheetNamesCollection != null) {\n            for (var n = 0; n < sortedSheetNamesCollection.length; n++) {\n                var token = family.sheetNameToToken.get(sortedSheetNamesCollection[n]);\n                token = token.split(this.sheetToken).join(this.tempSheetPlaceHolder);\n                var s = '\"' + sortedSheetNamesCollection[n].toUpperCase() + '\"' + this.sheetToken;\n                if (text.indexOf(s) === -1) {\n                    s = sortedSheetNamesCollection[n].toUpperCase() + this.sheetToken;\n                }\n                text = text.split('SHEET' + s).join(token);\n                s = sortedSheetNamesCollection[n].toUpperCase() + this.sheetToken;\n                text = text.split(s).join(token);\n            }\n        }\n        text = text.split(this.tempSheetPlaceHolder).join(this.sheetToken);\n        return text;\n    };\n    Calculate.prototype.getParentObjectCellValue = function (val) {\n        if (val === this.trueValue || val === this.falseValue) {\n            return val;\n        }\n        var i = val.lastIndexOf(this.sheetToken);\n        var row = 0;\n        var col = 0;\n        var grid = this.grid;\n        var family = this.getSheetFamilyItem(grid);\n        if (i > -1 && family.tokenToParentObject !== null) {\n            this.grid = family.tokenToParentObject.get(val.substring(0, i + 1));\n            row = this.rowIndex(val);\n            col = this.colIndex(val);\n        }\n        else if (i === -1) {\n            var j = 0;\n            while (j < val.length && this.isChar(val[j])) {\n                j++;\n            }\n            if (j === val.length) {\n                val = val.toLowerCase();\n                return this.getErrorStrings()[CommonErrors.name];\n            }\n            else {\n                row = this.rowIndex(val);\n                col = this.colIndex(val);\n                if (family.isSheetMember && family.parentObjectToToken != null) {\n                    val = family.parentObjectToToken.get(this.grid) + val;\n                }\n            }\n        }\n        var saveCell = (this.cell === '' || this.cell === null) ? '' : this.cell;\n        this.cell = val;\n        if (saveCell === this.cell) {\n            throw this.formulaErrorStrings[FormulasErrorsStrings.circular_reference];\n        }\n        var cValue = this.getParentCellValue(row, col, this.grid);\n        this.grid = grid;\n        this.cell = saveCell;\n        return cValue;\n    };\n    Calculate.prototype.getParentCellValue = function (row, col, grd) {\n        var alreadyComputed = false;\n        // formulainfotable\n        var cValue;\n        /* tslint:disable-next-line */\n        if (this.parentObject.getValueRowCol === undefined) {\n            cValue = this.getValueRowCol(this.getSheetID(grd) + 1, row, col);\n        }\n        else {\n            /* tslint:disable-next-line */\n            cValue = this.parentObject.getValueRowCol(this.getSheetID(grd) + 1, row, col);\n            return isNullOrUndefined(cValue) ? this.emptyString : cValue.toString();\n        }\n        if (cValue === '' || cValue === undefined) {\n            cValue = '';\n        }\n        // if (cValue[cValue.length - 1] == (\"%\") && !this.isNaN(d)) {\n        //     cValue = (Number(d) / 100).toString();\n        // }\n        return cValue;\n    };\n    /**\n     * Getting the formula result.\n     * @param {Object} grid - Specifies the parent object.\n     * @param {number} row - Row index of the parent object or key.\n     * @param {number} col - Column index of the parent object.\n     * @returns string\n     */\n    Calculate.prototype.getValueRowCol = function (grid, row, col) {\n        var key = this.rowsToKeyMap.get(row).toString();\n        var result = this.getKeyValue(key).toString();\n        if (result != null && result[result.length - 1] === ('%') && result.length > 1) {\n            var d = this.parseFloat(result.substring(0, result.length - 1));\n            if (this.isNaN(d)) {\n                result = (Number(d) / 100).toString();\n            }\n        }\n        return result;\n    };\n    /**\n     * To add custom library formula.\n     * @param {string} formulaName - Custom Formula name.\n     * @param {string} functionName - Custom function name.\n     * @returns void\n     */\n    Calculate.prototype.defineFunction = function (formulaName, functionName) {\n        if (typeof functionName === 'string') {\n            functionName = getValue(functionName, window);\n        }\n        formulaName = formulaName.toUpperCase();\n        this.libraryFormulas.set(formulaName, { handler: functionName, isCustom: true });\n    };\n    /**\n     * Specifies when changing the value.\n     * @param {string} grid - Parent object reference name.\n     * @param {ValueChangedArgs} changeArgs - Value changed arguments.\n     * @param {boolean} isCalculate - Value that allow to calculate.\n     */\n    Calculate.prototype.valueChanged = function (grid, changeArgs, isCalculate) {\n        var pgrid = grid;\n        this.grid = grid;\n        var isComputedValueChanged = true;\n        var isCompute = true;\n        var calcFamily = this.getSheetFamilyItem(pgrid);\n        var cellTxt = getAlphalabel(changeArgs.getColIndex()) + changeArgs.getRowIndex().toString();\n        if (calcFamily.sheetNameToParentObject !== null && calcFamily.sheetNameToParentObject.size > 0) {\n            var token = calcFamily.parentObjectToToken.get(pgrid);\n            cellTxt = token + cellTxt;\n        }\n        var argVal = changeArgs.getValue().toUpperCase();\n        if (argVal.indexOf('=RAND()') > -1 || argVal.indexOf('RAND()') > -1 || argVal.indexOf('=RANDBETWEEN(') > -1 ||\n            argVal.indexOf('RANDBETWEEN(') > -1 || this.randomValues.has(cellTxt)) {\n            var randStrVal = this.randCollection.toString();\n            if (!this.randomValues.has(cellTxt)) {\n                this.randomValues.set(cellTxt, changeArgs.getValue());\n                this.randCollection.push(cellTxt);\n                this.isRandomVal = true;\n            }\n            else if (this.randomValues.has(cellTxt)) {\n                if (argVal.indexOf('=RAND()') > -1 || argVal.indexOf('RAND()') > -1 || argVal.indexOf('=RANDBETWEEN(') > -1 ||\n                    argVal.indexOf('RANDBETWEEN(') > -1) {\n                    this.randomValues.set(cellTxt, changeArgs.getValue());\n                }\n                else if (changeArgs.getValue().toUpperCase() !== this.randomValues.get(cellTxt.toUpperCase())) {\n                    this.randomValues.delete(cellTxt);\n                    randStrVal = randStrVal.split(cellTxt + this.parseArgumentSeparator).join('').split(this.parseArgumentSeparator + cellTxt).join('').split(cellTxt).join('');\n                    this.randCollection = randStrVal.split(this.parseArgumentSeparator);\n                }\n                if (this.randomValues.size === 0 && this.randCollection.length) {\n                    this.isRandomVal = false;\n                    this.randomValues.clear();\n                    this.randCollection = [];\n                }\n            }\n        }\n        if (changeArgs.getValue() && changeArgs.getValue()[0] === this.getFormulaCharacter()) {\n            this.cell = cellTxt;\n            var formula = void 0;\n            if (!isNullOrUndefined(isCompute)) {\n                isCompute = isCalculate;\n            }\n            if (this.getFormulaInfoTable().has(cellTxt)) {\n                formula = this.getFormulaInfoTable().get(cellTxt);\n                if (changeArgs.getValue() !== formula.getFormulaText() || formula.getParsedFormula() == null) {\n                    formula.setFormulaText(changeArgs.getValue());\n                    if (this.getDependentFormulaCells().has(this.cell)) {\n                        this.clearFormulaDependentCells(this.cell);\n                    }\n                    try {\n                        formula.setParsedFormula(this.parser.parseFormula(changeArgs.getValue()));\n                    }\n                    catch (ex) {\n                        formula.setFormulaValue(ex);\n                        isCompute = false;\n                    }\n                }\n                if (isCompute) {\n                    this.parser.isFormulaParsed = true;\n                    var cValue = this.computeFormula(formula.getParsedFormula());\n                    isComputedValueChanged = (cValue !== formula.getFormulaValue());\n                    formula.setFormulaValue(cValue);\n                }\n            }\n            else {\n                formula = new FormulaInfo();\n                formula.setFormulaText(changeArgs.getValue());\n                if (!this.getDependentFormulaCells().has(cellTxt)) {\n                    this.getDependentFormulaCells().set(cellTxt, new Map());\n                }\n                try {\n                    formula.setParsedFormula(this.parser.parseFormula(changeArgs.getValue()));\n                }\n                catch (ex) {\n                    formula.setFormulaValue(ex);\n                    isCompute = false;\n                }\n                if (isCompute) {\n                    formula.setFormulaValue(this.computeFormula(formula.getParsedFormula()));\n                }\n                if (this.getFormulaInfoTable().has(cellTxt)) {\n                    this.getFormulaInfoTable().set(cellTxt, formula);\n                }\n                else {\n                    this.getFormulaInfoTable().set(cellTxt, formula);\n                }\n            }\n            if (isCompute) {\n                /* tslint:disable */\n                if (this.parentObject.setValueRowCol === undefined) {\n                    this.setValueRowCol(this.getSheetID(pgrid) + 1, formula.getFormulaValue(), changeArgs.getRowIndex(), changeArgs.getColIndex());\n                }\n                else {\n                    this.parentObject.setValueRowCol(this.getSheetID(pgrid) + 1, formula.getFormulaValue(), changeArgs.getRowIndex(), changeArgs.getColIndex());\n                }\n                /* tslint:enable */\n            }\n        }\n        else if (this.getFormulaInfoTable().has(cellTxt)) {\n            this.getFormulaInfoTable().delete(cellTxt);\n            if (this.getDependentFormulaCells().has(cellTxt)) {\n                this.clearFormulaDependentCells(cellTxt);\n            }\n        }\n        if (isCompute && isComputedValueChanged && this.getDependentCells().has(cellTxt) &&\n            this.getDependentCells().get(cellTxt).toString() !== cellTxt) {\n            this.getComputedValue().clear();\n            this.refresh(cellTxt);\n        }\n    };\n    /** @hidden */\n    Calculate.prototype.getComputedValue = function () {\n        if (this.computedValues === null) {\n            this.computedValues = new Map();\n        }\n        return this.computedValues;\n    };\n    /**\n     * @hidden\n     */\n    Calculate.prototype.setValueRowCol = function (value, formulaValue, row, col) {\n        /* No Implementation */\n    };\n    Calculate.prototype.getSortedSheetNames = function () {\n        var family = this.getSheetFamilyItem(this.grid);\n        if (family != null && family.sheetNameToToken != null) {\n            var arr_1 = [];\n            family.sheetNameToToken.forEach(function (value, key) {\n                arr_1.push(key);\n                arr_1.sort();\n            });\n            this.sortedSheetNames = arr_1;\n            this.sortedSheetNames.sort();\n        }\n        return this.sortedSheetNames;\n    };\n    /** @hidden */\n    Calculate.prototype.getErrorLine = function (error) {\n        /* tslint:disable-next-line */\n        var errorStack = error.stack ? error.stack.split('\\n')[1].split(':') : null;\n        return errorStack ? errorStack[errorStack.length - 2] : null; // Getting row number of the error file.\n    };\n    /** @hidden */\n    Calculate.prototype.createSheetFamilyID = function () {\n        if (this.sheetFamilyID === Number.MAX_SAFE_INTEGER) {\n            this.sheetFamilyID = Number.MIN_SAFE_INTEGER;\n        }\n        return this.sheetFamilyID++;\n    };\n    /** @hidden */\n    Calculate.prototype.computeMinMax = function (args, operation) {\n        var result;\n        var argVal;\n        var countStrVal = 0;\n        if (isNullOrUndefined(args) || args.length === 0) {\n            return this.formulaErrorStrings[FormulasErrorsStrings.wrong_number_arguments];\n        }\n        for (var k = 0, len = args.length; k < len; k++) {\n            if (args[k].split(this.tic).join('').trim() === this.emptyString) {\n                return this.getErrorStrings()[CommonErrors.value];\n            }\n        }\n        result = (operation === 'max') ? this.minValue : this.maxValue;\n        var argArr = args;\n        if (argArr.length > 255) {\n            return this.getErrorStrings()[CommonErrors.value];\n        }\n        for (var i = 0; i < argArr.length; i++) {\n            if (argArr[i].indexOf(':') > -1 && this.isCellReference(argArr[i])) {\n                var cellValue = this.getCellCollection(argArr[i]);\n                for (var j = 0; j < cellValue.length; j++) {\n                    argVal = this.getValueFromArg(cellValue[j]);\n                    if (this.getErrorStrings().indexOf(argVal) > -1) {\n                        return argVal;\n                    }\n                    var cellVal = this.parseFloat(argVal);\n                    if (argVal === '' || this.isNaN(this.parseFloat(cellVal))) {\n                        countStrVal = countStrVal + 1;\n                        if (countStrVal === cellValue.length) {\n                            result = 0;\n                        }\n                        continue;\n                    }\n                    else {\n                        result = (operation === 'max') ? Math.max(result, cellVal) : Math.min(result, cellVal);\n                    }\n                }\n            }\n            else {\n                var val = void 0;\n                val = this.getValueFromArg(argArr[i]);\n                if (this.getErrorStrings().indexOf(val) > -1) {\n                    return val;\n                }\n                var cellVal = this.parseFloat(val);\n                if (val === '' || this.isNaN(this.parseFloat(cellVal))) {\n                    countStrVal = countStrVal + 1;\n                    if (countStrVal === argVal.length) {\n                        result = 0;\n                    }\n                    continue;\n                }\n                else {\n                    result = (operation === 'max') ? Math.max(result, cellVal) : Math.min(result, cellVal);\n                }\n            }\n        }\n        return result.toString();\n    };\n    /** @hidden */\n    Calculate.prototype.calculateAvg = function (args) {\n        var sumCell = 0;\n        var argArr = args;\n        var cellVal = [];\n        var avgVal = 0;\n        var countNum = 0;\n        var countNum1 = 0;\n        for (var k = 0; k < argArr.length; k++) {\n            if (argArr[k].indexOf(':') > -1 && this.isCellReference(argArr[k])) {\n                countNum = 0;\n                cellVal = this.getCellCollection(argArr[k]);\n                avgVal = 0;\n                for (var i = 0; i < cellVal.length; i++) {\n                    var value = this.getValueFromArg(cellVal[i]);\n                    if (isNullOrUndefined(value) || isNaN(this.parseFloat(value))) {\n                        continue;\n                    }\n                    avgVal = avgVal + this.parseFloat(value);\n                    countNum = countNum + 1;\n                }\n                if (countNum === 0) {\n                    return this.getErrorStrings()[CommonErrors.divzero];\n                }\n                avgVal = avgVal / countNum;\n                sumCell = avgVal + sumCell;\n            }\n            else {\n                if (argArr[k].indexOf(this.tic) > -1) {\n                    if (isNaN(parseFloat(argArr[k].split(this.tic).join('')))) {\n                        return this.getErrorStrings()[CommonErrors.value];\n                    }\n                }\n                if (argArr[k].length === 0) {\n                    argArr[k] = '1';\n                }\n                var value = this.getValueFromArg(argArr[k].split(this.tic).join(''));\n                if (isNullOrUndefined(value) || isNaN(this.parseFloat(value))) {\n                    return this.getErrorStrings()[CommonErrors.name];\n                }\n                sumCell = sumCell + this.parseFloat(value);\n            }\n        }\n        return (sumCell / (argArr.length - countNum1)).toString();\n    };\n    /**\n     * @hidden\n     */\n    Calculate.prototype.registerGridAsSheet = function (refName, model, sheetFamilyID) {\n        if (isNullOrUndefined(this.modelToSheetID)) {\n            this.modelToSheetID = new Map();\n        }\n        if (isNullOrUndefined(this.modelToSheetID.get(model))) {\n            this.modelToSheetID.set(model, sheetFamilyID);\n        }\n        var family = this.getSheetFamilyItem(model);\n        family.isSheetMember = true;\n        var tempRef = refName.toUpperCase();\n        if (family.parentObjectToToken.size === 0) {\n            family.parentObjectToToken = new Map();\n        }\n        if (family.sheetNameToParentObject.size === 0) {\n            family.sheetNameToParentObject = new Map();\n        }\n        if (family.sheetNameToToken.size === 0) {\n            family.sheetNameToToken = new Map();\n        }\n        if (family.tokenToParentObject.size === 0) {\n            family.tokenToParentObject = new Map();\n        }\n        if (!isUndefined(family.sheetNameToParentObject.get(tempRef))) {\n            var token = family.sheetNameToToken.get(tempRef);\n            family.tokenToParentObject.set(token, model);\n            family.parentObjectToToken.set(model, token);\n        }\n        else {\n            var token = this.sheetToken + this.tokenCount.toString() + this.sheetToken;\n            this.tokenCount++;\n            family.tokenToParentObject.set(token, model);\n            family.parentObjectToToken.set(model, token);\n            family.sheetNameToToken.set(tempRef, token);\n            family.sheetNameToParentObject.set(tempRef, model);\n        }\n        return refName;\n    };\n    /**\n     * @hidden\n     */\n    Calculate.prototype.unregisterGridAsSheet = function (refName, model) {\n        var family = this.getSheetFamilyItem(model);\n        var refName1 = refName.toUpperCase();\n        if (family.sheetNameToParentObject != null && family.sheetNameToParentObject.has(refName1)) {\n            family.sheetNameToParentObject.delete(refName1);\n            var token = family.sheetNameToToken.get(refName1);\n            family.sheetNameToToken.delete(refName1);\n            family.tokenToParentObject.delete(token);\n            family.parentObjectToToken.delete(model);\n        }\n    };\n    ;\n    Calculate.prototype.isSheetMember = function () {\n        var family = this.getSheetFamilyItem(this.grid);\n        return isNullOrUndefined(family) ? false : family.isSheetMember;\n    };\n    /**\n     * To dispose the calculate engine.\n     * @returns void\n     */\n    Calculate.prototype.dispose = function () {\n        this.resetKeys();\n        // this.dependentCells.clear();\n        // this.dependentFormulaCells.clear();\n        this.namedRanges.clear();\n        // this.sheetFamiliesList.clear();\n        this.lFormulas.clear();\n    };\n    Calculate.prototype.refreshRandValues = function (cellRef) {\n        var rowIdx;\n        var colIdx;\n        var value;\n        var tokenRef = '';\n        var stringCollection = this.randCollection.toString();\n        var family;\n        if (this.randomValues.has(cellRef)) {\n            this.randomValues.delete(cellRef);\n            stringCollection = stringCollection.split(cellRef + this.parseArgumentSeparator).join('').split(this.parseArgumentSeparator + cellRef).join('').split(cellRef).join('');\n            if (this.randomValues.size === 0 && stringCollection === '') {\n                this.randomValues.clear();\n                this.randCollection = [];\n            }\n            else {\n                this.randCollection = stringCollection.split(this.parseArgumentSeparator);\n            }\n        }\n        for (var i = 0; i < this.randomValues.size; i++) {\n            rowIdx = this.rowIndex(this.randCollection[i]);\n            colIdx = this.colIndex(this.randCollection[i]);\n            tokenRef = (parseFloat(this.getSheetToken(this.randCollection[i]).split(this.sheetToken).join('')) + 1).toString();\n            family = this.getSheetFamilyItem(tokenRef);\n            this.grid = family.sheetNameToParentObject.get(tokenRef);\n            value = this.randomValues.get(this.randCollection[i]);\n            value = this.computeFormula(value);\n            if (this.parentObject.setValueRowCol === undefined) {\n                this.setValueRowCol(this.getSheetID(this.grid) + 1, value, rowIdx, colIdx);\n            }\n            else {\n                this.parentObject.setValueRowCol(this.getSheetID(this.grid) + 1, value, rowIdx, colIdx);\n            }\n        }\n    };\n    Calculate.prototype.refresh = function (cellRef) {\n        if (this.dependencyLevel === 0) {\n            this.refreshedCells.clear();\n        }\n        if (this.getDependentCells().has(cellRef) && this.getDependentCells().get(cellRef) !== null) {\n            var family = this.getSheetFamilyItem(this.grid);\n            this.dependencyLevel = this.dependencyLevel + 1;\n            try {\n                var dependentCells = this.getDependentCells().get(cellRef);\n                var i = void 0;\n                for (i = 0; i < dependentCells.length; i++) {\n                    var dCell = dependentCells[i];\n                    var token = this.getSheetToken(dCell);\n                    if (token.length) {\n                        this.grid = family.tokenToParentObject.get(token);\n                    }\n                    try {\n                        var rowIdx = this.rowIndex(dCell);\n                        var colIdx = this.colIndex(dCell);\n                        var formulaInfo = this.getFormulaInfoTable().get(dCell);\n                        var result = void 0;\n                        if (formulaInfo) {\n                            this.cell = dCell;\n                            if (!this.getComputedValue().has(dCell)) {\n                                this.parser.isFormulaParsed = true;\n                                result = this.computeFormula(formulaInfo.getParsedFormula());\n                                this.computedValues.set(dCell, result);\n                            }\n                            else {\n                                result = this.getComputedValue().get(dCell);\n                            }\n                            formulaInfo.setFormulaValue(result);\n                        }\n                        if (this.parentObject.setValueRowCol === undefined) {\n                            this.setValueRowCol(this.getSheetID(this.grid) + 1, formulaInfo.getFormulaValue(), rowIdx, colIdx);\n                        }\n                        else {\n                            this.parentObject.setValueRowCol(this.getSheetID(this.grid) + 1, formulaInfo.getFormulaValue(), rowIdx, colIdx);\n                        }\n                        if (!this.refreshedCells.has(dCell)) {\n                            this.refreshedCells.set(dCell, []);\n                            this.refresh(dCell);\n                        }\n                    }\n                    catch (ex) {\n                        continue;\n                    }\n                }\n            }\n            finally {\n                this.grid = family.tokenToParentObject.get(this.getSheetToken(cellRef));\n                this.dependencyLevel--;\n                if (this.dependencyLevel === 0) {\n                    this.refreshedCells.clear();\n                }\n            }\n        }\n    };\n    var Calculate_1;\n    __decorate([\n        Property(true)\n    ], Calculate.prototype, \"includeBasicFormulas\", void 0);\n    __decorate([\n        Event()\n    ], Calculate.prototype, \"onFailure\", void 0);\n    Calculate = Calculate_1 = __decorate([\n        NotifyPropertyChanges\n    ], Calculate);\n    return Calculate;\n}(Base));\nexport { Calculate };\n/** @hidden */\nvar FormulaError = /** @class */ (function () {\n    function FormulaError(errorMessage, formulaAutoCorrection) {\n        this.formulaCorrection = false;\n        this.message = errorMessage;\n        this.formulaCorrection = formulaAutoCorrection;\n    }\n    return FormulaError;\n}());\nexport { FormulaError };\n/** @hidden */\nvar FormulaInfo = /** @class */ (function () {\n    function FormulaInfo() {\n        /**\n         * @hidden\n         */\n        this.calcID = Number.MIN_VALUE + 1;\n        this.calcID1 = Number.MIN_VALUE + 1;\n    }\n    /**\n     * @hidden\n     */\n    FormulaInfo.prototype.getFormulaText = function () {\n        return this.formulaText;\n    };\n    /**\n     * @hidden\n     */\n    FormulaInfo.prototype.setFormulaText = function (value) {\n        this.formulaText = value;\n    };\n    /**\n     * @hidden\n     */\n    FormulaInfo.prototype.getFormulaValue = function () {\n        return this.formulaValue;\n    };\n    /**\n     * @hidden\n     */\n    FormulaInfo.prototype.setFormulaValue = function (value) {\n        this.formulaValue = value;\n    };\n    /**\n     * @hidden\n     */\n    FormulaInfo.prototype.getParsedFormula = function () {\n        return this.parsedFormula;\n    };\n    /**\n     * @hidden\n     */\n    FormulaInfo.prototype.setParsedFormula = function (value) {\n        this.parsedFormula = value;\n    };\n    return FormulaInfo;\n}());\nexport { FormulaInfo };\n/** @hidden */\nvar CalcSheetFamilyItem = /** @class */ (function () {\n    function CalcSheetFamilyItem() {\n        /**\n         * @hidden\n         */\n        this.isSheetMember = false;\n        /**\n         * @hidden\n         */\n        this.parentObjectToToken = new Map();\n        /**\n         * @hidden\n         */\n        this.sheetDependentCells = new Map();\n        /**\n         * @hidden\n         */\n        this.sheetDependentFormulaCells = new Map();\n        /**\n         * @hidden\n         */\n        this.sheetNameToParentObject = new Map();\n        /**\n         * @hidden\n         */\n        this.sheetNameToToken = new Map();\n        /**\n         * @hidden\n         */\n        this.tokenToParentObject = new Map();\n        /**\n         * @hidden\n         */\n        this.sheetFormulaInfotable = new Map();\n    }\n    return CalcSheetFamilyItem;\n}());\nexport { CalcSheetFamilyItem };\n/**\n * @hidden\n */\nexport function getAlphalabel(col) {\n    var cols = [];\n    var n = 0;\n    var charText = 'A';\n    while (col > 0 && n < 9) {\n        col--;\n        var aCharNo = charText.charCodeAt(0);\n        cols[n] = String.fromCharCode(col % 26 + aCharNo);\n        col = parseInt((col / 26).toString(), 10);\n        n++;\n    }\n    var chs = [];\n    for (var i = 0; i < n; i++) {\n        chs[n - i - 1] = cols[i];\n    }\n    return chs.join('');\n}\nvar ValueChangedArgs = /** @class */ (function () {\n    function ValueChangedArgs(row, col, value) {\n        this.row = row;\n        this.col = col;\n        this.value = value;\n        this.getRowIndex = function () {\n            return row;\n        };\n        this.setRowIndex = function (value) {\n            row = value;\n        };\n        this.getColIndex = function () {\n            return col;\n        };\n        this.setColIndex = function (value) {\n            col = value;\n        };\n        this.getValue = function () {\n            return value;\n        };\n        this.setValue = function (value) {\n            value = value;\n        };\n        return this;\n    }\n    return ValueChangedArgs;\n}());\nexport { ValueChangedArgs };\n","/**\n * To get Workbook required modules.\n * @hidden\n * @param {Workbook} context\n */\nexport function getWorkbookRequiredModules(context, modules) {\n    if (modules === void 0) { modules = []; }\n    modules.push({ member: 'workbookBasic', args: [] });\n    modules.push({ member: 'workbookAll', args: [] });\n    modules.push({\n        member: 'dataBind',\n        args: [context]\n    });\n    if (context.allowSave) {\n        modules.push({\n            member: 'workbookSave',\n            args: [context]\n        });\n    }\n    if (context.allowOpen) {\n        modules.push({\n            member: 'workbookOpen',\n            args: [context]\n        });\n    }\n    if (context.allowEditing) {\n        modules.push({\n            member: 'workbookEdit',\n            args: [context]\n        });\n        modules.push({\n            member: 'workbookFormula',\n            args: [context]\n        });\n    }\n    if (context.allowNumberFormatting) {\n        modules.push({\n            member: 'workbookNumberFormat',\n            args: [context]\n        });\n    }\n    if (context.allowCellFormatting) {\n        modules.push({\n            member: 'workbookcellformat',\n            args: [context]\n        });\n    }\n    if (context.allowSorting) {\n        modules.push({ member: 'workbookSort', args: [context] });\n    }\n    if (context.allowHyperlink) {\n        modules.push({ member: 'workbookHyperlink', args: [context] });\n    }\n    if (context.allowFiltering) {\n        modules.push({ member: 'workbookFilter', args: [context] });\n    }\n    return modules;\n}\n","/**\n * Check whether the text is formula or not.\n * @param text\n */\nexport function checkIsFormula(text) {\n    return text && text[0] === '=' && text.length > 1;\n}\n","var __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    }\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nimport { Property, ChildProperty, Complex, extend } from '@syncfusion/ej2-base';\nimport { getRowsHeight, getColumnsWidth } from './index';\nimport { CellStyle } from '../common/index';\nimport { getRow } from './row';\n/**\n * Represents the cell.\n */\nvar Cell = /** @class */ (function (_super) {\n    __extends(Cell, _super);\n    function Cell() {\n        return _super !== null && _super.apply(this, arguments) || this;\n    }\n    __decorate([\n        Property('')\n    ], Cell.prototype, \"value\", void 0);\n    __decorate([\n        Property('')\n    ], Cell.prototype, \"formula\", void 0);\n    __decorate([\n        Property(0)\n    ], Cell.prototype, \"index\", void 0);\n    __decorate([\n        Property('General')\n    ], Cell.prototype, \"format\", void 0);\n    __decorate([\n        Complex({}, CellStyle)\n    ], Cell.prototype, \"style\", void 0);\n    __decorate([\n        Property('')\n    ], Cell.prototype, \"hyperlink\", void 0);\n    return Cell;\n}(ChildProperty));\nexport { Cell };\n/**\n * @hidden\n */\nexport function getCell(rowIndex, colIndex, sheet, isInitRow) {\n    var row = getRow(sheet, rowIndex);\n    if (!row || !row.cells) {\n        if (isInitRow) {\n            if (!row) {\n                sheet.rows[rowIndex] = { cells: [] };\n            }\n            else {\n                sheet.rows[rowIndex].cells = [];\n            }\n        }\n        else {\n            return null;\n        }\n    }\n    return sheet.rows[rowIndex].cells[colIndex];\n}\n/**\n * @hidden\n */\nexport function setCell(rowIndex, colIndex, sheet, cell, isExtend) {\n    if (!sheet.rows[rowIndex]) {\n        sheet.rows[rowIndex] = { cells: [] };\n    }\n    else if (!sheet.rows[rowIndex].cells) {\n        sheet.rows[rowIndex].cells = [];\n    }\n    if (isExtend && sheet.rows[rowIndex].cells[colIndex]) {\n        extend(sheet.rows[rowIndex].cells[colIndex], cell, null, true);\n    }\n    else {\n        sheet.rows[rowIndex].cells[colIndex] = cell;\n    }\n}\n/**\n * @hidden\n */\nexport function getCellPosition(sheet, indexes) {\n    var i;\n    var top = 0;\n    var left = 0;\n    for (i = 0; i < indexes[0]; i++) {\n        top += getRowsHeight(sheet, i);\n    }\n    for (i = 0; i < indexes[1]; i++) {\n        left += getColumnsWidth(sheet, i);\n    }\n    return { top: top, left: left };\n}\n/** @hidden */\nexport function skipDefaultValue(style, defaultKey) {\n    var defaultProps = { fontFamily: 'Calibri', verticalAlign: 'bottom', textIndent: '0pt', backgroundColor: '#ffffff',\n        color: '#000000', textAlign: 'left', fontSize: '11pt', fontWeight: 'normal', fontStyle: 'normal', textDecoration: 'none' };\n    var changedProps = {};\n    Object.keys(defaultKey ? defaultProps : style).forEach(function (propName) {\n        if (style[propName] !== defaultProps[propName]) {\n            changedProps[propName] = style[propName];\n        }\n    });\n    return changedProps;\n}\n","var __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    }\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nimport { Property, Collection, ChildProperty } from '@syncfusion/ej2-base';\nimport { Cell } from './cell';\n/**\n * Configures the Row behavior for the spreadsheet.\n *  ```html\n * <div id='Spreadsheet'></div>\n * ```\n * ```typescript\n * let spreadsheet: Spreadsheet = new Spreadsheet({\n *      sheets: [{\n *                rows: [{\n *                        index: 30,\n *                        cells: [{ index: 4, value: 'Total Amount:' },\n *                               { formula: '=SUM(F2:F30)', style: { fontWeight: 'bold' } }]\n *                }]\n * ...\n * });\n * spreadsheet.appendTo('#Spreadsheet');\n * ```\n */\nvar Row = /** @class */ (function (_super) {\n    __extends(Row, _super);\n    function Row() {\n        return _super !== null && _super.apply(this, arguments) || this;\n    }\n    __decorate([\n        Collection([], Cell)\n    ], Row.prototype, \"cells\", void 0);\n    __decorate([\n        Property(0)\n    ], Row.prototype, \"index\", void 0);\n    __decorate([\n        Property(20)\n    ], Row.prototype, \"height\", void 0);\n    __decorate([\n        Property(false)\n    ], Row.prototype, \"customHeight\", void 0);\n    __decorate([\n        Property(false)\n    ], Row.prototype, \"hidden\", void 0);\n    return Row;\n}(ChildProperty));\nexport { Row };\n/**\n * @hidden\n */\nexport function getRow(sheet, rowIndex) {\n    return sheet.rows[rowIndex];\n}\n/** @hidden */\nexport function setRow(sheet, rowIndex, row) {\n    if (!sheet.rows[rowIndex]) {\n        sheet.rows[rowIndex] = {};\n    }\n    Object.keys(row).forEach(function (key) {\n        sheet.rows[rowIndex][key] = row[key];\n    });\n}\n/** @hidden */\nexport function isHiddenRow(sheet, index) {\n    return sheet.rows[index] && sheet.rows[index].hidden;\n}\n/**\n * @hidden\n */\nexport function getRowHeight(sheet, rowIndex) {\n    if (sheet && sheet.rows && sheet.rows[rowIndex]) {\n        if (sheet.rows[rowIndex].hidden) {\n            return 0;\n        }\n        return sheet.rows[rowIndex].height === undefined ? 20 : sheet.rows[rowIndex].height;\n    }\n    else {\n        return 20;\n    }\n}\n/**\n * @hidden\n */\nexport function setRowHeight(sheet, rowIndex, height) {\n    if (sheet && sheet.rows) {\n        if (!sheet.rows[rowIndex]) {\n            sheet.rows[rowIndex] = {};\n        }\n        sheet.rows[rowIndex].height = height;\n    }\n}\n/**\n * @hidden\n */\nexport function getRowsHeight(sheet, startRow, endRow) {\n    if (endRow === void 0) { endRow = startRow; }\n    var height = 0;\n    var swap;\n    if (startRow > endRow) {\n        swap = startRow;\n        startRow = endRow;\n        endRow = swap;\n    }\n    for (var i = startRow; i <= endRow; i++) {\n        height += getRowHeight(sheet, i);\n    }\n    return height;\n}\n","var __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    }\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nimport { Property, ChildProperty } from '@syncfusion/ej2-base';\n/**\n * Configures the Column behavior for the spreadsheet.\n */\nvar Column = /** @class */ (function (_super) {\n    __extends(Column, _super);\n    function Column() {\n        return _super !== null && _super.apply(this, arguments) || this;\n    }\n    __decorate([\n        Property(0)\n    ], Column.prototype, \"index\", void 0);\n    __decorate([\n        Property(64)\n    ], Column.prototype, \"width\", void 0);\n    __decorate([\n        Property(false)\n    ], Column.prototype, \"customWidth\", void 0);\n    __decorate([\n        Property(false)\n    ], Column.prototype, \"hidden\", void 0);\n    return Column;\n}(ChildProperty));\nexport { Column };\n/**\n * @hidden\n */\nexport function getColumn(sheet, colIndex) {\n    if (sheet.columns) {\n        if (!sheet.columns[colIndex]) {\n            sheet.columns[colIndex] = {};\n        }\n    }\n    else {\n        sheet.columns = [];\n        sheet.columns[colIndex] = {};\n    }\n    return sheet.columns[colIndex];\n}\n/**\n * @hidden\n */\nexport function getColumnWidth(sheet, index) {\n    if (sheet && sheet.columns && sheet.columns[index] && (sheet.columns[index].width || sheet.columns[index].customWidth)) {\n        return sheet.columns[index].width;\n    }\n    else {\n        return 64;\n    }\n}\n/**\n * @hidden\n */\nexport function getColumnsWidth(sheet, startCol, endCol) {\n    if (endCol === void 0) { endCol = startCol; }\n    var width = 0;\n    if (startCol > endCol) {\n        var swap = startCol;\n        startCol = endCol;\n        endCol = swap;\n    }\n    for (var i = startCol; i <= endCol; i++) {\n        width += getColumnWidth(sheet, i);\n    }\n    return width;\n}\n/** @hidden */\nexport function isHiddenCol(sheet, index) {\n    return sheet.columns[index] && (sheet.columns[index].hidden || (sheet.columns[index].width !== undefined &&\n        sheet.columns[index].width === 0));\n}\n","import { getSheetNameFromAddress, getSheetIndex, getSheet } from '../base/index';\nimport { getCellAddress, getIndexesFromAddress, getColumnHeaderText, updateSheetFromDataSource, checkDateFormat } from '../common/index';\nimport { getRow, isHiddenRow } from './row';\nimport { getCell } from './cell';\nimport { isUndefined, isNullOrUndefined } from '@syncfusion/ej2-base';\nimport { getMaxSheetId, getSheetNameCount } from './sheet';\n/**\n * Update data source to Sheet and returns Sheet\n * @hidden\n */\nexport function getData(context, address, columnWiseData, valueOnly) {\n    return new Promise(function (resolve, reject) {\n        resolve((function () {\n            var i;\n            var row;\n            var data = new Map();\n            var sheetIdx = getSheetIndex(context, getSheetNameFromAddress(address));\n            var sheet = getSheet(context, sheetIdx);\n            var indexes = getIndexesFromAddress(address);\n            var sRow = indexes[0];\n            var index = 0;\n            var args = {\n                sheet: sheet, indexes: indexes, promise: new Promise(function (resolve, reject) { resolve((function () { })()); })\n            };\n            context.notify(updateSheetFromDataSource, args);\n            return args.promise.then(function () {\n                while (sRow <= indexes[2]) {\n                    if (!valueOnly && isHiddenRow(sheet, sRow)) {\n                        sRow++;\n                        continue;\n                    }\n                    var cells = {};\n                    row = getRow(sheet, sRow);\n                    i = indexes[1];\n                    while (i <= indexes[3]) {\n                        if (columnWiseData) {\n                            if (data instanceof Map) {\n                                data = [];\n                            }\n                            var key = getColumnHeaderText(i + 1);\n                            var rowKey = '__rowIndex';\n                            if (valueOnly) {\n                                cells[key] = row ? getValueFromFormat(context, sRow, i, sheetIdx, sheet) : '';\n                            }\n                            else {\n                                cells[key] = row ? getCell(sRow, i, sheet) : null;\n                            }\n                            if (indexes[3] < i + 1) {\n                                cells[rowKey] = (sRow + 1).toString();\n                            }\n                            data[index.toString()] = cells;\n                        }\n                        else {\n                            data.set(getCellAddress(sRow, i), row ? getCell(sRow, i, sheet) : null);\n                        }\n                        i++;\n                    }\n                    sRow++;\n                    index++;\n                }\n                return data;\n            });\n        })());\n    });\n}\nfunction getValueFromFormat(context, rowIndex, colIndex, sheetIdx, sheet) {\n    var cell = getCell(rowIndex, colIndex, sheet);\n    if (cell) {\n        if (cell.format) {\n            var args = {\n                value: context.getDisplayText(cell), rowIndex: rowIndex, colIndex: colIndex,\n                sheetIndex: sheetIdx, dateObj: '', isDate: false, isTime: false\n            };\n            context.notify(checkDateFormat, args);\n            if (args.isDate) {\n                return args.dateObj;\n            }\n            else {\n                return cell.value;\n            }\n        }\n        else {\n            return cell.value;\n        }\n    }\n    else {\n        return '';\n    }\n}\n/**\n * @hidden\n */\nexport function getModel(model, idx) {\n    var diff;\n    var j;\n    var prevIdx;\n    if (isUndefined(model[idx]) || !(model[idx] && model[idx].index === idx)) {\n        for (var i = 0; i <= idx; i++) {\n            if (model && model[i]) {\n                diff = model[i].index - i;\n                if (diff > 0) {\n                    model.forEach(function (value, index) {\n                        if (value && value.index) {\n                            prevIdx = value.index;\n                            j = 1;\n                        }\n                        if (value && !value.index && index !== 0) {\n                            value.index = prevIdx + j;\n                        }\n                        j++;\n                    });\n                    while (diff--) {\n                        model.splice(i, 0, null);\n                    }\n                    i += diff;\n                }\n            }\n            else if (model) {\n                model[i] = null;\n            }\n            else {\n                model = [];\n            }\n        }\n    }\n    return model[idx];\n}\n/**\n * @hidden\n */\nexport function processIdx(model, isSheet, context) {\n    var j;\n    var diff;\n    var cnt;\n    var len = model.length;\n    for (var i = 0; i < len; i++) {\n        cnt = diff = model[i].index - i;\n        model[i].index = null;\n        if (diff > 0) {\n            j = 0;\n            while (diff--) {\n                if (isSheet) {\n                    context.createSheet(i + j);\n                    j++;\n                }\n                else {\n                    model.splice(i, 0, null);\n                }\n            }\n            i += cnt;\n            len += cnt;\n        }\n        if (isSheet) {\n            model[i].id = getMaxSheetId(context.sheets);\n            if (!model[i].name) {\n                model[i].name = 'Sheet' + getSheetNameCount(context);\n            }\n        }\n    }\n    if (isSheet) {\n        context.setProperties({ 'sheets': context.sheets }, true);\n    }\n}\n/**\n * @hidden\n */\nexport function clearRange(context, address, sheetIdx, valueOnly) {\n    var sheet = getSheet(context, sheetIdx - 1);\n    var range = getIndexesFromAddress(address);\n    var sRIdx = range[0];\n    var eRIdx = range[2];\n    var sCIdx;\n    var eCIdx;\n    for (sRIdx; sRIdx <= eRIdx; sRIdx++) {\n        sCIdx = range[1];\n        eCIdx = range[3];\n        for (sCIdx; sCIdx <= eCIdx; sCIdx++) {\n            var cell = getCell(sRIdx, sCIdx, sheet);\n            if (!isNullOrUndefined(cell) && valueOnly) {\n                delete cell.value;\n                if (!isNullOrUndefined(cell.formula)) {\n                    delete cell.formula;\n                }\n            }\n        }\n    }\n}\n","var __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    }\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nimport { Row } from './row';\nimport { Column } from './column';\nimport { Property, Collection, ChildProperty, Complex } from '@syncfusion/ej2-base';\nimport { processIdx } from './data';\n/**\n * Configures the Range settings for the spreadsheet.\n *  ```html\n * <div id='Spreadsheet'></div>\n * ```\n * ```typescript\n * let spreadsheet: Spreadsheet = new Spreadsheet({\n *      sheets: [{\n *                  name: 'First Sheet',\n *                  rangeSettings: [{ dataSource: defaultData }],\n *                  rows: [{\n *                          index: 30,\n *                          cells: [{ index: 4, value: 'Total Amount:' },\n *                                  { formula: '=SUM(F2:F30)', style: { fontWeight: 'bold' } }]\n *                  }]\n * ...\n * });\n * spreadsheet.appendTo('#Spreadsheet');\n * ```\n */\nvar RangeSetting = /** @class */ (function (_super) {\n    __extends(RangeSetting, _super);\n    function RangeSetting() {\n        return _super !== null && _super.apply(this, arguments) || this;\n    }\n    __decorate([\n        Property(null)\n    ], RangeSetting.prototype, \"dataSource\", void 0);\n    __decorate([\n        Property('A1')\n    ], RangeSetting.prototype, \"startCell\", void 0);\n    __decorate([\n        Property(null)\n    ], RangeSetting.prototype, \"query\", void 0);\n    __decorate([\n        Property(true)\n    ], RangeSetting.prototype, \"showFieldAsHeader\", void 0);\n    return RangeSetting;\n}(ChildProperty));\nexport { RangeSetting };\n/**\n * Used range which contains end row index and end column index of the last used cell in sheet .\n */\nvar UsedRange = /** @class */ (function (_super) {\n    __extends(UsedRange, _super);\n    function UsedRange() {\n        return _super !== null && _super.apply(this, arguments) || this;\n    }\n    __decorate([\n        Property(0)\n    ], UsedRange.prototype, \"rowIndex\", void 0);\n    __decorate([\n        Property(0)\n    ], UsedRange.prototype, \"colIndex\", void 0);\n    return UsedRange;\n}(ChildProperty));\nexport { UsedRange };\n/**\n * Configures the sheet behavior for the spreadsheet.\n */\nvar Sheet = /** @class */ (function (_super) {\n    __extends(Sheet, _super);\n    function Sheet() {\n        return _super !== null && _super.apply(this, arguments) || this;\n    }\n    __decorate([\n        Property(0)\n    ], Sheet.prototype, \"id\", void 0);\n    __decorate([\n        Collection([], Row)\n    ], Sheet.prototype, \"rows\", void 0);\n    __decorate([\n        Collection([], Column)\n    ], Sheet.prototype, \"columns\", void 0);\n    __decorate([\n        Collection([], RangeSetting)\n    ], Sheet.prototype, \"rangeSettings\", void 0);\n    __decorate([\n        Property(0)\n    ], Sheet.prototype, \"index\", void 0);\n    __decorate([\n        Property('')\n    ], Sheet.prototype, \"name\", void 0);\n    __decorate([\n        Property(100)\n    ], Sheet.prototype, \"rowCount\", void 0);\n    __decorate([\n        Property(100)\n    ], Sheet.prototype, \"colCount\", void 0);\n    __decorate([\n        Property('A1')\n    ], Sheet.prototype, \"selectedRange\", void 0);\n    __decorate([\n        Property('A1')\n    ], Sheet.prototype, \"activeCell\", void 0);\n    __decorate([\n        Complex({}, UsedRange)\n    ], Sheet.prototype, \"usedRange\", void 0);\n    __decorate([\n        Property('A1')\n    ], Sheet.prototype, \"topLeftCell\", void 0);\n    __decorate([\n        Property(true)\n    ], Sheet.prototype, \"showHeaders\", void 0);\n    __decorate([\n        Property(true)\n    ], Sheet.prototype, \"showGridLines\", void 0);\n    return Sheet;\n}(ChildProperty));\nexport { Sheet };\n/**\n * To get sheet index from address.\n * @hidden\n */\nexport function getSheetIndex(context, name) {\n    var idx;\n    for (var i = 0; i < context.sheets.length; i++) {\n        if (context.sheets[i].name.toLowerCase() === name.toLowerCase()) {\n            idx = i;\n            break;\n        }\n    }\n    return idx;\n}\n/**\n * To get sheet index from address.\n * @hidden\n */\nexport function getSheetIndexFromId(context, id) {\n    var idx;\n    for (var i = 0; i < context.sheets.length; i++) {\n        if (context.sheets[i].id === id) {\n            idx = i;\n            break;\n        }\n    }\n    return idx + 1;\n}\n/**\n * To get sheet name from address.\n * @hidden\n */\nexport function getSheetNameFromAddress(address) {\n    return address.split('!')[0];\n}\n/**\n * To get sheet index from sheet name.\n * @hidden\n */\nexport function getSheetIndexByName(context, name, info) {\n    var len = info.length;\n    for (var i = 0; i < len; i++) {\n        if (info[i].sheet.toUpperCase() === name.toUpperCase()) {\n            return info[i].index;\n        }\n    }\n    return -1;\n}\n/**\n * update selected range\n * @hidden\n */\nexport function updateSelectedRange(context, range, sheet) {\n    if (sheet === void 0) { sheet = {}; }\n    sheet.selectedRange = range;\n    context.setProperties({ 'sheets': context.sheets }, true);\n}\n/**\n * get selected range\n * @hidden\n */\nexport function getSelectedRange(sheet) {\n    return sheet && sheet.selectedRange || 'A1';\n}\n/**\n * @hidden\n */\nexport function getSheet(context, idx) {\n    return context.sheets[idx];\n}\n/**\n * @hidden\n */\nexport function getSheetNameCount(context) {\n    var name = [];\n    context.sheets.forEach(function (sheet) {\n        name.push(sheet.name.toLowerCase());\n    });\n    for (var i = 0; i < name.length; i++) {\n        if (name.indexOf('sheet' + context.sheetNameCount) > -1) {\n            context.sheetNameCount++;\n        }\n        else {\n            return context.sheetNameCount++;\n        }\n    }\n    return context.sheetNameCount++;\n}\n/**\n * @hidden\n */\nexport function getMaxSheetId(sheets) {\n    var cnt = 0;\n    sheets.forEach(function (sheet) {\n        cnt = Math.max(sheet.id, cnt);\n    });\n    return cnt + 1;\n}\n/**\n * @hidden\n */\nexport function initSheet(context) {\n    context.sheets.forEach(function (sheet) {\n        processIdx(sheet.columns);\n        initRow(sheet.rows);\n    });\n    processIdx(context.sheets, true, context);\n}\nfunction initRow(rows) {\n    rows.forEach(function (row) {\n        if (row.cells) {\n            processIdx(row.cells);\n        }\n    });\n    processIdx(rows);\n}\n/**\n * get sheet name\n * @hidden\n */\nexport function getSheetName(context, idx) {\n    if (idx === void 0) { idx = context.activeSheetTab; }\n    return getSheet(context, idx - 1).name;\n}\n","import { getWorkbookRequiredModules } from '../../workbook/common/module';\n/**\n * To get Spreadsheet required modules.\n * @hidden\n * @param {Spreadsheet} context\n */\nexport function getRequiredModules(context) {\n    var modules = [];\n    pushBasicModules(context, modules);\n    getWorkbookRequiredModules(context, modules);\n    return modules;\n}\n// tslint:disable-next-line:max-func-body-length\nfunction pushBasicModules(context, modules) {\n    modules.push({ member: 'basic', args: [] });\n    modules.push({ member: 'all', args: [] });\n    if (context.showRibbon) {\n        modules.push({\n            member: 'ribbon',\n            args: [context]\n        });\n    }\n    if (context.showFormulaBar) {\n        modules.push({\n            member: 'formulaBar',\n            args: [context]\n        });\n    }\n    if (context.showSheetTabs) {\n        modules.push({\n            member: 'sheetTabs',\n            args: [context]\n        });\n    }\n    if (context.allowEditing) {\n        modules.push({\n            member: 'edit',\n            args: [context]\n        });\n        modules.push({\n            member: 'formula',\n            args: [context]\n        });\n        modules.push({\n            member: 'workbookFormula',\n            args: [context]\n        });\n        modules.push({\n            member: 'workbookEdit',\n            args: [context]\n        });\n    }\n    if (context.allowOpen) {\n        modules.push({\n            member: 'open',\n            args: [context]\n        });\n    }\n    if (context.allowSave) {\n        modules.push({\n            member: 'save',\n            args: [context]\n        });\n    }\n    if (context.enableContextMenu) {\n        modules.push({\n            member: 'contextMenu',\n            args: [context]\n        });\n    }\n    if (context.selectionSettings.mode !== 'None') {\n        modules.push({\n            member: 'selection',\n            args: [context]\n        });\n    }\n    if (context.enableKeyboardNavigation) {\n        modules.push({\n            member: 'keyboardNavigation',\n            args: [context]\n        });\n    }\n    if (context.allowNumberFormatting) {\n        modules.push({\n            member: 'numberFormat',\n            args: [context]\n        });\n    }\n    if (context.enableKeyboardShortcut) {\n        modules.push({\n            member: 'keyboardShortcut',\n            args: [context]\n        });\n    }\n    if (context.enableClipboard) {\n        modules.push({\n            member: 'clipboard',\n            args: [context]\n        });\n    }\n    if (context.allowCellFormatting) {\n        modules.push({\n            member: 'cellformat',\n            args: [context]\n        });\n    }\n    if (context.allowSorting) {\n        modules.push({ member: 'sort', args: [context] });\n    }\n    if (context.allowResizing) {\n        modules.push({\n            member: 'resize',\n            args: [context]\n        });\n    }\n    modules.push({\n        member: 'collaborativeEditing',\n        args: [context]\n    });\n    if (context.allowHyperlink) {\n        modules.push({\n            member: 'spreadsheetHyperlink',\n            args: [context]\n        });\n    }\n    if (context.allowUndoRedo) {\n        modules.push({\n            member: 'undoredo',\n            args: [context]\n        });\n    }\n    if (context.allowFiltering) {\n        modules.push({ member: 'filter', args: [context] });\n    }\n}\n","import { Browser, setStyleAttribute as setBaseStyleAttribute, getComponent } from '@syncfusion/ej2-base';\nimport { getCellPosition, getRowsHeight, getColumnsWidth, getSwapRange } from '../../workbook/index';\nimport { initiateSort, getIndexesFromAddress } from '../../workbook/index';\nimport { addSheetTab, removeSheetTab } from './event';\n/**\n * The function used to update Dom using requestAnimationFrame.\n * @param  {Function} fn - Function that contains the actual action\n * @return {Promise<T>}\n * @hidden\n */\nexport function getUpdateUsingRaf(fn) {\n    requestAnimationFrame(function () {\n        fn();\n    });\n}\n/**\n * The function used to remove the dom element children.\n * @param  parent -\n * @hidden\n */\nexport function removeAllChildren(parent, index) {\n    while (parent.firstChild) {\n        parent.removeChild(parent.firstChild);\n    }\n}\n/**\n * The function used to remove the dom element children.\n * @param  parent -\n * @hidden\n */\nexport function getColGroupWidth(index) {\n    var width = 30;\n    if (index.toString().length > 3) {\n        width = index.toString().length * 10;\n    }\n    return width;\n}\nvar scrollAreaWidth = null;\n/** @hidden */\nexport function getScrollBarWidth() {\n    if (scrollAreaWidth !== null) {\n        return scrollAreaWidth;\n    }\n    var htmlDivNode = document.createElement('div');\n    var result = 0;\n    htmlDivNode.style.cssText = 'width:100px;height: 100px;overflow: scroll;position: absolute;top: -9999px;';\n    document.body.appendChild(htmlDivNode);\n    result = (htmlDivNode.offsetWidth - htmlDivNode.clientWidth) | 0;\n    document.body.removeChild(htmlDivNode);\n    return scrollAreaWidth = result;\n}\nvar classes = ['e-ribbon', 'e-formula-bar-panel', 'e-sheet-tab-panel', 'e-header-toolbar'];\n/** @hidden */\nexport function getSiblingsHeight(element, classList) {\n    if (classList === void 0) { classList = classes; }\n    var previous = getHeightFromDirection(element, 'previous', classList);\n    var next = getHeightFromDirection(element, 'next', classList);\n    return previous + next;\n}\nfunction getHeightFromDirection(element, direction, classList) {\n    // tslint:disable-next-line:no-any\n    var sibling = element[direction + 'ElementSibling'];\n    var result = 0;\n    while (sibling) {\n        if (classList.some(function (value) { return sibling.classList.contains(value); })) {\n            result += sibling.offsetHeight;\n        }\n        // tslint:disable-next-line:no-any\n        sibling = sibling[direction + 'ElementSibling'];\n    }\n    return result;\n}\n/**\n * @hidden\n */\nexport function inView(context, range, isModify) {\n    if (context.scrollSettings.enableVirtualization) {\n        var topIdx = context.viewport.topIndex;\n        var leftIdx = context.viewport.leftIndex;\n        var bottomIdx = topIdx + context.viewport.rowCount + context.getThreshold('row') * 2;\n        var rightIdx = leftIdx + context.viewport.colCount + context.getThreshold('col') * 2;\n        var inView_1 = topIdx <= range[0] && bottomIdx >= range[2] && leftIdx <= range[1] && rightIdx >= range[3];\n        if (inView_1) {\n            return true;\n        }\n        if (isModify) {\n            if (range[0] < topIdx && range[2] < topIdx || range[0] > bottomIdx && range[2] > bottomIdx) {\n                return false;\n            }\n            else {\n                if (range[0] < topIdx && range[2] > topIdx) {\n                    range[0] = topIdx;\n                    inView_1 = true;\n                }\n                if (range[2] > bottomIdx) {\n                    range[2] = bottomIdx;\n                    inView_1 = true;\n                }\n            }\n            if (range[1] < leftIdx && range[3] < leftIdx || range[1] > rightIdx && range[3] > rightIdx) {\n                return false;\n            }\n            else {\n                if (range[1] < leftIdx && range[3] > leftIdx) {\n                    range[1] = leftIdx;\n                    inView_1 = true;\n                }\n                if (range[3] > rightIdx) {\n                    range[3] = rightIdx;\n                    inView_1 = true;\n                }\n            }\n        }\n        return inView_1;\n    }\n    else {\n        return true;\n    }\n}\n/**\n * Position element with given range\n * @hidden\n */\nexport function locateElem(ele, range, sheet, isRtl) {\n    var swapRange = getSwapRange(range);\n    var cellPosition = getCellPosition(sheet, swapRange);\n    var attrs = {\n        'top': (swapRange[0] === 0 ? cellPosition.top : cellPosition.top - 1) + 'px',\n        'height': getRowsHeight(sheet, range[0], range[2]) + (swapRange[0] === 0 ? 0 : 1) + 'px',\n        'width': getColumnsWidth(sheet, range[1], range[3]) + (swapRange[1] === 0 ? 0 : 1) + 'px'\n    };\n    attrs[isRtl ? 'right' : 'left'] = (swapRange[1] === 0 ? cellPosition.left : cellPosition.left - 1) + 'px';\n    setStyleAttribute([{ element: ele, attrs: attrs }]);\n}\n/**\n * To update element styles using request animation frame\n * @hidden\n */\nexport function setStyleAttribute(styles) {\n    requestAnimationFrame(function () {\n        styles.forEach(function (style) {\n            setBaseStyleAttribute(style.element, style.attrs);\n        });\n    });\n}\n/**\n * @hidden\n */\nexport function getStartEvent() {\n    return (Browser.isPointer ? 'pointerdown' : 'mousedown touchstart');\n}\n/**\n * @hidden\n */\nexport function getMoveEvent() {\n    return (Browser.isPointer ? 'pointermove' : 'mousemove touchmove');\n}\n/**\n * @hidden\n */\nexport function getEndEvent() {\n    return (Browser.isPointer ? 'pointerup' : 'mouseup touchend');\n}\n/**\n * @hidden\n */\nexport function isTouchStart(e) {\n    return e.type === 'touchstart' || (e.type === 'pointerdown' && e.pointerType === 'touch');\n}\n/**\n * @hidden\n */\nexport function isTouchMove(e) {\n    return e.type === 'touchmove' || (e.type === 'pointermove' && e.pointerType === 'touch');\n}\n/**\n * @hidden\n */\nexport function isTouchEnd(e) {\n    return e.type === 'touchend' || (e.type === 'pointerup' && e.pointerType === 'touch');\n}\n/**\n * @hidden\n */\nexport function getClientX(e) {\n    return e.changedTouches ? e.changedTouches[0].clientX : e.clientX;\n}\n/**\n * @hidden\n */\nexport function getClientY(e) {\n    return e.changedTouches ? e.changedTouches[0].clientY : e.clientY;\n}\nvar config = {\n    role: 'role',\n    selected: 'aria-selected',\n    multiselectable: 'aria-multiselectable',\n    busy: 'aria-busy',\n    colcount: 'aria-colcount'\n};\n/** @hidden */\nexport function setAriaOptions(target, options) {\n    var props = Object.keys(options);\n    props.forEach(function (name) {\n        if (target) {\n            target.setAttribute(config[name], options[name]);\n        }\n    });\n}\n/**\n * @hidden\n */\nexport function destroyComponent(element, component) {\n    if (element) {\n        var compObj = getComponent(element, component);\n        if (compObj) {\n            compObj.destroy();\n        }\n    }\n}\n/**\n * @hidden\n */\n// tslint:disable-next-line:max-func-body-length\nexport function setResize(index, value, isCol, parent) {\n    var curEle;\n    var curEleH;\n    var curEleC;\n    var preEle;\n    var preEleH;\n    var preEleC;\n    var nxtEle;\n    var nxtEleH;\n    var nxtEleC;\n    var sheet = parent.getActiveSheet();\n    if (isCol) {\n        curEle = parent.element.getElementsByClassName('e-column-header')[0].getElementsByTagName('th')[index];\n        curEleH = parent.element.getElementsByClassName('e-column-header')[0].getElementsByTagName('col')[index];\n        curEleC = parent.element.getElementsByClassName('e-main-content')[0].getElementsByTagName('col')[index];\n    }\n    else {\n        curEle = parent.element.getElementsByClassName('e-row-header')[0].getElementsByTagName('tr')[index];\n        curEleH = parent.element.getElementsByClassName('e-row-header')[0].getElementsByTagName('tr')[index];\n        curEleC = parent.element.getElementsByClassName('e-main-content')[0].getElementsByTagName('tr')[index];\n        curEleH.style.height = parseInt(value, 10) > 0 ? value : '2px';\n        curEleC.style.height = parseInt(value, 10) > 0 ? value : '0px';\n        var hdrRow = parent.getRowHeaderContent().getElementsByClassName('e-row');\n        var hdrClone = [];\n        hdrClone[0] = hdrRow[index].getElementsByTagName('td')[0].cloneNode(true);\n        var hdrFntSize = findMaxValue(parent.getRowHeaderTable(), hdrClone, false, parent) + 1;\n        var contentRow = parent.getMainContent().getElementsByClassName('e-row');\n        var contentClone = [];\n        for (var idx = 0; idx < contentRow[index].getElementsByTagName('td').length; idx++) {\n            contentClone[idx] = contentRow[index].getElementsByTagName('td')[idx].cloneNode(true);\n        }\n        var cntFntSize = findMaxValue(parent.getContentTable(), contentClone, false, parent) + 1;\n        var fntSize = hdrFntSize >= cntFntSize ? hdrFntSize : cntFntSize;\n        if (parseInt(curEleC.style.height, 10) < fntSize ||\n            (curEle.classList.contains('e-reach-fntsize') && parseInt(curEleC.style.height, 10) === fntSize)) {\n            curEle.classList.add('e-reach-fntsize');\n            curEleH.style.lineHeight = parseInt(value, 10) >= 4 ? ((parseInt(value, 10)) - 4) + 'px' :\n                parseInt(value, 10) > 0 ? ((parseInt(value, 10)) - 1) + 'px' : '0px';\n            curEleC.style.lineHeight = parseInt(value, 10) > 0 ? ((parseInt(value, 10)) - 1) + 'px' : '0px';\n        }\n        else {\n            curEleH.style.removeProperty('line-height');\n            curEleC.style.removeProperty('line-height');\n            if (curEle.classList.contains('e-reach-fntsize')) {\n                curEle.classList.remove('e-reach-fntsize');\n            }\n        }\n    }\n    preEle = curEle.previousElementSibling;\n    nxtEle = curEle.nextElementSibling;\n    if (preEle) {\n        preEle = curEle.previousElementSibling;\n        preEleH = curEleH.previousElementSibling;\n        preEleC = curEleC.previousElementSibling;\n    }\n    if (nxtEle) {\n        nxtEle = curEle.nextElementSibling;\n        nxtEleH = curEleH.nextElementSibling;\n        nxtEleC = curEleC.nextElementSibling;\n    }\n    if (parseInt(value, 10) <= 0 && !(curEle.classList.contains('e-zero') || curEle.classList.contains('e-zero-start'))) {\n        if (preEle && nxtEle) {\n            if (isCol) {\n                curEleH.style.width = '2px';\n                curEleC.style.width = '0px';\n            }\n            else {\n                curEleH.style.height = '2px';\n                curEleC.style.height = '0px';\n            }\n            if (preEle.classList.contains('e-zero-start')) {\n                curEle.classList.add('e-zero-start');\n                curEleC.classList.add('e-zero-start');\n            }\n            else {\n                curEle.classList.add('e-zero');\n                curEleC.classList.add('e-zero');\n            }\n            if (!nxtEle.classList.contains('e-zero') && !nxtEle.classList.contains('e-zero-last')) {\n                curEle.classList.add('e-zero-last');\n                curEleC.classList.add('e-zero-last');\n            }\n            if (preEle.classList.contains('e-zero-last')) {\n                preEle.classList.remove('e-zero-last');\n                preEleC.classList.remove('e-zero-last');\n            }\n            if (preEle.classList.contains('e-zero')) {\n                if (curEle.classList.contains('e-zero-end')) {\n                    setWidthAndHeight(preEleH, -2, isCol);\n                }\n                else {\n                    setWidthAndHeight(preEleH, -2, isCol);\n                }\n            }\n            else {\n                setWidthAndHeight(preEleH, -1, isCol);\n            }\n            if (preEle.classList.contains('e-zero-start')) {\n                setWidthAndHeight(curEleH, -1, isCol);\n            }\n            if (nxtEle.classList.contains('e-zero')) {\n                if (curEle.classList.contains('e-zero-start')) {\n                    while (nxtEle) {\n                        if (nxtEle.classList.contains('e-zero') && (parseInt(nxtEleH.style.height, 10) !== 0 && !isCol) ||\n                            (parseInt(nxtEleH.style.width, 10) !== 0 && isCol)) {\n                            if (isCol) {\n                                curEleH.style.width = parseInt(curEleH.style.width, 10) - 1 + 'px';\n                                nxtEleH.style.width = parseInt(nxtEleH.style.width, 10) - 1 + 'px';\n                            }\n                            else {\n                                curEleH.style.height = parseInt(curEleH.style.height, 10) - 1 + 'px';\n                                nxtEleH.style.height = parseInt(nxtEleH.style.height, 10) - 1 + 'px';\n                            }\n                            nxtEle.classList.remove('e-zero');\n                            nxtEle.classList.add('e-zero-start');\n                            break;\n                        }\n                        else {\n                            var nxtIndex = void 0;\n                            nxtEle.classList.remove('e-zero');\n                            nxtEle.classList.add('e-zero-start');\n                            if (isCol) {\n                                nxtIndex = parseInt(nxtEle.getAttribute('aria-colindex'), 10) - 1;\n                                nxtEle = parent.getColHeaderTable().getElementsByTagName('th')[nxtIndex + 1];\n                                nxtEleH = parent.getColHeaderTable().getElementsByTagName('col')[nxtIndex + 1];\n                            }\n                            else {\n                                nxtIndex = parseInt(nxtEle.getAttribute('aria-rowindex'), 10) - 1;\n                                nxtEle = parent.getRowHeaderTable().getElementsByTagName('tr')[nxtIndex + 1];\n                                nxtEleH = parent.getRowHeaderTable().getElementsByTagName('tr')[nxtIndex + 1];\n                            }\n                        }\n                    }\n                }\n                else {\n                    setWidthAndHeight(curEleH, -2, isCol);\n                }\n            }\n            else {\n                if (nxtEle.classList.contains('e-zero-end')) {\n                    if (isCol) {\n                        curEleH.style.width = '0px';\n                    }\n                    else {\n                        curEleH.style.height = '0px';\n                    }\n                }\n                else {\n                    setWidthAndHeight(nxtEleH, -1, isCol);\n                }\n            }\n        }\n        else if (preEle) {\n            if (isCol) {\n                curEleH.style.width = '1px';\n                curEleC.style.width = '0px';\n            }\n            else {\n                curEleH.style.height = '1px';\n                curEleC.style.height = '0px';\n            }\n            curEle.classList.add('e-zero-end');\n            curEleC.classList.add('e-zero-end');\n            curEle.classList.add('e-zero-last');\n            curEleC.classList.add('e-zero-last');\n            if (preEle.classList.contains('e-zero')) {\n                setWidthAndHeight(preEleH, -2, isCol);\n            }\n            else {\n                setWidthAndHeight(preEleH, -1, isCol);\n            }\n        }\n        else if (nxtEle) {\n            curEle.classList.add('e-zero-start');\n            curEleC.classList.add('e-zero-start');\n            if (!nxtEle.classList.contains('e-zero')) {\n                curEle.classList.add('e-zero-last');\n                curEleC.classList.add('e-zero-last');\n            }\n            if (isCol) {\n                curEleH.style.width = '1px';\n                curEleC.style.width = '0px';\n            }\n            else {\n                curEleH.style.height = '1px';\n                curEleC.style.height = '0px';\n            }\n            if (nxtEle.classList.contains('e-zero')) {\n                while (nxtEle) {\n                    if (nxtEle.classList.contains('e-zero') && (parseInt(nxtEleH.style.width, 10) !== 0\n                        && isCol) || (parseInt(nxtEleH.style.height, 10) !== 0 && !isCol)) {\n                        if (isCol) {\n                            nxtEleH.style.width = parseInt(nxtEleH.style.width, 10) - 1 + 'px';\n                            curEleH.style.width = parseInt(curEleH.style.width, 10) - 1 + 'px';\n                        }\n                        else {\n                            nxtEleH.style.height = parseInt(nxtEleH.style.height, 10) - 1 + 'px';\n                            curEleH.style.height = parseInt(curEleH.style.height, 10) - 1 + 'px';\n                        }\n                        nxtEle.classList.add('e-zero-start');\n                        nxtEle.classList.remove('e-zero');\n                        break;\n                    }\n                    else {\n                        var nxtIndex = void 0;\n                        nxtEle.classList.add('e-zero-start');\n                        nxtEle.classList.remove('e-zero');\n                        if (isCol) {\n                            nxtIndex = parseInt(nxtEle.getAttribute('aria-colindex'), 10) - 1;\n                            nxtEleH = parent.getColHeaderTable().getElementsByTagName('col')[nxtIndex + 1];\n                            nxtEle = parent.getColHeaderTable().getElementsByTagName('th')[nxtIndex + 1];\n                        }\n                        else {\n                            nxtIndex = parseInt(nxtEle.getAttribute('aria-rowindex'), 10) - 1;\n                            nxtEleH = parent.getRowHeaderTable().getElementsByTagName('tr')[nxtIndex + 1];\n                            nxtEle = parent.getRowHeaderTable().getElementsByTagName('tr')[nxtIndex + 1];\n                        }\n                    }\n                }\n            }\n            else {\n                setWidthAndHeight(nxtEleH, -1, isCol);\n            }\n        }\n    }\n    else if (parseInt(value, 10) > 0) {\n        if (isCol) {\n            curEleH.style.width = value;\n            curEleC.style.width = value;\n        }\n        else {\n            curEleH.style.height = value;\n            curEleC.style.height = value;\n        }\n        if (preEle && nxtEle) {\n            if (preEle.classList.contains('e-zero')) {\n                if (curEle.classList.contains('e-zero')) {\n                    if (isCol) {\n                        preEleH.style.width = parseInt(preEleH.style.width, 10) + 2 + 'px';\n                        curEleH.style.width = parseInt(curEleH.style.width, 10) - 1 + 'px';\n                    }\n                    else {\n                        preEleH.style.height = parseInt(preEleH.style.height, 10) + 2 + 'px';\n                        curEleH.style.height = parseInt(curEleH.style.height, 10) - 1 + 'px';\n                    }\n                }\n                else {\n                    setWidthAndHeight(curEleH, -1, isCol);\n                }\n            }\n            else {\n                if (curEle.classList.contains('e-zero')) {\n                    setWidthAndHeight(preEleH, 1, isCol);\n                }\n                else {\n                    if (curEle.classList.contains('e-zero-start')) {\n                        if (isCol) {\n                            preEleH.style.width = parseInt(preEleH.style.width, 10) + 1 + 'px';\n                            curEleH.style.width = parseInt(curEleH.style.width, 10) - 1 + 'px';\n                        }\n                        else {\n                            preEleH.style.height = parseInt(preEleH.style.height, 10) + 1 + 'px';\n                            curEleH.style.height = parseInt(curEleH.style.height, 10) - 1 + 'px';\n                        }\n                    }\n                }\n            }\n            if (nxtEle.classList.contains('e-zero')) {\n                setWidthAndHeight(curEleH, -1, isCol);\n            }\n            else {\n                if (curEle.classList.contains('e-zero') || curEle.classList.contains('e-zero-start')) {\n                    setWidthAndHeight(nxtEleH, 1, isCol);\n                }\n            }\n            if (curEle.classList.contains('e-zero')) {\n                curEle.classList.remove('e-zero');\n            }\n            if (curEle.classList.contains('e-zero-start')) {\n                curEle.classList.remove('e-zero-start');\n            }\n            if (curEleC.classList.contains('e-zero')) {\n                curEleC.classList.remove('e-zero');\n            }\n            if (curEleC.classList.contains('e-zero-start')) {\n                curEleC.classList.remove('e-zero-start');\n            }\n            if (curEle.classList.contains('e-zero-last')) {\n                curEle.classList.remove('e-zero-last');\n            }\n            if (curEleC.classList.contains('e-zero-last')) {\n                curEleC.classList.remove('e-zero-last');\n            }\n            if (preEle.classList.contains('e-zero') || preEle.classList.contains('e-zero-start')) {\n                preEle.classList.add('e-zero-last');\n                preEleC.classList.add('e-zero-last');\n            }\n        }\n        else if (preEle) {\n            if (preEle.classList.contains('e-zero')) {\n                if (curEle.classList.contains('e-zero')) {\n                    if (isCol) {\n                        curEleH.style.width = parseInt(curEleH.style.width, 10) - 1 + 'px';\n                        preEleH.style.width = parseInt(preEleH.style.width, 10) + 2 + 'px';\n                    }\n                    else {\n                        curEleH.style.height = parseInt(curEleH.style.height, 10) - 1 + 'px';\n                        preEleH.style.height = parseInt(preEleH.style.height, 10) + 2 + 'px';\n                    }\n                }\n                else {\n                    setWidthAndHeight(curEleH, -1, isCol);\n                }\n            }\n            else {\n                if (curEle.classList.contains('e-zero')) {\n                    setWidthAndHeight(preEleH, 1, isCol);\n                }\n                else {\n                    setWidthAndHeight(curEleH, -1, isCol);\n                }\n            }\n            if (curEle.classList.contains('e-zero')) {\n                curEle.classList.remove('e-zero');\n            }\n            if (curEle.classList.contains('e-zero-end')) {\n                curEle.classList.remove('e-zero-end');\n            }\n            if (curEleC.classList.contains('e-zero')) {\n                curEleC.classList.remove('e-zero');\n            }\n            if (curEleC.classList.contains('e-zero-end')) {\n                curEleC.classList.remove('e-zero-end');\n            }\n        }\n        else if (nxtEle) {\n            if (nxtEle.classList.contains('e-zero')) {\n                setWidthAndHeight(curEleH, -1, isCol);\n            }\n            else if (curEle.classList.contains('e-zero-start')) {\n                setWidthAndHeight(nxtEleH, 1, isCol);\n                curEle.classList.remove('e-zero-start');\n            }\n            if (curEle.classList.contains('e-zero')) {\n                curEle.classList.remove('e-zero');\n            }\n            if (curEleC.classList.contains('e-zero')) {\n                curEleC.classList.remove('e-zero');\n            }\n            if (curEle.classList.contains('e-zero-start')) {\n                curEle.classList.remove('e-zero-start');\n            }\n            if (curEleC.classList.contains('e-zero-start')) {\n                curEleC.classList.remove('e-zero-start');\n            }\n        }\n    }\n}\n/**\n * @hidden\n */\nexport function setWidthAndHeight(trgt, value, isCol) {\n    if (isCol) {\n        trgt.style.width = parseInt(trgt.style.width, 10) + value + 'px';\n    }\n    else {\n        trgt.style.height = parseInt(trgt.style.height, 10) + value + 'px';\n    }\n}\n/**\n * @hidden\n */\nexport function findMaxValue(table, text, isCol, parent) {\n    var myTableDiv = parent.createElement('div', { className: parent.element.className });\n    var myTable = parent.createElement('table', {\n        className: table.className + 'e-resizetable',\n        styles: 'width: auto;height: auto'\n    });\n    var myTr = parent.createElement('tr');\n    if (isCol) {\n        text.forEach(function (element) {\n            var tr = myTr.cloneNode();\n            tr.appendChild(element);\n            myTable.appendChild(tr);\n        });\n    }\n    else {\n        text.forEach(function (element) {\n            myTr.appendChild(element.cloneNode(true));\n        });\n        myTable.appendChild(myTr);\n    }\n    myTableDiv.appendChild(myTable);\n    document.body.appendChild(myTableDiv);\n    var offsetWidthValue = myTable.getBoundingClientRect().width;\n    var offsetHeightValue = myTable.getBoundingClientRect().height;\n    document.body.removeChild(myTableDiv);\n    if (isCol) {\n        return Math.ceil(offsetWidthValue);\n    }\n    else {\n        return Math.ceil(offsetHeightValue);\n    }\n}\n/**\n * @hidden\n */\n/* tslint:disable no-any */\nexport function updateAction(options, spreadsheet, isCutRedo) {\n    var eventArgs = options.eventArgs;\n    switch (options.action) {\n        case 'sorting':\n            var args = {\n                range: options.eventArgs.range,\n                sortOptions: options.eventArgs.sortOptions,\n                cancel: false\n            };\n            var promise = new Promise(function (resolve, reject) {\n                resolve((function () { })());\n            });\n            var sortArgs = { args: args, promise: promise };\n            spreadsheet.notify(initiateSort, sortArgs);\n            sortArgs.promise.then(function (args) {\n                spreadsheet.serviceLocator.getService('cell').refreshRange(getIndexesFromAddress(args.range));\n            });\n            break;\n        case 'cellSave':\n            var cellEvtArgs = options.eventArgs;\n            var cellValue = eventArgs.formula ? { formula: cellEvtArgs.formula } : { value: cellEvtArgs.value };\n            spreadsheet.updateCell(cellValue, cellEvtArgs.address);\n            break;\n        case 'format':\n            if (eventArgs.requestType === 'CellFormat') {\n                spreadsheet.cellFormat(eventArgs.style, eventArgs.range);\n            }\n            else {\n                spreadsheet.numberFormat(eventArgs.format, eventArgs.range);\n            }\n            break;\n        case 'clipboard':\n            if (eventArgs.copiedInfo.isCut && !isCutRedo) {\n                return;\n            }\n            var clipboardPromise = eventArgs.copiedInfo.isCut ? spreadsheet.cut(eventArgs.copiedRange)\n                : spreadsheet.copy(eventArgs.copiedRange);\n            clipboardPromise.then(function (args) {\n                spreadsheet.paste(eventArgs.pastedRange, eventArgs.type);\n            });\n            break;\n        case 'gridLines':\n            spreadsheet.sheets[eventArgs.sheetIdx - 1].showGridLines = eventArgs.isShow;\n            break;\n        case 'headers':\n            spreadsheet.sheets[eventArgs.sheetIdx - 1].showHeaders = eventArgs.isShow;\n            break;\n        case 'resize':\n        case 'resizeToFit':\n            if (eventArgs.isCol) {\n                spreadsheet.setColWidth(eventArgs.width, eventArgs.index, eventArgs.sheetIdx);\n            }\n            else {\n                spreadsheet.setRowHeight(eventArgs.height, eventArgs.index, eventArgs.sheetIdx);\n            }\n            break;\n        case 'addSheet':\n            spreadsheet.notify(addSheetTab, {\n                text: eventArgs.text, isAction: true, count: eventArgs.sheetCount,\n                previousIndex: eventArgs.previousIndex\n            });\n            break;\n        case 'renameSheet':\n            spreadsheet.sheets[eventArgs.index - 1].name = eventArgs.value;\n            break;\n        case 'removeSheet':\n            spreadsheet.notify(removeSheetTab, {\n                index: eventArgs.index,\n                isAction: true,\n                count: eventArgs.sheetCount,\n                clicked: true\n            });\n            break;\n    }\n}\n","/**\n * Specifies Workbook internal events.\n */\n/** @hidden */\nexport var workbookDestroyed = 'workbookDestroyed';\n/** @hidden */\nexport var updateSheetFromDataSource = 'updateSheetFromDataSource';\n/** @hidden */\nexport var dataSourceChanged = 'dataSourceChanged';\n/** @hidden */\nexport var workbookOpen = 'workbookOpen';\n/** @hidden */\nexport var beginSave = 'beginSave';\n/** @hidden */\nexport var saveCompleted = 'saveCompleted';\n/** @hidden */\nexport var applyNumberFormatting = 'applyNumber';\n/** @hidden */\nexport var getFormattedCellObject = 'getFormattedCell';\n/** @hidden */\nexport var refreshCellElement = 'refreshCellElem';\n/** @hidden */\nexport var setCellFormat = 'setCellFormat';\n/** @hidden */\nexport var textDecorationUpdate = 'textDecorationUpdate';\n/** @hidden */\nexport var applyCellFormat = 'applyCellFormat';\n/** @hidden */\nexport var updateUsedRange = 'updateUsedRange';\n/** @hidden */\nexport var workbookFormulaOperation = 'workbookFormulaOperation';\n/** @hidden */\nexport var workbookEditOperation = 'workbookEditOperation';\n/** @hidden */\nexport var checkDateFormat = 'checkDateFormat';\n/** @hidden */\nexport var getFormattedBarText = 'getFormattedBarText';\n/** @hidden */\nexport var activeCellChanged = 'activeCellChanged';\n/** @hidden */\nexport var openSuccess = 'openSuccess';\n/** @hidden */\nexport var openFailure = 'openFailure';\n/** @hidden */\nexport var sheetCreated = 'sheetCreated';\n/** @hidden */\nexport var sheetsDestroyed = 'sheetsDestroyed';\n/** @hidden */\nexport var aggregateComputation = 'aggregateComputation';\n/** @hidden */\nexport var beforeSort = 'beforeSort';\n/** @hidden */\nexport var initiateSort = 'initiateSort';\n/** @hidden */\nexport var sortComplete = 'sortComplete';\n/** @hidden */\nexport var sortRangeAlert = 'sortRangeAlert';\n/** @hidden */\nexport var initiatelink = 'initiatelink';\n/** @hidden */\nexport var beforeHyperlinkCreate = 'beforeHyperlinkCreate';\n/** @hidden */\nexport var afterHyperlinkCreate = 'afterHyperlinkCreate';\n/** @hidden */\nexport var beforeHyperlinkClick = 'beforeHyperlinkCreate';\n/** @hidden */\nexport var afterHyperlinkClick = 'afterHyperlinkCreate';\n/** @hidden */\nexport var addHyperlink = 'addHyperlink';\n/** @hidden */\nexport var setLinkModel = 'setLinkModel';\n/** @hidden */\nexport var beforeFilter = 'beforeFilter';\n/** @hidden */\nexport var initiateFilter = 'initiateFilter';\n/** @hidden */\nexport var filterComplete = 'filterComplete';\n/** @hidden */\nexport var filterRangeAlert = 'filterRangeAlert';\n/** @hidden */\nexport var clearAllFilter = 'clearAllFilter';\n","import { DataManager, Query, Deferred } from '@syncfusion/ej2-data';\nimport { getCell, setCell } from '../base/index';\nimport { getRangeIndexes, checkIsFormula, updateSheetFromDataSource, checkDateFormat, dataSourceChanged } from '../common/index';\nimport { getFormatFromType } from './number-format';\n/**\n * Data binding module\n */\nvar DataBind = /** @class */ (function () {\n    function DataBind(parent) {\n        this.parent = parent;\n        this.addEventListener();\n    }\n    DataBind.prototype.addEventListener = function () {\n        this.parent.on(updateSheetFromDataSource, this.updateSheetFromDataSourceHandler, this);\n        this.parent.on(dataSourceChanged, this.dataSourceChangedHandler, this);\n    };\n    /**\n     * Destroys the Data binding module.\n     * @return {void}\n     */\n    DataBind.prototype.destroy = function () {\n        this.removeEventListener();\n        this.parent = null;\n    };\n    DataBind.prototype.removeEventListener = function () {\n        if (!this.parent.isDestroyed) {\n            this.parent.off(updateSheetFromDataSource, this.updateSheetFromDataSourceHandler);\n            this.parent.off(dataSourceChanged, this.dataSourceChangedHandler);\n        }\n    };\n    /**\n     * Update given data source to sheet.\n     */\n    DataBind.prototype.updateSheetFromDataSourceHandler = function (args) {\n        var _this = this;\n        var cell;\n        var flds;\n        var sCellIdx;\n        var result;\n        var remoteUrl;\n        var isLocal;\n        var dataManager;\n        var requestedRange = [];\n        var sRanges = [];\n        var rowIdx;\n        var deferred = new Deferred();\n        var sRowIdx;\n        var sColIdx;\n        var loadedInfo;\n        args.promise = deferred.promise;\n        if (args.sheet && args.sheet.rangeSettings.length) {\n            var _loop_1 = function (k) {\n                var sRange = args.indexes[0];\n                var eRange = args.indexes[2];\n                var range = args.sheet.rangeSettings[k];\n                sRowIdx = getRangeIndexes(range.startCell)[0];\n                dataManager = range.dataSource instanceof DataManager ? range.dataSource\n                    : range.dataSource ? new DataManager(range.dataSource) : new DataManager();\n                remoteUrl = remoteUrl || dataManager.dataSource.url;\n                args.sheet.isLocalData = isLocal || !dataManager.dataSource.url;\n                if (sRowIdx <= sRange) {\n                    sRange = sRange - sRowIdx;\n                }\n                else {\n                    if (sRowIdx <= eRange) {\n                        eRange = eRange - sRowIdx;\n                        sRange = 0;\n                    }\n                    else {\n                        sRange = -1;\n                    }\n                }\n                if (range.showFieldAsHeader && sRange !== 0) {\n                    sRange -= 1;\n                }\n                var isEndReached = false;\n                this_1.initRangeInfo(range);\n                var count = this_1.getMaxCount(range);\n                loadedInfo = this_1.getLoadedInfo(sRange, eRange, range);\n                sRange = loadedInfo.unloadedRange[0];\n                eRange = loadedInfo.unloadedRange[1];\n                if (sRange > count) {\n                    isEndReached = true;\n                }\n                else if (eRange > count) {\n                    eRange = count;\n                }\n                if (sRange >= 0 && loadedInfo.isNotLoaded && !isEndReached) {\n                    sRanges[k] = sRange;\n                    requestedRange.push(false);\n                    var query = (range.query ? range.query : new Query()).clone();\n                    dataManager.executeQuery(query.range(sRange, eRange >= count ? eRange : eRange + 1)\n                        .requiresCount()).then(function (e) {\n                        if (!_this.parent || _this.parent.isDestroyed) {\n                            return;\n                        }\n                        result = (e.result && e.result.result ? e.result.result : e.result);\n                        if (result.length) {\n                            range.info.count = e.count;\n                            flds = Object.keys(result[0]);\n                            range.info.fldLen = flds.length;\n                            sCellIdx = getRangeIndexes(range.startCell);\n                            sRowIdx = sCellIdx[0];\n                            sColIdx = sCellIdx[1];\n                            if (sRanges[k] === 0 && range.showFieldAsHeader) {\n                                flds.forEach(function (field, i) {\n                                    cell = getCell(sRowIdx + sRanges[k], sColIdx + i, args.sheet, true);\n                                    if (!cell) {\n                                        args.sheet.rows[sRowIdx + sRanges[k]].cells[sColIdx + i] = { value: field };\n                                    }\n                                    else if (!cell.value) {\n                                        cell.value = field;\n                                    }\n                                });\n                            }\n                            result.forEach(function (item, i) {\n                                for (var j = 0; j < flds.length; j++) {\n                                    rowIdx = sRowIdx + sRanges[k] + i + (range.showFieldAsHeader ? 1 : 0);\n                                    cell = getCell(rowIdx, sColIdx + j, args.sheet, true);\n                                    if (cell) {\n                                        if (!cell.value) {\n                                            setCell(rowIdx, sColIdx + j, args.sheet, _this.getCellDataFromProp(item[flds[j]]), true);\n                                        }\n                                    }\n                                    else {\n                                        args.sheet.rows[rowIdx]\n                                            .cells[sColIdx + j] = _this.getCellDataFromProp(item[flds[j]]);\n                                    }\n                                    _this.checkDataForFormat({\n                                        args: args, cell: cell, colIndex: sColIdx + j, rowIndex: rowIdx, i: i, j: j, k: k,\n                                        range: range, sRanges: sRanges, value: item[flds[j]]\n                                    });\n                                }\n                            });\n                        }\n                        args.sheet.usedRange.rowIndex =\n                            Math.max(sRowIdx + (count || e.count) + (range.showFieldAsHeader ? 1 : 0), args.sheet.usedRange.rowIndex);\n                        args.sheet.usedRange.colIndex = Math.max(sColIdx + flds.length - 1, args.sheet.usedRange.colIndex);\n                        range.info.loadedRange.push([sRange, eRange]);\n                        requestedRange[k] = true;\n                        if (requestedRange.indexOf(false) === -1) {\n                            if (remoteUrl) {\n                                _this.updateSheetFromDataSourceHandler({\n                                    sheet: args.sheet, indexes: [0, 0, args.sheet.usedRange.rowIndex, args.sheet.usedRange.colIndex],\n                                    promise: new Promise(function (resolve) { resolve((function () { })()); })\n                                });\n                            }\n                            deferred.resolve();\n                        }\n                    });\n                }\n                else if (k === 0 && requestedRange.indexOf(false) === -1) {\n                    deferred.resolve();\n                }\n            };\n            var this_1 = this;\n            for (var k = args.sheet.rangeSettings.length - 1; k >= 0; k--) {\n                _loop_1(k);\n            }\n        }\n        else {\n            deferred.resolve();\n        }\n    };\n    DataBind.prototype.getCellDataFromProp = function (prop) {\n        var data = {};\n        if (Object.prototype.toString.call(prop) === '[object Object]') {\n            if (prop.formula) {\n                data.formula = prop.formula;\n            }\n            else if (prop.value) {\n                data.value = prop.value;\n            }\n        }\n        else {\n            if (checkIsFormula(prop)) {\n                data.formula = prop;\n            }\n            else {\n                data.value = prop;\n            }\n        }\n        return data;\n    };\n    DataBind.prototype.checkDataForFormat = function (args) {\n        if (args.value !== '') {\n            var dateEventArgs = {\n                value: args.value,\n                rowIndex: args.rowIndex,\n                colIndex: args.colIndex,\n                isDate: false,\n                updatedVal: args.value,\n                isTime: false\n            };\n            this.parent.notify(checkDateFormat, dateEventArgs);\n            if (dateEventArgs.isDate) {\n                if (args.cell) {\n                    args.cell.format = getFormatFromType('ShortDate');\n                    args.cell.value = dateEventArgs.updatedVal;\n                }\n                else {\n                    args.args.sheet.rows[args.rowIndex]\n                        .cells[args.colIndex].format = getFormatFromType('ShortDate');\n                    args.args.sheet.rows[args.rowIndex]\n                        .cells[args.colIndex].value = dateEventArgs.updatedVal;\n                }\n            }\n            else if (dateEventArgs.isTime) {\n                if (args.cell) {\n                    args.cell.format = getFormatFromType('Time');\n                    args.cell.value = dateEventArgs.updatedVal;\n                }\n                else {\n                    args.args.sheet.rows[args.rowIndex]\n                        .cells[args.colIndex].format = getFormatFromType('Time');\n                    args.args.sheet.rows[args.rowIndex]\n                        .cells[args.colIndex].value = dateEventArgs.updatedVal;\n                }\n            }\n        }\n    };\n    DataBind.prototype.getLoadedInfo = function (sRange, eRange, range) {\n        var isNotLoaded = true;\n        range.info.loadedRange.forEach(function (range) {\n            if (range[0] <= sRange && sRange <= range[1]) {\n                if (range[0] <= eRange && eRange <= range[1]) {\n                    isNotLoaded = false;\n                }\n                else {\n                    sRange = range[1] + 1;\n                }\n            }\n            else if (range[0] <= eRange && eRange <= range[1]) {\n                eRange = range[0] - 1;\n            }\n        });\n        return { isNotLoaded: isNotLoaded, unloadedRange: [sRange, eRange] };\n    };\n    DataBind.prototype.getMaxCount = function (range) {\n        if (range.query) {\n            var query = range.query.queries;\n            for (var i = 0; i < query.length; i++) {\n                if (query[i].fn === 'onTake') {\n                    return Math.min(query[i].e.nos, range.info.count || query[i].e.nos);\n                }\n            }\n        }\n        return range.info.count;\n    };\n    DataBind.prototype.initRangeInfo = function (range) {\n        if (!range.info) {\n            range.info = { loadedRange: [] };\n        }\n    };\n    /**\n     * Remove old data from sheet.\n     */\n    DataBind.prototype.dataSourceChangedHandler = function (args) {\n        var oldSheet = args.oldProp.sheets[args.sheetIdx];\n        var row;\n        var sheet = this.parent.sheets[args.sheetIdx];\n        var oldRange = oldSheet && oldSheet.rangeSettings && oldSheet.rangeSettings[args.rangeIdx];\n        if (oldRange) {\n            var indexes_1 = getRangeIndexes(oldRange.startCell);\n            sheet.rangeSettings[args.rangeIdx].info.loadedRange = [];\n            oldRange.info.loadedRange.forEach(function (range) {\n                for (var i = range[0]; i < range[1]; i++) {\n                    row = sheet.rows[i + indexes_1[0]];\n                    for (var j = indexes_1[1]; j < indexes_1[1] + oldRange.info.fldLen; j++) {\n                        row.cells[j].value = '';\n                    }\n                }\n            });\n        }\n        this.parent.notify('data-refresh', { sheetIdx: args.sheetIdx });\n    };\n    /**\n     * For internal use only - Get the module name.\n     * @private\n     */\n    DataBind.prototype.getModuleName = function () {\n        return 'dataBind';\n    };\n    return DataBind;\n}());\nexport { DataBind };\n","/**\n * Specifies spreadsheet internal events\n */\n/** @hidden */\nexport var ribbon = 'ribbon';\n/** @hidden */\nexport var formulaBar = 'formulaBar';\n/** @hidden */\nexport var sheetTabs = 'sheetTabs';\n/** @hidden */\nexport var refreshSheetTabs = 'refreshSheetTabs';\n/** @hidden */\nexport var dataRefresh = 'dataRefresh';\n/** @hidden */\nexport var initialLoad = 'initialLoad';\n/** @hidden */\nexport var contentLoaded = 'contentLoaded';\n/** @hidden */\nexport var mouseDown = 'mouseDown';\n/** @hidden */\nexport var spreadsheetDestroyed = 'spreadsheetDestroyed';\n/** @hidden */\nexport var editOperation = 'editOperation';\n/** @hidden */\nexport var formulaOperation = 'formulaOperation';\n/** @hidden */\nexport var formulaBarOperation = 'formulaBarOperation';\n/** @hidden */\nexport var click = 'click';\n/** @hidden */\nexport var keyUp = 'keyUp';\n/** @hidden */\nexport var keyDown = 'keyDown';\n/** @hidden */\nexport var formulaKeyUp = 'formulaKeyUp';\n/** @hidden */\nexport var formulaBarUpdate = 'formulaBarUpdate';\n/** @hidden */\nexport var onVerticalScroll = 'verticalScroll';\n/** @hidden */\nexport var onHorizontalScroll = 'horizontalScroll';\n/** @hidden */\nexport var beforeContentLoaded = 'beforeContentLoaded';\n/** @hidden */\nexport var beforeVirtualContentLoaded = 'beforeVirtualContentLoaded';\n/** @hidden */\nexport var virtualContentLoaded = 'virtualContentLoaded';\n/** @hidden */\nexport var contextMenuOpen = 'contextMenuOpen';\n/** @hidden */\nexport var cellNavigate = 'cellNavigate';\n/** @hidden */\nexport var mouseUpAfterSelection = 'mouseUpAfterSelection';\n/** @hidden */\nexport var selectionComplete = 'selectionComplete';\n/** @hidden */\nexport var cMenuBeforeOpen = 'contextmenuBeforeOpen';\n/** @hidden */\nexport var addSheetTab = 'addSheetTab';\n/** @hidden */\nexport var removeSheetTab = 'removeSheetTab';\n/** @hidden */\nexport var renameSheetTab = 'renameSheetTab';\n/** @hidden */\nexport var ribbonClick = 'ribboClick';\n/** @hidden */\nexport var refreshRibbon = 'ribbonRefresh';\n/** @hidden */\nexport var enableRibbonItems = 'enableRibbonItems';\n/** @hidden */\nexport var tabSwitch = 'tabSwitch';\n/** @hidden */\nexport var selectRange = 'selectRange';\n/** @hidden */\nexport var cut = 'cut';\n/** @hidden */\nexport var copy = 'copy';\n/** @hidden */\nexport var paste = 'paste';\n/** @hidden */\nexport var clearCopy = 'clearCopy';\n/** @hidden */\nexport var dataBound = 'dataBound';\n/** @hidden */\nexport var beforeDataBound = 'beforeDataBound';\n/** @hidden */\nexport var addContextMenuItems = 'addContextMenuItems';\n/** @hidden */\nexport var removeContextMenuItems = 'removeContextMenuItems';\n/** @hidden */\nexport var enableContextMenuItems = 'enableContextMenuItems';\n/** @hidden */\nexport var beforeRibbonCreate = 'beforeRibbonCreate';\n/** @hidden */\nexport var rowHeightChanged = 'rowHeightChanged';\n/** @hidden */\nexport var colWidthChanged = 'colWidthChanged';\n/** @hidden */\nexport var beforeHeaderLoaded = 'beforeHeaderLoaded';\n/** @hidden */\nexport var onContentScroll = 'onContentScroll';\n/** @hidden */\nexport var deInitProperties = 'deInitProperties';\n/** @hidden */\nexport var activeSheetChanged = 'activeSheetChanged';\n/** @hidden */\nexport var renameSheet = 'renameSheet';\n/** @hidden */\nexport var enableToolbar = 'enableToolbar';\n/** @hidden */\nexport var initiateCustomSort = 'initiateCustomSort';\n/** @hidden */\nexport var applySort = 'applySort';\n/** @hidden */\nexport var collaborativeUpdate = 'collaborativeUpdate';\n/** @hidden */\nexport var hideShowRow = 'hideShowRow';\n/** @hidden */\nexport var hideShowCol = 'hideShowCol';\n/** @hidden */\nexport var autoFit = 'autoFitRowsColumns';\n/** @hidden */\nexport var updateToggleItem = 'updateToggleItem';\n/** @hidden */\nexport var initiateHyperlink = 'initiateHyperlink';\n/** @hidden */\nexport var editHyperlink = 'editHyperlink';\n/** @hidden */\nexport var openHyperlink = 'openHyperlink';\n/** @hidden */\nexport var removeHyperlink = 'removeHyperlink';\n/** @hidden */\nexport var createHyperlinkElement = 'createHyperlinkElement';\n/** @hidden */\nexport var sheetNameUpdate = 'sheetNameUpdate';\n/** @hidden */\nexport var performUndoRedo = 'performUndoRedo';\n/** @hidden */\nexport var updateUndoRedoCollection = 'updateUndoRedoCollection';\n/** @hidden */\nexport var setActionData = 'setActionData';\n/** @hidden */\nexport var getBeforeActionData = 'getBeforeActionData';\n/** @hidden */\nexport var clearUndoRedoCollection = 'clearUndoRedoCollection';\n/** @hidden */\nexport var initiateFilterUI = 'initiateFilterUI';\n/** @hidden */\nexport var renderFilterCell = 'renderFilterCell';\n/** @hidden */\nexport var reapplyFilter = 'reapplyFilter';\n/** @hidden */\nexport var filterByCellValue = 'filterByCellValue';\n/** @hidden */\nexport var clearFilter = 'clearFilter';\n/** @hidden */\nexport var getFilteredColumn = 'getFilteredColumn';\n/** @hidden */\nexport var completeAction = 'actionComplete';\n/** @hidden */\nexport var beginAction = 'actionBegin';\n/** @hidden */\nexport var filterCellKeyDown = 'filterCellKeyDown';\n/** @hidden */\nexport var getFilterRange = 'getFilterRange';\n","/**\n * Open properties.\n */\nimport { isUndefined } from '@syncfusion/ej2-base';\nimport { workbookOpen, openSuccess, openFailure, sheetsDestroyed, workbookFormulaOperation, sheetCreated } from '../common/index';\nimport { getMaxSheetId } from '../base/index';\nimport { beginAction } from '../../spreadsheet/common/event';\nvar WorkbookOpen = /** @class */ (function () {\n    function WorkbookOpen(parent) {\n        this.parent = parent;\n        this.addEventListener();\n    }\n    /**\n     * To open the excel file stream or excel url into the spreadsheet.\n     * @param {OpenOptions} options - Options to open a excel file.\n     */\n    WorkbookOpen.prototype.open = function (options) {\n        var _this = this;\n        if (!this.parent.allowOpen) {\n            return;\n        }\n        var formData = new FormData();\n        if (options.file) {\n            formData.append('file', options.file);\n        }\n        else {\n            this.parent.isOpen = false;\n            return;\n        }\n        var eventArgs = {\n            file: options.file || null,\n            cancel: false,\n            requestData: {\n                method: 'POST',\n                body: formData\n            }\n        };\n        this.parent.trigger('beforeOpen', eventArgs);\n        this.parent.notify(beginAction, { eventArgs: eventArgs, action: 'beforeOpen' });\n        if (eventArgs.cancel) {\n            return;\n        }\n        fetch(this.parent.openUrl, eventArgs.requestData)\n            .then(function (response) {\n            if (response.ok) {\n                return response.json();\n            }\n            else {\n                return Promise.reject({\n                    status: response.status,\n                    statusText: response.statusText,\n                    url: response.url\n                });\n            }\n        })\n            .then(function (data) { return _this.fetchSuccess(data); })\n            .catch(function (error) { return _this.fetchFailure(error); });\n    };\n    WorkbookOpen.prototype.fetchFailure = function (error) {\n        if (isUndefined(error.status) && isUndefined(error.statusText)) {\n            error.statusText = 'Improper response';\n        }\n        this.parent.notify(openFailure, error);\n        this.parent.isOpen = false;\n    };\n    WorkbookOpen.prototype.fetchSuccess = function (data) {\n        var openError = ['UnsupportedFile', 'InvalidUrl'];\n        var workbookData = data;\n        workbookData = (typeof data === 'string') ? JSON.parse(data) : data;\n        /* tslint:disable-next-line:no-any */\n        var impData = workbookData.Workbook;\n        if (openError.indexOf(impData) > -1) {\n            this.parent.notify(openSuccess, {\n                context: this, data: impData\n            });\n            return;\n        }\n        this.updateModel(impData);\n        this.parent.notify(openSuccess, {\n            context: this, data: impData\n        });\n        this.parent.isOpen = false;\n    };\n    WorkbookOpen.prototype.updateModel = function (workbookModel) {\n        var _this = this;\n        this.parent.notify(workbookFormulaOperation, { action: 'unRegisterSheet' });\n        this.parent.sheetNameCount = 1;\n        this.parent.sheets = [];\n        this.parent.notify(sheetsDestroyed, {});\n        workbookModel.activeSheetTab = workbookModel.activeSheetTab || 1;\n        this.parent.setProperties({\n            'sheets': workbookModel.sheets,\n            'activeSheetTab': workbookModel.activeSheetTab,\n            'definedNames': workbookModel.definedNames || []\n        }, true);\n        this.parent.notify(sheetCreated, null);\n        this.parent.sheets.forEach(function (key) {\n            key.id = getMaxSheetId(_this.parent.sheets);\n        });\n        this.parent.notify(workbookFormulaOperation, { action: 'registerSheet' });\n        this.parent.notify(workbookFormulaOperation, { action: 'initiateDefinedNames' });\n    };\n    /**\n     * Adding event listener for workbook open.\n     */\n    WorkbookOpen.prototype.addEventListener = function () {\n        this.parent.on(workbookOpen, this.open.bind(this));\n    };\n    /**\n     * Removing event listener workbook open.\n     */\n    WorkbookOpen.prototype.removeEventListener = function () {\n        if (!this.parent.isDestroyed) {\n            this.parent.off(workbookOpen, this.open.bind(this));\n        }\n    };\n    /**\n     * To Remove the event listeners\n     */\n    WorkbookOpen.prototype.destroy = function () {\n        this.removeEventListener();\n        this.parent = null;\n    };\n    /**\n     * Get the workbook open module name.\n     */\n    WorkbookOpen.prototype.getModuleName = function () {\n        return 'workbookOpen';\n    };\n    return WorkbookOpen;\n}());\nexport { WorkbookOpen };\n","/**\n * @hidden\n * The `SaveWorker` module is used to perform save functionality with Web Worker.\n */\nvar SaveWorker = /** @class */ (function () {\n    /**\n     * Constructor for SaveWorker module in Workbook library.\n     * @private\n     */\n    function SaveWorker(parent) {\n        this.parent = parent;\n    }\n    /**\n     * Process sheet.\n     * @hidden\n     */\n    SaveWorker.prototype.processSheet = function (sheet, sheetIndex) {\n        var parsedSheet = JSON.parse(sheet, function (key, value) {\n            //Remove empty properties\n            if ((Array.isArray(value) || typeof value === 'string') && !value.length) {\n                return undefined;\n            }\n            return value;\n        });\n        return [sheetIndex, parsedSheet];\n    };\n    /**\n     * Process save action.\n     * @hidden\n     */\n    SaveWorker.prototype.processSave = function (saveJSON, saveSettings, customParams) {\n        var formData = new FormData();\n        var i;\n        var keys = Object.keys(saveSettings);\n        formData.append('JSONData', JSON.stringify(saveJSON));\n        for (i = 0; i < keys.length; i++) {\n            formData.append(keys[i], saveSettings[keys[i]]);\n        }\n        keys = Object.keys(customParams);\n        for (i = 0; i < keys.length; i++) {\n            formData.append(keys[i], customParams[keys[i]]);\n        }\n        fetch(saveSettings.url, { method: 'POST', body: formData })\n            .then(function (response) {\n            if (response.ok) {\n                return response.blob();\n            }\n            else {\n                return Promise.reject({\n                    message: response.statusText\n                });\n            }\n        })\n            .then(function (data) {\n            postMessage(data);\n        })\n            .catch(function (error) {\n            postMessage({ error: error.message });\n        });\n        // try {\n        //     let httpRequest: XMLHttpRequest = new XMLHttpRequest();\n        //     let formData: FormData = new FormData();\n        //     let i: number;\n        //     let keys: string[] = Object.keys(saveSettings);\n        //     httpRequest.onreadystatechange = (event: Event) => {\n        //         if (httpRequest.readyState === 4 && httpRequest.status === 200) {\n        //             (postMessage as Function)(httpRequest.response);\n        //         }\n        //     };\n        //     httpRequest.onerror = (event: Event) => {\n        //         (postMessage as Function)(event);\n        //     };\n        //     formData.append('JSONData', JSON.stringify(saveJSON));\n        //     for (i = 0; i < keys.length; i++) {\n        //         formData.append(keys[i], (<{ [key: string]: string }>saveSettings)[keys[i]]);\n        //     }\n        //     httpRequest.open('POST', saveSettings.saveUrl, false);\n        //     httpRequest.send(formData);\n        // } catch (e) {\n        //     (postMessage as Function)({ error: e.message });\n        // }\n    };\n    return SaveWorker;\n}());\nexport { SaveWorker };\n","var __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    }\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nimport { executeTaskAsync } from '../common/worker';\nimport * as events from '../common/event';\nimport { SaveWorker } from '../workers/save-worker';\nimport { detach } from '@syncfusion/ej2-base';\n/**\n * @hidden\n * The `WorkbookSave` module is used to handle the save action in Workbook library.\n */\nvar WorkbookSave = /** @class */ (function (_super) {\n    __extends(WorkbookSave, _super);\n    /**\n     * Constructor for WorkbookSave module in Workbook library.\n     * @private\n     */\n    function WorkbookSave(parent) {\n        var _this = _super.call(this, parent) || this;\n        _this.isProcessCompleted = false;\n        _this.saveJSON = {};\n        _this.isFullPost = false;\n        _this.needBlobData = false;\n        _this.customParams = null;\n        _this.addEventListener();\n        return _this;\n    }\n    /**\n     * Get the module name.\n     * @returns string\n     * @private\n     */\n    WorkbookSave.prototype.getModuleName = function () {\n        return 'workbookSave';\n    };\n    /**\n     * To destroy the WorkbookSave module.\n     * @return {void}\n     * @hidden\n     */\n    WorkbookSave.prototype.destroy = function () {\n        this.removeEventListener();\n        this.parent = null;\n    };\n    /**\n     * @hidden\n     */\n    WorkbookSave.prototype.addEventListener = function () {\n        this.parent.on(events.beginSave, this.initiateSave, this);\n    };\n    /**\n     * @hidden\n     */\n    WorkbookSave.prototype.removeEventListener = function () {\n        if (!this.parent.isDestroyed) {\n            this.parent.off(events.beginSave, this.initiateSave);\n        }\n    };\n    /**\n     * Initiate save process.\n     * @hidden\n     */\n    WorkbookSave.prototype.initiateSave = function (args) {\n        var saveSettings = args.saveSettings;\n        this.saveSettings = {\n            saveType: saveSettings.saveType,\n            url: saveSettings.url,\n            fileName: saveSettings.fileName || 'Sample'\n        };\n        this.isFullPost = args.isFullPost;\n        this.needBlobData = args.needBlobData;\n        if (this.needBlobData) {\n            this.isFullPost = false;\n        }\n        this.customParams = args.customParams;\n        this.updateBasicSettings();\n        this.processSheets();\n    };\n    /**\n     * Update save JSON with basic settings.\n     * @hidden\n     */\n    WorkbookSave.prototype.updateBasicSettings = function () {\n        var jsonStr = this.getStringifyObject(this.parent, ['sheets', '_isScalar', 'observers', 'closed', 'isStopped', 'hasError',\n            '__isAsync', 'beforeCellFormat', 'beforeCellRender', 'beforeDataBound', 'beforeOpen', 'beforeSave', 'beforeSelect',\n            'beforeSort', 'cellEdit', 'cellEditing', 'cellSave', 'contextMenuItemSelect', 'contextMenuBeforeClose',\n            'contextMenuBeforeOpen', 'created', 'dataBound', 'fileItemSelect', 'fileMenuBeforeClose', 'fileMenuBeforeOpen', 'openFailure',\n            'saveComplete', 'sortComplete', 'select', 'actionBegin', 'actionComplete', 'afterHyperlinkClick', 'afterHyperlinkCreate',\n            'beforeHyperlinkClick', 'beforeHyperlinkCreate', 'openComplete']);\n        var basicSettings = JSON.parse(jsonStr);\n        var sheetCount = this.parent.sheets.length;\n        var i = 0;\n        if (sheetCount) {\n            basicSettings.sheets = [];\n        }\n        this.saveJSON = basicSettings;\n    };\n    /**\n     * Process sheets properties.\n     * @hidden\n     */\n    WorkbookSave.prototype.processSheets = function () {\n        var i = 0;\n        var sheetCount = this.parent.sheets.length;\n        while (i < sheetCount) {\n            executeTaskAsync(this, this.processSheet, this.updateSheet, [this.getStringifyObject(this.parent.sheets[i]), i]);\n            i++;\n        }\n    };\n    /**\n     * Update processed sheet data.\n     * @hidden\n     */\n    WorkbookSave.prototype.updateSheet = function (data) {\n        this.saveJSON.sheets[data[0]] = data[1];\n        this.isProcessCompleted = this.getSheetLength(this.saveJSON.sheets) === this.parent.sheets.length;\n        if (this.isProcessCompleted) {\n            this.save(this.saveSettings);\n        }\n    };\n    WorkbookSave.prototype.getSheetLength = function (sheets) {\n        var len = 0;\n        sheets.forEach(function (sheet) {\n            if (sheet) {\n                len++;\n            }\n        });\n        return len;\n    };\n    /**\n     * Save process.\n     * @hidden\n     */\n    WorkbookSave.prototype.save = function (saveSettings) {\n        if (this.isFullPost) {\n            this.initiateFullPostSave();\n        }\n        else {\n            executeTaskAsync(this, { 'workerTask': this.processSave }, this.updateSaveResult, [this.saveJSON, saveSettings, this.customParams], true);\n        }\n        this.saveJSON = {};\n    };\n    /**\n     * Update final save data.\n     * @hidden\n     */\n    WorkbookSave.prototype.updateSaveResult = function (result) {\n        var args = {\n            status: 'Success',\n            message: '',\n            url: this.saveSettings.url,\n            fileName: this.saveSettings.fileName,\n            saveType: this.saveSettings.saveType,\n            blobData: null\n        };\n        if (typeof (result) === 'object' && result.error) {\n            args.status = 'Failure';\n            args.message = result.error.toString();\n        }\n        else {\n            if (this.needBlobData) {\n                args.blobData = result;\n            }\n            else {\n                this.ClientFileDownload(result, this.saveSettings.fileName);\n            }\n        }\n        this.parent.trigger('saveComplete', args);\n        this.parent.notify(events.saveCompleted, args);\n    };\n    WorkbookSave.prototype.ClientFileDownload = function (blobData, fileName) {\n        var anchor = this.parent.createElement('a', { attrs: { download: this.getFileNameWithExtension() } });\n        var url = URL.createObjectURL(blobData);\n        anchor.href = url;\n        document.body.appendChild(anchor);\n        anchor.click();\n        URL.revokeObjectURL(url);\n        document.body.removeChild(anchor);\n    };\n    WorkbookSave.prototype.initiateFullPostSave = function () {\n        var keys = Object.keys(this.saveSettings);\n        var i;\n        var formElem = this.parent.createElement('form', { attrs: { method: 'POST', action: this.saveSettings.url } });\n        var inputElem = this.parent.createElement('input', { attrs: { type: 'hidden', name: 'JSONData' } });\n        inputElem.value = JSON.stringify(this.saveJSON);\n        formElem.appendChild(inputElem);\n        for (i = 0; i < keys.length; i++) {\n            inputElem = this.parent.createElement('input', { attrs: { type: 'hidden', name: keys[i] } });\n            inputElem.value = this.saveSettings[keys[i]];\n            formElem.appendChild(inputElem);\n        }\n        keys = Object.keys(this.customParams);\n        for (i = 0; i < keys.length; i++) {\n            inputElem = this.parent.createElement('input', { attrs: { type: 'hidden', name: keys[i] } });\n            inputElem.value = this.customParams[keys[i]];\n            formElem.appendChild(inputElem);\n        }\n        document.body.appendChild(formElem);\n        formElem.submit();\n        detach(formElem);\n        this.parent.notify(events.saveCompleted, {});\n    };\n    /**\n     * Get stringified workbook object.\n     * @hidden\n     */\n    WorkbookSave.prototype.getStringifyObject = function (value, skipProp) {\n        if (skipProp === void 0) { skipProp = []; }\n        return JSON.stringify(value, function (key, value) {\n            if (skipProp.indexOf(key) > -1) {\n                return undefined;\n            }\n            else {\n                if (value && typeof value === 'object' && value.hasOwnProperty('properties')) {\n                    return value.properties;\n                }\n                else if (value !== null) {\n                    return value;\n                }\n                else {\n                    return undefined;\n                }\n            }\n        });\n    };\n    WorkbookSave.prototype.getFileNameWithExtension = function (filename) {\n        if (!filename) {\n            filename = this.saveSettings.fileName;\n        }\n        var fileExt = this.getFileExtension();\n        var idx = filename.lastIndexOf('.');\n        if (idx > -1) {\n            filename = filename.substr(0, idx);\n        }\n        return (filename + fileExt);\n    };\n    WorkbookSave.prototype.getFileExtension = function () {\n        return ('.' + this.saveSettings.saveType.toLowerCase());\n    };\n    return WorkbookSave;\n}(SaveWorker));\nexport { WorkbookSave };\n","/**\n * @hidden\n */\nexport var CommonErrors;\n(function (CommonErrors) {\n    CommonErrors[CommonErrors[\"na\"] = 0] = \"na\";\n    CommonErrors[CommonErrors[\"value\"] = 1] = \"value\";\n    CommonErrors[CommonErrors[\"ref\"] = 2] = \"ref\";\n    CommonErrors[CommonErrors[\"divzero\"] = 3] = \"divzero\";\n    CommonErrors[CommonErrors[\"num\"] = 4] = \"num\";\n    CommonErrors[CommonErrors[\"name\"] = 5] = \"name\";\n    CommonErrors[CommonErrors[\"null\"] = 6] = \"null\";\n})(CommonErrors || (CommonErrors = {}));\n/**\n * @hidden\n */\nexport var FormulasErrorsStrings;\n(function (FormulasErrorsStrings) {\n    FormulasErrorsStrings[FormulasErrorsStrings[\"operators_cannot_start_with_expression\"] = 0] = \"operators_cannot_start_with_expression\";\n    FormulasErrorsStrings[FormulasErrorsStrings[\"reservedWord_And\"] = 1] = \"reservedWord_And\";\n    FormulasErrorsStrings[FormulasErrorsStrings[\"reservedWord_Xor\"] = 2] = \"reservedWord_Xor\";\n    FormulasErrorsStrings[FormulasErrorsStrings[\"reservedWord_If\"] = 3] = \"reservedWord_If\";\n    FormulasErrorsStrings[FormulasErrorsStrings[\"number_contains_2_decimal_points\"] = 4] = \"number_contains_2_decimal_points\";\n    FormulasErrorsStrings[FormulasErrorsStrings[\"reservedWord_Else\"] = 5] = \"reservedWord_Else\";\n    FormulasErrorsStrings[FormulasErrorsStrings[\"reservedWord_Not\"] = 6] = \"reservedWord_Not\";\n    FormulasErrorsStrings[FormulasErrorsStrings[\"invalid_char_in_number\"] = 7] = \"invalid_char_in_number\";\n    FormulasErrorsStrings[FormulasErrorsStrings[\"invalid_characters_following_with_operator\"] = 6] = \"invalid_characters_following_with_operator\";\n    FormulasErrorsStrings[FormulasErrorsStrings[\"mismatched_parentheses\"] = 8] = \"mismatched_parentheses\";\n    FormulasErrorsStrings[FormulasErrorsStrings[\"unknown_formula_name\"] = 9] = \"unknown_formula_name\";\n    FormulasErrorsStrings[FormulasErrorsStrings[\"requires_a_single_argument\"] = 10] = \"requires_a_single_argument\";\n    FormulasErrorsStrings[FormulasErrorsStrings[\"requires_3_args\"] = 11] = \"requires_3_args\";\n    FormulasErrorsStrings[FormulasErrorsStrings[\"invalid_Math_argument\"] = 12] = \"invalid_Math_argument\";\n    FormulasErrorsStrings[FormulasErrorsStrings[\"requires_2_args\"] = 13] = \"requires_2_args\";\n    FormulasErrorsStrings[FormulasErrorsStrings[\"bad_index\"] = 14] = \"bad_index\";\n    FormulasErrorsStrings[FormulasErrorsStrings[\"too_complex\"] = 15] = \"too_complex\";\n    FormulasErrorsStrings[FormulasErrorsStrings[\"circular_reference\"] = 16] = \"circular_reference\";\n    FormulasErrorsStrings[FormulasErrorsStrings[\"missing_formula\"] = 17] = \"missing_formula\";\n    FormulasErrorsStrings[FormulasErrorsStrings[\"improper_formula\"] = 18] = \"improper_formula\";\n    FormulasErrorsStrings[FormulasErrorsStrings[\"invalid_expression\"] = 19] = \"invalid_expression\";\n    FormulasErrorsStrings[FormulasErrorsStrings[\"cell_empty\"] = 20] = \"cell_empty\";\n    FormulasErrorsStrings[FormulasErrorsStrings[\"bad_formula\"] = 21] = \"bad_formula\";\n    FormulasErrorsStrings[FormulasErrorsStrings[\"empty_expression\"] = 22] = \"empty_expression\";\n    FormulasErrorsStrings[FormulasErrorsStrings[\"virtual_mode_required\"] = 23] = \"virtual_mode_required\";\n    FormulasErrorsStrings[FormulasErrorsStrings[\"mismatched_tics\"] = 24] = \"mismatched_tics\";\n    FormulasErrorsStrings[FormulasErrorsStrings[\"wrong_number_arguments\"] = 25] = \"wrong_number_arguments\";\n    FormulasErrorsStrings[FormulasErrorsStrings[\"invalid_arguments\"] = 26] = \"invalid_arguments\";\n    FormulasErrorsStrings[FormulasErrorsStrings[\"iterations_do_not_converge\"] = 27] = \"iterations_do_not_converge\";\n    FormulasErrorsStrings[FormulasErrorsStrings[\"calculation_overflow\"] = 29] = \"calculation_overflow\";\n    FormulasErrorsStrings[FormulasErrorsStrings[\"already_registered\"] = 28] = \"already_registered\";\n    FormulasErrorsStrings[FormulasErrorsStrings[\"missing_sheet\"] = 30] = \"missing_sheet\";\n    FormulasErrorsStrings[FormulasErrorsStrings[\"cannot_parse\"] = 31] = \"cannot_parse\";\n    FormulasErrorsStrings[FormulasErrorsStrings[\"expression_cannot_end_with_an_operator\"] = 32] = \"expression_cannot_end_with_an_operator\";\n})(FormulasErrorsStrings || (FormulasErrorsStrings = {}));\n","import { FormulasErrorsStrings, CommonErrors } from '../common/index';\nimport { isNullOrUndefined, getValue } from '@syncfusion/ej2-base';\n/**\n * Represents the basic formulas module.\n */\nvar BasicFormulas = /** @class */ (function () {\n    function BasicFormulas(parent) {\n        this.formulas = [\n            { formulaName: 'SUM', category: 'Math & Trig', description: 'Sums individual values, cell references or ranges.' },\n            {\n                formulaName: 'SUMIFS', category: 'Math & Trig',\n                description: 'Sums the cells specified by a given set of conditionsor criteria.'\n            },\n            { formulaName: 'ABS', category: 'Math & Trig', description: 'Returns the absolute value of a number.' },\n            { formulaName: 'RAND', category: 'Math & Trig', description: 'Return a random number between 0 and 1.' },\n            { formulaName: 'FLOOR', category: 'Math & Trig', description: 'Returns the round a number down to the nearest integer.' },\n            { formulaName: 'CEILING', category: 'Math & Trig', description: 'Returns a number rounded up to a multiple of another number.' },\n            {\n                formulaName: 'SUMIF', category: 'Math & Trig',\n                description: 'It will sum up cells that meet the given criteria.'\n            },\n            {\n                formulaName: 'PRODUCT', category: 'Math & Trig',\n                description: 'Multiplies all the numbers given as arguments and returns the product.'\n            },\n            {\n                formulaName: 'AVERAGE', category: 'Statistical',\n                description: 'The sum of the numbers divided by how many numbers are being averaged.'\n            },\n            {\n                formulaName: 'AVERAGEIF', category: 'Statistical',\n                description: 'Computes the average of the numbers in a range that meet the supplied criteria.'\n            },\n            {\n                formulaName: 'COUNT', category: 'Statistical',\n                description: 'Counts the numbers in the list of arguments, exclude text entries.'\n            },\n            { formulaName: 'COUNTA', category: 'Statistical', description: 'Counts the non-empty values in the list of arguments.' },\n            {\n                formulaName: 'COUNTIF', category: 'Statistical',\n                description: 'Counts the number of cells in a range that meet a specified condition.'\n            },\n            {\n                formulaName: 'COUNTIFS', category: 'Statistical',\n                description: 'Counts the number of times each cells in all the ranges that meet the specific conditions.'\n            },\n            {\n                formulaName: 'AVERAGEA', category: 'Statistical',\n                description: 'Calculates the average of values in the list of arguments.Arguments can be numbers, names, arrays or references.'\n            },\n            {\n                formulaName: 'AVERAGEIFS', category: 'Statistical',\n                description: 'Conditionally returns the average of the contents of cells for the set of ranges.'\n            },\n            {\n                formulaName: 'MIN', category: 'Statistical',\n                description: 'Returns the smaller number in set of arguments.'\n            },\n            { formulaName: 'MAX', category: 'Statistical', description: 'Returns the largest number in set of arguments.' },\n            { formulaName: 'DATE', category: 'Date', description: 'Returns the date, given the year, month and day of the month.' },\n            { formulaName: 'DAY', category: 'Date', description: 'Returns the day of a given date.' },\n            { formulaName: 'DAYS', category: 'Date', description: 'Returns the number of days between two dates.' },\n            {\n                formulaName: 'IF', category: 'Logical',\n                description: 'Returns one value if a logical expression is TRUE and another if it is FALSE'\n            },\n            {\n                formulaName: 'AND', category: 'Logical',\n                description: 'Returns TRUE if all the arguments are considered TRUE, and FALSE otherwise.'\n            },\n            {\n                formulaName: 'IFS', category: 'Logical',\n                description: 'Checks multiple conditions and returns a value corresponding to the first TRUE result.'\n            },\n            {\n                formulaName: 'IFERROR', category: 'Logical',\n                description: 'Returns a value you specify if a formula evaluates to an error; otherwise, it returns the result of the formula.'\n            },\n            {\n                formulaName: 'CHOOSE', category: 'Lookup & Reference',\n                description: 'Returns a value from a list, given an index number.'\n            },\n            {\n                formulaName: 'INDEX', category: 'Lookup & Reference',\n                description: 'Returns a value from a table, given a row and column number.'\n            },\n            { formulaName: 'FIND', category: 'Text', description: 'Returns the position of a string of text within another string.' },\n            { formulaName: 'CONCATENATE', category: 'Text', description: ' Used to join two or more strings together.' },\n            { formulaName: 'CONCAT', category: 'Text', description: 'Concatenates a list or range of text strings.' },\n            { formulaName: 'SUBTOTAL', category: 'Lookup & Reference', description: 'Returns a subtotal in a list or database.' },\n            { formulaName: 'RADIANS', category: 'Math & Trig', description: 'Converts degrees to radians.' },\n            {\n                formulaName: 'OR', category: 'Logical',\n                description: 'Returns TRUE if any arguments considered TRUE, and all the arguments are FALSE it will return FALSE.'\n            },\n            {\n                formulaName: 'MATCH', category: 'Lookup & Reference',\n                description: 'Returns the relative position of an checked item in range that matches a specified value in a specified order'\n            },\n            {\n                formulaName: 'RANDBETWEEN', category: 'Math & Trig', description: 'Returns an integer random number in a specified range.'\n            }\n        ];\n        this.isConcat = false;\n        this.parent = parent;\n        this.init();\n    }\n    BasicFormulas.prototype.init = function () {\n        var fn;\n        for (var i = 0; i < this.formulas.length; i++) {\n            fn = getValue('Compute' + this.formulas[i].formulaName, this).bind(this);\n            this.addFormulaCollection(this.formulas[i].formulaName.toUpperCase(), fn, this.formulas[i].category, this.formulas[i].description);\n        }\n    };\n    BasicFormulas.prototype.addFormulaCollection = function (formulaName, functionName, formulaCategory, description) {\n        this.parent.libraryFormulas = {\n            fName: formulaName, handler: functionName, category: formulaCategory,\n            description: description\n        };\n    };\n    /** @hidden */\n    BasicFormulas.prototype.ComputeSUM = function () {\n        var args = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            args[_i] = arguments[_i];\n        }\n        if (isNullOrUndefined(args) || (args.length === 1 && args[0] === '')) {\n            return this.parent.formulaErrorStrings[FormulasErrorsStrings.invalid_arguments];\n        }\n        var sum = 0;\n        var val;\n        var orgValue;\n        if (!isNullOrUndefined(args)) {\n            var argArr = args;\n            for (var i = 0; i < argArr.length; i++) {\n                var argValue = argArr[i].toString();\n                if (argValue.indexOf(':') > -1 && this.parent.isCellReference(argValue)) {\n                    var cellCollection = this.parent.getCellCollection(argValue.split(this.parent.tic).join(''));\n                    for (var j = 0; j < cellCollection.length; j++) {\n                        val = this.parent.getValueFromArg(cellCollection[j]);\n                        if (this.parent.getErrorStrings().indexOf(val) > -1) {\n                            return val;\n                        }\n                        if (isNullOrUndefined(val[0]) || isNaN(this.parent.parseFloat(val))) {\n                            continue;\n                        }\n                        sum = sum + this.parent.parseFloat(val);\n                    }\n                }\n                else {\n                    if (argArr[i].split(this.parent.tic).join('') === this.parent.trueValue) {\n                        argArr[i] = '1';\n                    }\n                    if (argArr[i].split(this.parent.tic).join('') === this.parent.falseValue) {\n                        argArr[i] = '0';\n                    }\n                    orgValue = this.parent.getValueFromArg(argArr[i].split(this.parent.tic).join(''));\n                    if (this.parent.getErrorStrings().indexOf(orgValue) > -1) {\n                        return orgValue;\n                    }\n                    if (isNullOrUndefined(orgValue) || isNaN(this.parent.parseFloat(orgValue))) {\n                        continue;\n                    }\n                    if (orgValue.length > 0) {\n                        sum = sum + this.parent.parseFloat(orgValue + '');\n                    }\n                }\n            }\n        }\n        return sum;\n    };\n    /** @hidden */\n    BasicFormulas.prototype.ComputeCOUNT = function () {\n        var args = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            args[_i] = arguments[_i];\n        }\n        if (isNullOrUndefined(args) || (args.length === 1 && args[0] === '')) {\n            return this.parent.formulaErrorStrings[FormulasErrorsStrings.wrong_number_arguments];\n        }\n        var argArr = args;\n        var argVal;\n        var cellColl;\n        var result = 0;\n        var cellValue;\n        for (var i = 0; i < argArr.length; i++) {\n            argVal = argArr[i];\n            if (argVal.indexOf(':') > -1 && this.parent.isCellReference(argVal)) {\n                cellColl = this.parent.getCellCollection(argVal.split(this.parent.tic).join(''));\n                for (var j = 0; j < cellColl.length; j++) {\n                    cellValue = this.parent.getValueFromArg(cellColl[j]);\n                    if (!isNaN(this.parent.parseFloat(cellValue))) {\n                        if (argVal.length > 0 && argVal !== '' && argVal !== ' ') {\n                            result++;\n                        }\n                    }\n                }\n            }\n            else {\n                argVal = argVal.split(this.parent.tic).join('');\n                if (!isNaN(this.parent.parseFloat(this.parent.getValueFromArg(argVal)))) {\n                    if (argVal.length > 0 && argVal !== '' && argVal !== ' ') {\n                        result++;\n                    }\n                }\n            }\n        }\n        return result;\n    };\n    /** @hidden */\n    BasicFormulas.prototype.ComputeDATE = function () {\n        var args = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            args[_i] = arguments[_i];\n        }\n        if (isNullOrUndefined(args) || (args.length === 1 && args[0] === '')) {\n            return this.parent.formulaErrorStrings[FormulasErrorsStrings.wrong_number_arguments];\n        }\n        var argArr = args;\n        if (argArr.length !== 3) {\n            return this.parent.formulaErrorStrings[FormulasErrorsStrings.wrong_number_arguments];\n        }\n        for (var i = 0; i < argArr.length; ++i) {\n            argArr[i] = this.parent.getValueFromArg(argArr[i]);\n        }\n        /* tslint:disable */\n        argArr[0] = (argArr[0].split(this.parent.tic).join('') === 'TRUE') ? '1' : (argArr[0].split(this.parent.tic).join('') === 'FALSE') ? '0' : argArr[0];\n        argArr[1] = (argArr[1].split(this.parent.tic).join('') === 'TRUE') ? '1' : (argArr[1].split(this.parent.tic).join('') === 'FALSE') ? '0' : argArr[1];\n        argArr[2] = (argArr[2].split(this.parent.tic).join('') === 'TRUE') ? '1' : (argArr[2].split(this.parent.tic).join('') === 'FALSE') ? '0' : argArr[2];\n        /* tslint:enable */\n        var year = this.parent.parseFloat(argArr[0].split(this.parent.tic).join(''));\n        var month = this.parent.parseFloat(argArr[1].split(this.parent.tic).join(''));\n        var day = this.parent.parseFloat(argArr[2].split(this.parent.tic).join(''));\n        var days = 0;\n        if (!isNaN(year) && !isNaN(month) && !isNaN(day)) {\n            if (year < 0) {\n                return this.parent.getErrorStrings()[CommonErrors.num].toString();\n            }\n            while (month > 12) {\n                month -= 12;\n                year++;\n            }\n            days = this.parent.getSerialDateFromDate(year, month, day);\n        }\n        else {\n            return this.parent.getErrorStrings()[CommonErrors.value].toString();\n        }\n        if (days === 0) {\n            return this.parent.getErrorStrings()[CommonErrors.num].toString();\n        }\n        var date = this.parent.fromOADate(days);\n        if (date.toString() !== 'Invalid Date') {\n            /* tslint:disable-next-line */\n            return date.getFullYear() + '/' + this.parent.calculateDate((date.getMonth() + 1).toString()) + '/' + this.parent.calculateDate(date.getDate().toString());\n        }\n        return days.toString();\n    };\n    /** @hidden */\n    BasicFormulas.prototype.ComputeFLOOR = function () {\n        var args = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            args[_i] = arguments[_i];\n        }\n        if (isNullOrUndefined(args) || (args.length === 1 && args[0] === '')) {\n            return this.parent.formulaErrorStrings[FormulasErrorsStrings.invalid_arguments];\n        }\n        var argArr = args;\n        var argCount = argArr.length;\n        var splitArg = argArr[1].split(this.parent.tic).join('');\n        var argValue = [];\n        var fnum;\n        var significance;\n        if (argCount !== 2) {\n            return this.parent.formulaErrorStrings[FormulasErrorsStrings.wrong_number_arguments];\n        }\n        argValue.push(fnum = this.parent.parseFloat(this.parent.getValueFromArg(argArr[0].split(this.parent.tic).join(''))));\n        argArr[1] = (splitArg === this.parent.trueValue) ? '1' : (splitArg === this.parent.falseValue) ? '0' : argArr[1];\n        argValue.push(significance = this.parent.parseFloat(this.parent.getValueFromArg(argArr[1].split(this.parent.tic).join(''))));\n        if (fnum > 0 && significance < 0) {\n            return this.parent.getErrorStrings()[CommonErrors.num];\n        }\n        if (fnum > 0 && significance === 0) {\n            return this.parent.getErrorStrings()[CommonErrors.divzero];\n        }\n        for (var i = 0; i < argArr.length; i++) {\n            if (argArr[i].indexOf(this.parent.tic) > -1) {\n                return this.parent.getErrorStrings()[CommonErrors.value];\n            }\n        }\n        if (isNaN(fnum)) {\n            return this.parent.getErrorStrings()[CommonErrors.name];\n        }\n        return Math.floor(fnum / significance) * significance;\n    };\n    /** @hidden */\n    BasicFormulas.prototype.ComputeCEILING = function () {\n        var args = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            args[_i] = arguments[_i];\n        }\n        if (isNullOrUndefined(args) || (args.length === 1 && args[0] === '')) {\n            return this.parent.formulaErrorStrings[FormulasErrorsStrings.invalid_arguments];\n        }\n        var argArr = args;\n        var orgValue = [];\n        var argCount = argArr.length;\n        var splitArg = argArr[1].split(this.parent.tic).join('');\n        var cnum;\n        var significance;\n        if (argCount !== 2) {\n            return this.parent.formulaErrorStrings[FormulasErrorsStrings.wrong_number_arguments];\n        }\n        orgValue.push(cnum = this.parent.parseFloat(this.parent.getValueFromArg(argArr[0].split(this.parent.tic).join(''))));\n        argArr[1] = (splitArg === this.parent.trueValue) ? '1' : (splitArg === this.parent.falseValue) ? '0' : argArr[1];\n        orgValue.push(significance = this.parent.parseFloat(this.parent.getValueFromArg(argArr[1].split(this.parent.tic).join(''))));\n        if (cnum > 0 && significance < 0) {\n            return this.parent.getErrorStrings()[CommonErrors.num];\n        }\n        for (var i = 0; i < argArr.length; i++) {\n            if (argArr[i].indexOf(this.parent.tic) > -1) {\n                return this.parent.getErrorStrings()[CommonErrors.value];\n            }\n        }\n        if (isNaN(cnum)) {\n            return this.parent.getErrorStrings()[CommonErrors.name];\n        }\n        if (significance === 0) {\n            return 0;\n        }\n        return Math.ceil(cnum / significance) * significance;\n    };\n    /** @hidden */\n    BasicFormulas.prototype.ComputeDAY = function () {\n        var serialNumber = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            serialNumber[_i] = arguments[_i];\n        }\n        var date = serialNumber;\n        var result;\n        if (isNullOrUndefined(date) || (date.length === 1 && date[0] === '')) {\n            return this.parent.formulaErrorStrings[FormulasErrorsStrings.invalid_arguments];\n        }\n        if (date.length > 1) {\n            return this.parent.formulaErrorStrings[FormulasErrorsStrings.wrong_number_arguments];\n        }\n        var dateVal = this.parent.getValueFromArg(date[0].split(this.parent.tic).join(''));\n        if (!isNaN(this.parent.parseFloat(dateVal))) {\n            return this.parent.getErrorStrings()[CommonErrors.name];\n        }\n        else {\n            dateVal = dateVal;\n        }\n        result = this.parent.parseDate(dateVal);\n        if (Object.prototype.toString.call(result) === '[object Date]') {\n            /* tslint:disable-next-line */\n            result = result.getDate();\n        }\n        return result;\n    };\n    /** @hidden */\n    BasicFormulas.prototype.ComputeIF = function () {\n        var args = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            args[_i] = arguments[_i];\n        }\n        if (isNullOrUndefined(args) || (args.length === 1 && args[0] === '')) {\n            return this.parent.formulaErrorStrings[FormulasErrorsStrings.invalid_arguments];\n        }\n        if (this.parent.getErrorStrings().indexOf(args[0]) > 0) {\n            return args[0];\n        }\n        var argArr = args;\n        var condition;\n        var result;\n        if (argArr.length > 3 || argArr.length === 1) {\n            return this.parent.formulaErrorStrings[FormulasErrorsStrings.wrong_number_arguments];\n        }\n        else if (argArr.length <= 3) {\n            condition = this.parent.getValueFromArg(argArr[0]);\n            if (this.parent.getErrorStrings().indexOf(condition) > -1) {\n                return condition;\n            }\n            if (condition === this.parent.trueValue || this.parent.parseFloat(condition) > 0 || this.parent.parseFloat(condition) < 0) {\n                result = this.parent.getValueFromArg(argArr[1]);\n            }\n            else if (condition === this.parent.falseValue || this.parent.parseFloat(condition) === 0) {\n                if (isNullOrUndefined(argArr[2])) {\n                    return this.parent.falseValue;\n                }\n                result = this.parent.getValueFromArg(argArr[2]);\n            }\n            else {\n                return this.parent.formulaErrorStrings[FormulasErrorsStrings.requires_3_args];\n            }\n        }\n        if (result.indexOf(this.parent.tic) > -1) {\n            return result.split(this.parent.tic).join('');\n        }\n        else {\n            return result;\n        }\n    };\n    /** @hidden */\n    BasicFormulas.prototype.ComputeIFERROR = function () {\n        var args = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            args[_i] = arguments[_i];\n        }\n        if (isNullOrUndefined(args) || (args.length === 1 && args[0] === '')) {\n            return this.parent.formulaErrorStrings[FormulasErrorsStrings.invalid_arguments];\n        }\n        var argArr = args;\n        var condition;\n        if (argArr.length !== 2) {\n            return this.parent.formulaErrorStrings[FormulasErrorsStrings.wrong_number_arguments];\n        }\n        condition = this.parent.getValueFromArg(argArr[0]);\n        if (condition === this.parent.trueValue || condition === this.parent.falseValue) {\n            return condition;\n        }\n        if (condition[0] === this.parent.arithMarker) {\n            condition = condition.replace(this.parent.arithMarker, ' ');\n        }\n        condition = this.parent.getValueFromArg(condition).toUpperCase().split(this.parent.tic).join('');\n        if (condition[0] === '#' || condition.indexOf('Infinity') > -1 || this.parent.getErrorStrings().indexOf(condition) > -1) {\n            return this.parent.getValueFromArg(argArr[1]).split(this.parent.tic).join('');\n        }\n        else {\n            return condition;\n        }\n    };\n    /** @hidden */\n    BasicFormulas.prototype.ComputePRODUCT = function () {\n        var range = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            range[_i] = arguments[_i];\n        }\n        if (isNullOrUndefined(range) || (range.length === 1 && range[0] === '')) {\n            return this.parent.formulaErrorStrings[FormulasErrorsStrings.invalid_arguments];\n        }\n        var product = 1;\n        var val;\n        var orgValue;\n        var argsHit = true;\n        var parseVal;\n        if (!isNullOrUndefined(range)) {\n            var argArr = range;\n            for (var i = 0; i < argArr.length; i++) {\n                var rangevalue = argArr[i];\n                if (rangevalue.indexOf(':') > -1 && this.parent.isCellReference(rangevalue)) {\n                    var cellCollection = this.parent.getCellCollection(rangevalue);\n                    for (var j = 0; j < cellCollection.length; j++) {\n                        val = this.parent.getValueFromArg(cellCollection[j].split(this.parent.tic).join(''));\n                        if (this.parent.getErrorStrings().indexOf(val) > -1) {\n                            return val;\n                        }\n                        val = (val.split(this.parent.tic).join('') === 'TRUE') ? '1' :\n                            (val.split(this.parent.tic).join('') === 'FALSE') ? '0' : val;\n                        parseVal = this.parent.parseFloat(val);\n                        if (!isNaN(parseVal)) {\n                            if (val.length > 0) {\n                                product = product * parseVal;\n                                argsHit = false;\n                            }\n                        }\n                    }\n                }\n                else {\n                    orgValue = this.parent.getValueFromArg(argArr[i].split(this.parent.tic).join(''));\n                    if (this.parent.getErrorStrings().indexOf(orgValue) > -1) {\n                        return orgValue;\n                    }\n                    orgValue = (orgValue.split(this.parent.tic).join('') === 'TRUE') ? '1' :\n                        (orgValue.split(this.parent.tic).join('') === 'FALSE') ? '0' : orgValue;\n                    parseVal = this.parent.parseFloat(orgValue);\n                    if (!isNaN(parseVal)) {\n                        if (orgValue.length > 0) {\n                            product = product * parseVal;\n                            argsHit = false;\n                        }\n                    }\n                    if (this.parent.getErrorStrings().indexOf(orgValue) > -1) {\n                        return orgValue;\n                    }\n                }\n            }\n        }\n        return argsHit ? '0' : product.toString();\n    };\n    /** @hidden */\n    BasicFormulas.prototype.ComputeDAYS = function () {\n        var range = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            range[_i] = arguments[_i];\n        }\n        var result;\n        if (isNullOrUndefined(range) && (range.length === 1 && range[0] === '')) {\n            return this.parent.formulaErrorStrings[FormulasErrorsStrings.invalid_arguments];\n        }\n        if (range.length !== 2) {\n            return this.parent.formulaErrorStrings[FormulasErrorsStrings.wrong_number_arguments];\n        }\n        var argsArr = range;\n        if (argsArr[0].split(this.parent.tic).join('') === this.parent.trueValue) {\n            argsArr[0] = '1';\n        }\n        if (argsArr[0].split(this.parent.tic).join('') === this.parent.falseValue) {\n            argsArr[0] = '0';\n        }\n        var endDate = this.parent.getValueFromArg(argsArr[0].split(this.parent.tic).join(''));\n        var startDate = this.parent.getValueFromArg(argsArr[1].split(this.parent.tic).join(''));\n        startDate = (startDate === '' || startDate == null) ? new Date(Date.parse('1899-12-31')).toDateString() : startDate;\n        endDate = (endDate === '' || endDate == null) ? new Date(Date.parse('1899-12-31')).toDateString() : endDate;\n        if (endDate[0] === '#') {\n            return endDate;\n        }\n        if (startDate[0] === '#') {\n            return startDate;\n        }\n        var d1 = this.parent.parseDate(endDate);\n        var d2 = this.parent.parseDate(startDate);\n        if (d1.toString()[0] === '#') {\n            return d1.toString();\n        }\n        if (d2.toString()[0] === '#') {\n            return d2.toString();\n        }\n        if (Object.prototype.toString.call(d1) === '[object Date]' && Object.prototype.toString.call(d2) === '[object Date]') {\n            /* tslint:disable-next-line */\n            result = Math.ceil(d1.getTime() - d2.getTime()) / (1000 * 3600 * 24);\n        }\n        else {\n            return this.parent.getErrorStrings()[CommonErrors.value];\n        }\n        return Math.round(result);\n    };\n    /** @hidden */\n    BasicFormulas.prototype.ComputeCHOOSE = function () {\n        var args = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            args[_i] = arguments[_i];\n        }\n        if (isNullOrUndefined(args) || (args.length === 1 && args[0] === '')) {\n            return this.parent.formulaErrorStrings[FormulasErrorsStrings.invalid_arguments];\n        }\n        if (args.length < 2) {\n            return this.parent.formulaErrorStrings[FormulasErrorsStrings.wrong_number_arguments];\n        }\n        var argsArr = args;\n        if (argsArr[0].indexOf(':') > -1 && this.parent.isCellReference(argsArr[0])) {\n            var cellCollection = this.parent.getCellCollection(argsArr[0]);\n            if (cellCollection.length === 1) {\n                argsArr[0] = cellCollection[0];\n            }\n            else {\n                return this.parent.getErrorStrings()[CommonErrors.value];\n            }\n        }\n        var cond = this.parent.getValueFromArg(argsArr[0]);\n        if (this.parent.getErrorStrings().indexOf(cond) > -1) {\n            return cond;\n        }\n        var indexNum = this.parent.parseFloat(this.parent.getValueFromArg(argsArr[0].split(this.parent.tic).join('')));\n        if (indexNum < 1) {\n            return this.parent.getErrorStrings()[CommonErrors.value];\n        }\n        indexNum = Math.floor(indexNum);\n        var result;\n        if (isNullOrUndefined(argsArr[indexNum])) {\n            return this.parent.getErrorStrings()[CommonErrors.value];\n        }\n        result = argsArr[indexNum];\n        if (result === '') {\n            result = '0';\n        }\n        if (result.indexOf(':') > -1 && this.parent.isCellReference(result)) {\n            var cellCollection = this.parent.getCellCollection(argsArr[0].split(this.parent.tic).join(''));\n            if (cellCollection.length === 1) {\n                argsArr[0] = cellCollection[0];\n            }\n            else {\n                return this.parent.getErrorStrings()[CommonErrors.value];\n            }\n        }\n        return this.parent.getValueFromArg(result).split(this.parent.tic).join('');\n    };\n    /** @hidden */\n    BasicFormulas.prototype.ComputeSUMIF = function () {\n        var range = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            range[_i] = arguments[_i];\n        }\n        var argArr = range;\n        if (argArr[0].indexOf(':') < 0 && !this.parent.isCellReference(argArr[0])) {\n            return this.parent.formulaErrorStrings[FormulasErrorsStrings.improper_formula];\n        }\n        var result = this.parent.computeSumIfAndAvgIf(range);\n        if (typeof result === 'string' && (this.parent.formulaErrorStrings.indexOf(result)\n            || this.parent.getErrorStrings().indexOf(result))) {\n            return result;\n        }\n        return result[0];\n    };\n    /** @hidden */\n    BasicFormulas.prototype.ComputeABS = function () {\n        var absValue = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            absValue[_i] = arguments[_i];\n        }\n        var argArr = absValue;\n        var cellvalue = '';\n        var absVal;\n        if (absValue.length === 0 || absValue.length > 1) {\n            return this.parent.formulaErrorStrings[FormulasErrorsStrings.wrong_number_arguments];\n        }\n        if (argArr[0].toString().split(this.parent.tic).join('').trim() === '' || argArr[0].indexOf(this.parent.tic) > -1) {\n            return this.parent.getErrorStrings()[CommonErrors.value];\n        }\n        if (this.parent.isCellReference(argArr[0])) {\n            cellvalue = this.parent.getValueFromArg(argArr[0]);\n            if (cellvalue === '') {\n                return this.parent.getErrorStrings()[CommonErrors.name];\n            }\n            absVal = this.parent.parseFloat(cellvalue);\n            if (isNaN(absVal)) {\n                return this.parent.getErrorStrings()[CommonErrors.value];\n            }\n        }\n        else {\n            absVal = this.parent.parseFloat(argArr[0]);\n            if (isNaN(absVal)) {\n                return this.parent.getErrorStrings()[CommonErrors.name];\n            }\n        }\n        return Math.abs(absVal);\n    };\n    /** @hidden */\n    BasicFormulas.prototype.ComputeAVERAGE = function () {\n        var args = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            args[_i] = arguments[_i];\n        }\n        if (isNullOrUndefined(args) || (args.length === 1 && args[0] === '')) {\n            return this.parent.formulaErrorStrings[FormulasErrorsStrings.invalid_arguments];\n        }\n        var argArr = args;\n        for (var i = 0; i < argArr.length; i++) {\n            if (argArr[i].indexOf(':') > -1) {\n                if (argArr[i].indexOf(this.parent.tic) > -1) {\n                    return this.parent.getErrorStrings()[CommonErrors.value];\n                }\n            }\n        }\n        return this.parent.calculateAvg(argArr);\n    };\n    /** @hidden */\n    BasicFormulas.prototype.ComputeAVERAGEIF = function () {\n        var range = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            range[_i] = arguments[_i];\n        }\n        var argList = range;\n        if (argList[0].indexOf(':') < 0 && !this.parent.isCellReference(argList[0])) {\n            return this.parent.formulaErrorStrings[FormulasErrorsStrings.improper_formula];\n        }\n        var resultVal = this.parent.computeSumIfAndAvgIf(range);\n        if (typeof resultVal === 'string' && (this.parent.formulaErrorStrings.indexOf(resultVal)\n            || this.parent.getErrorStrings().indexOf(resultVal))) {\n            return resultVal;\n        }\n        return this.parent.parseFloat(resultVal[0]) / this.parent.parseFloat(resultVal[1]);\n    };\n    /** @hidden */\n    BasicFormulas.prototype.ComputeCONCATENATE = function () {\n        var range = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            range[_i] = arguments[_i];\n        }\n        if (isNullOrUndefined(range) || (range.length === 1 && range[0] === '')) {\n            return this.parent.formulaErrorStrings[FormulasErrorsStrings.invalid_arguments];\n        }\n        var argsList = range;\n        var result = '';\n        var tempStr = '';\n        for (var i = 0; i < argsList.length; i++) {\n            if (argsList[i].indexOf(':') > -1 && this.parent.isCellReference(argsList[i])) {\n                if (this.isConcat) {\n                    var cells = this.parent.getCellCollection(argsList[i]);\n                    for (var i_1 = 0; i_1 < cells.length; i_1++) {\n                        tempStr = this.parent.getValueFromArg(cells[i_1]);\n                        result = result + tempStr;\n                    }\n                }\n                else {\n                    return this.parent.getErrorStrings()[CommonErrors.value];\n                }\n            }\n            else {\n                if (argsList.length === 1 && argsList[0].indexOf(this.parent.tic) < 0) {\n                    return this.parent.getErrorStrings()[CommonErrors.name];\n                }\n                else {\n                    tempStr = this.parent.getValueFromArg(argsList[i]);\n                    result = result + tempStr;\n                }\n            }\n            if (this.parent.getErrorStrings().indexOf(tempStr) > -1) {\n                return tempStr;\n            }\n        }\n        return result.split(this.parent.tic).join('');\n    };\n    /** @hidden */\n    BasicFormulas.prototype.ComputeCONCAT = function () {\n        var range = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            range[_i] = arguments[_i];\n        }\n        this.isConcat = true;\n        return this.ComputeCONCATENATE.apply(this, range);\n    };\n    /** @hidden */\n    BasicFormulas.prototype.ComputeMAX = function () {\n        var args = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            args[_i] = arguments[_i];\n        }\n        return this.parent.computeMinMax(args, 'max');\n    };\n    /** @hidden */\n    BasicFormulas.prototype.ComputeMIN = function () {\n        var args = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            args[_i] = arguments[_i];\n        }\n        return this.parent.computeMinMax(args, 'min');\n    };\n    /** @hidden */\n    BasicFormulas.prototype.ComputeRAND = function () {\n        var args = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            args[_i] = arguments[_i];\n        }\n        if (args.length === 1 && args[0] === '') {\n            args.length = 0;\n        }\n        if (args.length > 0) {\n            return this.parent.formulaErrorStrings[FormulasErrorsStrings.wrong_number_arguments];\n        }\n        return Math.random().toString();\n    };\n    /** @hidden */\n    BasicFormulas.prototype.ComputeAND = function () {\n        var args = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            args[_i] = arguments[_i];\n        }\n        return this.parent.computeAndOr(args, 'and');\n    };\n    /** @hidden */\n    BasicFormulas.prototype.ComputeOR = function () {\n        var args = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            args[_i] = arguments[_i];\n        }\n        return this.parent.computeAndOr(args, 'or');\n    };\n    /** @hidden */\n    BasicFormulas.prototype.ComputeFIND = function () {\n        var args = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            args[_i] = arguments[_i];\n        }\n        if (isNullOrUndefined(args) || (args.length === 1 && args[0] === '')) {\n            return this.parent.formulaErrorStrings[FormulasErrorsStrings.wrong_number_arguments];\n        }\n        var argsList = args;\n        if (argsList.length > 3) {\n            return this.parent.formulaErrorStrings[FormulasErrorsStrings.wrong_number_arguments];\n        }\n        var findText = this.parent.removeTics(this.parent.getValueFromArg(argsList[0]));\n        var withinText = this.parent.removeTics(this.parent.getValueFromArg(argsList[1]));\n        if (this.parent.getErrorStrings().indexOf(findText) > -1 || this.parent.getErrorStrings().indexOf(withinText) > -1) {\n            return this.parent.getErrorStrings()[CommonErrors.name];\n        }\n        var startNum = 1;\n        var loc;\n        if (argsList.length === 3) {\n            startNum = this.parent.removeTics(this.parent.getValueFromArg(argsList[2]));\n            if (this.parent.getErrorStrings().indexOf(startNum) > -1) {\n                return startNum;\n            }\n            startNum = this.parent.parseFloat(startNum);\n            if (isNaN(startNum)) {\n                startNum = 1;\n            }\n        }\n        if (startNum <= 0 || startNum > withinText.length) {\n            return this.parent.getErrorStrings()[CommonErrors.value];\n        }\n        loc = withinText.indexOf(findText, startNum - 1);\n        if (loc < 0) {\n            return this.parent.getErrorStrings()[CommonErrors.value];\n        }\n        return (Number(loc) + Number(1)).toString();\n    };\n    /** @hidden */\n    BasicFormulas.prototype.ComputeINDEX = function () {\n        var range = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            range[_i] = arguments[_i];\n        }\n        var argArr = range;\n        var argCount = argArr.length;\n        if (isNullOrUndefined(range) || (argArr.length === 1 && argArr[0] === '')) {\n            return this.parent.formulaErrorStrings[FormulasErrorsStrings.wrong_number_arguments];\n        }\n        if (argCount > 3) {\n            return this.parent.getErrorStrings()[CommonErrors.ref];\n        }\n        var rangeValue = '';\n        var rangeArr = [];\n        if (argCount > 2) {\n            for (var i_2 = 0; i_2 < argCount; i_2++) {\n                if (this.parent.isCellReference(argArr[i_2]) && argArr[i_2].indexOf(':') < 0) {\n                    return this.parent.getErrorStrings()[CommonErrors.ref];\n                }\n                if (this.parent.isCellReference(argArr[i_2])) {\n                    rangeArr[i_2] = argArr[i_2];\n                }\n            }\n        }\n        rangeValue = argArr[0];\n        argArr[1] = argArr[1] === '' ? '1' : argArr[1];\n        argArr[1] = this.parent.getValueFromArg(argArr[1]);\n        if (this.parent.getErrorStrings().indexOf(argArr[1]) > -1) {\n            return argArr[1];\n        }\n        if (!isNullOrUndefined(argArr[2])) {\n            argArr[2] = argArr[2] === '' ? '1' : argArr[2];\n            argArr[2] = this.parent.getValueFromArg(argArr[2]);\n            if (this.parent.getErrorStrings().indexOf(argArr[2]) > -1) {\n                return argArr[2];\n            }\n            if (argArr[2] === '0') {\n                return this.parent.getErrorStrings()[CommonErrors.value];\n            }\n        }\n        var row = parseFloat(argArr[1]);\n        row = !isNaN(row) ? row : -1;\n        var col = parseFloat(argArr[2] ? argArr[2] : '1');\n        col = !isNaN(col) ? col : -1;\n        if (row === -1 || col === -1) {\n            return this.parent.getErrorStrings()[CommonErrors.value];\n        }\n        var i = argArr[0].indexOf(':');\n        var startRow = this.parent.rowIndex(rangeValue.substring(0, i));\n        var endRow = this.parent.rowIndex(rangeValue.substring(i + 1));\n        var startCol = this.parent.colIndex(rangeValue.substring(0, i));\n        var endCol = this.parent.colIndex(rangeValue.substring(i + 1));\n        if (row > endRow - startRow + 1 || col > endCol - startCol + 1) {\n            return this.parent.getErrorStrings()[CommonErrors.ref];\n        }\n        row = startRow + row - 1;\n        col = startCol + col - 1;\n        var cellRef = '' + this.parent.convertAlpha(col) + row;\n        var result = this.parent.getValueFromArg(cellRef);\n        if (result === '') {\n            return 0;\n        }\n        return result;\n    };\n    /** @hidden */\n    BasicFormulas.prototype.ComputeIFS = function () {\n        var range = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            range[_i] = arguments[_i];\n        }\n        var argArr = range;\n        if (isNullOrUndefined(range) || (argArr.length === 1 && argArr[0] === '')) {\n            return this.parent.formulaErrorStrings[FormulasErrorsStrings.wrong_number_arguments];\n        }\n        var condition = '';\n        var result = '';\n        for (var i = 0; i < argArr.length; i++) {\n            condition = this.parent.getValueFromArg(argArr[i]);\n            if (condition !== this.parent.trueValue && condition !== this.parent.falseValue) {\n                return this.parent.getErrorStrings()[CommonErrors.value];\n            }\n            if (condition === this.parent.trueValue) {\n                if (argArr[i + 1].indexOf(this.parent.arithMarker) > -1) {\n                    return this.parent.trueValue;\n                }\n                if (this.parent.isCellReference(argArr[i + 1].split(this.parent.tic).join(''))) {\n                    result = this.parent.getValueFromArg(argArr[i + 1]);\n                }\n                else {\n                    result = (argArr[i + 1].indexOf(this.parent.tic) > -1) ? argArr[i + 1].split(this.parent.tic).join('') :\n                        this.parent.getErrorStrings()[CommonErrors.name];\n                }\n                i = i + 1;\n                return result;\n            }\n            else if (condition === this.parent.falseValue) {\n                i = i + 1;\n            }\n        }\n        return this.parent.getErrorStrings()[CommonErrors.na];\n    };\n    /** @hidden */\n    BasicFormulas.prototype.ComputeCOUNTA = function () {\n        var args = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            args[_i] = arguments[_i];\n        }\n        if (isNullOrUndefined(args) || (args.length === 1 && args[0] === '')) {\n            return this.parent.formulaErrorStrings[FormulasErrorsStrings.wrong_number_arguments];\n        }\n        var argArr = args;\n        var cellColl;\n        var result = 0;\n        var cellValue;\n        for (var i = 0; i < argArr.length; i++) {\n            if (argArr[i].indexOf(':') > -1 && this.parent.isCellReference(argArr[i])) {\n                cellColl = this.parent.getCellCollection(argArr[i].split(this.parent.tic).join(''));\n                for (var j = 0; j < cellColl.length; j++) {\n                    cellValue = this.parent.getValueFromArg(cellColl[j]);\n                    if (cellValue.length > 0) {\n                        result++;\n                    }\n                }\n            }\n            else {\n                var cellValue_1 = this.parent.getValueFromArg(argArr[i].split(this.parent.tic).join(''));\n                if (cellValue_1.length > 0) {\n                    result++;\n                }\n            }\n        }\n        return result;\n    };\n    /** @hidden */\n    BasicFormulas.prototype.ComputeAVERAGEA = function () {\n        var args = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            args[_i] = arguments[_i];\n        }\n        if (isNullOrUndefined(args) || (args.length === 1 && args[0] === '')) {\n            return this.parent.formulaErrorStrings[FormulasErrorsStrings.wrong_number_arguments];\n        }\n        var argArrs = args;\n        var cellCol;\n        var result = 0;\n        var cellValue;\n        var length = 0;\n        var parseValue;\n        for (var k = 0; k < argArrs.length; k++) {\n            if (argArrs[k].indexOf(':') > -1 && this.parent.isCellReference(argArrs[k])) {\n                cellCol = this.parent.getCellCollection(argArrs[k].split(this.parent.tic).join(''));\n                for (var j = 0; j < cellCol.length; j++) {\n                    cellValue = this.parent.getValueFromArg(cellCol[j]);\n                    if (cellValue.toUpperCase() === this.parent.trueValue) {\n                        cellValue = '1';\n                    }\n                    else if (cellValue.toUpperCase() === this.parent.falseValue || cellValue === '') {\n                        cellValue = '0';\n                    }\n                    else if (this.parent.getErrorStrings().indexOf(cellValue) > -1) {\n                        return cellValue;\n                    }\n                    else if (cellValue.length > 0) {\n                        parseValue = parseFloat(cellValue);\n                        cellValue = !isNaN(parseValue) ? parseValue : 0;\n                        result = result + cellValue;\n                        length = length + 1;\n                    }\n                }\n                length = cellCol.length;\n            }\n            else {\n                if (argArrs[k] === this.parent.trueValue) {\n                    argArrs[k] = '1';\n                }\n                if (argArrs[k] === this.parent.falseValue || argArrs[k] === '') {\n                    argArrs[k] = '0';\n                }\n                cellValue = this.parent.getValueFromArg(argArrs[k].split(this.parent.tic).join(''));\n                if (this.parent.getErrorStrings().indexOf(cellValue) > -1) {\n                    return cellValue;\n                }\n                if (cellValue.length > 0) {\n                    parseValue = parseFloat(cellValue);\n                    cellValue = !isNaN(parseValue) ? parseValue : 0;\n                    result = result + cellValue;\n                    length = length + 1;\n                }\n            }\n            if (length === 0) {\n                return this.parent.getErrorStrings()[CommonErrors.divzero];\n            }\n        }\n        return result / length;\n    };\n    /** @hidden */\n    BasicFormulas.prototype.ComputeCOUNTIF = function () {\n        var args = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            args[_i] = arguments[_i];\n        }\n        var argArr = args;\n        if (isNullOrUndefined(args) || args[0] === '' || argArr.length < 2) {\n            return this.parent.formulaErrorStrings[FormulasErrorsStrings.wrong_number_arguments];\n        }\n        var cellColl;\n        var result = 0;\n        var cellValue;\n        var stack = [];\n        var op = 'equal';\n        var condition = argArr[1].split(this.parent.tic).join('');\n        if (condition.startsWith('<=')) {\n            op = 'lessEq';\n            condition = condition.substring(2);\n        }\n        else if (condition.startsWith('>=')) {\n            op = 'greaterEq';\n            condition = condition.substring(2);\n        }\n        else if (condition.startsWith('<>')) {\n            op = 'notEq';\n            condition = condition.substring(2);\n        }\n        else if (condition.startsWith('<')) {\n            op = 'less';\n            condition = condition.substring(1);\n        }\n        else if (condition.startsWith('>')) {\n            op = 'greater';\n            condition = condition.substring(1);\n        }\n        else if (condition.startsWith('=')) {\n            op = 'equal';\n            condition = condition.substring(1);\n        }\n        if (argArr[0].indexOf(':') > -1 && this.parent.isCellReference(argArr[0])) {\n            cellColl = this.parent.getCellCollection(argArr[0].split(this.parent.tic).join(''));\n            for (var j = 0; j < cellColl.length; j++) {\n                cellValue = this.parent.getValueFromArg(cellColl[j]);\n                if (condition.indexOf('*') > -1 || condition.indexOf('?') > -1) {\n                    cellValue = this.parent.findWildCardValue(condition, cellValue);\n                }\n                stack.push(cellValue);\n                stack.push(condition);\n                if (this.parent.processLogical(stack, op) === this.parent.trueValue) {\n                    result++;\n                }\n            }\n        }\n        return result;\n    };\n    /** @hidden */\n    BasicFormulas.prototype.ComputeSUMIFS = function () {\n        var range = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            range[_i] = arguments[_i];\n        }\n        var sum;\n        sum = this.parent.computeIfsFormulas(range, this.parent.falseValue);\n        return sum;\n    };\n    /** @hidden */\n    BasicFormulas.prototype.ComputeCOUNTIFS = function () {\n        var args = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            args[_i] = arguments[_i];\n        }\n        var sum;\n        sum = this.parent.computeIfsFormulas(args, this.parent.trueValue);\n        return sum;\n    };\n    /** @hidden */\n    BasicFormulas.prototype.ComputeAVERAGEIFS = function () {\n        var args = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            args[_i] = arguments[_i];\n        }\n        var sum;\n        sum = this.parent.computeIfsFormulas(args, this.parent.falseValue, this.parent.trueValue);\n        return sum;\n    };\n    /** @hidden */\n    BasicFormulas.prototype.ComputeMATCH = function () {\n        var args = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            args[_i] = arguments[_i];\n        }\n        var argArr = args;\n        if (isNullOrUndefined(argArr) || (argArr.length === 1 && argArr[0] === '') || argArr.length < 2 || argArr.length > 3) {\n            return this.parent.formulaErrorStrings[FormulasErrorsStrings.wrong_number_arguments];\n        }\n        var cellColl;\n        var cellValue = [];\n        var lookupVal = argArr[0].split(this.parent.tic).join('');\n        argArr[2] = isNullOrUndefined(argArr[2]) ? '1' : argArr[2].split(this.parent.tic).join('');\n        if (argArr[2].split(this.parent.tic).join('') === this.parent.trueValue) {\n            argArr[2] = '1';\n        }\n        if (argArr[2].split(this.parent.tic).join('') === this.parent.falseValue) {\n            argArr[2] = '0';\n        }\n        var matchType = parseFloat(argArr[2]);\n        if (matchType !== -1 && matchType !== 0 && matchType !== 1) {\n            return this.parent.getErrorStrings()[CommonErrors.na];\n        }\n        var index = 0;\n        var indexVal = '';\n        if (argArr[1].indexOf(':') > -1 || this.parent.isCellReference(argArr[1])) {\n            cellColl = this.parent.getCellCollection(argArr[1].split(this.parent.tic).join(''));\n            for (var j = 0; j < cellColl.length; j++) {\n                cellValue[j] = this.parent.getValueFromArg(cellColl[j]).split(this.parent.tic).join('');\n            }\n            for (var i = 0; i < cellValue.length; i++) {\n                if (matchType === 1) {\n                    if (lookupVal === cellValue[i]) {\n                        return i + 1;\n                    }\n                    else if (lookupVal > cellValue[i]) {\n                        if (!indexVal) {\n                            index = i + 1;\n                            indexVal = cellValue[i];\n                        }\n                        else if (cellValue[i] > indexVal) {\n                            index = i + 1;\n                            indexVal = cellValue[i];\n                        }\n                    }\n                }\n                else if (matchType === 0) {\n                    if (lookupVal.indexOf('*') > -1 || lookupVal.indexOf('?') > -1) {\n                        cellValue[i] = this.parent.findWildCardValue(lookupVal, cellValue[i]);\n                    }\n                    if (lookupVal === cellValue[i]) {\n                        return i + 1;\n                    }\n                    if (this.parent.parseFloat(lookupVal) === this.parent.parseFloat(cellValue[i])) {\n                        return i + 1;\n                    }\n                }\n                else if (matchType === -1) {\n                    if (lookupVal === cellValue[i]) {\n                        return i + 1;\n                    }\n                    else if (lookupVal < cellValue[i]) {\n                        if (!indexVal) {\n                            index = i + 1;\n                            indexVal = cellValue[i];\n                        }\n                        else if (cellValue[i] < indexVal) {\n                            index = i + 1;\n                            indexVal = cellValue[i];\n                        }\n                    }\n                }\n            }\n        }\n        return index ? index : this.parent.getErrorStrings()[CommonErrors.na];\n    };\n    /** @hidden */\n    BasicFormulas.prototype.ComputeLOOKUP = function () {\n        var range = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            range[_i] = arguments[_i];\n        }\n        var argArr = range;\n        var result = '';\n        if (isNullOrUndefined(argArr) || (argArr.length === 1 && argArr[0] === '') || argArr.length < 2 || argArr.length > 3) {\n            return this.parent.formulaErrorStrings[FormulasErrorsStrings.wrong_number_arguments];\n        }\n        result = this.parent.computeLookup(argArr);\n        return result;\n    };\n    /** @hidden */\n    BasicFormulas.prototype.ComputeVLOOKUP = function () {\n        var range = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            range[_i] = arguments[_i];\n        }\n        var argArr = range;\n        var result = '';\n        if (isNullOrUndefined(argArr) || (argArr.length === 1 && argArr[0] === '') || argArr.length < 3 || argArr.length > 4) {\n            return this.parent.formulaErrorStrings[FormulasErrorsStrings.wrong_number_arguments];\n        }\n        result = this.parent.computeVLookup(argArr);\n        return result;\n    };\n    /** @hidden */\n    BasicFormulas.prototype.ComputeSUBTOTAL = function () {\n        var range = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            range[_i] = arguments[_i];\n        }\n        var argArr = range;\n        var result = '';\n        if (argArr.length < 2) {\n            return this.parent.formulaErrorStrings[FormulasErrorsStrings.wrong_number_arguments];\n        }\n        var formula = this.parent.parseFloat(this.parent.getValueFromArg(argArr[0].split(this.parent.tic).join('')));\n        if (isNaN(formula)) {\n            this.parent.getErrorStrings()[CommonErrors.value];\n        }\n        if ((formula < 1 || formula > 11) && (formula < 101 || formula > 111)) {\n            this.parent.getErrorStrings()[CommonErrors.value];\n        }\n        var cellRef = argArr.slice(1, argArr.length);\n        switch (formula) {\n            case 1:\n            case 101:\n                result = this.ComputeAVERAGE.apply(this, cellRef);\n                break;\n            case 2:\n            case 102:\n                result = this.ComputeCOUNT.apply(this, cellRef);\n                break;\n            case 3:\n            case 103:\n                result = this.ComputeCOUNTA.apply(this, cellRef);\n                break;\n            case 4:\n            case 104:\n                result = this.ComputeMAX.apply(this, cellRef);\n                break;\n            case 5:\n            case 105:\n                result = this.ComputeMIN.apply(this, cellRef);\n                break;\n            case 6:\n            case 106:\n                result = this.ComputePRODUCT.apply(this, cellRef);\n                break;\n            case 7:\n            case 107:\n                result = this.ComputeDAY.apply(this, cellRef);\n                break;\n            case 8:\n            case 108:\n                result = this.ComputeCONCAT.apply(this, cellRef);\n                break;\n            case 9:\n            case 109:\n                result = this.ComputeSUM.apply(this, cellRef);\n                break;\n            case 10:\n            case 110:\n                result = this.ComputeAVERAGEA.apply(this, cellRef);\n                break;\n            case 11:\n            case 111:\n                result = this.ComputeABS.apply(this, cellRef);\n                break;\n            default:\n                result = this.parent.getErrorStrings()[CommonErrors.value];\n                break;\n        }\n        return result;\n    };\n    /** @hidden */\n    BasicFormulas.prototype.ComputeRADIANS = function () {\n        var range = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            range[_i] = arguments[_i];\n        }\n        var argArr = range;\n        var result;\n        if (argArr[0] === '' || argArr.length > 1) {\n            return this.parent.formulaErrorStrings[FormulasErrorsStrings.wrong_number_arguments];\n        }\n        if (argArr[0].indexOf(':') > -1 || argArr[0].split(this.parent.tic).join('') === '') {\n            return this.parent.getErrorStrings()[CommonErrors.value];\n        }\n        var val = argArr[0].split(this.parent.tic).join('');\n        argArr[0] = isNaN(this.parent.parseFloat(val)) ? argArr[0] : val;\n        var cellvalue = this.parent.getValueFromArg(argArr[0]);\n        var radVal = this.parent.parseFloat(cellvalue);\n        if (!isNaN(radVal)) {\n            result = Math.PI * (radVal) / 180;\n        }\n        else {\n            if (cellvalue.indexOf(this.parent.tic) > -1) {\n                return this.parent.getErrorStrings()[CommonErrors.value];\n            }\n            else {\n                return this.parent.getErrorStrings()[CommonErrors.name];\n            }\n        }\n        return result;\n    };\n    /** @hidden */\n    BasicFormulas.prototype.ComputeRANDBETWEEN = function () {\n        var range = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            range[_i] = arguments[_i];\n        }\n        var argsLength = range.length;\n        var min;\n        var max;\n        var argVal;\n        if (argsLength !== 2) {\n            return this.parent.formulaErrorStrings[FormulasErrorsStrings.wrong_number_arguments];\n        }\n        for (var i = 0; i < argsLength; i++) {\n            if (range[i] === '') {\n                return this.parent.getErrorStrings()[CommonErrors.na];\n            }\n            if (range[i].indexOf(this.parent.tic) > -1) {\n                if (isNaN(parseFloat(range[i].split(this.parent.tic).join('')))) {\n                    return this.parent.getErrorStrings()[CommonErrors.value];\n                }\n                else {\n                    range[i] = range[i].split(this.parent.tic).join('');\n                }\n            }\n            argVal = parseFloat(this.parent.getValueFromArg(range[i]));\n            if (!this.parent.isCellReference(range[i])) {\n                if (isNaN(argVal)) {\n                    return this.parent.getErrorStrings()[CommonErrors.name];\n                }\n                i === 0 ? min = argVal : max = argVal;\n            }\n            else {\n                argVal = this.parent.getValueFromArg(range[i]) === '' ? 0 : argVal;\n                i === 0 ? min = argVal : max = argVal;\n                if (min === 0 && max === 0) {\n                    return '0';\n                }\n                if (isNaN(argVal)) {\n                    return this.parent.getErrorStrings()[CommonErrors.value];\n                }\n            }\n        }\n        if (max < min) {\n            return this.parent.getErrorStrings()[CommonErrors.num];\n        }\n        if (min === 0) {\n            return Math.floor(Math.random() * (max - (min - 1))) + min;\n        }\n        else {\n            return max - min === 1 ? Math.round((Math.random() * (max - min)) + min) : Math.floor(Math.random() * (max - (min - 1))) + min;\n        }\n    };\n    BasicFormulas.prototype.getModuleName = function () {\n        return 'basic-formulas';\n    };\n    return BasicFormulas;\n}());\nexport { BasicFormulas };\n","import { FormulaError } from './index';\nimport { CommonErrors, FormulasErrorsStrings } from '../common/index';\nimport { isNullOrUndefined } from '@syncfusion/ej2-base';\nvar Parser = /** @class */ (function () {\n    function Parser(parent) {\n        this.emptyStr = '';\n        this.storedStringText = this.emptyStr;\n        this.sheetToken = '!';\n        /** @hidden */\n        this.tokenAdd = 'a';\n        /** @hidden */\n        this.tokenSubtract = 's';\n        /** @hidden */\n        this.tokenMultiply = 'm';\n        /** @hidden */\n        this.tokenDivide = 'd';\n        /** @hidden */\n        this.tokenLess = 'l';\n        this.charEm = 'r';\n        this.charEp = 'x';\n        /** @hidden */\n        this.tokenGreater = 'g';\n        /** @hidden */\n        this.tokenEqual = 'e';\n        /** @hidden */\n        this.tokenLessEq = 'k';\n        /** @hidden */\n        this.tokenGreaterEq = 'j';\n        /** @hidden */\n        this.tokenNotEqual = 'o';\n        /** @hidden */\n        this.tokenAnd = 'c';\n        this.tokenEm = 'v';\n        this.tokenEp = 't';\n        /** @hidden */\n        this.tokenOr = String.fromCharCode(126);\n        this.charAnd = 'i';\n        this.charLess = '<';\n        this.charGreater = '>';\n        this.charEqual = '=';\n        this.charLessEq = 'f';\n        this.charGreaterEq = 'h';\n        this.charNoEqual = 'z';\n        this.stringGreaterEq = '>=';\n        this.stringLessEq = '<=';\n        this.stringNoEqual = '<>';\n        this.stringAnd = '&';\n        this.stringOr = '^';\n        this.charOr = 'w';\n        this.charAdd = '+';\n        this.charSubtract = '-';\n        this.charMultiply = '*';\n        this.charDivide = '/';\n        this.fixedReference = '$';\n        this.spaceString = ' ';\n        this.ignoreBracet = false;\n        /** @hidden */\n        this.isError = false;\n        /** @hidden */\n        this.isFormulaParsed = false;\n        this.findNamedRange = false;\n        this.stringsColl = new Map();\n        this.tokens = [\n            this.tokenAdd, this.tokenSubtract, this.tokenMultiply, this.tokenDivide, this.tokenLess,\n            this.tokenGreater, this.tokenEqual, this.tokenLessEq, this.tokenGreaterEq, this.tokenNotEqual, this.tokenAnd, this.tokenOr\n        ];\n        this.charNOTop = String.fromCharCode(167);\n        this.specialSym = ['~', '@', '#', '?', '%'];\n        this.isFailureTriggered = false;\n        this.parent = parent;\n    }\n    /** @hidden */\n    Parser.prototype.parse = function (text, fkey) {\n        if (this.parent.isTextEmpty(text)) {\n            return text;\n        }\n        if (this.parent.getFormulaCharacter() !== String.fromCharCode(0) && this.parent.getFormulaCharacter() === text[0]) {\n            text = text.substring(1);\n        }\n        if (this.parent.namedRanges.size > 0 || this.parent.storedData.size > 0) {\n            text = this.checkForNamedRangeAndKeyValue(text);\n            this.findNamedRange = false;\n        }\n        text = text.split('-+').join('-');\n        text = text.split('--').join('+');\n        text = text.split('+-').join('-');\n        text = text.split('-' + '(' + '-').join('(');\n        var formulaString = this.storeStrings(text);\n        text = this.storedStringText;\n        var i = 0;\n        if (isNullOrUndefined(formulaString)) {\n            text = text.split(' ').join('');\n        }\n        text = text.split('=>').join('>=');\n        text = text.split('=<').join('<=');\n        if (text[text.length - 1] !== this.parent.arithMarker || this.indexOfAny(text, this.tokens) !== (text.length - 2)) {\n            text = text.toUpperCase();\n        }\n        if (text.indexOf(this.sheetToken) > -1) {\n            var family = this.parent.getSheetFamilyItem(this.parent.grid);\n            if (family.sheetNameToParentObject != null && family.sheetNameToParentObject.size > 0) {\n                if (text[0] !== this.sheetToken.toString()) {\n                    text = this.parent.setTokensForSheets(text);\n                }\n                var sheetToken = this.parent.getSheetToken(text.split(this.parent.tic).join(this.emptyStr));\n                var scopedRange = this.checkScopedRange(text.split('\"').join(this.emptyStr).split(this.sheetToken).join(''));\n                if (isNullOrUndefined(sheetToken) && sheetToken !== '' && this.parent.namedRanges.size > 0 && scopedRange !== '') {\n                    text = scopedRange;\n                }\n            }\n        }\n        text = this.markLibraryFormulas(text);\n        try {\n            text = this.formulaAutoCorrection(text);\n        }\n        catch (ex) {\n            var args = {\n                message: ex.message, exception: ex, isForceCalculable: ex.formulaCorrection,\n                computeForceCalculate: false\n            };\n            if (!args.isForceCalculable) {\n                throw this.parent.formulaErrorStrings[FormulasErrorsStrings.invalid_expression];\n            }\n            if (!this.isFailureTriggered) {\n                this.parent.trigger('onFailure', args);\n                this.isFailureTriggered = true;\n            }\n            if (args.isForceCalculable && args.computeForceCalculate) {\n                text = this.formulaAutoCorrection(text, args);\n                this.parent.storedData.get(fkey).formulaText = '=' + text;\n            }\n            else {\n                throw this.parent.formulaErrorStrings[FormulasErrorsStrings.invalid_expression];\n            }\n        }\n        if (!this.ignoreBracet) {\n            i = text.indexOf(')');\n            while (i > -1) {\n                var k = text.substring(0, i).lastIndexOf('(');\n                if (k === -1) {\n                    throw new FormulaError(this.parent.formulaErrorStrings[FormulasErrorsStrings.mismatched_parentheses]);\n                }\n                if (k === i - 1) {\n                    throw new FormulaError(this.parent.formulaErrorStrings[FormulasErrorsStrings.empty_expression]);\n                }\n                var s = this.emptyStr;\n                if (this.ignoreBracet) {\n                    s = this.parent.substring(text, k, i - k + 1);\n                }\n                else {\n                    s = this.parent.substring(text, k + 1, i - k - 1);\n                }\n                try {\n                    text = text.substring(0, k) + this.parseSimple(s) + text.substring(i + 1);\n                }\n                catch (ex) {\n                    var args = this.exceptionArgs(ex);\n                    if (!this.isFailureTriggered) {\n                        this.parent.trigger('onFailure', args);\n                        this.isFailureTriggered = true;\n                    }\n                    var errorMessage = (typeof args.exception === 'string') ? args.exception : args.message;\n                    return (this.parent.getErrorLine(ex) ? '' : '#' + this.parent.getErrorLine(ex) + ': ') + errorMessage;\n                }\n                i = text.indexOf(')');\n            }\n        }\n        if (!this.ignoreBracet && text.indexOf('(') > -1) {\n            throw new FormulaError(this.parent.formulaErrorStrings[FormulasErrorsStrings.mismatched_parentheses]);\n        }\n        text = this.parseSimple(text);\n        if (formulaString !== null && formulaString.size > 0) {\n            text = this.setStrings(text, formulaString);\n        }\n        return text;\n    };\n    /* tslint:disable-next-line:no-any */\n    Parser.prototype.exceptionArgs = function (ex) {\n        return {\n            message: ex.message, exception: ex, isForceCalculable: ex.formulaCorrection,\n            computeForceCalculate: false\n        };\n    };\n    Parser.prototype.formulaAutoCorrection = function (formula, args) {\n        var arithemeticArr = ['*', '+', '-', '/', '^', '&'];\n        var logicalSym = ['>', '=', '<'];\n        var i = 0;\n        var form = '';\n        var op = '';\n        var firstOp = '';\n        var secondprevOp = '';\n        var secondnextOp = '';\n        var firstDigit = '';\n        var secondDigit = '';\n        var countDigit = 0;\n        if (this.parent.formulaErrorStrings.indexOf(formula) > -1) {\n            return formula;\n        }\n        else {\n            if (this.indexOfAny(formula, this.specialSym) > -1) {\n                throw new FormulaError(this.parent.formulaErrorStrings[FormulasErrorsStrings.invalid_expression], false);\n            }\n            while (i < formula.length) {\n                if ((formula.indexOf('&') > -1) || (this.parent.isDigit(formula[i]) && ((formula.length > i + 1)\n                    && (this.indexOfAny(formula[i + 1], arithemeticArr) > -1)) && ((formula.length > i + 2)\n                    && (!isNullOrUndefined(formula[i + 2]) && this.indexOfAny(formula[i + 2], arithemeticArr) > -1)))) {\n                    if (isNullOrUndefined(args)) {\n                        throw new FormulaError(this.parent.formulaErrorStrings[FormulasErrorsStrings.invalid_expression], true);\n                    }\n                    if (args.computeForceCalculate) {\n                        if (this.parent.isDigit(formula[i])) {\n                            if (countDigit < 1) {\n                                firstDigit = formula[i];\n                                firstOp = formula[i + 1];\n                                if (isNullOrUndefined(firstOp)) {\n                                    firstOp = this.emptyStr;\n                                }\n                                firstOp = firstOp === '&' ? '' : firstOp;\n                                countDigit = countDigit + 1;\n                                form = form + firstDigit + firstOp;\n                            }\n                            else if (countDigit < 2) {\n                                secondDigit = formula[i];\n                                secondprevOp = formula[i - 1];\n                                secondnextOp = formula[i + 1];\n                                countDigit = 0;\n                                if (secondprevOp === '-') {\n                                    secondnextOp = isNullOrUndefined(secondnextOp) ? this.emptyStr : secondnextOp;\n                                    secondnextOp = secondnextOp === '&' ? '' : secondnextOp;\n                                    form = form + secondprevOp + secondDigit + secondnextOp;\n                                }\n                                else {\n                                    secondnextOp = isNullOrUndefined(secondnextOp) ? this.emptyStr : secondnextOp;\n                                    form = form + secondDigit + secondnextOp;\n                                }\n                            }\n                            i = i + 2;\n                        }\n                        else {\n                            form = (formula[i] === '-') ? form + formula[i] : form;\n                            i = i + 1;\n                        }\n                    }\n                    else {\n                        throw this.parent.formulaErrorStrings[FormulasErrorsStrings.improper_formula];\n                    }\n                    /* tslint:disable-next-line */\n                }\n                else if ((this.parent.isDigit(formula[i]) || formula[i] === this.parent.rightBracket || this.parent.storedData.has(formula[i].toUpperCase())) && (isNullOrUndefined(formula[i + 1]) || this.indexOfAny(formula[i + 1], arithemeticArr)) > -1) {\n                    op = isNullOrUndefined(formula[i + 1]) ? this.emptyStr : formula[i + 1];\n                    op = op === '&' ? '' : op;\n                    form = formula[i - 1] === '-' ? form + formula[i - 1] + formula[i] + op : form + formula[i] + op;\n                    i = i + 2;\n                    /* tslint:disable-next-line */\n                }\n                else if (this.indexOfAny(formula[i], logicalSym) > -1 && !isNullOrUndefined(formula[i - 1]) && !isNullOrUndefined(formula[i + 1])) {\n                    form = form + formula[i];\n                    i = i + 1;\n                }\n                else if (formula[i] === 'q') {\n                    while (formula[i] !== this.parent.leftBracket) {\n                        form = form + formula[i];\n                        i = i + 1;\n                    }\n                    /* tslint:disable-next-line */\n                }\n                else if (formula[i] === this.parent.leftBracket || formula[i] === this.parent.rightBracket || formula[i] === '{' || formula[i] === '}' || formula[i] === '(' || formula[i] === ')') {\n                    form = form + formula[i];\n                    i = i + 1;\n                    /* tslint:disable-next-line */\n                }\n                else if (this.parent.isUpperChar(formula[i]) || formula[i].indexOf(':') > -1 || formula[i] === this.parent.getParseArgumentSeparator() || ((formula[i] === '%') && (this.parent.isDigit(formula[i - 1])))) {\n                    form = form + formula[i];\n                    i = i + 1;\n                }\n                else if (formula[i] === this.parent.tic || formula[i] === ' ' || formula[i] === '.' || formula[i] === this.sheetToken ||\n                    formula[i] === '$') {\n                    form = form + formula[i];\n                    i = i + 1;\n                }\n                else {\n                    if (this.parent.isDigit(formula[i])) {\n                        form = formula[i - 1] === '-' ? form + formula[i - 1] + formula[i] : form + formula[i];\n                    }\n                    if (formula[i] === '-') {\n                        form = form + formula[i];\n                        form = form.split('++').join('+').split('+-').join('-').split('-').join('-');\n                    }\n                    i = i + 1;\n                }\n            }\n        }\n        form = form === this.emptyStr ? formula : form;\n        if (this.indexOfAny(form[form.length - 1], arithemeticArr) > -1) {\n            form = form.substring(0, form.length - 1);\n        }\n        form = form.split('--').join('-').split('-+').join('-').split('+-').join('-');\n        return form;\n    };\n    Parser.prototype.checkScopedRange = function (text) {\n        var _this = this;\n        var scopedRange = this.emptyStr;\n        var b = 'NaN';\n        var id = this.parent.getSheetID(this.parent.grid);\n        var sheet = this.parent.getSheetFamilyItem(this.parent.grid);\n        if (text[0] === this.sheetToken.toString()) {\n            var i = text.indexOf(this.sheetToken, 1);\n            var v = parseInt(text.substr(1, i - 1), 10);\n            if (i > 1 && !this.parent.isNaN(v)) {\n                text = text.substring(i + 1);\n                id = v;\n            }\n        }\n        var token = '!' + id.toString() + '!';\n        if (sheet === null || sheet.sheetNameToToken == null) {\n            return b;\n        }\n        sheet.sheetNameToToken.forEach(function (value, key) {\n            if (sheet.sheetNameToToken.get(key).toString() === token) {\n                var s_1 = _this.emptyStr;\n                _this.parent.namedRanges.forEach(function (value, key) {\n                    /* tslint:disable-next-line:no-any */\n                    if (!isNullOrUndefined(_this.parent.parentObject)) {\n                        /* tslint:disable-next-line:no-any */\n                        s_1 = (_this.parent.parentObject.getActiveSheet().name + _this.sheetToken + text).toUpperCase();\n                    }\n                    else {\n                        s_1 = sheet.sheetNameToToken.get(key).toUpperCase();\n                    }\n                    if (_this.parent.getNamedRanges().has(s_1)) {\n                        scopedRange = (_this.parent.getNamedRanges().get(s_1)).toUpperCase();\n                        b = scopedRange;\n                    }\n                });\n            }\n        });\n        return b;\n    };\n    Parser.prototype.storeStrings = function (tempString) {\n        var i = 0;\n        var j = 0;\n        var id = 0;\n        var key = '';\n        var storedString = null;\n        var condition;\n        var ticLoc = tempString.indexOf(this.parent.tic);\n        var singleTicLoc = tempString.indexOf(this.parent.singleTic);\n        if (ticLoc > -1 || singleTicLoc > -1) {\n            tempString = tempString.split(this.parent.singleTic).join(this.parent.tic);\n            i = tempString.indexOf(this.parent.tic);\n            while (i > -1 && tempString.length > 0) {\n                if (storedString === null) {\n                    storedString = this.stringsColl;\n                }\n                j = i + 1 < tempString.length ? tempString.indexOf(this.parent.tic, i + 1) : -1;\n                if (j === -1) {\n                    throw new FormulaError(this.parent.formulaErrorStrings[FormulasErrorsStrings.mismatched_tics]);\n                }\n                condition = this.parent.substring(tempString, i, j - i + 1);\n                key = this.parent.tic + this.spaceString + id.toString() + this.parent.tic;\n                storedString = storedString.set(key, condition);\n                tempString = tempString.substring(0, i) + key + tempString.substring(j + 1);\n                i = i + key.length;\n                if (i < tempString.length) {\n                    i = tempString.indexOf(this.parent.tic, i);\n                }\n                id++;\n            }\n        }\n        this.storedStringText = tempString;\n        return storedString;\n    };\n    Parser.prototype.setStrings = function (text, formulaString) {\n        for (var i = 0; i < formulaString.size; i++) {\n            formulaString.forEach(function (value, key) {\n                text = text.split(key).join(value);\n            });\n        }\n        return text;\n    };\n    /** @hidden */\n    Parser.prototype.parseSimple = function (formulaText) {\n        var needToContinue = true;\n        var text = formulaText;\n        if (text.length > 0 && text[0] === '+') {\n            text = text.substring(1);\n        }\n        if (text === '#DIV/0!') {\n            return '#DIV/0!';\n        }\n        if (text === '#NAME?') {\n            return '#NAME?';\n        }\n        if (text === '') {\n            return text;\n        }\n        if (this.parent.formulaErrorStrings.indexOf(text) > -1) {\n            return text;\n        }\n        text = text.split(this.stringLessEq).join(this.charLessEq);\n        text = text.split(this.stringGreaterEq).join(this.charGreaterEq);\n        text = text.split(this.stringNoEqual).join(this.charNoEqual);\n        text = text.split(this.stringAnd).join(this.charAnd);\n        text = text.split(this.stringOr).join(this.charOr);\n        text = text.split(this.fixedReference).join(this.emptyStr);\n        needToContinue = true;\n        var expTokenArray = [this.tokenEp, this.tokenEm];\n        var mulTokenArray = [this.tokenMultiply, this.tokenDivide];\n        var addTokenArray = [this.tokenAdd, this.tokenSubtract];\n        var mulCharArray = [this.charMultiply, this.charDivide];\n        var addCharArray = [this.charAdd, this.charSubtract];\n        var compareTokenArray = [this.tokenLess, this.tokenGreater, this.tokenEqual, this.tokenLessEq,\n            this.tokenGreaterEq, this.tokenNotEqual];\n        var compareCharArray = [this.charLess, this.charGreater, this.charEqual, this.charLessEq,\n            this.charGreaterEq, this.charNoEqual];\n        var expCharArray = [this.charEp, this.charEm];\n        var andTokenArray = [this.tokenAnd];\n        var andCharArray = [this.charAnd];\n        var orCharArray = [this.charOr];\n        var orTokenArray = [this.tokenOr];\n        text = this.parseSimpleOperators(text, expTokenArray, expCharArray);\n        text = this.parseSimpleOperators(text, orTokenArray, orCharArray);\n        if (needToContinue) {\n            text = this.parseSimpleOperators(text, mulTokenArray, mulCharArray);\n        }\n        if (needToContinue) {\n            text = this.parseSimpleOperators(text, addTokenArray, addCharArray);\n        }\n        if (needToContinue) {\n            text = this.parseSimpleOperators(text, compareTokenArray, compareCharArray);\n        }\n        if (needToContinue) {\n            text = this.parseSimpleOperators(text, andTokenArray, andCharArray);\n        }\n        return text;\n    };\n    /** @hidden */\n    // tslint:disable-next-line:max-func-body-length\n    Parser.prototype.parseSimpleOperators = function (formulaText, markers, operators) {\n        if (this.parent.getErrorStrings().indexOf(formulaText) > -1) {\n            return formulaText;\n        }\n        var text = formulaText;\n        var i = 0;\n        var op = '';\n        for (var c = 0; c < operators.length; c++) {\n            op = op + operators[c];\n        }\n        /* tslint:disable */\n        text = text.split(\"---\").join(\"-\").split(\"--\").join(\"+\").split(this.parent.getParseArgumentSeparator() + \"-\").join(this.parent.getParseArgumentSeparator() + \"u\").split(this.parent.leftBracket + \"-\").join(this.parent.leftBracket + \"u\").split(\"=-\").join(\"=u\");\n        text = text.split(',+').join(',').split(this.parent.leftBracket + '+').join(this.parent.leftBracket).split('=+').join('=').split('>+').join('>').split('<+').join('<').split('/+').join('/').split('*+').join('*').split('++').join('+').split(\"*-\").join(\"*u\").toString();\n        ;\n        /* tslint:enable */\n        if (text.length > 0 && text[0] === '-') {\n            text = text.substring(1).split('-').join(this.tokenOr);\n            text = '0-' + text;\n            text = this.parseSimpleOperators(text, [this.tokenSubtract], [this.charSubtract]);\n            text = text.split(this.tokenOr).join('-');\n        }\n        else if (text.length > 0 && text[0] === '+') {\n            text = text.substring(1);\n        }\n        else if (text.length > 0 && text[text.length - 1] === '+') {\n            text = text.substring(0, text.length - 1);\n        }\n        try {\n            if (this.indexOfAny(text, operators) > -1) {\n                i = this.indexOfAny(text, operators);\n                while (i > -1) {\n                    var left = '';\n                    var right = '';\n                    var leftIndex = 0;\n                    var rightIndex = 0;\n                    var isNotOperator = text[i] === this.charNOTop;\n                    var j = 0;\n                    if (!isNotOperator) {\n                        j = i - 1;\n                        if (text[j] === this.parent.arithMarker) {\n                            var k = this.findLeftMarker(text.substring(0, j - 1));\n                            if (k < 0) {\n                                throw new FormulaError(this.parent.formulaErrorStrings[FormulasErrorsStrings.cannot_parse]);\n                            }\n                            left = this.parent.substring(text, k + 1, j - k - 1);\n                            leftIndex = k + 1;\n                        }\n                        else if (text[j] === this.parent.rightBracket) {\n                            var bracketCount = 0;\n                            var k = j - 1;\n                            while (k > 0 && (text[k] !== 'q' || bracketCount !== 0)) {\n                                if (text[k] === 'q') {\n                                    bracketCount--;\n                                }\n                                else if (text[k] === this.parent.rightBracket) {\n                                    bracketCount++;\n                                }\n                                k--;\n                            }\n                            if (k < 0) {\n                                throw new FormulaError(this.parent.formulaErrorStrings[FormulasErrorsStrings.cannot_parse]);\n                            }\n                            left = this.parent.substring(text, k, j - k + 1);\n                            leftIndex = k;\n                        }\n                        else if (text[j] === this.parent.tic[0]) {\n                            var l = text.substring(0, j - 1).lastIndexOf(this.parent.tic);\n                            if (l < 0) {\n                                throw new FormulaError(this.parent.formulaErrorStrings[FormulasErrorsStrings.cannot_parse]);\n                            }\n                            left = this.parent.substring(text, l, j - l + 1);\n                            leftIndex = l;\n                        }\n                        else {\n                            var period = false;\n                            while (j > -1 && (this.parent.isDigit(text[j]) ||\n                                (!period && text[j] === this.parent.getParseDecimalSeparator()))) {\n                                if (text[j] === this.parent.getParseDecimalSeparator()) {\n                                    period = true;\n                                }\n                                j = j - 1;\n                            }\n                            if (j > -1 && period && text[j] === this.parent.getParseDecimalSeparator()) {\n                                /* tslint:disable-next-line */\n                                throw new FormulaError(this.parent.formulaErrorStrings[FormulasErrorsStrings.number_contains_2_decimal_points]);\n                            }\n                            j = j + 1;\n                            if (j === 0 || (j > 0 && !this.parent.isUpperChar(text[j - 1]))) {\n                                left = 'n' + this.parent.substring(text, j, i - j);\n                                leftIndex = j;\n                            }\n                            else {\n                                j = j - 1;\n                                while (j > -1 && (this.parent.isUpperChar(text[j]) || this.parent.isDigit(text[j]))) {\n                                    j = j - 1;\n                                }\n                                if (j > -1 && text[j] === this.sheetToken) {\n                                    j = j - 1;\n                                    while (j > -1 && text[j] !== this.sheetToken) {\n                                        j = j - 1;\n                                    }\n                                    if (j > -1 && text[j] === this.sheetToken) {\n                                        j = j - 1;\n                                    }\n                                }\n                                j = j + 1;\n                                left = this.parent.substring(text, j, i - j);\n                                this.parent.updateDependentCell(left);\n                                leftIndex = j;\n                            }\n                            if ((this.parent.namedRanges.size > 0 && this.parent.namedRanges.has(left.toUpperCase())) ||\n                                (this.parent.storedData.has(left.toUpperCase()))) {\n                                left = 'n' + this.checkForNamedRangeAndKeyValue(left);\n                            }\n                        }\n                    }\n                    else {\n                        leftIndex = i;\n                    }\n                    if (i === text.length - 1) {\n                        /* tslint:disable-next-line */\n                        throw new FormulaError(this.parent.formulaErrorStrings[FormulasErrorsStrings.expression_cannot_end_with_an_operator]);\n                    }\n                    else {\n                        j = i + 1;\n                        var uFound = text[j] === 'u'; // for 3*-2\n                        if (uFound) {\n                            j = j + 1;\n                        }\n                        if (text[j] === this.parent.tic[0]) {\n                            var k = text.substring(j + 1).indexOf(this.parent.tic);\n                            if (k < 0) {\n                                throw this.parent.formulaErrorStrings[FormulasErrorsStrings.cannot_parse];\n                            }\n                            right = this.parent.substring(text, j, k + 2);\n                            rightIndex = k + j + 2;\n                        }\n                        else if (text[j] === this.parent.arithMarker) {\n                            var k = this.findRightMarker(text.substring(j + 1));\n                            if (k < 0) {\n                                throw new FormulaError(this.parent.formulaErrorStrings[FormulasErrorsStrings.cannot_parse]);\n                            }\n                            right = this.parent.substring(text, j + 1, k);\n                            rightIndex = k + j + 2;\n                        }\n                        else if (text[j] === 'q') {\n                            var bracketCount = 0;\n                            var k = j + 1;\n                            while (k < text.length && (text[k] !== this.parent.rightBracket || bracketCount !== 0)) {\n                                if (text[k] === this.parent.rightBracket) {\n                                    bracketCount++;\n                                }\n                                else if (text[k] === 'q') {\n                                    bracketCount--;\n                                }\n                                k++;\n                            }\n                            if (k === text.length) {\n                                throw this.parent.formulaErrorStrings[FormulasErrorsStrings.cannot_parse];\n                            }\n                            right = this.parent.substring(text, j, k - j + 1);\n                            if (uFound) {\n                                right = 'u' + right;\n                            }\n                            rightIndex = k + 1;\n                            /* tslint:disable-next-line */\n                        }\n                        else if (this.parent.isDigit(text[j]) || text[j] === this.parent.getParseDecimalSeparator()) {\n                            var period = (text[j] === this.parent.getParseDecimalSeparator());\n                            j = j + 1;\n                            /* tslint:disable-next-line */\n                            while (j < text.length && (this.parent.isDigit(text[j]) || (!period && text[j] === this.parent.getParseDecimalSeparator()))) {\n                                if (text[j] === this.parent.getParseDecimalSeparator()) {\n                                    period = true;\n                                }\n                                j = j + 1;\n                            }\n                            if (j < text.length && text[j] === '%') {\n                                j += 1;\n                            }\n                            if (period && j < text.length && text[j] === this.parent.getParseDecimalSeparator()) {\n                                throw this.parent.formulaErrorStrings[FormulasErrorsStrings.number_contains_2_decimal_points];\n                            }\n                            right = 'n' + this.parent.substring(text, i + 1, j - i - 1);\n                            rightIndex = j;\n                        }\n                        else if (this.parent.isUpperChar(text[j]) || text[j] === this.sheetToken || text[j] === 'u') {\n                            if (text[j] === this.sheetToken) {\n                                j = j + 1;\n                                while (j < text.length && text[j] !== this.sheetToken) {\n                                    j = j + 1;\n                                }\n                            }\n                            j = j + 1;\n                            var jTemp = 0;\n                            var inbracket = false;\n                            while (j < text.length && (this.parent.isUpperChar(text[j]) || text[j] === '_'\n                                || text[j] === '.' || text[j] === '[' || text[j] === ']' || text[j] === '#' || text[j] === ' '\n                                || text[j] === '%' || text[j] === this.parent.getParseDecimalSeparator() && inbracket)) {\n                                if (j !== text.length - 1 && text[j] === '[' && text[j + 1] === '[') {\n                                    inbracket = true;\n                                }\n                                if (j !== text.length - 1 && text[j] === ']' && text[j + 1] === ']') {\n                                    inbracket = false;\n                                }\n                                j++;\n                                jTemp++;\n                            }\n                            var noCellReference = (j === text.length) || !this.parent.isDigit(text[j]);\n                            if (jTemp > 1) {\n                                while (j < text.length && (this.parent.isUpperChar(text[j]) || this.parent.isDigit(text[j])\n                                    || text[j] === ' ' || text[j] === '_')) {\n                                    j++;\n                                }\n                                noCellReference = true;\n                            }\n                            while (j < text.length && this.parent.isDigit(text[j])) {\n                                j = j + 1;\n                            }\n                            if (j < text.length && text[j] === ':') {\n                                j = j + 1;\n                                if (j < text.length && text[j] === this.sheetToken) {\n                                    j++;\n                                    while (j < text.length && text[j] !== this.sheetToken) {\n                                        j = j + 1;\n                                    }\n                                    if (j < text.length && text[j] === this.sheetToken) {\n                                        j++;\n                                    }\n                                }\n                                while (j < text.length && this.parent.isUpperChar(text[j])) {\n                                    j = j + 1;\n                                }\n                                while (j < text.length && this.parent.isDigit(text[j])) {\n                                    j = j + 1;\n                                }\n                                j = j - 1;\n                                right = this.parent.substring(text, i + 1, j - i);\n                            }\n                            else {\n                                j = j - 1;\n                                right = this.parent.substring(text, i + 1, j - i);\n                                uFound = text[j] === 'u';\n                                if (uFound) {\n                                    right = 'u' + right;\n                                }\n                            }\n                            noCellReference = !this.parent.isCellReference(right);\n                            if (!noCellReference) {\n                                this.parent.updateDependentCell(right);\n                            }\n                            if ((this.parent.namedRanges.size > 0 && this.parent.namedRanges.has(right.toUpperCase()))\n                                || (this.parent.storedData.has(right.toUpperCase()))) {\n                                right = 'n' + this.checkForNamedRangeAndKeyValue(right);\n                            }\n                            rightIndex = j + 1;\n                        }\n                    }\n                    var p = op.indexOf(text[i]);\n                    var s = this.parent.arithMarker + left + right + markers[p] + this.parent.arithMarker;\n                    if (leftIndex > 0) {\n                        s = text.substring(0, leftIndex) + s;\n                    }\n                    if (rightIndex < text.length) {\n                        s = s + text.substring(rightIndex);\n                    }\n                    s = s.split(this.parent.arithMarker2).join(this.parent.arithMarker.toString());\n                    text = s;\n                    i = this.indexOfAny(text, operators);\n                }\n            }\n            else {\n                if (text.length > 0 && (this.parent.isUpperChar(text[0]) || text[0] === this.sheetToken)) {\n                    var isCharacter = true;\n                    var checkLetter = true;\n                    var oneTokenFound = false;\n                    var textLen = text.length;\n                    for (var k = 0; k < textLen; ++k) {\n                        if (text[k] === this.sheetToken) {\n                            if (k > 0 && !oneTokenFound) {\n                                throw this.parent.getErrorStrings()[CommonErrors.ref];\n                            }\n                            oneTokenFound = true;\n                            k++;\n                            while (k < textLen && this.parent.isDigit(text[k])) {\n                                k++;\n                            }\n                            if (k === textLen || text[k] !== this.sheetToken) {\n                                isCharacter = false;\n                                break;\n                            }\n                        }\n                        else {\n                            if (!checkLetter && this.parent.isChar(text[k])) {\n                                isCharacter = false;\n                                break;\n                            }\n                            if (this.parent.isChar(text[k]) || this.parent.isDigit(text[k]) || text[k] === this.sheetToken) {\n                                checkLetter = this.parent.isUpperChar(text[k]);\n                            }\n                            else {\n                                isCharacter = false;\n                                break;\n                            }\n                        }\n                    }\n                    if (isCharacter) {\n                        this.parent.updateDependentCell(text);\n                    }\n                }\n            }\n            return text;\n        }\n        catch (ex) {\n            return ex;\n        }\n    };\n    /** @hidden */\n    Parser.prototype.indexOfAny = function (text, operators) {\n        for (var i = 0; i < text.length; i++) {\n            if (operators.indexOf(text[i]) > -1) {\n                return i;\n            }\n        }\n        return -1;\n    };\n    /** @hidden */\n    Parser.prototype.findLeftMarker = function (text) {\n        var ret = -1;\n        if (text.indexOf(this.parent.arithMarker) > -1) {\n            var bracketLevel = 0;\n            for (var i = text.length - 1; i >= 0; --i) {\n                if (text[i] === this.parent.rightBracket) {\n                    bracketLevel--;\n                }\n                else if (text[i] === this.parent.leftBracket) {\n                    bracketLevel++;\n                }\n                else if (text[i] === this.parent.arithMarker && bracketLevel === 0) {\n                    ret = i;\n                    break;\n                }\n            }\n        }\n        return ret;\n    };\n    /** @hidden */\n    Parser.prototype.findRightMarker = function (text) {\n        var ret = -1;\n        if (text.indexOf(this.parent.arithMarker) > -1) {\n            var bracketLevel = 0;\n            for (var j = 0; j < text.length; ++j) {\n                if (text[j] === this.parent.rightBracket) {\n                    bracketLevel--;\n                }\n                else if (text[j] === this.parent.leftBracket) {\n                    bracketLevel++;\n                }\n                else if (text[j] === this.parent.arithMarker && bracketLevel === 0) {\n                    ret = j;\n                    break;\n                }\n            }\n        }\n        return ret;\n    };\n    /** @hidden */\n    Parser.prototype.parseFormula = function (formula, fKey) {\n        if (formula.length > 0 && formula[0] === this.parent.getFormulaCharacter()) {\n            formula = formula.substring(1);\n        }\n        if (formula.length > 0 && formula[0] === '+') {\n            formula = formula.substring(1);\n        }\n        try {\n            this.isFailureTriggered = false;\n            this.isError = false;\n            formula = this.parse(formula.trim(), fKey);\n            this.isFormulaParsed = true;\n        }\n        catch (ex) {\n            var args = this.exceptionArgs(ex);\n            if (!this.isFailureTriggered) {\n                this.parent.trigger('onFailure', args);\n                this.isFailureTriggered = true;\n            }\n            var errorMessage = (typeof args.exception === 'string') ? args.exception : args.message;\n            formula = (isNullOrUndefined(this.parent.getErrorLine(ex)) ? '' : '#' + this.parent.getErrorLine(ex) + ': ') + errorMessage;\n            this.isError = true;\n        }\n        return formula;\n    };\n    /** @hidden */\n    Parser.prototype.markLibraryFormulas = function (formula) {\n        var bracCount = 0;\n        var rightParens = formula.indexOf(')');\n        if (rightParens === -1) {\n            formula = this.markNamedRanges(formula);\n        }\n        else {\n            while (rightParens > -1) {\n                var parenCount = 0;\n                var leftParens = rightParens - 1;\n                while (leftParens > -1 && (formula[leftParens] !== '(' || parenCount !== 0)) {\n                    if (formula[leftParens] === ')') {\n                        parenCount++;\n                    }\n                    else if (formula[leftParens] === ')') {\n                        parenCount--;\n                    }\n                    leftParens--;\n                }\n                if (leftParens === -1) {\n                    throw new FormulaError(this.parent.formulaErrorStrings[FormulasErrorsStrings.mismatched_parentheses]);\n                }\n                var i = leftParens - 1;\n                while (i > -1 && (this.parent.isChar(formula[i]))) {\n                    i--;\n                }\n                var len = leftParens - i - 1;\n                var libFormula = this.parent.substring(formula, i + 1, len);\n                if (len > 0 && !isNullOrUndefined(this.parent.getFunction(libFormula))) {\n                    if (this.parent.substring(formula, i + 1, len) === 'AREAS') {\n                        this.ignoreBracet = true;\n                    }\n                    else {\n                        this.ignoreBracet = false;\n                    }\n                    var substr = this.parent.substring(formula, leftParens, rightParens - leftParens + 1);\n                    try {\n                        var args = void 0;\n                        substr = substr.split('(').join('').split(')').join('');\n                        substr = '(' + this.formulaAutoCorrection(substr, args) + ')';\n                    }\n                    catch (ex) {\n                        var args = {\n                            message: ex.message, exception: ex,\n                            isForceCalculable: ex.formulaCorrection, computeForceCalculate: false\n                        };\n                        if (!args.isForceCalculable) {\n                            throw this.parent.formulaErrorStrings[FormulasErrorsStrings.improper_formula];\n                        }\n                        if (!this.isFailureTriggered) {\n                            this.parent.trigger('onFailure', args);\n                            this.isFailureTriggered = true;\n                            bracCount = bracCount + 1;\n                        }\n                        args.computeForceCalculate = bracCount > 0 ? true : args.computeForceCalculate;\n                        if (args.isForceCalculable) {\n                            if (args.computeForceCalculate) {\n                                substr = substr.split('(').join('').split(')').join('');\n                                substr = '(' + this.formulaAutoCorrection(substr, args) + ')';\n                            }\n                            else {\n                                throw this.parent.formulaErrorStrings[FormulasErrorsStrings.improper_formula];\n                            }\n                        }\n                        else {\n                            throw this.parent.formulaErrorStrings[FormulasErrorsStrings.improper_formula];\n                        }\n                    }\n                    substr = this.markNamedRanges(substr);\n                    substr = this.swapInnerParens(substr);\n                    substr = this.addParensToArgs(substr);\n                    var id = substr.lastIndexOf(this.parent.getParseArgumentSeparator());\n                    var k = 0;\n                    if (id === -1) {\n                        if (substr.length > 2 && substr[0] === '(' && substr[substr.length - 1] === ')') {\n                            if (substr[1] !== '{' && substr[1] !== '(') {\n                                substr = substr.substring(0, substr.length - 1) + '}' + substr.substring(substr.length - 1);\n                                substr = substr[0] + '{' + substr.substring(1);\n                            }\n                        }\n                    }\n                    formula = formula.substring(0, i + 1) + 'q' + this.parent.substring(formula, i + 1, len) +\n                        (substr.split('(').join(this.parent.leftBracket))\n                            .split(')').join(this.parent.rightBracket) + formula.substring(rightParens + 1);\n                }\n                else if (len > 0) {\n                    return this.parent.getErrorStrings()[CommonErrors.name];\n                }\n                else {\n                    var s = this.emptyStr;\n                    if (leftParens > 0) {\n                        s = formula.substring(0, leftParens);\n                    }\n                    s = s + '{' + this.parent.substring(formula, leftParens + 1, rightParens - leftParens - 1) + '}';\n                    if (rightParens < formula.length) {\n                        s = s + formula.substring(rightParens + 1);\n                    }\n                    s = this.markNamedRanges(s);\n                    formula = s;\n                }\n                rightParens = formula.indexOf(')');\n            }\n        }\n        formula = (formula.split('{').join('(')).split('}').join(')');\n        return formula;\n    };\n    /** @hidden */\n    Parser.prototype.swapInnerParens = function (fSubstr) {\n        if (fSubstr.length > 2) {\n            /* tslint:disable-next-line */\n            fSubstr = fSubstr[0] + fSubstr.substr(1, fSubstr.length - 2).split('(').join('{').split(')').join('}') + fSubstr[fSubstr.length - 1];\n        }\n        return fSubstr;\n    };\n    /** @hidden */\n    Parser.prototype.addParensToArgs = function (fSubstr) {\n        if (fSubstr.length === 0) {\n            return this.emptyStr;\n        }\n        var rightSides = [];\n        rightSides.push(this.parent.getParseArgumentSeparator());\n        rightSides.push(this.parent.rightBracket);\n        var id = fSubstr.lastIndexOf(this.parent.getParseArgumentSeparator());\n        var k = 0;\n        if (id === -1) {\n            if (fSubstr.length > 2 && fSubstr[0] === '(' && fSubstr[fSubstr.length - 1] === ')') {\n                if (fSubstr[1] !== '{' && fSubstr[1] !== '(') {\n                    fSubstr = fSubstr.substring(0, fSubstr.length - 1) + '}' + fSubstr.substring(fSubstr.length - 1);\n                    fSubstr = fSubstr[0] + '{' + fSubstr.substring(1);\n                }\n                else {\n                    var marker = ['+', '-', '*', '/'];\n                    id = this.lastIndexOfAny(fSubstr, marker);\n                    if (k === 0 && fSubstr[fSubstr.length - 1] === ')') {\n                        k = fSubstr.length - 1;\n                    }\n                    if (k > 0) {\n                        if (fSubstr[id + 1] !== '{' && fSubstr[id - 1] === '}') {\n                            fSubstr = fSubstr.substr(0, k) + '}' + fSubstr.substr(k);\n                            fSubstr = fSubstr.substr(0, id + 1) + '{' + fSubstr.substr(id + 1);\n                        }\n                    }\n                }\n            }\n        }\n        else {\n            var oneTimeOnly = true;\n            while (id > -1) {\n                var j = this.indexOfAny(fSubstr.substring(id + 1, fSubstr.length), rightSides);\n                if (j >= 0) {\n                    j = id + j + 1;\n                }\n                else if (j === -1 && fSubstr[fSubstr.length - 1] === ')') {\n                    j = fSubstr.length - 1;\n                }\n                if (j > 0) {\n                    if (fSubstr[id + 1] !== '{' && fSubstr[j - 1] !== '}') {\n                        fSubstr = fSubstr.substr(0, j) + '}' + fSubstr.substr(j);\n                        fSubstr = fSubstr.substr(0, id + 1) + '{' + fSubstr.substr(id + 1);\n                    }\n                }\n                id = fSubstr.substr(0, id).lastIndexOf(this.parent.getParseArgumentSeparator());\n                if (oneTimeOnly && id === -1 && fSubstr[0] === '(') {\n                    id = 0;\n                    oneTimeOnly = false;\n                }\n            }\n        }\n        fSubstr = fSubstr.split('{}').join(this.emptyStr);\n        return fSubstr;\n    };\n    /** @hidden */\n    Parser.prototype.lastIndexOfAny = function (text, operators) {\n        for (var i = text.length - 1; i > -1; i--) {\n            if (operators.indexOf(text[i]) > -1) {\n                return i;\n            }\n        }\n        return -1;\n    };\n    /** @hidden */\n    Parser.prototype.markNamedRanges = function (formula) {\n        var markers = [')', this.parent.getParseArgumentSeparator(), '}', '+', '-', '*', '/', '<', '>', '=', '&'];\n        var i = (formula.length > 0 && (formula[0] === '(' || formula[0] === '{')) ? 1 : 0;\n        if (formula.indexOf('#N/A') > -1) {\n            formula = formula.split('#N/A').join('#N~A');\n        }\n        if (formula.indexOf('#DIV/0!') > -1) {\n            formula = formula.split('#DIV/0!').join('#DIV~0!');\n        }\n        var end = this.indexOfAny(formula.substring(i), markers);\n        while (end > -1 && end + i < formula.length) {\n            var scopedRange = this.emptyStr;\n            var s = null;\n            if ((this.parent.substring(formula, i, end)).indexOf('[') > -1) {\n                s = this.getTableRange(this.parent.substring(formula, i, end));\n            }\n            else if (this.parent.storedData.has(this.parent.substring(formula, i, end))) {\n                s = this.checkForNamedRangeAndKeyValue(this.parent.substring(formula, i, end));\n            }\n            else if (this.parent.namedRanges.has(this.parent.substring(formula, i, end))) {\n                s = this.checkForNamedRangeAndKeyValue(this.parent.substring(formula, i, end));\n            }\n            if (isNullOrUndefined(s)) {\n                scopedRange = this.checkScopedRange(this.parent.substring(formula, i, end));\n                if (scopedRange !== 'NaN') {\n                    this.findNamedRange = true;\n                    s = scopedRange;\n                }\n                else if (this.parent.substring(formula, i, end).startsWith(this.sheetToken.toString())) {\n                    var formulaStr = this.parent.substring(formula, i, end).indexOf(this.sheetToken, 1);\n                    // if (formulaStr > 1) {\n                    //     s = this.parent.namedRanges.get(this.parent.substring\n                    // (formula.substring(i), formulaStr + 1, end - formulaStr - 1));\n                    // }\n                }\n                if (!isNullOrUndefined(s) && this.findNamedRange) {\n                    if (s.indexOf(this.fixedReference) > -1) {\n                        s = s.split(this.fixedReference).join(this.emptyStr);\n                    }\n                }\n            }\n            if (!isNullOrUndefined(s)) {\n                s = s.toUpperCase();\n                s = this.parent.setTokensForSheets(s);\n                s = this.markLibraryFormulas(s);\n            }\n            if (!isNullOrUndefined(s) && s !== this.emptyStr) {\n                formula = formula.substring(0, i) + s + formula.substring(i + end);\n                i += s.length + 1;\n            }\n            else {\n                i += end + 1;\n                while (i < formula.length && !this.parent.isUpperChar(formula[i]) && formula[i] !== this.sheetToken) {\n                    i++;\n                }\n            }\n            end = i;\n            if (i < formula.length - 1 && formula[i] === '{') {\n                i = i + 1;\n            }\n            end = this.indexOfAny(formula.substring(i), markers);\n            while (end === 0 && i < formula.length - 1) {\n                i++;\n                end = this.indexOfAny(formula.substring(i), markers);\n            }\n            if ((end === -1 || formula.substring(i).indexOf('[') > -1) && i < formula.length) {\n                if (formula.substring(i).indexOf('[') > -1) {\n                    s = this.getTableRange(formula.substring(i));\n                }\n                else {\n                    if (this.parent.storedData.has(formula.substring(i))) {\n                        s = this.parent.storedData.size > 0 ? this.checkForNamedRangeAndKeyValue(formula.substring(i)) : s;\n                    }\n                    else {\n                        s = this.parent.namedRanges.size > 0 ? this.checkForNamedRangeAndKeyValue(formula.substring(i)) : s;\n                    }\n                }\n                if (isNullOrUndefined(s)) {\n                    scopedRange = this.checkScopedRange(formula.substring(i));\n                    if (scopedRange !== 'NaN') {\n                        s = scopedRange;\n                    }\n                }\n                if (!isNullOrUndefined(s) && s !== this.emptyStr) {\n                    s = s.toUpperCase();\n                    s = this.parent.setTokensForSheets(s);\n                    s = this.markLibraryFormulas(s);\n                    if (s != null) {\n                        var val = formula.substring(i);\n                        if (val[val.length - 1] === ')') {\n                            formula = formula.substring(0, i) + s + ')';\n                        }\n                        else {\n                            formula = formula.substring(0, i) + s;\n                        }\n                        i += s.toString().length + 1;\n                    }\n                }\n                end = (i < formula.length) ? this.indexOfAny(formula.substring(i), markers) : -1;\n            }\n        }\n        if (formula.indexOf('#N~A') > -1) {\n            formula = formula.split('#N~A').join('#N/A');\n        }\n        if (formula.indexOf('#DIV~0!') > -1) {\n            formula = formula.split('#DIV~0!').join('#DIV/0!');\n        }\n        return formula;\n    };\n    /** @hidden */\n    Parser.prototype.checkForNamedRangeAndKeyValue = function (text) {\n        var scopedRange = this.emptyStr;\n        if (text.indexOf('[') > -1) {\n            var namerangeValue = this.getTableRange(text);\n            if (!isNullOrUndefined(namerangeValue)) {\n                this.findNamedRange = true;\n                text = namerangeValue;\n            }\n        }\n        scopedRange = this.checkScopedRange(text);\n        if (scopedRange !== 'NaN') {\n            this.findNamedRange = true;\n            text = scopedRange;\n        }\n        else {\n            if (text.indexOf(this.sheetToken) > -1) {\n                var sheet = this.parent.getSheetFamilyItem(this.parent.grid);\n                /* tslint:disable-next-line */\n                var value = text.split('\"').join(this.emptyStr);\n                value = value.substr(0, value.indexOf(this.sheetToken));\n                if (sheet.sheetNameToToken.has(value.toUpperCase())) {\n                    /* tslint:disable */\n                    var sheetIndex = parseInt(sheet.sheetNameToToken.get(value.toUpperCase()).split(this.sheetToken).join(this.emptyStr));\n                    // if (!ej.isNullOrUndefined(this.parentObject) && this.parentObject.pluginName == \"ejSpreadsheet\") {\n                    //     var name = text.replace(value, this.parentObject.model.sheets[(sheetIndex + 1)].sheetInfo.text.toUpperCase()).split(\"'\").join(this._string_empty);\n                    //     if (this.getNamedRanges().length > 0 && this.getNamedRanges().contains(name.toUpperCase())) {\n                    //         text = name;\n                    //     }\n                    // }\n                    /* tslint-enable */\n                }\n            }\n            if (this.parent.storedData.size > 0 && this.parent.storedData.has(text)) {\n                text = 'A' + this.parent.colIndex(text);\n            }\n            if (this.parent.namedRanges.size > 0 && this.parent.namedRanges.has(text.toUpperCase())) {\n                /* tslint:disable-next-line:no-any */\n                if (!isNullOrUndefined(this.parent.parentObject)) {\n                    text = this.parse(this.parent.namedRanges.get(text.toUpperCase()));\n                }\n                else {\n                    text = this.parse(this.parent.namedRanges.get(text.toUpperCase()));\n                    text = this.parent.setTokensForSheets(text);\n                    if (text.indexOf(this.fixedReference) > -1) {\n                        text.split(this.fixedReference).join(this.emptyStr);\n                    }\n                    this.findNamedRange = true;\n                }\n            }\n            if (this.findNamedRange) {\n                if (text[0] !== '!' && text[0] !== 'q' && text[0] !== 'bq') {\n                    text = this.parent.setTokensForSheets(text);\n                    if (text.indexOf(this.fixedReference) > -1) {\n                        text = text.split(this.fixedReference).join(this.emptyStr);\n                    }\n                }\n            }\n        }\n        return text;\n    };\n    Parser.prototype.getTableRange = function (text) {\n        text = text.replace(' ', this.emptyStr).toUpperCase();\n        var name = text.replace(']', this.emptyStr).replace('#DATA', this.emptyStr);\n        var tableName = name;\n        if (name.indexOf(this.parent.getParseArgumentSeparator()) > -1) {\n            tableName = name.substring(0, name.indexOf(this.parent.getParseArgumentSeparator())).replace('[', this.emptyStr);\n            name = name.replace('[', this.emptyStr).replace(this.parent.getParseArgumentSeparator(), '_');\n        }\n        var range = this.emptyStr;\n        return name.toUpperCase();\n    };\n    Parser.prototype.findNextEndIndex = function (formula, loc) {\n        var count = 0;\n        var l = loc;\n        var found = false;\n        while (!found && loc < formula.length) {\n            if (formula[l] === '[') {\n                count++;\n            }\n            else if (formula[l] === ']') {\n                count--;\n                if (count === 0) {\n                    found = true;\n                }\n            }\n            loc++;\n        }\n        loc = loc - l;\n        return loc;\n    };\n    ;\n    return Parser;\n}());\nexport { Parser };\n","/* tslint:disable-next-line:max-line-length */\nimport { getSheetName, getSheetIndex, getSheet, getSheetIndexByName } from '../base/index';\nimport { workbookFormulaOperation, getColumnHeaderText, aggregateComputation, getRangeIndexes } from '../common/index';\nimport { Calculate, ValueChangedArgs, CommonErrors, getAlphalabel } from '../../calculate/index';\nimport { isNullOrUndefined } from '@syncfusion/ej2-base';\nimport { getCellAddress } from '../common/index';\n/**\n * @hidden\n * The `WorkbookFormula` module is used to handle the formula operation in Workbook.\n */\nvar WorkbookFormula = /** @class */ (function () {\n    /**\n     * Constructor for formula module in Workbook.\n     * @private\n     */\n    function WorkbookFormula(workbook) {\n        this.sheetInfo = [];\n        this.parent = workbook;\n        this.init();\n    }\n    WorkbookFormula.prototype.init = function () {\n        this.addEventListener();\n        this.initCalculate();\n        this.registerSheet();\n        this.initiateDefinedNames();\n    };\n    /**\n     * To destroy the formula module.\n     * @return {void}\n     * @hidden\n     */\n    WorkbookFormula.prototype.destroy = function () {\n        this.removeEventListener();\n        this.calculateInstance.dispose();\n        this.calculateInstance = null;\n        this.parent = null;\n    };\n    WorkbookFormula.prototype.addEventListener = function () {\n        this.parent.on(workbookFormulaOperation, this.performFormulaOperation, this);\n        this.parent.on(aggregateComputation, this.aggregateComputation, this);\n    };\n    WorkbookFormula.prototype.removeEventListener = function () {\n        if (!this.parent.isDestroyed) {\n            this.parent.off(workbookFormulaOperation, this.performFormulaOperation);\n            this.parent.off(aggregateComputation, this.aggregateComputation);\n        }\n    };\n    /**\n     * Get the module name.\n     * @returns string\n     * @private\n     */\n    WorkbookFormula.prototype.getModuleName = function () {\n        return 'workbookFormula';\n    };\n    WorkbookFormula.prototype.initCalculate = function () {\n        this.calculateInstance = new Calculate(this.parent);\n        this.calcID = this.calculateInstance.createSheetFamilyID();\n        this.calculateInstance.setTreatEmptyStringAsZero(true);\n        this.calculateInstance.grid = this.parent.getActiveSheet().id.toString();\n    };\n    WorkbookFormula.prototype.performFormulaOperation = function (args) {\n        var action = args.action;\n        var formulas = this.calculateInstance.getLibraryFormulas();\n        var formulaInfo = (Array.from(formulas.values()));\n        switch (action) {\n            case 'getLibraryFormulas':\n                args.formulaCollection = Array.from(formulas.keys());\n                break;\n            case 'getFormulaCategory':\n                var collection = ['All'];\n                for (var i = 1; i < Array.from(formulas.values()).length; i++) {\n                    if (collection.indexOf(formulaInfo[i].category) < 0) {\n                        collection.push(formulaInfo[i].category);\n                    }\n                }\n                args.categoryCollection = collection;\n                break;\n            case 'dropDownSelectFormulas':\n                for (var i = 0; i < Array.from(formulas.values()).length; i++) {\n                    if (args.selectCategory === formulaInfo[i].category) {\n                        args.formulaCollection[i] = Array.from(formulas.keys())[i];\n                    }\n                }\n                break;\n            case 'getFormulaDescription':\n                for (var i = 0; i < Array.from(formulas.values()).length; i++) {\n                    if (args.selectedList === Array.from(formulas.keys())[i]) {\n                        args.description = formulaInfo[i].description;\n                    }\n                }\n                break;\n            case 'registerSheet':\n                this.registerSheet(args.sheetIndex, args.sheetCount);\n                break;\n            case 'unRegisterSheet':\n                this.unRegisterSheet(args.sheetIndex, args.sheetCount);\n                break;\n            case 'refreshCalculate':\n                args.value = this.autoCorrectFormula(args.value);\n                this.refreshCalculate(args.rowIndex, args.colIndex, args.value, args.isFormula, args.sheetIndex);\n                break;\n            case 'getArgumentSeparator':\n                args.argumentSeparator = this.calculateInstance.getParseArgumentSeparator();\n                break;\n            case 'addDefinedName':\n                args.isAdded = this.addDefinedName(args.definedName);\n                break;\n            case 'removeDefinedName':\n                args.isRemoved = this.removeDefinedName(args.definedName, args.scope);\n                break;\n            case 'initiateDefinedNames':\n                this.initiateDefinedNames();\n                break;\n            case 'renameUpdation':\n                this.renameUpdation(args.value, args.sheetId);\n                break;\n            case 'addSheet':\n                this.sheetInfo.push({ visibleName: args.visibleName, sheet: args.sheetName, index: args.index });\n                break;\n            case 'getSheetInfo':\n                args.sheetInfo = this.sheetInfo;\n                break;\n            case 'deleteSheetTab':\n                var length_1 = this.sheetInfo.length;\n                for (var i = 0; i < length_1; i++) {\n                    if (this.sheetInfo[i].index === args.index) {\n                        args.sheetName = this.sheetInfo[i].sheet;\n                        this.sheetInfo.splice(i, 1);\n                        break;\n                    }\n                }\n                this.sheetDeletion(args.sheetName, args.index, args.index);\n                break;\n            case 'getReferenceError':\n                args.refError = this.referenceError();\n                break;\n            case 'getAlpha':\n                args.col = getAlphalabel(args.col);\n                break;\n        }\n    };\n    WorkbookFormula.prototype.referenceError = function () {\n        return this.calculateInstance.getErrorStrings()[CommonErrors.ref];\n    };\n    WorkbookFormula.prototype.getSheetInfo = function () {\n        return this.sheetInfo;\n    };\n    WorkbookFormula.prototype.sheetDeletion = function (delSheetName, sheetId, index) {\n        var dependentCell = this.calculateInstance.getDependentCells();\n        var cellRef = [];\n        var fInfo = null;\n        var formulaVal = '';\n        var rowId;\n        var colId;\n        dependentCell.forEach(function (value, key) {\n            cellRef.push(key);\n        });\n        this.removeSheetTokenIndex(formulaVal, index);\n        for (var i = 0; i < cellRef.length; i++) {\n            var dependentCellRef = this.calculateInstance.getDependentCells().get(cellRef[i]);\n            for (var j = 0; j < dependentCellRef.length; j++) {\n                fInfo = this.calculateInstance.getFormulaInfoTable().get(dependentCellRef[j]);\n                sheetId = getSheetIndexByName(this.parent, ('Sheet') + (parseInt(dependentCellRef[j].split('!')[1], 10) + 1), this.sheetInfo);\n                if (!isNullOrUndefined(fInfo) && sheetId > -1) {\n                    formulaVal = fInfo.formulaText;\n                    if (formulaVal.toUpperCase().indexOf(delSheetName.toUpperCase()) > -1) {\n                        formulaVal = formulaVal.toUpperCase().split(delSheetName.toUpperCase() +\n                            this.calculateInstance.sheetToken).join(this.referenceError());\n                        rowId = this.calculateInstance.rowIndex(dependentCellRef[j]);\n                        colId = this.calculateInstance.colIndex(dependentCellRef[j]);\n                        this.updateDataContainer([rowId - 1, colId - 1], { value: formulaVal, sheetId: sheetId, visible: false });\n                        this.calculateInstance.refresh(fInfo.getParsedFormula());\n                    }\n                }\n            }\n        }\n    };\n    WorkbookFormula.prototype.removeSheetTokenIndex = function (value, index) {\n        var family = this.calculateInstance.getSheetFamilyItem(this.calculateInstance.grid);\n        family.sheetNameToToken.delete(index.toString());\n        return value;\n    };\n    WorkbookFormula.prototype.renameUpdation = function (name, sheetIdx) {\n        var dependentCellRef = this.calculateInstance.getDependentCells();\n        var cellRef = [];\n        var fInfo;\n        var formulaVal = '';\n        var savedTokens = [];\n        var isSheetRenamed = false;\n        var rowIndex;\n        var colIndex;\n        var sheetIndex;\n        dependentCellRef.forEach(function (value, key) {\n            cellRef.push(key);\n        });\n        for (var i = 0; i < this.sheetInfo.length; i++) {\n            if (this.sheetInfo[i].index === sheetIdx) {\n                this.sheetInfo[i].visibleName = name;\n                break;\n            }\n        }\n        var sheetNames = this.sheetInfo;\n        for (var i = 0; i < cellRef.length; i++) {\n            var dependentCells = this.calculateInstance.getDependentCells().get(cellRef[i]);\n            for (var j = 0; j < dependentCells.length; j++) {\n                fInfo = this.calculateInstance.getFormulaInfoTable().get(dependentCells[j]);\n                formulaVal = fInfo.formulaText;\n                for (var s = 0; s < sheetNames.length; s++) {\n                    if (sheetNames[s].visibleName !== sheetNames[s].sheet) {\n                        var name_1 = sheetNames[s].sheet.toUpperCase();\n                        if (formulaVal.toUpperCase().indexOf(name_1) > -1) {\n                            formulaVal = formulaVal.toUpperCase().split(name_1).join(s + '/');\n                            savedTokens.push(s);\n                            isSheetRenamed = true;\n                        }\n                    }\n                }\n                if (isSheetRenamed) {\n                    for (var k = 0; k < savedTokens.length; k++) {\n                        formulaVal = formulaVal.split(savedTokens[k].toString() + '/').join(sheetNames[savedTokens[k]].visibleName);\n                    }\n                    rowIndex = this.calculateInstance.rowIndex(dependentCells[j]);\n                    colIndex = this.calculateInstance.colIndex(dependentCells[j]);\n                    sheetIndex = getSheetIndexByName(this.parent, ('Sheet') + (parseInt(dependentCells[j].split('!')[1], 10) + 1), this.sheetInfo);\n                    this.updateDataContainer([rowIndex - 1, colIndex - 1], { value: formulaVal, sheetId: sheetIndex, visible: true });\n                }\n            }\n        }\n    };\n    WorkbookFormula.prototype.updateDataContainer = function (indexes, data) {\n        var rowIndex = indexes[0];\n        var colIndex = indexes[1];\n        var sheetData;\n        var rowData;\n        var colObj;\n        var len = this.parent.sheets.length;\n        for (var i = 0; i < len; i++) {\n            if (this.parent.sheets[i].id === data.sheetId) {\n                sheetData = this.parent.sheets[i].rows;\n                break;\n            }\n        }\n        if (!isNullOrUndefined(data)) {\n            if (rowIndex in sheetData) {\n                rowData = sheetData[rowIndex];\n                if (colIndex in rowData.cells) {\n                    colObj = rowData.cells[colIndex];\n                    colObj.formula = data.value;\n                    colObj.value = data.visible ? colObj.value : this.referenceError();\n                }\n                else {\n                    rowData.cells[colIndex] = colObj = {};\n                }\n            }\n            else {\n                rowData = sheetData[rowIndex] = {};\n                rowData[colIndex] = colObj = {};\n            }\n        }\n    };\n    WorkbookFormula.prototype.parseSheetRef = function (value) {\n        var sheetInfo = this.getSheetInfo();\n        var sheetCount = this.parent.sheets.length;\n        for (var j = 0; j < sheetCount; j++) {\n            if (sheetInfo[j].sheet.toUpperCase() !== sheetInfo[j].visibleName.toUpperCase()) {\n                var name_2 = sheetInfo[j].visibleName.toUpperCase();\n                if (value.toUpperCase().indexOf(name_2) > -1) {\n                    value = value.toUpperCase().split(name_2).join(sheetInfo[j].sheet);\n                }\n            }\n        }\n        return value;\n    };\n    WorkbookFormula.prototype.registerSheet = function (sheetIndex, sheetCount) {\n        if (sheetIndex === void 0) { sheetIndex = 0; }\n        if (sheetCount === void 0) { sheetCount = this.parent.sheets.length; }\n        var id;\n        while (sheetIndex < sheetCount) {\n            id = getSheet(this.parent, sheetIndex).id + '';\n            this.calculateInstance.registerGridAsSheet(id, id, this.calcID);\n            sheetIndex++;\n        }\n    };\n    WorkbookFormula.prototype.unRegisterSheet = function (sheetIndex, sheetCount) {\n        if (sheetIndex === void 0) { sheetIndex = 0; }\n        if (sheetCount === void 0) { sheetCount = this.parent.sheets.length; }\n        var id;\n        this.calculateInstance.tokenCount = 0;\n        while (sheetIndex < sheetCount) {\n            id = getSheet(this.parent, sheetIndex).id + '';\n            this.calculateInstance.unregisterGridAsSheet(id, id);\n            sheetIndex++;\n        }\n    };\n    WorkbookFormula.prototype.refreshCalculate = function (rowIdx, colIdx, value, isFormula, sheetIdx) {\n        if (!sheetIdx) {\n            sheetIdx = this.parent.activeSheetTab;\n        }\n        sheetIdx--;\n        var sheetName = getSheet(this.parent, sheetIdx).id + '';\n        if (isFormula) {\n            value = this.parseSheetRef(value);\n            var cellArgs = new ValueChangedArgs(rowIdx + 1, colIdx + 1, value);\n            this.calculateInstance.valueChanged(sheetName, cellArgs, true);\n            var referenceCollection = this.calculateInstance.randCollection;\n            if (this.calculateInstance.isRandomVal === true) {\n                var rowId = void 0;\n                var colId = void 0;\n                var refValue = '';\n                if (this.calculateInstance.randomValues.size > 1 && this.calculateInstance.randomValues.size ===\n                    referenceCollection.length) {\n                    for (var i = 0; i < this.calculateInstance.randomValues.size; i++) {\n                        rowId = this.calculateInstance.rowIndex(referenceCollection[i]);\n                        colId = this.calculateInstance.colIndex(referenceCollection[i]);\n                        refValue = this.calculateInstance.randomValues.get(referenceCollection[i]);\n                        sheetName = (parseFloat(this.calculateInstance.getSheetToken(referenceCollection[i]).split(this.calculateInstance.sheetToken).join('')) + 1).toString();\n                        var tempArgs = new ValueChangedArgs(rowId, colId, refValue);\n                        this.calculateInstance.valueChanged(sheetName, tempArgs, true);\n                    }\n                }\n            }\n        }\n        else {\n            var family = this.calculateInstance.getSheetFamilyItem(sheetName);\n            var cellRef = getColumnHeaderText(colIdx + 1) + (rowIdx + 1);\n            if (family.isSheetMember && !isNullOrUndefined(family.parentObjectToToken)) {\n                cellRef = family.parentObjectToToken.get(sheetName) + cellRef;\n            }\n            if (this.calculateInstance.getFormulaInfoTable().has(cellRef)) {\n                this.calculateInstance.getFormulaInfoTable().delete(cellRef);\n                if (this.calculateInstance.getDependentCells().has(cellRef)) {\n                    this.calculateInstance.clearFormulaDependentCells(cellRef);\n                }\n            }\n            this.calculateInstance.getComputedValue().clear();\n            this.calculateInstance.refresh(cellRef);\n            this.calculateInstance.refreshRandValues(cellRef);\n        }\n    };\n    WorkbookFormula.prototype.autoCorrectFormula = function (formula) {\n        if (formula.split('(').length === 2 && formula.indexOf(')') < 0) {\n            formula += ')';\n        }\n        return formula;\n    };\n    WorkbookFormula.prototype.initiateDefinedNames = function () {\n        var definedNames = this.parent.definedNames;\n        var len = definedNames.length;\n        var i = 0;\n        while (i < len) {\n            var definedname = definedNames[i];\n            this.addDefinedName(definedname);\n            i++;\n        }\n    };\n    /**\n     * @hidden\n     * Used to add defined name to workbook.\n     * @param {DefineNameModel} name - Define named range.\n     */\n    WorkbookFormula.prototype.addDefinedName = function (definedName) {\n        var isAdded = true;\n        var sheetIdx = null;\n        var name = definedName.name;\n        var refersTo = definedName.refersTo.indexOf('!') > 0 ? definedName.refersTo :\n            getSheetName(this.parent) + '!' + definedName.refersTo;\n        if (definedName.scope) {\n            sheetIdx = getSheetIndex(this.parent, definedName.scope);\n            if (sheetIdx) {\n                name = getSheetName(this.parent, sheetIdx - 1) + '!' + name;\n            }\n        }\n        else {\n            definedName.scope = '';\n        }\n        if (!definedName.comment) {\n            definedName.comment = '';\n        }\n        //need to extend once internal sheet value changes done.\n        if (this.checkIsNameExist(definedName.name, definedName.scope)) {\n            isAdded = false;\n        }\n        else {\n            this.calculateInstance.addNamedRange(name, refersTo[0] === '=' ? refersTo.substr(1) : refersTo);\n            if (refersTo[0] !== '=') {\n                definedName.refersTo = '=' + refersTo;\n            }\n            this.parent.definedNames.push(definedName);\n        }\n        return isAdded;\n    };\n    /**\n     * @hidden\n     * Used to remove defined name from workbook.\n     * @param {string} name - Specifies the defined name.\n     * @param {string} scope - Specifies the scope of the define name.\n     */\n    WorkbookFormula.prototype.removeDefinedName = function (name, scope) {\n        var isRemoved = false;\n        var index = this.getIndexFromNameColl(name, scope);\n        if (index > -1) {\n            var calcName = name;\n            if (scope) {\n                var sheetIdx = getSheetIndex(this.parent, scope);\n                if (sheetIdx) {\n                    calcName = getSheetName(this.parent, sheetIdx - 1) + '!' + name;\n                }\n            }\n            this.calculateInstance.removeNamedRange(calcName);\n            this.parent.definedNames.splice(index, 1);\n            isRemoved = true;\n        }\n        return isRemoved;\n    };\n    WorkbookFormula.prototype.checkIsNameExist = function (name, sheetName) {\n        var isExist = this.parent.definedNames.some(function (key) {\n            return key.name === name && (sheetName ? key.scope === sheetName : key.scope === '');\n        });\n        return isExist;\n    };\n    WorkbookFormula.prototype.getIndexFromNameColl = function (definedName, scope) {\n        if (scope === void 0) { scope = ''; }\n        var index = -1;\n        this.parent.definedNames.filter(function (name, idx) {\n            if (name.name === definedName && name.scope === scope) {\n                index = idx;\n            }\n        });\n        return index;\n    };\n    WorkbookFormula.prototype.toFixed = function (value) {\n        var num = Number(value);\n        if (Math.round(num) !== num) {\n            value = num.toFixed(2);\n        }\n        return value;\n    };\n    WorkbookFormula.prototype.aggregateComputation = function (args) {\n        var sheet = this.parent.getActiveSheet();\n        var range = sheet.selectedRange;\n        var indexes = getRangeIndexes(range.split(':')[1]);\n        if (indexes[0] + 1 === sheet.rowCount && indexes[1] + 1 === sheet.colCount) {\n            range = \"A1:\" + getCellAddress(sheet.usedRange.rowIndex, sheet.usedRange.colIndex);\n        }\n        args.Count = this.calculateInstance.getFunction('COUNTA')(range);\n        if (!args.Count) {\n            return;\n        }\n        args.Sum = this.toFixed(this.calculateInstance.getFunction('SUM')(range));\n        args.Avg = this.toFixed(this.calculateInstance.getFunction('AVERAGE')(range));\n        args.Min = this.toFixed(this.calculateInstance.getFunction('MIN')(range));\n        args.Max = this.toFixed(this.calculateInstance.getFunction('MAX')(range));\n    };\n    return WorkbookFormula;\n}());\nexport { WorkbookFormula };\n","import { getCell, setCell, getData } from '../base/index';\nimport { DataManager, Query, DataUtil, Deferred } from '@syncfusion/ej2-data';\nimport { getCellIndexes, getIndexesFromAddress, getColumnHeaderText, getRangeAddress, workbookLocale } from '../common/index';\nimport { getSwapRange } from '../common/index';\nimport { initiateSort } from '../common/event';\nimport { isNullOrUndefined } from '@syncfusion/ej2-base';\n/**\n * The `WorkbookSort` module is used to handle sort action in Spreadsheet.\n */\nvar WorkbookSort = /** @class */ (function () {\n    /**\n     * Constructor for WorkbookSort module.\n     */\n    function WorkbookSort(parent) {\n        this.parent = parent;\n        this.addEventListener();\n    }\n    /**\n     * To destroy the sort module.\n     */\n    WorkbookSort.prototype.destroy = function () {\n        this.removeEventListener();\n        this.parent = null;\n    };\n    WorkbookSort.prototype.addEventListener = function () {\n        this.parent.on(initiateSort, this.initiateSortHandler, this);\n    };\n    WorkbookSort.prototype.removeEventListener = function () {\n        if (!this.parent.isDestroyed) {\n            this.parent.off(initiateSort, this.initiateSortHandler);\n        }\n    };\n    /**\n     * Sorts range of cells in the sheet.\n     * @param args - arguments for sorting.\n     */\n    WorkbookSort.prototype.initiateSortHandler = function (eventArgs) {\n        var _this = this;\n        var args = eventArgs.args;\n        var deferred = new Deferred();\n        var sheet = this.parent.getActiveSheet();\n        var range = getSwapRange(getIndexesFromAddress(args.range));\n        var sortOptions = args.sortOptions || { sortDescriptors: {}, containsHeader: true };\n        var isSingleCell = false;\n        eventArgs.promise = deferred.promise;\n        if (range[0] > sheet.usedRange.rowIndex - 1 || range[1] > sheet.usedRange.colIndex) {\n            deferred.reject(this.parent.serviceLocator.getService(workbookLocale).getConstant('SortOutOfRangeError'));\n            return;\n        }\n        var containsHeader = sortOptions.containsHeader;\n        if (range[0] === range[2] && (range[2] - range[0]) === 0) { //if selected range is a single cell \n            range[0] = 0;\n            range[1] = 0;\n            range[2] = sheet.usedRange.rowIndex - 1;\n            range[3] = sheet.usedRange.colIndex;\n            isSingleCell = true;\n            containsHeader = isNullOrUndefined(sortOptions.containsHeader) ? true : sortOptions.containsHeader;\n        }\n        if ((isNullOrUndefined(args.sortOptions) || isNullOrUndefined(args.sortOptions.containsHeader)) && !isSingleCell) {\n            if (!isNullOrUndefined(getCell(range[0], range[1], sheet)) && !isNullOrUndefined(getCell(range[0] + 1, range[1], sheet))) {\n                if (typeof getCell(range[0], range[1], sheet).value === typeof getCell(range[0] + 1, range[1], sheet).value) {\n                    containsHeader = false;\n                }\n                else {\n                    containsHeader = true;\n                }\n            }\n        }\n        var sRIdx = range[0] = containsHeader ? range[0] + 1 : range[0];\n        var sCIdx;\n        var eCIdx;\n        var cell = getCellIndexes(sheet.activeCell);\n        var header = getColumnHeaderText(cell[1] + 1);\n        var sortDescriptors = sortOptions.sortDescriptors;\n        var address = getRangeAddress(range);\n        getData(this.parent, sheet.name + \"!\" + address, true).then(function (jsonData) {\n            var dataManager = new DataManager(jsonData);\n            var query = new Query();\n            if (Array.isArray(sortDescriptors)) { //multi-column sorting.\n                if (!sortDescriptors || sortDescriptors.length === 0) {\n                    sortDescriptors = [{ field: header }];\n                }\n                for (var length_1 = sortDescriptors.length, i = length_1 - 1; i > -1; i--) {\n                    if (!sortDescriptors[length_1 - 1].field) {\n                        sortDescriptors[length_1 - 1].field = header;\n                    }\n                    if (!sortDescriptors[i].field) {\n                        continue;\n                    }\n                    var comparerFn = sortDescriptors[i].sortComparer\n                        || _this.sortComparer.bind(_this, sortDescriptors[i], sortOptions.caseSensitive);\n                    query.sortBy(sortDescriptors[i].field, comparerFn);\n                }\n            }\n            else { //single column sorting.\n                if (!sortDescriptors) {\n                    sortDescriptors = { field: header };\n                }\n                if (!sortDescriptors.field) {\n                    sortDescriptors.field = header;\n                }\n                var comparerFn = sortDescriptors.sortComparer\n                    || _this.sortComparer.bind(_this, sortDescriptors, sortOptions.caseSensitive);\n                query.sortBy(sortDescriptors.field, comparerFn);\n            }\n            dataManager.executeQuery(query).then(function (e) {\n                var colName;\n                var cell = {};\n                var rowKey = '__rowIndex';\n                Array.prototype.forEach.call(e.result, function (data, index) {\n                    if (!data) {\n                        return;\n                    }\n                    sCIdx = range[1];\n                    eCIdx = range[3];\n                    sRIdx = parseInt(jsonData[index][rowKey], 10) - 1;\n                    for (sCIdx; sCIdx <= eCIdx; sCIdx++) {\n                        colName = getColumnHeaderText(sCIdx + 1);\n                        cell = data[colName];\n                        setCell(sRIdx, sCIdx, sheet, cell);\n                    }\n                });\n                var eventArgs = { range: sheet.name + \"!\" + address, sortOptions: args.sortOptions };\n                deferred.resolve(eventArgs);\n            });\n        });\n    };\n    /**\n     * Compares the two cells for sorting.\n     * @param sortDescriptor - protocol for sorting.\n     * @param caseSensitive - value for case sensitive.\n     * @param x - first cell\n     * @param y - second cell\n     */\n    WorkbookSort.prototype.sortComparer = function (sortDescriptor, caseSensitive, x, y) {\n        var direction = sortDescriptor.order || '';\n        var comparer = DataUtil.fnSort(direction);\n        var caseOptions = { sensitivity: caseSensitive ? 'case' : 'base' };\n        if (x && y && typeof x.value === 'string') {\n            var collator = new Intl.Collator(this.parent.locale, caseOptions);\n            if (!direction || direction.toLowerCase() === 'ascending') {\n                return collator.compare(x.value, y.value);\n            }\n            else {\n                return collator.compare(x.value, y.value) * -1;\n            }\n        }\n        return comparer(x ? x.value : x, y ? y.value : y);\n    };\n    /**\n     * Gets the module name.\n     * @returns string\n     */\n    WorkbookSort.prototype.getModuleName = function () {\n        return 'workbookSort';\n    };\n    return WorkbookSort;\n}());\nexport { WorkbookSort };\n","import { getData } from '../base/index';\nimport { DataManager, Query, Deferred, Predicate } from '@syncfusion/ej2-data';\nimport { getCellIndexes, getIndexesFromAddress, getSwapRange, getRangeAddress } from '../common/index';\nimport { initiateFilter, clearAllFilter } from '../common/event';\n/**\n * The `WorkbookFilter` module is used to handle filter action in Spreadsheet.\n */\nvar WorkbookFilter = /** @class */ (function () {\n    /**\n     * Constructor for WorkbookFilter module.\n     */\n    function WorkbookFilter(parent) {\n        this.parent = parent;\n        this.addEventListener();\n    }\n    /**\n     * To destroy the filter module.\n     */\n    WorkbookFilter.prototype.destroy = function () {\n        this.removeEventListener();\n        this.filterRange = null;\n        this.parent = null;\n    };\n    WorkbookFilter.prototype.addEventListener = function () {\n        this.parent.on(initiateFilter, this.initiateFilterHandler, this);\n        this.parent.on(clearAllFilter, this.clearAllFilterHandler, this);\n    };\n    WorkbookFilter.prototype.removeEventListener = function () {\n        if (!this.parent.isDestroyed) {\n            this.parent.off(initiateFilter, this.initiateFilterHandler);\n            this.parent.off(clearAllFilter, this.clearAllFilterHandler);\n        }\n    };\n    /**\n     * Filters a range of cells in the sheet.\n     * @param args - arguments for filtering.\n     */\n    WorkbookFilter.prototype.initiateFilterHandler = function (eventArgs) {\n        var _this = this;\n        var args = eventArgs.args;\n        var deferred = new Deferred();\n        var sheet = this.parent.getActiveSheet();\n        var filterOptions = args.filterOptions || {};\n        eventArgs.promise = deferred.promise;\n        this.filterRange = args.range;\n        if (filterOptions.datasource) {\n            this.setFilter(filterOptions.datasource, filterOptions.predicates);\n            var filterEventArgs = { range: args.range, filterOptions: filterOptions };\n            deferred.resolve(filterEventArgs);\n        }\n        else {\n            var range = getSwapRange(getIndexesFromAddress(args.range));\n            if (range[0] > sheet.usedRange.rowIndex - 1 || range[1] > sheet.usedRange.colIndex) {\n                deferred.reject('Select a cell or range inside the used range and try again.');\n                return;\n            }\n            if (range[0] === range[2] && (range[2] - range[0]) === 0) { //if selected range is a single cell \n                range[0] = 0;\n                range[1] = 0;\n                range[3] = sheet.usedRange.colIndex;\n            }\n            range[2] = sheet.usedRange.rowIndex - 1; //filter range should be till used range.\n            range[0] = range[0] + 1; //ignore first row        \n            var address_1 = getRangeAddress(range);\n            getData(this.parent, sheet.name + \"!\" + address_1, true, true).then(function (jsonData) {\n                var dataManager = new DataManager(jsonData);\n                _this.setFilter(dataManager, filterOptions.predicates);\n                var filterEventArgs = { range: address_1, filterOptions: filterOptions };\n                deferred.resolve(filterEventArgs);\n            });\n        }\n    };\n    /**\n     * Hides or unhides the rows based on the filter predicates.\n     */\n    WorkbookFilter.prototype.setFilter = function (dataManager, predicates) {\n        var _this = this;\n        if (dataManager && predicates) {\n            var jsonData = dataManager.dataSource.json;\n            var query = new Query();\n            if (predicates.length) {\n                query.where(Predicate.and(predicates));\n            }\n            var result_1 = dataManager.executeLocal(query);\n            var rowKey_1 = '__rowIndex';\n            jsonData.forEach(function (data, index) {\n                if (!data) {\n                    return;\n                }\n                _this.parent.showHideRow(result_1.indexOf(data) < 0, parseInt(data[rowKey_1], 10) - 1);\n            });\n        }\n    };\n    /**\n     * Clears all the filters in the sheet.\n     */\n    WorkbookFilter.prototype.clearAllFilterHandler = function () {\n        if (this.filterRange) {\n            var range = getCellIndexes(this.filterRange);\n            var sheet = this.parent.getActiveSheet();\n            this.parent.showHideRow(false, range[0], sheet.usedRange.rowIndex - 1);\n        }\n    };\n    /**\n     * Gets the module name.\n     * @returns string\n     */\n    WorkbookFilter.prototype.getModuleName = function () {\n        return 'workbookFilter';\n    };\n    return WorkbookFilter;\n}());\nexport { WorkbookFilter };\n","import { getRangeIndexes, setCellFormat, applyCellFormat, activeCellChanged, } from '../common/index';\nimport { getSwapRange, textDecorationUpdate } from '../common/index';\nimport { setCell, getSheetIndex } from '../base/index';\nimport { completeAction, beginAction } from '../../spreadsheet/common/event';\n/**\n * Workbook Cell format.\n */\nvar WorkbookCellFormat = /** @class */ (function () {\n    function WorkbookCellFormat(parent) {\n        this.parent = parent;\n        this.addEventListener();\n    }\n    WorkbookCellFormat.prototype.format = function (args) {\n        var sheet;\n        var rng = args.range;\n        if (rng && typeof rng === 'string' && rng.indexOf('!') > -1) {\n            rng = rng.split('!')[1];\n            sheet = this.parent.sheets[getSheetIndex(this.parent, args.range.split('!')[0])];\n        }\n        else {\n            sheet = this.parent.getActiveSheet();\n        }\n        var eventArgs;\n        if (rng === undefined) {\n            rng = sheet.selectedRange;\n        }\n        var triggerEvent = typeof (rng) !== 'object' && args.onActionUpdate;\n        eventArgs = { range: rng, style: args.style, requestType: 'CellFormat' };\n        if (triggerEvent) {\n            this.parent.trigger('beforeCellFormat', eventArgs);\n            this.parent.notify(beginAction, { eventArgs: eventArgs, action: 'format' });\n            if (eventArgs.cancel) {\n                args.cancel = true;\n                return;\n            }\n        }\n        var indexes = typeof (eventArgs.range) === 'object' ? eventArgs.range :\n            getSwapRange(getRangeIndexes(eventArgs.range));\n        for (var i = indexes[0]; i <= indexes[2]; i++) {\n            for (var j = indexes[1]; j <= indexes[3]; j++) {\n                setCell(i, j, sheet, { style: eventArgs.style }, true);\n                if (this.parent.getActiveSheet().id === sheet.id) {\n                    this.parent.notify(applyCellFormat, {\n                        style: eventArgs.style, rowIdx: i, colIdx: j, lastCell: j === indexes[3],\n                        isHeightCheckNeeded: true, manualUpdate: true,\n                        onActionUpdate: args.onActionUpdate\n                    });\n                }\n            }\n        }\n        this.parent.setUsedRange(indexes[2], indexes[3]);\n        if (args.refreshRibbon) {\n            this.parent.notify(activeCellChanged, getRangeIndexes(sheet.activeCell));\n        }\n        this.parent.setProperties({ 'sheets': this.parent.sheets }, true);\n        if (triggerEvent) {\n            eventArgs.range = sheet.name + '!' + rng;\n            this.parent.notify(completeAction, { eventArgs: eventArgs, action: 'format' });\n        }\n    };\n    WorkbookCellFormat.prototype.textDecorationActionUpdate = function (args) {\n        var sheet = this.parent.getActiveSheet();\n        var eventArgs = { range: sheet.selectedRange, style: args.style, requestType: 'CellFormat' };\n        this.parent.trigger('beforeCellFormat', eventArgs);\n        this.parent.notify(beginAction, { eventArgs: eventArgs, action: 'format' });\n        if (eventArgs.cancel) {\n            args.cancel = true;\n            return;\n        }\n        var indexes = getSwapRange(getRangeIndexes(sheet.selectedRange));\n        var value = args.style.textDecoration;\n        var changedValue = value;\n        var activeCellIndexes = getRangeIndexes(sheet.activeCell);\n        var cellValue = this.parent.getCellStyleValue(['textDecoration'], activeCellIndexes).textDecoration;\n        var changedStyle;\n        var removeProp = false;\n        if (cellValue === 'underline') {\n            changedValue = value === 'underline' ? 'none' : 'underline line-through';\n        }\n        else if (cellValue === 'line-through') {\n            changedValue = value === 'line-through' ? 'none' : 'underline line-through';\n        }\n        else if (cellValue === 'underline line-through') {\n            changedValue = value === 'underline' ? 'line-through' : 'underline';\n            removeProp = true;\n        }\n        if (changedValue === 'none') {\n            removeProp = true;\n        }\n        this.format({\n            style: { textDecoration: changedValue }, range: activeCellIndexes, refreshRibbon: args.refreshRibbon,\n            onActionUpdate: true\n        });\n        for (var i = indexes[0]; i <= indexes[2]; i++) {\n            for (var j = indexes[1]; j <= indexes[3]; j++) {\n                if (i === activeCellIndexes[0] && j === activeCellIndexes[1]) {\n                    continue;\n                }\n                changedStyle = {};\n                cellValue = this.parent.getCellStyleValue(['textDecoration'], [i, j]).textDecoration;\n                if (cellValue === 'none') {\n                    if (removeProp) {\n                        continue;\n                    }\n                    changedStyle.textDecoration = value;\n                }\n                else if (cellValue === 'underline' || cellValue === 'line-through') {\n                    if (removeProp) {\n                        if (value === cellValue) {\n                            changedStyle.textDecoration = 'none';\n                        }\n                        else {\n                            continue;\n                        }\n                    }\n                    else {\n                        changedStyle.textDecoration = value !== cellValue ? 'underline line-through' : value;\n                    }\n                }\n                else if (cellValue === 'underline line-through') {\n                    if (removeProp) {\n                        changedStyle.textDecoration = value === 'underline' ? 'line-through' : 'underline';\n                    }\n                    else {\n                        continue;\n                    }\n                }\n                this.format({\n                    style: changedStyle, range: [i, j, i, j], refreshRibbon: args.refreshRibbon,\n                    onActionUpdate: true\n                });\n            }\n        }\n        eventArgs.range = sheet.name + '!' + eventArgs.range;\n        this.parent.notify(completeAction, { eventArgs: eventArgs, action: 'format' });\n    };\n    WorkbookCellFormat.prototype.addEventListener = function () {\n        this.parent.on(setCellFormat, this.format, this);\n        this.parent.on(textDecorationUpdate, this.textDecorationActionUpdate, this);\n    };\n    WorkbookCellFormat.prototype.removeEventListener = function () {\n        if (!this.parent.isDestroyed) {\n            this.parent.off(setCellFormat, this.format);\n            this.parent.off(textDecorationUpdate, this.textDecorationActionUpdate);\n        }\n    };\n    /**\n     * To destroy workbook cell format.\n     */\n    WorkbookCellFormat.prototype.destroy = function () {\n        this.removeEventListener();\n        this.parent = null;\n    };\n    /**\n     * Get the workbook cell format module name.\n     */\n    WorkbookCellFormat.prototype.getModuleName = function () {\n        return 'workbookcellformat';\n    };\n    return WorkbookCellFormat;\n}());\nexport { WorkbookCellFormat };\n","import { getCell, getSheet } from '../base/index';\nimport { workbookEditOperation, checkDateFormat, workbookFormulaOperation } from '../common/event';\nimport { getRangeIndexes } from '../common/index';\nimport { isNullOrUndefined, getNumericObject } from '@syncfusion/ej2-base';\nimport { checkIsFormula } from '../../workbook/common/index';\n/**\n * The `WorkbookEdit` module is used to handle the editing functionalities in Workbook.\n */\nvar WorkbookEdit = /** @class */ (function () {\n    /**\n     * Constructor for edit module in Workbook.\n     * @private\n     */\n    function WorkbookEdit(workbook) {\n        this.parent = workbook;\n        this.localeObj = getNumericObject(this.parent.locale);\n        /* tslint:disable:no-any */\n        this.decimalSep = this.localeObj.decimal;\n        this.addEventListener();\n    }\n    /**\n     * To destroy the edit module.\n     * @return {void}\n     * @hidden\n     */\n    WorkbookEdit.prototype.destroy = function () {\n        this.removeEventListener();\n        this.parent = null;\n    };\n    WorkbookEdit.prototype.addEventListener = function () {\n        this.parent.on(workbookEditOperation, this.performEditOperation, this);\n    };\n    WorkbookEdit.prototype.removeEventListener = function () {\n        if (!this.parent.isDestroyed) {\n            this.parent.off(workbookEditOperation, this.performEditOperation);\n        }\n    };\n    /**\n     * Get the module name.\n     * @returns string\n     * @private\n     */\n    WorkbookEdit.prototype.getModuleName = function () {\n        return 'workbookEdit';\n    };\n    WorkbookEdit.prototype.performEditOperation = function (args) {\n        var action = args.action;\n        switch (action) {\n            case 'updateCellValue':\n                this.updateCellValue(args.address, args.value, args.sheetIndex, args.isValueOnly);\n                break;\n        }\n    };\n    WorkbookEdit.prototype.checkDecimalPoint = function (value) {\n        if (Number(value)) {\n            var decIndex = value.toString().indexOf(this.decimalSep) + 1;\n            var checkDec = value.toString().substr(decIndex).length <= 6;\n            value = checkDec ? decIndex < 7 ? value : (parseFloat(value)).toFixed(0) : decIndex > 7 ? (parseFloat(value)).toFixed(0) :\n                (parseFloat(value)).toFixed(6 - decIndex + 2);\n        }\n        return value;\n    };\n    WorkbookEdit.prototype.updateCellValue = function (address, value, sheetIdx, isValueOnly) {\n        if (isValueOnly === void 0) { isValueOnly = false; }\n        if (!sheetIdx) {\n            sheetIdx = this.parent.activeSheetTab;\n        }\n        var range;\n        if (typeof address === 'string') {\n            range = getRangeIndexes(address);\n        }\n        else {\n            range = address;\n        }\n        var sheet = getSheet(this.parent, sheetIdx - 1);\n        if (!sheet.rows[range[0]]) {\n            sheet.rows[range[0]] = {};\n            sheet.rows[range[0]].cells = [];\n        }\n        if (!sheet.rows[range[0]].cells[range[1]]) {\n            sheet.rows[range[0]].cells[range[1]] = {};\n        }\n        var cell = getCell(range[0], range[1], sheet);\n        if (!isValueOnly) {\n            var isFormula = checkIsFormula(value);\n            if (!isFormula) {\n                cell.formula = '';\n                cell.value = value;\n            }\n            var eventArgs = {\n                action: 'refreshCalculate',\n                value: value,\n                rowIndex: range[0],\n                colIndex: range[1],\n                sheetIndex: sheetIdx,\n                isFormula: isFormula\n            };\n            this.parent.notify(workbookFormulaOperation, eventArgs);\n            if (isFormula) {\n                cell.formula = eventArgs.value;\n                value = cell.value;\n            }\n            var dateEventArgs = {\n                value: value,\n                rowIndex: range[0],\n                colIndex: range[1],\n                sheetIndex: sheetIdx,\n                updatedVal: ''\n            };\n            this.parent.notify(checkDateFormat, dateEventArgs);\n            if (!isNullOrUndefined(dateEventArgs.updatedVal) && dateEventArgs.updatedVal.length > 0) {\n                cell.value = dateEventArgs.updatedVal;\n                this.parent.setProperties({ 'sheets': this.parent.sheets }, true);\n            }\n        }\n        else {\n            if (value.toString().indexOf(this.decimalSep) > -1) {\n                value = this.checkDecimalPoint(value);\n            }\n            cell.value = value;\n            this.parent.setProperties({ 'sheets': this.parent.sheets }, true);\n        }\n        this.parent.setUsedRange(range[0] + 1, range[1]);\n    };\n    return WorkbookEdit;\n}());\nexport { WorkbookEdit };\n","import { setLinkModel } from '../common/event';\nimport { getRangeIndexes } from '../common/address';\nimport { isNullOrUndefined } from '@syncfusion/ej2-base';\n/**\n * The `WorkbookHyperlink` module is used to handle Hyperlink action in Spreadsheet.\n */\nvar WorkbookHyperlink = /** @class */ (function () {\n    /**\n     * Constructor for WorkbookSort module.\n     */\n    function WorkbookHyperlink(parent) {\n        this.parent = parent;\n        this.addEventListener();\n    }\n    /**\n     * To destroy the sort module.\n     */\n    WorkbookHyperlink.prototype.destroy = function () {\n        this.removeEventListener();\n        this.parent = null;\n    };\n    WorkbookHyperlink.prototype.addEventListener = function () {\n        this.parent.on(setLinkModel, this.setLinkHandler, this);\n    };\n    WorkbookHyperlink.prototype.removeEventListener = function () {\n        if (!this.parent.isDestroyed) {\n            this.parent.off(setLinkModel, this.setLinkHandler);\n        }\n    };\n    WorkbookHyperlink.prototype.setLinkHandler = function (args) {\n        var hyperlink = args.hyperlink;\n        var cellAddr = args.cell;\n        var range;\n        var sheetIdx;\n        var cellIdx;\n        var sheet = this.parent.getActiveSheet();\n        var address;\n        if (cellAddr && cellAddr.indexOf('!') !== -1) {\n            range = cellAddr.split('!');\n            sheetIdx = parseInt(range[0].replace(/\\D/g, ''), 10) - 1;\n            sheet = this.parent.sheets[sheetIdx];\n            cellAddr = range[1];\n        }\n        cellAddr = cellAddr ? cellAddr : this.parent.getActiveSheet().activeCell;\n        cellIdx = getRangeIndexes(cellAddr);\n        var rowIdx = cellIdx[0];\n        var colIdx = cellIdx[1];\n        if (!sheet) {\n            return;\n        }\n        if (isNullOrUndefined(sheet.rows[rowIdx])) {\n            sheet.rows[rowIdx] = {};\n        }\n        if (isNullOrUndefined(sheet.rows[rowIdx].cells)) {\n            sheet.rows[rowIdx].cells = [];\n        }\n        if (isNullOrUndefined(sheet.rows[rowIdx].cells[colIdx])) {\n            sheet.rows[rowIdx].cells[colIdx] = {};\n        }\n        if (typeof (hyperlink) === 'string') {\n            if (hyperlink.indexOf('http://') === -1 && hyperlink.indexOf('www.') !== -1) {\n                address = 'http://' + hyperlink;\n            }\n            else {\n                address = hyperlink;\n            }\n            sheet.rows[rowIdx].cells[colIdx].hyperlink = address;\n        }\n        else {\n            if (hyperlink.address.indexOf('http://') === -1 && hyperlink.address.indexOf('www.') !== -1) {\n                address = 'http://' + hyperlink.address;\n            }\n            else {\n                address = hyperlink.address;\n            }\n            sheet.rows[rowIdx].cells[colIdx].hyperlink = {\n                address: address,\n            };\n        }\n    };\n    /**\n     * Gets the module name.\n     * @returns string\n     */\n    WorkbookHyperlink.prototype.getModuleName = function () {\n        return 'workbookHyperlink';\n    };\n    return WorkbookHyperlink;\n}());\nexport { WorkbookHyperlink };\n","import { Workbook, DataBind } from '../index';\nimport { WorkbookSave, WorkbookFormula, WorkbookOpen, WorkbookSort, WorkbookFilter } from '../integrations/index';\nimport { WorkbookNumberFormat } from '../integrations/number-format';\nimport { WorkbookEdit, WorkbookCellFormat, WorkbookHyperlink } from '../actions/index';\n/**\n * Workbook basic module.\n * @private\n */\nvar WorkbookBasicModule = /** @class */ (function () {\n    /**\n     * Constructor for Workbook basic module.\n     * @private\n     */\n    function WorkbookBasicModule() {\n        Workbook.Inject(DataBind, WorkbookSave, WorkbookOpen, WorkbookNumberFormat, WorkbookCellFormat, WorkbookEdit, WorkbookFormula, WorkbookSort, WorkbookHyperlink, WorkbookFilter);\n    }\n    /**\n     * For internal use only - Get the module name.\n     * @private\n     */\n    WorkbookBasicModule.prototype.getModuleName = function () {\n        return 'workbookBasic';\n    };\n    /**\n     * Destroys the Workbook basic module.\n     * @return {void}\n     */\n    WorkbookBasicModule.prototype.destroy = function () {\n        /* code snippet */\n    };\n    return WorkbookBasicModule;\n}());\nexport { WorkbookBasicModule };\n","import { Workbook, DataBind } from '../../workbook/index';\nimport { WorkbookSave, WorkbookNumberFormat, WorkbookFormula, WorkbookOpen, WorkbookSort, WorkbookFilter } from '../integrations/index';\nimport { WorkbookEdit, WorkbookCellFormat, WorkbookHyperlink } from '../actions/index';\n/**\n * Workbook all module.\n * @private\n */\nvar WorkbookAllModule = /** @class */ (function () {\n    /**\n     * Constructor for Workbook all module.\n     * @private\n     */\n    function WorkbookAllModule() {\n        Workbook.Inject(DataBind, WorkbookSave, WorkbookNumberFormat, WorkbookCellFormat, WorkbookEdit, WorkbookFormula, WorkbookOpen, WorkbookSort, WorkbookHyperlink, WorkbookFilter);\n    }\n    /**\n     * For internal use only - Get the module name.\n     * @private\n     */\n    WorkbookAllModule.prototype.getModuleName = function () {\n        return 'workbook-all';\n    };\n    /**\n     * Destroys the Workbook all module.\n     * @return {void}\n     */\n    WorkbookAllModule.prototype.destroy = function () {\n        /* code snippet */\n    };\n    return WorkbookAllModule;\n}());\nexport { WorkbookAllModule };\n","var __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    }\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nimport { ChildProperty, Property } from '@syncfusion/ej2-base';\n/**\n * Represents the cell style.\n */\nvar CellStyle = /** @class */ (function (_super) {\n    __extends(CellStyle, _super);\n    function CellStyle() {\n        return _super !== null && _super.apply(this, arguments) || this;\n    }\n    __decorate([\n        Property('Calibri')\n    ], CellStyle.prototype, \"fontFamily\", void 0);\n    __decorate([\n        Property('bottom')\n    ], CellStyle.prototype, \"verticalAlign\", void 0);\n    __decorate([\n        Property('left')\n    ], CellStyle.prototype, \"textAlign\", void 0);\n    __decorate([\n        Property('0pt')\n    ], CellStyle.prototype, \"textIndent\", void 0);\n    __decorate([\n        Property('#000000')\n    ], CellStyle.prototype, \"color\", void 0);\n    __decorate([\n        Property('#ffffff')\n    ], CellStyle.prototype, \"backgroundColor\", void 0);\n    __decorate([\n        Property('normal')\n    ], CellStyle.prototype, \"fontWeight\", void 0);\n    __decorate([\n        Property('normal')\n    ], CellStyle.prototype, \"fontStyle\", void 0);\n    __decorate([\n        Property('11pt')\n    ], CellStyle.prototype, \"fontSize\", void 0);\n    __decorate([\n        Property('none')\n    ], CellStyle.prototype, \"textDecoration\", void 0);\n    return CellStyle;\n}(ChildProperty));\nexport { CellStyle };\n/**\n * Represents the DefineName.\n */\nvar DefineName = /** @class */ (function (_super) {\n    __extends(DefineName, _super);\n    function DefineName() {\n        return _super !== null && _super.apply(this, arguments) || this;\n    }\n    __decorate([\n        Property('')\n    ], DefineName.prototype, \"name\", void 0);\n    __decorate([\n        Property('')\n    ], DefineName.prototype, \"scope\", void 0);\n    __decorate([\n        Property('')\n    ], DefineName.prototype, \"comment\", void 0);\n    __decorate([\n        Property('')\n    ], DefineName.prototype, \"refersTo\", void 0);\n    return DefineName;\n}(ChildProperty));\nexport { DefineName };\n/**\n * Represents the Hyperlink.\n */\nvar Hyperlink = /** @class */ (function (_super) {\n    __extends(Hyperlink, _super);\n    function Hyperlink() {\n        return _super !== null && _super.apply(this, arguments) || this;\n    }\n    __decorate([\n        Property('')\n    ], Hyperlink.prototype, \"address\", void 0);\n    return Hyperlink;\n}(ChildProperty));\nexport { Hyperlink };\n","/** @hidden */\nexport var workbookLocale = 'spreadsheetLocale';\n/**\n * Workbook locale text\n * @hidden\n */\nexport var localeData = {\n    SortOutOfRangeError: 'Select a cell or range inside the used range and try again.'\n};\n","import { isNullOrUndefined } from '@syncfusion/ej2-base';\n/**\n * ServiceLocator\n * @hidden\n */\nvar ServiceLocator = /** @class */ (function () {\n    function ServiceLocator() {\n        this.services = {};\n    }\n    ServiceLocator.prototype.getService = function (name) {\n        if (isNullOrUndefined(this.services[name])) {\n            throw \"The service \" + name + \" is not registered\";\n        }\n        return this.services[name];\n    };\n    ServiceLocator.prototype.register = function (name, type) {\n        if (isNullOrUndefined(this.services[name])) {\n            this.services[name] = type;\n        }\n    };\n    return ServiceLocator;\n}());\nexport { ServiceLocator };\n","var __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    }\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nvar __assign = (this && this.__assign) || function () {\n    __assign = Object.assign || function(t) {\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\n            s = arguments[i];\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\n                t[p] = s[p];\n        }\n        return t;\n    };\n    return __assign.apply(this, arguments);\n};\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nimport { Component, Property, NotifyPropertyChanges, Collection, Complex } from '@syncfusion/ej2-base';\nimport { initSheet, getSheet, getSheetIndexFromId, getSheetNameCount, getMaxSheetId, getSheetIndexByName, getSheetIndex } from './sheet';\nimport { Sheet } from './sheet';\nimport { Event, merge, L10n } from '@syncfusion/ej2-base';\nimport { getWorkbookRequiredModules } from '../common/module';\nimport { getData, clearRange } from './index';\nimport { DefineName, CellStyle, updateUsedRange, getIndexesFromAddress, localeData, workbookLocale } from '../common/index';\nimport * as events from '../common/event';\nimport { setCellFormat, sheetCreated } from '../common/index';\nimport { getCell, skipDefaultValue, setCell } from './cell';\nimport { DataBind, setRow } from '../index';\nimport { WorkbookSave, WorkbookFormula, WorkbookOpen, WorkbookSort, WorkbookFilter } from '../integrations/index';\nimport { WorkbookNumberFormat } from '../integrations/number-format';\nimport { WorkbookEdit, WorkbookCellFormat, WorkbookHyperlink } from '../actions/index';\nimport { ServiceLocator } from '../services/index';\nimport { setLinkModel } from '../common/event';\nimport { beginAction } from '../../spreadsheet/common/event';\n/**\n * Represents the Workbook.\n */\nvar Workbook = /** @class */ (function (_super) {\n    __extends(Workbook, _super);\n    /**\n     * Constructor for initializing the library.\n     * @param options - Configures Workbook model.\n     */\n    function Workbook(options) {\n        var _this = _super.call(this, options) || this;\n        /**\n         * To generate sheet name based on sheet count.\n         * @hidden\n         */\n        _this.sheetNameCount = 1;\n        /**\n         * @hidden\n         */\n        _this.isOpen = false;\n        Workbook_1.Inject(DataBind, WorkbookSave, WorkbookOpen, WorkbookNumberFormat, WorkbookCellFormat, WorkbookEdit, WorkbookFormula, WorkbookSort, WorkbookHyperlink, WorkbookFilter);\n        _this.commonCellStyle = {};\n        if (options && options.cellStyle) {\n            _this.commonCellStyle = options.cellStyle;\n        }\n        if (_this.getModuleName() === 'workbook') {\n            _this.serviceLocator = new ServiceLocator;\n            _this.initWorkbookServices();\n            _this.dataBind();\n            _this.initEmptySheet();\n        }\n        return _this;\n    }\n    Workbook_1 = Workbook;\n    /**\n     * For internal use only.\n     * @returns void\n     * @hidden\n     */\n    Workbook.prototype.preRender = function () {\n        if (!Object.keys(this.commonCellStyle).length) {\n            this.commonCellStyle = skipDefaultValue(this.cellStyle, true);\n        }\n        if (this.getModuleName() === 'spreadsheet' && !this.refreshing) {\n            this.initEmptySheet();\n        }\n    };\n    Workbook.prototype.initWorkbookServices = function () {\n        this.serviceLocator.register(workbookLocale, new L10n(this.getModuleName(), localeData, this.locale));\n    };\n    /**\n     * For internal use only.\n     * @returns void\n     * @hidden\n     */\n    Workbook.prototype.render = function () {\n        /** code snippets */\n    };\n    /**\n     * To provide the array of modules needed for workbook.\n     * @return {ModuleDeclaration[]}\n     * @hidden\n     */\n    Workbook.prototype.requiredModules = function () {\n        return getWorkbookRequiredModules(this);\n    };\n    /**\n     * Get the properties to be maintained in the persisted state.\n     * @returns string\n     * @hidden\n     */\n    Workbook.prototype.getPersistData = function () {\n        return this.addOnPersist([]);\n    };\n    /**\n     * Applies the style (font family, font weight, background color, etc...) to the specified range of cells.\n     * @param {CellStyleModel} style - Specifies the cell style.\n     * @param {string} range? - Specifies the address for the range of cells.\n     */\n    Workbook.prototype.cellFormat = function (style, range) {\n        var sheet = this.getActiveSheet();\n        range = range || sheet.selectedRange;\n        this.notify(setCellFormat, { style: style, range: range, refreshRibbon: range.indexOf(sheet.activeCell) > -1 ? true : false });\n    };\n    /** @hidden */\n    Workbook.prototype.getCellStyleValue = function (cssProps, indexes) {\n        var _this = this;\n        var cell = getCell(indexes[0], indexes[1], this.getActiveSheet());\n        var style = {};\n        cssProps.forEach(function (cssProp) {\n            style[cssProp] = _this.cellStyle[cssProp];\n            if (cell && cell.style && cell.style[cssProp]) {\n                style[cssProp] = cell.style[cssProp];\n            }\n        });\n        return style;\n    };\n    /**\n     * Applies the number format (number, currency, percentage, short date, etc...) to the specified range of cells.\n     * @param {string} format - Specifies the number format code.\n     * @param {string} range? - Specifies the address for the range of cells.\n     */\n    Workbook.prototype.numberFormat = function (format, range) {\n        this.notify(events.applyNumberFormatting, { format: format, range: range });\n    };\n    /**\n     * Used to create new sheet.\n     * @hidden\n     */\n    Workbook.prototype.createSheet = function (index) {\n        var sheet = new Sheet(this, 'sheets', { id: getMaxSheetId(this.sheets), name: 'Sheet' + getSheetNameCount(this) }, true);\n        if (index > -1) {\n            this.sheets.splice(index, 0, sheet);\n        }\n        else {\n            this.sheets.push(sheet);\n        }\n        this.setProperties({ 'sheet': this.sheets }, true);\n        this.notify(sheetCreated, { sheetIndex: index | 0 });\n        this.notify(events.workbookFormulaOperation, { action: 'registerSheet', sheetIndex: index });\n    };\n    /**\n     * Used to remove sheet.\n     * @hidden\n     */\n    Workbook.prototype.removeSheet = function (idx) {\n        this.sheets.splice(idx, 1);\n    };\n    /**\n     * Destroys the Workbook library.\n     */\n    Workbook.prototype.destroy = function () {\n        this.notify(events.workbookDestroyed, null);\n        _super.prototype.destroy.call(this);\n    };\n    /**\n     * Called internally if any of the property value changed.\n     * @param  {WorkbookModel} newProp\n     * @param  {WorkbookModel} oldProp\n     * @returns void\n     * @hidden\n     */\n    Workbook.prototype.onPropertyChanged = function (newProp, oldProp) {\n        for (var _i = 0, _a = Object.keys(newProp); _i < _a.length; _i++) {\n            var prop = _a[_i];\n            switch (prop) {\n                case 'cellStyle':\n                    merge(this.commonCellStyle, skipDefaultValue(newProp.cellStyle));\n                    break;\n            }\n        }\n    };\n    /**\n     * Not applicable for workbook.\n     * @hidden\n     */\n    Workbook.prototype.appendTo = function (selector) {\n        _super.prototype.appendTo.call(this, selector);\n    };\n    /**\n     * Used to hide/show the rows in spreadsheet.\n     * @param {number} startRow - Specifies the start row index.\n     * @param {number} endRow - Specifies the end row index.\n     * @param {boolean} hide - To hide/show the rows in specified range.\n     * @hidden\n     */\n    Workbook.prototype.showHideRow = function (hide, startRow, endRow) {\n        if (endRow === void 0) { endRow = startRow; }\n        var sheet = this.getActiveSheet();\n        for (var i = startRow; i < endRow; i++) {\n            setRow(sheet, i, { hidden: hide });\n        }\n        this.setProperties({ 'sheets': this.sheets }, true);\n    };\n    Workbook.prototype.initEmptySheet = function () {\n        var len = this.sheets.length;\n        if (len) {\n            initSheet(this);\n        }\n        else {\n            this.createSheet();\n        }\n    };\n    /** @hidden */\n    Workbook.prototype.getActiveSheet = function () {\n        return this.sheets[this.activeSheetTab - 1];\n    };\n    /**\n     * Used for setting the used range row and column index.\n     * @hidden\n     */\n    Workbook.prototype.setUsedRange = function (rowIdx, colIdx) {\n        var sheet = this.getActiveSheet();\n        if (rowIdx > sheet.usedRange.rowIndex) {\n            sheet.usedRange.rowIndex = rowIdx;\n            this.setProperties({ 'sheets': this.sheets }, true);\n            this.notify(updateUsedRange, { index: rowIdx, update: 'row' });\n        }\n        if (colIdx > sheet.usedRange.colIndex) {\n            sheet.usedRange.colIndex = colIdx;\n            this.setProperties({ 'sheets': this.sheets }, true);\n            this.notify(updateUsedRange, { index: colIdx, update: 'col' });\n        }\n    };\n    /**\n     * Gets the range of data as JSON from the specified address.\n     * @param {string} address - Specifies the address for range of cells.\n     */\n    Workbook.prototype.getData = function (address) {\n        return getData(this, address);\n    };\n    /**\n     * Get component name.\n     * @returns string\n     * @hidden\n     */\n    Workbook.prototype.getModuleName = function () {\n        return 'workbook';\n    };\n    /** @hidden */\n    Workbook.prototype.getValueRowCol = function (sheetIndex, rowIndex, colIndex) {\n        var args = {\n            action: 'getSheetInfo', sheetInfo: []\n        };\n        this.notify(events.workbookFormulaOperation, args);\n        var id = getSheetIndexByName(this, 'Sheet' + sheetIndex, args.sheetInfo);\n        if (id === -1) {\n            var errArgs = { action: 'getReferenceError', refError: '' };\n            this.notify(events.workbookFormulaOperation, errArgs);\n            return errArgs.refError;\n        }\n        sheetIndex = getSheetIndexFromId(this, sheetIndex);\n        var sheet = getSheet(this, sheetIndex - 1);\n        var cell = getCell(rowIndex - 1, colIndex - 1, sheet);\n        return (cell && cell.value) || '';\n    };\n    /** @hidden */\n    Workbook.prototype.setValueRowCol = function (sheetIndex, value, rowIndex, colIndex) {\n        sheetIndex = getSheetIndexFromId(this, sheetIndex);\n        this.notify(events.workbookEditOperation, {\n            action: 'updateCellValue', address: [rowIndex - 1, colIndex - 1], value: value,\n            sheetIndex: sheetIndex, isValueOnly: true\n        });\n    };\n    /**\n     * Opens the specified excel file or stream.\n     * @param {OpenOptions} options - Options for opening the excel file.\n     */\n    Workbook.prototype.open = function (options) {\n        this.notify(events.workbookOpen, options);\n    };\n    /**\n     * Saves the Spreadsheet data to Excel file.\n     * @param {SaveOptions} saveOptions - Options for saving the excel file.\n     */\n    Workbook.prototype.save = function (saveOptions) {\n        if (saveOptions === void 0) { saveOptions = {}; }\n        if (this.allowSave) {\n            var defaultProps = {\n                url: this.saveUrl,\n                fileName: saveOptions.fileName || 'Sample',\n                saveType: 'Xlsx'\n            };\n            var eventArgs = __assign({}, defaultProps, saveOptions, { customParams: {}, isFullPost: true, needBlobData: false, cancel: false });\n            this.trigger('beforeSave', eventArgs);\n            this.notify(beginAction, { eventArgs: eventArgs, action: 'beforeSave' });\n            if (!eventArgs.cancel) {\n                this.notify(events.beginSave, {\n                    saveSettings: eventArgs, isFullPost: eventArgs.isFullPost,\n                    needBlobData: eventArgs.needBlobData, customParams: eventArgs.customParams\n                });\n            }\n        }\n    };\n    Workbook.prototype.addHyperlink = function (hyperlink, cellAddress) {\n        var args = { hyperlink: hyperlink, cell: cellAddress };\n        this.notify(setLinkModel, args);\n    };\n    /**\n     * Sorts the range of cells in the active Spreadsheet.\n     * @param sortOptions - options for sorting.\n     * @param range - address of the data range.\n     */\n    Workbook.prototype.sort = function (sortOptions, range) {\n        if (!this.allowSorting) {\n            return Promise.reject();\n        }\n        var eventArgs = {\n            range: range || this.getActiveSheet().selectedRange,\n            sortOptions: sortOptions || { sortDescriptors: {} },\n            cancel: false\n        };\n        var promise = new Promise(function (resolve, reject) { resolve((function () { })()); });\n        var sortArgs = { args: eventArgs, promise: promise };\n        this.notify(events.initiateSort, sortArgs);\n        return sortArgs.promise;\n    };\n    /**\n     * To update a cell properties.\n     * @param {CellModel} cell - Cell properties.\n     * @param {string} address - Address to update.\n     */\n    Workbook.prototype.updateCell = function (cell, address) {\n        var range = getIndexesFromAddress(address);\n        var sheetIdx = getSheetIndex(this, address.split('!')[0]) || this.activeSheetTab - 1;\n        setCell(range[0], range[1], this.sheets[sheetIdx], cell, true);\n        if (cell.value) {\n            this.notify(events.workbookEditOperation, {\n                action: 'updateCellValue', address: range, value: cell.value,\n                sheetIndex: sheetIdx\n            });\n        }\n    };\n    /**\n     * Adds the defined name to the Spreadsheet.\n     * @param {DefineNameModel} definedName - Specifies the name.\n     * @return {boolean} - Return the added status of the defined name.\n     */\n    Workbook.prototype.addDefinedName = function (definedName) {\n        var eventArgs = {\n            action: 'addDefinedName',\n            isAdded: false,\n            definedName: definedName\n        };\n        this.notify(events.workbookFormulaOperation, eventArgs);\n        return eventArgs.isAdded;\n    };\n    /**\n     * Removes the defined name from the Spreadsheet.\n     * @param {string} definedName - Specifies the name.\n     * @param {string} scope - Specifies the scope of the defined name.\n     * @return {boolean} - Return the removed status of the defined name.\n     */\n    Workbook.prototype.removeDefinedName = function (definedName, scope) {\n        if (scope === void 0) { scope = ''; }\n        var eventArgs = {\n            action: 'removeDefinedName',\n            isRemoved: false,\n            definedName: definedName,\n            scope: scope\n        };\n        this.notify(events.workbookFormulaOperation, eventArgs);\n        return eventArgs.isRemoved;\n    };\n    /** @hidden */\n    Workbook.prototype.clearRange = function (address, sheetIndex, valueOnly) {\n        if (valueOnly === void 0) { valueOnly = true; }\n        address = address ? address : this.getActiveSheet().selectedRange;\n        sheetIndex = sheetIndex ? sheetIndex : this.activeSheetTab;\n        clearRange(this, address, sheetIndex, valueOnly);\n    };\n    /**\n     * Filters the range of cells in the sheet.\n     */\n    Workbook.prototype.filter = function (filterOptions, range) {\n        if (!this.allowFiltering) {\n            return Promise.reject();\n        }\n        var eventArgs = {\n            range: range || this.getActiveSheet().selectedRange,\n            filterOptions: filterOptions,\n            cancel: false\n        };\n        var promise = new Promise(function (resolve, reject) { resolve((function () { })()); });\n        var filterArgs = { args: eventArgs, promise: promise };\n        this.notify(events.initiateFilter, filterArgs);\n        return filterArgs.promise;\n    };\n    /**\n     * Clears the filter changes of the sheet.\n     */\n    Workbook.prototype.clearFilter = function () {\n        this.notify(events.clearAllFilter, null);\n    };\n    /**\n     * Gets the formatted text of the cell.\n     */\n    Workbook.prototype.getDisplayText = function (cell) {\n        if (!cell) {\n            return '';\n        }\n        if (cell.value && cell.format) {\n            var eventArgs = {\n                formattedText: cell.value, value: cell.value, format: cell.format, onLoad: true\n            };\n            this.notify(events.getFormattedCellObject, eventArgs);\n            return eventArgs.formattedText;\n        }\n        else if (!cell.value && cell.hyperlink) {\n            return typeof cell.hyperlink === 'string' ? cell.hyperlink : cell.hyperlink.address;\n        }\n        else {\n            return cell.value ? cell.value.toString() : '';\n        }\n    };\n    var Workbook_1;\n    __decorate([\n        Collection([], Sheet)\n    ], Workbook.prototype, \"sheets\", void 0);\n    __decorate([\n        Property(1)\n    ], Workbook.prototype, \"activeSheetTab\", void 0);\n    __decorate([\n        Property('100%')\n    ], Workbook.prototype, \"height\", void 0);\n    __decorate([\n        Property('100%')\n    ], Workbook.prototype, \"width\", void 0);\n    __decorate([\n        Property(true)\n    ], Workbook.prototype, \"showRibbon\", void 0);\n    __decorate([\n        Property(true)\n    ], Workbook.prototype, \"showFormulaBar\", void 0);\n    __decorate([\n        Property(true)\n    ], Workbook.prototype, \"showSheetTabs\", void 0);\n    __decorate([\n        Property(true)\n    ], Workbook.prototype, \"allowEditing\", void 0);\n    __decorate([\n        Property(true)\n    ], Workbook.prototype, \"allowOpen\", void 0);\n    __decorate([\n        Property(true)\n    ], Workbook.prototype, \"allowSave\", void 0);\n    __decorate([\n        Property(true)\n    ], Workbook.prototype, \"allowSorting\", void 0);\n    __decorate([\n        Property(true)\n    ], Workbook.prototype, \"allowFiltering\", void 0);\n    __decorate([\n        Property(true)\n    ], Workbook.prototype, \"allowNumberFormatting\", void 0);\n    __decorate([\n        Property(true)\n    ], Workbook.prototype, \"allowCellFormatting\", void 0);\n    __decorate([\n        Property(true)\n    ], Workbook.prototype, \"allowHyperlink\", void 0);\n    __decorate([\n        Complex({}, CellStyle)\n    ], Workbook.prototype, \"cellStyle\", void 0);\n    __decorate([\n        Property('')\n    ], Workbook.prototype, \"openUrl\", void 0);\n    __decorate([\n        Property('')\n    ], Workbook.prototype, \"saveUrl\", void 0);\n    __decorate([\n        Collection([], DefineName)\n    ], Workbook.prototype, \"definedNames\", void 0);\n    __decorate([\n        Event()\n    ], Workbook.prototype, \"beforeOpen\", void 0);\n    __decorate([\n        Event()\n    ], Workbook.prototype, \"openFailure\", void 0);\n    __decorate([\n        Event()\n    ], Workbook.prototype, \"beforeSave\", void 0);\n    __decorate([\n        Event()\n    ], Workbook.prototype, \"saveComplete\", void 0);\n    __decorate([\n        Event()\n    ], Workbook.prototype, \"beforeCellFormat\", void 0);\n    Workbook = Workbook_1 = __decorate([\n        NotifyPropertyChanges\n    ], Workbook);\n    return Workbook;\n}(Component));\nexport { Workbook };\n","import { detach, EventHandler, Browser, extend } from '@syncfusion/ej2-base';\nimport { getRangeIndexes, getCell, setCell, getSheet, getSwapRange } from '../../workbook/index';\nimport { getRangeAddress } from '../../workbook/index';\nimport { getFormattedCellObject, workbookFormulaOperation, applyCellFormat, checkIsFormula } from '../../workbook/index';\nimport { ribbonClick, cut, copy, paste } from '../common/index';\nimport { enableRibbonItems, rowHeightChanged, completeAction, beginAction } from '../common/index';\nimport { clearCopy, locateElem, selectRange, dialog, contentLoaded, tabSwitch, cMenuBeforeOpen, locale } from '../common/index';\nimport { Deferred } from '@syncfusion/ej2-data';\n/**\n * Represents clipboard support for Spreadsheet.\n */\nvar Clipboard = /** @class */ (function () {\n    function Clipboard(parent) {\n        this.parent = parent;\n        this.init();\n        this.addEventListener();\n    }\n    Clipboard.prototype.init = function () {\n        this.parent.element\n            .appendChild(this.parent.createElement('input', { className: 'e-clipboard', attrs: { 'contenteditable': 'true' } }));\n    };\n    Clipboard.prototype.addEventListener = function () {\n        var ele = this.getClipboardEle();\n        this.parent.on(cut, this.cut, this);\n        this.parent.on(copy, this.copy, this);\n        this.parent.on(paste, this.paste, this);\n        this.parent.on(clearCopy, this.clearCopiedInfo, this);\n        this.parent.on(tabSwitch, this.tabSwitchHandler, this);\n        this.parent.on(cMenuBeforeOpen, this.cMenuBeforeOpenHandler, this);\n        this.parent.on(ribbonClick, this.ribbonClickHandler, this);\n        this.parent.on(contentLoaded, this.initCopyIndicator, this);\n        this.parent.on(rowHeightChanged, this.rowHeightChanged, this);\n        EventHandler.add(ele, 'cut', this.cut, this);\n        EventHandler.add(ele, 'copy', this.copy, this);\n        EventHandler.add(ele, 'paste', this.paste, this);\n    };\n    Clipboard.prototype.removeEventListener = function () {\n        var ele = this.getClipboardEle();\n        if (!this.parent.isDestroyed) {\n            this.parent.off(cut, this.cut);\n            this.parent.off(copy, this.copy);\n            this.parent.off(paste, this.paste);\n            this.parent.off(clearCopy, this.clearCopiedInfo);\n            this.parent.off(tabSwitch, this.tabSwitchHandler);\n            this.parent.off(cMenuBeforeOpen, this.cMenuBeforeOpenHandler);\n            this.parent.off(ribbonClick, this.ribbonClickHandler);\n            this.parent.off(contentLoaded, this.initCopyIndicator);\n            this.parent.off(rowHeightChanged, this.rowHeightChanged);\n        }\n        EventHandler.remove(ele, 'cut', this.cut);\n        EventHandler.remove(ele, 'copy', this.copy);\n        EventHandler.remove(ele, 'paste', this.paste);\n    };\n    Clipboard.prototype.ribbonClickHandler = function (args) {\n        var parentId = this.parent.element.id;\n        switch (args.item.id) {\n            case parentId + '_cut':\n                this.cut({ isAction: true });\n                break;\n            case parentId + '_copy':\n                this.copy({ isAction: true });\n                break;\n        }\n        this.parent.element.focus();\n    };\n    Clipboard.prototype.tabSwitchHandler = function (args) {\n        if (args.idx === 1 && !this.copiedInfo) {\n            this.hidePaste();\n        }\n    };\n    Clipboard.prototype.cMenuBeforeOpenHandler = function (e) {\n        if (e.target === 'Content' || e.target === 'Header') {\n            var l10n = this.parent.serviceLocator.getService(locale);\n            this.parent.enableContextMenuItems([l10n.getConstant('Paste'), l10n.getConstant('PasteSpecial')], this.copiedInfo ? true : false);\n        }\n    };\n    Clipboard.prototype.rowHeightChanged = function (args) {\n        if (this.copiedInfo && this.copiedInfo.range[0] > args.rowIdx) {\n            var ele = this.parent.element.getElementsByClassName('e-copy-indicator')[0];\n            ele.style.top = parseInt(ele.style.top, 10) + args.threshold + \"px\";\n        }\n    };\n    Clipboard.prototype.cut = function (args) {\n        this.setCopiedInfo(args, true);\n    };\n    Clipboard.prototype.copy = function (args) {\n        this.setCopiedInfo(args, false);\n    };\n    Clipboard.prototype.paste = function (args) {\n        if (this.parent.isEdit) {\n            if (args && args.type) {\n                args.preventDefault();\n                document.getElementById(this.parent.element.id + '_edit').focus();\n                return;\n            }\n        }\n        var rfshRange;\n        /* tslint:disable-next-line */\n        var isExternal = !this.copiedInfo && ((args && args.clipboardData) || window['clipboardData']);\n        var copiedIdx = this.getCopiedIdx();\n        var copyInfo = Object.assign({}, this.copiedInfo);\n        if (this.copiedInfo || isExternal) {\n            var cSIdx = (args && args.sIdx > -1) ? args.sIdx : this.parent.activeSheetTab - 1;\n            var curSheet = getSheet(this.parent, cSIdx);\n            var selIdx = getSwapRange(args && args.range || getRangeIndexes(curSheet.selectedRange));\n            var rows = isExternal && this.getExternalCells(args);\n            if (isExternal && !rows.length) { // If image pasted\n                return;\n            }\n            var rowIdx = selIdx[0];\n            var cIdx = isExternal\n                ? [0, 0, rows.length - 1, rows[0].cells.length - 1] : getSwapRange(this.copiedInfo.range);\n            var isRepeative = (selIdx[2] - selIdx[0] + 1) % (cIdx[2] - cIdx[0] + 1) === 0\n                && (selIdx[3] - selIdx[1] + 1) % (cIdx[3] - cIdx[1] + 1) === 0;\n            rfshRange = isRepeative ? selIdx : [selIdx[0], selIdx[1]]\n                .concat([selIdx[0] + cIdx[2] - cIdx[0], selIdx[1] + cIdx[3] - cIdx[1] || selIdx[1]]);\n            var beginEventArgs = {\n                requestType: 'paste',\n                copiedInfo: this.copiedInfo,\n                copiedRange: getRangeAddress(cIdx),\n                pastedRange: getRangeAddress(rfshRange),\n                type: (args && args.type) || 'All',\n                cancel: false\n            };\n            if (args.isAction) {\n                this.parent.notify(beginAction, { eventArgs: beginEventArgs, action: 'clipboard' });\n            }\n            if (beginEventArgs.cancel) {\n                return;\n            }\n            var cell = void 0;\n            var isExtend = void 0;\n            var prevSheet = getSheet(this.parent, isExternal ? cSIdx : copiedIdx);\n            selIdx = getRangeIndexes(beginEventArgs.pastedRange);\n            rowIdx = selIdx[0];\n            cIdx = isExternal\n                ? [0, 0, rows.length - 1, rows[0].cells.length - 1] : getSwapRange(this.copiedInfo.range);\n            isRepeative = (selIdx[2] - selIdx[0] + 1) % (cIdx[2] - cIdx[0] + 1) === 0\n                && (selIdx[3] - selIdx[1] + 1) % (cIdx[3] - cIdx[1] + 1) === 0;\n            rfshRange = isRepeative ? selIdx : [selIdx[0], selIdx[1]]\n                .concat([selIdx[0] + cIdx[2] - cIdx[0], selIdx[1] + cIdx[3] - cIdx[1] || selIdx[1]]);\n            for (var i = cIdx[0], l = 0; i <= cIdx[2]; i++, l++) {\n                for (var j = cIdx[1], k = 0; j <= cIdx[3]; j++, k++) {\n                    cell = isExternal ? rows[i].cells[j] : Object.assign({}, getCell(i, j, prevSheet));\n                    if (cell && args && args.type) {\n                        switch (args.type) {\n                            case 'Formats':\n                                cell = { format: cell.format, style: cell.style };\n                                break;\n                            case 'Values':\n                                cell = { value: cell.value };\n                                break;\n                        }\n                        isExtend = ['Formats', 'Values'].indexOf(args.type) > -1;\n                    }\n                    if ((!this.parent.scrollSettings.isFinite && (cIdx[2] - cIdx[0] > (1048575 - selIdx[0])\n                        || cIdx[3] - cIdx[1] > (16383 - selIdx[1])))\n                        || (this.parent.scrollSettings.isFinite && (cIdx[2] - cIdx[0] > (curSheet.rowCount - 1 - selIdx[0])\n                            || cIdx[3] - cIdx[1] > (curSheet.colCount - 1 - selIdx[1])))) {\n                        this.showDialog();\n                        return;\n                    }\n                    if (isRepeative) {\n                        for (var x = selIdx[0]; x <= selIdx[2]; x += (cIdx[2] - cIdx[0]) + 1) {\n                            for (var y = selIdx[1]; y <= selIdx[3]; y += (cIdx[3] - cIdx[1] + 1)) {\n                                this.setCell(x + l, y + k, curSheet, cell, isExtend);\n                            }\n                        }\n                    }\n                    else {\n                        this.setCell(rowIdx, selIdx[1] + k, curSheet, cell, isExtend);\n                    }\n                    if (!isExternal && this.copiedInfo.isCut) {\n                        this.setCell(i, j, prevSheet, getCell(i, j, prevSheet), false, true);\n                    }\n                }\n                rowIdx++;\n            }\n            this.parent.setUsedRange(rfshRange[2] + 1, rfshRange[3]);\n            if (cSIdx === this.parent.activeSheetTab - 1) {\n                this.parent.serviceLocator.getService('cell').refreshRange(rfshRange);\n                this.parent.notify(selectRange, rfshRange);\n            }\n            if (!isExternal && this.copiedInfo.isCut) {\n                if (copiedIdx === this.parent.activeSheetTab - 1) {\n                    this.parent.serviceLocator.getService('cell').refreshRange(cIdx);\n                }\n                this.clearCopiedInfo();\n            }\n            if (isExternal || (args && args.isAction)) {\n                this.parent.element.focus();\n            }\n            if (args.isAction) {\n                var cSID = copyInfo && copyInfo.sId ? copyInfo.sId : this.parent.activeSheetTab;\n                var copyRange = copyInfo &&\n                    copyInfo.range ? copyInfo.range : getRangeIndexes(this.parent.sheets[cSID - 1].selectedRange);\n                var eventArgs = {\n                    requestType: 'paste',\n                    copiedInfo: copyInfo,\n                    pasteSheetIdx: this.parent.activeSheetTab,\n                    copiedRange: this.parent.sheets[cSID - 1].name + '!' + getRangeAddress(copyRange),\n                    pastedRange: this.parent.sheets[this.parent.activeSheetTab - 1].name + '!' + getRangeAddress(rfshRange),\n                    type: (args && args.type) || 'All'\n                };\n                this.parent.notify(completeAction, { eventArgs: eventArgs, action: 'clipboard' });\n            }\n        }\n        else {\n            this.getClipboardEle().select();\n        }\n    };\n    Clipboard.prototype.setCell = function (rIdx, cIdx, sheet, cell, isExtend, isCut) {\n        setCell(rIdx, cIdx, sheet, isCut ? null : cell, isExtend);\n        if (cell && cell.formula) {\n            this.parent.notify(workbookFormulaOperation, {\n                action: 'refreshCalculate', value: isCut ? '' : cell.formula, rowIndex: rIdx,\n                colIndex: cIdx, sheetIndex: this.parent.activeSheetTab, isFormula: true\n            });\n        }\n        if (isCut && cell && cell.style) {\n            this.parent.notify(applyCellFormat, {\n                style: extend({}, this.getEmptyStyle(cell.style), this.parent.commonCellStyle), rowIdx: rIdx, colIdx: cIdx, cell: null,\n                lastCell: null, row: null, hRow: null, isHeightCheckNeeded: true, manualUpdate: false\n            });\n        }\n    };\n    Clipboard.prototype.getEmptyStyle = function (cellStyle) {\n        var style = {};\n        Object.keys(cellStyle).forEach(function (key) {\n            style[key] = '';\n        });\n        return style;\n    };\n    Clipboard.prototype.getCopiedIdx = function () {\n        if (this.copiedInfo) {\n            for (var i = 0; i < this.parent.sheets.length; i++) {\n                if (this.parent.sheets[i].id === this.copiedInfo.sId) {\n                    return i;\n                }\n            }\n            this.clearCopiedInfo();\n        }\n        return -1;\n    };\n    Clipboard.prototype.setCopiedInfo = function (args, isCut) {\n        var _this = this;\n        if (this.parent.isEdit) {\n            return;\n        }\n        var deferred = new Deferred();\n        args.promise = deferred.promise;\n        var sheet = this.parent.getActiveSheet();\n        var range = (args && args.range) || getRangeIndexes(sheet.selectedRange);\n        var option = {\n            sheet: sheet, indexes: [0, 0, sheet.rowCount - 1, sheet.colCount - 1], promise: new Promise(function (resolve, reject) { resolve((function () { })()); })\n        };\n        if (sheet.isLocalData && !(args && args.clipboardData) && range[0] === 0 && range[2] === (sheet.rowCount - 1)) {\n            this.parent.showSpinner();\n            this.parent.notify('updateSheetFromDataSource', option);\n        }\n        option.promise.then(function () {\n            if (!(args && args.clipboardData)) {\n                if (_this.copiedInfo) {\n                    _this.clearCopiedInfo();\n                }\n                _this.copiedInfo = {\n                    range: range, sId: (args && args.sId) ? args.sId : sheet.id, isCut: isCut\n                };\n                _this.hidePaste(true);\n                _this.initCopyIndicator();\n                if (!Browser.isIE) {\n                    _this.getClipboardEle().select();\n                }\n                if (args && args.isAction) {\n                    document.execCommand(isCut ? 'cut' : 'copy');\n                }\n                _this.parent.hideSpinner();\n            }\n            if (Browser.isIE) {\n                _this.setExternalCells(args);\n            }\n            deferred.resolve();\n        });\n        if (args && args.clipboardData) {\n            this.setExternalCells(args);\n            this.parent.element.focus();\n        }\n    };\n    Clipboard.prototype.clearCopiedInfo = function () {\n        if (this.copiedInfo) {\n            if (this.parent.getActiveSheet().id === this.copiedInfo.sId) {\n                detach(this.parent.getMainContent().getElementsByClassName('e-copy-indicator')[0]);\n            }\n            this.copiedInfo = null;\n            this.hidePaste();\n        }\n    };\n    Clipboard.prototype.initCopyIndicator = function () {\n        if (this.copiedInfo && this.parent.getActiveSheet().id === this.copiedInfo.sId) {\n            var copyIndicator = this.parent.createElement('div', { className: 'e-copy-indicator' });\n            copyIndicator.appendChild(this.parent.createElement('div', { className: 'e-top' }));\n            copyIndicator.appendChild(this.parent.createElement('div', { className: 'e-bottom' }));\n            copyIndicator.appendChild(this.parent.createElement('div', { className: 'e-left' }));\n            copyIndicator.appendChild(this.parent.createElement('div', { className: 'e-right' }));\n            locateElem(copyIndicator, this.copiedInfo.range, this.parent.getActiveSheet());\n            this.parent.getMainContent().appendChild(copyIndicator);\n        }\n    };\n    Clipboard.prototype.showDialog = function () {\n        this.parent.serviceLocator.getService(dialog).show({\n            header: 'Spreadsheet',\n            target: this.parent.element,\n            height: 205, width: 340, isModal: true, showCloseIcon: true,\n            content: this.parent.serviceLocator.getService(locale).getConstant('PasteAlert')\n        });\n    };\n    Clipboard.prototype.hidePaste = function (isShow) {\n        this.parent.notify(enableRibbonItems, [{ id: this.parent.element.id + '_paste', isEnable: isShow || false }]);\n    };\n    Clipboard.prototype.setExternalCells = function (args) {\n        var cell;\n        var text = '';\n        var range = this.copiedInfo.range;\n        var sheet = this.parent.getActiveSheet();\n        var data = '<html><body><table xmlns=\"http://www.w3.org/1999/xhtml\"><tbody>';\n        for (var i = range[0]; i <= range[2]; i++) {\n            data += '<tr>';\n            for (var j = range[1]; j <= range[3]; j++) {\n                data += '<td style=\"white-space:nowrap;vertical-align:bottom;';\n                cell = getCell(i, j, sheet);\n                if (cell && cell.style) {\n                    Object.keys(cell.style).forEach(function (style) {\n                        var regex = style.match(/[A-Z]/);\n                        data += (style === 'backgroundColor' ? 'background' : (regex ? style.replace(regex[0], '-'\n                            + regex[0].toLowerCase()) : style)) + ':' + ((style === 'backgroundColor' || style === 'color')\n                            ? cell.style[style].slice(0, 7) : cell.style[style]) + ';';\n                    });\n                }\n                data += '\">';\n                if (cell && cell.value) {\n                    var eventArgs = {\n                        formattedText: cell.value,\n                        value: cell.value,\n                        format: cell.format,\n                        onLoad: true\n                    };\n                    if (cell.format) {\n                        this.parent.notify(getFormattedCellObject, eventArgs);\n                    }\n                    data += eventArgs.formattedText;\n                    text += eventArgs.formattedText;\n                }\n                data += '</td>';\n                text += j === range[3] ? '' : '\\t';\n            }\n            data += '</tr>';\n            text += i === range[2] ? '' : '\\n';\n        }\n        data += '</tbody></table></body></html>';\n        if (Browser.isIE) {\n            /* tslint:disable-next-line */\n            window['clipboardData'].setData('text', text);\n        }\n        else {\n            args.clipboardData.setData('text/html', data);\n            args.clipboardData.setData('text/plain', text);\n            args.preventDefault();\n        }\n    };\n    Clipboard.prototype.getExternalCells = function (args) {\n        var _this = this;\n        var html;\n        var text;\n        var rows = [];\n        var cells = [];\n        var cellStyle;\n        var ele = this.parent.createElement('span');\n        if (Browser.isIE) {\n            /* tslint:disable-next-line */\n            text = window['clipboardData'].getData('text');\n        }\n        else {\n            html = args.clipboardData.getData('text/html');\n            text = args.clipboardData.getData('text/plain');\n            ele.innerHTML = html;\n        }\n        if (ele.querySelector('table')) {\n            ele.querySelectorAll('tr').forEach(function (tr) {\n                tr.querySelectorAll('td').forEach(function (td, j) {\n                    cells[j] = { value: td.textContent, style: _this.getStyle(td, ele) };\n                });\n                rows.push({ cells: cells });\n                cells = [];\n            });\n        }\n        else if (text) {\n            if (html) {\n                [].slice.call(ele.children).forEach(function (child) {\n                    if (child.getAttribute('style')) {\n                        cellStyle = _this.getStyle(child, ele);\n                    }\n                });\n            }\n            text.trim().split('\\n').forEach(function (row) {\n                row.split('\\t').forEach(function (col, j) {\n                    cells[j] = { style: cellStyle };\n                    if (checkIsFormula(col)) {\n                        cells[j].formula = col;\n                    }\n                    else {\n                        cells[j].value = col;\n                    }\n                });\n                rows.push({ cells: cells });\n                cells = [];\n            });\n        }\n        setTimeout(function () { _this.getClipboardEle().innerHTML = ''; }, 0);\n        return rows;\n    };\n    Clipboard.prototype.getStyle = function (td, ele) {\n        var styles = [];\n        var cellStyle = {};\n        if (td.classList.length || td.getAttribute('style')) {\n            if (td.classList.length) {\n                styles.push(ele.querySelector('style').innerHTML.split(td.classList[0])[1].split('{')[1].split('}')[0]);\n            }\n            if (td.getAttribute('style')) {\n                styles.push(td.getAttribute('style'));\n            }\n            styles.forEach(function (styles) {\n                styles.split(';').forEach(function (style) {\n                    var char = style.split(':')[0].trim();\n                    if (['font-family', 'vertical-align', 'text-align', 'text-indent', 'color', 'background', 'font-weight', 'font-style',\n                        'font-size', 'text-decoration'].indexOf(char) > -1) {\n                        char = char === 'background' ? 'backgroundColor' : char;\n                        var regex = char.match(/-[a-z]/);\n                        cellStyle[regex ? char.replace(regex[0], regex[0].charAt(1).toUpperCase()) : char] = style.split(':')[1];\n                    }\n                });\n            });\n        }\n        return cellStyle;\n    };\n    Clipboard.prototype.getClipboardEle = function () {\n        return this.parent.element.getElementsByClassName('e-clipboard')[0];\n    };\n    Clipboard.prototype.getModuleName = function () {\n        return 'clipboard';\n    };\n    Clipboard.prototype.destroy = function () {\n        this.removeEventListener();\n        var ele = this.getClipboardEle();\n        detach(ele);\n        this.parent = null;\n    };\n    return Clipboard;\n}());\nexport { Clipboard };\n","import { EventHandler, Browser, closest } from '@syncfusion/ej2-base';\nimport { getRangeIndexes, getRangeFromAddress, getIndexesFromAddress, getRangeAddress } from '../../workbook/common/address';\nimport { keyDown, editOperation, clearCopy, keyUp, mouseDown, selectionComplete, enableToolbar, completeAction } from '../common/event';\nimport { formulaBarOperation, formulaOperation, setActionData } from '../common/event';\nimport { workbookEditOperation, getFormattedBarText, getFormattedCellObject } from '../../workbook/common/event';\nimport { getSheetName, getSheetIndex, getCell } from '../../workbook/base/index';\nimport { getSheetNameFromAddress, getCellPosition, getSheet } from '../../workbook/base/index';\nimport { getSwapRange } from '../../workbook/index';\n/**\n * The `Edit` module is used to handle the editing functionalities in Spreadsheet.\n */\nvar Edit = /** @class */ (function () {\n    /**\n     * Constructor for edit module in Spreadsheet.\n     * @private\n     */\n    function Edit(parent) {\n        this.editorElem = null;\n        this.editCellData = {};\n        this.isEdit = false;\n        this.isCellEdit = true;\n        this.isNewValueEdit = true;\n        this.keyCodes = {\n            BACKSPACE: 8,\n            SPACE: 32,\n            TAB: 9,\n            DELETE: 46,\n            ESC: 27,\n            ENTER: 13,\n            FIRSTALPHABET: 65,\n            LASTALPHABET: 90,\n            FIRSTNUMBER: 48,\n            LASTNUMBER: 59,\n            FIRSTNUMPAD: 96,\n            LASTNUMPAD: 111,\n            SYMBOLSETONESTART: 186,\n            SYMBOLSETONEEND: 192,\n            SYMBOLSETTWOSTART: 219,\n            SYMBOLSETTWOEND: 222,\n            FIREFOXEQUALPLUS: 61,\n            FIREFOXMINUS: 173,\n            F2: 113\n        };\n        this.parent = parent;\n        this.init();\n        //Spreadsheet.Inject(WorkbookEdit);\n    }\n    Edit.prototype.init = function () {\n        this.addEventListener();\n    };\n    /**\n     * To destroy the edit module.\n     * @return {void}\n     * @hidden\n     */\n    Edit.prototype.destroy = function () {\n        this.removeEventListener();\n        this.parent = null;\n        this.editorElem = null;\n    };\n    Edit.prototype.addEventListener = function () {\n        EventHandler.add(this.parent.element, 'dblclick', this.dblClickHandler, this);\n        this.parent.on(mouseDown, this.mouseDownHandler, this);\n        this.parent.on(keyUp, this.keyUpHandler, this);\n        this.parent.on(keyDown, this.keyDownHandler, this);\n        this.parent.on(editOperation, this.performEditOperation, this);\n    };\n    Edit.prototype.removeEventListener = function () {\n        EventHandler.remove(this.parent.element, 'dblclick', this.dblClickHandler);\n        if (!this.parent.isDestroyed) {\n            this.parent.off(mouseDown, this.mouseDownHandler);\n            this.parent.off(keyUp, this.keyUpHandler);\n            this.parent.off(keyDown, this.keyDownHandler);\n            this.parent.off(editOperation, this.performEditOperation);\n        }\n    };\n    /**\n     * Get the module name.\n     * @returns string\n     * @private\n     */\n    Edit.prototype.getModuleName = function () {\n        return 'edit';\n    };\n    Edit.prototype.performEditOperation = function (args) {\n        var action = args.action;\n        switch (action) {\n            case 'renderEditor':\n                this.renderEditor();\n                break;\n            case 'refreshEditor':\n                this.refreshEditor(args.value, args.refreshFormulaBar, args.refreshEditorElem, args.isAppend, args.trigEvent);\n                if (args.refreshCurPos) {\n                    this.setCursorPosition();\n                }\n                break;\n            case 'startEdit':\n                if (!this.isEdit) {\n                    this.isNewValueEdit = args.isNewValueEdit;\n                    this.startEdit(args.address, args.value, args.refreshCurPos);\n                }\n                break;\n            case 'endEdit':\n                if (this.isEdit) {\n                    this.endEdit(args.refreshFormulaBar);\n                }\n                break;\n            case 'cancelEdit':\n                if (this.isEdit) {\n                    this.cancelEdit(args.refreshFormulaBar);\n                }\n                break;\n            case 'getCurrentEditValue':\n                args.editedValue = this.editCellData.value;\n                break;\n            case 'refreshDependentCellValue':\n                this.refreshDependentCellValue(args.rowIdx, args.colIdx, args.sheetIdx);\n                break;\n            case 'getPosition':\n                args.position = this.editorElem.getBoundingClientRect();\n                break;\n            case 'focusEditorElem':\n                this.editorElem.focus();\n                break;\n        }\n    };\n    Edit.prototype.keyUpHandler = function (e) {\n        if (this.isEdit) {\n            if (this.isCellEdit && this.editCellData.value !== this.editorElem.textContent) {\n                this.refreshEditor(this.editorElem.textContent, this.isCellEdit);\n            }\n        }\n    };\n    Edit.prototype.keyDownHandler = function (e) {\n        var trgtElem = e.target;\n        var keyCode = e.keyCode;\n        if (this.isEdit) {\n            if (this.isCellEdit) {\n                this.refreshEditor(this.editorElem.textContent, this.isCellEdit);\n            }\n            switch (keyCode) {\n                case this.keyCodes.ENTER:\n                    if (Browser.isWindows) {\n                        e.preventDefault();\n                    }\n                    this.endEdit();\n                    break;\n                case this.keyCodes.TAB:\n                    if (!this.hasFormulaSuggSelected()) {\n                        this.endEdit();\n                    }\n                    break;\n                case this.keyCodes.ESC:\n                    this.cancelEdit();\n                    break;\n            }\n        }\n        else {\n            if (!this.isEdit && (trgtElem.classList.contains('e-spreadsheet') || closest(trgtElem, '.e-sheet-panel'))) {\n                var isAlphabet = (keyCode >= this.keyCodes.FIRSTALPHABET && keyCode <= this.keyCodes.LASTALPHABET);\n                var isNumeric = (keyCode >= this.keyCodes.FIRSTNUMBER && keyCode <= this.keyCodes.LASTNUMBER);\n                var isNumpadKeys = (keyCode >= this.keyCodes.FIRSTNUMPAD && keyCode <= this.keyCodes.LASTNUMPAD);\n                var isSymbolkeys = (keyCode >= this.keyCodes.SYMBOLSETONESTART && keyCode <= this.keyCodes.SYMBOLSETONEEND);\n                if (!isSymbolkeys) {\n                    isSymbolkeys = (keyCode >= this.keyCodes.SYMBOLSETTWOSTART && keyCode <= this.keyCodes.SYMBOLSETTWOEND);\n                }\n                var isFirefoxExceptionkeys = (keyCode === this.keyCodes.FIREFOXEQUALPLUS) ||\n                    (keyCode === this.keyCodes.FIREFOXMINUS);\n                var isF2Edit = (!e.shiftKey && !e.ctrlKey && keyCode === this.keyCodes.F2);\n                var isBackSpace = keyCode === this.keyCodes.BACKSPACE;\n                if ((!e.ctrlKey && !e.altKey && ((!e.shiftKey && keyCode === this.keyCodes.SPACE) || isAlphabet || isNumeric ||\n                    isNumpadKeys || isSymbolkeys || (Browser.info.name === 'mozilla' && isFirefoxExceptionkeys))) || isF2Edit || isBackSpace) {\n                    if (isF2Edit) {\n                        this.isNewValueEdit = false;\n                    }\n                    this.startEdit();\n                }\n                if (keyCode === this.keyCodes.DELETE) {\n                    this.editingHandler('delete');\n                }\n            }\n        }\n    };\n    Edit.prototype.renderEditor = function () {\n        if (!this.editorElem || !this.parent.element.querySelector('#' + this.parent.element.id + '_edit')) {\n            var editor = void 0;\n            editor = this.parent.createElement('div', { id: this.parent.element.id + '_edit', className: 'e-spreadsheet-edit' });\n            editor.contentEditable = 'true';\n            editor.spellcheck = false;\n            this.editorElem = editor;\n            this.parent.element.querySelector('.e-main-content').appendChild(this.editorElem);\n        }\n        this.parent.notify(formulaOperation, { action: 'renderAutoComplete' });\n    };\n    Edit.prototype.refreshEditor = function (value, refreshFormulaBar, refreshEditorElem, isAppend, trigEvent) {\n        if (trigEvent === void 0) { trigEvent = true; }\n        if (isAppend) {\n            value = this.editCellData.value = this.editCellData.value + value;\n        }\n        else {\n            this.editCellData.value = value;\n        }\n        if (refreshEditorElem) {\n            this.editorElem.textContent = value;\n        }\n        if (refreshFormulaBar) {\n            this.parent.notify(formulaBarOperation, { action: 'refreshFormulabar', value: value });\n        }\n        if (trigEvent && this.editCellData.value === this.editorElem.textContent) {\n            if (this.triggerEvent('cellEditing')) {\n                this.cancelEdit();\n            }\n        }\n        // if (this.editorElem.scrollHeight + 2 <= this.editCellData.element.offsetHeight) {\n        //     this.editorElem.style.height = (this.editCellData.element.offsetHeight + 1) + 'px';\n        // } else {\n        //     this.editorElem.style.removeProperty('height');\n        // }\n    };\n    Edit.prototype.startEdit = function (address, value, refreshCurPos) {\n        if (refreshCurPos === void 0) { refreshCurPos = true; }\n        this.updateEditCellDetail(address, value);\n        this.initiateEditor(refreshCurPos);\n        this.positionEditor();\n        this.parent.isEdit = this.isEdit = true;\n        this.parent.notify(clearCopy, null);\n        this.parent.notify(enableToolbar, { enable: false });\n    };\n    Edit.prototype.setCursorPosition = function () {\n        var elem = this.editorElem;\n        var textLen = elem.textContent.length;\n        if (textLen) {\n            var selection = document.getSelection();\n            var range = document.createRange();\n            range.setStart(elem.firstChild, textLen);\n            range.collapse(true);\n            selection.removeAllRanges();\n            selection.addRange(range);\n        }\n        elem.focus();\n    };\n    Edit.prototype.hasFormulaSuggSelected = function () {\n        var suggDdlElem = document.getElementById(this.parent.element.id + '_ac_popup');\n        return suggDdlElem && suggDdlElem.style.visibility === 'visible' &&\n            suggDdlElem.querySelectorAll('.e-item-focus').length > 0;\n    };\n    Edit.prototype.editingHandler = function (action) {\n        switch (action) {\n            case 'delete':\n                var address = this.parent.getActiveSheet().selectedRange;\n                var range = getIndexesFromAddress(address);\n                range = range[0] > range[2] ? getSwapRange(range) : range;\n                address = getRangeAddress(range);\n                this.parent.clearRange(address, null, true);\n                this.parent.serviceLocator.getService('cell').refreshRange(range);\n                this.parent.notify(selectionComplete, {});\n                break;\n        }\n    };\n    Edit.prototype.mouseDownHandler = function (e) {\n        if (this.isEdit) {\n            var trgtElem = e.target;\n            this.isCellEdit = trgtElem.classList.contains('e-spreadsheet-edit');\n            if (trgtElem.classList.contains('e-cell') || trgtElem.classList.contains('e-header-cell') ||\n                trgtElem.classList.contains('e-selectall') || closest(trgtElem, '.e-toolbar-item.e-active')) {\n                this.endEdit();\n            }\n        }\n    };\n    Edit.prototype.dblClickHandler = function (e) {\n        var trgtElem = e.target;\n        if (trgtElem.classList.contains('e-active-cell') || trgtElem.classList.contains('e-cell')\n            || closest(trgtElem, '.e-main-content')) {\n            if (this.isEdit) {\n                this.endEdit();\n            }\n            else {\n                this.isNewValueEdit = false;\n                this.startEdit();\n            }\n        }\n    };\n    Edit.prototype.updateEditCellDetail = function (addr, value) {\n        var sheetIdx;\n        var sheet;\n        if (!this.editCellData.sheetIndex) {\n            if (addr && addr.split('!').length > 1) {\n                sheetIdx = getSheetIndex(this.parent, getSheetNameFromAddress(addr));\n            }\n            else {\n                sheetIdx = this.parent.activeSheetTab;\n            }\n        }\n        if (!this.editCellData.addr) {\n            sheet = getSheet(this.parent, sheetIdx - 1);\n            if (addr) {\n                addr = getRangeFromAddress(addr);\n            }\n            else {\n                addr = sheet.activeCell;\n            }\n        }\n        var range = getRangeIndexes(addr);\n        var rowIdx = range[0];\n        var colIdx = range[1];\n        var cellElem = this.parent.getCell(rowIdx, colIdx);\n        var cellPosition = getCellPosition(sheet, range);\n        this.editCellData = {\n            addr: addr,\n            fullAddr: getSheetName(this.parent, sheetIdx) + '!' + addr,\n            rowIndex: rowIdx,\n            colIndex: colIdx,\n            sheetIndex: sheetIdx,\n            element: cellElem,\n            value: value || '',\n            position: cellPosition\n        };\n    };\n    Edit.prototype.initiateEditor = function (refreshCurPos) {\n        var _this = this;\n        var data = this.parent.getData(this.editCellData.fullAddr);\n        data.then(function (values) {\n            values.forEach(function (cell, key) {\n                var args = { cell: cell, value: cell ? cell.value : '' };\n                _this.parent.notify(getFormattedBarText, args);\n                var value = cell ? args.value : '';\n                if (cell && cell.formula) {\n                    value = cell.formula;\n                }\n                _this.editCellData.oldValue = value;\n                if (_this.editCellData.value) {\n                    value = _this.editCellData.value;\n                }\n                else {\n                    _this.editCellData.value = value;\n                }\n                if (_this.isNewValueEdit) {\n                    value = '';\n                }\n                else {\n                    _this.isNewValueEdit = true;\n                }\n                if (value) {\n                    _this.refreshEditor(value, false, true, false, false);\n                }\n                if (refreshCurPos) {\n                    _this.setCursorPosition();\n                }\n                if (_this.triggerEvent('cellEdit')) {\n                    _this.cancelEdit(true, false);\n                }\n            });\n        });\n    };\n    Edit.prototype.positionEditor = function () {\n        var tdElem = this.editCellData.element;\n        tdElem.classList.add('e-ss-edited');\n        var left = this.editCellData.position.left + 1;\n        var top = this.editCellData.position.top + 1;\n        var minHeight = this.editCellData.element.offsetHeight - 3;\n        var minWidth = this.editCellData.element.offsetWidth - 3;\n        var mainContElement = this.parent.getMainContent();\n        var editWidth = mainContElement.offsetWidth - left - 28;\n        //let editHeight: number = mainContElement.offsetHeight - top - 28;\n        var inlineStyles = 'display:block;top:' + top + 'px;' + (this.parent.enableRtl ? 'right:' : 'left:') + left + 'px;' +\n            'min-width:' + minWidth + 'px;max-width:' + editWidth + 'px;height:' + minHeight + 'px;';\n        inlineStyles += tdElem.style.cssText;\n        this.editorElem.setAttribute('style', inlineStyles);\n        if (tdElem.classList.contains('e-right-align')) {\n            this.editorElem.classList.add('e-right-align');\n        }\n        else if (tdElem.classList.contains('e-center-align')) {\n            this.editorElem.classList.add('e-center-align');\n        }\n    };\n    Edit.prototype.updateEditedValue = function (tdRefresh) {\n        if (tdRefresh === void 0) { tdRefresh = true; }\n        var oldCellValue = this.editCellData.oldValue;\n        var oldValue = oldCellValue ? oldCellValue.toString().toUpperCase() : '';\n        /* To set the before cell details for undo redo. */\n        this.parent.notify(setActionData, { args: { action: 'beforeCellSave', eventArgs: { address: this.editCellData.addr } } });\n        if (oldCellValue !== this.editCellData.value || oldValue.indexOf('=RAND()') > -1 || oldValue.indexOf('RAND()') > -1 ||\n            oldValue.indexOf('=RANDBETWEEN(') > -1 || oldValue.indexOf('RANDBETWEEN(') > -1) {\n            var cellIndex = getRangeIndexes(this.parent.getActiveSheet().activeCell);\n            this.parent.notify(workbookEditOperation, { action: 'updateCellValue', address: this.editCellData.addr, value: this.editCellData.value });\n            var cell = getCell(cellIndex[0], cellIndex[1], this.parent.getActiveSheet(), true);\n            var eventArgs = this.getRefreshNodeArgs(cell);\n            this.editCellData.value = eventArgs.value;\n            if (cell.formula) {\n                this.editCellData.formula = cell.formula;\n            }\n            if (tdRefresh) {\n                this.parent.refreshNode(this.editCellData.element, eventArgs);\n            }\n        }\n    };\n    Edit.prototype.refreshDependentCellValue = function (rowIdx, colIdx, sheetIdx) {\n        if (rowIdx && colIdx) {\n            rowIdx--;\n            colIdx--;\n            if ((this.editCellData.rowIndex !== rowIdx || this.editCellData.colIndex !== colIdx)\n                && this.parent.activeSheetTab === sheetIdx) {\n                var td = this.parent.getCell(rowIdx, colIdx);\n                if (td) {\n                    var sheet = getSheet(this.parent, sheetIdx - 1);\n                    var cell = getCell(rowIdx, colIdx, sheet);\n                    var eventArgs = this.getRefreshNodeArgs(cell);\n                    this.parent.refreshNode(td, eventArgs);\n                }\n            }\n        }\n    };\n    Edit.prototype.getRefreshNodeArgs = function (cell) {\n        cell = cell ? cell : {};\n        var fCode = (cell && cell.format) ? cell.format : '';\n        var eventArgs = {\n            value: cell.value, format: fCode, onLoad: true,\n            formattedText: '', isRightAlign: false, type: 'General'\n        };\n        var args;\n        this.parent.notify(getFormattedCellObject, eventArgs);\n        eventArgs.formattedText = this.parent.allowNumberFormatting ? eventArgs.formattedText : eventArgs.value;\n        args = {\n            isRightAlign: eventArgs.isRightAlign,\n            result: eventArgs.formattedText,\n            type: eventArgs.type,\n            value: eventArgs.value,\n            curSymbol: eventArgs.curSymbol\n        };\n        return args;\n    };\n    Edit.prototype.endEdit = function (refreshFormulaBar) {\n        if (refreshFormulaBar === void 0) { refreshFormulaBar = false; }\n        if (refreshFormulaBar) {\n            this.refreshEditor(this.editCellData.oldValue, false, true, false, false);\n        }\n        this.updateEditedValue();\n        this.triggerEvent('cellSave');\n        this.resetEditState();\n        this.focusElement();\n    };\n    Edit.prototype.cancelEdit = function (refreshFormulaBar, trigEvent) {\n        if (refreshFormulaBar === void 0) { refreshFormulaBar = true; }\n        if (trigEvent === void 0) { trigEvent = true; }\n        this.refreshEditor(this.editCellData.oldValue, refreshFormulaBar, false, false, false);\n        if (trigEvent) {\n            this.triggerEvent('cellSave');\n        }\n        this.resetEditState();\n        this.focusElement();\n    };\n    Edit.prototype.focusElement = function () {\n        this.parent.element.focus();\n        this.parent.notify(enableToolbar, { enable: true });\n    };\n    Edit.prototype.triggerEvent = function (eventName) {\n        var eventArgs = {\n            element: this.editCellData.element,\n            value: this.editCellData.value,\n            oldValue: this.editCellData.oldValue,\n            address: this.editCellData.fullAddr\n        };\n        if (eventName === 'cellSave') {\n            if (this.editCellData.formula) {\n                eventArgs.formula = this.editCellData.formula;\n            }\n            this.parent.notify(completeAction, { eventArgs: eventArgs, action: 'cellSave' });\n        }\n        if (eventName !== 'cellSave') {\n            eventArgs.cancel = false;\n        }\n        this.parent.trigger(eventName, eventArgs);\n        return eventArgs.cancel;\n    };\n    Edit.prototype.altEnter = function () {\n        var text;\n        var textBefore;\n        var textAfter;\n        var selection = window.getSelection();\n        var node = selection.anchorNode;\n        var offset;\n        var range = document.createRange();\n        offset = (node.nodeType === 3) ? selection.anchorOffset : node.textContent.length;\n        text = node.textContent;\n        textBefore = text.slice(0, offset);\n        textAfter = text.slice(offset) || ' ';\n        node.textContent = textBefore + '\\n' + textAfter;\n        range = document.createRange();\n        if (node.nodeType === 3) {\n            range.setStart(node, offset + 1);\n            range.setEnd(node, offset + 1);\n        }\n        else if (node.nodeType === 1) {\n            range.setStart(node.firstChild, offset + 1);\n            range.setEnd(node.firstChild, offset + 1);\n        }\n        selection.removeAllRanges();\n        selection.addRange(range);\n    };\n    Edit.prototype.resetEditState = function (elemRefresh) {\n        if (elemRefresh === void 0) { elemRefresh = true; }\n        if (elemRefresh) {\n            this.editCellData.element.classList.remove('e-ss-edited');\n            this.editorElem.textContent = '';\n            this.editorElem.removeAttribute('style');\n            this.editorElem.classList.remove('e-right-align');\n        }\n        this.editCellData = {};\n        this.parent.isEdit = this.isEdit = false;\n        this.isCellEdit = true;\n        this.parent.notify(formulaOperation, { action: 'endEdit' });\n    };\n    return Edit;\n}());\nexport { Edit };\n","import { contentLoaded, mouseDown, virtualContentLoaded, cellNavigate, getUpdateUsingRaf } from '../common/index';\nimport { getColumnsWidth, updateSelectedRange, getColumnWidth } from '../../workbook/index';\nimport { getRowHeight, isSingleCell, activeCellChanged } from '../../workbook/index';\nimport { EventHandler, addClass, removeClass, isNullOrUndefined, Browser } from '@syncfusion/ej2-base';\nimport { selectionComplete, getMoveEvent, getEndEvent, isTouchStart, locateElem } from '../common/index';\nimport { isTouchEnd, isTouchMove, getClientX, getClientY, mouseUpAfterSelection, selectRange, rowHeightChanged } from '../common/index';\nimport { colWidthChanged } from '../common/index';\nimport { getRangeIndexes, getCellAddress, getRangeAddress, getCellIndexes, getSwapRange } from '../../workbook/common/address';\n/**\n * Represents selection support for Spreadsheet.\n */\nvar Selection = /** @class */ (function () {\n    /**\n     * Constructor for the Spreadsheet selection module.\n     * @private\n     */\n    function Selection(parent) {\n        this.parent = parent;\n        this.addEventListener();\n        this.mouseMoveEvt = this.mouseMoveHandler.bind(this);\n    }\n    Selection.prototype.addEventListener = function () {\n        this.parent.on(contentLoaded, this.init, this);\n        this.parent.on(mouseDown, this.mouseDownHandler, this);\n        this.parent.on(virtualContentLoaded, this.virtualContentLoadedHandler, this);\n        this.parent.on(cellNavigate, this.cellNavigateHandler, this);\n        this.parent.on(selectRange, this.selectRange, this);\n        this.parent.on(rowHeightChanged, this.rowHeightChanged, this);\n        this.parent.on(colWidthChanged, this.colWidthChanged, this);\n    };\n    Selection.prototype.removeEventListener = function () {\n        if (!this.parent.isDestroyed) {\n            this.parent.off(contentLoaded, this.init);\n            this.parent.off(mouseDown, this.mouseDownHandler);\n            this.parent.off(virtualContentLoaded, this.virtualContentLoadedHandler);\n            this.parent.off(cellNavigate, this.cellNavigateHandler);\n            this.parent.off(selectRange, this.selectRange);\n            this.parent.off(rowHeightChanged, this.rowHeightChanged);\n            this.parent.off(colWidthChanged, this.colWidthChanged);\n        }\n    };\n    Selection.prototype.rowHeightChanged = function (args) {\n        var _this = this;\n        getUpdateUsingRaf(function () {\n            var ele = _this.getActiveCell();\n            var cellIndex = getCellIndexes(_this.parent.getActiveSheet().activeCell)[0];\n            if (cellIndex === args.rowIdx && ele) {\n                ele.style.height = parseInt(ele.style.height, 10) + args.threshold + \"px\";\n            }\n            else if (cellIndex > args.rowIdx && ele) {\n                ele.style.top = parseInt(ele.style.top, 10) + args.threshold + \"px\";\n            }\n            ele = _this.getSelectionElement();\n            if (ele) {\n                var selectedRange = getRangeIndexes(_this.parent.getActiveSheet().selectedRange);\n                var sRange = getSwapRange(selectedRange);\n                var rowStart = sRange[0];\n                var rowEnd = sRange[2];\n                if (rowStart <= args.rowIdx && rowEnd >= args.rowIdx && ele) {\n                    ele.style.height = parseInt(ele.style.height, 10) + args.threshold + \"px\";\n                }\n                else if (rowStart > args.rowIdx && ele) {\n                    ele.style.top = parseInt(ele.style.top, 10) + args.threshold + \"px\";\n                }\n            }\n        });\n    };\n    Selection.prototype.colWidthChanged = function (args) {\n        var _this = this;\n        getUpdateUsingRaf(function () {\n            var ele = _this.getActiveCell();\n            var cellIndex = getCellIndexes(_this.parent.getActiveSheet().activeCell)[1];\n            if (cellIndex === args.colIdx && ele) {\n                ele.style.width = parseInt(ele.style.width, 10) + args.threshold + \"px\";\n            }\n            else if (cellIndex > args.colIdx && ele) {\n                ele.style.left = parseInt(ele.style.left, 10) + args.threshold + \"px\";\n            }\n            ele = _this.getSelectionElement();\n            var selectedRange = getRangeIndexes(_this.parent.getActiveSheet().selectedRange);\n            var sRange = getSwapRange(selectedRange);\n            var colStart = sRange[1];\n            var colEnd = sRange[3];\n            if (colStart <= args.colIdx && colEnd >= args.colIdx && ele) {\n                ele.style.width = parseInt(ele.style.width, 10) + args.threshold + \"px\";\n            }\n            else if (colStart > args.colIdx && ele) {\n                ele.style.left = parseInt(ele.style.left, 10) + args.threshold + \"px\";\n            }\n        });\n    };\n    Selection.prototype.selectRange = function (indexes) {\n        this.selectRangeByIdx(this.parent.selectionSettings.mode === 'Single' ? indexes.slice(0, 2).concat(indexes.slice(0, 2)) : indexes);\n    };\n    Selection.prototype.init = function () {\n        var range = getRangeIndexes(this.parent.getActiveSheet().selectedRange);\n        var sRange = getSwapRange(range);\n        var actRange = getCellIndexes(this.parent.getActiveSheet().activeCell);\n        var inRange = sRange[0] <= actRange[0] && sRange[2] >= actRange[0] && sRange[1] <= actRange[1]\n            && sRange[3] >= actRange[1];\n        this.createSelectionElement();\n        this.selectRangeByIdx(range, null, null, inRange);\n    };\n    Selection.prototype.createSelectionElement = function () {\n        var cont = this.parent.getMainContent();\n        var ele = this.parent.createElement('div', { className: 'e-selection' });\n        var activeCell = this.parent.createElement('div', { className: 'e-active-cell' });\n        cont.appendChild(ele);\n        cont.appendChild(activeCell);\n    };\n    Selection.prototype.mouseDownHandler = function (e) {\n        if (!this.parent.isEdit) {\n            if (this.getSheetElement().contains(e.target) && !e.target.classList.contains('e-colresize')\n                && !e.target.classList.contains('e-rowresize')) {\n                var sheet = this.parent.getActiveSheet();\n                var mode = this.parent.selectionSettings.mode;\n                var rowIdx = this.getRowIdxFromClientY(getClientY(e));\n                var colIdx = this.getColIdxFromClientX(getClientX(e));\n                var activeIdx = getCellIndexes(sheet.activeCell);\n                var isRowSelected = sheet.showHeaders && this.parent.getRowHeaderContent().contains(e.target);\n                var isColSelected = sheet.showHeaders && this.parent.getColumnHeaderContent().contains(e.target);\n                if (e.which === 3 && this.isSelected(rowIdx, colIdx)) {\n                    return;\n                }\n                if (mode === 'Multiple' && (!isTouchEnd(e) && (!isTouchStart(e) ||\n                    (isTouchStart(e) && activeIdx[0] === rowIdx && activeIdx[1] === colIdx)) || isColSelected || isRowSelected)) {\n                    document.addEventListener(getMoveEvent().split(' ')[0], this.mouseMoveEvt);\n                    if (!Browser.isPointer) {\n                        document.addEventListener(getMoveEvent().split(' ')[1], this.mouseMoveEvt, { passive: false });\n                    }\n                }\n                if (!isTouchEnd(e)) {\n                    EventHandler.add(document, getEndEvent(), this.mouseUpHandler, this);\n                }\n                if (isTouchStart(e) && !(isColSelected || isRowSelected)) {\n                    this.touchEvt = e;\n                    return;\n                }\n                if (isRowSelected) {\n                    this.isRowSelected = true;\n                    if (!e.shiftKey || mode === 'Single') {\n                        this.startCell = [rowIdx, 0];\n                    }\n                    this.selectRangeByIdx([this.startCell[0], 0, rowIdx, sheet.colCount - 1], e);\n                }\n                else if (isColSelected) {\n                    this.isColSelected = true;\n                    if (!e.shiftKey || mode === 'Single') {\n                        this.startCell = [0, colIdx];\n                    }\n                    this.selectRangeByIdx([0, this.startCell[1], sheet.rowCount - 1, colIdx], e);\n                }\n                else if (e.target.classList.contains('e-selectall')) {\n                    this.startCell = [0, 0];\n                    this.selectRangeByIdx([].concat(this.startCell, [sheet.rowCount - 1, sheet.colCount - 1]), e);\n                }\n                else if (!e.target.classList.contains('e-main-content')) {\n                    if (!e.shiftKey || mode === 'Single') {\n                        this.startCell = [rowIdx, colIdx];\n                    }\n                    this.selectRangeByIdx([].concat(this.startCell ? this.startCell : getCellIndexes(sheet.activeCell), [rowIdx, colIdx]), e);\n                }\n                if (this.parent.isMobileView()) {\n                    this.parent.element.classList.add('e-mobile-focused');\n                    this.parent.renderModule.setSheetPanelSize();\n                }\n            }\n        }\n    };\n    Selection.prototype.mouseMoveHandler = function (e) {\n        var _this = this;\n        if (isTouchMove(e)) {\n            e.preventDefault();\n        }\n        var sheet = this.parent.getActiveSheet();\n        var cont = this.getScrollContent();\n        var clientRect = cont.getBoundingClientRect();\n        var clientX = getClientX(e);\n        var clientY = getClientY(e);\n        // remove math.min or handle top and left auto scroll\n        var colIdx = this.isRowSelected ? sheet.colCount - 1 : this.getColIdxFromClientX(Math.min(clientX, clientRect.right));\n        var rowIdx = this.isColSelected ? sheet.rowCount - 1 : this.getRowIdxFromClientY(Math.min(clientY, clientRect.bottom));\n        var isScrollDown = clientY > clientRect.bottom && rowIdx < sheet.rowCount;\n        var isScrollUp = clientY < clientRect.top && rowIdx >= 0 && !this.isColSelected;\n        var isScrollRight = clientX > clientRect.right && colIdx < sheet.colCount;\n        var isScrollLeft = clientX < clientRect.left && colIdx >= 0 && !this.isRowSelected;\n        this.clearInterval();\n        if (isScrollDown || isScrollUp || isScrollRight || isScrollLeft) {\n            this.scrollInterval = setInterval(function () {\n                if ((isScrollDown || isScrollUp) && !_this.isColSelected) {\n                    rowIdx = _this.getRowIdxFromClientY(isScrollDown ? clientRect.bottom : clientRect.top);\n                    if (rowIdx >= sheet.rowCount) { // clear interval when scroll up\n                        _this.clearInterval();\n                        return;\n                    }\n                    cont.scrollTop += (isScrollDown ? 1 : -1) * getRowHeight(sheet, rowIdx);\n                }\n                if ((isScrollRight || isScrollLeft) && !_this.isRowSelected) {\n                    colIdx = _this.getColIdxFromClientX(isScrollRight ? clientRect.right : clientRect.left);\n                    if (colIdx >= sheet.colCount) { // clear interval when scroll left\n                        _this.clearInterval();\n                        return;\n                    }\n                    cont.scrollLeft += (isScrollRight ? 1 : -1) * getColumnWidth(sheet, colIdx);\n                }\n                _this.selectRangeByIdx([].concat(_this.startCell, [rowIdx, colIdx]), e);\n                // tslint:disable-next-line\n            }, 100);\n        }\n        else {\n            this.selectRangeByIdx([].concat(this.startCell ? this.startCell : getCellIndexes(sheet.activeCell), [rowIdx, colIdx]), e);\n        }\n    };\n    Selection.prototype.mouseUpHandler = function (e) {\n        var rowIdx = this.getRowIdxFromClientY(getClientY(e));\n        var colIdx = this.getColIdxFromClientX(getClientX(e));\n        this.clearInterval();\n        if (isTouchEnd(e) && !(this.isColSelected || this.isRowSelected) &&\n            (this.getRowIdxFromClientY(getClientY(this.touchEvt)) === rowIdx &&\n                this.getColIdxFromClientX(getClientX(this.touchEvt)) === colIdx)) {\n            this.mouseDownHandler(e);\n        }\n        this.parent.trigger('select', { range: this.parent.getActiveSheet().selectedRange });\n        document.removeEventListener(getMoveEvent().split(' ')[0], this.mouseMoveEvt);\n        if (!Browser.isPointer) {\n            document.removeEventListener(getMoveEvent().split(' ')[1], this.mouseMoveEvt);\n        }\n        EventHandler.remove(document, getEndEvent(), this.mouseUpHandler);\n        this.parent.notify(mouseUpAfterSelection, e);\n    };\n    Selection.prototype.isSelected = function (rowIdx, colIdx) {\n        var indexes = getSwapRange(getRangeIndexes(this.parent.getActiveSheet().selectedRange));\n        return indexes[0] <= rowIdx && rowIdx <= indexes[2] && indexes[1] <= colIdx && colIdx <= indexes[3];\n    };\n    Selection.prototype.virtualContentLoadedHandler = function () {\n        var sheet = this.parent.getActiveSheet();\n        var indexes = getRangeIndexes(sheet.selectedRange);\n        if (this.isColSelected && this.isRowSelected) {\n            this.selectRangeByIdx([0, 0, sheet.rowCount - 1, sheet.colCount - 1], null, true);\n        }\n        else if (this.isColSelected) {\n            this.selectRangeByIdx([0, indexes[1], sheet.rowCount - 1, indexes[3]], null, true);\n        }\n        else if (this.isRowSelected) {\n            this.selectRangeByIdx([indexes[0], 0, indexes[2], sheet.colCount - 1], null, true);\n        }\n        else {\n            this.highlightHdr(indexes, indexes[0] >= this.parent.viewport.topIndex || indexes[2] >= this.parent.viewport.topIndex, indexes[1] >= this.parent.viewport.leftIndex || indexes[3] >= this.parent.viewport.leftIndex);\n        }\n    };\n    Selection.prototype.clearInterval = function () {\n        clearInterval(this.scrollInterval);\n        this.scrollInterval = null;\n    };\n    Selection.prototype.getScrollContent = function () {\n        return this.parent.getMainContent();\n    };\n    Selection.prototype.getScrollLeft = function () {\n        return this.parent.scrollModule ? this.parent.scrollModule.prevScroll.scrollLeft : 0;\n    };\n    Selection.prototype.cellNavigateHandler = function (args) {\n        this.selectRangeByIdx(args.range.concat(args.range));\n    };\n    Selection.prototype.getColIdxFromClientX = function (clientX) {\n        var width = 0;\n        var sheet = this.parent.getActiveSheet();\n        var cliRect = this.parent.getMainContent().getBoundingClientRect();\n        var left = (this.parent.enableRtl ? (cliRect.right - clientX) : (clientX - cliRect.left)) + this.getScrollLeft();\n        for (var i = 0;; i++) {\n            width += getColumnsWidth(sheet, i);\n            if (left < width) {\n                return i;\n            }\n        }\n    };\n    Selection.prototype.getRowIdxFromClientY = function (clientY) {\n        var height = 0;\n        var sheet = this.parent.getActiveSheet();\n        var top = (clientY - this.parent.getMainContent().getBoundingClientRect().top)\n            + this.parent.getMainContent().scrollTop;\n        for (var i = 0;; i++) {\n            height += getRowHeight(sheet, i);\n            if (top < height) {\n                return i;\n            }\n        }\n    };\n    Selection.prototype.selectRangeByIdx = function (range, e, isScrollRefresh, isActCellChanged) {\n        var ele = this.getSelectionElement();\n        var sheet = this.parent.getActiveSheet();\n        var args = { range: getRangeAddress(range), cancel: false };\n        this.parent.trigger('beforeSelect', args);\n        if (args.cancel === true) {\n            return;\n        }\n        if (isSingleCell(range)) {\n            ele.classList.add('e-hide');\n        }\n        else {\n            ele.classList.remove('e-hide');\n            locateElem(ele, range, sheet, this.parent.enableRtl);\n        }\n        updateSelectedRange(this.parent, getRangeAddress(range), sheet);\n        this.UpdateRowColSelected(range);\n        this.highlightHdr(range);\n        if (!isScrollRefresh && !(e && (e.type === 'mousemove' || isTouchMove(e)))) {\n            this.updateActiveCell(isActCellChanged ? getCellIndexes(sheet.activeCell) : range);\n        }\n        if (isNullOrUndefined(e)) {\n            e = { type: 'mousedown' };\n        }\n        this.parent.notify(selectionComplete, e);\n    };\n    Selection.prototype.UpdateRowColSelected = function (indexes) {\n        var sheet = this.parent.getActiveSheet();\n        this.isRowSelected = (indexes[1] === 0 && indexes[3] === sheet.colCount - 1);\n        this.isColSelected = (indexes[0] === 0 && indexes[2] === sheet.rowCount - 1);\n    };\n    Selection.prototype.updateActiveCell = function (range) {\n        var sheet = this.parent.getActiveSheet();\n        var topLeftIdx = getRangeIndexes(sheet.topLeftCell);\n        var rowIdx = this.isColSelected ? topLeftIdx[0] : range[0];\n        var colIdx = this.isRowSelected ? topLeftIdx[1] : range[1];\n        sheet.activeCell = getCellAddress(rowIdx, colIdx);\n        this.parent.setProperties({ 'sheets': this.parent.sheets }, true);\n        locateElem(this.getActiveCell(), getRangeIndexes(sheet.activeCell), sheet, this.parent.enableRtl);\n        this.parent.notify(activeCellChanged, [rowIdx, colIdx]);\n    };\n    Selection.prototype.getSelectionElement = function () {\n        return this.parent.element.getElementsByClassName('e-selection')[0];\n    };\n    Selection.prototype.getActiveCell = function () {\n        return this.parent.getMainContent().getElementsByClassName('e-active-cell')[0];\n    };\n    Selection.prototype.getSheetElement = function () {\n        return document.getElementById(this.parent.element.id + '_sheet');\n    };\n    Selection.prototype.highlightHdr = function (range, isRowRefresh, isColRefresh) {\n        if (isRowRefresh === void 0) { isRowRefresh = true; }\n        if (isColRefresh === void 0) { isColRefresh = true; }\n        if (this.parent.getActiveSheet().showHeaders) {\n            var rowHdr = [];\n            var colHdr = [];\n            var swapRange = getSwapRange(range);\n            swapRange = this.getHdrIndexes(swapRange);\n            var selectAll = this.parent.element.getElementsByClassName('e-select-all-cell')[0];\n            removeClass(this.getSheetElement().querySelectorAll('.e-highlight'), 'e-highlight');\n            removeClass(this.getSheetElement().querySelectorAll('.e-prev-highlight'), 'e-prev-highlight');\n            removeClass([selectAll], ['e-prev-highlight-right', 'e-prev-highlight-bottom']);\n            if (isRowRefresh) {\n                rowHdr = [].slice.call(this.parent.getRowHeaderContent().querySelectorAll('td')).slice(swapRange[0], swapRange[2] + 1);\n            }\n            if (isColRefresh) {\n                colHdr = [].slice.call(this.parent.getColumnHeaderContent().querySelectorAll('th')).slice(swapRange[1], swapRange[3] + 1);\n            }\n            addClass([].concat(rowHdr, colHdr), 'e-highlight');\n            if (rowHdr.length && rowHdr[0].parentElement.previousElementSibling) {\n                rowHdr[0].parentElement.previousElementSibling.classList.add('e-prev-highlight');\n            }\n            if (colHdr.length && colHdr[0].previousElementSibling) {\n                colHdr[0].previousElementSibling.classList.add('e-prev-highlight');\n            }\n            if (this.isRowSelected && this.isColSelected) {\n                document.getElementById(this.parent.element.id + \"_select_all\").classList.add('e-highlight');\n            }\n            if (swapRange[0] === 0) {\n                selectAll.classList.add('e-prev-highlight-bottom');\n            }\n            if (swapRange[1] === 0) {\n                selectAll.classList.add('e-prev-highlight-right');\n            }\n        }\n    };\n    Selection.prototype.getHdrIndexes = function (range) {\n        if (this.parent.scrollSettings.enableVirtualization) {\n            var indexes = [];\n            var hiddenRowCount = this.parent.hiddenRowsCount(this.parent.viewport.topIndex, range[0]);\n            indexes[0] = this.isColSelected ? range[0] : (range[0] - this.parent.viewport.topIndex) < 0\n                ? 0 : ((range[0] - hiddenRowCount) - this.parent.viewport.topIndex);\n            indexes[1] = this.isRowSelected ? range[1] : (range[1] - this.parent.viewport.leftIndex) < 0\n                ? 0 : (range[1] - this.parent.viewport.leftIndex);\n            indexes[2] = this.isColSelected ? this.parent.viewport.rowCount + this.parent.getThreshold('row') * 2 : range[2] -\n                this.parent.hiddenRowsCount(range[0], range[2]) - hiddenRowCount - this.parent.viewport.topIndex;\n            indexes[3] = this.isRowSelected ? this.parent.viewport.colCount + this.parent.getThreshold('col') * 2 : indexes[1] === 0\n                ? range[3] - this.parent.viewport.leftIndex : range[3] - range[1] + indexes[1];\n            return indexes;\n        }\n        return range;\n    };\n    /**\n     * For internal use only - Get the module name.\n     * @private\n     */\n    Selection.prototype.getModuleName = function () {\n        return 'selection';\n    };\n    Selection.prototype.destroy = function () {\n        this.removeEventListener();\n        this.parent = null;\n    };\n    return Selection;\n}());\nexport { Selection };\n","import { EventHandler, Browser } from '@syncfusion/ej2-base';\nimport { contentLoaded, spreadsheetDestroyed, onVerticalScroll, onHorizontalScroll, getScrollBarWidth } from '../common/index';\nimport { onContentScroll, deInitProperties } from '../common/index';\nimport { getRowHeight, getColumnWidth, getCellAddress } from '../../workbook/index';\n/**\n * The `Scroll` module is used to handle scrolling behavior.\n * @hidden\n */\nvar Scroll = /** @class */ (function () {\n    /**\n     * Constructor for the Spreadsheet scroll module.\n     * @private\n     */\n    function Scroll(parent) {\n        this.parent = parent;\n        this.addEventListener();\n        this.initProps();\n    }\n    Scroll.prototype.onContentScroll = function (e) {\n        var target = this.parent.getMainContent();\n        var scrollLeft = e.scrollLeft || target.scrollLeft;\n        var top = e.scrollTop || target.scrollTop;\n        var left = this.parent.enableRtl ? this.initScrollValue - scrollLeft : scrollLeft;\n        var scrollArgs;\n        var prevSize;\n        if (this.prevScroll.scrollLeft !== left) {\n            var scrollRight = left > this.prevScroll.scrollLeft;\n            prevSize = this.offset.left.size;\n            this.offset.left = this.getColOffset(left, scrollRight);\n            if (this.parent.getActiveSheet().showHeaders) {\n                this.parent.getColumnHeaderContent().scrollLeft = scrollLeft;\n            }\n            scrollArgs = {\n                cur: this.offset.left, prev: { idx: this.leftIndex, size: prevSize }, increase: scrollRight, preventScroll: e.preventScroll\n            };\n            this.parent.notify(onHorizontalScroll, scrollArgs);\n            this.updateTopLeftCell();\n            if (!this.parent.scrollSettings.enableVirtualization && scrollRight && !this.parent.scrollSettings.isFinite) {\n                this.updateNonVirtualCols();\n            }\n            this.leftIndex = scrollArgs.prev.idx;\n            this.prevScroll.scrollLeft = left;\n        }\n        if (this.prevScroll.scrollTop !== top) {\n            var scrollDown = top > this.prevScroll.scrollTop;\n            prevSize = this.offset.top.size;\n            this.offset.top = this.getRowOffset(top, scrollDown);\n            if (this.parent.getActiveSheet().showHeaders) {\n                this.parent.getRowHeaderContent().scrollTop = top;\n            }\n            scrollArgs = {\n                cur: this.offset.top, prev: { idx: this.topIndex, size: prevSize }, increase: scrollDown, preventScroll: e.preventScroll\n            };\n            this.parent.notify(onVerticalScroll, scrollArgs);\n            this.updateTopLeftCell();\n            if (!this.parent.scrollSettings.enableVirtualization && scrollDown && !this.parent.scrollSettings.isFinite) {\n                this.updateNonVirtualRows();\n            }\n            this.topIndex = scrollArgs.prev.idx;\n            this.prevScroll.scrollTop = top;\n        }\n    };\n    Scroll.prototype.updateNonVirtualRows = function () {\n        var sheet = this.parent.getActiveSheet();\n        var threshold = this.parent.getThreshold('row');\n        if (this.offset.top.idx > sheet.rowCount - (this.parent.viewport.rowCount + threshold)) {\n            this.parent.renderModule.refreshUI({ colIndex: 0, direction: 'first', refresh: 'RowPart' }, getCellAddress(sheet.rowCount, 0) + \":\" + getCellAddress(sheet.rowCount + threshold - 1, sheet.colCount - 1));\n            sheet.rowCount += threshold;\n            this.parent.setProperties({ 'sheets': this.parent.sheets }, true);\n        }\n    };\n    Scroll.prototype.updateNonVirtualCols = function () {\n        var sheet = this.parent.getActiveSheet();\n        var threshold = this.parent.getThreshold('col');\n        if (this.offset.left.idx > sheet.colCount - (this.parent.viewport.colCount + threshold)) {\n            this.parent.renderModule.refreshUI({ rowIndex: 0, colIndex: sheet.colCount, direction: 'first', refresh: 'ColumnPart' }, getCellAddress(0, sheet.colCount) + \":\" + getCellAddress(sheet.rowCount - 1, sheet.colCount + threshold - 1));\n            sheet.colCount += threshold;\n            this.parent.setProperties({ 'sheets': this.parent.sheets }, true);\n        }\n    };\n    Scroll.prototype.updateTopLeftCell = function () {\n        this.parent.getActiveSheet().topLeftCell = getCellAddress(this.offset.top.idx, this.offset.left.idx);\n        this.parent.setProperties({ 'sheets': this.parent.sheets }, true);\n    };\n    Scroll.prototype.getRowOffset = function (scrollTop, scrollDown) {\n        var temp = this.offset.top.size;\n        var sheet = this.parent.getActiveSheet();\n        var i = scrollDown ? this.offset.top.idx + 1 : (this.offset.top.idx ? this.offset.top.idx - 1 : 0);\n        var count;\n        if (this.parent.scrollSettings.isFinite) {\n            count = sheet.rowCount;\n            if (scrollDown && i + this.parent.viewport.rowCount + this.parent.getThreshold('row') >= count) {\n                return { idx: this.offset.top.idx, size: this.offset.top.size };\n            }\n        }\n        else {\n            count = Infinity;\n        }\n        while (i < count) {\n            if (scrollDown) {\n                temp += getRowHeight(sheet, i - 1);\n                if (temp === scrollTop) {\n                    return { idx: i, size: temp };\n                }\n                if (temp > scrollTop) {\n                    return { idx: i - 1, size: temp - getRowHeight(sheet, i - 1) };\n                }\n                i++;\n            }\n            else {\n                if (temp === 0) {\n                    return { idx: 0, size: 0 };\n                }\n                temp -= getRowHeight(sheet, i);\n                if (temp === scrollTop) {\n                    return { idx: i, size: temp };\n                }\n                if (temp < scrollTop) {\n                    temp += getRowHeight(sheet, i);\n                    if (temp > scrollTop) {\n                        return { idx: i, size: temp - getRowHeight(sheet, i) };\n                    }\n                    else {\n                        return { idx: i + 1, size: temp };\n                    }\n                }\n                i--;\n            }\n        }\n        return { idx: this.offset.top.idx, size: this.offset.top.size };\n    };\n    Scroll.prototype.getColOffset = function (scrollLeft, increase) {\n        var temp = this.offset.left.size;\n        var sheet = this.parent.getActiveSheet();\n        var i = increase ? this.offset.left.idx + 1 : this.offset.left.idx - 1;\n        var count;\n        if (this.parent.scrollSettings.isFinite) {\n            count = sheet.colCount;\n            if (increase && i + this.parent.viewport.colCount + this.parent.getThreshold('col') >= count) {\n                return { idx: this.offset.left.idx, size: this.offset.left.size };\n            }\n        }\n        else {\n            count = Infinity;\n        }\n        while (i < count) {\n            if (increase) {\n                temp += getColumnWidth(sheet, i - 1);\n                if (temp === scrollLeft) {\n                    return { idx: i, size: temp };\n                }\n                if (temp > scrollLeft) {\n                    return { idx: i - 1, size: temp - getColumnWidth(sheet, i - 1) };\n                }\n                i++;\n            }\n            else {\n                if (temp === 0) {\n                    return { idx: 0, size: 0 };\n                }\n                temp -= getColumnWidth(sheet, i);\n                if (temp === scrollLeft) {\n                    return { idx: i, size: temp };\n                }\n                if (temp < scrollLeft) {\n                    temp += getColumnWidth(sheet, i);\n                    if (temp > scrollLeft) {\n                        return { idx: i, size: temp - getColumnWidth(sheet, i) };\n                    }\n                    else {\n                        return { idx: i + 1, size: temp };\n                    }\n                }\n                i--;\n            }\n        }\n        return { idx: this.offset.left.idx, size: this.offset.left.size };\n    };\n    Scroll.prototype.wireEvents = function () {\n        this.onScroll = this.onContentScroll.bind(this);\n        EventHandler.add(this.parent.getMainContent(), 'scroll', this.onScroll, this);\n        if (this.parent.enableRtl) {\n            this.initScrollValue = this.parent.getMainContent().scrollLeft;\n        }\n    };\n    Scroll.prototype.initProps = function () {\n        this.topIndex = 0;\n        this.leftIndex = 0;\n        this.prevScroll = { scrollLeft: 0, scrollTop: 0 };\n        this.offset = { left: { idx: 0, size: 0 }, top: { idx: 0, size: 0 } };\n    };\n    Scroll.prototype.getThreshold = function () {\n        /* Some browsers places the scroller outside the content,\n         * hence the padding should be adjusted.*/\n        if (Browser.info.name === 'mozilla') {\n            return 0.5;\n        }\n        return 1;\n    };\n    /**\n     * @hidden\n     */\n    Scroll.prototype.setPadding = function () {\n        if (!this.parent.allowScrolling) {\n            return;\n        }\n        var colHeader = this.parent.getColumnHeaderContent();\n        var rowHeader = this.parent.getRowHeaderContent();\n        var scrollWidth = getScrollBarWidth() - this.getThreshold();\n        var cssProps = this.parent.enableRtl ? { padding: 'paddingLeft', border: 'borderLeftWidth' }\n            : { padding: 'paddingRight', border: 'borderRightWidth' };\n        if (scrollWidth > 0) {\n            colHeader.parentElement.style[cssProps.padding] = scrollWidth + 'px';\n            colHeader.style[cssProps.border] = '1px';\n            rowHeader.style.marginBottom = scrollWidth + 'px';\n        }\n    };\n    Scroll.prototype.addEventListener = function () {\n        this.parent.on(contentLoaded, this.wireEvents, this);\n        this.parent.on(onContentScroll, this.onContentScroll, this);\n        this.parent.on(deInitProperties, this.initProps, this);\n        this.parent.on(spreadsheetDestroyed, this.destroy, this);\n    };\n    Scroll.prototype.destroy = function () {\n        EventHandler.remove(this.parent.getMainContent(), 'scroll', this.onScroll);\n        this.removeEventListener();\n        this.parent = null;\n    };\n    Scroll.prototype.removeEventListener = function () {\n        this.parent.off(contentLoaded, this.wireEvents);\n        this.parent.off(onContentScroll, this.onContentScroll);\n        this.parent.off(deInitProperties, this.initProps);\n        this.parent.off(spreadsheetDestroyed, this.destroy);\n    };\n    return Scroll;\n}());\nexport { Scroll };\n","import { isNullOrUndefined } from '@syncfusion/ej2-base';\nimport { spreadsheetDestroyed, beforeContentLoaded, beforeVirtualContentLoaded, virtualContentLoaded } from '../common/index';\nimport { colWidthChanged } from '../common/index';\nimport { onVerticalScroll, onHorizontalScroll, rowHeightChanged, beforeHeaderLoaded, deInitProperties } from '../common/index';\nimport { getRowHeight, getRowsHeight, getColumnWidth, getColumnsWidth, isHiddenRow } from './../../workbook/index';\nimport { getCellAddress } from '../../workbook/common/index';\nimport { updateUsedRange, sheetCreated, sheetsDestroyed } from '../../workbook/common/event';\n/**\n * VirtualScroll module\n * @hidden\n */\nvar VirtualScroll = /** @class */ (function () {\n    function VirtualScroll(parent) {\n        this.scroll = [];\n        this.parent = parent;\n        this.addEventListener();\n    }\n    VirtualScroll.prototype.createVirtualElement = function (args) {\n        var sheet = this.parent.getActiveSheet();\n        var container = this.parent.getMainContent();\n        this.content = this.parent.createElement('div', { className: 'e-virtualable' });\n        this.content.appendChild(container.querySelector('.e-table'));\n        container.appendChild(this.content);\n        var vTrack = container.appendChild(this.parent.createElement('div', { className: 'e-virtualtrack' }));\n        var colVTrack;\n        var rowVTrack;\n        var height;\n        var width;\n        if (this.parent.sheets.length > this.scroll.length) {\n            this.initScroll();\n        }\n        var domCount = this.parent.viewport.rowCount + 1 + (this.parent.getThreshold('row') * 2);\n        if (sheet.rowCount > domCount || sheet.usedRange.rowIndex > domCount) {\n            if (sheet.rowCount < sheet.usedRange.rowIndex) {\n                sheet.rowCount = sheet.usedRange.rowIndex;\n            }\n            this.setScrollCount(sheet.rowCount, 'row');\n            height = getRowsHeight(sheet, 0, this.scroll[this.parent.activeSheetTab - 1].rowCount - 1);\n        }\n        else {\n            this.scroll[this.parent.activeSheetTab - 1].rowCount = sheet.rowCount = domCount;\n            height = 1;\n        }\n        domCount = this.parent.viewport.colCount + 1 + (this.parent.getThreshold('col') * 2);\n        var size = getColumnsWidth(sheet, 0, domCount - 1);\n        if (sheet.colCount > domCount) {\n            if (sheet.colCount < sheet.usedRange.colIndex) {\n                sheet.colCount = sheet.usedRange.colIndex;\n            }\n            this.setScrollCount(sheet.colCount, 'col');\n            width = size + getColumnsWidth(sheet, domCount, this.scroll[this.parent.activeSheetTab - 1].colCount - 1);\n        }\n        else {\n            this.scroll[this.parent.activeSheetTab - 1].colCount = sheet.colCount = domCount;\n            width = size;\n        }\n        this.parent.setProperties({ 'sheets': this.parent.sheets }, true);\n        if (args.startColIdx) {\n            size = getColumnsWidth(sheet, args.startColIdx, args.startColIdx + domCount - 1);\n        }\n        if (isNullOrUndefined(this.translateX)) {\n            this.parent.viewport.leftIndex = 0;\n            this.translateX = 0;\n        }\n        if (isNullOrUndefined(this.parent.viewport.topIndex)) {\n            this.parent.viewport.topIndex = 0;\n        }\n        if (isNullOrUndefined(this.translateY)) {\n            this.translateY = 0;\n        }\n        if (sheet.showHeaders) {\n            container = this.parent.getRowHeaderContent();\n            this.rowHeader = this.content.cloneNode();\n            this.rowHeader.appendChild(container.querySelector('.e-table'));\n            container.appendChild(this.rowHeader);\n            rowVTrack = container.appendChild(vTrack.cloneNode());\n            this.rowHeader.style.transform = \"translate(0px, \" + this.translateY + \"px)\";\n            container = this.parent.getColumnHeaderContent();\n            this.colHeader = this.content.cloneNode();\n            this.colHeader.appendChild(container.querySelector('.e-table'));\n            container.appendChild(this.colHeader);\n            colVTrack = container.appendChild(vTrack.cloneNode());\n            this.colHeader.style.width = size + \"px\";\n            rowVTrack.style.height = height + \"px\";\n            colVTrack.style.width = width + \"px\";\n            this.colHeader.style.transform = \"translate(\" + this.translateX + \"px, 0px)\";\n        }\n        this.content.style.transform = \"translate(\" + this.translateX + \"px, \" + this.translateY + \"px)\";\n        this.content.style.width = size + \"px\";\n        vTrack.style.height = height + \"px\";\n        vTrack.style.width = width + \"px\";\n    };\n    VirtualScroll.prototype.initScroll = function () {\n        var i = 0;\n        while (i < this.parent.sheets.length) {\n            if (!this.scroll[i]) {\n                this.scroll.push({ rowCount: 0, colCount: 0 });\n            }\n            i++;\n        }\n    };\n    VirtualScroll.prototype.setScrollCount = function (count, layout) {\n        var activeSheetIdx = this.parent.activeSheetTab - 1;\n        if (!this.scroll[activeSheetIdx][layout + 'Count']) {\n            this.scroll[activeSheetIdx][layout + 'Count'] = count;\n        }\n    };\n    VirtualScroll.prototype.getAddress = function (topIdx) {\n        return getCellAddress(topIdx[0], this.parent.viewport.leftIndex) + \":\" + getCellAddress(topIdx[1], this.parent.viewport.leftIndex + this.parent.viewport.colCount + (this.parent.getThreshold('col') * 2));\n    };\n    VirtualScroll.prototype.getColAddress = function (leftIdx) {\n        return getCellAddress(this.parent.viewport.topIndex, leftIdx[0]) + \":\" + getCellAddress(this.parent.viewport.topIndex + this.parent.viewport.rowCount + (this.parent.getThreshold('row') * 2), leftIdx[1]);\n    };\n    VirtualScroll.prototype.updateScrollCount = function (idx, layout, threshold) {\n        if (threshold === void 0) { threshold = idx; }\n        var sheet = this.parent.getActiveSheet();\n        var rowCount = idx + this.parent.viewport[layout + 'Count'] + 1 + threshold;\n        var usedRangeCount = this.scroll[this.parent.activeSheetTab - 1][layout + 'Count'];\n        if (rowCount < usedRangeCount) {\n            if (sheet[layout + 'Count'] === usedRangeCount) {\n                return;\n            }\n            rowCount = usedRangeCount;\n        }\n        if (!this.parent.scrollSettings.isFinite) {\n            sheet[layout + 'Count'] = rowCount;\n            this.parent.setProperties({ 'sheets': this.parent.sheets }, true);\n        }\n    };\n    VirtualScroll.prototype.onVerticalScroll = function (args) {\n        var idx = args.cur.idx;\n        var height = args.cur.size;\n        var prevIdx = args.prev.idx;\n        var idxDiff = Math.abs(idx - prevIdx);\n        var threshold = this.parent.getThreshold('row');\n        if (idxDiff > Math.round(threshold / 2)) {\n            var startIdx = void 0;\n            var lastIdx = void 0;\n            var prevTopIdx = void 0;\n            if (idx <= threshold) {\n                if (!args.increase) {\n                    if (this.translateY && prevIdx > threshold) {\n                        this.translateY = 0;\n                        this.parent.viewport.topIndex = prevIdx - threshold;\n                        if (!args.preventScroll) {\n                            if (idxDiff < this.parent.viewport.rowCount + threshold) {\n                                lastIdx = this.parent.viewport.topIndex - 1;\n                                startIdx = this.parent.skipHiddenRows(0, lastIdx)[0];\n                                this.parent.viewport.topIndex = startIdx;\n                                var hiddenCount = this.checkHiddenCount(startIdx, lastIdx);\n                                var skippedHiddenIdx = this.checkHiddenIndex(this.parent.getActiveSheet(), (this.parent.viewport.bottomIndex - ((lastIdx - startIdx + 1) - hiddenCount)), args.increase);\n                                this.parent.viewport.bottomIndex -= (((lastIdx - startIdx + 1) - hiddenCount) +\n                                    (this.checkHiddenCount(skippedHiddenIdx, this.parent.viewport.bottomIndex)));\n                                this.parent.renderModule.refreshUI({ colIndex: this.parent.viewport.leftIndex, direction: 'last', refresh: 'RowPart' }, this.getAddress([0, lastIdx]));\n                            }\n                            else {\n                                this.parent.renderModule.refreshUI({ rowIndex: 0, colIndex: this.parent.viewport.leftIndex, refresh: 'Row' });\n                            }\n                        }\n                    }\n                    this.updateScrollCount(threshold, 'row');\n                }\n            }\n            if (prevIdx < threshold) {\n                idxDiff = Math.abs(idx - threshold);\n            }\n            if (idx > threshold) {\n                prevTopIdx = this.parent.viewport.topIndex;\n                this.parent.viewport.topIndex = idx - threshold;\n                if (args.increase && prevTopIdx > this.parent.viewport.topIndex) {\n                    this.parent.viewport.topIndex = prevTopIdx;\n                    return;\n                }\n                this.translateY = height - this.getThresholdHeight(this.parent.viewport.topIndex, threshold);\n                if (!args.preventScroll) {\n                    if (idxDiff < this.parent.viewport.rowCount + threshold) {\n                        if (args.increase) {\n                            startIdx = this.parent.viewport.bottomIndex + 1;\n                            lastIdx = this.parent.viewport.bottomIndex + (this.parent.viewport.topIndex - prevTopIdx);\n                            lastIdx -= this.checkHiddenCount(prevTopIdx, this.parent.viewport.topIndex - 1);\n                            this.parent.viewport.topIndex = this.checkHiddenIndex(this.parent.getActiveSheet(), this.parent.viewport.topIndex, args.increase);\n                            if (lastIdx === this.parent.viewport.bottomIndex) {\n                                return;\n                            }\n                            var indexes = this.parent.skipHiddenRows(startIdx, lastIdx);\n                            startIdx = indexes[0];\n                            lastIdx = indexes[1];\n                            lastIdx = this.checkLastIdx(lastIdx, 'row');\n                            this.parent.viewport.bottomIndex = lastIdx;\n                            this.parent.renderModule.refreshUI({ colIndex: this.parent.viewport.leftIndex, direction: 'first', refresh: 'RowPart' }, this.getAddress([startIdx, lastIdx]));\n                        }\n                        else {\n                            startIdx = this.parent.viewport.topIndex;\n                            lastIdx = startIdx + idxDiff - 1;\n                            var hiddenCount = this.checkHiddenCount(startIdx, lastIdx);\n                            var skippedHiddenIdx = this.checkHiddenIndex(this.parent.getActiveSheet(), (this.parent.viewport.bottomIndex - ((lastIdx - startIdx) - hiddenCount)), args.increase);\n                            this.parent.viewport.bottomIndex -= ((idxDiff - hiddenCount) +\n                                (this.checkHiddenCount(skippedHiddenIdx, this.parent.viewport.bottomIndex)));\n                            startIdx = this.parent.skipHiddenRows(startIdx, lastIdx)[0];\n                            this.parent.viewport.topIndex = startIdx;\n                            this.parent.renderModule.refreshUI({ colIndex: this.parent.viewport.leftIndex, direction: 'last', refresh: 'RowPart' }, this.getAddress([startIdx, lastIdx]));\n                        }\n                    }\n                    else {\n                        this.parent.renderModule.refreshUI({\n                            rowIndex: this.parent.viewport.topIndex,\n                            colIndex: this.parent.viewport.leftIndex, refresh: 'Row'\n                        });\n                    }\n                    this.updateScrollCount(idx, 'row', threshold);\n                }\n            }\n            args.prev.idx = idx;\n        }\n    };\n    VirtualScroll.prototype.checkHiddenIndex = function (sheet, index, increase) {\n        if (isHiddenRow(sheet, index)) {\n            increase ? index++ : index--;\n            index = this.checkHiddenIndex(sheet, index, increase);\n        }\n        return index;\n    };\n    VirtualScroll.prototype.checkHiddenCount = function (startIdx, endIdx) {\n        var index = 0;\n        var sheet = this.parent.getActiveSheet();\n        for (var i = startIdx; i <= endIdx; i++) {\n            if (isHiddenRow(sheet, i)) {\n                index++;\n            }\n        }\n        return index;\n    };\n    VirtualScroll.prototype.checkLastIdx = function (idx, layout) {\n        if (this.parent.scrollSettings.isFinite) {\n            var count = this.parent.getActiveSheet()[layout + 'Count'] - 1;\n            if (idx > count) {\n                idx = count;\n            }\n        }\n        return idx;\n    };\n    VirtualScroll.prototype.onHorizontalScroll = function (args) {\n        var idx = args.cur.idx;\n        var width = args.cur.size;\n        var prevIdx = args.prev.idx;\n        var idxDiff = Math.abs(idx - prevIdx);\n        var threshold = this.parent.getThreshold('col');\n        if (idxDiff > Math.round(threshold / 2)) {\n            if (idx <= threshold) {\n                if (!args.increase) {\n                    this.updateScrollCount(threshold, 'col');\n                    if (this.translateX && prevIdx > threshold) {\n                        this.translateX = 0;\n                        this.parent.viewport.leftIndex = prevIdx - threshold;\n                        if (idxDiff < this.parent.viewport.rowCount + threshold) {\n                            this.parent.renderModule.refreshUI({ rowIndex: this.parent.viewport.topIndex, colIndex: 0, direction: 'last', refresh: 'ColumnPart' }, this.getColAddress([0, this.parent.viewport.leftIndex - 1]));\n                        }\n                        else {\n                            this.parent.renderModule.refreshUI({ rowIndex: this.parent.viewport.topIndex, colIndex: 0, refresh: 'Column' });\n                        }\n                        this.parent.viewport.leftIndex = 0;\n                    }\n                }\n            }\n            if (prevIdx < threshold) {\n                idxDiff = Math.abs(idx - threshold);\n            }\n            if (idx > threshold) {\n                this.updateScrollCount(args.cur.idx, 'col', threshold);\n                this.parent.viewport.leftIndex = idx - threshold;\n                this.translateX = width - this.getThresholdWidth(this.parent.viewport.leftIndex, threshold);\n                if (!args.preventScroll) {\n                    if (idxDiff < this.parent.viewport.colCount + threshold) {\n                        if (args.increase) {\n                            var lastIdx = this.parent.viewport.leftIndex + this.parent.viewport.colCount + (threshold * 2);\n                            this.parent.renderModule.refreshUI({\n                                rowIndex: this.parent.viewport.topIndex, colIndex: lastIdx - idxDiff + 1,\n                                direction: 'first', refresh: 'ColumnPart'\n                            }, this.getColAddress([lastIdx - idxDiff + 1, this.checkLastIdx(lastIdx, 'col')]));\n                        }\n                        else {\n                            this.parent.renderModule.refreshUI({\n                                rowIndex: this.parent.viewport.topIndex, colIndex: this.parent.viewport.leftIndex,\n                                direction: 'last', refresh: 'ColumnPart'\n                            }, this.getColAddress([this.parent.viewport.leftIndex, this.parent.viewport.leftIndex + idxDiff - 1]));\n                        }\n                    }\n                    else {\n                        this.parent.renderModule.refreshUI({\n                            rowIndex: this.parent.viewport.topIndex,\n                            colIndex: this.parent.viewport.leftIndex, refresh: 'Column'\n                        });\n                    }\n                }\n            }\n            args.prev.idx = idx;\n        }\n    };\n    VirtualScroll.prototype.getThresholdHeight = function (idx, threshold) {\n        var height = 0;\n        var sheet = this.parent.getActiveSheet();\n        for (var i = idx; i < idx + threshold; i++) {\n            height += getRowHeight(sheet, i);\n        }\n        return height;\n    };\n    VirtualScroll.prototype.getThresholdWidth = function (idx, threshold) {\n        var width = 0;\n        var sheet = this.parent.getActiveSheet();\n        for (var i = idx; i < idx + threshold; i++) {\n            width += getColumnWidth(sheet, i);\n        }\n        return width;\n    };\n    VirtualScroll.prototype.translate = function (args) {\n        var sheet = this.parent.getActiveSheet();\n        if (args.refresh === 'Row' || args.refresh === 'RowPart') {\n            this.content.style.transform = \"translate(\" + this.translateX + \"px, \" + this.translateY + \"px)\";\n            if (sheet.showHeaders) {\n                this.rowHeader.style.transform = \"translate(0px, \" + this.translateY + \"px)\";\n            }\n        }\n        if (args.refresh === 'Column' || args.refresh === 'ColumnPart') {\n            var translateX = this.parent.enableRtl ? -this.translateX : this.translateX;\n            this.content.style.transform = \"translate(\" + translateX + \"px, \" + this.translateY + \"px)\";\n            if (sheet.showHeaders) {\n                this.colHeader.style.transform = \"translate(\" + translateX + \"px, 0px)\";\n            }\n        }\n    };\n    VirtualScroll.prototype.updateColumnWidth = function (args) {\n        if (args.refresh === 'Column') {\n            this.content.style.width = '';\n            var width = this.content.querySelector('tr').getBoundingClientRect().width;\n            if (this.parent.getActiveSheet().showHeaders) {\n                this.colHeader.style.width = width + 'px';\n            }\n            this.content.style.width = width + 'px';\n        }\n    };\n    VirtualScroll.prototype.updateUsedRange = function (args) {\n        if (!this.scroll.length) {\n            return;\n        }\n        var sheet = this.parent.getActiveSheet();\n        if (args.update === 'row') {\n            if (args.index > this.scroll[this.parent.activeSheetTab - 1].rowCount) {\n                var height = this.getVTrackHeight('height');\n                height += getRowsHeight(sheet, this.scroll[this.parent.activeSheetTab - 1].rowCount, args.index);\n                this.scroll[this.parent.activeSheetTab - 1].rowCount = args.index + 1;\n                this.updateVTrack(this.rowHeader, height, 'height');\n                if (this.scroll[this.parent.activeSheetTab - 1].rowCount > sheet.rowCount) {\n                    sheet.rowCount = this.scroll[this.parent.activeSheetTab - 1].rowCount;\n                }\n            }\n        }\n        else {\n            if (args.index > this.scroll[this.parent.activeSheetTab - 1].colCount) {\n                var width = this.getVTrackHeight('width');\n                width += getColumnsWidth(sheet, this.scroll[this.parent.activeSheetTab - 1].colCount, args.index);\n                this.scroll[this.parent.activeSheetTab - 1].colCount = args.index + 1;\n                this.updateVTrack(this.colHeader, width, 'width');\n                if (this.scroll[this.parent.activeSheetTab - 1].colCount > sheet.colCount) {\n                    sheet.colCount = this.scroll[this.parent.activeSheetTab - 1].colCount;\n                }\n            }\n        }\n    };\n    VirtualScroll.prototype.createHeaderElement = function (args) {\n        this.rowHeader = this.content.cloneNode();\n        this.colHeader = this.rowHeader.cloneNode();\n        this.rowHeader.style.width = '';\n        this.rowHeader.style.transform = \"translate(0px, \" + this.translateY + \"px)\";\n        this.colHeader.style.transform = \"translate(\" + (this.parent.enableRtl ? -this.translateX : this.translateX) + \"px, 0px)\";\n        this.rowHeader.appendChild(args.element.querySelector('table'));\n        args.element.appendChild(this.rowHeader);\n        var container = this.parent.getColumnHeaderContent();\n        this.colHeader.appendChild(container.querySelector('table'));\n        container.appendChild(this.colHeader);\n        var rowVTrack = this.content.nextElementSibling.cloneNode();\n        var colVTrack = rowVTrack.cloneNode();\n        rowVTrack.style.width = '';\n        colVTrack.style.height = '';\n        args.element.appendChild(rowVTrack);\n        container.appendChild(colVTrack);\n    };\n    VirtualScroll.prototype.getVTrackHeight = function (str) {\n        return parseInt(this.content.nextElementSibling.style[str], 10);\n    };\n    VirtualScroll.prototype.updateVTrackHeight = function (args) {\n        var domCount = this.parent.viewport.rowCount + 1 + (this.parent.getThreshold('row') * 2);\n        if (args.rowIdx >= domCount && args.rowIdx < this.scroll[this.parent.activeSheetTab - 1].rowCount) {\n            this.updateVTrack(this.rowHeader, this.getVTrackHeight('height') + args.threshold, 'height');\n        }\n    };\n    VirtualScroll.prototype.updateVTrackWidth = function (args) {\n        if (args.colIdx < this.parent.getActiveSheet().colCount) {\n            var hdrVTrack = this.parent.getColumnHeaderContent().getElementsByClassName('e-virtualtrack')[0];\n            hdrVTrack.style.width = parseInt(hdrVTrack.style.width, 10) + args.threshold + 'px';\n            var cntVTrack = this.parent.getMainContent().getElementsByClassName('e-virtualtrack')[0];\n            cntVTrack.style.width = parseInt(cntVTrack.style.width, 10) + args.threshold + 'px';\n            var hdrColumn = this.parent.getColumnHeaderContent().getElementsByClassName('e-virtualable')[0];\n            hdrColumn.style.width = parseInt(hdrColumn.style.width, 10) + args.threshold + 'px';\n            var cntColumn = this.parent.getMainContent().getElementsByClassName('e-virtualable')[0];\n            cntColumn.style.width = parseInt(cntColumn.style.width, 10) + args.threshold + 'px';\n        }\n    };\n    VirtualScroll.prototype.updateVTrack = function (header, size, sizeStr) {\n        if (this.parent.getActiveSheet().showHeaders) {\n            header.nextElementSibling.style[sizeStr] = size + \"px\";\n        }\n        this.content.nextElementSibling.style[sizeStr] = size + \"px\";\n    };\n    VirtualScroll.prototype.deInitProps = function () {\n        this.parent.viewport.leftIndex = null;\n        this.parent.viewport.topIndex = null;\n        this.parent.viewport.bottomIndex = null;\n        this.translateX = null;\n        this.translateY = null;\n    };\n    VirtualScroll.prototype.updateScrollProps = function (args) {\n        if (args === void 0) { args = { sheetIndex: 0 }; }\n        if (this.scroll.length === 0) {\n            this.initScroll();\n        }\n        else {\n            this.scroll.splice(args.sheetIndex, 0, { rowCount: 0, colCount: 0 });\n        }\n    };\n    VirtualScroll.prototype.sliceScrollProps = function (args) {\n        if (isNullOrUndefined(args.sheetIndex)) {\n            this.scroll.length = 0;\n        }\n        else {\n            this.scroll.splice(args.sheetIndex, 1);\n        }\n    };\n    VirtualScroll.prototype.addEventListener = function () {\n        this.parent.on(beforeContentLoaded, this.createVirtualElement, this);\n        this.parent.on(beforeVirtualContentLoaded, this.translate, this);\n        this.parent.on(virtualContentLoaded, this.updateColumnWidth, this);\n        this.parent.on(onVerticalScroll, this.onVerticalScroll, this);\n        this.parent.on(onHorizontalScroll, this.onHorizontalScroll, this);\n        this.parent.on(updateUsedRange, this.updateUsedRange, this);\n        this.parent.on(rowHeightChanged, this.updateVTrackHeight, this);\n        this.parent.on(colWidthChanged, this.updateVTrackWidth, this);\n        this.parent.on(beforeHeaderLoaded, this.createHeaderElement, this);\n        this.parent.on(deInitProperties, this.deInitProps, this);\n        this.parent.on(sheetsDestroyed, this.sliceScrollProps, this);\n        this.parent.on(sheetCreated, this.updateScrollProps, this);\n        this.parent.on(spreadsheetDestroyed, this.destroy, this);\n    };\n    VirtualScroll.prototype.destroy = function () {\n        this.removeEventListener();\n        this.rowHeader = null;\n        this.colHeader = null;\n        this.content = null;\n        this.parent = null;\n        this.scroll.length = 0;\n        this.translateX = null;\n        this.translateY = null;\n    };\n    VirtualScroll.prototype.removeEventListener = function () {\n        this.parent.off(beforeContentLoaded, this.createVirtualElement);\n        this.parent.off(beforeVirtualContentLoaded, this.translate);\n        this.parent.off(virtualContentLoaded, this.updateColumnWidth);\n        this.parent.off(onVerticalScroll, this.onVerticalScroll);\n        this.parent.off(onHorizontalScroll, this.onHorizontalScroll);\n        this.parent.off(updateUsedRange, this.updateUsedRange);\n        this.parent.off(rowHeightChanged, this.updateVTrackHeight);\n        this.parent.off(colWidthChanged, this.updateVTrackWidth);\n        this.parent.off(beforeHeaderLoaded, this.createHeaderElement);\n        this.parent.off(sheetsDestroyed, this.sliceScrollProps);\n        this.parent.off(sheetCreated, this.updateScrollProps);\n        this.parent.off(spreadsheetDestroyed, this.destroy);\n    };\n    return VirtualScroll;\n}());\nexport { VirtualScroll };\n","import { keyDown, cellNavigate, renameSheet, filterCellKeyDown } from '../common/index';\nimport { getCellIndexes, getRangeAddress, getRowHeight, getColumnWidth } from '../../workbook/index';\nimport { closest } from '@syncfusion/ej2-base';\n/**\n * Represents keyboard navigation support for Spreadsheet.\n */\nvar KeyboardNavigation = /** @class */ (function () {\n    /**\n     * Constructor for the Spreadsheet Keyboard Navigation module.\n     * @private\n     */\n    function KeyboardNavigation(parent) {\n        this.parent = parent;\n        this.addEventListener();\n        /* code snippet */\n    }\n    KeyboardNavigation.prototype.addEventListener = function () {\n        this.parent.on(keyDown, this.keyDownHandler, this);\n        /* code snippet */\n    };\n    KeyboardNavigation.prototype.removeEventListener = function () {\n        if (!this.parent.isDestroyed) {\n            this.parent.off(keyDown, this.keyDownHandler);\n        }\n        /* code snippet */\n    };\n    KeyboardNavigation.prototype.keyDownHandler = function (e) {\n        if (!this.parent.isEdit && (document.activeElement.classList.contains('e-spreadsheet') ||\n            closest(document.activeElement, '.e-sheet'))) {\n            var isNavigate = void 0;\n            var scrollIdxes = void 0;\n            var isRtl = this.parent.enableRtl;\n            var sheet = this.parent.getActiveSheet();\n            var filterArgs = { e: e, isFilterCell: false };\n            var actIdxes = getCellIndexes(this.parent.getActiveSheet().activeCell);\n            if ([9, 37, 38, 39, 40].indexOf(e.keyCode) > -1) {\n                e.preventDefault();\n            }\n            if (!e.shiftKey && e.altKey && (e.keyCode === 38 || e.keyCode === 40)) {\n                this.parent.notify(filterCellKeyDown, filterArgs);\n            }\n            if ((!e.shiftKey && ((!isRtl && e.keyCode === 37) || (isRtl && e.keyCode === 39)))\n                || (e.shiftKey && e.keyCode === 9)) { //left key\n                if (actIdxes[1] > 0) {\n                    actIdxes[1] -= 1;\n                    isNavigate = true;\n                }\n                else {\n                    var content = this.parent.getMainContent();\n                    if (actIdxes[1] === 0 && content.scrollLeft && !isRtl) {\n                        content.scrollLeft = 0;\n                    }\n                }\n            }\n            else if ((!filterArgs.isFilterCell && !e.shiftKey && e.keyCode === 38) || (e.shiftKey && e.keyCode === 13)) { // Up key\n                if (actIdxes[0] > 0) {\n                    actIdxes[0] -= 1;\n                    isNavigate = true;\n                }\n                else {\n                    var content = this.parent.getMainContent();\n                    if (actIdxes[0] === 0 && content.scrollTop) {\n                        content.scrollTop = 0;\n                    }\n                }\n            }\n            else if ((!e.shiftKey && ((!isRtl && e.keyCode === 39) || (isRtl && e.keyCode === 37))) || e.keyCode === 9) { // Right key\n                if (actIdxes[1] < sheet.colCount - 1) {\n                    actIdxes[1] += 1;\n                    isNavigate = true;\n                }\n            }\n            else if ((!filterArgs.isFilterCell && !e.shiftKey && e.keyCode === 40) || e.keyCode === 13) { // Down Key\n                if (actIdxes[0] < sheet.rowCount - 1) {\n                    actIdxes[0] += 1;\n                    isNavigate = true;\n                }\n            }\n            /* else if (e.keyCode === 36) {\n                actIdxes[1] = 0;\n                if (e.ctrlKey) {\n                    actIdxes[0] = 0;\n                }\n                isNavigate = true;\n                e.preventDefault();\n            } else if (e.keyCode === 35 && e.ctrlKey) {\n                actIdxes = [sheet.usedRange.rowIndex, sheet.usedRange.colIndex];\n                scrollIdxes = [sheet.usedRange.rowIndex - this.parent.viewport.rowCount,\n                    sheet.usedRange.colIndex - this.parent.viewport.colCount];\n                isNavigate = true;\n                e.preventDefault();\n            } */\n            if (isNavigate) {\n                this.scrollNavigation(scrollIdxes || actIdxes, scrollIdxes ? true : false);\n                sheet.activeCell = getRangeAddress(actIdxes);\n                this.parent.setProperties({ 'sheets': this.parent.sheets }, true);\n                this.parent.notify(cellNavigate, { range: actIdxes });\n            }\n        }\n        var target = e.target;\n        if (target.classList.contains('e-sheet-rename')) {\n            if (e.keyCode === 32) {\n                e.stopPropagation();\n            }\n            else if (e.keyCode === 13 || e.keyCode === 27) {\n                this.parent.notify(renameSheet, e);\n            }\n        }\n    };\n    KeyboardNavigation.prototype.scrollNavigation = function (actIdxes, isScroll) {\n        var x = this.parent.enableRtl ? -1 : 1;\n        var cont = this.parent.getMainContent();\n        var sheet = this.parent.getActiveSheet();\n        var prevActIdxes = getCellIndexes(sheet.activeCell);\n        var topLeftIdxes = getCellIndexes(sheet.topLeftCell);\n        if (this.getBottomIdx(topLeftIdxes) <= actIdxes[0] || isScroll) {\n            cont.scrollTop += getRowHeight(sheet, actIdxes[0]);\n        }\n        else if (topLeftIdxes[0] > actIdxes[0]) {\n            cont.scrollTop -= getRowHeight(sheet, actIdxes[0]);\n        }\n        if (this.getRightIdx(topLeftIdxes) <= actIdxes[1] || isScroll) {\n            cont.scrollLeft += getColumnWidth(sheet, actIdxes[1]) * x;\n        }\n        else if (topLeftIdxes[1] > actIdxes[1]) {\n            cont.scrollLeft -= getColumnWidth(sheet, actIdxes[1]) * x;\n        }\n    };\n    KeyboardNavigation.prototype.getBottomIdx = function (topLeftIdxes) {\n        var hgt = 0;\n        var sheet = this.parent.getActiveSheet();\n        for (var i = topLeftIdxes[0];; i++) {\n            hgt += getRowHeight(sheet, i);\n            if (hgt >= this.parent.viewport.height - 17) {\n                return i;\n            }\n        }\n    };\n    KeyboardNavigation.prototype.getRightIdx = function (topLeftIdxes) {\n        var width = 0;\n        var sheet = this.parent.getActiveSheet();\n        var contWidth = this.parent.getMainContent().offsetWidth;\n        for (var i = topLeftIdxes[1];; i++) {\n            width += getColumnWidth(sheet, i);\n            if (width >= contWidth - 17) {\n                return i;\n            }\n        }\n    };\n    /**\n     * For internal use only - Get the module name.\n     * @private\n     */\n    KeyboardNavigation.prototype.getModuleName = function () {\n        return 'keyboardNavigation';\n    };\n    KeyboardNavigation.prototype.destroy = function () {\n        this.removeEventListener();\n        this.parent = null;\n    };\n    return KeyboardNavigation;\n}());\nexport { KeyboardNavigation };\n","import { keyDown, cut, paste, copy, clearCopy, performUndoRedo, initiateHyperlink, editHyperlink } from '../common/index';\nimport { setCellFormat, textDecorationUpdate, getCellIndexes } from '../../workbook/common/index';\n/**\n * Represents keyboard shortcut support for Spreadsheet.\n */\nvar KeyboardShortcut = /** @class */ (function () {\n    /**\n     * Constructor for the Spreadsheet Keyboard Shortcut module.\n     * @private\n     */\n    function KeyboardShortcut(parent) {\n        this.parent = parent;\n        this.addEventListener();\n    }\n    KeyboardShortcut.prototype.addEventListener = function () {\n        this.parent.on(keyDown, this.keyDownHandler, this);\n    };\n    KeyboardShortcut.prototype.removeEventListener = function () {\n        if (!this.parent.isDestroyed) {\n            this.parent.off(keyDown, this.keyDownHandler);\n        }\n    };\n    KeyboardShortcut.prototype.keyDownHandler = function (e) {\n        if (e.ctrlKey) {\n            if ([79, 83, 65].indexOf(e.keyCode) > -1) {\n                e.preventDefault();\n            }\n            if (e.keyCode === 75) {\n                var sheet = this.parent.getActiveSheet();\n                var idx = getCellIndexes(sheet.activeCell);\n                var cell = sheet.rows[idx[0]].cells[idx[1]];\n                e.preventDefault();\n                if (cell && cell.hyperlink) {\n                    this.parent.notify(editHyperlink, null);\n                }\n                else {\n                    this.parent.notify(initiateHyperlink, null);\n                }\n            }\n            if (e.keyCode === 79) {\n                this.parent.element.querySelector('#' + this.parent.element.id + '_fileUpload').click();\n            }\n            else if (e.keyCode === 83) {\n                if (this.parent.saveUrl && this.parent.allowSave) {\n                    this.parent.save();\n                }\n            }\n            else if (e.keyCode === 88) {\n                this.parent.notify(cut, { promise: Promise });\n            }\n            else if (e.keyCode === 67) {\n                this.parent.notify(copy, { promise: Promise });\n            }\n            else if (e.keyCode === 86) {\n                this.parent.notify(paste, { isAction: true });\n            }\n            else if (e.keyCode === 66) {\n                e.preventDefault();\n                var value = this.parent.getCellStyleValue(['fontWeight'], getCellIndexes(this.parent.getActiveSheet().activeCell)).fontWeight;\n                value = value === 'bold' ? 'normal' : 'bold';\n                this.parent.notify(setCellFormat, { style: { fontWeight: value }, onActionUpdate: true, refreshRibbon: true });\n            }\n            else if (e.keyCode === 73) {\n                e.preventDefault();\n                var value = this.parent.getCellStyleValue(['fontStyle'], getCellIndexes(this.parent.getActiveSheet().activeCell)).fontStyle;\n                value = value === 'italic' ? 'normal' : 'italic';\n                this.parent.notify(setCellFormat, { style: { fontStyle: value }, onActionUpdate: true, refreshRibbon: true });\n            }\n            else if (e.keyCode === 85) {\n                e.preventDefault();\n                this.parent.notify(textDecorationUpdate, { style: { textDecoration: 'underline' }, refreshRibbon: true });\n            }\n            else if (e.keyCode === 53) {\n                e.preventDefault();\n                this.parent.notify(textDecorationUpdate, { style: { textDecoration: 'line-through' }, refreshRibbon: true });\n            }\n            else if (e.keyCode === 90) { /* Ctrl + Z */\n                if (!this.parent.isEdit) {\n                    e.preventDefault();\n                    this.parent.notify(performUndoRedo, { isUndo: true });\n                }\n            }\n            else if (e.keyCode === 89) { /* Ctrl + Y */\n                if (!this.parent.isEdit) {\n                    e.preventDefault();\n                    this.parent.notify(performUndoRedo, { isUndo: false });\n                }\n            }\n            if (e.shiftKey) {\n                if (e.keyCode === 76) { /* Ctrl + Shift + L */\n                    if (!this.parent.isEdit) {\n                        e.preventDefault();\n                        this.parent.applyFilter();\n                    }\n                }\n            }\n        }\n        if (e.keyCode === 27) {\n            this.parent.notify(clearCopy, null);\n        }\n    };\n    KeyboardShortcut.prototype.getModuleName = function () {\n        return 'keyboardShortcut';\n    };\n    KeyboardShortcut.prototype.destroy = function () {\n        this.removeEventListener();\n        this.parent = null;\n    };\n    return KeyboardShortcut;\n}());\nexport { KeyboardShortcut };\n","import { rowHeightChanged } from '../common/index';\nimport { getRowHeight, setRowHeight, applyCellFormat } from '../../workbook/index';\nimport { isNullOrUndefined } from '@syncfusion/ej2-base';\n/**\n * CellFormat module allows to format the cell styles.\n */\nvar CellFormat = /** @class */ (function () {\n    function CellFormat(parent) {\n        this.checkHeight = false;\n        //Spreadsheet.Inject(WorkbookCellFormat);\n        this.parent = parent;\n        this.row = parent.createElement('tr', { className: 'e-row' });\n        this.addEventListener();\n    }\n    CellFormat.prototype.applyCellFormat = function (args) {\n        var keys = Object.keys(args.style);\n        if (args.lastCell && !this.row.childElementCount && !keys.length) {\n            return;\n        }\n        var cell = args.cell || this.parent.getCell(args.rowIdx, args.colIdx);\n        if (cell) {\n            Object.assign(cell.style, args.style);\n            if (args.isHeightCheckNeeded) {\n                if (!args.manualUpdate) {\n                    if (this.isHeightCheckNeeded(args.style)) {\n                        var clonedCell = cell.cloneNode(true);\n                        if (!clonedCell.innerHTML) {\n                            clonedCell.textContent = 'Test';\n                        }\n                        this.row.appendChild(clonedCell);\n                    }\n                    if (args.lastCell && this.row.childElementCount) {\n                        var sheet = this.parent.getActiveSheet();\n                        var row = this.parent.getRow(args.rowIdx) || args.row;\n                        var prevHeight = getRowHeight(sheet, args.rowIdx);\n                        var height = this.getRowHeightOnInit();\n                        if (height > prevHeight) {\n                            row.style.height = height + \"px\";\n                            if (sheet.showHeaders) {\n                                (this.parent.getRow(args.rowIdx, this.parent.getRowHeaderTable()) || args.hRow).style.height =\n                                    height + \"px\";\n                            }\n                            setRowHeight(sheet, args.rowIdx, height);\n                        }\n                        this.row.innerHTML = '';\n                    }\n                }\n                else {\n                    var idx = void 0;\n                    if (this.parent.scrollSettings.enableVirtualization) {\n                        idx = args.rowIdx - this.parent.viewport.topIndex;\n                    }\n                    if (!this.checkHeight) {\n                        this.checkHeight = this.isHeightCheckNeeded(args.style, args.onActionUpdate);\n                    }\n                    if (isNullOrUndefined(this.parent.getActiveSheet().rows[idx]) ||\n                        isNullOrUndefined(this.parent.getActiveSheet().rows[idx].customHeight)) {\n                        this.updateRowHeight(cell, args.rowIdx, args.lastCell, args.onActionUpdate);\n                    }\n                    else {\n                        cell.parentElement.style.lineHeight = parseInt(cell.parentElement.style.height, 10) - 1 + 'px';\n                    }\n                }\n            }\n        }\n        else {\n            this.updateRowHeight(cell, args.rowIdx, true, args.onActionUpdate);\n        }\n    };\n    CellFormat.prototype.updateRowHeight = function (cell, rowIdx, isLastCell, onActionUpdate) {\n        if (this.checkHeight && isLastCell) {\n            this.checkHeight = false;\n            var sheet = this.parent.getActiveSheet();\n            var row = this.parent.getRow(rowIdx);\n            if (!row) {\n                return;\n            }\n            if (!cell) {\n                cell = row.lastElementChild;\n            }\n            var test = false;\n            row.style.height = '';\n            if (!cell.innerHTML) {\n                cell.textContent = 'test';\n                test = true;\n            }\n            var height = Math.ceil(row.getBoundingClientRect().height);\n            if (test) {\n                cell.textContent = '';\n            }\n            height = height < 20 ? 20 : height;\n            var prevHeight = getRowHeight(sheet, rowIdx);\n            var heightChanged = onActionUpdate ? height !== prevHeight : height > prevHeight;\n            if (heightChanged) {\n                row.style.height = height + \"px\";\n                if (sheet.showHeaders) {\n                    this.parent.getRow(rowIdx, this.parent.getRowHeaderTable()).style.height = height + \"px\";\n                }\n                setRowHeight(sheet, rowIdx, height);\n                this.parent.notify(rowHeightChanged, { rowIdx: rowIdx, threshold: height - prevHeight });\n            }\n            else {\n                row.style.height = prevHeight + \"px\";\n            }\n        }\n    };\n    CellFormat.prototype.isHeightCheckNeeded = function (style, onActionUpdate) {\n        var keys = Object.keys(style);\n        return (onActionUpdate ? keys.indexOf('fontSize') > -1 : keys.indexOf('fontSize') > -1\n            && Number(style.fontSize.split('pt')[0]) > 12) || keys.indexOf('fontFamily') > -1;\n    };\n    CellFormat.prototype.getRowHeightOnInit = function () {\n        var table = this.parent.createElement('table', { className: 'e-table e-test-table' });\n        var tBody = table.appendChild(this.parent.createElement('tbody'));\n        tBody.appendChild(this.row);\n        this.parent.element.appendChild(table);\n        var height = Math.round(this.row.getBoundingClientRect().height);\n        this.parent.element.removeChild(table);\n        return height < 20 ? 20 : height;\n    };\n    CellFormat.prototype.addEventListener = function () {\n        this.parent.on(applyCellFormat, this.applyCellFormat.bind(this));\n    };\n    CellFormat.prototype.removeEventListener = function () {\n        if (!this.parent.isDestroyed) {\n            this.parent.on(applyCellFormat, this.applyCellFormat.bind(this));\n        }\n    };\n    /**\n     * Destroy cell format module.\n     */\n    CellFormat.prototype.destroy = function () {\n        this.removeEventListener();\n        this.parent = null;\n        this.row = null;\n        this.checkHeight = null;\n    };\n    /**\n     * Get the cell format module name.\n     */\n    CellFormat.prototype.getModuleName = function () {\n        return 'cellformat';\n    };\n    return CellFormat;\n}());\nexport { CellFormat };\n","import { closest, EventHandler, isNullOrUndefined } from '@syncfusion/ej2-base';\nimport { colWidthChanged, rowHeightChanged, beforeHeaderLoaded, contentLoaded, hideShowRow } from '../common/index';\nimport { findMaxValue, setResize, autoFit, completeAction } from '../common/index';\nimport { setRowHeight, isHiddenRow, getColumn, setRow, getRowHeight } from '../../workbook/base/index';\nimport { getRangeIndexes, getSwapRange } from '../../workbook/common/index';\n/**\n * The `Resize` module is used to handle the resizing functionalities in Spreadsheet.\n */\nvar Resize = /** @class */ (function () {\n    /**\n     * Constructor for resize module in Spreadsheet.\n     * @private\n     */\n    function Resize(parent) {\n        this.parent = parent;\n        this.addEventListener();\n    }\n    Resize.prototype.addEventListener = function () {\n        this.parent.on(contentLoaded, this.wireEvents, this);\n        this.parent.on(beforeHeaderLoaded, this.wireEvents, this);\n        this.parent.on(autoFit, this.autoFit, this);\n    };\n    Resize.prototype.autoFit = function (args) {\n        args.isRow = args.isRow ? false : true;\n        var rowHdrTable = this.parent.getRowHeaderTable();\n        for (var i = args.startIndex; i <= args.endIndex; i++) {\n            this.trgtEle = this.parent.getRow(i, rowHdrTable);\n            this.setAutofit(i, args.isRow);\n        }\n    };\n    Resize.prototype.wireEvents = function (args) {\n        if (this.parent.getActiveSheet().showHeaders) {\n            var rowHeader = args ? args.element : this.parent.getRowHeaderContent();\n            var colHeader = this.parent.getColumnHeaderContent();\n            EventHandler.add(colHeader, 'dblclick', this.dblClickHandler, this);\n            EventHandler.add(rowHeader, 'dblclick', this.dblClickHandler, this);\n            EventHandler.add(colHeader, 'mousedown', this.mouseDownHandler, this);\n            EventHandler.add(rowHeader, 'mousedown', this.mouseDownHandler, this);\n            this.wireResizeCursorEvent(rowHeader, colHeader);\n        }\n    };\n    Resize.prototype.wireResizeCursorEvent = function (rowHeader, colHeader) {\n        EventHandler.add(rowHeader, 'mousemove', this.setTarget, this);\n        EventHandler.add(colHeader, 'mousemove', this.setTarget, this);\n    };\n    Resize.prototype.unWireResizeCursorEvent = function () {\n        EventHandler.remove(this.parent.getRowHeaderContent(), 'mousemove', this.setTarget);\n        EventHandler.remove(this.parent.getColumnHeaderContent(), 'mousemove', this.setTarget);\n    };\n    Resize.prototype.unwireEvents = function () {\n        if (this.parent.getActiveSheet().showHeaders) {\n            EventHandler.remove(this.parent.getColumnHeaderContent(), 'dblclick', this.dblClickHandler);\n            EventHandler.remove(this.parent.getRowHeaderContent(), 'dblclick', this.dblClickHandler);\n            EventHandler.remove(this.parent.getColumnHeaderContent(), 'mousedown', this.mouseDownHandler);\n            EventHandler.remove(this.parent.getRowHeaderContent(), 'mousedown', this.mouseDownHandler);\n            this.unWireResizeCursorEvent();\n        }\n    };\n    Resize.prototype.removeEventListener = function () {\n        if (!this.parent.isDestroyed) {\n            this.parent.off(contentLoaded, this.wireEvents);\n            this.parent.off(beforeHeaderLoaded, this.wireEvents);\n            this.parent.off(autoFit, this.autoFit);\n        }\n    };\n    Resize.prototype.mouseMoveHandler = function (e) {\n        var sheetPanel = this.parent.element.getElementsByClassName('e-sheet-panel')[0];\n        var colResizeHandler = this.parent.element.getElementsByClassName('e-colresize-handler')[0];\n        var rowResizeHandler = this.parent.element.getElementsByClassName('e-rowresize-handler')[0];\n        if (colResizeHandler || rowResizeHandler) {\n            this.isMouseMoved = true;\n            if (colResizeHandler) {\n                if (e.x > this.trgtEle.parentElement.firstChild.getBoundingClientRect().left) {\n                    colResizeHandler.style.left = e.clientX - this.parent.element.getBoundingClientRect().left + 'px';\n                }\n            }\n            else if (rowResizeHandler) {\n                if (e.y >= this.trgtEle.parentElement.parentElement.firstChild.getBoundingClientRect().top) {\n                    rowResizeHandler.style.top = e.clientY - sheetPanel.getBoundingClientRect().top + 'px';\n                }\n            }\n        }\n    };\n    Resize.prototype.mouseDownHandler = function (e) {\n        this.event = e;\n        this.trgtEle = e.target;\n        if (this.trgtEle.parentElement.classList.contains('e-hide-end')) {\n            var offset = this.trgtEle.offsetHeight;\n            var offsetY = e.offsetY;\n            if ((offset >= 10 && offsetY < 5) || (offset - 2 < 8 && offsetY < Math.ceil((offset - 2) / 2))) {\n                this.trgtEle.parentElement.classList.add('e-skip-resize');\n            }\n        }\n        this.updateTarget(e, this.trgtEle);\n        var trgt = this.trgtEle;\n        var className = trgt.classList.contains('e-colresize') ? 'e-colresize-handler' :\n            trgt.classList.contains('e-rowresize') ? 'e-rowresize-handler' : '';\n        this.createResizeHandler(trgt, className);\n        this.unWireResizeCursorEvent();\n        EventHandler.add(this.parent.element, 'mousemove', this.mouseMoveHandler, this);\n        EventHandler.add(document, 'mouseup', this.mouseUpHandler, this);\n    };\n    Resize.prototype.mouseUpHandler = function (e) {\n        var colResizeHandler = this.parent.element.getElementsByClassName('e-colresize-handler')[0];\n        var rowResizeHandler = this.parent.element.getElementsByClassName('e-rowresize-handler')[0];\n        this.resizeOn(e);\n        this.isMouseMoved = null;\n        var resizeHandler = colResizeHandler ? colResizeHandler : rowResizeHandler;\n        if (resizeHandler) {\n            this.parent.element.getElementsByClassName('e-sheet-panel')[0].removeChild(resizeHandler);\n            this.updateCursor(e);\n        }\n        EventHandler.remove(document, 'mouseup', this.mouseUpHandler);\n        EventHandler.remove(this.parent.element, 'mousemove', this.mouseMoveHandler);\n        this.wireResizeCursorEvent(this.parent.getRowHeaderContent(), this.parent.getColumnHeaderContent());\n    };\n    Resize.prototype.dblClickHandler = function (e) {\n        this.trgtEle = e.target;\n        this.updateTarget(e, this.trgtEle);\n        var trgt = this.trgtEle;\n        if (trgt.classList.contains('e-colresize') || trgt.classList.contains('e-rowresize')) {\n            var colIndx = parseInt(trgt.getAttribute('aria-colindex'), 10) - 1;\n            var rowIndx = parseInt(this.trgtEle.parentElement.getAttribute('aria-rowindex'), 10) - 1;\n            if (trgt.classList.contains('e-colresize')) {\n                var prevWdt = this.parent.getMainContent().getElementsByTagName('col')[colIndx].style.width;\n                this.setAutofit(colIndx, true, prevWdt);\n            }\n            else if (trgt.classList.contains('e-rowresize')) {\n                var prevHgt = getRowHeight(this.parent.getActiveSheet(), rowIndx) + \"px\";\n                this.setAutofit(rowIndx, false, prevHgt);\n            }\n        }\n    };\n    Resize.prototype.setTarget = function (e) {\n        var trgt = e.target;\n        var newTrgt;\n        var tOffsetV;\n        var eOffsetV;\n        var tClass;\n        if (closest(trgt, '.e-header-row')) {\n            eOffsetV = e.offsetX;\n            tOffsetV = trgt.offsetWidth;\n            tClass = 'e-colresize';\n            if (!isNullOrUndefined(trgt.previousElementSibling)) {\n                newTrgt = trgt.previousElementSibling;\n            }\n        }\n        else if (closest(trgt, '.e-row')) {\n            eOffsetV = e.offsetY;\n            tOffsetV = trgt.offsetHeight;\n            tClass = 'e-rowresize';\n            if (isNullOrUndefined(trgt.parentElement.previousElementSibling)) {\n                var idx = Number(trgt.parentElement.getAttribute('aria-rowindex'));\n                if (idx > 1) {\n                    newTrgt = trgt;\n                }\n            }\n            else {\n                newTrgt =\n                    trgt.parentElement.previousElementSibling.firstElementChild;\n            }\n        }\n        if (tOffsetV - 2 < 8 && eOffsetV !== Math.ceil((tOffsetV - 2) / 2)) {\n            if (eOffsetV < Math.ceil((tOffsetV - 2) / 2)) {\n                trgt.classList.add(tClass);\n                newTrgt.classList.add(tClass);\n            }\n            else if (eOffsetV > Math.ceil((tOffsetV - 2) / 2)) {\n                trgt.classList.add(tClass);\n            }\n        }\n        else if (tOffsetV - 5 < eOffsetV && eOffsetV <= tOffsetV && tOffsetV >= 10) {\n            trgt.classList.add(tClass);\n        }\n        else if (eOffsetV < 5 && newTrgt && tOffsetV >= 10) {\n            trgt.classList.add(tClass);\n            newTrgt.classList.add(tClass);\n        }\n        else {\n            var resEle = (tClass === 'e-colresize' ? trgt.parentElement.getElementsByClassName(tClass)\n                : this.parent.getRowHeaderTable().getElementsByClassName(tClass));\n            for (var index = 0; index < resEle.length; index++) {\n                resEle[index].classList.remove(tClass);\n            }\n        }\n    };\n    Resize.prototype.updateTarget = function (e, trgt) {\n        if (closest(trgt, '.e-header-row')) {\n            if ((trgt.offsetWidth < 10 && e.offsetX < Math.ceil((trgt.offsetWidth - 2) / 2)) || (e.offsetX < 5 &&\n                trgt.offsetWidth >= 10) && trgt.classList.contains('e-colresize') && trgt.previousElementSibling) {\n                this.trgtEle = trgt.previousElementSibling;\n            }\n        }\n        else {\n            if ((trgt.offsetHeight < 10 && e.offsetY < Math.ceil((trgt.offsetHeight - 2) / 2)) || (e.offsetY < 5 &&\n                trgt.offsetHeight >= 10) && trgt.classList.contains('e-rowresize')) {\n                var sheet = this.parent.getActiveSheet();\n                var prevIdx = Number(trgt.parentElement.getAttribute('aria-rowindex')) - 2;\n                if (trgt.parentElement.previousElementSibling || isHiddenRow(sheet, prevIdx)) {\n                    if (e.type === 'dblclick' && isHiddenRow(sheet, prevIdx) && trgt.parentElement.classList.contains('e-skip-resize')) {\n                        var selectRange = getSwapRange(getRangeIndexes(this.parent.getActiveSheet().selectedRange));\n                        var eventArgs = void 0;\n                        if (prevIdx <= selectRange[2] && prevIdx > selectRange[0]) {\n                            eventArgs = { startRow: selectRange[0], endRow: selectRange[2], hide: false, autoFit: true };\n                        }\n                        else {\n                            eventArgs = { startRow: prevIdx, endRow: prevIdx, hide: false, autoFit: true };\n                        }\n                        this.parent.notify(hideShowRow, eventArgs);\n                        trgt.parentElement.classList.remove('e-skip-resize');\n                    }\n                    else {\n                        if (!isHiddenRow(sheet, prevIdx)) {\n                            this.trgtEle = trgt.parentElement.previousElementSibling.getElementsByClassName('e-header-cell')[0];\n                        }\n                    }\n                }\n            }\n        }\n    };\n    Resize.prototype.setAutofit = function (idx, isCol, prevData) {\n        var index;\n        var oldIdx = idx;\n        if (this.parent.scrollSettings.enableVirtualization) {\n            idx = isCol ? idx - this.parent.viewport.leftIndex :\n                idx - this.parent.hiddenRowsCount(this.parent.viewport.topIndex, idx) - this.parent.viewport.topIndex;\n        }\n        var sheet = this.parent.getActiveSheet();\n        var mainContent = this.parent.getMainContent();\n        var oldValue = isCol ?\n            mainContent.getElementsByTagName('col')[idx].style.width : mainContent.getElementsByTagName('tr')[idx].style.height;\n        var headerTable = isCol ? this.parent.getColHeaderTable() : this.parent.getRowHeaderTable();\n        var contentRow = mainContent.getElementsByClassName('e-row');\n        var contentClone = [];\n        var contentTable = mainContent.getElementsByClassName('e-content-table')[0];\n        var headerRow = headerTable.getElementsByTagName('tr');\n        var headerText;\n        if (isCol) {\n            headerText = headerRow[0].getElementsByClassName('e-header-cell')[idx].cloneNode(true);\n            for (index = 0; index < contentRow.length; index++) {\n                contentClone[index] = contentRow[index].getElementsByTagName('td')[idx].cloneNode(true);\n            }\n        }\n        else {\n            headerText = headerRow[idx].getElementsByClassName('e-header-cell')[0].cloneNode(true);\n            for (index = 0; index < contentRow[idx].getElementsByTagName('td').length; index++) {\n                contentClone[index] = contentRow[idx].getElementsByTagName('td')[index].cloneNode(true);\n            }\n        }\n        var headerFit = findMaxValue(headerTable, [headerText], isCol, this.parent);\n        var contentFit = findMaxValue(contentTable, contentClone, isCol, this.parent);\n        var autofitValue = headerFit < contentFit ? contentFit : headerFit;\n        var threshold = parseInt(oldValue, 10) > autofitValue ?\n            -(parseInt(oldValue, 10) - autofitValue) : autofitValue - parseInt(oldValue, 10);\n        if (isCol) {\n            getColumn(sheet, oldIdx).width = autofitValue > 0 ? autofitValue : 0;\n            this.parent.notify(colWidthChanged, { threshold: threshold, colIdx: oldIdx });\n        }\n        else {\n            setRowHeight(sheet, oldIdx, autofitValue > 0 ? autofitValue : 0);\n            this.parent.notify(rowHeightChanged, { threshold: threshold, rowIdx: oldIdx });\n        }\n        this.resizeStart(oldIdx, idx, autofitValue + 'px', isCol, true, prevData);\n    };\n    Resize.prototype.createResizeHandler = function (trgt, className) {\n        var editor = this.parent.createElement('div', { className: className });\n        if (trgt.classList.contains('e-colresize')) {\n            editor.style.height = this.parent.getMainContent().clientHeight + trgt.offsetHeight + 'px';\n            editor.style.left = this.event.clientX - this.parent.element.getBoundingClientRect().left + 'px';\n            editor.style.top = '0px';\n        }\n        else if (trgt.classList.contains('e-rowresize')) {\n            editor.style.width = this.parent.getMainContent().clientWidth + trgt.offsetWidth + 'px';\n            editor.style.left = '0px';\n            editor.style.top = this.event.clientY\n                - this.parent.element.getElementsByClassName('e-sheet-panel')[0].getBoundingClientRect().top + 'px';\n        }\n        this.parent.element.getElementsByClassName('e-sheet-panel')[0].appendChild(editor);\n        this.updateCursor(this.event);\n    };\n    Resize.prototype.setColWidth = function (index, width, prevData) {\n        var sheet = this.parent.getActiveSheet();\n        var mIndex = index;\n        if (this.parent.scrollSettings.enableVirtualization) {\n            mIndex = mIndex + this.parent.viewport.leftIndex;\n        }\n        var eleWidth = parseInt(this.parent.getMainContent().getElementsByTagName('col')[index].style.width, 10);\n        var colWidth = width;\n        var threshold = parseInt(colWidth, 10) - eleWidth;\n        if (threshold < 0 && eleWidth < -(threshold)) {\n            threshold = -eleWidth;\n        }\n        var oldIdx = parseInt(this.trgtEle.getAttribute('aria-colindex'), 10) - 1;\n        this.parent.notify(colWidthChanged, { threshold: threshold, colIdx: oldIdx });\n        this.resizeStart(index, index, colWidth, true, false, prevData);\n        getColumn(sheet, mIndex).width = parseInt(colWidth, 10) > 0 ? parseInt(colWidth, 10) : 0;\n        sheet.columns[mIndex].customWidth = true;\n        this.parent.setProperties({ sheets: this.parent.sheets }, true);\n    };\n    Resize.prototype.setRowHeight = function (rowIdx, viewportIdx, height, prevData) {\n        var sheet = this.parent.getActiveSheet();\n        var eleHeight = parseInt(this.parent.getMainContent().getElementsByTagName('tr')[viewportIdx].style.height, 10);\n        var rowHeight = height;\n        var threshold = parseInt(rowHeight, 10) - eleHeight;\n        if (threshold < 0 && eleHeight < -(threshold)) {\n            threshold = -eleHeight;\n        }\n        this.parent.notify(rowHeightChanged, { threshold: threshold, rowIdx: rowIdx });\n        this.resizeStart(rowIdx, viewportIdx, rowHeight, false, false, prevData);\n        setRow(sheet, rowIdx, { height: parseInt(rowHeight, 10) > 0 ? parseInt(rowHeight, 10) : 0, customHeight: true });\n        this.parent.setProperties({ sheets: this.parent.sheets }, true);\n    };\n    Resize.prototype.resizeOn = function (e) {\n        var idx;\n        var actualIdx;\n        if (this.trgtEle.classList.contains('e-rowresize')) {\n            var sheet = this.parent.getActiveSheet();\n            var prevIdx = Number(this.trgtEle.parentElement.getAttribute('aria-rowindex')) - 2;\n            if (this.isMouseMoved && isHiddenRow(sheet, prevIdx) && this.trgtEle.parentElement.classList.contains('e-skip-resize') &&\n                e.clientY > this.trgtEle.getBoundingClientRect().top) {\n                this.trgtEle.parentElement.classList.remove('e-skip-resize');\n                var eventArgs = { startRow: prevIdx, endRow: prevIdx, hide: false, skipAppend: true };\n                this.parent.notify(hideShowRow, eventArgs);\n                var rTbody = this.parent.getRowHeaderTable().tBodies[0];\n                var tbody = this.parent.getContentTable().tBodies[0];\n                eventArgs.hdrRow.style.display = 'none';\n                eventArgs.row.style.display = 'none';\n                rTbody.insertBefore(eventArgs.hdrRow, rTbody.children[eventArgs.insertIdx]);\n                tbody.insertBefore(eventArgs.row, tbody.children[eventArgs.insertIdx]);\n                this.trgtEle = eventArgs.hdrRow.firstElementChild;\n                eventArgs.hdrRow.nextElementSibling.classList.remove('e-hide-end');\n            }\n            else {\n                if (this.trgtEle.parentElement.classList.contains('e-skip-resize')) {\n                    this.trgtEle.parentElement.classList.remove('e-skip-resize');\n                    return;\n                }\n            }\n            actualIdx = idx = parseInt(this.trgtEle.parentElement.getAttribute('aria-rowindex'), 10) - 1;\n            if (this.parent.scrollSettings.enableVirtualization) {\n                idx = idx - this.parent.hiddenRowsCount(this.parent.viewport.topIndex, idx) - this.parent.viewport.topIndex;\n            }\n            var prevData = this.parent.getMainContent().getElementsByClassName('e-row')[idx].style.height;\n            var rowHeight = e.clientY - this.event.clientY + parseInt(prevData, 10);\n            if (rowHeight <= 0) {\n                this.parent.showHideRow(true, actualIdx);\n                setRow(sheet, actualIdx, { height: 0, customHeight: true });\n                this.parent.setProperties({ sheets: this.parent.sheets }, true);\n                this.parent.notify(completeAction, { eventArgs: { index: actualIdx, height: '0px', isCol: false, sheetIdx: this.parent.activeSheetTab, oldHeight: prevData },\n                    action: 'resize' });\n                return;\n            }\n            this.setRowHeight(actualIdx, idx, rowHeight + \"px\", prevData);\n            if (this.trgtEle.parentElement.style.display === 'none') {\n                var sheet_1 = this.parent.getActiveSheet();\n                var selectedRange = getSwapRange(getRangeIndexes(sheet_1.selectedRange));\n                if (actualIdx <= selectedRange[2] && actualIdx > selectedRange[0]) {\n                    rowHeight = sheet_1.rows[actualIdx].height;\n                    var count = void 0;\n                    for (var i = selectedRange[0]; i <= selectedRange[2]; i++) {\n                        if (i === actualIdx) {\n                            continue;\n                        }\n                        prevData = getRowHeight(sheet_1, i) + \"px\";\n                        setRow(sheet_1, i, { customHeight: true, height: rowHeight });\n                        if (isHiddenRow(sheet_1, i)) {\n                            if (!count) {\n                                count = i;\n                            }\n                        }\n                        else {\n                            this.parent.getRow(i).style.height = rowHeight + \"px\";\n                            if (sheet_1.showHeaders) {\n                                this.parent.getRow(i, this.parent.getRowHeaderTable()).style.height = rowHeight + \"px\";\n                            }\n                        }\n                        this.parent.notify(completeAction, { eventArgs: { index: i, height: rowHeight + \"px\", isCol: false, sheetIdx: this.parent.activeSheetTab, oldHeight: prevData },\n                            action: 'resize' });\n                    }\n                    this.parent.setProperties({ sheets: this.parent.sheets }, true);\n                    this.parent.showHideRow(false, selectedRange[0], actualIdx - 1);\n                    idx += Math.abs(actualIdx - count);\n                }\n                else {\n                    if (idx !== 0 && !isHiddenRow(sheet_1, actualIdx - 1)) {\n                        this.trgtEle.parentElement.previousElementSibling.classList.remove('e-hide-start');\n                    }\n                    else {\n                        if (idx !== 0) {\n                            this.trgtEle.parentElement.classList.add('e-hide-end');\n                        }\n                    }\n                    this.parent.selectRange(sheet_1.selectedRange);\n                }\n                this.trgtEle.parentElement.style.display = '';\n                this.parent.getContentTable().rows[idx].style.display = '';\n            }\n        }\n        else if (this.trgtEle.classList.contains('e-colresize')) {\n            var mIndex = parseInt(this.trgtEle.getAttribute('aria-colindex'), 10) - 1;\n            idx = mIndex;\n            if (this.parent.scrollSettings.enableVirtualization) {\n                idx = idx - this.parent.viewport.leftIndex;\n            }\n            var colWidth = e.clientX - this.event.clientX +\n                parseInt(this.parent.getMainContent().getElementsByTagName('col')[idx].style.width, 10) + 'px';\n            this.setColWidth(idx, colWidth, this.parent.getMainContent().getElementsByTagName('col')[idx].style.width);\n        }\n    };\n    Resize.prototype.setWidthAndHeight = function (trgt, value, isCol) {\n        if (isCol) {\n            trgt.style.width = parseInt(trgt.style.width, 10) + value + 'px';\n        }\n        else {\n            trgt.style.height = parseInt(trgt.style.height, 10) + value + 'px';\n        }\n    };\n    Resize.prototype.resizeStart = function (idx, viewportIdx, value, isCol, isFit, prevData) {\n        setResize(viewportIdx, value, isCol, this.parent);\n        var action = isFit ? 'resizeToFit' : 'resize';\n        var eventArgs;\n        var isAction;\n        if (isCol) {\n            eventArgs = { index: idx, width: value, isCol: isCol, sheetIdx: this.parent.activeSheetTab, oldWidth: prevData };\n            isAction = prevData !== value;\n        }\n        else {\n            eventArgs = { index: idx, height: value, isCol: isCol, sheetIdx: this.parent.activeSheetTab, oldHeight: prevData };\n            isAction = prevData !== value;\n        }\n        if (isAction) {\n            this.parent.notify(completeAction, { eventArgs: eventArgs, action: action });\n        }\n    };\n    Resize.prototype.updateCursor = function (e) {\n        if (this.parent.element.getElementsByClassName('e-colresize-handler')[0]) {\n            this.parent.element.classList.add('e-col-resizing');\n        }\n        else if (this.parent.element.classList.contains('e-col-resizing')) {\n            this.parent.element.classList.remove('e-col-resizing');\n        }\n        if (this.parent.element.getElementsByClassName('e-rowresize-handler')[0]) {\n            this.parent.element.classList.add('e-row-resizing');\n        }\n        else if (this.parent.element.classList.contains('e-row-resizing')) {\n            this.parent.element.classList.remove('e-row-resizing');\n        }\n    };\n    /**\n     * To destroy the resize module.\n     * @return {void}\n     */\n    Resize.prototype.destroy = function () {\n        this.unwireEvents();\n        this.removeEventListener();\n        this.parent = null;\n    };\n    /**\n     * Get the module name.\n     * @returns string\n     */\n    Resize.prototype.getModuleName = function () {\n        return 'resize';\n    };\n    return Resize;\n}());\nexport { Resize };\n","import { collaborativeUpdate, updateAction } from '../common/index';\n/**\n * Collaborative Editing module for real time changes in the Spreadsheet.\n */\nvar CollaborativeEditing = /** @class */ (function () {\n    function CollaborativeEditing(parent) {\n        this.parent = parent;\n        this.addEventListener();\n    }\n    CollaborativeEditing.prototype.refreshClients = function (options) {\n        updateAction(options, this.parent);\n    };\n    CollaborativeEditing.prototype.addEventListener = function () {\n        this.parent.on(collaborativeUpdate, this.refreshClients, this);\n    };\n    CollaborativeEditing.prototype.removeEventListener = function () {\n        if (!this.parent.isDestroyed) {\n            this.parent.off(collaborativeUpdate, this.refreshClients);\n        }\n    };\n    /**\n     * Destroy collaborative editing module.\n     */\n    CollaborativeEditing.prototype.destroy = function () {\n        this.removeEventListener();\n        this.parent = null;\n    };\n    /**\n     * Get the collaborative editing module name.\n     */\n    CollaborativeEditing.prototype.getModuleName = function () {\n        return 'collaborativeEditing';\n    };\n    return CollaborativeEditing;\n}());\nexport { CollaborativeEditing };\n","import { spreadsheetDestroyed, hideShowCol, hideShowRow } from '../common/index';\nimport { autoFit } from '../common/index';\nimport { getCellAddress, isHiddenRow, setRow } from '../../workbook/index';\nimport { detach } from '@syncfusion/ej2-base';\n/**\n * The `ShowHide` module is used to perform hide/show the rows and columns.\n * @hidden\n */\nvar ShowHide = /** @class */ (function () {\n    /**\n     * Constructor for the Spreadsheet show hide module.\n     * @private\n     */\n    function ShowHide(parent) {\n        this.parent = parent;\n        this.addEventListener();\n    }\n    // tslint:disable-next-line\n    ShowHide.prototype.showHideRow = function (args) {\n        var sheet = this.parent.getActiveSheet();\n        var count = 0;\n        var idx;\n        if (args.hide) {\n            var content = void 0;\n            var rowHdr = void 0;\n            var row = void 0;\n            for (var i = args.startRow; i <= args.endRow; i++) {\n                if (isHiddenRow(sheet, i)) {\n                    continue;\n                }\n                if (idx === undefined) {\n                    if (sheet.showHeaders) {\n                        rowHdr = this.parent.getRowHeaderTable();\n                    }\n                    content = this.parent.getContentTable();\n                    idx = this.getViewportIdx(i);\n                    count = 0;\n                }\n                setRow(sheet, i, { hidden: true });\n                row = content.rows[idx];\n                if (row) {\n                    if (sheet.showHeaders) {\n                        detach(rowHdr.rows[idx]);\n                    }\n                    detach(row);\n                    count++;\n                }\n                else {\n                    count--;\n                }\n            }\n            if (!count) {\n                return;\n            }\n            this.parent.selectRange(sheet.selectedRange);\n            if (this.parent.viewport.topIndex >= args.startRow) {\n                this.parent.viewport.topIndex = args.endRow + 1;\n            }\n            if (this.parent.scrollSettings.enableVirtualization) {\n                args.startRow = this.parent.viewport.bottomIndex + 1;\n                args.endRow = args.startRow + count - 1;\n                var indexes = this.parent.skipHiddenRows(args.startRow, args.endRow);\n                args.startRow = indexes[0];\n                args.endRow = indexes[1];\n                this.parent.viewport.bottomIndex = args.endRow;\n                this.parent.renderModule.refreshUI({ colIndex: this.parent.viewport.leftIndex, direction: '', refresh: 'RowPart' }, getCellAddress(args.startRow, this.parent.viewport.leftIndex) + \":\" + getCellAddress(args.endRow, this.parent.viewport.leftIndex + this.parent.viewport.colCount + (this.parent.getThreshold('col') * 2)));\n            }\n            if (sheet.showHeaders) {\n                if (idx === 0) {\n                    rowHdr.rows[0].classList.add('e-hide-end');\n                }\n                else {\n                    rowHdr.rows[idx - 1].classList.add('e-hide-start');\n                    rowHdr.rows[idx].classList.add('e-hide-end');\n                }\n            }\n        }\n        else {\n            var hFrag = void 0;\n            var frag = void 0;\n            var hRow = void 0;\n            var rowRenderer = void 0;\n            var rTBody = void 0;\n            var tBody = void 0;\n            var endRow = args.startRow - 1;\n            var newStartRow = void 0;\n            for (var i = args.startRow, len = args.endRow; i <= len; i++) {\n                if (!isHiddenRow(sheet, i)) {\n                    if (args.startRow === args.endRow) {\n                        return;\n                    }\n                    if (idx === undefined) {\n                        endRow++;\n                    }\n                    else {\n                        newStartRow = i;\n                    }\n                    continue;\n                }\n                if (newStartRow !== undefined) {\n                    len = i;\n                    continue;\n                }\n                if (i > this.parent.viewport.bottomIndex) {\n                    setRow(sheet, i, { hidden: false });\n                    continue;\n                }\n                setRow(sheet, i, { hidden: false });\n                if (idx === undefined) {\n                    hFrag = document.createDocumentFragment();\n                    frag = document.createDocumentFragment();\n                    rowRenderer = this.parent.serviceLocator.getService('row');\n                    if (sheet.showHeaders) {\n                        rTBody = this.parent.getRowHeaderTable().tBodies[0];\n                    }\n                    tBody = this.parent.getContentTable().tBodies[0];\n                    if (i < this.parent.viewport.topIndex) {\n                        this.parent.viewport.topIndex = i;\n                    }\n                    if (i === 0) {\n                        idx = 0;\n                    }\n                    else {\n                        idx = this.getViewportIdx(i);\n                    }\n                }\n                endRow++;\n                hRow = rowRenderer.refresh(i);\n                hFrag.appendChild(hRow);\n                frag.appendChild(rowRenderer.refresh(i, hRow));\n                if (sheet.showHeaders) {\n                    detach(rTBody.lastElementChild);\n                }\n                detach(tBody.lastElementChild);\n            }\n            this.parent.viewport.bottomIndex = this.parent.viewport.topIndex + this.parent.viewport.rowCount +\n                (this.parent.getThreshold('row') * 2);\n            count = this.parent.hiddenRowsCount(this.parent.viewport.topIndex, args.startRow) +\n                this.parent.hiddenRowsCount(args.endRow + 1, this.parent.viewport.bottomIndex);\n            this.parent.viewport.bottomIndex += count;\n            args.insertIdx = idx;\n            args.row = frag.querySelector('.e-row');\n            if (sheet.showHeaders) {\n                args.hdrRow = hFrag.querySelector('.e-row');\n                if (idx !== 0 && !isHiddenRow(sheet, endRow - 1)) {\n                    rTBody.children[idx - 1].classList.remove('e-hide-start');\n                }\n                if (args.startRow !== 0 && isHiddenRow(sheet, args.startRow - 1)) {\n                    args.hdrRow.classList.add('e-hide-end');\n                }\n                if (isHiddenRow(sheet, endRow + 1)) {\n                    hFrag.lastElementChild.classList.add('e-hide-start');\n                }\n                else {\n                    rTBody.children[idx].classList.remove('e-hide-end');\n                }\n            }\n            if (args.skipAppend) {\n                return;\n            }\n            if (sheet.showHeaders) {\n                rTBody.insertBefore(hFrag, rTBody.children[idx]);\n            }\n            tBody.insertBefore(frag, tBody.children[idx]);\n            this.parent.selectRange(sheet.selectedRange);\n            if (args.autoFit && sheet.showHeaders) {\n                this.parent.notify(autoFit, { startIndex: args.startRow, endIndex: args.endRow, isRow: true });\n            }\n            if (newStartRow !== undefined && newStartRow !== args.endRow) {\n                args.startRow = newStartRow;\n                this.showHideRow(args);\n            }\n        }\n    };\n    ShowHide.prototype.showHideCol = function () {\n        /** */\n    };\n    ShowHide.prototype.getViewportIdx = function (index) {\n        if (this.parent.scrollSettings.enableVirtualization) {\n            index -= this.parent.hiddenRowsCount(this.parent.viewport.topIndex, index);\n            index -= this.parent.viewport.topIndex;\n        }\n        return index;\n    };\n    ShowHide.prototype.addEventListener = function () {\n        this.parent.on(hideShowRow, this.showHideRow, this);\n        this.parent.on(hideShowCol, this.showHideCol, this);\n        this.parent.on(spreadsheetDestroyed, this.destroy, this);\n    };\n    ShowHide.prototype.destroy = function () {\n        this.removeEventListener();\n        this.parent = null;\n    };\n    ShowHide.prototype.removeEventListener = function () {\n        this.parent.off(hideShowRow, this.showHideRow);\n        this.parent.off(hideShowCol, this.showHideCol);\n        this.parent.off(spreadsheetDestroyed, this.destroy);\n    };\n    return ShowHide;\n}());\nexport { ShowHide };\n","import { initiateHyperlink, locale, dialog, click, getUpdateUsingRaf, keyUp, createHyperlinkElement } from '../common/index';\nimport { editHyperlink, removeHyperlink, openHyperlink } from '../common/index';\nimport { isNullOrUndefined, closest } from '@syncfusion/ej2-base';\nimport { getRangeIndexes, getRangeAddress, getCellIndexes } from '../../workbook/common/address';\nimport { beforeHyperlinkClick, afterHyperlinkClick } from '../../workbook/common/event';\nimport { Tab, TreeView } from '@syncfusion/ej2-navigations';\n/**\n * `Hyperlink` module\n */\nvar SpreadsheetHyperlink = /** @class */ (function () {\n    /**\n     * Constructor for Hyperlink module.\n     */\n    function SpreadsheetHyperlink(parent) {\n        this.parent = parent;\n        this.addEventListener();\n    }\n    /**\n     * To destroy the Hyperlink module.\n     * @return {void}\n     */\n    SpreadsheetHyperlink.prototype.destroy = function () {\n        this.removeEventListener();\n        this.parent = null;\n    };\n    SpreadsheetHyperlink.prototype.addEventListener = function () {\n        this.parent.on(initiateHyperlink, this.initiateHyperlinkHandler, this);\n        this.parent.on(editHyperlink, this.editHyperlinkHandler, this);\n        this.parent.on(removeHyperlink, this.removeHyperlinkHandler, this);\n        this.parent.on(openHyperlink, this.openHyperlinkHandler, this);\n        this.parent.on(click, this.clickHandler, this);\n        this.parent.on(createHyperlinkElement, this.createHyperlinkElementHandler, this);\n        this.parent.on(keyUp, this.keyUpHandler, this);\n    };\n    SpreadsheetHyperlink.prototype.removeEventListener = function () {\n        if (!this.parent.isDestroyed) {\n            this.parent.off(initiateHyperlink, this.initiateHyperlinkHandler);\n            this.parent.off(editHyperlink, this.editHyperlinkHandler);\n            this.parent.off(removeHyperlink, this.removeHyperlinkHandler);\n            this.parent.off(openHyperlink, this.openHyperlinkHandler);\n            this.parent.off(click, this.clickHandler);\n            this.parent.off(createHyperlinkElement, this.createHyperlinkElementHandler);\n            this.parent.off(keyUp, this.keyUpHandler);\n        }\n    };\n    /**\n     * Gets the module name.\n     * @returns string\n     */\n    SpreadsheetHyperlink.prototype.getModuleName = function () {\n        return 'spreadsheetHyperlink';\n    };\n    SpreadsheetHyperlink.prototype.keyUpHandler = function (e) {\n        var trgt = e.target;\n        if (trgt.classList.contains('e-text') && closest(trgt, '.e-cont')) {\n            if (closest(trgt, '.e-webpage') && closest(trgt, '.e-webpage').getElementsByClassName('e-cont')[1] === trgt.parentElement) {\n                var dlgEle = closest(trgt, '.e-hyperlink-dlg') || closest(trgt, '.e-edithyperlink-dlg');\n                var ftrEle = dlgEle.getElementsByClassName('e-footer-content')[0];\n                var insertBut = ftrEle.firstChild;\n                if (trgt.value !== '') {\n                    insertBut.removeAttribute('disabled');\n                }\n                else {\n                    var linkDialog = closest(trgt, '.e-link-dialog');\n                    var webPage = linkDialog.querySelector('.e-webpage');\n                    var isUrl = webPage.querySelectorAll('.e-cont')[1].querySelector('.e-text').value ? true : false;\n                    if (!isUrl) {\n                        insertBut.setAttribute('disabled', 'true');\n                    }\n                }\n            }\n        }\n    };\n    SpreadsheetHyperlink.prototype.initiateHyperlinkHandler = function () {\n        var _this = this;\n        var l10n = this.parent.serviceLocator.getService(locale);\n        if (!this.parent.element.querySelector('.e-dlg-container')) {\n            var dialogInst_1 = this.parent.serviceLocator.getService(dialog);\n            dialogInst_1.show({\n                width: 323, isModal: true, showCloseIcon: true, cssClass: 'e-hyperlink-dlg',\n                header: l10n.getConstant('InsertLink'),\n                beforeOpen: function () {\n                    dialogInst_1.dialogInstance.content = _this.hyperlinkContent();\n                    dialogInst_1.dialogInstance.dataBind();\n                    _this.parent.element.focus();\n                },\n                buttons: [{\n                        buttonModel: {\n                            content: l10n.getConstant('Insert'), isPrimary: true, disabled: true\n                        },\n                        click: function () {\n                            _this.dlgClickHandler(dialogInst_1);\n                            dialogInst_1.hide();\n                        }\n                    }]\n            });\n        }\n    };\n    SpreadsheetHyperlink.prototype.dlgClickHandler = function (dialogInst) {\n        var value;\n        var address;\n        var spreadsheetInst = this.parent;\n        var item = this.parent.element.querySelector('.e-link-dialog').\n            getElementsByClassName('e-content')[0].querySelector('.e-item.e-active');\n        if (item) {\n            if (item.querySelector('.e-webpage')) {\n                value = item.getElementsByClassName('e-cont')[0].querySelector('.e-text').value;\n                address = item.getElementsByClassName('e-cont')[1].querySelector('.e-text').value;\n                var args = { address: address };\n                this.parent.insertHyperlink(args, this.parent.getActiveSheet().activeCell, value, false);\n            }\n            else {\n                value = item.getElementsByClassName('e-cont')[0].querySelector('.e-text').value;\n                address = item.getElementsByClassName('e-cont')[1].querySelector('.e-text').value;\n                var sheetIdx = void 0;\n                var dlgContent = item.getElementsByClassName('e-cont')[2];\n                if (dlgContent.getElementsByClassName('e-list-item')[0].querySelector('.e-active')) {\n                    var sheetName = item.getElementsByClassName('e-cont')[2].querySelector('.e-active').textContent;\n                    var sheets = spreadsheetInst.sheets;\n                    for (var idx = 0; idx < sheets.length; idx++) {\n                        if (sheets[idx].name === sheetName) {\n                            sheetIdx = idx + 1;\n                        }\n                    }\n                    address = sheetName + '!' + address;\n                    var args = { address: address };\n                    this.parent.insertHyperlink(args, this.parent.getActiveSheet().activeCell, value, false);\n                }\n                else if (dlgContent.querySelector('.e-active')) {\n                    var definedName = item.getElementsByClassName('e-cont')[2].querySelector('.e-active').textContent;\n                    for (var idx = 0; idx < this.parent.definedNames.length; idx++) {\n                        if (this.parent.definedNames[idx].name === definedName) {\n                            var args = {\n                                address: this.parent.definedNames[idx].name,\n                            };\n                            this.parent.insertHyperlink(args, this.parent.getActiveSheet().activeCell, value, false);\n                        }\n                    }\n                }\n            }\n        }\n    };\n    SpreadsheetHyperlink.prototype.editHyperlinkHandler = function () {\n        var _this = this;\n        var isWeb = true;\n        var l10n = this.parent.serviceLocator.getService(locale);\n        var dialogInst = this.parent.serviceLocator.getService(dialog);\n        dialogInst.show({\n            width: 323, isModal: true, showCloseIcon: true, cssClass: 'e-edithyperlink-dlg',\n            header: l10n.getConstant('EditLink'),\n            beforeOpen: function () {\n                dialogInst.dialogInstance.content = _this.hyperEditContent();\n                dialogInst.dialogInstance.dataBind();\n                _this.parent.element.focus();\n            },\n            buttons: [{\n                    buttonModel: {\n                        content: l10n.getConstant('Update'), isPrimary: true\n                    },\n                    click: function () {\n                        _this.dlgClickHandler(dialogInst);\n                        dialogInst.hide();\n                    }\n                }]\n        });\n    };\n    SpreadsheetHyperlink.prototype.openHyperlinkHandler = function () {\n        var cellIndexes = getCellIndexes(this.parent.getActiveSheet().activeCell);\n        var trgt = this.parent.getCell(cellIndexes[0], cellIndexes[1]);\n        if (trgt.getElementsByClassName('e-hyperlink')[0]) {\n            trgt = trgt.querySelector('.e-hyperlink');\n        }\n        this.hlOpenHandler(trgt);\n    };\n    SpreadsheetHyperlink.prototype.removeHyperlinkHandler = function (cell) {\n        this.parent.removeHyperlink(cell);\n    };\n    SpreadsheetHyperlink.prototype.hlOpenHandler = function (trgt) {\n        var _this = this;\n        if (trgt.classList.contains('e-hyperlink')) {\n            var range = ['', ''];\n            trgt.style.color = '#551A8B';\n            var sheet = this.parent.getActiveSheet();\n            var colIdx = parseInt(trgt.parentElement.getAttribute('aria-colindex'), 10) - 1;\n            var rowIdx = parseInt(trgt.parentElement.parentElement.getAttribute('aria-rowindex'), 10) - 1;\n            var rangeAddr = sheet.rows[rowIdx].cells[colIdx].hyperlink;\n            var address = void 0;\n            var befArgs = void 0;\n            var aftArgs = void 0;\n            befArgs = { hyperlink: rangeAddr, cell: this.parent.getActiveSheet().activeCell, cancel: false };\n            aftArgs = { hyperlink: rangeAddr, cell: this.parent.getActiveSheet().activeCell };\n            this.parent.trigger(beforeHyperlinkClick, befArgs);\n            if (befArgs.cancel) {\n                return;\n            }\n            rangeAddr = befArgs.hyperlink;\n            if (typeof (rangeAddr) === 'string') {\n                address = rangeAddr;\n            }\n            if (typeof (rangeAddr) === 'object') {\n                address = rangeAddr.address;\n            }\n            if (address.indexOf('http://') > -1 || address.indexOf('www.') > -1) {\n                address = (address.indexOf('http://') === -1) ? 'http://' + address : address;\n                window.open(address);\n            }\n            else if (address.indexOf('www.') === -1) {\n                if (!isNullOrUndefined(address)) {\n                    if (this.parent.definedNames) {\n                        for (var idx = 0; idx < this.parent.definedNames.length; idx++) {\n                            if (this.parent.definedNames[idx].name === address) {\n                                address = this.parent.definedNames[idx].refersTo;\n                                address = address.slice(1);\n                                break;\n                            }\n                        }\n                    }\n                    if (address.indexOf('!') !== -1) {\n                        range = address.split('!');\n                    }\n                    else {\n                        range[0] = this.parent.getActiveSheet().name;\n                        range[1] = address;\n                    }\n                    var sheetIdx = void 0;\n                    for (var idx = 0; idx < this.parent.sheets.length; idx++) {\n                        if (this.parent.sheets[idx].name === range[0]) {\n                            sheetIdx = idx;\n                        }\n                    }\n                    var rangeIndexes = getRangeIndexes(range[1]);\n                    if (this.parent.scrollSettings.enableVirtualization) {\n                        rangeIndexes[0] = rangeIndexes[0] >= this.parent.viewport.topIndex ?\n                            rangeIndexes[0] - this.parent.viewport.topIndex : rangeIndexes[0];\n                        rangeIndexes[1] = rangeIndexes[1] >= this.parent.viewport.leftIndex ?\n                            rangeIndexes[1] - this.parent.viewport.leftIndex : rangeIndexes[1];\n                    }\n                    sheet = this.parent.sheets[sheetIdx];\n                    if (!isNullOrUndefined(sheet)) {\n                        if (sheet === this.parent.getActiveSheet()) {\n                            this.parent.selectRange(getRangeAddress(rangeIndexes));\n                        }\n                        else {\n                            sheet.selectedRange = range[1];\n                            this.parent.activeSheetTab = sheetIdx + 1;\n                            this.parent.dataBind();\n                        }\n                        if (this.parent.scrollSettings.enableVirtualization) {\n                            rangeIndexes[0] =\n                                rangeIndexes[0] >= this.parent.viewport.rowCount ? rangeIndexes[0] - this.parent.viewport.rowCount : 0;\n                            rangeIndexes[2] =\n                                rangeIndexes[2] >= this.parent.viewport.rowCount ? rangeIndexes[2] - this.parent.viewport.rowCount : 0;\n                            rangeIndexes[1] =\n                                rangeIndexes[1] >= this.parent.viewport.colCount ? rangeIndexes[1] - this.parent.viewport.colCount : 0;\n                            rangeIndexes[3] =\n                                rangeIndexes[3] >= this.parent.viewport.colCount ? rangeIndexes[3] - this.parent.viewport.colCount : 0;\n                        }\n                        var rangeAddr_1 = getRangeAddress(rangeIndexes);\n                        getUpdateUsingRaf(function () { _this.parent.goTo(rangeAddr_1); });\n                    }\n                }\n            }\n            this.parent.trigger(afterHyperlinkClick, aftArgs);\n        }\n    };\n    SpreadsheetHyperlink.prototype.clickHandler = function (e) {\n        var trgt = e.target;\n        if (closest(trgt, '.e-dlg-content') && closest(trgt, '.e-toolbar-item')) {\n            var dlgEle = closest(trgt, '.e-hyperlink-dlg') || closest(trgt, '.e-edithyperlink-dlg');\n            var ftrEle = dlgEle.getElementsByClassName('e-footer-content')[0];\n            var insertBut = ftrEle.firstChild;\n            var docEle = dlgEle.querySelector('.e-document');\n            var webEle = dlgEle.querySelector('.e-webpage');\n            var webEleText = webEle ? webEle.querySelectorAll('.e-cont')[0].querySelector('.e-text').value :\n                docEle.querySelectorAll('.e-cont')[0].querySelector('.e-text').value;\n            var docEleText = docEle ? docEle.querySelectorAll('.e-cont')[0].querySelector('.e-text').value :\n                webEleText;\n            var toolbarItems = closest(trgt, '.e-toolbar-items');\n            if (toolbarItems.getElementsByClassName('e-toolbar-item')[1].classList.contains('e-active')) {\n                var actEle = docEle.querySelectorAll('.e-cont')[2].querySelector('.e-active');\n                docEle.querySelectorAll('.e-cont')[0].querySelector('.e-text').value = webEleText;\n                if (closest(actEle, '.e-list-item').classList.contains('e-level-2') && insertBut.hasAttribute('disabled')) {\n                    insertBut.removeAttribute('disabled');\n                }\n                else if (closest(actEle, '.e-list-item').classList.contains('e-level-1') && !insertBut.hasAttribute('disabled')) {\n                    insertBut.setAttribute('disabled', 'true');\n                }\n            }\n            else {\n                var isEmpty = webEle.querySelectorAll('.e-cont')[1].querySelector('.e-text').value ? false : true;\n                webEle.querySelectorAll('.e-cont')[0].querySelector('.e-text').value = docEleText;\n                if (isEmpty && !insertBut.hasAttribute('disabled')) {\n                    insertBut.setAttribute('disabled', 'true');\n                }\n                else if (!isEmpty && insertBut.hasAttribute('disabled')) {\n                    insertBut.removeAttribute('disabled');\n                }\n            }\n        }\n        if (closest(trgt, '.e-list-item') && trgt.classList.contains('e-fullrow')) {\n            var item = this.parent.element.getElementsByClassName('e-link-dialog')[0].\n                getElementsByClassName('e-content')[0].getElementsByClassName('e-active')[0];\n            var cellRef = item.getElementsByClassName('e-cont')[1].getElementsByClassName('e-text')[0];\n            var dlgEle = closest(trgt, '.e-hyperlink-dlg') || closest(trgt, '.e-edithyperlink-dlg');\n            var ftrEle = dlgEle.getElementsByClassName('e-footer-content')[0];\n            var insertBut = ftrEle.firstChild;\n            if (closest(trgt, '.e-list-item').classList.contains('e-level-2')) {\n                if (closest(trgt, '.e-list-item').getAttribute('data-uid') === 'defName') {\n                    if (!cellRef.classList.contains('e-disabled') && !cellRef.hasAttribute('readonly')) {\n                        cellRef.setAttribute('readonly', 'true');\n                        cellRef.classList.add('e-disabled');\n                        cellRef.setAttribute('disabled', 'true');\n                    }\n                }\n                else if (closest(trgt, '.e-list-item').getAttribute('data-uid') === 'sheet') {\n                    if (cellRef.classList.contains('e-disabled') && cellRef.hasAttribute('readonly')) {\n                        cellRef.removeAttribute('readonly');\n                        cellRef.classList.remove('e-disabled');\n                        cellRef.removeAttribute('disabled');\n                    }\n                }\n                if (insertBut.hasAttribute('disabled')) {\n                    insertBut.removeAttribute('disabled');\n                }\n            }\n            else if (closest(trgt, '.e-list-item').classList.contains('e-level-1')) {\n                insertBut.setAttribute('disabled', 'true');\n            }\n        }\n        else {\n            this.hlOpenHandler(trgt);\n        }\n    };\n    SpreadsheetHyperlink.prototype.createHyperlinkElementHandler = function (args) {\n        var cell = args.cell;\n        var td = args.td;\n        var rowIdx = args.rowIdx;\n        var colIdx = args.colIdx;\n        var hyperEle = this.parent.createElement('a', { className: 'e-hyperlink' });\n        if (!isNullOrUndefined(cell.hyperlink)) {\n            var hyperlink = cell.hyperlink;\n            if (typeof (hyperlink) === 'string') {\n                if (hyperlink.indexOf('http://') === -1 && hyperlink.indexOf('www.') !== -1) {\n                    hyperlink = 'http://' + hyperlink;\n                }\n                if (hyperlink.indexOf('www.') !== -1) {\n                    hyperEle.setAttribute('href', hyperlink);\n                    hyperEle.setAttribute('target', '_blank');\n                }\n                else if (hyperlink.includes('=') || hyperlink.includes('!')) {\n                    hyperEle.setAttribute('ref', hyperlink);\n                }\n                hyperEle.innerText = td.innerText !== '' ? td.innerText : hyperlink;\n                td.textContent = '';\n                td.innerText = '';\n                td.appendChild(hyperEle);\n            }\n            else if (typeof (hyperlink) === 'object') {\n                if (hyperlink.address.indexOf('http://') === -1 && hyperlink.address.indexOf('www.') !== -1) {\n                    hyperlink.address = 'http://' + hyperlink.address;\n                }\n                if (hyperlink.address.indexOf('www') !== -1) {\n                    hyperEle.setAttribute('href', hyperlink.address);\n                    hyperEle.setAttribute('target', '_blank');\n                }\n                else if (hyperlink.address.includes('=') || hyperlink.address.includes('!')) {\n                    hyperEle.setAttribute('ref', hyperlink.address);\n                }\n                hyperEle.innerText = td.innerText !== '' ? td.innerText : hyperlink.address;\n                td.textContent = '';\n                td.innerText = '';\n                td.appendChild(hyperEle);\n            }\n        }\n    };\n    SpreadsheetHyperlink.prototype.hyperEditContent = function () {\n        var isWeb = true;\n        var dialog = this.hyperlinkContent();\n        var indexes = getRangeIndexes(this.parent.getActiveSheet().activeCell);\n        var cell = this.parent.sheets[this.parent.getActiveSheet().id - 1].rows[indexes[0]].cells[indexes[1]];\n        if (this.parent.scrollSettings.enableVirtualization) {\n            indexes[0] = indexes[0] - this.parent.viewport.topIndex;\n            indexes[1] = indexes[1] - this.parent.viewport.leftIndex;\n        }\n        var td = this.parent.getMainContent().getElementsByClassName('e-row')[indexes[0]].getElementsByClassName('e-cell')[indexes[1]];\n        var hyperlinkEle = td.getElementsByClassName('e-hyperlink')[0];\n        var value = this.parent.getDisplayText(cell);\n        var address;\n        var hyperlink = cell.hyperlink;\n        if (typeof (hyperlink) === 'string') {\n            address = hyperlink;\n            value = value || address;\n            if (address.indexOf('www.') === -1) {\n                isWeb = false;\n            }\n        }\n        else if (typeof (hyperlink) === 'object') {\n            address = hyperlink.address;\n            value = value || address;\n            if (address.indexOf('www.') === -1) {\n                isWeb = false;\n            }\n        }\n        var item = dialog.querySelector('.e-content');\n        if (isWeb) {\n            var webContElem = item.querySelector('.e-webpage');\n            webContElem.getElementsByClassName('e-cont')[0].getElementsByClassName('e-text')[0].setAttribute('value', value);\n            if (typeof (hyperlink) === 'string') {\n                webContElem.getElementsByClassName('e-cont')[1].querySelector('.e-text').innerHTML = hyperlink;\n            }\n            else {\n                var address_1;\n                address_1 = webContElem.getElementsByClassName('e-cont')[1].querySelector('.e-text');\n                address_1.setAttribute('value', hyperlink.address);\n            }\n        }\n        else {\n            var isDefinedNamed = void 0;\n            var docContElem = item.querySelector('.e-document');\n            docContElem.getElementsByClassName('e-cont')[0].getElementsByClassName('e-text')[0].setAttribute('value', value);\n            var rangeArr = void 0;\n            var sheet = this.parent.getActiveSheet();\n            var sheetIdx = void 0;\n            if (this.parent.definedNames) {\n                for (var idx = 0; idx < this.parent.definedNames.length; idx++) {\n                    if (this.parent.definedNames[idx].name === address) {\n                        isDefinedNamed = true;\n                        break;\n                    }\n                }\n            }\n            if (isDefinedNamed) {\n                var cellRef = void 0;\n                cellRef = docContElem.getElementsByClassName('e-cont')[1].getElementsByClassName('e-text')[0];\n                cellRef.setAttribute('readonly', 'true');\n                cellRef.classList.add('e-disabled');\n                cellRef.setAttribute('disabled', 'true');\n                var treeCont = docContElem.getElementsByClassName('e-cont')[2];\n                var listEle = treeCont.querySelectorAll('.e-list-item.e-level-1')[1];\n                for (var idx = 0; idx < listEle.getElementsByTagName('li').length; idx++) {\n                    if (listEle.getElementsByTagName('li')[idx].innerText === address) {\n                        listEle.getElementsByTagName('li')[idx].classList.add('e-active');\n                    }\n                }\n            }\n            else {\n                if (address && address.indexOf('!') !== -1) {\n                    rangeArr = address.split('!');\n                    sheetIdx = parseInt(rangeArr[0].replace(/\\D/g, ''), 10) - 1;\n                    sheet = this.parent.sheets[sheetIdx];\n                }\n                var sheetName = rangeArr[0];\n                docContElem.getElementsByClassName('e-cont')[1].querySelector('.e-text').setAttribute('value', rangeArr[1]);\n                var treeCont = docContElem.getElementsByClassName('e-cont')[2];\n                var listEle = treeCont.querySelectorAll('.e-list-item.e-level-1')[0];\n                for (var idx = 0; idx < listEle.getElementsByTagName('li').length; idx++) {\n                    if (listEle.getElementsByTagName('li')[idx].innerText === sheetName) {\n                        if (listEle.getElementsByTagName('li')[idx].classList.contains('e-active')) {\n                            break;\n                        }\n                        else {\n                            listEle.getElementsByTagName('li')[idx].classList.add('e-active');\n                        }\n                    }\n                    else {\n                        if (listEle.getElementsByTagName('li')[idx].classList.contains('e-active')) {\n                            listEle.getElementsByTagName('li')[idx].classList.remove('e-active');\n                        }\n                    }\n                }\n            }\n        }\n        return dialog;\n    };\n    // tslint:disable-next-line:max-func-body-length\n    SpreadsheetHyperlink.prototype.hyperlinkContent = function () {\n        var idx = 0;\n        var selIdx = 0;\n        var isWeb = true;\n        var isDefinedName;\n        var isCellRef = true;\n        var address;\n        var indexes = getRangeIndexes(this.parent.getActiveSheet().activeCell);\n        var sheet = this.parent.getActiveSheet();\n        var cell = this.parent.sheets[this.parent.getActiveSheet().id - 1].rows[indexes[0]].cells[indexes[1]];\n        var isEnable = true;\n        if (sheet.rows[indexes[0]] && sheet.rows[indexes[0]].cells[indexes[1]]) {\n            var cell_1 = sheet.rows[indexes[0]].cells[indexes[1]];\n            if ((cell_1.value && typeof (cell_1.value) === 'string' && cell_1.value.match('[A-Za-z]+') !== null) ||\n                cell_1.value === '' || isNullOrUndefined(cell_1.value)) {\n                isEnable = true;\n            }\n            else {\n                isEnable = false;\n            }\n            var hyperlink = cell_1.hyperlink;\n            if (typeof (hyperlink) === 'string') {\n                if (hyperlink.indexOf('www.') === -1) {\n                    address = hyperlink;\n                    isWeb = false;\n                }\n            }\n            else if (typeof (hyperlink) === 'object') {\n                if (hyperlink.address.indexOf('www.') === -1) {\n                    address = hyperlink.address;\n                    isWeb = false;\n                }\n            }\n            if (isWeb) {\n                selIdx = 0;\n            }\n            else {\n                selIdx = 1;\n            }\n            if (this.parent.definedNames) {\n                for (var idx_1 = 0; idx_1 < this.parent.definedNames.length; idx_1++) {\n                    if (this.parent.definedNames[idx_1].name === address) {\n                        isDefinedName = true;\n                        isCellRef = false;\n                        break;\n                    }\n                }\n            }\n        }\n        var dialogElem = this.parent.createElement('div', { className: 'e-link-dialog' });\n        var webContElem = this.parent.createElement('div', { className: 'e-webpage' });\n        var docContElem = this.parent.createElement('div', { className: 'e-document' });\n        var headerTabs = new Tab({\n            selectedItem: selIdx,\n            items: [\n                {\n                    header: { 'text': 'WEB PAGE' },\n                    content: webContElem\n                },\n                {\n                    header: { 'text': 'THIS DOCUMENT' },\n                    content: docContElem\n                },\n            ]\n        });\n        headerTabs.appendTo(dialogElem);\n        var textCont = this.parent.createElement('div', { className: 'e-cont' });\n        var urlCont = this.parent.createElement('div', { className: 'e-cont' });\n        var textH = this.parent.createElement('div', { className: 'e-header', innerHTML: 'Display Text' });\n        var urlH = this.parent.createElement('div', { className: 'e-header', innerHTML: 'URL' });\n        var textInput = this.parent.createElement('input', { className: 'e-input e-text', attrs: { 'type': 'Text' }, });\n        if (!isEnable) {\n            textInput.classList.add('e-disabled');\n            textInput.setAttribute('readonly', 'true');\n            textInput.setAttribute('disabled', 'true');\n        }\n        if (cell && isNullOrUndefined(cell.hyperlink)) {\n            textInput.setAttribute('value', this.parent.getDisplayText(cell));\n        }\n        var urlInput = this.parent.createElement('input', { className: 'e-input e-text', attrs: { 'type': 'Text' } });\n        textInput.setAttribute('placeholder', 'Enter the text to display');\n        urlInput.setAttribute('placeholder', 'Enter the URL');\n        textCont.appendChild(textInput);\n        textCont.insertBefore(textH, textInput);\n        urlCont.appendChild(urlInput);\n        urlCont.insertBefore(urlH, urlInput);\n        webContElem.appendChild(urlCont);\n        webContElem.insertBefore(textCont, urlCont);\n        var cellRef = [];\n        var definedName = [];\n        var sheets = this.parent.sheets;\n        for (idx; idx < this.parent.sheets.length; idx++) {\n            if (sheets[idx] === this.parent.getActiveSheet()) {\n                cellRef.push({\n                    nodeId: 'sheet',\n                    nodeText: this.parent.sheets[idx].name,\n                    selected: true\n                });\n            }\n            else {\n                cellRef.push({\n                    nodeId: 'sheet',\n                    nodeText: this.parent.sheets[idx].name\n                });\n            }\n        }\n        for (idx = 0; idx < this.parent.definedNames.length; idx++) {\n            definedName.push({\n                nodeId: 'defName',\n                nodeText: this.parent.definedNames[idx].name\n            });\n        }\n        var data = [\n            {\n                nodeId: '01', nodeText: 'Cell Reference', expanded: isCellRef,\n                nodeChild: cellRef\n            },\n            {\n                nodeId: '02', nodeText: 'Defined Names', expanded: isDefinedName,\n                nodeChild: definedName\n            },\n        ];\n        var treeObj = new TreeView({\n            fields: { dataSource: data, id: 'nodeId', text: 'nodeText', child: 'nodeChild' }\n        });\n        var cellrefCont = this.parent.createElement('div', { className: 'e-cont' });\n        var cellrefH = this.parent.createElement('div', { className: 'e-header', innerHTML: 'Cell Reference' });\n        var cellrefInput = this.parent.createElement('input', { className: 'e-input e-text', attrs: { 'type': 'Text' } });\n        cellrefInput.setAttribute('value', 'A1');\n        cellrefCont.appendChild(cellrefInput);\n        cellrefCont.insertBefore(cellrefH, cellrefInput);\n        var textCont1 = this.parent.createElement('div', { className: 'e-cont' });\n        var textH1 = this.parent.createElement('div', { className: 'e-header', innerHTML: 'Display Text' });\n        var textInput1 = this.parent.createElement('input', { className: 'e-input e-text', attrs: { 'type': 'Text' } });\n        if (!isEnable) {\n            textInput1.classList.add('e-disabled');\n            textInput1.setAttribute('readonly', 'true');\n            textInput1.setAttribute('disabled', 'true');\n        }\n        if (cell && isNullOrUndefined(cell.hyperlink)) {\n            textInput1.setAttribute('value', this.parent.getDisplayText(cell));\n        }\n        textInput1.setAttribute('placeholder', 'Enter the text to display');\n        textCont1.appendChild(textInput1);\n        textCont1.insertBefore(textH1, textInput1);\n        var sheetCont = this.parent.createElement('div', { className: 'e-cont' });\n        var sheetH = this.parent.createElement('div', { className: 'e-header', innerHTML: 'Sheet' });\n        var refCont = this.parent.createElement('div', { className: 'e-refcont' });\n        sheetCont.appendChild(refCont);\n        sheetCont.insertBefore(sheetH, refCont);\n        docContElem.appendChild(cellrefCont);\n        docContElem.insertBefore(textCont1, cellrefCont);\n        treeObj.appendTo(refCont);\n        docContElem.appendChild(sheetCont);\n        return dialogElem;\n    };\n    return SpreadsheetHyperlink;\n}());\nexport { SpreadsheetHyperlink };\n","import { performUndoRedo, updateUndoRedoCollection, enableRibbonItems, updateAction, completeAction } from '../common/index';\nimport { setActionData, getBeforeActionData } from '../common/index';\nimport { selectRange, clearUndoRedoCollection } from '../common/index';\nimport { getRangeFromAddress, getRangeIndexes, getSheet, workbookEditOperation } from '../../workbook/index';\nimport { getCell, setCell, getSheetIndex } from '../../workbook/index';\n/**\n * UndoRedo module allows to perform undo redo functionalities.\n */\nvar UndoRedo = /** @class */ (function () {\n    function UndoRedo(parent) {\n        this.undoCollection = [];\n        this.redoCollection = [];\n        this.isUndo = false;\n        this.undoRedoStep = 100;\n        this.parent = parent;\n        this.addEventListener();\n    }\n    UndoRedo.prototype.setActionData = function (options) {\n        var sheet = this.parent.getActiveSheet();\n        var address;\n        var cells = [];\n        var cutCellDetails = [];\n        var args = options.args;\n        var eventArgs = args.eventArgs;\n        switch (args.action) {\n            case 'format':\n                address = getRangeIndexes(args.eventArgs.range);\n                break;\n            case 'clipboard':\n                var copiedInfo = eventArgs.copiedInfo;\n                address = getRangeIndexes(getRangeFromAddress(eventArgs.pastedRange));\n                if (copiedInfo.isCut) {\n                    cutCellDetails = this.getCellDetails(copiedInfo.range, getSheet(this.parent, copiedInfo.sId - 1));\n                }\n                break;\n            case 'beforeSort':\n                address = getRangeIndexes(args.eventArgs.range);\n                if (address[0] === address[2] && (address[2] - address[0]) === 0) { //if selected range is a single cell \n                    address[0] = 0;\n                    address[1] = 0;\n                    address[2] = sheet.usedRange.rowIndex - 1;\n                    address[3] = sheet.usedRange.colIndex;\n                }\n                break;\n            case 'beforeCellSave':\n                address = getRangeIndexes(eventArgs.address);\n                break;\n        }\n        cells = this.getCellDetails(address, sheet);\n        this.beforeActionData = { cellDetails: cells, cutCellDetails: cutCellDetails };\n    };\n    UndoRedo.prototype.getBeforeActionData = function (args) {\n        args.beforeDetails = this.beforeActionData;\n    };\n    UndoRedo.prototype.performUndoRedo = function (args) {\n        var undoRedoArgs = args.isUndo ? this.undoCollection.pop() : this.redoCollection.pop();\n        this.isUndo = args.isUndo;\n        if (undoRedoArgs) {\n            switch (undoRedoArgs.action) {\n                case 'cellSave':\n                case 'format':\n                case 'sorting':\n                    undoRedoArgs = this.performOperation(undoRedoArgs);\n                    break;\n                case 'clipboard':\n                    undoRedoArgs = this.undoForClipboard(undoRedoArgs);\n                    break;\n                case 'resize':\n                    undoRedoArgs = this.undoForResize(undoRedoArgs);\n                    break;\n            }\n            args.isUndo ? this.redoCollection.push(undoRedoArgs) : this.undoCollection.push(undoRedoArgs);\n            if (this.undoCollection.length > this.undoRedoStep) {\n                this.undoCollection.splice(0, 1);\n            }\n            if (this.redoCollection.length > this.undoRedoStep) {\n                this.redoCollection.splice(0, 1);\n            }\n            this.updateUndoRedoIcons();\n            var completeArgs = Object.assign({}, undoRedoArgs.eventArgs);\n            completeArgs.requestType = args.isUndo ? 'undo' : 'redo';\n            delete completeArgs.beforeActionData;\n            if (!args.isPublic) {\n                this.parent.notify(completeAction, { eventArgs: completeArgs, action: 'undoRedo' });\n            }\n        }\n    };\n    UndoRedo.prototype.updateUndoRedoCollection = function (options) {\n        var actionList = ['clipboard', 'format', 'sorting', 'cellSave', 'resize', 'resizeToFit'];\n        var action = options.args.action;\n        if (actionList.indexOf(action) === -1 && !options.isPublic) {\n            return;\n        }\n        var eventArgs = options.args.eventArgs;\n        if (action === 'clipboard' || action === 'sorting' || action === 'format' || action === 'cellSave') {\n            var beforeActionDetails = { beforeDetails: { cellDetails: [] } };\n            this.parent.notify(getBeforeActionData, beforeActionDetails);\n            eventArgs.beforeActionData = beforeActionDetails.beforeDetails;\n        }\n        this.undoCollection.push(options.args);\n        this.redoCollection = [];\n        if (this.undoCollection.length > this.undoRedoStep) {\n            this.undoCollection.splice(0, 1);\n        }\n        this.updateUndoRedoIcons();\n    };\n    UndoRedo.prototype.clearUndoRedoCollection = function () {\n        this.undoCollection = [];\n        this.redoCollection = [];\n        this.updateUndoRedoIcons();\n    };\n    UndoRedo.prototype.updateUndoRedoIcons = function () {\n        this.parent.notify(enableRibbonItems, [{ id: this.parent.element.id + '_undo', isEnable: this.undoCollection.length > 0 }]);\n        this.parent.notify(enableRibbonItems, [{ id: this.parent.element.id + '_redo', isEnable: this.redoCollection.length > 0 }]);\n    };\n    UndoRedo.prototype.undoForClipboard = function (args) {\n        var eventArgs = args.eventArgs;\n        var address = eventArgs.pastedRange.split('!');\n        var range = getRangeIndexes(address[1]);\n        var sheetIndex = getSheetIndex(this.parent, address[0]);\n        var sheet = getSheet(this.parent, sheetIndex);\n        var copiedInfo = eventArgs.copiedInfo;\n        var actionData = eventArgs.beforeActionData;\n        var isRefresh = this.checkRefreshNeeded(sheetIndex);\n        if (this.isUndo) {\n            if (copiedInfo.isCut) {\n                var cells = actionData.cutCellDetails;\n                this.updateCellDetails(cells, getSheet(this.parent, copiedInfo.sId - 1), copiedInfo.range, isRefresh);\n            }\n            this.updateCellDetails(actionData.cellDetails, sheet, range, isRefresh);\n        }\n        else {\n            updateAction(args, this.parent, copiedInfo.isCut);\n        }\n        if (isRefresh) {\n            this.parent.notify(selectRange, range);\n        }\n        return args;\n    };\n    UndoRedo.prototype.undoForResize = function (args) {\n        var eventArgs = args.eventArgs;\n        if (eventArgs.isCol) {\n            var temp = eventArgs.oldWidth;\n            eventArgs.oldWidth = eventArgs.width;\n            eventArgs.width = temp;\n        }\n        else {\n            var temp = eventArgs.oldHeight;\n            eventArgs.oldHeight = eventArgs.height;\n            eventArgs.height = temp;\n        }\n        updateAction(args, this.parent);\n        return args;\n    };\n    UndoRedo.prototype.performOperation = function (args) {\n        var eventArgs = args.eventArgs;\n        var address = (args.action === 'cellSave') ? eventArgs.address.split('!') : eventArgs.range.split('!');\n        var range = getRangeIndexes(address[1]);\n        var sheetIndex = getSheetIndex(this.parent, address[0]);\n        var sheet = getSheet(this.parent, sheetIndex);\n        var actionData = eventArgs.beforeActionData;\n        var isRefresh = this.checkRefreshNeeded(sheetIndex);\n        if (this.isUndo) {\n            this.updateCellDetails(actionData.cellDetails, sheet, range, isRefresh);\n        }\n        else {\n            updateAction(args, this.parent);\n        }\n        if (isRefresh) {\n            this.parent.notify(selectRange, range);\n        }\n        return args;\n    };\n    UndoRedo.prototype.getCellDetails = function (address, sheet) {\n        var cells = [];\n        var cell;\n        for (var i = address[0]; i <= address[2]; i++) {\n            for (var j = address[1]; j <= address[3]; j++) {\n                cell = getCell(i, j, sheet);\n                cells.push({\n                    rowIndex: i, colIndex: j, format: cell ? cell.format : null,\n                    style: cell ? cell.style : null, value: cell ? cell.value : '', formula: cell ? cell.formula : ''\n                });\n            }\n        }\n        return cells;\n    };\n    UndoRedo.prototype.updateCellDetails = function (cells, sheet, range, isRefresh) {\n        var len = cells.length;\n        for (var i = 0; i < len; i++) {\n            setCell(cells[i].rowIndex, cells[i].colIndex, sheet, {\n                value: cells[i].value, format: cells[i].format,\n                style: cells[i].style, formula: cells[i].formula\n            });\n            if (cells[i].formula) {\n                this.parent.notify(workbookEditOperation, {\n                    action: 'updateCellValue', address: [cells[i].rowIndex, cells[i].colIndex, cells[i].rowIndex,\n                        cells[i].colIndex], value: cells[i].formula\n                });\n            }\n        }\n        if (isRefresh) {\n            this.parent.serviceLocator.getService('cell').refreshRange(range);\n        }\n    };\n    UndoRedo.prototype.checkRefreshNeeded = function (sheetIndex) {\n        var isRefresh = true;\n        if (sheetIndex + 1 !== this.parent.activeSheetTab) {\n            this.parent.activeSheetTab = sheetIndex + 1;\n            this.parent.dataBind();\n            isRefresh = false;\n        }\n        return isRefresh;\n    };\n    UndoRedo.prototype.addEventListener = function () {\n        this.parent.on(performUndoRedo, this.performUndoRedo, this);\n        this.parent.on(updateUndoRedoCollection, this.updateUndoRedoCollection, this);\n        this.parent.on(setActionData, this.setActionData, this);\n        this.parent.on(getBeforeActionData, this.getBeforeActionData, this);\n        this.parent.on(clearUndoRedoCollection, this.clearUndoRedoCollection, this);\n    };\n    UndoRedo.prototype.removeEventListener = function () {\n        if (!this.parent.isDestroyed) {\n            this.parent.off(performUndoRedo, this.performUndoRedo);\n            this.parent.off(updateUndoRedoCollection, this.updateUndoRedoCollection);\n            this.parent.off(setActionData, this.setActionData);\n            this.parent.off(getBeforeActionData, this.getBeforeActionData);\n            this.parent.off(clearUndoRedoCollection, this.clearUndoRedoCollection);\n        }\n    };\n    /**\n     * Destroy undo redo module.\n     */\n    UndoRedo.prototype.destroy = function () {\n        this.removeEventListener();\n        this.parent = null;\n    };\n    /**\n     * Get the undo redo module name.\n     */\n    UndoRedo.prototype.getModuleName = function () {\n        return 'undoredo';\n    };\n    return UndoRedo;\n}());\nexport { UndoRedo };\n","var __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    }\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nimport { Component, Property, NotifyPropertyChanges, Event, ChildProperty } from '@syncfusion/ej2-base';\nimport { getComponent, closest, EventHandler } from '@syncfusion/ej2-base';\nimport { Collection, Complex } from '@syncfusion/ej2-base';\nimport { Tab, Toolbar } from '@syncfusion/ej2-navigations';\nimport { Menu, Header, Item, MenuItem } from '@syncfusion/ej2-navigations';\n/**\n * An array of object that is used to configure the Tab.\n */\nvar RibbonItem = /** @class */ (function (_super) {\n    __extends(RibbonItem, _super);\n    function RibbonItem() {\n        return _super !== null && _super.apply(this, arguments) || this;\n    }\n    __decorate([\n        Complex({}, Header)\n    ], RibbonItem.prototype, \"header\", void 0);\n    __decorate([\n        Collection([], Item)\n    ], RibbonItem.prototype, \"content\", void 0);\n    __decorate([\n        Property({})\n    ], RibbonItem.prototype, \"cssClass\", void 0);\n    __decorate([\n        Property(false)\n    ], RibbonItem.prototype, \"disabled\", void 0);\n    __decorate([\n        Property('Tab')\n    ], RibbonItem.prototype, \"type\", void 0);\n    __decorate([\n        Collection([], MenuItem)\n    ], RibbonItem.prototype, \"menuItems\", void 0);\n    return RibbonItem;\n}(ChildProperty));\nexport { RibbonItem };\n/**\n * Represents Ribbon component.\n */\nvar Ribbon = /** @class */ (function (_super) {\n    __extends(Ribbon, _super);\n    /**\n     * Constructor for creating the widget.\n     * @param  {RibbonModel} options?\n     * @param  {string|HTMLDivElement} element?\n     */\n    function Ribbon(options, element) {\n        return _super.call(this, options) || this;\n    }\n    /**\n     * For internal use only.\n     * @returns void\n     * @private\n     */\n    Ribbon.prototype.preRender = function () {\n        /** */\n    };\n    /**\n     * For internal use only.\n     * @returns void\n     * @private\n     */\n    Ribbon.prototype.render = function () {\n        this.renderRibbon();\n    };\n    /**\n     * Destroys the component (detaches/removes all event handlers, attributes, classes, and empties the component element).\n     * @method destroy\n     * @return {void}\n     */\n    Ribbon.prototype.destroy = function () {\n        this.destroyComponent(this.element.querySelector('.e-file-menu'), Menu);\n        var expandCollapseElem = this.tabObj.element.querySelector('.e-drop-icon');\n        if (expandCollapseElem) {\n            expandCollapseElem.removeEventListener('click', this.ribbonExpandCollapse.bind(this));\n        }\n        this.toolbarObj.destroy();\n        this.tabObj.destroy();\n        _super.prototype.destroy.call(this);\n    };\n    Ribbon.prototype.getTabItems = function () {\n        var _this = this;\n        var tabItems = [];\n        this.items.forEach(function (item) {\n            switch (item.type) {\n                case 'Menu':\n                    tabItems.push({\n                        header: { text: _this.initMenu(item.menuItems) },\n                        content: _this.toolbarObj.element\n                    });\n                    break;\n                case 'Tab':\n                    tabItems.push({\n                        header: item.header,\n                        content: _this.toolbarObj.element\n                    });\n                    break;\n            }\n        });\n        return tabItems;\n    };\n    Ribbon.prototype.initMenu = function (menuItems) {\n        var _this = this;\n        var menu = this.createElement('ul');\n        this.element.appendChild(menu);\n        var menuObj = new Menu({\n            cssClass: 'e-file-menu',\n            items: menuItems,\n            showItemOnClick: true,\n            beforeOpen: function (args) {\n                if (args.parentItem.text === menuItems[0].text) {\n                    menuObj.showItemOnClick = false;\n                }\n                _this.trigger('beforeOpen', args);\n            },\n            select: function (args) {\n                _this.trigger('fileItemSelect', args);\n            },\n            beforeClose: function (args) {\n                if (args.event.type === 'mouseover' && !closest(args.event.target, '.e-menu-popup')) {\n                    args.cancel = true;\n                    return;\n                }\n                _this.trigger('beforeClose', args);\n                if (!args.parentItem || args.parentItem.text === menuItems[0].text) {\n                    requestAnimationFrame(function () { return menuObj.setProperties({ showItemOnClick: true }, true); });\n                }\n            },\n            beforeItemRender: function (args) {\n                _this.trigger('beforeFileItemRender', args);\n            }\n        });\n        menuObj.createElement = this.createElement;\n        menuObj.appendTo(menu);\n        return menu.parentElement;\n    };\n    Ribbon.prototype.renderRibbon = function () {\n        var _this = this;\n        var tabElement = this.createElement('div');\n        var tBarElement = this.createElement('div');\n        this.toolbarObj = new Toolbar({\n            clicked: function (args) {\n                _this.trigger('clicked', args);\n            }\n        });\n        this.toolbarObj.createElement = this.createElement;\n        this.toolbarObj.appendTo(tBarElement);\n        this.tabObj = new Tab({\n            selectedItem: 1,\n            animation: { next: { duration: 0 }, previous: { duration: 0 } },\n            items: this.getTabItems(),\n            selecting: function (args) {\n                if (_this.items[args.selectingIndex].type === 'Menu') {\n                    args.cancel = true;\n                }\n                else {\n                    _this.toolbarObj.items = _this.items[args.selectingIndex].content;\n                    _this.toolbarObj.dataBind();\n                    if (_this.element.classList.contains('e-collapsed')) {\n                        EventHandler.remove(args.selectedItem, 'click', _this.ribbonExpandCollapse);\n                    }\n                }\n                _this.trigger('selecting', args);\n            },\n            selected: function () {\n                if (_this.element.classList.contains('e-collapsed')) {\n                    _this.element.classList.remove('e-collapsed');\n                    _this.trigger('expandCollapse', { element: _this.toolbarObj.element, expanded: true });\n                }\n            },\n            created: function () {\n                var collapseBtn = _this.createElement('span', { className: 'e-drop-icon e-icons' });\n                collapseBtn.addEventListener('click', _this.ribbonExpandCollapse.bind(_this));\n                _this.tabObj.element.querySelector('.e-tab-header').appendChild(collapseBtn);\n                _this.toolbarObj.refreshOverflow();\n            }\n        });\n        this.element.appendChild(tabElement);\n        this.tabObj.createElement = this.createElement;\n        this.tabObj.appendTo(tabElement);\n    };\n    Ribbon.prototype.ribbonExpandCollapse = function (e) {\n        var eventArgs = { element: this.toolbarObj.element, expanded: true };\n        var activeTab;\n        if (this.element.classList.contains('e-collapsed')) {\n            activeTab = this.tabObj.element.querySelector('.e-tab-header').getElementsByClassName('e-toolbar-item')[this.tabObj.selectedItem];\n            this.element.classList.remove('e-collapsed');\n            activeTab.classList.add('e-active');\n            EventHandler.remove(activeTab, 'click', this.ribbonExpandCollapse);\n            this.trigger('expandCollapse', eventArgs);\n        }\n        else {\n            activeTab = this.tabObj.element.querySelector('.e-tab-header .e-toolbar-item.e-active');\n            this.element.classList.add('e-collapsed');\n            eventArgs.expanded = false;\n            activeTab.classList.remove('e-active');\n            EventHandler.add(activeTab, 'click', this.ribbonExpandCollapse, this);\n            this.trigger('expandCollapse', eventArgs);\n        }\n    };\n    /**\n     * Enables or disables the specified Ribbon items or all ribbon items.\n     * @param  {boolean} enable  - Boolean value that determines whether the command should be enabled or disabled.\n     * @param  {HTMLElement} items - DOM element or an array of items to be enabled or disabled.\n     * By default, `isEnable` is set to true.\n     * @returns void.\n     */\n    Ribbon.prototype.enableItems = function (enable, items) {\n        if (items) {\n            this.toolbarObj.enableItems(items, enable);\n        }\n        else {\n            this.toolbarObj.disable(!enable);\n        }\n    };\n    /**\n     * Get component name.\n     * @returns string\n     * @private\n     */\n    Ribbon.prototype.getModuleName = function () {\n        return 'ribbon';\n    };\n    /**\n     * Get the properties to be maintained in the persisted state.\n     * @returns string\n     * @private\n     */\n    Ribbon.prototype.getPersistData = function () {\n        return this.addOnPersist([]);\n    };\n    /**\n     * Called internally if any of the property value changed.\n     * @param  {RibbonModel} newProp\n     * @param  {RibbonModel} oldProp\n     * @returns void\n     * @private\n     */\n    Ribbon.prototype.onPropertyChanged = function (newProp, oldProp) {\n        /** code snippets */\n    };\n    Ribbon.prototype.destroyComponent = function (element, component) {\n        if (element) {\n            var compObj = getComponent(element, component);\n            if (compObj) {\n                compObj.destroy();\n            }\n        }\n    };\n    __decorate([\n        Property('')\n    ], Ribbon.prototype, \"cssClass\", void 0);\n    __decorate([\n        Collection([], RibbonItem)\n    ], Ribbon.prototype, \"items\", void 0);\n    __decorate([\n        Event()\n    ], Ribbon.prototype, \"selecting\", void 0);\n    __decorate([\n        Event()\n    ], Ribbon.prototype, \"fileItemSelect\", void 0);\n    __decorate([\n        Event()\n    ], Ribbon.prototype, \"beforeFileItemRender\", void 0);\n    __decorate([\n        Event()\n    ], Ribbon.prototype, \"beforeOpen\", void 0);\n    __decorate([\n        Event()\n    ], Ribbon.prototype, \"beforeClose\", void 0);\n    __decorate([\n        Event()\n    ], Ribbon.prototype, \"selectFormat\", void 0);\n    __decorate([\n        Event()\n    ], Ribbon.prototype, \"clicked\", void 0);\n    __decorate([\n        Event()\n    ], Ribbon.prototype, \"created\", void 0);\n    __decorate([\n        Event()\n    ], Ribbon.prototype, \"expandCollapse\", void 0);\n    Ribbon = __decorate([\n        NotifyPropertyChanges\n    ], Ribbon);\n    return Ribbon;\n}(Component));\nexport { Ribbon };\n","import { ColorPicker as ColorPickerComponent } from '@syncfusion/ej2-inputs';\nimport { addClass } from '@syncfusion/ej2-base';\nimport { spreadsheetDestroyed, fontColor, fillColor, beforeRibbonCreate, locale, destroyComponent } from '../common/index';\nimport { setCellFormat } from '../../workbook/common/index';\n/**\n * `Color Picker` module is used to handle ColorPicker functionality.\n * @hidden\n */\nvar ColorPicker = /** @class */ (function () {\n    function ColorPicker(parent) {\n        this.parent = parent;\n        this.addEventListener();\n    }\n    ColorPicker.prototype.render = function () {\n        var _this = this;\n        var id = this.parent.element.id;\n        var input = this.parent.createElement('input', { attrs: { 'type': 'color' } });\n        var fontColorPicker = new ColorPickerComponent({\n            value: '#000000ff',\n            mode: 'Palette',\n            showButtons: false,\n            presetColors: fontColor,\n            enableOpacity: false,\n            beforeClose: function (args) { return _this.beforeCloseHandler(fontColorPicker); },\n            open: this.openHandler.bind(this),\n            beforeModeSwitch: function (args) { return _this.beforeModeSwitch(fontColorPicker, args); },\n            change: function (args) {\n                var color = fontColorPicker.getValue(args.currentValue.rgba);\n                var eventArgs = { style: { color: color }, onActionUpdate: true };\n                _this.parent.notify(setCellFormat, eventArgs);\n                if (eventArgs.cancel) {\n                    fontColorPicker.setProperties({ 'value': fontColorPicker.getValue(args.previousValue.rgba, 'HEXA') }, true);\n                }\n                else {\n                    _this.updateSelectedColor(eventArgs.style.color, fontColorPicker.element);\n                }\n                _this.parent.element.focus();\n            },\n            created: function () { return _this.wireFocusEvent(fontColorPicker.element, '#000000'); }\n        });\n        fontColorPicker.createElement = this.parent.createElement;\n        this.parent.element.appendChild(input);\n        fontColorPicker.appendTo(input);\n        input.parentElement.id = id + \"_font_color_picker\";\n        addClass([input.nextElementSibling.getElementsByClassName('e-selected-color')[0]], ['e-icons', 'e-font-color']);\n        input = this.parent.createElement('input', { attrs: { 'type': 'color' } });\n        var filColorPicker = new ColorPickerComponent({\n            value: '#ffff00ff',\n            mode: 'Palette',\n            presetColors: fillColor,\n            showButtons: false,\n            enableOpacity: false,\n            open: this.openHandler.bind(this),\n            beforeClose: function (args) { return _this.beforeCloseHandler(filColorPicker); },\n            beforeModeSwitch: function (args) { return _this.beforeModeSwitch(filColorPicker, args); },\n            change: function (args) {\n                var color = filColorPicker.getValue(args.currentValue.rgba);\n                var eventArgs = { style: { backgroundColor: color }, onActionUpdate: true };\n                _this.parent.notify(setCellFormat, eventArgs);\n                if (eventArgs.cancel) {\n                    filColorPicker.setProperties({ 'value': filColorPicker.getValue(args.previousValue.rgba, 'HEXA') }, true);\n                }\n                else {\n                    _this.updateSelectedColor(eventArgs.style.backgroundColor, filColorPicker.element);\n                }\n                _this.parent.element.focus();\n            },\n            created: function () { return _this.wireFocusEvent(filColorPicker.element, '#ffff00'); }\n        });\n        filColorPicker.createElement = this.parent.createElement;\n        this.parent.element.appendChild(input);\n        filColorPicker.appendTo(input);\n        input.parentElement.id = id + \"_fill_color_picker\";\n        addClass([input.nextElementSibling.getElementsByClassName('e-selected-color')[0]], ['e-icons', 'e-fill-color']);\n    };\n    ColorPicker.prototype.updateSelectedColor = function (color, ele) {\n        ele.nextElementSibling.querySelector('.e-selected-color').style.borderBottomColor = color;\n    };\n    ColorPicker.prototype.wireFocusEvent = function (element, color) {\n        var _this = this;\n        this.updateSelectedColor(color, element);\n        element = element.parentElement.querySelector('.e-split-colorpicker');\n        element.addEventListener('focus', function () {\n            _this.parent.element.focus();\n        });\n    };\n    ColorPicker.prototype.openHandler = function (args) {\n        args.element.querySelector('.e-mode-switch-btn').title =\n            this.parent.serviceLocator.getService(locale).getConstant('MoreColors');\n    };\n    ColorPicker.prototype.beforeCloseHandler = function (inst) {\n        if (!inst.modeSwitcher) {\n            inst.setProperties({ modeSwitcher: true }, true);\n        }\n        if (inst.showButtons) {\n            inst.setProperties({ showButtons: false }, true);\n        }\n    };\n    ColorPicker.prototype.beforeModeSwitch = function (inst, args) {\n        var l10n = this.parent.serviceLocator.getService(locale);\n        if (args.mode === 'Picker') {\n            inst.showButtons = true;\n            inst.dataBind();\n            args.element.querySelector('.e-apply').title = l10n.getConstant('Apply');\n            args.element.querySelector('.e-cancel').title = l10n.getConstant('Cancel');\n            args.element.querySelector('.e-mode-switch-btn').title = l10n.getConstant('StandardColors');\n        }\n        else {\n            inst.showButtons = false;\n            inst.dataBind();\n            args.element.querySelector('.e-mode-switch-btn').title = l10n.getConstant('MoreColors');\n        }\n    };\n    ColorPicker.prototype.destroy = function () {\n        this.removeEventListener();\n        var id = this.parent.element.id;\n        this.destroyColorPicker(id + \"_font_color_picker\");\n        this.destroyColorPicker(id + \"_fill_color_picker\");\n        this.parent = null;\n    };\n    ColorPicker.prototype.destroyColorPicker = function (id) {\n        var ele = document.getElementById(id);\n        if (ele) {\n            destroyComponent(ele.firstElementChild, ColorPickerComponent);\n        }\n    };\n    ColorPicker.prototype.addEventListener = function () {\n        this.parent.on(beforeRibbonCreate, this.render, this);\n        this.parent.on(spreadsheetDestroyed, this.destroy, this);\n    };\n    ColorPicker.prototype.removeEventListener = function () {\n        if (!this.parent.isDestroyed) {\n            this.parent.off(beforeRibbonCreate, this.render);\n            this.parent.off(spreadsheetDestroyed, this.destroy);\n        }\n    };\n    return ColorPicker;\n}());\nexport { ColorPicker };\n","import { Ribbon as RibbonComponent } from '../../ribbon/index';\nimport { ribbon, selectionComplete, beforeRibbonCreate, dialog, reapplyFilter } from '../common/index';\nimport { destroyComponent, performUndoRedo, beginAction, completeAction, applySort } from '../common/index';\nimport { enableRibbonItems, ribbonClick, paste, locale, refreshSheetTabs, initiateCustomSort, getFilteredColumn } from '../common/index';\nimport { tabSwitch, getUpdateUsingRaf, enableToolbar, updateToggleItem, initiateHyperlink, editHyperlink } from '../common/index';\nimport { Toolbar, Menu } from '@syncfusion/ej2-navigations';\nimport { extend, isNullOrUndefined, getComponent, closest, detach } from '@syncfusion/ej2-base';\nimport { getCellIndexes, getFormatFromType, getTypeFromFormat } from '../../workbook/index';\nimport { DropDownButton, SplitButton } from '@syncfusion/ej2-splitbuttons';\nimport { calculatePosition } from '@syncfusion/ej2-popups';\nimport { applyNumberFormatting, getFormattedCellObject, getRangeIndexes } from '../../workbook/common/index';\nimport { activeCellChanged, textDecorationUpdate } from '../../workbook/common/index';\nimport { sheetsDestroyed } from '../../workbook/common/index';\nimport { getCell, setCellFormat } from '../../workbook/index';\nimport { Button } from '@syncfusion/ej2-buttons';\nimport { ColorPicker } from './color-picker';\n/**\n * Represents Ribbon for Spreadsheet.\n */\nvar Ribbon = /** @class */ (function () {\n    function Ribbon(parent) {\n        this.fontNameIndex = 5;\n        this.numPopupWidth = 0;\n        this.activeTab = 1;\n        this.parent = parent;\n        this.addEventListener();\n        new ColorPicker(parent);\n    }\n    Ribbon.prototype.getModuleName = function () {\n        return 'ribbon';\n    };\n    Ribbon.prototype.initRibbon = function (args) {\n        if (!this.parent.showRibbon && this.ribbon) {\n            this.destroy();\n            return;\n        }\n        this.parent.notify(beforeRibbonCreate, {});\n        if (this.parent.isMobileView()) {\n            this.createMobileView();\n        }\n        else {\n            this.createRibbon(args);\n        }\n    };\n    Ribbon.prototype.getRibbonItems = function () {\n        var _this = this;\n        var id = this.parent.element.id;\n        var l10n = this.parent.serviceLocator.getService(locale);\n        var items = [\n            {\n                type: 'Menu',\n                menuItems: [\n                    {\n                        text: this.parent.isMobileView() ? '' : l10n.getConstant('File'),\n                        iconCss: this.parent.isMobileView() ? 'e-icons e-file-menu-icon' : null,\n                        items: [\n                            { text: l10n.getConstant('New'), id: 'New', iconCss: 'e-new e-icons' },\n                            { text: l10n.getConstant('Open'), id: 'Open', iconCss: 'e-open e-icons' },\n                            {\n                                text: l10n.getConstant('SaveAs'),\n                                iconCss: 'e-save e-icons',\n                                items: [\n                                    { text: l10n.getConstant('ExcelXlsx'), id: 'Xlsx', iconCss: 'e-xlsx e-icons' },\n                                    { text: l10n.getConstant('ExcelXls'), id: 'Xls', iconCss: 'e-xls e-icons' },\n                                    { text: l10n.getConstant('CSV'), id: 'Csv', iconCss: 'e-csv e-icons' }\n                                ]\n                            }\n                        ]\n                    }\n                ]\n            },\n            {\n                header: { text: l10n.getConstant('Home') },\n                content: [\n                    { prefixIcon: 'e-undo-icon', tooltipText: l10n.getConstant('Undo') + \" (Ctrl+Z)\", id: id + '_undo' },\n                    { prefixIcon: 'e-redo-icon', tooltipText: l10n.getConstant('Redo') + \" (Ctrl+Y)\", id: id + '_redo' },\n                    { type: 'Separator' },\n                    { prefixIcon: 'e-cut-icon', tooltipText: l10n.getConstant('Cut') + \" (Ctrl+X)\", id: id + '_cut' },\n                    { prefixIcon: 'e-copy-icon', tooltipText: l10n.getConstant('Copy') + \" (Ctrl+C)\", id: id + '_copy' },\n                    { tooltipText: l10n.getConstant('Paste') + \" (Ctrl+V)\", template: this.getPasteBtn(id) },\n                    { type: 'Separator' },\n                    { template: this.getNumFormatDDB(id), tooltipText: l10n.getConstant('NumberFormat') }, { type: 'Separator' },\n                    { template: this.getFontNameDDB(id), tooltipText: l10n.getConstant('Font') }, { type: 'Separator' },\n                    { template: this.getFontSizeDDB(id), tooltipText: l10n.getConstant('FontSize') }, { type: 'Separator' },\n                    { template: this.getBtn(id, 'bold'), tooltipText: l10n.getConstant('Bold') + \" (Ctrl+B)\" },\n                    { template: this.getBtn(id, 'italic'), tooltipText: l10n.getConstant('Italic') + \" (Ctrl+I)\" },\n                    { template: this.getBtn(id, 'line-through'), tooltipText: l10n.getConstant('Strikethrough') + \" (Ctrl+5)\" },\n                    { template: this.getBtn(id, 'underline'), tooltipText: l10n.getConstant('Underline') + \" (Ctrl+U)\" },\n                    { template: document.getElementById(id + \"_font_color_picker\"), tooltipText: l10n.getConstant('TextColor') },\n                    { type: 'Separator' },\n                    { template: document.getElementById(id + \"_fill_color_picker\"), tooltipText: l10n.getConstant('FillColor') },\n                    { type: 'Separator' }, { template: this.getTextAlignDDB(id), tooltipText: l10n.getConstant('HorizontalAlignment') },\n                    { template: this.getVerticalAlignDDB(id), tooltipText: l10n.getConstant('VerticalAlignment') }\n                ]\n            },\n            {\n                header: { text: l10n.getConstant('Insert') },\n                content: [{\n                        prefixIcon: 'e-hyperlink-icon', text: l10n.getConstant('Link'),\n                        id: id + '_hyperlink', click: function () { _this.getHyperlinkDlg(); }\n                    }]\n            },\n            {\n                header: { text: l10n.getConstant('Formulas') },\n                content: [{ prefixIcon: 'e-insert-function', text: l10n.getConstant('InsertFunction'), id: id + '_insert_function' }]\n            },\n            {\n                header: { text: 'View' },\n                content: [\n                    { prefixIcon: 'e-hide-headers', text: this.getLocaleText('Headers'), id: id + '_headers' }, { type: 'Separator' },\n                    { prefixIcon: 'e-hide-gridlines', text: this.getLocaleText('GridLines'), id: id + '_gridlines' }\n                ]\n            }\n        ];\n        if (this.parent.allowSorting || this.parent.allowFiltering) {\n            items.find(function (x) { return x.header && x.header.text === l10n.getConstant('Home'); }).content.push({ type: 'Separator' }, {\n                template: this.getSortFilterDDB(id), tooltipText: l10n.getConstant('SortAndFilter')\n            });\n        }\n        return items;\n    };\n    Ribbon.prototype.getPasteBtn = function (id) {\n        var _this = this;\n        var btn = this.parent.element.appendChild(this.parent.createElement('button', { id: id + '_paste' }));\n        var l10n = this.parent.serviceLocator.getService(locale);\n        var pasteSplitBtn = new SplitButton({\n            iconCss: 'e-icons e-paste-icon',\n            items: [\n                { text: l10n.getConstant('All'), id: 'All' },\n                { text: l10n.getConstant('Values'), id: 'Values' },\n                { text: l10n.getConstant('Formats'), id: 'Formats' }\n            ],\n            select: function (args) {\n                _this.parent.notify(paste, { type: args.item.id, isAction: true });\n            },\n            click: function () {\n                _this.parent.notify(paste, { isAction: true });\n            },\n            close: function () { _this.parent.element.focus(); }\n        });\n        pasteSplitBtn.createElement = this.parent.createElement;\n        pasteSplitBtn.appendTo(btn);\n        return btn.parentElement;\n    };\n    Ribbon.prototype.getHyperlinkDlg = function () {\n        var indexes = getRangeIndexes(this.parent.getActiveSheet().activeCell);\n        var cell = this.parent.sheets[this.parent.getActiveSheet().id - 1].rows[indexes[0]].cells[indexes[1]];\n        if (cell && cell.hyperlink) {\n            this.parent.notify(editHyperlink, null);\n        }\n        else {\n            this.parent.notify(initiateHyperlink, null);\n        }\n    };\n    Ribbon.prototype.getLocaleText = function (str, setClass) {\n        var text;\n        var l10n = this.parent.serviceLocator.getService(locale);\n        var sheet = this.parent.getActiveSheet();\n        if (sheet['show' + str]) {\n            if (setClass) {\n                this.parent.getMainContent().classList.remove('e-hide-' + str.toLowerCase());\n            }\n            text = l10n.getConstant('Hide' + str);\n        }\n        else {\n            if (setClass) {\n                this.parent.getMainContent().classList.add('e-hide-' + str.toLowerCase());\n            }\n            text = l10n.getConstant('Show' + str);\n        }\n        return text;\n    };\n    Ribbon.prototype.createRibbon = function (args) {\n        var ribbonElement = this.parent.createElement('div');\n        this.ribbon = new RibbonComponent({\n            items: this.getRibbonItems(),\n            fileItemSelect: this.fileItemSelect.bind(this),\n            beforeOpen: this.fileMenuBeforeOpen.bind(this),\n            beforeClose: this.fileMenuBeforeClose.bind(this),\n            clicked: this.toolbarClicked.bind(this),\n            created: this.ribbonCreated.bind(this),\n            selecting: this.tabSelecting.bind(this),\n            expandCollapse: this.expandCollapseHandler.bind(this),\n            beforeFileItemRender: this.beforeRenderHandler.bind(this)\n        });\n        this.ribbon.createElement = this.parent.createElement;\n        if (args && args.uiUpdate) {\n            var refEle = this.parent.element.querySelector('.e-formula-bar-panel') ||\n                document.getElementById(this.parent.element.id + '_sheet_panel');\n            this.parent.element.insertBefore(ribbonElement, refEle);\n        }\n        else {\n            this.parent.element.appendChild(ribbonElement);\n        }\n        this.ribbon.appendTo(ribbonElement);\n    };\n    Ribbon.prototype.tabSelecting = function (args) {\n        if (args.selectingIndex && args.selectingIndex !== this.activeTab) {\n            this.activeTab = args.selectingIndex;\n            this.refreshRibbonContent();\n            this.parent.notify(tabSwitch, { idx: args.selectingIndex });\n        }\n    };\n    Ribbon.prototype.beforeRenderHandler = function (args) {\n        var l10n = this.parent.serviceLocator.getService(locale);\n        if (args.item.text === l10n.getConstant('Open') && (!this.parent.openUrl || !this.parent.allowOpen)) {\n            args.element.classList.add('e-disabled');\n        }\n        if (args.item.text === l10n.getConstant('SaveAs') && (!this.parent.saveUrl || !this.parent.allowSave)) {\n            args.element.classList.add('e-disabled');\n        }\n    };\n    Ribbon.prototype.getNumFormatDDB = function (id) {\n        var _this = this;\n        var numFormatBtn = this.parent.createElement('button', { id: id + '_number_format' });\n        numFormatBtn.appendChild(this.parent.createElement('span', { className: 'e-tbar-btn-text', innerHTML: 'General' }));\n        this.numFormatDDB = new DropDownButton({\n            items: this.getNumFormatDdbItems(id),\n            content: '',\n            select: function (args) { return _this.numDDBSelect(args); },\n            open: function (args) { return _this.numDDBOpen(args); },\n            beforeItemRender: function (args) { return _this.previewNumFormat(args); },\n            close: function () { return _this.parent.element.focus(); },\n            cssClass: 'e-flat e-numformat-ddb',\n            beforeOpen: this.tBarDdbBeforeOpen.bind(this)\n        });\n        this.numFormatDDB.createElement = this.parent.createElement;\n        this.numFormatDDB.appendTo(numFormatBtn);\n        return numFormatBtn;\n    };\n    Ribbon.prototype.getFontSizeDDB = function (id) {\n        var _this = this;\n        this.fontSizeDdb = new DropDownButton({\n            cssClass: 'e-font-size-ddb',\n            content: '11',\n            items: [{ text: '8' }, { text: '9' }, { text: '10' }, { text: '11' }, { text: '12' }, { text: '14' }, { text: '16' },\n                { text: '18' }, { text: '20' }, { text: '22' }, { text: '24' }, { text: '26' }, { text: '28' }, { text: '36' },\n                { text: '48' }, { text: '72' }],\n            beforeOpen: function (args) {\n                _this.tBarDdbBeforeOpen(args);\n                _this.refreshSelected(_this.fontSizeDdb, args.element, 'content', 'text');\n            },\n            select: function (args) {\n                var eventArgs = { style: { fontSize: args.item.text + \"pt\" }, onActionUpdate: true };\n                _this.parent.notify(setCellFormat, eventArgs);\n                if (!eventArgs.cancel) {\n                    _this.fontSizeDdb.content = eventArgs.style.fontSize.split('pt')[0];\n                    _this.fontSizeDdb.dataBind();\n                }\n            },\n            close: function () { return _this.parent.element.focus(); }\n        });\n        this.fontSizeDdb.createElement = this.parent.createElement;\n        this.fontSizeDdb.appendTo(this.parent.createElement('button', { id: id + '_font_size' }));\n        return this.fontSizeDdb.element;\n    };\n    Ribbon.prototype.getFontNameDDB = function (id) {\n        var _this = this;\n        var fontNameBtn = this.parent.createElement('button', { id: id + '_font_name' });\n        fontNameBtn.appendChild(this.parent.createElement('span', { className: 'e-tbar-btn-text', innerHTML: 'Calibri' }));\n        this.fontNameDdb = new DropDownButton({\n            cssClass: 'e-font-family',\n            items: this.getFontFamilyItems(),\n            select: function (args) {\n                var eventArgs = { style: { fontFamily: args.item.text }, onActionUpdate: true };\n                _this.parent.notify(setCellFormat, eventArgs);\n                if (!eventArgs.cancel) {\n                    _this.refreshFontNameSelection(eventArgs.style.fontFamily);\n                }\n            },\n            close: function () { return _this.parent.element.focus(); },\n            beforeOpen: this.tBarDdbBeforeOpen.bind(this)\n        });\n        this.fontNameDdb.createElement = this.parent.createElement;\n        this.fontNameDdb.appendTo(fontNameBtn);\n        return fontNameBtn;\n    };\n    Ribbon.prototype.getBtn = function (id, name) {\n        var btnObj = new Button({ iconCss: \"e-icons e-\" + name + \"-icon\", isToggle: true });\n        btnObj.createElement = this.parent.createElement;\n        btnObj.appendTo(this.parent.createElement('button', { id: id + \"_\" + name }));\n        btnObj.element.addEventListener('click', this.toggleBtnClicked.bind(this));\n        return btnObj.element;\n    };\n    Ribbon.prototype.getTextAlignDDB = function (id) {\n        var _this = this;\n        this.textAlignDdb = new DropDownButton({\n            cssClass: 'e-align-ddb',\n            iconCss: 'e-icons e-left-icon',\n            items: [{ iconCss: 'e-icons e-left-icon' }, { iconCss: 'e-icons e-center-icon' }, { iconCss: 'e-icons e-right-icon' }],\n            beforeItemRender: this.alignItemRender.bind(this),\n            beforeOpen: function (args) {\n                _this.refreshSelected(_this.textAlignDdb, args.element, 'iconCss');\n            },\n            select: function (args) {\n                var eventArgs = {\n                    style: { textAlign: args.item.iconCss.split(' e-')[1].split('-icon')[0] }, onActionUpdate: true\n                };\n                _this.parent.notify(setCellFormat, eventArgs);\n                if (!eventArgs.cancel) {\n                    _this.textAlignDdb.iconCss = \"e-icons e-\" + eventArgs.style.textAlign + \"-icon\";\n                    _this.textAlignDdb.dataBind();\n                }\n            },\n            close: function () { return _this.parent.element.focus(); }\n        });\n        this.textAlignDdb.createElement = this.parent.createElement;\n        this.textAlignDdb.appendTo(this.parent.createElement('button', { id: id + '_text_align' }));\n        return this.textAlignDdb.element;\n    };\n    Ribbon.prototype.getVerticalAlignDDB = function (id) {\n        var _this = this;\n        this.verticalAlignDdb = new DropDownButton({\n            cssClass: 'e-align-ddb',\n            iconCss: 'e-icons e-bottom-icon',\n            items: [{ iconCss: 'e-icons e-top-icon' }, { iconCss: 'e-icons e-middle-icon' }, { iconCss: 'e-icons e-bottom-icon' }],\n            beforeItemRender: this.alignItemRender.bind(this),\n            beforeOpen: function (args) {\n                _this.refreshSelected(_this.verticalAlignDdb, args.element, 'iconCss');\n            },\n            select: function (args) {\n                var eventArgs = {\n                    style: { verticalAlign: args.item.iconCss.split(' e-')[1].split('-icon')[0] }, onActionUpdate: true\n                };\n                _this.parent.notify(setCellFormat, eventArgs);\n                if (!eventArgs.cancel) {\n                    _this.verticalAlignDdb.iconCss = \"e-icons e-\" + eventArgs.style.verticalAlign + \"-icon\";\n                    _this.verticalAlignDdb.dataBind();\n                }\n            },\n            close: function () { return _this.parent.element.focus(); }\n        });\n        this.verticalAlignDdb.createElement = this.parent.createElement;\n        this.verticalAlignDdb.appendTo(this.parent.createElement('button', { id: id + '_vertical_align' }));\n        return this.verticalAlignDdb.element;\n    };\n    Ribbon.prototype.getSortFilterDDB = function (id) {\n        var _this = this;\n        var l10n = this.parent.serviceLocator.getService(locale);\n        this.sortingDdb = new DropDownButton({\n            cssClass: 'e-sort-filter-ddb',\n            iconCss: 'e-icons e-sort-filter-icon',\n            items: [\n                { text: l10n.getConstant('SortAscending'), iconCss: 'e-icons e-sort-asc' },\n                { text: l10n.getConstant('SortDescending'), iconCss: 'e-icons e-sort-desc' },\n                { text: l10n.getConstant('CustomSort') + '...', iconCss: 'e-icons e-sort-custom' },\n                { separator: true },\n                { text: l10n.getConstant('Filter'), iconCss: 'e-icons e-filter-apply', id: id + '_applyfilter' },\n                { text: l10n.getConstant('ClearAllFilter'), iconCss: 'e-icons e-filter-clear', id: id + '_clearfilter' },\n                { text: l10n.getConstant('ReapplyFilter'), iconCss: 'e-icons e-filter-reapply', id: id + '_reapplyfilter' }\n            ],\n            beforeItemRender: function (args) {\n                var eventArgs = { isFiltered: false, isClearAll: true };\n                _this.parent.notify(getFilteredColumn, eventArgs);\n                if (args.item.id === id + '_clearfilter' || args.item.id === id + '_reapplyfilter') {\n                    if (!eventArgs.isFiltered) {\n                        args.element.classList.add('e-disabled');\n                    }\n                    else {\n                        args.element.classList.remove('e-disabled');\n                    }\n                }\n            },\n            beforeOpen: function (args) {\n                _this.refreshSelected(_this.sortingDdb, args.element, 'iconCss');\n            },\n            select: function (args) {\n                switch (args.item.text) {\n                    case l10n.getConstant('Filter'):\n                        _this.parent.applyFilter();\n                        break;\n                    case l10n.getConstant('ClearAllFilter'):\n                        _this.parent.clearFilter();\n                        break;\n                    case l10n.getConstant('ReapplyFilter'):\n                        _this.parent.notify(reapplyFilter, null);\n                        break;\n                    case l10n.getConstant('CustomSort') + '...':\n                        _this.parent.notify(initiateCustomSort, null);\n                        break;\n                    default:\n                        var direction = args.item.text === l10n.getConstant('SortAscending') ? 'Ascending' : 'Descending';\n                        _this.parent.notify(applySort, { sortOptions: { sortDescriptors: { order: direction } } });\n                        break;\n                }\n            },\n            close: function () { return _this.parent.element.focus(); }\n        });\n        this.sortingDdb.createElement = this.parent.createElement;\n        this.sortingDdb.appendTo(this.parent.createElement('button', { id: id + '_sorting' }));\n        return this.sortingDdb.element;\n    };\n    Ribbon.prototype.ribbonCreated = function () {\n        if (this.parent.enableClipboard) {\n            this.enableRibbonItems([{ id: this.parent.element.id + '_paste', isEnable: false }]);\n        }\n        if (this.parent.allowUndoRedo) {\n            this.enableRibbonItems([{ id: this.parent.element.id + '_undo', isEnable: false },\n                { id: this.parent.element.id + '_redo', isEnable: false }]);\n        }\n        this.ribbon.element.querySelector('.e-drop-icon').title\n            = this.parent.serviceLocator.getService(locale).getConstant('CollapseToolbar');\n    };\n    Ribbon.prototype.alignItemRender = function (args) {\n        var text = args.item.iconCss.split(' e-')[1].split('-icon')[0];\n        text = text[0].toUpperCase() + text.slice(1, text.length);\n        args.element.title = this.parent.serviceLocator.getService(locale).getConstant('Align' + text);\n    };\n    Ribbon.prototype.toggleBtnClicked = function (e) {\n        var target = closest(e.target, '.e-btn');\n        var parentId = this.parent.element.id;\n        var id = target.id;\n        var property = setCellFormat;\n        var value;\n        var defaultModel;\n        var activeModel;\n        var eventArgs;\n        var key;\n        switch (id) {\n            case parentId + \"_bold\":\n                defaultModel = { fontWeight: 'normal' };\n                activeModel = { fontWeight: 'bold' };\n                key = 'fontWeight';\n                break;\n            case parentId + \"_italic\":\n                defaultModel = { fontStyle: 'normal' };\n                activeModel = { fontStyle: 'italic' };\n                key = 'fontStyle';\n                break;\n            case parentId + \"_line-through\":\n                property = textDecorationUpdate;\n                defaultModel = { textDecoration: 'line-through' };\n                activeModel = defaultModel;\n                key = 'textDecoration';\n                break;\n            case parentId + \"_underline\":\n                property = textDecorationUpdate;\n                defaultModel = { textDecoration: 'underline' };\n                activeModel = defaultModel;\n                key = 'textDecoration';\n                break;\n        }\n        if (target.classList.contains('e-active')) {\n            value = activeModel[key];\n            eventArgs = { style: activeModel, onActionUpdate: true };\n            this.parent.notify(property, eventArgs);\n            if (eventArgs.cancel) {\n                target.classList.remove('e-active');\n            }\n        }\n        else {\n            value = defaultModel[key];\n            eventArgs = { style: defaultModel, onActionUpdate: true };\n            this.parent.notify(property, eventArgs);\n            if (eventArgs.cancel) {\n                target.classList.add('e-active');\n            }\n        }\n        if (!eventArgs.cancel && value !== eventArgs.style[key]) {\n            this.refreshToggleBtn(getCellIndexes(this.parent.getActiveSheet().activeCell));\n        }\n        this.parent.element.focus();\n    };\n    Ribbon.prototype.getCellStyleValue = function (cssProp, indexes) {\n        var cell = getCell(indexes[0], indexes[1], this.parent.getActiveSheet());\n        var value = this.parent.cellStyle[cssProp];\n        if (cell && cell.style && cell.style[cssProp]) {\n            value = cell.style[cssProp];\n        }\n        return value;\n    };\n    Ribbon.prototype.refreshSelected = function (inst, element, key, itemKey) {\n        if (itemKey === void 0) { itemKey = key; }\n        for (var i = 0; i < inst.items.length; i++) {\n            if (inst.items[i][itemKey] === inst[key]) {\n                element.children[i].classList.add('e-selected');\n                break;\n            }\n        }\n    };\n    Ribbon.prototype.expandCollapseHandler = function (args) {\n        var target = this.ribbon.element.querySelector('.e-drop-icon');\n        var l10n = this.parent.serviceLocator.getService(locale);\n        if (args.expanded) {\n            target.title = l10n.getConstant('CollapseToolbar');\n        }\n        else {\n            target.title = l10n.getConstant('ExpandToolbar');\n        }\n        this.parent.setPanelSize();\n    };\n    Ribbon.prototype.getNumFormatDdbItems = function (id) {\n        var l10n = this.parent.serviceLocator.getService(locale);\n        return [\n            { id: id + 'item1', text: l10n.getConstant('General') },\n            { id: id + 'item2', text: l10n.getConstant('Number') },\n            { id: id + 'item3', text: l10n.getConstant('Currency') },\n            { id: id + 'item4', text: l10n.getConstant('Accounting') },\n            { id: id + 'item5', text: l10n.getConstant('ShortDate') },\n            { id: id + 'item6', text: l10n.getConstant('LongDate') },\n            { id: id + 'item7', text: l10n.getConstant('Time') },\n            { id: id + 'item8', text: l10n.getConstant('Percentage') },\n            { id: id + 'item9', text: l10n.getConstant('Fraction') },\n            { id: id + 'item10', text: l10n.getConstant('Scientific') },\n            { id: id + 'item11', text: l10n.getConstant('Text') }\n        ];\n    };\n    Ribbon.prototype.getFontFamilyItems = function () {\n        return [{ text: 'Arial' }, { text: 'Arial Black' }, { text: 'Axettac Demo' }, { text: 'Batang' }, { text: 'Book Antiqua' },\n            { text: 'Calibri', iconCss: 'e-icons e-selected-icon' }, { text: 'Courier' }, { text: 'Courier New' },\n            { text: 'Din Condensed' }, { text: 'Georgia' }, { text: 'Helvetica' }, { text: 'Helvetica New' }, { text: 'Roboto' },\n            { text: 'Tahoma' }, { text: 'Times New Roman' }, { text: 'Verdana' }];\n    };\n    Ribbon.prototype.enableToolbar = function (args) {\n        this.ribbon.enableItems(args.enable);\n    };\n    Ribbon.prototype.numDDBSelect = function (args) {\n        var eventArgs = {\n            format: getFormatFromType(args.item.text),\n            range: this.parent.getActiveSheet().selectedRange, cancel: false, requestType: 'NumberFormat'\n        };\n        var actionArgs = {\n            range: this.parent.getActiveSheet().name + '!' + eventArgs.range,\n            format: eventArgs.format, requestType: 'NumberFormat'\n        };\n        this.parent.trigger('beforeCellFormat', eventArgs);\n        this.parent.notify(beginAction, { eventArgs: eventArgs, action: 'format' });\n        if (eventArgs.cancel) {\n            return;\n        }\n        this.parent.notify(applyNumberFormatting, eventArgs);\n        this.parent.notify(selectionComplete, { type: 'mousedown' });\n        this.refreshNumFormatSelection(args.item.text);\n        this.parent.notify(completeAction, { eventArgs: actionArgs, action: 'format' });\n    };\n    Ribbon.prototype.tBarDdbBeforeOpen = function (args) {\n        var viewportHeight = this.parent.viewport.height;\n        var actualHeight = (parseInt(getComputedStyle(args.element.firstElementChild).height, 10) * args.items.length) +\n            (parseInt(getComputedStyle(args.element).paddingTop, 10) * 2);\n        if (actualHeight > viewportHeight) {\n            args.element.style.height = viewportHeight + \"px\";\n            args.element.style.overflowY = 'auto';\n        }\n    };\n    Ribbon.prototype.numDDBOpen = function (args) {\n        this.numPopupWidth = 0;\n        var elemList = args.element.querySelectorAll('span.e-numformat-preview-text');\n        for (var i = 0, len = elemList.length; i < len; i++) {\n            if (this.numPopupWidth < elemList[i].offsetWidth) {\n                this.numPopupWidth = elemList[i].offsetWidth;\n            }\n        }\n        var popWidth = this.numPopupWidth + 160;\n        document.querySelector('.e-numformat-ddb.e-dropdown-popup').style.width = popWidth + \"px\";\n    };\n    Ribbon.prototype.previewNumFormat = function (args) {\n        var cellIndex = getCellIndexes(this.parent.getActiveSheet().activeCell);\n        var cell = getCell(cellIndex[0], cellIndex[1], this.parent.getActiveSheet());\n        var eventArgs = {\n            type: args.item.text,\n            formattedText: '',\n            value: cell && cell.value ? cell.value : '',\n            format: getFormatFromType(args.item.text),\n            sheetIndex: this.parent.activeSheetTab,\n            onLoad: true\n        };\n        var numElem = this.parent.createElement('div', {\n            className: 'e-numformat-text',\n            styles: 'width:100%',\n            innerHTML: args.element.innerHTML\n        });\n        args.element.innerHTML = '';\n        this.parent.notify(getFormattedCellObject, eventArgs);\n        var previewElem = this.parent.createElement('span', {\n            className: 'e-numformat-preview-text',\n            styles: 'float:right;',\n            innerHTML: eventArgs.formattedText.toString()\n        });\n        numElem.appendChild(previewElem);\n        args.element.appendChild(numElem);\n    };\n    Ribbon.prototype.refreshRibbonContent = function () {\n        switch (this.activeTab) {\n            case 1:\n                this.refreshFirstTabContent(getCellIndexes(this.parent.getActiveSheet().activeCell));\n                break;\n            case 2:\n                // Second tab functionality comes here\n                break;\n            case 3:\n                // Third tab functionality comes here\n                break;\n            case 4:\n                this.refreshFourthTabContent();\n                break;\n        }\n    };\n    Ribbon.prototype.refreshFirstTabContent = function (indexes) {\n        if (!isNullOrUndefined(document.getElementById(this.parent.element.id + '_number_format'))) {\n            this.numFormatDDB = getComponent(document.getElementById(this.parent.element.id + '_number_format'), DropDownButton);\n        }\n        var actCell = getCellIndexes(this.parent.getActiveSheet().activeCell);\n        var l10n = this.parent.serviceLocator.getService(locale);\n        var cell = getCell(actCell[0], actCell[1], this.parent.getActiveSheet(), true);\n        cell = cell ? cell : {};\n        var type = getTypeFromFormat(cell.format ? cell.format : 'General');\n        if (this.numFormatDDB) {\n            this.refreshNumFormatSelection(l10n.getConstant(type));\n        }\n        if (this.fontNameDdb) {\n            this.refreshFontNameSelection(this.getCellStyleValue('fontFamily', indexes));\n        }\n        if (this.fontSizeDdb) {\n            var value = this.getCellStyleValue('fontSize', indexes).split('pt')[0];\n            if (value !== this.fontSizeDdb.content) {\n                this.fontSizeDdb.content = value;\n                this.fontSizeDdb.dataBind();\n            }\n        }\n        if (this.textAlignDdb) {\n            var value = \"e-icons e-\" + this.getCellStyleValue('textAlign', indexes).toLowerCase() + \"-icon\";\n            if (value !== this.textAlignDdb.iconCss) {\n                this.textAlignDdb.iconCss = value;\n                this.textAlignDdb.dataBind();\n            }\n        }\n        if (this.verticalAlignDdb) {\n            var value = \"e-icons e-\" + this.getCellStyleValue('verticalAlign', indexes).toLowerCase() + \"-icon\";\n            if (value !== this.verticalAlignDdb.iconCss) {\n                this.verticalAlignDdb.iconCss = value;\n                this.verticalAlignDdb.dataBind();\n            }\n        }\n        this.refreshToggleBtn(indexes);\n    };\n    Ribbon.prototype.refreshToggleBtn = function (indexes) {\n        var _this = this;\n        var btn;\n        var id = this.parent.element.id;\n        var value;\n        var fontProps = ['fontWeight', 'fontStyle', 'textDecoration', 'textDecoration'];\n        ['bold', 'italic', 'line-through', 'underline'].forEach(function (name, index) {\n            btn = document.getElementById(id + \"_\" + name);\n            if (btn) {\n                value = _this.getCellStyleValue(fontProps[index], indexes).toLowerCase();\n                if (value.indexOf(name) > -1) {\n                    btn.classList.add('e-active');\n                }\n                else {\n                    if (btn.classList.contains('e-active')) {\n                        btn.classList.remove('e-active');\n                    }\n                }\n            }\n        });\n    };\n    Ribbon.prototype.refreshFontNameSelection = function (fontFamily) {\n        if (fontFamily !== this.fontNameDdb.items[this.fontNameIndex].text) {\n            this.fontNameDdb.element.firstElementChild.textContent = fontFamily;\n            for (var i = 0; i < this.fontNameDdb.items.length; i++) {\n                if (this.fontNameDdb.items[i].text === fontFamily) {\n                    this.fontNameDdb.items[i].iconCss = 'e-icons e-selected-icon';\n                    this.fontNameDdb.items[this.fontNameIndex].iconCss = '';\n                    this.fontNameDdb.setProperties({ 'items': this.fontNameDdb.items }, true);\n                    this.fontNameIndex = i;\n                    break;\n                }\n            }\n        }\n    };\n    Ribbon.prototype.refreshNumFormatSelection = function (type) {\n        var l10n = this.parent.serviceLocator.getService(locale);\n        for (var i = 0; i < this.numFormatDDB.items.length; i++) {\n            if (this.numFormatDDB.items[i].iconCss !== '') {\n                this.numFormatDDB.items[i].iconCss = '';\n            }\n            if (this.numFormatDDB.items[i].text === type) {\n                this.numFormatDDB.items[i].iconCss = 'e-icons e-selected-icon';\n            }\n        }\n        this.numFormatDDB.element.firstElementChild.textContent = type;\n        this.numFormatDDB.setProperties({ 'items': this.numFormatDDB.items }, true);\n    };\n    Ribbon.prototype.fileItemSelect = function (args) {\n        var _this = this;\n        var selectArgs = extend({ cancel: false }, args);\n        this.parent.trigger('fileItemSelect', selectArgs);\n        if (!selectArgs.cancel) {\n            switch (args.item.id) {\n                case 'Open':\n                    this.parent.element.querySelector('#' + this.parent.element.id + '_fileUpload').click();\n                    break;\n                case 'Xlsx':\n                case 'Xls':\n                case 'Csv':\n                    this.parent.save({ saveType: args.item.id });\n                    break;\n                case 'New':\n                    var dialogInst_1 = this.parent.serviceLocator.getService(dialog);\n                    dialogInst_1.show({\n                        height: 200, width: 400, isModal: true, showCloseIcon: true,\n                        content: this.parent.serviceLocator.getService(locale).getConstant('DestroyAlert'),\n                        beforeOpen: function () { return _this.parent.element.focus(); },\n                        buttons: [{\n                                buttonModel: {\n                                    content: this.parent.serviceLocator.getService(locale).getConstant('Ok'), isPrimary: true\n                                },\n                                click: function () {\n                                    _this.parent.sheets.length = 0;\n                                    _this.parent.createSheet();\n                                    dialogInst_1.hide();\n                                    _this.parent.activeSheetTab = _this.parent.sheets.length;\n                                    _this.parent.setProperties({ 'activeSheetTab': _this.parent.sheets.length }, true);\n                                    _this.parent.notify(refreshSheetTabs, {});\n                                    _this.parent.notify(sheetsDestroyed, {});\n                                    _this.parent.renderModule.refreshSheet();\n                                }\n                            }]\n                    });\n                    break;\n            }\n        }\n    };\n    Ribbon.prototype.toolbarClicked = function (args) {\n        var parentId = this.parent.element.id;\n        var sheet = this.parent.getActiveSheet();\n        switch (args.item.id) {\n            case parentId + '_headers':\n                var evtHArgs = {\n                    isShow: !sheet.showHeaders,\n                    sheetIdx: this.parent.activeSheetTab,\n                    cancel: false\n                };\n                this.parent.notify(completeAction, { eventArgs: evtHArgs, action: 'headers' });\n                if (evtHArgs.cancel) {\n                    return;\n                }\n                sheet.showHeaders = !sheet.showHeaders;\n                this.parent.setProperties({ 'sheets': this.parent.sheets }, true);\n                this.parent.serviceLocator.getService('sheet').showHideHeaders();\n                this.toggleRibbonItems({ props: 'Headers', pos: 0 });\n                this.parent.element.focus();\n                break;\n            case parentId + '_gridlines':\n                var evtglArgs = {\n                    isShow: !sheet.showGridLines,\n                    sheetIdx: this.parent.activeSheetTab,\n                    cancel: false\n                };\n                this.parent.notify(completeAction, { eventArgs: evtglArgs, action: 'gridLines' });\n                if (evtglArgs.cancel) {\n                    return;\n                }\n                sheet.showGridLines = !sheet.showGridLines;\n                this.parent.setProperties({ 'sheets': this.parent.sheets }, true);\n                this.toggleRibbonItems({ props: 'GridLines', pos: 2 });\n                this.parent.element.focus();\n                break;\n            case parentId + '_undo':\n                this.parent.notify(performUndoRedo, { isUndo: true });\n                break;\n            case parentId + '_redo':\n                this.parent.notify(performUndoRedo, { isUndo: false });\n                break;\n        }\n        this.parent.notify(ribbonClick, args);\n    };\n    Ribbon.prototype.toggleRibbonItems = function (args) {\n        var text = this.getLocaleText(args.props, true);\n        this.ribbon.items[4].content[args.pos].text = text;\n        if (this.activeTab === 4) {\n            this.updateToggleText(args.props.toLowerCase(), text);\n        }\n    };\n    Ribbon.prototype.updateToggleText = function (item, text) {\n        var _this = this;\n        getUpdateUsingRaf(function () {\n            _this.ribbon.element.querySelector(\"#\" + _this.parent.element.id + \"_\" + item + \" .e-tbar-btn-text\").textContent = text;\n        });\n    };\n    Ribbon.prototype.refreshFourthTabContent = function () {\n        var _this = this;\n        var text;\n        var idx;\n        var sheet = this.parent.getActiveSheet();\n        var l10n = this.parent.serviceLocator.getService(locale);\n        var itemPos = [0, 2];\n        ['Headers', 'GridLines'].forEach(function (item, index) {\n            idx = itemPos[index];\n            if (sheet['show' + item]) {\n                if (_this.ribbon.items[4].content[idx].text === l10n.getConstant('Show' + item)) {\n                    _this.updateShowHideBtn('Hide', item, idx);\n                }\n            }\n            else {\n                if (_this.ribbon.items[4].content[idx].text === l10n.getConstant('Hide' + item)) {\n                    _this.updateShowHideBtn('Show', item, idx);\n                }\n            }\n        });\n    };\n    Ribbon.prototype.updateShowHideBtn = function (showHideText, item, idx) {\n        var l10n = this.parent.serviceLocator.getService(locale);\n        var text = l10n.getConstant(showHideText + item);\n        this.ribbon.items[4].content[idx].text = text;\n        this.ribbon.setProperties({ 'items': this.ribbon.items }, true);\n        this.updateToggleText(item.toLowerCase(), text);\n    };\n    Ribbon.prototype.enableRibbonItems = function (args) {\n        for (var i = 0, len = args.length; i < len; i++) {\n            var ele = document.getElementById(args[i].id);\n            if (ele) {\n                this.ribbon.enableItems(args[i].isEnable, closest(ele, '.e-toolbar-item'));\n            }\n        }\n    };\n    Ribbon.prototype.createMobileView = function () {\n        var _this = this;\n        var parentId = this.parent.element.id;\n        var toobar = this.parent.createElement('div', { className: 'e-header-toolbar' });\n        var menu = this.parent.createElement('ul');\n        toobar.appendChild(menu);\n        var toolbarObj = new Toolbar({\n            items: [\n                { prefixIcon: 'e-tick-icon', align: 'Left', id: parentId + 'focused_tick', cssClass: 'e-focused-tick' },\n                { template: menu, align: 'Right', id: parentId + 'file_menu' },\n            ],\n            clicked: function (args) {\n                switch (args.item.id) {\n                    case parentId + 'focused_tick':\n                        _this.parent.element.classList.remove('e-mobile-focused');\n                        _this.parent.renderModule.setSheetPanelSize();\n                        break;\n                }\n            },\n            created: function () {\n                var menuObj = new Menu({\n                    cssClass: 'e-mobile e-file-menu',\n                    enableRtl: true,\n                    showItemOnClick: true,\n                    items: _this.ribbon.items[0].menuItems,\n                    select: _this.fileItemSelect.bind(_this),\n                    beforeOpen: function (args) {\n                        args.element.parentElement.classList.remove('e-rtl');\n                        _this.fileMenuBeforeOpen(args);\n                    },\n                    beforeClose: _this.fileMenuBeforeClose.bind(_this)\n                });\n                menuObj.createElement = _this.parent.createElement;\n                menuObj.appendTo(menu);\n            }\n        });\n        toolbarObj.createElement = this.parent.createElement;\n        toolbarObj.appendTo(toobar);\n        this.parent.element.insertBefore(toobar, this.parent.element.firstElementChild);\n        this.renderMobileToolbar();\n    };\n    Ribbon.prototype.renderMobileToolbar = function () {\n        var _this = this;\n        var toolbarPanel = this.parent.createElement('div', { className: 'e-toolbar-panel e-ribbon' });\n        var toolbar = this.parent.createElement('div');\n        var ddb = this.parent.createElement('button');\n        toolbarPanel.appendChild(toolbar);\n        toolbarPanel.appendChild(ddb);\n        toolbarPanel.style.display = 'block';\n        this.parent.element.appendChild(toolbarPanel);\n        var ddbObj = new DropDownButton({\n            cssClass: 'e-caret-hide',\n            content: this.ribbon.items[1].header.text,\n            items: [\n                { text: this.ribbon.items[1].header.text },\n                { text: this.ribbon.items[2].header.text },\n                { text: this.ribbon.items[3].header.text },\n                { text: this.ribbon.items[4].header.text }\n            ],\n            select: function (args) {\n                if (args.item.text !== ddbObj.content) {\n                    toolbarObj.element.style.display = 'none';\n                    ddbObj.content = args.item.text;\n                    ddbObj.dataBind();\n                    toolbarObj.items = _this.ribbon.items[ddbObj.items.indexOf(args.item) + 1].content;\n                    toolbarObj.width = \"calc(100% - \" + ddb.getBoundingClientRect().width + \"px)\";\n                    toolbarObj.element.style.display = '';\n                    toolbarObj.dataBind();\n                    toolbarObj.items[0].text = args.item.text;\n                    toolbarObj.dataBind();\n                }\n            },\n            open: function (args) {\n                var element = args.element.parentElement;\n                var clientRect = element.getBoundingClientRect();\n                var offset = calculatePosition(ddbObj.element, 'right', 'bottom');\n                element.style.left = offset.left - clientRect.width + \"px\";\n                element.style.top = offset.top - clientRect.height + \"px\";\n                for (var i = 0; i < ddbObj.items.length; i++) {\n                    if (ddbObj.content === ddbObj.items[i].text) {\n                        args.element.children[i].classList.add('e-selected');\n                        break;\n                    }\n                }\n            },\n            close: function () { return _this.parent.element.focus(); }\n        });\n        ddbObj.createElement = this.parent.createElement;\n        ddbObj.appendTo(ddb);\n        var toolbarObj = new Toolbar({\n            width: \"calc(100% - \" + ddb.getBoundingClientRect().width + \"px)\",\n            items: this.ribbon.items[1].content,\n            clicked: this.toolbarClicked.bind(this)\n        });\n        toolbarObj.createElement = this.parent.createElement;\n        toolbarObj.appendTo(toolbar);\n        toolbarPanel.style.display = '';\n    };\n    Ribbon.prototype.fileMenuBeforeOpen = function (args) {\n        var _this = this;\n        var l10n = this.parent.serviceLocator.getService(locale);\n        var wrapper;\n        var contents = ['.xlsx', '.xls', '.csv'];\n        if (args.parentItem.text === l10n.getConstant('SaveAs')) {\n            [].slice.call(args.element.children).forEach(function (li, index) {\n                wrapper = _this.parent.createElement('div', { innerHTML: li.innerHTML });\n                li.innerHTML = '';\n                wrapper.appendChild(_this.parent.createElement('span', { className: 'e-extension', innerHTML: contents[index] }));\n                li.appendChild(wrapper);\n            });\n        }\n        this.parent.trigger('fileMenuBeforeOpen', args);\n    };\n    Ribbon.prototype.fileMenuBeforeClose = function (args) {\n        this.parent.trigger('fileMenuBeforeClose', args);\n    };\n    Ribbon.prototype.addEventListener = function () {\n        this.parent.on(ribbon, this.initRibbon, this);\n        this.parent.on(enableRibbonItems, this.enableRibbonItems, this);\n        this.parent.on(activeCellChanged, this.refreshRibbonContent, this);\n        this.parent.on(enableToolbar, this.enableToolbar, this);\n        this.parent.on(updateToggleItem, this.toggleRibbonItems, this);\n    };\n    Ribbon.prototype.destroy = function () {\n        var parentElem = this.parent.element;\n        var ribbonEle = this.ribbon.element;\n        var id = parentElem.id;\n        destroyComponent(parentElem.querySelector('#' + id + '_paste'), SplitButton);\n        destroyComponent(parentElem.querySelector('#' + id + '_number_format'), DropDownButton);\n        destroyComponent(parentElem.querySelector('#' + id + '_font_size'), DropDownButton);\n        destroyComponent(parentElem.querySelector('#' + id + '_font_name'), DropDownButton);\n        destroyComponent(parentElem.querySelector('#' + id + '_text_align'), DropDownButton);\n        destroyComponent(parentElem.querySelector('#' + id + '_vertical_align'), DropDownButton);\n        destroyComponent(parentElem.querySelector('#' + id + '_sorting'), DropDownButton);\n        ['bold', 'italic', 'line-through', 'underline'].forEach(function (name) {\n            destroyComponent(parentElem.querySelector('#' + (id + \"_\" + name)), Button);\n        });\n        this.ribbon.destroy();\n        if (ribbonEle) {\n            detach(ribbonEle);\n        }\n        this.ribbon = null;\n        this.removeEventListener();\n    };\n    Ribbon.prototype.removeEventListener = function () {\n        if (!this.parent.isDestroyed) {\n            this.parent.off(ribbon, this.initRibbon);\n            this.parent.off(enableRibbonItems, this.enableRibbonItems);\n            this.parent.off(activeCellChanged, this.refreshRibbonContent);\n            this.parent.off(enableToolbar, this.enableToolbar);\n            this.parent.off(updateToggleItem, this.toggleRibbonItems);\n        }\n    };\n    return Ribbon;\n}());\nexport { Ribbon };\n","import { formulaBar, locale, selectionComplete } from '../common/index';\nimport { mouseUpAfterSelection, click } from '../common/index';\nimport { getRangeIndexes, getRangeFromAddress } from './../../workbook/common/address';\nimport { getSheetName, getTypeFromFormat, getSheet } from '../../workbook/index';\nimport { updateSelectedRange, getSheetNameFromAddress, getSheetIndex } from '../../workbook/index';\nimport { ComboBox, DropDownList } from '@syncfusion/ej2-dropdowns';\nimport { rippleEffect, EventHandler, detach, Internationalization, isNullOrUndefined, closest } from '@syncfusion/ej2-base';\nimport { editOperation, formulaBarOperation, keyDown, keyUp, formulaOperation } from '../common/event';\nimport { intToDate } from '../../workbook/common/math';\nimport { ListView } from '@syncfusion/ej2-lists';\nimport { workbookFormulaOperation } from '../../workbook/common/event';\n/**\n * Represents Formula bar for Spreadsheet.\n */\nvar FormulaBar = /** @class */ (function () {\n    function FormulaBar(parent) {\n        this.categoryCollection = [];\n        this.formulaCollection = [];\n        this.parent = parent;\n        this.addEventListener();\n    }\n    FormulaBar.prototype.getModuleName = function () {\n        return 'formulaBar';\n    };\n    FormulaBar.prototype.createFormulaBar = function (args) {\n        if (!this.parent.showFormulaBar && this.insertFnRipple) {\n            this.destroy();\n            return;\n        }\n        var l10n = this.parent.serviceLocator.getService(locale);\n        var id = this.parent.element.id;\n        var fBarWrapper = this.parent.createElement('div', { className: 'e-formula-bar-panel' });\n        if (!this.parent.isMobileView()) {\n            var nameBox = this.parent.createElement('input', { id: id + '_name_box', attrs: { type: 'text' } });\n            fBarWrapper.appendChild(nameBox);\n            this.comboBoxInstance = new ComboBox({\n                value: 'A1',\n                cssClass: 'e-name-box',\n                width: '',\n                noRecordsTemplate: '',\n                fields: { text: 'name', value: 'refersTo' },\n                beforeOpen: this.nameBoxBeforeOpen.bind(this),\n                blur: this.nameBoxBlur.bind(this),\n                select: this.nameBoxSelect.bind(this),\n                change: function (args) {\n                    /** */\n                }\n            });\n            this.comboBoxInstance.createElement = this.parent.createElement;\n            this.comboBoxInstance.appendTo(nameBox);\n            this.comboBoxInstance.element.parentElement.title = l10n.getConstant('NameBox');\n        }\n        var insertFnBtn = fBarWrapper.appendChild(this.parent.createElement('button', {\n            className: 'e-btn e-css e-flat e-icon-btn e-insert-function', attrs: { 'title': l10n.getConstant('InsertFunction') }\n        }));\n        insertFnBtn.appendChild(this.parent.createElement('span', { className: 'e-btn-icon e-icons' }));\n        this.insertFnRipple = rippleEffect(fBarWrapper, { selector: '.e-insert-function' });\n        fBarWrapper.appendChild(this.parent.createElement('div', { className: 'e-separator' }));\n        var textarea = fBarWrapper.appendChild(this.parent.createElement('textarea', {\n            className: 'e-formula-bar e-css', id: id + '_formula_input',\n            attrs: { 'title': l10n.getConstant('FormulaBar'), 'spellcheck': 'false' }\n        }));\n        textarea.rows = 1;\n        if (this.parent.isMobileView()) {\n            textarea.placeholder = l10n.getConstant('MobileFormulaBarPlaceHolder');\n            EventHandler.add(textarea, 'focus', this.textAreaFocusIn, this);\n            EventHandler.add(textarea, 'blur', this.textAreaFocusOut, this);\n        }\n        else {\n            fBarWrapper.appendChild(this.parent.createElement('span', {\n                className: 'e-drop-icon e-icons', attrs: { 'title': l10n.getConstant('ExpandFormulaBar') }\n            }));\n        }\n        if (args && args.uiUpdate) {\n            this.parent.element.insertBefore(fBarWrapper, document.getElementById(id + '_sheet_panel'));\n        }\n        else {\n            this.parent.element.appendChild(fBarWrapper);\n        }\n    };\n    FormulaBar.prototype.textAreaFocusIn = function (e) {\n        var formulaPanel = this.parent.element.querySelector('.e-formula-bar-panel');\n        var tickBtn = this.parent.createElement('button', { className: 'e-btn e-css e-flat e-icon-btn e-formula-submit' });\n        tickBtn.appendChild(this.parent.createElement('span', { className: 'e-btn-icon e-icons e-tick-icon' }));\n        formulaPanel.classList.add('e-focused');\n        formulaPanel.appendChild(tickBtn);\n    };\n    FormulaBar.prototype.textAreaFocusOut = function (e) {\n        var formulaPanel = this.parent.element.querySelector('.e-formula-bar-panel');\n        formulaPanel.classList.remove('e-focused');\n        detach(formulaPanel.querySelector('.e-formula-submit'));\n    };\n    FormulaBar.prototype.keyDownHandler = function (e) {\n        var trgtElem = e.target;\n        if (this.parent.isEdit) {\n            if (trgtElem.classList.contains('e-formula-bar')) {\n                this.parent.notify(editOperation, { action: 'refreshEditor', value: trgtElem.value, refreshEditorElem: true });\n            }\n        }\n    };\n    FormulaBar.prototype.keyUpHandler = function (e) {\n        if (this.parent.isEdit) {\n            var trgtElem = e.target;\n            if (trgtElem.classList.contains('e-formula-bar')) {\n                var eventArg = { action: 'getCurrentEditValue', editedValue: '' };\n                this.parent.notify(editOperation, eventArg);\n                if (eventArg.editedValue !== trgtElem.value) {\n                    this.parent.notify(editOperation, { action: 'refreshEditor', value: trgtElem.value, refreshEditorElem: true });\n                }\n            }\n        }\n    };\n    FormulaBar.prototype.nameBoxBeforeOpen = function (args) {\n        if (this.comboBoxInstance.element.classList.contains('e-name-editing')) {\n            args.cancel = true;\n        }\n        else {\n            this.comboBoxInstance.element.select();\n        }\n    };\n    FormulaBar.prototype.nameBoxBlur = function (args) {\n        if (this.comboBoxInstance.element.classList.contains('e-name-editing')) {\n            this.comboBoxInstance.element.classList.remove('e-name-editing');\n            this.UpdateValueAfterMouseUp();\n        }\n    };\n    FormulaBar.prototype.nameBoxSelect = function (args) {\n        if (args.isInteracted) {\n            var refersTo = args.itemData.refersTo.substr(1);\n            var sheetIdx = getSheetIndex(this.parent, getSheetNameFromAddress(refersTo));\n            var range = getRangeFromAddress(refersTo);\n            var sheet = getSheet(this.parent, sheetIdx);\n            if ((sheetIdx + 1) === this.parent.activeSheetTab) {\n                this.parent.selectRange(range);\n                this.parent.element.focus();\n            }\n            else {\n                updateSelectedRange(this.parent, range, sheet);\n                this.parent.activeSheetTab = sheetIdx + 1;\n            }\n        }\n    };\n    FormulaBar.prototype.formulaBarUpdateHandler = function (e) {\n        var _this = this;\n        var range = this.parent.getActiveSheet().selectedRange.split(':');\n        var address;\n        var intl = new Internationalization();\n        if (e.type === 'mousemove' || e.type === 'pointermove') {\n            var indexes1 = getRangeIndexes(range[0]);\n            var indexes2 = getRangeIndexes(range[1]);\n            address = Math.abs(indexes1[0] - indexes2[0]) + 1 + \"R x \" + (Math.abs(indexes1[1] - indexes2[1]) + 1) + \"C\";\n        }\n        else {\n            address = range[0];\n            var data = this.parent.getData(getSheetName(this.parent) + \"!\" + address);\n            data.then(function (values) {\n                var value = '';\n                var intDate;\n                values.forEach(function (cell, key) {\n                    var type = cell && cell.format ? getTypeFromFormat(cell.format) : 'General';\n                    if (cell) {\n                        if (!isNullOrUndefined(cell.value)) {\n                            intDate = intToDate(Number(cell.value));\n                            if (intDate.toString() !== 'Invalid Date' && (type === 'ShortDate' || type === 'LongDate')) {\n                                value = intl.formatDate(intDate, {\n                                    type: 'date',\n                                    skeleton: 'yMd'\n                                });\n                            }\n                            else if (intDate.toString() !== 'Invalid Date' && type === 'Time') {\n                                value = intl.formatDate(intDate, {\n                                    type: 'dateTime',\n                                    skeleton: 'yMd'\n                                }) + ' ' + intl.formatDate(intDate, {\n                                    type: 'dateTime',\n                                    skeleton: 'hms'\n                                });\n                            }\n                            else {\n                                value = cell.value;\n                            }\n                        }\n                        if (cell.formula) {\n                            value = cell.formula;\n                        }\n                    }\n                    document.getElementById(_this.parent.element.id + '_formula_input').value = value;\n                });\n            });\n        }\n        this.updateComboBoxValue(address);\n    };\n    FormulaBar.prototype.UpdateValueAfterMouseUp = function () {\n        this.updateComboBoxValue(this.parent.getActiveSheet().selectedRange.split(':')[0]);\n    };\n    FormulaBar.prototype.updateComboBoxValue = function (value) {\n        var sheet = this.parent.getActiveSheet();\n        var range = getSheetName(this.parent) + '!' + sheet.selectedRange;\n        var eventArgs = {\n            action: 'getNameFromRange', range: range, definedName: null\n        };\n        this.parent.notify(formulaOperation, eventArgs);\n        if (eventArgs.definedName) {\n            value = eventArgs.definedName.name;\n        }\n        if (!this.parent.isMobileView()) {\n            if (this.comboBoxInstance.text === value) {\n                return;\n            }\n            this.comboBoxInstance.text = value;\n            this.comboBoxInstance.dataBind();\n        }\n    };\n    FormulaBar.prototype.clickHandler = function (e) {\n        var _this = this;\n        var target = e.target;\n        if (target.classList.contains('e-drop-icon') && closest(target, '.e-formula-bar-panel')) {\n            this.toggleFormulaBar(target);\n        }\n        else if (target.classList.contains('e-formula-bar')) {\n            if (!this.parent.isEdit) {\n                this.parent.notify(editOperation, { action: 'startEdit', refreshCurPos: false });\n            }\n        }\n        else if (target.parentElement.classList.contains('e-name-box')) {\n            if (target.classList.contains('e-ddl-icon')) {\n                var eventArgs = { action: 'getNames', names: [] };\n                this.parent.notify(formulaOperation, eventArgs);\n                this.comboBoxInstance.dataSource = eventArgs.names;\n            }\n            else {\n                this.comboBoxInstance.element.classList.add('e-name-editing');\n                this.comboBoxInstance.element.select();\n            }\n        }\n        if (!isNullOrUndefined(target.offsetParent) && ((target.offsetParent.classList.contains('e-insert-function')) ||\n            (target.classList.contains('e-insert-function')) || (this.parent.element.id + '_insert_function' === target.offsetParent.id) ||\n            (this.parent.element.id + '_insert_function' === target.id) || target.parentElement.classList.contains('e-insert-function') ||\n            (this.parent.element.id + '_insert_function' === target.parentElement.id))) {\n            var isOpen = !this.parent.isEdit;\n            var args = { action: 'getCurrentEditValue', editedValue: '' };\n            if (!isOpen) {\n                var eventArgs = { action: 'isFormulaEditing', isFormulaEdit: false };\n                this.parent.notify(formulaOperation, eventArgs);\n                isOpen = eventArgs.isFormulaEdit;\n                this.parent.notify(editOperation, args);\n            }\n            if (isOpen || args.editedValue === '') {\n                if (args.editedValue === '') {\n                    this.parent.notify(editOperation, { action: 'refreshEditor', value: '=' });\n                }\n                var l10n = this.parent.serviceLocator.getService(locale);\n                var formulaDescription = this.parent.createElement('div', { className: 'e-formula-description', id: this.parent.element.id + '_description_content' });\n                var categoryContent = this.parent.createElement('div', {\n                    className: 'e-category-content', id: this.parent.element.id + '_category_content',\n                    innerHTML: l10n.getConstant('PickACategory')\n                });\n                var dropDownElement = this.parent.createElement('input', { className: 'e-formula-category', id: this.parent.element.id + '_formula_category' });\n                var listViewElement = this.parent.createElement('div', { className: 'e-formula-list', id: this.parent.element.id + '_formula_list' });\n                var descriptionContent = this.parent.createElement('div', { className: 'e-description-content', innerHTML: l10n.getConstant('Description') });\n                var headerContent = this.parent.createElement('div', { className: 'e-header-content', innerHTML: l10n.getConstant('InsertFunction') });\n                var categoryArgs = {\n                    action: 'getFormulaCategory', categoryCollection: []\n                };\n                this.parent.notify(workbookFormulaOperation, categoryArgs);\n                this.categoryCollection = categoryArgs.categoryCollection;\n                this.categoryList = new DropDownList({\n                    dataSource: this.categoryCollection, index: 0, width: '285px', popupHeight: '210px',\n                    select: this.dropDownSelect.bind(this)\n                });\n                var listArgs = {\n                    action: 'getLibraryFormulas', formulaCollection: []\n                };\n                this.parent.notify(workbookFormulaOperation, listArgs);\n                this.formulaCollection = listArgs.formulaCollection;\n                this.formulaList = new ListView({\n                    dataSource: this.formulaCollection.sort(),\n                    actionComplete: this.updateFormulaList.bind(this),\n                    select: this.listSelected.bind(this), width: '285px', height: '200px'\n                });\n                this.dialog = this.parent.serviceLocator.getService('dialog');\n                this.dialog.show({\n                    header: headerContent.outerHTML,\n                    content: categoryContent.outerHTML + dropDownElement.outerHTML + listViewElement.outerHTML +\n                        descriptionContent.outerHTML + formulaDescription.outerHTML,\n                    width: '320px', height: '485px', cssClass: 'e-spreadsheet-function-dlg',\n                    showCloseIcon: true, isModal: true,\n                    beforeOpen: function () { return _this.parent.element.focus(); },\n                    open: this.dialogOpen.bind(this),\n                    beforeClose: this.dialogBeforeClose.bind(this),\n                    close: this.dialogClose.bind(this),\n                    buttons: [\n                        {\n                            click: (this.selectFormula.bind(this, this.dialog, this)), buttonModel: { content: 'OK', isPrimary: true }\n                        }\n                    ]\n                });\n                this.categoryList.appendTo('#' + this.parent.element.id + '_formula_category');\n                this.formulaList.appendTo('#' + this.parent.element.id + '_formula_list');\n                EventHandler.add(this.formulaList.element, 'dblclick', this.formulaClickHandler, this);\n            }\n        }\n    };\n    FormulaBar.prototype.toggleFormulaBar = function (target) {\n        var parent = target.parentElement;\n        var l10n = this.parent.serviceLocator.getService(locale);\n        if (parent.classList.contains('e-expanded')) {\n            parent.classList.remove('e-expanded');\n            document.getElementById(this.parent.element.id + '_formula_input').rows = 1;\n            target.title = l10n.getConstant('ExpandFormulaBar');\n        }\n        else {\n            parent.classList.add('e-expanded');\n            document.getElementById(this.parent.element.id + '_formula_input').rows = 3;\n            target.title = l10n.getConstant('CollapseFormulaBar');\n        }\n        this.parent.setPanelSize();\n    };\n    FormulaBar.prototype.dialogOpen = function () {\n        this.focusOkButton();\n    };\n    FormulaBar.prototype.dialogClose = function () {\n        var args = { action: 'getCurrentEditValue', editedValue: '' };\n        this.parent.notify(editOperation, args);\n        if (args.editedValue.toString().trim() === '=') {\n            this.parent.notify(editOperation, { action: 'refreshEditor', value: '' });\n        }\n    };\n    FormulaBar.prototype.dialogBeforeClose = function () {\n        EventHandler.remove(this.formulaList.element, 'dblclick', this.formulaClickHandler);\n        var dialogContentEle = document.getElementById('_dialog-content');\n        dialogContentEle.parentNode.removeChild(dialogContentEle);\n        /* tslint:disable-next-line:no-any */\n        this.dialog.dialogInstance.storeActiveElement = document.getElementById(this.parent.element.id + '_edit');\n    };\n    FormulaBar.prototype.selectFormula = function (dialog, formulaBarObj) {\n        var formulaText = formulaBarObj.formulaList.getSelectedItems().text;\n        var sheet = getSheet(this.parent, this.parent.activeSheetTab - 1);\n        if (this.parent.isEdit) {\n            this.parent.notify(editOperation, {\n                action: 'refreshEditor', value: formulaText + '(', refreshFormulaBar: true,\n                refreshEditorElem: true, isAppend: true\n            });\n        }\n        else {\n            this.parent.notify(editOperation, { action: 'startEdit', value: '=' + formulaText + '(', address: sheet.activeCell });\n            this.parent.notify(formulaBarOperation, { action: 'refreshFormulabar', value: '=' + formulaText + '(' });\n        }\n        dialog.hide();\n    };\n    FormulaBar.prototype.listSelected = function () {\n        this.updateFormulaDescription();\n    };\n    FormulaBar.prototype.updateFormulaList = function () {\n        this.activeListFormula();\n        this.updateFormulaDescription();\n    };\n    FormulaBar.prototype.dropDownSelect = function (args) {\n        this.formulaCollection = [];\n        var listArgs = {\n            action: 'getLibraryFormulas',\n            formulaCollection: []\n        };\n        if (args.item.textContent === 'All') {\n            this.parent.notify(workbookFormulaOperation, listArgs);\n            this.formulaCollection = listArgs.formulaCollection;\n        }\n        else {\n            var category = args.item.textContent;\n            var selectArgs = {\n                action: 'dropDownSelectFormulas',\n                formulaCollection: [],\n                selectCategory: category,\n            };\n            this.parent.notify(workbookFormulaOperation, selectArgs);\n            this.formulaCollection = selectArgs.formulaCollection;\n        }\n        this.formulaList.dataSource = this.formulaCollection.sort();\n    };\n    FormulaBar.prototype.focusOkButton = function () {\n        var focusEle = document.getElementById('_dialog-content');\n        (focusEle.nextElementSibling.firstElementChild).focus();\n    };\n    FormulaBar.prototype.activeListFormula = function () {\n        var acListEle = document.getElementById(this.parent.element.id + '_formula_list');\n        var firstElement = acListEle.children[0].children[0].firstElementChild;\n        this.formulaList.selectItem(firstElement);\n    };\n    FormulaBar.prototype.updateFormulaDescription = function () {\n        var descriptionArea;\n        var selectedFormula = this.formulaList.getSelectedItems().text;\n        var descriptionArgs = {\n            action: 'getFormulaDescription',\n            description: '',\n            selectedList: selectedFormula,\n        };\n        this.parent.notify(workbookFormulaOperation, descriptionArgs);\n        this.focusOkButton();\n        descriptionArea = document.getElementById(this.parent.element.id + '_description_content');\n        selectedFormula = (selectedFormula === 'AND') ? 'CalculateAND' : (selectedFormula === 'OR') ? 'CalculateOR' : selectedFormula;\n        descriptionArea.innerHTML = this.parent.serviceLocator.getService(locale).getConstant(selectedFormula);\n    };\n    FormulaBar.prototype.formulaClickHandler = function (args) {\n        var trgtElem = args.target;\n        var sheet = getSheet(this.parent, this.parent.activeSheetTab - 1);\n        if (trgtElem.offsetParent.classList.contains('e-text-content') || trgtElem.classList.contains('e-list-item')) {\n            if (this.parent.isEdit) {\n                this.parent.notify(editOperation, {\n                    action: 'refreshEditor', value: trgtElem.innerText + '(', refreshFormulaBar: true,\n                    refreshEditorElem: true, isAppend: true\n                });\n            }\n            else {\n                this.parent.notify(editOperation, { action: 'startEdit', value: '=' + trgtElem.innerText + '(', address: sheet.activeCell });\n                this.parent.notify(formulaBarOperation, { action: 'refreshFormulabar', value: '=' + trgtElem.innerText + '(' });\n            }\n            this.dialog.hide();\n        }\n    };\n    FormulaBar.prototype.addEventListener = function () {\n        this.parent.on(formulaBar, this.createFormulaBar, this);\n        this.parent.on(click, this.clickHandler, this);\n        this.parent.on(keyDown, this.keyDownHandler, this);\n        this.parent.on(keyUp, this.keyUpHandler, this);\n        this.parent.on(selectionComplete, this.formulaBarUpdateHandler, this);\n        this.parent.on(mouseUpAfterSelection, this.UpdateValueAfterMouseUp, this);\n        this.parent.on(formulaBarOperation, this.editOperationHandler, this);\n    };\n    FormulaBar.prototype.destroy = function () {\n        this.removeEventListener();\n        this.comboBoxInstance.destroy();\n        this.comboBoxInstance = null;\n        this.insertFnRipple();\n        this.insertFnRipple = null;\n        var formulaPanel = this.parent.element.querySelector('.e-formula-bar-panel');\n        if (formulaPanel) {\n            detach(formulaPanel);\n        }\n    };\n    FormulaBar.prototype.removeEventListener = function () {\n        if (!this.parent.isDestroyed) {\n            this.parent.off(formulaBar, this.createFormulaBar);\n            this.parent.off(click, this.clickHandler);\n            this.parent.off(keyDown, this.keyDownHandler);\n            this.parent.off(keyUp, this.keyUpHandler);\n            this.parent.off(selectionComplete, this.formulaBarUpdateHandler);\n            this.parent.off(mouseUpAfterSelection, this.UpdateValueAfterMouseUp);\n            this.parent.off(formulaBarOperation, this.editOperationHandler);\n        }\n    };\n    FormulaBar.prototype.editOperationHandler = function (args) {\n        var action = args.action;\n        switch (action) {\n            case 'refreshFormulabar':\n                this.getFormulaBar().value = args.value;\n                break;\n            case 'getPosition':\n                args.position = this.getFormulaBar().getBoundingClientRect();\n                break;\n        }\n    };\n    FormulaBar.prototype.getFormulaBar = function () {\n        return this.parent.element.querySelector('#' + this.parent.element.id + '_formula_input');\n    };\n    return FormulaBar;\n}());\nexport { FormulaBar };\n","import { formulaOperation, keyUp, keyDown, click } from '../common/event';\nimport { editOperation, formulaBarOperation } from '../common/event';\nimport { workbookFormulaOperation } from '../../workbook/common/event';\nimport { AutoComplete } from '@syncfusion/ej2-dropdowns';\nimport { detach, isNullOrUndefined } from '@syncfusion/ej2-base';\nimport { checkIsFormula, getSheet, getSheetName } from '../../workbook/index';\nimport { dialog, locale } from '../common/index';\n/**\n * @hidden\n * The `Formula` module is used to handle the formulas and its functionalities in Spreadsheet.\n */\nvar Formula = /** @class */ (function () {\n    /**\n     * Constructor for formula module in Spreadsheet.\n     * @private\n     */\n    function Formula(parent) {\n        this.isFormulaBar = false;\n        this.isFormula = false;\n        this.isPopupOpened = false;\n        this.isPreventClose = false;\n        this.isSubFormula = false;\n        this.keyCodes = {\n            UP: 38,\n            DOWN: 40,\n            LEFT: 37,\n            RIGHT: 39,\n            FIRSTALPHABET: 65,\n            LASTALPHABET: 90,\n            SPACE: 32,\n            BACKSPACE: 8,\n            TAB: 9,\n            DELETE: 46,\n            ENTER: 13,\n            ESC: 27\n        };\n        this.parent = parent;\n        this.addEventListener();\n        //Spreadsheet.Inject(WorkbookFormula);\n    }\n    /**\n     * Get the module name.\n     * @returns string\n     * @private\n     */\n    Formula.prototype.getModuleName = function () {\n        return 'formula';\n    };\n    /**\n     * To destroy the formula module.\n     * @return {void}\n     * @hidden\n     */\n    Formula.prototype.destroy = function () {\n        this.removeEventListener();\n        if (this.autocompleteInstance) {\n            this.autocompleteInstance.destroy();\n        }\n        this.autocompleteInstance = null;\n        this.parent = null;\n    };\n    Formula.prototype.addEventListener = function () {\n        this.parent.on(formulaOperation, this.performFormulaOperation, this);\n        this.parent.on(keyUp, this.keyUpHandler, this);\n        this.parent.on(keyDown, this.keyDownHandler, this);\n        this.parent.on(click, this.clickHandler, this);\n    };\n    Formula.prototype.removeEventListener = function () {\n        if (!this.parent.isDestroyed) {\n            this.parent.off(formulaOperation, this.performFormulaOperation);\n            this.parent.off(keyUp, this.keyUpHandler);\n            this.parent.off(keyDown, this.keyDownHandler);\n            this.parent.off(click, this.clickHandler);\n        }\n    };\n    Formula.prototype.performFormulaOperation = function (args) {\n        var action = args.action;\n        switch (action) {\n            case 'renderAutoComplete':\n                this.renderAutoComplete();\n                break;\n            case 'endEdit':\n                this.endEdit();\n                break;\n            case 'addDefinedName':\n                this.addDefinedName(args.definedName);\n                break;\n            case 'getNames':\n                if (!args.sheetName) {\n                    args.sheetName = getSheetName(this.parent);\n                }\n                args.names = this.getNames(args.sheetName);\n                break;\n            case 'getNameFromRange':\n                args.definedName = this.getNameFromRange(args.range);\n                break;\n            case 'isFormulaEditing':\n                args.isFormulaEdit = this.isFormula;\n                break;\n            case 'isCircularReference':\n                var l10n = this.parent.serviceLocator.getService(locale);\n                var dialogInst = this.parent.serviceLocator.getService(dialog);\n                dialogInst.show({\n                    height: 180, width: 400, isModal: true, showCloseIcon: true,\n                    content: l10n.getConstant('CircularReference'),\n                });\n                args.argValue = '0';\n                break;\n        }\n    };\n    Formula.prototype.renderAutoComplete = function () {\n        if (!this.parent.element.querySelector('#' + this.parent.element.id + '_ac')) {\n            var acElem = this.parent.createElement('input', { id: this.parent.element.id + '_ac', className: 'e-ss-ac' });\n            this.parent.element.appendChild(acElem);\n            var eventArgs = {\n                action: 'getLibraryFormulas',\n                formulaCollection: []\n            };\n            this.parent.notify(workbookFormulaOperation, eventArgs);\n            var autoCompleteOptions = {\n                dataSource: eventArgs.formulaCollection,\n                cssClass: 'e-ss-atc',\n                popupWidth: '130px',\n                allowFiltering: true,\n                filterType: 'StartsWith',\n                sortOrder: 'Ascending',\n                open: this.onSuggestionOpen.bind(this),\n                close: this.onSuggestionClose.bind(this),\n                select: this.onSelect.bind(this),\n                actionComplete: this.onSuggestionComplete.bind(this)\n            };\n            this.autocompleteInstance = new AutoComplete(autoCompleteOptions, acElem);\n            this.autocompleteInstance.createElement = this.parent.createElement;\n        }\n    };\n    Formula.prototype.onSuggestionOpen = function (e) {\n        var _this = this;\n        this.isPopupOpened = true;\n        var position = this.getPopupPosition();\n        e.popup.offsetX = position.left;\n        e.popup.offsetY = (position.top + position.height);\n        e.popup.refreshPosition();\n        e.popup.element.firstChild.style.maxHeight = '180px';\n        new Promise(function (resolve, reject) {\n            setTimeout(function () { resolve(); }, 100);\n        }).then(function () {\n            _this.triggerKeyDownEvent(_this.keyCodes.DOWN);\n        });\n    };\n    Formula.prototype.onSuggestionClose = function (e) {\n        if (this.isPreventClose) {\n            e.cancel = true;\n        }\n        else {\n            this.isPopupOpened = false;\n        }\n    };\n    Formula.prototype.onSelect = function (e) {\n        var updatedFormulaValue = '=' + e.itemData.value + '(';\n        if (this.isSubFormula) {\n            var editValue = this.getEditingValue();\n            var parseIndex = editValue.lastIndexOf(this.getArgumentSeparator());\n            if (parseIndex > -1) {\n                updatedFormulaValue = editValue.slice(0, parseIndex + 1);\n            }\n            else {\n                parseIndex = editValue.lastIndexOf('(');\n                if (parseIndex > -1) {\n                    updatedFormulaValue = editValue.slice(0, parseIndex + 1);\n                }\n            }\n            updatedFormulaValue += e.itemData.value + '(';\n        }\n        this.parent.notify(editOperation, {\n            action: 'refreshEditor', value: updatedFormulaValue,\n            refreshFormulaBar: true, refreshEditorElem: true, refreshCurPos: !this.isFormulaBar\n        });\n    };\n    Formula.prototype.onSuggestionComplete = function (args) {\n        this.isPreventClose = args.result.length > 0;\n        if (!this.isPreventClose) {\n            args.cancel = true;\n            this.hidePopUp();\n        }\n    };\n    Formula.prototype.keyUpHandler = function (e) {\n        if (this.parent.isEdit) {\n            var editValue = this.getEditingValue();\n            this.isFormula = checkIsFormula(editValue);\n            if (this.isFormula || this.isPopupOpened) {\n                if (e.keyCode !== this.keyCodes.TAB && this.isFormula) {\n                    editValue = this.getSuggestionKeyFromFormula(editValue);\n                }\n                this.refreshFormulaSuggestion(e, editValue);\n            }\n        }\n        else if (this.isPopupOpened) {\n            this.hidePopUp();\n        }\n    };\n    Formula.prototype.keyDownHandler = function (e) {\n        var keyCode = e.keyCode;\n        if (this.isFormula) {\n            if (this.isPopupOpened) {\n                switch (keyCode) {\n                    case this.keyCodes.UP:\n                    case this.keyCodes.DOWN:\n                        e.preventDefault();\n                        this.triggerKeyDownEvent(keyCode);\n                        break;\n                    case this.keyCodes.TAB:\n                        e.preventDefault();\n                        this.triggerKeyDownEvent(this.keyCodes.ENTER);\n                        break;\n                }\n            }\n        }\n        else {\n            var trgtElem = e.target;\n            if (trgtElem.id === this.parent.element.id + '_name_box') {\n                switch (keyCode) {\n                    case this.keyCodes.ENTER:\n                        this.addDefinedName({ name: trgtElem.value });\n                        this.parent.element.focus();\n                        break;\n                    case this.keyCodes.ESC:\n                        this.parent.element.focus();\n                        break;\n                }\n            }\n        }\n    };\n    Formula.prototype.clickHandler = function (e) {\n        if (this.parent.isEdit) {\n            var trgtElem = e.target;\n            this.isFormulaBar = trgtElem.classList.contains('e-formula-bar');\n        }\n    };\n    Formula.prototype.refreshFormulaSuggestion = function (e, formula) {\n        if (formula.length > 0) {\n            var autoCompleteElem = this.autocompleteInstance.element;\n            var keyCode = e.keyCode;\n            var isSuggestionAlreadyOpened = this.isPopupOpened;\n            if (!this.isNavigationKey(keyCode)) {\n                autoCompleteElem.value = formula;\n                autoCompleteElem.dispatchEvent(new Event('input'));\n                autoCompleteElem.dispatchEvent(new Event('keyup'));\n                if (isSuggestionAlreadyOpened) {\n                    this.triggerKeyDownEvent(this.keyCodes.DOWN);\n                }\n            }\n        }\n        else {\n            if (this.isPopupOpened) {\n                this.isPreventClose = false;\n                this.hidePopUp();\n            }\n        }\n    };\n    Formula.prototype.endEdit = function () {\n        this.isSubFormula = false;\n        this.isPreventClose = false;\n        this.isFormula = false;\n        this.isFormulaBar = false;\n        if (this.isPopupOpened) {\n            this.hidePopUp();\n            var suggPopupElem = document.querySelector('#' + this.parent.element.id + '_ac_popup');\n            if (suggPopupElem) {\n                detach(suggPopupElem);\n            }\n            this.isPopupOpened = false;\n        }\n    };\n    Formula.prototype.hidePopUp = function () {\n        this.autocompleteInstance.hidePopup();\n    };\n    Formula.prototype.getSuggestionKeyFromFormula = function (formula) {\n        var suggestValue = '';\n        formula = formula.substr(1); //remove = char.\n        if (formula) {\n            var bracketIndex = formula.lastIndexOf('(');\n            formula = formula.substr(bracketIndex + 1);\n            var fSplit = formula.split(this.getArgumentSeparator());\n            if (fSplit.length === 1) {\n                suggestValue = fSplit[0];\n                this.isSubFormula = bracketIndex > -1;\n            }\n            else {\n                suggestValue = fSplit[fSplit.length - 1];\n                this.isSubFormula = true;\n            }\n            var isAlphaNumeric = suggestValue.match(/\\w/);\n            if (!isAlphaNumeric || (isAlphaNumeric && isAlphaNumeric.index !== 0)) {\n                suggestValue = '';\n            }\n        }\n        return suggestValue;\n    };\n    Formula.prototype.getPopupPosition = function () {\n        var eventArgs = { position: null };\n        if (this.isFormulaBar) {\n            eventArgs.action = 'getPosition';\n            this.parent.notify(formulaBarOperation, eventArgs);\n        }\n        else {\n            eventArgs.action = 'getPosition';\n            this.parent.notify(editOperation, eventArgs);\n        }\n        return eventArgs.position;\n    };\n    Formula.prototype.getEditingValue = function () {\n        var eventArgs = { action: 'getCurrentEditValue', editedValue: '' };\n        this.parent.notify(editOperation, eventArgs);\n        return eventArgs.editedValue;\n    };\n    Formula.prototype.isNavigationKey = function (keyCode) {\n        return (keyCode === this.keyCodes.UP) || (keyCode === this.keyCodes.DOWN) || (keyCode === this.keyCodes.LEFT)\n            || (keyCode === this.keyCodes.RIGHT);\n    };\n    Formula.prototype.triggerKeyDownEvent = function (keyCode) {\n        var autoCompleteElem = this.autocompleteInstance.element;\n        autoCompleteElem.dispatchEvent(new Event('input'));\n        var eventArg = new Event('keydown');\n        // tslint:disable:no-string-literal\n        eventArg['keyCode'] = keyCode;\n        eventArg['which'] = keyCode;\n        eventArg['altKey'] = false;\n        eventArg['shiftKey'] = false;\n        eventArg['ctrlKey'] = false;\n        // tslint:enable:no-string-literal\n        autoCompleteElem.dispatchEvent(eventArg);\n    };\n    Formula.prototype.getArgumentSeparator = function () {\n        if (this.argumentSeparator) {\n            return this.argumentSeparator;\n        }\n        else {\n            var eventArgs = {\n                action: 'getArgumentSeparator', argumentSeparator: ''\n            };\n            this.parent.notify(workbookFormulaOperation, eventArgs);\n            this.argumentSeparator = eventArgs.argumentSeparator;\n            return eventArgs.argumentSeparator;\n        }\n    };\n    Formula.prototype.getNames = function (sheetName) {\n        var names = this.parent.definedNames.filter(function (name) { return name.scope === '' || name.scope === sheetName; });\n        return names;\n    };\n    Formula.prototype.getNameFromRange = function (range) {\n        var singleRange = range.slice(0, range.indexOf(':'));\n        var sRange = range.slice(range.indexOf('!') + 1).split(':');\n        var isSingleCell = sRange.length > 1 && sRange[0] === sRange[1];\n        var name = this.parent.definedNames.filter(function (name, index) {\n            if (isSingleCell && name.refersTo === '=' + singleRange) {\n                return true;\n            }\n            return name.refersTo === '=' + range;\n        });\n        return name && name[0];\n    };\n    Formula.prototype.addDefinedName = function (definedName) {\n        if (!definedName.refersTo) {\n            var sheet = getSheet(this.parent, this.parent.activeSheetTab - 1);\n            var selectRange = sheet.selectedRange;\n            if (!isNullOrUndefined(selectRange)) {\n                var colIndex = selectRange.indexOf(':');\n                var left = selectRange.substr(0, colIndex);\n                var right = selectRange.substr(colIndex + 1, selectRange.length);\n                selectRange = left === right ? left : selectRange;\n            }\n            definedName.refersTo = getSheetName(this.parent) + '!' + selectRange;\n        }\n        var eventArgs = {\n            action: 'addDefinedName', definedName: definedName, isAdded: false\n        };\n        this.parent.notify(workbookFormulaOperation, eventArgs);\n        if (!eventArgs.isAdded) {\n            this.parent.serviceLocator.getService(dialog).show({\n                content: this.parent.serviceLocator.getService(locale).getConstant('DefineNameExists'),\n                width: '300'\n            });\n        }\n        return true;\n    };\n    return Formula;\n}());\nexport { Formula };\n","import { Tab } from '@syncfusion/ej2-navigations';\nimport { refreshSheetTabs, locale, addSheetTab, cMenuBeforeOpen, dialog, renameSheet, completeAction } from '../common/index';\nimport { sheetNameUpdate, clearUndoRedoCollection } from '../common/index';\nimport { sheetTabs, renameSheetTab, removeSheetTab, activeSheetChanged, onVerticalScroll, onHorizontalScroll } from '../common/index';\nimport { getUpdateUsingRaf } from '../common/index';\nimport { getSheetName, aggregateComputation } from '../../workbook/index';\nimport { isSingleCell, getRangeIndexes, getSheet, getSheetIndex } from '../../workbook/index';\nimport { DropDownButton } from '@syncfusion/ej2-splitbuttons';\nimport { isCollide, calculatePosition } from '@syncfusion/ej2-popups';\nimport { rippleEffect, closest, EventHandler, remove } from '@syncfusion/ej2-base';\nimport { sheetsDestroyed, activeCellChanged, workbookFormulaOperation } from '../../workbook/common/index';\n/**\n * Represents SheetTabs for Spreadsheet.\n */\nvar SheetTabs = /** @class */ (function () {\n    function SheetTabs(parent) {\n        this.aggregateContent = '';\n        this.parent = parent;\n        this.addEventListener();\n    }\n    SheetTabs.prototype.getModuleName = function () {\n        return 'sheetTabs';\n    };\n    SheetTabs.prototype.createSheetTabs = function () {\n        var _this = this;\n        if (!this.parent.showSheetTabs && this.tabInstance) {\n            this.destroy();\n            return;\n        }\n        var l10n = this.parent.serviceLocator.getService(locale);\n        var panel = this.parent.createElement('div', {\n            className: 'e-sheet-tab-panel', id: this.parent.element.id + '_sheet_tab_panel'\n        });\n        var addBtn = this.parent.createElement('button', {\n            className: 'e-add-sheet-tab e-btn e-css e-flat e-icon-btn', attrs: { 'title': l10n.getConstant('AddSheet') }\n        });\n        addBtn.appendChild(this.parent.createElement('span', { className: 'e-btn-icon e-icons e-add-icon' }));\n        addBtn.addEventListener('click', this.addSheetTab.bind(this));\n        panel.appendChild(addBtn);\n        this.addBtnRipple = rippleEffect(panel, { selector: '.e-add-sheet-tab' });\n        var ddb = this.parent.createElement('button', { attrs: { 'title': l10n.getConstant('ListAllSheets') } });\n        panel.appendChild(ddb);\n        this.parent.element.appendChild(panel);\n        var items = this.getSheetTabItems();\n        this.dropDownInstance = new DropDownButton({\n            iconCss: 'e-icons',\n            items: items.ddbItems,\n            select: function (args) { return _this.updateSheetTab({ idx: _this.dropDownInstance.items.indexOf(args.item) }); },\n            beforeOpen: function (args) { return _this.beforeOpenHandler(_this.dropDownInstance, args.element); },\n            open: function (args) { return _this.openHandler(_this.dropDownInstance, args.element, 'left'); },\n            cssClass: 'e-sheets-list e-flat e-caret-hide',\n            close: function () { return _this.parent.element.focus(); }\n        });\n        this.dropDownInstance.createElement = this.parent.createElement;\n        this.dropDownInstance.appendTo(ddb);\n        var sheetTab = this.parent.createElement('div', { className: 'e-sheet-tab' });\n        this.tabInstance = new Tab({\n            selectedItem: 0,\n            overflowMode: 'Scrollable',\n            items: items.tabItems,\n            scrollStep: 250,\n            selecting: function (args) {\n                /** */\n            },\n            selected: function (args) {\n                if (args.selectedIndex === args.previousIndex) {\n                    return;\n                }\n                _this.parent.activeSheetTab = args.selectedIndex + 1;\n                _this.parent.dataBind();\n                _this.updateDropDownItems(args.selectedIndex, args.previousIndex);\n                _this.parent.element.focus();\n            },\n            created: function () {\n                var tBarItems = _this.tabInstance.element.querySelector('.e-toolbar-items');\n                tBarItems.classList.add('e-sheet-tabs-items');\n                EventHandler.add(tBarItems, 'dblclick', _this.renameSheetTab, _this);\n            },\n        });\n        panel.appendChild(sheetTab);\n        this.tabInstance.createElement = this.parent.createElement;\n        this.tabInstance.appendTo(sheetTab);\n        // tslint:disable-next-line:no-any\n        EventHandler.remove(this.tabInstance.element, 'keydown', this.tabInstance.spaceKeyDown);\n        var sheetCount = items.tabItems.length;\n        for (var i = 0; i < sheetCount; i++) {\n            var sheetName = getSheetName(this.parent, i + 1);\n            var arg = { action: 'addSheet', sheetName: 'Sheet' + (i + 1), index: i + 1, visibleName: sheetName };\n            this.parent.notify(workbookFormulaOperation, arg);\n        }\n    };\n    SheetTabs.prototype.updateDropDownItems = function (curIdx, prevIdx) {\n        if (prevIdx > -1) {\n            this.dropDownInstance.items[prevIdx].iconCss = '';\n        }\n        this.dropDownInstance.items[curIdx].iconCss = 'e-selected-icon e-icons';\n        this.dropDownInstance.setProperties({ 'items': this.dropDownInstance.items }, true);\n    };\n    SheetTabs.prototype.beforeOpenHandler = function (instance, element) {\n        var viewportHeight = this.parent.viewport.height;\n        var actualHeight = (parseInt(getComputedStyle(element.firstElementChild).height, 10) *\n            instance.items.length) + (parseInt(getComputedStyle(element).paddingTop, 10) * 2);\n        if (actualHeight > viewportHeight) {\n            element.style.height = viewportHeight + \"px\";\n            element.style.overflowY = 'auto';\n        }\n        element.parentElement.style.visibility = 'hidden';\n    };\n    SheetTabs.prototype.openHandler = function (instance, element, positionX) {\n        var wrapper = element.parentElement;\n        var height;\n        var collide = isCollide(wrapper);\n        if (collide.indexOf('bottom') === -1) {\n            height = element.style.overflowY === 'auto' ? this.parent.viewport.height : wrapper.getBoundingClientRect().height;\n            var offset = calculatePosition(instance.element, positionX, 'top');\n            if (positionX === 'right') {\n                offset.left -= wrapper.getBoundingClientRect().width;\n            }\n            wrapper.style.left = offset.left + \"px\";\n            wrapper.style.top = offset.top - height + \"px\";\n        }\n        wrapper.style.visibility = '';\n    };\n    SheetTabs.prototype.getSheetTabItems = function () {\n        var _this = this;\n        var tabItems = [];\n        var ddbItems = [];\n        var sheetName;\n        this.parent.sheets.forEach(function (sheet, index) {\n            sheetName = getSheetName(_this.parent, index + 1);\n            tabItems.push({ header: { 'text': sheetName } });\n            ddbItems.push({ text: sheetName, iconCss: index + 1 === _this.parent.activeSheetTab ? 'e-selected-icon e-icons' : '' });\n        });\n        return { tabItems: tabItems, ddbItems: ddbItems };\n    };\n    SheetTabs.prototype.refreshSheetTab = function () {\n        var items = this.getSheetTabItems();\n        this.dropDownInstance.items = items.ddbItems;\n        this.dropDownInstance.setProperties({ 'items': this.dropDownInstance.items }, true);\n        this.tabInstance.items = items.tabItems;\n        this.tabInstance.selectedItem = this.parent.activeSheetTab - 1;\n        this.tabInstance.dataBind();\n    };\n    SheetTabs.prototype.addSheetTab = function (args) {\n        if (args.count && (args.count === this.parent.sheets.length)) {\n            return;\n        }\n        var idx = args.previousIndex ? args.previousIndex : args.text && args.text === 'Insert' ?\n            this.parent.activeSheetTab - 1 : this.parent.activeSheetTab;\n        this.parent.createSheet(idx);\n        var sheetName = this.parent.sheets[idx].name;\n        this.dropDownInstance.items.splice(idx, 0, { text: sheetName });\n        this.dropDownInstance.setProperties({ 'items': this.dropDownInstance.items }, true);\n        this.tabInstance.addTab([{ header: { text: sheetName }, content: '' }], idx);\n        if (idx === this.parent.activeSheetTab - 1) {\n            this.parent.renderModule.refreshSheet();\n            this.updateDropDownItems(idx, idx + 1);\n        }\n        else {\n            if (!args.isAction) {\n                this.updateSheetTab({ idx: idx });\n            }\n        }\n        this.parent.element.focus();\n        var index = this.parent.getActiveSheet().id;\n        var arg = { action: 'addSheet', visibleName: sheetName, sheetName: 'Sheet' + index, index: index };\n        this.parent.notify(workbookFormulaOperation, arg);\n        if (!args.isAction) {\n            var eventArgs = {\n                index: this.parent.getActiveSheet().id,\n                text: args.text,\n                sheetCount: this.parent.sheets.length,\n                previousIndex: idx\n            };\n            this.parent.notify(completeAction, { eventArgs: eventArgs, action: 'addSheet' });\n        }\n    };\n    SheetTabs.prototype.updateSheetTab = function (args) {\n        this.tabInstance.selectedItem = args.idx;\n        this.tabInstance.dataBind();\n    };\n    SheetTabs.prototype.switchSheetTab = function (args) {\n        var target = closest(args.event.target, '.e-toolbar-item');\n        if (!target) {\n            return;\n        }\n        var text = target.querySelector('.e-tab-text').textContent;\n        for (var i = 0, len = this.tabInstance.items.length; i < len; i++) {\n            if (this.tabInstance.items[i].header.text === text) {\n                if (this.parent.activeSheetTab - 1 !== i) {\n                    this.updateSheetTab({ idx: i });\n                }\n                break;\n            }\n        }\n    };\n    SheetTabs.prototype.renameSheetTab = function () {\n        var target = this.tabInstance.element.querySelector('.e-toolbar-item.e-active');\n        if (target) {\n            target = target.querySelector('.e-text-wrap');\n            var value = target.querySelector('.e-tab-text').textContent;\n            var input = this.parent.createElement('input', {\n                id: this.parent.element.id + '_rename_input',\n                className: 'e-input e-sheet-rename', styles: \"width: \" + target.getBoundingClientRect().width + \"px\", attrs: {\n                    'type': 'text', 'name': 'Rename', 'required': '', 'value': value, 'spellcheck': 'false', 'maxlength': '31'\n                }\n            });\n            target.firstElementChild.style.display = 'none';\n            target.appendChild(input);\n            EventHandler.add(document, 'mousedown touchstart', this.renameInputFocusOut, this);\n            EventHandler.add(input, 'input', this.updateWidth, this);\n            input.focus();\n            input.setSelectionRange(0, value.length);\n            EventHandler.remove(closest(target, '.e-toolbar-items'), 'dblclick', this.renameSheetTab);\n        }\n    };\n    SheetTabs.prototype.updateWidth = function (e) {\n        var target = e.target;\n        var len = target.value.length;\n        var value = target.value.split(' ');\n        if (value.length) {\n            var spaceLen = value.length - 1;\n            len -= spaceLen;\n            len += (spaceLen * 0.5);\n        }\n        target.style.width = len + \"ch\";\n    };\n    SheetTabs.prototype.renameInputFocusOut = function (e) {\n        var target = e.target;\n        if ((e.type === 'mousedown' || e.type === 'touchstart') && (target.classList.contains('e-sheet-rename') ||\n            closest(target, '.e-dlg-container'))) {\n            return;\n        }\n        target = document.getElementById(this.parent.element.id + '_rename_input');\n        if (e.type === 'keydown' && e.keyCode === 27) {\n            this.removeRenameInput(target);\n            this.parent.element.focus();\n            return;\n        }\n        var value = target.value;\n        var l10n = this.parent.serviceLocator.getService(locale);\n        if (value) {\n            var idx = this.tabInstance.selectedItem;\n            if (!value.match(new RegExp('.*[\\\\[\\\\]\\\\*\\\\\\\\\\/\\\\?].*'))) {\n                if (this.tabInstance.items[idx].header.text !== value) {\n                    for (var i = 0, len = this.parent.sheets.length; i < len; i++) {\n                        if (i + 1 !== this.parent.activeSheetTab && this.parent.sheets[i].name.toLowerCase() === value.toLowerCase()) {\n                            this.showRenameDialog(target, l10n.getConstant('SheetRenameAlreadyExistsAlert'));\n                            return;\n                        }\n                    }\n                }\n                var items = this.removeRenameInput(target);\n                if (this.tabInstance.items[idx].header.text !== value) {\n                    this.parent.sheets[idx].name = value;\n                    this.parent.setProperties({ 'sheets': this.parent.sheets }, true);\n                    this.updateSheetName({ value: value, idx: idx, items: items });\n                }\n                if (e.type === 'keydown' || (closest(e.target, '.e-spreadsheet'))) {\n                    this.parent.element.focus();\n                }\n            }\n            else {\n                this.showRenameDialog(target, l10n.getConstant('SheetRenameInvalidAlert'));\n            }\n        }\n        else {\n            this.showRenameDialog(target, l10n.getConstant('SheetRenameEmptyAlert'));\n        }\n        var sheetIndex = this.parent.getActiveSheet().id;\n        var args = { action: 'renameUpdation', value: value, sheetId: sheetIndex };\n        this.parent.notify(workbookFormulaOperation, args);\n        var eventArgs = {\n            index: sheetIndex,\n            value: value\n        };\n        this.parent.notify(completeAction, { eventArgs: eventArgs, action: 'renameSheet' });\n    };\n    SheetTabs.prototype.updateSheetName = function (args) {\n        this.tabInstance.items[args.idx].header.text = args.value;\n        this.dropDownInstance.items[args.idx].text = args.value;\n        this.dropDownInstance.setProperties({ 'items': this.dropDownInstance.items }, true);\n        if (args.value.indexOf('  ') > -1) {\n            this.tabInstance.setProperties({ 'items': this.tabInstance.items }, true);\n            args.items.querySelector('.e-toolbar-item.e-active .e-tab-text').textContent = args.value;\n        }\n        else {\n            this.tabInstance.items = this.tabInstance.items;\n            this.tabInstance.dataBind();\n        }\n    };\n    SheetTabs.prototype.removeRenameInput = function (target) {\n        var textEle = target.parentElement.querySelector('.e-tab-text');\n        var sheetItems = closest(target, '.e-toolbar-items');\n        EventHandler.add(sheetItems, 'dblclick', this.renameSheetTab, this);\n        EventHandler.remove(document, 'mousedown touchstart', this.renameInputFocusOut);\n        EventHandler.remove(target, 'input', this.updateWidth);\n        remove(target);\n        textEle.style.display = '';\n        return sheetItems;\n    };\n    SheetTabs.prototype.showRenameDialog = function (target, content) {\n        this.parent.serviceLocator.getService(dialog).show({\n            target: document.getElementById(this.parent.element.id + '_sheet_panel'),\n            height: 180, width: 400, isModal: true, showCloseIcon: true,\n            content: content,\n            beforeOpen: function () { return target.focus(); },\n            close: function () { return target.setSelectionRange(0, target.value.length); }\n        });\n    };\n    SheetTabs.prototype.focusRenameInput = function () {\n        var input = document.getElementById(this.parent.element.id + '_rename_input');\n        if (input) {\n            input.focus();\n        }\n    };\n    SheetTabs.prototype.removeSheetTab = function (args) {\n        var _this = this;\n        if (args.count && (args.count === this.parent.sheets.length)) {\n            return;\n        }\n        var l10n = this.parent.serviceLocator.getService(locale);\n        if (this.parent.sheets.length > 1) {\n            var sheet = args.sheetName ? getSheet(this.parent, getSheetIndex(this.parent, args.sheetName)) :\n                this.parent.getActiveSheet();\n            var sheetIndex_1 = args.index || getSheetIndex(this.parent, sheet.name);\n            var eventArgs_1 = {\n                index: sheetIndex_1,\n                sheetCount: this.parent.sheets.length,\n                sheetName: sheet.name\n            };\n            var isDataAvail = sheet.rows && sheet.rows.length ?\n                (sheet.rows.length === 1 ? (sheet.rows[0].cells && sheet.rows[0].cells.length ? true : false) : true) : false;\n            if (isDataAvail) {\n                var dialogInst_1 = this.parent.serviceLocator.getService(dialog);\n                if (args.clicked) {\n                    this.forceDelete(sheetIndex_1);\n                }\n                else {\n                    dialogInst_1.show({\n                        height: 180, width: 400, isModal: true, showCloseIcon: true,\n                        content: l10n.getConstant('DeleteSheetAlert'),\n                        beforeOpen: function () { return _this.parent.element.focus(); },\n                        buttons: [{\n                                buttonModel: {\n                                    content: l10n.getConstant('Ok'), isPrimary: true\n                                },\n                                click: function () {\n                                    dialogInst_1.hide();\n                                    _this.forceDelete(sheetIndex_1);\n                                    _this.parent.notify(clearUndoRedoCollection, null);\n                                    if (args && !args.isAction) {\n                                        eventArgs_1.sheetCount = _this.parent.sheets.length;\n                                        _this.parent.notify(completeAction, { eventArgs: eventArgs_1, action: 'removeSheet' });\n                                    }\n                                }\n                            }]\n                    });\n                }\n            }\n            else {\n                this.destroySheet(sheetIndex_1);\n                var sheetArgs = {\n                    action: 'deleteSheetTab', sheetName: '', index: sheetIndex_1\n                };\n                this.parent.notify(workbookFormulaOperation, sheetArgs);\n                this.parent.notify(clearUndoRedoCollection, null);\n                if (args && !args.isAction) {\n                    eventArgs_1.sheetCount = this.parent.sheets.length;\n                    this.parent.notify(completeAction, { eventArgs: eventArgs_1, action: 'removeSheet' });\n                }\n            }\n        }\n        else {\n            this.parent.serviceLocator.getService(dialog).show({\n                target: document.getElementById(this.parent.element.id + '_sheet_panel'),\n                height: 180, width: 400, isModal: true, showCloseIcon: true,\n                content: l10n.getConstant('DeleteSingleLastSheetAlert'),\n                beforeOpen: function () { return _this.parent.element.focus(); }\n            });\n        }\n    };\n    SheetTabs.prototype.forceDelete = function (sheetIndex) {\n        this.destroySheet(sheetIndex);\n        var sheetArgs = {\n            action: 'deleteSheetTab', sheetName: '', index: sheetIndex\n        };\n        this.parent.notify(workbookFormulaOperation, sheetArgs);\n    };\n    SheetTabs.prototype.destroySheet = function (sheetIndex) {\n        var activeSheetIdx = sheetIndex || this.parent.activeSheetTab - 1;\n        this.parent.removeSheet(activeSheetIdx);\n        this.parent.notify(sheetsDestroyed, { sheetIndex: activeSheetIdx });\n        this.dropDownInstance.items.splice(activeSheetIdx, 1);\n        this.dropDownInstance.setProperties({ 'items': this.dropDownInstance.items }, true);\n        this.tabInstance.removeTab(activeSheetIdx);\n        this.parent.setProperties({ 'activeSheetTab': this.tabInstance.selectedItem + 1 }, true);\n        this.parent.renderModule.refreshSheet();\n        this.updateDropDownItems(this.tabInstance.selectedItem);\n        this.parent.element.focus();\n    };\n    SheetTabs.prototype.showAggregate = function () {\n        var _this = this;\n        if (isSingleCell(getRangeIndexes(this.parent.getActiveSheet().selectedRange))) {\n            return;\n        }\n        getUpdateUsingRaf(function () {\n            var eventArgs = { Count: 0, Sum: '0', Avg: '0', Min: '0', Max: '0' };\n            _this.parent.notify(aggregateComputation, eventArgs);\n            if (eventArgs.Count) {\n                if (!_this.aggregateContent) {\n                    _this.aggregateContent = eventArgs.Sum ? 'Sum' : 'Count';\n                }\n                var key = _this.aggregateContent;\n                var content = key + \": \" + eventArgs[key];\n                if (!_this.aggregateDropDown) {\n                    var aggregateEle = _this.parent.createElement('button');\n                    document.getElementById(_this.parent.element.id + \"_sheet_tab_panel\").appendChild(aggregateEle);\n                    _this.aggregateDropDown = new DropDownButton({\n                        content: content,\n                        items: _this.getAggregateItems(eventArgs),\n                        select: function (args) { return _this.updateAggregateContent(args.item.text, eventArgs); },\n                        beforeOpen: function (args) {\n                            return _this.beforeOpenHandler(_this.aggregateDropDown, args.element);\n                        },\n                        open: function (args) { return _this.openHandler(_this.aggregateDropDown, args.element, 'right'); },\n                        close: function () { return _this.parent.element.focus(); },\n                        cssClass: 'e-aggregate-list e-flat'\n                    });\n                    _this.aggregateDropDown.createElement = _this.parent.createElement;\n                    _this.aggregateDropDown.appendTo(aggregateEle);\n                }\n                else {\n                    _this.updateAggregateContent(content, eventArgs);\n                }\n            }\n        });\n    };\n    SheetTabs.prototype.getAggregateItems = function (args) {\n        var _this = this;\n        var items = [];\n        var text;\n        var iconCss;\n        Object.keys(args).forEach(function (key) {\n            if (args[key] !== aggregateComputation) {\n                text = key + \": \" + args[key];\n                iconCss = key === _this.aggregateContent ? 'e-selected-icon e-icons' : '';\n                items.push({ text: text, iconCss: iconCss });\n            }\n        });\n        return items;\n    };\n    SheetTabs.prototype.updateAggregateContent = function (text, eventArgs) {\n        this.aggregateContent = text.split(': ')[0];\n        this.aggregateDropDown.content = text;\n        this.aggregateDropDown.dataBind();\n        this.aggregateDropDown.setProperties({ 'items': this.getAggregateItems(eventArgs) }, true);\n    };\n    SheetTabs.prototype.removeAggregate = function () {\n        if (this.aggregateDropDown && isSingleCell(getRangeIndexes(this.parent.getActiveSheet().selectedRange))) {\n            this.aggregateDropDown.destroy();\n            remove(this.aggregateDropDown.element);\n            this.aggregateDropDown = null;\n        }\n    };\n    SheetTabs.prototype.addEventListener = function () {\n        this.parent.on(sheetTabs, this.createSheetTabs, this);\n        this.parent.on(refreshSheetTabs, this.refreshSheetTab, this);\n        this.parent.on(addSheetTab, this.addSheetTab, this);\n        this.parent.on(removeSheetTab, this.removeSheetTab, this);\n        this.parent.on(renameSheetTab, this.renameSheetTab, this);\n        this.parent.on(cMenuBeforeOpen, this.switchSheetTab, this);\n        this.parent.on(activeSheetChanged, this.updateSheetTab, this);\n        this.parent.on(renameSheet, this.renameInputFocusOut, this);\n        this.parent.on(activeCellChanged, this.removeAggregate, this);\n        this.parent.on(onVerticalScroll, this.focusRenameInput, this);\n        this.parent.on(onHorizontalScroll, this.focusRenameInput, this);\n        this.parent.on(sheetNameUpdate, this.updateSheetName, this);\n    };\n    SheetTabs.prototype.destroy = function () {\n        this.removeEventListener();\n        this.dropDownInstance.destroy();\n        this.dropDownInstance = null;\n        this.tabInstance.destroy();\n        this.tabInstance = null;\n        this.aggregateDropDown = null;\n        this.aggregateContent = null;\n        this.addBtnRipple();\n        this.addBtnRipple = null;\n        EventHandler.remove(document, 'mousedown touchstart', this.renameInputFocusOut);\n        var ele = document.getElementById(this.parent.element.id + '_sheet_tab_panel');\n        if (ele) {\n            remove(ele);\n        }\n        this.parent = null;\n    };\n    SheetTabs.prototype.removeEventListener = function () {\n        if (!this.parent.isDestroyed) {\n            this.parent.off(sheetTabs, this.createSheetTabs);\n            this.parent.off(refreshSheetTabs, this.refreshSheetTab);\n            this.parent.off(addSheetTab, this.addSheetTab);\n            this.parent.off(removeSheetTab, this.removeSheetTab);\n            this.parent.off(renameSheetTab, this.renameSheetTab);\n            this.parent.off(cMenuBeforeOpen, this.switchSheetTab);\n            this.parent.off(activeSheetChanged, this.updateSheetTab);\n            this.parent.off(renameSheet, this.renameInputFocusOut);\n            this.parent.off(activeCellChanged, this.removeAggregate);\n            this.parent.off(onVerticalScroll, this.focusRenameInput);\n            this.parent.off(onHorizontalScroll, this.focusRenameInput);\n            this.parent.off(sheetNameUpdate, this.updateSheetName);\n        }\n    };\n    return SheetTabs;\n}());\nexport { SheetTabs };\n","import { refreshSheetTabs, completeAction } from '../common/event';\nimport { dialog } from '../common/index';\nimport { openSuccess, openFailure } from '../../workbook/index';\nvar Open = /** @class */ (function () {\n    function Open(parent) {\n        this.parent = parent;\n        this.addEventListener();\n        this.renderFileUpload();\n        //Spreadsheet.Inject(WorkbookOpen);\n    }\n    /**\n     * Adding event listener for success and failure\n     */\n    Open.prototype.addEventListener = function () {\n        this.parent.on(openSuccess, this.openSuccess, this);\n        this.parent.on(openFailure, this.openFailed, this);\n    };\n    /**\n     * Removing event listener for success and failure\n     */\n    Open.prototype.removeEventListener = function () {\n        if (!this.parent.isDestroyed) {\n            this.parent.off(openSuccess, this.openSuccess);\n            this.parent.off(openFailure, this.openFailed);\n        }\n    };\n    /**\n     * Rendering upload component for importing files.\n     */\n    Open.prototype.renderFileUpload = function () {\n        var uploadID = this.parent.element.id + '_fileUpload';\n        this.parent.element.appendChild(this.parent.createElement('input', {\n            id: uploadID,\n            attrs: { type: 'file', accept: '.xls, .xlsx, .csv', name: 'fileUpload' }\n        }));\n        var uploadBox = document.getElementById(uploadID);\n        uploadBox.onchange = this.fileSelect.bind(this);\n        uploadBox.onerror = this.openFailed.bind(this);\n        uploadBox.style.display = 'none';\n    };\n    /**\n     * Process after select the excel and image file.\n     * @param {Event} args - File select native event.\n     */\n    Open.prototype.fileSelect = function (args) {\n        /* tslint:disable-next-line:no-any */\n        var filesData = args.target.files[0];\n        if (filesData && filesData.length < 1) {\n            return;\n        }\n        var impArgs = {\n            file: filesData\n        };\n        this.parent.open(impArgs);\n        document.getElementById(this.parent.element.id + '_fileUpload').value = '';\n    };\n    /**\n     * File open success event declaration.\n     * @param {string} response - File open success response text.\n     */\n    Open.prototype.openSuccess = function (response) {\n        var openError = ['UnsupportedFile', 'InvalidUrl'];\n        if (openError.indexOf(response.data) > -1) {\n            this.parent.serviceLocator.getService(dialog).show({\n                content: this.parent.serviceLocator.getService('spreadsheetLocale')\n                    .getConstant(response.data),\n                width: '300'\n            });\n            this.parent.hideSpinner();\n            return;\n        }\n        if (!this.parent.element) {\n            return;\n        }\n        this.parent.trigger('openComplete', { response: response });\n        this.parent.notify(completeAction, { response: response, action: 'import' });\n        this.parent.renderModule.refreshSheet();\n        this.parent.notify(refreshSheetTabs, this);\n        this.parent.hideSpinner();\n    };\n    /**\n     * File open failure event declaration.\n     * @param {object} args - Open failure arguments.\n     */\n    Open.prototype.openFailed = function (args) {\n        this.parent.trigger('openFailure', args);\n        this.parent.hideSpinner();\n        /* Need to Implement */\n    };\n    /**\n     * To Remove the event listeners.\n     */\n    Open.prototype.destroy = function () {\n        this.removeEventListener();\n        this.parent = null;\n    };\n    /**\n     * Get the sheet open module name.\n     */\n    Open.prototype.getModuleName = function () {\n        return 'open';\n    };\n    return Open;\n}());\nexport { Open };\n","import { beginSave, saveCompleted } from '../../workbook/common/event';\n/**\n * `Save` module is used to handle the save action in Spreadsheet.\n */\nvar Save = /** @class */ (function () {\n    /**\n     * Constructor for Save module in Spreadsheet.\n     * @private\n     */\n    function Save(parent) {\n        this.parent = parent;\n        this.addEventListener();\n        //Spreadsheet.Inject(WorkbookSave);\n    }\n    /**\n     * To destroy the Save module.\n     * @return {void}\n     * @hidden\n     */\n    Save.prototype.destroy = function () {\n        this.removeEventListener();\n        this.parent = null;\n    };\n    Save.prototype.addEventListener = function () {\n        this.parent.on(beginSave, this.initiateSave, this);\n        this.parent.on(saveCompleted, this.saveCompleted, this);\n    };\n    Save.prototype.removeEventListener = function () {\n        if (!this.parent.isDestroyed) {\n            this.parent.off(beginSave, this.initiateSave);\n            this.parent.off(saveCompleted, this.saveCompleted);\n        }\n    };\n    /**\n     * Get the module name.\n     * @returns string\n     * @private\n     */\n    Save.prototype.getModuleName = function () {\n        return 'save';\n    };\n    /**\n     * Initiate save process.\n     * @hidden\n     */\n    Save.prototype.initiateSave = function (args) {\n        this.parent.showSpinner();\n    };\n    /**\n     * Save action completed.\n     * @hidden\n     */\n    Save.prototype.saveCompleted = function (args) {\n        this.parent.hideSpinner();\n    };\n    return Save;\n}());\nexport { Save };\n","import { ContextMenu as ContextMenuComponent } from '@syncfusion/ej2-navigations';\nimport { closest, extend, detach } from '@syncfusion/ej2-base';\nimport { addSheetTab, removeSheetTab, cMenuBeforeOpen, renameSheetTab, cut, copy, paste, locale } from '../common/index';\nimport { addContextMenuItems, removeContextMenuItems, enableContextMenuItems, initiateCustomSort } from '../common/index';\nimport { openHyperlink, initiateHyperlink, editHyperlink } from '../common/index';\nimport { filterByCellValue, reapplyFilter, clearFilter, getFilteredColumn, applySort } from '../common/index';\nimport { getRangeIndexes, getColumnHeaderText, getCellIndexes } from '../../workbook/common/index';\n/**\n * Represents context menu for Spreadsheet.\n */\nvar ContextMenu = /** @class */ (function () {\n    /**\n     * Constructor for ContextMenu module.\n     */\n    function ContextMenu(parent) {\n        this.parent = parent;\n        this.init();\n    }\n    ContextMenu.prototype.init = function () {\n        this.initContextMenu();\n        this.addEventListener();\n    };\n    ContextMenu.prototype.initContextMenu = function () {\n        var ul = document.createElement('ul');\n        ul.id = this.parent.element.id + '_contextmenu';\n        this.parent.element.appendChild(ul);\n        this.contextMenuInstance = new ContextMenuComponent({\n            cssClass: 'e-spreadsheet-contextmenu',\n            target: '#' + this.parent.element.id,\n            filter: 'e-numericcontainer e-active-cell e-selection e-row e-header-row e-select-all-cell e-sheet-tabs-items',\n            select: this.selectHandler.bind(this),\n            beforeOpen: this.beforeOpenHandler.bind(this),\n            beforeClose: this.beforeCloseHandler.bind(this)\n        }, ul);\n    };\n    /**\n     * Before close event handler.\n     */\n    ContextMenu.prototype.beforeCloseHandler = function (args) {\n        this.parent.trigger('contextMenuBeforeClose', args);\n    };\n    /**\n     * Select event handler.\n     */\n    ContextMenu.prototype.selectHandler = function (args) {\n        var selectArgs = extend({ cancel: false }, args);\n        this.parent.trigger('contextMenuItemSelect', selectArgs);\n        if (!selectArgs.cancel) {\n            var l10n = this.parent.serviceLocator.getService(locale);\n            var indexes = void 0;\n            var id = this.parent.element.id + '_cmenu';\n            switch (args.item.id) {\n                case id + '_cut':\n                    this.parent.notify(cut, { isAction: true, promise: Promise });\n                    break;\n                case id + '_copy':\n                    this.parent.notify(copy, { isAction: true, promise: Promise });\n                    break;\n                case id + '_paste':\n                    this.parent.notify(paste, { isAction: true });\n                    break;\n                case id + '_pastevalues':\n                    this.parent.notify(paste, { type: 'Values', isAction: true });\n                    break;\n                case id + '_pasteformats':\n                    this.parent.notify(paste, { type: 'Formats', isAction: true });\n                    break;\n                case id + '_rename':\n                    this.parent.notify(renameSheetTab, {});\n                    break;\n                case id + '_delete':\n                    this.parent.notify(removeSheetTab, {});\n                    break;\n                case id + '_insert':\n                    this.parent.notify(addSheetTab, { text: 'Insert' });\n                    break;\n                case id + '_ascending':\n                    this.parent.notify(applySort, null);\n                    break;\n                case id + '_descending':\n                    this.parent.notify(applySort, { sortOptions: { sortDescriptors: { order: 'Descending' } } });\n                    break;\n                case id + '_customsort':\n                    this.parent.notify(initiateCustomSort, null);\n                    break;\n                case id + '_filtercellvalue':\n                    this.parent.notify(filterByCellValue, null);\n                    break;\n                case id + '_clearfilter':\n                    var field = getColumnHeaderText(getCellIndexes(this.parent.getActiveSheet().activeCell)[1] + 1);\n                    this.parent.notify(clearFilter, { field: field });\n                    break;\n                case id + '_reapplyfilter':\n                    this.parent.notify(reapplyFilter, null);\n                    break;\n                case id + '_hiderow':\n                    indexes = getRangeIndexes(this.parent.getActiveSheet().selectedRange);\n                    this.parent.showHideRow(true, indexes[0], indexes[2]);\n                    break;\n                case id + '_unhiderow':\n                    indexes = getRangeIndexes(this.parent.getActiveSheet().selectedRange);\n                    this.parent.showHideRow(false, indexes[0], indexes[2]);\n                    break;\n                case id + '_hyperlink':\n                    this.parent.notify(initiateHyperlink, null);\n                    break;\n                case id + '_editHyperlink':\n                    this.parent.notify(editHyperlink, null);\n                    break;\n                case id + '_openHyperlink':\n                    this.parent.notify(openHyperlink, null);\n                    break;\n                case id + '_removeHyperlink':\n                    this.parent.removeHyperlink(this.parent.getActiveSheet().selectedRange);\n                    break;\n                default:\n                // Rename functionality goes here\n            }\n        }\n    };\n    /**\n     * Before open event handler.\n     */\n    ContextMenu.prototype.beforeOpenHandler = function (args) {\n        var target = this.getTarget(args.event.target);\n        if (args.element.classList.contains('e-contextmenu')) {\n            var items = this.getDataSource(target);\n            this.contextMenuInstance.items = items;\n            this.contextMenuInstance.dataBind();\n        }\n        this.parent.trigger('contextMenuBeforeOpen', args);\n        this.parent.notify(cMenuBeforeOpen, extend(args, { target: target }));\n    };\n    /**\n     * To get target area based on right click.\n     */\n    ContextMenu.prototype.getTarget = function (target) {\n        if (closest(target, '.e-main-content')) {\n            return 'Content';\n        }\n        else if (closest(target, '.e-column-header')) {\n            return 'ColumnHeader';\n        }\n        else if (closest(target, '.e-row-header')) {\n            return 'RowHeader';\n        }\n        else if (closest(target, '.e-sheet-tabs-items')) {\n            return 'Footer';\n        }\n        else if (closest(target, '.e-selectall-container')) {\n            return 'SelectAll';\n        }\n        else {\n            return '';\n        }\n    };\n    /**\n     * To populate context menu items based on target area.\n     */\n    ContextMenu.prototype.getDataSource = function (target) {\n        var l10n = this.parent.serviceLocator.getService(locale);\n        var items = [];\n        var id = this.parent.element.id + '_cmenu';\n        if (target === 'Content') {\n            this.setClipboardData(items, l10n, id);\n            items.push({ separator: true });\n            //push filter and sort items here\n            this.setFilterItems(items, id);\n            this.setSortItems(items, id);\n            items.push({ separator: true });\n            this.setHyperLink(items, id);\n        }\n        else if (target === 'RowHeader') {\n            this.setClipboardData(items, l10n, id);\n            //this.setHideShowItems(items, l10n, 'Row', id);\n        }\n        else if (target === 'ColumnHeader') {\n            this.setClipboardData(items, l10n, id);\n        }\n        else if (target === 'SelectAll') {\n            this.setClipboardData(items, l10n, id);\n            this.setFilterItems(items, id);\n            this.setSortItems(items, id);\n        }\n        else if (target === 'Footer') {\n            items.push({\n                text: l10n.getConstant('Insert'), id: id + '_insert'\n            });\n            items.push({\n                text: l10n.getConstant('Delete'), iconCss: 'e-icons e-delete', id: id + '_delete'\n            });\n            items.push({\n                text: l10n.getConstant('Rename'), id: id + '_rename'\n            });\n        }\n        return items;\n    };\n    /**\n     * Sets sorting related items to the context menu.\n     */\n    ContextMenu.prototype.setFilterItems = function (items, id) {\n        if (this.parent.allowFiltering) {\n            var l10n = this.parent.serviceLocator.getService(locale);\n            var args = { clearFilterText: null, isFiltered: false };\n            this.parent.notify(getFilteredColumn, args);\n            items.push({\n                text: l10n.getConstant('Filter'), id: id + '_filter',\n                iconCss: '',\n                items: [\n                    { text: args.clearFilterText, iconCss: 'e-icons e-filter-clear', id: id + '_clearfilter' },\n                    { text: l10n.getConstant('ReapplyFilter'), iconCss: 'e-icons e-filter-reapply', id: id + '_reapplyfilter' },\n                    { separator: true },\n                    { text: l10n.getConstant('FilterCellValue'), iconCss: '', id: id + '_filtercellvalue' }\n                ]\n            });\n        }\n    };\n    /**\n     * Sets sorting related items to the context menu.\n     */\n    ContextMenu.prototype.setSortItems = function (items, id) {\n        var l10n = this.parent.serviceLocator.getService(locale);\n        if (this.parent.allowSorting) {\n            items.push({\n                text: l10n.getConstant('Sort'), id: id + '_sort',\n                iconCss: 'e-icons e-sort-icon',\n                items: [\n                    { text: l10n.getConstant('SortAscending'), iconCss: 'e-icons e-sort-asc', id: id + '_ascending' },\n                    { text: l10n.getConstant('SortDescending'), iconCss: 'e-icons e-sort-desc', id: id + '_descending' },\n                    { text: l10n.getConstant('CustomSort') + '...', iconCss: 'e-icons e-sort-custom', id: id + '_customsort' }\n                ]\n            });\n        }\n    };\n    ContextMenu.prototype.setHyperLink = function (items, id) {\n        if (this.parent.allowHyperlink) {\n            var l10n = this.parent.serviceLocator.getService(locale);\n            if (!document.activeElement.getElementsByClassName('e-hyperlink')[0] &&\n                !document.activeElement.classList.contains('e-hyperlink')) {\n                items.push({\n                    text: l10n.getConstant('Hyperlink'), iconCss: 'e-icons e-hyperlink-icon', id: id + '_hyperlink'\n                });\n            }\n            else {\n                items.push({ text: l10n.getConstant('EditHyperlink'), iconCss: 'e-icons e-edithyperlink-icon', id: id + '_editHyperlink' }, { text: l10n.getConstant('OpenHyperlink'), iconCss: 'e-icons e-openhyperlink-icon', id: id + '_openHyperlink' }, { text: l10n.getConstant('RemoveHyperlink'), iconCss: 'e-icons e-removehyperlink-icon', id: id + '_removeHyperlink' });\n            }\n        }\n    };\n    ContextMenu.prototype.setClipboardData = function (items, l10n, id) {\n        if (this.parent.enableClipboard) {\n            items.push({\n                text: l10n.getConstant('Cut'),\n                iconCss: 'e-icons e-cut-icon', id: id + '_cut'\n            });\n            items.push({\n                text: l10n.getConstant('Copy'),\n                iconCss: 'e-icons e-copy-icon', id: id + '_copy'\n            });\n            items.push({\n                text: l10n.getConstant('Paste'),\n                iconCss: 'e-icons e-paste-icon', id: id + '_paste'\n            });\n            items.push({\n                text: l10n.getConstant('PasteSpecial'), id: id + '_pastespecial',\n                items: [\n                    { text: l10n.getConstant('Values'), id: id + '_pastevalues' },\n                    { text: l10n.getConstant('Formats'), id: id + '_pasteformats' }\n                ]\n            });\n        }\n    };\n    ContextMenu.prototype.setHideShowItems = function (items, l10n, layout, id) {\n        items.push({ separator: true });\n        var indexes = getRangeIndexes(this.parent.getActiveSheet().selectedRange);\n        if (indexes[0] === indexes[2] || indexes[1] === indexes[3]) {\n            items.push({ text: l10n.getConstant('Hide' + layout), id: id + '_hide' + layout.toLowerCase() });\n        }\n        else {\n            items.push({ text: l10n.getConstant('Hide' + layout + 's'), id: id + '_hide' + layout.toLowerCase() });\n        }\n        if (this.parent.hiddenRowsCount(indexes[0], indexes[2])) {\n            items.push({ text: l10n.getConstant('UnHide' + layout + 's'), id: id + '_unhide' + layout.toLowerCase() });\n        }\n    };\n    /**\n     * To add event listener.\n     */\n    ContextMenu.prototype.addEventListener = function () {\n        this.parent.on(addContextMenuItems, this.addItemsHandler, this);\n        this.parent.on(removeContextMenuItems, this.removeItemsHandler, this);\n        this.parent.on(enableContextMenuItems, this.enableItemsHandler, this);\n    };\n    /**\n     * To add context menu items before / after particular item.\n     */\n    ContextMenu.prototype.addItemsHandler = function (args) {\n        if (args.insertAfter) {\n            this.contextMenuInstance.insertAfter(args.items, args.text, args.isUniqueId);\n        }\n        else {\n            this.contextMenuInstance.insertBefore(args.items, args.text, args.isUniqueId);\n        }\n    };\n    /**\n     * To remove context menu items.\n     */\n    ContextMenu.prototype.removeItemsHandler = function (args) {\n        this.contextMenuInstance.removeItems(args.items, args.isUniqueId);\n    };\n    /**\n     * To enable / disable context menu items.\n     */\n    ContextMenu.prototype.enableItemsHandler = function (args) {\n        this.contextMenuInstance.enableItems(args.items, args.enable, args.isUniqueId);\n    };\n    /**\n     * To remove event listener.\n     */\n    ContextMenu.prototype.removeEventListener = function () {\n        if (!this.parent.isDestroyed) {\n            this.parent.off(addContextMenuItems, this.addItemsHandler);\n            this.parent.off(removeContextMenuItems, this.removeItemsHandler);\n            this.parent.off(enableContextMenuItems, this.enableItemsHandler);\n        }\n    };\n    /**\n     * To get module name.\n     */\n    ContextMenu.prototype.getModuleName = function () {\n        return 'contextMenu';\n    };\n    /**\n     * Destroy method.\n     */\n    ContextMenu.prototype.destroy = function () {\n        this.removeEventListener();\n        this.contextMenuInstance.destroy();\n        var ele = document.getElementById(this.parent.element.id + '_contextmenu');\n        if (ele) {\n            detach(ele);\n        }\n        this.parent = null;\n    };\n    return ContextMenu;\n}());\nexport { ContextMenu };\n","import { refreshCellElement } from '../../workbook/common/event';\nimport { isNullOrUndefined } from '@syncfusion/ej2-base';\n/**\n * Specifies number format.\n */\nvar NumberFormat = /** @class */ (function () {\n    function NumberFormat(parent) {\n        this.parent = parent;\n        this.addEventListener();\n        //Spreadsheet.Inject(WorkbookNumberFormat);\n    }\n    NumberFormat.prototype.refreshCellElement = function (args) {\n        var cell = this.parent.getCell(args.rowIndex, args.colIndex);\n        if (!isNullOrUndefined(cell)) {\n            this.parent.refreshNode(cell, args);\n        }\n    };\n    /**\n     * Adding event listener for number format.\n     * @hidden\n     */\n    NumberFormat.prototype.addEventListener = function () {\n        this.parent.on(refreshCellElement, this.refreshCellElement, this);\n    };\n    /**\n     * Removing event listener for number format.\n     * @hidden\n     */\n    NumberFormat.prototype.removeEventListener = function () {\n        if (!this.parent.isDestroyed) {\n            this.parent.off(refreshCellElement, this.refreshCellElement);\n        }\n    };\n    /**\n     * To Remove the event listeners.\n     */\n    NumberFormat.prototype.destroy = function () {\n        this.removeEventListener();\n        this.parent = null;\n    };\n    /**\n     * Get the workbook import module name.\n     */\n    NumberFormat.prototype.getModuleName = function () {\n        return 'numberFormat';\n    };\n    return NumberFormat;\n}());\nexport { NumberFormat };\n","import { initiateCustomSort, locale, dialog, getFilterRange } from '../index';\nimport { applySort, completeAction, beginAction } from '../index';\nimport { sortComplete, beforeSort, getFormattedCellObject } from '../../workbook/common/event';\nimport { getIndexesFromAddress, getSwapRange, getCell } from '../../workbook/index';\nimport { getColumnHeaderText, getRangeAddress } from '../../workbook/index';\nimport { getUniqueID, getComponent, enableRipple } from '@syncfusion/ej2-base';\nimport { DropDownList } from '@syncfusion/ej2-dropdowns';\nimport { RadioButton, CheckBox } from '@syncfusion/ej2-buttons';\nimport { ListView } from '@syncfusion/ej2-lists';\n/**\n * `Sort` module is used to handle the sort action in Spreadsheet.\n */\nvar Sort = /** @class */ (function () {\n    /**\n     * Constructor for sort module.\n     */\n    function Sort(parent) {\n        this.parent = parent;\n        this.addEventListener();\n    }\n    /**\n     * To destroy the sort module.\n     * @return {void}\n     */\n    Sort.prototype.destroy = function () {\n        this.removeEventListener();\n        this.parent = null;\n    };\n    Sort.prototype.addEventListener = function () {\n        this.parent.on(applySort, this.applySortHandler, this);\n        this.parent.on(sortComplete, this.sortCompleteHandler, this);\n        this.parent.on(initiateCustomSort, this.initiateCustomSortHandler, this);\n    };\n    Sort.prototype.removeEventListener = function () {\n        if (!this.parent.isDestroyed) {\n            this.parent.off(applySort, this.applySortHandler);\n            this.parent.off(sortComplete, this.sortCompleteHandler);\n            this.parent.off(initiateCustomSort, this.initiateCustomSortHandler);\n        }\n    };\n    /**\n     * Gets the module name.\n     * @returns string\n     */\n    Sort.prototype.getModuleName = function () {\n        return 'sort';\n    };\n    /**\n     * Validates the range and returns false when invalid.\n     */\n    Sort.prototype.isValidSortRange = function () {\n        var sheet = this.parent.getActiveSheet();\n        var range = getSwapRange(getIndexesFromAddress(sheet.selectedRange));\n        if (range[0] > sheet.usedRange.rowIndex - 1 || range[1] > sheet.usedRange.colIndex) {\n            return false;\n        }\n        return true;\n    };\n    /**\n     * Shows the range error alert dialog.\n     * @param error - range error string.\n     */\n    Sort.prototype.sortRangeAlertHandler = function (args) {\n        var dialogInst = this.parent.serviceLocator.getService(dialog);\n        dialogInst.show({\n            height: 180, width: 400, isModal: true, showCloseIcon: true,\n            content: args.error\n        });\n        this.parent.hideSpinner();\n    };\n    /**\n     * Initiates the custom sort dialog.\n     */\n    Sort.prototype.initiateCustomSortHandler = function () {\n        var _this = this;\n        var l10n = this.parent.serviceLocator.getService(locale);\n        if (!this.isValidSortRange()) {\n            this.sortRangeAlertHandler({ error: l10n.getConstant('SortOutOfRangeError') });\n            return;\n        }\n        var dialogInst = this.parent.serviceLocator.getService(dialog);\n        dialogInst.show({\n            height: 400, width: 560, isModal: true, showCloseIcon: true, cssClass: 'e-customsort-dlg',\n            header: l10n.getConstant('CustomSort'),\n            beforeOpen: function () {\n                dialogInst.dialogInstance.content = _this.customSortContent();\n                dialogInst.dialogInstance.dataBind();\n                _this.parent.element.focus();\n            },\n            buttons: [{\n                    buttonModel: {\n                        content: l10n.getConstant('Ok'), isPrimary: true\n                    },\n                    click: function () {\n                        var element = dialogInst.dialogInstance.content;\n                        var list = element.getElementsByClassName('e-list-sort e-listview e-lib')[0];\n                        var listview = getComponent(list, 'listview');\n                        var data = listview.dataSource;\n                        _this.clearError();\n                        var errorElem = element.getElementsByClassName('e-sort-error')[0];\n                        errorElem.style.display = 'block';\n                        if (!_this.validateError(data, element, errorElem)) {\n                            dialogInst.hide();\n                            var headercheck = element.getElementsByClassName('e-sort-checkheader')[0];\n                            var headerCheckbox = getComponent(headercheck, 'checkbox');\n                            var caseCheckbox = getComponent(element.getElementsByClassName('e-sort-checkcase')[0], 'checkbox');\n                            var hasHeader = headerCheckbox.checked;\n                            _this.applySortHandler({ sortOptions: { sortDescriptors: data, containsHeader: hasHeader, caseSensitive: caseCheckbox.checked } });\n                        }\n                    }\n                }]\n        });\n    };\n    /**\n     * Validates the errors of the sort criteria and displays the error.\n     * @param json - listview datasource.\n     * @param dialogElem - dialog content element.\n     * @param errorElem - element to display error.\n     */\n    Sort.prototype.validateError = function (json, dialogElem, errorElem) {\n        var l10n = this.parent.serviceLocator.getService(locale);\n        var hasEmpty = json.some(function (element) { return element.field.toString() === ''; });\n        if (hasEmpty) {\n            Array.prototype.some.call(dialogElem.getElementsByClassName('e-sort-field'), function (dropDown) {\n                var hasError = !getComponent(dropDown, 'dropdownlist').value;\n                if (hasError) {\n                    dropDown.parentElement.classList.add('e-error');\n                }\n                return hasError; //breaks the loop if only one error added.\n            });\n            errorElem.innerText = l10n.getConstant('SortEmptyFieldError');\n            return true;\n        }\n        var temp = new Set();\n        var duplicateField = '';\n        var hasDuplicate = json.some(function (element) {\n            duplicateField = element.field.toString();\n            return temp.size === temp.add(element.field).size;\n        });\n        var errorField = '';\n        if (hasDuplicate) {\n            var count_1 = 0;\n            Array.prototype.some.call(dialogElem.getElementsByClassName('e-sort-field'), function (dropDown) {\n                var dropDownList = getComponent(dropDown, 'dropdownlist');\n                if (dropDownList.value === duplicateField) {\n                    dropDown.parentElement.classList.add('e-error');\n                    errorField = dropDownList.text;\n                    count_1++;\n                }\n                return count_1 === 2; //breaks the loop when 2 errors added.\n            });\n            errorElem.innerHTML = '<strong>' + errorField + '</strong>' + l10n.getConstant('SortDuplicateFieldError');\n            return true;\n        }\n        return false;\n    };\n    /**\n     * Creates all the elements and generates the dialog content element.\n     */\n    Sort.prototype.customSortContent = function () {\n        var dialogElem = this.parent.createElement('div', { className: 'e-sort-dialog' });\n        var fields = this.getFields();\n        var listId = getUniqueID('customSort');\n        var listviewObj = this.getCustomListview(listId);\n        this.setHeaderTab(dialogElem, listviewObj, fields);\n        var contentElem = this.parent.createElement('div', {\n            className: 'e-sort-listsection',\n            styles: ''\n        });\n        dialogElem.appendChild(contentElem);\n        var listview = this.parent.createElement('div', { className: 'e-list-sort', styles: '' });\n        contentElem.appendChild(listview);\n        listviewObj.createElement = this.parent.createElement;\n        listviewObj.appendTo(listview);\n        this.renderListItem(listId, listviewObj, true, fields);\n        var errorElem = this.parent.createElement('div', { className: 'e-sort-error' });\n        dialogElem.appendChild(errorElem);\n        return dialogElem;\n    };\n    /**\n     * Gets the fields data from the selected range.\n     */\n    Sort.prototype.getFields = function () {\n        var sheet = this.parent.getActiveSheet();\n        var range = getSwapRange(getIndexesFromAddress(sheet.selectedRange));\n        if (range[0] === range[2] && (range[2] - range[0]) === 0) { //for entire range\n            range[0] = 0;\n            range[1] = 0;\n            range[3] = sheet.usedRange.colIndex;\n            var args = { filterRange: [], hasFilter: false };\n            this.parent.notify(getFilterRange, args);\n            if (args.hasFilter && args.filterRange) {\n                range[0] = args.filterRange[0];\n            }\n        }\n        var fields = [];\n        var fieldName;\n        for (range[1]; range[1] <= range[3]; range[1]++) {\n            var cell = getCell(range[0], range[1], sheet);\n            if (cell && cell.value) {\n                var eventArgs = {\n                    formattedText: cell.value,\n                    value: cell.value,\n                    format: cell.format,\n                    onLoad: true\n                };\n                if (cell.format) {\n                    this.parent.notify(getFormattedCellObject, eventArgs);\n                }\n                fieldName = eventArgs.formattedText;\n            }\n            else {\n                fieldName = 'Column ' + getColumnHeaderText(range[1] + 1);\n            }\n            fields.push({ text: fieldName, value: 'Column ' + getColumnHeaderText(range[1] + 1) });\n        }\n        return fields;\n    };\n    /**\n     * Creates the header tab for the custom sort dialog.\n     * @param dialogElem - dialog content element.\n     * @param listviewObj - listview instance.\n     * @param fields - fields data.\n     */\n    Sort.prototype.setHeaderTab = function (dialogElem, listviewObj, fields) {\n        var _this = this;\n        var l10n = this.parent.serviceLocator.getService(locale);\n        var headerTabElement = this.parent.createElement('div', {\n            className: 'e-sort-header',\n            styles: '',\n            innerHTML: ''\n        });\n        dialogElem.appendChild(headerTabElement);\n        var addButton = this.parent.createElement('button', {\n            className: 'e-btn e-sort-addbtn e-flat',\n            innerHTML: l10n.getConstant('AddColumn')\n        });\n        var footer = this.parent.element.querySelector('.e-customsort-dlg .e-footer-content');\n        footer.insertBefore(addButton, footer.firstElementChild);\n        addButton.addEventListener('click', function () {\n            if (listviewObj) {\n                var listId = getUniqueID('customSort');\n                listviewObj.addItem([{ id: listId, text: l10n.getConstant('ThenBy'), field: '', order: 'ascending' }]);\n                _this.renderListItem(listId, listviewObj, checkHeaderObj.checked, fields, true);\n            }\n        });\n        var checkHeaderObj = new CheckBox({\n            label: l10n.getConstant('ContainsHeader'),\n            checked: true,\n            change: function (args) {\n                var fieldsMap = args.checked ? { text: 'text', value: 'value' } : { text: 'value' };\n                Array.prototype.forEach.call(dialogElem.getElementsByClassName('e-sort-field e-dropdownlist e-lib'), function (dropDown) {\n                    var dropDownListObj = getComponent(dropDown, 'dropdownlist');\n                    dropDownListObj.dataSource = null; //reset datasource.\n                    dropDownListObj.dataSource = fields;\n                    dropDownListObj.fields = fieldsMap;\n                    dropDownListObj.dataBind();\n                });\n            },\n            cssClass: 'e-sort-headercheckbox'\n        });\n        var headerCheckbox = this.parent.createElement('input', {\n            className: 'e-sort-checkheader', attrs: { type: 'checkbox' }\n        });\n        headerTabElement.appendChild(headerCheckbox);\n        checkHeaderObj.createElement = this.parent.createElement;\n        checkHeaderObj.appendTo(headerCheckbox);\n        var checkCaseObj = new CheckBox({\n            label: l10n.getConstant('CaseSensitive'),\n            checked: false,\n            cssClass: 'e-sort-casecheckbox'\n        });\n        var caseCheckbox = this.parent.createElement('input', {\n            className: 'e-sort-checkcase', attrs: { type: 'checkbox' }\n        });\n        headerTabElement.appendChild(caseCheckbox);\n        checkCaseObj.createElement = this.parent.createElement;\n        checkCaseObj.appendTo(caseCheckbox);\n    };\n    /**\n     * Creates a listview instance.\n     * @param listId - unique id of the list item.\n     */\n    Sort.prototype.getCustomListview = function (listId) {\n        var l10n = this.parent.serviceLocator.getService(locale);\n        var data = [{ id: listId, text: l10n.getConstant('SortBy'), field: '', order: 'ascending' }];\n        enableRipple(false);\n        var listviewObj = new ListView({\n            dataSource: data,\n            fields: { id: 'id' },\n            height: '100%',\n            template: '<div class=\"e-sort-listwrapper\">' +\n                '<span class=\"text\">${text}</span>' +\n                '<div class=\"e-sort-row\"><div class=\"e-sort-field\"></div>' +\n                '<div class=\"e-sort-order\">' +\n                '<span class=\"e-sort-ordertxt\" style=\"display:none;\">${order}</span></div>' +\n                '<span class=\"e-icons e-sort-delete\"></span></div>',\n            cssClass: 'e-sort-template',\n        });\n        return listviewObj;\n    };\n    /**\n     * Triggers the click event for delete icon.\n     * @param element - current list item element.\n     * @param listviewObj - listview instance.\n     */\n    Sort.prototype.deleteHandler = function (element, listviewObj) {\n        var iconEle = element.getElementsByClassName('e-sort-delete')[0];\n        //Event handler to bind the click event for delete icon\n        iconEle.addEventListener('click', function () {\n            if (element) {\n                listviewObj.removeItem(element);\n            }\n        });\n    };\n    /**\n     * Renders the dropdown and radio button components inside list item.\n     * @param id - unique id of the list item.\n     * @param listviewObj - listview instance.\n     * @param containsHeader - data contains header.\n     * @param fields - fields data.\n     */\n    Sort.prototype.renderListItem = function (id, lvObj, containsHeader, fields, btn) {\n        var _this = this;\n        var l10n = this.parent.serviceLocator.getService(locale);\n        var element = lvObj.element.querySelector('li[data-uid=' + id + ']');\n        var fieldsMap = containsHeader ? { text: 'text', value: 'value' } : { text: 'value' };\n        var dropDown = element.getElementsByClassName('e-sort-field')[0];\n        var dropDownListObj = new DropDownList({\n            dataSource: fields,\n            width: 'auto',\n            cssClass: 'e-sort-field-ddl',\n            fields: fieldsMap,\n            placeholder: l10n.getConstant('SelectAColumn'),\n            change: function (args) {\n                if (!args.value) {\n                    return;\n                }\n                Array.prototype.some.call(lvObj.dataSource, function (item) {\n                    if (item.id === id) {\n                        item.field = args.value.toString().replace('Column ', '');\n                    }\n                    return item.id === id; //breaks the loop when proper id found\n                });\n                _this.clearError();\n            }\n        });\n        dropDownListObj.createElement = this.parent.createElement;\n        dropDownListObj.appendTo(dropDown);\n        if (!btn) {\n            dropDownListObj.index = 0;\n        }\n        /* sort ascending radio button */\n        var orderRadio = element.getElementsByClassName('e-sort-order')[0];\n        var ordertxtElem = orderRadio.getElementsByClassName('e-sort-ordertxt')[0];\n        var isAscending = ordertxtElem.innerText.toLocaleLowerCase() === 'ascending';\n        var radiobutton = new RadioButton({\n            label: l10n.getConstant('SortAscending'),\n            name: 'sortAZ_' + id, value: 'ascending', checked: isAscending, cssClass: 'e-sort-radiobutton',\n            change: function (args) { _this.setRadioBtnValue(lvObj, id, args.value); }\n        });\n        var radio = this.parent.createElement('input', {\n            id: 'orderAsc_' + id, className: 'e-sort-radioasc', styles: '', attrs: { type: 'radio' }\n        });\n        orderRadio.appendChild(radio);\n        radiobutton.createElement = this.parent.createElement;\n        radiobutton.appendTo(radio);\n        /* sort descending radio button */\n        var radiobutton2 = new RadioButton({\n            label: l10n.getConstant('SortDescending'),\n            name: 'sortAZ_' + id, value: 'descending', checked: !isAscending, cssClass: 'e-sort-radiobutton',\n            change: function (args) { _this.setRadioBtnValue(lvObj, id, args.value); }\n        });\n        var radio2 = this.parent.createElement('input', {\n            id: 'orderDesc_' + id, className: 'e-sort-radiodesc', styles: '', attrs: { type: 'radio' }\n        });\n        orderRadio.appendChild(radio2);\n        radiobutton2.createElement = this.parent.createElement;\n        radiobutton2.appendTo(radio2);\n        this.deleteHandler(element, lvObj);\n    };\n    /**\n     * Sets the new value of the radio button.\n     * @param listviewObj - listview instance.\n     * @param id - unique id of the list item.\n     * @param value - new value.\n     */\n    Sort.prototype.setRadioBtnValue = function (listviewObj, id, value) {\n        if (!value) {\n            return;\n        }\n        Array.prototype.some.call(listviewObj.dataSource, function (item) {\n            if (item.id === id) {\n                item.order = value;\n            }\n            return item.id === id; //breaks the loop when proper id found\n        });\n    };\n    /**\n     * Clears the error from the dialog.\n     * @param dialogElem - dialog content element.\n     */\n    Sort.prototype.clearError = function () {\n        var dialogElem = document.getElementsByClassName('e-sort-dialog')[0];\n        var errorElem = dialogElem.getElementsByClassName('e-sort-error')[0];\n        if (errorElem.style.display !== 'none' && errorElem.innerHTML !== '') {\n            errorElem.style.display = 'none';\n            Array.prototype.forEach.call(dialogElem.getElementsByClassName('e-error'), function (element) {\n                element.classList.remove('e-error');\n            });\n        }\n    };\n    /**\n     * Triggers sort events and applies sorting.\n     */\n    Sort.prototype.applySortHandler = function (args) {\n        var _this = this;\n        var sheet = this.parent.getActiveSheet();\n        var address = args && args.range || sheet.selectedRange;\n        var sortOptions = args && args.sortOptions || { sortDescriptors: {} };\n        var beforeArgs = { range: address, sortOptions: sortOptions, cancel: false };\n        this.parent.trigger(beforeSort, beforeArgs);\n        if (beforeArgs.cancel) {\n            return;\n        }\n        this.parent.notify(beginAction, { eventArgs: beforeArgs, action: 'beforeSort' });\n        this.parent.showSpinner();\n        var range = getSwapRange(getIndexesFromAddress(beforeArgs.range));\n        var eventArgs = { filterRange: [], hasFilter: false };\n        if (range[0] === range[2] && (range[2] - range[0]) === 0) { //check for filter range\n            this.parent.notify(getFilterRange, eventArgs);\n            if (eventArgs.hasFilter && eventArgs.filterRange) {\n                range[0] = eventArgs.filterRange[0];\n                range[1] = 0;\n                range[2] = sheet.usedRange.rowIndex - 1;\n                range[3] = sheet.usedRange.colIndex;\n                beforeArgs.sortOptions.containsHeader = true;\n            }\n        }\n        this.parent.sort(beforeArgs.sortOptions, getRangeAddress(range)).then(function (sortArgs) {\n            _this.parent.trigger(sortComplete, sortArgs);\n            _this.parent.notify(completeAction, { eventArgs: sortArgs, action: 'sorting' });\n            return Promise.resolve(sortArgs);\n        }).catch(function (error) {\n            _this.sortRangeAlertHandler({ error: error });\n            return Promise.reject(error);\n        });\n    };\n    /**\n     * Invoked when the sort action is completed.\n     */\n    Sort.prototype.sortCompleteHandler = function (args) {\n        var range = getIndexesFromAddress(args.range);\n        if (args.sortOptions.containsHeader) {\n            range[0] += 1;\n        }\n        this.parent.serviceLocator.getService('cell').refreshRange(range);\n        this.parent.hideSpinner();\n    };\n    return Sort;\n}());\nexport { Sort };\n","import { locale, dialog, mouseDown, renderFilterCell, initiateFilterUI, reapplyFilter, filterCellKeyDown } from '../index';\nimport { getFilteredColumn, cMenuBeforeOpen, filterByCellValue, clearFilter, getFilterRange, applySort } from '../index';\nimport { filterRangeAlert, filterComplete, beforeFilter, clearAllFilter } from '../../workbook/common/event';\nimport { getIndexesFromAddress, getSwapRange, getColumnHeaderText, getCellPosition } from '../../workbook/index';\nimport { getData, getTypeFromFormat, getCell, getCellIndexes, getRangeAddress, getSheet } from '../../workbook/index';\nimport { getComponent } from '@syncfusion/ej2-base';\nimport { ExcelFilterBase, beforeFltrcMenuOpen, CheckBoxFilterBase } from '@syncfusion/ej2-grids';\nimport { beforeCustomFilterOpen, parentsUntil, filterCboxValue } from '@syncfusion/ej2-grids';\nimport { Button } from '@syncfusion/ej2-buttons';\nimport { Query, DataManager } from '@syncfusion/ej2-data';\n/**\n * `Filter` module is used to handle the filter action in Spreadsheet.\n */\nvar Filter = /** @class */ (function () {\n    /**\n     * Constructor for filter module.\n     */\n    function Filter(parent) {\n        this.parent = parent;\n        this.filterCollection = new Map();\n        this.filterClassList = new Map();\n        this.filterRange = new Map();\n        this.addEventListener();\n    }\n    /**\n     * To destroy the filter module.\n     * @return {void}\n     */\n    Filter.prototype.destroy = function () {\n        this.removeEventListener();\n        this.filterRange = null;\n        this.filterCollection = null;\n        this.filterClassList = null;\n        this.parent = null;\n    };\n    Filter.prototype.addEventListener = function () {\n        this.parent.on(filterRangeAlert, this.filterRangeAlertHandler, this);\n        this.parent.on(initiateFilterUI, this.initiateFilterUIHandler, this);\n        this.parent.on(mouseDown, this.filterMouseDownHandler, this);\n        this.parent.on(renderFilterCell, this.renderFilterCellHandler, this);\n        this.parent.on(clearAllFilter, this.clearAllFilterHandler, this);\n        this.parent.on(beforeFltrcMenuOpen, this.beforeFilterMenuOpenHandler, this);\n        this.parent.on(beforeCustomFilterOpen, this.beforeCustomFilterOpenHandler, this);\n        this.parent.on(reapplyFilter, this.reapplyFilterHandler, this);\n        this.parent.on(filterByCellValue, this.filterByCellValueHandler, this);\n        this.parent.on(clearFilter, this.clearFilterHandler, this);\n        this.parent.on(getFilteredColumn, this.getFilteredColumnHandler, this);\n        this.parent.on(cMenuBeforeOpen, this.cMenuBeforeOpenHandler, this);\n        this.parent.on(filterCboxValue, this.filterCboxValueHandler, this);\n        this.parent.on(getFilterRange, this.getFilterRangeHandler, this);\n        this.parent.on(filterCellKeyDown, this.filterCellKeyDownHandler, this);\n    };\n    Filter.prototype.removeEventListener = function () {\n        if (!this.parent.isDestroyed) {\n            this.parent.off(filterRangeAlert, this.filterRangeAlertHandler);\n            this.parent.off(initiateFilterUI, this.initiateFilterUIHandler);\n            this.parent.off(mouseDown, this.filterMouseDownHandler);\n            this.parent.off(renderFilterCell, this.renderFilterCellHandler);\n            this.parent.off(clearAllFilter, this.clearAllFilterHandler);\n            this.parent.off(beforeFltrcMenuOpen, this.beforeFilterMenuOpenHandler);\n            this.parent.off(beforeCustomFilterOpen, this.beforeCustomFilterOpenHandler);\n            this.parent.off(reapplyFilter, this.reapplyFilterHandler);\n            this.parent.off(filterByCellValue, this.filterByCellValueHandler);\n            this.parent.off(clearFilter, this.clearFilterHandler);\n            this.parent.off(getFilteredColumn, this.getFilteredColumnHandler);\n            this.parent.off(cMenuBeforeOpen, this.cMenuBeforeOpenHandler);\n            this.parent.on(filterCboxValue, this.filterCboxValueHandler);\n            this.parent.off(getFilterRange, this.getFilterRangeHandler);\n            this.parent.off(filterCellKeyDown, this.filterCellKeyDownHandler);\n        }\n    };\n    /**\n     * Gets the module name.\n     * @returns string\n     */\n    Filter.prototype.getModuleName = function () {\n        return 'filter';\n    };\n    /**\n     * Validates the range and returns false when invalid.\n     */\n    Filter.prototype.isInValidFilterRange = function (sheet) {\n        var selectedRange = getSwapRange(getIndexesFromAddress(sheet.selectedRange));\n        return selectedRange[0] > sheet.usedRange.rowIndex - 1 || selectedRange[1] > sheet.usedRange.colIndex;\n    };\n    /**\n     * Shows the range error alert dialog.\n     * @param error - range error string.\n     */\n    Filter.prototype.filterRangeAlertHandler = function (args) {\n        var dialogInst = this.parent.serviceLocator.getService(dialog);\n        dialogInst.show({\n            content: args.error, isModal: true,\n            height: 180, width: 400, showCloseIcon: true,\n        });\n        this.parent.hideSpinner();\n    };\n    /**\n     * Triggers before filter context menu opened and used to add sorting items.\n     */\n    Filter.prototype.beforeFilterMenuOpenHandler = function (args) {\n        var l10n = this.parent.serviceLocator.getService(locale);\n        args.element.classList.add('e-spreadsheet-contextmenu'); // to show sort icons\n        var ul = args.element.querySelector('ul');\n        this.addMenuItem(ul, l10n.getConstant('SortDescending'), 'e-filter-sortdesc', 'e-sort-desc');\n        this.addMenuItem(ul, l10n.getConstant('SortAscending'), 'e-filter-sortasc', 'e-sort-asc');\n        args.element.appendChild(ul);\n    };\n    /**\n     * Creates new menu item element\n     */\n    Filter.prototype.addMenuItem = function (ul, text, className, iconCss) {\n        var li = this.parent.createElement('li', { className: className + ' e-menu-item' });\n        li.innerHTML = text;\n        li.insertBefore(this.parent.createElement('span', { className: 'e-menu-icon e-icons ' + iconCss }), li.firstChild);\n        ul.insertBefore(li, ul.firstChild);\n    };\n    /**\n     * Initiates the filter UI for the selected range.\n     */\n    Filter.prototype.initiateFilterUIHandler = function (args) {\n        var _this = this;\n        var predicates = args ? args.predicates : null;\n        var sheetIdx = this.parent.activeSheetTab - 1;\n        if (this.filterRange.size > 0 && this.filterRange.has(sheetIdx)) { //disable filter\n            this.removeFilter(sheetIdx);\n            if (!predicates) {\n                return;\n            }\n        }\n        var sheet = getSheet(this.parent, sheetIdx);\n        if (this.isInValidFilterRange(sheet)) {\n            var l10n = this.parent.serviceLocator.getService(locale);\n            this.filterRangeAlertHandler({ error: l10n.getConstant('FilterOutOfRangeError') });\n            return;\n        }\n        this.processRange(sheet, sheetIdx, args ? args.range : null);\n        if (predicates) {\n            var range = this.filterRange.get(sheetIdx).slice();\n            range[0] = range[0] + 1; // to skip first row.\n            range[2] = sheet.usedRange.rowIndex - 1; //filter range should be till used range.\n            getData(this.parent, sheet.name + \"!\" + getRangeAddress(range), true, true).then(function (jsonData) {\n                _this.filterSuccessHandler(new DataManager(jsonData), { action: 'filtering', filterCollection: predicates, field: predicates[0].field });\n                predicates.forEach(function (predicate) {\n                    if (_this.filterClassList.get(sheetIdx)[predicate.field].indexOf(' e-filtered') < 0) {\n                        _this.filterClassList.get(sheetIdx)[predicate.field] += ' e-filtered';\n                    }\n                });\n                _this.refreshFilterRange();\n            });\n        }\n    };\n    /**\n     * Processes the range if no filter applied.\n     */\n    Filter.prototype.processRange = function (sheet, sheetIdx, filterRange) {\n        var range = getSwapRange(getIndexesFromAddress(filterRange || sheet.selectedRange));\n        if (range[0] === range[2] && (range[2] - range[0]) === 0) { //if selected range is a single cell \n            range[0] = 0;\n            range[1] = 0;\n            range[2] = sheet.usedRange.rowIndex - 1;\n            range[3] = sheet.usedRange.colIndex;\n        }\n        this.filterRange.set(sheetIdx, range);\n        this.filterCollection.set(sheetIdx, []);\n        this.filterClassList.set(sheetIdx, {});\n        this.refreshFilterRange(range);\n    };\n    /**\n     * Removes all the filter related collections for the active sheet.\n     */\n    Filter.prototype.removeFilter = function (sheetIdx) {\n        if (this.filterCollection.get(sheetIdx).length) {\n            this.parent.clearFilter();\n        }\n        var range = this.filterRange.get(sheetIdx).slice();\n        this.filterRange.delete(sheetIdx);\n        this.filterCollection.delete(sheetIdx);\n        this.filterClassList.delete(sheetIdx);\n        this.refreshFilterRange(range, true);\n    };\n    /**\n     * Handles filtering cell value based on context menu.\n     */\n    Filter.prototype.filterByCellValueHandler = function () {\n        var _this = this;\n        var sheetIdx = this.parent.activeSheetTab - 1;\n        var sheet = this.parent.getActiveSheet();\n        if (this.isInValidFilterRange(sheet)) {\n            var l10n = this.parent.serviceLocator.getService(locale);\n            this.filterRangeAlertHandler({ error: l10n.getConstant('FilterOutOfRangeError') });\n            return;\n        }\n        var cell = getCellIndexes(sheet.activeCell);\n        if (!this.isFilterRange(sheetIdx, cell[0], cell[1])) {\n            this.processRange(sheet, sheetIdx);\n        }\n        var range = this.filterRange.get(sheetIdx).slice();\n        range[0] = range[0] + 1; // to skip first row.\n        range[2] = sheet.usedRange.rowIndex - 1; //filter range should be till used range.\n        var field = getColumnHeaderText(cell[1] + 1);\n        var type = this.getColumnType(sheet, cell[1] + 1, range);\n        var predicates = [{\n                field: field,\n                operator: type === 'date' || type === 'datetime' || type === 'boolean' ? 'equal' : 'contains',\n                value: getCell(cell[0], cell[1], sheet).value, matchCase: false, type: type\n            }];\n        getData(this.parent, sheet.name + \"!\" + getRangeAddress(range), true, true).then(function (jsonData) {\n            _this.filterSuccessHandler(new DataManager(jsonData), { action: 'filtering', filterCollection: predicates, field: field });\n        });\n    };\n    /**\n     * Creates filter buttons and renders the filter applied cells.\n     */\n    Filter.prototype.renderFilterCellHandler = function (args) {\n        var sheetIdx = this.parent.activeSheetTab - 1;\n        if (this.filterRange.has(sheetIdx) && this.isFilterCell(sheetIdx, args.rowIndex, args.colIndex)) {\n            if (!args.td) {\n                return;\n            }\n            var field = getColumnHeaderText(args.colIndex + 1);\n            if (this.filterClassList.has(sheetIdx) && !this.filterClassList.get(sheetIdx)[field]) {\n                this.filterClassList.get(sheetIdx)[field] = '';\n            }\n            if (args.td.querySelector('.e-filter-btn')) {\n                var element = args.td.querySelector('.e-filter-iconbtn');\n                var filterBtnObj = getComponent(element, 'btn');\n                filterBtnObj.iconCss = 'e-icons e-filter-icon' + this.filterClassList.get(sheetIdx)[field];\n            }\n            else {\n                var filterButton = this.parent.createElement('div', { className: 'e-filter-btn' });\n                var filterBtnObj = new Button({ iconCss: 'e-icons e-filter-icon' + this.filterClassList.get(sheetIdx)[field], cssClass: 'e-filter-iconbtn' });\n                args.td.insertBefore(filterButton, args.td.firstChild);\n                filterBtnObj.createElement = this.parent.createElement;\n                filterBtnObj.appendTo(filterButton);\n            }\n        }\n    };\n    /**\n     * Refreshes the filter header range.\n     */\n    Filter.prototype.refreshFilterRange = function (filterRange, remove) {\n        var range = filterRange || this.filterRange.get(this.parent.activeSheetTab - 1).slice();\n        for (var index = range[1]; index <= range[3]; index++) {\n            var cell = this.parent.getCell(range[0], index);\n            if (remove) {\n                if (cell.hasChildNodes()) {\n                    var element = cell.querySelector('.e-filter-btn');\n                    cell.removeChild(element);\n                }\n            }\n            else {\n                this.renderFilterCellHandler({ td: cell, rowIndex: range[0], colIndex: index });\n            }\n        }\n    };\n    /**\n     * Checks whether the provided cell is a filter cell.\n     */\n    Filter.prototype.isFilterCell = function (sheetIdx, rowIndex, colIndex) {\n        var range = this.filterRange.get(sheetIdx);\n        return (range && range[0] === rowIndex && range[1] <= colIndex && range[3] >= colIndex);\n    };\n    /**\n     * Checks whether the provided cell is in a filter range\n     */\n    Filter.prototype.isFilterRange = function (sheetIdx, rowIndex, colIndex) {\n        var range = this.filterRange.get(sheetIdx);\n        return (range && range[0] <= rowIndex && range[2] >= rowIndex && range[1] <= colIndex && range[3] >= colIndex);\n    };\n    /**\n     * Gets the filter information from active cell\n     */\n    Filter.prototype.getFilteredColumnHandler = function (args) {\n        var sheetIdx = this.parent.activeSheetTab - 1;\n        var l10n = this.parent.serviceLocator.getService(locale);\n        args.clearFilterText = l10n.getConstant('ClearFilter');\n        if (this.filterRange.has(sheetIdx)) {\n            var filterCollection = this.filterCollection.get(sheetIdx);\n            if (args.isClearAll) {\n                args.isFiltered = filterCollection && filterCollection.length > 0;\n                return;\n            }\n            var range = this.filterRange.get(sheetIdx).slice();\n            var sheet = this.parent.getActiveSheet();\n            var cell = getCellIndexes(sheet.activeCell);\n            if (this.isFilterRange(sheetIdx, cell[0], cell[1])) {\n                args.field = getColumnHeaderText(cell[1] + 1);\n                var headerCell = getCell(range[0], cell[1], sheet);\n                var cellValue = this.parent.getDisplayText(headerCell);\n                args.clearFilterText = l10n.getConstant('ClearFilterFrom') + '\\\"'\n                    + (cellValue ? cellValue.toString() : 'Column ' + args.field) + '\\\"';\n                filterCollection.some(function (value) {\n                    args.isFiltered = value.field === args.field;\n                    return args.isFiltered;\n                });\n            }\n        }\n    };\n    /**\n     * Triggers before context menu created to enable or disable items.\n     */\n    Filter.prototype.cMenuBeforeOpenHandler = function (e) {\n        var id = this.parent.element.id + '_cmenu';\n        if (e.parentItem && e.parentItem.id === id + '_filter' && e.target === '') {\n            var args = { isFiltered: false };\n            this.getFilteredColumnHandler(args);\n            this.parent.enableContextMenuItems([id + '_clearfilter', id + '_reapplyfilter'], !!args.isFiltered, true);\n        }\n    };\n    /**\n     * Closes the filter popup.\n     */\n    Filter.prototype.closeDialog = function () {\n        var filterPopup = this.parent.element.querySelector('.e-filter-popup');\n        var excelFilter = getComponent(filterPopup, 'dialog');\n        if (excelFilter) {\n            excelFilter.hide();\n        }\n    };\n    /**\n     * Returns true if the filter popup is opened.\n     */\n    Filter.prototype.isPopupOpened = function () {\n        var filterPopup = this.parent.element.querySelector('.e-filter-popup');\n        return filterPopup && filterPopup.style.display !== 'none';\n    };\n    Filter.prototype.filterCellKeyDownHandler = function (args) {\n        var sheetIdx = this.parent.activeSheetTab - 1;\n        var sheet = this.parent.getActiveSheet();\n        var indexes = getCellIndexes(sheet.activeCell);\n        if (this.isFilterCell(sheetIdx, indexes[0], indexes[1])) {\n            args.isFilterCell = true;\n            var pos = getCellPosition(sheet, indexes);\n            var target = this.parent.getCell(indexes[0], indexes[1]);\n            if (this.isPopupOpened()) {\n                this.closeDialog();\n            }\n            this.openDialog(target, pos.left, pos.top);\n        }\n        else {\n            args.isFilterCell = false;\n        }\n    };\n    /**\n     * Opens the filter popup dialog on filter button click.\n     */\n    Filter.prototype.filterMouseDownHandler = function (e) {\n        var target = e.target;\n        if (target.classList.contains('e-filter-icon')) {\n            if (this.isPopupOpened()) {\n                this.closeDialog();\n                return;\n            }\n            this.openDialog(target, e.x, e.y);\n        }\n        else if (this.isPopupOpened()) {\n            if (!target.classList.contains('e-searchinput') && !target.classList.contains('e-searchclear')\n                && (target.offsetParent && !target.offsetParent.classList.contains('e-filter-popup'))) {\n                this.closeDialog();\n            }\n            else {\n                this.selectSortItemHandler(target);\n            }\n        }\n    };\n    /**\n     * Opens the excel filter dialog based on target.\n     */\n    Filter.prototype.openDialog = function (target, xPos, yPos) {\n        var _this = this;\n        var cell = parentsUntil(target, 'e-cell');\n        var colIndex = parseInt(cell.getAttribute('aria-colindex'), 10);\n        var field = getColumnHeaderText(colIndex);\n        //Update datasource dynamically\n        this.parent.showSpinner();\n        var sheetIdx = this.parent.activeSheetTab - 1;\n        var range = this.filterRange.get(sheetIdx).slice();\n        var sheet = this.parent.getActiveSheet();\n        var filterCell = getCell(range[0], colIndex - 1, sheet);\n        var displayName = this.parent.getDisplayText(filterCell);\n        range[0] = range[0] + 1; // to skip first row.\n        range[2] = sheet.usedRange.rowIndex - 1; //filter range should be till used range.\n        getData(this.parent, sheet.name + \"!\" + getRangeAddress(range), true, true).then(function (jsonData) {\n            //to avoid undefined array data\n            var checkBoxData;\n            jsonData.some(function (value, index) {\n                if (value) {\n                    checkBoxData = new DataManager(jsonData.slice(index));\n                }\n                return !!value;\n            });\n            var options = {\n                type: _this.getColumnType(sheet, colIndex, range), field: field, displayName: displayName || 'Column ' + field,\n                dataSource: checkBoxData, height: _this.parent.element.classList.contains('e-bigger') ? 800 : 500, columns: [],\n                hideSearchbox: false, filteredColumns: _this.filterCollection.get(sheetIdx), column: { 'field': field, 'filter': {} },\n                handler: _this.filterSuccessHandler.bind(_this, new DataManager(jsonData)), target: target,\n                position: { X: xPos, Y: yPos }, localeObj: _this.parent.serviceLocator.getService(locale)\n            };\n            var excelFilter = new ExcelFilterBase(_this.parent, _this.getLocalizedCustomOperators());\n            excelFilter.openDialog(options);\n            var filterPopup = _this.parent.element.querySelector('.e-filter-popup');\n            filterPopup.classList.add('e-grid'); //Need to remove this once separate style provided.\n            _this.parent.hideSpinner();\n        });\n    };\n    /**\n     * Formats cell value for listing it in filter popup.\n     */\n    Filter.prototype.filterCboxValueHandler = function (args) {\n        if (args.column && args.data) {\n            var fieldKey = 'field';\n            var field = args.column[fieldKey];\n            var dataKey = 'dataObj';\n            var rowKey = '__rowIndex';\n            var indexes = getCellIndexes(field + args.data[dataKey][rowKey]);\n            var cell = getCell(indexes[0], indexes[1], this.parent.getActiveSheet());\n            if (cell && cell.format) {\n                args.value = this.parent.getDisplayText(cell);\n            }\n        }\n    };\n    /**\n     * Triggers when sorting items are chosen on context menu of filter popup.\n     */\n    Filter.prototype.selectSortItemHandler = function (target) {\n        var sheetIdx = this.parent.activeSheetTab - 1;\n        var sortOrder = target.classList.contains('e-filter-sortasc') ? 'Ascending'\n            : target.classList.contains('e-filter-sortdesc') ? 'Descending' : null;\n        if (!sortOrder) {\n            return;\n        }\n        var sheet = this.parent.getActiveSheet();\n        var range = this.filterRange.get(sheetIdx).slice();\n        range[0] = range[0] + 1; // to skip first row.\n        range[2] = sheet.usedRange.rowIndex - 1; //filter range should be till used range.\n        this.parent.notify(applySort, { sortOptions: { sortDescriptors: { order: sortOrder } }, range: getRangeAddress(range) });\n        var cell = getIndexesFromAddress(sheet.activeCell);\n        var field = getColumnHeaderText(cell[1] + 1);\n        for (var _i = 0, _a = Object.keys(this.filterClassList.get(sheetIdx)); _i < _a.length; _i++) {\n            var key = _a[_i];\n            var className = this.filterClassList.get(sheetIdx)[key].replace(/\\se-sortasc-filter|\\se-sortdesc-filter/gi, '');\n            if (key === field) {\n                className += sortOrder === 'Ascending' ? ' e-sortasc-filter' : ' e-sortdesc-filter';\n            }\n            this.filterClassList.get(sheetIdx)[key] = className;\n        }\n        this.refreshFilterRange();\n        this.closeDialog();\n    };\n    /**\n     * Triggers when OK button or clear filter item is selected\n     */\n    Filter.prototype.filterSuccessHandler = function (dataSource, args) {\n        var sheetIdx = this.parent.activeSheetTab - 1;\n        var predicates = this.filterCollection.get(sheetIdx);\n        var dataManager = new DataManager(predicates);\n        var query = new Query();\n        var fields = dataManager.executeLocal(query.where('field', 'equal', args.field));\n        for (var index = 0; index < fields.length; index++) {\n            var sameIndex = -1;\n            for (var filterIndex = 0; filterIndex < predicates.length; filterIndex++) {\n                if (predicates[filterIndex].field === fields[index].field) {\n                    sameIndex = filterIndex;\n                    break;\n                }\n            }\n            if (sameIndex !== -1) {\n                predicates.splice(sameIndex, 1);\n            }\n        }\n        if (args.action === 'filtering') {\n            predicates = predicates.concat(args.filterCollection);\n            if (predicates.length && this.filterClassList.get(sheetIdx)[args.field].indexOf(' e-filtered') < 0) {\n                this.filterClassList.get(sheetIdx)[args.field] += ' e-filtered';\n            }\n        }\n        else {\n            this.filterClassList.get(sheetIdx)[args.field] = this.filterClassList.get(sheetIdx)[args.field].replace(' e-filtered', '');\n        }\n        this.filterCollection.set(sheetIdx, predicates);\n        var filterOptions = {\n            datasource: dataSource,\n            predicates: this.getPredicates(sheetIdx),\n        };\n        this.filterRange.get(sheetIdx)[2] = getSheet(this.parent, sheetIdx).usedRange.rowIndex - 1; //extend the range if filtered\n        this.applyFilter(filterOptions, getRangeAddress(this.filterRange.get(sheetIdx)));\n    };\n    /**\n     * Triggers events for filtering and applies filter.\n     */\n    Filter.prototype.applyFilter = function (filterOptions, range) {\n        var _this = this;\n        var args = { range: range, filterOptions: filterOptions, cancel: false };\n        this.parent.trigger(beforeFilter, args);\n        if (args.cancel) {\n            return;\n        }\n        this.parent.showSpinner();\n        this.parent.filter(filterOptions, range).then(function (args) {\n            _this.refreshFilterRange();\n            _this.parent.hideSpinner();\n            _this.parent.trigger(filterComplete, args);\n            return Promise.resolve(args);\n        }).catch(function (error) {\n            _this.filterRangeAlertHandler({ error: error });\n            return Promise.reject(error);\n        });\n    };\n    /**\n     * Gets the predicates for the sheet\n     */\n    Filter.prototype.getPredicates = function (sheetIdx) {\n        var predicateList = [];\n        var excelPredicate = CheckBoxFilterBase.getPredicate(this.filterCollection.get(sheetIdx));\n        for (var _i = 0, _a = Object.keys(excelPredicate); _i < _a.length; _i++) {\n            var prop = _a[_i];\n            predicateList.push(excelPredicate[prop]);\n        }\n        return predicateList;\n    };\n    /**\n     * Gets the column type to pass it into the excel filter options.\n     */\n    Filter.prototype.getColumnType = function (sheet, colIndex, range) {\n        var num = 0;\n        var str = 0;\n        var date = 0;\n        var time = 0;\n        for (var i = range[0]; i <= sheet.usedRange.rowIndex - 1; i++) {\n            var cell = getCell(i, colIndex - 1, sheet);\n            if (cell) {\n                if (cell.format) {\n                    var type = getTypeFromFormat(cell.format).toLowerCase();\n                    switch (type) {\n                        case 'number':\n                        case 'currency':\n                        case 'accounting':\n                        case 'percentage':\n                            num++;\n                            break;\n                        case 'shortdate':\n                        case 'longdate':\n                            date++;\n                            break;\n                        case 'time':\n                            num++;\n                            break;\n                        default:\n                            str++;\n                            break;\n                    }\n                }\n                else {\n                    if (typeof cell.value === 'string') {\n                        str++;\n                    }\n                    else {\n                        num++;\n                    }\n                }\n            }\n            else {\n                str++;\n            }\n        }\n        return (num > str && num > date && num > time) ? 'number' : (str > num && str > date && str > time) ? 'string'\n            : (date > num && date > str && date > time) ? 'date' : 'datetime';\n    };\n    /**\n     * Triggers before the custom filter dialog opened.\n     */\n    Filter.prototype.beforeCustomFilterOpenHandler = function () {\n        this.closeDialog();\n    };\n    /**\n     * Clears all the filtered columns in the active sheet.\n     */\n    Filter.prototype.clearAllFilterHandler = function () {\n        var sheetIdx = this.parent.activeSheetTab - 1;\n        if (this.filterRange.has(sheetIdx)) {\n            this.filterCollection.set(sheetIdx, []);\n            for (var _i = 0, _a = Object.keys(this.filterClassList.get(sheetIdx)); _i < _a.length; _i++) {\n                var key = _a[_i];\n                this.filterClassList.get(sheetIdx)[key] = '';\n            }\n            this.refreshFilterRange();\n        }\n    };\n    /**\n     * Clear filter from the field.\n     */\n    Filter.prototype.clearFilterHandler = function (args) {\n        this.filterSuccessHandler(null, { action: 'clear-filter', filterCollection: [], field: args.field });\n    };\n    /**\n     * Reapplies the filter.\n     */\n    Filter.prototype.reapplyFilterHandler = function () {\n        var sheetIdx = this.parent.activeSheetTab - 1;\n        if (this.filterRange.has(sheetIdx)) {\n            this.applyFilter({ predicates: this.getPredicates(sheetIdx) }, getRangeAddress(this.filterRange.get(sheetIdx)));\n        }\n    };\n    /**\n     * Gets the filter information of the sheet.\n     */\n    Filter.prototype.getFilterRangeHandler = function (args) {\n        var sheetIdx = args.sheetIdx || this.parent.activeSheetTab - 1;\n        if (this.filterRange && this.filterRange.has(sheetIdx)) {\n            args.hasFilter = true;\n            args.filterRange = this.filterRange.get(sheetIdx);\n        }\n        else {\n            args.hasFilter = false;\n            args.filterRange = null;\n        }\n    };\n    /**\n     * Returns the custom operators for filter items.\n     */\n    Filter.prototype.getLocalizedCustomOperators = function () {\n        var l10n = this.parent.serviceLocator.getService(locale);\n        var numOptr = [\n            { value: 'equal', text: l10n.getConstant('Equal') },\n            { value: 'greaterthan', text: l10n.getConstant('GreaterThan') },\n            { value: 'greaterthanorequal', text: l10n.getConstant('GreaterThanOrEqual') },\n            { value: 'lessthan', text: l10n.getConstant('LessThan') },\n            { value: 'lessthanorequal', text: l10n.getConstant('LessThanOrEqual') },\n            { value: 'notequal', text: l10n.getConstant('NotEqual') }\n        ];\n        var customOperators = {\n            stringOperator: [\n                { value: 'startswith', text: l10n.getConstant('StartsWith') },\n                { value: 'endswith', text: l10n.getConstant('EndsWith') },\n                { value: 'contains', text: l10n.getConstant('Contains') },\n                { value: 'equal', text: l10n.getConstant('Equal') },\n                { value: 'notequal', text: l10n.getConstant('NotEqual') }\n            ],\n            numberOperator: numOptr,\n            dateOperator: numOptr,\n            datetimeOperator: numOptr,\n            booleanOperator: [\n                { value: 'equal', text: l10n.getConstant('Equal') },\n                { value: 'notequal', text: l10n.getConstant('NotEqual') }\n            ]\n        };\n        return customOperators;\n    };\n    return Filter;\n}());\nexport { Filter };\n","import { Spreadsheet } from '../index';\nimport { Selection, Edit, KeyboardNavigation, KeyboardShortcut, Clipboard } from '../actions/index';\nimport { CellFormat, CollaborativeEditing, UndoRedo, Resize, SpreadsheetHyperlink } from '../actions/index';\nimport { Ribbon, FormulaBar, SheetTabs, Open, ContextMenu, Save, NumberFormat, Formula, Sort, Filter } from '../integrations/index';\nimport { DataBind } from '../../workbook/index';\n/**\n * Spreadsheet basic module.\n * @private\n */\nvar BasicModule = /** @class */ (function () {\n    /**\n     * Constructor for Spreadsheet basic module.\n     * @private\n     */\n    function BasicModule() {\n        Spreadsheet.Inject(Ribbon, FormulaBar, SheetTabs, Selection, Edit, KeyboardNavigation, KeyboardShortcut, Clipboard, DataBind, Open, ContextMenu, Save, NumberFormat, CellFormat, Formula, Sort, CollaborativeEditing, UndoRedo, Resize, Filter, SpreadsheetHyperlink);\n    }\n    /**\n     * For internal use only - Get the module name.\n     * @private\n     */\n    BasicModule.prototype.getModuleName = function () {\n        return 'basic';\n    };\n    /**\n     * Destroys the Spreadsheet basic module.\n     * @return {void}\n     */\n    BasicModule.prototype.destroy = function () {\n        /* code snippet */\n    };\n    return BasicModule;\n}());\nexport { BasicModule };\n","import { Spreadsheet } from '../index';\nimport { Selection, Edit, KeyboardNavigation, KeyboardShortcut, Clipboard, CellFormat } from '../actions/index';\nimport { CollaborativeEditing, UndoRedo, Resize, SpreadsheetHyperlink } from '../actions/index';\nimport { Ribbon, FormulaBar, SheetTabs, Open, Save, NumberFormat, Formula, Sort, Filter } from '../integrations/index';\nimport { DataBind } from '../../workbook/integrations/index';\n/**\n * Spreadsheet all module.\n * @private\n */\nvar AllModule = /** @class */ (function () {\n    /**\n     * Constructor for Spreadsheet all module.\n     * @private\n     */\n    function AllModule() {\n        Spreadsheet.Inject(Ribbon, FormulaBar, SheetTabs, Selection, Edit, KeyboardNavigation, KeyboardShortcut, Clipboard, DataBind, Open, Save, NumberFormat, CellFormat, Formula, Sort, Resize, CollaborativeEditing, UndoRedo, Filter, SpreadsheetHyperlink);\n    }\n    /**\n     * For internal use only - Get the module name.\n     * @private\n     */\n    AllModule.prototype.getModuleName = function () {\n        return 'all';\n    };\n    /**\n     * Destroys the Spreadsheet all module.\n     * @return {void}\n     */\n    AllModule.prototype.destroy = function () {\n        /* code snippet */\n    };\n    return AllModule;\n}());\nexport { AllModule };\n","var __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    }\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nimport { Property, ChildProperty } from '@syncfusion/ej2-base';\n/**\n * Represents the scroll settings.\n */\nvar ScrollSettings = /** @class */ (function (_super) {\n    __extends(ScrollSettings, _super);\n    function ScrollSettings() {\n        return _super !== null && _super.apply(this, arguments) || this;\n    }\n    __decorate([\n        Property(false)\n    ], ScrollSettings.prototype, \"isFinite\", void 0);\n    __decorate([\n        Property(true)\n    ], ScrollSettings.prototype, \"enableVirtualization\", void 0);\n    return ScrollSettings;\n}(ChildProperty));\nexport { ScrollSettings };\n/**\n * Represents the selection settings.\n */\nvar SelectionSettings = /** @class */ (function (_super) {\n    __extends(SelectionSettings, _super);\n    function SelectionSettings() {\n        return _super !== null && _super.apply(this, arguments) || this;\n    }\n    __decorate([\n        Property('Multiple')\n    ], SelectionSettings.prototype, \"mode\", void 0);\n    return SelectionSettings;\n}(ChildProperty));\nexport { SelectionSettings };\n","/** @hidden */\nexport var DISABLED = 'e-disabled';\n/** @hidden */\nexport var locale = 'spreadsheetLocale';\n/** @hidden */\nexport var dialog = 'dialog';\n/** @hidden */\nexport var actionEvents = 'actionEvents';\n/** @hidden */\nexport var fontColor = {\n    'Custom': [\n        '#ffffff', '#000000', '#e7e6e6', '#44546a', '#4472c4', '#ed7d31', '#a5a5a5', '#ffc000', '#70ad47', '#ff0000',\n        '#f2f2f2', '#808080', '#cfcdcd', '#d5dce4', '#d9e2f3', '#fbe4d5', '#ededed', '#fff2cc', '#e2efd9', '#ffcccc',\n        '#d9d9d9', '#595959', '#aeaaaa', '#acb9ca', '#b4c6e7', '#f7caac', '#dbdbdb', '#ffe599', '#c5e0b3', '#ff8080',\n        '#bfbfbf', '#404040', '#747070', '#8496b0', '#8eaadb', '#f4b083', '#c9c9c9', '#ffd966', '#a8d08d', '#ff3333',\n        '#a6a6a6', '#262626', '#3b3838', '#323e4f', '#2f5496', '#c45911', '#7b7b7b', '#bf8f00', '#538135', '#b30000',\n        '#7f7f7f', '#0d0d0d', '#161616', '#212934', '#1f3763', '#823b0b', '#525252', '#7f5f00', '#375623', '#660000'\n    ]\n};\n/** @hidden */\nexport var fillColor = {\n    'Custom': [\n        '#ffffff', '#000000', '#ffff00', '#00ff00', '#00ffff', '#0000ff', '#ff0000', '#000080', '#800080', '#996633',\n        '#f2f2f2', '#808080', '#ffffcc', '#b3ffb3', '#ccffff', '#ccccff', '#ffcccc', '#ccccff', '#ff80ff', '#f2e6d9',\n        '#d9d9d9', '#595959', '#ffff80', '#80ff80', '#b3ffff', '#8080ff', '#ff8080', '#8080ff', '#ff00ff', '#dfbf9f',\n        '#bfbfbf', '#404040', '#ffff33', '#33ff33', '#33ffff', '#3333ff', '#ff3333', '#0000b3', '#b300b3', '#c68c53',\n        '#a6a6a6', '#262626', '#e6e600', '#00b300', '#009999', '#000099', '#b30000', '#000066', '#660066', '#86592d',\n        '#7f7f7f', '#0d0d0d', '#999900', '#006600', '#006666', '#000066', '#660000', '#00004d', '#4d004d', '#734d26',\n    ]\n};\n/**\n * Default locale text\n * @hidden\n */\nexport var defaultLocale = {\n    Cut: 'Cut',\n    Copy: 'Copy',\n    Paste: 'Paste',\n    PasteSpecial: 'Paste Special',\n    Link: 'Link',\n    SpreadsheetHyperlink: 'SpreadsheetHyperlink',\n    Hyperlink: 'Hyperlink',\n    EditHyperlink: 'Edit Hyperlink',\n    OpenHyperlink: 'Open Hyperlink',\n    RemoveHyperlink: 'Remove Hyperlink',\n    InsertLink: 'Insert Link',\n    EditLink: 'Edit Link',\n    All: 'All',\n    Values: 'Values',\n    Formats: 'Formats',\n    Bold: 'Bold',\n    Font: 'Font',\n    FontSize: 'Font Size',\n    Italic: 'Italic',\n    Underline: 'Underline',\n    Strikethrough: 'Strikethrough',\n    TextColor: 'Text Color',\n    FillColor: 'Fill Color',\n    HorizontalAlignment: 'Horizontal Alignment',\n    AlignLeft: 'Align Left',\n    AlignCenter: 'Center',\n    AlignRight: 'Align Right',\n    VerticalAlignment: 'Vertical Alignment',\n    AlignTop: 'Align Top',\n    AlignMiddle: 'Align Middle',\n    AlignBottom: 'Align Bottom',\n    InsertFunction: 'Insert Function',\n    Insert: 'Insert',\n    Delete: 'Delete',\n    Rename: 'Rename',\n    Hide: 'Hide',\n    Unhide: 'Unhide',\n    NameBox: 'Name Box',\n    ShowHeaders: 'Show Headers',\n    HideHeaders: 'Hide Headers',\n    ShowGridLines: 'Show Gridlines',\n    HideGridLines: 'Hide Gridlines',\n    AddSheet: 'Add Sheet',\n    ListAllSheets: 'List All Sheets',\n    FullScreen: 'Full Screen',\n    CollapseToolbar: 'Collapse Toolbar',\n    ExpandToolbar: 'Expand Toolbar',\n    CollapseFormulaBar: 'Collapse Formula Bar',\n    ExpandFormulaBar: 'Expand Formula Bar',\n    File: 'File',\n    Home: 'Home',\n    Formulas: 'Formulas',\n    View: 'View',\n    New: 'New',\n    Open: 'Open',\n    SaveAs: 'Save As',\n    Update: 'Update',\n    ExcelXlsx: 'Microsoft Excel',\n    ExcelXls: 'Microsoft Excel 97-2003',\n    CSV: 'Comma-separated values',\n    FormulaBar: 'Formula Bar',\n    Sort: 'Sort',\n    SortAscending: 'Ascending',\n    SortDescending: 'Descending',\n    CustomSort: 'Custom Sort',\n    AddColumn: 'Add Column',\n    ContainsHeader: 'Data contains header',\n    CaseSensitive: 'Case sensitive',\n    SortBy: 'Sort by',\n    ThenBy: 'Then by',\n    SelectAColumn: 'Select a column',\n    SortEmptyFieldError: 'Sort criteria column should not be empty.',\n    SortDuplicateFieldError: ' is mentioned more than once. Duplicate columns must be removed.',\n    SortOutOfRangeError: 'Select a cell or range inside the used range and try again.',\n    SortAndFilter: 'Sort & Filter',\n    Filter: 'Filter',\n    ClearAllFilter: 'Clear',\n    ClearFilterFrom: 'Clear Filter From ',\n    ReapplyFilter: 'Reapply',\n    FilterCellValue: 'Filter by Value of Selected Cell',\n    FilterOutOfRangeError: 'Select a cell or range inside the used range and try again.',\n    HideRow: 'Hide Row',\n    HideRows: 'Hide Rows',\n    UnHideRows: 'UnHide Rows',\n    HideColumn: 'Hide Column',\n    HideColumns: 'Hide Columns',\n    UnHideColumns: 'UnHide Columns',\n    Ok: 'Ok',\n    Close: 'Close',\n    Cancel: 'Cancel',\n    Apply: 'Apply',\n    MoreColors: 'More Colors',\n    StandardColors: 'Standard Colors',\n    General: 'General',\n    Number: 'Number',\n    Currency: 'Currency',\n    Accounting: 'Accounting',\n    ShortDate: 'Short Date',\n    LongDate: 'Long Date',\n    Time: 'Time',\n    Percentage: 'Percentage',\n    Fraction: 'Fraction',\n    Scientific: 'Scientific',\n    Text: 'Text',\n    MobileFormulaBarPlaceHolder: 'Enter value or Formula',\n    NumberFormat: 'Number Format',\n    PasteAlert: 'You can\\'t paste this here, because the copy area and paste area aren\\'t in the same size. ' +\n        'Please try pasting in a different range.',\n    DestroyAlert: 'Are you sure you want to destroy the current workbook without saving and create a new workbook?',\n    SheetRenameInvalidAlert: 'Sheet name contains invalid character.',\n    SheetRenameEmptyAlert: 'Sheet name cannot be empty.',\n    SheetRenameAlreadyExistsAlert: 'Sheet name already exists. Please enter another name.',\n    DeleteSheetAlert: 'You can\\'t undo deleting sheets, and you might be removing some data. If you don\\'t need it, click OK to delete.',\n    DeleteSingleLastSheetAlert: 'A Workbook must contain at least one visible worksheet.',\n    PickACategory: 'Pick a category',\n    Description: 'Description',\n    UnsupportedFile: 'Unsupported File',\n    InvalidUrl: 'Invalid URL',\n    SUM: 'Adds a series of numbers and/or cells.',\n    SUMIF: 'Adds the cells based on specified condition.',\n    SUMIFS: 'Adds the cells based on specified conditions.',\n    ABS: 'Returns the value of a number without its sign.',\n    RAND: 'Returns a random number between 0 and 1.',\n    RANDBETWEEN: 'Returns a random integer based on specified values.',\n    FLOOR: 'Rounds a number down to the nearest multiple of a given factor.',\n    CEILING: 'Rounds a number up to the nearest multiple of a given factor.',\n    PRODUCT: 'Multiplies a series of numbers and/or cells.',\n    AVERAGE: 'Calculates average for the series of numbers and/or cells excluding text.',\n    AVERAGEIF: 'Calculates average for the cells based on specified criterion.',\n    AVERAGEIFS: 'Calculates average for the cells based on specified conditions.',\n    AVERAGEA: 'Calculates the average for the cells evaluating TRUE as 1, text and FALSE as 0.',\n    COUNT: 'Counts the cells that contain numeric values in a range.',\n    COUNTIF: 'Counts the cells based on specified condition.',\n    COUNTIFS: 'Counts the cells based on specified conditions.',\n    COUNTA: 'Counts the cells that contains values in a range.',\n    MIN: 'Returns the smallest number of the given arguments.',\n    MAX: 'Returns the largest number of the given arguments.',\n    DATE: 'Returns the date based on given year, month, and day.',\n    DAY: 'Returns the day from the given date.',\n    DAYS: 'Returns the number of days between two dates.',\n    IF: 'Returns value based on the given expression.',\n    IFS: 'Returns value based on the given multiple expressions.',\n    CalculateAND: 'Returns TRUE if all the arguments are TRUE, otherwise returns FALSE.',\n    CalculateOR: 'Returns TRUE if any of the arguments are TRUE, otherwise returns FALSE.',\n    IFERROR: 'Returns value if no error found else it will return specified value.',\n    CHOOSE: 'Returns a value from list of values, based on index number.',\n    INDEX: 'Returns a value of the cell in a given range based on row and column number.',\n    FIND: 'Returns the position of a string within another string, which is case sensitive',\n    CONCATENATE: 'Combines two or more strings together.',\n    CONCAT: 'Concatenates a list or a range of text strings.',\n    SUBTOTAL: 'Returns subtotal for a range using the given function number.',\n    RADIANS: 'Converts degrees into radians.',\n    MATCH: 'Returns the relative position of a specified value in given range.',\n    DefineNameExists: 'This name already exists, try different name.',\n    CircularReference: 'When a formula refers to one or more circular references, this may result in an incorrect calculation.',\n    ShowRowsWhere: 'Show rows where:',\n    OR: 'OR',\n    AND: 'AND',\n    CustomFilterDatePlaceHolder: 'Choose a date',\n    CustomFilterPlaceHolder: 'Enter the value',\n    CustomFilter: 'Custom Filter',\n    Between: 'Between',\n    MatchCase: 'Match Case',\n    DateTimeFilter: 'DateTime Filters',\n    Undo: 'Undo',\n    Redo: 'Redo',\n    DateFilter: 'Date Filters',\n    TextFilter: 'Text Filters',\n    NumberFilter: 'Number Filters',\n    ClearFilter: 'Clear Filter',\n    NoResult: 'No Matches Found',\n    FilterFalse: 'False',\n    FilterTrue: 'True',\n    Blanks: 'Blanks',\n    SelectAll: 'Select All',\n    GreaterThanOrEqual: 'Greater Than Or Equal',\n    GreaterThan: 'Greater Than',\n    LessThanOrEqual: 'Less Than Or Equal',\n    LessThan: 'Less Than',\n    NotEqual: 'Not Equal',\n    Equal: 'Equal',\n    Contains: 'Contains',\n    EndsWith: 'Ends With',\n    StartsWith: 'Starts With',\n    ClearButton: 'Clear',\n    FilterButton: 'Filter',\n    CancelButton: 'Cancel',\n    OKButton: 'OK',\n    Search: 'Search'\n};\n","import { formatUnit, detach, attributes } from '@syncfusion/ej2-base';\nimport { getRangeIndexes } from './../../workbook/common/address';\nimport { getColumnWidth } from '../../workbook/base/column';\nimport { contentLoaded, editOperation, getUpdateUsingRaf, removeAllChildren } from '../common/index';\nimport { beforeContentLoaded, getColGroupWidth, virtualContentLoaded, setAriaOptions, dataBound } from '../common/index';\nimport { beforeHeaderLoaded } from '../common/index';\n/**\n * Sheet module is used to render Sheet\n * @hidden\n */\nvar SheetRender = /** @class */ (function () {\n    function SheetRender(parent) {\n        this.freezePane = false;\n        this.colGroupWidth = 30; //Row header and selectall table colgroup width\n        this.parent = parent;\n        this.col = parent.createElement('col');\n        this.rowRenderer = parent.serviceLocator.getService('row');\n        this.cellRenderer = parent.serviceLocator.getService('cell');\n    }\n    SheetRender.prototype.refreshSelectALLContent = function () {\n        var cell;\n        if (this.freezePane) {\n            var tHead = this.getSelectAllTable().querySelector('thead');\n            var row = this.rowRenderer.render();\n            tHead.appendChild(row);\n            cell = this.parent.createElement('th', { className: 'e-select-all-cell' });\n            row.appendChild(cell);\n        }\n        else {\n            cell = this.headerPanel.firstElementChild;\n            cell.classList.add('e-select-all-cell');\n        }\n        cell.appendChild(this.parent.createElement('button', { className: 'e-selectall e-icons',\n            id: this.parent.element.id + \"_select_all\" }));\n    };\n    SheetRender.prototype.updateLeftColGroup = function (width, rowHdr) {\n        if (width) {\n            this.colGroupWidth = width;\n        }\n        if (!rowHdr) {\n            rowHdr = this.getRowHeaderPanel();\n        }\n        var table = rowHdr.querySelector('table');\n        this.detachColGroup(table);\n        var colGrp = this.parent.createElement('colgroup');\n        var colGrpWidth = this.colGroupWidth + \"px\";\n        var col = this.col.cloneNode();\n        col.style.width = colGrpWidth;\n        colGrp.appendChild(col);\n        table.insertBefore(colGrp, table.querySelector('tbody'));\n        rowHdr.style.width = colGrpWidth;\n        if (this.freezePane) {\n            table = this.getSelectAllTable();\n            this.detachColGroup(table);\n            table.insertBefore(colGrp.cloneNode(true), table.querySelector('thead'));\n        }\n        else {\n            this.getSelectAllContent().style.width = colGrpWidth;\n        }\n        if (this.parent.getActiveSheet().showHeaders) {\n            this.getColHeaderPanel().style.width = \"calc(100% - \" + colGrpWidth + \")\";\n            this.getContentPanel().style.width = \"calc(100% - \" + colGrpWidth + \")\";\n        }\n    };\n    SheetRender.prototype.detachColGroup = function (table) {\n        var colGrp = table.querySelector('colgroup');\n        if (colGrp) {\n            detach(colGrp);\n        }\n    };\n    SheetRender.prototype.renderPanel = function () {\n        this.contentPanel = this.parent.createElement('div', { className: 'e-main-panel' });\n        var sheet = this.parent.getActiveSheet();\n        var id = this.parent.element.id;\n        if (sheet.showHeaders) {\n            this.contentPanel.appendChild(this.parent.createElement('div', { className: 'e-row-header', id: id + \"_row_header\" }));\n            this.initHeaderPanel();\n            if (this.parent.allowScrolling) {\n                this.parent.scrollModule.setPadding();\n            }\n        }\n        else {\n            this.updateHideHeaders();\n        }\n        var content = this.contentPanel.appendChild(this.parent.createElement('div', { className: 'e-main-content', id: id + \"_main_content\" }));\n        if (!sheet.showGridLines) {\n            content.classList.add('e-hide-gridlines');\n        }\n        if (!this.parent.allowScrolling) {\n            content.style.overflow = 'hidden';\n        }\n    };\n    SheetRender.prototype.initHeaderPanel = function () {\n        var id = this.parent.element.id;\n        this.headerPanel = this.parent.createElement('div', { className: 'e-header-panel' });\n        this.headerPanel.appendChild(this.parent.createElement('div', { className: 'e-selectall-container', id: id + \"_selectall\" }));\n        this.headerPanel.appendChild(this.parent.createElement('div', { className: 'e-column-header', id: id + \"_col_header\" }));\n    };\n    SheetRender.prototype.createTable = function () {\n        if (this.parent.getActiveSheet().showHeaders) {\n            this.createHeaderTable();\n        }\n        this.updateTable('tbody', 'content', this.contentPanel.lastElementChild);\n    };\n    SheetRender.prototype.createHeaderTable = function (rowHdrEle) {\n        if (rowHdrEle === void 0) { rowHdrEle = this.contentPanel.querySelector('.e-row-header'); }\n        if (this.freezePane) {\n            this.updateTable('thead', 'selectall', this.headerPanel.querySelector('.e-selectall-container'));\n        }\n        this.updateTable('thead', 'colhdr', this.headerPanel.querySelector('.e-column-header'));\n        this.updateTable('tbody', 'rowhdr', rowHdrEle);\n        this.updateLeftColGroup(null, rowHdrEle);\n    };\n    SheetRender.prototype.updateTable = function (tagName, name, appendTo) {\n        var table = this.parent.createElement('table', { className: 'e-table', attrs: { 'role': 'grid' } });\n        table.classList.add(\"e-\" + name + \"-table\");\n        appendTo.appendChild(table);\n        table.appendChild(this.parent.createElement(tagName));\n    };\n    /**\n     * It is used to refresh the select all, row header, column header and content table contents.\n     */\n    SheetRender.prototype.renderTable = function (cells, rowIdx, colIdx, lastIdx, top, left) {\n        var _this = this;\n        var indexes;\n        var row;\n        var sheet = this.parent.getActiveSheet();\n        var frag = document.createDocumentFragment();\n        this.createTable();\n        var colGrp = this.parent.createElement('colgroup');\n        var cTBody = this.contentPanel.querySelector('.e-main-content tbody');\n        var rHdrTBody;\n        var cHdrTHead;\n        var cHdrRow;\n        if (sheet.showHeaders) {\n            frag.appendChild(this.headerPanel);\n            this.refreshSelectALLContent();\n            rHdrTBody = this.contentPanel.querySelector('.e-row-header tbody');\n            cHdrTHead = this.headerPanel.querySelector('.e-column-header thead');\n            this.getColHeaderTable().insertBefore(colGrp, cHdrTHead);\n            cHdrRow = this.rowRenderer.render();\n            cHdrTHead.appendChild(cHdrRow);\n        }\n        frag.appendChild(this.contentPanel);\n        this.parent.notify(beforeContentLoaded, { startColIdx: colIdx });\n        var colCount = sheet.colCount.toString();\n        var rowCount = sheet.colCount.toString();\n        if (sheet.showHeaders) {\n            this.parent.getColHeaderTable().setAttribute('aria-colcount', colCount);\n            this.parent.getRowHeaderTable().setAttribute('aria-rowcount', rowCount);\n        }\n        attributes(this.parent.getContentTable(), { 'aria-rowcount': rowCount, 'aria-colcount': colCount });\n        cells.forEach(function (value, key) {\n            indexes = getRangeIndexes(key);\n            if (indexes[0] === rowIdx) {\n                _this.updateCol(indexes[1], colGrp, sheet);\n                if (sheet.showHeaders) {\n                    cHdrRow.appendChild(_this.cellRenderer.renderColHeader(indexes[1]));\n                }\n            }\n            if (indexes[1] === colIdx) {\n                if (sheet.showHeaders) {\n                    row = _this.rowRenderer.render(indexes[0], true);\n                    rHdrTBody.appendChild(row);\n                    row.appendChild(_this.cellRenderer.renderRowHeader(indexes[0]));\n                }\n                row = _this.rowRenderer.render(indexes[0]);\n                cTBody.appendChild(row);\n            }\n            row.appendChild(_this.cellRenderer.render({ colIdx: indexes[1], rowIdx: indexes[0], cell: value,\n                address: key, lastCell: indexes[1] === lastIdx, isHeightCheckNeeded: true }));\n        });\n        this.getContentTable().insertBefore(colGrp.cloneNode(true), cTBody);\n        getUpdateUsingRaf(function () {\n            var content = _this.parent.getMainContent();\n            document.getElementById(_this.parent.element.id + '_sheet').appendChild(frag);\n            if (top) {\n                content.scrollTop = top;\n                if (sheet.showHeaders) {\n                    _this.parent.getRowHeaderContent().scrollTop = top;\n                }\n            }\n            if (left) {\n                content.scrollLeft = left;\n                if (sheet.showHeaders) {\n                    _this.parent.getColumnHeaderContent().scrollLeft = left;\n                }\n            }\n            _this.parent.notify(contentLoaded, null);\n            _this.parent.notify(editOperation, { action: 'renderEditor' });\n            if (!_this.parent.isOpen) {\n                _this.parent.hideSpinner();\n            }\n            setAriaOptions(_this.parent.getMainContent(), { busy: false });\n            _this.parent.trigger(dataBound, {});\n        });\n    };\n    SheetRender.prototype.refreshColumnContent = function (cells, rowIndex, colIndex, lastIdx) {\n        var _this = this;\n        var indexes;\n        var row;\n        var table;\n        var count = 0;\n        var sheet = this.parent.getActiveSheet();\n        var frag = document.createDocumentFragment();\n        var hFrag = document.createDocumentFragment();\n        var tBody = this.parent.element.querySelector('.e-main-content tbody');\n        tBody = frag.appendChild(tBody.cloneNode(true));\n        var colGrp = this.parent.element.querySelector('.e-main-content colgroup');\n        colGrp = colGrp.cloneNode();\n        var hRow;\n        var tHead;\n        if (sheet.showHeaders) {\n            hFrag.appendChild(colGrp);\n            tHead = this.parent.element.querySelector('.e-column-header thead');\n            tHead = hFrag.appendChild(tHead.cloneNode(true));\n            hRow = tHead.querySelector('tr');\n            hRow.innerHTML = '';\n        }\n        cells.forEach(function (value, key) {\n            indexes = getRangeIndexes(key);\n            if (indexes[0] === rowIndex) {\n                _this.updateCol(indexes[1], colGrp, sheet);\n                if (sheet.showHeaders) {\n                    hRow.appendChild(_this.cellRenderer.renderColHeader(indexes[1]));\n                }\n            }\n            if (indexes[1] === colIndex) {\n                row = tBody.children[count];\n                if (row) {\n                    count++;\n                    row.innerHTML = '';\n                }\n                else {\n                    return;\n                }\n            }\n            row.appendChild(_this.cellRenderer.render({\n                colIdx: indexes[1], rowIdx: indexes[0], cell: value, address: key\n            }));\n        });\n        frag.insertBefore(colGrp.cloneNode(true), tBody);\n        getUpdateUsingRaf(function () {\n            if (sheet.showHeaders) {\n                table = _this.getColHeaderTable();\n                removeAllChildren(table);\n                table.appendChild(hFrag);\n            }\n            table = _this.getContentTable();\n            removeAllChildren(table);\n            table.appendChild(frag);\n            _this.parent.notify(virtualContentLoaded, { refresh: 'Column' });\n            if (!_this.parent.isOpen) {\n                _this.parent.hideSpinner();\n            }\n            setAriaOptions(_this.parent.getMainContent(), { busy: false });\n        });\n    };\n    SheetRender.prototype.refreshRowContent = function (cells, startIndex, lastIdx) {\n        var _this = this;\n        var indexes;\n        var row;\n        var hRow;\n        var colGroupWidth = this.colGroupWidth;\n        var sheet = this.parent.getActiveSheet();\n        var hFrag;\n        var hTBody;\n        var frag = document.createDocumentFragment();\n        var tBody = this.parent.createElement('tbody');\n        if (sheet.showHeaders) {\n            hFrag = document.createDocumentFragment();\n            hTBody = tBody.cloneNode();\n            hFrag.appendChild(hTBody);\n        }\n        frag.appendChild(tBody);\n        cells.forEach(function (value, key) {\n            indexes = getRangeIndexes(key);\n            if (indexes[1] === startIndex) {\n                if (sheet.showHeaders) {\n                    hRow = _this.rowRenderer.render(indexes[0], true);\n                    hTBody.appendChild(hRow);\n                    hRow.appendChild(_this.cellRenderer.renderRowHeader(indexes[0]));\n                    colGroupWidth = getColGroupWidth(indexes[0] + 1);\n                }\n                row = _this.rowRenderer.render(indexes[0]);\n                tBody.appendChild(row);\n            }\n            row.appendChild(_this.cellRenderer.render({ rowIdx: indexes[0], colIdx: indexes[1], cell: value, address: key,\n                lastCell: indexes[1] === lastIdx, row: row, hRow: hRow, isHeightCheckNeeded: true }));\n        });\n        getUpdateUsingRaf(function () {\n            if (_this.parent.isDestroyed) {\n                return;\n            }\n            if (_this.colGroupWidth !== colGroupWidth) {\n                _this.updateLeftColGroup(colGroupWidth);\n            }\n            if (sheet.showHeaders) {\n                detach(_this.contentPanel.querySelector('.e-row-header tbody'));\n                _this.getRowHeaderTable().appendChild(hFrag);\n            }\n            detach(_this.contentPanel.querySelector('.e-main-content tbody'));\n            _this.getContentTable().appendChild(frag);\n            _this.parent.notify(virtualContentLoaded, { refresh: 'Row' });\n            if (!_this.parent.isOpen) {\n                _this.parent.hideSpinner();\n            }\n            setAriaOptions(_this.parent.getMainContent(), { busy: false });\n        });\n    };\n    SheetRender.prototype.updateCol = function (idx, appendTo, sheet) {\n        var col = this.col.cloneNode();\n        col.style.width = formatUnit(getColumnWidth(sheet, idx));\n        appendTo.appendChild(col);\n    };\n    SheetRender.prototype.updateColContent = function (cells, rowIdx, colIdx, lastIdx, direction) {\n        var _this = this;\n        getUpdateUsingRaf(function () {\n            var indexes;\n            var row;\n            var table;\n            var refChild;\n            var cell;\n            var hRow;\n            var rowCount = 0;\n            var col;\n            var hRefChild;\n            var sheet = _this.parent.getActiveSheet();\n            if (sheet.showHeaders) {\n                hRow = _this.parent.element.querySelector('.e-column-header .e-header-row');\n                hRefChild = hRow.firstElementChild;\n            }\n            var colGrp = _this.parent.element.querySelector('.e-main-content colgroup');\n            var colRefChild = colGrp.firstElementChild;\n            var tBody = _this.parent.element.querySelector('.e-main-content tbody');\n            cells.forEach(function (value, key) {\n                indexes = getRangeIndexes(key);\n                if (indexes[0] === rowIdx) {\n                    if (direction === 'first') {\n                        _this.updateCol(indexes[1], colGrp, sheet);\n                        if (sheet.showHeaders) {\n                            hRow.appendChild(_this.cellRenderer.renderColHeader(indexes[1]));\n                        }\n                    }\n                    else {\n                        col = _this.col.cloneNode();\n                        col.style.width = formatUnit(getColumnWidth(sheet, indexes[1]));\n                        colGrp.insertBefore(col, colRefChild);\n                        if (sheet.showHeaders) {\n                            hRow.insertBefore(_this.cellRenderer.renderColHeader(indexes[1]), hRefChild);\n                        }\n                    }\n                    if (_this.parent.scrollSettings.enableVirtualization) {\n                        // tslint:disable\n                        detach(colGrp[direction + 'ElementChild']);\n                        if (sheet.showHeaders) {\n                            detach(hRow[direction + 'ElementChild']);\n                        }\n                        // tslint:enable\n                    }\n                }\n                if (indexes[1] === colIdx) {\n                    row = tBody.children[rowCount];\n                    rowCount++;\n                    refChild = row.firstElementChild;\n                }\n                cell = _this.cellRenderer.render({ colIdx: indexes[1], rowIdx: indexes[0], cell: value, address: key,\n                    lastCell: indexes[1] === lastIdx, isHeightCheckNeeded: direction === 'first' });\n                if (direction === 'first') {\n                    row.appendChild(cell);\n                }\n                else {\n                    row.insertBefore(cell, refChild);\n                }\n                if (_this.parent.scrollSettings.enableVirtualization) {\n                    // tslint:disable-next-line:no-any\n                    detach(row[direction + 'ElementChild']);\n                }\n            });\n            if (sheet.showHeaders) {\n                table = _this.getColHeaderTable();\n                detach(table.querySelector('colgroup'));\n                table.insertBefore(colGrp.cloneNode(true), table.querySelector('thead'));\n            }\n            if (_this.parent.scrollSettings.enableVirtualization) {\n                _this.parent.notify(virtualContentLoaded, { refresh: 'Column' });\n            }\n            if (!_this.parent.isOpen) {\n                _this.parent.hideSpinner();\n            }\n            setAriaOptions(_this.parent.getMainContent(), { busy: false });\n        });\n    };\n    SheetRender.prototype.updateRowContent = function (cells, startIndex, lastIdx, direction) {\n        var _this = this;\n        var colGroupWidth = this.colGroupWidth;\n        var row;\n        var hRow;\n        var sheet = this.parent.getActiveSheet();\n        var tBody = this.parent.getMainContent().querySelector('tbody');\n        var rTBody;\n        var rFrag;\n        if (sheet.showHeaders) {\n            rFrag = document.createDocumentFragment();\n            rTBody = this.parent.getRowHeaderContent().querySelector('tbody');\n        }\n        var indexes;\n        var frag = document.createDocumentFragment();\n        this.parent.showSpinner();\n        cells.forEach(function (value, cKey) {\n            indexes = getRangeIndexes(cKey);\n            if (indexes[1] === startIndex) {\n                if (sheet.showHeaders) {\n                    hRow = _this.rowRenderer.render(indexes[0], true);\n                    rFrag.appendChild(hRow);\n                    hRow.appendChild(_this.cellRenderer.renderRowHeader(indexes[0]));\n                    colGroupWidth = getColGroupWidth(indexes[0] + 1);\n                    if (_this.parent.scrollSettings.enableVirtualization && direction) {\n                        // tslint:disable-next-line:no-any\n                        detach(rTBody[direction + 'ElementChild']);\n                    }\n                }\n                row = _this.rowRenderer.render(indexes[0]);\n                frag.appendChild(row);\n                if (_this.parent.scrollSettings.enableVirtualization && direction) {\n                    // tslint:disable-next-line:no-any\n                    detach(tBody[direction + 'ElementChild']);\n                }\n            }\n            row.appendChild(_this.cellRenderer.render({ colIdx: indexes[1], rowIdx: indexes[0], cell: value, address: cKey,\n                lastCell: indexes[1] === lastIdx, row: row, hRow: hRow, isHeightCheckNeeded: direction === 'first' || direction === '' }));\n        });\n        var appendFn = function () {\n            if (_this.colGroupWidth !== colGroupWidth) {\n                _this.updateLeftColGroup(colGroupWidth);\n            }\n            if (direction === 'last') {\n                if (sheet.showHeaders) {\n                    rTBody.insertBefore(rFrag, rTBody.firstElementChild);\n                }\n                tBody.insertBefore(frag, tBody.firstElementChild);\n            }\n            else {\n                if (sheet.showHeaders) {\n                    rTBody.appendChild(rFrag);\n                }\n                tBody.appendChild(frag);\n            }\n            if (_this.parent.scrollSettings.enableVirtualization) {\n                _this.parent.notify(virtualContentLoaded, { refresh: 'Row' });\n            }\n            if (!_this.parent.isOpen) {\n                _this.parent.hideSpinner();\n            }\n            setAriaOptions(_this.parent.getMainContent(), { busy: false });\n        };\n        direction ? getUpdateUsingRaf(appendFn) : appendFn();\n    };\n    /**\n     * Used to toggle row and column headers.\n     */\n    SheetRender.prototype.showHideHeaders = function () {\n        var _this = this;\n        var sheet = this.parent.getActiveSheet();\n        if (sheet.showHeaders) {\n            if (this.parent.scrollSettings.enableVirtualization) {\n                var startIndex = [this.parent.viewport.topIndex, this.parent.viewport.leftIndex];\n                this.renderHeaders([startIndex[0], startIndex[0] + this.parent.viewport.rowCount + (this.parent.getThreshold('row') * 2)], [startIndex[1], startIndex[1] + this.parent.viewport.colCount + (this.parent.getThreshold('col') * 2)]);\n            }\n            else {\n                this.renderHeaders([0, sheet.rowCount - 1], [0, sheet.colCount - 1]);\n                if (sheet.topLeftCell !== 'A1') {\n                    this.parent.goTo(sheet.topLeftCell);\n                }\n            }\n        }\n        else {\n            getUpdateUsingRaf(function () {\n                detach(_this.headerPanel);\n                detach(_this.getRowHeaderPanel());\n                _this.getContentPanel().style.width = '';\n                _this.updateHideHeaders();\n            });\n        }\n    };\n    SheetRender.prototype.renderHeaders = function (rowIndexes, colIndexes) {\n        var _this = this;\n        this.initHeaderPanel();\n        var cFrag = document.createDocumentFragment();\n        var rFrag = document.createDocumentFragment();\n        cFrag.appendChild(this.headerPanel);\n        var rowHdrEle = rFrag.appendChild(this.parent.createElement('div', { className: 'e-row-header', id: this.parent.element.id + \"_row_header\" }));\n        this.createHeaderTable(rowHdrEle);\n        this.parent.notify(beforeHeaderLoaded, { element: rowHdrEle });\n        this.refreshSelectALLContent();\n        var rTBody = rowHdrEle.querySelector('tbody');\n        var cTHead = this.headerPanel.querySelector('.e-column-header thead');\n        var cRow = this.rowRenderer.render();\n        cTHead.appendChild(cRow);\n        var row;\n        for (var i = colIndexes[0]; i <= colIndexes[1]; i++) {\n            cRow.appendChild(this.cellRenderer.renderColHeader(i));\n        }\n        var colGroupWidth = getColGroupWidth(rowIndexes[1]);\n        if (this.colGroupWidth !== colGroupWidth) {\n            this.updateLeftColGroup(colGroupWidth, rowHdrEle);\n        }\n        for (var i = rowIndexes[0]; i <= rowIndexes[1]; i++) {\n            row = this.rowRenderer.render(i, true);\n            row.appendChild(this.cellRenderer.renderRowHeader(i));\n            rTBody.appendChild(row);\n        }\n        getUpdateUsingRaf(function () {\n            _this.getColHeaderTable().insertBefore(_this.getContentTable().querySelector('colgroup').cloneNode(true), cTHead);\n            var sheet = document.getElementById(_this.parent.element.id + '_sheet');\n            sheet.classList.remove('e-hide-headers');\n            sheet.insertBefore(cFrag, _this.contentPanel);\n            var content = _this.getContentPanel();\n            _this.contentPanel.insertBefore(rFrag, content);\n            _this.parent.scrollModule.setPadding();\n            rowHdrEle.scrollTop = content.scrollTop;\n            _this.getColHeaderPanel().scrollLeft = content.scrollLeft;\n        });\n    };\n    SheetRender.prototype.updateHideHeaders = function () {\n        document.getElementById(this.parent.element.id + '_sheet').classList.add('e-hide-headers');\n        this.headerPanel = null;\n    };\n    /**\n     * Get the select all table element of spreadsheet\n     * @return {HTMLElement}\n     */\n    SheetRender.prototype.getSelectAllContent = function () {\n        return this.headerPanel.getElementsByClassName('e-selectall-container')[0];\n    };\n    /**\n     * Get the select all table element of spreadsheet\n     * @return {Element}\n     */\n    SheetRender.prototype.getSelectAllTable = function () {\n        return this.headerPanel.getElementsByClassName('e-selectall-table')[0];\n    };\n    /**\n     * Get the column header element of spreadsheet\n     * @return {HTMLTableElement}\n     */\n    SheetRender.prototype.getColHeaderTable = function () {\n        return this.headerPanel.getElementsByClassName('e-colhdr-table')[0];\n    };\n    /**\n     * Get the row header table element of spreadsheet\n     * @return {HTMLTableElement}\n     */\n    SheetRender.prototype.getRowHeaderTable = function () {\n        return this.contentPanel.getElementsByClassName('e-rowhdr-table')[0];\n    };\n    /**\n     * Get the main content table element of spreadsheet\n     * @return {Element}\n     */\n    SheetRender.prototype.getContentTable = function () {\n        return this.contentPanel.getElementsByClassName('e-content-table')[0];\n    };\n    /**\n     * Get the row header div element of spreadsheet\n     * @return {Element}\n     */\n    SheetRender.prototype.getRowHeaderPanel = function () {\n        return this.contentPanel.getElementsByClassName('e-row-header')[0];\n    };\n    /**\n     * Get the column header div element of spreadsheet\n     * @return {Element}\n     */\n    SheetRender.prototype.getColHeaderPanel = function () {\n        return this.headerPanel.getElementsByClassName('e-column-header')[0];\n    };\n    /**\n     * Get the main content div element of spreadsheet\n     * @return {Element}\n     */\n    SheetRender.prototype.getContentPanel = function () {\n        return this.contentPanel.getElementsByClassName('e-main-content')[0];\n    };\n    return SheetRender;\n}());\nexport { SheetRender };\n","import { getRowHeight, getCell, isHiddenRow } from '../../workbook/base/index';\nimport { attributes } from '@syncfusion/ej2-base';\nimport { getCellAddress } from '../../workbook/common/index';\n/**\n * Sheet module is used for creating row element\n * @hidden\n */\nvar RowRenderer = /** @class */ (function () {\n    function RowRenderer(parent) {\n        this.parent = parent;\n        this.element = this.parent.createElement('tr', { attrs: { 'role': 'row' } });\n        this.cellRenderer = parent.serviceLocator.getService('cell');\n    }\n    RowRenderer.prototype.render = function (index, isRowHeader, skipHidden) {\n        var row = this.element.cloneNode();\n        if (index === undefined) {\n            row.classList.add('e-header-row');\n            return row;\n        }\n        row.classList.add('e-row');\n        var sheet = this.parent.getActiveSheet();\n        attributes(row, { 'aria-rowindex': (index + 1).toString() });\n        row.style.height = getRowHeight(sheet, index) + \"px\";\n        if (isRowHeader && !skipHidden) {\n            if (isHiddenRow(sheet, index + 1) && !isHiddenRow(sheet, index - 1)) {\n                row.classList.add('e-hide-start');\n            }\n            if (index !== 0 && isHiddenRow(sheet, index - 1) && !isHiddenRow(sheet, index + 1)) {\n                row.classList.add('e-hide-end');\n            }\n        }\n        return row;\n    };\n    RowRenderer.prototype.refresh = function (index, hRow) {\n        var row;\n        var sheet = this.parent.getActiveSheet();\n        if (hRow) {\n            row = this.render(index);\n            var len = this.parent.viewport.leftIndex + this.parent.viewport.colCount + (this.parent.getThreshold('col') * 2);\n            for (var i = this.parent.viewport.leftIndex; i <= len; i++) {\n                row.appendChild(this.cellRenderer.render({ colIdx: i, rowIdx: index, cell: getCell(index, i, sheet),\n                    address: getCellAddress(index, i), lastCell: i === len, row: row, hRow: hRow, isHeightCheckNeeded: true }));\n            }\n        }\n        else {\n            row = this.render(index, true, true);\n            row.appendChild(this.cellRenderer.renderRowHeader(index));\n        }\n        return row;\n    };\n    return RowRenderer;\n}());\nexport { RowRenderer };\n","import { inView, renderFilterCell } from '../common/index';\nimport { createHyperlinkElement } from '../common/index';\nimport { getColumnHeaderText, getCellAddress } from '../../workbook/common/index';\nimport { getCell, skipDefaultValue, isHiddenRow } from '../../workbook/base/index';\nimport { addClass, attributes, getNumberDependable, extend } from '@syncfusion/ej2-base';\nimport { getFormattedCellObject, applyCellFormat, workbookFormulaOperation, setCellFormat } from '../../workbook/common/event';\nimport { getTypeFromFormat } from '../../workbook/index';\nimport { checkIsFormula } from '../../workbook/common/util';\n/**\n * CellRenderer class which responsible for building cell content.\n * @hidden\n */\nvar CellRenderer = /** @class */ (function () {\n    function CellRenderer(parent) {\n        this.parent = parent;\n        this.element = this.parent.createElement('td');\n        this.th = this.parent.createElement('th', { className: 'e-header-cell' });\n    }\n    CellRenderer.prototype.renderColHeader = function (index) {\n        var headerCell = this.th.cloneNode();\n        attributes(headerCell, { 'role': 'columnheader', 'aria-colindex': (index + 1).toString(), 'tabindex': '-1' });\n        headerCell.innerHTML = getColumnHeaderText(index + 1);\n        return headerCell;\n    };\n    CellRenderer.prototype.renderRowHeader = function (index) {\n        var headerCell = this.element.cloneNode();\n        addClass([headerCell], 'e-header-cell');\n        attributes(headerCell, { 'role': 'rowheader', 'tabindex': '-1' });\n        headerCell.innerHTML = (index + 1).toString();\n        return headerCell;\n    };\n    CellRenderer.prototype.render = function (args) {\n        var td = this.element.cloneNode();\n        td.className = 'e-cell';\n        attributes(td, { 'role': 'gridcell', 'aria-colindex': (args.colIdx + 1).toString(), 'tabindex': '-1' });\n        this.updateCell(args.rowIdx, args.colIdx, td, args.cell, args.lastCell, args.row, args.hRow, args.isHeightCheckNeeded);\n        this.parent.notify(renderFilterCell, { td: td, rowIndex: args.rowIdx, colIndex: args.colIdx });\n        this.parent.trigger('beforeCellRender', { cell: args.cell, element: td, address: args.address });\n        return td;\n    };\n    CellRenderer.prototype.updateCell = function (rowIdx, colIdx, td, cell, lastCell, row, hRow, isHeightCheckNeeded, isRefresh) {\n        if (cell && cell.formula && !cell.value) {\n            var isFormula = checkIsFormula(cell.formula);\n            var eventArgs = {\n                action: 'refreshCalculate',\n                value: cell.formula,\n                rowIndex: rowIdx,\n                colIndex: colIdx,\n                isFormula: isFormula\n            };\n            this.parent.notify(workbookFormulaOperation, eventArgs);\n        }\n        var formatArgs = {\n            type: cell && getTypeFromFormat(cell.format),\n            value: cell && cell.value, format: cell && cell.format ? cell.format : 'General',\n            formattedText: cell && cell.value, onLoad: true, isRightAlign: false, cell: cell\n        };\n        if (cell) {\n            this.parent.notify(getFormattedCellObject, formatArgs);\n        }\n        if (td) {\n            td.textContent = td ? formatArgs.formattedText : '';\n            this.parent.refreshNode(td, {\n                type: formatArgs.type,\n                result: formatArgs.formattedText,\n                curSymbol: getNumberDependable(this.parent.locale, 'USD'),\n                isRightAlign: formatArgs.isRightAlign,\n                value: formatArgs.value || ''\n            });\n        }\n        var style = {};\n        if (cell && cell.style) {\n            if (cell.style.properties) {\n                style = skipDefaultValue(cell.style, true);\n            }\n            else {\n                style = cell.style;\n            }\n        }\n        if (Object.keys(style).length || Object.keys(this.parent.commonCellStyle).length || lastCell) {\n            if (isRefresh) {\n                this.removeStyle(td);\n                this.parent.notify(setCellFormat, { style: style, range: getCellAddress(rowIdx, colIdx) });\n            }\n            else {\n                this.parent.notify(applyCellFormat, {\n                    style: extend({}, this.parent.commonCellStyle, style), rowIdx: rowIdx, colIdx: colIdx, cell: td,\n                    lastCell: lastCell, row: row, hRow: hRow, isHeightCheckNeeded: isHeightCheckNeeded, manualUpdate: false\n                });\n            }\n        }\n        else {\n            if (isRefresh) {\n                this.removeStyle(td);\n            }\n        }\n        if (cell && cell.hyperlink) {\n            var args = { cell: cell, td: td, rowIdx: rowIdx, colIdx: colIdx };\n            this.parent.notify(createHyperlinkElement, args);\n        }\n    };\n    CellRenderer.prototype.removeStyle = function (element) {\n        if (element.style.length) {\n            element.removeAttribute('style');\n        }\n    };\n    /** @hidden */\n    CellRenderer.prototype.refreshRange = function (range) {\n        var sheet = this.parent.getActiveSheet();\n        var cRange = range.slice();\n        if (inView(this.parent, cRange, true)) {\n            for (var i = cRange[0]; i <= cRange[2]; i++) {\n                if (isHiddenRow(sheet, i)) {\n                    continue;\n                }\n                for (var j = cRange[1]; j <= cRange[3]; j++) {\n                    var cell = this.parent.getCell(i, j);\n                    if (cell) {\n                        this.updateCell(i, j, cell, getCell(i, j, sheet), false, null, null, true, cell ? true : false);\n                        this.parent.notify(renderFilterCell, { td: cell, rowIndex: i, colIndex: j });\n                    }\n                }\n            }\n        }\n    };\n    return CellRenderer;\n}());\nexport { CellRenderer };\n","import { initialLoad, ribbon, formulaBar, beforeVirtualContentLoaded, getSiblingsHeight, setAriaOptions } from '../common/index';\nimport { SheetRender, RowRenderer, CellRenderer } from './index';\nimport { remove } from '@syncfusion/ej2-base';\nimport { getSheetName, getRowsHeight, getColumnsWidth } from '../../workbook/base/index';\nimport { getCellAddress, getCellIndexes } from '../../workbook/common/index';\nimport { dataRefresh, sheetTabs, onContentScroll, deInitProperties, beforeDataBound } from '../common/index';\nimport { spreadsheetDestroyed } from '../common/index';\n/**\n * Render module is used to render the spreadsheet\n * @hidden\n */\nvar Render = /** @class */ (function () {\n    function Render(parent) {\n        this.parent = parent;\n        this.addEventListener();\n    }\n    Render.prototype.render = function () {\n        if (!this.parent.isMobileView()) {\n            this.parent.notify(ribbon, null);\n            this.parent.notify(formulaBar, null);\n        }\n        var sheetPanel = this.parent.createElement('div', {\n            id: this.parent.element.id + '_sheet_panel', className: 'e-sheet-panel'\n        });\n        if (this.parent.enableRtl) {\n            sheetPanel.classList.add('e-rtl');\n        }\n        this.parent.element.appendChild(sheetPanel);\n        this.parent.notify(sheetTabs, null);\n        if (this.parent.isMobileView()) {\n            this.parent.notify(formulaBar, null);\n            this.parent.notify(ribbon, null);\n        }\n        this.setSheetPanelSize();\n        this.renderSheet(sheetPanel);\n        this.checkTopLeftCell();\n    };\n    Render.prototype.checkTopLeftCell = function () {\n        var sheet = this.parent.getActiveSheet();\n        if (!this.parent.scrollSettings.enableVirtualization || sheet.topLeftCell === 'A1') {\n            this.refreshUI();\n        }\n        else {\n            var indexes = getCellIndexes(sheet.topLeftCell);\n            var top_1 = indexes[0] ? getRowsHeight(sheet, 0, indexes[0] - 1) : 0;\n            var left = indexes[1] ? getColumnsWidth(sheet, 0, indexes[1] - 1) : 0;\n            this.parent.notify(onContentScroll, { scrollLeft: left, scrollTop: top_1, preventScroll: true });\n            var threshold = this.parent.getThreshold('row');\n            var rowIndex = indexes[0] > threshold ? indexes[0] - threshold : 0;\n            threshold = this.parent.getThreshold('col');\n            var colIndex = indexes[1] > threshold ? indexes[1] - threshold : 0;\n            this.refreshUI({ rowIndex: rowIndex, colIndex: colIndex, refresh: 'All', top: top_1, left: left });\n        }\n    };\n    Render.prototype.renderSheet = function (panel) {\n        if (panel === void 0) { panel = document.getElementById(this.parent.element.id + '_sheet_panel'); }\n        panel.appendChild(this.parent.createElement('div', { className: 'e-sheet', id: this.parent.element.id + '_sheet' }));\n        this.parent.serviceLocator.getService('sheet').renderPanel();\n    };\n    Render.prototype.refreshUI = function (args, address) {\n        if (args === void 0) { args = { rowIndex: 0, colIndex: 0, refresh: 'All' }; }\n        var sheetModule = this.parent.serviceLocator.getService('sheet');\n        var sheet = this.parent.getActiveSheet();\n        var sheetName = getSheetName(this.parent);\n        this.parent.showSpinner();\n        if (!address) {\n            if (this.parent.scrollSettings.enableVirtualization) {\n                var lastRowIdx = args.rowIndex + this.parent.viewport.rowCount + (this.parent.getThreshold('row') * 2);\n                var count = sheet.rowCount - 1;\n                if (this.parent.scrollSettings.isFinite && lastRowIdx > count) {\n                    lastRowIdx = count;\n                }\n                var lastColIdx = args.colIndex + this.parent.viewport.colCount + (this.parent.getThreshold('col') * 2);\n                count = sheet.colCount - 1;\n                if (this.parent.scrollSettings.isFinite && lastColIdx > count) {\n                    lastColIdx = count;\n                }\n                var indexes = this.parent.skipHiddenRows(args.rowIndex, lastRowIdx);\n                var startRow = args.rowIndex;\n                if (args.rowIndex !== indexes[0]) {\n                    var topLeftCell = getCellIndexes(sheet.topLeftCell);\n                    if (topLeftCell[0] === args.rowIndex) {\n                        sheet.topLeftCell = getCellAddress(indexes[0], topLeftCell[1]);\n                        this.parent.setProperties({ 'sheets': this.parent.sheets }, true);\n                    }\n                    args.rowIndex = indexes[0];\n                }\n                lastRowIdx = indexes[1];\n                this.parent.viewport.topIndex = args.rowIndex;\n                this.parent.viewport.bottomIndex = lastRowIdx;\n                address = getCellAddress(startRow, args.colIndex) + \":\" + getCellAddress(lastRowIdx, lastColIdx);\n            }\n            else {\n                address = \"A1:\" + getCellAddress(sheet.rowCount - 1, sheet.colCount - 1);\n            }\n        }\n        if (args.refresh === 'All') {\n            this.parent.trigger(beforeDataBound, {});\n        }\n        setAriaOptions(this.parent.getMainContent(), { busy: true });\n        this.parent.getData(sheetName + \"!\" + address).then(function (values) {\n            var lastCellIdx = getCellIndexes(address.split(':')[1])[1];\n            switch (args.refresh) {\n                case 'All':\n                    sheetModule.renderTable(values, args.rowIndex, args.colIndex, lastCellIdx, args.top, args.left);\n                    break;\n                case 'Row':\n                    sheetModule.refreshRowContent(values, args.colIndex, lastCellIdx);\n                    break;\n                case 'Column':\n                    sheetModule.refreshColumnContent(values, args.rowIndex, args.colIndex, lastCellIdx);\n                    break;\n                case 'RowPart':\n                    sheetModule.updateRowContent(values, args.colIndex, lastCellIdx, args.direction);\n                    break;\n                case 'ColumnPart':\n                    sheetModule.updateColContent(values, args.rowIndex, args.colIndex, lastCellIdx, args.direction);\n                    break;\n            }\n        });\n        this.parent.notify(beforeVirtualContentLoaded, { refresh: args.refresh });\n    };\n    Render.prototype.removeSheet = function () {\n        remove(document.getElementById(this.parent.element.id + '_sheet'));\n    };\n    /**\n     * Refresh the active sheet\n     */\n    Render.prototype.refreshSheet = function () {\n        this.removeSheet();\n        this.renderSheet();\n        this.parent.notify(deInitProperties, {});\n        this.checkTopLeftCell();\n    };\n    /**\n     * Used to set sheet panel size.\n     */\n    Render.prototype.setSheetPanelSize = function () {\n        var panel = document.getElementById(this.parent.element.id + '_sheet_panel');\n        var offset = this.parent.element.getBoundingClientRect();\n        var height;\n        if (this.parent.height === 'auto') {\n            panel.style.height = '260px';\n            height = 230;\n        }\n        else {\n            height = offset.height - getSiblingsHeight(panel);\n            panel.style.height = height + \"px\";\n            height -= 30;\n        }\n        this.parent.viewport.height = height;\n        this.parent.viewport.width = offset.width;\n        this.parent.viewport.rowCount = this.roundValue(height, 20);\n        this.parent.viewport.colCount = this.roundValue(offset.width, 64);\n    };\n    Render.prototype.roundValue = function (size, threshold) {\n        var value = size / threshold;\n        var roundedValue = Math.round(value);\n        return Math.abs(value - roundedValue) < 0.5 ? roundedValue : roundedValue - 1;\n    };\n    /**\n     * Registing the renderer related services.\n     */\n    Render.prototype.instantiateRenderer = function () {\n        this.parent.serviceLocator.register('cell', new CellRenderer(this.parent));\n        this.parent.serviceLocator.register('row', new RowRenderer(this.parent));\n        this.parent.serviceLocator.register('sheet', new SheetRender(this.parent));\n    };\n    /**\n     * Destroy the Render module.\n     * @return {void}\n     */\n    Render.prototype.destroy = function () {\n        this.removeEventListener();\n        this.parent = null;\n    };\n    Render.prototype.addEventListener = function () {\n        this.parent.on(initialLoad, this.instantiateRenderer, this);\n        this.parent.on(dataRefresh, this.refreshSheet, this);\n        this.parent.on(spreadsheetDestroyed, this.destroy, this);\n    };\n    Render.prototype.removeEventListener = function () {\n        this.parent.off(initialLoad, this.instantiateRenderer);\n        this.parent.off(dataRefresh, this.refreshSheet);\n        this.parent.off(spreadsheetDestroyed, this.destroy);\n    };\n    return Render;\n}());\nexport { Render };\n","import { Dialog as DialogComponent } from '@syncfusion/ej2-popups';\nimport { extend, remove } from '@syncfusion/ej2-base';\nimport { locale } from '../common/index';\n/**\n * Dialog Service.\n * @hidden\n */\nvar Dialog = /** @class */ (function () {\n    /**\n     * Constructor for initializing dialog service.\n     */\n    function Dialog(parent) {\n        this.parent = parent;\n    }\n    /**\n     * To show dialog.\n     */\n    Dialog.prototype.show = function (dialogModel) {\n        var _this = this;\n        var btnContent;\n        var closeHandler = dialogModel.close || null;\n        var model = {\n            header: 'Spreadsheet',\n            cssClass: this.parent.cssClass,\n            target: this.parent.element,\n            buttons: []\n        };\n        dialogModel.close = function () {\n            _this.dialogInstance.destroy();\n            remove(_this.dialogInstance.element);\n            _this.dialogInstance = null;\n            if (closeHandler) {\n                closeHandler();\n            }\n        };\n        extend(model, dialogModel);\n        btnContent = this.parent.serviceLocator.getService(locale).getConstant(model.buttons.length ? 'Cancel' : 'Ok');\n        model.buttons.push({\n            buttonModel: { content: btnContent, isPrimary: model.buttons.length === 0 },\n            click: this.hide.bind(this),\n        });\n        var div = this.parent.createElement('div');\n        document.body.appendChild(div);\n        this.dialogInstance = new DialogComponent(model);\n        this.dialogInstance.createElement = this.parent.createElement;\n        this.dialogInstance.appendTo(div);\n    };\n    /**\n     * To hide dialog.\n     */\n    Dialog.prototype.hide = function () {\n        this.dialogInstance.hide();\n    };\n    /**\n     * To clear private variables.\n     */\n    Dialog.prototype.destroy = function () {\n        this.parent = null;\n    };\n    return Dialog;\n}());\nexport { Dialog };\n","import { completeAction, beginAction } from '../common/index';\nimport { setActionData, updateUndoRedoCollection } from '../common/index';\n/**\n *  Begin and complete events.\n * @hidden\n */\nvar ActionEvents = /** @class */ (function () {\n    /**\n     * Constructor for initializing action begin and action complete services.\n     */\n    function ActionEvents(parent) {\n        this.parent = parent;\n        this.addEventListener();\n        //this.initializeActionBegin();\n        //this.initializeActionComplete();\n    }\n    ActionEvents.prototype.initializeActionBegin = function () {\n        var _this = this;\n        var cellFormat = this.parent.beforeCellFormat;\n        this.parent.beforeCellFormat = function (args) {\n            _this.actionEventHandler({ evtArgs: args, evtFunc: cellFormat, actionType: 'begin', eventType: 'format' });\n        };\n        var beforeOpen = this.parent.beforeOpen;\n        this.parent.beforeOpen = function (args) {\n            _this.actionEventHandler({ evtArgs: args, evtFunc: beforeOpen, actionType: 'begin', eventType: 'beforeOpen' });\n        };\n        var beforeSave = this.parent.beforeSave;\n        this.parent.beforeSave = function (args) {\n            _this.actionEventHandler({ evtArgs: args, evtFunc: beforeSave, actionType: 'begin', eventType: 'beforeSave' });\n        };\n        var beforeSort = this.parent.beforeSort;\n        this.parent.beforeSort = function (args) {\n            _this.actionEventHandler({ evtArgs: args, evtFunc: beforeSort, actionType: 'begin', eventType: 'beforeSort' });\n        };\n    };\n    ActionEvents.prototype.initializeActionComplete = function () {\n        var _this = this;\n        var sortComplete = this.parent.sortComplete;\n        this.parent.sortComplete = function (args) {\n            _this.actionEventHandler({ evtArgs: args, evtFunc: sortComplete, actionType: 'complete', eventType: 'sorting' });\n        };\n        var cellSave = this.parent.cellSave;\n        this.parent.cellSave = function (args) {\n            _this.actionEventHandler({ evtArgs: args, evtFunc: cellSave, actionType: 'complete', eventType: 'cellSave' });\n        };\n    };\n    ActionEvents.prototype.actionEventHandler = function (args) {\n        if (args.evtFunc) {\n            args.evtFunc.apply(this, [args]);\n        }\n        if (args.actionType === 'begin') {\n            this.actionBeginHandler({ eventArgs: args.evtArgs, action: args.eventType });\n        }\n        else {\n            this.actionCompleteHandler({ eventArgs: args.evtArgs, action: args.eventType });\n        }\n    };\n    ActionEvents.prototype.actionBeginHandler = function (args) {\n        this.parent.trigger('actionBegin', { action: args.action, args: args });\n        if (args.action === 'clipboard' || args.action === 'beforeSort' || args.action === 'format' || args.action === 'cellSave') {\n            this.parent.notify(setActionData, { args: args });\n        }\n    };\n    ActionEvents.prototype.actionCompleteHandler = function (args) {\n        this.parent.trigger('actionComplete', args);\n        if (args.action !== 'undoRedo') {\n            this.parent.notify(updateUndoRedoCollection, { args: args });\n        }\n    };\n    ActionEvents.prototype.addEventListener = function () {\n        this.parent.on(completeAction, this.actionCompleteHandler, this);\n        this.parent.on(beginAction, this.actionBeginHandler, this);\n    };\n    ActionEvents.prototype.removeEventListener = function () {\n        this.parent.off(completeAction, this.actionCompleteHandler);\n        this.parent.off(beginAction, this.actionBeginHandler);\n    };\n    return ActionEvents;\n}());\nexport { ActionEvents };\n","var __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    }\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\n/// <reference path='../../workbook/base/workbook-model.d.ts'/>\nimport { Property, NotifyPropertyChanges, EventHandler, Event } from '@syncfusion/ej2-base';\nimport { addClass, removeClass, Complex, formatUnit, detach, L10n, isNullOrUndefined, Browser } from '@syncfusion/ej2-base';\nimport { initialLoad, mouseDown, spreadsheetDestroyed, keyUp, hideShowRow, performUndoRedo } from '../common/index';\nimport { sheetNameUpdate, updateUndoRedoCollection, getUpdateUsingRaf } from '../common/index';\nimport { actionEvents, collaborativeUpdate, keyDown } from '../common/index';\nimport { getSiblingsHeight, colWidthChanged, rowHeightChanged } from '../common/index';\nimport { defaultLocale, locale, setAriaOptions, setResize, updateToggleItem, initiateFilterUI, clearFilter } from '../common/index';\nimport { ribbon, formulaBar, sheetTabs, formulaOperation } from '../common/index';\nimport { addContextMenuItems, removeContextMenuItems, enableContextMenuItems, selectRange } from '../common/index';\nimport { cut, copy, paste, dialog, editOperation, activeSheetChanged } from '../common/index';\nimport { Render } from '../renderer/render';\nimport { Scroll, VirtualScroll, Edit, CellFormat, Selection, KeyboardNavigation, KeyboardShortcut } from '../actions/index';\nimport { Clipboard, ShowHide, UndoRedo, SpreadsheetHyperlink } from '../actions/index';\nimport { click } from '../common/index';\nimport { Dialog, ActionEvents } from '../services/index';\nimport { ServiceLocator } from '../../workbook/services/index';\nimport { getColumnsWidth, getSheetIndex, WorkbookHyperlink } from './../../workbook/index';\nimport { activeCellChanged, afterHyperlinkCreate } from './../../workbook/index';\nimport { getSheetNameFromAddress, DataBind, beforeHyperlinkCreate } from './../../workbook/index';\nimport { sortComplete } from './../../workbook/index';\nimport { getSheetIndexFromId, WorkbookEdit, WorkbookOpen, WorkbookSave, WorkbookCellFormat, WorkbookSort } from './../../workbook/index';\nimport { Workbook } from '../../workbook/base/workbook';\nimport { Resize } from '../actions/index';\nimport { getRequiredModules, ScrollSettings } from '../common/index';\nimport { SelectionSettings, getStartEvent } from '../common/index';\nimport { createSpinner, showSpinner, hideSpinner } from '@syncfusion/ej2-popups';\nimport { setRowHeight, getRowsHeight, isHiddenRow, getColumnWidth, getRowHeight } from './../../workbook/base/index';\nimport { getRangeIndexes, getIndexesFromAddress, getCellIndexes, WorkbookNumberFormat, WorkbookFormula } from '../../workbook/index';\nimport { Ribbon, FormulaBar, SheetTabs, Open, ContextMenu, Save, NumberFormat, Formula } from '../integrations/index';\nimport { Sort, Filter } from '../integrations/index';\nimport { isNumber, getColumn, WorkbookFilter } from '../../workbook/index';\n/**\n * Represents the Spreadsheet component.\n * ```html\n * <div id='spreadsheet'></div>\n * <script>\n *  var spreadsheetObj = new Spreadsheet();\n *  spreadsheetObj.appendTo('#spreadsheet');\n * </script>\n * ```\n */\nvar Spreadsheet = /** @class */ (function (_super) {\n    __extends(Spreadsheet, _super);\n    /**\n     * Constructor for creating the widget.\n     * @param  {SpreadsheetModel} options? - Configures Spreadsheet options.\n     * @param  {string|HTMLElement} element? - Element to render Spreadsheet.\n     */\n    function Spreadsheet(options, element) {\n        var _this = _super.call(this, options) || this;\n        /** @hidden */\n        _this.isEdit = false;\n        /** @hidden */\n        _this.viewport = {\n            rowCount: 0, colCount: 0, height: 0, topIndex: 0, leftIndex: 0, width: 0,\n            bottomIndex: 0\n        };\n        _this.needsID = true;\n        Spreadsheet_1.Inject(Ribbon, FormulaBar, SheetTabs, Selection, Edit, KeyboardNavigation, KeyboardShortcut, Clipboard, DataBind, Open, ContextMenu, Save, NumberFormat, CellFormat, Formula, WorkbookEdit, WorkbookOpen, WorkbookSave, WorkbookCellFormat, WorkbookNumberFormat, WorkbookFormula, Sort, WorkbookSort, Resize, UndoRedo, WorkbookFilter, Filter, SpreadsheetHyperlink, WorkbookHyperlink);\n        if (element) {\n            _this.appendTo(element);\n        }\n        return _this;\n    }\n    Spreadsheet_1 = Spreadsheet;\n    /**\n     * To get cell element.\n     * @returns HTMLElement\n     * @hidden\n     */\n    Spreadsheet.prototype.getCell = function (rowIndex, colIndex) {\n        if (this.scrollSettings.enableVirtualization) {\n            colIndex = colIndex - this.viewport.leftIndex;\n        }\n        var row = this.getRow(rowIndex);\n        return row ? row.cells[colIndex] : row;\n    };\n    /**\n     * Get cell element.\n     * @returns HTMLTableRowElement\n     * @hidden\n     */\n    Spreadsheet.prototype.getRow = function (index, table) {\n        if (this.scrollSettings.enableVirtualization) {\n            index -= this.hiddenRowsCount(this.viewport.topIndex, index);\n            index -= this.viewport.topIndex;\n        }\n        table = table || this.getContentTable();\n        return table ? table.rows[index] : null;\n    };\n    /** @hidden */\n    Spreadsheet.prototype.hiddenRowsCount = function (startIndex, endIndex) {\n        var sheet = this.getActiveSheet();\n        var count = 0;\n        for (var i = startIndex; i <= endIndex; i++) {\n            if (isHiddenRow(sheet, i)) {\n                count++;\n            }\n        }\n        return count;\n    };\n    /**\n     * To initialize the services;\n     * @returns void\n     * @hidden\n     */\n    Spreadsheet.prototype.preRender = function () {\n        _super.prototype.preRender.call(this);\n        this.serviceLocator = new ServiceLocator;\n        this.initServices();\n    };\n    Spreadsheet.prototype.initServices = function () {\n        this.serviceLocator.register(locale, new L10n(this.getModuleName(), defaultLocale, this.locale));\n        this.serviceLocator.register(dialog, new Dialog(this));\n        this.serviceLocator.register(actionEvents, new ActionEvents(this));\n    };\n    /**\n     * To Initialize the component rendering.\n     * @returns void\n     * @hidden\n     */\n    Spreadsheet.prototype.render = function () {\n        _super.prototype.render.call(this);\n        this.element.setAttribute('tabindex', '0');\n        setAriaOptions(this.element, { role: 'grid' });\n        this.renderModule = new Render(this);\n        this.notify(initialLoad, null);\n        this.renderSpreadsheet();\n        this.wireEvents();\n    };\n    Spreadsheet.prototype.renderSpreadsheet = function () {\n        if (this.cssClass) {\n            addClass([this.element], this.cssClass.split(' '));\n        }\n        this.setHeight();\n        this.setWidth();\n        createSpinner({ target: this.element }, this.createElement);\n        if (this.isMobileView() && this.cssClass.indexOf('e-mobile-view') === -1) {\n            this.element.classList.add('e-mobile-view');\n        }\n        this.sheetModule = this.serviceLocator.getService('sheet');\n        if (this.allowScrolling) {\n            this.scrollModule = new Scroll(this);\n        }\n        if (this.scrollSettings.enableVirtualization) {\n            new VirtualScroll(this);\n        }\n        this.renderModule.render();\n        new ShowHide(this);\n    };\n    /**\n     * By default, Spreadsheet shows the spinner for all its actions. To manually show spinner you this method at your needed time.\n     * @return {void}\n     */\n    Spreadsheet.prototype.showSpinner = function () {\n        showSpinner(this.element);\n    };\n    /**\n     * To hide showed spinner manually.\n     * @return {void}\n     */\n    Spreadsheet.prototype.hideSpinner = function () {\n        hideSpinner(this.element);\n    };\n    /**\n     * Selection will navigates to the specified cell address in active sheet.\n     * @param {string} address - Specifies the cell address which needs to navigate.\n     */\n    Spreadsheet.prototype.goTo = function (address) {\n        var indexes = getRangeIndexes(address);\n        var content = this.getMainContent();\n        var sheet = this.getActiveSheet();\n        var vTrack;\n        var cVTrack;\n        var rVTrack;\n        var offset;\n        var vWidth;\n        var vHeight;\n        var scrollableSize;\n        if (indexes[0] === 0) {\n            content.scrollTop = 0;\n        }\n        else {\n            offset = getRowsHeight(sheet, 0, indexes[0] - 1);\n            if (this.scrollSettings.enableVirtualization) {\n                scrollableSize = offset + this.getContentTable().getBoundingClientRect().height;\n                vHeight = parseInt(content.querySelector('.e-virtualtrack').style.height, 10);\n                if (scrollableSize > vHeight) {\n                    scrollableSize += 10;\n                    vTrack = content.querySelector('.e-virtualtrack');\n                    vTrack.style.height = scrollableSize + \"px\";\n                    if (sheet.showHeaders) {\n                        rVTrack = this.getRowHeaderContent().querySelector('.e-virtualtrack');\n                        rVTrack.style.height = scrollableSize + \"px\";\n                    }\n                    getUpdateUsingRaf(function () {\n                        vTrack.style.height = vHeight + \"px\";\n                        if (sheet.showHeaders) {\n                            rVTrack.style.height = vHeight + \"px\";\n                        }\n                    });\n                }\n            }\n            content.scrollTop = offset;\n        }\n        if (indexes[1] === 0) {\n            content.scrollLeft = 0;\n        }\n        else {\n            offset = getColumnsWidth(sheet, 0, indexes[1] - 1);\n            if (this.scrollSettings.enableVirtualization) {\n                scrollableSize = offset + this.getContentTable().getBoundingClientRect().width;\n                vWidth = parseInt(content.querySelector('.e-virtualtrack').style.width, 10);\n                if (scrollableSize > vWidth) {\n                    scrollableSize += 10;\n                    vTrack = content.querySelector('.e-virtualtrack');\n                    vTrack.style.width = scrollableSize + \"px\";\n                    if (sheet.showHeaders) {\n                        cVTrack = this.getColumnHeaderContent().querySelector('.e-virtualtrack');\n                        cVTrack.style.width = scrollableSize + \"px\";\n                    }\n                    getUpdateUsingRaf(function () {\n                        vTrack.style.width = vWidth + \"px\";\n                        if (sheet.showHeaders) {\n                            cVTrack.style.width = vWidth + \"px\";\n                        }\n                    });\n                }\n            }\n            content.scrollLeft = offset;\n        }\n    };\n    /**\n     * This method is used to resize the Spreadsheet component.\n     */\n    Spreadsheet.prototype.resize = function () {\n        this.renderModule.setSheetPanelSize();\n        if (this.scrollSettings.enableVirtualization) {\n            this.renderModule.refreshSheet();\n        }\n    };\n    /**\n     * To cut the specified cell or cells properties such as value, format, style etc...\n     * @param {string} address - Specifies the range address to cut.\n     */\n    Spreadsheet.prototype.cut = function (address) {\n        var promise = new Promise(function (resolve, reject) { resolve((function () { })()); });\n        this.notify(cut, address ? {\n            range: getIndexesFromAddress(address),\n            sId: this.sheets[getSheetIndex(this, getSheetNameFromAddress(address))].id,\n            promise: promise\n        } : { promise: promise });\n        return promise;\n    };\n    /**\n     * To copy the specified cell or cells properties such as value, format, style etc...\n     * @param {string} address - Specifies the range address.\n     */\n    Spreadsheet.prototype.copy = function (address) {\n        var promise = new Promise(function (resolve, reject) { resolve((function () { })()); });\n        this.notify(copy, address ? {\n            range: getIndexesFromAddress(address),\n            sId: this.sheets[getSheetIndex(this, getSheetNameFromAddress(address))].id,\n            promise: promise\n        } : { promise: promise });\n        return promise;\n    };\n    /**\n     * This method is used to paste the cut or copied cells in to specified address.\n     * @param {string} address - Specifies the cell or range address.\n     * @param {PasteSpecialType} type - Specifies the type of paste.\n     */\n    Spreadsheet.prototype.paste = function (address, type) {\n        this.notify(paste, {\n            range: getIndexesFromAddress(address), sIdx: getSheetIndex(this, getSheetNameFromAddress(address)),\n            type: type, isAction: false\n        });\n    };\n    /**\n     * To update the action which need to perform.\n     * @param {string} options - event options.\n     */\n    Spreadsheet.prototype.updateAction = function (options) {\n        var model = JSON.parse(options);\n        this.notify(collaborativeUpdate, { action: model.action, eventArgs: model.eventArgs });\n    };\n    Spreadsheet.prototype.setHeight = function () {\n        if (this.height.toString().indexOf('%') > -1) {\n            this.element.style.minHeight = '400px';\n        }\n        this.element.style.height = formatUnit(this.height);\n    };\n    Spreadsheet.prototype.setWidth = function () {\n        if (this.width.toString().indexOf('%') > -1 || this.width === 'auto') {\n            this.element.style.minWidth = '300px';\n        }\n        this.element.style.width = formatUnit(this.width);\n    };\n    /**\n     * Set the width of column.\n     * @param {number} width\n     * @param {number} colIndex\n     * @param {number} sheetIndex\n     */\n    Spreadsheet.prototype.setColWidth = function (width, colIndex, sheetIndex) {\n        var colThreshold = this.getThreshold('col');\n        var lastIdx = this.viewport.leftIndex + this.viewport.colCount + (colThreshold * 2);\n        sheetIndex = isNullOrUndefined(sheetIndex) ? null : sheetIndex - 1;\n        var sheet = isNullOrUndefined(sheetIndex) ? this.getActiveSheet() : this.sheets[sheetIndex];\n        if (sheet) {\n            var mIndex = colIndex;\n            var colWidth = (typeof width === 'number') ? width + 'px' : width;\n            colIndex = isNullOrUndefined(colIndex) ? getCellIndexes(sheet.activeCell)[1] : colIndex;\n            if (sheet === this.getActiveSheet()) {\n                if (colIndex >= this.viewport.leftIndex && colIndex <= lastIdx) {\n                    if (this.scrollSettings.enableVirtualization) {\n                        colIndex = colIndex - this.viewport.leftIndex;\n                    }\n                    var trgt = this.getColumnHeaderContent().getElementsByClassName('e-header-cell')[colIndex];\n                    var eleWidth = parseInt(this.getMainContent().getElementsByTagName('col')[colIndex].style.width, 10);\n                    var threshold = parseInt(colWidth, 10) - eleWidth;\n                    if (threshold < 0 && eleWidth < -(threshold)) {\n                        getCellIndexes(sheet.activeCell);\n                        threshold = -eleWidth;\n                    }\n                    var oldIdx = parseInt(trgt.getAttribute('aria-colindex'), 10) - 1;\n                    if (this.getActiveSheet() === sheet) {\n                        this.notify(colWidthChanged, { threshold: threshold, colIdx: oldIdx });\n                        setResize(colIndex, colWidth, true, this);\n                    }\n                }\n                else {\n                    var oldWidth = getColumnWidth(sheet, colIndex);\n                    var threshold = void 0;\n                    if (parseInt(colWidth, 10) > 0) {\n                        threshold = -(oldWidth - parseInt(colWidth, 10));\n                    }\n                    else {\n                        threshold = -oldWidth;\n                    }\n                    this.notify(colWidthChanged, { threshold: threshold, colIdx: colIndex });\n                }\n            }\n            getColumn(sheet, mIndex).width = parseInt(colWidth, 10) > 0 ? parseInt(colWidth, 10) : 0;\n            sheet.columns[mIndex].customWidth = true;\n            this.setProperties({ sheets: this.sheets }, true);\n        }\n    };\n    /**\n     * Set the height of row.\n     * @param {number} height\n     * @param {number} rowIndex\n     * @param {number} sheetIndex\n     */\n    Spreadsheet.prototype.setRowHeight = function (height, rowIndex, sheetIndex) {\n        sheetIndex = isNullOrUndefined(sheetIndex) ? null : sheetIndex - 1;\n        var sheet = isNullOrUndefined(sheetIndex) ? this.getActiveSheet() : this.sheets[sheetIndex];\n        if (sheet) {\n            var mIndex = rowIndex;\n            var rowHeight = (typeof height === 'number') ? height + 'px' : height;\n            rowIndex = isNullOrUndefined(rowIndex) ? getCellIndexes(sheet.activeCell)[0] : rowIndex;\n            if (sheet === this.getActiveSheet()) {\n                if (rowIndex <= this.viewport.bottomIndex && rowIndex >= this.viewport.topIndex) {\n                    if (this.scrollSettings.enableVirtualization) {\n                        rowIndex = rowIndex - this.viewport.topIndex;\n                    }\n                    var trgt = this.getRowHeaderContent().getElementsByClassName('e-header-cell')[rowIndex];\n                    var eleHeight = parseInt(this.getMainContent().getElementsByTagName('tr')[rowIndex].style.height, 10);\n                    var threshold = parseInt(rowHeight, 10) - eleHeight;\n                    if (threshold < 0 && eleHeight < -(threshold)) {\n                        threshold = -eleHeight;\n                    }\n                    var oldIdx = parseInt(trgt.parentElement.getAttribute('aria-rowindex'), 10) - 1;\n                    if (this.getActiveSheet() === sheet) {\n                        this.notify(rowHeightChanged, { threshold: threshold, rowIdx: oldIdx });\n                        setResize(rowIndex, rowHeight, false, this);\n                    }\n                }\n                else {\n                    var oldHeight = getRowHeight(sheet, rowIndex);\n                    var threshold = void 0;\n                    if (parseInt(rowHeight, 10) > 0) {\n                        threshold = -(oldHeight - parseInt(rowHeight, 10));\n                    }\n                    else {\n                        threshold = -oldHeight;\n                    }\n                    this.notify(rowHeightChanged, { threshold: threshold, rowIdx: rowIndex });\n                }\n            }\n            setRowHeight(sheet, mIndex, parseInt(rowHeight, 10) > 0 ? parseInt(rowHeight, 10) : 0);\n            sheet.rows[mIndex].customHeight = true;\n            this.setProperties({ sheets: this.sheets }, true);\n        }\n    };\n    /**\n     * To add the hyperlink in the cell\n     * @param {string | HyperlinkModel} hyperlink\n     * @param {string} address\n     */\n    Spreadsheet.prototype.addHyperlink = function (hyperlink, address) {\n        this.insertHyperlink(hyperlink, address, '', true);\n    };\n    /**\n     * To remove the hyperlink in the cell\n     * @param {string} range\n     */\n    Spreadsheet.prototype.removeHyperlink = function (range) {\n        var rangeArr;\n        var sheet = this.getActiveSheet();\n        var sheetIdx;\n        if (range && range.indexOf('!') !== -1) {\n            rangeArr = range.split('!');\n            sheetIdx = parseInt(rangeArr[0].replace(/\\D/g, ''), 10) - 1;\n            sheet = this.sheets[sheetIdx];\n            range = rangeArr[1];\n        }\n        var rangeIndexes = range ? getRangeIndexes(range) : getRangeIndexes(this.getActiveSheet().activeCell);\n        var cellMod;\n        for (var rowIdx = rangeIndexes[0]; rowIdx <= rangeIndexes[2]; rowIdx++) {\n            for (var colIdx = rangeIndexes[1]; colIdx <= rangeIndexes[3]; colIdx++) {\n                if (sheet && sheet.rows[rowIdx] && sheet.rows[rowIdx].cells[colIdx]) {\n                    cellMod = sheet.rows[rowIdx].cells[colIdx];\n                    if (typeof (cellMod.hyperlink) === 'string') {\n                        cellMod.value = cellMod.value ? cellMod.value : cellMod.hyperlink;\n                    }\n                    else {\n                        cellMod.value = cellMod.value ? cellMod.value : cellMod.hyperlink.address;\n                    }\n                    delete (cellMod.hyperlink);\n                    if (sheet === this.getActiveSheet()) {\n                        var eleRowIdx = void 0;\n                        var eleColIdx = void 0;\n                        if (this.scrollSettings.enableVirtualization) {\n                            eleRowIdx = rowIdx - this.viewport.topIndex;\n                            eleColIdx = colIdx - this.viewport.leftIndex;\n                        }\n                        var cell = this.element.getElementsByClassName('e-main-content')[0].\n                            getElementsByClassName('e-row')[eleRowIdx].getElementsByClassName('e-cell')[eleColIdx];\n                        if (cell.getElementsByClassName('e-hyperlink')[0]) {\n                            cell.innerText = cell.getElementsByClassName('e-hyperlink')[0].innerHTML;\n                        }\n                    }\n                }\n            }\n        }\n    };\n    /** @hidden */\n    Spreadsheet.prototype.insertHyperlink = function (hyperlink, address, displayText, isMethod) {\n        if (this.allowHyperlink) {\n            var value = void 0;\n            var addrRange = void 0;\n            var sheetIdx = void 0;\n            var cellIdx = void 0;\n            var sheet = this.getActiveSheet();\n            var isEmpty = void 0;\n            address = address ? address : this.getActiveSheet().activeCell;\n            var befArgs = { hyperlink: hyperlink, cell: address, cancel: false };\n            var aftArgs = { hyperlink: hyperlink, cell: address };\n            if (!isMethod) {\n                this.trigger(beforeHyperlinkCreate, befArgs);\n            }\n            if (!befArgs.cancel) {\n                hyperlink = befArgs.hyperlink;\n                address = befArgs.cell;\n                _super.prototype.addHyperlink.call(this, hyperlink, address);\n                if (address && address.indexOf('!') !== -1) {\n                    addrRange = address.split('!');\n                    sheetIdx = parseInt(addrRange[0].replace(/\\D/g, ''), 10) - 1;\n                    sheet = this.sheets[sheetIdx];\n                    address = addrRange[1];\n                }\n                if (!sheet) {\n                    return;\n                }\n                address = address ? address : this.getActiveSheet().activeCell;\n                cellIdx = getRangeIndexes(address);\n                if (typeof (hyperlink) === 'string') {\n                    value = hyperlink;\n                }\n                else {\n                    value = hyperlink.address;\n                }\n                var mCell = sheet.rows[cellIdx[0]].cells[cellIdx[1]];\n                if (displayText !== '') {\n                    mCell.value = displayText;\n                }\n                else if (isNullOrUndefined(mCell.value) || mCell.value === '') {\n                    isEmpty = true;\n                }\n                if (!isMethod) {\n                    this.trigger(afterHyperlinkCreate, aftArgs);\n                }\n                if (sheet === this.getActiveSheet()) {\n                    this.serviceLocator.getService('cell').refreshRange(cellIdx);\n                }\n            }\n        }\n    };\n    /** @hidden */\n    Spreadsheet.prototype.setPanelSize = function () {\n        if (this.height !== 'auto') {\n            var panel = document.getElementById(this.element.id + '_sheet_panel');\n            panel.style.height = this.element.getBoundingClientRect().height - getSiblingsHeight(panel) + \"px\";\n        }\n    };\n    /**\n     * Opens the Excel file.\n     * @param {OpenOptions} options - Options for opening the excel file.\n     */\n    Spreadsheet.prototype.open = function (options) {\n        this.isOpen = true;\n        _super.prototype.open.call(this, options);\n        if (this.isOpen) {\n            this.showSpinner();\n        }\n    };\n    /** @hidden */\n    Spreadsheet.prototype.showHideRow = function (hide, startRow, endRow) {\n        if (endRow === void 0) { endRow = startRow; }\n        this.notify(hideShowRow, { startRow: startRow, endRow: endRow, hide: hide });\n    };\n    /**\n     * Gets the row header div of the Spreadsheet.\n     * @return {Element}\n     * @hidden\n     */\n    Spreadsheet.prototype.getRowHeaderContent = function () {\n        return this.sheetModule.getRowHeaderPanel();\n    };\n    /**\n     * Gets the column header div of the Spreadsheet.\n     * @return {Element}\n     * @hidden\n     */\n    Spreadsheet.prototype.getColumnHeaderContent = function () {\n        return this.sheetModule.getColHeaderPanel();\n    };\n    /**\n     * Gets the main content div of the Spreadsheet.\n     * @return {Element}\n     * @hidden\n     */\n    Spreadsheet.prototype.getMainContent = function () {\n        return this.sheetModule.getContentPanel();\n    };\n    /**\n     * Get the main content table element of spreadsheet.\n     * @return {HTMLTableElement}\n     * @hidden\n     */\n    Spreadsheet.prototype.getContentTable = function () {\n        return this.sheetModule.getContentTable();\n    };\n    /**\n     * Get the row header table element of spreadsheet.\n     * @return {HTMLTableElement}\n     * @hidden\n     */\n    Spreadsheet.prototype.getRowHeaderTable = function () {\n        return this.sheetModule.getRowHeaderTable();\n    };\n    /**\n     * Get the column header table element of spreadsheet.\n     * @return {HTMLTableElement}\n     * @hidden\n     */\n    Spreadsheet.prototype.getColHeaderTable = function () {\n        return this.sheetModule.getColHeaderTable();\n    };\n    /**\n     * To get the backup element count for row and column virtualization.\n     * @hidden\n     */\n    Spreadsheet.prototype.getThreshold = function (layout) {\n        var threshold = Math.round((this.viewport[layout + 'Count'] + 1) / 2);\n        return threshold < 15 ? 15 : threshold;\n    };\n    /** @hidden */\n    Spreadsheet.prototype.isMobileView = function () {\n        return ((this.cssClass.indexOf('e-mobile-view') > -1 || Browser.isDevice) && this.cssClass.indexOf('e-desktop-view') === -1)\n            && false;\n    };\n    /** @hidden */\n    Spreadsheet.prototype.getValueRowCol = function (sheetIndex, rowIndex, colIndex) {\n        var val = _super.prototype.getValueRowCol.call(this, sheetIndex, rowIndex, colIndex);\n        return val;\n    };\n    /**\n     * To update a cell properties.\n     * @param {CellModel} cell - Cell properties.\n     * @param {string} address - Address to update.\n     */\n    Spreadsheet.prototype.updateCell = function (cell, address) {\n        address = address || this.getActiveSheet().activeCell;\n        _super.prototype.updateCell.call(this, cell, address);\n        this.serviceLocator.getService('cell').refreshRange(getIndexesFromAddress(address));\n        this.notify(activeCellChanged, {});\n    };\n    /**\n     * Sorts the range of cells in the active sheet.\n     * @param sortOptions - options for sorting.\n     * @param range - address of the data range.\n     */\n    Spreadsheet.prototype.sort = function (sortOptions, range) {\n        var _this = this;\n        if (!this.allowSorting) {\n            return Promise.reject();\n        }\n        return _super.prototype.sort.call(this, sortOptions, range).then(function (args) {\n            _this.notify(sortComplete, args);\n            return Promise.resolve(args);\n        });\n    };\n    /** @hidden */\n    Spreadsheet.prototype.setValueRowCol = function (sheetIndex, value, rowIndex, colIndex) {\n        if (value === 'circular reference: ') {\n            var circularArgs = {\n                action: 'isCircularReference', argValue: value\n            };\n            this.notify(formulaOperation, circularArgs);\n            value = circularArgs.argValue;\n        }\n        _super.prototype.setValueRowCol.call(this, sheetIndex, value, rowIndex, colIndex);\n        sheetIndex = getSheetIndexFromId(this, sheetIndex);\n        this.notify(editOperation, {\n            action: 'refreshDependentCellValue', rowIdx: rowIndex, colIdx: colIndex,\n            sheetIdx: sheetIndex\n        });\n    };\n    /**\n     * Get component name.\n     * @returns string\n     * @hidden\n     */\n    Spreadsheet.prototype.getModuleName = function () {\n        return 'spreadsheet';\n    };\n    /** @hidden */\n    Spreadsheet.prototype.refreshNode = function (td, args) {\n        var value;\n        var spanElem = td.querySelector('.e-' + this.element.id + '_currency');\n        var alignClass = 'e-right-align';\n        if (args) {\n            args.result = isNullOrUndefined(args.result) ? '' : args.result.toString();\n            if (spanElem) {\n                detach(spanElem);\n            }\n            if (args.type === 'Accounting' && isNumber(args.value)) {\n                td.textContent = args.result.split(args.curSymbol).join('');\n                td.appendChild(this.createElement('span', {\n                    className: 'e-' + this.element.id + '_currency',\n                    innerHTML: \" \" + args.curSymbol,\n                    styles: 'float: left'\n                }));\n                td.classList.add(alignClass);\n                return;\n            }\n            else {\n                if (args.result && (args.result.toLowerCase() === 'true' || args.result.toLowerCase() === 'false')) {\n                    args.result = args.result.toUpperCase();\n                    alignClass = 'e-center-align';\n                    args.isRightAlign = true; // Re-use this to center align the cell.\n                }\n                value = args.result;\n            }\n            args.isRightAlign ? td.classList.add(alignClass) : td.classList.remove(alignClass);\n        }\n        value = !isNullOrUndefined(value) ? value : '';\n        if (!isNullOrUndefined(td)) {\n            var node = td.lastChild;\n            if (td.querySelector('.e-hyperlink')) {\n                node = td.querySelector('.e-hyperlink').lastChild;\n            }\n            if (node && (node.nodeType === 3 || node.nodeType === 1)) {\n                node.nodeValue = value;\n            }\n            else {\n                td.appendChild(document.createTextNode(value));\n            }\n        }\n    };\n    /** @hidden */\n    Spreadsheet.prototype.skipHiddenRows = function (startIdx, endIdx) {\n        var count = 0;\n        var sheet = this.getActiveSheet();\n        for (var i = startIdx; i <= endIdx; i++) {\n            if (isHiddenRow(sheet, i)) {\n                if (startIdx === i) {\n                    startIdx++;\n                }\n                endIdx++;\n            }\n        }\n        return [startIdx, endIdx];\n    };\n    /**\n     * To perform the undo operation in spreadsheet.\n     */\n    Spreadsheet.prototype.undo = function () {\n        this.notify(performUndoRedo, { isUndo: true, isPublic: true });\n    };\n    /**\n     * To perform the redo operation in spreadsheet.\n     */\n    Spreadsheet.prototype.redo = function () {\n        this.notify(performUndoRedo, { isUndo: false, isPublic: true });\n    };\n    /**\n     * To update the undo redo collection in spreadsheet.\n     * @param {object} args - options for undo redo.\n     */\n    Spreadsheet.prototype.updateUndoRedoCollection = function (args) {\n        this.notify(updateUndoRedoCollection, { args: args, isPublic: true });\n    };\n    /**\n     * Adds the defined name to the Spreadsheet.\n     * @param {DefineNameModel} definedName - Specifies the name.\n     * @return {boolean} - Return the added status of the defined name.\n     */\n    Spreadsheet.prototype.addDefinedName = function (definedName) {\n        return _super.prototype.addDefinedName.call(this, definedName);\n    };\n    /**\n     * Removes the defined name from the Spreadsheet.\n     * @param {string} definedName - Specifies the name.\n     * @param {string} scope - Specifies the scope of the defined name.\n     * @return {boolean} - Return the removed status of the defined name.\n     */\n    Spreadsheet.prototype.removeDefinedName = function (definedName, scope) {\n        return _super.prototype.removeDefinedName.call(this, definedName, scope);\n    };\n    Spreadsheet.prototype.mouseClickHandler = function (e) {\n        this.notify(click, e);\n    };\n    Spreadsheet.prototype.mouseDownHandler = function (e) {\n        this.notify(mouseDown, e);\n    };\n    Spreadsheet.prototype.keyUpHandler = function (e) {\n        this.notify(keyUp, e);\n    };\n    Spreadsheet.prototype.keyDownHandler = function (e) {\n        this.notify(keyDown, e);\n    };\n    /**\n     * Binding events to the element while component creation.\n     */\n    Spreadsheet.prototype.wireEvents = function () {\n        EventHandler.add(this.element, 'click', this.mouseClickHandler, this);\n        EventHandler.add(this.element, getStartEvent(), this.mouseDownHandler, this);\n        EventHandler.add(this.element, 'keyup', this.keyUpHandler, this);\n        EventHandler.add(this.element, 'keydown', this.keyDownHandler, this);\n        EventHandler.add(this.element, 'noderefresh', this.refreshNode, this);\n    };\n    /**\n     * Destroys the component (detaches/removes all event handlers, attributes, classes, and empties the component element).\n     */\n    Spreadsheet.prototype.destroy = function () {\n        this.unwireEvents();\n        this.notify(spreadsheetDestroyed, null);\n        _super.prototype.destroy.call(this);\n        this.element.innerHTML = '';\n        this.element.removeAttribute('tabindex');\n        this.element.removeAttribute('role');\n        this.element.style.removeProperty('height');\n        this.element.style.removeProperty('width');\n        this.element.style.removeProperty('min-height');\n        this.element.style.removeProperty('min-width');\n    };\n    /**\n     * Unbinding events from the element while component destroy.\n     */\n    Spreadsheet.prototype.unwireEvents = function () {\n        EventHandler.remove(this.element, 'click', this.mouseClickHandler);\n        EventHandler.remove(this.element, getStartEvent(), this.mouseDownHandler);\n        EventHandler.remove(this.element, 'keyup', this.keyUpHandler);\n        EventHandler.remove(this.element, 'keydown', this.keyDownHandler);\n        EventHandler.remove(this.element, 'noderefresh', this.refreshNode);\n    };\n    /**\n     * To add context menu items.\n     * @param {MenuItemModel[]} items - Items that needs to be added.\n     * @param {string} text - Item before / after that the element to be inserted.\n     * @param {boolean} insertAfter - Set `false` if the `items` need to be inserted before the `text`.\n     * By default, `items` are added after the `text`.\n     * @param {boolean} isUniqueId - Set `true` if the given `text` is a unique id.\n     */\n    Spreadsheet.prototype.addContextMenuItems = function (items, text, insertAfter, isUniqueId) {\n        if (insertAfter === void 0) { insertAfter = true; }\n        this.notify(addContextMenuItems, { items: items, text: text, insertAfter: insertAfter, isUniqueId: isUniqueId });\n    };\n    /**\n     * To remove existing context menu items.\n     * @param {string[]} items - Items that needs to be removed.\n     * @param {boolean} isUniqueId - Set `true` if the given `text` is a unique id.\n     */\n    Spreadsheet.prototype.removeContextMenuItems = function (items, isUniqueId) {\n        this.notify(removeContextMenuItems, { items: items, isUniqueId: isUniqueId });\n    };\n    /**\n     * To enable / disable context menu items.\n     * @param {string[]} items - Items that needs to be enabled / disabled.\n     * @param {boolean} enable - Set `true` / `false` to enable / disable the menu items.\n     * @param {boolean} isUniqueId - Set `true` if the given `text` is a unique id.\n     */\n    Spreadsheet.prototype.enableContextMenuItems = function (items, enable, isUniqueId) {\n        if (enable === void 0) { enable = true; }\n        this.notify(enableContextMenuItems, { items: items, enable: enable, isUniqueId: isUniqueId });\n    };\n    /**\n     * Selects the cell / range of cells with specified address.\n     * @param {string} address - Specifies the range address.\n     */\n    Spreadsheet.prototype.selectRange = function (address) {\n        this.notify(selectRange, getRangeIndexes(address));\n    };\n    /**\n     * Start edit the active cell.\n     * @return {void}\n     */\n    Spreadsheet.prototype.startEdit = function () {\n        this.notify(editOperation, { action: 'startEdit', isNewValueEdit: false });\n    };\n    /**\n     * Cancels the edited state, this will not update any value in the cell.\n     * @return {void}\n     */\n    Spreadsheet.prototype.closeEdit = function () {\n        this.notify(editOperation, { action: 'cancelEdit' });\n    };\n    /**\n     * If Spreadsheet is in editable state, you can save the cell by invoking endEdit.\n     * @return {void}\n     */\n    Spreadsheet.prototype.endEdit = function () {\n        this.notify(editOperation, { action: 'endEdit' });\n    };\n    /**\n     * Called internally if any of the property value changed.\n     * @param  {SpreadsheetModel} newProp\n     * @param  {SpreadsheetModel} oldProp\n     * @returns void\n     * @hidden\n     */\n    Spreadsheet.prototype.onPropertyChanged = function (newProp, oldProp) {\n        var _this = this;\n        _super.prototype.onPropertyChanged.call(this, newProp, oldProp);\n        for (var _i = 0, _a = Object.keys(newProp); _i < _a.length; _i++) {\n            var prop = _a[_i];\n            switch (prop) {\n                case 'enableRtl':\n                    newProp.enableRtl ? document.getElementById(this.element.id + '_sheet_panel').classList.add('e-rtl') :\n                        document.getElementById(this.element.id + '_sheet_panel').classList.remove('e-rtl');\n                    break;\n                case 'cssClass':\n                    if (oldProp.cssClass) {\n                        removeClass([this.element], oldProp.cssClass.split(' '));\n                    }\n                    if (newProp.cssClass) {\n                        addClass([this.element], newProp.cssClass.split(' '));\n                    }\n                    break;\n                case 'activeSheetTab':\n                    this.renderModule.refreshSheet();\n                    this.notify(activeSheetChanged, { idx: newProp.activeSheetTab - 1 });\n                    break;\n                case 'width':\n                    this.setWidth();\n                    this.resize();\n                    break;\n                case 'height':\n                    this.setHeight();\n                    this.resize();\n                    break;\n                case 'showRibbon':\n                    this.notify(ribbon, { uiUpdate: true });\n                    break;\n                case 'showFormulaBar':\n                    this.notify(formulaBar, { uiUpdate: true });\n                    break;\n                case 'showSheetTabs':\n                    this.notify(sheetTabs, null);\n                    break;\n                case 'cellStyle':\n                    this.renderModule.refreshSheet();\n                    break;\n                case 'sheets':\n                    Object.keys(newProp.sheets).forEach(function (sheetIdx) {\n                        if (_this.activeSheetTab - 1 === Number(sheetIdx)) {\n                            if (newProp.sheets[sheetIdx].showGridLines !== undefined) {\n                                _this.notify(updateToggleItem, { props: 'GridLines', pos: 2 });\n                            }\n                            if (newProp.sheets[sheetIdx].showHeaders !== undefined) {\n                                _this.sheetModule.showHideHeaders();\n                                _this.notify(updateToggleItem, { props: 'Headers', pos: 0 });\n                            }\n                        }\n                        if (newProp.sheets[sheetIdx].name !== undefined) {\n                            _this.notify(sheetNameUpdate, {\n                                items: _this.element.querySelector('.e-sheet-tabs-items').children[sheetIdx],\n                                value: newProp.sheets[sheetIdx].name,\n                                idx: sheetIdx\n                            });\n                        }\n                    });\n                    break;\n                case 'locale':\n                    this.refresh();\n                    break;\n            }\n        }\n    };\n    /**\n     * To provide the array of modules needed for component rendering.\n     * @return {ModuleDeclaration[]}\n     * @hidden\n     */\n    Spreadsheet.prototype.requiredModules = function () {\n        return getRequiredModules(this);\n    };\n    /**\n     * Appends the control within the given HTML Div element.\n     * @param {string | HTMLElement} selector - Target element where control needs to be appended.\n     */\n    Spreadsheet.prototype.appendTo = function (selector) {\n        _super.prototype.appendTo.call(this, selector);\n    };\n    /**\n     * Filters the range of cells in the sheet.\n     */\n    Spreadsheet.prototype.filter = function (filterOptions, range) {\n        if (!this.allowFiltering) {\n            return Promise.reject();\n        }\n        range = range || this.getActiveSheet().selectedRange;\n        return _super.prototype.filter.call(this, filterOptions, range);\n    };\n    /**\n     * Clears the filter changes of the sheet.\n     */\n    Spreadsheet.prototype.clearFilter = function (field) {\n        if (field) {\n            this.notify(clearFilter, { field: field });\n        }\n        else {\n            _super.prototype.clearFilter.call(this);\n        }\n    };\n    /**\n     * Applies the filter UI in the range of cells in the sheet.\n     */\n    Spreadsheet.prototype.applyFilter = function (predicates, range) {\n        this.notify(initiateFilterUI, { predicates: predicates, range: range });\n    };\n    var Spreadsheet_1;\n    __decorate([\n        Property('')\n    ], Spreadsheet.prototype, \"cssClass\", void 0);\n    __decorate([\n        Property(true)\n    ], Spreadsheet.prototype, \"allowScrolling\", void 0);\n    __decorate([\n        Property(true)\n    ], Spreadsheet.prototype, \"allowResizing\", void 0);\n    __decorate([\n        Property(true)\n    ], Spreadsheet.prototype, \"enableClipboard\", void 0);\n    __decorate([\n        Property(true)\n    ], Spreadsheet.prototype, \"enableContextMenu\", void 0);\n    __decorate([\n        Property(true)\n    ], Spreadsheet.prototype, \"enableKeyboardNavigation\", void 0);\n    __decorate([\n        Property(true)\n    ], Spreadsheet.prototype, \"enableKeyboardShortcut\", void 0);\n    __decorate([\n        Property(true)\n    ], Spreadsheet.prototype, \"allowUndoRedo\", void 0);\n    __decorate([\n        Complex({}, SelectionSettings)\n    ], Spreadsheet.prototype, \"selectionSettings\", void 0);\n    __decorate([\n        Complex({}, ScrollSettings)\n    ], Spreadsheet.prototype, \"scrollSettings\", void 0);\n    __decorate([\n        Event()\n    ], Spreadsheet.prototype, \"beforeCellRender\", void 0);\n    __decorate([\n        Event()\n    ], Spreadsheet.prototype, \"beforeSelect\", void 0);\n    __decorate([\n        Event()\n    ], Spreadsheet.prototype, \"select\", void 0);\n    __decorate([\n        Event()\n    ], Spreadsheet.prototype, \"contextMenuBeforeOpen\", void 0);\n    __decorate([\n        Event()\n    ], Spreadsheet.prototype, \"fileMenuBeforeOpen\", void 0);\n    __decorate([\n        Event()\n    ], Spreadsheet.prototype, \"contextMenuBeforeClose\", void 0);\n    __decorate([\n        Event()\n    ], Spreadsheet.prototype, \"fileMenuBeforeClose\", void 0);\n    __decorate([\n        Event()\n    ], Spreadsheet.prototype, \"contextMenuItemSelect\", void 0);\n    __decorate([\n        Event()\n    ], Spreadsheet.prototype, \"fileItemSelect\", void 0);\n    __decorate([\n        Event()\n    ], Spreadsheet.prototype, \"beforeDataBound\", void 0);\n    __decorate([\n        Event()\n    ], Spreadsheet.prototype, \"dataBound\", void 0);\n    __decorate([\n        Event()\n    ], Spreadsheet.prototype, \"cellEdit\", void 0);\n    __decorate([\n        Event()\n    ], Spreadsheet.prototype, \"cellEditing\", void 0);\n    __decorate([\n        Event()\n    ], Spreadsheet.prototype, \"cellSave\", void 0);\n    __decorate([\n        Event()\n    ], Spreadsheet.prototype, \"created\", void 0);\n    __decorate([\n        Event()\n    ], Spreadsheet.prototype, \"beforeSort\", void 0);\n    __decorate([\n        Event()\n    ], Spreadsheet.prototype, \"beforeHyperlinkCreate\", void 0);\n    __decorate([\n        Event()\n    ], Spreadsheet.prototype, \"afterHyperlinkCreate\", void 0);\n    __decorate([\n        Event()\n    ], Spreadsheet.prototype, \"beforeHyperlinkClick\", void 0);\n    __decorate([\n        Event()\n    ], Spreadsheet.prototype, \"afterHyperlinkClick\", void 0);\n    __decorate([\n        Event()\n    ], Spreadsheet.prototype, \"actionBegin\", void 0);\n    __decorate([\n        Event()\n    ], Spreadsheet.prototype, \"actionComplete\", void 0);\n    __decorate([\n        Event()\n    ], Spreadsheet.prototype, \"openComplete\", void 0);\n    __decorate([\n        Event()\n    ], Spreadsheet.prototype, \"sortComplete\", void 0);\n    Spreadsheet = Spreadsheet_1 = __decorate([\n        NotifyPropertyChanges\n    ], Spreadsheet);\n    return Spreadsheet;\n}(Workbook));\nexport { Spreadsheet };\n","import * as index from './index';\nindex.Spreadsheet.Inject(index.Clipboard, index.Edit, index.KeyboardNavigation, index.KeyboardShortcut, index.CollaborativeEditing, index.Selection, index.ContextMenu, index.FormulaBar, index.Ribbon, index.Save, index.Open, index.SheetTabs, index.DataBind, index.AllModule, index.BasicModule, index.CellFormat, index.NumberFormat, index.Formula);\nexport * from './index';\n"],"names":["getRangeIndexes","range","cellindexes","indexes","indexOf","split","forEach","address","getCellIndexes","push","parseInt","match","getColIndex","text","colIdx","i","reverse","join","length","charCodeAt","Math","pow","getCellAddress","sRow","sCol","getColumnHeaderText","getRangeAddress","isNullOrUndefined","colIndex","floor","String","fromCharCode","getIndexesFromAddress","getRangeFromAddress","getSwapRange","clonedRange","slice","swap","x","y","tmp","isSingleCell","executeTaskAsync","context","taskFn","callbackFn","data","preventCallback","WorkerHelper","toFraction","val","strVal","toString","top_1","bottom","replace","abs","getGcd","a","b","Number","intToDate","Date","getTime","dateToInt","isTime","startDate","diffDays","isDateTime","date","Object","prototype","call","isNaN","valueOf","isNumber","parseFloat","toDate","intl","defaultDateFormats","getDefaultDateObject","availabelDateTimeFormat","dateTimeFormats","availableFormats","dObj","dateObj","isCustom","type","toUpperCase","_i","_a","keys","dateFormats","key","parseDate","format","skeleton","_b","_c","_d","_e","timeFormats","getFormatFromType","code","getTypeFromFormat","isUndefined","value","getModules","modules","includeBasicFormulas","member","args","getValue","nameSpace","obj","splits","j","setValue","keyValues","start","fromObj","undefined","getAlphalabel","col","cols","n","aCharNo","chs","getWorkbookRequiredModules","allowSave","allowOpen","allowEditing","allowNumberFormatting","allowCellFormatting","allowSorting","allowHyperlink","allowFiltering","checkIsFormula","getCell","rowIndex","sheet","isInitRow","row","getRow","cells","rows","setCell","cell","isExtend","extend","getCellPosition","top","left","getRowsHeight","getColumnsWidth","skipDefaultValue","style","defaultKey","defaultProps","fontFamily","verticalAlign","textIndent","backgroundColor","color","textAlign","fontSize","fontWeight","fontStyle","textDecoration","changedProps","propName","setRow","isHiddenRow","index","hidden","getRowHeight","height","setRowHeight","startRow","endRow","getColumn","columns","getColumnWidth","width","customWidth","startCol","endCol","isHiddenCol","getData","columnWiseData","valueOnly","Promise","resolve","reject","Map","sheetIdx","getSheetIndex","getSheetNameFromAddress","getSheet","promise","notify","updateSheetFromDataSource","then","getValueFromFormat","set","getDisplayText","sheetIndex","isDate","checkDateFormat","getModel","model","idx","diff","prevIdx","splice","processIdx","isSheet","cnt","len","createSheet","id","getMaxSheetId","sheets","name","getSheetNameCount","setProperties","clearRange","sCIdx","eCIdx","sRIdx","eRIdx","formula","toLowerCase","getSheetIndexFromId","getSheetIndexByName","info","updateSelectedRange","selectedRange","getSelectedRange","sheetNameCount","max","initSheet","initRow","getSheetName","activeSheetTab","getRequiredModules","pushBasicModules","showRibbon","showFormulaBar","showSheetTabs","enableContextMenu","selectionSettings","mode","enableKeyboardNavigation","enableKeyboardShortcut","enableClipboard","allowResizing","allowUndoRedo","getUpdateUsingRaf","fn","requestAnimationFrame","removeAllChildren","parent","firstChild","removeChild","getColGroupWidth","getScrollBarWidth","scrollAreaWidth","htmlDivNode","document","createElement","result","cssText","body","appendChild","offsetWidth","clientWidth","getSiblingsHeight","element","classList","classes","getHeightFromDirection","direction","sibling","some","contains","offsetHeight","inView","isModify","scrollSettings","enableVirtualization","topIdx","viewport","topIndex","leftIdx","leftIndex","bottomIdx","rowCount","getThreshold","rightIdx","colCount","inView_1","locateElem","ele","isRtl","swapRange","cellPosition","attrs","setStyleAttribute","styles","setBaseStyleAttribute","getStartEvent","Browser","isPointer","getMoveEvent","getEndEvent","isTouchStart","e","pointerType","isTouchMove","isTouchEnd","getClientX","changedTouches","clientX","getClientY","clientY","setAriaOptions","target","options","setAttribute","config","destroyComponent","component","compObj","getComponent","destroy","setResize","isCol","curEle","curEleH","curEleC","preEle","preEleH","preEleC","nxtEle","nxtEleH","getActiveSheet","getElementsByClassName","getElementsByTagName","hdrRow","getRowHeaderContent","hdrClone","cloneNode","hdrFntSize","findMaxValue","getRowHeaderTable","contentRow","getMainContent","contentClone","cntFntSize","getContentTable","fntSize","add","lineHeight","removeProperty","remove","previousElementSibling","nextElementSibling","setWidthAndHeight","nxtIndex","getAttribute","getColHeaderTable","trgt","table","myTableDiv","className","myTable","myTr","tr","offsetWidthValue","getBoundingClientRect","offsetHeightValue","ceil","updateAction","spreadsheet","isCutRedo","eventArgs","action","sortArgs","sortOptions","cancel","initiateSort","serviceLocator","getService","refreshRange","cellEvtArgs","cellValue","updateCell","requestType","cellFormat","numberFormat","copiedInfo","isCut","cut","copiedRange","copy","paste","pastedRange","showGridLines","isShow","showHeaders","setColWidth","addSheetTab","isAction","count","sheetCount","previousIndex","removeSheetTab","clicked","task","defaultListener","taskData","this","workerTask","workerData","initWorker","terminate","worker","URL","revokeObjectURL","workerUrl","taskBlob","Blob","getFnCode","createObjectURL","Worker","onmessage","messageFromWorker","bind","onerror","onError","postMessage","apply","message","workerCode","workerFunction","isHaveFunction","getMessageFn","getCallbackMessageFn","workbookFormulaOperation","WorkbookNumberFormat","localeObj","getNumericObject","locale","decimalSep","decimal","groupSep","group","addEventListener","numberFormatting","getFormattedCell","fResult","activeCell","rightAlign","currencySymbol","getNumberDependable","dateEventArgs","updatedVal","processFormats","onLoad","isRightAlign","curSymbol","usedRange","setUsedRange","formattedText","Internationalization","autoDetectGeneralFormat","curCode","applyNumberFormat","currencyFormat","percentageFormat","accountingFormat","shortDateFormat","longDateFormat","timeFormat","fractionFormat","scientificFormat","res","trim","findSuffix","zeros","resultSuffix","suffixLen","substr","formatArr","formatNumber","currency","shortDate","formatDate","longDate","time","prefix","findDecimalPlaces","toExponential","fractionResult","suffix","eIndex","decIndex","substring","formattedBarText","beforeText","on","removeEventListener","isDestroyed","off","getModuleName","DataBind","updateSheetFromDataSourceHandler","dataSourceChangedHandler","flds","sCellIdx","remoteUrl","dataManager","rowIdx","sRowIdx","sColIdx","loadedInfo","_this","requestedRange","sRanges","deferred","Deferred","rangeSettings","this_1","k","sRange","eRange","startCell","dataSource","DataManager","url","isLocalData","showFieldAsHeader","isEndReached","initRangeInfo","getMaxCount","getLoadedInfo","unloadedRange","isNotLoaded","query","Query","clone","executeQuery","requiresCount","fldLen","field","item","getCellDataFromProp","checkDataForFormat","loadedRange","prop","queries","min","nos","oldSheet","oldProp","oldRange","rangeIdx","indexes_1","editOperation","click","keyUp","keyDown","cMenuBeforeOpen","autoFit","completeAction","WorkbookOpen","open","formData","FormData","file","isOpen","append","requestData","method","trigger","fetch","openUrl","response","ok","json","status","statusText","fetchSuccess","catch","error","fetchFailure","openError","workbookData","impData","JSON","parse","Workbook","updateModel","workbookModel","definedNames","SaveWorker","processSheet","Array","isArray","processSave","saveJSON","saveSettings","customParams","stringify","blob","__extends","extendStatics","d","setPrototypeOf","__proto__","p","hasOwnProperty","__","constructor","create","WorkbookSave","_super","isProcessCompleted","isFullPost","needBlobData","initiateSave","saveType","fileName","updateBasicSettings","processSheets","jsonStr","getStringifyObject","basicSettings","updateSheet","getSheetLength","save","initiateFullPostSave","updateSaveResult","blobData","ClientFileDownload","anchor","download","getFileNameWithExtension","href","formElem","inputElem","submit","detach","skipProp","properties","filename","fileExt","getFileExtension","lastIndexOf","CalculateCommon","ModuleLoader","loadedModules","inject","requiredModules","moduleList","reqLengthVal","clean","clearUnusedModule","modl","moduleList_1","module","modName","isModuleLoaded","moduleObject","createInstance","memberName","getMemberName","isProperty","loadedModule","classFunction","params","arrayParam","unshift","Function","moduleListName","usedModule","map","arg","removeModule_1","filter","moduleName","deleteObject","CommonErrors","FormulasErrorsStrings","BasicFormulas","formulas","formulaName","category","description","isConcat","init","addFormulaCollection","functionName","formulaCategory","libraryFormulas","fName","handler","ComputeSUM","arguments","formulaErrorStrings","invalid_arguments","orgValue","sum","argArr","argValue","isCellReference","cellCollection","getCellCollection","tic","getValueFromArg","getErrorStrings","trueValue","falseValue","ComputeCOUNT","wrong_number_arguments","argVal","cellColl","ComputeDATE","year","month","day","days","num","getSerialDateFromDate","fromOADate","getFullYear","calculateDate","getMonth","getDate","ComputeFLOOR","fnum","significance","argCount","splitArg","divzero","ComputeCEILING","cnum","ComputeDAY","serialNumber","dateVal","ComputeIF","condition","requires_3_args","ComputeIFERROR","arithMarker","ComputePRODUCT","parseVal","product","argsHit","rangevalue","ComputeDAYS","argsArr","endDate","toDateString","d1","d2","round","ComputeCHOOSE","cond","indexNum","ComputeSUMIF","improper_formula","computeSumIfAndAvgIf","ComputeABS","absValue","absVal","cellvalue","ComputeAVERAGE","calculateAvg","ComputeAVERAGEIF","argList","resultVal","ComputeCONCATENATE","argsList","tempStr","i_1","ComputeCONCAT","ComputeMAX","computeMinMax","ComputeMIN","ComputeRAND","random","ComputeAND","computeAndOr","ComputeOR","ComputeFIND","findText","removeTics","withinText","loc","startNum","ComputeINDEX","ref","rangeValue","rangeArr","i_2","cellRef","convertAlpha","ComputeIFS","na","ComputeCOUNTA","ComputeAVERAGEA","cellCol","parseValue","argArrs","ComputeCOUNTIF","stack","op","startsWith","findWildCardValue","processLogical","ComputeSUMIFS","computeIfsFormulas","ComputeCOUNTIFS","ComputeAVERAGEIFS","ComputeMATCH","lookupVal","matchType","indexVal","ComputeLOOKUP","computeLookup","ComputeVLOOKUP","computeVLookup","ComputeSUBTOTAL","ComputeRADIANS","radVal","PI","ComputeRANDBETWEEN","argsLength","Parser","emptyStr","storedStringText","sheetToken","tokenAdd","tokenSubtract","tokenMultiply","tokenDivide","tokenLess","charEm","charEp","tokenGreater","tokenEqual","tokenLessEq","tokenGreaterEq","tokenNotEqual","tokenAnd","tokenEm","tokenEp","tokenOr","charAnd","charLess","charGreater","charEqual","charLessEq","charGreaterEq","charNoEqual","stringGreaterEq","stringLessEq","stringNoEqual","stringAnd","stringOr","charOr","charAdd","charSubtract","charMultiply","charDivide","fixedReference","spaceString","ignoreBracet","isError","isFormulaParsed","findNamedRange","stringsColl","tokens","charNOTop","specialSym","isFailureTriggered","fkey","isTextEmpty","getFormulaCharacter","namedRanges","size","storedData","checkForNamedRangeAndKeyValue","formulaString","storeStrings","indexOfAny","family","getSheetFamilyItem","grid","sheetNameToParentObject","setTokensForSheets","getSheetToken","scopedRange","checkScopedRange","markLibraryFormulas","formulaAutoCorrection","ex","exception","isForceCalculable","formulaCorrection","computeForceCalculate","invalid_expression","get","formulaText","FormulaError","mismatched_parentheses","empty_expression","s","parseSimple","exceptionArgs","errorMessage","getErrorLine","setStrings","arithemeticArr","logicalSym","form","firstOp","secondprevOp","secondnextOp","firstDigit","secondDigit","countDigit","isDigit","rightBracket","has","leftBracket","isUpperChar","getParseArgumentSeparator","getSheetID","v","token","sheetNameToToken","s_1","parentObject","getNamedRanges","tempString","storedString","ticLoc","singleTicLoc","singleTic","mismatched_tics","expTokenArray","mulTokenArray","addTokenArray","mulCharArray","addCharArray","compareTokenArray","compareCharArray","expCharArray","andTokenArray","andCharArray","orCharArray","orTokenArray","parseSimpleOperators","markers","operators","c","right","rightIndex","findLeftMarker","cannot_parse","bracketCount","l","period","getParseDecimalSeparator","number_contains_2_decimal_points","updateDependentCell","expression_cannot_end_with_an_operator","uFound","findRightMarker","jTemp","inbracket","arithMarker2","isCharacter","checkLetter","oneTokenFound","textLen","isChar","ret","bracketLevel","parseFormula","fKey","bracCount","rightParens","markNamedRanges","parenCount","leftParens","libFormula","getFunction","swapInnerParens","addParensToArgs","fSubstr","rightSides","marker","lastIndexOfAny","oneTimeOnly","end","getTableRange","namerangeValue","findNextEndIndex","found","__decorate","decorators","desc","r","getOwnPropertyDescriptor","Reflect","decorate","defineProperty","Calculate","lFormulas","keyToRowsMap","rowsToKeyMap","emptyString","leftBrace","rightBrace","cellPrefix","treatEmptyStringAsZero","parseDecimalSeparator","dependentCells","dependentFormulaCells","minValue","MIN_SAFE_INTEGER","maxValue","MAX_SAFE_INTEGER","categoryCollection","dependencyLevel","refreshedCells","computedValues","randomValues","isRandomVal","randCollection","errorStrings","parseArgumentSeparator","dateTime1900","isParseDecimalSeparatorChanged","isArgumentSeparatorChanged","sheetFamilyID","defaultFamilyItem","sheetFamiliesList","modelToSheetID","tokenCount","sortedSheetNames","tempSheetPlaceHolder","formulaInfoTable","oaDate","millisecondsOfaDay","parseDateTimeSeparator","moduleLoader","Calculate_1","Inject","injectedModules","parser","formulaColl","enumerable","configurable","setParseArgumentSeparator","getParseDateTimeSeparator","setTreatEmptyStringAsZero","getTreatEmptyStringAsZero","setParseDateTimeSeparator","getInjectedModules","onPropertyChanged","newProp","charCode","resetKeys","clear","parentObjectToToken","getDependentCells","formulaCells","isSheetMember","sheetDependentCells","getDependentFormulaCells","sheetDependentFormulaCells","getLibraryFormulas","getFormulaInfoTable","sheetFormulaInfotable","getFormula","getFormulaText","setParseDecimalSeparator","temp","bad_index","grd","isLetter","startIndex","CalcSheetFamilyItem","setKeyValue","str","FormulaInfo","fInfo","s1","clearFormulaDependentCells","setFormulaText","getFormulaValue","setParsedFormula","setFormulaValue","dependentFormula","dependent","arrayRemove","delete","array","getKeyValue","fText","computeFormula","getParsedFormula","addNamedRange","sheetScopeName","removeNamedRange","arrCol","aCharValue","cellRange","sheetTokenIndex","row1","row2","col1","col2","parsedText","lastIndexOfq","formulatResult","fNested","nestedFormula","findLastIndexOfq","sFormula","processNestedFormula","q","computeValue","criteria","opt","checkCriteria","criteriaRangeArray","sumRange","criteriaRange","getComputeSumIfValue","checkCrte","findMaxVal","criterias","lookupRangeArray","lookupRange","maxVal","sort","minVal","lookupValue","firstCol","secCol","lookupCol","lookupCell","lookVal","finalText","checStr1","checStr2","newIndex","compRight","compLeft","leftVal","rightVal","value1","val1","ranges","tempdate","pFormula","textName","getParentObjectCellValue","stackValue","pop","errIndex","getValArithmetic","countValue","operator","num1","num2","val2","value2","localeCompare","computeStoreCells","sCell","cellRanges","argArray","isCriteria","storeCell","storedCells","isCountIfs","isCountIfS","countVal","rangeLength","tempStoredCell","cellVal","newCell","newCount","cellAlpha","newCellAlpha","isAvgIfs","storedCell","startRange","pText","doubleNumber","setTime","isValidMonth","tempDay","dateTime","toOADate","fString","pObjCVal","symbolArray","f","circular_reference","dateval","isValidCellReference","numArr","cellTxt","sheetToken1","containsBoth","isAlpha","isNum","charArray","sortedSheetNamesCollection","getSortedSheetNames","tokenToParentObject","saveCell","cValue","getParentCellValue","getValueRowCol","defineFunction","window","valueChanged","changeArgs","isCalculate","pgrid","isComputedValueChanged","isCompute","calcFamily","getRowIndex","randStrVal","setValueRowCol","getComputedValue","refresh","formulaValue","arr_1","errorStack","createSheetFamilyID","operation","countStrVal","sumCell","avgVal","countNum","registerGridAsSheet","refName","tempRef","unregisterGridAsSheet","refName1","dispose","refreshRandValues","tokenRef","stringCollection","dCell","formulaInfo","Property","Event","NotifyPropertyChanges","Base","calcID","MIN_VALUE","calcID1","parsedFormula","ValueChangedArgs","setRowIndex","setColIndex","WorkbookFormula","workbook","sheetInfo","initCalculate","registerSheet","initiateDefinedNames","calculateInstance","performFormulaOperation","aggregateComputation","from","values","formulaCollection","collection","selectCategory","selectedList","unRegisterSheet","autoCorrectFormula","refreshCalculate","isFormula","argumentSeparator","isAdded","addDefinedName","definedName","isRemoved","removeDefinedName","scope","renameUpdation","sheetId","visibleName","sheetName","length_1","sheetDeletion","refError","referenceError","getSheetInfo","delSheetName","rowId","colId","formulaVal","removeSheetTokenIndex","dependentCellRef","updateDataContainer","visible","savedTokens","isSheetRenamed","sheetNames","name_1","sheetData","rowData","colObj","parseSheetRef","name_2","cellArgs","referenceCollection","refValue","tempArgs","definedname","refersTo","comment","checkIsNameExist","getIndexFromNameColl","calcName","toFixed","Count","Sum","Avg","Min","Max","WorkbookSort","initiateSortHandler","sortDescriptors","containsHeader","workbookLocale","getConstant","header","jsonData","comparerFn","sortComparer","caseSensitive","sortBy","colName","sortDescriptor","order","comparer","DataUtil","fnSort","caseOptions","sensitivity","collator","Intl","Collator","compare","WorkbookFilter","filterRange","initiateFilterHandler","clearAllFilterHandler","filterOptions","datasource","setFilter","predicates","filterEventArgs","address_1","where","Predicate","and","result_1","executeLocal","showHideRow","WorkbookCellFormat","rng","triggerEvent","onActionUpdate","lastCell","isHeightCheckNeeded","manualUpdate","refreshRibbon","textDecorationActionUpdate","changedStyle","changedValue","activeCellIndexes","getCellStyleValue","removeProp","WorkbookEdit","performEditOperation","updateCellValue","isValueOnly","checkDecimalPoint","WorkbookHyperlink","setLinkHandler","cellIdx","hyperlink","cellAddr","WorkbookBasicModule","WorkbookAllModule","CellStyle","ChildProperty","DefineName","Hyperlink","localeData","SortOutOfRangeError","Cell","Complex","Row","Collection","Column","RangeSetting","UsedRange","Sheet","ServiceLocator","services","register","__assign","assign","t","Workbook_1","commonCellStyle","cellStyle","initWorkbookServices","dataBind","initEmptySheet","preRender","refreshing","L10n","render","getPersistData","addOnPersist","cssProps","cssProp","events.workbookFormulaOperation","removeSheet","merge","appendTo","selector","hide","update","errArgs","saveOptions","saveUrl","addHyperlink","cellAddress","events.initiateSort","filterArgs","clearFilter","Component","role","selected","multiselectable","busy","colcount","Clipboard","contenteditable","getClipboardEle","clearCopiedInfo","tabSwitchHandler","cMenuBeforeOpenHandler","ribbonClickHandler","initCopyIndicator","rowHeightChanged","EventHandler","parentId","focus","hidePaste","l10n","enableContextMenuItems","threshold","setCopiedInfo","isEdit","preventDefault","getElementById","rfshRange","isExternal","clipboardData","copiedIdx","getCopiedIdx","copyInfo","cSIdx","sIdx","curSheet","selIdx","getExternalCells","cIdx","isRepeative","concat","beginEventArgs","prevSheet","isFinite","showDialog","cSID","sId","copyRange","pasteSheetIdx","select","rIdx","getEmptyStyle","hRow","option","showSpinner","isIE","execCommand","hideSpinner","setExternalCells","copyIndicator","dialog","show","isModal","showCloseIcon","content","isEnable","regex","setData","html","innerHTML","querySelector","querySelectorAll","td","textContent","getStyle","children","child","setTimeout","char","charAt","Edit","editorElem","editCellData","isCellEdit","isNewValueEdit","keyCodes","BACKSPACE","SPACE","TAB","DELETE","ESC","ENTER","FIRSTALPHABET","LASTALPHABET","FIRSTNUMBER","LASTNUMBER","FIRSTNUMPAD","LASTNUMPAD","SYMBOLSETONESTART","SYMBOLSETONEEND","SYMBOLSETTWOSTART","SYMBOLSETTWOEND","FIREFOXEQUALPLUS","FIREFOXMINUS","F2","dblClickHandler","mouseDownHandler","keyUpHandler","keyDownHandler","renderEditor","refreshEditor","refreshFormulaBar","refreshEditorElem","isAppend","trigEvent","refreshCurPos","setCursorPosition","startEdit","endEdit","cancelEdit","editedValue","refreshDependentCellValue","position","trgtElem","keyCode","isWindows","hasFormulaSuggSelected","closest","isAlphabet","isNumeric","isNumpadKeys","isSymbolkeys","isFirefoxExceptionkeys","isF2Edit","shiftKey","ctrlKey","isBackSpace","altKey","editingHandler","editor","contentEditable","spellcheck","updateEditCellDetail","initiateEditor","positionEditor","enable","elem","selection","getSelection","createRange","setStart","collapse","removeAllRanges","addRange","suggDdlElem","visibility","addr","cellElem","fullAddr","oldValue","tdElem","minHeight","minWidth","editWidth","inlineStyles","enableRtl","updateEditedValue","tdRefresh","oldCellValue","cellIndex","getRefreshNodeArgs","refreshNode","fCode","resetEditState","focusElement","eventName","altEnter","textBefore","textAfter","offset","node","anchorNode","nodeType","anchorOffset","setEnd","elemRefresh","removeAttribute","Selection","mouseMoveEvt","mouseMoveHandler","virtualContentLoadedHandler","cellNavigateHandler","selectRange","colWidthChanged","getActiveCell","getSelectionElement","rowStart","rowEnd","colStart","colEnd","selectRangeByIdx","actRange","inRange","createSelectionElement","cont","getSheetElement","getRowIdxFromClientY","getColIdxFromClientX","activeIdx","isRowSelected","isColSelected","getColumnHeaderContent","which","isSelected","passive","mouseUpHandler","touchEvt","isMobileView","renderModule","setSheetPanelSize","getScrollContent","clientRect","isScrollDown","isScrollUp","isScrollRight","isScrollLeft","clearInterval","scrollInterval","setInterval","scrollTop","scrollLeft","highlightHdr","getScrollLeft","scrollModule","prevScroll","cliRect","isScrollRefresh","isActCellChanged","UpdateRowColSelected","updateActiveCell","topLeftIdx","topLeftCell","isRowRefresh","isColRefresh","rowHdr","colHdr","getHdrIndexes","selectAll","removeClass","addClass","parentElement","hiddenRowCount","hiddenRowsCount","Scroll","initProps","onContentScroll","scrollArgs","prevSize","initScrollValue","scrollRight","getColOffset","cur","prev","increase","preventScroll","updateTopLeftCell","updateNonVirtualCols","scrollDown","getRowOffset","updateNonVirtualRows","refreshUI","Infinity","wireEvents","onScroll","setPadding","allowScrolling","colHeader","rowHeader","scrollWidth","padding","border","marginBottom","VirtualScroll","scroll","createVirtualElement","container","colVTrack","rowVTrack","vTrack","initScroll","domCount","setScrollCount","startColIdx","translateX","translateY","transform","layout","activeSheetIdx","getAddress","getColAddress","updateScrollCount","usedRangeCount","onVerticalScroll","idxDiff","startIdx","lastIdx","prevTopIdx","skipHiddenRows","hiddenCount","checkHiddenCount","skippedHiddenIdx","checkHiddenIndex","bottomIndex","getThresholdHeight","checkLastIdx","endIdx","onHorizontalScroll","getThresholdWidth","translate","updateColumnWidth","updateUsedRange","getVTrackHeight","updateVTrack","createHeaderElement","updateVTrackHeight","updateVTrackWidth","hdrVTrack","cntVTrack","hdrColumn","cntColumn","sizeStr","deInitProps","updateScrollProps","sliceScrollProps","KeyboardNavigation","activeElement","isNavigate","isFilterCell","actIdxes","scrollNavigation","stopPropagation","isScroll","topLeftIdxes","getBottomIdx","getRightIdx","hgt","contWidth","KeyboardShortcut","isUndo","applyFilter","CellFormat","checkHeight","applyCellFormat","childElementCount","customHeight","updateRowHeight","clonedCell","prevHeight","getRowHeightOnInit","isLastCell","lastElementChild","test","Resize","isRow","rowHdrTable","endIndex","trgtEle","setAutofit","wireResizeCursorEvent","setTarget","unWireResizeCursorEvent","unwireEvents","sheetPanel","colResizeHandler","rowResizeHandler","isMouseMoved","event","offsetY","updateTarget","createResizeHandler","resizeOn","resizeHandler","updateCursor","colIndx","rowIndx","prevWdt","prevHgt","newTrgt","tOffsetV","eOffsetV","tClass","offsetX","firstElementChild","resEle","prevData","oldIdx","headerText","mainContent","headerTable","contentTable","headerRow","headerFit","contentFit","autofitValue","resizeStart","clientHeight","mIndex","eleWidth","colWidth","viewportIdx","eleHeight","rowHeight","actualIdx","skipAppend","rTbody","tBodies","tbody","display","insertBefore","insertIdx","oldHeight","sheet_1","isFit","oldWidth","CollaborativeEditing","refreshClients","ShowHide","getViewportIdx","hFrag","frag","rowRenderer","rTBody","tBody","newStartRow","createDocumentFragment","showHideCol","SpreadsheetHyperlink","initiateHyperlinkHandler","editHyperlinkHandler","removeHyperlinkHandler","openHyperlinkHandler","clickHandler","createHyperlinkElementHandler","insertBut","dialogInst_1","cssClass","beforeOpen","dialogInstance","hyperlinkContent","buttons","buttonModel","isPrimary","disabled","dlgClickHandler","dialogInst","spreadsheetInst","insertHyperlink","dlgContent","hyperEditContent","cellIndexes","hlOpenHandler","removeHyperlink","rangeAddr","befArgs","aftArgs","rangeIndexes","rangeAddr_1","goTo","ftrEle","dlgEle","docEle","webEle","webEleText","docEleText","actEle","hasAttribute","isEmpty","hyperEle","includes","innerText","isWeb","webContElem","isDefinedNamed","docContElem","listEle","treeCont","isDefinedName","isCellRef","cell_1","idx_1","dialogElem","Tab","selectedItem","items","textCont","urlCont","textH","urlH","textInput","urlInput","nodeId","nodeText","expanded","nodeChild","treeObj","TreeView","fields","cellrefCont","cellrefH","cellrefInput","textCont1","textH1","textInput1","sheetCont","sheetH","refCont","UndoRedo","undoCollection","redoCollection","undoRedoStep","setActionData","cutCellDetails","getCellDetails","beforeActionData","cellDetails","getBeforeActionData","beforeDetails","performUndoRedo","undoRedoArgs","performOperation","undoForClipboard","undoForResize","updateUndoRedoIcons","completeArgs","isPublic","updateUndoRedoCollection","actionList","beforeActionDetails","clearUndoRedoCollection","actionData","isRefresh","checkRefreshNeeded","updateCellDetails","RibbonItem","Header","Item","MenuItem","Ribbon","renderRibbon","Menu","expandCollapseElem","tabObj","ribbonExpandCollapse","toolbarObj","getTabItems","tabItems","initMenu","menuItems","menu","menuObj","showItemOnClick","parentItem","beforeClose","beforeItemRender","tabElement","tBarElement","Toolbar","animation","next","duration","previous","selecting","selectingIndex","created","collapseBtn","refreshOverflow","activeTab","enableItems","disable","ColorPicker","input","fontColorPicker","ColorPickerComponent","showButtons","presetColors","fontColor","enableOpacity","beforeCloseHandler","openHandler","beforeModeSwitch","change","currentValue","rgba","previousValue","updateSelectedColor","wireFocusEvent","filColorPicker","fillColor","borderBottomColor","title","inst","modeSwitcher","destroyColorPicker","fontNameIndex","numPopupWidth","initRibbon","ribbon","createMobileView","createRibbon","getRibbonItems","iconCss","prefixIcon","tooltipText","template","getPasteBtn","getNumFormatDDB","getFontNameDDB","getFontSizeDDB","getBtn","getTextAlignDDB","getVerticalAlignDDB","getHyperlinkDlg","getLocaleText","find","getSortFilterDDB","btn","pasteSplitBtn","SplitButton","close","setClass","ribbonElement","RibbonComponent","fileItemSelect","fileMenuBeforeOpen","fileMenuBeforeClose","toolbarClicked","ribbonCreated","tabSelecting","expandCollapse","expandCollapseHandler","beforeFileItemRender","beforeRenderHandler","uiUpdate","refEle","refreshRibbonContent","numFormatBtn","numFormatDDB","DropDownButton","getNumFormatDdbItems","numDDBSelect","numDDBOpen","previewNumFormat","tBarDdbBeforeOpen","fontSizeDdb","refreshSelected","fontNameBtn","fontNameDdb","getFontFamilyItems","refreshFontNameSelection","btnObj","Button","isToggle","toggleBtnClicked","textAlignDdb","alignItemRender","verticalAlignDdb","sortingDdb","separator","isFiltered","isClearAll","enableRibbonItems","defaultModel","activeModel","property","refreshToggleBtn","itemKey","setPanelSize","enableToolbar","actionArgs","refreshNumFormatSelection","viewportHeight","getComputedStyle","paddingTop","overflowY","elemList","popWidth","numElem","previewElem","refreshFirstTabContent","refreshFourthTabContent","actCell","fontProps","selectArgs","refreshSheet","evtHArgs","showHideHeaders","toggleRibbonItems","props","pos","evtglArgs","updateToggleText","itemPos","updateShowHideBtn","showHideText","toobar","align","renderMobileToolbar","toolbarPanel","toolbar","ddb","ddbObj","calculatePosition","wrapper","contents","li","parentElem","ribbonEle","FormulaBar","createFormulaBar","insertFnRipple","fBarWrapper","nameBox","comboBoxInstance","ComboBox","noRecordsTemplate","nameBoxBeforeOpen","blur","nameBoxBlur","nameBoxSelect","rippleEffect","textarea","placeholder","textAreaFocusIn","textAreaFocusOut","formulaPanel","tickBtn","eventArg","UpdateValueAfterMouseUp","isInteracted","itemData","formulaBarUpdateHandler","indexes1","indexes2","intDate","updateComboBoxValue","toggleFormulaBar","names","offsetParent","isFormulaEdit","formulaDescription","categoryContent","dropDownElement","listViewElement","descriptionContent","headerContent","categoryArgs","categoryList","DropDownList","popupHeight","dropDownSelect","listArgs","formulaList","ListView","actionComplete","updateFormulaList","listSelected","outerHTML","dialogOpen","dialogBeforeClose","dialogClose","selectFormula","formulaClickHandler","focusOkButton","dialogContentEle","parentNode","storeActiveElement","formulaBarObj","getSelectedItems","updateFormulaDescription","activeListFormula","firstElement","selectItem","descriptionArea","selectedFormula","descriptionArgs","editOperationHandler","getFormulaBar","Formula","isFormulaBar","isPopupOpened","isPreventClose","isSubFormula","UP","DOWN","LEFT","RIGHT","autocompleteInstance","renderAutoComplete","getNames","getNameFromRange","acElem","autoCompleteOptions","popupWidth","filterType","sortOrder","onSuggestionOpen","onSuggestionClose","onSelect","onSuggestionComplete","AutoComplete","getPopupPosition","popup","refreshPosition","maxHeight","triggerKeyDownEvent","updatedFormulaValue","editValue","getEditingValue","parseIndex","getArgumentSeparator","hidePopUp","getSuggestionKeyFromFormula","refreshFormulaSuggestion","autoCompleteElem","isSuggestionAlreadyOpened","isNavigationKey","dispatchEvent","suggPopupElem","hidePopup","suggestValue","bracketIndex","fSplit","isAlphaNumeric","singleRange","SheetTabs","aggregateContent","createSheetTabs","tabInstance","panel","addBtn","addBtnRipple","getSheetTabItems","dropDownInstance","ddbItems","updateSheetTab","beforeOpenHandler","sheetTab","overflowMode","scrollStep","selectedIndex","updateDropDownItems","tBarItems","renameSheetTab","spaceKeyDown","curIdx","instance","positionX","isCollide","refreshSheetTab","addTab","switchSheetTab","required","maxlength","renameInputFocusOut","updateWidth","setSelectionRange","spaceLen","removeRenameInput","RegExp","showRenameDialog","updateSheetName","textEle","sheetItems","focusRenameInput","sheetIndex_1","eventArgs_1","forceDelete","destroySheet","sheetArgs","removeTab","showAggregate","aggregateDropDown","updateAggregateContent","aggregateEle","getAggregateItems","removeAggregate","Open","renderFileUpload","openSuccess","openFailed","uploadID","accept","uploadBox","onchange","fileSelect","filesData","files","impArgs","Save","saveCompleted","ContextMenu","initContextMenu","ul","contextMenuInstance","ContextMenuComponent","selectHandler","getTarget","getDataSource","setClipboardData","setFilterItems","setSortItems","setHyperLink","clearFilterText","setHideShowItems","addItemsHandler","removeItemsHandler","enableItemsHandler","insertAfter","isUniqueId","removeItems","NumberFormat","refreshCellElement","Sort","applySortHandler","sortCompleteHandler","initiateCustomSortHandler","isValidSortRange","sortRangeAlertHandler","customSortContent","list","clearError","errorElem","validateError","headercheck","headerCheckbox","caseCheckbox","hasHeader","checked","dropDown","hasError","Set","duplicateField","errorField","count_1","dropDownList","getFields","listId","getUniqueID","listviewObj","getCustomListview","setHeaderTab","contentElem","listview","renderListItem","hasFilter","fieldName","headerTabElement","addButton","footer","addItem","checkHeaderObj","CheckBox","label","fieldsMap","dropDownListObj","checkCaseObj","enableRipple","deleteHandler","removeItem","lvObj","orderRadio","isAscending","toLocaleLowerCase","radiobutton","RadioButton","setRadioBtnValue","radio","radiobutton2","radio2","beforeArgs","Filter","filterCollection","filterClassList","filterRangeAlertHandler","initiateFilterUIHandler","filterMouseDownHandler","renderFilterCellHandler","beforeFltrcMenuOpen","beforeFilterMenuOpenHandler","beforeCustomFilterOpen","beforeCustomFilterOpenHandler","reapplyFilterHandler","filterByCellValueHandler","clearFilterHandler","getFilteredColumnHandler","filterCboxValue","filterCboxValueHandler","getFilterRangeHandler","filterCellKeyDownHandler","isInValidFilterRange","addMenuItem","removeFilter","processRange","filterSuccessHandler","predicate","refreshFilterRange","isFilterRange","getColumnType","matchCase","filterBtnObj","filterButton","hasChildNodes","headerCell","closeDialog","filterPopup","excelFilter","openDialog","selectSortItemHandler","xPos","yPos","parentsUntil","filterCell","displayName","checkBoxData","hideSearchbox","filteredColumns","column","X","Y","ExcelFilterBase","getLocalizedCustomOperators","sameIndex","filterIndex","getPredicates","predicateList","excelPredicate","CheckBoxFilterBase","getPredicate","numOptr","stringOperator","numberOperator","dateOperator","datetimeOperator","booleanOperator","BasicModule","Spreadsheet","AllModule","ScrollSettings","SelectionSettings","Custom","defaultLocale","Cut","Copy","Paste","PasteSpecial","Link","EditHyperlink","OpenHyperlink","RemoveHyperlink","InsertLink","EditLink","All","Values","Formats","Bold","Font","FontSize","Italic","Underline","Strikethrough","TextColor","FillColor","HorizontalAlignment","AlignLeft","AlignCenter","AlignRight","VerticalAlignment","AlignTop","AlignMiddle","AlignBottom","InsertFunction","Insert","Delete","Rename","Hide","Unhide","NameBox","ShowHeaders","HideHeaders","ShowGridLines","HideGridLines","AddSheet","ListAllSheets","FullScreen","CollapseToolbar","ExpandToolbar","CollapseFormulaBar","ExpandFormulaBar","File","Home","Formulas","View","New","SaveAs","Update","ExcelXlsx","ExcelXls","CSV","SortAscending","SortDescending","CustomSort","AddColumn","ContainsHeader","CaseSensitive","SortBy","ThenBy","SelectAColumn","SortEmptyFieldError","SortDuplicateFieldError","SortAndFilter","ClearAllFilter","ClearFilterFrom","ReapplyFilter","FilterCellValue","FilterOutOfRangeError","HideRow","HideRows","UnHideRows","HideColumn","HideColumns","UnHideColumns","Ok","Close","Cancel","Apply","MoreColors","StandardColors","General","Currency","Accounting","ShortDate","LongDate","Time","Percentage","Fraction","Scientific","Text","MobileFormulaBarPlaceHolder","PasteAlert","DestroyAlert","SheetRenameInvalidAlert","SheetRenameEmptyAlert","SheetRenameAlreadyExistsAlert","DeleteSheetAlert","DeleteSingleLastSheetAlert","PickACategory","Description","UnsupportedFile","InvalidUrl","SUM","SUMIF","SUMIFS","ABS","RAND","RANDBETWEEN","FLOOR","CEILING","PRODUCT","AVERAGE","AVERAGEIF","AVERAGEIFS","AVERAGEA","COUNT","COUNTIF","COUNTIFS","COUNTA","MIN","MAX","DATE","DAY","DAYS","IF","IFS","CalculateAND","CalculateOR","IFERROR","CHOOSE","INDEX","FIND","CONCATENATE","CONCAT","SUBTOTAL","RADIANS","MATCH","DefineNameExists","CircularReference","ShowRowsWhere","OR","AND","CustomFilterDatePlaceHolder","CustomFilterPlaceHolder","CustomFilter","Between","MatchCase","DateTimeFilter","Undo","Redo","DateFilter","TextFilter","NumberFilter","ClearFilter","NoResult","FilterFalse","FilterTrue","Blanks","SelectAll","GreaterThanOrEqual","GreaterThan","LessThanOrEqual","LessThan","NotEqual","Equal","Contains","EndsWith","StartsWith","ClearButton","FilterButton","CancelButton","OKButton","Search","SheetRender","freezePane","colGroupWidth","cellRenderer","refreshSelectALLContent","tHead","getSelectAllTable","headerPanel","updateLeftColGroup","getRowHeaderPanel","detachColGroup","colGrp","colGrpWidth","getSelectAllContent","getColHeaderPanel","getContentPanel","renderPanel","contentPanel","initHeaderPanel","updateHideHeaders","overflow","createTable","createHeaderTable","updateTable","rowHdrEle","tagName","renderTable","rHdrTBody","cHdrTHead","cHdrRow","cTBody","attributes","aria-rowcount","aria-colcount","updateCol","renderColHeader","renderRowHeader","refreshColumnContent","refreshRowContent","hTBody","formatUnit","updateColContent","refChild","hRefChild","colRefChild","updateRowContent","rFrag","cKey","appendFn","renderHeaders","rowIndexes","colIndexes","cFrag","cTHead","cRow","RowRenderer","isRowHeader","skipHidden","aria-rowindex","CellRenderer","th","aria-colindex","tabindex","formatArgs","removeStyle","cRange","Render","renderSheet","checkTopLeftCell","sheetModule","lastRowIdx","lastColIdx","lastCellIdx","roundValue","roundedValue","instantiateRenderer","Dialog","dialogModel","btnContent","closeHandler","div","DialogComponent","ActionEvents","initializeActionBegin","beforeCellFormat","actionEventHandler","evtArgs","evtFunc","actionType","eventType","beforeSave","beforeSort","initializeActionComplete","sortComplete","cellSave","actionBeginHandler","actionCompleteHandler","needsID","Spreadsheet_1","initServices","renderSpreadsheet","setHeight","setWidth","createSpinner","cVTrack","rVTrack","vWidth","vHeight","scrollableSize","resize","colThreshold","cellMod","eleRowIdx","eleColIdx","displayText","isMethod","addrRange","mCell","isDevice","circularArgs","spanElem","alignClass","lastChild","createTextNode","nodeValue","undo","redo","mouseClickHandler","addContextMenuItems","removeContextMenuItems","closeEdit","index.Spreadsheet","index.Clipboard","index.Edit","index.KeyboardNavigation","index.KeyboardShortcut","index.CollaborativeEditing","index.Selection","index.ContextMenu","index.FormulaBar","index.Ribbon","index.Save","index.Open","index.SheetTabs","index.DataBind","index.AllModule","index.BasicModule","index.CellFormat","index.NumberFormat","index.Formula"],"mappings":"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EJ,OA3EAna,KACIwZ,gBAAeI,KAChBvzB,EAASnhB,UAAW,aAAU,IACjC86B,IACI8P,WAAS,IACVzpB,EAASnhB,UAAW,qBAAkB,IACzC86B,IACI8P,WAAS,SACVzpB,EAASnhB,UAAW,aAAU,IACjC86B,IACI8P,WAAS,SACVzpB,EAASnhB,UAAW,YAAS,IAChC86B,IACI8P,YAAS,IACVzpB,EAASnhB,UAAW,iBAAc,IACrC86B,IACI8P,YAAS,IACVzpB,EAASnhB,UAAW,qBAAkB,IACzC86B,IACI8P,YAAS,IACVzpB,EAASnhB,UAAW,oBAAiB,IACxC86B,IACI8P,YAAS,IACVzpB,EAASnhB,UAAW,mBAAgB,IACvC86B,IACI8P,YAAS,IACVzpB,EAASnhB,UAAW,gBAAa,IACpC86B,IACI8P,YAAS,IACVzpB,EAASnhB,UAAW,gBAAa,IACpC86B,IACI8P,YAAS,IACVzpB,EAASnhB,UAAW,mBAAgB,IACvC86B,IACI8P,YAAS,IACVzpB,EAASnhB,UAAW,qBAAkB,IACzC86B,IACI8P,YAAS,IACVzpB,EAASnhB,UAAW,4BAAyB,IAChD86B,IACI8P,YAAS,IACVzpB,EAASnhB,UAAW,0BAAuB,IAC9C86B,IACI8P,YAAS,IACVzpB,EAASnhB,UAAW,qBAAkB,IACzC86B,IACIsZ,aAAYP,KACb1yB,EAASnhB,UAAW,gBAAa,IACpC86B,IACI8P,WAAS,KACVzpB,EAASnhB,UAAW,cAAW,IAClC86B,IACI8P,WAAS,KACVzpB,EAASnhB,UAAW,cAAW,IAClC86B,IACIwZ,gBAAeP,KAChB5yB,EAASnhB,UAAW,mBAAgB,IACvC86B,IACI+P,WACD1pB,EAASnhB,UAAW,iBAAc,IACrC86B,IACI+P,WACD1pB,EAASnhB,UAAW,kBAAe,IACtC86B,IACI+P,WACD1pB,EAASnhB,UAAW,iBAAc,IACrC86B,IACI+P,WACD1pB,EAASnhB,UAAW,mBAAgB,IACvC86B,IACI+P,WACD1pB,EAASnhB,UAAW,uBAAoB,IAC3CmhB,EAAW8zB,EAAana,IACpBgQ,yBACD3pB,IAEL21B,arBleE1q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"}