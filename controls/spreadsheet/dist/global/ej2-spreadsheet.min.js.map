{"version":3,"file":"ej2-spreadsheet.min.js","sources":["../../src/workbook/common/address.js","../../src/workbook/common/worker.js","../../src/workbook/common/math.js","../../src/workbook/integrations/number-format.js","../../src/calculate/common/common.js","../../src/calculate/common/module.js","../../src/calculate/common/module-loader.js","../../src/calculate/base/calculate.js","../../src/workbook/common/module.js","../../src/workbook/common/util.js","../../src/workbook/base/cell.js","../../src/workbook/base/data.js","../../src/workbook/base/sheet.js","../../src/workbook/base/row.js","../../src/workbook/base/column.js","../../src/spreadsheet/common/module.js","../../src/spreadsheet/common/util.js","../../src/workbook/common/event.js","../../src/workbook/integrations/data-bind.js","../../src/spreadsheet/common/event.js","../../src/workbook/integrations/open.js","../../src/workbook/workers/save-worker.js","../../src/workbook/integrations/save.js","../../src/calculate/common/enum.js","../../src/calculate/formulas/basic.js","../../src/calculate/base/parser.js","../../src/workbook/integrations/formula.js","../../src/workbook/integrations/sort.js","../../src/workbook/integrations/filter.js","../../src/workbook/integrations/image.js","../../src/workbook/integrations/chart.js","../../src/workbook/actions/cell-format.js","../../src/workbook/actions/edit.js","../../src/workbook/actions/hyperlink.js","../../src/workbook/actions/insert.js","../../src/workbook/actions/delete.js","../../src/workbook/actions/data-validation.js","../../src/workbook/actions/find-and-replace.js","../../src/workbook/actions/protect-sheet.js","../../src/workbook/actions/merge.js","../../src/workbook/actions/conditional-formatting.js","../../src/workbook/common/basic-module.js","../../src/workbook/common/all-module.js","../../src/workbook/common/class.js","../../src/workbook/common/constant.js","../../src/workbook/services/service-locator.js","../../src/workbook/base/workbook.js","../../src/spreadsheet/actions/clipboard.js","../../src/spreadsheet/actions/edit.js","../../src/spreadsheet/actions/selection.js","../../src/spreadsheet/actions/scroll.js","../../src/spreadsheet/actions/virtual-scroll.js","../../src/spreadsheet/actions/keyboard-navigation.js","../../src/spreadsheet/actions/keyboard-shortcut.js","../../src/spreadsheet/actions/cell-format.js","../../src/spreadsheet/actions/resize.js","../../src/spreadsheet/actions/collaborative-editing.js","../../src/spreadsheet/actions/show-hide.js","../../src/spreadsheet/actions/hyperlink.js","../../src/spreadsheet/actions/undo-redo.js","../../src/spreadsheet/actions/wrap.js","../../src/spreadsheet/actions/insert.js","../../src/spreadsheet/actions/delete.js","../../src/spreadsheet/actions/data-validation.js","../../src/spreadsheet/actions/protect-sheet.js","../../src/spreadsheet/actions/find-and-replace.js","../../src/spreadsheet/actions/merge.js","../../src/spreadsheet/actions/conditional-formatting.js","../../src/ribbon/ribbon.js","../../src/spreadsheet/integrations/color-picker.js","../../src/spreadsheet/integrations/ribbon.js","../../src/spreadsheet/integrations/formula-bar.js","../../src/spreadsheet/integrations/formula.js","../../src/spreadsheet/integrations/sheet-tabs.js","../../src/spreadsheet/integrations/open.js","../../src/spreadsheet/integrations/save.js","../../src/spreadsheet/integrations/context-menu.js","../../src/spreadsheet/integrations/number-format.js","../../src/spreadsheet/integrations/sort.js","../../src/spreadsheet/integrations/filter.js","../../src/spreadsheet/integrations/image.js","../../src/spreadsheet/integrations/chart.js","../../src/spreadsheet/common/basic-module.js","../../src/spreadsheet/common/all-module.js","../../src/spreadsheet/common/class.js","../../src/spreadsheet/common/constant.js","../../src/spreadsheet/renderer/sheet.js","../../src/spreadsheet/renderer/row.js","../../src/spreadsheet/renderer/cell.js","../../src/spreadsheet/renderer/render.js","../../src/spreadsheet/services/dialog.js","../../src/spreadsheet/services/action-events.js","../../src/spreadsheet/services/overlay.js","../../src/spreadsheet/base/spreadsheet.js","../../src/global.js"],"sourcesContent":["import { isNullOrUndefined } from '@syncfusion/ej2-base';\nimport { getSheetIndex, getSheetNameFromAddress } from '../base/index';\n/**\n * To get range indexes.\n */\nexport function getRangeIndexes(range) {\n    var cellindexes;\n    var indexes = [];\n    range = range.indexOf('!') > -1 ? range.split('!')[1] : range;\n    range = range.indexOf(':') === -1 ? range + ':' + range : range;\n    range.split(':').forEach(function (address) {\n        cellindexes = getCellIndexes(address);\n        indexes.push(cellindexes[0]);\n        indexes.push(cellindexes[1]);\n    });\n    return indexes;\n}\n/**\n * To get single cell indexes\n */\nexport function getCellIndexes(address) {\n    return [parseInt(address.match(/\\d+/)[0], 10) - 1, getColIndex(address.match(/[A-Z]+/i)[0].toUpperCase())];\n}\n/**\n * To get column index from text.\n * @hidden\n */\nexport function getColIndex(text) {\n    var colIdx = 0;\n    text = text.split('').reverse().join('');\n    for (var i = text.length - 1; i >= 0; i--) {\n        colIdx += (text[i].charCodeAt(0) - 64) * (Math.pow(26, i));\n    }\n    return colIdx - 1;\n}\n/**\n * To get cell address from given row and column index.\n */\nexport function getCellAddress(sRow, sCol) {\n    return getColumnHeaderText(sCol + 1) + (sRow + 1);\n}\n/**\n * To get range address from given range indexes.\n */\nexport function getRangeAddress(range) {\n    return getCellAddress(range[0], range[1]) + ':' + (!isNullOrUndefined(range[2]) ?\n        getCellAddress(range[2], range[3]) : getCellAddress(range[0], range[1]));\n}\n/**\n * To get column header cell text\n */\nexport function getColumnHeaderText(colIndex) {\n    var alphabet = 'Z';\n    if (colIndex / 26 > 1) {\n        return getColumnHeaderText((colIndex % 26 === 0) ? (colIndex / 26 - 1) : Math.floor(colIndex / 26))\n            + String.fromCharCode((colIndex % 26) === 0 ? alphabet.charCodeAt(0) : 64 + (colIndex % 26));\n    }\n    else {\n        return String.fromCharCode(64 + (colIndex));\n    }\n}\n/**\n * @hidden\n */\nexport function getIndexesFromAddress(address) {\n    return getRangeIndexes(getRangeFromAddress(address));\n}\n/**\n * @hidden\n */\nexport function getRangeFromAddress(address) {\n    return address.split('!')[1] || address;\n}\n/**\n * Get complete address for selected range\n * @hidden\n */\nexport function getAddressFromSelectedRange(sheet) {\n    return sheet.name + '!' + sheet.selectedRange;\n}\n/**\n * @hidden\n */\nexport function getAddressInfo(context, address) {\n    var sIdx;\n    if (address.indexOf('!') > -1) {\n        sIdx = getSheetIndex(context, getSheetNameFromAddress(address));\n    }\n    else {\n        sIdx = context.activeSheetIndex;\n    }\n    return { sheetIndex: sIdx, indices: getIndexesFromAddress(address) };\n}\n/**\n * Given range will be swapped/arranged in increasing order.\n * @hidden\n */\nexport function getSwapRange(range) {\n    var clonedRange = range.slice();\n    if (range[0] > range[2]) {\n        swap(clonedRange, 0, 2);\n    }\n    if (range[1] > range[3]) {\n        swap(clonedRange, 1, 3);\n    }\n    return clonedRange;\n}\n/**\n * Interchange values in an array\n */\nfunction swap(range, x, y) {\n    var tmp = range[x];\n    range[x] = range[y];\n    range[y] = tmp;\n}\n/**\n * @hidden\n */\nexport function isSingleCell(range) {\n    return range[0] === range[2] && range[1] === range[3];\n}\n","/**\n * Worker task.\n */\nexport function executeTaskAsync(context, taskFn, callbackFn, data, preventCallback) {\n    return new WorkerHelper(context, taskFn, callbackFn, data, preventCallback);\n}\n/**\n * @hidden\n * The `WorkerHelper` module is used to perform multiple actions using Web Worker asynchronously.\n */\nvar WorkerHelper = /** @class */ (function () {\n    /**\n     * Constructor for WorkerHelper module in Workbook library.\n     * @private\n     */\n    function WorkerHelper(context, task, defaultListener, taskData, preventCallback) {\n        this.preventCallback = false;\n        this.context = context;\n        this.workerTask = task;\n        this.defaultListener = defaultListener;\n        this.workerData = taskData;\n        if (preventCallback) {\n            this.preventCallback = true;\n        }\n        this.initWorker();\n    }\n    /**\n     * To terminate the worker task.\n     * @private\n     */\n    WorkerHelper.prototype.terminate = function () {\n        this.worker.terminate();\n        URL.revokeObjectURL(this.workerUrl);\n    };\n    /**\n     * To initiate the worker.\n     * @private\n     */\n    WorkerHelper.prototype.initWorker = function () {\n        var taskBlob = new Blob([this.getFnCode()], { type: 'text/javascript' });\n        this.workerUrl = URL.createObjectURL(taskBlob);\n        this.worker = new Worker(this.workerUrl);\n        this.worker.onmessage = this.messageFromWorker.bind(this);\n        this.worker.onerror = this.onError.bind(this);\n        this.worker.postMessage(this.workerData);\n    };\n    /**\n     * Method for getting response from worker.\n     * @private\n     */\n    WorkerHelper.prototype.messageFromWorker = function (args) {\n        this.terminate();\n        this.defaultListener.apply(this.context, [args.data]);\n    };\n    /**\n     * Method for getting error message from worker if failed.\n     * @private\n     */\n    WorkerHelper.prototype.onError = function (args) {\n        this.terminate();\n        throw args.message || args;\n    };\n    /**\n     * Construct function code for worker.\n     * @private\n     */\n    WorkerHelper.prototype.getFnCode = function () {\n        var workerCode = '';\n        var i;\n        var keys;\n        var workerFunction = '';\n        var isHaveFunction = false;\n        if (typeof this.workerTask === 'function') {\n            if (this.workerTask.toString().indexOf('function') < 0) {\n                workerFunction = 'function ' + this.workerTask.toString();\n            }\n            else {\n                workerFunction = this.workerTask.toString();\n                isHaveFunction = true;\n            }\n            workerCode += ('self.workerTask = ' + workerFunction + '; \\n');\n        }\n        else {\n            if (typeof this.workerTask === 'object') {\n                keys = Object.keys(this.workerTask);\n                for (i = 0; i < keys.length; i++) {\n                    if (this.workerTask[keys[i]].toString().indexOf('function') < 0) {\n                        workerFunction = 'function ' + this.workerTask[keys[i]].toString();\n                    }\n                    else {\n                        workerFunction = this.workerTask[keys[i]].toString();\n                        isHaveFunction = true;\n                    }\n                    workerCode += ((i === 0 ? 'self.workerTask' : keys[i]) + '= ' + workerFunction + '; \\n');\n                }\n            }\n        }\n        workerCode += 'self.onmessage = ' + (isHaveFunction ? '' : ' function ') +\n            (this.preventCallback ? this.getMessageFn.toString() : this.getCallbackMessageFn.toString()) + '; \\n';\n        return workerCode;\n    };\n    /**\n     * Get default worker task with callback.\n     * @private\n     */\n    WorkerHelper.prototype.getCallbackMessageFn = function (args) {\n        postMessage(this.workerTask.apply(this, args.data));\n    };\n    /**\n     * Get default worker task without callback.\n     * @private\n     */\n    WorkerHelper.prototype.getMessageFn = function (args) {\n        this.workerTask.apply(this, args.data);\n    };\n    return WorkerHelper;\n}());\n","import { isNullOrUndefined, getDefaultDateObject } from '@syncfusion/ej2-base';\n/**\n * @hidden\n */\nexport function toFraction(val) {\n    var strVal = val.toString();\n    if (val === parseInt(strVal, 10)) {\n        return parseInt(strVal, 10) + '  ';\n    }\n    else {\n        var top_1 = strVal.indexOf('.') > -1 ? strVal.split('.')[1] : 0;\n        var bottom = Math.pow(10, top_1.toString().replace('-', '').length);\n        var abs = Math.abs(getGcd(top_1, bottom));\n        return (top_1 / abs) + '/' + (bottom / abs);\n    }\n}\n/**\n * @hidden\n */\nexport function getGcd(a, b) {\n    a = Number(a);\n    b = Number(b);\n    return (b) ? getGcd(b, a % b) : a;\n}\n/**\n * @hidden\n */\nexport function intToDate(val) {\n    val = Number(val);\n    val = (val > 0 && val < 1) ? (1 + val) : (val === 0) ? 1 : val;\n    if (val > 60) {\n        val -= 1; // Due to leap year issue of 1900 in MSExcel.\n    }\n    return new Date(((val - 1) * (1000 * 3600 * 24)) + new Date('01/01/1900').getTime());\n}\n/**\n * @hidden\n */\n/* tslint:disable no-any */\nexport function dateToInt(val, isTime) {\n    var startDate = new Date('01/01/1900');\n    var date = isDateTime(val) ? val : new Date(val);\n    var startDateUTC = Date.UTC(startDate.getFullYear(), startDate.getMonth(), startDate.getDate(), startDate.getHours(), startDate.getMinutes(), startDate.getSeconds(), startDate.getMilliseconds());\n    var dateUTC = Date.UTC(date.getFullYear(), date.getMonth(), date.getDate(), date.getHours(), date.getMinutes(), date.getSeconds(), date.getMilliseconds());\n    var diffDays = ((dateUTC - startDateUTC) / (1000 * 3600 * 24));\n    return isTime ? diffDays : parseInt(diffDays.toString(), 10) + 2;\n}\n/**\n * @hidden\n */\nexport function isDateTime(date) {\n    return Object.prototype.toString.call(date) === '[object Date]' && !isNaN(date.valueOf());\n}\n/**\n * @hidden\n */\nexport function isNumber(val) {\n    return val - parseFloat(val) >= 0;\n}\n/**\n * @hidden\n */\nexport function toDate(text, intl, format) {\n    var defaultDateFormats = getDefaultDateObject();\n    var availabelDateTimeFormat = defaultDateFormats.dateTimeFormats.availableFormats;\n    var dObj = { dateObj: null, isCustom: false, type: '' };\n    if (typeof text === 'string') {\n        text = text.toUpperCase();\n    }\n    if (format) {\n        dObj.dateObj = intl.parseDate(text, { format: format });\n        if (dObj.dateObj) {\n            dObj.type = text.toString().indexOf(':') > -1 ? 'time' : 'datetime';\n            dObj.isCustom = true;\n        }\n    }\n    if (isNullOrUndefined(dObj.dateObj)) {\n        for (var _i = 0, _a = Object.keys(defaultDateFormats.dateFormats); _i < _a.length; _i++) {\n            var key = _a[_i];\n            dObj.dateObj = intl.parseDate(text, { format: defaultDateFormats.dateFormats[key], skeleton: key });\n            if (dObj.dateObj) {\n                dObj.type = 'date';\n                dObj.isCustom = false;\n                break;\n            }\n        }\n        if (isNullOrUndefined(dObj.dateObj)) {\n            for (var _b = 0, _c = Object.keys(availabelDateTimeFormat); _b < _c.length; _b++) {\n                var key = _c[_b];\n                dObj.dateObj = intl.parseDate(text, { format: availabelDateTimeFormat[key], skeleton: key });\n                if (dObj.dateObj) {\n                    dObj.type = text.toString().indexOf(':') > -1 ? 'time' : 'datetime';\n                    if (dObj.type === 'time') {\n                        var time = dObj.dateObj.toLocaleTimeString();\n                        dObj.dateObj = new Date('01/01/1900 ' + time);\n                    }\n                    dObj.isCustom = true;\n                    break;\n                }\n            }\n        }\n        if (isNullOrUndefined(dObj.dateObj)) {\n            for (var _d = 0, _e = Object.keys(defaultDateFormats.timeFormats); _d < _e.length; _d++) {\n                var key = _e[_d];\n                dObj.dateObj = intl.parseDate(text, { format: defaultDateFormats.timeFormats[key], skeleton: key });\n                if (dObj.dateObj) {\n                    var time = dObj.dateObj.toLocaleTimeString();\n                    dObj.dateObj = new Date('01/01/1900 ' + time);\n                    dObj.type = 'time';\n                    dObj.isCustom = false;\n                    break;\n                }\n            }\n        }\n    }\n    if (text !== '#DIV/0!' && !dObj.dateObj && new Date(text).toString() !== 'Invalid Date') {\n        dObj.dateObj = new Date(text);\n    }\n    return dObj;\n}\n","import { getRangeIndexes } from '../common/index';\nimport { getCell, getSheet, setCell, getSheetIndex } from '../base/index';\nimport { Internationalization, getNumberDependable, getNumericObject, isNullOrUndefined } from '@syncfusion/ej2-base';\nimport { isNumber, toFraction, intToDate, toDate, dateToInt } from '../common/math';\nimport { applyNumberFormatting, getFormattedCellObject, refreshCellElement, checkDateFormat, getFormattedBarText } from '../common/event';\n/**\n * Specifies number format.\n */\nvar WorkbookNumberFormat = /** @class */ (function () {\n    function WorkbookNumberFormat(parent) {\n        this.parent = parent;\n        this.localeObj = getNumericObject(this.parent.locale);\n        /* tslint:disable:no-any */\n        this.decimalSep = this.localeObj.decimal;\n        this.groupSep = this.localeObj.group;\n        this.addEventListener();\n    }\n    WorkbookNumberFormat.prototype.numberFormatting = function (args) {\n        var activeSheetIndex = this.parent.activeSheetIndex;\n        if (args.range && args.range.indexOf('!') > -1) {\n            activeSheetIndex = getSheetIndex(this.parent, args.range.split('!')[0]);\n        }\n        var sheet = this.parent.sheets[activeSheetIndex];\n        var formatRange = args.range ? ((args.range.indexOf('!') > -1) ?\n            args.range.split('!')[1] : args.range) : sheet.selectedRange;\n        var selectedRange = getRangeIndexes(formatRange);\n        var cell;\n        for (var i = selectedRange[0]; i <= selectedRange[2]; i++) {\n            for (var j = selectedRange[1]; j <= selectedRange[3]; j++) {\n                setCell(i, j, sheet, { format: args.format }, true);\n                cell = getCell(i, j, sheet, true);\n                this.getFormattedCell({\n                    type: getTypeFromFormat(cell.format), value: cell.value,\n                    format: cell.format, rowIndex: i, colIndex: j,\n                    sheetIndex: activeSheetIndex, cell: cell\n                });\n            }\n        }\n    };\n    /**\n     * @hidden\n     */\n    WorkbookNumberFormat.prototype.getFormattedCell = function (args) {\n        var fResult = isNullOrUndefined(args.value) ? '' : args.value;\n        var sheet = this.parent.sheets[isNullOrUndefined(args.sheetIndex) ? this.parent.activeSheetIndex :\n            args.sheetIndex];\n        var range = getRangeIndexes(sheet.activeCell);\n        var sheetIdx = Number(args.sheetIndex) ? Number(args.sheetIndex) : this.parent.activeSheetIndex;\n        var cell = args.cell ? args.cell : getCell(range[0], range[1], sheet);\n        var rightAlign = false;\n        var currencySymbol = getNumberDependable(this.parent.locale, 'USD');\n        if (args.format === '' || args.format === 'General') {\n            cell = cell ? cell : {};\n            var dateEventArgs = {\n                value: args.value, rowIndex: range[0], colIndex: range[1], sheetIndex: this.parent.activeSheetIndex,\n                updatedVal: args.value, isDate: false, isTime: false\n            };\n            this.checkDateFormat(dateEventArgs);\n            if (dateEventArgs.isDate) {\n                rightAlign = true;\n                cell.value = args.value = dateEventArgs.updatedVal;\n                cell.format = args.format = getFormatFromType('ShortDate');\n            }\n            else if (dateEventArgs.isTime) {\n                rightAlign = true;\n                cell.value = args.value = dateEventArgs.updatedVal;\n                cell.format = args.format = getFormatFromType('Time');\n            }\n        }\n        args.type = args.format ? getTypeFromFormat(args.format) : 'General';\n        var result = this.processFormats(args, fResult, rightAlign, cell);\n        if ((this.parent.getActiveSheet().id - 1 === sheetIdx)) {\n            this.parent.notify(refreshCellElement, {\n                isRightAlign: result.rightAlign, result: result.fResult || args.value,\n                rowIndex: args.rowIndex, colIndex: args.colIndex, sheetIndex: args.sheetIndex,\n                type: args.type, curSymbol: currencySymbol, value: args.value || ''\n            });\n        }\n        if (!args.onLoad && (args.rowIndex > sheet.usedRange.rowIndex || args.colIndex > sheet.usedRange.colIndex)) {\n            this.parent.setUsedRange(args.rowIndex, args.colIndex);\n        }\n        args.formattedText = result.fResult || args.value;\n        args.isRightAlign = result.rightAlign;\n        args.curSymbol = currencySymbol;\n        return args.formattedText;\n    };\n    WorkbookNumberFormat.prototype.processFormats = function (args, fResult, isRightAlign, cell) {\n        var intl = new Internationalization();\n        var currencySymbol = getNumberDependable(this.parent.locale, 'USD');\n        var result;\n        args.format = args.format ? args.format : 'General';\n        if (fResult !== '') {\n            switch (args.type) {\n                case 'General':\n                    result = this.autoDetectGeneralFormat({\n                        args: args, currencySymbol: currencySymbol, fResult: fResult, intl: intl,\n                        isRightAlign: isRightAlign, curCode: 'USD', cell: cell, rowIdx: Number(args.rowIdx),\n                        colIdx: Number(args.colIdx)\n                    });\n                    fResult = result.fResult;\n                    isRightAlign = result.isRightAlign;\n                    break;\n                case 'Number':\n                    if (isNumber(fResult)) {\n                        fResult = this.applyNumberFormat(args, intl);\n                        isRightAlign = true;\n                    }\n                    break;\n                case 'Currency':\n                    if (isNumber(fResult)) {\n                        fResult = this.currencyFormat(args, intl);\n                        isRightAlign = true;\n                    }\n                    break;\n                case 'Percentage':\n                    if (isNumber(fResult)) {\n                        fResult = this.percentageFormat(args, intl);\n                        isRightAlign = true;\n                    }\n                    break;\n                case 'Accounting':\n                    if (isNumber(fResult)) {\n                        fResult = this.accountingFormat(args, intl);\n                        isRightAlign = true;\n                    }\n                    break;\n                case 'ShortDate':\n                    fResult = this.shortDateFormat(args, intl);\n                    isRightAlign = fResult ? true : false;\n                    break;\n                case 'LongDate':\n                    fResult = this.longDateFormat(args, intl);\n                    isRightAlign = fResult ? true : false;\n                    break;\n                case 'Time':\n                    fResult = this.timeFormat(args, intl);\n                    isRightAlign = fResult ? true : false;\n                    break;\n                case 'Fraction':\n                    if (isNumber(fResult)) {\n                        fResult = this.fractionFormat(args);\n                        isRightAlign = true;\n                    }\n                    break;\n                case 'Scientific':\n                    if (isNumber(fResult)) {\n                        fResult = this.scientificFormat(args);\n                        isRightAlign = true;\n                    }\n                    break;\n                case 'Text':\n                    isRightAlign = false;\n                    break;\n            }\n        }\n        return { fResult: fResult, rightAlign: isRightAlign };\n    };\n    WorkbookNumberFormat.prototype.autoDetectGeneralFormat = function (options) {\n        if (isNumber(options.fResult)) {\n            if (options.args.format && options.args.format !== '') {\n                if (options.args.format.toString().indexOf('%') > -1) {\n                    options.fResult = this.percentageFormat(options.args, options.intl);\n                }\n                else if (options.args.format.toString().indexOf(options.currencySymbol) > -1) {\n                    options.fResult = this.currencyFormat(options.args, options.intl);\n                }\n                else {\n                    options.fResult = this.applyNumberFormat(options.args, options.intl);\n                }\n            }\n            if (options.args.format === 'General' && options.fResult && options.fResult.toString().split(this.decimalSep)[0].length > 11) {\n                options.fResult = this.scientificFormat(options.args);\n            }\n            options.isRightAlign = true;\n        }\n        if (!isNullOrUndefined(options.fResult)) {\n            var res = options.fResult.toString();\n            if (res.indexOf('%') > -1 && res.split('%')[0] !== '' && res.split('%')[1].trim() === '' &&\n                Number(res.split('%')[0].split(this.groupSep).join('')).toString() !== 'NaN' &&\n                !this.parent.isEdit) {\n                options.args.value = Number(res.split('%')[0].split(this.groupSep).join(''));\n                options.cell.format = options.args.format = getFormatFromType('Percentage');\n                options.fResult = this.percentageFormat(options.args, options.intl);\n                options.cell.value = options.args.value.toString();\n                setCell(options.rowIdx, options.colIdx, this.parent.getActiveSheet(), options.cell, true);\n                options.isRightAlign = true;\n            }\n            else if (res.indexOf(options.currencySymbol) > -1 && res.split(options.currencySymbol)[1] !== '' &&\n                Number(res.split(options.currencySymbol)[1].split(this.groupSep).join('')).toString() !== 'NaN' &&\n                !this.parent.isEdit) {\n                options.args.value = Number(res.split(options.currencySymbol)[1].split(this.groupSep).join(''));\n                options.cell.format = options.args.format = getFormatFromType('Currency');\n                options.fResult = this.currencyFormat(options.args, options.intl);\n                options.cell.value = options.args.value.toString();\n                setCell(options.rowIdx, options.colIdx, this.parent.getActiveSheet(), options.cell, true);\n                options.isRightAlign = true;\n            }\n        }\n        return { isRightAlign: options.isRightAlign, fResult: options.fResult };\n    };\n    WorkbookNumberFormat.prototype.findSuffix = function (zeros, resultSuffix) {\n        var len = zeros.length;\n        var suffixLen = len - resultSuffix.length;\n        return zeros.substr(0, suffixLen < 0 ? 0 : suffixLen) + resultSuffix;\n    };\n    WorkbookNumberFormat.prototype.applyNumberFormat = function (args, intl) {\n        args.format = this.isCustomFormat(args.format.toString());\n        var formatArr = args.format.toString().split(';');\n        if (Number(args.value) >= 0) {\n            args.format = formatArr[0];\n        }\n        else {\n            args.format = !isNullOrUndefined(formatArr[1]) ? formatArr[1].split('*').join(' ') : formatArr[0];\n        }\n        return intl.formatNumber(Number(args.value), {\n            format: args.format\n        });\n    };\n    WorkbookNumberFormat.prototype.isCustomFormat = function (format) {\n        if (format === '_-* #,##0.00_-;-* #,##0.00_-;_-* \"-\"_-;_-@_-' || format === '_-* #,##0_-;-* #,##0_-;_-* \"-\"_-;_-@_-') {\n            format = '';\n        }\n        format = format === '' ? getFormatFromType('Number') : format;\n        format = format.toString().split('_)').join(' ').split('_(').join(' ').split('[Red]').join('');\n        return format;\n    };\n    WorkbookNumberFormat.prototype.currencyFormat = function (args, intl) {\n        args.format = args.format === '' ? getFormatFromType('Currency') : args.format;\n        args.format = args.format.toString().split('_(').join(' ').split('_)').join(' ').split('[Red]').join('');\n        var formatArr = args.format.toString().split(';');\n        if (Number(args.value) >= 0) {\n            args.format = formatArr[0];\n        }\n        else {\n            args.format = isNullOrUndefined(formatArr[1]) ? formatArr[0] : formatArr[1].split('*').join(' ');\n        }\n        return intl.formatNumber(Number(args.value), {\n            format: args.format,\n            currency: 'USD'\n        });\n    };\n    WorkbookNumberFormat.prototype.percentageFormat = function (args, intl) {\n        args.format = args.format === '' ? getFormatFromType('Percentage') : args.format;\n        return intl.formatNumber(Number(args.value), {\n            format: args.format\n        });\n    };\n    WorkbookNumberFormat.prototype.accountingFormat = function (args, intl) {\n        args.format = args.format === '' ? getFormatFromType('Accounting') : args.format;\n        args.format = args.format.split('_(').join(' ').split('_)').join(' ').split('[Red]').join('').split('_').join('');\n        var currencySymbol = getNumberDependable(this.parent.locale, 'USD');\n        var formatArr = args.format.split(';');\n        if (Number(args.value) >= 0) {\n            args.format = formatArr[0];\n        }\n        else {\n            args.format = formatArr[1].split('*').join(' ');\n        }\n        if (Number(args.value) === 0) {\n            return currencySymbol + '- ';\n        }\n        else {\n            return intl.formatNumber(Number(args.value), {\n                format: args.format,\n                currency: 'USD'\n            }).split('-').join('');\n        }\n    };\n    WorkbookNumberFormat.prototype.shortDateFormat = function (args, intl) {\n        var shortDate = intToDate(args.value);\n        var code = (args.format === '' || args.format === 'General') ? getFormatFromType('ShortDate')\n            : args.format.toString();\n        var dateObj;\n        if (code === getFormatFromType('ShortDate')) {\n            code = 'M/d/yy';\n            dateObj = {\n                type: 'date',\n                skeleton: 'yMd'\n            };\n        }\n        else {\n            dateObj = {\n                type: 'date',\n                format: code\n            };\n        }\n        return intl.formatDate(shortDate, dateObj);\n    };\n    WorkbookNumberFormat.prototype.longDateFormat = function (args, intl) {\n        var longDate = intToDate(args.value);\n        var code = (args.format === '' || args.format === 'General') ? getFormatFromType('LongDate')\n            : args.format.toString();\n        if (code === getFormatFromType('LongDate')) {\n            code = 'EEEE, MMMM d, y';\n        }\n        return intl.formatDate(longDate, {\n            type: 'date',\n            format: code\n        });\n    };\n    WorkbookNumberFormat.prototype.timeFormat = function (args, intl) {\n        if (isNullOrUndefined(args.value)) {\n            return '';\n        }\n        if (!isNullOrUndefined(args.value.toString().split(this.decimalSep)[1])) {\n            args.value = parseFloat('1' + this.decimalSep + args.value.toString().split(this.decimalSep)[1]) || args.value;\n        }\n        var time = intToDate(args.value);\n        var code = (args.format === '' || args.format === 'General') ? getFormatFromType('Time')\n            : args.format.toString();\n        if (code === getFormatFromType('Time')) {\n            code = 'h:mm:ss a';\n        }\n        return intl.formatDate(time, {\n            type: 'time',\n            skeleton: 'medium',\n            format: code\n        });\n    };\n    WorkbookNumberFormat.prototype.scientificFormat = function (args) {\n        args.format = args.format === '' ? getFormatFromType('Scientific') : args.format;\n        var zeros = args.format.split('+')[1];\n        var prefix = this.findDecimalPlaces(args.format, 'Scientific');\n        var fResult = Number(args.value).toExponential(prefix);\n        if (fResult.indexOf('e+') > -1) {\n            fResult = fResult.split('e+')[0] + 'E+' + this.findSuffix(zeros, fResult.split('e+')[1]);\n        }\n        else if (fResult.indexOf('e-') > -1) {\n            fResult = fResult.split('e-')[0] + 'E-' + +this.findSuffix(zeros, fResult.split('e-')[1]);\n        }\n        return fResult;\n    };\n    WorkbookNumberFormat.prototype.fractionFormat = function (args) {\n        args.format = args.format === '' ? getFormatFromType('Fraction') : args.format;\n        var suffix = '';\n        var fractionResult;\n        if (args.value.toString().indexOf(this.decimalSep) > -1 && isNumber(args.value)) {\n            suffix = args.value.toString().split(this.decimalSep)[0];\n            fractionResult = toFraction(Number(args.value));\n            return (Number(suffix) === 0) ? ' ' + fractionResult : suffix + ' ' + fractionResult;\n        }\n        return suffix;\n    };\n    WorkbookNumberFormat.prototype.findDecimalPlaces = function (code, type) {\n        switch (type) {\n            case 'Scientific':\n                var eIndex = code.toUpperCase().indexOf('E');\n                var decIndex = code.indexOf(this.decimalSep);\n                if (eIndex > -1) {\n                    return code.substring(decIndex + 1, eIndex).length;\n                }\n        }\n        return 2;\n    };\n    WorkbookNumberFormat.prototype.checkDateFormat = function (args) {\n        var dateObj;\n        var intl = new Internationalization();\n        var value = !isNullOrUndefined(args.value) ? args.value.toString() : '';\n        var checkedDate;\n        var cell = getCell(args.rowIndex, args.colIndex, getSheet(this.parent, isNullOrUndefined(args.sheetIndex) ? this.parent.activeSheetIndex : args.sheetIndex));\n        checkedDate = this.checkCustomDateFormat(value);\n        if (value && (value.indexOf('/') > -1 || value.indexOf('-') > 0 || value.indexOf(':') > -1) && checkedDate !== 'Invalid') {\n            value = checkedDate;\n            if (value && value.indexOf('/') > -1 || value.indexOf('-') > 0 || value.indexOf(':') > -1) {\n                dateObj = toDate(value, intl, cell && cell.format);\n                if (!isNullOrUndefined(dateObj.dateObj) && dateObj.dateObj.toString() !== 'Invalid Date') {\n                    cell = cell ? cell : {};\n                    value = dateToInt(dateObj.dateObj, value.indexOf(':') > -1).toString();\n                    if (!cell.format || cell.format === '') {\n                        if (dateObj.type === 'time') {\n                            cell.format = getFormatFromType('Time');\n                        }\n                        else {\n                            cell.format = getFormatFromType('ShortDate');\n                        }\n                    }\n                    args.isDate = dateObj.type === 'date' || dateObj.type === 'datetime';\n                    args.isTime = dateObj.type === 'time';\n                    args.dateObj = dateObj.dateObj;\n                }\n            }\n            args.updatedVal = value;\n        }\n    };\n    WorkbookNumberFormat.prototype.checkCustomDateFormat = function (val) {\n        var dateArr = val.indexOf('/') > -1 ? val.split('/') : val.indexOf('-') > 0 ? val.split('-') : '';\n        var months = ['jan', 'feb', 'mar', 'apr', 'may', 'jun', 'jul', 'aug', 'sep', 'sept', 'oct', 'nov', 'dec'];\n        if (dateArr.length === 2) {\n            if (months.indexOf(dateArr[0].toLowerCase()) > -1 && Number(dateArr[1]) <= 31) {\n                return '01-' + dateArr[0] + '-' + dateArr[1];\n            }\n            else if (months.indexOf(dateArr[1].toLowerCase()) > -1 && Number(dateArr[0]) <= 31) {\n                return dateArr[0] + '-' + dateArr[1] + '-' + new Date().getFullYear();\n            }\n            else if (Number(dateArr[0]) <= 31 && Number(dateArr[1]) <= 12) {\n                return dateArr[0] + '-' + dateArr[1] + '-' + new Date().getFullYear();\n            }\n            if (Number(dateArr[1]) <= 31 && Number(dateArr[0]) <= 12) {\n                return dateArr[0] + '-' + dateArr[1] + '-' + new Date().getFullYear();\n            }\n            if (Number(dateArr[0]) <= 12 && Number(dateArr[1]) <= 9999 && Number(dateArr[1]) >= 1900) {\n                return '01-' + dateArr[0] + '-' + dateArr[1];\n            }\n            else {\n                return 'Invalid';\n            }\n        }\n        return val;\n    };\n    WorkbookNumberFormat.prototype.formattedBarText = function (args) {\n        var type = getTypeFromFormat(args.cell ? args.cell.format : '');\n        var intl = new Internationalization();\n        var beforeText = args.value;\n        var date = (type === 'ShortDate' && args.cell && args.cell.format) ?\n            args.cell.format : getFormatFromType('ShortDate');\n        var time = getFormatFromType('Time');\n        switch (type) {\n            case 'ShortDate':\n            case 'LongDate':\n                args.value = this.shortDateFormat({ type: type, value: args.value, format: date }, intl);\n                break;\n            case 'Time':\n                args.value = this.shortDateFormat({ type: type, value: args.value, format: date }, intl) + ' ' +\n                    this.timeFormat({ type: type, value: args.value, format: time }, intl);\n                break;\n        }\n        if (!args.value || (args.value && args.value.toString().indexOf('null') > -1)) {\n            args.value = beforeText;\n        }\n    };\n    /**\n     * Adding event listener for number format.\n     */\n    WorkbookNumberFormat.prototype.addEventListener = function () {\n        this.parent.on(applyNumberFormatting, this.numberFormatting, this);\n        this.parent.on(getFormattedCellObject, this.getFormattedCell, this);\n        this.parent.on(checkDateFormat, this.checkDateFormat, this);\n        this.parent.on(getFormattedBarText, this.formattedBarText, this);\n    };\n    /**\n     * Removing event listener for number format.\n     */\n    WorkbookNumberFormat.prototype.removeEventListener = function () {\n        if (!this.parent.isDestroyed) {\n            this.parent.off(applyNumberFormatting, this.numberFormatting);\n            this.parent.off(getFormattedCellObject, this.getFormattedCell);\n            this.parent.off(checkDateFormat, this.checkDateFormat);\n            this.parent.off(getFormattedBarText, this.formattedBarText);\n        }\n    };\n    /**\n     * To Remove the event listeners.\n     */\n    WorkbookNumberFormat.prototype.destroy = function () {\n        this.removeEventListener();\n        this.parent = null;\n    };\n    /**\n     * Get the workbook number format module name.\n     */\n    WorkbookNumberFormat.prototype.getModuleName = function () {\n        return 'workbookNumberFormat';\n    };\n    return WorkbookNumberFormat;\n}());\nexport { WorkbookNumberFormat };\n/**\n * To Get the number built-in format code from the number format type.\n * @param {string} type - Specifies the type of the number formatting.\n */\nexport function getFormatFromType(type) {\n    var code = 'General';\n    switch (type.split(' ').join('')) {\n        case 'Number':\n            code = '0.00';\n            break;\n        case 'Currency':\n            code = '$#,##0.00';\n            break;\n        case 'Accounting':\n            code = '_($* #,##0.00_);_($* (#,##0.00);_($* \"-\"??_);_(@_)';\n            break;\n        case 'ShortDate':\n            code = 'mm-dd-yyyy';\n            break;\n        case 'LongDate':\n            code = 'dddd, mmmm dd, yyyy';\n            break;\n        case 'Time':\n            code = 'h:mm:ss AM/PM';\n            break;\n        case 'Percentage':\n            code = '0.00%';\n            break;\n        case 'Fraction':\n            code = '# ?/?';\n            break;\n        case 'Scientific':\n            code = '0.00E+00';\n            break;\n        case 'Text':\n            code = '@';\n            break;\n    }\n    return code;\n}\n/**\n * @hidden\n */\nexport function getTypeFromFormat(format) {\n    var code = 'General';\n    switch (format) {\n        case '0.00':\n        case '_-* #,##0.00_-;-* #,##0.00_-;_-* \"-\"_-;_-@_-':\n        case '_-* #,##0_-;-* #,##0_-;_-* \"-\"_-;_-@_-':\n            code = 'Number';\n            break;\n        case '$#,##0.00':\n        case '$#,##0_);[Red]($#,##0)':\n        case '$#,##0.00_);[Red]($#,##0.00)':\n        case '$#,##0.00_);($#,##0.00)':\n        case '$#,##0_);($#,##0)':\n            code = 'Currency';\n            break;\n        case '_($*#,##0.00_);_($*(#,##0.00);_($*\"-\"??_);_(@_)':\n        case '_($*#,##0.00_);_($* (#,##0.00);_($*\"-\"??_);_(@_)':\n        case '_($* #,##0.00_);_($* (#,##0.00);_($* \"-\"??_);_(@_)':\n        case '_ $ * #,##0.00_ ;_ $ * -#,##0.00_ ;_ $ * \"-\"??_ ;_ @_ ':\n            code = 'Accounting';\n            break;\n        case 'mm-dd-yyyy':\n        case 'dd-mm-yyyy':\n        case 'dd-mm-yy':\n        case 'mm-dd-yy':\n        case 'dd/MM/yyyy':\n        case 'yyyy-MM-dd':\n            code = 'ShortDate';\n            break;\n        case 'dddd, mmmm dd, yyyy':\n            code = 'LongDate';\n            break;\n        case 'h:mm:ss AM/PM':\n            code = 'Time';\n            break;\n        case '0.00%':\n        case '0%':\n            code = 'Percentage';\n            break;\n        case '# ?/?':\n        case '# ??/??':\n        case '# ???/???':\n            code = 'Fraction';\n            break;\n        case '0.00E+00':\n            code = 'Scientific';\n            break;\n        case '@':\n            code = 'Text';\n            break;\n    }\n    return code;\n}\n","/**\n * Represent the common codes for calculate\n */\nvar CalculateCommon = /** @class */ (function () {\n    function CalculateCommon(parent) {\n        this.parent = parent;\n    }\n    /**\n     * For internal use only - Get the module name.\n     * @private\n     */\n    CalculateCommon.prototype.getModuleName = function () {\n        return 'calc-common';\n    };\n    return CalculateCommon;\n}());\nexport { CalculateCommon };\n/**\n * To check whether the object is undefined.\n * @param {Object} value - To check the object is undefined\n * @return {boolean}\n * @private\n */\nexport function isUndefined(value) {\n    return ('undefined' === typeof value);\n}\n/** @hidden */\nexport function getSkeletonVal(value) {\n    switch (value) {\n        case 'dd-MMM-yyyy':\n        case 'dd MMM yyyy':\n            value = 'medium';\n            break;\n        case 'MMM-yyyy':\n        case 'MMM yyyy':\n            value = 'yMMM';\n            break;\n        case 'MM-dd-yyyy': //short\n        case 'dd-MM-yyyy':\n        case 'dd-MM-yy':\n        case 'MM/dd/yyyy':\n        case 'dd/MM/yyyy':\n        case 'dd/MM/yy':\n            value = 'short';\n            break;\n        case 'dddd MMMM dd yyyy': //long\n        case 'dd MMMM yyyy':\n            value = 'long';\n            break;\n        case 'd MMMM yyyy':\n            value = 'yMMMd';\n            break;\n        case 'yyyy':\n            value = 'y';\n            break;\n        case 'h:mm':\n            value = 'Hm';\n            break;\n        case 'h:mm tt':\n            value = 'hm';\n            break;\n        case 'h':\n            value = 'H';\n            break;\n        case 'h tt':\n            value = 'h';\n            break;\n        case 'dddd':\n            value = 'E';\n            break;\n        case 'h:mm:ss tt':\n            value = 'hms';\n            break;\n        case 'h:mm:ss':\n            value = 'Hms';\n            break;\n        case 'd':\n            value = 'd';\n            break;\n        case 'd dddd':\n            value = 'Ed';\n            break;\n        case 'M':\n            value = 'M';\n            break;\n        case 'Md':\n            value = 'Md';\n            break;\n        case 'MMM':\n            value = 'MMM';\n            break;\n        case 'ddd MMM d':\n            value = 'MMMEd';\n            break;\n        case 'MMM d':\n            value = 'MMMd';\n            break;\n        case 'M/yyyy':\n            value = 'yM';\n            break;\n        default:\n            value = '';\n            break;\n    }\n    return value;\n}\n","/**\n * Represents the getModules function.\n * @param {Calculate} context\n */\nexport function getModules(context) {\n    var modules = [];\n    if (context.includeBasicFormulas) {\n        modules.push({\n            member: 'basic-formulas',\n            args: [context]\n        });\n    }\n    return modules;\n}\n","/**\n * Module loading operations\n */\nimport { isNullOrUndefined, isUndefined } from '@syncfusion/ej2-base';\nvar MODULE_SUFFIX = 'Module';\n/**\n * To get nameSpace value from the desired object.\n * @param {string} nameSpace - String value to the get the inner object\n * @param {any} obj - Object to get the inner object value.\n * @return {any}\n * @private\n */\nexport function getValue(nameSpace, obj) {\n    /* tslint:disable no-any */\n    var value = obj;\n    var splits = nameSpace.replace(/\\[/g, '.').replace(/\\]/g, '').split('.');\n    for (var j = 0; j < splits.length && !isUndefined(value); j++) {\n        value = value[splits[j]];\n    }\n    return value;\n}\n/**\n * To set value for the nameSpace in desired object.\n * @param {string} nameSpace - String value to get the inner object\n * @param {any} value - Value that you need to set.\n * @param {any} obj - Object to get the inner object value.\n * @return {void}\n * @private\n */\nexport function setValue(nameSpace, value, obj) {\n    var keyValues = nameSpace.replace(/\\[/g, '.').replace(/\\]/g, '').split('.');\n    var start = obj || {};\n    var fromObj = start;\n    var j;\n    var length = keyValues.length;\n    var key;\n    for (j = 0; j < length; j++) {\n        key = keyValues[j];\n        if (j + 1 === length) {\n            fromObj[key] = value === undefined ? {} : value;\n        }\n        else if (isNullOrUndefined(fromObj[key])) {\n            fromObj[key] = {};\n        }\n        fromObj = fromObj[key];\n    }\n    return start;\n}\nvar ModuleLoader = /** @class */ (function () {\n    function ModuleLoader(parent) {\n        this.loadedModules = [];\n        this.parent = parent;\n    }\n    ;\n    /**\n     * Inject required modules in component library\n     * @hidden\n     */\n    ModuleLoader.prototype.inject = function (requiredModules, moduleList) {\n        var reqLengthVal = requiredModules.length;\n        if (reqLengthVal === 0) {\n            this.clean();\n            return;\n        }\n        if (this.loadedModules.length) {\n            this.clearUnusedModule(requiredModules);\n        }\n        for (var i = 0; i < reqLengthVal; i++) {\n            var modl = requiredModules[i];\n            for (var _i = 0, moduleList_1 = moduleList; _i < moduleList_1.length; _i++) {\n                var module = moduleList_1[_i];\n                var modName = modl.member;\n                if (module.prototype.getModuleName() === modl.member && !this.isModuleLoaded(modName)) {\n                    var moduleObject = this.createInstance(module, modl.args);\n                    var memberName = this.getMemberName(modName);\n                    if (modl.isProperty) {\n                        setValue(memberName, module, this.parent);\n                    }\n                    else {\n                        setValue(memberName, moduleObject, this.parent);\n                    }\n                    var loadedModule = modl;\n                    loadedModule.member = memberName;\n                    this.loadedModules.push(loadedModule);\n                }\n            }\n        }\n    };\n    /**\n     * Create Instance from constructor function with desired parameters.\n     * @param {Function} classFunction - Class function to which need to create instance\n     * @param {any[]} params - Parameters need to passed while creating instance\n     * @return {any}\n     * @private\n     */\n    ModuleLoader.prototype.createInstance = function (classFunction, params) {\n        var arrayParam = params;\n        arrayParam.unshift(undefined);\n        return new (Function.prototype.bind.apply(classFunction, arrayParam));\n    };\n    /**\n     * To remove the created object while control is destroyed\n     * @hidden\n     */\n    ModuleLoader.prototype.clean = function () {\n        for (var _i = 0, _a = this.loadedModules; _i < _a.length; _i++) {\n            var modules = _a[_i];\n            if (!modules.isProperty) {\n                getValue(modules.member, this.parent).destroy();\n            }\n        }\n        this.loadedModules = [];\n    };\n    /**\n     * Removes all unused modules\n     * @param {ModuleDeclaration[]} moduleListName\n     * @returns {void}\n     */\n    ModuleLoader.prototype.clearUnusedModule = function (moduleListName) {\n        var _this = this;\n        var usedModule = moduleListName.map(function (arg) { return _this.getMemberName(arg.member); });\n        var removeModule = this.loadedModules.filter(function (module) {\n            return usedModule.indexOf(module.member) === -1;\n        });\n        for (var _i = 0, removeModule_1 = removeModule; _i < removeModule_1.length; _i++) {\n            var moduleName = removeModule_1[_i];\n            if (!moduleName.isProperty) {\n                getValue(moduleName.member, this.parent).destroy();\n            }\n            this.loadedModules.splice(this.loadedModules.indexOf(moduleName), 1);\n            this.deleteObject(this.parent, moduleName.member);\n        }\n    };\n    /**\n     * To get the name of the member.\n     * @param {string} name\n     * @returns {string}\n     */\n    ModuleLoader.prototype.getMemberName = function (name) {\n        return name[0].toLowerCase() + name.substring(1) + MODULE_SUFFIX;\n    };\n    /**\n     * Delete an item from Object\n     * @param {any} obj - Object in which we need to delete an item.\n     * @param {string} params - String value to the get the inner object\n     * @return {void}\n     * @private\n     */\n    ModuleLoader.prototype.deleteObject = function (obj, key) {\n        delete obj[key];\n    };\n    /**\n     * Returns boolean based on whether the module specified is loaded or not\n     * @param {string} modName\n     * @returns {boolean}\n     */\n    ModuleLoader.prototype.isModuleLoaded = function (modName) {\n        for (var _i = 0, _a = this.loadedModules; _i < _a.length; _i++) {\n            var mod = _a[_i];\n            if (mod.member === this.getMemberName(modName)) {\n                return true;\n            }\n        }\n        return false;\n    };\n    return ModuleLoader;\n}());\nexport { ModuleLoader };\n","var __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    }\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\n/* tslint:disable-next-line:max-line-length */\nimport { getValue, Event, NotifyPropertyChanges, Base, Property, isNullOrUndefined, isUndefined } from '@syncfusion/ej2-base';\nimport { BasicFormulas } from './../formulas/index';\nimport { getModules, ModuleLoader } from '../common/index';\nimport { CommonErrors, FormulasErrorsStrings } from '../common/enum';\nimport { Parser } from './parser';\n/**\n * Represents the calculate library.\n */\nvar Calculate = /** @class */ (function (_super) {\n    __extends(Calculate, _super);\n    /**\n     * Base constructor for creating Calculate library.\n     */\n    function Calculate(parent) {\n        var _this = _super.call(this, null, null) || this;\n        _this.lFormulas = new Map();\n        /** @hidden */\n        _this.storedData = new Map();\n        _this.keyToRowsMap = new Map();\n        _this.rowsToKeyMap = new Map();\n        /** @hidden */\n        _this.rightBracket = String.fromCharCode(161);\n        /** @hidden */\n        _this.leftBracket = String.fromCharCode(162);\n        /** @hidden */\n        _this.sheetToken = '!';\n        _this.emptyString = '';\n        _this.leftBrace = '{';\n        _this.rightBrace = '}';\n        _this.cell = _this.emptyString;\n        _this.cellPrefix = '!0!A';\n        _this.treatEmptyStringAsZero = false;\n        /** @hidden */\n        _this.tic = '\\\"';\n        /** @hidden */\n        _this.singleTic = '\\'';\n        /** @hidden */\n        _this.trueValue = 'TRUE';\n        /** @hidden */\n        _this.falseValue = 'FALSE';\n        _this.parseDecimalSeparator = '.';\n        /** @hidden */\n        _this.arithMarker = String.fromCharCode(180);\n        /** @hidden */\n        _this.arithMarker2 = _this.arithMarker + _this.arithMarker;\n        _this.dependentCells = null;\n        _this.dependentFormulaCells = null;\n        _this.minValue = Number.MIN_SAFE_INTEGER;\n        _this.maxValue = Number.MAX_SAFE_INTEGER;\n        _this.categoryCollection = ['All'];\n        _this.dependencyLevel = 0;\n        _this.refreshedCells = new Map();\n        _this.computedValues = null;\n        /** @hidden */\n        _this.randomValues = new Map();\n        /** @hidden */\n        _this.isRandomVal = false;\n        /** @hidden */\n        _this.randCollection = [];\n        /**\n         * @hidden\n         */\n        _this.formulaErrorStrings = [\n            'binary operators cannot start an expression',\n            'cannot parse',\n            'bad library',\n            'invalid char in front of',\n            'number contains 2 decimal points',\n            'expression cannot end with an operator',\n            'invalid characters following an operator',\n            'invalid character in number',\n            'mismatched parentheses',\n            'unknown formula name',\n            'requires a single argument',\n            'requires 3 arguments',\n            'invalid Math argument',\n            'requires 2 arguments',\n            '#NAME?',\n            'too complex',\n            'circular reference: ',\n            'missing formula',\n            'improper formula',\n            'invalid expression',\n            'cell empty',\n            'bad formula',\n            'empty expression',\n            '',\n            'mismatched string quotes',\n            'wrong number of arguments',\n            'invalid arguments',\n            'iterations do not converge',\n            'Control is already registered',\n            'Calculation overflow',\n            'Missing sheet',\n            'cannot_parse',\n            'expression_cannot_end_with_an_operator'\n        ];\n        _this.errorStrings = null;\n        _this.parseArgumentSeparator = ',';\n        _this.dateTime1900 = new Date(1900, 0, 1, 0, 0, 0);\n        _this.isParseDecimalSeparatorChanged = false;\n        _this.isArgumentSeparatorChanged = false;\n        _this.sheetFamilyID = 0;\n        _this.defaultFamilyItem = null;\n        _this.sheetFamiliesList = null;\n        _this.modelToSheetID = null;\n        /** @hidden */\n        _this.tokenCount = 0;\n        _this.sortedSheetNames = null;\n        _this.tempSheetPlaceHolder = String.fromCharCode(133);\n        /** @hidden */\n        _this.namedRanges = new Map();\n        _this.formulaInfoTable = null;\n        _this.oaDate = new Date(1899, 11, 30);\n        _this.millisecondsOfaDay = 24 * 60 * 60 * 1000;\n        _this.parseDateTimeSeparator = '/';\n        var moduleLoader = new ModuleLoader(_this);\n        if (_this.includeBasicFormulas) {\n            Calculate_1.Inject(BasicFormulas);\n        }\n        if (_this.injectedModules && _this.injectedModules.length) {\n            moduleLoader.inject(_this.requiredModules(), _this.injectedModules);\n        }\n        _this.parentObject = isNullOrUndefined(parent) ? _this : parent;\n        _this.grid = _this.parentObject;\n        _this.parser = new Parser(_this);\n        return _this;\n    }\n    Calculate_1 = Calculate;\n    Object.defineProperty(Calculate.prototype, \"libraryFormulas\", {\n        /* tslint:disable-next-line:no-any */\n        get: function () {\n            return this.lFormulas;\n        },\n        /* tslint:disable-next-line:no-any */\n        set: function (formulaColl) {\n            this.lFormulas.set(formulaColl.fName, { handler: formulaColl.handler, category: formulaColl.category, description: formulaColl.description });\n        },\n        enumerable: true,\n        configurable: true\n    });\n    /**\n     * To get the argument separator to split the formula arguments.\n     * @returns string\n     */\n    Calculate.prototype.getParseArgumentSeparator = function () {\n        var seperator = ',';\n        if (!this.isArgumentSeparatorChanged && seperator !== this.parseArgumentSeparator) {\n            this.parseArgumentSeparator = seperator;\n        }\n        return this.parseArgumentSeparator;\n    };\n    /**\n     * To set the argument separator to split the formula arguments.\n     * @param {string} value - Argument separator based on the culture.\n     * @returns void\n     */\n    Calculate.prototype.setParseArgumentSeparator = function (value) {\n        this.parseArgumentSeparator = value;\n        this.isArgumentSeparatorChanged = true;\n    };\n    /**\n     * To get the date separator to split the date value.\n     * @returns string\n     */\n    Calculate.prototype.getParseDateTimeSeparator = function () {\n        return this.parseDateTimeSeparator;\n    };\n    /**\n     * To set whether the empty string is treated as zero or not.\n     * @param {boolean} value\n     * @returns boolean\n     */\n    Calculate.prototype.setTreatEmptyStringAsZero = function (value) {\n        this.treatEmptyStringAsZero = value;\n    };\n    /**\n     * To get whether the empty string is treated as zero or not.\n     * @returns boolean\n     */\n    Calculate.prototype.getTreatEmptyStringAsZero = function () {\n        return this.treatEmptyStringAsZero;\n    };\n    /**\n     * To set the date separator to split the date value.\n     * @param {string} value - Argument separator based on the culture.\n     * @returns void\n     */\n    Calculate.prototype.setParseDateTimeSeparator = function (value) {\n        this.parseDateTimeSeparator = value;\n    };\n    /**\n     * To provide the array of modules needed.\n     * @hidden\n     */\n    Calculate.prototype.requiredModules = function () {\n        return getModules(this);\n    };\n    /**\n     * Dynamically injects the required modules to the library.\n     * @hidden\n     */\n    Calculate.Inject = function () {\n        var moduleList = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            moduleList[_i] = arguments[_i];\n        }\n        if (!this.prototype.injectedModules) {\n            this.prototype.injectedModules = [];\n        }\n        for (var j = 0; j < moduleList.length; j++) {\n            if (this.prototype.injectedModules.indexOf(moduleList[j]) === -1) {\n                this.prototype.injectedModules.push(moduleList[j]);\n            }\n        }\n    };\n    /**\n     * Get injected modules\n     * @hidden\n     */\n    Calculate.prototype.getInjectedModules = function () {\n        return this.injectedModules;\n    };\n    Calculate.prototype.onPropertyChanged = function (newProp, oldProp) {\n        /** code snippets */\n    };\n    Calculate.prototype.getModuleName = function () {\n        return 'calculate';\n    };\n    /** @hidden */\n    Calculate.prototype.getFormulaCharacter = function () {\n        return '=';\n    };\n    /** @hidden */\n    Calculate.prototype.isUpperChar = function (text) {\n        var charCode = text.charCodeAt(0);\n        return ((charCode > 64) && (charCode < 91));\n    };\n    Calculate.prototype.resetKeys = function () {\n        this.storedData.clear();\n        this.keyToRowsMap.clear();\n        this.rowsToKeyMap.clear();\n    };\n    /**\n     * @hidden\n     */\n    Calculate.prototype.updateDependentCell = function (cellRef) {\n        var family = this.getSheetFamilyItem(this.grid);\n        var cell = this.cell;\n        if (cell !== this.emptyString) {\n            if (family.sheetNameToParentObject !== null) {\n                var token = family.parentObjectToToken.get(this.grid);\n                if (cell.indexOf(this.sheetToken) === -1) {\n                    cell = token + cell;\n                }\n                if (cellRef.indexOf(this.sheetToken) === -1) {\n                    cellRef = token + cellRef;\n                }\n            }\n            if (this.getDependentCells().has(cellRef)) {\n                var formulaCells = this.getDependentCells().get(cellRef);\n                if (formulaCells.indexOf(cell) < 0) {\n                    formulaCells.push(cell);\n                }\n            }\n            else {\n                this.getDependentCells().set(cellRef, [cell]);\n            }\n            this.addToFormulaDependentCells(cellRef);\n        }\n    };\n    Calculate.prototype.addToFormulaDependentCells = function (cellRef) {\n        var cell1 = this.cell;\n        var family = this.getSheetFamilyItem(this.grid);\n        if (family.sheetNameToParentObject != null && cell1.indexOf(this.sheetToken) === -1) {\n            var token = family.parentObjectToToken.get(this.grid);\n            cell1 = token + cell1;\n        }\n        if (!this.getDependentFormulaCells().has(cell1)) {\n            this.getDependentFormulaCells().set(cell1, new Map());\n            this.getDependentFormulaCells().get(cell1).set(cellRef, cellRef);\n        }\n        else if (!(this.getDependentFormulaCells().get(cell1)).has(cellRef)) {\n            this.getDependentFormulaCells().get(cell1).set(cellRef, cellRef);\n        }\n    };\n    /**\n     * @hidden\n     */\n    Calculate.prototype.getDependentCells = function () {\n        if (this.isSheetMember()) {\n            var family = this.getSheetFamilyItem(this.grid);\n            if (family.sheetDependentCells == null) {\n                family.sheetDependentCells = new Map();\n            }\n            return family.sheetDependentCells;\n        }\n        else {\n            if (this.dependentCells == null) {\n                this.dependentCells = new Map();\n            }\n            return this.dependentCells;\n        }\n    };\n    /**\n     * @hidden\n     */\n    Calculate.prototype.getDependentFormulaCells = function () {\n        if (this.isSheetMember()) {\n            var family = this.getSheetFamilyItem(this.grid);\n            if (family.sheetDependentFormulaCells == null) {\n                family.sheetDependentFormulaCells = new Map();\n            }\n            return family.sheetDependentFormulaCells;\n        }\n        else {\n            if (this.dependentFormulaCells == null) {\n                this.dependentFormulaCells = new Map();\n            }\n            return this.dependentFormulaCells;\n        }\n    };\n    /**\n     * To get library formulas collection.\n     * @returns Map<string, Function>\n     */\n    Calculate.prototype.getLibraryFormulas = function () {\n        return this.lFormulas;\n    };\n    /**\n     * To get library function.\n     * @param {string} libFormula - Library formula to get a corresponding function.\n     * @returns Function\n     */\n    Calculate.prototype.getFunction = function (libFormula) {\n        if (this.getLibraryFormulas().has(libFormula.toUpperCase())) {\n            return this.getLibraryFormulas().get(libFormula.toUpperCase()).handler;\n        }\n        else {\n            return null;\n        }\n    };\n    /** @hidden */\n    Calculate.prototype.intToDate = function (val) {\n        var dateVal = Number(val);\n        dateVal = (dateVal > 0 && dateVal < 1) ? (1 + dateVal) : (dateVal === 0) ? 1 : dateVal;\n        if (dateVal > 60) {\n            dateVal -= 1; // Due to leap year issue of 1900 in MSExcel.\n        }\n        return new Date(((dateVal - 1) * (1000 * 3600 * 24)) + new Date('01/01/1900').getTime());\n    };\n    Calculate.prototype.getFormulaInfoTable = function () {\n        if (this.isSheetMember()) {\n            var family = this.getSheetFamilyItem(this.grid);\n            if (family.sheetFormulaInfotable === null) {\n                family.sheetFormulaInfotable = new Map();\n            }\n            return family.sheetFormulaInfotable;\n        }\n        else {\n            if (this.formulaInfoTable === null) {\n                this.formulaInfoTable = new Map();\n            }\n            return this.formulaInfoTable;\n        }\n    };\n    /**\n     * To get the formula text.\n     * @private\n     */\n    Calculate.prototype.getFormula = function (key) {\n        key = key.toUpperCase();\n        if (this.storedData.has(key)) {\n            return this.storedData.get(key).getFormulaText();\n        }\n        return '';\n    };\n    /**\n     * To get the formula text.\n     * @returns void\n     */\n    Calculate.prototype.getParseDecimalSeparator = function () {\n        var seperator = '.';\n        if (!this.isParseDecimalSeparatorChanged && seperator !== this.parseDecimalSeparator) {\n            this.parseDecimalSeparator = seperator;\n        }\n        return this.parseDecimalSeparator;\n    };\n    /**\n     * To get the formula text.\n     * @param {string} value - Specifies the decimal separator value.\n     * @returns void\n     */\n    Calculate.prototype.setParseDecimalSeparator = function (value) {\n        this.parseDecimalSeparator = value;\n        this.isParseDecimalSeparatorChanged = true;\n    };\n    /** @hidden */\n    Calculate.prototype.getSheetToken = function (cellRef) {\n        var i = 0;\n        var temp = this.emptyString;\n        if (i < cellRef.length && cellRef[i] === this.sheetToken) {\n            i++;\n            while (i < cellRef.length && cellRef[i] !== this.sheetToken) {\n                i++;\n            }\n            temp = cellRef.substring(0, i + 1);\n        }\n        if (i < cellRef.length) {\n            return temp;\n        }\n        throw this.formulaErrorStrings[FormulasErrorsStrings.bad_index];\n    };\n    /** @hidden */\n    Calculate.prototype.getSheetID = function (grd) {\n        var family = this.getSheetFamilyItem(grd);\n        if (family.sheetNameToParentObject != null && family.sheetNameToParentObject.size > 0) {\n            var token = family.parentObjectToToken.get(grd);\n            token = token.split(this.sheetToken).join(this.emptyString);\n            var id = this.parseFloat(token);\n            if (!this.isNaN(id)) {\n                return id;\n            }\n        }\n        return -1;\n    };\n    /** @hidden */\n    Calculate.prototype.parseFloat = function (value) {\n        return Number(value);\n    };\n    /**\n     * To get the row index of the given cell.\n     * @param {string} cell - Cell address for getting row index.\n     * @returns number\n     */\n    Calculate.prototype.rowIndex = function (cell) {\n        var i = 0;\n        var result;\n        var isLetter = false;\n        if (i < cell.length && cell[i] === this.sheetToken) {\n            i++;\n            while (i < cell.length && cell[i] !== this.sheetToken) {\n                i++;\n            }\n            i++;\n        }\n        while (i < cell.length && this.isChar(cell[i])) {\n            isLetter = true;\n            i++;\n        }\n        result = parseInt(cell.substring(i), 10);\n        if (i < cell.length && !this.isNaN(result)) {\n            return result;\n        }\n        if (isLetter) {\n            return -1;\n        }\n        throw this.formulaErrorStrings[FormulasErrorsStrings.bad_index];\n    };\n    /**\n     * To get the column index of the given cell.\n     * @param {string} cell - Cell address for getting column index.\n     * @returns number\n     */\n    Calculate.prototype.colIndex = function (cell) {\n        var j = 0;\n        var k = 0;\n        cell = cell.toUpperCase();\n        if (j < cell.length && cell[j] === this.sheetToken) {\n            j++;\n            while (j < cell.length && cell[j] !== this.sheetToken) {\n                j++;\n            }\n            j++;\n        }\n        while (j < cell.length && this.isChar(cell[j])) {\n            var charCode = cell[j].charCodeAt(0);\n            k = k * 26 + charCode - 64;\n            j++;\n        }\n        if (k === 0) {\n            return -1;\n        }\n        return k;\n    };\n    /**\n     * To get the valid error strings.\n     * @hidden\n     */\n    Calculate.prototype.getErrorStrings = function () {\n        if (this.errorStrings === null) {\n            this.errorStrings = ['#N/A', '#VALUE!', '#REF!', '#DIV/0!', '#NUM!', '#NAME?', '#NULL!'];\n        }\n        return this.errorStrings;\n    };\n    /** @hidden */\n    Calculate.prototype.substring = function (text, startIndex, length) {\n        return text.substring(startIndex, length + startIndex);\n    };\n    /** @hidden */\n    Calculate.prototype.isChar = function (c) {\n        if ((c.charCodeAt(0) >= 65 && c.charCodeAt(0) <= 90) || (c.charCodeAt(0) >= 97 && c.charCodeAt(0) <= 122)) {\n            return true;\n        }\n        return false;\n    };\n    /** @hidden */\n    Calculate.prototype.getSheetFamilyItem = function (model) {\n        if (this.sheetFamilyID === 0) {\n            if (this.defaultFamilyItem == null) {\n                this.defaultFamilyItem = new CalcSheetFamilyItem();\n            }\n            return this.defaultFamilyItem;\n        }\n        if (this.sheetFamiliesList == null) {\n            this.sheetFamiliesList = new Map();\n        }\n        var i = this.modelToSheetID.get(model);\n        if (!this.sheetFamiliesList.has(i)) {\n            this.sheetFamiliesList.set(i, new CalcSheetFamilyItem());\n        }\n        return this.sheetFamiliesList.get(i);\n    };\n    /**\n     * Register a key value pair for formula.\n     * @param {string} key - Key for formula reference .\n     * @param {string | number} value - Value for the corresponding key.\n     * @returns void\n     */\n    Calculate.prototype.setKeyValue = function (key, value) {\n        key = key.toUpperCase();\n        var str = value.toString().trim();\n        if (!this.storedData.get(key) || str.indexOf(this.leftBrace) === 0) {\n            this.storedData.set(key, new FormulaInfo());\n            this.keyToRowsMap.set(key, this.keyToRowsMap.size + 1);\n            this.rowsToKeyMap.set(this.rowsToKeyMap.size + 1, key);\n        }\n        var fInfo = this.storedData.get(key);\n        if (fInfo.getFormulaText() != null && fInfo.getFormulaText().length > 0 && fInfo.getFormulaText() !== str) {\n            var s1 = this.cellPrefix + this.keyToRowsMap.get(key).toString();\n            var formulaDependent = this.getDependentFormulaCells().get(s1);\n            if (formulaDependent != null) {\n                this.clearFormulaDependentCells(s1);\n            }\n        }\n        if (str.length > 0 && str[0] === this.getFormulaCharacter()) {\n            fInfo.setFormulaText(str);\n        }\n        else if (fInfo.getFormulaValue() !== str) {\n            fInfo.setFormulaText('');\n            fInfo.setParsedFormula('');\n            fInfo.setFormulaValue(str);\n        }\n    };\n    /**\n     * @hidden\n     */\n    Calculate.prototype.clearFormulaDependentCells = function (cell) {\n        var _this = this;\n        var dependentFormula = this.getDependentFormulaCells().get(cell);\n        if (dependentFormula != null) {\n            dependentFormula.forEach(function (value, key) {\n                var s = key;\n                var dependent = _this.getDependentCells().get(s);\n                _this.arrayRemove(dependent, cell);\n                if (dependent.length === 0) {\n                    _this.getDependentCells().delete(s);\n                }\n            });\n            this.getDependentFormulaCells().delete(cell);\n        }\n    };\n    Calculate.prototype.arrayRemove = function (array, value) {\n        var index = array.indexOf(value);\n        if (index !== -1) {\n            array.splice(index, 1);\n        }\n        return array;\n    };\n    /**\n     * Register a key value pair for formula.\n     * @param {string} key - Key for getting the corresponding value.\n     * @returns string | number\n     */\n    Calculate.prototype.getKeyValue = function (key) {\n        key = key.toUpperCase();\n        if (this.storedData.has(key) !== null) {\n            var fInfo = this.storedData.get(key);\n            var fText = fInfo.getFormulaText();\n            if (fText.length > 0 && fText[0] === this.getFormulaCharacter()) {\n                this.cell = this.cellPrefix + this.keyToRowsMap.get(key).toString();\n                fText = fText.substring(1);\n                try {\n                    fInfo.setParsedFormula(this.parser.parseFormula(fText, key));\n                }\n                catch (ex) {\n                    var args = {\n                        message: ex.message, exception: ex, isForceCalculable: false,\n                        computeForceCalculate: false\n                    };\n                    this.trigger('onFailure', args);\n                    fInfo.setFormulaValue(args.message);\n                    return this.storedData.get(key).getFormulaValue();\n                }\n                try {\n                    fInfo.setFormulaValue(this.computeFormula(fInfo.getParsedFormula()));\n                }\n                catch (ex) {\n                    var args = {\n                        message: ex.message, exception: ex, isForceCalculable: false,\n                        computeForceCalculate: false\n                    };\n                    this.trigger('onFailure', args);\n                    var errorMessage = (typeof args.exception === 'string') ? args.exception : args.message;\n                    return (isNullOrUndefined(this.getErrorLine(ex)) ? '' : '#' + this.getErrorLine(ex) + ': ') + errorMessage;\n                }\n            }\n            return this.storedData.get(key).getFormulaValue();\n        }\n        else {\n            return this.emptyString;\n        }\n    };\n    Calculate.prototype.getNamedRanges = function () {\n        return this.namedRanges;\n    };\n    /**\n     * Adds a named range to the NamedRanges collection.\n     * @param {string} name - Name of the named range.\n     * @param {string} range - Range for the specified name.\n     * @param {number} sheetIndex - Defined scope for the specified name. Default - Workbook scope.\n     * @returns boolean\n     */\n    Calculate.prototype.addNamedRange = function (name, range) {\n        var sheetScopeName = name.split(this.sheetToken);\n        if (sheetScopeName.length > 1) {\n            var family = this.getSheetFamilyItem(this.grid);\n            if (!family.parentObjectToToken.get(sheetScopeName[0])) {\n                return false;\n            }\n            name = sheetScopeName[0] + this.sheetToken + sheetScopeName[1].toUpperCase();\n        }\n        else {\n            name = name.toUpperCase();\n        }\n        this.namedRanges.set(name, range);\n        return true;\n    };\n    /**\n     * Remove the specified named range form the named range collection.\n     * @param {string} name - Name of the specified named range.\n     * @returns boolean\n     */\n    Calculate.prototype.removeNamedRange = function (name) {\n        name = name.toUpperCase();\n        if (this.namedRanges.get(name) != null) {\n            this.namedRanges.delete(name);\n            return true;\n        }\n        return false;\n    };\n    /** @hidden */\n    Calculate.prototype.convertAlpha = function (col) {\n        var arrCol = [];\n        var n = 0;\n        var charText = 'A';\n        while (col > 0) {\n            col--;\n            var aCharValue = charText.charCodeAt(0);\n            arrCol[n] = String.fromCharCode(col % 26 + aCharValue);\n            col = parseInt((col / 26).toString(), 10);\n            n++;\n        }\n        var arr = [];\n        for (var i = 0; i < n; i++) {\n            arr[n - i - 1] = arrCol[i];\n        }\n        return arr.join('');\n    };\n    /** @hidden */\n    Calculate.prototype.getCellCollection = function (cellRange) {\n        if (cellRange.indexOf(':') < 0) {\n            if (!this.isCellReference(cellRange)) {\n                return cellRange.split(this.getParseArgumentSeparator());\n            }\n            else {\n                cellRange = cellRange + ':' + cellRange;\n            }\n        }\n        var token = this.emptyString;\n        var sheetTokenIndex = cellRange.indexOf(this.sheetToken);\n        if (sheetTokenIndex > -1) {\n            var index = sheetTokenIndex;\n            var s = index + 1;\n            while (s < cellRange.length) {\n                if (cellRange[s] === this.sheetToken) {\n                    token = cellRange.substr(0, s + 1);\n                    break;\n                }\n                s++;\n            }\n        }\n        var i = cellRange.indexOf(':');\n        var row1;\n        var row2;\n        var col1;\n        var col2;\n        if (i > 0 && this.isChar(cellRange[i - 1])) {\n            var k = i - 2;\n            while (k >= 0 && this.isDigit(cellRange[k])) {\n                k--;\n            }\n        }\n        row1 = this.rowIndex(this.substring(cellRange, 0, i));\n        row2 = this.rowIndex(this.substring(cellRange, i + 1, i + cellRange.length - i - 1));\n        col1 = this.colIndex(this.substring(cellRange, 0, i));\n        col2 = this.colIndex(this.substring(cellRange, i + 1, i + cellRange.length - i - 1));\n        if (row1 > row2) {\n            i = row2;\n            row2 = row1;\n            row1 = i;\n        }\n        if (col1 > col2) {\n            i = col2;\n            col2 = col1;\n            col1 = i;\n        }\n        var cells = [];\n        var j;\n        var c = 0;\n        for (i = row1; i <= row2; i++) {\n            for (j = col1; j <= col2; j++) {\n                cells[c] = token + this.emptyString + this.convertAlpha(j) + i.toString();\n                c++;\n            }\n        }\n        return cells;\n    };\n    /**\n     * Compute the given formula.\n     * @param {string} formulaText - Specifies to compute the given formula.\n     * @returns string | number\n     */\n    Calculate.prototype.computeFormula = function (formulaText) {\n        var parsedText;\n        var lastIndexOfq;\n        var formulatResult;\n        var nestedFormula = false;\n        var fNested;\n        if (this.parser.isError) {\n            return formulaText;\n        }\n        if (!this.parser.isFormulaParsed) {\n            parsedText = this.parser.parseFormula(formulaText);\n        }\n        else {\n            parsedText = formulaText;\n        }\n        this.parser.isFormulaParsed = false;\n        try {\n            lastIndexOfq = this.findLastIndexOfq(parsedText);\n            if (lastIndexOfq > 0) {\n                nestedFormula = true;\n            }\n            if (parsedText !== this.emptyString && lastIndexOfq > -1) {\n                var i = lastIndexOfq + 1;\n                while (i > -1) {\n                    if (parsedText[i] !== this.rightBracket) {\n                        i++;\n                        continue;\n                    }\n                    var sFormula = parsedText.substring(lastIndexOfq, i + 1);\n                    var libFormula = sFormula.split(this.leftBracket)[0].split('q').join(this.emptyString);\n                    var args = sFormula.substring(sFormula.indexOf(this.leftBracket) + 1, sFormula.indexOf(this.rightBracket))\n                        .split(this.getParseArgumentSeparator());\n                    if (this.getLibraryFormulas().get(libFormula.toUpperCase()).isCustom) {\n                        var j = 0;\n                        var customArgs = [];\n                        for (j = 0; j < args.length; j++) {\n                            customArgs.push(this.getValueFromArg(args[j]));\n                        }\n                        args = customArgs;\n                    }\n                    formulatResult = isNullOrUndefined(this.getFunction(libFormula)) ? this.getErrorStrings()[CommonErrors.name] : this.getFunction(libFormula).apply(void 0, args);\n                    if (nestedFormula) {\n                        fNested = this.processNestedFormula(parsedText, sFormula, formulatResult);\n                        var q = this.findLastIndexOfq(fNested);\n                        if (q === 0) {\n                            nestedFormula = false;\n                        }\n                        if (q === -1) {\n                            formulatResult = this.computeValue(fNested);\n                        }\n                        lastIndexOfq = i = q;\n                        parsedText = fNested;\n                        continue;\n                    }\n                    break;\n                }\n            }\n            else if (this.formulaErrorStrings.indexOf(parsedText) > -1) {\n                formulatResult = parsedText;\n            }\n            else if (parsedText !== this.emptyString && lastIndexOfq === -1) {\n                formulatResult = this.computeValue(parsedText);\n            }\n        }\n        catch (ex) {\n            var args = { message: ex.message, exception: ex, isForceCalculable: false, computeForceCalculate: false };\n            this.trigger('onFailure', args);\n            var errorMessage = (typeof args.exception === 'string') ? args.exception : args.message;\n            formulatResult = (isNullOrUndefined(this.getErrorLine(ex)) ? '' : '#' + this.getErrorLine(ex) + ': ') + errorMessage;\n        }\n        return formulatResult;\n    };\n    /** @hidden */\n    Calculate.prototype.computeSumIfAndAvgIf = function (range) {\n        if (isNullOrUndefined(range) || range[0] === this.emptyString || range.length === 0) {\n            return this.formulaErrorStrings[FormulasErrorsStrings.wrong_number_arguments];\n        }\n        var argArr = range;\n        var argCount = argArr.length;\n        if (argCount !== 2 && argCount !== 3 && argCount === 0) {\n            return this.formulaErrorStrings[FormulasErrorsStrings.wrong_number_arguments];\n        }\n        var rangevalue = argArr[0];\n        var criteria = argArr[1].trim();\n        criteria = criteria.split(this.tic).join(this.emptyString);\n        if (criteria.length > 255) {\n            return this.getErrorStrings()[CommonErrors.value];\n        }\n        var opt = this.parser.tokenEqual;\n        if (criteria.startsWith('<=')) {\n            opt = this.parser.tokenLessEq;\n            criteria = criteria.substring(2);\n        }\n        else if (criteria.startsWith('>=')) {\n            opt = this.parser.tokenGreaterEq;\n            criteria = criteria.substring(2);\n        }\n        else if (criteria.startsWith('<>')) {\n            opt = this.parser.tokenNotEqual;\n            criteria = criteria.substring(2);\n        }\n        else if (criteria.startsWith('<')) {\n            opt = this.parser.tokenLess;\n            criteria = criteria.substring(1);\n        }\n        else if (criteria.startsWith('>')) {\n            opt = this.parser.tokenGreater;\n            criteria = criteria.substring(1);\n        }\n        else if (criteria.startsWith('=')) {\n            opt = this.parser.tokenEqual;\n            criteria = criteria.substring(1);\n        }\n        var checkCriteria = this.parseFloat(criteria);\n        var criteriaRangeArray = argArr[0];\n        var sumRange = this.getCellCollection(argCount > 2 ? argArr[2] : rangevalue);\n        var criteriaRange = this.getCellCollection(criteriaRangeArray);\n        var result = this.getComputeSumIfValue(criteriaRange, sumRange, criteria, checkCriteria, opt);\n        return [result[0], result[1]];\n    };\n    /** @hidden */\n    Calculate.prototype.computeLookup = function (range) {\n        if (range.length === 0) {\n            return this.formulaErrorStrings[FormulasErrorsStrings.wrong_number_arguments];\n        }\n        var checkCrte = [];\n        var findMaxVal = [];\n        var argArr = range;\n        var argCount = argArr.length;\n        var criterias = argArr[0].split(this.tic).join(this.emptyString);\n        var rangevalue = argArr[1];\n        var lookupRangeArray = argCount === 2 ? rangevalue : argArr[2];\n        var criteriaRange = this.getCellCollection(argArr[1]);\n        var lookupRange = this.getCellCollection(lookupRangeArray);\n        for (var i = 0; i < criteriaRange.length; i++) {\n            findMaxVal[i] = this.getValueFromArg(criteriaRange[i]).split(this.tic).join('');\n        }\n        var s = findMaxVal.toString().split(this.getParseArgumentSeparator());\n        var maxVal = this.parseFloat(s[s.sort().length - 1]);\n        var minVal = this.parseFloat(s[0]);\n        for (var j = 0; j < criteriaRange.length; j++) {\n            checkCrte[j] = this.getValueFromArg(criteriaRange[j]).split(this.tic).join('');\n            if (criterias === checkCrte[j]) {\n                return this.getValueFromArg(lookupRange[j]).split(this.tic).join('');\n            }\n            else if (this.parseFloat(criterias) === this.parseFloat(checkCrte[j])) {\n                return this.getValueFromArg(lookupRange[j]).split(this.tic).join('');\n            }\n            else if (this.parseFloat(criterias) < minVal) {\n                return this.getErrorStrings()[CommonErrors.na];\n            }\n            else if (this.parseFloat(criterias) > maxVal) {\n                var index = findMaxVal.indexOf(maxVal.toString());\n                return this.getValueFromArg(lookupRange[index]).split(this.tic).join('');\n            }\n        }\n        if (findMaxVal.indexOf(criterias) < 0) {\n            var temp = [];\n            for (var n = 0; n < s.length; n++) {\n                if (this.parseFloat(criterias) > this.parseFloat(s[n])) {\n                    temp.push(s[n]);\n                }\n            }\n            var index = findMaxVal.indexOf(temp[temp.length - 1]);\n            return this.getValueFromArg(lookupRange[index]).split(this.tic).join('');\n        }\n        return this.getErrorStrings()[CommonErrors.na];\n    };\n    Calculate.prototype.computeVLookup = function (range) {\n        var argArr = range;\n        var findMaxValue = [];\n        var lookupValue = argArr[0].split(this.tic).join('');\n        if (lookupValue.indexOf(':') > -1) {\n            return this.getErrorStrings()[CommonErrors.value];\n        }\n        if (this.isCellReference(lookupValue)) {\n            lookupValue = this.getValueFromArg(lookupValue);\n        }\n        if (argArr[1].indexOf(':') < -1) {\n            return this.getErrorStrings()[CommonErrors.na];\n        }\n        var lookupRange = [];\n        var firstCol = '';\n        var secCol = '';\n        if (this.isCellReference(argArr[1])) {\n            lookupRange = this.getCellCollection(argArr[1]);\n            if (argArr[1].indexOf(':') > -1) {\n                var index = argArr[1].indexOf(':');\n                for (var i = 0; i < index; i++) {\n                    var tempCell = this.isChar(argArr[1][i]) ? argArr[1][i] : '';\n                    firstCol = firstCol + tempCell;\n                }\n                for (var j = index; j < argArr[1].length; j++) {\n                    var tempCell2 = this.isChar(argArr[1][j]) ? argArr[1][j] : '';\n                    secCol = secCol + tempCell2;\n                }\n            }\n        }\n        var lookupCol = this.colIndex(firstCol) + this.parseFloat(argArr[2]);\n        if (lookupCol > this.colIndex(secCol)) {\n            return this.getErrorStrings()[CommonErrors.na];\n        }\n        if (lookupCol === this.colIndex(firstCol)) {\n            return this.getErrorStrings()[CommonErrors.na];\n        }\n        var lookupCell = this.convertAlpha(lookupCol);\n        argArr[3] = isNullOrUndefined(argArr[3]) ? this.trueValue : argArr[3].split(this.tic).join('');\n        var cellValue = '';\n        for (var i = 0; i < lookupRange.length; i++) {\n            findMaxValue[i] = this.getValueFromArg(lookupRange[i]).split(this.tic).join('');\n        }\n        var s = findMaxValue.toString().split(this.getParseArgumentSeparator());\n        var maxValue = this.parseFloat(s[s.sort().length - 1]);\n        var minValue = this.parseFloat(s[0]);\n        for (var j = 0; j < lookupRange.length; j++) {\n            cellValue = this.getValueFromArg(lookupRange[j]);\n            if (argArr[3].toUpperCase() === this.trueValue) {\n                if (lookupValue === cellValue) {\n                    return this.getValueFromArg(lookupCell + j).split(this.tic).join('');\n                }\n                else if (this.parseFloat(lookupValue) === this.parseFloat(cellValue)) {\n                    return this.getValueFromArg(lookupCell + j).split(this.tic).join('');\n                }\n                else if (this.parseFloat(lookupValue) < minValue) {\n                    return this.getErrorStrings()[CommonErrors.na];\n                }\n                else if (this.parseFloat(lookupValue) > maxValue) {\n                    var index = findMaxValue.indexOf(maxValue.toString());\n                    return this.getValueFromArg(lookupCell + index).split(this.tic).join('');\n                }\n            }\n            if (argArr[3] === this.falseValue) {\n                if (lookupValue === cellValue) {\n                    return this.getValueFromArg(lookupCell + j);\n                }\n            }\n        }\n        return this.getErrorStrings()[CommonErrors.na];\n    };\n    Calculate.prototype.findWildCardValue = function (lookVal, cellValue) {\n        var finalText = '';\n        if (lookVal.indexOf('?') > -1) {\n            var index = lookVal.indexOf('?');\n            var checStr1 = lookVal[index - 1];\n            var checStr2 = lookVal[index + 1];\n            if (cellValue.indexOf(checStr1) > -1 && cellValue.indexOf(checStr2) > -1) {\n                var newIndex = cellValue.indexOf(checStr1);\n                if (cellValue[newIndex] === checStr1 && cellValue[newIndex + 2] === checStr2) {\n                    finalText = lookVal;\n                }\n                else {\n                    finalText = cellValue;\n                }\n            }\n            else {\n                finalText = cellValue;\n            }\n        }\n        else if (lookVal.indexOf('*') > -1) {\n            var index = lookVal.indexOf('*');\n            var left = '';\n            var right = '';\n            var compRight = this.falseValue;\n            var compLeft = this.falseValue;\n            for (var i = index - 1; i >= 0; i--) {\n                left = left + lookVal[i];\n                compLeft = this.trueValue;\n            }\n            for (var i = index + 1; i < lookVal.length; i++) {\n                right = right + lookVal[i];\n                compRight = this.trueValue;\n            }\n            var leftVal = left === '' ? -1 : cellValue.indexOf(left.split('').reverse().join(''));\n            var rightVal = right === '' ? -1 : cellValue.indexOf(right);\n            if (leftVal > -1 || rightVal > -1) {\n                if (compLeft === this.trueValue) {\n                    finalText = (left.split('').reverse().join('') === cellValue.substr(0, left.length)) ? lookVal : cellValue;\n                }\n                else if (compRight === this.trueValue) {\n                    finalText = (right === cellValue.substring(cellValue.length - right.length, cellValue.length)) ? lookVal : cellValue;\n                }\n            }\n            else {\n                finalText = cellValue;\n            }\n        }\n        return finalText;\n    };\n    /** @hidden */\n    /* tslint:disable-next-line */\n    Calculate.prototype.getComputeSumIfValue = function (criteriaRange, sumRange, criteria, checkCriteria, op) {\n        var sum = 0;\n        var count = 0;\n        switch (op) {\n            case this.parser.tokenEqual:\n                {\n                    for (var i = 0; i < criteriaRange.length; i++) {\n                        var value = this.getValueFromArg(criteriaRange[i].split(this.tic).join(''));\n                        var val = this.parseFloat(value);\n                        if (value === criteria && val === checkCriteria) {\n                            var value1 = this.getValueFromArg(sumRange[i].split(this.tic).join(''));\n                            var val1 = this.parseFloat(value1);\n                            sum = sum + val1;\n                            count = count + 1;\n                        }\n                        else if (value === criteria) {\n                            var sumRangeVal = sumRange[i];\n                            sumRangeVal = this.getValueFromArg(sumRangeVal);\n                            sum = this.parseFloat(sumRangeVal.toString());\n                            count = count + 1;\n                        }\n                    }\n                }\n                break;\n            case this.parser.tokenLess:\n                {\n                    for (var i = 0; i < criteriaRange.length; i++) {\n                        var value = this.getValueFromArg(criteriaRange[i].split(this.tic).join(''));\n                        var val = this.parseFloat(value);\n                        if (val < checkCriteria) {\n                            var value1 = this.getValueFromArg(sumRange[i].split(this.tic).join(''));\n                            var val1 = this.parseFloat(value1);\n                            sum = sum + val1;\n                            count = count + 1;\n                        }\n                    }\n                }\n                break;\n            case this.parser.tokenGreater:\n                {\n                    for (var i = 0; i < criteriaRange.length; i++) {\n                        var value = this.getValueFromArg(criteriaRange[i].split(this.tic).join(''));\n                        var val = this.parseFloat(value);\n                        if (val > checkCriteria) {\n                            var value1 = this.getValueFromArg(sumRange[i].split(this.tic).join(''));\n                            var val1 = this.parseFloat(value1);\n                            sum = sum + val1;\n                            count = count + 1;\n                        }\n                    }\n                }\n                break;\n            case this.parser.tokenLessEq:\n                {\n                    for (var i = 0; i < criteriaRange.length; i++) {\n                        var value = this.getValueFromArg(criteriaRange[i].split(this.tic).join(''));\n                        var val = this.parseFloat(value);\n                        if (val <= checkCriteria) {\n                            var value1 = this.getValueFromArg(sumRange[i].split(this.tic).join(''));\n                            var val1 = this.parseFloat(value1);\n                            sum = sum + val1;\n                            count = count + 1;\n                        }\n                    }\n                }\n                break;\n            case this.parser.tokenGreaterEq:\n                {\n                    for (var i = 0; i < criteriaRange.length; i++) {\n                        var value = this.getValueFromArg(criteriaRange[i].split(this.tic).join(''));\n                        var val = this.parseFloat(value);\n                        if (val >= checkCriteria) {\n                            var value1 = this.getValueFromArg(sumRange[i].split(this.tic).join(''));\n                            var val1 = this.parseFloat(value1);\n                            sum = sum + val1;\n                            count = count + 1;\n                        }\n                    }\n                }\n                break;\n            case this.parser.tokenNotEqual:\n                {\n                    for (var i = 0; i < criteriaRange.length; i++) {\n                        var value = this.getValueFromArg(criteriaRange[i].split(this.tic).join(''));\n                        var val = this.parseFloat(value);\n                        if (value !== criteria && val !== checkCriteria) {\n                            var value1 = this.getValueFromArg(sumRange[i].split(this.tic).join(''));\n                            var val1 = this.parseFloat(value1);\n                            sum = sum + val1;\n                            count = count + 1;\n                        }\n                    }\n                }\n                break;\n        }\n        return [sum, count];\n    };\n    /** @hidden */\n    Calculate.prototype.computeAndOr = function (args, op) {\n        var result = op === 'and' ? true : false;\n        var value;\n        var parseVal;\n        if (args.length === 0) {\n            return this.formulaErrorStrings[FormulasErrorsStrings.wrong_number_arguments];\n        }\n        for (var l = 0, len = args.length; l < len; l++) {\n            if (args[l].split(this.tic).join('').trim() === this.emptyString) {\n                return this.getErrorStrings()[CommonErrors.value];\n            }\n        }\n        var ranges = args;\n        for (var i = 0; i < ranges.length; i++) {\n            if (ranges[i] === (this.tic)) {\n                return this.getErrorStrings()[CommonErrors.value];\n            }\n            if (ranges[i].indexOf(':') > -1 && this.isCellReference(ranges[i])) {\n                var cells = this.getCellCollection(ranges[i]);\n                for (var j = 0; j < cells.length; j++) {\n                    if (this.getErrorStrings().indexOf(cells[j]) > -1) {\n                        return cells[j];\n                    }\n                    else if (cells[j][0] === this.tic) {\n                        return this.getErrorStrings()[CommonErrors.name];\n                    }\n                    value = this.getValueFromArg(cells[j]);\n                    if (value === '') {\n                        value = this.trueValue;\n                    }\n                    if (this.getErrorStrings().indexOf(value) > -1) {\n                        return value;\n                    }\n                    parseVal = this.parseFloat(value);\n                }\n            }\n            else {\n                value = this.getValueFromArg(ranges[i]).split(this.tic).join('').toUpperCase();\n                if (this.getErrorStrings().indexOf(value) > -1) {\n                    return value;\n                }\n                var tempdate = Date.parse(value.split(this.tic).join(''));\n                if (!isNaN(tempdate)) {\n                    result = true;\n                }\n                else if (!(value === this.trueValue || value === this.falseValue)) {\n                    return this.getErrorStrings()[CommonErrors.value].toString();\n                }\n                parseVal = this.parseFloat(value);\n            }\n            result = op === 'and' ? (result && ((value === this.trueValue) || !(isNaN(parseVal)))) :\n                (result || ((value === this.trueValue) || !(isNaN(parseVal))));\n        }\n        return result ? this.trueValue : this.falseValue;\n    };\n    /** @hidden */\n    // To strip out the tic from the formula arguments.\n    Calculate.prototype.removeTics = function (text) {\n        if (text.length > 1 && text[0] === this.tic[0] && text[text.length - 1] === this.tic[0]) {\n            text = this.substring(text, 1, text.length - 2);\n        }\n        return text;\n    };\n    /** @hidden */\n    Calculate.prototype.getCellFrom = function (range) {\n        var cellRange = '';\n        var cells = range.indexOf(':') > -1 ? range.split(':') : [range];\n        //this.getCellsFromArgs(range);\n        var last = cells.length - 1;\n        var r1 = this.rowIndex(cells[0]);\n        var x;\n        if (r1 === this.rowIndex(cells[last])) {\n            var c1 = this.colIndex(cells[0]);\n            var c2 = this.colIndex(cells[last]);\n            var c = this.colIndex(this.cell);\n            if (c >= c1 && c <= c2) {\n                cellRange = getAlphalabel(c).toString() + r1.toString();\n            }\n        }\n        else if (this.colIndex(cells[0]) === this.colIndex(cells[last])) {\n            x = this.colIndex(cells[0]);\n            var r2 = this.rowIndex(cells[last]);\n            var r = this.rowIndex(this.cell);\n            if (r >= r1 && r <= r2) {\n                cellRange = getAlphalabel(x).toString() + r.toString();\n            }\n        }\n        return cellRange;\n    };\n    /* tslint:disable-next-line:max-func-body-length */\n    Calculate.prototype.computeValue = function (pFormula) {\n        try {\n            var stack = [];\n            var i = 0;\n            var sheet = '';\n            stack.length = 0;\n            while (i < pFormula.length) {\n                var uFound = pFormula[i] === 'u'; // for 3*-2\n                if (pFormula[i] === this.arithMarker) {\n                    i = i + 1;\n                    continue;\n                }\n                else if (this.isDigit(pFormula[i])) {\n                    var s = this.emptyString;\n                    while (i < pFormula.length && (this.isDigit(pFormula[i]) || pFormula[i] === this.parseDecimalSeparator)) {\n                        s = s + pFormula[i];\n                        i = i + 1;\n                    }\n                    stack.push(s);\n                }\n                if (pFormula[i] === this.sheetToken) {\n                    sheet = pFormula[i];\n                    i = i + 1;\n                    while (i < pFormula.length && pFormula[i] !== this.sheetToken) {\n                        sheet = sheet + pFormula[i];\n                        i = i + 1;\n                    }\n                    if (i < pFormula.length) {\n                        sheet = sheet + pFormula[i];\n                        i = i + 1;\n                    }\n                }\n                else if (this.isUpperChar(pFormula[i])) {\n                    var s = this.emptyString;\n                    var textName = '';\n                    while (i < pFormula.length && this.isUpperChar(pFormula[i])) {\n                        var char = pFormula[i];\n                        s = s + char;\n                        i = i + 1;\n                    }\n                    while (i < pFormula.length && this.isDigit(pFormula[i])) {\n                        var digit = pFormula[i];\n                        s = s + digit;\n                        i = i + 1;\n                    }\n                    if (i < pFormula.length && pFormula[i] === ':') {\n                        s = s + pFormula[i];\n                        i = i + 1;\n                        if (i < pFormula.length && pFormula[i] === this.sheetToken) {\n                            s = s + pFormula[i];\n                            i = i + 1;\n                            while (i < pFormula.length && pFormula[i] !== this.sheetToken) {\n                                s = s + pFormula[i];\n                                i = i + 1;\n                            }\n                        }\n                        while (i < pFormula.length && this.isUpperChar(pFormula[i])) {\n                            s = s + pFormula[i];\n                            i = i + 1;\n                        }\n                        while (i < pFormula.length && this.isDigit(pFormula[i])) {\n                            s = s + pFormula[i];\n                            i = i + 1;\n                        }\n                        s = sheet + this.getCellFrom(s);\n                    }\n                    else {\n                        s = sheet + s;\n                    }\n                    textName = this.getParentObjectCellValue(s).toString();\n                    if (typeof textName === 'string' && this.getErrorStrings().indexOf(textName) > -1) {\n                        return textName;\n                    }\n                    stack.push(textName);\n                }\n                else if (pFormula[i] === 'q') {\n                    var leftIdx = pFormula.substring(i + 1).indexOf(this.leftBracket);\n                    var j = pFormula.substring(i + leftIdx + 1).indexOf(this.rightBracket);\n                    pFormula = this.substring(pFormula, i + leftIdx + 2, j - 1);\n                }\n                else if (pFormula[i] === this.tic[0]) {\n                    var s = pFormula[i].toString();\n                    i = i + 1;\n                    while (i < pFormula.length && pFormula[i] !== this.tic[0]) {\n                        s = s + pFormula[i];\n                        i = i + 1;\n                    }\n                    stack.push(s.split(this.tic).join(this.emptyString));\n                    i = i + 1;\n                }\n                else if (pFormula[i] === '%' && stack.length > 0) {\n                    var stackValue = stack[0];\n                    var value = this.parseFloat(stackValue);\n                    if (!this.isNaN(value)) {\n                        stack.pop();\n                        stack.push((value / 100).toString());\n                    }\n                    i = i + 1;\n                }\n                else if ((pFormula.substring(i)).indexOf(this.trueValue) === 0) {\n                    stack.push(this.trueValue);\n                    i += this.trueValue.length;\n                }\n                else if (pFormula.substring(i).indexOf(this.falseValue) === 0) {\n                    stack.push(this.falseValue);\n                    i += this.falseValue.length;\n                }\n                else if (pFormula[i] === this.tic[0] || pFormula[i] === '|') {\n                    var s = pFormula[i].toString();\n                    i++;\n                    while (i < pFormula.length && pFormula[i] !== this.tic[0]) {\n                        s = s + pFormula[i];\n                        i = i + 1;\n                    }\n                    stack.push(s + this.tic);\n                    i += 1;\n                }\n                else {\n                    switch (pFormula[i]) {\n                        case '#':\n                            {\n                                var errIndex = 0;\n                                if (this.getErrorStrings().indexOf(pFormula.substring(i)) > -1) {\n                                    if (pFormula.indexOf('!') === -1 || pFormula.substring(i).indexOf('!') === -1) {\n                                        errIndex = pFormula.indexOf('#N/A') > -1 ?\n                                            (pFormula.indexOf('#N/A') + 4 + i) : pFormula.indexOf('?') + 1 + i;\n                                    }\n                                    else {\n                                        errIndex = pFormula.indexOf('!') + 1 + i;\n                                    }\n                                    stack.push(this.substring(pFormula, i, errIndex - i));\n                                }\n                                else {\n                                    errIndex = i + 1;\n                                    stack.push(this.substring(pFormula, i, errIndex - i));\n                                }\n                                i = errIndex;\n                            }\n                            break;\n                        case 'n':\n                            {\n                                i = i + 1;\n                                var s = '';\n                                if (pFormula.substring(i).indexOf('Infinity') === 0) {\n                                    s = 'Infinity';\n                                    i += s.length;\n                                }\n                                else {\n                                    if (pFormula[i] === 'u' || uFound) {\n                                        s = '-';\n                                        if (!uFound) {\n                                            i = i + 1;\n                                        }\n                                        else {\n                                            uFound = false;\n                                        }\n                                    }\n                                    while (i < pFormula.length && (this.isDigit(pFormula[i]))\n                                        || pFormula[i] === this.getParseDecimalSeparator()) {\n                                        s = s + pFormula[i];\n                                        i = i + 1;\n                                    }\n                                    if (i < pFormula.length && pFormula[i] === '%') {\n                                        i = i + 1;\n                                        if (s === '') {\n                                            if (stack.length > 0) {\n                                                var stackValue = stack[0];\n                                                var value = this.parseFloat(stackValue);\n                                                if (!this.isNaN(value)) {\n                                                    stack.pop();\n                                                    stack.push((value / 100).toString());\n                                                }\n                                            }\n                                        }\n                                        else {\n                                            s = (this.parseFloat(s) / 100).toString();\n                                        }\n                                    }\n                                }\n                                stack.push(s);\n                            }\n                            break;\n                        case this.parser.tokenAdd:\n                            {\n                                this.getValArithmetic(stack, 'add');\n                                i = i + 1;\n                            }\n                            break;\n                        case this.parser.tokenSubtract:\n                            {\n                                this.getValArithmetic(stack, 'sub');\n                                i = i + 1;\n                            }\n                            break;\n                        case this.parser.tokenMultiply:\n                            {\n                                this.getValArithmetic(stack, 'mul');\n                                i = i + 1;\n                            }\n                            break;\n                        case this.parser.tokenDivide:\n                            {\n                                this.getValArithmetic(stack, 'div');\n                                i = i + 1;\n                            }\n                            break;\n                        case this.parser.tokenLess:\n                            {\n                                this.processLogical(stack, 'less');\n                                i = i + 1;\n                            }\n                            break;\n                        case this.parser.tokenGreater:\n                            {\n                                this.processLogical(stack, 'greater');\n                                i = i + 1;\n                            }\n                            break;\n                        case this.parser.tokenGreaterEq:\n                            {\n                                this.processLogical(stack, 'greaterEq');\n                                i = i + 1;\n                            }\n                            break;\n                        case this.parser.tokenLessEq:\n                            {\n                                this.processLogical(stack, 'lessEq');\n                                i = i + 1;\n                            }\n                            break;\n                        case this.parser.tokenNotEqual:\n                            {\n                                this.processLogical(stack, 'notEq');\n                                i = i + 1;\n                            }\n                            break;\n                        case this.parser.tokenOr:\n                            {\n                                this.processLogical(stack, 'or');\n                                i = i + 1;\n                            }\n                            break;\n                        case this.parser.tokenAnd:\n                            {\n                                this.processLogical(stack, 'and');\n                                i = i + 1;\n                            }\n                            break;\n                        case this.parser.tokenEqual:\n                            {\n                                this.processLogical(stack, 'equal');\n                                i = i + 1;\n                            }\n                            break;\n                        default: {\n                            return this.getErrorStrings()[CommonErrors.value];\n                        }\n                    }\n                }\n            }\n            if (stack.length === 0) {\n                return this.emptyString;\n            }\n            else {\n                var s = this.emptyString;\n                var countValue = stack.length;\n                while (countValue > 0) {\n                    s = stack.pop() + s;\n                    if (s === this.emptyString && this.isCellReference(pFormula) &&\n                        this.getTreatEmptyStringAsZero()) {\n                        return '0';\n                    }\n                    countValue--;\n                }\n                return s;\n            }\n        }\n        catch (ex) {\n            if (this.getErrorStrings().indexOf(ex) > -1 || this.formulaErrorStrings.indexOf(ex) > -1) {\n                throw ex;\n            }\n            throw new FormulaError(this.formulaErrorStrings[FormulasErrorsStrings.invalid_expression]);\n        }\n    };\n    Calculate.prototype.getValArithmetic = function (stack, operator) {\n        var num1 = stack.pop();\n        num1 = num1 === this.emptyString ? '0' : num1;\n        var num = Number(num1);\n        if (isNaN(num)) {\n            if (num1 === this.getErrorStrings()[CommonErrors.divzero]) {\n                throw this.getErrorStrings()[CommonErrors.divzero];\n            }\n            else {\n                throw this.getErrorStrings()[CommonErrors.value];\n            }\n        }\n        var num2 = stack.pop();\n        num2 = num2 === this.emptyString ? (stack.length ? stack.pop() : '0') : num2;\n        num = Number(num2);\n        if (isNaN(num)) {\n            if (num1 === this.getErrorStrings()[CommonErrors.divzero]) {\n                throw this.getErrorStrings()[CommonErrors.divzero];\n            }\n            else {\n                throw this.getErrorStrings()[CommonErrors.value];\n            }\n        }\n        if (operator === 'add') {\n            stack.push((Number(num2) + Number(num1)).toString());\n        }\n        if (operator === 'sub') {\n            stack.push((Number(num2) - Number(num1)).toString());\n        }\n        if (operator === 'mul') {\n            stack.push((Number(num2) * Number(num1)).toString());\n        }\n        if (operator === 'div') {\n            if (this.isNaN(this.parseFloat(num1)) || this.isNaN(this.parseFloat(num2))) {\n                stack.push(this.getErrorStrings()[CommonErrors.value]);\n            }\n            else if (this.parseFloat(num1) === 0) {\n                stack.push(this.getErrorStrings()[CommonErrors.divzero]);\n            }\n            else {\n                stack.push((Number(num2) / Number(num1)).toString());\n            }\n        }\n    };\n    /** @hidden */\n    Calculate.prototype.processLogical = function (stack, operator) {\n        var val1;\n        var val2;\n        var value1;\n        var value2;\n        if (operator !== 'and' && operator !== 'equal') {\n            val1 = stack.pop();\n            val2 = stack.pop();\n            value1 = val1.indexOf(this.tic) > -1 ? val1 : this.parseFloat(val1);\n            value2 = val2.indexOf(this.tic) > -1 ? val2 : this.parseFloat(val2);\n        }\n        var result;\n        if (operator === 'less') {\n            if (!this.isNaN(value1) && !this.isNaN(value2)) {\n                result = (value2 < value1) ? this.trueValue : this.falseValue;\n            }\n            else {\n                result = (val2.toUpperCase().split(this.tic).join('').localeCompare(val1.toUpperCase().split(this.tic).join('')) < 0) ?\n                    this.trueValue : this.falseValue;\n            }\n        }\n        if (operator === 'greater') {\n            if (!this.isNaN(value1) && !this.isNaN(value2)) {\n                result = (value2 > value1) ? this.trueValue : this.falseValue;\n            }\n            else {\n                result = (val2.toUpperCase().split(this.tic).join('').localeCompare(val1.toUpperCase().split(this.tic).join('')) > 0) ?\n                    this.trueValue : this.falseValue;\n            }\n        }\n        if (operator === 'lessEq') {\n            if (!this.isNaN(value1) && !this.isNaN(value2)) {\n                result = (value2 <= value1) ? this.trueValue : this.falseValue;\n            }\n            else {\n                result = (val2.toUpperCase().split(this.tic).join('').localeCompare(val1.toUpperCase().split(this.tic).join('')) <= 0) ?\n                    this.trueValue : this.falseValue;\n            }\n        }\n        if (operator === 'greaterEq') {\n            if (!this.isNaN(value1) && !this.isNaN(value2)) {\n                result = (value2 >= value1) ? this.trueValue : this.falseValue;\n            }\n            else {\n                result = (val2.toUpperCase().split(this.tic).join('').localeCompare(val1.toUpperCase().split(this.tic).join('')) >= 0) ?\n                    this.trueValue : this.falseValue;\n            }\n        }\n        if (operator === 'notEq') {\n            result = (val2 !== val1) ? this.trueValue : this.falseValue;\n        }\n        if (operator === 'and') {\n            val1 = stack.pop().toString();\n            val2 = '';\n            if (stack.length > 0) {\n                val2 = stack.pop().toString();\n            }\n            result = this.emptyString + val2 + val1 + this.emptyString;\n            result = result.split(this.tic).join('');\n        }\n        if (operator === 'equal') {\n            val1 = stack.pop().toString();\n            val2 = stack.pop().toString();\n            if (val2 === '' && val1 !== '') {\n                val2 = '0';\n            }\n            result = val1 === val2 ? this.trueValue : this.falseValue;\n        }\n        if (operator === 'or') {\n            result = Math.pow(this.parseFloat(value2), this.parseFloat(value1)).toString();\n        }\n        stack.push(result);\n        return result;\n    };\n    /** @hidden */\n    Calculate.prototype.computeStoreCells = function (sCell) {\n        var cellValue = sCell.cellValue;\n        var cellRanges = sCell.cellRange;\n        var criterias = sCell.criteria;\n        var argArr = sCell.argArray;\n        var isCriteria = sCell.isCriteria;\n        var storeCell = sCell.storedCells;\n        var isCountIfs = sCell.isCountIfS;\n        var i = sCell.countVal;\n        var rangeLength = isCriteria === this.trueValue ? storeCell : cellValue;\n        var tempStoredCell = [];\n        for (var j = 0; j < rangeLength.length; j++) {\n            var stack = [];\n            var cellVal = this.getValueFromArg(cellValue[j]);\n            var criteria = void 0;\n            var newCell = '';\n            criteria = argArr[2].split(this.tic).join(this.emptyString);\n            isCriteria = isCountIfs === this.trueValue ? this.trueValue : isCriteria;\n            if (isCriteria === this.trueValue) {\n                var cell = '';\n                var count = 0;\n                var newCount = 0;\n                storeCell[j] = isCountIfs === this.trueValue && i === 0 ? cellValue[j] : storeCell[j];\n                cell = storeCell[j];\n                // convert the new cell ranges  for find in range with criteria.\n                while (!this.isDigit(cell[count])) {\n                    count = count + 1;\n                }\n                if (this.isCellReference(cellRanges[i]) && cellRanges[i].indexOf(':') > -1) {\n                    var k = cellRanges[i].indexOf(':');\n                    newCell = this.substring(cellRanges[i], k);\n                    while (!this.isDigit(newCell[newCount])) {\n                        newCount = newCount + 1;\n                    }\n                }\n                var cellAlpha = this.substring(cell, count);\n                var newCellAlpha = this.substring(newCell, newCount);\n                newCell = storeCell[j].split(cellAlpha).join(newCellAlpha);\n                cellVal = this.getValueFromArg(newCell);\n                criteria = isCountIfs === this.trueValue ? criterias[i].split(this.tic).join(this.emptyString) :\n                    criterias[i - 1].split(this.tic).join(this.emptyString);\n            }\n            var op = 'equal';\n            if (criteria.startsWith('<=')) {\n                op = 'lessEq';\n                criteria = criteria.substring(2);\n            }\n            else if (criteria.startsWith('>=')) {\n                op = 'greaterEq';\n                criteria = criteria.substring(2);\n            }\n            else if (criteria.startsWith('<>')) {\n                op = 'notEq';\n                criteria = criteria.substring(2);\n            }\n            else if (criteria.startsWith('<')) {\n                op = 'less';\n                criteria = criteria.substring(1);\n            }\n            else if (criteria.startsWith('>')) {\n                op = 'greater';\n                criteria = criteria.substring(1);\n            }\n            else if (criteria.startsWith('=')) {\n                op = 'equal';\n                criteria = criteria.substring(1);\n            }\n            if (criteria.indexOf('*') > -1 || criteria.indexOf('?') > -1) {\n                cellVal = this.findWildCardValue(criteria, cellVal);\n            }\n            stack.push(cellVal.toLowerCase());\n            stack.push(criteria.toLowerCase());\n            if (this.processLogical(stack, op) === this.trueValue) {\n                if (isCriteria === this.falseValue) {\n                    tempStoredCell.push(cellValue[j]);\n                }\n                else {\n                    tempStoredCell.push(newCell);\n                }\n            }\n        }\n        storeCell = tempStoredCell;\n        tempStoredCell = [];\n        return storeCell;\n    };\n    Calculate.prototype.computeIfsFormulas = function (range, isCountIfs, isAvgIfs) {\n        if (isNullOrUndefined(range) || range[0] === '' || range.length === 0) {\n            return this.formulaErrorStrings[FormulasErrorsStrings.wrong_number_arguments];\n        }\n        var argArr = range;\n        var argCount = argArr.length;\n        if (argCount < 2 || argCount > 127) {\n            return this.formulaErrorStrings[FormulasErrorsStrings.wrong_number_arguments];\n        }\n        var cellRanges = [];\n        var criterias = [];\n        var storedCell = [];\n        var storedCellLength = 0;\n        var sum = 0;\n        for (var i = 0; i < argArr.length; i++) {\n            if (argArr[i].indexOf(':') > -1 && this.isCellReference(argArr[i])) {\n                cellRanges.push(argArr[i]);\n            }\n            else {\n                criterias.push(argArr[i]);\n            }\n        }\n        cellRanges = cellRanges.toString().split(',,').join(',');\n        cellRanges = cellRanges.split(this.getParseArgumentSeparator());\n        var len = [];\n        for (var i = 0; i < cellRanges.length; i++) {\n            len.push(this.getCellCollection(cellRanges[i]).length);\n        }\n        for (var j = 0; j < len.length; j++) {\n            if (len[j] && len[j + 1] && len[j] !== len[j + 1]) {\n                return this.getErrorStrings()[CommonErrors.value];\n            }\n        }\n        var cellvalue;\n        var isCriteria;\n        if (isCountIfs === this.falseValue) {\n            isCriteria = this.falseValue;\n            cellvalue = this.getCellCollection(cellRanges[1]);\n            var sCell = {\n                cellValue: cellvalue, cellRange: cellRanges, criteria: criterias,\n                argArray: argArr, isCriteria: isCriteria, storedCells: storedCell, isCountIfS: isCountIfs\n            };\n            storedCell = this.computeStoreCells(sCell);\n            storedCellLength = storedCell.length;\n            if (storedCellLength === 0) {\n                return 0;\n            }\n        }\n        // Compare criteria and convert the new cell ranges.\n        var startRange;\n        startRange = isCountIfs === this.trueValue ? 0 : 2;\n        for (var i = startRange; i < cellRanges.length; i++) {\n            isCriteria = this.trueValue;\n            isCriteria = isCountIfs === this.trueValue && i === 0 ? this.falseValue : this.trueValue;\n            cellvalue = this.getCellCollection(cellRanges[i]);\n            var sCell = {\n                cellValue: cellvalue, cellRange: cellRanges, criteria: criterias,\n                argArray: argArr, isCriteria: isCriteria, storedCells: storedCell, isCountIfS: isCountIfs, countVal: i\n            };\n            storedCell = this.computeStoreCells(sCell);\n            storedCellLength = storedCell.length;\n            if (storedCellLength === 0) {\n                return 0;\n            }\n        }\n        for (var j = 0; j < storedCell.length; j++) {\n            // convert the new cell ranges  for find sum in range 0(first range)\n            var cell = '';\n            var newCell = '';\n            var count = 0;\n            var newCount = 0;\n            cell = storedCell[j];\n            while (!this.isDigit(cell[count])) {\n                count = count + 1;\n            }\n            if (this.isCellReference(cellRanges[0]) && cellRanges[0].indexOf(':') > -1) {\n                var k = cellRanges[0].indexOf(':');\n                newCell = this.substring(cellRanges[0], k);\n                while (!this.isDigit(newCell[newCount])) {\n                    newCount = newCount + 1;\n                }\n            }\n            var cellAlpha = this.substring(cell, count);\n            var newCellAlpha = this.substring(newCell, newCount);\n            cellvalue = storedCell[j].split(cellAlpha).join(newCellAlpha);\n            if (isCountIfs === this.trueValue) {\n                sum = sum + 1;\n            }\n            else {\n                var argValue = this.getValueFromArg(cellvalue);\n                sum = sum + parseFloat(argValue === '' ? '0' : argValue);\n            }\n        }\n        if (isAvgIfs === this.trueValue) {\n            sum = sum / cellvalue.length;\n        }\n        return sum;\n    };\n    Calculate.prototype.processNestedFormula = function (pText, sFormula, fResult) {\n        var lastIndexq = this.findLastIndexOfq(pText);\n        var interiorCalcFString = pText.split(sFormula).join('n' + fResult);\n        return interiorCalcFString;\n    };\n    /** @hidden */\n    Calculate.prototype.isNaN = function (value) {\n        if (value.toString() === 'NaN' || typeof value === 'string') {\n            return true;\n        }\n        return false;\n    };\n    /** @hidden */\n    Calculate.prototype.fromOADate = function (doubleNumber) {\n        var result = new Date();\n        result.setTime((doubleNumber * this.millisecondsOfaDay) + Date.parse(this.oaDate.toString()));\n        return result;\n    };\n    /** @hidden */\n    Calculate.prototype.getSerialDateFromDate = function (year, month, day) {\n        var days = 0;\n        if (year < 1900) {\n            year += 1900;\n        }\n        var isValidMonth = false;\n        while (!isValidMonth) {\n            while (month > 12) {\n                year++;\n                month -= 12;\n            }\n            isValidMonth = true;\n            var tempDay = new Date(year, month, 1, -1).getDate();\n            while (day > tempDay) {\n                tempDay = new Date(year, month, 1, -1).getDate();\n                month++;\n                day -= tempDay;\n                isValidMonth = false;\n            }\n            if (day < 1) {\n                month--;\n                tempDay = new Date(year, month, 1, -1).getDate();\n                day = tempDay - day;\n            }\n        }\n        var dateTime = Date.parse(year.toString() + this.getParseDateTimeSeparator() + month.toString() +\n            this.getParseDateTimeSeparator() + day.toString());\n        if (!this.isNaN(dateTime)) {\n            days = this.toOADate(new Date(dateTime));\n        }\n        return days;\n    };\n    /** @hidden */\n    Calculate.prototype.toOADate = function (dateTime) {\n        var result = (dateTime.getTime() - Date.parse(this.oaDate.toString())) / this.millisecondsOfaDay;\n        return result;\n    };\n    /** @hidden */\n    Calculate.prototype.calculateDate = function (date) {\n        return (this.parseFloat(date) < 10) ? '0' + date : date;\n    };\n    /** @hidden */\n    Calculate.prototype.isTextEmpty = function (s) {\n        return s === null || s === '';\n    };\n    /** @hidden */\n    Calculate.prototype.isDigit = function (text) {\n        var charCode = text.charCodeAt(0);\n        if ((charCode > 47) && (charCode < 58)) {\n            return true;\n        }\n        return false;\n    };\n    Calculate.prototype.findLastIndexOfq = function (fString) {\n        return fString.lastIndexOf('q');\n    };\n    /**\n     * To get the exact value from argument.\n     * @param {string} arg - Formula argument for getting a exact value.\n     * @returns string\n     */\n    Calculate.prototype.getValueFromArg = function (arg) {\n        arg = arg.trim();\n        var s = arg;\n        var dateTime = this.dateTime1900;\n        var pObjCVal = s;\n        if (isNullOrUndefined(s) || this.isTextEmpty(s)) {\n            return s;\n        }\n        else if (arg[0] === this.tic || arg[0] === this.singleTic) {\n            dateTime = this.isDate(arg.split(this.tic).join(''));\n            if (this.isNaN(this.parseFloat(arg.split(this.tic).join(''))) && !isNullOrUndefined(dateTime) &&\n                !this.isNaN(dateTime.getDate()) && this.dateTime1900 <= dateTime) {\n                return this.toOADate(dateTime).toString();\n            }\n            return arg;\n        }\n        else {\n            arg = arg.split('u').join('-');\n            /* tslint:disable:max-line-length */\n            if (!this.isUpperChar(s[0]) && (this.isDigit(s[0]) || s[0] === this.getParseDecimalSeparator() || s[0] === '-' || s[0] === 'n')) {\n                if (s[0] === 'n') {\n                    s = s.substring(1);\n                    if (s.indexOf('\"n') > -1) {\n                        s = s.replace('\"n', '\"');\n                    }\n                }\n                return s;\n            }\n        }\n        var symbolArray = ['+', '-', '/', '*', ')', ')', '{'];\n        if ((this.parser.indexOfAny(s, symbolArray) === -1 && this.isUpperChar(s[0])) || s[0] === this.sheetToken) {\n            if (s !== this.trueValue && s !== this.falseValue && this.isCellReference(s)) {\n                var f = this.getSheetFamilyItem(this.grid);\n                if (f.sheetNameToParentObject !== null && f.sheetNameToParentObject.size > 0 && s.indexOf(this.sheetToken) === -1) {\n                    var token = f.parentObjectToToken.get(this.grid);\n                    s = token + s;\n                }\n            }\n            if (s === this.cell) {\n                var dependent = this.getDependentCells().get(s);\n                if (dependent != null && dependent.indexOf(s) > -1) {\n                    this.arrayRemove(dependent, s);\n                }\n                if (!this.getDependentFormulaCells().has(this.cell)) {\n                    this.clearFormulaDependentCells(this.cell);\n                }\n                throw this.formulaErrorStrings[FormulasErrorsStrings.circular_reference] + s;\n            }\n            pObjCVal = this.getParentObjectCellValue(s);\n            this.updateDependentCell(s);\n            return pObjCVal.toString();\n        }\n        if (this.getErrorStrings().indexOf(arg) > -1) {\n            return arg;\n        }\n        return this.computeValue(pObjCVal.toString());\n    };\n    /* tslint:disable-next-line */\n    Calculate.prototype.isDate = function (date) {\n        if (typeof date === 'object' || Date.parse(date) !== null) {\n            var dateval = new Date(Date.parse(date));\n            if (dateval >= this.dateTime1900) {\n                return dateval;\n            }\n            else {\n                return null;\n            }\n        }\n        else {\n            return null;\n        }\n    };\n    Calculate.prototype.isValidCellReference = function (text) {\n        var start = 0;\n        var end = 0;\n        var j = 0;\n        var numArr = [89, 71, 69];\n        var cellTxt = this.emptyString;\n        if (this.namedRanges.has(text)) {\n            return false;\n        }\n        for (var i = 0; i < text.length; i++) {\n            if (this.isChar(text[i])) {\n                end++;\n            }\n        }\n        cellTxt = text.substring(start, end);\n        if (cellTxt.length < 4) {\n            while (j < cellTxt.length) {\n                if (!isNullOrUndefined(cellTxt[j]) && cellTxt[j].charCodeAt(0) < numArr[j]) {\n                    j++;\n                    continue;\n                }\n                else if (isNullOrUndefined(cellTxt[j]) && j > 0) {\n                    break;\n                }\n                else {\n                    return false;\n                }\n            }\n            var cellNum = this.parseFloat(text.substring(end, text.length));\n            if (cellNum < 1048576) { // Maximum number of rows in excel.\n                return true;\n            }\n        }\n        return false;\n    };\n    /** @hidden */\n    /* tslint:disable-next-line */\n    Calculate.prototype.parseDate = function (date) {\n        if (!this.isNaN(date)) {\n            if (date instanceof Date) {\n                return new Date(date);\n            }\n            var d = parseInt(date, 10);\n            if (d < 0) {\n                return this.getErrorStrings()[CommonErrors.num];\n            }\n            if (d <= 60) {\n                return new Date(this.dateTime1900.getTime() + (d - 1) * 86400000);\n            }\n            return new Date(this.dateTime1900.getTime() + (d - 2) * 86400000);\n        }\n        if (typeof date === 'string') {\n            date = new Date(date);\n            if (!this.isNaN(date)) {\n                return date;\n            }\n        }\n        return this.getErrorStrings()[CommonErrors.value];\n    };\n    /** @hidden */\n    Calculate.prototype.isCellReference = function (args) {\n        if (args === this.emptyString) {\n            return false;\n        }\n        args = args.trim();\n        args = this.setTokensForSheets(args);\n        var sheetToken1 = this.getSheetToken(args);\n        var containsBoth = false;\n        if (sheetToken1 !== '') {\n            args = args.split(sheetToken1).join(this.emptyString);\n        }\n        var isAlpha = false;\n        var isNum = false;\n        if (args.indexOf(':') !== args.lastIndexOf(':')) {\n            return false;\n        }\n        var charArray = (args.split('').join(this.getParseArgumentSeparator())).split(this.getParseArgumentSeparator());\n        for (var c = 0; c < charArray.length; c++) {\n            if (this.isChar(charArray[c])) {\n                isAlpha = true;\n            }\n            else if (this.isDigit(charArray[c])) {\n                isNum = true;\n            }\n            else if (charArray[c] === ':') {\n                if (isAlpha && isNum) {\n                    containsBoth = true;\n                }\n                isAlpha = false;\n                isNum = false;\n            }\n            else {\n                return false;\n            }\n        }\n        if (args.indexOf(':') > -1 && args.indexOf(this.tic) === -1) {\n            if (containsBoth && isAlpha && isNum) {\n                return true;\n            }\n            else if (((isAlpha && !isNum) || (!isAlpha && isNum)) && !containsBoth) {\n                return true;\n            }\n            else {\n                return false;\n            }\n        }\n        if (isAlpha && isNum && args.indexOf(this.tic) === -1) {\n            return true;\n        }\n        return false;\n    };\n    /** @hidden */\n    Calculate.prototype.setTokensForSheets = function (text) {\n        var family = this.getSheetFamilyItem(this.grid);\n        var sortedSheetNamesCollection = this.getSortedSheetNames();\n        if (sortedSheetNamesCollection != null) {\n            for (var n = 0; n < sortedSheetNamesCollection.length; n++) {\n                var token = family.sheetNameToToken.get(sortedSheetNamesCollection[n]);\n                token = token.split(this.sheetToken).join(this.tempSheetPlaceHolder);\n                var s = this.singleTic + 'SHEET' + sortedSheetNamesCollection[n] + this.singleTic + this.sheetToken;\n                if (text.indexOf(s) === -1) {\n                    s = 'SHEET' + sortedSheetNamesCollection[n] + this.sheetToken;\n                }\n                text = text.split(s).join(token);\n                s = sortedSheetNamesCollection[n] + this.sheetToken;\n                text = text.split(s).join(token);\n            }\n        }\n        text = text.split(this.tempSheetPlaceHolder).join(this.sheetToken);\n        if (text.indexOf('!!') > -1) {\n            text = text.replace('!!', '!');\n            var textSplit = text.split('');\n            textSplit[1] = (parseInt(textSplit[1], 10) + 1).toString();\n            text = textSplit.join('');\n        }\n        return text;\n    };\n    Calculate.prototype.getParentObjectCellValue = function (val) {\n        if (val === this.trueValue || val === this.falseValue) {\n            return val;\n        }\n        var i = val.lastIndexOf(this.sheetToken);\n        var row = 0;\n        var col = 0;\n        var grid = this.grid;\n        var family = this.getSheetFamilyItem(grid);\n        if (i > -1 && family.tokenToParentObject !== null) {\n            this.grid = family.tokenToParentObject.get(val.substring(0, i + 1));\n            row = this.rowIndex(val);\n            col = this.colIndex(val);\n        }\n        else if (i === -1) {\n            var j = 0;\n            while (j < val.length && this.isChar(val[j])) {\n                j++;\n            }\n            if (j === val.length) {\n                val = val.toLowerCase();\n                return val === '' ? this.getErrorStrings()[CommonErrors.value] : this.getErrorStrings()[CommonErrors.name];\n            }\n            else {\n                row = this.rowIndex(val);\n                col = this.colIndex(val);\n                if (family.isSheetMember && family.parentObjectToToken != null) {\n                    val = family.parentObjectToToken.get(this.grid) + val;\n                }\n            }\n        }\n        var saveCell = (this.cell === '' || this.cell === null) ? '' : this.cell;\n        this.cell = val;\n        if (saveCell === this.cell) {\n            throw this.formulaErrorStrings[FormulasErrorsStrings.circular_reference];\n        }\n        var cValue = this.getParentCellValue(row, col, this.grid);\n        this.grid = grid;\n        this.cell = saveCell;\n        return cValue;\n    };\n    Calculate.prototype.getParentCellValue = function (row, col, grd) {\n        var alreadyComputed = false;\n        // formulainfotable\n        var cValue;\n        /* tslint:disable-next-line */\n        if (this.parentObject.getValueRowCol === undefined) {\n            cValue = this.getValueRowCol(this.getSheetID(grd), row, col);\n        }\n        else {\n            /* tslint:disable-next-line */\n            cValue = this.parentObject.getValueRowCol(this.getSheetID(grd), row, col);\n            return isNullOrUndefined(cValue) ? this.emptyString : cValue.toString();\n        }\n        if (cValue === '' || cValue === undefined) {\n            cValue = '';\n        }\n        // if (cValue[cValue.length - 1] == (\"%\") && !this.isNaN(d)) {\n        //     cValue = (Number(d) / 100).toString();\n        // }\n        return cValue;\n    };\n    /**\n     * Getting the formula result.\n     * @param {Object} grid - Specifies the parent object.\n     * @param {number} row - Row index of the parent object or key.\n     * @param {number} col - Column index of the parent object.\n     * @returns string\n     */\n    Calculate.prototype.getValueRowCol = function (grid, row, col) {\n        var key = this.rowsToKeyMap.get(row).toString();\n        var result = this.getKeyValue(key).toString();\n        if (result != null && result[result.length - 1] === ('%') && result.length > 1) {\n            var d = this.parseFloat(result.substring(0, result.length - 1));\n            if (this.isNaN(d)) {\n                result = (Number(d) / 100).toString();\n            }\n        }\n        return result;\n    };\n    /**\n     * To add custom library formula.\n     * @param {string} formulaName - Custom Formula name.\n     * @param {string} functionName - Custom function name.\n     * @returns void\n     */\n    Calculate.prototype.defineFunction = function (formulaName, functionName) {\n        if (typeof functionName === 'string') {\n            functionName = getValue(functionName, window);\n        }\n        formulaName = formulaName.toUpperCase();\n        this.libraryFormulas.set(formulaName, { handler: functionName, isCustom: true });\n    };\n    /**\n     * Specifies when changing the value.\n     * @param {string} grid - Parent object reference name.\n     * @param {ValueChangedArgs} changeArgs - Value changed arguments.\n     * @param {boolean} isCalculate - Value that allow to calculate.\n     */\n    Calculate.prototype.valueChanged = function (grid, changeArgs, isCalculate) {\n        var pgrid = grid;\n        this.grid = grid;\n        var isComputedValueChanged = true;\n        var isCompute = true;\n        var calcFamily = this.getSheetFamilyItem(pgrid);\n        var cellTxt = getAlphalabel(changeArgs.getColIndex()) + changeArgs.getRowIndex().toString();\n        if (calcFamily.sheetNameToParentObject !== null && calcFamily.sheetNameToParentObject.size > 0) {\n            var token = calcFamily.parentObjectToToken.get(pgrid);\n            cellTxt = token + cellTxt;\n        }\n        var argVal = changeArgs.getValue().toUpperCase();\n        if (argVal.indexOf('=RAND()') > -1 || argVal.indexOf('RAND()') > -1 || argVal.indexOf('=RANDBETWEEN(') > -1 ||\n            argVal.indexOf('RANDBETWEEN(') > -1 || this.randomValues.has(cellTxt)) {\n            var randStrVal = this.randCollection.toString();\n            if (!this.randomValues.has(cellTxt)) {\n                this.randomValues.set(cellTxt, changeArgs.getValue());\n                this.randCollection.push(cellTxt);\n                this.isRandomVal = true;\n            }\n            else if (this.randomValues.has(cellTxt)) {\n                if (argVal.indexOf('=RAND()') > -1 || argVal.indexOf('RAND()') > -1 || argVal.indexOf('=RANDBETWEEN(') > -1 ||\n                    argVal.indexOf('RANDBETWEEN(') > -1) {\n                    this.randomValues.set(cellTxt, changeArgs.getValue());\n                }\n                else if (changeArgs.getValue().toUpperCase() !== this.randomValues.get(cellTxt.toUpperCase())) {\n                    this.randomValues.delete(cellTxt);\n                    randStrVal = randStrVal.split(cellTxt + this.parseArgumentSeparator).join('').split(this.parseArgumentSeparator + cellTxt).join('').split(cellTxt).join('');\n                    this.randCollection = randStrVal.split(this.parseArgumentSeparator);\n                }\n                if (this.randomValues.size === 0 && this.randCollection.length) {\n                    this.isRandomVal = false;\n                    this.randomValues.clear();\n                    this.randCollection = [];\n                }\n            }\n        }\n        if (changeArgs.getValue() && changeArgs.getValue()[0] === this.getFormulaCharacter()) {\n            this.cell = cellTxt;\n            var formula = void 0;\n            if (!isNullOrUndefined(isCompute)) {\n                isCompute = isCalculate;\n            }\n            if (this.getFormulaInfoTable().has(cellTxt)) {\n                formula = this.getFormulaInfoTable().get(cellTxt);\n                if (changeArgs.getValue() !== formula.getFormulaText() || formula.getParsedFormula() == null) {\n                    formula.setFormulaText(changeArgs.getValue());\n                    if (this.getDependentFormulaCells().has(this.cell)) {\n                        this.clearFormulaDependentCells(this.cell);\n                    }\n                    try {\n                        formula.setParsedFormula(this.parser.parseFormula(changeArgs.getValue()));\n                    }\n                    catch (ex) {\n                        formula.setFormulaValue(ex);\n                        isCompute = false;\n                    }\n                }\n                if (isCompute) {\n                    this.parser.isFormulaParsed = true;\n                    var cValue = this.computeFormula(formula.getParsedFormula());\n                    isComputedValueChanged = (cValue !== formula.getFormulaValue());\n                    formula.setFormulaValue(cValue);\n                }\n            }\n            else {\n                formula = new FormulaInfo();\n                formula.setFormulaText(changeArgs.getValue());\n                if (!this.getDependentFormulaCells().has(cellTxt)) {\n                    this.getDependentFormulaCells().set(cellTxt, new Map());\n                }\n                try {\n                    formula.setParsedFormula(this.parser.parseFormula(changeArgs.getValue()));\n                }\n                catch (ex) {\n                    formula.setFormulaValue(ex);\n                    isCompute = false;\n                }\n                if (isCompute) {\n                    formula.setFormulaValue(this.computeFormula(formula.getParsedFormula()));\n                }\n                if (this.getFormulaInfoTable().has(cellTxt)) {\n                    this.getFormulaInfoTable().set(cellTxt, formula);\n                }\n                else {\n                    this.getFormulaInfoTable().set(cellTxt, formula);\n                }\n            }\n            if (isCompute) {\n                /* tslint:disable */\n                if (this.parentObject.setValueRowCol === undefined) {\n                    this.setValueRowCol(this.getSheetID(pgrid) + 1, formula.getFormulaValue(), changeArgs.getRowIndex(), changeArgs.getColIndex());\n                }\n                else {\n                    this.parentObject.setValueRowCol(this.getSheetID(pgrid) + 1, formula.getFormulaValue(), changeArgs.getRowIndex(), changeArgs.getColIndex());\n                }\n                /* tslint:enable */\n            }\n        }\n        else if (this.getFormulaInfoTable().has(cellTxt)) {\n            this.getFormulaInfoTable().delete(cellTxt);\n            if (this.getDependentFormulaCells().has(cellTxt)) {\n                this.clearFormulaDependentCells(cellTxt);\n            }\n        }\n        if (isCompute && isComputedValueChanged && this.getDependentCells().has(cellTxt) &&\n            this.getDependentCells().get(cellTxt).toString() !== cellTxt) {\n            this.getComputedValue().clear();\n            this.refresh(cellTxt);\n        }\n    };\n    /** @hidden */\n    Calculate.prototype.getComputedValue = function () {\n        if (this.computedValues === null) {\n            this.computedValues = new Map();\n        }\n        return this.computedValues;\n    };\n    /**\n     * @hidden\n     */\n    Calculate.prototype.setValueRowCol = function (value, formulaValue, row, col) {\n        /* No Implementation */\n    };\n    Calculate.prototype.getSortedSheetNames = function () {\n        var family = this.getSheetFamilyItem(this.grid);\n        if (family != null && family.sheetNameToToken != null) {\n            var arr_1 = [];\n            family.sheetNameToToken.forEach(function (value, key) {\n                arr_1.push(key);\n                arr_1.sort();\n            });\n            this.sortedSheetNames = arr_1;\n            this.sortedSheetNames.sort();\n        }\n        return this.sortedSheetNames;\n    };\n    /** @hidden */\n    Calculate.prototype.getErrorLine = function (error) {\n        /* tslint:disable-next-line */\n        var errorStack = error.stack ? error.stack.split('\\n')[1].split(':') : null;\n        return errorStack ? errorStack[errorStack.length - 2] : null; // Getting row number of the error file.\n    };\n    /** @hidden */\n    Calculate.prototype.createSheetFamilyID = function () {\n        if (this.sheetFamilyID === Number.MAX_SAFE_INTEGER) {\n            this.sheetFamilyID = Number.MIN_SAFE_INTEGER;\n        }\n        return this.sheetFamilyID++;\n    };\n    /** @hidden */\n    Calculate.prototype.computeMinMax = function (args, operation) {\n        var result;\n        var argVal;\n        var countStrVal = 0;\n        if (isNullOrUndefined(args) || args.length === 0) {\n            return this.formulaErrorStrings[FormulasErrorsStrings.wrong_number_arguments];\n        }\n        for (var k = 0, len = args.length; k < len; k++) {\n            if (args[k].split(this.tic).join('').trim() === this.emptyString) {\n                return this.getErrorStrings()[CommonErrors.value];\n            }\n        }\n        result = (operation === 'max') ? this.minValue : this.maxValue;\n        var argArr = args;\n        if (argArr.length > 255) {\n            return this.getErrorStrings()[CommonErrors.value];\n        }\n        for (var i = 0; i < argArr.length; i++) {\n            if (argArr[i].indexOf(':') > -1 && this.isCellReference(argArr[i])) {\n                var cellValue = this.getCellCollection(argArr[i]);\n                for (var j = 0; j < cellValue.length; j++) {\n                    argVal = this.getValueFromArg(cellValue[j]);\n                    if (this.getErrorStrings().indexOf(argVal) > -1) {\n                        return argVal;\n                    }\n                    var cellVal = this.parseFloat(argVal);\n                    if (argVal === '' || this.isNaN(this.parseFloat(cellVal))) {\n                        countStrVal = countStrVal + 1;\n                        if (countStrVal === cellValue.length) {\n                            result = 0;\n                        }\n                        continue;\n                    }\n                    else {\n                        result = (operation === 'max') ? Math.max(result, cellVal) : Math.min(result, cellVal);\n                    }\n                }\n            }\n            else {\n                var val = void 0;\n                val = this.getValueFromArg(argArr[i]);\n                if (this.getErrorStrings().indexOf(val) > -1) {\n                    return val;\n                }\n                var cellVal = this.parseFloat(val);\n                if (val === '' || this.isNaN(this.parseFloat(cellVal))) {\n                    countStrVal = countStrVal + 1;\n                    if (countStrVal === argVal.length) {\n                        result = 0;\n                    }\n                    continue;\n                }\n                else {\n                    result = (operation === 'max') ? Math.max(result, cellVal) : Math.min(result, cellVal);\n                }\n            }\n        }\n        return result.toString();\n    };\n    /** @hidden */\n    Calculate.prototype.calculateAvg = function (args) {\n        var sumCell = 0;\n        var argArr = args;\n        var cellVal = [];\n        var avgVal = 0;\n        var countNum = 0;\n        var countNum1 = 0;\n        for (var k = 0; k < argArr.length; k++) {\n            if (argArr[k].indexOf(':') > -1 && this.isCellReference(argArr[k])) {\n                countNum = 0;\n                cellVal = this.getCellCollection(argArr[k]);\n                avgVal = 0;\n                for (var i = 0; i < cellVal.length; i++) {\n                    var value = this.getValueFromArg(cellVal[i]);\n                    if (isNullOrUndefined(value) || isNaN(this.parseFloat(value))) {\n                        continue;\n                    }\n                    avgVal = avgVal + this.parseFloat(value);\n                    countNum = countNum + 1;\n                }\n                if (countNum === 0) {\n                    return this.getErrorStrings()[CommonErrors.divzero];\n                }\n                avgVal = avgVal / countNum;\n                sumCell = avgVal + sumCell;\n            }\n            else {\n                if (argArr[k].indexOf(this.tic) > -1) {\n                    if (isNaN(parseFloat(argArr[k].split(this.tic).join('')))) {\n                        return this.getErrorStrings()[CommonErrors.value];\n                    }\n                }\n                if (argArr[k].length === 0) {\n                    argArr[k] = '1';\n                }\n                var value = this.getValueFromArg(argArr[k].split(this.tic).join(''));\n                if (isNullOrUndefined(value) || isNaN(this.parseFloat(value))) {\n                    return this.getErrorStrings()[CommonErrors.name];\n                }\n                sumCell = sumCell + this.parseFloat(value);\n            }\n        }\n        return (sumCell / (argArr.length - countNum1)).toString();\n    };\n    /**\n     * @hidden\n     */\n    Calculate.prototype.registerGridAsSheet = function (refName, model, sheetFamilyID) {\n        if (isNullOrUndefined(this.modelToSheetID)) {\n            this.modelToSheetID = new Map();\n        }\n        if (isNullOrUndefined(this.modelToSheetID.get(model))) {\n            this.modelToSheetID.set(model, sheetFamilyID);\n        }\n        var family = this.getSheetFamilyItem(model);\n        family.isSheetMember = true;\n        var tempRef = refName.toUpperCase();\n        if (family.parentObjectToToken.size === 0) {\n            family.parentObjectToToken = new Map();\n        }\n        if (family.sheetNameToParentObject.size === 0) {\n            family.sheetNameToParentObject = new Map();\n        }\n        if (family.sheetNameToToken.size === 0) {\n            family.sheetNameToToken = new Map();\n        }\n        if (family.tokenToParentObject.size === 0) {\n            family.tokenToParentObject = new Map();\n        }\n        if (!isUndefined(family.sheetNameToParentObject.get(tempRef))) {\n            var token = family.sheetNameToToken.get(tempRef);\n            family.tokenToParentObject.set(token, model);\n            family.parentObjectToToken.set(model, token);\n        }\n        else {\n            var token = this.sheetToken + this.tokenCount.toString() + this.sheetToken;\n            this.tokenCount++;\n            family.tokenToParentObject.set(token, model);\n            family.parentObjectToToken.set(model, token);\n            family.sheetNameToToken.set(tempRef, token);\n            family.sheetNameToParentObject.set(tempRef, model);\n        }\n        return refName;\n    };\n    /**\n     * @hidden\n     */\n    Calculate.prototype.unregisterGridAsSheet = function (refName, model) {\n        var family = this.getSheetFamilyItem(model);\n        var refName1 = refName.toUpperCase();\n        if (family.sheetNameToParentObject != null && family.sheetNameToParentObject.has(refName1)) {\n            family.sheetNameToParentObject.delete(refName1);\n            var token = family.sheetNameToToken.get(refName1);\n            family.sheetNameToToken.delete(refName1);\n            family.tokenToParentObject.delete(token);\n            family.parentObjectToToken.delete(model);\n        }\n    };\n    ;\n    /**\n     * @hidden\n     */\n    Calculate.prototype.computeExpression = function (formula) {\n        var parsedFormula = this.parser.parseFormula(formula);\n        var calcValue = this.computeFormula(parsedFormula);\n        return calcValue;\n    };\n    ;\n    Calculate.prototype.isSheetMember = function () {\n        var family = this.getSheetFamilyItem(this.grid);\n        return isNullOrUndefined(family) ? false : family.isSheetMember;\n    };\n    /**\n     * To dispose the calculate engine.\n     * @returns void\n     */\n    Calculate.prototype.dispose = function () {\n        this.resetKeys();\n        // this.dependentCells.clear();\n        // this.dependentFormulaCells.clear();\n        this.namedRanges.clear();\n        // this.sheetFamiliesList.clear();\n        this.lFormulas.clear();\n    };\n    Calculate.prototype.refreshRandValues = function (cellRef) {\n        var rowIdx;\n        var colIdx;\n        var value;\n        var tokenRef = '';\n        var stringCollection = this.randCollection.toString();\n        var family;\n        if (this.randomValues.has(cellRef)) {\n            this.randomValues.delete(cellRef);\n            stringCollection = stringCollection.split(cellRef + this.parseArgumentSeparator).join('').split(this.parseArgumentSeparator + cellRef).join('').split(cellRef).join('');\n            if (this.randomValues.size === 0 && stringCollection === '') {\n                this.randomValues.clear();\n                this.randCollection = [];\n            }\n            else {\n                this.randCollection = stringCollection.split(this.parseArgumentSeparator);\n            }\n        }\n        for (var i = 0; i < this.randomValues.size; i++) {\n            rowIdx = this.rowIndex(this.randCollection[i]);\n            colIdx = this.colIndex(this.randCollection[i]);\n            tokenRef = (parseFloat(this.getSheetToken(this.randCollection[i]).split(this.sheetToken).join('')) + 1).toString();\n            family = this.getSheetFamilyItem(tokenRef);\n            this.grid = family.sheetNameToParentObject.get(tokenRef);\n            value = this.randomValues.get(this.randCollection[i]);\n            value = this.computeFormula(value);\n            if (this.parentObject.setValueRowCol === undefined) {\n                this.setValueRowCol(this.getSheetID(this.grid) + 1, value, rowIdx, colIdx);\n            }\n            else {\n                this.parentObject.setValueRowCol(this.getSheetID(this.grid) + 1, value, rowIdx, colIdx);\n            }\n        }\n    };\n    Calculate.prototype.refresh = function (cellRef) {\n        if (this.dependencyLevel === 0) {\n            this.refreshedCells.clear();\n        }\n        if (this.getDependentCells().has(cellRef) && this.getDependentCells().get(cellRef) !== null) {\n            var family = this.getSheetFamilyItem(this.grid);\n            this.dependencyLevel = this.dependencyLevel + 1;\n            try {\n                var dependentCells = this.getDependentCells().get(cellRef);\n                var i = void 0;\n                for (i = 0; i < dependentCells.length; i++) {\n                    var dCell = dependentCells[i];\n                    var token = this.getSheetToken(dCell);\n                    if (token.length) {\n                        this.grid = family.tokenToParentObject.get(token);\n                    }\n                    try {\n                        var rowIdx = this.rowIndex(dCell);\n                        var colIdx = this.colIndex(dCell);\n                        var formulaInfo = this.getFormulaInfoTable().get(dCell);\n                        var result = void 0;\n                        if (formulaInfo) {\n                            this.cell = dCell;\n                            if (!this.getComputedValue().has(dCell)) {\n                                this.parser.isFormulaParsed = true;\n                                result = this.computeFormula(formulaInfo.getParsedFormula());\n                                this.computedValues.set(dCell, result);\n                            }\n                            else {\n                                result = this.getComputedValue().get(dCell);\n                            }\n                            formulaInfo.setFormulaValue(result);\n                        }\n                        if (this.parentObject.setValueRowCol === undefined) {\n                            this.setValueRowCol(this.getSheetID(this.grid) + 1, formulaInfo.getFormulaValue(), rowIdx, colIdx);\n                        }\n                        else {\n                            this.parentObject.setValueRowCol(this.getSheetID(this.grid) + 1, formulaInfo.getFormulaValue(), rowIdx, colIdx);\n                        }\n                        if (!this.refreshedCells.has(dCell)) {\n                            this.refreshedCells.set(dCell, []);\n                            this.refresh(dCell);\n                        }\n                    }\n                    catch (ex) {\n                        continue;\n                    }\n                }\n            }\n            finally {\n                this.grid = family.tokenToParentObject.get(this.getSheetToken(cellRef));\n                this.dependencyLevel--;\n                if (this.dependencyLevel === 0) {\n                    this.refreshedCells.clear();\n                }\n            }\n        }\n    };\n    var Calculate_1;\n    __decorate([\n        Property(true)\n    ], Calculate.prototype, \"includeBasicFormulas\", void 0);\n    __decorate([\n        Event()\n    ], Calculate.prototype, \"onFailure\", void 0);\n    Calculate = Calculate_1 = __decorate([\n        NotifyPropertyChanges\n    ], Calculate);\n    return Calculate;\n}(Base));\nexport { Calculate };\n/** @hidden */\nvar FormulaError = /** @class */ (function () {\n    function FormulaError(errorMessage, formulaAutoCorrection) {\n        this.formulaCorrection = false;\n        this.message = errorMessage;\n        this.formulaCorrection = formulaAutoCorrection;\n    }\n    return FormulaError;\n}());\nexport { FormulaError };\n/** @hidden */\nvar FormulaInfo = /** @class */ (function () {\n    function FormulaInfo() {\n        /**\n         * @hidden\n         */\n        this.calcID = Number.MIN_VALUE + 1;\n        this.calcID1 = Number.MIN_VALUE + 1;\n    }\n    /**\n     * @hidden\n     */\n    FormulaInfo.prototype.getFormulaText = function () {\n        return this.formulaText;\n    };\n    /**\n     * @hidden\n     */\n    FormulaInfo.prototype.setFormulaText = function (value) {\n        this.formulaText = value;\n    };\n    /**\n     * @hidden\n     */\n    FormulaInfo.prototype.getFormulaValue = function () {\n        return this.formulaValue;\n    };\n    /**\n     * @hidden\n     */\n    FormulaInfo.prototype.setFormulaValue = function (value) {\n        this.formulaValue = value;\n    };\n    /**\n     * @hidden\n     */\n    FormulaInfo.prototype.getParsedFormula = function () {\n        return this.parsedFormula;\n    };\n    /**\n     * @hidden\n     */\n    FormulaInfo.prototype.setParsedFormula = function (value) {\n        this.parsedFormula = value;\n    };\n    return FormulaInfo;\n}());\nexport { FormulaInfo };\n/** @hidden */\nvar CalcSheetFamilyItem = /** @class */ (function () {\n    function CalcSheetFamilyItem() {\n        /**\n         * @hidden\n         */\n        this.isSheetMember = false;\n        /**\n         * @hidden\n         */\n        this.parentObjectToToken = new Map();\n        /**\n         * @hidden\n         */\n        this.sheetDependentCells = new Map();\n        /**\n         * @hidden\n         */\n        this.sheetDependentFormulaCells = new Map();\n        /**\n         * @hidden\n         */\n        this.sheetNameToParentObject = new Map();\n        /**\n         * @hidden\n         */\n        this.sheetNameToToken = new Map();\n        /**\n         * @hidden\n         */\n        this.tokenToParentObject = new Map();\n        /**\n         * @hidden\n         */\n        this.sheetFormulaInfotable = new Map();\n    }\n    return CalcSheetFamilyItem;\n}());\nexport { CalcSheetFamilyItem };\n/**\n * @hidden\n */\nexport function getAlphalabel(col) {\n    var cols = [];\n    var n = 0;\n    var charText = 'A';\n    while (col > 0 && n < 9) {\n        col--;\n        var aCharNo = charText.charCodeAt(0);\n        cols[n] = String.fromCharCode(col % 26 + aCharNo);\n        col = parseInt((col / 26).toString(), 10);\n        n++;\n    }\n    var chs = [];\n    for (var i = 0; i < n; i++) {\n        chs[n - i - 1] = cols[i];\n    }\n    return chs.join('');\n}\nvar ValueChangedArgs = /** @class */ (function () {\n    function ValueChangedArgs(row, col, value) {\n        this.row = row;\n        this.col = col;\n        this.value = value;\n        this.getRowIndex = function () {\n            return row;\n        };\n        this.setRowIndex = function (value) {\n            row = value;\n        };\n        this.getColIndex = function () {\n            return col;\n        };\n        this.setColIndex = function (value) {\n            col = value;\n        };\n        this.getValue = function () {\n            return value;\n        };\n        this.setValue = function (value) {\n            value = value;\n        };\n        return this;\n    }\n    return ValueChangedArgs;\n}());\nexport { ValueChangedArgs };\n","/**\n * To get Workbook required modules.\n * @hidden\n * @param {Workbook} context\n */\nexport function getWorkbookRequiredModules(context, modules) {\n    if (modules === void 0) { modules = []; }\n    modules.push({ member: 'workbookBasic', args: [] });\n    modules.push({ member: 'workbookAll', args: [] });\n    modules.push({\n        member: 'dataBind',\n        args: [context]\n    });\n    modules.push({\n        member: 'workbookProtectSheet',\n        args: [context]\n    });\n    if (context.allowSave) {\n        modules.push({\n            member: 'workbookSave',\n            args: [context]\n        });\n    }\n    if (context.allowOpen) {\n        modules.push({\n            member: 'workbookOpen',\n            args: [context]\n        });\n    }\n    if (context.allowEditing) {\n        modules.push({\n            member: 'workbookEdit',\n            args: [context]\n        });\n        modules.push({\n            member: 'workbookFormula',\n            args: [context]\n        });\n    }\n    if (context.allowNumberFormatting) {\n        modules.push({\n            member: 'workbookNumberFormat',\n            args: [context]\n        });\n    }\n    if (context.allowCellFormatting) {\n        modules.push({\n            member: 'workbookcellformat',\n            args: [context]\n        });\n    }\n    if (context.allowSorting) {\n        modules.push({ member: 'workbookSort', args: [context] });\n    }\n    if (context.allowHyperlink) {\n        modules.push({ member: 'workbookHyperlink', args: [context] });\n    }\n    if (context.allowFiltering) {\n        modules.push({ member: 'workbookFilter', args: [context] });\n    }\n    if (context.allowFindAndReplace) {\n        modules.push({ member: 'workbookfindAndReplace', args: [context] });\n    }\n    if (context.allowInsert) {\n        modules.push({ member: 'workbookinsert', args: [context] });\n    }\n    if (context.allowDelete) {\n        modules.push({ member: 'workbookdelete', args: [context] });\n    }\n    if (context.allowDataValidation) {\n        modules.push({ member: 'workbookDataValidation', args: [context] });\n    }\n    if (context.allowMerge) {\n        modules.push({ member: 'workbookmerge', args: [context] });\n    }\n    if (context.allowDataValidation) {\n        modules.push({ member: 'workbookConditionalFormatting', args: [context] });\n    }\n    if (context.allowImage) {\n        modules.push({ member: 'workbookImage', args: [context] });\n    }\n    if (context.allowChart) {\n        modules.push({ member: 'workbookChart', args: [context] });\n    }\n    return modules;\n}\n","/**\n * Check whether the text is formula or not.\n * @param text\n */\nexport function checkIsFormula(text) {\n    return text && text[0] === '=' && text.length > 1;\n}\n/**\n * Check whether the value is cell reference or not.\n * @param {string} value - Specify the value to check.\n */\nexport function isCellReference(value) {\n    var range = value;\n    range = range.split('$').join('');\n    if (range.indexOf(':') > -1) {\n        var rangeSplit = range.split(':');\n        if (isValidCellReference(rangeSplit[0]) && isValidCellReference(rangeSplit[1])) {\n            return true;\n        }\n    }\n    else if (range.indexOf(':') < 0) {\n        if (isValidCellReference(range)) {\n            return true;\n        }\n    }\n    return false;\n}\n/**\n * Check whether the value is character or not.\n * @param {string} value - Specify the value to check.\n */\nexport function isChar(value) {\n    if ((value.charCodeAt(0) >= 65 && value.charCodeAt(0) <= 90) || (value.charCodeAt(0) >= 97 && value.charCodeAt(0) <= 122)) {\n        return true;\n    }\n    return false;\n}\nexport function inRange(range, rowIdx, colIdx) {\n    return range && (rowIdx >= range[0] && rowIdx <= range[2] && colIdx >= range[1] && colIdx <= range[3]);\n}\n/**\n * Check whether the cell is locked or not\n * @hidden\n */\nexport function isLocked(cell, column) {\n    if (!cell) {\n        cell = {};\n    }\n    if (cell.isLocked) {\n        return true;\n    }\n    else if (cell.isLocked === false) {\n        return false;\n    }\n    else if (column && column.isLocked) {\n        return true;\n    }\n    else if (!cell.isLocked && (column && column.isLocked !== false)) {\n        return true;\n    }\n    return false;\n}\n/**\n * Check whether the value is cell reference or not.\n * @param {string} value - Specify the value to check.\n * @hidden\n */\nexport function isValidCellReference(value) {\n    var text = value;\n    var startNum = 0;\n    var endNum = 0;\n    var j = 0;\n    var numArr = [89, 71, 69];\n    // XFD is the last column, for that we are using ascii values of Z, G, E (89, 71, 69) to restrict the flow.\n    var cellText = '';\n    var textLength = text.length;\n    for (var i = 0; i < textLength; i++) {\n        if (isChar(text[i])) {\n            endNum++;\n        }\n    }\n    cellText = text.substring(startNum, endNum);\n    var cellTextLength = cellText.length;\n    if (cellTextLength !== textLength) {\n        if (cellTextLength < 4) {\n            if (textLength !== 1 && (isNaN(parseInt(text, 10)))) {\n                while (j < cellTextLength) {\n                    if ((cellText[j]) && cellText[j].charCodeAt(0) < numArr[j]) {\n                        j++;\n                        continue;\n                    }\n                    else if (!(cellText[j]) && j > 0) {\n                        break;\n                    }\n                    else {\n                        return false;\n                    }\n                }\n                var cellNumber = parseFloat(text.substring(endNum, textLength));\n                if (cellNumber > 0 && cellNumber < 1048577) { // 1048576 - Maximum number of rows in excel.\n                    return true;\n                }\n            }\n        }\n    }\n    return false;\n}\n","var __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    }\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nimport { extend, Property, ChildProperty, Complex, Collection, } from '@syncfusion/ej2-base';\nimport { CellStyle, wrapEvent, Chart } from '../common/index';\nimport { Image } from '../common/index';\nimport { getRow } from './index';\nimport { getSheet } from './sheet';\n/**\n * Represents the cell.\n */\nvar Cell = /** @class */ (function (_super) {\n    __extends(Cell, _super);\n    function Cell() {\n        return _super !== null && _super.apply(this, arguments) || this;\n    }\n    __decorate([\n        Collection([], Image)\n    ], Cell.prototype, \"image\", void 0);\n    __decorate([\n        Collection([], Chart)\n    ], Cell.prototype, \"chart\", void 0);\n    __decorate([\n        Property('')\n    ], Cell.prototype, \"value\", void 0);\n    __decorate([\n        Property('')\n    ], Cell.prototype, \"formula\", void 0);\n    __decorate([\n        Property(0)\n    ], Cell.prototype, \"index\", void 0);\n    __decorate([\n        Property('General')\n    ], Cell.prototype, \"format\", void 0);\n    __decorate([\n        Complex({}, CellStyle)\n    ], Cell.prototype, \"style\", void 0);\n    __decorate([\n        Property('')\n    ], Cell.prototype, \"hyperlink\", void 0);\n    __decorate([\n        Property(false)\n    ], Cell.prototype, \"wrap\", void 0);\n    __decorate([\n        Property(true)\n    ], Cell.prototype, \"isLocked\", void 0);\n    __decorate([\n        Property('')\n    ], Cell.prototype, \"validation\", void 0);\n    __decorate([\n        Property(1)\n    ], Cell.prototype, \"colSpan\", void 0);\n    __decorate([\n        Property(1)\n    ], Cell.prototype, \"rowSpan\", void 0);\n    return Cell;\n}(ChildProperty));\nexport { Cell };\n/**\n * @hidden\n */\nexport function getCell(rowIndex, colIndex, sheet, isInitRow, returnEmptyObjIfNull) {\n    var row = getRow(sheet, rowIndex);\n    if (!row || !row.cells) {\n        if (isInitRow) {\n            if (!row) {\n                sheet.rows[rowIndex] = { cells: [] };\n            }\n            else {\n                sheet.rows[rowIndex].cells = [];\n            }\n        }\n        else {\n            return returnEmptyObjIfNull ? {} : null;\n        }\n    }\n    return sheet.rows[rowIndex].cells[colIndex] || (returnEmptyObjIfNull ? {} : null);\n}\n/**\n * @hidden\n */\nexport function setCell(rowIndex, colIndex, sheet, cell, isExtend) {\n    if (!sheet.rows[rowIndex]) {\n        sheet.rows[rowIndex] = { cells: [] };\n    }\n    else if (!sheet.rows[rowIndex].cells) {\n        sheet.rows[rowIndex].cells = [];\n    }\n    if (isExtend && sheet.rows[rowIndex].cells[colIndex]) {\n        extend(sheet.rows[rowIndex].cells[colIndex], cell, null, true);\n    }\n    else {\n        sheet.rows[rowIndex].cells[colIndex] = cell;\n    }\n}\n/** @hidden */\nexport function skipDefaultValue(style, defaultKey) {\n    var defaultProps = { fontFamily: 'Calibri', verticalAlign: 'bottom', textIndent: '0pt', backgroundColor: '#ffffff',\n        color: '#000000', textAlign: 'left', fontSize: '11pt', fontWeight: 'normal', fontStyle: 'normal', textDecoration: 'none',\n        border: '', borderLeft: '', borderTop: '', borderRight: '', borderBottom: '' };\n    var changedProps = {};\n    Object.keys(defaultKey ? defaultProps : style).forEach(function (propName) {\n        if (style[propName] !== defaultProps[propName]) {\n            changedProps[propName] = style[propName];\n        }\n    });\n    return changedProps;\n}\n/** @hidden */\nexport function wrap(address, wrap, context) {\n    if (wrap === void 0) { wrap = true; }\n    var addressInfo = context.getAddressInfo(address);\n    var rng = addressInfo.indices;\n    var sheet = getSheet(context, addressInfo.sheetIndex);\n    for (var i = rng[0]; i <= rng[2]; i++) {\n        for (var j = rng[1]; j <= rng[3]; j++) {\n            setCell(i, j, sheet, { wrap: wrap }, true);\n        }\n    }\n    context.setProperties({ sheets: context.sheets }, true);\n    if (addressInfo.sheetIndex === context.activeSheetIndex) {\n        context.notify(wrapEvent, { range: rng, wrap: wrap, sheet: sheet });\n    }\n}\n","import { getSheetNameFromAddress, getSheetIndex, getSheet } from '../base/index';\nimport { getCellAddress, getIndexesFromAddress, getColumnHeaderText, updateSheetFromDataSource, checkDateFormat } from '../common/index';\nimport { queryCellInfo, cFDelete } from '../common/index';\nimport { getRow, getCell, isHiddenRow, isHiddenCol, getMaxSheetId, getSheetNameCount } from './index';\nimport { isUndefined, isNullOrUndefined } from '@syncfusion/ej2-base';\nimport { setCell } from './cell';\n/**\n * Update data source to Sheet and returns Sheet\n * @hidden\n */\nexport function getData(context, address, columnWiseData, valueOnly) {\n    return new Promise(function (resolve, reject) {\n        resolve((function () {\n            var i;\n            var cell;\n            var row;\n            var data = new Map();\n            var sheetIdx = getSheetIndex(context, getSheetNameFromAddress(address));\n            var sheet = getSheet(context, sheetIdx);\n            var indexes = getIndexesFromAddress(address);\n            var sRow = indexes[0];\n            var index = 0;\n            var args = {\n                sheet: sheet, indexes: indexes, promise: new Promise(function (resolve, reject) { resolve((function () { })()); })\n            };\n            context.notify(updateSheetFromDataSource, args);\n            return args.promise.then(function () {\n                while (sRow <= indexes[2]) {\n                    var cells = {};\n                    row = getRow(sheet, sRow);\n                    i = indexes[1];\n                    while (i <= indexes[3]) {\n                        if (columnWiseData) {\n                            if (data instanceof Map) {\n                                data = [];\n                            }\n                            var key = getColumnHeaderText(i + 1);\n                            var rowKey = '__rowIndex';\n                            if (valueOnly) {\n                                cells[key] = row ? getValueFromFormat(context, sRow, i, sheetIdx, sheet) : '';\n                            }\n                            else {\n                                cells[key] = row ? getCell(sRow, i, sheet) : null;\n                            }\n                            if (indexes[3] < i + 1) {\n                                cells[rowKey] = (sRow + 1).toString();\n                            }\n                            data[index.toString()] = cells;\n                        }\n                        else {\n                            var cellObj = {};\n                            Object.assign(cellObj, row ? getCell(sRow, i, sheet) : null);\n                            if (cellObj.colSpan > 1 && cellObj.rowSpan > 1) {\n                                var cell_1 = void 0;\n                                for (var j = sRow, len = sRow + cellObj.rowSpan; j < len; j++) {\n                                    for (var k = i, len_1 = i + cellObj.colSpan; k < len_1; k++) {\n                                        if (j === sRow && k === i) {\n                                            continue;\n                                        }\n                                        cell_1 = new Object();\n                                        if (j !== sRow) {\n                                            cell_1.rowSpan = sRow - j;\n                                        }\n                                        if (k !== i) {\n                                            cell_1.colSpan = i - k;\n                                        }\n                                        if (sheet.rows[j] && sheet.rows[j].cells && sheet.rows[j].cells[k]) {\n                                            delete sheet.rows[j].cells[k].value;\n                                            delete sheet.rows[j].cells[k].formula;\n                                        }\n                                        setCell(j, k, sheet, cell_1, true);\n                                    }\n                                }\n                            }\n                            else if (cellObj.colSpan > 1) {\n                                for (var j = i + 1, len = i + cellObj.colSpan; j < len; j++) {\n                                    setCell(sRow, j, sheet, { colSpan: i - j }, true);\n                                    if (sheet.rows[sRow] && sheet.rows[sRow].cells && sheet.rows[sRow].cells[j]) {\n                                        delete sheet.rows[sRow].cells[j].value;\n                                        delete sheet.rows[sRow].cells[j].formula;\n                                    }\n                                }\n                            }\n                            else if (cellObj.rowSpan > 1) {\n                                for (var j = sRow + 1, len = sRow + cellObj.rowSpan; j < len; j++) {\n                                    setCell(j, i, sheet, { rowSpan: sRow - j }, true);\n                                    if (sheet.rows[j] && sheet.rows[j].cells && sheet.rows[j].cells[i]) {\n                                        delete sheet.rows[j].cells[i].value;\n                                        delete sheet.rows[j].cells[i].formula;\n                                    }\n                                }\n                            }\n                            if (!valueOnly && isHiddenRow(sheet, sRow)) {\n                                sRow++;\n                                continue;\n                            }\n                            if (!valueOnly && isHiddenCol(sheet, i)) {\n                                i++;\n                                continue;\n                            }\n                            if (cellObj.style) {\n                                var style = {};\n                                Object.assign(style, cellObj.style);\n                                cellObj.style = style;\n                            }\n                            var eventArgs = { cell: cellObj, address: getCellAddress(sRow, i) };\n                            context.trigger(queryCellInfo, eventArgs);\n                            data.set(eventArgs.address, eventArgs.cell);\n                        }\n                        i++;\n                    }\n                    sRow++;\n                    index++;\n                }\n                return data;\n            });\n        })());\n    });\n}\nfunction getValueFromFormat(context, rowIndex, colIndex, sheetIdx, sheet) {\n    var cell = getCell(rowIndex, colIndex, sheet);\n    if (cell) {\n        if (cell.format) {\n            var args = {\n                value: context.getDisplayText(cell), rowIndex: rowIndex, colIndex: colIndex,\n                sheetIndex: sheetIdx, dateObj: '', isDate: false, isTime: false\n            };\n            context.notify(checkDateFormat, args);\n            if (args.isDate) {\n                return args.dateObj;\n            }\n            else {\n                return cell.value;\n            }\n        }\n        else {\n            return cell.value;\n        }\n    }\n    else {\n        return '';\n    }\n}\n/**\n * @hidden\n */\nexport function getModel(model, idx) {\n    var diff;\n    var j;\n    var prevIdx;\n    if (isUndefined(model[idx]) || !(model[idx] && model[idx].index === idx)) {\n        for (var i = 0; i <= idx; i++) {\n            if (model && model[i]) {\n                diff = model[i].index - i;\n                if (diff > 0) {\n                    model.forEach(function (value, index) {\n                        if (value && value.index) {\n                            prevIdx = value.index;\n                            j = 1;\n                        }\n                        if (value && !value.index && index !== 0) {\n                            value.index = prevIdx + j;\n                        }\n                        j++;\n                    });\n                    while (diff--) {\n                        model.splice(i, 0, null);\n                    }\n                    i += diff;\n                }\n            }\n            else if (model) {\n                model[i] = null;\n            }\n            else {\n                model = [];\n            }\n        }\n    }\n    return model[idx];\n}\n/**\n * @hidden\n */\nexport function processIdx(model, isSheet, context) {\n    var j;\n    var diff = 0;\n    var cnt;\n    var len = model.length;\n    var _loop_1 = function (i) {\n        if (!isNullOrUndefined(model[i]) && !isUndefined(model[i].index)) {\n            cnt = diff = model[i].index - i;\n            delete model[i].index;\n        }\n        if (diff > 0) {\n            j = 0;\n            while (diff--) {\n                if (isSheet) {\n                    context.createSheet(i + j);\n                    j++;\n                }\n                else {\n                    model.splice(i, 0, null);\n                }\n            }\n            i += cnt;\n            len += cnt;\n        }\n        if (isSheet) {\n            if (model[i].id < 1) {\n                model[i].id = getMaxSheetId(context.sheets);\n            }\n            if (!model[i].name) {\n                context.setSheetPropertyOnMute(model[i], 'name', 'Sheet' + getSheetNameCount(context));\n            }\n            var cellCnt_1 = 0;\n            model[i].rows.forEach(function (row) {\n                cellCnt_1 = Math.max(cellCnt_1, (row && row.cells && row.cells.length - 1) || 0);\n            });\n            context.setSheetPropertyOnMute(model[i], 'usedRange', { rowIndex: model[i].rows.length - 1, colIndex: cellCnt_1 });\n        }\n        out_i_1 = i;\n    };\n    var out_i_1;\n    for (var i = 0; i < len; i++) {\n        _loop_1(i);\n        i = out_i_1;\n    }\n}\n/**\n * @hidden\n */\nexport function clearRange(context, address, sheetIdx, valueOnly) {\n    var sheet = getSheet(context, sheetIdx);\n    var range = getIndexesFromAddress(address);\n    var sRIdx = range[0];\n    var eRIdx = range[2];\n    var sCIdx;\n    var eCIdx;\n    for (sRIdx; sRIdx <= eRIdx; sRIdx++) {\n        sCIdx = range[1];\n        eCIdx = range[3];\n        for (sCIdx; sCIdx <= eCIdx; sCIdx++) {\n            var cell = getCell(sRIdx, sCIdx, sheet);\n            context.notify(cFDelete, { rowIdx: sRIdx, colIdx: sCIdx });\n            if (!isNullOrUndefined(cell) && valueOnly) {\n                delete cell.value;\n                if (!isNullOrUndefined(cell.formula)) {\n                    delete cell.formula;\n                }\n            }\n        }\n    }\n}\n","var __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    }\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nimport { processIdx } from './data';\nimport { ConditionalFormat } from '../common/index';\nimport { ProtectSettings } from '../common/index';\nimport { isUndefined, ChildProperty, Property, Complex, Collection } from '@syncfusion/ej2-base';\n/**\n * Configures the range processing for the spreadsheet.\n *  ```html\n * <div id='Spreadsheet'></div>\n * ```\n * ```typescript\n * let spreadsheet: Spreadsheet = new Spreadsheet({\n *      sheets: [{\n *                  name: 'First Sheet',\n *                  ranges: [{ dataSource: defaultData }],\n *                  rows: [{\n *                          index: 30,\n *                          cells: [{ index: 4, value: 'Total Amount:' },\n *                                  { formula: '=SUM(F2:F30)', style: { fontWeight: 'bold' } }]\n *                  }]\n * ...\n * });\n * spreadsheet.appendTo('#Spreadsheet');\n * ```\n */\nvar Range = /** @class */ (function (_super) {\n    __extends(Range, _super);\n    function Range() {\n        return _super !== null && _super.apply(this, arguments) || this;\n    }\n    Range.prototype.setProperties = function (prop, muteOnChange) {\n        var _this = this;\n        var name = 'name';\n        var instance = 'instance';\n        var parentObj = 'parentObj';\n        var currRangeIdx = 'currRangeIdx';\n        var controlParent = 'controlParent';\n        if (this[parentObj].isComplexArraySetter && this[controlParent] && this[controlParent].isAngular) {\n            if (Object.keys(prop).length) {\n                if (this[parentObj][currRangeIdx] === undefined) {\n                    this[parentObj][currRangeIdx] = 0;\n                }\n                else {\n                    this[parentObj][currRangeIdx] += 1;\n                }\n                var range = this[parentObj].ranges[this[parentObj][currRangeIdx]];\n                if (range && range.info) {\n                    this.info = range.info;\n                }\n                setTimeout(function () {\n                    if (_this[parentObj][currRangeIdx] !== undefined) {\n                        delete _this[parentObj][currRangeIdx];\n                    }\n                });\n            }\n            else if (this[controlParent].tagObjects[0].instance && this[controlParent].tagObjects[0].instance.hasChanges\n                && !this[controlParent].tagObjects[0].instance.isInitChanges) {\n                var sheetIdx = this[controlParent].sheets.indexOf(this[parentObj]);\n                if (this[parentObj].changedRangeIdx === undefined) {\n                    var rangeIdx_1;\n                    var tagObjects = this[controlParent].tagObjects[0].instance.list[sheetIdx].tagObjects;\n                    for (var i = 0; i < tagObjects.length; i++) {\n                        if (tagObjects[i][name] === 'ranges') {\n                            tagObjects[i][instance].list\n                                .forEach(function (range, idx) {\n                                if (range.hasChanges) {\n                                    rangeIdx_1 = idx;\n                                }\n                            });\n                            break;\n                        }\n                    }\n                    this[parentObj].changedRangeIdx = rangeIdx_1;\n                }\n            }\n        }\n        _super.prototype.setProperties.call(this, prop, muteOnChange);\n    };\n    __decorate([\n        Property(null)\n    ], Range.prototype, \"dataSource\", void 0);\n    __decorate([\n        Property('A1')\n    ], Range.prototype, \"startCell\", void 0);\n    __decorate([\n        Property(null)\n    ], Range.prototype, \"query\", void 0);\n    __decorate([\n        Property(true)\n    ], Range.prototype, \"showFieldAsHeader\", void 0);\n    __decorate([\n        Property('')\n    ], Range.prototype, \"template\", void 0);\n    __decorate([\n        Property('A1')\n    ], Range.prototype, \"address\", void 0);\n    return Range;\n}(ChildProperty));\nexport { Range };\n/**\n * Used range which contains end row index and end column index of the last used cell in sheet .\n */\nvar UsedRange = /** @class */ (function (_super) {\n    __extends(UsedRange, _super);\n    function UsedRange() {\n        return _super !== null && _super.apply(this, arguments) || this;\n    }\n    __decorate([\n        Property(0)\n    ], UsedRange.prototype, \"rowIndex\", void 0);\n    __decorate([\n        Property(0)\n    ], UsedRange.prototype, \"colIndex\", void 0);\n    return UsedRange;\n}(ChildProperty));\nexport { UsedRange };\n/**\n * Configures the sheet behavior for the spreadsheet.\n */\nvar Sheet = /** @class */ (function (_super) {\n    __extends(Sheet, _super);\n    function Sheet() {\n        return _super !== null && _super.apply(this, arguments) || this;\n    }\n    __decorate([\n        Property(null)\n    ], Sheet.prototype, \"rows\", void 0);\n    __decorate([\n        Property([])\n    ], Sheet.prototype, \"columns\", void 0);\n    __decorate([\n        Complex({}, ProtectSettings)\n    ], Sheet.prototype, \"protectSettings\", void 0);\n    __decorate([\n        Collection([], Range)\n    ], Sheet.prototype, \"ranges\", void 0);\n    __decorate([\n        Collection([], ConditionalFormat)\n    ], Sheet.prototype, \"conditionalFormats\", void 0);\n    __decorate([\n        Property(0)\n    ], Sheet.prototype, \"index\", void 0);\n    __decorate([\n        Property('')\n    ], Sheet.prototype, \"name\", void 0);\n    __decorate([\n        Property(100)\n    ], Sheet.prototype, \"rowCount\", void 0);\n    __decorate([\n        Property(100)\n    ], Sheet.prototype, \"colCount\", void 0);\n    __decorate([\n        Property('A1:A1')\n    ], Sheet.prototype, \"selectedRange\", void 0);\n    __decorate([\n        Property('A1')\n    ], Sheet.prototype, \"activeCell\", void 0);\n    __decorate([\n        Property({})\n    ], Sheet.prototype, \"usedRange\", void 0);\n    __decorate([\n        Property('A1')\n    ], Sheet.prototype, \"topLeftCell\", void 0);\n    __decorate([\n        Property(true)\n    ], Sheet.prototype, \"showHeaders\", void 0);\n    __decorate([\n        Property(true)\n    ], Sheet.prototype, \"showGridLines\", void 0);\n    __decorate([\n        Property(false)\n    ], Sheet.prototype, \"isProtected\", void 0);\n    __decorate([\n        Property('Visible')\n    ], Sheet.prototype, \"state\", void 0);\n    return Sheet;\n}(ChildProperty));\nexport { Sheet };\n/**\n * To get sheet index from address.\n * @hidden\n */\nexport function getSheetIndex(context, name) {\n    var idx;\n    for (var i = 0; i < context.sheets.length; i++) {\n        if (context.sheets[i].name.toLowerCase() === name.toLowerCase()) {\n            idx = i;\n            break;\n        }\n    }\n    return idx;\n}\n/**\n * To get sheet index from sheet id.\n * @hidden\n */\nexport function getSheetIndexFromId(context, id) {\n    var idx;\n    for (var i = 0; i < context.sheets.length; i++) {\n        if (context.sheets[i].id === id) {\n            idx = i;\n            break;\n        }\n    }\n    return idx;\n}\n/**\n * To get sheet name from address.\n * @hidden\n */\nexport function getSheetNameFromAddress(address) {\n    return address.split('!')[0].replace(/\\'/gi, '');\n}\n/**\n * To get sheet index from sheet name.\n * @hidden\n */\nexport function getSheetIndexByName(context, name, info) {\n    var len = info.length;\n    for (var i = 0; i < len; i++) {\n        if (info[i].sheet.toUpperCase() === name.toUpperCase()) {\n            return info[i].index;\n        }\n    }\n    return -1;\n}\n/**\n * update selected range\n * @hidden\n */\nexport function updateSelectedRange(context, range, sheet) {\n    if (sheet === void 0) { sheet = {}; }\n    context.setSheetPropertyOnMute(sheet, 'selectedRange', range);\n}\n/**\n * get selected range\n * @hidden\n */\nexport function getSelectedRange(sheet) {\n    return sheet && sheet.selectedRange || 'A1';\n}\n/**\n * @hidden\n */\nexport function getSheet(context, idx) {\n    return context.sheets[idx];\n}\n/**\n * @hidden\n */\nexport function getSheetNameCount(context) {\n    var name = [];\n    context.sheets.forEach(function (sheet) {\n        name.push(sheet.name.toLowerCase());\n    });\n    for (var i = 0; i < name.length; i++) {\n        if (name.indexOf('sheet' + context.sheetNameCount) > -1) {\n            context.sheetNameCount++;\n        }\n        else {\n            return context.sheetNameCount++;\n        }\n    }\n    return context.sheetNameCount++;\n}\n/**\n * @hidden\n */\nexport function getMaxSheetId(sheets) {\n    var cnt = 0;\n    sheets.forEach(function (sheet) {\n        cnt = Math.max(sheet.id, cnt);\n    });\n    return cnt + 1;\n}\n/**\n * @hidden\n */\nexport function initSheet(context, sheet) {\n    var sheets = sheet ? sheet : context.sheets;\n    sheets.forEach(function (sheet) {\n        sheet.id = sheet.id || 0;\n        sheet.name = sheet.name || '';\n        sheet.rowCount = isUndefined(sheet.rowCount) ? 100 : sheet.rowCount;\n        sheet.colCount = isUndefined(sheet.colCount) ? 100 : sheet.colCount;\n        sheet.topLeftCell = sheet.topLeftCell || 'A1';\n        sheet.activeCell = sheet.activeCell || 'A1';\n        sheet.selectedRange = sheet.selectedRange || 'A1:A1';\n        sheet.usedRange = sheet.usedRange || { rowIndex: 0, colIndex: 0 };\n        context.setSheetPropertyOnMute(sheet, 'ranges', sheet.ranges ? sheet.ranges : []);\n        context.setSheetPropertyOnMute(sheet, 'rows', sheet.rows || []);\n        context.setSheetPropertyOnMute(sheet, 'columns', sheet.columns || []);\n        sheet.showHeaders = isUndefined(sheet.showHeaders) ? true : sheet.showHeaders;\n        sheet.showGridLines = isUndefined(sheet.showGridLines) ? true : sheet.showGridLines;\n        sheet.state = sheet.state || 'Visible';\n        sheet.maxHgts = [];\n        sheet.protectSettings = sheet.protectSettings || { selectCells: false, formatCells: false, formatRows: false, formatColumns: false,\n            insertLink: false };\n        sheet.isProtected = sheet.isProtected || false;\n        processIdx(sheet.columns);\n        initRow(sheet.rows);\n    });\n    processIdx(sheets, true, context);\n}\nfunction initRangeSettings(ranges) {\n    ranges.forEach(function (range) {\n        range.startCell = range.startCell || 'A1';\n        range.address = range.address || 'A1';\n        range.template = range.template || '';\n        range.showFieldAsHeader = isUndefined(range.showFieldAsHeader) ? true : range.showFieldAsHeader;\n    });\n    return ranges;\n}\nfunction initRow(rows) {\n    rows.forEach(function (row) {\n        if (row && row.cells) {\n            processIdx(row.cells);\n        }\n    });\n    processIdx(rows);\n}\n/**\n * get sheet name\n * @hidden\n */\nexport function getSheetName(context, idx) {\n    if (idx === void 0) { idx = context.activeSheetIndex; }\n    return getSheet(context, idx).name;\n}\n","var __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    }\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nimport { ChildProperty, Collection, Property, Complex } from '@syncfusion/ej2-base';\nimport { Cell } from './cell';\nimport { Format } from '../common/index';\n/**\n * Configures the Row behavior for the spreadsheet.\n *  ```html\n * <div id='Spreadsheet'></div>\n * ```\n * ```typescript\n * let spreadsheet: Spreadsheet = new Spreadsheet({\n *      sheets: [{\n *                rows: [{\n *                        index: 30,\n *                        cells: [{ index: 4, value: 'Total Amount:' },\n *                               { formula: '=SUM(F2:F30)', style: { fontWeight: 'bold' } }]\n *                }]\n * ...\n * });\n * spreadsheet.appendTo('#Spreadsheet');\n * ```\n */\nvar Row = /** @class */ (function (_super) {\n    __extends(Row, _super);\n    function Row() {\n        return _super !== null && _super.apply(this, arguments) || this;\n    }\n    __decorate([\n        Collection([], Cell)\n    ], Row.prototype, \"cells\", void 0);\n    __decorate([\n        Property(0)\n    ], Row.prototype, \"index\", void 0);\n    __decorate([\n        Property(20)\n    ], Row.prototype, \"height\", void 0);\n    __decorate([\n        Property(false)\n    ], Row.prototype, \"customHeight\", void 0);\n    __decorate([\n        Property(false)\n    ], Row.prototype, \"hidden\", void 0);\n    __decorate([\n        Complex({}, Format)\n    ], Row.prototype, \"format\", void 0);\n    return Row;\n}(ChildProperty));\nexport { Row };\n/**\n * @hidden\n */\nexport function getRow(sheet, rowIndex) {\n    return sheet.rows[rowIndex];\n}\n/** @hidden */\nexport function setRow(sheet, rowIndex, row) {\n    if (!sheet.rows[rowIndex]) {\n        sheet.rows[rowIndex] = {};\n    }\n    Object.keys(row).forEach(function (key) {\n        sheet.rows[rowIndex][key] = row[key];\n    });\n}\n/** @hidden */\nexport function isHiddenRow(sheet, index) {\n    return sheet.rows[index] && sheet.rows[index].hidden;\n}\n/**\n * @hidden\n */\nexport function getRowHeight(sheet, rowIndex) {\n    if (sheet && sheet.rows && sheet.rows[rowIndex]) {\n        if (sheet.rows[rowIndex].hidden) {\n            return 0;\n        }\n        return sheet.rows[rowIndex].height === undefined ? 20 : sheet.rows[rowIndex].height;\n    }\n    else {\n        return 20;\n    }\n}\n/**\n * @hidden\n */\nexport function setRowHeight(sheet, rowIndex, height) {\n    if (sheet && sheet.rows) {\n        if (!sheet.rows[rowIndex]) {\n            sheet.rows[rowIndex] = {};\n        }\n        sheet.rows[rowIndex].height = height;\n    }\n}\n/**\n * @hidden\n */\nexport function getRowsHeight(sheet, startRow, endRow) {\n    if (endRow === void 0) { endRow = startRow; }\n    var height = 0;\n    var swap;\n    if (startRow > endRow) {\n        swap = startRow;\n        startRow = endRow;\n        endRow = swap;\n    }\n    for (var i = startRow; i <= endRow; i++) {\n        height += getRowHeight(sheet, i);\n    }\n    return height;\n}\n","var __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    }\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nimport { ChildProperty, Property, Complex } from '@syncfusion/ej2-base';\nimport { Format } from '../common/index';\n/**\n * Configures the Column behavior for the spreadsheet.\n */\nvar Column = /** @class */ (function (_super) {\n    __extends(Column, _super);\n    function Column() {\n        return _super !== null && _super.apply(this, arguments) || this;\n    }\n    __decorate([\n        Property(0)\n    ], Column.prototype, \"index\", void 0);\n    __decorate([\n        Property(64)\n    ], Column.prototype, \"width\", void 0);\n    __decorate([\n        Property(false)\n    ], Column.prototype, \"customWidth\", void 0);\n    __decorate([\n        Property(false)\n    ], Column.prototype, \"hidden\", void 0);\n    __decorate([\n        Complex({}, Format)\n    ], Column.prototype, \"format\", void 0);\n    __decorate([\n        Property(true)\n    ], Column.prototype, \"isLocked\", void 0);\n    return Column;\n}(ChildProperty));\nexport { Column };\n/**\n * @hidden\n */\nexport function getColumn(sheet, colIndex) {\n    if (sheet.columns) {\n        if (!sheet.columns[colIndex]) {\n            sheet.columns[colIndex] = {};\n        }\n    }\n    else {\n        sheet.columns = [];\n        sheet.columns[colIndex] = {};\n    }\n    return sheet.columns[colIndex];\n}\n/** @hidden */\nexport function setColumn(sheet, colIndex, column) {\n    var curColumn = getColumn(sheet, colIndex);\n    Object.keys(column).forEach(function (key) {\n        curColumn[key] = column[key];\n    });\n}\n/**\n * @hidden\n */\nexport function getColumnWidth(sheet, index, skipHidden) {\n    if (sheet && sheet.columns && sheet.columns[index]) {\n        if (!skipHidden && sheet.columns[index].hidden) {\n            return 0;\n        }\n        return (sheet.columns[index].width || sheet.columns[index].customWidth) ? sheet.columns[index].width : 64;\n    }\n    else {\n        return 64;\n    }\n}\n/**\n * @hidden\n */\nexport function getColumnsWidth(sheet, startCol, endCol) {\n    if (endCol === void 0) { endCol = startCol; }\n    var width = 0;\n    if (startCol > endCol) {\n        var swap = startCol;\n        startCol = endCol;\n        endCol = swap;\n    }\n    for (var i = startCol; i <= endCol; i++) {\n        width += getColumnWidth(sheet, i);\n    }\n    return width;\n}\n/** @hidden */\nexport function isHiddenCol(sheet, index) {\n    return sheet.columns[index] && sheet.columns[index].hidden;\n}\n","import { getWorkbookRequiredModules } from '../../workbook/common/module';\n/**\n * To get Spreadsheet required modules.\n * @hidden\n * @param {Spreadsheet} context\n */\nexport function getRequiredModules(context) {\n    var modules = [];\n    pushBasicModules(context, modules);\n    getWorkbookRequiredModules(context, modules);\n    return modules;\n}\n// tslint:disable-next-line:max-func-body-length\nfunction pushBasicModules(context, modules) {\n    modules.push({ member: 'basic', args: [] });\n    modules.push({ member: 'all', args: [] });\n    if (context.showRibbon) {\n        modules.push({\n            member: 'ribbon',\n            args: [context]\n        });\n    }\n    if (context.showFormulaBar) {\n        modules.push({\n            member: 'formulaBar',\n            args: [context]\n        });\n    }\n    if (context.showSheetTabs) {\n        modules.push({\n            member: 'sheetTabs',\n            args: [context]\n        });\n    }\n    if (context.allowEditing) {\n        modules.push({\n            member: 'edit',\n            args: [context]\n        });\n        modules.push({\n            member: 'formula',\n            args: [context]\n        });\n        modules.push({\n            member: 'workbookFormula',\n            args: [context]\n        });\n        modules.push({\n            member: 'workbookEdit',\n            args: [context]\n        });\n    }\n    if (context.allowOpen) {\n        modules.push({\n            member: 'open',\n            args: [context]\n        });\n    }\n    if (context.allowSave) {\n        modules.push({\n            member: 'save',\n            args: [context]\n        });\n    }\n    if (context.enableContextMenu) {\n        modules.push({\n            member: 'contextMenu',\n            args: [context]\n        });\n    }\n    if (context.selectionSettings.mode !== 'None') {\n        modules.push({\n            member: 'selection',\n            args: [context]\n        });\n    }\n    if (context.enableKeyboardNavigation) {\n        modules.push({\n            member: 'keyboardNavigation',\n            args: [context]\n        });\n    }\n    if (context.allowNumberFormatting) {\n        modules.push({\n            member: 'numberFormat',\n            args: [context]\n        });\n    }\n    if (context.enableKeyboardShortcut) {\n        modules.push({\n            member: 'keyboardShortcut',\n            args: [context]\n        });\n    }\n    if (context.enableClipboard) {\n        modules.push({\n            member: 'clipboard',\n            args: [context]\n        });\n    }\n    if (context.allowCellFormatting) {\n        modules.push({\n            member: 'cellformat',\n            args: [context]\n        });\n    }\n    if (context.allowSorting) {\n        modules.push({ member: 'sort', args: [context] });\n    }\n    if (context.allowResizing) {\n        modules.push({\n            member: 'resize',\n            args: [context]\n        });\n    }\n    modules.push({\n        member: 'collaborativeEditing',\n        args: [context]\n    });\n    modules.push({\n        member: 'protectSheet',\n        args: [context]\n    });\n    if (context.allowHyperlink) {\n        modules.push({\n            member: 'spreadsheetHyperlink',\n            args: [context]\n        });\n    }\n    if (context.allowUndoRedo) {\n        modules.push({\n            member: 'undoredo',\n            args: [context]\n        });\n    }\n    if (context.allowFiltering) {\n        modules.push({ member: 'filter', args: [context] });\n    }\n    if (context.allowWrap) {\n        modules.push({ member: 'wrapText', args: [context] });\n    }\n    if (context.allowInsert) {\n        modules.push({ member: 'insert', args: [context] });\n    }\n    if (context.allowDelete) {\n        modules.push({ member: 'delete', args: [context] });\n    }\n    if (context.allowDataValidation) {\n        modules.push({ member: 'dataValidation', args: [context] });\n    }\n    if (context.allowFindAndReplace) {\n        modules.push({ member: 'findAndReplace', args: [context] });\n    }\n    if (context.allowMerge) {\n        modules.push({ member: 'merge', args: [context] });\n    }\n    if (context.allowConditionalFormat) {\n        modules.push({ member: 'conditionalFormatting', args: [context] });\n    }\n    if (context.allowImage) {\n        modules.push({ member: 'spreadsheetImage', args: [context] });\n    }\n    if (context.allowChart) {\n        modules.push({ member: 'spreadsheetChart', args: [context] });\n    }\n}\n","import { Browser, setStyleAttribute as setBaseStyleAttribute, getComponent } from '@syncfusion/ej2-base';\nimport { clearViewer, deleteImage, createImageElement, refreshImgCellObj } from './index';\nimport { getRowsHeight, getColumnsWidth, getSwapRange, clearCells } from '../../workbook/index';\nimport { getRangeIndexes, wrap, setRowHeight, insertModel, } from '../../workbook/index';\nimport { initiateSort, getIndexesFromAddress, getRowHeight, setMerge } from '../../workbook/index';\nimport { setValidation, removeValidation, clearCFRule, setCFRule } from '../../workbook/index';\nimport { removeSheetTab, rowHeightChanged } from './index';\nimport { getCellIndexes, getCell, getColumnWidth, setChart, refreshChartSize } from '../../workbook/index';\nimport { deleteChart } from '../../spreadsheet/index';\nimport { initiateFilterUI } from './event';\n/**\n * The function used to update Dom using requestAnimationFrame.\n * @param  {Function} fn - Function that contains the actual action\n * @return {Promise<T>}\n * @hidden\n */\nexport function getUpdateUsingRaf(fn) {\n    requestAnimationFrame(function () {\n        fn();\n    });\n}\n/**\n * The function used to remove the dom element children.\n * @param  parent -\n * @hidden\n */\nexport function removeAllChildren(parent, index) {\n    while (parent.firstChild) {\n        parent.removeChild(parent.firstChild);\n    }\n}\n/**\n * The function used to get colgroup width based on the row index.\n * @param  parent -\n * @hidden\n */\nexport function getColGroupWidth(index) {\n    var width = 30;\n    if (index.toString().length > 3) {\n        width = index.toString().length * 10;\n    }\n    return width;\n}\nvar scrollAreaWidth = null;\n/** @hidden */\nexport function getScrollBarWidth() {\n    if (scrollAreaWidth !== null) {\n        return scrollAreaWidth;\n    }\n    var htmlDivNode = document.createElement('div');\n    var result = 0;\n    htmlDivNode.style.cssText = 'width:100px;height: 100px;overflow: scroll;position: absolute;top: -9999px;';\n    document.body.appendChild(htmlDivNode);\n    result = (htmlDivNode.offsetWidth - htmlDivNode.clientWidth) | 0;\n    document.body.removeChild(htmlDivNode);\n    return scrollAreaWidth = result;\n}\nvar classes = ['e-ribbon', 'e-formula-bar-panel', 'e-sheet-tab-panel', 'e-header-toolbar'];\n/** @hidden */\nexport function getSiblingsHeight(element, classList) {\n    if (classList === void 0) { classList = classes; }\n    var previous = getHeightFromDirection(element, 'previous', classList);\n    var next = getHeightFromDirection(element, 'next', classList);\n    return previous + next;\n}\nfunction getHeightFromDirection(element, direction, classList) {\n    // tslint:disable-next-line:no-any\n    var sibling = (element)[direction + 'ElementSibling'];\n    var result = 0;\n    while (sibling) {\n        if (classList.some(function (value) { return sibling.classList.contains(value); })) {\n            result += sibling.offsetHeight;\n        }\n        // tslint:disable-next-line:no-any\n        sibling = (sibling)[direction + 'ElementSibling'];\n    }\n    return result;\n}\n/**\n * @hidden\n */\nexport function inView(context, range, isModify) {\n    if (context.scrollSettings.enableVirtualization) {\n        var topIdx = context.viewport.topIndex;\n        var leftIdx = context.viewport.leftIndex;\n        var bottomIdx = topIdx + context.viewport.rowCount + context.getThreshold('row') * 2;\n        var rightIdx = leftIdx + context.viewport.colCount + context.getThreshold('col') * 2;\n        var inView_1 = topIdx <= range[0] && bottomIdx >= range[2] && leftIdx <= range[1] && rightIdx >= range[3];\n        if (inView_1) {\n            return true;\n        }\n        if (isModify) {\n            if (range[0] < topIdx && range[2] < topIdx || range[0] > bottomIdx && range[2] > bottomIdx) {\n                return false;\n            }\n            else {\n                if (range[0] < topIdx && range[2] > topIdx) {\n                    range[0] = topIdx;\n                    inView_1 = true;\n                }\n                if (range[2] > bottomIdx) {\n                    range[2] = bottomIdx;\n                    inView_1 = true;\n                }\n            }\n            if (range[1] < leftIdx && range[3] < leftIdx || range[1] > rightIdx && range[3] > rightIdx) {\n                return false;\n            }\n            else {\n                if (range[1] < leftIdx && range[3] > leftIdx) {\n                    range[1] = leftIdx;\n                    inView_1 = true;\n                }\n                if (range[3] > rightIdx) {\n                    range[3] = rightIdx;\n                    inView_1 = true;\n                }\n            }\n        }\n        return inView_1;\n    }\n    else {\n        return true;\n    }\n}\n/**\n * To get the top left cell position in viewport.\n * @hidden\n */\nexport function getCellPosition(sheet, indexes, offset) {\n    if (offset === void 0) { offset = { left: { idx: 0, size: 0 }, top: { idx: 0, size: 0 } }; }\n    var i;\n    var top = offset.top.size;\n    var left = offset.left.size;\n    for (i = offset.top.idx; i < indexes[0]; i++) {\n        top += getRowsHeight(sheet, i);\n    }\n    for (i = offset.left.idx; i < indexes[1]; i++) {\n        left += getColumnsWidth(sheet, i);\n    }\n    return { top: top, left: left };\n}\n/**\n * Position element with given range\n * @hidden\n */\nexport function locateElem(ele, range, sheet, isRtl, offset) {\n    var swapRange = getSwapRange(range);\n    var cellPosition = getCellPosition(sheet, swapRange, offset);\n    var startIndex = [skipHiddenIdx(sheet, 0, true), skipHiddenIdx(sheet, 0, true, 'columns')];\n    var attrs = {\n        'top': (swapRange[0] === startIndex[0] ? cellPosition.top : cellPosition.top - 1) + 'px',\n        'height': getRowsHeight(sheet, range[0], range[2]) + (swapRange[0] === startIndex[0] ? 0 : 1) + 'px',\n        'width': getColumnsWidth(sheet, range[1], range[3]) + (swapRange[1] === startIndex[1] ? 0 : 1) + 'px'\n    };\n    attrs[isRtl ? 'right' : 'left'] = (swapRange[1] === startIndex[1] ? cellPosition.left : cellPosition.left - 1) + 'px';\n    if (ele) {\n        setStyleAttribute([{ element: ele, attrs: attrs }]);\n    }\n}\n/**\n * To update element styles using request animation frame\n * @hidden\n */\nexport function setStyleAttribute(styles) {\n    requestAnimationFrame(function () {\n        styles.forEach(function (style) {\n            setBaseStyleAttribute(style.element, style.attrs);\n        });\n    });\n}\n/**\n * @hidden\n */\nexport function getStartEvent() {\n    return (Browser.isPointer ? 'pointerdown' : 'mousedown touchstart');\n}\n/**\n * @hidden\n */\nexport function getMoveEvent() {\n    return (Browser.isPointer ? 'pointermove' : 'mousemove touchmove');\n}\n/**\n * @hidden\n */\nexport function getEndEvent() {\n    return (Browser.isPointer ? 'pointerup' : 'mouseup touchend');\n}\n/**\n * @hidden\n */\nexport function isTouchStart(e) {\n    return e.type === 'touchstart' || (e.type === 'pointerdown' && e.pointerType === 'touch');\n}\n/**\n * @hidden\n */\nexport function isTouchMove(e) {\n    return e.type === 'touchmove' || (e.type === 'pointermove' && e.pointerType === 'touch');\n}\n/**\n * @hidden\n */\nexport function isTouchEnd(e) {\n    return e.type === 'touchend' || (e.type === 'pointerup' && e.pointerType === 'touch');\n}\n/**\n * @hidden\n */\nexport function getClientX(e) {\n    return e.changedTouches ? e.changedTouches[0].clientX : e.clientX;\n}\n/**\n * @hidden\n */\nexport function getClientY(e) {\n    return e.changedTouches ? e.changedTouches[0].clientY : e.clientY;\n}\nvar config = {\n    role: 'role',\n    selected: 'aria-selected',\n    multiselectable: 'aria-multiselectable',\n    busy: 'aria-busy',\n    colcount: 'aria-colcount'\n};\n/** @hidden */\nexport function setAriaOptions(target, options) {\n    var props = Object.keys(options);\n    props.forEach(function (name) {\n        if (target) {\n            target.setAttribute(config[name], options[name]);\n        }\n    });\n}\n/**\n * @hidden\n */\nexport function destroyComponent(element, component) {\n    if (element) {\n        var compObj = getComponent(element, component);\n        if (compObj) {\n            compObj.destroy();\n        }\n    }\n}\n/**\n * @hidden\n */\n// tslint:disable-next-line:max-func-body-length\nexport function setResize(index, value, isCol, parent) {\n    var curEle;\n    var curEleH;\n    var curEleC;\n    var preEle;\n    var preEleH;\n    var preEleC;\n    var nxtEle;\n    var nxtEleH;\n    var nxtEleC;\n    var sheet = parent.getActiveSheet();\n    if (isCol) {\n        curEle = parent.element.getElementsByClassName('e-column-header')[0].getElementsByTagName('th')[index];\n        curEleH = parent.element.getElementsByClassName('e-column-header')[0].getElementsByTagName('col')[index];\n        curEleC = parent.element.getElementsByClassName('e-sheet-content')[0].getElementsByTagName('col')[index];\n    }\n    else {\n        curEle = parent.element.getElementsByClassName('e-row-header')[0].getElementsByTagName('tr')[index];\n        curEleH = parent.element.getElementsByClassName('e-row-header')[0].getElementsByTagName('tr')[index];\n        curEleC = parent.element.getElementsByClassName('e-sheet-content')[0].getElementsByTagName('tr')[index];\n        curEleH.style.height = parseInt(value, 10) > 0 ? value : '2px';\n        curEleC.style.height = parseInt(value, 10) > 0 ? value : '0px';\n        var hdrRow = parent.getRowHeaderContent().getElementsByClassName('e-row');\n        var hdrClone = [];\n        hdrClone[0] = hdrRow[index].getElementsByTagName('td')[0].cloneNode(true);\n        var hdrFntSize = findMaxValue(parent.getRowHeaderTable(), hdrClone, false, parent) + 1;\n        var contentRow = parent.getMainContent().getElementsByClassName('e-row');\n        var contentClone = [];\n        for (var idx = 0; idx < contentRow[index].getElementsByTagName('td').length; idx++) {\n            contentClone[idx] = contentRow[index].getElementsByTagName('td')[idx].cloneNode(true);\n        }\n        var cntFntSize = findMaxValue(parent.getContentTable(), contentClone, false, parent) + 1;\n        var fntSize = hdrFntSize >= cntFntSize ? hdrFntSize : cntFntSize;\n        if (parseInt(curEleC.style.height, 10) < fntSize ||\n            (curEle.classList.contains('e-reach-fntsize') && parseInt(curEleC.style.height, 10) === fntSize)) {\n            curEle.classList.add('e-reach-fntsize');\n            curEleH.style.lineHeight = parseInt(value, 10) >= 4 ? ((parseInt(value, 10)) - 4) + 'px' :\n                parseInt(value, 10) > 0 ? ((parseInt(value, 10)) - 1) + 'px' : '0px';\n            curEleC.style.lineHeight = parseInt(value, 10) > 0 ? ((parseInt(value, 10)) - 1) + 'px' : '0px';\n        }\n        else {\n            curEleH.style.removeProperty('line-height');\n            curEleC.style.removeProperty('line-height');\n            if (curEle.classList.contains('e-reach-fntsize')) {\n                curEle.classList.remove('e-reach-fntsize');\n            }\n        }\n    }\n    preEle = curEle.previousElementSibling;\n    nxtEle = curEle.nextElementSibling;\n    if (preEle) {\n        preEle = curEle.previousElementSibling;\n        preEleH = curEleH.previousElementSibling;\n        preEleC = curEleC.previousElementSibling;\n    }\n    if (nxtEle) {\n        nxtEle = curEle.nextElementSibling;\n        nxtEleH = curEleH.nextElementSibling;\n        nxtEleC = curEleC.nextElementSibling;\n    }\n    if (parseInt(value, 10) <= 0 && !(curEle.classList.contains('e-zero') || curEle.classList.contains('e-zero-start'))) {\n        if (preEle && nxtEle) {\n            if (isCol) {\n                curEleH.style.width = '2px';\n                curEleC.style.width = '0px';\n            }\n            else {\n                curEleH.style.height = '2px';\n                curEleC.style.height = '0px';\n            }\n            if (preEle.classList.contains('e-zero-start')) {\n                curEle.classList.add('e-zero-start');\n                curEleC.classList.add('e-zero-start');\n            }\n            else {\n                curEle.classList.add('e-zero');\n                curEleC.classList.add('e-zero');\n            }\n            if (!nxtEle.classList.contains('e-zero') && !nxtEle.classList.contains('e-zero-last')) {\n                curEle.classList.add('e-zero-last');\n                curEleC.classList.add('e-zero-last');\n            }\n            if (preEle.classList.contains('e-zero-last')) {\n                preEle.classList.remove('e-zero-last');\n                preEleC.classList.remove('e-zero-last');\n            }\n            if (preEle.classList.contains('e-zero')) {\n                if (curEle.classList.contains('e-zero-end')) {\n                    setWidthAndHeight(preEleH, -2, isCol);\n                }\n                else {\n                    setWidthAndHeight(preEleH, -2, isCol);\n                }\n            }\n            else {\n                setWidthAndHeight(preEleH, -1, isCol);\n            }\n            if (preEle.classList.contains('e-zero-start')) {\n                setWidthAndHeight(curEleH, -1, isCol);\n            }\n            if (nxtEle.classList.contains('e-zero')) {\n                if (curEle.classList.contains('e-zero-start')) {\n                    while (nxtEle) {\n                        if (nxtEle.classList.contains('e-zero') && (parseInt(nxtEleH.style.height, 10) !== 0 && !isCol) ||\n                            (parseInt(nxtEleH.style.width, 10) !== 0 && isCol)) {\n                            if (isCol) {\n                                curEleH.style.width = parseInt(curEleH.style.width, 10) - 1 + 'px';\n                                nxtEleH.style.width = parseInt(nxtEleH.style.width, 10) - 1 + 'px';\n                            }\n                            else {\n                                curEleH.style.height = parseInt(curEleH.style.height, 10) - 1 + 'px';\n                                nxtEleH.style.height = parseInt(nxtEleH.style.height, 10) - 1 + 'px';\n                            }\n                            nxtEle.classList.remove('e-zero');\n                            nxtEle.classList.add('e-zero-start');\n                            break;\n                        }\n                        else {\n                            var nxtIndex = void 0;\n                            nxtEle.classList.remove('e-zero');\n                            nxtEle.classList.add('e-zero-start');\n                            if (isCol) {\n                                nxtIndex = parseInt(nxtEle.getAttribute('aria-colindex'), 10) - 1;\n                                nxtEle = parent.getColHeaderTable().getElementsByTagName('th')[nxtIndex + 1];\n                                nxtEleH = parent.getColHeaderTable().getElementsByTagName('col')[nxtIndex + 1];\n                            }\n                            else {\n                                nxtIndex = parseInt(nxtEle.getAttribute('aria-rowindex'), 10) - 1;\n                                nxtEle = parent.getRowHeaderTable().getElementsByTagName('tr')[nxtIndex + 1];\n                                nxtEleH = parent.getRowHeaderTable().getElementsByTagName('tr')[nxtIndex + 1];\n                            }\n                        }\n                    }\n                }\n                else {\n                    setWidthAndHeight(curEleH, -2, isCol);\n                }\n            }\n            else {\n                if (nxtEle.classList.contains('e-zero-end')) {\n                    if (isCol) {\n                        curEleH.style.width = '0px';\n                    }\n                    else {\n                        curEleH.style.height = '0px';\n                    }\n                }\n                else {\n                    setWidthAndHeight(nxtEleH, -1, isCol);\n                }\n            }\n        }\n        else if (preEle) {\n            if (isCol) {\n                curEleH.style.width = '1px';\n                curEleC.style.width = '0px';\n            }\n            else {\n                curEleH.style.height = '1px';\n                curEleC.style.height = '0px';\n            }\n            curEle.classList.add('e-zero-end');\n            curEleC.classList.add('e-zero-end');\n            curEle.classList.add('e-zero-last');\n            curEleC.classList.add('e-zero-last');\n            if (preEle.classList.contains('e-zero')) {\n                setWidthAndHeight(preEleH, -2, isCol);\n            }\n            else {\n                setWidthAndHeight(preEleH, -1, isCol);\n            }\n        }\n        else if (nxtEle) {\n            curEle.classList.add('e-zero-start');\n            curEleC.classList.add('e-zero-start');\n            if (!nxtEle.classList.contains('e-zero')) {\n                curEle.classList.add('e-zero-last');\n                curEleC.classList.add('e-zero-last');\n            }\n            if (isCol) {\n                curEleH.style.width = '1px';\n                curEleC.style.width = '0px';\n            }\n            else {\n                curEleH.style.height = '1px';\n                curEleC.style.height = '0px';\n            }\n            if (nxtEle.classList.contains('e-zero')) {\n                while (nxtEle) {\n                    if (nxtEle.classList.contains('e-zero') && (parseInt(nxtEleH.style.width, 10) !== 0\n                        && isCol) || (parseInt(nxtEleH.style.height, 10) !== 0 && !isCol)) {\n                        if (isCol) {\n                            nxtEleH.style.width = parseInt(nxtEleH.style.width, 10) - 1 + 'px';\n                            curEleH.style.width = parseInt(curEleH.style.width, 10) - 1 + 'px';\n                        }\n                        else {\n                            nxtEleH.style.height = parseInt(nxtEleH.style.height, 10) - 1 + 'px';\n                            curEleH.style.height = parseInt(curEleH.style.height, 10) - 1 + 'px';\n                        }\n                        nxtEle.classList.add('e-zero-start');\n                        nxtEle.classList.remove('e-zero');\n                        break;\n                    }\n                    else {\n                        var nxtIndex = void 0;\n                        nxtEle.classList.add('e-zero-start');\n                        nxtEle.classList.remove('e-zero');\n                        if (isCol) {\n                            nxtIndex = parseInt(nxtEle.getAttribute('aria-colindex'), 10) - 1;\n                            nxtEleH = parent.getColHeaderTable().getElementsByTagName('col')[nxtIndex + 1];\n                            nxtEle = parent.getColHeaderTable().getElementsByTagName('th')[nxtIndex + 1];\n                        }\n                        else {\n                            nxtIndex = parseInt(nxtEle.getAttribute('aria-rowindex'), 10) - 1;\n                            nxtEleH = parent.getRowHeaderTable().getElementsByTagName('tr')[nxtIndex + 1];\n                            nxtEle = parent.getRowHeaderTable().getElementsByTagName('tr')[nxtIndex + 1];\n                        }\n                    }\n                }\n            }\n            else {\n                setWidthAndHeight(nxtEleH, -1, isCol);\n            }\n        }\n    }\n    else if (parseInt(value, 10) > 0) {\n        if (isCol) {\n            curEleH.style.width = value;\n            curEleC.style.width = value;\n        }\n        else {\n            curEleH.style.height = value;\n            curEleC.style.height = value;\n        }\n        if (preEle && nxtEle) {\n            if (preEle.classList.contains('e-zero')) {\n                if (curEle.classList.contains('e-zero')) {\n                    if (isCol) {\n                        preEleH.style.width = parseInt(preEleH.style.width, 10) + 2 + 'px';\n                        curEleH.style.width = parseInt(curEleH.style.width, 10) - 1 + 'px';\n                    }\n                    else {\n                        preEleH.style.height = parseInt(preEleH.style.height, 10) + 2 + 'px';\n                        curEleH.style.height = parseInt(curEleH.style.height, 10) - 1 + 'px';\n                    }\n                }\n                else {\n                    setWidthAndHeight(curEleH, -1, isCol);\n                }\n            }\n            else {\n                if (curEle.classList.contains('e-zero')) {\n                    setWidthAndHeight(preEleH, 1, isCol);\n                }\n                else {\n                    if (curEle.classList.contains('e-zero-start')) {\n                        if (isCol) {\n                            preEleH.style.width = parseInt(preEleH.style.width, 10) + 1 + 'px';\n                            curEleH.style.width = parseInt(curEleH.style.width, 10) - 1 + 'px';\n                        }\n                        else {\n                            preEleH.style.height = parseInt(preEleH.style.height, 10) + 1 + 'px';\n                            curEleH.style.height = parseInt(curEleH.style.height, 10) - 1 + 'px';\n                        }\n                    }\n                }\n            }\n            if (nxtEle.classList.contains('e-zero')) {\n                setWidthAndHeight(curEleH, -1, isCol);\n            }\n            else {\n                if (curEle.classList.contains('e-zero') || curEle.classList.contains('e-zero-start')) {\n                    setWidthAndHeight(nxtEleH, 1, isCol);\n                }\n            }\n            if (curEle.classList.contains('e-zero')) {\n                curEle.classList.remove('e-zero');\n            }\n            if (curEle.classList.contains('e-zero-start')) {\n                curEle.classList.remove('e-zero-start');\n            }\n            if (curEleC.classList.contains('e-zero')) {\n                curEleC.classList.remove('e-zero');\n            }\n            if (curEleC.classList.contains('e-zero-start')) {\n                curEleC.classList.remove('e-zero-start');\n            }\n            if (curEle.classList.contains('e-zero-last')) {\n                curEle.classList.remove('e-zero-last');\n            }\n            if (curEleC.classList.contains('e-zero-last')) {\n                curEleC.classList.remove('e-zero-last');\n            }\n            if (preEle.classList.contains('e-zero') || preEle.classList.contains('e-zero-start')) {\n                preEle.classList.add('e-zero-last');\n                preEleC.classList.add('e-zero-last');\n            }\n        }\n        else if (preEle) {\n            if (preEle.classList.contains('e-zero')) {\n                if (curEle.classList.contains('e-zero')) {\n                    if (isCol) {\n                        curEleH.style.width = parseInt(curEleH.style.width, 10) - 1 + 'px';\n                        preEleH.style.width = parseInt(preEleH.style.width, 10) + 2 + 'px';\n                    }\n                    else {\n                        curEleH.style.height = parseInt(curEleH.style.height, 10) - 1 + 'px';\n                        preEleH.style.height = parseInt(preEleH.style.height, 10) + 2 + 'px';\n                    }\n                }\n                else {\n                    setWidthAndHeight(curEleH, -1, isCol);\n                }\n            }\n            else {\n                if (curEle.classList.contains('e-zero')) {\n                    setWidthAndHeight(preEleH, 1, isCol);\n                }\n                else {\n                    setWidthAndHeight(curEleH, -1, isCol);\n                }\n            }\n            if (curEle.classList.contains('e-zero')) {\n                curEle.classList.remove('e-zero');\n            }\n            if (curEle.classList.contains('e-zero-end')) {\n                curEle.classList.remove('e-zero-end');\n            }\n            if (curEleC.classList.contains('e-zero')) {\n                curEleC.classList.remove('e-zero');\n            }\n            if (curEleC.classList.contains('e-zero-end')) {\n                curEleC.classList.remove('e-zero-end');\n            }\n        }\n        else if (nxtEle) {\n            if (nxtEle.classList.contains('e-zero')) {\n                setWidthAndHeight(curEleH, -1, isCol);\n            }\n            else if (curEle.classList.contains('e-zero-start')) {\n                setWidthAndHeight(nxtEleH, 1, isCol);\n                curEle.classList.remove('e-zero-start');\n            }\n            if (curEle.classList.contains('e-zero')) {\n                curEle.classList.remove('e-zero');\n            }\n            if (curEleC.classList.contains('e-zero')) {\n                curEleC.classList.remove('e-zero');\n            }\n            if (curEle.classList.contains('e-zero-start')) {\n                curEle.classList.remove('e-zero-start');\n            }\n            if (curEleC.classList.contains('e-zero-start')) {\n                curEleC.classList.remove('e-zero-start');\n            }\n        }\n    }\n}\n/**\n * @hidden\n */\nexport function setWidthAndHeight(trgt, value, isCol) {\n    if (isCol) {\n        trgt.style.width = parseInt(trgt.style.width, 10) + value + 'px';\n    }\n    else {\n        trgt.style.height = parseInt(trgt.style.height, 10) + value + 'px';\n    }\n}\n/**\n * @hidden\n */\nexport function findMaxValue(table, text, isCol, parent, prevData, isWrap) {\n    var myTableDiv = parent.createElement('div', { className: parent.element.className, styles: 'display: block' });\n    var myTable = parent.createElement('table', {\n        className: table.className + 'e-resizetable',\n        styles: 'width: auto;height: auto'\n    });\n    var myTr = parent.createElement('tr');\n    if (isCol) {\n        text.forEach(function (element) {\n            var tr = myTr.cloneNode();\n            tr.appendChild(element);\n            myTable.appendChild(tr);\n        });\n    }\n    else {\n        text.forEach(function (element) {\n            myTr.appendChild(element.cloneNode(true));\n        });\n        myTable.appendChild(myTr);\n    }\n    myTableDiv.appendChild(myTable);\n    document.body.appendChild(myTableDiv);\n    var offsetWidthValue;\n    var offsetHeightValue;\n    if (!isWrap) {\n        offsetHeightValue = myTable.getBoundingClientRect().height;\n        offsetWidthValue = myTable.getBoundingClientRect().width;\n    }\n    else {\n        offsetHeightValue = parseInt(prevData, 10);\n        offsetWidthValue = parseInt(prevData, 10);\n    }\n    document.body.removeChild(myTableDiv);\n    if (isCol) {\n        return Math.ceil(offsetWidthValue);\n    }\n    else {\n        return Math.ceil(offsetHeightValue);\n    }\n}\n/**\n * @hidden\n */\n// tslint:disable-next-line\nexport function updateAction(options, spreadsheet, isRedo) {\n    /* tslint:disable-next-line no-any */\n    var eventArgs = options.eventArgs;\n    switch (options.action) {\n        case 'sorting':\n            var args = {\n                range: options.eventArgs.range,\n                sortOptions: options.eventArgs.sortOptions,\n                cancel: false\n            };\n            var promise = new Promise(function (resolve, reject) {\n                resolve((function () { })());\n            });\n            var sortArgs = { args: args, promise: promise };\n            spreadsheet.notify(initiateSort, sortArgs);\n            sortArgs.promise.then(function (args) {\n                spreadsheet.serviceLocator.getService('cell').refreshRange(getIndexesFromAddress(args.range));\n            });\n            break;\n        case 'cellSave':\n            var cellEvtArgs = options.eventArgs;\n            var cellValue = eventArgs.formula ? { formula: cellEvtArgs.formula } : { value: cellEvtArgs.value };\n            spreadsheet.updateCell(cellValue, cellEvtArgs.address);\n            break;\n        case 'format':\n            if (eventArgs.requestType === 'CellFormat') {\n                spreadsheet.cellFormat(eventArgs.style, eventArgs.range);\n            }\n            else {\n                spreadsheet.numberFormat(eventArgs.format, eventArgs.range);\n            }\n            break;\n        case 'clipboard':\n            if (eventArgs.copiedInfo.isCut && !isRedo) {\n                return;\n            }\n            var clipboardPromise = eventArgs.copiedInfo.isCut ? spreadsheet.cut(eventArgs.copiedRange)\n                : spreadsheet.copy(eventArgs.copiedRange);\n            clipboardPromise.then(function (args) {\n                spreadsheet.paste(eventArgs.pastedRange, eventArgs.type);\n            });\n            break;\n        case 'gridLines':\n            spreadsheet.setSheetPropertyOnMute(spreadsheet.sheets[eventArgs.sheetIdx], 'showGridLines', eventArgs.isShow);\n            break;\n        case 'headers':\n            spreadsheet.setSheetPropertyOnMute(spreadsheet.sheets[eventArgs.sheetIdx], 'showHeaders', eventArgs.isShow);\n            break;\n        case 'resize':\n        case 'resizeToFit':\n            if (eventArgs.isCol) {\n                if (eventArgs.hide === undefined) {\n                    spreadsheet.setColWidth(eventArgs.width, eventArgs.index, eventArgs.sheetIdx);\n                }\n                else {\n                    spreadsheet.hideColumn(eventArgs.index, eventArgs.index, eventArgs.hide);\n                }\n            }\n            else {\n                if (eventArgs.hide === undefined) {\n                    spreadsheet.setRowHeight(eventArgs.height, eventArgs.index, eventArgs.sheetIdx);\n                }\n                else {\n                    spreadsheet.hideRow(eventArgs.index, eventArgs.index, eventArgs.hide);\n                }\n            }\n            break;\n        case 'renameSheet':\n            spreadsheet.setSheetPropertyOnMute(spreadsheet.sheets[eventArgs.index - 1], 'name', eventArgs.value);\n            break;\n        case 'removeSheet':\n            spreadsheet.notify(removeSheetTab, {\n                index: eventArgs.index,\n                isAction: true,\n                count: eventArgs.sheetCount,\n                clicked: true\n            });\n            break;\n        case 'wrap':\n            wrap(options.eventArgs.address, options.eventArgs.wrap, spreadsheet);\n            break;\n        case 'hideShow':\n            eventArgs.isCol ? spreadsheet.hideColumn(eventArgs.startIndex, eventArgs.endIndex, eventArgs.hide) :\n                spreadsheet.hideRow(eventArgs.startIndex, eventArgs.endIndex, eventArgs.hide);\n            break;\n        case 'replace':\n            spreadsheet.updateCell({ value: eventArgs.compareVal }, eventArgs.address);\n            break;\n        case 'filter':\n            spreadsheet.notify(initiateFilterUI, { predicates: null, range: eventArgs.range, sIdx: eventArgs.index, isCut: true });\n            break;\n        case 'insert':\n            if (isRedo === false) {\n                spreadsheet.delete(options.eventArgs.index, options.eventArgs.index + (options.eventArgs.model.length - 1), options.eventArgs.modelType);\n            }\n            else {\n                spreadsheet.notify(insertModel, {\n                    model: options.eventArgs.modelType === 'Sheet' ? spreadsheet :\n                        spreadsheet.getActiveSheet(), start: options.eventArgs.index, end: options.eventArgs.index +\n                        (options.eventArgs.model.length - 1), modelType: options.eventArgs.modelType,\n                    isAction: false, checkCount: options.eventArgs.sheetCount,\n                    activeSheetIndex: options.eventArgs.activeSheetIndex\n                });\n            }\n            break;\n        case 'delete':\n            if (isRedo === false) {\n                spreadsheet.notify(insertModel, {\n                    model: options.eventArgs.modelType === 'Sheet' ? spreadsheet :\n                        spreadsheet.getActiveSheet(), start: options.eventArgs.deletedModel, modelType: options.eventArgs.modelType,\n                    isAction: false, columnCellsModel: options.eventArgs.deletedCellsModel\n                });\n            }\n            else {\n                spreadsheet.delete(options.eventArgs.startIndex, options.eventArgs.endIndex, options.eventArgs.modelType);\n            }\n            break;\n        case 'validation':\n            if (isRedo) {\n                var rules = {\n                    type: eventArgs.type, operator: eventArgs.operator, value1: eventArgs.value1,\n                    value2: eventArgs.value2, ignoreBlank: eventArgs.ignoreBlank, inCellDropDown: eventArgs.inCellDropDown\n                };\n                spreadsheet.notify(setValidation, { rules: rules, range: eventArgs.range });\n            }\n            else {\n                spreadsheet.notify(removeValidation, { range: eventArgs.range });\n            }\n            break;\n        case 'merge':\n            options.eventArgs.isAction = false;\n            spreadsheet.notify(setMerge, options.eventArgs);\n            break;\n        case 'clear':\n            spreadsheet.notify(clearViewer, { options: options.eventArgs, isPublic: true });\n            break;\n        case 'conditionalFormat':\n            if (isRedo) {\n                var conditionalFormat = {\n                    type: eventArgs.type, cFColor: eventArgs.cFColor, value: eventArgs.value,\n                    range: eventArgs.range\n                };\n                spreadsheet.notify(setCFRule, { conditionalFormat: conditionalFormat });\n            }\n            else {\n                spreadsheet.notify(clearCFRule, { range: eventArgs.range });\n            }\n            break;\n        case 'clearCF':\n            if (isRedo) {\n                spreadsheet.notify(clearCFRule, { range: eventArgs.selectedRange });\n            }\n            else {\n                spreadsheet.notify(clearCells, {\n                    conditionalFormats: eventArgs.cFormats,\n                    oldRange: eventArgs.oldRange, selectedRange: eventArgs.selectedRange\n                });\n            }\n            break;\n        case 'insertImage':\n            if (isRedo) {\n                spreadsheet.notify(createImageElement, {\n                    options: {\n                        src: options.eventArgs.imageData,\n                        height: options.eventArgs.imageHeight, width: options.eventArgs.imageWidth, imageId: options.eventArgs.id\n                    },\n                    range: options.eventArgs.range, isPublic: false, isUndoRedo: true\n                });\n            }\n            else {\n                spreadsheet.notify(deleteImage, {\n                    id: options.eventArgs.id, sheetIdx: options.eventArgs.sheetIndex + 1, range: options.eventArgs.range\n                });\n            }\n            break;\n        case 'imageRefresh':\n            var element = document.getElementById(options.eventArgs.id);\n            if (isRedo) {\n                options.eventArgs.isUndoRedo = true;\n                spreadsheet.notify(refreshImgCellObj, options.eventArgs);\n            }\n            else {\n                spreadsheet.notify(refreshImgCellObj, {\n                    prevTop: options.eventArgs.currentTop, prevLeft: options.eventArgs.currentLeft,\n                    currentTop: options.eventArgs.prevTop, currentLeft: options.eventArgs.prevLeft, id: options.eventArgs.id,\n                    currentHeight: options.eventArgs.prevHeight, currentWidth: options.eventArgs.prevWidth, requestType: 'imageRefresh',\n                    prevHeight: options.eventArgs.currentHeight, prevWidth: options.eventArgs.currentWidth, isUndoRedo: true\n                });\n            }\n            element.style.height = isRedo ? options.eventArgs.currentHeight + 'px' : options.eventArgs.prevHeight + 'px';\n            element.style.width = isRedo ? options.eventArgs.currentWidth + 'px' : options.eventArgs.prevWidth + 'px';\n            element.style.top = isRedo ? options.eventArgs.currentTop + 'px' : options.eventArgs.prevTop + 'px';\n            element.style.left = isRedo ? options.eventArgs.currentLeft + 'px' : options.eventArgs.prevLeft + 'px';\n            break;\n        case 'insertChart':\n            if (isRedo) {\n                var chartOptions = [{\n                        type: eventArgs.type, theme: eventArgs.theme, isSeriesInRows: eventArgs.isSeriesInRows,\n                        range: eventArgs.range, id: eventArgs.id, height: eventArgs.height, width: eventArgs.width\n                    }];\n                spreadsheet.notify(setChart, {\n                    chart: chartOptions, isInitCell: eventArgs.isInitCell, isUndoRedo: false, range: eventArgs.posRange\n                });\n            }\n            else {\n                spreadsheet.notify(deleteChart, { id: eventArgs.id });\n            }\n            break;\n        case 'deleteChart':\n            if (isRedo) {\n                spreadsheet.notify(deleteChart, { id: eventArgs.id });\n            }\n            else {\n                var chartOpts = [{\n                        type: eventArgs.type, theme: eventArgs.theme, isSeriesInRows: eventArgs.isSeriesInRows,\n                        range: eventArgs.range, id: eventArgs.id, height: eventArgs.height, width: eventArgs.width\n                    }];\n                spreadsheet.notify(setChart, {\n                    chart: chartOpts, isInitCell: eventArgs.isInitCell, isUndoRedo: false, range: eventArgs.posRange\n                });\n            }\n            break;\n        case 'chartRefresh':\n            var chartElement = document.getElementById(options.eventArgs.id);\n            if (chartElement) {\n                chartElement.style.height = isRedo ? options.eventArgs.currentHeight + 'px' : options.eventArgs.prevHeight + 'px';\n                chartElement.style.width = isRedo ? options.eventArgs.currentWidth + 'px' : options.eventArgs.prevWidth + 'px';\n                chartElement.style.top = isRedo ? options.eventArgs.currentTop + 'px' : options.eventArgs.prevTop + 'px';\n                chartElement.style.left = isRedo ? options.eventArgs.currentLeft + 'px' : options.eventArgs.prevLeft + 'px';\n            }\n            if (isRedo) {\n                options.eventArgs.isUndoRedo = true;\n                spreadsheet.notify(refreshChartSize, {\n                    height: chartElement.style.height, width: chartElement.style.width, overlayEle: chartElement\n                });\n            }\n            else {\n                spreadsheet.notify(refreshChartSize, {\n                    height: chartElement.style.height, width: chartElement.style.width, overlayEle: chartElement\n                });\n            }\n            break;\n    }\n}\n/**\n * @hidden\n */\nexport function hasTemplate(workbook, rowIdx, colIdx, sheetIdx) {\n    var sheet = workbook.sheets[sheetIdx];\n    var ranges = sheet.ranges;\n    var range;\n    for (var i = 0, len = ranges.length; i < len; i++) {\n        if (ranges[i].template) {\n            range = getRangeIndexes(ranges[i].address.length ? ranges[i].address : ranges[i].startCell);\n            if (range[0] <= rowIdx && range[1] <= colIdx && range[2] >= rowIdx && range[3] >= colIdx) {\n                return true;\n            }\n        }\n    }\n    return false;\n}\n/**\n * Setting row height in view an model.\n * @hidden\n */\nexport function setRowEleHeight(parent, sheet, height, rowIdx, row, hRow, notifyRowHgtChange) {\n    if (notifyRowHgtChange === void 0) { notifyRowHgtChange = true; }\n    var prevHgt = getRowHeight(sheet, rowIdx);\n    var edit = parent.element.querySelector('.e-spreadsheet-edit');\n    if (edit && (edit.innerHTML.indexOf('\\n') > -1)) {\n        var actCell = getCellIndexes(parent.getActiveSheet().activeCell);\n        var cell = getCell(actCell[0], actCell[1], sheet);\n        var i = void 0;\n        var splitVal = edit.innerHTML.split('\\n');\n        var n = 0;\n        var valLength = splitVal.length;\n        for (i = 0; i < valLength; i++) {\n            var lines = getLines(splitVal[i], getColumnWidth(sheet, actCell[1]), cell.style, parent.cellStyle);\n            if (lines === 0) {\n                lines = 1; // for empty new line\n            }\n            n = n + lines;\n        }\n        height = getTextHeight(parent, cell.style || parent.cellStyle, n) + 1;\n    }\n    if (row || parent.getRow(rowIdx)) {\n        (row || parent.getRow(rowIdx)).style.height = height + \"px\";\n    }\n    if (sheet.showHeaders && hRow || parent.getRow(rowIdx, parent.getRowHeaderTable())) {\n        (hRow || parent.getRow(rowIdx, parent.getRowHeaderTable())).style.height = height + \"px\";\n    }\n    setRowHeight(sheet, rowIdx, height);\n    parent.setProperties({ sheets: parent.sheets }, true);\n    if (notifyRowHgtChange) {\n        parent.notify(rowHeightChanged, { rowIdx: rowIdx, threshold: height - prevHgt });\n    }\n}\n/** @hidden */\nexport function getTextHeight(context, style, lines) {\n    if (lines === void 0) { lines = 1; }\n    var fontSize = (style && style.fontSize) || context.cellStyle.fontSize;\n    var fontSizePx = fontSize.indexOf('pt') > -1 ? parseInt(fontSize, 10) * 1.33 : parseInt(fontSize, 10);\n    return Math.ceil(fontSizePx * (style && style.fontFamily === 'Arial Black' ? 1.44 : 1.24) * lines);\n}\n/** @hidden */\nexport function getTextWidth(text, style, parentStyle) {\n    if (!style) {\n        style = parentStyle;\n    }\n    var canvas = document.createElement('canvas');\n    var context = canvas.getContext('2d');\n    context.font = (style.fontStyle || parentStyle.fontStyle) + ' ' + (style.fontWeight || parentStyle.fontWeight) + ' '\n        + (style.fontSize || parentStyle.fontSize) + ' ' + (style.fontFamily || parentStyle.fontFamily);\n    return context.measureText(text).width;\n}\n/**\n * @hidden\n */\nexport function getLines(text, colwidth, style, parentStyle) {\n    var width;\n    var prevWidth = 0;\n    var textArr = text.toString().split(' ');\n    var spaceWidth = getTextWidth(' ', style, parentStyle);\n    var lines;\n    var cnt = 0;\n    colwidth -= 5; // for padding\n    textArr.forEach(function (txt) {\n        var lWidth = 0;\n        var cWidth = 0;\n        width = getTextWidth(txt, style, parentStyle);\n        lines = (prevWidth + width) / colwidth;\n        if (lines >= 1) {\n            if (prevWidth) {\n                cnt++;\n            }\n            if (width / colwidth >= 1) {\n                txt.split('').forEach(function (val) {\n                    cWidth = getTextWidth(val, style, parentStyle);\n                    lWidth += cWidth;\n                    if (lWidth > colwidth) {\n                        cnt++;\n                        lWidth = cWidth;\n                    }\n                });\n                prevWidth = lWidth + spaceWidth;\n            }\n            else {\n                prevWidth = width + spaceWidth;\n            }\n        }\n        else {\n            prevWidth += (width + spaceWidth);\n        }\n    });\n    if (prevWidth) {\n        cnt += Math.ceil((prevWidth - spaceWidth) / colwidth);\n    }\n    return cnt;\n}\n/**\n * Setting maximum height while doing formats and wraptext\n * @hidden\n */\nexport function setMaxHgt(sheet, rIdx, cIdx, hgt) {\n    if (!sheet.maxHgts[rIdx]) {\n        sheet.maxHgts[rIdx] = {};\n    }\n    sheet.maxHgts[rIdx][cIdx] = hgt;\n}\n/**\n * Getting maximum height by comparing each cell's modified height.\n * @hidden\n */\nexport function getMaxHgt(sheet, rIdx) {\n    var maxHgt = 0;\n    var rowHgt = sheet.maxHgts[rIdx];\n    if (rowHgt) {\n        Object.keys(rowHgt).forEach(function (key) {\n            if (rowHgt[key] > maxHgt) {\n                maxHgt = rowHgt[key];\n            }\n        });\n    }\n    return maxHgt;\n}\n/** @hidden */\nexport function skipHiddenIdx(sheet, index, increase, layout) {\n    if (layout === void 0) { layout = 'rows'; }\n    if (index < 0) {\n        index = -1;\n    }\n    if ((sheet[layout])[index] && (sheet[layout])[index].hidden) {\n        increase ? index++ : index--;\n        index = skipHiddenIdx(sheet, index, increase, layout);\n    }\n    return index;\n}\n","/**\n * Specifies Workbook internal events.\n */\n/** @hidden */\nexport var workbookDestroyed = 'workbookDestroyed';\n/** @hidden */\nexport var updateSheetFromDataSource = 'updateSheetFromDataSource';\n/** @hidden */\nexport var dataSourceChanged = 'dataSourceChanged';\n/** @hidden */\nexport var dataChanged = 'dataChanged';\n/** @hidden */\nexport var workbookOpen = 'workbookOpen';\n/** @hidden */\nexport var beginSave = 'beginSave';\n/** @hidden */\nexport var getFilteredCollection = 'getFilteredCollection';\n/** @hidden */\nexport var saveCompleted = 'saveCompleted';\n/** @hidden */\nexport var applyNumberFormatting = 'applyNumber';\n/** @hidden */\nexport var getFormattedCellObject = 'getFormattedCell';\n/** @hidden */\nexport var refreshCellElement = 'refreshCellElem';\n/** @hidden */\nexport var setCellFormat = 'setCellFormat';\n/** @hidden */\nexport var findAllValues = 'findAllValues';\n/** @hidden */\nexport var textDecorationUpdate = 'textDecorationUpdate';\n/** @hidden */\nexport var applyCellFormat = 'applyCellFormat';\n/** @hidden */\nexport var updateUsedRange = 'updateUsedRange';\n/** @hidden */\nexport var workbookFormulaOperation = 'workbookFormulaOperation';\n/** @hidden */\nexport var workbookEditOperation = 'workbookEditOperation';\n/** @hidden */\nexport var checkDateFormat = 'checkDateFormat';\n/** @hidden */\nexport var getFormattedBarText = 'getFormattedBarText';\n/** @hidden */\nexport var activeCellChanged = 'activeCellChanged';\n/** @hidden */\nexport var openSuccess = 'openSuccess';\n/** @hidden */\nexport var openFailure = 'openFailure';\n/** @hidden */\nexport var sheetCreated = 'sheetCreated';\n/** @hidden */\nexport var sheetsDestroyed = 'sheetsDestroyed';\n/** @hidden */\nexport var aggregateComputation = 'aggregateComputation';\n/** @hidden */\nexport var beforeSort = 'beforeSort';\n/** @hidden */\nexport var initiateSort = 'initiateSort';\n/** @hidden */\nexport var sortComplete = 'sortComplete';\n/** @hidden */\nexport var sortRangeAlert = 'sortRangeAlert';\n/** @hidden */\nexport var initiatelink = 'initiatelink';\n/** @hidden */\nexport var beforeHyperlinkCreate = 'beforeHyperlinkCreate';\n/** @hidden */\nexport var afterHyperlinkCreate = 'afterHyperlinkCreate';\n/** @hidden */\nexport var beforeHyperlinkClick = 'beforeHyperlinkClick';\n/** @hidden */\nexport var afterHyperlinkClick = 'afterHyperlinkClick';\n/** @hidden */\nexport var addHyperlink = 'addHyperlink';\n/** @hidden */\nexport var setLinkModel = 'setLinkModel';\n/** @hidden */\nexport var beforeFilter = 'beforeFilter';\n/** @hidden */\nexport var initiateFilter = 'initiateFilter';\n/** @hidden */\nexport var filterComplete = 'filterComplete';\n/** @hidden */\nexport var filterRangeAlert = 'filterRangeAlert';\n/** @hidden */\nexport var clearAllFilter = 'clearAllFilter';\n/** @hidden */\nexport var wrapEvent = 'wrapText';\n/** @hidden */\nexport var onSave = 'onSave';\n/** @hidden */\nexport var insert = 'insert';\n/** @hidden */\nexport var deleteAction = 'delete';\n/** @hidden */\nexport var insertModel = 'insertModel';\n/** @hidden */\nexport var deleteModel = 'deleteModel';\n/** @hidden */\nexport var isValidation = 'isValidation';\n/** @hidden */\nexport var setValidation = 'setValidation';\n/** @hidden */\nexport var addHighlight = 'addHighlight';\n/** @hidden */\nexport var dataValidate = 'dataValidate';\n/** @hidden */\nexport var findNext = 'findNext';\n/** @hidden */\nexport var findPrevious = 'findPrevious';\n/** @hidden */\nexport var goto = 'gotoHandler';\n/** @hidden */\nexport var findWorkbookHandler = 'findHandler';\n/** @hidden */\nexport var replaceHandler = 'replace';\n/** @hidden */\nexport var replaceAllHandler = 'replaceAll';\n/** @hidden */\nexport var showDialog = 'ShowDialog';\n/** @hidden */\nexport var findUndoRedo = 'findUndoRedo';\n/** @hidden */\nexport var findKeyUp = 'findKeyUp';\n/** @hidden */\nexport var removeValidation = 'removeValidation';\n/** @hidden */\nexport var removeHighlight = 'removeHighlight';\n/** @hidden */\nexport var queryCellInfo = 'queryCellInfo';\n/** @hidden */\nexport var count = 'count';\n/** @hidden */\nexport var findCount = 'findCount';\n/** @hidden */\nexport var protectSheetWorkBook = 'protectSheet';\n/** @hidden */\nexport var updateToggle = 'updateToggleItem';\n/** @hidden */\nexport var protectsheetHandler = 'protectsheetHandler';\n/** @hidden */\nexport var replaceAllDialog = 'replaceAllDialog';\n/** @hidden */\nexport var unprotectsheetHandler = 'unprotectsheetHandler';\n/** @hidden */\nexport var workBookeditAlert = 'editAlert';\n/** @hidden */\nexport var setLockCells = 'setLockCells';\n/** @hidden */\nexport var applyLockCells = 'applyLockCells';\n/** @hidden */\nexport var setMerge = 'setMerge';\n/** @hidden */\nexport var applyMerge = 'applyMerge';\n/** @hidden */\nexport var mergedRange = 'mergedRange';\n/** @hidden */\nexport var activeCellMergedRange = 'activeCellMergedRange';\n/** @hidden */\nexport var insertMerge = 'insertMerge';\n/** @hidden */\nexport var pasteMerge = 'pasteMerge';\n/** @hidden */\nexport var setCFRule = 'setCFRule';\n/** @hidden */\nexport var cFInitialCheck = 'cFInitialCheck';\n/** @hidden */\nexport var clearCFRule = 'clearCFRule';\n/** @hidden */\nexport var initiateClearCFRule = 'initiateClearCFRule';\n/** @hidden */\nexport var cFRender = 'cFRender';\n/** @hidden */\nexport var cFDelete = 'cFDelete';\n/** @hidden */\nexport var clear = 'clear';\n/** @hidden */\nexport var clearCF = 'clearCF';\n/** @hidden */\nexport var clearCells = 'clearCells';\n/** @hidden */\nexport var setImage = 'setImage';\n/** @hidden */\nexport var setChart = 'setChart';\n/** @hidden */\nexport var initiateChart = 'initiateChart';\n/** @hidden */\nexport var refreshRibbonIcons = 'refreshRibbonIcons';\n/** @hidden */\nexport var refreshChart = 'refreshChart';\n/** @hidden */\nexport var refreshChartSize = 'refreshChartSize';\n/** @hidden */\nexport var updateChart = 'updateChart';\n/** @hidden */\nexport var deleteChartColl = 'deleteChartColl';\n/** @hidden */\nexport var initiateChartModel = 'initiateChartModel';\n/** @hidden */\nexport var focusChartBorder = 'focusChartBorder';\n/** @hidden */\nexport var saveError = 'saveError';\n","import { DataManager, Query, Deferred } from '@syncfusion/ej2-data';\nimport { getCell, setCell } from '../base/index';\nimport { getRangeIndexes, checkIsFormula, updateSheetFromDataSource, checkDateFormat, dataSourceChanged } from '../common/index';\nimport { getCellIndexes, dataChanged, getCellAddress } from '../common/index';\nimport { getFormatFromType } from './number-format';\n/**\n * Data binding module\n */\nvar DataBind = /** @class */ (function () {\n    function DataBind(parent) {\n        this.parent = parent;\n        this.requestedInfo = [];\n        this.addEventListener();\n    }\n    DataBind.prototype.addEventListener = function () {\n        this.parent.on(updateSheetFromDataSource, this.updateSheetFromDataSourceHandler, this);\n        this.parent.on(dataSourceChanged, this.dataSourceChangedHandler, this);\n        this.parent.on(dataChanged, this.dataChangedHandler, this);\n    };\n    DataBind.prototype.removeEventListener = function () {\n        if (!this.parent.isDestroyed) {\n            this.parent.off(updateSheetFromDataSource, this.updateSheetFromDataSourceHandler);\n            this.parent.off(dataSourceChanged, this.dataSourceChangedHandler);\n            this.parent.off(dataChanged, this.dataChangedHandler);\n        }\n    };\n    /**\n     * Update given data source to sheet.\n     */\n    // tslint:disable-next-line\n    DataBind.prototype.updateSheetFromDataSourceHandler = function (args) {\n        var _this = this;\n        var cell;\n        var flds;\n        var sCellIdx;\n        var result;\n        var remoteUrl;\n        var isLocal;\n        var dataManager;\n        var requestedRange = [];\n        var sRanges = [];\n        var rowIdx;\n        var deferred = new Deferred();\n        var sRowIdx;\n        var sColIdx;\n        var loadedInfo;\n        args.promise = deferred.promise;\n        if (args.sheet && args.sheet.ranges.length) {\n            var _loop_1 = function (k) {\n                var sRange = args.indexes[0];\n                var eRange = args.indexes[2];\n                var range = args.sheet.ranges[k];\n                sRowIdx = getRangeIndexes(range.startCell)[0];\n                dataManager = range.dataSource instanceof DataManager ? range.dataSource\n                    : range.dataSource ? new DataManager(range.dataSource) : new DataManager();\n                remoteUrl = remoteUrl || dataManager.dataSource.url;\n                args.sheet.isLocalData = isLocal || !dataManager.dataSource.url;\n                if (sRowIdx <= sRange) {\n                    sRange = sRange - sRowIdx;\n                }\n                else {\n                    if (sRowIdx <= eRange) {\n                        eRange = eRange - sRowIdx;\n                        sRange = 0;\n                    }\n                    else {\n                        sRange = -1;\n                    }\n                }\n                if (range.showFieldAsHeader && sRange !== 0) {\n                    sRange -= 1;\n                }\n                var isEndReached = false;\n                var insertRowCount = 0;\n                this_1.initRangeInfo(range);\n                var count = this_1.getMaxCount(range);\n                loadedInfo = this_1.getLoadedInfo(sRange, eRange, range);\n                sRange = loadedInfo.unloadedRange[0];\n                eRange = loadedInfo.unloadedRange[1];\n                if (range.info.insertRowRange) {\n                    range.info.insertRowRange.forEach(function (range) {\n                        insertRowCount += ((range[1] - range[0]) + 1);\n                    });\n                    sRange -= insertRowCount;\n                    eRange -= insertRowCount;\n                }\n                if (sRange > count) {\n                    isEndReached = true;\n                }\n                else if (eRange > count) {\n                    eRange = count;\n                }\n                this_1.requestedInfo.push({ deferred: deferred, indexes: args.indexes, isNotLoaded: loadedInfo.isNotLoaded });\n                if (sRange >= 0 && loadedInfo.isNotLoaded && !isEndReached) {\n                    sRanges[k] = sRange;\n                    requestedRange[k] = false;\n                    var query = (range.query ? range.query : new Query()).clone();\n                    dataManager.executeQuery(query.range(sRange, eRange >= count ? eRange : eRange + 1)\n                        .requiresCount()).then(function (e) {\n                        if (!_this.parent || _this.parent.isDestroyed) {\n                            return;\n                        }\n                        result = (e.result && e.result.result ? e.result.result : e.result);\n                        sCellIdx = getRangeIndexes(range.startCell);\n                        sRowIdx = sCellIdx[0];\n                        sColIdx = sCellIdx[1];\n                        if (result.length) {\n                            if (!range.info.count) {\n                                count = e.count;\n                                range.info.count = e.count;\n                            }\n                            flds = Object.keys(result[0]);\n                            if (!range.info.fldLen) {\n                                range.info.fldLen = flds.length;\n                                range.info.flds = flds;\n                            }\n                            if (range.info.insertColumnRange) {\n                                var insertCount_1 = 0;\n                                range.info.insertColumnRange.forEach(function (insertRange) {\n                                    for (var i = insertRange[0]; i <= insertRange[1]; i++) {\n                                        i <= sColIdx ? flds.splice(0, 0, \"emptyCell\" + insertCount_1) : flds.splice(i - sColIdx, 0, \"emptyCell\" + insertCount_1);\n                                        insertCount_1++;\n                                    }\n                                });\n                            }\n                            if (sRanges[k] === 0 && range.showFieldAsHeader) {\n                                rowIdx = sRowIdx + sRanges[k] + insertRowCount;\n                                flds.forEach(function (field, i) {\n                                    cell = getCell(rowIdx, sColIdx + i, args.sheet, true);\n                                    if (!cell) {\n                                        args.sheet.rows[sRowIdx + sRanges[k]].cells[sColIdx + i] = field.includes('emptyCell') ? {}\n                                            : { value: field };\n                                    }\n                                    else if (!cell.value && !field.includes('emptyCell')) {\n                                        cell.value = field;\n                                    }\n                                });\n                            }\n                            result.forEach(function (item, i) {\n                                rowIdx = sRowIdx + sRanges[k] + i + (range.showFieldAsHeader ? 1 : 0) + insertRowCount;\n                                for (var j = 0; j < flds.length; j++) {\n                                    cell = getCell(rowIdx, sColIdx + j, args.sheet, true);\n                                    if (cell) {\n                                        if (!cell.value && !flds[j].includes('emptyCell')) {\n                                            setCell(rowIdx, sColIdx + j, args.sheet, _this.getCellDataFromProp(item[flds[j]]), true);\n                                        }\n                                    }\n                                    else {\n                                        args.sheet.rows[rowIdx].cells[sColIdx + j] =\n                                            flds[j].includes('emptyCell') ? {} : _this.getCellDataFromProp(item[flds[j]]);\n                                    }\n                                    _this.checkDataForFormat({\n                                        args: args, cell: cell, colIndex: sColIdx + j, rowIndex: rowIdx, i: i, j: j, k: k,\n                                        range: range, sRanges: sRanges, value: item[flds[j]]\n                                    });\n                                }\n                            });\n                        }\n                        else {\n                            flds = [];\n                        }\n                        args.sheet.usedRange.rowIndex = Math.max((sRowIdx + (count || e.count) + (range.showFieldAsHeader ? 1 : 0) + insertRowCount) - 1, args.sheet.usedRange.rowIndex);\n                        args.sheet.usedRange.colIndex = Math.max(sColIdx + flds.length - 1, args.sheet.usedRange.colIndex);\n                        if (insertRowCount) {\n                            loadedInfo = _this.getLoadedInfo(sRange, eRange, range);\n                            sRange = loadedInfo.unloadedRange[0];\n                            eRange = loadedInfo.unloadedRange[1];\n                            if (sRange > count) {\n                                loadedInfo.isNotLoaded = false;\n                            }\n                            if (loadedInfo.isNotLoaded) {\n                                if (eRange > count) {\n                                    eRange = count;\n                                }\n                                range.info.loadedRange.push([sRange, eRange]);\n                            }\n                        }\n                        else {\n                            range.info.loadedRange.push([sRange, eRange]);\n                        }\n                        requestedRange[k] = true;\n                        if (requestedRange.indexOf(false) === -1) {\n                            if (eRange + sRowIdx < sRowIdx + range.info.count) {\n                                if (!args.rangeSettingCount) {\n                                    args.rangeSettingCount = [];\n                                }\n                                args.rangeSettingCount.push(k);\n                                //if (remoteUrl) {\n                                var unloadedArgs = {\n                                    sheet: args.sheet, indexes: [0, 0, args.sheet.usedRange.rowIndex, args.sheet.usedRange.colIndex],\n                                    promise: new Promise(function (resolve, reject) { resolve((function () { })()); }),\n                                    rangeSettingCount: args.rangeSettingCount\n                                };\n                                _this.updateSheetFromDataSourceHandler(unloadedArgs);\n                                unloadedArgs.promise.then(function () {\n                                    if (_this.parent.getModuleName() === 'workbook') {\n                                        return;\n                                    }\n                                    args.rangeSettingCount.pop();\n                                    if (!args.rangeSettingCount.length) {\n                                        _this.parent.notify('created', null);\n                                    }\n                                });\n                                //}\n                            }\n                            _this.checkResolve(args.indexes);\n                        }\n                    });\n                }\n                else if (k === 0 && requestedRange.indexOf(false) === -1) {\n                    this_1.checkResolve(args.indexes);\n                }\n            };\n            var this_1 = this;\n            for (var k = args.sheet.ranges.length - 1; k >= 0; k--) {\n                _loop_1(k);\n            }\n        }\n        else {\n            deferred.resolve();\n        }\n    };\n    DataBind.prototype.checkResolve = function (indexes) {\n        var resolved;\n        var isSameRng;\n        var cnt = 0;\n        this.requestedInfo.forEach(function (info, idx) {\n            isSameRng = JSON.stringify(info.indexes) === JSON.stringify(indexes);\n            if (isSameRng || resolved) {\n                if (idx === 0) {\n                    info.deferred.resolve();\n                    cnt++;\n                    resolved = true;\n                }\n                else {\n                    if (resolved && (info.isLoaded || !info.isNotLoaded)) {\n                        info.deferred.resolve();\n                        cnt++;\n                    }\n                    else if (isSameRng && resolved) {\n                        info.deferred.resolve();\n                        cnt++;\n                    }\n                    else if (isSameRng) {\n                        info.isLoaded = true;\n                    }\n                    else {\n                        resolved = false;\n                    }\n                }\n            }\n        });\n        this.requestedInfo.splice(0, cnt);\n    };\n    DataBind.prototype.getCellDataFromProp = function (prop) {\n        var data = {};\n        if (Object.prototype.toString.call(prop) === '[object Object]') {\n            if (prop.formula) {\n                data.formula = prop.formula;\n            }\n            else if (prop.value) {\n                if (typeof (prop.value) === 'string') {\n                    if (prop.value.indexOf('http://') === 0 || prop.value.indexOf('https://') === 0 ||\n                        prop.value.indexOf('ftp://') === 0 || prop.value.indexOf('www.') === 0) {\n                        data.hyperlink = prop.value;\n                    }\n                    else {\n                        data.value = prop.value;\n                    }\n                }\n                else {\n                    data.value = prop.value;\n                }\n            }\n        }\n        else {\n            if (checkIsFormula(prop)) {\n                data.formula = prop;\n            }\n            else {\n                if (typeof (prop) === 'string') {\n                    if (prop.indexOf('http://') === 0 || prop.indexOf('https://') === 0 ||\n                        prop.indexOf('ftp://') === 0 || prop.indexOf('www.') === 0) {\n                        data.hyperlink = prop;\n                    }\n                    else {\n                        data.value = prop;\n                    }\n                }\n                else {\n                    data.value = prop;\n                }\n            }\n        }\n        return data;\n    };\n    DataBind.prototype.checkDataForFormat = function (args) {\n        if (args.value !== '') {\n            var dateEventArgs = {\n                value: args.value,\n                rowIndex: args.rowIndex,\n                colIndex: args.colIndex,\n                isDate: false,\n                updatedVal: args.value,\n                isTime: false\n            };\n            this.parent.notify(checkDateFormat, dateEventArgs);\n            if (dateEventArgs.isDate) {\n                if (args.cell) {\n                    args.cell.format = getFormatFromType('ShortDate');\n                    args.cell.value = dateEventArgs.updatedVal;\n                }\n                else {\n                    args.args.sheet.rows[args.rowIndex]\n                        .cells[args.colIndex].format = getFormatFromType('ShortDate');\n                    args.args.sheet.rows[args.rowIndex]\n                        .cells[args.colIndex].value = dateEventArgs.updatedVal;\n                }\n            }\n            else if (dateEventArgs.isTime) {\n                if (args.cell) {\n                    args.cell.format = getFormatFromType('Time');\n                    args.cell.value = dateEventArgs.updatedVal;\n                }\n                else {\n                    args.args.sheet.rows[args.rowIndex]\n                        .cells[args.colIndex].format = getFormatFromType('Time');\n                    args.args.sheet.rows[args.rowIndex]\n                        .cells[args.colIndex].value = dateEventArgs.updatedVal;\n                }\n            }\n        }\n    };\n    DataBind.prototype.getLoadedInfo = function (sRange, eRange, range) {\n        var isNotLoaded = true;\n        range.info.loadedRange.forEach(function (range) {\n            if (range[0] <= sRange && sRange <= range[1]) {\n                if (range[0] <= eRange && eRange <= range[1]) {\n                    isNotLoaded = false;\n                }\n                else {\n                    sRange = range[1] + 1;\n                }\n            }\n            else if (range[0] <= eRange && eRange <= range[1]) {\n                eRange = range[0] - 1;\n            }\n        });\n        return { isNotLoaded: isNotLoaded, unloadedRange: [sRange, eRange] };\n    };\n    DataBind.prototype.getMaxCount = function (range) {\n        if (range.query) {\n            var query = range.query.queries;\n            for (var i = 0; i < query.length; i++) {\n                if (query[i].fn === 'onTake') {\n                    return Math.min(query[i].e.nos, range.info.count || query[i].e.nos);\n                }\n            }\n        }\n        return range.info.count;\n    };\n    DataBind.prototype.initRangeInfo = function (range) {\n        if (!range.info) {\n            range.info = { loadedRange: [] };\n        }\n    };\n    /**\n     * Remove old data from sheet.\n     */\n    DataBind.prototype.dataSourceChangedHandler = function (args) {\n        var _this = this;\n        var row;\n        var sheet = this.parent.sheets[args.sheetIdx];\n        var range = sheet.ranges[args.rangeIdx];\n        if (range && (this.checkRangeHasChanges(sheet, args.rangeIdx) || !range.info)) {\n            var showFieldAsHeader_1 = range.showFieldAsHeader;\n            var indexes_1 = getCellIndexes(range.startCell);\n            if (range.info) {\n                range.info.loadedRange.forEach(function (loadedRange) {\n                    for (var i = loadedRange[0]; i <= loadedRange[1] && (i < range.info.count + (showFieldAsHeader_1 ? 1 : 0)); i++) {\n                        row = sheet.rows[i + indexes_1[0]];\n                        if (row) {\n                            for (var j = indexes_1[1]; j < indexes_1[1] + range.info.fldLen; j++) {\n                                if (row.cells && row.cells[j]) {\n                                    delete row.cells[j];\n                                }\n                            }\n                        }\n                    }\n                });\n                range.info = null;\n            }\n            var viewport = this.parent.viewport;\n            var refreshRange_1 = [viewport.topIndex, viewport.leftIndex, viewport.bottomIndex, viewport.rightIndex];\n            var args_1 = {\n                sheet: sheet, indexes: refreshRange_1, promise: new Promise(function (resolve, reject) { resolve((function () { })()); })\n            };\n            this.updateSheetFromDataSourceHandler(args_1);\n            args_1.promise.then(function () {\n                _this.parent.notify('updateView', { indexes: refreshRange_1 });\n            });\n        }\n    };\n    DataBind.prototype.checkRangeHasChanges = function (sheet, rangeIdx) {\n        if (this.parent.isAngular) {\n            var changedRangeIdx = 'changedRangeIdx';\n            if (sheet[changedRangeIdx] === parseInt(rangeIdx, 10)) {\n                delete sheet[changedRangeIdx];\n                return true;\n            }\n            return false;\n        }\n        else {\n            return true;\n        }\n    };\n    /**\n     * Triggers dataSourceChange event when cell data changes\n     */\n    DataBind.prototype.dataChangedHandler = function (args) {\n        var _this = this;\n        var changedData = [{}];\n        var action;\n        var cell;\n        var dataRange;\n        var startCell;\n        var inRange;\n        var deleteRowDetails;\n        var sheetIdx = this.parent.activeSheetIndex;\n        var sheet = this.parent.sheets[sheetIdx];\n        var cellIndices;\n        sheet.ranges.forEach(function (range, idx) {\n            if (range.dataSource) {\n                var isNewRow = void 0;\n                startCell = getCellIndexes(range.startCell);\n                dataRange = startCell.concat([startCell[0] + range.info.count + (range.showFieldAsHeader ? 0 : -1),\n                    startCell[1] + range.info.fldLen - 1]);\n                if (args.modelType === 'Row') {\n                    if (args.insertType) {\n                        inRange = ((!range.showFieldAsHeader && args.insertType === 'above') ? dataRange[0] <= args.index\n                            : dataRange[0] < args.index) && dataRange[2] >= args.index;\n                        cellIndices = [args.index];\n                        if (!inRange) {\n                            if ((dataRange[2] + 1 === args.index && args.insertType === 'below')) {\n                                isNewRow = true;\n                                range.info.count += args.model.length;\n                            }\n                            else if (dataRange[0] >= args.index) {\n                                range.startCell = getCellAddress(startCell[0] + args.model.length, startCell[1]);\n                            }\n                        }\n                        else {\n                            isNewRow = true;\n                            range.info.count += args.model.length;\n                        }\n                    }\n                    else {\n                        inRange = dataRange[0] <= args.startIndex && dataRange[2] >= args.startIndex;\n                        action = 'delete';\n                    }\n                }\n                else {\n                    cellIndices = getCellIndexes(args.sheetIdx > -1 ? args.address : args.address.split('!')[1]);\n                    inRange = ((range.showFieldAsHeader ? dataRange[0] + 1 : dataRange[0]) <= cellIndices[0])\n                        && dataRange[2] >= cellIndices[0] && dataRange[1] <= cellIndices[1] && dataRange[3] >= cellIndices[1];\n                }\n                if (inRange || isNewRow) {\n                    if (args.modelType === 'Row' && !args.insertType) {\n                        args.deletedModel.forEach(function (row, rowIdx) {\n                            changedData[rowIdx] = {};\n                            range.info.flds.forEach(function (fld, idx) {\n                                if (row.cells) {\n                                    cell = row.cells[startCell[1] + idx];\n                                    changedData[rowIdx][fld] = (cell && cell.value) || null;\n                                }\n                                else {\n                                    changedData[rowIdx][fld] = null;\n                                }\n                            });\n                            range.info.count -= 1;\n                        });\n                        deleteRowDetails = { count: args.deletedModel.length, index: args.endIndex };\n                    }\n                    else {\n                        action = isNewRow ? 'add' : 'edit';\n                        var _loop_2 = function (i) {\n                            changedData[i] = {};\n                            range.info.flds.forEach(function (fld, idx) {\n                                cell = getCell(cellIndices[0], startCell[1] + idx, sheet);\n                                changedData[i][fld] = (cell && cell.value) || null;\n                            });\n                        };\n                        for (var i = 0; i < (isNewRow ? args.model.length : 1); i++) {\n                            _loop_2(i);\n                        }\n                    }\n                    _this.parent.trigger('dataSourceChanged', { data: changedData, action: action, rangeIndex: idx, sheetIndex: sheetIdx });\n                }\n                else if (deleteRowDetails && deleteRowDetails.count && dataRange[0] > deleteRowDetails.index) {\n                    range.startCell = getCellAddress(startCell[0] - deleteRowDetails.count, startCell[1]);\n                }\n            }\n        });\n    };\n    /**\n     * For internal use only - Get the module name.\n     * @private\n     */\n    DataBind.prototype.getModuleName = function () {\n        return 'dataBind';\n    };\n    /**\n     * Destroys the Data binding module.\n     * @return {void}\n     */\n    DataBind.prototype.destroy = function () {\n        this.removeEventListener();\n        this.parent = null;\n        this.requestedInfo = [];\n    };\n    return DataBind;\n}());\nexport { DataBind };\n","/**\n * Specifies spreadsheet internal events\n */\n/** @hidden */\nexport var ribbon = 'ribbon';\n/** @hidden */\nexport var formulaBar = 'formulaBar';\n/** @hidden */\nexport var sheetTabs = 'sheetTabs';\n/** @hidden */\nexport var refreshSheetTabs = 'refreshSheetTabs';\n/** @hidden */\nexport var isFormulaBarEdit = 'isFormulaBarEdit';\n/** @hidden */\nexport var dataRefresh = 'dataRefresh';\n/** @hidden */\nexport var initialLoad = 'initialLoad';\n/** @hidden */\nexport var contentLoaded = 'contentLoaded';\n/** @hidden */\nexport var mouseDown = 'mouseDown';\n/** @hidden */\nexport var spreadsheetDestroyed = 'spreadsheetDestroyed';\n/** @hidden */\nexport var editOperation = 'editOperation';\n/** @hidden */\nexport var formulaOperation = 'formulaOperation';\n/** @hidden */\nexport var formulaBarOperation = 'formulaBarOperation';\n/** @hidden */\nexport var click = 'click';\n/** @hidden */\nexport var keyUp = 'keyUp';\n/** @hidden */\nexport var keyDown = 'keyDown';\n/** @hidden */\nexport var formulaKeyUp = 'formulaKeyUp';\n/** @hidden */\nexport var formulaBarUpdate = 'formulaBarUpdate';\n/** @hidden */\nexport var onVerticalScroll = 'verticalScroll';\n/** @hidden */\nexport var onHorizontalScroll = 'horizontalScroll';\n/** @hidden */\nexport var beforeContentLoaded = 'beforeContentLoaded';\n/** @hidden */\nexport var beforeVirtualContentLoaded = 'beforeVirtualContentLoaded';\n/** @hidden */\nexport var virtualContentLoaded = 'virtualContentLoaded';\n/** @hidden */\nexport var contextMenuOpen = 'contextMenuOpen';\n/** @hidden */\nexport var cellNavigate = 'cellNavigate';\n/** @hidden */\nexport var mouseUpAfterSelection = 'mouseUpAfterSelection';\n/** @hidden */\nexport var selectionComplete = 'selectionComplete';\n/** @hidden */\nexport var cMenuBeforeOpen = 'contextmenuBeforeOpen';\n/** @hidden */\nexport var insertSheetTab = 'insertSheetTab';\n/** @hidden */\nexport var removeSheetTab = 'removeSheetTab';\n/** @hidden */\nexport var renameSheetTab = 'renameSheetTab';\n/** @hidden */\nexport var ribbonClick = 'ribboClick';\n/** @hidden */\nexport var refreshRibbon = 'ribbonRefresh';\n/** @hidden */\nexport var enableToolbarItems = 'enableToolbarItems';\n/** @hidden */\nexport var tabSwitch = 'tabSwitch';\n/** @hidden */\nexport var selectRange = 'selectRange';\n/** @hidden */\nexport var cut = 'cut';\n/** @hidden */\nexport var copy = 'copy';\n/** @hidden */\nexport var paste = 'paste';\n/** @hidden */\nexport var clearCopy = 'clearCopy';\n/** @hidden */\nexport var dataBound = 'dataBound';\n/** @hidden */\nexport var beforeDataBound = 'beforeDataBound';\n/** @hidden */\nexport var addContextMenuItems = 'addContextMenuItems';\n/** @hidden */\nexport var removeContextMenuItems = 'removeContextMenuItems';\n/** @hidden */\nexport var enableContextMenuItems = 'enableContextMenuItems';\n/** @hidden */\nexport var enableFileMenuItems = 'enableFileMenuItems';\n/** @hidden */\nexport var hideFileMenuItems = 'hideFileMenuItems';\n/** @hidden */\nexport var addFileMenuItems = 'addFileMenuItems';\n/** @hidden */\nexport var hideRibbonTabs = 'hideRibbonTabs';\n/** @hidden */\nexport var enableRibbonTabs = 'enableRibbonTabs';\n/** @hidden */\nexport var addRibbonTabs = 'addRibbonTabs';\n/** @hidden */\nexport var addToolbarItems = 'addToolbarItems';\n/** @hidden */\nexport var hideToolbarItems = 'hideToolbarItems';\n/** @hidden */\nexport var beforeRibbonCreate = 'beforeRibbonCreate';\n/** @hidden */\nexport var rowHeightChanged = 'rowHeightChanged';\n/** @hidden */\nexport var colWidthChanged = 'colWidthChanged';\n/** @hidden */\nexport var beforeHeaderLoaded = 'beforeHeaderLoaded';\n/** @hidden */\nexport var onContentScroll = 'onContentScroll';\n/** @hidden */\nexport var deInitProperties = 'deInitProperties';\n/** @hidden */\nexport var activeSheetChanged = 'activeSheetChanged';\n/** @hidden */\nexport var renameSheet = 'renameSheet';\n/** @hidden */\nexport var initiateCustomSort = 'initiateCustomSort';\n/** @hidden */\nexport var applySort = 'applySort';\n/** @hidden */\nexport var collaborativeUpdate = 'collaborativeUpdate';\n/** @hidden */\nexport var hideShow = 'hideShow';\n/** @hidden */\nexport var autoFit = 'autoFitRowsColumns';\n/** @hidden */\nexport var updateToggleItem = 'updateToggleItem';\n/** @hidden */\nexport var initiateHyperlink = 'initiateHyperlink';\n/** @hidden */\nexport var editHyperlink = 'editHyperlink';\n/** @hidden */\nexport var openHyperlink = 'openHyperlink';\n/** @hidden */\nexport var removeHyperlink = 'removeHyperlink';\n/** @hidden */\nexport var createHyperlinkElement = 'createHyperlinkElement';\n/** @hidden */\nexport var sheetNameUpdate = 'sheetNameUpdate';\n/** @hidden */\nexport var hideSheet = 'hideSheet';\n/** @hidden */\nexport var performUndoRedo = 'performUndoRedo';\n/** @hidden */\nexport var updateUndoRedoCollection = 'updateUndoRedoCollection';\n/** @hidden */\nexport var setActionData = 'setActionData';\n/** @hidden */\nexport var getBeforeActionData = 'getBeforeActionData';\n/** @hidden */\nexport var clearUndoRedoCollection = 'clearUndoRedoCollection';\n/** @hidden */\nexport var initiateFilterUI = 'initiateFilterUI';\n/** @hidden */\nexport var renderFilterCell = 'renderFilterCell';\n/** @hidden */\nexport var reapplyFilter = 'reapplyFilter';\n/** @hidden */\nexport var filterByCellValue = 'filterByCellValue';\n/** @hidden */\nexport var clearFilter = 'clearFilter';\n/** @hidden */\nexport var getFilteredColumn = 'getFilteredColumn';\n/** @hidden */\nexport var completeAction = 'actionComplete';\n/** @hidden */\nexport var beginAction = 'actionBegin';\n/** @hidden */\nexport var filterCellKeyDown = 'filterCellKeyDown';\n/** @hidden */\nexport var getFilterRange = 'getFilterRange';\n/** @hidden */\nexport var setAutoFit = 'setAutoFit';\n/** @hidden */\nexport var refreshFormulaDatasource = 'refreshFormulaDatasource';\n/** @hidden */\nexport var setScrollEvent = 'setScrollEvent';\n/** @hidden */\nexport var initiateDataValidation = 'initiatedatavalidation';\n/** @hidden */\nexport var validationError = 'validationError';\n/** @hidden */\nexport var startEdit = 'startEdit';\n/** @hidden */\nexport var invalidData = 'invalidData';\n/** @hidden */\nexport var clearInvalid = 'clearInvalid';\n/** @hidden */\nexport var protectSheet = 'protectSheet';\n/** @hidden */\nexport var applyProtect = 'applyProtect';\n/** @hidden */\nexport var unprotectSheet = 'unprotectSheet';\n/** @hidden */\nexport var protectCellFormat = 'protectCellFormat';\n/** @hidden */\nexport var gotoDlg = 'renderGotoDlgt';\n/** @hidden */\nexport var findDlg = 'renderFindDlg';\n/** @hidden */\nexport var findHandler = 'findHandler';\n/** @hidden */\nexport var replace = 'replaceHandler';\n/** @hidden */\nexport var created = 'created';\n/** @hidden */\nexport var editAlert = 'editAlert';\n/** @hidden */\nexport var setUndoRedo = 'setUndoRedo';\n/** @hidden */\nexport var enableFormulaInput = 'enableFormulaInput';\n/** @hidden */\nexport var protectSelection = 'protectSelection';\n/** @hidden */\nexport var hiddenMerge = 'hiddenMerge';\n/** @hidden */\nexport var checkPrevMerge = 'checkPrevMerge';\n/** @hidden */\nexport var checkMerge = 'checkMerge';\n/** @hidden */\nexport var removeDataValidation = 'removeDataValidation';\n/** @hidden */\nexport var showAggregate = 'showAggregate';\n/** @hidden */\nexport var initiateConditionalFormat = 'initiateConditionalFormat';\n/** @hidden */\nexport var checkConditionalFormat = 'checkConditionalFormat';\n/** @hidden */\nexport var setCF = 'setCF';\n/** @hidden */\nexport var clearViewer = 'clearViewer';\n/** @hidden */\nexport var initiateFormulaReference = 'initiateFormulaReference';\n/** @hidden */\nexport var initiateCur = 'initiateCur';\n/** @hidden */\nexport var clearCellRef = 'clearCellRef';\n/** @hidden */\nexport var editValue = 'editValue';\n/** @hidden */\nexport var addressHandle = 'addressHandle';\n/** @hidden */\nexport var initiateEdit = 'initiateEdit';\n/** @hidden */\nexport var forRefSelRender = 'forRefSelRender';\nexport var blankWorkbook = 'blankWorkbook';\n/** @hidden */\nexport var insertImage = 'insertImage';\n/** @hidden */\nexport var refreshImgElem = 'refreshImgElem';\n/** @hidden */\nexport var refreshImgCellObj = 'refreshImgCellObj';\n/** @hidden */\nexport var getRowIdxFromClientY = 'getRowIdxFromClientY';\n/** @hidden */\nexport var getColIdxFromClientX = 'getColIdxFromClientX';\n/** @hidden */\nexport var createImageElement = 'createImageElement';\n/** @hidden */\nexport var deleteImage = 'deleteImage';\n/** @hidden */\nexport var deleteChart = 'deleteChart';\n/** @hidden */\nexport var refreshChartCellObj = 'refreshChartCellObj';\n/** @hidden */\nexport var refreshImagePosition = 'refreshImagePosition';\n/** @hidden */\nexport var updateTableWidth = 'updateTableWidth';\n/** @hidden */\nexport var focusBorder = 'focusBorder';\n/** @hidden */\nexport var clearChartBorder = 'clearChartBorder';\n/** @hidden */\nexport var insertChart = 'insertChart';\n/** @hidden */\nexport var chartRangeSelection = 'chartRangeSelection';\n/** @hidden */\nexport var isReact = 'isReact';\n/** @hidden */\nexport var renderReactTemplates = 'renderReactTemplates';\n/** @hidden */\nexport var clearTemplate = 'clearTemplate';\n","/**\n * Open properties.\n */\nimport { isUndefined } from '@syncfusion/ej2-base';\nimport { workbookOpen, openSuccess, openFailure, sheetsDestroyed, workbookFormulaOperation, getRangeIndexes } from '../common/index';\nimport { sheetCreated, protectSheetWorkBook, getRangeAddress } from '../common/index';\nimport { initSheet } from '../base/index';\nimport { beginAction } from '../../spreadsheet/common/event';\nvar WorkbookOpen = /** @class */ (function () {\n    function WorkbookOpen(parent) {\n        this.parent = parent;\n        this.addEventListener();\n    }\n    /**\n     * To open the excel file stream or excel url into the spreadsheet.\n     * @param {OpenOptions} options - Options to open a excel file.\n     */\n    WorkbookOpen.prototype.open = function (options) {\n        var _this = this;\n        if (!this.parent.allowOpen) {\n            return;\n        }\n        /* tslint:disable-next-line:no-any */\n        if (options.jsonObject) {\n            /* tslint:disable-next-line:no-any */\n            this.fetchSuccess(options.jsonObject);\n            return;\n        }\n        var formData = new FormData();\n        if (options.file) {\n            formData.append('file', options.file);\n        }\n        else {\n            this.parent.isOpen = false;\n            return;\n        }\n        var eventArgs = {\n            file: options.file || null,\n            cancel: false,\n            requestData: {\n                method: 'POST',\n                body: formData\n            }\n        };\n        this.parent.trigger('beforeOpen', eventArgs);\n        this.parent.notify(beginAction, { eventArgs: eventArgs, action: 'beforeOpen' });\n        if (eventArgs.cancel) {\n            return;\n        }\n        fetch(this.parent.openUrl, eventArgs.requestData)\n            .then(function (response) {\n            if (response.ok) {\n                return response.json();\n            }\n            else {\n                return Promise.reject({\n                    status: response.status,\n                    statusText: response.statusText,\n                    url: response.url\n                });\n            }\n        })\n            .then(function (data) { return _this.fetchSuccess(data); })\n            .catch(function (error) { return _this.fetchFailure(error); });\n    };\n    WorkbookOpen.prototype.fetchFailure = function (error) {\n        if (isUndefined(error.status) && isUndefined(error.statusText)) {\n            error.statusText = 'Improper response';\n        }\n        this.parent.notify(openFailure, error);\n        this.parent.isOpen = false;\n    };\n    WorkbookOpen.prototype.fetchSuccess = function (data) {\n        var openError = ['UnsupportedFile', 'InvalidUrl'];\n        var workbookData = data;\n        workbookData = (typeof data === 'string') ? JSON.parse(data) : data;\n        /* tslint:disable-next-line:no-any */\n        var impData = workbookData.Workbook;\n        if (openError.indexOf(impData) > -1) {\n            this.parent.notify(openSuccess, {\n                context: this, data: impData\n            });\n            return;\n        }\n        this.updateModel(impData);\n        this.parent.notify(openSuccess, {\n            context: this, data: impData\n        });\n        this.parent.isOpen = false;\n    };\n    WorkbookOpen.prototype.updateModel = function (workbookModel) {\n        this.parent.notify(workbookFormulaOperation, { action: 'unRegisterSheet' });\n        this.parent.sheetNameCount = 1;\n        this.parent.sheets = [];\n        this.parent.notify(sheetsDestroyed, {});\n        workbookModel.activeSheetIndex = workbookModel.activeSheetIndex || 0;\n        this.setSelectAllRange(workbookModel.sheets);\n        this.parent.setProperties({\n            'sheets': workbookModel.sheets,\n            'activeSheetIndex': workbookModel.activeSheetIndex,\n            'definedNames': workbookModel.definedNames || []\n        }, true);\n        initSheet(this.parent);\n        this.parent.notify(sheetCreated, null);\n        this.parent.notify(workbookFormulaOperation, { action: 'registerSheet', isImport: true });\n        this.parent.notify(workbookFormulaOperation, { action: 'initiateDefinedNames' });\n        this.parent.notify(protectSheetWorkBook, null);\n    };\n    WorkbookOpen.prototype.setSelectAllRange = function (sheets) {\n        sheets.forEach(function (sheet) {\n            if (sheet.selectedRange) {\n                var selectedIndex = getRangeIndexes(sheet.selectedRange);\n                var rowCount = (isUndefined(sheet.rowCount) ? 100 : sheet.rowCount) - 1;\n                var colCount = (isUndefined(sheet.colCount) ? 100 : sheet.colCount) - 1;\n                if (selectedIndex[2] === 65535) {\n                    selectedIndex[2] = rowCount;\n                }\n                if (selectedIndex[3] === 255) {\n                    selectedIndex[3] = colCount;\n                }\n                if (selectedIndex[0] === 65535) {\n                    selectedIndex[0] = rowCount;\n                }\n                if (selectedIndex[1] === 255) {\n                    selectedIndex[1] = colCount;\n                }\n                sheet.selectedRange = getRangeAddress(selectedIndex);\n            }\n        });\n    };\n    /**\n     * Adding event listener for workbook open.\n     */\n    WorkbookOpen.prototype.addEventListener = function () {\n        this.parent.on(workbookOpen, this.open.bind(this));\n    };\n    /**\n     * Removing event listener workbook open.\n     */\n    WorkbookOpen.prototype.removeEventListener = function () {\n        if (!this.parent.isDestroyed) {\n            this.parent.off(workbookOpen, this.open.bind(this));\n        }\n    };\n    /**\n     * To Remove the event listeners\n     */\n    WorkbookOpen.prototype.destroy = function () {\n        this.removeEventListener();\n        this.parent = null;\n    };\n    /**\n     * Get the workbook open module name.\n     */\n    WorkbookOpen.prototype.getModuleName = function () {\n        return 'workbookOpen';\n    };\n    return WorkbookOpen;\n}());\nexport { WorkbookOpen };\n","/**\n * @hidden\n * The `SaveWorker` module is used to perform save functionality with Web Worker.\n */\nvar SaveWorker = /** @class */ (function () {\n    /**\n     * Constructor for SaveWorker module in Workbook library.\n     * @private\n     */\n    function SaveWorker(parent) {\n        this.parent = parent;\n    }\n    /**\n     * Process sheet.\n     * @hidden\n     */\n    SaveWorker.prototype.processSheet = function (sheet, sheetIndex) {\n        var parsedSheet = JSON.parse(sheet, function (key, value) {\n            //Remove empty properties\n            if ((Array.isArray(value) || typeof value === 'string') && !value.length) {\n                return undefined;\n            }\n            return value;\n        });\n        return [sheetIndex, parsedSheet];\n    };\n    /**\n     * Process save action.\n     * @hidden\n     */\n    SaveWorker.prototype.processSave = function (saveJSON, saveSettings, customParams) {\n        var formData = new FormData();\n        var i;\n        var keys = Object.keys(saveSettings);\n        formData.append('JSONData', JSON.stringify(saveJSON));\n        for (i = 0; i < keys.length; i++) {\n            formData.append(keys[i], saveSettings[keys[i]]);\n        }\n        keys = Object.keys(customParams);\n        for (i = 0; i < keys.length; i++) {\n            formData.append(keys[i], customParams[keys[i]]);\n        }\n        fetch(saveSettings.url, { method: 'POST', body: formData })\n            .then(function (response) {\n            if (response.ok) {\n                return response.blob();\n            }\n            else {\n                return Promise.reject({\n                    message: response.statusText\n                });\n            }\n        })\n            .then(function (data) {\n            new Promise(function (resolve) {\n                var reader = new FileReader();\n                reader.onload = function () {\n                    if (reader.result.toString().indexOf('data:text/plain;base64,') > -1) {\n                        var str = atob(reader.result.replace('data:text/plain;base64,', '')).split(/(\\r\\n|\\n|\\r)/gm);\n                        if (str.length) {\n                            postMessage({ dialog: str[0] });\n                        }\n                    }\n                    else {\n                        postMessage(data);\n                    }\n                    resolve(reader.result);\n                };\n                reader.readAsDataURL(data);\n            });\n        })\n            .catch(function (error) {\n            postMessage({ error: error.message });\n        });\n        // try {\n        //     let httpRequest: XMLHttpRequest = new XMLHttpRequest();\n        //     let formData: FormData = new FormData();\n        //     let i: number;\n        //     let keys: string[] = Object.keys(saveSettings);\n        //     httpRequest.onreadystatechange = (event: Event) => {\n        //         if (httpRequest.readyState === 4 && httpRequest.status === 200) {\n        //             (postMessage as Function)(httpRequest.response);\n        //         }\n        //     };\n        //     httpRequest.onerror = (event: Event) => {\n        //         (postMessage as Function)(event);\n        //     };\n        //     formData.append('JSONData', JSON.stringify(saveJSON));\n        //     for (i = 0; i < keys.length; i++) {\n        //         formData.append(keys[i], (<{ [key: string]: string }>saveSettings)[keys[i]]);\n        //     }\n        //     httpRequest.open('POST', saveSettings.saveUrl, false);\n        //     httpRequest.send(formData);\n        // } catch (e) {\n        //     (postMessage as Function)({ error: e.message });\n        // }\n    };\n    return SaveWorker;\n}());\nexport { SaveWorker };\n","var __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    }\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nimport { executeTaskAsync } from '../common/worker';\nimport * as events from '../common/event';\nimport { SaveWorker } from '../workers/save-worker';\nimport { detach } from '@syncfusion/ej2-base';\n/**\n * @hidden\n * The `WorkbookSave` module is used to handle the save action in Workbook library.\n */\nvar WorkbookSave = /** @class */ (function (_super) {\n    __extends(WorkbookSave, _super);\n    /**\n     * Constructor for WorkbookSave module in Workbook library.\n     * @private\n     */\n    function WorkbookSave(parent) {\n        var _this = _super.call(this, parent) || this;\n        _this.isProcessCompleted = false;\n        _this.saveJSON = {};\n        _this.isFullPost = false;\n        _this.needBlobData = false;\n        _this.customParams = null;\n        _this.addEventListener();\n        return _this;\n    }\n    /**\n     * Get the module name.\n     * @returns string\n     * @private\n     */\n    WorkbookSave.prototype.getModuleName = function () {\n        return 'workbookSave';\n    };\n    /**\n     * To destroy the WorkbookSave module.\n     * @return {void}\n     * @hidden\n     */\n    WorkbookSave.prototype.destroy = function () {\n        this.removeEventListener();\n        this.parent = null;\n    };\n    /**\n     * @hidden\n     */\n    WorkbookSave.prototype.addEventListener = function () {\n        this.parent.on(events.beginSave, this.initiateSave, this);\n    };\n    /**\n     * @hidden\n     */\n    WorkbookSave.prototype.removeEventListener = function () {\n        if (!this.parent.isDestroyed) {\n            this.parent.off(events.beginSave, this.initiateSave);\n        }\n    };\n    /**\n     * Initiate save process.\n     * @hidden\n     */\n    WorkbookSave.prototype.initiateSave = function (args) {\n        var saveSettings = args.saveSettings;\n        this.saveSettings = {\n            saveType: saveSettings.saveType,\n            url: saveSettings.url,\n            fileName: saveSettings.fileName || 'Sample'\n        };\n        this.isFullPost = args.isFullPost;\n        this.needBlobData = args.needBlobData;\n        if (this.needBlobData) {\n            this.isFullPost = false;\n        }\n        this.customParams = args.customParams;\n        this.updateBasicSettings();\n        this.processSheets();\n    };\n    /**\n     * Update save JSON with basic settings.\n     * @hidden\n     */\n    WorkbookSave.prototype.updateBasicSettings = function () {\n        var jsonStr = this.getStringifyObject(this.parent, ['sheets', '_isScalar', 'observers', 'closed', 'isStopped', 'hasError',\n            '__isAsync', 'beforeCellFormat', 'beforeCellRender', 'beforeDataBound', 'beforeOpen', 'beforeSave', 'beforeSelect',\n            'beforeSort', 'cellEdit', 'cellEditing', 'cellSave', 'beforeCellSave', 'contextMenuItemSelect', 'contextMenuBeforeClose',\n            'contextMenuBeforeOpen', 'created', 'dataBound', 'fileMenuItemSelect', 'fileMenuBeforeClose', 'fileMenuBeforeOpen',\n            'saveComplete', 'sortComplete', 'select', 'actionBegin', 'actionComplete', 'afterHyperlinkClick', 'afterHyperlinkCreate',\n            'beforeHyperlinkClick', 'beforeHyperlinkCreate', 'openComplete', 'openFailure', 'queryCellInfo', 'dialogBeforeOpen',\n            'dataSourceChanged']);\n        var basicSettings = JSON.parse(jsonStr);\n        var sheetCount = this.parent.sheets.length;\n        var i = 0;\n        if (sheetCount) {\n            basicSettings.sheets = [];\n        }\n        this.saveJSON = basicSettings;\n    };\n    /**\n     * Process sheets properties.\n     * @hidden\n     */\n    WorkbookSave.prototype.processSheets = function () {\n        var i = 0;\n        var sheetCount = this.parent.sheets.length;\n        while (i < sheetCount) {\n            executeTaskAsync(this, this.processSheet, this.updateSheet, [this.getStringifyObject(this.parent.sheets[i]), i]);\n            i++;\n        }\n    };\n    /**\n     * Update processed sheet data.\n     * @hidden\n     */\n    WorkbookSave.prototype.updateSheet = function (data) {\n        this.saveJSON.sheets[data[0]] = data[1];\n        this.isProcessCompleted = this.getSheetLength(this.saveJSON.sheets) === this.parent.sheets.length;\n        if (this.isProcessCompleted) {\n            this.save(this.saveSettings);\n        }\n    };\n    WorkbookSave.prototype.getSheetLength = function (sheets) {\n        var len = 0;\n        sheets.forEach(function (sheet) {\n            if (sheet) {\n                len++;\n            }\n        });\n        return len;\n    };\n    /**\n     * Save process.\n     * @hidden\n     */\n    WorkbookSave.prototype.save = function (saveSettings) {\n        var args = { cancel: false, jsonObject: this.saveJSON };\n        this.parent.notify(events.onSave, args);\n        if (!args.cancel) {\n            if (this.isFullPost) {\n                this.initiateFullPostSave();\n            }\n            else {\n                executeTaskAsync(this, { 'workerTask': this.processSave }, this.updateSaveResult, [this.saveJSON, saveSettings, this.customParams], true);\n            }\n        }\n        this.saveJSON = {};\n    };\n    /**\n     * Update final save data.\n     * @hidden\n     */\n    WorkbookSave.prototype.updateSaveResult = function (result) {\n        var args = {\n            status: 'Success',\n            message: '',\n            url: this.saveSettings.url,\n            fileName: this.saveSettings.fileName,\n            saveType: this.saveSettings.saveType,\n            blobData: null\n        };\n        if (typeof (result) === 'object' && result.error) {\n            args.status = 'Failure';\n            args.message = result.error.toString();\n        }\n        else if (typeof (result) === 'object' && result.dialog) {\n            this.parent.notify(events.saveError, { content: result.dialog });\n        }\n        else {\n            if (this.needBlobData) {\n                args.blobData = result;\n            }\n            else {\n                this.ClientFileDownload(result, this.saveSettings.fileName);\n            }\n        }\n        this.parent.trigger('saveComplete', args);\n        this.parent.notify(events.saveCompleted, args);\n    };\n    WorkbookSave.prototype.ClientFileDownload = function (blobData, fileName) {\n        var anchor = this.parent.createElement('a', { attrs: { download: this.getFileNameWithExtension() } });\n        var url = URL.createObjectURL(blobData);\n        anchor.href = url;\n        document.body.appendChild(anchor);\n        anchor.click();\n        URL.revokeObjectURL(url);\n        document.body.removeChild(anchor);\n    };\n    WorkbookSave.prototype.initiateFullPostSave = function () {\n        var keys = Object.keys(this.saveSettings);\n        var i;\n        var formElem = this.parent.createElement('form', { attrs: { method: 'POST', action: this.saveSettings.url } });\n        var inputElem = this.parent.createElement('input', { attrs: { type: 'hidden', name: 'JSONData' } });\n        inputElem.value = JSON.stringify(this.saveJSON);\n        formElem.appendChild(inputElem);\n        for (i = 0; i < keys.length; i++) {\n            inputElem = this.parent.createElement('input', { attrs: { type: 'hidden', name: keys[i] } });\n            inputElem.value = this.saveSettings[keys[i]];\n            formElem.appendChild(inputElem);\n        }\n        keys = Object.keys(this.customParams);\n        for (i = 0; i < keys.length; i++) {\n            inputElem = this.parent.createElement('input', { attrs: { type: 'hidden', name: keys[i] } });\n            inputElem.value = this.customParams[keys[i]];\n            formElem.appendChild(inputElem);\n        }\n        document.body.appendChild(formElem);\n        formElem.submit();\n        detach(formElem);\n        this.parent.notify(events.saveCompleted, {});\n    };\n    /**\n     * Get stringified workbook object.\n     * @hidden\n     */\n    WorkbookSave.prototype.getStringifyObject = function (value, skipProp) {\n        if (skipProp === void 0) { skipProp = []; }\n        return JSON.stringify(value, function (key, value) {\n            if (skipProp.indexOf(key) > -1) {\n                return undefined;\n            }\n            else {\n                if (value && typeof value === 'object' && value.hasOwnProperty('properties')) {\n                    return value.properties;\n                }\n                else if (value !== null) {\n                    return value;\n                }\n                else {\n                    return undefined;\n                }\n            }\n        });\n    };\n    WorkbookSave.prototype.getFileNameWithExtension = function (filename) {\n        if (!filename) {\n            filename = this.saveSettings.fileName;\n        }\n        var fileExt = this.getFileExtension();\n        var idx = filename.lastIndexOf('.');\n        if (idx > -1) {\n            filename = filename.substr(0, idx);\n        }\n        return (filename + fileExt);\n    };\n    WorkbookSave.prototype.getFileExtension = function () {\n        return ('.' + this.saveSettings.saveType.toLowerCase());\n    };\n    return WorkbookSave;\n}(SaveWorker));\nexport { WorkbookSave };\n","/**\n * @hidden\n */\nexport var CommonErrors;\n(function (CommonErrors) {\n    CommonErrors[CommonErrors[\"na\"] = 0] = \"na\";\n    CommonErrors[CommonErrors[\"value\"] = 1] = \"value\";\n    CommonErrors[CommonErrors[\"ref\"] = 2] = \"ref\";\n    CommonErrors[CommonErrors[\"divzero\"] = 3] = \"divzero\";\n    CommonErrors[CommonErrors[\"num\"] = 4] = \"num\";\n    CommonErrors[CommonErrors[\"name\"] = 5] = \"name\";\n    CommonErrors[CommonErrors[\"null\"] = 6] = \"null\";\n})(CommonErrors || (CommonErrors = {}));\n/**\n * @hidden\n */\nexport var FormulasErrorsStrings;\n(function (FormulasErrorsStrings) {\n    FormulasErrorsStrings[FormulasErrorsStrings[\"operators_cannot_start_with_expression\"] = 0] = \"operators_cannot_start_with_expression\";\n    FormulasErrorsStrings[FormulasErrorsStrings[\"reservedWord_And\"] = 1] = \"reservedWord_And\";\n    FormulasErrorsStrings[FormulasErrorsStrings[\"reservedWord_Xor\"] = 2] = \"reservedWord_Xor\";\n    FormulasErrorsStrings[FormulasErrorsStrings[\"reservedWord_If\"] = 3] = \"reservedWord_If\";\n    FormulasErrorsStrings[FormulasErrorsStrings[\"number_contains_2_decimal_points\"] = 4] = \"number_contains_2_decimal_points\";\n    FormulasErrorsStrings[FormulasErrorsStrings[\"reservedWord_Else\"] = 5] = \"reservedWord_Else\";\n    FormulasErrorsStrings[FormulasErrorsStrings[\"reservedWord_Not\"] = 6] = \"reservedWord_Not\";\n    FormulasErrorsStrings[FormulasErrorsStrings[\"invalid_char_in_number\"] = 7] = \"invalid_char_in_number\";\n    FormulasErrorsStrings[FormulasErrorsStrings[\"invalid_characters_following_with_operator\"] = 6] = \"invalid_characters_following_with_operator\";\n    FormulasErrorsStrings[FormulasErrorsStrings[\"mismatched_parentheses\"] = 8] = \"mismatched_parentheses\";\n    FormulasErrorsStrings[FormulasErrorsStrings[\"unknown_formula_name\"] = 9] = \"unknown_formula_name\";\n    FormulasErrorsStrings[FormulasErrorsStrings[\"requires_a_single_argument\"] = 10] = \"requires_a_single_argument\";\n    FormulasErrorsStrings[FormulasErrorsStrings[\"requires_3_args\"] = 11] = \"requires_3_args\";\n    FormulasErrorsStrings[FormulasErrorsStrings[\"invalid_Math_argument\"] = 12] = \"invalid_Math_argument\";\n    FormulasErrorsStrings[FormulasErrorsStrings[\"requires_2_args\"] = 13] = \"requires_2_args\";\n    FormulasErrorsStrings[FormulasErrorsStrings[\"bad_index\"] = 14] = \"bad_index\";\n    FormulasErrorsStrings[FormulasErrorsStrings[\"too_complex\"] = 15] = \"too_complex\";\n    FormulasErrorsStrings[FormulasErrorsStrings[\"circular_reference\"] = 16] = \"circular_reference\";\n    FormulasErrorsStrings[FormulasErrorsStrings[\"missing_formula\"] = 17] = \"missing_formula\";\n    FormulasErrorsStrings[FormulasErrorsStrings[\"improper_formula\"] = 18] = \"improper_formula\";\n    FormulasErrorsStrings[FormulasErrorsStrings[\"invalid_expression\"] = 19] = \"invalid_expression\";\n    FormulasErrorsStrings[FormulasErrorsStrings[\"cell_empty\"] = 20] = \"cell_empty\";\n    FormulasErrorsStrings[FormulasErrorsStrings[\"bad_formula\"] = 21] = \"bad_formula\";\n    FormulasErrorsStrings[FormulasErrorsStrings[\"empty_expression\"] = 22] = \"empty_expression\";\n    FormulasErrorsStrings[FormulasErrorsStrings[\"virtual_mode_required\"] = 23] = \"virtual_mode_required\";\n    FormulasErrorsStrings[FormulasErrorsStrings[\"mismatched_tics\"] = 24] = \"mismatched_tics\";\n    FormulasErrorsStrings[FormulasErrorsStrings[\"wrong_number_arguments\"] = 25] = \"wrong_number_arguments\";\n    FormulasErrorsStrings[FormulasErrorsStrings[\"invalid_arguments\"] = 26] = \"invalid_arguments\";\n    FormulasErrorsStrings[FormulasErrorsStrings[\"iterations_do_not_converge\"] = 27] = \"iterations_do_not_converge\";\n    FormulasErrorsStrings[FormulasErrorsStrings[\"calculation_overflow\"] = 29] = \"calculation_overflow\";\n    FormulasErrorsStrings[FormulasErrorsStrings[\"already_registered\"] = 28] = \"already_registered\";\n    FormulasErrorsStrings[FormulasErrorsStrings[\"missing_sheet\"] = 30] = \"missing_sheet\";\n    FormulasErrorsStrings[FormulasErrorsStrings[\"cannot_parse\"] = 31] = \"cannot_parse\";\n    FormulasErrorsStrings[FormulasErrorsStrings[\"expression_cannot_end_with_an_operator\"] = 32] = \"expression_cannot_end_with_an_operator\";\n})(FormulasErrorsStrings || (FormulasErrorsStrings = {}));\n","import { FormulasErrorsStrings, CommonErrors, getSkeletonVal } from '../common/index';\nimport { isNullOrUndefined, getValue, Internationalization } from '@syncfusion/ej2-base';\n/**\n * Represents the basic formulas module.\n */\nvar BasicFormulas = /** @class */ (function () {\n    function BasicFormulas(parent) {\n        this.formulas = [\n            { formulaName: 'SUM', category: 'Math & Trig', description: 'Sums individual values, cell references or ranges.' },\n            {\n                formulaName: 'SUMIFS', category: 'Math & Trig',\n                description: 'Sums the cells specified by a given set of conditionsor criteria.'\n            },\n            {\n                formulaName: 'SUMPRODUCT', category: 'Math & Trig',\n                description: 'Returns sum of the product of given ranges of arrays.'\n            },\n            { formulaName: 'ABS', category: 'Math & Trig', description: 'Returns the absolute value of a number.' },\n            { formulaName: 'RAND', category: 'Math & Trig', description: 'Return a random number between 0 and 1.' },\n            { formulaName: 'FLOOR', category: 'Math & Trig', description: 'Returns the round a number down to the nearest integer.' },\n            { formulaName: 'CEILING', category: 'Math & Trig', description: 'Returns a number rounded up to a multiple of another number.' },\n            {\n                formulaName: 'SUMIF', category: 'Math & Trig',\n                description: 'It will sum up cells that meet the given criteria.'\n            },\n            {\n                formulaName: 'PRODUCT', category: 'Math & Trig',\n                description: 'Multiplies all the numbers given as arguments and returns the product.'\n            },\n            {\n                formulaName: 'AVERAGE', category: 'Statistical',\n                description: 'The sum of the numbers divided by how many numbers are being averaged.'\n            },\n            {\n                formulaName: 'AVERAGEIF', category: 'Statistical',\n                description: 'Computes the average of the numbers in a range that meet the supplied criteria.'\n            },\n            {\n                formulaName: 'COUNT', category: 'Statistical',\n                description: 'Counts the numbers in the list of arguments, exclude text entries.'\n            },\n            { formulaName: 'COUNTA', category: 'Statistical', description: 'Counts the non-empty values in the list of arguments.' },\n            {\n                formulaName: 'COUNTIF', category: 'Statistical',\n                description: 'Counts the number of cells in a range that meet a specified condition.'\n            },\n            {\n                formulaName: 'COUNTIFS', category: 'Statistical',\n                description: 'Counts the number of times each cells in all the ranges that meet the specific conditions.'\n            },\n            {\n                formulaName: 'AVERAGEA', category: 'Statistical',\n                description: 'Calculates the average of values in the list of arguments.Arguments can be numbers, names, arrays or references.'\n            },\n            {\n                formulaName: 'AVERAGEIFS', category: 'Statistical',\n                description: 'Conditionally returns the average of the contents of cells for the set of ranges.'\n            },\n            {\n                formulaName: 'MIN', category: 'Statistical',\n                description: 'Returns the smaller number in set of arguments.'\n            },\n            { formulaName: 'MAX', category: 'Statistical', description: 'Returns the largest number in set of arguments.' },\n            { formulaName: 'DATE', category: 'Date', description: 'Returns the date, given the year, month and day of the month.' },\n            { formulaName: 'DAY', category: 'Date', description: 'Returns the day of a given date.' },\n            { formulaName: 'TODAY', category: 'Date', description: 'Returns the current date as date value.' },\n            { formulaName: 'DAYS', category: 'Date', description: 'Returns the number of days between two dates.' },\n            {\n                formulaName: 'IF', category: 'Logical',\n                description: 'Returns one value if a logical expression is TRUE and another if it is FALSE'\n            },\n            {\n                formulaName: 'AND', category: 'Logical',\n                description: 'Returns TRUE if all the arguments are considered TRUE, and FALSE otherwise.'\n            },\n            {\n                formulaName: 'IFS', category: 'Logical',\n                description: 'Checks multiple conditions and returns a value corresponding to the first TRUE result.'\n            },\n            {\n                formulaName: 'IFERROR', category: 'Logical',\n                description: 'Returns a value you specify if a formula evaluates to an error; otherwise, it returns the result of the formula.'\n            },\n            {\n                formulaName: 'CHOOSE', category: 'Lookup & Reference',\n                description: 'Returns a value from a list, given an index number.'\n            },\n            {\n                formulaName: 'INDEX', category: 'Lookup & Reference',\n                description: 'Returns a value from a table, given a row and column number.'\n            },\n            { formulaName: 'FIND', category: 'Text', description: 'Returns the position of a string of text within another string.' },\n            { formulaName: 'CONCATENATE', category: 'Text', description: ' Used to join two or more strings together.' },\n            { formulaName: 'CONCAT', category: 'Text', description: 'Concatenates a list or range of text strings.' },\n            { formulaName: 'SUBTOTAL', category: 'Lookup & Reference', description: 'Returns a subtotal in a list or database.' },\n            { formulaName: 'RADIANS', category: 'Math & Trig', description: 'Converts degrees to radians.' },\n            {\n                formulaName: 'OR', category: 'Logical',\n                description: 'Returns TRUE if any arguments considered TRUE, and all the arguments are FALSE it will return FALSE.'\n            },\n            {\n                formulaName: 'MATCH', category: 'Lookup & Reference',\n                description: 'Returns the relative position of an checked item in range that matches a specified value in a specified order'\n            },\n            {\n                formulaName: 'RANDBETWEEN', category: 'Math & Trig', description: 'Returns an integer random number in a specified range.'\n            },\n            {\n                formulaName: 'SLOPE', category: 'Statistical',\n                description: 'Returns the slope of the line from linear regression of the data points.'\n            },\n            {\n                formulaName: 'INTERCEPT', category: 'Statistical',\n                description: 'Calculates the point of the Y-intercept line via linear regression.'\n            },\n            {\n                formulaName: 'ROUNDUP', category: 'Math & Trig', description: 'Rounds a number away from zero.'\n            },\n            {\n                formulaName: 'INT', category: 'Math & Trig', description: 'Returns a number to the nearest integer.'\n            },\n            {\n                formulaName: 'LN', category: 'Math & Trig', description: 'Returns the natural logarithm of a number.'\n            },\n            {\n                formulaName: 'ISNUMBER', category: 'Information', description: 'Returns TRUE, if the argument is number and FALSE otherwise.'\n            },\n            {\n                formulaName: 'ROUND', category: 'Math & Trig', description: 'Rounds a number to a specified number of digits.'\n            },\n            {\n                formulaName: 'LOG', category: 'Math & Trig', description: 'Returns the logarithm of a number to the base that you specify.'\n            },\n            {\n                formulaName: 'POWER', category: 'Math & Trig', description: 'Returns the result of a number raised to power.'\n            },\n            {\n                formulaName: 'TRUNC', category: 'Math & Trig',\n                description: 'Returns the truncated value of a number to a specified number of decimal places.'\n            },\n            {\n                formulaName: 'EXP', category: 'Math & Trig', description: 'Returns e raised to the power of the given number.'\n            },\n            {\n                formulaName: 'GEOMEAN', category: 'Statistical',\n                description: 'Returns the geometric mean of an array or range of positive data.'\n            },\n            { formulaName: 'TEXT', category: 'Lookup & Reference', description: 'Returns the value in required format.' }\n        ];\n        this.isConcat = false;\n        this.parent = parent;\n        this.init();\n    }\n    BasicFormulas.prototype.init = function () {\n        var fn;\n        for (var i = 0; i < this.formulas.length; i++) {\n            fn = getValue('Compute' + this.formulas[i].formulaName, this).bind(this);\n            this.addFormulaCollection(this.formulas[i].formulaName.toUpperCase(), fn, this.formulas[i].category, this.formulas[i].description);\n        }\n    };\n    BasicFormulas.prototype.addFormulaCollection = function (formulaName, functionName, formulaCategory, description) {\n        this.parent.libraryFormulas = {\n            fName: formulaName, handler: functionName, category: formulaCategory,\n            description: description\n        };\n    };\n    /** @hidden */\n    BasicFormulas.prototype.ComputeSUM = function () {\n        var args = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            args[_i] = arguments[_i];\n        }\n        if (isNullOrUndefined(args) || (args.length === 1 && args[0] === '')) {\n            return this.parent.formulaErrorStrings[FormulasErrorsStrings.invalid_arguments];\n        }\n        var sum = 0;\n        var val;\n        var orgValue;\n        if (!isNullOrUndefined(args)) {\n            var argArr = args;\n            for (var i = 0; i < argArr.length; i++) {\n                var argValue = argArr[i].toString();\n                if (argValue.indexOf(':') > -1 && this.parent.isCellReference(argValue)) {\n                    var cellCollection = this.parent.getCellCollection(argValue.split(this.parent.tic).join(''));\n                    for (var j = 0; j < cellCollection.length; j++) {\n                        val = this.parent.getValueFromArg(cellCollection[j]);\n                        if (this.parent.getErrorStrings().indexOf(val) > -1) {\n                            return val;\n                        }\n                        if (isNullOrUndefined(val[0]) || isNaN(this.parent.parseFloat(val))) {\n                            continue;\n                        }\n                        sum = sum + this.parent.parseFloat(val);\n                    }\n                }\n                else {\n                    if (argArr[i].split(this.parent.tic).join('') === this.parent.trueValue) {\n                        argArr[i] = '1';\n                    }\n                    if (argArr[i].split(this.parent.tic).join('') === this.parent.falseValue) {\n                        argArr[i] = '0';\n                    }\n                    orgValue = this.parent.getValueFromArg(argArr[i].split(this.parent.tic).join(''));\n                    if (this.parent.getErrorStrings().indexOf(orgValue) > -1) {\n                        return orgValue;\n                    }\n                    if (isNullOrUndefined(orgValue) || isNaN(this.parent.parseFloat(orgValue))) {\n                        continue;\n                    }\n                    if (orgValue.length > 0) {\n                        sum = sum + this.parent.parseFloat(orgValue + '');\n                    }\n                }\n            }\n        }\n        return sum;\n    };\n    /** @hidden */\n    BasicFormulas.prototype.ComputeINT = function () {\n        var args = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            args[_i] = arguments[_i];\n        }\n        var str;\n        var num;\n        var index;\n        if (!isNullOrUndefined(args) && args.length !== 1 || args[0] === '') {\n            str = this.parent.formulaErrorStrings[FormulasErrorsStrings.invalid_arguments];\n        }\n        if (args[0] !== '' && args.length === 1) {\n            str = args[0];\n            index = str.indexOf('\"');\n            str = str.indexOf('\"') > -1 ? str.replace('\"', '') : str;\n            str = str.indexOf('\"') > -1 ? str.replace('\"', '') : str;\n            str = this.parent.getValueFromArg(str);\n            str = str.toUpperCase() === 'TRUE' ? '1' : (str === 'FALSE' ? '0' : str);\n            num = this.parent.parseFloat(str);\n            num = Math.floor(num);\n        }\n        if (isNaN(num)) {\n            str = index > -1 ? this.parent.getErrorStrings()[CommonErrors.value] : this.parent.getErrorStrings()[CommonErrors.name];\n        }\n        return num ? num : str;\n    };\n    ;\n    /** @hidden */\n    BasicFormulas.prototype.ComputeTODAY = function () {\n        var args = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            args[_i] = arguments[_i];\n        }\n        var str;\n        if (args && args[0] !== '') {\n            str = this.parent.formulaErrorStrings[FormulasErrorsStrings.invalid_arguments];\n        }\n        else {\n            var dt = new Date(Date.now());\n            str = dt.getFullYear() + '/' + this.parent.calculateDate((dt.getMonth() + 1).toString()) + '/'\n                + this.parent.calculateDate(dt.getDate().toString());\n        }\n        return str;\n    };\n    /** @hidden */\n    BasicFormulas.prototype.ComputeSUMPRODUCT = function () {\n        var args = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            args[_i] = arguments[_i];\n        }\n        var sum = 0;\n        var count = 0;\n        var index;\n        var mulValues = null;\n        var ranges = args;\n        for (var k = 0; k < ranges.length; ++k) {\n            var range = ranges[k];\n            if (!range.startsWith(this.parent.tic) && this.parent.isCellReference(range)) {\n                var i = range.indexOf(':');\n                var startRow = this.parent.rowIndex(range.substr(0, i));\n                var endRow = this.parent.rowIndex(range.substr(i + 1));\n                if (!(startRow !== -1 || endRow === -1) === (startRow === -1 || endRow !== -1)) {\n                    return this.parent.getErrorStrings()[CommonErrors.name];\n                }\n                var col1 = this.parent.colIndex(range.substr(0, i));\n                var col2 = this.parent.colIndex(range.substr(i + 1));\n                if (mulValues === null) {\n                    count = (endRow - startRow + 1) * (col2 - col1 + 1);\n                    mulValues = [];\n                    for (i = 0; i < count; ++i) {\n                        mulValues[i] = 1; //To create required index.\n                    }\n                }\n                i = 0;\n                for (var row = startRow; row <= endRow; ++row) {\n                    for (var col = col1; col <= col2; ++col) {\n                        var cellRef = '' + this.parent.convertAlpha(col) + (row);\n                        var result = this.parent.getValueFromArg(cellRef);\n                        if (!isNaN(parseFloat(result))) {\n                            //To return #VALUE! error when array dimensions are mismatched.\n                            if (isNaN(mulValues[i])) {\n                                return this.parent.getErrorStrings()[CommonErrors.name];\n                            }\n                            mulValues[i] = mulValues[i] * parseFloat(result);\n                        }\n                        else {\n                            mulValues[i] = 0;\n                        }\n                        i++;\n                    }\n                }\n            }\n            else {\n                var s1 = this.parent.getValueFromArg(range);\n                index = s1.indexOf('\"');\n                if (this.parent.getErrorStrings().indexOf(s1) > -1) {\n                    return s1;\n                }\n                else if (index > -1) {\n                    return 0;\n                }\n                else {\n                    return this.parent.formulaErrorStrings[FormulasErrorsStrings.invalid_arguments];\n                }\n            }\n        }\n        for (var i = 0; i < count; ++i) {\n            sum += mulValues[i];\n        }\n        return sum;\n    };\n    ;\n    /** @hidden */\n    BasicFormulas.prototype.ComputeROUNDUP = function () {\n        var args = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            args[_i] = arguments[_i];\n        }\n        var str;\n        var num;\n        var arg1;\n        var arg2;\n        var index;\n        var len = args.length;\n        if (!isNullOrUndefined(args) && len > 2) {\n            str = this.parent.formulaErrorStrings[FormulasErrorsStrings.invalid_arguments];\n        }\n        if (len === 1 && args[0] !== '') {\n            index = args[0].indexOf('\"');\n            arg1 = args[0].indexOf('\"') > -1 ? args[0].replace('\"', '') : args[0];\n            arg1 = arg1.indexOf('\"') > -1 ? arg1.replace('\"', '') : arg1;\n            arg1 = arg1.toUpperCase() === 'TRUE' ? '1' : (arg1 === 'FALSE' ? '0' : arg1);\n            arg1 = this.parent.getValueFromArg(arg1);\n            num = this.parent.parseFloat(arg1);\n            if (num > 0) {\n                num += .4999999999; // To round the number, we using this value.\n            }\n            else if (num < 0) {\n                num -= .4999999999;\n            }\n            num = this.parent.parseFloat(num.toFixed(0));\n            str = num.toString();\n        }\n        else if (len === 2 && args[0] !== '' && args[1] !== '') {\n            index = args[0].indexOf('\"') > -1 ? args[0].indexOf('\"') : (args[1].indexOf('\"') > -1 ? args[1].indexOf('\"') : -1);\n            arg1 = args[0].indexOf('\"') > -1 ? args[0].replace('\"', '') : args[0];\n            arg1 = arg1.indexOf('\"') > -1 ? arg1.replace('\"', '') : arg1;\n            arg2 = args[1].indexOf('\"') > -1 ? args[1].replace('\"', '') : args[1];\n            arg2 = arg2.indexOf('\"') > -1 ? arg2.replace('\"', '') : arg2;\n            arg1 = arg1.toUpperCase() === 'TRUE' ? '1' : (arg1 === 'FALSE' ? '0' : arg1);\n            arg2 = arg2.toUpperCase() === 'TRUE' ? '1' : (arg2 === 'FALSE' ? '0' : arg2);\n            arg1 = this.parent.getValueFromArg(arg1);\n            arg2 = this.parent.getValueFromArg(arg2);\n            var digits = Math.ceil(this.parent.parseFloat(arg2));\n            num = this.parent.parseFloat(arg1);\n            if (digits > 0) {\n                if (num > 0) {\n                    num += .4999999999 / Math.pow(10, digits);\n                }\n                else if (num < 0) {\n                    num -= .4999999999 / Math.pow(10, digits);\n                }\n                num = this.parent.parseFloat(num.toFixed(digits));\n                str = num.toFixed(digits);\n                if (isNaN(num)) {\n                    if (digits.toString().indexOf('\"') > -1) {\n                        str = this.parent.getErrorStrings()[CommonErrors.value];\n                    }\n                    else {\n                        str = this.parent.getErrorStrings()[CommonErrors.name];\n                    }\n                }\n            }\n            else {\n                if (num > 0) {\n                    num = (num / Math.pow(10, -digits)) + .49999;\n                }\n                else if (num < 0) {\n                    num = (num / Math.pow(10, -digits)) - .49999;\n                }\n                num = this.parent.parseFloat(num.toFixed(0)) * Math.pow(10, -digits);\n                str = num.toString();\n                if (isNaN(num)) {\n                    str = (digits.toString().indexOf('\"') > -1) ? this.parent.getErrorStrings()[CommonErrors.value] :\n                        str = this.parent.getErrorStrings()[CommonErrors.name];\n                }\n            }\n        }\n        else {\n            str = index > -1 ? this.parent.getErrorStrings()[CommonErrors.value] :\n                this.parent.formulaErrorStrings[FormulasErrorsStrings.invalid_arguments];\n        }\n        return str;\n    };\n    ;\n    /** @hidden */\n    BasicFormulas.prototype.ComputeCOUNT = function () {\n        var args = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            args[_i] = arguments[_i];\n        }\n        if (isNullOrUndefined(args) || (args.length === 1 && args[0] === '')) {\n            return this.parent.formulaErrorStrings[FormulasErrorsStrings.wrong_number_arguments];\n        }\n        var argArr = args;\n        var argVal;\n        var cellColl;\n        var result = 0;\n        var cellValue;\n        for (var i = 0; i < argArr.length; i++) {\n            argVal = argArr[i];\n            if (argVal.indexOf(':') > -1 && this.parent.isCellReference(argVal)) {\n                cellColl = this.parent.getCellCollection(argVal.split(this.parent.tic).join(''));\n                for (var j = 0; j < cellColl.length; j++) {\n                    cellValue = this.parent.getValueFromArg(cellColl[j]);\n                    if (!isNaN(this.parent.parseFloat(cellValue))) {\n                        if (argVal.length > 0 && argVal !== '' && argVal !== ' ') {\n                            result++;\n                        }\n                    }\n                }\n            }\n            else {\n                argVal = argVal.split(this.parent.tic).join('');\n                if (!isNaN(this.parent.parseFloat(this.parent.getValueFromArg(argVal)))) {\n                    if (argVal.length > 0 && argVal !== '' && argVal !== ' ') {\n                        result++;\n                    }\n                }\n            }\n        }\n        return result;\n    };\n    /** @hidden */\n    BasicFormulas.prototype.ComputeDATE = function () {\n        var args = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            args[_i] = arguments[_i];\n        }\n        if (isNullOrUndefined(args) || (args.length === 1 && args[0] === '')) {\n            return this.parent.formulaErrorStrings[FormulasErrorsStrings.wrong_number_arguments];\n        }\n        var argArr = args;\n        if (argArr.length !== 3) {\n            return this.parent.formulaErrorStrings[FormulasErrorsStrings.wrong_number_arguments];\n        }\n        for (var i = 0; i < argArr.length; ++i) {\n            argArr[i] = this.parent.getValueFromArg(argArr[i]);\n        }\n        /* tslint:disable */\n        argArr[0] = (argArr[0].split(this.parent.tic).join('') === 'TRUE') ? '1' : (argArr[0].split(this.parent.tic).join('') === 'FALSE') ? '0' : argArr[0];\n        argArr[1] = (argArr[1].split(this.parent.tic).join('') === 'TRUE') ? '1' : (argArr[1].split(this.parent.tic).join('') === 'FALSE') ? '0' : argArr[1];\n        argArr[2] = (argArr[2].split(this.parent.tic).join('') === 'TRUE') ? '1' : (argArr[2].split(this.parent.tic).join('') === 'FALSE') ? '0' : argArr[2];\n        /* tslint:enable */\n        var year = this.parent.parseFloat(argArr[0].split(this.parent.tic).join(''));\n        var month = this.parent.parseFloat(argArr[1].split(this.parent.tic).join(''));\n        var day = this.parent.parseFloat(argArr[2].split(this.parent.tic).join(''));\n        var days = 0;\n        if (!isNaN(year) && !isNaN(month) && !isNaN(day)) {\n            if (year < 0) {\n                return this.parent.getErrorStrings()[CommonErrors.num].toString();\n            }\n            while (month > 12) {\n                month -= 12;\n                year++;\n            }\n            days = this.parent.getSerialDateFromDate(year, month, day);\n        }\n        else {\n            return this.parent.getErrorStrings()[CommonErrors.value].toString();\n        }\n        if (days === 0) {\n            return this.parent.getErrorStrings()[CommonErrors.num].toString();\n        }\n        var date = this.parent.fromOADate(days);\n        if (date.toString() !== 'Invalid Date') {\n            /* tslint:disable-next-line */\n            return date.getFullYear() + '/' + this.parent.calculateDate((date.getMonth() + 1).toString()) + '/' + this.parent.calculateDate(date.getDate().toString());\n        }\n        return days.toString();\n    };\n    /** @hidden */\n    BasicFormulas.prototype.ComputeFLOOR = function () {\n        var args = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            args[_i] = arguments[_i];\n        }\n        if (isNullOrUndefined(args) || (args.length === 1 && args[0] === '')) {\n            return this.parent.formulaErrorStrings[FormulasErrorsStrings.invalid_arguments];\n        }\n        var argArr = args;\n        var argCount = argArr.length;\n        var splitArg = argArr[1].split(this.parent.tic).join('');\n        var argValue = [];\n        var fnum;\n        var significance;\n        if (argCount !== 2) {\n            return this.parent.formulaErrorStrings[FormulasErrorsStrings.wrong_number_arguments];\n        }\n        argValue.push(fnum = this.parent.parseFloat(this.parent.getValueFromArg(argArr[0].split(this.parent.tic).join(''))));\n        argArr[1] = (splitArg === this.parent.trueValue) ? '1' : (splitArg === this.parent.falseValue) ? '0' : argArr[1];\n        argValue.push(significance = this.parent.parseFloat(this.parent.getValueFromArg(argArr[1].split(this.parent.tic).join(''))));\n        if (fnum > 0 && significance < 0) {\n            return this.parent.getErrorStrings()[CommonErrors.num];\n        }\n        if (fnum > 0 && significance === 0) {\n            return this.parent.getErrorStrings()[CommonErrors.divzero];\n        }\n        for (var i = 0; i < argArr.length; i++) {\n            if (argArr[i].indexOf(this.parent.tic) > -1) {\n                return this.parent.getErrorStrings()[CommonErrors.value];\n            }\n        }\n        if (isNaN(fnum)) {\n            return this.parent.getErrorStrings()[CommonErrors.name];\n        }\n        return Math.floor(fnum / significance) * significance;\n    };\n    /** @hidden */\n    BasicFormulas.prototype.ComputeCEILING = function () {\n        var args = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            args[_i] = arguments[_i];\n        }\n        if (isNullOrUndefined(args) || (args.length === 1 && args[0] === '')) {\n            return this.parent.formulaErrorStrings[FormulasErrorsStrings.invalid_arguments];\n        }\n        var argArr = args;\n        var orgValue = [];\n        var argCount = argArr.length;\n        var splitArg = argArr[1].split(this.parent.tic).join('');\n        var cnum;\n        var significance;\n        if (argCount !== 2) {\n            return this.parent.formulaErrorStrings[FormulasErrorsStrings.wrong_number_arguments];\n        }\n        orgValue.push(cnum = this.parent.parseFloat(this.parent.getValueFromArg(argArr[0].split(this.parent.tic).join(''))));\n        argArr[1] = (splitArg === this.parent.trueValue) ? '1' : (splitArg === this.parent.falseValue) ? '0' : argArr[1];\n        orgValue.push(significance = this.parent.parseFloat(this.parent.getValueFromArg(argArr[1].split(this.parent.tic).join(''))));\n        if (cnum > 0 && significance < 0) {\n            return this.parent.getErrorStrings()[CommonErrors.num];\n        }\n        for (var i = 0; i < argArr.length; i++) {\n            if (argArr[i].indexOf(this.parent.tic) > -1) {\n                return this.parent.getErrorStrings()[CommonErrors.value];\n            }\n        }\n        if (isNaN(cnum)) {\n            return this.parent.getErrorStrings()[CommonErrors.name];\n        }\n        if (significance === 0) {\n            return 0;\n        }\n        return Math.ceil(cnum / significance) * significance;\n    };\n    /** @hidden */\n    BasicFormulas.prototype.ComputeDAY = function () {\n        var serialNumber = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            serialNumber[_i] = arguments[_i];\n        }\n        var date = serialNumber;\n        var result;\n        if (isNullOrUndefined(date) || (date.length === 1 && date[0] === '')) {\n            return this.parent.formulaErrorStrings[FormulasErrorsStrings.invalid_arguments];\n        }\n        if (date.length > 1) {\n            return this.parent.formulaErrorStrings[FormulasErrorsStrings.wrong_number_arguments];\n        }\n        var dateVal = this.parent.getValueFromArg(date[0].split(this.parent.tic).join(''));\n        if (!isNaN(this.parent.parseFloat(dateVal))) {\n            return this.parent.getErrorStrings()[CommonErrors.name];\n        }\n        else {\n            dateVal = dateVal;\n        }\n        result = this.parent.parseDate(dateVal);\n        if (Object.prototype.toString.call(result) === '[object Date]') {\n            /* tslint:disable-next-line */\n            result = result.getDate();\n        }\n        return result;\n    };\n    /** @hidden */\n    BasicFormulas.prototype.ComputeIF = function () {\n        var args = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            args[_i] = arguments[_i];\n        }\n        if (isNullOrUndefined(args) || (args.length === 1 && args[0] === '')) {\n            return this.parent.formulaErrorStrings[FormulasErrorsStrings.invalid_arguments];\n        }\n        if (this.parent.getErrorStrings().indexOf(args[0]) > 0) {\n            return args[0];\n        }\n        var argArr = args;\n        var condition;\n        var result;\n        if (argArr.length > 3 || argArr.length === 1) {\n            return this.parent.formulaErrorStrings[FormulasErrorsStrings.wrong_number_arguments];\n        }\n        else if (argArr.length <= 3) {\n            condition = this.parent.getValueFromArg(argArr[0]);\n            if (this.parent.getErrorStrings().indexOf(condition) > -1) {\n                return condition;\n            }\n            if (condition === this.parent.trueValue || this.parent.parseFloat(condition) > 0 || this.parent.parseFloat(condition) < 0) {\n                result = this.parent.getValueFromArg(argArr[1]);\n            }\n            else if (condition === this.parent.falseValue || this.parent.parseFloat(condition) === 0) {\n                if (isNullOrUndefined(argArr[2])) {\n                    return this.parent.falseValue;\n                }\n                result = this.parent.getValueFromArg(argArr[2]);\n            }\n            else {\n                return this.parent.formulaErrorStrings[FormulasErrorsStrings.requires_3_args];\n            }\n        }\n        if (result.indexOf(this.parent.tic) > -1) {\n            return result.split(this.parent.tic).join('');\n        }\n        else {\n            return result;\n        }\n    };\n    /** @hidden */\n    BasicFormulas.prototype.ComputeIFERROR = function () {\n        var args = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            args[_i] = arguments[_i];\n        }\n        if (isNullOrUndefined(args) || (args.length === 1 && args[0] === '')) {\n            return this.parent.formulaErrorStrings[FormulasErrorsStrings.invalid_arguments];\n        }\n        var argArr = args;\n        var condition;\n        if (argArr.length !== 2) {\n            return this.parent.formulaErrorStrings[FormulasErrorsStrings.wrong_number_arguments];\n        }\n        condition = this.parent.getValueFromArg(argArr[0]);\n        if (condition === this.parent.trueValue || condition === this.parent.falseValue) {\n            return condition;\n        }\n        if (condition[0] === this.parent.arithMarker) {\n            condition = condition.replace(this.parent.arithMarker, ' ');\n        }\n        condition = this.parent.getValueFromArg(condition).toUpperCase().split(this.parent.tic).join('');\n        if (condition[0] === '#' || condition.indexOf('Infinity') > -1 || this.parent.getErrorStrings().indexOf(condition) > -1) {\n            return this.parent.getValueFromArg(argArr[1]).split(this.parent.tic).join('');\n        }\n        else {\n            return condition;\n        }\n    };\n    /** @hidden */\n    BasicFormulas.prototype.ComputePRODUCT = function () {\n        var range = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            range[_i] = arguments[_i];\n        }\n        if (isNullOrUndefined(range) || (range.length === 1 && range[0] === '')) {\n            return this.parent.formulaErrorStrings[FormulasErrorsStrings.invalid_arguments];\n        }\n        var product = 1;\n        var val;\n        var orgValue;\n        var argsHit = true;\n        var parseVal;\n        if (!isNullOrUndefined(range)) {\n            var argArr = range;\n            for (var i = 0; i < argArr.length; i++) {\n                var rangevalue = argArr[i];\n                if (rangevalue.indexOf(':') > -1 && this.parent.isCellReference(rangevalue)) {\n                    var cellCollection = this.parent.getCellCollection(rangevalue);\n                    for (var j = 0; j < cellCollection.length; j++) {\n                        val = this.parent.getValueFromArg(cellCollection[j].split(this.parent.tic).join(''));\n                        if (this.parent.getErrorStrings().indexOf(val) > -1) {\n                            return val;\n                        }\n                        val = (val.split(this.parent.tic).join('') === 'TRUE') ? '1' :\n                            (val.split(this.parent.tic).join('') === 'FALSE') ? '0' : val;\n                        parseVal = this.parent.parseFloat(val);\n                        if (!isNaN(parseVal)) {\n                            if (val.length > 0) {\n                                product = product * parseVal;\n                                argsHit = false;\n                            }\n                        }\n                    }\n                }\n                else {\n                    orgValue = this.parent.getValueFromArg(argArr[i].split(this.parent.tic).join(''));\n                    if (this.parent.getErrorStrings().indexOf(orgValue) > -1) {\n                        return orgValue;\n                    }\n                    orgValue = (orgValue.split(this.parent.tic).join('') === 'TRUE') ? '1' :\n                        (orgValue.split(this.parent.tic).join('') === 'FALSE') ? '0' : orgValue;\n                    parseVal = this.parent.parseFloat(orgValue);\n                    if (!isNaN(parseVal)) {\n                        if (orgValue.length > 0) {\n                            product = product * parseVal;\n                            argsHit = false;\n                        }\n                    }\n                    if (this.parent.getErrorStrings().indexOf(orgValue) > -1) {\n                        return orgValue;\n                    }\n                }\n            }\n        }\n        return argsHit ? '0' : product.toString();\n    };\n    /** @hidden */\n    BasicFormulas.prototype.ComputeDAYS = function () {\n        var range = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            range[_i] = arguments[_i];\n        }\n        var result;\n        if (isNullOrUndefined(range) && (range.length === 1 && range[0] === '')) {\n            return this.parent.formulaErrorStrings[FormulasErrorsStrings.invalid_arguments];\n        }\n        if (range.length !== 2) {\n            return this.parent.formulaErrorStrings[FormulasErrorsStrings.wrong_number_arguments];\n        }\n        var argsArr = range;\n        if (argsArr[0].split(this.parent.tic).join('') === this.parent.trueValue) {\n            argsArr[0] = '1';\n        }\n        if (argsArr[0].split(this.parent.tic).join('') === this.parent.falseValue) {\n            argsArr[0] = '0';\n        }\n        var endDate = this.parent.getValueFromArg(argsArr[0].split(this.parent.tic).join(''));\n        var startDate = this.parent.getValueFromArg(argsArr[1].split(this.parent.tic).join(''));\n        startDate = (startDate === '' || startDate == null) ? new Date(Date.parse('1899-12-31')).toDateString() : startDate;\n        endDate = (endDate === '' || endDate == null) ? new Date(Date.parse('1899-12-31')).toDateString() : endDate;\n        if (endDate[0] === '#') {\n            return endDate;\n        }\n        if (startDate[0] === '#') {\n            return startDate;\n        }\n        var d1 = this.parent.intToDate(endDate);\n        var d2 = this.parent.intToDate(startDate);\n        if (d1.toString()[0] === '#') {\n            return d1.toString();\n        }\n        if (d2.toString()[0] === '#') {\n            return d2.toString();\n        }\n        if (Object.prototype.toString.call(d1) === '[object Date]' && Object.prototype.toString.call(d2) === '[object Date]') {\n            /* tslint:disable-next-line */\n            result = Math.ceil(d1.getTime() - d2.getTime()) / (1000 * 3600 * 24);\n        }\n        else {\n            return this.parent.getErrorStrings()[CommonErrors.value];\n        }\n        return Math.round(result);\n    };\n    /** @hidden */\n    BasicFormulas.prototype.ComputeCHOOSE = function () {\n        var args = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            args[_i] = arguments[_i];\n        }\n        if (isNullOrUndefined(args) || (args.length === 1 && args[0] === '')) {\n            return this.parent.formulaErrorStrings[FormulasErrorsStrings.invalid_arguments];\n        }\n        if (args.length < 2) {\n            return this.parent.formulaErrorStrings[FormulasErrorsStrings.wrong_number_arguments];\n        }\n        var argsArr = args;\n        if (argsArr[0].indexOf(':') > -1 && this.parent.isCellReference(argsArr[0])) {\n            var cellCollection = this.parent.getCellCollection(argsArr[0]);\n            if (cellCollection.length === 1) {\n                argsArr[0] = cellCollection[0];\n            }\n            else {\n                return this.parent.getErrorStrings()[CommonErrors.value];\n            }\n        }\n        var cond = this.parent.getValueFromArg(argsArr[0]);\n        if (this.parent.getErrorStrings().indexOf(cond) > -1) {\n            return cond;\n        }\n        var indexNum = this.parent.parseFloat(this.parent.getValueFromArg(argsArr[0].split(this.parent.tic).join('')));\n        if (indexNum < 1) {\n            return this.parent.getErrorStrings()[CommonErrors.value];\n        }\n        indexNum = Math.floor(indexNum);\n        var result;\n        if (isNullOrUndefined(argsArr[indexNum])) {\n            return this.parent.getErrorStrings()[CommonErrors.value];\n        }\n        result = argsArr[indexNum];\n        if (result === '') {\n            result = '0';\n        }\n        if (result.indexOf(':') > -1 && this.parent.isCellReference(result)) {\n            var cellCollection = this.parent.getCellCollection(argsArr[0].split(this.parent.tic).join(''));\n            if (cellCollection.length === 1) {\n                argsArr[0] = cellCollection[0];\n            }\n            else {\n                return this.parent.getErrorStrings()[CommonErrors.value];\n            }\n        }\n        return this.parent.getValueFromArg(result).split(this.parent.tic).join('');\n    };\n    /** @hidden */\n    BasicFormulas.prototype.ComputeSUMIF = function () {\n        var range = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            range[_i] = arguments[_i];\n        }\n        var argArr = range;\n        if (argArr[0].indexOf(':') < 0 && !this.parent.isCellReference(argArr[0])) {\n            return this.parent.formulaErrorStrings[FormulasErrorsStrings.improper_formula];\n        }\n        var result = this.parent.computeSumIfAndAvgIf(range);\n        if (typeof result === 'string' && (this.parent.formulaErrorStrings.indexOf(result)\n            || this.parent.getErrorStrings().indexOf(result))) {\n            return result;\n        }\n        return result[0];\n    };\n    /** @hidden */\n    BasicFormulas.prototype.ComputeABS = function () {\n        var absValue = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            absValue[_i] = arguments[_i];\n        }\n        var argArr = absValue;\n        var cellvalue = '';\n        var absVal;\n        if (absValue.length === 0 || absValue.length > 1) {\n            return this.parent.formulaErrorStrings[FormulasErrorsStrings.wrong_number_arguments];\n        }\n        if (argArr[0].toString().split(this.parent.tic).join('').trim() === '' || argArr[0].indexOf(this.parent.tic) > -1) {\n            return this.parent.getErrorStrings()[CommonErrors.value];\n        }\n        if (this.parent.isCellReference(argArr[0])) {\n            cellvalue = this.parent.getValueFromArg(argArr[0]);\n            if (cellvalue === '') {\n                return this.parent.getErrorStrings()[CommonErrors.name];\n            }\n            absVal = this.parent.parseFloat(cellvalue);\n            if (isNaN(absVal)) {\n                return this.parent.getErrorStrings()[CommonErrors.value];\n            }\n        }\n        else {\n            absVal = this.parent.parseFloat(argArr[0]);\n            if (isNaN(absVal)) {\n                return this.parent.getErrorStrings()[CommonErrors.name];\n            }\n        }\n        return Math.abs(absVal);\n    };\n    /** @hidden */\n    BasicFormulas.prototype.ComputeAVERAGE = function () {\n        var args = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            args[_i] = arguments[_i];\n        }\n        if (isNullOrUndefined(args) || (args.length === 1 && args[0] === '')) {\n            return this.parent.formulaErrorStrings[FormulasErrorsStrings.invalid_arguments];\n        }\n        var argArr = args;\n        for (var i = 0; i < argArr.length; i++) {\n            if (argArr[i].indexOf(':') > -1) {\n                if (argArr[i].indexOf(this.parent.tic) > -1) {\n                    return this.parent.getErrorStrings()[CommonErrors.value];\n                }\n            }\n        }\n        return this.parent.calculateAvg(argArr);\n    };\n    /** @hidden */\n    BasicFormulas.prototype.ComputeAVERAGEIF = function () {\n        var range = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            range[_i] = arguments[_i];\n        }\n        var argList = range;\n        if (argList[0].indexOf(':') < 0 && !this.parent.isCellReference(argList[0])) {\n            return this.parent.formulaErrorStrings[FormulasErrorsStrings.improper_formula];\n        }\n        var resultVal = this.parent.computeSumIfAndAvgIf(range);\n        if (typeof resultVal === 'string' && (this.parent.formulaErrorStrings.indexOf(resultVal)\n            || this.parent.getErrorStrings().indexOf(resultVal))) {\n            return resultVal;\n        }\n        return this.parent.parseFloat(resultVal[0]) / this.parent.parseFloat(resultVal[1]);\n    };\n    /** @hidden */\n    BasicFormulas.prototype.ComputeCONCATENATE = function () {\n        var range = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            range[_i] = arguments[_i];\n        }\n        if (isNullOrUndefined(range) || (range.length === 1 && range[0] === '')) {\n            return this.parent.formulaErrorStrings[FormulasErrorsStrings.invalid_arguments];\n        }\n        var argsList = range;\n        var result = '';\n        var tempStr = '';\n        for (var i = 0; i < argsList.length; i++) {\n            if (argsList[i].indexOf(':') > -1 && this.parent.isCellReference(argsList[i])) {\n                if (this.isConcat) {\n                    var cells = this.parent.getCellCollection(argsList[i]);\n                    for (var i_1 = 0; i_1 < cells.length; i_1++) {\n                        tempStr = this.parent.getValueFromArg(cells[i_1]);\n                        result = result + tempStr;\n                    }\n                }\n                else {\n                    return this.parent.getErrorStrings()[CommonErrors.value];\n                }\n            }\n            else {\n                if (argsList.length === 1 && argsList[0].indexOf(this.parent.tic) < 0) {\n                    return this.parent.getErrorStrings()[CommonErrors.name];\n                }\n                else {\n                    tempStr = this.parent.getValueFromArg(argsList[i]);\n                    result = result + tempStr;\n                }\n            }\n            if (this.parent.getErrorStrings().indexOf(tempStr) > -1) {\n                return tempStr;\n            }\n        }\n        return result.split(this.parent.tic).join('');\n    };\n    /** @hidden */\n    BasicFormulas.prototype.ComputeCONCAT = function () {\n        var range = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            range[_i] = arguments[_i];\n        }\n        this.isConcat = true;\n        return this.ComputeCONCATENATE.apply(this, range);\n    };\n    /** @hidden */\n    BasicFormulas.prototype.ComputeMAX = function () {\n        var args = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            args[_i] = arguments[_i];\n        }\n        return this.parent.computeMinMax(args, 'max');\n    };\n    /** @hidden */\n    BasicFormulas.prototype.ComputeMIN = function () {\n        var args = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            args[_i] = arguments[_i];\n        }\n        return this.parent.computeMinMax(args, 'min');\n    };\n    /** @hidden */\n    BasicFormulas.prototype.ComputeRAND = function () {\n        var args = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            args[_i] = arguments[_i];\n        }\n        if (args.length === 1 && args[0] === '') {\n            args.length = 0;\n        }\n        if (args.length > 0) {\n            return this.parent.formulaErrorStrings[FormulasErrorsStrings.wrong_number_arguments];\n        }\n        return Math.random().toString();\n    };\n    /** @hidden */\n    BasicFormulas.prototype.ComputeAND = function () {\n        var args = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            args[_i] = arguments[_i];\n        }\n        return this.parent.computeAndOr(args, 'and');\n    };\n    /** @hidden */\n    BasicFormulas.prototype.ComputeOR = function () {\n        var args = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            args[_i] = arguments[_i];\n        }\n        return this.parent.computeAndOr(args, 'or');\n    };\n    /** @hidden */\n    BasicFormulas.prototype.ComputeFIND = function () {\n        var args = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            args[_i] = arguments[_i];\n        }\n        if (isNullOrUndefined(args) || (args.length === 1 && args[0] === '')) {\n            return this.parent.formulaErrorStrings[FormulasErrorsStrings.wrong_number_arguments];\n        }\n        var argsList = args;\n        if (argsList.length > 3) {\n            return this.parent.formulaErrorStrings[FormulasErrorsStrings.wrong_number_arguments];\n        }\n        var findText = this.parent.removeTics(this.parent.getValueFromArg(argsList[0]));\n        var withinText = this.parent.removeTics(this.parent.getValueFromArg(argsList[1]));\n        if (this.parent.getErrorStrings().indexOf(findText) > -1 || this.parent.getErrorStrings().indexOf(withinText) > -1) {\n            return this.parent.getErrorStrings()[CommonErrors.name];\n        }\n        var startNum = 1;\n        var loc;\n        if (argsList.length === 3) {\n            startNum = this.parent.removeTics(this.parent.getValueFromArg(argsList[2]));\n            if (this.parent.getErrorStrings().indexOf(startNum) > -1) {\n                return startNum;\n            }\n            startNum = this.parent.parseFloat(startNum);\n            if (isNaN(startNum)) {\n                startNum = 1;\n            }\n        }\n        if (startNum <= 0 || startNum > withinText.length) {\n            return this.parent.getErrorStrings()[CommonErrors.value];\n        }\n        loc = withinText.indexOf(findText, startNum - 1);\n        if (loc < 0) {\n            return this.parent.getErrorStrings()[CommonErrors.value];\n        }\n        return (Number(loc) + Number(1)).toString();\n    };\n    /** @hidden */\n    BasicFormulas.prototype.ComputeINDEX = function () {\n        var range = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            range[_i] = arguments[_i];\n        }\n        var argArr = range;\n        var argCount = argArr.length;\n        if (isNullOrUndefined(range) || (argArr.length === 1 && argArr[0] === '')) {\n            return this.parent.formulaErrorStrings[FormulasErrorsStrings.wrong_number_arguments];\n        }\n        if (argCount > 3) {\n            return this.parent.getErrorStrings()[CommonErrors.ref];\n        }\n        var rangeValue = '';\n        var rangeArr = [];\n        if (argCount > 2) {\n            for (var i_2 = 0; i_2 < argCount; i_2++) {\n                if (this.parent.isCellReference(argArr[i_2]) && argArr[i_2].indexOf(':') < 0) {\n                    return this.parent.getErrorStrings()[CommonErrors.ref];\n                }\n                if (this.parent.isCellReference(argArr[i_2])) {\n                    rangeArr[i_2] = argArr[i_2];\n                }\n            }\n        }\n        rangeValue = argArr[0];\n        argArr[1] = argArr[1] === '' ? '1' : argArr[1];\n        argArr[1] = this.parent.getValueFromArg(argArr[1]);\n        if (this.parent.getErrorStrings().indexOf(argArr[1]) > -1) {\n            return argArr[1];\n        }\n        if (!isNullOrUndefined(argArr[2])) {\n            argArr[2] = argArr[2] === '' ? '1' : argArr[2];\n            argArr[2] = this.parent.getValueFromArg(argArr[2]);\n            if (this.parent.getErrorStrings().indexOf(argArr[2]) > -1) {\n                return argArr[2];\n            }\n            if (argArr[2] === '0') {\n                return this.parent.getErrorStrings()[CommonErrors.value];\n            }\n        }\n        var row = parseFloat(argArr[1]);\n        row = !isNaN(row) ? row : -1;\n        var col = parseFloat(argArr[2] ? argArr[2] : '1');\n        col = !isNaN(col) ? col : -1;\n        if (row === -1 || col === -1) {\n            return this.parent.getErrorStrings()[CommonErrors.value];\n        }\n        var i = argArr[0].indexOf(':');\n        var startRow = this.parent.rowIndex(rangeValue.substring(0, i));\n        var endRow = this.parent.rowIndex(rangeValue.substring(i + 1));\n        var startCol = this.parent.colIndex(rangeValue.substring(0, i));\n        var endCol = this.parent.colIndex(rangeValue.substring(i + 1));\n        if (row > endRow - startRow + 1 || col > endCol - startCol + 1) {\n            return this.parent.getErrorStrings()[CommonErrors.ref];\n        }\n        row = startRow + row - 1;\n        col = startCol + col - 1;\n        var cellRef = '' + this.parent.convertAlpha(col) + row;\n        var result = this.parent.getValueFromArg(cellRef);\n        if (result === '') {\n            return 0;\n        }\n        return result;\n    };\n    /** @hidden */\n    BasicFormulas.prototype.ComputeIFS = function () {\n        var range = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            range[_i] = arguments[_i];\n        }\n        var argArr = range;\n        if (isNullOrUndefined(range) || (argArr.length === 1 && argArr[0] === '')) {\n            return this.parent.formulaErrorStrings[FormulasErrorsStrings.wrong_number_arguments];\n        }\n        var condition = '';\n        var result = '';\n        for (var i = 0; i < argArr.length; i++) {\n            condition = this.parent.getValueFromArg(argArr[i]);\n            if (condition !== this.parent.trueValue && condition !== this.parent.falseValue) {\n                return this.parent.getErrorStrings()[CommonErrors.value];\n            }\n            if (condition === this.parent.trueValue) {\n                if (argArr[i + 1].indexOf(this.parent.arithMarker) > -1) {\n                    return this.parent.trueValue;\n                }\n                if (this.parent.isCellReference(argArr[i + 1].split(this.parent.tic).join(''))) {\n                    result = this.parent.getValueFromArg(argArr[i + 1]);\n                }\n                else {\n                    result = (argArr[i + 1].indexOf(this.parent.tic) > -1) ? argArr[i + 1].split(this.parent.tic).join('') :\n                        this.parent.getErrorStrings()[CommonErrors.name];\n                }\n                i = i + 1;\n                return result;\n            }\n            else if (condition === this.parent.falseValue) {\n                i = i + 1;\n            }\n        }\n        return this.parent.getErrorStrings()[CommonErrors.na];\n    };\n    /** @hidden */\n    BasicFormulas.prototype.ComputeCOUNTA = function () {\n        var args = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            args[_i] = arguments[_i];\n        }\n        if (isNullOrUndefined(args) || (args.length === 1 && args[0] === '')) {\n            return this.parent.formulaErrorStrings[FormulasErrorsStrings.wrong_number_arguments];\n        }\n        var argArr = args;\n        var cellColl;\n        var result = 0;\n        var cellValue;\n        for (var i = 0; i < argArr.length; i++) {\n            if (argArr[i].indexOf(':') > -1 && this.parent.isCellReference(argArr[i])) {\n                cellColl = this.parent.getCellCollection(argArr[i].split(this.parent.tic).join(''));\n                for (var j = 0; j < cellColl.length; j++) {\n                    cellValue = this.parent.getValueFromArg(cellColl[j]);\n                    if (cellValue.length > 0) {\n                        result++;\n                    }\n                }\n            }\n            else {\n                var cellValue_1 = this.parent.getValueFromArg(argArr[i].split(this.parent.tic).join(''));\n                if (cellValue_1.length > 0) {\n                    result++;\n                }\n            }\n        }\n        return result;\n    };\n    /** @hidden */\n    BasicFormulas.prototype.ComputeAVERAGEA = function () {\n        var args = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            args[_i] = arguments[_i];\n        }\n        if (isNullOrUndefined(args) || (args.length === 1 && args[0] === '')) {\n            return this.parent.formulaErrorStrings[FormulasErrorsStrings.wrong_number_arguments];\n        }\n        var argArrs = args;\n        var cellCol;\n        var result = 0;\n        var cellValue;\n        var length = 0;\n        var parseValue;\n        for (var k = 0; k < argArrs.length; k++) {\n            if (argArrs[k].indexOf(':') > -1 && this.parent.isCellReference(argArrs[k])) {\n                cellCol = this.parent.getCellCollection(argArrs[k].split(this.parent.tic).join(''));\n                for (var j = 0; j < cellCol.length; j++) {\n                    cellValue = this.parent.getValueFromArg(cellCol[j]);\n                    if (cellValue.toUpperCase() === this.parent.trueValue) {\n                        cellValue = '1';\n                    }\n                    else if (cellValue.toUpperCase() === this.parent.falseValue || cellValue === '') {\n                        cellValue = '0';\n                    }\n                    else if (this.parent.getErrorStrings().indexOf(cellValue) > -1) {\n                        return cellValue;\n                    }\n                    else if (cellValue.length > 0) {\n                        parseValue = parseFloat(cellValue);\n                        cellValue = !isNaN(parseValue) ? parseValue : 0;\n                        result = result + cellValue;\n                        length = length + 1;\n                    }\n                }\n                length = cellCol.length;\n            }\n            else {\n                if (argArrs[k] === this.parent.trueValue) {\n                    argArrs[k] = '1';\n                }\n                if (argArrs[k] === this.parent.falseValue || argArrs[k] === '') {\n                    argArrs[k] = '0';\n                }\n                cellValue = this.parent.getValueFromArg(argArrs[k].split(this.parent.tic).join(''));\n                if (this.parent.getErrorStrings().indexOf(cellValue) > -1) {\n                    return cellValue;\n                }\n                if (cellValue.length > 0) {\n                    parseValue = parseFloat(cellValue);\n                    cellValue = !isNaN(parseValue) ? parseValue : 0;\n                    result = result + cellValue;\n                    length = length + 1;\n                }\n            }\n            if (length === 0) {\n                return this.parent.getErrorStrings()[CommonErrors.divzero];\n            }\n        }\n        return result / length;\n    };\n    /** @hidden */\n    BasicFormulas.prototype.ComputeCOUNTIF = function () {\n        var args = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            args[_i] = arguments[_i];\n        }\n        var argArr = args;\n        if (isNullOrUndefined(args) || args[0] === '' || argArr.length < 2) {\n            return this.parent.formulaErrorStrings[FormulasErrorsStrings.wrong_number_arguments];\n        }\n        var cellColl;\n        var result = 0;\n        var cellValue;\n        var stack = [];\n        var op = 'equal';\n        var condition = argArr[1].split(this.parent.tic).join('');\n        if (condition.startsWith('<=')) {\n            op = 'lessEq';\n            condition = condition.substring(2);\n        }\n        else if (condition.startsWith('>=')) {\n            op = 'greaterEq';\n            condition = condition.substring(2);\n        }\n        else if (condition.startsWith('<>')) {\n            op = 'notEq';\n            condition = condition.substring(2);\n        }\n        else if (condition.startsWith('<')) {\n            op = 'less';\n            condition = condition.substring(1);\n        }\n        else if (condition.startsWith('>')) {\n            op = 'greater';\n            condition = condition.substring(1);\n        }\n        else if (condition.startsWith('=')) {\n            op = 'equal';\n            condition = condition.substring(1);\n        }\n        if (argArr[0].indexOf(':') > -1 && this.parent.isCellReference(argArr[0])) {\n            cellColl = this.parent.getCellCollection(argArr[0].split(this.parent.tic).join(''));\n            for (var j = 0; j < cellColl.length; j++) {\n                cellValue = this.parent.getValueFromArg(cellColl[j]);\n                if (condition.indexOf('*') > -1 || condition.indexOf('?') > -1) {\n                    cellValue = this.parent.findWildCardValue(condition, cellValue);\n                }\n                stack.push(cellValue);\n                stack.push(condition);\n                if (this.parent.processLogical(stack, op) === this.parent.trueValue) {\n                    result++;\n                }\n            }\n        }\n        return result;\n    };\n    /** @hidden */\n    BasicFormulas.prototype.ComputeSUMIFS = function () {\n        var range = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            range[_i] = arguments[_i];\n        }\n        var sum;\n        sum = this.parent.computeIfsFormulas(range, this.parent.falseValue);\n        return sum;\n    };\n    /** @hidden */\n    BasicFormulas.prototype.ComputeTEXT = function () {\n        var args = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            args[_i] = arguments[_i];\n        }\n        var checkArgs;\n        var argsLength = args.length;\n        for (var i = 0; i < argsLength; i++) {\n            if (isNullOrUndefined(checkArgs)) {\n                checkArgs = args[i];\n            }\n            else {\n                checkArgs = checkArgs + ',' + args[i];\n            }\n        }\n        var splitIndex = checkArgs.indexOf(',');\n        var frtArg = checkArgs.slice(0, splitIndex);\n        var scndArg = checkArgs.slice(checkArgs.indexOf('\"') + 1, checkArgs.length);\n        var checkScndArg = scndArg.indexOf('\"');\n        if (splitIndex > -1 && checkScndArg !== scndArg.length - 1) {\n            return this.parent.formulaErrorStrings[FormulasErrorsStrings.wrong_number_arguments];\n        }\n        var s1 = frtArg;\n        var s2 = scndArg.slice(0, scndArg.length - 1);\n        var dTime = new Date(1900, 0, 1, 0, 0, 0);\n        var checkString = s1 + ',' + s2;\n        var intl = new Internationalization();\n        if (this.parent.getErrorStrings().indexOf(checkString) > -1) {\n            return checkString;\n        }\n        s1 = this.parent.getValueFromArg(s1);\n        s2 = s2.split(this.parent.tic).join('');\n        if (s2 === '') {\n            return '';\n        }\n        if (s1 === '' && (s2.length > 0 && (s2.toUpperCase().indexOf('M') > -1 || s2.toUpperCase().indexOf('D') > -1\n            || s2.toUpperCase().indexOf('Y') > -1 || s2.toUpperCase().indexOf('S') > -1 || s2.toUpperCase().indexOf('T') > -1)\n            || s2.toUpperCase().indexOf('H') > -1)) {\n            s1 = dTime.toString();\n        }\n        var d = this.parseDouble(s1);\n        if (isNaN(d) && this.parent.isDate(new Date(s1)) !== null) {\n            d = this.parent.toOADate(new Date(s1));\n        }\n        dTime = Date.parse(s1.split(this.parent.tic).join(''));\n        if (!isNaN(d) || !isNaN(dTime)) {\n            if (s2[0] === '[') {\n                return this.parent.tic + s1 + this.parent.tic;\n            }\n            if (s2.length > 0 && (s2.toUpperCase().indexOf('M') > -1 || s2.toUpperCase().indexOf('D') > -1\n                || s2.toUpperCase().indexOf('Y') > -1 || s2.toUpperCase().indexOf('S') > -1 || s2.toUpperCase().indexOf('T') > -1)\n                || s2.toUpperCase().indexOf('H') > -1) {\n                s2 = s2.split('Y').join('y').split('D').join('d').split('H').join('h');\n                s2 = s2.split('S').join('s').split('m').join('M').split('AM/PM').join('tt');\n                var formatChar = s2.split('');\n                var isH = false;\n                var isMFound = false;\n                var isFirstM = false;\n                var i = 0;\n                var mcount = 0;\n                var lastCharIndex = 0;\n                var totalCharforM = 0;\n                for (i = 0; i < formatChar.length;) {\n                    var c = formatChar[i];\n                    if (c === 's' && formatChar[lastCharIndex] === 'M') {\n                        formatChar[lastCharIndex] = 'm';\n                        if (formatChar[lastCharIndex - 1] === 'M') {\n                            formatChar[lastCharIndex - 1] = 'm';\n                        }\n                    }\n                    if (this.parent.isChar(c)) {\n                        lastCharIndex = i;\n                        if (c === 'M') {\n                            mcount++;\n                            totalCharforM++;\n                        }\n                    }\n                    else if (totalCharforM > 1) {\n                        totalCharforM++;\n                    }\n                    if (c === 'M' && isH) {\n                        formatChar[i] = 'm';\n                        isMFound = true;\n                        isFirstM = (mcount === 1);\n                    }\n                    if (c === 'h') {\n                        isH = true;\n                    }\n                    else if (this.parent.isChar(c) && c !== 'M' && c !== 'h' && !isMFound) {\n                        isH = false;\n                        isMFound = false;\n                    }\n                    i++;\n                }\n                s2 = String(formatChar);\n                s2 = s2.split(',').join('').split('\\n').join(' ');\n                var dt = this.parent.fromOADate(d);\n                if (d === 0) {\n                    dt = dTime;\n                }\n                var getSkeleton = getSkeletonVal(s2);\n                if (getSkeleton === '') {\n                    return this.parent.getErrorStrings()[CommonErrors.name];\n                }\n                var dFormatter = intl.getDateFormat({ skeleton: getSkeleton, type: 'date' });\n                var formattedString = dFormatter(new Date(dt.toString()));\n                s1 = formattedString;\n            }\n            else {\n                s1 = intl.formatNumber(d, { format: s2 });\n            }\n        }\n        return s1;\n    };\n    /** @hidden */\n    BasicFormulas.prototype.ComputeCOUNTIFS = function () {\n        var args = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            args[_i] = arguments[_i];\n        }\n        var sum;\n        sum = this.parent.computeIfsFormulas(args, this.parent.trueValue);\n        return sum;\n    };\n    /** @hidden */\n    BasicFormulas.prototype.ComputeAVERAGEIFS = function () {\n        var args = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            args[_i] = arguments[_i];\n        }\n        var sum;\n        sum = this.parent.computeIfsFormulas(args, this.parent.falseValue, this.parent.trueValue);\n        return sum;\n    };\n    /** @hidden */\n    BasicFormulas.prototype.ComputeMATCH = function () {\n        var args = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            args[_i] = arguments[_i];\n        }\n        var argArr = args;\n        if (isNullOrUndefined(argArr) || (argArr.length === 1 && argArr[0] === '') || argArr.length < 2 || argArr.length > 3) {\n            return this.parent.formulaErrorStrings[FormulasErrorsStrings.wrong_number_arguments];\n        }\n        var cellColl;\n        var cellValue = [];\n        var lookupVal = argArr[0].split(this.parent.tic).join('');\n        argArr[2] = isNullOrUndefined(argArr[2]) ? '1' : argArr[2].split(this.parent.tic).join('');\n        if (argArr[2].split(this.parent.tic).join('') === this.parent.trueValue) {\n            argArr[2] = '1';\n        }\n        if (argArr[2].split(this.parent.tic).join('') === this.parent.falseValue) {\n            argArr[2] = '0';\n        }\n        var matchType = parseFloat(argArr[2]);\n        if (matchType !== -1 && matchType !== 0 && matchType !== 1) {\n            return this.parent.getErrorStrings()[CommonErrors.na];\n        }\n        var index = 0;\n        var indexVal = '';\n        if (argArr[1].indexOf(':') > -1 || this.parent.isCellReference(argArr[1])) {\n            cellColl = this.parent.getCellCollection(argArr[1].split(this.parent.tic).join(''));\n            for (var j = 0; j < cellColl.length; j++) {\n                cellValue[j] = this.parent.getValueFromArg(cellColl[j]).split(this.parent.tic).join('');\n            }\n            for (var i = 0; i < cellValue.length; i++) {\n                if (matchType === 1) {\n                    if (lookupVal === cellValue[i]) {\n                        return i + 1;\n                    }\n                    else if (lookupVal > cellValue[i]) {\n                        if (!indexVal) {\n                            index = i + 1;\n                            indexVal = cellValue[i];\n                        }\n                        else if (cellValue[i] > indexVal) {\n                            index = i + 1;\n                            indexVal = cellValue[i];\n                        }\n                    }\n                }\n                else if (matchType === 0) {\n                    if (lookupVal.indexOf('*') > -1 || lookupVal.indexOf('?') > -1) {\n                        cellValue[i] = this.parent.findWildCardValue(lookupVal, cellValue[i]);\n                    }\n                    if (lookupVal === cellValue[i]) {\n                        return i + 1;\n                    }\n                    if (this.parent.parseFloat(lookupVal) === this.parent.parseFloat(cellValue[i])) {\n                        return i + 1;\n                    }\n                }\n                else if (matchType === -1) {\n                    if (lookupVal === cellValue[i]) {\n                        return i + 1;\n                    }\n                    else if (lookupVal < cellValue[i]) {\n                        if (!indexVal) {\n                            index = i + 1;\n                            indexVal = cellValue[i];\n                        }\n                        else if (cellValue[i] < indexVal) {\n                            index = i + 1;\n                            indexVal = cellValue[i];\n                        }\n                    }\n                }\n            }\n        }\n        return index ? index : this.parent.getErrorStrings()[CommonErrors.na];\n    };\n    /** @hidden */\n    BasicFormulas.prototype.ComputeLOOKUP = function () {\n        var range = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            range[_i] = arguments[_i];\n        }\n        var argArr = range;\n        var result = '';\n        if (isNullOrUndefined(argArr) || (argArr.length === 1 && argArr[0] === '') || argArr.length < 2 || argArr.length > 3) {\n            return this.parent.formulaErrorStrings[FormulasErrorsStrings.wrong_number_arguments];\n        }\n        result = this.parent.computeLookup(argArr);\n        return result;\n    };\n    /** @hidden */\n    BasicFormulas.prototype.ComputeVLOOKUP = function () {\n        var range = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            range[_i] = arguments[_i];\n        }\n        var argArr = range;\n        var result = '';\n        if (isNullOrUndefined(argArr) || (argArr.length === 1 && argArr[0] === '') || argArr.length < 3 || argArr.length > 4) {\n            return this.parent.formulaErrorStrings[FormulasErrorsStrings.wrong_number_arguments];\n        }\n        result = this.parent.computeVLookup(argArr);\n        return result;\n    };\n    /** @hidden */\n    BasicFormulas.prototype.ComputeSUBTOTAL = function () {\n        var range = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            range[_i] = arguments[_i];\n        }\n        var argArr = range;\n        var result = '';\n        if (argArr.length < 2) {\n            return this.parent.formulaErrorStrings[FormulasErrorsStrings.wrong_number_arguments];\n        }\n        var formula = this.parent.parseFloat(this.parent.getValueFromArg(argArr[0].split(this.parent.tic).join('')));\n        if (isNaN(formula)) {\n            this.parent.getErrorStrings()[CommonErrors.value];\n        }\n        if ((formula < 1 || formula > 11) && (formula < 101 || formula > 111)) {\n            this.parent.getErrorStrings()[CommonErrors.value];\n        }\n        var cellRef = argArr.slice(1, argArr.length);\n        switch (formula) {\n            case 1:\n            case 101:\n                result = this.ComputeAVERAGE.apply(this, cellRef);\n                break;\n            case 2:\n            case 102:\n                result = this.ComputeCOUNT.apply(this, cellRef);\n                break;\n            case 3:\n            case 103:\n                result = this.ComputeCOUNTA.apply(this, cellRef);\n                break;\n            case 4:\n            case 104:\n                result = this.ComputeMAX.apply(this, cellRef);\n                break;\n            case 5:\n            case 105:\n                result = this.ComputeMIN.apply(this, cellRef);\n                break;\n            case 6:\n            case 106:\n                result = this.ComputePRODUCT.apply(this, cellRef);\n                break;\n            case 7:\n            case 107:\n                result = this.ComputeDAY.apply(this, cellRef);\n                break;\n            case 8:\n            case 108:\n                result = this.ComputeCONCAT.apply(this, cellRef);\n                break;\n            case 9:\n            case 109:\n                result = this.ComputeSUM.apply(this, cellRef);\n                break;\n            case 10:\n            case 110:\n                result = this.ComputeAVERAGEA.apply(this, cellRef);\n                break;\n            case 11:\n            case 111:\n                result = this.ComputeABS.apply(this, cellRef);\n                break;\n            default:\n                result = this.parent.getErrorStrings()[CommonErrors.value];\n                break;\n        }\n        return result;\n    };\n    /** @hidden */\n    BasicFormulas.prototype.ComputeRADIANS = function () {\n        var range = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            range[_i] = arguments[_i];\n        }\n        var argArr = range;\n        var result;\n        if (argArr[0] === '' || argArr.length > 1) {\n            return this.parent.formulaErrorStrings[FormulasErrorsStrings.wrong_number_arguments];\n        }\n        if (argArr[0].indexOf(':') > -1 || argArr[0].split(this.parent.tic).join('') === '') {\n            return this.parent.getErrorStrings()[CommonErrors.value];\n        }\n        var val = argArr[0].split(this.parent.tic).join('');\n        argArr[0] = isNaN(this.parent.parseFloat(val)) ? argArr[0] : val;\n        var cellvalue = this.parent.getValueFromArg(argArr[0]);\n        var radVal = this.parent.parseFloat(cellvalue);\n        if (!isNaN(radVal)) {\n            result = Math.PI * (radVal) / 180;\n        }\n        else {\n            if (cellvalue.indexOf(this.parent.tic) > -1) {\n                return this.parent.getErrorStrings()[CommonErrors.value];\n            }\n            else {\n                return this.parent.getErrorStrings()[CommonErrors.name];\n            }\n        }\n        return result;\n    };\n    /** @hidden */\n    BasicFormulas.prototype.ComputeRANDBETWEEN = function () {\n        var range = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            range[_i] = arguments[_i];\n        }\n        var argsLength = range.length;\n        var min;\n        var max;\n        var argVal;\n        if (argsLength !== 2) {\n            return this.parent.formulaErrorStrings[FormulasErrorsStrings.wrong_number_arguments];\n        }\n        for (var i = 0; i < argsLength; i++) {\n            if (range[i] === '') {\n                return this.parent.getErrorStrings()[CommonErrors.na];\n            }\n            if (range[i].indexOf(this.parent.tic) > -1) {\n                if (isNaN(parseFloat(range[i].split(this.parent.tic).join('')))) {\n                    return this.parent.getErrorStrings()[CommonErrors.value];\n                }\n                else {\n                    range[i] = range[i].split(this.parent.tic).join('');\n                }\n            }\n            argVal = parseFloat(this.parent.getValueFromArg(range[i]));\n            if (!this.parent.isCellReference(range[i])) {\n                if (isNaN(argVal)) {\n                    return this.parent.getErrorStrings()[CommonErrors.name];\n                }\n                i === 0 ? min = argVal : max = argVal;\n            }\n            else {\n                argVal = this.parent.getValueFromArg(range[i]) === '' ? 0 : argVal;\n                i === 0 ? min = argVal : max = argVal;\n                if (min === 0 && max === 0) {\n                    return '0';\n                }\n                if (isNaN(argVal)) {\n                    return this.parent.getErrorStrings()[CommonErrors.value];\n                }\n            }\n        }\n        if (max < min) {\n            return this.parent.getErrorStrings()[CommonErrors.num];\n        }\n        if (min === 0) {\n            return Math.floor(Math.random() * (max - (min - 1))) + min;\n        }\n        else {\n            return max - min === 1 ? Math.round((Math.random() * (max - min)) + min) : Math.floor(Math.random() * (max - (min - 1))) + min;\n        }\n    };\n    /** @hidden */\n    BasicFormulas.prototype.ComputeSLOPE = function () {\n        var range = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            range[_i] = arguments[_i];\n        }\n        var argArr = range;\n        if (argArr.length !== 2 || argArr[0] === '') {\n            return this.parent.formulaErrorStrings[FormulasErrorsStrings.wrong_number_arguments];\n        }\n        var yPoints;\n        var xPoints;\n        var xPointsRange = this.parent.getCellCollection(argArr[1].split(this.parent.tic).join(''));\n        var yPointsRange = this.parent.getCellCollection(argArr[0].split(this.parent.tic).join(''));\n        if (yPointsRange.length !== xPointsRange.length) {\n            return this.parent.getErrorStrings()[CommonErrors.na];\n        }\n        yPoints = this.getDataCollection(yPointsRange);\n        xPoints = this.getDataCollection(xPointsRange);\n        if (xPoints.indexOf('#NAME?') > -1 || yPoints.indexOf('#NAME?') > -1) {\n            return this.parent.getErrorStrings()[CommonErrors.name];\n        }\n        var sumXY = 0;\n        var sumX2 = 0;\n        var sumX = 0;\n        var sumY = 0;\n        for (var i = 0, len = xPoints.length; i < len; ++i) {\n            if (Number(xPoints[i]).toString() !== 'NaN' && Number(yPoints[i]).toString() !== 'NaN') {\n                sumXY += Number(xPoints[i]) * Number(yPoints[i]);\n                sumX += Number(xPoints[i]);\n                sumY += Number(yPoints[i]);\n                sumX2 += Number(xPoints[i]) * Number(xPoints[i]);\n            }\n        }\n        if ((sumXY - sumX * sumY) === 0 || (sumX2 - sumX * sumX) === 0) {\n            this.parent.getErrorStrings()[CommonErrors.divzero];\n        }\n        var result = ((sumXY - sumX * sumY / xPoints.length) / (sumX2 - sumX * sumX / xPoints.length)).toString();\n        if (result === 'NaN') {\n            return this.parent.getErrorStrings()[CommonErrors.divzero];\n        }\n        return result;\n    };\n    /** @hidden */\n    BasicFormulas.prototype.ComputeINTERCEPT = function () {\n        var range = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            range[_i] = arguments[_i];\n        }\n        var argArr = range;\n        if (argArr[0] === '' || argArr.length !== 2) {\n            return this.parent.formulaErrorStrings[FormulasErrorsStrings.wrong_number_arguments];\n        }\n        var xValues;\n        var yValues;\n        var yValuesRange = this.parent.getCellCollection(argArr[0].split(this.parent.tic).join(''));\n        var xValuesRange = this.parent.getCellCollection(argArr[1].split(this.parent.tic).join(''));\n        if (yValuesRange.length !== xValuesRange.length) {\n            return this.parent.getErrorStrings()[CommonErrors.na];\n        }\n        xValues = this.getDataCollection(xValuesRange);\n        yValues = this.getDataCollection(yValuesRange);\n        if (xValues.indexOf('#NAME?') > -1 || yValues.indexOf('#NAME?') > -1) {\n            return this.parent.getErrorStrings()[CommonErrors.name];\n        }\n        var sumX = 0;\n        var sumY = 0;\n        for (var i = 0, len = xValues.length; i < len; ++i) {\n            sumX += Number(xValues[i]);\n            sumY += Number(yValues[i]);\n        }\n        sumX = sumX / xValues.length;\n        sumY = sumY / xValues.length;\n        var sumXY = 0;\n        var sumX2 = 0;\n        var diff;\n        for (var i = 0, len = xValues.length; i < len; ++i) {\n            diff = Number(xValues[i]) - sumX;\n            sumXY += diff * (Number(yValues[i]) - sumY);\n            sumX2 += diff * diff;\n        }\n        var result = (sumY - sumXY / sumX2 * sumX).toString();\n        if ((sumY - sumXY) === 0 || (sumX2 * sumX) === 0) {\n            this.parent.getErrorStrings()[CommonErrors.divzero];\n        }\n        if (result === 'NaN') {\n            return this.parent.getErrorStrings()[CommonErrors.divzero];\n        }\n        return result;\n    };\n    /** @hidden */\n    BasicFormulas.prototype.ComputeLN = function () {\n        var logValue = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            logValue[_i] = arguments[_i];\n        }\n        var argArr = logValue;\n        var cellvalue = '';\n        var logVal;\n        var orgValue;\n        if (logValue.length === 0 || logValue.length > 1) {\n            return this.parent.formulaErrorStrings[FormulasErrorsStrings.wrong_number_arguments];\n        }\n        if (this.parent.isCellReference(argArr[0])) {\n            cellvalue = this.parent.getValueFromArg(argArr[0]);\n            logVal = this.parent.parseFloat(cellvalue);\n            if (logVal <= 0 || cellvalue === '') {\n                return this.parent.getErrorStrings()[CommonErrors.num];\n            }\n            if (isNaN(logVal)) {\n                return this.parent.getErrorStrings()[CommonErrors.value];\n            }\n        }\n        else {\n            orgValue = this.parent.getValueFromArg(argArr[0].split(this.parent.tic).join(''));\n            logVal = this.parent.parseFloat(orgValue);\n            if (logVal <= 0 || logVal.toString() === '') {\n                return this.parent.getErrorStrings()[CommonErrors.num];\n            }\n            if (isNaN(logVal)) {\n                return this.parent.getErrorStrings()[CommonErrors.value];\n            }\n        }\n        return Math.log(logVal);\n    };\n    /** @hidden */\n    BasicFormulas.prototype.ComputeISNUMBER = function () {\n        var logValue = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            logValue[_i] = arguments[_i];\n        }\n        var argArr = logValue;\n        var logVal;\n        var orgValue;\n        if (logValue.length === 0 || logValue.length > 1) {\n            return this.parent.formulaErrorStrings[FormulasErrorsStrings.wrong_number_arguments];\n        }\n        orgValue = (this.parent.isCellReference(argArr[0])) ? this.parent.getValueFromArg(argArr[0]) :\n            this.parent.getValueFromArg(argArr[0].split(this.parent.tic).join(''));\n        if (orgValue.toString() === '') {\n            return false;\n        }\n        logVal = this.parent.parseFloat(orgValue);\n        return !isNaN(logVal) ? true : false;\n    };\n    /** @hidden */\n    BasicFormulas.prototype.ComputeROUND = function () {\n        var logValue = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            logValue[_i] = arguments[_i];\n        }\n        var argArr = logValue;\n        var orgValue;\n        var x = 0;\n        var digits = 0;\n        var round;\n        var numStr;\n        var digStr;\n        var mult;\n        if (logValue.length === 0 || logValue.length > 2) {\n            return this.parent.formulaErrorStrings[FormulasErrorsStrings.wrong_number_arguments];\n        }\n        if (logValue.length === 1) {\n            orgValue = (argArr[0].split(this.parent.tic).join('') === 'TRUE')\n                ? '1'\n                : (argArr[0].split(this.parent.tic).join('') === 'FALSE')\n                    ? '0'\n                    : argArr[0];\n            return Math.round(this.parent.parseFloat(orgValue)).toString();\n        }\n        numStr = this.parent.getValueFromArg(argArr[0]);\n        digStr = (argArr[1].split(this.parent.tic).join('')) === '' ? '0' :\n            this.parent.getValueFromArg(argArr[1].split(this.parent.tic).join(''));\n        numStr = (numStr.split(this.parent.tic).join('') === 'TRUE')\n            ? '1'\n            : (numStr.split(this.parent.tic).join('') === 'FALSE')\n                ? '0' : numStr;\n        digStr = (digStr.split(this.parent.tic).join('') === 'TRUE') ? '1'\n            : (digStr.split(this.parent.tic).join('') === 'FALSE')\n                ? '0' : digStr;\n        if (numStr !== '' && digStr !== '') {\n            x = this.parent.parseFloat(numStr);\n            digits = this.parent.parseFloat(digStr);\n            if (!isNaN(digits) && !isNaN(x) && digits > 0) {\n                round = x.toFixed(digits);\n            }\n            else {\n                mult = Math.pow(10, -digits);\n                round = Math.round(x / mult) * mult;\n            }\n        }\n        return round.toString();\n    };\n    /** @hidden */\n    BasicFormulas.prototype.ComputePOWER = function () {\n        var logValue = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            logValue[_i] = arguments[_i];\n        }\n        var argArr = logValue;\n        var power;\n        var orgNumValue;\n        var orgPowValue;\n        var logNumValue;\n        var logPowValue;\n        if (logValue.length === 0 || logValue.length > 2) {\n            return this.parent.formulaErrorStrings[FormulasErrorsStrings.wrong_number_arguments];\n        }\n        orgNumValue = this.parent.getValueFromArg(argArr[0]);\n        orgPowValue = this.parent.getValueFromArg(argArr[1]);\n        orgNumValue = (orgNumValue.split(this.parent.tic).join('') === 'TRUE') ? '1' :\n            (orgNumValue.split(this.parent.tic).join('') === 'FALSE') ? '0' : orgNumValue;\n        orgPowValue = (orgPowValue.split(this.parent.tic).join('') === 'TRUE') ? '1' :\n            (orgPowValue.split(this.parent.tic).join('') === 'FALSE') ? '0' : orgPowValue;\n        logNumValue = this.parent.parseFloat(orgNumValue);\n        logPowValue = this.parent.parseFloat(orgPowValue);\n        if (!isNaN(logNumValue) && !isNaN(logPowValue)) {\n            if (logNumValue === 0 && logPowValue < 0) {\n                return this.parent.getErrorStrings()[CommonErrors.divzero];\n            }\n            if (logNumValue === 0 && logPowValue === 0) {\n                return this.parent.getErrorStrings()[CommonErrors.num];\n            }\n            power = Math.pow(logNumValue, logPowValue);\n        }\n        else {\n            return this.parent.getErrorStrings()[CommonErrors.value];\n        }\n        return power.toString();\n    };\n    /** @hidden */\n    BasicFormulas.prototype.ComputeLOG = function () {\n        var logValue = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            logValue[_i] = arguments[_i];\n        }\n        var argArr = logValue;\n        var orgNumValue;\n        var orgBaseValue;\n        var logNumValue;\n        var logBaseValue;\n        if (logValue.length === 0 || logValue.length > 2) {\n            return this.parent.formulaErrorStrings[FormulasErrorsStrings.wrong_number_arguments];\n        }\n        orgNumValue = this.parent.getValueFromArg(argArr[0]);\n        orgBaseValue = (logValue.length === 2) ? this.parent.getValueFromArg(argArr[1]) : '10';\n        if ((orgNumValue === '' || orgNumValue === null) || (orgBaseValue === '' || orgBaseValue === null)) {\n            return this.parent.getErrorStrings()[CommonErrors.num];\n        }\n        orgNumValue = (orgNumValue.split(this.parent.tic).join('') === 'TRUE') ? '1' :\n            (orgNumValue.split(this.parent.tic).join('') === 'FALSE') ? '0' : orgNumValue;\n        orgBaseValue = (orgBaseValue.split(this.parent.tic).join('') === 'TRUE') ? '1' :\n            (orgBaseValue.split(this.parent.tic).join('') === 'FALSE') ? '0' : orgBaseValue;\n        logNumValue = this.parent.parseFloat(orgNumValue);\n        logBaseValue = this.parent.parseFloat(orgBaseValue);\n        if (logNumValue <= 0 || logBaseValue <= 0) {\n            return this.parent.getErrorStrings()[CommonErrors.num];\n        }\n        if (logBaseValue === 1) {\n            return this.parent.getErrorStrings()[CommonErrors.divzero];\n        }\n        if (!isNaN(logNumValue) && !isNaN(logBaseValue)) {\n            return ((Math.log(logNumValue) / Math.LN10) / (Math.log(logBaseValue) / Math.LN10)).toString();\n        }\n        else {\n            return this.parent.getErrorStrings()[CommonErrors.value];\n        }\n    };\n    /** @hidden */\n    BasicFormulas.prototype.ComputeTRUNC = function () {\n        var logValue = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            logValue[_i] = arguments[_i];\n        }\n        var argArr = logValue;\n        var orgNumValue;\n        var orgDigitValue = 0;\n        var logNumValue;\n        var logDigitValue;\n        var normalizer;\n        if (logValue.length === 0 || logValue.length > 2) {\n            return this.parent.formulaErrorStrings[FormulasErrorsStrings.wrong_number_arguments];\n        }\n        if (logValue.length === 2) {\n            orgDigitValue = this.parent.getValueFromArg(argArr[1]);\n            orgDigitValue = (orgDigitValue.split(this.parent.tic).join('') === 'TRUE') ? '1' :\n                (orgDigitValue.split(this.parent.tic).join('') === 'FALSE') ? '0' : orgDigitValue;\n            orgDigitValue = this.parent.parseFloat(orgDigitValue);\n        }\n        orgNumValue = this.parent.getValueFromArg(argArr[0]);\n        orgNumValue = (orgNumValue.split(this.parent.tic).join('') === 'TRUE') ? '1' :\n            (orgNumValue.split(this.parent.tic).join('') === 'FALSE') ? '0' : orgNumValue;\n        logNumValue = this.parent.parseFloat(orgNumValue.split(this.parent.tic).join(''));\n        if (isNaN(logNumValue) || isNaN(orgDigitValue)) {\n            return (argArr[0] === this.parent.tic || this.parent.isCellReference(argArr[0]) || (argArr[1] === this.parent.tic\n                || this.parent.isCellReference(argArr[1]))) ? this.parent.getErrorStrings()[CommonErrors.value]\n                : this.parent.getErrorStrings()[CommonErrors.name];\n        }\n        normalizer = Math.pow(10, orgDigitValue);\n        logDigitValue = (logNumValue < 0) ? -1 : 1;\n        return (logDigitValue * Math.floor(normalizer * Math.abs(logNumValue)) / normalizer).toString();\n    };\n    /** @hidden */\n    BasicFormulas.prototype.ComputeEXP = function () {\n        var logValue = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            logValue[_i] = arguments[_i];\n        }\n        var argArr = logValue;\n        var orgNumValue;\n        var logNumValue;\n        if (logValue.length === 0 || logValue.length > 1) {\n            return this.parent.formulaErrorStrings[FormulasErrorsStrings.wrong_number_arguments];\n        }\n        orgNumValue = this.parent.getValueFromArg(argArr[0]);\n        orgNumValue = (orgNumValue.split(this.parent.tic).join('') === 'TRUE') ? '1' :\n            (orgNumValue.split(this.parent.tic).join('') === 'FALSE') ? '0' : orgNumValue;\n        if (orgNumValue === '') {\n            orgNumValue = '0';\n        }\n        logNumValue = this.parent.parseFloat(orgNumValue);\n        if (logNumValue > 709) {\n            return this.parent.getErrorStrings()[CommonErrors.num];\n        }\n        if (isNaN(logNumValue)) {\n            return (argArr[0] === this.parent.tic || this.parent.isCellReference(argArr[0])) ?\n                this.parent.getErrorStrings()[CommonErrors.value]\n                : this.parent.getErrorStrings()[CommonErrors.name];\n        }\n        return Math.exp(logNumValue).toString();\n    };\n    /** @hidden */\n    BasicFormulas.prototype.ComputeGEOMEAN = function () {\n        var logValue = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            logValue[_i] = arguments[_i];\n        }\n        var argArr = logValue;\n        var sum = 1;\n        var count = 0;\n        var cellVal = 0;\n        var dev;\n        var r;\n        var s;\n        var cell;\n        if (logValue.length === 0) {\n            return this.parent.formulaErrorStrings[FormulasErrorsStrings.wrong_number_arguments];\n        }\n        for (r = 0; r < argArr.length; r++) {\n            if (argArr[r].indexOf(':') > -1) {\n                if (argArr[0] === this.parent.tic) {\n                    return this.parent.getErrorStrings()[CommonErrors.value];\n                }\n                cell = this.parent.getCellCollection(argArr[r].split(this.parent.tic).join(''));\n                for (s = 0; s < cell.length; s++) {\n                    cellVal = this.parent.getValueFromArg(cell[s]);\n                    cellVal = (cellVal.split(this.parent.tic).join('') === 'TRUE') ? '1' :\n                        (cellVal.split(this.parent.tic).join('') === 'FALSE') ? '0' : cellVal;\n                    dev = this.parent.parseFloat(cellVal);\n                    if (dev <= 0) {\n                        return this.parent.getErrorStrings()[CommonErrors.num];\n                    }\n                    else if (!isNaN(dev)) {\n                        count++;\n                        sum = sum * dev;\n                    }\n                }\n            }\n            else {\n                cellVal = this.parent.getValueFromArg(argArr[r]);\n                if (cellVal.length > 0) {\n                    cellVal = (cellVal.split(this.parent.tic).join('') === 'TRUE') ? '1' :\n                        (cellVal.split(this.parent.tic).join('') === 'FALSE') ? '0' : cellVal;\n                    if (!this.parent.isCellReference(argArr[r])) {\n                        if (isNaN(this.parent.parseFloat(cellVal))) {\n                            return this.parent.getErrorStrings()[CommonErrors.name];\n                        }\n                    }\n                    dev = this.parent.parseFloat(cellVal);\n                    if (dev <= 0) {\n                        return this.parent.getErrorStrings()[CommonErrors.num];\n                    }\n                    else if (!isNaN(dev)) {\n                        count++;\n                        sum = sum * dev;\n                    }\n                }\n            }\n        }\n        if (count > 0) {\n            sum = Math.pow(sum, 1 / count);\n        }\n        return sum.toString();\n    };\n    BasicFormulas.prototype.getDataCollection = function (cells) {\n        var cellsData = [];\n        for (var i = 0, len = cells.length; i < len; i++) {\n            cellsData.push(this.parent.getValueFromArg(cells[i]));\n        }\n        return cellsData;\n    };\n    /** @hidden */\n    BasicFormulas.prototype.parseDouble = function (value) {\n        var val = this.parent.parseFloat(value.toString());\n        return !isNaN(val) ? val : NaN;\n    };\n    ;\n    BasicFormulas.prototype.getModuleName = function () {\n        return 'basic-formulas';\n    };\n    return BasicFormulas;\n}());\nexport { BasicFormulas };\n","import { FormulaError } from './index';\nimport { CommonErrors, FormulasErrorsStrings } from '../common/index';\nimport { isNullOrUndefined } from '@syncfusion/ej2-base';\nvar Parser = /** @class */ (function () {\n    function Parser(parent) {\n        this.emptyStr = '';\n        this.storedStringText = this.emptyStr;\n        this.sheetToken = '!';\n        /** @hidden */\n        this.tokenAdd = 'a';\n        /** @hidden */\n        this.tokenSubtract = 's';\n        /** @hidden */\n        this.tokenMultiply = 'm';\n        /** @hidden */\n        this.tokenDivide = 'd';\n        /** @hidden */\n        this.tokenLess = 'l';\n        this.charEm = 'r';\n        this.charEp = 'x';\n        /** @hidden */\n        this.tokenGreater = 'g';\n        /** @hidden */\n        this.tokenEqual = 'e';\n        /** @hidden */\n        this.tokenLessEq = 'k';\n        /** @hidden */\n        this.tokenGreaterEq = 'j';\n        /** @hidden */\n        this.tokenNotEqual = 'o';\n        /** @hidden */\n        this.tokenAnd = 'c';\n        this.tokenEm = 'v';\n        this.tokenEp = 't';\n        /** @hidden */\n        this.tokenOr = String.fromCharCode(126);\n        this.charAnd = 'i';\n        this.charLess = '<';\n        this.charGreater = '>';\n        this.charEqual = '=';\n        this.charLessEq = 'f';\n        this.charGreaterEq = 'h';\n        this.charNoEqual = 'z';\n        this.stringGreaterEq = '>=';\n        this.stringLessEq = '<=';\n        this.stringNoEqual = '<>';\n        this.stringAnd = '&';\n        this.stringOr = '^';\n        this.charOr = 'w';\n        this.charAdd = '+';\n        this.charSubtract = '-';\n        this.charMultiply = '*';\n        this.charDivide = '/';\n        this.fixedReference = '$';\n        this.spaceString = ' ';\n        this.ignoreBracet = false;\n        /** @hidden */\n        this.isError = false;\n        /** @hidden */\n        this.isFormulaParsed = false;\n        this.findNamedRange = false;\n        this.stringsColl = new Map();\n        this.tokens = [\n            this.tokenAdd, this.tokenSubtract, this.tokenMultiply, this.tokenDivide, this.tokenLess,\n            this.tokenGreater, this.tokenEqual, this.tokenLessEq, this.tokenGreaterEq, this.tokenNotEqual, this.tokenAnd, this.tokenOr\n        ];\n        this.charNOTop = String.fromCharCode(167);\n        this.specialSym = ['~', '@', '#', '?'];\n        this.isFailureTriggered = false;\n        this.parent = parent;\n    }\n    /** @hidden */\n    Parser.prototype.parse = function (text, fkey) {\n        if (this.parent.isTextEmpty(text)) {\n            return text;\n        }\n        if (this.parent.getFormulaCharacter() !== String.fromCharCode(0) && this.parent.getFormulaCharacter() === text[0]) {\n            text = text.substring(1);\n        }\n        if (this.parent.namedRanges.size > 0 || this.parent.storedData.size > 0) {\n            text = this.checkForNamedRangeAndKeyValue(text);\n            this.findNamedRange = false;\n        }\n        text = text.split('-+').join('-');\n        text = text.split('--').join('+');\n        text = text.split('+-').join('-');\n        text = text.split('-' + '(' + '-').join('(');\n        var formulaString = this.storeStrings(text);\n        text = this.storedStringText;\n        var i = 0;\n        if (isNullOrUndefined(formulaString)) {\n            text = text.split(' ').join('');\n        }\n        text = text.split('=>').join('>=');\n        text = text.split('=<').join('<=');\n        if (text[text.length - 1] !== this.parent.arithMarker || this.indexOfAny(text, this.tokens) !== (text.length - 2)) {\n            text = text.toUpperCase();\n        }\n        if (text.indexOf(this.sheetToken) > -1) {\n            var family = this.parent.getSheetFamilyItem(this.parent.grid);\n            if (family.sheetNameToParentObject != null && family.sheetNameToParentObject.size > 0) {\n                if (text[0] !== this.sheetToken.toString()) {\n                    text = this.parent.setTokensForSheets(text);\n                }\n                var sheetToken = this.parent.getSheetToken(text.split(this.parent.tic).join(this.emptyStr));\n                var scopedRange = this.checkScopedRange(text.split('\"').join(this.emptyStr).split(this.sheetToken).join(''));\n                if (isNullOrUndefined(sheetToken) && sheetToken !== '' && this.parent.namedRanges.size > 0 && scopedRange !== '') {\n                    text = scopedRange;\n                }\n            }\n        }\n        text = this.markLibraryFormulas(text);\n        try {\n            text = this.formulaAutoCorrection(text);\n        }\n        catch (ex) {\n            var args = {\n                message: ex.message, exception: ex, isForceCalculable: ex.formulaCorrection,\n                computeForceCalculate: false\n            };\n            if (!args.isForceCalculable) {\n                throw this.parent.formulaErrorStrings[FormulasErrorsStrings.invalid_expression];\n            }\n            if (!this.isFailureTriggered) {\n                this.parent.trigger('onFailure', args);\n                this.isFailureTriggered = true;\n            }\n            if (args.isForceCalculable && args.computeForceCalculate) {\n                text = this.formulaAutoCorrection(text, args);\n                this.parent.storedData.get(fkey).formulaText = '=' + text;\n            }\n            else {\n                throw this.parent.formulaErrorStrings[FormulasErrorsStrings.invalid_expression];\n            }\n        }\n        if (!this.ignoreBracet) {\n            i = text.indexOf(')');\n            while (i > -1) {\n                var k = text.substring(0, i).lastIndexOf('(');\n                if (k === -1) {\n                    throw new FormulaError(this.parent.formulaErrorStrings[FormulasErrorsStrings.mismatched_parentheses]);\n                }\n                if (k === i - 1) {\n                    throw new FormulaError(this.parent.formulaErrorStrings[FormulasErrorsStrings.empty_expression]);\n                }\n                var s = this.emptyStr;\n                if (this.ignoreBracet) {\n                    s = this.parent.substring(text, k, i - k + 1);\n                }\n                else {\n                    s = this.parent.substring(text, k + 1, i - k - 1);\n                }\n                try {\n                    text = text.substring(0, k) + this.parseSimple(s) + text.substring(i + 1);\n                }\n                catch (ex) {\n                    var args = this.exceptionArgs(ex);\n                    if (!this.isFailureTriggered) {\n                        this.parent.trigger('onFailure', args);\n                        this.isFailureTriggered = true;\n                    }\n                    var errorMessage = (typeof args.exception === 'string') ? args.exception : args.message;\n                    return (this.parent.getErrorLine(ex) ? '' : '#' + this.parent.getErrorLine(ex) + ': ') + errorMessage;\n                }\n                i = text.indexOf(')');\n            }\n        }\n        if (!this.ignoreBracet && text.indexOf('(') > -1) {\n            throw new FormulaError(this.parent.formulaErrorStrings[FormulasErrorsStrings.mismatched_parentheses]);\n        }\n        text = this.parseSimple(text);\n        if (formulaString !== null && formulaString.size > 0) {\n            text = this.setStrings(text, formulaString);\n        }\n        return text;\n    };\n    /* tslint:disable-next-line:no-any */\n    Parser.prototype.exceptionArgs = function (ex) {\n        return {\n            message: ex.message, exception: ex, isForceCalculable: ex.formulaCorrection,\n            computeForceCalculate: false\n        };\n    };\n    Parser.prototype.formulaAutoCorrection = function (formula, args) {\n        var arithemeticArr = ['*', '+', '-', '/', '^', '&'];\n        var logicalSym = ['>', '=', '<'];\n        var i = 0;\n        var form = '';\n        var op = '';\n        var firstOp = '';\n        var secondprevOp = '';\n        var secondnextOp = '';\n        var firstDigit = '';\n        var secondDigit = '';\n        var countDigit = 0;\n        if (this.parent.formulaErrorStrings.indexOf(formula) > -1) {\n            return formula;\n        }\n        else {\n            if (this.indexOfAny(formula, this.specialSym) > -1) {\n                throw new FormulaError(this.parent.formulaErrorStrings[FormulasErrorsStrings.invalid_expression], false);\n            }\n            while (i < formula.length) {\n                formula = formula.split('-*').join('-').split('/*').join('/').split('*/').join('*').split('-/').join('-').\n                    split('*+').join('*').split('+*').join('+');\n                if (formula.indexOf('*-') > -1 || formula.indexOf('/-') > -1) {\n                    formula = '-' + formula.split('*-').join('*').split('/-').join('/');\n                }\n                if ((this.parent.isDigit(formula[i]) && ((formula.length > i + 1)\n                    && (this.indexOfAny(formula[i + 1], arithemeticArr) > -1)) && ((formula.length > i + 2)\n                    && (!isNullOrUndefined(formula[i + 2]) && this.indexOfAny(formula[i + 2], arithemeticArr) > -1)))) {\n                    if (isNullOrUndefined(args)) {\n                        throw new FormulaError(this.parent.formulaErrorStrings[FormulasErrorsStrings.invalid_expression], true);\n                    }\n                    if (args.computeForceCalculate) {\n                        if (this.parent.isDigit(formula[i])) {\n                            if (countDigit < 1) {\n                                firstDigit = formula[i];\n                                firstOp = formula[i + 1];\n                                if (isNullOrUndefined(firstOp)) {\n                                    firstOp = this.emptyStr;\n                                }\n                                firstOp = firstOp === '&' ? '' : firstOp;\n                                countDigit = countDigit + 1;\n                                form = form + firstDigit + firstOp;\n                            }\n                            else if (countDigit < 2) {\n                                secondDigit = formula[i];\n                                secondprevOp = formula[i - 1];\n                                secondnextOp = formula[i + 1];\n                                countDigit = 0;\n                                if (secondprevOp === '-') {\n                                    secondnextOp = isNullOrUndefined(secondnextOp) ? this.emptyStr : secondnextOp;\n                                    secondnextOp = secondnextOp === '&' ? '' : secondnextOp;\n                                    form = form + secondprevOp + secondDigit + secondnextOp;\n                                }\n                                else {\n                                    secondnextOp = isNullOrUndefined(secondnextOp) ? this.emptyStr : secondnextOp;\n                                    form = form + secondDigit + secondnextOp;\n                                }\n                            }\n                            i = i + 2;\n                        }\n                        else {\n                            form = (formula[i] === '-') ? form + formula[i] : form;\n                            i = i + 1;\n                        }\n                    }\n                    else {\n                        throw this.parent.formulaErrorStrings[FormulasErrorsStrings.improper_formula];\n                    }\n                    /* tslint:disable-next-line */\n                }\n                else if ((this.parent.isDigit(formula[i]) || formula[i] === this.parent.rightBracket || this.parent.storedData.has(formula[i].toUpperCase())) && (isNullOrUndefined(formula[i + 1]) || this.indexOfAny(formula[i + 1], arithemeticArr)) > -1) {\n                    op = isNullOrUndefined(formula[i + 1]) ? this.emptyStr : formula[i + 1];\n                    op = op === '&' ? '' : op;\n                    form = formula[i - 1] === '-' ? form + formula[i - 1] + formula[i] + op : form + formula[i] + op;\n                    i = i + 2;\n                    /* tslint:disable-next-line */\n                }\n                else if (this.indexOfAny(formula[i], logicalSym) > -1 && !isNullOrUndefined(formula[i - 1]) && !isNullOrUndefined(formula[i + 1])) {\n                    form = form + formula[i];\n                    i = i + 1;\n                }\n                else if (formula[i] === 'q') {\n                    while (formula[i] !== this.parent.leftBracket) {\n                        form = form + formula[i];\n                        i = i + 1;\n                    }\n                    /* tslint:disable-next-line */\n                }\n                else if (formula[i] === this.parent.leftBracket || formula[i] === this.parent.rightBracket || formula[i] === '{' || formula[i] === '}' || formula[i] === '(' || formula[i] === ')') {\n                    form = form + formula[i];\n                    i = i + 1;\n                    /* tslint:disable-next-line */\n                }\n                else if (this.parent.isUpperChar(formula[i]) || formula[i].indexOf(':') > -1 || formula[i] === this.parent.getParseArgumentSeparator() || ((formula[i] === '%') && (this.parent.isDigit(formula[i - 1])))) {\n                    form = form + formula[i];\n                    i = i + 1;\n                }\n                else if (formula[i] === this.parent.tic || formula[i] === ' ' || formula[i] === '.' || formula[i] === this.sheetToken ||\n                    formula[i] === '$') {\n                    form = form + formula[i];\n                    i = i + 1;\n                }\n                else {\n                    if (this.parent.isDigit(formula[i])) {\n                        form = formula[i - 1] === '-' ? form + formula[i - 1] + formula[i] : form + formula[i];\n                    }\n                    if (formula[i] === '-' || formula[i] === '+') {\n                        form = form + formula[i];\n                        form = form.split('++').join('+').split('+-').join('-').split('-+').join('-');\n                    }\n                    if (formula[i] === '/' || formula[i] === '*') {\n                        form = form + formula[i];\n                    }\n                    i = i + 1;\n                }\n            }\n        }\n        form = form === this.emptyStr ? formula : form;\n        if (this.indexOfAny(form[form.length - 1], arithemeticArr) > -1) {\n            form = form.substring(0, form.length - 1);\n        }\n        form = form.split('--').join('-').split('-+').join('-').split('+-').join('-');\n        return form;\n    };\n    Parser.prototype.checkScopedRange = function (text) {\n        var _this = this;\n        var scopedRange = this.emptyStr;\n        var b = 'NaN';\n        var id = this.parent.getSheetID(this.parent.grid);\n        var sheet = this.parent.getSheetFamilyItem(this.parent.grid);\n        if (text[0] === this.sheetToken.toString()) {\n            var i = text.indexOf(this.sheetToken, 1);\n            var v = parseInt(text.substr(1, i - 1), 10);\n            if (i > 1 && !this.parent.isNaN(v)) {\n                text = text.substring(i + 1);\n                id = v;\n            }\n        }\n        var token = '!' + id.toString() + '!';\n        if (sheet === null || sheet.sheetNameToToken == null) {\n            return b;\n        }\n        sheet.sheetNameToToken.forEach(function (value, key) {\n            if (sheet.sheetNameToToken.get(key).toString() === token) {\n                var s_1 = _this.emptyStr;\n                _this.parent.namedRanges.forEach(function (value, key) {\n                    /* tslint:disable-next-line:no-any */\n                    if (!isNullOrUndefined(_this.parent.parentObject)) {\n                        /* tslint:disable-next-line:no-any */\n                        s_1 = (_this.parent.parentObject.getActiveSheet().name + _this.sheetToken + text).toUpperCase();\n                    }\n                    else {\n                        s_1 = sheet.sheetNameToToken.get(key).toUpperCase();\n                    }\n                    if (_this.parent.getNamedRanges().has(s_1)) {\n                        scopedRange = (_this.parent.getNamedRanges().get(s_1)).toUpperCase();\n                        b = scopedRange;\n                    }\n                });\n            }\n        });\n        return b;\n    };\n    Parser.prototype.storeStrings = function (tempString) {\n        var i = 0;\n        var j = 0;\n        var id = 0;\n        var key = '';\n        var storedString = null;\n        var condition;\n        var ticLoc = tempString.indexOf(this.parent.tic);\n        if (ticLoc > -1) {\n            i = tempString.indexOf(this.parent.tic);\n            while (i > -1 && tempString.length > 0) {\n                if (storedString === null) {\n                    storedString = this.stringsColl;\n                }\n                j = i + 1 < tempString.length ? tempString.indexOf(this.parent.tic, i + 1) : -1;\n                if (j === -1) {\n                    throw new FormulaError(this.parent.formulaErrorStrings[FormulasErrorsStrings.mismatched_tics]);\n                }\n                condition = this.parent.substring(tempString, i, j - i + 1);\n                key = this.parent.tic + this.spaceString + id.toString() + this.parent.tic;\n                storedString = storedString.set(key, condition);\n                tempString = tempString.substring(0, i) + key + tempString.substring(j + 1);\n                i = i + key.length;\n                if (i < tempString.length) {\n                    i = tempString.indexOf(this.parent.tic, i);\n                }\n                id++;\n            }\n        }\n        this.storedStringText = tempString;\n        return storedString;\n    };\n    Parser.prototype.setStrings = function (text, formulaString) {\n        for (var i = 0; i < formulaString.size; i++) {\n            formulaString.forEach(function (value, key) {\n                text = text.split(key).join(value);\n            });\n        }\n        return text;\n    };\n    /** @hidden */\n    Parser.prototype.parseSimple = function (formulaText) {\n        var needToContinue = true;\n        var text = formulaText;\n        if (text.length > 0 && text[0] === '+') {\n            text = text.substring(1);\n        }\n        if (text === '#DIV/0!') {\n            return '#DIV/0!';\n        }\n        if (text === '#NAME?') {\n            return '#NAME?';\n        }\n        if (text === '') {\n            return text;\n        }\n        if (this.parent.formulaErrorStrings.indexOf(text) > -1) {\n            return text;\n        }\n        text = text.split(this.stringLessEq).join(this.charLessEq);\n        text = text.split(this.stringGreaterEq).join(this.charGreaterEq);\n        text = text.split(this.stringNoEqual).join(this.charNoEqual);\n        text = text.split(this.stringAnd).join(this.charAnd);\n        text = text.split(this.stringOr).join(this.charOr);\n        text = text.split(this.fixedReference).join(this.emptyStr);\n        needToContinue = true;\n        var expTokenArray = [this.tokenEp, this.tokenEm];\n        var mulTokenArray = [this.tokenMultiply, this.tokenDivide];\n        var addTokenArray = [this.tokenAdd, this.tokenSubtract];\n        var mulCharArray = [this.charMultiply, this.charDivide];\n        var addCharArray = [this.charAdd, this.charSubtract];\n        var compareTokenArray = [this.tokenLess, this.tokenGreater, this.tokenEqual, this.tokenLessEq,\n            this.tokenGreaterEq, this.tokenNotEqual];\n        var compareCharArray = [this.charLess, this.charGreater, this.charEqual, this.charLessEq,\n            this.charGreaterEq, this.charNoEqual];\n        var expCharArray = [this.charEp, this.charEm];\n        var andTokenArray = [this.tokenAnd];\n        var andCharArray = [this.charAnd];\n        var orCharArray = [this.charOr];\n        var orTokenArray = [this.tokenOr];\n        text = this.parseSimpleOperators(text, expTokenArray, expCharArray);\n        text = this.parseSimpleOperators(text, orTokenArray, orCharArray);\n        if (needToContinue) {\n            text = this.parseSimpleOperators(text, mulTokenArray, mulCharArray);\n        }\n        if (needToContinue) {\n            text = this.parseSimpleOperators(text, addTokenArray, addCharArray);\n        }\n        if (needToContinue) {\n            text = this.parseSimpleOperators(text, compareTokenArray, compareCharArray);\n        }\n        if (needToContinue) {\n            text = this.parseSimpleOperators(text, andTokenArray, andCharArray);\n        }\n        return text;\n    };\n    /** @hidden */\n    // tslint:disable-next-line:max-func-body-length\n    Parser.prototype.parseSimpleOperators = function (formulaText, markers, operators) {\n        if (this.parent.getErrorStrings().indexOf(formulaText) > -1) {\n            return formulaText;\n        }\n        var text = formulaText;\n        var i = 0;\n        var op = '';\n        for (var c = 0; c < operators.length; c++) {\n            op = op + operators[c];\n        }\n        /* tslint:disable */\n        text = text.split(\"---\").join(\"-\").split(\"--\").join(\"+\").split(this.parent.getParseArgumentSeparator() + \"-\").join(this.parent.getParseArgumentSeparator() + \"u\").split(this.parent.leftBracket + \"-\").join(this.parent.leftBracket + \"u\").split(\"=-\").join(\"=u\");\n        text = text.split(',+').join(',').split(this.parent.leftBracket + '+').join(this.parent.leftBracket).split('=+').join('=').split('>+').join('>').split('<+').join('<').split('/+').join('/').split('*+').join('*').split('++').join('+').split(\"*-\").join(\"*u\").toString();\n        ;\n        /* tslint:enable */\n        if (text.length > 0 && text[0] === '-') {\n            text = text.substring(1).split('-').join(this.tokenOr);\n            text = '0-' + text;\n            text = this.parseSimpleOperators(text, [this.tokenSubtract], [this.charSubtract]);\n            text = text.split(this.tokenOr).join('-');\n        }\n        else if (text.length > 0 && text[0] === '+') {\n            text = text.substring(1);\n        }\n        else if (text.length > 0 && text[text.length - 1] === '+') {\n            text = text.substring(0, text.length - 1);\n        }\n        try {\n            if (this.indexOfAny(text, operators) > -1) {\n                i = this.indexOfAny(text, operators);\n                while (i > -1) {\n                    var left = '';\n                    var right = '';\n                    var leftIndex = 0;\n                    var rightIndex = 0;\n                    var isNotOperator = text[i] === this.charNOTop;\n                    var j = 0;\n                    if (!isNotOperator) {\n                        j = i - 1;\n                        if (text[j] === this.parent.arithMarker) {\n                            var k = this.findLeftMarker(text.substring(0, j - 1));\n                            if (k < 0) {\n                                throw new FormulaError(this.parent.formulaErrorStrings[FormulasErrorsStrings.cannot_parse]);\n                            }\n                            left = this.parent.substring(text, k + 1, j - k - 1);\n                            leftIndex = k + 1;\n                        }\n                        else if (text[j] === this.parent.rightBracket) {\n                            var bracketCount = 0;\n                            var k = j - 1;\n                            while (k > 0 && (text[k] !== 'q' || bracketCount !== 0)) {\n                                if (text[k] === 'q') {\n                                    bracketCount--;\n                                }\n                                else if (text[k] === this.parent.rightBracket) {\n                                    bracketCount++;\n                                }\n                                k--;\n                            }\n                            if (k < 0) {\n                                throw new FormulaError(this.parent.formulaErrorStrings[FormulasErrorsStrings.cannot_parse]);\n                            }\n                            left = this.parent.substring(text, k, j - k + 1);\n                            leftIndex = k;\n                        }\n                        else if (text[j] === this.parent.tic[0]) {\n                            var l = text.substring(0, j - 1).lastIndexOf(this.parent.tic);\n                            if (l < 0) {\n                                throw new FormulaError(this.parent.formulaErrorStrings[FormulasErrorsStrings.cannot_parse]);\n                            }\n                            left = this.parent.substring(text, l, j - l + 1);\n                            leftIndex = l;\n                        }\n                        else {\n                            var period = false;\n                            while (j > -1 && (this.parent.isDigit(text[j]) ||\n                                (!period && text[j] === this.parent.getParseDecimalSeparator()))) {\n                                if (text[j] === this.parent.getParseDecimalSeparator()) {\n                                    period = true;\n                                }\n                                j = j - 1;\n                            }\n                            if (j > -1 && period && text[j] === this.parent.getParseDecimalSeparator()) {\n                                /* tslint:disable-next-line */\n                                throw new FormulaError(this.parent.formulaErrorStrings[FormulasErrorsStrings.number_contains_2_decimal_points]);\n                            }\n                            j = j + 1;\n                            if (j === 0 || (j > 0 && !this.parent.isUpperChar(text[j - 1]))) {\n                                left = 'n' + this.parent.substring(text, j, i - j);\n                                leftIndex = j;\n                            }\n                            else {\n                                j = j - 1;\n                                while (j > -1 && (this.parent.isUpperChar(text[j]) || this.parent.isDigit(text[j]))) {\n                                    j = j - 1;\n                                }\n                                if (j > -1 && text[j] === this.sheetToken) {\n                                    j = j - 1;\n                                    while (j > -1 && text[j] !== this.sheetToken) {\n                                        j = j - 1;\n                                    }\n                                    if (j > -1 && text[j] === this.sheetToken) {\n                                        j = j - 1;\n                                    }\n                                }\n                                if (j > -1 && text[j] === ':') {\n                                    //// handle range operands\n                                    j = j - 1;\n                                    while (j > -1 && this.parent.isDigit(text[j])) {\n                                        j = j - 1;\n                                    }\n                                    while (j > -1 && this.parent.isUpperChar(text[j])) {\n                                        j = j - 1;\n                                    }\n                                    if (j > -1 && text[j] === this.sheetToken) {\n                                        j--;\n                                        while (j > -1 && text[j] !== this.sheetToken) {\n                                            j--;\n                                        }\n                                        if (j > -1 && text[j] === this.sheetToken) {\n                                            j--;\n                                        }\n                                    }\n                                    j = j + 1;\n                                    left = this.parent.substring(text, j, i - j);\n                                    left = this.parent.getCellFrom(left);\n                                }\n                                else {\n                                    j = j + 1;\n                                    left = this.parent.substring(text, j, i - j);\n                                }\n                                this.parent.updateDependentCell(left);\n                                leftIndex = j;\n                            }\n                            if ((this.parent.namedRanges.size > 0 && this.parent.namedRanges.has(left.toUpperCase())) ||\n                                (this.parent.storedData.has(left.toUpperCase()))) {\n                                left = 'n' + this.checkForNamedRangeAndKeyValue(left);\n                            }\n                        }\n                    }\n                    else {\n                        leftIndex = i;\n                    }\n                    if (i === text.length - 1) {\n                        /* tslint:disable-next-line */\n                        throw new FormulaError(this.parent.formulaErrorStrings[FormulasErrorsStrings.expression_cannot_end_with_an_operator]);\n                    }\n                    else {\n                        j = i + 1;\n                        var uFound = text[j] === 'u'; // for 3*-2\n                        if (uFound) {\n                            j = j + 1;\n                        }\n                        if (text[j] === this.parent.tic[0]) {\n                            var k = text.substring(j + 1).indexOf(this.parent.tic);\n                            if (k < 0) {\n                                throw this.parent.formulaErrorStrings[FormulasErrorsStrings.cannot_parse];\n                            }\n                            right = this.parent.substring(text, j, k + 2);\n                            rightIndex = k + j + 2;\n                        }\n                        else if (text[j] === this.parent.arithMarker) {\n                            var k = this.findRightMarker(text.substring(j + 1));\n                            if (k < 0) {\n                                throw new FormulaError(this.parent.formulaErrorStrings[FormulasErrorsStrings.cannot_parse]);\n                            }\n                            right = this.parent.substring(text, j + 1, k);\n                            rightIndex = k + j + 2;\n                        }\n                        else if (text[j] === 'q') {\n                            var bracketCount = 0;\n                            var k = j + 1;\n                            while (k < text.length && (text[k] !== this.parent.rightBracket || bracketCount !== 0)) {\n                                if (text[k] === this.parent.rightBracket) {\n                                    bracketCount++;\n                                }\n                                else if (text[k] === 'q') {\n                                    bracketCount--;\n                                }\n                                k++;\n                            }\n                            if (k === text.length) {\n                                throw this.parent.formulaErrorStrings[FormulasErrorsStrings.cannot_parse];\n                            }\n                            right = this.parent.substring(text, j, k - j + 1);\n                            if (uFound) {\n                                right = 'u' + right;\n                            }\n                            rightIndex = k + 1;\n                            /* tslint:disable-next-line */\n                        }\n                        else if (this.parent.isDigit(text[j]) || text[j] === this.parent.getParseDecimalSeparator()) {\n                            var period = (text[j] === this.parent.getParseDecimalSeparator());\n                            j = j + 1;\n                            /* tslint:disable-next-line */\n                            while (j < text.length && (this.parent.isDigit(text[j]) || (!period && text[j] === this.parent.getParseDecimalSeparator()))) {\n                                if (text[j] === this.parent.getParseDecimalSeparator()) {\n                                    period = true;\n                                }\n                                j = j + 1;\n                            }\n                            if (j < text.length && text[j] === '%') {\n                                j += 1;\n                            }\n                            if (period && j < text.length && text[j] === this.parent.getParseDecimalSeparator()) {\n                                throw this.parent.formulaErrorStrings[FormulasErrorsStrings.number_contains_2_decimal_points];\n                            }\n                            right = 'n' + this.parent.substring(text, i + 1, j - i - 1);\n                            rightIndex = j;\n                        }\n                        else if (this.parent.isUpperChar(text[j]) || text[j] === this.sheetToken || text[j] === 'u') {\n                            if (text[j] === this.sheetToken) {\n                                j = j + 1;\n                                while (j < text.length && text[j] !== this.sheetToken) {\n                                    j = j + 1;\n                                }\n                            }\n                            j = j + 1;\n                            var jTemp = 0;\n                            var inbracket = false;\n                            while (j < text.length && (this.parent.isUpperChar(text[j]) || text[j] === '_'\n                                || text[j] === '.' || text[j] === '[' || text[j] === ']' || text[j] === '#' || text[j] === ' '\n                                || text[j] === '%' || text[j] === this.parent.getParseDecimalSeparator() && inbracket)) {\n                                if (j !== text.length - 1 && text[j] === '[' && text[j + 1] === '[') {\n                                    inbracket = true;\n                                }\n                                if (j !== text.length - 1 && text[j] === ']' && text[j + 1] === ']') {\n                                    inbracket = false;\n                                }\n                                j++;\n                                jTemp++;\n                            }\n                            var noCellReference = (j === text.length) || !this.parent.isDigit(text[j]);\n                            if (jTemp > 1) {\n                                while (j < text.length && (this.parent.isUpperChar(text[j]) || this.parent.isDigit(text[j])\n                                    || text[j] === ' ' || text[j] === '_')) {\n                                    j++;\n                                }\n                                noCellReference = true;\n                            }\n                            while (j < text.length && this.parent.isDigit(text[j])) {\n                                j = j + 1;\n                            }\n                            if (j < text.length && text[j] === ':') {\n                                j = j + 1;\n                                if (j < text.length && text[j] === this.sheetToken) {\n                                    j++;\n                                    while (j < text.length && text[j] !== this.sheetToken) {\n                                        j = j + 1;\n                                    }\n                                    if (j < text.length && text[j] === this.sheetToken) {\n                                        j++;\n                                    }\n                                }\n                                while (j < text.length && this.parent.isUpperChar(text[j])) {\n                                    j = j + 1;\n                                }\n                                while (j < text.length && this.parent.isDigit(text[j])) {\n                                    j = j + 1;\n                                }\n                                j = j - 1;\n                                right = this.parent.substring(text, i + 1, j - i);\n                                right = this.parent.getCellFrom(right);\n                            }\n                            else {\n                                j = j - 1;\n                                right = this.parent.substring(text, i + 1, j - i);\n                                uFound = text[j] === 'u';\n                                if (uFound) {\n                                    right = 'u' + right;\n                                }\n                            }\n                            if (noCellReference && right.startsWith(this.sheetToken)) {\n                                noCellReference = !this.parent.isCellReference(right);\n                            }\n                            if (!noCellReference) {\n                                this.parent.updateDependentCell(right);\n                            }\n                            if ((this.parent.namedRanges.size > 0 && this.parent.namedRanges.has(right.toUpperCase()))\n                                || (this.parent.storedData.has(right.toUpperCase()))) {\n                                right = 'n' + this.checkForNamedRangeAndKeyValue(right);\n                            }\n                            rightIndex = j + 1;\n                        }\n                    }\n                    var p = op.indexOf(text[i]);\n                    var s = this.parent.arithMarker + left + right + markers[p] + this.parent.arithMarker;\n                    if (leftIndex > 0) {\n                        s = text.substring(0, leftIndex) + s;\n                    }\n                    if (rightIndex < text.length) {\n                        s = s + text.substring(rightIndex);\n                    }\n                    s = s.split(this.parent.arithMarker2).join(this.parent.arithMarker.toString());\n                    text = s;\n                    i = this.indexOfAny(text, operators);\n                }\n            }\n            else {\n                if (text.length > 0 && (this.parent.isUpperChar(text[0]) || text[0] === this.sheetToken)) {\n                    var isCharacter = true;\n                    var checkLetter = true;\n                    var oneTokenFound = false;\n                    var textLen = text.length;\n                    for (var k = 0; k < textLen; ++k) {\n                        if (text[k] === this.sheetToken) {\n                            if (k > 0 && !oneTokenFound) {\n                                throw this.parent.getErrorStrings()[CommonErrors.ref];\n                            }\n                            oneTokenFound = true;\n                            k++;\n                            while (k < textLen && this.parent.isDigit(text[k])) {\n                                k++;\n                            }\n                            if (k === textLen || text[k] !== this.sheetToken) {\n                                isCharacter = false;\n                                break;\n                            }\n                        }\n                        else {\n                            if (!checkLetter && this.parent.isChar(text[k])) {\n                                isCharacter = false;\n                                break;\n                            }\n                            if (this.parent.isChar(text[k]) || this.parent.isDigit(text[k]) || text[k] === this.sheetToken) {\n                                checkLetter = this.parent.isUpperChar(text[k]);\n                            }\n                            else {\n                                isCharacter = false;\n                                break;\n                            }\n                        }\n                    }\n                    if (isCharacter) {\n                        this.parent.updateDependentCell(text);\n                    }\n                }\n            }\n            return text;\n        }\n        catch (ex) {\n            return ex;\n        }\n    };\n    /** @hidden */\n    Parser.prototype.indexOfAny = function (text, operators) {\n        for (var i = 0; i < text.length; i++) {\n            if (operators.indexOf(text[i]) > -1) {\n                return i;\n            }\n        }\n        return -1;\n    };\n    /** @hidden */\n    Parser.prototype.findLeftMarker = function (text) {\n        var ret = -1;\n        if (text.indexOf(this.parent.arithMarker) > -1) {\n            var bracketLevel = 0;\n            for (var i = text.length - 1; i >= 0; --i) {\n                if (text[i] === this.parent.rightBracket) {\n                    bracketLevel--;\n                }\n                else if (text[i] === this.parent.leftBracket) {\n                    bracketLevel++;\n                }\n                else if (text[i] === this.parent.arithMarker && bracketLevel === 0) {\n                    ret = i;\n                    break;\n                }\n            }\n        }\n        return ret;\n    };\n    /** @hidden */\n    Parser.prototype.findRightMarker = function (text) {\n        var ret = -1;\n        if (text.indexOf(this.parent.arithMarker) > -1) {\n            var bracketLevel = 0;\n            for (var j = 0; j < text.length; ++j) {\n                if (text[j] === this.parent.rightBracket) {\n                    bracketLevel--;\n                }\n                else if (text[j] === this.parent.leftBracket) {\n                    bracketLevel++;\n                }\n                else if (text[j] === this.parent.arithMarker && bracketLevel === 0) {\n                    ret = j;\n                    break;\n                }\n            }\n        }\n        return ret;\n    };\n    /** @hidden */\n    Parser.prototype.parseFormula = function (formula, fKey) {\n        if (formula.length > 0 && formula[0] === this.parent.getFormulaCharacter()) {\n            formula = formula.substring(1);\n        }\n        if (formula.indexOf('#REF!') > -1) {\n            return this.parent.getErrorStrings()[CommonErrors.ref];\n        }\n        if (formula.length > 0 && formula[0] === '+') {\n            formula = formula.substring(1);\n        }\n        try {\n            this.isFailureTriggered = false;\n            this.isError = false;\n            formula = this.parse(formula.trim(), fKey);\n            this.isFormulaParsed = true;\n        }\n        catch (ex) {\n            var args = this.exceptionArgs(ex);\n            if (!this.isFailureTriggered) {\n                this.parent.trigger('onFailure', args);\n                this.isFailureTriggered = true;\n            }\n            var errorMessage = (typeof args.exception === 'string') ? args.exception : args.message;\n            formula = (isNullOrUndefined(this.parent.getErrorLine(ex)) ? '' : '#' + this.parent.getErrorLine(ex) + ': ') + errorMessage;\n            this.isError = true;\n        }\n        return formula;\n    };\n    /** @hidden */\n    Parser.prototype.markLibraryFormulas = function (formula) {\n        var bracCount = 0;\n        var rightParens = formula.indexOf(')');\n        if (rightParens === -1) {\n            formula = this.markNamedRanges(formula);\n        }\n        else {\n            while (rightParens > -1) {\n                var parenCount = 0;\n                var leftParens = rightParens - 1;\n                while (leftParens > -1 && (formula[leftParens] !== '(' || parenCount !== 0)) {\n                    if (formula[leftParens] === ')') {\n                        parenCount++;\n                    }\n                    else if (formula[leftParens] === ')') {\n                        parenCount--;\n                    }\n                    leftParens--;\n                }\n                if (leftParens === -1) {\n                    throw new FormulaError(this.parent.formulaErrorStrings[FormulasErrorsStrings.mismatched_parentheses]);\n                }\n                var i = leftParens - 1;\n                while (i > -1 && (this.parent.isChar(formula[i]))) {\n                    i--;\n                }\n                var len = leftParens - i - 1;\n                var libFormula = this.parent.substring(formula, i + 1, len);\n                if (len > 0 && !isNullOrUndefined(this.parent.getFunction(libFormula))) {\n                    if (this.parent.substring(formula, i + 1, len) === 'AREAS') {\n                        this.ignoreBracet = true;\n                    }\n                    else {\n                        this.ignoreBracet = false;\n                    }\n                    var substr = this.parent.substring(formula, leftParens, rightParens - leftParens + 1);\n                    try {\n                        var args = void 0;\n                        substr = substr.split('(').join('').split(')').join('');\n                        substr = '(' + this.formulaAutoCorrection(substr, args) + ')';\n                    }\n                    catch (ex) {\n                        var args = {\n                            message: ex.message, exception: ex,\n                            isForceCalculable: ex.formulaCorrection, computeForceCalculate: false\n                        };\n                        if (!args.isForceCalculable) {\n                            throw this.parent.formulaErrorStrings[FormulasErrorsStrings.improper_formula];\n                        }\n                        if (!this.isFailureTriggered) {\n                            this.parent.trigger('onFailure', args);\n                            this.isFailureTriggered = true;\n                            bracCount = bracCount + 1;\n                        }\n                        args.computeForceCalculate = bracCount > 0 ? true : args.computeForceCalculate;\n                        if (args.isForceCalculable) {\n                            if (args.computeForceCalculate) {\n                                substr = substr.split('(').join('').split(')').join('');\n                                substr = '(' + this.formulaAutoCorrection(substr, args) + ')';\n                            }\n                            else {\n                                throw this.parent.formulaErrorStrings[FormulasErrorsStrings.improper_formula];\n                            }\n                        }\n                        else {\n                            throw this.parent.formulaErrorStrings[FormulasErrorsStrings.improper_formula];\n                        }\n                    }\n                    substr = this.markNamedRanges(substr);\n                    substr = this.swapInnerParens(substr);\n                    substr = this.addParensToArgs(substr);\n                    var id = substr.lastIndexOf(this.parent.getParseArgumentSeparator());\n                    var k = 0;\n                    if (id === -1) {\n                        if (substr.length > 2 && substr[0] === '(' && substr[substr.length - 1] === ')') {\n                            if (substr[1] !== '{' && substr[1] !== '(') {\n                                substr = substr.substring(0, substr.length - 1) + '}' + substr.substring(substr.length - 1);\n                                substr = substr[0] + '{' + substr.substring(1);\n                            }\n                        }\n                    }\n                    formula = formula.substring(0, i + 1) + 'q' + this.parent.substring(formula, i + 1, len) +\n                        (substr.split('(').join(this.parent.leftBracket))\n                            .split(')').join(this.parent.rightBracket) + formula.substring(rightParens + 1);\n                }\n                else if (len > 0) {\n                    return this.parent.getErrorStrings()[CommonErrors.name];\n                }\n                else {\n                    var s = this.emptyStr;\n                    if (leftParens > 0) {\n                        s = formula.substring(0, leftParens);\n                    }\n                    s = s + '{' + this.parent.substring(formula, leftParens + 1, rightParens - leftParens - 1) + '}';\n                    if (rightParens < formula.length) {\n                        s = s + formula.substring(rightParens + 1);\n                    }\n                    s = this.markNamedRanges(s);\n                    formula = s;\n                }\n                rightParens = formula.indexOf(')');\n            }\n        }\n        formula = (formula.split('{').join('(')).split('}').join(')');\n        return formula;\n    };\n    /** @hidden */\n    Parser.prototype.swapInnerParens = function (fSubstr) {\n        if (fSubstr.length > 2) {\n            /* tslint:disable-next-line */\n            fSubstr = fSubstr[0] + fSubstr.substr(1, fSubstr.length - 2).split('(').join('{').split(')').join('}') + fSubstr[fSubstr.length - 1];\n        }\n        return fSubstr;\n    };\n    /** @hidden */\n    Parser.prototype.addParensToArgs = function (fSubstr) {\n        if (fSubstr.length === 0) {\n            return this.emptyStr;\n        }\n        var rightSides = [];\n        rightSides.push(this.parent.getParseArgumentSeparator());\n        rightSides.push(this.parent.rightBracket);\n        var id = fSubstr.lastIndexOf(this.parent.getParseArgumentSeparator());\n        var k = 0;\n        if (id === -1) {\n            if (fSubstr.length > 2 && fSubstr[0] === '(' && fSubstr[fSubstr.length - 1] === ')') {\n                if (fSubstr[1] !== '{' && fSubstr[1] !== '(') {\n                    fSubstr = fSubstr.substring(0, fSubstr.length - 1) + '}' + fSubstr.substring(fSubstr.length - 1);\n                    fSubstr = fSubstr[0] + '{' + fSubstr.substring(1);\n                }\n                else {\n                    var marker = ['+', '-', '*', '/'];\n                    id = this.lastIndexOfAny(fSubstr, marker);\n                    if (k === 0 && fSubstr[fSubstr.length - 1] === ')') {\n                        k = fSubstr.length - 1;\n                    }\n                    if (k > 0) {\n                        if (fSubstr[id + 1] !== '{' && fSubstr[id - 1] === '}') {\n                            fSubstr = fSubstr.substr(0, k) + '}' + fSubstr.substr(k);\n                            fSubstr = fSubstr.substr(0, id + 1) + '{' + fSubstr.substr(id + 1);\n                        }\n                    }\n                }\n            }\n        }\n        else {\n            var oneTimeOnly = true;\n            while (id > -1) {\n                var j = this.indexOfAny(fSubstr.substring(id + 1, fSubstr.length), rightSides);\n                if (j >= 0) {\n                    j = id + j + 1;\n                }\n                else if (j === -1 && fSubstr[fSubstr.length - 1] === ')') {\n                    j = fSubstr.length - 1;\n                }\n                if (j > 0) {\n                    if (fSubstr[id + 1] !== '{' && fSubstr[j - 1] !== '}') {\n                        fSubstr = fSubstr.substr(0, j) + '}' + fSubstr.substr(j);\n                        fSubstr = fSubstr.substr(0, id + 1) + '{' + fSubstr.substr(id + 1);\n                    }\n                }\n                id = fSubstr.substr(0, id).lastIndexOf(this.parent.getParseArgumentSeparator());\n                if (oneTimeOnly && id === -1 && fSubstr[0] === '(') {\n                    id = 0;\n                    oneTimeOnly = false;\n                }\n            }\n        }\n        fSubstr = fSubstr.split('{}').join(this.emptyStr);\n        return fSubstr;\n    };\n    /** @hidden */\n    Parser.prototype.lastIndexOfAny = function (text, operators) {\n        for (var i = text.length - 1; i > -1; i--) {\n            if (operators.indexOf(text[i]) > -1) {\n                return i;\n            }\n        }\n        return -1;\n    };\n    /** @hidden */\n    Parser.prototype.markNamedRanges = function (formula) {\n        var markers = [')', this.parent.getParseArgumentSeparator(), '}', '+', '-', '*', '/', '<', '>', '=', '&'];\n        var i = (formula.length > 0 && (formula[0] === '(' || formula[0] === '{')) ? 1 : 0;\n        if (formula.indexOf('#N/A') > -1) {\n            formula = formula.split('#N/A').join('#N~A');\n        }\n        if (formula.indexOf('#DIV/0!') > -1) {\n            formula = formula.split('#DIV/0!').join('#DIV~0!');\n        }\n        var end = this.indexOfAny(formula.substring(i), markers);\n        while (end > -1 && end + i < formula.length) {\n            var scopedRange = this.emptyStr;\n            var s = null;\n            if ((this.parent.substring(formula, i, end)).indexOf('[') > -1) {\n                s = this.getTableRange(this.parent.substring(formula, i, end));\n            }\n            else if (this.parent.storedData.has(this.parent.substring(formula, i, end))) {\n                s = this.checkForNamedRangeAndKeyValue(this.parent.substring(formula, i, end));\n            }\n            else if (this.parent.namedRanges.has(this.parent.substring(formula, i, end))) {\n                s = this.checkForNamedRangeAndKeyValue(this.parent.substring(formula, i, end));\n            }\n            if (isNullOrUndefined(s)) {\n                scopedRange = this.checkScopedRange(this.parent.substring(formula, i, end));\n                if (scopedRange !== 'NaN') {\n                    this.findNamedRange = true;\n                    s = scopedRange;\n                }\n                else if (this.parent.substring(formula, i, end).startsWith(this.sheetToken.toString())) {\n                    var formulaStr = this.parent.substring(formula, i, end).indexOf(this.sheetToken, 1);\n                    // if (formulaStr > 1) {\n                    //     s = this.parent.namedRanges.get(this.parent.substring\n                    // (formula.substring(i), formulaStr + 1, end - formulaStr - 1));\n                    // }\n                }\n                if (!isNullOrUndefined(s) && this.findNamedRange) {\n                    if (s.indexOf(this.fixedReference) > -1) {\n                        s = s.split(this.fixedReference).join(this.emptyStr);\n                    }\n                }\n            }\n            if (!isNullOrUndefined(s)) {\n                s = s.toUpperCase();\n                s = this.parent.setTokensForSheets(s);\n                s = this.markLibraryFormulas(s);\n            }\n            if (!isNullOrUndefined(s) && s !== this.emptyStr) {\n                formula = formula.substring(0, i) + s + formula.substring(i + end);\n                i += s.length + 1;\n            }\n            else {\n                i += end + 1;\n                while (i < formula.length && !this.parent.isUpperChar(formula[i]) && formula[i] !== this.sheetToken) {\n                    i++;\n                }\n            }\n            end = i;\n            if (i < formula.length - 1 && formula[i] === '{') {\n                i = i + 1;\n            }\n            end = this.indexOfAny(formula.substring(i), markers);\n            while (end === 0 && i < formula.length - 1) {\n                i++;\n                end = this.indexOfAny(formula.substring(i), markers);\n            }\n            if ((end === -1 || formula.substring(i).indexOf('[') > -1) && i < formula.length) {\n                if (formula.substring(i).indexOf('[') > -1) {\n                    s = this.getTableRange(formula.substring(i));\n                }\n                else {\n                    if (this.parent.storedData.has(formula.substring(i))) {\n                        s = this.parent.storedData.size > 0 ? this.checkForNamedRangeAndKeyValue(formula.substring(i)) : s;\n                    }\n                    else {\n                        s = this.parent.namedRanges.size > 0 ? this.checkForNamedRangeAndKeyValue(formula.substring(i)) : s;\n                    }\n                }\n                if (isNullOrUndefined(s)) {\n                    scopedRange = this.checkScopedRange(formula.substring(i));\n                    if (scopedRange !== 'NaN') {\n                        s = scopedRange;\n                    }\n                }\n                if (!isNullOrUndefined(s) && s !== this.emptyStr) {\n                    s = s.toUpperCase();\n                    s = this.parent.setTokensForSheets(s);\n                    s = this.markLibraryFormulas(s);\n                    if (s != null) {\n                        var val = formula.substring(i);\n                        if (val[val.length - 1] === ')') {\n                            formula = formula.substring(0, i) + s + ')';\n                        }\n                        else {\n                            formula = formula.substring(0, i) + s;\n                        }\n                        i += s.toString().length + 1;\n                    }\n                }\n                end = (i < formula.length) ? this.indexOfAny(formula.substring(i), markers) : -1;\n            }\n        }\n        if (formula.indexOf('#N~A') > -1) {\n            formula = formula.split('#N~A').join('#N/A');\n        }\n        if (formula.indexOf('#DIV~0!') > -1) {\n            formula = formula.split('#DIV~0!').join('#DIV/0!');\n        }\n        return formula;\n    };\n    /** @hidden */\n    Parser.prototype.checkForNamedRangeAndKeyValue = function (text) {\n        var scopedRange = this.emptyStr;\n        if (text.indexOf('[') > -1) {\n            var namerangeValue = this.getTableRange(text);\n            if (!isNullOrUndefined(namerangeValue)) {\n                this.findNamedRange = true;\n                text = namerangeValue;\n            }\n        }\n        scopedRange = this.checkScopedRange(text);\n        if (scopedRange !== 'NaN') {\n            this.findNamedRange = true;\n            text = scopedRange;\n        }\n        else {\n            if (text.indexOf(this.sheetToken) > -1) {\n                var sheet = this.parent.getSheetFamilyItem(this.parent.grid);\n                /* tslint:disable-next-line */\n                var value = text.split('\"').join(this.emptyStr);\n                value = value.substr(0, value.indexOf(this.sheetToken));\n                if (sheet.sheetNameToToken.has(value.toUpperCase())) {\n                    /* tslint:disable */\n                    var sheetIndex = parseInt(sheet.sheetNameToToken.get(value.toUpperCase()).split(this.sheetToken).join(this.emptyStr));\n                    // if (!ej.isNullOrUndefined(this.parentObject) && this.parentObject.pluginName == \"ejSpreadsheet\") {\n                    //     var name = text.replace(value, this.parentObject.model.sheets[(sheetIndex + 1)].sheetInfo.text.toUpperCase()).split(\"'\").join(this._string_empty);\n                    //     if (this.getNamedRanges().length > 0 && this.getNamedRanges().contains(name.toUpperCase())) {\n                    //         text = name;\n                    //     }\n                    // }\n                    /* tslint-enable */\n                }\n            }\n            if (this.parent.storedData.size > 0 && this.parent.storedData.has(text)) {\n                text = 'A' + this.parent.colIndex(text);\n            }\n            if (this.parent.namedRanges.size > 0 && this.parent.namedRanges.has(text.toUpperCase())) {\n                /* tslint:disable-next-line:no-any */\n                if (!isNullOrUndefined(this.parent.parentObject)) {\n                    text = this.parse(this.parent.namedRanges.get(text.toUpperCase()));\n                }\n                else {\n                    text = this.parse(this.parent.namedRanges.get(text.toUpperCase()));\n                    text = this.parent.setTokensForSheets(text);\n                    if (text.indexOf(this.fixedReference) > -1) {\n                        text.split(this.fixedReference).join(this.emptyStr);\n                    }\n                    this.findNamedRange = true;\n                }\n            }\n            if (this.findNamedRange) {\n                if (text[0] !== '!' && text[0] !== 'q' && text[0] !== 'bq') {\n                    text = this.parent.setTokensForSheets(text);\n                    if (text.indexOf(this.fixedReference) > -1) {\n                        text = text.split(this.fixedReference).join(this.emptyStr);\n                    }\n                }\n            }\n        }\n        return text;\n    };\n    Parser.prototype.getTableRange = function (text) {\n        text = text.replace(' ', this.emptyStr).toUpperCase();\n        var name = text.replace(']', this.emptyStr).replace('#DATA', this.emptyStr);\n        var tableName = name;\n        if (name.indexOf(this.parent.getParseArgumentSeparator()) > -1) {\n            tableName = name.substring(0, name.indexOf(this.parent.getParseArgumentSeparator())).replace('[', this.emptyStr);\n            name = name.replace('[', this.emptyStr).replace(this.parent.getParseArgumentSeparator(), '_');\n        }\n        var range = this.emptyStr;\n        return name.toUpperCase();\n    };\n    Parser.prototype.findNextEndIndex = function (formula, loc) {\n        var count = 0;\n        var l = loc;\n        var found = false;\n        while (!found && loc < formula.length) {\n            if (formula[l] === '[') {\n                count++;\n            }\n            else if (formula[l] === ']') {\n                count--;\n                if (count === 0) {\n                    found = true;\n                }\n            }\n            loc++;\n        }\n        loc = loc - l;\n        return loc;\n    };\n    ;\n    return Parser;\n}());\nexport { Parser };\n","/* tslint:disable-next-line:max-line-length */\nimport { getSheetName, getSheetIndex, getSheet, getSheetIndexByName, getCell } from '../base/index';\nimport { workbookFormulaOperation, getColumnHeaderText, aggregateComputation, getRangeIndexes } from '../common/index';\nimport { Calculate, ValueChangedArgs, CommonErrors, getAlphalabel } from '../../calculate/index';\nimport { isNullOrUndefined } from '@syncfusion/ej2-base';\nimport { getCellAddress, getFormattedCellObject, isNumber, checkIsFormula } from '../common/index';\nimport { workbookEditOperation, getRangeAddress, getRangeFromAddress, isCellReference } from '../common/index';\n/**\n * @hidden\n * The `WorkbookFormula` module is used to handle the formula operation in Workbook.\n */\nvar WorkbookFormula = /** @class */ (function () {\n    /**\n     * Constructor for formula module in Workbook.\n     * @private\n     */\n    function WorkbookFormula(workbook) {\n        this.uniqueOBracket = String.fromCharCode(129);\n        this.uniqueCBracket = String.fromCharCode(130);\n        this.uniqueCSeparator = String.fromCharCode(131);\n        this.uniqueCOperator = String.fromCharCode(132);\n        this.uniquePOperator = String.fromCharCode(133);\n        this.uniqueSOperator = String.fromCharCode(134);\n        this.uniqueMOperator = String.fromCharCode(135);\n        this.uniqueDOperator = String.fromCharCode(136);\n        this.uniqueModOperator = String.fromCharCode(137);\n        this.uniqueConcateOperator = String.fromCharCode(138);\n        this.uniqueEqualOperator = String.fromCharCode(139);\n        this.uniqueExpOperator = String.fromCharCode(140);\n        this.uniqueGTOperator = String.fromCharCode(141);\n        this.uniqueLTOperator = String.fromCharCode(142);\n        this.sheetInfo = [];\n        this.parent = workbook;\n        this.init();\n    }\n    WorkbookFormula.prototype.init = function () {\n        this.addEventListener();\n        this.initCalculate();\n        this.registerSheet();\n    };\n    /**\n     * To destroy the formula module.\n     * @return {void}\n     * @hidden\n     */\n    WorkbookFormula.prototype.destroy = function () {\n        this.removeEventListener();\n        this.calculateInstance.dispose();\n        this.calculateInstance = null;\n        this.parent = null;\n    };\n    WorkbookFormula.prototype.addEventListener = function () {\n        this.parent.on(workbookFormulaOperation, this.performFormulaOperation, this);\n        this.parent.on(aggregateComputation, this.aggregateComputation, this);\n    };\n    WorkbookFormula.prototype.removeEventListener = function () {\n        if (!this.parent.isDestroyed) {\n            this.parent.off(workbookFormulaOperation, this.performFormulaOperation);\n            this.parent.off(aggregateComputation, this.aggregateComputation);\n        }\n    };\n    /**\n     * Get the module name.\n     * @returns string\n     * @private\n     */\n    WorkbookFormula.prototype.getModuleName = function () {\n        return 'workbookFormula';\n    };\n    WorkbookFormula.prototype.initCalculate = function () {\n        this.calculateInstance = new Calculate(this.parent);\n        this.calcID = this.calculateInstance.createSheetFamilyID();\n        this.calculateInstance.setTreatEmptyStringAsZero(true);\n        this.calculateInstance.grid = this.parent.getActiveSheet().id.toString();\n    };\n    WorkbookFormula.prototype.performFormulaOperation = function (args) {\n        var action = args.action;\n        var formulas = this.calculateInstance.getLibraryFormulas();\n        var formulaInfo = (Array.from(formulas.values()));\n        switch (action) {\n            case 'getLibraryFormulas':\n                args.formulaCollection = Array.from(formulas.keys());\n                break;\n            case 'getFormulaCategory':\n                var collection = ['All'];\n                for (var i = 1; i < Array.from(formulas.values()).length; i++) {\n                    if (collection.indexOf(formulaInfo[i].category) < 0) {\n                        collection.push(formulaInfo[i].category);\n                    }\n                }\n                args.categoryCollection = collection;\n                break;\n            case 'dropDownSelectFormulas':\n                for (var i = 0; i < Array.from(formulas.values()).length; i++) {\n                    if (args.selectCategory === formulaInfo[i].category) {\n                        args.formulaCollection[i] = Array.from(formulas.keys())[i];\n                    }\n                }\n                break;\n            case 'getFormulaDescription':\n                for (var i = 0; i < Array.from(formulas.values()).length; i++) {\n                    if (args.selectedList === Array.from(formulas.keys())[i]) {\n                        args.description = formulaInfo[i].description;\n                    }\n                }\n                break;\n            case 'registerSheet':\n                this.registerSheet(args.sheetIndex, args.sheetCount);\n                if (args.isImport) {\n                    this.updateSheetInfo();\n                }\n                break;\n            case 'unRegisterSheet':\n                this.unRegisterSheet(args.sheetIndex, args.sheetCount);\n                break;\n            case 'refreshCalculate':\n                args.value = this.autoCorrectFormula(args.value, args.rowIndex, args.colIndex);\n                this.refreshCalculate(args.rowIndex, args.colIndex, args.value, args.isFormula, args.sheetIndex);\n                args.value = args.value ? args.value.toString().split('-*').join('-').split('/*').join('/').split('*/').\n                    join('*').split('-/').join('-').split('*+').join('*').split('+*').join('+') : args.value;\n                break;\n            case 'getArgumentSeparator':\n                args.argumentSeparator = this.calculateInstance.getParseArgumentSeparator();\n                break;\n            case 'addDefinedName':\n                args.isAdded = this.addDefinedName(args.definedName);\n                break;\n            case 'removeDefinedName':\n                args.isRemoved = this.removeDefinedName(args.definedName, args.scope);\n                break;\n            case 'initiateDefinedNames':\n                this.initiateDefinedNames();\n                break;\n            case 'renameUpdation':\n                this.renameUpdation(args.value, args.sheetId);\n                break;\n            case 'addSheet':\n                this.sheetInfo.push({ visibleName: args.visibleName, sheet: args.sheetName, index: args.index });\n                break;\n            case 'getSheetInfo':\n                args.sheetInfo = this.sheetInfo;\n                break;\n            case 'deleteSheetTab':\n                var length_1 = this.sheetInfo.length;\n                for (var i = 0; i < length_1; i++) {\n                    if (this.sheetInfo[i].index === args.index) {\n                        args.sheetName = this.sheetInfo[i].sheet;\n                        this.sheetInfo.splice(i, 1);\n                        break;\n                    }\n                }\n                this.calculateInstance.unregisterGridAsSheet((args.index - 1).toString(), args.index);\n                this.calculateInstance.tokenCount = this.calculateInstance.tokenCount - 1;\n                this.sheetDeletion(args.sheetName, args.index, args.index);\n                break;\n            case 'getReferenceError':\n                args.refError = this.referenceError();\n                break;\n            case 'getAlpha':\n                args.col = getAlphalabel(args.col);\n                break;\n            case 'addCustomFunction':\n                this.addCustomFunction(args.functionHandler, args.functionName);\n                break;\n            case 'computeExpression':\n                args.calcValue = this.calculateInstance.computeExpression(args.formula);\n                break;\n            case 'registerGridInCalc':\n                this.calculateInstance.grid = args.sheetID;\n                break;\n            case 'refreshInsDelFormula':\n                this.refreshInsDelFormula(args.insertArgs);\n                break;\n            case 'refreshNamedRange':\n                this.refreshNamedRange(args.insertArgs, action);\n                break;\n        }\n    };\n    WorkbookFormula.prototype.referenceError = function () {\n        return this.calculateInstance.getErrorStrings()[CommonErrors.ref];\n    };\n    WorkbookFormula.prototype.getSheetInfo = function () {\n        return this.sheetInfo;\n    };\n    WorkbookFormula.prototype.addCustomFunction = function (functionHandler, functionName) {\n        this.calculateInstance.defineFunction(functionName, functionHandler);\n    };\n    WorkbookFormula.prototype.updateSheetInfo = function () {\n        var _this = this;\n        this.sheetInfo = [];\n        this.parent.sheets.forEach(function (sheet, idx) {\n            _this.sheetInfo.push({ visibleName: sheet.name, sheet: 'Sheet' + sheet.id, index: idx });\n        });\n    };\n    WorkbookFormula.prototype.sheetDeletion = function (delSheetName, sheetId, index) {\n        var dependentCell = this.calculateInstance.getDependentCells();\n        var cellRef = [];\n        var fInfo = null;\n        var formulaVal = '';\n        var rowId;\n        var colId;\n        dependentCell.forEach(function (value, key) {\n            cellRef.push(key);\n        });\n        this.removeSheetTokenIndex(formulaVal, index);\n        for (var i = 0; i < cellRef.length; i++) {\n            var dependentCellRef = this.calculateInstance.getDependentCells().get(cellRef[i]);\n            for (var j = 0; j < dependentCellRef.length; j++) {\n                fInfo = this.calculateInstance.getFormulaInfoTable().get(dependentCellRef[j]);\n                sheetId = parseInt(dependentCellRef[j].split('!')[1], 10) + 1;\n                if (!isNullOrUndefined(fInfo) && sheetId > -1) {\n                    formulaVal = fInfo.formulaText;\n                    if (formulaVal.toUpperCase().indexOf(delSheetName.toUpperCase()) > -1) {\n                        formulaVal = formulaVal.toUpperCase().split(delSheetName.toUpperCase() +\n                            this.calculateInstance.sheetToken).join(this.referenceError());\n                        rowId = this.calculateInstance.rowIndex(dependentCellRef[j]);\n                        colId = this.calculateInstance.colIndex(dependentCellRef[j]);\n                        this.updateDataContainer([rowId - 1, colId - 1], { value: formulaVal, sheetId: sheetId, visible: false });\n                        this.calculateInstance.refresh(fInfo.getParsedFormula());\n                    }\n                }\n                if (delSheetName.split('Sheet')[1] === cellRef[i].split('!')[1]) {\n                    this.calculateInstance.getFormulaInfoTable().delete(cellRef[i]);\n                    this.calculateInstance.clearFormulaDependentCells(cellRef[i]);\n                }\n            }\n        }\n    };\n    WorkbookFormula.prototype.removeSheetTokenIndex = function (value, index) {\n        var family = this.calculateInstance.getSheetFamilyItem(this.calculateInstance.grid);\n        family.sheetNameToToken.delete(index.toString());\n        family.sheetNameToParentObject.delete(index.toString());\n        family.parentObjectToToken.delete(index.toString());\n        family.tokenToParentObject.delete('!' + (index - 1).toString() + '!');\n        return value;\n    };\n    WorkbookFormula.prototype.renameUpdation = function (name, sheetIdx) {\n        var dependentCellRef = this.calculateInstance.getDependentCells();\n        var cellRef = [];\n        var fInfo;\n        var formulaVal = '';\n        var savedTokens = [];\n        var isSheetRenamed = false;\n        var rowIndex;\n        var colIndex;\n        var sheetIndex;\n        dependentCellRef.forEach(function (value, key) {\n            cellRef.push(key);\n        });\n        for (var i = 0; i < this.sheetInfo.length; i++) {\n            if (this.sheetInfo[i].index === sheetIdx) {\n                this.sheetInfo[i].visibleName = name;\n                break;\n            }\n        }\n        var sheetNames = this.sheetInfo;\n        for (var i = 0; i < cellRef.length; i++) {\n            var dependentCells = this.calculateInstance.getDependentCells().get(cellRef[i]);\n            for (var j = 0; j < dependentCells.length; j++) {\n                fInfo = this.calculateInstance.getFormulaInfoTable().get(dependentCells[j]);\n                formulaVal = fInfo.formulaText;\n                for (var s = 0; s < sheetNames.length; s++) {\n                    if (sheetNames[s].visibleName !== sheetNames[s].sheet) {\n                        var name_1 = sheetNames[s].sheet.toUpperCase();\n                        if (formulaVal.toUpperCase().indexOf(name_1) > -1) {\n                            formulaVal = formulaVal.toUpperCase().split(name_1).join(s + '/');\n                            savedTokens.push(s);\n                            isSheetRenamed = true;\n                        }\n                    }\n                }\n                if (isSheetRenamed) {\n                    for (var k = 0; k < savedTokens.length; k++) {\n                        formulaVal = formulaVal.split(savedTokens[k].toString() + '/').join(sheetNames[savedTokens[k]].visibleName);\n                    }\n                    rowIndex = this.calculateInstance.rowIndex(dependentCells[j]);\n                    colIndex = this.calculateInstance.colIndex(dependentCells[j]);\n                    sheetIndex = getSheetIndexByName(this.parent, ('Sheet') + (parseInt(dependentCells[j].split('!')[1], 10) + 1), this.sheetInfo);\n                    this.updateDataContainer([rowIndex - 1, colIndex - 1], { value: formulaVal, sheetId: sheetIndex, visible: true });\n                }\n            }\n        }\n    };\n    WorkbookFormula.prototype.updateDataContainer = function (indexes, data) {\n        var rowIndex = indexes[0];\n        var colIndex = indexes[1];\n        var sheetData;\n        var rowData;\n        var colObj;\n        var len = this.parent.sheets.length;\n        for (var i = 0; i < len; i++) {\n            if (this.parent.sheets[i].id === data.sheetId) {\n                sheetData = this.parent.sheets[i].rows;\n                break;\n            }\n        }\n        if (!isNullOrUndefined(data)) {\n            if (rowIndex in sheetData) {\n                rowData = sheetData[rowIndex];\n                if (colIndex in rowData.cells) {\n                    colObj = rowData.cells[colIndex];\n                    colObj.formula = data.value;\n                    colObj.value = data.visible ? colObj.value : this.referenceError();\n                }\n                else {\n                    rowData.cells[colIndex] = colObj = {};\n                }\n            }\n            else {\n                rowData = sheetData[rowIndex] = {};\n                rowData[colIndex] = colObj = {};\n            }\n        }\n    };\n    WorkbookFormula.prototype.parseSheetRef = function (value) {\n        var regx;\n        var escapeRegx = new RegExp('[!@#$%^&()+=\\';,.{}|\\\":<>~_-]', 'g');\n        var i = 0;\n        var sheetCount = this.parent.sheets.length;\n        var temp = [];\n        temp.length = 0;\n        var sheetInfo = this.getSheetInfo();\n        var exp = '(?=[\\'!])(?=[^\"]*(?:\"[^\"]*\"[^\"]*)*$)';\n        for (i = 0; i < sheetCount; i++) {\n            if (sheetInfo[i].sheet !== sheetInfo[i].visibleName) {\n                regx = new RegExp(sheetInfo[i].visibleName.replace(escapeRegx, '\\\\$&') + exp, 'gi');\n                if (value.match(regx)) {\n                    value = value.replace(regx, i + '/');\n                    temp.push(i);\n                }\n            }\n        }\n        i = 0;\n        while (i < temp.length) {\n            regx = new RegExp(temp[i] + '/' + exp, 'gi');\n            value = value.replace(regx, sheetInfo[temp[i]].sheet);\n            i++;\n        }\n        return value;\n    };\n    WorkbookFormula.prototype.registerSheet = function (sheetIndex, sheetCount) {\n        if (sheetIndex === void 0) { sheetIndex = 0; }\n        if (sheetCount === void 0) { sheetCount = this.parent.sheets.length; }\n        var id;\n        while (sheetIndex < sheetCount) {\n            id = getSheet(this.parent, sheetIndex).id + '';\n            this.calculateInstance.registerGridAsSheet(id, id, this.calcID);\n            sheetIndex++;\n        }\n    };\n    WorkbookFormula.prototype.unRegisterSheet = function (sheetIndex, sheetCount) {\n        if (sheetIndex === void 0) { sheetIndex = 0; }\n        if (sheetCount === void 0) { sheetCount = this.parent.sheets.length; }\n        var id;\n        this.calculateInstance.tokenCount = 0;\n        while (sheetIndex < sheetCount) {\n            id = getSheet(this.parent, sheetIndex).id + '';\n            this.calculateInstance.unregisterGridAsSheet(id, id);\n            sheetIndex++;\n        }\n    };\n    WorkbookFormula.prototype.refreshCalculate = function (rowIdx, colIdx, value, isFormula, sheetIdx) {\n        if (sheetIdx === undefined) {\n            sheetIdx = this.parent.activeSheetIndex;\n        }\n        var sheetName = getSheet(this.parent, sheetIdx).id + '';\n        if (isFormula) {\n            value = this.parseSheetRef(value);\n            var cellArgs = new ValueChangedArgs(rowIdx + 1, colIdx + 1, value);\n            this.calculateInstance.valueChanged(sheetName, cellArgs, true);\n            var referenceCollection = this.calculateInstance.randCollection;\n            if (this.calculateInstance.isRandomVal === true) {\n                var rowId = void 0;\n                var colId = void 0;\n                var refValue = '';\n                if (this.calculateInstance.randomValues.size > 1 && this.calculateInstance.randomValues.size ===\n                    referenceCollection.length) {\n                    for (var i = 0; i < this.calculateInstance.randomValues.size; i++) {\n                        rowId = this.calculateInstance.rowIndex(referenceCollection[i]);\n                        colId = this.calculateInstance.colIndex(referenceCollection[i]);\n                        refValue = this.calculateInstance.randomValues.get(referenceCollection[i]);\n                        sheetName = (parseFloat(this.calculateInstance.getSheetToken(referenceCollection[i]).split(this.calculateInstance.sheetToken).join('')) + 1).toString();\n                        var tempArgs = new ValueChangedArgs(rowId, colId, refValue);\n                        this.calculateInstance.valueChanged(sheetName, tempArgs, true);\n                    }\n                }\n            }\n        }\n        else {\n            var family = this.calculateInstance.getSheetFamilyItem(sheetName);\n            var cellRef = getColumnHeaderText(colIdx + 1) + (rowIdx + 1);\n            if (family.isSheetMember && !isNullOrUndefined(family.parentObjectToToken)) {\n                cellRef = family.parentObjectToToken.get(sheetName) + cellRef;\n            }\n            if (this.calculateInstance.getFormulaInfoTable().has(cellRef)) {\n                this.calculateInstance.getFormulaInfoTable().delete(cellRef);\n                if (this.calculateInstance.getDependentCells().has(cellRef)) {\n                    this.calculateInstance.clearFormulaDependentCells(cellRef);\n                }\n            }\n            this.calculateInstance.getComputedValue().clear();\n            this.calculateInstance.refresh(cellRef);\n            this.calculateInstance.refreshRandValues(cellRef);\n        }\n        this.calculateInstance.cell = '';\n    };\n    WorkbookFormula.prototype.autoCorrectFormula = function (formula, rowIdx, colIdx) {\n        if (!isNullOrUndefined(formula)) {\n            formula = formula.toString();\n            if (formula.split('(').length === 2 && formula.indexOf(')') < 0) {\n                formula += ')';\n            }\n            var isEqual = void 0;\n            if (formula.indexOf('=') === 0) {\n                formula = formula.slice(1);\n                isEqual = true;\n            }\n            var lessEq = formula.match(/</g);\n            var greaterEq = formula.match(/>/g);\n            var equal = formula.match(/=/g);\n            if (lessEq) {\n                var lessOp = '';\n                for (var i = 0; i < lessEq.length; i++) {\n                    lessOp = lessOp + lessEq[i];\n                }\n                formula = formula.replace(lessOp, '<');\n            }\n            if (greaterEq) {\n                var greaterOp = '';\n                for (var j = 0; j < greaterEq.length; j++) {\n                    greaterOp = greaterOp + greaterEq[j];\n                }\n                formula = formula.replace(greaterOp, '>');\n            }\n            if (equal) {\n                var equalOp = '';\n                for (var c = 0; c < equal.length; c++) {\n                    equalOp = equalOp + equal[c];\n                }\n                formula = formula.split(equalOp).join('=');\n            }\n            formula = isEqual ? '=' + formula : formula;\n            if (lessEq || greaterEq || equal) {\n                getCell(rowIdx, colIdx, this.parent.getActiveSheet()).formula = formula;\n            }\n        }\n        return formula;\n    };\n    WorkbookFormula.prototype.initiateDefinedNames = function () {\n        var definedNames = this.parent.definedNames;\n        var i = 0;\n        while (i < definedNames.length) {\n            var definedname = definedNames[i];\n            var refersTo = this.parseSheetRef(definedname.refersTo);\n            var range = getRangeFromAddress(refersTo);\n            var cellRef = false;\n            var isLink = refersTo.indexOf('http:') > -1 ? true : (refersTo.indexOf('https:') > -1 ? true : false);\n            range = range.split('$').join('');\n            range = range.split('=').join('');\n            if (range.indexOf(':') > -1) {\n                var rangeSplit = range.split(':');\n                if (isCellReference(rangeSplit[0]) && isCellReference(rangeSplit[1])) {\n                    cellRef = true;\n                }\n            }\n            else if (range.indexOf(':') < 0) {\n                if (isCellReference(range)) {\n                    cellRef = true;\n                }\n            }\n            if (isLink) {\n                cellRef = false;\n            }\n            if (cellRef) {\n                this.addDefinedName(definedname, true);\n            }\n            else {\n                this.removeDefinedName(definedname.name, definedname.scope);\n                i--;\n            }\n            i++;\n        }\n    };\n    /**\n     * @hidden\n     * Used to add defined name to workbook.\n     * @param {DefineNameModel} name - Define named range.\n     */\n    WorkbookFormula.prototype.addDefinedName = function (definedName, isValidate) {\n        var isAdded = true;\n        var sheetIdx;\n        var name = definedName.name;\n        if (definedName.refersTo.indexOf('!') < 0) {\n            var sheetName = getSheetName(this.parent);\n            sheetName = sheetName.indexOf(' ') !== -1 ? '\\'' + sheetName + '\\'' : sheetName;\n            definedName.refersTo = sheetName + '!' + ((definedName.refersTo.indexOf('=') < 0) ?\n                definedName.refersTo : definedName.refersTo.split('=')[1]);\n        }\n        var visibleRefersTo = definedName.refersTo;\n        var refersTo = this.parseSheetRef(definedName.refersTo);\n        if (definedName.scope) {\n            sheetIdx = getSheetIndex(this.parent, definedName.scope);\n            if (sheetIdx > -1) {\n                name = getSheetName(this.parent, sheetIdx) + '!' + name;\n            }\n        }\n        else {\n            definedName.scope = '';\n        }\n        if (!definedName.comment) {\n            definedName.comment = '';\n        }\n        //need to extend once internal sheet value changes done.\n        if (!isValidate && this.checkIsNameExist(definedName.name, definedName.scope)) {\n            isAdded = false;\n        }\n        else {\n            this.calculateInstance.addNamedRange(name, refersTo[0] === '=' ? refersTo.substr(1) : refersTo);\n            if (refersTo[0] !== '=') {\n                definedName.refersTo = '=' + visibleRefersTo;\n            }\n            if (this.parent.definedNames.indexOf(definedName) < 0) {\n                this.parent.definedNames.push(definedName);\n            }\n        }\n        return isAdded;\n    };\n    /**\n     * @hidden\n     * Used to remove defined name from workbook.\n     * @param {string} name - Specifies the defined name.\n     * @param {string} scope - Specifies the scope of the define name.\n     */\n    WorkbookFormula.prototype.removeDefinedName = function (name, scope) {\n        var isRemoved = false;\n        var index = this.getIndexFromNameColl(name, scope);\n        if (index > -1) {\n            var calcName = name;\n            if (scope) {\n                var sheetIdx = getSheetIndex(this.parent, scope);\n                if (sheetIdx) {\n                    calcName = getSheetName(this.parent, sheetIdx) + '!' + name;\n                }\n            }\n            this.calculateInstance.removeNamedRange(calcName);\n            this.parent.definedNames.splice(index, 1);\n            isRemoved = true;\n        }\n        return isRemoved;\n    };\n    WorkbookFormula.prototype.checkIsNameExist = function (name, sheetName) {\n        var isExist = this.parent.definedNames.some(function (key) {\n            return key.name === name && (sheetName ? key.scope === sheetName : key.scope === '');\n        });\n        return isExist;\n    };\n    WorkbookFormula.prototype.getIndexFromNameColl = function (definedName, scope) {\n        if (scope === void 0) { scope = ''; }\n        var index = -1;\n        this.parent.definedNames.filter(function (name, idx) {\n            if (name.name === definedName && name.scope === scope) {\n                index = idx;\n            }\n        });\n        return index;\n    };\n    WorkbookFormula.prototype.toFixed = function (value) {\n        var num = Number(value);\n        if (Math.round(num) !== num) {\n            value = num.toFixed(2);\n        }\n        return value;\n    };\n    WorkbookFormula.prototype.aggregateComputation = function (args) {\n        var sheet = this.parent.getActiveSheet();\n        var range = sheet.selectedRange;\n        var indexes = getRangeIndexes(range.split(':')[1]);\n        var i;\n        var calcValue;\n        var formulaVal = ['SUM', 'AVERAGE', 'MIN', 'MAX'];\n        var formatedValues = [];\n        if (indexes[0] + 1 === sheet.rowCount && indexes[1] + 1 === sheet.colCount) {\n            range = \"A1:\" + getCellAddress(sheet.usedRange.rowIndex, sheet.usedRange.colIndex);\n        }\n        var actCell = getRangeIndexes(sheet.activeCell);\n        var actCellModel = sheet.rows[actCell[0]] ? sheet.rows[actCell[0]].cells ?\n            sheet.rows[actCell[0]].cells[actCell[1]] : {} : {};\n        var actCellfrmt = (actCellModel) ? actCellModel.format : '';\n        var cellValue;\n        var cellCol = this.calculateInstance.getCellCollection(range);\n        for (i = 0; i < cellCol.length; i++) {\n            cellValue = this.calculateInstance.getValueFromArg(cellCol[i]);\n            if (isNumber(cellValue)) {\n                args.countOnly = false;\n                break;\n            }\n        }\n        args.Count = this.calculateInstance.getFunction('COUNTA')(range);\n        if (!args.Count || args.countOnly) {\n            return;\n        }\n        for (i = 0; i < 4; i++) {\n            calcValue = this.toFixed(this.calculateInstance.getFunction(formulaVal[i])(range));\n            var eventArgs = {\n                formattedText: calcValue,\n                value: calcValue,\n                format: actCellfrmt,\n                onLoad: true\n            };\n            if (actCellfrmt) {\n                this.parent.notify(getFormattedCellObject, eventArgs);\n                calcValue = eventArgs.formattedText;\n            }\n            formatedValues.push(calcValue);\n        }\n        args.Sum = formatedValues[0];\n        args.Avg = formatedValues[1];\n        args.Min = formatedValues[2];\n        args.Max = formatedValues[3];\n    };\n    WorkbookFormula.prototype.clearFormula = function (args) {\n        if (this.parent.activeSheetIndex === args.sheetIdx) {\n            args.rowIdx = (args.type === 'Row') ? (args.status === 'insert') ? (args.rowIdx >= args.startIdx)\n                ? args.rowIdx - args.count : args.rowIdx : args.rowIdx + args.count : args.rowIdx;\n            args.colIdx = (args.type === 'Column') ? (args.status === 'insert') ? (args.colIdx >= args.startIdx) ?\n                args.colIdx - args.count : args.colIdx : args.colIdx + args.count : args.colIdx;\n        }\n        var cellRef = '!' + args.sheetIdx + '!' + getAlphalabel((args.colIdx === -1 ?\n            (args.colIdx + 2) : (args.colIdx + 1))) + (args.rowIdx === -1 ? (args.rowIdx + 2) : (args.rowIdx + 1));\n        this.calculateInstance.getFormulaInfoTable().delete(cellRef);\n        this.calculateInstance.clearFormulaDependentCells(cellRef);\n    };\n    WorkbookFormula.prototype.refreshFormula = function (formulaValue, count, status, type, startIdx, sheetIdx) {\n        var diff;\n        var diff1;\n        var val = formulaValue;\n        var nAlpha;\n        var range = [];\n        var actSheet = this.parent.getActiveSheet();\n        var deleteIdxs = [];\n        var i;\n        var splitFormula = [];\n        var fArg;\n        var ridx;\n        var hasREFVal = false;\n        var pVal;\n        if (checkIsFormula(val)) {\n            if (status === 'delete') {\n                for (i = 1; i <= count; i++) {\n                    deleteIdxs.push(startIdx + i);\n                }\n            }\n            splitFormula = this.parseFormula(val);\n            for (i = 0; i < splitFormula.length; i++) {\n                fArg = splitFormula[i].trim();\n                if (this.calculateInstance.isCellReference(fArg)) {\n                    pVal = i && splitFormula[i - 1].trim();\n                    if (pVal && pVal[pVal.length - 1] === '!') {\n                        pVal = pVal.replace(/['!]/g, '');\n                        if (pVal !== actSheet.name) {\n                            continue;\n                        }\n                    }\n                    else if (parseInt(pVal, 10) === 0 && pVal[pVal.length - 1] === undefined) {\n                        if ((actSheet.id - 1) !== sheetIdx) {\n                            continue;\n                        }\n                    }\n                    range = getRangeIndexes(fArg);\n                    diff = (type === 'Column') ? (status === 'insert') ? range[3] + count : range[3] - count :\n                        (status === 'insert') ? range[2] + count : range[2] - count;\n                    diff1 = (type === 'Column') ? (status === 'insert') ? range[1] + count : range[1] - count :\n                        (status === 'insert') ? range[0] + count : range[0] - count;\n                    diff1 = (type === 'Column') ? (startIdx > range[1]) ? range[1] : diff1 : (startIdx > range[0]) ? range[0] : diff1;\n                    diff = (type === 'Column') ? (startIdx > range[3]) ? range[3] : diff : (startIdx > range[2]) ? range[2] : diff;\n                    if (diff1 > -1) {\n                        nAlpha = (type === 'Column') ? getRangeAddress([range[0], diff1, range[2], diff]).split(':')[0] :\n                            getRangeAddress([diff1, range[1], diff, range[3]]).split(':')[0];\n                    }\n                    else {\n                        nAlpha = '#REF!';\n                        hasREFVal = true;\n                    }\n                    if (status === 'delete') {\n                        ridx = parseInt(type === 'Row' ? fArg.replace(/[A-Z]/g, '') : (fArg.replace(/[0-9]/g, '')), 10);\n                        if (deleteIdxs.indexOf(ridx) > -1) {\n                            nAlpha = '#REF!';\n                            hasREFVal = true;\n                        }\n                    }\n                    splitFormula[i] = nAlpha;\n                }\n            }\n            val = '=' + splitFormula.join('');\n        }\n        return val;\n    };\n    WorkbookFormula.prototype.refreshInsDelFormula = function (args) {\n        var count;\n        var sheet;\n        var sheets = this.parent.sheets;\n        var sheetLen = sheets.length;\n        var address;\n        var cell;\n        var s;\n        var updatedFormulaVal;\n        for (s = 0; s < sheetLen; s++) {\n            count = args.model.length;\n            sheet = this.parent.sheets[s];\n            address = [0, 0, sheet.usedRange.rowIndex, sheet.usedRange.colIndex];\n            for (var i = address[2]; i >= address[0]; i--) {\n                for (var j = address[1]; j <= address[3]; j++) {\n                    cell = getCell(i, j, sheet);\n                    if (cell && cell.formula && checkIsFormula(cell.formula)) {\n                        this.clearFormula({\n                            rowIdx: i, colIdx: j, sheetIdx: s, count: count, status: args.name,\n                            type: args.modelType, startIdx: args.startIndex\n                        });\n                        updatedFormulaVal = this.refreshFormula(cell.formula, count, args.name, args.modelType, args.startIndex, s);\n                        this.parent.notify(workbookEditOperation, {\n                            action: 'updateCellValue', address: [i, j, i,\n                                j], value: updatedFormulaVal, sheetIndex: s\n                        });\n                    }\n                }\n            }\n        }\n    };\n    WorkbookFormula.prototype.parseFormula = function (formula) {\n        var temp;\n        var str;\n        var len;\n        var i = 0;\n        var arr = [];\n        var formulaVal = [];\n        formulaVal = this.markSpecialChar(formula.replace('=', ''));\n        formulaVal = formulaVal.split(/\\(|\\)|=|\\^|>|<|,|:|\\+|-|\\*|\\/|%|&/g);\n        len = formulaVal.length;\n        while (i < len) {\n            temp = formulaVal[i];\n            if (!temp) {\n                i++;\n                continue;\n            }\n            if (temp.length === 1) {\n                arr.push(this.isUniqueChar(temp) ? this.getUniqueCharVal(temp) : temp);\n            }\n            else {\n                str = temp[0];\n                if (temp.indexOf('!') > 0) {\n                    if (this.isUniqueChar(str)) {\n                        arr.push(this.getUniqueCharVal(str));\n                        temp = temp.substr(1);\n                    }\n                    str = temp.indexOf('!') + 1;\n                    arr.push(temp.substr(0, str));\n                    arr.push(temp.substr(str));\n                }\n                else if (this.isUniqueChar(str)) {\n                    arr.push(this.getUniqueCharVal(str));\n                    arr.push(temp.substr(1));\n                }\n                else {\n                    arr.push(temp);\n                }\n            }\n            i++;\n        }\n        return arr;\n    };\n    WorkbookFormula.prototype.getUniqueCharVal = function (formula) {\n        switch (formula) {\n            case this.uniqueOBracket:\n                return '(';\n            case this.uniqueCBracket:\n                return ')';\n            case this.uniqueCSeparator:\n                return ',';\n            case this.uniqueCOperator:\n                return ':';\n            case this.uniquePOperator:\n                return '+';\n            case this.uniqueSOperator:\n                return '-';\n            case this.uniqueMOperator:\n                return '*';\n            case this.uniqueDOperator:\n                return '/';\n            case this.uniqueModOperator:\n                return '%';\n            case this.uniqueConcateOperator:\n                return '&';\n            case this.uniqueEqualOperator:\n                return '=';\n            case this.uniqueExpOperator:\n                return '^';\n            case this.uniqueGTOperator:\n                return '>';\n            case this.uniqueLTOperator:\n                return '<';\n        }\n        return '';\n    };\n    WorkbookFormula.prototype.isUniqueChar = function (formula) {\n        var code = formula.charCodeAt(formula);\n        return code >= 129 && code <= 142;\n    };\n    WorkbookFormula.prototype.markSpecialChar = function (formula) {\n        formula = formula.replace(/\\(/g, '(' + this.uniqueOBracket).replace(/\\)/g, ')' + this.uniqueCBracket);\n        formula = formula.replace(/,/g, ',' + this.uniqueCSeparator).replace(/:/g, ':' + this.uniqueCOperator);\n        formula = formula.replace(/\\+/g, '+' + this.uniquePOperator).replace(/-/g, '-' + this.uniqueSOperator);\n        formula = formula.replace(/\\*/g, '*' + this.uniqueMOperator).replace(/\\//g, '/' + this.uniqueDOperator);\n        formula = formula.replace(/&/g, '&' + this.uniqueConcateOperator);\n        formula = formula.replace(/=/g, '=' + this.uniqueEqualOperator);\n        formula = formula.replace(/\\^/g, '^' + this.uniqueExpOperator);\n        formula = formula.replace(/>/g, '>' + this.uniqueGTOperator).replace(/</g, '<' + this.uniqueLTOperator);\n        return formula.replace(/%/g, '%' + this.uniqueModOperator);\n    };\n    WorkbookFormula.prototype.refreshNamedRange = function (args, action) {\n        var isChanged = false;\n        var modelDefinedNames = this.parent.definedNames;\n        var definedNames = Object.assign({}, modelDefinedNames);\n        var definedName;\n        var definedNameCnt = modelDefinedNames.length;\n        var range;\n        var rangeIndex;\n        var count;\n        var startIndex;\n        var endIndex;\n        var newIndex;\n        var newRange;\n        var sheetName;\n        var sheetIndex;\n        var sheet;\n        for (var idx = 0; idx < definedNameCnt; idx++) {\n            definedName = definedNames[idx];\n            range = definedNames[idx].refersTo.split('!')[1];\n            rangeIndex = getRangeIndexes(range);\n            sheetName = definedName.refersTo.split('!')[0].split('=')[1];\n            sheetIndex = getSheetIndex(this.parent, sheetName.replace(/'/g, ''));\n            sheet = getSheet(this.parent, sheetIndex);\n            if (sheetIndex === this.parent.activeSheetIndex) {\n                if (args.name === 'insert') {\n                    count = args.model.length;\n                    startIndex = args.index;\n                    endIndex = args.index + count;\n                    if (args.modelType === 'Row') { // for above the named range index\n                        if ((rangeIndex[0] >= endIndex) || (rangeIndex[0] >= startIndex && rangeIndex[2] >= endIndex)) {\n                            newIndex = [rangeIndex[0] + count, rangeIndex[1], rangeIndex[2] + count, rangeIndex[3]];\n                            isChanged = true;\n                        }\n                        else if ((rangeIndex[0] <= startIndex && rangeIndex[2] >= startIndex) || (rangeIndex[2] >= endIndex)) {\n                            newIndex = [rangeIndex[0], rangeIndex[1], rangeIndex[2] + count, rangeIndex[3]];\n                            isChanged = true;\n                        }\n                    }\n                    else if (args.modelType === 'Column') {\n                        if ((rangeIndex[1] >= endIndex) || (rangeIndex[1] >= startIndex && rangeIndex[3] >= endIndex)) {\n                            newIndex = [rangeIndex[0], rangeIndex[1] + count, rangeIndex[2], rangeIndex[3] + count];\n                            isChanged = true;\n                        }\n                        else if ((rangeIndex[1] <= startIndex && rangeIndex[3] >= startIndex) || (rangeIndex[3] >= endIndex)) {\n                            newIndex = [rangeIndex[0], rangeIndex[1], rangeIndex[2], rangeIndex[3] + count];\n                            isChanged = true;\n                        }\n                    }\n                }\n                else {\n                    count = args.deletedModel.length;\n                    startIndex = args.startIndex;\n                    endIndex = args.endIndex;\n                    if (args.modelType === 'Row') { // for above the named range index\n                        if ((rangeIndex[0] >= endIndex) || (rangeIndex[0] >= startIndex && rangeIndex[2] >= endIndex)) {\n                            newIndex = [rangeIndex[0] - count, rangeIndex[1], rangeIndex[2] - count, rangeIndex[3]];\n                            isChanged = true;\n                        }\n                        else if ((rangeIndex[0] <= startIndex && rangeIndex[2] >= startIndex) || (rangeIndex[2] >= endIndex)) {\n                            newIndex = [rangeIndex[0], rangeIndex[1], rangeIndex[2] - count, rangeIndex[3]];\n                            isChanged = true;\n                        }\n                    }\n                    else if (args.modelType === 'Column') {\n                        if ((rangeIndex[1] >= endIndex) || (rangeIndex[1] >= startIndex && rangeIndex[3] >= endIndex)) {\n                            newIndex = [rangeIndex[0], rangeIndex[1] - count, rangeIndex[2], rangeIndex[3] - count];\n                            isChanged = true;\n                        }\n                        else if ((rangeIndex[1] <= startIndex && rangeIndex[3] >= startIndex) || (rangeIndex[3] >= endIndex)) {\n                            newIndex = [rangeIndex[0], rangeIndex[1], rangeIndex[2], rangeIndex[3] - count];\n                            isChanged = true;\n                        }\n                    }\n                }\n                if (isChanged) {\n                    newRange = getRangeAddress(newIndex);\n                    definedName.refersTo = sheetName + '!' + newRange;\n                    this.parent.removeDefinedName(definedName.name, definedName.scope);\n                    var eventArgs = {\n                        action: 'addDefinedName', definedName: definedName, isAdded: false\n                    };\n                    this.parent.notify(workbookFormulaOperation, eventArgs);\n                }\n            }\n            modelDefinedNames = definedNames;\n        }\n    };\n    return WorkbookFormula;\n}());\nexport { WorkbookFormula };\n","import { getCell, setCell, getData } from '../base/index';\nimport { DataManager, Query, DataUtil, Deferred } from '@syncfusion/ej2-data';\nimport { getCellIndexes, getIndexesFromAddress, getColumnHeaderText, getRangeAddress, workbookLocale } from '../common/index';\nimport { getSwapRange } from '../common/index';\nimport { initiateSort } from '../common/event';\nimport { isNullOrUndefined } from '@syncfusion/ej2-base';\n/**\n * The `WorkbookSort` module is used to handle sort action in Spreadsheet.\n */\nvar WorkbookSort = /** @class */ (function () {\n    /**\n     * Constructor for WorkbookSort module.\n     */\n    function WorkbookSort(parent) {\n        this.parent = parent;\n        this.addEventListener();\n    }\n    /**\n     * To destroy the sort module.\n     */\n    WorkbookSort.prototype.destroy = function () {\n        this.removeEventListener();\n        this.parent = null;\n    };\n    WorkbookSort.prototype.addEventListener = function () {\n        this.parent.on(initiateSort, this.initiateSortHandler, this);\n    };\n    WorkbookSort.prototype.removeEventListener = function () {\n        if (!this.parent.isDestroyed) {\n            this.parent.off(initiateSort, this.initiateSortHandler);\n        }\n    };\n    /**\n     * Sorts range of cells in the sheet.\n     * @param args - arguments for sorting.\n     */\n    WorkbookSort.prototype.initiateSortHandler = function (eventArgs) {\n        var _this = this;\n        var args = eventArgs.args;\n        var deferred = new Deferred();\n        var sheet = this.parent.getActiveSheet();\n        var range = getSwapRange(getIndexesFromAddress(args.range));\n        var sortOptions = args.sortOptions || { sortDescriptors: {}, containsHeader: true };\n        var isSingleCell = false;\n        eventArgs.promise = deferred.promise;\n        if (range[0] > sheet.usedRange.rowIndex || range[1] > sheet.usedRange.colIndex) {\n            deferred.reject(this.parent.serviceLocator.getService(workbookLocale).getConstant('SortOutOfRangeError'));\n            return;\n        }\n        var containsHeader = sortOptions.containsHeader;\n        if (range[0] === range[2]) { //if selected range is a single cell \n            range = this.getSortDataRange(range[0], range[1], sheet);\n            isSingleCell = true;\n            if (isNullOrUndefined(sortOptions.containsHeader)) {\n                if (typeof getCell(range[0], range[1], sheet, null, true).value ===\n                    typeof getCell(range[0] + 1, range[1], sheet, null, true).value) {\n                    containsHeader = this.isSameStyle(getCell(range[0], range[1], sheet, null, true).style, getCell(range[0] + 1, range[1], sheet, null, true).style) ? false : true;\n                }\n                else {\n                    containsHeader = true;\n                }\n            }\n        }\n        if ((isNullOrUndefined(args.sortOptions) || isNullOrUndefined(args.sortOptions.containsHeader)) && !isSingleCell) {\n            if (!isNullOrUndefined(getCell(range[0], range[1], sheet)) && !isNullOrUndefined(getCell(range[0] + 1, range[1], sheet))) {\n                if (typeof getCell(range[0], range[1], sheet).value === typeof getCell(range[0] + 1, range[1], sheet).value) {\n                    containsHeader = false;\n                }\n                else {\n                    containsHeader = true;\n                }\n            }\n        }\n        var sRIdx = range[0] = containsHeader ? range[0] + 1 : range[0];\n        var sCIdx;\n        var eCIdx;\n        var cell = getCellIndexes(sheet.activeCell);\n        var header = getColumnHeaderText(cell[1] + 1);\n        var sortDescriptors = sortOptions.sortDescriptors;\n        var address = getRangeAddress(range);\n        getData(this.parent, sheet.name + \"!\" + address, true).then(function (jsonData) {\n            var dataManager = new DataManager(jsonData);\n            var query = new Query();\n            if (Array.isArray(sortDescriptors)) { //multi-column sorting.\n                if (!sortDescriptors || sortDescriptors.length === 0) {\n                    sortDescriptors = [{ field: header }];\n                }\n                for (var length_1 = sortDescriptors.length, i = length_1 - 1; i > -1; i--) {\n                    if (!sortDescriptors[length_1 - 1].field) {\n                        sortDescriptors[length_1 - 1].field = header;\n                    }\n                    if (!sortDescriptors[i].field) {\n                        continue;\n                    }\n                    var comparerFn = sortDescriptors[i].sortComparer\n                        || _this.sortComparer.bind(_this, sortDescriptors[i], sortOptions.caseSensitive);\n                    query.sortBy(sortDescriptors[i].field, comparerFn);\n                }\n            }\n            else { //single column sorting.\n                if (!sortDescriptors) {\n                    sortDescriptors = { field: header };\n                }\n                if (!sortDescriptors.field) {\n                    sortDescriptors.field = header;\n                }\n                var comparerFn = sortDescriptors.sortComparer\n                    || _this.sortComparer.bind(_this, sortDescriptors, sortOptions.caseSensitive);\n                query.sortBy(sortDescriptors.field, comparerFn);\n            }\n            dataManager.executeQuery(query).then(function (e) {\n                var colName;\n                var cell = {};\n                var rowKey = '__rowIndex';\n                Array.prototype.forEach.call(e.result, function (data, index) {\n                    if (!data) {\n                        return;\n                    }\n                    sCIdx = range[1];\n                    eCIdx = range[3];\n                    sRIdx = parseInt(jsonData[index][rowKey], 10) - 1;\n                    for (sCIdx; sCIdx <= eCIdx; sCIdx++) {\n                        colName = getColumnHeaderText(sCIdx + 1);\n                        cell = data[colName];\n                        setCell(sRIdx, sCIdx, sheet, cell);\n                    }\n                });\n                var eventArgs = { range: sheet.name + \"!\" + address, sortOptions: args.sortOptions };\n                deferred.resolve(eventArgs);\n            });\n        });\n    };\n    WorkbookSort.prototype.isSameStyle = function (firstCellStyle, secondCellStyle) {\n        if (firstCellStyle === void 0) { firstCellStyle = {}; }\n        if (secondCellStyle === void 0) { secondCellStyle = {}; }\n        var sameStyle = true;\n        var keys = Object.keys(firstCellStyle);\n        for (var i = 0; i < keys.length; i++) {\n            if (firstCellStyle[keys[i]] === secondCellStyle[keys[i]] || this.parent.cellStyle[keys[i]] === firstCellStyle[keys[i]]) {\n                sameStyle = true;\n            }\n            else {\n                sameStyle = false;\n                break;\n            }\n        }\n        return sameStyle;\n    };\n    WorkbookSort.prototype.getSortDataRange = function (rowIdx, colIdx, sheet) {\n        var topIdx = rowIdx;\n        var btmIdx = rowIdx;\n        var leftIdx = colIdx;\n        var prevleftIdx;\n        var rightIdx = colIdx;\n        var prevrightIdx;\n        var topReached;\n        var btmReached;\n        var leftReached;\n        var rightReached;\n        for (var i = 1;; i++) {\n            if (!btmReached && getCell(rowIdx + i, colIdx, sheet, null, true).value) {\n                btmIdx = rowIdx + i;\n            }\n            else {\n                btmReached = true;\n            }\n            if (!topReached && getCell(rowIdx - i, colIdx, sheet, null, true).value) {\n                topIdx = rowIdx - i;\n            }\n            else {\n                topReached = true;\n            }\n            if (topReached && btmReached) {\n                break;\n            }\n        }\n        for (var j = 1;; j++) {\n            prevleftIdx = leftIdx;\n            prevrightIdx = rightIdx;\n            for (var i = topIdx; i <= btmIdx; i++) {\n                if (!leftReached && getCell(i, leftIdx - 1, sheet, null, true).value) {\n                    leftIdx = prevleftIdx - 1;\n                }\n                if (!rightReached && getCell(i, rightIdx + 1, sheet, null, true).value) {\n                    rightIdx = prevrightIdx + 1;\n                }\n                if (i === btmIdx) {\n                    if (leftIdx === prevleftIdx) {\n                        leftReached = true;\n                    }\n                    if (rightIdx === prevrightIdx) {\n                        rightReached = true;\n                    }\n                }\n                if (rightReached && leftReached) {\n                    return [topIdx, leftIdx, btmIdx, rightIdx];\n                }\n            }\n        }\n    };\n    /**\n     * Compares the two cells for sorting.\n     * @param sortDescriptor - protocol for sorting.\n     * @param caseSensitive - value for case sensitive.\n     * @param x - first cell\n     * @param y - second cell\n     */\n    WorkbookSort.prototype.sortComparer = function (sortDescriptor, caseSensitive, x, y) {\n        var direction = sortDescriptor.order || '';\n        var comparer = DataUtil.fnSort(direction);\n        var caseOptions = { sensitivity: caseSensitive ? 'case' : 'base' };\n        if (x && y && (typeof x.value === 'string' || typeof y.value === 'string')) {\n            var collator = new Intl.Collator(this.parent.locale, caseOptions);\n            if (!direction || direction.toLowerCase() === 'ascending') {\n                return collator.compare(x.value, y.value);\n            }\n            else {\n                return collator.compare(x.value, y.value) * -1;\n            }\n        }\n        if ((x === null || isNullOrUndefined(x.value)) && (y === null || isNullOrUndefined(y.value))) {\n            return -1;\n        }\n        if (x === null || isNullOrUndefined(x.value)) {\n            return 1;\n        }\n        if (y === null || isNullOrUndefined(y.value)) {\n            return -1;\n        }\n        return comparer(x ? x.value : x, y ? y.value : y);\n    };\n    /**\n     * Gets the module name.\n     * @returns string\n     */\n    WorkbookSort.prototype.getModuleName = function () {\n        return 'workbookSort';\n    };\n    return WorkbookSort;\n}());\nexport { WorkbookSort };\n","import { getData } from '../base/index';\nimport { DataManager, Query, Deferred, Predicate } from '@syncfusion/ej2-data';\nimport { getCellIndexes, getIndexesFromAddress, getSwapRange, getRangeAddress } from '../common/index';\nimport { initiateFilter, clearAllFilter } from '../common/event';\n/**\n * The `WorkbookFilter` module is used to handle filter action in Spreadsheet.\n */\nvar WorkbookFilter = /** @class */ (function () {\n    /**\n     * Constructor for WorkbookFilter module.\n     */\n    function WorkbookFilter(parent) {\n        this.parent = parent;\n        this.addEventListener();\n    }\n    /**\n     * To destroy the filter module.\n     */\n    WorkbookFilter.prototype.destroy = function () {\n        this.removeEventListener();\n        this.filterRange = null;\n        this.parent = null;\n    };\n    WorkbookFilter.prototype.addEventListener = function () {\n        this.parent.on(initiateFilter, this.initiateFilterHandler, this);\n        this.parent.on(clearAllFilter, this.clearAllFilterHandler, this);\n    };\n    WorkbookFilter.prototype.removeEventListener = function () {\n        if (!this.parent.isDestroyed) {\n            this.parent.off(initiateFilter, this.initiateFilterHandler);\n            this.parent.off(clearAllFilter, this.clearAllFilterHandler);\n        }\n    };\n    /**\n     * Filters a range of cells in the sheet.\n     * @param args - arguments for filtering.\n     */\n    WorkbookFilter.prototype.initiateFilterHandler = function (eventArgs) {\n        var _this = this;\n        var args = eventArgs.args;\n        var deferred = new Deferred();\n        var sheet = this.parent.getActiveSheet();\n        var filterOptions = args.filterOptions || {};\n        eventArgs.promise = deferred.promise;\n        this.filterRange = args.range;\n        if (filterOptions.datasource) {\n            this.setFilter(filterOptions.datasource, filterOptions.predicates);\n            var filterEventArgs = { range: args.range, filterOptions: filterOptions };\n            deferred.resolve(filterEventArgs);\n        }\n        else {\n            var range = getSwapRange(getIndexesFromAddress(args.range));\n            if (range[0] > sheet.usedRange.rowIndex || range[1] > sheet.usedRange.colIndex) {\n                deferred.reject('Select a cell or range inside the used range and try again.');\n                return;\n            }\n            if (range[0] === range[2] && (range[2] - range[0]) === 0) { //if selected range is a single cell \n                range[0] = 0;\n                range[1] = 0;\n                range[3] = sheet.usedRange.colIndex;\n            }\n            range[2] = sheet.usedRange.rowIndex; //filter range should be till used range.\n            range[0] = range[0] + 1; //ignore first row        \n            var address_1 = getRangeAddress(range);\n            getData(this.parent, sheet.name + \"!\" + address_1, true, true).then(function (jsonData) {\n                var dataManager = new DataManager(jsonData);\n                _this.setFilter(dataManager, filterOptions.predicates);\n                var filterEventArgs = { range: address_1, filterOptions: filterOptions };\n                deferred.resolve(filterEventArgs);\n            });\n        }\n    };\n    /**\n     * Hides or unhides the rows based on the filter predicates.\n     */\n    WorkbookFilter.prototype.setFilter = function (dataManager, predicates) {\n        var _this = this;\n        if (dataManager && predicates) {\n            var jsonData = dataManager.dataSource.json;\n            var query = new Query();\n            if (predicates.length) {\n                query.where(Predicate.and(predicates));\n            }\n            var result_1 = dataManager.executeLocal(query);\n            var rowKey_1 = '__rowIndex';\n            jsonData.forEach(function (data, index) {\n                if (!data) {\n                    return;\n                }\n                _this.parent.hideRow(parseInt(data[rowKey_1], 10) - 1, undefined, result_1.indexOf(data) < 0);\n            });\n        }\n    };\n    /**\n     * Clears all the filters in the sheet.\n     */\n    WorkbookFilter.prototype.clearAllFilterHandler = function () {\n        if (this.filterRange) {\n            var range = getCellIndexes(this.filterRange);\n            var sheet = this.parent.getActiveSheet();\n            this.parent.hideRow(range[0], sheet.usedRange.rowIndex - 1, false);\n        }\n    };\n    /**\n     * Gets the module name.\n     * @returns string\n     */\n    WorkbookFilter.prototype.getModuleName = function () {\n        return 'workbookFilter';\n    };\n    return WorkbookFilter;\n}());\nexport { WorkbookFilter };\n","import { getRangeIndexes } from '../common/index';\nimport { getCell, setCell, getSheetIndex } from '../base/index';\nimport { setImage } from '../common/event';\n/**\n * Specifies image.\n */\nvar WorkbookImage = /** @class */ (function () {\n    function WorkbookImage(parent) {\n        this.parent = parent;\n        this.addEventListener();\n    }\n    WorkbookImage.prototype.setImage = function (args) {\n        var imgRange = args.range ? (args.range.indexOf('!') > 0) ? args.range.split('!')[1] : args.range.split('!')[0]\n            : this.parent.getActiveSheet().selectedRange;\n        var sheetIdx = (args.range && args.range.indexOf('!') > 0) ?\n            getSheetIndex(this.parent, args.range.split('!')[0]) : this.parent.activeSheetIndex;\n        var indexes = getRangeIndexes(imgRange);\n        var sheet = sheetIdx ? this.parent.sheets[sheetIdx] : this.parent.getActiveSheet();\n        var cell = getCell(indexes[0], indexes[1], sheet);\n        var oldImgData;\n        var imgData = args.options;\n        if (cell && cell.image) {\n            oldImgData = cell.image;\n            for (var i = 0; i < imgData.length; i++) {\n                oldImgData.push(imgData[i]);\n            }\n        }\n        setCell(indexes[0], indexes[1], sheet, { image: (cell && cell.image) ? oldImgData : imgData }, true);\n    };\n    /**\n     * Adding event listener for number format.\n     */\n    WorkbookImage.prototype.addEventListener = function () {\n        this.parent.on(setImage, this.setImage, this);\n    };\n    /**\n     * Removing event listener for number format.\n     */\n    WorkbookImage.prototype.removeEventListener = function () {\n        if (!this.parent.isDestroyed) {\n            this.parent.off(setImage, this.setImage);\n        }\n    };\n    /**\n     * To Remove the event listeners.\n     */\n    WorkbookImage.prototype.destroy = function () {\n        this.removeEventListener();\n        this.parent = null;\n    };\n    /**\n     * Get the workbook number format module name.\n     */\n    WorkbookImage.prototype.getModuleName = function () {\n        return 'workbookImage';\n    };\n    return WorkbookImage;\n}());\nexport { WorkbookImage };\n","import { getRangeIndexes, inRange } from '../common/index';\nimport { setCell, getSheetIndex, getCell, getSheetNameFromAddress } from '../base/index';\nimport { setChart, initiateChart, refreshChart, updateChart, deleteChartColl, refreshChartSize, focusChartBorder } from '../common/event';\nimport { closest, isNullOrUndefined, getComponent } from '@syncfusion/ej2-base';\n/**\n * The `WorkbookChart` module is used to handle chart action in Spreadsheet.\n */\nvar WorkbookChart = /** @class */ (function () {\n    /**\n     * Constructor for WorkbookChart module.\n     */\n    function WorkbookChart(parent) {\n        this.parent = parent;\n        this.addEventListener();\n    }\n    WorkbookChart.prototype.addEventListener = function () {\n        this.parent.on(setChart, this.setChartHandler, this);\n        this.parent.on(refreshChart, this.refreshChartData, this);\n        this.parent.on(deleteChartColl, this.deleteChartColl, this);\n        this.parent.on(refreshChartSize, this.refreshChartSize, this);\n        this.parent.on(focusChartBorder, this.focusChartBorder, this);\n    };\n    WorkbookChart.prototype.removeEventListener = function () {\n        if (!this.parent.isDestroyed) {\n            this.parent.off(setChart, this.setChartHandler);\n            this.parent.off(refreshChart, this.refreshChartData);\n            this.parent.off(deleteChartColl, this.deleteChartColl);\n            this.parent.off(refreshChartSize, this.refreshChartSize);\n            this.parent.off(focusChartBorder, this.focusChartBorder);\n        }\n    };\n    WorkbookChart.prototype.setChartHandler = function (args) {\n        var i = 0;\n        args.isInitCell = isNullOrUndefined(args.isInitCell) ? false : args.isInitCell;\n        args.isUndoRedo = isNullOrUndefined(args.isUndoRedo) ? true : args.isUndoRedo;\n        args.isPaste = isNullOrUndefined(args.isPaste) ? false : args.isPaste;\n        var chart = args.chart;\n        if (chart.length > 0) {\n            while (i < chart.length) {\n                if (args.isCut === false) {\n                    if (document.getElementById(args.chart[i].id)) {\n                        chart[i] = {\n                            range: chart[i].range, id: 'e_spreadsheet_chart_' + this.parent.chartCount,\n                            isSeriesInRows: chart[i].isSeriesInRows, theme: chart[i].theme, type: chart[i].type\n                        };\n                        chart[i].id = 'e_spreadsheet_chart_' + this.parent.chartCount;\n                        args.isIdAvailabe = false;\n                    }\n                }\n                if (document.getElementById(args.chart[i].id)) {\n                    return;\n                }\n                var idAvailable = isNullOrUndefined(args.isIdAvailabe) ? true : args.isIdAvailabe;\n                chart[i].theme = chart[i].theme || 'Material';\n                chart[i].type = chart[i].type || 'Line';\n                chart[i].isSeriesInRows = chart[i].isSeriesInRows || false;\n                chart[i].range = chart[i].range || this.parent.getActiveSheet().selectedRange;\n                if (chart[i].range.indexOf('!') < 0) {\n                    chart[i].range = this.parent.getActiveSheet().name + '!' + chart[i].range;\n                }\n                if (isNullOrUndefined(chart[i].id)) {\n                    chart[i].id = 'e_spreadsheet_chart_' + this.parent.chartCount;\n                    idAvailable = false;\n                }\n                chart[i].height = chart[i].height || 290;\n                chart[i].width = chart[i].width || 480;\n                this.parent.notify(initiateChart, {\n                    option: chart[i], chartCount: this.parent.chartCount, isInitCell: args.isInitCell, isUndoRedo: args.isUndoRedo,\n                    dataSheetIdx: args.dataSheetIdx, range: args.range\n                });\n                this.parent.chartColl.push(chart[i]);\n                if (!idAvailable) {\n                    this.parent.chartCount++;\n                }\n                if (!args.isInitCell || args.isPaste) {\n                    var sheetIdx = (chart[i].range && chart[i].range.indexOf('!') > 0) ?\n                        getSheetIndex(this.parent, chart[i].range.split('!')[0]) : this.parent.activeSheetIndex;\n                    var indexes = args.isPaste ? getRangeIndexes(args.range) : getRangeIndexes(chart[i].range);\n                    var sheet = sheetIdx ? this.parent.sheets[sheetIdx] : this.parent.getActiveSheet();\n                    var cell = getCell(indexes[0], indexes[1], sheet);\n                    if (cell && cell.chart) {\n                        cell.chart.push(chart[i]);\n                    }\n                    else {\n                        setCell(indexes[0], indexes[1], sheet, { chart: [chart[i]] }, true);\n                    }\n                }\n                i++;\n            }\n        }\n    };\n    WorkbookChart.prototype.refreshChartData = function (args) {\n        var i;\n        var j = 1;\n        var cnt = this.parent.sheets.length + 1;\n        while (j < cnt) {\n            var charts = this.parent.chartColl;\n            i = charts ? charts.length : 0;\n            if (i) {\n                while (i--) {\n                    var chart = this.parent.chartColl[i];\n                    var isInRange = inRange(getRangeIndexes(chart.range), args.rIdx, args.cIdx);\n                    var rangeSheetIdx = chart.range.indexOf('!') > -1 ?\n                        getSheetIndex(this.parent, getSheetNameFromAddress(chart.range)) : this.parent.activeSheetIndex;\n                    if (isInRange && rangeSheetIdx === this.parent.activeSheetIndex) {\n                        this.parent.notify(updateChart, { chart: chart });\n                    }\n                }\n            }\n            j++;\n        }\n    };\n    WorkbookChart.prototype.refreshChartSize = function (args) {\n        var chartCnt;\n        var j = 1;\n        var sheetCnt = this.parent.sheets.length + 1;\n        while (j < sheetCnt) {\n            var charts = this.parent.chartColl;\n            chartCnt = charts ? charts.length : 0;\n            if (chartCnt) {\n                while (chartCnt--) {\n                    var chart = this.parent.chartColl[chartCnt];\n                    if (!isNullOrUndefined(args.overlayEle.querySelector('#' + chart.id))) {\n                        var chartObj = this.parent.element.querySelector('.' + chart.id);\n                        var excelFilter = getComponent(chartObj, 'chart');\n                        excelFilter.height = args.height;\n                        excelFilter.width = args.width;\n                    }\n                }\n            }\n            j++;\n        }\n    };\n    WorkbookChart.prototype.focusChartBorder = function (args) {\n        for (var idx = 0; idx < this.parent.chartColl.length; idx++) {\n            var overlayEle = document.getElementById(args.id);\n            var chartEle = document.getElementById(this.parent.chartColl[idx].id);\n            if (overlayEle && chartEle && closest(chartEle, '.' + overlayEle.classList[1]) === overlayEle) {\n                this.parent.notify(initiateChart, {\n                    option: this.parent.chartColl[idx], chartCount: this.parent.chartCount, isRefresh: true\n                });\n            }\n        }\n    };\n    WorkbookChart.prototype.deleteChartColl = function (args) {\n        for (var idx = 0; idx < this.parent.chartColl.length; idx++) {\n            var chartElement = document.getElementById(this.parent.chartColl[idx].id);\n            var overlayElement = document.getElementById(args.id);\n            if (overlayElement && chartElement && closest(chartElement, '.' + overlayElement.classList[1]) === overlayElement) {\n                this.parent.chartColl.splice(idx, 1);\n            }\n        }\n    };\n    /**\n     * To Remove the event listeners.\n     */\n    WorkbookChart.prototype.destroy = function () {\n        this.removeEventListener();\n        this.parent = null;\n    };\n    /**\n     * Get the workbook chart module name.\n     */\n    WorkbookChart.prototype.getModuleName = function () {\n        return 'workbookChart';\n    };\n    return WorkbookChart;\n}());\nexport { WorkbookChart };\n","import { getRangeIndexes, setCellFormat, applyCellFormat, activeCellChanged } from '../common/index';\nimport { getSwapRange, textDecorationUpdate } from '../common/index';\nimport { clear, getIndexesFromAddress } from '../common/index';\nimport { getSheetIndex, isHiddenRow, getSheet, getCell, setCell } from '../base/index';\n/**\n * Workbook Cell format.\n */\nvar WorkbookCellFormat = /** @class */ (function () {\n    function WorkbookCellFormat(parent) {\n        this.parent = parent;\n        this.addEventListener();\n    }\n    WorkbookCellFormat.prototype.format = function (args) {\n        var sheet;\n        var rng = args.range;\n        var eventArgs;\n        if (rng && typeof rng === 'string' && rng.indexOf('!') > -1) {\n            rng = rng.split('!')[1];\n            sheet = this.parent.sheets[getSheetIndex(this.parent, args.range.split('!')[0])];\n        }\n        else {\n            sheet = this.parent.getActiveSheet();\n        }\n        if (rng === undefined) {\n            rng = sheet.selectedRange;\n        }\n        var triggerEvent = typeof (rng) !== 'object' && args.onActionUpdate;\n        eventArgs = { range: rng, style: args.style, requestType: 'CellFormat' };\n        if (triggerEvent) {\n            this.parent.trigger('beforeCellFormat', eventArgs);\n            this.parent.notify('actionBegin', { eventArgs: eventArgs, action: 'format' });\n            if (eventArgs.cancel) {\n                args.cancel = true;\n                return;\n            }\n        }\n        var indexes = typeof (eventArgs.range) === 'object' ? eventArgs.range :\n            getSwapRange(getRangeIndexes(eventArgs.range));\n        if (args.borderType) {\n            this.setTypedBorder(sheet, args.style.border, indexes, args.borderType, args.onActionUpdate);\n            delete args.style.border;\n        }\n        if (eventArgs.style.borderTop !== undefined) {\n            for (var i = indexes[1]; i <= indexes[3]; i++) {\n                this.checkAdjustantBorder(sheet, 'borderBottom', indexes[0] - 1, i);\n                this.checkFullBorder(sheet, 'borderBottom', indexes[0] - 1, i);\n                this.checkFullBorder(sheet, 'borderTop', indexes[0], i);\n                this.setCellBorder(sheet, { borderTop: eventArgs.style.borderTop }, indexes[0], i, args.onActionUpdate, i === indexes[3]);\n            }\n            delete eventArgs.style.borderTop;\n        }\n        if (eventArgs.style.borderBottom !== undefined) {\n            for (var i = indexes[1]; i <= indexes[3]; i++) {\n                this.checkAdjustantBorder(sheet, 'borderTop', indexes[2] + 1, i);\n                this.checkFullBorder(sheet, 'borderTop', indexes[2] + 1, i);\n                this.checkFullBorder(sheet, 'borderBottom', indexes[2], i);\n                this.setCellBorder(sheet, { borderBottom: eventArgs.style.borderBottom }, indexes[2], i, args.onActionUpdate, i === indexes[3]);\n                this.setBottomBorderPriority(sheet, indexes[2], i);\n            }\n            delete eventArgs.style.borderBottom;\n        }\n        if (eventArgs.style.borderLeft !== undefined) {\n            for (var i = indexes[0]; i <= indexes[2]; i++) {\n                this.checkAdjustantBorder(sheet, 'borderRight', i, indexes[1] - 1);\n                this.checkFullBorder(sheet, 'borderRight', i, indexes[1] - 1);\n                this.checkFullBorder(sheet, 'borderLeft', i, indexes[1]);\n                this.setCellBorder(sheet, { borderLeft: eventArgs.style.borderLeft }, i, indexes[1], args.onActionUpdate);\n            }\n            delete eventArgs.style.borderLeft;\n        }\n        if (eventArgs.style.borderRight !== undefined) {\n            for (var i = indexes[0]; i <= indexes[2]; i++) {\n                this.checkAdjustantBorder(sheet, 'borderLeft', i, indexes[3] - 1);\n                this.checkFullBorder(sheet, 'borderLeft', i, indexes[3] - 1);\n                this.checkFullBorder(sheet, 'borderRight', i, indexes[3]);\n                this.setCellBorder(sheet, { borderRight: eventArgs.style.borderRight }, i, indexes[3], args.onActionUpdate);\n            }\n            delete eventArgs.style.borderRight;\n        }\n        var border;\n        var isFullBorder;\n        if (Object.keys(args.style).length) {\n            for (var i = indexes[0]; i <= indexes[2]; i++) {\n                for (var j = indexes[1]; j <= indexes[3]; j++) {\n                    if (isFullBorder === undefined) {\n                        if (eventArgs.style.border !== undefined) {\n                            border = eventArgs.style.border;\n                            eventArgs.style.border = undefined;\n                            isFullBorder = true;\n                        }\n                        else {\n                            isFullBorder = false;\n                        }\n                    }\n                    if (isFullBorder) {\n                        this.setFullBorder(sheet, border, indexes, i, j, args.onActionUpdate);\n                    }\n                    this.setCellStyle(sheet, i, j, eventArgs.style);\n                    if (this.parent.getActiveSheet().id === sheet.id) {\n                        this.parent.notify(applyCellFormat, { style: eventArgs.style, rowIdx: i, colIdx: j,\n                            lastCell: j === indexes[3], isHeightCheckNeeded: true, manualUpdate: true, onActionUpdate: args.onActionUpdate\n                        });\n                    }\n                }\n            }\n        }\n        if (isFullBorder) {\n            eventArgs.style.border = border;\n        }\n        this.parent.setUsedRange(indexes[2], indexes[3]);\n        if (args.refreshRibbon) {\n            this.parent.notify(activeCellChanged, null);\n        }\n        if (triggerEvent) {\n            eventArgs.range = sheet.name + \"!\" + rng;\n            this.parent.notify('actionComplete', { eventArgs: eventArgs, action: 'format' });\n        }\n    };\n    WorkbookCellFormat.prototype.setBottomBorderPriority = function (sheet, rowIdx, colIdx) {\n        if (isHiddenRow(sheet, rowIdx + 1)) {\n            var pIdx = this.skipHiddenRows(sheet, rowIdx + 1);\n            var pCellStyle = this.parent.getCellStyleValue(['borderTop'], [pIdx, colIdx]).borderTop;\n            if (pCellStyle !== '') {\n                sheet.rows[rowIdx].cells[colIdx].style.bottomPriority = true;\n            }\n        }\n    };\n    WorkbookCellFormat.prototype.setFullBorder = function (sheet, border, indexes, i, j, actionUpdate) {\n        var style = {};\n        if (i === indexes[0]) {\n            this.checkAdjustantBorder(sheet, 'borderBottom', i - 1, j);\n            this.checkFullBorder(sheet, 'borderBottom', i - 1, j);\n        }\n        if (j === indexes[1]) {\n            this.checkAdjustantBorder(sheet, 'borderRight', i, j - 1);\n            this.checkFullBorder(sheet, 'borderRight', i, j - 1);\n        }\n        if (j === indexes[3]) {\n            this.checkAdjustantBorder(sheet, 'borderLeft', i, j + 1);\n            this.checkFullBorder(sheet, 'borderLeft', i, j + 1);\n        }\n        else {\n            this.checkAdjustantBorder(sheet, 'border', i, j + 1);\n        }\n        style.borderRight = border;\n        style.borderTop = border;\n        style.borderLeft = border;\n        style.borderBottom = border;\n        this.setCellBorder(sheet, style, i, j, actionUpdate, j === indexes[3]);\n        if (i === indexes[2]) {\n            this.checkAdjustantBorder(sheet, 'borderTop', i + 1, j);\n            this.checkFullBorder(sheet, 'borderTop', i + 1, j);\n            this.setBottomBorderPriority(sheet, i, j);\n        }\n        else {\n            this.checkAdjustantBorder(sheet, 'border', i + 1, j);\n        }\n    };\n    WorkbookCellFormat.prototype.checkAdjustantBorder = function (sheet, prop, rowIdx, colIdx) {\n        var style = {};\n        if (this.parent.getCellStyleValue([prop], [rowIdx, colIdx])[prop] !== '') {\n            style[prop] = undefined;\n            this.setCellStyle(sheet, rowIdx, colIdx, style);\n        }\n    };\n    WorkbookCellFormat.prototype.checkFullBorder = function (sheet, prop, rowIdx, colIdx) {\n        var border = this.parent.getCellStyleValue(['border'], [rowIdx, colIdx]).border;\n        if (border !== '') {\n            var style_1 = { border: undefined };\n            ['borderBottom', 'borderTop', 'borderLeft', 'borderRight'].forEach(function (value) {\n                if (value !== prop) {\n                    style_1[value] = border;\n                }\n            });\n            this.setCellStyle(sheet, rowIdx, colIdx, style_1);\n        }\n    };\n    WorkbookCellFormat.prototype.textDecorationActionUpdate = function (args) {\n        var sheet = this.parent.getActiveSheet();\n        var eventArgs = { range: sheet.selectedRange, style: args.style, requestType: 'CellFormat' };\n        this.parent.trigger('beforeCellFormat', eventArgs);\n        this.parent.notify('actionBegin', { eventArgs: eventArgs, action: 'format' });\n        if (eventArgs.cancel) {\n            args.cancel = true;\n            return;\n        }\n        var indexes = getSwapRange(getRangeIndexes(sheet.selectedRange));\n        var value = args.style.textDecoration;\n        var changedValue = value;\n        var activeCellIndexes = getRangeIndexes(sheet.activeCell);\n        var cellValue = this.parent.getCellStyleValue(['textDecoration'], activeCellIndexes).textDecoration;\n        var changedStyle;\n        var removeProp = false;\n        if (cellValue === 'underline') {\n            changedValue = value === 'underline' ? 'none' : 'underline line-through';\n        }\n        else if (cellValue === 'line-through') {\n            changedValue = value === 'line-through' ? 'none' : 'underline line-through';\n        }\n        else if (cellValue === 'underline line-through') {\n            changedValue = value === 'underline' ? 'line-through' : 'underline';\n            removeProp = true;\n        }\n        if (changedValue === 'none') {\n            removeProp = true;\n        }\n        this.format({\n            style: { textDecoration: changedValue }, range: activeCellIndexes, refreshRibbon: args.refreshRibbon,\n            onActionUpdate: true\n        });\n        for (var i = indexes[0]; i <= indexes[2]; i++) {\n            for (var j = indexes[1]; j <= indexes[3]; j++) {\n                if (i === activeCellIndexes[0] && j === activeCellIndexes[1]) {\n                    continue;\n                }\n                changedStyle = {};\n                cellValue = this.parent.getCellStyleValue(['textDecoration'], [i, j]).textDecoration;\n                if (cellValue === 'none') {\n                    if (removeProp) {\n                        continue;\n                    }\n                    changedStyle.textDecoration = value;\n                }\n                else if (cellValue === 'underline' || cellValue === 'line-through') {\n                    if (removeProp) {\n                        if (value === cellValue) {\n                            changedStyle.textDecoration = 'none';\n                        }\n                        else {\n                            continue;\n                        }\n                    }\n                    else {\n                        changedStyle.textDecoration = value !== cellValue ? 'underline line-through' : value;\n                    }\n                }\n                else if (cellValue === 'underline line-through') {\n                    if (removeProp) {\n                        changedStyle.textDecoration = value === 'underline' ? 'line-through' : 'underline';\n                    }\n                    else {\n                        continue;\n                    }\n                }\n                this.format({\n                    style: changedStyle, range: [i, j, i, j], refreshRibbon: args.refreshRibbon,\n                    onActionUpdate: true\n                });\n            }\n        }\n        eventArgs.range = sheet.name + '!' + eventArgs.range;\n        this.parent.notify('actionComplete', { eventArgs: eventArgs, action: 'format' });\n    };\n    WorkbookCellFormat.prototype.setTypedBorder = function (sheet, border, range, type, actionUpdate) {\n        var prevBorder;\n        if (type === 'Outer') {\n            for (var colIdx = range[1]; colIdx <= range[3]; colIdx++) {\n                this.checkAdjustantBorder(sheet, 'borderBottom', range[0] - 1, colIdx);\n                this.checkFullBorder(sheet, 'borderBottom', range[0] - 1, colIdx);\n                this.setCellBorder(sheet, { borderTop: border }, range[0], colIdx, actionUpdate, colIdx === range[3]);\n                this.checkAdjustantBorder(sheet, 'borderTop', range[2] + 1, colIdx);\n                this.checkFullBorder(sheet, 'borderTop', range[2] + 1, colIdx);\n                this.setCellBorder(sheet, { borderBottom: border }, range[2], colIdx, actionUpdate, colIdx === range[3]);\n                this.setBottomBorderPriority(sheet, range[2], colIdx);\n            }\n            for (var rowIdx = range[0]; rowIdx <= range[2]; rowIdx++) {\n                this.checkAdjustantBorder(sheet, 'borderRight', rowIdx, range[1] - 1);\n                this.checkFullBorder(sheet, 'borderRight', rowIdx, range[1] - 1);\n                this.setCellBorder(sheet, { borderLeft: border }, rowIdx, range[1], actionUpdate);\n                this.checkAdjustantBorder(sheet, 'borderLeft', rowIdx, range[3] + 1);\n                this.checkFullBorder(sheet, 'borderLeft', rowIdx, range[3] + 1);\n                this.setCellBorder(sheet, { borderRight: border }, rowIdx, range[3], actionUpdate);\n            }\n        }\n        else if (type === 'Inner') {\n            for (var i = range[0]; i <= range[2]; i++) {\n                for (var j = range[1]; j <= range[3]; j++) {\n                    var style = {};\n                    prevBorder = this.parent.getCellStyleValue(['border'], [i, j]).border;\n                    if (prevBorder !== '') {\n                        style.border = undefined;\n                        if (j === range[3] || j === range[1] || i === range[0] || i === range[2]) {\n                            if (i === range[0]) {\n                                style.borderTop = prevBorder;\n                            }\n                            if (i === range[2]) {\n                                style.borderBottom = prevBorder;\n                            }\n                            if (j === range[3]) {\n                                style.borderRight = prevBorder;\n                            }\n                            if (j === range[1]) {\n                                style.borderLeft = prevBorder;\n                            }\n                        }\n                    }\n                    if (j !== range[3]) {\n                        style.borderRight = border;\n                    }\n                    if (i !== range[0]) {\n                        style.borderTop = border;\n                    }\n                    if (i !== range[2]) {\n                        style.borderBottom = border;\n                    }\n                    if (j !== range[1]) {\n                        style.borderLeft = border;\n                    }\n                    this.setCellBorder(sheet, style, i, j, actionUpdate, j === range[3]);\n                }\n            }\n        }\n        else if (type === 'Vertical') {\n            for (var i = range[0]; i <= range[2]; i++) {\n                for (var j = range[1]; j <= range[3]; j++) {\n                    var style = { borderRight: border, borderLeft: border };\n                    if (j === range[1]) {\n                        this.checkAdjustantBorder(sheet, 'borderRight', i, j - 1);\n                        this.checkFullBorder(sheet, 'borderRight', i, j - 1);\n                    }\n                    if (j === range[3]) {\n                        this.checkAdjustantBorder(sheet, 'borderLeft', i, j + 1);\n                        this.checkFullBorder(sheet, 'borderLeft', i, j + 1);\n                    }\n                    this.setCellBorder(sheet, style, i, j, actionUpdate);\n                }\n            }\n        }\n        else {\n            for (var i = range[0]; i <= range[2]; i++) {\n                for (var j = range[1]; j <= range[3]; j++) {\n                    var style = { borderTop: border, borderBottom: border };\n                    if (i === range[0]) {\n                        this.checkAdjustantBorder(sheet, 'borderBottom', i - 1, j);\n                        this.checkFullBorder(sheet, 'borderBottom', i - 1, j);\n                    }\n                    this.setCellBorder(sheet, style, i, j, actionUpdate, j === range[3]);\n                    if (i === range[2]) {\n                        this.checkAdjustantBorder(sheet, 'borderTop', i + 1, j);\n                        this.checkFullBorder(sheet, 'borderTop', i + 1, j);\n                        this.setBottomBorderPriority(sheet, i, j);\n                    }\n                }\n            }\n        }\n    };\n    WorkbookCellFormat.prototype.setCellBorder = function (sheet, style, rowIdx, colIdx, actionUpdate, lastCell) {\n        this.setCellStyle(sheet, rowIdx, colIdx, style);\n        if (this.parent.getActiveSheet().id === sheet.id) {\n            this.parent.notify(applyCellFormat, {\n                style: style, rowIdx: rowIdx, colIdx: colIdx, onActionUpdate: actionUpdate, first: '', lastCell: lastCell,\n                isHeightCheckNeeded: true, manualUpdate: true\n            });\n        }\n    };\n    WorkbookCellFormat.prototype.setCellStyle = function (sheet, rowIdx, colIdx, style) {\n        if (!sheet.rows[rowIdx]) {\n            sheet.rows[rowIdx] = { cells: [] };\n        }\n        else if (!sheet.rows[rowIdx].cells) {\n            sheet.rows[rowIdx].cells = [];\n        }\n        if (!sheet.rows[rowIdx].cells[colIdx]) {\n            sheet.rows[rowIdx].cells[colIdx] = {};\n        }\n        if (!sheet.rows[rowIdx].cells[colIdx].style) {\n            sheet.rows[rowIdx].cells[colIdx].style = {};\n        }\n        Object.assign(sheet.rows[rowIdx].cells[colIdx].style, style, null, true);\n    };\n    WorkbookCellFormat.prototype.skipHiddenRows = function (sheet, startIdx) {\n        startIdx++;\n        if (isHiddenRow(sheet, startIdx)) {\n            startIdx = this.skipHiddenRows(sheet, startIdx);\n        }\n        return startIdx;\n    };\n    WorkbookCellFormat.prototype.addEventListener = function () {\n        this.parent.on(setCellFormat, this.format, this);\n        this.parent.on(textDecorationUpdate, this.textDecorationActionUpdate, this);\n        this.parent.on(clear, this.clearCellObj, this);\n    };\n    WorkbookCellFormat.prototype.removeEventListener = function () {\n        if (!this.parent.isDestroyed) {\n            this.parent.off(setCellFormat, this.format);\n            this.parent.off(textDecorationUpdate, this.textDecorationActionUpdate);\n            this.parent.off(clear, this.clearCellObj);\n        }\n    };\n    WorkbookCellFormat.prototype.clearCellObj = function (options) {\n        var clrRange = options.range ? (options.range.indexOf('!') > 0) ? options.range.split('!')[1] : options.range.split('!')[0]\n            : this.parent.getActiveSheet().selectedRange;\n        var sheetIdx = (options.range && options.range.indexOf('!') > 0) ?\n            getSheetIndex(this.parent, options.range.split('!')[0]) : this.parent.activeSheetIndex;\n        var sheet = getSheet(this.parent, sheetIdx);\n        var range = getIndexesFromAddress(clrRange);\n        var sRowIdx = range[0];\n        var eRowIdx = range[2];\n        var sColIdx;\n        var eColIdx;\n        for (sRowIdx; sRowIdx <= eRowIdx; sRowIdx++) {\n            sColIdx = range[1];\n            eColIdx = range[3];\n            for (sColIdx; sColIdx <= eColIdx; sColIdx++) {\n                var cell = getCell(sRowIdx, sColIdx, sheet);\n                if (cell) {\n                    switch (options.type) {\n                        case 'Clear Formats':\n                            delete cell.format;\n                            delete cell.rowSpan;\n                            delete cell.style;\n                            delete cell.wrap;\n                            delete cell.colSpan;\n                            break;\n                        case 'Clear Contents':\n                            delete cell.value;\n                            delete cell.formula;\n                            break;\n                        case 'Clear Hyperlinks':\n                            delete cell.hyperlink;\n                            break;\n                        case 'Clear All':\n                            setCell(sRowIdx, sColIdx, sheet, {}, false);\n                            break;\n                    }\n                }\n            }\n        }\n    };\n    /**\n     * To destroy workbook cell format.\n     */\n    WorkbookCellFormat.prototype.destroy = function () {\n        this.removeEventListener();\n        this.parent = null;\n    };\n    /**\n     * Get the workbook cell format module name.\n     */\n    WorkbookCellFormat.prototype.getModuleName = function () {\n        return 'workbookcellformat';\n    };\n    return WorkbookCellFormat;\n}());\nexport { WorkbookCellFormat };\n","import { getCell, getSheet } from '../base/index';\nimport { workbookEditOperation, checkDateFormat, workbookFormulaOperation, refreshChart } from '../common/event';\nimport { getRangeIndexes } from '../common/index';\nimport { isNullOrUndefined, getNumericObject } from '@syncfusion/ej2-base';\nimport { checkIsFormula } from '../../workbook/common/index';\nimport { getTypeFromFormat } from '../integrations/index';\n/**\n * The `WorkbookEdit` module is used to handle the editing functionalities in Workbook.\n */\nvar WorkbookEdit = /** @class */ (function () {\n    /**\n     * Constructor for edit module in Workbook.\n     * @private\n     */\n    function WorkbookEdit(workbook) {\n        this.parent = workbook;\n        this.localeObj = getNumericObject(this.parent.locale);\n        /* tslint:disable:no-any */\n        this.decimalSep = this.localeObj.decimal;\n        this.addEventListener();\n    }\n    /**\n     * To destroy the edit module.\n     * @return {void}\n     * @hidden\n     */\n    WorkbookEdit.prototype.destroy = function () {\n        this.removeEventListener();\n        this.parent = null;\n    };\n    WorkbookEdit.prototype.addEventListener = function () {\n        this.parent.on(workbookEditOperation, this.performEditOperation, this);\n    };\n    WorkbookEdit.prototype.removeEventListener = function () {\n        if (!this.parent.isDestroyed) {\n            this.parent.off(workbookEditOperation, this.performEditOperation);\n        }\n    };\n    /**\n     * Get the module name.\n     * @returns string\n     * @private\n     */\n    WorkbookEdit.prototype.getModuleName = function () {\n        return 'workbookEdit';\n    };\n    WorkbookEdit.prototype.performEditOperation = function (args) {\n        var action = args.action;\n        switch (action) {\n            case 'updateCellValue':\n                this.updateCellValue(args.address, args.value, args.sheetIndex, args.isValueOnly);\n                break;\n        }\n    };\n    WorkbookEdit.prototype.checkDecimalPoint = function (value) {\n        if (Number(value)) {\n            var decIndex = value.toString().indexOf(this.decimalSep) + 1;\n            var checkDec = value.toString().substr(decIndex).length <= 6;\n            value = checkDec ? decIndex < 7 ? value : (parseFloat(value)).toFixed(0) : decIndex > 7 ? (parseFloat(value)).toFixed(0) :\n                (parseFloat(value)).toFixed(6 - decIndex + 2);\n        }\n        return value;\n    };\n    WorkbookEdit.prototype.updateCellValue = function (address, value, sheetIdx, isValueOnly) {\n        if (isValueOnly === void 0) { isValueOnly = false; }\n        if (sheetIdx === undefined) {\n            sheetIdx = this.parent.activeSheetIndex;\n        }\n        var range;\n        if (typeof address === 'string') {\n            range = getRangeIndexes(address);\n        }\n        else {\n            range = address;\n        }\n        var sheet = getSheet(this.parent, sheetIdx);\n        if (!sheet.rows[range[0]]) {\n            sheet.rows[range[0]] = {};\n            sheet.rows[range[0]].cells = [];\n        }\n        if (!sheet.rows[range[0]].cells) {\n            sheet.rows[range[0]].cells = [];\n        }\n        if (!sheet.rows[range[0]].cells[range[1]]) {\n            sheet.rows[range[0]].cells[range[1]] = {};\n        }\n        var cell = getCell(range[0], range[1], sheet);\n        if (!isValueOnly) {\n            var isFormula = checkIsFormula(value);\n            if (!isFormula) {\n                cell.formula = '';\n                cell.value = this.parseIntValue(value);\n            }\n            var eventArgs = {\n                action: 'refreshCalculate',\n                value: value,\n                rowIndex: range[0],\n                colIndex: range[1],\n                sheetIndex: sheetIdx,\n                isFormula: isFormula\n            };\n            this.parent.notify(workbookFormulaOperation, eventArgs);\n            if (isFormula) {\n                cell.formula = eventArgs.value;\n                value = cell.value;\n            }\n            if (getTypeFromFormat(cell.format) !== 'Text') {\n                var dateEventArgs = {\n                    value: value,\n                    rowIndex: range[0],\n                    colIndex: range[1],\n                    sheetIndex: sheetIdx,\n                    updatedVal: ''\n                };\n                this.parent.notify(checkDateFormat, dateEventArgs);\n                if (!isNullOrUndefined(dateEventArgs.updatedVal) && dateEventArgs.updatedVal.length > 0) {\n                    cell.value = dateEventArgs.updatedVal;\n                }\n            }\n        }\n        else {\n            if (value && value.toString().indexOf(this.decimalSep) > -1) {\n                value = this.checkDecimalPoint(value);\n            }\n            cell.value = value;\n        }\n        this.parent.setUsedRange(range[0], range[1]);\n        if (this.parent.allowChart) {\n            this.parent.notify(refreshChart, { cell: cell, rIdx: range[0], cIdx: range[1], sheetIdx: sheetIdx });\n        }\n    };\n    WorkbookEdit.prototype.parseIntValue = function (value) {\n        return (value && /^\\d*\\.?\\d*$/.test(value)) ? parseFloat(value) : value;\n    };\n    return WorkbookEdit;\n}());\nexport { WorkbookEdit };\n","import { setLinkModel } from '../common/event';\nimport { getRangeIndexes } from '../common/address';\nimport { isNullOrUndefined } from '@syncfusion/ej2-base';\n/**\n * The `WorkbookHyperlink` module is used to handle Hyperlink action in Spreadsheet.\n */\nvar WorkbookHyperlink = /** @class */ (function () {\n    /**\n     * Constructor for WorkbookSort module.\n     */\n    function WorkbookHyperlink(parent) {\n        this.parent = parent;\n        this.addEventListener();\n    }\n    /**\n     * To destroy the sort module.\n     */\n    WorkbookHyperlink.prototype.destroy = function () {\n        this.removeEventListener();\n        this.parent = null;\n    };\n    WorkbookHyperlink.prototype.addEventListener = function () {\n        this.parent.on(setLinkModel, this.setLinkHandler, this);\n    };\n    WorkbookHyperlink.prototype.removeEventListener = function () {\n        if (!this.parent.isDestroyed) {\n            this.parent.off(setLinkModel, this.setLinkHandler);\n        }\n    };\n    WorkbookHyperlink.prototype.setLinkHandler = function (args) {\n        var hyperlink = args.hyperlink;\n        var cellAddr = args.cell;\n        var range;\n        var sheetIdx;\n        var cellIdx;\n        var sheet = this.parent.getActiveSheet();\n        var address;\n        if (cellAddr && cellAddr.indexOf('!') !== -1) {\n            range = cellAddr.split('!');\n            var sheets = this.parent.sheets;\n            for (var idx = 0; idx < sheets.length; idx++) {\n                if (sheets[idx].name === range[0]) {\n                    sheetIdx = idx;\n                }\n            }\n            sheet = this.parent.sheets[sheetIdx];\n            cellAddr = range[1];\n        }\n        cellAddr = cellAddr ? cellAddr : this.parent.getActiveSheet().activeCell;\n        cellIdx = getRangeIndexes(cellAddr);\n        var rowIdx = cellIdx[0];\n        var colIdx = cellIdx[1];\n        if (!sheet) {\n            return;\n        }\n        if (isNullOrUndefined(sheet.rows[rowIdx])) {\n            sheet.rows[rowIdx] = {};\n        }\n        if (isNullOrUndefined(sheet.rows[rowIdx].cells)) {\n            sheet.rows[rowIdx].cells = [];\n        }\n        if (isNullOrUndefined(sheet.rows[rowIdx].cells[colIdx])) {\n            sheet.rows[rowIdx].cells[colIdx] = {};\n        }\n        if (typeof (hyperlink) === 'string') {\n            if (hyperlink.indexOf('http://') !== 0 && hyperlink.indexOf('https://') !== 0 && hyperlink.indexOf('ftp://') !== 0) {\n                hyperlink = hyperlink.toLowerCase().indexOf('www.') === 0 ? 'http://' + hyperlink : hyperlink;\n                address = hyperlink;\n            }\n            sheet.rows[rowIdx].cells[colIdx].hyperlink = hyperlink;\n        }\n        else {\n            address = hyperlink.address;\n            if (address.indexOf('http://') !== 0 && address.indexOf('https://') !== 0 && address.indexOf('ftp://') !== 0) {\n                address = address.toLowerCase().indexOf('www.') === 0 ? 'http://' + address : address;\n            }\n            sheet.rows[rowIdx].cells[colIdx].hyperlink = {\n                address: address,\n            };\n        }\n    };\n    /**\n     * Gets the module name.\n     * @returns string\n     */\n    WorkbookHyperlink.prototype.getModuleName = function () {\n        return 'workbookHyperlink';\n    };\n    return WorkbookHyperlink;\n}());\nexport { WorkbookHyperlink };\n","import { insert, insertModel, workbookFormulaOperation, } from '../../workbook/common/index';\nimport { insertMerge } from '../../workbook/common/index';\n/**\n * The `WorkbookInsert` module is used to insert cells, rows, columns and sheets in to workbook.\n */\nvar WorkbookInsert = /** @class */ (function () {\n    /**\n     * Constructor for the workbook insert module.\n     * @private\n     */\n    function WorkbookInsert(parent) {\n        this.parent = parent;\n        this.addEventListener();\n    }\n    WorkbookInsert.prototype.insertModel = function (args) {\n        var _this = this;\n        var _a, _b, _c;\n        var index;\n        var model = [];\n        var mergeCollection;\n        var isModel;\n        if (typeof (args.start) === 'number') {\n            index = args.start;\n            args.end = args.end || index;\n            if (index > args.end) {\n                index = args.end;\n                args.end = args.start;\n            }\n            for (var i = index; i <= args.end; i++) {\n                model.push({});\n            }\n        }\n        else {\n            if (args.start) {\n                index = args.start[0].index || 0;\n                model = args.start;\n                isModel = true;\n            }\n            else {\n                index = 0;\n                model.push({});\n            }\n        }\n        if (args.modelType === 'Row') {\n            args.model = args.model;\n            if (!args.model.rows) {\n                args.model.rows = [];\n            }\n            (_a = args.model.rows).splice.apply(_a, [index, 0].concat(model));\n            //this.setInsertInfo(args.model, index, model.length, 'count');\n            if (index > args.model.usedRange.rowIndex) {\n                this.parent.setUsedRange(index + (model.length - 1), args.model.usedRange.colIndex);\n            }\n            else {\n                this.parent.setUsedRange(args.model.usedRange.rowIndex + model.length, args.model.usedRange.colIndex);\n            }\n            var curIdx = index + model.length;\n            for (var i = 0; i <= args.model.usedRange.colIndex; i++) {\n                if (args.model.rows[curIdx] && args.model.rows[curIdx].cells && args.model.rows[curIdx].cells[i] &&\n                    args.model.rows[curIdx].cells[i].rowSpan !== undefined && args.model.rows[curIdx].cells[i].rowSpan < 0 &&\n                    args.model.rows[curIdx].cells[i].colSpan === undefined) {\n                    this.parent.notify(insertMerge, {\n                        range: [curIdx, i, curIdx, i], insertCount: model.length,\n                        insertModel: 'Row'\n                    });\n                }\n            }\n        }\n        else if (args.modelType === 'Column') {\n            args.model = args.model;\n            if (!args.model.columns) {\n                args.model.columns = [];\n            }\n            (_b = args.model.columns).splice.apply(_b, [index, 0].concat(model));\n            //this.setInsertInfo(args.model, index, model.length, 'fldLen', 'Column');\n            if (index > args.model.usedRange.colIndex) {\n                this.parent.setUsedRange(args.model.usedRange.rowIndex, index + (model.length - 1));\n            }\n            else {\n                this.parent.setUsedRange(args.model.usedRange.rowIndex, args.model.usedRange.colIndex + model.length);\n            }\n            if (!args.model.rows) {\n                args.model.rows = [];\n            }\n            var cellModel = [];\n            if (!args.columnCellsModel) {\n                args.columnCellsModel = [];\n            }\n            for (var i = 0; i < model.length; i++) {\n                cellModel.push(null);\n            }\n            mergeCollection = [];\n            for (var i = 0; i <= args.model.usedRange.rowIndex; i++) {\n                if (!args.model.rows[i]) {\n                    args.model.rows[i] = { cells: [] };\n                }\n                else if (!args.model.rows[i].cells) {\n                    args.model.rows[i].cells = [];\n                }\n                if (index && !args.model.rows[i].cells[index - 1]) {\n                    args.model.rows[i].cells[index - 1] = {};\n                }\n                (_c = args.model.rows[i].cells).splice.apply(_c, [index, 0].concat((args.columnCellsModel[i] && args.columnCellsModel[i].cells ?\n                    args.columnCellsModel[i].cells : cellModel)));\n                var curIdx = index + model.length;\n                if (args.model.rows[i].cells[curIdx] && args.model.rows[i].cells[curIdx].colSpan !== undefined &&\n                    args.model.rows[i].cells[curIdx].colSpan < 0 && args.model.rows[i].cells[curIdx].rowSpan === undefined) {\n                    mergeCollection.push({\n                        range: [i, curIdx, i, curIdx], insertCount: cellModel.length,\n                        insertModel: 'Column'\n                    });\n                }\n            }\n            mergeCollection.forEach(function (mergeArgs) { _this.parent.notify(insertMerge, mergeArgs); });\n        }\n        else {\n            if (args.checkCount !== undefined && args.checkCount === this.parent.sheets.length) {\n                return;\n            }\n            delete model[0].index;\n            this.parent.createSheet(index, model);\n            var id_1;\n            if (args.activeSheetIndex) {\n                this.parent.setProperties({ activeSheetIndex: args.activeSheetIndex }, true);\n            }\n            else if (!args.isAction && args.start < this.parent.activeSheetIndex) {\n                this.parent.setProperties({ activeSheetIndex: this.parent.skipHiddenSheets(this.parent.activeSheetIndex) }, true);\n            }\n            model.forEach(function (sheet) {\n                if (isModel) {\n                    _this.updateRangeModel(sheet.ranges);\n                }\n                id_1 = sheet.id;\n                _this.parent.notify(workbookFormulaOperation, {\n                    action: 'addSheet', visibleName: sheet.name, sheetName: 'Sheet' + id_1, index: id_1\n                });\n            });\n        }\n        var insertArgs = {\n            action: 'refreshNamedRange', insertArgs: {\n                model: model, index: index, modelType: args.modelType, isAction: args.isAction, activeSheetIndex: args.activeSheetIndex, sheetCount: this.parent.sheets.length, name: 'insert'\n            }\n        };\n        var eventArgs = {\n            action: 'refreshInsDelFormula', insertArgs: {\n                model: model, startIndex: args.start, endIndex: args.end, modelType: args.modelType, name: 'insert', activeSheetIndex: args.activeSheetIndex, sheetCount: this.parent.sheets.length\n            }\n        };\n        if (args.modelType === 'Column' || args.modelType === 'Row') {\n            this.parent.notify(workbookFormulaOperation, insertArgs);\n            this.parent.notify(workbookFormulaOperation, eventArgs);\n        }\n        this.parent.notify(insert, {\n            model: model, index: index, modelType: args.modelType, isAction: args.isAction, activeSheetIndex: args.activeSheetIndex, sheetCount: this.parent.sheets.length, insertType: args.insertType\n        });\n    };\n    WorkbookInsert.prototype.updateRangeModel = function (ranges) {\n        ranges.forEach(function (range) {\n            if (range.dataSource) {\n                range.startCell = range.startCell || 'A1';\n                range.showFieldAsHeader = range.showFieldAsHeader === undefined || range.showFieldAsHeader;\n                range.template = range.template || '';\n                range.address = range.address || 'A1';\n            }\n        });\n    };\n    WorkbookInsert.prototype.setInsertInfo = function (sheet, startIndex, count, totalKey, modelType) {\n        if (modelType === void 0) { modelType = 'Row'; }\n        var endIndex = count = startIndex + (count - 1);\n        sheet.ranges.forEach(function (range) {\n            if (range.info && startIndex < range.info[totalKey]) {\n                if (!range.info[\"insert\" + modelType + \"Range\"]) {\n                    range.info[\"insert\" + modelType + \"Range\"] = [[startIndex, endIndex]];\n                }\n                else {\n                    range.info[\"insert\" + modelType + \"Range\"].push([startIndex, endIndex]);\n                }\n                range.info[totalKey] += ((endIndex - startIndex) + 1);\n            }\n        });\n    };\n    WorkbookInsert.prototype.addEventListener = function () {\n        this.parent.on(insertModel, this.insertModel, this);\n    };\n    /**\n     * Destroy workbook insert module.\n     */\n    WorkbookInsert.prototype.destroy = function () {\n        this.removeEventListener();\n        this.parent = null;\n    };\n    WorkbookInsert.prototype.removeEventListener = function () {\n        if (!this.parent.isDestroyed) {\n            this.parent.off(insertModel, this.insertModel);\n        }\n    };\n    /**\n     * Get the workbook insert module name.\n     */\n    WorkbookInsert.prototype.getModuleName = function () {\n        return 'workbookinsert';\n    };\n    return WorkbookInsert;\n}());\nexport { WorkbookInsert };\n","import { getCell, setCell } from '../base/index';\nimport { deleteModel, deleteAction, updateUsedRange } from '../../workbook/common/index';\nimport { activeCellMergedRange, setMerge, workbookFormulaOperation } from '../../workbook/common/index';\n/**\n * The `WorkbookDelete` module is used to delete cells, rows, columns and sheets from workbook.\n */\nvar WorkbookDelete = /** @class */ (function () {\n    /**\n     * Constructor for the workbook delete module.\n     * @private\n     */\n    function WorkbookDelete(parent) {\n        this.parent = parent;\n        this.addEventListener();\n    }\n    // tslint:disable-next-line\n    WorkbookDelete.prototype.deleteModel = function (args) {\n        var _this = this;\n        var sheetLength = this.parent.sheets.length;\n        if (args.modelType === 'Sheet' && sheetLength === 1) {\n            return;\n        }\n        var modelName = args.modelType.toLowerCase() + \"s\";\n        args.start = args.start;\n        if (args.start > args.end) {\n            var temp = args.start;\n            args.start = args.end;\n            args.end = temp;\n        }\n        var deletedCells;\n        var mergeArgsCollection = [];\n        var count = (args.end - args.start) + 1;\n        var range;\n        var prevCell;\n        if (args.modelType === 'Row') {\n            args.model = args.model;\n            if (args.start > args.model.usedRange.rowIndex) {\n                return;\n            }\n            if (args.end > args.model.usedRange.rowIndex) {\n                args.end -= (args.end - args.model.usedRange.rowIndex);\n            }\n            args.model.usedRange.rowIndex -= ((args.end - args.start) + 1);\n            if (args.model.usedRange.rowIndex < 0) {\n                args.model.usedRange.rowIndex = 0;\n            }\n            this.parent.notify(updateUsedRange, { index: args.model.usedRange.rowIndex, update: 'row' });\n            var curIdx = args.end + 1;\n            var cell = void 0;\n            var mergeArgs = void 0;\n            if (args.model.rows[args.start] && args.model.rows[args.start].cells) {\n                for (var i = 0; i <= args.model.usedRange.colIndex; i++) {\n                    if (args.model.rows[args.start].cells[i] && args.model.rows[args.start].cells[i].rowSpan !== undefined &&\n                        args.model.rows[args.start].cells[i].rowSpan < 0 && args.model.rows[args.start].cells[i].colSpan === undefined) {\n                        mergeArgs = { range: [args.start, i, args.start, i] };\n                        this.parent.notify(activeCellMergedRange, mergeArgs);\n                        mergeArgs.range = mergeArgs.range;\n                        if (mergeArgs.range[2] <= args.end) {\n                            prevCell = getCell(mergeArgs.range[0], i, args.model);\n                            if (prevCell && prevCell.rowSpan > 1) {\n                                if (prevCell.rowSpan - ((mergeArgs.range[2] - args.start) + 1) > 1) {\n                                    setCell(mergeArgs.range[0], i, args.model, { colSpan: prevCell.rowSpan - ((mergeArgs.range[2] - args.start) + 1) }, true);\n                                }\n                                else {\n                                    delete args.model.rows[mergeArgs.range[0]].cells[i].rowSpan;\n                                }\n                            }\n                            mergeArgs = null;\n                        }\n                    }\n                    if (args.model.rows[curIdx].cells && args.model.rows[curIdx].cells[i] &&\n                        args.model.rows[curIdx].cells[i].rowSpan !== undefined &&\n                        args.model.rows[curIdx].cells[i].rowSpan < 0 && args.model.rows[curIdx].cells[i].colSpan === undefined) {\n                        if (!mergeArgs) {\n                            mergeArgs = { range: [curIdx, i, curIdx, i] };\n                            this.parent.notify(activeCellMergedRange, mergeArgs);\n                        }\n                        cell = new Object();\n                        mergeArgs.range = mergeArgs.range;\n                        Object.assign(cell, getCell(mergeArgs.range[0], mergeArgs.range[1], args.model));\n                        if (cell && cell.rowSpan && (cell.rowSpan > 1 || cell.colSpan > 1)) {\n                            var indexes = [];\n                            indexes[1] = i;\n                            indexes[3] = cell.colSpan > 1 ? i + (cell.colSpan - 1) : i;\n                            mergeArgs.range = mergeArgs.range;\n                            if (mergeArgs.range[0] < args.start) {\n                                indexes[0] = indexes[2] = mergeArgs.range[0];\n                                if (cell.rowSpan - count > 1) {\n                                    indexes[2] += (cell.rowSpan - count - 1);\n                                }\n                            }\n                            else {\n                                indexes[0] = indexes[2] = args.start;\n                                if (cell.rowSpan - ((args.end - mergeArgs.range[0]) + 1) > 1) {\n                                    indexes[2] += ((cell.rowSpan - ((args.end - mergeArgs.range[0]) + 1)) - 1);\n                                }\n                            }\n                            mergeArgsCollection.push({\n                                range: indexes, isAction: false, preventRefresh: true, merge: true,\n                                type: 'All', skipChecking: true\n                            });\n                        }\n                    }\n                    mergeArgs = null;\n                }\n            }\n        }\n        else if (args.modelType === 'Column') {\n            args.model = args.model;\n            if (args.start > args.model.usedRange.colIndex) {\n                return;\n            }\n            if (args.end > args.model.usedRange.colIndex) {\n                args.end -= (args.end - args.model.usedRange.colIndex);\n            }\n            args.model.usedRange.colIndex -= count;\n            if (args.model.usedRange.colIndex < 0) {\n                args.model.usedRange.colIndex = 0;\n            }\n            //this.setDeleteInfo(args.start, args.end, 'fldLen', 'Column');\n            this.parent.notify(updateUsedRange, { index: args.model.usedRange.colIndex, update: 'col' });\n            deletedCells = [];\n            var curIdx = args.end + 1;\n            var cell = void 0;\n            var mergeArgs = void 0;\n            for (var i = 0; i <= args.model.usedRange.rowIndex; i++) {\n                deletedCells.push({});\n                if (args.model.rows[i] && args.model.rows[i].cells) {\n                    if (args.model.rows[i].cells[args.start] && args.model.rows[i].cells[args.start].colSpan !== undefined &&\n                        args.model.rows[i].cells[args.start].colSpan < 0 && args.model.rows[i].cells[args.start].rowSpan === undefined) {\n                        mergeArgs = { range: [i, args.start, i, args.start] };\n                        this.parent.notify(activeCellMergedRange, mergeArgs);\n                        mergeArgs.range = mergeArgs.range;\n                        if (mergeArgs.range[3] <= args.end) {\n                            var prevCell_1 = getCell(i, mergeArgs.range[1], args.model);\n                            if (prevCell_1 && prevCell_1.colSpan > 1) {\n                                if (prevCell_1.colSpan - ((mergeArgs.range[3] - args.start) + 1) > 1) {\n                                    setCell(i, mergeArgs.range[1], args.model, { colSpan: prevCell_1.colSpan - ((mergeArgs.range[3] - args.start) + 1) }, true);\n                                }\n                                else {\n                                    delete args.model.rows[i].cells[mergeArgs.range[1]].colSpan;\n                                }\n                            }\n                            mergeArgs = null;\n                        }\n                    }\n                    if (args.model.rows[i].cells[curIdx] && args.model.rows[i].cells[curIdx].colSpan !== undefined &&\n                        args.model.rows[i].cells[curIdx].colSpan < 0 && args.model.rows[i].cells[curIdx].rowSpan === undefined) {\n                        if (!mergeArgs) {\n                            mergeArgs = { range: [i, curIdx, i, curIdx] };\n                            this.parent.notify(activeCellMergedRange, mergeArgs);\n                        }\n                        cell = new Object();\n                        mergeArgs.range = mergeArgs.range;\n                        Object.assign(cell, getCell(mergeArgs.range[0], mergeArgs.range[1], args.model));\n                        if (cell && cell.colSpan && (cell.colSpan > 1 || cell.rowSpan > 1)) {\n                            var indexes = [];\n                            indexes[0] = i;\n                            indexes[2] = cell.rowSpan > 1 ? i + (cell.rowSpan - 1) : i;\n                            mergeArgs.range = mergeArgs.range;\n                            if (mergeArgs.range[1] < args.start) {\n                                indexes[1] = indexes[3] = mergeArgs.range[1];\n                                if (cell.colSpan - count > 1) {\n                                    indexes[3] += (cell.colSpan - count - 1);\n                                }\n                            }\n                            else {\n                                indexes[1] = indexes[3] = args.start;\n                                if (cell.colSpan - ((args.end - mergeArgs.range[1]) + 1) > 1) {\n                                    indexes[3] += ((cell.colSpan - ((args.end - mergeArgs.range[1]) + 1)) - 1);\n                                }\n                            }\n                            mergeArgsCollection.push({\n                                range: indexes, isAction: false, preventRefresh: true, merge: true,\n                                type: 'All', skipChecking: true\n                            });\n                        }\n                    }\n                    deletedCells[i].cells = args.model.rows[i].cells.splice(args.start, count);\n                    mergeArgs = null;\n                }\n            }\n        }\n        else {\n            if (args.end - args.start === this.parent.sheets.length - 1) {\n                return;\n            }\n        }\n        var deletedModel = [];\n        for (var i = args.start; i <= args.end; i++) {\n            if (args.model[modelName][args.start]) {\n                deletedModel.push(args.model[modelName][args.start]);\n                args.model[modelName].splice(args.start, 1);\n            }\n            else {\n                deletedModel.push({});\n            }\n            if (i === args.start) {\n                deletedModel[0].index = args.start;\n            }\n        }\n        mergeArgsCollection.forEach(function (merge) { _this.parent.notify(setMerge, merge); });\n        var insertArgs = {\n            action: 'refreshNamedRange', insertArgs: {\n                startIndex: args.start, endIndex: args.end, modelType: args.modelType,\n                isAction: args.isAction, deletedModel: deletedModel, deletedCellsModel: deletedCells,\n                activeSheetIndex: this.parent.activeSheetIndex, name: 'delete'\n            }\n        };\n        var eventArgs = {\n            action: 'refreshInsDelFormula', insertArgs: {\n                model: deletedModel, startIndex: args.start, endIndex: args.end, modelType: args.modelType,\n                name: 'delete', activeSheetIndex: args.activeSheetIndex, sheetCount: this.parent.sheets.length\n            }\n        };\n        this.parent.notify(workbookFormulaOperation, insertArgs);\n        this.parent.notify(workbookFormulaOperation, eventArgs);\n        this.parent.notify(deleteAction, {\n            startIndex: args.start, endIndex: args.end, modelType: args.modelType,\n            isAction: args.isAction, deletedModel: deletedModel, deletedCellsModel: deletedCells,\n            activeSheetIndex: this.parent.activeSheetIndex\n        });\n    };\n    WorkbookDelete.prototype.setDeleteInfo = function (startIndex, endIndex, totalKey, modelType) {\n        if (modelType === void 0) { modelType = 'Row'; }\n        var total = (endIndex - startIndex) + 1;\n        var newRange = [];\n        var insertRange;\n        this.parent.getActiveSheet().ranges.forEach(function (range) {\n            if (range.info && startIndex < range.info[totalKey]) {\n                if (range.info[\"delete\" + modelType + \"Range\"]) {\n                    range.info[\"delete\" + modelType + \"Range\"].push([startIndex, endIndex]);\n                }\n                else {\n                    range.info[\"delete\" + modelType + \"Range\"] = [[startIndex, endIndex]];\n                }\n                range.info[totalKey] -= total;\n                if (range.info[\"insert\" + modelType + \"Range\"]) {\n                    range.info[\"insert\" + modelType + \"Range\"] = newRange;\n                }\n            }\n        });\n    };\n    WorkbookDelete.prototype.addEventListener = function () {\n        this.parent.on(deleteModel, this.deleteModel, this);\n    };\n    /**\n     * Destroy workbook delete module.\n     */\n    WorkbookDelete.prototype.destroy = function () {\n        this.removeEventListener();\n        this.parent = null;\n    };\n    WorkbookDelete.prototype.removeEventListener = function () {\n        if (!this.parent.isDestroyed) {\n            this.parent.off(deleteModel, this.deleteModel);\n        }\n    };\n    /**\n     * Get the workbook delete module name.\n     */\n    WorkbookDelete.prototype.getModuleName = function () {\n        return 'workbookdelete';\n    };\n    return WorkbookDelete;\n}());\nexport { WorkbookDelete };\n","import { setCell, setRow, getSheet } from '../base/index';\nimport { setValidation, applyCellFormat, isValidation, removeValidation, addHighlight } from '../common/index';\nimport { removeHighlight } from '../common/index';\nimport { getRangeIndexes } from '../common/index';\n/**\n * The `WorkbookHyperlink` module is used to handle Hyperlink action in Spreadsheet.\n */\nvar WorkbookDataValidation = /** @class */ (function () {\n    /**\n     * Constructor for WorkbookSort module.\n     */\n    function WorkbookDataValidation(parent) {\n        this.parent = parent;\n        this.addEventListener();\n    }\n    /**\n     * To destroy the sort module.\n     */\n    WorkbookDataValidation.prototype.destroy = function () {\n        this.removeEventListener();\n        this.parent = null;\n    };\n    WorkbookDataValidation.prototype.addEventListener = function () {\n        this.parent.on(setValidation, this.addValidationHandler, this);\n        this.parent.on(removeValidation, this.removeValidationHandler, this);\n        this.parent.on(addHighlight, this.addHighlightHandler, this);\n        this.parent.on(removeHighlight, this.removeHighlightHandler, this);\n    };\n    WorkbookDataValidation.prototype.removeEventListener = function () {\n        if (!this.parent.isDestroyed) {\n            this.parent.off(setValidation, this.addValidationHandler);\n            this.parent.off(removeValidation, this.removeValidationHandler);\n            this.parent.off(addHighlight, this.addHighlightHandler);\n            this.parent.off(removeHighlight, this.removeHighlightHandler);\n        }\n    };\n    WorkbookDataValidation.prototype.addValidationHandler = function (args) {\n        this.ValidationHandler(args.rules, args.range, false);\n    };\n    WorkbookDataValidation.prototype.removeValidationHandler = function (args) {\n        this.ValidationHandler(args.rules, args.range, true);\n    };\n    WorkbookDataValidation.prototype.ValidationHandler = function (rules, range, isRemoveValidation) {\n        var cell;\n        var sheet = getSheet(this.parent, this.parent.getAddressInfo(range).sheetIndex);\n        range = range || sheet.selectedRange;\n        var indexes = getRangeIndexes(range);\n        for (var rowIdx = indexes[0]; rowIdx <= indexes[2]; rowIdx++) {\n            if (!sheet.rows[rowIdx]) {\n                setRow(sheet, rowIdx, {});\n            }\n            for (var colIdx = indexes[1]; colIdx <= indexes[3]; colIdx++) {\n                if (!sheet.rows[rowIdx].cells || !sheet.rows[rowIdx].cells[colIdx]) {\n                    setCell(rowIdx, colIdx, sheet, {});\n                }\n                cell = sheet.rows[rowIdx].cells[colIdx];\n                if (isRemoveValidation) {\n                    if (cell.validation) {\n                        delete (cell.validation);\n                        var style = this.parent.getCellStyleValue(['backgroundColor', 'color'], [rowIdx, colIdx]);\n                        this.parent.notify(applyCellFormat, {\n                            style: style, rowIdx: rowIdx, colIdx: colIdx\n                        });\n                    }\n                }\n                else {\n                    cell.validation = {\n                        type: rules.type,\n                        operator: rules.operator,\n                        value1: (rules.type === 'List' && rules.value1.length > 256) ?\n                            rules.value1.substring(0, 255) : rules.value1,\n                        value2: rules.value2,\n                        ignoreBlank: rules.ignoreBlank,\n                        inCellDropDown: rules.inCellDropDown,\n                    };\n                }\n            }\n        }\n    };\n    WorkbookDataValidation.prototype.addHighlightHandler = function (args) {\n        this.InvalidDataHandler(args.range, false);\n    };\n    WorkbookDataValidation.prototype.removeHighlightHandler = function (args) {\n        this.InvalidDataHandler(args.range, true);\n    };\n    WorkbookDataValidation.prototype.InvalidDataHandler = function (range, isRemoveHighlightedData) {\n        var isCell = false;\n        var cell;\n        var value;\n        var sheet = this.parent.getActiveSheet();\n        range = range || sheet.selectedRange;\n        var indexes = range ? getRangeIndexes(range) : [];\n        var rowIdx = range ? indexes[0] : 0;\n        var lastRowIdx = range ? indexes[2] : sheet.rows.length;\n        for (rowIdx; rowIdx <= lastRowIdx; rowIdx++) {\n            if (sheet.rows[rowIdx]) {\n                var colIdx = range ? indexes[1] : 0;\n                var lastColIdx = range ? indexes[3] : sheet.rows[rowIdx].cells.length;\n                for (colIdx; colIdx <= lastColIdx; colIdx++) {\n                    if (sheet.rows[rowIdx].cells[colIdx]) {\n                        cell = sheet.rows[rowIdx].cells[colIdx];\n                        value = cell.value ? cell.value : '';\n                        var range_1 = [rowIdx, colIdx];\n                        var sheetIdx = this.parent.activeSheetIndex;\n                        if (cell.validation && this.parent.allowDataValidation) {\n                            this.parent.notify(isValidation, { value: value, range: range_1, sheetIdx: sheetIdx, isCell: isCell });\n                            var isValid = this.parent.allowDataValidation;\n                            this.parent.allowDataValidation = true;\n                            if (!isValid) {\n                                if (!isRemoveHighlightedData) {\n                                    this.parent.notify(applyCellFormat, {\n                                        style: { backgroundColor: '#ffff00', color: '#ff0000' }, rowIdx: rowIdx, colIdx: colIdx\n                                    });\n                                }\n                                else if (isRemoveHighlightedData) {\n                                    var style = this.parent.getCellStyleValue(['backgroundColor', 'color'], [rowIdx, colIdx]);\n                                    this.parent.notify(applyCellFormat, {\n                                        style: style, rowIdx: rowIdx, colIdx: colIdx\n                                    });\n                                }\n                            }\n                        }\n                    }\n                }\n            }\n        }\n    };\n    /**\n     * Gets the module name.\n     * @returns string\n     */\n    WorkbookDataValidation.prototype.getModuleName = function () {\n        return 'workbookDataValidation';\n    };\n    return WorkbookDataValidation;\n}());\nexport { WorkbookDataValidation };\n","import { getCellIndexes, getCellAddress, findNext, findPrevious, count, } from '../common/index';\nimport { goto, replaceHandler, replaceAllHandler, showDialog, findUndoRedo, replaceAllDialog } from '../common/index';\nimport { isNullOrUndefined } from '@syncfusion/ej2-base';\nimport { findAllValues, workBookeditAlert } from '../common/index';\n/**\n * `WorkbookFindAndReplace` module is used to handle the search action in Spreadsheet.\n */\nvar WorkbookFindAndReplace = /** @class */ (function () {\n    /**\n     * Constructor for WorkbookFindAndReplace module.\n     */\n    function WorkbookFindAndReplace(parent) {\n        this.parent = parent;\n        this.addEventListener();\n    }\n    /**\n     * To destroy the FindAndReplace module.\n     */\n    WorkbookFindAndReplace.prototype.destroy = function () {\n        this.removeEventListener();\n        this.parent = null;\n    };\n    WorkbookFindAndReplace.prototype.addEventListener = function () {\n        this.parent.on(findNext, this.findNext, this);\n        this.parent.on(findPrevious, this.findPrevious, this);\n        this.parent.on(replaceHandler, this.replace, this);\n        this.parent.on(replaceAllHandler, this.replaceAll, this);\n        this.parent.on(count, this.totalCount, this);\n        this.parent.on(findAllValues, this.findAllValues, this);\n    };\n    WorkbookFindAndReplace.prototype.removeEventListener = function () {\n        if (!this.parent.isDestroyed) {\n            this.parent.off(findNext, this.findNext);\n            this.parent.off(findPrevious, this.findPrevious);\n            this.parent.off(replaceHandler, this.replace);\n            this.parent.off(replaceAllHandler, this.replaceAll);\n            this.parent.off(count, this.totalCount);\n            this.parent.off(findAllValues, this.findAllValues);\n        }\n    };\n    WorkbookFindAndReplace.prototype.findNext = function (args) {\n        var sheets = this.parent.sheets;\n        var val;\n        var sheetIndex = args.sheetIndex;\n        var sheet = sheets[this.parent.activeSheetIndex];\n        var activecell = getCellIndexes(sheet.activeCell);\n        var usedRange = sheet.usedRange;\n        var endColumn = usedRange.colIndex;\n        var stringValue = args.value.toString();\n        var cidx;\n        var ridx;\n        var count = 0;\n        var endRow = usedRange.rowIndex;\n        var loopCount = 0;\n        var cellFormat;\n        var valueOfCell;\n        cidx = activecell[1];\n        ridx = activecell[0];\n        var startColumn = cidx;\n        var startRow = ridx;\n        if (sheet.rows[ridx]) {\n            if (sheet.rows[ridx].cells[cidx]) {\n                cellFormat = sheet.rows[ridx].cells[cidx].format;\n                if (cellFormat) {\n                    var dispTxt = this.parent.getDisplayText(sheet.rows[ridx].cells[cidx]);\n                    valueOfCell = dispTxt.toString();\n                }\n                else {\n                    if (sheet.rows[ridx].cells[cidx].value) {\n                        valueOfCell = sheet.rows[ridx].cells[cidx].value.toString();\n                    }\n                }\n            }\n        }\n        if (valueOfCell) {\n            var lcValueOfCell = valueOfCell.toLowerCase();\n            var ivalueOfCell = valueOfCell.indexOf(args.value) > -1;\n            var lowerCaseIndex = lcValueOfCell.indexOf(args.value.toString().toLowerCase()) > -1;\n            if ((stringValue === valueOfCell) || (stringValue === lcValueOfCell) || (ivalueOfCell) || (lowerCaseIndex)) {\n                if (args.searchBy === 'By Column') {\n                    ridx++;\n                }\n                else {\n                    cidx++;\n                }\n                count++;\n            }\n        }\n        if (activecell[0] > sheet.usedRange.rowIndex || activecell[1] > sheet.usedRange.colIndex) {\n            if (activecell[0] > sheet.usedRange.rowIndex && activecell[1] <= sheet.usedRange.colIndex) {\n                ridx = 0;\n                cidx = activecell[1];\n            }\n            else if (activecell[0] <= sheet.usedRange.rowIndex && activecell[1] > sheet.usedRange.colIndex) {\n                ridx = activecell[0];\n                cidx = 0;\n            }\n            else {\n                ridx = 0;\n                cidx = 0;\n            }\n        }\n        var findNextArgs = {\n            rowIndex: ridx, colIndex: cidx, usedRange: usedRange, endRow: endRow, endColumn: endColumn, startRow: startRow,\n            mode: args.mode, loopCount: loopCount, count: count, args: args, val: val, stringValue: stringValue,\n            sheetIndex: this.parent.activeSheetIndex, startColumn: startColumn, sheets: sheets\n        };\n        if (args.searchBy === 'By Row') {\n            this.findNxtRow(findNextArgs);\n        }\n        if (args.searchBy === 'By Column') {\n            this.findNxtCol(findNextArgs);\n        }\n    };\n    WorkbookFindAndReplace.prototype.findNxtRow = function (findNextArgs) {\n        var usedRange;\n        var sheet = findNextArgs.sheets[findNextArgs.sheetIndex];\n        var sheetsLen = this.parent.sheets.length;\n        var activecell = getCellIndexes(sheet.activeCell);\n        if (findNextArgs.colIndex >= findNextArgs.usedRange.colIndex + 1) {\n            findNextArgs.colIndex = 0;\n            findNextArgs.rowIndex++;\n        }\n        for (findNextArgs.rowIndex; findNextArgs.rowIndex <= findNextArgs.endRow + 1; findNextArgs.rowIndex++) {\n            if (findNextArgs.rowIndex > findNextArgs.endRow) {\n                if (findNextArgs.mode === 'Workbook') {\n                    var noCellfound = this.parent.activeSheetIndex;\n                    findNextArgs.sheetIndex++;\n                    if (sheetsLen === findNextArgs.sheetIndex) {\n                        findNextArgs.sheetIndex = 0;\n                    }\n                    if (noCellfound === findNextArgs.sheetIndex) {\n                        if (findNextArgs.count === 0) {\n                            this.parent.notify(showDialog, null);\n                            return;\n                        }\n                    }\n                    sheet = findNextArgs.sheets[findNextArgs.sheetIndex];\n                    usedRange = sheet.usedRange;\n                    activecell = getCellIndexes(sheet.activeCell);\n                    findNextArgs.rowIndex = 0;\n                    findNextArgs.colIndex = 0;\n                    findNextArgs.endColumn = usedRange.colIndex;\n                    findNextArgs.endRow = usedRange.rowIndex;\n                }\n                if (findNextArgs.colIndex === 0 && findNextArgs.rowIndex > findNextArgs.endRow) {\n                    if ((activecell[0] === 0 && activecell[1] === 0) ||\n                        (activecell[0] > sheet.usedRange.rowIndex || activecell[1] > sheet.usedRange.colIndex)) {\n                        if (findNextArgs.count === 0) {\n                            this.parent.notify(showDialog, null);\n                            return;\n                        }\n                    }\n                    else if ((activecell[0] !== 0 && activecell[1] !== 0) || (activecell[0] !== 0 || activecell[1] !== 0)) {\n                        findNextArgs.startColumn = 0;\n                        findNextArgs.startRow = 0;\n                        findNextArgs.endColumn = findNextArgs.usedRange.colIndex;\n                        findNextArgs.endRow = activecell[0];\n                        findNextArgs.rowIndex = findNextArgs.startRow;\n                        findNextArgs.colIndex = findNextArgs.startColumn;\n                        findNextArgs.loopCount++;\n                    }\n                }\n            }\n            if (findNextArgs.count > 0) {\n                if (findNextArgs.usedRange.rowIndex < findNextArgs.rowIndex) {\n                    findNextArgs.rowIndex = 0;\n                    if (findNextArgs.rowIndex === 0) {\n                        findNextArgs.colIndex = 0;\n                    }\n                }\n            }\n            if (sheet.rows[findNextArgs.rowIndex]) {\n                var row = sheet.rows[findNextArgs.rowIndex];\n                for (findNextArgs.colIndex; findNextArgs.colIndex <= findNextArgs.endColumn; findNextArgs.colIndex++) {\n                    if (row) {\n                        if (row.cells[findNextArgs.colIndex]) {\n                            var checkTrue = this.nextCommon(findNextArgs);\n                            if (checkTrue) {\n                                return;\n                            }\n                        }\n                    }\n                }\n                if (findNextArgs.colIndex > findNextArgs.endColumn) {\n                    findNextArgs.colIndex = 0;\n                }\n                if (findNextArgs.loopCount > 0) {\n                    if (activecell[0] === findNextArgs.rowIndex) {\n                        this.parent.notify(showDialog, null);\n                        return;\n                    }\n                }\n            }\n        }\n        if (findNextArgs.count === 0) {\n            this.parent.notify(showDialog, null);\n            return;\n        }\n    };\n    WorkbookFindAndReplace.prototype.findNxtCol = function (findNextArgs) {\n        var sheet = findNextArgs.sheets[findNextArgs.sheetIndex];\n        var noFound;\n        var activecell = getCellIndexes(sheet.activeCell);\n        var sheetsLen = this.parent.sheets.length;\n        if (findNextArgs.rowIndex >= findNextArgs.usedRange.rowIndex) {\n            findNextArgs.rowIndex = 0;\n            findNextArgs.colIndex++;\n        }\n        for (findNextArgs.colIndex; findNextArgs.colIndex <= findNextArgs.usedRange.colIndex + 1; findNextArgs.colIndex++) {\n            if (findNextArgs.colIndex >= findNextArgs.endColumn + 1) {\n                if (findNextArgs.mode === 'Workbook') {\n                    noFound = this.parent.activeSheetIndex;\n                    findNextArgs.sheetIndex++;\n                    if (sheetsLen === findNextArgs.sheetIndex) {\n                        findNextArgs.sheetIndex = 0;\n                    }\n                    if (noFound === findNextArgs.sheetIndex) {\n                        if (findNextArgs.count === 0) {\n                            this.parent.notify(showDialog, null);\n                            return;\n                        }\n                    }\n                    sheet = findNextArgs.sheets[findNextArgs.sheetIndex];\n                    findNextArgs.usedRange = sheet.usedRange;\n                    activecell = getCellIndexes(sheet.activeCell);\n                    findNextArgs.colIndex = 0;\n                    findNextArgs.rowIndex = 0;\n                    findNextArgs.endColumn = findNextArgs.usedRange.colIndex;\n                    findNextArgs.endRow = findNextArgs.usedRange.rowIndex;\n                }\n            }\n            if (findNextArgs.colIndex >= findNextArgs.endColumn + 1) {\n                findNextArgs.colIndex = 0;\n            }\n            if (findNextArgs.rowIndex > findNextArgs.endRow && findNextArgs.colIndex === 0) {\n                if ((activecell[0] === 0 && activecell[1] === 0) ||\n                    (activecell[1] > sheet.usedRange.rowIndex || activecell[0] > sheet.usedRange.colIndex)) {\n                    if (findNextArgs.count === 0) {\n                        this.parent.notify(showDialog, null);\n                        return;\n                    }\n                }\n                else if ((activecell[1] !== 0 || activecell[0] !== 0) || (activecell[1] !== 0 && activecell[0] !== 0)) {\n                    findNextArgs.startRow = 0;\n                    findNextArgs.startColumn = 0;\n                    findNextArgs.endRow = activecell[0];\n                    findNextArgs.endColumn = findNextArgs.usedRange.colIndex;\n                    findNextArgs.colIndex = findNextArgs.startColumn;\n                    findNextArgs.rowIndex = findNextArgs.startRow;\n                    findNextArgs.loopCount++;\n                }\n            }\n            if (findNextArgs.count > 0) {\n                if (findNextArgs.usedRange.colIndex + 1 < findNextArgs.colIndex) {\n                    findNextArgs.colIndex = 0;\n                    findNextArgs.rowIndex = 0;\n                }\n            }\n            if (findNextArgs.rowIndex >= findNextArgs.endRow) {\n                findNextArgs.rowIndex = 0;\n            }\n            if (findNextArgs.colIndex <= findNextArgs.usedRange.colIndex) {\n                for (findNextArgs.rowIndex; findNextArgs.rowIndex <= findNextArgs.usedRange.rowIndex; findNextArgs.rowIndex++) {\n                    if (sheet.rows[findNextArgs.rowIndex]) {\n                        if (sheet.rows[findNextArgs.rowIndex].cells[findNextArgs.colIndex]) {\n                            var checkTrue = this.nextCommon(findNextArgs);\n                            if (checkTrue) {\n                                return;\n                            }\n                        }\n                    }\n                }\n                if (findNextArgs.loopCount > 0) {\n                    if (activecell[1] === findNextArgs.colIndex) {\n                        this.parent.notify(showDialog, null);\n                        return;\n                    }\n                }\n            }\n        }\n        if (findNextArgs.count === 0) {\n            this.parent.notify(showDialog, null);\n            return;\n        }\n    };\n    WorkbookFindAndReplace.prototype.nextCommon = function (findNextArgs) {\n        var sheet = findNextArgs.sheets[findNextArgs.sheetIndex];\n        if (sheet.rows[findNextArgs.rowIndex]) {\n            var rowCol = sheet.rows[findNextArgs.rowIndex].cells[findNextArgs.colIndex];\n            if (rowCol && rowCol.value) {\n                var cellType = sheet.rows[findNextArgs.rowIndex].cells[findNextArgs.colIndex];\n                if (cellType) {\n                    var cellval = void 0;\n                    if (cellType.format) {\n                        var displayTxt = this.parent.getDisplayText(sheet.rows[findNextArgs.rowIndex].\n                            cells[findNextArgs.colIndex]);\n                        cellval = displayTxt;\n                    }\n                    else {\n                        cellval = sheet.rows[findNextArgs.rowIndex].cells[findNextArgs.colIndex].value.toString();\n                    }\n                    if (findNextArgs.args.isCSen && findNextArgs.args.isEMatch) {\n                        if (cellval === findNextArgs.stringValue) {\n                            var address = sheet.name + '!' + getCellAddress(findNextArgs.rowIndex, findNextArgs.colIndex);\n                            this.parent.notify(goto, { address: address });\n                            findNextArgs.count++;\n                            return true;\n                        }\n                    }\n                    else if (findNextArgs.args.isCSen && !findNextArgs.args.isEMatch) {\n                        var index = cellval.indexOf(findNextArgs.args.value) > -1;\n                        if ((cellval === findNextArgs.stringValue) || (index)) {\n                            var address = sheet.name + '!' + getCellAddress(findNextArgs.rowIndex, findNextArgs.colIndex);\n                            this.parent.notify(goto, { address: address });\n                            findNextArgs.count++;\n                            return true;\n                        }\n                    }\n                    else if (!findNextArgs.args.isCSen && findNextArgs.args.isEMatch) {\n                        findNextArgs.val = cellval.toString().toLowerCase();\n                        if (findNextArgs.val === findNextArgs.stringValue) {\n                            var address = sheet.name + '!' + getCellAddress(findNextArgs.rowIndex, findNextArgs.colIndex);\n                            this.parent.notify(goto, { address: address });\n                            findNextArgs.count++;\n                            return true;\n                        }\n                    }\n                    else if (!findNextArgs.args.isCSen && !findNextArgs.args.isEMatch) {\n                        findNextArgs.val = cellval.toString().toLowerCase();\n                        var index = findNextArgs.val.indexOf(findNextArgs.args.value.toString().toLowerCase()) > -1;\n                        var lowerCaseIndex = findNextArgs.val.indexOf(findNextArgs.args.value) > -1;\n                        if ((findNextArgs.val === findNextArgs.stringValue) || ((cellval === findNextArgs.stringValue) || (index)) ||\n                            (cellval === findNextArgs.stringValue) || (lowerCaseIndex)) {\n                            var address = sheet.name + '!' + getCellAddress(findNextArgs.rowIndex, findNextArgs.colIndex);\n                            this.parent.notify(goto, { address: address });\n                            findNextArgs.count++;\n                            return true;\n                        }\n                    }\n                }\n            }\n        }\n        return false;\n    };\n    WorkbookFindAndReplace.prototype.findPrevious = function (args) {\n        var sheets = this.parent.sheets;\n        var sheetIndex = args.sheetIndex;\n        var sheet = sheets[sheetIndex];\n        var valueOfCell;\n        var cellFormat;\n        var val;\n        var activecell = getCellIndexes(sheet.activeCell);\n        var loopCount = 0;\n        var count = 0;\n        var endRow = sheet.usedRange.rowIndex;\n        var endColumn = sheet.usedRange.colIndex;\n        var stringValue = args.value.toString();\n        var cidx = activecell[1];\n        var ridx = activecell[0];\n        var startColumn = cidx;\n        var startRow = ridx;\n        if (sheet.rows[ridx]) {\n            if (sheet.rows[ridx].cells[cidx]) {\n                cellFormat = sheet.rows[ridx].cells[cidx].format;\n                if (cellFormat) {\n                    var displayTxt = this.parent.getDisplayText(sheet.rows[ridx].cells[cidx]);\n                    valueOfCell = displayTxt.toString();\n                }\n                else {\n                    if (sheet.rows[ridx].cells[cidx].value) {\n                        valueOfCell = sheet.rows[ridx].cells[cidx].value.toString();\n                    }\n                }\n            }\n        }\n        if (valueOfCell) {\n            var lcValue = valueOfCell.toLowerCase();\n            var ivalue = valueOfCell.indexOf(args.value) > -1;\n            var lowerCaseIndex = lcValue.indexOf(args.value.toString().toLowerCase()) > -1;\n            if ((stringValue === valueOfCell) || (stringValue === lcValue) || (ivalue) || (lowerCaseIndex)) {\n                if (args.searchBy === 'By Row') {\n                    cidx--;\n                }\n                if (args.searchBy === 'By Column') {\n                    ridx--;\n                }\n                count++;\n            }\n        }\n        if (activecell[0] > sheet.usedRange.rowIndex || activecell[1] > sheet.usedRange.colIndex) {\n            if (activecell[0] > sheet.usedRange.rowIndex && activecell[1] <= sheet.usedRange.colIndex) {\n                ridx = sheet.usedRange.rowIndex;\n                cidx = activecell[1];\n            }\n            else if (activecell[0] <= sheet.usedRange.rowIndex && activecell[1] > sheet.usedRange.colIndex) {\n                ridx = activecell[0];\n                cidx = sheet.usedRange.colIndex;\n            }\n            else {\n                ridx = sheet.usedRange.rowIndex;\n                cidx = sheet.usedRange.colIndex;\n            }\n        }\n        var findPrevArgs = {\n            rowIndex: ridx, colIndex: cidx, endRow: endRow, endColumn: endColumn, startRow: startRow,\n            loopCount: loopCount, count: count, args: args, val: val, stringValue: stringValue,\n            sheets: sheets, sheetIndex: sheetIndex, startColumn: startColumn,\n        };\n        if (args.searchBy === 'By Row') {\n            this.findPreRow(findPrevArgs);\n        }\n        if (args.searchBy === 'By Column') {\n            this.findPreCol(findPrevArgs);\n        }\n    };\n    WorkbookFindAndReplace.prototype.findPreRow = function (findPrevArgs) {\n        var usedRan;\n        var sheet = findPrevArgs.sheets[findPrevArgs.sheetIndex];\n        var sheetsLength = this.parent.sheets.length;\n        var noValueBoolean = false;\n        var activecell = getCellIndexes(sheet.activeCell);\n        if (findPrevArgs.colIndex === -1) {\n            findPrevArgs.colIndex = findPrevArgs.endColumn;\n            findPrevArgs.rowIndex--;\n        }\n        for (findPrevArgs.rowIndex; findPrevArgs.rowIndex >= -1; findPrevArgs.rowIndex--) {\n            if (findPrevArgs.rowIndex < 0 && findPrevArgs.colIndex < 0) {\n                if (findPrevArgs.args.mode === 'Workbook') {\n                    var noCellfound = this.parent.activeSheetIndex;\n                    findPrevArgs.sheetIndex--;\n                    if (findPrevArgs.sheetIndex === -1) {\n                        findPrevArgs.sheetIndex = sheetsLength - 1;\n                    }\n                    if (noCellfound === findPrevArgs.sheetIndex) {\n                        if (findPrevArgs.count === 0) {\n                            this.parent.notify(showDialog, null);\n                            return;\n                        }\n                    }\n                    sheet = findPrevArgs.sheets[findPrevArgs.sheetIndex];\n                    usedRan = sheet.usedRange;\n                    activecell = getCellIndexes(sheet.activeCell);\n                    findPrevArgs.rowIndex = usedRan.rowIndex;\n                    findPrevArgs.colIndex = usedRan.colIndex;\n                    findPrevArgs.endColumn = 0;\n                    findPrevArgs.endRow = 0;\n                }\n                noValueBoolean = this.commonCondition(findPrevArgs, activecell);\n            }\n            if (!noValueBoolean) {\n                if (findPrevArgs.args.mode !== 'Workbook') {\n                    if (findPrevArgs.count > 0) {\n                        if (findPrevArgs.rowIndex === -1) {\n                            findPrevArgs.rowIndex = findPrevArgs.endRow;\n                        }\n                    }\n                }\n                if (findPrevArgs.rowIndex === -1) {\n                    findPrevArgs.rowIndex = sheet.usedRange.rowIndex;\n                    findPrevArgs.colIndex = sheet.usedRange.colIndex;\n                }\n                if (sheet.rows[findPrevArgs.rowIndex]) {\n                    if (findPrevArgs.colIndex === -1) {\n                        findPrevArgs.colIndex = sheet.usedRange.colIndex;\n                    }\n                    for (findPrevArgs.colIndex; findPrevArgs.colIndex >= 0; findPrevArgs.colIndex--) {\n                        if (sheet.rows[findPrevArgs.rowIndex]) {\n                            if (sheet.rows[findPrevArgs.rowIndex].cells[findPrevArgs.colIndex]) {\n                                var checkTrue = this.prevCommon(findPrevArgs);\n                                if (checkTrue) {\n                                    return;\n                                }\n                            }\n                        }\n                    }\n                    if (findPrevArgs.loopCount > 0) {\n                        if (activecell[0] === findPrevArgs.rowIndex) {\n                            this.parent.notify(showDialog, null);\n                            return;\n                        }\n                    }\n                }\n            }\n        }\n        if (!noValueBoolean) {\n            if (findPrevArgs.count === 0) {\n                this.parent.notify(showDialog, null);\n                return;\n            }\n        }\n    };\n    WorkbookFindAndReplace.prototype.findPreCol = function (findPrevArgs) {\n        var usedRange;\n        var sheet = findPrevArgs.sheets[findPrevArgs.sheetIndex];\n        var sheetsLen = this.parent.sheets.length;\n        var noValueBoolean = false;\n        var activecell = getCellIndexes(sheet.activeCell);\n        for (findPrevArgs.colIndex; findPrevArgs.colIndex >= -1; findPrevArgs.colIndex--) {\n            if (findPrevArgs.rowIndex < 0 && findPrevArgs.colIndex < 0) {\n                if (findPrevArgs.args.mode === 'Workbook') {\n                    var noCellfound = this.parent.activeSheetIndex;\n                    findPrevArgs.sheetIndex--;\n                    if (findPrevArgs.sheetIndex === -1) {\n                        findPrevArgs.sheetIndex = sheetsLen - 1;\n                    }\n                    if (noCellfound === findPrevArgs.sheetIndex) {\n                        if (findPrevArgs.count === 0) {\n                            this.parent.notify(showDialog, null);\n                            return;\n                        }\n                    }\n                    sheet = findPrevArgs.sheets[findPrevArgs.sheetIndex];\n                    usedRange = sheet.usedRange;\n                    activecell = getCellIndexes(sheet.activeCell);\n                    findPrevArgs.rowIndex = usedRange.rowIndex;\n                    findPrevArgs.colIndex = usedRange.colIndex;\n                    findPrevArgs.endColumn = 0;\n                    findPrevArgs.endRow = 0;\n                }\n                noValueBoolean = this.commonCondition(findPrevArgs, activecell);\n            }\n            if (!noValueBoolean) {\n                if (findPrevArgs.count > 0) {\n                    if (findPrevArgs.colIndex < 0) {\n                        findPrevArgs.colIndex = findPrevArgs.endColumn;\n                    }\n                }\n                if (findPrevArgs.rowIndex < 0) {\n                    findPrevArgs.rowIndex = sheet.usedRange.rowIndex;\n                }\n                if (findPrevArgs.colIndex < -1) {\n                    findPrevArgs.colIndex = sheet.usedRange.colIndex;\n                    findPrevArgs.rowIndex--;\n                }\n                if (sheet.rows[findPrevArgs.rowIndex]) {\n                    if (sheet.rows[findPrevArgs.rowIndex].cells[findPrevArgs.colIndex]) {\n                        if (findPrevArgs.rowIndex === -1) {\n                            findPrevArgs.rowIndex = sheet.usedRange.rowIndex;\n                        }\n                    }\n                }\n                for (findPrevArgs.rowIndex; findPrevArgs.rowIndex >= 0; findPrevArgs.rowIndex--) {\n                    if (sheet.rows[findPrevArgs.rowIndex]) {\n                        if (sheet.rows[findPrevArgs.rowIndex].cells[findPrevArgs.colIndex]) {\n                            var check = this.prevCommon(findPrevArgs);\n                            if (check) {\n                                return;\n                            }\n                        }\n                    }\n                    if (findPrevArgs.loopCount > 0) {\n                        if (activecell[1] === findPrevArgs.colIndex) {\n                            this.parent.notify(showDialog, null);\n                            return;\n                        }\n                    }\n                }\n            }\n        }\n        if (!noValueBoolean) {\n            if (findPrevArgs.count === 0) {\n                this.parent.notify(showDialog, null);\n                return;\n            }\n        }\n    };\n    WorkbookFindAndReplace.prototype.commonCondition = function (findPrevArgs, activecell) {\n        var sheet = findPrevArgs.sheets[findPrevArgs.sheetIndex];\n        var isTrue;\n        if ((activecell[0] !== findPrevArgs.endRow && activecell[1] !== findPrevArgs.endColumn) ||\n            (activecell[0] !== findPrevArgs.endRow || activecell[1] !== findPrevArgs.endColumn)) {\n            findPrevArgs.startColumn = sheet.usedRange.colIndex;\n            findPrevArgs.startRow = sheet.usedRange.rowIndex;\n            findPrevArgs.endColumn = 0;\n            findPrevArgs.endRow = activecell[0];\n            findPrevArgs.rowIndex = findPrevArgs.startRow;\n            findPrevArgs.colIndex = findPrevArgs.startColumn;\n            findPrevArgs.loopCount++;\n            isTrue = false;\n        }\n        else if ((activecell[0] === sheet.usedRange.rowIndex && activecell[1] === sheet.usedRange.colIndex) ||\n            (activecell[0] > sheet.usedRange.rowIndex || activecell[1] > sheet.usedRange.colIndex)) {\n            this.parent.notify(showDialog, null);\n            isTrue = true;\n        }\n        return isTrue;\n    };\n    WorkbookFindAndReplace.prototype.prevCommon = function (findPrevArgs) {\n        var sheet = findPrevArgs.sheets[findPrevArgs.sheetIndex];\n        if (sheet.rows[findPrevArgs.rowIndex]) {\n            var rowCol = sheet.rows[findPrevArgs.rowIndex].cells[findPrevArgs.colIndex];\n            if (rowCol && rowCol.value) {\n                var cellType = sheet.rows[findPrevArgs.rowIndex].cells[findPrevArgs.colIndex];\n                if (cellType) {\n                    var cellvalue = void 0;\n                    if (cellType.format) {\n                        var displayTxt = this.parent.getDisplayText(sheet.rows[findPrevArgs.rowIndex]\n                            .cells[findPrevArgs.colIndex]);\n                        cellvalue = displayTxt;\n                    }\n                    else {\n                        cellvalue = sheet.rows[findPrevArgs.rowIndex].cells[findPrevArgs.colIndex].value.toString();\n                    }\n                    if (findPrevArgs.args.isCSen && findPrevArgs.args.isEMatch) {\n                        if (cellvalue === findPrevArgs.stringValue) {\n                            var address = sheet.name + '!' + getCellAddress(findPrevArgs.rowIndex, findPrevArgs.colIndex);\n                            this.parent.notify(goto, { address: address });\n                            findPrevArgs.count++;\n                            return true;\n                        }\n                    }\n                    else if (findPrevArgs.args.isCSen && !findPrevArgs.args.isEMatch) {\n                        var index = cellvalue.indexOf(findPrevArgs.args.value) > -1;\n                        if ((cellvalue === findPrevArgs.stringValue) || (index)) {\n                            var address = sheet.name + '!' + getCellAddress(findPrevArgs.rowIndex, findPrevArgs.colIndex);\n                            this.parent.notify(goto, { address: address });\n                            findPrevArgs.count++;\n                            return true;\n                        }\n                    }\n                    else if (!findPrevArgs.args.isCSen && findPrevArgs.args.isEMatch) {\n                        findPrevArgs.val = cellvalue.toString().toLowerCase();\n                        if (findPrevArgs.val === findPrevArgs.stringValue) {\n                            var address = sheet.name + '!' + getCellAddress(findPrevArgs.rowIndex, findPrevArgs.colIndex);\n                            this.parent.notify(goto, { address: address });\n                            findPrevArgs.count++;\n                            return true;\n                        }\n                    }\n                    else if (!findPrevArgs.args.isCSen && !findPrevArgs.args.isEMatch) {\n                        findPrevArgs.val = cellvalue.toString().toLowerCase();\n                        var index = findPrevArgs.val.indexOf(findPrevArgs.args.value.toString().toLowerCase()) > -1;\n                        var lowerCaseIndex = findPrevArgs.val.indexOf(findPrevArgs.args.value) > -1;\n                        if ((cellvalue === findPrevArgs.stringValue) || ((cellvalue === findPrevArgs.stringValue) ||\n                            (index)) || (findPrevArgs.val === findPrevArgs.stringValue) || (lowerCaseIndex)) {\n                            var address = sheet.name + '!' + getCellAddress(findPrevArgs.rowIndex, findPrevArgs.colIndex);\n                            this.parent.notify(goto, { address: address });\n                            findPrevArgs.count++;\n                            return true;\n                        }\n                    }\n                }\n            }\n        }\n        return false;\n    };\n    WorkbookFindAndReplace.prototype.replace = function (args) {\n        if (this.parent.getActiveSheet().isProtected) {\n            this.parent.notify(workBookeditAlert, null);\n            return;\n        }\n        var sheet = this.parent.getActiveSheet();\n        var activecell = getCellIndexes(sheet.activeCell);\n        var currentCell = sheet.rows[activecell[0]].cells[activecell[1]].value.toString();\n        var index = currentCell.indexOf(args.value) > -1;\n        var lowerCaseIndex = currentCell.toLowerCase().indexOf(args.value.toString().toLowerCase()) > -1;\n        var val = currentCell.toString().toLowerCase();\n        if ((currentCell !== args.value) && (!index) && (val !== args.value) && (!lowerCaseIndex)) {\n            args.findOpt = 'next';\n            this.findNext(args);\n        }\n        this.parent.getActiveSheet();\n        var activecel = getCellIndexes(sheet.activeCell);\n        var address = sheet.activeCell;\n        var cell = sheet.rows[activecel[0]].cells[activecel[1]];\n        var cellFormat = sheet.rows[activecel[0]].cells[activecel[1]].format;\n        var compareVal;\n        var replaceAddress = sheet.name + '!' + getCellAddress(activecel[0], activecel[1]);\n        if (cellFormat) {\n            var dispTxt = this.parent.getDisplayText(sheet.rows[activecel[0]].cells[activecel[1]]);\n            compareVal = dispTxt.toString();\n        }\n        else {\n            compareVal = sheet.rows[activecel[0]].cells[activecel[1]].value.toString();\n        }\n        var replaceAllCollection = { undoRedoOpt: 'before', address: replaceAddress, compareVal: compareVal };\n        this.parent.notify(findUndoRedo, replaceAllCollection);\n        var lcValueOfCell = compareVal.toLowerCase();\n        var ivalueOfCell = compareVal.indexOf(args.value) > -1;\n        var caseInSensitive = lcValueOfCell.indexOf(args.value) > -1;\n        if ((args.value === compareVal) || (args.value === lcValueOfCell)) {\n            sheet.rows[activecel[0]].cells[activecel[1]].value = args.replaceValue;\n            this.parent.updateCell(cell, address);\n            var replaceAllCollection_1 = { address: replaceAddress, compareVal: args.replaceValue, undoRedoOpt: 'after' };\n            this.parent.notify(findUndoRedo, replaceAllCollection_1);\n        }\n        else if (ivalueOfCell) {\n            var newValue = compareVal.replace(args.value, args.replaceValue);\n            sheet.rows[activecel[0]].cells[activecel[1]].value = newValue;\n            this.parent.updateCell(cell, address);\n            var replaceAllCollection_2 = { address: replaceAddress, compareVal: args.replaceValue, undoRedoOpt: 'after' };\n            this.parent.notify(findUndoRedo, replaceAllCollection_2);\n        }\n        else if (caseInSensitive) {\n            var regx = new RegExp(args.value.toString().replace(/[.*+?^${}()|[\\]\\\\]/g, '\\\\$&'), 'ig');\n            var updateValue = compareVal.replace(regx, args.replaceValue);\n            sheet.rows[activecel[0]].cells[activecel[1]].value = updateValue;\n            this.parent.updateCell(cell, address);\n            var replaceAllCollection_3 = { address: replaceAddress, compareVal: args.replaceValue, undoRedoOpt: 'after' };\n            this.parent.notify(findUndoRedo, replaceAllCollection_3);\n        }\n    };\n    WorkbookFindAndReplace.prototype.replaceAll = function (args) {\n        var startSheet = 0;\n        var sheet = this.parent.sheets[startSheet];\n        var endRow = sheet.usedRange.rowIndex;\n        var count = 0;\n        var undoRedoOpt = 'beforeReplaceAll';\n        var startRow = 0;\n        var endColumn = sheet.usedRange.colIndex;\n        var startColumn = 0;\n        var addressCollection = [];\n        var address;\n        for (startRow; startRow <= endRow; startRow++) {\n            if (startColumn > endColumn && startRow === endRow) {\n                if (args.mode === 'Workbook') {\n                    startSheet++;\n                    sheet = this.parent.sheets[startSheet];\n                    if (sheet) {\n                        startColumn = 0;\n                        startRow = 0;\n                        endColumn = sheet.usedRange.colIndex;\n                        endRow = sheet.usedRange.rowIndex;\n                        sheet = sheet;\n                    }\n                }\n            }\n            if (sheet) {\n                if (sheet.rows[startRow]) {\n                    var row = sheet.rows[startRow];\n                    if (startColumn === endColumn + 1) {\n                        startColumn = 0;\n                    }\n                    for (startColumn; startColumn <= endColumn; startColumn++) {\n                        var cell = sheet.rows[startRow].cells[startColumn];\n                        if (row) {\n                            if (row.cells[startColumn] && row.cells[startColumn].value) {\n                                var cellType = sheet.rows[startRow].cells[startColumn];\n                                if (cellType) {\n                                    var cellTypeVal = cellType.format;\n                                    var cellval = void 0;\n                                    if (cellTypeVal) {\n                                        var displayTxt = this.parent.getDisplayText(sheet.rows[startRow].\n                                            cells[startColumn]);\n                                        cellval = displayTxt.toString();\n                                    }\n                                    else {\n                                        cellval = sheet.rows[startRow].cells[startColumn].value.toString();\n                                    }\n                                    if (args.isCSen && args.isEMatch) {\n                                        if (cellval === args.value) {\n                                            sheet.rows[startRow].cells[startColumn].value = args.replaceValue;\n                                            address = sheet.name + '!' + getCellAddress(startRow, startColumn);\n                                            this.parent.updateCell(cell, address);\n                                            addressCollection.push(address);\n                                            count++;\n                                        }\n                                    }\n                                    else if (args.isCSen && !args.isEMatch) {\n                                        var index = cellval.indexOf(args.value) > -1;\n                                        if ((cellval === args.value) || (index)) {\n                                            var newValue = cellval.replace(args.value, args.replaceValue);\n                                            sheet.rows[startRow].cells[startColumn].value = newValue;\n                                            address = sheet.name + '!' + getCellAddress(startRow, startColumn);\n                                            this.parent.updateCell(cell, address);\n                                            addressCollection.push(address);\n                                            count++;\n                                        }\n                                    }\n                                    else if (!args.isCSen && args.isEMatch) {\n                                        var val = cellval.toString().toLowerCase();\n                                        if (val === args.value) {\n                                            sheet.rows[startRow].cells[startColumn].value = args.replaceValue;\n                                            address = sheet.name + '!' + getCellAddress(startRow, startColumn);\n                                            this.parent.updateCell(cell, address);\n                                            addressCollection.push(address);\n                                            count++;\n                                        }\n                                    }\n                                    else if (!args.isCSen && !args.isEMatch) {\n                                        var val = cellval.toString().toLowerCase();\n                                        var index = val.indexOf(args.value.toString().toLowerCase()) > -1;\n                                        var lowerCaseValue = val.indexOf(args.value) > -1;\n                                        if (((cellval === args.value) || (index)) || (val === args.value) || (cellval === args.value) ||\n                                            (lowerCaseValue)) {\n                                            var regExepression = new RegExp(args.value.toString().replace(/[.*+?^${}()|[\\]\\\\]/g, '\\\\$&'), 'ig');\n                                            var newValue = cellval.replace(regExepression, args.replaceValue);\n                                            sheet.rows[startRow].cells[startColumn].value = newValue;\n                                            address = sheet.name + '!' + getCellAddress(startRow, startColumn);\n                                            this.parent.updateCell(cell, address);\n                                            addressCollection.push(address);\n                                            count++;\n                                        }\n                                    }\n                                }\n                            }\n                        }\n                    }\n                }\n            }\n        }\n        var replaceAllCollection = {\n            undoRedoOpt: undoRedoOpt, Collection: addressCollection,\n            replaceValue: args.value\n        };\n        this.parent.notify(findUndoRedo, replaceAllCollection);\n        replaceAllCollection = {\n            undoRedoOpt: 'afterReplaceAll', Collection: addressCollection,\n            replaceValue: args.replaceValue\n        };\n        this.parent.notify(findUndoRedo, replaceAllCollection);\n        var countNumber = count;\n        this.parent.notify(replaceAllDialog, { count: countNumber, replaceValue: args.replaceValue });\n    };\n    WorkbookFindAndReplace.prototype.totalCount = function (args) {\n        var startSheet = 0;\n        var sheet = this.parent.sheets[startSheet];\n        var endRow = sheet.usedRange.rowIndex;\n        var count = 0;\n        var rowIndex = 0;\n        var endColumn = sheet.usedRange.colIndex;\n        var columnIndex = 0;\n        for (rowIndex; rowIndex <= endRow; rowIndex++) {\n            if (sheet.rows[rowIndex]) {\n                var row = sheet.rows[rowIndex];\n                if (columnIndex === endColumn + 1) {\n                    columnIndex = 0;\n                }\n                for (columnIndex; columnIndex <= endColumn; columnIndex++) {\n                    if (row) {\n                        if (row.cells[columnIndex] && row.cells[columnIndex].value) {\n                            var cellType = sheet.rows[rowIndex].cells[columnIndex];\n                            if (cellType) {\n                                var cellFormat = cellType.format;\n                                var cellvalue = void 0;\n                                if (cellFormat) {\n                                    var displayTxt = this.parent.getDisplayText(sheet.rows[rowIndex].\n                                        cells[columnIndex]);\n                                    cellvalue = displayTxt.toString();\n                                }\n                                else {\n                                    cellvalue = cellType.value.toString();\n                                }\n                                if (args.isCSen && args.isEMatch) {\n                                    if (cellvalue === args.value) {\n                                        count++;\n                                    }\n                                }\n                                else if (args.isCSen && !args.isEMatch) {\n                                    var index = cellvalue.indexOf(args.value) > -1;\n                                    if ((cellvalue === args.value) || (index)) {\n                                        count++;\n                                    }\n                                }\n                                else if (!args.isCSen && args.isEMatch) {\n                                    var val = cellvalue.toString().toLowerCase();\n                                    if (val === args.value) {\n                                        count++;\n                                    }\n                                }\n                                else if (!args.isCSen && !args.isEMatch) {\n                                    var val = cellvalue.toString().toLowerCase();\n                                    var index = val.indexOf(args.value.toString().toLowerCase()) > -1;\n                                    var lowerCaseValue = val.indexOf(args.value) > -1;\n                                    if ((val === args.value) || ((cellvalue === args.value) || (index)) || (cellvalue === args.value) ||\n                                        (lowerCaseValue)) {\n                                        count++;\n                                    }\n                                }\n                            }\n                        }\n                    }\n                }\n            }\n        }\n        var totalCount = count;\n        var requiredCount = this.requiredCount(args) - 1;\n        count = totalCount - requiredCount;\n        if (count > totalCount) {\n            count = totalCount;\n        }\n        if (count !== 0) {\n            var activecel = getCellIndexes(sheet.activeCell);\n            var val = this.parent.getDisplayText(sheet.rows[activecel[0]].cells[activecel[1]]).toString().toLowerCase();\n            if (val.indexOf(args.value.toString().toLowerCase()) === -1) {\n                count = count - 1;\n            }\n        }\n        args.findCount = count + ' ' + 'of' + ' ' + totalCount;\n        return;\n    };\n    WorkbookFindAndReplace.prototype.requiredCount = function (args) {\n        var sheetIndex = this.parent.activeSheetIndex;\n        var sheet = this.parent.sheets[sheetIndex];\n        var activecel = getCellIndexes(sheet.activeCell);\n        var endRow = sheet.usedRange.rowIndex;\n        var requiredCount = 0;\n        var startRow = activecel[0];\n        var endColumn = sheet.usedRange.colIndex;\n        var startColumn = activecel[1];\n        for (startRow; startRow <= endRow; startRow++) {\n            if (sheet.rows[startRow]) {\n                var row = sheet.rows[startRow];\n                if (startColumn === endColumn + 1) {\n                    startColumn = 0;\n                }\n                for (startColumn; startColumn <= endColumn; startColumn++) {\n                    if (row) {\n                        if (row.cells[startColumn] && row.cells[startColumn].value) {\n                            if (sheet.rows[startRow].cells[startColumn]) {\n                                var cellval = void 0;\n                                if (sheet.rows[startRow].cells[startColumn].format) {\n                                    var displayTxt = this.parent.getDisplayText(sheet.rows[startRow].\n                                        cells[startColumn]);\n                                    cellval = displayTxt.toString();\n                                }\n                                else {\n                                    cellval = sheet.rows[startRow].cells[startColumn].value.toString();\n                                }\n                                if (args.isCSen && !args.isEMatch) {\n                                    var index = cellval.indexOf(args.value) > -1;\n                                    if ((cellval === args.value) || (index)) {\n                                        requiredCount++;\n                                    }\n                                }\n                                else if (args.isCSen && args.isEMatch) {\n                                    if (cellval === args.value) {\n                                        requiredCount++;\n                                    }\n                                }\n                                else if (!args.isCSen && args.isEMatch) {\n                                    var val = cellval.toString().toLowerCase();\n                                    if (val === args.value) {\n                                        requiredCount++;\n                                    }\n                                }\n                                else if (!args.isCSen && !args.isEMatch) {\n                                    var val = cellval.toString().toLowerCase();\n                                    var argsVal = args.value.toString().toLowerCase();\n                                    var index = val.indexOf(argsVal) > -1;\n                                    var lowerCaseVal = val.indexOf(args.value) > -1;\n                                    if ((cellval === args.value) || ((val === argsVal) || (index)) || (val === args.value) ||\n                                        (lowerCaseVal)) {\n                                        requiredCount++;\n                                    }\n                                }\n                            }\n                        }\n                    }\n                }\n            }\n        }\n        return requiredCount;\n    };\n    WorkbookFindAndReplace.prototype.findAllValues = function (findAllArguments) {\n        var startSheet = findAllArguments.sheetIndex;\n        var sheet = this.parent.sheets[startSheet - 1];\n        var endRow = sheet.usedRange.rowIndex;\n        var rowIndex = 0;\n        var count = 0;\n        var address;\n        var endColumn = sheet.usedRange.colIndex;\n        var columnIndex = 0;\n        var sheetName;\n        var sheetLength = this.parent.sheets.length;\n        var initialSheet = findAllArguments.sheetIndex;\n        for (rowIndex; rowIndex <= endRow + 1; rowIndex++) {\n            if ((initialSheet !== 1) && (findAllArguments.sheetIndex === sheetLength)) {\n                startSheet = 1;\n            }\n            if (rowIndex > endRow && columnIndex > endColumn) {\n                if (findAllArguments.mode === 'Workbook') {\n                    startSheet++;\n                    if (initialSheet === startSheet) {\n                        if (count === 0) {\n                            return;\n                        }\n                        return;\n                    }\n                    if (startSheet > sheetLength - 1) {\n                        startSheet = 0;\n                    }\n                    sheet = this.parent.sheets[startSheet];\n                    if (sheet) {\n                        rowIndex = 0;\n                        columnIndex = 0;\n                        endColumn = sheet.usedRange.colIndex;\n                        endRow = sheet.usedRange.rowIndex;\n                        sheet = sheet;\n                    }\n                }\n            }\n            if (!isNullOrUndefined(sheet)) {\n                if (sheet.rows[rowIndex]) {\n                    var row = sheet.rows[rowIndex];\n                    if (columnIndex === endColumn + 2) {\n                        columnIndex = 0;\n                    }\n                    for (columnIndex; columnIndex <= endColumn + 1; columnIndex++) {\n                        if (row) {\n                            if (row.cells[columnIndex]) {\n                                var cell = sheet.rows[rowIndex].cells[columnIndex];\n                                if (cell) {\n                                    var cellFormat = cell.format;\n                                    var cellvalue = void 0;\n                                    if (cellFormat) {\n                                        var displayTxt = this.parent.getDisplayText(sheet.rows[rowIndex].\n                                            cells[columnIndex]);\n                                        cellvalue = displayTxt.toString();\n                                    }\n                                    else {\n                                        cellvalue = cell.value.toString();\n                                    }\n                                    if (findAllArguments.isCSen && findAllArguments.isEMatch) {\n                                        if (cellvalue === findAllArguments.value) {\n                                            address = sheet.name + '!' + getCellAddress(rowIndex, columnIndex);\n                                            findAllArguments.findCollection.push(address);\n                                            count++;\n                                        }\n                                    }\n                                    else if (findAllArguments.isCSen && !findAllArguments.isEMatch) {\n                                        var index = cellvalue.indexOf(findAllArguments.value) > -1;\n                                        if ((cellvalue === findAllArguments.value) || (index)) {\n                                            address = sheet.name + '!' + getCellAddress(rowIndex, columnIndex);\n                                            findAllArguments.findCollection.push(address);\n                                            count++;\n                                        }\n                                    }\n                                    else if (!findAllArguments.isCSen && findAllArguments.isEMatch) {\n                                        var val = cellvalue.toString().toLowerCase();\n                                        if (val === findAllArguments.value) {\n                                            address = sheet.name + '!' + getCellAddress(rowIndex, columnIndex);\n                                            findAllArguments.findCollection.push(address);\n                                            count++;\n                                        }\n                                    }\n                                    else if (!findAllArguments.isCSen && !findAllArguments.isEMatch) {\n                                        var val = cellvalue.toString().toLowerCase();\n                                        var index = val.indexOf(findAllArguments.value.toLowerCase()) > -1;\n                                        if ((val === findAllArguments.value) || ((cellvalue === findAllArguments.value) || (index)) ||\n                                            ((cellvalue === findAllArguments.value))) {\n                                            address = sheet.name + '!' + getCellAddress(rowIndex, columnIndex);\n                                            findAllArguments.findCollection.push(address);\n                                            count++;\n                                        }\n                                    }\n                                }\n                            }\n                        }\n                    }\n                }\n            }\n        }\n        if (count === 0) {\n            return;\n        }\n        return;\n    };\n    /**\n     * Gets the module name.\n     * @returns string\n     */\n    WorkbookFindAndReplace.prototype.getModuleName = function () {\n        return 'workbookfindAndReplace';\n    };\n    return WorkbookFindAndReplace;\n}());\nexport { WorkbookFindAndReplace };\n","import { setColumn } from '../base/index';\nimport { applyLockCells } from '../common/index';\nimport { protectsheetHandler, protectSheetWorkBook, updateToggle, setLockCells } from '../common/index';\nimport { unprotectsheetHandler } from '../common/index';\nimport { getRangeIndexes, getSwapRange } from '../common/index';\nimport { isUndefined } from '@syncfusion/ej2-base';\n/**\n * The `WorkbookSpreadSheet` module is used to handle the Protecting functionalities in Workbook.\n */\nvar WorkbookProtectSheet = /** @class */ (function () {\n    /**\n     * Constructor for edit module in Workbook.\n     * @private\n     */\n    function WorkbookProtectSheet(workbook) {\n        this.parent = workbook;\n        this.addEventListener();\n    }\n    WorkbookProtectSheet.prototype.protectsheetHandler = function (args) {\n        var sheet = this.parent.getActiveSheet();\n        this.parent.setSheetPropertyOnMute(sheet, 'protectSettings', {\n            selectCells: args.selectCells, formatCells: args.formatCells,\n            formatColumns: args.formatColumns, formatRows: args.formatRows, insertLink: args.insertLink\n        });\n        this.parent.notify(protectSheetWorkBook, sheet.protectSettings);\n        this.parent.notify(updateToggle, { props: 'Protect' });\n        sheet.columns.forEach(function (column) {\n            if (column && isUndefined(column.isLocked)) {\n                column.isLocked = true;\n            }\n        });\n    };\n    WorkbookProtectSheet.prototype.unprotectsheetHandler = function (args) {\n        var sheet = this.parent.getActiveSheet();\n        if (args.sheet) {\n            sheet = this.parent.sheets[args.sheet];\n        }\n        sheet.protectSettings.formatCells = sheet.protectSettings.formatColumns = false;\n        sheet.protectSettings.formatRows = sheet.protectSettings.selectCells = false;\n        this.parent.setSheetPropertyOnMute(sheet, 'isProtected', false);\n        this.parent.notify(protectSheetWorkBook, sheet.protectSettings);\n        this.parent.notify(updateToggle, { props: 'Protect' });\n    };\n    /**\n     * To destroy the edit module.\n     * @return {void}\n     * @hidden\n     */\n    WorkbookProtectSheet.prototype.destroy = function () {\n        this.removeEventListener();\n        this.parent = null;\n    };\n    WorkbookProtectSheet.prototype.addEventListener = function () {\n        this.parent.on(protectsheetHandler, this.protectsheetHandler, this);\n        this.parent.on(unprotectsheetHandler, this.unprotectsheetHandler, this);\n        this.parent.on(setLockCells, this.lockCells, this);\n    };\n    WorkbookProtectSheet.prototype.removeEventListener = function () {\n        if (!this.parent.isDestroyed) {\n            this.parent.off(protectsheetHandler, this.protectsheetHandler);\n            this.parent.off(setLockCells, this.lockCells);\n            this.parent.off(protectsheetHandler, this.unprotectsheetHandler);\n        }\n    };\n    WorkbookProtectSheet.prototype.lockCells = function (args) {\n        var sheet = this.parent.getActiveSheet();\n        var range;\n        if (args) {\n            range = args.range;\n        }\n        else {\n            range = sheet.selectedRange;\n        }\n        var indexes = typeof (range) === 'object' ? range :\n            getSwapRange(getRangeIndexes(range));\n        if (indexes[0] === 0 && indexes[2] === sheet.rowCount - 1) {\n            for (var i = indexes[1]; i <= indexes[3]; i++) {\n                setColumn(sheet, i, { isLocked: args.isLocked });\n            }\n        }\n        for (var i = indexes[0]; i <= indexes[2]; i++) {\n            for (var j = indexes[1]; j <= indexes[3]; j++) {\n                if (this.parent.getActiveSheet().id === sheet.id) {\n                    this.parent.notify(applyLockCells, { rowIdx: i, colIdx: j, isLocked: args.isLocked\n                    });\n                }\n            }\n        }\n    };\n    /**\n     * Get the module name.\n     * @returns string\n     * @private\n     */\n    WorkbookProtectSheet.prototype.getModuleName = function () {\n        return 'workbookProtectSheet';\n    };\n    return WorkbookProtectSheet;\n}());\nexport { WorkbookProtectSheet };\n","import { getCell, setCell } from '../base/index';\nimport { setMerge, getSwapRange, getRangeIndexes, mergedRange, applyMerge, activeCellMergedRange } from './../common/index';\nimport { insertMerge, activeCellChanged, pasteMerge, getCellIndexes, checkIsFormula, setCellFormat } from './../common/index';\nimport { isNullOrUndefined } from '@syncfusion/ej2-base';\n/**\n * The `WorkbookMerge` module is used to merge the range of cells.\n */\nvar WorkbookMerge = /** @class */ (function () {\n    /**\n     * Constructor for the workbook merge module.\n     * @private\n     */\n    function WorkbookMerge(parent) {\n        this.parent = parent;\n        this.addEventListener();\n    }\n    WorkbookMerge.prototype.merge = function (args) {\n        if (args.isAction) {\n            this.parent.notify('actionBegin', { eventArgs: args, action: 'merge' });\n            if (!args.model) {\n                args.model = [];\n            }\n        }\n        if (typeof (args.range) === 'string') {\n            args.range = getRangeIndexes(args.range);\n        }\n        args.range = getSwapRange(args.range);\n        var sheet = args.sheet || this.parent.getActiveSheet();\n        if (!args.skipChecking) {\n            this.mergedRange(args);\n        }\n        if (!args.merge || args.type === 'All') {\n            this.mergeAll(args);\n            if (args.refreshRibbon) {\n                this.parent.notify(activeCellChanged, null);\n            }\n        }\n        else if (args.type === 'Horizontally') {\n            this.mergeHorizontally(args);\n        }\n        else if (args.type === 'Vertically') {\n            this.mergeVertically(args);\n        }\n        this.parent.setUsedRange(args.range[2], args.range[3]);\n        if (args.isAction) {\n            this.parent.notify('actionComplete', { eventArgs: args, action: 'merge' });\n        }\n        if (this.parent.sheets.indexOf(sheet) === this.parent.activeSheetIndex) {\n            this.parent.notify('selectRange', { indexes: getRangeIndexes(sheet.selectedRange), skipChecking: true });\n        }\n    };\n    WorkbookMerge.prototype.mergeAll = function (args) {\n        var rowSpan = 0;\n        var cell;\n        args.range = args.range;\n        var colSpan;\n        var value;\n        var sheet = args.sheet || this.parent.getActiveSheet();\n        var curCell;\n        var startCell = getCell(args.range[0], args.range[1], sheet);\n        var border = startCell ? (startCell.style ? startCell.style.borderLeft : null) : null;\n        if (border === 'none') {\n            border = startCell.style.borderRight !== 'none' ? startCell.style.borderRight :\n                (startCell.style.borderTop ? startCell.style.borderTop : null);\n        }\n        if (border === 'none') {\n            border = startCell.style.borderBottom !== 'none' ? startCell.style.borderBottom : null;\n        }\n        if (!isNullOrUndefined(startCell) && !isNullOrUndefined(border)) {\n            startCell.style.borderBottom = '';\n            startCell.style.borderLeft = '';\n            startCell.style.borderTop = '';\n            startCell.style.borderRight = '';\n        }\n        for (var i = args.range[0]; i <= args.range[2]; i++) {\n            colSpan = 0;\n            if (args.isAction) {\n                args.model.push({ cells: [] });\n            }\n            for (var j = args.range[1]; j <= args.range[3]; j++) {\n                cell = getCell(i, j, sheet);\n                if (cell && (cell.value || cell.formula) && !value) {\n                    value = cell.formula || cell.value;\n                }\n                if (args.isAction && args.merge) {\n                    args.model[i - args.range[0]].cells[j - args.range[1]] = {};\n                    Object.assign(args.model[i - args.range[0]].cells[j - args.range[1]], cell);\n                }\n                if (sheet.rows[i] && sheet.rows[i].cells && sheet.rows[i].cells[j]) {\n                    delete sheet.rows[i].cells[j].rowSpan;\n                    delete sheet.rows[i].cells[j].colSpan;\n                    if (!args.merge && !args.isAction && args.model && args.model[i - args.range[0]] && args.model[i - args.range[0]].\n                        cells[j - args.range[1]] && args.model[i - args.range[0]].cells[j - args.range[1]] !== {}) {\n                        setCell(i, j, sheet, args.model[i - args.range[0]].cells[j - args.range[1]]);\n                    }\n                }\n                if (args.merge) {\n                    cell = new Object();\n                    if (i === args.range[0] && j === args.range[1]) {\n                        if (args.range[3] - args.range[1] > 0) {\n                            cell.colSpan = (args.range[3] - args.range[1]) + 1;\n                        }\n                        if (args.range[2] - args.range[0] > 0) {\n                            cell.rowSpan = (args.range[2] - args.range[0]) + 1;\n                        }\n                        setCell(args.range[0], args.range[1], sheet, cell, true);\n                        continue;\n                    }\n                    else {\n                        if (i !== args.range[0]) {\n                            cell.rowSpan = -rowSpan;\n                        }\n                        if (j !== args.range[1]) {\n                            colSpan++;\n                            cell.colSpan = -colSpan;\n                        }\n                        if (sheet.rows[i] && sheet.rows[i].cells && sheet.rows[i].cells[j]) {\n                            delete sheet.rows[i].cells[j].value;\n                            delete sheet.rows[i].cells[j].formula;\n                        }\n                        curCell = getCell(i, j, sheet) || {};\n                        setCell(i, j, sheet, Object.assign(cell, curCell));\n                    }\n                }\n                if (!args.preventRefresh) {\n                    this.parent.notify(applyMerge, { rowIdx: i, colIdx: j });\n                }\n            }\n            rowSpan++;\n        }\n        if (args.merge) {\n            cell = this.getCellValue(args.range[0], args.range[1], value, sheet);\n            setCell(args.range[0], args.range[1], sheet, cell, true);\n            if (!args.preventRefresh) {\n                this.parent.notify(applyMerge, { rowIdx: args.range[0], colIdx: args.range[1] });\n            }\n        }\n        if (!isNullOrUndefined(border)) {\n            this.parent.notify(setCellFormat, { style: { border: border }, range: args.range, onActionUpdate: true });\n        }\n    };\n    WorkbookMerge.prototype.mergeHorizontally = function (args) {\n        var mergeCount;\n        args.range = args.range;\n        var cell;\n        var sheet = args.sheet || this.parent.getActiveSheet();\n        var newValue;\n        var rowIdx;\n        var curCell;\n        for (var i = args.range[0]; i <= args.range[2]; i++) {\n            mergeCount = 0;\n            if (args.isAction) {\n                args.model.push({ cells: [] });\n            }\n            for (var j = args.range[1]; j <= args.range[3]; j++) {\n                curCell = getCell(i, j, sheet);\n                cell = new Object();\n                if (args.isAction) {\n                    args.model[i - args.range[0]].cells[j - args.range[1]] = {};\n                    Object.assign(args.model[i - args.range[0]].cells[j - args.range[1]], curCell);\n                }\n                if (j === args.range[1]) {\n                    if (i === args.range[0]) {\n                        continue;\n                    }\n                    rowIdx = i - 1;\n                    if (sheet.rows[rowIdx] && sheet.rows[rowIdx].cells && sheet.rows[rowIdx].cells[j]) {\n                        delete sheet.rows[rowIdx].cells[j].rowSpan;\n                    }\n                    cell = this.getCellValue(rowIdx, j, newValue, sheet);\n                    if (args.range[3] - args.range[1] > 0) {\n                        cell.colSpan = (args.range[3] - args.range[1]) + 1;\n                    }\n                    newValue = null;\n                    setCell(rowIdx, j, sheet, cell, true);\n                }\n                else {\n                    if (curCell && (curCell.value || curCell.formula) && !newValue) {\n                        newValue = curCell.formula || curCell.value;\n                    }\n                    rowIdx = i;\n                    if (sheet.rows[rowIdx] && sheet.rows[rowIdx].cells && sheet.rows[rowIdx].cells[j]) {\n                        delete sheet.rows[rowIdx].cells[j].rowSpan;\n                        delete sheet.rows[rowIdx].cells[j].value;\n                        delete sheet.rows[rowIdx].cells[j].formula;\n                    }\n                    mergeCount++;\n                    cell.colSpan = -mergeCount;\n                    setCell(rowIdx, j, sheet, cell, true);\n                }\n                this.parent.notify(applyMerge, { rowIdx: rowIdx, colIdx: j });\n            }\n        }\n        if (sheet.rows[args.range[2]] && sheet.rows[args.range[2]].cells && sheet.rows[args.range[2]].cells[args.range[1]]) {\n            delete sheet.rows[args.range[2]].cells[args.range[1]].rowSpan;\n        }\n        cell = this.getCellValue(args.range[2], args.range[1], newValue, sheet);\n        if (args.range[3] - args.range[1] > 0) {\n            cell.colSpan = (args.range[3] - args.range[1]) + 1;\n        }\n        setCell(args.range[2], args.range[1], sheet, cell, true);\n        this.parent.notify(applyMerge, { rowIdx: args.range[2], colIdx: args.range[1] });\n    };\n    WorkbookMerge.prototype.getCellValue = function (rowIdx, colIdx, value, sheet) {\n        var cell = new Object();\n        var curCell = getCell(rowIdx, colIdx, sheet);\n        if (value && (!curCell || (!curCell.value && !curCell.formula))) {\n            if (checkIsFormula(value)) {\n                cell.formula = value;\n            }\n            else {\n                cell.value = value;\n            }\n        }\n        return cell;\n    };\n    WorkbookMerge.prototype.mergeVertically = function (args) {\n        var rowSpan = 0;\n        args.range = args.range;\n        var sheet = args.sheet || this.parent.getActiveSheet();\n        var cell;\n        var newValue;\n        var colIdx;\n        var curCell;\n        for (var i = args.range[1]; i <= args.range[3]; i++) {\n            for (var j = args.range[0]; j <= args.range[2]; j++) {\n                curCell = getCell(j, i, sheet);\n                if (args.isAction) {\n                    if (args.model[j - args.range[0]] === undefined) {\n                        args.model[j - args.range[0]] = { cells: [] };\n                    }\n                    args.model[j - args.range[0]].cells[i - args.range[1]] = {};\n                    Object.assign(args.model[j - args.range[0]].cells[i - args.range[1]], curCell);\n                }\n                if (j === args.range[0]) {\n                    rowSpan = 0;\n                    if (i === args.range[1]) {\n                        continue;\n                    }\n                    colIdx = i - 1;\n                    if (sheet.rows[j] && sheet.rows[j].cells && sheet.rows[j].cells[colIdx]) {\n                        delete sheet.rows[j].cells[colIdx].colSpan;\n                    }\n                    cell = this.getCellValue(j, colIdx, newValue, sheet);\n                    if (args.range[2] - args.range[0] > 0) {\n                        cell.rowSpan = (args.range[2] - args.range[0]) + 1;\n                    }\n                    newValue = null;\n                    setCell(j, colIdx, sheet, cell, true);\n                }\n                else {\n                    cell = new Object();\n                    if (curCell && (curCell.value || curCell.formula) && !newValue) {\n                        newValue = curCell.formula || curCell.value;\n                    }\n                    rowSpan++;\n                    colIdx = i;\n                    if (sheet.rows[j] && sheet.rows[j].cells && sheet.rows[j].cells[colIdx]) {\n                        delete sheet.rows[j].cells[colIdx].colSpan;\n                        delete sheet.rows[j].cells[colIdx].value;\n                        delete sheet.rows[j].cells[colIdx].formula;\n                    }\n                    cell.rowSpan = -rowSpan;\n                    setCell(j, colIdx, sheet, cell, true);\n                }\n                this.parent.notify(applyMerge, { rowIdx: j, colIdx: colIdx });\n            }\n        }\n        if (sheet.rows[args.range[0]] && sheet.rows[args.range[0]].cells && sheet.rows[args.range[0]].cells[args.range[3]]) {\n            delete sheet.rows[args.range[0]].cells[args.range[3]].colSpan;\n        }\n        cell = this.getCellValue(args.range[0], args.range[1], newValue, sheet);\n        if (args.range[2] - args.range[0] > 0) {\n            cell.rowSpan = (args.range[2] - args.range[0]) + 1;\n        }\n        setCell(args.range[0], args.range[3], sheet, cell, true);\n        this.parent.notify(applyMerge, { rowIdx: args.range[0], colIdx: args.range[3] });\n    };\n    WorkbookMerge.prototype.activeCellRange = function (args) {\n        args.range = args.range;\n        var sheet = this.parent.getActiveSheet();\n        var cell = getCell(args.range[0], args.range[1], sheet);\n        if (cell) {\n            if (!isNullOrUndefined(cell.rowSpan) && cell.rowSpan < 0) {\n                args.range[0] += cell.rowSpan;\n                if (args.insertCount) {\n                    args.range[0] -= args.insertCount;\n                }\n            }\n            if (!isNullOrUndefined(cell.colSpan) && cell.colSpan < 0) {\n                args.range[1] += cell.colSpan;\n                if (args.insertCount) {\n                    args.range[1] -= args.insertCount;\n                }\n            }\n            cell = getCell(args.range[0], args.range[1], sheet);\n            if (cell) {\n                if (cell.rowSpan > 1 && (args.range[0] + (cell.rowSpan - 1) >= args.range[2] || args.insertCount)) {\n                    args.range[2] = args.range[0] + (cell.rowSpan - 1);\n                }\n                if (cell.colSpan > 1 && (args.range[1] + (cell.colSpan - 1) >= args.range[3] || args.insertCount)) {\n                    args.range[3] = args.range[1] + (cell.colSpan - 1);\n                }\n            }\n        }\n    };\n    WorkbookMerge.prototype.mergedRange = function (args) {\n        if (typeof (args.range) === 'string') {\n            args.range = getRangeIndexes(args.range);\n        }\n        if (args.range[0] <= args.range[2] && args.range[1] <= args.range[3]) {\n            this.forward(args);\n        }\n        else if (args.range[0] >= args.range[2] && args.range[1] >= args.range[3]) {\n            this.reverse(args);\n        }\n        else if (args.range[0] < args.range[2] && args.range[1] > args.range[3]) {\n            this.forwardReverse(args);\n        }\n        else if (args.range[0] > args.range[2] && args.range[1] < args.range[3]) {\n            this.reverseForward(args);\n        }\n    };\n    WorkbookMerge.prototype.forward = function (args) {\n        args.range = args.range;\n        var sheet = args.sheet || this.parent.getActiveSheet();\n        var cell = getCell(args.range[0], args.range[1], sheet);\n        var endRowIdx;\n        var endColIdx;\n        var rowIdx = endRowIdx = args.range[0];\n        var colIdx = endColIdx = args.range[1];\n        if (cell) {\n            if (!isNullOrUndefined(cell.rowSpan) && cell.rowSpan < 0) {\n                rowIdx = endRowIdx = args.range[0] + cell.rowSpan;\n            }\n            if (!isNullOrUndefined(cell.colSpan) && cell.colSpan < 0) {\n                colIdx = endColIdx = args.range[1] + cell.colSpan;\n            }\n            cell = getCell(rowIdx, colIdx, sheet);\n            if (cell) {\n                if (cell.rowSpan > 1) {\n                    endRowIdx += (cell.rowSpan - 1);\n                    if (rowIdx + (cell.rowSpan - 1) >= args.range[2]) {\n                        args.range[2] = args.range[0];\n                        args.range[2] = rowIdx + (cell.rowSpan - 1);\n                    }\n                }\n                if (cell.colSpan > 1) {\n                    endColIdx += (cell.colSpan - 1);\n                    if (colIdx + (cell.colSpan - 1) >= args.range[3]) {\n                        args.range[3] = args.range[1];\n                        args.range[3] = colIdx + (cell.colSpan - 1);\n                    }\n                }\n            }\n        }\n        args.range[0] = rowIdx;\n        args.range[1] = colIdx;\n        if (args.range[0] === rowIdx && args.range[1] === colIdx && args.range[2] === endRowIdx && args.range[3] === endColIdx) {\n            args.isActiveCell = true;\n        }\n        if (args.skipChecking) {\n            return;\n        }\n        for (var i = args.range[1]; i <= args.range[3]; i++) {\n            cell = getCell(args.range[2], i, sheet);\n            if (cell) {\n                rowIdx = args.range[2];\n                colIdx = i;\n                if (!isNullOrUndefined(cell.colSpan) && cell.colSpan < 0) {\n                    colIdx += cell.colSpan;\n                    if (colIdx < args.range[1]) {\n                        args.range[1] = colIdx;\n                    }\n                }\n                if (!isNullOrUndefined(cell.rowSpan) && cell.rowSpan < 0) {\n                    rowIdx += cell.rowSpan;\n                    if (rowIdx < args.range[0]) {\n                        args.range[0] = rowIdx;\n                    }\n                }\n                cell = getCell(rowIdx, colIdx, sheet);\n                if (cell) {\n                    if (cell.colSpan > 1 && colIdx + (cell.colSpan - 1) > args.range[3]) {\n                        args.range[3] = colIdx;\n                        args.range[3] = colIdx + (cell.colSpan - 1);\n                    }\n                    if (cell.rowSpan > 1 && rowIdx + (cell.rowSpan - 1) > args.range[2]) {\n                        args.range[2] = rowIdx;\n                        args.range[2] = rowIdx + (cell.rowSpan - 1);\n                    }\n                }\n            }\n        }\n        var startRowIdx;\n        var startColIdx;\n        for (var i = args.range[1]; i <= args.range[3]; i++) {\n            cell = getCell(args.range[0], i, sheet);\n            if (cell) {\n                startColIdx = i;\n                startRowIdx = args.range[0];\n                if (!isNullOrUndefined(cell.colSpan) && cell.colSpan < 0) {\n                    startColIdx += cell.colSpan;\n                    if (startColIdx < args.range[1]) {\n                        args.range[1] = startColIdx;\n                    }\n                }\n                if (!isNullOrUndefined(cell.rowSpan) && cell.rowSpan < 0) {\n                    startRowIdx += cell.rowSpan;\n                    if (startRowIdx < args.range[0]) {\n                        args.range[0] = startRowIdx;\n                    }\n                }\n            }\n        }\n        for (var i = args.range[0]; i <= args.range[2]; i++) {\n            cell = getCell(i, args.range[3], sheet);\n            if (cell) {\n                rowIdx = i;\n                colIdx = args.range[3];\n                if (!isNullOrUndefined(cell.rowSpan) && cell.rowSpan < 0) {\n                    rowIdx += cell.rowSpan;\n                    if (rowIdx < args.range[0]) {\n                        args.range[0] = rowIdx;\n                    }\n                }\n                if (!isNullOrUndefined(cell.colSpan) && cell.colSpan < 0) {\n                    colIdx += cell.colSpan;\n                    if (colIdx < args.range[1]) {\n                        args.range[1] = colIdx;\n                    }\n                }\n                cell = getCell(rowIdx, colIdx, sheet);\n                if (cell) {\n                    if (cell.rowSpan > 1 && rowIdx + (cell.rowSpan - 1) > args.range[2]) {\n                        args.range[2] = rowIdx;\n                        args.range[2] = rowIdx + (cell.rowSpan - 1);\n                    }\n                    if (cell.colSpan > 1 && colIdx + (cell.colSpan - 1) > args.range[3]) {\n                        args.range[3] = colIdx;\n                        args.range[3] = colIdx + (cell.colSpan - 1);\n                    }\n                }\n            }\n        }\n    };\n    WorkbookMerge.prototype.forwardReverse = function (args) {\n        var sheet = this.parent.getActiveSheet();\n        args.range = args.range;\n        var colIndex = args.range[1];\n        var cell = getCell(args.range[0], args.range[1], sheet);\n        var rowIndex = args.range[0];\n        if (cell) {\n            if (!isNullOrUndefined(cell.colSpan) && cell.colSpan < 0) {\n                colIndex += cell.colSpan;\n                if (args.range[3] >= colIndex) {\n                    args.range[3] = colIndex;\n                }\n            }\n            if (!isNullOrUndefined(cell.rowSpan) && cell.rowSpan < 0) {\n                rowIndex += cell.rowSpan;\n                if (rowIndex < args.range[0]) {\n                    args.range[0] = rowIndex;\n                }\n            }\n            cell = getCell(rowIndex, colIndex, sheet);\n            if (cell) {\n                if (cell.rowSpan > 1 && rowIndex + (cell.rowSpan - 1) >= args.range[2]) {\n                    args.range[2] = rowIndex + (cell.rowSpan - 1);\n                }\n                if (cell.colSpan > 1 && colIndex + (cell.colSpan - 1) >= args.range[1]) {\n                    args.range[1] = colIndex + (cell.colSpan - 1);\n                }\n            }\n        }\n        args.range[0] = rowIndex;\n        if (args.skipChecking) {\n            return;\n        }\n        var rowIdx;\n        var cellIdx;\n        for (var i = args.range[3]; i <= args.range[1]; i++) {\n            cell = getCell(args.range[2], i, sheet);\n            if (cell) {\n                cellIdx = i;\n                rowIdx = args.range[2];\n                if (!isNullOrUndefined(cell.rowSpan) && cell.rowSpan < 0) {\n                    rowIdx += cell.rowSpan;\n                    if (rowIdx < args.range[0]) {\n                        args.range[0] = rowIdx;\n                    }\n                }\n                if (!isNullOrUndefined(cell.colSpan) && cell.colSpan < 0) {\n                    cellIdx += cell.colSpan;\n                    if (cellIdx < args.range[3]) {\n                        args.range[3] = cellIdx;\n                    }\n                }\n                cell = getCell(rowIdx, cellIdx, sheet);\n                if (cell) {\n                    if (cell.rowSpan > 1 && rowIdx + (cell.rowSpan - 1) > args.range[2]) {\n                        args.range[2] = rowIdx + (cell.rowSpan - 1);\n                    }\n                    if (cell.colSpan > 1 && cellIdx + (cell.colSpan - 1) > args.range[1]) {\n                        args.range[1] = cellIdx + (cell.colSpan - 1);\n                    }\n                }\n            }\n        }\n        var startRowIndex;\n        for (var i = args.range[3]; i <= args.range[1]; i++) {\n            cell = getCell(args.range[0], i, sheet);\n            if (cell) {\n                cellIdx = i;\n                startRowIndex = args.range[0];\n                if (!isNullOrUndefined(cell.rowSpan) && cell.rowSpan < 0) {\n                    startRowIndex += cell.rowSpan;\n                    if (startRowIndex < args.range[0]) {\n                        args.range[0] = startRowIndex;\n                    }\n                }\n                if (!isNullOrUndefined(cell.colSpan) && cell.colSpan < 0) {\n                    cellIdx += cell.colSpan;\n                }\n                cell = getCell(startRowIndex, cellIdx, sheet);\n                if (cell) {\n                    if (cell.rowSpan > 1 && startRowIndex + (cell.rowSpan - 1) > args.range[2]) {\n                        args.range[2] = startRowIndex + (cell.rowSpan - 1);\n                    }\n                    if (cell.colSpan > 1 && cellIdx + (cell.colSpan - 1) > args.range[1]) {\n                        args.range[1] = cellIdx;\n                        args.range[1] = cellIdx + (cell.colSpan - 1);\n                    }\n                }\n            }\n        }\n        var colIdx;\n        for (var i = args.range[0]; i <= args.range[2]; i++) {\n            cell = getCell(i, args.range[3], sheet);\n            if (cell) {\n                startRowIndex = i;\n                colIdx = args.range[3];\n                if (!isNullOrUndefined(cell.rowSpan) && cell.rowSpan < 0) {\n                    startRowIndex += cell.rowSpan;\n                    if (startRowIndex < args.range[0]) {\n                        args.range[0] = startRowIndex;\n                    }\n                }\n                if (!isNullOrUndefined(cell.colSpan) && cell.colSpan < 0) {\n                    colIdx += cell.colSpan;\n                    if (colIdx < args.range[3]) {\n                        args.range[3] = colIdx;\n                    }\n                }\n                cell = getCell(startRowIndex, colIdx, sheet);\n                if (cell) {\n                    if (cell.rowSpan > 1 && startRowIndex + (cell.rowSpan - 1) > args.range[2]) {\n                        args.range[2] = startRowIndex;\n                        args.range[2] = startRowIndex + (cell.rowSpan - 1);\n                    }\n                    if (cell.colSpan > 1 && colIdx + (cell.colSpan - 1) > args.range[1]) {\n                        args.range[1] = colIdx;\n                        args.range[1] = colIdx + (cell.colSpan - 1);\n                    }\n                }\n            }\n        }\n    };\n    WorkbookMerge.prototype.reverse = function (args) {\n        args.range = args.range;\n        var colnIdx = args.range[1];\n        var sheet = args.sheet || this.parent.getActiveSheet();\n        var cell = getCell(args.range[0], args.range[1], sheet);\n        var rowIdx = args.range[0];\n        if (cell) {\n            if (!isNullOrUndefined(cell.colSpan) && cell.colSpan < 0) {\n                colnIdx += cell.colSpan;\n            }\n            if (!isNullOrUndefined(cell.rowSpan) && cell.rowSpan < 0) {\n                rowIdx += cell.rowSpan;\n            }\n            if (args.range[2] >= rowIdx) {\n                args.range[2] = rowIdx;\n                args.isActiveCell = true;\n            }\n            if (args.range[3] >= colnIdx) {\n                args.range[3] = colnIdx;\n                if (args.range[2] === rowIdx) {\n                    args.isActiveCell = true;\n                }\n            }\n            else if (args.isActiveCell) {\n                args.isActiveCell = false;\n            }\n            cell = getCell(rowIdx, colnIdx, sheet);\n            if (cell) {\n                if (cell.rowSpan > 1 && rowIdx + (cell.rowSpan - 1) >= args.range[0]) {\n                    args.range[0] = rowIdx;\n                    args.range[0] = rowIdx + (cell.rowSpan - 1);\n                }\n                if (cell.colSpan > 1 && colnIdx + (cell.colSpan - 1) >= args.range[1]) {\n                    args.range[1] = colnIdx;\n                    args.range[1] = colnIdx + (cell.colSpan - 1);\n                }\n            }\n        }\n        var colIdx = args.range[3];\n        if (args.skipChecking) {\n            return;\n        }\n        for (var i = args.range[3]; i <= args.range[1]; i++) {\n            cell = getCell(args.range[2], i, sheet);\n            if (cell) {\n                colIdx = i;\n                rowIdx = args.range[2];\n                if (!isNullOrUndefined(cell.rowSpan) && cell.rowSpan < 0) {\n                    rowIdx += cell.rowSpan;\n                    if (rowIdx < args.range[2]) {\n                        args.range[2] = rowIdx;\n                    }\n                }\n                if (!isNullOrUndefined(cell.colSpan) && cell.colSpan < 0) {\n                    colIdx += cell.colSpan;\n                    if (colIdx < args.range[3]) {\n                        args.range[3] = colIdx;\n                    }\n                }\n                cell = getCell(rowIdx, colIdx, sheet);\n                if (cell) {\n                    if (cell.rowSpan > 1 && rowIdx + (cell.rowSpan - 1) > args.range[0]) {\n                        args.range[0] = rowIdx;\n                        args.range[0] = rowIdx + (cell.rowSpan - 1);\n                    }\n                    if (cell.colSpan > 1 && colIdx + (cell.colSpan - 1) > args.range[1]) {\n                        args.range[1] = colIdx;\n                        args.range[1] = colIdx + (cell.colSpan - 1);\n                    }\n                }\n            }\n        }\n        colIdx = args.range[3];\n        for (var i = args.range[3]; i <= args.range[1]; i++) {\n            cell = getCell(args.range[0], i, sheet);\n            if (cell) {\n                colIdx = i;\n                rowIdx = args.range[0];\n                if (!isNullOrUndefined(cell.colSpan) && cell.colSpan < 0) {\n                    colIdx += cell.colSpan;\n                }\n                if (!isNullOrUndefined(cell.rowSpan) && cell.rowSpan < 0) {\n                    rowIdx += cell.rowSpan;\n                }\n                cell = getCell(rowIdx, colIdx, sheet);\n                if (cell) {\n                    if (cell.colSpan > 1 && colIdx + (cell.colSpan - 1) > args.range[1]) {\n                        args.range[1] = colIdx;\n                        args.range[1] = colIdx + (cell.colSpan - 1);\n                    }\n                    if (cell.rowSpan > 1 && rowIdx + (cell.rowSpan - 1) > args.range[0]) {\n                        args.range[0] = rowIdx;\n                        args.range[0] = rowIdx + (cell.rowSpan - 1);\n                    }\n                }\n            }\n        }\n        var cellIndex;\n        var rIdx;\n        for (var i = args.range[2]; i <= args.range[0]; i++) {\n            cell = getCell(i, args.range[3], sheet);\n            if (cell) {\n                rIdx = i;\n                cellIndex = args.range[3];\n                if (!isNullOrUndefined(cell.rowSpan) && cell.rowSpan < 0) {\n                    rIdx += cell.rowSpan;\n                    if (rIdx < args.range[2]) {\n                        args.range[2] = rIdx;\n                    }\n                }\n                if (!isNullOrUndefined(cell.colSpan) && cell.colSpan < 0) {\n                    cellIndex += cell.colSpan;\n                    if (cellIndex < args.range[3]) {\n                        args.range[3] = cellIndex;\n                    }\n                }\n                cell = getCell(rIdx, cellIndex, sheet);\n                if (cell) {\n                    if (cell.rowSpan > 1 && rIdx + (cell.rowSpan - 1) > args.range[0]) {\n                        args.range[0] = rIdx;\n                        args.range[0] = rIdx + (cell.rowSpan - 1);\n                    }\n                    if (cell.colSpan > 1 && cellIndex + (cell.colSpan - 1) > args.range[1]) {\n                        args.range[1] = cellIndex;\n                        args.range[1] = cellIndex + (cell.colSpan - 1);\n                    }\n                }\n            }\n        }\n    };\n    WorkbookMerge.prototype.reverseForward = function (args) {\n        args.range = args.range;\n        var sheet = args.sheet || this.parent.getActiveSheet();\n        var rIdx = args.range[0];\n        var cIdx = args.range[1];\n        var cell = getCell(args.range[0], args.range[1], sheet);\n        if (cell) {\n            if (!isNullOrUndefined(cell.rowSpan) && cell.rowSpan < 0) {\n                rIdx += cell.rowSpan;\n                if (args.range[2] >= rIdx) {\n                    args.range[2] = rIdx;\n                }\n            }\n            if (!isNullOrUndefined(cell.colSpan) && cell.colSpan < 0) {\n                cIdx += cell.colSpan;\n            }\n            cell = getCell(rIdx, cIdx, sheet);\n            if (cell) {\n                if (cell.rowSpan > 1 && rIdx + (cell.rowSpan - 1) >= args.range[0]) {\n                    args.range[0] = rIdx;\n                    args.range[0] = rIdx + (cell.rowSpan - 1);\n                }\n                if (cell.colSpan > 1 && cIdx + (cell.colSpan - 1) >= args.range[3]) {\n                    args.range[3] = args.range[1];\n                    args.range[3] = cIdx + (cell.colSpan - 1);\n                }\n            }\n        }\n        if (args.skipChecking) {\n            return;\n        }\n        var cIndex = args.range[3];\n        var rIndex;\n        for (var i = args.range[1]; i <= args.range[3]; i++) {\n            cell = getCell(args.range[2], i, sheet);\n            if (cell) {\n                rIndex = args.range[2];\n                cIndex = i;\n                if (!isNullOrUndefined(cell.rowSpan) && cell.rowSpan < 0) {\n                    rIndex += cell.rowSpan;\n                    if (rIndex < args.range[2]) {\n                        args.range[2] = rIndex;\n                    }\n                }\n                if (!isNullOrUndefined(cell.colSpan) && cell.colSpan < 0) {\n                    cIndex += cell.colSpan;\n                    if (cIndex < args.range[1]) {\n                        args.range[1] = cIndex;\n                    }\n                }\n                cell = getCell(rIndex, cIndex, sheet);\n                if (cell) {\n                    if (cell.colSpan > 1 && cIndex + (cell.colSpan - 1) > args.range[3]) {\n                        args.range[3] = cIndex + (cell.colSpan - 1);\n                    }\n                    if (cell.rowSpan > 1 && (cell.rowSpan - 1) + rIndex > args.range[0]) {\n                        args.range[0] = (cell.rowSpan - 1) + rIndex;\n                    }\n                }\n            }\n        }\n        var sRowIdx;\n        var sColIdx;\n        for (var i = args.range[1]; i <= args.range[3]; i++) {\n            cell = getCell(args.range[0], i, sheet);\n            if (cell) {\n                sColIdx = i;\n                sRowIdx = args.range[0];\n                if (!isNullOrUndefined(cell.colSpan) && cell.colSpan < 0) {\n                    sColIdx += cell.colSpan;\n                    if (sColIdx < args.range[1]) {\n                        args.range[1] = sColIdx;\n                    }\n                }\n                if (!isNullOrUndefined(cell.rowSpan) && cell.rowSpan < 0) {\n                    sRowIdx += cell.rowSpan;\n                }\n                cell = getCell(sRowIdx, sColIdx, sheet);\n                if (cell) {\n                    if (cell.rowSpan > 1 && sRowIdx + (cell.rowSpan - 1) > args.range[0]) {\n                        args.range[0] = sRowIdx + (cell.rowSpan - 1);\n                    }\n                }\n            }\n        }\n        var cellIndex;\n        for (var i = args.range[2]; i <= args.range[0]; i++) {\n            cell = getCell(i, args.range[3], sheet);\n            if (cell) {\n                rIndex = i;\n                cellIndex = args.range[3];\n                if (!isNullOrUndefined(cell.rowSpan) && cell.rowSpan < 0) {\n                    rIndex += cell.rowSpan;\n                    if (rIndex < args.range[2]) {\n                        args.range[2] = rIndex;\n                    }\n                }\n                if (!isNullOrUndefined(cell.colSpan) && cell.colSpan < 0) {\n                    cellIndex += cell.colSpan;\n                    if (cellIndex < args.range[1]) {\n                        args.range[1] = cellIndex;\n                    }\n                }\n                cell = getCell(rIndex, cellIndex, sheet);\n                if (cell) {\n                    if (cell.rowSpan > 1 && (cell.rowSpan - 1) + rIndex > args.range[0]) {\n                        args.range[0] = (cell.rowSpan - 1) + rIndex;\n                    }\n                    if (cell.colSpan > 1 && (cell.colSpan - 1) + cellIndex > args.range[3]) {\n                        args.range[3] = cellIndex;\n                        args.range[3] = (cell.colSpan - 1) + cellIndex;\n                    }\n                }\n            }\n        }\n    };\n    WorkbookMerge.prototype.insertHandler = function (args) {\n        this.activeCellRange(args);\n        args.range = args.range;\n        if (args.insertModel === 'Row') {\n            args.range[2] += args.insertCount;\n        }\n        else {\n            args.range[3] += args.insertCount;\n        }\n        args.preventRefresh = true;\n        args.merge = true;\n        this.mergeAll(args);\n    };\n    WorkbookMerge.prototype.pasteHandler = function (args) {\n        var sheet = this.parent.getActiveSheet();\n        var cell;\n        var nextCell;\n        var prevCell;\n        var activeCell = getCellIndexes(sheet.activeCell);\n        for (var i = args.range[0], l = 0; i <= args.range[2]; i++, l++) {\n            for (var j = args.range[1], k = 0; j <= args.range[3]; j++, k++) {\n                cell = getCell(i, j, args.prevSheet) || {};\n                if (cell.rowSpan > 1) {\n                    prevCell = getCell(activeCell[0] + (cell.rowSpan - 1), activeCell[1], sheet) || {};\n                    nextCell = getCell(activeCell[0] + 1, activeCell[1], sheet) || {};\n                    if ((prevCell.colSpan !== undefined && prevCell.colSpan < 0) || (nextCell.colSpan !== undefined &&\n                        nextCell.colSpan < 0)) {\n                        args.cancel = true;\n                        this.parent.notify(applyMerge, { showDialog: true });\n                        return;\n                    }\n                }\n                if (cell.colSpan > 1) {\n                    prevCell = getCell(activeCell[0], activeCell[1] + (cell.colSpan - 1), sheet) || {};\n                    nextCell = getCell(activeCell[0], activeCell[1] + 1, sheet) || {};\n                    if ((prevCell.rowSpan !== undefined && prevCell.rowSpan < 0) || (nextCell.rowSpan !== undefined &&\n                        nextCell.rowSpan < 0)) {\n                        args.cancel = true;\n                        this.parent.notify(applyMerge, { showDialog: true });\n                        return;\n                    }\n                }\n            }\n        }\n    };\n    WorkbookMerge.prototype.addEventListener = function () {\n        this.parent.on(setMerge, this.merge, this);\n        this.parent.on(mergedRange, this.mergedRange, this);\n        this.parent.on(activeCellMergedRange, this.activeCellRange, this);\n        this.parent.on(insertMerge, this.insertHandler, this);\n        this.parent.on(pasteMerge, this.pasteHandler, this);\n    };\n    /**\n     * Destroy workbook merge module.\n     */\n    WorkbookMerge.prototype.destroy = function () {\n        this.removeEventListener();\n        this.parent = null;\n    };\n    WorkbookMerge.prototype.removeEventListener = function () {\n        if (!this.parent.isDestroyed) {\n            this.parent.off(setMerge, this.merge);\n            this.parent.off(mergedRange, this.mergedRange);\n            this.parent.off(activeCellMergedRange, this.activeCellRange);\n            this.parent.off(insertMerge, this.insertHandler);\n            this.parent.off(pasteMerge, this.pasteHandler);\n        }\n    };\n    /**\n     * Get the workbook merge module name.\n     */\n    WorkbookMerge.prototype.getModuleName = function () {\n        return 'workbookmerge';\n    };\n    return WorkbookMerge;\n}());\nexport { WorkbookMerge };\n","import { setCell, setRow, getSheet } from '../base/index';\nimport { setCFRule, clearCFRule, getRangeAddress, applyCellFormat } from '../common/index';\nimport { getRangeIndexes } from '../common/index';\nimport { cFInitialCheck, clearCF } from '../common/index';\nimport { completeAction } from '../../spreadsheet/common/event';\nimport { isNullOrUndefined } from '@syncfusion/ej2-base';\n/**\n * The `WorkbookConditionalFormat` module is used to handle conditional formatting action in Spreadsheet.\n */\nvar WorkbookConditionalFormat = /** @class */ (function () {\n    /**\n     * Constructor for WorkbookConditionalFormat module.\n     */\n    function WorkbookConditionalFormat(parent) {\n        this.parent = parent;\n        this.addEventListener();\n    }\n    /**\n     * To destroy the conditional format module.\n     */\n    WorkbookConditionalFormat.prototype.destroy = function () {\n        this.removeEventListener();\n        this.parent = null;\n    };\n    WorkbookConditionalFormat.prototype.addEventListener = function () {\n        this.parent.on(setCFRule, this.setCFrulHandler, this);\n        this.parent.on(clearCFRule, this.clearRules, this);\n    };\n    WorkbookConditionalFormat.prototype.removeEventListener = function () {\n        if (!this.parent.isDestroyed) {\n            this.parent.off(setCFRule, this.setCFrulHandler);\n            this.parent.off(clearCFRule, this.clearRules);\n        }\n    };\n    WorkbookConditionalFormat.prototype.setCFrulHandler = function (args) {\n        var conditionalFormat = args.conditionalFormat;\n        var range = conditionalFormat.range;\n        var sheetIndex = this.parent.getAddressInfo(range).sheetIndex;\n        var sheet = getSheet(this.parent, sheetIndex);\n        range = range || sheet.selectedRange;\n        conditionalFormat.range = range;\n        var indexes = getRangeIndexes(range);\n        var cfrCount;\n        if (!sheet.conditionalFormats) {\n            this.parent.setSheetPropertyOnMute(sheet, 'conditionalFormats', []);\n        }\n        cfrCount = sheet.conditionalFormats.length;\n        sheet.conditionalFormats[cfrCount] = conditionalFormat;\n        for (var rIdx = indexes[0]; rIdx <= indexes[2]; rIdx++) {\n            if (!sheet.rows[rIdx]) {\n                setRow(sheet, rIdx, {});\n            }\n            for (var cIdx = indexes[1]; cIdx <= indexes[3]; cIdx++) {\n                if (!sheet.rows[rIdx].cells || !sheet.rows[rIdx].cells[cIdx]) {\n                    setCell(rIdx, cIdx, sheet, {});\n                }\n                if (sheetIndex === this.parent.activeSheetIndex) {\n                    var cell = sheet.rows[rIdx].cells[cIdx];\n                    this.parent.notify(cFInitialCheck, { rowIdx: rIdx, colIdx: cIdx, cell: cell, conditionalFormat: conditionalFormat });\n                }\n            }\n        }\n    };\n    // tslint:disable-next-line:max-func-body-length\n    WorkbookConditionalFormat.prototype.clearRules = function (args) {\n        var isPublic = isNullOrUndefined(args.isPublic) ? true : false;\n        var cFormats = [];\n        var oldRange = [];\n        var isFirst = true;\n        var top;\n        var bottom;\n        var left;\n        var right;\n        var frontColIdx;\n        var backColIdx;\n        var topRowIdx;\n        var bottomRowIdx;\n        var range = args.range;\n        var sheetIndex = this.parent.getAddressInfo(range).sheetIndex;\n        var sheet = getSheet(this.parent, sheetIndex);\n        var cFRules = sheet.conditionalFormats;\n        var rangeIndexes = getRangeIndexes(range);\n        if (sheetIndex === this.parent.activeSheetIndex) {\n            for (var rIdx = rangeIndexes[0]; rIdx <= rangeIndexes[2]; rIdx++) {\n                for (var cIdx = rangeIndexes[1]; cIdx <= rangeIndexes[3]; cIdx++) {\n                    this.parent.notify(clearCF, { rIdx: rIdx, cIdx: cIdx });\n                }\n            }\n        }\n        if (!cFRules) {\n            return;\n        }\n        for (var cFRulesIdx = cFRules.length - 1; cFRulesIdx >= 0; cFRulesIdx--) {\n            var isPresent = false;\n            var result = '';\n            var cFRule = cFRules[cFRulesIdx];\n            var cFRanges = cFRule.range.split(',');\n            if (sheetIndex === this.parent.activeSheetIndex) {\n                for (var cFRangeIdx = 0; cFRangeIdx < cFRanges.length; cFRangeIdx++) {\n                    var isFull = false;\n                    var cFRange = cFRanges[cFRangeIdx];\n                    var cFRangeIndexes = getRangeIndexes(cFRange);\n                    topRowIdx = cFRangeIndexes[0];\n                    bottomRowIdx = cFRangeIndexes[0];\n                    frontColIdx = cFRangeIndexes[1];\n                    backColIdx = cFRangeIndexes[1];\n                    if (cFRangeIndexes[0] >= rangeIndexes[0] && cFRangeIndexes[2] <= rangeIndexes[2] &&\n                        cFRangeIndexes[1] >= rangeIndexes[1] && cFRangeIndexes[3] <= rangeIndexes[3]) {\n                        isFull = true;\n                    }\n                    for (var cFRRowIdx = cFRangeIndexes[0]; cFRRowIdx <= cFRangeIndexes[2]; cFRRowIdx++) {\n                        var isTrue = 0;\n                        for (var cFRColIdx = cFRangeIndexes[1]; cFRColIdx <= cFRangeIndexes[3]; cFRColIdx++) {\n                            for (var rRowIdx = rangeIndexes[0]; rRowIdx <= rangeIndexes[2]; rRowIdx++) {\n                                for (var rColIdx = rangeIndexes[1]; rColIdx <= rangeIndexes[3]; rColIdx++) {\n                                    if (rRowIdx === cFRRowIdx && rColIdx === cFRColIdx) {\n                                        var style = this.parent.getCellStyleValue(['backgroundColor', 'color'], [rRowIdx, rColIdx]);\n                                        this.parent.notify(applyCellFormat, {\n                                            style: style, rowIdx: rRowIdx, colIdx: rColIdx,\n                                            lastCell: true, isHeightCheckNeeded: true, manualUpdate: true\n                                        });\n                                        isTrue = isTrue + 1;\n                                        isPresent = true;\n                                        if (rRowIdx === cFRangeIndexes[0]) {\n                                            if (rColIdx === cFRangeIndexes[3]) {\n                                                if (frontColIdx === cFRangeIndexes[1]) {\n                                                    if (backColIdx === rColIdx) {\n                                                        backColIdx = rColIdx;\n                                                    }\n                                                    else {\n                                                        frontColIdx = rColIdx - 1;\n                                                    }\n                                                }\n                                                else if (frontColIdx !== cFRangeIndexes[1] && backColIdx + 1 === rColIdx) {\n                                                    backColIdx = cFRangeIndexes[1];\n                                                    frontColIdx = frontColIdx - 1;\n                                                }\n                                                else if (frontColIdx !== cFRangeIndexes[1] && backColIdx === cFRangeIndexes[1]) {\n                                                    frontColIdx = rangeIndexes[1] - 1;\n                                                }\n                                            }\n                                            else if (rColIdx === cFRangeIndexes[1]) {\n                                                if (backColIdx === cFRangeIndexes[1]) {\n                                                    backColIdx = rColIdx + 1;\n                                                }\n                                            }\n                                            else {\n                                                if (frontColIdx === cFRangeIndexes[1] && backColIdx === cFRangeIndexes[1]) {\n                                                    frontColIdx = rColIdx;\n                                                    backColIdx = rColIdx;\n                                                }\n                                                else if (frontColIdx === cFRangeIndexes[1] && backColIdx !== cFRangeIndexes[1]) {\n                                                    backColIdx = rColIdx + 1;\n                                                }\n                                                else {\n                                                    backColIdx = rColIdx;\n                                                }\n                                            }\n                                        }\n                                        else {\n                                            if (rColIdx === cFRangeIndexes[1]) {\n                                                if (backColIdx === cFRangeIndexes[1] && cFRangeIndexes[1] !== cFRangeIndexes[3]) {\n                                                    backColIdx = rColIdx + 1;\n                                                }\n                                            }\n                                            else if (rColIdx === cFRangeIndexes[3]) {\n                                                if (frontColIdx === cFRangeIndexes[1]) {\n                                                    if (backColIdx === rColIdx) {\n                                                        backColIdx = rColIdx;\n                                                    }\n                                                    else {\n                                                        frontColIdx = rColIdx - 1;\n                                                    }\n                                                }\n                                                else if (frontColIdx !== cFRangeIndexes[1] && backColIdx === cFRangeIndexes[1]) {\n                                                    frontColIdx = rangeIndexes[1] - 1;\n                                                }\n                                                else if (frontColIdx !== cFRangeIndexes[1] && backColIdx + 1 === rColIdx) {\n                                                    backColIdx = cFRangeIndexes[1];\n                                                    frontColIdx = rangeIndexes[1] - 1;\n                                                }\n                                                else {\n                                                    bottomRowIdx = rRowIdx;\n                                                }\n                                            }\n                                            else {\n                                                if (frontColIdx === cFRangeIndexes[1] && backColIdx === cFRangeIndexes[1]) {\n                                                    frontColIdx = rColIdx;\n                                                    backColIdx = rColIdx;\n                                                }\n                                                else if (backColIdx !== cFRangeIndexes[1] && frontColIdx !== cFRangeIndexes[1]) {\n                                                    backColIdx = rColIdx;\n                                                }\n                                                else if (frontColIdx !== cFRangeIndexes[1] && backColIdx === cFRangeIndexes[1]) {\n                                                    frontColIdx = rColIdx;\n                                                }\n                                                else {\n                                                    backColIdx = rColIdx + 1;\n                                                }\n                                            }\n                                        }\n                                    }\n                                }\n                            }\n                        }\n                        if (isTrue > 0 && !isFull) {\n                            if (isFirst) {\n                                top = topRowIdx;\n                                bottom = bottomRowIdx;\n                                left = frontColIdx;\n                                right = backColIdx;\n                            }\n                            if (frontColIdx === cFRangeIndexes[1] && backColIdx !== cFRangeIndexes[1]) {\n                                if (backColIdx === cFRangeIndexes[3]) {\n                                    if (topRowIdx !== cFRRowIdx) {\n                                        result = result + ' ' + getRangeAddress([topRowIdx, left, bottom, cFRangeIndexes[3]]);\n                                    }\n                                    if (frontColIdx === cFRangeIndexes[1] && backColIdx === cFRangeIndexes[3]) {\n                                        if (cFRRowIdx === cFRangeIndexes[2]) {\n                                            if (cFRangeIndexes[1] === rangeIndexes[3]) {\n                                                result = result + ' ' + getRangeAddress([cFRRowIdx, backColIdx, cFRRowIdx, cFRangeIndexes[3]]);\n                                            }\n                                        }\n                                        else {\n                                            if (rangeIndexes[2] === cFRangeIndexes[0] && backColIdx !== cFRangeIndexes[3]) {\n                                                result = result + ' ' + getRangeAddress([cFRRowIdx, backColIdx, cFRRowIdx, cFRangeIndexes[3]]);\n                                            }\n                                            topRowIdx = cFRRowIdx + 1;\n                                            bottomRowIdx = cFRRowIdx + 1;\n                                            backColIdx = cFRangeIndexes[1];\n                                        }\n                                    }\n                                }\n                                else if (right !== backColIdx) {\n                                    result = result + ' ' + getRangeAddress([topRowIdx, right, cFRRowIdx - 1, cFRangeIndexes[3]]);\n                                    if (backColIdx === cFRangeIndexes[3] && frontColIdx === cFRangeIndexes[1]) {\n                                        topRowIdx = cFRRowIdx + 1;\n                                        bottomRowIdx = cFRRowIdx + 1;\n                                        backColIdx = cFRangeIndexes[1];\n                                    }\n                                    else {\n                                        topRowIdx = cFRRowIdx;\n                                        bottomRowIdx = cFRRowIdx;\n                                    }\n                                    if (backColIdx === cFRangeIndexes[3] && frontColIdx !== cFRangeIndexes[1]) {\n                                        frontColIdx = cFRangeIndexes[1];\n                                    }\n                                }\n                                else if (left !== frontColIdx) {\n                                    result = result + ' ' + getRangeAddress([topRowIdx, cFRangeIndexes[1], cFRRowIdx - 1, left]);\n                                    topRowIdx = cFRRowIdx + 1;\n                                    bottomRowIdx = cFRRowIdx + 1;\n                                    frontColIdx = cFRangeIndexes[1];\n                                    backColIdx = cFRangeIndexes[1];\n                                }\n                                else if (cFRRowIdx === cFRangeIndexes[2]) {\n                                    result = result + ' ' + getRangeAddress([topRowIdx, backColIdx, cFRRowIdx, cFRangeIndexes[3]]);\n                                }\n                                else {\n                                    if (bottomRowIdx < cFRRowIdx || (frontColIdx === cFRangeIndexes[1] && backColIdx === cFRangeIndexes[3])) {\n                                        bottomRowIdx = cFRRowIdx;\n                                    }\n                                }\n                            }\n                            else if (backColIdx === cFRangeIndexes[1] && frontColIdx !== cFRangeIndexes[1]) {\n                                if (right !== backColIdx) {\n                                    result = result + ' ' + getRangeAddress([topRowIdx, right, cFRRowIdx - 1, cFRangeIndexes[3]]);\n                                    topRowIdx = cFRRowIdx;\n                                    bottomRowIdx = cFRRowIdx;\n                                }\n                                if (left !== frontColIdx) {\n                                    result = result + ' ' + getRangeAddress([topRowIdx, left, cFRRowIdx - 1, cFRangeIndexes[3]]);\n                                    topRowIdx = cFRRowIdx;\n                                    bottomRowIdx = cFRRowIdx;\n                                }\n                                if (cFRRowIdx === cFRangeIndexes[2]) {\n                                    result = result + ' ' + getRangeAddress([topRowIdx, backColIdx, cFRRowIdx, frontColIdx]);\n                                }\n                                else {\n                                    bottomRowIdx = cFRRowIdx;\n                                }\n                            }\n                            else if (backColIdx !== cFRangeIndexes[1] && frontColIdx !== cFRangeIndexes[1]) {\n                                if (cFRRowIdx === cFRangeIndexes[2] && cFRangeIndexes[2] === rangeIndexes[0]) {\n                                    if (cFRangeIndexes[0] === cFRangeIndexes[2]) {\n                                        result = result + ' ' + getRangeAddress([topRowIdx, cFRangeIndexes[1], bottomRowIdx, frontColIdx - 1]);\n                                        result = result + ' ' +\n                                            getRangeAddress([topRowIdx, backColIdx + 1, bottomRowIdx, cFRangeIndexes[3]]);\n                                    }\n                                    else {\n                                        result =\n                                            result + ' ' + getRangeAddress([topRowIdx, cFRangeIndexes[1], bottomRowIdx, cFRangeIndexes[3]]);\n                                        result = result + ' ' +\n                                            getRangeAddress([cFRangeIndexes[2], cFRangeIndexes[1], cFRangeIndexes[2], frontColIdx - 1]);\n                                        result = result + ' ' +\n                                            getRangeAddress([cFRangeIndexes[2], backColIdx + 1, cFRangeIndexes[2], cFRangeIndexes[3]]);\n                                    }\n                                }\n                                else if (cFRRowIdx === cFRangeIndexes[2]) {\n                                    result = result + ' ' + getRangeAddress([topRowIdx, cFRangeIndexes[1], cFRRowIdx, frontColIdx - 1]);\n                                    result = result + ' ' + getRangeAddress([topRowIdx, backColIdx + 1, cFRRowIdx, cFRangeIndexes[3]]);\n                                }\n                                else {\n                                    if (left === cFRangeIndexes[1] && right === cFRangeIndexes[1]) {\n                                        result = result + ' ' + getRangeAddress([topRowIdx, left, bottomRowIdx, cFRangeIndexes[3]]);\n                                        topRowIdx = cFRRowIdx;\n                                    }\n                                    bottomRowIdx = cFRRowIdx;\n                                }\n                            }\n                            else if (frontColIdx === cFRangeIndexes[1] && backColIdx === cFRangeIndexes[1]) {\n                                if (rangeIndexes[2] !== cFRangeIndexes[0]) {\n                                    if (cFRangeIndexes[2] >= rangeIndexes[2] && cFRRowIdx > rangeIndexes[2]) {\n                                        result = result + ' ' + getRangeAddress([topRowIdx, frontColIdx, bottomRowIdx, cFRangeIndexes[3]]);\n                                    }\n                                    if (cFRangeIndexes[1] === cFRangeIndexes[3] &&\n                                        cFRRowIdx <= cFRangeIndexes[2] && top !== cFRangeIndexes[2] && cFRRowIdx !== top) {\n                                        result = result + ' ' + getRangeAddress([topRowIdx, frontColIdx, bottomRowIdx, cFRangeIndexes[3]]);\n                                    }\n                                    if (cFRangeIndexes[1] === cFRangeIndexes[3]) {\n                                        topRowIdx = cFRRowIdx + 1;\n                                        bottomRowIdx = cFRRowIdx + 1;\n                                    }\n                                }\n                                else {\n                                    if (cFRRowIdx === cFRangeIndexes[2] || cFRRowIdx === cFRangeIndexes[0] &&\n                                        cFRangeIndexes[1] !== cFRangeIndexes[3]) {\n                                        result = result + ' ' + getRangeAddress([topRowIdx, frontColIdx, bottomRowIdx, backColIdx]);\n                                    }\n                                    topRowIdx = cFRRowIdx + 1;\n                                    bottomRowIdx = cFRRowIdx + 1;\n                                }\n                                if (cFRRowIdx === cFRangeIndexes[2] && cFRangeIndexes[0] !== cFRangeIndexes[2] &&\n                                    cFRangeIndexes[1] !== cFRangeIndexes[3]) {\n                                    result = result + ' ' + getRangeAddress([cFRRowIdx, frontColIdx, cFRRowIdx, backColIdx]);\n                                }\n                            }\n                            if (!isFirst) {\n                                top = topRowIdx;\n                                bottom = bottomRowIdx <= cFRangeIndexes[2] ? bottomRowIdx : cFRangeIndexes[2];\n                                left = frontColIdx;\n                                right = backColIdx <= cFRangeIndexes[3] ? backColIdx : cFRangeIndexes[3];\n                            }\n                            isFirst = false;\n                        }\n                        else if (!isFull) {\n                            if (isFirst) {\n                                top = topRowIdx;\n                                bottom = bottomRowIdx;\n                                left = frontColIdx;\n                                right = backColIdx;\n                            }\n                            if (frontColIdx === cFRangeIndexes[1] && backColIdx === cFRangeIndexes[1]) {\n                                if (cFRRowIdx === cFRangeIndexes[2]) {\n                                    result = result + ' ' + getRangeAddress([topRowIdx, frontColIdx, cFRRowIdx, cFRangeIndexes[3]]);\n                                }\n                                bottomRowIdx = cFRRowIdx;\n                            }\n                            if (backColIdx !== cFRangeIndexes[1] && frontColIdx !== cFRangeIndexes[1]) {\n                                result = result + ' ' + getRangeAddress([topRowIdx, cFRangeIndexes[1], (cFRRowIdx - 1), frontColIdx - 1]);\n                                result = result + ' ' + getRangeAddress([topRowIdx, backColIdx + 1, (cFRRowIdx - 1), cFRangeIndexes[3]]);\n                                topRowIdx = cFRRowIdx;\n                                bottomRowIdx = cFRRowIdx;\n                                frontColIdx = cFRangeIndexes[1];\n                                backColIdx = cFRangeIndexes[1];\n                            }\n                            if (backColIdx !== cFRangeIndexes[1] && frontColIdx === cFRangeIndexes[1]) {\n                                result = result + ' ' + getRangeAddress([topRowIdx, backColIdx, (cFRRowIdx - 1), cFRangeIndexes[3]]);\n                                topRowIdx = cFRRowIdx;\n                                bottomRowIdx = cFRRowIdx;\n                                frontColIdx = cFRangeIndexes[1];\n                                backColIdx = cFRangeIndexes[1];\n                            }\n                            if (frontColIdx !== cFRangeIndexes[1] && backColIdx === cFRangeIndexes[1]) {\n                                result = result + ' ' + getRangeAddress([topRowIdx, backColIdx, (cFRRowIdx - 1), frontColIdx]);\n                                topRowIdx = cFRRowIdx;\n                                bottomRowIdx = cFRRowIdx;\n                                frontColIdx = cFRangeIndexes[1];\n                                backColIdx = cFRangeIndexes[1];\n                            }\n                            if (!isFirst) {\n                                top = topRowIdx;\n                                bottom = bottomRowIdx <= cFRangeIndexes[2] ? bottomRowIdx : cFRangeIndexes[2];\n                                left = frontColIdx;\n                                right = backColIdx <= cFRangeIndexes[3] ? backColIdx : cFRangeIndexes[3];\n                            }\n                            isFirst = false;\n                        }\n                    }\n                }\n            }\n            if (result === '') {\n                oldRange.push(sheet.conditionalFormats[cFRulesIdx].range);\n                sheet.conditionalFormats.splice(cFRulesIdx, 1);\n            }\n            else {\n                oldRange.push(sheet.conditionalFormats[cFRulesIdx].range);\n                sheet.conditionalFormats[cFRulesIdx].range = result.trim().replace(' ', ',');\n            }\n            if (isPresent && !isPublic) {\n                cFRule.range = result.trim().replace(' ', ',');\n                cFormats.push(cFRule);\n            }\n        }\n        if (!isPublic) {\n            var eventArgs = { cFormats: cFormats, oldRange: oldRange, selectedRange: range };\n            this.parent.notify(completeAction, { eventArgs: eventArgs, action: 'clearCF' });\n        }\n    };\n    /**\n     * Gets the module name.\n     * @returns string\n     */\n    WorkbookConditionalFormat.prototype.getModuleName = function () {\n        return 'workbookConditionalFormatting';\n    };\n    return WorkbookConditionalFormat;\n}());\nexport { WorkbookConditionalFormat };\n","import { Workbook, DataBind } from '../index';\nimport { WorkbookSave, WorkbookFormula, WorkbookOpen, WorkbookSort, WorkbookFilter, WorkbookImage } from '../integrations/index';\nimport { WorkbookNumberFormat } from '../integrations/number-format';\nimport { WorkbookEdit, WorkbookCellFormat, WorkbookHyperlink, WorkbookInsert, WorkbookDelete } from '../actions/index';\nimport { WorkbookFindAndReplace, WorkbookProtectSheet, WorkbookDataValidation, WorkbookMerge } from '../actions/index';\nimport { WorkbookConditionalFormat } from '../actions/conditional-formatting';\nimport { WorkbookChart } from '../integrations/index';\n/**\n * Workbook basic module.\n * @private\n */\nvar WorkbookBasicModule = /** @class */ (function () {\n    /**\n     * Constructor for Workbook basic module.\n     * @private\n     */\n    function WorkbookBasicModule() {\n        Workbook.Inject(DataBind, WorkbookSave, WorkbookOpen, WorkbookNumberFormat, WorkbookCellFormat, WorkbookEdit, WorkbookFormula, WorkbookSort, WorkbookHyperlink, WorkbookFilter, WorkbookInsert, WorkbookDelete, WorkbookFindAndReplace, WorkbookProtectSheet, WorkbookDataValidation, WorkbookMerge, WorkbookConditionalFormat, WorkbookImage, WorkbookChart);\n    }\n    /**\n     * For internal use only - Get the module name.\n     * @private\n     */\n    WorkbookBasicModule.prototype.getModuleName = function () {\n        return 'workbookBasic';\n    };\n    /**\n     * Destroys the Workbook basic module.\n     * @return {void}\n     */\n    WorkbookBasicModule.prototype.destroy = function () {\n        /* code snippet */\n    };\n    return WorkbookBasicModule;\n}());\nexport { WorkbookBasicModule };\n","import { Workbook, DataBind } from '../../workbook/index';\nimport { WorkbookSave, WorkbookNumberFormat, WorkbookFormula, WorkbookOpen, WorkbookChart } from '../integrations/index';\nimport { WorkbookSort, WorkbookFilter, WorkbookImage } from '../integrations/index';\nimport { WorkbookEdit, WorkbookCellFormat, WorkbookHyperlink, WorkbookInsert, WorkbookDelete } from '../actions/index';\nimport { WorkbookFindAndReplace, WorkbookProtectSheet, WorkbookDataValidation, WorkbookMerge } from '../actions/index';\nimport { WorkbookConditionalFormat } from '../actions/conditional-formatting';\n/**\n * Workbook all module.\n * @private\n */\nvar WorkbookAllModule = /** @class */ (function () {\n    /**\n     * Constructor for Workbook all module.\n     * @private\n     */\n    function WorkbookAllModule() {\n        Workbook.Inject(DataBind, WorkbookSave, WorkbookNumberFormat, WorkbookCellFormat, WorkbookEdit, WorkbookFormula, WorkbookOpen, WorkbookSort, WorkbookHyperlink, WorkbookFilter, WorkbookInsert, WorkbookDelete, WorkbookFindAndReplace, WorkbookProtectSheet, WorkbookDataValidation, WorkbookMerge, WorkbookConditionalFormat, WorkbookImage, WorkbookChart);\n    }\n    /**\n     * For internal use only - Get the module name.\n     * @private\n     */\n    WorkbookAllModule.prototype.getModuleName = function () {\n        return 'workbook-all';\n    };\n    /**\n     * Destroys the Workbook all module.\n     * @return {void}\n     */\n    WorkbookAllModule.prototype.destroy = function () {\n        /* code snippet */\n    };\n    return WorkbookAllModule;\n}());\nexport { WorkbookAllModule };\n","var __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    }\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nimport { ChildProperty, Property, Complex } from '@syncfusion/ej2-base';\n/**\n * Represents the cell style.\n */\nvar CellStyle = /** @class */ (function (_super) {\n    __extends(CellStyle, _super);\n    function CellStyle() {\n        return _super !== null && _super.apply(this, arguments) || this;\n    }\n    __decorate([\n        Property('Calibri')\n    ], CellStyle.prototype, \"fontFamily\", void 0);\n    __decorate([\n        Property('bottom')\n    ], CellStyle.prototype, \"verticalAlign\", void 0);\n    __decorate([\n        Property('left')\n    ], CellStyle.prototype, \"textAlign\", void 0);\n    __decorate([\n        Property('0pt')\n    ], CellStyle.prototype, \"textIndent\", void 0);\n    __decorate([\n        Property('#000000')\n    ], CellStyle.prototype, \"color\", void 0);\n    __decorate([\n        Property('#ffffff')\n    ], CellStyle.prototype, \"backgroundColor\", void 0);\n    __decorate([\n        Property('normal')\n    ], CellStyle.prototype, \"fontWeight\", void 0);\n    __decorate([\n        Property('normal')\n    ], CellStyle.prototype, \"fontStyle\", void 0);\n    __decorate([\n        Property('11pt')\n    ], CellStyle.prototype, \"fontSize\", void 0);\n    __decorate([\n        Property('none')\n    ], CellStyle.prototype, \"textDecoration\", void 0);\n    __decorate([\n        Property('')\n    ], CellStyle.prototype, \"border\", void 0);\n    __decorate([\n        Property('')\n    ], CellStyle.prototype, \"borderTop\", void 0);\n    __decorate([\n        Property('')\n    ], CellStyle.prototype, \"borderBottom\", void 0);\n    __decorate([\n        Property('')\n    ], CellStyle.prototype, \"borderLeft\", void 0);\n    __decorate([\n        Property('')\n    ], CellStyle.prototype, \"borderRight\", void 0);\n    return CellStyle;\n}(ChildProperty));\nexport { CellStyle };\n/**\n * Represents the Filter Collection.\n */\nvar FilterCollection = /** @class */ (function (_super) {\n    __extends(FilterCollection, _super);\n    function FilterCollection() {\n        return _super !== null && _super.apply(this, arguments) || this;\n    }\n    __decorate([\n        Property()\n    ], FilterCollection.prototype, \"sheetIdx\", void 0);\n    __decorate([\n        Property()\n    ], FilterCollection.prototype, \"filterRange\", void 0);\n    __decorate([\n        Property(false)\n    ], FilterCollection.prototype, \"hasFilter\", void 0);\n    __decorate([\n        Property()\n    ], FilterCollection.prototype, \"column\", void 0);\n    __decorate([\n        Property()\n    ], FilterCollection.prototype, \"criteria\", void 0);\n    __decorate([\n        Property()\n    ], FilterCollection.prototype, \"value\", void 0);\n    __decorate([\n        Property()\n    ], FilterCollection.prototype, \"dataType\", void 0);\n    return FilterCollection;\n}(ChildProperty));\nexport { FilterCollection };\n/**\n * Represents the DefineName.\n */\nvar DefineName = /** @class */ (function (_super) {\n    __extends(DefineName, _super);\n    function DefineName() {\n        return _super !== null && _super.apply(this, arguments) || this;\n    }\n    __decorate([\n        Property('')\n    ], DefineName.prototype, \"name\", void 0);\n    __decorate([\n        Property('')\n    ], DefineName.prototype, \"scope\", void 0);\n    __decorate([\n        Property('')\n    ], DefineName.prototype, \"comment\", void 0);\n    __decorate([\n        Property('')\n    ], DefineName.prototype, \"refersTo\", void 0);\n    return DefineName;\n}(ChildProperty));\nexport { DefineName };\n/**\n * Configures the Protect behavior for the spreadsheet.\n */\nvar ProtectSettings = /** @class */ (function (_super) {\n    __extends(ProtectSettings, _super);\n    function ProtectSettings() {\n        return _super !== null && _super.apply(this, arguments) || this;\n    }\n    __decorate([\n        Property(false)\n    ], ProtectSettings.prototype, \"selectCells\", void 0);\n    __decorate([\n        Property(false)\n    ], ProtectSettings.prototype, \"formatCells\", void 0);\n    __decorate([\n        Property(false)\n    ], ProtectSettings.prototype, \"formatRows\", void 0);\n    __decorate([\n        Property(false)\n    ], ProtectSettings.prototype, \"formatColumns\", void 0);\n    __decorate([\n        Property(false)\n    ], ProtectSettings.prototype, \"insertLink\", void 0);\n    return ProtectSettings;\n}(ChildProperty));\nexport { ProtectSettings };\n/**\n * Represents the Hyperlink.\n */\nvar Hyperlink = /** @class */ (function (_super) {\n    __extends(Hyperlink, _super);\n    function Hyperlink() {\n        return _super !== null && _super.apply(this, arguments) || this;\n    }\n    __decorate([\n        Property('')\n    ], Hyperlink.prototype, \"address\", void 0);\n    return Hyperlink;\n}(ChildProperty));\nexport { Hyperlink };\n/**\n * Represents the DataValidation.\n */\nvar Validation = /** @class */ (function (_super) {\n    __extends(Validation, _super);\n    function Validation() {\n        return _super !== null && _super.apply(this, arguments) || this;\n    }\n    __decorate([\n        Property('WholeNumber')\n    ], Validation.prototype, \"type\", void 0);\n    __decorate([\n        Property('Between')\n    ], Validation.prototype, \"operator\", void 0);\n    __decorate([\n        Property('0')\n    ], Validation.prototype, \"value1\", void 0);\n    __decorate([\n        Property('0')\n    ], Validation.prototype, \"value2\", void 0);\n    __decorate([\n        Property(true)\n    ], Validation.prototype, \"ignoreBlank\", void 0);\n    __decorate([\n        Property(true)\n    ], Validation.prototype, \"inCellDropDown\", void 0);\n    __decorate([\n        Property(false)\n    ], Validation.prototype, \"isHighlighted\", void 0);\n    return Validation;\n}(ChildProperty));\nexport { Validation };\n/**\n * Represents the Format.\n */\nvar Format = /** @class */ (function (_super) {\n    __extends(Format, _super);\n    function Format() {\n        return _super !== null && _super.apply(this, arguments) || this;\n    }\n    __decorate([\n        Property('General')\n    ], Format.prototype, \"format\", void 0);\n    __decorate([\n        Complex({}, CellStyle)\n    ], Format.prototype, \"style\", void 0);\n    __decorate([\n        Property(true)\n    ], Format.prototype, \"isLocked\", void 0);\n    return Format;\n}(ChildProperty));\nexport { Format };\n/**\n * Represents the Conditional Formatting.\n */\nvar ConditionalFormat = /** @class */ (function (_super) {\n    __extends(ConditionalFormat, _super);\n    function ConditionalFormat() {\n        return _super !== null && _super.apply(this, arguments) || this;\n    }\n    __decorate([\n        Property('GreaterThan')\n    ], ConditionalFormat.prototype, \"type\", void 0);\n    __decorate([\n        Complex({}, Format)\n    ], ConditionalFormat.prototype, \"format\", void 0);\n    __decorate([\n        Property('RedFT')\n    ], ConditionalFormat.prototype, \"cFColor\", void 0);\n    __decorate([\n        Property('')\n    ], ConditionalFormat.prototype, \"value\", void 0);\n    __decorate([\n        Property('')\n    ], ConditionalFormat.prototype, \"range\", void 0);\n    return ConditionalFormat;\n}(ChildProperty));\nexport { ConditionalFormat };\n/**\n * Represents the Chart.\n */\nvar Chart = /** @class */ (function (_super) {\n    __extends(Chart, _super);\n    function Chart() {\n        return _super !== null && _super.apply(this, arguments) || this;\n    }\n    __decorate([\n        Property('Line')\n    ], Chart.prototype, \"type\", void 0);\n    __decorate([\n        Property('Material')\n    ], Chart.prototype, \"theme\", void 0);\n    __decorate([\n        Property(false)\n    ], Chart.prototype, \"isSeriesInRows\", void 0);\n    __decorate([\n        Property('')\n    ], Chart.prototype, \"range\", void 0);\n    __decorate([\n        Property('')\n    ], Chart.prototype, \"id\", void 0);\n    __decorate([\n        Property(290)\n    ], Chart.prototype, \"height\", void 0);\n    __decorate([\n        Property(480)\n    ], Chart.prototype, \"width\", void 0);\n    __decorate([\n        Property(0)\n    ], Chart.prototype, \"top\", void 0);\n    __decorate([\n        Property(0)\n    ], Chart.prototype, \"left\", void 0);\n    return Chart;\n}(ChildProperty));\nexport { Chart };\n/**\n * Represents the Image.\n */\nvar Image = /** @class */ (function (_super) {\n    __extends(Image, _super);\n    function Image() {\n        return _super !== null && _super.apply(this, arguments) || this;\n    }\n    __decorate([\n        Property('')\n    ], Image.prototype, \"src\", void 0);\n    __decorate([\n        Property('')\n    ], Image.prototype, \"id\", void 0);\n    __decorate([\n        Property(300)\n    ], Image.prototype, \"height\", void 0);\n    __decorate([\n        Property(400)\n    ], Image.prototype, \"width\", void 0);\n    __decorate([\n        Property(0)\n    ], Image.prototype, \"top\", void 0);\n    __decorate([\n        Property(0)\n    ], Image.prototype, \"left\", void 0);\n    return Image;\n}(ChildProperty));\nexport { Image };\n","/** @hidden */\nexport var workbookLocale = 'spreadsheetLocale';\n/**\n * Workbook locale text\n * @hidden\n */\nexport var localeData = {\n    SortOutOfRangeError: 'Select a cell or range inside the used range and try again.'\n};\n","import { isNullOrUndefined } from '@syncfusion/ej2-base';\n/**\n * ServiceLocator\n * @hidden\n */\nvar ServiceLocator = /** @class */ (function () {\n    function ServiceLocator() {\n        this.services = {};\n    }\n    ServiceLocator.prototype.getService = function (name) {\n        if (isNullOrUndefined(this.services[name])) {\n            throw \"The service \" + name + \" is not registered\";\n        }\n        return this.services[name];\n    };\n    ServiceLocator.prototype.register = function (name, type) {\n        if (isNullOrUndefined(this.services[name])) {\n            this.services[name] = type;\n        }\n    };\n    return ServiceLocator;\n}());\nexport { ServiceLocator };\n","var __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    }\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nvar __assign = (this && this.__assign) || function () {\n    __assign = Object.assign || function(t) {\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\n            s = arguments[i];\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\n                t[p] = s[p];\n        }\n        return t;\n    };\n    return __assign.apply(this, arguments);\n};\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nimport { Component, Property, NotifyPropertyChanges, Collection, Complex } from '@syncfusion/ej2-base';\nimport { initSheet, getSheet, getSheetIndexFromId, getSheetIndexByName, getSheetIndex, Sheet } from './sheet';\nimport { Event, merge, L10n, isNullOrUndefined } from '@syncfusion/ej2-base';\nimport { getWorkbookRequiredModules } from '../common/module';\nimport { getData, clearRange } from './index';\nimport { DefineName, CellStyle, updateUsedRange, getIndexesFromAddress, localeData, workbookLocale } from '../common/index';\nimport * as events from '../common/event';\nimport { insertModel, getAddressInfo } from '../common/index';\nimport { setCellFormat, sheetCreated, deleteModel, setLockCells } from '../common/index';\nimport { setMerge } from '../common/index';\nimport { getCell, skipDefaultValue, setCell, wrap as wrapText } from './cell';\nimport { DataBind, setRow, setColumn } from '../index';\nimport { WorkbookSave, WorkbookFormula, WorkbookOpen, WorkbookSort, WorkbookFilter, WorkbookImage } from '../integrations/index';\nimport { WorkbookChart } from '../integrations/index';\nimport { WorkbookNumberFormat } from '../integrations/number-format';\nimport { WorkbookEdit, WorkbookCellFormat, WorkbookHyperlink, WorkbookInsert, WorkbookProtectSheet } from '../actions/index';\nimport { WorkbookDataValidation, WorkbookMerge } from '../actions/index';\nimport { ServiceLocator } from '../services/index';\nimport { setLinkModel, setImage, setChart } from '../common/event';\nimport { beginAction, completeAction, deleteChart } from '../../spreadsheet/common/event';\nimport { WorkbookFindAndReplace } from '../actions/find-and-replace';\nimport { WorkbookConditionalFormat } from '../actions/conditional-formatting';\n/**\n * Represents the Workbook.\n */\nvar Workbook = /** @class */ (function (_super) {\n    __extends(Workbook, _super);\n    /**\n     * Constructor for initializing the library.\n     * @param options - Configures Workbook model.\n     */\n    function Workbook(options) {\n        var _this = _super.call(this, options) || this;\n        /** @hidden */\n        _this.isEdit = false;\n        /**\n         * To generate sheet name based on sheet count.\n         * @hidden\n         */\n        _this.sheetNameCount = 1;\n        /**\n         * @hidden\n         */\n        _this.isOpen = false;\n        /**\n         * @hidden\n         */\n        _this.chartColl = [];\n        /**\n         * @hidden\n         */\n        _this.chartCount = 1;\n        Workbook_1.Inject(DataBind, WorkbookSave, WorkbookOpen, WorkbookNumberFormat, WorkbookCellFormat, WorkbookEdit, WorkbookFormula, WorkbookSort, WorkbookHyperlink, WorkbookFilter, WorkbookInsert, WorkbookFindAndReplace, WorkbookDataValidation, WorkbookProtectSheet, WorkbookMerge, WorkbookConditionalFormat, WorkbookImage, WorkbookChart);\n        _this.commonCellStyle = {};\n        if (options && options.cellStyle) {\n            _this.commonCellStyle = options.cellStyle;\n        }\n        if (_this.getModuleName() === 'workbook') {\n            _this.serviceLocator = new ServiceLocator;\n            _this.initWorkbookServices();\n            _this.dataBind();\n            _this.initEmptySheet();\n        }\n        return _this;\n    }\n    Workbook_1 = Workbook;\n    /**\n     * For internal use only.\n     * @returns void\n     * @hidden\n     */\n    Workbook.prototype.preRender = function () {\n        if (!Object.keys(this.commonCellStyle).length) {\n            this.commonCellStyle = skipDefaultValue(this.cellStyle, true);\n        }\n        if (this.getModuleName() === 'spreadsheet' && !this.refreshing) {\n            this.initEmptySheet();\n        }\n    };\n    Workbook.prototype.initWorkbookServices = function () {\n        this.serviceLocator.register(workbookLocale, new L10n(this.getModuleName(), localeData, this.locale));\n    };\n    /**\n     * For internal use only.\n     * @returns void\n     * @hidden\n     */\n    Workbook.prototype.render = function () {\n        /** code snippets */\n    };\n    /**\n     * To provide the array of modules needed for workbook.\n     * @return {ModuleDeclaration[]}\n     * @hidden\n     */\n    Workbook.prototype.requiredModules = function () {\n        return getWorkbookRequiredModules(this);\n    };\n    /**\n     * Get the properties to be maintained in the persisted state.\n     * @returns string\n     * @hidden\n     */\n    Workbook.prototype.getPersistData = function () {\n        return this.addOnPersist([]);\n    };\n    /**\n     * Applies the style (font family, font weight, background color, etc...) to the specified range of cells.\n     * {% codeBlock src='spreadsheet/cellFormat/index.md' %}{% endcodeBlock %}\n     * @param {CellStyleModel} style - Specifies the cell style.\n     * @param {string} range? - Specifies the address for the range of cells.\n     */\n    Workbook.prototype.cellFormat = function (style, range) {\n        var sheet = this.getActiveSheet();\n        range = range || sheet.selectedRange;\n        this.notify(setCellFormat, { style: style, range: range, refreshRibbon: range.indexOf(sheet.activeCell) > -1 ? true : false });\n    };\n    /**\n     * Applies cell lock to the specified range of cells.\n     * {% codeBlock src='spreadsheet/lockCells/index.md' %}{% endcodeBlock %}\n     * @param {string} range? - Specifies the address for the range of cells.\n     * @param {boolean} isLocked -Specifies the cell is locked or not.\n     */\n    Workbook.prototype.lockCells = function (range, isLocked) {\n        var sheet = this.getActiveSheet();\n        range = range || sheet.selectedRange;\n        this.notify(setLockCells, { range: range, isLocked: isLocked });\n    };\n    /** @hidden */\n    Workbook.prototype.getCellStyleValue = function (cssProps, indexes) {\n        var _this = this;\n        var cell = getCell(indexes[0], indexes[1], this.getActiveSheet());\n        var style = {};\n        cssProps.forEach(function (cssProp) {\n            style[cssProp] = _this.cellStyle[cssProp];\n            if (cell && cell.style && cell.style[cssProp]) {\n                style[cssProp] = cell.style[cssProp];\n            }\n        });\n        return style;\n    };\n    /**\n     * Applies the number format (number, currency, percentage, short date, etc...) to the specified range of cells.\n     * {% codeBlock src='spreadsheet/numberFormat/index.md' %}{% endcodeBlock %}\n     * @param {string} format - Specifies the number format code.\n     * @param {string} range? - Specifies the address for the range of cells.\n     */\n    Workbook.prototype.numberFormat = function (format, range) {\n        this.notify(events.applyNumberFormatting, { format: format, range: range });\n    };\n    /**\n     * Used to create new sheet.\n     * @hidden\n     */\n    Workbook.prototype.createSheet = function (index, sheets) {\n        if (index === void 0) { index = this.sheets.length; }\n        if (sheets === void 0) { sheets = [{}]; }\n        var _a;\n        (_a = this.sheets).splice.apply(_a, [index, 0].concat(sheets));\n        initSheet(this, sheets);\n        this.notify(sheetCreated, { sheetIndex: index || 0, sheets: sheets });\n        this.notify(events.workbookFormulaOperation, {\n            action: 'registerSheet', sheetIndex: index || 0, sheetCount: index + sheets.length\n        });\n    };\n    /**\n     * Used to remove sheet.\n     * @hidden\n     */\n    Workbook.prototype.removeSheet = function (idx) {\n        this.sheets.splice(idx, 1);\n    };\n    /**\n     * Destroys the Workbook library.\n     */\n    Workbook.prototype.destroy = function () {\n        this.notify(events.workbookDestroyed, null);\n        _super.prototype.destroy.call(this);\n    };\n    /**\n     * Called internally if any of the property value changed.\n     * @param  {WorkbookModel} newProp\n     * @param  {WorkbookModel} oldProp\n     * @returns void\n     * @hidden\n     */\n    Workbook.prototype.onPropertyChanged = function (newProp, oldProp) {\n        for (var _i = 0, _a = Object.keys(newProp); _i < _a.length; _i++) {\n            var prop = _a[_i];\n            switch (prop) {\n                case 'cellStyle':\n                    merge(this.commonCellStyle, skipDefaultValue(newProp.cellStyle));\n                    break;\n                case 'sheets':\n                    initSheet(this);\n                    break;\n            }\n        }\n    };\n    /**\n     * Not applicable for workbook.\n     * @hidden\n     */\n    Workbook.prototype.appendTo = function (selector) {\n        _super.prototype.appendTo.call(this, selector);\n    };\n    /**\n     * Used to hide/show the rows in spreadsheet.\n     * @param {number} startRow - Specifies the start row index.\n     * @param {number} endRow? - Specifies the end row index.\n     * @param {boolean} hide? - To hide/show the rows in specified range.\n     * @returns void\n     */\n    Workbook.prototype.hideRow = function (startIndex, endIndex, hide) {\n        if (endIndex === void 0) { endIndex = startIndex; }\n        if (hide === void 0) { hide = true; }\n        var sheet = this.getActiveSheet();\n        for (var i = startIndex; i <= endIndex; i++) {\n            setRow(sheet, i, { hidden: hide });\n        }\n    };\n    /**\n     * Used to hide/show the columns in spreadsheet.\n     * @param {number} startIndex - Specifies the start column index.\n     * @param {number} endIndex? - Specifies the end column index.\n     * @param {boolean} hide? - Set `true` / `false` to hide / show the columns.\n     * @returns void\n     */\n    Workbook.prototype.hideColumn = function (startIndex, endIndex, hide) {\n        if (endIndex === void 0) { endIndex = startIndex; }\n        if (hide === void 0) { hide = true; }\n        var sheet = this.getActiveSheet();\n        for (var i = startIndex; i <= endIndex; i++) {\n            setColumn(sheet, i, { hidden: hide });\n        }\n    };\n    /**\n     * Sets the border to specified range of cells.\n     * {% codeBlock src='spreadsheet/setBorder/index.md' %}{% endcodeBlock %}\n     * @param {CellStyleModel} style? - Specifies the style property which contains border value.\n     * @param {string} range? - Specifies the range of cell reference. If not specified, it will considered the active cell reference.\n     * @param {BorderType} type? - Specifies the range of cell reference. If not specified, it will considered the active cell reference.\n     * @returns void\n     */\n    Workbook.prototype.setBorder = function (style, range, type) {\n        this.notify(setCellFormat, {\n            style: style, borderType: type, range: range || this.getActiveSheet().selectedRange\n        });\n    };\n    /**\n     * Used to insert rows in to the spreadsheet.\n     * {% codeBlock src='spreadsheet/insertRow/index.md' %}{% endcodeBlock %}\n     * @param {number | RowModel[]} startRow? - Specifies the start row index / row model which needs to be inserted.\n     * @param {number} endRow? - Specifies the end row index.\n     * @returns void\n     */\n    Workbook.prototype.insertRow = function (startRow, endRow) {\n        this.notify(insertModel, { model: this.getActiveSheet(), start: startRow, end: endRow, modelType: 'Row' });\n    };\n    /**\n     * Used to insert columns in to the spreadsheet.\n     * {% codeBlock src='spreadsheet/insertColumn/index.md' %}{% endcodeBlock %}\n     * @param {number | ColumnModel[]} startColumn? - Specifies the start column index / column model which needs to be inserted.\n     * @param {number} endColumn? - Specifies the end column index.\n     * @returns void\n     */\n    Workbook.prototype.insertColumn = function (startColumn, endColumn) {\n        this.notify(insertModel, {\n            model: this.getActiveSheet(), start: startColumn, end: endColumn,\n            modelType: 'Column'\n        });\n    };\n    /**\n     * Used to insert sheets in to the spreadsheet.\n     * {% codeBlock src='spreadsheet/insertSheet/index.md' %}{% endcodeBlock %}\n     * @param {number | SheetModel[]} startSheet? - Specifies the start sheet index / sheet model which needs to be inserted.\n     * @param {number} endSheet? - Specifies the end sheet index.\n     * @returns void\n     */\n    Workbook.prototype.insertSheet = function (startSheet, endSheet) {\n        this.notify(insertModel, { model: this, start: startSheet, end: endSheet, modelType: 'Sheet' });\n    };\n    /**\n     * Used to delete rows, columns and sheets from the spreadsheet.\n     * {% codeBlock src='spreadsheet/delete/index.md' %}{% endcodeBlock %}\n     * @param {number | RowModel[]} startIndex? - Specifies the start sheet / row / column index.\n     * @param {number} endIndex? - Specifies the end sheet / row / column index.\n     * @param {ModelType} model? - Specifies the delete model type. By default, the model is considered as `Sheet`. The possible values are,\n     * - Row: To delete rows.\n     * - Column: To delete columns.\n     * - Sheet: To delete sheets.\n     * @returns void\n     */\n    Workbook.prototype.delete = function (startIndex, endIndex, model) {\n        startIndex = startIndex || 0;\n        this.notify(deleteModel, {\n            model: !model || model === 'Sheet' ? this : this.getActiveSheet(), start: startIndex,\n            end: isNullOrUndefined(endIndex) ? startIndex : endIndex, modelType: model || 'Sheet'\n        });\n    };\n    /**\n     * Used to merge the range of cells.\n     * {% codeBlock src='spreadsheet/merge/index.md' %}{% endcodeBlock %}\n     * @param {string} range? - Specifies the rnage of cells as address.\n     * @param {MergeType} type? - Specifies the merge type. The possible values are,\n     * - All: Merge all the cells between provided range.\n     * - Horizontally: Merge the cells row-wise.\n     * - Vertically: Merge the cells column-wise.\n     * @returns void\n     */\n    Workbook.prototype.merge = function (range, type) {\n        var sheetIdx = this.getAddressInfo(range).sheetIndex;\n        var sheet = getSheet(this, sheetIdx);\n        range = range || sheet.selectedRange;\n        this.notify(setMerge, { merge: true, range: range, type: type || 'All', sheet: sheet, refreshRibbon: range.indexOf(sheet.activeCell) > -1 ? true : false, preventRefresh: this.activeSheetIndex !== sheetIdx });\n    };\n    /** Used to compute the specified expression/formula.\n     * {% codeBlock src='spreadsheet/computeExpression/index.md' %}{% endcodeBlock %}\n     * @param {string} formula - Specifies the formula(=SUM(A1:A3)) or expression(2+3).\n     * @returns string | number\n     */\n    Workbook.prototype.computeExpression = function (formula) {\n        var args = {\n            action: 'computeExpression', formula: formula\n        };\n        this.notify(events.workbookFormulaOperation, args);\n        return args.calcValue;\n    };\n    Workbook.prototype.initEmptySheet = function () {\n        if (!this.sheets.length) {\n            this.createSheet();\n        }\n        else {\n            initSheet(this);\n        }\n    };\n    /** @hidden */\n    Workbook.prototype.getActiveSheet = function () {\n        return this.sheets[this.activeSheetIndex];\n    };\n    /** @hidden */\n    Workbook.prototype.skipHiddenSheets = function (index, initIdx, hiddenCount) {\n        if (hiddenCount === void 0) { hiddenCount = 0; }\n        if (this.sheets[index] && this.sheets[index].state !== 'Visible') {\n            if (initIdx === undefined) {\n                initIdx = index;\n            }\n            if (index && index + 1 === this.sheets.length) {\n                index = initIdx - 1;\n            }\n            else {\n                index < initIdx ? index-- : index++;\n            }\n            index = this.skipHiddenSheets(index, initIdx, ++hiddenCount);\n        }\n        if (hiddenCount === this.sheets.length) {\n            this.setSheetPropertyOnMute(this.sheets[0], 'state', 'Visible');\n            return 0;\n        }\n        return index;\n    };\n    /**\n     * Used for setting the used range row and column index.\n     * @hidden\n     */\n    Workbook.prototype.setUsedRange = function (rowIdx, colIdx) {\n        var sheet = this.getActiveSheet();\n        if (rowIdx > sheet.usedRange.rowIndex) {\n            sheet.usedRange.rowIndex = rowIdx;\n            this.notify(updateUsedRange, { index: rowIdx, update: 'row' });\n        }\n        if (colIdx > sheet.usedRange.colIndex) {\n            sheet.usedRange.colIndex = colIdx;\n            this.notify(updateUsedRange, { index: colIdx, update: 'col' });\n        }\n    };\n    /**\n     * Gets the range of data as JSON from the specified address.\n     * {% codeBlock src='spreadsheet/getData/index.md' %}{% endcodeBlock %}\n     * @param {string} address - Specifies the address for range of cells.\n     */\n    Workbook.prototype.getData = function (address) {\n        return getData(this, address);\n    };\n    /**\n     * Get component name.\n     * @returns string\n     * @hidden\n     */\n    Workbook.prototype.getModuleName = function () {\n        return 'workbook';\n    };\n    /** @hidden */\n    Workbook.prototype.getValueRowCol = function (sheetIndex, rowIndex, colIndex) {\n        var args = {\n            action: 'getSheetInfo', sheetInfo: []\n        };\n        this.notify(events.workbookFormulaOperation, args);\n        var id = getSheetIndexByName(this, 'Sheet' + (sheetIndex + 1), args.sheetInfo);\n        if (id === -1) {\n            var errArgs = { action: 'getReferenceError', refError: '' };\n            this.notify(events.workbookFormulaOperation, errArgs);\n            return errArgs.refError;\n        }\n        sheetIndex = getSheetIndexFromId(this, sheetIndex + 1);\n        var sheet = getSheet(this, sheetIndex);\n        var cell = getCell(rowIndex - 1, colIndex - 1, sheet);\n        return (cell && cell.value) || '';\n    };\n    /** @hidden */\n    Workbook.prototype.setValueRowCol = function (sheetIndex, value, rowIndex, colIndex) {\n        sheetIndex = getSheetIndexFromId(this, sheetIndex);\n        this.notify(events.workbookEditOperation, {\n            action: 'updateCellValue', address: [rowIndex - 1, colIndex - 1], value: value,\n            sheetIndex: sheetIndex, isValueOnly: true\n        });\n    };\n    /**\n     * Opens the specified excel file or stream.\n     * @param {OpenOptions} options - Options for opening the excel file.\n     */\n    Workbook.prototype.open = function (options) {\n        this.notify(events.workbookOpen, options);\n    };\n    /**\n     * Opens the specified JSON object.\n     * {% codeBlock src='spreadsheet/openFromJson/index.md' %}{% endcodeBlock %}\n     * <br><br>\n     * The available arguments in options are:\n     * * file: Specifies the spreadsheet model as object or string. And the object contains the jsonObject,\n     * which is saved from spreadsheet using saveAsJson method.\n     *\n     * @param options - Options for opening the JSON object.\n     */\n    Workbook.prototype.openFromJson = function (options) {\n        this.isOpen = true;\n        var jsonObject = typeof options.file === 'object' ? JSON.stringify(options.file) : options.file;\n        this.notify(events.workbookOpen, { jsonObject: jsonObject });\n    };\n    /**\n     * Saves the Spreadsheet data to Excel file.\n     * <br><br>\n     * The available arguments in saveOptions are:\n     * * url: Specifies the save URL.\n     * * fileName: Specifies the file name.\n     * * saveType: Specifies the file type need to be saved.\n     *\n     * {% codeBlock src='spreadsheet/save/index.md' %}{% endcodeBlock %}\n     * @param {SaveOptions} saveOptions - Options for saving the excel file.\n     */\n    Workbook.prototype.save = function (saveOptions) {\n        if (saveOptions === void 0) { saveOptions = {}; }\n        if (this.allowSave) {\n            var defaultProps = {\n                url: this.saveUrl,\n                fileName: saveOptions.fileName || 'Sample',\n                saveType: 'Xlsx'\n            };\n            var eventArgs = __assign({}, defaultProps, saveOptions, { customParams: {}, isFullPost: true, needBlobData: false, cancel: false });\n            this.trigger('beforeSave', eventArgs);\n            this.notify(beginAction, { eventArgs: eventArgs, action: 'beforeSave' });\n            if (!eventArgs.cancel) {\n                this.notify(events.beginSave, {\n                    saveSettings: eventArgs, isFullPost: eventArgs.isFullPost,\n                    needBlobData: eventArgs.needBlobData, customParams: eventArgs.customParams\n                });\n            }\n        }\n    };\n    /**\n     * Saves the Spreadsheet data as JSON object.\n     * {% codeBlock src='spreadsheet/saveAsJson/index.md' %}{% endcodeBlock %}\n     */\n    Workbook.prototype.saveAsJson = function () {\n        var _this = this;\n        return new Promise(function (resolve) {\n            _this.on(events.onSave, function (args) {\n                args.cancel = true;\n                _this.off(events.onSave);\n                resolve({ jsonObject: { Workbook: args.jsonObject } });\n                _this.notify(events.saveCompleted, args);\n            });\n            _this.save();\n        });\n    };\n    Workbook.prototype.addHyperlink = function (hyperlink, cellAddress) {\n        var args = { hyperlink: hyperlink, cell: cellAddress };\n        this.notify(setLinkModel, args);\n    };\n    /**\n     * To find the specified cell value.\n     * @hidden\n     * @param args - options for find.\n     */\n    Workbook.prototype.findHandler = function (args) {\n        if (args.findOpt === 'next') {\n            this.notify(events.findNext, args);\n        }\n        else if (args.findOpt === 'prev') {\n            this.notify(events.findPrevious, args);\n        }\n    };\n    /**\n     * @hidden\n     */\n    Workbook.prototype.replaceHandler = function (args) {\n        if (args.replaceBy === 'replace') {\n            this.notify(events.replaceHandler, args);\n        }\n        else {\n            this.notify(events.replaceAllHandler, args);\n        }\n    };\n    /**\n     * Protect the active sheet based on the protect sheetings.\n     * @param protectSettings - Specifies the protect settings of the sheet.\n     */\n    Workbook.prototype.protectSheet = function (sheet, protectSettings) {\n        this.notify(events.protectsheetHandler, protectSettings);\n    };\n    /**\n     * Unprotect the active sheet.\n     * @param sheet - Specifies the sheet to Unprotect.\n     */\n    Workbook.prototype.unprotectSheet = function (sheet) {\n        var args = { sheet: sheet };\n        this.notify(events.unprotectsheetHandler, args);\n    };\n    /**\n     * Sorts the range of cells in the active Spreadsheet.\n     * @param sortOptions - options for sorting.\n     * @param range - address of the data range.\n     */\n    Workbook.prototype.sort = function (sortOptions, range) {\n        if (!this.allowSorting) {\n            return Promise.reject();\n        }\n        var eventArgs = {\n            range: range || this.getActiveSheet().selectedRange,\n            sortOptions: sortOptions || { sortDescriptors: {} },\n            cancel: false\n        };\n        var promise = new Promise(function (resolve, reject) { resolve((function () { })()); });\n        var sortArgs = { args: eventArgs, promise: promise };\n        this.notify(events.initiateSort, sortArgs);\n        return sortArgs.promise;\n    };\n    Workbook.prototype.addDataValidation = function (rules, range) {\n        range = range ? range : this.getActiveSheet().selectedRange;\n        var eventArgs = {\n            range: range, type: rules.type, operator: rules.operator, value1: rules.value1,\n            value2: rules.value2, ignoreBlank: rules.ignoreBlank, inCellDropDown: rules.inCellDropDown, cancel: false\n        };\n        this.notify(beginAction, { eventArgs: eventArgs, action: 'validation' });\n        if (!eventArgs.cancel) {\n            range = eventArgs.range;\n            rules.type = eventArgs.type;\n            rules.operator = eventArgs.operator;\n            rules.value1 = eventArgs.value1;\n            rules.value2 = eventArgs.value2;\n            rules.ignoreBlank = eventArgs.ignoreBlank;\n            rules.inCellDropDown = eventArgs.inCellDropDown;\n            this.notify(events.setValidation, { rules: rules, range: range });\n            delete eventArgs.cancel;\n            this.notify(completeAction, { eventArgs: eventArgs, action: 'validation' });\n        }\n    };\n    Workbook.prototype.removeDataValidation = function (range) {\n        this.notify(events.removeValidation, { range: range });\n    };\n    Workbook.prototype.addInvalidHighlight = function (range) {\n        this.notify(events.addHighlight, { range: range });\n    };\n    Workbook.prototype.removeInvalidHighlight = function (range) {\n        this.notify(events.removeHighlight, { range: range });\n    };\n    Workbook.prototype.conditionalFormat = function (conditionalFormat) {\n        conditionalFormat.range = conditionalFormat.range || this.getActiveSheet().selectedRange;\n        this.notify(events.setCFRule, { conditionalFormat: conditionalFormat });\n    };\n    Workbook.prototype.clearConditionalFormat = function (range) {\n        range = range || this.getActiveSheet().selectedRange;\n        this.notify(events.clearCFRule, { range: range });\n    };\n    /**\n     * To update a cell properties.\n     * @param {CellModel} cell - Cell properties.\n     * @param {string} address - Address to update.\n     */\n    Workbook.prototype.updateCell = function (cell, address) {\n        var sheetIdx;\n        var range = getIndexesFromAddress(address);\n        if (address.includes('!')) {\n            sheetIdx = getSheetIndex(this, address.split('!')[0]);\n            if (sheetIdx === undefined) {\n                sheetIdx = this.activeSheetIndex;\n            }\n        }\n        else {\n            sheetIdx = this.activeSheetIndex;\n        }\n        setCell(range[0], range[1], this.sheets[sheetIdx], cell, true);\n        if (cell.value) {\n            this.notify(events.workbookEditOperation, {\n                action: 'updateCellValue', address: range, value: cell.value,\n                sheetIndex: sheetIdx\n            });\n        }\n    };\n    /**\n     * This method is used to wrap/unwrap the text content of the cell.\n     * {% codeBlock src='spreadsheet/wrap/index.md' %}{% endcodeBlock %}\n     * @param address - Address of the cell to be wrapped.\n     * @param wrap - Set `false` if the text content of the cell to be unwrapped.\n     * @returns void\n     */\n    Workbook.prototype.wrap = function (address, wrap) {\n        if (wrap === void 0) { wrap = true; }\n        wrapText(address, wrap, this);\n    };\n    /**\n     * Adds the defined name to the Spreadsheet.\n     * @param {DefineNameModel} definedName - Specifies the name.\n     * @return {boolean} - Return the added status of the defined name.\n     */\n    Workbook.prototype.addDefinedName = function (definedName) {\n        var eventArgs = {\n            action: 'addDefinedName',\n            isAdded: false,\n            definedName: definedName\n        };\n        this.notify(events.workbookFormulaOperation, eventArgs);\n        return eventArgs.isAdded;\n    };\n    /**\n     * Removes the defined name from the Spreadsheet.\n     * @param {string} definedName - Specifies the name.\n     * @param {string} scope - Specifies the scope of the defined name.\n     * @return {boolean} - Return the removed status of the defined name.\n     */\n    Workbook.prototype.removeDefinedName = function (definedName, scope) {\n        if (scope === void 0) { scope = ''; }\n        var eventArgs = {\n            action: 'removeDefinedName',\n            isRemoved: false,\n            definedName: definedName,\n            scope: scope\n        };\n        this.notify(events.workbookFormulaOperation, eventArgs);\n        return eventArgs.isRemoved;\n    };\n    /** @hidden */\n    Workbook.prototype.clearRange = function (address, sheetIndex, valueOnly) {\n        if (valueOnly === void 0) { valueOnly = true; }\n        clearRange(this, address || this.getActiveSheet().selectedRange, isNullOrUndefined(sheetIndex) ? this.activeSheetIndex : sheetIndex, valueOnly);\n    };\n    /**\n     * Used to set the image in spreadsheet.\n     * @param {ImageModel} images - Specifies the options to insert image in spreadsheet.\n     * @param {string} range - Specifies the range in spreadsheet.\n     * @returns void\n     */\n    Workbook.prototype.insertImage = function (images, range) {\n        this.notify(setImage, { options: images, range: range ? range : this.getActiveSheet().selectedRange });\n    };\n    /**\n     * Used to set the chart in spreadsheet.\n     * {% codeBlock src='spreadsheet/insertChart/index.md' %}{% endcodeBlock %}\n     * @param {ChartModel} chart - Specifies the options to insert chart in spreadsheet.\n     * @returns void\n     */\n    Workbook.prototype.insertChart = function (chart) {\n        this.notify(setChart, { chart: chart });\n    };\n    /**\n     * Used to delete the chart from spreadsheet.\n     * {% codeBlock src='spreadsheet/deleteChart/index.md' %}{% endcodeBlock %}\n     * @param {string} id - Specifies the chart element id.\n     * @returns void\n     */\n    Workbook.prototype.deleteChart = function (id) {\n        this.notify(deleteChart, { id: id });\n    };\n    /**\n     * Filters the range of cells in the sheet.\n     */\n    Workbook.prototype.filter = function (filterOptions, range) {\n        if (!this.allowFiltering) {\n            return Promise.reject();\n        }\n        var eventArgs = {\n            range: range || this.getActiveSheet().selectedRange,\n            filterOptions: filterOptions,\n            cancel: false\n        };\n        var promise = new Promise(function (resolve, reject) { resolve((function () { })()); });\n        var filterArgs = { args: eventArgs, promise: promise };\n        this.notify(events.initiateFilter, filterArgs);\n        return filterArgs.promise;\n    };\n    /**\n     * Clears the filter changes of the sheet.\n     */\n    Workbook.prototype.clearFilter = function () {\n        this.notify(events.clearAllFilter, null);\n    };\n    /**\n     * To add custom library function.\n     * @param {string} functionHandler - Custom function handler name\n     * @param {string} functionName - Custom function name\n     */\n    Workbook.prototype.addCustomFunction = function (functionHandler, functionName) {\n        functionName = functionName ? functionName : typeof functionHandler === 'string' ? functionHandler :\n            functionHandler.name.replace('bound ', '');\n        var eventArgs = {\n            action: 'addCustomFunction',\n            functionHandler: functionHandler,\n            functionName: functionName\n        };\n        this.notify(events.workbookFormulaOperation, eventArgs);\n    };\n    /**\n     * This method is used to Clear contents, formats and hyperlinks in spreadsheet.\n     *    * @param {ClearOptions} options - Options for clearing the content, formats and hyperlinks in spreadsheet.\n     */\n    Workbook.prototype.clear = function (options) {\n        this.notify(events.clear, options);\n    };\n    /**\n     * Gets the formatted text of the cell.\n     * {% codeBlock src='spreadsheet/getDisplayText/index.md' %}{% endcodeBlock %}\n     */\n    Workbook.prototype.getDisplayText = function (cell) {\n        if (!cell) {\n            return '';\n        }\n        if (cell.value && cell.format) {\n            var eventArgs = {\n                formattedText: cell.value, value: cell.value, format: cell.format, onLoad: true\n            };\n            this.notify(events.getFormattedCellObject, eventArgs);\n            return eventArgs.formattedText;\n        }\n        else if (!cell.value && cell.hyperlink) {\n            return typeof cell.hyperlink === 'string' ? cell.hyperlink : cell.hyperlink.address;\n        }\n        else {\n            return cell.value ? cell.value.toString() : '';\n        }\n    };\n    /**\n     * @hidden\n     */\n    Workbook.prototype.getAddressInfo = function (address) {\n        return getAddressInfo(this, address);\n    };\n    /**\n     * @hidden\n     */\n    Workbook.prototype.setSheetPropertyOnMute = function (sheet, prop, value) {\n        this.isProtectedOnChange = true;\n        sheet[prop] = value;\n        this.isProtectedOnChange = false;\n    };\n    var Workbook_1;\n    __decorate([\n        Collection([], Sheet)\n    ], Workbook.prototype, \"sheets\", void 0);\n    __decorate([\n        Property(0)\n    ], Workbook.prototype, \"activeSheetIndex\", void 0);\n    __decorate([\n        Property('100%')\n    ], Workbook.prototype, \"height\", void 0);\n    __decorate([\n        Property(true)\n    ], Workbook.prototype, \"allowFindAndReplace\", void 0);\n    __decorate([\n        Property()\n    ], Workbook.prototype, \"filterCollection\", void 0);\n    __decorate([\n        Property('100%')\n    ], Workbook.prototype, \"width\", void 0);\n    __decorate([\n        Property(true)\n    ], Workbook.prototype, \"showRibbon\", void 0);\n    __decorate([\n        Property(true)\n    ], Workbook.prototype, \"showFormulaBar\", void 0);\n    __decorate([\n        Property(true)\n    ], Workbook.prototype, \"showSheetTabs\", void 0);\n    __decorate([\n        Property(true)\n    ], Workbook.prototype, \"allowEditing\", void 0);\n    __decorate([\n        Property(true)\n    ], Workbook.prototype, \"allowOpen\", void 0);\n    __decorate([\n        Property(true)\n    ], Workbook.prototype, \"allowSave\", void 0);\n    __decorate([\n        Property(true)\n    ], Workbook.prototype, \"allowSorting\", void 0);\n    __decorate([\n        Property(true)\n    ], Workbook.prototype, \"allowFiltering\", void 0);\n    __decorate([\n        Property(true)\n    ], Workbook.prototype, \"allowNumberFormatting\", void 0);\n    __decorate([\n        Property(true)\n    ], Workbook.prototype, \"allowCellFormatting\", void 0);\n    __decorate([\n        Property(true)\n    ], Workbook.prototype, \"allowHyperlink\", void 0);\n    __decorate([\n        Property(true)\n    ], Workbook.prototype, \"allowInsert\", void 0);\n    __decorate([\n        Property(true)\n    ], Workbook.prototype, \"allowDelete\", void 0);\n    __decorate([\n        Property(true)\n    ], Workbook.prototype, \"allowMerge\", void 0);\n    __decorate([\n        Property(true)\n    ], Workbook.prototype, \"allowDataValidation\", void 0);\n    __decorate([\n        Property(true)\n    ], Workbook.prototype, \"allowImage\", void 0);\n    __decorate([\n        Property(true)\n    ], Workbook.prototype, \"allowChart\", void 0);\n    __decorate([\n        Property(true)\n    ], Workbook.prototype, \"allowConditionalFormat\", void 0);\n    __decorate([\n        Complex({}, CellStyle)\n    ], Workbook.prototype, \"cellStyle\", void 0);\n    __decorate([\n        Property('')\n    ], Workbook.prototype, \"openUrl\", void 0);\n    __decorate([\n        Property('')\n    ], Workbook.prototype, \"saveUrl\", void 0);\n    __decorate([\n        Collection([], DefineName)\n    ], Workbook.prototype, \"definedNames\", void 0);\n    __decorate([\n        Event()\n    ], Workbook.prototype, \"beforeOpen\", void 0);\n    __decorate([\n        Event()\n    ], Workbook.prototype, \"openFailure\", void 0);\n    __decorate([\n        Event()\n    ], Workbook.prototype, \"beforeSave\", void 0);\n    __decorate([\n        Event()\n    ], Workbook.prototype, \"saveComplete\", void 0);\n    __decorate([\n        Event()\n    ], Workbook.prototype, \"beforeCellFormat\", void 0);\n    __decorate([\n        Event()\n    ], Workbook.prototype, \"queryCellInfo\", void 0);\n    Workbook = Workbook_1 = __decorate([\n        NotifyPropertyChanges\n    ], Workbook);\n    return Workbook;\n}(Component));\nexport { Workbook };\n","import { detach, EventHandler, Browser, extend, isNullOrUndefined } from '@syncfusion/ej2-base';\nimport { getRangeIndexes, getCell, setCell, getSheet, getSwapRange, wrapEvent, inRange } from '../../workbook/index';\nimport { getRangeAddress, workbookEditOperation, getSheetIndexFromId, getSheetName } from '../../workbook/index';\nimport { getFormattedCellObject, workbookFormulaOperation, applyCellFormat, checkIsFormula } from '../../workbook/index';\nimport { pasteMerge, setMerge, getCellIndexes, getCellAddress } from '../../workbook/index';\nimport { ribbonClick, cut, copy, paste, initiateFilterUI } from '../common/index';\nimport { hasTemplate, createImageElement } from '../common/index';\nimport { enableToolbarItems, rowHeightChanged, completeAction, beginAction } from '../common/index';\nimport { clearCopy, locateElem, selectRange, dialog, contentLoaded, tabSwitch, cMenuBeforeOpen, locale } from '../common/index';\nimport { getMaxHgt, setMaxHgt, setRowEleHeight, deleteImage, getRowIdxFromClientY, getColIdxFromClientX } from '../common/index';\nimport { Deferred } from '@syncfusion/ej2-data';\nimport { refreshRibbonIcons, isCellReference, getColumn, isLocked as isCellLocked } from '../../workbook/index';\nimport { skipDefaultValue, getFilteredCollection, getColumnHeaderText, setChart } from '../../workbook/index';\n/**\n * Represents clipboard support for Spreadsheet.\n */\nvar Clipboard = /** @class */ (function () {\n    function Clipboard(parent) {\n        this.externalMerge = false;\n        this.parent = parent;\n        this.init();\n        this.addEventListener();\n    }\n    Clipboard.prototype.init = function () {\n        this.parent.element\n            .appendChild(this.parent.createElement('input', { className: 'e-clipboard', attrs: { 'contenteditable': 'true' } }));\n    };\n    Clipboard.prototype.addEventListener = function () {\n        var ele = this.getClipboardEle();\n        this.parent.on(cut, this.cut, this);\n        this.parent.on(copy, this.copy, this);\n        this.parent.on(paste, this.paste, this);\n        this.parent.on(clearCopy, this.clearCopiedInfo, this);\n        this.parent.on(tabSwitch, this.tabSwitchHandler, this);\n        this.parent.on(cMenuBeforeOpen, this.cMenuBeforeOpenHandler, this);\n        this.parent.on(ribbonClick, this.ribbonClickHandler, this);\n        this.parent.on(contentLoaded, this.initCopyIndicator, this);\n        this.parent.on(rowHeightChanged, this.rowHeightChanged, this);\n        EventHandler.add(ele, 'cut', this.cut, this);\n        EventHandler.add(ele, 'copy', this.copy, this);\n        EventHandler.add(ele, 'paste', this.paste, this);\n    };\n    Clipboard.prototype.removeEventListener = function () {\n        var ele = this.getClipboardEle();\n        if (!this.parent.isDestroyed) {\n            this.parent.off(cut, this.cut);\n            this.parent.off(copy, this.copy);\n            this.parent.off(paste, this.paste);\n            this.parent.off(clearCopy, this.clearCopiedInfo);\n            this.parent.off(tabSwitch, this.tabSwitchHandler);\n            this.parent.off(cMenuBeforeOpen, this.cMenuBeforeOpenHandler);\n            this.parent.off(ribbonClick, this.ribbonClickHandler);\n            this.parent.off(contentLoaded, this.initCopyIndicator);\n            this.parent.off(rowHeightChanged, this.rowHeightChanged);\n        }\n        EventHandler.remove(ele, 'cut', this.cut);\n        EventHandler.remove(ele, 'copy', this.copy);\n        EventHandler.remove(ele, 'paste', this.paste);\n    };\n    Clipboard.prototype.ribbonClickHandler = function (args) {\n        var parentId = this.parent.element.id;\n        switch (args.item.id) {\n            case parentId + '_cut':\n                this.cut({ isAction: true });\n                break;\n            case parentId + '_copy':\n                this.copy({ isAction: true });\n                break;\n        }\n        this.parent.element.focus();\n    };\n    Clipboard.prototype.tabSwitchHandler = function (args) {\n        if (args.activeTab === 0 && !this.copiedInfo && !this.copiedShapeInfo) {\n            this.hidePaste();\n        }\n    };\n    Clipboard.prototype.cMenuBeforeOpenHandler = function (e) {\n        var sheet = this.parent.getActiveSheet();\n        var l10n = this.parent.serviceLocator.getService(locale);\n        var delRowItems = [];\n        var hideRowItems = [];\n        var delColItems = [];\n        var hideColItems = [];\n        var actCell = sheet.activeCell;\n        var actCellIndex = getCellIndexes(actCell);\n        var cellObj = getCell(actCellIndex[0], actCellIndex[1], sheet);\n        var isLocked = sheet.isProtected && isCellLocked(cellObj, getColumn(sheet, actCellIndex[1]));\n        if (e.target === 'Content' || e.target === 'RowHeader' || e.target === 'ColumnHeader') {\n            this.parent.enableContextMenuItems([l10n.getConstant('Paste'), l10n.getConstant('PasteSpecial')], (this.copiedInfo ||\n                this.copiedShapeInfo && !isLocked) ? true : false);\n            this.parent.enableContextMenuItems([l10n.getConstant('Cut')], (!isLocked) ? true : false);\n        }\n        if ((e.target === 'Content') && isLocked) {\n            this.parent.enableContextMenuItems([l10n.getConstant('Cut'), l10n.getConstant('Filter'), l10n.getConstant('Sort')], false);\n        }\n        if ((e.target === 'Content') && (isLocked && !sheet.protectSettings.insertLink)) {\n            this.parent.enableContextMenuItems([l10n.getConstant('Hyperlink')], false);\n        }\n        if (e.target === 'ColumnHeader' && sheet.isProtected) {\n            delColItems = [l10n.getConstant('DeleteColumn'), l10n.getConstant('DeleteColumns'),\n                l10n.getConstant('InsertColumn'), l10n.getConstant('InsertColumns')];\n            hideColItems = [l10n.getConstant('HideColumn'), l10n.getConstant('HideColumns'),\n                l10n.getConstant('UnHideColumns')];\n            this.parent.enableContextMenuItems(delColItems, false);\n            this.parent.enableContextMenuItems(hideColItems, (sheet.protectSettings.formatColumns) ? true : false);\n        }\n        if (e.target === 'RowHeader' && sheet.isProtected) {\n            delRowItems = [l10n.getConstant('DeleteRow'), l10n.getConstant('DeleteRows'),\n                l10n.getConstant('InsertRow'), l10n.getConstant('InsertRows')];\n            hideRowItems = [l10n.getConstant('HideRow'), l10n.getConstant('HideRows'), l10n.getConstant('UnHideRows')];\n            this.parent.enableContextMenuItems(delRowItems, false);\n            this.parent.enableContextMenuItems(hideRowItems, (sheet.protectSettings.formatRows) ? true : false);\n        }\n    };\n    Clipboard.prototype.rowHeightChanged = function (args) {\n        if (this.copiedInfo && this.copiedInfo.range[0] > args.rowIdx) {\n            var ele = this.parent.element.getElementsByClassName('e-copy-indicator')[0];\n            if (ele) {\n                ele.style.top = parseInt(ele.style.top, 10) + args.threshold + \"px\";\n            }\n        }\n    };\n    Clipboard.prototype.cut = function (args) {\n        this.setCopiedInfo(args, true);\n    };\n    Clipboard.prototype.copy = function (args) {\n        this.copiedSheet = this.parent.getActiveSheet();\n        this.setCopiedInfo(args, false);\n    };\n    Clipboard.prototype.paste = function (args) {\n        if (this.parent.isEdit) {\n            return;\n        }\n        var rfshRange;\n        args.isAction = true;\n        /* tslint:disable-next-line */\n        var isExternal = ((args && args.clipboardData) || window['clipboardData']);\n        var copiedIdx = this.getCopiedIdx();\n        var isCut;\n        var copyInfo = Object.assign({}, this.copiedInfo);\n        if (isExternal || this.copiedShapeInfo || (args.isInternal && this.copiedInfo)) {\n            var cSIdx = (args && args.sIdx > -1) ? args.sIdx : this.parent.activeSheetIndex;\n            var curSheet = getSheet(this.parent, cSIdx);\n            var selIdx = getSwapRange(args && args.range || getRangeIndexes(curSheet.selectedRange));\n            var rows = isExternal && this.getExternalCells(args);\n            if (!args.isInternal && rows && rows.internal) {\n                isExternal = false;\n                if (!this.copiedInfo) {\n                    return;\n                }\n            }\n            if (isExternal && !rows.length) { // If image pasted\n                return;\n            }\n            var cellLength = 0;\n            if (rows) {\n                for (var i = 0; i < rows.length; i++) {\n                    cellLength = rows[i].cells.length > cellLength ? rows[i].cells.length : cellLength;\n                }\n            }\n            var rowIdx = selIdx[0];\n            var cIdx = isExternal\n                ? [0, 0, rows.length - 1, cellLength - 1] : getSwapRange(this.copiedShapeInfo ?\n                getRangeIndexes(curSheet.selectedRange) : this.copiedInfo.range);\n            var isRepeative = (selIdx[2] - selIdx[0] + 1) % (cIdx[2] - cIdx[0] + 1) === 0\n                && (selIdx[3] - selIdx[1] + 1) % (cIdx[3] - cIdx[1] + 1) === 0;\n            rfshRange = isRepeative ? selIdx : [selIdx[0], selIdx[1]]\n                .concat([selIdx[0] + cIdx[2] - cIdx[0], selIdx[1] + cIdx[3] - cIdx[1] || selIdx[1]]);\n            var beginEventArgs = {\n                requestType: 'paste',\n                copiedInfo: this.copiedInfo,\n                copiedRange: getRangeAddress(cIdx),\n                pastedRange: getRangeAddress(rfshRange),\n                type: (args && args.type) || 'All',\n                cancel: false\n            };\n            if (args.isAction && !this.copiedShapeInfo && this.copiedInfo) {\n                this.parent.notify(beginAction, { eventArgs: beginEventArgs, action: 'clipboard' });\n            }\n            if (beginEventArgs.cancel) {\n                return;\n            }\n            var cell = void 0;\n            var isExtend = void 0;\n            var prevCell = void 0;\n            var mergeCollection = [];\n            var prevSheet = getSheet(this.parent, isExternal ? cSIdx : copiedIdx);\n            selIdx = getRangeIndexes(beginEventArgs.pastedRange);\n            rowIdx = selIdx[0];\n            cIdx = isExternal\n                ? [0, 0, rows.length - 1, cellLength - 1] : getSwapRange(this.copiedShapeInfo ?\n                getRangeIndexes(curSheet.selectedRange) : this.copiedInfo.range);\n            isRepeative = (selIdx[2] - selIdx[0] + 1) % (cIdx[2] - cIdx[0] + 1) === 0 && (selIdx[3] - selIdx[1] + 1) %\n                (cIdx[3] - cIdx[1] + 1) === 0;\n            var mergeArgs = {\n                range: cIdx, prevSheet: prevSheet, cancel: false\n            };\n            rfshRange = isRepeative ? selIdx : [selIdx[0], selIdx[1]]\n                .concat([selIdx[0] + cIdx[2] - cIdx[0], selIdx[1] + cIdx[3] - cIdx[1] || selIdx[1]]);\n            var copiedAddress = getCellAddress(cIdx[0], cIdx[1]);\n            var copiedIndex = getCellIndexes(copiedAddress);\n            this.parent.notify(refreshRibbonIcons, copiedIndex);\n            if (this.copiedShapeInfo && !this.copiedInfo) {\n                var pictureElem = this.copiedShapeInfo.pictureElem;\n                if (pictureElem.classList.contains('e-datavisualization-chart')) {\n                    this.parent.notify(setChart, {\n                        chart: [this.copiedShapeInfo.chartInfo], isInitCell: true, isUndoRedo: true, isPaste: true,\n                        dataSheetIdx: this.copiedShapeInfo.sheetIdx, isCut: this.copiedShapeInfo.isCut,\n                        range: args.range || curSheet.selectedRange, isIdAvailabe: false\n                    });\n                }\n                else {\n                    this.parent.notify(createImageElement, {\n                        options: {\n                            src: pictureElem.style.backgroundImage.replace(/url\\((['\"])?(.*?)\\1\\)/gi, '$2'),\n                            height: this.copiedShapeInfo.height, width: this.copiedShapeInfo.width,\n                            imageId: this.copiedShapeInfo.isCut ? pictureElem.id : ''\n                        },\n                        range: getRangeAddress([rowIdx, selIdx[1], rowIdx, selIdx[1]]), isPublic: false, isUndoRedo: true\n                    });\n                }\n                var pastedCell = getCell(rowIdx, selIdx[1], curSheet);\n                if (pastedCell && !isNullOrUndefined(pastedCell.image)) {\n                    var imgLen = pastedCell.image ? pastedCell.image.length - 1 : 0;\n                    var eventArgs = {\n                        requestType: 'imagePaste',\n                        copiedShapeInfo: this.copiedShapeInfo,\n                        pasteSheetIndex: this.parent.activeSheetIndex,\n                        pastedRange: getSheetName(this.parent) + '!' + getRangeAddress([rowIdx, selIdx[1], rowIdx, selIdx[1]]),\n                        pastedPictureElement: document.getElementById(pastedCell.image[imgLen].id)\n                    };\n                    this.parent.notify(completeAction, { eventArgs: eventArgs, action: 'clipboard' });\n                }\n            }\n            else {\n                this.parent.notify(pasteMerge, mergeArgs);\n                if (mergeArgs.cancel) {\n                    return;\n                }\n                var pasteType = beginEventArgs.type ? beginEventArgs.type : args.type;\n                var cRows = [];\n                var inRange_1 = this.isInRange(cIdx, selIdx);\n                for (var i = cIdx[0], l = 0; i <= cIdx[2]; i++, l++) {\n                    if (inRange_1) {\n                        cRows[selIdx[0] + l] = { cells: [] };\n                    }\n                    for (var j = cIdx[1], k = 0; j <= cIdx[3]; j++, k++) {\n                        if (inRange_1) {\n                            cRows[selIdx[0] + l].cells[selIdx[1] + k] = getCell(selIdx[0] + l, selIdx[1] + k, prevSheet);\n                        }\n                        cell = isExternal ? rows[i].cells[j] : Object.assign({}, (inRange_1 && cRows[i] && cRows[i].cells[j])\n                            ? cRows[i].cells[j] : getCell(i, j, prevSheet));\n                        this.copiedCell = [i, j];\n                        if (cell && args && args.type || pasteType) {\n                            switch (pasteType) {\n                                case 'Formats':\n                                    cell = { format: cell.format, style: cell.style };\n                                    break;\n                                case 'Values':\n                                    cell = { value: cell.value };\n                                    if (cell.value && cell.value.toString().indexOf('\\n') > -1) {\n                                        var ele = this.parent.getCell(selIdx[0], selIdx[1]);\n                                        ele.classList.add('e-alt-unwrap');\n                                    }\n                                    break;\n                            }\n                            isExtend = ['Formats', 'Values'].indexOf(args.type) > -1;\n                        }\n                        if ((!this.parent.scrollSettings.isFinite && (cIdx[2] - cIdx[0] > (1048575 - selIdx[0])\n                            || cIdx[3] - cIdx[1] > (16383 - selIdx[1])))\n                            || (this.parent.scrollSettings.isFinite && (cIdx[2] - cIdx[0] > (curSheet.rowCount - 1 - selIdx[0])\n                                || cIdx[3] - cIdx[1] > (curSheet.colCount - 1 - selIdx[1])))) {\n                            this.showDialog();\n                            return;\n                        }\n                        if (isRepeative) {\n                            for (var x = selIdx[0]; x <= selIdx[2]; x += (cIdx[2] - cIdx[0]) + 1) {\n                                for (var y = selIdx[1]; y <= selIdx[3]; y += (cIdx[3] - cIdx[1] + 1)) {\n                                    prevCell = getCell(x + l, y + k, curSheet) || {};\n                                    if (!this.externalMerge && prevCell.colSpan !== undefined || prevCell.rowSpan !== undefined) {\n                                        mergeArgs = { range: [x + l, y + k, x + l, y + k] };\n                                        var merge = { range: mergeArgs.range, merge: false, isAction: false, type: 'All' };\n                                        mergeCollection.push(merge);\n                                        if (this.parent.activeSheetIndex === curSheet.index) {\n                                            this.parent.notify(setMerge, merge);\n                                        }\n                                    }\n                                    var colInd = y + k;\n                                    if (this.externalMerge && this.externalMergeRow === x + l) {\n                                        colInd = colInd + 1;\n                                    }\n                                    else {\n                                        this.externalMerge = false;\n                                    }\n                                    var newFormula = this.isFormula([x + l, colInd]);\n                                    if (!isNullOrUndefined(newFormula)) {\n                                        cell.formula = newFormula;\n                                    }\n                                    this.setCell(x + l, colInd, curSheet, cell, isExtend);\n                                    var sId = this.parent.activeSheetIndex;\n                                    var cellElem = this.parent.getCell(x + l, colInd);\n                                    var address = getCellAddress(x + l, colInd);\n                                    var cellArgs = {\n                                        address: this.parent.sheets[sId].name + '!' + address,\n                                        requestType: 'paste',\n                                        value: getCell(x + l, colInd, curSheet) ? getCell(x + l, colInd, curSheet).value : '',\n                                        oldValue: prevCell.value,\n                                        element: cellElem,\n                                        displayText: this.parent.getDisplayText(cell)\n                                    };\n                                    this.parent.trigger('cellSave', cellArgs);\n                                }\n                            }\n                        }\n                        else {\n                            if (!hasTemplate(this.parent, i, j, copiedIdx)) {\n                                this.setCell(rowIdx, selIdx[1] + k, curSheet, cell, isExtend);\n                            }\n                        }\n                        if (!isExternal && this.copiedInfo.isCut) {\n                            this.setCell(i, j, prevSheet, null, false, true);\n                        }\n                    }\n                    rowIdx++;\n                }\n                this.parent.setUsedRange(rfshRange[2] + 1, rfshRange[3]);\n                if (cSIdx === this.parent.activeSheetIndex) {\n                    this.parent.serviceLocator.getService('cell').refreshRange(rfshRange);\n                    this.parent.notify(selectRange, { indexes: rfshRange });\n                }\n                if (!isExternal && this.copiedInfo.isCut) {\n                    isCut = this.copiedInfo.isCut;\n                    if (copiedIdx === this.parent.activeSheetIndex) {\n                        this.parent.serviceLocator.getService('cell').refreshRange(cIdx);\n                    }\n                    this.clearCopiedInfo();\n                    this.cutInfo = isCut;\n                }\n                if ((isExternal || inRange_1) && this.copiedInfo) {\n                    this.clearCopiedInfo();\n                }\n                if (isExternal || (args && args.isAction)) {\n                    this.parent.element.focus();\n                }\n                if (args.isAction) {\n                    var sheetIndex = copyInfo && copyInfo.sId ? getSheetIndexFromId(this.parent, copyInfo.sId) :\n                        this.parent.activeSheetIndex;\n                    var eventArgs = {\n                        requestType: 'paste',\n                        copiedInfo: copyInfo,\n                        mergeCollection: mergeCollection,\n                        pasteSheetIndex: this.parent.activeSheetIndex,\n                        copiedRange: this.parent.sheets[sheetIndex].name + '!' + getRangeAddress(copyInfo && copyInfo.range ?\n                            copyInfo.range : getRangeIndexes(this.parent.sheets[sheetIndex].selectedRange)),\n                        pastedRange: getSheetName(this.parent) + '!' + getRangeAddress(rfshRange),\n                        type: pasteType || 'All'\n                    };\n                    this.parent.notify(completeAction, { eventArgs: eventArgs, action: 'clipboard' });\n                }\n                if (isCut) {\n                    this.updateFilter(copyInfo, rfshRange);\n                    setMaxHgt(prevSheet, cIdx[0], cIdx[1], 20);\n                    var hgt = getMaxHgt(prevSheet, cIdx[0]);\n                    setRowEleHeight(this.parent, prevSheet, hgt, cIdx[0]);\n                }\n            }\n        }\n        else {\n            this.getClipboardEle().select();\n        }\n    };\n    Clipboard.prototype.updateFilter = function (copyInfo, pastedRange) {\n        var isFilterCut;\n        this.parent.notify(getFilteredCollection, null);\n        for (var i = 0; i < this.parent.sheets.length; i++) {\n            if (this.parent.filterCollection && this.parent.filterCollection[i] &&\n                this.parent.filterCollection[i].sheetIdx === getSheetIndexFromId(this.parent, copyInfo.sId)) {\n                var range = copyInfo.range;\n                var fRange = getRangeIndexes(this.parent.filterCollection[i].filterRange);\n                var endCol = getColumnHeaderText(range[3]);\n                var fEndCol = getColumnHeaderText(fRange[3]);\n                if ((fRange[0] === range[0] && fRange[1] === range[1] && endCol === fEndCol) ||\n                    (fRange[0] === range[2] && fRange[1] === range[3] && endCol === fEndCol)) {\n                    isFilterCut = true;\n                }\n            }\n        }\n        var cell = this.parent.getCell(copyInfo.range[0], copyInfo.range[1]);\n        cell = cell.querySelector('.e-filter-icon') ? cell : this.parent.getCell(copyInfo.range[2], copyInfo.range[3]);\n        var asc = cell.querySelector('.e-sortasc-filter');\n        var desc = cell.querySelector('.e-sortdesc-filter');\n        if (isFilterCut) {\n            for (var n = 0; n < this.parent.filterCollection.length; n++) {\n                var filterCol = this.parent.filterCollection[n];\n                var sheetIndex = copyInfo && copyInfo.sId ? getSheetIndexFromId(this.parent, copyInfo.sId) :\n                    this.parent.activeSheetIndex;\n                if (filterCol.sheetIdx === sheetIndex) {\n                    this.parent.notify(initiateFilterUI, { predicates: null, range: filterCol.filterRange, sIdx: sheetIndex, isCut: true });\n                }\n                if (filterCol.sheetIdx === sheetIndex && sheetIndex === this.parent.activeSheetIndex) {\n                    this.parent.notify(initiateFilterUI, { predicates: null, range: null, sIdx: null, isCut: true });\n                    if (copyInfo.range[3] === copyInfo.range[1]) { // To update sorted icon after pasting.\n                        var filteredCell = this.parent.getCell(pastedRange[0], pastedRange[1]);\n                        if (asc && filteredCell) {\n                            filteredCell.querySelector('.e-filter-icon').classList.add('e-sortasc-filter');\n                        }\n                        if (desc && filteredCell) {\n                            filteredCell.querySelector('.e-filter-icon').classList.add('e-sortdesc-filter');\n                        }\n                    }\n                }\n            }\n        }\n    };\n    Clipboard.prototype.isInRange = function (cRng, pRng) {\n        return inRange(cRng, pRng[0], pRng[1]) || inRange(cRng, pRng[2], pRng[3]);\n    };\n    Clipboard.prototype.isFormula = function (selIdx) {\n        var cIdxValue;\n        var cell;\n        var sheet;\n        if (!isNullOrUndefined(this.copiedCell)) {\n            sheet = !isNullOrUndefined(this.copiedSheet) ? this.copiedSheet : this.parent.getActiveSheet();\n            cell = getCell(this.copiedCell[0], this.copiedCell[1], sheet);\n            if (!isNullOrUndefined(cell)) {\n                cIdxValue = cell.formula ? cell.formula.toUpperCase() : '';\n            }\n        }\n        if (cIdxValue !== '' && !isNullOrUndefined(cIdxValue)) {\n            if (cIdxValue.indexOf('=') === 0) {\n                cIdxValue = cIdxValue.slice(1);\n            }\n            var start = cIdxValue.indexOf('(');\n            var end = cIdxValue.indexOf(')');\n            if (start > -1 && end > -1) {\n                cIdxValue = cIdxValue.slice(start + 1, end);\n            }\n            var difIndex = [];\n            var formulaOperators = ['+', '-', '*', '/'];\n            var splitArray = void 0;\n            var value = cIdxValue;\n            for (var i = 0; i < formulaOperators.length; i++) {\n                splitArray = value.split(formulaOperators[i]);\n                value = splitArray.join(',');\n            }\n            splitArray = value.split(',');\n            for (var j = 0; j < splitArray.length; j++) {\n                if (isCellReference(splitArray[j])) {\n                    var range = getCellIndexes(splitArray[j]);\n                    var diff = [this.copiedCell[0] - range[0], this.copiedCell[1] - range[1]];\n                    difIndex.push(diff[0]);\n                    difIndex.push(diff[1]);\n                }\n            }\n            var newAddress = [];\n            for (var j = 0; j < difIndex.length; j++) {\n                var address = getCellAddress(selIdx[0] - difIndex[0 + j], selIdx[1] - difIndex[1 + j]);\n                newAddress.push(address);\n                j++;\n            }\n            for (var a = 0; a < newAddress.length; a++) {\n                if (isCellReference(newAddress[a])) {\n                    var range = getRangeIndexes(newAddress[a]);\n                    if (range[0] < 0 || range[1] < 0) {\n                        newAddress[a] = '#REF!';\n                    }\n                }\n                else {\n                    newAddress[a] = '#REF!';\n                }\n            }\n            cIdxValue = cell.formula.toUpperCase();\n            for (var i = 0; i < splitArray.length; i++) {\n                for (var j = 0; j < newAddress.length; j++) {\n                    cIdxValue = cIdxValue.replace(splitArray[i].toUpperCase(), newAddress[j].toUpperCase());\n                    i++;\n                }\n            }\n            return cIdxValue;\n        }\n        else {\n            return null;\n        }\n    };\n    Clipboard.prototype.setCell = function (rIdx, cIdx, sheet, cell, isExtend, isCut) {\n        setCell(rIdx, cIdx, sheet, isCut ? null : cell, isExtend);\n        if (cell && cell.formula) {\n            this.parent.notify(workbookFormulaOperation, {\n                action: 'refreshCalculate', value: isCut ? '' : cell.formula, rowIndex: rIdx,\n                colIndex: cIdx, sheetIndex: this.parent.activeSheetIndex, isFormula: true\n            });\n        }\n        if (cell && !cell.formula) {\n            this.parent.notify(workbookEditOperation, {\n                action: 'updateCellValue', address: [rIdx, cIdx, rIdx,\n                    cIdx], value: cell.value\n            });\n        }\n        if (cell) {\n            if (cell.style) {\n                var style = {};\n                if (cell.style.properties) {\n                    style = skipDefaultValue(cell.style, true);\n                }\n                else {\n                    style = cell.style;\n                }\n                this.parent.notify(applyCellFormat, {\n                    style: extend({}, this.parent.commonCellStyle, style), rowIdx: rIdx, colIdx: cIdx, cell: null,\n                    lastCell: null, row: null, hRow: null, isHeightCheckNeeded: true, manualUpdate: false\n                });\n            }\n            if (cell.wrap) {\n                this.parent.notify(wrapEvent, { range: [rIdx, cIdx, rIdx, cIdx], wrap: false, sheet: sheet });\n            }\n            if (cell.colSpan > 1) {\n                setCell(rIdx, cIdx + cell.colSpan - 1, sheet, isCut ? null : { colSpan: -1 }, isExtend);\n                this.externalMerge = true;\n                this.externalMergeRow = rIdx;\n                this.parent.notify(setMerge, { merge: true, range: [rIdx, cIdx, rIdx, cIdx + cell.colSpan - 1],\n                    type: 'All', isAction: true, refreshRibbon: true });\n            }\n        }\n    };\n    Clipboard.prototype.getEmptyStyle = function (cellStyle) {\n        var style = {};\n        Object.keys(cellStyle).forEach(function (key) {\n            style[key] = '';\n        });\n        return style;\n    };\n    Clipboard.prototype.getCopiedIdx = function () {\n        if (this.copiedInfo) {\n            for (var i = 0; i < this.parent.sheets.length; i++) {\n                if (this.parent.sheets[i].id === this.copiedInfo.sId) {\n                    return i;\n                }\n            }\n            this.clearCopiedInfo();\n        }\n        return -1;\n    };\n    Clipboard.prototype.setCopiedInfo = function (args, isCut) {\n        var _this = this;\n        if (this.parent.isEdit) {\n            return;\n        }\n        var deferred = new Deferred();\n        args.promise = deferred.promise;\n        var sheet = this.parent.getActiveSheet();\n        var range = (args && args.range) || getRangeIndexes(sheet.selectedRange);\n        var option = {\n            sheet: sheet, indexes: [0, 0, sheet.rowCount - 1, sheet.colCount - 1], promise: new Promise(function (resolve, reject) { resolve((function () { })()); })\n        };\n        var pictureElements = document.getElementsByClassName('e-ss-overlay-active');\n        var pictureLen = pictureElements.length;\n        if (sheet.isLocalData && !(args && args.clipboardData) && range[0] === 0 && range[2] === (sheet.rowCount - 1)) {\n            this.parent.showSpinner();\n            this.parent.notify('updateSheetFromDataSource', option);\n        }\n        option.promise.then(function () {\n            if (pictureLen > 0) {\n                var imgRowIdx = {\n                    clientY: pictureElements[0].offsetTop,\n                    isImage: true\n                };\n                _this.parent.notify(getRowIdxFromClientY, imgRowIdx);\n                var imgColIdx = {\n                    clientX: pictureElements[0].offsetLeft,\n                    isImage: true\n                };\n                _this.parent.notify(getColIdxFromClientX, imgColIdx);\n                _this.copiedShapeInfo = {\n                    sId: (args && args.sId) ? args.sId : sheet.id, sheetIdx: sheet.index, isCut: isCut, pictureElem: pictureElements[0], copiedRange: getRangeAddress([imgRowIdx.clientY, imgColIdx.clientX,\n                        imgRowIdx.clientY, imgColIdx.clientX]), height: pictureElements[0].offsetHeight,\n                    width: pictureElements[0].offsetWidth,\n                    chartInfo: _this.getChartElemInfo(pictureElements[0], isCut)\n                };\n                _this.hidePaste(true);\n                if (isCut) {\n                    if (pictureElements[0].classList.contains('e-datavisualization-chart')) {\n                        _this.parent.deleteChart(_this.copiedShapeInfo.chartInfo.id);\n                    }\n                    else {\n                        _this.parent.notify(deleteImage, {\n                            id: _this.copiedShapeInfo.pictureElem.id, sheetIdx: _this.copiedShapeInfo.sId, range: _this.copiedShapeInfo.copiedRange\n                        });\n                    }\n                }\n            }\n            else if (!(args && args.clipboardData)) {\n                if (_this.copiedInfo) {\n                    _this.clearCopiedInfo();\n                }\n                _this.copiedInfo = {\n                    range: range, sId: (args && args.sId) ? args.sId : sheet.id, isCut: isCut\n                };\n                _this.hidePaste(true);\n                _this.initCopyIndicator();\n                if (!Browser.isIE) {\n                    _this.getClipboardEle().select();\n                }\n                if (args && args.isAction) {\n                    document.execCommand(isCut ? 'cut' : 'copy');\n                }\n                _this.parent.hideSpinner();\n            }\n            if (Browser.isIE) {\n                _this.setExternalCells(args);\n            }\n            deferred.resolve();\n        });\n        if (args && args.clipboardData) {\n            this.setExternalCells(args);\n            this.parent.element.focus();\n        }\n    };\n    Clipboard.prototype.getChartElemInfo = function (overlayEle, isCut) {\n        var chartColl = this.parent.chartColl;\n        if (overlayEle.classList.contains('e-datavisualization-chart')) {\n            var chartId = overlayEle.getElementsByClassName('e-control')[0].id;\n            for (var idx = 0; idx < chartColl.length; idx++) {\n                if (chartColl[idx].id === chartId) {\n                    var chart = chartColl[idx];\n                    return chart;\n                }\n            }\n        }\n        return null;\n    };\n    Clipboard.prototype.clearCopiedInfo = function () {\n        if (this.copiedInfo) {\n            if (this.parent.getActiveSheet().id === this.copiedInfo.sId) {\n                detach(this.parent.getMainContent().getElementsByClassName('e-copy-indicator')[0]);\n            }\n            this.copiedInfo = null;\n            this.hidePaste();\n        }\n        if (this.copiedShapeInfo) {\n            this.copiedShapeInfo = null;\n            this.hidePaste();\n        }\n    };\n    Clipboard.prototype.initCopyIndicator = function () {\n        if (this.copiedInfo && this.parent.getActiveSheet().id === this.copiedInfo.sId) {\n            var copyIndicator = this.parent.createElement('div', { className: 'e-copy-indicator' });\n            copyIndicator.appendChild(this.parent.createElement('div', { className: 'e-top' }));\n            copyIndicator.appendChild(this.parent.createElement('div', { className: 'e-bottom' }));\n            copyIndicator.appendChild(this.parent.createElement('div', { className: 'e-left' }));\n            copyIndicator.appendChild(this.parent.createElement('div', { className: 'e-right' }));\n            locateElem(copyIndicator, this.copiedInfo.range, this.parent.getActiveSheet(), false);\n            this.parent.getMainContent().appendChild(copyIndicator);\n        }\n    };\n    Clipboard.prototype.showDialog = function () {\n        var _this = this;\n        this.parent.serviceLocator.getService(dialog).show({\n            header: 'Spreadsheet',\n            target: this.parent.element,\n            height: 205, width: 340, isModal: true, showCloseIcon: true,\n            content: this.parent.serviceLocator.getService(locale).getConstant('PasteAlert'),\n            beforeOpen: function (args) {\n                var dlgArgs = {\n                    dialogName: 'PasteDialog',\n                    element: args.element, target: args.target, cancel: args.cancel\n                };\n                _this.parent.trigger('dialogBeforeOpen', dlgArgs);\n                if (dlgArgs.cancel) {\n                    args.cancel = true;\n                }\n            }\n        });\n    };\n    Clipboard.prototype.hidePaste = function (isShow) {\n        if (this.parent.getActiveSheet().isProtected) {\n            isShow = false;\n        }\n        this.parent.notify(enableToolbarItems, [{ items: [this.parent.element.id + '_paste'], enable: isShow || false }]);\n    };\n    Clipboard.prototype.setExternalCells = function (args) {\n        var cell;\n        var text = '';\n        var range = this.copiedInfo.range;\n        var sheet = this.parent.getActiveSheet();\n        var data = '<html><body><table class=\"e-spreadsheet\" xmlns=\"http://www.w3.org/1999/xhtml\"><tbody>';\n        for (var i = range[0]; i <= range[2]; i++) {\n            data += '<tr>';\n            for (var j = range[1]; j <= range[3]; j++) {\n                cell = getCell(i, j, sheet);\n                data += '<td style=\"white-space:' + ((cell && cell.wrap) ? 'normal' : 'nowrap') + ';vertical-align:bottom;';\n                if (cell && cell.style) {\n                    Object.keys(cell.style).forEach(function (style) {\n                        var regex = style.match(/[A-Z]/);\n                        data += (style === 'backgroundColor' ? 'background' : (regex ? style.replace(regex[0], '-'\n                            + regex[0].toLowerCase()) : style)) + ':' + ((style === 'backgroundColor' || style === 'color')\n                            ? cell.style[style].slice(0, 7) : cell.style[style]) + ';';\n                    });\n                }\n                data += '\">';\n                if (cell && cell.value) {\n                    var eventArgs = {\n                        formattedText: cell.value,\n                        value: cell.value,\n                        format: cell.format,\n                        onLoad: true\n                    };\n                    if (cell.format) {\n                        this.parent.notify(getFormattedCellObject, eventArgs);\n                    }\n                    data += eventArgs.formattedText;\n                    text += eventArgs.formattedText;\n                }\n                data += '</td>';\n                text += j === range[3] ? '' : '\\t';\n            }\n            data += '</tr>';\n            text += i === range[2] ? '' : '\\n';\n        }\n        data += '</tbody></table></body></html>';\n        if (Browser.isIE) {\n            /* tslint:disable-next-line */\n            window['clipboardData'].setData('text', text);\n        }\n        else {\n            args.clipboardData.setData('text/html', data);\n            args.clipboardData.setData('text/plain', text);\n            args.preventDefault();\n        }\n    };\n    Clipboard.prototype.getExternalCells = function (args) {\n        var _this = this;\n        var html;\n        var text;\n        var rows = [];\n        var cells = [];\n        var cellStyle;\n        var ele = this.parent.createElement('span');\n        if (Browser.isIE) {\n            /* tslint:disable-next-line */\n            text = window['clipboardData'].getData('text');\n        }\n        else {\n            html = args.clipboardData.getData('text/html');\n            text = args.clipboardData.getData('text/plain');\n            ele.innerHTML = html;\n        }\n        if (ele.querySelector('table')) {\n            if (ele.querySelector('.e-spreadsheet')) {\n                rows = { internal: true };\n            }\n            else {\n                ele.querySelectorAll('tr').forEach(function (tr) {\n                    tr.querySelectorAll('td').forEach(function (td, j) {\n                        td.textContent = td.textContent.replace(/(\\r\\n|\\n|\\r)/gm, '');\n                        var cSpan = isNaN(parseInt(td.getAttribute('colspan'), 10)) ? 1 : parseInt(td.getAttribute('colspan'), 10);\n                        var rSpan = isNaN(parseInt(td.getAttribute('rowspan'), 10)) ? 1 : parseInt(td.getAttribute('rowspan'), 10);\n                        cellStyle = _this.getStyle(td, ele);\n                        cells[j] = { value: td.textContent, style: cellStyle, colSpan: cSpan, rowSpan: rSpan };\n                        if (cellStyle.whiteSpace) {\n                            cells[j].wrap = true;\n                        }\n                    });\n                    rows.push({ cells: cells });\n                    cells = [];\n                });\n            }\n        }\n        else if (text) {\n            if (html) {\n                [].slice.call(ele.children).forEach(function (child) {\n                    if (child.getAttribute('style')) {\n                        cellStyle = _this.getStyle(child, ele);\n                    }\n                });\n            }\n            text.trim().split('\\n').forEach(function (row) {\n                row.split('\\t').forEach(function (col, j) {\n                    cells[j] = { style: cellStyle };\n                    if (cellStyle.whiteSpace) {\n                        cells[j].wrap = true;\n                    }\n                    if (checkIsFormula(col)) {\n                        cells[j].formula = col;\n                    }\n                    else {\n                        cells[j].value = col;\n                    }\n                });\n                rows.push({ cells: cells });\n                cells = [];\n            });\n        }\n        setTimeout(function () { _this.getClipboardEle().innerHTML = ''; }, 0);\n        return rows;\n    };\n    Clipboard.prototype.getStyle = function (td, ele) {\n        var styles = [];\n        var cellStyle = {};\n        if (td.classList.length || td.getAttribute('style')) {\n            if (td.classList.length) {\n                if (ele.querySelector('style').innerHTML.indexOf(td.classList[0]) > -1) {\n                    styles.push(ele.querySelector('style').innerHTML.split(td.classList[0])[1].split('{')[1].split('}')[0]);\n                }\n            }\n            if (td.getAttribute('style')) {\n                styles.push(td.getAttribute('style'));\n            }\n            styles.forEach(function (styles) {\n                styles.split(';').forEach(function (style) {\n                    var char = style.split(':')[0].trim();\n                    if (['font-family', 'vertical-align', 'text-align', 'text-indent', 'color', 'background', 'font-weight', 'font-style',\n                        'font-size', 'text-decoration', 'border-bottom', 'border-top', 'border-right', 'border-left',\n                        'border', 'white-space'].indexOf(char) > -1) {\n                        char = char === 'background' ? 'backgroundColor' : char;\n                        var regex = char.match(/-[a-z]/);\n                        cellStyle[regex ? char.replace(regex[0], regex[0].charAt(1).toUpperCase()) : char] = style.split(':')[1];\n                    }\n                });\n            });\n        }\n        return cellStyle;\n    };\n    Clipboard.prototype.getClipboardEle = function () {\n        return this.parent.element.getElementsByClassName('e-clipboard')[0];\n    };\n    Clipboard.prototype.getModuleName = function () {\n        return 'clipboard';\n    };\n    Clipboard.prototype.destroy = function () {\n        this.removeEventListener();\n        var ele = this.getClipboardEle();\n        detach(ele);\n        this.parent = null;\n    };\n    return Clipboard;\n}());\nexport { Clipboard };\n","import { EventHandler, Browser, closest, isUndefined, isNullOrUndefined, select } from '@syncfusion/ej2-base';\nimport { getRangeIndexes, getRangeFromAddress, getIndexesFromAddress, getRangeAddress, isSingleCell } from '../../workbook/common/address';\nimport { keyDown, editOperation, clearCopy, mouseDown, selectionComplete, enableToolbarItems, completeAction } from '../common/event';\nimport { formulaBarOperation, formulaOperation, setActionData, keyUp, getCellPosition, deleteImage } from '../common/index';\nimport { workbookEditOperation, getFormattedBarText, getFormattedCellObject, wrapEvent, isValidation } from '../../workbook/common/event';\nimport { getSheetName, getSheetIndex, getCell, getColumn } from '../../workbook/base/index';\nimport { getSheetNameFromAddress, getSheet } from '../../workbook/base/index';\nimport { hasTemplate, editAlert } from '../common/index';\nimport { getSwapRange, getCellIndexes, wrap as wrapText, checkIsFormula, dataChanged, isNumber, isLocked } from '../../workbook/index';\nimport { checkConditionalFormat, initiateFormulaReference, initiateCur, clearCellRef, addressHandle } from '../common/event';\nimport { editValue, initiateEdit, forRefSelRender, isFormulaBarEdit, deleteChart } from '../common/event';\n/**\n * The `Protect-Sheet` module is used to handle the Protecting functionalities in Spreadsheet.\n */\nvar Edit = /** @class */ (function () {\n    /**\n     * Constructor for protect-sheet module in Spreadsheet.\n     * @private\n     */\n    function Edit(parent) {\n        this.editorElem = null;\n        this.editCellData = {};\n        this.isEdit = false;\n        this.isCellEdit = true;\n        this.isNewValueEdit = true;\n        this.isAltEnter = false;\n        this.validCharacters = ['+', '-', '*', '/', ',', '(', '=', '&'];\n        this.keyCodes = {\n            BACKSPACE: 8,\n            SPACE: 32,\n            TAB: 9,\n            DELETE: 46,\n            ESC: 27,\n            ENTER: 13,\n            FIRSTALPHABET: 65,\n            LASTALPHABET: 90,\n            FIRSTNUMBER: 48,\n            LASTNUMBER: 59,\n            FIRSTNUMPAD: 96,\n            LASTNUMPAD: 111,\n            SYMBOLSETONESTART: 186,\n            SYMBOLSETONEEND: 192,\n            SYMBOLSETTWOSTART: 219,\n            SYMBOLSETTWOEND: 222,\n            FIREFOXEQUALPLUS: 61,\n            FIREFOXMINUS: 173,\n            F2: 113\n        };\n        this.parent = parent;\n        this.init();\n        //Spreadsheet.Inject(WorkbookEdit);\n    }\n    Edit.prototype.init = function () {\n        this.addEventListener();\n    };\n    /**\n     * To destroy the edit module.\n     * @return {void}\n     * @hidden\n     */\n    Edit.prototype.destroy = function () {\n        this.removeEventListener();\n        this.parent = null;\n        this.editorElem = null;\n    };\n    Edit.prototype.addEventListener = function () {\n        EventHandler.add(this.parent.element, 'dblclick', this.dblClickHandler, this);\n        this.parent.on(mouseDown, this.mouseDownHandler, this);\n        this.parent.on(keyUp, this.keyUpHandler, this);\n        this.parent.on(keyDown, this.keyDownHandler, this);\n        this.parent.on(editOperation, this.performEditOperation, this);\n        this.parent.on(initiateCur, this.initiateCurPosition, this);\n        this.parent.on(editValue, this.updateFormulaBarValue, this);\n        this.parent.on(addressHandle, this.addressHandler, this);\n        this.parent.on(initiateEdit, this.initiateRefSelection, this);\n        this.parent.on(forRefSelRender, this.refSelectionRender, this);\n    };\n    Edit.prototype.removeEventListener = function () {\n        EventHandler.remove(this.parent.element, 'dblclick', this.dblClickHandler);\n        if (!this.parent.isDestroyed) {\n            this.parent.off(mouseDown, this.mouseDownHandler);\n            this.parent.off(keyUp, this.keyUpHandler);\n            this.parent.off(keyDown, this.keyDownHandler);\n            this.parent.off(editOperation, this.performEditOperation);\n            this.parent.off(initiateCur, this.initiateCurPosition);\n            this.parent.off(editValue, this.updateFormulaBarValue);\n            this.parent.off(addressHandle, this.addressHandler);\n            this.parent.off(initiateEdit, this.initiateRefSelection);\n            this.parent.off(forRefSelRender, this.refSelectionRender);\n        }\n    };\n    /**\n     * Get the module name.\n     * @returns string\n     * @private\n     */\n    Edit.prototype.getModuleName = function () {\n        return 'edit';\n    };\n    Edit.prototype.performEditOperation = function (args) {\n        var action = args.action;\n        switch (action) {\n            case 'renderEditor':\n                this.renderEditor();\n                break;\n            case 'refreshEditor':\n                this.refreshEditor(args.value, args.refreshFormulaBar, args.refreshEditorElem, args.isAppend, args.trigEvent);\n                if (args.refreshCurPos) {\n                    this.setCursorPosition();\n                }\n                break;\n            case 'startEdit':\n                if (!this.isEdit) {\n                    this.isNewValueEdit = args.isNewValueEdit;\n                    this.startEdit(args.address, args.value, args.refreshCurPos);\n                }\n                else {\n                    var isEdit = false;\n                    var arg = { isEdit: isEdit };\n                    this.parent.notify(isFormulaBarEdit, arg);\n                    if (arg.isEdit) {\n                        this.isNewValueEdit = args.isNewValueEdit;\n                        this.startEdit(args.address, args.value, args.refreshCurPos);\n                    }\n                }\n                break;\n            case 'endEdit':\n                if (this.isEdit) {\n                    this.endEdit(args.refreshFormulaBar);\n                }\n                break;\n            case 'cancelEdit':\n                if (this.isEdit) {\n                    this.cancelEdit(args.refreshFormulaBar);\n                }\n                break;\n            case 'getCurrentEditValue':\n                args.editedValue = this.editCellData.value;\n                break;\n            case 'refreshDependentCellValue':\n                this.refreshDependentCellValue(args.rowIdx, args.colIdx, args.sheetIdx);\n                break;\n            case 'getPosition':\n                args.position = this.editorElem.getBoundingClientRect();\n                break;\n            case 'focusEditorElem':\n                this.editorElem.focus();\n                break;\n            case 'getCurrentEditSheetIdx':\n                args.sheetIndex = this.editCellData.sheetIndex;\n                break;\n        }\n    };\n    Edit.prototype.keyUpHandler = function (e) {\n        if (this.isEdit) {\n            if (e.altKey && e.keyCode === 13) {\n                var editElement = this.parent.element.querySelector('.e-spreadsheet-edit');\n                editElement.focus();\n                this.altEnter();\n                this.isAltEnter = true;\n            }\n            else if (this.isCellEdit && this.editCellData.value !== this.editorElem.textContent && e.keyCode !== 16) {\n                this.refreshEditor(this.editorElem.textContent, this.isCellEdit);\n            }\n            var isFormulaEdit = checkIsFormula(this.editCellData.value) ||\n                (this.editCellData.value && this.editCellData.value.toString().indexOf('=') === 0);\n            if (isFormulaEdit && e.keyCode !== 16) {\n                var formulaRefIndicator = this.parent.element.querySelector('.e-formularef-indicator');\n                if (formulaRefIndicator) {\n                    formulaRefIndicator.parentElement.removeChild(formulaRefIndicator);\n                }\n                if (this.editCellData.value !== this.editorElem.textContent) {\n                    this.refreshEditor(this.editorElem.textContent, true);\n                }\n                var sheetIdx = this.editCellData.sheetIndex;\n                var editValue_1 = this.editCellData.value;\n                this.parent.notify(initiateFormulaReference, { range: editValue_1, formulaSheetIdx: sheetIdx });\n            }\n        }\n    };\n    Edit.prototype.keyDownHandler = function (e) {\n        var trgtElem = e.target;\n        var keyCode = e.keyCode;\n        var sheet = this.parent.getActiveSheet();\n        var actCell = getCellIndexes(sheet.activeCell);\n        var cell = getCell(actCell[0], actCell[1], sheet) || {};\n        if (!closest(e.target, '.e-findtool-dlg') && !closest(e.target, '.e-validationerror-dlg')) {\n            if (!sheet.isProtected || closest(e.target, '.e-sheet-rename') || !isLocked(cell, getColumn(sheet, actCell[1]))) {\n                if (this.isEdit) {\n                    var isFormulaEdit = checkIsFormula(this.editCellData.value) ||\n                        (this.editCellData.value && this.editCellData.value.toString().indexOf('=') === 0);\n                    if (this.isCellEdit || (isFormulaEdit && this.editCellData.value !== this.editorElem.textContent && e.keyCode !== 16)) {\n                        this.refreshEditor(this.editorElem.textContent, this.isCellEdit);\n                    }\n                    if (!e.altKey) {\n                        switch (keyCode) {\n                            case this.keyCodes.ENTER:\n                                if (Browser.isWindows) {\n                                    e.preventDefault();\n                                }\n                                if (this.isAltEnter) {\n                                    var text = this.parent.element.querySelector('.e-spreadsheet-edit').textContent;\n                                    if (text && text.indexOf('\\n') > -1) {\n                                        wrapText(this.parent.getActiveSheet().selectedRange, true, this.parent);\n                                        this.refreshEditor(this.editorElem.textContent, this.isCellEdit);\n                                        this.isAltEnter = false;\n                                    }\n                                }\n                                if (!isFormulaEdit) {\n                                    this.endEdit(false, e);\n                                }\n                                else {\n                                    var formulaRefIndicator = this.parent.element.querySelector('.e-formularef-indicator');\n                                    if (formulaRefIndicator) {\n                                        formulaRefIndicator.parentElement.removeChild(formulaRefIndicator);\n                                    }\n                                    if (this.editCellData.sheetIndex === sheet.id - 1) {\n                                        this.endEdit(false, e);\n                                    }\n                                    else {\n                                        this.parent.goTo(this.editCellData.fullAddr);\n                                        this.endEdit(false, e);\n                                    }\n                                }\n                                break;\n                            case this.keyCodes.TAB:\n                                if (!this.hasFormulaSuggSelected()) {\n                                    this.endEdit(false, e);\n                                }\n                                break;\n                            case this.keyCodes.ESC:\n                                this.cancelEdit(true, true, e);\n                                break;\n                        }\n                    }\n                }\n                else {\n                    if (!this.isEdit && (trgtElem.classList.contains('e-spreadsheet') || closest(trgtElem, '.e-sheet-panel'))) {\n                        var isAlphabet = (keyCode >= this.keyCodes.FIRSTALPHABET && keyCode <= this.keyCodes.LASTALPHABET);\n                        var isNumeric = (keyCode >= this.keyCodes.FIRSTNUMBER && keyCode <= this.keyCodes.LASTNUMBER);\n                        var isNumpadKeys = (keyCode >= this.keyCodes.FIRSTNUMPAD && keyCode <= this.keyCodes.LASTNUMPAD);\n                        var isSymbolkeys = (keyCode >= this.keyCodes.SYMBOLSETONESTART &&\n                            keyCode <= this.keyCodes.SYMBOLSETONEEND);\n                        if (!isSymbolkeys) {\n                            isSymbolkeys = (keyCode >= this.keyCodes.SYMBOLSETTWOSTART && keyCode <= this.keyCodes.SYMBOLSETTWOEND);\n                        }\n                        var isFirefoxExceptionkeys = (keyCode === this.keyCodes.FIREFOXEQUALPLUS) ||\n                            (keyCode === this.keyCodes.FIREFOXMINUS);\n                        var isF2Edit = (!e.shiftKey && !e.ctrlKey && !e.metaKey && keyCode === this.keyCodes.F2);\n                        var isBackSpace = keyCode === this.keyCodes.BACKSPACE;\n                        if ((!e.ctrlKey && !e.metaKey && !e.altKey && ((!e.shiftKey && keyCode === this.keyCodes.SPACE) || isAlphabet || isNumeric ||\n                            isNumpadKeys || isSymbolkeys || (Browser.info.name === 'mozilla' && isFirefoxExceptionkeys))) || isF2Edit || isBackSpace) {\n                            if (isF2Edit) {\n                                this.isNewValueEdit = false;\n                            }\n                            var pictureElements = document.getElementsByClassName('e-ss-overlay-active');\n                            var pictureLen = pictureElements.length;\n                            if (pictureLen > 0) {\n                                this.parent.notify(deleteImage, {\n                                    id: pictureElements[0].id, sheetIdx: this.parent.activeSheetIndex + 1\n                                });\n                            }\n                            else {\n                                this.startEdit(null, null, true, true);\n                            }\n                        }\n                        if (keyCode === this.keyCodes.DELETE) {\n                            this.isLockCellDelete(e);\n                            this.editingHandler('delete');\n                        }\n                    }\n                }\n            }\n            else {\n                if (((keyCode >= this.keyCodes.FIRSTALPHABET && keyCode <= this.keyCodes.LASTALPHABET) ||\n                    (keyCode >= this.keyCodes.FIRSTNUMBER && keyCode <= this.keyCodes.LASTNUMBER)\n                    || (keyCode === this.keyCodes.DELETE) || (keyCode === this.keyCodes.BACKSPACE) || (keyCode === this.keyCodes.SPACE)\n                    || (keyCode >= this.keyCodes.FIRSTNUMPAD && keyCode <= this.keyCodes.LASTNUMPAD) ||\n                    (keyCode >= this.keyCodes.SYMBOLSETONESTART && keyCode <= this.keyCodes.SYMBOLSETONEEND)\n                    || (keyCode >= 219 && keyCode <= 222) || (!e.shiftKey && !e.ctrlKey && !e.metaKey && keyCode === this.keyCodes.F2))\n                    && (keyCode !== 67) && (keyCode !== 89) && (keyCode !== 90)) {\n                    if (sheet.protectSettings.insertLink && keyCode === 75) {\n                        return;\n                    }\n                    if (!this.parent.element.querySelector('.e-editAlert-dlg')) {\n                        this.parent.notify(editAlert, null);\n                    }\n                }\n            }\n        }\n    };\n    Edit.prototype.isLockCellDelete = function (e) {\n        var sheet = this.parent.getActiveSheet();\n        var count = 0;\n        var address = getRangeIndexes(sheet.selectedRange);\n        for (var row = address[2]; row <= address[0]; row++) {\n            for (var col = address[3]; col <= address[1]; col++) {\n                var cell = getCell(row, col, sheet);\n                if (isLocked(cell, getColumn(sheet, col))) {\n                    e.preventDefault();\n                    count++;\n                }\n            }\n        }\n        if (count > 0) {\n            return;\n        }\n    };\n    Edit.prototype.renderEditor = function () {\n        if (!this.editorElem || !select('#' + this.parent.element.id + '_edit', this.parent.element)) {\n            var editor = void 0;\n            editor = this.parent.createElement('div', { id: this.parent.element.id + '_edit', className: 'e-spreadsheet-edit' });\n            editor.contentEditable = 'true';\n            editor.spellcheck = false;\n            this.editorElem = editor;\n            if (this.parent.element.getElementsByClassName('e-spreadsheet-edit')[0]) {\n                this.parent.element.getElementsByClassName('e-spreadsheet-edit')[0].remove();\n            }\n            this.parent.element.querySelector('.e-sheet-content').appendChild(this.editorElem);\n        }\n        this.parent.notify(formulaOperation, { action: 'renderAutoComplete' });\n    };\n    Edit.prototype.refreshEditor = function (value, refreshFormulaBar, refreshEditorElem, isAppend, trigEvent) {\n        if (trigEvent === void 0) { trigEvent = true; }\n        if (isAppend) {\n            value = this.editCellData.value = this.editCellData.value + value;\n        }\n        else {\n            this.editCellData.value = value;\n        }\n        if (refreshEditorElem) {\n            this.editorElem.textContent = value;\n        }\n        if (refreshFormulaBar) {\n            this.parent.notify(formulaBarOperation, { action: 'refreshFormulabar', value: value });\n        }\n        if (trigEvent && this.editCellData.value === this.editorElem.textContent) {\n            if (this.triggerEvent('cellEditing')) {\n                this.cancelEdit();\n            }\n        }\n        // if (this.editorElem.scrollHeight + 2 <= this.editCellData.element.offsetHeight) {\n        //     this.editorElem.style.height = (this.editCellData.element.offsetHeight + 1) + 'px';\n        // } else {\n        //     this.editorElem.style.removeProperty('height');\n        // }\n    };\n    Edit.prototype.startEdit = function (address, value, refreshCurPos, preventFormulaReference) {\n        if (refreshCurPos === void 0) { refreshCurPos = true; }\n        if (this.parent.showSheetTabs) {\n            this.parent.element.querySelector('.e-add-sheet-tab').setAttribute('disabled', 'true');\n        }\n        var sheet = this.parent.getActiveSheet();\n        var actCell = getCellIndexes(sheet.activeCell);\n        var cell = getCell(actCell[0], actCell[1], sheet) || {};\n        var range = getRangeIndexes(sheet.activeCell);\n        if (hasTemplate(this.parent, range[0], range[1], this.parent.activeSheetIndex)) {\n            var cellEle = this.parent.getCell(range[0], range[1]);\n            var isDelTemplate = false;\n            var value_1 = cellEle.innerHTML;\n            if (cellEle) {\n                if (value_1.indexOf('<') > -1 && value_1.indexOf('>') > -1 && value_1.indexOf('input') > -1) {\n                    isDelTemplate = true;\n                }\n            }\n            if (isDelTemplate) {\n                return;\n            }\n        }\n        this.updateEditCellDetail(address, value);\n        this.initiateEditor(refreshCurPos);\n        this.positionEditor();\n        this.parent.isEdit = this.isEdit = true;\n        this.parent.notify(clearCopy, null);\n        this.parent.notify(enableToolbarItems, [{ enable: false }]);\n        if (cell.formula && !preventFormulaReference) {\n            this.parent.notify(initiateFormulaReference, { range: cell.formula, formulaSheetIdx: this.editCellData.sheetIndex });\n        }\n    };\n    Edit.prototype.setCursorPosition = function () {\n        var elem = this.editorElem;\n        var textLen = elem.textContent.length;\n        if (textLen) {\n            var selection = document.getSelection();\n            var range = document.createRange();\n            range.setStart(elem.firstChild, textLen);\n            range.collapse(true);\n            selection.removeAllRanges();\n            selection.addRange(range);\n        }\n        elem.focus();\n    };\n    Edit.prototype.hasFormulaSuggSelected = function () {\n        var suggDdlElem = document.getElementById(this.parent.element.id + '_ac_popup');\n        return suggDdlElem && suggDdlElem.style.visibility === 'visible' &&\n            suggDdlElem.querySelectorAll('.e-item-focus').length > 0;\n    };\n    Edit.prototype.editingHandler = function (action) {\n        var pictureElements = document.getElementsByClassName('e-ss-overlay-active');\n        var pictureLen = pictureElements.length;\n        switch (action) {\n            case 'delete':\n                if (pictureLen > 0) {\n                    if (pictureElements[0].classList.contains('e-datavisualization-chart')) {\n                        this.parent.notify(deleteChart, {\n                            id: pictureElements[0].id, sheetIdx: this.parent.activeSheetIndex + 1\n                        });\n                    }\n                    else {\n                        this.parent.notify(deleteImage, {\n                            id: pictureElements[0].id, sheetIdx: this.parent.activeSheetIndex + 1\n                        });\n                    }\n                }\n                else {\n                    var address = this.parent.getActiveSheet().selectedRange;\n                    var range = getIndexesFromAddress(address);\n                    range = range[0] > range[2] ? getSwapRange(range) : range;\n                    address = getRangeAddress(range);\n                    this.parent.clearRange(address, null, true);\n                    this.parent.serviceLocator.getService('cell').refreshRange(range);\n                    this.parent.notify(selectionComplete, {});\n                    this.parent.notify(dataChanged, { address: address, sheetIdx: this.parent.activeSheetIndex, action: 'delete' });\n                }\n                break;\n        }\n    };\n    Edit.prototype.mouseDownHandler = function (e) {\n        if (!closest(e.target, '.e-findtool-dlg')) {\n            if (this.isEdit) {\n                var trgtElem = e.target;\n                var sheet = this.parent.getActiveSheet();\n                var formulaRefIndicator = this.parent.element.querySelector('.e-formularef-indicator');\n                this.isCellEdit = trgtElem.classList.contains('e-spreadsheet-edit');\n                var isFormula = checkIsFormula(this.editCellData.value) ||\n                    (this.editCellData.value && this.editCellData.value.toString().indexOf('=') === 0);\n                if (trgtElem.classList.contains('e-cell') || trgtElem.classList.contains('e-header-cell') ||\n                    trgtElem.classList.contains('e-selectall') || closest(trgtElem, '.e-toolbar-item.e-active')) {\n                    if (this.isAltEnter) {\n                        var editText = this.parent.element.querySelector('.e-spreadsheet-edit').textContent;\n                        if (editText && editText.indexOf('\\n') > -1) {\n                            this.isAltEnter = false;\n                            wrapText(this.parent.getActiveSheet().selectedRange, true, this.parent);\n                            this.refreshEditor(this.editorElem.textContent, this.isCellEdit);\n                        }\n                    }\n                    if (!isFormula) {\n                        this.endEdit(false, e);\n                    }\n                    else {\n                        var curPos = window.getSelection().focusOffset;\n                        var actCellIdx = getCellIndexes(sheet.activeCell);\n                        var cell = getCell(actCellIdx[0], actCellIdx[1], sheet);\n                        if (this.editCellData.value === this.editorElem.textContent && (this.editorElem.textContent.indexOf('(') !==\n                            this.editorElem.textContent.length - 1 && this.editorElem.textContent.indexOf('(') !== -1)) {\n                            if (this.editCellData.sheetIndex !== sheet.id - 1) {\n                                var elem = this.parent.element.querySelector('.e-formula-bar');\n                                if (this.editorElem.textContent.substring(elem.selectionEnd - 1, elem.selectionEnd) !== ',' &&\n                                    !e.shiftKey) {\n                                    if (formulaRefIndicator) {\n                                        formulaRefIndicator.parentElement.removeChild(formulaRefIndicator);\n                                    }\n                                    this.parent.goTo(this.editCellData.fullAddr);\n                                    this.endEdit(false, e);\n                                    return;\n                                }\n                            }\n                            else {\n                                if (this.validCharacters.indexOf(this.editorElem.textContent.substring(curPos - 1, curPos)) === -1) {\n                                    if (formulaRefIndicator) {\n                                        formulaRefIndicator.parentElement.removeChild(formulaRefIndicator);\n                                    }\n                                    this.endEdit(false, e);\n                                    return;\n                                }\n                            }\n                        }\n                        if (!cell) {\n                            return;\n                        }\n                        isFormula = cell.formula ?\n                            checkIsFormula(getCell(actCellIdx[0], actCellIdx[1], sheet).formula) ||\n                                (this.editCellData.value && this.editCellData.value.toString().indexOf('=') === 0) : false;\n                        if (isFormula) {\n                            var curPos_1 = window.getSelection().focusOffset;\n                            if (this.editCellData.value.length === curPos_1) {\n                                if (this.editCellData.value.substring(this.editCellData.value.length - 1) === ')' ||\n                                    isNumber(this.editCellData.value.substring(this.editCellData.value.length - 1))) {\n                                    if (formulaRefIndicator) {\n                                        formulaRefIndicator.parentElement.removeChild(formulaRefIndicator);\n                                    }\n                                    this.endEdit(false, e);\n                                }\n                            }\n                            else if (this.editCellData.value === this.editorElem.textContent) {\n                                if ((this.editCellData.value + sheet.selectedRange).substring(curPos_1 - 1, curPos_1) !== ',') {\n                                    if (formulaRefIndicator) {\n                                        formulaRefIndicator.parentElement.removeChild(formulaRefIndicator);\n                                    }\n                                    this.endEdit(false, e);\n                                }\n                                else if (this.editCellData.value.substring(curPos_1) !== ')') {\n                                    if (formulaRefIndicator) {\n                                        formulaRefIndicator.parentElement.removeChild(formulaRefIndicator);\n                                    }\n                                    this.endEdit(false, e);\n                                }\n                            }\n                        }\n                    }\n                }\n                else {\n                    if (isFormula && this.editCellData.value === this.editorElem.textContent && this.editorElem.textContent.indexOf('(') !==\n                        this.editorElem.textContent.length - 1) {\n                        if (this.editCellData.sheetIndex === sheet.id - 1) {\n                            var curPos = window.getSelection().focusOffset;\n                            if (this.validCharacters.indexOf(this.editorElem.textContent.substring(curPos - 1, curPos)) === -1) {\n                                if (formulaRefIndicator) {\n                                    formulaRefIndicator.parentElement.removeChild(formulaRefIndicator);\n                                }\n                                this.parent.goTo(this.editCellData.fullAddr);\n                                this.endEdit(false, e);\n                                return;\n                            }\n                        }\n                    }\n                }\n            }\n        }\n    };\n    Edit.prototype.dblClickHandler = function (e) {\n        var trgtElem = e.target;\n        var sheet = this.parent.getActiveSheet();\n        var actCell = getCellIndexes(sheet.activeCell);\n        var cell = getCell(actCell[0], actCell[1], sheet) || {};\n        if (closest(trgtElem, '.e-datavisualization-chart')) {\n            return;\n        }\n        if (!sheet.isProtected || !isLocked(cell, getColumn(sheet, actCell[1]))) {\n            if ((trgtElem.className.indexOf('e-ss-overlay') < 0) &&\n                (trgtElem.classList.contains('e-active-cell') || trgtElem.classList.contains('e-cell')\n                    || closest(trgtElem, '.e-sheet-content'))) {\n                if (this.isEdit) {\n                    if (checkIsFormula(this.editCellData.value)) {\n                        var sheetName = this.editCellData.fullAddr.substring(0, this.editCellData.fullAddr.indexOf('!'));\n                        if (this.parent.getActiveSheet().name === sheetName) {\n                            this.endEdit();\n                        }\n                    }\n                    else {\n                        this.endEdit();\n                    }\n                }\n                else {\n                    this.isNewValueEdit = false;\n                    this.startEdit();\n                }\n            }\n        }\n        else {\n            if (trgtElem.classList.contains('e-active-cell') || trgtElem.classList.contains('e-cell')) {\n                this.parent.notify(editAlert, null);\n            }\n        }\n    };\n    Edit.prototype.updateEditCellDetail = function (addr, value) {\n        var sheetIdx;\n        var sheet;\n        if (!this.editCellData.sheetIndex) {\n            if (addr && addr.split('!').length > 1) {\n                sheetIdx = getSheetIndex(this.parent, getSheetNameFromAddress(addr));\n            }\n            else {\n                sheetIdx = this.parent.activeSheetIndex;\n            }\n        }\n        if (!this.editCellData.addr) {\n            sheet = getSheet(this.parent, sheetIdx);\n            if (addr) {\n                addr = getRangeFromAddress(addr);\n            }\n            else {\n                addr = sheet.activeCell;\n            }\n        }\n        else if (checkIsFormula(this.editCellData.value)) {\n            sheet = getSheet(this.parent, sheetIdx);\n            this.isNewValueEdit = false;\n        }\n        if (addr) {\n            var range = getRangeIndexes(addr);\n            var rowIdx = range[0];\n            var colIdx = range[1];\n            var cellElem = this.parent.getCell(rowIdx, colIdx);\n            var cellPosition = getCellPosition(sheet, range);\n            this.editCellData = {\n                addr: addr,\n                fullAddr: getSheetName(this.parent, sheetIdx) + '!' + addr,\n                rowIndex: rowIdx,\n                colIndex: colIdx,\n                sheetIndex: sheetIdx,\n                element: cellElem,\n                value: value || '',\n                position: cellPosition\n            };\n        }\n    };\n    Edit.prototype.initiateEditor = function (refreshCurPos) {\n        var _this = this;\n        var data = this.parent.getData(this.editCellData.fullAddr);\n        data.then(function (values) {\n            values.forEach(function (cell, key) {\n                var args = { cell: cell, value: cell ? cell.value : '' };\n                _this.parent.notify(getFormattedBarText, args);\n                var value = cell ? args.value : '';\n                if (cell && cell.formula) {\n                    value = cell.formula;\n                }\n                _this.editCellData.oldValue = value;\n                if (_this.editCellData.value) {\n                    value = _this.editCellData.value;\n                }\n                else {\n                    _this.editCellData.value = value;\n                }\n                if (_this.isNewValueEdit) {\n                    value = '';\n                }\n                else {\n                    _this.isNewValueEdit = true;\n                }\n                if (!isUndefined(value)) {\n                    _this.refreshEditor(value, false, true, false, false);\n                }\n                if (refreshCurPos) {\n                    _this.setCursorPosition();\n                }\n                if (_this.triggerEvent('cellEdit')) {\n                    _this.cancelEdit(true, false);\n                }\n            });\n        });\n    };\n    Edit.prototype.positionEditor = function (isWrap) {\n        var tdElem = this.editCellData.element;\n        var isEdit = false;\n        var cellEle;\n        var arg = { isEdit: isEdit };\n        this.parent.notify(isFormulaBarEdit, arg);\n        if (arg.isEdit && isNullOrUndefined(tdElem)) {\n            cellEle = this.parent.getCell(this.editCellData.rowIndex, this.editCellData.colIndex);\n            tdElem = cellEle;\n            this.editCellData.element = cellEle;\n        }\n        if (tdElem) {\n            tdElem.classList.add('e-ss-edited');\n            var cell = getCell(this.editCellData.rowIndex, this.editCellData.colIndex, this.parent.getActiveSheet());\n            var left = this.editCellData.position.left + 1;\n            var top_1 = this.editCellData.position.top + 1;\n            var minHeight = this.parent.getCell(this.editCellData.rowIndex, this.editCellData.colIndex).offsetHeight - 3;\n            var minWidth = this.editCellData.element.offsetWidth - 3;\n            var mainContElement = this.parent.getMainContent();\n            var editWidth = mainContElement.offsetWidth - left - 28;\n            var height = ((cell && cell.wrap) || (tdElem && isWrap)) ? 'height:auto' : (minHeight) + 'px;';\n            // let editHeight: number = mainContElement.offsetHeight - top - 28;\n            var inlineStyles = 'display:block;top:' + top_1 + 'px;' + (this.parent.enableRtl ? 'right:' : 'left:') + left + 'px;' +\n                'min-width:' + minWidth + 'px;max-width:' + editWidth + 'px;' + 'height:' + height +\n                ((cell && cell.wrap) ? ('width:' + minWidth + 'px;') : '') + 'min-height:' + minHeight + 'px;';\n            inlineStyles += tdElem.style.cssText;\n            this.editorElem.setAttribute('style', inlineStyles);\n            this.parent.element.querySelector('.e-active-cell').style.height =\n                (this.editCellData.element.offsetHeight + 1) + 'px'; // we using edit div height as auto , while editing div enlarges and \n            // hide active cell bottom border for that we increasing 1px height to active cell.\n            if (tdElem.classList.contains('e-right-align')) {\n                this.editorElem.classList.add('e-right-align');\n            }\n            else if (tdElem.classList.contains('e-center-align')) {\n                this.editorElem.classList.add('e-center-align');\n            }\n        }\n    };\n    Edit.prototype.updateEditedValue = function (tdRefresh) {\n        if (tdRefresh === void 0) { tdRefresh = true; }\n        var oldCellValue = this.editCellData.oldValue;\n        var oldValue = oldCellValue ? oldCellValue.toString().toUpperCase() : '';\n        var isValidate = true;\n        var address = this.editCellData.addr;\n        var cellIndex = getRangeIndexes(this.parent.getActiveSheet().activeCell);\n        var sheet = this.parent.getActiveSheet();\n        var cell = getCell(cellIndex[0], cellIndex[1], sheet);\n        /* To set the before cell details for undo redo. */\n        this.parent.notify(setActionData, { args: { action: 'beforeCellSave', eventArgs: { address: this.editCellData.addr } } });\n        if (this.parent.allowDataValidation && cell && cell.validation) {\n            var value = this.parent.element.getElementsByClassName('e-spreadsheet-edit')[0].innerText;\n            var isCell = true;\n            var sheetIdx = this.parent.activeSheetIndex;\n            var range = void 0;\n            if (typeof address === 'string') {\n                range = getRangeIndexes(address);\n            }\n            else {\n                range = address;\n            }\n            this.parent.notify(isValidation, { value: value, range: range, sheetIdx: sheetIdx, isCell: isCell });\n            isValidate = this.parent.allowDataValidation;\n            this.editCellData.value = isValidate ? value : this.editCellData.value;\n            this.parent.allowDataValidation = true;\n        }\n        if ((oldCellValue !== this.editCellData.value || oldValue.indexOf('=RAND()') > -1 || oldValue.indexOf('RAND()') > -1 ||\n            oldValue.indexOf('=RANDBETWEEN(') > -1 || oldValue.indexOf('RANDBETWEEN(') > -1) && isValidate) {\n            var sheet_1 = this.parent.getActiveSheet();\n            var cellIndex_1 = getRangeIndexes(sheet_1.activeCell);\n            this.parent.notify(workbookEditOperation, { action: 'updateCellValue', address: this.editCellData.addr, value: this.editCellData.value });\n            var cell_1 = getCell(cellIndex_1[0], cellIndex_1[1], sheet_1, true);\n            var eventArgs = this.getRefreshNodeArgs(cell_1);\n            this.editCellData.value = eventArgs.value;\n            if (cell_1 && cell_1.formula) {\n                this.editCellData.formula = cell_1.formula;\n            }\n            if (cell_1.wrap) {\n                this.parent.notify(wrapEvent, { range: cellIndex_1, wrap: true, sheet: sheet_1 });\n            }\n            if (tdRefresh) {\n                this.parent.refreshNode(this.editCellData.element, eventArgs);\n            }\n        }\n        if (this.parent.allowConditionalFormat) {\n            this.parent.notify(checkConditionalFormat, { rowIdx: cellIndex[0], colIdx: cellIndex[1], cell: cell });\n        }\n        return isValidate;\n    };\n    Edit.prototype.refreshDependentCellValue = function (rowIdx, colIdx, sheetIdx) {\n        if (rowIdx && colIdx) {\n            rowIdx--;\n            colIdx--;\n            if ((this.editCellData.rowIndex !== rowIdx || this.editCellData.colIndex !== colIdx)\n                && this.parent.activeSheetIndex === sheetIdx) {\n                var td = this.parent.getCell(rowIdx, colIdx);\n                if (td) {\n                    var sheet = getSheet(this.parent, sheetIdx);\n                    var cell = getCell(rowIdx, colIdx, sheet);\n                    var eventArgs = this.getRefreshNodeArgs(cell);\n                    this.parent.refreshNode(td, eventArgs);\n                }\n            }\n        }\n    };\n    Edit.prototype.getRefreshNodeArgs = function (cell) {\n        cell = cell ? cell : {};\n        var fCode = (cell && cell.format) ? cell.format : '';\n        var eventArgs = {\n            value: cell.value, format: fCode, onLoad: true,\n            formattedText: '', isRightAlign: false, type: 'General'\n        };\n        var args;\n        this.parent.notify(getFormattedCellObject, eventArgs);\n        eventArgs.formattedText = this.parent.allowNumberFormatting ? eventArgs.formattedText : eventArgs.value;\n        args = {\n            isRightAlign: eventArgs.isRightAlign,\n            result: eventArgs.formattedText,\n            type: eventArgs.type,\n            value: eventArgs.value,\n            curSymbol: eventArgs.curSymbol\n        };\n        return args;\n    };\n    Edit.prototype.endEdit = function (refreshFormulaBar, event) {\n        if (refreshFormulaBar === void 0) { refreshFormulaBar = false; }\n        var sheet = this.parent.getActiveSheet();\n        var actCell = getCellIndexes(sheet.activeCell);\n        var cell = this.parent.getCell(actCell[0], actCell[1]);\n        var fSize = '';\n        if (this.editCellData.element.children[0] && this.editCellData.element.children[0].className === 'e-cf-databar') {\n            fSize = cell.children[0].querySelector('.e-databar-value').style.fontSize;\n        }\n        if (refreshFormulaBar) {\n            this.refreshEditor(this.editCellData.oldValue, false, true, false, false);\n        }\n        if (this.triggerEvent('beforeCellSave')) {\n            event.preventDefault();\n            return;\n        }\n        var isValidate = this.updateEditedValue();\n        if (isValidate) {\n            this.triggerEvent('cellSave', event);\n            this.resetEditState();\n            this.focusElement();\n        }\n        else if (event) {\n            event.preventDefault();\n        }\n        if (fSize !== '') {\n            cell.children[0].querySelector('.e-databar-value').style.fontSize = fSize;\n        }\n        if (this.parent.showSheetTabs) {\n            this.parent.element.querySelector('.e-add-sheet-tab').removeAttribute('disabled');\n        }\n    };\n    Edit.prototype.cancelEdit = function (refreshFormulaBar, trigEvent, event) {\n        if (refreshFormulaBar === void 0) { refreshFormulaBar = true; }\n        if (trigEvent === void 0) { trigEvent = true; }\n        this.refreshEditor(this.editCellData.oldValue, refreshFormulaBar, false, false, false);\n        if (trigEvent) {\n            this.triggerEvent('cellSave', event);\n        }\n        this.resetEditState();\n        this.focusElement();\n    };\n    Edit.prototype.focusElement = function () {\n        this.parent.element.focus();\n        this.parent.notify(enableToolbarItems, [{ enable: true }]);\n    };\n    Edit.prototype.triggerEvent = function (eventName, event) {\n        var cell = getCell(this.editCellData.rowIndex, this.editCellData.colIndex, this.parent.getActiveSheet());\n        var eventArgs = {\n            element: this.editCellData.element,\n            value: this.editCellData.value,\n            oldValue: this.editCellData.oldValue,\n            address: this.editCellData.fullAddr,\n            displayText: this.parent.getDisplayText(cell)\n        };\n        if (eventName === 'cellSave') {\n            if (this.editCellData.formula) {\n                eventArgs.formula = this.editCellData.formula;\n            }\n            eventArgs.originalEvent = event;\n            this.parent.notify(dataChanged, eventArgs);\n            this.parent.notify(completeAction, { eventArgs: eventArgs, action: 'cellSave' });\n        }\n        if (eventName !== 'cellSave') {\n            eventArgs.cancel = false;\n        }\n        this.parent.trigger(eventName, eventArgs);\n        return eventArgs.cancel;\n    };\n    Edit.prototype.altEnter = function () {\n        this.positionEditor(true);\n        var text;\n        var textBefore;\n        var textAfter;\n        var selection = window.getSelection();\n        var node = selection.anchorNode;\n        var offset;\n        var range = document.createRange();\n        offset = (node.nodeType === 3) ? selection.anchorOffset : node.textContent.length;\n        if (offset === 0 && node.textContent.length > 0) {\n            offset = node.textContent.length;\n        }\n        text = node.textContent;\n        textBefore = text.slice(0, offset);\n        textAfter = text.slice(offset) || ' ';\n        node.textContent = textBefore + '\\n' + textAfter;\n        range = document.createRange();\n        if (node.nodeType === 3) {\n            range.setStart(node, offset + 1);\n            range.setEnd(node, offset + 1);\n        }\n        else if (node.nodeType === 1) {\n            range.setStart(node.firstChild, offset + 1);\n            range.setEnd(node.firstChild, offset + 1);\n        }\n        selection.removeAllRanges();\n        selection.addRange(range);\n    };\n    Edit.prototype.resetEditState = function (elemRefresh) {\n        if (elemRefresh === void 0) { elemRefresh = true; }\n        if (elemRefresh) {\n            if (checkIsFormula(this.editorElem.textContent)) {\n                this.parent.notify(clearCellRef, null);\n            }\n            if (this.editCellData.element) {\n                this.editCellData.element.classList.remove('e-ss-edited');\n                this.editorElem.textContent = '';\n                this.editorElem.removeAttribute('style');\n                this.editorElem.classList.remove('e-right-align');\n            }\n        }\n        this.editCellData = {};\n        this.parent.isEdit = this.isEdit = false;\n        this.isCellEdit = true;\n        this.parent.notify(formulaOperation, { action: 'endEdit' });\n    };\n    Edit.prototype.refSelectionRender = function () {\n        if (this.editorElem) {\n            if (checkIsFormula(this.editorElem.textContent)) {\n                this.parent.notify(initiateFormulaReference, {\n                    range: this.editorElem.textContent, formulaSheetIdx: this.editCellData.sheetIndex\n                });\n            }\n        }\n    };\n    // Start edit the formula cell and set cursor position\n    Edit.prototype.initiateRefSelection = function () {\n        var sheetName = this.editCellData.fullAddr.substring(0, this.editCellData.fullAddr.indexOf('!'));\n        var value = this.parent.element.querySelector('.e-formula-bar').value;\n        if (this.parent.getActiveSheet().name === sheetName && checkIsFormula(this.editCellData.value)) {\n            this.startEdit(this.editCellData.addr, value, false);\n            this.parent.notify(initiateFormulaReference, {\n                range: this.editCellData.value, formulaSheetIdx: this.editCellData.sheetIndex\n            });\n            this.parent.element.querySelector('.e-spreadsheet-edit').innerHTML = value;\n            this.initiateCurPosition();\n        }\n        else {\n            this.initiateCurPosition();\n        }\n    };\n    Edit.prototype.addressHandler = function (args) {\n        var eventArgs = { action: 'getCurrentEditValue', editedValue: '' };\n        this.parent.notify(editOperation, eventArgs);\n        var address = args.range;\n        var sheetName = this.editCellData.fullAddr.substring(0, this.editCellData.fullAddr.indexOf('!'));\n        var sheetIdx = this.editCellData.sheetIndex;\n        var editorEle = this.parent.element.querySelector('.e-spreadsheet-edit');\n        if (this.parent.getActiveSheet().name !== sheetName) {\n            address = '\\'' + this.parent.getActiveSheet().name + '\\'' + '!' + address;\n        }\n        if (args.isSelect) {\n            this.parent.notify(initiateFormulaReference, { range: eventArgs.editedValue + address, formulaSheetIdx: sheetIdx });\n        }\n        else {\n            var editedValue = eventArgs.editedValue;\n            if (editedValue.indexOf(')') === editedValue.length - 1) {\n                editorEle.textContent = editedValue.substring(0, editedValue.length - 1)\n                    + address + editedValue.substring(editedValue.length - 1);\n            }\n            else {\n                editorEle.textContent = editedValue + address;\n            }\n        }\n    };\n    Edit.prototype.updateFormulaBarValue = function () {\n        var value = this.editCellData.value;\n        var address = this.parent.getActiveSheet().selectedRange;\n        address = isSingleCell(getIndexesFromAddress(address)) ? address.split(':')[0] : address;\n        var formulaBar = this.parent.element.querySelector('.e-formula-bar');\n        if (value && checkIsFormula(value)) {\n            var sheetName = this.editCellData.fullAddr.substring(0, this.editCellData.fullAddr.indexOf('!'));\n            if (this.parent.getActiveSheet().name !== sheetName) {\n                address = '\\'' + this.parent.getActiveSheet().name + '\\'' + '!' + address;\n            }\n            if (value.indexOf(')') === value.length - 1) {\n                formulaBar.value = value.substring(0, value.length - 1) + address + value.substring(value.length - 1);\n            }\n            else {\n                formulaBar.value = value + address;\n            }\n        }\n    };\n    Edit.prototype.setFormulaBarCurPosition = function (input, selectionStart, selectionEnd) {\n        if (input.setSelectionRange) {\n            input.focus();\n            input.selectionStart = selectionStart;\n            input.selectionEnd = selectionStart;\n            input.setSelectionRange(selectionStart, selectionEnd);\n        }\n    };\n    Edit.prototype.initiateCurPosition = function () {\n        var el = this.parent.element.querySelector('.e-spreadsheet-edit');\n        if (el.innerText) {\n            var range = document.createRange();\n            if (el.innerText.indexOf(')') === el.innerText.length - 1) {\n                range.setStart(el.childNodes[0], el.innerText.length - 1);\n                range.setEnd(el.childNodes[0], el.innerText.length - 1);\n            }\n            else {\n                range.setStart(el.childNodes[0], el.innerText.length);\n                range.setEnd(el.childNodes[0], el.innerText.length);\n            }\n            var selection = window.getSelection();\n            selection.removeAllRanges();\n            selection.addRange(range);\n        }\n        var sheetIdx = this.editCellData.sheetIndex;\n        if (sheetIdx !== this.parent.getActiveSheet().id - 1) {\n            var elem = this.parent.element.querySelector('.e-formula-bar');\n            if (elem.value) {\n                var valueLength = elem.value.length;\n                if (elem.value.indexOf(')') === valueLength - 1) {\n                    this.setFormulaBarCurPosition(elem, valueLength - 1, valueLength - 1);\n                }\n                else {\n                    this.setFormulaBarCurPosition(elem, valueLength, valueLength);\n                }\n            }\n        }\n    };\n    return Edit;\n}());\nexport { Edit };\n","import { contentLoaded, mouseDown, virtualContentLoaded, cellNavigate, getUpdateUsingRaf, focusBorder } from '../common/index';\nimport { showAggregate, refreshImgElem, getRowIdxFromClientY, getColIdxFromClientX, clearChartBorder } from '../common/index';\nimport { getColumnsWidth, updateSelectedRange, getColumnWidth, mergedRange, activeCellMergedRange } from '../../workbook/index';\nimport { getRowHeight, isSingleCell, activeCellChanged, checkIsFormula, getSheetIndex } from '../../workbook/index';\nimport { EventHandler, addClass, removeClass, isNullOrUndefined, Browser, closest } from '@syncfusion/ej2-base';\nimport { selectionComplete, getMoveEvent, getEndEvent, isTouchStart, locateElem } from '../common/index';\nimport { isTouchEnd, isTouchMove, getClientX, getClientY, mouseUpAfterSelection, selectRange, rowHeightChanged } from '../common/index';\nimport { colWidthChanged, protectSelection, editOperation, initiateFormulaReference, initiateCur, clearCellRef } from '../common/index';\nimport { getRangeIndexes, getCellAddress, getRangeAddress, getCellIndexes, getSwapRange } from '../../workbook/common/address';\nimport { addressHandle } from '../common/index';\nimport { isCellReference } from '../../workbook/index';\nimport { getIndexesFromAddress } from '../../workbook/common/address';\n/**\n * Represents selection support for Spreadsheet.\n */\nvar Selection = /** @class */ (function () {\n    /**\n     * Constructor for the Spreadsheet selection module.\n     * @private\n     */\n    function Selection(parent) {\n        this.uniqueOBracket = String.fromCharCode(129);\n        this.uniqueCBracket = String.fromCharCode(130);\n        this.uniqueCSeparator = String.fromCharCode(131);\n        this.uniqueCOperator = String.fromCharCode(132);\n        this.uniquePOperator = String.fromCharCode(133);\n        this.uniqueSOperator = String.fromCharCode(134);\n        this.uniqueMOperator = String.fromCharCode(135);\n        this.uniqueDOperator = String.fromCharCode(136);\n        this.uniqueModOperator = String.fromCharCode(137);\n        this.uniqueConcateOperator = String.fromCharCode(138);\n        this.uniqueEqualOperator = String.fromCharCode(139);\n        this.uniqueExpOperator = String.fromCharCode(140);\n        this.uniqueGTOperator = String.fromCharCode(141);\n        this.uniqueLTOperator = String.fromCharCode(142);\n        this.invalidOperators = ['%'];\n        this.formulaRange = [];\n        this.tableRangesFormula = {};\n        this.parent = parent;\n        this.addEventListener();\n        this.mouseMoveEvt = this.mouseMoveHandler.bind(this);\n    }\n    Selection.prototype.addEventListener = function () {\n        this.parent.on(contentLoaded, this.init, this);\n        this.parent.on(mouseDown, this.mouseDownHandler, this);\n        this.parent.on(virtualContentLoaded, this.virtualContentLoadedHandler, this);\n        this.parent.on(cellNavigate, this.cellNavigateHandler, this);\n        this.parent.on(selectRange, this.selectRange, this);\n        this.parent.on(rowHeightChanged, this.rowHeightChanged, this);\n        this.parent.on(colWidthChanged, this.colWidthChanged, this);\n        this.parent.on(protectSelection, this.protectHandler, this);\n        this.parent.on(initiateFormulaReference, this.initiateFormulaSelection, this);\n        this.parent.on(clearCellRef, this.clearBorder, this);\n        this.parent.on(getRowIdxFromClientY, this.getRowIdxFromClientY, this);\n        this.parent.on(getColIdxFromClientX, this.getColIdxFromClientX, this);\n        this.parent.on(focusBorder, this.chartBorderHandler, this);\n    };\n    Selection.prototype.removeEventListener = function () {\n        if (!this.parent.isDestroyed) {\n            this.parent.off(contentLoaded, this.init);\n            this.parent.off(mouseDown, this.mouseDownHandler);\n            this.parent.off(virtualContentLoaded, this.virtualContentLoadedHandler);\n            this.parent.off(cellNavigate, this.cellNavigateHandler);\n            this.parent.off(selectRange, this.selectRange);\n            this.parent.off(rowHeightChanged, this.rowHeightChanged);\n            this.parent.off(colWidthChanged, this.colWidthChanged);\n            this.parent.off(protectSelection, this.protectHandler);\n            this.parent.off(initiateFormulaReference, this.initiateFormulaSelection);\n            this.parent.off(clearCellRef, this.clearBorder);\n            this.parent.off(getRowIdxFromClientY, this.getRowIdxFromClientY);\n            this.parent.off(getColIdxFromClientX, this.getColIdxFromClientX);\n            this.parent.off(focusBorder, this.chartBorderHandler);\n        }\n    };\n    Selection.prototype.rowHeightChanged = function (args) {\n        var _this = this;\n        getUpdateUsingRaf(function () {\n            var ele = _this.getActiveCell();\n            var cellIndex = getCellIndexes(_this.parent.getActiveSheet().activeCell)[0];\n            if (cellIndex === args.rowIdx && ele) {\n                ele.style.height = parseInt(ele.style.height, 10) + args.threshold + \"px\";\n            }\n            else if (cellIndex > args.rowIdx && ele) {\n                ele.style.top = parseInt(ele.style.top, 10) + args.threshold + \"px\";\n            }\n            ele = _this.getSelectionElement();\n            if (ele) {\n                var selectedRange = getRangeIndexes(_this.parent.getActiveSheet().selectedRange);\n                var sRange = getSwapRange(selectedRange);\n                var rowStart = sRange[0];\n                var rowEnd = sRange[2];\n                if (rowStart <= args.rowIdx && rowEnd >= args.rowIdx && ele) {\n                    ele.style.height = parseInt(ele.style.height, 10) + args.threshold + \"px\";\n                }\n                else if (rowStart > args.rowIdx && ele) {\n                    ele.style.top = parseInt(ele.style.top, 10) + args.threshold + \"px\";\n                }\n            }\n        });\n    };\n    Selection.prototype.colWidthChanged = function (args) {\n        var _this = this;\n        getUpdateUsingRaf(function () {\n            var ele = _this.getActiveCell();\n            var cellIndex = getCellIndexes(_this.parent.getActiveSheet().activeCell)[1];\n            if (cellIndex === args.colIdx && ele) {\n                ele.style.width = parseInt(ele.style.width, 10) + args.threshold + \"px\";\n            }\n            else if (cellIndex > args.colIdx && ele) {\n                ele.style.left = parseInt(ele.style.left, 10) + args.threshold + \"px\";\n            }\n            ele = _this.getSelectionElement();\n            var selectedRange = getRangeIndexes(_this.parent.getActiveSheet().selectedRange);\n            var sRange = getSwapRange(selectedRange);\n            var colStart = sRange[1];\n            var colEnd = sRange[3];\n            if (colStart <= args.colIdx && colEnd >= args.colIdx && ele) {\n                ele.style.width = parseInt(ele.style.width, 10) + args.threshold + \"px\";\n            }\n            else if (colStart > args.colIdx && ele) {\n                ele.style.left = parseInt(ele.style.left, 10) + args.threshold + \"px\";\n            }\n        });\n    };\n    Selection.prototype.selectRange = function (args) {\n        this.selectRangeByIdx(this.parent.selectionSettings.mode === 'Single' ? args.indexes.slice(0, 2).concat(args.indexes.slice(0, 2)) : args.indexes, null, null, null, null, args.skipChecking);\n    };\n    Selection.prototype.init = function () {\n        var isInit = true;\n        var sheet = this.parent.getActiveSheet();\n        var range = getRangeIndexes(this.parent.getActiveSheet().selectedRange);\n        var sRange = getSwapRange(range);\n        var actRange = getCellIndexes(this.parent.getActiveSheet().activeCell);\n        var inRange = sRange[0] <= actRange[0] && sRange[2] >= actRange[0] && sRange[1] <= actRange[1]\n            && sRange[3] >= actRange[1];\n        this.createSelectionElement();\n        this.selectRangeByIdx(range, null, null, inRange, isInit);\n    };\n    Selection.prototype.createSelectionElement = function () {\n        var cont = this.parent.getMainContent();\n        var ele = this.parent.createElement('div', { className: 'e-selection' });\n        var activeCell = this.parent.createElement('div', { className: 'e-active-cell' });\n        cont.appendChild(ele);\n        cont.appendChild(activeCell);\n    };\n    Selection.prototype.mouseDownHandler = function (e) {\n        var eventArgs = { action: 'getCurrentEditValue', editedValue: '' };\n        this.parent.notify(editOperation, eventArgs);\n        var isFormulaEdit = (eventArgs.editedValue && eventArgs.editedValue.toString().indexOf('=') === 0) ||\n            checkIsFormula(eventArgs.editedValue);\n        if (!this.parent.isEdit || isFormulaEdit) {\n            var overlayElem = document.getElementById(this.parent.element.id + '_overlay');\n            if (typeof (e.target.className) === 'string') {\n                if (e.target.className.indexOf('e-ss-overlay') > -1) {\n                    return;\n                }\n            }\n            else if (overlayElem) {\n                overlayElem.classList.remove('e-ss-overlay-active');\n            }\n            if (closest(e.target, '.e-datavisualization-chart')) {\n                return;\n            }\n            if (this.parent.getActiveSheet().isProtected && !this.parent.getActiveSheet().protectSettings.selectCells) {\n                return;\n            }\n            if (!closest(e.target, '.e-findtool-dlg')) {\n                if (this.getSheetElement().contains(e.target) && !e.target.classList.contains('e-colresize')\n                    && !e.target.classList.contains('e-rowresize')) {\n                    var sheet = this.parent.getActiveSheet();\n                    var mode = this.parent.selectionSettings.mode;\n                    var rowIdx = this.getRowIdxFromClientY({ clientY: getClientY(e) });\n                    var colIdx = this.getColIdxFromClientX({ clientX: getClientX(e) });\n                    var activeIdx = getCellIndexes(sheet.activeCell);\n                    var isRowSelected = sheet.showHeaders && this.parent.getRowHeaderContent().contains(e.target);\n                    var isColSelected = sheet.showHeaders && this.parent.getColumnHeaderContent().contains(e.target);\n                    if (e.which === 3 && this.isSelected(rowIdx, colIdx)) {\n                        return;\n                    }\n                    if (mode === 'Multiple' && (!isTouchEnd(e) && (!isTouchStart(e) ||\n                        (isTouchStart(e) && activeIdx[0] === rowIdx && activeIdx[1] === colIdx)) || isColSelected || isRowSelected)) {\n                        document.addEventListener(getMoveEvent().split(' ')[0], this.mouseMoveEvt);\n                        if (!Browser.isPointer) {\n                            document.addEventListener(getMoveEvent().split(' ')[1], this.mouseMoveEvt, { passive: false });\n                        }\n                    }\n                    if (!isTouchEnd(e)) {\n                        EventHandler.add(document, getEndEvent(), this.mouseUpHandler, this);\n                    }\n                    if (isTouchStart(e) && !(isColSelected || isRowSelected)) {\n                        this.touchEvt = e;\n                        return;\n                    }\n                    if (isRowSelected) {\n                        this.isRowSelected = true;\n                        if (!e.shiftKey || mode === 'Single') {\n                            this.startCell = [rowIdx, 0];\n                        }\n                        this.selectRangeByIdx([this.startCell[0], 0, rowIdx, sheet.colCount - 1], e);\n                    }\n                    else if (isColSelected) {\n                        this.isColSelected = true;\n                        if (!e.shiftKey || mode === 'Single') {\n                            this.startCell = [0, colIdx];\n                        }\n                        this.selectRangeByIdx([0, this.startCell[1], sheet.rowCount - 1, colIdx], e);\n                    }\n                    else if (e.target.classList.contains('e-selectall')) {\n                        this.startCell = [0, 0];\n                        this.selectRangeByIdx([].concat(this.startCell, [sheet.rowCount - 1, sheet.colCount - 1]), e);\n                    }\n                    else if (!e.target.classList.contains('e-sheet-content')) {\n                        if (!e.shiftKey || mode === 'Single') {\n                            this.startCell = [rowIdx, colIdx];\n                        }\n                        this.selectRangeByIdx([].concat(this.startCell ? this.startCell : getCellIndexes(sheet.activeCell), [rowIdx, colIdx]), e);\n                    }\n                    if (this.parent.isMobileView()) {\n                        this.parent.element.classList.add('e-mobile-focused');\n                        this.parent.renderModule.setSheetPanelSize();\n                    }\n                }\n            }\n        }\n        if (isFormulaEdit && (e.target.classList.contains('e-cell') ||\n            e.target.classList.contains('e-header-cell')) && this.parent.isEdit) {\n            var range = this.parent.getActiveSheet().selectedRange;\n            range = isSingleCell(getIndexesFromAddress(range)) ? range.split(':')[0] : range;\n            this.parent.notify(addressHandle, { range: range, isSelect: false });\n        }\n    };\n    Selection.prototype.mouseMoveHandler = function (e) {\n        var _this = this;\n        var sheet = this.parent.getActiveSheet();\n        if (isTouchMove(e)) {\n            e.preventDefault();\n        }\n        var eventArgs = { action: 'getCurrentEditValue', editedValue: '' };\n        this.parent.notify(editOperation, eventArgs);\n        var isFormulaEdit = checkIsFormula(eventArgs.editedValue) ||\n            (eventArgs.editedValue && eventArgs.editedValue.toString().indexOf('=') === 0);\n        var cont = this.getScrollContent();\n        var clientRect = cont.getBoundingClientRect();\n        var clientX = getClientX(e);\n        var clientY = getClientY(e);\n        // remove math.min or handle top and left auto scroll\n        var colIdx = this.isRowSelected ? sheet.colCount - 1 :\n            this.getColIdxFromClientX({ clientX: Math.min(clientX, clientRect.right) });\n        var rowIdx = this.isColSelected ? sheet.rowCount - 1 :\n            this.getRowIdxFromClientY({ clientY: Math.min(clientY, clientRect.bottom) });\n        var prevIndex = getRangeIndexes(sheet.selectedRange);\n        var mergeArgs = { range: [rowIdx, colIdx, rowIdx, colIdx] };\n        this.parent.notify(activeCellMergedRange, mergeArgs);\n        if (mergeArgs.range[2] === prevIndex[2] && mergeArgs.range[3] === prevIndex[3]) {\n            return;\n        }\n        var isScrollDown = clientY > clientRect.bottom && rowIdx < sheet.rowCount;\n        var isScrollUp = clientY < clientRect.top && rowIdx >= 0 && !this.isColSelected;\n        var isScrollRight = clientX > clientRect.right && colIdx < sheet.colCount;\n        var isScrollLeft = clientX < clientRect.left && colIdx >= 0 && !this.isRowSelected;\n        this.clearInterval();\n        if (!isFormulaEdit && !this.isColSelected && !this.isRowSelected) {\n            prevIndex = getCellIndexes(sheet.activeCell);\n        }\n        if (isScrollDown || isScrollUp || isScrollRight || isScrollLeft) {\n            this.scrollInterval = setInterval(function () {\n                if ((isScrollDown || isScrollUp) && !_this.isColSelected) {\n                    rowIdx = _this.getRowIdxFromClientY({ clientY: isScrollDown ? clientRect.bottom : clientRect.top });\n                    if (rowIdx >= sheet.rowCount) { // clear interval when scroll up\n                        _this.clearInterval();\n                        return;\n                    }\n                    cont.scrollTop += (isScrollDown ? 1 : -1) * getRowHeight(sheet, rowIdx);\n                }\n                if ((isScrollRight || isScrollLeft) && !_this.isRowSelected) {\n                    colIdx = _this.getColIdxFromClientX({ clientX: isScrollRight ? clientRect.right : clientRect.left });\n                    if (colIdx >= sheet.colCount) { // clear interval when scroll left\n                        _this.clearInterval();\n                        return;\n                    }\n                    cont.scrollLeft += (isScrollRight ? 1 : -1) * getColumnWidth(sheet, colIdx);\n                }\n                _this.selectRangeByIdx([].concat(prevIndex[0], prevIndex[1], [rowIdx, colIdx]), e);\n                // tslint:disable-next-line\n            }, 100);\n        }\n        else {\n            this.selectRangeByIdx([].concat(prevIndex[0], prevIndex[1], [rowIdx, colIdx]), e);\n        }\n        if (isFormulaEdit && this.parent.isEdit) {\n            var range = this.parent.getActiveSheet().selectedRange;\n            this.parent.notify(addressHandle, { range: range, isSelect: false });\n        }\n    };\n    Selection.prototype.mouseUpHandler = function (e) {\n        var rowIdx = this.getRowIdxFromClientY({ clientY: getClientY(e) });\n        var colIdx = this.getColIdxFromClientX({ clientX: getClientX(e) });\n        this.clearInterval();\n        if (isTouchEnd(e) && !(this.isColSelected || this.isRowSelected) &&\n            (this.getRowIdxFromClientY({ clientY: getClientY(this.touchEvt) }) === rowIdx &&\n                this.getColIdxFromClientX({ clientX: getClientX(this.touchEvt) }) === colIdx)) {\n            this.mouseDownHandler(e);\n        }\n        this.parent.trigger('select', { range: this.parent.getActiveSheet().selectedRange });\n        document.removeEventListener(getMoveEvent().split(' ')[0], this.mouseMoveEvt);\n        if (!Browser.isPointer) {\n            document.removeEventListener(getMoveEvent().split(' ')[1], this.mouseMoveEvt);\n        }\n        EventHandler.remove(document, getEndEvent(), this.mouseUpHandler);\n        this.parent.notify(mouseUpAfterSelection, e);\n        var eventArgs = { action: 'getCurrentEditValue', editedValue: '' };\n        this.parent.notify(editOperation, eventArgs);\n        var isFormulaEdit = checkIsFormula(eventArgs.editedValue) ||\n            (eventArgs.editedValue && eventArgs.editedValue.toString().indexOf('=') === 0);\n        if (isFormulaEdit && this.parent.isEdit && !e.target.classList.contains('e-spreadsheet-edit')) {\n            this.parent.notify(initiateCur, {});\n        }\n    };\n    Selection.prototype.isSelected = function (rowIdx, colIdx) {\n        var indexes = getSwapRange(getRangeIndexes(this.parent.getActiveSheet().selectedRange));\n        return indexes[0] <= rowIdx && rowIdx <= indexes[2] && indexes[1] <= colIdx && colIdx <= indexes[3];\n    };\n    Selection.prototype.virtualContentLoadedHandler = function () {\n        var sheet = this.parent.getActiveSheet();\n        var indexes = getRangeIndexes(sheet.selectedRange);\n        if (this.isColSelected && this.isRowSelected) {\n            this.selectRangeByIdx([0, 0, sheet.rowCount - 1, sheet.colCount - 1], null, true);\n        }\n        else if (this.isColSelected) {\n            this.selectRangeByIdx([0, indexes[1], sheet.rowCount - 1, indexes[3]], null, true);\n        }\n        else if (this.isRowSelected) {\n            this.selectRangeByIdx([indexes[0], 0, indexes[2], sheet.colCount - 1], null, true);\n        }\n        else {\n            this.highlightHdr(indexes, indexes[0] >= this.parent.viewport.topIndex || indexes[2] >= this.parent.viewport.topIndex, indexes[1] >= this.parent.viewport.leftIndex || indexes[3] >= this.parent.viewport.leftIndex);\n        }\n    };\n    Selection.prototype.clearInterval = function () {\n        clearInterval(this.scrollInterval);\n        this.scrollInterval = null;\n    };\n    Selection.prototype.getScrollContent = function () {\n        return this.parent.getMainContent();\n    };\n    Selection.prototype.getScrollLeft = function () {\n        return this.parent.scrollModule ? this.parent.scrollModule.prevScroll.scrollLeft : 0;\n    };\n    Selection.prototype.cellNavigateHandler = function (args) {\n        var sheet = this.parent.getActiveSheet();\n        if (sheet.isProtected && !sheet.protectSettings.selectCells) {\n            return;\n        }\n        this.selectRangeByIdx(args.range.concat(args.range));\n    };\n    Selection.prototype.getColIdxFromClientX = function (args) {\n        var width = 0;\n        var sheet = this.parent.getActiveSheet();\n        var cliRect = this.parent.getMainContent().getBoundingClientRect();\n        var left = 0;\n        left = (args.isImage) ? args.clientX : (this.parent.enableRtl ? (cliRect.right - args.clientX) :\n            (args.clientX - cliRect.left)) + this.getScrollLeft();\n        for (var i = 0;; i++) {\n            width += getColumnsWidth(sheet, i);\n            if (left < width) {\n                args.clientX = i;\n                return i;\n            }\n        }\n    };\n    Selection.prototype.getRowIdxFromClientY = function (args) {\n        var height = 0;\n        var sheet = this.parent.getActiveSheet();\n        var top = 0;\n        top = args.isImage ? args.clientY : (args.clientY - this.parent.getMainContent().getBoundingClientRect().top)\n            + this.parent.getMainContent().scrollTop;\n        for (var i = 0;; i++) {\n            height += getRowHeight(sheet, i);\n            if (top < height) {\n                args.clientY = i;\n                return i;\n            }\n        }\n    };\n    Selection.prototype.initFormulaReferenceIndicator = function (range) {\n        if (this.parent.isEdit) {\n            var forRefIndicator = this.parent.createElement('div', { className: 'e-formularef-indicator' });\n            forRefIndicator.appendChild(this.parent.createElement('div', { className: 'e-top' }));\n            forRefIndicator.appendChild(this.parent.createElement('div', { className: 'e-bottom' }));\n            forRefIndicator.appendChild(this.parent.createElement('div', { className: 'e-left' }));\n            forRefIndicator.appendChild(this.parent.createElement('div', { className: 'e-right' }));\n            locateElem(forRefIndicator, range, this.parent.getActiveSheet(), false);\n            this.parent.getMainContent().appendChild(forRefIndicator);\n        }\n    };\n    Selection.prototype.selectRangeByIdx = function (range, e, isScrollRefresh, isActCellChanged, isInit, skipChecking) {\n        var eventArgs = { action: 'getCurrentEditValue', editedValue: '' };\n        this.parent.notify(editOperation, eventArgs);\n        var isFormulaEdit = checkIsFormula(eventArgs.editedValue) ||\n            (eventArgs.editedValue && eventArgs.editedValue.toString().indexOf('=') === 0);\n        var ele = this.getSelectionElement();\n        var sheet = this.parent.getActiveSheet();\n        var formulaRefIndicator = this.parent.element.querySelector('.e-formularef-indicator');\n        var mergeArgs = { range: [].slice.call(range), isActiveCell: false, skipChecking: skipChecking };\n        var isMergeRange;\n        if (!this.isColSelected && !this.isRowSelected) {\n            this.parent.notify(mergedRange, mergeArgs);\n        }\n        if (range !== mergeArgs.range) {\n            isMergeRange = true;\n        }\n        range = mergeArgs.range;\n        var args = { range: getRangeAddress(range), cancel: false };\n        this.parent.trigger('beforeSelect', args);\n        if (args.cancel === true) {\n            return;\n        }\n        if (isFormulaEdit && formulaRefIndicator) {\n            formulaRefIndicator.parentElement.removeChild(formulaRefIndicator);\n        }\n        if (isSingleCell(range) || mergeArgs.isActiveCell) {\n            if (ele) {\n                ele.classList.add('e-hide');\n            }\n            if (isFormulaEdit && e && !e.target.classList.contains('e-spreadsheet-edit') && this.parent.isEdit) {\n                this.parent.notify(addressHandle, { range: getRangeAddress(range).split(':')[0], isSelect: true });\n                this.initFormulaReferenceIndicator(range);\n            }\n        }\n        else {\n            if (isFormulaEdit && this.parent.isEdit) {\n                if (e && !e.target.classList.contains('e-spreadsheet-edit') && this.parent.isEdit) {\n                    this.parent.notify(addressHandle, { range: getRangeAddress(range), isSelect: true });\n                    this.initFormulaReferenceIndicator(range);\n                }\n            }\n            else {\n                if (ele) {\n                    ele.classList.remove('e-hide');\n                }\n                var offset = (this.isColSelected && this.isRowSelected) ? undefined\n                    : this.getOffset(range[2], range[3]);\n                if (isMergeRange && offset) { // Need to handle half hidden merge cell in better way\n                    offset.left = { idx: 0, size: 0 };\n                }\n                locateElem(ele, range, sheet, this.parent.enableRtl);\n            }\n        }\n        var eArgs = { action: 'getCurrentEditSheetIdx', sheetIndex: null };\n        this.parent.notify(editOperation, eArgs);\n        if (!isFormulaEdit) {\n            updateSelectedRange(this.parent, getRangeAddress(range), sheet);\n        }\n        else if (!isInit) {\n            updateSelectedRange(this.parent, getRangeAddress(range), sheet);\n        }\n        this.UpdateRowColSelected(range);\n        this.highlightHdr(range);\n        if (!isScrollRefresh && !(e && (e.type === 'mousemove' || isTouchMove(e)))) {\n            if (!isFormulaEdit) {\n                this.updateActiveCell(isActCellChanged ? getRangeIndexes(sheet.activeCell) : range, isInit);\n            }\n            else if (eArgs.sheetIndex === this.parent.getActiveSheet().id - 1 && isInit) {\n                isActCellChanged = true;\n                this.updateActiveCell(isActCellChanged ? getRangeIndexes(sheet.activeCell) : range, isInit);\n            }\n            else if (!this.parent.isEdit) {\n                this.updateActiveCell(isActCellChanged ? getRangeIndexes(sheet.activeCell) : range, isInit);\n            }\n        }\n        if (isNullOrUndefined(e)) {\n            e = { type: 'mousedown' };\n        }\n        if (!isFormulaEdit) {\n            this.parent.notify(selectionComplete, e);\n        }\n        else if (!isInit) {\n            this.parent.notify(selectionComplete, e);\n        }\n        this.parent.notify(showAggregate, {});\n        this.parent.notify(refreshImgElem, {});\n        this.parent.notify(clearChartBorder, {});\n    };\n    Selection.prototype.UpdateRowColSelected = function (indexes) {\n        var sheet = this.parent.getActiveSheet();\n        this.isRowSelected = (indexes[1] === 0 && indexes[3] === sheet.colCount - 1);\n        this.isColSelected = (indexes[0] === 0 && indexes[2] === sheet.rowCount - 1);\n    };\n    Selection.prototype.updateActiveCell = function (range, isInit) {\n        var sheet = this.parent.getActiveSheet();\n        var topLeftIdx = getRangeIndexes(sheet.topLeftCell);\n        var rowIdx;\n        var colIdx;\n        var cell;\n        var isMergeRange;\n        if (this.isColSelected) {\n            rowIdx = topLeftIdx[0];\n            colIdx = range[1];\n            if (this.isRowSelected) {\n                colIdx = topLeftIdx[1];\n            }\n        }\n        else {\n            rowIdx = range[0];\n            colIdx = range[1];\n            if (this.isRowSelected) {\n                colIdx = topLeftIdx[1];\n            }\n        }\n        var mergeArgs = { range: [rowIdx, colIdx].concat([rowIdx, colIdx]) };\n        this.parent.notify(activeCellMergedRange, mergeArgs);\n        if (range !== mergeArgs.range) {\n            isMergeRange = true;\n        }\n        range = mergeArgs.range;\n        if (sheet.activeCell !== getCellAddress(range[0], range[1]) || isInit) {\n            this.parent.setSheetPropertyOnMute(sheet, 'activeCell', getCellAddress(range[0], range[1]));\n            if (this.getActiveCell()) {\n                var offset = this.getOffset(range[2], range[3]);\n                if (isMergeRange) {\n                    offset.left = { idx: 0, size: 0 };\n                }\n                locateElem(this.getActiveCell(), range, sheet, this.parent.enableRtl);\n            }\n            this.parent.notify(activeCellChanged, null);\n        }\n        else {\n            locateElem(this.getActiveCell(), range, sheet, this.parent.enableRtl);\n        }\n    };\n    Selection.prototype.getOffset = function (rowIdx, colIdx) {\n        var offset = { left: { idx: 0, size: 0 }, top: { idx: 0, size: 0 } };\n        if (this.parent.scrollModule) {\n            if (colIdx >= this.parent.scrollModule.offset.left.idx) {\n                offset.left = this.parent.scrollModule.offset.left;\n            }\n            if (rowIdx >= this.parent.scrollModule.offset.top.idx) {\n                offset.top = this.parent.scrollModule.offset.top;\n            }\n        }\n        return offset;\n    };\n    Selection.prototype.getSelectionElement = function () {\n        return this.parent.element.getElementsByClassName('e-selection')[0];\n    };\n    Selection.prototype.getActiveCell = function () {\n        return this.parent.getMainContent().getElementsByClassName('e-active-cell')[0];\n    };\n    Selection.prototype.getSheetElement = function () {\n        return document.getElementById(this.parent.element.id + '_sheet');\n    };\n    Selection.prototype.highlightHdr = function (range, isRowRefresh, isColRefresh) {\n        if (isRowRefresh === void 0) { isRowRefresh = true; }\n        if (isColRefresh === void 0) { isColRefresh = true; }\n        if (this.parent.getActiveSheet().showHeaders) {\n            var sheet = this.parent.getActiveSheet();\n            var rowHdr = [];\n            var colHdr = [];\n            var swapRange = getSwapRange(range);\n            swapRange = this.getHdrIndexes(swapRange);\n            var selectAll = this.parent.element.getElementsByClassName('e-select-all-cell')[0];\n            removeClass(this.getSheetElement().querySelectorAll('.e-highlight'), 'e-highlight');\n            removeClass(this.getSheetElement().querySelectorAll('.e-prev-highlight'), 'e-prev-highlight');\n            if (selectAll) {\n                removeClass([selectAll], ['e-prev-highlight-right', 'e-prev-highlight-bottom']);\n            }\n            if (isRowRefresh) {\n                rowHdr = [].slice.call(this.parent.getRowHeaderContent().querySelectorAll('td')).slice(swapRange[0], swapRange[2] + 1);\n            }\n            if (isColRefresh) {\n                colHdr = [].slice.call(this.parent.getColumnHeaderContent().querySelectorAll('th')).slice(swapRange[1], swapRange[3] + 1);\n            }\n            if (sheet.isProtected && !sheet.protectSettings.selectCells) {\n                removeClass([].concat(rowHdr, colHdr), 'e-highlight');\n            }\n            else {\n                addClass([].concat(rowHdr, colHdr), 'e-highlight');\n            }\n            if (rowHdr.length && rowHdr[0].parentElement.previousElementSibling) {\n                rowHdr[0].parentElement.previousElementSibling.classList.add('e-prev-highlight');\n            }\n            if (colHdr.length && colHdr[0].previousElementSibling) {\n                colHdr[0].previousElementSibling.classList.add('e-prev-highlight');\n            }\n            if (this.isRowSelected && this.isColSelected) {\n                if (sheet.isProtected && !sheet.protectSettings.selectCells) {\n                    document.getElementById(this.parent.element.id + \"_select_all\").classList.remove('e-highlight');\n                }\n                else {\n                    document.getElementById(this.parent.element.id + \"_select_all\").classList.add('e-highlight');\n                }\n            }\n            if (selectAll) {\n                if (swapRange[0] === 0) {\n                    selectAll.classList.add('e-prev-highlight-bottom');\n                }\n                if (swapRange[1] === 0) {\n                    selectAll.classList.add('e-prev-highlight-right');\n                }\n            }\n        }\n    };\n    Selection.prototype.protectHandler = function () {\n        var range = getRangeIndexes(this.parent.getActiveSheet().selectedRange);\n        var swapRange = getSwapRange(range);\n        var actRange = getCellIndexes(this.parent.getActiveSheet().activeCell);\n        var inRange = swapRange[0] <= actRange[0] && swapRange[2] >= actRange[0] && swapRange[1] <= actRange[1]\n            && swapRange[3] >= actRange[1];\n        this.selectRangeByIdx(range, null, null, inRange);\n    };\n    Selection.prototype.getHdrIndexes = function (range) {\n        if (this.parent.scrollSettings.enableVirtualization) {\n            var indexes = [];\n            var hiddenRowCount = this.parent.hiddenCount(this.parent.viewport.topIndex, range[0]);\n            var hiddenColCount = this.parent.hiddenCount(this.parent.viewport.leftIndex, range[1], 'columns');\n            indexes[0] = this.isColSelected ? range[0] : (range[0] - this.parent.viewport.topIndex) < 0\n                ? 0 : ((range[0] - hiddenRowCount) - this.parent.viewport.topIndex);\n            indexes[1] = this.isRowSelected ? range[1] : (range[1] - this.parent.viewport.leftIndex) < 0\n                ? 0 : ((range[1] - hiddenColCount) - this.parent.viewport.leftIndex);\n            indexes[2] = this.isColSelected ? this.parent.viewport.rowCount + this.parent.getThreshold('row') * 2 : range[2] -\n                this.parent.hiddenCount(range[0], range[2]) - hiddenRowCount - this.parent.viewport.topIndex;\n            indexes[3] = this.isRowSelected ? this.parent.viewport.colCount + this.parent.getThreshold('col') * 2 :\n                range[3] - this.parent.hiddenCount(range[1], range[3], 'columns') - hiddenColCount - this.parent.viewport.leftIndex;\n            return indexes;\n        }\n        return range;\n    };\n    Selection.prototype.initiateFormulaSelection = function (args) {\n        this.processFormulaEditRange(args.range, args.formulaSheetIdx);\n    };\n    Selection.prototype.processFormulaEditRange = function (val, formulaStartSheetIdx) {\n        var str;\n        var actSheetIdx;\n        var formulaSheetIdx = formulaStartSheetIdx;\n        var lastChar;\n        var i = 0;\n        var parsedVal = this.parseFormula(val);\n        var len = parsedVal.length;\n        var ctrlKeyCount = 0;\n        var formulaBorder = [['e-vborderright', 'e-vborderbottom'], ['e-pborderright', 'e-pborderbottom'],\n            ['e-cborderright', 'e-cborderbottom'], ['e-gborderright', 'e-gborderbottom'], ['e-oborderright', 'e-oborderbottom'],\n            ['e-bborderright', 'e-bborderbottom']];\n        this.clearBorder();\n        actSheetIdx = this.parent.getActiveSheet().id - 1;\n        while (i < len) {\n            str = parsedVal[i];\n            if (this.invalidOperators.indexOf(str) > -1) {\n                break;\n            }\n            if (isCellReference(str.toUpperCase())) {\n                str = str.replace(/\\$/g, '');\n                if (i > 0) {\n                    if (parsedVal[i - 1].indexOf('!') === parsedVal[i - 1].length - 1) {\n                        var splitStr = parsedVal[i - 1].split('!');\n                        formulaSheetIdx = getSheetIndex(this.parent, splitStr[0].substring(1, splitStr[0].length - 1));\n                    }\n                }\n                if (parsedVal[i + 1] === ':') {\n                    i++;\n                    if (parsedVal[i + 1] && isCellReference(parsedVal[i + 1].toUpperCase())) {\n                        str = str + ':' + parsedVal[i + 1];\n                        i++;\n                    }\n                }\n                if (actSheetIdx === formulaSheetIdx) {\n                    this.updateFormulaEditRange(str, ctrlKeyCount, formulaBorder);\n                }\n                formulaSheetIdx = formulaStartSheetIdx;\n                ctrlKeyCount++;\n            }\n            i++;\n        }\n    };\n    Selection.prototype.updateFormulaEditRange = function (str, i, formulaBorder) {\n        var indices = getRangeIndexes(str);\n        this.formulaRange[i] = str;\n        this.dStartCell = { rowIndex: indices[0], colIndex: indices[1] };\n        this.dEndCell = { rowIndex: indices[2], colIndex: indices[3] };\n        this.focusBorder(this.dStartCell, this.dEndCell, formulaBorder[i % 6]);\n    };\n    Selection.prototype.chartBorderHandler = function (args) {\n        this.focusBorder(args.startcell, args.endcell, args.classes, true);\n    };\n    Selection.prototype.focusBorder = function (startcell, endcell, classes, isChart) {\n        isChart = isNullOrUndefined(isChart) ? false : isChart;\n        var range = getSwapRange([startcell.rowIndex, startcell.colIndex, endcell.rowIndex, endcell.colIndex]);\n        var minr = range[0];\n        var minc = range[1];\n        var maxr = range[2];\n        var maxc = range[3];\n        if (minr) {\n            (this.getEleFromRange([minr - 1, minc, minr - 1, maxc])).forEach(function (td) {\n                if (td) {\n                    td.classList.add(classes[1]);\n                    if (!isChart) {\n                        td.classList.add('e-formularef-selection');\n                    }\n                }\n            }); // top                            \n        }\n        (this.getEleFromRange([minr, maxc, maxr, maxc])).forEach(function (td) {\n            if (td) {\n                td.classList.add(classes[0]);\n                if (!isChart) {\n                    td.classList.add('e-formularef-selection');\n                }\n            }\n        }); // right\n        this.getEleFromRange([maxr, minc, maxr, maxc]).forEach(function (td) {\n            if (td) {\n                td.classList.add(classes[1]);\n                if (!isChart) {\n                    td.classList.add('e-formularef-selection');\n                }\n            }\n        }); // bottom\n        if (minc) {\n            (this.getEleFromRange([minr, minc - 1, maxr, minc - 1])).forEach(function (td) {\n                if (td) {\n                    td.classList.add(classes[0]);\n                    if (!isChart) {\n                        td.classList.add('e-formularef-selection');\n                    }\n                }\n            }); // left\n        }\n    };\n    Selection.prototype.getEleFromRange = function (range, sheetIdx) {\n        sheetIdx = this.parent.getActiveSheet().index;\n        var sheet = this.parent.getActiveSheet();\n        var startRIndex = range[0];\n        var startCIndex = range[1];\n        var endRIndex = range[2];\n        var endCIndex = range[3];\n        var i;\n        var rowIdx;\n        var temp;\n        var len;\n        var tempCells = [];\n        var rowCells;\n        var cells = [];\n        if (startRIndex > endRIndex) {\n            temp = startRIndex;\n            startRIndex = endRIndex;\n            endRIndex = temp;\n        }\n        if (startCIndex > endCIndex) {\n            temp = startCIndex;\n            startCIndex = endCIndex;\n            endCIndex = temp;\n        }\n        if (this.parent.scrollSettings.enableVirtualization) {\n            for (i = startRIndex; i <= endRIndex; i++) {\n                rowIdx = i;\n                if (rowIdx > -1) {\n                    var row = this.parent.getRow(rowIdx);\n                    if (row) {\n                        rowCells = row.getElementsByClassName('e-cell');\n                        tempCells = (endCIndex === startCIndex) ?\n                            [rowCells[endCIndex]] : this.getRowCells(rowCells, startCIndex, endCIndex + 1);\n                        this.merge(cells, tempCells);\n                    }\n                }\n            }\n        }\n        return cells;\n    };\n    Selection.prototype.getRowCells = function (rowCells, startCIndex, endCIndex) {\n        var tdCol = [];\n        for (startCIndex; startCIndex < endCIndex; startCIndex++) {\n            if (rowCells[startCIndex]) {\n                tdCol.push(rowCells[startCIndex]);\n            }\n        }\n        return tdCol;\n    };\n    Selection.prototype.merge = function (first, second) {\n        if (!first || !second) {\n            return;\n        }\n        Array.prototype.push.apply(first, second);\n    };\n    ;\n    Selection.prototype.clearBorder = function () {\n        var borderEleColl = this.parent.element.getElementsByClassName('e-formularef-selection');\n        for (var idx = 0; idx < borderEleColl.length; idx++) {\n            var td = borderEleColl[idx];\n            var classArr = ['e-vborderright', 'e-vborderbottom', 'e-pborderright', 'e-pborderbottom',\n                'e-cborderright', 'e-cborderbottom', 'e-gborderright', 'e-gborderbottom', 'e-oborderright',\n                'e-oborderbottom', 'e-bborderright', 'e-bborderbottom'];\n            for (var idx_1 = 0; idx_1 < classArr.length; idx_1++) {\n                td.classList.remove(classArr[idx_1]);\n            }\n        }\n        for (var idx = 0; idx < borderEleColl.length; idx++) {\n            var td = borderEleColl[idx];\n        }\n    };\n    Selection.prototype.parseFormula = function (formulaStr) {\n        var tempStr;\n        var str;\n        var len;\n        var i = 0;\n        var arr = [];\n        formulaStr = this.markSpecialChar(formulaStr.replace('=', ''));\n        var formula = formulaStr.split(/\\(|\\)|=|\\^|>|<|,|:|\\+|-|\\*|\\/|%|&/g);\n        len = formula.length;\n        while (i < len) {\n            tempStr = formula[i];\n            if (!tempStr) {\n                i++;\n                continue;\n            }\n            if (tempStr.length === 1) {\n                arr.push(this.isUniqueChar(tempStr) ? this.getUniqueCharVal(tempStr) : tempStr);\n            }\n            else {\n                str = tempStr[0];\n                if (tempStr.indexOf('!') > 0) {\n                    if (this.isUniqueChar(str)) {\n                        arr.push(this.getUniqueCharVal(str));\n                        tempStr = tempStr.substr(1);\n                    }\n                    var strVal = tempStr.indexOf('!') + 1;\n                    arr.push(tempStr.substr(0, strVal));\n                    arr.push(tempStr.substr(strVal));\n                }\n                else if (this.isUniqueChar(str)) {\n                    arr.push(this.getUniqueCharVal(str));\n                    arr.push(tempStr.substr(1));\n                }\n                else {\n                    arr.push(tempStr);\n                }\n            }\n            i++;\n        }\n        return arr;\n    };\n    Selection.prototype.isUniqueChar = function (str) {\n        var code = str.charCodeAt(str.charAt[0]);\n        return code >= 129 && code <= 142;\n    };\n    Selection.prototype.getUniqueCharVal = function (tempStr) {\n        switch (tempStr) {\n            case this.uniqueOBracket:\n                return '(';\n            case this.uniqueCBracket:\n                return ')';\n            case this.uniqueCOperator:\n                return ':';\n            case this.uniqueSOperator:\n                return '-';\n            case this.uniquePOperator:\n                return '+';\n            case this.uniqueMOperator:\n                return '*';\n            case this.uniqueDOperator:\n                return '/';\n            case this.uniqueModOperator:\n                return '%';\n            case this.uniqueCSeparator:\n                return ',';\n            case this.uniqueConcateOperator:\n                return '&';\n            case this.uniqueEqualOperator:\n                return '=';\n            case this.uniqueExpOperator:\n                return '^';\n            case this.uniqueLTOperator:\n                return '<';\n            case this.uniqueGTOperator:\n                return '>';\n        }\n        return '';\n    };\n    Selection.prototype.markSpecialChar = function (formulaVal) {\n        formulaVal = formulaVal.replace(/\\(/g, '(' + this.uniqueOBracket).replace(/\\)/g, ')' + this.uniqueCBracket);\n        formulaVal = formulaVal.replace(/,/g, ',' + this.uniqueCSeparator).replace(/:/g, ':' + this.uniqueCOperator);\n        formulaVal = formulaVal.replace(/\\+/g, '+' + this.uniquePOperator).replace(/-/g, '-' + this.uniqueSOperator);\n        formulaVal = formulaVal.replace(/\\*/g, '*' + this.uniqueMOperator).replace(/\\//g, '/' + this.uniqueDOperator);\n        formulaVal = formulaVal.replace(/&/g, '&' + this.uniqueConcateOperator);\n        formulaVal = formulaVal.replace(/=/g, '=' + this.uniqueEqualOperator);\n        formulaVal = formulaVal.replace(/\\^/g, '^' + this.uniqueExpOperator);\n        formulaVal = formulaVal.replace(/>/g, '>' + this.uniqueGTOperator).replace(/</g, '<' + this.uniqueLTOperator);\n        return formulaVal.replace(/%/g, '%' + this.uniqueModOperator);\n    };\n    /**\n     * For internal use only - Get the module name.\n     * @private\n     */\n    Selection.prototype.getModuleName = function () {\n        return 'selection';\n    };\n    Selection.prototype.destroy = function () {\n        this.removeEventListener();\n        this.parent = null;\n    };\n    return Selection;\n}());\nexport { Selection };\n","import { EventHandler, Browser } from '@syncfusion/ej2-base';\nimport { contentLoaded, spreadsheetDestroyed, onVerticalScroll, onHorizontalScroll, getScrollBarWidth } from '../common/index';\nimport { onContentScroll, deInitProperties, setScrollEvent, skipHiddenIdx } from '../common/index';\nimport { getRowHeight, getColumnWidth, getCellAddress } from '../../workbook/index';\nimport { isFormulaBarEdit } from '../common/index';\n/**\n * The `Scroll` module is used to handle scrolling behavior.\n * @hidden\n */\nvar Scroll = /** @class */ (function () {\n    /**\n     * Constructor for the Spreadsheet scroll module.\n     * @private\n     */\n    function Scroll(parent) {\n        this.parent = parent;\n        this.addEventListener();\n        this.initProps();\n    }\n    Scroll.prototype.onContentScroll = function (e) {\n        var target = this.parent.getMainContent();\n        var scrollLeft = e.scrollLeft || target.scrollLeft;\n        var top = e.scrollTop || target.scrollTop;\n        var left = this.parent.enableRtl ? this.initScrollValue - scrollLeft : scrollLeft;\n        var scrollArgs;\n        var prevSize;\n        if (this.prevScroll.scrollLeft !== left) {\n            var scrollRight = left > this.prevScroll.scrollLeft;\n            prevSize = this.offset.left.size;\n            this.offset.left = this.getColOffset(left, scrollRight, e.skipHidden);\n            if (this.parent.getActiveSheet().showHeaders) {\n                this.parent.getColumnHeaderContent().scrollLeft = scrollLeft;\n            }\n            scrollArgs = {\n                cur: this.offset.left, prev: { idx: this.leftIndex, size: prevSize }, increase: scrollRight, preventScroll: e.preventScroll\n            };\n            this.parent.notify(onHorizontalScroll, scrollArgs);\n            this.updateTopLeftCell(scrollRight);\n            if (!this.parent.scrollSettings.enableVirtualization && scrollRight && !this.parent.scrollSettings.isFinite) {\n                this.updateNonVirtualCols();\n            }\n            this.leftIndex = scrollArgs.prev.idx;\n            this.prevScroll.scrollLeft = left;\n        }\n        if (this.prevScroll.scrollTop !== top) {\n            var scrollDown = top > this.prevScroll.scrollTop;\n            prevSize = this.offset.top.size;\n            this.offset.top = this.getRowOffset(top, scrollDown);\n            if (this.parent.getActiveSheet().showHeaders) {\n                this.parent.getRowHeaderContent().scrollTop = top;\n            }\n            scrollArgs = {\n                cur: this.offset.top, prev: { idx: this.topIndex, size: prevSize }, increase: scrollDown, preventScroll: e.preventScroll\n            };\n            this.parent.notify(onVerticalScroll, scrollArgs);\n            this.updateTopLeftCell(scrollDown);\n            if (!this.parent.scrollSettings.enableVirtualization && scrollDown && !this.parent.scrollSettings.isFinite) {\n                this.updateNonVirtualRows();\n            }\n            this.topIndex = scrollArgs.prev.idx;\n            this.prevScroll.scrollTop = top;\n        }\n        var isEdit = false;\n        var args = { isEdit: isEdit };\n        this.parent.notify(isFormulaBarEdit, args);\n        if (args.isEdit) {\n            var textArea = this.parent.element.querySelector('.e-formula-bar');\n            textArea.focus();\n        }\n    };\n    Scroll.prototype.updateNonVirtualRows = function () {\n        var sheet = this.parent.getActiveSheet();\n        var threshold = this.parent.getThreshold('row');\n        if (this.offset.top.idx > sheet.rowCount - (this.parent.viewport.rowCount + threshold)) {\n            this.parent.renderModule.refreshUI({ colIndex: 0, direction: 'first', refresh: 'RowPart' }, getCellAddress(sheet.rowCount, 0) + \":\" + getCellAddress(sheet.rowCount + threshold - 1, sheet.colCount - 1));\n            sheet.rowCount += threshold;\n        }\n    };\n    Scroll.prototype.updateNonVirtualCols = function () {\n        var sheet = this.parent.getActiveSheet();\n        var threshold = this.parent.getThreshold('col');\n        if (this.offset.left.idx > sheet.colCount - (this.parent.viewport.colCount + threshold)) {\n            this.parent.renderModule.refreshUI({ rowIndex: 0, colIndex: sheet.colCount, direction: 'first', refresh: 'ColumnPart' }, getCellAddress(0, sheet.colCount) + \":\" + getCellAddress(sheet.rowCount - 1, sheet.colCount + threshold - 1));\n            sheet.colCount += threshold;\n        }\n    };\n    Scroll.prototype.updateTopLeftCell = function (increase) {\n        var top = this.offset.top.idx;\n        var left = this.offset.left.idx;\n        if (!increase) {\n            var sheet = this.parent.getActiveSheet();\n            top = skipHiddenIdx(sheet, top, true);\n            left = skipHiddenIdx(sheet, left, true, 'columns');\n        }\n        this.parent.setSheetPropertyOnMute(this.parent.getActiveSheet(), 'topLeftCell', getCellAddress(top, left));\n    };\n    Scroll.prototype.getRowOffset = function (scrollTop, scrollDown) {\n        var temp = this.offset.top.size;\n        var sheet = this.parent.getActiveSheet();\n        var i = scrollDown ? this.offset.top.idx + 1 : (this.offset.top.idx ? this.offset.top.idx - 1 : 0);\n        var count;\n        if (this.parent.scrollSettings.isFinite) {\n            count = sheet.rowCount;\n            if (scrollDown && i + this.parent.viewport.rowCount + this.parent.getThreshold('row') >= count) {\n                return { idx: this.offset.top.idx, size: this.offset.top.size };\n            }\n        }\n        else {\n            count = Infinity;\n        }\n        while (i < count) {\n            if (scrollDown) {\n                temp += getRowHeight(sheet, i - 1);\n                if (temp === scrollTop) {\n                    return { idx: i, size: temp };\n                }\n                if (temp > scrollTop) {\n                    return { idx: i - 1, size: temp - getRowHeight(sheet, i - 1) };\n                }\n                i++;\n            }\n            else {\n                if (temp === 0) {\n                    return { idx: 0, size: 0 };\n                }\n                temp -= getRowHeight(sheet, i);\n                if (temp === scrollTop) {\n                    return { idx: i, size: temp };\n                }\n                if (temp < scrollTop) {\n                    temp += getRowHeight(sheet, i);\n                    if (temp > scrollTop) {\n                        return { idx: i, size: temp - getRowHeight(sheet, i) < 0 ? 0 : temp - getRowHeight(sheet, i) };\n                    }\n                    else {\n                        return { idx: i + 1, size: temp };\n                    }\n                }\n                i--;\n            }\n        }\n        return { idx: this.offset.top.idx, size: this.offset.top.size };\n    };\n    Scroll.prototype.getColOffset = function (scrollLeft, increase, skipHidden) {\n        var temp = this.offset.left.size;\n        var sheet = this.parent.getActiveSheet();\n        var i = increase ? this.offset.left.idx + 1 : this.offset.left.idx - 1;\n        var count;\n        if (this.parent.scrollSettings.isFinite) {\n            count = sheet.colCount;\n            if (increase && i + this.parent.viewport.colCount + this.parent.getThreshold('col') >= count) {\n                return { idx: this.offset.left.idx, size: this.offset.left.size };\n            }\n        }\n        else {\n            count = Infinity;\n        }\n        while (i < count) {\n            if (increase) {\n                temp += getColumnWidth(sheet, i - 1, skipHidden);\n                if (temp === scrollLeft) {\n                    return { idx: i, size: temp };\n                }\n                if (temp > scrollLeft) {\n                    return { idx: i - 1, size: temp - getColumnWidth(sheet, i - 1, skipHidden) };\n                }\n                i++;\n            }\n            else {\n                if (temp === 0) {\n                    return { idx: 0, size: 0 };\n                }\n                temp -= getColumnWidth(sheet, i, skipHidden);\n                if (temp === scrollLeft) {\n                    return { idx: i, size: temp };\n                }\n                if (temp < scrollLeft) {\n                    temp += getColumnWidth(sheet, i, skipHidden);\n                    if (temp > scrollLeft) {\n                        return { idx: i, size: temp - getColumnWidth(sheet, i, skipHidden) };\n                    }\n                    else {\n                        return { idx: i + 1, size: temp };\n                    }\n                }\n                i--;\n            }\n        }\n        return { idx: this.offset.left.idx, size: this.offset.left.size };\n    };\n    Scroll.prototype.contentLoaded = function () {\n        this.onScroll = this.onContentScroll.bind(this);\n        this.setScrollEvent();\n        if (this.parent.enableRtl) {\n            this.initScrollValue = this.parent.getMainContent().scrollLeft;\n        }\n    };\n    Scroll.prototype.setScrollEvent = function (args) {\n        if (args === void 0) { args = { set: true }; }\n        args.set ? EventHandler.add(this.parent.getMainContent(), 'scroll', this.onScroll, this) :\n            EventHandler.remove(this.parent.getMainContent(), 'scroll', this.onScroll);\n    };\n    Scroll.prototype.initProps = function () {\n        this.topIndex = 0;\n        this.leftIndex = 0;\n        this.prevScroll = { scrollLeft: 0, scrollTop: 0 };\n        this.offset = { left: { idx: 0, size: 0 }, top: { idx: 0, size: 0 } };\n    };\n    Scroll.prototype.getThreshold = function () {\n        /* Some browsers places the scroller outside the content,\n         * hence the padding should be adjusted.*/\n        if (Browser.info.name === 'mozilla') {\n            return 0.5;\n        }\n        return 1;\n    };\n    /**\n     * @hidden\n     */\n    Scroll.prototype.setPadding = function () {\n        if (!this.parent.allowScrolling) {\n            return;\n        }\n        var colHeader = this.parent.getColumnHeaderContent();\n        var rowHeader = this.parent.getRowHeaderContent();\n        var scrollWidth = getScrollBarWidth() - this.getThreshold();\n        var cssProps = this.parent.enableRtl ? { padding: 'paddingLeft', border: 'borderLeftWidth' }\n            : { padding: 'paddingRight', border: 'borderRightWidth' };\n        if (scrollWidth > 0) {\n            colHeader.parentElement.style[cssProps.padding] = scrollWidth + 'px';\n            colHeader.style[cssProps.border] = '1px';\n            rowHeader.style.marginBottom = scrollWidth + 'px';\n        }\n    };\n    Scroll.prototype.addEventListener = function () {\n        this.parent.on(contentLoaded, this.contentLoaded, this);\n        this.parent.on(onContentScroll, this.onContentScroll, this);\n        this.parent.on(deInitProperties, this.initProps, this);\n        this.parent.on(spreadsheetDestroyed, this.destroy, this);\n        this.parent.on(setScrollEvent, this.setScrollEvent, this);\n    };\n    Scroll.prototype.destroy = function () {\n        EventHandler.remove(this.parent.getMainContent(), 'scroll', this.onScroll);\n        this.removeEventListener();\n        this.parent = null;\n    };\n    Scroll.prototype.removeEventListener = function () {\n        this.parent.off(contentLoaded, this.contentLoaded);\n        this.parent.off(onContentScroll, this.onContentScroll);\n        this.parent.off(deInitProperties, this.initProps);\n        this.parent.off(spreadsheetDestroyed, this.destroy);\n        this.parent.off(setScrollEvent, this.setScrollEvent);\n    };\n    return Scroll;\n}());\nexport { Scroll };\n","import { isNullOrUndefined } from '@syncfusion/ej2-base';\nimport { spreadsheetDestroyed, beforeContentLoaded, beforeVirtualContentLoaded, virtualContentLoaded } from '../common/index';\nimport { colWidthChanged, updateTableWidth } from '../common/index';\nimport { onVerticalScroll, onHorizontalScroll, rowHeightChanged, beforeHeaderLoaded, deInitProperties } from '../common/index';\nimport { getRowHeight, getRowsHeight, getColumnWidth, getColumnsWidth } from './../../workbook/index';\nimport { getRangeAddress } from '../../workbook/common/index';\nimport { updateUsedRange, sheetCreated, sheetsDestroyed } from '../../workbook/common/event';\n/**\n * VirtualScroll module\n * @hidden\n */\nvar VirtualScroll = /** @class */ (function () {\n    function VirtualScroll(parent) {\n        this.scroll = [];\n        this.parent = parent;\n        this.addEventListener();\n    }\n    VirtualScroll.prototype.createVirtualElement = function (args) {\n        var sheet = this.parent.getActiveSheet();\n        var container = this.parent.getMainContent();\n        this.content = this.parent.createElement('div', { className: 'e-virtualable' });\n        this.content.appendChild(container.querySelector('.e-table'));\n        container.appendChild(this.content);\n        var vTrack = container.appendChild(this.parent.createElement('div', { className: 'e-virtualtrack' }));\n        var colVTrack;\n        var rowVTrack;\n        var height;\n        var width;\n        if (this.parent.sheets.length > this.scroll.length) {\n            this.initScroll();\n        }\n        var domCount = this.parent.viewport.rowCount + 1 + (this.parent.getThreshold('row') * 2);\n        if (sheet.rowCount > domCount || sheet.usedRange.rowIndex > domCount - 1) {\n            if (!this.parent.scrollSettings.isFinite && sheet.rowCount <= sheet.usedRange.rowIndex) {\n                this.parent.setSheetPropertyOnMute(sheet, 'rowCount', sheet.usedRange.rowIndex + 1);\n            }\n            this.setScrollCount(sheet.rowCount, 'row');\n            height = getRowsHeight(sheet, 0, this.scroll[this.parent.activeSheetIndex].rowCount - 1);\n        }\n        else {\n            if (!this.parent.scrollSettings.isFinite) {\n                this.parent.setSheetPropertyOnMute(sheet, 'rowCount', domCount);\n            }\n            this.scroll[this.parent.activeSheetIndex].rowCount = sheet.rowCount;\n            height = 1;\n        }\n        domCount = this.parent.viewport.colCount + 1 + (this.parent.getThreshold('col') * 2);\n        var size;\n        if (sheet.colCount > domCount || sheet.usedRange.colIndex > domCount - 1) {\n            if (!this.parent.scrollSettings.isFinite && sheet.colCount <= sheet.usedRange.colIndex) {\n                this.parent.setSheetPropertyOnMute(sheet, 'colCount', sheet.usedRange.colIndex + 1);\n            }\n            size = getColumnsWidth(sheet, 0, domCount - 1);\n            this.setScrollCount(sheet.colCount, 'col');\n            width = size + getColumnsWidth(sheet, domCount, this.scroll[this.parent.activeSheetIndex].colCount - 1);\n        }\n        else {\n            if (!this.parent.scrollSettings.isFinite) {\n                this.parent.setSheetPropertyOnMute(sheet, 'colCount', domCount);\n            }\n            size = getColumnsWidth(sheet, 0, sheet.colCount - 1);\n            this.scroll[this.parent.activeSheetIndex].colCount = sheet.colCount;\n            width = size;\n        }\n        if (args.startColIdx) {\n            size = getColumnsWidth(sheet, args.startColIdx, args.startColIdx + domCount - 1);\n        }\n        if (isNullOrUndefined(this.parent.viewport.leftIndex)) {\n            this.parent.viewport.leftIndex = 0;\n        }\n        if (isNullOrUndefined(this.parent.viewport.topIndex)) {\n            this.parent.viewport.topIndex = 0;\n        }\n        if (isNullOrUndefined(this.translateX)) {\n            this.translateX = 0;\n        }\n        if (isNullOrUndefined(this.translateY)) {\n            this.translateY = 0;\n        }\n        if (sheet.showHeaders) {\n            container = this.parent.getRowHeaderContent();\n            this.rowHeader = this.content.cloneNode();\n            this.rowHeader.appendChild(container.querySelector('.e-table'));\n            container.appendChild(this.rowHeader);\n            rowVTrack = container.appendChild(vTrack.cloneNode());\n            this.rowHeader.style.transform = \"translate(0px, \" + this.translateY + \"px)\";\n            container = this.parent.getColumnHeaderContent();\n            this.colHeader = this.content.cloneNode();\n            this.colHeader.appendChild(container.querySelector('.e-table'));\n            container.appendChild(this.colHeader);\n            colVTrack = container.appendChild(vTrack.cloneNode());\n            this.colHeader.style.width = size + \"px\";\n            rowVTrack.style.height = height + \"px\";\n            colVTrack.style.width = width + \"px\";\n            this.colHeader.style.transform = \"translate(\" + this.translateX + \"px, 0px)\";\n        }\n        this.content.style.transform = \"translate(\" + this.translateX + \"px, \" + this.translateY + \"px)\";\n        this.content.style.width = size + \"px\";\n        vTrack.style.height = height + \"px\";\n        vTrack.style.width = width + \"px\";\n    };\n    VirtualScroll.prototype.initScroll = function () {\n        var i = 0;\n        while (i < this.parent.sheets.length) {\n            if (!this.scroll[i]) {\n                this.scroll.push({ rowCount: 0, colCount: 0 });\n            }\n            i++;\n        }\n    };\n    VirtualScroll.prototype.setScrollCount = function (count, layout) {\n        var activeSheetIdx = this.parent.activeSheetIndex;\n        if (!this.scroll[activeSheetIdx][layout + 'Count']) {\n            this.scroll[activeSheetIdx][layout + 'Count'] = count;\n        }\n    };\n    VirtualScroll.prototype.getRowAddress = function (indexes) {\n        return getRangeAddress([indexes[0], this.parent.viewport.leftIndex, indexes[1], this.parent.viewport.rightIndex]);\n    };\n    VirtualScroll.prototype.getColAddress = function (indexes) {\n        return getRangeAddress([this.parent.viewport.topIndex, indexes[0], this.parent.viewport.bottomIndex, indexes[1]]);\n    };\n    VirtualScroll.prototype.updateScrollCount = function (idx, layout, threshold) {\n        if (threshold === void 0) { threshold = idx; }\n        var sheet = this.parent.getActiveSheet();\n        var rowCount = idx + this.parent.viewport[layout + 'Count'] + 1 + threshold;\n        var usedRangeCount = this.scroll[this.parent.activeSheetIndex][layout + 'Count'];\n        if (rowCount < usedRangeCount) {\n            if (sheet[layout + 'Count'] === usedRangeCount) {\n                return;\n            }\n            rowCount = usedRangeCount;\n        }\n        if (!this.parent.scrollSettings.isFinite) {\n            this.parent.setSheetPropertyOnMute(sheet, layout + 'Count', rowCount);\n        }\n    };\n    VirtualScroll.prototype.onVerticalScroll = function (args) {\n        var idx = args.cur.idx;\n        var height = args.cur.size;\n        var prevIdx = args.prev.idx;\n        var idxDiff = Math.abs(idx - prevIdx);\n        var threshold = this.parent.getThreshold('row');\n        if (idxDiff > Math.round(threshold / 2)) {\n            var startIdx = void 0;\n            var lastIdx = void 0;\n            var prevTopIdx = void 0;\n            if (idx <= threshold) {\n                if (!args.increase) {\n                    if (this.translateY && prevIdx > threshold) {\n                        this.translateY = 0;\n                        this.parent.viewport.topIndex = prevIdx - threshold;\n                        if (!args.preventScroll) {\n                            if (idxDiff < this.parent.viewport.rowCount + threshold) {\n                                lastIdx = this.parent.viewport.topIndex - 1;\n                                startIdx = this.parent.skipHidden(0, lastIdx)[0];\n                                this.parent.viewport.topIndex = startIdx;\n                                var hiddenCount = this.hiddenCount(startIdx, lastIdx);\n                                var skippedHiddenIdx = this.skipHiddenIdx((this.parent.viewport.bottomIndex - ((lastIdx - startIdx + 1) - hiddenCount)), args.increase);\n                                this.parent.viewport.bottomIndex -= (((lastIdx - startIdx + 1) - hiddenCount) +\n                                    (this.hiddenCount(skippedHiddenIdx, this.parent.viewport.bottomIndex)));\n                                this.parent.renderModule.refreshUI({\n                                    colIndex: this.parent.viewport.leftIndex, rowIndex: startIdx, direction: 'last', refresh: 'RowPart',\n                                    skipUpdateOnFirst: true\n                                }, this.getRowAddress([0, this.skipHiddenIdx(lastIdx, false)]));\n                            }\n                            else {\n                                this.parent.renderModule.refreshUI({ rowIndex: 0, colIndex: this.parent.viewport.leftIndex, refresh: 'Row', skipUpdateOnFirst: true });\n                            }\n                            this.parent.element.focus();\n                        }\n                    }\n                    this.updateScrollCount(threshold, 'row');\n                }\n            }\n            if (prevIdx < threshold) {\n                idxDiff = Math.abs(idx - threshold);\n            }\n            if (idx > threshold) {\n                prevTopIdx = this.parent.viewport.topIndex;\n                this.parent.viewport.topIndex = idx - threshold;\n                if (args.increase && prevTopIdx > this.parent.viewport.topIndex) {\n                    this.parent.viewport.topIndex = prevTopIdx;\n                    return;\n                }\n                this.translateY = height - this.getThresholdHeight(this.parent.viewport.topIndex, threshold);\n                if (!args.preventScroll) {\n                    if (idxDiff < this.parent.viewport.rowCount + threshold) {\n                        if (args.increase) {\n                            startIdx = this.parent.viewport.bottomIndex + 1;\n                            lastIdx = this.parent.viewport.bottomIndex + (this.parent.viewport.topIndex - prevTopIdx);\n                            lastIdx -= this.hiddenCount(prevTopIdx, this.parent.viewport.topIndex - 1);\n                            this.parent.viewport.topIndex = this.skipHiddenIdx(this.parent.viewport.topIndex, args.increase);\n                            if (lastIdx <= this.parent.viewport.bottomIndex) {\n                                return;\n                            }\n                            var indexes = this.parent.skipHidden(startIdx, lastIdx);\n                            startIdx = indexes[0];\n                            lastIdx = this.checkLastIdx(indexes[1], 'row');\n                            this.parent.viewport.bottomIndex = lastIdx;\n                            this.parent.renderModule.refreshUI({ colIndex: this.parent.viewport.leftIndex, rowIndex: startIdx, direction: 'first', refresh: 'RowPart' }, this.getRowAddress([startIdx, lastIdx]));\n                        }\n                        else {\n                            startIdx = this.parent.viewport.topIndex;\n                            lastIdx = startIdx + idxDiff - 1;\n                            var hiddenCount = this.hiddenCount(startIdx, lastIdx);\n                            var skippedHiddenIdx = this.skipHiddenIdx((this.parent.viewport.bottomIndex - ((lastIdx - startIdx) - hiddenCount)), args.increase);\n                            this.parent.viewport.bottomIndex -= ((idxDiff - hiddenCount) +\n                                (this.hiddenCount(skippedHiddenIdx, this.parent.viewport.bottomIndex)));\n                            startIdx = this.parent.skipHidden(startIdx, lastIdx)[0];\n                            this.parent.viewport.topIndex = startIdx;\n                            this.parent.renderModule.refreshUI({ colIndex: this.parent.viewport.leftIndex, rowIndex: startIdx, direction: 'last', refresh: 'RowPart' }, this.getRowAddress([startIdx, lastIdx]));\n                        }\n                    }\n                    else {\n                        this.parent.renderModule.refreshUI({\n                            rowIndex: this.parent.viewport.topIndex, colIndex: this.parent.viewport.leftIndex, refresh: 'Row'\n                        });\n                    }\n                    this.updateScrollCount(idx, 'row', threshold);\n                    this.parent.element.focus();\n                }\n            }\n            args.prev.idx = idx;\n        }\n    };\n    VirtualScroll.prototype.skipHiddenIdx = function (index, increase, layout, sheet) {\n        if (layout === void 0) { layout = 'rows'; }\n        if (sheet === void 0) { sheet = this.parent.getActiveSheet(); }\n        if ((sheet[layout])[index] && (sheet[layout])[index].hidden) {\n            increase ? index++ : index--;\n            index = this.skipHiddenIdx(index, increase, layout, sheet);\n        }\n        return index;\n    };\n    VirtualScroll.prototype.hiddenCount = function (startIdx, endIdx, layout) {\n        if (layout === void 0) { layout = 'rows'; }\n        var index = 0;\n        var sheet = this.parent.getActiveSheet();\n        for (var i = startIdx; i <= endIdx; i++) {\n            if ((sheet[layout])[i] && (sheet[layout])[i].hidden) {\n                index++;\n            }\n        }\n        return index;\n    };\n    VirtualScroll.prototype.checkLastIdx = function (idx, layout) {\n        if (this.parent.scrollSettings.isFinite) {\n            var count = this.parent.getActiveSheet()[layout + 'Count'] - 1;\n            if (idx > count) {\n                idx = count;\n            }\n        }\n        return idx;\n    };\n    VirtualScroll.prototype.onHorizontalScroll = function (args) {\n        var idx = args.cur.idx;\n        var width = args.cur.size;\n        var prevIdx = args.prev.idx;\n        var idxDiff = Math.abs(idx - prevIdx);\n        var threshold = this.parent.getThreshold('col');\n        if (idxDiff > Math.round(threshold / 2)) {\n            var startIdx = void 0;\n            var endIdx = void 0;\n            var prevLeftIdx = void 0;\n            if (idx <= threshold) {\n                if (!args.increase) {\n                    if (this.translateX && prevIdx > threshold) {\n                        this.translateX = 0;\n                        this.parent.viewport.leftIndex = prevIdx - threshold;\n                        if (!args.preventScroll) {\n                            if (idxDiff < this.parent.viewport.colCount + threshold) {\n                                endIdx = this.parent.viewport.leftIndex - 1;\n                                startIdx = this.parent.skipHidden(0, endIdx, 'columns')[0];\n                                this.parent.viewport.leftIndex = startIdx;\n                                var hiddenCount = this.hiddenCount(startIdx, endIdx, 'columns');\n                                var skippedHiddenIdx = this.skipHiddenIdx((this.parent.viewport.rightIndex - ((endIdx - startIdx + 1) - hiddenCount)), args.increase, 'columns');\n                                this.parent.viewport.rightIndex -= (((endIdx - startIdx + 1) - hiddenCount) +\n                                    (this.hiddenCount(skippedHiddenIdx, this.parent.viewport.rightIndex, 'columns')));\n                                this.parent.renderModule.refreshUI({ rowIndex: this.parent.viewport.topIndex, colIndex: startIdx, direction: 'last', refresh: 'ColumnPart',\n                                    skipUpdateOnFirst: true }, this.getColAddress([0, this.skipHiddenIdx(endIdx, false, 'columns')]));\n                            }\n                            else {\n                                this.parent.renderModule.refreshUI({ rowIndex: this.parent.viewport.topIndex, colIndex: 0, refresh: 'Column', skipUpdateOnFirst: true });\n                            }\n                            this.parent.element.focus();\n                        }\n                    }\n                    this.updateScrollCount(threshold, 'col');\n                }\n            }\n            if (prevIdx < threshold) {\n                idxDiff = Math.abs(idx - threshold);\n            }\n            if (idx > threshold) {\n                prevLeftIdx = this.parent.viewport.leftIndex;\n                this.parent.viewport.leftIndex = idx - threshold;\n                if (args.increase && prevLeftIdx > this.parent.viewport.leftIndex) {\n                    this.parent.viewport.leftIndex = prevLeftIdx;\n                    return;\n                }\n                this.translateX = width - this.getThresholdWidth(this.parent.viewport.leftIndex, threshold);\n                if (!args.preventScroll) {\n                    if (idxDiff < this.parent.viewport.colCount + threshold) {\n                        if (args.increase) {\n                            startIdx = this.parent.viewport.rightIndex + 1;\n                            endIdx = this.parent.viewport.rightIndex + (this.parent.viewport.leftIndex - prevLeftIdx);\n                            endIdx -= this.hiddenCount(prevLeftIdx, this.parent.viewport.leftIndex - 1, 'columns');\n                            this.parent.viewport.leftIndex = this.skipHiddenIdx(this.parent.viewport.leftIndex, args.increase, 'columns');\n                            if (endIdx <= this.parent.viewport.rightIndex) {\n                                return;\n                            }\n                            var indexes = this.parent.skipHidden(startIdx, endIdx, 'columns');\n                            startIdx = indexes[0];\n                            endIdx = this.checkLastIdx(indexes[1], 'col');\n                            this.parent.viewport.rightIndex = endIdx;\n                            this.parent.renderModule.refreshUI({ rowIndex: this.parent.viewport.topIndex, colIndex: startIdx, direction: 'first', refresh: 'ColumnPart' }, this.getColAddress([startIdx, endIdx]));\n                        }\n                        else {\n                            startIdx = this.parent.viewport.leftIndex;\n                            endIdx = startIdx + idxDiff - 1;\n                            var hiddenCount = this.hiddenCount(startIdx, endIdx, 'columns');\n                            var skippedHiddenIdx = this.skipHiddenIdx((this.parent.viewport.rightIndex - ((endIdx - startIdx) - hiddenCount)), args.increase, 'columns');\n                            this.parent.viewport.rightIndex -= ((idxDiff - hiddenCount) +\n                                (this.hiddenCount(skippedHiddenIdx, this.parent.viewport.rightIndex, 'columns')));\n                            startIdx = this.parent.skipHidden(startIdx, endIdx, 'columns')[0];\n                            this.parent.viewport.leftIndex = startIdx;\n                            this.parent.renderModule.refreshUI({ rowIndex: this.parent.viewport.topIndex, colIndex: startIdx, direction: 'last', refresh: 'ColumnPart' }, this.getColAddress([startIdx, endIdx]));\n                        }\n                    }\n                    else {\n                        this.parent.renderModule.refreshUI({\n                            rowIndex: this.parent.viewport.topIndex, colIndex: this.parent.viewport.leftIndex, refresh: 'Column'\n                        });\n                    }\n                    this.updateScrollCount(idx, 'col', threshold);\n                    this.parent.element.focus();\n                }\n            }\n            args.prev.idx = idx;\n        }\n    };\n    VirtualScroll.prototype.getThresholdHeight = function (idx, threshold) {\n        var height = 0;\n        var sheet = this.parent.getActiveSheet();\n        for (var i = idx; i < idx + threshold; i++) {\n            height += getRowHeight(sheet, i);\n        }\n        return height;\n    };\n    VirtualScroll.prototype.getThresholdWidth = function (idx, threshold) {\n        var width = 0;\n        var sheet = this.parent.getActiveSheet();\n        for (var i = idx; i < idx + threshold; i++) {\n            width += getColumnWidth(sheet, i);\n        }\n        return width;\n    };\n    VirtualScroll.prototype.translate = function (args) {\n        var sheet = this.parent.getActiveSheet();\n        if (args.refresh === 'Row' || args.refresh === 'RowPart') {\n            this.content.style.transform = \"translate(\" + this.translateX + \"px, \" + this.translateY + \"px)\";\n            if (sheet.showHeaders) {\n                this.rowHeader.style.transform = \"translate(0px, \" + this.translateY + \"px)\";\n            }\n        }\n        if (args.refresh === 'Column' || args.refresh === 'ColumnPart') {\n            var translateX = this.parent.enableRtl ? -this.translateX : this.translateX;\n            this.content.style.transform = \"translate(\" + translateX + \"px, \" + this.translateY + \"px)\";\n            if (sheet.showHeaders) {\n                this.colHeader.style.transform = \"translate(\" + translateX + \"px, 0px)\";\n            }\n        }\n    };\n    VirtualScroll.prototype.updateColumnWidth = function (args) {\n        if (args.refresh === 'Column') {\n            this.content.style.width = '';\n            var width = getColumnsWidth(this.parent.getActiveSheet(), this.parent.viewport.leftIndex, this.parent.viewport.rightIndex);\n            if (this.parent.getActiveSheet().showHeaders) {\n                this.colHeader.style.width = width + 'px';\n            }\n            this.content.style.width = width + 'px';\n        }\n    };\n    VirtualScroll.prototype.updateUsedRange = function (args) {\n        if (!this.scroll.length) {\n            return;\n        }\n        var sheet = this.parent.getActiveSheet();\n        if (args.update === 'row') {\n            if (args.index !== this.scroll[this.parent.activeSheetIndex].rowCount - 1) {\n                var height = this.getVTrackHeight('height');\n                if (args.index >= this.scroll[this.parent.activeSheetIndex].rowCount) {\n                    height += getRowsHeight(sheet, this.scroll[this.parent.activeSheetIndex].rowCount, args.index);\n                }\n                else {\n                    height -= getRowsHeight(sheet, args.index + 1, this.scroll[this.parent.activeSheetIndex].rowCount - 1);\n                }\n                this.scroll[this.parent.activeSheetIndex].rowCount = args.index + 1;\n                this.updateVTrack(this.rowHeader, height, 'height');\n                if (this.scroll[this.parent.activeSheetIndex].rowCount > sheet.rowCount) {\n                    this.parent.setSheetPropertyOnMute(sheet, 'rowCount', this.scroll[this.parent.activeSheetIndex].rowCount);\n                }\n            }\n        }\n        else {\n            if (args.index > this.scroll[this.parent.activeSheetIndex].colCount) {\n                var width = this.getVTrackHeight('width');\n                width += getColumnsWidth(sheet, this.scroll[this.parent.activeSheetIndex].colCount, args.index);\n                this.scroll[this.parent.activeSheetIndex].colCount = args.index + 1;\n                this.updateVTrack(this.colHeader, width, 'width');\n                if (this.scroll[this.parent.activeSheetIndex].colCount > sheet.colCount) {\n                    this.parent.setSheetPropertyOnMute(sheet, 'colCount', this.scroll[this.parent.activeSheetIndex].colCount);\n                }\n            }\n        }\n    };\n    VirtualScroll.prototype.createHeaderElement = function (args) {\n        this.rowHeader = this.content.cloneNode();\n        this.colHeader = this.rowHeader.cloneNode();\n        this.rowHeader.style.width = '';\n        this.rowHeader.style.transform = \"translate(0px, \" + this.translateY + \"px)\";\n        this.colHeader.style.transform = \"translate(\" + (this.parent.enableRtl ? -this.translateX : this.translateX) + \"px, 0px)\";\n        this.rowHeader.appendChild(args.element.querySelector('table'));\n        args.element.appendChild(this.rowHeader);\n        var container = this.parent.getColumnHeaderContent();\n        this.colHeader.appendChild(container.querySelector('table'));\n        container.appendChild(this.colHeader);\n        var rowVTrack = this.content.nextElementSibling.cloneNode();\n        var colVTrack = rowVTrack.cloneNode();\n        rowVTrack.style.width = '';\n        colVTrack.style.height = '';\n        args.element.appendChild(rowVTrack);\n        container.appendChild(colVTrack);\n    };\n    VirtualScroll.prototype.getVTrackHeight = function (str) {\n        var height = this.content.nextElementSibling.style[str];\n        if (height.includes('e+')) {\n            height = height.split('px')[0];\n            var heightArr = height.split('e+');\n            return Number(heightArr[0]) * Math.pow(10, Number(heightArr[1]));\n        }\n        else {\n            return parseInt(height, 10);\n        }\n    };\n    VirtualScroll.prototype.updateVTrackHeight = function (args) {\n        var domCount = this.parent.viewport.rowCount + 1 + (this.parent.getThreshold('row') * 2);\n        if (args.rowIdx >= domCount && args.rowIdx < this.scroll[this.parent.activeSheetIndex].rowCount) {\n            this.updateVTrack(this.rowHeader, this.getVTrackHeight('height') + args.threshold, 'height');\n        }\n    };\n    VirtualScroll.prototype.updateVTrackWidth = function (args) {\n        if (args.colIdx >= this.parent.viewport.leftIndex && args.colIdx <= this.parent.viewport.rightIndex) {\n            if (this.parent.getActiveSheet().showHeaders) {\n                var hdrVTrack = this.parent.getColumnHeaderContent().getElementsByClassName('e-virtualtrack')[0];\n                hdrVTrack.style.width = parseInt(hdrVTrack.style.width, 10) + args.threshold + 'px';\n            }\n            var cntVTrack = this.parent.getMainContent().getElementsByClassName('e-virtualtrack')[0];\n            cntVTrack.style.width = parseInt(cntVTrack.style.width, 10) + args.threshold + 'px';\n            if (this.parent.getActiveSheet().showHeaders) {\n                var hdrColumn = this.parent.getColumnHeaderContent().getElementsByClassName('e-virtualable')[0];\n                hdrColumn.style.width = parseInt(hdrColumn.style.width, 10) + args.threshold + 'px';\n            }\n            var cntColumn = this.parent.getMainContent().getElementsByClassName('e-virtualable')[0];\n            cntColumn.style.width = parseInt(cntColumn.style.width, 10) + args.threshold + 'px';\n        }\n    };\n    VirtualScroll.prototype.updateVTrack = function (header, size, sizeStr) {\n        if (this.parent.getActiveSheet().showHeaders) {\n            header.nextElementSibling.style[sizeStr] = size + \"px\";\n        }\n        this.content.nextElementSibling.style[sizeStr] = size + \"px\";\n    };\n    VirtualScroll.prototype.deInitProps = function () {\n        this.parent.viewport.leftIndex = null;\n        this.parent.viewport.topIndex = null;\n        this.parent.viewport.bottomIndex = null;\n        this.translateX = null;\n        this.translateY = null;\n    };\n    VirtualScroll.prototype.updateScrollProps = function (args) {\n        var _this = this;\n        if (args === void 0) { args = { sheetIndex: 0, sheets: this.parent.sheets }; }\n        if (this.scroll.length === 0) {\n            this.initScroll();\n        }\n        else {\n            args.sheets.forEach(function () { _this.scroll.splice(args.sheetIndex, 0, { rowCount: 0, colCount: 0 }); });\n        }\n    };\n    VirtualScroll.prototype.sliceScrollProps = function (args) {\n        if (isNullOrUndefined(args.sheetIndex)) {\n            this.scroll.length = 0;\n        }\n        else {\n            this.scroll.splice(args.sheetIndex, 1);\n        }\n    };\n    VirtualScroll.prototype.addEventListener = function () {\n        this.parent.on(beforeContentLoaded, this.createVirtualElement, this);\n        this.parent.on(beforeVirtualContentLoaded, this.translate, this);\n        this.parent.on(virtualContentLoaded, this.updateColumnWidth, this);\n        this.parent.on(updateTableWidth, this.updateColumnWidth, this);\n        this.parent.on(onVerticalScroll, this.onVerticalScroll, this);\n        this.parent.on(onHorizontalScroll, this.onHorizontalScroll, this);\n        this.parent.on(updateUsedRange, this.updateUsedRange, this);\n        this.parent.on(rowHeightChanged, this.updateVTrackHeight, this);\n        this.parent.on(colWidthChanged, this.updateVTrackWidth, this);\n        this.parent.on(beforeHeaderLoaded, this.createHeaderElement, this);\n        this.parent.on(deInitProperties, this.deInitProps, this);\n        this.parent.on(sheetsDestroyed, this.sliceScrollProps, this);\n        this.parent.on(sheetCreated, this.updateScrollProps, this);\n        this.parent.on(spreadsheetDestroyed, this.destroy, this);\n    };\n    VirtualScroll.prototype.destroy = function () {\n        this.removeEventListener();\n        this.rowHeader = null;\n        this.colHeader = null;\n        this.content = null;\n        this.parent = null;\n        this.scroll.length = 0;\n        this.translateX = null;\n        this.translateY = null;\n    };\n    VirtualScroll.prototype.removeEventListener = function () {\n        this.parent.off(beforeContentLoaded, this.createVirtualElement);\n        this.parent.off(beforeVirtualContentLoaded, this.translate);\n        this.parent.off(virtualContentLoaded, this.updateColumnWidth);\n        this.parent.off(updateTableWidth, this.updateColumnWidth);\n        this.parent.off(onVerticalScroll, this.onVerticalScroll);\n        this.parent.off(onHorizontalScroll, this.onHorizontalScroll);\n        this.parent.off(updateUsedRange, this.updateUsedRange);\n        this.parent.off(rowHeightChanged, this.updateVTrackHeight);\n        this.parent.off(colWidthChanged, this.updateVTrackWidth);\n        this.parent.off(beforeHeaderLoaded, this.createHeaderElement);\n        this.parent.off(sheetsDestroyed, this.sliceScrollProps);\n        this.parent.off(sheetCreated, this.updateScrollProps);\n        this.parent.off(spreadsheetDestroyed, this.destroy);\n    };\n    return VirtualScroll;\n}());\nexport { VirtualScroll };\n","import { keyDown, cellNavigate, renameSheet, filterCellKeyDown } from '../common/index';\nimport { getCellIndexes, getRangeAddress, getRowHeight, getColumnWidth, getCell } from '../../workbook/index';\nimport { closest } from '@syncfusion/ej2-base';\n/**\n * Represents keyboard navigation support for Spreadsheet.\n */\nvar KeyboardNavigation = /** @class */ (function () {\n    /**\n     * Constructor for the Spreadsheet Keyboard Navigation module.\n     * @private\n     */\n    function KeyboardNavigation(parent) {\n        this.parent = parent;\n        this.addEventListener();\n        /* code snippet */\n    }\n    KeyboardNavigation.prototype.addEventListener = function () {\n        this.parent.on(keyDown, this.keyDownHandler, this);\n        /* code snippet */\n    };\n    KeyboardNavigation.prototype.removeEventListener = function () {\n        if (!this.parent.isDestroyed) {\n            this.parent.off(keyDown, this.keyDownHandler);\n        }\n        /* code snippet */\n    };\n    KeyboardNavigation.prototype.keyDownHandler = function (e) {\n        if (!this.parent.isEdit && (document.activeElement.classList.contains('e-spreadsheet') ||\n            closest(document.activeElement, '.e-sheet'))) {\n            var isNavigate = void 0;\n            var scrollIdxes = void 0;\n            var isRtl = this.parent.enableRtl;\n            var sheet = this.parent.getActiveSheet();\n            var filterArgs = { e: e, isFilterCell: false };\n            var actIdxes = getCellIndexes(this.parent.getActiveSheet().activeCell);\n            if ([9, 37, 38, 39, 40].indexOf(e.keyCode) > -1) {\n                e.preventDefault();\n            }\n            if (!e.shiftKey && e.altKey && (e.keyCode === 38 || e.keyCode === 40)) {\n                this.parent.notify(filterCellKeyDown, filterArgs);\n            }\n            if ((!e.shiftKey && ((!isRtl && e.keyCode === 37) || (isRtl && e.keyCode === 39)))\n                || (e.shiftKey && e.keyCode === 9)) { //left key\n                if (actIdxes[1] > 0) {\n                    actIdxes[1] -= 1;\n                    isNavigate = true;\n                }\n                else {\n                    var content = this.parent.getMainContent();\n                    if (actIdxes[1] === 0 && content.scrollLeft && !isRtl) {\n                        content.scrollLeft = 0;\n                    }\n                }\n            }\n            else if ((!filterArgs.isFilterCell && !e.shiftKey && e.keyCode === 38) || (e.shiftKey && e.keyCode === 13)) { // Up key\n                if (actIdxes[0] > 0) {\n                    actIdxes[0] -= 1;\n                    isNavigate = true;\n                }\n                else {\n                    var content = this.parent.getMainContent();\n                    if (actIdxes[0] === 0 && content.scrollTop) {\n                        content.scrollTop = 0;\n                    }\n                }\n            }\n            else if ((!e.shiftKey && ((!isRtl && e.keyCode === 39) || (isRtl && e.keyCode === 37))) || e.keyCode === 9) { // Right key\n                var cell = getCell(actIdxes[0], actIdxes[1], sheet);\n                if (cell && cell.colSpan > 1) {\n                    actIdxes[1] += (cell.colSpan - 1);\n                }\n                if (actIdxes[1] < sheet.colCount - 1) {\n                    actIdxes[1] += 1;\n                    isNavigate = true;\n                }\n            }\n            else if ((!filterArgs.isFilterCell && !e.shiftKey && e.keyCode === 40) || e.keyCode === 13) { // Down Key\n                var cell = getCell(actIdxes[0], actIdxes[1], sheet);\n                if (cell && cell.rowSpan > 1) {\n                    actIdxes[0] += (cell.rowSpan - 1);\n                }\n                if (actIdxes[0] < sheet.rowCount - 1) {\n                    actIdxes[0] += 1;\n                    isNavigate = true;\n                }\n            }\n            /* else if (e.keyCode === 36) {\n                actIdxes[1] = 0;\n                if (e.ctrlKey) {\n                    actIdxes[0] = 0;\n                }\n                isNavigate = true;\n                e.preventDefault();\n            } else if (e.keyCode === 35 && e.ctrlKey) {\n                actIdxes = [sheet.usedRange.rowIndex, sheet.usedRange.colIndex];\n                scrollIdxes = [sheet.usedRange.rowIndex - this.parent.viewport.rowCount,\n                    sheet.usedRange.colIndex - this.parent.viewport.colCount];\n                isNavigate = true;\n                e.preventDefault();\n            } */\n            if (isNavigate) {\n                this.scrollNavigation(scrollIdxes || actIdxes, scrollIdxes ? true : false);\n                this.parent.setSheetPropertyOnMute(sheet, 'activeCell', getRangeAddress(actIdxes));\n                this.parent.notify(cellNavigate, { range: actIdxes });\n            }\n        }\n        var target = e.target;\n        if (target.classList.contains('e-sheet-rename')) {\n            if (e.keyCode === 32) {\n                e.stopPropagation();\n            }\n            else if (e.keyCode === 13 || e.keyCode === 27) {\n                this.parent.notify(renameSheet, e);\n            }\n        }\n    };\n    KeyboardNavigation.prototype.scrollNavigation = function (actIdxes, isScroll) {\n        var x = this.parent.enableRtl ? -1 : 1;\n        var cont = this.parent.getMainContent();\n        var sheet = this.parent.getActiveSheet();\n        var prevActIdxes = getCellIndexes(sheet.activeCell);\n        var topLeftIdxes = getCellIndexes(sheet.topLeftCell);\n        if (this.getBottomIdx(topLeftIdxes) <= actIdxes[0] || isScroll) {\n            cont.scrollTop += getRowHeight(sheet, actIdxes[0]);\n        }\n        else if (topLeftIdxes[0] > actIdxes[0]) {\n            cont.scrollTop -= getRowHeight(sheet, actIdxes[0]);\n        }\n        if (this.getRightIdx(topLeftIdxes) <= actIdxes[1] || isScroll) {\n            cont.scrollLeft += getColumnWidth(sheet, actIdxes[1]) * x;\n        }\n        else if (topLeftIdxes[1] > actIdxes[1]) {\n            cont.scrollLeft -= getColumnWidth(sheet, actIdxes[1]) * x;\n        }\n    };\n    KeyboardNavigation.prototype.getBottomIdx = function (topLeftIdxes) {\n        var hgt = 0;\n        var sheet = this.parent.getActiveSheet();\n        for (var i = topLeftIdxes[0];; i++) {\n            hgt += getRowHeight(sheet, i);\n            if (hgt >= this.parent.viewport.height - 17) {\n                return i;\n            }\n        }\n    };\n    KeyboardNavigation.prototype.getRightIdx = function (topLeftIdxes) {\n        var width = 0;\n        var sheet = this.parent.getActiveSheet();\n        var contWidth = this.parent.getMainContent().offsetWidth;\n        for (var i = topLeftIdxes[1];; i++) {\n            width += getColumnWidth(sheet, i);\n            if (width >= contWidth - 17) {\n                return i;\n            }\n        }\n    };\n    /**\n     * For internal use only - Get the module name.\n     * @private\n     */\n    KeyboardNavigation.prototype.getModuleName = function () {\n        return 'keyboardNavigation';\n    };\n    KeyboardNavigation.prototype.destroy = function () {\n        this.removeEventListener();\n        this.parent = null;\n    };\n    return KeyboardNavigation;\n}());\nexport { KeyboardNavigation };\n","import { keyDown, cut, paste, copy, clearCopy, performUndoRedo, initiateHyperlink, editHyperlink } from '../common/index';\nimport { findDlg, gotoDlg } from '../common/index';\nimport { setCellFormat, textDecorationUpdate, getCellIndexes } from '../../workbook/common/index';\nimport { getColumn, isLocked as isCellLocked } from '../../workbook/index';\nimport { setCell, getCell } from '../../workbook/base/cell';\nimport { isNullOrUndefined, closest, select } from '@syncfusion/ej2-base';\n/**\n * Represents keyboard shortcut support for Spreadsheet.\n */\nvar KeyboardShortcut = /** @class */ (function () {\n    /**\n     * Constructor for the Spreadsheet Keyboard Shortcut module.\n     * @private\n     */\n    function KeyboardShortcut(parent) {\n        this.parent = parent;\n        this.addEventListener();\n    }\n    KeyboardShortcut.prototype.addEventListener = function () {\n        this.parent.on(keyDown, this.keyDownHandler, this);\n    };\n    KeyboardShortcut.prototype.removeEventListener = function () {\n        if (!this.parent.isDestroyed) {\n            this.parent.off(keyDown, this.keyDownHandler);\n        }\n    };\n    KeyboardShortcut.prototype.keyDownHandler = function (e) {\n        if (e.ctrlKey || e.metaKey) {\n            if (!closest(e.target, '.e-find-dlg')) {\n                if ([79, 83, 65].indexOf(e.keyCode) > -1) {\n                    e.preventDefault();\n                }\n            }\n            if (e.keyCode === 79) {\n                select('#' + this.parent.element.id + '_fileUpload', this.parent.element).click();\n            }\n            else if (e.keyCode === 83) {\n                if (this.parent.saveUrl && this.parent.allowSave) {\n                    this.parent.save();\n                }\n            }\n            else if (e.keyCode === 67) {\n                this.parent.notify(copy, { promise: Promise });\n            }\n            else if (e.keyCode === 75) {\n                var sheet = this.parent.getActiveSheet();\n                var indexes = getCellIndexes(sheet.activeCell);\n                var row = this.parent.sheets[this.parent.getActiveSheet().id - 1].rows[indexes[0]];\n                var cell = void 0;\n                e.preventDefault();\n                if (!isNullOrUndefined(row)) {\n                    cell = row.cells[indexes[1]];\n                }\n                if (isNullOrUndefined(cell)) {\n                    setCell(indexes[0], indexes[1], this.parent.getActiveSheet(), cell, false);\n                }\n                if (cell && cell.hyperlink) {\n                    this.parent.notify(editHyperlink, null);\n                }\n                else {\n                    this.parent.notify(initiateHyperlink, null);\n                }\n            }\n            else if (e.keyCode === 90) { /* Ctrl + Z */\n                if (!this.parent.isEdit) {\n                    e.preventDefault();\n                    this.parent.notify(performUndoRedo, { isUndo: true });\n                }\n            }\n            else if (e.keyCode === 89) { /* Ctrl + Y */\n                if (!this.parent.isEdit) {\n                    e.preventDefault();\n                    this.parent.notify(performUndoRedo, { isUndo: false });\n                }\n            }\n            var actSheet = this.parent.sheets[this.parent.getActiveSheet().id - 1];\n            var actCell = actSheet.activeCell;\n            var actCellIndex = getCellIndexes(actCell);\n            var cellObj = getCell(actCellIndex[0], actCellIndex[1], actSheet);\n            var isLocked = actSheet.isProtected && isCellLocked(cellObj, getColumn(actSheet, actCellIndex[1]));\n            if (!isLocked || !actSheet.isProtected) {\n                if (e.keyCode === 70) {\n                    e.preventDefault();\n                    var toolBarElem = document.querySelector('.e-spreadsheet-find-ddb');\n                    if (!isNullOrUndefined(toolBarElem)) {\n                        toolBarElem.click();\n                    }\n                }\n                else if (e.keyCode === 71) {\n                    e.preventDefault();\n                    this.parent.notify(gotoDlg, null);\n                }\n                else if (e.keyCode === 72) {\n                    e.preventDefault();\n                    this.parent.notify(findDlg, null);\n                }\n                else if (e.keyCode === 88) {\n                    this.parent.notify(cut, { promise: Promise });\n                }\n                else if (e.keyCode === 86) {\n                    if (!isLocked) {\n                        this.parent.notify(paste, { isAction: true });\n                    }\n                }\n                else if (e.keyCode === 66) {\n                    e.preventDefault();\n                    var value = this.parent.getCellStyleValue(['fontWeight'], getCellIndexes(this.parent.getActiveSheet().activeCell)).fontWeight;\n                    value = value === 'bold' ? 'normal' : 'bold';\n                    this.parent.notify(setCellFormat, { style: { fontWeight: value }, onActionUpdate: true, refreshRibbon: true });\n                }\n                else if (e.keyCode === 73) {\n                    e.preventDefault();\n                    var value = this.parent.getCellStyleValue(['fontStyle'], getCellIndexes(this.parent.getActiveSheet().activeCell)).fontStyle;\n                    value = value === 'italic' ? 'normal' : 'italic';\n                    this.parent.notify(setCellFormat, { style: { fontStyle: value }, onActionUpdate: true, refreshRibbon: true });\n                }\n                else if (e.keyCode === 85) {\n                    e.preventDefault();\n                    this.parent.notify(textDecorationUpdate, { style: { textDecoration: 'underline' }, refreshRibbon: true });\n                }\n                else if (e.keyCode === 53) {\n                    e.preventDefault();\n                    this.parent.notify(textDecorationUpdate, { style: { textDecoration: 'line-through' }, refreshRibbon: true });\n                }\n                if (e.shiftKey) {\n                    if (e.keyCode === 76) { /* Ctrl + Shift + L */\n                        if (!this.parent.isEdit) {\n                            e.preventDefault();\n                            this.parent.applyFilter();\n                        }\n                    }\n                }\n            }\n        }\n        if (e.keyCode === 27) {\n            this.parent.notify(clearCopy, null);\n        }\n    };\n    KeyboardShortcut.prototype.getModuleName = function () {\n        return 'keyboardShortcut';\n    };\n    KeyboardShortcut.prototype.destroy = function () {\n        this.removeEventListener();\n        this.parent = null;\n    };\n    return KeyboardShortcut;\n}());\nexport { KeyboardShortcut };\n","import { clearViewer, beginAction } from '../../spreadsheet/index';\nimport { rowHeightChanged, setRowEleHeight, setMaxHgt, getTextHeight, getMaxHgt, getLines, initialLoad } from '../common/index';\nimport { getRowHeight, applyCellFormat } from '../../workbook/index';\nimport { isHiddenRow, getCell, getColumnWidth, getRangeIndexes, getSheetIndex, clearCFRule } from '../../workbook/index';\nimport { wrapEvent, getRangeAddress, clear } from '../../workbook/index';\nimport { removeClass, isNullOrUndefined } from '@syncfusion/ej2-base';\n/**\n * CellFormat module allows to format the cell styles.\n */\nvar CellFormat = /** @class */ (function () {\n    function CellFormat(parent) {\n        this.checkHeight = false;\n        this.parent = parent;\n        this.row = parent.createElement('tr', { className: 'e-row' });\n        this.parent.on(initialLoad, this.addEventListener, this);\n    }\n    CellFormat.prototype.applyCellFormat = function (args) {\n        var keys = Object.keys(args.style);\n        var sheet = this.parent.getActiveSheet();\n        if (args.lastCell && getMaxHgt(sheet, args.rowIdx) <= 20 && !keys.length) {\n            return;\n        }\n        var cell = args.cell || this.parent.getCell(args.rowIdx, args.colIdx);\n        if (cell) {\n            if (args.style.border !== undefined || args.style.borderTop !== undefined || args.style.borderLeft !== undefined) {\n                var curStyle_1 = {};\n                Object.keys(args.style).forEach(function (key) { curStyle_1[key] = args.style[key]; });\n                if (curStyle_1.border !== undefined) {\n                    Object.assign(cell.style, { borderRight: args.style.border, borderBottom: args.style.border });\n                    this.setLeftBorder(args.style.border, cell, args.rowIdx, args.colIdx, args.row, args.onActionUpdate, args.first);\n                    this.setTopBorder(args.style.border, cell, args.rowIdx, args.colIdx, args.pRow, args.pHRow, args.onActionUpdate, args.first, args.lastCell, args.manualUpdate);\n                    delete curStyle_1.border;\n                }\n                if (curStyle_1.borderTop !== undefined) {\n                    this.setTopBorder(args.style.borderTop, cell, args.rowIdx, args.colIdx, args.pRow, args.pHRow, args.onActionUpdate, args.first, args.lastCell, args.manualUpdate);\n                    delete curStyle_1.borderTop;\n                }\n                if (curStyle_1.borderLeft !== undefined) {\n                    this.setLeftBorder(args.style.borderLeft, cell, args.rowIdx, args.colIdx, args.row, args.onActionUpdate, args.first);\n                    delete curStyle_1.borderLeft;\n                }\n                if (Object.keys(curStyle_1).length) {\n                    if (curStyle_1.borderBottom !== undefined) {\n                        this.setThickBorderHeight(curStyle_1.borderBottom, args.rowIdx, args.colIdx, cell, args.row, args.hRow, args.onActionUpdate, args.lastCell, args.manualUpdate);\n                    }\n                    Object.assign(cell.style, curStyle_1);\n                }\n            }\n            else {\n                if (args.style.borderBottom !== undefined) {\n                    this.setThickBorderHeight(args.style.borderBottom, args.rowIdx, args.colIdx, cell, args.row, args.hRow, args.onActionUpdate, args.lastCell, args.manualUpdate);\n                }\n                Object.assign(cell.style, args.style);\n            }\n            if (args.isHeightCheckNeeded) {\n                if (!sheet.rows[args.rowIdx] || !sheet.rows[args.rowIdx].customHeight) {\n                    if (!args.manualUpdate) {\n                        var cellModel = getCell(args.rowIdx, args.colIdx, sheet);\n                        if (!(cellModel && cellModel.wrap) && this.isHeightCheckNeeded(args.style)) {\n                            setMaxHgt(sheet, args.rowIdx, args.colIdx, getTextHeight(this.parent, args.style));\n                        }\n                        if (args.lastCell) {\n                            var height = getMaxHgt(sheet, args.rowIdx);\n                            if (height > 20 && height > getRowHeight(sheet, args.rowIdx)) {\n                                setRowEleHeight(this.parent, sheet, height, args.rowIdx, args.row, args.hRow, false);\n                            }\n                        }\n                    }\n                    else {\n                        if (!this.checkHeight) {\n                            this.checkHeight = this.isHeightCheckNeeded(args.style, args.onActionUpdate);\n                        }\n                        var isFontSize = false;\n                        if (args.style.fontSize) {\n                            isFontSize = true;\n                        }\n                        if (cell && cell.children[0] && cell.children[0].className === 'e-cf-databar' && args.style.fontSize) {\n                            cell.children[0].querySelector('.e-databar-value').style.fontSize = args.style.fontSize;\n                        }\n                        this.updateRowHeight(args.rowIdx, args.colIdx, args.lastCell, args.onActionUpdate, 0, isFontSize);\n                    }\n                }\n            }\n        }\n        else {\n            this.updateRowHeight(args.rowIdx, args.colIdx, true, args.onActionUpdate);\n        }\n    };\n    CellFormat.prototype.updateRowHeight = function (rowIdx, colIdx, isLastCell, onActionUpdate, borderSize, isFontSize) {\n        if (borderSize === void 0) { borderSize = 0; }\n        if (this.checkHeight) {\n            var hgt = 0;\n            var maxHgt = void 0;\n            var sheet = this.parent.getActiveSheet();\n            var cell = getCell(rowIdx, colIdx, sheet);\n            var td = this.parent.getCell(rowIdx, colIdx);\n            hgt = getTextHeight(this.parent, (cell && cell.style) || this.parent.cellStyle, (cell && cell.wrap) ?\n                getLines(this.parent.getDisplayText(cell), getColumnWidth(sheet, colIdx), cell.style, this.parent.cellStyle) : 1);\n            if (cell && !isNullOrUndefined(cell.value)) {\n                var val = cell.value.toString();\n                if (val.indexOf('\\n') > -1) {\n                    var i = void 0;\n                    var splitVal = cell.value.split('\\n');\n                    var n = 0;\n                    var valLength = splitVal.length;\n                    for (i = 0; i < valLength; i++) {\n                        var lines = getLines(splitVal[i], getColumnWidth(sheet, colIdx), cell.style, this.parent.cellStyle);\n                        if (lines === 0) {\n                            lines = 1; // for empty new line\n                        }\n                        n = n + lines;\n                    }\n                    hgt = getTextHeight(this.parent, cell.style || this.parent.cellStyle, n) + 1;\n                }\n            }\n            if (hgt + borderSize < 20 && isFontSize && getMaxHgt(sheet, rowIdx) >= 20) {\n                hgt = 20; // default height\n            }\n            if (td && td.children[0] && td.children[0].className === 'e-cf-databar') {\n                td.children[0].style.height = '100%';\n                td.children[0].firstElementChild.nextElementSibling.style.height = '100%';\n            }\n            setMaxHgt(sheet, rowIdx, colIdx, hgt + borderSize);\n            if (isLastCell) {\n                this.checkHeight = false;\n                var row = this.parent.getRow(rowIdx);\n                if (!row) {\n                    return;\n                }\n                var prevHeight = getRowHeight(sheet, rowIdx);\n                maxHgt = getMaxHgt(sheet, rowIdx);\n                var heightChanged = onActionUpdate ? maxHgt !== prevHeight : maxHgt > prevHeight;\n                if (heightChanged) {\n                    setRowEleHeight(this.parent, sheet, maxHgt, rowIdx, row);\n                }\n            }\n        }\n    };\n    CellFormat.prototype.isHeightCheckNeeded = function (style, onActionUpdate) {\n        var keys = Object.keys(style);\n        return (onActionUpdate ? keys.indexOf('fontSize') > -1 : keys.indexOf('fontSize') > -1\n            && Number(style.fontSize.split('pt')[0]) > 12) || keys.indexOf('fontFamily') > -1;\n    };\n    CellFormat.prototype.setLeftBorder = function (border, cell, rowIdx, colIdx, row, actionUpdate, first) {\n        if (first && first.includes('Column')) {\n            return;\n        }\n        for (var j = 0; j < cell.rowSpan; j++) {\n            var prevCell = this.parent.getCell(rowIdx + j, colIdx - 1, row);\n            var i = 1;\n            while (prevCell && prevCell.style.display === 'none') {\n                prevCell = this.parent.getCell(rowIdx + j, colIdx - 1 - i, row);\n                i++;\n            }\n            if (prevCell) {\n                if (actionUpdate && border !== '' && colIdx === this.parent.viewport.leftIndex) {\n                    this.parent.getMainContent().scrollLeft -= this.getBorderSize(border);\n                }\n                prevCell.style.borderRight = (border === 'none') ? prevCell.style.borderRight : border;\n            }\n            else {\n                cell.style.borderLeft = border;\n            }\n        }\n    };\n    CellFormat.prototype.setTopBorder = function (border, cell, rowIdx, colIdx, pRow, pHRow, actionUpdate, first, lastCell, manualUpdate) {\n        if (first && first.includes('Row')) {\n            return;\n        }\n        for (var j = 0; j < cell.colSpan; j++) {\n            var prevCell = this.parent.getCell(rowIdx - 1, colIdx + j, pRow);\n            if (prevCell) {\n                if (isHiddenRow(this.parent.getActiveSheet(), rowIdx - 1)) {\n                    var index = [Number(prevCell.parentElement.getAttribute('aria-rowindex')) - 1, colIdx];\n                    if (this.parent.getCellStyleValue(['bottomPriority'], index).bottomPriority) {\n                        return;\n                    }\n                }\n                if (actionUpdate && border !== '' && this.parent.getActiveSheet().topLeftCell.includes(\"\" + (rowIdx + 1))) {\n                    this.parent.getMainContent().scrollTop -= this.getBorderSize(border);\n                }\n                this.setThickBorderHeight(border, rowIdx - 1, colIdx + j, prevCell, pRow, pHRow, actionUpdate, lastCell, manualUpdate);\n                prevCell.style.borderBottom = (border === 'none') ? prevCell.style.borderBottom : border;\n            }\n            else {\n                cell.style.borderTop = border;\n            }\n        }\n    };\n    CellFormat.prototype.setThickBorderHeight = function (border, rowIdx, colIdx, cell, row, hRow, actionUpdate, lastCell, manualUpdate) {\n        var size = border ? this.getBorderSize(border) : 1;\n        var sheet = this.parent.getActiveSheet();\n        if (size > 2 && (!sheet.rows[rowIdx] || !sheet.rows[rowIdx].customHeight)) {\n            if (manualUpdate) {\n                if (!this.checkHeight) {\n                    this.checkHeight = true;\n                }\n                this.updateRowHeight(rowIdx, colIdx, lastCell, actionUpdate, size);\n            }\n            else {\n                var prevHeight = getRowHeight(sheet, rowIdx);\n                var height = Math.ceil(this.parent.calculateHeight(this.parent.getCellStyleValue(['fontFamily', 'fontSize'], [rowIdx, colIdx]), 1, 3));\n                if (height > prevHeight) {\n                    setRowEleHeight(this.parent, sheet, height, rowIdx, row, hRow, false);\n                    this.parent.notify(rowHeightChanged, { rowIdx: rowIdx, threshold: height - 20 });\n                }\n            }\n        }\n        if (actionUpdate && (lastCell || !this.checkHeight) && size < 3 && (!sheet.rows[rowIdx] || !sheet.rows[rowIdx].customHeight)) {\n            if (!this.checkHeight) {\n                this.checkHeight = true;\n            }\n            this.updateRowHeight(rowIdx, colIdx, lastCell, actionUpdate, size);\n        }\n    };\n    CellFormat.prototype.getBorderSize = function (border) {\n        var size = border.split(' ')[0];\n        return size === 'thin' ? 1 : (size === 'medium' ? 2 : (size === 'thick' ? 3 :\n            (parseInt(size, 10) ? parseInt(size, 10) : 1)));\n    };\n    CellFormat.prototype.clearObj = function (args) {\n        var options = args.options;\n        var range = options.range ? (options.range.indexOf('!') > 0) ? options.range.split('!')[1] : options.range.split('!')[0]\n            : this.parent.getActiveSheet().selectedRange;\n        var sheetIndex = (options.range && options.range.indexOf('!') > 0) ?\n            getSheetIndex(this.parent, options.range.split('!')[0]) : this.parent.activeSheetIndex;\n        var rangeIdx = getRangeIndexes(range);\n        var sheet = this.parent.sheets[sheetIndex];\n        var sRIdx = rangeIdx[0];\n        var eRIdx = rangeIdx[2];\n        var sCIdx;\n        var eCIdx;\n        var eventArgs = { range: range, type: options.type, requestType: 'clear', sheetIndex: sheetIndex };\n        if (!args.isPublic) {\n            this.parent.notify(beginAction, { action: 'beforeClear', eventArgs: eventArgs });\n        }\n        if (options.type === 'Clear Formats' || options.type === 'Clear All') {\n            this.parent.notify(clearCFRule, { range: range, isPublic: false });\n            for (sRIdx; sRIdx <= eRIdx; sRIdx++) {\n                sCIdx = rangeIdx[1];\n                eCIdx = rangeIdx[3];\n                for (sCIdx; sCIdx <= eCIdx; sCIdx++) {\n                    var cell = getCell(sRIdx, sCIdx, sheet);\n                    var cellElem = this.parent.getCell(sRIdx, sCIdx);\n                    if (cell) {\n                        if (cell.wrap) {\n                            this.parent.notify(wrapEvent, { range: [sRIdx, sCIdx, sRIdx, sCIdx], wrap: false, sheet: sheet });\n                        }\n                        if (cell.hyperlink) {\n                            removeClass(cellElem.querySelectorAll('.e-hyperlink'), 'e-hyperlink-style');\n                            if (options.type === 'Clear All') {\n                                this.parent.removeHyperlink(getRangeAddress([sRIdx, sCIdx, sRIdx, sCIdx]));\n                            }\n                        }\n                    }\n                }\n            }\n        }\n        if (options.type === 'Clear Hyperlinks') {\n            this.parent.removeHyperlink(range);\n        }\n        this.parent.notify(clear, { range: sheet.name + '!' + range, type: options.type });\n        this.parent.serviceLocator.getService('cell').refreshRange(getRangeIndexes(range));\n        if (!args.isPublic) {\n            eventArgs = { range: sheet.name + '!' + range, type: options.type, sheetIndex: sheetIndex };\n            this.parent.notify('actionComplete', { eventArgs: eventArgs, action: 'clear' });\n        }\n    };\n    CellFormat.prototype.addEventListener = function () {\n        this.parent.on(applyCellFormat, this.applyCellFormat, this);\n        this.parent.on(clearViewer, this.clearObj, this);\n    };\n    CellFormat.prototype.removeEventListener = function () {\n        if (!this.parent.isDestroyed) {\n            this.parent.off(initialLoad, this.addEventListener);\n            this.parent.off(applyCellFormat, this.applyCellFormat);\n            this.parent.off(clearViewer, this.clearObj);\n        }\n    };\n    /**\n     * Destroy cell format module.\n     */\n    CellFormat.prototype.destroy = function () {\n        this.removeEventListener();\n        this.parent = null;\n        this.row = null;\n        this.checkHeight = null;\n    };\n    /**\n     * Get the cell format module name.\n     */\n    CellFormat.prototype.getModuleName = function () {\n        return 'cellformat';\n    };\n    return CellFormat;\n}());\nexport { CellFormat };\n","import { closest, EventHandler } from '@syncfusion/ej2-base';\nimport { colWidthChanged, rowHeightChanged, beforeHeaderLoaded, contentLoaded, hideShow, getFilterRange } from '../common/index';\nimport { findMaxValue, setResize, autoFit, completeAction, setAutoFit } from '../common/index';\nimport { setRowHeight, isHiddenRow, getRowHeight, getColumnWidth, setColumn, isHiddenCol } from '../../workbook/base/index';\nimport { getColumn, setRow, getCell } from '../../workbook/base/index';\nimport { getRangeIndexes, getSwapRange, getCellIndexes, setMerge } from '../../workbook/common/index';\n/**\n * The `Resize` module is used to handle the resizing functionalities in Spreadsheet.\n */\nvar Resize = /** @class */ (function () {\n    /**\n     * Constructor for resize module in Spreadsheet.\n     * @private\n     */\n    function Resize(parent) {\n        this.parent = parent;\n        this.addEventListener();\n    }\n    Resize.prototype.addEventListener = function () {\n        this.parent.on(contentLoaded, this.wireEvents, this);\n        this.parent.on(beforeHeaderLoaded, this.wireEvents, this);\n        this.parent.on(autoFit, this.autoFit, this);\n        this.parent.on(setAutoFit, this.setAutoFitHandler, this);\n    };\n    Resize.prototype.autoFit = function (args) {\n        var element = args.isRow ? this.parent.getRowHeaderTable() : this.parent.getColHeaderTable().rows[0];\n        for (var i = args.startIndex; i <= args.endIndex; i++) {\n            this.trgtEle = args.isRow ? this.parent.getRow(i, element) :\n                this.parent.getCell(null, i, element);\n            this.setAutofit(i, !args.isRow);\n        }\n    };\n    Resize.prototype.wireEvents = function (args) {\n        if (this.parent.getActiveSheet().showHeaders) {\n            var rowHeader = args ? args.element : this.parent.getRowHeaderContent();\n            var colHeader = this.parent.getColumnHeaderContent();\n            EventHandler.add(colHeader, 'dblclick', this.dblClickHandler, this);\n            EventHandler.add(rowHeader, 'dblclick', this.dblClickHandler, this);\n            EventHandler.add(colHeader, 'mousedown', this.mouseDownHandler, this);\n            EventHandler.add(rowHeader, 'mousedown', this.mouseDownHandler, this);\n            this.wireResizeCursorEvent(rowHeader, colHeader);\n        }\n    };\n    Resize.prototype.wireResizeCursorEvent = function (rowHeader, colHeader) {\n        EventHandler.add(rowHeader, 'mousemove', this.setTarget, this);\n        EventHandler.add(colHeader, 'mousemove', this.setTarget, this);\n    };\n    Resize.prototype.unWireResizeCursorEvent = function () {\n        EventHandler.remove(this.parent.getRowHeaderContent(), 'mousemove', this.setTarget);\n        EventHandler.remove(this.parent.getColumnHeaderContent(), 'mousemove', this.setTarget);\n    };\n    Resize.prototype.unwireEvents = function () {\n        if (this.parent.getActiveSheet().showHeaders) {\n            EventHandler.remove(this.parent.getColumnHeaderContent(), 'dblclick', this.dblClickHandler);\n            EventHandler.remove(this.parent.getRowHeaderContent(), 'dblclick', this.dblClickHandler);\n            EventHandler.remove(this.parent.getColumnHeaderContent(), 'mousedown', this.mouseDownHandler);\n            EventHandler.remove(this.parent.getRowHeaderContent(), 'mousedown', this.mouseDownHandler);\n            this.unWireResizeCursorEvent();\n        }\n    };\n    Resize.prototype.removeEventListener = function () {\n        if (!this.parent.isDestroyed) {\n            this.parent.off(contentLoaded, this.wireEvents);\n            this.parent.off(beforeHeaderLoaded, this.wireEvents);\n            this.parent.off(autoFit, this.autoFit);\n            this.parent.off(setAutoFit, this.setAutoFitHandler);\n        }\n    };\n    Resize.prototype.mouseMoveHandler = function (e) {\n        var sheetPanel = this.parent.element.getElementsByClassName('e-sheet-panel')[0];\n        var colResizeHandler = this.parent.element.getElementsByClassName('e-colresize-handler')[0];\n        var rowResizeHandler = this.parent.element.getElementsByClassName('e-rowresize-handler')[0];\n        if (colResizeHandler || rowResizeHandler) {\n            this.isMouseMoved = true;\n            if (colResizeHandler) {\n                if (e.x > this.trgtEle.parentElement.firstChild.getBoundingClientRect().left) {\n                    colResizeHandler.style.left = e.clientX - this.parent.element.getBoundingClientRect().left + 'px';\n                }\n            }\n            else if (rowResizeHandler) {\n                if (e.y >= this.trgtEle.parentElement.parentElement.firstChild.getBoundingClientRect().top) {\n                    rowResizeHandler.style.top = e.clientY - sheetPanel.getBoundingClientRect().top + 'px';\n                }\n            }\n        }\n    };\n    Resize.prototype.mouseDownHandler = function (e) {\n        this.event = e;\n        this.trgtEle = e.target;\n        if (this.trgtEle.parentElement.classList.contains('e-hide-end') || this.trgtEle.classList.contains('e-hide-end')) {\n            var offsetSize = this.trgtEle.offsetHeight;\n            var offset = e.offsetY;\n            if ((offsetSize >= 10 && offset < 5) || (offsetSize - 2 < 8 && offset < Math.ceil((offset - 2) / 2))) {\n                this.trgtEle.classList.add('e-skip-resize');\n            }\n        }\n        this.updateTarget(e, this.trgtEle);\n        var trgt = this.trgtEle;\n        var className = trgt.classList.contains('e-colresize') ? 'e-colresize-handler' :\n            trgt.classList.contains('e-rowresize') ? 'e-rowresize-handler' : '';\n        this.createResizeHandler(trgt, className);\n        this.unWireResizeCursorEvent();\n        EventHandler.add(this.parent.element, 'mousemove', this.mouseMoveHandler, this);\n        EventHandler.add(document, 'mouseup', this.mouseUpHandler, this);\n    };\n    Resize.prototype.mouseUpHandler = function (e) {\n        var colResizeHandler = this.parent.element.getElementsByClassName('e-colresize-handler')[0];\n        var rowResizeHandler = this.parent.element.getElementsByClassName('e-rowresize-handler')[0];\n        this.resizeOn(e);\n        this.isMouseMoved = null;\n        var resizeHandler = colResizeHandler ? colResizeHandler : rowResizeHandler;\n        if (resizeHandler) {\n            this.parent.element.getElementsByClassName('e-sheet-panel')[0].removeChild(resizeHandler);\n            this.updateCursor(e);\n        }\n        EventHandler.remove(document, 'mouseup', this.mouseUpHandler);\n        EventHandler.remove(this.parent.element, 'mousemove', this.mouseMoveHandler);\n        this.wireResizeCursorEvent(this.parent.getRowHeaderContent(), this.parent.getColumnHeaderContent());\n    };\n    Resize.prototype.dblClickHandler = function (e) {\n        this.trgtEle = e.target;\n        this.updateTarget(e, this.trgtEle);\n        if (this.trgtEle.classList.contains('e-colresize')) {\n            var colIndx = parseInt(this.trgtEle.getAttribute('aria-colindex'), 10) - 1;\n            var prevWidth = getColumnWidth(this.parent.getActiveSheet(), colIndx) + \"px\";\n            if (this.trgtEle.classList.contains('e-unhide-column')) {\n                this.showHiddenColumns(colIndx - 1);\n            }\n            else {\n                this.setAutofit(colIndx, true, prevWidth);\n            }\n        }\n        else if (this.trgtEle.classList.contains('e-rowresize')) {\n            var rowIndx = parseInt(this.trgtEle.parentElement.getAttribute('aria-rowindex'), 10) - 1;\n            var prevHeight = getRowHeight(this.parent.getActiveSheet(), rowIndx) + \"px\";\n            this.setAutofit(rowIndx, false, prevHeight);\n        }\n    };\n    Resize.prototype.setTarget = function (e) {\n        var trgt = e.target;\n        var sheet = this.parent.getActiveSheet();\n        if (sheet.isProtected && (!sheet.protectSettings.formatColumns || !sheet.protectSettings.formatRows)) {\n            if (!sheet.protectSettings.formatRows && !sheet.protectSettings.formatColumns) {\n                return;\n            }\n            if (sheet.protectSettings.formatRows) {\n                if (closest(trgt, '.e-colhdr-table')) {\n                    return;\n                }\n            }\n            if (sheet.protectSettings.formatColumns) {\n                if (closest(trgt, '.e-rowhdr-table')) {\n                    return;\n                }\n            }\n        }\n        var newTrgt;\n        var tOffsetV;\n        var eOffsetV;\n        var tClass;\n        if (closest(trgt, '.e-header-row')) {\n            eOffsetV = e.offsetX;\n            tOffsetV = trgt.offsetWidth;\n            tClass = 'e-colresize';\n            if (trgt.previousElementSibling) {\n                newTrgt = trgt.previousElementSibling;\n            }\n            else {\n                if (Number(trgt.getAttribute('aria-colindex')) > 1) {\n                    newTrgt = trgt;\n                }\n            }\n        }\n        else if (closest(trgt, '.e-row')) {\n            eOffsetV = e.offsetY;\n            tOffsetV = trgt.offsetHeight;\n            tClass = 'e-rowresize';\n            if (trgt.parentElement.previousElementSibling) {\n                newTrgt = trgt.parentElement.previousElementSibling.firstElementChild;\n            }\n            else {\n                if (Number(trgt.parentElement.getAttribute('aria-rowindex')) > 1) {\n                    newTrgt = trgt;\n                }\n            }\n        }\n        if (tOffsetV - 2 < 8 && eOffsetV !== Math.ceil((tOffsetV - 2) / 2)) {\n            if (eOffsetV < Math.ceil((tOffsetV - 2) / 2)) {\n                trgt.classList.add(tClass);\n                newTrgt.classList.add(tClass);\n            }\n            else if (eOffsetV > Math.ceil((tOffsetV - 2) / 2)) {\n                trgt.classList.add(tClass);\n            }\n        }\n        else if (tOffsetV - 5 < eOffsetV && eOffsetV <= tOffsetV && tOffsetV >= 10) {\n            trgt.classList.add(tClass);\n        }\n        else if (eOffsetV < 5 && newTrgt && tOffsetV >= 10) {\n            trgt.classList.add(tClass);\n            newTrgt.classList.add(tClass);\n        }\n        else {\n            var resEle = (tClass === 'e-colresize' ? trgt.parentElement.getElementsByClassName(tClass)\n                : this.parent.getRowHeaderTable().getElementsByClassName(tClass));\n            for (var index = 0; index < resEle.length; index++) {\n                resEle[index].classList.remove(tClass);\n            }\n        }\n    };\n    Resize.prototype.updateTarget = function (e, trgt) {\n        if (closest(trgt, '.e-header-row')) {\n            if ((trgt.offsetWidth < 10 && e.offsetX < Math.ceil((trgt.offsetWidth - 2) / 2)) || (e.offsetX < 5 &&\n                trgt.offsetWidth >= 10) && trgt.classList.contains('e-colresize')) {\n                var sheet = this.parent.getActiveSheet();\n                var prevIdx = Number(this.trgtEle.getAttribute('aria-colindex')) - 2;\n                if (trgt.previousElementSibling && !isHiddenCol(sheet, prevIdx)) {\n                    this.trgtEle = trgt.previousElementSibling;\n                }\n                else {\n                    if (prevIdx > -1) {\n                        this.trgtEle.classList.add('e-unhide-column');\n                    }\n                }\n            }\n        }\n        else {\n            if ((trgt.offsetHeight < 10 && e.offsetY < Math.ceil((trgt.offsetHeight - 2) / 2)) || (e.offsetY < 5 &&\n                trgt.offsetHeight >= 10) && trgt.classList.contains('e-rowresize')) {\n                var sheet = this.parent.getActiveSheet();\n                var prevIdx = Number(trgt.parentElement.getAttribute('aria-rowindex')) - 2;\n                if (trgt.parentElement.previousElementSibling || isHiddenRow(sheet, prevIdx)) {\n                    if (e.type === 'dblclick' && isHiddenRow(sheet, prevIdx)) {\n                        var selectRange = getSwapRange(getRangeIndexes(this.parent.getActiveSheet().selectedRange));\n                        var eventArgs = void 0;\n                        if (prevIdx <= selectRange[2] && prevIdx > selectRange[0]) {\n                            eventArgs = { startIndex: selectRange[0], endIndex: selectRange[2], hide: false, autoFit: true };\n                        }\n                        else {\n                            eventArgs = { startIndex: prevIdx, endIndex: prevIdx, hide: false, autoFit: true };\n                        }\n                        this.parent.notify(hideShow, eventArgs);\n                    }\n                    else {\n                        if (!isHiddenRow(sheet, prevIdx)) {\n                            this.trgtEle = trgt.parentElement.previousElementSibling.getElementsByClassName('e-header-cell')[0];\n                        }\n                    }\n                }\n            }\n        }\n    };\n    Resize.prototype.setAutoFitHandler = function (args) {\n        this.setAutofit(args.idx, args.isCol);\n    };\n    // tslint:disable-next-line:max-func-body-length\n    Resize.prototype.setAutofit = function (idx, isCol, prevData) {\n        var index = 0;\n        var sheet = this.parent.getActiveSheet();\n        var mainContent = this.parent.getMainContent();\n        var oldValue = isCol ? getColumnWidth(this.parent.getActiveSheet(), idx) + \"px\" :\n            getRowHeight(this.parent.getActiveSheet(), idx) + \"px\";\n        var contentClone = [];\n        var contentTable = mainContent.getElementsByClassName('e-content-table')[0];\n        if (this.parent.getActiveSheet().showHeaders) {\n            var headerTable = isCol ? this.parent.getColHeaderTable() : this.parent.getRowHeaderTable();\n            var headerRow = headerTable.getElementsByTagName('tr');\n        }\n        var headerText;\n        var isWrap = false;\n        if (isCol) {\n            var rowLength = sheet.rows.length;\n            for (var rowIdx = 0; rowIdx < rowLength; rowIdx++) {\n                if (sheet.rows[rowIdx] && sheet.rows[rowIdx].cells && sheet.rows[rowIdx].cells[idx]) {\n                    if (getCell(rowIdx, idx, sheet).wrap) {\n                        isWrap = true;\n                    }\n                    var td = this.parent.createElement('td', { className: 'e-cell' });\n                    td.textContent = this.parent.getDisplayText(sheet.rows[rowIdx].cells[idx]);\n                    if (sheet.rows[rowIdx].cells[idx].style) {\n                        var style = sheet.rows[rowIdx].cells[idx].style;\n                        if (style.fontFamily) {\n                            td.style.fontFamily = style.fontFamily;\n                        }\n                        if (style.fontSize) {\n                            td.style.fontSize = style.fontSize;\n                        }\n                    }\n                    contentClone[index] = td;\n                    index++;\n                }\n            }\n        }\n        else {\n            var colLength = sheet.rows[idx] && sheet.rows[idx].cells ? sheet.rows[idx].cells.length : 0;\n            for (var colIdx = 0; colIdx < colLength; colIdx++) {\n                if (sheet.rows[idx] && sheet.rows[idx].cells[colIdx]) {\n                    if (getCell(idx, colIdx, sheet).wrap) {\n                        isWrap = true;\n                    }\n                    var style = sheet.rows[idx].cells[colIdx].style;\n                    var td = this.parent.createElement('td');\n                    td.textContent = this.parent.getDisplayText(sheet.rows[idx].cells[colIdx]);\n                    if (sheet.rows[idx].cells[colIdx].style) {\n                        var style_1 = sheet.rows[idx].cells[colIdx].style;\n                        if (style_1.fontFamily) {\n                            td.style.fontFamily = style_1.fontFamily;\n                        }\n                        if (style_1.fontSize) {\n                            td.style.fontSize = style_1.fontSize;\n                        }\n                    }\n                    contentClone[index] = td;\n                    index++;\n                }\n            }\n        }\n        var contentFit = findMaxValue(contentTable, contentClone, isCol, this.parent, prevData, isWrap);\n        if (isCol) {\n            contentFit = this.getFloatingElementWidth(contentFit, idx);\n        }\n        var autofitValue = contentFit === 0 ? parseInt(oldValue, 10) : contentFit;\n        var threshold = parseInt(oldValue, 10) > autofitValue ?\n            -(parseInt(oldValue, 10) - autofitValue) : autofitValue - parseInt(oldValue, 10);\n        if (isCol) {\n            if (idx >= this.parent.viewport.leftIndex && idx <= this.parent.viewport.rightIndex) {\n                getColumn(sheet, idx).width = autofitValue > 0 ? autofitValue : 0;\n                this.parent.notify(colWidthChanged, { threshold: threshold, colIdx: idx });\n                this.resizeStart(idx, this.parent.getViewportIndex(idx, true), autofitValue + 'px', isCol, true, prevData);\n            }\n            else {\n                var oldWidth = getColumnWidth(sheet, idx);\n                var threshold_1;\n                if (autofitValue > 0) {\n                    threshold_1 = -(oldWidth - autofitValue);\n                }\n                else {\n                    threshold_1 = -oldWidth;\n                }\n                this.parent.notify(colWidthChanged, { threshold: threshold_1, colIdx: idx });\n                getColumn(sheet, idx).width = autofitValue > 0 ? autofitValue : 0;\n            }\n        }\n        else if (!isCol) {\n            if (idx >= this.parent.viewport.topIndex && idx <= this.parent.viewport.bottomIndex) {\n                autofitValue = autofitValue > 20 ? autofitValue : 20;\n                setRowHeight(sheet, idx, autofitValue > 0 ? autofitValue : 0);\n                this.parent.notify(rowHeightChanged, { threshold: threshold, rowIdx: idx });\n                this.resizeStart(idx, this.parent.getViewportIndex(idx), autofitValue + 'px', isCol, true, prevData);\n            }\n            else {\n                var oldHeight = getRowHeight(sheet, idx);\n                var threshold_2;\n                if (autofitValue > 0) {\n                    threshold_2 = -(oldHeight - autofitValue);\n                }\n                else {\n                    threshold_2 = -oldHeight;\n                }\n                this.parent.notify(rowHeightChanged, { threshold: threshold_2, rowIdx: idx });\n                setRowHeight(sheet, idx, autofitValue > 0 ? autofitValue : 0);\n            }\n        }\n    };\n    Resize.prototype.createResizeHandler = function (trgt, className) {\n        var editor = this.parent.createElement('div', { className: className });\n        if (trgt.classList.contains('e-colresize')) {\n            editor.style.height = this.parent.getMainContent().clientHeight + trgt.offsetHeight + 'px';\n            editor.style.left = this.event.clientX - this.parent.element.getBoundingClientRect().left + 'px';\n            editor.style.top = '0px';\n        }\n        else if (trgt.classList.contains('e-rowresize')) {\n            editor.style.width = this.parent.getMainContent().clientWidth + trgt.offsetWidth + 'px';\n            editor.style.left = '0px';\n            editor.style.top = this.event.clientY\n                - this.parent.element.getElementsByClassName('e-sheet-panel')[0].getBoundingClientRect().top + 'px';\n        }\n        this.parent.element.getElementsByClassName('e-sheet-panel')[0].appendChild(editor);\n        this.updateCursor(this.event);\n    };\n    Resize.prototype.setColWidth = function (index, viewportIdx, width, curWidth) {\n        var sheet = this.parent.getActiveSheet();\n        var threshold = width - curWidth;\n        if (threshold < 0 && curWidth < -(threshold)) {\n            threshold = -curWidth;\n        }\n        if (width > 0) {\n            if (this.isMouseMoved && this.trgtEle.classList.contains('e-unhide-column')) {\n                this.showHiddenColumns(index, width);\n                this.parent.notify(completeAction, {\n                    eventArgs: {\n                        index: index, width: 0 + \"px\", isCol: true, sheetIdx: this.parent.activeSheetIndex, oldWidth: curWidth + \"px\",\n                        hide: false\n                    }, action: 'resize'\n                });\n                return;\n            }\n            this.parent.notify(colWidthChanged, { threshold: threshold, colIdx: index });\n            this.resizeStart(index, viewportIdx, width + \"px\", true, false, curWidth + \"px\");\n            setColumn(sheet, index, { width: width, customWidth: true });\n        }\n        else {\n            if (this.isMouseMoved) {\n                this.parent.hideColumn(index);\n                this.parent.notify(completeAction, {\n                    eventArgs: {\n                        index: index, width: 0 + \"px\", isCol: true, sheetIdx: this.parent.activeSheetIndex, oldWidth: curWidth + \"px\",\n                        hide: true\n                    }, action: 'resize'\n                });\n            }\n        }\n    };\n    Resize.prototype.showHiddenColumns = function (index, width) {\n        var sheet = this.parent.getActiveSheet();\n        var selectedRange = getRangeIndexes(sheet.selectedRange);\n        var startIdx;\n        var endIdx;\n        var colgroup;\n        if (index >= selectedRange[1] && index <= selectedRange[3] && selectedRange[2] === sheet.rowCount - 1 &&\n            getCellIndexes(sheet.activeCell)[0] === getCellIndexes(sheet.topLeftCell)[0]) {\n            startIdx = selectedRange[1];\n            endIdx = selectedRange[3];\n            colgroup = this.parent.getMainContent().querySelector('colgroup');\n        }\n        else {\n            startIdx = endIdx = index;\n        }\n        if (width !== undefined) {\n            for (var i = startIdx; i <= endIdx; i++) {\n                setColumn(sheet, i, { width: width, customWidth: true });\n                if (i >= this.parent.viewport.leftIndex && i <= this.parent.viewport.rightIndex && !isHiddenCol(sheet, i)) {\n                    colgroup.children[this.parent.getViewportIndex(i, true)].style.width = width + \"px\";\n                }\n            }\n        }\n        this.trgtEle.classList.remove('e-unhide-column');\n        this.parent.hideColumn(startIdx, endIdx, false);\n        if (width === undefined) {\n            this.autoFit({ isRow: false, startIndex: startIdx, endIndex: endIdx });\n        }\n    };\n    Resize.prototype.setRowHeight = function (rowIdx, viewportIdx, height, prevData) {\n        var sheet = this.parent.getActiveSheet();\n        var eleHeight = parseInt(this.parent.getMainContent().getElementsByTagName('tr')[viewportIdx].style.height, 10);\n        var rowHeight = height;\n        var threshold = parseInt(rowHeight, 10) - eleHeight;\n        if (threshold < 0 && eleHeight < -(threshold)) {\n            threshold = -eleHeight;\n        }\n        this.parent.notify(rowHeightChanged, { threshold: threshold, rowIdx: rowIdx, isCustomHgt: true });\n        this.resizeStart(rowIdx, viewportIdx, rowHeight, false, false, prevData);\n        setRow(sheet, rowIdx, { height: parseInt(rowHeight, 10) > 0 ? parseInt(rowHeight, 10) : 0, customHeight: true });\n    };\n    Resize.prototype.resizeOn = function (e) {\n        var _this = this;\n        var idx;\n        var actualIdx;\n        if (this.trgtEle.classList.contains('e-rowresize')) {\n            var sheet = this.parent.getActiveSheet();\n            var prevIdx = Number(this.trgtEle.parentElement.getAttribute('aria-rowindex')) - 2;\n            if (this.isMouseMoved && isHiddenRow(sheet, prevIdx) && this.trgtEle.classList.contains('e-skip-resize') &&\n                e.clientY > this.trgtEle.getBoundingClientRect().top) {\n                this.trgtEle.classList.remove('e-skip-resize');\n                var eventArgs = { startIndex: prevIdx, endIndex: prevIdx, hide: false, skipAppend: true };\n                this.parent.notify(hideShow, eventArgs);\n                var rTbody = this.parent.getRowHeaderTable().tBodies[0];\n                var tbody = this.parent.getContentTable().tBodies[0];\n                eventArgs.hdrRow.style.display = 'none';\n                eventArgs.row.style.display = 'none';\n                rTbody.insertBefore(eventArgs.hdrRow, rTbody.children[eventArgs.insertIdx]);\n                tbody.insertBefore(eventArgs.row, tbody.children[eventArgs.insertIdx]);\n                this.trgtEle = eventArgs.hdrRow.firstElementChild;\n                eventArgs.hdrRow.nextElementSibling.classList.remove('e-hide-end');\n                eventArgs.mergeCollection.forEach(function (mergeArgs) { _this.parent.notify(setMerge, mergeArgs); });\n            }\n            else {\n                if (this.trgtEle.classList.contains('e-skip-resize')) {\n                    this.trgtEle.classList.remove('e-skip-resize');\n                    if ((!this.isMouseMoved && isHiddenRow(sheet, prevIdx)) || !this.trgtEle.parentElement.previousElementSibling) {\n                        return;\n                    }\n                    this.trgtEle = this.trgtEle.parentElement.previousElementSibling.getElementsByClassName('e-header-cell')[0];\n                }\n            }\n            actualIdx = idx = parseInt(this.trgtEle.parentElement.getAttribute('aria-rowindex'), 10) - 1;\n            idx = this.parent.getViewportIndex(actualIdx);\n            var prevData = this.parent.getMainContent().getElementsByClassName('e-row')[idx].style.height;\n            var rowHeight = e.clientY - this.event.clientY + parseInt(prevData, 10);\n            if (rowHeight <= 0) {\n                this.parent.hideRow(actualIdx);\n                setRow(sheet, actualIdx, { height: 0, customHeight: true });\n                this.parent.notify(completeAction, {\n                    eventArgs: { index: actualIdx, height: '0px', isCol: false, sheetIdx: this.parent.activeSheetIndex, oldHeight: prevData },\n                    action: 'resize'\n                });\n                return;\n            }\n            this.setRowHeight(actualIdx, idx, rowHeight + \"px\", prevData);\n            if (this.trgtEle.parentElement.style.display === 'none') {\n                var sheet_1 = this.parent.getActiveSheet();\n                var selectedRange = getSwapRange(getRangeIndexes(sheet_1.selectedRange));\n                if (actualIdx <= selectedRange[2] && actualIdx > selectedRange[0]) {\n                    rowHeight = sheet_1.rows[actualIdx].height;\n                    var count = void 0;\n                    for (var i = selectedRange[0]; i <= selectedRange[2]; i++) {\n                        if (i === actualIdx) {\n                            continue;\n                        }\n                        prevData = getRowHeight(sheet_1, i) + \"px\";\n                        setRow(sheet_1, i, { customHeight: true, height: rowHeight });\n                        if (isHiddenRow(sheet_1, i)) {\n                            if (!count) {\n                                count = i;\n                            }\n                        }\n                        else {\n                            this.parent.getRow(i).style.height = rowHeight + \"px\";\n                            if (sheet_1.showHeaders) {\n                                this.parent.getRow(i, this.parent.getRowHeaderTable()).style.height = rowHeight + \"px\";\n                            }\n                        }\n                        this.parent.notify(completeAction, {\n                            eventArgs: {\n                                index: i, height: rowHeight + \"px\", isCol: false,\n                                sheetIdx: this.parent.activeSheetIndex, oldHeight: prevData\n                            },\n                            action: 'resize'\n                        });\n                    }\n                    this.parent.hideRow(selectedRange[0], actualIdx - 1, false);\n                    idx += Math.abs(actualIdx - count);\n                }\n                else {\n                    if (idx !== 0 && !isHiddenRow(sheet_1, actualIdx - 1)) {\n                        this.trgtEle.parentElement.previousElementSibling.classList.remove('e-hide-start');\n                    }\n                    else {\n                        if (idx !== 0) {\n                            this.trgtEle.parentElement.classList.add('e-hide-end');\n                        }\n                    }\n                    this.parent.selectRange(sheet_1.selectedRange);\n                }\n                this.trgtEle.parentElement.style.display = '';\n                this.parent.getContentTable().rows[idx].style.display = '';\n            }\n        }\n        else if (this.trgtEle.classList.contains('e-colresize')) {\n            if (this.isMouseMoved && this.trgtEle.classList.contains('e-unhide-column') &&\n                e.clientX < this.trgtEle.getBoundingClientRect().left) {\n                this.trgtEle.classList.remove('e-unhide-column');\n                if (this.trgtEle.previousElementSibling) {\n                    this.trgtEle = this.trgtEle.previousElementSibling;\n                }\n            }\n            idx = parseInt(this.trgtEle.getAttribute('aria-colindex'), 10) - 1;\n            var curWidth = void 0;\n            if (this.trgtEle.classList.contains('e-unhide-column')) {\n                idx -= 1;\n                curWidth = 0;\n            }\n            else {\n                curWidth = getColumnWidth(this.parent.getActiveSheet(), idx);\n            }\n            this.setColWidth(idx, this.parent.getViewportIndex(idx, true), (e.clientX - this.event.clientX) + curWidth, curWidth);\n        }\n    };\n    Resize.prototype.setWidthAndHeight = function (trgt, value, isCol) {\n        if (isCol) {\n            trgt.style.width = parseInt(trgt.style.width, 10) + value + 'px';\n        }\n        else {\n            trgt.style.height = parseInt(trgt.style.height, 10) + value + 'px';\n        }\n    };\n    Resize.prototype.resizeStart = function (idx, viewportIdx, value, isCol, isFit, prevData) {\n        if (this.parent.getActiveSheet().showHeaders) {\n            setResize(viewportIdx, value, isCol, this.parent);\n        }\n        else {\n            if (isCol) {\n                var curEle = this.parent.element.getElementsByClassName('e-sheet-content')[0].getElementsByTagName('col')[viewportIdx];\n                curEle.style.width = value;\n            }\n            else {\n                var curEle = this.parent.element.getElementsByClassName('e-sheet-content')[0].getElementsByTagName('tr')[viewportIdx];\n                curEle.style.height = value;\n            }\n        }\n        var action = isFit ? 'resizeToFit' : 'resize';\n        var eventArgs;\n        var isAction;\n        if (isCol) {\n            eventArgs = { index: idx, width: value, isCol: isCol, sheetIdx: this.parent.activeSheetIndex, oldWidth: prevData };\n            isAction = prevData !== value;\n        }\n        else {\n            eventArgs = { index: idx, height: value, isCol: isCol, sheetIdx: this.parent.activeSheetIndex, oldHeight: prevData };\n            isAction = prevData !== value;\n        }\n        if (isAction) {\n            this.parent.notify(completeAction, { eventArgs: eventArgs, action: action });\n        }\n    };\n    Resize.prototype.updateCursor = function (e) {\n        if (this.parent.element.getElementsByClassName('e-colresize-handler')[0]) {\n            this.parent.element.classList.add('e-col-resizing');\n        }\n        else if (this.parent.element.classList.contains('e-col-resizing')) {\n            this.parent.element.classList.remove('e-col-resizing');\n        }\n        if (this.parent.element.getElementsByClassName('e-rowresize-handler')[0]) {\n            this.parent.element.classList.add('e-row-resizing');\n        }\n        else if (this.parent.element.classList.contains('e-row-resizing')) {\n            this.parent.element.classList.remove('e-row-resizing');\n        }\n    };\n    // To get the floating element width like filter\n    Resize.prototype.getFloatingElementWidth = function (oldWidth, colIdx) {\n        var floatingWidth = oldWidth;\n        var eventArgs = { filterRange: [], hasFilter: false };\n        this.parent.notify(getFilterRange, eventArgs);\n        if (eventArgs.hasFilter && eventArgs.filterRange) {\n            if (eventArgs.filterRange[1] <= colIdx && eventArgs.filterRange[3] >= colIdx) {\n                floatingWidth = oldWidth + 22; // default width and padding for button \n            }\n        }\n        return floatingWidth;\n    };\n    /**\n     * To destroy the resize module.\n     * @return {void}\n     */\n    Resize.prototype.destroy = function () {\n        this.unwireEvents();\n        this.removeEventListener();\n        this.parent = null;\n    };\n    /**\n     * Get the module name.\n     * @returns string\n     */\n    Resize.prototype.getModuleName = function () {\n        return 'resize';\n    };\n    return Resize;\n}());\nexport { Resize };\n","import { collaborativeUpdate, updateAction } from '../common/index';\n/**\n * Collaborative Editing module for real time changes in the Spreadsheet.\n */\nvar CollaborativeEditing = /** @class */ (function () {\n    function CollaborativeEditing(parent) {\n        this.parent = parent;\n        this.addEventListener();\n    }\n    CollaborativeEditing.prototype.refreshClients = function (options) {\n        updateAction(options, this.parent);\n    };\n    CollaborativeEditing.prototype.addEventListener = function () {\n        this.parent.on(collaborativeUpdate, this.refreshClients, this);\n    };\n    CollaborativeEditing.prototype.removeEventListener = function () {\n        if (!this.parent.isDestroyed) {\n            this.parent.off(collaborativeUpdate, this.refreshClients);\n        }\n    };\n    /**\n     * Destroy collaborative editing module.\n     */\n    CollaborativeEditing.prototype.destroy = function () {\n        this.removeEventListener();\n        this.parent = null;\n    };\n    /**\n     * Get the collaborative editing module name.\n     */\n    CollaborativeEditing.prototype.getModuleName = function () {\n        return 'collaborativeEditing';\n    };\n    return CollaborativeEditing;\n}());\nexport { CollaborativeEditing };\n","import { spreadsheetDestroyed, getUpdateUsingRaf } from '../common/index';\nimport { autoFit, hideShow, virtualContentLoaded, completeAction, setScrollEvent, onContentScroll, skipHiddenIdx } from '../common/index';\nimport { beginAction, hiddenMerge, updateTableWidth } from '../common/index';\nimport { getCellAddress, isHiddenRow, setRow, setColumn, isHiddenCol, getRangeAddress, getCell } from '../../workbook/index';\nimport { getCellIndexes, getColumnWidth, applyCellFormat } from '../../workbook/index';\nimport { activeCellMergedRange, setMerge } from '../../workbook/index';\nimport { detach } from '@syncfusion/ej2-base';\n/**\n * The `ShowHide` module is used to perform hide/show the rows and columns.\n * @hidden\n */\nvar ShowHide = /** @class */ (function () {\n    /**\n     * Constructor for the Spreadsheet show hide module.\n     * @private\n     */\n    function ShowHide(parent) {\n        this.parent = parent;\n        this.addEventListener();\n    }\n    ShowHide.prototype.hideShow = function (args) {\n        if (args.startIndex > args.endIndex) {\n            var temp = args.startIndex;\n            args.startIndex = args.endIndex;\n            args.endIndex = temp;\n        }\n        if (args.actionUpdate) {\n            this.parent.notify(beginAction, { eventArgs: args, action: 'hideShow' });\n        }\n        args.isCol ? this.hideCol(args) : this.hideRow(args);\n        if (args.actionUpdate) {\n            this.parent.notify(completeAction, { eventArgs: args, action: 'hideShow' });\n        }\n    };\n    // tslint:disable-next-line\n    ShowHide.prototype.hideRow = function (args) {\n        var _this = this;\n        var sheet = this.parent.getActiveSheet();\n        var cell;\n        var count = 0;\n        var idx;\n        var nextIdx;\n        var merge;\n        if (args.hide) {\n            var content = void 0;\n            var rowHdr = void 0;\n            var row = void 0;\n            for (var i = args.startIndex; i <= args.endIndex; i++) {\n                if (isHiddenRow(sheet, i)) {\n                    continue;\n                }\n                if (idx === undefined) {\n                    if (sheet.showHeaders) {\n                        rowHdr = this.parent.getRowHeaderTable();\n                    }\n                    content = this.parent.getContentTable();\n                    idx = this.parent.getViewportIndex(i);\n                    count = 0;\n                }\n                setRow(sheet, i, { hidden: true });\n                row = content.rows[idx];\n                if (row) {\n                    if (!merge) {\n                        for (var j = 0; j <= sheet.usedRange.colIndex; j++) {\n                            cell = getCell(i, j, sheet) || {};\n                            if ((cell.colSpan || cell.rowSpan) && (args.startIndex >= this.parent.viewport.topIndex ||\n                                this.parent.scrollSettings.enableVirtualization)) {\n                                merge = true;\n                                break;\n                            }\n                        }\n                    }\n                    if (merge) {\n                        continue;\n                    }\n                    if (sheet.showHeaders) {\n                        detach(rowHdr.rows[idx]);\n                    }\n                    detach(row);\n                    count++;\n                    row = content.rows[idx];\n                    if (row && i === args.endIndex) {\n                        var cell_1 = void 0;\n                        nextIdx = skipHiddenIdx(sheet, i + 1, true);\n                        var first = nextIdx !== skipHiddenIdx(sheet, 0, true) && nextIdx ===\n                            (this.parent.viewport.topIndex >= args.startIndex ? args.endIndex + 1 : this.parent.viewport.topIndex) ? 'Row' : '';\n                        for (var j = this.parent.viewport.leftIndex; j <= this.parent.viewport.rightIndex; j++) {\n                            var borderTop = this.parent.getCellStyleValue(['borderTop'], [nextIdx, j]).borderTop;\n                            if (borderTop !== '') {\n                                cell_1 = row.cells[j];\n                                this.parent.notify(applyCellFormat, { onActionUpdate: false, rowIdx: nextIdx, colIdx: j,\n                                    style: { borderTop: borderTop }, row: row, pRow: row.previousElementSibling,\n                                    first: first, cell: cell_1 });\n                            }\n                        }\n                    }\n                }\n                else {\n                    if (i <= this.parent.viewport.bottomIndex) {\n                        count++;\n                    }\n                    else {\n                        count--;\n                    }\n                }\n            }\n            if (merge && (args.startIndex >= this.parent.viewport.topIndex || !this.parent.scrollSettings.enableVirtualization)) {\n                this.parent.selectRange(sheet.selectedRange);\n                this.parent.renderModule.refreshUI({\n                    rowIndex: this.parent.viewport.topIndex, colIndex: this.parent.viewport.leftIndex, refresh: 'Row'\n                });\n                return;\n            }\n            if (!count) {\n                return;\n            }\n            this.parent.selectRange(sheet.selectedRange);\n            if (this.parent.scrollSettings.enableVirtualization) {\n                if (this.parent.viewport.topIndex >= args.startIndex) {\n                    this.parent.viewport.topIndex = args.endIndex + 1;\n                }\n                args.startIndex = this.parent.viewport.bottomIndex + 1;\n                args.endIndex = args.startIndex + count - 1;\n                var indexes = this.parent.skipHidden(args.startIndex, args.endIndex);\n                args.startIndex = indexes[0];\n                args.endIndex = indexes[1];\n                this.parent.viewport.bottomIndex = args.endIndex;\n                this.parent.renderModule.refreshUI({ colIndex: this.parent.viewport.leftIndex, direction: '', refresh: 'RowPart' }, getCellAddress(args.startIndex, this.parent.viewport.leftIndex) + \":\" + getCellAddress(args.endIndex, this.parent.viewport.leftIndex + this.parent.viewport.colCount + (this.parent.getThreshold('col') * 2)));\n            }\n            if (sheet.showHeaders) {\n                if (idx === 0) {\n                    if (rowHdr.rows[0]) {\n                        rowHdr.rows[0].classList.add('e-hide-end');\n                    }\n                }\n                else {\n                    if (rowHdr.rows[idx - 1]) {\n                        rowHdr.rows[idx - 1].classList.add('e-hide-start');\n                    }\n                    if (rowHdr.rows[idx]) {\n                        rowHdr.rows[idx].classList.add('e-hide-end');\n                    }\n                }\n            }\n        }\n        else {\n            var hFrag = void 0;\n            var frag = void 0;\n            var hRow = void 0;\n            var row = void 0;\n            var rowRenderer = void 0;\n            var rTBody = void 0;\n            var tBody = void 0;\n            var startRow = void 0;\n            var endRow = args.startIndex - 1;\n            var newStartRow = void 0;\n            var mergeCollection = [];\n            for (var i = args.startIndex, len = args.endIndex; i <= len; i++) {\n                if (!isHiddenRow(sheet, i)) {\n                    if (args.startIndex === args.endIndex) {\n                        return;\n                    }\n                    if (idx === undefined) {\n                        endRow++;\n                    }\n                    else {\n                        newStartRow = i;\n                    }\n                    continue;\n                }\n                if (newStartRow !== undefined) {\n                    len = i;\n                    continue;\n                }\n                if (i > this.parent.viewport.bottomIndex) {\n                    setRow(sheet, i, { hidden: false });\n                    if (startRow === undefined) {\n                        return;\n                    }\n                    continue;\n                }\n                if (startRow === undefined) {\n                    startRow = i;\n                }\n                setRow(sheet, i, { hidden: false });\n                if (idx === undefined) {\n                    hFrag = document.createDocumentFragment();\n                    frag = document.createDocumentFragment();\n                    rowRenderer = this.parent.serviceLocator.getService('row');\n                    if (sheet.showHeaders) {\n                        rTBody = this.parent.getRowHeaderTable().tBodies[0];\n                    }\n                    tBody = this.parent.getContentTable().tBodies[0];\n                    if (i < this.parent.viewport.topIndex) {\n                        this.parent.viewport.topIndex = i;\n                    }\n                    if (i === 0) {\n                        idx = 0;\n                    }\n                    else {\n                        idx = this.parent.getViewportIndex(i);\n                    }\n                }\n                endRow++;\n                if (sheet.showHeaders) {\n                    hRow = rowRenderer.refresh(i, null, null, true);\n                    hFrag.appendChild(hRow);\n                    detach(rTBody.lastElementChild);\n                }\n                row = frag.appendChild(rowRenderer.refresh(i, row, hRow));\n                detach(tBody.lastElementChild);\n                for (var j = this.parent.viewport.leftIndex; j <= this.parent.viewport.rightIndex; j++) {\n                    cell = getCell(i, j, sheet) || {};\n                    if (cell.rowSpan !== undefined) {\n                        var mergeArgs = { range: [i, j, i, j], isAction: false, merge: true,\n                            type: 'All', skipChecking: true };\n                        this.parent.notify(activeCellMergedRange, mergeArgs);\n                        if (!mergeCollection.length || mergeArgs.range[1] !== mergeCollection[mergeCollection.length - 1].range[1]) {\n                            mergeCollection.push(mergeArgs);\n                        }\n                    }\n                }\n            }\n            this.parent.viewport.bottomIndex = this.parent.viewport.topIndex + this.parent.viewport.rowCount +\n                (this.parent.getThreshold('row') * 2);\n            count = this.parent.hiddenCount(this.parent.viewport.topIndex, args.startIndex) +\n                this.parent.hiddenCount(args.endIndex + 1, this.parent.viewport.bottomIndex);\n            this.parent.viewport.bottomIndex += count;\n            args.insertIdx = idx;\n            args.row = frag.querySelector('.e-row');\n            args.mergeCollection = mergeCollection;\n            if (sheet.showHeaders) {\n                args.hdrRow = hFrag.querySelector('.e-row');\n                if (idx !== 0 && !isHiddenRow(sheet, endRow - 1) && rTBody.children[idx - 1]) {\n                    rTBody.children[idx - 1].classList.remove('e-hide-start');\n                }\n                if (args.startIndex !== 0 && isHiddenRow(sheet, args.startIndex - 1)) {\n                    args.hdrRow.classList.add('e-hide-end');\n                }\n                if (isHiddenRow(sheet, endRow + 1)) {\n                    hFrag.lastElementChild.classList.add('e-hide-start');\n                }\n                else {\n                    if (rTBody.children[idx]) {\n                        rTBody.children[idx].classList.remove('e-hide-end');\n                    }\n                }\n            }\n            if (row && tBody.children[idx]) {\n                nextIdx = skipHiddenIdx(sheet, endRow + 1, true);\n                for (var i = this.parent.viewport.leftIndex; i <= this.parent.viewport.rightIndex; i++) {\n                    var borderTop = this.parent.getCellStyleValue(['borderTop'], [nextIdx, i]).borderTop;\n                    if (borderTop !== '') {\n                        this.parent.notify(applyCellFormat, { onActionUpdate: false, rowIdx: nextIdx, colIdx: i,\n                            style: { borderTop: borderTop }, pRow: row, cell: tBody.children[idx].children[i],\n                            first: '' });\n                        var prevIdx = skipHiddenIdx(sheet, startRow - 1, false);\n                        if (prevIdx > -1) {\n                            if (tBody.children[idx - 1] && !this.parent.getCellStyleValue(['borderBottom'], [prevIdx, i]).borderBottom &&\n                                !this.parent.getCellStyleValue(['borderTop'], [startRow, i]).borderTop) {\n                                tBody.children[idx - 1].children[i].style.borderBottom = '';\n                            }\n                        }\n                        else {\n                            tBody.children[idx].children[i].style.borderTop = '';\n                        }\n                    }\n                }\n            }\n            if (args.skipAppend) {\n                return;\n            }\n            if (sheet.showHeaders) {\n                rTBody.insertBefore(hFrag, rTBody.children[idx]);\n            }\n            tBody.insertBefore(frag, tBody.children[idx]);\n            this.parent.selectRange(sheet.selectedRange);\n            if (args.autoFit && sheet.showHeaders) {\n                this.parent.notify(autoFit, { startIndex: args.startIndex, endIndex: args.endIndex, isRow: true });\n            }\n            mergeCollection.forEach(function (mergeArgs) { _this.parent.notify(setMerge, mergeArgs); });\n            if (newStartRow !== undefined && newStartRow !== args.endIndex) {\n                args.startIndex = newStartRow;\n                this.hideRow(args);\n            }\n        }\n    };\n    ShowHide.prototype.hideCol = function (args) {\n        var _this = this;\n        var sheet = this.parent.getActiveSheet();\n        var hiddenIndex = [];\n        var beforeViewportIdx = [];\n        var topLeftCell = getCellIndexes(sheet.topLeftCell);\n        var scrollable;\n        for (var i = args.startIndex; i <= args.endIndex; i++) {\n            if (args.hide ? isHiddenCol(sheet, i) : !isHiddenCol(sheet, i)) {\n                continue;\n            }\n            setColumn(sheet, i, { hidden: args.hide });\n            if (this.parent.scrollSettings.enableVirtualization && (i < this.parent.viewport.leftIndex ||\n                i > this.parent.viewport.rightIndex)) {\n                if (i < this.parent.viewport.leftIndex) {\n                    beforeViewportIdx.push(i);\n                }\n                continue;\n            }\n            hiddenIndex.push(i);\n            if (args.hide && topLeftCell[1] === i) {\n                scrollable = true;\n            }\n        }\n        if (!beforeViewportIdx.length && !hiddenIndex.length) {\n            return;\n        }\n        if (args.hide) {\n            if (!hiddenIndex.length) {\n                return;\n            }\n            if (hiddenIndex.length <= this.parent.getThreshold('col') || !this.parent.scrollSettings.enableVirtualization) {\n                this.removeCell(sheet, hiddenIndex);\n            }\n            if (this.parent.scrollSettings.enableVirtualization) {\n                if (hiddenIndex[0] === this.parent.viewport.leftIndex) {\n                    this.parent.viewport.leftIndex = skipHiddenIdx(sheet, hiddenIndex[hiddenIndex.length - 1] + 1, true, 'columns');\n                }\n                if (scrollable) {\n                    var scrollWidth_1 = 0;\n                    hiddenIndex.slice(0, hiddenIndex.indexOf(topLeftCell[1])).forEach(function (colIdx) {\n                        scrollWidth_1 += getColumnWidth(sheet, colIdx, true);\n                    });\n                    if (scrollWidth_1) {\n                        this.parent.notify(setScrollEvent, { set: false });\n                        var content = this.parent.getMainContent();\n                        content.scrollLeft -= scrollWidth_1;\n                        this.parent.notify(onContentScroll, { scrollLeft: content.scrollLeft, preventScroll: true, skipHidden: true });\n                        getUpdateUsingRaf(function () { return _this.parent.notify(setScrollEvent, { set: true }); });\n                    }\n                }\n                if (this.parent.scrollSettings.isFinite) {\n                    var colCount = skipHiddenIdx(sheet, sheet.colCount - 1, false, 'columns');\n                    var startIdx = this.parent.viewport.leftIndex;\n                    var endIndex = this.parent.viewport.rightIndex;\n                    if (endIndex + hiddenIndex.length >= colCount) {\n                        var index = skipHiddenIdx(sheet, startIdx - ((endIndex + hiddenIndex.length) - colCount), false, 'columns');\n                        if (index > -1) {\n                            this.parent.viewport.leftIndex = index;\n                            this.parent.viewport.leftIndex -= this.parent.hiddenCount(endIndex, colCount);\n                        }\n                        this.parent.viewport.rightIndex = colCount;\n                        if (startIdx !== this.parent.viewport.leftIndex || endIndex !== this.parent.viewport.rightIndex) {\n                            this.parent.renderModule.refreshUI({ skipUpdateOnFirst: this.parent.viewport.leftIndex === skipHiddenIdx(sheet, 0, true, 'columns'), rowIndex: this.parent.viewport.topIndex, colIndex: this.parent.viewport.leftIndex, refresh: 'Column' });\n                        }\n                        else {\n                            this.parent.notify(updateTableWidth, { refresh: 'Column' });\n                        }\n                        this.parent.selectRange(sheet.selectedRange);\n                        return;\n                    }\n                }\n                if (hiddenIndex.length <= this.parent.getThreshold('col')) {\n                    var indexes = this.parent.skipHidden(this.parent.viewport.rightIndex + 1, this.parent.viewport.rightIndex + hiddenIndex.length, 'columns');\n                    this.parent.viewport.rightIndex = indexes[1];\n                    this.parent.renderModule.refreshUI({ rowIndex: this.parent.viewport.topIndex, colIndex: indexes[0], direction: '', refresh: 'ColumnPart' }, \"\" + getRangeAddress([this.parent.viewport.topIndex, indexes[0], this.parent.viewport.bottomIndex, indexes[1]]));\n                }\n                else {\n                    this.parent.renderModule.refreshUI({ skipUpdateOnFirst: this.parent.viewport.leftIndex === skipHiddenIdx(sheet, 0, true, 'columns'), rowIndex: this.parent.viewport.topIndex, colIndex: this.parent.viewport.leftIndex,\n                        refresh: 'Column' });\n                }\n            }\n            this.parent.selectRange(sheet.selectedRange);\n        }\n        else {\n            if (beforeViewportIdx.length) {\n                beforeViewportIdx.sort(function (i, j) { return i - j; });\n                if (this.parent.scrollSettings.enableVirtualization && beforeViewportIdx[0] < this.parent.getThreshold('col')) {\n                    var rowIdx = getCellIndexes(sheet.topLeftCell)[0] + 1;\n                    this.parent.setSheetPropertyOnMute(sheet, 'topLeftCell', \"A\" + rowIdx);\n                    this.parent.renderModule.refreshUI({ skipUpdateOnFirst: true, rowIndex: this.parent.viewport.topIndex, colIndex: 0,\n                        refresh: 'Column' });\n                    this.parent.selectRange(sheet.selectedRange);\n                }\n                else {\n                    this.parent.goTo(getCellAddress(this.parent.viewport.topIndex, beforeViewportIdx[0]));\n                }\n                return;\n            }\n            if (hiddenIndex.length <= this.parent.getThreshold('col') || !this.parent.scrollSettings.enableVirtualization) {\n                this.appendCell(sheet, hiddenIndex);\n                if (this.parent.scrollSettings.enableVirtualization) {\n                    this.parent.notify(virtualContentLoaded, { refresh: 'Column' });\n                }\n            }\n            else {\n                this.parent.renderModule.refreshUI({ skipUpdateOnFirst: this.parent.viewport.leftIndex === skipHiddenIdx(sheet, 0, true, 'columns'), rowIndex: this.parent.viewport.topIndex, colIndex: this.parent.viewport.leftIndex,\n                    refresh: 'Column' });\n            }\n            this.parent.selectRange(sheet.selectedRange);\n        }\n    };\n    ShowHide.prototype.removeCell = function (sheet, indexes) {\n        var _this = this;\n        var startIdx;\n        var endIdx;\n        var hRow;\n        var row;\n        var hColgrp;\n        var colgrp;\n        var rowIdx = 0;\n        var cellIdx = this.parent.getViewportIndex(indexes[0], true) + 1;\n        var cell;\n        if (this.parent.scrollSettings.enableVirtualization) {\n            startIdx = this.parent.viewport.topIndex;\n            endIdx = this.parent.viewport.bottomIndex;\n        }\n        else {\n            startIdx = 0;\n            endIdx = sheet.rowCount - 1;\n        }\n        var table = this.parent.getContentTable();\n        var nextIdx;\n        colgrp = table.getElementsByTagName('colgroup')[0];\n        var colSpan;\n        if (sheet.showHeaders) {\n            var hTable = this.parent.getColHeaderTable();\n            hColgrp = hTable.getElementsByTagName('colgroup')[0];\n            hRow = hTable.rows[0];\n        }\n        var modelLen = indexes.length - 1;\n        var prevIdx;\n        while (startIdx <= endIdx) {\n            if (isHiddenRow(sheet, startIdx)) {\n                startIdx++;\n                continue;\n            }\n            row = table.rows[rowIdx];\n            indexes.forEach(function (idx, index) {\n                detach(row.cells[cellIdx]);\n                if (rowIdx === 0) {\n                    if (sheet.showHeaders) {\n                        detach(hRow.cells[cellIdx]);\n                        detach(hColgrp.children[cellIdx]);\n                    }\n                    detach(colgrp.children[cellIdx]);\n                }\n                if (index === 0) {\n                    cell = getCell(startIdx, idx, sheet) || {};\n                    if (cell.colSpan !== undefined && (cell.rowSpan === undefined || cell.colSpan > 1)) {\n                        _this.parent.notify(hiddenMerge, { rowIdx: startIdx, colIdx: idx, model: 'col',\n                            start: indexes[0], end: indexes[modelLen] });\n                    }\n                }\n                if (index === modelLen) {\n                    nextIdx = skipHiddenIdx(sheet, idx + 1, true, 'columns');\n                    var borderLeft = _this.parent.getCellStyleValue(['borderLeft'], [rowIdx, nextIdx]).borderLeft;\n                    if (borderLeft !== '') {\n                        _this.parent.notify(applyCellFormat, { onActionUpdate: false, rowIdx: rowIdx, colIdx: nextIdx,\n                            style: { borderLeft: borderLeft }, row: row, first: '' });\n                    }\n                    cell = getCell(startIdx, idx, sheet) || {};\n                    if (cell.colSpan !== undefined && (cell.rowSpan === undefined || cell.colSpan > 1)) {\n                        _this.parent.notify(hiddenMerge, { rowIdx: startIdx, colIdx: idx, model: 'col',\n                            start: indexes[0], end: indexes[modelLen], isEnd: true });\n                    }\n                }\n            });\n            startIdx++;\n            rowIdx++;\n        }\n        if (cellIdx - 1 > -1) {\n            if (sheet.showHeaders && hRow.cells[cellIdx - 1]) {\n                hRow.cells[cellIdx - 1].classList.add('e-hide-start');\n            }\n        }\n        if (hRow.cells[cellIdx]) {\n            hRow.cells[cellIdx].classList.add('e-hide-end');\n        }\n    };\n    ShowHide.prototype.appendCell = function (sheet, indexes) {\n        var _this = this;\n        var startIdx;\n        var endIdx;\n        var hRow;\n        var row;\n        var hColgrp;\n        var colgrp;\n        var rowIdx = 0;\n        var prevIdx;\n        var hFrag = document.createDocumentFragment();\n        var frag = document.createDocumentFragment();\n        var colFrag = document.createDocumentFragment();\n        if (this.parent.scrollSettings.enableVirtualization) {\n            startIdx = this.parent.viewport.topIndex;\n            endIdx = this.parent.viewport.bottomIndex;\n        }\n        else {\n            startIdx = 0;\n            endIdx = sheet.rowCount - 1;\n        }\n        var table = this.parent.getContentTable();\n        var hTable = this.parent.getColHeaderTable();\n        colgrp = table.getElementsByTagName('colgroup')[0];\n        if (sheet.showHeaders) {\n            hColgrp = hTable.getElementsByTagName('colgroup')[0];\n            hRow = hTable.rows[0];\n        }\n        var cellRenderer = this.parent.serviceLocator.getService('cell');\n        indexes.sort(function (i, j) { return i - j; });\n        var cellModel;\n        var mergeCollection = [];\n        var cellIdx = [];\n        var cell;\n        var refCell;\n        var modelLen = indexes.length - 1;\n        while (startIdx <= endIdx) {\n            if (isHiddenRow(sheet, startIdx)) {\n                startIdx++;\n                continue;\n            }\n            row = table.rows[rowIdx];\n            indexes.forEach(function (idx, index) {\n                if (rowIdx === 0) {\n                    cellIdx[index] = _this.parent.getViewportIndex(idx, true);\n                    if (colgrp.children[cellIdx[index]]) {\n                        colgrp.insertBefore(_this.parent.sheetModule.updateCol(sheet, idx), colgrp.children[cellIdx[index]]);\n                        if (sheet.showHeaders) {\n                            refCell = hRow.cells[cellIdx[index]];\n                            if (index === 0 && indexes[index] && !isHiddenCol(sheet, indexes[index] - 1)) {\n                                refCell.previousElementSibling.classList.remove('e-hide-start');\n                            }\n                            hRow.insertBefore(cellRenderer.renderColHeader(idx), refCell);\n                            if (index === modelLen) {\n                                refCell.classList.remove('e-hide-end');\n                            }\n                        }\n                    }\n                    else {\n                        colgrp.appendChild(_this.parent.sheetModule.updateCol(sheet, idx));\n                        if (sheet.showHeaders) {\n                            hRow.appendChild(cellRenderer.renderColHeader(idx));\n                        }\n                    }\n                    detach(colgrp.lastChild);\n                    if (sheet.showHeaders) {\n                        detach(hRow.lastChild);\n                        if (index === modelLen) {\n                            detach(hColgrp);\n                            hTable.insertBefore(colgrp.cloneNode(true), hTable.tHead[0]);\n                        }\n                    }\n                }\n                detach(row.lastChild);\n                refCell = row.cells[cellIdx[index]];\n                cell = cellRenderer.render({ rowIdx: startIdx, colIdx: idx, cell: getCell(startIdx, idx, sheet),\n                    address: getCellAddress(startIdx, idx), lastCell: idx === modelLen, isHeightCheckNeeded: true,\n                    first: idx !== skipHiddenIdx(sheet, 0, true, 'columns') && idx === _this.parent.viewport.leftIndex ? 'Column' : '',\n                    checkNextBorder: index === modelLen ? 'Column' : '' });\n                refCell ? row.insertBefore(cell, refCell) : row.appendChild(cell);\n                if (index === 0 && cell.previousSibling) {\n                    var borderLeft = _this.parent.getCellStyleValue(['borderLeft'], [rowIdx, skipHiddenIdx(sheet, indexes[indexes.length - 1] + 1, true, 'columns')]).borderLeft;\n                    if (borderLeft !== '') {\n                        prevIdx = skipHiddenIdx(sheet, indexes[0] - 1, false, 'columns');\n                        if (prevIdx > -1 && !_this.parent.getCellStyleValue(['borderRight'], [rowIdx, prevIdx]).borderRight &&\n                            !_this.parent.getCellStyleValue(['borderLeft'], [rowIdx, indexes[0]]).borderLeft) {\n                            cell.previousSibling.style.borderRight = '';\n                        }\n                    }\n                }\n                cellModel = getCell(rowIdx, idx, sheet) || {};\n                if (cellModel.colSpan !== undefined && (cellModel.rowSpan === undefined || cellModel.colSpan > 1)) {\n                    var mergeArgs = { range: [rowIdx, idx, rowIdx, idx], isAction: false, merge: true,\n                        type: 'All', skipChecking: true };\n                    _this.parent.notify(activeCellMergedRange, mergeArgs);\n                    if (!mergeCollection.length || mergeArgs.range[1] !== mergeCollection[mergeCollection.length - 1].range[1]) {\n                        mergeCollection.push(mergeArgs);\n                    }\n                }\n            });\n            startIdx++;\n            rowIdx++;\n        }\n        mergeCollection.forEach(function (mergeArgs) { _this.parent.notify(setMerge, mergeArgs); });\n        this.parent.viewport.rightIndex = skipHiddenIdx(sheet, this.parent.viewport.rightIndex - indexes.length, false, 'columns');\n    };\n    ShowHide.prototype.addEventListener = function () {\n        this.parent.on(hideShow, this.hideShow, this);\n        this.parent.on(spreadsheetDestroyed, this.destroy, this);\n    };\n    ShowHide.prototype.destroy = function () {\n        this.removeEventListener();\n        this.parent = null;\n    };\n    ShowHide.prototype.removeEventListener = function () {\n        this.parent.off(hideShow, this.hideShow);\n        this.parent.off(spreadsheetDestroyed, this.destroy);\n    };\n    return ShowHide;\n}());\nexport { ShowHide };\n","import { initiateHyperlink, locale, dialog, click, keyUp, createHyperlinkElement, getUpdateUsingRaf } from '../common/index';\nimport { editHyperlink, removeHyperlink, openHyperlink, editAlert } from '../common/index';\nimport { isNullOrUndefined, closest } from '@syncfusion/ej2-base';\nimport { getRangeIndexes, getCellIndexes, getCellAddress, getRangeAddress } from '../../workbook/common/address';\nimport { getTypeFromFormat, getCell } from '../../workbook/index';\nimport { beforeHyperlinkClick, afterHyperlinkClick } from '../../workbook/common/event';\nimport { isCellReference } from '../../workbook/index';\nimport { Tab, TreeView } from '@syncfusion/ej2-navigations';\n/**\n * `Hyperlink` module\n */\nvar SpreadsheetHyperlink = /** @class */ (function () {\n    /**\n     * Constructor for Hyperlink module.\n     */\n    function SpreadsheetHyperlink(parent) {\n        this.parent = parent;\n        this.addEventListener();\n    }\n    /**\n     * To destroy the Hyperlink module.\n     * @return {void}\n     */\n    SpreadsheetHyperlink.prototype.destroy = function () {\n        this.removeEventListener();\n        this.parent = null;\n    };\n    SpreadsheetHyperlink.prototype.addEventListener = function () {\n        this.parent.on(initiateHyperlink, this.initiateHyperlinkHandler, this);\n        this.parent.on(editHyperlink, this.editHyperlinkHandler, this);\n        this.parent.on(removeHyperlink, this.removeHyperlinkHandler, this);\n        this.parent.on(openHyperlink, this.openHyperlinkHandler, this);\n        this.parent.on(click, this.hyperlinkClickHandler, this);\n        this.parent.on(createHyperlinkElement, this.createHyperlinkElementHandler, this);\n        this.parent.on(keyUp, this.keyUpHandler, this);\n    };\n    SpreadsheetHyperlink.prototype.removeEventListener = function () {\n        if (!this.parent.isDestroyed) {\n            this.parent.off(initiateHyperlink, this.initiateHyperlinkHandler);\n            this.parent.off(editHyperlink, this.editHyperlinkHandler);\n            this.parent.off(removeHyperlink, this.removeHyperlinkHandler);\n            this.parent.off(openHyperlink, this.openHyperlinkHandler);\n            this.parent.off(click, this.hyperlinkClickHandler);\n            this.parent.off(createHyperlinkElement, this.createHyperlinkElementHandler);\n            this.parent.off(keyUp, this.keyUpHandler);\n        }\n    };\n    /**\n     * Gets the module name.\n     * @returns string\n     */\n    SpreadsheetHyperlink.prototype.getModuleName = function () {\n        return 'spreadsheetHyperlink';\n    };\n    SpreadsheetHyperlink.prototype.keyUpHandler = function (e) {\n        var trgt = e.target;\n        if (closest(trgt, '.e-document')) {\n            var hyperlinkText = document.querySelector('.e-hyp-text');\n            var hyperlinkSpan = this.parent.element.querySelector('.e-hyperlink-alert-span');\n            var dlgElement = closest(trgt, '.e-hyperlink-dlg') || closest(trgt, '.e-edithyperlink-dlg');\n            var footerEle = dlgElement.getElementsByClassName('e-footer-content')[0];\n            var insertBut = footerEle.firstChild;\n            if (hyperlinkText && hyperlinkText.value) {\n                if (!isCellReference(hyperlinkText.value.toUpperCase())) {\n                    this.showDialog();\n                    insertBut.setAttribute('disabled', 'true');\n                }\n                else if (hyperlinkSpan) {\n                    hyperlinkSpan.remove();\n                    insertBut.removeAttribute('disabled');\n                }\n            }\n        }\n        if (trgt.classList.contains('e-text') && closest(trgt, '.e-cont')) {\n            if (closest(trgt, '.e-webpage') && closest(trgt, '.e-webpage').getElementsByClassName('e-cont')[1] === trgt.parentElement) {\n                var dlgEle = closest(trgt, '.e-hyperlink-dlg') || closest(trgt, '.e-edithyperlink-dlg');\n                var ftrEle = dlgEle.getElementsByClassName('e-footer-content')[0];\n                var insertBut = ftrEle.firstChild;\n                if (trgt.value !== '') {\n                    insertBut.removeAttribute('disabled');\n                }\n                else {\n                    var linkDialog = closest(trgt, '.e-link-dialog');\n                    var webPage = linkDialog.querySelector('.e-webpage');\n                    var isUrl = webPage.querySelectorAll('.e-cont')[1].querySelector('.e-text').value ? true : false;\n                    if (!isUrl) {\n                        insertBut.setAttribute('disabled', 'true');\n                    }\n                }\n            }\n        }\n    };\n    SpreadsheetHyperlink.prototype.initiateHyperlinkHandler = function () {\n        var _this = this;\n        var l10n = this.parent.serviceLocator.getService(locale);\n        var sheet = this.parent.getActiveSheet();\n        if (sheet.isProtected && !sheet.protectSettings.insertLink) {\n            this.parent.notify(editAlert, null);\n            return;\n        }\n        if (!this.parent.element.querySelector('.e-hyperlink-dlg')) {\n            var dialogInst_1 = this.parent.serviceLocator.getService(dialog);\n            dialogInst_1.show({\n                width: 323, isModal: true, showCloseIcon: true, cssClass: 'e-hyperlink-dlg',\n                header: l10n.getConstant('InsertLink'),\n                beforeOpen: function (args) {\n                    var dlgArgs = {\n                        dialogName: 'InsertLinkDialog',\n                        element: args.element, target: args.target, cancel: args.cancel\n                    };\n                    _this.parent.trigger('dialogBeforeOpen', dlgArgs);\n                    if (dlgArgs.cancel) {\n                        args.cancel = true;\n                    }\n                    dialogInst_1.dialogInstance.content = _this.hyperlinkContent();\n                    dialogInst_1.dialogInstance.dataBind();\n                    _this.parent.element.focus();\n                },\n                buttons: [{\n                        buttonModel: {\n                            content: l10n.getConstant('Insert'), isPrimary: true, disabled: true\n                        },\n                        click: function () {\n                            _this.dlgClickHandler(dialogInst_1);\n                            dialogInst_1.hide();\n                        }\n                    }]\n            });\n        }\n    };\n    SpreadsheetHyperlink.prototype.dlgClickHandler = function (dialogInst) {\n        var value;\n        var address;\n        var spreadsheetInst = this.parent;\n        var item = this.parent.element.querySelector('.e-link-dialog').\n            getElementsByClassName('e-content')[0].querySelector('.e-item.e-active');\n        if (item) {\n            if (item.querySelector('.e-webpage')) {\n                value = item.getElementsByClassName('e-cont')[0].querySelector('.e-text').value;\n                address = item.getElementsByClassName('e-cont')[1].querySelector('.e-text').value;\n                var args = { address: address };\n                this.parent.insertHyperlink(args, this.parent.getActiveSheet().activeCell, value, false);\n            }\n            else {\n                value = item.getElementsByClassName('e-cont')[0].querySelector('.e-text').value;\n                address = item.getElementsByClassName('e-cont')[1].querySelector('.e-text').value;\n                var sheetIdx = void 0;\n                var dlgContent = item.getElementsByClassName('e-cont')[2];\n                if (dlgContent.getElementsByClassName('e-list-item')[0].querySelector('.e-active')) {\n                    var sheetName = item.getElementsByClassName('e-cont')[2].querySelector('.e-active').textContent;\n                    var sheets = spreadsheetInst.sheets;\n                    for (var idx = 0; idx < sheets.length; idx++) {\n                        if (sheets[idx].name === sheetName) {\n                            sheetIdx = idx + 1;\n                        }\n                    }\n                    address = sheetName + '!' + address.toUpperCase();\n                    var args = { address: address };\n                    this.parent.insertHyperlink(args, this.parent.getActiveSheet().activeCell, value, false);\n                }\n                else if (dlgContent.querySelector('.e-active')) {\n                    var definedName = item.getElementsByClassName('e-cont')[2].querySelector('.e-active').textContent;\n                    for (var idx = 0; idx < this.parent.definedNames.length; idx++) {\n                        if (this.parent.definedNames[idx].name === definedName) {\n                            var args = {\n                                address: this.parent.definedNames[idx].name,\n                            };\n                            this.parent.insertHyperlink(args, this.parent.getActiveSheet().activeCell, value, false);\n                        }\n                    }\n                }\n            }\n        }\n    };\n    SpreadsheetHyperlink.prototype.showDialog = function () {\n        if (this.parent.element.querySelector('.e-hyperlink-alert-span')) {\n            this.parent.element.querySelector('.e-hyperlink-alert-span').remove();\n        }\n        var l10n = this.parent.serviceLocator.getService(locale);\n        var hyperlinkSpan = this.parent.createElement('span', {\n            className: 'e-hyperlink-alert-span',\n            innerHTML: l10n.getConstant('HyperlinkAlert')\n        });\n        (this.parent.element.querySelector('.e-hyperlink-dlg').querySelector('.e-dlg-content')).appendChild(hyperlinkSpan);\n    };\n    SpreadsheetHyperlink.prototype.editHyperlinkHandler = function () {\n        var _this = this;\n        var isWeb = true;\n        var l10n = this.parent.serviceLocator.getService(locale);\n        var dialogInst = this.parent.serviceLocator.getService(dialog);\n        dialogInst.show({\n            width: 323, isModal: true, showCloseIcon: true, cssClass: 'e-edithyperlink-dlg',\n            header: l10n.getConstant('EditLink'),\n            beforeOpen: function (args) {\n                var dlgArgs = {\n                    dialogName: 'EditLinkDialog',\n                    element: args.element, target: args.target, cancel: args.cancel\n                };\n                _this.parent.trigger('dialogBeforeOpen', dlgArgs);\n                if (dlgArgs.cancel) {\n                    args.cancel = true;\n                }\n                dialogInst.dialogInstance.content = _this.hyperEditContent();\n                dialogInst.dialogInstance.dataBind();\n                _this.parent.element.focus();\n            },\n            buttons: [{\n                    buttonModel: {\n                        content: l10n.getConstant('Update'), isPrimary: true\n                    },\n                    click: function () {\n                        _this.dlgClickHandler(dialogInst);\n                        dialogInst.hide();\n                    }\n                }]\n        });\n    };\n    SpreadsheetHyperlink.prototype.openHyperlinkHandler = function () {\n        var cellIndexes = getCellIndexes(this.parent.getActiveSheet().activeCell);\n        var trgt = this.parent.getCell(cellIndexes[0], cellIndexes[1]);\n        if (trgt.getElementsByClassName('e-hyperlink')[0]) {\n            trgt = trgt.querySelector('.e-hyperlink');\n        }\n        this.hlOpenHandler(trgt);\n    };\n    SpreadsheetHyperlink.prototype.removeHyperlinkHandler = function (cell) {\n        this.parent.removeHyperlink(cell);\n    };\n    // tslint:disable-next-line:max-func-body-length\n    SpreadsheetHyperlink.prototype.hlOpenHandler = function (trgt) {\n        var _this = this;\n        if (trgt.classList.contains('e-hyperlink')) {\n            var range = ['', ''];\n            var selRange = void 0;\n            var rangeIndexes = void 0;\n            var isEmpty = true;\n            trgt.style.color = '#551A8B';\n            var sheet = this.parent.getActiveSheet();\n            var colIdx = parseInt(trgt.parentElement.getAttribute('aria-colindex'), 10) - 1;\n            var rowIdx = parseInt(trgt.parentElement.parentElement.getAttribute('aria-rowindex'), 10) - 1;\n            var rangeAddr = sheet.rows[rowIdx].cells[colIdx].hyperlink;\n            var address = void 0;\n            var befArgs = void 0;\n            var aftArgs = void 0;\n            befArgs = { hyperlink: rangeAddr, cell: this.parent.getActiveSheet().activeCell, target: '_blank', cancel: false };\n            this.parent.trigger(beforeHyperlinkClick, befArgs);\n            if (befArgs.cancel) {\n                return;\n            }\n            rangeAddr = befArgs.hyperlink;\n            aftArgs = { hyperlink: rangeAddr, cell: this.parent.getActiveSheet().activeCell };\n            if (typeof (rangeAddr) === 'string') {\n                address = rangeAddr;\n            }\n            if (typeof (rangeAddr) === 'object') {\n                address = rangeAddr.address;\n            }\n            var definedNameCheck = address;\n            if (address.indexOf('http://') === -1 && address.indexOf('https://') === -1 && address.indexOf('ftp://') === -1) {\n                if (!isNullOrUndefined(address)) {\n                    if (this.parent.definedNames) {\n                        for (var idx = 0; idx < this.parent.definedNames.length; idx++) {\n                            if (this.parent.definedNames[idx].name === address) {\n                                address = this.parent.definedNames[idx].refersTo;\n                                address = address.slice(1);\n                                break;\n                            }\n                        }\n                    }\n                    if (address.indexOf('!') !== -1) {\n                        range = address.split('!');\n                        if (range[0].indexOf(' ') !== -1) {\n                            range[0] = range[0].slice(1, range[0].length - 1);\n                        }\n                    }\n                    else {\n                        range[0] = this.parent.getActiveSheet().name;\n                        range[1] = address;\n                    }\n                    selRange = range[1];\n                    var sheetIdx_1;\n                    for (var idx = 0; idx < this.parent.sheets.length; idx++) {\n                        if (this.parent.sheets[idx].name === range[0]) {\n                            sheetIdx_1 = idx;\n                        }\n                    }\n                    sheet = this.parent.sheets[sheetIdx_1];\n                    if (range[1].indexOf(':') !== -1) {\n                        var colIndex = range[1].indexOf(':');\n                        var left = range[1].substr(0, colIndex);\n                        var right = range[1].substr(colIndex + 1, range[1].length);\n                        left = left.replace('$', '');\n                        right = right.replace('$', '');\n                        if (right.match(/\\D/g) && !right.match(/[0-9]/g) && left.match(/\\D/g) && !left.match(/[0-9]/g)) {\n                            selRange = left + '1' + ':' + right + sheet.rowCount;\n                            left = left + '1';\n                            right = right + sheet.rowCount;\n                            range[1] = left + ':' + right;\n                        }\n                        else if (!right.match(/\\D/g) && right.match(/[0-9]/g) && !left.match(/\\D/g) && left.match(/[0-9]/g)) {\n                            selRange = getCellAddress(parseInt(left, 10) - 1, 0) + ':' +\n                                getCellAddress(parseInt(right, 10) - 1, sheet.colCount - 1);\n                            rangeIndexes = [parseInt(left, 10) - 1, 0, parseInt(right, 10) - 1, sheet.colCount - 1];\n                            isEmpty = false;\n                        }\n                    }\n                    var isDefinedNamed = void 0;\n                    var definedname = this.parent.definedNames;\n                    if (!isNullOrUndefined(definedname)) {\n                        for (var idx = 0; idx < definedname.length; idx++) {\n                            if (definedname[idx].name === definedNameCheck) {\n                                isDefinedNamed = true;\n                                break;\n                            }\n                        }\n                    }\n                    if (isCellReference(range[1]) || isDefinedNamed) {\n                        rangeIndexes = isEmpty ? getRangeIndexes(range[1]) : rangeIndexes;\n                        if (this.parent.scrollSettings.enableVirtualization) {\n                            rangeIndexes[0] = rangeIndexes[0] >= this.parent.viewport.topIndex ?\n                                rangeIndexes[0] - this.parent.viewport.topIndex : rangeIndexes[0];\n                            rangeIndexes[1] = rangeIndexes[1] >= this.parent.viewport.leftIndex ?\n                                rangeIndexes[1] - this.parent.viewport.leftIndex : rangeIndexes[1];\n                        }\n                        if (!isNullOrUndefined(sheet)) {\n                            var rangeAddr_1 = getRangeAddress(rangeIndexes);\n                            if (sheet === this.parent.getActiveSheet()) {\n                                getUpdateUsingRaf(function () { _this.parent.goTo(rangeAddr_1); });\n                            }\n                            else {\n                                if (rangeAddr_1.indexOf(':') >= 0) {\n                                    var addArr = rangeAddr_1.split(':');\n                                    rangeAddr_1 = addArr[0] === addArr[1] ? addArr[0] : rangeAddr_1;\n                                }\n                                getUpdateUsingRaf(function () { _this.parent.goTo(_this.parent.sheets[sheetIdx_1].name + '!' + rangeAddr_1); });\n                            }\n                        }\n                    }\n                }\n            }\n            else {\n                trgt.setAttribute('target', befArgs.target);\n            }\n            this.parent.trigger(afterHyperlinkClick, aftArgs);\n        }\n    };\n    SpreadsheetHyperlink.prototype.hyperlinkClickHandler = function (e) {\n        var trgt = e.target;\n        if (closest(trgt, '.e-link-dialog') && closest(trgt, '.e-toolbar-item')) {\n            var dlgEle = closest(trgt, '.e-hyperlink-dlg') || closest(trgt, '.e-edithyperlink-dlg');\n            var ftrEle = dlgEle.getElementsByClassName('e-footer-content')[0];\n            var insertBut = ftrEle.firstChild;\n            var docEle = dlgEle.querySelector('.e-document');\n            var webEle = dlgEle.querySelector('.e-webpage');\n            var webEleText = webEle ? webEle.querySelectorAll('.e-cont')[0].querySelector('.e-text').value :\n                docEle.querySelectorAll('.e-cont')[0].querySelector('.e-text').value;\n            var docEleText = docEle ? docEle.querySelectorAll('.e-cont')[0].querySelector('.e-text').value :\n                webEleText;\n            var toolbarItems = closest(trgt, '.e-toolbar-items');\n            if (toolbarItems.getElementsByClassName('e-toolbar-item')[1].classList.contains('e-active')) {\n                var actEle = docEle.querySelectorAll('.e-cont')[2].querySelector('.e-active');\n                docEle.querySelectorAll('.e-cont')[0].querySelector('.e-text').value = webEleText;\n                if (closest(actEle, '.e-list-item').classList.contains('e-level-2') && insertBut.hasAttribute('disabled')) {\n                    insertBut.removeAttribute('disabled');\n                }\n                else if (closest(actEle, '.e-list-item').classList.contains('e-level-1') && !insertBut.hasAttribute('disabled')) {\n                    insertBut.setAttribute('disabled', 'true');\n                }\n            }\n            else {\n                var isEmpty = webEle.querySelectorAll('.e-cont')[1].querySelector('.e-text').value ? false : true;\n                webEle.querySelectorAll('.e-cont')[0].querySelector('.e-text').value = docEleText;\n                if (isEmpty && !insertBut.hasAttribute('disabled')) {\n                    insertBut.setAttribute('disabled', 'true');\n                }\n                else if (!isEmpty && insertBut.hasAttribute('disabled')) {\n                    insertBut.removeAttribute('disabled');\n                }\n            }\n        }\n        if (closest(trgt, '.e-list-item') && trgt.classList.contains('e-fullrow')) {\n            var item = this.parent.element.getElementsByClassName('e-link-dialog')[0].\n                getElementsByClassName('e-content')[0].getElementsByClassName('e-active')[0];\n            var cellRef = item.getElementsByClassName('e-cont')[1].getElementsByClassName('e-text')[0];\n            var dlgEle = closest(trgt, '.e-hyperlink-dlg') || closest(trgt, '.e-edithyperlink-dlg');\n            var ftrEle = dlgEle.getElementsByClassName('e-footer-content')[0];\n            var insertBut = ftrEle.firstChild;\n            if (closest(trgt, '.e-list-item').classList.contains('e-level-2')) {\n                if (closest(trgt, '.e-list-item').getAttribute('data-uid') === 'defName') {\n                    if (!cellRef.classList.contains('e-disabled') && !cellRef.hasAttribute('readonly')) {\n                        cellRef.setAttribute('readonly', 'true');\n                        cellRef.classList.add('e-disabled');\n                        cellRef.setAttribute('disabled', 'true');\n                    }\n                }\n                else if (closest(trgt, '.e-list-item').getAttribute('data-uid') === 'sheet') {\n                    if (cellRef.classList.contains('e-disabled') && cellRef.hasAttribute('readonly')) {\n                        cellRef.removeAttribute('readonly');\n                        cellRef.classList.remove('e-disabled');\n                        cellRef.removeAttribute('disabled');\n                    }\n                }\n                if (insertBut.hasAttribute('disabled')) {\n                    insertBut.removeAttribute('disabled');\n                }\n            }\n            else if (closest(trgt, '.e-list-item').classList.contains('e-level-1')) {\n                insertBut.setAttribute('disabled', 'true');\n            }\n        }\n        else {\n            this.hlOpenHandler(trgt);\n        }\n    };\n    SpreadsheetHyperlink.prototype.createHyperlinkElementHandler = function (args) {\n        var cell = args.cell;\n        var td = args.td;\n        var rowIdx = args.rowIdx;\n        var colIdx = args.colIdx;\n        var hyperEle = this.parent.createElement('a', { className: 'e-hyperlink e-hyperlink-style' });\n        if (!isNullOrUndefined(cell.hyperlink)) {\n            var hyperlink = cell.hyperlink;\n            if (typeof (hyperlink) === 'string') {\n                if (hyperlink.indexOf('http://') === -1 && hyperlink.indexOf('https://') === -1 &&\n                    hyperlink.indexOf('ftp://') === -1 && hyperlink.indexOf('www.') !== -1) {\n                    hyperlink = 'http://' + hyperlink;\n                }\n                if (hyperlink.indexOf('http://') === 0 || hyperlink.indexOf('https://') === 0 || hyperlink.indexOf('ftp://') === 0) {\n                    hyperEle.setAttribute('href', hyperlink);\n                    hyperEle.setAttribute('target', '_blank');\n                }\n                else if (hyperlink.includes('=') || hyperlink.includes('!')) {\n                    hyperEle.setAttribute('ref', hyperlink);\n                }\n                hyperEle.innerText = td.innerText !== '' ? td.innerText : hyperlink;\n                td.textContent = '';\n                td.innerText = '';\n                td.appendChild(hyperEle);\n            }\n            else if (typeof (hyperlink) === 'object') {\n                if (hyperlink.address.indexOf('http://') === 0 || hyperlink.address.indexOf('https://') === 0 ||\n                    hyperlink.address.indexOf('ftp://') === 0) {\n                    hyperEle.setAttribute('href', hyperlink.address);\n                    hyperEle.setAttribute('target', '_blank');\n                }\n                else if (hyperlink.address.includes('=') || hyperlink.address.includes('!')) {\n                    hyperEle.setAttribute('ref', hyperlink.address);\n                }\n                if (getTypeFromFormat(cell.format) === 'Accounting') {\n                    hyperEle.innerHTML = td.innerHTML;\n                }\n                else {\n                    hyperEle.innerText = td.innerText !== '' ? td.innerText : hyperlink.address;\n                }\n                td.textContent = '';\n                td.innerText = '';\n                td.appendChild(hyperEle);\n            }\n        }\n        else if (td.querySelector('a') && cell.hyperlink) {\n            if (typeof (cell.hyperlink) === 'string') {\n                td.querySelector('a').setAttribute('href', cell.hyperlink);\n            }\n        }\n    };\n    SpreadsheetHyperlink.prototype.hyperEditContent = function () {\n        var isWeb = true;\n        var dialog = this.hyperlinkContent();\n        var indexes = getRangeIndexes(this.parent.getActiveSheet().activeCell);\n        var cell = this.parent.sheets[this.parent.getActiveSheet().id - 1].rows[indexes[0]].cells[indexes[1]];\n        if (this.parent.scrollSettings.enableVirtualization) {\n            indexes[0] = indexes[0] - this.parent.viewport.topIndex;\n            indexes[1] = indexes[1] - this.parent.viewport.leftIndex;\n        }\n        var value = this.parent.getDisplayText(cell);\n        var address;\n        var hyperlink = cell.hyperlink;\n        if (typeof (hyperlink) === 'string') {\n            address = hyperlink;\n            value = value || address;\n            if (address.indexOf('http://') === -1 && address.indexOf('https://') === -1 && address.indexOf('ftp://') === -1) {\n                isWeb = false;\n            }\n        }\n        else if (typeof (hyperlink) === 'object') {\n            address = hyperlink.address;\n            value = value || address;\n            if (address.indexOf('http://') === -1 && address.indexOf('https://') === -1 && address.indexOf('ftp://') === -1) {\n                isWeb = false;\n            }\n        }\n        var item = dialog.querySelector('.e-content');\n        if (isWeb) {\n            var webContElem = item.querySelector('.e-webpage');\n            webContElem.getElementsByClassName('e-cont')[0].getElementsByClassName('e-text')[0].setAttribute('value', value);\n            if (typeof (hyperlink) === 'string') {\n                webContElem.getElementsByClassName('e-cont')[1].querySelector('.e-text').setAttribute('value', hyperlink);\n            }\n            else {\n                var address_1;\n                address_1 = webContElem.getElementsByClassName('e-cont')[1].querySelector('.e-text');\n                address_1.setAttribute('value', hyperlink.address);\n            }\n        }\n        else {\n            var isDefinedNamed = void 0;\n            var docContElem = item.querySelector('.e-document');\n            docContElem.getElementsByClassName('e-cont')[0].getElementsByClassName('e-text')[0].setAttribute('value', value);\n            var rangeArr = void 0;\n            var sheet = this.parent.getActiveSheet();\n            var sheetIdx = void 0;\n            if (this.parent.definedNames) {\n                for (var idx = 0; idx < this.parent.definedNames.length; idx++) {\n                    if (this.parent.definedNames[idx].name === address) {\n                        isDefinedNamed = true;\n                        break;\n                    }\n                }\n            }\n            if (isDefinedNamed) {\n                var cellRef = void 0;\n                cellRef = docContElem.getElementsByClassName('e-cont')[1].getElementsByClassName('e-text')[0];\n                cellRef.setAttribute('readonly', 'true');\n                cellRef.classList.add('e-disabled');\n                cellRef.setAttribute('disabled', 'true');\n                var treeCont = docContElem.getElementsByClassName('e-cont')[2];\n                var listEle = treeCont.querySelectorAll('.e-list-item.e-level-1')[1];\n                for (var idx = 0; idx < listEle.getElementsByTagName('li').length; idx++) {\n                    if (listEle.getElementsByTagName('li')[idx].innerText === address) {\n                        listEle.getElementsByTagName('li')[idx].classList.add('e-active');\n                    }\n                }\n            }\n            else {\n                if (address && address.indexOf('!') !== -1) {\n                    rangeArr = address.split('!');\n                    sheetIdx = parseInt(rangeArr[0].replace(/\\D/g, ''), 10) - 1;\n                    sheet = this.parent.sheets[sheetIdx];\n                }\n                var sheetName = rangeArr[0];\n                docContElem.getElementsByClassName('e-cont')[1].querySelector('.e-text').setAttribute('value', rangeArr[1]);\n                var treeCont = docContElem.getElementsByClassName('e-cont')[2];\n                var listEle = treeCont.querySelectorAll('.e-list-item.e-level-1')[0];\n                for (var idx = 0; idx < listEle.getElementsByTagName('li').length; idx++) {\n                    if (listEle.getElementsByTagName('li')[idx].innerText === sheetName) {\n                        if (listEle.getElementsByTagName('li')[idx].classList.contains('e-active')) {\n                            break;\n                        }\n                        else {\n                            listEle.getElementsByTagName('li')[idx].classList.add('e-active');\n                        }\n                    }\n                    else {\n                        if (listEle.getElementsByTagName('li')[idx].classList.contains('e-active')) {\n                            listEle.getElementsByTagName('li')[idx].classList.remove('e-active');\n                        }\n                    }\n                }\n            }\n        }\n        return dialog;\n    };\n    // tslint:disable-next-line:max-func-body-length\n    SpreadsheetHyperlink.prototype.hyperlinkContent = function () {\n        var l10n = this.parent.serviceLocator.getService(locale);\n        var idx = 0;\n        var selIdx = 0;\n        var isWeb = true;\n        var isDefinedName;\n        var isCellRef = true;\n        var address;\n        var indexes = getRangeIndexes(this.parent.getActiveSheet().activeCell);\n        var sheet = this.parent.getActiveSheet();\n        var cell = getCell(indexes[0], indexes[1], sheet);\n        var isEnable = true;\n        if (cell) {\n            if ((cell.value && typeof (cell.value) === 'string' && cell.value.match('[A-Za-z]+') !== null) ||\n                cell.value === '' || isNullOrUndefined(cell.value)) {\n                isEnable = true;\n            }\n            else {\n                isEnable = false;\n            }\n            var hyperlink = cell.hyperlink;\n            if (typeof (hyperlink) === 'string') {\n                var hl = hyperlink;\n                if (hl.indexOf('http://') === -1 && hl.indexOf('https://') === -1 && hl.indexOf('ftp://') === -1) {\n                    address = hyperlink;\n                    isWeb = false;\n                }\n            }\n            else if (typeof (hyperlink) === 'object') {\n                var hl = hyperlink.address;\n                if (hl.indexOf('http://') === -1 && hl.indexOf('https://') === -1 && hl.indexOf('ftp://') === -1) {\n                    address = hyperlink.address;\n                    isWeb = false;\n                }\n            }\n            if (isWeb) {\n                selIdx = 0;\n            }\n            else {\n                selIdx = 1;\n            }\n            if (this.parent.definedNames) {\n                for (var idx_1 = 0; idx_1 < this.parent.definedNames.length; idx_1++) {\n                    if (this.parent.definedNames[idx_1].name === address) {\n                        isDefinedName = true;\n                        isCellRef = false;\n                        break;\n                    }\n                }\n            }\n        }\n        var dialogElem = this.parent.createElement('div', { className: 'e-link-dialog' });\n        var webContElem = this.parent.createElement('div', { className: 'e-webpage' });\n        var docContElem = this.parent.createElement('div', { className: 'e-document' });\n        var headerTabs = new Tab({\n            selectedItem: selIdx,\n            items: [\n                {\n                    header: { 'text': l10n.getConstant('WebPage') },\n                    content: webContElem\n                },\n                {\n                    header: { 'text': l10n.getConstant('ThisDocument') },\n                    content: docContElem\n                },\n            ]\n        });\n        headerTabs.appendTo(dialogElem);\n        if (isWeb) {\n            dialogElem.querySelector('.e-toolbar-items').querySelector('.e-indicator').setAttribute('style', 'left: 0; right: 136px');\n        }\n        else {\n            dialogElem.querySelector('.e-toolbar-items').querySelector('.e-indicator').setAttribute('style', 'left: 136px; right: 0');\n        }\n        var textCont = this.parent.createElement('div', { className: 'e-cont' });\n        var urlCont = this.parent.createElement('div', { className: 'e-cont' });\n        var textH = this.parent.createElement('div', { className: 'e-header', innerHTML: l10n.getConstant('DisplayText') });\n        var urlH = this.parent.createElement('div', { className: 'e-header', innerHTML: l10n.getConstant('Url') });\n        var textInput = this.parent.createElement('input', { className: 'e-input e-text', attrs: { 'type': 'Text' }, });\n        if (!isEnable) {\n            textInput.classList.add('e-disabled');\n            textInput.setAttribute('readonly', 'true');\n            textInput.setAttribute('disabled', 'true');\n        }\n        if (cell && isNullOrUndefined(cell.hyperlink)) {\n            textInput.setAttribute('value', this.parent.getDisplayText(cell));\n        }\n        var urlInput = this.parent.createElement('input', { className: 'e-input e-text', attrs: { 'type': 'Text' } });\n        textInput.setAttribute('placeholder', l10n.getConstant('EnterTheTextToDisplay'));\n        urlInput.setAttribute('placeholder', l10n.getConstant('EnterTheUrl'));\n        textCont.appendChild(textInput);\n        textCont.insertBefore(textH, textInput);\n        urlCont.appendChild(urlInput);\n        urlCont.insertBefore(urlH, urlInput);\n        webContElem.appendChild(urlCont);\n        webContElem.insertBefore(textCont, urlCont);\n        var cellRef = [];\n        var definedName = [];\n        var sheets = this.parent.sheets;\n        for (idx; idx < this.parent.sheets.length; idx++) {\n            var sheetName = this.parent.sheets[idx].name;\n            if (sheets[idx] === this.parent.getActiveSheet()) {\n                cellRef.push({\n                    nodeId: 'sheet',\n                    nodeText: sheetName.indexOf(' ') !== -1 ? '\\'' + sheetName + '\\'' : sheetName,\n                    selected: true\n                });\n            }\n            else {\n                cellRef.push({\n                    nodeId: 'sheet',\n                    nodeText: sheetName.indexOf(' ') !== -1 ? '\\'' + sheetName + '\\'' : sheetName\n                });\n            }\n        }\n        for (idx = 0; idx < this.parent.definedNames.length; idx++) {\n            definedName.push({\n                nodeId: 'defName',\n                nodeText: this.parent.definedNames[idx].name\n            });\n        }\n        var data = [\n            {\n                nodeId: '01', nodeText: l10n.getConstant('CellReference'), expanded: isCellRef,\n                nodeChild: cellRef\n            },\n            {\n                nodeId: '02', nodeText: l10n.getConstant('DefinedNames'), expanded: isDefinedName,\n                nodeChild: definedName\n            },\n        ];\n        var treeObj = new TreeView({\n            fields: { dataSource: data, id: 'nodeId', text: 'nodeText', child: 'nodeChild' }\n        });\n        var cellrefCont = this.parent.createElement('div', { className: 'e-cont' });\n        var cellrefH = this.parent.createElement('div', { className: 'e-header', innerHTML: l10n.getConstant('CellReference') });\n        var cellrefInput = this.parent.createElement('input', {\n            className: 'e-input e-text e-hyp-text',\n            attrs: { 'type': 'Text' }\n        });\n        cellrefInput.setAttribute('value', 'A1');\n        cellrefCont.appendChild(cellrefInput);\n        cellrefCont.insertBefore(cellrefH, cellrefInput);\n        var textCont1 = this.parent.createElement('div', { className: 'e-cont' });\n        var textH1 = this.parent.createElement('div', { className: 'e-header', innerHTML: l10n.getConstant('DisplayText') });\n        var textInput1 = this.parent.createElement('input', { className: 'e-input e-text', attrs: { 'type': 'Text' } });\n        if (!isEnable) {\n            textInput1.classList.add('e-disabled');\n            textInput1.setAttribute('readonly', 'true');\n            textInput1.setAttribute('disabled', 'true');\n        }\n        if (cell && isNullOrUndefined(cell.hyperlink)) {\n            textInput1.setAttribute('value', this.parent.getDisplayText(cell));\n        }\n        textInput1.setAttribute('placeholder', l10n.getConstant('EnterTheTextToDisplay'));\n        textCont1.appendChild(textInput1);\n        textCont1.insertBefore(textH1, textInput1);\n        var sheetCont = this.parent.createElement('div', { className: 'e-cont' });\n        var sheetH = this.parent.createElement('div', { className: 'e-header', innerHTML: l10n.getConstant('Sheet') });\n        var refCont = this.parent.createElement('div', { className: 'e-refcont' });\n        sheetCont.appendChild(refCont);\n        sheetCont.insertBefore(sheetH, refCont);\n        docContElem.appendChild(cellrefCont);\n        docContElem.insertBefore(textCont1, cellrefCont);\n        treeObj.appendTo(refCont);\n        docContElem.appendChild(sheetCont);\n        return dialogElem;\n    };\n    return SpreadsheetHyperlink;\n}());\nexport { SpreadsheetHyperlink };\n","import { locale, deleteImage, createImageElement } from '../../spreadsheet/index';\nimport { performUndoRedo, updateUndoRedoCollection, enableToolbarItems, completeAction } from '../common/index';\nimport { setActionData, getBeforeActionData, updateAction, initiateFilterUI } from '../common/index';\nimport { setUndoRedo } from '../common/index';\nimport { selectRange, clearUndoRedoCollection, setMaxHgt, getMaxHgt, setRowEleHeight } from '../common/index';\nimport { getRangeFromAddress, getRangeIndexes, getSheet, workbookEditOperation } from '../../workbook/index';\nimport { getCell, setCell, getSheetIndex, wrapEvent, getSheetIndexFromId } from '../../workbook/index';\nimport { setMerge, getRangeAddress, getColumnHeaderText } from '../../workbook/index';\nimport { addClass } from '@syncfusion/ej2-base';\nimport { getFilteredCollection, setCellFormat } from '../../workbook/index';\n/**\n * UndoRedo module allows to perform undo redo functionalities.\n */\nvar UndoRedo = /** @class */ (function () {\n    function UndoRedo(parent) {\n        this.undoCollection = [];\n        this.redoCollection = [];\n        this.isUndo = false;\n        this.undoRedoStep = 100;\n        this.parent = parent;\n        this.addEventListener();\n    }\n    UndoRedo.prototype.setActionData = function (options) {\n        var sheet = this.parent.getActiveSheet();\n        var address;\n        var cells = [];\n        var cutCellDetails = [];\n        var args = options.args;\n        var eventArgs = args.eventArgs;\n        switch (args.action) {\n            case 'format':\n                address = getRangeIndexes(args.eventArgs.range);\n                break;\n            case 'clipboard':\n                var copiedInfo = eventArgs.copiedInfo;\n                address = getRangeIndexes(getRangeFromAddress(eventArgs.pastedRange));\n                if (copiedInfo.isCut) {\n                    cutCellDetails = this.getCellDetails(copiedInfo.range, getSheet(this.parent, getSheetIndexFromId(this.parent, copiedInfo.sId)));\n                }\n                break;\n            case 'beforeSort':\n                address = getRangeIndexes(args.eventArgs.range);\n                if (address[0] === address[2] && (address[2] - address[0]) === 0) { //if selected range is a single cell \n                    address[0] = 0;\n                    address[1] = 0;\n                    address[2] = sheet.usedRange.rowIndex;\n                    address[3] = sheet.usedRange.colIndex;\n                }\n                break;\n            case 'beforeCellSave':\n                address = getRangeIndexes(eventArgs.address);\n                break;\n            case 'beforeWrap':\n                address = this.parent.getAddressInfo(eventArgs.address).indices;\n                break;\n            case 'beforeReplace':\n                address = this.parent.getAddressInfo(eventArgs.address).indices;\n                break;\n            case 'beforeClear':\n                address = getRangeIndexes(eventArgs.range);\n                break;\n            case 'beforeInsertImage':\n                address = getRangeIndexes(eventArgs.range);\n                break;\n            case 'beforeInsertChart':\n                address = getRangeIndexes(eventArgs.range);\n                break;\n            case 'filter':\n                address = getRangeIndexes(eventArgs.range);\n                break;\n        }\n        cells = this.getCellDetails(address, sheet);\n        this.beforeActionData = { cellDetails: cells, cutCellDetails: cutCellDetails };\n    };\n    UndoRedo.prototype.getBeforeActionData = function (args) {\n        args.beforeDetails = this.beforeActionData;\n    };\n    UndoRedo.prototype.performUndoRedo = function (args) {\n        var undoRedoArgs = args.isUndo ? this.undoCollection.pop() : this.redoCollection.pop();\n        this.isUndo = args.isUndo;\n        if (undoRedoArgs) {\n            switch (undoRedoArgs.action) {\n                case 'cellSave':\n                case 'format':\n                case 'sorting':\n                case 'wrap':\n                    undoRedoArgs = this.performOperation(undoRedoArgs);\n                    break;\n                case 'clipboard':\n                    undoRedoArgs = this.undoForClipboard(undoRedoArgs);\n                    break;\n                case 'resize':\n                    undoRedoArgs = this.undoForResize(undoRedoArgs);\n                    break;\n                case 'hideShow':\n                    undoRedoArgs.eventArgs.hide = !undoRedoArgs.eventArgs.hide;\n                    updateAction(undoRedoArgs, this.parent);\n                    break;\n                case 'replace':\n                    undoRedoArgs = this.performOperation(undoRedoArgs);\n                    break;\n                case 'insert':\n                case 'filter':\n                    updateAction(undoRedoArgs, this.parent, !args.isUndo);\n                    break;\n                case 'delete':\n                    updateAction(undoRedoArgs, this.parent, !args.isUndo);\n                    break;\n                case 'validation':\n                    updateAction(undoRedoArgs, this.parent, !args.isUndo);\n                    break;\n                case 'merge':\n                    undoRedoArgs.eventArgs.merge = !undoRedoArgs.eventArgs.merge;\n                    updateAction(undoRedoArgs, this.parent);\n                    break;\n                case 'clear':\n                    undoRedoArgs = this.performOperation(undoRedoArgs);\n                    break;\n                case 'conditionalFormat':\n                    updateAction(undoRedoArgs, this.parent, !args.isUndo);\n                    break;\n                case 'clearCF':\n                    updateAction(undoRedoArgs, this.parent, !args.isUndo);\n                    break;\n                case 'insertImage':\n                    updateAction(undoRedoArgs, this.parent, !args.isUndo);\n                    break;\n                case 'imageRefresh':\n                    updateAction(undoRedoArgs, this.parent, !args.isUndo);\n                    break;\n                case 'insertChart':\n                case 'deleteChart':\n                    updateAction(undoRedoArgs, this.parent, !args.isUndo);\n                    break;\n                case 'chartRefresh':\n                    updateAction(undoRedoArgs, this.parent, !args.isUndo);\n                    break;\n            }\n            args.isUndo ? this.redoCollection.push(undoRedoArgs) : this.undoCollection.push(undoRedoArgs);\n            if (this.undoCollection.length > this.undoRedoStep) {\n                this.undoCollection.splice(0, 1);\n            }\n            if (this.redoCollection.length > this.undoRedoStep) {\n                this.redoCollection.splice(0, 1);\n            }\n            this.updateUndoRedoIcons();\n            var completeArgs = Object.assign({}, undoRedoArgs.eventArgs);\n            completeArgs.requestType = args.isUndo ? 'undo' : 'redo';\n            delete completeArgs.beforeActionData;\n            if (!args.isPublic) {\n                this.parent.notify(completeAction, { eventArgs: completeArgs, action: 'undoRedo' });\n            }\n        }\n    };\n    UndoRedo.prototype.updateUndoRedoCollection = function (options) {\n        var actionList = ['clipboard', 'format', 'sorting', 'cellSave', 'resize', 'resizeToFit', 'wrap', 'hideShow', 'replace',\n            'validation', 'merge', 'clear', 'conditionalFormat', 'clearCF', 'insertImage', 'imageRefresh', 'insertChart', 'deleteChart',\n            'chartRefresh', 'filter'];\n        if ((options.args.action === 'insert' || options.args.action === 'delete') && options.args.eventArgs.modelType !== 'Sheet') {\n            actionList.push(options.args.action);\n        }\n        var action = options.args.action;\n        if (actionList.indexOf(action) === -1 && !options.isPublic) {\n            return;\n        }\n        var eventArgs = options.args.eventArgs;\n        if (action === 'clipboard' || action === 'sorting' || action === 'format' || action === 'cellSave' ||\n            action === 'wrap' || action === 'replace' || action === 'validation' || action === 'clear' || action === 'conditionalFormat' ||\n            action === 'clearCF' || action === 'insertImage' || action === 'imageRefresh' || action === 'insertChart' ||\n            action === 'chartRefresh' || action === 'filter') {\n            var beforeActionDetails = { beforeDetails: { cellDetails: [] } };\n            this.parent.notify(getBeforeActionData, beforeActionDetails);\n            eventArgs.beforeActionData = beforeActionDetails.beforeDetails;\n        }\n        this.undoCollection.push(options.args);\n        this.redoCollection = [];\n        if (this.undoCollection.length > this.undoRedoStep) {\n            this.undoCollection.splice(0, 1);\n        }\n        this.updateUndoRedoIcons();\n    };\n    UndoRedo.prototype.clearUndoRedoCollection = function () {\n        this.undoCollection = [];\n        this.redoCollection = [];\n        this.updateUndoRedoIcons();\n    };\n    UndoRedo.prototype.updateUndoRedoIcons = function () {\n        var l10n = this.parent.serviceLocator.getService(locale);\n        this.parent.notify(enableToolbarItems, [{\n                tab: l10n.getConstant('Home'), items: [this.parent.element.id + '_undo'],\n                enable: this.undoCollection.length > 0\n            }]);\n        this.parent.notify(enableToolbarItems, [{\n                tab: l10n.getConstant('Home'), items: [this.parent.element.id + '_redo'],\n                enable: this.redoCollection.length > 0\n            }]);\n    };\n    UndoRedo.prototype.undoForClipboard = function (args) {\n        var _this = this;\n        var eventArgs = args.eventArgs;\n        var address = eventArgs.pastedRange.split('!');\n        var range = getRangeIndexes(address[1]);\n        var sheetIndex = getSheetIndex(this.parent, address[0]);\n        var sheet = getSheet(this.parent, sheetIndex);\n        var copiedInfo = eventArgs.copiedInfo;\n        var actionData = eventArgs.beforeActionData;\n        var isRefresh = this.checkRefreshNeeded(sheetIndex);\n        var pictureElem;\n        if (args.eventArgs.requestType === 'imagePaste') {\n            var copiedShapeInfo = eventArgs.copiedShapeInfo;\n            if (this.isUndo) {\n                pictureElem = copiedShapeInfo.pictureElem;\n                if (copiedShapeInfo.isCut) {\n                    this.parent.notify(deleteImage, {\n                        id: pictureElem.id, sheetIdx: eventArgs.pasteSheetIndex + 1\n                    });\n                    this.parent.notify(createImageElement, {\n                        options: {\n                            data: pictureElem.style.backgroundImage.replace(/url\\((['\"])?(.*?)\\1\\)/gi, '$2'),\n                            height: copiedShapeInfo.height, width: copiedShapeInfo.width, imageId: pictureElem.id\n                        },\n                        range: copiedShapeInfo.copiedRange, isPublic: false, isUndoRedo: true\n                    });\n                }\n                else {\n                    this.parent.notify(deleteImage, {\n                        id: eventArgs.pastedPictureElement.id, sheetIdx: eventArgs.pasteSheetIndex + 1\n                    });\n                }\n            }\n            else {\n                if (copiedShapeInfo.isCut) {\n                    pictureElem = copiedShapeInfo.pictureElem;\n                    this.parent.notify(deleteImage, {\n                        id: pictureElem.id, sheetIdx: copiedShapeInfo.sId\n                    });\n                    this.parent.notify(createImageElement, {\n                        options: {\n                            data: pictureElem.style.backgroundImage.replace(/url\\((['\"])?(.*?)\\1\\)/gi, '$2'),\n                            height: copiedShapeInfo.height, width: copiedShapeInfo.width, imageId: pictureElem.id\n                        },\n                        range: copiedShapeInfo.pastedRange, isPublic: false, isUndoRedo: true\n                    });\n                }\n                else {\n                    pictureElem = eventArgs.pastedPictureElement;\n                    this.parent.notify(createImageElement, {\n                        options: {\n                            data: pictureElem.style.backgroundImage.replace(/url\\((['\"])?(.*?)\\1\\)/gi, '$2'),\n                            height: pictureElem.offsetHeight, width: pictureElem.offsetWidth, imageId: pictureElem.id\n                        },\n                        range: copiedShapeInfo.pastedRange, isPublic: false, isUndoRedo: true\n                    });\n                }\n            }\n        }\n        else {\n            if (this.isUndo) {\n                if (copiedInfo.isCut) {\n                    var cells = actionData.cutCellDetails;\n                    this.updateCellDetails(cells, getSheet(this.parent, getSheetIndexFromId(this.parent, copiedInfo.sId)), copiedInfo.range, isRefresh);\n                    this.parent.notify(getFilteredCollection, null);\n                    for (var i = 0; i < this.parent.sheets.length; i++) {\n                        var sheetIndex_1 = getSheetIndexFromId(this.parent, copiedInfo.sId);\n                        if (this.parent.filterCollection && this.parent.filterCollection[i] &&\n                            this.parent.filterCollection[i].sheetIdx === eventArgs.pasteSheetIndex) {\n                            var filterCol = this.parent.filterCollection[i];\n                            var fRange = getRangeIndexes(filterCol.filterRange);\n                            var endCol = getColumnHeaderText(range[3]);\n                            var fEndCol = getColumnHeaderText(fRange[3]);\n                            if (fRange[0] === range[0] && fRange[1] === range[1] && endCol === fEndCol) {\n                                this.parent.notify(initiateFilterUI, {\n                                    predicates: null, range: filterCol.filterRange,\n                                    sIdx: eventArgs.pasteSheetIndex, isCut: true\n                                });\n                                this.parent.notify(initiateFilterUI, {\n                                    predicates: null,\n                                    range: getRangeAddress(copiedInfo.range), sIdx: sheetIndex_1, isCut: true\n                                });\n                            }\n                        }\n                    }\n                }\n                this.updateCellDetails(actionData.cellDetails, sheet, range, isRefresh);\n                setMaxHgt(sheet, range[0], range[1], 20);\n                var hgt = getMaxHgt(sheet, range[0]);\n                setRowEleHeight(this.parent, sheet, hgt, range[0]);\n                eventArgs.mergeCollection.forEach(function (mergeArgs) {\n                    mergeArgs.merge = !mergeArgs.merge;\n                    _this.parent.notify(setMerge, mergeArgs);\n                    mergeArgs.merge = !mergeArgs.merge;\n                });\n            }\n            else {\n                updateAction(args, this.parent, copiedInfo.isCut);\n            }\n            if (isRefresh) {\n                this.parent.notify(selectRange, { indexes: range });\n            }\n        }\n        return args;\n    };\n    UndoRedo.prototype.undoForResize = function (args) {\n        var eventArgs = args.eventArgs;\n        if (eventArgs.hide === undefined) {\n            if (eventArgs.isCol) {\n                var temp = eventArgs.oldWidth;\n                eventArgs.oldWidth = eventArgs.width;\n                eventArgs.width = temp;\n            }\n            else {\n                var temp = eventArgs.oldHeight;\n                eventArgs.oldHeight = eventArgs.height;\n                eventArgs.height = temp;\n            }\n        }\n        else {\n            eventArgs.hide = !eventArgs.hide;\n        }\n        updateAction(args, this.parent);\n        return args;\n    };\n    UndoRedo.prototype.performOperation = function (args) {\n        var eventArgs = args.eventArgs;\n        var address = (args.action === 'cellSave' || args.action === 'wrap' || args.action === 'replace') ?\n            eventArgs.address.split('!')\n            : eventArgs.range.split('!');\n        var range = getRangeIndexes(address[1]);\n        var indexes = range;\n        var sheetIndex = getSheetIndex(this.parent, address[0]);\n        var sheet = getSheet(this.parent, sheetIndex);\n        var actionData = eventArgs.beforeActionData;\n        var isRefresh = this.checkRefreshNeeded(sheetIndex);\n        if (this.isUndo) {\n            this.updateCellDetails(actionData.cellDetails, sheet, range, isRefresh, args);\n            setMaxHgt(sheet, range[0], range[1], 20);\n            var hgt = getMaxHgt(sheet, range[0]);\n            setRowEleHeight(this.parent, sheet, hgt, range[0]);\n        }\n        else {\n            /* tslint:disable-next-line:no-any */\n            var argsEventArgs = args.eventArgs;\n            var activeCellIndexes = getRangeIndexes(sheet.activeCell);\n            var cellValue = this.parent.getCellStyleValue(['textDecoration'], activeCellIndexes).textDecoration;\n            if (argsEventArgs && argsEventArgs.style && argsEventArgs.style.textDecoration) {\n                var value = argsEventArgs.style.textDecoration;\n                var changedValue = value;\n                var changedStyle = void 0;\n                var removeProp = false;\n                if (cellValue === 'underline') {\n                    changedValue = value === 'underline' ? 'none' : 'underline line-through';\n                }\n                else if (cellValue === 'line-through') {\n                    changedValue = value === 'line-through' ? 'none' : 'underline line-through';\n                }\n                else if (cellValue === 'underline line-through') {\n                    changedValue = value === 'underline' ? 'line-through' : 'underline';\n                    removeProp = true;\n                }\n                if (changedValue === 'none') {\n                    removeProp = true;\n                }\n                argsEventArgs.style.textDecoration = changedValue;\n                args.eventArgs = argsEventArgs;\n                this.parent.notify(setCellFormat, {\n                    style: { textDecoration: changedValue }, range: activeCellIndexes, refreshRibbon: true,\n                    onActionUpdate: true\n                });\n                for (var i = indexes[0]; i <= indexes[2]; i++) {\n                    for (var j = indexes[1]; j <= indexes[3]; j++) {\n                        if (i === activeCellIndexes[0] && j === activeCellIndexes[1]) {\n                            continue;\n                        }\n                        changedStyle = {};\n                        cellValue = this.parent.getCellStyleValue(['textDecoration'], [i, j]).textDecoration;\n                        if (cellValue === 'none') {\n                            if (removeProp) {\n                                continue;\n                            }\n                            changedStyle.textDecoration = value;\n                        }\n                        else if (cellValue === 'underline' || cellValue === 'line-through') {\n                            if (removeProp) {\n                                if (value === cellValue) {\n                                    changedStyle.textDecoration = 'none';\n                                }\n                                else {\n                                    continue;\n                                }\n                            }\n                            else {\n                                changedStyle.textDecoration = value !== cellValue ? 'underline line-through' : value;\n                            }\n                        }\n                        else if (cellValue === 'underline line-through') {\n                            if (removeProp) {\n                                changedStyle.textDecoration = value === 'underline' ? 'line-through' : 'underline';\n                            }\n                            else {\n                                continue;\n                            }\n                        }\n                        this.parent.notify(setCellFormat, {\n                            style: { textDecoration: changedStyle.textDecoration }, range: [i, j, i, j], refreshRibbon: true,\n                            onActionUpdate: true\n                        });\n                    }\n                }\n                argsEventArgs.style.textDecoration = value;\n                args.eventArgs = argsEventArgs;\n            }\n            else {\n                updateAction(args, this.parent);\n            }\n        }\n        if (isRefresh) {\n            this.parent.notify(selectRange, { indexes: range });\n        }\n        return args;\n    };\n    UndoRedo.prototype.getCellDetails = function (address, sheet) {\n        var cells = [];\n        var cell;\n        for (var i = address[0]; i <= address[2]; i++) {\n            for (var j = address[1]; j <= address[3]; j++) {\n                cell = getCell(i, j, sheet);\n                cells.push({\n                    rowIndex: i, colIndex: j, format: cell ? cell.format : null,\n                    style: cell && cell.style ? Object.assign({}, cell.style) : null, value: cell ? cell.value : '', formula: cell ?\n                        cell.formula : '', wrap: cell && cell.wrap, rowSpan: cell && cell.rowSpan, colSpan: cell && cell.colSpan,\n                    hyperlink: cell && cell.hyperlink, image: cell && cell.image && cell.chart\n                });\n            }\n        }\n        return cells;\n    };\n    UndoRedo.prototype.updateCellDetails = function (cells, sheet, range, isRefresh, args) {\n        var len = cells.length;\n        var cellElem;\n        for (var i = 0; i < len; i++) {\n            setCell(cells[i].rowIndex, cells[i].colIndex, sheet, {\n                value: cells[i].value, format: cells[i].format,\n                style: cells[i].style && Object.assign({}, cells[i].style), formula: cells[i].formula,\n                wrap: cells[i].wrap, rowSpan: cells[i].rowSpan,\n                colSpan: cells[i].colSpan, hyperlink: cells[i].hyperlink\n            });\n            if (cells[i].formula) {\n                this.parent.notify(workbookEditOperation, {\n                    action: 'updateCellValue', address: [cells[i].rowIndex, cells[i].colIndex, cells[i].rowIndex,\n                        cells[i].colIndex], value: cells[i].formula\n                });\n            }\n            if (args && args.action === 'wrap' && args.eventArgs.wrap) {\n                this.parent.notify(wrapEvent, {\n                    range: [cells[i].rowIndex, cells[i].colIndex, cells[i].rowIndex,\n                        cells[i].colIndex], wrap: false, sheet: sheet\n                });\n            }\n            if (args && cells[i].hyperlink && args.action === 'clear') {\n                args.eventArgs.range = sheet.name + '!' + getRangeAddress([cells[i].rowIndex, cells[i].colIndex, cells[i].rowIndex,\n                    cells[i].colIndex]);\n                cellElem = this.parent.getCell(cells[i].rowIndex, cells[i].colIndex);\n                if (args.eventArgs.type === 'Clear All' || args.eventArgs.type === 'Clear Hyperlinks') {\n                    this.parent.addHyperlink(cells[i].hyperlink, args.eventArgs.range);\n                }\n                else if (args.eventArgs.type === 'Clear Formats') {\n                    addClass(cellElem.querySelectorAll('.e-hyperlink'), 'e-hyperlink-style');\n                }\n            }\n        }\n        if (isRefresh) {\n            this.parent.serviceLocator.getService('cell').refreshRange(range);\n        }\n    };\n    UndoRedo.prototype.checkRefreshNeeded = function (sheetIndex) {\n        var isRefresh = true;\n        if (sheetIndex !== this.parent.activeSheetIndex) {\n            this.parent.activeSheetIndex = sheetIndex;\n            this.parent.dataBind();\n            isRefresh = false;\n        }\n        return isRefresh;\n    };\n    UndoRedo.prototype.addEventListener = function () {\n        this.parent.on(performUndoRedo, this.performUndoRedo, this);\n        this.parent.on(updateUndoRedoCollection, this.updateUndoRedoCollection, this);\n        this.parent.on(setActionData, this.setActionData, this);\n        this.parent.on(getBeforeActionData, this.getBeforeActionData, this);\n        this.parent.on(clearUndoRedoCollection, this.clearUndoRedoCollection, this);\n        this.parent.on(setUndoRedo, this.updateUndoRedoIcons, this);\n    };\n    UndoRedo.prototype.removeEventListener = function () {\n        if (!this.parent.isDestroyed) {\n            this.parent.off(performUndoRedo, this.performUndoRedo);\n            this.parent.off(updateUndoRedoCollection, this.updateUndoRedoCollection);\n            this.parent.off(setActionData, this.setActionData);\n            this.parent.off(getBeforeActionData, this.getBeforeActionData);\n            this.parent.off(clearUndoRedoCollection, this.clearUndoRedoCollection);\n            this.parent.off(setUndoRedo, this.updateUndoRedoIcons);\n        }\n    };\n    /**\n     * Destroy undo redo module.\n     */\n    UndoRedo.prototype.destroy = function () {\n        this.removeEventListener();\n        this.parent = null;\n    };\n    /**\n     * Get the undo redo module name.\n     */\n    UndoRedo.prototype.getModuleName = function () {\n        return 'undoredo';\n    };\n    return UndoRedo;\n}());\nexport { UndoRedo };\n","import { closest, Browser } from '@syncfusion/ej2-base';\nimport { ribbonClick, inView, setMaxHgt, getMaxHgt, WRAPTEXT, setRowEleHeight, rowHeightChanged, beginAction } from '../common/index';\nimport { completeAction, getTextHeight, getLines, } from '../common/index';\nimport { getCell, wrap as wrapText, wrapEvent, getRow } from '../../workbook/index';\nimport { getRowHeight, getAddressFromSelectedRange, getColumnsWidth } from '../../workbook/index';\n/**\n * Represents Wrap Text support for Spreadsheet.\n */\nvar WrapText = /** @class */ (function () {\n    /**\n     * Constructor for the Spreadsheet Wrap Text module.\n     * @private\n     */\n    function WrapText(parent) {\n        this.parent = parent;\n        this.addEventListener();\n    }\n    WrapText.prototype.addEventListener = function () {\n        this.parent.on(ribbonClick, this.ribbonClickHandler, this);\n        this.parent.on(wrapEvent, this.wrapTextHandler, this);\n        this.parent.on(rowHeightChanged, this.rowHeightChangedHandler, this);\n    };\n    WrapText.prototype.removeEventListener = function () {\n        if (!this.parent.isDestroyed) {\n            this.parent.off(ribbonClick, this.ribbonClickHandler);\n            this.parent.off(wrapEvent, this.wrapTextHandler);\n            this.parent.off(rowHeightChanged, this.rowHeightChangedHandler);\n        }\n    };\n    WrapText.prototype.wrapTextHandler = function (args) {\n        if (inView(this.parent, args.range, true)) {\n            var ele = void 0;\n            var cell = void 0;\n            var colwidth = void 0;\n            var isCustomHgt = void 0;\n            var maxHgt = void 0;\n            var hgt = void 0;\n            for (var i = args.range[0]; i <= args.range[2]; i++) {\n                maxHgt = 0;\n                isCustomHgt = getRow(args.sheet, i).customHeight;\n                for (var j = args.range[1]; j <= args.range[3]; j++) {\n                    ele = args.initial ? args.td : this.parent.getCell(i, j);\n                    if (ele) {\n                        args.wrap ? ele.classList.add(WRAPTEXT) : ele.classList.remove(WRAPTEXT);\n                        if (isCustomHgt) {\n                            if (ele.children.length === 0 || !ele.querySelector('.e-wrap-content')) {\n                                ele.innerHTML\n                                    = this.parent.createElement('span', {\n                                        className: 'e-wrap-content',\n                                        innerHTML: ele.innerHTML\n                                    }).outerHTML;\n                            }\n                        }\n                    }\n                    if (Browser.isIE) {\n                        ele.classList.add('e-ie-wrap');\n                    }\n                    if (!isCustomHgt) {\n                        cell = getCell(i, j, args.sheet);\n                        colwidth = getColumnsWidth(args.sheet, j, cell.colSpan > 1 ? j + cell.colSpan - 1 : j);\n                        var displayText = this.parent.getDisplayText(cell);\n                        if (displayText.indexOf('\\n') < 0) {\n                            var editElem = this.parent.element.querySelector('.e-spreadsheet-edit');\n                            if (editElem) {\n                                if (editElem.textContent.indexOf('\\n') > -1) {\n                                    displayText = editElem.textContent;\n                                }\n                            }\n                        }\n                        if (displayText) {\n                            if (args.wrap) {\n                                if (ele && ele.classList.contains('e-alt-unwrap')) {\n                                    ele.classList.remove('e-alt-unwrap');\n                                }\n                                var lines = void 0;\n                                var n = 0;\n                                var p = void 0;\n                                if (displayText.indexOf('\\n') > -1) {\n                                    var splitVal = displayText.split('\\n');\n                                    var valLength = splitVal.length;\n                                    for (p = 0; p < valLength; p++) {\n                                        lines = getLines(splitVal[p], colwidth, cell.style, this.parent.cellStyle);\n                                        if (lines === 0) {\n                                            lines = 1; // for empty new line\n                                        }\n                                        n = n + lines;\n                                    }\n                                    lines = n;\n                                }\n                                else {\n                                    lines = getLines(displayText, colwidth, cell.style, this.parent.cellStyle);\n                                }\n                                hgt = getTextHeight(this.parent, cell.style || this.parent.cellStyle, lines) + 1;\n                                maxHgt = Math.max(maxHgt, hgt);\n                                setMaxHgt(args.sheet, i, j, hgt);\n                            }\n                            else {\n                                if (displayText.indexOf('\\n') > -1) {\n                                    ele.classList.add('e-alt-unwrap');\n                                }\n                                hgt = getTextHeight(this.parent, cell.style || this.parent.cellStyle, 1);\n                                setMaxHgt(args.sheet, i, j, hgt);\n                                maxHgt = Math.max(getMaxHgt(args.sheet, i), 20);\n                            }\n                        }\n                        else if (!args.wrap) {\n                            setMaxHgt(args.sheet, i, j, 20);\n                            maxHgt = 20;\n                        }\n                        if (j === args.range[3] && ((args.wrap && maxHgt > 20 && getMaxHgt(args.sheet, i) <= maxHgt) || (!args.wrap\n                            && getMaxHgt(args.sheet, i) < getRowHeight(args.sheet, i) && getRowHeight(args.sheet, i) > 20))) {\n                            setRowEleHeight(this.parent, args.sheet, maxHgt, i, args.row, args.hRow);\n                        }\n                    }\n                }\n            }\n        }\n    };\n    WrapText.prototype.ribbonClickHandler = function (args) {\n        var target = closest(args.originalEvent.target, '.e-btn');\n        if (target && target.id === this.parent.element.id + '_wrap') {\n            var wrap = target.classList.contains('e-active');\n            var address = getAddressFromSelectedRange(this.parent.getActiveSheet());\n            var eventArgs = { address: address, wrap: wrap, cancel: false };\n            this.parent.notify(beginAction, { action: 'beforeWrap', eventArgs: eventArgs });\n            if (!eventArgs.cancel) {\n                wrapText(this.parent.getActiveSheet().selectedRange, wrap, this.parent);\n                this.parent.notify(completeAction, { action: 'wrap', eventArgs: { address: address, wrap: wrap } });\n            }\n        }\n    };\n    WrapText.prototype.getTextWidth = function (text, style) {\n        if (style === void 0) { style = this.parent.cellStyle; }\n        var defaultStyle = this.parent.cellStyle;\n        var canvas = document.createElement('canvas');\n        var context = canvas.getContext('2d');\n        context.font = (style.fontStyle || defaultStyle.fontStyle) + ' ' + (style.fontWeight || defaultStyle.fontWeight) + ' '\n            + (style.fontSize || defaultStyle.fontSize) + ' ' + (style.fontFamily || defaultStyle.fontFamily);\n        return context.measureText(text).width;\n    };\n    WrapText.prototype.rowHeightChangedHandler = function (args) {\n        if (args.isCustomHgt) {\n            var sheet = this.parent.getActiveSheet();\n            var leftIdx = this.parent.viewport.leftIndex;\n            var rightIdx = leftIdx + this.parent.viewport.colCount + this.parent.getThreshold('col') * 2;\n            for (var i = leftIdx; i < rightIdx; i++) {\n                var cell = getCell(args.rowIdx, i, sheet);\n                if (cell && cell.wrap) {\n                    var ele = this.parent.getCell(args.rowIdx, i);\n                    if (ele.children.length === 0 || !ele.querySelector('.e-wrap-content')) {\n                        ele.innerHTML = this.parent.createElement('span', {\n                            className: 'e-wrap-content',\n                            innerHTML: ele.innerHTML\n                        }).outerHTML;\n                    }\n                }\n            }\n        }\n    };\n    /**\n     * For internal use only - Get the module name.\n     * @private\n     */\n    WrapText.prototype.getModuleName = function () {\n        return 'wrapText';\n    };\n    WrapText.prototype.destroy = function () {\n        this.removeEventListener();\n        this.parent = null;\n    };\n    return WrapText;\n}());\nexport { WrapText };\n","import { beginAction, completeAction, insertSheetTab, skipHiddenIdx, refreshImagePosition } from '../common/index';\nimport { insert, dataChanged } from '../../workbook/common/index';\nimport { getCell } from '../../workbook/index';\n/**\n * The `Insert` module is used to insert cells, rows, columns and sheets in to the spreadsheet.\n */\nvar Insert = /** @class */ (function () {\n    /**\n     * Constructor for the Spreadsheet insert module.\n     * @private\n     */\n    function Insert(parent) {\n        this.parent = parent;\n        this.addEventListener();\n    }\n    Insert.prototype.insert = function (args) {\n        var isAction;\n        if (args.isAction) {\n            isAction = true;\n            delete args.isAction;\n        }\n        if (isAction) {\n            this.parent.notify(beginAction, { eventArgs: args, action: 'insert' });\n        }\n        switch (args.modelType) {\n            case 'Sheet':\n                this.parent.notify(insertSheetTab, { startIdx: args.index, endIdx: args.index + (args.model.length - 1), preventUpdate: !isAction });\n                this.parent.renderModule.refreshSheet();\n                this.parent.element.focus();\n                break;\n            case 'Row':\n                if (!this.parent.scrollSettings.enableVirtualization || args.index <= this.parent.viewport.bottomIndex) {\n                    if (this.parent.scrollSettings.enableVirtualization) {\n                        if (args.index < this.parent.viewport.topIndex) {\n                            this.parent.viewport.topIndex += args.model.length;\n                        }\n                        this.parent.renderModule.refreshUI({\n                            skipUpdateOnFirst: this.parent.viewport.topIndex === skipHiddenIdx(this.parent.getActiveSheet(), 0, true), rowIndex: this.parent.viewport.topIndex, colIndex: this.parent.viewport.leftIndex, refresh: 'Row'\n                        });\n                    }\n                    else {\n                        this.parent.renderModule.refreshUI({ skipUpdateOnFirst: true, rowIndex: args.index, colIndex: 0, refresh: 'Row' });\n                    }\n                    this.parent.notify(dataChanged, args);\n                    this.parent.selectRange(this.parent.getActiveSheet().selectedRange);\n                }\n                break;\n            case 'Column':\n                if (!this.parent.scrollSettings.enableVirtualization || args.index <= this.parent.viewport.rightIndex) {\n                    if (this.parent.scrollSettings.enableVirtualization) {\n                        if (args.index < this.parent.viewport.leftIndex) {\n                            this.parent.viewport.leftIndex += args.model.length;\n                        }\n                        this.parent.renderModule.refreshUI({\n                            skipUpdateOnFirst: this.parent.viewport.leftIndex === skipHiddenIdx(this.parent.getActiveSheet(), 0, true, 'columns'), rowIndex: this.parent.viewport.topIndex, colIndex: this.parent.viewport.leftIndex, refresh: 'Column'\n                        });\n                    }\n                    else {\n                        this.parent.renderModule.refreshUI({\n                            skipUpdateOnFirst: true, rowIndex: 0, colIndex: args.index, refresh: 'Column'\n                        });\n                    }\n                    this.parent.selectRange(this.parent.getActiveSheet().selectedRange);\n                }\n                break;\n        }\n        this.refreshImgElement(args.model.length, this.parent.activeSheetIndex, args.modelType, args.index);\n        if (isAction) {\n            this.parent.notify(completeAction, { eventArgs: args, action: 'insert' });\n        }\n    };\n    Insert.prototype.refreshImgElement = function (count, sheetIdx, modelType, index) {\n        var sheet = this.parent.sheets[sheetIdx];\n        var cellObj;\n        var indexes = [0, 0, sheet.usedRange.rowIndex, sheet.usedRange.colIndex];\n        for (var i = 0; i <= indexes[2]; i++) {\n            for (var j = indexes[1]; j <= indexes[3]; j++) {\n                cellObj = getCell(i, j, sheet);\n                if (cellObj && cellObj.image && cellObj.image.length > 0) {\n                    if ((modelType === 'Row' && i >= index) || (modelType === 'Column' && j >= index)) {\n                        this.parent.notify(refreshImagePosition, {\n                            rowIdx: i, colIdx: j, sheetIdx: sheetIdx, type: modelType, count: count, status: 'insert'\n                        });\n                    }\n                }\n            }\n        }\n    };\n    Insert.prototype.addEventListener = function () {\n        this.parent.on(insert, this.insert, this);\n    };\n    /**\n     * Destroy insert module.\n     */\n    Insert.prototype.destroy = function () {\n        this.removeEventListener();\n        this.parent = null;\n    };\n    Insert.prototype.removeEventListener = function () {\n        if (!this.parent.isDestroyed) {\n            this.parent.off(insert, this.insert);\n        }\n    };\n    /**\n     * Get the insert module name.\n     */\n    Insert.prototype.getModuleName = function () {\n        return 'insert';\n    };\n    return Insert;\n}());\nexport { Insert };\n","import { beginAction, completeAction, skipHiddenIdx, refreshSheetTabs, refreshImagePosition } from '../common/index';\nimport { deleteAction, dataChanged } from '../../workbook/common/index';\nimport { getCell } from '../../workbook/index';\n/**\n * The `Delete` module is used to delete cells, rows, columns and sheets from the spreadsheet.\n */\nvar Delete = /** @class */ (function () {\n    /**\n     * Constructor for the Spreadsheet insert module.\n     * @private\n     */\n    function Delete(parent) {\n        this.parent = parent;\n        this.addEventListener();\n    }\n    Delete.prototype.delete = function (args) {\n        var isAction;\n        if (args.isAction) {\n            isAction = true;\n            delete args.isAction;\n        }\n        if (isAction) {\n            this.parent.notify(beginAction, { eventArgs: args, action: 'delete' });\n        }\n        if (args.modelType === 'Sheet') {\n            var activeSheetDeleted = args.activeSheetIndex >= args.startIndex && args.activeSheetIndex <= args.endIndex;\n            if (activeSheetDeleted) {\n                this.parent.setProperties({ activeSheetIndex: this.parent.skipHiddenSheets(args.startIndex < this.parent.sheets.length ? args.startIndex :\n                        (args.startIndex ? args.startIndex - 1 : 0)) }, true);\n            }\n            this.parent.notify(refreshSheetTabs, null);\n            if (activeSheetDeleted) {\n                this.parent.renderModule.refreshSheet();\n            }\n            this.parent.element.focus();\n        }\n        else if (args.modelType === 'Row') {\n            if (!this.parent.scrollSettings.enableVirtualization || args.startIndex <= this.parent.viewport.bottomIndex) {\n                if (this.parent.scrollSettings.enableVirtualization) {\n                    if (args.startIndex < this.parent.viewport.topIndex) {\n                        this.parent.viewport.topIndex -= args.model.length;\n                    }\n                    this.parent.renderModule.refreshUI({\n                        skipUpdateOnFirst: this.parent.viewport.topIndex === skipHiddenIdx(this.parent.getActiveSheet(), 0, true), rowIndex: this.parent.viewport.topIndex, refresh: 'Row',\n                        colIndex: this.parent.viewport.leftIndex\n                    });\n                }\n                else {\n                    this.parent.renderModule.refreshUI({ skipUpdateOnFirst: true, refresh: 'Row', rowIndex: args.startIndex, colIndex: 0 });\n                }\n            }\n            this.parent.selectRange(this.parent.getActiveSheet().selectedRange);\n        }\n        else {\n            if (!this.parent.scrollSettings.enableVirtualization || args.startIndex <= this.parent.viewport.rightIndex) {\n                if (this.parent.scrollSettings.enableVirtualization) {\n                    if (args.startIndex < this.parent.viewport.leftIndex) {\n                        this.parent.viewport.leftIndex -= args.model.length;\n                    }\n                    this.parent.renderModule.refreshUI({\n                        skipUpdateOnFirst: this.parent.viewport.leftIndex === skipHiddenIdx(this.parent.getActiveSheet(), 0, true, 'columns'), rowIndex: this.parent.viewport.topIndex, refresh: 'Column',\n                        colIndex: this.parent.viewport.leftIndex\n                    });\n                }\n                else {\n                    this.parent.renderModule.refreshUI({\n                        skipUpdateOnFirst: true, refresh: 'Column', rowIndex: 0,\n                        colIndex: args.startIndex\n                    });\n                }\n            }\n            this.parent.selectRange(this.parent.getActiveSheet().selectedRange);\n        }\n        this.refreshImgElement(args.deletedModel.length, this.parent.activeSheetIndex, args.modelType, args.startIndex);\n        if (isAction) {\n            this.parent.notify(completeAction, { eventArgs: args, action: 'delete' });\n        }\n        if (args.modelType === 'Row') {\n            this.parent.notify(dataChanged, args);\n        }\n    };\n    Delete.prototype.refreshImgElement = function (count, sheetIdx, modelType, index) {\n        var sheet = this.parent.sheets[sheetIdx];\n        var cell;\n        var address = [0, 0, sheet.usedRange.rowIndex, sheet.usedRange.colIndex];\n        for (var i = 0; i <= address[2]; i++) {\n            for (var j = address[1]; j <= address[3]; j++) {\n                cell = getCell(i, j, sheet);\n                if (cell && cell.image && cell.image.length > 0) {\n                    if ((modelType === 'Row' && i >= index) || (modelType === 'Column' && j >= index)) {\n                        this.parent.notify(refreshImagePosition, {\n                            rowIdx: i, colIdx: j, sheetIdx: sheetIdx, type: modelType, count: count, status: 'delete'\n                        });\n                    }\n                }\n            }\n        }\n    };\n    Delete.prototype.addEventListener = function () {\n        this.parent.on(deleteAction, this.delete, this);\n    };\n    /**\n     * Destroy delete module.\n     */\n    Delete.prototype.destroy = function () {\n        this.removeEventListener();\n        this.parent = null;\n    };\n    Delete.prototype.removeEventListener = function () {\n        if (!this.parent.isDestroyed) {\n            this.parent.off(deleteAction, this.delete);\n        }\n    };\n    /**\n     * Get the delete module name.\n     */\n    Delete.prototype.getModuleName = function () {\n        return 'delete';\n    };\n    return Delete;\n}());\nexport { Delete };\n","import { editAlert } from '../index';\nimport { isValidation, checkDateFormat, applyCellFormat, workbookEditOperation, activeCellChanged } from '../../workbook/common/event';\nimport { getCell, setCell } from '../../workbook/base/cell';\nimport { FormValidator, NumericTextBox } from '@syncfusion/ej2-inputs';\nimport { EventHandler, remove, closest, isNullOrUndefined, select } from '@syncfusion/ej2-base';\nimport { dialog, locale, initiateDataValidation, invalidData, editOperation, keyUp } from '../common/index';\nimport { formulaBarOperation, removeDataValidation } from '../common/index';\nimport { CheckBox } from '@syncfusion/ej2-buttons';\nimport { setRow } from '../../workbook/base/row';\nimport { getRangeIndexes, getIndexesFromAddress, getCellIndexes } from '../../workbook/common/address';\nimport { DropDownList } from '@syncfusion/ej2-dropdowns';\nimport { getSheet, getSheetIndex } from '../../workbook/index';\nimport { getColumn, isLocked } from '../../workbook/index';\n/**\n * Represents Data Validation support for Spreadsheet.\n */\nvar DataValidation = /** @class */ (function () {\n    /**\n     * Constructor for the Spreadsheet Data Validation module.\n     */\n    function DataValidation(parent) {\n        this.data = [];\n        this.parent = parent;\n        this.addEventListener();\n    }\n    /**\n     * To destroy the Data Validation module.\n     * @return {void}\n     */\n    DataValidation.prototype.destroy = function () {\n        this.removeEventListener();\n        var dataValPopup = select('#' + this.parent.element.id + '_datavalidation-popup');\n        if (dataValPopup) {\n            dataValPopup.remove();\n        }\n        this.parent = null;\n    };\n    DataValidation.prototype.addEventListener = function () {\n        EventHandler.add(this.parent.element, 'dblclick', this.listOpen, this);\n        EventHandler.add(document, 'mousedown', this.mouseDownHandler, this);\n        this.parent.on(initiateDataValidation, this.initiateDataValidationHandler, this);\n        this.parent.on(invalidData, this.invalidDataHandler, this);\n        this.parent.on(isValidation, this.checkDataValidation, this);\n        this.parent.on(activeCellChanged, this.listHandler, this);\n        this.parent.on(keyUp, this.keyUpHandler, this);\n        this.parent.on(removeDataValidation, this.removeValidationHandler, this);\n    };\n    DataValidation.prototype.removeEventListener = function () {\n        EventHandler.remove(this.parent.element, 'dblclick', this.listOpen);\n        EventHandler.remove(document, 'mousedown', this.mouseDownHandler);\n        if (!this.parent.isDestroyed) {\n            this.parent.off(initiateDataValidation, this.initiateDataValidationHandler);\n            this.parent.off(invalidData, this.invalidDataHandler);\n            this.parent.off(isValidation, this.checkDataValidation);\n            this.parent.off(activeCellChanged, this.listHandler);\n            this.parent.off(keyUp, this.keyUpHandler);\n            this.parent.off(removeDataValidation, this.removeValidationHandler);\n        }\n    };\n    DataValidation.prototype.removeValidationHandler = function (e) {\n        this.parent.removeDataValidation(this.parent.getActiveSheet().selectedRange);\n    };\n    DataValidation.prototype.mouseDownHandler = function (e) {\n        var target = e.target;\n        var parEle = closest(target, '.e-ddl');\n        if (parEle && parEle.getAttribute('id') === 'listValid_popup') {\n            this.parent.notify(formulaBarOperation, { action: 'refreshFormulabar', value: target.innerText });\n        }\n    };\n    DataValidation.prototype.keyUpHandler = function (e) {\n        var target = e.target;\n        var dlgEle = this.parent.element.querySelector('.e-datavalidation-dlg');\n        if (closest(target, '.e-values') && dlgEle && e.keyCode !== 13) {\n            var valuesCont = dlgEle.querySelector('.e-values');\n            var errorEle = valuesCont.querySelector('.e-dlg-error');\n            var footerCont = dlgEle.querySelector('.e-footer-content');\n            var primaryBut = footerCont.querySelector('.e-primary');\n            if (primaryBut.hasAttribute('disabled')) {\n                primaryBut.removeAttribute('disabled');\n            }\n            if (errorEle) {\n                valuesCont.removeChild(errorEle);\n            }\n        }\n    };\n    DataValidation.prototype.listOpen = function (e) {\n        var target = e.target;\n        if (this.listObj && target.classList.contains('e-cell') && target.querySelector('.e-validation-list')) {\n            this.listObj.showPopup();\n        }\n    };\n    DataValidation.prototype.invalidDataHandler = function (args) {\n        if (args.isRemoveHighlight) {\n            this.parent.removeInvalidHighlight();\n        }\n        else {\n            this.parent.addInvalidHighlight();\n        }\n    };\n    DataValidation.prototype.listHandler = function () {\n        var _this = this;\n        if (this.parent.allowDataValidation) {\n            var sheet = this.parent.getActiveSheet();\n            var mainCont = this.parent.getMainContent();\n            var indexes = getCellIndexes(sheet.activeCell);\n            var colIdx = indexes[1];\n            var rowIdx = indexes[0];\n            var cell_1 = getCell(indexes[0], indexes[1], sheet);\n            var tdEle_1;\n            tdEle_1 = this.parent.getCell(indexes[0], indexes[1]);\n            if (!tdEle_1) {\n                return;\n            }\n            if (document.getElementsByClassName('e-validation-list')[0]) {\n                remove(document.getElementsByClassName('e-validation-list')[0]);\n                this.data = [];\n            }\n            if (cell_1 && cell_1.validation && cell_1.validation.type === 'List') {\n                cell_1.validation.ignoreBlank = !isNullOrUndefined(cell_1.validation.ignoreBlank) ? cell_1.validation.ignoreBlank : true;\n                cell_1.validation.inCellDropDown = !isNullOrUndefined(cell_1.validation.inCellDropDown) ?\n                    cell_1.validation.inCellDropDown : true;\n                if (cell_1.validation.inCellDropDown) {\n                    var ddlCont = this.parent.createElement('div', { className: 'e-validation-list' });\n                    var ddlEle = this.parent.createElement('input', { id: 'listValid' });\n                    ddlCont.appendChild(ddlEle);\n                    if (!cell_1.validation.inCellDropDown) {\n                        ddlCont.style.display = 'none';\n                    }\n                    tdEle_1.insertBefore(ddlCont, tdEle_1.firstChild);\n                    this.listObj = new DropDownList({\n                        index: 0,\n                        dataSource: this.data,\n                        fields: { text: 'text', value: 'id' },\n                        width: '0px',\n                        popupWidth: '200px',\n                        popupHeight: '200px',\n                        beforeOpen: function () {\n                            _this.listObj.popupWidth = tdEle_1.offsetWidth - 1;\n                            _this.data = [];\n                            _this.updateDataSource(_this.listObj, cell_1);\n                        },\n                        change: function () { _this.listValueChange(_this.listObj.text); },\n                        open: function (args) {\n                            args.popup.offsetX = -(tdEle_1.offsetWidth - 20) + 4;\n                            args.popup.offsetY = -13;\n                        }\n                    });\n                    this.listObj.appendTo('#listValid');\n                }\n            }\n        }\n    };\n    DataValidation.prototype.updateDataSource = function (listObj, cell) {\n        var count = 0;\n        var value = cell.validation.value1;\n        var isRange = value.indexOf('=') !== -1;\n        if (isRange) {\n            var sheet = value.indexOf('!') > -1 ?\n                getSheet(this.parent, getSheetIndex(this.parent, value.split('=')[1].split('!')[0])) : this.parent.getActiveSheet();\n            var address = value.indexOf('!') > -1 ? value.split('!')[1] : value.split('=')[1];\n            var indexes = void 0;\n            var range = address.split(':');\n            if ((range[0].match(/[a-z]+$/ig) && range[1].match(/[a-z]+$/ig)) || (range[0].match(/^[0-9]/g) && range[1].match(/^[0-9]/g))) {\n                var addressInfo = this.parent.getIndexes(address);\n                if (addressInfo.isCol) {\n                    indexes = [0, addressInfo.startIdx, sheet.usedRange.rowIndex, addressInfo.startIdx];\n                }\n                else {\n                    indexes = [addressInfo.startIdx, 0, addressInfo.startIdx, sheet.usedRange.colIndex];\n                }\n            }\n            else {\n                indexes = getRangeIndexes(address);\n            }\n            for (var rowIdx = indexes[0]; rowIdx <= indexes[2]; rowIdx++) {\n                if (!sheet.rows[rowIdx]) {\n                    setRow(sheet, rowIdx, {});\n                }\n                for (var colIdx = indexes[1]; colIdx <= indexes[3]; colIdx++) {\n                    if (!sheet.rows[rowIdx].cells) {\n                        setCell(rowIdx, colIdx, sheet, {});\n                    }\n                    count += 1;\n                    cell = sheet.rows[rowIdx].cells[colIdx];\n                    var data = this.parent.getDisplayText(cell) ? this.parent.getDisplayText(cell) : '';\n                    this.data.push({ text: data, id: 'list-' + count });\n                }\n            }\n        }\n        else {\n            var listValues = value.split(',');\n            for (var idx = 0; idx < listValues.length; idx++) {\n                count += 1;\n                this.data.push({ text: listValues[idx], id: 'list-' + count });\n            }\n        }\n        listObj.dataSource = this.data;\n    };\n    DataValidation.prototype.listValueChange = function (value) {\n        var sheet = this.parent.getActiveSheet();\n        var cellIdx = getIndexesFromAddress(sheet.activeCell);\n        var cellObj = Object.assign({}, getCell(cellIdx[0], cellIdx[1], sheet));\n        if (sheet.isProtected && isLocked(cellObj, getColumn(sheet, cellIdx[1]))) {\n            this.parent.notify(editAlert, null);\n        }\n        else {\n            this.parent.notify(workbookEditOperation, { action: 'updateCellValue', address: sheet.activeCell, value: value });\n            this.parent.serviceLocator.getService('cell').refreshRange(cellIdx);\n            this.parent.trigger('cellSave', {\n                value: value, oldValue: cellObj && cellObj.value, address: sheet.name + '!' + sheet.activeCell,\n                displayText: this.parent.getDisplayText(getCell(cellIdx[0], cellIdx[1], sheet))\n            });\n        }\n    };\n    DataValidation.prototype.initiateDataValidationHandler = function () {\n        var _this = this;\n        var l10n = this.parent.serviceLocator.getService(locale);\n        var type;\n        var operator;\n        var value1;\n        var value2;\n        var ignoreBlank = true;\n        var inCellDropDown = true;\n        var isNew = true;\n        var sheet = this.parent.getActiveSheet();\n        var cell;\n        var indexes = getRangeIndexes(sheet.selectedRange);\n        for (var rowIdx = indexes[0]; rowIdx <= indexes[2]; rowIdx++) {\n            if (sheet.rows[rowIdx]) {\n                for (var colIdx = indexes[1]; colIdx <= indexes[3]; colIdx++) {\n                    if (sheet.rows[rowIdx].cells && sheet.rows[rowIdx].cells[colIdx]) {\n                        cell = sheet.rows[rowIdx].cells[colIdx];\n                        if (cell.validation) {\n                            isNew = false;\n                            type = cell.validation.type;\n                            operator = cell.validation.operator;\n                            value1 = cell.validation.value1;\n                            value2 = cell.validation.value2;\n                            ignoreBlank = !isNullOrUndefined(cell.validation.ignoreBlank) ?\n                                cell.validation.ignoreBlank : ignoreBlank;\n                            inCellDropDown = !isNullOrUndefined(cell.validation.inCellDropDown) ?\n                                cell.validation.inCellDropDown : inCellDropDown;\n                        }\n                    }\n                }\n            }\n        }\n        if (!this.parent.element.querySelector('.e-datavalidation-dlg')) {\n            var dialogInst_1 = this.parent.serviceLocator.getService(dialog);\n            dialogInst_1.show({\n                width: 375, showCloseIcon: true, isModal: true, cssClass: 'e-datavalidation-dlg',\n                header: l10n.getConstant('DataValidation'),\n                target: document.querySelector('.e-control.e-spreadsheet'),\n                beforeOpen: function (args) {\n                    var dlgArgs = {\n                        dialogName: 'ValidationDialog', element: args.element,\n                        target: args.target, cancel: args.cancel\n                    };\n                    _this.parent.trigger('dialogBeforeOpen', dlgArgs);\n                    if (dlgArgs.cancel) {\n                        args.cancel = true;\n                    }\n                    dialogInst_1.dialogInstance.content =\n                        _this.dataValidationContent(isNew, type, operator, value1, value2, ignoreBlank, inCellDropDown);\n                    dialogInst_1.dialogInstance.dataBind();\n                    _this.parent.element.focus();\n                },\n                buttons: [{\n                        buttonModel: {\n                            content: l10n.getConstant('CLEARALL'),\n                            cssClass: 'e-btn e-clearall-btn e-flat'\n                        },\n                        click: function () {\n                            dialogInst_1.dialogInstance.content =\n                                _this.dataValidationContent(true, type, operator, value1, value2, ignoreBlank, inCellDropDown);\n                            dialogInst_1.dialogInstance.dataBind();\n                            _this.parent.element.focus();\n                        }\n                    },\n                    {\n                        buttonModel: {\n                            content: l10n.getConstant('APPLY'), isPrimary: true\n                        },\n                        click: function () {\n                            _this.dlgClickHandler(dialogInst_1);\n                        }\n                    }]\n            });\n            dialogInst_1.dialogInstance.refresh();\n        }\n    };\n    // tslint:disable-next-line:max-func-body-length\n    DataValidation.prototype.dataValidationContent = function (isNew, type, operator, val1, val2, ignoreBlank, inCellDropDown) {\n        var _this = this;\n        var l10n = this.parent.serviceLocator.getService(locale);\n        var value1 = isNew ? '0' : val1;\n        var value2 = isNew ? '0' : val2;\n        var dlgContent = this.parent.createElement('div', { className: 'e-validation-dlg' });\n        var cellRangeCont = this.parent.createElement('div', { className: 'e-cellrange' });\n        var allowDataCont = this.parent.createElement('div', { className: 'e-allowdata' });\n        var valuesCont = this.parent.createElement('div', { className: 'e-values' });\n        var ignoreBlankCont = this.parent.createElement('div', { className: 'e-ignoreblank' });\n        dlgContent.appendChild(cellRangeCont);\n        dlgContent.appendChild(allowDataCont);\n        dlgContent.appendChild(valuesCont);\n        dlgContent.appendChild(ignoreBlankCont);\n        var cellRangeText = this.parent.createElement('span', { className: 'e-header', innerHTML: l10n.getConstant('CellRange') });\n        var cellRangeEle = this.parent.createElement('input', {\n            className: 'e-input',\n            attrs: { value: this.parent.getActiveSheet().selectedRange }\n        });\n        cellRangeCont.appendChild(cellRangeText);\n        cellRangeCont.appendChild(cellRangeEle);\n        var allowCont = this.parent.createElement('div', { className: 'e-allow' });\n        var dataCont = this.parent.createElement('div', { className: 'e-data' });\n        allowDataCont.appendChild(allowCont);\n        allowDataCont.appendChild(dataCont);\n        var allowText = this.parent.createElement('span', { className: 'e-header', innerHTML: l10n.getConstant('Allow') });\n        this.typeData = [\n            { text: l10n.getConstant('WholeNumber'), id: 'type-1' },\n            { text: l10n.getConstant('Decimal'), id: 'type-2' },\n            { text: l10n.getConstant('Date'), id: 'type-3' },\n            { text: l10n.getConstant('Time'), id: 'type-4' },\n            { text: l10n.getConstant('TextLength'), id: 'type-5' },\n            { text: l10n.getConstant('List'), id: 'type-6' }\n        ];\n        this.operatorData = [\n            { text: l10n.getConstant('Between'), id: 'operator-1' },\n            { text: l10n.getConstant('NotBetween'), id: 'operator-2' },\n            { text: l10n.getConstant('EqualTo'), id: 'operator-3' },\n            { text: l10n.getConstant('NotEqualTo'), id: 'operator-4' },\n            { text: l10n.getConstant('Greaterthan'), id: 'operator-5' },\n            { text: l10n.getConstant('Lessthan'), id: 'operator-6' },\n            { text: l10n.getConstant('GreaterThanOrEqualTo'), id: 'operator-7' },\n            { text: l10n.getConstant('LessThanOrEqualTo'), id: 'operator-8' }\n        ];\n        var allowSelectEle = this.parent.createElement('input', { className: 'e-select' });\n        var allowIdx = 0;\n        if (!isNew) {\n            for (var idx = 0; idx < this.typeData.length; idx++) {\n                if (type === this.typeData[idx].text.replace(' ', '')) {\n                    allowIdx = idx;\n                    break;\n                }\n            }\n        }\n        if (isNew || type !== 'List') {\n            var dataIdx = 0;\n            var dataText = this.parent.createElement('span', { className: 'e-header', innerHTML: l10n.getConstant('Data') });\n            var dataSelectEle = this.parent.createElement('input', { className: 'e-select' });\n            if (!isNew) {\n                for (var idx = 0; idx < this.operatorData.length; idx++) {\n                    if (operator === this.FormattedValue(this.operatorData[idx].text)) {\n                        dataIdx = idx;\n                        break;\n                    }\n                }\n            }\n            dataCont.appendChild(dataText);\n            dataCont.appendChild(dataSelectEle);\n            this.dataList = new DropDownList({\n                dataSource: this.operatorData,\n                index: dataIdx,\n                popupHeight: '200px',\n                change: function () { _this.userInput(listObj, _this.dataList); }\n            });\n            this.dataList.appendTo(dataSelectEle);\n        }\n        else {\n            var ignoreBlankEle_1 = this.parent.createElement('input', { className: 'e-checkbox' });\n            dataCont.appendChild(ignoreBlankEle_1);\n            var ignoreBlankObj_1 = new CheckBox({ label: l10n.getConstant('InCellDropDown'), checked: inCellDropDown });\n            ignoreBlankObj_1.appendTo(ignoreBlankEle_1);\n        }\n        allowCont.appendChild(allowText);\n        allowCont.appendChild(allowSelectEle);\n        var listObj = new DropDownList({\n            dataSource: this.typeData,\n            index: allowIdx,\n            popupHeight: '200px',\n            change: function () { _this.userInput(listObj, _this.dataList); }\n        });\n        listObj.appendTo(allowSelectEle);\n        if (isNew || (listObj.value !== 'List' && (this.dataList.value === 'Between' || this.dataList.value === 'Not between'))) {\n            var minimumCont = this.parent.createElement('div', { className: 'e-minimum' });\n            var maximumCont = this.parent.createElement('div', { className: 'e-maximum' });\n            valuesCont.appendChild(minimumCont);\n            valuesCont.appendChild(maximumCont);\n            var minimumText = this.parent.createElement('span', { className: 'e-header', innerHTML: l10n.getConstant('Minimum') });\n            var maximumText = this.parent.createElement('span', { className: 'e-header', innerHTML: l10n.getConstant('Maximum') });\n            var minimumInp = this.parent.createElement('input', {\n                id: 'minvalue',\n                className: 'e-input', attrs: { value: value1 }\n            });\n            var maximumInp = this.parent.createElement('input', {\n                id: 'maxvalue',\n                className: 'e-input', attrs: { value: value2 }\n            });\n            minimumCont.appendChild(minimumText);\n            minimumCont.appendChild(minimumInp);\n            maximumCont.appendChild(maximumText);\n            maximumCont.appendChild(maximumInp);\n            var numericMin = new NumericTextBox({\n                value: 0\n            });\n            numericMin.appendTo('#minvalue');\n            var numericMax = new NumericTextBox({\n                value: 0\n            });\n            numericMax.appendTo('#maxvalue');\n        }\n        else if (!isNew || type === ' List') {\n            var valueText = this.parent.createElement('span', {\n                className: 'e-header', innerHTML: l10n.getConstant('Sources')\n            });\n            var valueEle = this.parent.createElement('input', { className: 'e-input', attrs: { value: value1 } });\n            valuesCont.appendChild(valueText);\n            valuesCont.appendChild(valueEle);\n        }\n        else {\n            var valueText = this.parent.createElement('span', {\n                className: 'e-header', innerHTML: l10n.getConstant('Value')\n            });\n            var valueEle = this.parent.createElement('input', { className: 'e-input', attrs: { value: value1 } });\n            valuesCont.appendChild(valueText);\n            valuesCont.appendChild(valueEle);\n        }\n        var isChecked = ignoreBlank;\n        var ignoreBlankEle = this.parent.createElement('input', { className: 'e-checkbox' });\n        ignoreBlankCont.appendChild(ignoreBlankEle);\n        var ignoreBlankObj = new CheckBox({ label: l10n.getConstant('IgnoreBlank'), checked: isChecked });\n        ignoreBlankObj.appendTo(ignoreBlankEle);\n        return dlgContent;\n    };\n    DataValidation.prototype.userInput = function (listObj, listObj1) {\n        var dlgEle = this.parent.element.querySelector('.e-datavalidation-dlg');\n        var dlgCont = dlgEle.querySelector('.e-validation-dlg');\n        var allowDataCont = dlgCont.querySelector('.e-allowdata');\n        var valuesCont = dlgCont.querySelector('.e-values');\n        var l10n = this.parent.serviceLocator.getService(locale);\n        var dataCont = allowDataCont.querySelector('.e-data');\n        var opeEle = dataCont.querySelector('.e-valid-input');\n        while (valuesCont.lastChild) {\n            valuesCont.removeChild(valuesCont.lastChild);\n        }\n        if (listObj.value === 'List') {\n            while (dataCont.lastChild) {\n                dataCont.removeChild(dataCont.lastChild);\n            }\n            var ignoreBlankEle = this.parent.createElement('input', { className: 'e-checkbox' });\n            dataCont.appendChild(ignoreBlankEle);\n            var ignoreBlankObj = new CheckBox({ label: l10n.getConstant('InCellDropDown'), checked: true });\n            ignoreBlankObj.appendTo(ignoreBlankEle);\n        }\n        else {\n            if (dataCont.getElementsByClassName('e-checkbox-wrapper')[0]) {\n                while (dataCont.lastChild) {\n                    dataCont.removeChild(dataCont.lastChild);\n                }\n                var dataText = this.parent.createElement('span', { className: 'e-header', innerHTML: 'Data' });\n                var dataSelectEle = this.parent.createElement('input', { className: 'e-select' });\n                dataCont.appendChild(dataText);\n                dataCont.appendChild(dataSelectEle);\n                listObj1.appendTo(dataSelectEle);\n            }\n        }\n        if (listObj.value !== 'List' && (listObj1.value === 'Between' || listObj1.value === 'Not between')) {\n            var minimumCont = this.parent.createElement('div', { className: 'e-minimum' });\n            var maximumCont = this.parent.createElement('div', { className: 'e-maximum' });\n            valuesCont.appendChild(minimumCont);\n            valuesCont.appendChild(maximumCont);\n            var minimumText = this.parent.createElement('span', { className: 'e-header', innerHTML: l10n.getConstant('Minimum') });\n            var maximumText = this.parent.createElement('span', { className: 'e-header', innerHTML: l10n.getConstant('Maximum') });\n            var minimumInp = this.parent.createElement('input', { id: 'min', className: 'e-input', attrs: { value: '0' } });\n            var maximumInp = this.parent.createElement('input', { id: 'max', className: 'e-input', attrs: { value: '0' } });\n            var numericMin = new NumericTextBox({\n                value: 0\n            });\n            numericMin.appendTo('min');\n            var numericMax = new NumericTextBox({\n                value: 0\n            });\n            numericMax.appendTo('max');\n            minimumCont.appendChild(minimumText);\n            minimumCont.appendChild(minimumInp);\n            maximumCont.appendChild(maximumText);\n            maximumCont.appendChild(maximumInp);\n        }\n        else {\n            var text = listObj.value === 'List' ? l10n.getConstant('Sources') : l10n.getConstant('Value');\n            var valueText = this.parent.createElement('span', { className: 'e-header', innerHTML: text });\n            var valueEle = listObj.value === 'List' ? this.parent.createElement('input', {\n                className: 'e-input',\n                attrs: { placeholder: 'Enter value' }\n            }) :\n                this.parent.createElement('input', { className: 'e-input', attrs: { value: '0' } });\n            valuesCont.appendChild(valueText);\n            valuesCont.appendChild(valueEle);\n        }\n    };\n    DataValidation.prototype.dlgClickHandler = function (dialogInst) {\n        var l10n = this.parent.serviceLocator.getService(locale);\n        var isValidList = true;\n        var errorMsg;\n        var dlgEle = this.parent.element.querySelector('.e-datavalidation-dlg');\n        var dlgFooter = dlgEle.querySelector('.e-footer-content');\n        var dlgContEle = dlgEle.getElementsByClassName('e-dlg-content')[0].\n            getElementsByClassName('e-validation-dlg')[0];\n        var allowData = dlgContEle.getElementsByClassName('e-allowdata')[0];\n        var allowEle = allowData.getElementsByClassName('e-allow')[0].getElementsByTagName('input')[0];\n        var dataEle = allowData.getElementsByClassName('e-data')[0].getElementsByTagName('input')[0];\n        var values = dlgContEle.getElementsByClassName('e-values')[0];\n        var value1 = values.getElementsByTagName('input')[0].value;\n        var value2 = values.getElementsByTagName('input')[1] ? values.getElementsByTagName('input')[1].value : '';\n        var ignoreBlank = dlgContEle.querySelector('.e-ignoreblank').querySelector('.e-checkbox-wrapper').\n            getAttribute('aria-checked') === 'true' ? true : false;\n        var inCellDropDown = allowData.querySelector('.e-data').querySelector('.e-checkbox-wrapper') ?\n            allowData.querySelector('.e-data').querySelector('.e-checkbox-wrapper').querySelector('.e-check') ? true : false : null;\n        var range = dlgContEle.querySelector('.e-cellrange').getElementsByTagName('input')[0].value;\n        var operator;\n        var type = allowEle.value;\n        if (dataEle) {\n            operator = dataEle.value;\n            operator = this.FormattedValue(operator);\n        }\n        if (type) {\n            type = type.replace(' ', '');\n        }\n        var rangeAdd = [];\n        var valArr = [];\n        if (value1 !== '') {\n            valArr.push(value1);\n        }\n        if (value2 !== '') {\n            valArr.push(value2);\n        }\n        if (type === 'List') {\n            if (value1.indexOf('=') !== -1) {\n                if (value1.indexOf(':') !== -1) {\n                    var address = value1.indexOf('!') > -1 ? value1.split('!')[1] : value1.split('=')[1];\n                    var isSheetNameValid = value1.indexOf('!') > -1 ?\n                        getSheetIndex(this.parent, value1.split('=')[1].split('!')[0]) > -1 : true;\n                    rangeAdd = address.split(':');\n                    var isSingleCol = address.match(/[a-z]/gi) ?\n                        rangeAdd[0].replace(/[0-9]/g, '') === rangeAdd[1].replace(/[0-9]/g, '') : false;\n                    var isSingleRow = address.match(/\\d/g) ?\n                        rangeAdd[0].replace(/\\D/g, '') === rangeAdd[1].replace(/\\D/g, '') : false;\n                    isValidList = isSheetNameValid ? (isSingleCol ? true : isSingleRow ? true : false) : false;\n                    if (!isValidList) {\n                        errorMsg = l10n.getConstant('DialogError');\n                    }\n                }\n            }\n            else if (value1.length > 256) {\n                isValidList = false;\n                errorMsg = l10n.getConstant('ListLengthError');\n            }\n        }\n        if (type !== 'List' || isValidList) {\n            var sheet = this.parent.getActiveSheet();\n            var format = type;\n            var validDlg = this.isDialogValidator(valArr, format, operator);\n            errorMsg = validDlg.errorMsg;\n            isValidList = validDlg.isValidate;\n            if (isValidList) {\n                var indexes = getCellIndexes(this.parent.getActiveSheet().activeCell);\n                if (sheet && sheet.rows[indexes[0]] && sheet.rows[indexes[0]].cells[indexes[1]] &&\n                    sheet.rows[indexes[0]].cells[indexes[1]].validation &&\n                    sheet.rows[indexes[0]].cells[indexes[1]].validation.type === 'List') {\n                    var tdEle = this.parent.getMainContent().\n                        getElementsByTagName('tr')[indexes[0]].getElementsByClassName('e-cell')[indexes[1]];\n                    if (tdEle && tdEle.getElementsByClassName('e-validation-list')[0]) {\n                        tdEle.removeChild(tdEle.getElementsByClassName('e-validation-list')[0]);\n                        this.listObj.destroy();\n                    }\n                }\n                var rules = {\n                    type: type, operator: operator,\n                    value1: value1, value2: value2, ignoreBlank: ignoreBlank, inCellDropDown: inCellDropDown\n                };\n                this.parent.addDataValidation(rules, range);\n                if (type === 'List' && isValidList) {\n                    this.listHandler();\n                }\n                if (!document.getElementsByClassName('e-validationerror-dlg')[0]) {\n                    if (dialogInst.dialogInstance) {\n                        dialogInst.dialogInstance.hide();\n                    }\n                    else {\n                        dialogInst.hide();\n                    }\n                }\n            }\n        }\n        if (!isValidList) {\n            var errorEle = this.parent.createElement('div', {\n                className: 'e-dlg-error', id: 'e-invalid', innerHTML: errorMsg\n            });\n            values.appendChild(errorEle);\n            dlgFooter.querySelector('.e-primary').setAttribute('disabled', 'true');\n        }\n    };\n    DataValidation.prototype.FormattedValue = function (value) {\n        switch (value) {\n            case 'Between':\n                value = 'Between';\n                break;\n            case 'Not between':\n                value = 'NotBetween';\n                break;\n            case 'Equal to':\n                value = 'EqualTo';\n                break;\n            case 'Not equal to':\n                value = 'NotEqualTo';\n                break;\n            case 'Greater than':\n                value = 'GreaterThan';\n                break;\n            case 'Less than':\n                value = 'LessThan';\n                break;\n            case 'Greater than or equal to':\n                value = 'GreaterThanOrEqualTo';\n                break;\n            case 'Less than or equal to':\n                value = 'LessThanOrEqualTo';\n                break;\n            default:\n                value = 'Between';\n                break;\n        }\n        return value;\n    };\n    DataValidation.prototype.isDialogValidator = function (values, type, operator) {\n        var l10n = this.parent.serviceLocator.getService(locale);\n        var count = 0;\n        var isEmpty = false;\n        var formValidation;\n        if (type === 'List') {\n            isEmpty = values.length > 0 ? false : true;\n        }\n        else {\n            if (operator === 'Between' || operator === 'NotBetween') {\n                isEmpty = values.length === 2 ? false : true;\n            }\n            else {\n                isEmpty = values.length > 0 ? false : true;\n            }\n        }\n        if (!isEmpty) {\n            for (var idx = 0; idx < values.length; idx++) {\n                formValidation = this.formatValidation(values[idx], type);\n                if (formValidation.isValidate) {\n                    count = count + 1;\n                }\n                else {\n                    break;\n                }\n            }\n            formValidation.isValidate = count === values.length ? true : false;\n        }\n        else {\n            formValidation = { isValidate: false, errorMsg: l10n.getConstant('EmptyError') };\n        }\n        return { isValidate: formValidation.isValidate, errorMsg: formValidation.errorMsg };\n    };\n    // tslint:disable-next-line:max-func-body-length\n    DataValidation.prototype.isValidationHandler = function (args) {\n        var l10n = this.parent.serviceLocator.getService(locale);\n        args.value = args.value ? args.value : '';\n        var isValidate;\n        var errorMsg;\n        var enterValue = args.value;\n        var sheet = this.parent.sheets[args.sheetIdx];\n        var cell = getCell(args.range[0], args.range[1], sheet);\n        var value = args.value;\n        var value1 = cell.validation.value1;\n        var value2 = cell.validation.value2;\n        var opt = cell.validation.operator;\n        var type = cell.validation.type;\n        var ignoreBlank = !isNullOrUndefined(cell.validation.ignoreBlank) ? cell.validation.ignoreBlank : true;\n        var formValidation = this.formatValidation(args.value, type);\n        isValidate = formValidation.isValidate;\n        errorMsg = formValidation.errorMsg;\n        if (isValidate) {\n            isValidate = false;\n            if (type === 'Date' || type === 'Time') {\n                for (var idx = 0; idx <= 3; idx++) {\n                    args.value = idx === 0 ? args.value : idx === 1 ? cell.validation.value1 : cell.validation.value2;\n                    var dateEventArgs = {\n                        value: args.value,\n                        rowIndex: args.range[0],\n                        colIndex: args.range[1],\n                        sheetIndex: args.sheetIdx,\n                        updatedVal: ''\n                    };\n                    if (args.value !== '') {\n                        this.parent.notify(checkDateFormat, dateEventArgs);\n                    }\n                    var updatedVal = dateEventArgs.updatedVal;\n                    if (idx === 0) {\n                        value = type === 'Date' ? args.value : updatedVal.slice(updatedVal.indexOf('.') + 1, updatedVal.length);\n                    }\n                    else if (idx === 1) {\n                        value1 = type === 'Date' ? updatedVal : updatedVal.slice(updatedVal.indexOf('.') + 1, updatedVal.length);\n                    }\n                    else {\n                        value2 = type === 'Date' ? updatedVal : updatedVal.slice(updatedVal.indexOf('.') + 1, updatedVal.length);\n                    }\n                }\n            }\n            else if (cell.validation.type === 'TextLength') {\n                value = args.value.toString().length.toString();\n            }\n            if (type === 'List') {\n                if (value1.indexOf('=') !== -1) {\n                    for (var idx = 0; idx < this.data.length; idx++) {\n                        if (args.value === this.data[idx].text) {\n                            isValidate = true;\n                        }\n                    }\n                }\n                else {\n                    var values = value1.split(',');\n                    for (var idx = 0; idx < values.length; idx++) {\n                        if (args.value === values[idx]) {\n                            isValidate = true;\n                        }\n                    }\n                }\n            }\n            else {\n                if (type === 'Decimal') {\n                    value = parseFloat(value.toString());\n                    value1 = parseFloat(value1.toString());\n                    value2 = value2 ? parseFloat(value2.toString()) : null;\n                }\n                else {\n                    value = parseInt(value.toString(), 10);\n                    value1 = parseInt(value1.toString(), 10);\n                    value2 = value2 ? parseInt(value2.toString(), 10) : null;\n                }\n                switch (opt) {\n                    case 'EqualTo':\n                        if (value === value1) {\n                            isValidate = true;\n                        }\n                        else if (ignoreBlank && enterValue === '') {\n                            isValidate = true;\n                        }\n                        else {\n                            isValidate = false;\n                        }\n                        break;\n                    case 'NotEqualTo':\n                        if (value !== value1) {\n                            isValidate = true;\n                        }\n                        else if (ignoreBlank && enterValue === '') {\n                            isValidate = true;\n                        }\n                        else {\n                            isValidate = false;\n                        }\n                        break;\n                    case 'Between':\n                        if (value >= value1 && value <= value2) {\n                            isValidate = true;\n                        }\n                        else if (ignoreBlank && enterValue === '') {\n                            isValidate = true;\n                        }\n                        else {\n                            isValidate = false;\n                        }\n                        break;\n                    case 'NotBetween':\n                        if (value >= value1 && value <= value2) {\n                            isValidate = false;\n                        }\n                        else if (ignoreBlank && enterValue === '') {\n                            isValidate = true;\n                        }\n                        else {\n                            isValidate = true;\n                        }\n                        break;\n                    case 'GreaterThan':\n                        if (value > value1) {\n                            isValidate = true;\n                        }\n                        else if (ignoreBlank && enterValue === '') {\n                            isValidate = true;\n                        }\n                        else {\n                            isValidate = false;\n                        }\n                        break;\n                    case 'LessThan':\n                        if (value < value1) {\n                            isValidate = true;\n                        }\n                        else if (ignoreBlank && enterValue === '') {\n                            isValidate = true;\n                        }\n                        else {\n                            isValidate = false;\n                        }\n                        break;\n                    case 'GreaterThanOrEqualTo':\n                        if (value >= value1) {\n                            isValidate = true;\n                        }\n                        else if (ignoreBlank && enterValue === '') {\n                            isValidate = true;\n                        }\n                        else {\n                            isValidate = false;\n                        }\n                        break;\n                    case 'LessThanOrEqualTo':\n                        if (value <= value1) {\n                            isValidate = true;\n                        }\n                        else if (ignoreBlank && enterValue === '') {\n                            isValidate = true;\n                        }\n                        else {\n                            isValidate = false;\n                        }\n                        break;\n                    default:\n                        break;\n                }\n            }\n        }\n        errorMsg = l10n.getConstant('ValidationError');\n        if (isValidate) {\n            var style = this.parent.getCellStyleValue(['backgroundColor', 'color'], [args.range[0], args.range[1]]);\n            this.parent.notify(applyCellFormat, {\n                style: style, rowIdx: args.range[0],\n                colIdx: args.range[1], isHeightCheckNeeded: true, manualUpdate: true,\n                onActionUpdate: true\n            });\n        }\n        return { isValidate: isValidate, errorMsg: errorMsg };\n    };\n    DataValidation.prototype.checkDataValidation = function (args) {\n        var isValid = this.isValidationHandler({\n            value: args.value, range: args.range, sheetIdx: args.sheetIdx\n        });\n        if (!isValid.isValidate && args.isCell) {\n            this.validationErrorHandler(isValid.errorMsg);\n        }\n        this.parent.allowDataValidation = isValid.isValidate;\n    };\n    DataValidation.prototype.formatValidation = function (value, type) {\n        var sheetPanel = this.parent.element.getElementsByClassName('e-sheet-panel')[0];\n        var isValidate;\n        var errorMsg;\n        var formEle = this.parent.createElement('form', {\n            id: 'formId',\n            className: 'form-horizontal'\n        });\n        var inputEle = this.parent.createElement('input', {\n            id: 'e-validation', innerHTML: value\n        });\n        inputEle.setAttribute('name', 'validation');\n        inputEle.setAttribute('type', 'text');\n        inputEle.setAttribute('value', value);\n        formEle.appendChild(inputEle);\n        sheetPanel.appendChild(formEle);\n        var options;\n        switch (type) {\n            case 'Date':\n                options = {\n                    rules: {\n                        'validation': { date: true },\n                    },\n                    customPlacement: function (inputElement, error) {\n                        errorMsg = error.innerText;\n                    }\n                };\n                break;\n            case 'Decimal':\n                options = {\n                    rules: {\n                        'validation': { number: true },\n                    },\n                    customPlacement: function (inputElement, error) {\n                        errorMsg = error.innerText;\n                    }\n                };\n                break;\n            case 'WholeNumber':\n                options = {\n                    rules: {\n                        'validation': { regex: /^\\d*\\.?[0]*$/ },\n                    },\n                    customPlacement: function (inputElement, error) {\n                        errorMsg = error.innerText;\n                    }\n                };\n                break;\n            default:\n                break;\n        }\n        var formObj = new FormValidator('#formId', options);\n        isValidate = formObj.validate();\n        sheetPanel.removeChild(sheetPanel.getElementsByClassName('form-horizontal')[0]);\n        return { isValidate: isValidate, errorMsg: errorMsg };\n    };\n    DataValidation.prototype.validationErrorHandler = function (error) {\n        var _this = this;\n        var el = document.getElementsByClassName('e-spreadsheet-edit')[0];\n        var l10n = this.parent.serviceLocator.getService(locale);\n        if (!this.parent.element.querySelector('.e-validationerror-dlg')) {\n            var erroDialogInst_1 = this.parent.serviceLocator.getService(dialog);\n            var disableCancel = false;\n            var dlgModel = {\n                width: 400, height: 200, isModal: true, showCloseIcon: true, cssClass: 'e-validationerror-dlg',\n                target: document.querySelector('.e-control.e-spreadsheet'),\n                beforeOpen: function (args) {\n                    var dlgArgs = {\n                        dialogName: 'ValidationErrorDialog',\n                        element: args.element, target: args.target, cancel: args.cancel, content: error\n                    };\n                    _this.parent.trigger('dialogBeforeOpen', dlgArgs);\n                    if (dlgArgs.cancel) {\n                        _this.errorDlgHandler(erroDialogInst_1, 'Cancel');\n                        args.cancel = true;\n                    }\n                    el.focus();\n                    erroDialogInst_1.dialogInstance.content = dlgArgs.content;\n                    erroDialogInst_1.dialogInstance.dataBind();\n                },\n                buttons: [{\n                        buttonModel: {\n                            content: l10n.getConstant('Retry'), isPrimary: true,\n                        },\n                        click: function () {\n                            _this.errorDlgHandler(erroDialogInst_1, 'Retry');\n                        }\n                    },\n                    {\n                        buttonModel: {\n                            content: l10n.getConstant('Cancel'),\n                        },\n                        click: function () {\n                            _this.errorDlgHandler(erroDialogInst_1, 'Cancel');\n                        }\n                    }]\n            };\n            erroDialogInst_1.show(dlgModel, disableCancel);\n        }\n    };\n    DataValidation.prototype.errorDlgHandler = function (errorDialogInst, buttonName) {\n        if (buttonName === 'Retry') {\n            var el = document.getElementsByClassName('e-spreadsheet-edit')[0];\n            var mainCont = this.parent.getMainContent();\n            errorDialogInst.hide();\n            if (el.innerText) {\n                var range = document.createRange();\n                range.setStart(el.childNodes[0], 0);\n                range.setEnd(el.childNodes[0], el.innerText.length);\n                var selection = window.getSelection();\n                selection.removeAllRanges();\n                selection.addRange(range);\n                if (this.listObj) {\n                    this.listObj.showPopup();\n                }\n            }\n        }\n        else {\n            var indexes = getCellIndexes(this.parent.getActiveSheet().activeCell);\n            var value = this.parent.getDisplayText(this.parent.getActiveSheet().rows[indexes[0]].cells[indexes[1]]);\n            this.parent.notify(editOperation, {\n                action: 'cancelEdit', value: value, refreshFormulaBar: true,\n                refreshEditorElem: true, isAppend: false, trigEvent: true\n            });\n            errorDialogInst.hide();\n        }\n    };\n    /**\n     * Gets the module name.\n     * @returns string\n     */\n    DataValidation.prototype.getModuleName = function () {\n        return 'dataValidation';\n    };\n    return DataValidation;\n}());\nexport { DataValidation };\n","import { applyProtect, protectSheet, protectCellFormat, editAlert, enableFormulaInput } from '../common/event';\nimport { clearCopy, protectSelection, clearUndoRedoCollection } from '../common/index';\nimport { ListView } from '@syncfusion/ej2-lists';\nimport { EventHandler } from '@syncfusion/ej2-base';\nimport { locale, updateToggleItem } from '../common/index';\nimport { CheckBox } from '@syncfusion/ej2-buttons';\nimport { applyLockCells, setCell } from '../../workbook/index';\n/**\n * The `Protect-sheet` module is used to handle the Protecting functionalities in Spreadsheet.\n */\nvar ProtectSheet = /** @class */ (function () {\n    /**\n     * Constructor for protectSheet module in Spreadsheet.\n     * @private\n     */\n    function ProtectSheet(parent) {\n        this.parent = parent;\n        this.init();\n    }\n    ProtectSheet.prototype.init = function () {\n        this.addEventListener();\n    };\n    /**\n     * To destroy the protectSheet module.\n     * @return {void}\n     * @hidden\n     */\n    ProtectSheet.prototype.destroy = function () {\n        this.removeEventListener();\n        this.parent = null;\n    };\n    ProtectSheet.prototype.addEventListener = function () {\n        this.parent.on(applyProtect, this.protect, this);\n        this.parent.on(protectSheet, this.protectSheetHandler, this);\n        this.parent.on(editAlert, this.editProtectedAlert, this);\n        this.parent.on(applyLockCells, this.lockCellsHandler, this);\n    };\n    ProtectSheet.prototype.removeEventListener = function () {\n        if (!this.parent.isDestroyed) {\n            this.parent.off(applyProtect, this.protect);\n            this.parent.off(protectSheet, this.protectSheetHandler);\n            this.parent.off(editAlert, this.editProtectedAlert);\n            this.parent.off(applyLockCells, this.lockCellsHandler);\n        }\n    };\n    ProtectSheet.prototype.protect = function (args) {\n        this.parent.notify(clearCopy, null);\n        if (!args.isActive) {\n            this.createDialogue();\n        }\n        else {\n            this.parent.setSheetPropertyOnMute(this.parent.getActiveSheet(), 'isProtected', false);\n            this.parent.notify(updateToggleItem, { props: 'Protect' });\n            this.parent.notify(protectSheet, { isActive: args.isActive });\n            this.parent.notify(protectSelection, null);\n        }\n    };\n    ProtectSheet.prototype.createDialogue = function () {\n        var _this = this;\n        var l10n = this.parent.serviceLocator.getService(locale);\n        var listData = [\n            { text: l10n.getConstant('SelectCells'), id: '1' },\n            { text: l10n.getConstant('FormatCells'), id: '2' },\n            { text: l10n.getConstant('FormatRows'), id: '3' },\n            { text: l10n.getConstant('FormatColumns'), id: '4' },\n            { text: l10n.getConstant('InsertLinks'), id: '5' }\n        ];\n        this.optionList = new ListView({\n            width: '250px',\n            dataSource: listData,\n            showCheckBox: true,\n            select: this.dialogOpen.bind(this),\n        });\n        var protectHeaderCntent = this.parent.createElement('div', { className: 'e-protect-content',\n            innerHTML: l10n.getConstant('ProtectAllowUser') });\n        this.parent.setSheetPropertyOnMute(this.parent.getActiveSheet(), 'isProtected', false);\n        var checkbox = new CheckBox({ checked: true, label: l10n.getConstant('ProtectContent'), cssClass: 'e-protect-checkbox' });\n        var listViewElement = this.parent.createElement('div', { className: 'e-protect-option-list',\n            id: this.parent.element.id + '_option_list' });\n        var headerContent = this.parent.createElement('div', { className: 'e-header-content', innerHTML: l10n.getConstant('ProtectSheet') });\n        var checkBoxElement = this.parent.createElement('input', { id: this.parent.element.id + '_protect_check', attrs: { type: 'checkbox' } });\n        this.dialog = this.parent.serviceLocator.getService('dialog');\n        this.dialog.show({\n            header: headerContent.outerHTML,\n            content: checkBoxElement.outerHTML + protectHeaderCntent.outerHTML + listViewElement.outerHTML,\n            showCloseIcon: true, isModal: true,\n            cssClass: 'e-protect-dlg',\n            beforeOpen: function (args) {\n                var dlgArgs = {\n                    dialogName: 'ProtectSheetDialog',\n                    element: args.element, target: args.target, cancel: args.cancel\n                };\n                _this.parent.trigger('dialogBeforeOpen', dlgArgs);\n                if (dlgArgs.cancel) {\n                    args.cancel = true;\n                }\n                _this.parent.element.focus();\n            },\n            open: function () {\n                _this.okBtnFocus();\n            },\n            beforeClose: function () {\n                var checkboxElement = document.getElementById(_this.parent.element.id + '_protect_check');\n                EventHandler.remove(checkboxElement, 'focus', _this.okBtnFocus);\n                EventHandler.remove(checkbox.element, 'click', _this.checkBoxClickHandler);\n                _this.parent.element.focus();\n            },\n            buttons: [{ click: (this.selectOption.bind(this, this.dialog, this)),\n                    buttonModel: { content: l10n.getConstant('Ok'), isPrimary: true } }]\n        });\n        checkbox.appendTo('#' + this.parent.element.id + '_protect_check');\n        this.optionList.appendTo('#' + this.parent.element.id + '_option_list');\n        this.optionList.selectMultipleItems([{ id: '1' }]);\n        EventHandler.add(checkbox.element, 'click', this.checkBoxClickHandler, this);\n    };\n    ;\n    ProtectSheet.prototype.okBtnFocus = function () {\n        var _this = this;\n        var checkboxElement = document.getElementById(this.parent.element.id + '_protect_check');\n        checkboxElement.addEventListener('focus', function () {\n            _this.dialog.dialogInstance.element.getElementsByClassName('e-footer-content')[0].querySelector('button').focus();\n        });\n    };\n    ProtectSheet.prototype.checkBoxClickHandler = function () {\n        var ch = document.getElementById(this.parent.element.id + '_protect_check');\n        if (ch.checked === false) {\n            this.dialog.dialogInstance.element.getElementsByClassName('e-footer-content')[0].querySelector('button').disabled = true;\n        }\n        else {\n            this.dialog.dialogInstance.element.getElementsByClassName('e-footer-content')[0].querySelector('button').disabled = false;\n            this.dialog.dialogInstance.element.getElementsByClassName('e-footer-content')[0].querySelector('button').focus();\n        }\n    };\n    ProtectSheet.prototype.dialogOpen = function () {\n        this.dialog.dialogInstance.element.getElementsByClassName('e-footer-content')[0].querySelector('button').focus();\n    };\n    ProtectSheet.prototype.selectOption = function () {\n        var l10n = this.parent.serviceLocator.getService(locale);\n        var selectedItems = this.optionList.getSelectedItems();\n        this.parent.setSheetPropertyOnMute(this.parent.getActiveSheet(), 'isProtected', true);\n        var protectSettings = { selectCells: selectedItems.text.indexOf(l10n.getConstant('SelectCells')) > -1,\n            formatCells: selectedItems.text.indexOf(l10n.getConstant('FormatCells')) > -1,\n            formatRows: selectedItems.text.indexOf(l10n.getConstant('FormatRows')) > -1,\n            formatColumns: selectedItems.text.indexOf(l10n.getConstant('FormatColumns')) > -1,\n            insertLink: selectedItems.text.indexOf(l10n.getConstant('InsertLinks')) > -1 };\n        this.parent.protectSheet(null, protectSettings);\n        this.parent.notify(protectSelection, null);\n        this.parent.notify(clearUndoRedoCollection, null);\n        this.dialog.hide();\n    };\n    ProtectSheet.prototype.protectSheetHandler = function (args) {\n        var sheet = this.parent.getActiveSheet();\n        var id = this.parent.element.id;\n        var disableHomeBtnId = [id + '_undo', id + '_redo', id + '_cut', id + '_copy', id + '_paste', id + '_number_format',\n            id + '_font_name', id + '_font_size', id + '_bold', id + '_italic', id + '_line-through', id + '_underline',\n            id + '_font_color_picker', id + '_fill_color_picker', id + '_borders', id + '_merge_cells', id + '_text_align',\n            id + '_vertical_align', id + '_wrap', id + '_sorting', id + '_clear', id + '_conditionalformatting'];\n        var enableHomeBtnId = [id + '_cut', id + '_copy', id + '_number_format', id + '_font_name', id + '_font_size',\n            id + '_bold', id + '_italic', id + '_line-through', id + '_underline', id + '_font_color_picker', id + '_fill_color_picker',\n            id + '_borders', id + '_text_align', id + '_vertical_align', id + '_wrap', id + '_sorting',\n            id + '_clear', id + '_conditionalformatting'];\n        var enableFrmlaBtnId = [id + '_insert_function'];\n        var enableInsertBtnId = [id + '_hyperlink', id + '_', id + '_chart'];\n        var imageBtnId = [id + '_'];\n        var findBtnId = [id + '_find'];\n        var dataValidationBtnId = [id + '_datavalidation'];\n        var chartBtnId = [id + '_chart'];\n        var sheetElement = document.getElementById(this.parent.element.id + '_sheet_panel');\n        if (sheetElement) {\n            if ((sheet.isProtected && sheet.protectSettings.selectCells)) {\n                {\n                    sheetElement.classList.remove('e-protected');\n                }\n            }\n            else {\n                sheetElement.classList.add('e-protected');\n            }\n            if (!sheet.isProtected) {\n                sheetElement.classList.remove('e-protected');\n            }\n        }\n        this.parent.dataBind();\n        this.parent.notify(protectCellFormat, { disableHomeBtnId: disableHomeBtnId,\n            enableHomeBtnId: enableHomeBtnId, enableFrmlaBtnId: enableFrmlaBtnId, enableInsertBtnId: enableInsertBtnId,\n            findBtnId: findBtnId, dataValidationBtnId: dataValidationBtnId, imageBtnId: imageBtnId, chartBtnId: chartBtnId });\n        this.parent.notify(enableFormulaInput, null);\n        this.parent.notify(updateToggleItem, { props: 'Protect' });\n    };\n    ProtectSheet.prototype.editProtectedAlert = function () {\n        var _this = this;\n        var l10n = this.parent.serviceLocator.getService(locale);\n        this.dialog = this.parent.serviceLocator.getService('dialog');\n        this.dialog.show({\n            content: l10n.getConstant('EditAlert'),\n            isModal: true,\n            closeOnEscape: true,\n            showCloseIcon: true,\n            width: '400px',\n            cssClass: 'e-editAlert-dlg',\n            beforeOpen: function (args) {\n                var dlgArgs = {\n                    dialogName: 'EditAlertDialog',\n                    element: args.element, target: args.target, cancel: args.cancel\n                };\n                _this.parent.trigger('dialogBeforeOpen', dlgArgs);\n                if (dlgArgs.cancel) {\n                    args.cancel = true;\n                }\n                _this.parent.element.focus();\n            },\n            close: function () { return _this.parent.element.focus(); }\n        });\n    };\n    ProtectSheet.prototype.lockCellsHandler = function (args) {\n        var sheet = this.parent.getActiveSheet();\n        var cellObj = { isLocked: args.isLocked ? args.isLocked : false };\n        setCell(args.rowIdx, args.colIdx, sheet, cellObj, true);\n    };\n    /**\n     * Get the module name.\n     * @returns string\n     *\n     * @private\n     */\n    ProtectSheet.prototype.getModuleName = function () {\n        return 'protectSheet';\n    };\n    return ProtectSheet;\n}());\nexport { ProtectSheet };\n","import { findDlg, locale, dialog, gotoDlg, replace, findHandler, beginAction } from '../common/index';\nimport { completeAction } from '../common/index';\nimport { getComponent, isNullOrUndefined } from '@syncfusion/ej2-base';\nimport { goto, showDialog, findUndoRedo, count, replaceAllDialog, findKeyUp } from '../../workbook/index';\nimport { CheckBox } from '@syncfusion/ej2-buttons';\nimport { DropDownList } from '@syncfusion/ej2-dropdowns';\nimport { TextBox } from '@syncfusion/ej2-inputs';\n/**\n * `FindAndReplace` module is used to handle the search action in Spreadsheet.\n */\nvar FindAndReplace = /** @class */ (function () {\n    /**\n     * Constructor for FindAndReplace module.\n     */\n    function FindAndReplace(parent) {\n        this.shortValue = '';\n        this.parent = parent;\n        this.addEventListener();\n    }\n    FindAndReplace.prototype.addEventListener = function () {\n        this.parent.on(findDlg, this.renderFindDlg, this);\n        this.parent.on(gotoDlg, this.renderGotoDlg, this);\n        this.parent.on(goto, this.gotoHandler, this);\n        this.parent.on(findHandler, this.findHandler, this);\n        this.parent.on(replace, this.replaceHandler, this);\n        this.parent.on(showDialog, this.showDialog, this);\n        this.parent.on(replaceAllDialog, this.replaceAllDialog, this);\n        this.parent.on(findUndoRedo, this.findUndoRedo, this);\n        this.parent.on(findKeyUp, this.findKeyUp, this);\n    };\n    FindAndReplace.prototype.removeEventListener = function () {\n        if (!this.parent.isDestroyed) {\n            this.parent.off(findDlg, this.renderFindDlg);\n            this.parent.off(gotoDlg, this.renderGotoDlg);\n            this.parent.off(goto, this.gotoHandler);\n            this.parent.off(findHandler, this.findHandler);\n            this.parent.off(replace, this.replaceHandler);\n            this.parent.off(showDialog, this.showDialog);\n            this.parent.off(replaceAllDialog, this.replaceAllDialog);\n            this.parent.off(findUndoRedo, this.findUndoRedo);\n            this.parent.off(findKeyUp, this.findKeyUp);\n        }\n    };\n    FindAndReplace.prototype.findUndoRedo = function (options) {\n        var eventArgs = { address: options.address, compareVal: options.compareVal, cancel: false };\n        if (options.undoRedoOpt === 'before') {\n            this.parent.notify(beginAction, { action: 'beforeReplace', eventArgs: eventArgs });\n        }\n        else if (options.undoRedoOpt === 'after') {\n            if (!eventArgs.cancel) {\n                var eventArgs_1 = { address: options.address, compareVal: options.compareVal };\n                this.parent.notify(completeAction, { action: 'replace', eventArgs: eventArgs_1 });\n            }\n        }\n        else if (options.undoRedoOpt === 'beforeReplaceAll') {\n            if (!eventArgs.cancel) {\n                var eventArgs_2 = { replaceValue: options.replaceValue, addressCollection: options.Collection };\n                this.parent.notify(beginAction, { action: 'beforeReplaceAll', eventArgs: eventArgs_2 });\n            }\n        }\n        else if (options.undoRedoOpt === 'afterReplaceAll') {\n            if (!eventArgs.cancel) {\n                var eventArgs_3 = { replaceValue: options.replaceValue, addressCollection: options.Collection };\n                this.parent.notify(completeAction, { action: 'replaceAll', eventArgs: eventArgs_3 });\n            }\n        }\n    };\n    FindAndReplace.prototype.renderFindDlg = function () {\n        var _this = this;\n        var l10n = this.parent.serviceLocator.getService(locale);\n        var dialogInst = this.parent.serviceLocator.getService(dialog);\n        var cancelButton = false;\n        if (isNullOrUndefined(this.parent.element.querySelector('.e-find-dlg'))) {\n            var dlg = {\n                isModal: false, showCloseIcon: true, cssClass: 'e-find-dlg', allowDragging: true,\n                header: l10n.getConstant('FindAndReplace'), closeOnEscape: false,\n                beforeOpen: function (args) {\n                    var dlgArgs = {\n                        dialogName: 'FindAndReplaceDialog',\n                        element: args.element, target: args.target, cancel: args.cancel\n                    };\n                    _this.parent.trigger('dialogBeforeOpen', dlgArgs);\n                    if (dlgArgs.cancel) {\n                        args.cancel = true;\n                    }\n                    dialogInst.dialogInstance.content = _this.findandreplaceContent();\n                    dialogInst.dialogInstance.dataBind();\n                    _this.parent.element.focus();\n                },\n                buttons: [{\n                        buttonModel: {\n                            content: l10n.getConstant('FindPreviousBtn'), isPrimary: true, cssClass: 'e-btn-findPrevious', disabled: true\n                        },\n                        click: function () {\n                            _this.dialogMessage();\n                            _this.findDlgClick('prev');\n                        }\n                    }, {\n                        buttonModel: {\n                            content: l10n.getConstant('FindNextBtn'), isPrimary: true, cssClass: 'e-btn-findNext', disabled: true\n                        },\n                        click: function () {\n                            _this.dialogMessage();\n                            _this.findDlgClick('next');\n                        }\n                    }, {\n                        buttonModel: {\n                            content: l10n.getConstant('ReplaceBtn'), isPrimary: true, cssClass: 'e-btn-replace', disabled: true\n                        },\n                        click: function () {\n                            _this.dialogMessage();\n                            _this.findDlgClick('replace');\n                        }\n                    }, {\n                        buttonModel: {\n                            content: l10n.getConstant('ReplaceAllBtn'), isPrimary: true, cssClass: 'e-btn-replaceAll', disabled: true\n                        },\n                        click: function () {\n                            _this.dialogMessage();\n                            _this.findDlgClick('replaceAll');\n                        }\n                    }], open: function () {\n                    var findInput = _this.parent.element.querySelector('.e-text-findNext').value;\n                    if (findInput) {\n                        var prevButton = _this.parent.element.querySelector('.e-btn-findPrevious');\n                        var prevButtonObj = getComponent(prevButton, 'btn');\n                        prevButtonObj.disabled = false;\n                        getComponent(_this.parent.element.querySelector('.e-btn-findNext'), 'btn').disabled = false;\n                    }\n                }, close: function () {\n                    dialogInst.hide();\n                }\n            };\n            dialogInst.show(dlg, cancelButton);\n        }\n        else {\n            dialogInst.hide();\n        }\n    };\n    FindAndReplace.prototype.dialogMessage = function () {\n        if (this.parent.element.querySelector('.e-replace-alert-span')) {\n            this.parent.element.querySelector('.e-replace-alert-span').remove();\n        }\n        else if (this.parent.element.querySelector('.e-find-alert-span')) {\n            this.parent.element.querySelector('.e-find-alert-span').remove();\n        }\n    };\n    FindAndReplace.prototype.renderGotoDlg = function () {\n        var _this = this;\n        var l10n = this.parent.serviceLocator.getService(locale);\n        var dialogInst = this.parent.serviceLocator.getService(dialog);\n        var cancelBtn = false;\n        if (isNullOrUndefined(this.parent.element.querySelector('.e-find-dlg'))) {\n            var dlg = {\n                width: 300, isModal: false, showCloseIcon: true, cssClass: 'e-goto-dlg', allowDragging: true,\n                header: l10n.getConstant('GotoHeader'),\n                beforeOpen: function (args) {\n                    var dlgArgs = {\n                        dialogName: 'GoToDialog',\n                        element: args.element, target: args.target, cancel: args.cancel\n                    };\n                    _this.parent.trigger('dialogBeforeOpen', dlgArgs);\n                    if (dlgArgs.cancel) {\n                        args.cancel = true;\n                    }\n                    dialogInst.dialogInstance.content = _this.GotoContent();\n                    dialogInst.dialogInstance.dataBind();\n                    _this.parent.element.focus();\n                },\n                buttons: [{\n                        buttonModel: {\n                            content: l10n.getConstant('Ok'), isPrimary: true, cssClass: 'e-btn-goto-ok'\n                        },\n                        click: function () {\n                            _this.gotoHandler();\n                        },\n                    }], close: function () {\n                    dialogInst.hide();\n                }, open: function () {\n                    _this.textFocus();\n                },\n            };\n            dialogInst.show(dlg, cancelBtn);\n        }\n        else {\n            dialogInst.hide();\n        }\n    };\n    FindAndReplace.prototype.textFocus = function () {\n        var _this = this;\n        var element = this.parent.element.querySelector('.e-text-goto');\n        element.addEventListener('focus', function () {\n            if (_this.parent.element.querySelector('.e-goto-alert-span')) {\n                _this.parent.element.querySelector('.e-goto-alert-span').remove();\n            }\n        });\n    };\n    FindAndReplace.prototype.findDlgClick = function (findDlgArgs) {\n        if (findDlgArgs === 'prev') {\n            this.findHandler({ findOption: findDlgArgs });\n        }\n        else if (findDlgArgs === 'next') {\n            this.findHandler({ findOption: findDlgArgs });\n        }\n        else {\n            this.replaceHandler({ findDlgArgs: findDlgArgs });\n        }\n    };\n    FindAndReplace.prototype.findHandler = function (findOpt) {\n        var findInput = this.parent.element.querySelector('.e-text-findNext');\n        if (!findInput) {\n            findInput = this.parent.element.querySelector('.e-text-findNext-short');\n            if (!findInput) {\n                this.gotoAlert();\n            }\n        }\n        var value = findInput.value;\n        if (findInput.value !== '') {\n            var sheetIndex = this.parent.activeSheetIndex;\n            var checkCase = this.parent.element.querySelector('.e-findnreplace-checkcase');\n            var isCSen = void 0;\n            if (!checkCase) {\n                isCSen = false;\n            }\n            else {\n                var caseCheckbox = getComponent(checkCase, 'checkbox');\n                isCSen = caseCheckbox.checked;\n            }\n            var checkmatch = this.parent.element.querySelector('.e-findnreplace-checkmatch');\n            var isEMatch = void 0;\n            if (!checkmatch) {\n                isEMatch = false;\n            }\n            else {\n                var entireMatchCheckbox = getComponent(checkmatch, 'checkbox');\n                isEMatch = entireMatchCheckbox.checked;\n            }\n            var searchitem = this.parent.element.querySelector('.e-findnreplace-searchby');\n            var searchBy = void 0;\n            if (!searchitem) {\n                searchBy = 'By Row';\n            }\n            else {\n                var searchDDL = getComponent(searchitem, 'dropdownlist');\n                searchBy = searchDDL.value.toString();\n            }\n            var modeitem = this.parent.element.querySelector('.e-findnreplace-searchwithin');\n            var mode = void 0;\n            if (!modeitem) {\n                mode = 'Sheet';\n            }\n            else {\n                var modeDDL = getComponent(modeitem, 'dropdownlist');\n                mode = modeDDL.value.toString();\n            }\n            var args = {\n                value: value, sheetIndex: sheetIndex, findOpt: findOpt.findOption, mode: mode, isCSen: isCSen,\n                isEMatch: isEMatch, searchBy: searchBy\n            };\n            if (findOpt.findOption === 'next' || findOpt.findOption === 'prev') {\n                this.parent.find(args);\n            }\n            else if (findOpt.countArgs.countOpt === 'count') {\n                this.parent.notify(count, args);\n                findOpt.countArgs.findCount = args.findCount;\n            }\n        }\n    };\n    FindAndReplace.prototype.replaceHandler = function (replace) {\n        var sheetIndex = this.parent.activeSheetIndex;\n        var findInput = this.parent.element.querySelector('.e-text-findNext');\n        var replaceWith = this.parent.element.querySelector('.e-text-replaceInp');\n        var checkCase = this.parent.element.querySelector('.e-findnreplace-checkcase');\n        var caseCheckbox = getComponent(checkCase, 'checkbox');\n        var checkmatch = this.parent.element.querySelector('.e-findnreplace-checkmatch');\n        var eMatchCheckbox = getComponent(checkmatch, 'checkbox');\n        var searchitem = this.parent.element.querySelector('.e-findnreplace-searchby');\n        var searchDDL = getComponent(searchitem, 'dropdownlist');\n        var modeitem = this.parent.element.querySelector('.e-findnreplace-searchwithin');\n        var modeDDL = getComponent(modeitem, 'dropdownlist');\n        var findOption = 'next';\n        var args = {\n            value: findInput.value, mode: modeDDL.value.toString(), isCSen: caseCheckbox.checked,\n            isEMatch: eMatchCheckbox.checked, searchBy: searchDDL.value.toString(), findOpt: findOption, replaceValue: replaceWith.value,\n            replaceBy: replace.findDlgArgs ? replace.findDlgArgs : replace.replaceMode, sheetIndex: sheetIndex\n        };\n        this.parent.replace(args);\n    };\n    FindAndReplace.prototype.gotoHandler = function (address) {\n        if (address) {\n            this.parent.goTo(address.address);\n        }\n        else {\n            var item = this.parent.element.querySelector('.e-text-goto');\n            var gotoaddress = item.value;\n            var splitAddress = gotoaddress.split('');\n            if ((gotoaddress === '') || isNaN(parseInt(splitAddress[1], 10))) {\n                this.gotoAlert();\n                return;\n            }\n            else {\n                var address_1 = gotoaddress.toString().toUpperCase();\n                this.parent.goTo(address_1);\n            }\n        }\n    };\n    FindAndReplace.prototype.gotoAlert = function () {\n        var l10n = this.parent.serviceLocator.getService(locale);\n        var gotoSpan = this.parent.createElement('span', {\n            className: 'e-goto-alert-span',\n            innerHTML: l10n.getConstant('InsertingEmptyValue')\n        });\n        (this.parent.element.querySelector('.e-goto-dlg').querySelector('.e-dlg-content')).appendChild(gotoSpan);\n    };\n    FindAndReplace.prototype.showDialog = function () {\n        if (this.parent.element.querySelector('.e-replace-alert-span')) {\n            this.parent.element.querySelector('.e-replace-alert-span').remove();\n        }\n        var l10n = this.parent.serviceLocator.getService(locale);\n        var findSpan = this.parent.createElement('span', {\n            className: 'e-find-alert-span',\n            innerHTML: l10n.getConstant('NoElements')\n        });\n        (this.parent.element.querySelector('.e-find-dlg').querySelector('.e-dlg-content')).appendChild(findSpan);\n    };\n    FindAndReplace.prototype.replaceAllDialog = function (options) {\n        if (this.parent.element.querySelector('.e-find-alert-span')) {\n            this.parent.element.querySelector('.e-find-alert-span').remove();\n        }\n        var l10n = (this.parent.serviceLocator.getService(locale));\n        var replaceSpan = this.parent.createElement('span', {\n            className: 'e-replace-alert-span',\n            innerHTML: options.count + l10n.getConstant('ReplaceAllEnd') + options.replaceValue\n        });\n        if (this.parent.element.querySelector('.e-find-dlg')) {\n            (this.parent.element.querySelector('.e-find-dlg').querySelector('.e-dlg-content')).appendChild(replaceSpan);\n        }\n    };\n    FindAndReplace.prototype.findKeyUp = function (e) {\n        if (e.target, 'e-text-findNext') {\n            var findValue_1 = this.parent.element.querySelector('.e-text-findNext').value;\n            if (!isNullOrUndefined(findValue_1) && findValue_1 !== '') {\n                var prevButton = this.parent.element.querySelector('.e-btn-findPrevious');\n                var prevButtonObj = getComponent(prevButton, 'btn');\n                prevButtonObj.disabled = false;\n                getComponent(this.parent.element.querySelector('.e-btn-findNext'), 'btn').disabled = false;\n            }\n            else {\n                getComponent(this.parent.element.querySelector('.e-btn-findPrevious'), 'btn').disabled = true;\n                getComponent(this.parent.element.querySelector('.e-btn-findNext'), 'btn').disabled = true;\n                this.dialogMessage();\n            }\n        }\n        var findValue = this.parent.element.querySelector('.e-text-findNext').value;\n        var replaceValue = this.parent.element.querySelector('.e-text-replaceInp').value;\n        if (!isNullOrUndefined(findValue) && !isNullOrUndefined(replaceValue) && (findValue !== '') && (replaceValue !== '')) {\n            if (this.parent.getActiveSheet().isProtected === false) {\n                getComponent(this.parent.element.querySelector('.e-btn-replace'), 'btn').disabled = false;\n                getComponent(this.parent.element.querySelector('.e-btn-replaceAll'), 'btn').disabled = false;\n            }\n        }\n        else {\n            getComponent(this.parent.element.querySelector('.e-btn-replace'), 'btn').disabled = true;\n            getComponent(this.parent.element.querySelector('.e-btn-replaceAll'), 'btn').disabled = true;\n            this.dialogMessage();\n        }\n    };\n    FindAndReplace.prototype.findandreplaceContent = function () {\n        if (this.parent.element.querySelector('.e-text-findNext-short')) {\n            this.shortValue = this.parent.element.querySelector('.e-text-findNext-short').value;\n        }\n        var dialogElem = this.parent.createElement('div', { className: 'e-link-dialog' });\n        var findElem = this.parent.createElement('div', { className: 'e-find' });\n        var findCheck = this.parent.createElement('div', { className: 'e-findCheck' });\n        var l10n = this.parent.serviceLocator.getService(locale);\n        dialogElem.appendChild(findElem);\n        var findTextE = this.parent.createElement('div', { className: 'e-cont' });\n        var findTextH = this.parent.createElement('p', { className: 'e-header', innerHTML: l10n.getConstant('FindWhat') });\n        var findTextIp = this.parent.createElement('input', {\n            className: 'e-input e-text-findNext', attrs: {\n                'type': 'Text', 'placeholder': l10n.getConstant('FindValue'),\n                'value': this.shortValue\n            }\n        });\n        findTextE.appendChild(findTextIp);\n        findTextE.insertBefore(findTextH, findTextIp);\n        findElem.appendChild(findTextE);\n        var findTextBox = new TextBox({ width: '70%' });\n        findTextBox.createElement = this.parent.createElement;\n        findTextBox.appendTo(findTextIp);\n        var replaceTextE = this.parent.createElement('div', { className: 'e-cont' });\n        var replaceTextH = this.parent.createElement('p', { className: 'e-header', innerHTML: l10n.getConstant('ReplaceWith') });\n        var replaceTextIp = this.parent.createElement('input', {\n            className: 'e-input e-text-replaceInp', attrs: { 'type': 'Text', 'placeholder': l10n.getConstant('ReplaceValue') }\n        });\n        replaceTextE.appendChild(replaceTextIp);\n        replaceTextE.insertBefore(replaceTextH, replaceTextIp);\n        findElem.appendChild(replaceTextE);\n        var replaceTextBox = new TextBox({ width: '70%' });\n        replaceTextBox.createElement = this.parent.createElement;\n        replaceTextBox.appendTo(replaceTextIp);\n        var withinData = [\n            { Id: 'Sheet', Within: l10n.getConstant('Sheet') },\n            { Id: 'Workbook', Within: l10n.getConstant('Workbook') }\n        ];\n        var withInDDL = new DropDownList({\n            dataSource: withinData,\n            cssClass: 'e-searchby',\n            fields: { value: 'Id', text: 'Within' }, width: '50%', index: 0\n        });\n        var withIn = this.parent.createElement('input', {\n            className: 'e-findnreplace-searchwithin', attrs: { type: 'select', label: l10n.getConstant('SearchBy') }\n        });\n        var withinTextH = this.parent.createElement('p', { className: 'e-header', innerHTML: l10n.getConstant('SearchWithin') });\n        findElem.appendChild(withinTextH);\n        findElem.appendChild(withIn);\n        withInDDL.createElement = this.parent.createElement;\n        withInDDL.appendTo(withIn);\n        var searchData = [\n            { Id: 'By Row', Search: l10n.getConstant('ByRow') },\n            { Id: 'By Column', Search: l10n.getConstant('ByColumn') }\n        ];\n        var searchDDL = new DropDownList({\n            dataSource: searchData,\n            cssClass: 'e-searchby',\n            fields: { value: 'Id', text: 'Search' }, width: '50%', index: 0\n        });\n        var searchIn = this.parent.createElement('input', {\n            className: 'e-findnreplace-searchby', attrs: { type: 'select', label: l10n.getConstant('SearchBy') }\n        });\n        var searchTextH = this.parent.createElement('p', { className: 'e-header', innerHTML: l10n.getConstant('SearchBy') });\n        findElem.appendChild(searchTextH);\n        findElem.appendChild(searchIn);\n        searchDDL.createElement = this.parent.createElement;\n        searchDDL.appendTo(searchIn);\n        var isCSen = new CheckBox({\n            label: l10n.getConstant('MatchCase'), checked: false,\n            cssClass: 'e-findnreplace-casecheckbox'\n        });\n        var caaseCheckbox = this.parent.createElement('input', {\n            className: 'e-findnreplace-checkcase', attrs: { type: 'checkbox' }\n        });\n        findCheck.appendChild(caaseCheckbox);\n        isCSen.createElement = this.parent.createElement;\n        isCSen.appendTo(caaseCheckbox);\n        var isEMatch = new CheckBox({\n            label: l10n.getConstant('MatchExactCellElements'), checked: false,\n            cssClass: 'e-findnreplace-exactmatchcheckbox',\n        });\n        var entirematchCheckbox = this.parent.createElement('input', {\n            className: 'e-findnreplace-checkmatch', attrs: { type: 'checkbox' }\n        });\n        findCheck.appendChild(entirematchCheckbox);\n        isEMatch.createElement = this.parent.createElement;\n        isEMatch.appendTo(entirematchCheckbox);\n        findElem.appendChild(findCheck);\n        return dialogElem;\n    };\n    FindAndReplace.prototype.GotoContent = function () {\n        var l10n = this.parent.serviceLocator.getService(locale);\n        var dialogElem = this.parent.createElement('div', { className: 'e-link-dialog' });\n        var gotoElem = this.parent.createElement('div', { className: 'e-goto' });\n        dialogElem.appendChild(gotoElem);\n        var gotoTextE = this.parent.createElement('div', { className: 'e-cont' });\n        var gotoTextH = this.parent.createElement('p', { className: 'e-header', innerHTML: l10n.getConstant('Reference') });\n        var gotoTextBox = new TextBox({\n            placeholder: l10n.getConstant('EntercellAddress')\n        });\n        var gotoTextIp = this.parent.createElement('input', { className: 'e-text-goto', attrs: { 'type': 'Text' } });\n        gotoTextE.appendChild(gotoTextIp);\n        gotoTextE.insertBefore(gotoTextH, gotoTextIp);\n        gotoElem.appendChild(gotoTextE);\n        gotoTextBox.createElement = this.parent.createElement;\n        gotoTextBox.appendTo(gotoTextIp);\n        return dialogElem;\n    };\n    /**\n     * To destroy the find-and-replace module.\n     * @return {void}\n     */\n    FindAndReplace.prototype.destroy = function () {\n        this.removeEventListener();\n        this.parent = null;\n    };\n    /**\n     * Gets the module name.\n     * @returns string\n     */\n    FindAndReplace.prototype.getModuleName = function () {\n        return 'findAndReplace';\n    };\n    return FindAndReplace;\n}());\nexport { FindAndReplace };\n","import { applyMerge, activeCellMergedRange } from '../../workbook/common/index';\nimport { hiddenMerge, dialog, locale } from '../common/index';\nimport { checkPrevMerge, checkMerge } from '../common/index';\nimport { getCell, isHiddenCol, isHiddenRow } from '../../workbook/index';\n/**\n * The `Merge` module is used to to merge the range of cells.\n */\nvar Merge = /** @class */ (function () {\n    /**\n     * Constructor for the Spreadsheet merge module.\n     * @private\n     */\n    function Merge(parent) {\n        this.parent = parent;\n        this.addEventListener();\n    }\n    Merge.prototype.merge = function (args) {\n        var _this = this;\n        if (args.showDialog) {\n            this.parent.serviceLocator.getService(dialog).show({\n                target: this.parent.element,\n                height: 180, width: 400, isModal: true, showCloseIcon: true,\n                content: this.parent.serviceLocator.getService(locale).getConstant('PasteMergeAlert'),\n                beforeOpen: function (args) {\n                    var dlgArgs = {\n                        dialogName: 'MergeDialog',\n                        element: args.element, target: args.target, cancel: args.cancel\n                    };\n                    _this.parent.trigger('dialogBeforeOpen', dlgArgs);\n                    if (dlgArgs.cancel) {\n                        args.cancel = true;\n                    }\n                    _this.parent.element.focus();\n                },\n            });\n            return;\n        }\n        this.parent.serviceLocator.getService('cell').refresh(args.rowIdx, args.colIdx, args.lastCell, args.element);\n    };\n    Merge.prototype.hideHandler = function (args) {\n        var sheet = this.parent.getActiveSheet();\n        var mergeArgs = { range: [args.rowIdx, args.colIdx, args.rowIdx, args.colIdx] };\n        this.parent.notify(activeCellMergedRange, mergeArgs);\n        mergeArgs.range = mergeArgs.range;\n        var endIdx;\n        var cell = getCell(mergeArgs.range[0], mergeArgs.range[1], sheet) || {};\n        var startIdx = args.model === 'row' ? mergeArgs.range[0] : mergeArgs.range[1];\n        endIdx = startIdx + ((cell[args.model + \"Span\"] || 1) - 1);\n        if ((!args.isEnd && (args.start === startIdx || isHiddenCol(sheet, startIdx))) || (args.isEnd && (args.start > startIdx &&\n            !isHiddenCol(sheet, startIdx)))) {\n            return;\n        }\n        if (cell[args.model + \"Span\"] > 1 && endIdx >= args.start) {\n            if (args.model === 'row' ? isHiddenRow(sheet, startIdx) : isHiddenCol(sheet, startIdx)) {\n                if (args.end < endIdx && (endIdx - args.end > 1 || cell.rowSpan > 1)) {\n                    var cellEle = this.parent.getCell(args.rowIdx, args.end + 1);\n                    if (cellEle) {\n                        if (endIdx - args.end > 1) {\n                            cellEle.colSpan = endIdx - args.end;\n                        }\n                        cellEle.style.display = '';\n                    }\n                    if (cell.rowSpan > 1) {\n                        var rowSpan = cell.rowSpan - this.parent.hiddenCount(args.rowIdx, args.rowIdx + (cell.rowSpan - 1));\n                        if (rowSpan > 1) {\n                            cellEle.rowSpan = rowSpan;\n                        }\n                    }\n                }\n            }\n            else {\n                this.merge({ rowIdx: mergeArgs.range[0], colIdx: mergeArgs.range[1] });\n            }\n        }\n    };\n    Merge.prototype.checkPrevMerge = function (args) {\n        var cell;\n        var sheet = this.parent.getActiveSheet();\n        var mergeArgs;\n        var mergeCount;\n        if (args.isRow) {\n            if (args.rowIdx - 1 > -1 && isHiddenRow(sheet, args.rowIdx - 1)) {\n                cell = getCell(args.rowIdx - 1, args.colIdx, sheet) || {};\n                if ((cell.rowSpan !== undefined || cell.colSpan !== undefined) && (cell.colSpan === undefined || cell.colSpan > 1 ||\n                    (args.colIdx - 1 > -1 && isHiddenCol(sheet, args.colIdx - 1)))) {\n                    mergeArgs = { range: [args.rowIdx - 1, args.colIdx, args.rowIdx - 1, args.colIdx] };\n                    this.parent.notify(activeCellMergedRange, mergeArgs);\n                    mergeArgs.range = mergeArgs.range;\n                    if (isHiddenRow(sheet, mergeArgs.range[0]) && mergeArgs.range[2] >= args.rowIdx) {\n                        cell = getCell(mergeArgs.range[0], mergeArgs.range[1], sheet) || {};\n                        if (cell.rowSpan > 1) {\n                            mergeCount = (mergeArgs.range[2] - args.rowIdx) + 1 - this.parent.hiddenCount(args.rowIdx, args.rowIdx + (mergeArgs.range[2] - args.rowIdx));\n                            if (mergeCount > 1) {\n                                args.td.rowSpan = mergeCount;\n                                args.td.style.display = '';\n                            }\n                            if (cell.colSpan > 1 && !(args.colIdx - 1 > -1 && isHiddenCol(sheet, args.colIdx - 1))) {\n                                mergeCount = cell.colSpan - this.parent.hiddenCount(args.colIdx, args.colIdx + (cell.colSpan - 1), 'columns');\n                                if (mergeCount > 1) {\n                                    args.td.colSpan = mergeCount;\n                                    args.td.style.display = '';\n                                }\n                            }\n                        }\n                    }\n                }\n            }\n            return;\n        }\n        if (args.colIdx - 1 > -1 && isHiddenCol(sheet, args.colIdx - 1)) {\n            cell = getCell(args.rowIdx, args.colIdx - 1, sheet) || {};\n            if ((cell.colSpan !== undefined || cell.rowSpan !== undefined) && (cell.rowSpan === undefined || cell.rowSpan > 1 ||\n                (args.rowIdx - 1 > -1 && isHiddenRow(sheet, args.rowIdx - 1)))) {\n                mergeArgs = { range: [args.rowIdx, args.colIdx - 1, args.rowIdx, args.colIdx - 1] };\n                this.parent.notify(activeCellMergedRange, mergeArgs);\n                mergeArgs.range = mergeArgs.range;\n                if (isHiddenCol(sheet, mergeArgs.range[1]) && mergeArgs.range[3] >= args.colIdx) {\n                    cell = getCell(mergeArgs.range[0], mergeArgs.range[1], sheet) || {};\n                    if (cell.colSpan > 1) {\n                        mergeCount = (mergeArgs.range[3] - args.colIdx) + 1 - this.parent.hiddenCount(args.colIdx, args.colIdx + (cell.colSpan - 1), 'columns');\n                        if (mergeCount > 1) {\n                            args.td.colSpan = mergeCount;\n                            args.td.style.display = '';\n                        }\n                        if (cell.rowSpan > 1 && !(args.rowIdx - 1 > -1 && isHiddenRow(sheet, args.rowIdx - 1))) {\n                            mergeCount = cell.rowSpan - this.parent.hiddenCount(args.rowIdx, args.rowIdx + (cell.rowSpan - 1));\n                            if (mergeCount > 1) {\n                                args.td.rowSpan = mergeCount;\n                                args.td.style.display = '';\n                            }\n                        }\n                    }\n                }\n            }\n        }\n    };\n    Merge.prototype.checkMerge = function (args) {\n        var sheet = this.parent.getActiveSheet();\n        var cell = getCell(args.rowIdx, args.colIdx, sheet) || {};\n        if (args.isRow) {\n            if (cell.colSpan === undefined || isHiddenCol(sheet, args.colIdx - 1)) {\n                var mergeArgs = { range: [args.rowIdx, args.colIdx, args.rowIdx, args.colIdx] };\n                mergeArgs.range = mergeArgs.range;\n                this.parent.notify(activeCellMergedRange, mergeArgs);\n                if (isHiddenCol(sheet, args.colIdx - 1) && !isHiddenCol(sheet, mergeArgs.range[1])) {\n                    return;\n                }\n                cell = getCell(mergeArgs.range[0], mergeArgs.range[1], sheet);\n                var mergeCount = (mergeArgs.range[2] - args.rowIdx) + 1 - this.parent.hiddenCount(args.rowIdx, mergeArgs.range[2]);\n                if (mergeCount > 1) {\n                    this.merge({ rowIdx: mergeArgs.range[0], colIdx: mergeArgs.range[1], element: args.td });\n                    args.td.rowSpan = mergeCount;\n                    args.td.style.display = '';\n                }\n            }\n        }\n        else {\n            if (cell.rowSpan === undefined || isHiddenRow(sheet, args.rowIdx - 1)) {\n                var mergeArgs = { range: [args.rowIdx, args.colIdx, args.rowIdx, args.colIdx] };\n                mergeArgs.range = mergeArgs.range;\n                this.parent.notify(activeCellMergedRange, mergeArgs);\n                if (isHiddenRow(sheet, args.rowIdx - 1) && !isHiddenRow(sheet, mergeArgs.range[0])) {\n                    return;\n                }\n                cell = getCell(mergeArgs.range[0], mergeArgs.range[1], sheet);\n                var mergeCount = (mergeArgs.range[3] - args.colIdx) + 1 - this.parent.hiddenCount(args.colIdx, mergeArgs.range[3], 'columns');\n                if (mergeCount > 1) {\n                    this.merge({ rowIdx: mergeArgs.range[0], colIdx: mergeArgs.range[1], element: args.td });\n                    args.td.colSpan = mergeCount;\n                    args.td.style.display = '';\n                }\n            }\n        }\n    };\n    Merge.prototype.addEventListener = function () {\n        this.parent.on(applyMerge, this.merge, this);\n        this.parent.on(hiddenMerge, this.hideHandler, this);\n        this.parent.on(checkPrevMerge, this.checkPrevMerge, this);\n        this.parent.on(checkMerge, this.checkMerge, this);\n    };\n    /**\n     * Destroy merge module.\n     */\n    Merge.prototype.destroy = function () {\n        this.removeEventListener();\n        this.parent = null;\n    };\n    Merge.prototype.removeEventListener = function () {\n        if (!this.parent.isDestroyed) {\n            this.parent.off(applyMerge, this.merge);\n            this.parent.off(hiddenMerge, this.hideHandler);\n            this.parent.off(checkPrevMerge, this.checkPrevMerge);\n            this.parent.off(checkMerge, this.checkMerge);\n        }\n    };\n    /**\n     * Get the merge module name.\n     */\n    Merge.prototype.getModuleName = function () {\n        return 'merge';\n    };\n    return Merge;\n}());\nexport { Merge };\n","import { checkConditionalFormat, initiateConditionalFormat, locale, dialog, setCF } from '../common/index';\nimport { beginAction, completeAction } from '../common/index';\nimport { getCell, setRow, setCell } from '../../workbook/base/index';\nimport { getRangeIndexes, checkDateFormat, cFInitialCheck, isNumber, cFRender, cFDelete } from '../../workbook/common/index';\nimport { isDateTime, dateToInt, applyCellFormat, clearCF } from '../../workbook/common/index';\nimport { setCFRule, clearCells } from '../../workbook/common/index';\nimport { isNullOrUndefined } from '@syncfusion/ej2-base';\nimport { DropDownList } from '@syncfusion/ej2-dropdowns';\nimport { NumericTextBox } from '@syncfusion/ej2-inputs';\n/**\n * Represents Conditional Formatting support for Spreadsheet.\n */\nvar ConditionalFormatting = /** @class */ (function () {\n    /**\n     * Constructor for the Spreadsheet Conditional Formatting module.\n     */\n    function ConditionalFormatting(parent) {\n        this.parent = parent;\n        this.addEventListener();\n    }\n    /**\n     * To destroy the Conditional Formatting module.\n     * @return {void}\n     */\n    ConditionalFormatting.prototype.destroy = function () {\n        this.removeEventListener();\n    };\n    ConditionalFormatting.prototype.addEventListener = function () {\n        this.parent.on(cFRender, this.cFInitialRender, this);\n        this.parent.on(cFInitialCheck, this.cFInitialCheckHandler, this);\n        this.parent.on(checkConditionalFormat, this.checkConditionalFormatHandler, this);\n        this.parent.on(initiateConditionalFormat, this.initiateCFHandler, this);\n        this.parent.on(setCF, this.setCFHandler, this);\n        this.parent.on(cFDelete, this.cFDeleteHandler, this);\n        this.parent.on(clearCF, this.clearCFHandler, this);\n        this.parent.on(clearCells, this.addClearCFHandler, this);\n    };\n    ConditionalFormatting.prototype.removeEventListener = function () {\n        if (!this.parent.isDestroyed) {\n            this.parent.off(cFRender, this.cFInitialRender);\n            this.parent.off(cFInitialCheck, this.cFInitialCheckHandler);\n            this.parent.off(checkConditionalFormat, this.checkConditionalFormatHandler);\n            this.parent.off(initiateConditionalFormat, this.initiateCFHandler);\n            this.parent.off(setCF, this.setCFHandler);\n            this.parent.off(cFDelete, this.cFDeleteHandler);\n            this.parent.off(clearCF, this.clearCFHandler);\n        }\n    };\n    ConditionalFormatting.prototype.setCF = function (conditionalFormat) {\n        conditionalFormat.range = conditionalFormat.range || this.parent.getActiveSheet().selectedRange;\n        var eventArgs = {\n            range: conditionalFormat.range, type: conditionalFormat.type, cFColor: conditionalFormat.cFColor,\n            value: conditionalFormat.value, cancel: false\n        };\n        this.parent.notify(beginAction, { eventArgs: eventArgs, action: 'conditionalFormat' });\n        if (!eventArgs.cancel) {\n            conditionalFormat.type = eventArgs.type;\n            conditionalFormat.cFColor = eventArgs.cFColor;\n            conditionalFormat.value = eventArgs.value;\n            conditionalFormat.range = eventArgs.range;\n            this.parent.notify(setCFRule, { conditionalFormat: conditionalFormat });\n            delete eventArgs.cancel;\n            this.parent.notify(completeAction, { eventArgs: eventArgs, action: 'conditionalFormat' });\n        }\n    };\n    ConditionalFormatting.prototype.addClearCFHandler = function (args) {\n        var sheet = this.parent.getActiveSheet();\n        var clearCFormats = args.conditionalFormats;\n        var oldRange = args.oldRange;\n        var selectedRange = args.selectedRange;\n        var conditionalFormats = sheet.conditionalFormats;\n        for (var cCFIdx = 0; cCFIdx < clearCFormats.length; cCFIdx++) {\n            var isApply = false;\n            for (var cFIdx = 0; cFIdx < conditionalFormats.length; cFIdx++) {\n                if (conditionalFormats[cFIdx].type === clearCFormats[cCFIdx].type &&\n                    conditionalFormats[cFIdx].range === clearCFormats[cCFIdx].range) {\n                    isApply = true;\n                    conditionalFormats[cFIdx].range = oldRange[cCFIdx];\n                    sheet.conditionalFormats[cFIdx].range = oldRange[cCFIdx];\n                    var sRangeIdx = getRangeIndexes(selectedRange);\n                    var cFRanges = oldRange[cCFIdx].split(',');\n                    for (var cFRangeIdx = 0; cFRangeIdx < cFRanges.length; cFRangeIdx++) {\n                        var newRangeIdxs = getRangeIndexes(cFRanges[cFRangeIdx]);\n                        for (var cFRowIdx = newRangeIdxs[0]; cFRowIdx <= newRangeIdxs[2]; cFRowIdx++) {\n                            for (var cFColIdx = newRangeIdxs[1]; cFColIdx <= newRangeIdxs[3]; cFColIdx++) {\n                                for (var sRRowIdx = sRangeIdx[0]; sRRowIdx <= sRangeIdx[2]; sRRowIdx++) {\n                                    for (var sRColIdx = sRangeIdx[1]; sRColIdx <= sRangeIdx[3]; sRColIdx++) {\n                                        if (sRRowIdx === cFRowIdx && sRColIdx === cFColIdx) {\n                                            var td = this.parent.getCell(cFRowIdx, cFColIdx);\n                                            var cell = sheet.rows[cFRowIdx] ? sheet.rows[cFRowIdx].cells[cFColIdx] ?\n                                                sheet.rows[cFRowIdx].cells[cFColIdx] : null : null;\n                                            if (cell) {\n                                                this.cFInitialCheckHandler({\n                                                    rowIdx: cFRowIdx, colIdx: cFColIdx,\n                                                    cell: cell, td: td, conditionalFormat: conditionalFormats[cFIdx]\n                                                });\n                                            }\n                                        }\n                                    }\n                                }\n                            }\n                        }\n                    }\n                }\n            }\n            if (!isApply) {\n                var conditionalFormat = clearCFormats[cCFIdx];\n                conditionalFormat.range = oldRange[cCFIdx];\n                this.parent.notify(setCFRule, { conditionalFormat: conditionalFormat });\n            }\n        }\n    };\n    ConditionalFormatting.prototype.cFDeleteHandler = function (args) {\n        var td = this.parent.getCell(args.rowIdx, args.colIdx);\n        if (td) {\n            if (td.querySelector('.e-cf-databar')) {\n                td.removeChild(td.querySelector('.e-cf-databar'));\n            }\n            if (td.querySelector('.e-iconsetspan')) {\n                td.removeChild(td.querySelector('.e-iconsetspan'));\n            }\n        }\n    };\n    ConditionalFormatting.prototype.clearCFHandler = function (args) {\n        var sheet = this.parent.getActiveSheet();\n        var tdEle = this.parent.getCell(args.rIdx, args.cIdx);\n        var cell = getCell(args.rIdx, args.cIdx, sheet);\n        if (!tdEle) {\n            return;\n        }\n        tdEle.classList.remove('e-redft');\n        tdEle.classList.remove('e-yellowft');\n        tdEle.classList.remove('e-greenft');\n        tdEle.classList.remove('e-redf');\n        tdEle.classList.remove('e-redt');\n        tdEle.classList.remove('e-iconset');\n        if (tdEle.style) {\n            if (tdEle.style.backgroundColor) {\n                tdEle.style.backgroundColor = '';\n                var style = this.parent.getCellStyleValue(['backgroundColor'], [args.rIdx, args.cIdx]);\n                this.parent.notify(applyCellFormat, {\n                    style: style, rowIdx: args.rIdx, colIdx: args.cIdx\n                });\n            }\n            if (tdEle.style.color) {\n                tdEle.style.color = '';\n                var style = this.parent.getCellStyleValue(['color'], [args.rIdx, args.cIdx]);\n                this.parent.notify(applyCellFormat, {\n                    style: style, rowIdx: args.rIdx, colIdx: args.cIdx\n                });\n            }\n        }\n        if (tdEle.querySelector('.e-cf-databar')) {\n            tdEle.removeChild(tdEle.querySelector('.e-cf-databar'));\n            tdEle.textContent = this.parent.getDisplayText(cell);\n        }\n        if (tdEle.querySelector('.e-iconsetspan')) {\n            tdEle.removeChild(tdEle.querySelector('.e-iconsetspan'));\n            tdEle.textContent = this.parent.getDisplayText(cell);\n        }\n    };\n    ConditionalFormatting.prototype.setCFHandler = function (args) {\n        if (args.action === 'cf_databars') {\n            this.setCF({ type: args.id });\n        }\n        else if (args.action === 'cf_colorscales') {\n            this.setCF({ type: args.id });\n        }\n        else if (args.action === 'cf_iconsets') {\n            this.setCF({ type: args.id });\n        }\n    };\n    ConditionalFormatting.prototype.initiateCFHandler = function (args) {\n        var _this = this;\n        var l10n = this.parent.serviceLocator.getService(locale);\n        var dialogInst = this.parent.serviceLocator.getService(dialog);\n        dialogInst.show({\n            width: 375, showCloseIcon: true, isModal: true, cssClass: 'e-conditionalformatting-dlg',\n            header: args.action.replace('...', ''),\n            target: document.querySelector('.e-control.e-spreadsheet'),\n            beforeOpen: function () {\n                dialogInst.dialogInstance.content = _this.cFDlgContent(args.action);\n                dialogInst.dialogInstance.dataBind();\n                _this.parent.element.focus();\n            },\n            buttons: [{\n                    buttonModel: {\n                        content: l10n.getConstant('Ok'),\n                        isPrimary: true,\n                        cssClass: 'e-btn e-clearall-btn e-flat'\n                    },\n                    click: function () {\n                        _this.dlgClickHandler(args.action);\n                        dialogInst.hide();\n                    }\n                }]\n        });\n        dialogInst.dialogInstance.refresh();\n    };\n    ConditionalFormatting.prototype.dlgClickHandler = function (action) {\n        var value1 = '';\n        var value2 = '';\n        var dlgCont = this.parent.element.querySelector('.e-conditionalformatting-dlg').\n            getElementsByClassName('e-dlg-content')[0].querySelector('.e-cf-dlg');\n        var mainCont = dlgCont.querySelector('.e-cfmain');\n        if (mainCont) {\n            var inpEle = mainCont.getElementsByTagName('input')[0];\n            if (inpEle && inpEle.parentElement.classList.contains('e-cfmain')) {\n                value1 = mainCont.getElementsByTagName('input')[0].value;\n            }\n            value2 = mainCont.getElementsByTagName('input')[1] ?\n                dlgCont.querySelector('.e-cfmain').getElementsByTagName('input')[1].value : '';\n        }\n        var cFColor = this.getCFColor(dlgCont.querySelector('.e-cfsub').getElementsByTagName('input')[0].value);\n        var cFType = action === 'Duplicate Values...' ?\n            dlgCont.querySelector('.e-cfmain').getElementsByTagName('input')[0].value : this.getType(action);\n        if (value1 !== '' && value2 !== '') {\n            this.setCF({\n                type: cFType,\n                cFColor: cFColor, value: value1 + ',' + value2\n            });\n        }\n        else if (value1 !== '') {\n            this.setCF({\n                type: cFType,\n                cFColor: cFColor, value: value1\n            });\n        }\n        else {\n            this.setCF({\n                type: cFType,\n                cFColor: cFColor, value: value2\n            });\n        }\n    };\n    ConditionalFormatting.prototype.getType = function (action) {\n        var l10n = this.parent.serviceLocator.getService(locale);\n        var result = '';\n        switch (action) {\n            case l10n.getConstant('GreaterThan') + '...':\n                result = 'GreaterThan';\n                break;\n            case l10n.getConstant('LessThan') + '...':\n                result = 'LessThan';\n                break;\n            case l10n.getConstant('Between') + '...':\n                result = 'Between';\n                break;\n            case l10n.getConstant('CFEqualTo') + '...':\n                result = 'EqualTo';\n                break;\n            case l10n.getConstant('TextThatContains') + '...':\n                result = 'ContainsText';\n                break;\n            case l10n.getConstant('ADateOccuring') + '...':\n                result = 'DateOccur';\n                break;\n            case l10n.getConstant('Top10Items') + '...':\n                result = 'Top10Items';\n                break;\n            case l10n.getConstant('Bottom10Items') + '...':\n                result = 'Bottom10Items';\n                break;\n            case l10n.getConstant('Top10') + ' %...':\n                result = 'Top10Percentage';\n                break;\n            case l10n.getConstant('Bottom10') + ' %...':\n                result = 'Bottom10Percentage';\n                break;\n            case l10n.getConstant('AboveAverage') + '...':\n                result = 'AboveAverage';\n                break;\n            case l10n.getConstant('BelowAverage') + '...':\n                result = 'BelowAverage';\n                break;\n        }\n        return result;\n    };\n    ConditionalFormatting.prototype.getCFColor = function (value) {\n        var l10n = this.parent.serviceLocator.getService(locale);\n        var result = 'RedFT';\n        switch (value) {\n            case l10n.getConstant('LightRedFillWithDarkRedText'):\n                result = 'RedFT';\n                break;\n            case l10n.getConstant('YellowFillWithDarkYellowText'):\n                result = 'YellowFT';\n                break;\n            case l10n.getConstant('GreenFillWithDarkGreenText'):\n                result = 'GreenFT';\n                break;\n            case l10n.getConstant('RedFill'):\n                result = 'RedF';\n                break;\n            case l10n.getConstant('RedText'):\n                result = 'RedT';\n                break;\n        }\n        return result;\n    };\n    ConditionalFormatting.prototype.cFDlgContent = function (action) {\n        var dlgText = this.getDlgText(action);\n        var l10n = this.parent.serviceLocator.getService(locale);\n        var dlgContent = this.parent.createElement('div', { className: 'e-cf-dlg' });\n        var mainDiv = this.parent.createElement('div', { className: 'e-cfmain' });\n        var subDiv = this.parent.createElement('div', { className: 'e-cfsub' });\n        var value1Text = this.parent.createElement('span', { className: 'e-header e-top-header', innerHTML: dlgText });\n        var value1Inp = this.parent.createElement('input', { className: 'e-input', id: 'valueInput', attrs: { type: 'text' } });\n        var duplicateSelectEle = this.parent.createElement('input', { className: 'e-select' });\n        var subDivText = this.parent.createElement('span', { className: 'e-header', innerHTML: l10n.getConstant('With') });\n        var colorSelectEle = this.parent.createElement('input', { className: 'e-select' });\n        dlgContent.appendChild(mainDiv);\n        dlgContent.appendChild(subDiv);\n        mainDiv.appendChild(value1Text);\n        if (action !== l10n.getConstant('DuplicateValues') + '...') {\n            if (action !== l10n.getConstant('AboveAverage') + '...' && action !== l10n.getConstant('BelowAverage') + '...') {\n                mainDiv.appendChild(value1Inp);\n                if (action === l10n.getConstant('Top10Items') + '...' || action === l10n.getConstant('Top10') + ' %...' ||\n                    action === l10n.getConstant('Bottom10Items') + '...' || action === l10n.getConstant('Bottom10') + ' %...') {\n                    var numeric = new NumericTextBox({\n                        value: 10\n                    });\n                    numeric.appendTo(value1Inp);\n                }\n            }\n        }\n        else {\n            mainDiv.appendChild(duplicateSelectEle);\n            var dupData = [\n                { text: l10n.getConstant('Duplicate'), id: 'duplicate' },\n                { text: l10n.getConstant('Unique'), id: 'unique' },\n            ];\n            var dupList = new DropDownList({\n                dataSource: dupData,\n                index: 0,\n                popupHeight: '200px'\n            });\n            dupList.appendTo(duplicateSelectEle);\n        }\n        if (action === l10n.getConstant('Between') + '...') {\n            var value2Text = this.parent.createElement('span', { className: 'e-header e-header-2', innerHTML: l10n.getConstant('And') });\n            var value2Inp = this.parent.createElement('input', { className: 'e-input' });\n            mainDiv.appendChild(value2Text);\n            mainDiv.appendChild(value2Inp);\n        }\n        subDiv.appendChild(subDivText);\n        subDiv.appendChild(colorSelectEle);\n        var colorData = [\n            { text: l10n.getConstant('LightRedFillWithDarkRedText'), value: 'redft', id: 'redft' },\n            { text: l10n.getConstant('YellowFillWithDarkYellowText'), id: 'yellowft' },\n            { text: l10n.getConstant('GreenFillWithDarkGreenText'), id: 'greenft' },\n            { text: l10n.getConstant('RedFill'), id: 'redf' },\n            { text: l10n.getConstant('RedText'), id: 'redt' },\n        ];\n        var colorList = new DropDownList({\n            dataSource: colorData,\n            index: 0,\n            popupHeight: '200px'\n        });\n        colorList.appendTo(colorSelectEle);\n        return dlgContent;\n    };\n    ConditionalFormatting.prototype.checkCellHandler = function (rowIdx, colIdx, conditionalFormat) {\n        var isApply = false;\n        var ranges = conditionalFormat.range.trim().split(',');\n        for (var rangeIdx = 0; rangeIdx < ranges.length; rangeIdx++) {\n            var cFrange = ranges[rangeIdx];\n            cFrange = cFrange.indexOf(':') > -1 ? cFrange : cFrange + ':' + cFrange;\n            var indexes = getRangeIndexes(cFrange);\n            if (rowIdx >= indexes[0] && rowIdx <= indexes[2] && colIdx >= indexes[1] && colIdx <= indexes[3]) {\n                isApply = true;\n                break;\n            }\n        }\n        return isApply;\n    };\n    ConditionalFormatting.prototype.getDlgText = function (action) {\n        var l10n = this.parent.serviceLocator.getService(locale);\n        var result = '';\n        switch (action) {\n            case l10n.getConstant('GreaterThan') + '...':\n                result = l10n.getConstant('FormatCellsGreaterThan');\n                break;\n            case l10n.getConstant('LessThan') + '...':\n                result = l10n.getConstant('FormatCellsLessThan');\n                break;\n            case l10n.getConstant('Between') + '...':\n                result = l10n.getConstant('FormatCellsBetween');\n                break;\n            case l10n.getConstant('CFEqualTo') + '...':\n                result = l10n.getConstant('FormatCellsEqualTo');\n                break;\n            case l10n.getConstant('TextThatContains') + '...':\n                result = l10n.getConstant('FormatCellsThatContainTheText');\n                break;\n            case l10n.getConstant('ADateOccuring') + '...':\n                result = l10n.getConstant('FormatCellsThatContainADateOccurring');\n                break;\n            case l10n.getConstant('DuplicateValues') + '...':\n                result = l10n.getConstant('FormatCellsDuplicate');\n                break;\n            case l10n.getConstant('Top10Items') + '...':\n                result = l10n.getConstant('FormatCellsTop');\n                break;\n            case l10n.getConstant('Top10') + ' %...':\n                result = l10n.getConstant('FormatCellsTop');\n                break;\n            case l10n.getConstant('Bottom10Items') + '...':\n                result = l10n.getConstant('FormatCellsBottom');\n                break;\n            case l10n.getConstant('Bottom10') + ' %...':\n                result = l10n.getConstant('FormatCellsBottom');\n                break;\n            case l10n.getConstant('AboveAverage') + '...':\n                result = l10n.getConstant('FormatCellsAbove');\n                break;\n            case l10n.getConstant('BelowAverage') + '...':\n                result = l10n.getConstant('FormatCellsBelow');\n                break;\n        }\n        return result;\n    };\n    ConditionalFormatting.prototype.cFInitialRender = function (args) {\n        var cFRules = this.parent.getActiveSheet().conditionalFormats;\n        if (cFRules) {\n            for (var cFRIdx = 0; cFRIdx < cFRules.length; cFRIdx++) {\n                var isApply = false;\n                isApply = this.checkCellHandler(args.rowIdx, args.colIdx, cFRules[cFRIdx]);\n                if (isApply) {\n                    this.cFInitialCheckHandler({\n                        rowIdx: args.rowIdx, colIdx: args.colIdx,\n                        cell: args.cell, td: args.td, conditionalFormat: cFRules[cFRIdx]\n                    });\n                }\n            }\n        }\n    };\n    ConditionalFormatting.prototype.cFInitialCheckHandler = function (args) {\n        var sheet = this.parent.getActiveSheet();\n        var formatStyle;\n        var isApply = false;\n        var cFColors = ['e-redft', 'e-yellowft', 'e-greenft', 'e-redf', 'e-redt'];\n        var value = args.cell.value || '';\n        var cFRule = args.conditionalFormat;\n        var td = args.td || this.parent.getCell(args.rowIdx, args.colIdx);\n        if (!td) {\n            return;\n        }\n        cFRule.type = cFRule.type || 'GreaterThan';\n        cFRule.cFColor = cFRule.cFColor ? cFRule.cFColor : cFRule.format ? cFRule.cFColor : 'RedFT';\n        isApply = this.cFRCheck(cFRule, value, td, args.rowIdx, args.colIdx, true);\n        if (isApply) {\n            for (var idx = 0; idx < cFColors.length; idx++) {\n                if (td.classList.contains(cFColors[idx])) {\n                    td.classList.remove(cFColors[idx]);\n                    break;\n                }\n            }\n            if (cFRule.format && cFRule.format.style) {\n                formatStyle = cFRule.format.style;\n            }\n            var style = {};\n            if (cFRule.cFColor) {\n                td.classList.add('e-' + cFRule.cFColor.toLowerCase());\n                style = this.setFormat(style, cFRule);\n            }\n            else {\n                style = formatStyle;\n            }\n            if (style.backgroundColor) {\n                td.style.setProperty('background-color', style.backgroundColor);\n            }\n            if (style.color) {\n                td.style.setProperty('color', style.color);\n            }\n            if (style.fontWeight) {\n                td.style.setProperty('font-weight', style.fontWeight);\n            }\n            if (style.fontStyle) {\n                td.style.setProperty('font-style', style.fontStyle);\n            }\n            if (style.textDecoration) {\n                td.style.setProperty('text-decoration', style.textDecoration);\n            }\n        }\n    };\n    ConditionalFormatting.prototype.checkConditionalFormatHandler = function (args) {\n        var indexes;\n        var isApply = false;\n        var result = false;\n        var sheet = this.parent.getActiveSheet();\n        var cell = args.cell;\n        var td;\n        var cFRules = sheet.conditionalFormats;\n        var mainCnt = this.parent.getMainContent();\n        var value = !cell ? '' : !isNullOrUndefined(cell.value) ? cell.value : '';\n        var cFColors = ['e-redft', 'e-yellowft', 'e-greenft', 'e-redf', 'e-redt'];\n        var cFRIdx;\n        td = this.parent.getCell(args.rowIdx, args.colIdx);\n        if (!cFRules || cFRules.length < 1) {\n            return;\n        }\n        for (var cFRuleIdx = 0; cFRuleIdx < cFRules.length; cFRuleIdx++) {\n            var cFRanges = cFRules[cFRuleIdx].range.trim().split(',');\n            for (var rangeIdx = 0; rangeIdx < cFRanges.length; rangeIdx++) {\n                var range = cFRanges[rangeIdx];\n                range = range.indexOf(':') > -1 ? range : range + ':' + range;\n                indexes = getRangeIndexes(range);\n                if (args.rowIdx >= indexes[0] && args.colIdx >= indexes[1] && args.rowIdx <= indexes[2] && args.colIdx <= indexes[3]) {\n                    cFRIdx = cFRuleIdx;\n                    result = true;\n                    break;\n                }\n            }\n            if (result) {\n                if (('GreaterThan' + 'LessThan' + 'EqualTo' + 'Between' + 'ContainsText' +\n                    'DateOccur').includes(sheet.conditionalFormats[cFRuleIdx].type)) {\n                    var cellVal = getCell(args.rowIdx, args.colIdx, sheet) && getCell(args.rowIdx, args.colIdx, sheet).value ?\n                        getCell(args.rowIdx, args.colIdx, sheet).value : '';\n                    if (isNullOrUndefined(cellVal) && cellVal === '') {\n                        isApply = false;\n                    }\n                    else {\n                        isApply = this.cFRCheck(sheet.conditionalFormats[cFRuleIdx], cellVal, td);\n                    }\n                    this.setColor(td, args.rowIdx, args.colIdx, cFRuleIdx, isApply);\n                }\n                else if (('Top10Items' + 'Bottom10Items' + 'Top10%' + 'Bottom10%' + 'AboveAverage' +\n                    'BelowAverage' + 'Duplicate' + 'Unique').includes(sheet.conditionalFormats[cFRuleIdx].type)) {\n                    for (var rangeIdx = 0; rangeIdx < cFRanges.length; rangeIdx++) {\n                        var range = cFRanges[rangeIdx];\n                        range = range.indexOf(':') > -1 ? range : range + ':' + range;\n                        indexes = getRangeIndexes(range);\n                        for (var rIdx = indexes[0]; rIdx <= indexes[2]; rIdx++) {\n                            if (!sheet.rows[rIdx]) {\n                                setRow(sheet, rIdx, {});\n                            }\n                            for (var cIdx = indexes[1]; cIdx <= indexes[3]; cIdx++) {\n                                if (!sheet.rows[rIdx].cells || !sheet.rows[rIdx].cells[cIdx]) {\n                                    setCell(rIdx, cIdx, sheet, {});\n                                }\n                                var cellVal = getCell(rIdx, cIdx, sheet) && getCell(rIdx, cIdx, sheet).value ?\n                                    getCell(rIdx, cIdx, sheet).value : '';\n                                isApply = this.cFRCheck(sheet.conditionalFormats[cFRuleIdx], cellVal, td, rIdx, cIdx, false);\n                                td = this.parent.getCell(rIdx, cIdx);\n                                this.setColor(td, rIdx, cIdx, cFRuleIdx, isApply);\n                            }\n                        }\n                    }\n                }\n                else if (('BlueDataBar' + 'GreenDataBar' + 'RedDataBar' + 'OrangeDataBar' + 'LightBlueDataBar' + 'PurpleColorScale' +\n                    'GYRColorScale' + 'RYGColorScale' + 'GWRColorScale' + 'RWGColorScale' + 'BWRColorScale' + 'RWBColorScale' +\n                    'WRColorScale' + 'RWColorScale' + 'GWColorScale' + 'WGColorScale' + 'GYColorScale' + 'YGColorScale' + 'ThreeArrows' +\n                    'ThreeArrowsGray' + 'FourArrowsGray' + 'FourArrows' + 'FiveArrowsGray' + 'FiveArrows' + 'ThreeTrafficLights1' +\n                    'ThreeTrafficLights2' + 'ThreeSigns' + 'FourTrafficLights' + 'FourRedToBlack' + 'ThreeSymbols' + 'ThreeSymbols2' +\n                    'ThreeFlags' + 'FourRating' + 'FiveQuarters' + 'FiveRating' + 'ThreeTriangles' + 'ThreeStars' + 'FiveBoxes').\n                    includes(sheet.conditionalFormats[cFRuleIdx].type)) {\n                    for (var idx = 0; idx < cFColors.length; idx++) {\n                        if (td.classList.contains(cFColors[idx])) {\n                            td.classList.remove(cFColors[idx]);\n                        }\n                    }\n                    isApply = this.cFRCheck(sheet.conditionalFormats[cFRuleIdx], value, td, args.rowIdx, args.colIdx, false);\n                }\n                result = false;\n            }\n        }\n    };\n    ConditionalFormatting.prototype.setColor = function (td, rIdx, cIdx, cFRuleIdx, isApply) {\n        var sheet = this.parent.getActiveSheet();\n        var cFRules = sheet.conditionalFormats;\n        var cFColors = ['e-redft', 'e-yellowft', 'e-greenft', 'e-redf', 'e-redt'];\n        var isActiveCF = false;\n        if (cFRules[cFRuleIdx].cFColor) {\n            if (td && td.classList.contains('e-' + cFRules[cFRuleIdx].cFColor.toLowerCase())) {\n                isActiveCF = true;\n            }\n        }\n        else if (cFRules[cFRuleIdx].format.style.backgroundColor && td.style.backgroundColor) {\n            var rgb = this.hexToRgb(cFRules[cFRuleIdx].format.style.backgroundColor);\n            if ('rgb(' + rgb.r + ', ' + rgb.g + ', ' + rgb.b + ')' === td.style.backgroundColor) {\n                isActiveCF = true;\n            }\n        }\n        if (isApply) {\n            if (isActiveCF) {\n                for (var idx = 0; idx < cFColors.length; idx++) {\n                    if (td.classList.contains(cFColors[idx])) {\n                        td.classList.remove(cFColors[idx]);\n                        break;\n                    }\n                }\n            }\n            var style = {};\n            if (cFRules[cFRuleIdx].cFColor) {\n                td.classList.add('e-' + cFRules[cFRuleIdx].cFColor.toLowerCase());\n                style = this.setFormat(style, cFRules[cFRuleIdx]);\n            }\n            else {\n                style = cFRules[cFRuleIdx].format.style;\n            }\n            this.parent.notify(applyCellFormat, {\n                style: style, rowIdx: rIdx, colIdx: cIdx,\n                lastCell: true, isHeightCheckNeeded: true, manualUpdate: true\n            });\n        }\n        else {\n            if (isActiveCF) {\n                for (var idx = 0; idx < cFColors.length; idx++) {\n                    if (td.classList.contains(cFColors[idx])) {\n                        td.classList.remove(cFColors[idx]);\n                        break;\n                    }\n                }\n                td.removeAttribute('style');\n            }\n            var cell = getCell(rIdx, cIdx, this.parent.getActiveSheet());\n            var style = cell.style ? cell.style : {};\n            this.parent.notify(applyCellFormat, {\n                style: style, rowIdx: rIdx, colIdx: cIdx\n            });\n        }\n    };\n    ConditionalFormatting.prototype.hexToRgb = function (hex) {\n        var result = /^#?([a-f\\d]{2})([a-f\\d]{2})([a-f\\d]{2})$/i.exec(hex);\n        return result ? {\n            r: parseInt(result[1], 16),\n            g: parseInt(result[2], 16),\n            b: parseInt(result[3], 16)\n        } : null;\n    };\n    // tslint:disable-next-line:max-func-body-length\n    ConditionalFormatting.prototype.cFRCheck = function (cFRule, value, td, rIdx, cIdx, isInitial) {\n        var cFRuleValue1 = '';\n        var cFRuleValue2 = '';\n        var cellValue = value.toString();\n        if (cFRule.value) {\n            var valueArr = cFRule.value.split(',');\n            if (valueArr.length > 1) {\n                if (valueArr[0].split('(').length > 1) {\n                    var valueStr = '';\n                    for (var idx = 0; idx < valueArr.length; idx++) {\n                        valueStr += valueArr[idx] + ',';\n                        if (valueStr.split('(').length === valueStr.split(')').length && cFRuleValue1 === '') {\n                            cFRuleValue1 = valueStr.substring(0, valueStr.length - 1);\n                            valueStr = '';\n                        }\n                    }\n                    cFRuleValue2 = valueStr.substring(0, valueStr.length - 1);\n                }\n                else {\n                    cFRuleValue1 = valueArr[0];\n                    for (var idx = 1; idx < valueArr.length; idx++) {\n                        cFRuleValue2 += idx + 1 === valueArr.length ? valueArr[idx] : valueArr[idx] + ',';\n                    }\n                }\n            }\n            else {\n                cFRuleValue1 = cFRule.value;\n            }\n        }\n        var isApply = false;\n        var type = cFRule.type;\n        if (('BlueDataBar' + 'GreenDataBar' + 'RedDataBar' + 'OrangeDataBar' + 'LightBlueDataBar' + 'PurpleDataBar').includes(type)) {\n            type = 'DataBar';\n        }\n        if (('GYRColorScale' + 'RYGColorScale' + 'GWRColorScale' + 'RWGColorScale' + 'BWRColorScale' + 'RWBColorScale' + 'WRColorScale' +\n            'RWColorScale' + 'GWColorScale' + 'WGColorScale' + 'GYColorScale' + 'YGColorScale').includes(type)) {\n            type = 'ColorScale';\n        }\n        if (('ThreeArrows' + 'ThreeArrowsGray' + 'FourArrowsGray' + 'FourArrows' + 'FiveArrowsGray' +\n            'FiveArrows' + 'ThreeTrafficLights1' + 'ThreeTrafficLights2' + 'ThreeSigns' + 'FourTrafficLights' +\n            'FourRedToBlack' + 'ThreeSymbols' + 'ThreeSymbols2' + 'ThreeFlags' + 'FourRating' + 'FiveQuarters' +\n            'FiveRating' + 'ThreeTriangles' + 'ThreeStars' + 'FiveBoxes').includes(type)) {\n            type = 'IconSet';\n        }\n        switch (type) {\n            case 'GreaterThan':\n                isApply = this.isGreaterThanLessThan(cFRule, cellValue, cFRuleValue1, true);\n                break;\n            case 'LessThan':\n                isApply = this.isGreaterThanLessThan(cFRule, cellValue, cFRuleValue1, false);\n                break;\n            case 'Between':\n                isApply = this.isBetWeen(cFRule, cellValue, cFRuleValue1, cFRuleValue2);\n                break;\n            case 'EqualTo':\n                isApply = this.isEqualTo(cFRule, cellValue, cFRuleValue1);\n                break;\n            case 'ContainsText':\n                isApply = this.isContainsText(cellValue, cFRuleValue1);\n                break;\n            case 'DateOccur':\n                var dateEventArgs = {\n                    value: cFRuleValue1,\n                    rowIndex: 0,\n                    colIndex: 0,\n                    sheetIndex: 0,\n                    updatedVal: ''\n                };\n                this.parent.notify(checkDateFormat, dateEventArgs);\n                if (cellValue === dateEventArgs.updatedVal) {\n                    isApply = true;\n                }\n                break;\n            case 'Unique':\n            case 'Duplicate':\n                isApply = this.isDuplicateUnique(cellValue, cFRule, false);\n                break;\n            case 'Top10Items':\n                isApply = this.isTopBottomTenValue(cellValue, cFRuleValue1, cFRule, true);\n                break;\n            case 'Bottom10Items':\n                isApply = this.isTopBottomTenValue(cellValue, cFRuleValue1, cFRule, false);\n                break;\n            case 'Top10Percentage':\n                isApply = this.isTopBottomTenPercentage(cellValue, cFRuleValue1, cFRule, true);\n                break;\n            case 'Bottom10Percentage':\n                isApply = this.isTopBottomTenPercentage(cellValue, cFRuleValue1, cFRule, false);\n                break;\n            case 'AboveAverage':\n                isApply = this.isAboveBelowAverage(cellValue, cFRuleValue1, cFRule, true);\n                break;\n            case 'BelowAverage':\n                isApply = this.isAboveBelowAverage(cellValue, cFRuleValue1, cFRule, false);\n                break;\n            case 'DataBar':\n                this.isDataBarColorScalesIconSets(type, cellValue, cFRule, td, rIdx, cIdx, isInitial);\n                break;\n            case 'ColorScale':\n                this.isDataBarColorScalesIconSets(type, cellValue, cFRule, td, rIdx, cIdx, isInitial);\n                break;\n            case 'IconSet':\n                this.isDataBarColorScalesIconSets(type, cellValue, cFRule, td, rIdx, cIdx, isInitial);\n                break;\n        }\n        return isApply;\n    };\n    ConditionalFormatting.prototype.isDataBarColorScalesIconSets = function (type, cellValue, cFRule, td, rIdx, cIdx, isInitial) {\n        var sheet = this.parent.getActiveSheet();\n        if (isInitial) {\n            type === 'DataBar' ? this.applyDataBars(cellValue, cFRule, td, rIdx, cIdx) : type === 'ColorScale' ?\n                this.applyColorScale(cellValue, cFRule, td, rIdx, cIdx, isInitial) :\n                this.applyIconSet(cellValue, cFRule, td, rIdx, cIdx, isInitial);\n        }\n        else {\n            td = null;\n            var rangeArr = cFRule.range.split(',');\n            for (var rangeIdx = 0; rangeIdx < rangeArr.length; rangeIdx++) {\n                var selIndexes = getRangeIndexes(rangeArr[rangeIdx]);\n                for (var rIdx_1 = selIndexes[0]; rIdx_1 <= selIndexes[2]; rIdx_1++) {\n                    for (var cIdx_1 = selIndexes[1]; cIdx_1 <= selIndexes[3]; cIdx_1++) {\n                        if (getCell(rIdx_1, cIdx_1, sheet)) {\n                            var cellVal = getCell(rIdx_1, cIdx_1, sheet).value;\n                            td = this.parent.getCell(rIdx_1, cIdx_1);\n                            type === 'DataBar' ? this.applyDataBars(cellVal, cFRule, td, rIdx_1, cIdx_1) :\n                                type === 'ColorScale' ?\n                                    this.applyColorScale(cellVal, cFRule, td, rIdx_1, cIdx_1, isInitial) :\n                                    this.applyIconSet(cellVal, cFRule, td, rIdx_1, cIdx_1, isInitial);\n                        }\n                    }\n                }\n            }\n        }\n    };\n    ConditionalFormatting.prototype.applyIconSet = function (val, cFRule, tdEle, rIdx, cIdx, isInitial) {\n        var value = parseInt(val, 10);\n        var rowIdx;\n        var colIdx;\n        var iconList = this.getIconList(cFRule.type).split(',');\n        var min;\n        var max;\n        var valArr = [];\n        var sheet = this.parent.getActiveSheet();\n        var actCell = sheet.rows[rIdx] && sheet.rows[rIdx].cells[cIdx] ? sheet.rows[rIdx].cells[cIdx] : null;\n        if (!actCell) {\n            return;\n        }\n        var td = tdEle ||\n            this.parent.getMainContent().getElementsByClassName('e-row')[rIdx].getElementsByClassName('e-cell')[cIdx];\n        var rangeArr = cFRule.range.split(',');\n        for (var rIdx_2 = 0; rIdx_2 < rangeArr.length; rIdx_2++) {\n            var selIndexes = getRangeIndexes(rangeArr[rIdx_2]);\n            valArr = this.getNumericArray(selIndexes, valArr);\n        }\n        valArr = valArr.sort(function (n1, n2) { return n1 - n2; });\n        min = valArr[0];\n        max = valArr[valArr.length - 1];\n        var currentSymbol;\n        if (iconList.length === 3) {\n            var maxPercent = min + (0.67 * ((max) - (min)));\n            var minPercent = min + (0.33 * ((max) - (min)));\n            currentSymbol =\n                'e-' + (value >= maxPercent ? iconList[0].trim() : value >= minPercent ? iconList[1].trim() : iconList[2].trim());\n        }\n        else if (iconList.length === 4) {\n            var percent1 = min + (0.25 * ((max) - (min)));\n            var percent2 = min + (0.50 * ((max) - (min)));\n            var percent3 = min + (0.75 * ((max) - (min)));\n            currentSymbol =\n                'e-' + (value >= percent3 ? iconList[0].trim() : value >= percent2 ? iconList[1].trim() : value >= percent1 ?\n                    iconList[2].trim() : iconList[3].trim());\n        }\n        else if (iconList.length === 5) {\n            var percent1 = min + (0.20 * ((max) - (min)));\n            var percent2 = min + (0.40 * ((max) - (min)));\n            var percent3 = min + (0.60 * ((max) - (min)));\n            var percent4 = min + (0.80 * ((max) - (min)));\n            currentSymbol =\n                'e-' + (value >= percent4 ? iconList[0].trim() : value >= percent3 ? iconList[1].trim() : value >= percent2 ?\n                    iconList[2].trim() : value >= percent1 ? iconList[3].trim() : iconList[4].trim());\n        }\n        if (!isNullOrUndefined(actCell)) {\n            var cfIcon = this.parent.createElement('span', { className: 'e-icon' });\n            cfIcon.classList.add('e-iconsetspan');\n            cfIcon.classList.add(currentSymbol);\n            this.applyIconSetIcon({ rowIndex: rIdx, colIndex: cIdx }, cfIcon, td);\n        }\n    };\n    ConditionalFormatting.prototype.applyIconSetIcon = function (activeObj, cfIcon, td) {\n        var sheet = this.parent.getActiveSheet();\n        var rowIdx = activeObj.rowIndex;\n        var colIdx = activeObj.colIndex;\n        var cellVal = getCell(rowIdx, colIdx, sheet).value;\n        var activeEle = td;\n        var sheetIdx = sheet.index;\n        if (activeEle.classList.contains('e-iconset') && activeEle.querySelector('.e-iconsetspan')) {\n            activeEle.removeChild(activeEle.querySelector('.e-iconsetspan'));\n        }\n        if (isNumber(cellVal)) {\n            activeEle.insertBefore(cfIcon, activeEle.childNodes[0]);\n            activeEle.classList.add('e-iconset');\n        }\n    };\n    ConditionalFormatting.prototype.getIconList = function (iconName) {\n        var result = '3arrows-1,3arrows-2,3arrows-3';\n        switch (iconName) {\n            case 'ThreeArrows':\n                return '3arrows-1,3arrows-2,3arrows-3';\n            case 'ThreeArrowsGray':\n                return '3arrowsgray-1,3arrowsgray-2,3arrowsgray-3';\n            case 'FourArrowsGray':\n                return '4arrowsgray-1,4arrowsgray-2,4arrowsgray-3,4arrowsgray-4';\n            case 'FourArrows':\n                return '4arrows-1,4arrows-2,4arrows-3,4arrows-4';\n            case 'FiveArrowsGray':\n                return '5arrowsgray-1,5arrowsgray-2,5arrowsgray-3,5arrowsgray-4,5arrowsgray-5';\n            case 'FiveArrows':\n                return '5arrows-1,5arrows-2,5arrows-3,5arrows-4,5arrows-5';\n            case 'ThreeTrafficLights1':\n                return '3trafficlights-1,3trafficlights-2,3trafficlights-3';\n            case 'ThreeTrafficLights2':\n                return '3rafficlights2-1,3rafficlights2-2,3rafficlights2-3';\n            case 'ThreeSigns':\n                return '3signs-1,3signs-2,3signs-3';\n            case 'FourTrafficLights':\n                return '4trafficlights-1,4trafficlights-2,4trafficlights-3,4trafficlights-4';\n            case 'FourRedToBlack':\n                return '4redtoblack-1,4redtoblack-2,4redtoblack-3,4redtoblack-4';\n            case 'ThreeSymbols':\n                return '3symbols-1,3symbols-2,3symbols-3';\n            case 'ThreeSymbols2':\n                return '3symbols2-1,3symbols2-2,3symbols2-3';\n            case 'ThreeFlags':\n                return '3flags-1,3flags-2,3flags-3';\n            case 'FourRating':\n                return '4rating-1,4rating-2,4rating-3,4rating-4';\n            case 'FiveQuarters':\n                return '5quarters-1,5quarters-2,5quarters-3,5quarters-4,5quarters-5';\n            case 'FiveRating':\n                return '5rating-1,5rating-2,5rating-3,5rating-4,5rating-5';\n            case 'ThreeTriangles':\n                return '3triangles-1,3triangles-2,3triangles-3';\n            case 'ThreeStars':\n                return '3stars-1,3stars-2,3stars-3';\n            case 'FiveBoxes':\n                return '5boxes-1,5boxes-2,5boxes-3,5boxes-4,5boxes-5';\n        }\n        return result;\n    };\n    ConditionalFormatting.prototype.applyColorScale = function (val, cFRule, tdEle, rIdx, cIdx, isInitial) {\n        var sheet = this.parent.getActiveSheet();\n        var value = parseInt(val, 10);\n        var rowIdx;\n        var colIdx;\n        var id;\n        var valArr = [];\n        var colors = this.getColor(cFRule.type);\n        var actCell = sheet.rows[rIdx] && sheet.rows[rIdx].cells[cIdx] ? sheet.rows[rIdx].cells[cIdx] : null;\n        if (!actCell) {\n            return;\n        }\n        var rangeArr = cFRule.range.split(',');\n        var td = tdEle ||\n            this.parent.getMainContent().getElementsByClassName('e-row')[rIdx].getElementsByClassName('e-cell')[cIdx];\n        for (var rIdx_3 = 0; rIdx_3 < rangeArr.length; rIdx_3++) {\n            var selIndexes = getRangeIndexes(rangeArr[rIdx_3]);\n            valArr = this.getNumericArray(selIndexes, valArr);\n        }\n        valArr = valArr.sort(function (n1, n2) { return n1 - n2; }).reverse();\n        for (var i = 0; i < valArr.length; i++) {\n            if (valArr[i] === value) {\n                id = i;\n                break;\n            }\n        }\n        var hexcode = (id === 0) ? colors[0] : (id === valArr.length - 1) ? colors[colors.length - 1] :\n            (valArr.length === 3 && id === 1) ? colors[1] : this.getGradient(id, colors[0], colors[1], colors[2], valArr.length);\n        if (!isNullOrUndefined(actCell)) {\n            var style = {};\n            if (!isNullOrUndefined(id)) {\n                style = { backgroundColor: hexcode };\n                td.style.backgroundColor = hexcode;\n            }\n            else {\n                style = this.parent.getCellStyleValue(['backgroundColor'], [rIdx, cIdx]);\n                td.style.backgroundColor = style.backgroundColor;\n            }\n        }\n    };\n    // tslint:disable-next-line:max-func-body-length\n    ConditionalFormatting.prototype.applyDataBars = function (val, cFRule, tdEle, rIdx, cIdx) {\n        var value;\n        var rowIdx;\n        var colIdx;\n        var sheet = this.parent.getActiveSheet();\n        var left = {};\n        var right = {};\n        var posColor = '';\n        var negColor = '';\n        var cFColor = cFRule.type;\n        var actCell = sheet.rows[rIdx] && sheet.rows[rIdx].cells[cIdx] ? sheet.rows[rIdx].cells[cIdx] : null;\n        if (!actCell) {\n            return;\n        }\n        var valArr = [];\n        var row = this.parent.getMainContent().getElementsByClassName('e-row')[rIdx];\n        var td = tdEle ||\n            this.parent.getMainContent().getElementsByClassName('e-row')[rIdx].getElementsByClassName('e-cell')[cIdx];\n        var rowHeight = !row ? 20 : row.style ? parseInt(row.style.height, 10) : 20;\n        var posArr = [];\n        var negArr = [];\n        var topVal;\n        var leftStandardWidth = 0;\n        value = parseInt(val, 10);\n        var rangeArr = cFRule.range.split(',');\n        for (var rIdx_4 = 0; rIdx_4 < rangeArr.length; rIdx_4++) {\n            var selIndexes = getRangeIndexes(rangeArr[rIdx_4]);\n            valArr = this.getNumericArray(selIndexes, valArr);\n        }\n        for (var idx = 0; idx < valArr.length; idx++) {\n            valArr[idx] > 0 ? posArr.push(valArr[idx]) : negArr.push(valArr[idx]);\n        }\n        cFColor = cFColor === 'BlueDataBar' ? 'B' : cFColor === 'GreenDataBar' ? 'G' : cFColor === 'RedDataBar' ? 'R' :\n            cFColor === 'OrangeDataBar' ? 'O' : cFColor === 'LightBlueDataBar' ? 'LB' : cFColor === 'PurpleDataBar' ? 'P' : '';\n        posColor = this.getColor(cFColor)[0];\n        negColor = this.getColor('R')[0];\n        posArr = posArr.sort(function (n1, n2) { return n1 - n2; }).reverse();\n        negArr = negArr.sort(function (n1, n2) { return n1 - n2; });\n        if (negArr.length && posArr.length) {\n            topVal = posArr[0] + Math.abs(negArr[0]);\n            leftStandardWidth = (Math.abs((negArr[0] / topVal) * 100));\n        }\n        else if (negArr.length || posArr.length) {\n            topVal = negArr.length ? negArr[0] : posArr[0];\n        }\n        else {\n            return;\n        }\n        if (td) {\n            if (isNullOrUndefined(value) || val === '') {\n                if (td.getElementsByClassName('e-cf-databar')[0]) {\n                    td.removeChild(td.getElementsByClassName('e-cf-databar')[0]);\n                }\n            }\n        }\n        if (isNumber(value)) {\n            var databar = this.parent.createElement('div', { id: 'spreadsheet-databar', className: 'e-cf-databar' });\n            var leftSpan = this.parent.createElement('span', { id: 'spreadsheet-leftspan', className: 'e-databar' });\n            var rightSpan = this.parent.createElement('span', { id: 'spreadsheet-rightspan', className: 'e-databar' });\n            var dataSpan = this.parent.createElement('span', { id: 'spreadsheet-dataspan', className: 'e-databar-value' });\n            var iconSetSpan = void 0;\n            left = leftSpan.style;\n            right = rightSpan.style;\n            databar.appendChild(dataSpan);\n            databar.insertBefore(rightSpan, dataSpan);\n            databar.insertBefore(leftSpan, rightSpan);\n            if (td.querySelector('.e-iconsetspan')) {\n                iconSetSpan = td.querySelector('.e-iconsetspan');\n            }\n            td.textContent = '';\n            td.appendChild(databar);\n            if (iconSetSpan) {\n                td.insertBefore(iconSetSpan, td.firstElementChild);\n            }\n            dataSpan.innerHTML = this.parent.getDisplayText(actCell);\n            databar.style.height = rowHeight - 1 + 'px';\n            dataSpan.style.fontSize = '11pt';\n            if (!negArr.length) {\n                right.width = '' + Math.ceil(Math.abs((value / topVal) * 100)) + '%';\n                right.height = rowHeight - 3 + 'px';\n                right.backgroundColor = cFColor = posColor;\n                right.left = '0px';\n            }\n            else if (!posArr.length) {\n                right.width = '' + Math.ceil(Math.abs((value / topVal) * 100)) + '%';\n                right.height = rowHeight - 3 + 'px';\n                right.backgroundColor = cFColor = negColor;\n                right.left = '0px';\n            }\n            else {\n                if (value > -1) {\n                    left.width = leftStandardWidth + '%';\n                    left.height = rowHeight - 3 + 'px'; // -3 buffer of data bar.\n                    left.backgroundColor = 'transparent';\n                    left.left = '0px';\n                    right.width = '' + Math.ceil(Math.abs((value / topVal) * 100)) + '%';\n                    right.height = rowHeight - 3 + 'px';\n                    right.backgroundColor = cFColor = posColor;\n                    right.left = leftStandardWidth + '%';\n                }\n                else if (value < 0) {\n                    left.width = '' + Math.ceil(Math.abs((value / topVal) * 100)) + '%';\n                    left.height = rowHeight - 3 + 'px';\n                    left.backgroundColor = negColor;\n                    if (left.width === leftStandardWidth + '%') {\n                        left.left = '0px';\n                    }\n                    else {\n                        left.right = (100 - leftStandardWidth) + '%';\n                    }\n                }\n            }\n        }\n    };\n    ConditionalFormatting.prototype.getNumericArray = function (selIndexes, valArr) {\n        var sheet = this.parent.getActiveSheet();\n        for (var rIdx = selIndexes[0]; rIdx <= selIndexes[2]; rIdx++) {\n            for (var cIdx = selIndexes[1]; cIdx <= selIndexes[3]; cIdx++) {\n                var cellVal = getCell(rIdx, cIdx, sheet) && getCell(rIdx, cIdx, sheet).value ? getCell(rIdx, cIdx, sheet).value : '';\n                if (!isNullOrUndefined(cellVal) && !isNumber(cellVal) && !isDateTime(cellVal)) {\n                    continue;\n                }\n                else {\n                    var cellValue = parseInt(cellVal, 10);\n                    if (!isNullOrUndefined(cellVal) && cellVal !== '') {\n                        valArr.push(cellValue);\n                    }\n                }\n            }\n        }\n        return valArr;\n    };\n    ConditionalFormatting.prototype.getColor = function (cfColor) {\n        if (cfColor === 'LB') {\n            return ['#008aef'];\n        }\n        var colorCodeArr = cfColor.split('');\n        var colorArr = [];\n        for (var i = 0; i < colorCodeArr.length; i++) {\n            switch (colorCodeArr[i]) {\n                case 'G':\n                    colorArr.push('#63be7b');\n                    break;\n                case 'Y':\n                    colorArr.push('#ffeb84');\n                    break;\n                case 'R':\n                    colorArr.push('#f8696b');\n                    break;\n                case 'W':\n                    colorArr.push('#ffffff');\n                    break;\n                case 'B':\n                    colorArr.push('#5a8ac6');\n                    break;\n                case 'O':\n                    colorArr.push('#ffb628');\n                    break;\n                case 'LB':\n                    colorArr.push('#008aef');\n                    break;\n                case 'P':\n                    colorArr.push('#d6007b');\n                    break;\n            }\n        }\n        return colorArr;\n    };\n    ConditionalFormatting.prototype.getGradient = function (t, start, middle, end, large) {\n        if (isNullOrUndefined(end)) {\n            return this.getLinear(start, middle, t / large);\n        }\n        else {\n            var center = large / 2;\n            return t >= center ? this.getLinear(middle, end, Math.abs((t - center) / center)) : this.getLinear(start, middle, t / center);\n        }\n    };\n    ConditionalFormatting.prototype.getLinear = function (s, e, x) {\n        var r = this.byteLinear(s[1] + s[2], e[1] + e[2], x);\n        var g = this.byteLinear(s[3] + s[4], e[3] + e[4], x);\n        var b = this.byteLinear(s[5] + s[6], e[5] + e[6], x);\n        return '#' + r + g + b;\n    };\n    ConditionalFormatting.prototype.byteLinear = function (a, b, x) {\n        var y = (parseInt(a, 16) * (1 - x) + parseInt(b, 16) * x) | 0;\n        return Math.abs(y).toString(16);\n    };\n    ConditionalFormatting.prototype.isGreaterThanLessThan = function (cFRule, value, input, isGrearThan) {\n        var numRegx = new RegExp(/[^.0-9]+/g);\n        var txtRegx = new RegExp(/[^.-a-zA-Z 0-9]+/g);\n        var isApply = false;\n        if (isNumber(value)) {\n            if (isNumber(input)) {\n                isApply = isGrearThan ? parseFloat(value) > parseFloat(input.replace(txtRegx, '')) :\n                    parseFloat(value) < parseFloat(input.replace(txtRegx, ''));\n            }\n            else {\n                var dateEventArgs = {\n                    value: input,\n                    rowIndex: 0,\n                    colIndex: 0,\n                    sheetIndex: 0,\n                    isDate: false,\n                    updatedVal: '',\n                    isTime: false\n                };\n                this.parent.notify(checkDateFormat, dateEventArgs);\n                if (dateEventArgs.isDate || dateEventArgs.isTime) {\n                    isApply = isGrearThan ? value > dateEventArgs.updatedVal : value < dateEventArgs.updatedVal;\n                    cFRule.value = dateEventArgs.updatedVal.toString();\n                }\n                else {\n                    isApply = isGrearThan ? value.toLowerCase() > input.toLowerCase() : value.toLowerCase() < input.toLowerCase();\n                }\n            }\n        }\n        else if (value === '' && !isGrearThan) {\n            isApply = true;\n        }\n        return isApply;\n    };\n    ConditionalFormatting.prototype.isBetWeen = function (cFRule, value, input1, input2) {\n        var numRegx = new RegExp(/[^.0-9]+/g);\n        var txtRegx = new RegExp(/[^.-a-zA-Z 0-9]+/g);\n        var isApply = false;\n        input1 = input1.replace(txtRegx, '');\n        input2 = input2.replace(txtRegx, '');\n        if (isNumber(value)) {\n            if (isNumber(input1)) {\n                isApply = parseFloat(value) >= parseFloat(input1) && parseFloat(value) <= parseFloat(input2);\n            }\n            else {\n                if (input1 && input2) {\n                    var dateEventArgs1 = {\n                        value: input1,\n                        rowIndex: 0,\n                        colIndex: 0,\n                        sheetIndex: 0,\n                        isDate: false,\n                        updatedVal: '',\n                        isTime: false\n                    };\n                    var dateEventArgs2 = {\n                        value: input2,\n                        rowIndex: 0,\n                        colIndex: 0,\n                        sheetIndex: 0,\n                        isDate: false,\n                        updatedVal: '',\n                        isTime: false\n                    };\n                    this.parent.notify(checkDateFormat, dateEventArgs1);\n                    this.parent.notify(checkDateFormat, dateEventArgs2);\n                    if ((dateEventArgs1.isDate || dateEventArgs1.isTime) && (dateEventArgs2.isDate || dateEventArgs2.isTime)) {\n                        isApply = value >= dateEventArgs1.updatedVal && value <= dateEventArgs2.updatedVal;\n                        cFRule.value = dateEventArgs1.updatedVal.toString() + ',' + dateEventArgs2.updatedVal.toString();\n                    }\n                    else {\n                        isApply = value.toLowerCase() >= input1.toLowerCase() && value.toLowerCase() <= input2.toLowerCase();\n                    }\n                }\n            }\n        }\n        return isApply;\n    };\n    ConditionalFormatting.prototype.isEqualTo = function (cFRule, value, input) {\n        var numRegx = new RegExp(/[^.0-9]+/g);\n        var txtRegx = new RegExp(/[^.-a-zA-Z 0-9]+/g);\n        var isApply = false;\n        if (isNumber(value)) {\n            if (isNumber(input)) {\n                isApply = parseFloat(value) === parseFloat(input.replace(txtRegx, ''));\n            }\n            else {\n                var dateTimeArgs = {\n                    value: input,\n                    rowIndex: 0,\n                    colIndex: 0,\n                    sheetIndex: 0,\n                    isDate: false,\n                    updatedVal: '',\n                    isTime: false\n                };\n                this.parent.notify(checkDateFormat, dateTimeArgs);\n                if (dateTimeArgs.isTime || dateTimeArgs.isDate) {\n                    isApply = value === dateTimeArgs.updatedVal;\n                    cFRule.value = dateTimeArgs.updatedVal.toString();\n                }\n                else {\n                    isApply = value.toLowerCase() === input.toLowerCase();\n                }\n            }\n        }\n        return isApply;\n    };\n    ConditionalFormatting.prototype.isContainsText = function (value, input) {\n        var numRegx = new RegExp(/[^.0-9]+/g);\n        var txtRegx = new RegExp(/[^.-a-zA-Z 0-9]+/g);\n        var isApply = false;\n        if (isNullOrUndefined(value) || !value.length) {\n            isApply = false;\n        }\n        else if (isNumber(input.replace(txtRegx, ''))) {\n            input = input.replace(txtRegx, '');\n            if (isDateTime(value)) {\n                value = ((dateToInt(value))).toString();\n            }\n            isApply = value.indexOf(input) > -1;\n        }\n        else if (isDateTime(input)) {\n            if (isDateTime(value)) {\n                value = dateToInt(value).toString();\n            }\n            isApply = value.indexOf(dateToInt(input).toString()) > -1;\n        }\n        else {\n            isApply = value.toLowerCase().indexOf(input.toLowerCase()) > -1;\n        }\n        return isApply;\n    };\n    ConditionalFormatting.prototype.isTopBottomTenValue = function (cellValue, inp, cFRule, isTop) {\n        var sheet = this.parent.getActiveSheet();\n        var numRegx = new RegExp(/[^.0-9]+/g);\n        var txtRegx = new RegExp(/[^.-a-zA-Z 0-9]+/g);\n        var value = parseInt(cellValue, 10);\n        var input = parseInt(inp, 10);\n        var result = false;\n        if (isNumber(inp)) {\n            if (isNumber(cellValue)) {\n                value = parseFloat(cellValue);\n                input = parseFloat(inp.replace(txtRegx, ''));\n            }\n            else if (isDateTime(cellValue)) {\n                value = dateToInt(cellValue);\n                input = parseFloat(inp);\n            }\n            var dataArray = [];\n            var cellVal = void 0;\n            var rangeArr = cFRule.range.split(',');\n            for (var rangeIdx = 0; rangeIdx < rangeArr.length; rangeIdx++) {\n                var cFRuleIndexes = getRangeIndexes(rangeArr[rangeIdx]);\n                for (var rowIdx = cFRuleIndexes[0]; rowIdx <= cFRuleIndexes[2]; rowIdx++) {\n                    for (var colIdx = cFRuleIndexes[1]; colIdx <= cFRuleIndexes[3]; colIdx++) {\n                        cellVal = getCell(rowIdx, colIdx, sheet) && getCell(rowIdx, colIdx, sheet).value ?\n                            getCell(rowIdx, colIdx, sheet).value : '';\n                        if (cellVal && isNumber(cellVal)) {\n                            cellVal = parseFloat(cellVal);\n                            dataArray.push(cellVal);\n                        }\n                    }\n                }\n            }\n            dataArray =\n                isTop ? dataArray.sort(function (n1, n2) { return n1 - n2; }).reverse() : dataArray.sort(function (n1, n2) { return n1 - n2; });\n            dataArray = dataArray.slice(0, input);\n            result = (dataArray.indexOf(value) > -1);\n        }\n        return result;\n    };\n    ConditionalFormatting.prototype.isTopBottomTenPercentage = function (val, inp, cFRule, isTop) {\n        var sheet = this.parent.getActiveSheet();\n        var numRegx = new RegExp(/[^.0-9]+/g);\n        var txtRegx = new RegExp(/[^.-a-zA-Z 0-9]+/g);\n        var value = parseInt(val, 10);\n        var input = parseInt(inp, 10);\n        var result = false;\n        if (isNumber(inp)) {\n            if (isNumber(val)) {\n                value = parseFloat(val);\n                input = parseFloat(inp.replace(txtRegx, ''));\n            }\n            else if (isDateTime(val)) {\n                value = dateToInt(val);\n                input = parseFloat(inp);\n            }\n            var dataArr = [];\n            var cellVal = void 0;\n            var diff = void 0;\n            var count = 0;\n            var considerCount = void 0;\n            var rangeArr = cFRule.range.split(',');\n            for (var rangeIdx = 0; rangeIdx < rangeArr.length; rangeIdx++) {\n                var cFRuleIndexes = getRangeIndexes(rangeArr[rangeIdx]);\n                for (var rIdx = cFRuleIndexes[0]; rIdx <= cFRuleIndexes[2]; rIdx++) {\n                    for (var cIdx = cFRuleIndexes[1]; cIdx <= cFRuleIndexes[3]; cIdx++) {\n                        cellVal = getCell(rIdx, cIdx, sheet) && getCell(rIdx, cIdx, sheet).value ? getCell(rIdx, cIdx, sheet).value : '';\n                        if (cellVal && isNumber(cellVal)) {\n                            cellVal = parseFloat(cellVal);\n                            dataArr.push(cellVal);\n                        }\n                        count++;\n                    }\n                }\n            }\n            diff = 100 / count;\n            considerCount = input / diff;\n            considerCount = Math.ceil(considerCount);\n            dataArr =\n                isTop ? dataArr.sort(function (n1, n2) { return n1 - n2; }).reverse() : dataArr.sort(function (n1, n2) { return n1 - n2; });\n            dataArr = dataArr.slice(0, considerCount ? considerCount : 1);\n            result = (dataArr.indexOf(value) > -1);\n        }\n        return result;\n    };\n    ConditionalFormatting.prototype.isAboveBelowAverage = function (val, inp, cFRule, isAbove) {\n        var sheet = this.parent.getActiveSheet();\n        var value = parseFloat(val);\n        var rangeColl = cFRule.range.split(',');\n        var result = false;\n        var dataArr = [];\n        var cellValue;\n        var average = 0;\n        for (var rangeIdx = 0; rangeIdx < rangeColl.length; rangeIdx++) {\n            var cFRuleIndexes = getRangeIndexes(rangeColl[rangeIdx]);\n            for (var rIdx = cFRuleIndexes[0]; rIdx <= cFRuleIndexes[2]; rIdx++) {\n                for (var cIdx = cFRuleIndexes[1]; cIdx <= cFRuleIndexes[3]; cIdx++) {\n                    cellValue = getCell(rIdx, cIdx, sheet) && getCell(rIdx, cIdx, sheet).value ? getCell(rIdx, cIdx, sheet).value : '';\n                    if (cellValue && isNumber(cellValue)) {\n                        cellValue = parseFloat(cellValue);\n                        dataArr.push(cellValue);\n                    }\n                }\n            }\n        }\n        for (var idx = 0; idx < dataArr.length; idx++) {\n            average += dataArr[idx];\n        }\n        average = average / dataArr.length;\n        result = isAbove ? (value > average) : (value < average);\n        return result;\n    };\n    ConditionalFormatting.prototype.isDuplicateUnique = function (val, cFRule, isAbove) {\n        var type = cFRule.type;\n        var count = 0;\n        var sheet = this.parent.getActiveSheet();\n        var value = val;\n        var rangeColl = cFRule.range.split(',');\n        var cellValue;\n        if (isNullOrUndefined(value) || value === '') {\n            return false;\n        }\n        for (var rIdx = 0; rIdx < rangeColl.length; rIdx++) {\n            var cFRuleIndexes = getRangeIndexes(rangeColl[rIdx]);\n            for (var rowIdx = cFRuleIndexes[0]; rowIdx <= cFRuleIndexes[2]; rowIdx++) {\n                for (var colIdx = cFRuleIndexes[1]; colIdx <= cFRuleIndexes[3]; colIdx++) {\n                    cellValue = getCell(rowIdx, colIdx, sheet) && getCell(rowIdx, colIdx, sheet).value ?\n                        getCell(rowIdx, colIdx, sheet).value.toString() : '';\n                    if (cellValue && cellValue !== '') {\n                        count = value.toLowerCase() === cellValue.toLowerCase() ? count + 1 : count;\n                        if (count === 2) {\n                            return type === 'Duplicate' ? true : false;\n                        }\n                    }\n                }\n            }\n        }\n        return type === 'Duplicate' ? false : true;\n    };\n    ConditionalFormatting.prototype.setFormat = function (style, cFRule) {\n        switch (cFRule.cFColor) {\n            case 'RedFT':\n                style.backgroundColor = '#ffc7ce';\n                style.color = '#9c0055';\n                break;\n            case 'YellowFT':\n                style.backgroundColor = '#ffeb9c';\n                style.color = '#9c6500';\n                break;\n            case 'GreenFT':\n                style.backgroundColor = '#c6efce';\n                style.color = '#006100';\n                break;\n            case 'RedF':\n                style.backgroundColor = '#ffc7ce';\n                break;\n            case 'RedT':\n                style.color = '#9c0055';\n                break;\n        }\n        return style;\n    };\n    /**\n     * Gets the module name.\n     * @returns string\n     */\n    ConditionalFormatting.prototype.getModuleName = function () {\n        return 'conditionalFormatting';\n    };\n    return ConditionalFormatting;\n}());\nexport { ConditionalFormatting };\n","var __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    }\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nvar __assign = (this && this.__assign) || function () {\n    __assign = Object.assign || function(t) {\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\n            s = arguments[i];\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\n                t[p] = s[p];\n        }\n        return t;\n    };\n    return __assign.apply(this, arguments);\n};\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nimport { Component, Property, NotifyPropertyChanges, Event, ChildProperty } from '@syncfusion/ej2-base';\nimport { getComponent, closest, EventHandler, getUniqueID, isNullOrUndefined } from '@syncfusion/ej2-base';\nimport { Collection, Complex } from '@syncfusion/ej2-base';\nimport { Tab, Toolbar } from '@syncfusion/ej2-navigations';\nimport { Menu, Item, MenuItem } from '@syncfusion/ej2-navigations';\n/**\n * Objects used for configuring the Ribbon tab header properties.\n */\nvar RibbonHeader = /** @class */ (function (_super) {\n    __extends(RibbonHeader, _super);\n    function RibbonHeader() {\n        return _super !== null && _super.apply(this, arguments) || this;\n    }\n    __decorate([\n        Property('')\n    ], RibbonHeader.prototype, \"text\", void 0);\n    __decorate([\n        Property('')\n    ], RibbonHeader.prototype, \"iconCss\", void 0);\n    __decorate([\n        Property('left')\n    ], RibbonHeader.prototype, \"iconPosition\", void 0);\n    return RibbonHeader;\n}(ChildProperty));\nexport { RibbonHeader };\n/**\n * An array of object that is used to configure the Tab.\n */\nvar RibbonItem = /** @class */ (function (_super) {\n    __extends(RibbonItem, _super);\n    function RibbonItem() {\n        return _super !== null && _super.apply(this, arguments) || this;\n    }\n    __decorate([\n        Complex({}, RibbonHeader)\n    ], RibbonItem.prototype, \"header\", void 0);\n    __decorate([\n        Collection([], Item)\n    ], RibbonItem.prototype, \"content\", void 0);\n    __decorate([\n        Property('')\n    ], RibbonItem.prototype, \"cssClass\", void 0);\n    __decorate([\n        Property(false)\n    ], RibbonItem.prototype, \"disabled\", void 0);\n    return RibbonItem;\n}(ChildProperty));\nexport { RibbonItem };\n/**\n * Represents Ribbon component.\n */\nvar Ribbon = /** @class */ (function (_super) {\n    __extends(Ribbon, _super);\n    /**\n     * Constructor for creating the widget.\n     * @param  {RibbonModel} options?\n     * @param  {string|HTMLDivElement} element?\n     */\n    function Ribbon(options, element) {\n        return _super.call(this, options) || this;\n    }\n    /**\n     * For internal use only.\n     * @returns void\n     * @private\n     */\n    Ribbon.prototype.preRender = function () {\n        /** */\n    };\n    /**\n     * For internal use only.\n     * @returns void\n     * @private\n     */\n    Ribbon.prototype.render = function () {\n        if (!this.element.id) {\n            this.element.id = getUniqueID('ribbon');\n        }\n        this.renderRibbon();\n    };\n    /**\n     * Destroys the component (detaches/removes all event handlers, attributes, classes, and empties the component element).\n     * {% codeBlock src='spreadsheet/destroy/index.md' %}{% endcodeBlock %}\n     * @method destroy\n     * @return {void}\n     */\n    Ribbon.prototype.destroy = function () {\n        var expandCollapseElem = this.element.querySelector('.e-drop-icon');\n        if (expandCollapseElem) {\n            expandCollapseElem.removeEventListener('click', this.ribbonExpandCollapse.bind(this));\n        }\n        if (this.menuItems.length) {\n            var fileMenu = document.getElementById(this.element.id + \"_menu\");\n            if (fileMenu) {\n                getComponent(fileMenu, 'menu').destroy();\n            }\n        }\n        this.toolbarObj.destroy();\n        this.tabObj.destroy();\n        this.element.innerHTML = '';\n        this.toolbarObj = null;\n        this.tabObj = null;\n        _super.prototype.destroy.call(this);\n    };\n    Ribbon.prototype.getTabItems = function () {\n        var _this = this;\n        var tabItems = [];\n        if (this.menuItems.length) {\n            tabItems.push({\n                header: { text: this.initMenu(this.menuItems) },\n                content: this.toolbarObj.element,\n                cssClass: 'e-menu-tab'\n            });\n        }\n        this.items.forEach(function (item) {\n            tabItems.push({\n                header: item.header,\n                content: _this.toolbarObj.element\n            });\n        });\n        return tabItems;\n    };\n    Ribbon.prototype.initMenu = function (menuItems) {\n        var _this = this;\n        var menu = this.createElement('ul', { id: this.element.id + \"_menu\" });\n        this.element.appendChild(menu);\n        var menuObj = new Menu({\n            cssClass: 'e-file-menu',\n            items: menuItems,\n            showItemOnClick: true,\n            beforeOpen: function (args) {\n                if (args.parentItem.text === menuItems[0].text) {\n                    menuObj.showItemOnClick = false;\n                }\n                _this.trigger('beforeOpen', args);\n            },\n            select: function (args) {\n                _this.trigger('fileMenuItemSelect', args);\n            },\n            beforeClose: function (args) {\n                if (args.event.type === 'mouseover' && !closest(args.event.target, '.e-menu-popup')) {\n                    args.cancel = true;\n                    return;\n                }\n                _this.trigger('beforeClose', args);\n                if (!args.parentItem || args.parentItem.text === menuItems[0].text) {\n                    requestAnimationFrame(function () { return menuObj.setProperties({ showItemOnClick: true }, true); });\n                }\n            },\n            beforeItemRender: function (args) {\n                _this.trigger('beforeFileMenuItemRender', args);\n            }\n        });\n        menuObj.createElement = this.createElement;\n        menuObj.appendTo(menu);\n        return menu.parentElement;\n    };\n    Ribbon.prototype.renderRibbon = function () {\n        var _this = this;\n        var tabElement = this.createElement('div');\n        var tBarElement = this.createElement('div');\n        this.toolbarObj = new Toolbar({\n            items: this.items[this.selectedTab].content,\n            clicked: function (args) { return _this.trigger('clicked', args); }\n        });\n        this.toolbarObj.createElement = this.createElement;\n        this.toolbarObj.appendTo(tBarElement);\n        this.tabObj = new Tab({\n            selectedItem: this.getIndex(this.selectedTab),\n            animation: { next: { duration: 0 }, previous: { duration: 0 } },\n            items: this.getTabItems(),\n            selecting: function (args) {\n                if (_this.menuItems.length && args.selectingIndex === 0) {\n                    args.cancel = true;\n                }\n                else {\n                    if (args.selectingIndex === _this.getIndex(_this.selectedTab)) {\n                        return;\n                    }\n                    _this.updateToolbar(_this.getIndex(args.selectingIndex, true));\n                    _this.toolbarObj.dataBind();\n                    if (_this.element.classList.contains('e-collapsed')) {\n                        EventHandler.remove(args.selectedItem, 'click', _this.ribbonExpandCollapse);\n                    }\n                    var eventArgs = void 0;\n                    if (_this.menuItems.length) {\n                        eventArgs = __assign({}, args);\n                        eventArgs.selectingIndex -= 1;\n                        eventArgs.selectedIndex -= 1;\n                    }\n                    else {\n                        eventArgs = args;\n                    }\n                    _this.trigger('selecting', eventArgs);\n                }\n            },\n            selected: function (args) {\n                if (args.selectedIndex === _this.getIndex(_this.selectedTab)) {\n                    return;\n                }\n                _this.setProperties({ 'selectedTab': _this.getIndex(args.selectedIndex, true) }, true);\n                if (_this.element.classList.contains('e-collapsed')) {\n                    _this.element.classList.remove('e-collapsed');\n                    _this.trigger('expandCollapse', { element: _this.toolbarObj.element, expanded: true });\n                }\n            },\n            created: function () {\n                _this.toolbarObj.refreshOverflow();\n            }\n        });\n        this.element.appendChild(tabElement);\n        this.tabObj.createElement = this.createElement;\n        this.tabObj.appendTo(tabElement);\n        var collapseBtn = this.createElement('span', { className: 'e-drop-icon e-icons' });\n        collapseBtn.addEventListener('click', this.ribbonExpandCollapse.bind(this));\n        this.element.appendChild(collapseBtn);\n    };\n    Ribbon.prototype.ribbonExpandCollapse = function (e) {\n        var eventArgs = { element: this.toolbarObj.element, expanded: true };\n        var activeTab;\n        if (this.element.classList.contains('e-collapsed')) {\n            activeTab = this.tabObj.element.querySelector('.e-tab-header').getElementsByClassName('e-toolbar-item')[this.tabObj.selectedItem];\n            this.element.classList.remove('e-collapsed');\n            activeTab.classList.add('e-active');\n            EventHandler.remove(activeTab, 'click', this.ribbonExpandCollapse);\n            this.trigger('expandCollapse', eventArgs);\n        }\n        else {\n            activeTab = this.tabObj.element.querySelector('.e-tab-header .e-toolbar-item.e-active');\n            this.element.classList.add('e-collapsed');\n            eventArgs.expanded = false;\n            activeTab.classList.remove('e-active');\n            EventHandler.add(activeTab, 'click', this.ribbonExpandCollapse, this);\n            this.trigger('expandCollapse', eventArgs);\n        }\n    };\n    Ribbon.prototype.getIndex = function (index, decrement) {\n        return this.menuItems.length ? (decrement ? index - 1 : index + 1) : index;\n    };\n    Ribbon.prototype.updateToolbar = function (index) {\n        this.toolbarObj.items = this.items[index].content;\n        this.toolbarObj.dataBind();\n    };\n    /**\n     * To enable / disable the ribbon menu items.\n     * @param {string[]} items - Items that needs to be enabled / disabled.\n     * @param {boolean} enable - Set `true` / `false` to enable / disable the menu items.\n     * @param {boolean} isUniqueId? - Set `true` if the given menu items `text` is a unique id.\n     * @returns void.\n     */\n    Ribbon.prototype.enableMenuItems = function (items, enable, isUniqueId) {\n        if (enable === void 0) { enable = true; }\n        if (!this.menuItems.length) {\n            return;\n        }\n        getComponent(document.getElementById(this.element.id + \"_menu\"), 'menu').enableItems(items, enable, isUniqueId);\n    };\n    /**\n     * To show/hide the menu items in Ribbon.\n     * @param {string[]} items - Specifies the menu items text which is to be show/hide.\n     * @param {boolean} hide - Set `true` / `false` to hide / show the menu items.\n     * @param {boolean} isUniqueId? - Set `true` if the given menu items `text` is a unique id.\n     * @returns void.\n     */\n    Ribbon.prototype.hideMenuItems = function (items, hide, isUniqueId) {\n        if (hide === void 0) { hide = true; }\n        if (!this.menuItems.length) {\n            return;\n        }\n        var menuInstance = getComponent(document.getElementById(this.element.id + \"_menu\"), 'menu');\n        hide ? menuInstance.hideItems(items, isUniqueId) : menuInstance.showItems(items, isUniqueId);\n    };\n    /**\n     * To add custom menu items.\n     * @param {MenuItemModel[]} items - Specifies the Ribbon menu items to be inserted.\n     * @param {string} text - Specifies the existing file menu item text before / after which the new file menu items to be inserted.\n     * @param {boolean} insertAfter? - Set `false` if the `items` need to be inserted before the `text`.\n     * By default, `items` are added after the `text`.\n     * @param {boolean} isUniqueId? - Set `true` if the given menu items `text` is a unique id.\n     * @returns void.\n     */\n    Ribbon.prototype.addMenuItems = function (items, text, insertAfter, isUniqueId) {\n        if (insertAfter === void 0) { insertAfter = true; }\n        if (!this.menuItems.length) {\n            return;\n        }\n        var menuInstance = getComponent(document.getElementById(this.element.id + \"_menu\"), 'menu');\n        insertAfter ? menuInstance.insertAfter(items.reverse(), text, isUniqueId) : menuInstance.insertBefore(items, text, isUniqueId);\n    };\n    /**\n     * To show/hide the Ribbon tabs.\n     * @param {string[]} tabs - Specifies the tab header text which needs to be shown/hidden.\n     * @param {boolean} hide? - Set `true` / `false` to hide / show the ribbon tabs.\n     * @returns void.\n     */\n    Ribbon.prototype.hideTabs = function (tabs, hide) {\n        var _this = this;\n        if (hide === void 0) { hide = true; }\n        var idx;\n        var activeTab;\n        var stateChanged;\n        var isAllHidden;\n        if (!hide) {\n            isAllHidden = this.isAllHidden();\n        }\n        tabs.forEach(function (tab) {\n            idx = _this.getTabIndex(tab, -1);\n            if (idx > -1) {\n                if (hide) {\n                    if (!_this.items[idx].cssClass.includes(' e-hide')) {\n                        _this.items[idx].cssClass = _this.items[idx].cssClass + \" e-hide\";\n                        _this.tabObj.items[_this.getIndex(idx)].cssClass = _this.items[idx].cssClass;\n                        if (activeTab === undefined && idx === _this.selectedTab) {\n                            activeTab = true;\n                        }\n                        stateChanged = true;\n                    }\n                }\n                else {\n                    if (_this.items[idx].cssClass.includes(' e-hide')) {\n                        _this.items[idx].cssClass = _this.items[idx].cssClass.replace(' e-hide', '');\n                        _this.tabObj.items[_this.getIndex(idx)].cssClass = _this.items[idx].cssClass;\n                        if (activeTab === undefined && idx === _this.selectedTab) {\n                            activeTab = true;\n                        }\n                        stateChanged = true;\n                    }\n                }\n            }\n        });\n        this.setProperties({ 'items': this.items }, true);\n        this.tabObj.items = this.tabObj.items;\n        this.tabObj.dataBind();\n        if (hide) {\n            isAllHidden = this.isAllHidden();\n            if (isAllHidden) {\n                activeTab = false;\n            }\n        }\n        if (!hide && isAllHidden) {\n            activeTab = activeTab ? false : true;\n        }\n        if (stateChanged && isAllHidden) {\n            if (this.element.classList.contains('e-collapsed')) {\n                this.element.classList.remove('e-collapsed');\n                this.element.querySelector('.e-drop-icon').classList.remove('e-hide');\n            }\n            else {\n                this.element.classList.add('e-collapsed');\n                this.element.querySelector('.e-drop-icon').classList.add('e-hide');\n            }\n        }\n        if (activeTab) {\n            for (var i = 0; i < this.items.length; i++) {\n                if (!this.items[i].cssClass.includes(' e-hide')) {\n                    this.tabObj.selectedItem = this.getIndex(i);\n                    this.tabObj.dataBind();\n                    break;\n                }\n            }\n        }\n    };\n    Ribbon.prototype.isAllHidden = function () {\n        var allHidden = true;\n        for (var i = 0; i < this.items.length; i++) {\n            if (!this.items[i].cssClass.includes(' e-hide')) {\n                allHidden = false;\n                break;\n            }\n        }\n        return allHidden;\n    };\n    /**\n     * To enable / disable the Ribbon tabs.\n     * @param {string[]} tabs - Specifies the tab header text which needs to be enabled / disabled.\n     * @param {boolean} enable? - Set `true` / `false` to enable / disable the ribbon tabs.\n     * @returns void.\n     */\n    Ribbon.prototype.enableTabs = function (tabs, enable) {\n        var _this = this;\n        if (enable === void 0) { enable = true; }\n        tabs.forEach(function (tab) {\n            var idx = (_this.getTabIndex(tab, -1));\n            if (idx > -1) {\n                _this.items[idx].disabled = !enable;\n                idx = _this.getIndex(idx);\n                _this.tabObj.enableTab(idx, enable);\n            }\n        });\n        this.setProperties({ 'items': this.items }, true);\n    };\n    /**\n     * To add custom tabs.\n     * @param {RibbonItemModel[]} items - Specifies the Ribbon tab items to be inserted.\n     * @param {string} insertBefore? - Specifies the existing Ribbon header text before which the new tabs will be inserted.\n     * If not specified, the new tabs will be inserted at the end.\n     * @returns void.\n     */\n    Ribbon.prototype.addTabs = function (items, insertBefore) {\n        var _this = this;\n        var idx = this.getTabIndex(insertBefore);\n        items.forEach(function (item) {\n            item = new RibbonItem(_this.items[0], 'items', item, true);\n            _this.items.splice(idx, 0, item);\n            _this.tabObj.addTab([{ header: item.header, content: _this.toolbarObj.element }], _this.getIndex(idx));\n            idx++;\n        });\n        this.setProperties({ 'items': this.items }, true);\n        this.setProperties({ 'selectedTab': this.getIndex(this.tabObj.selectedItem, true) }, true);\n    };\n    Ribbon.prototype.getTabIndex = function (headerText, idx) {\n        if (idx === void 0) { idx = this.items.length; }\n        if (headerText) {\n            for (var i = 0; i < this.items.length; i++) {\n                if (this.items[i].header.text === headerText) {\n                    idx = i;\n                    break;\n                }\n            }\n        }\n        return idx;\n    };\n    /**\n     * To add the custom items in Ribbon toolbar.\n     * @param {string} tab - Specifies the ribbon tab header text under which the specified items will be inserted..\n     * @param {ItemModel[]} items - Specifies the ribbon toolbar items that needs to be inserted.\n     * @param {number} index? - Specifies the index text before which the new items will be inserted.\n     * If not specified, the new items will be inserted at the end of the toolbar.\n     */\n    Ribbon.prototype.addToolbarItems = function (tab, items, index) {\n        var _this = this;\n        var tabIdx = this.getTabIndex(tab);\n        if (isNullOrUndefined(index)) {\n            index = this.items[tabIdx].content.length;\n        }\n        items.forEach(function (item) {\n            item = new Item(_this.items[tabIdx].content[0], 'content', item, true);\n            _this.items[tabIdx].content.splice(index, 0, item);\n            index++;\n        });\n        this.setProperties({ 'items': this.items }, true);\n        if (tabIdx === this.selectedTab && items.length) {\n            this.updateToolbar(tabIdx);\n        }\n    };\n    /**\n     * Enables or disables the specified Ribbon toolbar items or all ribbon items.\n     * @param {string} tab - Specifies the ribbon tab header text under which the toolbar items need to be enabled / disabled.\n     * @param {string[]} items? - Specifies the toolbar item indexes / unique id's which needs to be enabled / disabled.\n     * If it is not specified the entire toolbar items will be enabled / disabled.\n     * @param  {boolean} enable? - Boolean value that determines whether the toolbar items should be enabled or disabled.\n     * @returns void.\n     */\n    Ribbon.prototype.enableItems = function (tab, items, enable) {\n        if (enable === undefined) {\n            enable = true;\n        }\n        if (items) {\n            var tabIdx = this.getTabIndex(tab, -1);\n            if (tabIdx < 0) {\n                return;\n            }\n            for (var i = 0; i < items.length; i++) {\n                if (typeof (items[i]) === 'string') {\n                    for (var j = 0; j < this.items[tabIdx].content.length; j++) {\n                        if (this.items[tabIdx].content[j].id === items[i]) {\n                            items[i] = j;\n                            break;\n                        }\n                    }\n                }\n                if (typeof (items[i]) === 'string') {\n                    return;\n                }\n                this.items[tabIdx].content[items[i]].disabled = !enable;\n            }\n            if (tabIdx === this.selectedTab) {\n                this.updateToolbar(tabIdx);\n            }\n        }\n        else {\n            this.toolbarObj.disable(!enable);\n        }\n    };\n    /**\n     * To show/hide the existing Ribbon toolbar items.\n     * @param {string} tab - Specifies the ribbon tab header text under which the specified items need to be hidden / shown.\n     * @param {string[]} indexes - Specifies the toolbar indexes which needs to be shown/hidden from UI.\n     * @param {boolean} hide? - Set `true` / `false` to hide / show the toolbar items.\n     * @returns void.\n     */\n    Ribbon.prototype.hideToolbarItems = function (tab, indexes, hide) {\n        var _this = this;\n        if (hide === void 0) { hide = true; }\n        var tabIdx;\n        for (var i = 0; i < this.items.length; i++) {\n            if (this.items[i].header.text === tab) {\n                tabIdx = i;\n                indexes.forEach(function (idx) {\n                    if (_this.items[tabIdx].content[idx]) {\n                        if (hide) {\n                            if (!_this.items[tabIdx].content[idx].cssClass.includes(' e-hide')) {\n                                _this.items[tabIdx].content[idx].cssClass = _this.items[tabIdx].content[idx].cssClass + ' e-hide';\n                            }\n                        }\n                        else {\n                            if (_this.items[tabIdx].content[idx].cssClass.includes(' e-hide')) {\n                                _this.items[tabIdx].content[idx].cssClass = _this.items[tabIdx].content[idx].cssClass.replace(' e-hide', '');\n                            }\n                        }\n                    }\n                });\n                break;\n            }\n        }\n        this.setProperties({ 'items': this.items }, true);\n        if (tabIdx !== undefined && tabIdx === this.selectedTab) {\n            this.updateToolbar(tabIdx);\n        }\n    };\n    /**\n     * Get component name.\n     * @returns string\n     * @private\n     */\n    Ribbon.prototype.getModuleName = function () {\n        return 'ribbon';\n    };\n    /**\n     * Get the properties to be maintained in the persisted state.\n     * @returns string\n     * @private\n     */\n    Ribbon.prototype.getPersistData = function () {\n        return this.addOnPersist([]);\n    };\n    /**\n     * Called internally if any of the property value changed.\n     * @param  {RibbonModel} newProp\n     * @param  {RibbonModel} oldProp\n     * @returns void\n     * @private\n     */\n    Ribbon.prototype.onPropertyChanged = function (newProp, oldProp) {\n        for (var _i = 0, _a = Object.keys(newProp); _i < _a.length; _i++) {\n            var prop = _a[_i];\n            switch (prop) {\n                case 'selectedTab':\n                    this.tabObj.selectedItem = this.getIndex(newProp.selectedTab);\n                    this.tabObj.dataBind();\n                    break;\n            }\n        }\n    };\n    __decorate([\n        Property('')\n    ], Ribbon.prototype, \"cssClass\", void 0);\n    __decorate([\n        Property(true)\n    ], Ribbon.prototype, \"menuType\", void 0);\n    __decorate([\n        Collection([], MenuItem)\n    ], Ribbon.prototype, \"menuItems\", void 0);\n    __decorate([\n        Property(0)\n    ], Ribbon.prototype, \"selectedTab\", void 0);\n    __decorate([\n        Collection([], RibbonItem)\n    ], Ribbon.prototype, \"items\", void 0);\n    __decorate([\n        Event()\n    ], Ribbon.prototype, \"selecting\", void 0);\n    __decorate([\n        Event()\n    ], Ribbon.prototype, \"fileMenuItemSelect\", void 0);\n    __decorate([\n        Event()\n    ], Ribbon.prototype, \"beforeFileMenuItemRender\", void 0);\n    __decorate([\n        Event()\n    ], Ribbon.prototype, \"beforeOpen\", void 0);\n    __decorate([\n        Event()\n    ], Ribbon.prototype, \"beforeClose\", void 0);\n    __decorate([\n        Event()\n    ], Ribbon.prototype, \"selectFormat\", void 0);\n    __decorate([\n        Event()\n    ], Ribbon.prototype, \"clicked\", void 0);\n    __decorate([\n        Event()\n    ], Ribbon.prototype, \"created\", void 0);\n    __decorate([\n        Event()\n    ], Ribbon.prototype, \"expandCollapse\", void 0);\n    Ribbon = __decorate([\n        NotifyPropertyChanges\n    ], Ribbon);\n    return Ribbon;\n}(Component));\nexport { Ribbon };\n","import { ColorPicker as ColorPickerComponent } from '@syncfusion/ej2-inputs';\nimport { addClass } from '@syncfusion/ej2-base';\nimport { spreadsheetDestroyed, fontColor, fillColor, beforeRibbonCreate, locale } from '../common/index';\nimport { setCellFormat } from '../../workbook/common/index';\n/**\n * `Color Picker` module is used to handle ColorPicker functionality.\n * @hidden\n */\nvar ColorPicker = /** @class */ (function () {\n    function ColorPicker(parent) {\n        this.parent = parent;\n        this.addEventListener();\n    }\n    ColorPicker.prototype.render = function () {\n        var _this = this;\n        var id = this.parent.element.id;\n        var input = this.parent.createElement('input', { attrs: { 'type': 'color' } });\n        this.fontColorPicker = new ColorPickerComponent({\n            value: '#000000ff',\n            mode: 'Palette',\n            showButtons: false,\n            presetColors: fontColor,\n            enableOpacity: false,\n            beforeClose: function (args) { return _this.beforeCloseHandler(_this.fontColorPicker); },\n            open: this.openHandler.bind(this),\n            beforeModeSwitch: function (args) { return _this.beforeModeSwitch(_this.fontColorPicker, args); },\n            change: function (args) {\n                var color = _this.fontColorPicker.getValue(args.currentValue.rgba);\n                var eventArgs = { style: { color: color }, onActionUpdate: true };\n                _this.parent.notify(setCellFormat, eventArgs);\n                if (eventArgs.cancel) {\n                    _this.fontColorPicker.setProperties({ 'value': _this.fontColorPicker.getValue(args.previousValue.rgba, 'HEXA') }, true);\n                }\n                else {\n                    _this.updateSelectedColor(eventArgs.style.color, _this.fontColorPicker.element);\n                }\n                _this.parent.element.focus();\n            },\n            created: function () { return _this.wireFocusEvent(_this.fontColorPicker.element, '#000000'); }\n        });\n        this.fontColorPicker.createElement = this.parent.createElement;\n        this.parent.element.appendChild(input);\n        this.fontColorPicker.appendTo(input);\n        input.parentElement.id = id + \"_font_color_picker\";\n        addClass([input.nextElementSibling.getElementsByClassName('e-selected-color')[0]], ['e-icons', 'e-font-color']);\n        input = this.parent.createElement('input', { attrs: { 'type': 'color' } });\n        this.filColorPicker = new ColorPickerComponent({\n            value: '#ffff00ff',\n            mode: 'Palette',\n            presetColors: fillColor,\n            showButtons: false,\n            enableOpacity: false,\n            open: this.openHandler.bind(this),\n            beforeClose: function (args) { return _this.beforeCloseHandler(_this.filColorPicker); },\n            beforeModeSwitch: function (args) { return _this.beforeModeSwitch(_this.filColorPicker, args); },\n            change: function (args) {\n                var color = _this.filColorPicker.getValue(args.currentValue.rgba);\n                var eventArgs = { style: { backgroundColor: color }, onActionUpdate: true };\n                _this.parent.notify(setCellFormat, eventArgs);\n                if (eventArgs.cancel) {\n                    _this.filColorPicker.setProperties({ 'value': _this.filColorPicker.getValue(args.previousValue.rgba, 'HEXA') }, true);\n                }\n                else {\n                    _this.updateSelectedColor(eventArgs.style.backgroundColor, _this.filColorPicker.element);\n                }\n                _this.parent.element.focus();\n            },\n            created: function () { return _this.wireFocusEvent(_this.filColorPicker.element, '#ffff00'); }\n        });\n        this.filColorPicker.createElement = this.parent.createElement;\n        this.parent.element.appendChild(input);\n        this.filColorPicker.appendTo(input);\n        input.parentElement.id = id + \"_fill_color_picker\";\n        addClass([input.nextElementSibling.getElementsByClassName('e-selected-color')[0]], ['e-icons', 'e-fill-color']);\n    };\n    ColorPicker.prototype.updateSelectedColor = function (color, ele) {\n        ele.nextElementSibling.querySelector('.e-selected-color').style.borderBottomColor = color;\n    };\n    ColorPicker.prototype.wireFocusEvent = function (element, color) {\n        var _this = this;\n        this.updateSelectedColor(color, element);\n        element = element.parentElement.querySelector('.e-split-colorpicker');\n        element.addEventListener('focus', function () {\n            _this.parent.element.focus();\n        });\n    };\n    ColorPicker.prototype.openHandler = function (args) {\n        args.element.querySelector('.e-mode-switch-btn').title =\n            this.parent.serviceLocator.getService(locale).getConstant('MoreColors');\n    };\n    ColorPicker.prototype.beforeCloseHandler = function (inst) {\n        if (!inst.modeSwitcher) {\n            inst.setProperties({ modeSwitcher: true }, true);\n        }\n        if (inst.showButtons) {\n            inst.setProperties({ showButtons: false }, true);\n        }\n    };\n    ColorPicker.prototype.beforeModeSwitch = function (inst, args) {\n        var l10n = this.parent.serviceLocator.getService(locale);\n        if (args.mode === 'Picker') {\n            inst.showButtons = true;\n            inst.dataBind();\n            args.element.querySelector('.e-apply').title = l10n.getConstant('Apply');\n            args.element.querySelector('.e-cancel').title = l10n.getConstant('Cancel');\n            args.element.querySelector('.e-mode-switch-btn').title = l10n.getConstant('StandardColors');\n        }\n        else {\n            inst.showButtons = false;\n            inst.dataBind();\n            args.element.querySelector('.e-mode-switch-btn').title = l10n.getConstant('MoreColors');\n        }\n    };\n    ColorPicker.prototype.destroy = function () {\n        if (this.parent) {\n            this.removeEventListener();\n            this.fontColorPicker.destroy();\n            this.fontColorPicker = null;\n            this.filColorPicker.destroy();\n            this.filColorPicker = null;\n            this.parent = null;\n        }\n    };\n    ColorPicker.prototype.addEventListener = function () {\n        this.parent.on(beforeRibbonCreate, this.render, this);\n        this.parent.on('destroyRibbonComponents', this.destroy, this);\n        this.parent.on(spreadsheetDestroyed, this.destroy, this);\n    };\n    ColorPicker.prototype.removeEventListener = function () {\n        this.parent.off(beforeRibbonCreate, this.render);\n        this.parent.off('destroyRibbonComponents', this.destroy);\n        this.parent.on(spreadsheetDestroyed, this.destroy, this);\n    };\n    return ColorPicker;\n}());\nexport { ColorPicker };\n","import { Ribbon as RibbonComponent } from '../../ribbon/index';\nimport { ribbon, selectionComplete, beforeRibbonCreate, removeDataValidation, clearViewer } from '../common/index';\nimport { initiateDataValidation, invalidData, setUndoRedo, initiateConditionalFormat, setCF } from '../common/index';\nimport { dialog, reapplyFilter, enableFileMenuItems, applyProtect, protectCellFormat } from '../common/index';\nimport { findHandler, insertChart } from '../common/index';\nimport { destroyComponent, performUndoRedo, beginAction, completeAction, applySort, hideRibbonTabs } from '../common/index';\nimport { enableToolbarItems, ribbonClick, paste, locale, refreshSheetTabs, initiateCustomSort, getFilteredColumn } from '../common/index';\nimport { tabSwitch, getUpdateUsingRaf, updateToggleItem, initiateHyperlink, editHyperlink } from '../common/index';\nimport { addRibbonTabs, addToolbarItems, hideFileMenuItems, addFileMenuItems, hideToolbarItems, enableRibbonTabs } from '../common/index';\nimport { Toolbar, Menu } from '@syncfusion/ej2-navigations';\nimport { ColorPicker } from '@syncfusion/ej2-inputs';\nimport { extend, isNullOrUndefined, getComponent, closest, detach, selectAll, select, EventHandler } from '@syncfusion/ej2-base';\nimport { getCellIndexes, getFormatFromType, getTypeFromFormat, setCell } from '../../workbook/index';\nimport { DropDownButton, SplitButton } from '@syncfusion/ej2-splitbuttons';\nimport { calculatePosition } from '@syncfusion/ej2-popups';\nimport { applyNumberFormatting, getFormattedCellObject, getRangeIndexes, setMerge } from '../../workbook/common/index';\nimport { activeCellChanged, textDecorationUpdate, isNumber } from '../../workbook/common/index';\nimport { sheetsDestroyed, getRangeAddress, clearCFRule } from '../../workbook/common/index';\nimport { getCell, setCellFormat } from '../../workbook/index';\nimport { Button } from '@syncfusion/ej2-buttons';\nimport { ColorPicker as RibbonColorPicker } from './color-picker';\nimport { Dialog as FindDialog } from '@syncfusion/ej2-popups';\nimport { findDlg } from '../common/index';\nimport { refreshRibbonIcons } from '../../workbook/common/index';\n/**\n * Represents Ribbon for Spreadsheet.\n */\nvar Ribbon = /** @class */ (function () {\n    function Ribbon(parent) {\n        this.border = '1px solid #000000';\n        this.fontNameIndex = 5;\n        this.numPopupWidth = 0;\n        this.findValue = '';\n        this.parent = parent;\n        this.addEventListener();\n        new RibbonColorPicker(parent);\n    }\n    Ribbon.prototype.getModuleName = function () {\n        return 'ribbon';\n    };\n    Ribbon.prototype.initRibbon = function (args) {\n        if (!this.parent.showRibbon && this.ribbon) {\n            this.destroy();\n            return;\n        }\n        this.parent.notify(beforeRibbonCreate, {});\n        if (this.parent.isMobileView()) {\n            this.createMobileView();\n        }\n        else {\n            this.createRibbon(args);\n        }\n    };\n    Ribbon.prototype.getRibbonMenuItems = function () {\n        var l10n = this.parent.serviceLocator.getService(locale);\n        var id = this.parent.element.id;\n        return [{\n                text: this.parent.isMobileView() ? '' : l10n.getConstant('File'),\n                iconCss: this.parent.isMobileView() ? 'e-icons e-file-menu-icon' : null, id: id + \"_File\",\n                items: [\n                    { text: l10n.getConstant('New'), id: id + \"_New\", iconCss: 'e-new e-icons' },\n                    { text: l10n.getConstant('Open'), id: id + \"_Open\", iconCss: 'e-open e-icons' },\n                    {\n                        text: l10n.getConstant('SaveAs'), iconCss: 'e-save e-icons', id: id + \"_Save_As\",\n                        items: [\n                            { text: l10n.getConstant('ExcelXlsx'), id: id + \"_Xlsx\", iconCss: 'e-xlsx e-icons' },\n                            { text: l10n.getConstant('ExcelXls'), id: id + \"_Xls\", iconCss: 'e-xls e-icons' },\n                            { text: l10n.getConstant('CSV'), id: id + \"_Csv\", iconCss: 'e-csv e-icons' }\n                        ]\n                    }\n                ]\n            }];\n    };\n    // tslint:disable-next-line:max-func-body-length\n    Ribbon.prototype.getRibbonItems = function () {\n        var _this = this;\n        var id = this.parent.element.id;\n        var l10n = this.parent.serviceLocator.getService(locale);\n        var items = [{\n                header: { text: l10n.getConstant('Home') },\n                content: [\n                    { prefixIcon: 'e-undo-icon', tooltipText: l10n.getConstant('Undo') + \" (Ctrl+Z)\", id: id + '_undo', disabled: true },\n                    { prefixIcon: 'e-redo-icon', tooltipText: l10n.getConstant('Redo') + \" (Ctrl+Y)\", id: id + '_redo', disabled: true },\n                    { type: 'Separator', id: id + '_separator_1' },\n                    { prefixIcon: 'e-cut-icon', tooltipText: l10n.getConstant('Cut') + \" (Ctrl+X)\", id: id + '_cut' },\n                    { prefixIcon: 'e-copy-icon', tooltipText: l10n.getConstant('Copy') + \" (Ctrl+C)\", id: id + '_copy' },\n                    { tooltipText: l10n.getConstant('Paste') + \" (Ctrl+V)\", template: this.getPasteBtn(id), id: id + '_paste',\n                        disabled: true\n                    }, { type: 'Separator', id: id + '_separator_2' },\n                    { template: this.getNumFormatDDB(id), tooltipText: l10n.getConstant('NumberFormat'), id: id + '_number_format' },\n                    { type: 'Separator', id: id + '_separator_3' },\n                    { template: this.getFontNameDDB(id), tooltipText: l10n.getConstant('Font'), id: id + '_font_name' },\n                    { type: 'Separator', id: id + '_separator_4' },\n                    { template: this.getFontSizeDDB(id), tooltipText: l10n.getConstant('FontSize'), id: id + '_font_size' },\n                    { type: 'Separator', id: id + '_separator_5' },\n                    { template: this.getBtn(id, 'bold'), tooltipText: l10n.getConstant('Bold') + \" (Ctrl+B)\", id: id + '_bold' },\n                    { template: this.getBtn(id, 'italic'), tooltipText: l10n.getConstant('Italic') + \" (Ctrl+I)\", id: id + '_italic' },\n                    { template: this.getBtn(id, 'line-through'), tooltipText: l10n.getConstant('Strikethrough') + \" (Ctrl+5)\",\n                        id: id + '_line-through' },\n                    { template: this.getBtn(id, 'underline'), tooltipText: l10n.getConstant('Underline') + \" (Ctrl+U)\",\n                        id: id + '_underline' },\n                    { template: document.getElementById(id + \"_font_color_picker\"), tooltipText: l10n.getConstant('TextColor'),\n                        id: id + '_font_color_picker' }, { type: 'Separator', id: id + '_separator_6' },\n                    { template: document.getElementById(id + \"_fill_color_picker\"), tooltipText: l10n.getConstant('FillColor'),\n                        id: id + '_fill_color_picker' },\n                    { template: this.getBordersDBB(id), tooltipText: l10n.getConstant('Borders'), id: id + '_borders' }, {\n                        template: this.getMergeSplitBtn(id), tooltipText: l10n.getConstant('MergeCells'), id: id + '_merge_cells',\n                        disabled: true\n                    }, { type: 'Separator', id: id + '_separator_7' },\n                    { template: this.getTextAlignDDB(id), tooltipText: l10n.getConstant('HorizontalAlignment'), id: id + '_text_align' }, { template: this.getVerticalAlignDDB(id), tooltipText: l10n.getConstant('VerticalAlignment'), id: id + '_vertical_align' },\n                    { template: this.getBtn(id, 'wrap', false), tooltipText: \"\" + l10n.getConstant('WrapText'), id: id + '_wrap' }\n                ]\n            },\n            {\n                header: { text: l10n.getConstant('Insert') }, content: [\n                    {\n                        prefixIcon: 'e-hyperlink-icon', text: l10n.getConstant('Link'),\n                        id: id + '_hyperlink', tooltipText: l10n.getConstant('Link'), click: function () { _this.getHyperlinkDlg(); }\n                    },\n                    {\n                        prefixIcon: 'e-image-icon', text: l10n.getConstant('Image'),\n                        id: id + '_', tooltipText: l10n.getConstant('Image'), click: function () {\n                            select('#' + id + '_imageUpload', _this.parent.element).click();\n                        }\n                    }\n                ]\n            },\n            {\n                header: { text: l10n.getConstant('Formulas') }, content: [{\n                        prefixIcon: 'e-insert-function', tooltipText: l10n.getConstant('InsertFunction'),\n                        text: l10n.getConstant('InsertFunction'), id: id + '_insert_function'\n                    }]\n            },\n            {\n                header: { text: l10n.getConstant('Data') }, content: [\n                    {\n                        prefixIcon: 'e-protect-icon', text: l10n.getConstant('ProtectSheet'), id: id + '_protect',\n                        tooltipText: l10n.getConstant('ProtectSheet')\n                    }, { type: 'Separator', id: id + '_separator_8' },\n                    {\n                        template: this.datavalidationDDB(id), tooltipText: l10n.getConstant('DataValidation'),\n                        id: id + '_datavalidation'\n                    }\n                ]\n            },\n            {\n                header: { text: l10n.getConstant('View') }, content: [\n                    {\n                        prefixIcon: 'e-hide-headers', text: this.getLocaleText('Headers'), id: id + '_headers',\n                        tooltipText: this.getLocaleText('Headers')\n                    }, { type: 'Separator', id: id + '_separator_9' },\n                    {\n                        prefixIcon: 'e-hide-gridlines', text: this.getLocaleText('GridLines'), id: id + '_gridlines',\n                        tooltipText: this.getLocaleText('GridLines')\n                    }\n                ]\n            }];\n        if (this.parent.allowConditionalFormat) {\n            items.find(function (x) { return x.header && x.header.text === l10n.getConstant('Home'); }).content.push({ type: 'Separator', id: id + '_separator_10' }, { template: this.getCFDBB(id), tooltipText: l10n.getConstant('ConditionalFormatting'), id: id + '_conditionalformatting' });\n        }\n        if (this.parent.allowChart) {\n            items.find(function (x) { return x.header && x.header.text === l10n.getConstant('Insert'); }).content.push({ type: 'Separator', id: id + '_separator_11' }, {\n                template: this.getChartDBB(id), text: l10n.getConstant('Chart'),\n                tooltipText: l10n.getConstant('Chart'), id: id + '_chart'\n            });\n        }\n        if (this.parent.allowCellFormatting) {\n            items.find(function (x) { return x.header && x.header.text === l10n.getConstant('Home'); }).content.push({ type: 'Separator', id: id + '_separator_12' }, { template: this.getClearDDB(id), tooltipText: l10n.getConstant('Clear'), id: id + '_clear' });\n        }\n        if (this.parent.allowSorting || this.parent.allowFiltering) {\n            items.find(function (x) { return x.header && x.header.text === l10n.getConstant('Home'); }).content.push({ template: this.getSortFilterDDB(id), tooltipText: l10n.getConstant('SortAndFilter'), id: id + '_sorting' });\n        }\n        if (this.parent.allowFindAndReplace) {\n            items.find(function (x) { return x.header && x.header.text === l10n.getConstant('Home'); }).content.push({\n                template: this.getFindDDb(id), prefixIcon: 'e-tbar-search-icon tb-icons',\n                tooltipText: l10n.getConstant('FindReplaceTooltip'), id: id + '_find'\n            });\n        }\n        return items;\n    };\n    Ribbon.prototype.getPasteBtn = function (id) {\n        var _this = this;\n        var btn = this.parent.element.appendChild(this.parent.createElement('button', { id: id + '_paste' }));\n        var l10n = this.parent.serviceLocator.getService(locale);\n        this.pasteSplitBtn = new SplitButton({\n            iconCss: 'e-icons e-paste-icon',\n            items: [\n                { text: l10n.getConstant('All'), id: 'All' },\n                { text: l10n.getConstant('Values'), id: 'Values' },\n                { text: l10n.getConstant('Formats'), id: 'Formats' }\n            ],\n            select: function (args) {\n                _this.parent.notify(paste, { type: args.item.id, isAction: true, isInternal: true });\n            },\n            click: function () {\n                _this.parent.notify(paste, { isAction: true, isInternal: true });\n            },\n            close: function () { _this.parent.element.focus(); }\n        });\n        this.pasteSplitBtn.createElement = this.parent.createElement;\n        this.pasteSplitBtn.appendTo(btn);\n        return btn.parentElement;\n    };\n    Ribbon.prototype.getHyperlinkDlg = function () {\n        var indexes = getRangeIndexes(this.parent.getActiveSheet().activeCell);\n        var row = this.parent.sheets[this.parent.getActiveSheet().id - 1].rows[indexes[0]];\n        var cell;\n        if (!isNullOrUndefined(row)) {\n            cell = row.cells[indexes[1]];\n        }\n        if (isNullOrUndefined(cell)) {\n            setCell(indexes[0], indexes[1], this.parent.getActiveSheet(), cell, false);\n        }\n        if (cell && cell.hyperlink) {\n            this.parent.notify(editHyperlink, null);\n        }\n        else {\n            this.parent.notify(initiateHyperlink, null);\n        }\n    };\n    Ribbon.prototype.getLocaleText = function (str, setClass) {\n        var text;\n        var l10n = this.parent.serviceLocator.getService(locale);\n        var sheet = this.parent.getActiveSheet();\n        if (sheet['show' + str]) {\n            if (setClass) {\n                this.parent.getMainContent().classList.remove('e-hide-' + str.toLowerCase());\n            }\n            text = l10n.getConstant('Hide' + str);\n        }\n        else {\n            if (setClass) {\n                this.parent.getMainContent().classList.add('e-hide-' + str.toLowerCase());\n            }\n            text = l10n.getConstant('Show' + str);\n        }\n        return text;\n    };\n    Ribbon.prototype.getLocaleProtectText = function (str, setClass) {\n        var text;\n        var l10n = this.parent.serviceLocator.getService(locale);\n        var sheet = this.parent.getActiveSheet();\n        if (sheet.isProtected) {\n            if (setClass) {\n                this.parent.getMainContent().classList.remove('e-hide-' + str.toLowerCase());\n            }\n            text = l10n.getConstant('Unprotect' + str);\n        }\n        else {\n            if (setClass) {\n                this.parent.getMainContent().classList.add('e-hide-' + str.toLowerCase());\n            }\n            text = l10n.getConstant('Protect' + str);\n        }\n        return text;\n    };\n    Ribbon.prototype.createRibbon = function (args) {\n        var ribbonElement = this.parent.createElement('div', { id: this.parent.element.id + \"_ribbon\" });\n        this.ribbon = new RibbonComponent({\n            selectedTab: 0,\n            menuItems: this.getRibbonMenuItems(),\n            items: this.getRibbonItems(),\n            fileMenuItemSelect: this.fileMenuItemSelect.bind(this),\n            beforeOpen: this.fileMenuBeforeOpen.bind(this),\n            beforeClose: this.fileMenuBeforeClose.bind(this),\n            clicked: this.toolbarClicked.bind(this),\n            created: this.ribbonCreated.bind(this),\n            selecting: this.tabSelecting.bind(this),\n            expandCollapse: this.expandCollapseHandler.bind(this),\n            beforeFileMenuItemRender: this.beforeRenderHandler.bind(this)\n        });\n        this.ribbon.createElement = this.parent.createElement;\n        if (args && args.uiUpdate) {\n            var refEle = this.parent.element.querySelector('.e-formula-bar-panel') ||\n                document.getElementById(this.parent.element.id + '_sheet_panel');\n            this.parent.element.insertBefore(ribbonElement, refEle);\n        }\n        else {\n            this.parent.element.appendChild(ribbonElement);\n        }\n        this.ribbon.appendTo(ribbonElement);\n    };\n    Ribbon.prototype.tabSelecting = function (args) {\n        if (args.selectingIndex !== this.ribbon.selectedTab) {\n            this.refreshRibbonContent(args.selectingIndex);\n            this.parent.notify(tabSwitch, { activeTab: args.selectingIndex });\n        }\n    };\n    Ribbon.prototype.beforeRenderHandler = function (args) {\n        var l10n = this.parent.serviceLocator.getService(locale);\n        if (args.item.text === l10n.getConstant('Open') && (!this.parent.openUrl || !this.parent.allowOpen)) {\n            args.element.classList.add('e-disabled');\n        }\n        if (args.item.text === l10n.getConstant('SaveAs') && (!this.parent.saveUrl || !this.parent.allowSave)) {\n            args.element.classList.add('e-disabled');\n        }\n    };\n    Ribbon.prototype.getNumFormatDDB = function (id) {\n        var _this = this;\n        var numFormatBtn = this.parent.createElement('button', { id: id + '_number_format' });\n        numFormatBtn.appendChild(this.parent.createElement('span', { className: 'e-tbar-btn-text', innerHTML: 'General' }));\n        this.numFormatDDB = new DropDownButton({\n            items: this.getNumFormatDdbItems(id),\n            content: '',\n            select: function (args) { return _this.numDDBSelect(args); },\n            open: function (args) { return _this.numDDBOpen(args); },\n            beforeItemRender: function (args) { return _this.previewNumFormat(args); },\n            close: function () { return _this.parent.element.focus(); },\n            cssClass: 'e-flat e-numformat-ddb',\n            beforeOpen: function (args) { return _this.tBarDdbBeforeOpen(args.element, args.items); }\n        });\n        this.numFormatDDB.createElement = this.parent.createElement;\n        this.numFormatDDB.appendTo(numFormatBtn);\n        return numFormatBtn;\n    };\n    Ribbon.prototype.getFontSizeDDB = function (id) {\n        var _this = this;\n        this.fontSizeDdb = new DropDownButton({\n            cssClass: 'e-font-size-ddb',\n            content: '11',\n            items: [{ text: '8' }, { text: '9' }, { text: '10' }, { text: '11' }, { text: '12' }, { text: '14' }, { text: '16' },\n                { text: '18' }, { text: '20' }, { text: '22' }, { text: '24' }, { text: '26' }, { text: '28' }, { text: '36' },\n                { text: '48' }, { text: '72' }],\n            beforeOpen: function (args) {\n                _this.tBarDdbBeforeOpen(args.element, args.items);\n                _this.refreshSelected(_this.fontSizeDdb, args.element, 'content', 'text');\n            },\n            select: function (args) {\n                var eventArgs = { style: { fontSize: args.item.text + \"pt\" }, onActionUpdate: true };\n                _this.parent.notify(setCellFormat, eventArgs);\n                if (!eventArgs.cancel) {\n                    _this.fontSizeDdb.content = eventArgs.style.fontSize.split('pt')[0];\n                    _this.fontSizeDdb.dataBind();\n                }\n            },\n            close: function () { return _this.parent.element.focus(); }\n        });\n        this.fontSizeDdb.createElement = this.parent.createElement;\n        this.fontSizeDdb.appendTo(this.parent.createElement('button', { id: id + '_font_size' }));\n        return this.fontSizeDdb.element;\n    };\n    // tslint:disable-next-line:max-func-body-length\n    Ribbon.prototype.getChartDBB = function (id) {\n        var _this = this;\n        var l10n = this.parent.serviceLocator.getService(locale);\n        this.chartMenu = new Menu({\n            cssClass: 'e-chart-menu',\n            items: [\n                {\n                    iconCss: 'e-icons e-column', text: l10n.getConstant('Column'),\n                    items: [{ id: 'column_chart' }]\n                },\n                {\n                    iconCss: 'e-icons e-bar', text: l10n.getConstant('Bar'),\n                    items: [{ id: 'bar_chart' }]\n                },\n                {\n                    iconCss: 'e-icons e-area', text: l10n.getConstant('Area'),\n                    items: [{ id: 'area_chart' }]\n                },\n                {\n                    iconCss: 'e-icons e-pie-doughnut', text: l10n.getConstant('PieAndDoughnut'),\n                    items: [{ id: 'pie_doughnut_chart' }]\n                },\n                {\n                    iconCss: 'e-icons e-line', text: l10n.getConstant('Line'),\n                    items: [{ id: 'line_chart' }]\n                },\n                // {\n                //     iconCss: 'e-icons e-radar', text: l10n.getConstant('Radar'),\n                //     items: [{ id: 'radar_chart' }]\n                // },\n                {\n                    iconCss: 'e-icons e-scatter', text: l10n.getConstant('Scatter'),\n                    items: [{ id: 'scatter_chart' }]\n                }\n            ],\n            orientation: 'Vertical',\n            beforeOpen: function (args) {\n                if (args.parentItem.text === l10n.getConstant('Column')) {\n                    args.element.firstChild.appendChild(column);\n                    args.element.parentElement.classList.add('e-column-chart');\n                }\n                else if (args.parentItem.text === l10n.getConstant('Bar')) {\n                    args.element.firstChild.appendChild(bar);\n                    args.element.parentElement.classList.add('e-bar-chart');\n                }\n                else if (args.parentItem.text === l10n.getConstant('Area')) {\n                    args.element.firstChild.appendChild(area);\n                    args.element.parentElement.classList.add('e-area-chart');\n                }\n                else if (args.parentItem.text === l10n.getConstant('Line')) {\n                    args.element.firstChild.appendChild(line);\n                    args.element.parentElement.classList.add('e-line-chart');\n                }\n                else if (args.parentItem.text === l10n.getConstant('PieAndDoughnut')) {\n                    args.element.firstChild.appendChild(pie);\n                    args.element.parentElement.classList.add('e-pie-doughnut-chart');\n                }\n                else if (args.parentItem.text === l10n.getConstant('Radar')) {\n                    args.element.firstChild.appendChild(radar);\n                    args.element.parentElement.classList.add('e-radar-chart');\n                }\n                else if (args.parentItem.text === l10n.getConstant('Scatter')) {\n                    args.element.firstChild.appendChild(scatter);\n                    args.element.parentElement.classList.add('e-scatter-chart');\n                }\n            },\n            select: this.chartSelected.bind(this)\n        });\n        this.chartMenu.createElement = this.parent.createElement;\n        var column = this.parent.createElement('div', { id: 'column_main', className: 'e-column-main' });\n        var column1Text = this.parent.createElement('div', { id: 'column1_text', className: 'e-column1-text', innerHTML: l10n.getConstant('Column') });\n        var column1Cont = this.parent.createElement('div', { id: 'column1_cont', className: 'e-column1-cont' });\n        var column2Text = this.parent.createElement('div', { id: 'column2_text', className: 'e-column2-text' });\n        var column2Cont = this.parent.createElement('div', { id: 'column2_cont', className: 'e-column2-cont' });\n        column.appendChild(column1Text);\n        column.appendChild(column1Cont);\n        //column.appendChild(column2Text);\n        //column.appendChild(column2Cont);\n        var clusteredColumn = this.parent.createElement('span', { id: 'clusteredColumn', className: 'e-clusteredcolumn e-column-icon e-menu-icon e-icons' });\n        var stackedColumn = this.parent.createElement('span', {\n            id: 'stackedColumn', className: 'e-stackedcolumn e-column-icon e-menu-icon e-icons'\n        });\n        var stackedColumn100 = this.parent.createElement('span', {\n            id: 'stackedColumn100', className: 'e-stackedcolumn100 e-column-icon e-menu-icon e-icons'\n        });\n        var clusteredColumn3D = this.parent.createElement('span', {\n            id: 'clusteredColumn3D', className: 'e-clusteredColumn3D e-column-icon'\n        });\n        var stackedColumn3D = this.parent.createElement('span', { id: 'stackedColumn3D', className: 'e-stackedColumn3D e-column-icon' });\n        var stackedColumn1003D = this.parent.createElement('span', { id: 'stackedColumn1003D', className: 'e-stackedColumn1003D e-column-icon' });\n        clusteredColumn.title = l10n.getConstant('ClusteredColumn');\n        stackedColumn.title = l10n.getConstant('StackedColumn');\n        stackedColumn100.title = l10n.getConstant('StackedColumn100');\n        stackedColumn1003D.title = l10n.getConstant('OrangeDataBar');\n        stackedColumn3D.title = l10n.getConstant('LightblueDataBar');\n        clusteredColumn3D.title = l10n.getConstant('PurpleDataBar');\n        column1Cont.appendChild(clusteredColumn);\n        column1Cont.appendChild(stackedColumn);\n        column1Cont.appendChild(stackedColumn100);\n        column2Cont.appendChild(clusteredColumn3D);\n        column2Cont.appendChild(stackedColumn3D);\n        column2Cont.appendChild(stackedColumn1003D);\n        var bar = this.parent.createElement('div', { id: 'bar_main', className: 'e-bar-main' });\n        var bar1Text = this.parent.createElement('div', { id: 'bar1_text', className: 'e-bar1-text', innerHTML: l10n.getConstant('Bar') });\n        var bar1Cont = this.parent.createElement('div', { id: 'bar1_cont', className: 'e-bar1-cont' });\n        var bar2Text = this.parent.createElement('div', { id: 'bar2_text', className: 'e-bar2-text' });\n        var bar2Cont = this.parent.createElement('div', { id: 'bar2_cont', className: 'e-bar2-cont' });\n        bar.appendChild(bar1Text);\n        bar.appendChild(bar1Cont);\n        //bar.appendChild(bar2Text);\n        //bar.appendChild(bar2Cont);\n        var clusteredBar = this.parent.createElement('span', { id: 'clusteredBar', className: 'e-clusteredbar e-bar-icon e-menu-icon e-icons' });\n        var stackedBar = this.parent.createElement('span', { id: 'stackedBar', className: 'e-stackedbar e-bar-icon e-menu-icon e-icons' });\n        var stackedBar100 = this.parent.createElement('span', { id: 'stackedBar100', className: 'e-stackedbar100 e-bar-icon e-menu-icon e-icons' });\n        var clusteredBar3D = this.parent.createElement('span', { id: 'clusteredBar3D', className: 'e-clusteredBar3D e-bar-icon' });\n        var stackedBar3D = this.parent.createElement('span', { id: 'stackedBar3D', className: 'e-stackedBar3D e-bar-icon' });\n        var stackedBar1003D = this.parent.createElement('span', { id: 'stackedBar1003D', className: 'e-stackedBar1003D e-bar-icon' });\n        clusteredBar.title = l10n.getConstant('ClusteredBar');\n        stackedBar.title = l10n.getConstant('StackedBar');\n        stackedBar100.title = l10n.getConstant('StackedBar100');\n        stackedBar1003D.title = l10n.getConstant('OrangeDataBar');\n        stackedBar3D.title = l10n.getConstant('LightblueDataBar');\n        clusteredBar3D.title = l10n.getConstant('PurpleDataBar');\n        bar1Cont.appendChild(clusteredBar);\n        bar1Cont.appendChild(stackedBar);\n        bar1Cont.appendChild(stackedBar100);\n        bar2Cont.appendChild(clusteredBar3D);\n        bar2Cont.appendChild(stackedBar3D);\n        bar2Cont.appendChild(stackedBar1003D);\n        var area = this.parent.createElement('div', { id: 'area_main', className: 'e-area-main' });\n        var areaText = this.parent.createElement('div', { id: 'area_text', className: 'e-area-text', innerHTML: l10n.getConstant('Area') });\n        var areaCont = this.parent.createElement('div', { id: 'area_cont', className: 'e-area-cont' });\n        area.appendChild(areaText);\n        area.appendChild(areaCont);\n        var defArea = this.parent.createElement('span', { id: 'area', className: 'e-area e-area-icon e-menu-icon e-icons' });\n        var stackedArea = this.parent.createElement('span', { id: 'stackedArea', className: 'e-stackedarea e-area-icon e-menu-icon e-icons' });\n        var stackedArea100 = this.parent.createElement('span', { id: 'stackedArea100', className: 'e-stackedarea100 e-area-icon e-menu-icon e-icons' });\n        defArea.title = l10n.getConstant('Area');\n        stackedArea.title = l10n.getConstant('StackedArea');\n        stackedArea100.title = l10n.getConstant('StackedArea100');\n        areaCont.appendChild(defArea);\n        areaCont.appendChild(stackedArea);\n        areaCont.appendChild(stackedArea100);\n        var line = this.parent.createElement('div', { id: 'line_main', className: 'e-line-main' });\n        var lineText = this.parent.createElement('div', { id: 'line_text', className: 'e-line-text', innerHTML: l10n.getConstant('Line') });\n        var lineCont = this.parent.createElement('div', { id: 'line_cont', className: 'e-line-cont' });\n        line.appendChild(lineText);\n        line.appendChild(lineCont);\n        var defLine = this.parent.createElement('span', { id: 'line', className: 'e-line e-line-icon e-menu-icon e-icons' });\n        var stackedLine = this.parent.createElement('span', { id: 'stackedLine', className: 'e-stackedline e-line-icon e-menu-icon e-icons' });\n        var stackedLine100 = this.parent.createElement('span', {\n            id: 'stackedline100', className: 'e-stackedline100 e-line-icon e-menu-icon e-icons'\n        });\n        defLine.title = l10n.getConstant('Line');\n        stackedLine.title = l10n.getConstant('StackedLine');\n        stackedLine100.title = l10n.getConstant('StackedLine100');\n        lineCont.appendChild(defLine);\n        lineCont.appendChild(stackedLine);\n        lineCont.appendChild(stackedLine100);\n        var pie = this.parent.createElement('div', { id: 'pie_main', className: 'e-pie-main' });\n        var pieText = this.parent.createElement('div', { id: 'pie_text', className: 'e-pie-text', innerHTML: l10n.getConstant('Pie') });\n        var pieCont = this.parent.createElement('div', { id: 'pie_cont', className: 'e-pie-cont' });\n        pie.appendChild(pieText);\n        pie.appendChild(pieCont);\n        var defPie = this.parent.createElement('span', { id: 'pie', className: 'e-pie e-pie-icon e-menu-icon e-icons' });\n        var doughnut = this.parent.createElement('span', { id: 'doughnut', className: 'e-doughnut e-pie-icon e-menu-icon e-icons' });\n        defPie.title = l10n.getConstant('Pie');\n        doughnut.title = l10n.getConstant('Doughnut');\n        pieCont.appendChild(defPie);\n        pieCont.appendChild(doughnut);\n        var radar = this.parent.createElement('div', { id: 'radar_main', className: 'e-radar-main' });\n        var radarText = this.parent.createElement('div', { id: 'radar_text', className: 'e-radar-text', innerHTML: 'Radar' });\n        var radarCont = this.parent.createElement('div', { id: 'radar_cont', className: 'e-radar-cont' });\n        radar.appendChild(radarText);\n        radar.appendChild(radarCont);\n        var defradar = this.parent.createElement('span', { id: 'radar', className: 'e-radar e-radar-icon e-menu-icon e-icons' });\n        var radarMarkers = this.parent.createElement('span', { id: 'radar_markers', className: 'e-radar-markers e-radar-icon e-menu-icon e-icons' });\n        defradar.title = l10n.getConstant('BlueDataBar');\n        radarMarkers.title = l10n.getConstant('GreenDataBar');\n        radarCont.appendChild(defradar);\n        radarCont.appendChild(radarMarkers);\n        var scatter = this.parent.createElement('div', { id: 'scatter_main', className: 'e-scatter-main' });\n        var scatterText = this.parent.createElement('div', { id: 'scatter_text', className: 'e-scatter-text', innerHTML: l10n.getConstant('Scatter') });\n        var scatterCont = this.parent.createElement('div', { id: 'scatter_cont', className: 'e-scatter-cont' });\n        scatter.appendChild(scatterText);\n        scatter.appendChild(scatterCont);\n        var defscatter = this.parent.createElement('span', { id: 'scatter', className: 'e-scatter e-scatter-icon e-menu-icon e-icons' });\n        defscatter.title = l10n.getConstant('Scatter');\n        scatterCont.appendChild(defscatter);\n        var ul = this.parent.element.appendChild(this.parent.createElement('ul', {\n            id: id + '_chart_menu', styles: 'display: none;'\n        }));\n        this.chartMenu.appendTo(ul);\n        ul.classList.add('e-ul');\n        this.chartDdb = new DropDownButton({\n            iconCss: 'e-icons e-chart-icon',\n            cssClass: 'e-chart-ddb',\n            target: this.chartMenu.element.parentElement,\n            created: function () { _this.chartMenu.element.style.display = ''; },\n            beforeClose: function (args) {\n                if (args.event && closest(args.event.target, '.e-chart-ddb')) {\n                    args.cancel = true;\n                }\n            },\n            close: function () { return _this.parent.element.focus(); }\n        });\n        this.chartDdb.createElement = this.parent.createElement;\n        var chartBtn = this.parent.createElement('button', { id: id + '_chart-btn' });\n        chartBtn.appendChild(this.parent.createElement('span', { id: id + '_chart', innerHTML: 'Chart' }));\n        this.chartDdb.appendTo(chartBtn);\n        return this.chartDdb.element;\n    };\n    // tslint:disable-next-line:max-func-body-length\n    Ribbon.prototype.getCFDBB = function (id) {\n        var _this = this;\n        var l10n = this.parent.serviceLocator.getService(locale);\n        this.cFMenu = new Menu({\n            cssClass: 'e-cf-menu',\n            items: [{\n                    iconCss: 'e-icons e-hlcellrules', text: l10n.getConstant('HighlightCellsRules'),\n                    items: [{ iconCss: 'e-icons e-greaterthan', id: 'cf_greaterthan', text: l10n.getConstant('GreaterThan') + '...' },\n                        { iconCss: 'e-icons e-lessthan', id: 'cf_lessthan', text: l10n.getConstant('LessThan') + '...' },\n                        { iconCss: 'e-icons e-between', id: 'cf_between', text: l10n.getConstant('Between') + '...' },\n                        { iconCss: 'e-icons e-equalto', id: 'cf_eqaulto', text: l10n.getConstant('CFEqualTo') + '...' }, {\n                            iconCss: 'e-icons e-textcontains', id: 'cf_textthatcontains',\n                            text: l10n.getConstant('TextThatContains') + '...'\n                        }, { iconCss: 'e-icons e-adateoccuring', id: 'cf_adateoccuring', text: l10n.getConstant('ADateOccuring') + '...' }, {\n                            iconCss: 'e-icons e-duplicate', id: 'cf_duplicatevalues',\n                            text: l10n.getConstant('DuplicateValues') + '...'\n                        }]\n                },\n                {\n                    iconCss: 'e-icons e-topbottomrules', text: l10n.getConstant('TopBottomRules'),\n                    items: [{ iconCss: 'e-icons e-top10items', id: 'cf_top10items', text: l10n.getConstant('Top10Items') + '...' },\n                        { iconCss: 'e-icons e-top10', id: 'cf_top10', text: l10n.getConstant('Top10') + ' %...' },\n                        { iconCss: 'e-icons e-bottom10items', id: 'cf_bottom10items', text: l10n.getConstant('Bottom10Items') + '...' },\n                        { iconCss: 'e-icons e-bottom10', id: 'cf_bottom10', text: l10n.getConstant('Bottom10') + ' %...' },\n                        { iconCss: 'e-icons e-aboveaverage', id: 'cf_aboveaverage', text: l10n.getConstant('AboveAverage') + '...' },\n                        { iconCss: 'e-icons e-belowaverage', id: 'cf_belowaverage', text: l10n.getConstant('BelowAverage') + '...' }]\n                },\n                {\n                    iconCss: 'e-icons e-databars', text: l10n.getConstant('DataBars'),\n                    items: [{ id: 'cf_databars' }]\n                },\n                {\n                    iconCss: 'e-icons e-colorscales', text: l10n.getConstant('ColorScales'),\n                    items: [{ id: 'cf_colorscales' }]\n                },\n                {\n                    iconCss: 'e-icons e-iconsets', text: l10n.getConstant('IconSets'),\n                    items: [{ id: 'cf_iconsets' }]\n                },\n                {\n                    iconCss: 'e-icons e-clearrules', text: l10n.getConstant('ClearRules'),\n                    items: [{ id: 'cf_cr_cells', text: l10n.getConstant('SelectedCells') },\n                        { id: 'cf_cr_sheet', text: l10n.getConstant('EntireSheet') }]\n                }],\n            orientation: 'Vertical',\n            beforeOpen: function (args) {\n                if (args.parentItem.text === l10n.getConstant('DataBars')) {\n                    args.element.firstChild.appendChild(dataBars);\n                    args.element.parentElement.classList.add('e-databars');\n                }\n                else if (args.parentItem.text === l10n.getConstant('ColorScales')) {\n                    args.element.firstChild.appendChild(colorScales);\n                    args.element.parentElement.classList.add('e-colorscales');\n                }\n                else if (args.parentItem.text === l10n.getConstant('IconSets')) {\n                    args.element.firstChild.appendChild(iconSets);\n                    args.element.parentElement.classList.add('e-iconsets');\n                }\n            },\n            select: this.cFSelected.bind(this)\n        });\n        var dataBars = this.parent.createElement('div', { id: 'db', className: 'e-db' });\n        var db1 = this.parent.createElement('div', { id: 'db1', className: 'e-db1' });\n        var db2 = this.parent.createElement('div', { id: 'db2', className: 'e-db2' });\n        dataBars.appendChild(db1);\n        dataBars.appendChild(db2);\n        var bBar = this.parent.createElement('span', { id: 'BlueDataBar', className: 'e-bdatabar e-databar-icon' });\n        var gBar = this.parent.createElement('span', { id: 'GreenDataBar', className: 'e-gdatabar e-databar-icon' });\n        var rBar = this.parent.createElement('span', { id: 'RedDataBar', className: 'e-rdatabar e-databar-icon' });\n        var oBar = this.parent.createElement('span', { id: 'OrangeDataBar', className: 'e-odatabar e-databar-icon' });\n        var lBBar = this.parent.createElement('span', { id: 'LightBlueDataBar', className: 'e-lbdatabar e-databar-icon' });\n        var pBar = this.parent.createElement('span', { id: 'PurpleDataBar', className: 'e-pdatabar e-databar-icon' });\n        bBar.title = l10n.getConstant('BlueDataBar');\n        gBar.title = l10n.getConstant('GreenDataBar');\n        rBar.title = l10n.getConstant('RedDataBar');\n        oBar.title = l10n.getConstant('OrangeDataBar');\n        lBBar.title = l10n.getConstant('LightblueDataBar');\n        pBar.title = l10n.getConstant('PurpleDataBar');\n        db1.appendChild(bBar);\n        db1.appendChild(gBar);\n        db1.appendChild(rBar);\n        db2.appendChild(oBar);\n        db2.appendChild(lBBar);\n        db2.appendChild(pBar);\n        this.cFMenu.createElement = this.parent.createElement;\n        var colorScales = this.parent.createElement('div', { id: 'db', className: 'e-cs' });\n        var cs1 = this.parent.createElement('div', { id: 'cs1', className: 'e-cs1' });\n        var cs2 = this.parent.createElement('div', { id: 'cs2', className: 'e-cs2' });\n        var cs3 = this.parent.createElement('div', { id: 'cs3', className: 'e-cs3' });\n        colorScales.appendChild(cs1);\n        colorScales.appendChild(cs2);\n        colorScales.appendChild(cs3);\n        var gyr = this.parent.createElement('span', { id: 'GYRColorScale', className: 'e-gyr e-colorscale-icon' });\n        var ryg = this.parent.createElement('span', { id: 'RYGColorScale', className: 'e-ryg e-colorscale-icon' });\n        var gwr = this.parent.createElement('span', { id: 'GWRColorScale', className: 'e-gwr e-colorscale-icon' });\n        var rwg = this.parent.createElement('span', { id: 'RWGColorScale', className: 'e-rwg e-colorscale-icon' });\n        var bwr = this.parent.createElement('span', { id: 'BWRColorScale', className: 'e-bwr e-colorscale-icon' });\n        var rwb = this.parent.createElement('span', { id: 'RWBColorScale', className: 'e-rwb e-colorscale-icon' });\n        var wr = this.parent.createElement('span', { id: 'WRColorScale', className: 'e-wr e-colorscale-icon' });\n        var rw = this.parent.createElement('span', { id: 'RWColorScale', className: 'e-rw e-colorscale-icon' });\n        var gw = this.parent.createElement('span', { id: 'GWColorScale', className: 'e-gw e-colorscale-icon' });\n        var wg = this.parent.createElement('span', { id: 'WGColorScale', className: 'e-wg e-colorscale-icon' });\n        var gy = this.parent.createElement('span', { id: 'GYColorScale', className: 'e-gy e-colorscale-icon' });\n        var yg = this.parent.createElement('span', { id: 'YGColorScale', className: 'e-yg e-colorscale-icon' });\n        gyr.title = l10n.getConstant('GYRColorScale');\n        ryg.title = l10n.getConstant('RYGColorScale');\n        gwr.title = l10n.getConstant('GWRColorScale');\n        rwg.title = l10n.getConstant('RWGColorScale');\n        bwr.title = l10n.getConstant('BWRColorScale');\n        rwb.title = l10n.getConstant('RWBColorScale');\n        wr.title = l10n.getConstant('WRColorScale');\n        rw.title = l10n.getConstant('RWColorScale');\n        gw.title = l10n.getConstant('GWColorScale');\n        wg.title = l10n.getConstant('WGColorScale');\n        gy.title = l10n.getConstant('GYColorScale');\n        yg.title = l10n.getConstant('YGColorScale');\n        cs1.appendChild(gyr);\n        cs1.appendChild(ryg);\n        cs1.appendChild(gwr);\n        cs1.appendChild(rwg);\n        cs2.appendChild(bwr);\n        cs2.appendChild(rwb);\n        cs2.appendChild(wr);\n        cs2.appendChild(rw);\n        cs3.appendChild(gw);\n        cs3.appendChild(wg);\n        cs3.appendChild(gy);\n        cs3.appendChild(yg);\n        var iconSets = this.parent.createElement('div', { id: 'is', className: 'e-is' });\n        var is1 = this.parent.createElement('div', { id: 'is1', className: 'e-is1', innerHTML: 'Directional' });\n        var is2 = this.parent.createElement('div', { id: 'is2', className: 'e-is2' });\n        var is3 = this.parent.createElement('div', { id: 'is3', className: 'e-is3', innerHTML: 'Shapes' });\n        var is4 = this.parent.createElement('div', { id: 'is4', className: 'e-is4' });\n        var is5 = this.parent.createElement('div', { id: 'is5', className: 'e-is5', innerHTML: 'Indicators' });\n        var is6 = this.parent.createElement('div', { id: 'is6', className: 'e-is6' });\n        var is7 = this.parent.createElement('div', { id: 'is7', className: 'e-is7', innerHTML: 'Ratings' });\n        var is8 = this.parent.createElement('div', { id: 'is8', className: 'e-is8' });\n        is1.title = l10n.getConstant('GYColorScale');\n        is2.title = l10n.getConstant('YGColorScale');\n        is3.title = l10n.getConstant('GYColorScale');\n        is4.title = l10n.getConstant('YGColorScale');\n        is5.title = l10n.getConstant('GYColorScale');\n        is6.title = l10n.getConstant('YGColorScale');\n        is7.title = l10n.getConstant('GYColorScale');\n        is8.title = l10n.getConstant('YGColorScale');\n        iconSets.appendChild(is1);\n        iconSets.appendChild(is2);\n        iconSets.appendChild(is3);\n        iconSets.appendChild(is4);\n        iconSets.appendChild(is5);\n        iconSets.appendChild(is6);\n        iconSets.appendChild(is7);\n        iconSets.appendChild(is8);\n        var directional1 = this.parent.createElement('div', { id: 'ThreeArrows', className: 'e-3arrows e-is-wrapper' });\n        var directional2 = this.parent.createElement('div', { id: 'ThreeArrowsGray', className: 'e-3arrowsgray e-is-wrapper' });\n        var directional3 = this.parent.createElement('div', { id: 'ThreeTriangles', className: 'e-3triangles e-is-wrapper' });\n        var directional4 = this.parent.createElement('div', { id: 'FourArrowsGray', className: 'e-4arrowsgray e-is-wrapper' });\n        var directional5 = this.parent.createElement('div', { id: 'FourArrows', className: 'e-4arrows e-is-wrapper' });\n        var directional6 = this.parent.createElement('div', { id: 'FiveArrowsGray', className: 'e-5arrowsgray e-is-wrapper' });\n        var directional7 = this.parent.createElement('div', { id: 'FiveArrows', className: 'e-5arrows e-is-wrapper' });\n        directional1.title = l10n.getConstant('ThreeArrowsColor');\n        directional2.title = l10n.getConstant('ThreeArrowsGray');\n        directional3.title = l10n.getConstant('ThreeTriangles');\n        directional4.title = l10n.getConstant('FourArrowsColor');\n        directional5.title = l10n.getConstant('FourArrowsGray');\n        directional6.title = l10n.getConstant('FiveArrowsColor');\n        directional7.title = l10n.getConstant('FiveArrowsGray');\n        is2.appendChild(directional1);\n        is2.appendChild(directional2);\n        is2.appendChild(directional3);\n        is2.appendChild(directional4);\n        is2.appendChild(directional5);\n        is2.appendChild(directional6);\n        is2.appendChild(directional7);\n        var shapes1 = this.parent.createElement('div', { id: 'ThreeTrafficLights1', className: 'e-3trafficlights e-is-wrapper' });\n        var shapes2 = this.parent.createElement('div', { id: 'ThreeTrafficLights2', className: 'e-3rafficlights2 e-is-wrapper' });\n        var shapes3 = this.parent.createElement('div', { id: 'ThreeSigns', className: 'e-3signs e-is-wrapper' });\n        var shapes4 = this.parent.createElement('div', { id: 'FourTrafficLights', className: 'e-4trafficlights e-is-wrapper' });\n        var shapes5 = this.parent.createElement('div', { id: 'FourRedToBlack', className: 'e-4redtoblack e-is-wrapper' });\n        shapes1.title = l10n.getConstant('ThreeTrafficLights1');\n        shapes2.title = l10n.getConstant('ThreeTrafficLights2');\n        shapes3.title = l10n.getConstant('ThreeSigns');\n        shapes4.title = l10n.getConstant('FourTrafficLights');\n        shapes5.title = l10n.getConstant('RedToBlack');\n        is4.appendChild(shapes1);\n        is4.appendChild(shapes2);\n        is4.appendChild(shapes3);\n        is4.appendChild(shapes4);\n        is4.appendChild(shapes5);\n        var indicators1 = this.parent.createElement('div', { id: 'ThreeSymbols', className: 'e-3symbols e-is-wrapper' });\n        var indicators2 = this.parent.createElement('div', { id: 'ThreeSymbols2', className: 'e-3symbols2 e-is-wrapper' });\n        var indicators3 = this.parent.createElement('div', { id: 'ThreeFlags', className: 'e-3flags e-is-wrapper' });\n        indicators1.title = l10n.getConstant('ThreeSymbols1');\n        indicators2.title = l10n.getConstant('ThreeSymbols2');\n        indicators3.title = l10n.getConstant('ThreeFlags');\n        is6.appendChild(indicators1);\n        is6.appendChild(indicators2);\n        is6.appendChild(indicators3);\n        var ratings1 = this.parent.createElement('div', { id: 'ThreeStars', className: 'e-3stars e-is-wrapper' });\n        var ratings2 = this.parent.createElement('div', { id: 'FourRating', className: 'e-4rating e-is-wrapper' });\n        var ratings3 = this.parent.createElement('div', { id: 'FiveQuarters', className: 'e-5quarters e-is-wrapper' });\n        var ratings4 = this.parent.createElement('div', { id: 'FiveRating', className: 'e-5rating e-is-wrapper' });\n        var ratings5 = this.parent.createElement('div', { id: 'FiveBoxes', className: 'e-5boxes e-is-wrapper' });\n        ratings1.title = l10n.getConstant('ThreeStars');\n        ratings2.title = l10n.getConstant('FourRatings');\n        ratings3.title = l10n.getConstant('FiveQuarters');\n        ratings4.title = l10n.getConstant('FiveRatings');\n        ratings5.title = l10n.getConstant('FiveBoxes');\n        is8.appendChild(ratings1);\n        is8.appendChild(ratings2);\n        is8.appendChild(ratings3);\n        is8.appendChild(ratings4);\n        is8.appendChild(ratings5);\n        directional1.appendChild(this.createElement('span', 'e-3arrows-1 e-iconsetspan'));\n        directional1.appendChild(this.createElement('span', 'e-3arrows-2 e-iconsetspan'));\n        directional1.appendChild(this.createElement('span', 'e-3arrows-3 e-iconsetspan'));\n        directional2.appendChild(this.createElement('span', 'e-3arrowsgray-1 e-iconsetspan'));\n        directional2.appendChild(this.createElement('span', 'e-3arrowsgray-2 e-iconsetspan'));\n        directional2.appendChild(this.createElement('span', 'e-3arrowsgray-3 e-iconsetspan'));\n        directional3.appendChild(this.createElement('span', 'e-3triangles-1 e-iconsetspan'));\n        directional3.appendChild(this.createElement('span', 'e-3triangles-2 e-iconsetspan'));\n        directional3.appendChild(this.createElement('span', 'e-3triangles-3 e-iconsetspan'));\n        directional4.appendChild(this.createElement('span', 'e-4arrowsgray-1 e-iconsetspan'));\n        directional4.appendChild(this.createElement('span', 'e-4arrowsgray-2 e-iconsetspan'));\n        directional4.appendChild(this.createElement('span', 'e-4arrowsgray-3 e-iconsetspan'));\n        directional4.appendChild(this.createElement('span', 'e-4arrowsgray-4 e-iconsetspan'));\n        directional5.appendChild(this.createElement('span', 'e-4arrows-1 e-iconsetspan'));\n        directional5.appendChild(this.createElement('span', 'e-4arrows-2 e-iconsetspan'));\n        directional5.appendChild(this.createElement('span', 'e-4arrows-3 e-iconsetspan'));\n        directional5.appendChild(this.createElement('span', 'e-4arrows-4 e-iconsetspan'));\n        directional6.appendChild(this.createElement('span', 'e-5arrowsgray-1 e-iconsetspan'));\n        directional6.appendChild(this.createElement('span', 'e-5arrowsgray-2 e-iconsetspan'));\n        directional6.appendChild(this.createElement('span', 'e-5arrowsgray-3 e-iconsetspan'));\n        directional6.appendChild(this.createElement('span', 'e-5arrowsgray-4 e-iconsetspan'));\n        directional6.appendChild(this.createElement('span', 'e-5arrowsgray-5 e-iconsetspan'));\n        directional7.appendChild(this.createElement('span', 'e-5arrows-1 e-iconsetspan'));\n        directional7.appendChild(this.createElement('span', 'e-5arrows-2 e-iconsetspan'));\n        directional7.appendChild(this.createElement('span', 'e-5arrows-3 e-iconsetspan'));\n        directional7.appendChild(this.createElement('span', 'e-5arrows-4 e-iconsetspan'));\n        directional7.appendChild(this.createElement('span', 'e-5arrows-5 e-iconsetspan'));\n        shapes1.appendChild(this.createElement('span', 'e-3trafficlights-1 e-iconsetspan'));\n        shapes1.appendChild(this.createElement('span', 'e-3trafficlights-2 e-iconsetspan'));\n        shapes1.appendChild(this.createElement('span', 'e-3trafficlights-3 e-iconsetspan'));\n        shapes2.appendChild(this.createElement('span', 'e-3rafficlights2-1 e-iconsetspan'));\n        shapes2.appendChild(this.createElement('span', 'e-3rafficlights2-2 e-iconsetspan'));\n        shapes2.appendChild(this.createElement('span', 'e-3rafficlights2-3 e-iconsetspan'));\n        shapes3.appendChild(this.createElement('span', 'e-3signs-1 e-iconsetspan'));\n        shapes3.appendChild(this.createElement('span', 'e-3signs-2 e-iconsetspan'));\n        shapes3.appendChild(this.createElement('span', 'e-3signs-3 e-iconsetspan'));\n        shapes4.appendChild(this.createElement('span', 'e-4trafficlights-1 e-iconsetspan'));\n        shapes4.appendChild(this.createElement('span', 'e-4trafficlights-2 e-iconsetspan'));\n        shapes4.appendChild(this.createElement('span', 'e-4trafficlights-3 e-iconsetspan'));\n        shapes4.appendChild(this.createElement('span', 'e-4trafficlights-4 e-iconsetspan'));\n        shapes5.appendChild(this.createElement('span', 'e-4redtoblack-1 e-iconsetspan'));\n        shapes5.appendChild(this.createElement('span', 'e-4redtoblack-2 e-iconsetspan'));\n        shapes5.appendChild(this.createElement('span', 'e-4redtoblack-3 e-iconsetspan'));\n        shapes5.appendChild(this.createElement('span', 'e-4redtoblack-4 e-iconsetspan'));\n        indicators1.appendChild(this.createElement('span', 'e-3symbols-1 e-iconsetspan'));\n        indicators1.appendChild(this.createElement('span', 'e-3symbols-2 e-iconsetspan'));\n        indicators1.appendChild(this.createElement('span', 'e-3symbols-3 e-iconsetspan'));\n        indicators2.appendChild(this.createElement('span', 'e-3symbols2-1 e-iconsetspan'));\n        indicators2.appendChild(this.createElement('span', 'e-3symbols2-2 e-iconsetspan'));\n        indicators2.appendChild(this.createElement('span', 'e-3symbols2-3 e-iconsetspan'));\n        indicators3.appendChild(this.createElement('span', 'e-3flags-1 e-iconsetspan'));\n        indicators3.appendChild(this.createElement('span', 'e-3flags-2 e-iconsetspan'));\n        indicators3.appendChild(this.createElement('span', 'e-3flags-3 e-iconsetspan'));\n        ratings1.appendChild(this.createElement('span', 'e-3stars-1 e-iconsetspan'));\n        ratings1.appendChild(this.createElement('span', 'e-3stars-2 e-iconsetspan'));\n        ratings1.appendChild(this.createElement('span', 'e-3stars-3 e-iconsetspan'));\n        ratings2.appendChild(this.createElement('span', 'e-4rating-1 e-iconsetspan'));\n        ratings2.appendChild(this.createElement('span', 'e-4rating-2 e-iconsetspan'));\n        ratings2.appendChild(this.createElement('span', 'e-4rating-3 e-iconsetspan'));\n        ratings2.appendChild(this.createElement('span', 'e-4rating-4 e-iconsetspan'));\n        ratings3.appendChild(this.createElement('span', 'e-5quarters-1 e-iconsetspan'));\n        ratings3.appendChild(this.createElement('span', 'e-5quarters-2 e-iconsetspan'));\n        ratings3.appendChild(this.createElement('span', 'e-5quarters-3 e-iconsetspan'));\n        ratings3.appendChild(this.createElement('span', 'e-5quarters-4 e-iconsetspan'));\n        ratings3.appendChild(this.createElement('span', 'e-5quarters-5 e-iconsetspan'));\n        ratings4.appendChild(this.createElement('span', 'e-5rating-1 e-iconsetspan'));\n        ratings4.appendChild(this.createElement('span', 'e-5rating-2 e-iconsetspan'));\n        ratings4.appendChild(this.createElement('span', 'e-5rating-3 e-iconsetspan'));\n        ratings4.appendChild(this.createElement('span', 'e-5rating-4 e-iconsetspan'));\n        ratings4.appendChild(this.createElement('span', 'e-5rating-5 e-iconsetspan'));\n        ratings5.appendChild(this.createElement('span', 'e-5boxes-1 e-iconsetspan'));\n        ratings5.appendChild(this.createElement('span', 'e-5boxes-2 e-iconsetspan'));\n        ratings5.appendChild(this.createElement('span', 'e-5boxes-3 e-iconsetspan'));\n        ratings5.appendChild(this.createElement('span', 'e-5boxes-4 e-iconsetspan'));\n        ratings5.appendChild(this.createElement('span', 'e-5boxes-5 e-iconsetspan'));\n        var ul = this.parent.element.appendChild(this.parent.createElement('ul', {\n            id: id + '_cf_menu', styles: 'display: none;'\n        }));\n        this.cFMenu.appendTo(ul);\n        ul.classList.add('e-ul');\n        this.cFDdb = new DropDownButton({\n            iconCss: 'e-icons e-conditionalformatting-icon',\n            cssClass: 'e-cf-ddb',\n            target: this.cFMenu.element.parentElement,\n            created: function () { _this.cFMenu.element.style.display = ''; },\n            beforeClose: function (args) {\n                if (args.event && closest(args.event.target, '.e-cf-ddb')) {\n                    args.cancel = true;\n                }\n            },\n            close: function () { return _this.parent.element.focus(); }\n        });\n        this.cFDdb.createElement = this.parent.createElement;\n        this.cFDdb.appendTo(this.parent.createElement('button', { id: id + '_conditionalformatting' }));\n        return this.cFDdb.element;\n    };\n    Ribbon.prototype.createElement = function (tag, className, id) {\n        return this.parent.createElement(tag, { className: className });\n    };\n    Ribbon.prototype.getBordersDBB = function (id) {\n        var _this = this;\n        var cPickerWrapper;\n        var l10n = this.parent.serviceLocator.getService(locale);\n        this.bordersMenu = new Menu({\n            cssClass: 'e-borders-menu',\n            items: [{ iconCss: 'e-icons e-top-borders', text: l10n.getConstant('TopBorders') }, {\n                    iconCss: 'e-icons e-left-borders',\n                    text: l10n.getConstant('LeftBorders')\n                }, { iconCss: 'e-icons e-right-borders', text: l10n.getConstant('RightBorders') }, {\n                    iconCss: 'e-icons e-bottom-borders', text: l10n.getConstant('BottomBorders')\n                }, {\n                    iconCss: 'e-icons e-all-borders', text: l10n.getConstant('AllBorders')\n                }, { iconCss: 'e-icons e-horizontal-borders', text: l10n.getConstant('HorizontalBorders') }, {\n                    iconCss: 'e-icons e-vertical-borders', text: l10n.getConstant('VerticalBorders')\n                }, {\n                    iconCss: 'e-icons e-outside-borders',\n                    text: l10n.getConstant('OutsideBorders')\n                }, { iconCss: 'e-icons e-inside-borders', text: l10n.getConstant('InsideBorders') },\n                { iconCss: 'e-icons e-no-borders', text: l10n.getConstant('NoBorders') }, { separator: true }, {\n                    text: l10n.getConstant('BorderColor'), items: [{ id: id + \"_border_colors\" }]\n                }, {\n                    text: l10n.getConstant('BorderStyle'), items: [\n                        { iconCss: 'e-icons e-selected-icon', id: id + \"_1px\" }, { id: id + \"_2px\" },\n                        { id: id + \"_3px\" }, { id: id + \"_dashed\" },\n                        { id: id + \"_dotted\" }, { id: id + \"_double\" }\n                    ]\n                }],\n            orientation: 'Vertical',\n            beforeOpen: function (args) {\n                if (args.parentItem.text === 'Border Color') {\n                    _this.colorPicker.refresh();\n                    cPickerWrapper = _this.colorPicker.element.parentElement;\n                    args.element.firstElementChild.appendChild(cPickerWrapper);\n                    cPickerWrapper.style.display = 'inline-block';\n                    args.element.parentElement.classList.add('e-border-color');\n                }\n                else {\n                    args.element.classList.add('e-border-style');\n                }\n            },\n            beforeClose: function (args) {\n                if (args.parentItem.text === 'Border Color') {\n                    if (!closest(args.event.target, '.e-border-colorpicker') ||\n                        closest(args.event.target, '.e-apply') || closest(args.event.target, '.e-cancel')) {\n                        _this.colorPicker = getComponent(cPickerEle, 'colorpicker');\n                        if (_this.colorPicker.mode === 'Picker') {\n                            _this.colorPicker.mode = 'Palette';\n                            _this.colorPicker.dataBind();\n                        }\n                        cPickerWrapper.style.display = '';\n                        _this.parent.element.appendChild(cPickerWrapper);\n                    }\n                    else {\n                        args.cancel = true;\n                    }\n                }\n            },\n            onOpen: function (args) {\n                if (args.parentItem.text === 'Border Color') {\n                    args.element.parentElement.style.overflow = 'visible';\n                }\n            },\n            select: this.borderSelected.bind(this)\n        });\n        this.bordersMenu.createElement = this.parent.createElement;\n        var ul = this.parent.element.appendChild(this.parent.createElement('ul', {\n            id: id + '_borders_menu', styles: 'display: none;'\n        }));\n        this.bordersMenu.appendTo(ul);\n        ul.classList.add('e-ul');\n        var cPickerEle = this.parent.createElement('input', { id: id + \"_cell_border_color\", attrs: { 'type': 'color' } });\n        this.parent.element.appendChild(cPickerEle);\n        this.colorPicker = new ColorPicker({\n            cssClass: 'e-border-colorpicker',\n            mode: 'Palette',\n            inline: true,\n            change: function (args) {\n                var border = _this.border.split(' ');\n                border[2] = args.currentValue.hex;\n                _this.border = border.join(' ');\n            },\n            created: function () { cPickerWrapper = _this.colorPicker.element.parentElement; }\n        });\n        this.colorPicker.createElement = this.parent.createElement;\n        this.colorPicker.appendTo(cPickerEle);\n        this.bordersDdb = new DropDownButton({\n            iconCss: 'e-icons e-bottom-borders',\n            cssClass: 'e-borders-ddb',\n            target: this.bordersMenu.element.parentElement,\n            created: function () { _this.bordersMenu.element.style.display = ''; },\n            beforeOpen: function (args) { return _this.tBarDdbBeforeOpen(args.element.firstElementChild, _this.bordersMenu.items, 1); },\n            beforeClose: function (args) {\n                if (args.event && closest(args.event.target, '.e-borders-menu')) {\n                    args.cancel = true;\n                }\n            },\n            close: function () { return _this.parent.element.focus(); }\n        });\n        this.bordersDdb.createElement = this.parent.createElement;\n        this.bordersDdb.appendTo(this.parent.createElement('button', { id: id + '_borders' }));\n        return this.bordersDdb.element;\n    };\n    Ribbon.prototype.chartSelected = function (args) {\n        var eleId = args.element.id;\n        if (('column_chart' + 'bar_chart' + 'area_chart' + 'pie_doughnut_chart' +\n            'line_chart' + 'radar_chart' + 'scatter_chart').includes(eleId)) {\n            var id = args.event.target.id;\n            this.parent.notify(insertChart, { action: eleId, id: id });\n        }\n    };\n    Ribbon.prototype.cFSelected = function (args) {\n        var eleId = args.element.id;\n        if (('cf_greaterthan' + 'cf_lessthan' + 'cf_between' + 'cf_eqaulto' + 'cf_textthatcontains' +\n            'cf_adateoccuring' + 'cf_duplicatevalues' + 'cf_top10items' + 'cf_top10' + 'cf_bottom10items' +\n            'cf_bottom10' + 'cf_aboveaverage' + 'cf_belowaverage').includes(eleId)) {\n            this.parent.notify(initiateConditionalFormat, { action: args.item.text });\n        }\n        else if (('cf_databars' + 'cf_colorscales').includes(eleId)) {\n            var id = args.event.target.id;\n            this.parent.notify(setCF, { action: eleId, id: id });\n        }\n        else if ('cf_iconsets' === args.element.id) {\n            var target = args.event.target;\n            var iconName = (target.id === '') ? target.parentElement.id : target.id;\n            this.parent.notify(setCF, { action: eleId, id: iconName });\n        }\n        if (eleId === 'cf_cr_cells') {\n            this.parent.notify(clearCFRule, { range: this.parent.getActiveSheet().selectedRange, isPublic: false });\n        }\n        else if (eleId === 'cf_cr_sheet') {\n            var sheet = this.parent.getActiveSheet();\n            var range = getRangeAddress([0, 0, sheet.rowCount - 1, sheet.colCount - 1]);\n            this.parent.conditionalFormat = null;\n            this.parent.notify(clearCFRule, { range: range, isPublic: false });\n        }\n    };\n    Ribbon.prototype.borderSelected = function (args) {\n        if (args.item.items.length || args.item.id === this.parent.element.id + \"_border_colors\") {\n            return;\n        }\n        if (!args.item.text) {\n            var id = this.parent.element.id;\n            var border = this.border.split(' ');\n            var prevStyleId_1 = border[1] === 'solid' ? id + \"_\" + border[0] : id + \"_\" + border[1];\n            if (prevStyleId_1 === args.item.id) {\n                return;\n            }\n            if (args.item.id === id + \"_1px\" || args.item.id === id + \"_2px\" || args.item.id === id + \"_3px\") {\n                border[0] = args.item.id.split(id + \"_\")[1];\n                border[1] = 'solid';\n            }\n            else {\n                border[1] = args.item.id.split(id + \"_\")[1];\n                border[0] = border[1] === 'double' ? '3px' : '1px';\n            }\n            this.border = border.join(' ');\n            this.bordersMenu.items[12].items.forEach(function (item) {\n                if (item.id === prevStyleId_1) {\n                    item.iconCss = null;\n                }\n                if (item.id === args.item.id) {\n                    item.iconCss = 'e-icons e-selected-icon';\n                }\n            });\n            this.bordersMenu.setProperties({ 'items': this.bordersMenu.items }, true);\n            return;\n        }\n        this.bordersDdb.toggle();\n        this.parent.showSpinner();\n        switch (args.item.text) {\n            case 'Top Borders':\n                this.parent.notify(setCellFormat, { style: { borderTop: this.border }, onActionUpdate: true });\n                break;\n            case 'Left Borders':\n                this.parent.notify(setCellFormat, { style: { borderLeft: this.border }, onActionUpdate: true });\n                break;\n            case 'Right Borders':\n                this.parent.notify(setCellFormat, { style: { borderRight: this.border }, onActionUpdate: true });\n                break;\n            case 'Bottom Borders':\n                this.parent.notify(setCellFormat, { style: { borderBottom: this.border }, onActionUpdate: true });\n                break;\n            case 'All Borders':\n                this.parent.notify(setCellFormat, { style: { border: this.border }, onActionUpdate: true });\n                break;\n            case 'Horizontal Borders':\n                this.parent.notify(setCellFormat, { style: { border: this.border }, onActionUpdate: true, borderType: 'Horizontal' });\n                break;\n            case 'Vertical Borders':\n                this.parent.notify(setCellFormat, { style: { border: this.border }, onActionUpdate: true, borderType: 'Vertical' });\n                break;\n            case 'Outside Borders':\n                this.parent.notify(setCellFormat, { style: { border: this.border }, onActionUpdate: true, borderType: 'Outer' });\n                break;\n            case 'Inside Borders':\n                this.parent.notify(setCellFormat, { style: { border: this.border }, onActionUpdate: true, borderType: 'Inner' });\n                break;\n            case 'No Borders':\n                this.parent.notify(setCellFormat, { style: { border: '' }, onActionUpdate: true });\n                break;\n        }\n        this.parent.hideSpinner();\n    };\n    Ribbon.prototype.getFontNameDDB = function (id) {\n        var _this = this;\n        var fontNameBtn = this.parent.createElement('button', { id: id + '_font_name' });\n        fontNameBtn.appendChild(this.parent.createElement('span', { className: 'e-tbar-btn-text', innerHTML: 'Calibri' }));\n        this.fontNameDdb = new DropDownButton({\n            cssClass: 'e-font-family',\n            items: this.getFontFamilyItems(),\n            select: function (args) {\n                var eventArgs = { style: { fontFamily: args.item.text }, onActionUpdate: true };\n                _this.parent.notify(setCellFormat, eventArgs);\n                if (!eventArgs.cancel) {\n                    _this.refreshFontNameSelection(eventArgs.style.fontFamily);\n                }\n            },\n            close: function () { return _this.parent.element.focus(); },\n            beforeOpen: function (args) { return _this.tBarDdbBeforeOpen(args.element, args.items); }\n        });\n        this.fontNameDdb.createElement = this.parent.createElement;\n        this.fontNameDdb.appendTo(fontNameBtn);\n        return fontNameBtn;\n    };\n    Ribbon.prototype.getBtn = function (id, name, bindEvent) {\n        if (bindEvent === void 0) { bindEvent = true; }\n        var btnObj = new Button({ iconCss: \"e-icons e-\" + name + \"-icon\", isToggle: true });\n        btnObj.createElement = this.parent.createElement;\n        btnObj.appendTo(this.parent.createElement('button', { id: id + \"_\" + name }));\n        if (bindEvent) {\n            btnObj.element.addEventListener('click', this.toggleBtnClicked.bind(this));\n        }\n        return btnObj.element;\n    };\n    Ribbon.prototype.datavalidationDDB = function (id) {\n        var _this = this;\n        var l10n = this.parent.serviceLocator.getService(locale);\n        this.datavalidationDdb = new DropDownButton({\n            cssClass: 'e-datavalidation-ddb',\n            iconCss: 'e-datavalidation-icon e-icons',\n            items: [\n                { text: l10n.getConstant('DataValidation') },\n                { text: l10n.getConstant('HighlightInvalidData') },\n                { text: l10n.getConstant('ClearHighlight') },\n                { text: l10n.getConstant('ClearValidation') }\n            ],\n            beforeOpen: function (args) {\n                _this.refreshSelected(_this.datavalidationDdb, args.element, 'iconCss');\n            },\n            select: function (args) {\n                switch (args.item.text) {\n                    case l10n.getConstant('DataValidation'):\n                        _this.parent.notify(initiateDataValidation, null);\n                        break;\n                    case l10n.getConstant('HighlightInvalidData'):\n                        _this.parent.notify(invalidData, { isRemoveHighlight: false });\n                        break;\n                    case l10n.getConstant('ClearHighlight'):\n                        _this.parent.notify(invalidData, { isRemoveHighlight: true });\n                        break;\n                    case l10n.getConstant('ClearValidation'):\n                        _this.parent.notify(removeDataValidation, null);\n                        break;\n                    default:\n                        var direction = args.item.text === l10n.getConstant('SortAscending') ? 'Ascending' : 'Descending';\n                        _this.parent.notify(applySort, { sortOptions: { sortDescriptors: { order: direction } } });\n                        break;\n                }\n            },\n            close: function () { return _this.parent.element.focus(); }\n        });\n        this.datavalidationDdb.createElement = this.parent.createElement;\n        this.datavalidationDdb.appendTo(this.parent.createElement('button', { id: id + '_datavalidation' }));\n        return this.datavalidationDdb.element;\n    };\n    Ribbon.prototype.getTextAlignDDB = function (id) {\n        var _this = this;\n        this.textAlignDdb = new DropDownButton({\n            cssClass: 'e-align-ddb',\n            iconCss: 'e-icons e-left-icon',\n            items: [{ iconCss: 'e-icons e-left-icon' }, { iconCss: 'e-icons e-center-icon' }, { iconCss: 'e-icons e-right-icon' }],\n            beforeItemRender: this.alignItemRender.bind(this),\n            beforeOpen: function (args) {\n                _this.refreshSelected(_this.textAlignDdb, args.element, 'iconCss');\n            },\n            select: function (args) {\n                var eventArgs = {\n                    style: { textAlign: args.item.iconCss.split(' e-')[1].split('-icon')[0] }, onActionUpdate: true\n                };\n                _this.parent.notify(setCellFormat, eventArgs);\n                if (!eventArgs.cancel) {\n                    _this.textAlignDdb.iconCss = \"e-icons e-\" + eventArgs.style.textAlign + \"-icon\";\n                    _this.textAlignDdb.dataBind();\n                }\n            },\n            close: function () { return _this.parent.element.focus(); }\n        });\n        this.textAlignDdb.createElement = this.parent.createElement;\n        this.textAlignDdb.appendTo(this.parent.createElement('button', { id: id + '_text_align' }));\n        return this.textAlignDdb.element;\n    };\n    Ribbon.prototype.getVerticalAlignDDB = function (id) {\n        var _this = this;\n        this.verticalAlignDdb = new DropDownButton({\n            cssClass: 'e-align-ddb',\n            iconCss: 'e-icons e-bottom-icon',\n            items: [{ iconCss: 'e-icons e-top-icon' }, { iconCss: 'e-icons e-middle-icon' }, { iconCss: 'e-icons e-bottom-icon' }],\n            beforeItemRender: this.alignItemRender.bind(this),\n            beforeOpen: function (args) {\n                _this.refreshSelected(_this.verticalAlignDdb, args.element, 'iconCss');\n            },\n            select: function (args) {\n                var eventArgs = {\n                    style: { verticalAlign: args.item.iconCss.split(' e-')[1].split('-icon')[0] }, onActionUpdate: true\n                };\n                _this.parent.notify(setCellFormat, eventArgs);\n                if (!eventArgs.cancel) {\n                    _this.verticalAlignDdb.iconCss = \"e-icons e-\" + eventArgs.style.verticalAlign + \"-icon\";\n                    _this.verticalAlignDdb.dataBind();\n                }\n            },\n            close: function () { return _this.parent.element.focus(); }\n        });\n        this.verticalAlignDdb.createElement = this.parent.createElement;\n        this.verticalAlignDdb.appendTo(this.parent.createElement('button', { id: id + '_vertical_align' }));\n        return this.verticalAlignDdb.element;\n    };\n    Ribbon.prototype.getMergeSplitBtn = function (id) {\n        var _this = this;\n        this.parent.element.appendChild(this.parent.createElement('button', { id: id + '_merge' }));\n        var l10n = this.parent.serviceLocator.getService(locale);\n        this.mergeSplitBtn = new SplitButton({\n            cssClass: 'e-merge-ddb',\n            iconCss: 'e-icons e-merge-icon',\n            items: [{ text: l10n.getConstant('MergeAll'), id: id + \"_merge_all\" }, { text: l10n.getConstant('MergeHorizontally'), id: id + \"_merge_horizontally\" }, { text: l10n.getConstant('MergeVertically'), id: id + \"_merge_vertically\" },\n                { separator: true, id: id + \"_merge_separator\" }, { text: l10n.getConstant('Unmerge'), id: id + \"_unmerge\" }],\n            select: this.mergeSelectHandler.bind(this),\n            close: function () { return _this.parent.element.focus(); },\n            click: function (args) {\n                if (args.element.classList.contains('e-active')) {\n                    _this.toggleActiveState(false);\n                    _this.unMerge();\n                }\n                else {\n                    _this.toggleActiveState(true);\n                    _this.merge(_this.parent.element.id + \"_merge_all\");\n                }\n            },\n            created: function () {\n                _this.mergeSplitBtn.element.title = l10n.getConstant('MergeCells');\n                _this.mergeSplitBtn.element.nextElementSibling.title = l10n.getConstant('SelectMergeType');\n            }\n        });\n        this.mergeSplitBtn.createElement = this.parent.createElement;\n        this.mergeSplitBtn.appendTo('#' + id + '_merge');\n        return this.mergeSplitBtn.element.parentElement;\n    };\n    Ribbon.prototype.mergeSelectHandler = function (args) {\n        args.item.id === this.parent.element.id + \"_unmerge\" ? this.unMerge() : this.merge(args.item.id);\n    };\n    Ribbon.prototype.unMerge = function () {\n        this.parent.showSpinner();\n        this.parent.notify(setMerge, { merge: false, range: this.parent.getActiveSheet().selectedRange,\n            isAction: true, refreshRibbon: true, type: 'All' });\n        this.parent.hideSpinner();\n    };\n    Ribbon.prototype.merge = function (itemId) {\n        var _this = this;\n        var sheet = this.parent.getActiveSheet();\n        var indexes = getRangeIndexes(sheet.selectedRange);\n        var cell;\n        var isDataPresent;\n        for (var i = indexes[0]; i <= indexes[2]; i++) {\n            for (var j = indexes[1]; j <= indexes[3]; j++) {\n                if (i === indexes[0] && j === indexes[1] && itemId.includes('merge_all')) {\n                    continue;\n                }\n                if (i === indexes[0] && itemId.includes('merge_vertically')) {\n                    continue;\n                }\n                if (j === indexes[1] && itemId.includes('_merge_horizontally')) {\n                    continue;\n                }\n                cell = getCell(i, j, sheet) || {};\n                if (cell.value || cell.formula) {\n                    isDataPresent = true;\n                }\n            }\n        }\n        if (!isDataPresent) {\n            this.performMerge(itemId);\n            return;\n        }\n        var dialogInst = this.parent.serviceLocator.getService(dialog);\n        dialogInst.show({\n            target: this.parent.element, height: 200, width: 400, isModal: true, showCloseIcon: true,\n            content: this.parent.serviceLocator.getService(locale).getConstant('MergeCellsAlert'),\n            beforeOpen: function (args) {\n                var dlgArgs = {\n                    dialogName: 'MergeAlertDialog',\n                    element: args.element, target: args.target, cancel: args.cancel\n                };\n                _this.parent.trigger('dialogBeforeOpen', dlgArgs);\n                if (dlgArgs.cancel) {\n                    args.cancel = true;\n                }\n                _this.parent.element.focus();\n            },\n            buttons: [{\n                    buttonModel: { content: this.parent.serviceLocator.getService(locale).getConstant('Ok'), isPrimary: true },\n                    click: function () { dialogInst.hide(); _this.performMerge(itemId); }\n                }]\n        });\n    };\n    Ribbon.prototype.performMerge = function (itemId) {\n        var id = this.parent.element.id;\n        this.parent.showSpinner();\n        switch (itemId) {\n            case id + \"_merge_all\":\n                this.parent.notify(setMerge, { merge: true, range: this.parent.getActiveSheet().selectedRange,\n                    type: 'All', isAction: true, refreshRibbon: true });\n                break;\n            case id + \"_merge_horizontally\":\n                this.parent.notify(setMerge, { merge: true, range: this.parent.getActiveSheet().selectedRange,\n                    type: 'Horizontally', isAction: true });\n                break;\n            case id + \"_merge_vertically\":\n                this.parent.notify(setMerge, { merge: true, range: this.parent.getActiveSheet().selectedRange,\n                    type: 'Vertically', isAction: true });\n                break;\n        }\n        this.parent.hideSpinner();\n    };\n    Ribbon.prototype.getSortFilterDDB = function (id) {\n        var _this = this;\n        var l10n = this.parent.serviceLocator.getService(locale);\n        this.sortingDdb = new DropDownButton({\n            cssClass: 'e-sort-filter-ddb',\n            iconCss: 'e-icons e-sort-filter-icon',\n            items: [\n                { text: l10n.getConstant('SortAscending'), iconCss: 'e-icons e-sort-asc' },\n                { text: l10n.getConstant('SortDescending'), iconCss: 'e-icons e-sort-desc' },\n                { text: l10n.getConstant('CustomSort') + '...', iconCss: 'e-icons e-sort-custom' },\n                { separator: true },\n                { text: l10n.getConstant('Filter'), iconCss: 'e-icons e-filter-apply', id: id + '_applyfilter' },\n                { text: l10n.getConstant('ClearAllFilter'), iconCss: 'e-icons e-filter-clear', id: id + '_clearfilter' },\n                { text: l10n.getConstant('ReapplyFilter'), iconCss: 'e-icons e-filter-reapply', id: id + '_reapplyfilter' }\n            ],\n            beforeItemRender: function (args) {\n                var eventArgs = { isFiltered: false, isClearAll: true };\n                _this.parent.notify(getFilteredColumn, eventArgs);\n                if (args.item.id === id + '_clearfilter' || args.item.id === id + '_reapplyfilter') {\n                    if (!eventArgs.isFiltered) {\n                        args.element.classList.add('e-disabled');\n                    }\n                    else {\n                        args.element.classList.remove('e-disabled');\n                    }\n                }\n            },\n            beforeOpen: function (args) {\n                _this.refreshSelected(_this.sortingDdb, args.element, 'iconCss');\n            },\n            select: function (args) {\n                switch (args.item.text) {\n                    case l10n.getConstant('Filter'):\n                        _this.parent.applyFilter();\n                        break;\n                    case l10n.getConstant('ClearAllFilter'):\n                        _this.parent.clearFilter();\n                        break;\n                    case l10n.getConstant('ReapplyFilter'):\n                        _this.parent.notify(reapplyFilter, null);\n                        break;\n                    case l10n.getConstant('CustomSort') + '...':\n                        _this.parent.notify(initiateCustomSort, null);\n                        break;\n                    default:\n                        var direction = args.item.text === l10n.getConstant('SortAscending') ? 'Ascending' : 'Descending';\n                        _this.parent.notify(applySort, { sortOptions: { sortDescriptors: { order: direction } } });\n                        break;\n                }\n            },\n            close: function () { return _this.parent.element.focus(); }\n        });\n        this.sortingDdb.createElement = this.parent.createElement;\n        this.sortingDdb.appendTo(this.parent.createElement('button', { id: id + '_sorting' }));\n        return this.sortingDdb.element;\n    };\n    Ribbon.prototype.getFindDDb = function (id) {\n        var _this = this;\n        var findToolbtn = this.parent.createElement('button', { id: id + '_findbtn' });\n        this.findDdb = new Button({\n            cssClass: 'e-spreadsheet-find-ddb e-caret-hide',\n            iconCss: 'e-icons e-search-icon'\n        });\n        this.findDdb.createElement = this.parent.createElement;\n        this.findDdb.appendTo(findToolbtn);\n        findToolbtn.onclick = function () {\n            _this.findToolDlg();\n        };\n        return this.findDdb.element;\n    };\n    Ribbon.prototype.findToolDlg = function () {\n        var _this = this;\n        var countArgs;\n        if (isNullOrUndefined(this.parent.element.querySelector('.e-findtool-dlg'))) {\n            var toolbarObj_1;\n            var findTextElement = this.parent.createElement('div', { className: 'e-input-group' });\n            var findTextInput = this.parent.createElement('input', {\n                className: 'e-input e-text-findNext-short', attrs: { 'type': 'Text', value: this.findValue },\n            });\n            findTextInput.setAttribute('placeholder', 'FindValue');\n            var findSpan_1 = this.parent.createElement('span', { className: 'e-input-group-icon' });\n            findTextInput.onkeyup = function () {\n                countArgs = { countOpt: 'count', findCount: '' };\n                _this.parent.notify(findHandler, { countArgs: countArgs });\n                findSpan_1.textContent = countArgs.findCount;\n                var element = document.querySelector('.e-text-findNext-short');\n                var value = element.value;\n                var nextElement = document.querySelector('.e-findRib-next');\n                var prevElement = document.querySelector('.e-findRib-prev');\n                if (isNullOrUndefined(value) || (value === '') || (countArgs.findCount === '0 of 0')) {\n                    toolbarObj_1.enableItems(nextElement, false);\n                    toolbarObj_1.enableItems(prevElement, false);\n                    findSpan_1.textContent = '0 of 0';\n                }\n                else if (!isNullOrUndefined(value) || (countArgs.findCount !== '0 of 0')) {\n                    toolbarObj_1.enableItems(nextElement, true);\n                    toolbarObj_1.enableItems(prevElement, true);\n                }\n            };\n            findTextInput.onkeydown = function (e) {\n                countArgs = { countOpt: 'count', findCount: '' };\n                _this.parent.notify(findHandler, { countArgs: countArgs });\n                var count = countArgs.findCount;\n                _this.findOnKeyDown(e, count);\n            };\n            findTextElement.appendChild(findTextInput);\n            findTextElement.appendChild(findSpan_1);\n            var toolItemModel = [\n                { type: 'Input', template: findTextElement },\n                {\n                    prefixIcon: 'e-icons e-prev-icon', tooltipText: 'Find Previous', type: 'Button', cssClass: 'e-findRib-prev',\n                    disabled: true\n                },\n                { prefixIcon: 'e-icons e-next-icon', tooltipText: 'Find Next', type: 'Button', cssClass: 'e-findRib-next', disabled: true },\n                { type: 'Separator' },\n                { prefixIcon: 'e-icons e-option-icon', tooltipText: 'More Options', type: 'Button', cssClass: 'e-findRib-more' },\n                { prefixIcon: 'e-icons e-close', tooltipText: 'Close', type: 'Button', cssClass: 'e-findRib-close' }\n            ];\n            toolbarObj_1 = new Toolbar({\n                clicked: function (args) {\n                    if (args.item.cssClass === 'e-findRib-next') {\n                        _this.parent.notify(findHandler, { findOption: 'next' });\n                        countArgs = { countOpt: 'count', findCount: '' };\n                        _this.parent.notify(findHandler, { countArgs: countArgs });\n                        findSpan_1.textContent = countArgs.findCount;\n                    }\n                    else if (args.item.cssClass === 'e-findRib-prev') {\n                        _this.parent.notify(findHandler, { findOption: 'prev' });\n                        countArgs = { countOpt: 'count', findCount: '' };\n                        _this.parent.notify(findHandler, { countArgs: countArgs });\n                        findSpan_1.textContent = countArgs.findCount;\n                    }\n                    else if (args.item.cssClass === 'e-findRib-more') {\n                        _this.parent.notify(findDlg, null);\n                        _this.findDialog.hide();\n                    }\n                }, width: 'auto', height: 'auto', items: toolItemModel, cssClass: 'e-find-toolObj'\n            });\n            var toolbarElement_1 = this.parent.createElement('div', { className: 'e-find-toolbar' });\n            var dialogDiv = this.parent.createElement('div', { className: 'e-dlg-div' });\n            this.findDialog = new FindDialog({\n                isModal: false, showCloseIcon: false, cssClass: 'e-findtool-dlg', content: toolbarElement_1, visible: false,\n                allowDragging: true, target: this.parent.element.querySelector('.e-main-panel'),\n                beforeOpen: function () {\n                    EventHandler.add(document, 'click', _this.closeDialog, _this);\n                },\n                open: function () {\n                    _this.textFocus(toolbarObj_1.element);\n                },\n                beforeClose: function () {\n                    _this.findValue = _this.parent.element.querySelector('.e-text-findNext-short').value;\n                    toolbarObj_1.destroy();\n                    var element = document.querySelector('.e-find-toolbar');\n                    EventHandler.remove(element, 'focus', _this.textFocus);\n                    EventHandler.remove(document, 'click', _this.closeDialog);\n                    _this.parent.element.focus();\n                },\n                created: function () {\n                    toolbarObj_1.createElement = _this.parent.createElement;\n                    toolbarObj_1.appendTo(toolbarElement_1);\n                    _this.findDialog.width = getComputedStyle(document.querySelector('.e-findtool-dlg')).width;\n                    var calculate = _this.parent.element.querySelector('.e-main-panel').getBoundingClientRect();\n                    var dialogWidth = _this.findDialog.width;\n                    var rightValue = calculate.width - parseInt(dialogWidth.toString(), 10) - 14; /** 14- width of scroll bar */\n                    /** 31- height of sheetHeader */\n                    var topValue = _this.parent.sheets[_this.parent.activeSheetIndex].showHeaders ? 31 : 0;\n                    _this.findDialog.position = { X: rightValue, Y: topValue };\n                    _this.findDialog.dataBind();\n                    _this.findDialog.show();\n                },\n            });\n            this.findDialog.createElement = this.parent.createElement;\n            this.findDialog.appendTo(dialogDiv);\n        }\n        else {\n            if (!isNullOrUndefined(this.parent.element.querySelector('.e-findtool-dlg'))) {\n                this.findDialog.hide();\n                detach(this.parent.element.querySelector('.e-findtool-dlg'));\n                this.findDialog = null;\n                this.parent.element.focus();\n            }\n        }\n    };\n    Ribbon.prototype.findOnKeyDown = function (e, count) {\n        if (document.querySelector('.e-text-findNext-short').value) {\n            if (count !== '0 of 0') {\n                if (e.shiftKey) {\n                    if (e.keyCode === 13) {\n                        var buttonArgs = { findOption: 'prev' };\n                        this.parent.notify(findHandler, buttonArgs);\n                    }\n                }\n                else if (e.keyCode === 13) {\n                    var buttonArg = { findOption: 'next' };\n                    this.parent.notify(findHandler, buttonArg);\n                }\n            }\n        }\n    };\n    Ribbon.prototype.closeDialog = function (e) {\n        if ((closest(e.target, '.e-findRib-close')) || (!closest(e.target, '.e-spreadsheet'))) {\n            if (!isNullOrUndefined(this.findDialog)) {\n                this.findDialog.hide();\n                detach(this.parent.element.querySelector('.e-findtool-dlg'));\n                this.findDialog = null;\n            }\n        }\n    };\n    Ribbon.prototype.textFocus = function (element) {\n        element = document.querySelector('.e-find-toolbar');\n        element.addEventListener('focus', function () {\n            var elements = document.querySelector('.e-text-findNext-short');\n            elements.focus();\n            elements.classList.add('e-input-focus');\n            (elements).setSelectionRange(0, elements.value.length);\n        });\n    };\n    Ribbon.prototype.getClearDDB = function (id) {\n        var _this = this;\n        var l10n = this.parent.serviceLocator.getService(locale);\n        this.clearDdb = new DropDownButton({\n            cssClass: 'e-clear-ddb',\n            iconCss: 'e-icons e-clear-icon',\n            items: [\n                { text: l10n.getConstant('ClearAll') },\n                { text: l10n.getConstant('ClearFormats') },\n                { text: l10n.getConstant('ClearContents') },\n                { text: l10n.getConstant('ClearHyperlinks') }\n            ],\n            select: function (args) {\n                _this.parent.notify(clearViewer, { options: { type: args.item.text } });\n            },\n            close: function () { return _this.parent.element.focus(); }\n        });\n        this.clearDdb.createElement = this.parent.createElement;\n        this.clearDdb.appendTo(this.parent.createElement('button', { id: id + '_clear' }));\n        return this.clearDdb.element;\n    };\n    Ribbon.prototype.ribbonCreated = function () {\n        this.ribbon.element.querySelector('.e-drop-icon').title\n            = this.parent.serviceLocator.getService(locale).getConstant('CollapseToolbar');\n    };\n    Ribbon.prototype.alignItemRender = function (args) {\n        var text = args.item.iconCss.split(' e-')[1].split('-icon')[0];\n        text = text[0].toUpperCase() + text.slice(1, text.length);\n        args.element.title = this.parent.serviceLocator.getService(locale).getConstant('Align' + text);\n    };\n    Ribbon.prototype.toggleBtnClicked = function (e) {\n        var target = closest(e.target, '.e-btn');\n        var parentId = this.parent.element.id;\n        var id = target.id;\n        var property = setCellFormat;\n        var value;\n        var defaultModel;\n        var activeModel;\n        var eventArgs;\n        var key;\n        switch (id) {\n            case parentId + \"_bold\":\n                defaultModel = { fontWeight: 'normal' };\n                activeModel = { fontWeight: 'bold' };\n                key = 'fontWeight';\n                break;\n            case parentId + \"_italic\":\n                defaultModel = { fontStyle: 'normal' };\n                activeModel = { fontStyle: 'italic' };\n                key = 'fontStyle';\n                break;\n            case parentId + \"_line-through\":\n                property = textDecorationUpdate;\n                defaultModel = { textDecoration: 'line-through' };\n                activeModel = defaultModel;\n                key = 'textDecoration';\n                break;\n            case parentId + \"_underline\":\n                property = textDecorationUpdate;\n                defaultModel = { textDecoration: 'underline' };\n                activeModel = defaultModel;\n                key = 'textDecoration';\n                break;\n        }\n        if (target.classList.contains('e-active')) {\n            value = activeModel[key];\n            eventArgs = { style: activeModel, onActionUpdate: true };\n            this.parent.notify(property, eventArgs);\n            if (eventArgs.cancel) {\n                target.classList.remove('e-active');\n            }\n        }\n        else {\n            value = defaultModel[key];\n            eventArgs = { style: defaultModel, onActionUpdate: true };\n            this.parent.notify(property, eventArgs);\n            if (eventArgs.cancel) {\n                target.classList.add('e-active');\n            }\n        }\n        if (!eventArgs.cancel && value !== eventArgs.style[key]) {\n            this.refreshToggleBtn(getCellIndexes(this.parent.getActiveSheet().activeCell));\n        }\n        this.parent.element.focus();\n    };\n    Ribbon.prototype.getCellStyleValue = function (cssProp, indexes) {\n        var cell = getCell(indexes[0], indexes[1], this.parent.getActiveSheet());\n        var value = this.parent.cellStyle[cssProp];\n        if (cell && cell.style && cell.style[cssProp]) {\n            value = cell.style[cssProp];\n        }\n        return value;\n    };\n    Ribbon.prototype.refreshSelected = function (inst, element, key, itemKey) {\n        if (itemKey === void 0) { itemKey = key; }\n        for (var i = 0; i < inst.items.length; i++) {\n            if (inst.items[i][itemKey] === inst[key]) {\n                element.children[i].classList.add('e-selected');\n                break;\n            }\n        }\n    };\n    Ribbon.prototype.expandCollapseHandler = function (args) {\n        var target = this.ribbon.element.querySelector('.e-drop-icon');\n        var l10n = this.parent.serviceLocator.getService(locale);\n        if (args.expanded) {\n            target.title = l10n.getConstant('CollapseToolbar');\n        }\n        else {\n            target.title = l10n.getConstant('ExpandToolbar');\n        }\n        this.parent.setPanelSize();\n    };\n    Ribbon.prototype.getNumFormatDdbItems = function (id) {\n        var l10n = this.parent.serviceLocator.getService(locale);\n        return [\n            { id: id + 'item1', text: l10n.getConstant('General') },\n            { id: id + 'item2', text: l10n.getConstant('Number') },\n            { id: id + 'item3', text: l10n.getConstant('Currency') },\n            { id: id + 'item4', text: l10n.getConstant('Accounting') },\n            { id: id + 'item5', text: l10n.getConstant('ShortDate') },\n            { id: id + 'item6', text: l10n.getConstant('LongDate') },\n            { id: id + 'item7', text: l10n.getConstant('Time') },\n            { id: id + 'item8', text: l10n.getConstant('Percentage') },\n            { id: id + 'item9', text: l10n.getConstant('Fraction') },\n            { id: id + 'item10', text: l10n.getConstant('Scientific') },\n            { id: id + 'item11', text: l10n.getConstant('Text') }\n        ];\n    };\n    Ribbon.prototype.getFontFamilyItems = function () {\n        return [{ text: 'Arial' }, { text: 'Arial Black' }, { text: 'Axettac Demo' }, { text: 'Batang' }, { text: 'Book Antiqua' },\n            { text: 'Calibri', iconCss: 'e-icons e-selected-icon' }, { text: 'Courier' }, { text: 'Courier New' },\n            { text: 'Din Condensed' }, { text: 'Georgia' }, { text: 'Helvetica' }, { text: 'Helvetica New' }, { text: 'Roboto' },\n            { text: 'Tahoma' }, { text: 'Times New Roman' }, { text: 'Verdana' }];\n    };\n    Ribbon.prototype.numDDBSelect = function (args) {\n        var eventArgs = {\n            format: getFormatFromType(args.item.text),\n            range: this.parent.getActiveSheet().selectedRange, cancel: false, requestType: 'NumberFormat'\n        };\n        var actionArgs = {\n            range: this.parent.getActiveSheet().name + '!' + eventArgs.range,\n            format: eventArgs.format, requestType: 'NumberFormat'\n        };\n        this.parent.trigger('beforeCellFormat', eventArgs);\n        this.parent.notify(beginAction, { eventArgs: eventArgs, action: 'format' });\n        if (eventArgs.cancel) {\n            return;\n        }\n        this.parent.notify(applyNumberFormatting, eventArgs);\n        this.parent.notify(selectionComplete, { type: 'mousedown' });\n        this.refreshNumFormatSelection(args.item.text);\n        this.parent.notify(completeAction, { eventArgs: actionArgs, action: 'format' });\n    };\n    Ribbon.prototype.tBarDdbBeforeOpen = function (element, items, separatorCount) {\n        if (separatorCount === void 0) { separatorCount = 0; }\n        var viewportHeight = this.parent.viewport.height;\n        var actualHeight = (parseInt(getComputedStyle(element.firstElementChild).height, 10) * (items.length - separatorCount)) +\n            (parseInt(getComputedStyle(element).paddingTop, 10) * 2);\n        if (separatorCount) {\n            var separatorStyle = getComputedStyle(element.querySelector('.e-separator'));\n            actualHeight += (separatorCount * (parseInt(separatorStyle.borderBottomWidth, 10) + (parseInt(separatorStyle.marginTop, 10) * 2)));\n        }\n        if (actualHeight > viewportHeight) {\n            element.style.height = viewportHeight + \"px\";\n            element.style.overflowY = 'auto';\n        }\n        else {\n            if (element.style.height) {\n                element.style.height = '';\n                element.style.overflowY = '';\n            }\n        }\n    };\n    Ribbon.prototype.numDDBOpen = function (args) {\n        this.numPopupWidth = 0;\n        var elemList = args.element.querySelectorAll('span.e-numformat-preview-text');\n        for (var i = 0, len = elemList.length; i < len; i++) {\n            if (this.numPopupWidth < elemList[i].offsetWidth) {\n                this.numPopupWidth = elemList[i].offsetWidth;\n            }\n        }\n        var popWidth = this.numPopupWidth + 160;\n        document.querySelector('.e-numformat-ddb.e-dropdown-popup').style.width = popWidth + \"px\";\n    };\n    Ribbon.prototype.previewNumFormat = function (args) {\n        var cellIndex = getCellIndexes(this.parent.getActiveSheet().activeCell);\n        var cell = getCell(cellIndex[0], cellIndex[1], this.parent.getActiveSheet());\n        var eventArgs = {\n            type: args.item.text,\n            formattedText: '',\n            value: cell && cell.value ? cell.value : '',\n            format: getFormatFromType(args.item.text),\n            sheetIndex: this.parent.activeSheetIndex,\n            onLoad: true\n        };\n        var numElem = this.parent.createElement('div', {\n            className: 'e-numformat-text',\n            styles: 'width:100%',\n            innerHTML: args.element.innerHTML\n        });\n        args.element.innerHTML = '';\n        this.parent.notify(getFormattedCellObject, eventArgs);\n        var previewElem = this.parent.createElement('span', {\n            className: 'e-numformat-preview-text',\n            styles: 'float:right;',\n            innerHTML: eventArgs.formattedText.toString()\n        });\n        numElem.appendChild(previewElem);\n        args.element.appendChild(numElem);\n    };\n    Ribbon.prototype.refreshRibbonContent = function (activeTab) {\n        if (!this.ribbon) {\n            return;\n        }\n        if (isNullOrUndefined(activeTab)) {\n            activeTab = this.ribbon.selectedTab;\n        }\n        var l10n = this.parent.serviceLocator.getService(locale);\n        var sheet = this.parent.getActiveSheet();\n        switch (this.ribbon.items[activeTab].header.text) {\n            case l10n.getConstant('Home'):\n                this.refreshHomeTabContent(getCellIndexes(sheet.activeCell));\n                break;\n            case l10n.getConstant('Insert'):\n                // Second tab functionality comes here\n                break;\n            case l10n.getConstant('Formulas'):\n                // Third tab functionality comes here\n                break;\n            case l10n.getConstant('Data'):\n                this.refreshDataTabContent(activeTab);\n                break;\n            case l10n.getConstant('View'):\n                this.refreshViewTabContent(activeTab);\n                break;\n        }\n    };\n    Ribbon.prototype.refreshHomeTabContent = function (indexes) {\n        if (!isNullOrUndefined(document.getElementById(this.parent.element.id + '_number_format'))) {\n            this.numFormatDDB = getComponent(document.getElementById(this.parent.element.id + '_number_format'), DropDownButton);\n        }\n        var sheet = this.parent.getActiveSheet();\n        var actCell = getCellIndexes(this.parent.getActiveSheet().activeCell);\n        var l10n = this.parent.serviceLocator.getService(locale);\n        var cell = getCell(actCell[0], actCell[1], this.parent.getActiveSheet()) || {};\n        var type = getTypeFromFormat(cell.format ? cell.format : 'General');\n        if (this.numFormatDDB) {\n            if (sheet.isProtected && !sheet.protectSettings.formatCells) {\n                type = 'General';\n                this.refreshNumFormatSelection(type);\n            }\n            else {\n                this.refreshNumFormatSelection(l10n.getConstant(type));\n            }\n        }\n        if (this.fontNameDdb) {\n            if (sheet.isProtected && !sheet.protectSettings.formatCells) {\n                this.refreshFontNameSelection('Calibri');\n            }\n            else {\n                this.refreshFontNameSelection(this.getCellStyleValue('fontFamily', indexes));\n            }\n        }\n        if (this.fontSizeDdb) {\n            var value = this.getCellStyleValue('fontSize', indexes);\n            if (sheet.isProtected && !sheet.protectSettings.formatCells) {\n                this.fontSizeDdb.content = '11';\n            }\n            else {\n                value = value.includes('pt') ? value.split('pt')[0] : '11';\n                if (value !== this.fontSizeDdb.content) {\n                    this.fontSizeDdb.content = value;\n                    this.fontSizeDdb.dataBind();\n                }\n            }\n        }\n        if (this.textAlignDdb) {\n            var style = this.getCellStyleValue('textAlign', indexes);\n            if (sheet.isProtected && !sheet.protectSettings.formatCells) {\n                this.textAlignDdb.iconCss = 'e-icons e-left-icon';\n            }\n            else {\n                if (cell.value !== undefined && style === 'left' && (type === 'Accounting' || isNumber(cell.value))) {\n                    style = 'right';\n                }\n                var value = \"e-icons e-\" + style.toLowerCase() + \"-icon\";\n                if (value !== this.textAlignDdb.iconCss) {\n                    this.textAlignDdb.iconCss = value;\n                    this.textAlignDdb.dataBind();\n                }\n            }\n        }\n        if (this.verticalAlignDdb) {\n            var value = \"e-icons e-\" + this.getCellStyleValue('verticalAlign', indexes).toLowerCase() + \"-icon\";\n            if (sheet.isProtected && !sheet.protectSettings.formatCells) {\n                this.verticalAlignDdb.iconCss = 'e-icons e-bottom-icon';\n            }\n            else {\n                if (value !== this.verticalAlignDdb.iconCss) {\n                    this.verticalAlignDdb.iconCss = value;\n                    this.verticalAlignDdb.dataBind();\n                }\n            }\n        }\n        this.refreshToggleBtn(indexes);\n        if (!sheet.isProtected && (cell.rowSpan > 1 || cell.colSpan > 1)) {\n            this.enableToolbarItems([{ tab: l10n.getConstant('Home'), items: [this.parent.element.id + \"_merge_cells\"],\n                    enable: true }]);\n            this.toggleActiveState(true);\n        }\n        else {\n            var indexes_1 = getRangeIndexes(sheet.selectedRange);\n            this.enableToolbarItems([{ tab: l10n.getConstant('Home'), items: [this.parent.element.id + \"_merge_cells\"],\n                    enable: indexes_1[0] !== indexes_1[2] || indexes_1[1] !== indexes_1[3] ? true : false }]);\n            this.toggleActiveState(false);\n        }\n    };\n    Ribbon.prototype.toggleActiveState = function (active) {\n        var l10n = this.parent.serviceLocator.getService(locale);\n        if (!this.parent.getActiveSheet().isProtected) {\n            if (active) {\n                this.mergeSplitBtn.element.classList.add('e-active');\n                this.mergeSplitBtn.element.title = l10n.getConstant('UnmergeCells');\n            }\n            else {\n                if (this.mergeSplitBtn.element.classList.contains('e-active')) {\n                    this.mergeSplitBtn.element.classList.remove('e-active');\n                }\n                this.mergeSplitBtn.element.title = l10n.getConstant('MergeCells');\n            }\n        }\n    };\n    Ribbon.prototype.refreshToggleBtn = function (indexes) {\n        var _this = this;\n        var sheet = this.parent.getActiveSheet();\n        var btn;\n        var id = this.parent.element.id;\n        var value;\n        var isActive;\n        var cell = getCell(indexes[0], indexes[1], sheet);\n        var fontProps = ['fontWeight', 'fontStyle', 'textDecoration', 'textDecoration'];\n        ['bold', 'italic', 'line-through', 'underline', 'wrap'].forEach(function (name, index) {\n            btn = document.getElementById(id + \"_\" + name);\n            if (btn) {\n                if (sheet.isProtected && !sheet.protectSettings.formatCells) {\n                    btn.classList.remove('e-active');\n                }\n                else if (name === 'wrap') {\n                    isActive = cell && cell.wrap;\n                }\n                else {\n                    value = _this.getCellStyleValue(fontProps[index], indexes).toLowerCase();\n                    isActive = value.indexOf(name) > -1;\n                }\n                if (isActive) {\n                    btn.classList.add('e-active');\n                }\n                else {\n                    if (btn.classList.contains('e-active')) {\n                        btn.classList.remove('e-active');\n                    }\n                }\n            }\n        });\n    };\n    Ribbon.prototype.refreshFontNameSelection = function (fontFamily) {\n        if (fontFamily !== this.fontNameDdb.items[this.fontNameIndex].text) {\n            this.fontNameDdb.element.firstElementChild.textContent = fontFamily;\n            for (var i = 0; i < this.fontNameDdb.items.length; i++) {\n                if (this.fontNameDdb.items[i].text === fontFamily) {\n                    this.fontNameDdb.items[i].iconCss = 'e-icons e-selected-icon';\n                    this.fontNameDdb.items[this.fontNameIndex].iconCss = '';\n                    this.fontNameDdb.setProperties({ 'items': this.fontNameDdb.items }, true);\n                    this.fontNameIndex = i;\n                    break;\n                }\n            }\n        }\n    };\n    Ribbon.prototype.refreshNumFormatSelection = function (type) {\n        var l10n = this.parent.serviceLocator.getService(locale);\n        for (var i = 0; i < this.numFormatDDB.items.length; i++) {\n            if (this.numFormatDDB.items[i].iconCss !== '') {\n                this.numFormatDDB.items[i].iconCss = '';\n            }\n            if (this.numFormatDDB.items[i].text === type) {\n                this.numFormatDDB.items[i].iconCss = 'e-icons e-selected-icon';\n            }\n        }\n        this.numFormatDDB.element.firstElementChild.textContent = type;\n        this.numFormatDDB.setProperties({ 'items': this.numFormatDDB.items }, true);\n    };\n    Ribbon.prototype.fileMenuItemSelect = function (args) {\n        var _this = this;\n        var selectArgs = extend({ cancel: false }, args);\n        this.parent.trigger('fileMenuItemSelect', selectArgs);\n        var id = this.parent.element.id;\n        if (!selectArgs.cancel) {\n            switch (args.item.id) {\n                case id + \"_Open\":\n                    select('#' + id + '_fileUpload', this.parent.element).click();\n                    break;\n                case id + \"_Xlsx\":\n                case id + \"_Xls\":\n                case id + \"_Csv\":\n                    this.parent.save({ saveType: args.item.id.split(id + \"_\")[1] });\n                    break;\n                case id + \"_New\":\n                    var dialogInst_1 = this.parent.serviceLocator.getService(dialog);\n                    dialogInst_1.show({\n                        height: 200, width: 400, isModal: true, showCloseIcon: true,\n                        content: this.parent.serviceLocator.getService(locale).getConstant('DestroyAlert'),\n                        beforeOpen: function (args) {\n                            var dlgArgs = {\n                                dialogName: 'DestroySheetDialog',\n                                element: args.element, target: args.target, cancel: args.cancel\n                            };\n                            _this.parent.trigger('dialogBeforeOpen', dlgArgs);\n                            if (dlgArgs.cancel) {\n                                args.cancel = true;\n                            }\n                            _this.parent.element.focus();\n                        },\n                        buttons: [{\n                                buttonModel: {\n                                    content: this.parent.serviceLocator.getService(locale).getConstant('Ok'), isPrimary: true\n                                },\n                                click: function () {\n                                    _this.parent.sheets.length = 0;\n                                    _this.parent.createSheet();\n                                    dialogInst_1.hide();\n                                    _this.parent.activeSheetIndex = _this.parent.sheets.length - 1;\n                                    _this.parent.notify(refreshSheetTabs, {});\n                                    _this.parent.notify(sheetsDestroyed, {});\n                                    _this.parent.renderModule.refreshSheet();\n                                }\n                            }]\n                    });\n                    break;\n            }\n        }\n    };\n    Ribbon.prototype.toolbarClicked = function (args) {\n        if (!(args.item.id === 'spreadsheet_find')) {\n            var parentId = this.parent.element.id;\n            var sheet = this.parent.getActiveSheet();\n            switch (args.item.id) {\n                case parentId + '_headers':\n                    var evtHArgs = {\n                        isShow: !sheet.showHeaders,\n                        sheetIdx: this.parent.activeSheetIndex,\n                        cancel: false\n                    };\n                    this.parent.notify(completeAction, { eventArgs: evtHArgs, action: 'headers' });\n                    if (evtHArgs.cancel) {\n                        return;\n                    }\n                    this.parent.setSheetPropertyOnMute(sheet, 'showHeaders', !sheet.showHeaders);\n                    this.parent.serviceLocator.getService('sheet').showHideHeaders();\n                    this.toggleRibbonItems({ props: 'Headers', activeTab: this.ribbon.selectedTab });\n                    this.parent.element.focus();\n                    break;\n                case parentId + '_gridlines':\n                    var evtglArgs = {\n                        isShow: !sheet.showGridLines,\n                        sheetIdx: this.parent.activeSheetIndex,\n                        cancel: false\n                    };\n                    this.parent.notify(completeAction, { eventArgs: evtglArgs, action: 'gridLines' });\n                    if (evtglArgs.cancel) {\n                        return;\n                    }\n                    this.parent.setSheetPropertyOnMute(sheet, 'showGridLines', !sheet.showGridLines);\n                    this.toggleRibbonItems({ props: 'GridLines', activeTab: this.ribbon.selectedTab });\n                    this.parent.element.focus();\n                    break;\n                case parentId + '_protect':\n                    this.parent.setSheetPropertyOnMute(sheet, 'isProtected', !sheet.isProtected);\n                    var isActive = false;\n                    sheet.isProtected ? isActive = false : isActive = true;\n                    this.parent.notify(applyProtect, { isActive: isActive, id: parentId + '_protect' });\n                    break;\n                case parentId + '_undo':\n                    this.parent.notify(performUndoRedo, { isUndo: true });\n                    break;\n                case parentId + '_redo':\n                    this.parent.notify(performUndoRedo, { isUndo: false });\n                    break;\n            }\n            this.parent.notify(ribbonClick, args);\n        }\n    };\n    Ribbon.prototype.toggleRibbonItems = function (args) {\n        var viewtabHeader = this.parent.serviceLocator.getService(locale).getConstant('View');\n        var datatabHeader = this.parent.serviceLocator.getService(locale).getConstant('Data');\n        if (this.ribbon.items[this.ribbon.selectedTab].header.text === viewtabHeader) {\n            if (isNullOrUndefined(args.activeTab)) {\n                for (var i = 0, len_1 = this.ribbon.items.length; i < len_1; i++) {\n                    if (this.ribbon.items[i].header.text === viewtabHeader) {\n                        args.activeTab = i;\n                        break;\n                    }\n                }\n            }\n            var text = this.getLocaleText(args.props, true);\n            var id = this.parent.element.id + \"_\" + args.props.toLowerCase();\n            var len = this.ribbon.items[args.activeTab].content.length;\n            for (var i = void 0; i < len; i++) {\n                if (this.ribbon.items[args.activeTab].content[i].type === 'Separator') {\n                    continue;\n                }\n                if (this.ribbon.items[args.activeTab].content[i].id === id) {\n                    this.ribbon.items[args.activeTab].content[i].text = text;\n                    this.ribbon.setProperties({ 'items': this.ribbon.items }, true);\n                }\n            }\n            if (this.ribbon.items[this.ribbon.selectedTab].header.text === viewtabHeader) {\n                this.updateToggleText(args.props.toLowerCase(), text);\n            }\n        }\n        if (this.ribbon.items[this.ribbon.selectedTab].header.text === datatabHeader) {\n            if (isNullOrUndefined(args.activeTab)) {\n                for (var i = 0, len_2 = this.ribbon.items.length; i < len_2; i++) {\n                    if (this.ribbon.items[i].header.text === datatabHeader) {\n                        args.activeTab = i;\n                        break;\n                    }\n                }\n            }\n            var text = this.getLocaleProtectText('Sheet', true);\n            var id = this.parent.element.id + \"_\" + args.props.toLowerCase();\n            var len = this.ribbon.items[args.activeTab].content.length;\n            for (var i = void 0; i < len; i++) {\n                if (this.ribbon.items[args.activeTab].content[i].type === 'Separator') {\n                    continue;\n                }\n                if (this.ribbon.items[args.activeTab].content[i].id === id) {\n                    this.ribbon.items[args.activeTab].content[i].text = text;\n                    this.ribbon.setProperties({ 'items': this.ribbon.items }, true);\n                }\n            }\n            if (this.ribbon.items[this.ribbon.selectedTab].header.text === datatabHeader) {\n                this.updateToggleText(args.props.toLowerCase(), text);\n            }\n        }\n    };\n    Ribbon.prototype.enableFileMenuItems = function (args) {\n        this.ribbon.enableMenuItems(args.items, args.enable, args.isUniqueId);\n    };\n    Ribbon.prototype.hideRibbonTabs = function (args) {\n        this.ribbon.hideTabs(args.tabs, args.hide);\n    };\n    Ribbon.prototype.addRibbonTabs = function (args) {\n        this.ribbon.addTabs(args.items, args.insertBefore);\n        var nextTab = select('.e-ribbon .e-tab-header .e-toolbar-item:not(.e-menu-tab).e-hide', this.parent.element);\n        if (nextTab) {\n            this.parent.updateActiveBorder(selectAll('.e-ribbon .e-tab-header .e-toolbar-item:not(.e-menu-tab)', this.parent.element)[this.ribbon.selectedTab]);\n        }\n    };\n    Ribbon.prototype.updateToggleText = function (item, text) {\n        var _this = this;\n        getUpdateUsingRaf(function () {\n            select(\"#\" + _this.parent.element.id + \"_\" + item + \" .e-tbar-btn-text\", _this.ribbon.element).textContent = text;\n        });\n    };\n    Ribbon.prototype.refreshViewTabContent = function (activeTab) {\n        var id = this.parent.element.id;\n        var updated;\n        for (var i = 0; i < this.ribbon.items[activeTab].content.length; i++) {\n            if (this.ribbon.items[activeTab].content[i].type === 'Separator') {\n                continue;\n            }\n            if (this.ribbon.items[activeTab].content[i].id === id + \"_headers\") {\n                this.updateViewTabContent(activeTab, 'Headers', i);\n                if (updated) {\n                    break;\n                }\n                updated = true;\n            }\n            if (this.ribbon.items[activeTab].content[i].id === id + \"_gridlines\") {\n                this.updateViewTabContent(activeTab, 'GridLines', i);\n                if (updated) {\n                    break;\n                }\n                updated = true;\n            }\n        }\n    };\n    Ribbon.prototype.updateViewTabContent = function (activeTab, item, idx) {\n        var sheet = this.parent.getActiveSheet();\n        var l10n = this.parent.serviceLocator.getService(locale);\n        if (sheet['show' + item]) {\n            if (this.ribbon.items[activeTab].content[idx].text === l10n.getConstant('Show' + item)) {\n                this.updateShowHideBtn('Hide', item, idx, activeTab);\n            }\n        }\n        else {\n            if (this.ribbon.items[activeTab].content[idx].text === l10n.getConstant('Hide' + item)) {\n                this.updateShowHideBtn('Show', item, idx, activeTab);\n            }\n        }\n    };\n    Ribbon.prototype.updateShowHideBtn = function (showHideText, item, idx, activeTab) {\n        var l10n = this.parent.serviceLocator.getService(locale);\n        var text = l10n.getConstant(showHideText + item);\n        this.ribbon.items[activeTab].content[idx].text = text;\n        this.ribbon.setProperties({ 'items': this.ribbon.items }, true);\n        this.updateToggleText(item.toLowerCase(), text);\n    };\n    Ribbon.prototype.refreshDataTabContent = function (activeTab) {\n        var id = this.parent.element.id;\n        var updated;\n        for (var j = 0; j < this.ribbon.items[activeTab].content.length; j++) {\n            if (this.ribbon.items[activeTab].content[j].type === 'Separator') {\n                continue;\n            }\n            if (this.ribbon.items[activeTab].content[j].id === id + \"_protect\") {\n                this.updateDataTabContent(activeTab, 'Sheet', j);\n                if (updated) {\n                    break;\n                }\n                updated = true;\n            }\n        }\n    };\n    Ribbon.prototype.updateDataTabContent = function (activeTab, item, idx) {\n        var sheet = this.parent.getActiveSheet();\n        var l10n = this.parent.serviceLocator.getService(locale);\n        if (sheet.isProtected) {\n            if (this.ribbon.items[activeTab].content[idx].text === l10n.getConstant('Protect' + item)) {\n                this.ribbon.items[activeTab].content[idx].cssClass = 'e-active';\n                this.updateProtectBtn('Unprotect', item, idx, activeTab);\n            }\n        }\n        else {\n            this.updateProtectBtn('Protect', item, idx, activeTab);\n        }\n    };\n    Ribbon.prototype.updateProtectBtn = function (protectText, item, idx, activeTab) {\n        var l10n = this.parent.serviceLocator.getService(locale);\n        var text = l10n.getConstant(protectText + item);\n        this.ribbon.items[activeTab].content[idx].text = text;\n        this.ribbon.setProperties({ 'items': this.ribbon.items }, true);\n        this.updateToggleText('protect', text);\n    };\n    Ribbon.prototype.addToolbarItems = function (args) {\n        this.ribbon.addToolbarItems(args.tab, args.items, args.index);\n    };\n    Ribbon.prototype.enableToolbarItems = function (args) {\n        var _this = this;\n        args.forEach(function (arg) {\n            _this.ribbon.enableItems(arg.tab || _this.ribbon.items[_this.ribbon.selectedTab].header.text, arg.items, arg.enable);\n        });\n    };\n    Ribbon.prototype.createMobileView = function () {\n        var _this = this;\n        var parentId = this.parent.element.id;\n        var toobar = this.parent.createElement('div', { className: 'e-header-toolbar' });\n        var menu = this.parent.createElement('ul');\n        toobar.appendChild(menu);\n        var toolbarObj = new Toolbar({\n            items: [\n                { prefixIcon: 'e-tick-icon', align: 'Left', id: parentId + 'focused_tick', cssClass: 'e-focused-tick' },\n                { template: menu, align: 'Right', id: parentId + 'file_menu' },\n            ],\n            clicked: function (args) {\n                switch (args.item.id) {\n                    case parentId + 'focused_tick':\n                        _this.parent.element.classList.remove('e-mobile-focused');\n                        _this.parent.renderModule.setSheetPanelSize();\n                        break;\n                }\n            },\n            created: function () {\n                var menuObj = new Menu({\n                    cssClass: 'e-mobile e-file-menu',\n                    enableRtl: true,\n                    showItemOnClick: true,\n                    items: _this.getRibbonMenuItems(),\n                    select: _this.fileMenuItemSelect.bind(_this),\n                    beforeOpen: function (args) {\n                        args.element.parentElement.classList.remove('e-rtl');\n                        _this.fileMenuBeforeOpen(args);\n                    },\n                    beforeClose: _this.fileMenuBeforeClose.bind(_this)\n                });\n                menuObj.createElement = _this.parent.createElement;\n                menuObj.appendTo(menu);\n            }\n        });\n        toolbarObj.createElement = this.parent.createElement;\n        toolbarObj.appendTo(toobar);\n        this.parent.element.insertBefore(toobar, this.parent.element.firstElementChild);\n        this.renderMobileToolbar();\n    };\n    Ribbon.prototype.renderMobileToolbar = function () {\n        var _this = this;\n        var toolbarPanel = this.parent.createElement('div', { className: 'e-toolbar-panel e-ribbon' });\n        var toolbar = this.parent.createElement('div');\n        var ddb = this.parent.createElement('button');\n        toolbarPanel.appendChild(toolbar);\n        toolbarPanel.appendChild(ddb);\n        toolbarPanel.style.display = 'block';\n        this.parent.element.appendChild(toolbarPanel);\n        var ddbObj = new DropDownButton({\n            cssClass: 'e-caret-hide',\n            content: this.ribbon.items[0].header.text,\n            items: [\n                { text: this.ribbon.items[0].header.text },\n                { text: this.ribbon.items[1].header.text },\n                { text: this.ribbon.items[2].header.text },\n                { text: this.ribbon.items[3].header.text }\n            ],\n            select: function (args) {\n                if (args.item.text !== ddbObj.content) {\n                    toolbarObj.element.style.display = 'none';\n                    ddbObj.content = args.item.text;\n                    ddbObj.dataBind();\n                    toolbarObj.items = _this.ribbon.items[ddbObj.items.indexOf(args.item) + 1].content;\n                    toolbarObj.width = \"calc(100% - \" + ddb.getBoundingClientRect().width + \"px)\";\n                    toolbarObj.element.style.display = '';\n                    toolbarObj.dataBind();\n                    toolbarObj.items[0].text = args.item.text;\n                    toolbarObj.dataBind();\n                }\n            },\n            open: function (args) {\n                var element = args.element.parentElement;\n                var clientRect = element.getBoundingClientRect();\n                var offset = calculatePosition(ddbObj.element, 'right', 'bottom');\n                element.style.left = offset.left - clientRect.width + \"px\";\n                element.style.top = offset.top - clientRect.height + \"px\";\n                for (var i = 0; i < ddbObj.items.length; i++) {\n                    if (ddbObj.content === ddbObj.items[i].text) {\n                        args.element.children[i].classList.add('e-selected');\n                        break;\n                    }\n                }\n            },\n            close: function () { return _this.parent.element.focus(); }\n        });\n        ddbObj.createElement = this.parent.createElement;\n        ddbObj.appendTo(ddb);\n        var toolbarObj = new Toolbar({\n            width: \"calc(100% - \" + ddb.getBoundingClientRect().width + \"px)\",\n            items: this.ribbon.items[0].content,\n            clicked: this.toolbarClicked.bind(this)\n        });\n        toolbarObj.createElement = this.parent.createElement;\n        toolbarObj.appendTo(toolbar);\n        toolbarPanel.style.display = '';\n    };\n    Ribbon.prototype.fileMenuBeforeOpen = function (args) {\n        var _this = this;\n        var l10n = this.parent.serviceLocator.getService(locale);\n        var wrapper;\n        var contents = ['.xlsx', '.xls', '.csv'];\n        if (args.parentItem.text === l10n.getConstant('SaveAs')) {\n            [].slice.call(args.element.children).forEach(function (li, index) {\n                wrapper = _this.parent.createElement('div', { innerHTML: li.innerHTML });\n                li.innerHTML = '';\n                wrapper.appendChild(_this.parent.createElement('span', { className: 'e-extension', innerHTML: contents[index] }));\n                li.appendChild(wrapper);\n            });\n        }\n        this.parent.trigger('fileMenuBeforeOpen', args);\n    };\n    Ribbon.prototype.enableRibbonTabs = function (args) {\n        this.ribbon.enableTabs(args.tabs, args.enable);\n    };\n    Ribbon.prototype.fileMenuBeforeClose = function (args) {\n        this.parent.trigger('fileMenuBeforeClose', args);\n    };\n    Ribbon.prototype.hideFileMenuItems = function (args) {\n        this.ribbon.hideMenuItems(args.items, args.hide, args.isUniqueId);\n    };\n    Ribbon.prototype.addFileMenuItems = function (args) {\n        this.ribbon.addMenuItems(args.items, args.text, args.insertAfter, args.isUniqueId);\n    };\n    Ribbon.prototype.hideToolbarItems = function (args) {\n        this.ribbon.hideToolbarItems(args.tab, args.indexes, args.hide);\n    };\n    Ribbon.prototype.protectSheetHandler = function (args) {\n        var sheet = this.parent.getActiveSheet();\n        var l10n = this.parent.serviceLocator.getService(locale);\n        if ((sheet.isProtected && sheet.protectSettings.formatCells) || !sheet.isProtected) {\n            this.enableToolbarItems([{ tab: l10n.getConstant('Home'), items: args.enableHomeBtnId, enable: true }]);\n            this.parent.notify(setUndoRedo, null);\n        }\n        else {\n            this.enableToolbarItems([{ tab: l10n.getConstant('Home'), items: args.disableHomeBtnId, enable: false }]);\n        }\n        if ((sheet.isProtected && sheet.protectSettings.insertLink) || !sheet.isProtected) {\n            this.enableToolbarItems([{ tab: l10n.getConstant('Insert'), items: args.enableInsertBtnId, enable: true }]);\n        }\n        else {\n            this.enableToolbarItems([{ tab: l10n.getConstant('Insert'), items: args.enableInsertBtnId, enable: false }]);\n        }\n        if ((sheet.isProtected && sheet.protectSettings.selectCells) || !sheet.isProtected) {\n            this.enableToolbarItems([{ tab: l10n.getConstant('Home'), items: args.findBtnId, enable: true }]);\n        }\n        else {\n            this.enableToolbarItems([{ tab: l10n.getConstant('Home'), items: args.findBtnId, enable: false }]);\n        }\n        if (sheet.isProtected) {\n            this.enableToolbarItems([{ tab: l10n.getConstant('Data'), items: args.dataValidationBtnId, enable: false }]);\n            this.enableToolbarItems([{ tab: l10n.getConstant('Formulas'), items: args.enableFrmlaBtnId, enable: false }]);\n            this.enableToolbarItems([{ tab: l10n.getConstant('Insert'), items: args.imageBtnId, enable: false }]);\n            this.enableToolbarItems([{ tab: l10n.getConstant('Insert'), items: args.chartBtnId, enable: false }]);\n        }\n        else {\n            this.enableToolbarItems([{ tab: l10n.getConstant('Data'), items: args.dataValidationBtnId, enable: true }]);\n            this.enableToolbarItems([{ tab: l10n.getConstant('Formulas'), items: args.enableFrmlaBtnId, enable: true }]);\n            this.enableToolbarItems([{ tab: l10n.getConstant('Insert'), items: args.imageBtnId, enable: true }]);\n            this.enableToolbarItems([{ tab: l10n.getConstant('Insert'), items: args.chartBtnId, enable: true }]);\n        }\n    };\n    Ribbon.prototype.updateMergeItem = function (e) {\n        if (e.type === 'mousemove' || e.type === 'pointermove' || (e.shiftKey && e.type === 'mousedown')) {\n            var indexes = getRangeIndexes(this.parent.getActiveSheet().selectedRange);\n            if ((indexes[1] !== indexes[3] || indexes[0] !== indexes[2]) && !this.parent.getActiveSheet().isProtected) {\n                this.enableToolbarItems([{ tab: this.parent.serviceLocator.getService(locale).getConstant('Home'),\n                        items: [this.parent.element.id + \"_merge_cells\"], enable: true }]);\n                this.toggleActiveState(false);\n            }\n        }\n    };\n    Ribbon.prototype.addEventListener = function () {\n        this.parent.on(ribbon, this.initRibbon, this);\n        this.parent.on(enableToolbarItems, this.enableToolbarItems, this);\n        this.parent.on(activeCellChanged, this.refreshRibbonContent, this);\n        this.parent.on(updateToggleItem, this.toggleRibbonItems, this);\n        this.parent.on(enableFileMenuItems, this.enableFileMenuItems, this);\n        this.parent.on(hideRibbonTabs, this.hideRibbonTabs, this);\n        this.parent.on(addRibbonTabs, this.addRibbonTabs, this);\n        this.parent.on(addToolbarItems, this.addToolbarItems, this);\n        this.parent.on(hideFileMenuItems, this.hideFileMenuItems, this);\n        this.parent.on(addFileMenuItems, this.addFileMenuItems, this);\n        this.parent.on(hideToolbarItems, this.hideToolbarItems, this);\n        this.parent.on(enableRibbonTabs, this.enableRibbonTabs, this);\n        this.parent.on(protectCellFormat, this.protectSheetHandler, this);\n        this.parent.on(selectionComplete, this.updateMergeItem, this);\n        this.parent.on(refreshRibbonIcons, this.refreshToggleBtn, this);\n    };\n    Ribbon.prototype.destroy = function () {\n        var parentElem = this.parent.element;\n        var ribbonEle = this.ribbon.element;\n        var id = parentElem.id;\n        ['bold', 'italic', 'line-through', 'underline'].forEach(function (name) {\n            destroyComponent(select('#' + (id + \"_\" + name), parentElem), Button);\n        });\n        this.pasteSplitBtn.destroy();\n        this.pasteSplitBtn = null;\n        this.mergeSplitBtn.destroy();\n        this.mergeSplitBtn = null;\n        this.numFormatDDB.destroy();\n        this.numFormatDDB = null;\n        this.fontSizeDdb.destroy();\n        this.fontSizeDdb = null;\n        this.fontNameDdb.destroy();\n        this.fontNameDdb = null;\n        this.textAlignDdb.destroy();\n        this.textAlignDdb = null;\n        this.verticalAlignDdb.destroy();\n        this.verticalAlignDdb = null;\n        this.sortingDdb.destroy();\n        this.sortingDdb = null;\n        this.clearDdb.destroy();\n        this.clearDdb = null;\n        this.colorPicker.destroy();\n        this.colorPicker = null;\n        this.bordersMenu.destroy();\n        this.bordersMenu = null;\n        this.bordersDdb.destroy();\n        this.bordersDdb = null;\n        this.findDdb.destroy();\n        this.findDdb = null;\n        this.chartDdb.destroy();\n        this.chartDdb = null;\n        this.chartMenu.destroy();\n        this.chartMenu = null;\n        this.parent.notify('destroyRibbonComponents', null);\n        this.ribbon.destroy();\n        if (ribbonEle) {\n            detach(ribbonEle);\n        }\n        this.ribbon = null;\n        this.removeEventListener();\n    };\n    Ribbon.prototype.removeEventListener = function () {\n        if (!this.parent.isDestroyed) {\n            this.parent.off(ribbon, this.initRibbon);\n            this.parent.off(enableToolbarItems, this.enableToolbarItems);\n            this.parent.off(activeCellChanged, this.refreshRibbonContent);\n            this.parent.off(updateToggleItem, this.toggleRibbonItems);\n            this.parent.off(enableFileMenuItems, this.enableFileMenuItems);\n            this.parent.off(hideRibbonTabs, this.hideRibbonTabs);\n            this.parent.off(addRibbonTabs, this.addRibbonTabs);\n            this.parent.off(addToolbarItems, this.addToolbarItems);\n            this.parent.off(hideFileMenuItems, this.hideFileMenuItems);\n            this.parent.off(addFileMenuItems, this.addFileMenuItems);\n            this.parent.off(hideToolbarItems, this.hideToolbarItems);\n            this.parent.off(enableRibbonTabs, this.enableRibbonTabs);\n            this.parent.off(protectCellFormat, this.protectSheetHandler);\n            this.parent.off(selectionComplete, this.updateMergeItem);\n            this.parent.off(refreshRibbonIcons, this.refreshToggleBtn);\n        }\n    };\n    return Ribbon;\n}());\nexport { Ribbon };\n","import { formulaBar, locale, selectionComplete, enableFormulaInput } from '../common/index';\nimport { mouseUpAfterSelection, click } from '../common/index';\nimport { getRangeIndexes, getRangeFromAddress, getCellAddress, getCellIndexes } from './../../workbook/common/address';\nimport { getSheetName, getTypeFromFormat, getSheet, checkIsFormula } from '../../workbook/index';\nimport { updateSelectedRange, getSheetNameFromAddress, getSheetIndex } from '../../workbook/index';\nimport { ComboBox, DropDownList } from '@syncfusion/ej2-dropdowns';\nimport { rippleEffect, EventHandler, detach, Internationalization, isNullOrUndefined, closest, select } from '@syncfusion/ej2-base';\nimport { isUndefined } from '@syncfusion/ej2-base';\nimport { editOperation, formulaBarOperation, keyDown, keyUp, formulaOperation, editAlert, editValue } from '../common/event';\nimport { intToDate } from '../../workbook/common/math';\nimport { ListView } from '@syncfusion/ej2-lists';\nimport { workbookFormulaOperation } from '../../workbook/common/event';\nimport { isFormulaBarEdit } from '../common/event';\n/**\n * Represents Formula bar for Spreadsheet.\n */\nvar FormulaBar = /** @class */ (function () {\n    function FormulaBar(parent) {\n        this.categoryCollection = [];\n        this.formulaCollection = [];\n        this.isGoto = false;\n        this.parent = parent;\n        this.addEventListener();\n    }\n    FormulaBar.prototype.getModuleName = function () {\n        return 'formulaBar';\n    };\n    FormulaBar.prototype.createFormulaBar = function (args) {\n        if (!this.parent.showFormulaBar && this.insertFnRipple) {\n            this.destroy();\n            return;\n        }\n        var l10n = this.parent.serviceLocator.getService(locale);\n        var id = this.parent.element.id;\n        var fBarWrapper = this.parent.createElement('div', { className: 'e-formula-bar-panel' });\n        if (!this.parent.isMobileView()) {\n            var nameBox = this.parent.createElement('input', { id: id + '_name_box', attrs: { type: 'text' } });\n            fBarWrapper.appendChild(nameBox);\n            this.comboBoxInstance = new ComboBox({\n                value: 'A1',\n                cssClass: 'e-name-box',\n                width: '',\n                noRecordsTemplate: '',\n                fields: { text: 'name', value: 'refersTo' },\n                beforeOpen: this.nameBoxBeforeOpen.bind(this),\n                blur: this.nameBoxBlur.bind(this),\n                select: this.nameBoxSelect.bind(this),\n                change: function (args) {\n                    /** */\n                }\n            });\n            this.comboBoxInstance.createElement = this.parent.createElement;\n            this.comboBoxInstance.appendTo(nameBox);\n            this.comboBoxInstance.element.parentElement.title = l10n.getConstant('NameBox');\n        }\n        var insertFnBtn = fBarWrapper.appendChild(this.parent.createElement('button', {\n            className: 'e-btn e-css e-flat e-icon-btn e-insert-function', attrs: { 'title': l10n.getConstant('InsertFunction') }\n        }));\n        insertFnBtn.appendChild(this.parent.createElement('span', { className: 'e-btn-icon e-icons' }));\n        this.insertFnRipple = rippleEffect(fBarWrapper, { selector: '.e-insert-function' });\n        fBarWrapper.appendChild(this.parent.createElement('div', { className: 'e-separator' }));\n        var textarea = fBarWrapper.appendChild(this.parent.createElement('textarea', {\n            className: 'e-formula-bar e-css', id: id + '_formula_input',\n            attrs: { 'title': l10n.getConstant('FormulaBar'), 'spellcheck': 'false' }\n        }));\n        textarea.rows = 1;\n        if (this.parent.isMobileView()) {\n            textarea.placeholder = l10n.getConstant('MobileFormulaBarPlaceHolder');\n            EventHandler.add(textarea, 'focus', this.textAreaFocusIn, this);\n            EventHandler.add(textarea, 'blur', this.textAreaFocusOut, this);\n        }\n        else {\n            fBarWrapper.appendChild(this.parent.createElement('span', {\n                className: 'e-drop-icon e-icons', attrs: { 'title': l10n.getConstant('ExpandFormulaBar') }\n            }));\n        }\n        if (args && args.uiUpdate) {\n            this.parent.element.insertBefore(fBarWrapper, document.getElementById(id + '_sheet_panel'));\n        }\n        else {\n            this.parent.element.appendChild(fBarWrapper);\n        }\n    };\n    FormulaBar.prototype.textAreaFocusIn = function (e) {\n        var formulaPanel = this.parent.element.querySelector('.e-formula-bar-panel');\n        var tickBtn = this.parent.createElement('button', { className: 'e-btn e-css e-flat e-icon-btn e-formula-submit' });\n        tickBtn.appendChild(this.parent.createElement('span', { className: 'e-btn-icon e-icons e-tick-icon' }));\n        formulaPanel.classList.add('e-focused');\n        formulaPanel.appendChild(tickBtn);\n    };\n    FormulaBar.prototype.textAreaFocusOut = function (e) {\n        var formulaPanel = this.parent.element.querySelector('.e-formula-bar-panel');\n        formulaPanel.classList.remove('e-focused');\n        detach(formulaPanel.querySelector('.e-formula-submit'));\n    };\n    FormulaBar.prototype.keyDownHandler = function (e) {\n        var trgtElem = e.target;\n        if (this.parent.isEdit && !this.parent.getActiveSheet().isProtected) {\n            if ((checkIsFormula(trgtElem.value) || (trgtElem.validity && trgtElem.value.toString().indexOf('=') === 0)) &&\n                e.keyCode === 16) {\n                return;\n            }\n            if (trgtElem.classList.contains('e-formula-bar')) {\n                this.parent.notify(editOperation, { action: 'refreshEditor', value: trgtElem.value, refreshEditorElem: true });\n            }\n        }\n    };\n    FormulaBar.prototype.keyUpHandler = function (e) {\n        if (this.parent.isEdit) {\n            var trgtElem = e.target;\n            if (trgtElem.classList.contains('e-formula-bar')) {\n                var eventArg = { action: 'getCurrentEditValue', editedValue: '' };\n                this.parent.notify(editOperation, eventArg);\n                if (eventArg.editedValue !== trgtElem.value && e.keyCode !== 16) {\n                    this.parent.notify(editOperation, { action: 'refreshEditor', value: trgtElem.value, refreshEditorElem: true });\n                }\n            }\n        }\n    };\n    FormulaBar.prototype.nameBoxBeforeOpen = function (args) {\n        if (this.comboBoxInstance.element.classList.contains('e-name-editing')) {\n            args.cancel = true;\n        }\n        else {\n            this.comboBoxInstance.element.select();\n        }\n    };\n    FormulaBar.prototype.nameBoxBlur = function (args) {\n        if (this.comboBoxInstance.element.classList.contains('e-name-editing')) {\n            this.comboBoxInstance.element.classList.remove('e-name-editing');\n            this.UpdateValueAfterMouseUp();\n        }\n    };\n    FormulaBar.prototype.nameBoxSelect = function (args) {\n        if (args.isInteracted) {\n            var refersTo = args.itemData.refersTo.substr(1);\n            var sheetIdx = getSheetIndex(this.parent, getSheetNameFromAddress(refersTo));\n            var range = getRangeFromAddress(refersTo);\n            var sheet = getSheet(this.parent, sheetIdx);\n            if (range.indexOf(':') !== -1) {\n                var colIndex = range.indexOf(':');\n                var left = range.substr(0, colIndex);\n                var right = range.substr(colIndex + 1, range.length);\n                left = left.replace('$', '');\n                right = right.replace('$', '');\n                if (right.match(/\\D/g) && !right.match(/[0-9]/g) && left.match(/\\D/g) && !left.match(/[0-9]/g)) {\n                    left = left + '1';\n                    right = right + sheet.rowCount;\n                    range = left + ':' + right;\n                }\n                else if (!right.match(/\\D/g) && right.match(/[0-9]/g) && !left.match(/\\D/g) && left.match(/[0-9]/g)) {\n                    left = getCellAddress(parseInt(left, 10) - 1, 0);\n                    right = getCellAddress(parseInt(right, 10) - 1, sheet.colCount - 1);\n                    range = left + ':' + right;\n                }\n            }\n            if ((sheetIdx) === this.parent.activeSheetIndex) {\n                this.parent.selectRange(range);\n                this.parent.element.focus();\n            }\n            else {\n                updateSelectedRange(this.parent, range, sheet);\n                this.parent.activeSheetIndex = sheetIdx;\n            }\n        }\n    };\n    FormulaBar.prototype.formulaBarUpdateHandler = function (e) {\n        var _this = this;\n        var sheet = this.parent.getActiveSheet();\n        var range = sheet.selectedRange.split(':');\n        var address;\n        var intl = new Internationalization();\n        if (e.type === 'mousemove' || e.type === 'pointermove') {\n            var indexes1 = getRangeIndexes(range[0]);\n            var indexes2 = getRangeIndexes(range[1]);\n            address = Math.abs(indexes1[0] - indexes2[0]) + 1 + \"R x \" + (Math.abs(indexes1[1] - indexes2[1]) + 1) + \"C\";\n            if (this.parent.isEdit) {\n                this.parent.notify(editValue, null);\n            }\n        }\n        else {\n            address = range[0];\n            var data = this.parent.getData(getSheetName(this.parent) + \"!\" + address);\n            data.then(function (values) {\n                var value = '';\n                var intDate;\n                values.forEach(function (cell, key) {\n                    var type = cell && cell.format ? getTypeFromFormat(cell.format) : 'General';\n                    if (cell) {\n                        if (!isNullOrUndefined(cell.value)) {\n                            intDate = intToDate(Number(cell.value));\n                            if (intDate.toString() !== 'Invalid Date' && (type === 'ShortDate' || type === 'LongDate')) {\n                                value = intl.formatDate(intDate, {\n                                    type: 'date',\n                                    skeleton: 'yMd'\n                                });\n                            }\n                            else if (intDate.toString() !== 'Invalid Date' && type === 'Time') {\n                                value = intl.formatDate(intDate, {\n                                    type: 'dateTime',\n                                    skeleton: 'yMd'\n                                }) + ' ' + intl.formatDate(intDate, {\n                                    type: 'dateTime',\n                                    skeleton: 'hms'\n                                });\n                            }\n                            else {\n                                value = cell.value;\n                            }\n                        }\n                        if (cell.formula) {\n                            value = cell.formula;\n                        }\n                    }\n                    var eventArgs = { action: 'getCurrentEditValue', editedValue: '' };\n                    _this.parent.notify(editOperation, eventArgs);\n                    var isFormulaEdit = (eventArgs.editedValue && eventArgs.editedValue.toString().indexOf('=') === 0) ||\n                        checkIsFormula(eventArgs.editedValue);\n                    var formulaInp = document.getElementById(_this.parent.element.id + '_formula_input');\n                    var addressRange = getRangeIndexes(address);\n                    var cellEle = _this.parent.getCell(addressRange[0], addressRange[1]);\n                    if (cell && !cell.formula && cellEle) {\n                        formulaInp.value = cellEle.textContent;\n                    }\n                    else {\n                        formulaInp.value = value;\n                    }\n                    if (!isNullOrUndefined(value) && !isFormulaEdit) {\n                        _this.parent.notify(editOperation, { action: 'refreshEditor', value: formulaInp.value, refreshEditorElem: true });\n                    }\n                    if (_this.parent.isEdit) {\n                        _this.parent.notify(editValue, null);\n                    }\n                });\n            });\n        }\n        this.updateComboBoxValue(address);\n    };\n    FormulaBar.prototype.UpdateValueAfterMouseUp = function () {\n        this.updateComboBoxValue(this.parent.getActiveSheet().selectedRange.split(':')[0]);\n    };\n    FormulaBar.prototype.updateComboBoxValue = function (value) {\n        var sheet = this.parent.getActiveSheet();\n        var range = getSheetName(this.parent) + '!' + sheet.selectedRange;\n        var eventArgs = {\n            action: 'getNameFromRange', range: range, definedName: null\n        };\n        this.parent.notify(formulaOperation, eventArgs);\n        if (eventArgs.definedName) {\n            value = eventArgs.definedName.name;\n        }\n        if (!this.parent.isMobileView()) {\n            if (this.comboBoxInstance.text === value) {\n                return;\n            }\n            this.comboBoxInstance.text = value;\n            this.comboBoxInstance.dataBind();\n        }\n    };\n    FormulaBar.prototype.disabletextarea = function () {\n        var element = this.getFormulaBar();\n        if (this.parent.getActiveSheet().isProtected) {\n            element.disabled = true;\n        }\n        else {\n            element.disabled = false;\n        }\n    };\n    FormulaBar.prototype.formulaBarScrollEdit = function () {\n        var index = getRangeIndexes(this.parent.getActiveSheet().selectedRange);\n        var viewportIndexes = getCellIndexes(this.parent.getActiveSheet().topLeftCell);\n        if (index[0] < viewportIndexes[0]) {\n            this.parent.goTo(this.parent.getActiveSheet().selectedRange);\n            this.isGoto = true;\n        }\n        this.parent.notify(editOperation, { action: 'startEdit', refreshCurPos: false });\n    };\n    FormulaBar.prototype.formulaBarClickHandler = function (e) {\n        var _this = this;\n        var target = e.target;\n        if (target.classList.contains('e-drop-icon') && closest(target, '.e-formula-bar-panel')) {\n            this.toggleFormulaBar(target);\n        }\n        else if (target.classList.contains('e-formula-bar')) {\n            if (!this.parent.isEdit && !this.parent.getActiveSheet().isProtected) {\n                this.formulaBarScrollEdit();\n            }\n            else if (this.parent.getActiveSheet().isProtected) {\n                this.parent.notify(editAlert, null);\n            }\n        }\n        else if (target.parentElement && target.parentElement.classList.contains('e-name-box')) {\n            if (target.classList.contains('e-ddl-icon')) {\n                var eventArgs = { action: 'getNames', names: [] };\n                this.parent.notify(formulaOperation, eventArgs);\n                this.comboBoxInstance.dataSource = eventArgs.names;\n            }\n            else {\n                this.comboBoxInstance.element.classList.add('e-name-editing');\n                this.comboBoxInstance.element.select();\n            }\n        }\n        if (!isNullOrUndefined(target.offsetParent) && ((target.offsetParent.classList.contains('e-insert-function')) ||\n            (target.classList.contains('e-insert-function')) || (this.parent.element.id + '_insert_function' === target.offsetParent.id)\n            || (this.parent.element.id + '_insert_function' === target.id) ||\n            target.parentElement.classList.contains('e-insert-function')\n            || (this.parent.element.id + '_insert_function' === target.parentElement.id))) {\n            if (this.parent.getActiveSheet().isProtected) {\n                this.parent.notify(editAlert, null);\n                return;\n            }\n            var isOpen = !this.parent.isEdit;\n            var args = { action: 'getCurrentEditValue', editedValue: '' };\n            if (!isOpen) {\n                var eventArgs = { action: 'isFormulaEditing', isFormulaEdit: false };\n                this.parent.notify(formulaOperation, eventArgs);\n                isOpen = eventArgs.isFormulaEdit;\n                this.parent.notify(editOperation, args);\n            }\n            if (isOpen || args.editedValue === '') {\n                if (args.editedValue === '') {\n                    this.parent.notify(editOperation, { action: 'refreshEditor', value: '=' });\n                }\n                var l10n = this.parent.serviceLocator.getService(locale);\n                var formulaDescription = this.parent.createElement('div', { className: 'e-formula-description', id: this.parent.element.id + '_description_content' });\n                var categoryContent = this.parent.createElement('div', {\n                    className: 'e-category-content', id: this.parent.element.id + '_category_content',\n                    innerHTML: l10n.getConstant('PickACategory')\n                });\n                var dropDownElement = this.parent.createElement('input', { className: 'e-formula-category', id: this.parent.element.id + '_formula_category' });\n                var listViewElement = this.parent.createElement('div', { className: 'e-formula-list', id: this.parent.element.id + '_formula_list' });\n                var descriptionContent = this.parent.createElement('div', { className: 'e-description-content', innerHTML: l10n.getConstant('Description') });\n                var headerContent = this.parent.createElement('div', { className: 'e-header-content', innerHTML: l10n.getConstant('InsertFunction') });\n                var categoryArgs = {\n                    action: 'getFormulaCategory', categoryCollection: []\n                };\n                this.parent.notify(workbookFormulaOperation, categoryArgs);\n                this.categoryCollection = categoryArgs.categoryCollection;\n                this.categoryList = new DropDownList({\n                    dataSource: this.categoryCollection, index: 0, width: '285px', popupHeight: '210px',\n                    select: this.dropDownSelect.bind(this)\n                });\n                var listArgs = {\n                    action: 'getLibraryFormulas', formulaCollection: []\n                };\n                this.parent.notify(workbookFormulaOperation, listArgs);\n                this.formulaCollection = listArgs.formulaCollection;\n                this.formulaList = new ListView({\n                    dataSource: this.formulaCollection.sort(),\n                    actionComplete: this.updateFormulaList.bind(this),\n                    select: this.listSelected.bind(this), width: '285px', height: '200px'\n                });\n                this.dialog = this.parent.serviceLocator.getService('dialog');\n                this.dialog.show({\n                    header: headerContent.outerHTML,\n                    content: categoryContent.outerHTML + dropDownElement.outerHTML + listViewElement.outerHTML +\n                        descriptionContent.outerHTML + formulaDescription.outerHTML,\n                    width: '320px', height: '485px', cssClass: 'e-spreadsheet-function-dlg',\n                    showCloseIcon: true, isModal: true,\n                    beforeOpen: function (args) {\n                        var dlgArgs = {\n                            dialogName: 'InsertFunctionDialog', element: args.element, target: args.target, cancel: args.cancel\n                        };\n                        _this.parent.trigger('dialogBeforeOpen', dlgArgs);\n                        if (dlgArgs.cancel) {\n                            args.cancel = true;\n                        }\n                        _this.parent.element.focus();\n                    },\n                    open: this.dialogOpen.bind(this), beforeClose: this.dialogBeforeClose.bind(this), close: this.dialogClose.bind(this),\n                    buttons: [\n                        {\n                            click: (this.selectFormula.bind(this, this.dialog, this)),\n                            buttonModel: { content: l10n.getConstant('Ok'), isPrimary: true }\n                        }\n                    ]\n                });\n                this.categoryList.appendTo('#' + this.parent.element.id + '_formula_category');\n                this.formulaList.appendTo('#' + this.parent.element.id + '_formula_list');\n                EventHandler.add(this.formulaList.element, 'dblclick', this.formulaClickHandler, this);\n            }\n        }\n    };\n    FormulaBar.prototype.toggleFormulaBar = function (target) {\n        var parent = target.parentElement;\n        var l10n = this.parent.serviceLocator.getService(locale);\n        if (parent.classList.contains('e-expanded')) {\n            parent.classList.remove('e-expanded');\n            document.getElementById(this.parent.element.id + '_formula_input').rows = 1;\n            target.title = l10n.getConstant('ExpandFormulaBar');\n        }\n        else {\n            parent.classList.add('e-expanded');\n            document.getElementById(this.parent.element.id + '_formula_input').rows = 3;\n            target.title = l10n.getConstant('CollapseFormulaBar');\n        }\n        this.parent.setPanelSize();\n    };\n    FormulaBar.prototype.dialogOpen = function () {\n        this.focusOkButton();\n    };\n    FormulaBar.prototype.dialogClose = function () {\n        var args = { action: 'getCurrentEditValue', editedValue: '' };\n        this.parent.notify(editOperation, args);\n        if (args.editedValue.toString().trim() === '=') {\n            this.parent.notify(editOperation, { action: 'refreshEditor', value: '' });\n        }\n    };\n    FormulaBar.prototype.dialogBeforeClose = function () {\n        EventHandler.remove(this.formulaList.element, 'dblclick', this.formulaClickHandler);\n        var dialogContentEle = document.getElementById('_dialog-content');\n        dialogContentEle.parentNode.removeChild(dialogContentEle);\n        /* tslint:disable-next-line:no-any */\n        this.dialog.dialogInstance.storeActiveElement = document.getElementById(this.parent.element.id + '_edit');\n    };\n    FormulaBar.prototype.selectFormula = function (dialog, formulaBarObj) {\n        var formulaText = formulaBarObj.formulaList.getSelectedItems().text;\n        var sheet = getSheet(this.parent, this.parent.activeSheetIndex);\n        if (this.parent.isEdit) {\n            this.parent.notify(editOperation, {\n                action: 'refreshEditor', value: formulaText + '(', refreshFormulaBar: true,\n                refreshEditorElem: true, isAppend: true\n            });\n        }\n        else {\n            this.parent.notify(editOperation, { action: 'startEdit', value: '=' + formulaText + '(', address: sheet.activeCell });\n            this.parent.notify(formulaBarOperation, { action: 'refreshFormulabar', value: '=' + formulaText + '(' });\n        }\n        dialog.hide();\n    };\n    FormulaBar.prototype.listSelected = function () {\n        this.updateFormulaDescription();\n    };\n    FormulaBar.prototype.updateFormulaList = function () {\n        this.activeListFormula();\n        this.updateFormulaDescription();\n    };\n    FormulaBar.prototype.dropDownSelect = function (args) {\n        this.formulaCollection = [];\n        var listArgs = {\n            action: 'getLibraryFormulas',\n            formulaCollection: []\n        };\n        if (args.item.textContent === 'All') {\n            this.parent.notify(workbookFormulaOperation, listArgs);\n            this.formulaCollection = listArgs.formulaCollection;\n        }\n        else {\n            var category = args.item.textContent;\n            var selectArgs = {\n                action: 'dropDownSelectFormulas',\n                formulaCollection: [],\n                selectCategory: category,\n            };\n            this.parent.notify(workbookFormulaOperation, selectArgs);\n            this.formulaCollection = selectArgs.formulaCollection;\n        }\n        this.formulaList.dataSource = this.formulaCollection.sort();\n    };\n    FormulaBar.prototype.focusOkButton = function () {\n        var focusEle = document.getElementById('_dialog-content');\n        (focusEle.nextElementSibling.firstElementChild).focus();\n    };\n    FormulaBar.prototype.activeListFormula = function () {\n        var acListEle = document.getElementById(this.parent.element.id + '_formula_list');\n        var firstElement = acListEle.children[0].children[0].firstElementChild;\n        this.formulaList.selectItem(firstElement);\n    };\n    FormulaBar.prototype.updateFormulaDescription = function () {\n        var descriptionArea;\n        var selectedFormula = this.formulaList.getSelectedItems().text;\n        var descriptionArgs = {\n            action: 'getFormulaDescription',\n            description: '',\n            selectedList: selectedFormula,\n        };\n        this.parent.notify(workbookFormulaOperation, descriptionArgs);\n        this.focusOkButton();\n        descriptionArea = document.getElementById(this.parent.element.id + '_description_content');\n        selectedFormula = (selectedFormula === 'AND') ? 'CalculateAND' : (selectedFormula === 'OR') ? 'CalculateOR' : selectedFormula;\n        descriptionArea.innerHTML = this.parent.serviceLocator.getService(locale).getConstant(selectedFormula);\n    };\n    FormulaBar.prototype.formulaClickHandler = function (args) {\n        var trgtElem = args.target;\n        var sheet = getSheet(this.parent, this.parent.activeSheetIndex);\n        if (trgtElem.offsetParent.classList.contains('e-text-content') || trgtElem.classList.contains('e-list-item')) {\n            if (this.parent.isEdit) {\n                this.parent.notify(editOperation, {\n                    action: 'refreshEditor', value: trgtElem.innerText + '(', refreshFormulaBar: true,\n                    refreshEditorElem: true, isAppend: true\n                });\n            }\n            else {\n                this.parent.notify(editOperation, { action: 'startEdit', value: '=' + trgtElem.innerText + '(', address: sheet.activeCell });\n                this.parent.notify(formulaBarOperation, { action: 'refreshFormulabar', value: '=' + trgtElem.innerText + '(' });\n            }\n            this.dialog.hide();\n        }\n    };\n    FormulaBar.prototype.addEventListener = function () {\n        this.parent.on(formulaBar, this.createFormulaBar, this);\n        this.parent.on(click, this.formulaBarClickHandler, this);\n        this.parent.on(keyDown, this.keyDownHandler, this);\n        this.parent.on(keyUp, this.keyUpHandler, this);\n        this.parent.on(selectionComplete, this.formulaBarUpdateHandler, this);\n        this.parent.on(mouseUpAfterSelection, this.UpdateValueAfterMouseUp, this);\n        this.parent.on(formulaBarOperation, this.editOperationHandler, this);\n        this.parent.on(enableFormulaInput, this.disabletextarea, this);\n        this.parent.on(isFormulaBarEdit, this.isFormulaBarEdit, this);\n    };\n    FormulaBar.prototype.destroy = function () {\n        this.removeEventListener();\n        this.comboBoxInstance.destroy();\n        this.comboBoxInstance = null;\n        this.insertFnRipple();\n        this.insertFnRipple = null;\n        var formulaPanel = this.parent.element.querySelector('.e-formula-bar-panel');\n        if (formulaPanel) {\n            detach(formulaPanel);\n        }\n    };\n    FormulaBar.prototype.removeEventListener = function () {\n        if (!this.parent.isDestroyed) {\n            this.parent.off(formulaBar, this.createFormulaBar);\n            this.parent.off(click, this.formulaBarClickHandler);\n            this.parent.off(keyDown, this.keyDownHandler);\n            this.parent.off(keyUp, this.keyUpHandler);\n            this.parent.off(selectionComplete, this.formulaBarUpdateHandler);\n            this.parent.off(mouseUpAfterSelection, this.UpdateValueAfterMouseUp);\n            this.parent.off(formulaBarOperation, this.editOperationHandler);\n            this.parent.off(enableFormulaInput, this.disabletextarea);\n            this.parent.off(isFormulaBarEdit, this.isFormulaBarEdit);\n        }\n    };\n    FormulaBar.prototype.editOperationHandler = function (args) {\n        var action = args.action;\n        switch (action) {\n            case 'refreshFormulabar':\n                this.getFormulaBar().value = isUndefined(args.value) ? '' : args.value;\n                break;\n            case 'getPosition':\n                args.position = this.getFormulaBar().getBoundingClientRect();\n                break;\n        }\n    };\n    FormulaBar.prototype.isFormulaBarEdit = function (args) {\n        var edit = this.parent.isEdit;\n        if (edit && this.isGoto) {\n            args.isEdit = true;\n        }\n        else {\n            args.isEdit = false;\n        }\n    };\n    FormulaBar.prototype.getFormulaBar = function () {\n        return select('#' + this.parent.element.id + '_formula_input', this.parent.element);\n    };\n    return FormulaBar;\n}());\nexport { FormulaBar };\n","import { formulaOperation, keyUp, keyDown, click, refreshFormulaDatasource } from '../common/event';\nimport { editOperation, formulaBarOperation } from '../common/event';\nimport { workbookFormulaOperation } from '../../workbook/common/event';\nimport { AutoComplete } from '@syncfusion/ej2-dropdowns';\nimport { detach, isNullOrUndefined, select } from '@syncfusion/ej2-base';\nimport { checkIsFormula, getSheet, getSheetName, getCellIndexes } from '../../workbook/index';\nimport { dialog, locale } from '../common/index';\n/**\n * @hidden\n * The `Formula` module is used to handle the formulas and its functionalities in Spreadsheet.\n */\nvar Formula = /** @class */ (function () {\n    /**\n     * Constructor for formula module in Spreadsheet.\n     * @private\n     */\n    function Formula(parent) {\n        this.isFormulaBar = false;\n        this.isFormula = false;\n        this.isPopupOpened = false;\n        this.isPreventClose = false;\n        this.isSubFormula = false;\n        this.keyCodes = {\n            UP: 38,\n            DOWN: 40,\n            LEFT: 37,\n            RIGHT: 39,\n            FIRSTALPHABET: 65,\n            LASTALPHABET: 90,\n            SPACE: 32,\n            BACKSPACE: 8,\n            TAB: 9,\n            DELETE: 46,\n            ENTER: 13,\n            ESC: 27\n        };\n        this.parent = parent;\n        this.addEventListener();\n        //Spreadsheet.Inject(WorkbookFormula);\n    }\n    /**\n     * Get the module name.\n     * @returns string\n     * @private\n     */\n    Formula.prototype.getModuleName = function () {\n        return 'formula';\n    };\n    /**\n     * To destroy the formula module.\n     * @return {void}\n     * @hidden\n     */\n    Formula.prototype.destroy = function () {\n        this.removeEventListener();\n        if (this.autocompleteInstance) {\n            this.autocompleteInstance.destroy();\n            if (this.autocompleteInstance.element) {\n                this.autocompleteInstance.element.remove();\n            }\n        }\n        this.autocompleteInstance = null;\n        this.parent = null;\n    };\n    Formula.prototype.addEventListener = function () {\n        this.parent.on(formulaOperation, this.performFormulaOperation, this);\n        this.parent.on(keyUp, this.keyUpHandler, this);\n        this.parent.on(keyDown, this.keyDownHandler, this);\n        this.parent.on(click, this.formulaClick, this);\n        this.parent.on(refreshFormulaDatasource, this.refreshFormulaDatasource, this);\n    };\n    Formula.prototype.removeEventListener = function () {\n        if (!this.parent.isDestroyed) {\n            this.parent.off(formulaOperation, this.performFormulaOperation);\n            this.parent.off(keyUp, this.keyUpHandler);\n            this.parent.off(keyDown, this.keyDownHandler);\n            this.parent.off(click, this.formulaClick);\n            this.parent.off(refreshFormulaDatasource, this.refreshFormulaDatasource);\n        }\n    };\n    Formula.prototype.performFormulaOperation = function (args) {\n        var _this = this;\n        var action = args.action;\n        switch (action) {\n            case 'renderAutoComplete':\n                this.renderAutoComplete();\n                break;\n            case 'endEdit':\n                this.endEdit();\n                break;\n            case 'addDefinedName':\n                args.isAdded = this.addDefinedName(args.definedName);\n                break;\n            case 'getNames':\n                if (!args.sheetName) {\n                    args.sheetName = getSheetName(this.parent);\n                }\n                args.names = this.getNames(args.sheetName);\n                break;\n            case 'getNameFromRange':\n                args.definedName = this.getNameFromRange(args.range);\n                break;\n            case 'isFormulaEditing':\n                args.isFormulaEdit = this.isFormula;\n                break;\n            case 'isCircularReference':\n                var l10n = this.parent.serviceLocator.getService(locale);\n                var dialogInst = this.parent.serviceLocator.getService(dialog);\n                dialogInst.show({\n                    height: 180, width: 400, isModal: true, showCloseIcon: true,\n                    content: l10n.getConstant('CircularReference'),\n                    beforeOpen: function (args) {\n                        var dlgArgs = {\n                            dialogName: 'CircularReferenceDialog',\n                            element: args.element, target: args.target, cancel: args.cancel\n                        };\n                        _this.parent.trigger('dialogBeforeOpen', dlgArgs);\n                        if (dlgArgs.cancel) {\n                            args.cancel = true;\n                        }\n                    },\n                });\n                args.argValue = '0';\n                break;\n        }\n    };\n    Formula.prototype.renderAutoComplete = function () {\n        if (!select('#' + this.parent.element.id + '_ac', this.parent.element)) {\n            var acElem = this.parent.createElement('input', { id: this.parent.element.id + '_ac', className: 'e-ss-ac' });\n            this.parent.element.appendChild(acElem);\n            var eventArgs = {\n                action: 'getLibraryFormulas',\n                formulaCollection: []\n            };\n            this.parent.notify(workbookFormulaOperation, eventArgs);\n            var autoCompleteOptions = {\n                dataSource: eventArgs.formulaCollection,\n                cssClass: 'e-ss-atc',\n                popupWidth: '130px',\n                allowFiltering: true,\n                filterType: 'StartsWith',\n                sortOrder: 'Ascending',\n                open: this.onSuggestionOpen.bind(this),\n                close: this.onSuggestionClose.bind(this),\n                select: this.onSelect.bind(this),\n                actionComplete: this.onSuggestionComplete.bind(this)\n            };\n            this.autocompleteInstance = new AutoComplete(autoCompleteOptions, acElem);\n            this.autocompleteInstance.createElement = this.parent.createElement;\n        }\n    };\n    Formula.prototype.onSuggestionOpen = function (e) {\n        var _this = this;\n        this.isPopupOpened = true;\n        var position = this.getPopupPosition();\n        e.popup.offsetX = position.left;\n        e.popup.offsetY = (position.top + position.height);\n        e.popup.refreshPosition();\n        e.popup.element.firstChild.style.maxHeight = '180px';\n        new Promise(function (resolve, reject) {\n            setTimeout(function () { resolve(); }, 100);\n        }).then(function () {\n            _this.triggerKeyDownEvent(_this.keyCodes.DOWN);\n        });\n    };\n    Formula.prototype.onSuggestionClose = function (e) {\n        if (this.isPreventClose) {\n            e.cancel = true;\n        }\n        else {\n            this.isPopupOpened = false;\n        }\n    };\n    Formula.prototype.onSelect = function (e) {\n        var updatedFormulaValue = '=' + e.itemData.value + '(';\n        if (this.isSubFormula) {\n            var editValue = this.getEditingValue();\n            var parseIndex = editValue.lastIndexOf(this.getArgumentSeparator());\n            if (parseIndex > -1) {\n                updatedFormulaValue = editValue.slice(0, parseIndex + 1);\n            }\n            else {\n                parseIndex = editValue.lastIndexOf('(');\n                if (parseIndex > -1) {\n                    updatedFormulaValue = editValue.slice(0, parseIndex + 1);\n                }\n            }\n            updatedFormulaValue += e.itemData.value + '(';\n        }\n        this.parent.notify(editOperation, {\n            action: 'refreshEditor', value: updatedFormulaValue,\n            refreshFormulaBar: true, refreshEditorElem: true, refreshCurPos: !this.isFormulaBar\n        });\n    };\n    Formula.prototype.onSuggestionComplete = function (args) {\n        this.isPreventClose = args.result.length > 0;\n        if (!this.isPreventClose) {\n            args.cancel = true;\n            this.hidePopUp();\n        }\n    };\n    Formula.prototype.refreshFormulaDatasource = function () {\n        var eventArgs = {\n            action: 'getLibraryFormulas',\n            formulaCollection: []\n        };\n        this.parent.notify(workbookFormulaOperation, eventArgs);\n        this.autocompleteInstance.dataSource = eventArgs.formulaCollection;\n    };\n    Formula.prototype.keyUpHandler = function (e) {\n        if (this.parent.isEdit) {\n            var editValue = this.getEditingValue();\n            this.isFormula = checkIsFormula(editValue);\n            if (this.isFormula || this.isPopupOpened) {\n                if (e.keyCode !== this.keyCodes.TAB && this.isFormula) {\n                    editValue = this.getSuggestionKeyFromFormula(editValue);\n                }\n                this.refreshFormulaSuggestion(e, editValue);\n            }\n        }\n        else if (this.isPopupOpened) {\n            this.hidePopUp();\n        }\n    };\n    Formula.prototype.keyDownHandler = function (e) {\n        var keyCode = e.keyCode;\n        if (this.isFormula) {\n            if (this.isPopupOpened) {\n                switch (keyCode) {\n                    case this.keyCodes.UP:\n                    case this.keyCodes.DOWN:\n                        e.preventDefault();\n                        this.triggerKeyDownEvent(keyCode);\n                        break;\n                    case this.keyCodes.TAB:\n                        e.preventDefault();\n                        this.triggerKeyDownEvent(this.keyCodes.ENTER);\n                        break;\n                }\n            }\n        }\n        else {\n            var trgtElem = e.target;\n            if (trgtElem.id === this.parent.element.id + '_name_box') {\n                switch (keyCode) {\n                    case this.keyCodes.ENTER:\n                        this.addDefinedName({ name: trgtElem.value });\n                        this.parent.element.focus();\n                        break;\n                    case this.keyCodes.ESC:\n                        this.parent.element.focus();\n                        break;\n                }\n            }\n        }\n    };\n    Formula.prototype.formulaClick = function (e) {\n        if (this.parent.isEdit) {\n            var trgtElem = e.target;\n            this.isFormulaBar = trgtElem.classList.contains('e-formula-bar');\n        }\n    };\n    Formula.prototype.refreshFormulaSuggestion = function (e, formula) {\n        if (formula.length > 0) {\n            var autoCompleteElem = this.autocompleteInstance.element;\n            var keyCode = e.keyCode;\n            var isSuggestionAlreadyOpened = this.isPopupOpened;\n            if (!this.isNavigationKey(keyCode)) {\n                autoCompleteElem.value = formula;\n                autoCompleteElem.dispatchEvent(new Event('input'));\n                autoCompleteElem.dispatchEvent(new Event('keyup'));\n                if (isSuggestionAlreadyOpened) {\n                    this.triggerKeyDownEvent(this.keyCodes.DOWN);\n                }\n            }\n        }\n        else {\n            if (this.isPopupOpened) {\n                this.isPreventClose = false;\n                this.hidePopUp();\n            }\n        }\n    };\n    Formula.prototype.endEdit = function () {\n        this.isSubFormula = false;\n        this.isPreventClose = false;\n        this.isFormula = false;\n        this.isFormulaBar = false;\n        if (this.isPopupOpened) {\n            this.hidePopUp();\n            var suggPopupElem = select('#' + this.parent.element.id + '_ac_popup');\n            if (suggPopupElem) {\n                detach(suggPopupElem);\n            }\n            this.isPopupOpened = false;\n        }\n    };\n    Formula.prototype.hidePopUp = function () {\n        this.autocompleteInstance.hidePopup();\n    };\n    Formula.prototype.getSuggestionKeyFromFormula = function (formula) {\n        var suggestValue = '';\n        formula = formula.substr(1); //remove = char.\n        if (formula) {\n            var bracketIndex = formula.lastIndexOf('(');\n            formula = formula.substr(bracketIndex + 1);\n            var fSplit = formula.split(this.getArgumentSeparator());\n            if (fSplit.length === 1) {\n                suggestValue = fSplit[0];\n                this.isSubFormula = bracketIndex > -1;\n            }\n            else {\n                suggestValue = fSplit[fSplit.length - 1];\n                this.isSubFormula = true;\n            }\n            var isAlphaNumeric = suggestValue.match(/\\w/);\n            if (!isAlphaNumeric || (isAlphaNumeric && isAlphaNumeric.index !== 0)) {\n                suggestValue = '';\n            }\n        }\n        return suggestValue;\n    };\n    Formula.prototype.getPopupPosition = function () {\n        var eventArgs = { position: null };\n        if (this.isFormulaBar) {\n            eventArgs.action = 'getPosition';\n            this.parent.notify(formulaBarOperation, eventArgs);\n        }\n        else {\n            eventArgs.action = 'getPosition';\n            this.parent.notify(editOperation, eventArgs);\n        }\n        return eventArgs.position;\n    };\n    Formula.prototype.getEditingValue = function () {\n        var eventArgs = { action: 'getCurrentEditValue', editedValue: '' };\n        this.parent.notify(editOperation, eventArgs);\n        return eventArgs.editedValue;\n    };\n    Formula.prototype.isNavigationKey = function (keyCode) {\n        return (keyCode === this.keyCodes.UP) || (keyCode === this.keyCodes.DOWN) || (keyCode === this.keyCodes.LEFT)\n            || (keyCode === this.keyCodes.RIGHT);\n    };\n    Formula.prototype.triggerKeyDownEvent = function (keyCode) {\n        var autoCompleteElem = this.autocompleteInstance.element;\n        autoCompleteElem.dispatchEvent(new Event('input'));\n        var eventArg = new Event('keydown');\n        // tslint:disable:no-string-literal\n        eventArg['keyCode'] = keyCode;\n        eventArg['which'] = keyCode;\n        eventArg['altKey'] = false;\n        eventArg['shiftKey'] = false;\n        eventArg['ctrlKey'] = false;\n        // tslint:enable:no-string-literal\n        autoCompleteElem.dispatchEvent(eventArg);\n    };\n    Formula.prototype.getArgumentSeparator = function () {\n        if (this.argumentSeparator) {\n            return this.argumentSeparator;\n        }\n        else {\n            var eventArgs = {\n                action: 'getArgumentSeparator', argumentSeparator: ''\n            };\n            this.parent.notify(workbookFormulaOperation, eventArgs);\n            this.argumentSeparator = eventArgs.argumentSeparator;\n            return eventArgs.argumentSeparator;\n        }\n    };\n    Formula.prototype.getNames = function (sheetName) {\n        var names = this.parent.definedNames.filter(function (name) { return name.scope === 'Workbook' || name.scope === '' || name.scope === sheetName; });\n        return names;\n    };\n    Formula.prototype.getNameFromRange = function (range) {\n        var singleRange = range.slice(0, range.indexOf(':'));\n        var sRange = range.slice(range.indexOf('!') + 1).split(':');\n        var isSingleCell = sRange.length > 1 && sRange[0] === sRange[1];\n        var name = this.parent.definedNames.filter(function (name, index) {\n            if (isSingleCell && name.refersTo === '=' + singleRange) {\n                return true;\n            }\n            return name.refersTo === '=' + range;\n        });\n        return name && name[0];\n    };\n    Formula.prototype.addDefinedName = function (definedName) {\n        var _this = this;\n        var name = definedName.name;\n        var isAdded = false;\n        if (!definedName.refersTo) {\n            var sheet = getSheet(this.parent, this.parent.activeSheetIndex);\n            var sheetName = getSheetName(this.parent);\n            sheetName = sheetName.indexOf(' ') !== -1 ? '\\'' + sheetName + '\\'' : sheetName;\n            var selectRange = sheet.selectedRange;\n            if (!isNullOrUndefined(selectRange)) {\n                var colIndex = selectRange.indexOf(':');\n                var left = selectRange.substr(0, colIndex);\n                var right = selectRange.substr(colIndex + 1, selectRange.length);\n                if (parseInt(right.replace(/\\D/g, ''), 10) === sheet.rowCount && parseInt(left.replace(/\\D/g, ''), 10) === 1) {\n                    right = right.replace(/[0-9]/g, '');\n                    left = left.replace(/[0-9]/g, '');\n                    selectRange = '$' + left + ':$' + right;\n                }\n                else if (getCellIndexes(right)[1] === sheet.colCount - 1 && getCellIndexes(left)[1] === 0) {\n                    right = right.replace(/\\D/g, '');\n                    left = left.replace(/\\D/g, '');\n                    selectRange = '$' + left + ':$' + right;\n                }\n                else {\n                    selectRange = left === right ? left : selectRange;\n                }\n            }\n            definedName.refersTo = sheetName + '!' + selectRange;\n            definedName.scope = 'Workbook';\n        }\n        if (name.length > 0 && (/^([a-zA-Z_0-9.]){0,255}$/.test(name))) {\n            var eventArgs = {\n                action: 'addDefinedName', definedName: definedName, isAdded: false\n            };\n            this.parent.notify(workbookFormulaOperation, eventArgs);\n            isAdded = eventArgs.isAdded;\n            if (!eventArgs.isAdded) {\n                this.parent.serviceLocator.getService(dialog).show({\n                    content: this.parent.serviceLocator.getService(locale).getConstant('DefineNameExists'),\n                    width: '300',\n                    beforeOpen: function (args) {\n                        var dlgArgs = {\n                            dialogName: 'DefineNameExistsDialog',\n                            element: args.element, target: args.target, cancel: args.cancel\n                        };\n                        _this.parent.trigger('dialogBeforeOpen', dlgArgs);\n                        if (dlgArgs.cancel) {\n                            args.cancel = true;\n                        }\n                    },\n                });\n            }\n        }\n        else {\n            this.parent.serviceLocator.getService(dialog).show({\n                content: this.parent.serviceLocator.getService(locale).getConstant('DefineNameInValid'),\n                width: '300',\n                beforeOpen: function (args) {\n                    var dlgArgs = {\n                        dialogName: 'DefineNameInValidDialog',\n                        element: args.element, target: args.target, cancel: args.cancel\n                    };\n                    _this.parent.trigger('dialogBeforeOpen', dlgArgs);\n                    if (dlgArgs.cancel) {\n                        args.cancel = true;\n                    }\n                },\n            });\n        }\n        return isAdded;\n    };\n    return Formula;\n}());\nexport { Formula };\n","import { Tab } from '@syncfusion/ej2-navigations';\nimport { refreshSheetTabs, locale, insertSheetTab, cMenuBeforeOpen, dialog, renameSheet, hideSheet, beginAction } from '../common/index';\nimport { sheetNameUpdate, clearUndoRedoCollection, completeAction, showAggregate } from '../common/index';\nimport { sheetTabs, renameSheetTab, removeSheetTab, activeSheetChanged, onVerticalScroll, onHorizontalScroll } from '../common/index';\nimport { protectSheet, editOperation } from '../common/index';\nimport { getSheetName, aggregateComputation } from '../../workbook/index';\nimport { isSingleCell, getRangeIndexes, getSheet, getSheetIndex } from '../../workbook/index';\nimport { DropDownButton } from '@syncfusion/ej2-splitbuttons';\nimport { isCollide, calculatePosition } from '@syncfusion/ej2-popups';\nimport { rippleEffect, closest, EventHandler, remove, isNullOrUndefined } from '@syncfusion/ej2-base';\nimport { sheetsDestroyed, activeCellChanged, workbookFormulaOperation } from '../../workbook/common/index';\nimport { insertModel, checkIsFormula } from './../../workbook/common/index';\n/**\n * Represents SheetTabs for Spreadsheet.\n */\nvar SheetTabs = /** @class */ (function () {\n    function SheetTabs(parent) {\n        this.aggregateContent = '';\n        this.isSelectCancel = false;\n        this.selaggregateCnt = 'Sum';\n        this.parent = parent;\n        this.addEventListener();\n    }\n    SheetTabs.prototype.getModuleName = function () {\n        return 'sheetTabs';\n    };\n    SheetTabs.prototype.createSheetTabs = function () {\n        var _this = this;\n        if (!this.parent.showSheetTabs && this.tabInstance) {\n            this.destroy();\n            return;\n        }\n        var l10n = this.parent.serviceLocator.getService(locale);\n        var panel = this.parent.createElement('div', {\n            className: 'e-sheet-tab-panel', id: this.parent.element.id + '_sheet_tab_panel'\n        });\n        var addBtn = this.parent.createElement('button', {\n            className: 'e-add-sheet-tab e-btn e-css e-flat e-icon-btn' + (this.parent.allowInsert ? '' : ' e-disabled'),\n            attrs: { 'title': l10n.getConstant('AddSheet') }\n        });\n        addBtn.appendChild(this.parent.createElement('span', { className: 'e-btn-icon e-icons e-add-icon' }));\n        addBtn.addEventListener('click', this.addSheetTab.bind(this));\n        addBtn.disabled = !this.parent.allowInsert;\n        panel.appendChild(addBtn);\n        if (this.parent.allowInsert) {\n            this.addBtnRipple = rippleEffect(panel, { selector: '.e-add-sheet-tab' });\n        }\n        var ddb = this.parent.createElement('button', { attrs: { 'title': l10n.getConstant('ListAllSheets') } });\n        panel.appendChild(ddb);\n        this.parent.element.appendChild(panel);\n        var items = this.getSheetTabItems();\n        this.dropDownInstance = new DropDownButton({\n            iconCss: 'e-icons',\n            items: items.ddbItems,\n            beforeItemRender: function (args) {\n                var sheet = _this.parent.sheets[_this.dropDownInstance.items.indexOf(args.item)];\n                if (sheet.state === 'Hidden') {\n                    args.element.classList.add('e-hide');\n                }\n                else if (sheet.state === 'VeryHidden') {\n                    args.element.style.display = 'none';\n                }\n            },\n            select: function (args) { return _this.updateSheetTab({ idx: _this.dropDownInstance.items.indexOf(args.item) }); },\n            beforeOpen: function (args) { return _this.beforeOpenHandler(_this.dropDownInstance, args.element); },\n            open: function (args) { return _this.openHandler(_this.dropDownInstance, args.element, 'left'); },\n            cssClass: 'e-sheets-list e-flat e-caret-hide',\n            close: function () { return _this.parent.element.focus(); }\n        });\n        this.dropDownInstance.createElement = this.parent.createElement;\n        this.dropDownInstance.appendTo(ddb);\n        var sheetTab = this.parent.createElement('div', { className: 'e-sheet-tab' });\n        this.tabInstance = new Tab({\n            selectedItem: this.parent.activeSheetIndex,\n            overflowMode: 'Scrollable',\n            items: items.tabItems,\n            scrollStep: 250,\n            selecting: function (args) {\n                var beginEventArgs = {\n                    currentSheetIndex: args.selectingIndex, previousSheetIndex: args.selectedIndex, cancel: false\n                };\n                if (!_this.isSelectCancel) {\n                    _this.parent.notify(beginAction, { eventArgs: beginEventArgs, action: 'gotoSheet' });\n                }\n                _this.isSelectCancel = beginEventArgs.cancel;\n            },\n            selected: function (args) {\n                if (args.selectedIndex === args.previousIndex) {\n                    return;\n                }\n                if (_this.parent.isEdit) {\n                    _this.parent.endEdit();\n                }\n                if (_this.isSelectCancel) {\n                    _this.tabInstance.selectedItem = args.previousIndex;\n                    _this.tabInstance.dataBind();\n                    _this.parent.element.focus();\n                }\n                else {\n                    _this.parent.activeSheetIndex = args.selectedIndex;\n                    _this.parent.dataBind();\n                    _this.updateDropDownItems(args.selectedIndex, args.previousIndex);\n                    _this.parent.element.focus();\n                    var completeEventArgs = {\n                        previousSheetIndex: args.previousIndex, currentSheetIndex: args.selectedIndex\n                    };\n                    _this.parent.notify(completeAction, { eventArgs: completeEventArgs, action: 'gotoSheet' });\n                    var eventArgs = {\n                        action: 'registerGridInCalc',\n                        sheetID: (args.selectedIndex + 1).toString()\n                    };\n                    _this.parent.notify(workbookFormulaOperation, eventArgs);\n                }\n            },\n            created: function () {\n                var tBarItems = _this.tabInstance.element.querySelector('.e-toolbar-items');\n                tBarItems.classList.add('e-sheet-tabs-items');\n                EventHandler.add(tBarItems, 'dblclick', _this.renameSheetTab, _this);\n            },\n        });\n        panel.appendChild(sheetTab);\n        this.tabInstance.createElement = this.parent.createElement;\n        this.tabInstance.appendTo(sheetTab);\n        // tslint:disable-next-line:no-any\n        EventHandler.remove(this.tabInstance.element, 'keydown', this.tabInstance.spaceKeyDown);\n        var sheetCount = items.tabItems.length;\n        for (var i = 0; i < sheetCount; i++) {\n            var sheetName = getSheetName(this.parent, i);\n            var arg = { action: 'addSheet', sheetName: 'Sheet' + (i + 1), index: i + 1, visibleName: sheetName };\n            this.parent.notify(workbookFormulaOperation, arg);\n        }\n        this.parent.notify(workbookFormulaOperation, { action: 'initiateDefinedNames' });\n        this.parent.notify(protectSheet, null);\n    };\n    SheetTabs.prototype.updateDropDownItems = function (curIdx, prevIdx) {\n        if (prevIdx > -1) {\n            this.dropDownInstance.items[prevIdx].iconCss = '';\n        }\n        this.dropDownInstance.items[curIdx].iconCss = 'e-selected-icon e-icons';\n        this.dropDownInstance.setProperties({ 'items': this.dropDownInstance.items }, true);\n    };\n    SheetTabs.prototype.beforeOpenHandler = function (instance, element) {\n        var viewportHeight = this.parent.viewport.height;\n        var actualHeight = (parseInt(getComputedStyle(element.firstElementChild).height, 10) *\n            instance.items.length) + (parseInt(getComputedStyle(element).paddingTop, 10) * 2);\n        if (actualHeight > viewportHeight) {\n            element.style.height = viewportHeight + \"px\";\n            element.style.overflowY = 'auto';\n        }\n        element.parentElement.style.visibility = 'hidden';\n    };\n    SheetTabs.prototype.openHandler = function (instance, element, positionX) {\n        var wrapper = element.parentElement;\n        var height;\n        var collide = isCollide(wrapper);\n        if (collide.indexOf('bottom') === -1) {\n            height = element.style.overflowY === 'auto' ? this.parent.viewport.height : wrapper.getBoundingClientRect().height;\n            var offset = calculatePosition(instance.element, positionX, 'top');\n            if (positionX === 'right') {\n                offset.left -= wrapper.getBoundingClientRect().width;\n            }\n            wrapper.style.left = offset.left + \"px\";\n            wrapper.style.top = offset.top - height + \"px\";\n        }\n        wrapper.style.visibility = '';\n    };\n    SheetTabs.prototype.getSheetTabItems = function () {\n        var _this = this;\n        var tabItems = [];\n        var ddbItems = [];\n        var sheetName;\n        this.parent.sheets.forEach(function (sheet, index) {\n            sheetName = getSheetName(_this.parent, index);\n            tabItems.push({ header: { 'text': sheetName }, cssClass: sheet.state === 'Visible' ? '' : 'e-hide' });\n            ddbItems.push({ text: sheetName, iconCss: index === _this.parent.activeSheetIndex ? 'e-selected-icon e-icons' : '' });\n        });\n        return { tabItems: tabItems, ddbItems: ddbItems };\n    };\n    SheetTabs.prototype.refreshSheetTab = function () {\n        var items = this.getSheetTabItems();\n        this.dropDownInstance.items = items.ddbItems;\n        this.dropDownInstance.setProperties({ 'items': this.dropDownInstance.items }, true);\n        this.tabInstance.items = items.tabItems;\n        this.tabInstance.selectedItem = this.parent.activeSheetIndex;\n        this.tabInstance.dataBind();\n    };\n    SheetTabs.prototype.addSheetTab = function () {\n        var eventArgs = { action: 'getCurrentEditValue', editedValue: '' };\n        this.parent.notify(editOperation, eventArgs);\n        var val = eventArgs.editedValue;\n        var isFormulaEdit = checkIsFormula(val) || val && val !== '' ? val.indexOf('=') === 0 : false;\n        this.parent.notify(insertModel, { model: this.parent, start: this.parent.activeSheetIndex + 1, end: this.parent.activeSheetIndex + 1, modelType: 'Sheet', isAction: true, activeSheetIndex: this.parent.activeSheetIndex + 1 });\n        this.parent.element.focus();\n    };\n    SheetTabs.prototype.insertSheetTab = function (args) {\n        if (!args.preventUpdate || args.startIdx === this.tabInstance.selectedItem) {\n            this.dropDownInstance.items[this.tabInstance.selectedItem].iconCss = '';\n        }\n        for (var i = args.startIdx; i <= args.endIdx; i++) {\n            var sheetName = this.parent.sheets[i].name;\n            this.dropDownInstance.items.splice(i, 0, { text: sheetName });\n            this.tabInstance.addTab([{ header: { text: sheetName }, content: '' }], i);\n        }\n        if (!args.preventUpdate || args.startIdx === this.tabInstance.selectedItem) {\n            this.dropDownInstance.items[args.startIdx].iconCss = 'e-selected-icon e-icons';\n        }\n        this.dropDownInstance.setProperties({ 'items': this.dropDownInstance.items }, true);\n        if (args.preventUpdate) {\n            if (args.startIdx !== this.tabInstance.selectedItem) {\n                this.refreshSheetTab();\n            }\n        }\n        else {\n            this.updateSheetTab({ idx: args.startIdx });\n        }\n    };\n    SheetTabs.prototype.updateSheetTab = function (args) {\n        if (args.name === 'activeSheetChanged') {\n            args.idx = this.parent.skipHiddenSheets(args.idx);\n        }\n        else {\n            if (this.parent.sheets[args.idx].state === 'Hidden') {\n                this.parent.setSheetPropertyOnMute(this.parent.sheets[args.idx], 'state', 'Visible');\n                this.tabInstance.items[args.idx].cssClass = '';\n                this.tabInstance.items = this.tabInstance.items;\n                this.tabInstance.dataBind();\n            }\n        }\n        this.tabInstance.selectedItem = args.idx;\n        this.tabInstance.dataBind();\n        this.parent.notify(protectSheet, null);\n    };\n    SheetTabs.prototype.switchSheetTab = function (args) {\n        var target = closest(args.event.target, '.e-toolbar-item');\n        if (!target) {\n            return;\n        }\n        var text = target.querySelector('.e-tab-text').textContent;\n        for (var i = 0, len = this.tabInstance.items.length; i < len; i++) {\n            if (this.tabInstance.items[i].header.text === text) {\n                if (this.parent.activeSheetIndex !== i) {\n                    this.updateSheetTab({ idx: i });\n                }\n                break;\n            }\n        }\n        if (args.element.classList.contains('e-contextmenu') && args.items[0] &&\n            args.items[0].id === this.parent.element.id + \"_cmenu_insert_sheet\") {\n            if (this.skipHiddenSheets() === 1) {\n                //let id: string = `${this.parent.element.id}_cmenu`;\n                //this.parent.enableFileMenuItems([`${id}_hide_sheet`, `${id}_delete_sheet`], false, true);\n                args.element.children[1].classList.add('e-disabled');\n                args.element.children[3].classList.add('e-disabled');\n            }\n            if (!this.parent.allowInsert) {\n                args.element.children[0].classList.add('e-disabled');\n            }\n            if (!this.parent.allowDelete) {\n                args.element.children[1].classList.add('e-disabled');\n            }\n        }\n    };\n    SheetTabs.prototype.skipHiddenSheets = function () {\n        var count = this.parent.sheets.length;\n        this.parent.sheets.forEach(function (sheet) {\n            if (sheet.state !== 'Visible') {\n                --count;\n            }\n        });\n        return count;\n    };\n    SheetTabs.prototype.renameSheetTab = function () {\n        var target = this.tabInstance.element.querySelector('.e-toolbar-item.e-active');\n        if (target) {\n            target = target.querySelector('.e-text-wrap');\n            var value = target.querySelector('.e-tab-text').textContent;\n            var input = this.parent.createElement('input', {\n                id: this.parent.element.id + '_rename_input',\n                className: 'e-input e-sheet-rename', styles: \"width: \" + target.getBoundingClientRect().width + \"px\", attrs: {\n                    'type': 'text', 'name': 'Rename', 'required': '', 'value': value, 'spellcheck': 'false', 'maxlength': '31'\n                }\n            });\n            target.firstElementChild.style.display = 'none';\n            target.appendChild(input);\n            EventHandler.add(document, 'mousedown touchstart', this.renameInputFocusOut, this);\n            EventHandler.add(input, 'input', this.updateWidth, this);\n            input.focus();\n            input.setSelectionRange(0, value.length);\n            EventHandler.remove(closest(target, '.e-toolbar-items'), 'dblclick', this.renameSheetTab);\n        }\n    };\n    SheetTabs.prototype.updateWidth = function (e) {\n        var target = e.target;\n        var len = target.value.length;\n        var value = target.value.split(' ');\n        if (value.length) {\n            var spaceLen = value.length - 1;\n            len -= spaceLen;\n            len += (spaceLen * 0.5);\n        }\n        target.style.width = len + \"ch\";\n    };\n    SheetTabs.prototype.renameInputFocusOut = function (e) {\n        var target = e.target;\n        if ((e.type === 'mousedown' || e.type === 'touchstart') && (target.classList.contains('e-sheet-rename') ||\n            closest(target, '.e-dlg-container'))) {\n            return;\n        }\n        target = document.getElementById(this.parent.element.id + '_rename_input');\n        if (e.type === 'keydown' && e.keyCode === 27) {\n            this.removeRenameInput(target);\n            this.parent.element.focus();\n            return;\n        }\n        var value = target.value;\n        var l10n = this.parent.serviceLocator.getService(locale);\n        if (value) {\n            var idx = this.tabInstance.selectedItem;\n            if (!value.match(new RegExp('.*[\\\\[\\\\]\\\\*\\\\\\\\\\/\\\\?].*'))) {\n                if (this.tabInstance.items[idx].header.text !== value) {\n                    for (var i = 0, len = this.parent.sheets.length; i < len; i++) {\n                        if (i !== this.parent.activeSheetIndex && this.parent.sheets[i].name.toLowerCase() === value.toLowerCase()) {\n                            this.showRenameDialog(target, l10n.getConstant('SheetRenameAlreadyExistsAlert'));\n                            return;\n                        }\n                    }\n                }\n                var items = this.removeRenameInput(target);\n                if (this.tabInstance.items[idx].header.text !== value) {\n                    this.parent.setSheetPropertyOnMute(this.parent.sheets[idx], 'name', value);\n                    this.updateSheetName({ value: value, idx: idx, items: items });\n                }\n                if (e.type === 'keydown' || (closest(e.target, '.e-spreadsheet'))) {\n                    this.parent.element.focus();\n                }\n            }\n            else {\n                this.showRenameDialog(target, l10n.getConstant('SheetRenameInvalidAlert'));\n            }\n        }\n        else {\n            this.showRenameDialog(target, l10n.getConstant('SheetRenameEmptyAlert'));\n        }\n        var sheetIndex = this.parent.getActiveSheet().id;\n        var args = { action: 'renameUpdation', value: value, sheetId: sheetIndex };\n        this.parent.notify(workbookFormulaOperation, args);\n        var eventArgs = {\n            index: sheetIndex,\n            value: value\n        };\n        this.parent.notify(completeAction, { eventArgs: eventArgs, action: 'renameSheet' });\n    };\n    SheetTabs.prototype.updateSheetName = function (args) {\n        this.tabInstance.items[args.idx].header.text = args.value;\n        this.dropDownInstance.items[args.idx].text = args.value;\n        this.dropDownInstance.setProperties({ 'items': this.dropDownInstance.items }, true);\n        if (args.value.indexOf('  ') > -1) {\n            this.tabInstance.setProperties({ 'items': this.tabInstance.items }, true);\n            args.items.querySelector('.e-toolbar-item.e-active .e-tab-text').textContent = args.value;\n        }\n        else {\n            this.tabInstance.items = this.tabInstance.items;\n            this.tabInstance.dataBind();\n        }\n    };\n    SheetTabs.prototype.hideSheet = function () {\n        this.parent.setSheetPropertyOnMute(this.parent.getActiveSheet(), 'state', 'Hidden');\n        this.tabInstance.items[this.parent.activeSheetIndex].cssClass = 'e-hide';\n        this.tabInstance.items = this.tabInstance.items;\n        this.tabInstance.dataBind();\n        this.tabInstance.selectedItem = this.parent.skipHiddenSheets(this.parent.activeSheetIndex === this.parent.sheets.length - 1 ? this.parent.activeSheetIndex - 1 :\n            this.parent.activeSheetIndex + 1);\n        this.tabInstance.dataBind();\n    };\n    SheetTabs.prototype.removeRenameInput = function (target) {\n        var textEle = target.parentElement.querySelector('.e-tab-text');\n        var sheetItems = closest(target, '.e-toolbar-items');\n        EventHandler.add(sheetItems, 'dblclick', this.renameSheetTab, this);\n        EventHandler.remove(document, 'mousedown touchstart', this.renameInputFocusOut);\n        EventHandler.remove(target, 'input', this.updateWidth);\n        remove(target);\n        textEle.style.display = '';\n        return sheetItems;\n    };\n    SheetTabs.prototype.showRenameDialog = function (target, content) {\n        var _this = this;\n        var dialogInst = this.parent.serviceLocator.getService(dialog);\n        dialogInst.show({\n            target: document.getElementById(this.parent.element.id + '_sheet_panel'),\n            height: 180, width: 400, isModal: true, showCloseIcon: true,\n            content: content,\n            beforeOpen: function (args) {\n                var dlgArgs = {\n                    dialogName: 'SheetRenameDialog',\n                    element: args.element, target: args.target, cancel: args.cancel\n                };\n                _this.parent.trigger('dialogBeforeOpen', dlgArgs);\n                if (dlgArgs.cancel) {\n                    args.cancel = true;\n                }\n                target.focus();\n            },\n            close: function () { return target.setSelectionRange(0, target.value.length); }\n        });\n    };\n    SheetTabs.prototype.focusRenameInput = function () {\n        var input = document.getElementById(this.parent.element.id + '_rename_input');\n        if (input) {\n            input.focus();\n        }\n    };\n    SheetTabs.prototype.removeSheetTab = function (args) {\n        var _this = this;\n        if (args.count && (args.count === this.parent.sheets.length)) {\n            return;\n        }\n        var l10n = this.parent.serviceLocator.getService(locale);\n        if (this.skipHiddenSheets() > 1) {\n            var sheet = args.sheetName ? getSheet(this.parent, getSheetIndex(this.parent, args.sheetName)) :\n                this.parent.getActiveSheet();\n            var sheetIndex_1 = args.index || getSheetIndex(this.parent, sheet.name);\n            var eventArgs_1 = {\n                index: sheetIndex_1,\n                sheetCount: this.parent.sheets.length,\n                sheetName: sheet.name\n            };\n            var isDataAvail = sheet.rows && sheet.rows.length ?\n                (sheet.rows.length === 1 ? (sheet.rows[0].cells && sheet.rows[0].cells.length ? true : false) : true) : false;\n            if (isDataAvail) {\n                var dialogInst_1 = this.parent.serviceLocator.getService(dialog);\n                if (args.clicked) {\n                    this.forceDelete(sheetIndex_1);\n                }\n                else {\n                    dialogInst_1.show({\n                        height: 200, width: 400, isModal: true, showCloseIcon: true,\n                        content: l10n.getConstant('DeleteSheetAlert'),\n                        beforeOpen: function (args) {\n                            var dlgArgs = {\n                                dialogName: 'DeleteSheetDialog',\n                                element: args.element, target: args.target, cancel: args.cancel\n                            };\n                            _this.parent.trigger('dialogBeforeOpen', dlgArgs);\n                            if (dlgArgs.cancel) {\n                                args.cancel = true;\n                            }\n                            _this.parent.element.focus();\n                        },\n                        buttons: [{\n                                buttonModel: {\n                                    content: l10n.getConstant('Ok'), isPrimary: true\n                                },\n                                click: function () {\n                                    dialogInst_1.hide();\n                                    _this.forceDelete(sheetIndex_1);\n                                    _this.parent.notify(clearUndoRedoCollection, null);\n                                    if (args && !args.isAction) {\n                                        eventArgs_1.sheetCount = _this.parent.sheets.length;\n                                        _this.parent.notify(completeAction, { eventArgs: eventArgs_1, action: 'removeSheet' });\n                                    }\n                                }\n                            }]\n                    });\n                }\n            }\n            else {\n                var sheetArgs = {\n                    action: 'deleteSheetTab', sheetName: '', index: sheetIndex_1 + 1\n                };\n                this.parent.notify(workbookFormulaOperation, sheetArgs);\n                this.destroySheet(sheetIndex_1);\n                this.parent.notify(clearUndoRedoCollection, null);\n                if (args && !args.isAction) {\n                    eventArgs_1.sheetCount = this.parent.sheets.length;\n                    this.parent.notify(completeAction, { eventArgs: eventArgs_1, action: 'removeSheet' });\n                }\n            }\n        }\n        else {\n            this.parent.serviceLocator.getService(dialog).show({\n                target: document.getElementById(this.parent.element.id + '_sheet_panel'),\n                height: 180, width: 400, isModal: true, showCloseIcon: true,\n                content: l10n.getConstant('DeleteSingleLastSheetAlert'),\n                beforeOpen: function (args) {\n                    var dlgArgs = {\n                        dialogName: 'DeleteSingleSheetDialog',\n                        element: args.element, target: args.target, cancel: args.cancel\n                    };\n                    _this.parent.trigger('dialogBeforeOpen', dlgArgs);\n                    if (dlgArgs.cancel) {\n                        args.cancel = true;\n                    }\n                    _this.parent.element.focus();\n                },\n            });\n        }\n    };\n    SheetTabs.prototype.forceDelete = function (sheetIndex) {\n        var sheetArgs = {\n            action: 'deleteSheetTab', sheetName: '', index: sheetIndex + 1\n        };\n        this.parent.notify(workbookFormulaOperation, sheetArgs);\n        this.destroySheet(sheetIndex);\n    };\n    SheetTabs.prototype.destroySheet = function (sheetIndex) {\n        var activeSheetIdx = sheetIndex || this.parent.activeSheetIndex;\n        this.parent.removeSheet(activeSheetIdx);\n        this.parent.notify(sheetsDestroyed, { sheetIndex: activeSheetIdx });\n        this.dropDownInstance.items.splice(activeSheetIdx, 1);\n        this.dropDownInstance.setProperties({ 'items': this.dropDownInstance.items }, true);\n        this.tabInstance.removeTab(activeSheetIdx);\n        var activeIndex = this.parent.skipHiddenSheets(this.tabInstance.selectedItem);\n        this.parent.activeSheetIndex = activeIndex;\n        this.parent.setProperties({ activeSheetIndex: activeIndex }, true);\n        this.parent.renderModule.refreshSheet();\n        this.tabInstance.selectedItem = activeIndex;\n        this.tabInstance.dataBind();\n        this.updateDropDownItems(activeIndex);\n        this.parent.notify(protectSheet, null);\n        this.parent.element.focus();\n    };\n    SheetTabs.prototype.showAggregate = function () {\n        var _this = this;\n        if (isSingleCell(getRangeIndexes(this.parent.getActiveSheet().selectedRange))) {\n            return;\n        }\n        var eventArgs = { Count: 0, Sum: '0', Avg: '0', Min: '0', Max: '0', countOnly: true };\n        this.parent.notify(aggregateComputation, eventArgs);\n        if (eventArgs.Count > 1) {\n            this.aggregateContent = eventArgs.countOnly ? 'Count' : this.selaggregateCnt;\n            if (eventArgs.countOnly) {\n                this.aggregateContent = 'Count';\n                delete eventArgs.Sum;\n                delete eventArgs.Avg;\n                delete eventArgs.Min;\n                delete eventArgs.Max;\n            }\n            var btnClass = eventArgs.countOnly ? 'e-aggregate-list e-flat e-aggregate-list-countonly e-caret-hide'\n                : 'e-aggregate-list e-flat';\n            delete eventArgs.countOnly;\n            var key = this.aggregateContent;\n            var content = key + \": \" + eventArgs[key];\n            if (!this.aggregateDropDown) {\n                var aggregateEle = this.parent.createElement('button');\n                document.getElementById(this.parent.element.id + \"_sheet_tab_panel\").appendChild(aggregateEle);\n                this.aggregateDropDown = new DropDownButton({\n                    content: content,\n                    items: this.getAggregateItems(eventArgs),\n                    select: function (args) { return _this.updateAggregateContent(args.item.text, eventArgs, true); },\n                    beforeOpen: function (args) {\n                        return _this.beforeOpenHandler(_this.aggregateDropDown, args.element);\n                    },\n                    open: function (args) { return _this.openHandler(_this.aggregateDropDown, args.element, 'right'); },\n                    close: function () { return _this.parent.element.focus(); },\n                    cssClass: btnClass\n                });\n                this.aggregateDropDown.createElement = this.parent.createElement;\n                this.aggregateDropDown.appendTo(aggregateEle);\n            }\n            else {\n                this.updateAggregateContent(content, eventArgs);\n            }\n        }\n        else {\n            this.removeAggregate();\n        }\n    };\n    SheetTabs.prototype.getAggregateItems = function (args) {\n        var _this = this;\n        var items = [];\n        var text;\n        var iconCss;\n        Object.keys(args).forEach(function (key) {\n            if (args[key] !== aggregateComputation) {\n                text = key + \": \" + args[key];\n                iconCss = key === _this.aggregateContent ? 'e-selected-icon e-icons' : '';\n                items.push({ text: text, iconCss: iconCss });\n            }\n        });\n        return items;\n    };\n    SheetTabs.prototype.updateAggregateContent = function (text, eventArgs, isSelect) {\n        this.aggregateContent = text.split(': ')[0];\n        if (isSelect) {\n            this.selaggregateCnt = text.split(': ')[0];\n        }\n        this.aggregateDropDown.content = text;\n        this.aggregateDropDown.dataBind();\n        this.aggregateDropDown.setProperties({ 'items': this.getAggregateItems(eventArgs) }, true);\n    };\n    SheetTabs.prototype.removeAggregate = function () {\n        if (!isNullOrUndefined(this.aggregateDropDown)) {\n            this.aggregateDropDown.destroy();\n            remove(this.aggregateDropDown.element);\n            this.aggregateDropDown = null;\n        }\n    };\n    SheetTabs.prototype.addEventListener = function () {\n        this.parent.on(sheetTabs, this.createSheetTabs, this);\n        this.parent.on(refreshSheetTabs, this.refreshSheetTab, this);\n        this.parent.on(insertSheetTab, this.insertSheetTab, this);\n        this.parent.on(removeSheetTab, this.removeSheetTab, this);\n        this.parent.on(renameSheetTab, this.renameSheetTab, this);\n        this.parent.on(cMenuBeforeOpen, this.switchSheetTab, this);\n        this.parent.on(activeSheetChanged, this.updateSheetTab, this);\n        this.parent.on(renameSheet, this.renameInputFocusOut, this);\n        this.parent.on(activeCellChanged, this.removeAggregate, this);\n        this.parent.on(onVerticalScroll, this.focusRenameInput, this);\n        this.parent.on(onHorizontalScroll, this.focusRenameInput, this);\n        this.parent.on(sheetNameUpdate, this.updateSheetName, this);\n        this.parent.on(hideSheet, this.hideSheet, this);\n        this.parent.on(showAggregate, this.showAggregate, this);\n    };\n    SheetTabs.prototype.destroy = function () {\n        this.removeEventListener();\n        this.dropDownInstance.destroy();\n        this.dropDownInstance = null;\n        this.tabInstance.destroy();\n        this.tabInstance = null;\n        this.aggregateDropDown = null;\n        this.aggregateContent = null;\n        this.addBtnRipple();\n        this.addBtnRipple = null;\n        EventHandler.remove(document, 'mousedown touchstart', this.renameInputFocusOut);\n        var ele = document.getElementById(this.parent.element.id + '_sheet_tab_panel');\n        if (ele) {\n            remove(ele);\n        }\n        this.parent = null;\n    };\n    SheetTabs.prototype.removeEventListener = function () {\n        if (!this.parent.isDestroyed) {\n            this.parent.off(sheetTabs, this.createSheetTabs);\n            this.parent.off(refreshSheetTabs, this.refreshSheetTab);\n            this.parent.off(insertSheetTab, this.insertSheetTab);\n            this.parent.off(removeSheetTab, this.removeSheetTab);\n            this.parent.off(renameSheetTab, this.renameSheetTab);\n            this.parent.off(cMenuBeforeOpen, this.switchSheetTab);\n            this.parent.off(activeSheetChanged, this.updateSheetTab);\n            this.parent.off(renameSheet, this.renameInputFocusOut);\n            this.parent.off(activeCellChanged, this.removeAggregate);\n            this.parent.off(onVerticalScroll, this.focusRenameInput);\n            this.parent.off(onHorizontalScroll, this.focusRenameInput);\n            this.parent.off(sheetNameUpdate, this.updateSheetName);\n            this.parent.off(hideSheet, this.hideSheet);\n            this.parent.off(showAggregate, this.showAggregate);\n        }\n    };\n    return SheetTabs;\n}());\nexport { SheetTabs };\n","import { refreshSheetTabs, completeAction } from '../common/event';\nimport { dialog } from '../common/index';\nimport { openSuccess, openFailure } from '../../workbook/index';\nvar Open = /** @class */ (function () {\n    function Open(parent) {\n        this.parent = parent;\n        this.addEventListener();\n        this.renderFileUpload();\n        //Spreadsheet.Inject(WorkbookOpen);\n    }\n    /**\n     * Adding event listener for success and failure\n     */\n    Open.prototype.addEventListener = function () {\n        this.parent.on(openSuccess, this.openSuccess, this);\n        this.parent.on(openFailure, this.openFailed, this);\n    };\n    /**\n     * Removing event listener for success and failure\n     */\n    Open.prototype.removeEventListener = function () {\n        if (!this.parent.isDestroyed) {\n            this.parent.off(openSuccess, this.openSuccess);\n            this.parent.off(openFailure, this.openFailed);\n        }\n    };\n    /**\n     * Rendering upload component for importing files.\n     */\n    Open.prototype.renderFileUpload = function () {\n        var uploadID = this.parent.element.id + '_fileUpload';\n        this.parent.element.appendChild(this.parent.createElement('input', {\n            id: uploadID,\n            attrs: { type: 'file', accept: '.xls, .xlsx, .csv, .xlsm', name: 'fileUpload' }\n        }));\n        var uploadBox = document.getElementById(uploadID);\n        uploadBox.onchange = this.fileSelect.bind(this);\n        uploadBox.onerror = this.openFailed.bind(this);\n        uploadBox.style.display = 'none';\n    };\n    /**\n     * Process after select the excel and image file.\n     * @param {Event} args - File select native event.\n     */\n    Open.prototype.fileSelect = function (args) {\n        /* tslint:disable-next-line:no-any */\n        var filesData = args.target.files[0];\n        if (filesData && filesData.length < 1) {\n            return;\n        }\n        var impArgs = {\n            file: filesData\n        };\n        this.parent.open(impArgs);\n        document.getElementById(this.parent.element.id + '_fileUpload').value = '';\n    };\n    /**\n     * File open success event declaration.\n     * @param {string} response - File open success response text.\n     */\n    Open.prototype.openSuccess = function (response) {\n        var _this = this;\n        var openError = ['UnsupportedFile', 'InvalidUrl'];\n        if (openError.indexOf(response.data) > -1) {\n            this.parent.serviceLocator.getService(dialog).show({\n                content: this.parent.serviceLocator.getService('spreadsheetLocale')\n                    .getConstant(response.data),\n                width: '300',\n                beforeOpen: function (args) {\n                    var dlgArgs = {\n                        dialogName: 'OpenDialog',\n                        element: args.element, target: args.target, cancel: args.cancel\n                    };\n                    _this.parent.trigger('dialogBeforeOpen', dlgArgs);\n                    if (dlgArgs.cancel) {\n                        args.cancel = true;\n                    }\n                },\n            });\n            this.parent.hideSpinner();\n            return;\n        }\n        if (!this.parent.element) {\n            return;\n        }\n        this.parent.trigger('openComplete', { response: response });\n        this.parent.notify(completeAction, { response: response, action: 'import' });\n        this.parent.renderModule.refreshSheet();\n        this.parent.notify(refreshSheetTabs, this);\n        this.parent.hideSpinner();\n    };\n    /**\n     * File open failure event declaration.\n     * @param {object} args - Open failure arguments.\n     */\n    Open.prototype.openFailed = function (args) {\n        this.parent.trigger('openFailure', args);\n        this.parent.hideSpinner();\n        /* Need to Implement */\n    };\n    /**\n     * To Remove the event listeners.\n     */\n    Open.prototype.destroy = function () {\n        this.removeEventListener();\n        this.parent = null;\n    };\n    /**\n     * Get the sheet open module name.\n     */\n    Open.prototype.getModuleName = function () {\n        return 'open';\n    };\n    return Open;\n}());\nexport { Open };\n","import { dialog } from '../index';\nimport { beginSave, saveCompleted, saveError } from '../../workbook/common/event';\n/**\n * `Save` module is used to handle the save action in Spreadsheet.\n */\nvar Save = /** @class */ (function () {\n    /**\n     * Constructor for Save module in Spreadsheet.\n     * @private\n     */\n    function Save(parent) {\n        this.parent = parent;\n        this.addEventListener();\n        //Spreadsheet.Inject(WorkbookSave);\n    }\n    /**\n     * To destroy the Save module.\n     * @return {void}\n     * @hidden\n     */\n    Save.prototype.destroy = function () {\n        this.removeEventListener();\n        this.parent = null;\n    };\n    Save.prototype.addEventListener = function () {\n        this.parent.on(beginSave, this.initiateSave, this);\n        this.parent.on(saveCompleted, this.saveCompleted, this);\n        this.parent.on(saveError, this.showErrorDialog, this);\n    };\n    Save.prototype.removeEventListener = function () {\n        if (!this.parent.isDestroyed) {\n            this.parent.off(beginSave, this.initiateSave);\n            this.parent.off(saveCompleted, this.saveCompleted);\n            this.parent.off(saveError, this.showErrorDialog);\n        }\n    };\n    /**\n     * Get the module name.\n     * @returns string\n     * @private\n     */\n    Save.prototype.getModuleName = function () {\n        return 'save';\n    };\n    /**\n     * Initiate save process.\n     * @hidden\n     */\n    Save.prototype.initiateSave = function (args) {\n        this.parent.showSpinner();\n    };\n    /**\n     * Save action completed.\n     * @hidden\n     */\n    Save.prototype.saveCompleted = function (args) {\n        this.parent.hideSpinner();\n    };\n    Save.prototype.showErrorDialog = function (args) {\n        var _this = this;\n        var dialogInst = this.parent.serviceLocator.getService(dialog);\n        dialogInst.show({\n            target: this.parent.element, isModal: true, showCloseIcon: true, height: 180, width: 400, content: args.content,\n            beforeOpen: function () { return _this.parent.element.focus(); }\n        });\n    };\n    return Save;\n}());\nexport { Save };\n","import { ContextMenu as ContextMenuComponent } from '@syncfusion/ej2-navigations';\nimport { closest, extend, detach } from '@syncfusion/ej2-base';\nimport { removeSheetTab, cMenuBeforeOpen, renameSheetTab, cut, copy, paste } from '../common/index';\nimport { addContextMenuItems, removeContextMenuItems, enableContextMenuItems, initiateCustomSort, hideSheet } from '../common/index';\nimport { openHyperlink, initiateHyperlink, editHyperlink, hideShow, applyProtect } from '../common/index';\nimport { filterByCellValue, reapplyFilter, clearFilter, getFilteredColumn, applySort, locale } from '../common/index';\nimport { getRangeIndexes, getColumnHeaderText, getCellIndexes, insertModel } from '../../workbook/common/index';\nimport { getSwapRange } from '../../workbook/index';\n/**\n * Represents context menu for Spreadsheet.\n */\nvar ContextMenu = /** @class */ (function () {\n    /**\n     * Constructor for ContextMenu module.\n     */\n    function ContextMenu(parent) {\n        this.parent = parent;\n        this.init();\n    }\n    ContextMenu.prototype.init = function () {\n        this.initContextMenu();\n        this.addEventListener();\n    };\n    ContextMenu.prototype.initContextMenu = function () {\n        var ul = document.createElement('ul');\n        ul.id = this.parent.element.id + '_contextmenu';\n        this.parent.element.appendChild(ul);\n        this.contextMenuInstance = new ContextMenuComponent({\n            cssClass: 'e-spreadsheet-contextmenu',\n            target: '#' + this.parent.element.id,\n            filter: 'e-numericcontainer e-active-cell e-selection e-row e-header-row e-select-all-cell e-sheet-tabs-items',\n            select: this.selectHandler.bind(this),\n            beforeOpen: this.beforeOpenHandler.bind(this),\n            beforeClose: this.beforeCloseHandler.bind(this)\n        }, ul);\n    };\n    /**\n     * Before close event handler.\n     */\n    ContextMenu.prototype.beforeCloseHandler = function (args) {\n        this.parent.trigger('contextMenuBeforeClose', args);\n    };\n    /**\n     * Select event handler.\n     */\n    // tslint:disable-next-line\n    ContextMenu.prototype.selectHandler = function (args) {\n        var selectArgs = extend({ cancel: false }, args);\n        this.parent.trigger('contextMenuItemSelect', selectArgs);\n        var id = this.parent.element.id + '_cmenu';\n        if (!selectArgs.cancel) {\n            var l10n = this.parent.serviceLocator.getService(locale);\n            var indexes = void 0;\n            switch (args.item.id) {\n                case id + '_cut':\n                    this.parent.notify(cut, { isAction: true, promise: Promise });\n                    break;\n                case id + '_copy':\n                    this.parent.notify(copy, { isAction: true, promise: Promise });\n                    break;\n                case id + '_paste':\n                    this.parent.notify(paste, { isAction: true, isInternal: true });\n                    break;\n                case id + '_pastevalues':\n                    this.parent.notify(paste, { type: 'Values', isAction: true, isInternal: true });\n                    break;\n                case id + '_pasteformats':\n                    this.parent.notify(paste, { type: 'Formats', isAction: true, isInternal: true });\n                    break;\n                case id + '_rename':\n                    this.parent.notify(renameSheetTab, {});\n                    break;\n                case id + '_delete_sheet':\n                    this.parent.notify(removeSheetTab, {});\n                    break;\n                case id + '_insert_sheet':\n                    this.parent.notify(insertModel, { model: this.parent, start: this.parent.activeSheetIndex,\n                        end: this.parent.activeSheetIndex, modelType: 'Sheet', isAction: true });\n                    break;\n                case id + '_hide_sheet':\n                    this.parent.notify(hideSheet, null);\n                    break;\n                case id + '_ascending':\n                    this.parent.notify(applySort, null);\n                    break;\n                case id + '_descending':\n                    this.parent.notify(applySort, { sortOptions: { sortDescriptors: { order: 'Descending' } } });\n                    break;\n                case id + '_customsort':\n                    this.parent.notify(initiateCustomSort, null);\n                    break;\n                case id + '_filtercellvalue':\n                    this.parent.notify(filterByCellValue, null);\n                    break;\n                case id + '_clearfilter':\n                    var field = getColumnHeaderText(getCellIndexes(this.parent.getActiveSheet().activeCell)[1] + 1);\n                    this.parent.notify(clearFilter, { field: field });\n                    break;\n                case id + '_reapplyfilter':\n                    this.parent.notify(reapplyFilter, null);\n                    break;\n                case id + '_hide_row':\n                    indexes = getRangeIndexes(this.parent.getActiveSheet().selectedRange);\n                    this.parent.notify(hideShow, {\n                        startIndex: indexes[0], endIndex: indexes[2], hide: true, isCol: false, actionUpdate: true\n                    });\n                    this.parent.element.focus();\n                    break;\n                case id + '_unhide_row':\n                    indexes = getRangeIndexes(this.parent.getActiveSheet().selectedRange);\n                    this.parent.notify(hideShow, {\n                        startIndex: indexes[0], endIndex: indexes[2], hide: false, isCol: false, actionUpdate: true\n                    });\n                    this.parent.element.focus();\n                    break;\n                case id + '_hide_column':\n                    indexes = getRangeIndexes(this.parent.getActiveSheet().selectedRange);\n                    this.parent.notify(hideShow, {\n                        startIndex: indexes[1], endIndex: indexes[3], hide: true, isCol: true, actionUpdate: true\n                    });\n                    this.parent.element.focus();\n                    break;\n                case id + '_unhide_column':\n                    indexes = getRangeIndexes(this.parent.getActiveSheet().selectedRange);\n                    this.parent.notify(hideShow, {\n                        startIndex: indexes[1], endIndex: indexes[3], hide: false, isCol: true, actionUpdate: true\n                    });\n                    this.parent.element.focus();\n                    break;\n                case id + '_insert_row_above':\n                case id + '_delete_row':\n                    indexes = getRangeIndexes(this.parent.getActiveSheet().selectedRange);\n                    this.parent.notify(args.item.id.substr(id.length + 1, 6) + \"Model\", { model: this.parent.getActiveSheet(), start: indexes[0], end: indexes[2], modelType: 'Row', isAction: true,\n                        insertType: 'above' });\n                    this.parent.element.focus();\n                    break;\n                case id + '_insert_row_below':\n                    indexes = getSwapRange(getRangeIndexes(this.parent.getActiveSheet().selectedRange));\n                    this.parent.notify(insertModel, { model: this.parent.getActiveSheet(), start: indexes[2] + 1, end: indexes[2] + 1 + (indexes[2] - indexes[0]), modelType: 'Row', isAction: true,\n                        insertType: 'below' });\n                    this.parent.element.focus();\n                    break;\n                case id + '_insert_column_before':\n                case id + '_delete_column':\n                    indexes = getRangeIndexes(this.parent.getActiveSheet().selectedRange);\n                    this.parent.notify(args.item.id.substr(id.length + 1, 6) + \"Model\", { model: this.parent.getActiveSheet(), start: indexes[1], end: indexes[3], modelType: 'Column', isAction: true });\n                    this.parent.element.focus();\n                    break;\n                case id + '_insert_column_after':\n                    indexes = getSwapRange(getRangeIndexes(this.parent.getActiveSheet().selectedRange));\n                    this.parent.notify(insertModel, { model: this.parent.getActiveSheet(), start: indexes[3] + 1, end: indexes[3] + 1 + (indexes[3] - indexes[1]), modelType: 'Column', isAction: true });\n                    this.parent.element.focus();\n                    break;\n                case id + '_hyperlink':\n                    this.parent.notify(initiateHyperlink, null);\n                    break;\n                case id + '_editHyperlink':\n                    this.parent.notify(editHyperlink, null);\n                    break;\n                case id + '_openHyperlink':\n                    this.parent.notify(openHyperlink, null);\n                    break;\n                case id + '_removeHyperlink':\n                    this.parent.removeHyperlink(this.parent.getActiveSheet().selectedRange);\n                    break;\n                case id + '_protect':\n                    var sheet = this.parent.getActiveSheet();\n                    this.parent.setSheetPropertyOnMute(sheet, 'isProtected', !sheet.isProtected);\n                    var isActive = void 0;\n                    sheet.isProtected ? isActive = false : isActive = true;\n                    this.parent.notify(applyProtect, { isActive: isActive });\n                    break;\n            }\n        }\n    };\n    ContextMenu.prototype.getInsertModel = function (startIndex, endIndex) {\n        var model = [];\n        for (var i = startIndex; i <= endIndex; i++) {\n            if (i === startIndex) {\n                model.push({ index: i });\n            }\n            else {\n                model.push({});\n            }\n        }\n        return model;\n    };\n    /**\n     * Before open event handler.\n     */\n    ContextMenu.prototype.beforeOpenHandler = function (args) {\n        var target = this.getTarget(args.event.target);\n        var items;\n        if (args.element.classList.contains('e-contextmenu')) {\n            items = this.getDataSource(target);\n            this.contextMenuInstance.items = items;\n            this.contextMenuInstance.dataBind();\n        }\n        else {\n            items = args.items;\n        }\n        if (target === 'ColumnHeader' || target === 'RowHeader') {\n            if (args.element && args.element.childElementCount > 0) {\n                var insertEle = target === 'ColumnHeader' ? args.element.querySelector('#' + this.parent.element.id + '_cmenu_insert_column') :\n                    args.element.querySelector('#' + this.parent.element.id + '_cmenu_insert_row');\n                var deleteEle = target ===\n                    'ColumnHeader' ? args.element.querySelector('#' + this.parent.element.id + '_cmenu_delete_column') :\n                    args.element.querySelector('#' + this.parent.element.id + '_cmenu_delete_row');\n                if (this.parent.allowInsert && insertEle.classList.contains('e-disabled')) {\n                    insertEle.classList.remove('e-disabled');\n                }\n                else if (!this.parent.allowInsert && !insertEle.classList.contains('e-disabled')) {\n                    insertEle.classList.add('e-disabled');\n                }\n                if (this.parent.allowDelete && deleteEle.classList.contains('e-disabled')) {\n                    deleteEle.classList.remove('e-disabled');\n                }\n                else if (!this.parent.allowDelete && !deleteEle.classList.contains('e-disabled')) {\n                    deleteEle.classList.add('e-disabled');\n                }\n            }\n        }\n        this.parent.trigger('contextMenuBeforeOpen', args);\n        this.parent.notify(cMenuBeforeOpen, extend(args, { target: target, items: items }));\n    };\n    /**\n     * To get target area based on right click.\n     */\n    ContextMenu.prototype.getTarget = function (target) {\n        if (closest(target, '.e-sheet-content')) {\n            return 'Content';\n        }\n        else if (closest(target, '.e-column-header')) {\n            return 'ColumnHeader';\n        }\n        else if (closest(target, '.e-row-header')) {\n            return 'RowHeader';\n        }\n        else if (closest(target, '.e-sheet-tabs-items')) {\n            return 'Footer';\n        }\n        else if (closest(target, '.e-selectall-container')) {\n            return 'SelectAll';\n        }\n        else {\n            return '';\n        }\n    };\n    /**\n     * To populate context menu items based on target area.\n     */\n    ContextMenu.prototype.getDataSource = function (target) {\n        var l10n = this.parent.serviceLocator.getService(locale);\n        var items = [];\n        var id = this.parent.element.id + '_cmenu';\n        if (target === 'Content') {\n            this.setClipboardData(items, l10n, id);\n            items.push({ separator: true });\n            //push filter and sort items here\n            this.setFilterItems(items, id);\n            this.setSortItems(items, id);\n            items.push({ separator: true });\n            this.setHyperLink(items, id);\n        }\n        else if (target === 'RowHeader') {\n            this.setClipboardData(items, l10n, id);\n            var indexes = getRangeIndexes(this.parent.getActiveSheet().selectedRange);\n            this.setInsertDeleteItems(items, l10n, 'Row', id, [indexes[0], indexes[2]], ['Above', 'Below']);\n            this.setHideShowItems(items, l10n, 'Row', id, [indexes[0], indexes[2]]);\n        }\n        else if (target === 'ColumnHeader') {\n            this.setClipboardData(items, l10n, id);\n            var indexes = getRangeIndexes(this.parent.getActiveSheet().selectedRange);\n            this.setInsertDeleteItems(items, l10n, 'Column', id, [indexes[1], indexes[3]], ['Before', 'After']);\n            this.setHideShowItems(items, l10n, 'Column', id, [indexes[1], indexes[3]]);\n        }\n        else if (target === 'SelectAll') {\n            this.setClipboardData(items, l10n, id);\n            this.setFilterItems(items, id);\n            this.setSortItems(items, id);\n        }\n        else if (target === 'Footer') {\n            items.push({\n                text: l10n.getConstant('Insert'), id: id + '_insert_sheet'\n            });\n            items.push({\n                text: l10n.getConstant('Delete'), iconCss: 'e-icons e-delete', id: id + '_delete_sheet'\n            });\n            items.push({\n                text: l10n.getConstant('Rename'), id: id + '_rename'\n            });\n            items.push({\n                text: l10n.getConstant('Hide'), id: id + '_hide_sheet'\n            });\n            this.setProtectSheetItems(items, id);\n        }\n        return items;\n    };\n    ContextMenu.prototype.setProtectSheetItems = function (items, id) {\n        var l10n = this.parent.serviceLocator.getService(locale);\n        if (this.parent.getActiveSheet().isProtected) {\n            items.push({\n                text: l10n.getConstant('UnprotectSheet'), id: id + '_protect', iconCss: 'e-icons e-protect-icon',\n            });\n        }\n        else {\n            items.push({\n                text: l10n.getConstant('ProtectSheet'), id: id + '_protect', iconCss: 'e-icons e-protect-icon',\n            });\n        }\n    };\n    /**\n     * Sets sorting related items to the context menu.\n     */\n    ContextMenu.prototype.setFilterItems = function (items, id) {\n        if (this.parent.allowFiltering) {\n            var l10n = this.parent.serviceLocator.getService(locale);\n            var args = { clearFilterText: null, isFiltered: false };\n            this.parent.notify(getFilteredColumn, args);\n            items.push({\n                text: l10n.getConstant('Filter'), id: id + '_filter',\n                iconCss: '',\n                items: [\n                    { text: args.clearFilterText, iconCss: 'e-icons e-filter-clear', id: id + '_clearfilter' },\n                    { text: l10n.getConstant('ReapplyFilter'), iconCss: 'e-icons e-filter-reapply', id: id + '_reapplyfilter' },\n                    { separator: true },\n                    { text: l10n.getConstant('FilterCellValue'), iconCss: '', id: id + '_filtercellvalue' }\n                ]\n            });\n        }\n    };\n    /**\n     * Sets sorting related items to the context menu.\n     */\n    ContextMenu.prototype.setSortItems = function (items, id) {\n        var l10n = this.parent.serviceLocator.getService(locale);\n        if (this.parent.allowSorting) {\n            items.push({\n                text: l10n.getConstant('Sort'), id: id + '_sort',\n                iconCss: 'e-icons e-sort-icon',\n                items: [\n                    { text: l10n.getConstant('SortAscending'), iconCss: 'e-icons e-sort-asc', id: id + '_ascending' },\n                    { text: l10n.getConstant('SortDescending'), iconCss: 'e-icons e-sort-desc', id: id + '_descending' },\n                    { text: l10n.getConstant('CustomSort') + '...', iconCss: 'e-icons e-sort-custom', id: id + '_customsort' }\n                ]\n            });\n        }\n    };\n    ContextMenu.prototype.setHyperLink = function (items, id) {\n        var sheet = this.parent.getActiveSheet();\n        if (this.parent.allowHyperlink) {\n            var l10n = this.parent.serviceLocator.getService(locale);\n            if ((!document.activeElement.getElementsByClassName('e-hyperlink')[0] &&\n                !document.activeElement.classList.contains('e-hyperlink')) || (sheet.isProtected && !sheet.protectSettings.insertLink)) {\n                items.push({\n                    text: l10n.getConstant('Hyperlink'), iconCss: 'e-icons e-hyperlink-icon', id: id + '_hyperlink'\n                });\n            }\n            else {\n                items.push({ text: l10n.getConstant('EditHyperlink'), iconCss: 'e-icons e-edithyperlink-icon', id: id + '_editHyperlink' }, { text: l10n.getConstant('OpenHyperlink'), iconCss: 'e-icons e-openhyperlink-icon', id: id + '_openHyperlink' }, { text: l10n.getConstant('RemoveHyperlink'), iconCss: 'e-icons e-removehyperlink-icon', id: id + '_removeHyperlink' });\n            }\n        }\n    };\n    ContextMenu.prototype.setClipboardData = function (items, l10n, id) {\n        if (this.parent.enableClipboard) {\n            items.push({\n                text: l10n.getConstant('Cut'),\n                iconCss: 'e-icons e-cut-icon', id: id + '_cut'\n            });\n            items.push({\n                text: l10n.getConstant('Copy'),\n                iconCss: 'e-icons e-copy-icon', id: id + '_copy'\n            });\n            items.push({\n                text: l10n.getConstant('Paste'),\n                iconCss: 'e-icons e-paste-icon', id: id + '_paste'\n            });\n            items.push({\n                text: l10n.getConstant('PasteSpecial'), id: id + '_pastespecial',\n                items: [\n                    { text: l10n.getConstant('Values'), id: id + '_pastevalues' },\n                    { text: l10n.getConstant('Formats'), id: id + '_pasteformats' }\n                ]\n            });\n        }\n    };\n    ContextMenu.prototype.setInsertDeleteItems = function (items, l10n, layout, id, indexes, subItems) {\n        items.push({ separator: true });\n        ['Insert', 'Delete'].forEach(function (action) {\n            if (indexes[0] === indexes[1]) {\n                items.push({ text: l10n.getConstant(\"\" + action + layout), id: id + (\"_\" + action.toLowerCase() + \"_\" + layout.toLowerCase()) });\n            }\n            else {\n                items.push({ text: l10n.getConstant(\"\" + action + layout + \"s\"), id: id + (\"_\" + action.toLowerCase() + \"_\" + layout.toLowerCase()) });\n            }\n            if (action === 'Insert') {\n                items[items.length - 1].items = [];\n                subItems.forEach(function (item) {\n                    items[items.length - 1].items.push({\n                        text: l10n.getConstant(item), id: items[items.length - 1].id + \"_\" + item.toLowerCase()\n                    });\n                });\n            }\n        });\n    };\n    ContextMenu.prototype.setHideShowItems = function (items, l10n, layout, id, indexes) {\n        if (indexes[0] === indexes[1]) {\n            items.push({ text: l10n.getConstant(\"Hide\" + layout), id: id + (\"_hide_\" + layout.toLowerCase()) });\n        }\n        else {\n            items.push({ text: l10n.getConstant(\"Hide\" + layout + \"s\"), id: id + (\"_hide_\" + layout.toLowerCase()) });\n        }\n        if (this.parent.hiddenCount(indexes[0], indexes[1], layout.toLowerCase() + \"s\")) {\n            items.push({ text: l10n.getConstant(\"UnHide\" + layout + \"s\"), id: id + (\"_unhide_\" + layout.toLowerCase()) });\n        }\n    };\n    /**\n     * To add event listener.\n     */\n    ContextMenu.prototype.addEventListener = function () {\n        this.parent.on(addContextMenuItems, this.addItemsHandler, this);\n        this.parent.on(removeContextMenuItems, this.removeItemsHandler, this);\n        this.parent.on(enableContextMenuItems, this.enableItemsHandler, this);\n    };\n    /**\n     * To add context menu items before / after particular item.\n     */\n    ContextMenu.prototype.addItemsHandler = function (args) {\n        if (args.insertAfter) {\n            this.contextMenuInstance.insertAfter(args.items, args.text, args.isUniqueId);\n        }\n        else {\n            this.contextMenuInstance.insertBefore(args.items, args.text, args.isUniqueId);\n        }\n    };\n    /**\n     * To remove context menu items.\n     */\n    ContextMenu.prototype.removeItemsHandler = function (args) {\n        this.contextMenuInstance.removeItems(args.items, args.isUniqueId);\n    };\n    /**\n     * To enable / disable context menu items.\n     */\n    ContextMenu.prototype.enableItemsHandler = function (args) {\n        this.contextMenuInstance.enableItems(args.items, args.enable, args.isUniqueId);\n    };\n    /**\n     * To remove event listener.\n     */\n    ContextMenu.prototype.removeEventListener = function () {\n        if (!this.parent.isDestroyed) {\n            this.parent.off(addContextMenuItems, this.addItemsHandler);\n            this.parent.off(removeContextMenuItems, this.removeItemsHandler);\n            this.parent.off(enableContextMenuItems, this.enableItemsHandler);\n        }\n    };\n    /**\n     * To get module name.\n     */\n    ContextMenu.prototype.getModuleName = function () {\n        return 'contextMenu';\n    };\n    /**\n     * Destroy method.\n     */\n    ContextMenu.prototype.destroy = function () {\n        this.removeEventListener();\n        this.contextMenuInstance.destroy();\n        var ele = document.getElementById(this.parent.element.id + '_contextmenu');\n        if (ele) {\n            detach(ele);\n        }\n        this.parent = null;\n    };\n    return ContextMenu;\n}());\nexport { ContextMenu };\n","import { refreshCellElement } from '../../workbook/common/event';\nimport { isNullOrUndefined } from '@syncfusion/ej2-base';\n/**\n * Specifies number format.\n */\nvar NumberFormat = /** @class */ (function () {\n    function NumberFormat(parent) {\n        this.parent = parent;\n        this.addEventListener();\n        //Spreadsheet.Inject(WorkbookNumberFormat);\n    }\n    NumberFormat.prototype.refreshCellElement = function (args) {\n        var cell = this.parent.getCell(args.rowIndex, args.colIndex);\n        if (!isNullOrUndefined(cell)) {\n            this.parent.refreshNode(cell, args);\n        }\n    };\n    /**\n     * Adding event listener for number format.\n     * @hidden\n     */\n    NumberFormat.prototype.addEventListener = function () {\n        this.parent.on(refreshCellElement, this.refreshCellElement, this);\n    };\n    /**\n     * Removing event listener for number format.\n     * @hidden\n     */\n    NumberFormat.prototype.removeEventListener = function () {\n        if (!this.parent.isDestroyed) {\n            this.parent.off(refreshCellElement, this.refreshCellElement);\n        }\n    };\n    /**\n     * To Remove the event listeners.\n     */\n    NumberFormat.prototype.destroy = function () {\n        this.removeEventListener();\n        this.parent = null;\n    };\n    /**\n     * Get the workbook import module name.\n     */\n    NumberFormat.prototype.getModuleName = function () {\n        return 'numberFormat';\n    };\n    return NumberFormat;\n}());\nexport { NumberFormat };\n","import { initiateCustomSort, locale, dialog, getFilterRange } from '../index';\nimport { applySort, completeAction, beginAction } from '../index';\nimport { sortComplete, beforeSort, getFormattedCellObject } from '../../workbook/common/event';\nimport { getIndexesFromAddress, getSwapRange, getCell, inRange } from '../../workbook/index';\nimport { getColumnHeaderText, getRangeAddress } from '../../workbook/index';\nimport { getUniqueID, getComponent, enableRipple } from '@syncfusion/ej2-base';\nimport { DropDownList } from '@syncfusion/ej2-dropdowns';\nimport { RadioButton, CheckBox } from '@syncfusion/ej2-buttons';\nimport { ListView } from '@syncfusion/ej2-lists';\n/**\n * `Sort` module is used to handle the sort action in Spreadsheet.\n */\nvar Sort = /** @class */ (function () {\n    /**\n     * Constructor for sort module.\n     */\n    function Sort(parent) {\n        this.parent = parent;\n        this.addEventListener();\n    }\n    /**\n     * To destroy the sort module.\n     * @return {void}\n     */\n    Sort.prototype.destroy = function () {\n        this.removeEventListener();\n        this.parent = null;\n    };\n    Sort.prototype.addEventListener = function () {\n        this.parent.on(applySort, this.applySortHandler, this);\n        this.parent.on(sortComplete, this.sortCompleteHandler, this);\n        this.parent.on(initiateCustomSort, this.initiateCustomSortHandler, this);\n    };\n    Sort.prototype.removeEventListener = function () {\n        if (!this.parent.isDestroyed) {\n            this.parent.off(applySort, this.applySortHandler);\n            this.parent.off(sortComplete, this.sortCompleteHandler);\n            this.parent.off(initiateCustomSort, this.initiateCustomSortHandler);\n        }\n    };\n    /**\n     * Gets the module name.\n     * @returns string\n     */\n    Sort.prototype.getModuleName = function () {\n        return 'sort';\n    };\n    /**\n     * Validates the range and returns false when invalid.\n     */\n    Sort.prototype.isValidSortRange = function () {\n        var sheet = this.parent.getActiveSheet();\n        var range = getSwapRange(getIndexesFromAddress(sheet.selectedRange));\n        if (range[0] > sheet.usedRange.rowIndex || range[1] > sheet.usedRange.colIndex) {\n            return false;\n        }\n        return true;\n    };\n    /**\n     * Shows the range error alert dialog.\n     * @param error - range error string.\n     */\n    Sort.prototype.sortRangeAlertHandler = function (args) {\n        var _this = this;\n        var dialogInst = this.parent.serviceLocator.getService(dialog);\n        dialogInst.show({\n            height: 180, width: 400, isModal: true, showCloseIcon: true,\n            content: args.error,\n            beforeOpen: function (args) {\n                var dlgArgs = {\n                    dialogName: 'SortRangeDialog',\n                    element: args.element, target: args.target, cancel: args.cancel\n                };\n                _this.parent.trigger('dialogBeforeOpen', dlgArgs);\n                if (dlgArgs.cancel) {\n                    args.cancel = true;\n                }\n            },\n        });\n        this.parent.hideSpinner();\n    };\n    /**\n     * Initiates the custom sort dialog.\n     */\n    Sort.prototype.initiateCustomSortHandler = function () {\n        var _this = this;\n        var l10n = this.parent.serviceLocator.getService(locale);\n        if (!this.isValidSortRange()) {\n            this.sortRangeAlertHandler({ error: l10n.getConstant('SortOutOfRangeError') });\n            return;\n        }\n        var dialogInst = this.parent.serviceLocator.getService(dialog);\n        dialogInst.show({\n            height: 400, width: 560, isModal: true, showCloseIcon: true, cssClass: 'e-customsort-dlg',\n            header: l10n.getConstant('CustomSort'),\n            beforeOpen: function (args) {\n                var dlgArgs = {\n                    dialogName: 'CustomSortDialog',\n                    element: args.element, target: args.target, cancel: args.cancel\n                };\n                _this.parent.trigger('dialogBeforeOpen', dlgArgs);\n                if (dlgArgs.cancel) {\n                    args.cancel = true;\n                }\n                dialogInst.dialogInstance.content = _this.customSortContent();\n                dialogInst.dialogInstance.dataBind();\n                _this.parent.element.focus();\n            },\n            buttons: [{\n                    buttonModel: {\n                        content: l10n.getConstant('Ok'), isPrimary: true\n                    },\n                    click: function () {\n                        var element = dialogInst.dialogInstance.content;\n                        var list = element.getElementsByClassName('e-list-sort e-listview e-lib')[0];\n                        var listview = getComponent(list, 'listview');\n                        var data = listview.dataSource;\n                        _this.clearError();\n                        var errorElem = element.getElementsByClassName('e-sort-error')[0];\n                        errorElem.style.display = 'block';\n                        if (!_this.validateError(data, element, errorElem)) {\n                            dialogInst.hide();\n                            var headercheck = element.getElementsByClassName('e-sort-checkheader')[0];\n                            var headerCheckbox = getComponent(headercheck, 'checkbox');\n                            var caseCheckbox = getComponent(element.getElementsByClassName('e-sort-checkcase')[0], 'checkbox');\n                            var hasHeader = headerCheckbox.checked;\n                            _this.applySortHandler({ sortOptions: { sortDescriptors: data, containsHeader: hasHeader, caseSensitive: caseCheckbox.checked } });\n                        }\n                    }\n                }]\n        });\n    };\n    /**\n     * Validates the errors of the sort criteria and displays the error.\n     * @param json - listview datasource.\n     * @param dialogElem - dialog content element.\n     * @param errorElem - element to display error.\n     */\n    Sort.prototype.validateError = function (json, dialogElem, errorElem) {\n        var l10n = this.parent.serviceLocator.getService(locale);\n        var hasEmpty = json.some(function (element) { return element.field.toString() === ''; });\n        if (hasEmpty) {\n            Array.prototype.some.call(dialogElem.getElementsByClassName('e-sort-field'), function (dropDown) {\n                var hasError = !getComponent(dropDown, 'dropdownlist').value;\n                if (hasError) {\n                    dropDown.parentElement.classList.add('e-error');\n                }\n                return hasError; //breaks the loop if only one error added.\n            });\n            errorElem.innerText = l10n.getConstant('SortEmptyFieldError');\n            return true;\n        }\n        var temp = new Set();\n        var duplicateField = '';\n        var hasDuplicate = json.some(function (element) {\n            duplicateField = element.field.toString();\n            return temp.size === temp.add(element.field).size;\n        });\n        var errorField = '';\n        if (hasDuplicate) {\n            var count_1 = 0;\n            Array.prototype.some.call(dialogElem.getElementsByClassName('e-sort-field'), function (dropDown) {\n                var dropDownList = getComponent(dropDown, 'dropdownlist');\n                if (dropDownList.value === duplicateField) {\n                    dropDown.parentElement.classList.add('e-error');\n                    errorField = dropDownList.text;\n                    count_1++;\n                }\n                return count_1 === 2; //breaks the loop when 2 errors added.\n            });\n            errorElem.innerHTML = '<strong>' + errorField + '</strong>' + l10n.getConstant('SortDuplicateFieldError');\n            return true;\n        }\n        return false;\n    };\n    /**\n     * Creates all the elements and generates the dialog content element.\n     */\n    Sort.prototype.customSortContent = function () {\n        var dialogElem = this.parent.createElement('div', { className: 'e-sort-dialog' });\n        var fields = this.getFields();\n        var listId = getUniqueID('customSort');\n        var listviewObj = this.getCustomListview(listId);\n        this.setHeaderTab(dialogElem, listviewObj, fields);\n        var contentElem = this.parent.createElement('div', {\n            className: 'e-sort-listsection',\n            styles: ''\n        });\n        dialogElem.appendChild(contentElem);\n        var listview = this.parent.createElement('div', { className: 'e-list-sort', styles: '' });\n        contentElem.appendChild(listview);\n        listviewObj.createElement = this.parent.createElement;\n        listviewObj.appendTo(listview);\n        this.renderListItem(listId, listviewObj, true, fields);\n        var errorElem = this.parent.createElement('div', { className: 'e-sort-error' });\n        dialogElem.appendChild(errorElem);\n        return dialogElem;\n    };\n    /**\n     * Gets the fields data from the selected range.\n     */\n    Sort.prototype.getFields = function () {\n        var sheet = this.parent.getActiveSheet();\n        var range = getSwapRange(getIndexesFromAddress(sheet.selectedRange));\n        if (range[0] === range[2] && (range[2] - range[0]) === 0) { //for entire range\n            range[0] = 0;\n            range[1] = 0;\n            range[3] = sheet.usedRange.colIndex;\n            var args = { filterRange: [], hasFilter: false };\n            this.parent.notify(getFilterRange, args);\n            if (args.hasFilter && args.filterRange) {\n                range[0] = args.filterRange[0];\n            }\n        }\n        var fields = [];\n        var fieldName;\n        for (range[1]; range[1] <= range[3]; range[1]++) {\n            var cell = getCell(range[0], range[1], sheet);\n            if (cell && cell.value) {\n                var eventArgs = {\n                    formattedText: cell.value,\n                    value: cell.value,\n                    format: cell.format,\n                    onLoad: true\n                };\n                if (cell.format) {\n                    this.parent.notify(getFormattedCellObject, eventArgs);\n                }\n                fieldName = eventArgs.formattedText;\n            }\n            else {\n                fieldName = 'Column ' + getColumnHeaderText(range[1] + 1);\n            }\n            fields.push({ text: fieldName, value: 'Column ' + getColumnHeaderText(range[1] + 1) });\n        }\n        return fields;\n    };\n    /**\n     * Creates the header tab for the custom sort dialog.\n     * @param dialogElem - dialog content element.\n     * @param listviewObj - listview instance.\n     * @param fields - fields data.\n     */\n    Sort.prototype.setHeaderTab = function (dialogElem, listviewObj, fields) {\n        var _this = this;\n        var l10n = this.parent.serviceLocator.getService(locale);\n        var headerTabElement = this.parent.createElement('div', {\n            className: 'e-sort-header',\n            styles: '',\n            innerHTML: ''\n        });\n        dialogElem.appendChild(headerTabElement);\n        var addButton = this.parent.createElement('button', {\n            className: 'e-btn e-sort-addbtn e-flat',\n            innerHTML: l10n.getConstant('AddColumn')\n        });\n        var footer = this.parent.element.querySelector('.e-customsort-dlg .e-footer-content');\n        footer.insertBefore(addButton, footer.firstElementChild);\n        addButton.addEventListener('click', function () {\n            if (listviewObj) {\n                var listId = getUniqueID('customSort');\n                listviewObj.addItem([{ id: listId, text: l10n.getConstant('ThenBy'), field: '', order: 'ascending' }]);\n                _this.renderListItem(listId, listviewObj, checkHeaderObj.checked, fields, true);\n            }\n        });\n        var checkHeaderObj = new CheckBox({\n            label: l10n.getConstant('ContainsHeader'),\n            checked: true,\n            change: function (args) {\n                var fieldsMap = args.checked ? { text: 'text', value: 'value' } : { text: 'value' };\n                Array.prototype.forEach.call(dialogElem.getElementsByClassName('e-sort-field e-dropdownlist e-lib'), function (dropDown) {\n                    var dropDownListObj = getComponent(dropDown, 'dropdownlist');\n                    dropDownListObj.dataSource = null; //reset datasource.\n                    dropDownListObj.dataSource = fields;\n                    dropDownListObj.fields = fieldsMap;\n                    dropDownListObj.dataBind();\n                });\n            },\n            cssClass: 'e-sort-headercheckbox'\n        });\n        var headerCheckbox = this.parent.createElement('input', {\n            className: 'e-sort-checkheader', attrs: { type: 'checkbox' }\n        });\n        headerTabElement.appendChild(headerCheckbox);\n        checkHeaderObj.createElement = this.parent.createElement;\n        checkHeaderObj.appendTo(headerCheckbox);\n        var checkCaseObj = new CheckBox({\n            label: l10n.getConstant('CaseSensitive'),\n            checked: false,\n            cssClass: 'e-sort-casecheckbox'\n        });\n        var caseCheckbox = this.parent.createElement('input', {\n            className: 'e-sort-checkcase', attrs: { type: 'checkbox' }\n        });\n        headerTabElement.appendChild(caseCheckbox);\n        checkCaseObj.createElement = this.parent.createElement;\n        checkCaseObj.appendTo(caseCheckbox);\n    };\n    /**\n     * Creates a listview instance.\n     * @param listId - unique id of the list item.\n     */\n    Sort.prototype.getCustomListview = function (listId) {\n        var l10n = this.parent.serviceLocator.getService(locale);\n        var data = [{ id: listId, text: l10n.getConstant('SortBy'), field: '', order: 'ascending' }];\n        enableRipple(false);\n        var listviewObj = new ListView({\n            dataSource: data,\n            fields: { id: 'id' },\n            height: '100%',\n            template: '<div class=\"e-sort-listwrapper\">' +\n                '<span class=\"text\">${text}</span>' +\n                '<div class=\"e-sort-row\"><div class=\"e-sort-field\"></div>' +\n                '<div class=\"e-sort-order\">' +\n                '<span class=\"e-sort-ordertxt\" style=\"display:none;\">${order}</span></div>' +\n                '<span class=\"e-icons e-sort-delete\"></span></div>',\n            cssClass: 'e-sort-template',\n        });\n        return listviewObj;\n    };\n    /**\n     * Triggers the click event for delete icon.\n     * @param element - current list item element.\n     * @param listviewObj - listview instance.\n     */\n    Sort.prototype.deleteHandler = function (element, listviewObj) {\n        var iconEle = element.getElementsByClassName('e-sort-delete')[0];\n        //Event handler to bind the click event for delete icon\n        iconEle.addEventListener('click', function () {\n            if (element) {\n                listviewObj.removeItem(element);\n            }\n        });\n    };\n    /**\n     * Renders the dropdown and radio button components inside list item.\n     * @param id - unique id of the list item.\n     * @param listviewObj - listview instance.\n     * @param containsHeader - data contains header.\n     * @param fields - fields data.\n     */\n    Sort.prototype.renderListItem = function (id, lvObj, containsHeader, fields, btn) {\n        var _this = this;\n        var l10n = this.parent.serviceLocator.getService(locale);\n        var element = lvObj.element.querySelector('li[data-uid=' + id + ']');\n        var fieldsMap = containsHeader ? { text: 'text', value: 'value' } : { text: 'value' };\n        var dropDown = element.getElementsByClassName('e-sort-field')[0];\n        var dropDownListObj = new DropDownList({\n            dataSource: fields,\n            width: 'auto',\n            cssClass: 'e-sort-field-ddl',\n            fields: fieldsMap,\n            placeholder: l10n.getConstant('SelectAColumn'),\n            change: function (args) {\n                if (!args.value) {\n                    return;\n                }\n                Array.prototype.some.call(lvObj.dataSource, function (item) {\n                    if (item.id === id) {\n                        item.field = args.value.toString().replace('Column ', '');\n                    }\n                    return item.id === id; //breaks the loop when proper id found\n                });\n                _this.clearError();\n            }\n        });\n        dropDownListObj.createElement = this.parent.createElement;\n        dropDownListObj.appendTo(dropDown);\n        if (!btn) {\n            dropDownListObj.index = 0;\n        }\n        /* sort ascending radio button */\n        var orderRadio = element.getElementsByClassName('e-sort-order')[0];\n        var ordertxtElem = orderRadio.getElementsByClassName('e-sort-ordertxt')[0];\n        var isAscending = ordertxtElem.innerText.toLocaleLowerCase() === 'ascending';\n        var radiobutton = new RadioButton({\n            label: l10n.getConstant('SortAscending'),\n            name: 'sortAZ_' + id, value: 'ascending', checked: isAscending, cssClass: 'e-sort-radiobutton',\n            change: function (args) { _this.setRadioBtnValue(lvObj, id, args.value); }\n        });\n        var radio = this.parent.createElement('input', {\n            id: 'orderAsc_' + id, className: 'e-sort-radioasc', styles: '', attrs: { type: 'radio' }\n        });\n        orderRadio.appendChild(radio);\n        radiobutton.createElement = this.parent.createElement;\n        radiobutton.appendTo(radio);\n        /* sort descending radio button */\n        var radiobutton2 = new RadioButton({\n            label: l10n.getConstant('SortDescending'),\n            name: 'sortAZ_' + id, value: 'descending', checked: !isAscending, cssClass: 'e-sort-radiobutton',\n            change: function (args) { _this.setRadioBtnValue(lvObj, id, args.value); }\n        });\n        var radio2 = this.parent.createElement('input', {\n            id: 'orderDesc_' + id, className: 'e-sort-radiodesc', styles: '', attrs: { type: 'radio' }\n        });\n        orderRadio.appendChild(radio2);\n        radiobutton2.createElement = this.parent.createElement;\n        radiobutton2.appendTo(radio2);\n        this.deleteHandler(element, lvObj);\n    };\n    /**\n     * Sets the new value of the radio button.\n     * @param listviewObj - listview instance.\n     * @param id - unique id of the list item.\n     * @param value - new value.\n     */\n    Sort.prototype.setRadioBtnValue = function (listviewObj, id, value) {\n        if (!value) {\n            return;\n        }\n        Array.prototype.some.call(listviewObj.dataSource, function (item) {\n            if (item.id === id) {\n                item.order = value;\n            }\n            return item.id === id; //breaks the loop when proper id found\n        });\n    };\n    /**\n     * Clears the error from the dialog.\n     * @param dialogElem - dialog content element.\n     */\n    Sort.prototype.clearError = function () {\n        var dialogElem = document.getElementsByClassName('e-sort-dialog')[0];\n        var errorElem = dialogElem.getElementsByClassName('e-sort-error')[0];\n        if (errorElem.style.display !== 'none' && errorElem.innerHTML !== '') {\n            errorElem.style.display = 'none';\n            Array.prototype.forEach.call(dialogElem.getElementsByClassName('e-error'), function (element) {\n                element.classList.remove('e-error');\n            });\n        }\n    };\n    /**\n     * Triggers sort events and applies sorting.\n     */\n    Sort.prototype.applySortHandler = function (args) {\n        var _this = this;\n        var sheet = this.parent.getActiveSheet();\n        var address = args && args.range || sheet.selectedRange;\n        var sortOptions = args && args.sortOptions || { sortDescriptors: {} };\n        var beforeArgs = { range: address, sortOptions: sortOptions, cancel: false };\n        this.parent.trigger(beforeSort, beforeArgs);\n        if (beforeArgs.cancel) {\n            return;\n        }\n        this.parent.notify(beginAction, { eventArgs: beforeArgs, action: 'beforeSort' });\n        this.parent.showSpinner();\n        var range = getSwapRange(getIndexesFromAddress(beforeArgs.range));\n        var eventArgs = { filterRange: [], hasFilter: false };\n        if (range[0] === range[2] && (range[2] - range[0]) === 0) { //check for filter range\n            this.parent.notify(getFilterRange, eventArgs);\n            if (eventArgs.hasFilter && inRange(eventArgs.filterRange, range[0], range[1])) {\n                range[0] = eventArgs.filterRange[0];\n                range[1] = 0;\n                range[2] = sheet.usedRange.rowIndex;\n                range[3] = sheet.usedRange.colIndex;\n                beforeArgs.sortOptions.containsHeader = true;\n            }\n        }\n        this.parent.sort(beforeArgs.sortOptions, getRangeAddress(range)).then(function (sortArgs) {\n            _this.parent.trigger(sortComplete, sortArgs);\n            _this.parent.notify(completeAction, { eventArgs: sortArgs, action: 'sorting' });\n            return Promise.resolve(sortArgs);\n        }).catch(function (error) {\n            _this.sortRangeAlertHandler({ error: error });\n            return Promise.reject(error);\n        });\n    };\n    /**\n     * Invoked when the sort action is completed.\n     */\n    Sort.prototype.sortCompleteHandler = function (args) {\n        var range = getIndexesFromAddress(args.range);\n        this.parent.serviceLocator.getService('cell').refreshRange(range);\n        this.parent.hideSpinner();\n    };\n    return Sort;\n}());\nexport { Sort };\n","import { locale, dialog, mouseDown, renderFilterCell, initiateFilterUI } from '../index';\nimport { reapplyFilter, filterCellKeyDown } from '../index';\nimport { getFilteredColumn, cMenuBeforeOpen, filterByCellValue, clearFilter, getFilterRange, applySort, getCellPosition } from '../index';\nimport { filterRangeAlert, filterComplete, beforeFilter, clearAllFilter, getFilteredCollection } from '../../workbook/common/event';\nimport { getRangeIndexes } from '../../workbook/index';\nimport { getIndexesFromAddress, getSwapRange, getColumnHeaderText } from '../../workbook/index';\nimport { getData, getTypeFromFormat, getCell, getCellIndexes, getRangeAddress, getSheet } from '../../workbook/index';\nimport { getComponent } from '@syncfusion/ej2-base';\nimport { ExcelFilterBase, beforeFltrcMenuOpen, CheckBoxFilterBase } from '@syncfusion/ej2-grids';\nimport { beforeCustomFilterOpen, parentsUntil, filterCboxValue } from '@syncfusion/ej2-grids';\nimport { Button } from '@syncfusion/ej2-buttons';\nimport { Query, DataManager } from '@syncfusion/ej2-data';\nimport { beginAction, completeAction } from '../../spreadsheet/index';\n/**\n * `Filter` module is used to handle the filter action in Spreadsheet.\n */\nvar Filter = /** @class */ (function () {\n    /**\n     * Constructor for filter module.\n     */\n    function Filter(parent) {\n        this.parent = parent;\n        this.filterCollection = new Map();\n        this.filterClassList = new Map();\n        this.filterRange = new Map();\n        this.addEventListener();\n    }\n    /**\n     * To destroy the filter module.\n     * @return {void}\n     */\n    Filter.prototype.destroy = function () {\n        this.removeEventListener();\n        this.filterRange = null;\n        this.filterCollection = null;\n        this.filterClassList = null;\n        this.parent = null;\n    };\n    Filter.prototype.addEventListener = function () {\n        this.parent.on(filterRangeAlert, this.filterRangeAlertHandler, this);\n        this.parent.on(initiateFilterUI, this.initiateFilterUIHandler, this);\n        this.parent.on(mouseDown, this.filterMouseDownHandler, this);\n        this.parent.on(renderFilterCell, this.renderFilterCellHandler, this);\n        this.parent.on(clearAllFilter, this.clearAllFilterHandler, this);\n        this.parent.on(beforeFltrcMenuOpen, this.beforeFilterMenuOpenHandler, this);\n        this.parent.on(beforeCustomFilterOpen, this.beforeCustomFilterOpenHandler, this);\n        this.parent.on(reapplyFilter, this.reapplyFilterHandler, this);\n        this.parent.on(filterByCellValue, this.filterByCellValueHandler, this);\n        this.parent.on(clearFilter, this.clearFilterHandler, this);\n        this.parent.on(getFilteredColumn, this.getFilteredColumnHandler, this);\n        this.parent.on(cMenuBeforeOpen, this.cMenuBeforeOpenHandler, this);\n        this.parent.on(filterCboxValue, this.filterCboxValueHandler, this);\n        this.parent.on(getFilterRange, this.getFilterRangeHandler, this);\n        this.parent.on(filterCellKeyDown, this.filterCellKeyDownHandler, this);\n        this.parent.on(getFilteredCollection, this.getFilteredCollection, this);\n    };\n    Filter.prototype.removeEventListener = function () {\n        if (!this.parent.isDestroyed) {\n            this.parent.off(filterRangeAlert, this.filterRangeAlertHandler);\n            this.parent.off(initiateFilterUI, this.initiateFilterUIHandler);\n            this.parent.off(mouseDown, this.filterMouseDownHandler);\n            this.parent.off(renderFilterCell, this.renderFilterCellHandler);\n            this.parent.off(clearAllFilter, this.clearAllFilterHandler);\n            this.parent.off(beforeFltrcMenuOpen, this.beforeFilterMenuOpenHandler);\n            this.parent.off(beforeCustomFilterOpen, this.beforeCustomFilterOpenHandler);\n            this.parent.off(reapplyFilter, this.reapplyFilterHandler);\n            this.parent.off(filterByCellValue, this.filterByCellValueHandler);\n            this.parent.off(clearFilter, this.clearFilterHandler);\n            this.parent.off(getFilteredColumn, this.getFilteredColumnHandler);\n            this.parent.off(cMenuBeforeOpen, this.cMenuBeforeOpenHandler);\n            this.parent.on(filterCboxValue, this.filterCboxValueHandler);\n            this.parent.off(getFilterRange, this.getFilterRangeHandler);\n            this.parent.off(filterCellKeyDown, this.filterCellKeyDownHandler);\n            this.parent.off(getFilteredCollection, this.getFilteredCollection);\n        }\n    };\n    /**\n     * Gets the module name.\n     * @returns string\n     */\n    Filter.prototype.getModuleName = function () {\n        return 'filter';\n    };\n    /**\n     * Validates the range and returns false when invalid.\n     */\n    Filter.prototype.isInValidFilterRange = function (sheet, range) {\n        var selectedRange = range ? getSwapRange(getIndexesFromAddress(range)) :\n            getSwapRange(getIndexesFromAddress(sheet.selectedRange));\n        return selectedRange[0] > sheet.usedRange.rowIndex || selectedRange[1] > sheet.usedRange.colIndex;\n    };\n    /**\n     * Shows the range error alert dialog.\n     * @param error - range error string.\n     */\n    Filter.prototype.filterRangeAlertHandler = function (args) {\n        var _this = this;\n        var dialogInst = this.parent.serviceLocator.getService(dialog);\n        dialogInst.show({\n            content: args.error, isModal: true,\n            height: 180, width: 400, showCloseIcon: true,\n            beforeOpen: function (args) {\n                var dlgArgs = {\n                    dialogName: 'FilterRangeDialog',\n                    element: args.element, target: args.target, cancel: args.cancel\n                };\n                _this.parent.trigger('dialogBeforeOpen', dlgArgs);\n                if (dlgArgs.cancel) {\n                    args.cancel = true;\n                }\n            },\n        });\n        this.parent.hideSpinner();\n    };\n    /**\n     * Triggers before filter context menu opened and used to add sorting items.\n     */\n    Filter.prototype.beforeFilterMenuOpenHandler = function (args) {\n        var l10n = this.parent.serviceLocator.getService(locale);\n        args.element.classList.add('e-spreadsheet-contextmenu'); // to show sort icons\n        var ul = args.element.querySelector('ul');\n        this.addMenuItem(ul, l10n.getConstant('SortDescending'), 'e-filter-sortdesc', 'e-sort-desc');\n        this.addMenuItem(ul, l10n.getConstant('SortAscending'), 'e-filter-sortasc', 'e-sort-asc');\n        args.element.appendChild(ul);\n    };\n    /**\n     * Creates new menu item element\n     */\n    Filter.prototype.addMenuItem = function (ul, text, className, iconCss) {\n        var li = this.parent.createElement('li', { className: className + ' e-menu-item' });\n        li.innerHTML = text;\n        li.insertBefore(this.parent.createElement('span', { className: 'e-menu-icon e-icons ' + iconCss }), li.firstChild);\n        ul.insertBefore(li, ul.firstChild);\n    };\n    /**\n     * Initiates the filter UI for the selected range.\n     */\n    Filter.prototype.initiateFilterUIHandler = function (args) {\n        var _this = this;\n        var predicates = args ? args.predicates : null;\n        var sheetIdx = args.sIdx;\n        if (!sheetIdx && sheetIdx !== 0) {\n            sheetIdx = this.parent.activeSheetIndex;\n        }\n        if (this.filterRange.size > 0 && this.filterRange.has(sheetIdx)) { //disable filter\n            this.removeFilter(sheetIdx);\n            if (!predicates) {\n                return;\n            }\n        }\n        var sheet = getSheet(this.parent, sheetIdx);\n        if (this.isInValidFilterRange(sheet, args.range)) {\n            var l10n = this.parent.serviceLocator.getService(locale);\n            this.filterRangeAlertHandler({ error: l10n.getConstant('FilterOutOfRangeError') });\n            return;\n        }\n        var selectedRange = sheet.selectedRange;\n        var rangeIdx = getRangeIndexes(selectedRange);\n        if (rangeIdx[0] === rangeIdx[2] && rangeIdx[1] === rangeIdx[3]) {\n            rangeIdx[0] = 0;\n            rangeIdx[1] = 1;\n            rangeIdx[2] = sheet.usedRange.rowIndex;\n            rangeIdx[3] = sheet.usedRange.colIndex;\n            selectedRange = getRangeAddress(rangeIdx);\n        }\n        var eventArgs = {\n            range: args.range ? args.range : selectedRange,\n            filterOptions: { predicates: args.predicates }, cancel: false\n        };\n        if (!args.isCut) {\n            this.parent.notify(beginAction, { action: 'filter', eventArgs: eventArgs });\n        }\n        this.processRange(sheet, sheetIdx, args ? args.range : null);\n        if (predicates) {\n            var range = this.filterRange.get(sheetIdx).slice();\n            range[0] = range[0] + 1; // to skip first row.\n            range[2] = sheet.usedRange.rowIndex; //filter range should be till used range.\n            getData(this.parent, sheet.name + \"!\" + getRangeAddress(range), true, true).then(function (jsonData) {\n                _this.filterSuccessHandler(new DataManager(jsonData), {\n                    action: 'filtering',\n                    filterCollection: predicates, field: predicates[0].field, sIdx: args.sIdx\n                });\n                predicates.forEach(function (predicate) {\n                    if (_this.filterClassList.get(sheetIdx)[predicate.field] &&\n                        _this.filterClassList.get(sheetIdx)[predicate.field].indexOf(' e-filtered') < 0) {\n                        _this.filterClassList.get(sheetIdx)[predicate.field] += ' e-filtered';\n                    }\n                });\n                _this.refreshFilterRange(null, false, args.sIdx);\n            });\n        }\n        if (!args.isCut) {\n            this.parent.notify(completeAction, { action: 'filter', eventArgs: eventArgs });\n        }\n    };\n    /**\n     * Processes the range if no filter applied.\n     */\n    Filter.prototype.processRange = function (sheet, sheetIdx, filterRange) {\n        var range = getSwapRange(getIndexesFromAddress(filterRange || sheet.selectedRange));\n        if (range[0] === range[2] && range[1] === range[3]) { //if selected range is a single cell \n            range[0] = 0;\n            range[1] = 0;\n            range[2] = sheet.usedRange.rowIndex;\n            range[3] = sheet.usedRange.colIndex;\n        }\n        this.filterRange.set(sheetIdx, range);\n        this.filterCollection.set(sheetIdx, []);\n        this.filterClassList.set(sheetIdx, {});\n        this.refreshFilterRange(range, false, sheetIdx);\n    };\n    /**\n     * Removes all the filter related collections for the active sheet.\n     */\n    Filter.prototype.removeFilter = function (sheetIdx) {\n        if (this.filterCollection.get(sheetIdx).length) {\n            this.parent.clearFilter();\n        }\n        var range = this.filterRange.get(sheetIdx).slice();\n        this.filterRange.delete(sheetIdx);\n        this.filterCollection.delete(sheetIdx);\n        this.filterClassList.delete(sheetIdx);\n        this.refreshFilterRange(range, true, sheetIdx);\n    };\n    /**\n     * Handles filtering cell value based on context menu.\n     */\n    Filter.prototype.filterByCellValueHandler = function () {\n        var _this = this;\n        var sheetIdx = this.parent.activeSheetIndex;\n        var sheet = this.parent.getActiveSheet();\n        if (this.isInValidFilterRange(sheet)) {\n            var l10n = this.parent.serviceLocator.getService(locale);\n            this.filterRangeAlertHandler({ error: l10n.getConstant('FilterOutOfRangeError') });\n            return;\n        }\n        var cell = getCellIndexes(sheet.activeCell);\n        if (!this.isFilterRange(sheetIdx, cell[0], cell[1])) {\n            this.processRange(sheet, sheetIdx);\n        }\n        var range = this.filterRange.get(sheetIdx).slice();\n        range[0] = range[0] + 1; // to skip first row.\n        range[2] = sheet.usedRange.rowIndex; //filter range should be till used range.\n        var field = getColumnHeaderText(cell[1] + 1);\n        var type = this.getColumnType(sheet, cell[1] + 1, range);\n        var predicates = [{\n                field: field,\n                operator: type === 'date' || type === 'datetime' || type === 'boolean' ? 'equal' : 'contains',\n                value: getCell(cell[0], cell[1], sheet).value, matchCase: false, type: type\n            }];\n        getData(this.parent, sheet.name + \"!\" + getRangeAddress(range), true, true).then(function (jsonData) {\n            _this.filterSuccessHandler(new DataManager(jsonData), { action: 'filtering', filterCollection: predicates, field: field });\n        });\n    };\n    /**\n     * Creates filter buttons and renders the filter applied cells.\n     */\n    Filter.prototype.renderFilterCellHandler = function (args) {\n        var sheetIdx = args.sIdx | this.parent.activeSheetIndex;\n        if (this.filterRange.has(sheetIdx) && this.isFilterCell(sheetIdx, args.rowIndex, args.colIndex)) {\n            if (!args.td) {\n                return;\n            }\n            var field = getColumnHeaderText(args.colIndex + 1);\n            if (this.filterClassList.has(sheetIdx) && !this.filterClassList.get(sheetIdx)[field]) {\n                this.filterClassList.get(sheetIdx)[field] = '';\n            }\n            if (args.td.querySelector('.e-filter-btn')) {\n                var element = args.td.querySelector('.e-filter-iconbtn');\n                var filterBtnObj = getComponent(element, 'btn');\n                filterBtnObj.iconCss = 'e-icons e-filter-icon' + this.filterClassList.get(sheetIdx)[field];\n            }\n            else {\n                var filterButton = this.parent.createElement('div', { className: 'e-filter-btn' });\n                var filterBtnObj = new Button({ iconCss: 'e-icons e-filter-icon' + this.filterClassList.get(sheetIdx)[field], cssClass: 'e-filter-iconbtn' });\n                args.td.insertBefore(filterButton, args.td.firstChild);\n                filterBtnObj.createElement = this.parent.createElement;\n                filterBtnObj.appendTo(filterButton);\n            }\n        }\n    };\n    /**\n     * Refreshes the filter header range.\n     */\n    Filter.prototype.refreshFilterRange = function (filterRange, remove, sIdx) {\n        var sheetIdx = sIdx;\n        if (!sheetIdx && sheetIdx !== 0) {\n            sheetIdx = this.parent.activeSheetIndex;\n        }\n        var range = filterRange || this.filterRange.get(sheetIdx).slice();\n        for (var index = range[1]; index <= range[3]; index++) {\n            var cell = this.parent.getCell(range[0], index);\n            if (remove) {\n                if (cell && cell.hasChildNodes()) {\n                    var element = cell.querySelector('.e-filter-btn');\n                    if (element) {\n                        cell.removeChild(element);\n                    }\n                }\n            }\n            else {\n                this.renderFilterCellHandler({ td: cell, rowIndex: range[0], colIndex: index, sIdx: sheetIdx });\n            }\n        }\n    };\n    /**\n     * Checks whether the provided cell is a filter cell.\n     */\n    Filter.prototype.isFilterCell = function (sheetIdx, rowIndex, colIndex) {\n        var range = this.filterRange.get(sheetIdx);\n        return (range && range[0] === rowIndex && range[1] <= colIndex && range[3] >= colIndex);\n    };\n    /**\n     * Checks whether the provided cell is in a filter range\n     */\n    Filter.prototype.isFilterRange = function (sheetIdx, rowIndex, colIndex) {\n        var range = this.filterRange.get(sheetIdx);\n        return (range && range[0] <= rowIndex && range[2] >= rowIndex && range[1] <= colIndex && range[3] >= colIndex);\n    };\n    /**\n     * Gets the filter information from active cell\n     */\n    Filter.prototype.getFilteredColumnHandler = function (args) {\n        var sheetIdx = this.parent.activeSheetIndex;\n        var l10n = this.parent.serviceLocator.getService(locale);\n        args.clearFilterText = l10n.getConstant('ClearFilter');\n        if (this.filterRange.has(sheetIdx)) {\n            var filterCollection = this.filterCollection.get(sheetIdx);\n            if (args.isClearAll) {\n                args.isFiltered = filterCollection && filterCollection.length > 0;\n                return;\n            }\n            var range = this.filterRange.get(sheetIdx).slice();\n            var sheet = this.parent.getActiveSheet();\n            var cell = getCellIndexes(sheet.activeCell);\n            if (this.isFilterRange(sheetIdx, cell[0], cell[1])) {\n                args.field = getColumnHeaderText(cell[1] + 1);\n                var headerCell = getCell(range[0], cell[1], sheet);\n                var cellValue = this.parent.getDisplayText(headerCell);\n                args.clearFilterText = l10n.getConstant('ClearFilterFrom') + '\\\"'\n                    + (cellValue ? cellValue.toString() : 'Column ' + args.field) + '\\\"';\n                filterCollection.some(function (value) {\n                    args.isFiltered = value.field === args.field;\n                    return args.isFiltered;\n                });\n            }\n        }\n    };\n    /**\n     * Triggers before context menu created to enable or disable items.\n     */\n    Filter.prototype.cMenuBeforeOpenHandler = function (e) {\n        var id = this.parent.element.id + '_cmenu';\n        if (e.parentItem && e.parentItem.id === id + '_filter' && e.target === '') {\n            var args = { isFiltered: false };\n            this.getFilteredColumnHandler(args);\n            this.parent.enableContextMenuItems([id + '_clearfilter', id + '_reapplyfilter'], !!args.isFiltered, true);\n        }\n    };\n    /**\n     * Closes the filter popup.\n     */\n    Filter.prototype.closeDialog = function () {\n        var filterPopup = this.parent.element.querySelector('.e-filter-popup');\n        var excelFilter = getComponent(filterPopup, 'dialog');\n        if (excelFilter) {\n            excelFilter.hide();\n        }\n    };\n    /**\n     * Returns true if the filter popup is opened.\n     */\n    Filter.prototype.isPopupOpened = function () {\n        var filterPopup = this.parent.element.querySelector('.e-filter-popup');\n        return filterPopup && filterPopup.style.display !== 'none';\n    };\n    Filter.prototype.filterCellKeyDownHandler = function (args) {\n        var sheetIdx = this.parent.activeSheetIndex;\n        var sheet = this.parent.getActiveSheet();\n        var indexes = getCellIndexes(sheet.activeCell);\n        if (this.isFilterCell(sheetIdx, indexes[0], indexes[1])) {\n            args.isFilterCell = true;\n            var pos = getCellPosition(sheet, indexes);\n            var target = this.parent.getCell(indexes[0], indexes[1]);\n            if (this.isPopupOpened()) {\n                this.closeDialog();\n            }\n            this.openDialog(target, pos.left, pos.top);\n        }\n        else {\n            args.isFilterCell = false;\n        }\n    };\n    /**\n     * Opens the filter popup dialog on filter button click.\n     */\n    Filter.prototype.filterMouseDownHandler = function (e) {\n        var target = e.target;\n        if (target.classList.contains('e-filter-icon')) {\n            if (this.isPopupOpened()) {\n                this.closeDialog();\n                return;\n            }\n            this.openDialog(target, e.x, e.y);\n        }\n        else if (this.isPopupOpened()) {\n            if (!target.classList.contains('e-searchinput') && !target.classList.contains('e-searchclear')\n                && (target.offsetParent && !target.offsetParent.classList.contains('e-filter-popup'))) {\n                this.closeDialog();\n            }\n            else {\n                this.selectSortItemHandler(target);\n            }\n        }\n    };\n    /**\n     * Opens the excel filter dialog based on target.\n     */\n    Filter.prototype.openDialog = function (target, xPos, yPos) {\n        var _this = this;\n        var cell = parentsUntil(target, 'e-cell');\n        var colIndex = parseInt(cell.getAttribute('aria-colindex'), 10);\n        var field = getColumnHeaderText(colIndex);\n        //Update datasource dynamically\n        this.parent.showSpinner();\n        var sheetIdx = this.parent.activeSheetIndex;\n        var range = this.filterRange.get(sheetIdx).slice();\n        var sheet = this.parent.getActiveSheet();\n        var filterCell = getCell(range[0], colIndex - 1, sheet);\n        var displayName = this.parent.getDisplayText(filterCell);\n        range[0] = range[0] + 1; // to skip first row.\n        range[2] = sheet.usedRange.rowIndex; //filter range should be till used range.\n        getData(this.parent, sheet.name + \"!\" + getRangeAddress(range), true, true).then(function (jsonData) {\n            //to avoid undefined array data\n            var checkBoxData;\n            jsonData.some(function (value, index) {\n                if (value) {\n                    checkBoxData = new DataManager(jsonData.slice(index));\n                }\n                return !!value;\n            });\n            var options = {\n                type: _this.getColumnType(sheet, colIndex, range), field: field, displayName: displayName || 'Column ' + field,\n                dataSource: checkBoxData, height: _this.parent.element.classList.contains('e-bigger') ? 800 : 500, columns: [],\n                hideSearchbox: false, filteredColumns: _this.filterCollection.get(sheetIdx), column: { 'field': field, 'filter': {} },\n                handler: _this.filterSuccessHandler.bind(_this, new DataManager(jsonData)), target: target,\n                position: { X: xPos, Y: yPos }, localeObj: _this.parent.serviceLocator.getService(locale)\n            };\n            var excelFilter = new ExcelFilterBase(_this.parent, _this.getLocalizedCustomOperators());\n            excelFilter.openDialog(options);\n            _this.parent.hideSpinner();\n        });\n    };\n    /**\n     * Formats cell value for listing it in filter popup.\n     */\n    Filter.prototype.filterCboxValueHandler = function (args) {\n        if (args.column && args.data) {\n            var fieldKey = 'field';\n            var field = args.column[fieldKey];\n            var dataKey = 'dataObj';\n            var rowKey = '__rowIndex';\n            if (args.value) {\n                var indexes = getCellIndexes(field + args.data[dataKey][rowKey]);\n                var cell = getCell(indexes[0], indexes[1], this.parent.getActiveSheet());\n                if (cell && cell.format) {\n                    args.value = this.parent.getDisplayText(cell);\n                }\n            }\n        }\n    };\n    /**\n     * Triggers when sorting items are chosen on context menu of filter popup.\n     */\n    Filter.prototype.selectSortItemHandler = function (target) {\n        var sortOrder = target.classList.contains('e-filter-sortasc') ? 'Ascending'\n            : target.classList.contains('e-filter-sortdesc') ? 'Descending' : null;\n        if (!sortOrder) {\n            return;\n        }\n        var sheet = this.parent.getActiveSheet();\n        var sheetIdx = this.parent.activeSheetIndex;\n        var range = this.filterRange.get(sheetIdx).slice();\n        range[0] = range[0] + 1; // to skip first row.\n        range[2] = sheet.usedRange.rowIndex; //filter range should be till used range.\n        this.parent.notify(applySort, { sortOptions: { sortDescriptors: { order: sortOrder } }, range: getRangeAddress(range) });\n        var cell = getIndexesFromAddress(sheet.activeCell);\n        var field = getColumnHeaderText(cell[1] + 1);\n        for (var _i = 0, _a = Object.keys(this.filterClassList.get(sheetIdx)); _i < _a.length; _i++) {\n            var key = _a[_i];\n            var className = this.filterClassList.get(sheetIdx)[key].replace(/\\se-sortasc-filter|\\se-sortdesc-filter/gi, '');\n            if (key === field) {\n                className += sortOrder === 'Ascending' ? ' e-sortasc-filter' : ' e-sortdesc-filter';\n            }\n            this.filterClassList.get(sheetIdx)[key] = className;\n        }\n        this.refreshFilterRange();\n        this.closeDialog();\n    };\n    /**\n     * Triggers when OK button or clear filter item is selected\n     */\n    Filter.prototype.filterSuccessHandler = function (dataSource, args) {\n        var sheetIdx = args.sIdx;\n        if (!sheetIdx && sheetIdx !== 0) {\n            sheetIdx = this.parent.activeSheetIndex;\n        }\n        var predicates = this.filterCollection.get(sheetIdx);\n        var dataManager = new DataManager(predicates);\n        var query = new Query();\n        var fields = dataManager.executeLocal(query.where('field', 'equal', args.field));\n        for (var index = 0; index < fields.length; index++) {\n            var sameIndex = -1;\n            for (var filterIndex = 0; filterIndex < predicates.length; filterIndex++) {\n                if (predicates[filterIndex].field === fields[index].field) {\n                    sameIndex = filterIndex;\n                    break;\n                }\n            }\n            if (sameIndex !== -1) {\n                predicates.splice(sameIndex, 1);\n            }\n        }\n        if (args.action === 'filtering') {\n            predicates = predicates.concat(args.filterCollection);\n            if (predicates.length && this.filterClassList.get(sheetIdx)[args.field].indexOf(' e-filtered') < 0) {\n                this.filterClassList.get(sheetIdx)[args.field] += ' e-filtered';\n            }\n        }\n        else {\n            this.filterClassList.get(sheetIdx)[args.field] = this.filterClassList.get(sheetIdx)[args.field].replace(' e-filtered', '');\n        }\n        this.filterCollection.set(sheetIdx, predicates);\n        var filterOptions = {\n            datasource: dataSource,\n            predicates: this.getPredicates(sheetIdx),\n        };\n        this.filterRange.get(sheetIdx)[2] = getSheet(this.parent, sheetIdx).usedRange.rowIndex; //extend the range if filtered\n        this.applyFilter(filterOptions, getRangeAddress(this.filterRange.get(sheetIdx)));\n    };\n    /**\n     * Triggers events for filtering and applies filter.\n     */\n    Filter.prototype.applyFilter = function (filterOptions, range) {\n        var _this = this;\n        var args = { range: range, filterOptions: filterOptions, cancel: false };\n        this.parent.trigger(beforeFilter, args);\n        if (args.cancel) {\n            return;\n        }\n        this.parent.showSpinner();\n        this.parent.filter(filterOptions, range).then(function (args) {\n            _this.refreshFilterRange();\n            _this.parent.hideSpinner();\n            _this.parent.trigger(filterComplete, args);\n            return Promise.resolve(args);\n        }).catch(function (error) {\n            _this.filterRangeAlertHandler({ error: error });\n            return Promise.reject(error);\n        });\n    };\n    /**\n     * Gets the predicates for the sheet\n     */\n    Filter.prototype.getPredicates = function (sheetIdx) {\n        var predicateList = [];\n        var excelPredicate = CheckBoxFilterBase.getPredicate(this.filterCollection.get(sheetIdx));\n        for (var _i = 0, _a = Object.keys(excelPredicate); _i < _a.length; _i++) {\n            var prop = _a[_i];\n            predicateList.push(excelPredicate[prop]);\n        }\n        return predicateList;\n    };\n    /**\n     * Gets the column type to pass it into the excel filter options.\n     */\n    Filter.prototype.getColumnType = function (sheet, colIndex, range) {\n        var num = 0;\n        var str = 0;\n        var date = 0;\n        var time = 0;\n        for (var i = range[0]; i <= sheet.usedRange.rowIndex; i++) {\n            var cell = getCell(i, colIndex - 1, sheet);\n            if (cell) {\n                if (cell.format) {\n                    var type = getTypeFromFormat(cell.format).toLowerCase();\n                    switch (type) {\n                        case 'number':\n                        case 'currency':\n                        case 'accounting':\n                        case 'percentage':\n                            num++;\n                            break;\n                        case 'shortdate':\n                        case 'longdate':\n                            date++;\n                            break;\n                        case 'time':\n                            num++;\n                            break;\n                        default:\n                            str++;\n                            break;\n                    }\n                }\n                else {\n                    if (typeof cell.value === 'string') {\n                        str++;\n                    }\n                    else {\n                        num++;\n                    }\n                }\n            }\n            else {\n                str++;\n            }\n        }\n        return (num > str && num > date && num > time) ? 'number' : (str > num && str > date && str > time) ? 'string'\n            : (date > num && date > str && date > time) ? 'date' : 'datetime';\n    };\n    /**\n     * Triggers before the custom filter dialog opened.\n     */\n    Filter.prototype.beforeCustomFilterOpenHandler = function () {\n        this.closeDialog();\n    };\n    /**\n     * Clears all the filtered columns in the active sheet.\n     */\n    Filter.prototype.clearAllFilterHandler = function () {\n        if (this.filterRange.has(this.parent.activeSheetIndex)) {\n            this.filterCollection.set(this.parent.activeSheetIndex, []);\n            for (var _i = 0, _a = Object.keys(this.filterClassList.get(this.parent.activeSheetIndex)); _i < _a.length; _i++) {\n                var key = _a[_i];\n                this.filterClassList.get(this.parent.activeSheetIndex)[key] = '';\n            }\n            this.refreshFilterRange();\n        }\n    };\n    /**\n     * Clear filter from the field.\n     */\n    Filter.prototype.clearFilterHandler = function (args) {\n        this.filterSuccessHandler(null, { action: 'clear-filter', filterCollection: [], field: args.field });\n    };\n    /**\n     * Reapplies the filter.\n     */\n    Filter.prototype.reapplyFilterHandler = function () {\n        var sheetIdx = this.parent.activeSheetIndex;\n        if (this.filterRange.has(sheetIdx)) {\n            this.applyFilter({ predicates: this.getPredicates(sheetIdx) }, getRangeAddress(this.filterRange.get(sheetIdx)));\n        }\n    };\n    /**\n     * Gets the filter information of the sheet.\n     */\n    Filter.prototype.getFilterRangeHandler = function (args) {\n        var sheetIdx = args.sheetIdx;\n        if (this.filterRange && this.filterRange.has(sheetIdx)) {\n            args.hasFilter = true;\n            args.filterRange = this.filterRange.get(sheetIdx);\n        }\n        else {\n            args.hasFilter = false;\n            args.filterRange = null;\n        }\n    };\n    /**\n     * Returns the custom operators for filter items.\n     */\n    Filter.prototype.getLocalizedCustomOperators = function () {\n        var l10n = this.parent.serviceLocator.getService(locale);\n        var numOptr = [\n            { value: 'equal', text: l10n.getConstant('Equal') },\n            { value: 'greaterthan', text: l10n.getConstant('GreaterThan') },\n            { value: 'greaterthanorequal', text: l10n.getConstant('GreaterThanOrEqual') },\n            { value: 'lessthan', text: l10n.getConstant('LessThan') },\n            { value: 'lessthanorequal', text: l10n.getConstant('LessThanOrEqual') },\n            { value: 'notequal', text: l10n.getConstant('NotEqual') }\n        ];\n        var customOperators = {\n            stringOperator: [\n                { value: 'startswith', text: l10n.getConstant('StartsWith') },\n                { value: 'endswith', text: l10n.getConstant('EndsWith') },\n                { value: 'contains', text: l10n.getConstant('Contains') },\n                { value: 'equal', text: l10n.getConstant('Equal') },\n                { value: 'notequal', text: l10n.getConstant('NotEqual') }\n            ],\n            numberOperator: numOptr,\n            dateOperator: numOptr,\n            datetimeOperator: numOptr,\n            booleanOperator: [\n                { value: 'equal', text: l10n.getConstant('Equal') },\n                { value: 'notequal', text: l10n.getConstant('NotEqual') }\n            ]\n        };\n        return customOperators;\n    };\n    /**\n     * To get filtered range and predicates collections\n     */\n    Filter.prototype.getFilteredCollection = function () {\n        var sheetLen = this.parent.sheets.length;\n        var col = [];\n        var fil;\n        for (var i = 0; i < sheetLen; i++) {\n            var range = void 0;\n            var hasFilter = void 0;\n            var args = { sheetIdx: i, filterRange: range, hasFilter: hasFilter };\n            this.getFilterRangeHandler(args);\n            if (args.hasFilter) {\n                var colCollection = [];\n                var condition = [];\n                var value = [];\n                var type = [];\n                var predicate = this.filterCollection.get(args.sheetIdx);\n                for (var i_1 = 0; i_1 < predicate.length; i_1++) {\n                    if (predicate[i_1].field && predicate[i_1].operator) {\n                        var colIdx = getCellIndexes(predicate[i_1].field + '1')[1];\n                        colCollection.push(colIdx);\n                        condition.push(predicate[i_1].operator);\n                        value.push(predicate[i_1].value);\n                        type.push(predicate[i_1].type);\n                    }\n                }\n                var address = getRangeAddress(args.filterRange);\n                fil = {\n                    sheetIdx: args.sheetIdx, filterRange: address, hasFilter: args.hasFilter, column: colCollection,\n                    criteria: condition, value: value, dataType: type\n                };\n                col.push(fil);\n            }\n        }\n        if (fil) {\n            this.parent.filterCollection = col;\n        }\n    };\n    return Filter;\n}());\nexport { Filter };\n","import { getColIdxFromClientX, createImageElement, deleteImage, refreshImagePosition } from '../common/event';\nimport { insertImage, refreshImgElem, refreshImgCellObj, getRowIdxFromClientY, } from '../common/event';\nimport { overlay, dialog } from '../common/index';\nimport { removeClass } from '@syncfusion/ej2-base';\nimport { getCell, setCell, getSheetIndex } from '../../workbook/index';\nimport { getRangeIndexes, setImage } from '../../workbook/index';\nvar SpreadsheetImage = /** @class */ (function () {\n    function SpreadsheetImage(parent) {\n        this.pictureCount = 1;\n        this.parent = parent;\n        this.addEventListener();\n        this.renderImageUpload();\n    }\n    /**\n     * Adding event listener for success and failure\n     */\n    SpreadsheetImage.prototype.addEventListener = function () {\n        this.parent.on(insertImage, this.insertImage, this);\n        this.parent.on(refreshImgElem, this.refreshImgElem, this);\n        this.parent.on(refreshImgCellObj, this.refreshImgCellObj, this);\n        this.parent.on(createImageElement, this.createImageElement, this);\n        this.parent.on(deleteImage, this.deleteImage, this);\n        this.parent.on(refreshImagePosition, this.refreshInsDelImagePosition, this);\n    };\n    /**\n     * Rendering upload component for importing images.\n     */\n    SpreadsheetImage.prototype.renderImageUpload = function () {\n        var uploadID = this.parent.element.id + '_imageUpload';\n        this.parent.element.appendChild(this.parent.createElement('input', {\n            id: uploadID,\n            attrs: { type: 'file', accept: '.image, .jpg, .png, .gif ,jpeg', name: 'fileUpload' }\n        }));\n        var uploadBox = document.getElementById(uploadID);\n        uploadBox.onchange = this.imageSelect.bind(this);\n        uploadBox.style.display = 'none';\n    };\n    /**\n     * Process after select the excel and image file.\n     * @param {Event} args - File select native event.\n     */\n    SpreadsheetImage.prototype.imageSelect = function (args) {\n        /* tslint:disable-next-line:no-any */\n        var filesData = args.target.files[0];\n        if (filesData && filesData.length < 1) {\n            return;\n        }\n        var impArgs = {\n            file: filesData\n        };\n        /* tslint:disable-next-line:no-any */\n        if (impArgs.file.type.indexOf('image') === 0) {\n            this.insertImage(impArgs);\n        }\n        else {\n            this.parent.serviceLocator.getService(dialog).show({\n                content: this.parent.serviceLocator.getService('spreadsheetLocale')\n                    .getConstant('UnsupportedFile'),\n                width: '300'\n            });\n        }\n        document.getElementById(this.parent.element.id + '_imageUpload').value = '';\n    };\n    /**\n     * Removing event listener for success and failure\n     */\n    SpreadsheetImage.prototype.removeEventListener = function () {\n        if (!this.parent.isDestroyed) {\n            this.parent.off(insertImage, this.insertImage);\n            this.parent.off(refreshImgCellObj, this.refreshImgCellObj);\n            this.parent.off(createImageElement, this.createImageElement);\n            this.parent.off(deleteImage, this.deleteImage);\n            this.parent.off(refreshImagePosition, this.refreshInsDelImagePosition);\n        }\n    };\n    // tslint:disable\n    SpreadsheetImage.prototype.insertImage = function (args, range) {\n        var _this = this;\n        this.binaryStringVal(args).then(function (src) { return _this.createImageElement({ options: { src: src }, range: range, isPublic: true }); });\n    };\n    SpreadsheetImage.prototype.binaryStringVal = function (args) {\n        return new Promise(function (resolve, reject) {\n            var reader = new FileReader();\n            reader.readAsDataURL(args.file);\n            reader.onload = function () { return resolve(reader.result); };\n            reader.onerror = function (error) { return reject(error); };\n        });\n    };\n    // tslint:enable\n    SpreadsheetImage.prototype.createImageElement = function (args) {\n        var range = args.range ? (args.range.indexOf('!') > 0) ? args.range.split('!')[1] : args.range.split('!')[0]\n            : this.parent.getActiveSheet().selectedRange;\n        var sheetIndex = (args.range && args.range.indexOf('!') > 0) ?\n            getSheetIndex(this.parent, args.range.split('!')[0]) : this.parent.activeSheetIndex;\n        var overlayObj = this.parent.serviceLocator.getService(overlay);\n        var id = args.options.imageId ? args.options.imageId : this.parent.element.id + '_overlay_picture_' + this.pictureCount;\n        var indexes = getRangeIndexes(range);\n        var sheet = sheetIndex ? this.parent.sheets[sheetIndex] : this.parent.getActiveSheet();\n        if (document.getElementById(id)) {\n            return;\n        }\n        var eventArgs = {\n            requestType: 'beforeInsertImage', range: sheet.name + '!' + range,\n            imageData: args.options.src, sheetIndex: sheetIndex\n        };\n        if (args.isPublic) {\n            this.parent.notify('actionBegin', { eventArgs: eventArgs, action: 'beforeInsertImage' });\n        }\n        if (eventArgs.cancel) {\n            return;\n        }\n        var element = overlayObj.insertOverlayElement(id, range, sheetIndex);\n        element.style.backgroundImage = 'url(\\'' + args.options.src + '\\')';\n        if (args.options.height || args.options.left) {\n            element.style.height = args.options.height + 'px';\n            element.style.width = args.options.width + 'px';\n            element.style.top = args.options.top + 'px';\n            element.style.left = args.options.left + 'px';\n        }\n        if (!args.options.imageId) {\n            this.pictureCount++;\n        }\n        var imgData = {\n            src: args.options.src, id: id, height: parseFloat(element.style.height.replace('px', '')),\n            width: parseFloat(element.style.width.replace('px', '')), top: parseFloat(element.style.top.replace('px', '')),\n            left: parseFloat(element.style.left.replace('px', ''))\n        };\n        this.parent.setUsedRange(indexes[0], indexes[1]);\n        if (args.isPublic || args.isUndoRedo) {\n            this.parent.notify(setImage, { options: [imgData], range: sheet.name + '!' + range });\n        }\n        var currCell = getCell(indexes[0], indexes[1], sheet);\n        if (!currCell.image[currCell.image.length - 1].id) {\n            currCell.image[currCell.image.length - 1].id = imgData.id;\n        }\n        eventArgs = {\n            requestType: 'insertImage', range: sheet.name + '!' + range, imageHeight: args.options.height ? args.options.height : 300,\n            imageWidth: args.options.width ? args.options.width : 400, imageData: args.options.src, id: id, sheetIndex: sheetIndex\n        };\n        if (!args.isUndoRedo && args.isPublic) {\n            this.parent.notify('actionComplete', { eventArgs: eventArgs, action: 'insertImage' });\n        }\n    };\n    SpreadsheetImage.prototype.refreshImgElem = function () {\n        var overlayElem = document.getElementsByClassName('e-ss-overlay-active')[0];\n        if (overlayElem) {\n            removeClass([overlayElem], 'e-ss-overlay-active');\n        }\n    };\n    SpreadsheetImage.prototype.refreshInsDelImagePosition = function (args) {\n        var count = args.count;\n        var sheetIdx = args.sheetIdx;\n        var sheet = this.parent.sheets[sheetIdx];\n        var pictureElements;\n        var currCellObj = getCell(args.rowIdx, args.colIdx, sheet);\n        var imageLen = currCellObj.image.length;\n        var top;\n        var left;\n        for (var i = 0; i < imageLen; i++) {\n            pictureElements = document.getElementById(currCellObj.image[i].id);\n            top = (args.type === 'Row') ? (args.status === 'insert') ? currCellObj.image[i].top + (count * 20) :\n                currCellObj.image[i].top - (count * 20) : currCellObj.image[i].top;\n            left = (args.type === 'Column') ? (args.status === 'insert') ? currCellObj.image[i].left + (count * 64) :\n                currCellObj.image[i].left - (count * 64) : currCellObj.image[i].left;\n            currCellObj.image[i].top = top;\n            currCellObj.image[i].left = left;\n            pictureElements.style.top = top + 'px';\n            pictureElements.style.left = left + 'px';\n        }\n    };\n    SpreadsheetImage.prototype.refreshImgCellObj = function (args) {\n        var prevRowIdx = { clientY: args.prevTop, isImage: true };\n        this.parent.notify(getRowIdxFromClientY, prevRowIdx);\n        var currRowIdx = { clientY: args.currentTop, isImage: true };\n        this.parent.notify(getRowIdxFromClientY, currRowIdx);\n        var prevColIdx = { clientX: args.prevLeft, isImage: true };\n        this.parent.notify(getColIdxFromClientX, prevColIdx);\n        var currColIdx = { clientX: args.currentLeft, isImage: true };\n        this.parent.notify(getColIdxFromClientX, currColIdx);\n        var sheet = this.parent.sheets[this.parent.activeSheetIndex];\n        var prevCellObj = getCell(prevRowIdx.clientY, prevColIdx.clientX, sheet);\n        var currCellObj = getCell(currRowIdx.clientY, currColIdx.clientX, sheet);\n        var prevCellImg = prevCellObj ? prevCellObj.image : [];\n        var prevImgObj;\n        var currImgObj;\n        var prevCellImgLen = (prevCellImg && prevCellImg.length) ? prevCellImg.length : 0;\n        if (prevCellObj && prevCellObj.image && prevCellImg.length > 0) {\n            for (var i = 0; i < prevCellImgLen; i++) {\n                if (prevCellImg[i].id === args.id) {\n                    prevImgObj = prevCellImg[i];\n                    prevImgObj.height = args.currentHeight;\n                    prevImgObj.width = args.currentWidth;\n                    prevImgObj.top = args.currentTop;\n                    prevImgObj.left = args.currentLeft;\n                    prevCellImg.splice(i, 1);\n                }\n            }\n            if (currCellObj && currCellObj.image) {\n                currImgObj = currCellObj.image;\n                if (prevImgObj) {\n                    currImgObj.push(prevImgObj);\n                }\n            }\n            (currImgObj) ? setCell(currRowIdx.clientY, currColIdx.clientX, sheet, { image: currImgObj }, true) :\n                setCell(currRowIdx.clientY, currColIdx.clientX, sheet, { image: [prevImgObj] }, true);\n            if (args.requestType === 'imageRefresh' && !args.isUndoRedo) {\n                var eventArgs = {\n                    requestType: 'imageRefresh', currentRowIdx: currRowIdx.clientY, currentColIdx: currColIdx.clientX,\n                    prevRowIdx: prevRowIdx.clientY, prevColIdx: prevColIdx.clientX, prevTop: args.prevTop, prevLeft: args.prevLeft,\n                    currentTop: args.currentTop, currentLeft: args.currentLeft, currentHeight: args.currentHeight,\n                    currentWidth: args.currentWidth, prevHeight: args.prevHeight, prevWidth: args.prevWidth,\n                    id: args.id, sheetIdx: this.parent.activeSheetIndex\n                };\n                this.parent.notify('actionComplete', { eventArgs: eventArgs, action: 'imageRefresh' });\n            }\n        }\n    };\n    SpreadsheetImage.prototype.deleteImage = function (args) {\n        var sheet;\n        var pictureElements = document.getElementById(args.id);\n        var rowIdx;\n        var colIdx;\n        var cellObj;\n        var prevCellImg;\n        var imgLength;\n        if (pictureElements) {\n            var imgTop = { clientY: pictureElements.offsetTop, isImage: true };\n            this.parent.notify(getRowIdxFromClientY, imgTop);\n            var imgleft = { clientX: pictureElements.offsetLeft, isImage: true };\n            this.parent.notify(getColIdxFromClientX, imgleft);\n            document.getElementById(args.id).remove();\n            rowIdx = imgTop.clientY;\n            colIdx = imgleft.clientX;\n            sheet = this.parent.sheets[this.parent.activeSheetIndex];\n        }\n        else {\n            var rangeVal = args.range ? args.range.indexOf('!') > 0 ? args.range.split('!')[1] : args.range.split('!')[0] :\n                this.parent.getActiveSheet().selectedRange;\n            var sheetIndex = args.range && args.range.indexOf('!') > 0 ? getSheetIndex(this.parent, args.range.split('!')[0]) :\n                this.parent.activeSheetIndex;\n            var index = getRangeIndexes(rangeVal);\n            rowIdx = index[0];\n            colIdx = index[1];\n            sheet = this.parent.sheets[sheetIndex];\n        }\n        cellObj = getCell(rowIdx, colIdx, sheet);\n        prevCellImg = cellObj.image;\n        imgLength = prevCellImg.length;\n        for (var i = 0; i < imgLength; i++) {\n            if (prevCellImg[i].id === args.id) {\n                prevCellImg.splice(i, 1);\n            }\n        }\n        setCell(rowIdx, colIdx, sheet, { image: prevCellImg }, true);\n    };\n    /**\n     * To Remove the event listeners.\n     */\n    SpreadsheetImage.prototype.destroy = function () {\n        this.removeEventListener();\n        this.parent = null;\n    };\n    /**\n     * Get the sheet picture module name.\n     */\n    SpreadsheetImage.prototype.getModuleName = function () {\n        return 'spreadsheetImage';\n    };\n    return SpreadsheetImage;\n}());\nexport { SpreadsheetImage };\n","import { getSheetIndex, isHiddenRow, getCell, setCell } from '../../workbook/base/index';\nimport { initiateChart, getRangeIndexes, isNumber, isDateTime, dateToInt } from '../../workbook/common/index';\nimport { overlay, locale, refreshChartCellObj, getRowIdxFromClientY, getColIdxFromClientX, deleteChart } from '../common/index';\nimport { beginAction, completeAction, clearChartBorder, focusBorder } from '../common/index';\nimport { Chart, ColumnSeries, Category, StackingColumnSeries, BarSeries } from '@syncfusion/ej2-charts';\nimport { AreaSeries, StackingAreaSeries, AccumulationChart } from '@syncfusion/ej2-charts';\nimport { Legend, StackingBarSeries, LineSeries, StackingLineSeries, ScatterSeries } from '@syncfusion/ej2-charts';\nimport { AccumulationLegend, PieSeries, AccumulationTooltip, AccumulationDataLabel } from '@syncfusion/ej2-charts';\nimport { isNullOrUndefined, getComponent, closest, detach } from '@syncfusion/ej2-base';\nimport { Tooltip } from '@syncfusion/ej2-popups';\nimport { getTypeFromFormat } from '../../workbook/integrations/index';\nimport { updateChart, deleteChartColl, getFormattedCellObject, setChart, getCellAddress } from '../../workbook/common/index';\nimport { insertChart, chartRangeSelection } from '../common/index';\nChart.Inject(ColumnSeries, LineSeries, BarSeries, AreaSeries, StackingColumnSeries, StackingLineSeries, StackingBarSeries, ScatterSeries);\nChart.Inject(StackingAreaSeries, Category, Legend, Tooltip);\nAccumulationChart.Inject(PieSeries, AccumulationTooltip, AccumulationDataLabel, AccumulationLegend);\n/**\n * Represents Chart support for Spreadsheet.\n */\nvar SpreadsheetChart = /** @class */ (function () {\n    /**\n     * Constructor for the Spreadsheet Chart module.\n     */\n    function SpreadsheetChart(parent) {\n        this.parent = parent;\n        this.addEventListener();\n    }\n    /**\n     * Adding event listener for success and failure\n     */\n    SpreadsheetChart.prototype.addEventListener = function () {\n        this.parent.on(initiateChart, this.initiateChartHandler, this);\n        this.parent.on(refreshChartCellObj, this.refreshChartCellObj, this);\n        this.parent.on(updateChart, this.updateChartHandler, this);\n        this.parent.on(deleteChart, this.deleteChart, this);\n        this.parent.on(clearChartBorder, this.clearBorder, this);\n        this.parent.on(insertChart, this.insertChartHandler, this);\n        this.parent.on(chartRangeSelection, this.chartRangeHandler, this);\n    };\n    SpreadsheetChart.prototype.insertChartHandler = function (args) {\n        var chartType = 'Column';\n        switch (args.id) {\n            case 'clusteredColumn':\n                chartType = 'Column';\n                break;\n            case 'stackedColumn':\n                chartType = 'StackingColumn';\n                break;\n            case 'stackedColumn100':\n                chartType = 'StackingColumn100';\n                break;\n            case 'clusteredBar':\n                chartType = 'Bar';\n                break;\n            case 'stackedBar':\n                chartType = 'StackingBar';\n                break;\n            case 'stackedBar100':\n                chartType = 'StackingBar100';\n                break;\n            case 'area':\n                chartType = 'Area';\n                break;\n            case 'stackedArea':\n                chartType = 'StackingArea';\n                break;\n            case 'stackedArea100':\n                chartType = 'StackingArea100';\n                break;\n            case 'line':\n                chartType = 'Line';\n                break;\n            case 'stackedLine':\n                chartType = 'StackingLine';\n                break;\n            case 'stackedLine100':\n                chartType = 'StackingLine100';\n                break;\n            case 'pie':\n                chartType = 'Pie';\n                break;\n            case 'doughnut':\n                chartType = 'Doughnut';\n                break;\n            //  case 'radar':\n            //     chartType = ;\n            //     break;\n            //  case 'radar_markers':\n            //     chartType = 'Column';\n            //     break;\n            case 'scatter':\n                chartType = 'Scatter';\n                break;\n        }\n        var chart = [{ type: chartType }];\n        this.parent.notify(setChart, { chart: chart });\n    };\n    SpreadsheetChart.prototype.chartRangeHandler = function () {\n        var overlayEle = document.querySelector('.e-datavisualization-chart.e-ss-overlay-active');\n        if (overlayEle) {\n            var chartId = overlayEle.getElementsByClassName('e-control')[0].id;\n            var chartColl = this.parent.chartColl;\n            var chartCollLen = chartColl.length;\n            for (var idx = 0; idx < chartCollLen; idx++) {\n                var chartEle = document.getElementById(chartColl[idx].id);\n                if (overlayEle && chartEle && chartColl[idx].id === chartId) {\n                    this.parent.notify(initiateChart, {\n                        option: chartColl[idx], chartCount: this.parent.chartCount, isRefresh: true\n                    });\n                }\n            }\n        }\n    };\n    SpreadsheetChart.prototype.getPropertyValue = function (rIdx, cIdx, sheetIndex) {\n        var sheets = this.parent.sheets;\n        if (sheets[sheetIndex] && sheets[sheetIndex].rows[rIdx] && sheets[sheetIndex].rows[rIdx].cells[cIdx]) {\n            var cell = getCell(rIdx, cIdx, this.parent.sheets[sheetIndex]);\n            var value = '';\n            if (cell.format) {\n                var formatObj = {\n                    type: getTypeFromFormat(cell.format),\n                    value: cell && cell.value, format: cell && cell.format ?\n                        cell.format : 'General', formattedText: cell && cell.value,\n                    onLoad: true, isRightAlign: false, cell: cell,\n                    rowIdx: rIdx.toString(), colIdx: cIdx.toString()\n                };\n                if (cell) {\n                    this.parent.notify(getFormattedCellObject, formatObj);\n                    if (typeof (formatObj.value) === 'number') {\n                        var escapeRegx = new RegExp('[!@#$%^&()+=\\';,{}|\\\":<>~_-]', 'g');\n                        formatObj.formattedText = (formatObj.formattedText.toString()).replace(escapeRegx, '');\n                        value = parseInt(formatObj.formattedText.toString(), 10);\n                    }\n                    else {\n                        value = formatObj.formattedText.toString();\n                        parseFloat('');\n                    }\n                }\n            }\n            else {\n                value = this.parent.sheets[sheetIndex].rows[rIdx].cells[cIdx].value;\n            }\n            return value;\n        }\n        else {\n            return '';\n        }\n    };\n    SpreadsheetChart.prototype.updateChartHandler = function (args) {\n        var series = this.initiateChartHandler({ option: args.chart, isRefresh: true });\n        var chartObj = this.parent.element.querySelector('.' + args.chart.id);\n        if (chartObj) {\n            var chartComp = getComponent(chartObj, 'chart');\n            chartComp.series = series;\n        }\n    };\n    SpreadsheetChart.prototype.refreshChartCellObj = function (args) {\n        var currRowIdx = { clientY: args.currentTop, isImage: true };\n        this.parent.notify(getRowIdxFromClientY, currRowIdx);\n        var prevRowIdx = { clientY: args.prevTop, isImage: true };\n        this.parent.notify(getRowIdxFromClientY, prevRowIdx);\n        var currColIdx = { clientX: args.currentLeft, isImage: true };\n        this.parent.notify(getColIdxFromClientX, currColIdx);\n        var prevColIdx = { clientX: args.prevLeft, isImage: true };\n        this.parent.notify(getColIdxFromClientX, prevColIdx);\n        var sheet = this.parent.sheets[this.parent.activeSheetIndex];\n        var prevCellObj = getCell(prevRowIdx.clientY, prevColIdx.clientX, sheet);\n        var currCellObj = getCell(currRowIdx.clientY, currColIdx.clientX, sheet);\n        var prevCellChart = prevCellObj ? prevCellObj.chart : [];\n        var prevChartObj;\n        var currChartObj;\n        var prevCellImgLen = (prevCellChart && prevCellChart.length) ? prevCellChart.length : 0;\n        if (prevCellObj && prevCellObj.chart) {\n            for (var i = 0; i < prevCellImgLen; i++) {\n                var overlayEle = document.getElementById(args.id);\n                var chartEleClassName = document.getElementById(prevCellChart[i].id);\n                if (closest(chartEleClassName, '.' + overlayEle.classList[1]) === overlayEle) {\n                    prevChartObj = prevCellChart[i];\n                    prevChartObj.height = args.currentHeight;\n                    prevChartObj.width = args.currentWidth;\n                    prevChartObj.top = args.currentTop;\n                    prevChartObj.left = args.currentLeft;\n                    prevCellChart.splice(i, 1);\n                }\n            }\n            if (currCellObj && currCellObj.chart) {\n                currChartObj = currCellObj.chart;\n                if (prevChartObj) {\n                    currChartObj.push(prevChartObj);\n                }\n            }\n            (currChartObj) ? setCell(currRowIdx.clientY, currColIdx.clientX, sheet, { chart: currChartObj }, true) :\n                setCell(currRowIdx.clientY, currColIdx.clientX, sheet, { chart: [prevChartObj] }, true);\n            if (args.requestType === 'chartRefresh' && !args.isUndoRedo) {\n                var eventArgs = {\n                    requestType: 'chartRefresh', currentRowIdx: currRowIdx.clientY, currentColIdx: currColIdx.clientX,\n                    currentWidth: args.currentWidth, prevHeight: args.prevHeight, prevWidth: args.prevWidth,\n                    prevRowIdx: prevRowIdx.clientY, prevColIdx: prevColIdx.clientX, prevTop: args.prevTop, prevLeft: args.prevLeft,\n                    currentTop: args.currentTop, currentLeft: args.currentLeft, currentHeight: args.currentHeight,\n                    id: args.id, sheetIdx: this.parent.activeSheetIndex\n                };\n                this.parent.notify('actionComplete', { eventArgs: eventArgs, action: 'chartRefresh' });\n            }\n        }\n    };\n    SpreadsheetChart.prototype.processChartRange = function (range, dataSheetIdx, opt) {\n        var xRange;\n        var yRange;\n        var lRange;\n        var trVal;\n        var blVal;\n        var tlVal;\n        var minr = range[0];\n        var minc = range[1];\n        var isStringSeries = false;\n        var maxr = range[2];\n        var maxc = range[3];\n        var isSingleRow = minr === maxr;\n        var isSingleCol = minc === maxc;\n        trVal = this.getPropertyValue(minr, maxc, dataSheetIdx);\n        // trVal = this.getParseValue(trVal);\n        blVal = this.getPropertyValue(maxr, minc, dataSheetIdx);\n        // blVal = this.getParseValue(blVal);\n        tlVal = this.getPropertyValue(minr, minc, dataSheetIdx);\n        // tlVal = this.getParseValue(tlVal);\n        if (!isNumber(blVal) || !tlVal) {\n            isStringSeries = true;\n        }\n        if (isNullOrUndefined(tlVal) && !isSingleRow && !isSingleCol || (opt.type === 'Scatter' && range[3] - range[1] === 1)) {\n            xRange = [minr + 1, minc, maxr, minc];\n            yRange = [minr + 1, minc + 1, maxr, maxc];\n            lRange = [minr, minc + 1, minr, maxc];\n        }\n        else if ((!isNullOrUndefined(blVal) && isStringSeries && !isSingleRow && !isSingleCol)) {\n            if (!isNullOrUndefined(trVal) && (!isNumber(trVal) || !tlVal)) {\n                xRange = [minr + 1, minc, maxr, minc];\n                yRange = [minr + 1, minc + 1, maxr, maxc];\n                lRange = [minr, minc + 1, minr, maxc];\n            }\n            else {\n                xRange = [minr, minc, maxr, minc];\n                yRange = [minr, minc + 1, maxr, maxc];\n            }\n        }\n        else {\n            yRange = [minr, minc, maxr, maxc];\n            if ((!isNullOrUndefined(trVal) && !isNumber(trVal) && !isDateTime(trVal))) {\n                lRange = [minr, minc, minr, maxc];\n                yRange[0] = yRange[0] + 1;\n            }\n            else if (isNullOrUndefined(tlVal) && (isSingleRow || isSingleCol)) {\n                lRange = [minr, minc, minr, maxc];\n                if (isSingleRow) {\n                    yRange[1] = yRange[1] + 1;\n                    lRange[3] = lRange[1];\n                }\n                else {\n                    yRange[0] = yRange[0] + 1;\n                }\n            }\n        }\n        return { xRange: xRange, yRange: yRange, lRange: lRange };\n    };\n    SpreadsheetChart.prototype.toIntrnlRange = function (range, sheetIdx) {\n        if (!range) {\n            range = getRangeIndexes[this.parent.sheets[sheetIdx].selectedRange];\n        }\n        else if (typeof (range) === 'string') {\n            range = getRangeIndexes[range];\n        }\n        return range;\n    };\n    SpreadsheetChart.prototype.getRangeData = function (options) {\n        options.sheetIdx = isNullOrUndefined(options.sheetIdx) ? this.parent.getActiveSheet().index : options.sheetIdx;\n        var sheet = this.parent.sheets[options.sheetIdx];\n        options.range = this.toIntrnlRange(options.range, options.sheetIdx);\n        var minc;\n        var minr;\n        var maxr;\n        var maxc;\n        var skipVirtualHiddenRow;\n        var isRowHidden;\n        var rowIdx = [];\n        var arr = [];\n        skipVirtualHiddenRow = false;\n        minr = options.range[0];\n        maxr = options.range[2];\n        maxc = options.range[3];\n        isRowHidden = isHiddenRow(sheet, minr);\n        if (skipVirtualHiddenRow && isRowHidden) {\n            maxr++;\n        }\n        else if (!isRowHidden) {\n            minc = skipVirtualHiddenRow ? 0 : options.range[1];\n            this.pushRowData(options, minr, minc, maxr, maxc, arr, rowIdx, true, options.isYvalue);\n        }\n        return arr;\n    };\n    SpreadsheetChart.prototype.pushRowData = function (options, minr, minc, maxr, maxc, arr, rowIdx, isDataSrcEnsured, isYvalue) {\n        var minCol = minc;\n        while (minr <= maxr) {\n            minc = minCol;\n            while (minc <= maxc) {\n                var value = '';\n                var cell = getCell(minr, minc, this.parent.getActiveSheet());\n                if (cell && cell.format && !isYvalue) {\n                    var forArgs = {\n                        value: cell && cell.value, format: cell && cell.format ? cell.format : 'General',\n                        formattedText: cell && cell.value, onLoad: true,\n                        type: cell && getTypeFromFormat(cell.format),\n                        rowIdx: minr.toString(), colIdx: minc.toString(),\n                        isRightAlign: false, cell: cell,\n                    };\n                    this.parent.notify(getFormattedCellObject, forArgs);\n                    value = forArgs.formattedText.toString();\n                }\n                else {\n                    value = this.parent.getValueRowCol(options.sheetIdx, minr + 1, minc + 1);\n                }\n                // = this.parent.getValueRowCol(options.sheetIdx, minr + 1, minc + 1);\n                arr.push({ value: value });\n                minc++;\n            }\n            minr++;\n        }\n        rowIdx.push(minr);\n    };\n    SpreadsheetChart.prototype.toArrayData = function (args) {\n        var prop = 'value';\n        var obj;\n        var i = 0;\n        var temp = [];\n        var len = args.length;\n        while (i < len) {\n            obj = args[i];\n            if (Object.keys(obj).length) {\n                if (prop in obj) {\n                    temp.push(obj[prop]);\n                }\n            }\n            else {\n                temp.push('');\n            }\n            i++;\n        }\n        return temp;\n    };\n    SpreadsheetChart.prototype.getVirtualXValues = function (limit) {\n        var i = 1;\n        var arr = [];\n        while (i < limit) {\n            arr.push(i.toString());\n            i++;\n        }\n        return arr;\n    };\n    // tslint:disable-next-line:max-func-body-length\n    SpreadsheetChart.prototype.processChartSeries = function (options, sheetIndex, xRange, yRange, lRange) {\n        options = options || {};\n        var seriesName = '';\n        var val;\n        var len;\n        var xValue;\n        var yValue;\n        var lValue;\n        var diff;\n        var pArr;\n        var pObj = {};\n        var j;\n        var inc;\n        var i = 0;\n        var yInc = 0;\n        var sArr = [];\n        var tArr = ['value2'];\n        var dtVal;\n        yValue = this.getRangeData({ range: yRange, sheetIdx: sheetIndex, skipFormula: true, isYvalue: true });\n        var rDiff = (yRange[2] - yRange[0]) + 1;\n        var cDiff = (yRange[3] - yRange[1]) + 1;\n        if (options.isSeriesInRows) {\n            xValue = lRange ? this.toArrayData(this.getRangeData({ range: lRange, sheetIdx: sheetIndex, skipFormula: false, isYvalue: false })) :\n                this.getVirtualXValues(cDiff + 1);\n            if (xRange) {\n                lValue = this.toArrayData(this.getRangeData({ range: xRange, sheetIdx: sheetIndex, skipFormula: false, isYvalue: false }));\n            }\n            diff = rDiff;\n        }\n        else {\n            xValue = xRange ? this.toArrayData(this.getRangeData({ range: xRange, sheetIdx: sheetIndex, skipFormula: false, isYvalue: false })) :\n                this.getVirtualXValues(rDiff + 1);\n            if (lRange) {\n                lValue = this.toArrayData(this.getRangeData({ range: lRange, sheetIdx: sheetIndex, skipFormula: false, isYvalue: false }));\n            }\n            diff = cDiff;\n        }\n        len = xValue.length;\n        inc = options.isSeriesInRows ? 1 : diff;\n        while (i < diff) {\n            j = 0;\n            pArr = [];\n            yInc = options.isSeriesInRows ? yInc : i;\n            while (j < len) {\n                if (yValue[yInc]) {\n                    val = yValue[yInc].value;\n                    if (isNumber(val)) {\n                        val = Number(val);\n                    }\n                    else {\n                        dtVal = dateToInt(val);\n                        val = isNaN(dtVal) ? 0 : dtVal;\n                    }\n                    pArr.push({ x: xValue[j], y: val });\n                }\n                yInc += inc;\n                j++;\n            }\n            if (lValue && lValue.length > 0) {\n                seriesName = lValue[i];\n            }\n            else {\n                seriesName = 'series' + i;\n            }\n            if (options.type) {\n                var type = options.type;\n                if (type === 'Line' || type === 'StackingLine' || type === 'StackingLine100') {\n                    pObj = {\n                        dataSource: pArr, type: options.type, xName: 'x', yName: 'y', name: seriesName.toString(), marker: {\n                            visible: true,\n                            width: 10,\n                            height: 10\n                        }\n                    };\n                }\n                else if (type === 'Scatter') {\n                    pObj = {\n                        dataSource: pArr, type: options.type, xName: 'x', yName: 'y', name: seriesName.toString(), marker: {\n                            visible: false,\n                            width: 12,\n                            height: 12,\n                            shape: 'Circle'\n                        }\n                    };\n                }\n                else if (type === 'Pie' || type === 'Doughnut') {\n                    var innerRadius = options.type === 'Pie' ? '0%' : '40%';\n                    pObj = {\n                        dataSource: pArr,\n                        dataLabel: {\n                            visible: true, position: 'Inside', name: 'text', font: { fontWeight: '600' }\n                        },\n                        radius: '100%', xName: 'x', yName: 'y', startAngle: 0, endAngle: 360, innerRadius: innerRadius, explode: true,\n                        explodeOffset: '10%', explodeIndex: 0, name: 'Browser'\n                    };\n                }\n                else {\n                    pObj = { dataSource: pArr, type: options.type, xName: 'x', yName: 'y', name: seriesName.toString() };\n                }\n            }\n            sArr.push(pObj);\n            i++;\n        }\n        var retVal;\n        if (options.type) {\n            var type = options.type;\n            retVal = {\n                series: sArr, xRange: options.isSeriesInRows ? lRange : xRange,\n                yRange: yRange, lRange: options.isSeriesInRows ? xRange : lRange\n            };\n        }\n        return retVal;\n    };\n    SpreadsheetChart.prototype.primaryYAxisFormat = function (yRange) {\n        if (isNullOrUndefined(yRange)) {\n            return '{value}';\n        }\n        var type;\n        var cell = getCell(yRange[0], yRange[1], this.parent.getActiveSheet());\n        if (cell && cell.format) {\n            type = getTypeFromFormat(cell.format);\n            if (type === 'Accounting') {\n                return '${value}';\n            }\n            else if (type === 'Currency') {\n                return '${value}';\n            }\n            else if (type === 'Percentage') {\n                return '{value}%';\n            }\n        }\n        return '{value}';\n    };\n    SpreadsheetChart.prototype.focusChartRange = function (xRange, yRange, lRange) {\n        var border = ['e-rcborderright', 'e-rcborderbottom', 'e-vcborderright', 'e-vcborderbottom', 'e-bcborderright', 'e-bcborderbottom'];\n        this.clearBorder();\n        if (lRange) {\n            this.parent.notify(focusBorder, {\n                startcell: { rowIndex: lRange[0], colIndex: lRange[1] },\n                endcell: { rowIndex: lRange[2], colIndex: lRange[3] }, classes: [border[0], border[1]]\n            });\n        }\n        if (xRange) {\n            this.parent.notify(focusBorder, {\n                startcell: { rowIndex: xRange[0], colIndex: xRange[1] },\n                endcell: { rowIndex: xRange[2], colIndex: xRange[3] }, classes: [border[2], border[3]]\n            });\n        }\n        this.parent.notify(focusBorder, {\n            startcell: { rowIndex: yRange[0], colIndex: yRange[1] },\n            endcell: { rowIndex: yRange[2], colIndex: yRange[3] }, classes: [border[4], border[5]]\n        });\n    };\n    SpreadsheetChart.prototype.clearBorder = function () {\n        var mainCont = this.parent.getMainContent();\n        var border = ['e-rcborderright', 'e-rcborderbottom', 'e-vcborderright', 'e-vcborderbottom', 'e-bcborderright', 'e-bcborderbottom'];\n        for (var borderIdx = 0; borderIdx < border.length; borderIdx++) {\n            var eleColl = mainCont.querySelectorAll('.' + border[borderIdx]);\n            for (var tdIdx = 0; tdIdx < eleColl.length; tdIdx++) {\n                var td = eleColl[tdIdx];\n                td.classList.remove(border[borderIdx]);\n            }\n        }\n    };\n    // tslint:disable-next-line:max-func-body-length\n    SpreadsheetChart.prototype.initiateChartHandler = function (argsOpt) {\n        var isRangeSelect = true;\n        isRangeSelect = isNullOrUndefined(argsOpt.isInitCell) ? true : !argsOpt.isInitCell;\n        var l10n = this.parent.serviceLocator.getService(locale);\n        argsOpt.isUndoRedo = isNullOrUndefined(argsOpt.isUndoRedo) ? true : argsOpt.isUndoRedo;\n        var seriesModel;\n        argsOpt.isRefresh = isNullOrUndefined(argsOpt.isRefresh) ? false : argsOpt.isRefresh;\n        var sheet = this.parent.getActiveSheet();\n        var range = argsOpt.option.range ? (argsOpt.option.range.indexOf('!') > 0) ?\n            argsOpt.option.range.split('!')[1] : argsOpt.option.range.split('!')[0]\n            : this.parent.getActiveSheet().selectedRange;\n        var rangeIdx = getRangeIndexes(range);\n        var top;\n        var left;\n        var position;\n        var options = {};\n        var isRowLesser;\n        var xRange;\n        var yRange;\n        var lRange;\n        var eventArgs;\n        if (!this.parent.allowChart && sheet.isProtected) {\n            return seriesModel;\n        }\n        var sheetIdx = (argsOpt.option.range && argsOpt.option.range.indexOf('!') > 0) ?\n            getSheetIndex(this.parent, argsOpt.option.range.split('!')[0]) : this.parent.activeSheetIndex;\n        var args = {\n            sheetIndex: sheetIdx, reqType: 'shape', type: 'actionBegin', shapeType: 'chart',\n            action: 'create', options: argsOpt.option, range: range, operation: 'create',\n        };\n        options = args.options;\n        range = args.range;\n        options = options || {};\n        var chartOptions;\n        var chartRange;\n        var type = 'chart';\n        if (rangeIdx.length > 0) {\n            var rDiff = rangeIdx[2] - rangeIdx[0];\n            var cDiff = rangeIdx[3] - rangeIdx[1];\n            if (rDiff < cDiff) {\n                isRowLesser = true;\n            }\n        }\n        options.isSeriesInRows = isRowLesser ? true : options.isSeriesInRows ? options.isSeriesInRows : false;\n        argsOpt.dataSheetIdx = isNullOrUndefined(argsOpt.dataSheetIdx) ? sheetIdx : argsOpt.dataSheetIdx;\n        chartRange = this.processChartRange(rangeIdx, argsOpt.dataSheetIdx, options);\n        xRange = chartRange.xRange;\n        yRange = chartRange.yRange;\n        lRange = chartRange.lRange;\n        if (sheetIdx === this.parent.activeSheetIndex && isRangeSelect) {\n            this.focusChartRange(xRange, yRange, lRange);\n        }\n        chartOptions = this.processChartSeries(options, argsOpt.dataSheetIdx, xRange, yRange, lRange);\n        var primaryXAxis = {\n            majorGridLines: { width: 0 },\n            minorGridLines: { width: 0 },\n            majorTickLines: { width: 0 },\n            minorTickLines: { width: 0 },\n            lineStyle: { width: 0 },\n            valueType: 'Category'\n        };\n        var primaryYAxis = {\n            lineStyle: { width: 0 },\n            majorTickLines: { width: 0 },\n            majorGridLines: { width: 1 },\n            minorGridLines: { width: 1 },\n            minorTickLines: { width: 0 },\n            labelFormat: this.primaryYAxisFormat(yRange)\n        };\n        if (argsOpt.isRefresh) {\n            return chartOptions.series;\n        }\n        if (argsOpt.isUndoRedo) {\n            eventArgs = {\n                type: argsOpt.option.type, theme: argsOpt.option.theme, isSeriesInRows: argsOpt.option.isSeriesInRows,\n                range: argsOpt.option.range, height: argsOpt.option.height, width: argsOpt.option.width, id: argsOpt.option.id,\n                posRange: argsOpt.range, isInitCell: argsOpt.isInitCell, cancel: false\n            };\n            this.parent.notify(beginAction, { eventArgs: eventArgs, action: 'beforeInsertChart' });\n            if (eventArgs.cancel) {\n                return [];\n            }\n            argsOpt.option.type = eventArgs.type;\n            argsOpt.option.theme = eventArgs.theme;\n            argsOpt.option.isSeriesInRows = eventArgs.isSeriesInRows;\n            argsOpt.option.range = eventArgs.range;\n            argsOpt.option.id = eventArgs.id;\n            argsOpt.option.height = eventArgs.height;\n            argsOpt.option.width = eventArgs.width;\n        }\n        var id = argsOpt.option.id + '_overlay';\n        var sheetIndex = (argsOpt.option.range && argsOpt.option.range.indexOf('!') > 0) ?\n            getSheetIndex(this.parent, argsOpt.option.range.split('!')[0]) : this.parent.activeSheetIndex;\n        var overlayObj = this.parent.serviceLocator.getService(overlay);\n        var eleRange = !isNullOrUndefined(argsOpt.isInitCell) && argsOpt.isInitCell ? argsOpt.range : range;\n        var element = overlayObj.insertOverlayElement(id, eleRange, sheetIndex);\n        element.classList.add('e-datavisualization-chart');\n        element.style.width = argsOpt.option.width + 'px';\n        element.style.height = argsOpt.option.height + 'px';\n        element.style.top = isNullOrUndefined(argsOpt.option.top) ? element.style.top : (argsOpt.option.top + 'px');\n        element.style.left = isNullOrUndefined(argsOpt.option.left) ? element.style.left : (argsOpt.option.left + 'px');\n        argsOpt.option.top = parseInt(element.style.top.replace('px', ''), 10);\n        argsOpt.option.left = parseInt(element.style.left.replace('px', ''), 10);\n        var chartContent = this.parent.createElement('div', {\n            id: argsOpt.option.id, className: argsOpt.option.id\n        });\n        if (argsOpt.option.type !== 'Pie' && argsOpt.option.type !== 'Doughnut') {\n            this.chart = new Chart({\n                primaryXAxis: primaryXAxis,\n                primaryYAxis: primaryYAxis,\n                chartArea: {\n                    border: {\n                        width: 0\n                    }\n                },\n                series: chartOptions.series,\n                tooltip: {\n                    enable: true\n                },\n                width: element.style.width,\n                height: element.style.height,\n                load: function (args) {\n                    var selectedTheme = argsOpt.option.theme;\n                    selectedTheme = selectedTheme ? selectedTheme : 'Material';\n                    args.chart.theme = (selectedTheme.charAt(0).toUpperCase() +\n                        selectedTheme.slice(1)).replace(/-dark/i, 'Dark').replace(/contrast/i, 'Contrast');\n                },\n                beforeResize: function (args) {\n                    args.cancelResizedEvent = true; // This is for cancel the resized event.\n                }\n            });\n            this.chart.appendTo(chartContent);\n        }\n        else {\n            this.chart = new AccumulationChart({\n                series: chartOptions.series,\n                width: element.style.width,\n                height: element.style.height,\n                center: { x: '50%', y: '50%' },\n                enableSmartLabels: true,\n                enableAnimation: true,\n                legendSettings: { visible: true, position: 'Bottom' },\n                load: function (args) {\n                    var selectedTheme = location.hash.split('/')[1];\n                    selectedTheme = selectedTheme ? selectedTheme : 'Material';\n                    args.accumulation.theme = (selectedTheme.charAt(0).toUpperCase() +\n                        selectedTheme.slice(1)).replace(/-dark/i, 'Dark').replace(/contrast/i, 'Contrast');\n                }\n            });\n            this.chart.appendTo(chartContent);\n        }\n        element.appendChild(chartContent);\n        if (argsOpt.isUndoRedo) {\n            this.parent.notify(completeAction, { eventArgs: eventArgs, action: 'insertChart' });\n        }\n        return seriesModel;\n    };\n    SpreadsheetChart.prototype.deleteChart = function (args) {\n        this.clearBorder();\n        var chartElements = null;\n        var sheet;\n        if (isNullOrUndefined(args.id)) {\n            chartElements = document.querySelector('.e-datavisualization-chart.e-ss-overlay-active');\n            args.id = chartElements ? chartElements.getElementsByClassName('e-control')[0].id : null;\n        }\n        else {\n            args.id = args.id.includes('overlay') ? args.id : args.id + '_overlay';\n            chartElements = document.getElementById(args.id);\n        }\n        if (isNullOrUndefined(args.id) || isNullOrUndefined(chartElements)) {\n            return;\n        }\n        else {\n            args.id = args.id.includes('overlay') ? args.id : args.id + '_overlay';\n        }\n        var rowIdx;\n        var colIdx;\n        var cellObj;\n        var prevCellChart;\n        var chartLength;\n        var isRemoveEle = false;\n        var chartObj;\n        for (var i = 0; i < this.parent.chartColl.length; i++) {\n            if (this.parent.chartColl[i].id === args.id.split('_overlay')[0]) {\n                chartObj = this.parent.chartColl[i];\n                break;\n            }\n        }\n        var eventArgs = {\n            id: chartObj.id, range: chartObj.range, type: chartObj.type, theme: chartObj.theme, height: chartObj.height,\n            width: chartObj.width, isSeriesInRows: chartObj.isSeriesInRows, isInitCell: true, posRange: null, cancel: false\n        };\n        if (chartElements) {\n            this.parent.notify(deleteChartColl, { id: args.id });\n            var imgTop = { clientY: chartElements.offsetTop, isImage: true };\n            this.parent.notify(getRowIdxFromClientY, imgTop);\n            var imgleft = { clientX: chartElements.offsetLeft, isImage: true };\n            this.parent.notify(getColIdxFromClientX, imgleft);\n            isRemoveEle = true;\n            rowIdx = imgTop.clientY;\n            colIdx = imgleft.clientX;\n            sheet = this.parent.sheets[this.parent.activeSheetIndex];\n        }\n        else {\n            this.parent.notify(deleteChartColl, { id: args.id });\n            var sheetIndex = args.range && args.range.indexOf('!') > 0 ? getSheetIndex(this.parent, args.range.split('!')[0]) :\n                this.parent.activeSheetIndex;\n            var rangeVal = args.range ? args.range.indexOf('!') > 0 ? args.range.split('!')[1] : args.range.split('!')[0] :\n                this.parent.getActiveSheet().selectedRange;\n            var index = getRangeIndexes(rangeVal);\n            rowIdx = index[0];\n            colIdx = index[1];\n            sheet = this.parent.sheets[sheetIndex];\n        }\n        cellObj = getCell(rowIdx, colIdx, sheet);\n        if (cellObj) {\n            prevCellChart = cellObj.chart;\n        }\n        chartLength = prevCellChart ? prevCellChart.length : chartLength;\n        for (var i = 0; i < chartLength; i++) {\n            var overlayEle = document.getElementById(args.id);\n            var chartEleClassName = document.getElementById(prevCellChart[i].id);\n            if (closest(chartEleClassName, '.' + overlayEle.classList[1]) === overlayEle) {\n                prevCellChart.splice(i, 1);\n            }\n        }\n        if (isRemoveEle) {\n            document.getElementById(args.id).remove();\n        }\n        setCell(rowIdx, colIdx, sheet, { chart: prevCellChart }, true);\n        eventArgs.posRange = getCellAddress(rowIdx, colIdx);\n        this.parent.notify(completeAction, { eventArgs: eventArgs, action: 'deleteChart' });\n    };\n    /**\n     * Removing event listener for success and failure\n     */\n    SpreadsheetChart.prototype.removeEventListener = function () {\n        if (!this.parent.isDestroyed) {\n            this.parent.off(initiateChart, this.initiateChartHandler);\n            this.parent.off(refreshChartCellObj, this.refreshChartCellObj);\n            this.parent.off(updateChart, this.updateChartHandler);\n            this.parent.off(deleteChart, this.deleteChart);\n            this.parent.off(clearChartBorder, this.clearBorder);\n            this.parent.off(insertChart, this.insertChartHandler);\n            this.parent.off(chartRangeSelection, this.chartRangeHandler);\n        }\n    };\n    /**\n     * To Remove the event listeners.\n     */\n    SpreadsheetChart.prototype.destroy = function () {\n        this.removeEventListener();\n        this.parent = null;\n        var chartEle = null;\n        if (this.chart) {\n            chartEle = this.chart.element;\n            this.chart.destroy();\n        }\n        if (chartEle) {\n            detach(chartEle);\n        }\n        this.chart = null;\n    };\n    /**\n     * Get the sheet chart module name.\n     */\n    SpreadsheetChart.prototype.getModuleName = function () {\n        return 'spreadsheetChart';\n    };\n    return SpreadsheetChart;\n}());\nexport { SpreadsheetChart };\n","import { Spreadsheet } from '../index';\nimport { Selection, Edit, KeyboardNavigation, KeyboardShortcut, Clipboard, WrapText, Insert, Delete, ProtectSheet } from '../actions/index';\nimport { CellFormat, CollaborativeEditing, UndoRedo, Resize, SpreadsheetHyperlink, FindAndReplace, Merge } from '../actions/index';\nimport { Formula, Sort, Filter, SpreadsheetImage, SpreadsheetChart } from '../integrations/index';\nimport { Ribbon, FormulaBar, SheetTabs, Open, ContextMenu, Save, NumberFormat } from '../integrations/index';\nimport { DataBind } from '../../workbook/index';\nimport { DataValidation } from '../actions/data-validation';\nimport { ConditionalFormatting } from '../actions/conditional-formatting';\n/**\n * Spreadsheet basic module.\n * @private\n */\nvar BasicModule = /** @class */ (function () {\n    /**\n     * Constructor for Spreadsheet basic module.\n     * @private\n     */\n    function BasicModule() {\n        Spreadsheet.Inject(Ribbon, FormulaBar, SheetTabs, Selection, Edit, KeyboardNavigation, KeyboardShortcut, Clipboard, DataBind, Open, ContextMenu, Save, NumberFormat, CellFormat, Formula, Sort, CollaborativeEditing, UndoRedo, Resize, Filter, SpreadsheetHyperlink, WrapText, Insert, Delete, ProtectSheet, DataValidation, FindAndReplace, Merge, ConditionalFormatting, SpreadsheetImage, SpreadsheetChart);\n    }\n    /**\n     * For internal use only - Get the module name.\n     * @private\n     */\n    BasicModule.prototype.getModuleName = function () {\n        return 'basic';\n    };\n    /**\n     * Destroys the Spreadsheet basic module.\n     * @return {void}\n     */\n    BasicModule.prototype.destroy = function () {\n        /* code snippet */\n    };\n    return BasicModule;\n}());\nexport { BasicModule };\n","import { Spreadsheet } from '../index';\nimport { Selection, Edit, KeyboardNavigation, KeyboardShortcut, Clipboard, CellFormat, WrapText, ProtectSheet } from '../actions/index';\nimport { CollaborativeEditing, UndoRedo, Resize, SpreadsheetHyperlink, Insert, Delete, FindAndReplace, Merge } from '../actions/index';\nimport { Ribbon, FormulaBar, SheetTabs, Open, Save, NumberFormat, Formula, Sort, Filter, SpreadsheetImage } from '../integrations/index';\nimport { SpreadsheetChart } from '../integrations/index';\nimport { DataBind } from '../../workbook/integrations/index';\nimport { DataValidation } from '../actions/data-validation';\nimport { ConditionalFormatting } from '../actions/conditional-formatting';\n/**\n * Spreadsheet all module.\n * @private\n */\nvar AllModule = /** @class */ (function () {\n    /**\n     * Constructor for Spreadsheet all module.\n     * @private\n     */\n    function AllModule() {\n        Spreadsheet.Inject(Ribbon, FormulaBar, SheetTabs, Selection, Edit, KeyboardNavigation, KeyboardShortcut, Clipboard, DataBind, Open, Save, NumberFormat, CellFormat, Formula, Sort, Resize, CollaborativeEditing, UndoRedo, Filter, SpreadsheetHyperlink, WrapText, Insert, Delete, DataValidation, ProtectSheet, FindAndReplace, Merge, SpreadsheetImage, ConditionalFormatting, SpreadsheetChart);\n    }\n    /**\n     * For internal use only - Get the module name.\n     * @private\n     */\n    AllModule.prototype.getModuleName = function () {\n        return 'all';\n    };\n    /**\n     * Destroys the Spreadsheet all module.\n     * @return {void}\n     */\n    AllModule.prototype.destroy = function () {\n        /* code snippet */\n    };\n    return AllModule;\n}());\nexport { AllModule };\n","var __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    }\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nimport { Property, ChildProperty } from '@syncfusion/ej2-base';\n/**\n * Represents the scroll settings.\n */\nvar ScrollSettings = /** @class */ (function (_super) {\n    __extends(ScrollSettings, _super);\n    function ScrollSettings() {\n        return _super !== null && _super.apply(this, arguments) || this;\n    }\n    __decorate([\n        Property(false)\n    ], ScrollSettings.prototype, \"isFinite\", void 0);\n    __decorate([\n        Property(true)\n    ], ScrollSettings.prototype, \"enableVirtualization\", void 0);\n    return ScrollSettings;\n}(ChildProperty));\nexport { ScrollSettings };\n/**\n * Represents the selection settings.\n */\nvar SelectionSettings = /** @class */ (function (_super) {\n    __extends(SelectionSettings, _super);\n    function SelectionSettings() {\n        return _super !== null && _super.apply(this, arguments) || this;\n    }\n    __decorate([\n        Property('Multiple')\n    ], SelectionSettings.prototype, \"mode\", void 0);\n    return SelectionSettings;\n}(ChildProperty));\nexport { SelectionSettings };\n","/** @hidden */\nexport var DISABLED = 'e-disabled';\n/** @hidden */\nexport var WRAPTEXT = 'e-wraptext';\n/** @hidden */\nexport var locale = 'spreadsheetLocale';\n/** @hidden */\nexport var dialog = 'dialog';\n/** @hidden */\nexport var actionEvents = 'actionEvents';\n/** @hidden */\nexport var overlay = 'shape';\n/** @hidden */\nexport var fontColor = {\n    'Custom': [\n        '#ffffff', '#000000', '#e7e6e6', '#44546a', '#4472c4', '#ed7d31', '#a5a5a5', '#ffc000', '#70ad47', '#ff0000',\n        '#f2f2f2', '#808080', '#cfcdcd', '#d5dce4', '#d9e2f3', '#fbe4d5', '#ededed', '#fff2cc', '#e2efd9', '#ffcccc',\n        '#d9d9d9', '#595959', '#aeaaaa', '#acb9ca', '#b4c6e7', '#f7caac', '#dbdbdb', '#ffe599', '#c5e0b3', '#ff8080',\n        '#bfbfbf', '#404040', '#747070', '#8496b0', '#8eaadb', '#f4b083', '#c9c9c9', '#ffd966', '#a8d08d', '#ff3333',\n        '#a6a6a6', '#262626', '#3b3838', '#323e4f', '#2f5496', '#c45911', '#7b7b7b', '#bf8f00', '#538135', '#b30000',\n        '#7f7f7f', '#0d0d0d', '#161616', '#212934', '#1f3763', '#823b0b', '#525252', '#7f5f00', '#375623', '#660000'\n    ]\n};\n/** @hidden */\nexport var fillColor = {\n    'Custom': [\n        '#ffffff', '#000000', '#ffff00', '#00ff00', '#00ffff', '#0000ff', '#ff0000', '#000080', '#800080', '#996633',\n        '#f2f2f2', '#808080', '#ffffcc', '#b3ffb3', '#ccffff', '#ccccff', '#ffcccc', '#ccccff', '#ff80ff', '#f2e6d9',\n        '#d9d9d9', '#595959', '#ffff80', '#80ff80', '#b3ffff', '#8080ff', '#ff8080', '#8080ff', '#ff00ff', '#dfbf9f',\n        '#bfbfbf', '#404040', '#ffff33', '#33ff33', '#33ffff', '#3333ff', '#ff3333', '#0000b3', '#b300b3', '#c68c53',\n        '#a6a6a6', '#262626', '#e6e600', '#00b300', '#009999', '#000099', '#b30000', '#000066', '#660066', '#86592d',\n        '#7f7f7f', '#0d0d0d', '#999900', '#006600', '#006666', '#000066', '#660000', '#00004d', '#4d004d', '#734d26',\n    ]\n};\n/**\n * Default locale text\n * @hidden\n */\nexport var defaultLocale = {\n    FindValue: 'Find value',\n    ReplaceValue: 'Replace value',\n    FindReplaceTooltip: 'Find & Replace',\n    InsertingEmptyValue: 'Reference value is not valid.',\n    ReplaceAllEnd: ' matches replaced with ',\n    ByRow: 'By Rows',\n    ByColumn: 'By Columns',\n    MatchCase: 'Match case   ',\n    MatchExactCellElements: 'Match exact cell contents',\n    Replace: 'Replace...',\n    Find: 'Find and Replace...',\n    Goto: 'Goto...',\n    EntercellAddress: 'Enter cell address',\n    GotoSpecial: 'GotoSpecial...',\n    FindAndReplace: 'Find and Replace',\n    FindNextBtn: 'Find Next',\n    FindPreviousBtn: 'Find Previous',\n    ReplaceBtn: 'Replace',\n    ReplaceAllBtn: 'Replace All',\n    GotoHeader: 'Go To',\n    GotoSpecialHeader: 'Go To Special',\n    Sheet: 'Sheet',\n    Workbook: 'Workbook',\n    NoElements: 'We couldn\\'t find what you were looking for.',\n    FindWhat: 'Find what',\n    ReplaceWith: 'Replace with',\n    Cut: 'Cut',\n    Copy: 'Copy',\n    Paste: 'Paste',\n    PasteSpecial: 'Paste Special',\n    Link: 'Link',\n    SpreadsheetHyperlink: 'SpreadsheetHyperlink',\n    Hyperlink: 'Hyperlink',\n    EditHyperlink: 'Edit Hyperlink',\n    OpenHyperlink: 'Open Hyperlink',\n    RemoveHyperlink: 'Remove Hyperlink',\n    InsertLink: 'Insert Link',\n    EditLink: 'Edit Link',\n    All: 'All',\n    Values: 'Values',\n    Formats: 'Formats',\n    Bold: 'Bold',\n    Font: 'Font',\n    FontSize: 'Font Size',\n    Italic: 'Italic',\n    Underline: 'Underline',\n    Strikethrough: 'Strikethrough',\n    TextColor: 'Text Color',\n    FillColor: 'Fill Color',\n    HorizontalAlignment: 'Horizontal Alignment',\n    AlignLeft: 'Align Left',\n    AlignCenter: 'Center',\n    AlignRight: 'Align Right',\n    VerticalAlignment: 'Vertical Alignment',\n    AlignTop: 'Align Top',\n    AlignMiddle: 'Align Middle',\n    AlignBottom: 'Align Bottom',\n    WrapText: 'Wrap Text',\n    MergeCells: 'Merge Cells',\n    MergeAll: 'Merge All',\n    MergeHorizontally: 'Merge Horizontally',\n    MergeVertically: 'Merge Vertically',\n    Unmerge: 'Unmerge',\n    UnmergeCells: 'Unmerge Cells',\n    SelectMergeType: 'Select Merge Type',\n    MergeCellsAlert: 'Merging cells will only preserve the top-leftmost(Uppermost) value. Merge anyway?',\n    PasteMergeAlert: 'We can\"t do that to a merge cell.',\n    Borders: 'Borders',\n    TopBorders: 'Top Borders',\n    LeftBorders: 'Left Borders',\n    RightBorders: 'Right Borders',\n    BottomBorders: 'Bottom Borders',\n    AllBorders: 'All Borders',\n    HorizontalBorders: 'Horizontal Borders',\n    VerticalBorders: 'Vertical Borders',\n    OutsideBorders: 'Outside Borders',\n    InsideBorders: 'Inside Borders',\n    NoBorders: 'No Borders',\n    BorderColor: 'Border Color',\n    BorderStyle: 'Border Style',\n    InsertFunction: 'Insert Function',\n    Insert: 'Insert',\n    Delete: 'Delete',\n    Rename: 'Rename',\n    Hide: 'Hide',\n    Unhide: 'Unhide',\n    NameBox: 'Name Box',\n    ShowHeaders: 'Show Headers',\n    HideHeaders: 'Hide Headers',\n    ShowGridLines: 'Show Gridlines',\n    HideGridLines: 'Hide Gridlines',\n    AddSheet: 'Add Sheet',\n    ListAllSheets: 'List All Sheets',\n    FullScreen: 'Full Screen',\n    CollapseToolbar: 'Collapse Toolbar',\n    ExpandToolbar: 'Expand Toolbar',\n    CollapseFormulaBar: 'Collapse Formula Bar',\n    ExpandFormulaBar: 'Expand Formula Bar',\n    File: 'File',\n    Home: 'Home',\n    Formulas: 'Formulas',\n    View: 'View',\n    New: 'New',\n    Open: 'Open',\n    SaveAs: 'Save As',\n    Update: 'Update',\n    ExcelXlsx: 'Microsoft Excel',\n    ExcelXls: 'Microsoft Excel 97-2003',\n    CSV: 'Comma-separated values',\n    FormulaBar: 'Formula Bar',\n    Sort: 'Sort',\n    SortAscending: 'Ascending',\n    SortDescending: 'Descending',\n    CustomSort: 'Custom Sort',\n    AddColumn: 'Add Column',\n    ContainsHeader: 'Data contains header',\n    CaseSensitive: 'Case sensitive',\n    SortBy: 'Sort by',\n    ThenBy: 'Then by',\n    SelectAColumn: 'Select a column',\n    SortEmptyFieldError: 'Sort criteria column should not be empty.',\n    SortDuplicateFieldError: ' is mentioned more than once. Duplicate columns must be removed.',\n    SortOutOfRangeError: 'Select a cell or range inside the used range and try again.',\n    SortAndFilter: 'Sort & Filter',\n    Filter: 'Filter',\n    ClearAllFilter: 'Clear',\n    ClearFilterFrom: 'Clear Filter From ',\n    ReapplyFilter: 'Reapply',\n    FilterCellValue: 'Filter by Value of Selected Cell',\n    FilterOutOfRangeError: 'Select a cell or range inside the used range and try again.',\n    HideRow: 'Hide Row',\n    HideRows: 'Hide Rows',\n    UnHideRows: 'UnHide Rows',\n    HideColumn: 'Hide Column',\n    HideColumns: 'Hide Columns',\n    UnHideColumns: 'UnHide Columns',\n    InsertRow: 'Insert Row',\n    InsertRows: 'Insert Rows',\n    Above: 'Above',\n    Below: 'Below',\n    InsertColumn: 'Insert Column',\n    InsertColumns: 'Insert Columns',\n    Before: 'Before',\n    After: 'After',\n    DeleteRow: 'Delete Row',\n    DeleteRows: 'Delete Rows',\n    DeleteColumn: 'Delete Column',\n    DeleteColumns: 'Delete Columns',\n    Ok: 'Ok',\n    Close: 'Close',\n    Cancel: 'Cancel',\n    Apply: 'Apply',\n    MoreColors: 'More Colors',\n    StandardColors: 'Standard Colors',\n    General: 'General',\n    Number: 'Number',\n    Currency: 'Currency',\n    Accounting: 'Accounting',\n    ShortDate: 'Short Date',\n    LongDate: 'Long Date',\n    Time: 'Time',\n    Percentage: 'Percentage',\n    Fraction: 'Fraction',\n    Scientific: 'Scientific',\n    Text: 'Text',\n    MobileFormulaBarPlaceHolder: 'Enter value or Formula',\n    NumberFormat: 'Number Format',\n    PasteAlert: 'You can\\'t paste this here, because the copy area and paste area aren\\'t in the same size. ' +\n        'Please try pasting in a different range.',\n    DestroyAlert: 'Are you sure you want to destroy the current workbook without saving and create a new workbook?',\n    SheetRenameInvalidAlert: 'Sheet name contains invalid character.',\n    SheetRenameEmptyAlert: 'Sheet name cannot be empty.',\n    SheetRenameAlreadyExistsAlert: 'Sheet name already exists. Please enter another name.',\n    DeleteSheetAlert: 'You can\\'t undo deleting sheets, and you might be removing some data. If you don\\'t need it, click OK to delete.',\n    DeleteSingleLastSheetAlert: 'A Workbook must contain at least one visible worksheet.',\n    PickACategory: 'Pick a category',\n    Description: 'Description',\n    UnsupportedFile: 'Unsupported File',\n    InvalidUrl: 'Invalid URL',\n    SUM: 'Adds a series of numbers and/or cells.',\n    SUMIF: 'Adds the cells based on specified condition.',\n    SUMIFS: 'Adds the cells based on specified conditions.',\n    ABS: 'Returns the value of a number without its sign.',\n    RAND: 'Returns a random number between 0 and 1.',\n    RANDBETWEEN: 'Returns a random integer based on specified values.',\n    FLOOR: 'Rounds a number down to the nearest multiple of a given factor.',\n    CEILING: 'Rounds a number up to the nearest multiple of a given factor.',\n    PRODUCT: 'Multiplies a series of numbers and/or cells.',\n    INT: 'Returns a number to the nearest integer.',\n    ROUNDUP: 'Rounds a number away from zero.',\n    SUMPRODUCT: 'Returns sum of the product of given ranges of arrays.',\n    TODAY: 'Returns the current date as date value.',\n    AVERAGE: 'Calculates average for the series of numbers and/or cells excluding text.',\n    AVERAGEIF: 'Calculates average for the cells based on specified criterion.',\n    AVERAGEIFS: 'Calculates average for the cells based on specified conditions.',\n    AVERAGEA: 'Calculates the average for the cells evaluating TRUE as 1, text and FALSE as 0.',\n    COUNT: 'Counts the cells that contain numeric values in a range.',\n    COUNTIF: 'Counts the cells based on specified condition.',\n    COUNTIFS: 'Counts the cells based on specified conditions.',\n    COUNTA: 'Counts the cells that contains values in a range.',\n    MIN: 'Returns the smallest number of the given arguments.',\n    MAX: 'Returns the largest number of the given arguments.',\n    DATE: 'Returns the date based on given year, month, and day.',\n    DAY: 'Returns the day from the given date.',\n    DAYS: 'Returns the number of days between two dates.',\n    IF: 'Returns value based on the given expression.',\n    IFS: 'Returns value based on the given multiple expressions.',\n    CalculateAND: 'Returns TRUE if all the arguments are TRUE, otherwise returns FALSE.',\n    CalculateOR: 'Returns TRUE if any of the arguments are TRUE, otherwise returns FALSE.',\n    IFERROR: 'Returns value if no error found else it will return specified value.',\n    CHOOSE: 'Returns a value from list of values, based on index number.',\n    INDEX: 'Returns a value of the cell in a given range based on row and column number.',\n    FIND: 'Returns the position of a string within another string, which is case sensitive',\n    CONCATENATE: 'Combines two or more strings together.',\n    CONCAT: 'Concatenates a list or a range of text strings.',\n    SUBTOTAL: 'Returns subtotal for a range using the given function number.',\n    RADIANS: 'Converts degrees into radians.',\n    MATCH: 'Returns the relative position of a specified value in given range.',\n    LN: 'Returns the natural logarithm of a number.',\n    INTERCEPT: 'Calculates the point of the Y-intercept line via linear regression.',\n    SLOPE: 'Returns the slope of the line from linear regression of the data points.',\n    DefineNameExists: 'This name already exists, try different name.',\n    DefineNameInValid: 'The name that you entered is not valid.',\n    CircularReference: 'When a formula refers to one or more circular references, this may result in an incorrect calculation.',\n    ShowRowsWhere: 'Show rows where:',\n    OR: 'OR',\n    AND: 'AND',\n    CustomFilterDatePlaceHolder: 'Choose a date',\n    CustomFilterPlaceHolder: 'Enter the value',\n    CustomFilter: 'Custom Filter',\n    Between: 'Between',\n    DateTimeFilter: 'DateTime Filters',\n    Undo: 'Undo',\n    Redo: 'Redo',\n    DateFilter: 'Date Filters',\n    TextFilter: 'Text Filters',\n    NumberFilter: 'Number Filters',\n    ClearFilter: 'Clear Filter',\n    NoResult: 'No Matches Found',\n    FilterFalse: 'False',\n    FilterTrue: 'True',\n    Blanks: 'Blanks',\n    SelectAll: 'Select All',\n    GreaterThanOrEqual: 'Greater Than Or Equal',\n    GreaterThan: 'Greater Than',\n    LessThanOrEqual: 'Less Than Or Equal',\n    LessThan: 'Less Than',\n    NotEqual: 'Not Equal',\n    Equal: 'Equal',\n    Contains: 'Contains',\n    EndsWith: 'Ends With',\n    StartsWith: 'Starts With',\n    ClearButton: 'Clear',\n    FilterButton: 'Filter',\n    CancelButton: 'Cancel',\n    OKButton: 'OK',\n    Search: 'Search',\n    ProtectSheet: 'Protect Sheet',\n    UnprotectSheet: 'Unprotect Sheet',\n    LockCells: 'Lock Cells',\n    SelectCells: 'Select cells',\n    FormatCells: 'Format cells',\n    FormatRows: 'Format rows',\n    FormatColumns: 'Format columns',\n    InsertLinks: 'Insert links',\n    ProtectContent: 'Protect the contents of locked cells',\n    ProtectAllowUser: ' Allow all users of this worksheet to:',\n    EditAlert: 'The cell you\\'re trying to change is protected. To make change, unprotect the sheet.',\n    SearchWithin: 'Search within',\n    SearchBy: 'Search by',\n    Reference: 'Reference',\n    DataValidation: 'Data Validation',\n    CLEARALL: 'CLEAR ALL',\n    APPLY: 'APPLY',\n    CellRange: 'Cell Range',\n    Allow: 'Allow',\n    Data: 'Data',\n    Minimum: 'Minimum',\n    Maximum: 'Maximum',\n    IgnoreBlank: 'Ignore blank',\n    WholeNumber: 'Whole Number',\n    Decimal: 'Decimal',\n    Date: 'Date',\n    TextLength: 'Text Length',\n    List: 'List',\n    NotBetween: 'Not between',\n    EqualTo: 'Equal to',\n    NotEqualTo: 'Not equal to',\n    Greaterthan: 'Greater than',\n    Lessthan: 'Less than',\n    GreaterThanOrEqualTo: 'Greater than or equal to',\n    LessThanOrEqualTo: 'Less than or equal to',\n    InCellDropDown: 'In-cell-dropdown',\n    Sources: 'Sources',\n    Value: 'Value',\n    Retry: 'Retry',\n    EnterValue: 'Enter value',\n    DialogError: 'The list source must be a reference to single row or column.',\n    ListLengthError: 'The list values allows only upto 256 charcters',\n    ValidationError: 'This value doesn' + '\\'' + 't match the data validation restrictions defined for the cell.',\n    EmptyError: 'You must enter a value',\n    ClearHighlight: 'Clear Highlight',\n    HighlightInvalidData: 'Highlight Invalid Data',\n    ClearValidation: 'Clear Validation',\n    HighlightCellsRules: 'Highlight Cells Rules',\n    CFEqualTo: 'Equal To',\n    TextThatContains: 'Text that Contains',\n    ADateOccuring: 'A Date Occuring',\n    DuplicateValues: 'Duplicate Values',\n    TopBottomRules: 'Top/Bottom Rules',\n    Top10Items: 'Top 10 Items',\n    Top10: 'Top 10',\n    Bottom10Items: 'Bottom 10 Items',\n    Bottom10: 'Bottom 10',\n    AboveAverage: 'Above Average',\n    BelowAverage: 'Below Average',\n    FormatCellsGreaterThan: 'Format cells that are GREATER THAN:',\n    FormatCellsLessThan: 'Format cells that are LESS THAN:',\n    FormatCellsBetween: 'Format cells that are BETWEEN:',\n    FormatCellsEqualTo: 'Format cells that are EQUAL TO:',\n    FormatCellsThatContainTheText: 'Format cells that contain the text:',\n    FormatCellsThatContainADateOccurring: 'Format cells that contain a date occurring:',\n    FormatCellsDuplicate: 'Format cells that contain:',\n    FormatCellsTop: 'Format cells that rank in the TOP:',\n    FormatCellsBottom: 'Format cells that rank in the BOTTOM:',\n    FormatCellsAbove: 'Format cells that are ABOVE AVERAGE:',\n    FormatCellsBelow: 'Format cells that are BELOW AVERAGE:',\n    With: 'with',\n    DataBars: 'Data Bars',\n    ColorScales: 'Color Scales',\n    IconSets: 'Icon Sets',\n    ClearRules: 'Clear Rules',\n    SelectedCells: 'Clear Rules from Selected Cells',\n    EntireSheet: 'Clear Rules from Entire Sheet',\n    ISNUMBER: 'Returns true when the value parses as a numeric value.',\n    ROUND: 'Rounds a number to a specified number of digits.',\n    GEOMEAN: 'Returns the geometric mean of an array or range of positive data.',\n    POWER: 'Returns the result of a number raised to power',\n    LOG: 'Returns the logarithm of a number to the base that you specify.',\n    TRUNC: 'Returns the truncated value of a number to a specified number of decimal places.',\n    EXP: 'Returns e raised to the power of the given number.',\n    Clear: 'Clear',\n    ClearContents: 'Clear Contents',\n    ClearAll: 'Clear All',\n    ClearFormats: 'Clear Formats',\n    ClearHyperlinks: 'Clear Hyperlinks',\n    LightRedFillWithDarkRedText: 'Light Red Fill with Dark Red Text',\n    YellowFillWithDarkYellowText: 'Yellow Fill with Dark Yellow Text',\n    GreenFillWithDarkGreenText: 'Green Fill with Dark Green Text',\n    RedFill: 'Red Fill',\n    RedText: 'Red Text',\n    Duplicate: 'Duplicate',\n    Unique: 'Unique',\n    And: 'and',\n    WebPage: 'WEB PAGE',\n    ThisDocument: 'THIS DOCUMENT',\n    DisplayText: 'Display Text',\n    Url: 'URL',\n    CellReference: 'Cell Reference',\n    DefinedNames: 'Defined Names',\n    EnterTheTextToDisplay: 'Enter the text to display',\n    EnterTheUrl: 'Enter the URL',\n    Image: 'Image',\n    ConditionalFormatting: 'Conditional Formatting',\n    BlueDataBar: 'Blue Data Bar',\n    GreenDataBar: 'Green Data Bar',\n    RedDataBar: 'Red Data Bar',\n    OrangeDataBar: 'Orange Data Bar',\n    LightblueDataBar: 'Light blue Data Bar',\n    PurpleDataBar: 'Purple Data Bar',\n    GYRColorScale: 'Green - Yellow - Red Color Scale',\n    RYGColorScale: 'Red - Yellow - Green Color Scale',\n    GWRColorScale: 'Green - White - Red Color Scale',\n    RWGColorScale: 'Red - White - Green Color Scale',\n    BWRColorScale: 'Blue - White - Red Color Scale',\n    RWBColorScale: 'Red - White - Blue Color Scale',\n    WRColorScale: 'White - Red Color Scale',\n    RWColorScale: 'Red - White Color Scale',\n    GWColorScale: 'Green - White Color Scale',\n    WGColorScale: 'White - Green Color Scale',\n    GYColorScale: 'Green - Yellow Color Scale',\n    YGColorScale: 'Yellow - Green Color Scale',\n    ThreeArrowsColor: '3 Arrows (Colored)',\n    ThreeArrowsGray: '3 Arrows (Gray)',\n    ThreeTriangles: '3 Triangles',\n    FourArrowsColor: '4 Arrows (Gray)',\n    FourArrowsGray: '4 Arrows (Colored)',\n    FiveArrowsColor: '5 Arrows (Gray)',\n    FiveArrowsGray: '5 Arrows (Colored)',\n    ThreeTrafficLights1: '3 Traffic Lights (Unrimmed)',\n    ThreeTrafficLights2: '3 Traffic Lights (Rimmed)',\n    ThreeSigns: '3 Signs',\n    FourTrafficLights: '4 Traffic Lights',\n    RedToBlack: 'Red To Black',\n    ThreeSymbols1: '3 Symbols (Circled)',\n    ThreeSymbols2: '3 Symbols (Uncircled)',\n    ThreeFlags: '3 Flags',\n    ThreeStars: '3 Stars',\n    FourRatings: '4 Ratings',\n    FiveQuarters: '5 Quarters',\n    FiveRatings: '5 Ratings',\n    FiveBoxes: '5 Boxes',\n    Chart: 'Chart',\n    Column: 'Column',\n    Bar: 'Bar',\n    Area: 'Area',\n    Pie: 'Pie',\n    Doughnut: 'Doughnut',\n    PieAndDoughnut: 'Pie/Doughnut',\n    Line: 'Line',\n    Radar: 'Radar',\n    Scatter: 'Scatter',\n    ChartDesign: 'Chart Design',\n    ClusteredColumn: 'Clustered Column',\n    StackedColumn: 'Stacked Column',\n    StackedColumn100: '100% Stacked Column',\n    ClusteredBar: 'Clustered Bar',\n    StackedBar: 'Stacked Bar',\n    StackedBar100: '100% Stacked Bar',\n    StackedArea: 'Stacked Area',\n    StackedArea100: '100% Stacked Area',\n    StackedLine: 'Stacked Line',\n    StackedLine100: '100% Stacked Line',\n};\n","import { formatUnit, detach, attributes, isNullOrUndefined } from '@syncfusion/ej2-base';\nimport { getRangeIndexes } from './../../workbook/common/address';\nimport { getColumnWidth, isHiddenCol } from '../../workbook/base/column';\nimport { contentLoaded, editOperation, getUpdateUsingRaf, removeAllChildren } from '../common/index';\nimport { beforeContentLoaded, getColGroupWidth, virtualContentLoaded, setAriaOptions, dataBound } from '../common/index';\nimport { beforeHeaderLoaded, created, spreadsheetDestroyed, skipHiddenIdx, isReact } from '../common/index';\nimport { checkMerge, forRefSelRender, initiateEdit, chartRangeSelection, renderReactTemplates } from '../common/index';\nimport { getCell, isHiddenRow } from '../../workbook/index';\n/**\n * Sheet module is used to render Sheet\n * @hidden\n */\nvar SheetRender = /** @class */ (function () {\n    function SheetRender(parent) {\n        this.freezePane = false;\n        this.colGroupWidth = 30; //Row header and selectall table colgroup width\n        this.parent = parent;\n        this.col = parent.createElement('col');\n        this.rowRenderer = parent.serviceLocator.getService('row');\n        this.cellRenderer = parent.serviceLocator.getService('cell');\n        this.addEventListener();\n    }\n    SheetRender.prototype.refreshSelectALLContent = function () {\n        var cell;\n        if (this.freezePane) {\n            var tHead = this.getSelectAllTable().querySelector('thead');\n            var row = this.rowRenderer.render();\n            tHead.appendChild(row);\n            cell = this.parent.createElement('th', { className: 'e-select-all-cell' });\n            row.appendChild(cell);\n        }\n        else {\n            cell = this.headerPanel.firstElementChild;\n            cell.classList.add('e-select-all-cell');\n        }\n        cell.appendChild(this.parent.createElement('button', { className: 'e-selectall e-icons',\n            id: this.parent.element.id + \"_select_all\" }));\n    };\n    SheetRender.prototype.updateLeftColGroup = function (width, rowHdr) {\n        if (width) {\n            this.colGroupWidth = width;\n        }\n        if (!rowHdr) {\n            rowHdr = this.getRowHeaderPanel();\n        }\n        var table = rowHdr.querySelector('table');\n        this.detachColGroup(table);\n        var colGrp = this.parent.createElement('colgroup');\n        var colGrpWidth = this.colGroupWidth + \"px\";\n        var col = this.col.cloneNode();\n        col.style.width = colGrpWidth;\n        colGrp.appendChild(col);\n        table.insertBefore(colGrp, table.querySelector('tbody'));\n        rowHdr.style.width = colGrpWidth;\n        if (this.freezePane) {\n            table = this.getSelectAllTable();\n            this.detachColGroup(table);\n            table.insertBefore(colGrp.cloneNode(true), table.querySelector('thead'));\n        }\n        else {\n            this.getSelectAllContent().style.width = colGrpWidth;\n        }\n        if (this.parent.getActiveSheet().showHeaders) {\n            this.getColHeaderPanel().style.width = \"calc(100% - \" + colGrpWidth + \")\";\n            this.getContentPanel().style.width = \"calc(100% - \" + colGrpWidth + \")\";\n        }\n    };\n    SheetRender.prototype.detachColGroup = function (table) {\n        var colGrp = table.querySelector('colgroup');\n        if (colGrp) {\n            detach(colGrp);\n        }\n    };\n    SheetRender.prototype.renderPanel = function () {\n        this.contentPanel = this.parent.createElement('div', { className: 'e-main-panel' });\n        var sheet = this.parent.getActiveSheet();\n        var id = this.parent.element.id;\n        if (sheet.showHeaders) {\n            this.contentPanel.appendChild(this.parent.createElement('div', { className: 'e-row-header', id: id + \"_row_header\" }));\n            this.initHeaderPanel();\n            if (this.parent.allowScrolling) {\n                this.parent.scrollModule.setPadding();\n            }\n        }\n        else {\n            this.updateHideHeaders();\n        }\n        var content = this.contentPanel.appendChild(this.parent.createElement('div', { className: 'e-sheet-content', id: id + \"_main_content\" }));\n        if (!sheet.showGridLines) {\n            content.classList.add('e-hide-gridlines');\n        }\n        if (!this.parent.allowScrolling) {\n            content.style.overflow = 'hidden';\n        }\n    };\n    SheetRender.prototype.initHeaderPanel = function () {\n        var id = this.parent.element.id;\n        this.headerPanel = this.parent.createElement('div', { className: 'e-header-panel' });\n        this.headerPanel.appendChild(this.parent.createElement('div', { className: 'e-selectall-container', id: id + \"_selectall\" }));\n        this.headerPanel.appendChild(this.parent.createElement('div', { className: 'e-column-header', id: id + \"_col_header\" }));\n    };\n    SheetRender.prototype.createTable = function () {\n        if (this.parent.getActiveSheet().showHeaders) {\n            this.createHeaderTable();\n        }\n        this.updateTable('tbody', 'content', this.contentPanel.lastElementChild);\n    };\n    SheetRender.prototype.createHeaderTable = function (rowHdrEle) {\n        if (rowHdrEle === void 0) { rowHdrEle = this.contentPanel.querySelector('.e-row-header'); }\n        if (this.freezePane) {\n            this.updateTable('thead', 'selectall', this.headerPanel.querySelector('.e-selectall-container'));\n        }\n        this.updateTable('thead', 'colhdr', this.headerPanel.querySelector('.e-column-header'));\n        this.updateTable('tbody', 'rowhdr', rowHdrEle);\n        this.updateLeftColGroup(null, rowHdrEle);\n    };\n    SheetRender.prototype.updateTable = function (tagName, name, appendTo) {\n        var table = this.parent.createElement('table', { className: 'e-table', attrs: { 'role': 'grid' } });\n        table.classList.add(\"e-\" + name + \"-table\");\n        appendTo.appendChild(table);\n        table.appendChild(this.parent.createElement(tagName));\n    };\n    /**\n     * It is used to refresh the select all, row header, column header and content of the spreadsheet.\n     */\n    SheetRender.prototype.renderTable = function (args) {\n        var _this = this;\n        var indexes;\n        var row;\n        var hRow;\n        var sheet = this.parent.getActiveSheet();\n        var frag = document.createDocumentFragment();\n        this.createTable();\n        var colGrp = this.parent.createElement('colgroup');\n        var cTBody = this.contentPanel.querySelector('.e-sheet-content tbody');\n        var rHdrTBody;\n        var cHdrTHead;\n        var cHdrRow;\n        if (sheet.showHeaders) {\n            frag.appendChild(this.headerPanel);\n            this.refreshSelectALLContent();\n            rHdrTBody = this.contentPanel.querySelector('.e-row-header tbody');\n            cHdrTHead = this.headerPanel.querySelector('.e-column-header thead');\n            this.getColHeaderTable().insertBefore(colGrp, cHdrTHead);\n            cHdrRow = this.rowRenderer.render();\n            cHdrTHead.appendChild(cHdrRow);\n        }\n        frag.appendChild(this.contentPanel);\n        this.parent.notify(beforeContentLoaded, { startColIdx: args.indexes[1] });\n        var colCount = sheet.colCount.toString();\n        var rowCount = sheet.colCount.toString();\n        var layout = args.top && args.left ? 'RowColumn' : (args.top ? 'Row' : (args.left ? 'Column' : ''));\n        if (sheet.showHeaders) {\n            this.parent.getColHeaderTable().setAttribute('aria-colcount', colCount);\n            this.parent.getRowHeaderTable().setAttribute('aria-rowcount', rowCount);\n        }\n        attributes(this.parent.getContentTable(), { 'aria-rowcount': rowCount, 'aria-colcount': colCount });\n        args.cells.forEach(function (value, key) {\n            indexes = getRangeIndexes(key);\n            if (indexes[1] === args.indexes[1]) {\n                if (sheet.showHeaders) {\n                    hRow = _this.rowRenderer.render(indexes[0], true);\n                    rHdrTBody.appendChild(hRow);\n                    hRow.appendChild(_this.cellRenderer.renderRowHeader(indexes[0]));\n                }\n                row = _this.rowRenderer.render(indexes[0]);\n                cTBody.appendChild(row);\n            }\n            row.appendChild(_this.cellRenderer.render({ colIdx: indexes[1], rowIdx: indexes[0], cell: value,\n                address: key, lastCell: indexes[1] === args.indexes[3], isHeightCheckNeeded: true, row: row, hRow: hRow,\n                pRow: row.previousSibling, pHRow: sheet.showHeaders ? hRow.previousSibling : null,\n                first: layout ? (layout.includes('Row') ? (indexes[0] === args.indexes[0] ? 'Row' : (layout.includes('Column') ? (indexes[1] === args.indexes[1] ? 'Column' : '') : '')) : (indexes[1] === args.indexes[1] ? 'Column' : '')) : '' }));\n            if (indexes[0] === args.indexes[0]) {\n                _this.updateCol(sheet, indexes[1], colGrp);\n                if (sheet.showHeaders) {\n                    cHdrRow.appendChild(_this.cellRenderer.renderColHeader(indexes[1]));\n                }\n            }\n        });\n        if (this.parent[isReact]) {\n            this.parent[renderReactTemplates]();\n        }\n        cTBody.parentElement.insertBefore(colGrp.cloneNode(true), cTBody);\n        getUpdateUsingRaf(function () {\n            var content = _this.parent.getMainContent();\n            var sheetContent = document.getElementById(_this.parent.element.id + '_sheet');\n            sheetContent.appendChild(frag);\n            if (args.top) {\n                content.scrollTop = args.top;\n                if (sheet.showHeaders) {\n                    _this.parent.getRowHeaderContent().scrollTop = args.top;\n                }\n            }\n            if (args.left) {\n                content.scrollLeft = args.left;\n                if (sheet.showHeaders) {\n                    _this.parent.getColumnHeaderContent().scrollLeft = args.left;\n                }\n            }\n            _this.parent.notify(contentLoaded, null);\n            _this.parent.notify(editOperation, { action: 'renderEditor' });\n            if (!args.initLoad && !_this.parent.isOpen) {\n                _this.parent.hideSpinner();\n            }\n            setAriaOptions(_this.parent.getMainContent(), { busy: false });\n            _this.parent.trigger(dataBound, {});\n            if (_this.parent.isEdit) {\n                _this.parent.notify(initiateEdit, null);\n            }\n            if (args.initLoad) {\n                var triggerEvent = true;\n                if (_this.parent.scrollSettings.enableVirtualization) {\n                    for (var i = 0; i < sheet.ranges.length; i++) {\n                        if (sheet.ranges[i].info.count - 1 > _this.parent.viewport.bottomIndex) {\n                            triggerEvent = false;\n                            break;\n                        }\n                    }\n                }\n                if (triggerEvent) {\n                    _this.triggerCreatedEvent();\n                }\n            }\n        });\n    };\n    SheetRender.prototype.triggerCreatedEvent = function () {\n        if (!this.parent.isOpen) {\n            this.parent.hideSpinner();\n        }\n        if (this.parent.createdHandler) {\n            if (this.parent.createdHandler.observers) {\n                this.parent[created].observers = this.parent.createdHandler.observers;\n            }\n            else {\n                this.parent.setProperties({ created: this.parent.createdHandler }, true);\n            }\n            this.parent.createdHandler = undefined;\n            this.parent.trigger(created, null);\n        }\n    };\n    SheetRender.prototype.refreshColumnContent = function (args) {\n        var _this = this;\n        var indexes;\n        var row;\n        var table;\n        var count = 0;\n        var cell;\n        var sheet = this.parent.getActiveSheet();\n        var frag = document.createDocumentFragment();\n        var hFrag = document.createDocumentFragment();\n        var tBody = this.parent.element.querySelector('.e-sheet-content tbody');\n        tBody = frag.appendChild(tBody.cloneNode(true));\n        var colGrp = this.parent.element.querySelector('.e-sheet-content colgroup');\n        colGrp = colGrp.cloneNode();\n        var hRow;\n        var tHead;\n        if (sheet.showHeaders) {\n            hFrag.appendChild(colGrp);\n            tHead = this.parent.element.querySelector('.e-column-header thead');\n            tHead = hFrag.appendChild(tHead.cloneNode(true));\n            hRow = tHead.querySelector('tr');\n            hRow.innerHTML = '';\n        }\n        args.cells.forEach(function (value, key) {\n            indexes = getRangeIndexes(key);\n            if (indexes[0] === args.indexes[0]) {\n                _this.updateCol(sheet, indexes[1], colGrp);\n                if (sheet.showHeaders) {\n                    hRow.appendChild(_this.cellRenderer.renderColHeader(indexes[1]));\n                }\n            }\n            if (indexes[1] === args.indexes[1]) {\n                row = tBody.children[count];\n                if (row) {\n                    row.innerHTML = '';\n                    count++;\n                }\n                else {\n                    return;\n                }\n            }\n            cell = row.appendChild(_this.cellRenderer.render({\n                colIdx: indexes[1], rowIdx: indexes[0], cell: value, address: key, row: row, pRow: row.previousSibling,\n                first: !args.skipUpdateOnFirst && indexes[1] === args.indexes[1] ? 'Column' : (_this.parent.scrollSettings.\n                    enableVirtualization && indexes[0] === args.indexes[0] && _this.parent.viewport.topIndex !== skipHiddenIdx(sheet, 0, true)\n                    ? 'Row' : '')\n            }));\n            _this.checkColMerge(indexes, args.indexes, cell, value);\n        });\n        frag.insertBefore(colGrp.cloneNode(true), tBody);\n        getUpdateUsingRaf(function () {\n            if (sheet.showHeaders) {\n                table = _this.getColHeaderTable();\n                removeAllChildren(table);\n                table.appendChild(hFrag);\n            }\n            table = _this.getContentTable();\n            removeAllChildren(table);\n            table.appendChild(frag);\n            _this.parent.notify(virtualContentLoaded, { refresh: 'Column' });\n            if (_this.parent.isEdit) {\n                _this.parent.notify(forRefSelRender, {});\n            }\n            if (_this.parent.allowChart) {\n                _this.parent.notify(chartRangeSelection, null);\n            }\n            if (!_this.parent.isOpen) {\n                _this.parent.hideSpinner();\n            }\n            setAriaOptions(_this.parent.getMainContent(), { busy: false });\n        });\n    };\n    SheetRender.prototype.refreshRowContent = function (args) {\n        var _this = this;\n        var indexes;\n        var row;\n        var hdrRow;\n        var colGroupWidth = this.colGroupWidth;\n        var sheet = this.parent.getActiveSheet();\n        var hFrag;\n        var hTBody;\n        var cell;\n        var frag = document.createDocumentFragment();\n        var tBody = this.parent.createElement('tbody');\n        if (sheet.showHeaders) {\n            hFrag = document.createDocumentFragment();\n            hTBody = tBody.cloneNode();\n            hFrag.appendChild(hTBody);\n        }\n        frag.appendChild(tBody);\n        args.cells.forEach(function (value, key) {\n            indexes = getRangeIndexes(key);\n            if (indexes[1] === args.indexes[1]) {\n                if (sheet.showHeaders) {\n                    hdrRow = _this.rowRenderer.render(indexes[0], true);\n                    hTBody.appendChild(hdrRow);\n                    hdrRow.appendChild(_this.cellRenderer.renderRowHeader(indexes[0]));\n                    colGroupWidth = getColGroupWidth(indexes[0] + 1);\n                }\n                row = _this.rowRenderer.render(indexes[0]);\n                tBody.appendChild(row);\n            }\n            cell = row.appendChild(_this.cellRenderer.render({ rowIdx: indexes[0], colIdx: indexes[1], cell: value, address: key, lastCell: indexes[1] === args.indexes[3], row: row, hRow: hdrRow, pRow: row.previousSibling, pHRow: sheet.showHeaders ?\n                    hdrRow.previousSibling : null, isHeightCheckNeeded: true, first: !args.skipUpdateOnFirst && indexes[0] === args.indexes[0] ?\n                    'Row' : (_this.parent.scrollSettings.enableVirtualization && indexes[1] === args.indexes[1] && _this.parent.viewport.leftIndex\n                    !== skipHiddenIdx(sheet, 0, true, 'columns') ? 'Column' : '') }));\n            _this.checkRowMerge(indexes, args.indexes, cell, value);\n        });\n        if (this.colGroupWidth !== colGroupWidth) {\n            this.updateLeftColGroup(colGroupWidth);\n        }\n        if (sheet.showHeaders) {\n            if (this.contentPanel.querySelector('.e-row-header tbody')) {\n                detach(this.contentPanel.querySelector('.e-row-header tbody'));\n                this.getRowHeaderTable().appendChild(hFrag);\n            }\n        }\n        if (this.contentPanel.querySelector('.e-sheet-content tbody')) {\n            detach(this.contentPanel.querySelector('.e-sheet-content tbody'));\n            this.getContentTable().appendChild(frag);\n        }\n        this.parent.notify(virtualContentLoaded, { refresh: 'Row' });\n        if (this.parent.allowChart) {\n            this.parent.notify(chartRangeSelection, {});\n        }\n        if (this.parent.isEdit) {\n            this.parent.notify(forRefSelRender, null);\n        }\n        if (!this.parent.isOpen) {\n            this.parent.hideSpinner();\n        }\n        setAriaOptions(this.parent.getMainContent(), { busy: false });\n    };\n    SheetRender.prototype.updateCol = function (sheet, idx, appendTo) {\n        var col = this.col.cloneNode();\n        col.style.width = formatUnit(getColumnWidth(sheet, idx));\n        return appendTo ? appendTo.appendChild(col) : col;\n    };\n    SheetRender.prototype.updateColContent = function (args) {\n        var _this = this;\n        getUpdateUsingRaf(function () {\n            var indexes;\n            var row;\n            var table;\n            var refChild;\n            var cell;\n            var hRow;\n            var rowCount = 0;\n            var col;\n            var hRefChild;\n            var sheet = _this.parent.getActiveSheet();\n            if (sheet.showHeaders) {\n                hRow = _this.parent.element.querySelector('.e-column-header .e-header-row');\n                hRefChild = hRow.firstElementChild;\n            }\n            var colGrp = _this.parent.element.querySelector('.e-sheet-content colgroup');\n            var colRefChild = colGrp.firstElementChild;\n            var skipRender;\n            var tBody = _this.parent.element.querySelector('.e-sheet-content tbody');\n            args.cells.forEach(function (value, key) {\n                if (skipRender) {\n                    return;\n                }\n                indexes = getRangeIndexes(key);\n                if (args.direction === 'first' && indexes[1] === args.indexes[1]) {\n                    _this.checkColMerge([indexes[0], _this.parent.viewport.leftIndex], args.indexes, (tBody.rows[rowCount] || { cells: [] }).cells[(args.indexes[3] - args.indexes[1]) + 1], getCell(indexes[0], _this.parent.viewport.leftIndex, sheet) || {});\n                }\n                if (indexes[0] === args.indexes[0]) {\n                    if (args.direction === 'last') {\n                        col = _this.col.cloneNode();\n                        col.style.width = formatUnit(getColumnWidth(sheet, indexes[1]));\n                        colGrp.insertBefore(col, colRefChild);\n                        if (sheet.showHeaders) {\n                            hRow.insertBefore(_this.cellRenderer.renderColHeader(indexes[1]), hRefChild);\n                        }\n                    }\n                    else {\n                        _this.updateCol(sheet, indexes[1], colGrp);\n                        if (sheet.showHeaders) {\n                            hRow.appendChild(_this.cellRenderer.renderColHeader(indexes[1]));\n                        }\n                    }\n                    if (_this.parent.scrollSettings.enableVirtualization && args.direction) {\n                        // tslint:disable\n                        detach(colGrp[args.direction + 'ElementChild']);\n                        if (sheet.showHeaders) {\n                            detach(hRow[args.direction + 'ElementChild']);\n                        }\n                        // tslint:enable\n                    }\n                }\n                if (indexes[1] === args.indexes[1]) {\n                    row = tBody.children[rowCount];\n                    rowCount++;\n                    if (!row) {\n                        skipRender = true;\n                        return;\n                    }\n                    refChild = row.firstElementChild;\n                }\n                cell = _this.cellRenderer.render({ colIdx: indexes[1], rowIdx: indexes[0], cell: value, address: key,\n                    lastCell: indexes[1] === args.indexes[3], isHeightCheckNeeded: args.direction === 'first',\n                    first: args.direction === 'last' && !args.skipUpdateOnFirst && indexes[1] === args.indexes[1] ? 'Column' : '',\n                    checkNextBorder: args.direction === 'last' && indexes[3] === args.indexes[3] ? 'Column' : '', });\n                if (args.direction === 'last') {\n                    _this.checkColMerge(indexes, args.indexes, cell, value, (tBody.rows[rowCount - 1] || { cells: [] }).cells[0]);\n                    row.insertBefore(cell, refChild);\n                }\n                else {\n                    row.appendChild(cell);\n                }\n                if (_this.parent.scrollSettings.enableVirtualization && args.direction) {\n                    // tslint:disable-next-line:no-any\n                    detach(row[args.direction + 'ElementChild']);\n                }\n            });\n            if (sheet.showHeaders) {\n                table = _this.getColHeaderTable();\n                detach(table.querySelector('colgroup'));\n                table.insertBefore(colGrp.cloneNode(true), table.querySelector('thead'));\n            }\n            if (_this.parent.scrollSettings.enableVirtualization) {\n                _this.parent.notify(virtualContentLoaded, { refresh: 'Column' });\n            }\n            if (_this.parent.allowChart) {\n                _this.parent.notify(chartRangeSelection, null);\n            }\n            if (_this.parent.isEdit) {\n                _this.parent.notify(forRefSelRender, {});\n            }\n            if (!_this.parent.isOpen) {\n                _this.parent.hideSpinner();\n            }\n            setAriaOptions(_this.parent.getMainContent(), { busy: false });\n        });\n    };\n    SheetRender.prototype.updateRowContent = function (args) {\n        var _this = this;\n        var colGroupWidth = this.colGroupWidth;\n        var row;\n        var hRow;\n        var cell;\n        var sheet = this.parent.getActiveSheet();\n        var cellModel;\n        var count = 0;\n        var tBody = this.parent.getMainContent().querySelector('tbody');\n        var rTBody;\n        var rFrag;\n        var index;\n        if (sheet.showHeaders) {\n            rFrag = document.createDocumentFragment();\n            rTBody = this.parent.getRowHeaderContent().querySelector('tbody');\n        }\n        var indexes;\n        var frag = document.createDocumentFragment();\n        this.parent.showSpinner();\n        args.cells.forEach(function (value, cKey) {\n            indexes = getRangeIndexes(cKey);\n            if (args.direction === 'first' && indexes[0] === args.indexes[0]) {\n                _this.checkRowMerge([_this.parent.viewport.topIndex, indexes[1]], args.indexes, (tBody.rows[(args.indexes[2] - args.indexes[0]) + 1] || { cells: [] }).cells[count], getCell(_this.parent.viewport.topIndex, indexes[1], sheet) || {});\n            }\n            if (indexes[1] === args.indexes[1]) {\n                if (sheet.showHeaders) {\n                    hRow = _this.rowRenderer.render(indexes[0], true);\n                    rFrag.appendChild(hRow);\n                    hRow.appendChild(_this.cellRenderer.renderRowHeader(indexes[0]));\n                    colGroupWidth = getColGroupWidth(indexes[0] + 1);\n                    if (_this.parent.scrollSettings.enableVirtualization && args.direction) {\n                        // tslint:disable-next-line:no-any\n                        detach(rTBody[args.direction + 'ElementChild']);\n                    }\n                }\n                row = _this.rowRenderer.render(indexes[0]);\n                frag.appendChild(row);\n                if (_this.parent.scrollSettings.enableVirtualization && args.direction) {\n                    // tslint:disable-next-line:no-any\n                    detach(tBody[args.direction + 'ElementChild']);\n                }\n            }\n            cell = row.appendChild(_this.cellRenderer.render({ colIdx: indexes[1], rowIdx: indexes[2], cell: value, address: cKey, lastCell: indexes[1] === args.indexes[3], row: row, pHRow: sheet.showHeaders ? hRow.previousSibling : null,\n                checkNextBorder: args.direction === 'last' && indexes[2] === args.indexes[2] ? 'Row' : '', pRow: row.previousSibling,\n                isHeightCheckNeeded: args.direction === 'first' || args.direction === '', hRow: hRow, first: args.direction === 'last' &&\n                    !args.skipUpdateOnFirst && indexes[0] === args.indexes[0] ? 'Row' : '' }));\n            if (args.direction === 'last') {\n                _this.checkRowMerge(indexes, args.indexes, cell, value, tBody.rows[0].cells[count]);\n            }\n            count++;\n        });\n        if (this.colGroupWidth !== colGroupWidth) {\n            this.updateLeftColGroup(colGroupWidth);\n        }\n        if (args.direction === 'last') {\n            if (sheet.showHeaders) {\n                rTBody.insertBefore(rFrag, rTBody.firstElementChild);\n            }\n            tBody.insertBefore(frag, tBody.firstElementChild);\n        }\n        else {\n            if (sheet.showHeaders) {\n                rTBody.appendChild(rFrag);\n            }\n            tBody.appendChild(frag);\n        }\n        if (this.parent.scrollSettings.enableVirtualization) {\n            this.parent.notify(virtualContentLoaded, { refresh: 'Row' });\n        }\n        if (this.parent.isEdit) {\n            this.parent.notify(forRefSelRender, null);\n        }\n        if (this.parent.allowChart) {\n            this.parent.notify(chartRangeSelection, {});\n        }\n        if (!this.parent.isOpen) {\n            this.parent.hideSpinner();\n        }\n        setAriaOptions(this.parent.getMainContent(), { busy: false });\n    };\n    SheetRender.prototype.checkRowMerge = function (indexes, range, cell, model, firstcell) {\n        if (this.parent.scrollSettings.enableVirtualization && cell &&\n            (!isNullOrUndefined(model.rowSpan) || !isNullOrUndefined(model.colSpan))) {\n            if (indexes[0] === this.parent.viewport.topIndex) {\n                if (model.rowSpan < 0) {\n                    this.parent.notify(checkMerge, { td: cell, rowIdx: indexes[0], colIdx: indexes[1], isRow: true });\n                    if (this.parent.viewport.topIndex >= range[0]) {\n                        this.refreshPrevMerge(range[0] + 1, indexes[1]);\n                    }\n                }\n                if (firstcell && (firstcell.colSpan || firstcell.rowSpan)) {\n                    this.cellRenderer.refresh(indexes[0] + (range[2] - range[0]) + 1, indexes[1], null, firstcell);\n                }\n            }\n            else if (model.rowSpan > 1) {\n                var prevTopIdx = range[2] + 1;\n                if (indexes[0] + model.rowSpan - 1 > prevTopIdx && indexes[0] < prevTopIdx) {\n                    this.refreshPrevMerge(prevTopIdx, indexes[1], this.parent.viewport.topIndex);\n                }\n            }\n        }\n    };\n    SheetRender.prototype.refreshPrevMerge = function (prevTopIdx, colIndex, currTopIdx) {\n        var td = this.parent.getCell(prevTopIdx, colIndex, this.parent.getRow(currTopIdx ? currTopIdx : 0));\n        if (td && td.rowSpan > 1) {\n            this.cellRenderer.refresh(prevTopIdx, colIndex, null, td);\n        }\n    };\n    SheetRender.prototype.checkColMerge = function (indexes, range, cell, model, firstcell) {\n        if (this.parent.scrollSettings.enableVirtualization && cell && indexes[1] === this.parent.viewport.leftIndex &&\n            (!isNullOrUndefined(model.rowSpan) || !isNullOrUndefined(model.colSpan))) {\n            if (model.colSpan < 0) {\n                this.parent.notify(checkMerge, { td: cell, colIdx: indexes[1], rowIdx: indexes[0] });\n            }\n            if (firstcell && (firstcell.colSpan || firstcell.rowSpan)) {\n                this.cellRenderer.refresh(indexes[0], indexes[1] + (range[3] - range[1]) + 1, null, firstcell);\n            }\n        }\n    };\n    /**\n     * Used to toggle row and column headers.\n     */\n    SheetRender.prototype.showHideHeaders = function () {\n        var _this = this;\n        var sheet = this.parent.getActiveSheet();\n        if (sheet.showHeaders) {\n            if (this.parent.scrollSettings.enableVirtualization) {\n                var indexes = [this.parent.viewport.topIndex, this.parent.viewport.leftIndex,\n                    this.parent.viewport.bottomIndex, this.parent.viewport.rightIndex];\n                this.renderHeaders([indexes[0], indexes[2]], [indexes[1], indexes[3]]);\n            }\n            else {\n                this.renderHeaders([0, sheet.rowCount - 1], [0, sheet.colCount - 1]);\n                if (sheet.topLeftCell !== 'A1') {\n                    this.parent.goTo(sheet.topLeftCell);\n                }\n            }\n        }\n        else {\n            getUpdateUsingRaf(function () {\n                detach(_this.headerPanel);\n                detach(_this.getRowHeaderPanel());\n                _this.getContentPanel().style.width = '';\n                _this.updateHideHeaders();\n            });\n        }\n    };\n    SheetRender.prototype.renderHeaders = function (rowIndexes, colIndexes) {\n        var _this = this;\n        var sheet = this.parent.getActiveSheet();\n        this.initHeaderPanel();\n        var cFrag = document.createDocumentFragment();\n        var rFrag = document.createDocumentFragment();\n        cFrag.appendChild(this.headerPanel);\n        var rowHdrEle = rFrag.appendChild(this.parent.createElement('div', { className: 'e-row-header', id: this.parent.element.id + \"_row_header\" }));\n        this.createHeaderTable(rowHdrEle);\n        this.parent.notify(beforeHeaderLoaded, { element: rowHdrEle });\n        this.refreshSelectALLContent();\n        var rTBody = rowHdrEle.querySelector('tbody');\n        var cTHead = this.headerPanel.querySelector('.e-column-header thead');\n        var cRow = this.rowRenderer.render();\n        cTHead.appendChild(cRow);\n        var row;\n        for (var i = colIndexes[0]; i <= colIndexes[1]; i++) {\n            if (!isHiddenCol(sheet, i)) {\n                cRow.appendChild(this.cellRenderer.renderColHeader(i));\n            }\n        }\n        var colGroupWidth = getColGroupWidth(rowIndexes[1]);\n        if (this.colGroupWidth !== colGroupWidth) {\n            this.updateLeftColGroup(colGroupWidth, rowHdrEle);\n        }\n        for (var i = rowIndexes[0]; i <= rowIndexes[1]; i++) {\n            if (!isHiddenRow(sheet, i)) {\n                row = this.rowRenderer.render(i, true);\n                row.appendChild(this.cellRenderer.renderRowHeader(i));\n                rTBody.appendChild(row);\n            }\n        }\n        getUpdateUsingRaf(function () {\n            _this.getColHeaderTable().insertBefore(_this.getContentTable().querySelector('colgroup').cloneNode(true), cTHead);\n            var sheet = document.getElementById(_this.parent.element.id + '_sheet');\n            sheet.classList.remove('e-hide-headers');\n            sheet.insertBefore(cFrag, _this.contentPanel);\n            var content = _this.getContentPanel();\n            _this.contentPanel.insertBefore(rFrag, content);\n            _this.parent.scrollModule.setPadding();\n            rowHdrEle.scrollTop = content.scrollTop;\n            _this.getColHeaderPanel().scrollLeft = content.scrollLeft;\n        });\n    };\n    SheetRender.prototype.updateHideHeaders = function () {\n        document.getElementById(this.parent.element.id + '_sheet').classList.add('e-hide-headers');\n        this.headerPanel = null;\n    };\n    /**\n     * Get the select all table element of spreadsheet\n     * @return {HTMLElement}\n     */\n    SheetRender.prototype.getSelectAllContent = function () {\n        return this.headerPanel.getElementsByClassName('e-selectall-container')[0];\n    };\n    /**\n     * Get the select all table element of spreadsheet\n     * @return {Element}\n     */\n    SheetRender.prototype.getSelectAllTable = function () {\n        return this.headerPanel.getElementsByClassName('e-selectall-table')[0];\n    };\n    /**\n     * Get the column header element of spreadsheet\n     * @return {HTMLTableElement}\n     */\n    SheetRender.prototype.getColHeaderTable = function () {\n        return this.headerPanel.getElementsByClassName('e-colhdr-table')[0];\n    };\n    /**\n     * Get the row header table element of spreadsheet\n     * @return {HTMLTableElement}\n     */\n    SheetRender.prototype.getRowHeaderTable = function () {\n        return this.contentPanel.getElementsByClassName('e-rowhdr-table')[0];\n    };\n    /**\n     * Get the main content table element of spreadsheet\n     * @return {Element}\n     */\n    SheetRender.prototype.getContentTable = function () {\n        return this.contentPanel.getElementsByClassName('e-content-table')[0];\n    };\n    /**\n     * Get the row header div element of spreadsheet\n     * @return {Element}\n     */\n    SheetRender.prototype.getRowHeaderPanel = function () {\n        return this.contentPanel.getElementsByClassName('e-row-header')[0];\n    };\n    /**\n     * Get the column header div element of spreadsheet\n     * @return {Element}\n     */\n    SheetRender.prototype.getColHeaderPanel = function () {\n        return this.headerPanel.getElementsByClassName('e-column-header')[0];\n    };\n    /**\n     * Get the main content div element of spreadsheet\n     * @return {Element}\n     */\n    SheetRender.prototype.getContentPanel = function () {\n        return this.contentPanel.getElementsByClassName('e-sheet-content')[0];\n    };\n    SheetRender.prototype.addEventListener = function () {\n        this.parent.on(created, this.triggerCreatedEvent, this);\n        this.parent.on(spreadsheetDestroyed, this.destroy, this);\n    };\n    SheetRender.prototype.destroy = function () {\n        this.removeEventListener();\n        this.parent = null;\n    };\n    SheetRender.prototype.removeEventListener = function () {\n        this.parent.off(created, this.triggerCreatedEvent);\n        this.parent.off(spreadsheetDestroyed, this.destroy);\n    };\n    return SheetRender;\n}());\nexport { SheetRender };\n","import { skipHiddenIdx } from '../common/index';\nimport { getRowHeight, getCell, isHiddenRow } from '../../workbook/base/index';\nimport { attributes } from '@syncfusion/ej2-base';\nimport { getCellAddress } from '../../workbook/common/index';\n/**\n * Sheet module is used for creating row element\n * @hidden\n */\nvar RowRenderer = /** @class */ (function () {\n    function RowRenderer(parent) {\n        this.parent = parent;\n        this.element = this.parent.createElement('tr', { attrs: { 'role': 'row' } });\n        this.cellRenderer = parent.serviceLocator.getService('cell');\n    }\n    RowRenderer.prototype.render = function (index, isRowHeader, skipHidden) {\n        var row = this.element.cloneNode();\n        if (index === undefined) {\n            row.classList.add('e-header-row');\n            return row;\n        }\n        row.classList.add('e-row');\n        var sheet = this.parent.getActiveSheet();\n        attributes(row, { 'aria-rowindex': (index + 1).toString() });\n        row.style.height = getRowHeight(sheet, index) + \"px\";\n        if (isRowHeader && !skipHidden) {\n            if (isHiddenRow(sheet, index + 1) && !isHiddenRow(sheet, index - 1)) {\n                row.classList.add('e-hide-start');\n            }\n            if (index !== 0 && isHiddenRow(sheet, index - 1) && !isHiddenRow(sheet, index + 1)) {\n                row.classList.add('e-hide-end');\n            }\n        }\n        return row;\n    };\n    RowRenderer.prototype.refresh = function (index, pRow, hRow, header) {\n        var row;\n        var sheet = this.parent.getActiveSheet();\n        if (header) {\n            row = this.render(index, true, true);\n            row.appendChild(this.cellRenderer.renderRowHeader(index));\n        }\n        else {\n            row = this.render(index);\n            var len = this.parent.viewport.leftIndex + this.parent.viewport.colCount + (this.parent.getThreshold('col') * 2);\n            for (var i = this.parent.viewport.leftIndex; i <= len; i++) {\n                row.appendChild(this.cellRenderer.render({ colIdx: i, rowIdx: index, cell: getCell(index, i, sheet),\n                    address: getCellAddress(index, i), lastCell: i === len, row: row, hRow: hRow, isHeightCheckNeeded: true, pRow: pRow,\n                    first: index === this.parent.viewport.topIndex && skipHiddenIdx(sheet, index, true) !== skipHiddenIdx(sheet, 0, true) ?\n                        'Row' : '' }));\n            }\n        }\n        return row;\n    };\n    return RowRenderer;\n}());\nexport { RowRenderer };\n","import { inView, renderFilterCell, checkConditionalFormat } from '../common/index';\nimport { hasTemplate, createHyperlinkElement, checkPrevMerge, createImageElement } from '../common/index';\nimport { getColumnHeaderText, getRangeIndexes, getRangeAddress } from '../../workbook/common/index';\nimport { setChart, refreshChart, getCellAddress } from '../../workbook/common/index';\nimport { getCell, skipDefaultValue, isHiddenRow, isHiddenCol } from '../../workbook/base/index';\nimport { getRowHeight, setRowHeight } from '../../workbook/base/index';\nimport { addClass, attributes, getNumberDependable, extend, compile, isNullOrUndefined } from '@syncfusion/ej2-base';\nimport { getFormattedCellObject, applyCellFormat, workbookFormulaOperation, wrapEvent, cFRender } from '../../workbook/common/event';\nimport { getTypeFromFormat } from '../../workbook/index';\nimport { checkIsFormula } from '../../workbook/common/util';\n/**\n * CellRenderer class which responsible for building cell content.\n * @hidden\n */\nvar CellRenderer = /** @class */ (function () {\n    function CellRenderer(parent) {\n        this.parent = parent;\n        this.element = this.parent.createElement('td');\n        this.th = this.parent.createElement('th', { className: 'e-header-cell' });\n        this.tableRow = parent.createElement('tr', { className: 'e-row' });\n        this.parent.on('updateView', this.updateView, this);\n    }\n    CellRenderer.prototype.renderColHeader = function (index) {\n        var headerCell = this.th.cloneNode();\n        attributes(headerCell, { 'role': 'columnheader', 'aria-colindex': (index + 1).toString(), 'tabindex': '-1' });\n        headerCell.innerHTML = getColumnHeaderText(index + 1);\n        var sheet = this.parent.getActiveSheet();\n        if (isHiddenCol(sheet, index + 1)) {\n            headerCell.classList.add('e-hide-start');\n        }\n        if (index !== 0 && isHiddenCol(sheet, index - 1)) {\n            headerCell.classList.add('e-hide-end');\n        }\n        return headerCell;\n    };\n    CellRenderer.prototype.renderRowHeader = function (index) {\n        var headerCell = this.element.cloneNode();\n        addClass([headerCell], 'e-header-cell');\n        attributes(headerCell, { 'role': 'rowheader', 'tabindex': '-1' });\n        headerCell.innerHTML = (index + 1).toString();\n        return headerCell;\n    };\n    CellRenderer.prototype.render = function (args) {\n        args.td = this.element.cloneNode();\n        args.td.className = 'e-cell';\n        attributes(args.td, { 'role': 'gridcell', 'aria-colindex': (args.colIdx + 1).toString(), 'tabindex': '-1' });\n        var sheet = this.parent.getActiveSheet();\n        if (this.checkMerged(args)) {\n            return args.td;\n        }\n        var compiledTemplate = this.processTemplates(args.cell, args.rowIdx, args.colIdx);\n        if (typeof compiledTemplate === 'string') {\n            args.td.innerHTML = compiledTemplate;\n        }\n        else {\n            args.td.appendChild(compiledTemplate);\n        }\n        args.isRefresh = false;\n        this.update(args);\n        if (args.cell && args.td) {\n            this.parent.notify(cFRender, { rowIdx: args.rowIdx, colIdx: args.colIdx, cell: args.cell, td: args.td, isChecked: false });\n            if (args.td && args.td.children[0] && args.td.children[0].className === 'e-cf-databar') {\n                if (args.cell.style && args.cell.style.fontSize) {\n                    args.td.children[0].querySelector('.e-databar-value').style.fontSize = args.cell.style.fontSize;\n                }\n                args.td.children[0].style.height = '100%';\n                args.td.children[0].firstElementChild.nextElementSibling.style.height = '100%';\n            }\n        }\n        if (!hasTemplate(this.parent, args.rowIdx, args.colIdx, this.parent.activeSheetIndex)) {\n            this.parent.notify(renderFilterCell, { td: args.td, rowIndex: args.rowIdx, colIndex: args.colIdx });\n        }\n        var evtArgs = { cell: args.cell, element: args.td, address: args.address };\n        this.parent.trigger('beforeCellRender', evtArgs);\n        this.updateRowHeight({\n            rowIdx: args.rowIdx,\n            cell: evtArgs.element,\n            lastCell: args.lastCell,\n            rowHgt: 20,\n            row: args.row,\n            hRow: args.hRow\n        });\n        var isWrap = args.td.classList.contains('e-wraptext');\n        var cellValue = args.td.innerHTML;\n        if (cellValue.indexOf('\\n') > -1 && !isWrap) {\n            var splitVal = cellValue.split('\\n');\n            if (splitVal.length > 1) {\n                this.parent.notify(wrapEvent, {\n                    range: [args.rowIdx, args.colIdx, args.rowIdx, args.colIdx], wrap: true, initial: true, sheet: this.parent.getActiveSheet(), td: args.td, row: args.row, hRow: args.hRow\n                });\n            }\n        }\n        return evtArgs.element;\n    };\n    // tslint:disable-next-line:max-func-body-length\n    CellRenderer.prototype.update = function (args) {\n        if (args.isRefresh) {\n            if (args.td.rowSpan) {\n                args.td.removeAttribute('rowSpan');\n            }\n            if (args.td.colSpan) {\n                args.td.removeAttribute('colSpan');\n            }\n            if (this.checkMerged(args)) {\n                return;\n            }\n        }\n        if (args.cell && args.cell.formula && !args.cell.value) {\n            var isFormula = checkIsFormula(args.cell.formula);\n            var eventArgs = {\n                action: 'refreshCalculate', value: args.cell.formula, rowIndex: args.rowIdx, colIndex: args.colIdx, isFormula: isFormula\n            };\n            this.parent.notify(workbookFormulaOperation, eventArgs);\n            args.cell.value = getCell(args.rowIdx, args.colIdx, this.parent.getActiveSheet()).value;\n        }\n        var formatArgs = {\n            type: args.cell && getTypeFromFormat(args.cell.format),\n            value: args.cell && args.cell.value, format: args.cell && args.cell.format ? args.cell.format : 'General',\n            formattedText: args.cell && args.cell.value, onLoad: true, isRightAlign: false, cell: args.cell,\n            rowIdx: args.rowIdx.toString(), colIdx: args.colIdx.toString()\n        };\n        if (args.cell) {\n            this.parent.notify(getFormattedCellObject, formatArgs);\n        }\n        if (!isNullOrUndefined(args.td)) {\n            this.parent.refreshNode(args.td, { type: formatArgs.type, result: formatArgs.formattedText,\n                curSymbol: getNumberDependable(this.parent.locale, 'USD'), isRightAlign: formatArgs.isRightAlign,\n                value: formatArgs.value || ''\n            });\n        }\n        var style = {};\n        if (args.cell) {\n            if (args.cell.style) {\n                if (args.cell.style.properties) {\n                    style = skipDefaultValue(args.cell.style, true);\n                }\n                else {\n                    style = args.cell.style;\n                }\n            }\n            if (args.cell.chart && args.cell.chart.length > 0) {\n                this.parent.notify(setChart, { chart: args.cell.chart, isInitCell: true, range: getCellAddress(args.rowIdx, args.colIdx) });\n            }\n            if (args.cell.hyperlink) {\n                this.parent.notify(createHyperlinkElement, { cell: args.cell, td: args.td, rowIdx: args.rowIdx, colIdx: args.colIdx });\n            }\n            if (args.cell.wrap) {\n                this.parent.notify(wrapEvent, {\n                    range: [args.rowIdx, args.colIdx, args.rowIdx, args.colIdx], wrap: true, sheet: this.parent.getActiveSheet(), initial: true, td: args.td, row: args.row, hRow: args.hRow\n                });\n            }\n            if (args.cell.rowSpan > 1) {\n                var rowSpan = args.cell.rowSpan - this.parent.hiddenCount(args.rowIdx, args.rowIdx + (args.cell.rowSpan - 1));\n                if (rowSpan > 1) {\n                    args.td.rowSpan = rowSpan;\n                }\n            }\n            if (args.cell.colSpan > 1) {\n                var colSpan = args.cell.colSpan -\n                    this.parent.hiddenCount(args.colIdx, args.colIdx + (args.cell.colSpan - 1), 'columns');\n                if (colSpan > 1) {\n                    args.td.colSpan = colSpan;\n                }\n            }\n            if (args.cell.image) {\n                for (var i = 0; i < args.cell.image.length; i++) {\n                    this.parent.notify(createImageElement, {\n                        options: {\n                            src: args.cell.image[i].src, imageId: args.cell.image[i].id,\n                            height: args.cell.image[i].height, width: args.cell.image[i].width,\n                            top: args.cell.image[i].top, left: args.cell.image[i].left\n                        },\n                        range: getRangeAddress([args.rowIdx, args.colIdx, args.rowIdx, args.colIdx]), isPublic: false\n                    });\n                }\n            }\n        }\n        if (args.isRefresh) {\n            this.removeStyle(args.td, args.rowIdx, args.colIdx);\n        }\n        if (this.parent.allowConditionalFormat && args.lastCell) {\n            this.parent.notify(checkConditionalFormat, { rowIdx: args.rowIdx, colIdx: args.colIdx, cell: args.cell });\n        }\n        if (this.parent.allowChart && args.lastCell) {\n            this.parent.notify(refreshChart, {\n                cell: args.cell, rIdx: args.rowIdx, cIdx: args.colIdx, sheetIdx: this.parent.activeSheetIndex\n            });\n        }\n        if (Object.keys(style).length || Object.keys(this.parent.commonCellStyle).length || args.lastCell) {\n            this.parent.notify(applyCellFormat, {\n                style: extend({}, this.parent.commonCellStyle, style), rowIdx: args.rowIdx, colIdx: args.colIdx, cell: args.td,\n                first: args.first, row: args.row, lastCell: args.lastCell, hRow: args.hRow, pRow: args.pRow, isHeightCheckNeeded: args.isHeightCheckNeeded, manualUpdate: args.manualUpdate\n            });\n        }\n        if (args.checkNextBorder === 'Row') {\n            var borderTop = this.parent.getCellStyleValue(['borderTop'], [Number(this.parent.getContentTable().rows[0].getAttribute('aria-rowindex')) - 1, args.colIdx]).borderTop;\n            if (borderTop !== '' && (!args.cell || !args.cell.style || !args.cell.style.bottomPriority)) {\n                this.parent.notify(applyCellFormat, { style: { borderBottom: borderTop }, rowIdx: args.rowIdx,\n                    colIdx: args.colIdx, cell: args.td });\n            }\n        }\n        if (args.checkNextBorder === 'Column') {\n            var borderLeft = this.parent.getCellStyleValue(['borderLeft'], [args.rowIdx, args.colIdx + 1]).borderLeft;\n            if (borderLeft !== '' && (!args.cell || !args.cell.style || (!args.cell.style.borderRight && !args.cell.style.border))) {\n                this.parent.notify(applyCellFormat, { style: { borderRight: borderLeft }, rowIdx: args.rowIdx, colIdx: args.colIdx,\n                    cell: args.td });\n            }\n        }\n        if (args.cell && args.cell.hyperlink && !hasTemplate(this.parent, args.rowIdx, args.colIdx, this.parent.activeSheetIndex)) {\n            var address = void 0;\n            if (typeof (args.cell.hyperlink) === 'string') {\n                address = args.cell.hyperlink;\n                if (address.indexOf('http://') !== 0 && address.indexOf('https://') !== 0 && address.indexOf('ftp://') !== 0) {\n                    args.cell.hyperlink = address.toLowerCase().indexOf('www.') === 0 ? 'http://' + address : address;\n                }\n            }\n            else {\n                address = args.cell.hyperlink.address;\n                if (address.indexOf('http://') !== 0 && address.indexOf('https://') !== 0 && address.indexOf('ftp://') !== 0) {\n                    args.cell.hyperlink.address = address.toLowerCase().indexOf('www.') === 0 ? 'http://' + address : address;\n                }\n            }\n            this.parent.notify(createHyperlinkElement, { cell: args.cell, td: args.td, rowIdx: args.rowIdx, colIdx: args.colIdx });\n        }\n    };\n    CellRenderer.prototype.checkMerged = function (args) {\n        if (args.cell && (args.cell.colSpan < 0 || args.cell.rowSpan < 0)) {\n            args.td.style.display = 'none';\n            if (args.cell.colSpan < 0) {\n                this.parent.notify(checkPrevMerge, args);\n            }\n            if (args.cell.rowSpan < 0) {\n                args.isRow = true;\n                this.parent.notify(checkPrevMerge, args);\n            }\n            return true;\n        }\n        return false;\n    };\n    CellRenderer.prototype.processTemplates = function (cell, rowIdx, colIdx) {\n        var sheet = this.parent.getActiveSheet();\n        var ranges = sheet.ranges;\n        var range;\n        for (var j = 0, len = ranges.length; j < len; j++) {\n            if (ranges[j].template) {\n                range = getRangeIndexes(ranges[j].address.length ? ranges[j].address : ranges[j].startCell);\n                if (range[0] <= rowIdx && range[1] <= colIdx && range[2] >= rowIdx && range[3] >= colIdx) {\n                    if (cell) {\n                        return this.compileCellTemplate(ranges[j].template);\n                    }\n                    else {\n                        if (!getCell(rowIdx, colIdx, sheet, true)) {\n                            return this.compileCellTemplate(ranges[j].template);\n                        }\n                    }\n                }\n            }\n        }\n        return '';\n    };\n    CellRenderer.prototype.compileCellTemplate = function (template) {\n        var compiledStr;\n        if (typeof template === 'string') {\n            var templateString = void 0;\n            if (template.trim().indexOf('#') === 0) {\n                templateString = document.querySelector(template).innerHTML.trim();\n            }\n            else {\n                templateString = template;\n            }\n            compiledStr = compile(templateString);\n            return compiledStr({}, null, null, '', true)[0].outerHTML;\n        }\n        else {\n            compiledStr = compile(template);\n            return compiledStr({}, this.parent, 'ranges', '')[0];\n        }\n    };\n    CellRenderer.prototype.updateRowHeight = function (args) {\n        if (args.cell && args.cell.children.length) {\n            var clonedCell = args.cell.cloneNode(true);\n            this.tableRow.appendChild(clonedCell);\n        }\n        if (args.lastCell && this.tableRow.childElementCount) {\n            var sheet = this.parent.getActiveSheet();\n            var tableRow = args.row || this.parent.getRow(args.rowIdx);\n            var previouseHeight = getRowHeight(sheet, args.rowIdx);\n            var rowHeight = this.getRowHeightOnInit();\n            if (rowHeight > previouseHeight) {\n                tableRow.style.height = rowHeight + \"px\";\n                if (sheet.showHeaders) {\n                    (args.hRow || this.parent.getRow(args.rowIdx, this.parent.getRowHeaderTable())).style.height =\n                        rowHeight + \"px\";\n                }\n                setRowHeight(sheet, args.rowIdx, rowHeight);\n            }\n            this.tableRow.innerHTML = '';\n        }\n    };\n    CellRenderer.prototype.getRowHeightOnInit = function () {\n        var tTable = this.parent.createElement('table', { className: 'e-table e-test-table' });\n        var tBody = tTable.appendChild(this.parent.createElement('tbody'));\n        tBody.appendChild(this.tableRow);\n        this.parent.element.appendChild(tTable);\n        var height = Math.round(this.tableRow.getBoundingClientRect().height);\n        this.parent.element.removeChild(tTable);\n        return height < 20 ? 20 : height;\n    };\n    CellRenderer.prototype.removeStyle = function (element, rowIdx, colIdx) {\n        var cellStyle;\n        if (element.style.length) {\n            cellStyle = this.parent.getCellStyleValue(['borderLeft', 'border'], [rowIdx, colIdx + 1]);\n            var rightBorder_1 = cellStyle.borderLeft || cellStyle.border;\n            cellStyle = this.parent.getCellStyleValue(['borderTop', 'border'], [rowIdx + 1, colIdx]);\n            var bottomBorder_1 = cellStyle.borderTop || cellStyle.border;\n            if (rightBorder_1 || bottomBorder_1) {\n                [].slice.call(element.style).forEach(function (style) {\n                    if ((rightBorder_1 && !(style.indexOf('border-right') > -1) && !bottomBorder_1) ||\n                        (bottomBorder_1 && !(style.indexOf('border-bottom') > -1) && !rightBorder_1)) {\n                        element.style.removeProperty(style);\n                    }\n                });\n            }\n            else {\n                element.removeAttribute('style');\n            }\n        }\n        var prevRowCell = this.parent.getCell(rowIdx - 1, colIdx);\n        if (prevRowCell && prevRowCell.style.borderBottom) {\n            var prevRowIdx = Number(prevRowCell.parentElement.getAttribute('aria-rowindex')) - 1;\n            cellStyle = this.parent.getCellStyleValue(['borderBottom', 'border'], [prevRowIdx, colIdx]);\n            if (!(cellStyle.borderBottom || cellStyle.border)) {\n                prevRowCell.style.borderBottom = '';\n            }\n        }\n        var prevColCell = element.previousElementSibling;\n        if (prevColCell && prevColCell.style.borderRight) {\n            colIdx = Number(prevColCell.getAttribute('aria-colindex')) - 1;\n            cellStyle = this.parent.getCellStyleValue(['borderRight', 'border'], [rowIdx, colIdx]);\n            if (!(cellStyle.borderRight || cellStyle.border)) {\n                prevColCell.style.borderRight = '';\n            }\n        }\n    };\n    /** @hidden */\n    CellRenderer.prototype.refreshRange = function (range) {\n        var sheet = this.parent.getActiveSheet();\n        var cRange = range.slice();\n        if (inView(this.parent, cRange, true)) {\n            for (var i = cRange[0]; i <= cRange[2]; i++) {\n                if (isHiddenRow(sheet, i)) {\n                    continue;\n                }\n                for (var j = cRange[1]; j <= cRange[3]; j++) {\n                    var cell = this.parent.getCell(i, j);\n                    if (cell) {\n                        this.update({ rowIdx: i, colIdx: j, td: cell, cell: getCell(i, j, sheet), lastCell: j === cRange[3], isRefresh: true, isHeightCheckNeeded: true, manualUpdate: true, first: '' });\n                        this.parent.notify(renderFilterCell, { td: cell, rowIndex: i, colIndex: j });\n                    }\n                }\n            }\n        }\n    };\n    CellRenderer.prototype.refresh = function (rowIdx, colIdx, lastCell, element) {\n        var sheet = this.parent.getActiveSheet();\n        if (!element && (isHiddenRow(sheet, rowIdx) || isHiddenCol(sheet, colIdx))) {\n            return;\n        }\n        if (element || !this.parent.scrollSettings.enableVirtualization || (rowIdx >= this.parent.viewport.topIndex && rowIdx <=\n            this.parent.viewport.bottomIndex && colIdx >= this.parent.viewport.leftIndex && colIdx <=\n            this.parent.viewport.rightIndex)) {\n            var cell = element || this.parent.getCell(rowIdx, colIdx);\n            this.update({ rowIdx: rowIdx, colIdx: colIdx, td: cell, cell: getCell(rowIdx, colIdx, sheet), lastCell: lastCell, isRefresh: true, isHeightCheckNeeded: true,\n                manualUpdate: true, first: '' });\n            this.parent.notify(renderFilterCell, { td: cell, rowIndex: rowIdx, colIndex: colIdx });\n        }\n    };\n    CellRenderer.prototype.updateView = function (args) {\n        this.refreshRange(args.indexes);\n    };\n    return CellRenderer;\n}());\nexport { CellRenderer };\n","import { initialLoad, ribbon, formulaBar, beforeVirtualContentLoaded, setAriaOptions, getSiblingsHeight } from '../common/index';\nimport { SheetRender, RowRenderer, CellRenderer } from './index';\nimport { remove } from '@syncfusion/ej2-base';\nimport { getSheetName, getRowsHeight, getColumnsWidth } from '../../workbook/base/index';\nimport { getCellAddress, getCellIndexes, workbookFormulaOperation } from '../../workbook/common/index';\nimport { dataRefresh, sheetTabs, onContentScroll, deInitProperties, beforeDataBound, isReact } from '../common/index';\nimport { spreadsheetDestroyed, isFormulaBarEdit, editOperation, renderReactTemplates } from '../common/index';\n/**\n * Render module is used to render the spreadsheet\n * @hidden\n */\nvar Render = /** @class */ (function () {\n    function Render(parent) {\n        this.parent = parent;\n        this.addEventListener();\n    }\n    Render.prototype.render = function () {\n        this.parent.activeSheetIndex = this.parent.skipHiddenSheets(this.parent.activeSheetIndex);\n        if (!this.parent.isMobileView()) {\n            this.parent.notify(ribbon, null);\n            this.parent.notify(formulaBar, null);\n        }\n        var sheetPanel = this.parent.createElement('div', {\n            id: this.parent.element.id + '_sheet_panel', className: 'e-sheet-panel'\n        });\n        if (this.parent.enableRtl) {\n            sheetPanel.classList.add('e-rtl');\n        }\n        this.parent.element.appendChild(sheetPanel);\n        if (this.parent.showSheetTabs) {\n            this.parent.notify(sheetTabs, null);\n        }\n        else { // for formula calculation\n            var sheetName = getSheetName(this.parent, 0);\n            var arg = { action: 'addSheet', sheetName: 'Sheet1', index: 1, visibleName: sheetName };\n            this.parent.notify(workbookFormulaOperation, arg);\n            this.parent.notify(workbookFormulaOperation, { action: 'initiateDefinedNames' });\n        }\n        if (this.parent.isMobileView()) {\n            this.parent.notify(formulaBar, null);\n            this.parent.notify(ribbon, null);\n        }\n        this.setSheetPanelSize();\n        this.renderSheet(sheetPanel);\n        this.checkTopLeftCell(true);\n    };\n    Render.prototype.checkTopLeftCell = function (initLoad) {\n        var sheet = this.parent.getActiveSheet();\n        if (!this.parent.scrollSettings.enableVirtualization || sheet.topLeftCell === 'A1') {\n            this.refreshUI({ rowIndex: 0, colIndex: 0, refresh: 'All' }, null, initLoad);\n        }\n        else {\n            var indexes = getCellIndexes(sheet.topLeftCell);\n            var top_1 = indexes[0] ? getRowsHeight(sheet, 0, indexes[0] - 1) : 0;\n            var left = indexes[1] ? getColumnsWidth(sheet, 0, indexes[1] - 1) : 0;\n            this.parent.notify(onContentScroll, { scrollLeft: left, scrollTop: top_1, preventScroll: true });\n            var threshold = this.parent.getThreshold('row');\n            var rowIndex = indexes[0] > threshold ? indexes[0] - threshold : 0;\n            threshold = this.parent.getThreshold('col');\n            var colIndex = indexes[1] > threshold ? indexes[1] - threshold : 0;\n            this.refreshUI({ rowIndex: rowIndex, colIndex: colIndex, refresh: 'All', top: top_1, left: left });\n        }\n    };\n    Render.prototype.renderSheet = function (panel) {\n        if (panel === void 0) { panel = document.getElementById(this.parent.element.id + '_sheet_panel'); }\n        panel.appendChild(this.parent.createElement('div', { className: 'e-sheet', id: this.parent.element.id + '_sheet' }));\n        this.parent.serviceLocator.getService('sheet').renderPanel();\n    };\n    Render.prototype.refreshUI = function (args, address, initLoad) {\n        var _this = this;\n        var sheetModule = this.parent.serviceLocator.getService('sheet');\n        var sheet = this.parent.getActiveSheet();\n        var sheetName = getSheetName(this.parent);\n        this.parent.showSpinner();\n        if (!address) {\n            if (this.parent.scrollSettings.enableVirtualization) {\n                var lastRow = args.rowIndex + this.parent.viewport.rowCount + (this.parent.getThreshold('row') * 2);\n                var count = sheet.rowCount - 1;\n                if (this.parent.scrollSettings.isFinite && lastRow > count) {\n                    lastRow = count;\n                }\n                var lastCol = args.colIndex + this.parent.viewport.colCount + (this.parent.getThreshold('col') * 2);\n                count = sheet.colCount - 1;\n                if (this.parent.scrollSettings.isFinite && lastCol > count) {\n                    lastCol = count;\n                }\n                var indexes = this.parent.skipHidden(args.rowIndex, lastRow);\n                var startRow = args.rowIndex;\n                if (args.rowIndex !== indexes[0]) {\n                    var topLeftCell = getCellIndexes(sheet.topLeftCell);\n                    if (topLeftCell[0] === args.rowIndex) {\n                        this.parent.setSheetPropertyOnMute(sheet, 'topLeftCell', getCellAddress(indexes[0], topLeftCell[1]));\n                    }\n                    args.rowIndex = indexes[0];\n                }\n                lastRow = indexes[1];\n                indexes = this.parent.skipHidden(args.colIndex, lastCol, 'columns');\n                var startCol = args.colIndex;\n                if (args.colIndex !== indexes[0]) {\n                    var topLeftCell = getCellIndexes(sheet.topLeftCell);\n                    if (topLeftCell[1] === args.colIndex) {\n                        this.parent.setSheetPropertyOnMute(sheet, 'topLeftCell', getCellAddress(topLeftCell[0], indexes[0]));\n                    }\n                    args.colIndex = indexes[0];\n                }\n                lastCol = indexes[1];\n                this.parent.viewport.topIndex = args.rowIndex;\n                this.parent.viewport.bottomIndex = lastRow;\n                this.parent.viewport.leftIndex = args.colIndex;\n                this.parent.viewport.rightIndex = lastCol;\n                address = getCellAddress(startRow, startCol) + \":\" + getCellAddress(lastRow, lastCol);\n            }\n            else {\n                address = \"A1:\" + getCellAddress(sheet.rowCount - 1, sheet.colCount - 1);\n            }\n        }\n        if (args.refresh === 'All') {\n            this.parent.trigger(beforeDataBound, {});\n        }\n        setAriaOptions(this.parent.getMainContent(), { busy: true });\n        var sheetsLen = this.parent.sheets.length;\n        this.parent.getData(sheetName + \"!\" + address).then(function (values) {\n            if (args.refresh === 'All') {\n                if (sheetsLen < _this.parent.sheets.length) {\n                    return;\n                }\n                var sheetIdx = _this.parent.sheets.indexOf(sheet);\n                if (sheetIdx === -1 || sheetIdx !== _this.parent.activeSheetIndex) {\n                    if (sheetIdx > -1) {\n                        _this.checkTopLeftCell();\n                    }\n                    return;\n                }\n            }\n            var indexes = [args.rowIndex, args.colIndex].concat(getCellIndexes(address.split(':')[1]));\n            switch (args.refresh) {\n                case 'All':\n                    sheetModule.renderTable({ cells: values, indexes: indexes, top: args.top, left: args.left, initLoad: initLoad });\n                    break;\n                case 'Row':\n                    sheetModule.refreshRowContent({ cells: values, indexes: indexes, skipUpdateOnFirst: args.skipUpdateOnFirst });\n                    var isEdit = false;\n                    var arg = { isEdit: isEdit };\n                    _this.parent.notify(isFormulaBarEdit, arg);\n                    if (arg.isEdit) {\n                        _this.parent.notify(editOperation, { action: 'startEdit', refreshCurPos: false });\n                    }\n                    break;\n                case 'Column':\n                    sheetModule.refreshColumnContent({ cells: values, indexes: indexes, skipUpdateOnFirst: args.skipUpdateOnFirst });\n                    break;\n                case 'RowPart':\n                    sheetModule.updateRowContent({\n                        cells: values, indexes: indexes, direction: args.direction, skipUpdateOnFirst: args.skipUpdateOnFirst\n                    });\n                    break;\n                case 'ColumnPart':\n                    sheetModule.updateColContent({\n                        cells: values, indexes: indexes, direction: args.direction, skipUpdateOnFirst: args.skipUpdateOnFirst\n                    });\n                    break;\n            }\n            if (_this.parent[isReact]) {\n                _this.parent[renderReactTemplates]();\n            }\n        });\n        this.parent.notify(beforeVirtualContentLoaded, { refresh: args.refresh });\n    };\n    Render.prototype.removeSheet = function () {\n        remove(document.getElementById(this.parent.element.id + '_sheet'));\n    };\n    /**\n     * Refresh the active sheet\n     */\n    Render.prototype.refreshSheet = function () {\n        this.removeSheet();\n        this.renderSheet();\n        this.parent.notify(deInitProperties, {});\n        this.checkTopLeftCell();\n    };\n    /**\n     * Used to set sheet panel size.\n     */\n    Render.prototype.setSheetPanelSize = function () {\n        var panel = document.getElementById(this.parent.element.id + '_sheet_panel');\n        var offset = this.parent.element.getBoundingClientRect();\n        var height;\n        if (this.parent.height === 'auto') {\n            panel.style.height = '260px';\n            height = 230;\n        }\n        else {\n            height = offset.height - getSiblingsHeight(panel);\n            panel.style.height = height + \"px\";\n            height -= 32;\n        }\n        this.parent.viewport.height = height;\n        this.parent.viewport.width = offset.width - 32;\n        this.parent.viewport.rowCount = this.roundValue(height, 20);\n        this.parent.viewport.colCount = this.roundValue(offset.width, 64);\n    };\n    Render.prototype.roundValue = function (size, threshold) {\n        var value = size / threshold;\n        var roundedValue = Math.round(value);\n        return Math.abs(value - roundedValue) < 0.5 ? roundedValue : roundedValue - 1;\n    };\n    /**\n     * Registing the renderer related services.\n     */\n    Render.prototype.instantiateRenderer = function () {\n        this.parent.serviceLocator.register('cell', new CellRenderer(this.parent));\n        this.parent.serviceLocator.register('row', new RowRenderer(this.parent));\n        this.parent.serviceLocator.register('sheet', new SheetRender(this.parent));\n    };\n    /**\n     * Destroy the Render module.\n     * @return {void}\n     */\n    Render.prototype.destroy = function () {\n        this.removeEventListener();\n        this.parent = null;\n    };\n    Render.prototype.addEventListener = function () {\n        this.parent.on(initialLoad, this.instantiateRenderer, this);\n        this.parent.on(dataRefresh, this.refreshSheet, this);\n        this.parent.on(spreadsheetDestroyed, this.destroy, this);\n    };\n    Render.prototype.removeEventListener = function () {\n        this.parent.off(initialLoad, this.instantiateRenderer);\n        this.parent.off(dataRefresh, this.refreshSheet);\n        this.parent.off(spreadsheetDestroyed, this.destroy);\n    };\n    return Render;\n}());\nexport { Render };\n","import { Dialog as DialogComponent } from '@syncfusion/ej2-popups';\nimport { extend, remove, isNullOrUndefined } from '@syncfusion/ej2-base';\nimport { locale } from '../common/index';\n/**\n * Dialog Service.\n * @hidden\n */\nvar Dialog = /** @class */ (function () {\n    /**\n     * Constructor for initializing dialog service.\n     */\n    function Dialog(parent) {\n        this.parent = parent;\n    }\n    /**\n     * To show dialog.\n     */\n    Dialog.prototype.show = function (dialogModel, cancelBtn) {\n        var _this = this;\n        var btnContent;\n        cancelBtn = isNullOrUndefined(cancelBtn) ? true : false;\n        var closeHandler = dialogModel.close || null;\n        var model = {\n            header: 'Spreadsheet',\n            cssClass: this.parent.cssClass,\n            target: this.parent.element,\n            buttons: []\n        };\n        dialogModel.close = function () {\n            _this.dialogInstance.destroy();\n            remove(_this.dialogInstance.element);\n            _this.dialogInstance = null;\n            if (closeHandler) {\n                closeHandler();\n            }\n        };\n        extend(model, dialogModel);\n        if (cancelBtn) {\n            btnContent = this.parent.serviceLocator.getService(locale).getConstant(model.buttons.length ? 'Cancel' : 'Ok');\n            model.buttons.push({\n                buttonModel: { content: btnContent, isPrimary: model.buttons.length === 0 },\n                click: this.hide.bind(this),\n            });\n        }\n        var div = this.parent.createElement('div');\n        document.body.appendChild(div);\n        this.dialogInstance = new DialogComponent(model);\n        this.dialogInstance.createElement = this.parent.createElement;\n        this.dialogInstance.appendTo(div);\n        this.dialogInstance.refreshPosition();\n    };\n    /**\n     * To hide dialog.\n     */\n    Dialog.prototype.hide = function () {\n        if (this.dialogInstance) {\n            this.dialogInstance.hide();\n        }\n    };\n    /**\n     * To clear private variables.\n     */\n    Dialog.prototype.destroy = function () {\n        this.parent = null;\n    };\n    return Dialog;\n}());\nexport { Dialog };\n","import { completeAction, beginAction } from '../common/index';\nimport { setActionData, updateUndoRedoCollection } from '../common/index';\n/**\n *  Begin and complete events.\n * @hidden\n */\nvar ActionEvents = /** @class */ (function () {\n    /**\n     * Constructor for initializing action begin and action complete services.\n     */\n    function ActionEvents(parent) {\n        this.parent = parent;\n        this.addEventListener();\n        //this.initializeActionBegin();\n        //this.initializeActionComplete();\n    }\n    ActionEvents.prototype.initializeActionBegin = function () {\n        var _this = this;\n        var cellFormat = this.parent.beforeCellFormat;\n        this.parent.beforeCellFormat = function (args) {\n            _this.actionEventHandler({ evtArgs: args, evtFunc: cellFormat, actionType: 'begin', eventType: 'format' });\n        };\n        var beforeOpen = this.parent.beforeOpen;\n        this.parent.beforeOpen = function (args) {\n            _this.actionEventHandler({ evtArgs: args, evtFunc: beforeOpen, actionType: 'begin', eventType: 'beforeOpen' });\n        };\n        var beforeSave = this.parent.beforeSave;\n        this.parent.beforeSave = function (args) {\n            _this.actionEventHandler({ evtArgs: args, evtFunc: beforeSave, actionType: 'begin', eventType: 'beforeSave' });\n        };\n        var beforeSort = this.parent.beforeSort;\n        this.parent.beforeSort = function (args) {\n            _this.actionEventHandler({ evtArgs: args, evtFunc: beforeSort, actionType: 'begin', eventType: 'beforeSort' });\n        };\n    };\n    ActionEvents.prototype.initializeActionComplete = function () {\n        var _this = this;\n        var sortComplete = this.parent.sortComplete;\n        this.parent.sortComplete = function (args) {\n            _this.actionEventHandler({ evtArgs: args, evtFunc: sortComplete, actionType: 'complete', eventType: 'sorting' });\n        };\n        var cellSave = this.parent.cellSave;\n        this.parent.cellSave = function (args) {\n            _this.actionEventHandler({ evtArgs: args, evtFunc: cellSave, actionType: 'complete', eventType: 'cellSave' });\n        };\n    };\n    ActionEvents.prototype.actionEventHandler = function (args) {\n        if (args.evtFunc) {\n            args.evtFunc.apply(this, [args]);\n        }\n        if (args.actionType === 'begin') {\n            this.actionBeginHandler({ eventArgs: args.evtArgs, action: args.eventType });\n        }\n        else {\n            this.actionCompleteHandler({ eventArgs: args.evtArgs, action: args.eventType });\n        }\n    };\n    ActionEvents.prototype.actionBeginHandler = function (args) {\n        this.parent.trigger('actionBegin', { action: args.action, args: args });\n        if (args.action === 'clipboard' || args.action === 'beforeSort' || args.action === 'format' || args.action === 'cellSave'\n            || args.action === 'beforeWrap' || args.action === 'beforeReplace'\n            || args.action === 'beforeClear' || args.action === 'beforeInsertImage' || args.action === 'beforeInsertChart'\n            || args.action === 'filter') {\n            this.parent.notify(setActionData, { args: args });\n        }\n    };\n    ActionEvents.prototype.actionCompleteHandler = function (args) {\n        this.parent.trigger('actionComplete', args);\n        if (args.action !== 'undoRedo' && args.action !== 'gotoSheet') {\n            this.parent.notify(updateUndoRedoCollection, { args: args });\n        }\n    };\n    ActionEvents.prototype.addEventListener = function () {\n        this.parent.on(completeAction, this.actionCompleteHandler, this);\n        this.parent.on(beginAction, this.actionBeginHandler, this);\n    };\n    ActionEvents.prototype.removeEventListener = function () {\n        this.parent.off(completeAction, this.actionCompleteHandler);\n        this.parent.off(beginAction, this.actionBeginHandler);\n    };\n    return ActionEvents;\n}());\nexport { ActionEvents };\n","import { getCellPosition, refreshImgCellObj, refreshChartCellObj } from '../common/index';\nimport { getRangeIndexes, refreshChartSize, focusChartBorder } from '../../workbook/index';\nimport { EventHandler, removeClass, closest } from '@syncfusion/ej2-base';\n/**\n * Specifes to create or modify overlay.\n * @hidden\n */\nvar Overlay = /** @class */ (function () {\n    /**\n     * Constructor for initializing Overlay service.\n     */\n    function Overlay(parent) {\n        this.minHeight = '300px';\n        this.minWidth = '400px';\n        this.isOverlayClicked = false;\n        this.isResizerClicked = false;\n        this.currentWidth = 400;\n        this.currenHeight = 300;\n        this.parent = parent;\n    }\n    /**\n     * To insert a shape.\n     * @hidden\n     */\n    Overlay.prototype.insertOverlayElement = function (id, range, sheetIndex) {\n        var div = this.parent.createElement('div', {\n            id: id,\n            attrs: { 'class': 'e-ss-overlay' },\n            styles: 'width: ' + this.minWidth + ';  height: ' + this.minHeight\n        });\n        var indexes = getRangeIndexes(range);\n        var sheet = this.parent.sheets[sheetIndex];\n        var pos = getCellPosition(sheet, indexes);\n        div.style.top = pos.top + 'px';\n        div.style.left = pos.left + 'px';\n        this.parent.getMainContent().appendChild(div);\n        this.renderResizeHandles(div);\n        this.addEventListener(div);\n        this.originalWidth = parseFloat(getComputedStyle(div, null).getPropertyValue('width').replace('px', ''));\n        this.originalHeight = parseFloat(getComputedStyle(div, null).getPropertyValue('height').replace('px', ''));\n        return div;\n    };\n    Overlay.prototype.addEventListener = function (div) {\n        var overlayElem = div;\n        EventHandler.add(overlayElem, 'mousedown', this.overlayClickHandler, this);\n        EventHandler.add(overlayElem, 'mousemove', this.overlayMouseMoveHandler, this);\n        EventHandler.add(this.parent.getMainContent(), 'mousemove', this.overlayMouseMoveHandler, this);\n        EventHandler.add(document, 'mouseup', this.overlayMouseUpHandler, this);\n    };\n    Overlay.prototype.overlayMouseMoveHandler = function (e) {\n        var target = e.target;\n        var overlayElem = document.getElementsByClassName('e-ss-overlay-active')[0];\n        if (this.isOverlayClicked && this.isResizerClicked) {\n            switch (this.resizer) {\n                case 'e-ss-overlay-t':\n                    var height1 = Math.max(this.originalMouseY - e.clientY + this.originalHeight, 20);\n                    var top_1 = e.clientY - (this.originalMouseY - this.originalResizeTop);\n                    if (height1 > 180 && top_1 > -1) {\n                        overlayElem.style.height = height1 + 'px';\n                        overlayElem.style.top = top_1 + 'px';\n                        this.resizedReorderTop = top_1; // resized divTop\n                        this.currenHeight = height1;\n                        this.parent.notify(refreshChartSize, {\n                            height: overlayElem.style.height, width: overlayElem.style.width, overlayEle: overlayElem\n                        });\n                    }\n                    break;\n                case 'e-ss-overlay-r':\n                    var width1 = this.originalWidth + (e.pageX - this.originalMouseX);\n                    if (width1 > 180) {\n                        overlayElem.style.width = width1 + 'px';\n                        this.currentWidth = width1;\n                        this.parent.notify(refreshChartSize, {\n                            height: overlayElem.style.height, width: overlayElem.style.width, overlayEle: overlayElem\n                        });\n                    }\n                    break;\n                case 'e-ss-overlay-b':\n                    var height2 = this.originalHeight + (e.pageY - this.originalMouseY);\n                    if (height2 > 180) {\n                        overlayElem.style.height = height2 + 'px';\n                        this.currenHeight = height2;\n                        this.parent.notify(refreshChartSize, {\n                            height: overlayElem.style.height, width: overlayElem.style.width, overlayEle: overlayElem\n                        });\n                    }\n                    break;\n                case 'e-ss-overlay-l':\n                    var width2 = Math.max(this.originalMouseX - e.clientX + this.originalWidth, 20);\n                    var left = e.clientX - (this.originalMouseX - this.originalResizeLeft);\n                    if (width2 > 180 && left > -1) {\n                        overlayElem.style.width = width2 + 'px';\n                        overlayElem.style.left = left + 'px';\n                        this.resizedReorderLeft = left; //resized divLeft\n                        this.currentWidth = width2;\n                        this.parent.notify(refreshChartSize, {\n                            height: overlayElem.style.height, width: overlayElem.style.width, overlayEle: overlayElem\n                        });\n                    }\n                    break;\n            }\n        }\n        else if (this.isOverlayClicked) {\n            var posX = e.clientX;\n            var posY = e.clientY;\n            var aX = posX - this.diffX;\n            var aY = posY - this.diffY;\n            if (aX > -1) {\n                overlayElem.style.left = aX + 'px';\n            }\n            if (aY > -1) {\n                overlayElem.style.top = aY + 'px';\n            }\n            this.resizedReorderLeft = aX; //resized divLeft\n            this.resizedReorderTop = aY; // resized divTop\n        }\n    };\n    Overlay.prototype.overlayMouseUpHandler = function (e) {\n        if (this.parent.getActiveSheet().isProtected) {\n            return;\n        }\n        this.isOverlayClicked = false;\n        this.isResizerClicked = false;\n        var elem = e.target;\n        if (!elem.classList.contains('e-ss-overlay')) {\n            elem = closest(e.target, '.e-datavisualization-chart') ?\n                closest(e.target, '.e-datavisualization-chart') : elem;\n        }\n        var eventArgs = {\n            prevTop: this.originalReorderTop, prevLeft: this.originalReorderLeft,\n            currentTop: this.resizedReorderTop ? this.resizedReorderTop : this.originalReorderTop, currentLeft: this.resizedReorderLeft ?\n                this.resizedReorderLeft : this.originalReorderLeft, id: elem.id, currentHeight: this.currenHeight,\n            currentWidth: this.currentWidth, requestType: 'imageRefresh',\n            prevHeight: this.originalHeight, prevWidth: this.originalWidth\n        };\n        if (elem.id.indexOf('overlay') > 0 || elem.classList.contains('e-ss-resizer')) {\n            if (this.originalReorderTop !== this.resizedReorderTop || this.originalReorderLeft !== this.resizedReorderLeft) {\n                eventArgs.id = elem.id;\n                if (elem.classList.contains('e-datavisualization-chart')) {\n                    eventArgs.requestType = 'chartRefresh';\n                    this.parent.notify(refreshChartCellObj, eventArgs);\n                }\n                this.parent.notify(refreshImgCellObj, eventArgs);\n                this.resizedReorderTop = this.originalReorderTop;\n                this.resizedReorderLeft = this.originalReorderLeft;\n            }\n            else if (this.currenHeight !== this.originalHeight || this.originalWidth !== this.currentWidth) {\n                eventArgs.id = elem.id.indexOf('overlay') > 0 ? elem.id : elem.parentElement.id;\n                if (elem.classList.contains('e-datavisualization-chart')) {\n                    eventArgs.requestType = 'chartRefresh';\n                    this.parent.notify(refreshChartCellObj, eventArgs);\n                }\n                this.parent.notify(refreshImgCellObj, eventArgs);\n                this.originalHeight = this.currenHeight;\n                this.originalWidth = this.currentWidth;\n            }\n        }\n    };\n    Overlay.prototype.overlayClickHandler = function (e) {\n        if (this.parent.getActiveSheet().isProtected) {\n            return;\n        }\n        this.isOverlayClicked = true;\n        var target = e.target;\n        var overlayElem = e.target;\n        if (!target.classList.contains('e-ss-overlay')) {\n            overlayElem = target.parentElement;\n            if (closest(e.target, '.e-datavisualization-chart')) {\n                overlayElem = closest(e.target, '.e-datavisualization-chart');\n                this.currentWidth = parseFloat(getComputedStyle(overlayElem, null).getPropertyValue('width').replace('px', ''));\n                this.currenHeight = parseFloat(getComputedStyle(overlayElem, null).getPropertyValue('height').replace('px', ''));\n            }\n        }\n        this.originalReorderLeft = parseInt(overlayElem.style.left, 10); //divLeft\n        this.originalReorderTop = parseInt(overlayElem.style.top, 10); // divTop\n        this.resizedReorderLeft = parseInt(overlayElem.style.left, 10); //resized divLeft\n        this.resizedReorderTop = parseInt(overlayElem.style.top, 10); // resized divTop\n        this.originalResizeTop = this.originalReorderTop;\n        this.originalResizeLeft = this.originalReorderLeft;\n        this.originalMouseX = e.clientX; // posX\n        this.originalMouseY = e.clientY; // posY\n        this.diffX = this.originalMouseX - this.originalReorderLeft;\n        this.diffY = this.originalMouseY - this.originalReorderTop;\n        var actOverlayElem = document.getElementsByClassName('e-ss-overlay-active')[0];\n        if (actOverlayElem) {\n            removeClass([actOverlayElem], 'e-ss-overlay-active');\n        }\n        document.getElementById(overlayElem.id).classList.add('e-ss-overlay-active');\n        if (target.classList.contains('e-ss-resizer')) {\n            this.resizer = target.classList[0];\n            this.originalWidth = parseFloat(getComputedStyle(overlayElem, null).getPropertyValue('width').replace('px', ''));\n            this.originalHeight = parseFloat(getComputedStyle(overlayElem, null).getPropertyValue('height').replace('px', ''));\n            this.isResizerClicked = true;\n        }\n        if (overlayElem.classList.contains('e-datavisualization-chart')) {\n            this.parent.notify(focusChartBorder, { id: overlayElem.id });\n        }\n    };\n    Overlay.prototype.renderResizeHandles = function (div) {\n        var handles = ['e-ss-overlay-t', 'e-ss-overlay-r', 'e-ss-overlay-b', 'e-ss-overlay-l'];\n        var i = 0;\n        var handleElem;\n        var overlay = div;\n        while (handles.length > i) {\n            handleElem = this.parent.createElement('div', {\n                attrs: { 'class': handles[i] + ' ' + 'e-ss-resizer' },\n                styles: 'width: 8px; height: 8px; border-radius: 4px;'\n            });\n            overlay.appendChild(handleElem);\n            i++;\n        }\n    };\n    Overlay.prototype.removeEventListener = function () {\n        var overlayElem = document.getElementById(this.parent.element.id + '_overlay');\n        EventHandler.remove(overlayElem, 'mousedown', this.overlayClickHandler);\n        EventHandler.remove(overlayElem, 'mousemove', this.overlayMouseMoveHandler);\n        EventHandler.remove(this.parent.getMainContent(), 'mousemove', this.overlayMouseMoveHandler);\n        EventHandler.remove(document, 'mouseup', this.overlayMouseUpHandler);\n    };\n    /**\n     * To clear private variables.\n     */\n    Overlay.prototype.destroy = function () {\n        this.removeEventListener();\n        this.parent = null;\n    };\n    return Overlay;\n}());\nexport { Overlay };\n","var __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    }\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\n/// <reference path='../../workbook/base/workbook-model.d.ts'/>\nimport { Property, NotifyPropertyChanges, Event, isUndefined } from '@syncfusion/ej2-base';\nimport { addClass, removeClass, Complex, formatUnit, L10n, isNullOrUndefined, Browser } from '@syncfusion/ej2-base';\nimport { detach, select, closest, setStyleAttribute, EventHandler } from '@syncfusion/ej2-base';\nimport { initialLoad, mouseDown, spreadsheetDestroyed, keyUp, clearViewer, blankWorkbook } from '../common/index';\nimport { hideShow, performUndoRedo, overlay, createImageElement, deleteImage } from '../common/index';\nimport { sheetNameUpdate, updateUndoRedoCollection, getUpdateUsingRaf, setAutoFit, created } from '../common/index';\nimport { actionEvents, keyDown, enableFileMenuItems, hideToolbarItems, updateAction } from '../common/index';\nimport { colWidthChanged, rowHeightChanged, hideRibbonTabs, addFileMenuItems, getSiblingsHeight } from '../common/index';\nimport { defaultLocale, locale, setAriaOptions, setResize, initiateFilterUI, clearFilter, clearTemplate, isReact } from '../common/index';\nimport { ribbon, formulaBar, sheetTabs, formulaOperation, addRibbonTabs } from '../common/index';\nimport { addContextMenuItems, removeContextMenuItems, enableContextMenuItems, selectRange, addToolbarItems } from '../common/index';\nimport { cut, copy, paste, dialog, editOperation, activeSheetChanged, refreshFormulaDatasource } from '../common/index';\nimport { Render } from '../renderer/render';\nimport { Scroll, VirtualScroll, Edit, CellFormat, Selection, KeyboardNavigation, KeyboardShortcut, WrapText } from '../actions/index';\nimport { Clipboard, ShowHide, UndoRedo, SpreadsheetHyperlink, Resize, Insert, Delete, FindAndReplace, Merge } from '../actions/index';\nimport { ProtectSheet } from '../actions/index';\nimport { click, hideFileMenuItems } from '../common/index';\nimport { Dialog, ActionEvents, Overlay } from '../services/index';\nimport { ServiceLocator } from '../../workbook/services/index';\nimport { getColumnsWidth, getSheetIndex, WorkbookHyperlink } from './../../workbook/index';\nimport { getCellAddress } from './../../workbook/common/index';\nimport { activeCellChanged, afterHyperlinkCreate, getColIndex } from './../../workbook/index';\nimport { WorkbookInsert, WorkbookDelete, WorkbookMerge } from './../../workbook/index';\nimport { getSheetNameFromAddress, DataBind, beforeHyperlinkCreate } from './../../workbook/index';\nimport { sortComplete, dataSourceChanged } from './../../workbook/index';\nimport { getSheetIndexFromId, WorkbookEdit, WorkbookOpen, WorkbookSave, WorkbookCellFormat, WorkbookSort } from './../../workbook/index';\nimport { findKeyUp } from './../../workbook/index';\nimport { Workbook } from '../../workbook/base/workbook';\nimport { getRequiredModules, ScrollSettings, enableToolbarItems } from '../common/index';\nimport { SelectionSettings, getStartEvent, enableRibbonTabs } from '../common/index';\nimport { createSpinner, showSpinner, hideSpinner } from '@syncfusion/ej2-popups';\nimport { setRowHeight, getRowsHeight, getColumnWidth, getRowHeight } from './../../workbook/base/index';\nimport { getRangeIndexes, getIndexesFromAddress, getCellIndexes, WorkbookNumberFormat, WorkbookFormula } from '../../workbook/index';\nimport { Ribbon, FormulaBar, SheetTabs, Open, ContextMenu, Save, NumberFormat, Formula } from '../integrations/index';\nimport { Sort, Filter, SpreadsheetImage, SpreadsheetChart } from '../integrations/index';\nimport { isNumber, getColumn, WorkbookFilter } from '../../workbook/index';\nimport { DataValidation } from '../actions/index';\nimport { WorkbookDataValidation, WorkbookConditionalFormat, WorkbookFindAndReplace } from '../../workbook/actions/index';\nimport { findAllValues } from './../../workbook/common/index';\nimport { ConditionalFormatting } from '../actions/conditional-formatting';\nimport { WorkbookImage, WorkbookChart } from '../../workbook/integrations/index';\nimport { WorkbookProtectSheet } from '../../workbook/actions/index';\n/**\n * Represents the Spreadsheet component.\n * ```html\n * <div id='spreadsheet'></div>\n * <script>\n *  var spreadsheetObj = new Spreadsheet();\n *  spreadsheetObj.appendTo('#spreadsheet');\n * </script>\n * ```\n */\nvar Spreadsheet = /** @class */ (function (_super) {\n    __extends(Spreadsheet, _super);\n    /**\n     * Constructor for creating the widget.\n     * @param  {SpreadsheetModel} options? - Configures Spreadsheet options.\n     * @param  {string|HTMLElement} element? - Element to render Spreadsheet.\n     */\n    function Spreadsheet(options, element) {\n        var _this = _super.call(this, options) || this;\n        /** @hidden */\n        _this.viewport = {\n            rowCount: 0, colCount: 0, height: 0, topIndex: 0, leftIndex: 0, width: 0,\n            bottomIndex: 0, rightIndex: 0\n        };\n        _this.needsID = true;\n        Spreadsheet_1.Inject(Ribbon, FormulaBar, SheetTabs, Selection, Edit, KeyboardNavigation, KeyboardShortcut, Clipboard, DataBind, Open, ContextMenu, Save, NumberFormat, CellFormat, Formula, WrapText, WorkbookEdit, WorkbookOpen, WorkbookSave, WorkbookCellFormat, WorkbookNumberFormat, WorkbookFormula, Sort, WorkbookSort, Resize, UndoRedo, WorkbookFilter, Filter, SpreadsheetHyperlink, WorkbookHyperlink, Insert, Delete, WorkbookInsert, WorkbookDelete, DataValidation, WorkbookDataValidation, ProtectSheet, WorkbookProtectSheet, FindAndReplace, WorkbookFindAndReplace, Merge, WorkbookMerge, SpreadsheetImage, ConditionalFormatting, WorkbookImage, WorkbookConditionalFormat, SpreadsheetChart, WorkbookChart);\n        if (element) {\n            _this.appendTo(element);\n        }\n        return _this;\n    }\n    Spreadsheet_1 = Spreadsheet;\n    /**\n     * To get cell element.\n     * @returns HTMLElement\n     * @hidden\n     */\n    Spreadsheet.prototype.getCell = function (rowIndex, colIndex, row) {\n        colIndex = this.getViewportIndex(colIndex, true);\n        if (!row) {\n            row = this.getRow(rowIndex);\n        }\n        return row ? row.cells[colIndex] : row;\n    };\n    /**\n     * Get cell element.\n     * @returns HTMLTableRowElement\n     * @hidden\n     */\n    Spreadsheet.prototype.getRow = function (index, table) {\n        index = this.getViewportIndex(index);\n        table = table || this.getContentTable();\n        return table ? table.rows[index] : null;\n    };\n    /**\n     * To get hidden row/column count between two specified index.\n     * Set `layout` as `columns` if you want to get column hidden count.\n     * @hidden\n     */\n    Spreadsheet.prototype.hiddenCount = function (startIndex, endIndex, layout) {\n        if (layout === void 0) { layout = 'rows'; }\n        var sheet = this.getActiveSheet();\n        var count = 0;\n        for (var i = startIndex; i <= endIndex; i++) {\n            if ((sheet[layout])[i] && (sheet[layout])[i].hidden) {\n                count++;\n            }\n        }\n        return count;\n    };\n    /**\n     * To get row/column viewport index.\n     * @hidden\n     */\n    Spreadsheet.prototype.getViewportIndex = function (index, isCol) {\n        if (this.scrollSettings.enableVirtualization) {\n            if (isCol) {\n                index -= this.hiddenCount(this.viewport.leftIndex, index, 'columns');\n                index -= this.viewport.leftIndex;\n            }\n            else {\n                index -= this.hiddenCount(this.viewport.topIndex, index);\n                index -= this.viewport.topIndex;\n            }\n        }\n        return index;\n    };\n    /**\n     * To initialize the services;\n     * @returns void\n     * @hidden\n     */\n    Spreadsheet.prototype.preRender = function () {\n        _super.prototype.preRender.call(this);\n        this.serviceLocator = new ServiceLocator;\n        this.initServices();\n    };\n    Spreadsheet.prototype.initServices = function () {\n        this.serviceLocator.register(locale, new L10n(this.getModuleName(), defaultLocale, this.locale));\n        this.serviceLocator.register(dialog, new Dialog(this));\n        this.serviceLocator.register(actionEvents, new ActionEvents(this));\n        this.serviceLocator.register(overlay, new Overlay(this));\n    };\n    /**\n     * To Initialize the component rendering.\n     * @returns void\n     * @hidden\n     */\n    Spreadsheet.prototype.render = function () {\n        _super.prototype.render.call(this);\n        this.element.setAttribute('tabindex', '0');\n        setAriaOptions(this.element, { role: 'grid' });\n        this.renderModule = new Render(this);\n        this.notify(initialLoad, null);\n        this.renderSpreadsheet();\n        this.wireEvents();\n        if (this.created) {\n            if (this[created].observers) {\n                if (this[created].observers.length > 0) {\n                    this.createdHandler = { observers: this[created].observers };\n                    this[created].observers = [];\n                }\n            }\n            else {\n                this.createdHandler = this.created;\n                this.setProperties({ created: undefined }, true);\n            }\n        }\n    };\n    Spreadsheet.prototype.renderSpreadsheet = function () {\n        if (this.cssClass) {\n            addClass([this.element], this.cssClass.split(' '));\n        }\n        this.setHeight();\n        this.setWidth();\n        createSpinner({ target: this.element }, this.createElement);\n        if (this.isMobileView() && this.cssClass.indexOf('e-mobile-view') === -1) {\n            this.element.classList.add('e-mobile-view');\n        }\n        this.sheetModule = this.serviceLocator.getService('sheet');\n        if (this.allowScrolling) {\n            this.scrollModule = new Scroll(this);\n        }\n        if (this.scrollSettings.enableVirtualization) {\n            new VirtualScroll(this);\n        }\n        this.renderModule.render();\n        new ShowHide(this);\n    };\n    /**\n     * By default, Spreadsheet shows the spinner for all its actions. To manually show spinner you this method at your needed time.\n     * {% codeBlock src='spreadsheet/showSpinner/index.md' %}{% endcodeBlock %}\n     * @return {void}\n     */\n    Spreadsheet.prototype.showSpinner = function () {\n        showSpinner(this.element);\n    };\n    /**\n     * To hide showed spinner manually.\n     * {% codeBlock src='spreadsheet/hideSpinner/index.md' %}{% endcodeBlock %}\n     * @return {void}\n     */\n    Spreadsheet.prototype.hideSpinner = function () {\n        hideSpinner(this.element);\n    };\n    /**\n     * To protect the particular sheet.\n     * {% codeBlock src='spreadsheet/protectSheet/index.md' %}{% endcodeBlock %}\n     * @param {number | string} sheet - Specifies the sheet to protect.\n     * @param {ProtectSettingsModel} protectSettings - Specifies the protect sheet options.\n     * @default { selectCells: 'false', formatCells: 'false', formatRows: 'false', formatColumns:'false', insertLink:'false' }\n     * @return {void}\n     */\n    Spreadsheet.prototype.protectSheet = function (sheet, protectSettings) {\n        if (typeof (sheet) === 'string') {\n            sheet = getSheetIndex(this, sheet);\n        }\n        if (sheet) {\n            this.setSheetPropertyOnMute(this.sheets[sheet], 'isProtected', true);\n            this.setSheetPropertyOnMute(this.sheets[sheet], 'protectSettings', protectSettings);\n        }\n        sheet = this.getActiveSheet().index;\n        this.setSheetPropertyOnMute(this.getActiveSheet(), 'isProtected', true);\n        _super.prototype.protectSheet.call(this, sheet, protectSettings);\n    };\n    /**\n     * To unprotect the particular sheet.\n     * {% codeBlock src='spreadsheet/unprotectSheet/index.md' %}{% endcodeBlock %}\n     * @param {number | string} sheet - Specifies the sheet to Unprotect.\n     * @return {void}\n     */\n    Spreadsheet.prototype.unprotectSheet = function (sheet) {\n        if (typeof (sheet) === 'string') {\n            sheet = getSheetIndex(this, sheet);\n        }\n        if (sheet) {\n            this.sheets[sheet].isProtected = false;\n        }\n        else {\n            this.getActiveSheet().isProtected = false;\n        }\n        _super.prototype.unprotectSheet.call(this, sheet);\n    };\n    /**\n     * To find the specified cell value.\n     * {% codeBlock src='spreadsheet/find/index.md' %}{% endcodeBlock %}\n     * @param {FindOptions} args - Specifies the replace value with find args to replace specified cell value.\n     * @param {string} args.value - Specifies the value to be find.\n     * @param {FindModeType} args.mode - Specifies the value to be find within sheet or workbook.\n     * @param {string} args.searchBy - Specifies the value to be find by row or column.\n     * @param {boolean} args.isCSen - Specifies the find match with case sensitive or not.\n     * @param {boolean} args.isEMatch - Specifies the find match with entire match or not.\n     * @param {string} args.findOpt - Specifies the next or previous find match.\n     * @param {number} args.sheetIndex - Specifies the current sheet to find.\n     * @default { mode: 'Sheet', searchBy: 'By Row', isCSen: 'false', isEMatch:'false' }\n     * @return {void}\n     */\n    Spreadsheet.prototype.find = function (args) {\n        _super.prototype.findHandler.call(this, args);\n    };\n    /**\n     * To replace the specified cell value.\n     * {% codeBlock src='spreadsheet/replace/index.md' %}{% endcodeBlock %}\n     * @param {FindOptions} args - Specifies the replace value with find args to replace specified cell value.\n     * @param {string} args.replaceValue - Specifies the replacing value.\n     * @param {string} args.replaceBy - Specifies the value to be replaced for one or all.\n     * @param {string} args.value - Specifies the value to be replaced\n     * @return {void}\n     */\n    Spreadsheet.prototype.replace = function (args) {\n        args = {\n            value: args.value, mode: args.mode ? args.mode : 'Sheet', isCSen: args.isCSen ? args.isCSen : false,\n            isEMatch: args.isEMatch ? args.isEMatch : false, searchBy: args.searchBy ? args.searchBy : 'By Row',\n            replaceValue: args.replaceValue, replaceBy: args.replaceBy,\n            sheetIndex: args.sheetIndex ? args.sheetIndex : this.activeSheetIndex, findOpt: args.findOpt ? args.findOpt : ''\n        };\n        _super.prototype.replaceHandler.call(this, args);\n    };\n    /**\n     * To Find All the Match values Address within Sheet or Workbook.\n     * {% codeBlock src='spreadsheet/findAll/index.md' %}{% endcodeBlock %}\n     * @param {string} value - Specifies the value to find.\n     * @param {FindModeType} mode - Specifies the value to be find within Sheet/Workbook.\n     * @param {boolean} isCSen - Specifies the find match with case sensitive or not.\n     * @param {boolean} isEMatch - Specifies the find match with entire match or not.\n     * @param {number} sheetIndex - Specifies the sheetIndex. If not specified, it will consider the active sheet.\n     * @return {string[]}\n     */\n    Spreadsheet.prototype.findAll = function (value, mode, isCSen, isEMatch, sheetIndex) {\n        mode = mode ? mode : 'Sheet';\n        sheetIndex = sheetIndex ? sheetIndex : this.activeSheetIndex;\n        isCSen = isCSen ? isCSen : false;\n        isEMatch = isEMatch ? isEMatch : false;\n        var findCollection = [];\n        var findAllArguments = {\n            value: value, mode: mode, sheetIndex: sheetIndex, isCSen: isCSen,\n            isEMatch: isEMatch, findCollection: findCollection\n        };\n        this.notify(findAllValues, findAllArguments);\n        return findCollection;\n    };\n    /**\n     * Used to navigate to cell address within workbook.\n     * {% codeBlock src='spreadsheet/goTo/index.md' %}{% endcodeBlock %}\n     * @param {string} address - Specifies the cell address you need to navigate.\n     * You can specify the address in two formats,\n     * `{sheet name}!{cell address}` - Switch to specified sheet and navigate to specified cell address.\n     * `{cell address}` - Navigate to specified cell address with in the active sheet.\n     * @return {void}\n     */\n    Spreadsheet.prototype.goTo = function (address) {\n        if (address.includes('!')) {\n            var addrArr = address.split('!');\n            var idx = getSheetIndex(this, addrArr[0]);\n            if (idx === undefined) {\n                return;\n            }\n            if (idx !== this.activeSheetIndex) {\n                var activeCell = addrArr[1].split(':')[0];\n                this.setSheetPropertyOnMute(this.sheets[idx], 'activeCell', activeCell);\n                this.setSheetPropertyOnMute(this.sheets[idx], 'selectedRange', addrArr[1]);\n                var cellIndex = getCellIndexes(activeCell);\n                if (cellIndex[0] < this.viewport.rowCount) {\n                    cellIndex[0] = 0;\n                }\n                if (cellIndex[1] < this.viewport.colCount) {\n                    cellIndex[1] = 0;\n                }\n                this.setSheetPropertyOnMute(this.sheets[idx], 'topLeftCell', getCellAddress(cellIndex[0], cellIndex[1]));\n                this.activeSheetIndex = idx;\n                this.dataBind();\n                return;\n            }\n        }\n        var indexes = getRangeIndexes(address);\n        var sheet = this.getActiveSheet();\n        var insideDomCount = indexes[0] >= this.viewport.topIndex && indexes[0] < this.viewport.bottomIndex && indexes[1] >=\n            this.viewport.leftIndex && indexes[1] < this.viewport.rightIndex;\n        if (insideDomCount) {\n            this.selectRange(address);\n            var viewportIndexes = getCellIndexes(sheet.topLeftCell);\n            viewportIndexes[2] = viewportIndexes[0] + this.viewport.rowCount;\n            viewportIndexes[3] = viewportIndexes[1] + this.viewport.colCount;\n            if (indexes[0] >= viewportIndexes[0] && indexes[0] < viewportIndexes[2] && indexes[1] >= viewportIndexes[1] &&\n                indexes[1] < viewportIndexes[3]) {\n                return;\n            }\n        }\n        var content = this.getMainContent();\n        var vTrack;\n        var cVTrack;\n        var rVTrack;\n        var offset;\n        var vWidth;\n        var vHeight;\n        var scrollableSize;\n        if (indexes[0] === 0) {\n            offset = getRowsHeight(sheet, 0);\n        }\n        else {\n            offset = getRowsHeight(sheet, 0, indexes[0] - 1);\n            if (this.scrollSettings.enableVirtualization) {\n                scrollableSize = offset + this.getContentTable().getBoundingClientRect().height;\n                vHeight = parseInt(content.querySelector('.e-virtualtrack').style.height, 10);\n                if (scrollableSize > vHeight) {\n                    scrollableSize += 10;\n                    vTrack = content.querySelector('.e-virtualtrack');\n                    vTrack.style.height = scrollableSize + \"px\";\n                    if (sheet.showHeaders) {\n                        rVTrack = this.getRowHeaderContent().querySelector('.e-virtualtrack');\n                        rVTrack.style.height = scrollableSize + \"px\";\n                    }\n                    getUpdateUsingRaf(function () {\n                        vTrack.style.height = vHeight + \"px\";\n                        if (sheet.showHeaders) {\n                            rVTrack.style.height = vHeight + \"px\";\n                        }\n                    });\n                }\n            }\n        }\n        content.scrollTop = offset;\n        if (indexes[1] === 0) {\n            offset = getColumnsWidth(sheet, 0);\n        }\n        else {\n            offset = getColumnsWidth(sheet, 0, indexes[1] - 1);\n            if (this.scrollSettings.enableVirtualization) {\n                scrollableSize = offset + this.getContentTable().getBoundingClientRect().width;\n                vWidth = parseInt(content.querySelector('.e-virtualtrack').style.width, 10);\n                if (scrollableSize > vWidth) {\n                    scrollableSize += 10;\n                    vTrack = content.querySelector('.e-virtualtrack');\n                    vTrack.style.width = scrollableSize + \"px\";\n                    if (sheet.showHeaders) {\n                        cVTrack = this.getColumnHeaderContent().querySelector('.e-virtualtrack');\n                        cVTrack.style.width = scrollableSize + \"px\";\n                    }\n                    getUpdateUsingRaf(function () {\n                        vTrack.style.width = vWidth + \"px\";\n                        if (sheet.showHeaders) {\n                            cVTrack.style.width = vWidth + \"px\";\n                        }\n                    });\n                }\n            }\n        }\n        content.scrollLeft = offset;\n        if (!insideDomCount) {\n            this.selectRange(address);\n        }\n    };\n    /**\n     * Used to resize the Spreadsheet.\n     * {% codeBlock src='spreadsheet/resize/index.md' %}{% endcodeBlock %}\n     */\n    Spreadsheet.prototype.resize = function () {\n        this.renderModule.setSheetPanelSize();\n        if (this.scrollSettings.enableVirtualization) {\n            this.renderModule.refreshSheet();\n        }\n    };\n    /**\n     * To cut the specified cell or cells properties such as value, format, style etc...\n     * {% codeBlock src='spreadsheet/cut/index.md' %}{% endcodeBlock %}\n     * @param {string} address - Specifies the range address to cut.\n     */\n    Spreadsheet.prototype.cut = function (address) {\n        var promise = new Promise(function (resolve, reject) { resolve((function () { })()); });\n        this.notify(cut, address ? {\n            range: getIndexesFromAddress(address),\n            sId: this.sheets[getSheetIndex(this, getSheetNameFromAddress(address))].id,\n            promise: promise\n        } : { promise: promise });\n        return promise;\n    };\n    /**\n     * To copy the specified cell or cells properties such as value, format, style etc...\n     * {% codeBlock src='spreadsheet/copy/index.md' %}{% endcodeBlock %}\n     * @param {string} address - Specifies the range address.\n     */\n    Spreadsheet.prototype.copy = function (address) {\n        var activeAddress = this.getActiveSheet().name + '!' + this.getActiveSheet().activeCell;\n        address = !isNullOrUndefined(address) ? address : activeAddress;\n        var promise = new Promise(function (resolve, reject) { resolve((function () { })()); });\n        this.notify(copy, address ? {\n            range: getIndexesFromAddress(address),\n            sId: this.sheets[getSheetIndex(this, getSheetNameFromAddress(address))].id,\n            promise: promise\n        } : { promise: promise });\n        return promise;\n    };\n    /**\n     * This method is used to paste the cut or copied cells in to specified address.\n     * {% codeBlock src='spreadsheet/paste/index.md' %}{% endcodeBlock %}\n     * @param {string} address - Specifies the cell or range address.\n     * @param {PasteSpecialType} type - Specifies the type of paste.\n     */\n    Spreadsheet.prototype.paste = function (address, type) {\n        this.notify(paste, {\n            range: getIndexesFromAddress(address), sIdx: getSheetIndex(this, getSheetNameFromAddress(address)),\n            type: type, isAction: false, isInternal: true\n        });\n    };\n    /**\n     * To update the action which need to perform.\n     * {% codeBlock src='spreadsheet/updateAction/index.md' %}{% endcodeBlock %}\n     * @param {string} options - It describes an action and event args to perform.\n     * @param {string} options.action - specifies an action.\n     * @param {string} options.eventArgs - specifies an args to perform an action.\n     */\n    Spreadsheet.prototype.updateAction = function (options) {\n        updateAction(options, this);\n    };\n    Spreadsheet.prototype.setHeight = function () {\n        if (this.height.toString().indexOf('%') > -1) {\n            this.element.style.minHeight = '400px';\n        }\n        this.element.style.height = formatUnit(this.height);\n    };\n    Spreadsheet.prototype.setWidth = function () {\n        if (this.width.toString().indexOf('%') > -1 || this.width === 'auto') {\n            this.element.style.minWidth = '300px';\n        }\n        this.element.style.width = formatUnit(this.width);\n    };\n    /**\n     * Set the width of column.\n     * {% codeBlock src='spreadsheet/setColWidth/index.md' %}{% endcodeBlock %}\n     * @param {number} width\n     * @param {number} colIndex\n     * @param {number} sheetIndex\n     */\n    Spreadsheet.prototype.setColWidth = function (width, colIndex, sheetIndex) {\n        if (width === void 0) { width = 64; }\n        if (colIndex === void 0) { colIndex = 0; }\n        var colThreshold = this.getThreshold('col');\n        var lastIdx = this.viewport.leftIndex + this.viewport.colCount + (colThreshold * 2);\n        var sheet = isNullOrUndefined(sheetIndex) ? this.getActiveSheet() : this.sheets[sheetIndex];\n        if (sheet) {\n            var mIndex = colIndex;\n            var colWidth = (typeof width === 'number') ? width + 'px' : width;\n            colIndex = isNullOrUndefined(colIndex) ? getCellIndexes(sheet.activeCell)[1] : colIndex;\n            if (sheet === this.getActiveSheet()) {\n                if (colIndex >= this.viewport.leftIndex && colIndex <= lastIdx) {\n                    if (this.scrollSettings.enableVirtualization) {\n                        colIndex = colIndex - this.viewport.leftIndex;\n                    }\n                    var trgt = this.getColumnHeaderContent().getElementsByClassName('e-header-cell')[colIndex];\n                    var eleWidth = parseInt(this.getMainContent().getElementsByTagName('col')[colIndex].style.width, 10);\n                    var threshold = parseInt(colWidth, 10) - eleWidth;\n                    if (threshold < 0 && eleWidth < -(threshold)) {\n                        getCellIndexes(sheet.activeCell);\n                        threshold = -eleWidth;\n                    }\n                    var oldIdx = parseInt(trgt.getAttribute('aria-colindex'), 10) - 1;\n                    if (this.getActiveSheet() === sheet) {\n                        this.notify(colWidthChanged, { threshold: threshold, colIdx: oldIdx });\n                        setResize(colIndex, colWidth, true, this);\n                    }\n                }\n                else {\n                    var oldWidth = getColumnWidth(sheet, colIndex);\n                    var threshold = void 0;\n                    if (parseInt(colWidth, 10) > 0) {\n                        threshold = -(oldWidth - parseInt(colWidth, 10));\n                    }\n                    else {\n                        threshold = -oldWidth;\n                    }\n                    this.notify(colWidthChanged, { threshold: threshold, colIdx: colIndex });\n                }\n            }\n            getColumn(sheet, mIndex).width = parseInt(colWidth, 10) > 0 ? parseInt(colWidth, 10) : 0;\n            sheet.columns[mIndex].customWidth = true;\n        }\n    };\n    /**\n     * Set the height of row.\n     * {% codeBlock src='spreadsheet/setRowHeight/index.md' %}{% endcodeBlock %}\n     * @param {number} height? - Specifies height needs to be updated. If not specified, it will set the default height 20.\n     * @param {number} rowIndex? - Specifies the row index. If not specified, it will consider the first row.\n     * @param {number} sheetIndex? - Specifies the sheetIndex. If not specified, it will consider the active sheet.\n     */\n    Spreadsheet.prototype.setRowHeight = function (height, rowIndex, sheetIndex, edited) {\n        if (height === void 0) { height = 20; }\n        if (rowIndex === void 0) { rowIndex = 0; }\n        var sheet = isNullOrUndefined(sheetIndex) ? this.getActiveSheet() : this.sheets[sheetIndex - 1];\n        if (sheet) {\n            var mIndex = rowIndex;\n            var rowHeight = (typeof height === 'number') ? height + 'px' : height;\n            rowIndex = isNullOrUndefined(rowIndex) ? getCellIndexes(sheet.activeCell)[0] : rowIndex;\n            if (sheet === this.getActiveSheet()) {\n                if (rowIndex <= this.viewport.bottomIndex && rowIndex >= this.viewport.topIndex) {\n                    if (this.scrollSettings.enableVirtualization) {\n                        rowIndex = rowIndex - this.viewport.topIndex;\n                    }\n                    var trgt = this.getRowHeaderContent().getElementsByClassName('e-header-cell')[rowIndex];\n                    var eleHeight = parseInt(this.getMainContent().getElementsByTagName('tr')[rowIndex].style.height, 10);\n                    var threshold = parseInt(rowHeight, 10) - eleHeight;\n                    if (threshold < 0 && eleHeight < -(threshold)) {\n                        threshold = -eleHeight;\n                    }\n                    var oldIdx = parseInt(trgt.parentElement.getAttribute('aria-rowindex'), 10) - 1;\n                    if (this.getActiveSheet() === sheet) {\n                        this.notify(rowHeightChanged, { threshold: threshold, rowIdx: oldIdx });\n                        if (isNullOrUndefined(edited)) {\n                            edited = false;\n                        }\n                        if (!edited) {\n                            setResize(rowIndex, rowHeight, false, this);\n                            edited = false;\n                        }\n                    }\n                }\n                else {\n                    var oldHeight = getRowHeight(sheet, rowIndex);\n                    var threshold = void 0;\n                    if (parseInt(rowHeight, 10) > 0) {\n                        threshold = -(oldHeight - parseInt(rowHeight, 10));\n                    }\n                    else {\n                        threshold = -oldHeight;\n                    }\n                    this.notify(rowHeightChanged, { threshold: threshold, rowIdx: rowIndex });\n                }\n            }\n            setRowHeight(sheet, mIndex, parseInt(rowHeight, 10) > 0 ? parseInt(rowHeight, 10) : 0);\n            sheet.rows[mIndex].customHeight = true;\n        }\n    };\n    /**\n     * This method is used to autofit the range of rows or columns\n     * {% codeBlock src='spreadsheet/autoFit/index.md' %}{% endcodeBlock %}\n     * @param {string} range - range that needs to be autofit.\n     *\n     * ```html\n     * <div id='Spreadsheet'></div>\n     * ```\n     * ```typescript\n     * let spreadsheet = new Spreadsheet({\n     *      allowResizing: true\n     * ...\n     * }, '#Spreadsheet');\n     * spreadsheet.autoFit('A:D'); // Auto fit from A to D columns\n     * Spreadsheet.autoFit('1:4'); // Auto fit from 1 to 4 rows\n     *\n     * ```\n     */\n    Spreadsheet.prototype.autoFit = function (range) {\n        var values = this.getIndexes(range);\n        var startIdx = values.startIdx;\n        var endIdx = values.endIdx;\n        var isCol = values.isCol;\n        var maximumColInx = isCol ? getColIndex('XFD') : 1048576;\n        if (startIdx <= maximumColInx) {\n            if (endIdx > maximumColInx) {\n                endIdx = maximumColInx;\n            }\n        }\n        else {\n            return;\n        }\n        for (startIdx; startIdx <= endIdx; startIdx++) {\n            this.notify(setAutoFit, { idx: startIdx, isCol: isCol });\n        }\n    };\n    /** @hidden */\n    Spreadsheet.prototype.getIndexes = function (range) {\n        var startIsCol;\n        var endIsCol;\n        var start;\n        var end;\n        var isCol;\n        if (range.indexOf(':') !== -1) {\n            var starttoend = range.split(':');\n            start = starttoend[0];\n            end = starttoend[1];\n        }\n        else {\n            start = range;\n            end = range;\n        }\n        if (!isNullOrUndefined(start)) {\n            var startValues = this.getAddress(start);\n            start = startValues.address;\n            startIsCol = startValues.isCol;\n        }\n        if (!isNullOrUndefined(end)) {\n            var endValues = this.getAddress(end);\n            end = endValues.address;\n            endIsCol = endValues.isCol;\n        }\n        isCol = startIsCol === true && endIsCol === true ? true : false;\n        var startIdx = isCol ? getColIndex(start.toUpperCase()) : parseInt(start, 10);\n        var endIdx = isCol ? getColIndex(end.toUpperCase()) : parseInt(end, 10);\n        return { startIdx: startIdx, endIdx: endIdx, isCol: isCol };\n    };\n    Spreadsheet.prototype.getAddress = function (address) {\n        var isCol;\n        if (address.substring(0, 1).match(/\\D/g)) {\n            isCol = true;\n            address = address.replace(/[0-9]/g, '');\n            return { address: address, isCol: isCol };\n        }\n        else if (address.substring(0, 1).match(/[0-9]/g) && address.match(/\\D/g)) {\n            return { address: '', isCol: false };\n        }\n        else {\n            address = (parseInt(address, 10) - 1).toString();\n            return { address: address, isCol: isCol };\n        }\n    };\n    /**\n     * To add the hyperlink in the cell\n     * {% codeBlock src='spreadsheet/addHyperlink/index.md' %}{% endcodeBlock %}\n     * @param {string | HyperlinkModel} hyperlink\n     * @param {string} address\n     */\n    Spreadsheet.prototype.addHyperlink = function (hyperlink, address) {\n        this.insertHyperlink(hyperlink, address, '', true);\n    };\n    /**\n     * To remove the hyperlink in the cell\n     * {% codeBlock src='spreadsheet/removeHyperlink/index.md' %}{% endcodeBlock %}\n     * @param {string} range\n     */\n    Spreadsheet.prototype.removeHyperlink = function (range) {\n        var rangeArr;\n        var sheet = this.getActiveSheet();\n        var sheetIdx;\n        if (range && range.indexOf('!') !== -1) {\n            rangeArr = range.split('!');\n            var sheets = this.sheets;\n            for (var idx = 0; idx < sheets.length; idx++) {\n                if (sheets[idx].name === rangeArr[0]) {\n                    sheetIdx = idx;\n                }\n            }\n            sheet = this.sheets[sheetIdx];\n            range = rangeArr[1];\n        }\n        var rangeIndexes = range ? getRangeIndexes(range) : getRangeIndexes(this.getActiveSheet().activeCell);\n        var cellMod;\n        for (var rowIdx = rangeIndexes[0]; rowIdx <= rangeIndexes[2]; rowIdx++) {\n            for (var colIdx = rangeIndexes[1]; colIdx <= rangeIndexes[3]; colIdx++) {\n                if (sheet && sheet.rows[rowIdx] && sheet.rows[rowIdx].cells[colIdx]) {\n                    cellMod = sheet.rows[rowIdx].cells[colIdx];\n                    if (cellMod) {\n                        if (typeof (cellMod.hyperlink) === 'string') {\n                            cellMod.value = cellMod.value ? cellMod.value : cellMod.hyperlink;\n                        }\n                        else {\n                            cellMod.value = cellMod.value ? cellMod.value : cellMod.hyperlink.address;\n                        }\n                        delete (cellMod.hyperlink);\n                        if (sheet === this.getActiveSheet()) {\n                            var eleRowIdx = void 0;\n                            var eleColIdx = void 0;\n                            if (this.scrollSettings.enableVirtualization) {\n                                eleRowIdx = rowIdx - this.viewport.topIndex;\n                                eleColIdx = colIdx - this.viewport.leftIndex;\n                            }\n                            var cell = this.element.getElementsByClassName('e-sheet-content')[0].\n                                getElementsByClassName('e-row')[eleRowIdx].getElementsByClassName('e-cell')[eleColIdx];\n                            if (cell.getElementsByClassName('e-hyperlink')[0]) {\n                                cell.innerText = cell.getElementsByClassName('e-hyperlink')[0].innerHTML;\n                            }\n                        }\n                    }\n                }\n            }\n        }\n    };\n    /** @hidden */\n    Spreadsheet.prototype.insertHyperlink = function (hyperlink, address, displayText, isMethod) {\n        if (this.allowHyperlink) {\n            var value = void 0;\n            var addrRange = void 0;\n            var sheetIdx = void 0;\n            var cellIdx = void 0;\n            var sheet = this.getActiveSheet();\n            var isEmpty = void 0;\n            address = address ? address : this.getActiveSheet().activeCell;\n            var befArgs = { hyperlink: hyperlink, cell: address, cancel: false };\n            var aftArgs = { hyperlink: hyperlink, cell: address };\n            if (!isMethod) {\n                this.trigger(beforeHyperlinkCreate, befArgs);\n            }\n            if (!befArgs.cancel) {\n                hyperlink = befArgs.hyperlink;\n                address = befArgs.cell;\n                _super.prototype.addHyperlink.call(this, hyperlink, address);\n                if (address && address.indexOf('!') !== -1) {\n                    addrRange = address.split('!');\n                    var sheets = this.sheets;\n                    for (var idx = 0; idx < sheets.length; idx++) {\n                        if (sheets[idx].name === addrRange[0]) {\n                            sheetIdx = idx;\n                        }\n                    }\n                    sheet = this.sheets[sheetIdx];\n                    address = addrRange[1];\n                }\n                if (!sheet) {\n                    return;\n                }\n                address = address ? address : this.getActiveSheet().activeCell;\n                cellIdx = getRangeIndexes(address);\n                if (typeof (hyperlink) === 'string') {\n                    value = hyperlink;\n                }\n                else {\n                    value = hyperlink.address;\n                }\n                var mCell = sheet.rows[cellIdx[0]].cells[cellIdx[1]];\n                if (isNullOrUndefined(mCell.value) || mCell.value === '') {\n                    isEmpty = true;\n                }\n                if (!isMethod) {\n                    this.trigger(afterHyperlinkCreate, aftArgs);\n                }\n                if (sheet === this.getActiveSheet()) {\n                    this.serviceLocator.getService('cell').refreshRange(cellIdx);\n                }\n            }\n        }\n    };\n    /**\n     * This method is used to add data validation.\n     * {% codeBlock src='spreadsheet/addDataValidation/index.md' %}{% endcodeBlock %}\n     * @param {ValidationModel} rules - specifies the validation rules.\n     * @param {string} range - range that needs to be add validation.\n     */\n    Spreadsheet.prototype.addDataValidation = function (rules, range) {\n        _super.prototype.addDataValidation.call(this, rules, range);\n    };\n    /**\n     * This method is used for remove validation.\n     * {% codeBlock src='spreadsheet/removeDataValidation/index.md' %}{% endcodeBlock %}\n     * @param {string} range - range that needs to be remove validation.\n     */\n    Spreadsheet.prototype.removeDataValidation = function (range) {\n        _super.prototype.removeDataValidation.call(this, range);\n    };\n    /**\n     * This method is used to highlight the invalid data.\n     * {% codeBlock src='spreadsheet/addInvalidHighlight/index.md' %}{% endcodeBlock %}\n     * @param {string} range - range that needs to be highlight the invalid data.\n     */\n    Spreadsheet.prototype.addInvalidHighlight = function (range) {\n        _super.prototype.addInvalidHighlight.call(this, range);\n    };\n    /**\n     * This method is used for remove highlight from invalid data.\n     * {% codeBlock src='spreadsheet/removeInvalidHighlight/index.md' %}{% endcodeBlock %}\n     * @param {string} range - range that needs to be remove invalid highlight.\n     */\n    Spreadsheet.prototype.removeInvalidHighlight = function (range) {\n        _super.prototype.removeInvalidHighlight.call(this, range);\n    };\n    /**\n     * This method is used to add conditional formatting.\n     * {% codeBlock src='spreadsheet/conditionalFormat/index.md' %}{% endcodeBlock %}\n     * @param  {string} type - Conditional formatting HighlightCell, TopBottom, DataBar, ColorScale, IconSet Type.\n     * HighlightCell- 'GreaterThan' | 'LessThan' | 'Between' | 'EqualTo' | 'ContainsText' | 'DateOccur' | 'Duplicate' | 'Unique',\n     * TopBottom - 'Top10Items' | 'Bottom10Items' | 'Top10Percentage' | 'Bottom10Percentage' | 'BelowAverage' | 'AboveAverage',\n     * DataBar - 'BlueDataBar' | 'GreenDataBar' | 'RedDataBar' | 'OrangeDataBar' | 'LightBlueDataBar' | 'PurpleDataBar',\n     * ColorScale - 'GYRColorScale' | 'RYGColorScale' | 'GWRColorScale' | 'RWGColorScale' | 'BWRColorScale' | 'RWBColorScale' |\n     * 'WRColorScale' | 'RWColorScale' | 'GWColorScale' | 'WGColorScale' | 'GYColorScale' | 'YGColorScale',\n     * IconSet - 'ThreeArrows' | 'ThreeArrowsGray' | 'FourArrowsGray' | 'FourArrows' | 'FiveArrowsGray' | 'FiveArrows' |\n     * 'ThreeTrafficLights1' | 'ThreeTrafficLights2' | 'ThreeSigns' | 'FourTrafficLights' | 'FourRedToBlack' | 'ThreeSymbols' |\n     * 'ThreeSymbols2' | 'ThreeFlags' | 'FourRating' | 'FiveQuarters' | 'FiveRating' | 'ThreeTriangles' | 'ThreeStars' | 'FiveBoxes';\n     * @param  {string} cFColor - Pass the cFcolor to set the conditional formatting.\n     * CFColor - 'RedFT' | 'YellowFT' | 'GreenFT' | 'RedF' | 'RedT'.\n     * @param  {string} value - Pass the value to set the conditional formatting.\n     * @param  {string} range - Pass the range to set the conditional formatting.\n     */\n    Spreadsheet.prototype.conditionalFormat = function (conditionalFormat) {\n        _super.prototype.conditionalFormat.call(this, conditionalFormat);\n    };\n    /**\n     * This method is used for remove conditional formatting.\n     * {% codeBlock src='spreadsheet/clearConditionalFormat/index.md' %}{% endcodeBlock %}\n     * @param {string} range - range that needs to be remove conditional formatting.\n     */\n    Spreadsheet.prototype.clearConditionalFormat = function (range) {\n        range = range || this.getActiveSheet().selectedRange;\n        _super.prototype.clearConditionalFormat.call(this, range);\n    };\n    /** @hidden */\n    Spreadsheet.prototype.setPanelSize = function () {\n        if (this.height !== 'auto') {\n            var panel = document.getElementById(this.element.id + '_sheet_panel');\n            panel.style.height = this.element.getBoundingClientRect().height - getSiblingsHeight(panel) + \"px\";\n        }\n    };\n    /**\n     * Opens the Excel file.\n     * {% codeBlock src='spreadsheet/open/index.md' %}{% endcodeBlock %}\n     * @param {OpenOptions} options - Options for opening the excel file.\n     */\n    Spreadsheet.prototype.open = function (options) {\n        this.isOpen = true;\n        _super.prototype.open.call(this, options);\n        if (this.isOpen) {\n            this.showSpinner();\n        }\n    };\n    /** @hidden */\n    Spreadsheet.prototype.hideRow = function (startIndex, endIndex, hide) {\n        if (endIndex === void 0) { endIndex = startIndex; }\n        if (hide === void 0) { hide = true; }\n        if (this.renderModule) {\n            this.notify(hideShow, { startIndex: startIndex, endIndex: endIndex, hide: hide });\n        }\n        else {\n            _super.prototype.hideRow.call(this, startIndex, endIndex, hide);\n        }\n    };\n    /** @hidden */\n    Spreadsheet.prototype.hideColumn = function (startIndex, endIndex, hide) {\n        if (endIndex === void 0) { endIndex = startIndex; }\n        if (hide === void 0) { hide = true; }\n        if (this.renderModule) {\n            this.notify(hideShow, { startIndex: startIndex, endIndex: endIndex, hide: hide, isCol: true });\n        }\n        else {\n            _super.prototype.hideColumn.call(this, startIndex, endIndex, hide);\n        }\n    };\n    /**\n     * This method is used to Clear contents, formats and hyperlinks in spreadsheet.\n     * {% codeBlock src='spreadsheet/clear/index.md' %}{% endcodeBlock %}\n     *    * @param {ClearOptions} options - Options for clearing the content, formats and hyperlinks in spreadsheet.\n     */\n    Spreadsheet.prototype.clear = function (options) {\n        this.notify(clearViewer, { options: options, isPublic: true });\n    };\n    /**\n     * Used to refresh the spreadsheet.\n     * {% codeBlock src='spreadsheet/refresh/index.md' %}{% endcodeBlock %}\n     * @param {boolean} isNew - Specifies `true` / `false` to create new workbook in spreadsheet.\n     * @returns void\n     */\n    Spreadsheet.prototype.refresh = function (isNew) {\n        if (this[isReact]) {\n            this[clearTemplate]();\n        }\n        (isNew) ? this.notify(blankWorkbook, {}) : _super.prototype.refresh.call(this);\n    };\n    /**\n     * Used to set the image in spreadsheet.\n     * {% codeBlock src='spreadsheet/insertImage/index.md' %}{% endcodeBlock %}\n     * @param {ImageModel} images - Specifies the options to insert image in spreadsheet.\n     * @param {string} range - Specifies the range in spreadsheet.\n     * @returns void\n     */\n    Spreadsheet.prototype.insertImage = function (images, range) {\n        var i;\n        for (i = 0; i < images.length; i++) {\n            this.notify(createImageElement, {\n                options: images[i],\n                range: range ? range : this.getActiveSheet().selectedRange, isPublic: true\n            });\n        }\n    };\n    /**\n     * Used to delete the image in spreadsheet.\n     * {% codeBlock src='spreadsheet/deleteImage/index.md' %}{% endcodeBlock %}\n     * @param {string} id - Specifies the id of the image element to be deleted.\n     * @param {string} range - Specifies the range in spreadsheet.\n     * @returns void\n     */\n    Spreadsheet.prototype.deleteImage = function (id, range) {\n        this.notify(deleteImage, { id: id, range: range ? range : this.getActiveSheet().selectedRange });\n    };\n    /**\n     * Gets the row header div of the Spreadsheet.\n     * @return {Element}\n     * @hidden\n     */\n    Spreadsheet.prototype.getRowHeaderContent = function () {\n        return this.sheetModule.getRowHeaderPanel();\n    };\n    /**\n     * Gets the column header div of the Spreadsheet.\n     * @return {Element}\n     * @hidden\n     */\n    Spreadsheet.prototype.getColumnHeaderContent = function () {\n        return this.sheetModule.getColHeaderPanel();\n    };\n    /**\n     * Gets the main content div of the Spreadsheet.\n     * @return {Element}\n     * @hidden\n     */\n    Spreadsheet.prototype.getMainContent = function () {\n        return this.sheetModule.getContentPanel();\n    };\n    /**\n     * Get the main content table element of spreadsheet.\n     * @return {HTMLTableElement}\n     * @hidden\n     */\n    Spreadsheet.prototype.getContentTable = function () {\n        return this.sheetModule.getContentTable();\n    };\n    /**\n     * Get the row header table element of spreadsheet.\n     * @return {HTMLTableElement}\n     * @hidden\n     */\n    Spreadsheet.prototype.getRowHeaderTable = function () {\n        return this.sheetModule.getRowHeaderTable();\n    };\n    /**\n     * Get the column header table element of spreadsheet.\n     * @return {HTMLTableElement}\n     * @hidden\n     */\n    Spreadsheet.prototype.getColHeaderTable = function () {\n        return this.sheetModule.getColHeaderTable();\n    };\n    /**\n     * To get the backup element count for row and column virtualization.\n     * @hidden\n     */\n    Spreadsheet.prototype.getThreshold = function (layout) {\n        var threshold = Math.round((this.viewport[layout + 'Count'] + 1) / 2);\n        return threshold < 15 ? 15 : threshold;\n    };\n    /** @hidden */\n    Spreadsheet.prototype.isMobileView = function () {\n        return ((this.cssClass.indexOf('e-mobile-view') > -1 || Browser.isDevice) && this.cssClass.indexOf('e-desktop-view') === -1)\n            && false;\n    };\n    /** @hidden */\n    Spreadsheet.prototype.getValueRowCol = function (sheetIndex, rowIndex, colIndex) {\n        var val = _super.prototype.getValueRowCol.call(this, sheetIndex, rowIndex, colIndex);\n        return val;\n    };\n    /**\n     * To update a cell properties.\n     * {% codeBlock src='spreadsheet/updateCell/index.md' %}{% endcodeBlock %}\n     * @param {CellModel} cell - Cell properties.\n     * @param {string} address - Address to update.\n     */\n    Spreadsheet.prototype.updateCell = function (cell, address) {\n        address = address || this.getActiveSheet().activeCell;\n        _super.prototype.updateCell.call(this, cell, address);\n        this.serviceLocator.getService('cell').refreshRange(getIndexesFromAddress(address));\n        this.notify(activeCellChanged, null);\n    };\n    /**\n     * Sorts the range of cells in the active sheet.\n     * {% codeBlock src='spreadsheet/sort/index.md' %}{% endcodeBlock %}\n     * @param sortOptions - options for sorting.\n     * @param range - address of the data range.\n     */\n    Spreadsheet.prototype.sort = function (sortOptions, range) {\n        var _this = this;\n        if (!this.allowSorting) {\n            return Promise.reject();\n        }\n        return _super.prototype.sort.call(this, sortOptions, range).then(function (args) {\n            _this.notify(sortComplete, args);\n            return Promise.resolve(args);\n        });\n    };\n    /** @hidden */\n    Spreadsheet.prototype.setValueRowCol = function (sheetIndex, value, rowIndex, colIndex) {\n        if (value === 'circular reference: ') {\n            var circularArgs = {\n                action: 'isCircularReference', argValue: value\n            };\n            this.notify(formulaOperation, circularArgs);\n            value = circularArgs.argValue;\n        }\n        _super.prototype.setValueRowCol.call(this, sheetIndex, value, rowIndex, colIndex);\n        sheetIndex = getSheetIndexFromId(this, sheetIndex);\n        this.notify(editOperation, {\n            action: 'refreshDependentCellValue', rowIdx: rowIndex, colIdx: colIndex,\n            sheetIdx: sheetIndex\n        });\n    };\n    /**\n     * Get component name.\n     * @returns string\n     * @hidden\n     */\n    Spreadsheet.prototype.getModuleName = function () {\n        return 'spreadsheet';\n    };\n    /** @hidden */\n    Spreadsheet.prototype.refreshNode = function (td, args) {\n        var value;\n        if (td) {\n            var spanElem = select('#' + this.element.id + '_currency', td);\n            var alignClass = 'e-right-align';\n            if (args) {\n                args.result = isNullOrUndefined(args.result) ? '' : args.result.toString();\n                if (spanElem) {\n                    detach(spanElem);\n                }\n                if (args.type === 'Accounting' && isNumber(args.value)) {\n                    if (td.querySelector('a')) {\n                        td.querySelector('a').textContent = args.result.split(args.curSymbol).join('');\n                    }\n                    else {\n                        td.innerHTML = '';\n                    }\n                    td.appendChild(this.createElement('span', {\n                        id: this.element.id + '_currency',\n                        innerHTML: \"\" + args.curSymbol,\n                        styles: 'float: left'\n                    }));\n                    if (!td.querySelector('a')) {\n                        td.innerHTML += args.result.split(args.curSymbol).join('');\n                    }\n                    td.classList.add(alignClass);\n                    return;\n                }\n                else {\n                    if (args.result && (args.result.toLowerCase() === 'true' || args.result.toLowerCase() === 'false')) {\n                        args.result = args.result.toUpperCase();\n                        alignClass = 'e-center-align';\n                        args.isRightAlign = true; // Re-use this to center align the cell.\n                    }\n                    value = args.result;\n                }\n                args.isRightAlign ? td.classList.add(alignClass) : td.classList.remove(alignClass);\n            }\n            value = !isNullOrUndefined(value) ? value : '';\n            if (!isNullOrUndefined(td)) {\n                var node = td.lastChild;\n                if (td.querySelector('.e-hyperlink')) {\n                    node = td.querySelector('.e-hyperlink').lastChild;\n                }\n                if (node && (node.nodeType === 3 || node.nodeType === 1)) {\n                    node.nodeValue = value;\n                }\n                else {\n                    td.appendChild(document.createTextNode(value));\n                }\n            }\n        }\n    };\n    /** @hidden */\n    Spreadsheet.prototype.calculateHeight = function (style, lines, borderWidth) {\n        if (lines === void 0) { lines = 1; }\n        if (borderWidth === void 0) { borderWidth = 1; }\n        var fontSize = (style && style.fontSize) || this.cellStyle.fontSize;\n        var threshold = style.fontFamily === 'Arial Black' ? 1.44 : 1.24;\n        return ((fontSize.indexOf('pt') > -1 ? parseInt(fontSize, 10) * 1.33 : parseInt(fontSize, 10)) * threshold * lines) +\n            (borderWidth * threshold);\n    };\n    /** @hidden */\n    Spreadsheet.prototype.skipHidden = function (startIdx, endIdx, layout) {\n        if (layout === void 0) { layout = 'rows'; }\n        var sheet = this.getActiveSheet();\n        var totalCount;\n        if (this.scrollSettings.isFinite) {\n            totalCount = (layout === 'rows' ? sheet.rowCount : sheet.colCount) - 1;\n        }\n        for (var i = startIdx; i <= endIdx; i++) {\n            if ((sheet[layout])[i] && (sheet[layout])[i].hidden) {\n                if (startIdx === i) {\n                    startIdx++;\n                }\n                endIdx++;\n                if (totalCount && endIdx > totalCount) {\n                    endIdx = totalCount;\n                    break;\n                }\n            }\n        }\n        return [startIdx, endIdx];\n    };\n    /** @hidden */\n    Spreadsheet.prototype.updateActiveBorder = function (nextTab, selector) {\n        if (selector === void 0) { selector = '.e-ribbon'; }\n        var indicator = select(selector + \" .e-tab-header .e-indicator\", this.element);\n        indicator.style.display = 'none';\n        setStyleAttribute(indicator, { 'left': '', 'right': '' });\n        setStyleAttribute(indicator, {\n            'left': nextTab.offsetLeft + 'px', 'right': nextTab.parentElement.offsetWidth - (nextTab.offsetLeft + nextTab.offsetWidth) + 'px'\n        });\n        indicator.style.display = '';\n    };\n    /**\n     * To perform the undo operation in spreadsheet.\n     * {% codeBlock src='spreadsheet/undo/index.md' %}{% endcodeBlock %}\n     */\n    Spreadsheet.prototype.undo = function () {\n        this.notify(performUndoRedo, { isUndo: true, isPublic: true });\n    };\n    /**\n     * To perform the redo operation in spreadsheet.\n     * {% codeBlock src='spreadsheet/redo/index.md' %}{% endcodeBlock %}\n     */\n    Spreadsheet.prototype.redo = function () {\n        this.notify(performUndoRedo, { isUndo: false, isPublic: true });\n    };\n    /**\n     * To update the undo redo collection in spreadsheet.\n     * {% codeBlock src='spreadsheet/updateUndoRedoCollection/index.md' %}{% endcodeBlock %}\n     * @param {object} args - options for undo redo.\n     */\n    Spreadsheet.prototype.updateUndoRedoCollection = function (args) {\n        this.notify(updateUndoRedoCollection, { args: args, isPublic: true });\n    };\n    /**\n     * Adds the defined name to the Spreadsheet.\n     * {% codeBlock src='spreadsheet/addDefinedName/index.md' %}{% endcodeBlock %}\n     * @param {DefineNameModel} definedName - Specifies the name.\n     * @return {boolean} - Return the added status of the defined name.\n     */\n    Spreadsheet.prototype.addDefinedName = function (definedName) {\n        var eventArgs = {\n            action: 'addDefinedName',\n            isAdded: false,\n            definedName: definedName\n        };\n        this.notify(formulaOperation, eventArgs);\n        return eventArgs.isAdded;\n    };\n    /**\n     * Removes the defined name from the Spreadsheet.\n     * {% codeBlock src='spreadsheet/removeDefinedName/index.md' %}{% endcodeBlock %}\n     * @param {string} definedName - Specifies the name.\n     * @param {string} scope - Specifies the scope of the defined name.\n     * @return {boolean} - Return the removed status of the defined name.\n     */\n    Spreadsheet.prototype.removeDefinedName = function (definedName, scope) {\n        return _super.prototype.removeDefinedName.call(this, definedName, scope);\n    };\n    Spreadsheet.prototype.mouseClickHandler = function (e) {\n        this.notify(click, e);\n    };\n    Spreadsheet.prototype.mouseDownHandler = function (e) {\n        this.notify(mouseDown, e);\n    };\n    Spreadsheet.prototype.keyUpHandler = function (e) {\n        if (closest(e.target, '.e-find-dlg')) {\n            this.notify(findKeyUp, e);\n        }\n        else {\n            this.notify(keyUp, e);\n        }\n    };\n    Spreadsheet.prototype.keyDownHandler = function (e) {\n        if (!closest(e.target, '.e-findtool-dlg')) {\n            this.notify(keyDown, e);\n        }\n    };\n    /**\n     * Binding events to the element while component creation.\n     */\n    Spreadsheet.prototype.wireEvents = function () {\n        EventHandler.add(this.element, 'click', this.mouseClickHandler, this);\n        EventHandler.add(this.element, getStartEvent(), this.mouseDownHandler, this);\n        EventHandler.add(this.element, 'keyup', this.keyUpHandler, this);\n        EventHandler.add(this.element, 'keydown', this.keyDownHandler, this);\n        EventHandler.add(this.element, 'noderefresh', this.refreshNode, this);\n    };\n    /**\n     * Destroys the component (detaches/removes all event handlers, attributes, classes, and empties the component element).\n     */\n    Spreadsheet.prototype.destroy = function () {\n        if (this[isReact]) {\n            this[clearTemplate]();\n        }\n        this.unwireEvents();\n        this.notify(spreadsheetDestroyed, null);\n        _super.prototype.destroy.call(this);\n        this.element.innerHTML = '';\n        this.element.removeAttribute('tabindex');\n        this.element.removeAttribute('role');\n        this.element.style.removeProperty('height');\n        this.element.style.removeProperty('width');\n        this.element.style.removeProperty('min-height');\n        this.element.style.removeProperty('min-width');\n    };\n    /**\n     * Unbinding events from the element while component destroy.\n     */\n    Spreadsheet.prototype.unwireEvents = function () {\n        EventHandler.remove(this.element, 'click', this.mouseClickHandler);\n        EventHandler.remove(this.element, getStartEvent(), this.mouseDownHandler);\n        EventHandler.remove(this.element, 'keyup', this.keyUpHandler);\n        EventHandler.remove(this.element, 'keydown', this.keyDownHandler);\n        EventHandler.remove(this.element, 'noderefresh', this.refreshNode);\n    };\n    /**\n     * To add context menu items.\n     * {% codeBlock src='spreadsheet/addContextMenu/index.md' %}{% endcodeBlock %}\n     * @param {MenuItemModel[]} items - Items that needs to be added.\n     * @param {string} text - Item before / after that the element to be inserted.\n     * @param {boolean} insertAfter - Set `false` if the `items` need to be inserted before the `text`.\n     * By default, `items` are added after the `text`.\n     * @param {boolean} isUniqueId - Set `true` if the given `text` is a unique id.\n     */\n    Spreadsheet.prototype.addContextMenuItems = function (items, text, insertAfter, isUniqueId) {\n        if (insertAfter === void 0) { insertAfter = true; }\n        this.notify(addContextMenuItems, { items: items, text: text, insertAfter: insertAfter, isUniqueId: isUniqueId });\n    };\n    /**\n     * To remove existing context menu items.\n     * {% codeBlock src='spreadsheet/removeContextMenuItems/index.md' %}{% endcodeBlock %}\n     * @param {string[]} items - Items that needs to be removed.\n     * @param {boolean} isUniqueId - Set `true` if the given `text` is a unique id.\n     */\n    Spreadsheet.prototype.removeContextMenuItems = function (items, isUniqueId) {\n        this.notify(removeContextMenuItems, { items: items, isUniqueId: isUniqueId });\n    };\n    /**\n     * To enable / disable context menu items.\n     * {% codeBlock src='spreadsheet/enableContextMenuItems/index.md' %}{% endcodeBlock %}\n     * @param {string[]} items - Items that needs to be enabled / disabled.\n     * @param {boolean} enable - Set `true` / `false` to enable / disable the menu items.\n     * @param {boolean} isUniqueId - Set `true` if the given `text` is a unique id.\n     */\n    Spreadsheet.prototype.enableContextMenuItems = function (items, enable, isUniqueId) {\n        if (enable === void 0) { enable = true; }\n        this.notify(enableContextMenuItems, { items: items, enable: enable, isUniqueId: isUniqueId });\n    };\n    /**\n     * To enable / disable file menu items.\n     * {% codeBlock src='spreadsheet/enableFileMenuItems/index.md' %}{% endcodeBlock %}\n     * @param {string[]} items - Items that needs to be enabled / disabled.\n     * @param {boolean} enable? - Set `true` / `false` to enable / disable the menu items.\n     * @param {boolean} isUniqueId? - Set `true` if the given file menu items `text` is a unique id.\n     * @returns void.\n     */\n    Spreadsheet.prototype.enableFileMenuItems = function (items, enable, isUniqueId) {\n        if (enable === void 0) { enable = true; }\n        this.notify(enableFileMenuItems, { items: items, enable: enable, isUniqueId: isUniqueId });\n    };\n    /**\n     * To show/hide the file menu items in Spreadsheet ribbon.\n     * {% codeBlock src='spreadsheet/hideFileMenuItems/index.md' %}{% endcodeBlock %}\n     * @param {string[]} items - Specifies the file menu items text which is to be show/hide.\n     * @param {boolean} hide? - Set `true` / `false` to hide / show the file menu items.\n     * @param {boolean} isUniqueId? - Set `true` if the given file menu items `text` is a unique id.\n     * @returns void.\n     */\n    Spreadsheet.prototype.hideFileMenuItems = function (items, hide, isUniqueId) {\n        if (hide === void 0) { hide = true; }\n        this.notify(hideFileMenuItems, { items: items, hide: hide, isUniqueId: isUniqueId });\n    };\n    /**\n     * To add custom file menu items.\n     * {% codeBlock src='spreadsheet/addFileMenuItems/index.md' %}{% endcodeBlock %}\n     * @param {MenuItemModel[]} items - Specifies the ribbon file menu items to be inserted.\n     * @param {string} text - Specifies the existing file menu item text before / after which the new file menu items to be inserted.\n     * @param {boolean} insertAfter? - Set `false` if the `items` need to be inserted before the `text`.\n     * By default, `items` are added after the `text`.\n     * @param {boolean} isUniqueId? - Set `true` if the given file menu items `text` is a unique id.\n     * @returns void.\n     */\n    Spreadsheet.prototype.addFileMenuItems = function (items, text, insertAfter, isUniqueId) {\n        if (insertAfter === void 0) { insertAfter = true; }\n        this.notify(addFileMenuItems, { items: items, text: text, insertAfter: insertAfter, isUniqueId: isUniqueId });\n    };\n    /**\n     * To show/hide the existing ribbon tabs.\n     * {% codeBlock src='spreadsheet/hideRibbonTabs/index.md' %}{% endcodeBlock %}\n     * @param {string[]} tabs - Specifies the tab header text which needs to be shown/hidden.\n     * @param {boolean} hide? - Set `true` / `false` to hide / show the ribbon tabs.\n     * @returns void.\n     */\n    Spreadsheet.prototype.hideRibbonTabs = function (tabs, hide) {\n        if (hide === void 0) { hide = true; }\n        this.notify(hideRibbonTabs, { tabs: tabs, hide: hide });\n    };\n    /**\n     * To enable / disable the existing ribbon tabs.\n     * {% codeBlock src='spreadsheet/enableRibbonTabs/index.md' %}{% endcodeBlock %}\n     * @param {string[]} tabs - Specifies the tab header text which needs to be enabled / disabled.\n     * @param {boolean} enable? - Set `true` / `false` to enable / disable the ribbon tabs.\n     * @returns void.\n     */\n    Spreadsheet.prototype.enableRibbonTabs = function (tabs, enable) {\n        if (enable === void 0) { enable = true; }\n        this.notify(enableRibbonTabs, { tabs: tabs, enable: enable });\n    };\n    /**\n     * To add custom ribbon tabs.\n     * {% codeBlock src='spreadsheet/addRibbonTabs/index.md' %}{% endcodeBlock %}\n     * @param {RibbonItemModel[]} items - Specifies the ribbon tab items to be inserted.\n     * @param {string} insertBefore? - Specifies the existing ribbon header text before which the new tabs will be inserted.\n     * If not specified, the new tabs will be inserted at the end.\n     * @returns void.\n     */\n    Spreadsheet.prototype.addRibbonTabs = function (items, insertBefore) {\n        this.notify(addRibbonTabs, { items: items, insertBefore: insertBefore });\n    };\n    /**\n     * Enables or disables the specified ribbon toolbar items or all ribbon items.\n     * {% codeBlock src='spreadsheet/enableToolbarItems/index.md' %}{% endcodeBlock %}\n     * @param {string} tab - Specifies the ribbon tab header text under which the toolbar items need to be enabled / disabled.\n     * @param {string[]} items? - Specifies the toolbar item indexes / unique id's which needs to be enabled / disabled.\n     * If it is not specified the entire toolbar items will be enabled / disabled.\n     * @param  {boolean} enable? - Boolean value that determines whether the toolbar items should be enabled or disabled.\n     * @returns void.\n     */\n    Spreadsheet.prototype.enableToolbarItems = function (tab, items, enable) {\n        this.notify(enableToolbarItems, [{ tab: tab, items: items, enable: enable === undefined ? true : enable }]);\n    };\n    /**\n     * To show/hide the existing Spreadsheet ribbon toolbar items.\n     * {% codeBlock src='spreadsheet/hideToolbarItems/index.md' %}{% endcodeBlock %}\n     * @param {string} tab - Specifies the ribbon tab header text under which the specified items needs to be hidden / shown.\n     * @param {string[]} indexes - Specifies the toolbar indexes which needs to be shown/hidden from UI.\n     * @param {boolean} hide? - Set `true` / `false` to hide / show the toolbar items.\n     * @returns void.\n     */\n    Spreadsheet.prototype.hideToolbarItems = function (tab, indexes, hide) {\n        if (hide === void 0) { hide = true; }\n        this.notify(hideToolbarItems, { tab: tab, indexes: indexes, hide: hide });\n    };\n    /**\n     * To add the custom items in Spreadsheet ribbon toolbar.\n     * {% codeBlock src='spreadsheet/addToolbarItems/index.md' %}{% endcodeBlock %}\n     * @param {string} tab - Specifies the ribbon tab header text under which the specified items will be inserted.\n     * @param {ItemModel[]} items - Specifies the ribbon toolbar items that needs to be inserted.\n     * @param {number} index? - Specifies the index text before which the new items will be inserted.\n     * If not specified, the new items will be inserted at the end of the toolbar.\n     * @returns void.\n     */\n    Spreadsheet.prototype.addToolbarItems = function (tab, items, index) {\n        this.notify(addToolbarItems, { tab: tab, items: items, index: index });\n    };\n    /**\n     * Selects the cell / range of cells with specified address.\n     * {% codeBlock src='spreadsheet/selectRange/index.md' %}{% endcodeBlock %}\n     * @param {string} address - Specifies the range address.\n     */\n    Spreadsheet.prototype.selectRange = function (address) {\n        this.notify(selectRange, { indexes: getRangeIndexes(address) });\n    };\n    /**\n     * Start edit the active cell.\n     * {% codeBlock src='spreadsheet/startEdit/index.md' %}{% endcodeBlock %}\n     * @return {void}\n     */\n    Spreadsheet.prototype.startEdit = function () {\n        this.notify(editOperation, { action: 'startEdit', isNewValueEdit: false });\n    };\n    /**\n     * Cancels the edited state, this will not update any value in the cell.\n     * {% codeBlock src='spreadsheet/closeEdit/index.md' %}{% endcodeBlock %}\n     * @return {void}\n     */\n    Spreadsheet.prototype.closeEdit = function () {\n        this.notify(editOperation, { action: 'cancelEdit' });\n    };\n    /**\n     * If Spreadsheet is in editable state, you can save the cell by invoking endEdit.\n     * {% codeBlock src='spreadsheet/endEdit/index.md' %}{% endcodeBlock %}\n     * @return {void}\n     */\n    Spreadsheet.prototype.endEdit = function () {\n        this.notify(editOperation, { action: 'endEdit' });\n    };\n    /**\n     * Called internally if any of the property value changed.\n     * @param  {SpreadsheetModel} newProp\n     * @param  {SpreadsheetModel} oldProp\n     * @returns void\n     * @hidden\n     */\n    Spreadsheet.prototype.onPropertyChanged = function (newProp, oldProp) {\n        var _this = this;\n        _super.prototype.onPropertyChanged.call(this, newProp, oldProp);\n        for (var _i = 0, _a = Object.keys(newProp); _i < _a.length; _i++) {\n            var prop = _a[_i];\n            switch (prop) {\n                case 'enableRtl':\n                    newProp.enableRtl ? document.getElementById(this.element.id + '_sheet_panel').classList.add('e-rtl') :\n                        document.getElementById(this.element.id + '_sheet_panel').classList.remove('e-rtl');\n                    break;\n                case 'cssClass':\n                    if (oldProp.cssClass) {\n                        removeClass([this.element], oldProp.cssClass.split(' '));\n                    }\n                    if (newProp.cssClass) {\n                        addClass([this.element], newProp.cssClass.split(' '));\n                    }\n                    break;\n                case 'activeSheetIndex':\n                    this.renderModule.refreshSheet();\n                    this.notify(activeSheetChanged, { idx: newProp.activeSheetIndex });\n                    break;\n                case 'width':\n                    this.setWidth();\n                    this.resize();\n                    break;\n                case 'height':\n                    this.setHeight();\n                    this.resize();\n                    break;\n                case 'showRibbon':\n                    this.notify(ribbon, { uiUpdate: true });\n                    break;\n                case 'showFormulaBar':\n                    this.notify(formulaBar, { uiUpdate: true });\n                    break;\n                case 'showSheetTabs':\n                    this.notify(sheetTabs, null);\n                    break;\n                case 'cellStyle':\n                    this.renderModule.refreshSheet();\n                    break;\n                case 'allowEditing':\n                    if (this.allowEditing) {\n                        this.notify(editOperation, { action: 'renderEditor' });\n                    }\n                    break;\n                case 'sheets':\n                    // Object.keys(newProp.sheets).forEach((sheetIdx: string): void => {\n                    // if (this.activeSheetIndex === Number(sheetIdx)) {\n                    //     if (newProp.sheets[sheetIdx].showGridLines !== undefined) {\n                    //         this.notify(updateToggleItem, { props: 'GridLines', pos: 2 });\n                    //     }\n                    //     if (newProp.sheets[sheetIdx].showHeaders !== undefined) {\n                    //         this.sheetModule.showHideHeaders();\n                    //         this.notify(updateToggleItem, { props: 'Headers', pos: 0 });\n                    //     }\n                    // }\n                    // if (newProp.sheets[sheetIdx].name !== undefined) {\n                    //     this.notify(sheetNameUpdate, {\n                    //         items: this.element.querySelector('.e-sheet-tabs-items').children[sheetIdx],\n                    //         value: newProp.sheets[sheetIdx].name,\n                    //         idx: sheetIdx\n                    //     });\n                    // }\n                    // if (newProp.sheets[sheetIdx].range) {\n                    //     this.sheets[sheetIdx].range = newProp.sheets[sheetIdx].range;\n                    Object.keys(newProp.sheets).forEach(function (sheetIdx, index) {\n                        var sheet = newProp.sheets[sheetIdx];\n                        if (sheet.ranges && Object.keys(sheet.ranges).length) {\n                            var ranges_1 = Object.keys(sheet.ranges);\n                            var newRangeIdx_1;\n                            ranges_1.forEach(function (rangeIdx, idx) {\n                                if (!sheet.ranges[rangeIdx].info) {\n                                    newRangeIdx_1 = idx;\n                                }\n                            });\n                            ranges_1.forEach(function (rangeIdx, idx) {\n                                if (sheet.ranges[rangeIdx].dataSource && (isUndefined(newRangeIdx_1)\n                                    || (!isUndefined(newRangeIdx_1) && newRangeIdx_1 === idx))) {\n                                    _this.notify(dataSourceChanged, {\n                                        sheetIdx: sheetIdx, rangeIdx: rangeIdx,\n                                        isLastRange: ranges_1.length - 1 === idx\n                                    });\n                                }\n                            });\n                        }\n                        else {\n                            if (index === 0) {\n                                _this.renderModule.refreshSheet();\n                            }\n                            if (_this.showSheetTabs && sheet.name) {\n                                _this.notify(sheetNameUpdate, {\n                                    items: _this.element.querySelector('.e-sheet-tabs-items').children[sheetIdx],\n                                    value: sheet.name,\n                                    idx: sheetIdx\n                                });\n                            }\n                        }\n                    });\n                    break;\n                case 'locale':\n                    this.refresh();\n                    break;\n            }\n        }\n    };\n    /**\n     * To provide the array of modules needed for component rendering.\n     * @return {ModuleDeclaration[]}\n     * @hidden\n     */\n    Spreadsheet.prototype.requiredModules = function () {\n        return getRequiredModules(this);\n    };\n    /**\n     * Appends the control within the given HTML Div element.\n     * {% codeBlock src='spreadsheet/appendTo/index.md' %}{% endcodeBlock %}\n     * @param {string | HTMLElement} selector - Target element where control needs to be appended.\n     */\n    Spreadsheet.prototype.appendTo = function (selector) {\n        _super.prototype.appendTo.call(this, selector);\n    };\n    /**\n     * Filters the range of cells in the sheet.\n     * @hidden\n     */\n    Spreadsheet.prototype.filter = function (filterOptions, range) {\n        if (!this.allowFiltering) {\n            return Promise.reject();\n        }\n        range = range || this.getActiveSheet().selectedRange;\n        return _super.prototype.filter.call(this, filterOptions, range);\n    };\n    /**\n     * Clears the filter changes of the sheet.\n     * {% codeBlock src='spreadsheet/clearFilter/index.md' %}{% endcodeBlock %}\n     */\n    Spreadsheet.prototype.clearFilter = function (field) {\n        if (field) {\n            this.notify(clearFilter, { field: field });\n        }\n        else {\n            _super.prototype.clearFilter.call(this);\n        }\n    };\n    /**\n     * Applies the filter UI in the range of cells in the sheet.\n     * {% codeBlock src='spreadsheet/applyFilter/index.md' %}{% endcodeBlock %}\n     */\n    Spreadsheet.prototype.applyFilter = function (predicates, range) {\n        this.notify(initiateFilterUI, { predicates: predicates, range: range });\n    };\n    /**\n     * To add custom library function.\n     *  {% codeBlock src='spreadsheet/addCustomFunction/index.md' %}{% endcodeBlock %}\n     * @param {string} functionHandler - Custom function handler name\n     * @param {string} functionName - Custom function name\n     */\n    Spreadsheet.prototype.addCustomFunction = function (functionHandler, functionName) {\n        _super.prototype.addCustomFunction.call(this, functionHandler, functionName);\n        this.notify(refreshFormulaDatasource, null);\n    };\n    var Spreadsheet_1;\n    __decorate([\n        Property('')\n    ], Spreadsheet.prototype, \"cssClass\", void 0);\n    __decorate([\n        Property(true)\n    ], Spreadsheet.prototype, \"allowScrolling\", void 0);\n    __decorate([\n        Property(true)\n    ], Spreadsheet.prototype, \"allowResizing\", void 0);\n    __decorate([\n        Property(true)\n    ], Spreadsheet.prototype, \"enableClipboard\", void 0);\n    __decorate([\n        Property(true)\n    ], Spreadsheet.prototype, \"enableContextMenu\", void 0);\n    __decorate([\n        Property(true)\n    ], Spreadsheet.prototype, \"enableKeyboardNavigation\", void 0);\n    __decorate([\n        Property(true)\n    ], Spreadsheet.prototype, \"enableKeyboardShortcut\", void 0);\n    __decorate([\n        Property(true)\n    ], Spreadsheet.prototype, \"allowUndoRedo\", void 0);\n    __decorate([\n        Property(true)\n    ], Spreadsheet.prototype, \"allowWrap\", void 0);\n    __decorate([\n        Complex({}, SelectionSettings)\n    ], Spreadsheet.prototype, \"selectionSettings\", void 0);\n    __decorate([\n        Complex({}, ScrollSettings)\n    ], Spreadsheet.prototype, \"scrollSettings\", void 0);\n    __decorate([\n        Event()\n    ], Spreadsheet.prototype, \"beforeCellRender\", void 0);\n    __decorate([\n        Event()\n    ], Spreadsheet.prototype, \"beforeSelect\", void 0);\n    __decorate([\n        Event()\n    ], Spreadsheet.prototype, \"select\", void 0);\n    __decorate([\n        Event()\n    ], Spreadsheet.prototype, \"contextMenuBeforeOpen\", void 0);\n    __decorate([\n        Event()\n    ], Spreadsheet.prototype, \"fileMenuBeforeOpen\", void 0);\n    __decorate([\n        Event()\n    ], Spreadsheet.prototype, \"contextMenuBeforeClose\", void 0);\n    __decorate([\n        Event()\n    ], Spreadsheet.prototype, \"dialogBeforeOpen\", void 0);\n    __decorate([\n        Event()\n    ], Spreadsheet.prototype, \"fileMenuBeforeClose\", void 0);\n    __decorate([\n        Event()\n    ], Spreadsheet.prototype, \"contextMenuItemSelect\", void 0);\n    __decorate([\n        Event()\n    ], Spreadsheet.prototype, \"fileMenuItemSelect\", void 0);\n    __decorate([\n        Event()\n    ], Spreadsheet.prototype, \"beforeDataBound\", void 0);\n    __decorate([\n        Event()\n    ], Spreadsheet.prototype, \"dataBound\", void 0);\n    __decorate([\n        Event()\n    ], Spreadsheet.prototype, \"dataSourceChanged\", void 0);\n    __decorate([\n        Event()\n    ], Spreadsheet.prototype, \"cellEdit\", void 0);\n    __decorate([\n        Event()\n    ], Spreadsheet.prototype, \"cellEditing\", void 0);\n    __decorate([\n        Event()\n    ], Spreadsheet.prototype, \"cellSave\", void 0);\n    __decorate([\n        Event()\n    ], Spreadsheet.prototype, \"beforeCellSave\", void 0);\n    __decorate([\n        Event()\n    ], Spreadsheet.prototype, \"created\", void 0);\n    __decorate([\n        Event()\n    ], Spreadsheet.prototype, \"beforeSort\", void 0);\n    __decorate([\n        Event()\n    ], Spreadsheet.prototype, \"beforeHyperlinkCreate\", void 0);\n    __decorate([\n        Event()\n    ], Spreadsheet.prototype, \"afterHyperlinkCreate\", void 0);\n    __decorate([\n        Event()\n    ], Spreadsheet.prototype, \"beforeHyperlinkClick\", void 0);\n    __decorate([\n        Event()\n    ], Spreadsheet.prototype, \"afterHyperlinkClick\", void 0);\n    __decorate([\n        Event()\n    ], Spreadsheet.prototype, \"actionBegin\", void 0);\n    __decorate([\n        Event()\n    ], Spreadsheet.prototype, \"actionComplete\", void 0);\n    __decorate([\n        Event()\n    ], Spreadsheet.prototype, \"openComplete\", void 0);\n    __decorate([\n        Event()\n    ], Spreadsheet.prototype, \"sortComplete\", void 0);\n    Spreadsheet = Spreadsheet_1 = __decorate([\n        NotifyPropertyChanges\n    ], Spreadsheet);\n    return Spreadsheet;\n}(Workbook));\nexport { Spreadsheet };\n","import * as index from './index';\nindex.Spreadsheet.Inject(index.Clipboard, index.Edit, index.KeyboardNavigation, index.KeyboardShortcut, index.CollaborativeEditing, index.Selection, index.ContextMenu, index.FormulaBar, index.Ribbon, index.Save, index.Open, index.SheetTabs, index.DataBind, index.AllModule, index.BasicModule, index.CellFormat, index.NumberFormat, index.Formula);\nexport * from './index';\n"],"names":["getRangeIndexes","range","cellindexes","indexes","indexOf","split","forEach","address","getCellIndexes","push","parseInt","match","getColIndex","toUpperCase","text","colIdx","i","reverse","join","length","charCodeAt","Math","pow","getCellAddress","sRow","sCol","getColumnHeaderText","getRangeAddress","isNullOrUndefined","colIndex","floor","String","fromCharCode","getIndexesFromAddress","getRangeFromAddress","getAddressFromSelectedRange","sheet","name","selectedRange","getAddressInfo","context","sIdx","getSheetIndex","getSheetNameFromAddress","activeSheetIndex","sheetIndex","indices","getSwapRange","clonedRange","slice","swap","x","y","tmp","isSingleCell","executeTaskAsync","taskFn","callbackFn","data","preventCallback","WorkerHelper","toFraction","val","strVal","toString","top_1","bottom","replace","abs","getGcd","a","b","Number","intToDate","Date","getTime","dateToInt","isTime","startDate","date","isDateTime","startDateUTC","UTC","getFullYear","getMonth","getDate","getHours","getMinutes","getSeconds","getMilliseconds","diffDays","Object","prototype","call","isNaN","valueOf","isNumber","parseFloat","toDate","intl","format","defaultDateFormats","getDefaultDateObject","availabelDateTimeFormat","dateTimeFormats","availableFormats","dObj","dateObj","isCustom","type","parseDate","_i","_a","keys","dateFormats","key","skeleton","_b","_c","time","toLocaleTimeString","_d","_e","timeFormats","getFormatFromType","code","getTypeFromFormat","isUndefined","value","getSkeletonVal","getModules","modules","includeBasicFormulas","member","args","getValue","nameSpace","obj","splits","j","setValue","keyValues","start","fromObj","undefined","getAlphalabel","col","cols","n","aCharNo","chs","getWorkbookRequiredModules","allowSave","allowOpen","allowEditing","allowNumberFormatting","allowCellFormatting","allowSorting","allowHyperlink","allowFiltering","allowFindAndReplace","allowInsert","allowDelete","allowDataValidation","allowMerge","allowImage","allowChart","checkIsFormula","isCellReference","rangeSplit","isValidCellReference","isChar","inRange","rowIdx","isLocked","cell","column","endNum","numArr","cellText","textLength","cellTextLength","substring","cellNumber","getCell","rowIndex","isInitRow","returnEmptyObjIfNull","row","getRow","cells","rows","setCell","isExtend","extend","skipDefaultValue","style","defaultKey","defaultProps","fontFamily","verticalAlign","textIndent","backgroundColor","color","textAlign","fontSize","fontWeight","fontStyle","textDecoration","border","borderLeft","borderTop","borderRight","borderBottom","changedProps","propName","wrap","addressInfo","rng","getSheet","setProperties","sheets","notify","wrapEvent","getData","columnWiseData","valueOnly","Promise","resolve","reject","Map","sheetIdx","index","promise","updateSheetFromDataSource","then","getValueFromFormat","cellObj","assign","colSpan","rowSpan","cell_1","len","k","len_1","formula","isHiddenRow","isHiddenCol","eventArgs","trigger","queryCellInfo","set","getDisplayText","isDate","checkDateFormat","getModel","model","idx","diff","prevIdx","splice","processIdx","isSheet","cnt","out_i_1","createSheet","id","getMaxSheetId","setSheetPropertyOnMute","getSheetNameCount","cellCnt_1","max","clearRange","sCIdx","eCIdx","sRIdx","eRIdx","cFDelete","toLowerCase","getSheetIndexFromId","getSheetIndexByName","info","updateSelectedRange","getSelectedRange","sheetNameCount","initSheet","rowCount","colCount","topLeftCell","activeCell","usedRange","ranges","columns","showHeaders","showGridLines","state","maxHgts","protectSettings","selectCells","formatCells","formatRows","formatColumns","insertLink","isProtected","initRow","getSheetName","setRow","hidden","getRowHeight","height","setRowHeight","getRowsHeight","startRow","endRow","getColumn","setColumn","curColumn","getColumnWidth","skipHidden","width","customWidth","getColumnsWidth","startCol","endCol","getRequiredModules","pushBasicModules","showRibbon","showFormulaBar","showSheetTabs","enableContextMenu","selectionSettings","mode","enableKeyboardNavigation","enableKeyboardShortcut","enableClipboard","allowResizing","allowUndoRedo","allowWrap","allowConditionalFormat","getUpdateUsingRaf","fn","requestAnimationFrame","removeAllChildren","parent","firstChild","removeChild","getColGroupWidth","getScrollBarWidth","scrollAreaWidth","htmlDivNode","document","createElement","result","cssText","body","appendChild","offsetWidth","clientWidth","getSiblingsHeight","element","classList","classes","getHeightFromDirection","direction","sibling","some","contains","offsetHeight","inView","isModify","scrollSettings","enableVirtualization","topIdx","viewport","topIndex","leftIdx","leftIndex","bottomIdx","getThreshold","rightIdx","inView_1","getCellPosition","offset","left","size","top","locateElem","ele","isRtl","swapRange","cellPosition","startIndex","skipHiddenIdx","attrs","setStyleAttribute","styles","setBaseStyleAttribute","getStartEvent","Browser","isPointer","getMoveEvent","getEndEvent","isTouchStart","e","pointerType","isTouchMove","isTouchEnd","getClientX","changedTouches","clientX","getClientY","clientY","setAriaOptions","target","options","setAttribute","config","destroyComponent","component","compObj","getComponent","destroy","setResize","isCol","curEle","curEleH","curEleC","preEle","preEleH","preEleC","nxtEle","nxtEleH","getActiveSheet","getElementsByClassName","getElementsByTagName","hdrRow","getRowHeaderContent","hdrClone","cloneNode","hdrFntSize","findMaxValue","getRowHeaderTable","contentRow","getMainContent","contentClone","cntFntSize","getContentTable","fntSize","add","lineHeight","removeProperty","remove","previousElementSibling","nextElementSibling","setWidthAndHeight","nxtIndex","getAttribute","getColHeaderTable","trgt","table","prevData","isWrap","myTableDiv","className","myTable","myTr","tr","offsetWidthValue","offsetHeightValue","getBoundingClientRect","ceil","updateAction","spreadsheet","isRedo","action","sortArgs","sortOptions","cancel","initiateSort","serviceLocator","getService","refreshRange","cellEvtArgs","cellValue","updateCell","requestType","cellFormat","numberFormat","copiedInfo","isCut","cut","copiedRange","copy","paste","pastedRange","isShow","hide","setColWidth","hideColumn","hideRow","removeSheetTab","isAction","count","sheetCount","clicked","endIndex","compareVal","initiateFilterUI","predicates","delete","modelType","insertModel","end","checkCount","deletedModel","columnCellsModel","deletedCellsModel","rules","operator","value1","value2","ignoreBlank","inCellDropDown","setValidation","removeValidation","setMerge","clearViewer","isPublic","conditionalFormat","cFColor","setCFRule","clearCFRule","clearCells","conditionalFormats","cFormats","oldRange","createImageElement","src","imageData","imageHeight","imageWidth","imageId","isUndoRedo","deleteImage","getElementById","refreshImgCellObj","prevTop","currentTop","prevLeft","currentLeft","currentHeight","prevHeight","currentWidth","prevWidth","chartOptions","theme","isSeriesInRows","setChart","chart","isInitCell","posRange","deleteChart","chartOpts","chartElement","refreshChartSize","overlayEle","hasTemplate","workbook","template","startCell","setRowEleHeight","hRow","notifyRowHgtChange","prevHgt","edit","querySelector","innerHTML","actCell","splitVal","valLength","lines","getLines","cellStyle","getTextHeight","rowHeightChanged","threshold","fontSizePx","getTextWidth","parentStyle","getContext","font","measureText","colwidth","textArr","spaceWidth","txt","lWidth","cWidth","setMaxHgt","rIdx","cIdx","hgt","getMaxHgt","maxHgt","rowHgt","increase","layout","task","defaultListener","taskData","this","workerTask","workerData","initWorker","terminate","worker","URL","revokeObjectURL","workerUrl","taskBlob","Blob","getFnCode","createObjectURL","Worker","onmessage","messageFromWorker","bind","onerror","onError","postMessage","apply","message","workerCode","workerFunction","isHaveFunction","getMessageFn","getCallbackMessageFn","setCellFormat","applyCellFormat","workbookFormulaOperation","goto","showDialog","WorkbookNumberFormat","localeObj","getNumericObject","locale","decimalSep","decimal","groupSep","group","addEventListener","numberFormatting","getFormattedCell","fResult","rightAlign","currencySymbol","getNumberDependable","dateEventArgs","updatedVal","processFormats","isRightAlign","curSymbol","onLoad","setUsedRange","formattedText","Internationalization","autoDetectGeneralFormat","curCode","applyNumberFormat","currencyFormat","percentageFormat","accountingFormat","shortDateFormat","longDateFormat","timeFormat","fractionFormat","scientificFormat","res","trim","isEdit","findSuffix","zeros","resultSuffix","suffixLen","substr","isCustomFormat","formatArr","formatNumber","currency","shortDate","formatDate","longDate","prefix","findDecimalPlaces","toExponential","fractionResult","suffix","eIndex","decIndex","checkedDate","checkCustomDateFormat","dateArr","months","formattedBarText","beforeText","on","removeEventListener","isDestroyed","off","getModuleName","DataBind","requestedInfo","updateSheetFromDataSourceHandler","dataSourceChangedHandler","dataChangedHandler","flds","sCellIdx","remoteUrl","dataManager","sRowIdx","sColIdx","loadedInfo","_this","requestedRange","sRanges","deferred","Deferred","this_1","sRange","eRange","dataSource","DataManager","url","isLocalData","showFieldAsHeader","isEndReached","insertRowCount","initRangeInfo","getMaxCount","getLoadedInfo","unloadedRange","insertRowRange","isNotLoaded","query","Query","clone","executeQuery","requiresCount","fldLen","insertColumnRange","insertCount_1","insertRange","field","includes","item","getCellDataFromProp","checkDataForFormat","loadedRange","rangeSettingCount","unloadedArgs","pop","checkResolve","resolved","isSameRng","JSON","stringify","isLoaded","prop","hyperlink","queries","min","nos","rangeIdx","checkRangeHasChanges","showFieldAsHeader_1","indexes_1","refreshRange_1","bottomIndex","rightIndex","args_1","isAngular","dataRange","deleteRowDetails","cellIndices","changedData","isNewRow","concat","insertType","fld","rangeIndex","initialLoad","editOperation","click","keyUp","keyDown","cMenuBeforeOpen","hideShow","autoFit","completeAction","beginAction","gotoDlg","findDlg","WorkbookOpen","open","jsonObject","fetchSuccess","formData","FormData","file","isOpen","append","requestData","method","fetch","openUrl","response","ok","json","status","statusText","catch","error","fetchFailure","openError","workbookData","impData","parse","Workbook","updateModel","workbookModel","setSelectAllRange","definedNames","isImport","selectedIndex","SaveWorker","processSheet","Array","isArray","processSave","saveJSON","saveSettings","customParams","blob","reader","FileReader","onload","str","atob","dialog","readAsDataURL","__extends","extendStatics","d","setPrototypeOf","__proto__","p","hasOwnProperty","__","constructor","create","WorkbookSave","_super","isProcessCompleted","isFullPost","needBlobData","initiateSave","saveType","fileName","updateBasicSettings","processSheets","jsonStr","getStringifyObject","basicSettings","updateSheet","getSheetLength","save","initiateFullPostSave","updateSaveResult","blobData","content","ClientFileDownload","anchor","download","getFileNameWithExtension","href","formElem","inputElem","submit","detach","skipProp","properties","filename","fileExt","getFileExtension","lastIndexOf","CalculateCommon","ModuleLoader","loadedModules","inject","requiredModules","moduleList","reqLengthVal","clean","clearUnusedModule","modl","moduleList_1","module","modName","isModuleLoaded","moduleObject","createInstance","memberName","getMemberName","isProperty","loadedModule","classFunction","params","arrayParam","unshift","Function","moduleListName","usedModule","map","arg","removeModule_1","filter","moduleName","deleteObject","CommonErrors","FormulasErrorsStrings","BasicFormulas","formulas","formulaName","category","description","isConcat","init","addFormulaCollection","functionName","formulaCategory","libraryFormulas","fName","handler","ComputeSUM","arguments","formulaErrorStrings","invalid_arguments","orgValue","sum","argArr","argValue","cellCollection","getCellCollection","tic","getValueFromArg","getErrorStrings","trueValue","falseValue","ComputeINT","num","ComputeTODAY","dt","now","calculateDate","ComputeSUMPRODUCT","mulValues","startsWith","s1","col1","col2","cellRef","convertAlpha","ComputeROUNDUP","arg1","arg2","toFixed","digits","ComputeCOUNT","wrong_number_arguments","argVal","cellColl","ComputeDATE","year","month","day","days","getSerialDateFromDate","fromOADate","ComputeFLOOR","fnum","significance","argCount","splitArg","divzero","ComputeCEILING","cnum","ComputeDAY","serialNumber","dateVal","ComputeIF","condition","requires_3_args","ComputeIFERROR","arithMarker","ComputePRODUCT","parseVal","product","argsHit","rangevalue","ComputeDAYS","argsArr","endDate","toDateString","d1","d2","round","ComputeCHOOSE","cond","indexNum","ComputeSUMIF","improper_formula","computeSumIfAndAvgIf","ComputeABS","absValue","absVal","cellvalue","ComputeAVERAGE","calculateAvg","ComputeAVERAGEIF","argList","resultVal","ComputeCONCATENATE","argsList","tempStr","i_1","ComputeCONCAT","ComputeMAX","computeMinMax","ComputeMIN","ComputeRAND","random","ComputeAND","computeAndOr","ComputeOR","ComputeFIND","findText","removeTics","withinText","loc","startNum","ComputeINDEX","ref","rangeValue","rangeArr","i_2","ComputeIFS","na","ComputeCOUNTA","ComputeAVERAGEA","cellCol","parseValue","argArrs","ComputeCOUNTIF","stack","op","findWildCardValue","processLogical","ComputeSUMIFS","computeIfsFormulas","ComputeTEXT","checkArgs","argsLength","splitIndex","frtArg","scndArg","checkScndArg","s2","dTime","checkString","parseDouble","toOADate","formatChar","isH","isMFound","lastCharIndex","totalCharforM","c","getSkeleton","getDateFormat","ComputeCOUNTIFS","ComputeAVERAGEIFS","ComputeMATCH","lookupVal","matchType","indexVal","ComputeLOOKUP","computeLookup","ComputeVLOOKUP","computeVLookup","ComputeSUBTOTAL","ComputeRADIANS","radVal","PI","ComputeRANDBETWEEN","ComputeSLOPE","yPoints","xPoints","xPointsRange","yPointsRange","getDataCollection","sumXY","sumX2","sumX","sumY","ComputeINTERCEPT","xValues","yValues","yValuesRange","xValuesRange","ComputeLN","logValue","logVal","log","ComputeISNUMBER","ComputeROUND","numStr","digStr","mult","ComputePOWER","orgNumValue","orgPowValue","logNumValue","logPowValue","ComputeLOG","orgBaseValue","logBaseValue","LN10","ComputeTRUNC","normalizer","orgDigitValue","ComputeEXP","exp","ComputeGEOMEAN","dev","r","s","cellVal","cellsData","NaN","Parser","emptyStr","storedStringText","sheetToken","tokenAdd","tokenSubtract","tokenMultiply","tokenDivide","tokenLess","charEm","charEp","tokenGreater","tokenEqual","tokenLessEq","tokenGreaterEq","tokenNotEqual","tokenAnd","tokenEm","tokenEp","tokenOr","charAnd","charLess","charGreater","charEqual","charLessEq","charGreaterEq","charNoEqual","stringGreaterEq","stringLessEq","stringNoEqual","stringAnd","stringOr","charOr","charAdd","charSubtract","charMultiply","charDivide","fixedReference","spaceString","ignoreBracet","isError","isFormulaParsed","findNamedRange","stringsColl","tokens","charNOTop","specialSym","isFailureTriggered","fkey","isTextEmpty","getFormulaCharacter","namedRanges","storedData","checkForNamedRangeAndKeyValue","formulaString","storeStrings","indexOfAny","family","getSheetFamilyItem","grid","sheetNameToParentObject","setTokensForSheets","getSheetToken","scopedRange","checkScopedRange","markLibraryFormulas","formulaAutoCorrection","ex","exception","isForceCalculable","formulaCorrection","computeForceCalculate","invalid_expression","get","formulaText","FormulaError","mismatched_parentheses","empty_expression","parseSimple","exceptionArgs","errorMessage","getErrorLine","setStrings","arithemeticArr","logicalSym","form","firstOp","secondprevOp","secondnextOp","firstDigit","secondDigit","countDigit","isDigit","rightBracket","has","leftBracket","isUpperChar","getParseArgumentSeparator","getSheetID","v","token","sheetNameToToken","s_1","parentObject","getNamedRanges","tempString","storedString","mismatched_tics","expTokenArray","mulTokenArray","addTokenArray","mulCharArray","addCharArray","compareTokenArray","compareCharArray","expCharArray","andTokenArray","andCharArray","orCharArray","orTokenArray","parseSimpleOperators","markers","operators","right","findLeftMarker","cannot_parse","bracketCount","l","period","getParseDecimalSeparator","number_contains_2_decimal_points","getCellFrom","updateDependentCell","expression_cannot_end_with_an_operator","uFound","findRightMarker","jTemp","inbracket","noCellReference","arithMarker2","isCharacter","checkLetter","oneTokenFound","textLen","ret","bracketLevel","parseFormula","fKey","bracCount","rightParens","markNamedRanges","parenCount","leftParens","libFormula","getFunction","swapInnerParens","addParensToArgs","fSubstr","rightSides","marker","lastIndexOfAny","oneTimeOnly","getTableRange","namerangeValue","findNextEndIndex","found","__decorate","decorators","desc","getOwnPropertyDescriptor","Reflect","decorate","defineProperty","Calculate","lFormulas","keyToRowsMap","rowsToKeyMap","emptyString","leftBrace","rightBrace","cellPrefix","treatEmptyStringAsZero","singleTic","parseDecimalSeparator","dependentCells","dependentFormulaCells","minValue","MIN_SAFE_INTEGER","maxValue","MAX_SAFE_INTEGER","categoryCollection","dependencyLevel","refreshedCells","computedValues","randomValues","isRandomVal","randCollection","errorStrings","parseArgumentSeparator","dateTime1900","isParseDecimalSeparatorChanged","isArgumentSeparatorChanged","sheetFamilyID","defaultFamilyItem","sheetFamiliesList","modelToSheetID","tokenCount","sortedSheetNames","tempSheetPlaceHolder","formulaInfoTable","oaDate","millisecondsOfaDay","parseDateTimeSeparator","moduleLoader","Calculate_1","Inject","injectedModules","parser","formulaColl","enumerable","configurable","setParseArgumentSeparator","getParseDateTimeSeparator","setTreatEmptyStringAsZero","getTreatEmptyStringAsZero","setParseDateTimeSeparator","getInjectedModules","onPropertyChanged","newProp","oldProp","charCode","resetKeys","clear","parentObjectToToken","getDependentCells","formulaCells","addToFormulaDependentCells","cell1","getDependentFormulaCells","isSheetMember","sheetDependentCells","sheetDependentFormulaCells","getLibraryFormulas","getFormulaInfoTable","sheetFormulaInfotable","getFormula","getFormulaText","setParseDecimalSeparator","temp","bad_index","grd","isLetter","CalcSheetFamilyItem","setKeyValue","FormulaInfo","fInfo","clearFormulaDependentCells","setFormulaText","getFormulaValue","setParsedFormula","setFormulaValue","dependentFormula","dependent","arrayRemove","array","getKeyValue","fText","computeFormula","getParsedFormula","addNamedRange","sheetScopeName","removeNamedRange","arrCol","aCharValue","arr","cellRange","sheetTokenIndex","row1","row2","parsedText","lastIndexOfq","formulatResult","fNested","nestedFormula","findLastIndexOfq","sFormula","customArgs","processNestedFormula","q","computeValue","criteria","opt","checkCriteria","criteriaRangeArray","sumRange","criteriaRange","getComputeSumIfValue","checkCrte","findMaxVal","criterias","lookupRangeArray","lookupRange","maxVal","sort","minVal","lookupValue","firstCol","secCol","lookupCol","lookupCell","lookVal","finalText","checStr1","checStr2","newIndex","compRight","compLeft","leftVal","rightVal","val1","sumRangeVal","tempdate","last","r1","c1","c2","r2","pFormula","textName","getParentObjectCellValue","stackValue","errIndex","getValArithmetic","countValue","num1","num2","val2","localeCompare","computeStoreCells","sCell","cellRanges","argArray","isCriteria","storeCell","storedCells","isCountIfs","isCountIfS","countVal","rangeLength","tempStoredCell","newCell","newCount","cellAlpha","newCellAlpha","isAvgIfs","storedCell","startRange","pText","doubleNumber","setTime","isValidMonth","tempDay","dateTime","fString","pObjCVal","symbolArray","f","circular_reference","dateval","cellTxt","sheetToken1","containsBoth","isAlpha","isNum","charArray","sortedSheetNamesCollection","getSortedSheetNames","textSplit","tokenToParentObject","saveCell","cValue","getParentCellValue","getValueRowCol","defineFunction","window","valueChanged","changeArgs","isCalculate","pgrid","isComputedValueChanged","isCompute","calcFamily","getRowIndex","randStrVal","setValueRowCol","getComputedValue","refresh","formulaValue","arr_1","errorStack","createSheetFamilyID","operation","countStrVal","sumCell","avgVal","countNum","registerGridAsSheet","refName","tempRef","unregisterGridAsSheet","refName1","computeExpression","parsedFormula","dispose","refreshRandValues","tokenRef","stringCollection","dCell","formulaInfo","Property","Event","NotifyPropertyChanges","Base","calcID","MIN_VALUE","calcID1","ValueChangedArgs","setRowIndex","setColIndex","WorkbookFormula","uniqueOBracket","uniqueCBracket","uniqueCSeparator","uniqueCOperator","uniquePOperator","uniqueSOperator","uniqueMOperator","uniqueDOperator","uniqueModOperator","uniqueConcateOperator","uniqueEqualOperator","uniqueExpOperator","uniqueGTOperator","uniqueLTOperator","sheetInfo","initCalculate","registerSheet","calculateInstance","performFormulaOperation","aggregateComputation","from","values","formulaCollection","collection","selectCategory","selectedList","updateSheetInfo","unRegisterSheet","autoCorrectFormula","refreshCalculate","isFormula","argumentSeparator","isAdded","addDefinedName","definedName","isRemoved","removeDefinedName","scope","initiateDefinedNames","renameUpdation","sheetId","visibleName","sheetName","length_1","sheetDeletion","refError","referenceError","addCustomFunction","functionHandler","calcValue","sheetID","refreshInsDelFormula","insertArgs","refreshNamedRange","getSheetInfo","delSheetName","rowId","colId","formulaVal","removeSheetTokenIndex","dependentCellRef","updateDataContainer","visible","savedTokens","isSheetRenamed","sheetNames","name_1","sheetData","rowData","colObj","parseSheetRef","regx","escapeRegx","RegExp","cellArgs","referenceCollection","refValue","tempArgs","isEqual","lessEq","greaterEq","equal","lessOp","greaterOp","equalOp","definedname","refersTo","isLink","isValidate","visibleRefersTo","comment","checkIsNameExist","getIndexFromNameColl","calcName","formatedValues","actCellModel","actCellfrmt","countOnly","Count","Sum","Avg","Min","Max","clearFormula","startIdx","refreshFormula","diff1","nAlpha","fArg","ridx","pVal","actSheet","deleteIdxs","splitFormula","updatedFormulaVal","sheetLen","markSpecialChar","isUniqueChar","getUniqueCharVal","newRange","isChanged","modelDefinedNames","definedNameCnt","WorkbookSort","initiateSortHandler","sortDescriptors","containsHeader","workbookLocale","getConstant","getSortDataRange","isSameStyle","header","jsonData","comparerFn","sortComparer","caseSensitive","sortBy","colName","firstCellStyle","secondCellStyle","sameStyle","prevleftIdx","prevrightIdx","topReached","btmReached","leftReached","rightReached","btmIdx","sortDescriptor","order","comparer","DataUtil","fnSort","caseOptions","sensitivity","collator","Intl","Collator","compare","WorkbookFilter","filterRange","initiateFilterHandler","clearAllFilterHandler","filterOptions","datasource","setFilter","filterEventArgs","address_1","where","Predicate","and","result_1","executeLocal","WorkbookImage","setImage","oldImgData","imgRange","imgData","image","WorkbookChart","setChartHandler","refreshChartData","deleteChartColl","focusChartBorder","isPaste","chartCount","isIdAvailabe","idAvailable","option","dataSheetIdx","chartColl","charts","isInRange","rangeSheetIdx","chartCnt","sheetCnt","chartObj","excelFilter","chartEle","closest","isRefresh","overlayElement","WorkbookCellFormat","triggerEvent","onActionUpdate","borderType","setTypedBorder","checkAdjustantBorder","checkFullBorder","setCellBorder","setBottomBorderPriority","isFullBorder","setFullBorder","setCellStyle","lastCell","isHeightCheckNeeded","manualUpdate","refreshRibbon","pIdx","skipHiddenRows","getCellStyleValue","bottomPriority","actionUpdate","style_1","textDecorationActionUpdate","changedStyle","changedValue","activeCellIndexes","removeProp","prevBorder","first","clearCellObj","eColIdx","clrRange","eRowIdx","WorkbookEdit","performEditOperation","updateCellValue","isValueOnly","checkDecimalPoint","parseIntValue","test","WorkbookHyperlink","setLinkHandler","cellIdx","cellAddr","WorkbookInsert","mergeCollection","isModel","curIdx","insertCount","cellModel","mergeArgs","id_1","skipHiddenSheets","updateRangeModel","setInsertInfo","totalKey","WorkbookDelete","deleteModel","sheetLength","modelName","deletedCells","prevCell","mergeArgsCollection","update","preventRefresh","merge","skipChecking","prevCell_1","setDeleteInfo","total","WorkbookDataValidation","addValidationHandler","removeValidationHandler","addHighlightHandler","removeHighlightHandler","ValidationHandler","isRemoveValidation","validation","InvalidDataHandler","isRemoveHighlightedData","lastRowIdx","lastColIdx","range_1","isCell","isValid","WorkbookFindAndReplace","findNext","findPrevious","replaceAll","totalCount","findAllValues","cidx","valueOfCell","activecell","endColumn","stringValue","startColumn","lcValueOfCell","ivalueOfCell","lowerCaseIndex","searchBy","findNextArgs","loopCount","findNxtRow","findNxtCol","sheetsLen","noCellfound","nextCommon","noFound","rowCol","cellType","cellval","isCSen","isEMatch","lcValue","ivalue","findPrevArgs","findPreRow","findPreCol","usedRan","sheetsLength","noValueBoolean","commonCondition","prevCommon","isTrue","currentCell","findOpt","activecel","replaceAddress","replaceAllCollection","undoRedoOpt","caseInSensitive","replaceValue","replaceAllCollection_1","newValue","replaceAllCollection_2","updateValue","replaceAllCollection_3","startSheet","addressCollection","lowerCaseValue","regExepression","Collection","countNumber","columnIndex","requiredCount","findCount","argsVal","lowerCaseVal","findAllArguments","initialSheet","findCollection","WorkbookProtectSheet","protectsheetHandler","props","unprotectsheetHandler","lockCells","WorkbookMerge","mergedRange","mergeHorizontally","mergeVertically","mergeAll","curCell","getCellValue","mergeCount","activeCellRange","forward","forwardReverse","reverseForward","endRowIdx","endColIdx","isActiveCell","startRowIdx","startColIdx","startRowIndex","colnIdx","cellIndex","rIndex","cIndex","insertHandler","pasteHandler","nextCell","prevSheet","WorkbookConditionalFormat","setCFrulHandler","clearRules","cfrCount","frontColIdx","backColIdx","topRowIdx","bottomRowIdx","isFirst","cFRules","rangeIndexes","cFRulesIdx","isPresent","cFRule","cFRanges","cFRangeIdx","isFull","cFRangeIndexes","cFRRowIdx","cFRColIdx","rRowIdx","rColIdx","WorkbookBasicModule","WorkbookAllModule","CellStyle","ChildProperty","FilterCollection","DefineName","ProtectSettings","Hyperlink","Validation","Format","Complex","ConditionalFormat","Chart","Image","localeData","SortOutOfRangeError","Cell","Range","muteOnChange","isComplexArraySetter","setTimeout","tagObjects","instance","hasChanges","isInitChanges","changedRangeIdx","rangeIdx_1","list","UsedRange","Sheet","ServiceLocator","services","register","__assign","t","Workbook_1","commonCellStyle","initWorkbookServices","dataBind","initEmptySheet","preRender","refreshing","L10n","render","getPersistData","addOnPersist","cssProps","cssProp","events.workbookFormulaOperation","removeSheet","appendTo","selector","setBorder","insertRow","insertColumn","insertSheet","endSheet","initIdx","hiddenCount","errArgs","openFromJson","saveOptions","saveUrl","saveAsJson","addHyperlink","cellAddress","findHandler","replaceHandler","replaceBy","protectSheet","unprotectSheet","events.initiateSort","addDataValidation","events.setValidation","removeDataValidation","events.removeValidation","addInvalidHighlight","removeInvalidHighlight","events.setCFRule","clearConditionalFormat","events.clearCFRule","wrapText","insertImage","images","insertChart","filterArgs","clearFilter","isProtectedOnChange","Component","Row","Column","role","selected","multiselectable","busy","colcount","Clipboard","externalMerge","contenteditable","getClipboardEle","clearCopiedInfo","tabSwitchHandler","cMenuBeforeOpenHandler","ribbonClickHandler","initCopyIndicator","EventHandler","parentId","focus","activeTab","copiedShapeInfo","hidePaste","l10n","delRowItems","hideRowItems","delColItems","hideColItems","actCellIndex","isCellLocked","enableContextMenuItems","setCopiedInfo","copiedSheet","rfshRange","isExternal","clipboardData","copiedIdx","getCopiedIdx","copyInfo","isInternal","cSIdx","curSheet","selIdx","getExternalCells","internal","cellLength","isRepeative","beginEventArgs","copiedIndex","pictureElem","chartInfo","backgroundImage","pastedCell","imgLen","pasteSheetIndex","pastedPictureElement","pasteType","cRows","inRange_1","copiedCell","isFinite","colInd","externalMergeRow","newFormula","sId","cellElem","oldValue","displayText","cutInfo","updateFilter","select","isFilterCut","filterCollection","fRange","fEndCol","asc","filterCol","filteredCell","cRng","pRng","cIdxValue","difIndex","formulaOperators","splitArray","newAddress","getEmptyStyle","pictureElements","pictureLen","showSpinner","imgRowIdx","offsetTop","isImage","imgColIdx","offsetLeft","getChartElemInfo","isIE","execCommand","hideSpinner","setExternalCells","chartId","copyIndicator","show","isModal","showCloseIcon","beforeOpen","dlgArgs","dialogName","items","enable","regex","setData","preventDefault","html","querySelectorAll","td","textContent","cSpan","rSpan","getStyle","whiteSpace","children","child","char","charAt","Edit","editorElem","editCellData","isCellEdit","isNewValueEdit","isAltEnter","validCharacters","keyCodes","BACKSPACE","SPACE","TAB","DELETE","ESC","ENTER","FIRSTALPHABET","LASTALPHABET","FIRSTNUMBER","LASTNUMBER","FIRSTNUMPAD","LASTNUMPAD","SYMBOLSETONESTART","SYMBOLSETONEEND","SYMBOLSETTWOSTART","SYMBOLSETTWOEND","FIREFOXEQUALPLUS","FIREFOXMINUS","F2","dblClickHandler","mouseDownHandler","keyUpHandler","keyDownHandler","initiateCurPosition","updateFormulaBarValue","addressHandler","initiateRefSelection","refSelectionRender","renderEditor","refreshEditor","refreshFormulaBar","refreshEditorElem","isAppend","trigEvent","refreshCurPos","setCursorPosition","startEdit","endEdit","cancelEdit","editedValue","refreshDependentCellValue","position","altKey","keyCode","altEnter","formulaRefIndicator","parentElement","editValue_1","formulaSheetIdx","trgtElem","shiftKey","ctrlKey","metaKey","isFormulaEdit","isWindows","goTo","fullAddr","hasFormulaSuggSelected","isAlphabet","isNumeric","isNumpadKeys","isSymbolkeys","isFirefoxExceptionkeys","isF2Edit","isBackSpace","isLockCellDelete","editingHandler","editor","contentEditable","spellcheck","preventFormulaReference","cellEle","isDelTemplate","value_1","updateEditCellDetail","initiateEditor","positionEditor","elem","selection","getSelection","createRange","setStart","collapse","removeAllRanges","addRange","suggDdlElem","visibility","editText","curPos","focusOffset","actCellIdx","selectionEnd","curPos_1","addr","tdElem","minHeight","minWidth","editWidth","inlineStyles","enableRtl","updateEditedValue","tdRefresh","oldCellValue","innerText","sheet_1","cellIndex_1","getRefreshNodeArgs","refreshNode","fCode","event","fSize","resetEditState","focusElement","removeAttribute","eventName","originalEvent","textBefore","textAfter","node","anchorNode","nodeType","anchorOffset","setEnd","elemRefresh","editorEle","isSelect","formulaBar","setFormulaBarCurPosition","input","selectionStart","setSelectionRange","el","childNodes","valueLength","Selection","invalidOperators","formulaRange","tableRangesFormula","mouseMoveEvt","mouseMoveHandler","virtualContentLoadedHandler","cellNavigateHandler","selectRange","colWidthChanged","protectHandler","initiateFormulaSelection","clearBorder","getRowIdxFromClientY","getColIdxFromClientX","chartBorderHandler","getActiveCell","getSelectionElement","rowStart","rowEnd","colStart","colEnd","selectRangeByIdx","actRange","createSelectionElement","cont","overlayElem","getSheetElement","activeIdx","isRowSelected","isColSelected","getColumnHeaderContent","which","isSelected","passive","mouseUpHandler","touchEvt","isMobileView","renderModule","setSheetPanelSize","getScrollContent","clientRect","prevIndex","isScrollDown","isScrollUp","isScrollRight","isScrollLeft","clearInterval","scrollInterval","setInterval","scrollTop","scrollLeft","highlightHdr","getScrollLeft","scrollModule","prevScroll","cliRect","initFormulaReferenceIndicator","forRefIndicator","isScrollRefresh","isActCellChanged","isInit","isMergeRange","getOffset","eArgs","UpdateRowColSelected","updateActiveCell","topLeftIdx","isRowRefresh","isColRefresh","rowHdr","colHdr","getHdrIndexes","selectAll","removeClass","addClass","hiddenRowCount","hiddenColCount","processFormulaEditRange","formulaStartSheetIdx","actSheetIdx","parsedVal","ctrlKeyCount","formulaBorder","splitStr","updateFormulaEditRange","dStartCell","dEndCell","focusBorder","startcell","endcell","isChart","minr","minc","maxr","maxc","getEleFromRange","rowCells","startRIndex","startCIndex","endRIndex","endCIndex","tempCells","getRowCells","tdCol","second","borderEleColl","classArr","idx_1","formulaStr","Scroll","initProps","onContentScroll","scrollArgs","prevSize","initScrollValue","scrollRight","getColOffset","cur","prev","preventScroll","updateTopLeftCell","updateNonVirtualCols","scrollDown","getRowOffset","updateNonVirtualRows","refreshUI","Infinity","contentLoaded","onScroll","setScrollEvent","setPadding","allowScrolling","colHeader","rowHeader","scrollWidth","padding","marginBottom","VirtualScroll","scroll","createVirtualElement","container","colVTrack","rowVTrack","vTrack","initScroll","domCount","setScrollCount","translateX","translateY","transform","activeSheetIdx","getRowAddress","getColAddress","updateScrollCount","usedRangeCount","onVerticalScroll","idxDiff","lastIdx","prevTopIdx","skippedHiddenIdx","skipUpdateOnFirst","getThresholdHeight","checkLastIdx","endIdx","onHorizontalScroll","prevLeftIdx","getThresholdWidth","translate","updateColumnWidth","updateUsedRange","getVTrackHeight","updateVTrack","createHeaderElement","heightArr","updateVTrackHeight","updateVTrackWidth","hdrVTrack","cntVTrack","hdrColumn","cntColumn","sizeStr","deInitProps","updateScrollProps","sliceScrollProps","KeyboardNavigation","activeElement","isNavigate","isFilterCell","actIdxes","scrollNavigation","stopPropagation","isScroll","topLeftIdxes","getBottomIdx","getRightIdx","contWidth","KeyboardShortcut","isUndo","toolBarElem","applyFilter","CellFormat","checkHeight","curStyle_1","setLeftBorder","setTopBorder","pRow","pHRow","setThickBorderHeight","customHeight","isFontSize","updateRowHeight","isLastCell","borderSize","firstElementChild","display","getBorderSize","calculateHeight","clearObj","removeHyperlink","Resize","wireEvents","setAutoFitHandler","isRow","trgtEle","setAutofit","wireResizeCursorEvent","setTarget","unWireResizeCursorEvent","unwireEvents","sheetPanel","colResizeHandler","rowResizeHandler","isMouseMoved","offsetSize","offsetY","updateTarget","createResizeHandler","resizeOn","resizeHandler","updateCursor","colIndx","showHiddenColumns","rowIndx","newTrgt","tOffsetV","eOffsetV","tClass","offsetX","resEle","mainContent","contentTable","rowLength","colLength","contentFit","getFloatingElementWidth","autofitValue","resizeStart","getViewportIndex","threshold_1","oldWidth","threshold_2","oldHeight","clientHeight","viewportIdx","curWidth","colgroup","eleHeight","rowHeight","isCustomHgt","actualIdx","skipAppend","rTbody","tBodies","tbody","insertBefore","insertIdx","isFit","floatingWidth","hasFilter","CollaborativeEditing","refreshClients","ShowHide","hideCol","nextIdx","hFrag","frag","rowRenderer","rTBody","tBody","newStartRow","createDocumentFragment","lastElementChild","scrollable","hiddenIndex","beforeViewportIdx","removeCell","scrollWidth_1","appendCell","hColgrp","colgrp","hTable","modelLen","isEnd","cellRenderer","refCell","sheetModule","updateCol","renderColHeader","lastChild","tHead","checkNextBorder","previousSibling","SpreadsheetHyperlink","initiateHyperlinkHandler","editHyperlinkHandler","removeHyperlinkHandler","openHyperlinkHandler","hyperlinkClickHandler","createHyperlinkElementHandler","hyperlinkText","hyperlinkSpan","insertBut","dialogInst_1","cssClass","dialogInstance","hyperlinkContent","buttons","buttonModel","isPrimary","disabled","dlgClickHandler","dialogInst","spreadsheetInst","insertHyperlink","dlgContent","hyperEditContent","cellIndexes","hlOpenHandler","isEmpty","rangeAddr","befArgs","aftArgs","definedNameCheck","sheetIdx_1","isDefinedNamed","rangeAddr_1","addArr","ftrEle","dlgEle","docEle","webEle","webEleText","docEleText","actEle","hasAttribute","hyperEle","isWeb","webContElem","docContElem","listEle","treeCont","isDefinedName","isCellRef","isEnable","hl","dialogElem","Tab","selectedItem","textCont","urlCont","textH","urlH","textInput","urlInput","nodeId","nodeText","expanded","nodeChild","treeObj","TreeView","fields","cellrefCont","cellrefH","cellrefInput","textCont1","textH1","textInput1","sheetCont","sheetH","refCont","UndoRedo","undoCollection","redoCollection","undoRedoStep","setActionData","cutCellDetails","getCellDetails","beforeActionData","cellDetails","getBeforeActionData","beforeDetails","performUndoRedo","undoRedoArgs","performOperation","undoForClipboard","undoForResize","updateUndoRedoIcons","completeArgs","updateUndoRedoCollection","actionList","beforeActionDetails","clearUndoRedoCollection","tab","actionData","checkRefreshNeeded","updateCellDetails","sheetIndex_1","argsEventArgs","WrapText","wrapTextHandler","rowHeightChangedHandler","initial","WRAPTEXT","outerHTML","editElem","defaultStyle","Insert","insert","preventUpdate","refreshSheet","refreshImgElement","Delete","activeSheetDeleted","DataValidation","dataValPopup","listOpen","initiateDataValidationHandler","invalidDataHandler","checkDataValidation","listHandler","parEle","valuesCont","errorEle","primaryBut","listObj","showPopup","isRemoveHighlight","tdEle_1","ddlCont","ddlEle","DropDownList","popupWidth","popupHeight","updateDataSource","change","listValueChange","popup","getIndexes","listValues","isNew","dataValidationContent","cellRangeCont","allowDataCont","ignoreBlankCont","cellRangeText","cellRangeEle","allowCont","dataCont","allowText","typeData","operatorData","allowSelectEle","allowIdx","dataIdx","dataText","dataSelectEle","FormattedValue","dataList","userInput","ignoreBlankEle_1","CheckBox","label","checked","minimumCont","maximumCont","minimumText","maximumText","minimumInp","maximumInp","NumericTextBox","valueText","valueEle","isChecked","ignoreBlankEle","listObj1","dlgCont","placeholder","errorMsg","isValidList","dlgFooter","dlgContEle","allowData","allowEle","dataEle","rangeAdd","valArr","isSheetNameValid","isSingleCol","isSingleRow","validDlg","isDialogValidator","tdEle","formValidation","formatValidation","isValidationHandler","enterValue","validationErrorHandler","formEle","inputEle","customPlacement","inputElement","number","FormValidator","validate","erroDialogInst_1","dlgModel","errorDlgHandler","errorDialogInst","buttonName","ProtectSheet","protect","protectSheetHandler","editProtectedAlert","lockCellsHandler","isActive","createDialogue","listData","optionList","ListView","showCheckBox","dialogOpen","protectHeaderCntent","checkbox","listViewElement","headerContent","checkBoxElement","okBtnFocus","beforeClose","checkboxElement","checkBoxClickHandler","selectOption","selectMultipleItems","selectedItems","getSelectedItems","disableHomeBtnId","enableHomeBtnId","enableFrmlaBtnId","enableInsertBtnId","imageBtnId","findBtnId","dataValidationBtnId","chartBtnId","sheetElement","closeOnEscape","close","FindAndReplace","shortValue","renderFindDlg","renderGotoDlg","gotoHandler","replaceAllDialog","findUndoRedo","findKeyUp","eventArgs_1","eventArgs_2","eventArgs_3","dlg","allowDragging","findandreplaceContent","dialogMessage","findDlgClick","prevButton","GotoContent","textFocus","findDlgArgs","findOption","findInput","gotoAlert","checkCase","checkmatch","searchitem","modeitem","find","countArgs","countOpt","replaceWith","caseCheckbox","eMatchCheckbox","searchDDL","modeDDL","replaceMode","gotoaddress","splitAddress","gotoSpan","findSpan","replaceSpan","findValue_1","findValue","findElem","findCheck","findTextE","findTextH","findTextIp","findTextBox","TextBox","replaceTextE","replaceTextH","replaceTextIp","replaceTextBox","withinData","Id","Within","withInDDL","withIn","withinTextH","searchData","Search","searchIn","searchTextH","caaseCheckbox","entirematchCheckbox","gotoElem","gotoTextE","gotoTextH","gotoTextBox","gotoTextIp","Merge","hideHandler","checkPrevMerge","checkMerge","ConditionalFormatting","cFInitialRender","cFInitialCheckHandler","checkConditionalFormatHandler","initiateCFHandler","setCFHandler","cFDeleteHandler","clearCFHandler","addClearCFHandler","setCF","clearCFormats","cCFIdx","isApply","cFIdx","sRangeIdx","newRangeIdxs","cFRowIdx","cFColIdx","sRRowIdx","sRColIdx","cFDlgContent","mainCont","inpEle","getCFColor","cFType","getType","dlgText","getDlgText","mainDiv","subDiv","value1Text","value1Inp","duplicateSelectEle","subDivText","colorSelectEle","dupData","value2Text","value2Inp","colorData","checkCellHandler","cFrange","cFRIdx","formatStyle","cFColors","cFRCheck","setFormat","setProperty","cFRuleIdx","setColor","isActiveCF","rgb","hexToRgb","g","hex","exec","isInitial","cFRuleValue1","cFRuleValue2","valueArr","valueStr","isGreaterThanLessThan","isBetWeen","isEqualTo","isContainsText","isDuplicateUnique","isTopBottomTenValue","isTopBottomTenPercentage","isAboveBelowAverage","isDataBarColorScalesIconSets","applyDataBars","applyColorScale","applyIconSet","selIndexes","rIdx_1","cIdx_1","iconList","getIconList","rIdx_2","getNumericArray","n1","n2","currentSymbol","minPercent","percent1","percent2","percent3","cfIcon","applyIconSetIcon","activeObj","activeEle","iconName","colors","getColor","rIdx_3","hexcode","getGradient","posColor","negColor","topVal","posArr","negArr","leftStandardWidth","rIdx_4","databar","leftSpan","rightSpan","dataSpan","iconSetSpan","cfColor","colorCodeArr","colorArr","middle","large","getLinear","center","byteLinear","isGrearThan","txtRegx","input1","input2","dateEventArgs1","dateEventArgs2","dateTimeArgs","inp","isTop","dataArray","cFRuleIndexes","dataArr","considerCount","isAbove","rangeColl","average","RibbonHeader","RibbonItem","Item","Ribbon","getUniqueID","renderRibbon","expandCollapseElem","ribbonExpandCollapse","menuItems","fileMenu","toolbarObj","tabObj","getTabItems","tabItems","initMenu","menu","menuObj","Menu","showItemOnClick","parentItem","beforeItemRender","tabElement","tBarElement","Toolbar","selectedTab","getIndex","animation","next","duration","previous","selecting","selectingIndex","updateToolbar","created","refreshOverflow","collapseBtn","decrement","enableMenuItems","isUniqueId","enableItems","hideMenuItems","menuInstance","hideItems","showItems","addMenuItems","insertAfter","hideTabs","tabs","stateChanged","isAllHidden","getTabIndex","allHidden","enableTabs","enableTab","addTabs","addTab","headerText","addToolbarItems","tabIdx","disable","hideToolbarItems","MenuItem","ColorPicker","fontColorPicker","ColorPickerComponent","showButtons","presetColors","fontColor","enableOpacity","beforeCloseHandler","openHandler","beforeModeSwitch","currentValue","rgba","previousValue","updateSelectedColor","wireFocusEvent","filColorPicker","fillColor","borderBottomColor","title","inst","modeSwitcher","fontNameIndex","numPopupWidth","RibbonColorPicker","initRibbon","ribbon","createMobileView","createRibbon","getRibbonMenuItems","iconCss","getRibbonItems","prefixIcon","tooltipText","getPasteBtn","getNumFormatDDB","getFontNameDDB","getFontSizeDDB","getBtn","getBordersDBB","getMergeSplitBtn","getTextAlignDDB","getVerticalAlignDDB","getHyperlinkDlg","datavalidationDDB","getLocaleText","getCFDBB","getChartDBB","getClearDDB","getSortFilterDDB","getFindDDb","btn","pasteSplitBtn","SplitButton","setClass","getLocaleProtectText","ribbonElement","RibbonComponent","fileMenuItemSelect","fileMenuBeforeOpen","fileMenuBeforeClose","toolbarClicked","ribbonCreated","tabSelecting","expandCollapse","expandCollapseHandler","beforeFileMenuItemRender","beforeRenderHandler","uiUpdate","refEle","refreshRibbonContent","numFormatBtn","numFormatDDB","DropDownButton","getNumFormatDdbItems","numDDBSelect","numDDBOpen","previewNumFormat","tBarDdbBeforeOpen","fontSizeDdb","refreshSelected","chartMenu","orientation","bar","area","line","pie","radar","scatter","chartSelected","column1Text","column1Cont","column2Cont","clusteredColumn","stackedColumn","stackedColumn100","clusteredColumn3D","stackedColumn3D","stackedColumn1003D","bar1Text","bar1Cont","bar2Cont","clusteredBar","stackedBar","stackedBar100","clusteredBar3D","stackedBar3D","stackedBar1003D","areaText","areaCont","defArea","stackedArea","stackedArea100","lineText","lineCont","defLine","stackedLine","stackedLine100","pieText","pieCont","defPie","doughnut","radarText","radarCont","defradar","radarMarkers","scatterText","scatterCont","defscatter","ul","chartDdb","chartBtn","cFMenu","dataBars","colorScales","iconSets","cFSelected","db1","db2","bBar","gBar","rBar","oBar","lBBar","pBar","cs1","cs2","cs3","gyr","ryg","gwr","rwg","bwr","rwb","wr","rw","gw","wg","gy","yg","is1","is2","is3","is4","is5","is6","is7","is8","directional1","directional2","directional3","directional4","directional5","directional6","directional7","shapes1","shapes2","shapes3","shapes4","shapes5","indicators1","indicators2","indicators3","ratings1","ratings2","ratings3","ratings4","ratings5","cFDdb","tag","cPickerWrapper","bordersMenu","separator","colorPicker","cPickerEle","onOpen","overflow","borderSelected","inline","bordersDdb","eleId","prevStyleId_1","toggle","fontNameBtn","fontNameDdb","getFontFamilyItems","refreshFontNameSelection","bindEvent","btnObj","Button","isToggle","toggleBtnClicked","datavalidationDdb","textAlignDdb","alignItemRender","verticalAlignDdb","mergeSplitBtn","mergeSelectHandler","toggleActiveState","unMerge","itemId","isDataPresent","performMerge","sortingDdb","isFiltered","isClearAll","findToolbtn","findDdb","onclick","findToolDlg","toolbarObj_1","findTextElement","findTextInput","findSpan_1","onkeyup","nextElement","prevElement","onkeydown","findOnKeyDown","toolItemModel","findDialog","toolbarElement_1","dialogDiv","FindDialog","closeDialog","getComputedStyle","calculate","dialogWidth","rightValue","topValue","X","Y","buttonArgs","buttonArg","elements","clearDdb","defaultModel","activeModel","property","refreshToggleBtn","itemKey","setPanelSize","actionArgs","refreshNumFormatSelection","separatorCount","viewportHeight","actualHeight","paddingTop","separatorStyle","borderBottomWidth","marginTop","overflowY","elemList","popWidth","numElem","previewElem","refreshHomeTabContent","refreshDataTabContent","refreshViewTabContent","enableToolbarItems","active","fontProps","selectArgs","evtHArgs","showHideHeaders","toggleRibbonItems","evtglArgs","viewtabHeader","datatabHeader","updateToggleText","len_2","enableFileMenuItems","hideRibbonTabs","addRibbonTabs","updateActiveBorder","updated","updateViewTabContent","updateShowHideBtn","showHideText","updateDataTabContent","updateProtectBtn","protectText","toobar","align","renderMobileToolbar","toolbarPanel","toolbar","ddb","ddbObj","calculatePosition","wrapper","contents","li","enableRibbonTabs","hideFileMenuItems","addFileMenuItems","updateMergeItem","parentElem","ribbonEle","FormulaBar","isGoto","createFormulaBar","insertFnRipple","fBarWrapper","nameBox","comboBoxInstance","ComboBox","noRecordsTemplate","nameBoxBeforeOpen","blur","nameBoxBlur","nameBoxSelect","rippleEffect","textarea","textAreaFocusIn","textAreaFocusOut","formulaPanel","tickBtn","validity","eventArg","UpdateValueAfterMouseUp","isInteracted","itemData","formulaBarUpdateHandler","indexes1","indexes2","intDate","formulaInp","addressRange","updateComboBoxValue","disabletextarea","getFormulaBar","formulaBarScrollEdit","viewportIndexes","formulaBarClickHandler","toggleFormulaBar","names","offsetParent","formulaDescription","categoryContent","dropDownElement","descriptionContent","categoryArgs","categoryList","dropDownSelect","listArgs","formulaList","actionComplete","updateFormulaList","listSelected","dialogBeforeClose","dialogClose","selectFormula","formulaClickHandler","focusOkButton","dialogContentEle","parentNode","storeActiveElement","formulaBarObj","updateFormulaDescription","activeListFormula","firstElement","selectItem","descriptionArea","selectedFormula","descriptionArgs","editOperationHandler","isFormulaBarEdit","Formula","isFormulaBar","isPopupOpened","isPreventClose","isSubFormula","UP","DOWN","LEFT","RIGHT","autocompleteInstance","formulaClick","refreshFormulaDatasource","renderAutoComplete","getNames","getNameFromRange","acElem","autoCompleteOptions","filterType","sortOrder","onSuggestionOpen","onSuggestionClose","onSelect","onSuggestionComplete","AutoComplete","getPopupPosition","refreshPosition","maxHeight","triggerKeyDownEvent","updatedFormulaValue","editValue","getEditingValue","parseIndex","getArgumentSeparator","hidePopUp","getSuggestionKeyFromFormula","refreshFormulaSuggestion","autoCompleteElem","isSuggestionAlreadyOpened","isNavigationKey","dispatchEvent","suggPopupElem","hidePopup","suggestValue","bracketIndex","fSplit","isAlphaNumeric","singleRange","SheetTabs","aggregateContent","isSelectCancel","selaggregateCnt","createSheetTabs","tabInstance","panel","addBtn","addSheetTab","addBtnRipple","getSheetTabItems","dropDownInstance","ddbItems","updateSheetTab","beforeOpenHandler","sheetTab","overflowMode","scrollStep","currentSheetIndex","previousSheetIndex","previousIndex","updateDropDownItems","completeEventArgs","tBarItems","renameSheetTab","spaceKeyDown","positionX","isCollide","refreshSheetTab","insertSheetTab","switchSheetTab","required","maxlength","renameInputFocusOut","updateWidth","spaceLen","removeRenameInput","showRenameDialog","updateSheetName","hideSheet","textEle","sheetItems","focusRenameInput","forceDelete","sheetArgs","destroySheet","removeTab","activeIndex","showAggregate","btnClass","aggregateDropDown","updateAggregateContent","aggregateEle","getAggregateItems","removeAggregate","Open","renderFileUpload","openSuccess","openFailed","uploadID","accept","uploadBox","onchange","fileSelect","filesData","files","impArgs","Save","saveCompleted","showErrorDialog","ContextMenu","initContextMenu","contextMenuInstance","ContextMenuComponent","selectHandler","getInsertModel","getTarget","getDataSource","childElementCount","insertEle","deleteEle","setClipboardData","setFilterItems","setSortItems","setHyperLink","setInsertDeleteItems","setHideShowItems","setProtectSheetItems","clearFilterText","subItems","addItemsHandler","removeItemsHandler","enableItemsHandler","removeItems","NumberFormat","refreshCellElement","Sort","applySortHandler","sortCompleteHandler","initiateCustomSortHandler","isValidSortRange","sortRangeAlertHandler","customSortContent","clearError","errorElem","validateError","headercheck","headerCheckbox","hasHeader","dropDown","hasError","Set","duplicateField","errorField","count_1","dropDownList","getFields","listId","listviewObj","getCustomListview","setHeaderTab","contentElem","listview","renderListItem","fieldName","headerTabElement","addButton","footer","addItem","checkHeaderObj","fieldsMap","dropDownListObj","checkCaseObj","enableRipple","deleteHandler","removeItem","lvObj","orderRadio","isAscending","toLocaleLowerCase","radiobutton","RadioButton","setRadioBtnValue","radio","radiobutton2","radio2","beforeArgs","Filter","filterClassList","filterRangeAlertHandler","initiateFilterUIHandler","filterMouseDownHandler","renderFilterCellHandler","beforeFltrcMenuOpen","beforeFilterMenuOpenHandler","beforeCustomFilterOpen","beforeCustomFilterOpenHandler","reapplyFilterHandler","filterByCellValueHandler","clearFilterHandler","getFilteredColumnHandler","filterCboxValue","filterCboxValueHandler","getFilterRangeHandler","filterCellKeyDownHandler","getFilteredCollection","isInValidFilterRange","addMenuItem","removeFilter","processRange","filterSuccessHandler","predicate","refreshFilterRange","isFilterRange","getColumnType","matchCase","filterBtnObj","filterButton","hasChildNodes","headerCell","filterPopup","pos","openDialog","selectSortItemHandler","xPos","yPos","parentsUntil","filterCell","displayName","checkBoxData","hideSearchbox","filteredColumns","ExcelFilterBase","getLocalizedCustomOperators","sameIndex","filterIndex","getPredicates","predicateList","excelPredicate","CheckBoxFilterBase","getPredicate","numOptr","stringOperator","numberOperator","dateOperator","datetimeOperator","booleanOperator","fil","colCollection","dataType","SpreadsheetImage","pictureCount","renderImageUpload","refreshImgElem","refreshInsDelImagePosition","imageSelect","binaryStringVal","overlayObj","overlay","insertOverlayElement","currCell","currCellObj","imageLen","prevRowIdx","currRowIdx","prevColIdx","currColIdx","prevImgObj","currImgObj","prevCellObj","prevCellImg","prevCellImgLen","currentRowIdx","currentColIdx","imgLength","imgTop","imgleft","rangeVal","ColumnSeries","LineSeries","BarSeries","AreaSeries","StackingColumnSeries","StackingLineSeries","StackingBarSeries","ScatterSeries","StackingAreaSeries","Category","Legend","Tooltip","AccumulationChart","PieSeries","AccumulationTooltip","AccumulationDataLabel","AccumulationLegend","SpreadsheetChart","initiateChartHandler","refreshChartCellObj","updateChartHandler","insertChartHandler","chartRangeHandler","chartType","chartCollLen","getPropertyValue","formatObj","series","prevChartObj","currChartObj","prevCellChart","chartEleClassName","processChartRange","xRange","yRange","lRange","trVal","blVal","tlVal","isStringSeries","toIntrnlRange","getRangeData","pushRowData","isYvalue","isDataSrcEnsured","minCol","forArgs","toArrayData","getVirtualXValues","limit","processChartSeries","xValue","yValue","lValue","pArr","inc","dtVal","seriesName","pObj","yInc","sArr","skipFormula","rDiff","cDiff","xName","yName","shape","dataLabel","radius","startAngle","endAngle","innerRadius","explode","explodeOffset","explodeIndex","retVal","primaryYAxisFormat","focusChartRange","borderIdx","eleColl","tdIdx","argsOpt","isRangeSelect","isRowLesser","reqType","shapeType","chartRange","primaryXAxis","majorGridLines","minorGridLines","majorTickLines","minorTickLines","lineStyle","valueType","primaryYAxis","labelFormat","eleRange","chartContent","chartArea","tooltip","load","selectedTheme","beforeResize","cancelResizedEvent","enableSmartLabels","enableAnimation","legendSettings","location","hash","accumulation","chartElements","chartLength","isRemoveEle","BasicModule","Spreadsheet","AllModule","ScrollSettings","SelectionSettings","Custom","defaultLocale","FindValue","ReplaceValue","FindReplaceTooltip","InsertingEmptyValue","ReplaceAllEnd","ByRow","ByColumn","MatchCase","MatchExactCellElements","Replace","Find","Goto","EntercellAddress","GotoSpecial","FindNextBtn","FindPreviousBtn","ReplaceBtn","ReplaceAllBtn","GotoHeader","GotoSpecialHeader","NoElements","FindWhat","ReplaceWith","Cut","Copy","Paste","PasteSpecial","Link","EditHyperlink","OpenHyperlink","RemoveHyperlink","InsertLink","EditLink","All","Values","Formats","Bold","Font","FontSize","Italic","Underline","Strikethrough","TextColor","FillColor","HorizontalAlignment","AlignLeft","AlignCenter","AlignRight","VerticalAlignment","AlignTop","AlignMiddle","AlignBottom","MergeCells","MergeAll","MergeHorizontally","MergeVertically","Unmerge","UnmergeCells","SelectMergeType","MergeCellsAlert","PasteMergeAlert","Borders","TopBorders","LeftBorders","RightBorders","BottomBorders","AllBorders","HorizontalBorders","VerticalBorders","OutsideBorders","InsideBorders","NoBorders","BorderColor","BorderStyle","InsertFunction","Rename","Hide","Unhide","NameBox","ShowHeaders","HideHeaders","ShowGridLines","HideGridLines","AddSheet","ListAllSheets","FullScreen","CollapseToolbar","ExpandToolbar","CollapseFormulaBar","ExpandFormulaBar","File","Home","Formulas","View","New","SaveAs","Update","ExcelXlsx","ExcelXls","CSV","SortAscending","SortDescending","CustomSort","AddColumn","ContainsHeader","CaseSensitive","SortBy","ThenBy","SelectAColumn","SortEmptyFieldError","SortDuplicateFieldError","SortAndFilter","ClearAllFilter","ClearFilterFrom","ReapplyFilter","FilterCellValue","FilterOutOfRangeError","HideRow","HideRows","UnHideRows","HideColumn","HideColumns","UnHideColumns","InsertRow","InsertRows","Above","Below","InsertColumn","InsertColumns","Before","After","DeleteRow","DeleteRows","DeleteColumn","DeleteColumns","Ok","Close","Cancel","Apply","MoreColors","StandardColors","General","Currency","Accounting","ShortDate","LongDate","Time","Percentage","Fraction","Scientific","Text","MobileFormulaBarPlaceHolder","PasteAlert","DestroyAlert","SheetRenameInvalidAlert","SheetRenameEmptyAlert","SheetRenameAlreadyExistsAlert","DeleteSheetAlert","DeleteSingleLastSheetAlert","PickACategory","Description","UnsupportedFile","InvalidUrl","SUM","SUMIF","SUMIFS","ABS","RAND","RANDBETWEEN","FLOOR","CEILING","PRODUCT","INT","ROUNDUP","SUMPRODUCT","TODAY","AVERAGE","AVERAGEIF","AVERAGEIFS","AVERAGEA","COUNT","COUNTIF","COUNTIFS","COUNTA","MIN","MAX","DATE","DAY","DAYS","IF","IFS","CalculateAND","CalculateOR","IFERROR","CHOOSE","INDEX","FIND","CONCATENATE","CONCAT","SUBTOTAL","RADIANS","MATCH","LN","INTERCEPT","SLOPE","DefineNameExists","DefineNameInValid","CircularReference","ShowRowsWhere","OR","AND","CustomFilterDatePlaceHolder","CustomFilterPlaceHolder","CustomFilter","Between","DateTimeFilter","Undo","Redo","DateFilter","TextFilter","NumberFilter","ClearFilter","NoResult","FilterFalse","FilterTrue","Blanks","SelectAll","GreaterThanOrEqual","GreaterThan","LessThanOrEqual","LessThan","NotEqual","Equal","Contains","EndsWith","StartsWith","ClearButton","FilterButton","CancelButton","OKButton","UnprotectSheet","LockCells","SelectCells","FormatCells","FormatRows","FormatColumns","InsertLinks","ProtectContent","ProtectAllowUser","EditAlert","SearchWithin","SearchBy","Reference","CLEARALL","APPLY","CellRange","Allow","Data","Minimum","Maximum","IgnoreBlank","WholeNumber","Decimal","TextLength","List","NotBetween","EqualTo","NotEqualTo","Greaterthan","Lessthan","GreaterThanOrEqualTo","LessThanOrEqualTo","InCellDropDown","Sources","Value","Retry","EnterValue","DialogError","ListLengthError","ValidationError","EmptyError","ClearHighlight","HighlightInvalidData","ClearValidation","HighlightCellsRules","CFEqualTo","TextThatContains","ADateOccuring","DuplicateValues","TopBottomRules","Top10Items","Top10","Bottom10Items","Bottom10","AboveAverage","BelowAverage","FormatCellsGreaterThan","FormatCellsLessThan","FormatCellsBetween","FormatCellsEqualTo","FormatCellsThatContainTheText","FormatCellsThatContainADateOccurring","FormatCellsDuplicate","FormatCellsTop","FormatCellsBottom","FormatCellsAbove","FormatCellsBelow","With","DataBars","ColorScales","IconSets","ClearRules","SelectedCells","EntireSheet","ISNUMBER","ROUND","GEOMEAN","POWER","LOG","TRUNC","EXP","Clear","ClearContents","ClearAll","ClearFormats","ClearHyperlinks","LightRedFillWithDarkRedText","YellowFillWithDarkYellowText","GreenFillWithDarkGreenText","RedFill","RedText","Duplicate","Unique","And","WebPage","ThisDocument","DisplayText","Url","CellReference","DefinedNames","EnterTheTextToDisplay","EnterTheUrl","BlueDataBar","GreenDataBar","RedDataBar","OrangeDataBar","LightblueDataBar","PurpleDataBar","GYRColorScale","RYGColorScale","GWRColorScale","RWGColorScale","BWRColorScale","RWBColorScale","WRColorScale","RWColorScale","GWColorScale","WGColorScale","GYColorScale","YGColorScale","ThreeArrowsColor","ThreeArrowsGray","ThreeTriangles","FourArrowsColor","FourArrowsGray","FiveArrowsColor","FiveArrowsGray","ThreeTrafficLights1","ThreeTrafficLights2","ThreeSigns","FourTrafficLights","RedToBlack","ThreeSymbols1","ThreeSymbols2","ThreeFlags","ThreeStars","FourRatings","FiveQuarters","FiveRatings","FiveBoxes","Bar","Area","Pie","Doughnut","PieAndDoughnut","Line","Radar","Scatter","ChartDesign","ClusteredColumn","StackedColumn","StackedColumn100","ClusteredBar","StackedBar","StackedBar100","StackedArea","StackedArea100","StackedLine","StackedLine100","SheetRender","freezePane","colGroupWidth","refreshSelectALLContent","getSelectAllTable","headerPanel","updateLeftColGroup","getRowHeaderPanel","detachColGroup","colGrp","colGrpWidth","getSelectAllContent","getColHeaderPanel","getContentPanel","renderPanel","contentPanel","initHeaderPanel","updateHideHeaders","createTable","createHeaderTable","updateTable","rowHdrEle","tagName","renderTable","rHdrTBody","cHdrTHead","cHdrRow","cTBody","attributes","aria-rowcount","aria-colcount","renderRowHeader","initLoad","triggerCreatedEvent","createdHandler","observers","refreshColumnContent","checkColMerge","refreshRowContent","hTBody","checkRowMerge","formatUnit","updateColContent","refChild","hRefChild","skipRender","colRefChild","updateRowContent","rFrag","cKey","firstcell","refreshPrevMerge","currTopIdx","renderHeaders","rowIndexes","colIndexes","cFrag","cTHead","cRow","RowRenderer","isRowHeader","aria-rowindex","CellRenderer","th","tableRow","updateView","aria-colindex","tabindex","checkMerged","compiledTemplate","processTemplates","evtArgs","formatArgs","removeStyle","compileCellTemplate","templateString","compile","clonedCell","previouseHeight","getRowHeightOnInit","tTable","rightBorder_1","bottomBorder_1","prevRowCell","prevColCell","cRange","Render","renderSheet","checkTopLeftCell","lastRow","lastCol","roundValue","roundedValue","instantiateRenderer","Dialog","dialogModel","cancelBtn","btnContent","closeHandler","div","DialogComponent","ActionEvents","initializeActionBegin","beforeCellFormat","actionEventHandler","evtFunc","actionType","eventType","beforeSave","beforeSort","initializeActionComplete","sortComplete","cellSave","actionBeginHandler","actionCompleteHandler","Overlay","isOverlayClicked","isResizerClicked","currenHeight","class","renderResizeHandles","originalWidth","originalHeight","overlayClickHandler","overlayMouseMoveHandler","overlayMouseUpHandler","resizer","height1","originalMouseY","originalResizeTop","resizedReorderTop","width1","pageX","originalMouseX","height2","pageY","width2","originalResizeLeft","resizedReorderLeft","posX","posY","aX","diffX","aY","diffY","originalReorderTop","originalReorderLeft","actOverlayElem","handleElem","handles","needsID","Spreadsheet_1","initServices","renderSpreadsheet","setHeight","setWidth","createSpinner","findAll","addrArr","insideDomCount","cVTrack","rVTrack","vWidth","vHeight","scrollableSize","resize","activeAddress","colThreshold","mIndex","colWidth","eleWidth","oldIdx","edited","maximumColInx","startIsCol","endIsCol","starttoend","startValues","getAddress","endValues","cellMod","eleRowIdx","eleColIdx","isMethod","addrRange","mCell","isDevice","circularArgs","spanElem","alignClass","createTextNode","nodeValue","borderWidth","nextTab","indicator","undo","redo","mouseClickHandler","addContextMenuItems","removeContextMenuItems","closeEdit","newRangeIdx_1","ranges_1","isLastRange","index.Spreadsheet","index.Clipboard","index.Edit","index.KeyboardNavigation","index.KeyboardShortcut","index.CollaborativeEditing","index.Selection","index.ContextMenu","index.FormulaBar","index.Ribbon","index.Save","index.Open","index.SheetTabs","index.DataBind","index.AllModule","index.BasicModule","index.CellFormat","index.NumberFormat","index.Formula"],"mappings":"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C,IACI6P,WAAS,IACVruB,EAAS/tB,UAAW,uBAAoB,IAC3CusC,IACI6P,WAAS,SACVruB,EAAS/tB,UAAW,aAAU,IACjCusC,IACI6P,YAAS,IACVruB,EAAS/tB,UAAW,0BAAuB,IAC9CusC,IACI6P,cACDruB,EAAS/tB,UAAW,uBAAoB,IAC3CusC,IACI6P,WAAS,SACVruB,EAAS/tB,UAAW,YAAS,IAChCusC,IACI6P,YAAS,IACVruB,EAAS/tB,UAAW,iBAAc,IACrCusC,IACI6P,YAAS,IACVruB,EAAS/tB,UAAW,qBAAkB,IACzCusC,IACI6P,YAAS,IACVruB,EAAS/tB,UAAW,oBAAiB,IACxCusC,IACI6P,YAAS,IACVruB,EAAS/tB,UAAW,mBAAgB,IACvCusC,IACI6P,YAAS,IACVruB,EAAS/tB,UAAW,gBAAa,IACpCusC,IACI6P,YAAS,IACVruB,EAAS/tB,UAAW,gBAAa,IACpCusC,IACI6P,YAAS,IACVruB,EAAS/tB,UAAW,mBAAgB,IACvCusC,IACI6P,YAAS,IACVruB,EAAS/tB,UAAW,qBAAkB,IACzCusC,IACI6P,YAAS,IACVruB,EAAS/tB,UAAW,4BAAyB,IAChDusC,IACI6P,YAAS,IACVruB,EAAS/tB,UAAW,0BAAuB,IAC9CusC,IACI6P,YAAS,IACVruB,EAAS/tB,UAAW,qBAAkB,IACzCusC,IACI6P,YAAS,IACVruB,EAAS/tB,UAAW,kBAAe,IACtCusC,IACI6P,YAAS,IACVruB,EAAS/tB,UAAW,kBAAe,IACtCusC,IACI6P,YAAS,IACVruB,EAAS/tB,UAAW,iBAAc,IACrCusC,IACI6P,YAAS,IACVruB,EAAS/tB,UAAW,0BAAuB,IAC9CusC,IACI6P,YAAS,IACVruB,EAAS/tB,UAAW,iBAAc,IACrCusC,IACI6P,YAAS,IACVruB,EAAS/tB,UAAW,iBAAc,IACrCusC,IACI6P,YAAS,IACVruB,EAAS/tB,UAAW,6BAA0B,IACjDusC,IACIyqB,aAAYR,KACbzoC,EAAS/tB,UAAW,gBAAa,IACpCusC,IACI6P,WAAS,KACVruB,EAAS/tB,UAAW,cAAW,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"}