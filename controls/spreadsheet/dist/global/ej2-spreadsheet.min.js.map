{"version":3,"file":"ej2-spreadsheet.min.js","sources":["../../src/workbook/common/address.js","../../src/workbook/common/worker.js","../../src/workbook/common/math.js","../../src/workbook/integrations/number-format.js","../../src/calculate/common/common.js","../../src/calculate/common/module.js","../../src/calculate/common/module-loader.js","../../src/calculate/base/calculate.js","../../src/workbook/common/module.js","../../src/workbook/common/util.js","../../src/workbook/base/cell.js","../../src/workbook/base/row.js","../../src/workbook/base/column.js","../../src/workbook/base/data.js","../../src/workbook/base/sheet.js","../../src/spreadsheet/common/module.js","../../src/spreadsheet/common/util.js","../../src/workbook/common/enum.js","../../src/workbook/common/event.js","../../src/workbook/integrations/data-bind.js","../../src/workbook/integrations/open.js","../../src/workbook/workers/save-worker.js","../../src/workbook/integrations/save.js","../../src/calculate/common/enum.js","../../src/calculate/formulas/basic.js","../../src/calculate/base/parser.js","../../src/workbook/integrations/formula.js","../../src/workbook/actions/cell-format.js","../../src/workbook/actions/edit.js","../../src/workbook/common/basic-module.js","../../src/workbook/common/all-module.js","../../src/workbook/common/class.js","../../src/workbook/base/workbook.js","../../src/spreadsheet/common/event.js","../../src/spreadsheet/actions/clipboard.js","../../src/spreadsheet/actions/edit.js","../../src/spreadsheet/actions/selection.js","../../src/spreadsheet/actions/scroll.js","../../src/spreadsheet/actions/virtual-scroll.js","../../src/spreadsheet/actions/keyboard-navigation.js","../../src/spreadsheet/actions/keyboard-shortcut.js","../../src/spreadsheet/actions/cell-format.js","../../src/ribbon/ribbon.js","../../src/spreadsheet/integrations/color-picker.js","../../src/spreadsheet/integrations/ribbon.js","../../src/spreadsheet/integrations/formula-bar.js","../../src/spreadsheet/integrations/formula.js","../../src/spreadsheet/integrations/sheet-tabs.js","../../src/spreadsheet/integrations/open.js","../../src/spreadsheet/integrations/save.js","../../src/spreadsheet/integrations/context-menu.js","../../src/spreadsheet/integrations/number-format.js","../../src/spreadsheet/common/basic-module.js","../../src/spreadsheet/common/all-module.js","../../src/spreadsheet/common/class.js","../../src/spreadsheet/common/constant.js","../../src/spreadsheet/renderer/sheet.js","../../src/spreadsheet/renderer/row.js","../../src/spreadsheet/renderer/cell.js","../../src/spreadsheet/renderer/render.js","../../src/spreadsheet/services/service-locator.js","../../src/spreadsheet/services/dialog.js","../../src/spreadsheet/base/spreadsheet.js","../../src/global.js"],"sourcesContent":["/**\n * To get range indexes.\n */\nexport function getRangeIndexes(range) {\n    var cellindexes;\n    var indexes = [];\n    range = range.indexOf(':') === -1 ? range + ':' + range : range;\n    range.split(':').forEach(function (address) {\n        cellindexes = getCellIndexes(address);\n        indexes.push(cellindexes[0]);\n        indexes.push(cellindexes[1]);\n    });\n    return indexes;\n}\n/**\n * To get single cell indexes\n */\nexport function getCellIndexes(address) {\n    return [parseInt(address.match(/\\d+/)[0], 10) - 1, getColIndex(address.match(/[A-Z]+/i)[0])];\n}\n/**\n * To get column index from text.\n */\nfunction getColIndex(text) {\n    var colIdx = 0;\n    text = text.split('').reverse().join('');\n    for (var i = text.length - 1; i >= 0; i--) {\n        colIdx += (text[i].charCodeAt(0) - 64) * (Math.pow(26, i));\n    }\n    return colIdx - 1;\n}\n/**\n * To get cell address from given row and column index.\n */\nexport function getCellAddress(sRow, sCol) {\n    return getColumnHeaderText(sCol + 1) + (sRow + 1);\n}\n/**\n * To get range address from given range indexes.\n */\nexport function getRangeAddress(range) {\n    return getCellAddress(range[0], range[1]) + ':' + getCellAddress(range[2], range[3]);\n}\n/**\n * To get column header cell text\n */\nexport function getColumnHeaderText(colIndex) {\n    var alphabet = 'Z';\n    if (colIndex / 26 > 1) {\n        return getColumnHeaderText((colIndex % 26 === 0) ? (colIndex / 26 - 1) : Math.floor(colIndex / 26))\n            + String.fromCharCode((colIndex % 26) === 0 ? alphabet.charCodeAt(0) : 64 + (colIndex % 26));\n    }\n    else {\n        return String.fromCharCode(64 + (colIndex));\n    }\n}\n/**\n * @hidden\n */\nexport function getIndexesFromAddress(address) {\n    return getRangeIndexes(getRangeFromAddress(address));\n}\n/**\n * @hidden\n */\nexport function getRangeFromAddress(address) {\n    return address.split('!')[1] || address;\n}\n/**\n * Given range will be swapped/arranged in increasing order.\n * @hidden\n */\nexport function getSwapRange(range) {\n    var clonedRange = range.slice();\n    if (range[0] > range[2]) {\n        swap(clonedRange, 0, 2);\n    }\n    if (range[1] > range[3]) {\n        swap(clonedRange, 1, 3);\n    }\n    return clonedRange;\n}\n/**\n * Interchange values in an array\n */\nfunction swap(range, x, y) {\n    var tmp = range[x];\n    range[x] = range[y];\n    range[y] = tmp;\n}\n/**\n * @hidden\n */\nexport function isSingleCell(range) {\n    return range[0] === range[2] && range[1] === range[3];\n}\n","/**\n * Worker task.\n */\nexport function executeTaskAsync(context, taskFn, callbackFn, data, preventCallback) {\n    return new WorkerHelper(context, taskFn, callbackFn, data, preventCallback);\n}\n/**\n * @hidden\n * The `WorkerHelper` module is used to perform multiple actions using Web Worker asynchronously.\n */\nvar WorkerHelper = /** @class */ (function () {\n    /**\n     * Constructor for WorkerHelper module in Workbook library.\n     * @private\n     */\n    function WorkerHelper(context, task, defaultListener, taskData, preventCallback) {\n        this.preventCallback = false;\n        this.context = context;\n        this.workerTask = task;\n        this.defaultListener = defaultListener;\n        this.workerData = taskData;\n        if (preventCallback) {\n            this.preventCallback = true;\n        }\n        this.initWorker();\n    }\n    /**\n     * To terminate the worker task.\n     * @private\n     */\n    WorkerHelper.prototype.terminate = function () {\n        this.worker.terminate();\n        URL.revokeObjectURL(this.workerUrl);\n    };\n    /**\n     * To initiate the worker.\n     * @private\n     */\n    WorkerHelper.prototype.initWorker = function () {\n        var taskBlob = new Blob([this.getFnCode()], { type: 'text/javascript' });\n        this.workerUrl = URL.createObjectURL(taskBlob);\n        this.worker = new Worker(this.workerUrl);\n        this.worker.onmessage = this.messageFromWorker.bind(this);\n        this.worker.onerror = this.onError.bind(this);\n        this.worker.postMessage(this.workerData);\n    };\n    /**\n     * Method for getting response from worker.\n     * @private\n     */\n    WorkerHelper.prototype.messageFromWorker = function (args) {\n        this.terminate();\n        this.defaultListener.apply(this.context, [args.data]);\n    };\n    /**\n     * Method for getting error message from worker if failed.\n     * @private\n     */\n    WorkerHelper.prototype.onError = function (args) {\n        this.terminate();\n        throw args.message || args;\n    };\n    /**\n     * Construct function code for worker.\n     * @private\n     */\n    WorkerHelper.prototype.getFnCode = function () {\n        var workerCode = '';\n        var i;\n        var keys;\n        if (typeof this.workerTask === 'function') {\n            workerCode += ('self.workerTask = ' + this.workerTask.toString() + '; \\n');\n        }\n        else {\n            if (typeof this.workerTask === 'object') {\n                keys = Object.keys(this.workerTask);\n                for (i = 0; i < keys.length; i++) {\n                    workerCode += ((i === 0 ? 'self.workerTask' : keys[i]) + '=' + this.workerTask[keys[i]].toString() + '; \\n');\n                }\n            }\n        }\n        workerCode += 'self.onmessage = ' +\n            (this.preventCallback ? this.getMessageFn.toString() : this.getCallbackMessageFn.toString()) + '; \\n';\n        return workerCode;\n    };\n    /**\n     * Get default worker task with callback.\n     * @private\n     */\n    WorkerHelper.prototype.getCallbackMessageFn = function (args) {\n        postMessage(this.workerTask.apply(this, args.data));\n    };\n    /**\n     * Get default worker task without callback.\n     * @private\n     */\n    WorkerHelper.prototype.getMessageFn = function (args) {\n        this.workerTask.apply(this, args.data);\n    };\n    return WorkerHelper;\n}());\n","import { isNullOrUndefined, getDefaultDateObject } from '@syncfusion/ej2-base';\n/**\n * @hidden\n */\nexport function toFraction(val) {\n    var strVal = val.toString();\n    if (val === parseInt(strVal, 10)) {\n        return parseInt(strVal, 10) + '  ';\n    }\n    else {\n        var top_1 = strVal.indexOf('.') > -1 ? strVal.split('.')[1] : 0;\n        var bottom = Math.pow(10, top_1.toString().replace('-', '').length);\n        var abs = Math.abs(getGcd(top_1, bottom));\n        return (top_1 / abs) + '/' + (bottom / abs);\n    }\n}\n/**\n * @hidden\n */\nexport function getGcd(a, b) {\n    a = Number(a);\n    b = Number(b);\n    return (b) ? getGcd(b, a % b) : a;\n}\n/**\n * @hidden\n */\nexport function intToDate(val) {\n    val = Number(val);\n    val = (val > 0 && val < 1) ? (1 + val) : (val === 0) ? 1 : val;\n    if (val > 60) {\n        val -= 1; // Due to leap year issue of 1900 in MSExcel.\n    }\n    return new Date(((val - 1) * (1000 * 3600 * 24)) + new Date('01/01/1900').getTime());\n}\n/**\n * @hidden\n */\n/* tslint:disable no-any */\nexport function dateToInt(val, isTime) {\n    var startDate = new Date('01/01/1900');\n    var date = isDateTime(val) ? val : new Date(val);\n    var timeDiff = (date.getTime() - startDate.getTime());\n    var diffDays = (timeDiff / (1000 * 3600 * 24)) + 1;\n    return isTime ? diffDays + 1 : parseInt(diffDays.toString(), 10) + 2;\n}\n/**\n * @hidden\n */\nexport function isDateTime(date) {\n    return Object.prototype.toString.call(date) === '[object Date]' && !isNaN(date.valueOf());\n}\n/**\n * @hidden\n */\nexport function isNumber(val) {\n    return val - parseFloat(val) >= 0;\n}\n/**\n * @hidden\n */\nexport function toDate(text, intl) {\n    var defaultDateFormats = getDefaultDateObject();\n    var availabelDateTimeFormat = defaultDateFormats.dateTimeFormats.availableFormats;\n    var dObj = { dateObj: null, isCustom: false, type: '' };\n    if (typeof text === 'string') {\n        text = text.toUpperCase();\n    }\n    for (var _i = 0, _a = Object.keys(defaultDateFormats.dateFormats); _i < _a.length; _i++) {\n        var key = _a[_i];\n        dObj.dateObj = intl.parseDate(text, { format: defaultDateFormats.dateFormats[key], skeleton: key });\n        if (dObj.dateObj) {\n            dObj.type = 'date';\n            dObj.isCustom = false;\n            break;\n        }\n    }\n    if (isNullOrUndefined(dObj.dateObj)) {\n        for (var _b = 0, _c = Object.keys(availabelDateTimeFormat); _b < _c.length; _b++) {\n            var key = _c[_b];\n            dObj.dateObj = intl.parseDate(text, { format: availabelDateTimeFormat[key], skeleton: key });\n            if (dObj.dateObj) {\n                dObj.type = text.toString().indexOf(':') > -1 ? 'time' : 'datetime';\n                dObj.isCustom = true;\n                break;\n            }\n        }\n    }\n    if (isNullOrUndefined(dObj.dateObj)) {\n        for (var _d = 0, _e = Object.keys(defaultDateFormats.timeFormats); _d < _e.length; _d++) {\n            var key = _e[_d];\n            dObj.dateObj = intl.parseDate(text, { format: defaultDateFormats.timeFormats[key], skeleton: key });\n            if (dObj.dateObj) {\n                dObj.type = 'time';\n                dObj.isCustom = false;\n                break;\n            }\n        }\n    }\n    if (text !== '#DIV/0!' && !dObj.dateObj && new Date(text).toString() !== 'Invalid Date') {\n        dObj.dateObj = new Date(text);\n    }\n    return dObj;\n}\n","import { getRangeIndexes } from '../common/index';\nimport { getCell, getSheet, setCell } from '../base/index';\nimport { Internationalization, getNumberDependable, getNumericObject, isNullOrUndefined } from '@syncfusion/ej2-base';\nimport { isNumber, toFraction, intToDate, toDate, dateToInt } from '../common/math';\nimport { applyNumberFormatting, getFormattedCellObject, refreshCellElement, checkDateFormat, getFormattedBarText } from '../common/event';\nimport { NumberFormatType } from '../common/enum';\n/**\n * Specifies number format.\n */\nvar WorkbookNumberFormat = /** @class */ (function () {\n    function WorkbookNumberFormat(parent) {\n        this.parent = parent;\n        this.localeObj = getNumericObject(this.parent.locale);\n        /* tslint:disable:no-any */\n        this.decimalSep = this.localeObj.decimal;\n        this.groupSep = this.localeObj.group;\n        this.addEventListener();\n    }\n    /**\n     * @private\n     */\n    WorkbookNumberFormat.prototype.numberFormatting = function (args) {\n        var activeSheetTab = this.parent.activeSheetTab;\n        var sheet = this.parent.sheets[activeSheetTab - 1];\n        var selectedRange = getRangeIndexes(args.range || sheet.selectedRange);\n        var cell;\n        for (var i = selectedRange[0]; i <= selectedRange[2]; i++) {\n            for (var j = selectedRange[1]; j <= selectedRange[3]; j++) {\n                setCell(i, j, sheet, { format: args.format }, true);\n                cell = getCell(i, j, sheet, true);\n                this.parent.setProperties({ 'sheets': this.parent.sheets }, true);\n                this.getFormattedCell({\n                    type: getTypeFromFormat(cell.format), value: cell.value,\n                    format: cell.format, rowIndex: i, colIndex: j, sheetIndex: activeSheetTab,\n                    cell: cell\n                });\n            }\n        }\n    };\n    /**\n     * @hidden\n     */\n    WorkbookNumberFormat.prototype.getFormattedCell = function (args) {\n        var fResult = isNullOrUndefined(args.value) ? '' : args.value;\n        var sheet = this.parent.getActiveSheet();\n        var range = getRangeIndexes(sheet.activeCell);\n        var cell = args.cell ? args.cell : getCell(range[0], range[1], sheet);\n        var rightAlign = false;\n        var currencySymbol = getNumberDependable(this.parent.locale, 'USD');\n        var eventArgs = {\n            range: range, format: args.format, requestType: 'numberFormat', value: args.value\n        };\n        this.parent.trigger('beforeCellFormat', eventArgs);\n        if (args.format === '' || args.format === NumberFormatType.General) {\n            cell = cell ? cell : {};\n            var dateEventArgs = {\n                value: args.value, rowIndex: range[0], colIndex: range[1], sheetIndex: this.parent.activeSheetTab,\n                updatedVal: args.value, isDate: false, isTime: false\n            };\n            this.checkDateFormat(dateEventArgs);\n            if (dateEventArgs.isDate) {\n                rightAlign = true;\n                cell.value = args.value = dateEventArgs.updatedVal;\n                cell.format = args.format = getFormatFromType(NumberFormatType.ShortDate);\n            }\n            else if (dateEventArgs.isTime) {\n                rightAlign = true;\n                cell.value = args.value = dateEventArgs.updatedVal;\n                cell.format = args.format = getFormatFromType(NumberFormatType.Time);\n            }\n        }\n        args.type = args.format ? getTypeFromFormat(args.format) : NumberFormatType.General;\n        var result = this.processFormats(args, fResult, rightAlign, cell);\n        if (!args.onLoad) {\n            this.parent.notify(refreshCellElement, {\n                isRightAlign: result.rightAlign, result: result.fResult || args.value,\n                rowIndex: args.rowIndex, colIndex: args.colIndex, sheetIndex: args.sheetIndex,\n                type: args.type, curSymbol: currencySymbol, value: args.value || ''\n            });\n        }\n        if (!args.onLoad && (args.rowIndex > sheet.usedRange.rowIndex || args.colIndex > sheet.usedRange.colIndex)) {\n            this.parent.setUsedRange(args.rowIndex, args.colIndex);\n            this.parent.setProperties({ 'sheets': this.parent.sheets }, true);\n        }\n        args.formattedText = result.fResult || args.value;\n        args.isRightAlign = result.rightAlign;\n        args.curSymbol = currencySymbol;\n        return args.formattedText;\n    };\n    WorkbookNumberFormat.prototype.processFormats = function (args, fResult, isRightAlign, cell) {\n        var intl = new Internationalization();\n        var currencySymbol = getNumberDependable(this.parent.locale, 'USD');\n        var result;\n        args.format = args.format ? args.format : NumberFormatType.General;\n        if (fResult !== '') {\n            switch (args.type) {\n                case NumberFormatType.General:\n                    result = this.autoDetectGeneralFormat({\n                        args: args, currencySymbol: currencySymbol, fResult: fResult, intl: intl,\n                        isRightAlign: isRightAlign, curCode: 'USD', cell: cell\n                    });\n                    fResult = result.fResult;\n                    isRightAlign = result.isRightAlign;\n                    break;\n                case NumberFormatType.Number:\n                    if (isNumber(fResult)) {\n                        fResult = this.applyNumberFormat(args, intl);\n                        isRightAlign = true;\n                    }\n                    break;\n                case NumberFormatType.Currency:\n                    if (isNumber(fResult)) {\n                        fResult = this.currencyFormat(args, intl);\n                        isRightAlign = true;\n                    }\n                    break;\n                case NumberFormatType.Percentage:\n                    if (isNumber(fResult)) {\n                        fResult = this.percentageFormat(args, intl);\n                        isRightAlign = true;\n                    }\n                    break;\n                case NumberFormatType.Accounting:\n                    if (isNumber(fResult)) {\n                        fResult = this.accountingFormat(args, intl);\n                        isRightAlign = true;\n                    }\n                    break;\n                case NumberFormatType.ShortDate:\n                    fResult = this.shortDateFormat(args, intl);\n                    isRightAlign = fResult ? true : false;\n                    break;\n                case NumberFormatType.LongDate:\n                    fResult = this.longDateFormat(args, intl);\n                    isRightAlign = fResult ? true : false;\n                    break;\n                case NumberFormatType.Time:\n                    fResult = this.timeFormat(args, intl);\n                    isRightAlign = fResult ? true : false;\n                    break;\n                case NumberFormatType.Fraction:\n                    if (isNumber(fResult)) {\n                        fResult = this.fractionFormat(args);\n                        isRightAlign = true;\n                    }\n                    break;\n                case NumberFormatType.Scientific:\n                    if (isNumber(fResult)) {\n                        fResult = this.scientificFormat(args);\n                        isRightAlign = true;\n                    }\n                    break;\n                case NumberFormatType.Text:\n                    isRightAlign = false;\n                    break;\n            }\n        }\n        return { fResult: fResult, rightAlign: isRightAlign };\n    };\n    WorkbookNumberFormat.prototype.autoDetectGeneralFormat = function (options) {\n        if (isNumber(options.fResult)) {\n            if (options.args.format && options.args.format !== '') {\n                if (options.args.format.toString().indexOf('%') > -1) {\n                    options.fResult = this.percentageFormat(options.args, options.intl);\n                }\n                else if (options.args.format.toString().indexOf(options.currencySymbol) > -1) {\n                    options.fResult = this.currencyFormat(options.args, options.intl);\n                }\n                else {\n                    options.fResult = this.applyNumberFormat(options.args, options.intl);\n                }\n            }\n            if (options.fResult && options.fResult.toString().split(this.decimalSep)[0].length > 11) {\n                options.fResult = this.scientificFormat(options.args);\n            }\n            options.isRightAlign = true;\n        }\n        if (!isNullOrUndefined(options.fResult)) {\n            var res = options.fResult.toString();\n            if (res.indexOf('%') > -1 && res.split('%')[0] !== '' && res.split('%')[1].trim() === '' &&\n                Number(res.split('%')[0].split(this.groupSep).join('')).toString() !== 'NaN') {\n                options.args.value = Number(res.split('%')[0].split(this.groupSep).join(''));\n                options.cell.format = options.args.format = getFormatFromType(NumberFormatType.Percentage);\n                options.fResult = this.percentageFormat(options.args, options.intl);\n                options.cell.value = options.args.value.toString();\n                options.isRightAlign = true;\n            }\n            else if (res.indexOf(options.currencySymbol) > -1 && res.split(options.currencySymbol)[1] !== '' &&\n                Number(res.split(options.currencySymbol)[1].split(this.groupSep).join('')).toString() !== 'NaN') {\n                options.args.value = Number(res.split(options.currencySymbol)[1].split(this.groupSep).join(''));\n                options.cell.format = options.args.format = getFormatFromType(NumberFormatType.Currency);\n                options.fResult = this.currencyFormat(options.args, options.intl);\n                options.cell.value = options.args.value.toString();\n                options.isRightAlign = true;\n            }\n            this.parent.setProperties({ 'sheets': this.parent.sheets }, true);\n        }\n        return { isRightAlign: options.isRightAlign, fResult: options.fResult };\n    };\n    WorkbookNumberFormat.prototype.findSuffix = function (zeros, resultSuffix) {\n        var len = zeros.length;\n        var suffixLen = len - resultSuffix.length;\n        return zeros.substr(0, suffixLen < 0 ? 0 : suffixLen) + resultSuffix;\n    };\n    WorkbookNumberFormat.prototype.applyNumberFormat = function (args, intl) {\n        args.format = args.format === '' ? getFormatFromType(NumberFormatType.Number) : args.format;\n        args.format = args.format.toString().split('_)').join(' ').split('_(').join(' ').split('[Red]').join('');\n        var formatArr = args.format.toString().split(';');\n        if (Number(args.value) >= 0) {\n            args.format = formatArr[0];\n        }\n        else {\n            args.format = !isNullOrUndefined(formatArr[1]) ? formatArr[1].split('*').join(' ') : formatArr[0];\n        }\n        return intl.formatNumber(Number(args.value), {\n            format: args.format\n        });\n    };\n    WorkbookNumberFormat.prototype.currencyFormat = function (args, intl) {\n        args.format = args.format === '' ? getFormatFromType(NumberFormatType.Currency) : args.format;\n        args.format = args.format.toString().split('_(').join(' ').split('_)').join(' ').split('[Red]').join('');\n        var formatArr = args.format.toString().split(';');\n        if (Number(args.value) >= 0) {\n            args.format = formatArr[0];\n        }\n        else {\n            args.format = isNullOrUndefined(formatArr[1]) ? formatArr[0] : formatArr[1].split('*').join(' ');\n        }\n        return intl.formatNumber(Number(args.value), {\n            format: args.format,\n            currency: 'USD'\n        });\n    };\n    WorkbookNumberFormat.prototype.percentageFormat = function (args, intl) {\n        args.format = args.format === '' ? getFormatFromType(NumberFormatType.Percentage) : args.format;\n        return intl.formatNumber(Number(args.value), {\n            format: args.format\n        });\n    };\n    WorkbookNumberFormat.prototype.accountingFormat = function (args, intl) {\n        args.format = args.format === '' ? getFormatFromType(NumberFormatType.Accounting) : args.format;\n        args.format = args.format.split('_(').join(' ').split('_)').join(' ').split('[Red]').join('');\n        var currencySymbol = getNumberDependable(this.parent.locale, 'USD');\n        var formatArr = args.format.split(';');\n        if (Number(args.value) >= 0) {\n            args.format = formatArr[0];\n        }\n        else {\n            args.format = formatArr[1].split('*').join(' ');\n        }\n        if (Number(args.value) === 0) {\n            return currencySymbol + '- ';\n        }\n        else {\n            return intl.formatNumber(Number(args.value), {\n                format: args.format,\n                currency: 'USD'\n            }).split('-').join('');\n        }\n    };\n    WorkbookNumberFormat.prototype.shortDateFormat = function (args, intl) {\n        var shortDate = intToDate(args.value);\n        var code = (args.format === '' || args.format === 'General') ? getFormatFromType(NumberFormatType.ShortDate)\n            : args.format.toString();\n        var dateObj;\n        if (code === getFormatFromType(NumberFormatType.ShortDate)) {\n            code = 'M/d/yy';\n            dateObj = {\n                type: 'date',\n                skeleton: 'yMd'\n            };\n        }\n        else {\n            dateObj = {\n                type: 'date',\n                format: code\n            };\n        }\n        return intl.formatDate(shortDate, dateObj);\n    };\n    WorkbookNumberFormat.prototype.longDateFormat = function (args, intl) {\n        var longDate = intToDate(args.value);\n        var code = (args.format === '' || args.format === 'General') ? getFormatFromType(NumberFormatType.LongDate)\n            : args.format.toString();\n        if (code === getFormatFromType(NumberFormatType.LongDate)) {\n            code = 'EEEE, MMMM d, y';\n        }\n        return intl.formatDate(longDate, {\n            type: 'date',\n            format: code\n        });\n    };\n    WorkbookNumberFormat.prototype.timeFormat = function (args, intl) {\n        if (!isNullOrUndefined(args.value.split(this.decimalSep)[1])) {\n            args.value = parseFloat('1' + this.decimalSep + args.value.split(this.decimalSep)[1]) || args.value;\n        }\n        var time = intToDate(args.value);\n        var code = (args.format === '' || args.format === 'General') ? getFormatFromType(NumberFormatType.Time)\n            : args.format.toString();\n        if (code === getFormatFromType(NumberFormatType.Time)) {\n            code = 'h:mm:ss a';\n        }\n        return intl.formatDate(time, {\n            type: 'time',\n            skeleton: 'medium',\n            format: code\n        });\n    };\n    WorkbookNumberFormat.prototype.scientificFormat = function (args) {\n        args.format = args.format === '' ? getFormatFromType(NumberFormatType.Scientific) : args.format;\n        var zeros = args.format.split('+')[1];\n        var prefix = this.findDecimalPlaces(args.format, 'Scientific');\n        var fResult = Number(args.value).toExponential(prefix);\n        if (fResult.indexOf('e+') > -1) {\n            fResult = fResult.split('e+')[0] + 'E+' + this.findSuffix(zeros, fResult.split('e+')[1]);\n        }\n        else if (fResult.indexOf('e-') > -1) {\n            fResult = fResult.split('e-')[0] + 'E-' + +this.findSuffix(zeros, fResult.split('e-')[1]);\n        }\n        return fResult;\n    };\n    WorkbookNumberFormat.prototype.fractionFormat = function (args) {\n        args.format = args.format === '' ? getFormatFromType(NumberFormatType.Fraction) : args.format;\n        var suffix = '';\n        var fractionResult;\n        if (args.value.toString().indexOf(this.decimalSep) > -1 && isNumber(args.value)) {\n            suffix = args.value.toString().split(this.decimalSep)[0];\n            fractionResult = toFraction(Number(args.value));\n            return (Number(suffix) === 0) ? ' ' + fractionResult : suffix + ' ' + fractionResult;\n        }\n        return suffix;\n    };\n    WorkbookNumberFormat.prototype.findDecimalPlaces = function (code, type) {\n        switch (type) {\n            case 'Scientific':\n                var eIndex = code.toUpperCase().indexOf('E');\n                var decIndex = code.indexOf(this.decimalSep);\n                if (eIndex > -1) {\n                    return code.substring(decIndex + 1, eIndex).length;\n                }\n        }\n        return 2;\n    };\n    WorkbookNumberFormat.prototype.checkDateFormat = function (args) {\n        var dateObj;\n        var intl = new Internationalization();\n        var fCode;\n        var value = !isNullOrUndefined(args.value) ? args.value.toString() : '';\n        var cell = getCell(args.rowIndex, args.colIndex, getSheet(this.parent, (args.sheetIndex || this.parent.activeSheetTab) - 1));\n        if (value && value.indexOf('/') > -1 || value.indexOf('-') > -1 || value.indexOf(':') > -1) {\n            dateObj = toDate(value, intl);\n            if (!isNullOrUndefined(dateObj.dateObj) && dateObj.dateObj.toString() !== 'Invalid Date') {\n                cell = cell ? cell : {};\n                value = dateToInt(dateObj.dateObj, value.indexOf(':') > -1).toString();\n                fCode = 'short';\n                if (!cell.format || cell.format === '') {\n                    if (dateObj.type === 'time') {\n                        cell.format = getFormatFromType(NumberFormatType.Time);\n                    }\n                    else {\n                        cell.format = getFormatFromType(NumberFormatType.ShortDate);\n                    }\n                }\n                this.parent.setProperties({ 'sheets': this.parent.sheets }, true);\n                args.isDate = dateObj.type === 'date' || dateObj.type === 'datetime';\n                args.isTime = dateObj.type === 'time';\n            }\n        }\n        args.updatedVal = value;\n    };\n    WorkbookNumberFormat.prototype.formattedBarText = function (args) {\n        var type = getTypeFromFormat(args.cell ? args.cell.format : '');\n        var intl = new Internationalization();\n        var beforeText = args.value;\n        var date = getFormatFromType(NumberFormatType.ShortDate);\n        var time = getFormatFromType(NumberFormatType.Time);\n        switch (type) {\n            case NumberFormatType.ShortDate:\n            case NumberFormatType.LongDate:\n                args.value = this.shortDateFormat({ type: type, value: args.value, format: date }, intl);\n                break;\n            case NumberFormatType.Time:\n                args.value = this.shortDateFormat({ type: type, value: args.value, format: date }, intl) + ' ' +\n                    this.timeFormat({ type: type, value: args.value, format: time }, intl);\n                break;\n        }\n        if (!args.value || (args.value && args.value.toString().indexOf('null') > -1)) {\n            args.value = beforeText;\n        }\n    };\n    /**\n     * Adding event listener for number format.\n     */\n    WorkbookNumberFormat.prototype.addEventListener = function () {\n        this.parent.on(applyNumberFormatting, this.numberFormatting, this);\n        this.parent.on(getFormattedCellObject, this.getFormattedCell, this);\n        this.parent.on(checkDateFormat, this.checkDateFormat, this);\n        this.parent.on(getFormattedBarText, this.formattedBarText, this);\n    };\n    /**\n     * Removing event listener for number format.\n     */\n    WorkbookNumberFormat.prototype.removeEventListener = function () {\n        if (!this.parent.isDestroyed) {\n            this.parent.off(applyNumberFormatting, this.numberFormatting);\n            this.parent.off(getFormattedCellObject, this.getFormattedCell);\n            this.parent.off(checkDateFormat, this.checkDateFormat);\n            this.parent.off(getFormattedBarText, this.formattedBarText);\n        }\n    };\n    /**\n     * To Remove the event listeners.\n     */\n    WorkbookNumberFormat.prototype.destroy = function () {\n        this.removeEventListener();\n        this.parent = null;\n    };\n    /**\n     * Get the workbook number format module name.\n     */\n    WorkbookNumberFormat.prototype.getModuleName = function () {\n        return 'workbookNumberFormat';\n    };\n    return WorkbookNumberFormat;\n}());\nexport { WorkbookNumberFormat };\n/**\n * To Get the number built-in format code from the number format type.\n * @param {string} type - Specifies the type of the number formatting.\n */\nexport function getFormatFromType(type) {\n    var code = NumberFormatType.General;\n    switch (type.split(' ').join('')) {\n        case NumberFormatType.Number:\n            code = '0.00';\n            break;\n        case NumberFormatType.Currency:\n            code = '$#,##0.00';\n            break;\n        case NumberFormatType.Accounting:\n            code = '_($* #,##0.00_);_($* (#,##0.00);_($* \"-\"??_);_(@_)';\n            break;\n        case NumberFormatType.ShortDate:\n            code = 'mm-dd-yyyy';\n            break;\n        case NumberFormatType.LongDate:\n            code = 'dddd, mmmm dd, yyyy';\n            break;\n        case NumberFormatType.Time:\n            code = 'h:mm:ss AM/PM';\n            break;\n        case NumberFormatType.Percentage:\n            code = '0.00%';\n            break;\n        case NumberFormatType.Fraction:\n            code = '# ?/?';\n            break;\n        case NumberFormatType.Scientific:\n            code = '0.00E+00';\n            break;\n        case NumberFormatType.Text:\n            code = '@';\n            break;\n    }\n    return code;\n}\n/**\n * @hidden\n */\nexport function getTypeFromFormat(format) {\n    var code = NumberFormatType.General;\n    switch (format) {\n        case '0.00':\n            code = NumberFormatType.Number;\n            break;\n        case '$#,##0.00':\n        case '$#,##0_);[Red]($#,##0)':\n        case '$#,##0.00_);[Red]($#,##0.00)':\n        case '$#,##0.00_);($#,##0.00)':\n        case '$#,##0_);($#,##0)':\n            code = NumberFormatType.Currency;\n            break;\n        case '_($*#,##0.00_);_($*(#,##0.00);_($*\"-\"??_);_(@_)':\n        case '_($*#,##0.00_);_($* (#,##0.00);_($*\"-\"??_);_(@_)':\n        case '_($* #,##0.00_);_($* (#,##0.00);_($* \"-\"??_);_(@_)':\n            code = NumberFormatType.Accounting;\n            break;\n        case 'mm-dd-yyyy':\n        case 'dd-mm-yyyy':\n        case 'dd-mm-yy':\n        case 'mm-dd-yy':\n            code = NumberFormatType.ShortDate;\n            break;\n        case 'dddd, mmmm dd, yyyy':\n            code = NumberFormatType.LongDate;\n            break;\n        case 'h:mm:ss AM/PM':\n            code = NumberFormatType.Time;\n            break;\n        case '0.00%':\n        case '0%':\n            code = NumberFormatType.Percentage;\n            break;\n        case '# ?/?':\n        case '# ??/??':\n        case '# ???/???':\n            code = NumberFormatType.Fraction;\n            break;\n        case '0.00E+00':\n            code = NumberFormatType.Scientific;\n            break;\n        case '@':\n            code = NumberFormatType.Text;\n            break;\n    }\n    return code;\n}\n","/**\n * Represent the common codes for calculate\n */\nvar CalculateCommon = /** @class */ (function () {\n    function CalculateCommon(parent) {\n        this.parent = parent;\n    }\n    /**\n     * For internal use only - Get the module name.\n     * @private\n     */\n    CalculateCommon.prototype.getModuleName = function () {\n        return 'calc-common';\n    };\n    return CalculateCommon;\n}());\nexport { CalculateCommon };\n/**\n * To check whether the object is undefined.\n * @param {Object} value - To check the object is undefined\n * @return {boolean}\n * @private\n */\nexport function isUndefined(value) {\n    return ('undefined' === typeof value);\n}\n","/**\n * Represents the getModules function.\n * @param {Calculate} context\n */\nexport function getModules(context) {\n    var modules = [];\n    if (context.includeBasicFormulas) {\n        modules.push({\n            member: 'basic-formulas',\n            args: [context]\n        });\n    }\n    return modules;\n}\n","/**\n * Module loading operations\n */\nimport { isNullOrUndefined, isUndefined } from '@syncfusion/ej2-base';\nvar MODULE_SUFFIX = 'Module';\n/**\n * To get nameSpace value from the desired object.\n * @param {string} nameSpace - String value to the get the inner object\n * @param {any} obj - Object to get the inner object value.\n * @return {any}\n * @private\n */\nexport function getValue(nameSpace, obj) {\n    /* tslint:disable no-any */\n    var value = obj;\n    var splits = nameSpace.replace(/\\[/g, '.').replace(/\\]/g, '').split('.');\n    for (var j = 0; j < splits.length && !isUndefined(value); j++) {\n        value = value[splits[j]];\n    }\n    return value;\n}\n/**\n * To set value for the nameSpace in desired object.\n * @param {string} nameSpace - String value to get the inner object\n * @param {any} value - Value that you need to set.\n * @param {any} obj - Object to get the inner object value.\n * @return {void}\n * @private\n */\nexport function setValue(nameSpace, value, obj) {\n    var keyValues = nameSpace.replace(/\\[/g, '.').replace(/\\]/g, '').split('.');\n    var start = obj || {};\n    var fromObj = start;\n    var j;\n    var length = keyValues.length;\n    var key;\n    for (j = 0; j < length; j++) {\n        key = keyValues[j];\n        if (j + 1 === length) {\n            fromObj[key] = value === undefined ? {} : value;\n        }\n        else if (isNullOrUndefined(fromObj[key])) {\n            fromObj[key] = {};\n        }\n        fromObj = fromObj[key];\n    }\n    return start;\n}\nvar ModuleLoader = /** @class */ (function () {\n    function ModuleLoader(parent) {\n        this.loadedModules = [];\n        this.parent = parent;\n    }\n    ;\n    /**\n     * Inject required modules in component library\n     * @hidden\n     */\n    ModuleLoader.prototype.inject = function (requiredModules, moduleList) {\n        var reqLengthVal = requiredModules.length;\n        if (reqLengthVal === 0) {\n            this.clean();\n            return;\n        }\n        if (this.loadedModules.length) {\n            this.clearUnusedModule(requiredModules);\n        }\n        for (var i = 0; i < reqLengthVal; i++) {\n            var modl = requiredModules[i];\n            for (var _i = 0, moduleList_1 = moduleList; _i < moduleList_1.length; _i++) {\n                var module = moduleList_1[_i];\n                var modName = modl.member;\n                if (module.prototype.getModuleName() === modl.member && !this.isModuleLoaded(modName)) {\n                    var moduleObject = this.createInstance(module, modl.args);\n                    var memberName = this.getMemberName(modName);\n                    if (modl.isProperty) {\n                        setValue(memberName, module, this.parent);\n                    }\n                    else {\n                        setValue(memberName, moduleObject, this.parent);\n                    }\n                    var loadedModule = modl;\n                    loadedModule.member = memberName;\n                    this.loadedModules.push(loadedModule);\n                }\n            }\n        }\n    };\n    /**\n     * Create Instance from constructor function with desired parameters.\n     * @param {Function} classFunction - Class function to which need to create instance\n     * @param {any[]} params - Parameters need to passed while creating instance\n     * @return {any}\n     * @private\n     */\n    ModuleLoader.prototype.createInstance = function (classFunction, params) {\n        var arrayParam = params;\n        arrayParam.unshift(undefined);\n        return new (Function.prototype.bind.apply(classFunction, arrayParam));\n    };\n    /**\n     * To remove the created object while control is destroyed\n     * @hidden\n     */\n    ModuleLoader.prototype.clean = function () {\n        for (var _i = 0, _a = this.loadedModules; _i < _a.length; _i++) {\n            var modules = _a[_i];\n            if (!modules.isProperty) {\n                getValue(modules.member, this.parent).destroy();\n            }\n        }\n        this.loadedModules = [];\n    };\n    /**\n     * Removes all unused modules\n     * @param {ModuleDeclaration[]} moduleListName\n     * @returns {void}\n     */\n    ModuleLoader.prototype.clearUnusedModule = function (moduleListName) {\n        var _this = this;\n        var usedModule = moduleListName.map(function (arg) { return _this.getMemberName(arg.member); });\n        var removeModule = this.loadedModules.filter(function (module) {\n            return usedModule.indexOf(module.member) === -1;\n        });\n        for (var _i = 0, removeModule_1 = removeModule; _i < removeModule_1.length; _i++) {\n            var moduleName = removeModule_1[_i];\n            if (!moduleName.isProperty) {\n                getValue(moduleName.member, this.parent).destroy();\n            }\n            this.loadedModules.splice(this.loadedModules.indexOf(moduleName), 1);\n            this.deleteObject(this.parent, moduleName.member);\n        }\n    };\n    /**\n     * To get the name of the member.\n     * @param {string} name\n     * @returns {string}\n     */\n    ModuleLoader.prototype.getMemberName = function (name) {\n        return name[0].toLowerCase() + name.substring(1) + MODULE_SUFFIX;\n    };\n    /**\n     * Delete an item from Object\n     * @param {any} obj - Object in which we need to delete an item.\n     * @param {string} params - String value to the get the inner object\n     * @return {void}\n     * @private\n     */\n    ModuleLoader.prototype.deleteObject = function (obj, key) {\n        delete obj[key];\n    };\n    /**\n     * Returns boolean based on whether the module specified is loaded or not\n     * @param {string} modName\n     * @returns {boolean}\n     */\n    ModuleLoader.prototype.isModuleLoaded = function (modName) {\n        for (var _i = 0, _a = this.loadedModules; _i < _a.length; _i++) {\n            var mod = _a[_i];\n            if (mod.member === this.getMemberName(modName)) {\n                return true;\n            }\n        }\n        return false;\n    };\n    return ModuleLoader;\n}());\nexport { ModuleLoader };\n","var __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    }\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\n/* tslint:disable-next-line:max-line-length */\nimport { getValue, Event, NotifyPropertyChanges, Base, Property, isNullOrUndefined, isUndefined } from '@syncfusion/ej2-base';\nimport { BasicFormulas } from './../formulas/index';\nimport { getModules, ModuleLoader } from '../common/index';\nimport { CommonErrors, FormulasErrorsStrings } from '../common/enum';\nimport { Parser } from './parser';\n/**\n * Represents the calculate library.\n */\nvar Calculate = /** @class */ (function (_super) {\n    __extends(Calculate, _super);\n    /**\n     * Base constructor for creating Calculate library.\n     */\n    function Calculate(parent) {\n        var _this = _super.call(this, null, null) || this;\n        _this.lFormulas = new Map();\n        /** @hidden */\n        _this.storedData = new Map();\n        _this.keyToRowsMap = new Map();\n        _this.rowsToKeyMap = new Map();\n        /** @hidden */\n        _this.rightBracket = String.fromCharCode(161);\n        /** @hidden */\n        _this.leftBracket = String.fromCharCode(162);\n        _this.sheetToken = '!';\n        _this.emptyString = '';\n        _this.leftBrace = '{';\n        _this.rightBrace = '}';\n        _this.cell = _this.emptyString;\n        _this.cellPrefix = '!0!A';\n        _this.treatEmptyStringAsZero = false;\n        /** @hidden */\n        _this.tic = '\\\"';\n        /** @hidden */\n        _this.singleTic = '\\'';\n        /** @hidden */\n        _this.trueValue = 'TRUE';\n        /** @hidden */\n        _this.falseValue = 'FALSE';\n        _this.parseDecimalSeparator = '.';\n        /** @hidden */\n        _this.arithMarker = String.fromCharCode(180);\n        /** @hidden */\n        _this.arithMarker2 = _this.arithMarker + _this.arithMarker;\n        _this.dependentCells = null;\n        _this.dependentFormulaCells = null;\n        _this.minValue = Number.MIN_SAFE_INTEGER;\n        _this.maxValue = Number.MAX_SAFE_INTEGER;\n        _this.categoryCollection = ['All'];\n        /**\n         * @hidden\n         */\n        _this.formulaErrorStrings = [\n            'binary operators cannot start an expression',\n            'cannot parse',\n            'bad library',\n            'invalid char in front of',\n            'number contains 2 decimal points',\n            'expression cannot end with an operator',\n            'invalid characters following an operator',\n            'invalid character in number',\n            'mismatched parentheses',\n            'unknown formula name',\n            'requires a single argument',\n            'requires 3 arguments',\n            'invalid Math argument',\n            'requires 2 arguments',\n            '#NAME?',\n            'too complex',\n            'circular reference: ',\n            'missing formula',\n            'improper formula',\n            'invalid expression',\n            'cell empty',\n            'bad formula',\n            'empty expression',\n            '',\n            'mismatched string quotes',\n            'wrong number of arguments',\n            'invalid arguments',\n            'iterations do not converge',\n            'Control is already registered',\n            'Calculation overflow',\n            'Missing sheet',\n            'cannot_parse',\n            'expression_cannot_end_with_an_operator'\n        ];\n        _this.errorStrings = null;\n        _this.parseArgumentSeparator = ',';\n        _this.dateTime1900 = new Date(1900, 0, 1, 0, 0, 0);\n        _this.isParseDecimalSeparatorChanged = false;\n        _this.isArgumentSeparatorChanged = false;\n        _this.sheetFamilyID = 0;\n        _this.defaultFamilyItem = null;\n        _this.sheetFamiliesList = null;\n        _this.modelToSheetID = null;\n        /** @hidden */\n        _this.tokenCount = 0;\n        _this.sortedSheetNames = null;\n        _this.tempSheetPlaceHolder = String.fromCharCode(133);\n        /** @hidden */\n        _this.namedRanges = new Map();\n        _this.formulaInfoTable = null;\n        _this.oaDate = new Date(1899, 11, 30);\n        _this.millisecondsOfaDay = 24 * 60 * 60 * 1000;\n        _this.parseDateTimeSeparator = '/';\n        var moduleLoader = new ModuleLoader(_this);\n        if (_this.includeBasicFormulas) {\n            Calculate_1.Inject(BasicFormulas);\n        }\n        if (_this.injectedModules && _this.injectedModules.length) {\n            moduleLoader.inject(_this.requiredModules(), _this.injectedModules);\n        }\n        _this.parentObject = isNullOrUndefined(parent) ? _this : parent;\n        _this.grid = _this.parentObject;\n        _this.parser = new Parser(_this);\n        return _this;\n    }\n    Calculate_1 = Calculate;\n    Object.defineProperty(Calculate.prototype, \"libraryFormulas\", {\n        /* tslint:disable-next-line:no-any */\n        get: function () {\n            return this.lFormulas;\n        },\n        /* tslint:disable-next-line:no-any */\n        set: function (formulaColl) {\n            this.lFormulas.set(formulaColl.fName, { handler: formulaColl.handler, category: formulaColl.category, description: formulaColl.description });\n        },\n        enumerable: true,\n        configurable: true\n    });\n    /**\n     * To get the argument separator to split the formula arguments.\n     * @returns string\n     */\n    Calculate.prototype.getParseArgumentSeparator = function () {\n        var seperator = ',';\n        if (!this.isArgumentSeparatorChanged && seperator !== this.parseArgumentSeparator) {\n            this.parseArgumentSeparator = seperator;\n        }\n        return this.parseArgumentSeparator;\n    };\n    /**\n     * To set the argument separator to split the formula arguments.\n     * @param {string} value - Argument separator based on the culture.\n     * @returns void\n     */\n    Calculate.prototype.setParseArgumentSeparator = function (value) {\n        this.parseArgumentSeparator = value;\n        this.isArgumentSeparatorChanged = true;\n    };\n    /**\n     * To get the date separator to split the date value.\n     * @returns string\n     */\n    Calculate.prototype.getParseDateTimeSeparator = function () {\n        return this.parseDateTimeSeparator;\n    };\n    /**\n     * To set whether the empty string is treated as zero or not.\n     * @param {boolean} value\n     * @returns boolean\n     */\n    Calculate.prototype.setTreatEmptyStringAsZero = function (value) {\n        this.treatEmptyStringAsZero = value;\n    };\n    /**\n     * To get whether the empty string is treated as zero or not.\n     * @returns boolean\n     */\n    Calculate.prototype.getTreatEmptyStringAsZero = function () {\n        return this.treatEmptyStringAsZero;\n    };\n    /**\n     * To set the date separator to split the date value.\n     * @param {string} value - Argument separator based on the culture.\n     * @returns void\n     */\n    Calculate.prototype.setParseDateTimeSeparator = function (value) {\n        this.parseDateTimeSeparator = value;\n    };\n    /**\n     * To provide the array of modules needed.\n     * @hidden\n     */\n    Calculate.prototype.requiredModules = function () {\n        return getModules(this);\n    };\n    /**\n     * Dynamically injects the required modules to the library.\n     * @hidden\n     */\n    Calculate.Inject = function () {\n        var moduleList = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            moduleList[_i] = arguments[_i];\n        }\n        if (!this.prototype.injectedModules) {\n            this.prototype.injectedModules = [];\n        }\n        for (var j = 0; j < moduleList.length; j++) {\n            if (this.prototype.injectedModules.indexOf(moduleList[j]) === -1) {\n                this.prototype.injectedModules.push(moduleList[j]);\n            }\n        }\n    };\n    /**\n     * Get injected modules\n     * @hidden\n     */\n    Calculate.prototype.getInjectedModules = function () {\n        return this.injectedModules;\n    };\n    Calculate.prototype.onPropertyChanged = function (newProp, oldProp) {\n        /** code snippets */\n    };\n    Calculate.prototype.getModuleName = function () {\n        return 'calculate';\n    };\n    /** @hidden */\n    Calculate.prototype.getFormulaCharacter = function () {\n        return '=';\n    };\n    /** @hidden */\n    Calculate.prototype.isUpperChar = function (text) {\n        var charCode = text.charCodeAt(0);\n        return ((charCode > 64) && (charCode < 91));\n    };\n    Calculate.prototype.resetKeys = function () {\n        this.storedData.clear();\n        this.keyToRowsMap.clear();\n        this.rowsToKeyMap.clear();\n    };\n    /**\n     * @hidden\n     */\n    Calculate.prototype.updateDependentCell = function (cellRef) {\n        var family = this.getSheetFamilyItem(this.grid);\n        var cell = this.cell;\n        if (family.sheetNameToParentObject !== null) {\n            var token = family.parentObjectToToken.get(this.grid);\n            if (cell.indexOf(this.sheetToken) === -1) {\n                cell = token + cell;\n            }\n            if (cellRef.indexOf(this.sheetToken) === -1) {\n                cellRef = token + cellRef;\n            }\n        }\n        if (this.getDependentCells().has(cellRef)) {\n            var formulaCells = this.getDependentCells().get(cellRef);\n            if (formulaCells.indexOf(cell) < 0) {\n                formulaCells.push(cell);\n            }\n        }\n        else {\n            this.getDependentCells().set(cellRef, [cell]);\n        }\n    };\n    /**\n     * @hidden\n     */\n    Calculate.prototype.getDependentCells = function () {\n        if (this.isSheetMember()) {\n            var family = this.getSheetFamilyItem(this.grid);\n            if (family.sheetDependentCells == null) {\n                family.sheetDependentCells = new Map();\n            }\n            return family.sheetDependentCells;\n        }\n        else {\n            if (this.dependentCells == null) {\n                this.dependentCells = new Map();\n            }\n            return this.dependentCells;\n        }\n    };\n    /**\n     * @hidden\n     */\n    Calculate.prototype.getDependentFormulaCells = function () {\n        if (this.isSheetMember()) {\n            var family = this.getSheetFamilyItem(this.grid);\n            if (family.sheetDependentFormulaCells == null) {\n                family.sheetDependentFormulaCells = new Map();\n            }\n            return family.sheetDependentFormulaCells;\n        }\n        else {\n            if (this.dependentFormulaCells == null) {\n                this.dependentFormulaCells = new Map();\n            }\n            return this.dependentFormulaCells;\n        }\n    };\n    /**\n     * To get library formulas collection.\n     * @returns Map<string, Function>\n     */\n    Calculate.prototype.getLibraryFormulas = function () {\n        return this.lFormulas;\n    };\n    /**\n     * To get library function.\n     * @param {string} libFormula - Library formula to get a corresponding function.\n     * @returns Function\n     */\n    Calculate.prototype.getFunction = function (libFormula) {\n        if (this.getLibraryFormulas().has(libFormula.toUpperCase())) {\n            return this.getLibraryFormulas().get(libFormula.toUpperCase()).handler;\n        }\n        else {\n            return null;\n        }\n    };\n    Calculate.prototype.getFormulaInfoTable = function () {\n        if (this.isSheetMember()) {\n            var family = this.getSheetFamilyItem(this.grid);\n            if (family.sheetFormulaInfotable === null) {\n                family.sheetFormulaInfotable = new Map();\n            }\n            return family.sheetFormulaInfotable;\n        }\n        else {\n            if (this.formulaInfoTable === null) {\n                this.formulaInfoTable = new Map();\n            }\n            return this.formulaInfoTable;\n        }\n    };\n    /**\n     * To get the formula text.\n     * @private\n     */\n    Calculate.prototype.getFormula = function (key) {\n        key = key.toUpperCase();\n        if (this.storedData.has(key)) {\n            return this.storedData.get(key).getFormulaText();\n        }\n        return '';\n    };\n    /**\n     * To get the formula text.\n     * @returns void\n     */\n    Calculate.prototype.getParseDecimalSeparator = function () {\n        var seperator = '.';\n        if (!this.isParseDecimalSeparatorChanged && seperator !== this.parseDecimalSeparator) {\n            this.parseDecimalSeparator = seperator;\n        }\n        return this.parseDecimalSeparator;\n    };\n    /**\n     * To get the formula text.\n     * @param {string} value - Specifies the decimal separator value.\n     * @returns void\n     */\n    Calculate.prototype.setParseDecimalSeparator = function (value) {\n        this.parseDecimalSeparator = value;\n        this.isParseDecimalSeparatorChanged = true;\n    };\n    /** @hidden */\n    Calculate.prototype.getSheetToken = function (cellRef) {\n        var i = 0;\n        var temp = this.emptyString;\n        if (i < cellRef.length && cellRef[i] === this.sheetToken) {\n            i++;\n            while (i < cellRef.length && cellRef[i] !== this.sheetToken) {\n                i++;\n            }\n            temp = cellRef.substring(0, i + 1);\n        }\n        if (i < cellRef.length) {\n            return temp;\n        }\n        throw this.formulaErrorStrings[FormulasErrorsStrings.bad_index];\n    };\n    /** @hidden */\n    Calculate.prototype.getSheetID = function (grd) {\n        var family = this.getSheetFamilyItem(grd);\n        if (family.sheetNameToParentObject != null && family.sheetNameToParentObject.size > 0) {\n            var token = family.parentObjectToToken.get(grd);\n            token = token.split(this.sheetToken).join(this.emptyString);\n            var id = this.parseFloat(token);\n            if (!this.isNaN(id)) {\n                return id;\n            }\n        }\n        return -1;\n    };\n    /** @hidden */\n    Calculate.prototype.parseFloat = function (value) {\n        return Number(value);\n    };\n    /**\n     * To get the row index of the given cell.\n     * @param {string} cell - Cell address for getting row index.\n     * @returns number\n     */\n    Calculate.prototype.rowIndex = function (cell) {\n        var i = 0;\n        var result;\n        var isLetter = false;\n        if (i < cell.length && cell[i] === this.sheetToken) {\n            i++;\n            while (i < cell.length && cell[i] !== this.sheetToken) {\n                i++;\n            }\n            i++;\n        }\n        while (i < cell.length && this.isChar(cell[i])) {\n            isLetter = true;\n            i++;\n        }\n        result = parseInt(cell.substring(i), 10);\n        if (i < cell.length && !this.isNaN(result)) {\n            return result;\n        }\n        if (isLetter) {\n            return -1;\n        }\n        throw this.formulaErrorStrings[FormulasErrorsStrings.bad_index];\n    };\n    /**\n     * To get the column index of the given cell.\n     * @param {string} cell - Cell address for getting column index.\n     * @returns number\n     */\n    Calculate.prototype.colIndex = function (cell) {\n        var j = 0;\n        var k = 0;\n        cell = cell.toUpperCase();\n        if (j < cell.length && cell[j] === this.sheetToken) {\n            j++;\n            while (j < cell.length && cell[j] !== this.sheetToken) {\n                j++;\n            }\n            j++;\n        }\n        while (j < cell.length && this.isChar(cell[j])) {\n            var charCode = cell[j].charCodeAt(0);\n            k = k * 26 + charCode - 64;\n            j++;\n        }\n        if (k === 0) {\n            return -1;\n        }\n        return k;\n    };\n    /**\n     * To get the valid error strings.\n     * @hidden\n     */\n    Calculate.prototype.getErrorStrings = function () {\n        if (this.errorStrings === null) {\n            this.errorStrings = ['#N/A', '#VALUE!', '#REF!', '#DIV/0!', '#NUM!', '#NAME?', '#NULL!'];\n        }\n        return this.errorStrings;\n    };\n    /** @hidden */\n    Calculate.prototype.substring = function (text, startIndex, length) {\n        return text.substring(startIndex, length + startIndex);\n    };\n    /** @hidden */\n    Calculate.prototype.isChar = function (c) {\n        if ((c.charCodeAt(0) >= 65 && c.charCodeAt(0) <= 90) || (c.charCodeAt(0) >= 97 && c.charCodeAt(0) <= 122)) {\n            return true;\n        }\n        return false;\n    };\n    /** @hidden */\n    Calculate.prototype.getSheetFamilyItem = function (model) {\n        if (this.sheetFamilyID === 0) {\n            if (this.defaultFamilyItem == null) {\n                this.defaultFamilyItem = new CalcSheetFamilyItem();\n            }\n            return this.defaultFamilyItem;\n        }\n        if (this.sheetFamiliesList == null) {\n            this.sheetFamiliesList = new Map();\n        }\n        var i = this.modelToSheetID.get(model);\n        if (!this.sheetFamiliesList.has(i)) {\n            this.sheetFamiliesList.set(i, new CalcSheetFamilyItem());\n        }\n        return this.sheetFamiliesList.get(i);\n    };\n    /**\n     * Register a key value pair for formula.\n     * @param {string} key - Key for formula reference .\n     * @param {string | number} value - Value for the corresponding key.\n     * @returns void\n     */\n    Calculate.prototype.setKeyValue = function (key, value) {\n        key = key.toUpperCase();\n        var str = value.toString().trim();\n        if (!this.storedData.get(key) || str.indexOf(this.leftBrace) === 0) {\n            this.storedData.set(key, new FormulaInfo());\n            this.keyToRowsMap.set(key, this.keyToRowsMap.size + 1);\n            this.rowsToKeyMap.set(this.rowsToKeyMap.size + 1, key);\n        }\n        var fInfo = this.storedData.get(key);\n        if (fInfo.getFormulaText() != null && fInfo.getFormulaText().length > 0 && fInfo.getFormulaText() !== str) {\n            var s1 = this.cellPrefix + this.keyToRowsMap.get(key).toString();\n            var formulaDependent = this.getDependentFormulaCells().get(s1);\n            if (formulaDependent != null) {\n                this.clearFormulaDependentCells(s1);\n            }\n        }\n        if (str.length > 0 && str[0] === this.getFormulaCharacter()) {\n            fInfo.setFormulaText(str);\n        }\n        else if (fInfo.getFormulaValue() !== str) {\n            fInfo.setFormulaText('');\n            fInfo.setParsedFormula('');\n            fInfo.setFormulaValue(str);\n        }\n    };\n    /**\n     * @hidden\n     */\n    Calculate.prototype.clearFormulaDependentCells = function (cell) {\n        var _this = this;\n        var dependentFormula = this.getDependentFormulaCells().get(cell);\n        if (dependentFormula != null) {\n            dependentFormula.forEach(function (value, key) {\n                var s = key;\n                var dependent = _this.getDependentCells().get(s);\n                _this.arrayRemove(dependent, cell);\n                if (dependent.length === 0) {\n                    _this.getDependentCells().delete(s);\n                }\n            });\n            this.getDependentFormulaCells().delete(cell);\n        }\n    };\n    Calculate.prototype.arrayRemove = function (array, value) {\n        var index = null;\n        while (index !== -1) {\n            index = array.indexOf(value);\n            array.splice(index, 1);\n        }\n        return array;\n    };\n    /**\n     * Register a key value pair for formula.\n     * @param {string} key - Key for getting the corresponding value.\n     * @returns string | number\n     */\n    Calculate.prototype.getKeyValue = function (key) {\n        key = key.toUpperCase();\n        if (this.storedData.has(key) !== null) {\n            var fInfo = this.storedData.get(key);\n            var fText = fInfo.getFormulaText();\n            if (fText.length > 0 && fText[0] === this.getFormulaCharacter()) {\n                this.cell = this.cellPrefix + this.keyToRowsMap.get(key).toString();\n                fText = fText.substring(1);\n                try {\n                    fInfo.setParsedFormula(this.parser.parseFormula(fText, key));\n                }\n                catch (ex) {\n                    var args = {\n                        message: ex.message, exception: ex, isForceCalculable: false,\n                        computeForceCalculate: false\n                    };\n                    this.trigger('onFailure', args);\n                    fInfo.setFormulaValue(args.message);\n                    return this.storedData.get(key).getFormulaValue();\n                }\n                try {\n                    fInfo.setFormulaValue(this.computeFormula(fInfo.getParsedFormula()));\n                }\n                catch (ex) {\n                    var args = {\n                        message: ex.message, exception: ex, isForceCalculable: false,\n                        computeForceCalculate: false\n                    };\n                    this.trigger('onFailure', args);\n                    var errorMessage = (typeof args.exception === 'string') ? args.exception : args.message;\n                    return (isNullOrUndefined(this.getErrorLine(ex)) ? '' : '#' + this.getErrorLine(ex) + ': ') + errorMessage;\n                }\n            }\n            return this.storedData.get(key).getFormulaValue();\n        }\n        else {\n            return this.emptyString;\n        }\n    };\n    /**\n     * Adds a named range to the NamedRanges collection.\n     * @param {string} name - Name of the named range.\n     * @param {string} range - Range for the specified name.\n     * @param {number} sheetIndex - Defined scope for the specified name. Default - Workbook scope.\n     * @returns boolean\n     */\n    Calculate.prototype.addNamedRange = function (name, range) {\n        var sheetScopeName = name.split(this.sheetToken);\n        if (sheetScopeName.length > 1) {\n            var family = this.getSheetFamilyItem(this.grid);\n            if (!family.parentObjectToToken.get(sheetScopeName[0])) {\n                return false;\n            }\n            name = sheetScopeName[0] + this.sheetToken + sheetScopeName[1].toUpperCase();\n        }\n        else {\n            name = name.toUpperCase();\n        }\n        this.namedRanges.set(name, range);\n        return true;\n    };\n    /**\n     * Remove the specified named range form the named range collection.\n     * @param {string} name - Name of the specified named range.\n     * @returns boolean\n     */\n    Calculate.prototype.removeNamedRange = function (name) {\n        name = name.toUpperCase();\n        if (this.namedRanges.get(name) != null) {\n            this.namedRanges.delete(name);\n            return true;\n        }\n        return false;\n    };\n    /** @hidden */\n    Calculate.prototype.convertAlpha = function (col) {\n        var arrCol = [];\n        var n = 0;\n        var charText = 'A';\n        while (col > 0) {\n            col--;\n            var aCharValue = charText.charCodeAt(0);\n            arrCol[n] = String.fromCharCode(col % 26 + aCharValue);\n            col = parseInt((col / 26).toString(), 10);\n            n++;\n        }\n        return arrCol.join('');\n    };\n    /** @hidden */\n    Calculate.prototype.getCellCollection = function (cellRange) {\n        if (cellRange.indexOf(':') < 0 && !this.isCellReference(cellRange)) {\n            return cellRange.split(this.getParseArgumentSeparator());\n        }\n        var i = cellRange.indexOf(':');\n        var row1;\n        var row2;\n        var col1;\n        var col2;\n        if (i > 0 && this.isChar(cellRange[i - 1])) {\n            var k = i - 2;\n            while (k >= 0 && this.isDigit(cellRange[k])) {\n                k--;\n            }\n        }\n        row1 = this.rowIndex(this.substring(cellRange, 0, i));\n        row2 = this.rowIndex(this.substring(cellRange, i + 1, i + cellRange.length - i - 1));\n        col1 = this.colIndex(this.substring(cellRange, 0, i));\n        col2 = this.colIndex(this.substring(cellRange, i + 1, i + cellRange.length - i - 1));\n        if (row1 > row2) {\n            i = row2;\n            row2 = row1;\n            row1 = i;\n        }\n        if (col1 > col2) {\n            i = col2;\n            col2 = col1;\n            col1 = i;\n        }\n        var cells = [];\n        var j;\n        var c = 0;\n        for (i = row1; i <= row2; i++) {\n            for (j = col1; j <= col2; j++) {\n                cells[c] = this.emptyString + this.convertAlpha(j) + i.toString();\n                c++;\n            }\n        }\n        return cells;\n    };\n    /**\n     * Compute the given formula.\n     * @param {string} formulaText - Specifies to compute the given formula.\n     * @returns string | number\n     */\n    Calculate.prototype.computeFormula = function (formulaText) {\n        var parsedText;\n        var lastIndexOfq;\n        var formulatResult;\n        var nestedFormula = false;\n        var fNested;\n        if (this.parser.isError) {\n            return formulaText;\n        }\n        if (!this.parser.isFormulaParsed) {\n            parsedText = this.parser.parseFormula(formulaText);\n        }\n        else {\n            parsedText = formulaText;\n        }\n        this.parser.isFormulaParsed = false;\n        try {\n            lastIndexOfq = this.findLastIndexOfq(parsedText);\n            if (lastIndexOfq > 0) {\n                nestedFormula = true;\n            }\n            if (parsedText !== this.emptyString && lastIndexOfq > -1) {\n                var i = lastIndexOfq + 1;\n                while (i > -1) {\n                    if (parsedText[i] !== this.rightBracket) {\n                        i++;\n                        continue;\n                    }\n                    var sFormula = parsedText.substring(lastIndexOfq, i + 1);\n                    var libFormula = sFormula.split(this.leftBracket)[0].split('q').join(this.emptyString);\n                    var args = sFormula.substring(sFormula.indexOf(this.leftBracket) + 1, sFormula.indexOf(this.rightBracket))\n                        .split(this.getParseArgumentSeparator());\n                    formulatResult = isNullOrUndefined(this.getFunction(libFormula)) ? this.getErrorStrings()[CommonErrors.name] : this.getFunction(libFormula).apply(void 0, args);\n                    if (nestedFormula) {\n                        fNested = this.processNestedFormula(parsedText, sFormula, formulatResult);\n                        var q = this.findLastIndexOfq(fNested);\n                        if (q === 0) {\n                            nestedFormula = false;\n                        }\n                        if (q === -1) {\n                            formulatResult = this.computeValue(fNested);\n                        }\n                        lastIndexOfq = i = q;\n                        parsedText = fNested;\n                        continue;\n                    }\n                    break;\n                }\n            }\n            else if (this.formulaErrorStrings.indexOf(parsedText) > -1) {\n                formulatResult = parsedText;\n            }\n            else if (parsedText !== this.emptyString && lastIndexOfq === -1) {\n                formulatResult = this.computeValue(parsedText);\n            }\n        }\n        catch (ex) {\n            var args = { message: ex.message, exception: ex, isForceCalculable: false, computeForceCalculate: false };\n            this.trigger('onFailure', args);\n            var errorMessage = (typeof args.exception === 'string') ? args.exception : args.message;\n            formulatResult = (isNullOrUndefined(this.getErrorLine(ex)) ? '' : '#' + this.getErrorLine(ex) + ': ') + errorMessage;\n        }\n        return formulatResult;\n    };\n    /** @hidden */\n    Calculate.prototype.computeSumIfAndAvgIf = function (range) {\n        if (isNullOrUndefined(range) || range[0] === this.emptyString || range.length === 0) {\n            return this.formulaErrorStrings[FormulasErrorsStrings.wrong_number_arguments];\n        }\n        var argArr = range;\n        var argCount = argArr.length;\n        if (argCount !== 2 && argCount !== 3 && argCount === 0) {\n            return this.formulaErrorStrings[FormulasErrorsStrings.wrong_number_arguments];\n        }\n        var rangevalue = argArr[0];\n        var criteria = argCount > 2 ? argArr[2].trim() : argArr[1].trim();\n        criteria = criteria.split(this.tic).join(this.emptyString);\n        if (criteria.length > 255) {\n            return this.getErrorStrings()[CommonErrors.value];\n        }\n        var opt = this.parser.tokenEqual;\n        if (criteria.startsWith('<=')) {\n            opt = this.parser.tokenLessEq;\n            criteria = criteria.substring(2);\n        }\n        else if (criteria.startsWith('>=')) {\n            opt = this.parser.tokenGreaterEq;\n            criteria = criteria.substring(2);\n        }\n        else if (criteria.startsWith('<>')) {\n            opt = this.parser.tokenNotEqual;\n            criteria = criteria.substring(2);\n        }\n        else if (criteria.startsWith('<')) {\n            opt = this.parser.tokenLess;\n            criteria = criteria.substring(1);\n        }\n        else if (criteria.startsWith('>')) {\n            opt = this.parser.tokenGreater;\n            criteria = criteria.substring(1);\n        }\n        else if (criteria.startsWith('=')) {\n            opt = this.parser.tokenEqual;\n            criteria = criteria.substring(1);\n        }\n        var checkCriteria = this.parseFloat(criteria);\n        var criteriaRangeArray = argCount === 2 ? rangevalue : argArr[1];\n        var sumRange = this.getCellCollection(argArr[0]);\n        var criteriaRange = this.getCellCollection(criteriaRangeArray);\n        var result = this.getComputeSumIfValue(criteriaRange, sumRange, criteria, checkCriteria, opt);\n        return [result[0], result[1]];\n    };\n    /** @hidden */\n    Calculate.prototype.computeLookup = function (range) {\n        if (range.length === 0) {\n            return this.formulaErrorStrings[FormulasErrorsStrings.wrong_number_arguments];\n        }\n        var checkCrte = [];\n        var findMaxVal = [];\n        var argArr = range;\n        var argCount = argArr.length;\n        var criterias = argArr[0].split(this.tic).join(this.emptyString);\n        var rangevalue = argArr[1];\n        var lookupRangeArray = argCount === 2 ? rangevalue : argArr[2];\n        var criteriaRange = this.getCellCollection(argArr[1]);\n        var lookupRange = this.getCellCollection(lookupRangeArray);\n        for (var i = 0; i < criteriaRange.length; i++) {\n            findMaxVal[i] = this.getValueFromArg(criteriaRange[i]).split(this.tic).join('');\n        }\n        var s = findMaxVal.toString().split(this.getParseArgumentSeparator());\n        var maxVal = this.parseFloat(s[s.sort().length - 1]);\n        var minVal = this.parseFloat(s[0]);\n        for (var j = 0; j < criteriaRange.length; j++) {\n            checkCrte[j] = this.getValueFromArg(criteriaRange[j]).split(this.tic).join('');\n            if (criterias === checkCrte[j]) {\n                return this.getValueFromArg(lookupRange[j]).split(this.tic).join('');\n            }\n            else if (this.parseFloat(criterias) === this.parseFloat(checkCrte[j])) {\n                return this.getValueFromArg(lookupRange[j]).split(this.tic).join('');\n            }\n            else if (this.parseFloat(criterias) < minVal) {\n                return this.getErrorStrings()[CommonErrors.na];\n            }\n            else if (this.parseFloat(criterias) > maxVal) {\n                var index = findMaxVal.indexOf(maxVal.toString());\n                return this.getValueFromArg(lookupRange[index]).split(this.tic).join('');\n            }\n        }\n        if (findMaxVal.indexOf(criterias) < 0) {\n            var temp = [];\n            for (var n = 0; n < s.length; n++) {\n                if (this.parseFloat(criterias) > this.parseFloat(s[n])) {\n                    temp.push(s[n]);\n                }\n            }\n            var index = findMaxVal.indexOf(temp[temp.length - 1]);\n            return this.getValueFromArg(lookupRange[index]).split(this.tic).join('');\n        }\n        return this.getErrorStrings()[CommonErrors.na];\n    };\n    Calculate.prototype.computeVLookup = function (range) {\n        var argArr = range;\n        var findMaxValue = [];\n        var lookupValue = argArr[0].split(this.tic).join('');\n        if (lookupValue.indexOf(':') > -1) {\n            return this.getErrorStrings()[CommonErrors.value];\n        }\n        if (this.isCellReference(lookupValue)) {\n            lookupValue = this.getValueFromArg(lookupValue);\n        }\n        if (argArr[1].indexOf(':') < -1) {\n            return this.getErrorStrings()[CommonErrors.na];\n        }\n        var lookupRange = [];\n        var firstCol = '';\n        var secCol = '';\n        if (this.isCellReference(argArr[1])) {\n            lookupRange = this.getCellCollection(argArr[1]);\n            if (argArr[1].indexOf(':') > -1) {\n                var index = argArr[1].indexOf(':');\n                for (var i = 0; i < index; i++) {\n                    var tempCell = this.isChar(argArr[1][i]) ? argArr[1][i] : '';\n                    firstCol = firstCol + tempCell;\n                }\n                for (var j = index; j < argArr[1].length; j++) {\n                    var tempCell2 = this.isChar(argArr[1][j]) ? argArr[1][j] : '';\n                    secCol = secCol + tempCell2;\n                }\n            }\n        }\n        var lookupCol = this.colIndex(firstCol) + this.parseFloat(argArr[2]);\n        if (lookupCol > this.colIndex(secCol)) {\n            return this.getErrorStrings()[CommonErrors.na];\n        }\n        if (lookupCol === this.colIndex(firstCol)) {\n            return this.getErrorStrings()[CommonErrors.na];\n        }\n        var lookupCell = this.convertAlpha(lookupCol);\n        argArr[3] = isNullOrUndefined(argArr[3]) ? this.trueValue : argArr[3].split(this.tic).join('');\n        var cellValue = '';\n        for (var i = 0; i < lookupRange.length; i++) {\n            findMaxValue[i] = this.getValueFromArg(lookupRange[i]).split(this.tic).join('');\n        }\n        var s = findMaxValue.toString().split(this.getParseArgumentSeparator());\n        var maxValue = this.parseFloat(s[s.sort().length - 1]);\n        var minValue = this.parseFloat(s[0]);\n        for (var j = 0; j < lookupRange.length; j++) {\n            cellValue = this.getValueFromArg(lookupRange[j]);\n            if (argArr[3].toUpperCase() === this.trueValue) {\n                if (lookupValue === cellValue) {\n                    return this.getValueFromArg(lookupCell + j).split(this.tic).join('');\n                }\n                else if (this.parseFloat(lookupValue) === this.parseFloat(cellValue)) {\n                    return this.getValueFromArg(lookupCell + j).split(this.tic).join('');\n                }\n                else if (this.parseFloat(lookupValue) < minValue) {\n                    return this.getErrorStrings()[CommonErrors.na];\n                }\n                else if (this.parseFloat(lookupValue) > maxValue) {\n                    var index = findMaxValue.indexOf(maxValue.toString());\n                    return this.getValueFromArg(lookupCell + index).split(this.tic).join('');\n                }\n            }\n            if (argArr[3] === this.falseValue) {\n                if (lookupValue === cellValue) {\n                    return this.getValueFromArg(lookupCell + j);\n                }\n            }\n        }\n        return this.getErrorStrings()[CommonErrors.na];\n    };\n    Calculate.prototype.findWildCardValue = function (lookVal, cellValue) {\n        var finalText = '';\n        if (lookVal.indexOf('?') > -1) {\n            var index = lookVal.indexOf('?');\n            var checStr1 = lookVal[index - 1];\n            var checStr2 = lookVal[index + 1];\n            if (cellValue.indexOf(checStr1) > -1 && cellValue.indexOf(checStr2) > -1) {\n                var newIndex = cellValue.indexOf(checStr1);\n                if (cellValue[newIndex] === checStr1 && cellValue[newIndex + 2] === checStr2) {\n                    finalText = lookVal;\n                }\n                else {\n                    finalText = cellValue;\n                }\n            }\n            else {\n                finalText = cellValue;\n            }\n        }\n        else if (lookVal.indexOf('*') > -1) {\n            var index = lookVal.indexOf('*');\n            var left = '';\n            var right = '';\n            var compRight = this.falseValue;\n            var compLeft = this.falseValue;\n            for (var i = index - 1; i >= 0; i--) {\n                left = left + lookVal[i];\n                compLeft = this.trueValue;\n            }\n            for (var i = index + 1; i < lookVal.length; i++) {\n                right = right + lookVal[i];\n                compRight = this.trueValue;\n            }\n            var leftVal = left === '' ? -1 : cellValue.indexOf(left.split('').reverse().join(''));\n            var rightVal = right === '' ? -1 : cellValue.indexOf(right);\n            if (leftVal > -1 || rightVal > -1) {\n                if (compLeft === this.trueValue) {\n                    finalText = (left.split('').reverse().join('') === cellValue.substr(0, left.length)) ? lookVal : cellValue;\n                }\n                else if (compRight === this.trueValue) {\n                    finalText = (right === cellValue.substring(cellValue.length - right.length, cellValue.length)) ? lookVal : cellValue;\n                }\n            }\n            else {\n                finalText = cellValue;\n            }\n        }\n        return finalText;\n    };\n    /** @hidden */\n    /* tslint:disable-next-line */\n    Calculate.prototype.getComputeSumIfValue = function (criteriaRange, sumRange, criteria, checkCriteria, op) {\n        var sum = 0;\n        var count = 0;\n        switch (op) {\n            case this.parser.tokenEqual:\n                {\n                    for (var i = 0; i < criteriaRange.length; i++) {\n                        var value = this.getValueFromArg(criteriaRange[i].split(this.tic).join(''));\n                        var val = this.parseFloat(value);\n                        if (value === criteria && val === checkCriteria) {\n                            var value1 = this.getValueFromArg(sumRange[i].split(this.tic).join(''));\n                            var val1 = this.parseFloat(value1);\n                            sum = sum + val1;\n                            count = count + 1;\n                        }\n                    }\n                }\n                break;\n            case this.parser.tokenLess:\n                {\n                    for (var i = 0; i < criteriaRange.length; i++) {\n                        var value = this.getValueFromArg(criteriaRange[i].split(this.tic).join(''));\n                        var val = this.parseFloat(value);\n                        if (val < checkCriteria) {\n                            var value1 = this.getValueFromArg(sumRange[i].split(this.tic).join(''));\n                            var val1 = this.parseFloat(value1);\n                            sum = sum + val1;\n                            count = count + 1;\n                        }\n                    }\n                }\n                break;\n            case this.parser.tokenGreater:\n                {\n                    for (var i = 0; i < criteriaRange.length; i++) {\n                        var value = this.getValueFromArg(criteriaRange[i].split(this.tic).join(''));\n                        var val = this.parseFloat(value);\n                        if (val > checkCriteria) {\n                            var value1 = this.getValueFromArg(sumRange[i].split(this.tic).join(''));\n                            var val1 = this.parseFloat(value1);\n                            sum = sum + val1;\n                            count = count + 1;\n                        }\n                    }\n                }\n                break;\n            case this.parser.tokenLessEq:\n                {\n                    for (var i = 0; i < criteriaRange.length; i++) {\n                        var value = this.getValueFromArg(criteriaRange[i].split(this.tic).join(''));\n                        var val = this.parseFloat(value);\n                        if (val <= checkCriteria) {\n                            var value1 = this.getValueFromArg(sumRange[i].split(this.tic).join(''));\n                            var val1 = this.parseFloat(value1);\n                            sum = sum + val1;\n                            count = count + 1;\n                        }\n                    }\n                }\n                break;\n            case this.parser.tokenGreaterEq:\n                {\n                    for (var i = 0; i < criteriaRange.length; i++) {\n                        var value = this.getValueFromArg(criteriaRange[i].split(this.tic).join(''));\n                        var val = this.parseFloat(value);\n                        if (val >= checkCriteria) {\n                            var value1 = this.getValueFromArg(sumRange[i].split(this.tic).join(''));\n                            var val1 = this.parseFloat(value1);\n                            sum = sum + val1;\n                            count = count + 1;\n                        }\n                    }\n                }\n                break;\n            case this.parser.tokenNotEqual:\n                {\n                    for (var i = 0; i < criteriaRange.length; i++) {\n                        var value = this.getValueFromArg(criteriaRange[i].split(this.tic).join(''));\n                        var val = this.parseFloat(value);\n                        if (value !== criteria && val !== checkCriteria) {\n                            var value1 = this.getValueFromArg(sumRange[i].split(this.tic).join(''));\n                            var val1 = this.parseFloat(value1);\n                            sum = sum + val1;\n                            count = count + 1;\n                        }\n                    }\n                }\n                break;\n        }\n        return [sum, count];\n    };\n    /** @hidden */\n    Calculate.prototype.computeAndOr = function (args, op) {\n        var result = op === 'and' ? true : false;\n        var value;\n        var parseVal;\n        if (args.length === 0) {\n            return this.formulaErrorStrings[FormulasErrorsStrings.wrong_number_arguments];\n        }\n        for (var l = 0, len = args.length; l < len; l++) {\n            if (args[l].split(this.tic).join('').trim() === this.emptyString) {\n                return this.getErrorStrings()[CommonErrors.value];\n            }\n        }\n        var ranges = args;\n        for (var i = 0; i < ranges.length; i++) {\n            if (ranges[i] === (this.tic)) {\n                return this.getErrorStrings()[CommonErrors.value];\n            }\n            if (ranges[i].indexOf(':') > -1 && this.isCellReference(ranges[i])) {\n                var cells = this.getCellCollection(ranges[i]);\n                for (var j = 0; j < cells.length; j++) {\n                    if (this.getErrorStrings().indexOf(cells[j]) > -1) {\n                        return cells[j];\n                    }\n                    else if (cells[j][0] === this.tic) {\n                        return this.getErrorStrings()[CommonErrors.name];\n                    }\n                    value = this.getValueFromArg(cells[j]);\n                    if (value === '') {\n                        value = this.trueValue;\n                    }\n                    if (this.getErrorStrings().indexOf(value) > -1) {\n                        return value;\n                    }\n                    parseVal = this.parseFloat(value);\n                }\n            }\n            else {\n                value = this.getValueFromArg(ranges[i]).split(this.tic).join('').toUpperCase();\n                if (this.getErrorStrings().indexOf(value) > -1) {\n                    return value;\n                }\n                var tempdate = Date.parse(value.split(this.tic).join(''));\n                if (!isNaN(tempdate)) {\n                    result = true;\n                }\n                else if (!(value === this.trueValue || value === this.falseValue)) {\n                    return this.getErrorStrings()[CommonErrors.value].toString();\n                }\n                parseVal = this.parseFloat(value);\n            }\n            result = op === 'and' ? (result && ((value === this.trueValue) || !(isNaN(parseVal)))) :\n                (result || ((value === this.trueValue) || !(isNaN(parseVal))));\n        }\n        return result ? this.trueValue : this.falseValue;\n    };\n    /** @hidden */\n    // To strip out the tic from the formula arguments.\n    Calculate.prototype.removeTics = function (text) {\n        if (text.length > 1 && text[0] === this.tic[0] && text[text.length - 1] === this.tic[0]) {\n            text = this.substring(text, 1, text.length - 2);\n        }\n        return text;\n    };\n    /* tslint:disable-next-line:max-func-body-length */\n    Calculate.prototype.computeValue = function (pFormula) {\n        try {\n            var stack = [];\n            var i = 0;\n            var sheet = '';\n            stack.length = 0;\n            while (i < pFormula.length) {\n                var uFound = pFormula[i] === 'u'; // for 3*-2\n                if (pFormula[i] === this.arithMarker) {\n                    i = i + 1;\n                    continue;\n                }\n                else if (this.isDigit(pFormula[i])) {\n                    var s = this.emptyString;\n                    while (i < pFormula.length && this.isDigit(pFormula[i])) {\n                        s = s + pFormula[i];\n                        i = i + 1;\n                    }\n                    stack.push(s);\n                }\n                if (pFormula[i] === this.sheetToken) {\n                    sheet = pFormula[i];\n                    i = i + 1;\n                    while (i < pFormula.length && pFormula[i] !== this.sheetToken) {\n                        sheet = sheet + pFormula[i];\n                        i = i + 1;\n                    }\n                    if (i < pFormula.length) {\n                        sheet = sheet + pFormula[i];\n                        i = i + 1;\n                    }\n                }\n                else if (this.isUpperChar(pFormula[i])) {\n                    var s = this.emptyString;\n                    var textName = '';\n                    while (i < pFormula.length && this.isUpperChar(pFormula[i])) {\n                        s = s + pFormula[i];\n                        i = i + 1;\n                    }\n                    while (i < pFormula.length && this.isDigit(pFormula[i])) {\n                        s = s + pFormula[i];\n                        i = i + 1;\n                    }\n                    s = sheet + s;\n                    textName = this.getParentObjectCellValue(s).toString();\n                    if (typeof textName === 'string' && this.getErrorStrings().indexOf(textName) > -1) {\n                        return textName;\n                    }\n                    stack.push(textName);\n                }\n                else if (pFormula[i] === 'q') {\n                    var leftIdx = pFormula.substring(i + 1).indexOf(this.leftBracket);\n                    var j = pFormula.substring(i + leftIdx + 1).indexOf(this.rightBracket);\n                    pFormula = this.substring(pFormula, i + leftIdx + 2, j - 1);\n                }\n                else if (pFormula[i] === this.tic[0]) {\n                    var s = pFormula[i].toString();\n                    i = i + 1;\n                    while (i < pFormula.length && pFormula[i] !== this.tic[0]) {\n                        s = s + pFormula[i];\n                        i = i + 1;\n                    }\n                    stack.push(s.split(this.tic).join(this.emptyString));\n                    i = i + 1;\n                }\n                else if (pFormula[i] === '%' && stack.length > 0) {\n                    var stackValue = stack[0];\n                    var value = this.parseFloat(stackValue);\n                    if (!this.isNaN(value)) {\n                        stack.pop();\n                        stack.push((value / 100).toString());\n                    }\n                    i = i + 1;\n                }\n                else if ((pFormula.substring(i)).indexOf(this.trueValue) === 0) {\n                    stack.push(this.trueValue);\n                    i += this.trueValue.length;\n                }\n                else if (pFormula.substring(i).indexOf(this.falseValue) === 0) {\n                    stack.push(this.falseValue);\n                    i += this.falseValue.length;\n                }\n                else if (pFormula[i] === this.tic[0] || pFormula[i] === '|') {\n                    var s = pFormula[i].toString();\n                    i++;\n                    while (i < pFormula.length && pFormula[i] !== this.tic[0]) {\n                        s = s + pFormula[i];\n                        i = i + 1;\n                    }\n                    stack.push(s + this.tic);\n                    i += 1;\n                }\n                else {\n                    switch (pFormula[i]) {\n                        case '#':\n                            {\n                                var errIndex = 0;\n                                if (this.getErrorStrings().indexOf(pFormula.substring(i)) > -1) {\n                                    if (pFormula.indexOf('!') === -1 || pFormula.substring(i).indexOf('!') === -1) {\n                                        errIndex = pFormula.indexOf('#N/A') > -1 ?\n                                            (pFormula.indexOf('#N/A') + 4 + i) : pFormula.indexOf('?') + 1 + i;\n                                    }\n                                    else {\n                                        errIndex = pFormula.indexOf('!') + 1 + i;\n                                    }\n                                    stack.push(this.substring(pFormula, i, errIndex - i));\n                                }\n                                else {\n                                    errIndex = i + 1;\n                                    stack.push(this.substring(pFormula, i, errIndex - i));\n                                }\n                                i = errIndex;\n                            }\n                            break;\n                        case 'n':\n                            {\n                                i = i + 1;\n                                var s = '';\n                                if (pFormula.substring(i).indexOf('Infinity') === 0) {\n                                    s = 'Infinity';\n                                    i += s.length;\n                                }\n                                else {\n                                    if (pFormula[i] === 'u' || uFound) {\n                                        s = '-';\n                                        if (!uFound) {\n                                            i = i + 1;\n                                        }\n                                        else {\n                                            uFound = false;\n                                        }\n                                    }\n                                    while (i < pFormula.length && (this.isDigit(pFormula[i]))\n                                        || pFormula[i] === this.getParseDecimalSeparator()) {\n                                        s = s + pFormula[i];\n                                        i = i + 1;\n                                    }\n                                }\n                                stack.push(s);\n                            }\n                            break;\n                        case this.parser.tokenAdd:\n                            {\n                                this.getValArithmetic(stack, 'add');\n                                i = i + 1;\n                            }\n                            break;\n                        case this.parser.tokenSubtract:\n                            {\n                                this.getValArithmetic(stack, 'sub');\n                                i = i + 1;\n                            }\n                            break;\n                        case this.parser.tokenMultiply:\n                            {\n                                this.getValArithmetic(stack, 'mul');\n                                i = i + 1;\n                            }\n                            break;\n                        case this.parser.tokenDivide:\n                            {\n                                this.getValArithmetic(stack, 'div');\n                                i = i + 1;\n                            }\n                            break;\n                        case this.parser.tokenLess:\n                            {\n                                this.processLogical(stack, 'less');\n                                i = i + 1;\n                            }\n                            break;\n                        case this.parser.tokenGreater:\n                            {\n                                this.processLogical(stack, 'greater');\n                                i = i + 1;\n                            }\n                            break;\n                        case this.parser.tokenGreaterEq:\n                            {\n                                this.processLogical(stack, 'greaterEq');\n                                i = i + 1;\n                            }\n                            break;\n                        case this.parser.tokenLessEq:\n                            {\n                                this.processLogical(stack, 'lessEq');\n                                i = i + 1;\n                            }\n                            break;\n                        case this.parser.tokenNotEqual:\n                            {\n                                this.processLogical(stack, 'notEq');\n                                i = i + 1;\n                            }\n                            break;\n                        case this.parser.tokenOr:\n                            {\n                                this.processLogical(stack, 'or');\n                                i = i + 1;\n                            }\n                            break;\n                        case this.parser.tokenAnd:\n                            {\n                                this.processLogical(stack, 'and');\n                                i = i + 1;\n                            }\n                            break;\n                        case this.parser.tokenEqual:\n                            {\n                                this.processLogical(stack, 'equal');\n                                i = i + 1;\n                            }\n                            break;\n                        default: {\n                            return this.getErrorStrings()[CommonErrors.value];\n                        }\n                    }\n                }\n            }\n            if (stack.length === 0) {\n                return this.emptyString;\n            }\n            else {\n                var s = this.emptyString;\n                var countValue = stack.length;\n                while (countValue > 0) {\n                    s = stack.pop() + s;\n                    if (s === this.emptyString && this.isCellReference(pFormula) &&\n                        this.getTreatEmptyStringAsZero()) {\n                        return '0';\n                    }\n                    countValue--;\n                }\n                return s;\n            }\n        }\n        catch (ex) {\n            if (this.getErrorStrings().indexOf(ex) > -1) {\n                throw ex;\n            }\n            throw new FormulaError(this.formulaErrorStrings[FormulasErrorsStrings.invalid_expression]);\n        }\n    };\n    Calculate.prototype.getValArithmetic = function (stack, operator) {\n        var num1 = stack.pop();\n        num1 = num1 === this.emptyString ? '0' : num1;\n        var num = parseInt(num1, 10);\n        if (this.isNaN(num)) {\n            throw this.getErrorStrings()[CommonErrors.value];\n        }\n        var num2 = stack.pop();\n        num2 = num2 === this.emptyString ? '0' : num2;\n        num = parseInt(num2, 10);\n        if (this.isNaN(num)) {\n            throw this.getErrorStrings()[CommonErrors.value];\n        }\n        if (operator === 'add') {\n            stack.push((Number(num2) + Number(num1)).toString());\n        }\n        if (operator === 'sub') {\n            stack.push((Number(num2) - Number(num1)).toString());\n        }\n        if (operator === 'mul') {\n            stack.push((Number(num2) * Number(num1)).toString());\n        }\n        if (operator === 'div') {\n            if (this.isNaN(this.parseFloat(num1)) || this.isNaN(this.parseFloat(num2))) {\n                stack.push(this.getErrorStrings()[CommonErrors.value]);\n            }\n            else if (this.parseFloat(num1) === 0) {\n                stack.push(this.getErrorStrings()[CommonErrors.divzero]);\n            }\n            else {\n                stack.push((Number(num2) / Number(num1)).toString());\n            }\n        }\n    };\n    /** @hidden */\n    Calculate.prototype.processLogical = function (stack, operator) {\n        var val1;\n        var val2;\n        var value1;\n        var value2;\n        if (operator !== 'and' && operator !== 'equal') {\n            val1 = stack.pop();\n            val2 = stack.pop();\n            value1 = val1.indexOf(this.tic) > -1 ? val1 : this.parseFloat(val1);\n            value2 = val2.indexOf(this.tic) > -1 ? val2 : this.parseFloat(val2);\n        }\n        var result;\n        if (operator === 'less') {\n            if (!this.isNaN(value1) && !this.isNaN(value2)) {\n                result = (value2 < value1) ? this.trueValue : this.falseValue;\n            }\n            else {\n                result = (val2.toUpperCase().split(this.tic).join('').localeCompare(val1.toUpperCase().split(this.tic).join('')) < 0) ?\n                    this.trueValue : this.falseValue;\n            }\n        }\n        if (operator === 'greater') {\n            if (!this.isNaN(value1) && !this.isNaN(value2)) {\n                result = (value2 > value1) ? this.trueValue : this.falseValue;\n            }\n            else {\n                result = (val2.toUpperCase().split(this.tic).join('').localeCompare(val1.toUpperCase().split(this.tic).join('')) > 0) ?\n                    this.trueValue : this.falseValue;\n            }\n        }\n        if (operator === 'lessEq') {\n            if (!this.isNaN(value1) && !this.isNaN(value2)) {\n                result = (value2 <= value1) ? this.trueValue : this.falseValue;\n            }\n            else {\n                result = (val2.toUpperCase().split(this.tic).join('').localeCompare(val1.toUpperCase().split(this.tic).join('')) <= 0) ?\n                    this.trueValue : this.falseValue;\n            }\n        }\n        if (operator === 'greaterEq') {\n            if (!this.isNaN(value1) && !this.isNaN(value2)) {\n                result = (value2 >= value1) ? this.trueValue : this.falseValue;\n            }\n            else {\n                result = (val2.toUpperCase().split(this.tic).join('').localeCompare(val1.toUpperCase().split(this.tic).join('')) >= 0) ?\n                    this.trueValue : this.falseValue;\n            }\n        }\n        if (operator === 'notEq') {\n            result = (val2 !== val1) ? this.trueValue : this.falseValue;\n        }\n        if (operator === 'and') {\n            val1 = stack.pop().toString();\n            val2 = '';\n            if (stack.length > 0) {\n                val2 = stack.pop().toString();\n            }\n            result = this.emptyString + val2 + val1 + this.emptyString;\n            result = result.split(this.tic).join('');\n        }\n        if (operator === 'equal') {\n            val1 = stack.pop().toString();\n            val2 = stack.pop().toString();\n            result = val1 === val2 ? this.trueValue : this.falseValue;\n        }\n        if (operator === 'or') {\n            result = Math.pow(this.parseFloat(value2), this.parseFloat(value1)).toString();\n        }\n        stack.push(result);\n        return result;\n    };\n    /** @hidden */\n    Calculate.prototype.computeStoreCells = function (sCell) {\n        var cellValue = sCell.cellValue;\n        var cellRanges = sCell.cellRange;\n        var criterias = sCell.criteria;\n        var argArr = sCell.argArray;\n        var isCriteria = sCell.isCriteria;\n        var storeCell = sCell.storedCells;\n        var isCountIfs = sCell.isCountIfS;\n        var i = sCell.countVal;\n        var rangeLength = isCriteria === this.trueValue ? storeCell : cellValue;\n        var tempStoredCell = [];\n        for (var j = 0; j < rangeLength.length; j++) {\n            var stack = [];\n            var cellVal = this.getValueFromArg(cellValue[j]);\n            var criteria = void 0;\n            var newCell = '';\n            criteria = argArr[2].split(this.tic).join(this.emptyString);\n            isCriteria = isCountIfs === this.trueValue ? this.trueValue : isCriteria;\n            if (isCriteria === this.trueValue) {\n                var cell = '';\n                var count = 0;\n                var newCount = 0;\n                storeCell[j] = isCountIfs === this.trueValue && i === 0 ? cellValue[j] : storeCell[j];\n                cell = storeCell[j];\n                // convert the new cell ranges  for find in range with criteria.\n                while (!this.isDigit(cell[count])) {\n                    count = count + 1;\n                }\n                if (this.isCellReference(cellRanges[i]) && cellRanges[i].indexOf(':') > -1) {\n                    var k = cellRanges[i].indexOf(':');\n                    newCell = this.substring(cellRanges[i], k);\n                    while (!this.isDigit(newCell[newCount])) {\n                        newCount = newCount + 1;\n                    }\n                }\n                var cellAlpha = this.substring(cell, count);\n                var newCellAlpha = this.substring(newCell, newCount);\n                newCell = storeCell[j].split(cellAlpha).join(newCellAlpha);\n                cellVal = this.getValueFromArg(newCell);\n                criteria = isCountIfs === this.trueValue ? criterias[i].split(this.tic).join(this.emptyString) :\n                    criterias[i - 1].split(this.tic).join(this.emptyString);\n            }\n            var op = 'equal';\n            if (criteria.startsWith('<=')) {\n                op = 'lessEq';\n                criteria = criteria.substring(2);\n            }\n            else if (criteria.startsWith('>=')) {\n                op = 'greaterEq';\n                criteria = criteria.substring(2);\n            }\n            else if (criteria.startsWith('<>')) {\n                op = 'notEq';\n                criteria = criteria.substring(2);\n            }\n            else if (criteria.startsWith('<')) {\n                op = 'less';\n                criteria = criteria.substring(1);\n            }\n            else if (criteria.startsWith('>')) {\n                op = 'greater';\n                criteria = criteria.substring(1);\n            }\n            else if (criteria.startsWith('=')) {\n                op = 'equal';\n                criteria = criteria.substring(1);\n            }\n            if (criteria.indexOf('*') > -1 || criteria.indexOf('?') > -1) {\n                cellVal = this.findWildCardValue(criteria, cellVal);\n            }\n            stack.push(cellVal.toLowerCase());\n            stack.push(criteria.toLowerCase());\n            if (this.processLogical(stack, op) === this.trueValue) {\n                if (isCriteria === this.falseValue) {\n                    tempStoredCell.push(cellValue[j]);\n                }\n                else {\n                    tempStoredCell.push(newCell);\n                }\n            }\n        }\n        storeCell = tempStoredCell;\n        tempStoredCell = [];\n        return storeCell;\n    };\n    Calculate.prototype.computeIfsFormulas = function (range, isCountIfs, isAvgIfs) {\n        if (isNullOrUndefined(range) || range[0] === '' || range.length === 0) {\n            return this.formulaErrorStrings[FormulasErrorsStrings.wrong_number_arguments];\n        }\n        var argArr = range;\n        var argCount = argArr.length;\n        if (argCount < 2 || argCount > 127) {\n            return this.formulaErrorStrings[FormulasErrorsStrings.wrong_number_arguments];\n        }\n        var cellRanges = [];\n        var criterias = [];\n        var storedCell = [];\n        var storedCellLength = 0;\n        var sum = 0;\n        for (var i = 0; i < argArr.length; i++) {\n            if (argArr[i].indexOf(':') > -1 && this.isCellReference(argArr[i])) {\n                cellRanges.push(argArr[i]);\n            }\n            else {\n                criterias.push(argArr[i]);\n            }\n        }\n        cellRanges = cellRanges.toString().split(',,').join(',');\n        cellRanges = cellRanges.split(this.getParseArgumentSeparator());\n        var cellvalue;\n        var isCriteria;\n        if (isCountIfs === this.falseValue) {\n            isCriteria = this.falseValue;\n            cellvalue = this.getCellCollection(cellRanges[1]);\n            var sCell = {\n                cellValue: cellvalue, cellRange: cellRanges, criteria: criterias,\n                argArray: argArr, isCriteria: isCriteria, storedCells: storedCell, isCountIfS: isCountIfs\n            };\n            storedCell = this.computeStoreCells(sCell);\n            storedCellLength = storedCell.length;\n            if (storedCellLength === 0) {\n                return 0;\n            }\n        }\n        // Compare criteria and convert the new cell ranges.\n        var startRange;\n        startRange = isCountIfs === this.trueValue ? 0 : 2;\n        for (var i = startRange; i < cellRanges.length; i++) {\n            isCriteria = this.trueValue;\n            isCriteria = isCountIfs === this.trueValue && i === 0 ? this.falseValue : this.trueValue;\n            cellvalue = this.getCellCollection(cellRanges[i]);\n            var sCell = {\n                cellValue: cellvalue, cellRange: cellRanges, criteria: criterias,\n                argArray: argArr, isCriteria: isCriteria, storedCells: storedCell, isCountIfS: isCountIfs, countVal: i\n            };\n            storedCell = this.computeStoreCells(sCell);\n            storedCellLength = storedCell.length;\n            if (storedCellLength === 0) {\n                return 0;\n            }\n        }\n        for (var j = 0; j < storedCell.length; j++) {\n            // convert the new cell ranges  for find sum in range 0(first range)\n            var cell = '';\n            var newCell = '';\n            var count = 0;\n            var newCount = 0;\n            cell = storedCell[j];\n            while (!this.isDigit(cell[count])) {\n                count = count + 1;\n            }\n            if (this.isCellReference(cellRanges[0]) && cellRanges[0].indexOf(':') > -1) {\n                var k = cellRanges[0].indexOf(':');\n                newCell = this.substring(cellRanges[0], k);\n                while (!this.isDigit(newCell[newCount])) {\n                    newCount = newCount + 1;\n                }\n            }\n            var cellAlpha = this.substring(cell, count);\n            var newCellAlpha = this.substring(newCell, newCount);\n            cellvalue = storedCell[j].split(cellAlpha).join(newCellAlpha);\n            if (isCountIfs === this.trueValue) {\n                sum = sum + 1;\n            }\n            else {\n                var argValue = this.getValueFromArg(cellvalue);\n                sum = sum + parseFloat(argValue === '' ? '0' : argValue);\n            }\n        }\n        if (isAvgIfs === this.trueValue) {\n            sum = sum / cellvalue.length;\n        }\n        return sum;\n    };\n    Calculate.prototype.processNestedFormula = function (pText, sFormula, fResult) {\n        var lastIndexq = this.findLastIndexOfq(pText);\n        var interiorCalcFString = pText.split(sFormula).join('n' + fResult);\n        return interiorCalcFString;\n    };\n    /** @hidden */\n    Calculate.prototype.isNaN = function (value) {\n        if (value.toString() === 'NaN' || typeof value === 'string') {\n            return true;\n        }\n        return false;\n    };\n    /** @hidden */\n    Calculate.prototype.fromOADate = function (doubleNumber) {\n        var result = new Date();\n        result.setTime((doubleNumber * this.millisecondsOfaDay) + Date.parse(this.oaDate.toString()));\n        return result;\n    };\n    /** @hidden */\n    Calculate.prototype.getSerialDateFromDate = function (year, month, day) {\n        var days = 0;\n        if (year < 1900) {\n            year += 1900;\n        }\n        var isValidMonth = false;\n        while (!isValidMonth) {\n            while (month > 12) {\n                year++;\n                month -= 12;\n            }\n            isValidMonth = true;\n            var tempDay = new Date(year, month, 1, -1).getDate();\n            while (day > tempDay) {\n                tempDay = new Date(year, month, 1, -1).getDate();\n                month++;\n                day -= tempDay;\n                isValidMonth = false;\n            }\n            if (day < 1) {\n                month--;\n                tempDay = new Date(year, month, 1, -1).getDate();\n                day = tempDay - day;\n            }\n        }\n        var dateTime = Date.parse(year.toString() + this.getParseDateTimeSeparator() + month.toString() +\n            this.getParseDateTimeSeparator() + day.toString());\n        if (!this.isNaN(dateTime)) {\n            days = this.toOADate(new Date(dateTime));\n        }\n        return days;\n    };\n    /** @hidden */\n    Calculate.prototype.toOADate = function (dateTime) {\n        var result = (dateTime.getTime() - Date.parse(this.oaDate.toString())) / this.millisecondsOfaDay;\n        return result;\n    };\n    /** @hidden */\n    Calculate.prototype.calculateDate = function (date) {\n        return (this.parseFloat(date) < 10) ? '0' + date : date;\n    };\n    /** @hidden */\n    Calculate.prototype.isTextEmpty = function (s) {\n        return s === null || s === '';\n    };\n    /** @hidden */\n    Calculate.prototype.isDigit = function (text) {\n        var charCode = text.charCodeAt(0);\n        if ((charCode > 47) && (charCode < 58)) {\n            return true;\n        }\n        return false;\n    };\n    Calculate.prototype.findLastIndexOfq = function (fString) {\n        return fString.lastIndexOf('q');\n    };\n    /**\n     * To get the exact value from argument.\n     * @param {string} arg - Formula argument for getting a exact value.\n     * @returns string\n     */\n    Calculate.prototype.getValueFromArg = function (arg) {\n        arg = arg.trim();\n        var s = arg;\n        var dateTime = this.dateTime1900;\n        var pObjCVal = s;\n        if (isNullOrUndefined(s) || this.isTextEmpty(s)) {\n            return s;\n        }\n        else if (arg[0] === this.tic || arg[0] === this.singleTic) {\n            dateTime = this.isDate(arg.split(this.tic).join(''));\n            if (this.isNaN(this.parseFloat(arg.split(this.tic).join(''))) && !isNullOrUndefined(dateTime) &&\n                !this.isNaN(dateTime.getDate()) && this.dateTime1900 <= dateTime) {\n                return this.toOADate(dateTime).toString();\n            }\n            return arg;\n        }\n        else {\n            arg = arg.split('u').join('-');\n            /* tslint:disable:max-line-length */\n            if (!this.isUpperChar(s[0]) && (this.isDigit(s[0]) || s[0] === this.getParseDecimalSeparator() || s[0] === '-' || s[0] === 'n')) {\n                if (s[0] === 'n') {\n                    s = s.substring(1);\n                }\n                return s;\n            }\n        }\n        var symbolArray = ['+', '-', '/', '*', ')', ')', '{'];\n        if ((this.parser.indexOfAny(s, symbolArray) === -1 && this.isUpperChar(s[0])) || s[0] === this.sheetToken) {\n            if (s !== this.trueValue && s !== this.falseValue && this.isCellReference(s)) {\n                var f = this.getSheetFamilyItem(this.grid);\n                if (f.sheetNameToParentObject !== null && f.sheetNameToParentObject.size > 0 && s.indexOf(this.sheetToken) === -1) {\n                    var token = f.parentObjectToToken.get(this.grid);\n                    s = token + s;\n                }\n            }\n            if (s === this.cell) {\n                var dependent = this.getDependentCells().get(s);\n                if (dependent != null && dependent.indexOf(s) > -1) {\n                    this.arrayRemove(dependent, s);\n                }\n                if (!this.getDependentFormulaCells().has(this.cell)) {\n                    this.clearFormulaDependentCells(this.cell);\n                }\n                throw this.formulaErrorStrings[FormulasErrorsStrings.circular_reference] + s;\n            }\n            pObjCVal = this.getParentObjectCellValue(s);\n            this.updateDependentCell(s);\n            return pObjCVal.toString();\n        }\n        if (this.getErrorStrings().indexOf(arg) > -1) {\n            return arg;\n        }\n        return this.computeValue(pObjCVal.toString());\n    };\n    /* tslint:disable-next-line */\n    Calculate.prototype.isDate = function (date) {\n        if (typeof date === 'object' || Date.parse(date) !== null) {\n            var dateval = new Date(Date.parse(date));\n            if (dateval >= this.dateTime1900) {\n                return dateval;\n            }\n            else {\n                return null;\n            }\n        }\n        else {\n            return null;\n        }\n    };\n    Calculate.prototype.isValidCellReference = function (text) {\n        var start = 0;\n        var end = 0;\n        var j = 0;\n        var numArr = [89, 71, 69];\n        var cellTxt = this.emptyString;\n        if (this.namedRanges.has(text)) {\n            return false;\n        }\n        for (var i = 0; i < text.length; i++) {\n            if (this.isChar(text[i])) {\n                end++;\n            }\n        }\n        cellTxt = text.substring(start, end);\n        if (cellTxt.length < 4) {\n            while (j < cellTxt.length) {\n                if (!isNullOrUndefined(cellTxt[j]) && cellTxt[j].charCodeAt(0) < numArr[j]) {\n                    j++;\n                    continue;\n                }\n                else if (isNullOrUndefined(cellTxt[j]) && j > 0) {\n                    break;\n                }\n                else {\n                    return false;\n                }\n            }\n            var cellNum = this.parseFloat(text.substring(end, text.length));\n            if (cellNum < 1048576) { // Maximum number of rows in excel.\n                return true;\n            }\n        }\n        return false;\n    };\n    /** @hidden */\n    /* tslint:disable-next-line */\n    Calculate.prototype.parseDate = function (date) {\n        if (!this.isNaN(date)) {\n            if (date instanceof Date) {\n                return new Date(date);\n            }\n            var d = parseInt(date, 10);\n            if (d < 0) {\n                return this.getErrorStrings()[CommonErrors.num];\n            }\n            if (d <= 60) {\n                return new Date(this.dateTime1900.getTime() + (d - 1) * 86400000);\n            }\n            return new Date(this.dateTime1900.getTime() + (d - 2) * 86400000);\n        }\n        if (typeof date === 'string') {\n            date = new Date(date);\n            if (!this.isNaN(date)) {\n                return date;\n            }\n        }\n        return this.getErrorStrings()[CommonErrors.value];\n    };\n    /** @hidden */\n    Calculate.prototype.isCellReference = function (args) {\n        if (args === this.emptyString) {\n            return false;\n        }\n        args = args.trim();\n        args = this.setTokensForSheets(args);\n        var sheetToken1 = this.getSheetToken(args);\n        var containsBoth = false;\n        if (sheetToken1 !== '') {\n            args = args.split(sheetToken1).join(this.emptyString);\n        }\n        var isAlpha = false;\n        var isNum = false;\n        if (args.indexOf(':') !== args.lastIndexOf(':')) {\n            return false;\n        }\n        var charArray = (args.split('').join(this.getParseArgumentSeparator())).split(this.getParseArgumentSeparator());\n        for (var c = 0; c < charArray.length; c++) {\n            if (this.isChar(charArray[c])) {\n                isAlpha = true;\n            }\n            else if (this.isDigit(charArray[c])) {\n                isNum = true;\n            }\n            else if (charArray[c] === ':') {\n                if (isAlpha && isNum) {\n                    containsBoth = true;\n                }\n                isAlpha = false;\n                isNum = false;\n            }\n            else {\n                return false;\n            }\n        }\n        if (args.indexOf(':') > -1 && args.indexOf(this.tic) === -1) {\n            if (containsBoth && isAlpha && isNum) {\n                return true;\n            }\n            else if (((isAlpha && !isNum) || (!isAlpha && isNum)) && !containsBoth) {\n                return true;\n            }\n            else {\n                return false;\n            }\n        }\n        if (isAlpha && isNum && args.indexOf(this.tic) === -1) {\n            return true;\n        }\n        return false;\n    };\n    /** @hidden */\n    Calculate.prototype.setTokensForSheets = function (text) {\n        var family = this.getSheetFamilyItem(this.grid);\n        var sortedSheetNamesCollection = this.getSortedSheetNames();\n        if (sortedSheetNamesCollection != null) {\n            for (var n = 0; n < sortedSheetNamesCollection.length; n++) {\n                var token = family.sheetNameToToken.get(sortedSheetNamesCollection[n]);\n                token = token.split(this.sheetToken).join(this.tempSheetPlaceHolder);\n                var s = '\"' + sortedSheetNamesCollection[n].toUpperCase() + '\"' + this.sheetToken;\n                if (text.indexOf(s) === -1) {\n                    s = sortedSheetNamesCollection[n].toUpperCase() + this.sheetToken;\n                }\n                text = text.split('SHEET' + s).join(token);\n                s = sortedSheetNamesCollection[n].toUpperCase() + this.sheetToken;\n                text = text.split(s).join(token);\n            }\n        }\n        text = text.split(this.tempSheetPlaceHolder).join(this.sheetToken);\n        return text;\n    };\n    Calculate.prototype.getParentObjectCellValue = function (val) {\n        if (val === this.trueValue || val === this.falseValue) {\n            return val;\n        }\n        var i = val.lastIndexOf(this.sheetToken);\n        var row = 0;\n        var col = 0;\n        var grid = this.grid;\n        var family = this.getSheetFamilyItem(grid);\n        if (i > -1 && family.tokenToParentObject !== null) {\n            this.grid = family.tokenToParentObject.get(val.substring(0, i + 1));\n            row = this.rowIndex(val);\n            col = this.colIndex(val);\n        }\n        else if (i === -1) {\n            var j = 0;\n            while (j < val.length && this.isChar(val[j])) {\n                j++;\n            }\n            if (j === val.length) {\n                val = val.toLowerCase();\n                return this.getErrorStrings()[CommonErrors.name];\n            }\n            else {\n                row = this.rowIndex(val);\n                col = this.colIndex(val);\n                if (family.isSheetMember && family.parentObjectToToken != null) {\n                    val = family.parentObjectToToken.get(this.grid) + val;\n                }\n            }\n        }\n        var saveCell = (this.cell === '' || this.cell === null) ? '' : this.cell;\n        this.cell = val;\n        var cValue = this.getParentCellValue(row, col, this.grid);\n        this.grid = grid;\n        this.cell = saveCell;\n        return cValue;\n    };\n    Calculate.prototype.getParentCellValue = function (row, col, grd) {\n        var alreadyComputed = false;\n        // formulainfotable\n        var cValue;\n        /* tslint:disable-next-line */\n        if (this.parentObject.getValueRowCol === undefined) {\n            cValue = this.getValueRowCol(this.getSheetID(grd) + 1, row, col);\n        }\n        else {\n            /* tslint:disable-next-line */\n            cValue = this.parentObject.getValueRowCol(this.getSheetID(grd) + 1, row, col);\n            return isNullOrUndefined(cValue) ? this.emptyString : cValue.toString();\n        }\n        if (cValue === '' || cValue === undefined) {\n            cValue = '';\n        }\n        // if (cValue[cValue.length - 1] == (\"%\") && !this.isNaN(d)) {\n        //     cValue = (Number(d) / 100).toString();\n        // }\n        return cValue;\n    };\n    /**\n     * Getting the formula result.\n     * @param {Object} grid - Specifies the parent object.\n     * @param {number} row - Row index of the parent object or key.\n     * @param {number} col - Column index of the parent object.\n     * @returns string\n     */\n    Calculate.prototype.getValueRowCol = function (grid, row, col) {\n        var key = this.rowsToKeyMap.get(row).toString();\n        var result = this.getKeyValue(key).toString();\n        if (result != null && result[result.length - 1] === ('%') && result.length > 1) {\n            var d = this.parseFloat(result.substring(0, result.length - 1));\n            if (this.isNaN(d)) {\n                result = (Number(d) / 100).toString();\n            }\n        }\n        return result;\n    };\n    /**\n     * To add custom library formula.\n     * @param {string} formulaName - Custom Formula name.\n     * @param {string} functionName - Custom function name.\n     * @returns void\n     */\n    Calculate.prototype.defineFunction = function (formulaName, functionName) {\n        if (typeof functionName === 'string') {\n            functionName = getValue(functionName, window);\n        }\n        formulaName = formulaName.toUpperCase();\n        this.libraryFormulas.set(formulaName, { handler: functionName, isCustom: true });\n    };\n    /**\n     * Specifies when changing the value.\n     * @param {string} grid - Parent object reference name.\n     * @param {ValueChangedArgs} changeArgs - Value changed arguments.\n     * @param {boolean} isCalculate - Value that allow to calculate.\n     */\n    Calculate.prototype.valueChanged = function (grid, changeArgs, isCalculate) {\n        var pgrid = grid;\n        this.grid = grid;\n        var isComputedValueChanged = false;\n        var isCompute = true;\n        var calcFamily = this.getSheetFamilyItem(pgrid);\n        var cellTxt = getAlphalabel(changeArgs.getColIndex()) + changeArgs.getRowIndex().toString();\n        if (calcFamily.sheetNameToParentObject !== null && calcFamily.sheetNameToParentObject.size > 0) {\n            var token = calcFamily.parentObjectToToken.get(pgrid);\n            cellTxt = token + cellTxt;\n        }\n        if (changeArgs.getValue() && changeArgs.getValue()[0] === this.getFormulaCharacter()) {\n            this.cell = cellTxt;\n            var formula = void 0;\n            if (!isNullOrUndefined(isCompute)) {\n                isCompute = isCalculate;\n            }\n            if (this.getFormulaInfoTable().has(cellTxt)) {\n                formula = this.getFormulaInfoTable().get(cellTxt);\n                if (changeArgs.getValue() !== formula.getFormulaText() || formula.getParsedFormula() == null) {\n                    formula.setFormulaText(changeArgs.getValue());\n                    if (this.getDependentFormulaCells().has(this.cell)) {\n                        this.clearFormulaDependentCells(this.cell);\n                    }\n                    try {\n                        formula.setParsedFormula(this.parser.parseFormula(changeArgs.getValue()));\n                    }\n                    catch (ex) {\n                        formula.setFormulaValue(ex);\n                        isCompute = false;\n                    }\n                }\n                if (isCompute) {\n                    this.parser.isFormulaParsed = true;\n                    var cValue = this.computeFormula(formula.getParsedFormula());\n                    isComputedValueChanged = (cValue !== formula.getFormulaValue());\n                    formula.setFormulaValue(cValue);\n                }\n            }\n            else {\n                formula = new FormulaInfo();\n                formula.setFormulaText(changeArgs.getValue());\n                if (!this.getDependentFormulaCells().has(cellTxt)) {\n                    this.getDependentFormulaCells().set(cellTxt, new Map());\n                }\n                try {\n                    formula.setParsedFormula(this.parser.parseFormula(changeArgs.getValue()));\n                }\n                catch (ex) {\n                    formula.setFormulaValue(ex);\n                    isCompute = false;\n                }\n                if (isCompute) {\n                    formula.setFormulaValue(this.computeFormula(formula.getParsedFormula()));\n                }\n                if (this.getFormulaInfoTable().has(cellTxt)) {\n                    this.getFormulaInfoTable().set(cellTxt, formula);\n                }\n                else {\n                    this.getFormulaInfoTable().set(cellTxt, formula);\n                }\n            }\n            if (isCompute) {\n                /* tslint:disable */\n                if (this.parentObject.setValueRowCol === undefined) {\n                    this.setValueRowCol(this.getSheetID(pgrid) + 1, formula.getFormulaValue(), changeArgs.getRowIndex(), changeArgs.getColIndex());\n                }\n                else {\n                    this.parentObject.setValueRowCol(this.getSheetID(pgrid) + 1, formula.getFormulaValue(), changeArgs.getRowIndex(), changeArgs.getColIndex());\n                }\n                /* tslint:enable */\n            }\n        }\n        else if (this.getFormulaInfoTable().has(cellTxt)) {\n            this.getFormulaInfoTable().delete(cellTxt);\n            if (this.getDependentFormulaCells().has(cellTxt)) {\n                this.clearFormulaDependentCells(cellTxt);\n            }\n        }\n        if (isCompute && isComputedValueChanged && this.getDependentCells().has(cellTxt)) {\n            // this.getComputedValue().clear();\n            // this.refresh(cellTxt);\n        }\n    };\n    /**\n     * @hidden\n     */\n    Calculate.prototype.setValueRowCol = function (value, formulaValue, row, col) {\n        /* No Implementation */\n    };\n    Calculate.prototype.getSortedSheetNames = function () {\n        var family = this.getSheetFamilyItem(this.grid);\n        if (family != null && family.sheetNameToToken != null) {\n            var arr_1 = [];\n            family.sheetNameToToken.forEach(function (value, key) {\n                arr_1.push(key);\n                arr_1.sort();\n            });\n            this.sortedSheetNames = arr_1;\n            this.sortedSheetNames.sort();\n        }\n        return this.sortedSheetNames;\n    };\n    /** @hidden */\n    Calculate.prototype.getErrorLine = function (error) {\n        /* tslint:disable-next-line */\n        var errorStack = error.stack ? error.stack.split('\\n')[1].split(':') : null;\n        return errorStack ? errorStack[errorStack.length - 2] : null; // Getting row number of the error file.\n    };\n    /** @hidden */\n    Calculate.prototype.createSheetFamilyID = function () {\n        if (this.sheetFamilyID === Number.MAX_SAFE_INTEGER) {\n            this.sheetFamilyID = Number.MIN_SAFE_INTEGER;\n        }\n        return this.sheetFamilyID++;\n    };\n    /** @hidden */\n    Calculate.prototype.computeMinMax = function (args, operation) {\n        var result;\n        var argVal;\n        var countStrVal = 0;\n        if (isNullOrUndefined(args) || args.length === 0) {\n            return this.formulaErrorStrings[FormulasErrorsStrings.wrong_number_arguments];\n        }\n        for (var k = 0, len = args.length; k < len; k++) {\n            if (args[k].split(this.tic).join('').trim() === this.emptyString) {\n                return this.getErrorStrings()[CommonErrors.value];\n            }\n        }\n        result = (operation === 'max') ? this.minValue : this.maxValue;\n        var argArr = args;\n        if (argArr.length > 255) {\n            return this.getErrorStrings()[CommonErrors.value];\n        }\n        for (var i = 0; i < argArr.length; i++) {\n            if (argArr[i].indexOf(':') > -1 && this.isCellReference(argArr[i])) {\n                var cellValue = this.getCellCollection(argArr[i]);\n                for (var j = 0; j < cellValue.length; j++) {\n                    argVal = this.getValueFromArg(cellValue[j]);\n                    if (this.getErrorStrings().indexOf(argVal) > -1) {\n                        return argVal;\n                    }\n                    var cellVal = this.parseFloat(argVal);\n                    if (argVal === '' || this.isNaN(this.parseFloat(cellVal))) {\n                        countStrVal = countStrVal + 1;\n                        if (countStrVal === cellValue.length) {\n                            result = 0;\n                        }\n                        continue;\n                    }\n                    else {\n                        result = (operation === 'max') ? Math.max(result, cellVal) : Math.min(result, cellVal);\n                    }\n                }\n            }\n            else {\n                var val = void 0;\n                val = this.getValueFromArg(argArr[i]);\n                if (this.getErrorStrings().indexOf(val) > -1) {\n                    return val;\n                }\n                var cellVal = this.parseFloat(val);\n                if (val === '' || this.isNaN(this.parseFloat(cellVal))) {\n                    countStrVal = countStrVal + 1;\n                    if (countStrVal === argVal.length) {\n                        result = 0;\n                    }\n                    continue;\n                }\n                else {\n                    result = (operation === 'max') ? Math.max(result, cellVal) : Math.min(result, cellVal);\n                }\n            }\n        }\n        return result.toString();\n    };\n    /** @hidden */\n    Calculate.prototype.calculateAvg = function (args) {\n        var sumCell = 0;\n        var argArr = args;\n        var cellVal = [];\n        var avgVal = 0;\n        var countNum = 0;\n        var countNum1 = 0;\n        for (var k = 0; k < argArr.length; k++) {\n            if (argArr[k].indexOf(':') > -1 && this.isCellReference(argArr[k])) {\n                countNum = 0;\n                cellVal = this.getCellCollection(argArr[k]);\n                avgVal = 0;\n                for (var i = 0; i < cellVal.length; i++) {\n                    var value = this.getValueFromArg(cellVal[i]);\n                    if (isNullOrUndefined(value) || isNaN(this.parseFloat(value))) {\n                        continue;\n                    }\n                    avgVal = avgVal + this.parseFloat(value);\n                    countNum = countNum + 1;\n                }\n                if (countNum === 0) {\n                    return this.getErrorStrings()[CommonErrors.divzero];\n                }\n                avgVal = avgVal / countNum;\n                sumCell = avgVal + sumCell;\n            }\n            else {\n                if (argArr[k].indexOf(this.tic) > -1) {\n                    if (isNaN(parseFloat(argArr[k].split(this.tic).join('')))) {\n                        return this.getErrorStrings()[CommonErrors.value];\n                    }\n                }\n                if (argArr[k].length === 0) {\n                    argArr[k] = '1';\n                }\n                var value = this.getValueFromArg(argArr[k].split(this.tic).join(''));\n                if (isNullOrUndefined(value) || isNaN(this.parseFloat(value))) {\n                    return this.getErrorStrings()[CommonErrors.name];\n                }\n                sumCell = sumCell + this.parseFloat(value);\n            }\n        }\n        return (sumCell / (argArr.length - countNum1)).toString();\n    };\n    /**\n     * @hidden\n     */\n    Calculate.prototype.registerGridAsSheet = function (refName, model, sheetFamilyID) {\n        if (isNullOrUndefined(this.modelToSheetID)) {\n            this.modelToSheetID = new Map();\n        }\n        if (isNullOrUndefined(this.modelToSheetID.get(model))) {\n            this.modelToSheetID.set(model, sheetFamilyID);\n        }\n        var family = this.getSheetFamilyItem(model);\n        family.isSheetMember = true;\n        var tempRef = refName.toUpperCase();\n        if (family.parentObjectToToken.size === 0) {\n            family.parentObjectToToken = new Map();\n        }\n        if (family.sheetNameToParentObject.size === 0) {\n            family.sheetNameToParentObject = new Map();\n        }\n        if (family.sheetNameToToken.size === 0) {\n            family.sheetNameToToken = new Map();\n        }\n        if (family.tokenToParentObject.size === 0) {\n            family.tokenToParentObject = new Map();\n        }\n        if (!isUndefined(family.sheetNameToParentObject.get(tempRef))) {\n            var token = family.sheetNameToToken.get(tempRef);\n            family.tokenToParentObject.set(token, model);\n            family.parentObjectToToken.set(model, token);\n        }\n        else {\n            var token = this.sheetToken + this.tokenCount.toString() + this.sheetToken;\n            this.tokenCount++;\n            family.tokenToParentObject.set(token, model);\n            family.parentObjectToToken.set(model, token);\n            family.sheetNameToToken.set(tempRef, token);\n            family.sheetNameToParentObject.set(tempRef, model);\n        }\n        return refName;\n    };\n    /**\n     * @hidden\n     */\n    Calculate.prototype.unregisterGridAsSheet = function (refName, model) {\n        var family = this.getSheetFamilyItem(model);\n        var refName1 = refName.toUpperCase();\n        if (family.sheetNameToParentObject != null && family.sheetNameToParentObject.has(refName1)) {\n            family.sheetNameToParentObject.delete(refName1);\n            var token = family.sheetNameToToken.get(refName1);\n            family.sheetNameToToken.delete(refName1);\n            family.tokenToParentObject.delete(token);\n            family.parentObjectToToken.delete(model);\n        }\n    };\n    ;\n    Calculate.prototype.isSheetMember = function () {\n        var family = this.getSheetFamilyItem(this.grid);\n        return isNullOrUndefined(family) ? false : family.isSheetMember;\n    };\n    /**\n     * To dispose the calculate engine.\n     * @returns void\n     */\n    Calculate.prototype.dispose = function () {\n        this.resetKeys();\n        // this.dependentCells.clear();\n        // this.dependentFormulaCells.clear();\n        this.namedRanges.clear();\n        // this.sheetFamiliesList.clear();\n        this.lFormulas.clear();\n    };\n    Calculate.prototype.refresh = function (cellRef) {\n        if (this.getDependentCells().has(cellRef) && this.getDependentCells().get(cellRef) !== null) {\n            var family = this.getSheetFamilyItem(this.grid);\n            try {\n                var dependentCells = this.getDependentCells().get(cellRef);\n                var i = void 0;\n                for (i = 0; i < dependentCells.length; i++) {\n                    var dCell = dependentCells[i];\n                    var token = this.getSheetToken(dCell);\n                    if (token.length) {\n                        this.grid = family.tokenToParentObject.get(token);\n                    }\n                    try {\n                        var rowIdx = this.rowIndex(dCell);\n                        var colIdx = this.colIndex(dCell);\n                        var formulaInfo = this.getFormulaInfoTable().get(dCell);\n                        if (formulaInfo) {\n                            this.cell = dCell;\n                            var result = this.computeFormula(formulaInfo.getFormulaText());\n                            formulaInfo.setFormulaValue(result);\n                        }\n                        if (this.parentObject.setValueRowCol === undefined) {\n                            this.setValueRowCol(this.getSheetID(this.grid) + 1, formulaInfo.getFormulaValue(), rowIdx, colIdx);\n                        }\n                        else {\n                            this.parentObject.setValueRowCol(this.getSheetID(this.grid) + 1, formulaInfo.getFormulaValue(), rowIdx, colIdx);\n                        }\n                    }\n                    catch (ex) {\n                        continue;\n                    }\n                }\n            }\n            finally {\n                this.grid = family.tokenToParentObject.get(this.getSheetToken(cellRef));\n            }\n        }\n    };\n    var Calculate_1;\n    __decorate([\n        Property(true)\n    ], Calculate.prototype, \"includeBasicFormulas\", void 0);\n    __decorate([\n        Event()\n    ], Calculate.prototype, \"onFailure\", void 0);\n    Calculate = Calculate_1 = __decorate([\n        NotifyPropertyChanges\n    ], Calculate);\n    return Calculate;\n}(Base));\nexport { Calculate };\n/** @hidden */\nvar FormulaError = /** @class */ (function () {\n    function FormulaError(errorMessage, formulaAutoCorrection) {\n        this.formulaCorrection = false;\n        this.message = errorMessage;\n        this.formulaCorrection = formulaAutoCorrection;\n    }\n    return FormulaError;\n}());\nexport { FormulaError };\n/** @hidden */\nvar FormulaInfo = /** @class */ (function () {\n    function FormulaInfo() {\n        /**\n         * @hidden\n         */\n        this.calcID = Number.MIN_VALUE + 1;\n        this.calcID1 = Number.MIN_VALUE + 1;\n    }\n    /**\n     * @hidden\n     */\n    FormulaInfo.prototype.getFormulaText = function () {\n        return this.formulaText;\n    };\n    /**\n     * @hidden\n     */\n    FormulaInfo.prototype.setFormulaText = function (value) {\n        this.formulaText = value;\n    };\n    /**\n     * @hidden\n     */\n    FormulaInfo.prototype.getFormulaValue = function () {\n        return this.formulaValue;\n    };\n    /**\n     * @hidden\n     */\n    FormulaInfo.prototype.setFormulaValue = function (value) {\n        this.formulaValue = value;\n    };\n    /**\n     * @hidden\n     */\n    FormulaInfo.prototype.getParsedFormula = function () {\n        return this.parsedFormula;\n    };\n    /**\n     * @hidden\n     */\n    FormulaInfo.prototype.setParsedFormula = function (value) {\n        this.parsedFormula = value;\n    };\n    return FormulaInfo;\n}());\nexport { FormulaInfo };\n/** @hidden */\nvar CalcSheetFamilyItem = /** @class */ (function () {\n    function CalcSheetFamilyItem() {\n        /**\n         * @hidden\n         */\n        this.isSheetMember = false;\n        /**\n         * @hidden\n         */\n        this.parentObjectToToken = new Map();\n        /**\n         * @hidden\n         */\n        this.sheetDependentCells = new Map();\n        /**\n         * @hidden\n         */\n        this.sheetDependentFormulaCells = new Map();\n        /**\n         * @hidden\n         */\n        this.sheetNameToParentObject = new Map();\n        /**\n         * @hidden\n         */\n        this.sheetNameToToken = new Map();\n        /**\n         * @hidden\n         */\n        this.tokenToParentObject = new Map();\n        /**\n         * @hidden\n         */\n        this.sheetFormulaInfotable = new Map();\n    }\n    return CalcSheetFamilyItem;\n}());\nexport { CalcSheetFamilyItem };\n/**\n * @hidden\n */\nexport function getAlphalabel(col) {\n    var cols = [];\n    var n = 0;\n    var charText = 'A';\n    while (col > 0 && n < 9) {\n        col--;\n        var aCharNo = charText.charCodeAt(0);\n        cols[n] = String.fromCharCode(col % 26 + aCharNo);\n        col = parseInt((col / 26).toString(), 10);\n        n++;\n    }\n    var chs = [];\n    for (var i = 0; i < n; i++) {\n        chs[n - i - 1] = cols[i];\n    }\n    return chs.join('');\n}\nvar ValueChangedArgs = /** @class */ (function () {\n    function ValueChangedArgs(row, col, value) {\n        this.row = row;\n        this.col = col;\n        this.value = value;\n        this.getRowIndex = function () {\n            return row;\n        };\n        this.setRowIndex = function (value) {\n            row = value;\n        };\n        this.getColIndex = function () {\n            return col;\n        };\n        this.setColIndex = function (value) {\n            col = value;\n        };\n        this.getValue = function () {\n            return value;\n        };\n        this.setValue = function (value) {\n            value = value;\n        };\n        return this;\n    }\n    return ValueChangedArgs;\n}());\nexport { ValueChangedArgs };\n","/**\n * To get Workbook required modules.\n * @hidden\n * @param {Workbook} context\n */\nexport function getWorkbookRequiredModules(context, modules) {\n    if (modules === void 0) { modules = []; }\n    modules.push({ member: 'workbookBasic', args: [] });\n    modules.push({ member: 'workbookAll', args: [] });\n    modules.push({\n        member: 'dataBind',\n        args: [context]\n    });\n    if (context.allowSave) {\n        modules.push({\n            member: 'workbookSave',\n            args: [context]\n        });\n    }\n    if (context.allowOpen) {\n        modules.push({\n            member: 'workbookOpen',\n            args: [context]\n        });\n    }\n    if (context.allowEditing) {\n        modules.push({\n            member: 'workbookEdit',\n            args: [context]\n        });\n        modules.push({\n            member: 'workbookFormula',\n            args: [context]\n        });\n    }\n    if (context.allowNumberFormatting) {\n        modules.push({\n            member: 'workbookNumberFormat',\n            args: [context]\n        });\n    }\n    if (context.allowCellFormatting) {\n        modules.push({\n            member: 'workbookcellformat',\n            args: [context]\n        });\n    }\n    return modules;\n}\n","/**\n * Check whether the text is formula or not.\n * @param text\n */\nexport function checkIsFormula(text) {\n    return text && text[0] === '=' && text.length > 1;\n}\n","var __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    }\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nimport { Property, ChildProperty, Complex, extend } from '@syncfusion/ej2-base';\nimport { getRowsHeight, getColumnsWidth } from './index';\nimport { CellStyle } from '../common/index';\nimport { getRow } from './row';\n/**\n * Represents the cell.\n */\nvar Cell = /** @class */ (function (_super) {\n    __extends(Cell, _super);\n    function Cell() {\n        return _super !== null && _super.apply(this, arguments) || this;\n    }\n    __decorate([\n        Property('')\n    ], Cell.prototype, \"value\", void 0);\n    __decorate([\n        Property('')\n    ], Cell.prototype, \"formula\", void 0);\n    __decorate([\n        Property(0)\n    ], Cell.prototype, \"index\", void 0);\n    __decorate([\n        Property('General')\n    ], Cell.prototype, \"format\", void 0);\n    __decorate([\n        Complex({}, CellStyle)\n    ], Cell.prototype, \"style\", void 0);\n    return Cell;\n}(ChildProperty));\nexport { Cell };\n/**\n * @hidden\n */\nexport function getCell(rowIndex, colIndex, sheet, isInitRow) {\n    var row = getRow(sheet, rowIndex);\n    if (!row || !row.cells) {\n        if (isInitRow) {\n            if (!row) {\n                sheet.rows[rowIndex] = { cells: [] };\n            }\n            else {\n                sheet.rows[rowIndex].cells = [];\n            }\n        }\n        else {\n            return null;\n        }\n    }\n    return sheet.rows[rowIndex].cells[colIndex];\n}\n/**\n * @hidden\n */\nexport function setCell(rowIndex, colIndex, sheet, cell, isExtend) {\n    if (!sheet.rows[rowIndex]) {\n        sheet.rows[rowIndex] = { cells: [] };\n    }\n    else if (!sheet.rows[rowIndex].cells) {\n        sheet.rows[rowIndex].cells = [];\n    }\n    if (isExtend && sheet.rows[rowIndex].cells[colIndex]) {\n        extend(sheet.rows[rowIndex].cells[colIndex], cell, null, true);\n    }\n    else {\n        sheet.rows[rowIndex].cells[colIndex] = cell;\n    }\n}\n/**\n * @hidden\n */\nexport function getCellPosition(sheet, indexes) {\n    var i;\n    var top = 0;\n    var left = 0;\n    for (i = 0; i < indexes[0]; i++) {\n        top += getRowsHeight(sheet, i);\n    }\n    for (i = 0; i < indexes[1]; i++) {\n        left += getColumnsWidth(sheet, i);\n    }\n    return { top: top, left: left };\n}\n/** @hidden */\nexport function skipDefaultValue(style, defaultKey) {\n    var defaultProps = { fontFamily: 'Calibri', verticalAlign: 'bottom', textIndent: '0pt', backgroundColor: '#ffffff',\n        color: '#000000', textAlign: 'left', fontSize: '11pt', fontWeight: 'normal', fontStyle: 'normal', textDecoration: 'none' };\n    var changedProps = {};\n    Object.keys(defaultKey ? defaultProps : style).forEach(function (propName) {\n        if (style[propName] !== defaultProps[propName]) {\n            changedProps[propName] = style[propName];\n        }\n    });\n    return changedProps;\n}\n","var __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    }\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nimport { Property, Collection, ChildProperty } from '@syncfusion/ej2-base';\nimport { Cell } from './cell';\n/**\n * Configures the Row behavior for the spreadsheet.\n *  ```html\n * <div id='Spreadsheet'></div>\n * ```\n * ```typescript\n * let spreadsheet: Spreadsheet = new Spreadsheet({\n *      sheets: [{\n *                rows: [{\n *                        index: 30,\n *                        cells: [{ index: 4, value: 'Total Amount:' },\n *                               { formula: '=SUM(F2:F30)', style: { fontWeight: 'bold' } }]\n *                }]\n * ...\n * });\n * spreadsheet.appendTo('#Spreadsheet');\n * ```\n */\nvar Row = /** @class */ (function (_super) {\n    __extends(Row, _super);\n    function Row() {\n        return _super !== null && _super.apply(this, arguments) || this;\n    }\n    __decorate([\n        Collection([], Cell)\n    ], Row.prototype, \"cells\", void 0);\n    __decorate([\n        Property(0)\n    ], Row.prototype, \"index\", void 0);\n    __decorate([\n        Property(20)\n    ], Row.prototype, \"height\", void 0);\n    return Row;\n}(ChildProperty));\nexport { Row };\n/**\n * @hidden\n */\nexport function getRow(sheet, rowIndex) {\n    return sheet.rows[rowIndex];\n}\n/**\n * @hidden\n */\nexport function getRowHeight(sheet, rowIndex) {\n    return (sheet && sheet.rows && sheet.rows[rowIndex] && sheet.rows[rowIndex].height) || 20;\n}\n/**\n * @hidden\n */\nexport function setRowHeight(sheet, rowIndex, height) {\n    if (sheet && sheet.rows) {\n        if (!sheet.rows[rowIndex]) {\n            sheet.rows[rowIndex] = {};\n        }\n        sheet.rows[rowIndex].height = height;\n    }\n}\n/**\n * @hidden\n */\nexport function getRowsHeight(sheet, startRow, endRow) {\n    if (endRow === void 0) { endRow = startRow; }\n    var height = 0;\n    var swap;\n    if (startRow > endRow) {\n        swap = startRow;\n        startRow = endRow;\n        endRow = swap;\n    }\n    for (var i = startRow; i <= endRow; i++) {\n        height += getRowHeight(sheet, i);\n    }\n    return height;\n}\n","var __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    }\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nimport { Property, ChildProperty } from '@syncfusion/ej2-base';\n/**\n * Configures the Column behavior for the spreadsheet.\n */\nvar Column = /** @class */ (function (_super) {\n    __extends(Column, _super);\n    function Column() {\n        return _super !== null && _super.apply(this, arguments) || this;\n    }\n    __decorate([\n        Property(0)\n    ], Column.prototype, \"index\", void 0);\n    __decorate([\n        Property(64)\n    ], Column.prototype, \"width\", void 0);\n    return Column;\n}(ChildProperty));\nexport { Column };\n/**\n * @hidden\n */\nexport function getColumn(sheet, colIndex) {\n    if (sheet.columns) {\n        if (!sheet.columns[colIndex]) {\n            sheet.columns[colIndex] = {};\n        }\n    }\n    else {\n        sheet.columns = [];\n        sheet.columns[colIndex] = {};\n    }\n    return sheet.columns[colIndex];\n}\n/**\n * @hidden\n */\nexport function getColumnWidth(sheet, index) {\n    return (sheet && sheet.columns && sheet.columns[index] && sheet.columns[index].width) || 64;\n}\n/**\n * @hidden\n */\nexport function getColumnsWidth(sheet, startCol, endCol) {\n    if (endCol === void 0) { endCol = startCol; }\n    var width = 0;\n    if (startCol > endCol) {\n        var swap = startCol;\n        startCol = endCol;\n        endCol = swap;\n    }\n    for (var i = startCol; i <= endCol; i++) {\n        width += getColumnWidth(sheet, i);\n    }\n    return width;\n}\n","import { getSheetNameFromAddress, getSheetIndex, getSheet } from '../base/index';\nimport { getCellAddress, getIndexesFromAddress } from '../common/address';\nimport { getRow } from './row';\nimport { getCell } from './cell';\nimport { isUndefined, isNullOrUndefined } from '@syncfusion/ej2-base';\nimport { getMaxSheetId, getSheetNameCount } from './sheet';\n/**\n * Update data source to Sheet and returns Sheet\n * @hidden\n */\nexport function getData(context, address) {\n    return new Promise(function (resolve, reject) {\n        resolve((function () {\n            var i;\n            var row;\n            var data = new Map();\n            var sheet = getSheet(context, getSheetIndex(context, getSheetNameFromAddress(address)));\n            var indexes = getIndexesFromAddress(address);\n            var sRow = indexes[0];\n            var args = {\n                sheet: sheet, indexes: indexes, promise: new Promise(function (resolve, reject) { resolve((function () { })()); })\n            };\n            context.notify('updateSheetFromDataSource', args);\n            return args.promise.then(function () {\n                while (sRow <= indexes[2]) {\n                    row = getRow(sheet, sRow);\n                    i = indexes[1];\n                    while (i <= indexes[3]) {\n                        data.set(getCellAddress(sRow, i), row ? getCell(sRow, i, sheet) : null);\n                        i++;\n                    }\n                    sRow++;\n                }\n                return data;\n            });\n        })());\n    });\n}\n/**\n * @hidden\n */\nexport function getModel(model, idx) {\n    var diff;\n    var j;\n    var prevIdx;\n    if (isUndefined(model[idx]) || !(model[idx] && model[idx].index === idx)) {\n        for (var i = 0; i <= idx; i++) {\n            if (model && model[i]) {\n                diff = model[i].index - i;\n                if (diff > 0) {\n                    model.forEach(function (value, index) {\n                        if (value && value.index) {\n                            prevIdx = value.index;\n                            j = 1;\n                        }\n                        if (value && !value.index && index !== 0) {\n                            value.index = prevIdx + j;\n                        }\n                        j++;\n                    });\n                    while (diff--) {\n                        model.splice(i, 0, null);\n                    }\n                    i += diff;\n                }\n            }\n            else if (model) {\n                model[i] = null;\n            }\n            else {\n                model = [];\n            }\n        }\n    }\n    return model[idx];\n}\n/**\n * @hidden\n */\nexport function processIdx(model, isSheet, context) {\n    var j;\n    var diff;\n    var cnt;\n    var len = model.length;\n    for (var i = 0; i < len; i++) {\n        cnt = diff = model[i].index - i;\n        model[i].index = null;\n        if (diff > 0) {\n            j = 0;\n            while (diff--) {\n                if (isSheet) {\n                    context.createSheet(i + j);\n                    j++;\n                }\n                else {\n                    model.splice(i, 0, null);\n                }\n            }\n            i += cnt;\n            len += cnt;\n        }\n        if (isSheet) {\n            model[i].id = getMaxSheetId(context.sheets);\n            if (!model[i].name) {\n                model[i].name = 'Sheet' + getSheetNameCount(context);\n            }\n        }\n    }\n    if (isSheet) {\n        context.setProperties({ 'sheets': context.sheets }, true);\n    }\n}\n/**\n * @hidden\n */\nexport function clearRange(context, address, sheetIdx, valueOnly) {\n    var sheet = getSheet(context, sheetIdx - 1);\n    var range = getIndexesFromAddress(address);\n    var sRIdx = range[0];\n    var eRIdx = range[2];\n    var sCIdx;\n    var eCIdx;\n    for (sRIdx; sRIdx <= eRIdx; sRIdx++) {\n        sCIdx = range[1];\n        eCIdx = range[3];\n        for (sCIdx; sCIdx <= eCIdx; sCIdx++) {\n            var cell = getCell(sRIdx, sCIdx, sheet);\n            if (!isNullOrUndefined(cell) && valueOnly) {\n                delete cell.value;\n                if (!isNullOrUndefined(cell.formula)) {\n                    delete cell.formula;\n                }\n            }\n        }\n    }\n}\n","var __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    }\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nimport { Row } from './row';\nimport { Column } from './column';\nimport { Property, Collection, ChildProperty, Complex } from '@syncfusion/ej2-base';\nimport { processIdx } from './data';\n/**\n * Configures the Range settings for the spreadsheet.\n *  ```html\n * <div id='Spreadsheet'></div>\n * ```\n * ```typescript\n * let spreadsheet: Spreadsheet = new Spreadsheet({\n *      sheets: [{\n *                  name: 'First Sheet',\n *                  rangeSettings: [{ dataSource: defaultData }],\n *                  rows: [{\n *                          index: 30,\n *                          cells: [{ index: 4, value: 'Total Amount:' },\n *                                  { formula: '=SUM(F2:F30)', style: { fontWeight: 'bold' } }]\n *                  }]\n * ...\n * });\n * spreadsheet.appendTo('#Spreadsheet');\n * ```\n */\nvar RangeSetting = /** @class */ (function (_super) {\n    __extends(RangeSetting, _super);\n    function RangeSetting() {\n        return _super !== null && _super.apply(this, arguments) || this;\n    }\n    __decorate([\n        Property(null)\n    ], RangeSetting.prototype, \"dataSource\", void 0);\n    __decorate([\n        Property('A1')\n    ], RangeSetting.prototype, \"startCell\", void 0);\n    __decorate([\n        Property(null)\n    ], RangeSetting.prototype, \"query\", void 0);\n    __decorate([\n        Property(true)\n    ], RangeSetting.prototype, \"showFieldAsHeader\", void 0);\n    return RangeSetting;\n}(ChildProperty));\nexport { RangeSetting };\n/**\n * Used range which contains end row index and end column index of the last used cell in sheet .\n */\nvar UsedRange = /** @class */ (function (_super) {\n    __extends(UsedRange, _super);\n    function UsedRange() {\n        return _super !== null && _super.apply(this, arguments) || this;\n    }\n    __decorate([\n        Property(0)\n    ], UsedRange.prototype, \"rowIndex\", void 0);\n    __decorate([\n        Property(0)\n    ], UsedRange.prototype, \"colIndex\", void 0);\n    return UsedRange;\n}(ChildProperty));\nexport { UsedRange };\n/**\n * Configures the sheet behavior for the spreadsheet.\n */\nvar Sheet = /** @class */ (function (_super) {\n    __extends(Sheet, _super);\n    function Sheet() {\n        return _super !== null && _super.apply(this, arguments) || this;\n    }\n    __decorate([\n        Property(0)\n    ], Sheet.prototype, \"id\", void 0);\n    __decorate([\n        Collection([], Row)\n    ], Sheet.prototype, \"rows\", void 0);\n    __decorate([\n        Collection([], Column)\n    ], Sheet.prototype, \"columns\", void 0);\n    __decorate([\n        Collection([], RangeSetting)\n    ], Sheet.prototype, \"rangeSettings\", void 0);\n    __decorate([\n        Property(0)\n    ], Sheet.prototype, \"index\", void 0);\n    __decorate([\n        Property('')\n    ], Sheet.prototype, \"name\", void 0);\n    __decorate([\n        Property(100)\n    ], Sheet.prototype, \"rowCount\", void 0);\n    __decorate([\n        Property(100)\n    ], Sheet.prototype, \"colCount\", void 0);\n    __decorate([\n        Property('A1')\n    ], Sheet.prototype, \"selectedRange\", void 0);\n    __decorate([\n        Property('A1')\n    ], Sheet.prototype, \"activeCell\", void 0);\n    __decorate([\n        Complex({}, UsedRange)\n    ], Sheet.prototype, \"usedRange\", void 0);\n    __decorate([\n        Property('A1')\n    ], Sheet.prototype, \"topLeftCell\", void 0);\n    __decorate([\n        Property(true)\n    ], Sheet.prototype, \"showHeaders\", void 0);\n    __decorate([\n        Property(true)\n    ], Sheet.prototype, \"showGridLines\", void 0);\n    return Sheet;\n}(ChildProperty));\nexport { Sheet };\n/**\n * To get sheet index from address.\n * @hidden\n */\nexport function getSheetIndex(context, name) {\n    var idx;\n    for (var i = 0; i < context.sheets.length; i++) {\n        if (context.sheets[i].name === name) {\n            idx = i;\n            break;\n        }\n    }\n    return idx;\n}\n/**\n * To get sheet index from address.\n * @hidden\n */\nexport function getSheetIndexFromId(context, id) {\n    var idx;\n    for (var i = 0; i < context.sheets.length; i++) {\n        if (context.sheets[i].id === id) {\n            idx = i;\n            break;\n        }\n    }\n    return idx + 1;\n}\n/**\n * To get sheet name from address.\n * @hidden\n */\nexport function getSheetNameFromAddress(address) {\n    return address.split('!')[0];\n}\n/**\n * update selected range\n * @hidden\n */\nexport function updateSelectedRange(context, range, sheet) {\n    if (sheet === void 0) { sheet = {}; }\n    sheet.selectedRange = range;\n    context.setProperties({ 'sheets': context.sheets }, true);\n}\n/**\n * get selected range\n * @hidden\n */\nexport function getSelectedRange(sheet) {\n    return sheet && sheet.selectedRange || 'A1';\n}\n/**\n * @hidden\n */\nexport function getSheet(context, idx) {\n    return context.sheets[idx];\n}\n/**\n * @hidden\n */\nexport function getSheetNameCount(context) {\n    var name = [];\n    context.sheets.forEach(function (sheet) {\n        name.push(sheet.name.toLowerCase());\n    });\n    for (var i = 0; i < name.length; i++) {\n        if (name.indexOf('sheet' + context.sheetNameCount) > -1) {\n            context.sheetNameCount++;\n        }\n        else {\n            return context.sheetNameCount++;\n        }\n    }\n    return context.sheetNameCount++;\n}\n/**\n * @hidden\n */\nexport function getMaxSheetId(sheets) {\n    var cnt = 0;\n    sheets.forEach(function (sheet) {\n        cnt = Math.max(sheet.id, cnt);\n    });\n    return cnt + 1;\n}\n/**\n * @hidden\n */\nexport function initSheet(context) {\n    context.sheets.forEach(function (sheet) {\n        processIdx(sheet.columns);\n        initRow(sheet.rows);\n    });\n    processIdx(context.sheets, true, context);\n}\nfunction initRow(rows) {\n    rows.forEach(function (row) {\n        if (row.cells) {\n            processIdx(row.cells);\n        }\n    });\n    processIdx(rows);\n}\n/**\n * get sheet name\n * @hidden\n */\nexport function getSheetName(context, idx) {\n    if (idx === void 0) { idx = context.activeSheetTab; }\n    return getSheet(context, idx - 1).name;\n}\n","import { getWorkbookRequiredModules } from '../../workbook/common/module';\n/**\n * To get Spreadsheet required modules.\n * @hidden\n * @param {Spreadsheet} context\n */\nexport function getRequiredModules(context) {\n    var modules = [];\n    pushBasicModules(context, modules);\n    getWorkbookRequiredModules(context, modules);\n    return modules;\n}\nfunction pushBasicModules(context, modules) {\n    modules.push({ member: 'basic', args: [] });\n    modules.push({ member: 'all', args: [] });\n    if (context.showRibbon) {\n        modules.push({\n            member: 'ribbon',\n            args: [context]\n        });\n    }\n    if (context.showFormulaBar) {\n        modules.push({\n            member: 'formulaBar',\n            args: [context]\n        });\n    }\n    if (context.showSheetTabs) {\n        modules.push({\n            member: 'sheetTabs',\n            args: [context]\n        });\n    }\n    if (context.allowEditing) {\n        modules.push({\n            member: 'edit',\n            args: [context]\n        });\n        modules.push({\n            member: 'formula',\n            args: [context]\n        });\n        modules.push({\n            member: 'workbookFormula',\n            args: [context]\n        });\n        modules.push({\n            member: 'workbookEdit',\n            args: [context]\n        });\n    }\n    if (context.allowOpen) {\n        modules.push({\n            member: 'open',\n            args: [context]\n        });\n    }\n    if (context.allowSave) {\n        modules.push({\n            member: 'save',\n            args: [context]\n        });\n    }\n    if (context.enableContextMenu) {\n        modules.push({\n            member: 'contextMenu',\n            args: [context]\n        });\n    }\n    if (context.selectionSettings.mode !== 'None') {\n        modules.push({\n            member: 'selection',\n            args: [context]\n        });\n    }\n    if (context.enableKeyboardNavigation) {\n        modules.push({\n            member: 'keyboardNavigation',\n            args: [context]\n        });\n    }\n    if (context.allowNumberFormatting) {\n        modules.push({\n            member: 'numberFormat',\n            args: [context]\n        });\n    }\n    if (context.enableKeyboardShortcut) {\n        modules.push({\n            member: 'keyboardShortcut',\n            args: [context]\n        });\n    }\n    if (context.enableClipboard) {\n        modules.push({\n            member: 'clipboard',\n            args: [context]\n        });\n    }\n    if (context.allowCellFormatting) {\n        modules.push({\n            member: 'cellformat',\n            args: [context]\n        });\n    }\n}\n","import { Browser, setStyleAttribute as setBaseStyleAttribute, getComponent } from '@syncfusion/ej2-base';\nimport { getCellPosition, getRowsHeight, getColumnsWidth, getSwapRange } from '../../workbook/index';\n/**\n * The function used to update Dom using requestAnimationFrame.\n * @param  {Function} fn - Function that contains the actual action\n * @return {Promise<T>}\n * @hidden\n */\nexport function getUpdateUsingRaf(fn) {\n    requestAnimationFrame(function () {\n        fn();\n    });\n}\n/**\n * The function used to remove the dom element children.\n * @param  parent -\n * @hidden\n */\nexport function removeAllChildren(parent, index) {\n    while (parent.firstChild) {\n        parent.removeChild(parent.firstChild);\n    }\n}\n/**\n * The function used to remove the dom element children.\n * @param  parent -\n * @hidden\n */\nexport function getColGroupWidth(index) {\n    var width = 30;\n    if (index.toString().length > 3) {\n        width = index.toString().length * 10;\n    }\n    return width;\n}\nvar scrollAreaWidth = null;\n/** @hidden */\nexport function getScrollBarWidth() {\n    if (scrollAreaWidth !== null) {\n        return scrollAreaWidth;\n    }\n    var htmlDivNode = document.createElement('div');\n    var result = 0;\n    htmlDivNode.style.cssText = 'width:100px;height: 100px;overflow: scroll;position: absolute;top: -9999px;';\n    document.body.appendChild(htmlDivNode);\n    result = (htmlDivNode.offsetWidth - htmlDivNode.clientWidth) | 0;\n    document.body.removeChild(htmlDivNode);\n    return scrollAreaWidth = result;\n}\nvar classes = ['e-ribbon', 'e-formula-bar-panel', 'e-sheet-tab-panel', 'e-header-toolbar'];\n/** @hidden */\nexport function getSiblingsHeight(element, classList) {\n    if (classList === void 0) { classList = classes; }\n    var previous = getHeightFromDirection(element, 'previous', classList);\n    var next = getHeightFromDirection(element, 'next', classList);\n    return previous + next;\n}\nfunction getHeightFromDirection(element, direction, classList) {\n    // tslint:disable-next-line:no-any\n    var sibling = element[direction + 'ElementSibling'];\n    var result = 0;\n    while (sibling) {\n        if (classList.some(function (value) { return sibling.classList.contains(value); })) {\n            result += sibling.offsetHeight;\n        }\n        // tslint:disable-next-line:no-any\n        sibling = sibling[direction + 'ElementSibling'];\n    }\n    return result;\n}\n/**\n * @hidden\n */\nexport function inView(context, range, isModify) {\n    if (context.scrollSettings.enableVirtualization) {\n        var topIdx = context.viewport.topIndex;\n        var leftIdx = context.viewport.leftIndex;\n        var bottomIdx = topIdx + context.viewport.rowCount + context.getThreshold('row') * 2;\n        var rightIdx = leftIdx + context.viewport.colCount + context.getThreshold('col') * 2;\n        var inView_1 = topIdx <= range[0] && bottomIdx >= range[2] && leftIdx <= range[1] && rightIdx >= range[3];\n        if (inView_1) {\n            return true;\n        }\n        if (isModify) {\n            if (range[0] < topIdx && range[2] < topIdx || range[0] > bottomIdx && range[2] > bottomIdx) {\n                return false;\n            }\n            else {\n                if (range[0] < topIdx && range[2] > topIdx) {\n                    range[0] = topIdx;\n                    inView_1 = true;\n                }\n                if (range[2] > bottomIdx) {\n                    range[2] = bottomIdx;\n                    inView_1 = true;\n                }\n            }\n            if (range[1] < leftIdx && range[3] < leftIdx || range[1] > rightIdx && range[3] > rightIdx) {\n                return false;\n            }\n            else {\n                if (range[1] < leftIdx && range[3] > leftIdx) {\n                    range[1] = leftIdx;\n                    inView_1 = true;\n                }\n                if (range[3] > rightIdx) {\n                    range[3] = rightIdx;\n                    inView_1 = true;\n                }\n            }\n        }\n        return inView_1;\n    }\n    else {\n        return true;\n    }\n}\n/**\n * Position element with given range\n * @hidden\n */\nexport function locateElem(ele, range, sheet) {\n    var swapRange = getSwapRange(range);\n    var cellPosition = getCellPosition(sheet, swapRange);\n    setStyleAttribute([{\n            element: ele, attrs: {\n                'top': swapRange[0] === 0 ? cellPosition.top : cellPosition.top - 1 + 'px',\n                'left': swapRange[1] === 0 ? cellPosition.left : cellPosition.left - 1 + 'px',\n                'height': getRowsHeight(sheet, range[0], range[2]) + (swapRange[0] === 0 ? 0 : 1) + 'px',\n                'width': getColumnsWidth(sheet, range[1], range[3]) + (swapRange[1] === 0 ? 0 : 1) + 'px'\n            }\n        }]);\n}\n/**\n * To update element styles using request animation frame\n * @hidden\n */\nexport function setStyleAttribute(styles) {\n    requestAnimationFrame(function () {\n        styles.forEach(function (style) {\n            setBaseStyleAttribute(style.element, style.attrs);\n        });\n    });\n}\n/**\n * @hidden\n */\nexport function getStartEvent() {\n    return (Browser.isPointer ? 'pointerdown' : 'mousedown touchstart');\n}\n/**\n * @hidden\n */\nexport function getMoveEvent() {\n    return (Browser.isPointer ? 'pointermove' : 'mousemove touchmove');\n}\n/**\n * @hidden\n */\nexport function getEndEvent() {\n    return (Browser.isPointer ? 'pointerup' : 'mouseup touchend');\n}\n/**\n * @hidden\n */\nexport function isTouchStart(e) {\n    return e.type === 'touchstart' || (e.type === 'pointerdown' && e.pointerType === 'touch');\n}\n/**\n * @hidden\n */\nexport function isTouchMove(e) {\n    return e.type === 'touchmove' || (e.type === 'pointermove' && e.pointerType === 'touch');\n}\n/**\n * @hidden\n */\nexport function isTouchEnd(e) {\n    return e.type === 'touchend' || (e.type === 'pointerup' && e.pointerType === 'touch');\n}\n/**\n * @hidden\n */\nexport function getClientX(e) {\n    return e.changedTouches ? e.changedTouches[0].clientX : e.clientX;\n}\n/**\n * @hidden\n */\nexport function getClientY(e) {\n    return e.changedTouches ? e.changedTouches[0].clientY : e.clientY;\n}\nvar config = {\n    role: 'role',\n    selected: 'aria-selected',\n    multiselectable: 'aria-multiselectable',\n    busy: 'aria-busy',\n    colcount: 'aria-colcount'\n};\n/** @hidden */\nexport function setAriaOptions(target, options) {\n    var props = Object.keys(options);\n    props.forEach(function (name) {\n        if (target) {\n            target.setAttribute(config[name], options[name]);\n        }\n    });\n}\n/**\n * @hidden\n */\nexport function destroyComponent(element, component) {\n    if (element) {\n        var compObj = getComponent(element, component);\n        if (compObj) {\n            compObj.destroy();\n        }\n    }\n}\n","/**\n * Specifies the number format types in Spreadsheet.\n */\nexport var NumberFormatType;\n(function (NumberFormatType) {\n    NumberFormatType[\"General\"] = \"General\";\n    NumberFormatType[\"Number\"] = \"Number\";\n    NumberFormatType[\"Currency\"] = \"Currency\";\n    NumberFormatType[\"Accounting\"] = \"Accounting\";\n    NumberFormatType[\"ShortDate\"] = \"ShortDate\";\n    NumberFormatType[\"LongDate\"] = \"LongDate\";\n    NumberFormatType[\"Time\"] = \"Time\";\n    NumberFormatType[\"Percentage\"] = \"Percentage\";\n    NumberFormatType[\"Fraction\"] = \"Fraction\";\n    NumberFormatType[\"Scientific\"] = \"Scientific\";\n    NumberFormatType[\"Text\"] = \"Text\";\n})(NumberFormatType || (NumberFormatType = {}));\n","/**\n * Specifies Workbook internal events.\n */\n/** @hidden */\nexport var workbookDestroyed = 'workbookDestroyed';\n/** @hidden */\nexport var workbookOpen = 'workbookOpen';\n/** @hidden */\nexport var beginSave = 'beginSave';\n/** @hidden */\nexport var saveCompleted = 'saveCompleted';\n/** @hidden */\nexport var applyNumberFormatting = 'applyNumber';\n/** @hidden */\nexport var getFormattedCellObject = 'getFormattedCell';\n/** @hidden */\nexport var refreshCellElement = 'refreshCellElem';\n/** @hidden */\nexport var setCellFormat = 'setCellFormat';\n/** @hidden */\nexport var textDecorationUpdate = 'textDecorationUpdate';\n/** @hidden */\nexport var applyCellFormat = 'applyCellFormat';\n/** @hidden */\nexport var updateUsedRange = 'updateUsedRange';\n/** @hidden */\nexport var workbookFormulaOperation = 'workbookFormulaOperation';\n/** @hidden */\nexport var workbookEditOperation = 'workbookEditOperation';\n/** @hidden */\nexport var checkDateFormat = 'checkDateFormat';\n/** @hidden */\nexport var getFormattedBarText = 'getFormattedBarText';\n/** @hidden */\nexport var activeCellChanged = 'activeCellChanged';\n/** @hidden */\nexport var openSuccess = 'openSuccess';\n/** @hidden */\nexport var openFailure = 'openFailure';\n/** @hidden */\nexport var sheetCreated = 'sheetCreated';\n/** @hidden */\nexport var sheetsDestroyed = 'sheetsDestroyed';\n","import { DataManager, Query, Deferred } from '@syncfusion/ej2-data';\nimport { getCell, setCell } from '../base/index';\nimport { getRangeIndexes, checkIsFormula, NumberFormatType } from '../common/index';\nimport { checkDateFormat } from '../common/event';\nimport { getFormatFromType } from './number-format';\n/**\n * Data binding module\n */\nvar DataBind = /** @class */ (function () {\n    function DataBind(parent) {\n        this.parent = parent;\n        this.addEventListener();\n    }\n    DataBind.prototype.addEventListener = function () {\n        this.parent.on('updateSheetFromDataSource', this.updateSheetFromDataSourceHandler, this);\n        this.parent.on('dataSourceChanged', this.dataSourceChangedHandler, this);\n    };\n    /**\n     * Destroys the Data binding module.\n     * @return {void}\n     */\n    DataBind.prototype.destroy = function () {\n        this.removeEventListener();\n        this.parent = null;\n    };\n    DataBind.prototype.removeEventListener = function () {\n        if (!this.parent.isDestroyed) {\n            this.parent.off('updateSheetFromDataSource', this.updateSheetFromDataSourceHandler);\n            this.parent.off('dataSourceChanged', this.dataSourceChangedHandler);\n        }\n    };\n    /**\n     * Update given data source to sheet.\n     */\n    DataBind.prototype.updateSheetFromDataSourceHandler = function (args) {\n        var _this = this;\n        var cell;\n        var flds;\n        var sCellIdx;\n        var result;\n        var remoteUrl;\n        var isLocal;\n        var dataManager;\n        var requestedRange = [];\n        var sRanges = [];\n        var rowIdx;\n        var deferred = new Deferred();\n        var sRowIdx;\n        var sColIdx;\n        var loadedInfo;\n        args.promise = deferred.promise;\n        if (args.sheet && args.sheet.rangeSettings.length) {\n            var _loop_1 = function (k) {\n                var sRange = args.indexes[0];\n                var eRange = args.indexes[2];\n                var range = args.sheet.rangeSettings[k];\n                sRowIdx = getRangeIndexes(range.startCell)[0];\n                dataManager = range.dataSource instanceof DataManager ? range.dataSource\n                    : range.dataSource ? new DataManager(range.dataSource) : new DataManager();\n                remoteUrl = remoteUrl || dataManager.dataSource.url;\n                args.sheet.isLocalData = isLocal || !dataManager.dataSource.url;\n                if (sRowIdx <= sRange) {\n                    sRange = sRange - sRowIdx;\n                }\n                else {\n                    if (sRowIdx <= eRange) {\n                        eRange = eRange - sRowIdx;\n                        sRange = 0;\n                    }\n                    else {\n                        sRange = -1;\n                    }\n                }\n                if (range.showFieldAsHeader && sRange !== 0) {\n                    sRange -= 1;\n                }\n                var isEndReached = false;\n                this_1.initRangeInfo(range);\n                var count = this_1.getMaxCount(range);\n                loadedInfo = this_1.getLoadedInfo(sRange, eRange, range);\n                sRange = loadedInfo.unloadedRange[0];\n                eRange = loadedInfo.unloadedRange[1];\n                if (sRange > count) {\n                    isEndReached = true;\n                }\n                else if (eRange > count) {\n                    eRange = count;\n                }\n                if (sRange >= 0 && loadedInfo.isNotLoaded && !isEndReached) {\n                    sRanges[k] = sRange;\n                    requestedRange.push(false);\n                    var query = (range.query ? range.query : new Query()).clone();\n                    dataManager.executeQuery(query.range(sRange, eRange >= count ? eRange : eRange + 1)\n                        .requiresCount()).then(function (e) {\n                        if (!_this.parent || _this.parent.isDestroyed) {\n                            return;\n                        }\n                        result = (e.result && e.result.result ? e.result.result : e.result);\n                        if (result.length) {\n                            range.info.count = e.count;\n                            flds = Object.keys(result[0]);\n                            range.info.fldLen = flds.length;\n                            sCellIdx = getRangeIndexes(range.startCell);\n                            sRowIdx = sCellIdx[0];\n                            sColIdx = sCellIdx[1];\n                            if (sRanges[k] === 0 && range.showFieldAsHeader) {\n                                flds.forEach(function (field, i) {\n                                    cell = getCell(sRowIdx + sRanges[k], sColIdx + i, args.sheet, true);\n                                    if (!cell) {\n                                        args.sheet.rows[sRowIdx + sRanges[k]].cells[sColIdx + i] = { value: field };\n                                    }\n                                    else if (!cell.value) {\n                                        cell.value = field;\n                                    }\n                                });\n                            }\n                            result.forEach(function (item, i) {\n                                for (var j = 0; j < flds.length; j++) {\n                                    rowIdx = sRowIdx + sRanges[k] + i + (range.showFieldAsHeader ? 1 : 0);\n                                    cell = getCell(rowIdx, sColIdx + j, args.sheet, true);\n                                    if (cell) {\n                                        if (!cell.value) {\n                                            setCell(rowIdx, sColIdx + j, args.sheet, _this.getCellDataFromProp(item[flds[j]]), true);\n                                        }\n                                    }\n                                    else {\n                                        args.sheet.rows[rowIdx]\n                                            .cells[sColIdx + j] = _this.getCellDataFromProp(item[flds[j]]);\n                                    }\n                                    _this.checkDataForFormat({\n                                        args: args, cell: cell, colIndex: sColIdx + j, rowIndex: rowIdx, i: i, j: j, k: k,\n                                        range: range, sRanges: sRanges, value: item[flds[j]]\n                                    });\n                                }\n                            });\n                        }\n                        args.sheet.usedRange.rowIndex =\n                            Math.max(sRowIdx + (count || e.count) + (range.showFieldAsHeader ? 1 : 0), args.sheet.usedRange.rowIndex);\n                        args.sheet.usedRange.colIndex = Math.max(sColIdx + flds.length - 1, args.sheet.usedRange.colIndex);\n                        range.info.loadedRange.push([sRange, eRange]);\n                        requestedRange[k] = true;\n                        if (requestedRange.indexOf(false) === -1) {\n                            if (remoteUrl) {\n                                _this.updateSheetFromDataSourceHandler({\n                                    sheet: args.sheet, indexes: [0, 0, args.sheet.usedRange.rowIndex, args.sheet.usedRange.colIndex],\n                                    promise: new Promise(function (resolve) { resolve((function () { })()); })\n                                });\n                            }\n                            deferred.resolve();\n                        }\n                    });\n                }\n                else if (k === 0 && requestedRange.indexOf(false) === -1) {\n                    deferred.resolve();\n                }\n            };\n            var this_1 = this;\n            for (var k = args.sheet.rangeSettings.length - 1; k >= 0; k--) {\n                _loop_1(k);\n            }\n        }\n        else {\n            deferred.resolve();\n        }\n    };\n    DataBind.prototype.getCellDataFromProp = function (prop) {\n        var data = {};\n        if (Object.prototype.toString.call(prop) === '[object Object]') {\n            if (prop.formula) {\n                data.formula = prop.formula;\n            }\n            else if (prop.value) {\n                data.value = prop.value;\n            }\n        }\n        else {\n            if (checkIsFormula(prop)) {\n                data.formula = prop;\n            }\n            else {\n                data.value = prop;\n            }\n        }\n        return data;\n    };\n    DataBind.prototype.checkDataForFormat = function (args) {\n        if (args.value !== '') {\n            var dateEventArgs = {\n                value: args.value,\n                rowIndex: args.rowIndex,\n                colIndex: args.colIndex,\n                isDate: false,\n                updatedVal: args.value,\n                isTime: false\n            };\n            this.parent.notify(checkDateFormat, dateEventArgs);\n            if (dateEventArgs.isDate) {\n                if (args.cell) {\n                    args.cell.format = getFormatFromType(NumberFormatType.ShortDate);\n                    args.cell.value = dateEventArgs.updatedVal;\n                }\n                else {\n                    args.args.sheet.rows[args.rowIndex]\n                        .cells[args.colIndex].format = getFormatFromType(NumberFormatType.ShortDate);\n                    args.args.sheet.rows[args.rowIndex]\n                        .cells[args.colIndex].value = dateEventArgs.updatedVal;\n                }\n            }\n            else if (dateEventArgs.isTime) {\n                if (args.cell) {\n                    args.cell.format = getFormatFromType(NumberFormatType.Time);\n                    args.cell.value = dateEventArgs.updatedVal;\n                }\n                else {\n                    args.args.sheet.rows[args.rowIndex]\n                        .cells[args.colIndex].format = getFormatFromType(NumberFormatType.Time);\n                    args.args.sheet.rows[args.rowIndex]\n                        .cells[args.colIndex].value = dateEventArgs.updatedVal;\n                }\n            }\n        }\n    };\n    DataBind.prototype.getLoadedInfo = function (sRange, eRange, range) {\n        var isNotLoaded = true;\n        range.info.loadedRange.forEach(function (range) {\n            if (range[0] <= sRange && sRange <= range[1]) {\n                if (range[0] <= eRange && eRange <= range[1]) {\n                    isNotLoaded = false;\n                }\n                else {\n                    sRange = range[1] + 1;\n                }\n            }\n            else if (range[0] <= eRange && eRange <= range[1]) {\n                eRange = range[0] - 1;\n            }\n        });\n        return { isNotLoaded: isNotLoaded, unloadedRange: [sRange, eRange] };\n    };\n    DataBind.prototype.getMaxCount = function (range) {\n        if (range.query) {\n            var query = range.query.queries;\n            for (var i = 0; i < query.length; i++) {\n                if (query[i].fn === 'onTake') {\n                    return Math.min(query[i].e.nos, range.info.count || query[i].e.nos);\n                }\n            }\n        }\n        return range.info.count;\n    };\n    DataBind.prototype.initRangeInfo = function (range) {\n        if (!range.info) {\n            range.info = { loadedRange: [] };\n        }\n    };\n    /**\n     * Remove old data from sheet.\n     */\n    DataBind.prototype.dataSourceChangedHandler = function (args) {\n        var oldSheet = args.oldProp.sheets[args.sheetIdx];\n        var row;\n        var sheet = this.parent.sheets[args.sheetIdx];\n        var oldRange = oldSheet && oldSheet.rangeSettings && oldSheet.rangeSettings[args.rangeIdx];\n        if (oldRange) {\n            var indexes_1 = getRangeIndexes(oldRange.startCell);\n            sheet.rangeSettings[args.rangeIdx].info.loadedRange = [];\n            oldRange.info.loadedRange.forEach(function (range) {\n                for (var i = range[0]; i < range[1]; i++) {\n                    row = sheet.rows[i + indexes_1[0]];\n                    for (var j = indexes_1[1]; j < indexes_1[1] + oldRange.info.fldLen; j++) {\n                        row.cells[j].value = '';\n                    }\n                }\n            });\n        }\n        this.parent.notify('data-refresh', { sheetIdx: args.sheetIdx });\n    };\n    /**\n     * For internal use only - Get the module name.\n     * @private\n     */\n    DataBind.prototype.getModuleName = function () {\n        return 'dataBind';\n    };\n    return DataBind;\n}());\nexport { DataBind };\n","/**\n * Open properties.\n */\nimport { isUndefined } from '@syncfusion/ej2-base';\nimport { workbookOpen, openSuccess, openFailure, sheetsDestroyed, workbookFormulaOperation, sheetCreated } from '../common/index';\nimport { getMaxSheetId } from '../base/index';\nvar WorkbookOpen = /** @class */ (function () {\n    function WorkbookOpen(parent) {\n        this.parent = parent;\n        this.addEventListener();\n    }\n    /**\n     * To open the excel file stream or excel url into the spreadsheet.\n     * @param {OpenOptions} options - Options to open a excel file.\n     */\n    WorkbookOpen.prototype.open = function (options) {\n        var _this = this;\n        if (!this.parent.allowOpen) {\n            return;\n        }\n        var formData = new FormData();\n        if (options.file) {\n            formData.append('file', options.file);\n        }\n        else {\n            this.parent.isOpen = false;\n            return;\n        }\n        var eventArgs = {\n            file: options.file || null,\n            cancel: false,\n            requestData: {\n                method: 'POST',\n                body: formData\n            }\n        };\n        this.parent.trigger('beforeOpen', eventArgs);\n        if (eventArgs.cancel) {\n            return;\n        }\n        fetch(this.parent.openUrl, eventArgs.requestData)\n            .then(function (response) {\n            if (response.ok) {\n                return response.json();\n            }\n            else {\n                return Promise.reject({\n                    status: response.status,\n                    statusText: response.statusText,\n                    url: response.url\n                });\n            }\n        })\n            .then(function (data) { return _this.fetchSuccess(data); })\n            .catch(function (error) { return _this.fetchFailure(error); });\n    };\n    WorkbookOpen.prototype.fetchFailure = function (error) {\n        if (isUndefined(error.status) && isUndefined(error.statusText)) {\n            error.statusText = 'Improper response';\n        }\n        this.parent.notify(openFailure, error);\n        this.parent.isOpen = false;\n    };\n    WorkbookOpen.prototype.fetchSuccess = function (data) {\n        var openError = ['UnsupportedFile', 'InvalidUrl'];\n        var workbookData = data;\n        workbookData = (typeof data === 'string') ? JSON.parse(data) : data;\n        /* tslint:disable-next-line:no-any */\n        var impData = workbookData.Workbook;\n        if (openError.indexOf(impData) > -1) {\n            this.parent.notify(openSuccess, {\n                context: this, data: impData\n            });\n            return;\n        }\n        this.updateModel(impData);\n        this.parent.notify(openSuccess, this);\n        this.parent.isOpen = false;\n    };\n    WorkbookOpen.prototype.updateModel = function (workbookModel) {\n        var _this = this;\n        this.parent.notify(workbookFormulaOperation, { action: 'unRegisterSheet' });\n        this.parent.sheetNameCount = 1;\n        this.parent.sheets = [];\n        this.parent.notify(sheetsDestroyed, {});\n        workbookModel.activeSheetTab = workbookModel.activeSheetTab || 1;\n        this.parent.setProperties({\n            'sheets': workbookModel.sheets,\n            'activeSheetTab': workbookModel.activeSheetTab,\n            'definedNames': workbookModel.definedNames || []\n        }, true);\n        this.parent.notify(sheetCreated, null);\n        this.parent.sheets.forEach(function (key) {\n            key.id = getMaxSheetId(_this.parent.sheets);\n        });\n        this.parent.notify(workbookFormulaOperation, { action: 'registerSheet' });\n        this.parent.notify(workbookFormulaOperation, { action: 'initiateDefinedNames' });\n    };\n    /**\n     * Adding event listener for workbook open.\n     */\n    WorkbookOpen.prototype.addEventListener = function () {\n        this.parent.on(workbookOpen, this.open.bind(this));\n    };\n    /**\n     * Removing event listener workbook open.\n     */\n    WorkbookOpen.prototype.removeEventListener = function () {\n        if (!this.parent.isDestroyed) {\n            this.parent.off(workbookOpen, this.open.bind(this));\n        }\n    };\n    /**\n     * To Remove the event listeners\n     */\n    WorkbookOpen.prototype.destroy = function () {\n        this.removeEventListener();\n        this.parent = null;\n    };\n    /**\n     * Get the workbook open module name.\n     */\n    WorkbookOpen.prototype.getModuleName = function () {\n        return 'workbookOpen';\n    };\n    return WorkbookOpen;\n}());\nexport { WorkbookOpen };\n","/**\n * @hidden\n * The `SaveWorker` module is used to perform save functionality with Web Worker.\n */\nvar SaveWorker = /** @class */ (function () {\n    /**\n     * Constructor for SaveWorker module in Workbook library.\n     * @private\n     */\n    function SaveWorker(parent) {\n        this.parent = parent;\n    }\n    /**\n     * Process sheet.\n     * @hidden\n     */\n    SaveWorker.prototype.processSheet = function (sheet, sheetIndex) {\n        var parsedSheet = JSON.parse(sheet, function (key, value) {\n            //Remove empty properties\n            if ((Array.isArray(value) || typeof value === 'string') && !value.length) {\n                return undefined;\n            }\n            return value;\n        });\n        return [sheetIndex, parsedSheet];\n    };\n    /**\n     * Process save action.\n     * @hidden\n     */\n    SaveWorker.prototype.processSave = function (saveJSON, saveSettings, customParams) {\n        var formData = new FormData();\n        var i;\n        var keys = Object.keys(saveSettings);\n        formData.append('JSONData', JSON.stringify(saveJSON));\n        for (i = 0; i < keys.length; i++) {\n            formData.append(keys[i], saveSettings[keys[i]]);\n        }\n        keys = Object.keys(customParams);\n        for (i = 0; i < keys.length; i++) {\n            formData.append(keys[i], customParams[keys[i]]);\n        }\n        fetch(saveSettings.url, { method: 'POST', body: formData })\n            .then(function (response) {\n            if (response.ok) {\n                return response.blob();\n            }\n            else {\n                return Promise.reject({\n                    message: response.statusText\n                });\n            }\n        })\n            .then(function (data) {\n            postMessage(data);\n        })\n            .catch(function (error) {\n            postMessage({ error: error.message });\n        });\n        // try {\n        //     let httpRequest: XMLHttpRequest = new XMLHttpRequest();\n        //     let formData: FormData = new FormData();\n        //     let i: number;\n        //     let keys: string[] = Object.keys(saveSettings);\n        //     httpRequest.onreadystatechange = (event: Event) => {\n        //         if (httpRequest.readyState === 4 && httpRequest.status === 200) {\n        //             (postMessage as Function)(httpRequest.response);\n        //         }\n        //     };\n        //     httpRequest.onerror = (event: Event) => {\n        //         (postMessage as Function)(event);\n        //     };\n        //     formData.append('JSONData', JSON.stringify(saveJSON));\n        //     for (i = 0; i < keys.length; i++) {\n        //         formData.append(keys[i], (<{ [key: string]: string }>saveSettings)[keys[i]]);\n        //     }\n        //     httpRequest.open('POST', saveSettings.saveUrl, false);\n        //     httpRequest.send(formData);\n        // } catch (e) {\n        //     (postMessage as Function)({ error: e.message });\n        // }\n    };\n    return SaveWorker;\n}());\nexport { SaveWorker };\n","var __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    }\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nimport { executeTaskAsync } from '../common/worker';\nimport * as events from '../common/event';\nimport { SaveWorker } from '../workers/save-worker';\nimport { detach } from '@syncfusion/ej2-base';\n/**\n * @hidden\n * The `WorkbookSave` module is used to handle the save action in Workbook library.\n */\nvar WorkbookSave = /** @class */ (function (_super) {\n    __extends(WorkbookSave, _super);\n    /**\n     * Constructor for WorkbookSave module in Workbook library.\n     * @private\n     */\n    function WorkbookSave(parent) {\n        var _this = _super.call(this, parent) || this;\n        _this.isProcessCompleted = false;\n        _this.saveJSON = {};\n        _this.isFullPost = false;\n        _this.needBlobData = false;\n        _this.customParams = null;\n        _this.addEventListener();\n        return _this;\n    }\n    /**\n     * Get the module name.\n     * @returns string\n     * @private\n     */\n    WorkbookSave.prototype.getModuleName = function () {\n        return 'workbookSave';\n    };\n    /**\n     * To destroy the WorkbookSave module.\n     * @return {void}\n     * @hidden\n     */\n    WorkbookSave.prototype.destroy = function () {\n        this.removeEventListener();\n        this.parent = null;\n    };\n    /**\n     * @hidden\n     */\n    WorkbookSave.prototype.addEventListener = function () {\n        this.parent.on(events.beginSave, this.initiateSave, this);\n    };\n    /**\n     * @hidden\n     */\n    WorkbookSave.prototype.removeEventListener = function () {\n        if (!this.parent.isDestroyed) {\n            this.parent.off(events.beginSave, this.initiateSave);\n        }\n    };\n    /**\n     * Initiate save process.\n     * @hidden\n     */\n    WorkbookSave.prototype.initiateSave = function (args) {\n        var saveSettings = args.saveSettings;\n        this.saveSettings = {\n            saveType: saveSettings.saveType,\n            url: saveSettings.url,\n            fileName: saveSettings.fileName || 'Sample'\n        };\n        this.isFullPost = args.isFullPost;\n        this.needBlobData = args.needBlobData;\n        if (this.needBlobData) {\n            this.isFullPost = false;\n        }\n        this.customParams = args.customParams;\n        this.updateBasicSettings();\n        this.processSheets();\n    };\n    /**\n     * Update save JSON with basic settings.\n     * @hidden\n     */\n    WorkbookSave.prototype.updateBasicSettings = function () {\n        var jsonStr = this.getStringifyObject(this.parent, ['sheets', '_isScalar', 'observers', 'closed', 'isStopped', 'hasError',\n            '__isAsync', 'beforeCellFormat', 'beforeCellRender', 'beforeDataBound', 'beforeOpen', 'beforeSave', 'beforeSelect',\n            'cellEdit', 'cellEditing', 'cellSave', 'contextMenuBeforeClose', 'contextMenuBeforeOpen', 'created', 'dataBound',\n            'fileItemSelect', 'fileMenuBeforeClose', 'fileMenuBeforeOpen', 'openFailure', 'saveComplete', 'select']);\n        var basicSettings = JSON.parse(jsonStr);\n        var sheetCount = this.parent.sheets.length;\n        var i = 0;\n        if (sheetCount) {\n            basicSettings.sheets = [];\n        }\n        this.saveJSON = basicSettings;\n    };\n    /**\n     * Process sheets properties.\n     * @hidden\n     */\n    WorkbookSave.prototype.processSheets = function () {\n        var i = 0;\n        var sheetCount = this.parent.sheets.length;\n        while (i < sheetCount) {\n            executeTaskAsync(this, this.processSheet, this.updateSheet, [this.getStringifyObject(this.parent.sheets[i]), i]);\n            i++;\n        }\n    };\n    /**\n     * Update processed sheet data.\n     * @hidden\n     */\n    WorkbookSave.prototype.updateSheet = function (data) {\n        this.saveJSON.sheets[data[0]] = data[1];\n        this.isProcessCompleted = this.getSheetLength(this.saveJSON.sheets) === this.parent.sheets.length;\n        if (this.isProcessCompleted) {\n            this.save(this.saveSettings);\n        }\n    };\n    WorkbookSave.prototype.getSheetLength = function (sheets) {\n        var len = 0;\n        sheets.forEach(function (sheet) {\n            if (sheet) {\n                len++;\n            }\n        });\n        return len;\n    };\n    /**\n     * Save process.\n     * @hidden\n     */\n    WorkbookSave.prototype.save = function (saveSettings) {\n        if (this.isFullPost) {\n            this.initiateFullPostSave();\n        }\n        else {\n            executeTaskAsync(this, { 'workerTask': this.processSave }, this.updateSaveResult, [this.saveJSON, saveSettings, this.customParams], true);\n        }\n        this.saveJSON = {};\n    };\n    /**\n     * Update final save data.\n     * @hidden\n     */\n    WorkbookSave.prototype.updateSaveResult = function (result) {\n        var args = {\n            status: 'Success',\n            message: '',\n            url: this.saveSettings.url,\n            fileName: this.saveSettings.fileName,\n            saveType: this.saveSettings.saveType,\n            blobData: null\n        };\n        if (typeof (result) === 'object' && result.error) {\n            args.status = 'Failure';\n            args.message = result.error.toString();\n        }\n        else {\n            if (this.needBlobData) {\n                args.blobData = result;\n            }\n            else {\n                this.ClientFileDownload(result, this.saveSettings.fileName);\n            }\n        }\n        this.parent.trigger('saveComplete', args);\n        this.parent.notify(events.saveCompleted, args);\n    };\n    WorkbookSave.prototype.ClientFileDownload = function (blobData, fileName) {\n        var anchor = this.parent.createElement('a', { attrs: { download: this.getFileNameWithExtension() } });\n        var url = URL.createObjectURL(blobData);\n        anchor.href = url;\n        document.body.appendChild(anchor);\n        anchor.click();\n        URL.revokeObjectURL(url);\n        document.body.removeChild(anchor);\n    };\n    WorkbookSave.prototype.initiateFullPostSave = function () {\n        var keys = Object.keys(this.saveSettings);\n        var i;\n        var formElem = this.parent.createElement('form', { attrs: { method: 'POST', action: this.saveSettings.url } });\n        var inputElem = this.parent.createElement('input', { attrs: { type: 'hidden', name: 'JSONData' } });\n        inputElem.value = JSON.stringify(this.saveJSON);\n        formElem.appendChild(inputElem);\n        for (i = 0; i < keys.length; i++) {\n            inputElem = this.parent.createElement('input', { attrs: { type: 'hidden', name: keys[i] } });\n            inputElem.value = this.saveSettings[keys[i]];\n            formElem.appendChild(inputElem);\n        }\n        keys = Object.keys(this.customParams);\n        for (i = 0; i < keys.length; i++) {\n            inputElem = this.parent.createElement('input', { attrs: { type: 'hidden', name: keys[i] } });\n            inputElem.value = this.customParams[keys[i]];\n            formElem.appendChild(inputElem);\n        }\n        document.body.appendChild(formElem);\n        formElem.submit();\n        detach(formElem);\n        this.parent.notify(events.saveCompleted, {});\n    };\n    /**\n     * Get stringified workbook object.\n     * @hidden\n     */\n    WorkbookSave.prototype.getStringifyObject = function (value, skipProp) {\n        if (skipProp === void 0) { skipProp = []; }\n        return JSON.stringify(value, function (key, value) {\n            if (skipProp.indexOf(key) > -1) {\n                return undefined;\n            }\n            else {\n                if (value && typeof value === 'object' && value.hasOwnProperty('properties')) {\n                    return value.properties;\n                }\n                else if (value !== null) {\n                    return value;\n                }\n                else {\n                    return undefined;\n                }\n            }\n        });\n    };\n    WorkbookSave.prototype.getFileNameWithExtension = function (filename) {\n        if (!filename) {\n            filename = this.saveSettings.fileName;\n        }\n        var fileExt = this.getFileExtension();\n        var idx = filename.lastIndexOf('.');\n        if (idx > -1) {\n            filename = filename.substr(0, idx);\n        }\n        return (filename + fileExt);\n    };\n    WorkbookSave.prototype.getFileExtension = function () {\n        return ('.' + this.saveSettings.saveType.toLowerCase());\n    };\n    return WorkbookSave;\n}(SaveWorker));\nexport { WorkbookSave };\n","/**\n * @hidden\n */\nexport var CommonErrors;\n(function (CommonErrors) {\n    CommonErrors[CommonErrors[\"na\"] = 0] = \"na\";\n    CommonErrors[CommonErrors[\"value\"] = 1] = \"value\";\n    CommonErrors[CommonErrors[\"ref\"] = 2] = \"ref\";\n    CommonErrors[CommonErrors[\"divzero\"] = 3] = \"divzero\";\n    CommonErrors[CommonErrors[\"num\"] = 4] = \"num\";\n    CommonErrors[CommonErrors[\"name\"] = 5] = \"name\";\n    CommonErrors[CommonErrors[\"null\"] = 6] = \"null\";\n})(CommonErrors || (CommonErrors = {}));\n/**\n * @hidden\n */\nexport var FormulasErrorsStrings;\n(function (FormulasErrorsStrings) {\n    FormulasErrorsStrings[FormulasErrorsStrings[\"operators_cannot_start_with_expression\"] = 0] = \"operators_cannot_start_with_expression\";\n    FormulasErrorsStrings[FormulasErrorsStrings[\"reservedWord_And\"] = 1] = \"reservedWord_And\";\n    FormulasErrorsStrings[FormulasErrorsStrings[\"reservedWord_Xor\"] = 2] = \"reservedWord_Xor\";\n    FormulasErrorsStrings[FormulasErrorsStrings[\"reservedWord_If\"] = 3] = \"reservedWord_If\";\n    FormulasErrorsStrings[FormulasErrorsStrings[\"number_contains_2_decimal_points\"] = 4] = \"number_contains_2_decimal_points\";\n    FormulasErrorsStrings[FormulasErrorsStrings[\"reservedWord_Else\"] = 5] = \"reservedWord_Else\";\n    FormulasErrorsStrings[FormulasErrorsStrings[\"reservedWord_Not\"] = 6] = \"reservedWord_Not\";\n    FormulasErrorsStrings[FormulasErrorsStrings[\"invalid_char_in_number\"] = 7] = \"invalid_char_in_number\";\n    FormulasErrorsStrings[FormulasErrorsStrings[\"invalid_characters_following_with_operator\"] = 6] = \"invalid_characters_following_with_operator\";\n    FormulasErrorsStrings[FormulasErrorsStrings[\"mismatched_parentheses\"] = 8] = \"mismatched_parentheses\";\n    FormulasErrorsStrings[FormulasErrorsStrings[\"unknown_formula_name\"] = 9] = \"unknown_formula_name\";\n    FormulasErrorsStrings[FormulasErrorsStrings[\"requires_a_single_argument\"] = 10] = \"requires_a_single_argument\";\n    FormulasErrorsStrings[FormulasErrorsStrings[\"requires_3_args\"] = 11] = \"requires_3_args\";\n    FormulasErrorsStrings[FormulasErrorsStrings[\"invalid_Math_argument\"] = 12] = \"invalid_Math_argument\";\n    FormulasErrorsStrings[FormulasErrorsStrings[\"requires_2_args\"] = 13] = \"requires_2_args\";\n    FormulasErrorsStrings[FormulasErrorsStrings[\"bad_index\"] = 14] = \"bad_index\";\n    FormulasErrorsStrings[FormulasErrorsStrings[\"too_complex\"] = 15] = \"too_complex\";\n    FormulasErrorsStrings[FormulasErrorsStrings[\"circular_reference\"] = 16] = \"circular_reference\";\n    FormulasErrorsStrings[FormulasErrorsStrings[\"missing_formula\"] = 17] = \"missing_formula\";\n    FormulasErrorsStrings[FormulasErrorsStrings[\"improper_formula\"] = 18] = \"improper_formula\";\n    FormulasErrorsStrings[FormulasErrorsStrings[\"invalid_expression\"] = 19] = \"invalid_expression\";\n    FormulasErrorsStrings[FormulasErrorsStrings[\"cell_empty\"] = 20] = \"cell_empty\";\n    FormulasErrorsStrings[FormulasErrorsStrings[\"bad_formula\"] = 21] = \"bad_formula\";\n    FormulasErrorsStrings[FormulasErrorsStrings[\"empty_expression\"] = 22] = \"empty_expression\";\n    FormulasErrorsStrings[FormulasErrorsStrings[\"virtual_mode_required\"] = 23] = \"virtual_mode_required\";\n    FormulasErrorsStrings[FormulasErrorsStrings[\"mismatched_tics\"] = 24] = \"mismatched_tics\";\n    FormulasErrorsStrings[FormulasErrorsStrings[\"wrong_number_arguments\"] = 25] = \"wrong_number_arguments\";\n    FormulasErrorsStrings[FormulasErrorsStrings[\"invalid_arguments\"] = 26] = \"invalid_arguments\";\n    FormulasErrorsStrings[FormulasErrorsStrings[\"iterations_do_not_converge\"] = 27] = \"iterations_do_not_converge\";\n    FormulasErrorsStrings[FormulasErrorsStrings[\"calculation_overflow\"] = 29] = \"calculation_overflow\";\n    FormulasErrorsStrings[FormulasErrorsStrings[\"already_registered\"] = 28] = \"already_registered\";\n    FormulasErrorsStrings[FormulasErrorsStrings[\"missing_sheet\"] = 30] = \"missing_sheet\";\n    FormulasErrorsStrings[FormulasErrorsStrings[\"cannot_parse\"] = 31] = \"cannot_parse\";\n    FormulasErrorsStrings[FormulasErrorsStrings[\"expression_cannot_end_with_an_operator\"] = 32] = \"expression_cannot_end_with_an_operator\";\n})(FormulasErrorsStrings || (FormulasErrorsStrings = {}));\n","import { FormulasErrorsStrings, CommonErrors } from '../common/index';\nimport { isNullOrUndefined, getValue } from '@syncfusion/ej2-base';\n/**\n * Represents the basic formulas module.\n */\nvar BasicFormulas = /** @class */ (function () {\n    function BasicFormulas(parent) {\n        this.formulas = [\n            { formulaName: 'SUM', category: 'Math & Trig', description: 'Sums individual values, cell references or ranges.' },\n            {\n                formulaName: 'SUMIFS', category: 'Math & Trig',\n                description: 'Sums the cells specified by a given set of conditionsor criteria.'\n            },\n            { formulaName: 'ABS', category: 'Math & Trig', description: 'Returns the absolute value of a number.' },\n            { formulaName: 'RAND', category: 'Math & Trig', description: 'Return a random number between 0 and 1.' },\n            { formulaName: 'FLOOR', category: 'Math & Trig', description: 'Returns the round a number down to the nearest integer.' },\n            { formulaName: 'CEILING', category: 'Math & Trig', description: 'Returns a number rounded up to a multiple of another number.' },\n            {\n                formulaName: 'SUMIF', category: 'Math & Trig',\n                description: 'It will sum up cells that meet the given criteria.'\n            },\n            {\n                formulaName: 'PRODUCT', category: 'Math & Trig',\n                description: 'Multiplies all the numbers given as arguments and returns the product.'\n            },\n            {\n                formulaName: 'AVERAGE', category: 'Statistical',\n                description: 'The sum of the numbers divided by how many numbers are being averaged.'\n            },\n            {\n                formulaName: 'AVERAGEIF', category: 'Statistical',\n                description: 'Computes the average of the numbers in a range that meet the supplied criteria.'\n            },\n            {\n                formulaName: 'COUNT', category: 'Statistical',\n                description: 'Counts the numbers in the list of arguments, exclude text entries.'\n            },\n            { formulaName: 'COUNTA', category: 'Statistical', description: 'Counts the non-empty values in the list of arguments.' },\n            {\n                formulaName: 'COUNTIF', category: 'Statistical',\n                description: 'Counts the number of cells in a range that meet a specified condition.'\n            },\n            {\n                formulaName: 'COUNTIFS', category: 'Statistical',\n                description: 'Counts the number of times each cells in all the ranges that meet the specific conditions.'\n            },\n            {\n                formulaName: 'AVERAGEA', category: 'Statistical',\n                description: 'Calculates the average of values in the list of arguments.Arguments can be numbers, names, arrays or references.'\n            },\n            {\n                formulaName: 'AVERAGEIFS', category: 'Statistical',\n                description: 'Conditionally returns the average of the contents of cells for the set of ranges.'\n            },\n            {\n                formulaName: 'MIN', category: 'Statistical',\n                description: 'Returns the smaller number in set of arguments.'\n            },\n            { formulaName: 'MAX', category: 'Statistical', description: 'Returns the largest number in set of arguments.' },\n            { formulaName: 'DATE', category: 'Date', description: 'Returns the date, given the year, month and day of the month.' },\n            { formulaName: 'DAY', category: 'Date', description: 'Returns the day of a given date.' },\n            { formulaName: 'DAYS', category: 'Date', description: 'Returns the number of days between two dates.' },\n            {\n                formulaName: 'IF', category: 'Logical',\n                description: 'Returns one value if a logical expression is TRUE and another if it is FALSE'\n            },\n            {\n                formulaName: 'AND', category: 'Logical',\n                description: 'Returns TRUE if all the arguments are considered TRUE, and FALSE otherwise.'\n            },\n            {\n                formulaName: 'IFS', category: 'Logical',\n                description: 'Checks multiple conditions and returns a value corresponding to the first TRUE result.'\n            },\n            {\n                formulaName: 'IFERROR', category: 'Logical',\n                description: 'Returns a value you specify if a formula evaluates to an error; otherwise, it returns the result of the formula.'\n            },\n            {\n                formulaName: 'CHOOSE', category: 'Lookup & Reference',\n                description: 'Returns a value from a list, given an index number.'\n            },\n            {\n                formulaName: 'INDEX', category: 'Lookup & Reference',\n                description: 'Returns a value from a table, given a row and column number.'\n            },\n            { formulaName: 'FIND', category: 'Text', description: 'Returns the position of a string of text within another string.' },\n            { formulaName: 'CONCATENATE', category: 'Text', description: ' Used to join two or more strings together.' },\n            { formulaName: 'CONCAT', category: 'Text', description: 'Concatenates a list or range of text strings.' },\n            { formulaName: 'SUBTOTAL', category: 'Lookup & Reference', description: 'Returns a subtotal in a list or database.' },\n            { formulaName: 'RADIANS', category: 'Math & Trig', description: 'Converts degrees to radians.' },\n            {\n                formulaName: 'OR', category: 'Logical',\n                description: 'Returns TRUE if any arguments considered TRUE, and all the arguments are FALSE it will return FALSE.'\n            },\n            {\n                formulaName: 'MATCH', category: 'Lookup & Reference',\n                description: 'Returns the relative position of an checked item in range that matches a specified value in a specified order'\n            }\n        ];\n        this.isConcat = false;\n        this.parent = parent;\n        this.init();\n    }\n    BasicFormulas.prototype.init = function () {\n        var fn;\n        for (var i = 0; i < this.formulas.length; i++) {\n            fn = getValue('Compute' + this.formulas[i].formulaName, this).bind(this);\n            this.addFormulaCollection(this.formulas[i].formulaName.toUpperCase(), fn, this.formulas[i].category, this.formulas[i].description);\n        }\n    };\n    BasicFormulas.prototype.addFormulaCollection = function (formulaName, functionName, formulaCategory, description) {\n        this.parent.libraryFormulas = {\n            fName: formulaName, handler: functionName, category: formulaCategory,\n            description: description\n        };\n    };\n    /** @hidden */\n    BasicFormulas.prototype.ComputeSUM = function () {\n        var args = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            args[_i] = arguments[_i];\n        }\n        if (isNullOrUndefined(args) || (args.length === 1 && args[0] === '')) {\n            return this.parent.formulaErrorStrings[FormulasErrorsStrings.invalid_arguments];\n        }\n        var sum = 0;\n        var val;\n        var orgValue;\n        if (!isNullOrUndefined(args)) {\n            var argArr = args;\n            for (var i = 0; i < argArr.length; i++) {\n                var argValue = argArr[i].toString();\n                if (argValue.indexOf(':') > -1 && this.parent.isCellReference(argValue)) {\n                    var cellCollection = this.parent.getCellCollection(argValue.split(this.parent.tic).join(''));\n                    for (var j = 0; j < cellCollection.length; j++) {\n                        val = this.parent.getValueFromArg(cellCollection[j]);\n                        if (this.parent.getErrorStrings().indexOf(val) > -1) {\n                            return val;\n                        }\n                        if (isNullOrUndefined(val[0]) || isNaN(this.parent.parseFloat(val))) {\n                            continue;\n                        }\n                        sum = sum + this.parent.parseFloat(val);\n                    }\n                }\n                else {\n                    if (argArr[i].split(this.parent.tic).join('') === this.parent.trueValue) {\n                        argArr[i] = '1';\n                    }\n                    if (argArr[i].split(this.parent.tic).join('') === this.parent.falseValue) {\n                        argArr[i] = '0';\n                    }\n                    orgValue = this.parent.getValueFromArg(argArr[i].split(this.parent.tic).join(''));\n                    if (this.parent.getErrorStrings().indexOf(orgValue) > -1) {\n                        return orgValue;\n                    }\n                    if (isNullOrUndefined(orgValue) || isNaN(this.parent.parseFloat(orgValue))) {\n                        continue;\n                    }\n                    if (orgValue.length > 0) {\n                        sum = sum + this.parent.parseFloat(orgValue + '');\n                    }\n                }\n            }\n        }\n        return sum;\n    };\n    /** @hidden */\n    BasicFormulas.prototype.ComputeCOUNT = function () {\n        var args = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            args[_i] = arguments[_i];\n        }\n        if (isNullOrUndefined(args) || (args.length === 1 && args[0] === '')) {\n            return this.parent.formulaErrorStrings[FormulasErrorsStrings.wrong_number_arguments];\n        }\n        var argArr = args;\n        var argVal;\n        var cellColl;\n        var result = 0;\n        var cellValue;\n        for (var i = 0; i < argArr.length; i++) {\n            argVal = argArr[i];\n            if (argVal.indexOf(':') > -1 && this.parent.isCellReference(argVal)) {\n                cellColl = this.parent.getCellCollection(argVal.split(this.parent.tic).join(''));\n                for (var j = 0; j < cellColl.length; j++) {\n                    cellValue = this.parent.getValueFromArg(cellColl[j]);\n                    if (!isNaN(this.parent.parseFloat(cellValue))) {\n                        if (argVal.length > 0 && argVal !== '' && argVal !== ' ') {\n                            result++;\n                        }\n                    }\n                }\n            }\n            else {\n                argVal = argVal.split(this.parent.tic).join('');\n                if (!isNaN(this.parent.parseFloat(this.parent.getValueFromArg(argVal)))) {\n                    if (argVal.length > 0 && argVal !== '' && argVal !== ' ') {\n                        result++;\n                    }\n                }\n            }\n        }\n        return result;\n    };\n    /** @hidden */\n    BasicFormulas.prototype.ComputeDATE = function () {\n        var args = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            args[_i] = arguments[_i];\n        }\n        if (isNullOrUndefined(args) || (args.length === 1 && args[0] === '')) {\n            return this.parent.formulaErrorStrings[FormulasErrorsStrings.wrong_number_arguments];\n        }\n        var argArr = args;\n        if (argArr.length !== 3) {\n            return this.parent.formulaErrorStrings[FormulasErrorsStrings.wrong_number_arguments];\n        }\n        for (var i = 0; i < argArr.length; ++i) {\n            argArr[i] = this.parent.getValueFromArg(argArr[i]);\n        }\n        /* tslint:disable */\n        argArr[0] = (argArr[0].split(this.parent.tic).join('') === 'TRUE') ? '1' : (argArr[0].split(this.parent.tic).join('') === 'FALSE') ? '0' : argArr[0];\n        argArr[1] = (argArr[1].split(this.parent.tic).join('') === 'TRUE') ? '1' : (argArr[1].split(this.parent.tic).join('') === 'FALSE') ? '0' : argArr[1];\n        argArr[2] = (argArr[2].split(this.parent.tic).join('') === 'TRUE') ? '1' : (argArr[2].split(this.parent.tic).join('') === 'FALSE') ? '0' : argArr[2];\n        /* tslint:enable */\n        var year = this.parent.parseFloat(argArr[0].split(this.parent.tic).join(''));\n        var month = this.parent.parseFloat(argArr[1].split(this.parent.tic).join(''));\n        var day = this.parent.parseFloat(argArr[2].split(this.parent.tic).join(''));\n        var days = 0;\n        if (!isNaN(year) && !isNaN(month) && !isNaN(day)) {\n            if (year < 0) {\n                return this.parent.getErrorStrings()[CommonErrors.num].toString();\n            }\n            while (month > 12) {\n                month -= 12;\n                year++;\n            }\n            days = this.parent.getSerialDateFromDate(year, month, day);\n        }\n        else {\n            return this.parent.getErrorStrings()[CommonErrors.value].toString();\n        }\n        if (days === 0) {\n            return this.parent.getErrorStrings()[CommonErrors.num].toString();\n        }\n        var date = this.parent.fromOADate(days);\n        if (date.toString() !== 'Invalid Date') {\n            /* tslint:disable-next-line */\n            return date.getFullYear() + '/' + this.parent.calculateDate((date.getMonth() + 1).toString()) + '/' + this.parent.calculateDate(date.getDate().toString());\n        }\n        return days.toString();\n    };\n    /** @hidden */\n    BasicFormulas.prototype.ComputeFLOOR = function () {\n        var args = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            args[_i] = arguments[_i];\n        }\n        if (isNullOrUndefined(args) || (args.length === 1 && args[0] === '')) {\n            return this.parent.formulaErrorStrings[FormulasErrorsStrings.invalid_arguments];\n        }\n        var argArr = args;\n        var argCount = argArr.length;\n        var splitArg = argArr[1].split(this.parent.tic).join('');\n        var argValue = [];\n        var fnum;\n        var significance;\n        if (argCount !== 2) {\n            return this.parent.formulaErrorStrings[FormulasErrorsStrings.wrong_number_arguments];\n        }\n        argValue.push(fnum = this.parent.parseFloat(this.parent.getValueFromArg(argArr[0].split(this.parent.tic).join(''))));\n        argArr[1] = (splitArg === this.parent.trueValue) ? '1' : (splitArg === this.parent.falseValue) ? '0' : argArr[1];\n        argValue.push(significance = this.parent.parseFloat(this.parent.getValueFromArg(argArr[1].split(this.parent.tic).join(''))));\n        if (fnum > 0 && significance < 0) {\n            return this.parent.getErrorStrings()[CommonErrors.num];\n        }\n        if (fnum > 0 && significance === 0) {\n            return this.parent.getErrorStrings()[CommonErrors.divzero];\n        }\n        for (var i = 0; i < argArr.length; i++) {\n            if (argArr[i].indexOf(this.parent.tic) > -1) {\n                return this.parent.getErrorStrings()[CommonErrors.value];\n            }\n        }\n        if (isNaN(fnum)) {\n            return this.parent.getErrorStrings()[CommonErrors.name];\n        }\n        return Math.floor(fnum / significance) * significance;\n    };\n    /** @hidden */\n    BasicFormulas.prototype.ComputeCEILING = function () {\n        var args = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            args[_i] = arguments[_i];\n        }\n        if (isNullOrUndefined(args) || (args.length === 1 && args[0] === '')) {\n            return this.parent.formulaErrorStrings[FormulasErrorsStrings.invalid_arguments];\n        }\n        var argArr = args;\n        var orgValue = [];\n        var argCount = argArr.length;\n        var splitArg = argArr[1].split(this.parent.tic).join('');\n        var cnum;\n        var significance;\n        if (argCount !== 2) {\n            return this.parent.formulaErrorStrings[FormulasErrorsStrings.wrong_number_arguments];\n        }\n        orgValue.push(cnum = this.parent.parseFloat(this.parent.getValueFromArg(argArr[0].split(this.parent.tic).join(''))));\n        argArr[1] = (splitArg === this.parent.trueValue) ? '1' : (splitArg === this.parent.falseValue) ? '0' : argArr[1];\n        orgValue.push(significance = this.parent.parseFloat(this.parent.getValueFromArg(argArr[1].split(this.parent.tic).join(''))));\n        if (cnum > 0 && significance < 0) {\n            return this.parent.getErrorStrings()[CommonErrors.num];\n        }\n        for (var i = 0; i < argArr.length; i++) {\n            if (argArr[i].indexOf(this.parent.tic) > -1) {\n                return this.parent.getErrorStrings()[CommonErrors.value];\n            }\n        }\n        if (isNaN(cnum)) {\n            return this.parent.getErrorStrings()[CommonErrors.name];\n        }\n        if (significance === 0) {\n            return 0;\n        }\n        return Math.ceil(cnum / significance) * significance;\n    };\n    /** @hidden */\n    BasicFormulas.prototype.ComputeDAY = function () {\n        var serialNumber = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            serialNumber[_i] = arguments[_i];\n        }\n        var date = serialNumber;\n        var result;\n        if (isNullOrUndefined(date) || (date.length === 1 && date[0] === '')) {\n            return this.parent.formulaErrorStrings[FormulasErrorsStrings.invalid_arguments];\n        }\n        if (date.length > 1) {\n            return this.parent.formulaErrorStrings[FormulasErrorsStrings.wrong_number_arguments];\n        }\n        var dateVal = this.parent.getValueFromArg(date[0].split(this.parent.tic).join(''));\n        if (!isNaN(this.parent.parseFloat(dateVal))) {\n            return this.parent.getErrorStrings()[CommonErrors.name];\n        }\n        else {\n            dateVal = dateVal;\n        }\n        result = this.parent.parseDate(dateVal);\n        if (Object.prototype.toString.call(result) === '[object Date]') {\n            /* tslint:disable-next-line */\n            result = result.getDate();\n        }\n        return result;\n    };\n    /** @hidden */\n    BasicFormulas.prototype.ComputeIF = function () {\n        var args = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            args[_i] = arguments[_i];\n        }\n        if (isNullOrUndefined(args) || (args.length === 1 && args[0] === '')) {\n            return this.parent.formulaErrorStrings[FormulasErrorsStrings.invalid_arguments];\n        }\n        if (this.parent.getErrorStrings().indexOf(args[0]) > 0) {\n            return args[0];\n        }\n        var argArr = args;\n        var condition;\n        var result;\n        if (argArr.length > 3 || argArr.length === 1) {\n            return this.parent.formulaErrorStrings[FormulasErrorsStrings.wrong_number_arguments];\n        }\n        else if (argArr.length <= 3) {\n            condition = this.parent.getValueFromArg(argArr[0]);\n            if (this.parent.getErrorStrings().indexOf(condition) > -1) {\n                return condition;\n            }\n            if (condition === this.parent.trueValue || this.parent.parseFloat(condition) > 0 || this.parent.parseFloat(condition) < 0) {\n                result = this.parent.getValueFromArg(argArr[1]);\n            }\n            else if (condition === this.parent.falseValue || this.parent.parseFloat(condition) === 0) {\n                if (isNullOrUndefined(argArr[2])) {\n                    return this.parent.falseValue;\n                }\n                result = this.parent.getValueFromArg(argArr[2]);\n            }\n            else {\n                return this.parent.formulaErrorStrings[FormulasErrorsStrings.requires_3_args];\n            }\n        }\n        if (result.indexOf(this.parent.tic) > -1) {\n            return result.split(this.parent.tic).join('');\n        }\n        else {\n            return result;\n        }\n    };\n    /** @hidden */\n    BasicFormulas.prototype.ComputeIFERROR = function () {\n        var args = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            args[_i] = arguments[_i];\n        }\n        if (isNullOrUndefined(args) || (args.length === 1 && args[0] === '')) {\n            return this.parent.formulaErrorStrings[FormulasErrorsStrings.invalid_arguments];\n        }\n        var argArr = args;\n        var condition;\n        if (argArr.length !== 2) {\n            return this.parent.formulaErrorStrings[FormulasErrorsStrings.wrong_number_arguments];\n        }\n        condition = this.parent.getValueFromArg(argArr[0]);\n        if (condition === this.parent.trueValue || condition === this.parent.falseValue) {\n            return condition;\n        }\n        if (condition[0] === this.parent.arithMarker) {\n            condition = condition.replace(this.parent.arithMarker, ' ');\n        }\n        condition = this.parent.getValueFromArg(condition).toUpperCase().split(this.parent.tic).join('');\n        if (condition[0] === '#' || condition.indexOf('Infinity') > -1 || this.parent.getErrorStrings().indexOf(condition) > -1) {\n            return this.parent.getValueFromArg(argArr[1]).split(this.parent.tic).join('');\n        }\n        else {\n            return condition;\n        }\n    };\n    /** @hidden */\n    BasicFormulas.prototype.ComputePRODUCT = function () {\n        var range = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            range[_i] = arguments[_i];\n        }\n        if (isNullOrUndefined(range) || (range.length === 1 && range[0] === '')) {\n            return this.parent.formulaErrorStrings[FormulasErrorsStrings.invalid_arguments];\n        }\n        var product = 1;\n        var val;\n        var orgValue;\n        var countNum = 0;\n        if (!isNullOrUndefined(range)) {\n            var argArr = range;\n            for (var i = 0; i < argArr.length; i++) {\n                var rangevalue = argArr[i];\n                if (rangevalue.indexOf(':') > -1 && this.parent.isCellReference(rangevalue)) {\n                    countNum = 0;\n                    var cellCollection = this.parent.getCellCollection(rangevalue);\n                    for (var j = 0; j < cellCollection.length; j++) {\n                        val = this.parent.getValueFromArg(cellCollection[j].split(this.parent.tic).join(''));\n                        if (this.parent.getErrorStrings().indexOf(val) > -1) {\n                            return val;\n                        }\n                        /* tslint:disable-next-line */\n                        val = (val.split(this.parent.tic).join('') === 'TRUE') ? '1' : (val.split(this.parent.tic).join('') === 'FALSE') ? '0' : val;\n                        if (isNullOrUndefined(val) || isNaN(this.parent.parseFloat(val))) {\n                            countNum = countNum + 1;\n                            if (countNum === cellCollection.length) {\n                                product = 0;\n                            }\n                            continue;\n                        }\n                        product = product * this.parent.parseFloat(val);\n                    }\n                }\n                else {\n                    orgValue = this.parent.getValueFromArg(argArr[i].split(this.parent.tic).join(''));\n                    if (this.parent.getErrorStrings().indexOf(orgValue) > -1) {\n                        return orgValue;\n                    }\n                    /* tslint:disable-next-line */\n                    orgValue = (orgValue.split(this.parent.tic).join('') === 'TRUE') ? '1' : (orgValue.split(this.parent.tic).join('') === 'FALSE') ? '0' : orgValue;\n                    if (isNullOrUndefined(orgValue) || isNaN(this.parent.parseFloat(orgValue))) {\n                        countNum = countNum + 1;\n                        if (countNum === argArr.length) {\n                            product = 0;\n                        }\n                        continue;\n                    }\n                    if (this.parent.getErrorStrings().indexOf(orgValue) > -1) {\n                        return orgValue;\n                    }\n                    if (orgValue.length > 0) {\n                        product = product * this.parent.parseFloat(orgValue + '');\n                    }\n                }\n            }\n        }\n        return product.toString();\n    };\n    /** @hidden */\n    BasicFormulas.prototype.ComputeDAYS = function () {\n        var range = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            range[_i] = arguments[_i];\n        }\n        var result;\n        if (isNullOrUndefined(range) && (range.length === 1 && range[0] === '')) {\n            return this.parent.formulaErrorStrings[FormulasErrorsStrings.invalid_arguments];\n        }\n        if (range.length !== 2) {\n            return this.parent.formulaErrorStrings[FormulasErrorsStrings.wrong_number_arguments];\n        }\n        var argsArr = range;\n        if (argsArr[0].split(this.parent.tic).join('') === this.parent.trueValue) {\n            argsArr[0] = '1';\n        }\n        if (argsArr[0].split(this.parent.tic).join('') === this.parent.falseValue) {\n            argsArr[0] = '0';\n        }\n        var endDate = this.parent.getValueFromArg(argsArr[0].split(this.parent.tic).join(''));\n        var startDate = this.parent.getValueFromArg(argsArr[1].split(this.parent.tic).join(''));\n        startDate = (startDate === '' || startDate == null) ? new Date(Date.parse('1899-12-31')).toDateString() : startDate;\n        endDate = (endDate === '' || endDate == null) ? new Date(Date.parse('1899-12-31')).toDateString() : endDate;\n        if (endDate[0] === '#') {\n            return endDate;\n        }\n        if (startDate[0] === '#') {\n            return startDate;\n        }\n        var d1 = this.parent.parseDate(endDate);\n        var d2 = this.parent.parseDate(startDate);\n        if (d1.toString()[0] === '#') {\n            return d1.toString();\n        }\n        if (d2.toString()[0] === '#') {\n            return d2.toString();\n        }\n        if (Object.prototype.toString.call(d1) === '[object Date]' && Object.prototype.toString.call(d2) === '[object Date]') {\n            /* tslint:disable-next-line */\n            result = Math.ceil(d1.getTime() - d2.getTime()) / (1000 * 3600 * 24);\n        }\n        else {\n            return this.parent.getErrorStrings()[CommonErrors.value];\n        }\n        return Math.round(result);\n    };\n    /** @hidden */\n    BasicFormulas.prototype.ComputeCHOOSE = function () {\n        var args = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            args[_i] = arguments[_i];\n        }\n        if (isNullOrUndefined(args) || (args.length === 1 && args[0] === '')) {\n            return this.parent.formulaErrorStrings[FormulasErrorsStrings.invalid_arguments];\n        }\n        if (args.length < 2) {\n            return this.parent.formulaErrorStrings[FormulasErrorsStrings.wrong_number_arguments];\n        }\n        var argsArr = args;\n        if (argsArr[0].indexOf(':') > -1 && this.parent.isCellReference(argsArr[0])) {\n            var cellCollection = this.parent.getCellCollection(argsArr[0]);\n            if (cellCollection.length === 1) {\n                argsArr[0] = cellCollection[0];\n            }\n            else {\n                return this.parent.getErrorStrings()[CommonErrors.value];\n            }\n        }\n        var cond = this.parent.getValueFromArg(argsArr[0]);\n        if (this.parent.getErrorStrings().indexOf(cond) > -1) {\n            return cond;\n        }\n        var indexNum = this.parent.parseFloat(this.parent.getValueFromArg(argsArr[0].split(this.parent.tic).join('')));\n        if (indexNum < 1) {\n            return this.parent.getErrorStrings()[CommonErrors.value];\n        }\n        indexNum = Math.floor(indexNum);\n        var result;\n        if (isNullOrUndefined(argsArr[indexNum])) {\n            return this.parent.getErrorStrings()[CommonErrors.value];\n        }\n        result = argsArr[indexNum];\n        if (result === '') {\n            result = '0';\n        }\n        if (result.indexOf(':') > -1 && this.parent.isCellReference(result)) {\n            var cellCollection = this.parent.getCellCollection(argsArr[0].split(this.parent.tic).join(''));\n            if (cellCollection.length === 1) {\n                argsArr[0] = cellCollection[0];\n            }\n            else {\n                return this.parent.getErrorStrings()[CommonErrors.value];\n            }\n        }\n        return this.parent.getValueFromArg(result).split(this.parent.tic).join('');\n    };\n    /** @hidden */\n    BasicFormulas.prototype.ComputeSUMIF = function () {\n        var range = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            range[_i] = arguments[_i];\n        }\n        var argArr = range;\n        if (argArr[0].indexOf(':') < 0 && !this.parent.isCellReference(argArr[0])) {\n            return this.parent.formulaErrorStrings[FormulasErrorsStrings.improper_formula];\n        }\n        var result = this.parent.computeSumIfAndAvgIf(range);\n        if (typeof result === 'string' && (this.parent.formulaErrorStrings.indexOf(result)\n            || this.parent.getErrorStrings().indexOf(result))) {\n            return result;\n        }\n        return result[0];\n    };\n    /** @hidden */\n    BasicFormulas.prototype.ComputeABS = function () {\n        var absValue = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            absValue[_i] = arguments[_i];\n        }\n        var argArr = absValue;\n        var cellvalue = '';\n        var absVal;\n        if (absValue.length === 0 || absValue.length > 1) {\n            return this.parent.formulaErrorStrings[FormulasErrorsStrings.wrong_number_arguments];\n        }\n        if (argArr[0].toString().split(this.parent.tic).join('').trim() === '' || argArr[0].indexOf(this.parent.tic) > -1) {\n            return this.parent.getErrorStrings()[CommonErrors.value];\n        }\n        if (this.parent.isCellReference(argArr[0])) {\n            cellvalue = this.parent.getValueFromArg(argArr[0]);\n            if (cellvalue === '') {\n                return this.parent.getErrorStrings()[CommonErrors.name];\n            }\n            absVal = this.parent.parseFloat(cellvalue);\n            if (isNaN(absVal)) {\n                return this.parent.getErrorStrings()[CommonErrors.value];\n            }\n        }\n        else {\n            absVal = this.parent.parseFloat(argArr[0]);\n            if (isNaN(absVal)) {\n                return this.parent.getErrorStrings()[CommonErrors.name];\n            }\n        }\n        return Math.abs(absVal);\n    };\n    /** @hidden */\n    BasicFormulas.prototype.ComputeAVERAGE = function () {\n        var args = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            args[_i] = arguments[_i];\n        }\n        if (isNullOrUndefined(args) || (args.length === 1 && args[0] === '')) {\n            return this.parent.formulaErrorStrings[FormulasErrorsStrings.invalid_arguments];\n        }\n        var argArr = args;\n        for (var i = 0; i < argArr.length; i++) {\n            if (argArr[i].indexOf(':') > -1) {\n                if (argArr[i].indexOf(this.parent.tic) > -1) {\n                    return this.parent.getErrorStrings()[CommonErrors.value];\n                }\n            }\n        }\n        return this.parent.calculateAvg(argArr);\n    };\n    /** @hidden */\n    BasicFormulas.prototype.ComputeAVERAGEIF = function () {\n        var range = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            range[_i] = arguments[_i];\n        }\n        var argList = range;\n        if (argList[0].indexOf(':') < 0 && !this.parent.isCellReference(argList[0])) {\n            return this.parent.formulaErrorStrings[FormulasErrorsStrings.improper_formula];\n        }\n        var resultVal = this.parent.computeSumIfAndAvgIf(range);\n        if (typeof resultVal === 'string' && (this.parent.formulaErrorStrings.indexOf(resultVal)\n            || this.parent.getErrorStrings().indexOf(resultVal))) {\n            return resultVal;\n        }\n        return this.parent.parseFloat(resultVal[0]) / this.parent.parseFloat(resultVal[1]);\n    };\n    /** @hidden */\n    BasicFormulas.prototype.ComputeCONCATENATE = function () {\n        var range = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            range[_i] = arguments[_i];\n        }\n        if (isNullOrUndefined(range) || (range.length === 1 && range[0] === '')) {\n            return this.parent.formulaErrorStrings[FormulasErrorsStrings.invalid_arguments];\n        }\n        var argsList = range;\n        var result = '';\n        var tempStr = '';\n        for (var i = 0; i < argsList.length; i++) {\n            if (argsList[i].indexOf(':') > -1 && this.parent.isCellReference(argsList[i])) {\n                if (this.isConcat) {\n                    var cells = this.parent.getCellCollection(argsList[i]);\n                    for (var i_1 = 0; i_1 < cells.length; i_1++) {\n                        tempStr = this.parent.getValueFromArg(cells[i_1]);\n                        result = result + tempStr;\n                    }\n                }\n                else {\n                    return this.parent.getErrorStrings()[CommonErrors.value];\n                }\n            }\n            else {\n                if (argsList.length === 1 && argsList[0].indexOf(this.parent.tic) < 0) {\n                    return this.parent.getErrorStrings()[CommonErrors.name];\n                }\n                else {\n                    tempStr = this.parent.getValueFromArg(argsList[i]);\n                    result = result + tempStr;\n                }\n            }\n            if (this.parent.getErrorStrings().indexOf(tempStr) > -1) {\n                return tempStr;\n            }\n        }\n        return result.split(this.parent.tic).join('');\n    };\n    /** @hidden */\n    BasicFormulas.prototype.ComputeCONCAT = function () {\n        var range = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            range[_i] = arguments[_i];\n        }\n        this.isConcat = true;\n        return this.ComputeCONCATENATE.apply(this, range);\n    };\n    /** @hidden */\n    BasicFormulas.prototype.ComputeMAX = function () {\n        var args = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            args[_i] = arguments[_i];\n        }\n        return this.parent.computeMinMax(args, 'max');\n    };\n    /** @hidden */\n    BasicFormulas.prototype.ComputeMIN = function () {\n        var args = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            args[_i] = arguments[_i];\n        }\n        return this.parent.computeMinMax(args, 'min');\n    };\n    /** @hidden */\n    BasicFormulas.prototype.ComputeRAND = function () {\n        var args = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            args[_i] = arguments[_i];\n        }\n        if (isNullOrUndefined(args) || (args.length === 1 && args[0] === '')) {\n            return this.parent.formulaErrorStrings[FormulasErrorsStrings.wrong_number_arguments];\n        }\n        return Math.random().toString();\n    };\n    /** @hidden */\n    BasicFormulas.prototype.ComputeAND = function () {\n        var args = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            args[_i] = arguments[_i];\n        }\n        return this.parent.computeAndOr(args, 'and');\n    };\n    /** @hidden */\n    BasicFormulas.prototype.ComputeOR = function () {\n        var args = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            args[_i] = arguments[_i];\n        }\n        return this.parent.computeAndOr(args, 'or');\n    };\n    /** @hidden */\n    BasicFormulas.prototype.ComputeFIND = function () {\n        var args = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            args[_i] = arguments[_i];\n        }\n        if (isNullOrUndefined(args) || (args.length === 1 && args[0] === '')) {\n            return this.parent.formulaErrorStrings[FormulasErrorsStrings.wrong_number_arguments];\n        }\n        var argsList = args;\n        if (argsList.length > 3) {\n            return this.parent.formulaErrorStrings[FormulasErrorsStrings.wrong_number_arguments];\n        }\n        var findText = this.parent.removeTics(this.parent.getValueFromArg(argsList[0]));\n        var withinText = this.parent.removeTics(this.parent.getValueFromArg(argsList[1]));\n        if (this.parent.getErrorStrings().indexOf(findText) > -1 || this.parent.getErrorStrings().indexOf(withinText) > -1) {\n            return this.parent.getErrorStrings()[CommonErrors.name];\n        }\n        var startNum = 1;\n        var loc;\n        if (argsList.length === 3) {\n            startNum = this.parent.removeTics(this.parent.getValueFromArg(argsList[2]));\n            if (this.parent.getErrorStrings().indexOf(startNum) > -1) {\n                return startNum;\n            }\n            startNum = this.parent.parseFloat(startNum);\n            if (isNaN(startNum)) {\n                startNum = 1;\n            }\n        }\n        if (startNum <= 0 || startNum > withinText.length) {\n            return this.parent.getErrorStrings()[CommonErrors.value];\n        }\n        loc = withinText.indexOf(findText, startNum - 1);\n        if (loc < 0) {\n            return this.parent.getErrorStrings()[CommonErrors.value];\n        }\n        return (Number(loc) + Number(1)).toString();\n    };\n    /** @hidden */\n    BasicFormulas.prototype.ComputeINDEX = function () {\n        var range = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            range[_i] = arguments[_i];\n        }\n        var argArr = range;\n        var argCount = argArr.length;\n        if (isNullOrUndefined(range) || (argArr.length === 1 && argArr[0] === '')) {\n            return this.parent.formulaErrorStrings[FormulasErrorsStrings.wrong_number_arguments];\n        }\n        if (argCount > 3) {\n            return this.parent.getErrorStrings()[CommonErrors.ref];\n        }\n        var rangeValue = '';\n        var rangeArr = [];\n        if (argCount > 2) {\n            for (var i_2 = 0; i_2 < argCount; i_2++) {\n                if (this.parent.isCellReference(argArr[i_2]) && argArr[i_2].indexOf(':') < 0) {\n                    return this.parent.getErrorStrings()[CommonErrors.ref];\n                }\n                if (this.parent.isCellReference(argArr[i_2])) {\n                    rangeArr[i_2] = argArr[i_2];\n                }\n            }\n        }\n        rangeValue = argArr[0];\n        argArr[1] = argArr[1] === '' ? '1' : argArr[1];\n        argArr[1] = this.parent.getValueFromArg(argArr[1]);\n        if (this.parent.getErrorStrings().indexOf(argArr[1]) > -1) {\n            return argArr[1];\n        }\n        if (!isNullOrUndefined(argArr[2])) {\n            argArr[2] = argArr[2] === '' ? '1' : argArr[2];\n            argArr[2] = this.parent.getValueFromArg(argArr[2]);\n            if (this.parent.getErrorStrings().indexOf(argArr[2]) > -1) {\n                return argArr[2];\n            }\n            if (argArr[2] === '0') {\n                return this.parent.getErrorStrings()[CommonErrors.value];\n            }\n        }\n        var row = parseFloat(argArr[1]);\n        row = !isNaN(row) ? row : -1;\n        var col = parseFloat(argArr[2] ? argArr[2] : '1');\n        col = !isNaN(col) ? col : -1;\n        if (row === -1 || col === -1) {\n            return this.parent.getErrorStrings()[CommonErrors.value];\n        }\n        var i = argArr[0].indexOf(':');\n        var startRow = this.parent.rowIndex(rangeValue.substring(0, i));\n        var endRow = this.parent.rowIndex(rangeValue.substring(i + 1));\n        var startCol = this.parent.colIndex(rangeValue.substring(0, i));\n        var endCol = this.parent.colIndex(rangeValue.substring(i + 1));\n        if (row > endRow - startRow + 1 || col > endCol - startCol + 1) {\n            return this.parent.getErrorStrings()[CommonErrors.ref];\n        }\n        row = startRow + row - 1;\n        col = startCol + col - 1;\n        var cellRef = '' + this.parent.convertAlpha(col) + row;\n        var result = this.parent.getValueFromArg(cellRef);\n        if (result === '') {\n            return 0;\n        }\n        return result;\n    };\n    /** @hidden */\n    BasicFormulas.prototype.ComputeIFS = function () {\n        var range = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            range[_i] = arguments[_i];\n        }\n        var argArr = range;\n        if (isNullOrUndefined(range) || (argArr.length === 1 && argArr[0] === '')) {\n            return this.parent.formulaErrorStrings[FormulasErrorsStrings.wrong_number_arguments];\n        }\n        var condition = '';\n        var result = '';\n        for (var i = 0; i < argArr.length; i++) {\n            condition = this.parent.getValueFromArg(argArr[i]);\n            if (condition !== this.parent.trueValue && condition !== this.parent.falseValue) {\n                return this.parent.getErrorStrings()[CommonErrors.value];\n            }\n            if (condition === this.parent.trueValue) {\n                if (argArr[i + 1].indexOf(this.parent.arithMarker) > -1) {\n                    return this.parent.trueValue;\n                }\n                if (this.parent.isCellReference(argArr[i + 1].split(this.parent.tic).join(''))) {\n                    result = this.parent.getValueFromArg(argArr[i + 1]);\n                }\n                else {\n                    result = (argArr[i + 1].indexOf(this.parent.tic) > -1) ? argArr[i + 1].split(this.parent.tic).join('') :\n                        this.parent.getErrorStrings()[CommonErrors.name];\n                }\n                i = i + 1;\n                return result;\n            }\n            else if (condition === this.parent.falseValue) {\n                i = i + 1;\n            }\n        }\n        return this.parent.getErrorStrings()[CommonErrors.na];\n    };\n    /** @hidden */\n    BasicFormulas.prototype.ComputeCOUNTA = function () {\n        var args = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            args[_i] = arguments[_i];\n        }\n        if (isNullOrUndefined(args) || (args.length === 1 && args[0] === '')) {\n            return this.parent.formulaErrorStrings[FormulasErrorsStrings.wrong_number_arguments];\n        }\n        var argArr = args;\n        var cellColl;\n        var result = 0;\n        var cellValue;\n        for (var i = 0; i < argArr.length; i++) {\n            if (argArr[i].indexOf(':') > -1 && this.parent.isCellReference(argArr[i])) {\n                cellColl = this.parent.getCellCollection(argArr[i].split(this.parent.tic).join(''));\n                for (var j = 0; j < cellColl.length; j++) {\n                    cellValue = this.parent.getValueFromArg(cellColl[j]);\n                    if (cellValue.length > 0) {\n                        result++;\n                    }\n                }\n            }\n            else {\n                var cellValue_1 = this.parent.getValueFromArg(argArr[i].split(this.parent.tic).join(''));\n                if (cellValue_1.length > 0) {\n                    result++;\n                }\n            }\n        }\n        return result;\n    };\n    /** @hidden */\n    BasicFormulas.prototype.ComputeAVERAGEA = function () {\n        var args = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            args[_i] = arguments[_i];\n        }\n        if (isNullOrUndefined(args) || (args.length === 1 && args[0] === '')) {\n            return this.parent.formulaErrorStrings[FormulasErrorsStrings.wrong_number_arguments];\n        }\n        var argArrs = args;\n        var cellCol;\n        var result = 0;\n        var cellVal;\n        var length = 0;\n        for (var k = 0; k < argArrs.length; k++) {\n            if (argArrs[k].indexOf(':') > -1 && this.parent.isCellReference(argArrs[k])) {\n                cellCol = this.parent.getCellCollection(argArrs[k].split(this.parent.tic).join(''));\n                for (var j = 0; j < cellCol.length; j++) {\n                    cellVal = this.parent.getValueFromArg(cellCol[j]);\n                    if (cellVal.toUpperCase() === this.parent.trueValue) {\n                        cellVal = '1';\n                    }\n                    else if (cellVal.toUpperCase() === this.parent.falseValue || cellVal === '') {\n                        cellVal = '0';\n                    }\n                    else if (isNaN(parseFloat(cellVal))) {\n                        return this.parent.getErrorStrings()[CommonErrors.name];\n                    }\n                    if (cellVal.length > 0) {\n                        result = result + parseFloat(cellVal);\n                    }\n                }\n                length = cellCol.length;\n            }\n            else {\n                if (argArrs[k] === this.parent.trueValue) {\n                    argArrs[k] = '1';\n                }\n                if (argArrs[k] === this.parent.falseValue || argArrs[k] === '') {\n                    argArrs[k] = '0';\n                }\n                var cellValue = this.parent.getValueFromArg(argArrs[k].split(this.parent.tic).join(''));\n                if (argArrs[k].indexOf(this.parent.tic) > -1) {\n                    if (isNaN(parseFloat(argArrs[k].split(this.parent.tic).join('')))) {\n                        return this.parent.getErrorStrings()[CommonErrors.value];\n                    }\n                    if (isNaN(parseFloat(cellValue))) {\n                        return this.parent.getErrorStrings()[CommonErrors.name];\n                    }\n                    if (cellValue.length > 0) {\n                        result = result + parseFloat(cellValue);\n                    }\n                    length = length + 1;\n                }\n            }\n        }\n        return result / length;\n    };\n    /** @hidden */\n    BasicFormulas.prototype.ComputeCOUNTIF = function () {\n        var args = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            args[_i] = arguments[_i];\n        }\n        var argArr = args;\n        if (isNullOrUndefined(args) || args[0] === '' || argArr.length < 2) {\n            return this.parent.formulaErrorStrings[FormulasErrorsStrings.wrong_number_arguments];\n        }\n        var cellColl;\n        var result = 0;\n        var cellValue;\n        var stack = [];\n        var op = 'equal';\n        var condition = argArr[1].split(this.parent.tic).join('');\n        if (condition.startsWith('<=')) {\n            op = 'lessEq';\n            condition = condition.substring(2);\n        }\n        else if (condition.startsWith('>=')) {\n            op = 'greaterEq';\n            condition = condition.substring(2);\n        }\n        else if (condition.startsWith('<>')) {\n            op = 'notEq';\n            condition = condition.substring(2);\n        }\n        else if (condition.startsWith('<')) {\n            op = 'less';\n            condition = condition.substring(1);\n        }\n        else if (condition.startsWith('>')) {\n            op = 'greater';\n            condition = condition.substring(1);\n        }\n        else if (condition.startsWith('=')) {\n            op = 'equal';\n            condition = condition.substring(1);\n        }\n        if (argArr[0].indexOf(':') > -1 && this.parent.isCellReference(argArr[0])) {\n            cellColl = this.parent.getCellCollection(argArr[0].split(this.parent.tic).join(''));\n            for (var j = 0; j < cellColl.length; j++) {\n                cellValue = this.parent.getValueFromArg(cellColl[j]);\n                if (condition.indexOf('*') > -1 || condition.indexOf('?') > -1) {\n                    cellValue = this.parent.findWildCardValue(condition, cellValue);\n                }\n                stack.push(cellValue);\n                stack.push(condition);\n                if (this.parent.processLogical(stack, op) === this.parent.trueValue) {\n                    result++;\n                }\n            }\n        }\n        return result;\n    };\n    /** @hidden */\n    BasicFormulas.prototype.ComputeSUMIFS = function () {\n        var range = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            range[_i] = arguments[_i];\n        }\n        var sum;\n        sum = this.parent.computeIfsFormulas(range, this.parent.falseValue);\n        return sum;\n    };\n    /** @hidden */\n    BasicFormulas.prototype.ComputeCOUNTIFS = function () {\n        var args = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            args[_i] = arguments[_i];\n        }\n        var sum;\n        sum = this.parent.computeIfsFormulas(args, this.parent.trueValue);\n        return sum;\n    };\n    /** @hidden */\n    BasicFormulas.prototype.ComputeAVERAGEIFS = function () {\n        var args = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            args[_i] = arguments[_i];\n        }\n        var sum;\n        sum = this.parent.computeIfsFormulas(args, this.parent.falseValue, this.parent.trueValue);\n        return sum;\n    };\n    /** @hidden */\n    BasicFormulas.prototype.ComputeMATCH = function () {\n        var args = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            args[_i] = arguments[_i];\n        }\n        var argArr = args;\n        if (isNullOrUndefined(argArr) || (argArr.length === 1 && argArr[0] === '') || argArr.length < 2 || argArr.length > 3) {\n            return this.parent.formulaErrorStrings[FormulasErrorsStrings.wrong_number_arguments];\n        }\n        var cellColl;\n        var cellValue = [];\n        var lookupVal = argArr[0].split(this.parent.tic).join('');\n        argArr[2] = isNullOrUndefined(argArr[2]) ? '1' : argArr[2].split(this.parent.tic).join('');\n        if (argArr[2].split(this.parent.tic).join('') === this.parent.trueValue) {\n            argArr[2] = '1';\n        }\n        if (argArr[2].split(this.parent.tic).join('') === this.parent.falseValue) {\n            argArr[2] = '0';\n        }\n        var matchType = parseFloat(argArr[2]);\n        if (matchType !== -1 && matchType !== 0 && matchType !== 1) {\n            return this.parent.getErrorStrings()[CommonErrors.na];\n        }\n        var index = 0;\n        var indexVal = '';\n        if (argArr[1].indexOf(':') > -1 || this.parent.isCellReference(argArr[1])) {\n            cellColl = this.parent.getCellCollection(argArr[1].split(this.parent.tic).join(''));\n            for (var j = 0; j < cellColl.length; j++) {\n                cellValue[j] = this.parent.getValueFromArg(cellColl[j]).split(this.parent.tic).join('');\n            }\n            for (var i = 0; i < cellValue.length; i++) {\n                if (matchType === 1) {\n                    if (lookupVal === cellValue[i]) {\n                        return i + 1;\n                    }\n                    else if (lookupVal > cellValue[i]) {\n                        if (!indexVal) {\n                            index = i + 1;\n                            indexVal = cellValue[i];\n                        }\n                        else if (cellValue[i] > indexVal) {\n                            index = i + 1;\n                            indexVal = cellValue[i];\n                        }\n                    }\n                }\n                else if (matchType === 0) {\n                    if (lookupVal.indexOf('*') > -1 || lookupVal.indexOf('?') > -1) {\n                        cellValue[i] = this.parent.findWildCardValue(lookupVal, cellValue[i]);\n                    }\n                    if (lookupVal === cellValue[i]) {\n                        return i + 1;\n                    }\n                    if (this.parent.parseFloat(lookupVal) === this.parent.parseFloat(cellValue[i])) {\n                        return i + 1;\n                    }\n                }\n                else if (matchType === -1) {\n                    if (lookupVal === cellValue[i]) {\n                        return i + 1;\n                    }\n                    else if (lookupVal < cellValue[i]) {\n                        if (!indexVal) {\n                            index = i + 1;\n                            indexVal = cellValue[i];\n                        }\n                        else if (cellValue[i] < indexVal) {\n                            index = i + 1;\n                            indexVal = cellValue[i];\n                        }\n                    }\n                }\n            }\n        }\n        return index ? index : this.parent.getErrorStrings()[CommonErrors.na];\n    };\n    /** @hidden */\n    BasicFormulas.prototype.ComputeLOOKUP = function () {\n        var range = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            range[_i] = arguments[_i];\n        }\n        var argArr = range;\n        var result = '';\n        if (isNullOrUndefined(argArr) || (argArr.length === 1 && argArr[0] === '') || argArr.length < 2 || argArr.length > 3) {\n            return this.parent.formulaErrorStrings[FormulasErrorsStrings.wrong_number_arguments];\n        }\n        result = this.parent.computeLookup(argArr);\n        return result;\n    };\n    /** @hidden */\n    BasicFormulas.prototype.ComputeVLOOKUP = function () {\n        var range = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            range[_i] = arguments[_i];\n        }\n        var argArr = range;\n        var result = '';\n        if (isNullOrUndefined(argArr) || (argArr.length === 1 && argArr[0] === '') || argArr.length < 3 || argArr.length > 4) {\n            return this.parent.formulaErrorStrings[FormulasErrorsStrings.wrong_number_arguments];\n        }\n        result = this.parent.computeVLookup(argArr);\n        return result;\n    };\n    /** @hidden */\n    BasicFormulas.prototype.ComputeSUBTOTAL = function () {\n        var range = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            range[_i] = arguments[_i];\n        }\n        var argArr = range;\n        var result = '';\n        if (argArr.length < 2) {\n            return this.parent.formulaErrorStrings[FormulasErrorsStrings.wrong_number_arguments];\n        }\n        var formula = this.parent.parseFloat(this.parent.getValueFromArg(argArr[0].split(this.parent.tic).join('')));\n        if (isNaN(formula)) {\n            this.parent.getErrorStrings()[CommonErrors.value];\n        }\n        if ((formula < 1 || formula > 11) && (formula < 101 || formula > 111)) {\n            this.parent.getErrorStrings()[CommonErrors.value];\n        }\n        var cellRef = argArr.slice(1, argArr.length);\n        switch (formula) {\n            case 1:\n            case 101:\n                result = this.ComputeAVERAGE.apply(this, cellRef);\n                break;\n            case 2:\n            case 102:\n                result = this.ComputeCOUNT.apply(this, cellRef);\n                break;\n            case 3:\n            case 103:\n                result = this.ComputeCOUNTA.apply(this, cellRef);\n                break;\n            case 4:\n            case 104:\n                result = this.ComputeMAX.apply(this, cellRef);\n                break;\n            case 5:\n            case 105:\n                result = this.ComputeMIN.apply(this, cellRef);\n                break;\n            case 6:\n            case 106:\n                result = this.ComputePRODUCT.apply(this, cellRef);\n                break;\n            case 7:\n            case 107:\n                result = this.ComputeDAY.apply(this, cellRef);\n                break;\n            case 8:\n            case 108:\n                result = this.ComputeCONCAT.apply(this, cellRef);\n                break;\n            case 9:\n            case 109:\n                result = this.ComputeSUM.apply(this, cellRef);\n                break;\n            case 10:\n            case 110:\n                result = this.ComputeAVERAGEA.apply(this, cellRef);\n                break;\n            case 11:\n            case 111:\n                result = this.ComputeABS.apply(this, cellRef);\n                break;\n            default:\n                result = this.parent.getErrorStrings()[CommonErrors.value];\n                break;\n        }\n        return result;\n    };\n    /** @hidden */\n    BasicFormulas.prototype.ComputeRADIANS = function () {\n        var range = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            range[_i] = arguments[_i];\n        }\n        var argArr = range;\n        var result;\n        if (argArr[0] === '' || argArr.length > 1) {\n            return this.parent.formulaErrorStrings[FormulasErrorsStrings.wrong_number_arguments];\n        }\n        if (argArr[0].indexOf(':') > -1 || argArr[0].split(this.parent.tic).join('') === '') {\n            return this.parent.getErrorStrings()[CommonErrors.value];\n        }\n        var val = argArr[0].split(this.parent.tic).join('');\n        argArr[0] = isNaN(this.parent.parseFloat(val)) ? argArr[0] : val;\n        var cellvalue = this.parent.getValueFromArg(argArr[0]);\n        var radVal = this.parent.parseFloat(cellvalue);\n        if (!isNaN(radVal)) {\n            result = Math.PI * (radVal) / 180;\n        }\n        else {\n            if (cellvalue.indexOf(this.parent.tic) > -1) {\n                return this.parent.getErrorStrings()[CommonErrors.value];\n            }\n            else {\n                return this.parent.getErrorStrings()[CommonErrors.name];\n            }\n        }\n        return result;\n    };\n    BasicFormulas.prototype.getModuleName = function () {\n        return 'basic-formulas';\n    };\n    return BasicFormulas;\n}());\nexport { BasicFormulas };\n","import { FormulaError } from './index';\nimport { CommonErrors, FormulasErrorsStrings } from '../common/index';\nimport { isNullOrUndefined } from '@syncfusion/ej2-base';\nvar Parser = /** @class */ (function () {\n    function Parser(parent) {\n        this.emptyStr = '';\n        this.storedStringText = this.emptyStr;\n        this.sheetToken = '!';\n        /** @hidden */\n        this.tokenAdd = 'a';\n        /** @hidden */\n        this.tokenSubtract = 's';\n        /** @hidden */\n        this.tokenMultiply = 'm';\n        /** @hidden */\n        this.tokenDivide = 'd';\n        /** @hidden */\n        this.tokenLess = 'l';\n        this.charEm = 'r';\n        this.charEp = 'x';\n        /** @hidden */\n        this.tokenGreater = 'g';\n        /** @hidden */\n        this.tokenEqual = 'e';\n        /** @hidden */\n        this.tokenLessEq = 'k';\n        /** @hidden */\n        this.tokenGreaterEq = 'j';\n        /** @hidden */\n        this.tokenNotEqual = 'o';\n        /** @hidden */\n        this.tokenAnd = 'c';\n        this.tokenEm = 'v';\n        this.tokenEp = 't';\n        /** @hidden */\n        this.tokenOr = String.fromCharCode(126);\n        this.charAnd = 'i';\n        this.charLess = '<';\n        this.charGreater = '>';\n        this.charEqual = '=';\n        this.charLessEq = 'f';\n        this.charGreaterEq = 'h';\n        this.charNoEqual = 'z';\n        this.stringGreaterEq = '>=';\n        this.stringLessEq = '<=';\n        this.stringNoEqual = '<>';\n        this.stringAnd = '&';\n        this.stringOr = '^';\n        this.charOr = 'w';\n        this.charAdd = '+';\n        this.charSubtract = '-';\n        this.charMultiply = '*';\n        this.charDivide = '/';\n        this.fixedReference = '$';\n        this.spaceString = ' ';\n        this.ignoreBracet = false;\n        /** @hidden */\n        this.isError = false;\n        /** @hidden */\n        this.isFormulaParsed = false;\n        this.findNamedRange = false;\n        this.stringsColl = new Map();\n        this.tokens = [\n            this.tokenAdd, this.tokenSubtract, this.tokenMultiply, this.tokenDivide, this.tokenLess,\n            this.tokenGreater, this.tokenEqual, this.tokenLessEq, this.tokenGreaterEq, this.tokenNotEqual, this.tokenAnd, this.tokenOr\n        ];\n        this.charNOTop = String.fromCharCode(167);\n        this.specialSym = ['~', '@', '#', '?', '%'];\n        this.isFailureTriggered = false;\n        this.parent = parent;\n    }\n    /** @hidden */\n    Parser.prototype.parse = function (text, fkey) {\n        if (this.parent.isTextEmpty(text)) {\n            return text;\n        }\n        if (this.parent.getFormulaCharacter() !== String.fromCharCode(0) && this.parent.getFormulaCharacter() === text[0]) {\n            text = text.substring(1);\n        }\n        if (this.parent.namedRanges.size > 0 || this.parent.storedData.size > 0) {\n            text = this.checkForNamedRangeAndKeyValue(text);\n            this.findNamedRange = false;\n        }\n        text = text.split('-+').join('-');\n        text = text.split('--').join('+');\n        text = text.split('+-').join('-');\n        text = text.split('-' + '(' + '-').join('(');\n        var formulaString = this.storeStrings(text);\n        text = this.storedStringText;\n        var i = 0;\n        if (isNullOrUndefined(formulaString)) {\n            text = text.split(' ').join('');\n        }\n        text = text.split('=>').join('>=');\n        text = text.split('=<').join('<=');\n        if (text[text.length - 1] !== this.parent.arithMarker || this.indexOfAny(text, this.tokens) !== (text.length - 2)) {\n            text = text.toUpperCase();\n        }\n        if (text.indexOf(this.sheetToken) > -1) {\n            var family = this.parent.getSheetFamilyItem(this.parent.grid);\n            if (family.sheetNameToParentObject != null && family.sheetNameToParentObject.size > 0) {\n                if (text[0] !== this.sheetToken.toString()) {\n                    text = this.parent.setTokensForSheets(text);\n                }\n                var sheetToken = this.parent.getSheetToken(text.split(this.parent.tic).join(this.emptyStr));\n                var scopedRange = this.checkScopedRange(text.split('\"').join(this.emptyStr).split(this.sheetToken).join(''));\n                if (isNullOrUndefined(sheetToken) && sheetToken !== '' && this.parent.namedRanges.size > 0 && scopedRange !== '') {\n                    text = scopedRange;\n                }\n            }\n        }\n        text = this.markLibraryFormulas(text);\n        try {\n            text = this.formulaAutoCorrection(text);\n        }\n        catch (ex) {\n            var args = {\n                message: ex.message, exception: ex, isForceCalculable: ex.formulaCorrection,\n                computeForceCalculate: false\n            };\n            if (!args.isForceCalculable) {\n                throw this.parent.formulaErrorStrings[FormulasErrorsStrings.invalid_expression];\n            }\n            if (!this.isFailureTriggered) {\n                this.parent.trigger('onFailure', args);\n                this.isFailureTriggered = true;\n            }\n            if (args.isForceCalculable && args.computeForceCalculate) {\n                text = this.formulaAutoCorrection(text, args);\n                this.parent.storedData.get(fkey).formulaText = '=' + text;\n            }\n            else {\n                throw this.parent.formulaErrorStrings[FormulasErrorsStrings.invalid_expression];\n            }\n        }\n        if (!this.ignoreBracet) {\n            i = text.indexOf(')');\n            while (i > -1) {\n                var k = text.substring(0, i).lastIndexOf('(');\n                if (k === -1) {\n                    throw new FormulaError(this.parent.formulaErrorStrings[FormulasErrorsStrings.mismatched_parentheses]);\n                }\n                if (k === i - 1) {\n                    throw new FormulaError(this.parent.formulaErrorStrings[FormulasErrorsStrings.empty_expression]);\n                }\n                var s = this.emptyStr;\n                if (this.ignoreBracet) {\n                    s = this.parent.substring(text, k, i - k + 1);\n                }\n                else {\n                    s = this.parent.substring(text, k + 1, i - k - 1);\n                }\n                try {\n                    text = text.substring(0, k) + this.parseSimple(s) + text.substring(i + 1);\n                }\n                catch (ex) {\n                    var args = this.exceptionArgs(ex);\n                    if (!this.isFailureTriggered) {\n                        this.parent.trigger('onFailure', args);\n                        this.isFailureTriggered = true;\n                    }\n                    var errorMessage = (typeof args.exception === 'string') ? args.exception : args.message;\n                    return (this.parent.getErrorLine(ex) ? '' : '#' + this.parent.getErrorLine(ex) + ': ') + errorMessage;\n                }\n                i = text.indexOf(')');\n            }\n        }\n        if (!this.ignoreBracet && text.indexOf('(') > -1) {\n            throw new FormulaError(this.parent.formulaErrorStrings[FormulasErrorsStrings.mismatched_parentheses]);\n        }\n        text = this.parseSimple(text);\n        if (formulaString !== null && formulaString.size > 0) {\n            text = this.setStrings(text, formulaString);\n        }\n        return text;\n    };\n    /* tslint:disable-next-line:no-any */\n    Parser.prototype.exceptionArgs = function (ex) {\n        return {\n            message: ex.message, exception: ex, isForceCalculable: ex.formulaCorrection,\n            computeForceCalculate: false\n        };\n    };\n    Parser.prototype.formulaAutoCorrection = function (formula, args) {\n        var arithemeticArr = ['*', '+', '-', '/', '^', '&'];\n        var logicalSym = ['>', '=', '<'];\n        var i = 0;\n        var form = '';\n        var op = '';\n        var firstOp = '';\n        var secondprevOp = '';\n        var secondnextOp = '';\n        var firstDigit = '';\n        var secondDigit = '';\n        var countDigit = 0;\n        if (this.parent.formulaErrorStrings.indexOf(formula) > -1) {\n            return formula;\n        }\n        else {\n            if (this.indexOfAny(formula, this.specialSym) > -1) {\n                throw new FormulaError(this.parent.formulaErrorStrings[FormulasErrorsStrings.invalid_expression], false);\n            }\n            while (i < formula.length) {\n                if ((formula.indexOf('&') > -1) || (this.parent.isDigit(formula[i]) && ((formula.length > i + 1)\n                    && (this.indexOfAny(formula[i + 1], arithemeticArr) > -1)) && ((formula.length > i + 2)\n                    && (!isNullOrUndefined(formula[i + 2]) && this.indexOfAny(formula[i + 2], arithemeticArr) > -1)))) {\n                    if (isNullOrUndefined(args)) {\n                        throw new FormulaError(this.parent.formulaErrorStrings[FormulasErrorsStrings.invalid_expression], true);\n                    }\n                    if (args.computeForceCalculate) {\n                        if (this.parent.isDigit(formula[i])) {\n                            if (countDigit < 1) {\n                                firstDigit = formula[i];\n                                firstOp = formula[i + 1];\n                                if (isNullOrUndefined(firstOp)) {\n                                    firstOp = this.emptyStr;\n                                }\n                                firstOp = firstOp === '&' ? '' : firstOp;\n                                countDigit = countDigit + 1;\n                                form = form + firstDigit + firstOp;\n                            }\n                            else if (countDigit < 2) {\n                                secondDigit = formula[i];\n                                secondprevOp = formula[i - 1];\n                                secondnextOp = formula[i + 1];\n                                countDigit = 0;\n                                if (secondprevOp === '-') {\n                                    secondnextOp = isNullOrUndefined(secondnextOp) ? this.emptyStr : secondnextOp;\n                                    secondnextOp = secondnextOp === '&' ? '' : secondnextOp;\n                                    form = form + secondprevOp + secondDigit + secondnextOp;\n                                }\n                                else {\n                                    secondnextOp = isNullOrUndefined(secondnextOp) ? this.emptyStr : secondnextOp;\n                                    form = form + secondDigit + secondnextOp;\n                                }\n                            }\n                            i = i + 2;\n                        }\n                        else {\n                            form = (formula[i] === '-') ? form + formula[i] : form;\n                            i = i + 1;\n                        }\n                    }\n                    else {\n                        throw this.parent.formulaErrorStrings[FormulasErrorsStrings.improper_formula];\n                    }\n                    /* tslint:disable-next-line */\n                }\n                else if ((this.parent.isDigit(formula[i]) || formula[i] === this.parent.rightBracket || this.parent.storedData.has(formula[i].toUpperCase())) && (isNullOrUndefined(formula[i + 1]) || this.indexOfAny(formula[i + 1], arithemeticArr)) > -1) {\n                    op = isNullOrUndefined(formula[i + 1]) ? this.emptyStr : formula[i + 1];\n                    op = op === '&' ? '' : op;\n                    form = formula[i - 1] === '-' ? form + formula[i - 1] + formula[i] + op : form + formula[i] + op;\n                    i = i + 2;\n                    /* tslint:disable-next-line */\n                }\n                else if (this.indexOfAny(formula[i], logicalSym) > -1 && !isNullOrUndefined(formula[i - 1]) && !isNullOrUndefined(formula[i + 1])) {\n                    form = form + formula[i];\n                    i = i + 1;\n                }\n                else if (formula[i] === 'q') {\n                    while (formula[i] !== this.parent.leftBracket) {\n                        form = form + formula[i];\n                        i = i + 1;\n                    }\n                    /* tslint:disable-next-line */\n                }\n                else if (formula[i] === this.parent.leftBracket || formula[i] === this.parent.rightBracket || formula[i] === '{' || formula[i] === '}' || formula[i] === '(' || formula[i] === ')') {\n                    form = form + formula[i];\n                    i = i + 1;\n                    /* tslint:disable-next-line */\n                }\n                else if (this.parent.isUpperChar(formula[i]) || formula[i].indexOf(':') > -1 || formula[i] === this.parent.getParseArgumentSeparator() || ((formula[i] === '%') && (this.parent.isDigit(formula[i - 1])))) {\n                    form = form + formula[i];\n                    i = i + 1;\n                }\n                else if (formula[i] === this.parent.tic || formula[i] === ' ' || formula[i] === '.' || formula[i] === this.sheetToken ||\n                    formula[i] === '$') {\n                    form = form + formula[i];\n                    i = i + 1;\n                }\n                else {\n                    if (this.parent.isDigit(formula[i])) {\n                        form = formula[i - 1] === '-' ? form + formula[i - 1] + formula[i] : form + formula[i];\n                    }\n                    if (formula[i] === '-') {\n                        form = form + formula[i];\n                        form = form.split('--').join('+').split('++').join('+').split('+-').join('-').split('-').join('-');\n                    }\n                    i = i + 1;\n                }\n            }\n        }\n        form = form === this.emptyStr ? formula : form;\n        if (this.indexOfAny(form[form.length - 1], arithemeticArr) > -1) {\n            form = form.substring(0, form.length - 1);\n        }\n        form = form.split('--').join('-').split('-+').join('-').split('+-').join('-');\n        return form;\n    };\n    Parser.prototype.checkScopedRange = function (text) {\n        var _this = this;\n        var scopedRange = this.emptyStr;\n        var b = 'NaN';\n        var id = this.parent.getSheetID(this.parent.grid);\n        var sheet = this.parent.getSheetFamilyItem(this.parent.grid);\n        if (text[0] === this.sheetToken.toString()) {\n            var i = text.indexOf(this.sheetToken, 1);\n            var v = parseInt(text.substr(1, i - 1), 10);\n            if (i > 1 && !this.parent.isNaN(v)) {\n                text = text.substring(i + 1);\n                id = v;\n            }\n        }\n        var token = '!' + id.toString() + '!';\n        if (sheet === null || sheet.sheetNameToToken == null) {\n            return b;\n        }\n        sheet.sheetNameToToken.forEach(function (value, key) {\n            if (sheet.sheetNameToToken.get(key).toString() === token) {\n                _this.parent.namedRanges.forEach(function (value, key) {\n                    scopedRange = (_this.parent.namedRanges.get(key)).toUpperCase();\n                    b = text.toUpperCase().replace(key.toUpperCase(), scopedRange);\n                    return b;\n                });\n            }\n        });\n        return b;\n    };\n    Parser.prototype.storeStrings = function (tempString) {\n        var i = 0;\n        var j = 0;\n        var id = 0;\n        var key = '';\n        var storedString = null;\n        var condition;\n        var ticLoc = tempString.indexOf(this.parent.tic);\n        var singleTicLoc = tempString.indexOf(this.parent.singleTic);\n        if (ticLoc > -1 || singleTicLoc > -1) {\n            tempString = tempString.split(this.parent.singleTic).join(this.parent.tic);\n            i = tempString.indexOf(this.parent.tic);\n            while (i > -1 && tempString.length > 0) {\n                if (storedString === null) {\n                    storedString = this.stringsColl;\n                }\n                j = i + 1 < tempString.length ? tempString.indexOf(this.parent.tic, i + 1) : -1;\n                if (j === -1) {\n                    throw new FormulaError(this.parent.formulaErrorStrings[FormulasErrorsStrings.mismatched_tics]);\n                }\n                condition = this.parent.substring(tempString, i, j - i + 1);\n                key = this.parent.tic + this.spaceString + id.toString() + this.parent.tic;\n                storedString = storedString.set(key, condition);\n                tempString = tempString.substring(0, i) + key + tempString.substring(j + 1);\n                i = i + key.length;\n                if (i < tempString.length) {\n                    i = tempString.indexOf(this.parent.tic, i);\n                }\n                id++;\n            }\n        }\n        this.storedStringText = tempString;\n        return storedString;\n    };\n    Parser.prototype.setStrings = function (text, formulaString) {\n        for (var i = 0; i < formulaString.size; i++) {\n            formulaString.forEach(function (value, key) {\n                text = text.split(key).join(value);\n            });\n        }\n        return text;\n    };\n    /** @hidden */\n    Parser.prototype.parseSimple = function (formulaText) {\n        var needToContinue = true;\n        var text = formulaText;\n        if (text.length > 0 && text[0] === '+') {\n            text = text.substring(1);\n        }\n        if (text === '#DIV/0!') {\n            return '#DIV/0!';\n        }\n        if (text === '#NAME?') {\n            return '#NAME?';\n        }\n        if (text === '') {\n            return text;\n        }\n        if (this.parent.formulaErrorStrings.indexOf(text) > -1) {\n            return text;\n        }\n        text = text.split(this.stringLessEq).join(this.charLessEq);\n        text = text.split(this.stringGreaterEq).join(this.charGreaterEq);\n        text = text.split(this.stringNoEqual).join(this.charNoEqual);\n        text = text.split(this.stringAnd).join(this.charAnd);\n        text = text.split(this.stringOr).join(this.charOr);\n        text = text.split(this.fixedReference).join(this.emptyStr);\n        needToContinue = true;\n        var expTokenArray = [this.tokenEp, this.tokenEm];\n        var mulTokenArray = [this.tokenMultiply, this.tokenDivide];\n        var addTokenArray = [this.tokenAdd, this.tokenSubtract];\n        var mulCharArray = [this.charMultiply, this.charDivide];\n        var addCharArray = [this.charAdd, this.charSubtract];\n        var compareTokenArray = [this.tokenLess, this.tokenGreater, this.tokenEqual, this.tokenLessEq,\n            this.tokenGreaterEq, this.tokenNotEqual];\n        var compareCharArray = [this.charLess, this.charGreater, this.charEqual, this.charLessEq,\n            this.charGreaterEq, this.charNoEqual];\n        var expCharArray = [this.charEp, this.charEm];\n        var andTokenArray = [this.tokenAnd];\n        var andCharArray = [this.charAnd];\n        var orCharArray = [this.charOr];\n        var orTokenArray = [this.tokenOr];\n        text = this.parseSimpleOperators(text, expTokenArray, expCharArray);\n        text = this.parseSimpleOperators(text, orTokenArray, orCharArray);\n        if (needToContinue) {\n            text = this.parseSimpleOperators(text, mulTokenArray, mulCharArray);\n        }\n        if (needToContinue) {\n            text = this.parseSimpleOperators(text, addTokenArray, addCharArray);\n        }\n        if (needToContinue) {\n            text = this.parseSimpleOperators(text, compareTokenArray, compareCharArray);\n        }\n        if (needToContinue) {\n            text = this.parseSimpleOperators(text, andTokenArray, andCharArray);\n        }\n        return text;\n    };\n    /** @hidden */\n    // tslint:disable-next-line:max-func-body-length\n    Parser.prototype.parseSimpleOperators = function (formulaText, markers, operators) {\n        if (this.parent.getErrorStrings().indexOf(formulaText) > -1) {\n            return formulaText;\n        }\n        var text = formulaText;\n        var i = 0;\n        var op = '';\n        for (var c = 0; c < operators.length; c++) {\n            op = op + operators[c];\n        }\n        /* tslint:disable */\n        text = text.split(\"---\").join(\"-\").split(\"--\").join(\"+\").split(this.parent.getParseArgumentSeparator() + \"-\").join(this.parent.getParseArgumentSeparator() + \"u\").split(this.parent.leftBracket + \"-\").join(this.parent.leftBracket + \"u\").split(\"=-\").join(\"=u\");\n        text = text.split(',+').join(',').split(this.parent.leftBracket + '+').join(this.parent.leftBracket).split('=+').join('=').split('>+').join('>').split('<+').join('<').split('/+').join('/').split('*+').join('*').split('++').join('+').split(\"*-\").join(\"*u\").toString();\n        ;\n        /* tslint:enable */\n        if (text.length > 0 && text[0] === '-') {\n            text = text.substring(1).split('-').join(this.tokenOr);\n            text = '0-' + text;\n            text = this.parseSimpleOperators(text, [this.tokenSubtract], [this.charSubtract]);\n            text = text.split(this.tokenOr).join('-');\n        }\n        else if (text.length > 0 && text[0] === '+') {\n            text = text.substring(1);\n        }\n        else if (text.length > 0 && text[text.length - 1] === '+') {\n            text = text.substring(0, text.length - 1);\n        }\n        try {\n            if (this.indexOfAny(text, operators) > -1) {\n                i = this.indexOfAny(text, operators);\n                while (i > -1) {\n                    var left = '';\n                    var right = '';\n                    var leftIndex = 0;\n                    var rightIndex = 0;\n                    var isNotOperator = text[i] === this.charNOTop;\n                    var j = 0;\n                    if (!isNotOperator) {\n                        j = i - 1;\n                        if (text[j] === this.parent.arithMarker) {\n                            var k = this.findLeftMarker(text.substring(0, j - 1));\n                            if (k < 0) {\n                                throw new FormulaError(this.parent.formulaErrorStrings[FormulasErrorsStrings.cannot_parse]);\n                            }\n                            left = this.parent.substring(text, k + 1, j - k - 1);\n                            leftIndex = k + 1;\n                        }\n                        else if (text[j] === this.parent.rightBracket) {\n                            var bracketCount = 0;\n                            var k = j - 1;\n                            while (k > 0 && (text[k] !== 'q' || bracketCount !== 0)) {\n                                if (text[k] === 'q') {\n                                    bracketCount--;\n                                }\n                                else if (text[k] === this.parent.rightBracket) {\n                                    bracketCount++;\n                                }\n                                k--;\n                            }\n                            if (k < 0) {\n                                throw new FormulaError(this.parent.formulaErrorStrings[FormulasErrorsStrings.cannot_parse]);\n                            }\n                            left = this.parent.substring(text, k, j - k + 1);\n                            leftIndex = k;\n                        }\n                        else if (text[j] === this.parent.tic[0]) {\n                            var l = text.substring(0, j - 1).lastIndexOf(this.parent.tic);\n                            if (l < 0) {\n                                throw new FormulaError(this.parent.formulaErrorStrings[FormulasErrorsStrings.cannot_parse]);\n                            }\n                            left = this.parent.substring(text, l, j - l + 1);\n                            leftIndex = l;\n                        }\n                        else {\n                            var period = false;\n                            while (j > -1 && (this.parent.isDigit(text[j]) ||\n                                (!period && text[j] === this.parent.getParseDecimalSeparator()))) {\n                                if (text[j] === this.parent.getParseDecimalSeparator()) {\n                                    period = true;\n                                }\n                                j = j - 1;\n                            }\n                            if (j > -1 && period && text[j] === this.parent.getParseDecimalSeparator()) {\n                                /* tslint:disable-next-line */\n                                throw new FormulaError(this.parent.formulaErrorStrings[FormulasErrorsStrings.number_contains_2_decimal_points]);\n                            }\n                            j = j + 1;\n                            if (j === 0 || (j > 0 && !this.parent.isUpperChar(text[j - 1]))) {\n                                left = 'n' + this.parent.substring(text, j, i - j);\n                                leftIndex = j;\n                            }\n                            else {\n                                j = j - 1;\n                                while (j > -1 && (this.parent.isUpperChar(text[j]) || this.parent.isDigit(text[j]))) {\n                                    j = j - 1;\n                                }\n                                if (j > -1 && text[j] === this.sheetToken) {\n                                    j = j - 1;\n                                    while (j > -1 && text[j] !== this.sheetToken) {\n                                        j = j - 1;\n                                    }\n                                    if (j > -1 && text[j] === this.sheetToken) {\n                                        j = j - 1;\n                                    }\n                                }\n                                j = j + 1;\n                                left = this.parent.substring(text, j, i - j);\n                                this.parent.updateDependentCell(left);\n                                leftIndex = j;\n                            }\n                            if ((this.parent.namedRanges.size > 0 && this.parent.namedRanges.has(left.toUpperCase())) ||\n                                (this.parent.storedData.has(left.toUpperCase()))) {\n                                left = 'n' + this.checkForNamedRangeAndKeyValue(left);\n                            }\n                        }\n                    }\n                    else {\n                        leftIndex = i;\n                    }\n                    if (i === text.length - 1) {\n                        /* tslint:disable-next-line */\n                        throw new FormulaError(this.parent.formulaErrorStrings[FormulasErrorsStrings.expression_cannot_end_with_an_operator]);\n                    }\n                    else {\n                        j = i + 1;\n                        var uFound = text[j] === 'u'; // for 3*-2\n                        if (uFound) {\n                            j = j + 1;\n                        }\n                        if (text[j] === this.parent.tic[0]) {\n                            var k = text.substring(j + 1).indexOf(this.parent.tic);\n                            if (k < 0) {\n                                throw this.parent.formulaErrorStrings[FormulasErrorsStrings.cannot_parse];\n                            }\n                            right = this.parent.substring(text, j, k + 2);\n                            rightIndex = k + j + 2;\n                        }\n                        else if (text[j] === this.parent.arithMarker) {\n                            var k = this.findRightMarker(text.substring(j + 1));\n                            if (k < 0) {\n                                throw new FormulaError(this.parent.formulaErrorStrings[FormulasErrorsStrings.cannot_parse]);\n                            }\n                            right = this.parent.substring(text, j + 1, k);\n                            rightIndex = k + j + 2;\n                        }\n                        else if (text[j] === 'q') {\n                            var bracketCount = 0;\n                            var k = j + 1;\n                            while (k < text.length && (text[k] !== this.parent.rightBracket || bracketCount !== 0)) {\n                                if (text[k] === this.parent.rightBracket) {\n                                    bracketCount++;\n                                }\n                                else if (text[k] === 'q') {\n                                    bracketCount--;\n                                }\n                                k++;\n                            }\n                            if (k === text.length) {\n                                throw this.parent.formulaErrorStrings[FormulasErrorsStrings.cannot_parse];\n                            }\n                            right = this.parent.substring(text, j, k - j + 1);\n                            if (uFound) {\n                                right = 'u' + right;\n                            }\n                            rightIndex = k + 1;\n                            /* tslint:disable-next-line */\n                        }\n                        else if (this.parent.isDigit(text[j]) || text[j] === this.parent.getParseDecimalSeparator()) {\n                            var period = (text[j] === this.parent.getParseDecimalSeparator());\n                            j = j + 1;\n                            /* tslint:disable-next-line */\n                            while (j < text.length && (this.parent.isDigit(text[j]) || (!period && text[j] === this.parent.getParseDecimalSeparator()))) {\n                                if (text[j] === this.parent.getParseDecimalSeparator()) {\n                                    period = true;\n                                }\n                                j = j + 1;\n                            }\n                            if (j < text.length && text[j] === '%') {\n                                j += 1;\n                            }\n                            if (period && j < text.length && text[j] === this.parent.getParseDecimalSeparator()) {\n                                throw this.parent.formulaErrorStrings[FormulasErrorsStrings.number_contains_2_decimal_points];\n                            }\n                            right = 'n' + this.parent.substring(text, i + 1, j - i - 1);\n                            rightIndex = j;\n                        }\n                        else if (this.parent.isUpperChar(text[j]) || text[j] === this.sheetToken || text[j] === 'u') {\n                            if (text[j] === this.sheetToken) {\n                                j = j + 1;\n                                while (j < text.length && text[j] !== this.sheetToken) {\n                                    j = j + 1;\n                                }\n                            }\n                            j = j + 1;\n                            var jTemp = 0;\n                            var inbracket = false;\n                            while (j < text.length && (this.parent.isUpperChar(text[j]) || text[j] === '_'\n                                || text[j] === '.' || text[j] === '[' || text[j] === ']' || text[j] === '#' || text[j] === ' '\n                                || text[j] === '%' || text[j] === this.parent.getParseDecimalSeparator() && inbracket)) {\n                                if (j !== text.length - 1 && text[j] === '[' && text[j + 1] === '[') {\n                                    inbracket = true;\n                                }\n                                if (j !== text.length - 1 && text[j] === ']' && text[j + 1] === ']') {\n                                    inbracket = false;\n                                }\n                                j++;\n                                jTemp++;\n                            }\n                            var noCellReference = (j === text.length) || !this.parent.isDigit(text[j]);\n                            if (jTemp > 1) {\n                                while (j < text.length && (this.parent.isUpperChar(text[j]) || this.parent.isDigit(text[j])\n                                    || text[j] === ' ' || text[j] === '_')) {\n                                    j++;\n                                }\n                                noCellReference = true;\n                            }\n                            while (j < text.length && this.parent.isDigit(text[j])) {\n                                j = j + 1;\n                            }\n                            if (j < text.length && text[j] === ':') {\n                                j = j + 1;\n                                if (j < text.length && text[j] === this.sheetToken) {\n                                    j++;\n                                    while (j < text.length && text[j] !== this.sheetToken) {\n                                        j = j + 1;\n                                    }\n                                    if (j < text.length && text[j] === this.sheetToken) {\n                                        j++;\n                                    }\n                                }\n                                while (j < text.length && this.parent.isUpperChar(text[j])) {\n                                    j = j + 1;\n                                }\n                                while (j < text.length && this.parent.isDigit(text[j])) {\n                                    j = j + 1;\n                                }\n                                j = j - 1;\n                                right = this.parent.substring(text, i + 1, j - i);\n                            }\n                            else {\n                                j = j - 1;\n                                right = this.parent.substring(text, i + 1, j - i);\n                                uFound = text[j] === 'u';\n                                if (uFound) {\n                                    right = 'u' + right;\n                                }\n                            }\n                            noCellReference = !this.parent.isCellReference(right);\n                            if (!noCellReference) {\n                                this.parent.updateDependentCell(right);\n                            }\n                            if ((this.parent.namedRanges.size > 0 && this.parent.namedRanges.has(right.toUpperCase()))\n                                || (this.parent.storedData.has(right.toUpperCase()))) {\n                                right = 'n' + this.checkForNamedRangeAndKeyValue(right);\n                            }\n                            rightIndex = j + 1;\n                        }\n                    }\n                    var p = op.indexOf(text[i]);\n                    var s = this.parent.arithMarker + left + right + markers[p] + this.parent.arithMarker;\n                    if (leftIndex > 0) {\n                        s = text.substring(0, leftIndex) + s;\n                    }\n                    if (rightIndex < text.length) {\n                        s = s + text.substring(rightIndex);\n                    }\n                    s = s.split(this.parent.arithMarker2).join(this.parent.arithMarker.toString());\n                    text = s;\n                    i = this.indexOfAny(text, operators);\n                }\n            }\n            else {\n                if (text.length > 0 && (this.parent.isUpperChar(text[0]) || text[0] === this.sheetToken)) {\n                    var isCharacter = true;\n                    var checkLetter = true;\n                    var oneTokenFound = false;\n                    var textLen = text.length;\n                    for (var k = 0; k < textLen; ++k) {\n                        if (text[k] === this.sheetToken) {\n                            if (k > 0 && !oneTokenFound) {\n                                throw this.parent.getErrorStrings()[CommonErrors.ref];\n                            }\n                            oneTokenFound = true;\n                            k++;\n                            while (k < textLen && this.parent.isDigit(text[k])) {\n                                k++;\n                            }\n                            if (k === textLen || text[k] !== this.sheetToken) {\n                                isCharacter = false;\n                                break;\n                            }\n                        }\n                        else {\n                            if (!checkLetter && this.parent.isChar(text[k])) {\n                                isCharacter = false;\n                                break;\n                            }\n                            if (this.parent.isChar(text[k]) || this.parent.isDigit(text[k]) || text[k] === this.sheetToken) {\n                                checkLetter = this.parent.isUpperChar(text[k]);\n                            }\n                            else {\n                                isCharacter = false;\n                                break;\n                            }\n                        }\n                    }\n                    if (isCharacter) {\n                        this.parent.updateDependentCell(text);\n                    }\n                }\n            }\n            return text;\n        }\n        catch (ex) {\n            return ex;\n        }\n    };\n    /** @hidden */\n    Parser.prototype.indexOfAny = function (text, operators) {\n        for (var i = 0; i < text.length; i++) {\n            if (operators.indexOf(text[i]) > -1) {\n                return i;\n            }\n        }\n        return -1;\n    };\n    /** @hidden */\n    Parser.prototype.findLeftMarker = function (text) {\n        var ret = -1;\n        if (text.indexOf(this.parent.arithMarker) > -1) {\n            var bracketLevel = 0;\n            for (var i = text.length - 1; i >= 0; --i) {\n                if (text[i] === this.parent.rightBracket) {\n                    bracketLevel--;\n                }\n                else if (text[i] === this.parent.leftBracket) {\n                    bracketLevel++;\n                }\n                else if (text[i] === this.parent.arithMarker && bracketLevel === 0) {\n                    ret = i;\n                    break;\n                }\n            }\n        }\n        return ret;\n    };\n    /** @hidden */\n    Parser.prototype.findRightMarker = function (text) {\n        var ret = -1;\n        if (text.indexOf(this.parent.arithMarker) > -1) {\n            var bracketLevel = 0;\n            for (var j = 0; j < text.length; ++j) {\n                if (text[j] === this.parent.rightBracket) {\n                    bracketLevel--;\n                }\n                else if (text[j] === this.parent.leftBracket) {\n                    bracketLevel++;\n                }\n                else if (text[j] === this.parent.arithMarker && bracketLevel === 0) {\n                    ret = j;\n                    break;\n                }\n            }\n        }\n        return ret;\n    };\n    /** @hidden */\n    Parser.prototype.parseFormula = function (formula, fKey) {\n        if (formula.length > 0 && formula[0] === this.parent.getFormulaCharacter()) {\n            formula = formula.substring(1);\n        }\n        if (formula.length > 0 && formula[0] === '+') {\n            formula = formula.substring(1);\n        }\n        try {\n            this.isFailureTriggered = false;\n            this.isError = false;\n            formula = this.parse(formula.trim(), fKey);\n            this.isFormulaParsed = true;\n        }\n        catch (ex) {\n            var args = this.exceptionArgs(ex);\n            if (!this.isFailureTriggered) {\n                this.parent.trigger('onFailure', args);\n                this.isFailureTriggered = true;\n            }\n            var errorMessage = (typeof args.exception === 'string') ? args.exception : args.message;\n            formula = (isNullOrUndefined(this.parent.getErrorLine(ex)) ? '' : '#' + this.parent.getErrorLine(ex) + ': ') + errorMessage;\n            this.isError = true;\n        }\n        return formula;\n    };\n    /** @hidden */\n    Parser.prototype.markLibraryFormulas = function (formula) {\n        var bracCount = 0;\n        var rightParens = formula.indexOf(')');\n        if (rightParens === -1) {\n            formula = this.markNamedRanges(formula);\n        }\n        else {\n            while (rightParens > -1) {\n                var parenCount = 0;\n                var leftParens = rightParens - 1;\n                while (leftParens > -1 && (formula[leftParens] !== '(' || parenCount !== 0)) {\n                    if (formula[leftParens] === ')') {\n                        parenCount++;\n                    }\n                    else if (formula[leftParens] === ')') {\n                        parenCount--;\n                    }\n                    leftParens--;\n                }\n                if (leftParens === -1) {\n                    throw new FormulaError(this.parent.formulaErrorStrings[FormulasErrorsStrings.mismatched_parentheses]);\n                }\n                var i = leftParens - 1;\n                while (i > -1 && (this.parent.isChar(formula[i]))) {\n                    i--;\n                }\n                var len = leftParens - i - 1;\n                var libFormula = this.parent.substring(formula, i + 1, len);\n                if (len > 0 && !isNullOrUndefined(this.parent.getFunction(libFormula))) {\n                    if (this.parent.substring(formula, i + 1, len) === 'AREAS') {\n                        this.ignoreBracet = true;\n                    }\n                    else {\n                        this.ignoreBracet = false;\n                    }\n                    var substr = this.parent.substring(formula, leftParens, rightParens - leftParens + 1);\n                    try {\n                        var args = void 0;\n                        substr = substr.split('(').join('').split(')').join('');\n                        substr = '(' + this.formulaAutoCorrection(substr, args) + ')';\n                    }\n                    catch (ex) {\n                        var args = {\n                            message: ex.message, exception: ex,\n                            isForceCalculable: ex.formulaCorrection, computeForceCalculate: false\n                        };\n                        if (!args.isForceCalculable) {\n                            throw this.parent.formulaErrorStrings[FormulasErrorsStrings.improper_formula];\n                        }\n                        if (!this.isFailureTriggered) {\n                            this.parent.trigger('onFailure', args);\n                            this.isFailureTriggered = true;\n                            bracCount = bracCount + 1;\n                        }\n                        args.computeForceCalculate = bracCount > 0 ? true : args.computeForceCalculate;\n                        if (args.isForceCalculable) {\n                            if (args.computeForceCalculate) {\n                                substr = substr.split('(').join('').split(')').join('');\n                                substr = '(' + this.formulaAutoCorrection(substr, args) + ')';\n                            }\n                            else {\n                                throw this.parent.formulaErrorStrings[FormulasErrorsStrings.improper_formula];\n                            }\n                        }\n                        else {\n                            throw this.parent.formulaErrorStrings[FormulasErrorsStrings.improper_formula];\n                        }\n                    }\n                    substr = this.markNamedRanges(substr);\n                    substr = this.swapInnerParens(substr);\n                    substr = this.addParensToArgs(substr);\n                    var id = substr.lastIndexOf(this.parent.getParseArgumentSeparator());\n                    var k = 0;\n                    if (id === -1) {\n                        if (substr.length > 2 && substr[0] === '(' && substr[substr.length - 1] === ')') {\n                            if (substr[1] !== '{' && substr[1] !== '(') {\n                                substr = substr.substring(0, substr.length - 1) + '}' + substr.substring(substr.length - 1);\n                                substr = substr[0] + '{' + substr.substring(1);\n                            }\n                        }\n                    }\n                    formula = formula.substring(0, i + 1) + 'q' + this.parent.substring(formula, i + 1, len) +\n                        (substr.split('(').join(this.parent.leftBracket))\n                            .split(')').join(this.parent.rightBracket) + formula.substring(rightParens + 1);\n                }\n                else if (len > 0) {\n                    return this.parent.getErrorStrings()[CommonErrors.name];\n                }\n                else {\n                    var s = this.emptyStr;\n                    if (leftParens > 0) {\n                        s = formula.substring(0, leftParens);\n                    }\n                    s = s + '{' + this.parent.substring(formula, leftParens + 1, rightParens - leftParens - 1) + '}';\n                    if (rightParens < formula.length) {\n                        s = s + formula.substring(rightParens + 1);\n                    }\n                    s = this.markNamedRanges(s);\n                    formula = s;\n                }\n                rightParens = formula.indexOf(')');\n            }\n        }\n        formula = (formula.split('{').join('(')).split('}').join(')');\n        return formula;\n    };\n    /** @hidden */\n    Parser.prototype.swapInnerParens = function (fSubstr) {\n        if (fSubstr.length > 2) {\n            /* tslint:disable-next-line */\n            fSubstr = fSubstr[0] + fSubstr.substr(1, fSubstr.length - 2).split('(').join('{').split(')').join('}') + fSubstr[fSubstr.length - 1];\n        }\n        return fSubstr;\n    };\n    /** @hidden */\n    Parser.prototype.addParensToArgs = function (fSubstr) {\n        if (fSubstr.length === 0) {\n            return this.emptyStr;\n        }\n        var rightSides = [];\n        rightSides.push(this.parent.getParseArgumentSeparator());\n        rightSides.push(this.parent.rightBracket);\n        var id = fSubstr.lastIndexOf(this.parent.getParseArgumentSeparator());\n        var k = 0;\n        if (id === -1) {\n            if (fSubstr.length > 2 && fSubstr[0] === '(' && fSubstr[fSubstr.length - 1] === ')') {\n                if (fSubstr[1] !== '{' && fSubstr[1] !== '(') {\n                    fSubstr = fSubstr.substring(0, fSubstr.length - 1) + '}' + fSubstr.substring(fSubstr.length - 1);\n                    fSubstr = fSubstr[0] + '{' + fSubstr.substring(1);\n                }\n                else {\n                    var marker = ['+', '-', '*', '/'];\n                    id = this.lastIndexOfAny(fSubstr, marker);\n                    if (k === 0 && fSubstr[fSubstr.length - 1] === ')') {\n                        k = fSubstr.length - 1;\n                    }\n                    if (k > 0) {\n                        if (fSubstr[id + 1] !== '{' && fSubstr[id - 1] === '}') {\n                            fSubstr = fSubstr.substr(0, k) + '}' + fSubstr.substr(k);\n                            fSubstr = fSubstr.substr(0, id + 1) + '{' + fSubstr.substr(id + 1);\n                        }\n                    }\n                }\n            }\n        }\n        else {\n            var oneTimeOnly = true;\n            while (id > -1) {\n                var j = this.indexOfAny(fSubstr.substring(id + 1, fSubstr.length), rightSides);\n                if (j >= 0) {\n                    j = id + j + 1;\n                }\n                else if (j === -1 && fSubstr[fSubstr.length - 1] === ')') {\n                    j = fSubstr.length - 1;\n                }\n                if (j > 0) {\n                    if (fSubstr[id + 1] !== '{' && fSubstr[j - 1] !== '}') {\n                        fSubstr = fSubstr.substr(0, j) + '}' + fSubstr.substr(j);\n                        fSubstr = fSubstr.substr(0, id + 1) + '{' + fSubstr.substr(id + 1);\n                    }\n                }\n                id = fSubstr.substr(0, id).lastIndexOf(this.parent.getParseArgumentSeparator());\n                if (oneTimeOnly && id === -1 && fSubstr[0] === '(') {\n                    id = 0;\n                    oneTimeOnly = false;\n                }\n            }\n        }\n        fSubstr = fSubstr.split('{}').join(this.emptyStr);\n        return fSubstr;\n    };\n    /** @hidden */\n    Parser.prototype.lastIndexOfAny = function (text, operators) {\n        for (var i = text.length - 1; i > -1; i--) {\n            if (operators.indexOf(text[i]) > -1) {\n                return i;\n            }\n        }\n        return -1;\n    };\n    /** @hidden */\n    Parser.prototype.markNamedRanges = function (formula) {\n        var markers = [')', this.parent.getParseArgumentSeparator(), '}', '+', '-', '*', '/', '<', '>', '=', '&'];\n        var i = (formula.length > 0 && (formula[0] === '(' || formula[0] === '{')) ? 1 : 0;\n        if (formula.indexOf('#N/A') > -1) {\n            formula = formula.split('#N/A').join('#N~A');\n        }\n        if (formula.indexOf('#DIV/0!') > -1) {\n            formula = formula.split('#DIV/0!').join('#DIV~0!');\n        }\n        var end = this.indexOfAny(formula.substring(i), markers);\n        while (end > -1 && end + i < formula.length) {\n            var scopedRange = this.emptyStr;\n            var s = null;\n            if ((this.parent.substring(formula, i, end)).indexOf('[') > -1) {\n                s = this.getTableRange(this.parent.substring(formula, i, end));\n            }\n            else if (this.parent.storedData.has(this.parent.substring(formula, i, end))) {\n                s = this.checkForNamedRangeAndKeyValue(this.parent.substring(formula, i, end));\n            }\n            else if (this.parent.namedRanges.has(this.parent.substring(formula, i, end))) {\n                s = this.checkForNamedRangeAndKeyValue(this.parent.substring(formula, i, end));\n            }\n            if (isNullOrUndefined(s)) {\n                scopedRange = this.checkScopedRange(this.parent.substring(formula, i, end));\n                if (scopedRange !== 'NaN') {\n                    this.findNamedRange = true;\n                    s = scopedRange;\n                }\n                else if (this.parent.substring(formula, i, end).startsWith(this.sheetToken.toString())) {\n                    var formulaStr = this.parent.substring(formula, i, end).indexOf(this.sheetToken, 1);\n                    // if (formulaStr > 1) {\n                    //     s = this.parent.namedRanges.get(this.parent.substring\n                    // (formula.substring(i), formulaStr + 1, end - formulaStr - 1));\n                    // }\n                }\n                if (!isNullOrUndefined(s) && this.findNamedRange) {\n                    if (s.indexOf(this.fixedReference) > -1) {\n                        s = s.split(this.fixedReference).join(this.emptyStr);\n                    }\n                }\n            }\n            if (!isNullOrUndefined(s)) {\n                s = s.toUpperCase();\n                s = this.parent.setTokensForSheets(s);\n                s = this.markLibraryFormulas(s);\n            }\n            if (!isNullOrUndefined(s) && s !== this.emptyStr) {\n                formula = formula.substring(0, i) + s + formula.substring(i + end);\n                i += s.length + 1;\n            }\n            else {\n                i += end + 1;\n                while (i < formula.length && !this.parent.isUpperChar(formula[i]) && formula[i] !== this.sheetToken) {\n                    i++;\n                }\n            }\n            end = i;\n            if (i < formula.length - 1 && formula[i] === '{') {\n                i = i + 1;\n            }\n            end = this.indexOfAny(formula.substring(i), markers);\n            while (end === 0 && i < formula.length - 1) {\n                i++;\n                end = this.indexOfAny(formula.substring(i), markers);\n            }\n            if ((end === -1 || formula.substring(i).indexOf('[') > -1) && i < formula.length) {\n                if (formula.substring(i).indexOf('[') > -1) {\n                    s = this.getTableRange(formula.substring(i));\n                }\n                else {\n                    if (this.parent.storedData.has(formula.substring(i))) {\n                        s = this.parent.storedData.size > 0 ? this.checkForNamedRangeAndKeyValue(formula.substring(i)) : s;\n                    }\n                    else {\n                        s = this.parent.namedRanges.size > 0 ? this.checkForNamedRangeAndKeyValue(formula.substring(i)) : s;\n                    }\n                }\n                if (isNullOrUndefined(s)) {\n                    scopedRange = this.checkScopedRange(formula.substring(i));\n                    if (scopedRange !== 'NaN') {\n                        s = scopedRange;\n                    }\n                }\n                if (!isNullOrUndefined(s) && s !== this.emptyStr) {\n                    s = s.toUpperCase();\n                    s = this.parent.setTokensForSheets(s);\n                    s = this.markLibraryFormulas(s);\n                    if (s != null) {\n                        var val = formula.substring(i);\n                        if (val[val.length - 1] === ')') {\n                            formula = formula.substring(0, i) + s + ')';\n                        }\n                        else {\n                            formula = formula.substring(0, i) + s;\n                        }\n                        i += s.toString().length + 1;\n                    }\n                }\n                end = (i < formula.length) ? this.indexOfAny(formula.substring(i), markers) : -1;\n            }\n        }\n        if (formula.indexOf('#N~A') > -1) {\n            formula = formula.split('#N~A').join('#N/A');\n        }\n        if (formula.indexOf('#DIV~0!') > -1) {\n            formula = formula.split('#DIV~0!').join('#DIV/0!');\n        }\n        return formula;\n    };\n    /** @hidden */\n    Parser.prototype.checkForNamedRangeAndKeyValue = function (text) {\n        var scopedRange = this.emptyStr;\n        if (text.indexOf('[') > -1) {\n            var namerangeValue = this.getTableRange(text);\n            if (!isNullOrUndefined(namerangeValue)) {\n                this.findNamedRange = true;\n                text = namerangeValue;\n            }\n        }\n        scopedRange = this.checkScopedRange(text);\n        if (scopedRange !== 'NaN') {\n            this.findNamedRange = true;\n            text = scopedRange;\n        }\n        else {\n            if (text.indexOf(this.sheetToken) > -1) {\n                var sheet = this.parent.getSheetFamilyItem(this.parent.grid);\n                /* tslint:disable-next-line */\n                var value = text.split('\"').join(this.emptyStr);\n                value = value.substr(0, value.indexOf(this.sheetToken));\n                if (sheet.sheetNameToToken.has(value.toUpperCase())) {\n                    /* tslint:disable */\n                    var sheetIndex = parseInt(sheet.sheetNameToToken.get(value.toUpperCase()).split(this.sheetToken).join(this.emptyStr));\n                    // if (!ej.isNullOrUndefined(this.parentObject) && this.parentObject.pluginName == \"ejSpreadsheet\") {\n                    //     var name = text.replace(value, this.parentObject.model.sheets[(sheetIndex + 1)].sheetInfo.text.toUpperCase()).split(\"'\").join(this._string_empty);\n                    //     if (this.getNamedRanges().length > 0 && this.getNamedRanges().contains(name.toUpperCase())) {\n                    //         text = name;\n                    //     }\n                    // }\n                    /* tslint-enable */\n                }\n            }\n            if (this.parent.storedData.size > 0 && this.parent.storedData.has(text)) {\n                text = 'A' + this.parent.colIndex(text);\n            }\n            if (this.parent.namedRanges.size > 0 && this.parent.namedRanges.has(text.toUpperCase())) {\n                // if (!isNullOrUndefined(this.parentObject) && this.parentObject.pluginName == \"ejSpreadsheet\") {\n                //     text = this.parse(this.namedRanges.get(text.toUpperCase()));\n                // }\n                //else {\n                text = this.parse(this.parent.namedRanges.get(text.toUpperCase()));\n                text = this.parent.setTokensForSheets(text);\n                if (text.indexOf(this.fixedReference) > -1) {\n                    text.split(this.fixedReference).join(this.emptyStr);\n                }\n            }\n            this.findNamedRange = true;\n        }\n        if (this.findNamedRange) {\n            if (text[0] !== '!' && text[0] !== 'q' && text[0] !== 'bq') {\n                text = this.parent.setTokensForSheets(text);\n                if (text.indexOf(this.fixedReference) > -1) {\n                    text = text.split(this.fixedReference).join(this.emptyStr);\n                }\n            }\n        }\n        return text;\n    };\n    Parser.prototype.getTableRange = function (text) {\n        text = text.replace(' ', this.emptyStr).toUpperCase();\n        var name = text.replace(']', this.emptyStr).replace('#DATA', this.emptyStr);\n        var tableName = name;\n        if (name.indexOf(this.parent.getParseArgumentSeparator()) > -1) {\n            tableName = name.substring(0, name.indexOf(this.parent.getParseArgumentSeparator())).replace('[', this.emptyStr);\n            name = name.replace('[', this.emptyStr).replace(this.parent.getParseArgumentSeparator(), '_');\n        }\n        var range = this.emptyStr;\n        return name.toUpperCase();\n    };\n    Parser.prototype.findNextEndIndex = function (formula, loc) {\n        var count = 0;\n        var l = loc;\n        var found = false;\n        while (!found && loc < formula.length) {\n            if (formula[l] === '[') {\n                count++;\n            }\n            else if (formula[l] === ']') {\n                count--;\n                if (count === 0) {\n                    found = true;\n                }\n            }\n            loc++;\n        }\n        loc = loc - l;\n        return loc;\n    };\n    ;\n    return Parser;\n}());\nexport { Parser };\n","import { getSheetName, getSheetIndex, getSheet } from '../base/index';\nimport { workbookFormulaOperation, getColumnHeaderText } from '../common/index';\nimport { Calculate, ValueChangedArgs } from '../../calculate/index';\nimport { isNullOrUndefined } from '@syncfusion/ej2-base';\n/**\n * @hidden\n * The `WorkbookFormula` module is used to handle the formula operation in Workbook.\n */\nvar WorkbookFormula = /** @class */ (function () {\n    /**\n     * Constructor for formula module in Workbook.\n     * @private\n     */\n    function WorkbookFormula(workbook) {\n        this.parent = workbook;\n        this.init();\n    }\n    WorkbookFormula.prototype.init = function () {\n        this.addEventListener();\n        this.initCalculate();\n        this.registerSheet();\n        this.initiateDefinedNames();\n    };\n    /**\n     * To destroy the formula module.\n     * @return {void}\n     * @hidden\n     */\n    WorkbookFormula.prototype.destroy = function () {\n        this.removeEventListener();\n        this.calculateInstance.dispose();\n        this.calculateInstance = null;\n        this.parent = null;\n    };\n    WorkbookFormula.prototype.addEventListener = function () {\n        this.parent.on(workbookFormulaOperation, this.performFormulaOperation, this);\n    };\n    WorkbookFormula.prototype.removeEventListener = function () {\n        if (!this.parent.isDestroyed) {\n            this.parent.off(workbookFormulaOperation, this.performFormulaOperation);\n        }\n    };\n    /**\n     * Get the module name.\n     * @returns string\n     * @private\n     */\n    WorkbookFormula.prototype.getModuleName = function () {\n        return 'workbookFormula';\n    };\n    WorkbookFormula.prototype.initCalculate = function () {\n        this.calculateInstance = new Calculate(this.parent);\n        this.calcID = this.calculateInstance.createSheetFamilyID();\n        this.calculateInstance.setTreatEmptyStringAsZero(true);\n    };\n    WorkbookFormula.prototype.performFormulaOperation = function (args) {\n        var action = args.action;\n        var formulas = this.calculateInstance.getLibraryFormulas();\n        var formulaInfo = (Array.from(formulas.values()));\n        switch (action) {\n            case 'getLibraryFormulas':\n                args.formulaCollection = Array.from(formulas.keys());\n                break;\n            case 'getFormulaCategory':\n                var collection = ['All'];\n                for (var i = 1; i < Array.from(formulas.values()).length; i++) {\n                    if (collection.indexOf(formulaInfo[i].category) < 0) {\n                        collection.push(formulaInfo[i].category);\n                    }\n                }\n                args.categoryCollection = collection;\n                break;\n            case 'dropDownSelectFormulas':\n                for (var i = 0; i < Array.from(formulas.values()).length; i++) {\n                    if (args.selectCategory === formulaInfo[i].category) {\n                        args.formulaCollection[i] = Array.from(formulas.keys())[i];\n                    }\n                }\n                break;\n            case 'getFormulaDescription':\n                for (var i = 0; i < Array.from(formulas.values()).length; i++) {\n                    if (args.selectedList === Array.from(formulas.keys())[i]) {\n                        args.description = formulaInfo[i].description;\n                    }\n                }\n                break;\n            case 'registerSheet':\n                this.registerSheet(args.sheetIndex, args.sheetCount);\n                break;\n            case 'unRegisterSheet':\n                this.unRegisterSheet(args.sheetIndex, args.sheetCount);\n                break;\n            case 'refreshCalculate':\n                args.value = this.autoCorrectFormula(args.value);\n                this.refreshCalculate(args.rowIndex, args.colIndex, args.value, args.isFormula, args.sheetIndex);\n                break;\n            case 'getArgumentSeparator':\n                args.argumentSeparator = this.calculateInstance.getParseArgumentSeparator();\n                break;\n            case 'addDefinedName':\n                args.isAdded = this.addDefinedName(args.definedName);\n                break;\n            case 'removeDefinedName':\n                args.isRemoved = this.removeDefinedName(args.definedName, args.scope);\n                break;\n            case 'initiateDefinedNames':\n                this.initiateDefinedNames();\n                break;\n        }\n    };\n    WorkbookFormula.prototype.registerSheet = function (sheetIndex, sheetCount) {\n        if (sheetIndex === void 0) { sheetIndex = 0; }\n        if (sheetCount === void 0) { sheetCount = this.parent.sheets.length; }\n        var id;\n        while (sheetIndex < sheetCount) {\n            id = getSheet(this.parent, sheetIndex).id + '';\n            this.calculateInstance.registerGridAsSheet(id, id, this.calcID);\n            sheetIndex++;\n        }\n    };\n    WorkbookFormula.prototype.unRegisterSheet = function (sheetIndex, sheetCount) {\n        if (sheetIndex === void 0) { sheetIndex = 0; }\n        if (sheetCount === void 0) { sheetCount = this.parent.sheets.length; }\n        var id;\n        this.calculateInstance.tokenCount = 0;\n        while (sheetIndex < sheetCount) {\n            id = getSheet(this.parent, sheetIndex).id + '';\n            this.calculateInstance.unregisterGridAsSheet(id, id);\n            sheetIndex++;\n        }\n    };\n    WorkbookFormula.prototype.refreshCalculate = function (rowIdx, colIdx, value, isFormula, sheetIdx) {\n        if (!sheetIdx) {\n            sheetIdx = this.parent.activeSheetTab;\n        }\n        sheetIdx--;\n        var sheetName = getSheet(this.parent, sheetIdx).id + '';\n        if (isFormula) {\n            var cellArgs = new ValueChangedArgs(rowIdx + 1, colIdx + 1, value);\n            this.calculateInstance.valueChanged(sheetName, cellArgs, true);\n        }\n        else {\n            var family = this.calculateInstance.getSheetFamilyItem(sheetName);\n            var cellRef = getColumnHeaderText(colIdx + 1) + (rowIdx + 1);\n            if (family.isSheetMember && !isNullOrUndefined(family.parentObjectToToken)) {\n                cellRef = family.parentObjectToToken.get(sheetName) + cellRef;\n            }\n            if (this.calculateInstance.getFormulaInfoTable().has(cellRef)) {\n                this.calculateInstance.getFormulaInfoTable().delete(cellRef);\n                if (this.calculateInstance.getDependentCells().has(cellRef)) {\n                    this.calculateInstance.clearFormulaDependentCells(cellRef);\n                }\n            }\n            this.calculateInstance.refresh(cellRef);\n        }\n    };\n    WorkbookFormula.prototype.autoCorrectFormula = function (formula) {\n        if (formula.split('(').length === 2 && formula.indexOf(')') < 0) {\n            formula += ')';\n        }\n        return formula;\n    };\n    WorkbookFormula.prototype.initiateDefinedNames = function () {\n        var definedNames = this.parent.definedNames;\n        var len = definedNames.length;\n        var i = 0;\n        while (i < len) {\n            var definedname = definedNames[i];\n            this.addDefinedName(definedname);\n            i++;\n        }\n    };\n    /**\n     * @hidden\n     * Used to add defined name to workbook.\n     * @param {DefineNameModel} name - Define named range.\n     */\n    WorkbookFormula.prototype.addDefinedName = function (definedName) {\n        var isAdded = true;\n        var sheetIdx = null;\n        var name = definedName.name;\n        var refersTo = definedName.refersTo;\n        if (definedName.scope) {\n            sheetIdx = getSheetIndex(this.parent, definedName.scope);\n            if (sheetIdx) {\n                name = getSheetName(this.parent, sheetIdx - 1) + '!' + name;\n            }\n        }\n        else {\n            definedName.scope = '';\n        }\n        if (!definedName.comment) {\n            definedName.comment = '';\n        }\n        //need to extend once internal sheet value changes done.\n        if (this.checkIsNameExist(definedName.name, definedName.scope)) {\n            isAdded = false;\n        }\n        else {\n            this.calculateInstance.addNamedRange(name, refersTo[0] === '=' ? refersTo.substr(1) : refersTo);\n            if (refersTo[0] !== '=') {\n                definedName.refersTo = '=' + refersTo;\n            }\n            this.parent.definedNames.push(definedName);\n        }\n        return isAdded;\n    };\n    /**\n     * @hidden\n     * Used to remove defined name from workbook.\n     * @param {string} name - Specifies the defined name.\n     * @param {string} scope - Specifies the scope of the define name.\n     */\n    WorkbookFormula.prototype.removeDefinedName = function (name, scope) {\n        var isRemoved = false;\n        var index = this.getIndexFromNameColl(name, scope);\n        if (index > -1) {\n            var calcName = name;\n            if (scope) {\n                var sheetIdx = getSheetIndex(this.parent, scope);\n                if (sheetIdx) {\n                    calcName = getSheetName(this.parent, sheetIdx - 1) + '!' + name;\n                }\n            }\n            this.calculateInstance.removeNamedRange(calcName);\n            this.parent.definedNames.splice(index, 1);\n            isRemoved = true;\n        }\n        return isRemoved;\n    };\n    WorkbookFormula.prototype.checkIsNameExist = function (name, sheetName) {\n        var isExist = this.parent.definedNames.some(function (key) {\n            return key.name === name && (sheetName ? key.scope === sheetName : key.scope === '');\n        });\n        return isExist;\n    };\n    WorkbookFormula.prototype.getIndexFromNameColl = function (definedName, scope) {\n        if (scope === void 0) { scope = ''; }\n        var index = -1;\n        this.parent.definedNames.filter(function (name, idx) {\n            if (name.name === definedName && name.scope === scope) {\n                index = idx;\n            }\n        });\n        return index;\n    };\n    return WorkbookFormula;\n}());\nexport { WorkbookFormula };\n","import { getRangeIndexes, setCellFormat, applyCellFormat, activeCellChanged } from '../common/index';\nimport { getSwapRange, textDecorationUpdate } from '../common/index';\nimport { setCell } from '../base/index';\n/**\n * Workbook Cell format.\n */\nvar WorkbookCellFormat = /** @class */ (function () {\n    function WorkbookCellFormat(parent) {\n        this.parent = parent;\n        this.addEventListener();\n    }\n    WorkbookCellFormat.prototype.format = function (args) {\n        var sheet = this.parent.getActiveSheet();\n        if (args.range === undefined) {\n            args.range = sheet.selectedRange;\n        }\n        var indexes = args.range.length === 4 ? args.range : getSwapRange(getRangeIndexes(args.range));\n        for (var i = indexes[0]; i <= indexes[2]; i++) {\n            for (var j = indexes[1]; j <= indexes[3]; j++) {\n                setCell(i, j, sheet, { style: args.style }, true);\n                this.parent.notify(applyCellFormat, {\n                    style: args.style, rowIdx: i, colIdx: j, lastCell: j === indexes[3], isHeightCheckNeeded: true, manualUpdate: true,\n                    onActionUpdate: args.onActionUpdate\n                });\n            }\n        }\n        this.parent.setUsedRange(indexes[2], indexes[3]);\n        if (args.refreshRibbon) {\n            this.parent.notify(activeCellChanged, getRangeIndexes(sheet.activeCell));\n        }\n        this.parent.setProperties({ 'sheets': this.parent.sheets }, true);\n    };\n    WorkbookCellFormat.prototype.textDecorationActionUpdate = function (args) {\n        var sheet = this.parent.getActiveSheet();\n        var indexes = getSwapRange(getRangeIndexes(sheet.selectedRange));\n        var value = args.style.textDecoration;\n        var changedValue = value;\n        var activeCellIndexes = getRangeIndexes(sheet.activeCell);\n        var cellValue = this.parent.getCellStyleValue(['textDecoration'], activeCellIndexes).textDecoration;\n        var changedStyle;\n        var removeProp = false;\n        if (cellValue === 'underline') {\n            changedValue = value === 'underline' ? 'none' : 'underline line-through';\n        }\n        else if (cellValue === 'line-through') {\n            changedValue = value === 'line-through' ? 'none' : 'underline line-through';\n        }\n        else if (cellValue === 'underline line-through') {\n            changedValue = value === 'underline' ? 'line-through' : 'underline';\n            removeProp = true;\n        }\n        if (changedValue === 'none') {\n            removeProp = true;\n        }\n        this.format({ style: { textDecoration: changedValue }, range: activeCellIndexes, refreshRibbon: args.refreshRibbon,\n            onActionUpdate: true });\n        for (var i = indexes[0]; i <= indexes[2]; i++) {\n            for (var j = indexes[1]; j <= indexes[3]; j++) {\n                if (i === activeCellIndexes[0] && j === activeCellIndexes[1]) {\n                    continue;\n                }\n                changedStyle = {};\n                cellValue = this.parent.getCellStyleValue(['textDecoration'], [i, j]).textDecoration;\n                if (cellValue === 'none') {\n                    if (removeProp) {\n                        continue;\n                    }\n                    changedStyle.textDecoration = value;\n                }\n                else if (cellValue === 'underline' || cellValue === 'line-through') {\n                    if (removeProp) {\n                        if (value === cellValue) {\n                            changedStyle.textDecoration = 'none';\n                        }\n                        else {\n                            continue;\n                        }\n                    }\n                    else {\n                        changedStyle.textDecoration = value !== cellValue ? 'underline line-through' : value;\n                    }\n                }\n                else if (cellValue === 'underline line-through') {\n                    if (removeProp) {\n                        changedStyle.textDecoration = value === 'underline' ? 'line-through' : 'underline';\n                    }\n                    else {\n                        continue;\n                    }\n                }\n                this.format({ style: changedStyle, range: [i, j, i, j], refreshRibbon: args.refreshRibbon,\n                    onActionUpdate: true });\n            }\n        }\n    };\n    WorkbookCellFormat.prototype.addEventListener = function () {\n        this.parent.on(setCellFormat, this.format, this);\n        this.parent.on(textDecorationUpdate, this.textDecorationActionUpdate, this);\n    };\n    WorkbookCellFormat.prototype.removeEventListener = function () {\n        if (!this.parent.isDestroyed) {\n            this.parent.off(setCellFormat, this.format);\n            this.parent.off(textDecorationUpdate, this.textDecorationActionUpdate);\n        }\n    };\n    /**\n     * To destroy workbook cell format.\n     */\n    WorkbookCellFormat.prototype.destroy = function () {\n        this.removeEventListener();\n        this.parent = null;\n    };\n    /**\n     * Get the workbook cell format module name.\n     */\n    WorkbookCellFormat.prototype.getModuleName = function () {\n        return 'workbookcellformat';\n    };\n    return WorkbookCellFormat;\n}());\nexport { WorkbookCellFormat };\n","import { getCell, getSheet } from '../base/index';\nimport { workbookEditOperation, checkDateFormat, workbookFormulaOperation } from '../common/event';\nimport { getRangeIndexes } from '../common/index';\nimport { isNullOrUndefined } from '@syncfusion/ej2-base';\nimport { checkIsFormula } from '../../workbook/common/index';\n/**\n * The `WorkbookEdit` module is used to handle the editing functionalities in Workbook.\n */\nvar WorkbookEdit = /** @class */ (function () {\n    /**\n     * Constructor for edit module in Workbook.\n     * @private\n     */\n    function WorkbookEdit(workbook) {\n        this.parent = workbook;\n        this.addEventListener();\n    }\n    /**\n     * To destroy the edit module.\n     * @return {void}\n     * @hidden\n     */\n    WorkbookEdit.prototype.destroy = function () {\n        this.removeEventListener();\n        this.parent = null;\n    };\n    WorkbookEdit.prototype.addEventListener = function () {\n        this.parent.on(workbookEditOperation, this.performEditOperation, this);\n    };\n    WorkbookEdit.prototype.removeEventListener = function () {\n        if (!this.parent.isDestroyed) {\n            this.parent.off(workbookEditOperation, this.performEditOperation);\n        }\n    };\n    /**\n     * Get the module name.\n     * @returns string\n     * @private\n     */\n    WorkbookEdit.prototype.getModuleName = function () {\n        return 'workbookEdit';\n    };\n    WorkbookEdit.prototype.performEditOperation = function (args) {\n        var action = args.action;\n        switch (action) {\n            case 'updateCellValue':\n                this.updateCellValue(args.address, args.value, args.sheetIndex, args.isValueOnly);\n                break;\n        }\n    };\n    WorkbookEdit.prototype.updateCellValue = function (address, value, sheetIdx, isValueOnly) {\n        if (isValueOnly === void 0) { isValueOnly = false; }\n        if (!sheetIdx) {\n            sheetIdx = this.parent.activeSheetTab;\n        }\n        var range;\n        if (typeof address === 'string') {\n            range = getRangeIndexes(address);\n        }\n        else {\n            range = address;\n        }\n        var sheet = getSheet(this.parent, sheetIdx - 1);\n        if (!sheet.rows[range[0]]) {\n            sheet.rows[range[0]] = {};\n            sheet.rows[range[0]].cells = [];\n        }\n        if (!sheet.rows[range[0]].cells[range[1]]) {\n            sheet.rows[range[0]].cells[range[1]] = {};\n        }\n        var cell = getCell(range[0], range[1], sheet);\n        if (!isValueOnly) {\n            var isFormula = checkIsFormula(value);\n            if (!isFormula) {\n                cell.formula = '';\n                cell.value = value;\n            }\n            var eventArgs = {\n                action: 'refreshCalculate',\n                value: value,\n                rowIndex: range[0],\n                colIndex: range[1],\n                sheetIndex: sheetIdx,\n                isFormula: isFormula\n            };\n            this.parent.notify(workbookFormulaOperation, eventArgs);\n            if (isFormula) {\n                cell.formula = eventArgs.value;\n                value = cell.value;\n            }\n            var dateEventArgs = {\n                value: value,\n                rowIndex: range[0],\n                colIndex: range[1],\n                sheetIndex: sheetIdx,\n                updatedVal: ''\n            };\n            this.parent.notify(checkDateFormat, dateEventArgs);\n            if (!isNullOrUndefined(dateEventArgs.updatedVal)) {\n                cell.value = dateEventArgs.updatedVal;\n                this.parent.setProperties({ 'sheets': this.parent.sheets }, true);\n            }\n        }\n        else {\n            cell.value = value;\n            this.parent.setProperties({ 'sheets': this.parent.sheets }, true);\n        }\n    };\n    return WorkbookEdit;\n}());\nexport { WorkbookEdit };\n","import { Workbook, DataBind } from '../index';\nimport { WorkbookSave, WorkbookFormula, WorkbookOpen } from '../integrations/index';\nimport { WorkbookNumberFormat } from '../integrations/number-format';\nimport { WorkbookEdit, WorkbookCellFormat } from '../actions/index';\n/**\n * Workbook basic module.\n * @private\n */\nvar WorkbookBasicModule = /** @class */ (function () {\n    /**\n     * Constructor for Workbook basic module.\n     * @private\n     */\n    function WorkbookBasicModule() {\n        Workbook.Inject(DataBind, WorkbookSave, WorkbookOpen, WorkbookNumberFormat, WorkbookCellFormat, WorkbookEdit, WorkbookFormula);\n    }\n    /**\n     * For internal use only - Get the module name.\n     * @private\n     */\n    WorkbookBasicModule.prototype.getModuleName = function () {\n        return 'workbookBasic';\n    };\n    /**\n     * Destroys the Workbook basic module.\n     * @return {void}\n     */\n    WorkbookBasicModule.prototype.destroy = function () {\n        /* code snippet */\n    };\n    return WorkbookBasicModule;\n}());\nexport { WorkbookBasicModule };\n","import { Workbook, DataBind } from '../../workbook/index';\nimport { WorkbookSave, WorkbookNumberFormat, WorkbookFormula, WorkbookOpen } from '../integrations/index';\nimport { WorkbookEdit, WorkbookCellFormat } from '../actions/index';\n/**\n * Workbook all module.\n * @private\n */\nvar WorkbookAllModule = /** @class */ (function () {\n    /**\n     * Constructor for Workbook all module.\n     * @private\n     */\n    function WorkbookAllModule() {\n        Workbook.Inject(DataBind, WorkbookSave, WorkbookNumberFormat, WorkbookCellFormat, WorkbookEdit, WorkbookFormula, WorkbookOpen);\n    }\n    /**\n     * For internal use only - Get the module name.\n     * @private\n     */\n    WorkbookAllModule.prototype.getModuleName = function () {\n        return 'workbook-all';\n    };\n    /**\n     * Destroys the Workbook all module.\n     * @return {void}\n     */\n    WorkbookAllModule.prototype.destroy = function () {\n        /* code snippet */\n    };\n    return WorkbookAllModule;\n}());\nexport { WorkbookAllModule };\n","var __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    }\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nimport { ChildProperty, Property } from '@syncfusion/ej2-base';\n/**\n * Represents the cell style.\n */\nvar CellStyle = /** @class */ (function (_super) {\n    __extends(CellStyle, _super);\n    function CellStyle() {\n        return _super !== null && _super.apply(this, arguments) || this;\n    }\n    __decorate([\n        Property('Calibri')\n    ], CellStyle.prototype, \"fontFamily\", void 0);\n    __decorate([\n        Property('bottom')\n    ], CellStyle.prototype, \"verticalAlign\", void 0);\n    __decorate([\n        Property('left')\n    ], CellStyle.prototype, \"textAlign\", void 0);\n    __decorate([\n        Property('0pt')\n    ], CellStyle.prototype, \"textIndent\", void 0);\n    __decorate([\n        Property('#000000')\n    ], CellStyle.prototype, \"color\", void 0);\n    __decorate([\n        Property('#ffffff')\n    ], CellStyle.prototype, \"backgroundColor\", void 0);\n    __decorate([\n        Property('normal')\n    ], CellStyle.prototype, \"fontWeight\", void 0);\n    __decorate([\n        Property('normal')\n    ], CellStyle.prototype, \"fontStyle\", void 0);\n    __decorate([\n        Property('11pt')\n    ], CellStyle.prototype, \"fontSize\", void 0);\n    __decorate([\n        Property('none')\n    ], CellStyle.prototype, \"textDecoration\", void 0);\n    return CellStyle;\n}(ChildProperty));\nexport { CellStyle };\n/**\n * Represents the DefineName.\n */\nvar DefineName = /** @class */ (function (_super) {\n    __extends(DefineName, _super);\n    function DefineName() {\n        return _super !== null && _super.apply(this, arguments) || this;\n    }\n    __decorate([\n        Property('')\n    ], DefineName.prototype, \"name\", void 0);\n    __decorate([\n        Property('')\n    ], DefineName.prototype, \"scope\", void 0);\n    __decorate([\n        Property('')\n    ], DefineName.prototype, \"comment\", void 0);\n    __decorate([\n        Property('')\n    ], DefineName.prototype, \"refersTo\", void 0);\n    return DefineName;\n}(ChildProperty));\nexport { DefineName };\n","var __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    }\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nvar __assign = (this && this.__assign) || function () {\n    __assign = Object.assign || function(t) {\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\n            s = arguments[i];\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\n                t[p] = s[p];\n        }\n        return t;\n    };\n    return __assign.apply(this, arguments);\n};\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nimport { Component, Property, NotifyPropertyChanges, Collection, Complex } from '@syncfusion/ej2-base';\nimport { Event, merge } from '@syncfusion/ej2-base';\nimport { Sheet, initSheet, getSheet, getSheetIndexFromId, getSheetNameCount, getMaxSheetId } from './sheet';\nimport { getWorkbookRequiredModules } from '../common/module';\nimport { getData, clearRange } from './data';\nimport { DefineName, CellStyle, updateUsedRange } from '../common/index';\nimport * as events from '../common/event';\nimport { setCellFormat, sheetCreated } from '../common/index';\nimport { getCell, skipDefaultValue } from './cell';\n/**\n * Represents the Workbook.\n */\nvar Workbook = /** @class */ (function (_super) {\n    __extends(Workbook, _super);\n    /**\n     * Constructor for initializing the library.\n     * @param options - Configures Workbook model.\n     */\n    function Workbook(options) {\n        var _this = _super.call(this, options) || this;\n        /**\n         * To generate sheet name based on sheet count.\n         * @hidden\n         */\n        _this.sheetNameCount = 1;\n        _this.commonCellStyle = {};\n        if (options && options.cellStyle) {\n            _this.commonCellStyle = options.cellStyle;\n        }\n        if (_this.getModuleName() === 'workbook') {\n            _this.dataBind();\n            _this.initEmptySheet();\n        }\n        return _this;\n    }\n    /**\n     * For internal use only.\n     * @returns void\n     * @hidden\n     */\n    Workbook.prototype.preRender = function () {\n        if (!Object.keys(this.commonCellStyle).length) {\n            this.commonCellStyle = skipDefaultValue(this.cellStyle, true);\n        }\n        if (this.getModuleName() === 'spreadsheet') {\n            this.initEmptySheet();\n        }\n    };\n    /**\n     * For internal use only.\n     * @returns void\n     * @hidden\n     */\n    Workbook.prototype.render = function () {\n        /** code snippets */\n    };\n    /**\n     * To provide the array of modules needed for workbook.\n     * @return {ModuleDeclaration[]}\n     * @hidden\n     */\n    Workbook.prototype.requiredModules = function () {\n        return getWorkbookRequiredModules(this);\n    };\n    /**\n     * Get the properties to be maintained in the persisted state.\n     * @returns string\n     * @hidden\n     */\n    Workbook.prototype.getPersistData = function () {\n        return this.addOnPersist([]);\n    };\n    /**\n     * Applies the style (font family, font weight, background color, etc...) to the specified range of cells.\n     * @param {CellStyleModel} style - Specifies the cell style.\n     * @param {string} range? - Specifies the address for the range of cells.\n     */\n    Workbook.prototype.cellFormat = function (style, range) {\n        var sheet = this.getActiveSheet();\n        range = range || sheet.selectedRange;\n        this.notify(setCellFormat, { style: style, range: range, refreshRibbon: range.indexOf(sheet.activeCell) > -1 ? true : false });\n    };\n    /** @hidden */\n    Workbook.prototype.getCellStyleValue = function (cssProps, indexes) {\n        var _this = this;\n        var cell = getCell(indexes[0], indexes[1], this.getActiveSheet());\n        var style = {};\n        cssProps.forEach(function (cssProp) {\n            style[cssProp] = _this.cellStyle[cssProp];\n            if (cell && cell.style && cell.style[cssProp]) {\n                style[cssProp] = cell.style[cssProp];\n            }\n        });\n        return style;\n    };\n    /**\n     * Applies the number format (number, currency, percentage, short date, etc...) to the specified range of cells.\n     * @param {string} format - Specifies the number format code.\n     * @param {string} range? - Specifies the address for the range of cells.\n     */\n    Workbook.prototype.numberFormat = function (format, range) {\n        this.notify(events.applyNumberFormatting, { format: format, range: range });\n    };\n    /**\n     * Used to create new sheet.\n     * @hidden\n     */\n    Workbook.prototype.createSheet = function (index) {\n        var sheet = new Sheet(this, 'sheets', { id: getMaxSheetId(this.sheets), name: 'Sheet' + getSheetNameCount(this) }, true);\n        if (index > -1) {\n            this.sheets.splice(index, 0, sheet);\n        }\n        else {\n            this.sheets.push(sheet);\n        }\n        this.setProperties({ 'sheet': this.sheets }, true);\n        this.notify(sheetCreated, { sheetIndex: index | 0 });\n        this.notify(events.workbookFormulaOperation, { action: 'registerSheet', sheetIndex: this.sheets.length - 1 });\n    };\n    /**\n     * Used to remove sheet.\n     * @hidden\n     */\n    Workbook.prototype.removeSheet = function (idx) {\n        this.sheets.splice(idx, 1);\n    };\n    /**\n     * Destroys the Workbook library.\n     */\n    Workbook.prototype.destroy = function () {\n        this.notify(events.workbookDestroyed, null);\n        _super.prototype.destroy.call(this);\n    };\n    /**\n     * Called internally if any of the property value changed.\n     * @param  {WorkbookModel} newProp\n     * @param  {WorkbookModel} oldProp\n     * @returns void\n     * @hidden\n     */\n    Workbook.prototype.onPropertyChanged = function (newProp, oldProp) {\n        for (var _i = 0, _a = Object.keys(newProp); _i < _a.length; _i++) {\n            var prop = _a[_i];\n            switch (prop) {\n                case 'cellStyle':\n                    merge(this.commonCellStyle, skipDefaultValue(newProp.cellStyle));\n                    break;\n            }\n        }\n    };\n    /**\n     * Not applicable for workbook.\n     * @hidden\n     */\n    Workbook.prototype.appendTo = function (selector) {\n        _super.prototype.appendTo.call(this, selector);\n    };\n    Workbook.prototype.initEmptySheet = function () {\n        var len = this.sheets.length;\n        if (len) {\n            initSheet(this);\n        }\n        else {\n            this.createSheet();\n        }\n    };\n    /** @hidden */\n    Workbook.prototype.getActiveSheet = function () {\n        return this.sheets[this.activeSheetTab - 1];\n    };\n    /**\n     * Used for setting the used range row and column index.\n     * @hidden\n     */\n    Workbook.prototype.setUsedRange = function (rowIdx, colIdx) {\n        var sheet = this.getActiveSheet();\n        if (rowIdx > sheet.usedRange.rowIndex) {\n            sheet.usedRange.rowIndex = rowIdx;\n            this.setProperties({ 'sheets': this.sheets }, true);\n            this.notify(updateUsedRange, { index: rowIdx, update: 'row' });\n        }\n        if (colIdx > sheet.usedRange.colIndex) {\n            sheet.usedRange.colIndex = colIdx;\n            this.setProperties({ 'sheets': this.sheets }, true);\n            this.notify(updateUsedRange, { index: colIdx, update: 'col' });\n        }\n    };\n    /** @hidden */\n    Workbook.prototype.getRangeData = function (cellIndexes, sheetIdx) {\n        var sheet;\n        if (sheetIdx) {\n            sheet = getSheet(this, sheetIdx - 1);\n        }\n        else {\n            sheet = this.getActiveSheet();\n        }\n        var row = cellIndexes[0];\n        var col = cellIndexes[1];\n        var values = '';\n        if (sheet.rows[row] && sheet.rows[row].cells[col]) {\n            values = sheet.rows[row].cells[col].value;\n        }\n        return values;\n    };\n    /**\n     * Gets the range of data as JSON from the specified address.\n     * @param {string} address - Specifies the address for range of cells.\n     */\n    Workbook.prototype.getData = function (address) {\n        return getData(this, address);\n    };\n    /**\n     * Get component name.\n     * @returns string\n     * @hidden\n     */\n    Workbook.prototype.getModuleName = function () {\n        return 'workbook';\n    };\n    /** @hidden */\n    Workbook.prototype.getValueRowCol = function (sheetIndex, rowIndex, colIndex) {\n        sheetIndex = getSheetIndexFromId(this, sheetIndex);\n        var sheet = getSheet(this, sheetIndex - 1);\n        var cell = getCell(rowIndex - 1, colIndex - 1, sheet);\n        return (cell && cell.value) || '';\n    };\n    /** @hidden */\n    Workbook.prototype.setValueRowCol = function (sheetIndex, value, rowIndex, colIndex) {\n        sheetIndex = getSheetIndexFromId(this, sheetIndex);\n        this.notify(events.workbookEditOperation, {\n            action: 'updateCellValue', address: [rowIndex - 1, colIndex - 1], value: value,\n            sheetIndex: sheetIndex, isValueOnly: true\n        });\n    };\n    /**\n     * Opens the specified excel file or stream.\n     * @param {OpenOptions} options - Options for opening the excel file.\n     */\n    Workbook.prototype.open = function (options) {\n        this.notify(events.workbookOpen, options);\n    };\n    /**\n     * Saves the Spreadsheet data to Excel file.\n     * @param {SaveOptions} saveOptions - Options for saving the excel file.\n     */\n    Workbook.prototype.save = function (saveOptions) {\n        if (saveOptions === void 0) { saveOptions = {}; }\n        if (this.allowSave) {\n            var defaultProps = {\n                url: this.saveUrl,\n                fileName: saveOptions.fileName || 'Sample',\n                saveType: 'Xlsx'\n            };\n            var eventArgs = __assign({}, defaultProps, saveOptions, { customParams: {}, isFullPost: true, needBlobData: false, cancel: false });\n            this.trigger('beforeSave', eventArgs);\n            if (!eventArgs.cancel) {\n                this.notify(events.beginSave, {\n                    saveSettings: eventArgs, isFullPost: eventArgs.isFullPost,\n                    needBlobData: eventArgs.needBlobData, customParams: eventArgs.customParams\n                });\n            }\n        }\n    };\n    /**\n     * Adds the defined name to the Spreadsheet.\n     * @param {DefineNameModel} definedName - Specifies the name.\n     * @return {boolean} - Return the added status of the defined name.\n     */\n    Workbook.prototype.addDefinedName = function (definedName) {\n        var eventArgs = {\n            action: 'addDefinedName',\n            isAdded: false,\n            definedName: definedName\n        };\n        this.notify(events.workbookFormulaOperation, eventArgs);\n        return eventArgs.isAdded;\n    };\n    /**\n     * Removes the defined name from the Spreadsheet.\n     * @param {string} definedName - Specifies the name.\n     * @param {string} scope - Specifies the scope of the defined name.\n     * @return {boolean} - Return the removed status of the defined name.\n     */\n    Workbook.prototype.removeDefinedName = function (definedName, scope) {\n        if (scope === void 0) { scope = ''; }\n        var eventArgs = {\n            action: 'removeDefinedName',\n            isRemoved: false,\n            definedName: definedName,\n            scope: scope\n        };\n        this.notify(events.workbookFormulaOperation, eventArgs);\n        return eventArgs.isRemoved;\n    };\n    /** @hidden */\n    Workbook.prototype.clearRange = function (address, sheetIndex, valueOnly) {\n        if (valueOnly === void 0) { valueOnly = true; }\n        address = address ? address : this.getActiveSheet().selectedRange;\n        sheetIndex = sheetIndex ? sheetIndex : this.activeSheetTab;\n        clearRange(this, address, sheetIndex, valueOnly);\n    };\n    __decorate([\n        Collection([], Sheet)\n    ], Workbook.prototype, \"sheets\", void 0);\n    __decorate([\n        Property(1)\n    ], Workbook.prototype, \"activeSheetTab\", void 0);\n    __decorate([\n        Property('100%')\n    ], Workbook.prototype, \"height\", void 0);\n    __decorate([\n        Property('100%')\n    ], Workbook.prototype, \"width\", void 0);\n    __decorate([\n        Property(true)\n    ], Workbook.prototype, \"showRibbon\", void 0);\n    __decorate([\n        Property(true)\n    ], Workbook.prototype, \"showFormulaBar\", void 0);\n    __decorate([\n        Property(true)\n    ], Workbook.prototype, \"showSheetTabs\", void 0);\n    __decorate([\n        Property(true)\n    ], Workbook.prototype, \"allowEditing\", void 0);\n    __decorate([\n        Property(true)\n    ], Workbook.prototype, \"allowOpen\", void 0);\n    __decorate([\n        Property(true)\n    ], Workbook.prototype, \"allowSave\", void 0);\n    __decorate([\n        Property(true)\n    ], Workbook.prototype, \"allowNumberFormatting\", void 0);\n    __decorate([\n        Property(true)\n    ], Workbook.prototype, \"allowCellFormatting\", void 0);\n    __decorate([\n        Complex({}, CellStyle)\n    ], Workbook.prototype, \"cellStyle\", void 0);\n    __decorate([\n        Property('')\n    ], Workbook.prototype, \"openUrl\", void 0);\n    __decorate([\n        Property('')\n    ], Workbook.prototype, \"saveUrl\", void 0);\n    __decorate([\n        Collection([], DefineName)\n    ], Workbook.prototype, \"definedNames\", void 0);\n    __decorate([\n        Event()\n    ], Workbook.prototype, \"beforeOpen\", void 0);\n    __decorate([\n        Event()\n    ], Workbook.prototype, \"openFailure\", void 0);\n    __decorate([\n        Event()\n    ], Workbook.prototype, \"beforeSave\", void 0);\n    __decorate([\n        Event()\n    ], Workbook.prototype, \"saveComplete\", void 0);\n    __decorate([\n        Event()\n    ], Workbook.prototype, \"beforeCellFormat\", void 0);\n    Workbook = __decorate([\n        NotifyPropertyChanges\n    ], Workbook);\n    return Workbook;\n}(Component));\nexport { Workbook };\n","/**\n * Specifies spreadsheet internal events\n */\n/** @hidden */\nexport var ribbon = 'ribbon';\n/** @hidden */\nexport var formulaBar = 'formulaBar';\n/** @hidden */\nexport var sheetTabs = 'sheetTabs';\n/** @hidden */\nexport var refreshSheetTabs = 'refreshSheetTabs';\n/** @hidden */\nexport var dataRefresh = 'dataRefresh';\n/** @hidden */\nexport var initialLoad = 'initialLoad';\n/** @hidden */\nexport var contentLoaded = 'contentLoaded';\n/** @hidden */\nexport var mouseDown = 'mouseDown';\n/** @hidden */\nexport var spreadsheetDestroyed = 'spreadsheetDestroyed';\n/** @hidden */\nexport var editOperation = 'editOperation';\n/** @hidden */\nexport var formulaOperation = 'formulaOperation';\n/** @hidden */\nexport var formulaBarOperation = 'formulaBarOperation';\n/** @hidden */\nexport var click = 'click';\n/** @hidden */\nexport var keyUp = 'keyUp';\n/** @hidden */\nexport var keyDown = 'keyDown';\n/** @hidden */\nexport var formulaKeyUp = 'formulaKeyUp';\n/** @hidden */\nexport var formulaBarUpdate = 'formulaBarUpdate';\n/** @hidden */\nexport var onVerticalScroll = 'verticalScroll';\n/** @hidden */\nexport var onHorizontalScroll = 'horizontalScroll';\n/** @hidden */\nexport var beforeContentLoaded = 'beforeContentLoaded';\n/** @hidden */\nexport var beforeVirtualContentLoaded = 'beforeVirtualContentLoaded';\n/** @hidden */\nexport var virtualContentLoaded = 'virtualContentLoaded';\n/** @hidden */\nexport var contextMenuOpen = 'contextMenuOpen';\n/** @hidden */\nexport var cellNavigate = 'cellNavigate';\n/** @hidden */\nexport var mouseUpAfterSelection = 'mouseUpAfterSelection';\n/** @hidden */\nexport var selectionComplete = 'selectionComplete';\n/** @hidden */\nexport var cMenuBeforeOpen = 'contextmenuBeforeOpen';\n/** @hidden */\nexport var addSheetTab = 'addSheetTab';\n/** @hidden */\nexport var removeSheetTab = 'removeSheetTab';\n/** @hidden */\nexport var renameSheetTab = 'renameSheetTab';\n/** @hidden */\nexport var ribbonClick = 'ribboClick';\n/** @hidden */\nexport var refreshRibbon = 'ribbonRefresh';\n/** @hidden */\nexport var enableRibbonItems = 'enableRibbonItems';\n/** @hidden */\nexport var tabSwitch = 'tabSwitch';\n/** @hidden */\nexport var selectRange = 'selectRange';\n/** @hidden */\nexport var cut = 'cut';\n/** @hidden */\nexport var copy = 'copy';\n/** @hidden */\nexport var paste = 'paste';\n/** @hidden */\nexport var clearCopy = 'clearCopy';\n/** @hidden */\nexport var dataBound = 'dataBound';\n/** @hidden */\nexport var beforeDataBound = 'beforeDataBound';\n/** @hidden */\nexport var addContextMenuItems = 'addContextMenuItems';\n/** @hidden */\nexport var removeContextMenuItems = 'removeContextMenuItems';\n/** @hidden */\nexport var enableContextMenuItems = 'enableContextMenuItems';\n/** @hidden */\nexport var beforeRibbonCreate = 'beforeRibbonCreate';\n/** @hidden */\nexport var rowHeightChanged = 'rowHeightChanged';\n/** @hidden */\nexport var beforeHeaderLoaded = 'beforeHeaderLoaded';\n/** @hidden */\nexport var onContentScroll = 'onContentScroll';\n/** @hidden */\nexport var deInitProperties = 'deInitProperties';\n/** @hidden */\nexport var activeSheetChanged = 'activeSheetChanged';\n/** @hidden */\nexport var renameSheet = 'renameSheet';\n/** @hidden */\nexport var enableToolbar = 'enableToolbar';\n","import { detach, EventHandler, Browser, extend } from '@syncfusion/ej2-base';\nimport { getRangeIndexes, getCell, setCell, getSheet, getSwapRange } from '../../workbook/index';\nimport { getFormattedCellObject, workbookFormulaOperation, applyCellFormat, checkIsFormula } from '../../workbook/index';\nimport { ribbonClick, cut, copy, paste, enableRibbonItems, rowHeightChanged } from '../common/index';\nimport { clearCopy, locateElem, selectRange, dialog, contentLoaded, tabSwitch, cMenuBeforeOpen, locale } from '../common/index';\n/**\n * Represents clipboard support for Spreadsheet.\n */\nvar Clipboard = /** @class */ (function () {\n    function Clipboard(parent) {\n        this.parent = parent;\n        this.init();\n        this.addEventListener();\n    }\n    Clipboard.prototype.init = function () {\n        this.parent.element\n            .appendChild(this.parent.createElement('input', { className: 'e-clipboard', attrs: { 'contenteditable': 'true' } }));\n    };\n    Clipboard.prototype.addEventListener = function () {\n        var ele = this.getClipboardEle();\n        this.parent.on(cut, this.cut, this);\n        this.parent.on(copy, this.copy, this);\n        this.parent.on(paste, this.paste, this);\n        this.parent.on(clearCopy, this.clearCopiedInfo, this);\n        this.parent.on(tabSwitch, this.tabSwitchHandler, this);\n        this.parent.on(cMenuBeforeOpen, this.cMenuBeforeOpenHandler, this);\n        this.parent.on(ribbonClick, this.ribbonClickHandler, this);\n        this.parent.on(contentLoaded, this.initCopyIndicator, this);\n        this.parent.on(rowHeightChanged, this.rowHeightChanged, this);\n        EventHandler.add(ele, 'cut', this.cut, this);\n        EventHandler.add(ele, 'copy', this.copy, this);\n        EventHandler.add(ele, 'paste', this.paste, this);\n    };\n    Clipboard.prototype.removeEventListener = function () {\n        var ele = this.getClipboardEle();\n        if (!this.parent.isDestroyed) {\n            this.parent.off(cut, this.cut);\n            this.parent.off(copy, this.copy);\n            this.parent.off(paste, this.paste);\n            this.parent.off(clearCopy, this.clearCopiedInfo);\n            this.parent.off(tabSwitch, this.tabSwitchHandler);\n            this.parent.off(cMenuBeforeOpen, this.cMenuBeforeOpenHandler);\n            this.parent.off(ribbonClick, this.ribbonClickHandler);\n            this.parent.off(contentLoaded, this.initCopyIndicator);\n            this.parent.off(rowHeightChanged, this.rowHeightChanged);\n        }\n        EventHandler.remove(ele, 'cut', this.cut);\n        EventHandler.remove(ele, 'copy', this.copy);\n        EventHandler.remove(ele, 'paste', this.paste);\n    };\n    Clipboard.prototype.ribbonClickHandler = function (args) {\n        var parentId = this.parent.element.id;\n        switch (args.item.id) {\n            case parentId + '_cut':\n                this.cut({ isClick: true });\n                break;\n            case parentId + '_copy':\n                this.copy({ isClick: true });\n                break;\n        }\n        this.parent.element.focus();\n    };\n    Clipboard.prototype.tabSwitchHandler = function (args) {\n        if (args.idx === 1 && !this.copiedInfo) {\n            this.hidePaste();\n        }\n    };\n    Clipboard.prototype.cMenuBeforeOpenHandler = function (e) {\n        if (e.target === 'Content' || e.target === 'Header') {\n            this.parent.enableContextMenuItems(['Paste', 'Paste Special'], this.copiedInfo ? true : false);\n        }\n    };\n    Clipboard.prototype.rowHeightChanged = function (args) {\n        if (this.copiedInfo && this.copiedInfo.range[0] > args.rowIdx) {\n            var ele = this.parent.element.getElementsByClassName('e-copy-indicator')[0];\n            ele.style.top = parseInt(ele.style.top, 10) + args.threshold + \"px\";\n        }\n    };\n    Clipboard.prototype.cut = function (args) {\n        this.setCopiedInfo(args, true);\n    };\n    Clipboard.prototype.copy = function (args) {\n        this.setCopiedInfo(args, false);\n    };\n    Clipboard.prototype.paste = function (args) {\n        if (this.parent.isEdit) {\n            if (args && args.type) {\n                args.preventDefault();\n                document.getElementById(this.parent.element.id + '_edit').focus();\n                return;\n            }\n        }\n        /* tslint:disable-next-line */\n        var isExternal = !this.copiedInfo && ((args && args.clipboardData) || window['clipboardData']);\n        var copiedIdx = this.getCopiedIdx();\n        if (this.copiedInfo || isExternal) {\n            var cell = void 0;\n            var isExtend = void 0;\n            var cSIdx = (args && args.sIdx > -1) ? args.sIdx : this.parent.activeSheetTab - 1;\n            var curSheet = getSheet(this.parent, cSIdx);\n            var prevSheet = getSheet(this.parent, isExternal ? cSIdx : copiedIdx);\n            var selIdx = getSwapRange(args && args.range || getRangeIndexes(curSheet.selectedRange));\n            var rows = isExternal && this.getExternalCells(args);\n            if (isExternal && !rows.length) { // If image pasted\n                return;\n            }\n            var rowIdx = selIdx[0];\n            var cIdx = isExternal\n                ? [0, 0, rows.length - 1, rows[0].cells.length - 1] : getSwapRange(this.copiedInfo.range);\n            var isRepeative = (selIdx[2] - selIdx[0] + 1) % (cIdx[2] - cIdx[0] + 1) === 0\n                && (selIdx[3] - selIdx[1] + 1) % (cIdx[3] - cIdx[1] + 1) === 0;\n            var rfshRange = isRepeative ? selIdx : [selIdx[0], selIdx[1]]\n                .concat([selIdx[0] + cIdx[2] - cIdx[0], selIdx[1] + cIdx[3] - cIdx[1] || selIdx[1]]);\n            for (var i = cIdx[0], l = 0; i <= cIdx[2]; i++, l++) {\n                for (var j = cIdx[1], k = 0; j <= cIdx[3]; j++, k++) {\n                    cell = isExternal ? rows[i].cells[j] : getCell(i, j, prevSheet);\n                    if (cell && args && args.type) {\n                        switch (args.type) {\n                            case 'Formats':\n                                cell = { format: cell.format, style: cell.style };\n                                break;\n                            case 'Values':\n                                cell = { value: cell.value };\n                                break;\n                        }\n                        isExtend = ['Formats', 'Values'].indexOf(args.type) > -1;\n                    }\n                    if ((!this.parent.scrollSettings.isFinite && (cIdx[2] - cIdx[0] > (1048575 - selIdx[0])\n                        || cIdx[3] - cIdx[1] > (16383 - selIdx[1])))\n                        || (this.parent.scrollSettings.isFinite && (cIdx[2] - cIdx[0] > (curSheet.rowCount - 1 - selIdx[0])\n                            || cIdx[3] - cIdx[1] > (curSheet.colCount - 1 - selIdx[1])))) {\n                        this.showDialog();\n                        return;\n                    }\n                    if (isRepeative) {\n                        for (var x = selIdx[0]; x <= selIdx[2]; x += (cIdx[2] - cIdx[0]) + 1) {\n                            for (var y = selIdx[1]; y <= selIdx[3]; y += (cIdx[3] - cIdx[1] + 1)) {\n                                this.setCell(x + l, y + k, curSheet, cell, isExtend);\n                            }\n                        }\n                    }\n                    else {\n                        this.setCell(rowIdx, selIdx[1] + k, curSheet, cell, isExtend);\n                    }\n                    if (!isExternal && this.copiedInfo.isCut) {\n                        this.setCell(i, j, prevSheet, getCell(i, j, prevSheet), false, true);\n                    }\n                }\n                rowIdx++;\n            }\n            if (cSIdx === this.parent.activeSheetTab - 1) {\n                this.parent.serviceLocator.getService('cell').refreshRange(rfshRange);\n                this.parent.notify(selectRange, rfshRange);\n            }\n            if (!isExternal && this.copiedInfo.isCut) {\n                if (copiedIdx === this.parent.activeSheetTab - 1) {\n                    this.parent.serviceLocator.getService('cell').refreshRange(cIdx);\n                }\n                this.clearCopiedInfo();\n            }\n            if (isExternal || (args && args.isClick)) {\n                this.parent.element.focus();\n            }\n        }\n        else {\n            this.getClipboardEle().select();\n        }\n    };\n    Clipboard.prototype.setCell = function (rIdx, cIdx, sheet, cell, isExtend, isCut) {\n        setCell(rIdx, cIdx, sheet, isCut ? null : cell, isExtend);\n        if (cell && cell.formula) {\n            this.parent.notify(workbookFormulaOperation, {\n                action: 'refreshCalculate', value: isCut ? '' : cell.formula, rowIndex: rIdx,\n                colIndex: cIdx, sheetIndex: this.parent.activeSheetTab, isFormula: true\n            });\n        }\n        if (isCut && cell && cell.style) {\n            this.parent.notify(applyCellFormat, {\n                style: extend({}, this.getEmptyStyle(cell.style), this.parent.commonCellStyle), rowIdx: rIdx, colIdx: cIdx, cell: null,\n                lastCell: null, row: null, hRow: null, isHeightCheckNeeded: true, manualUpdate: false\n            });\n        }\n    };\n    Clipboard.prototype.getEmptyStyle = function (cellStyle) {\n        var style = {};\n        Object.keys(cellStyle).forEach(function (key) {\n            style[key] = '';\n        });\n        return style;\n    };\n    Clipboard.prototype.getCopiedIdx = function () {\n        if (this.copiedInfo) {\n            for (var i = 0; i < this.parent.sheets.length; i++) {\n                if (this.parent.sheets[i].id === this.copiedInfo.sId) {\n                    return i;\n                }\n            }\n            this.clearCopiedInfo();\n        }\n        return -1;\n    };\n    Clipboard.prototype.setCopiedInfo = function (args, isCut) {\n        var _this = this;\n        if (this.parent.isEdit) {\n            return;\n        }\n        var sheet = this.parent.getActiveSheet();\n        var range = (args && args.range) || getRangeIndexes(sheet.selectedRange);\n        var option = {\n            sheet: sheet, indexes: [0, 0, sheet.rowCount - 1, sheet.colCount - 1], promise: new Promise(function (resolve, reject) { resolve((function () { })()); })\n        };\n        if (sheet.isLocalData && !(args && args.clipboardData) && range[0] === 0 && range[2] === (sheet.rowCount - 1)) {\n            this.parent.showSpinner();\n            this.parent.notify('updateSheetFromDataSource', option);\n        }\n        option.promise.then(function () {\n            if (!(args && args.clipboardData)) {\n                if (_this.copiedInfo) {\n                    _this.clearCopiedInfo();\n                }\n                _this.copiedInfo = {\n                    range: range, sId: (args && args.sId) ? args.sId : sheet.id, isCut: isCut\n                };\n                _this.hidePaste(true);\n                _this.initCopyIndicator();\n                if (!Browser.isIE) {\n                    _this.getClipboardEle().select();\n                }\n                if (args && args.isClick) {\n                    document.execCommand(isCut ? 'cut' : 'copy');\n                }\n                _this.parent.hideSpinner();\n            }\n            if (Browser.isIE) {\n                _this.setExternalCells(args);\n            }\n        });\n        if (args && args.clipboardData) {\n            this.setExternalCells(args);\n            this.parent.element.focus();\n        }\n    };\n    Clipboard.prototype.clearCopiedInfo = function () {\n        if (this.copiedInfo) {\n            if (this.parent.getActiveSheet().id === this.copiedInfo.sId) {\n                detach(this.parent.getMainContent().getElementsByClassName('e-copy-indicator')[0]);\n            }\n            this.copiedInfo = null;\n            this.hidePaste();\n        }\n    };\n    Clipboard.prototype.initCopyIndicator = function () {\n        if (this.copiedInfo && this.parent.getActiveSheet().id === this.copiedInfo.sId) {\n            var copyIndicator = this.parent.createElement('div', { className: 'e-copy-indicator' });\n            locateElem(copyIndicator, this.copiedInfo.range, this.parent.getActiveSheet());\n            this.parent.getMainContent().appendChild(copyIndicator);\n        }\n    };\n    Clipboard.prototype.showDialog = function () {\n        this.parent.serviceLocator.getService(dialog).show({\n            header: 'Spreadsheet',\n            target: this.parent.element,\n            height: 205, width: 340, isModal: true, showCloseIcon: true,\n            content: this.parent.serviceLocator.getService(locale).getConstant('PasteAlert')\n        });\n    };\n    Clipboard.prototype.hidePaste = function (isShow) {\n        this.parent.notify(enableRibbonItems, { id: this.parent.element.id + '_paste', isEnable: isShow || false });\n    };\n    Clipboard.prototype.setExternalCells = function (args) {\n        var cell;\n        var text = '';\n        var range = this.copiedInfo.range;\n        var sheet = this.parent.getActiveSheet();\n        var data = '<html><body><table xmlns=\"http://www.w3.org/1999/xhtml\"><tbody>';\n        for (var i = range[0]; i <= range[2]; i++) {\n            data += '<tr>';\n            for (var j = range[1]; j <= range[3]; j++) {\n                data += '<td style=\"white-space:nowrap;vertical-align:bottom;';\n                cell = getCell(i, j, sheet);\n                if (cell && cell.style) {\n                    Object.keys(cell.style).forEach(function (style) {\n                        var regex = style.match(/[A-Z]/);\n                        data += (style === 'backgroundColor' ? 'background' : (regex ? style.replace(regex[0], '-'\n                            + regex[0].toLowerCase()) : style)) + ':' + ((style === 'backgroundColor' || style === 'color')\n                            ? cell.style[style].slice(0, 7) : cell.style[style]) + ';';\n                    });\n                }\n                data += '\">';\n                if (cell && cell.value) {\n                    var eventArgs = {\n                        formattedText: cell.value,\n                        value: cell.value,\n                        format: cell.format,\n                        onLoad: true\n                    };\n                    if (cell.format) {\n                        this.parent.notify(getFormattedCellObject, eventArgs);\n                    }\n                    data += eventArgs.formattedText;\n                    text += eventArgs.formattedText;\n                }\n                data += '</td>';\n                text += j === range[3] ? '' : '\\t';\n            }\n            data += '</tr>';\n            text += i === range[2] ? '' : '\\n';\n        }\n        data += '</tbody></table></body></html>';\n        if (Browser.isIE) {\n            /* tslint:disable-next-line */\n            window['clipboardData'].setData('text', text);\n        }\n        else {\n            args.clipboardData.setData('text/html', data);\n            args.clipboardData.setData('text/plain', text);\n            args.preventDefault();\n        }\n    };\n    Clipboard.prototype.getExternalCells = function (args) {\n        var _this = this;\n        var html;\n        var text;\n        var rows = [];\n        var cells = [];\n        var cellStyle;\n        var ele = this.parent.createElement('span');\n        if (Browser.isIE) {\n            /* tslint:disable-next-line */\n            text = window['clipboardData'].getData('text');\n        }\n        else {\n            html = args.clipboardData.getData('text/html');\n            text = args.clipboardData.getData('text/plain');\n            ele.innerHTML = html;\n        }\n        if (ele.querySelector('table')) {\n            ele.querySelectorAll('tr').forEach(function (tr) {\n                tr.querySelectorAll('td').forEach(function (td, j) {\n                    cells[j] = { value: td.textContent, style: _this.getStyle(td, ele) };\n                });\n                rows.push({ cells: cells });\n                cells = [];\n            });\n        }\n        else if (text) {\n            if (html) {\n                [].slice.call(ele.children).forEach(function (child) {\n                    if (child.getAttribute('style')) {\n                        cellStyle = _this.getStyle(child, ele);\n                    }\n                });\n            }\n            text.trim().split('\\n').forEach(function (row) {\n                row.split('\\t').forEach(function (col, j) {\n                    cells[j] = { style: cellStyle };\n                    if (checkIsFormula(col)) {\n                        cells[j].formula = col;\n                    }\n                    else {\n                        cells[j].value = col;\n                    }\n                });\n                rows.push({ cells: cells });\n                cells = [];\n            });\n        }\n        setTimeout(function () { _this.getClipboardEle().innerHTML = ''; }, 0);\n        return rows;\n    };\n    Clipboard.prototype.getStyle = function (td, ele) {\n        var styles = [];\n        var cellStyle = {};\n        if (td.classList.length || td.getAttribute('style')) {\n            if (td.classList.length) {\n                styles.push(ele.querySelector('style').innerHTML.split(td.classList[0])[1].split('{')[1].split('}')[0]);\n            }\n            if (td.getAttribute('style')) {\n                styles.push(td.getAttribute('style'));\n            }\n            styles.forEach(function (styles) {\n                styles.split(';').forEach(function (style) {\n                    var char = style.split(':')[0].trim();\n                    if (['font-family', 'vertical-align', 'text-align', 'text-indent', 'color', 'background', 'font-weight', 'font-style',\n                        'font-size', 'text-decoration'].indexOf(char) > -1) {\n                        char = char === 'background' ? 'backgroundColor' : char;\n                        var regex = char.match(/-[a-z]/);\n                        cellStyle[regex ? char.replace(regex[0], regex[0].charAt(1).toUpperCase()) : char] = style.split(':')[1];\n                    }\n                });\n            });\n        }\n        return cellStyle;\n    };\n    Clipboard.prototype.getClipboardEle = function () {\n        return this.parent.element.getElementsByClassName('e-clipboard')[0];\n    };\n    Clipboard.prototype.getModuleName = function () {\n        return 'clipboard';\n    };\n    Clipboard.prototype.destroy = function () {\n        this.removeEventListener();\n        var ele = this.getClipboardEle();\n        detach(ele);\n        this.parent = null;\n    };\n    return Clipboard;\n}());\nexport { Clipboard };\n","import { EventHandler, Browser, closest } from '@syncfusion/ej2-base';\nimport { getRangeIndexes, getRangeFromAddress, getIndexesFromAddress } from '../../workbook/common/address';\nimport { keyDown, editOperation, clearCopy, keyUp, mouseDown, selectionComplete, enableToolbar } from '../common/event';\nimport { formulaBarOperation, formulaOperation } from '../common/event';\nimport { workbookEditOperation, getFormattedBarText, getFormattedCellObject } from '../../workbook/common/event';\nimport { getSheetName, getSheetIndex, getCell } from '../../workbook/base/index';\nimport { getSheetNameFromAddress, getCellPosition, getSheet } from '../../workbook/base/index';\nimport { NumberFormatType } from '../../workbook/index';\n/**\n * The `Edit` module is used to handle the editing functionalities in Spreadsheet.\n */\nvar Edit = /** @class */ (function () {\n    /**\n     * Constructor for edit module in Spreadsheet.\n     * @private\n     */\n    function Edit(parent) {\n        this.editorElem = null;\n        this.editCellData = {};\n        this.isEdit = false;\n        this.isCellEdit = true;\n        this.isNewValueEdit = true;\n        this.keyCodes = {\n            BACKSPACE: 8,\n            SPACE: 32,\n            TAB: 9,\n            DELETE: 46,\n            ESC: 27,\n            ENTER: 13,\n            FIRSTALPHABET: 65,\n            LASTALPHABET: 90,\n            FIRSTNUMBER: 48,\n            LASTNUMBER: 59,\n            FIRSTNUMPAD: 96,\n            LASTNUMPAD: 111,\n            SYMBOLSETONESTART: 186,\n            SYMBOLSETONEEND: 192,\n            SYMBOLSETTWOSTART: 219,\n            SYMBOLSETTWOEND: 222,\n            FIREFOXEQUALPLUS: 61,\n            FIREFOXMINUS: 173,\n            F2: 113\n        };\n        this.parent = parent;\n        this.init();\n        //Spreadsheet.Inject(WorkbookEdit);\n    }\n    Edit.prototype.init = function () {\n        this.addEventListener();\n    };\n    /**\n     * To destroy the edit module.\n     * @return {void}\n     * @hidden\n     */\n    Edit.prototype.destroy = function () {\n        this.removeEventListener();\n        this.parent = null;\n        this.editorElem = null;\n    };\n    Edit.prototype.addEventListener = function () {\n        EventHandler.add(this.parent.element, 'dblclick', this.dblClickHandler, this);\n        this.parent.on(mouseDown, this.mouseDownHandler, this);\n        this.parent.on(keyUp, this.keyUpHandler, this);\n        this.parent.on(keyDown, this.keyDownHandler, this);\n        this.parent.on(editOperation, this.performEditOperation, this);\n    };\n    Edit.prototype.removeEventListener = function () {\n        EventHandler.remove(this.parent.element, 'dblclick', this.dblClickHandler);\n        if (!this.parent.isDestroyed) {\n            this.parent.off(mouseDown, this.mouseDownHandler);\n            this.parent.off(keyUp, this.keyUpHandler);\n            this.parent.off(keyDown, this.keyDownHandler);\n            this.parent.off(editOperation, this.performEditOperation);\n        }\n    };\n    /**\n     * Get the module name.\n     * @returns string\n     * @private\n     */\n    Edit.prototype.getModuleName = function () {\n        return 'edit';\n    };\n    Edit.prototype.performEditOperation = function (args) {\n        var action = args.action;\n        switch (action) {\n            case 'renderEditor':\n                this.renderEditor();\n                break;\n            case 'refreshEditor':\n                this.refreshEditor(args.value, args.refreshFormulaBar, args.refreshEditorElem, args.isAppend, args.trigEvent);\n                if (args.refreshCurPos) {\n                    this.setCursorPosition();\n                }\n                break;\n            case 'startEdit':\n                if (!this.isEdit) {\n                    this.isNewValueEdit = args.isNewValueEdit;\n                    this.startEdit(args.address, args.value, args.refreshCurPos);\n                }\n                break;\n            case 'endEdit':\n                if (this.isEdit) {\n                    this.endEdit(args.refreshFormulaBar);\n                }\n                break;\n            case 'cancelEdit':\n                if (this.isEdit) {\n                    this.cancelEdit(args.refreshFormulaBar);\n                }\n                break;\n            case 'getCurrentEditValue':\n                args.editedValue = this.editCellData.value;\n                break;\n            case 'refreshDependentCellValue':\n                this.refreshDependentCellValue(args.rowIdx, args.colIdx, args.sheetIdx);\n                break;\n            case 'getPosition':\n                args.position = this.editorElem.getBoundingClientRect();\n                break;\n            case 'focusEditorElem':\n                this.editorElem.focus();\n                break;\n        }\n    };\n    Edit.prototype.keyUpHandler = function (e) {\n        if (this.isEdit) {\n            if (this.isCellEdit && this.editCellData.value !== this.editorElem.textContent) {\n                this.refreshEditor(this.editorElem.textContent, this.isCellEdit);\n            }\n        }\n    };\n    Edit.prototype.keyDownHandler = function (e) {\n        var trgtElem = e.target;\n        var keyCode = e.keyCode;\n        if (this.isEdit) {\n            if (this.isCellEdit) {\n                this.refreshEditor(this.editorElem.textContent, this.isCellEdit);\n            }\n            switch (keyCode) {\n                case this.keyCodes.ENTER:\n                    if (Browser.isWindows) {\n                        e.preventDefault();\n                    }\n                    this.endEdit();\n                    break;\n                case this.keyCodes.TAB:\n                    if (!this.hasFormulaSuggSelected()) {\n                        this.endEdit();\n                    }\n                    break;\n                case this.keyCodes.ESC:\n                    this.cancelEdit();\n                    break;\n            }\n        }\n        else {\n            if (!this.isEdit && (trgtElem.classList.contains('e-spreadsheet') || closest(trgtElem, '.e-sheet-panel'))) {\n                var isAlphabet = (keyCode >= this.keyCodes.FIRSTALPHABET && keyCode <= this.keyCodes.LASTALPHABET);\n                var isNumeric = (keyCode >= this.keyCodes.FIRSTNUMBER && keyCode <= this.keyCodes.LASTNUMBER);\n                var isNumpadKeys = (keyCode >= this.keyCodes.FIRSTNUMPAD && keyCode <= this.keyCodes.LASTNUMPAD);\n                var isSymbolkeys = (keyCode >= this.keyCodes.SYMBOLSETONESTART && keyCode <= this.keyCodes.SYMBOLSETONEEND);\n                if (!isSymbolkeys) {\n                    isSymbolkeys = (keyCode >= this.keyCodes.SYMBOLSETTWOSTART && keyCode <= this.keyCodes.SYMBOLSETTWOEND);\n                }\n                var isFirefoxExceptionkeys = (keyCode === this.keyCodes.FIREFOXEQUALPLUS) ||\n                    (keyCode === this.keyCodes.FIREFOXMINUS);\n                var isF2Edit = (!e.shiftKey && !e.ctrlKey && keyCode === this.keyCodes.F2);\n                var isBackSpace = keyCode === this.keyCodes.BACKSPACE;\n                if ((!e.ctrlKey && !e.altKey && ((!e.shiftKey && keyCode === this.keyCodes.SPACE) || isAlphabet || isNumeric ||\n                    isNumpadKeys || isSymbolkeys || (Browser.info.name === 'mozilla' && isFirefoxExceptionkeys))) || isF2Edit || isBackSpace) {\n                    if (isF2Edit) {\n                        this.isNewValueEdit = false;\n                    }\n                    this.startEdit();\n                }\n                if (keyCode === this.keyCodes.DELETE) {\n                    this.editingHandler('delete');\n                }\n            }\n        }\n    };\n    Edit.prototype.renderEditor = function () {\n        if (!this.editorElem || !this.parent.element.querySelector('#' + this.parent.element.id + '_edit')) {\n            var editor = void 0;\n            editor = this.parent.createElement('div', { id: this.parent.element.id + '_edit', className: 'e-spreadsheet-edit' });\n            editor.contentEditable = 'true';\n            editor.spellcheck = false;\n            this.editorElem = editor;\n            this.parent.element.querySelector('.e-main-content').appendChild(this.editorElem);\n        }\n        this.parent.notify(formulaOperation, { action: 'renderAutoComplete' });\n    };\n    Edit.prototype.refreshEditor = function (value, refreshFormulaBar, refreshEditorElem, isAppend, trigEvent) {\n        if (trigEvent === void 0) { trigEvent = true; }\n        if (isAppend) {\n            value = this.editCellData.value = this.editCellData.value + value;\n        }\n        else {\n            this.editCellData.value = value;\n        }\n        if (refreshEditorElem) {\n            this.editorElem.textContent = value;\n        }\n        if (refreshFormulaBar) {\n            this.parent.notify(formulaBarOperation, { action: 'refreshFormulabar', value: value });\n        }\n        if (trigEvent && this.editCellData.value === this.editorElem.textContent) {\n            if (this.triggerEvent('cellEditing')) {\n                this.cancelEdit();\n            }\n        }\n        // if (this.editorElem.scrollHeight + 2 <= this.editCellData.element.offsetHeight) {\n        //     this.editorElem.style.height = (this.editCellData.element.offsetHeight + 1) + 'px';\n        // } else {\n        //     this.editorElem.style.removeProperty('height');\n        // }\n    };\n    Edit.prototype.startEdit = function (address, value, refreshCurPos) {\n        if (refreshCurPos === void 0) { refreshCurPos = true; }\n        this.updateEditCellDetail(address, value);\n        this.initiateEditor(refreshCurPos);\n        this.positionEditor();\n        this.parent.isEdit = this.isEdit = true;\n        this.parent.notify(clearCopy, null);\n        this.parent.notify(enableToolbar, { enable: false });\n    };\n    Edit.prototype.setCursorPosition = function () {\n        var elem = this.editorElem;\n        var textLen = elem.textContent.length;\n        if (textLen) {\n            var selection = document.getSelection();\n            var range = document.createRange();\n            range.setStart(elem.firstChild, textLen);\n            range.collapse(true);\n            selection.removeAllRanges();\n            selection.addRange(range);\n        }\n        elem.focus();\n    };\n    Edit.prototype.hasFormulaSuggSelected = function () {\n        var suggDdlElem = document.getElementById(this.parent.element.id + '_ac_popup');\n        return suggDdlElem && suggDdlElem.style.visibility === 'visible' &&\n            suggDdlElem.querySelectorAll('.e-item-focus').length > 0;\n    };\n    Edit.prototype.editingHandler = function (action) {\n        switch (action) {\n            case 'delete':\n                var address = this.parent.getActiveSheet().selectedRange;\n                var range = getIndexesFromAddress(address);\n                this.parent.clearRange(address, null, true);\n                this.parent.serviceLocator.getService('cell').refreshRange(range);\n                this.parent.notify(selectionComplete, {});\n                break;\n        }\n    };\n    Edit.prototype.mouseDownHandler = function (e) {\n        if (this.isEdit) {\n            var trgtElem = e.target;\n            this.isCellEdit = trgtElem.classList.contains('e-spreadsheet-edit');\n            if (trgtElem.classList.contains('e-cell') || trgtElem.classList.contains('e-header-cell') ||\n                trgtElem.classList.contains('e-virtualtrack') || trgtElem.classList.contains('e-selectall')) {\n                this.endEdit();\n            }\n        }\n    };\n    Edit.prototype.dblClickHandler = function (e) {\n        var trgtElem = e.target;\n        if (trgtElem.classList.contains('e-active-cell') || trgtElem.classList.contains('e-cell')\n            || closest(trgtElem, '.e-main-content')) {\n            if (this.isEdit) {\n                this.endEdit();\n            }\n            else {\n                this.isNewValueEdit = false;\n                this.startEdit();\n            }\n        }\n    };\n    Edit.prototype.updateEditCellDetail = function (addr, value) {\n        var sheetIdx;\n        var sheet;\n        if (!this.editCellData.sheetIndex) {\n            if (addr && addr.split('!').length > 1) {\n                sheetIdx = getSheetIndex(this.parent, getSheetNameFromAddress(addr));\n            }\n            else {\n                sheetIdx = this.parent.activeSheetTab;\n            }\n        }\n        if (!this.editCellData.addr) {\n            sheet = getSheet(this.parent, sheetIdx - 1);\n            if (addr) {\n                addr = getRangeFromAddress(addr);\n            }\n            else {\n                addr = sheet.activeCell;\n            }\n        }\n        var range = getRangeIndexes(addr);\n        var rowIdx = range[0];\n        var colIdx = range[1];\n        var cellElem = this.parent.getCell(rowIdx, colIdx);\n        var cellPosition = getCellPosition(sheet, range);\n        this.editCellData = {\n            addr: addr,\n            fullAddr: getSheetName(this.parent, sheetIdx) + '!' + addr,\n            rowIndex: rowIdx,\n            colIndex: colIdx,\n            sheetIndex: sheetIdx,\n            element: cellElem,\n            value: value || '',\n            position: cellPosition\n        };\n    };\n    Edit.prototype.initiateEditor = function (refreshCurPos) {\n        var _this = this;\n        var data = this.parent.getData(this.editCellData.fullAddr);\n        data.then(function (values) {\n            values.forEach(function (cell, key) {\n                var args = { cell: cell, value: cell ? cell.value : '' };\n                _this.parent.notify(getFormattedBarText, args);\n                var value = cell ? args.value : '';\n                if (cell && cell.formula) {\n                    value = cell.formula;\n                }\n                _this.editCellData.oldValue = value;\n                if (_this.editCellData.value) {\n                    value = _this.editCellData.value;\n                }\n                else {\n                    _this.editCellData.value = value;\n                }\n                if (_this.isNewValueEdit) {\n                    value = '';\n                }\n                else {\n                    _this.isNewValueEdit = true;\n                }\n                if (value) {\n                    _this.refreshEditor(value, false, true, false, false);\n                }\n                if (refreshCurPos) {\n                    _this.setCursorPosition();\n                }\n                if (_this.triggerEvent('cellEdit')) {\n                    _this.cancelEdit(true, false);\n                }\n            });\n        });\n    };\n    Edit.prototype.positionEditor = function () {\n        var tdElem = this.editCellData.element;\n        tdElem.classList.add('e-ss-edited');\n        var left = this.editCellData.position.left + 1;\n        var top = this.editCellData.position.top + 1;\n        var minHeight = this.editCellData.element.offsetHeight - 3;\n        var minWidth = this.editCellData.element.offsetWidth - 3;\n        var mainContElement = this.parent.getMainContent();\n        var editWidth = mainContElement.offsetWidth - left - 28;\n        //let editHeight: number = mainContElement.offsetHeight - top - 28;\n        var inlineStyles = 'display:block;top:' + top + 'px;left:' + left + 'px;' +\n            'min-width:' + minWidth + 'px;max-width:' + editWidth + 'px;height:' +\n            minHeight + 'px;';\n        inlineStyles += tdElem.style.cssText;\n        this.editorElem.setAttribute('style', inlineStyles);\n        if (tdElem.classList.contains('e-right-align')) {\n            this.editorElem.classList.add('e-right-align');\n        }\n        else if (tdElem.classList.contains('e-center-align')) {\n            this.editorElem.classList.add('e-center-align');\n        }\n    };\n    Edit.prototype.updateEditedValue = function (tdRefresh) {\n        if (tdRefresh === void 0) { tdRefresh = true; }\n        if (this.editCellData.oldValue !== this.editCellData.value) {\n            var cellIndex = getRangeIndexes(this.parent.getActiveSheet().activeCell);\n            this.parent.notify(workbookEditOperation, { action: 'updateCellValue', address: this.editCellData.addr, value: this.editCellData.value });\n            var cell = getCell(cellIndex[0], cellIndex[1], this.parent.getActiveSheet(), true);\n            var eventArgs = this.getRefreshNodeArgs(cell);\n            this.editCellData.value = eventArgs.result;\n            if (tdRefresh) {\n                this.parent.refreshNode(this.editCellData.element, eventArgs);\n            }\n        }\n    };\n    Edit.prototype.refreshDependentCellValue = function (rowIdx, colIdx, sheetIdx) {\n        if (rowIdx && colIdx) {\n            rowIdx--;\n            colIdx--;\n            if ((this.editCellData.rowIndex !== rowIdx || this.editCellData.colIndex !== colIdx)\n                && this.parent.activeSheetTab === sheetIdx) {\n                var td = this.parent.getCell(rowIdx, colIdx);\n                if (td) {\n                    var sheet = getSheet(this.parent, sheetIdx - 1);\n                    var cell = getCell(rowIdx, colIdx, sheet);\n                    var eventArgs = this.getRefreshNodeArgs(cell);\n                    this.parent.refreshNode(td, eventArgs);\n                }\n            }\n        }\n    };\n    Edit.prototype.getRefreshNodeArgs = function (cell) {\n        cell = cell ? cell : {};\n        var fCode = (cell && cell.format) ? cell.format : '';\n        var eventArgs = {\n            value: cell.value, format: fCode, onLoad: true,\n            formattedText: '', isRightAlign: false, type: NumberFormatType.General\n        };\n        var args;\n        this.parent.notify(getFormattedCellObject, eventArgs);\n        args = {\n            isRightAlign: eventArgs.isRightAlign,\n            result: eventArgs.formattedText,\n            type: eventArgs.type,\n            value: eventArgs.value,\n            curSymbol: eventArgs.curSymbol\n        };\n        return args;\n    };\n    Edit.prototype.endEdit = function (refreshFormulaBar) {\n        if (refreshFormulaBar === void 0) { refreshFormulaBar = false; }\n        if (refreshFormulaBar) {\n            this.refreshEditor(this.editCellData.oldValue, false, true, false, false);\n        }\n        this.updateEditedValue();\n        this.triggerEvent('cellSave');\n        this.resetEditState();\n        this.focusElement();\n    };\n    Edit.prototype.cancelEdit = function (refreshFormulaBar, trigEvent) {\n        if (refreshFormulaBar === void 0) { refreshFormulaBar = true; }\n        if (trigEvent === void 0) { trigEvent = true; }\n        this.refreshEditor(this.editCellData.oldValue, refreshFormulaBar, false, false, false);\n        if (trigEvent) {\n            this.triggerEvent('cellSave');\n        }\n        this.resetEditState();\n        this.focusElement();\n    };\n    Edit.prototype.focusElement = function () {\n        this.parent.element.focus();\n        this.parent.notify(enableToolbar, { enable: true });\n    };\n    Edit.prototype.triggerEvent = function (eventName) {\n        var eventArgs = {\n            element: this.editCellData.element,\n            value: this.editCellData.value,\n            oldValue: this.editCellData.oldValue,\n            address: this.editCellData.fullAddr\n        };\n        if (eventName !== 'cellSave') {\n            eventArgs.cancel = false;\n        }\n        this.parent.trigger(eventName, eventArgs);\n        return eventArgs.cancel;\n    };\n    Edit.prototype.altEnter = function () {\n        var text;\n        var textBefore;\n        var textAfter;\n        var selection = window.getSelection();\n        var node = selection.anchorNode;\n        var offset;\n        var range = document.createRange();\n        offset = (node.nodeType === 3) ? selection.anchorOffset : node.textContent.length;\n        text = node.textContent;\n        textBefore = text.slice(0, offset);\n        textAfter = text.slice(offset) || ' ';\n        node.textContent = textBefore + '\\n' + textAfter;\n        range = document.createRange();\n        if (node.nodeType === 3) {\n            range.setStart(node, offset + 1);\n            range.setEnd(node, offset + 1);\n        }\n        else if (node.nodeType === 1) {\n            range.setStart(node.firstChild, offset + 1);\n            range.setEnd(node.firstChild, offset + 1);\n        }\n        selection.removeAllRanges();\n        selection.addRange(range);\n    };\n    Edit.prototype.resetEditState = function (elemRefresh) {\n        if (elemRefresh === void 0) { elemRefresh = true; }\n        if (elemRefresh) {\n            this.editCellData.element.classList.remove('e-ss-edited');\n            this.editorElem.textContent = '';\n            this.editorElem.removeAttribute('style');\n            this.editorElem.classList.remove('e-right-align');\n        }\n        this.editCellData = {};\n        this.parent.isEdit = this.isEdit = false;\n        this.isCellEdit = true;\n        this.parent.notify(formulaOperation, { action: 'endEdit' });\n    };\n    return Edit;\n}());\nexport { Edit };\n","import { contentLoaded, mouseDown, virtualContentLoaded, cellNavigate, getUpdateUsingRaf } from '../common/index';\nimport { getColumnsWidth, updateSelectedRange, getColumnWidth } from '../../workbook/index';\nimport { getRowHeight, isSingleCell, activeCellChanged } from '../../workbook/index';\nimport { EventHandler, addClass, removeClass, isNullOrUndefined, Browser } from '@syncfusion/ej2-base';\nimport { selectionComplete, getMoveEvent, getEndEvent, isTouchStart, locateElem } from '../common/index';\nimport { isTouchEnd, isTouchMove, getClientX, getClientY, mouseUpAfterSelection, selectRange, rowHeightChanged } from '../common/index';\nimport { getRangeIndexes, getCellAddress, getRangeAddress, getCellIndexes, getSwapRange } from '../../workbook/common/address';\n/**\n * Represents selection support for Spreadsheet.\n */\nvar Selection = /** @class */ (function () {\n    /**\n     * Constructor for the Spreadsheet selection module.\n     * @private\n     */\n    function Selection(parent) {\n        this.parent = parent;\n        this.addEventListener();\n        this.mouseMoveEvt = this.mouseMoveHandler.bind(this);\n    }\n    Selection.prototype.addEventListener = function () {\n        this.parent.on(contentLoaded, this.init, this);\n        this.parent.on(mouseDown, this.mouseDownHandler, this);\n        this.parent.on(virtualContentLoaded, this.virtualContentLoadedHandler, this);\n        this.parent.on(cellNavigate, this.cellNavigateHandler, this);\n        this.parent.on(selectRange, this.selectRange, this);\n        this.parent.on(rowHeightChanged, this.rowHeightChanged, this);\n    };\n    Selection.prototype.removeEventListener = function () {\n        if (!this.parent.isDestroyed) {\n            this.parent.off(contentLoaded, this.init);\n            this.parent.off(mouseDown, this.mouseDownHandler);\n            this.parent.off(virtualContentLoaded, this.virtualContentLoadedHandler);\n            this.parent.off(cellNavigate, this.cellNavigateHandler);\n            this.parent.off(selectRange, this.selectRange);\n            this.parent.off(rowHeightChanged, this.rowHeightChanged);\n        }\n    };\n    Selection.prototype.rowHeightChanged = function (args) {\n        var _this = this;\n        getUpdateUsingRaf(function () {\n            var ele = _this.getActiveCell();\n            if (getCellIndexes(_this.parent.getActiveSheet().activeCell)[0] === args.rowIdx && ele) {\n                ele.style.height = parseInt(ele.style.height, 10) + args.threshold + \"px\";\n            }\n            ele = _this.getSelectionElement();\n            if (ele) {\n                ele.style.height = parseInt(ele.style.height, 10) + args.threshold + \"px\";\n            }\n        });\n    };\n    Selection.prototype.selectRange = function (indexes) {\n        this.selectRangeByIdx(this.parent.selectionSettings.mode === 'Single' ? indexes.slice(0, 2).concat(indexes.slice(0, 2)) : indexes);\n    };\n    Selection.prototype.init = function () {\n        var range = getRangeIndexes(this.parent.getActiveSheet().selectedRange);\n        var sRange = getSwapRange(range);\n        var actRange = getCellIndexes(this.parent.getActiveSheet().activeCell);\n        var inRange = sRange[0] <= actRange[0] && sRange[2] >= actRange[0] && sRange[1] <= actRange[1]\n            && sRange[3] >= actRange[1];\n        this.createSelectionElement();\n        this.selectRangeByIdx(range, null, null, inRange);\n    };\n    Selection.prototype.createSelectionElement = function () {\n        var cont = this.parent.getMainContent();\n        var ele = this.parent.createElement('div', { className: 'e-selection' });\n        var activeCell = this.parent.createElement('div', { className: 'e-active-cell' });\n        cont.appendChild(ele);\n        cont.appendChild(activeCell);\n    };\n    Selection.prototype.mouseDownHandler = function (e) {\n        if (!this.parent.isEdit) {\n            if (this.getSheetElement().contains(e.target)) {\n                var sheet = this.parent.getActiveSheet();\n                var mode = this.parent.selectionSettings.mode;\n                var rowIdx = this.getRowIdxFromClientY(getClientY(e));\n                var colIdx = this.getColIdxFromClientX(getClientX(e));\n                var activeIdx = getCellIndexes(sheet.activeCell);\n                var isRowSelected = sheet.showHeaders && this.parent.getRowHeaderContent().contains(e.target);\n                var isColSelected = sheet.showHeaders && this.parent.getColumnHeaderContent().contains(e.target);\n                if (e.which === 3 && this.isSelected(rowIdx, colIdx)) {\n                    return;\n                }\n                if (mode === 'Multiple' && (!isTouchEnd(e) && (!isTouchStart(e) ||\n                    (isTouchStart(e) && activeIdx[0] === rowIdx && activeIdx[1] === colIdx)) || isColSelected || isRowSelected)) {\n                    document.addEventListener(getMoveEvent().split(' ')[0], this.mouseMoveEvt);\n                    if (!Browser.isPointer) {\n                        document.addEventListener(getMoveEvent().split(' ')[1], this.mouseMoveEvt, { passive: false });\n                    }\n                }\n                if (!isTouchEnd(e)) {\n                    EventHandler.add(document, getEndEvent(), this.mouseUpHandler, this);\n                }\n                if (isTouchStart(e) && !(isColSelected || isRowSelected)) {\n                    this.touchEvt = e;\n                    return;\n                }\n                if (isRowSelected) {\n                    this.isRowSelected = true;\n                    if (!e.shiftKey || mode === 'Single') {\n                        this.startCell = [rowIdx, 0];\n                    }\n                    this.selectRangeByIdx([this.startCell[0], 0, rowIdx, sheet.colCount - 1], e);\n                }\n                else if (isColSelected) {\n                    this.isColSelected = true;\n                    if (!e.shiftKey || mode === 'Single') {\n                        this.startCell = [0, colIdx];\n                    }\n                    this.selectRangeByIdx([0, this.startCell[1], sheet.rowCount - 1, colIdx], e);\n                }\n                else if (e.target.classList.contains('e-selectall')) {\n                    this.startCell = [0, 0];\n                    this.selectRangeByIdx([].concat(this.startCell, [sheet.rowCount - 1, sheet.colCount - 1]), e);\n                }\n                else if (!e.target.classList.contains('e-main-content')) {\n                    if (!e.shiftKey || mode === 'Single') {\n                        this.startCell = [rowIdx, colIdx];\n                    }\n                    this.selectRangeByIdx([].concat(this.startCell ? this.startCell : getCellIndexes(sheet.activeCell), [rowIdx, colIdx]), e);\n                }\n                if (this.parent.isMobileView()) {\n                    this.parent.element.classList.add('e-mobile-focused');\n                    this.parent.renderModule.setSheetPanelSize();\n                }\n            }\n        }\n    };\n    Selection.prototype.mouseMoveHandler = function (e) {\n        var _this = this;\n        if (isTouchMove(e)) {\n            e.preventDefault();\n        }\n        var sheet = this.parent.getActiveSheet();\n        var cont = this.getScrollContent();\n        var clientRect = cont.getBoundingClientRect();\n        var clientX = getClientX(e);\n        var clientY = getClientY(e);\n        // remove math.min or handle top and left auto scroll\n        var colIdx = this.isRowSelected ? sheet.colCount - 1 : this.getColIdxFromClientX(Math.min(clientX, clientRect.right));\n        var rowIdx = this.isColSelected ? sheet.rowCount - 1 : this.getRowIdxFromClientY(Math.min(clientY, clientRect.bottom));\n        var isScrollDown = clientY > clientRect.bottom && rowIdx < sheet.rowCount;\n        var isScrollUp = clientY < clientRect.top && rowIdx >= 0 && !this.isColSelected;\n        var isScrollRight = clientX > clientRect.right && colIdx < sheet.colCount;\n        var isScrollLeft = clientX < clientRect.left && colIdx >= 0 && !this.isRowSelected;\n        this.clearInterval();\n        if (isScrollDown || isScrollUp || isScrollRight || isScrollLeft) {\n            this.scrollInterval = setInterval(function () {\n                if ((isScrollDown || isScrollUp) && !_this.isColSelected) {\n                    rowIdx = _this.getRowIdxFromClientY(isScrollDown ? clientRect.bottom : clientRect.top);\n                    if (rowIdx >= sheet.rowCount) { // clear interval when scroll up\n                        _this.clearInterval();\n                        return;\n                    }\n                    cont.scrollTop += (isScrollDown ? 1 : -1) * getRowHeight(sheet, rowIdx);\n                }\n                if ((isScrollRight || isScrollLeft) && !_this.isRowSelected) {\n                    colIdx = _this.getColIdxFromClientX(isScrollRight ? clientRect.right : clientRect.left);\n                    if (colIdx >= sheet.colCount) { // clear interval when scroll left\n                        _this.clearInterval();\n                        return;\n                    }\n                    cont.scrollLeft += (isScrollRight ? 1 : -1) * getColumnWidth(sheet, colIdx);\n                }\n                _this.selectRangeByIdx([].concat(_this.startCell, [rowIdx, colIdx]), e);\n                // tslint:disable-next-line\n            }, 100);\n        }\n        else {\n            this.selectRangeByIdx([].concat(this.startCell ? this.startCell : getCellIndexes(sheet.activeCell), [rowIdx, colIdx]), e);\n        }\n    };\n    Selection.prototype.mouseUpHandler = function (e) {\n        var rowIdx = this.getRowIdxFromClientY(getClientY(e));\n        var colIdx = this.getColIdxFromClientX(getClientX(e));\n        this.clearInterval();\n        if (isTouchEnd(e) && !(this.isColSelected || this.isRowSelected) &&\n            (this.getRowIdxFromClientY(getClientY(this.touchEvt)) === rowIdx &&\n                this.getColIdxFromClientX(getClientX(this.touchEvt)) === colIdx)) {\n            this.mouseDownHandler(e);\n        }\n        this.parent.trigger('select', { range: this.parent.getActiveSheet().selectedRange });\n        document.removeEventListener(getMoveEvent().split(' ')[0], this.mouseMoveEvt);\n        if (!Browser.isPointer) {\n            document.removeEventListener(getMoveEvent().split(' ')[1], this.mouseMoveEvt);\n        }\n        EventHandler.remove(document, getEndEvent(), this.mouseUpHandler);\n        this.parent.notify(mouseUpAfterSelection, e);\n    };\n    Selection.prototype.isSelected = function (rowIdx, colIdx) {\n        var indexes = getRangeIndexes(this.parent.getActiveSheet().selectedRange);\n        return indexes[0] <= rowIdx && rowIdx <= indexes[2] && indexes[1] <= colIdx && colIdx <= indexes[3];\n    };\n    Selection.prototype.virtualContentLoadedHandler = function () {\n        var sheet = this.parent.getActiveSheet();\n        var indexes = getRangeIndexes(sheet.selectedRange);\n        if (this.isColSelected && this.isRowSelected) {\n            this.selectRangeByIdx([0, 0, sheet.rowCount - 1, sheet.colCount - 1], null, true);\n        }\n        else if (this.isColSelected) {\n            this.selectRangeByIdx([0, indexes[1], sheet.rowCount - 1, indexes[3]], null, true);\n        }\n        else if (this.isRowSelected) {\n            this.selectRangeByIdx([indexes[0], 0, indexes[2], sheet.colCount - 1], null, true);\n        }\n        else {\n            this.highlightHdr(indexes, indexes[0] >= this.parent.viewport.topIndex || indexes[2] >= this.parent.viewport.topIndex, indexes[1] >= this.parent.viewport.leftIndex || indexes[3] >= this.parent.viewport.leftIndex);\n        }\n    };\n    Selection.prototype.clearInterval = function () {\n        clearInterval(this.scrollInterval);\n        this.scrollInterval = null;\n    };\n    Selection.prototype.getScrollContent = function () {\n        return this.parent.getMainContent();\n    };\n    Selection.prototype.cellNavigateHandler = function (args) {\n        this.selectRangeByIdx(args.range.concat(args.range));\n    };\n    Selection.prototype.getColIdxFromClientX = function (clientX) {\n        var width = 0;\n        var sheet = this.parent.getActiveSheet();\n        var left = (clientX - this.parent.getMainContent().getBoundingClientRect().left)\n            + this.parent.getMainContent().scrollLeft;\n        for (var i = 0;; i++) {\n            width += getColumnsWidth(sheet, i);\n            if (left < width) {\n                return i;\n            }\n        }\n    };\n    Selection.prototype.getRowIdxFromClientY = function (clientY) {\n        var height = 0;\n        var sheet = this.parent.getActiveSheet();\n        var top = (clientY - this.parent.getMainContent().getBoundingClientRect().top)\n            + this.parent.getMainContent().scrollTop;\n        for (var i = 0;; i++) {\n            height += getRowHeight(sheet, i);\n            if (top < height) {\n                return i;\n            }\n        }\n    };\n    Selection.prototype.selectRangeByIdx = function (range, e, isScrollRefresh, isActCellChanged) {\n        var ele = this.getSelectionElement();\n        var sheet = this.parent.getActiveSheet();\n        var args = { range: getRangeAddress(range), cancel: false };\n        this.parent.trigger('beforeSelect', args);\n        if (args.cancel === true) {\n            return;\n        }\n        if (isSingleCell(range)) {\n            ele.classList.add('e-hide');\n        }\n        else {\n            ele.classList.remove('e-hide');\n            locateElem(ele, range, sheet);\n        }\n        updateSelectedRange(this.parent, getRangeAddress(range), sheet);\n        this.UpdateRowColSelected(range);\n        this.highlightHdr(range);\n        if (!isScrollRefresh && !(e && (e.type === 'mousemove' || isTouchMove(e)))) {\n            this.updateActiveCell(isActCellChanged ? getCellIndexes(sheet.activeCell) : range);\n        }\n        if (isNullOrUndefined(e)) {\n            e = { type: 'mousedown' };\n        }\n        this.parent.notify(selectionComplete, e);\n    };\n    Selection.prototype.UpdateRowColSelected = function (indexes) {\n        var sheet = this.parent.getActiveSheet();\n        this.isRowSelected = (indexes[1] === 0 && indexes[3] === sheet.colCount - 1);\n        this.isColSelected = (indexes[0] === 0 && indexes[2] === sheet.rowCount - 1);\n    };\n    Selection.prototype.updateActiveCell = function (range) {\n        var sheet = this.parent.getActiveSheet();\n        var topLeftIdx = getRangeIndexes(sheet.topLeftCell);\n        var rowIdx = this.isColSelected ? topLeftIdx[0] : range[0];\n        var colIdx = this.isRowSelected ? topLeftIdx[1] : range[1];\n        sheet.activeCell = getCellAddress(rowIdx, colIdx);\n        this.parent.setProperties({ 'sheets': this.parent.sheets }, true);\n        locateElem(this.getActiveCell(), getRangeIndexes(sheet.activeCell), sheet);\n        this.parent.notify(activeCellChanged, [rowIdx, colIdx]);\n    };\n    Selection.prototype.getSelectionElement = function () {\n        return this.parent.element.getElementsByClassName('e-selection')[0];\n    };\n    Selection.prototype.getActiveCell = function () {\n        return this.parent.getMainContent().getElementsByClassName('e-active-cell')[0];\n    };\n    Selection.prototype.getSheetElement = function () {\n        return document.getElementById(this.parent.element.id + '_sheet');\n    };\n    Selection.prototype.highlightHdr = function (range, isRowRefresh, isColRefresh) {\n        if (isRowRefresh === void 0) { isRowRefresh = true; }\n        if (isColRefresh === void 0) { isColRefresh = true; }\n        if (this.parent.getActiveSheet().showHeaders) {\n            var rowHdr = [];\n            var colHdr = [];\n            var swapRange = getSwapRange(range);\n            swapRange = this.getHdrIndexes(swapRange);\n            var selectAll = this.parent.element.getElementsByClassName('e-select-all-cell')[0];\n            removeClass(this.getSheetElement().querySelectorAll('.e-highlight'), 'e-highlight');\n            removeClass(this.getSheetElement().querySelectorAll('.e-prev-highlight'), 'e-prev-highlight');\n            removeClass([selectAll], ['e-prev-highlight-right', 'e-prev-highlight-bottom']);\n            if (isRowRefresh) {\n                rowHdr = [].slice.call(this.parent.getRowHeaderContent().querySelectorAll('td')).slice(swapRange[0], swapRange[2] + 1);\n            }\n            if (isColRefresh) {\n                colHdr = [].slice.call(this.parent.getColumnHeaderContent().querySelectorAll('th')).slice(swapRange[1], swapRange[3] + 1);\n            }\n            addClass([].concat(rowHdr, colHdr), 'e-highlight');\n            if (rowHdr.length && rowHdr[0].parentElement.previousElementSibling) {\n                rowHdr[0].parentElement.previousElementSibling.classList.add('e-prev-highlight');\n            }\n            if (colHdr.length && colHdr[0].previousElementSibling) {\n                colHdr[0].previousElementSibling.classList.add('e-prev-highlight');\n            }\n            if (this.isRowSelected && this.isColSelected) {\n                document.getElementById(this.parent.element.id + \"_select_all\").classList.add('e-highlight');\n            }\n            if (swapRange[0] === 0) {\n                selectAll.classList.add('e-prev-highlight-bottom');\n            }\n            if (swapRange[1] === 0) {\n                selectAll.classList.add('e-prev-highlight-right');\n            }\n        }\n    };\n    Selection.prototype.getHdrIndexes = function (range) {\n        if (this.parent.scrollSettings.enableVirtualization) {\n            var indexes = [];\n            indexes[0] = this.isColSelected ? range[0] : (range[0] - this.parent.viewport.topIndex) < 0\n                ? 0 : (range[0] - this.parent.viewport.topIndex);\n            indexes[1] = this.isRowSelected ? range[1] : (range[1] - this.parent.viewport.leftIndex) < 0\n                ? 0 : (range[1] - this.parent.viewport.leftIndex);\n            indexes[2] = this.isColSelected ? this.parent.viewport.rowCount + this.parent.getThreshold('row') * 2 : indexes[0] === 0\n                ? range[2] - this.parent.viewport.topIndex : range[2] - range[0] + indexes[0];\n            indexes[3] = this.isRowSelected ? this.parent.viewport.colCount + this.parent.getThreshold('col') * 2 : indexes[1] === 0\n                ? range[3] - this.parent.viewport.leftIndex : range[3] - range[1] + indexes[1];\n            return indexes;\n        }\n        return range;\n    };\n    /**\n     * For internal use only - Get the module name.\n     * @private\n     */\n    Selection.prototype.getModuleName = function () {\n        return 'selection';\n    };\n    Selection.prototype.destroy = function () {\n        this.removeEventListener();\n        this.parent = null;\n    };\n    return Selection;\n}());\nexport { Selection };\n","import { EventHandler, Browser } from '@syncfusion/ej2-base';\nimport { contentLoaded, spreadsheetDestroyed, onVerticalScroll, onHorizontalScroll, getScrollBarWidth } from '../common/index';\nimport { onContentScroll, deInitProperties } from '../common/index';\nimport { getRowHeight, getColumnWidth, getCellAddress } from '../../workbook/index';\n/**\n * The `Scroll` module is used to handle scrolling behavior.\n * @hidden\n */\nvar Scroll = /** @class */ (function () {\n    /**\n     * Constructor for the Spreadsheet scroll module.\n     * @private\n     */\n    function Scroll(parent) {\n        this.parent = parent;\n        this.addEventListener();\n        this.initProps();\n    }\n    /**\n     * For internal use only - Get the module name.\n     * @private\n     */\n    Scroll.prototype.getModuleName = function () {\n        return 'scroll';\n    };\n    Scroll.prototype.onContentScroll = function (e) {\n        var target = this.parent.getMainContent();\n        var scrollLeft = e.scrollLeft || target.scrollLeft;\n        var top = e.scrollTop || target.scrollTop;\n        var left = this.parent.enableRtl ? this.initScrollValue - scrollLeft : scrollLeft;\n        var scrollArgs;\n        var prevSize;\n        if (this.prevScroll.scrollLeft !== left) {\n            var scrollRight = left > this.prevScroll.scrollLeft;\n            prevSize = this.offset.left.size;\n            this.offset.left = this.getColOffset(left, prevSize, scrollRight);\n            if (this.parent.getActiveSheet().showHeaders) {\n                this.parent.getColumnHeaderContent().scrollLeft = scrollLeft;\n            }\n            scrollArgs = {\n                cur: this.offset.left, prev: { idx: this.leftIndex, size: prevSize }, increase: scrollRight, preventScroll: e.preventScroll\n            };\n            this.parent.notify(onHorizontalScroll, scrollArgs);\n            this.updateTopLeftCell();\n            if (!this.parent.scrollSettings.enableVirtualization && scrollRight && !this.parent.scrollSettings.isFinite) {\n                this.updateNonVirtualCols();\n            }\n            this.leftIndex = scrollArgs.prev.idx;\n            this.prevScroll.scrollLeft = left;\n        }\n        if (this.prevScroll.scrollTop !== top) {\n            var scrollDown = top > this.prevScroll.scrollTop;\n            prevSize = this.offset.top.size;\n            this.offset.top = this.getRowOffset(top, scrollDown);\n            if (this.parent.getActiveSheet().showHeaders) {\n                this.parent.getRowHeaderContent().scrollTop = top;\n            }\n            scrollArgs = {\n                cur: this.offset.top, prev: { idx: this.topIndex, size: prevSize }, increase: scrollDown, preventScroll: e.preventScroll\n            };\n            this.parent.notify(onVerticalScroll, scrollArgs);\n            this.updateTopLeftCell();\n            if (!this.parent.scrollSettings.enableVirtualization && scrollDown && !this.parent.scrollSettings.isFinite) {\n                this.updateNonVirtualRows();\n            }\n            this.topIndex = scrollArgs.prev.idx;\n            this.prevScroll.scrollTop = top;\n        }\n    };\n    Scroll.prototype.updateNonVirtualRows = function () {\n        var sheet = this.parent.getActiveSheet();\n        var threshold = this.parent.getThreshold('row');\n        if (this.offset.top.idx > sheet.rowCount - (this.parent.viewport.rowCount + threshold)) {\n            this.parent.renderModule.refreshUI({ colIndex: 0, direction: 'first', refresh: 'RowPart' }, getCellAddress(sheet.rowCount, 0) + \":\" + getCellAddress(sheet.rowCount + threshold - 1, sheet.colCount - 1));\n            sheet.rowCount += threshold;\n            this.parent.setProperties({ 'sheets': this.parent.sheets }, true);\n        }\n    };\n    Scroll.prototype.updateNonVirtualCols = function () {\n        var sheet = this.parent.getActiveSheet();\n        var threshold = this.parent.getThreshold('col');\n        if (this.offset.left.idx > sheet.colCount - (this.parent.viewport.colCount + threshold)) {\n            this.parent.renderModule.refreshUI({ rowIndex: 0, colIndex: sheet.colCount, direction: 'first', refresh: 'ColumnPart' }, getCellAddress(0, sheet.colCount) + \":\" + getCellAddress(sheet.rowCount - 1, sheet.colCount + threshold - 1));\n            sheet.colCount += threshold;\n            this.parent.setProperties({ 'sheets': this.parent.sheets }, true);\n        }\n    };\n    Scroll.prototype.updateTopLeftCell = function () {\n        this.parent.getActiveSheet().topLeftCell = getCellAddress(this.offset.top.idx, this.offset.left.idx);\n        this.parent.setProperties({ 'sheets': this.parent.sheets }, true);\n    };\n    Scroll.prototype.getRowOffset = function (scrollTop, scrollDown) {\n        var temp = this.offset.top.size;\n        var sheet = this.parent.getActiveSheet();\n        var i = scrollDown ? this.offset.top.idx + 1 : (this.offset.top.idx ? this.offset.top.idx - 1 : 0);\n        var count;\n        if (this.parent.scrollSettings.isFinite) {\n            count = sheet.rowCount;\n            if (scrollDown && i + this.parent.viewport.rowCount + this.parent.getThreshold('row') >= count) {\n                return { idx: this.offset.top.idx, size: this.offset.top.size };\n            }\n        }\n        else {\n            count = Infinity;\n        }\n        while (i < count) {\n            if (scrollDown) {\n                temp += getRowHeight(sheet, i - 1);\n                if (temp === scrollTop) {\n                    return { idx: i, size: temp };\n                }\n                if (temp > scrollTop) {\n                    return { idx: i - 1, size: temp - getRowHeight(sheet, i - 1) };\n                }\n                i++;\n            }\n            else {\n                if (temp === 0) {\n                    return { idx: 0, size: 0 };\n                }\n                temp -= getRowHeight(sheet, i);\n                if (temp === scrollTop) {\n                    return { idx: i, size: temp };\n                }\n                if (temp < scrollTop) {\n                    temp += getRowHeight(sheet, i);\n                    if (temp > scrollTop) {\n                        return { idx: i, size: temp - getRowHeight(sheet, i) };\n                    }\n                    else {\n                        return { idx: i + 1, size: temp };\n                    }\n                }\n                i--;\n            }\n        }\n        return { idx: this.offset.top.idx, size: this.offset.top.size };\n    };\n    Scroll.prototype.getColOffset = function (scrollLeft, width, increase) {\n        var temp = width;\n        var sheet = this.parent.getActiveSheet();\n        var i = increase ? this.offset.left.idx + 1 : this.offset.left.idx - 1;\n        var count;\n        if (this.parent.scrollSettings.isFinite) {\n            count = sheet.colCount;\n            if (increase && i + this.parent.viewport.colCount + this.parent.getThreshold('col') >= count) {\n                return { idx: this.offset.left.idx, size: this.offset.left.size };\n            }\n        }\n        else {\n            count = Infinity;\n        }\n        while (i < count) {\n            if (increase) {\n                temp += getColumnWidth(sheet, i - 1);\n                if (temp === scrollLeft) {\n                    return { idx: i, size: temp };\n                }\n                if (temp > scrollLeft) {\n                    return { idx: i - 1, size: temp - getColumnWidth(sheet, i - 1) };\n                }\n                i++;\n            }\n            else {\n                if (temp === 0) {\n                    return { idx: 0, size: 0 };\n                }\n                temp -= getColumnWidth(sheet, i);\n                if (temp === scrollLeft) {\n                    return { idx: i, size: temp };\n                }\n                if (temp < scrollLeft) {\n                    temp += getColumnWidth(sheet, i);\n                    if (temp > scrollLeft) {\n                        return { idx: i, size: temp - getColumnWidth(sheet, i) };\n                    }\n                    else {\n                        return { idx: i + 1, size: temp };\n                    }\n                }\n                i--;\n            }\n        }\n        return { idx: this.offset.left.idx, size: this.offset.left.size };\n    };\n    Scroll.prototype.wireEvents = function () {\n        this.onScroll = this.onContentScroll.bind(this);\n        EventHandler.add(this.parent.getMainContent(), 'scroll', this.onScroll, this);\n        if (this.parent.enableRtl) {\n            this.initScrollValue = this.parent.getMainContent().scrollLeft;\n        }\n    };\n    Scroll.prototype.initProps = function () {\n        this.topIndex = 0;\n        this.leftIndex = 0;\n        this.prevScroll = { scrollLeft: 0, scrollTop: 0 };\n        this.offset = { left: { idx: 0, size: 0 }, top: { idx: 0, size: 0 } };\n    };\n    Scroll.prototype.getThreshold = function () {\n        /* Some browsers places the scroller outside the content,\n         * hence the padding should be adjusted.*/\n        if (Browser.info.name === 'mozilla') {\n            return 0.5;\n        }\n        return 1;\n    };\n    /**\n     * @hidden\n     */\n    Scroll.prototype.setPadding = function () {\n        if (!this.parent.allowScrolling) {\n            return;\n        }\n        var colHeader = this.parent.getColumnHeaderContent();\n        var rowHeader = this.parent.getRowHeaderContent();\n        var scrollWidth = getScrollBarWidth() - this.getThreshold();\n        var cssProps = this.parent.enableRtl ? { padding: 'paddingLeft', border: 'borderLeftWidth' }\n            : { padding: 'paddingRight', border: 'borderRightWidth' };\n        if (scrollWidth > 0) {\n            colHeader.parentElement.style[cssProps.padding] = scrollWidth + 'px';\n            colHeader.style[cssProps.border] = '1px';\n            rowHeader.style.marginBottom = scrollWidth + 'px';\n        }\n    };\n    Scroll.prototype.addEventListener = function () {\n        this.parent.on(contentLoaded, this.wireEvents, this);\n        this.parent.on(onContentScroll, this.onContentScroll, this);\n        this.parent.on(deInitProperties, this.initProps, this);\n        this.parent.on(spreadsheetDestroyed, this.destroy, this);\n    };\n    Scroll.prototype.destroy = function () {\n        EventHandler.remove(this.parent.getMainContent(), 'scroll', this.onScroll);\n        this.removeEventListener();\n        this.parent = null;\n    };\n    Scroll.prototype.removeEventListener = function () {\n        if (!this.parent.isDestroyed) {\n            this.parent.off(contentLoaded, this.wireEvents);\n            this.parent.off(onContentScroll, this.onContentScroll);\n            this.parent.off(deInitProperties, this.initProps);\n            this.parent.off(spreadsheetDestroyed, this.destroy);\n        }\n    };\n    return Scroll;\n}());\nexport { Scroll };\n","import { isNullOrUndefined } from '@syncfusion/ej2-base';\nimport { spreadsheetDestroyed, beforeContentLoaded, beforeVirtualContentLoaded, virtualContentLoaded } from '../common/index';\nimport { onVerticalScroll, onHorizontalScroll, rowHeightChanged, beforeHeaderLoaded, deInitProperties } from '../common/index';\nimport { getRowHeight, getRowsHeight, getColumnWidth, getColumnsWidth } from './../../workbook/index';\nimport { getCellAddress } from '../../workbook/common/index';\nimport { updateUsedRange, sheetCreated, sheetsDestroyed } from '../../workbook/common/event';\n/**\n * VirtualScroll module\n * @hidden\n */\nvar VirtualScroll = /** @class */ (function () {\n    function VirtualScroll(parent) {\n        this.scroll = [];\n        this.parent = parent;\n        this.addEventListener();\n    }\n    VirtualScroll.prototype.getModuleName = function () {\n        return 'virtualscroll';\n    };\n    VirtualScroll.prototype.createVirtualElement = function (args) {\n        var sheet = this.parent.getActiveSheet();\n        var container = this.parent.getMainContent();\n        this.content = this.parent.createElement('div', { className: 'e-virtualable' });\n        this.content.appendChild(container.querySelector('.e-table'));\n        container.appendChild(this.content);\n        var vTrack = container.appendChild(this.parent.createElement('div', { className: 'e-virtualtrack' }));\n        var colVTrack;\n        var rowVTrack;\n        var height;\n        var width;\n        if (this.parent.sheets.length > this.scroll.length) {\n            this.initScroll();\n        }\n        var domCount = this.parent.viewport.rowCount + 1 + (this.parent.getThreshold('row') * 2);\n        if (sheet.rowCount > domCount || sheet.usedRange.rowIndex > domCount) {\n            if (sheet.rowCount < sheet.usedRange.rowIndex) {\n                sheet.rowCount = sheet.usedRange.rowIndex;\n            }\n            this.setScrollCount(sheet.rowCount, 'row');\n            height = getRowsHeight(sheet, domCount, this.scroll[this.parent.activeSheetTab - 1].rowCount - 1);\n        }\n        else {\n            this.scroll[this.parent.activeSheetTab - 1].rowCount = sheet.rowCount = domCount;\n            height = 1;\n        }\n        domCount = this.parent.viewport.colCount + 1 + (this.parent.getThreshold('col') * 2);\n        var size = getColumnsWidth(sheet, 0, domCount - 1);\n        if (sheet.colCount > domCount) {\n            if (sheet.colCount < sheet.usedRange.colIndex) {\n                sheet.colCount = sheet.usedRange.colIndex;\n            }\n            this.setScrollCount(sheet.colCount, 'col');\n            width = size + getColumnsWidth(sheet, domCount, this.scroll[this.parent.activeSheetTab - 1].colCount - 1);\n        }\n        else {\n            sheet.colCount = domCount;\n            width = size;\n        }\n        this.parent.setProperties({ 'sheets': this.parent.sheets }, true);\n        if (args.startColIdx) {\n            size = getColumnsWidth(sheet, args.startColIdx, args.startColIdx + domCount - 1);\n        }\n        if (isNullOrUndefined(this.translateX)) {\n            this.parent.viewport.leftIndex = 0;\n            this.translateX = 0;\n        }\n        if (isNullOrUndefined(this.translateY)) {\n            this.parent.viewport.topIndex = 0;\n            this.translateY = 0;\n        }\n        if (sheet.showHeaders) {\n            container = this.parent.getRowHeaderContent();\n            this.rowHeader = this.content.cloneNode();\n            this.rowHeader.appendChild(container.querySelector('.e-table'));\n            container.appendChild(this.rowHeader);\n            rowVTrack = container.appendChild(vTrack.cloneNode());\n            this.rowHeader.style.transform = \"translate(0px, \" + this.translateY + \"px)\";\n            container = this.parent.getColumnHeaderContent();\n            this.colHeader = this.content.cloneNode();\n            this.colHeader.appendChild(container.querySelector('.e-table'));\n            container.appendChild(this.colHeader);\n            colVTrack = container.appendChild(vTrack.cloneNode());\n            this.colHeader.style.width = size + \"px\";\n            rowVTrack.style.height = height + \"px\";\n            colVTrack.style.width = width + \"px\";\n            this.colHeader.style.transform = \"translate(\" + this.translateX + \"px, 0px)\";\n        }\n        this.content.style.transform = \"translate(\" + this.translateX + \"px, \" + this.translateY + \"px)\";\n        this.content.style.width = size + \"px\";\n        vTrack.style.height = height + \"px\";\n        vTrack.style.width = width + \"px\";\n    };\n    VirtualScroll.prototype.initScroll = function () {\n        var i = 0;\n        while (i < this.parent.sheets.length) {\n            if (!this.scroll[i]) {\n                this.scroll.push({ rowCount: 0, colCount: 0 });\n            }\n            i++;\n        }\n    };\n    VirtualScroll.prototype.setScrollCount = function (count, layout) {\n        var activeSheetIdx = this.parent.activeSheetTab - 1;\n        if (!this.scroll[activeSheetIdx][layout + 'Count']) {\n            this.scroll[activeSheetIdx][layout + 'Count'] = count;\n        }\n    };\n    VirtualScroll.prototype.getAddress = function (topIdx) {\n        return getCellAddress(topIdx[0], this.parent.viewport.leftIndex) + \":\" + getCellAddress(topIdx[1], this.parent.viewport.leftIndex + this.parent.viewport.colCount + (this.parent.getThreshold('col') * 2));\n    };\n    VirtualScroll.prototype.getColAddress = function (leftIdx) {\n        return getCellAddress(this.parent.viewport.topIndex, leftIdx[0]) + \":\" + getCellAddress(this.parent.viewport.topIndex + this.parent.viewport.rowCount + (this.parent.getThreshold('row') * 2), leftIdx[1]);\n    };\n    VirtualScroll.prototype.updateScrollCount = function (idx, layout, threshold) {\n        if (threshold === void 0) { threshold = idx; }\n        var sheet = this.parent.getActiveSheet();\n        var rowCount = idx + this.parent.viewport[layout + 'Count'] + 1 + threshold;\n        var usedRangeCount = this.scroll[this.parent.activeSheetTab - 1][layout + 'Count'];\n        if (rowCount < usedRangeCount) {\n            if (sheet[layout + 'Count'] === usedRangeCount) {\n                return;\n            }\n            rowCount = usedRangeCount;\n        }\n        if (!this.parent.scrollSettings.isFinite) {\n            sheet[layout + 'Count'] = rowCount;\n            this.parent.setProperties({ 'sheets': this.parent.sheets }, true);\n        }\n    };\n    VirtualScroll.prototype.onVerticalScroll = function (args) {\n        var idx = args.cur.idx;\n        var height = args.cur.size;\n        var prevIdx = args.prev.idx;\n        var idxDiff = Math.abs(idx - prevIdx);\n        var threshold = this.parent.getThreshold('row');\n        if (idxDiff > Math.round(threshold / 2)) {\n            if (idx <= threshold) {\n                if (!args.increase) {\n                    this.updateScrollCount(threshold, 'row');\n                    if (this.translateY && prevIdx > threshold) {\n                        this.translateY = 0;\n                        this.parent.viewport.topIndex = prevIdx - threshold;\n                        if (!args.preventScroll) {\n                            if (idxDiff < this.parent.viewport.rowCount + threshold) {\n                                this.parent.renderModule.refreshUI({ colIndex: this.parent.viewport.leftIndex, direction: 'last', refresh: 'RowPart' }, this.getAddress([0, this.parent.viewport.topIndex - 1]));\n                            }\n                            else {\n                                this.parent.renderModule.refreshUI({ rowIndex: 0, colIndex: this.parent.viewport.leftIndex, refresh: 'Row' });\n                            }\n                        }\n                        this.parent.viewport.topIndex = 0;\n                    }\n                }\n            }\n            if (prevIdx < threshold) {\n                idxDiff = Math.abs(idx - threshold);\n            }\n            if (idx > threshold) {\n                this.updateScrollCount(args.cur.idx, 'row', threshold);\n                this.parent.viewport.topIndex = idx - threshold;\n                this.translateY = height - this.getThresholdHeight(this.parent.viewport.topIndex, threshold);\n                if (!args.preventScroll) {\n                    if (idxDiff < this.parent.viewport.rowCount + threshold) {\n                        if (args.increase) {\n                            var lastIdx = this.parent.viewport.topIndex + this.parent.viewport.rowCount + (threshold * 2);\n                            this.parent.renderModule.refreshUI({ colIndex: this.parent.viewport.leftIndex, direction: 'first', refresh: 'RowPart' }, this.getAddress([lastIdx - idxDiff + 1, this.checkLastIdx(lastIdx, 'row')]));\n                        }\n                        else {\n                            this.parent.renderModule.refreshUI({ colIndex: this.parent.viewport.leftIndex, direction: 'last', refresh: 'RowPart' }, this.getAddress([this.parent.viewport.topIndex, this.parent.viewport.topIndex + idxDiff - 1]));\n                        }\n                    }\n                    else {\n                        this.parent.renderModule.refreshUI({\n                            rowIndex: this.parent.viewport.topIndex,\n                            colIndex: this.parent.viewport.leftIndex, refresh: 'Row'\n                        });\n                    }\n                }\n            }\n            args.prev.idx = idx;\n        }\n    };\n    VirtualScroll.prototype.checkLastIdx = function (idx, layout) {\n        if (this.parent.scrollSettings.isFinite) {\n            var count = this.parent.getActiveSheet()[layout + 'Count'] - 1;\n            if (idx > count) {\n                idx = count;\n            }\n        }\n        return idx;\n    };\n    VirtualScroll.prototype.onHorizontalScroll = function (args) {\n        var idx = args.cur.idx;\n        var width = args.cur.size;\n        var prevIdx = args.prev.idx;\n        var idxDiff = Math.abs(idx - prevIdx);\n        var threshold = this.parent.getThreshold('col');\n        if (idxDiff > Math.round(threshold / 2)) {\n            if (idx <= threshold) {\n                if (!args.increase) {\n                    this.updateScrollCount(threshold, 'col');\n                    if (this.translateX && prevIdx > threshold) {\n                        this.translateX = 0;\n                        this.parent.viewport.leftIndex = prevIdx - threshold;\n                        if (idxDiff < this.parent.viewport.rowCount + threshold) {\n                            this.parent.renderModule.refreshUI({ rowIndex: this.parent.viewport.topIndex, colIndex: 0, direction: 'last', refresh: 'ColumnPart' }, this.getColAddress([0, this.parent.viewport.leftIndex - 1]));\n                        }\n                        else {\n                            this.parent.renderModule.refreshUI({ rowIndex: this.parent.viewport.topIndex, colIndex: 0, refresh: 'Column' });\n                        }\n                        this.parent.viewport.leftIndex = 0;\n                    }\n                }\n            }\n            if (prevIdx < threshold) {\n                idxDiff = Math.abs(idx - threshold);\n            }\n            if (idx > threshold) {\n                this.updateScrollCount(args.cur.idx, 'col', threshold);\n                this.parent.viewport.leftIndex = idx - threshold;\n                this.translateX = width - this.getThresholdWidth(this.parent.viewport.leftIndex, threshold);\n                if (!args.preventScroll) {\n                    if (idxDiff < this.parent.viewport.colCount + threshold) {\n                        if (args.increase) {\n                            var lastIdx = this.parent.viewport.leftIndex + this.parent.viewport.colCount + (threshold * 2);\n                            this.parent.renderModule.refreshUI({\n                                rowIndex: this.parent.viewport.topIndex, colIndex: lastIdx - idxDiff + 1,\n                                direction: 'first', refresh: 'ColumnPart'\n                            }, this.getColAddress([lastIdx - idxDiff + 1, this.checkLastIdx(lastIdx, 'col')]));\n                        }\n                        else {\n                            this.parent.renderModule.refreshUI({\n                                rowIndex: this.parent.viewport.topIndex, colIndex: this.parent.viewport.leftIndex,\n                                direction: 'last', refresh: 'ColumnPart'\n                            }, this.getColAddress([this.parent.viewport.leftIndex, this.parent.viewport.leftIndex + idxDiff - 1]));\n                        }\n                    }\n                    else {\n                        this.parent.renderModule.refreshUI({\n                            rowIndex: this.parent.viewport.topIndex,\n                            colIndex: this.parent.viewport.leftIndex, refresh: 'Column'\n                        });\n                    }\n                }\n            }\n            args.prev.idx = idx;\n        }\n    };\n    VirtualScroll.prototype.getThresholdHeight = function (idx, threshold) {\n        var height = 0;\n        var sheet = this.parent.getActiveSheet();\n        for (var i = idx; i < idx + threshold; i++) {\n            height += getRowHeight(sheet, i);\n        }\n        return height;\n    };\n    VirtualScroll.prototype.getThresholdWidth = function (idx, threshold) {\n        var width = 0;\n        var sheet = this.parent.getActiveSheet();\n        for (var i = idx; i < idx + threshold; i++) {\n            width += getColumnWidth(sheet, i);\n        }\n        return width;\n    };\n    VirtualScroll.prototype.translate = function (args) {\n        var sheet = this.parent.getActiveSheet();\n        if (args.refresh === 'Row' || args.refresh === 'RowPart') {\n            this.content.style.transform = \"translate(\" + this.translateX + \"px, \" + this.translateY + \"px)\";\n            if (sheet.showHeaders) {\n                this.rowHeader.style.transform = \"translate(0px, \" + this.translateY + \"px)\";\n            }\n        }\n        if (args.refresh === 'Column' || args.refresh === 'ColumnPart') {\n            var translateX = this.parent.enableRtl ? -this.translateX : this.translateX;\n            this.content.style.transform = \"translate(\" + translateX + \"px, \" + this.translateY + \"px)\";\n            if (sheet.showHeaders) {\n                this.colHeader.style.transform = \"translate(\" + this.translateX + \"px, 0px)\";\n            }\n        }\n    };\n    VirtualScroll.prototype.updateColumnWidth = function (args) {\n        if (args.refresh === 'Column') {\n            this.content.style.width = '';\n            var width = this.content.querySelector('tr').getBoundingClientRect().width;\n            if (this.parent.getActiveSheet().showHeaders) {\n                this.colHeader.style.width = width + 'px';\n            }\n            this.content.style.width = width + 'px';\n        }\n    };\n    VirtualScroll.prototype.updateUsedRange = function (args) {\n        if (!this.scroll.length) {\n            return;\n        }\n        var sheet = this.parent.getActiveSheet();\n        if (args.update === 'row') {\n            if (args.index > this.scroll[this.parent.activeSheetTab - 1].rowCount) {\n                var height = this.getVTrackHeight('height');\n                height += getRowsHeight(sheet, this.scroll[this.parent.activeSheetTab - 1].rowCount, args.index);\n                this.scroll[this.parent.activeSheetTab - 1].rowCount = args.index + 1;\n                this.updateVTrack(this.rowHeader, height, 'height');\n                if (this.scroll[this.parent.activeSheetTab - 1].rowCount > sheet.rowCount) {\n                    sheet.rowCount = this.scroll[this.parent.activeSheetTab - 1].rowCount;\n                }\n            }\n        }\n        else {\n            if (args.index > this.scroll[this.parent.activeSheetTab - 1].colCount) {\n                var width = this.getVTrackHeight('width');\n                width += getColumnsWidth(sheet, this.scroll[this.parent.activeSheetTab - 1].colCount, args.index);\n                this.scroll[this.parent.activeSheetTab - 1].colCount = args.index + 1;\n                this.updateVTrack(this.colHeader, width, 'width');\n                if (this.scroll[this.parent.activeSheetTab - 1].colCount > sheet.colCount) {\n                    sheet.colCount = this.scroll[this.parent.activeSheetTab - 1].colCount;\n                }\n            }\n        }\n    };\n    VirtualScroll.prototype.createHeaderElement = function (args) {\n        this.rowHeader = this.content.cloneNode();\n        this.colHeader = this.rowHeader.cloneNode();\n        this.rowHeader.style.width = '';\n        this.rowHeader.style.transform = \"translate(0px, \" + this.translateY + \"px)\";\n        this.colHeader.style.transform = \"translate(\" + (this.parent.enableRtl ? -this.translateX : this.translateX) + \"px, 0px)\";\n        this.rowHeader.appendChild(args.element.querySelector('table'));\n        args.element.appendChild(this.rowHeader);\n        var container = this.parent.getColumnHeaderContent();\n        this.colHeader.appendChild(container.querySelector('table'));\n        container.appendChild(this.colHeader);\n        var rowVTrack = this.content.nextElementSibling.cloneNode();\n        var colVTrack = rowVTrack.cloneNode();\n        rowVTrack.style.width = '';\n        colVTrack.style.height = '';\n        args.element.appendChild(rowVTrack);\n        container.appendChild(colVTrack);\n    };\n    VirtualScroll.prototype.getVTrackHeight = function (str) {\n        return parseInt(this.content.nextElementSibling.style[str], 10);\n    };\n    VirtualScroll.prototype.updateVTrackHeight = function (args) {\n        var domCount = this.parent.viewport.rowCount + 1 + (this.parent.getThreshold('row') * 2);\n        if (args.rowIdx >= domCount && args.rowIdx < this.scroll[this.parent.activeSheetTab - 1].rowCount) {\n            this.updateVTrack(this.rowHeader, this.getVTrackHeight('height') + args.threshold, 'height');\n        }\n    };\n    VirtualScroll.prototype.updateVTrack = function (header, size, sizeStr) {\n        if (this.parent.getActiveSheet().showHeaders) {\n            header.nextElementSibling.style[sizeStr] = size + \"px\";\n        }\n        this.content.nextElementSibling.style[sizeStr] = size + \"px\";\n    };\n    VirtualScroll.prototype.deInitProps = function () {\n        this.parent.viewport.leftIndex = null;\n        this.parent.viewport.topIndex = null;\n        this.translateX = null;\n        this.translateY = null;\n    };\n    VirtualScroll.prototype.updateScrollProps = function (args) {\n        if (args === void 0) { args = { sheetIndex: 0 }; }\n        if (this.scroll.length === 0) {\n            this.initScroll();\n        }\n        else {\n            this.scroll.splice(args.sheetIndex, 0, { rowCount: 0, colCount: 0 });\n        }\n    };\n    VirtualScroll.prototype.sliceScrollProps = function (args) {\n        if (isNullOrUndefined(args.sheetIndex)) {\n            this.scroll.length = 0;\n        }\n        else {\n            this.scroll.splice(args.sheetIndex, 1);\n        }\n    };\n    VirtualScroll.prototype.addEventListener = function () {\n        this.parent.on(beforeContentLoaded, this.createVirtualElement, this);\n        this.parent.on(beforeVirtualContentLoaded, this.translate, this);\n        this.parent.on(virtualContentLoaded, this.updateColumnWidth, this);\n        this.parent.on(onVerticalScroll, this.onVerticalScroll, this);\n        this.parent.on(onHorizontalScroll, this.onHorizontalScroll, this);\n        this.parent.on(updateUsedRange, this.updateUsedRange, this);\n        this.parent.on(rowHeightChanged, this.updateVTrackHeight, this);\n        this.parent.on(beforeHeaderLoaded, this.createHeaderElement, this);\n        this.parent.on(deInitProperties, this.deInitProps, this);\n        this.parent.on(sheetsDestroyed, this.sliceScrollProps, this);\n        this.parent.on(sheetCreated, this.updateScrollProps, this);\n        this.parent.on(spreadsheetDestroyed, this.destroy, this);\n    };\n    VirtualScroll.prototype.destroy = function () {\n        this.removeEventListener();\n        this.rowHeader = null;\n        this.colHeader = null;\n        this.content = null;\n        this.parent = null;\n        this.scroll.length = 0;\n        this.translateX = null;\n        this.translateY = null;\n    };\n    VirtualScroll.prototype.removeEventListener = function () {\n        if (!this.parent.isDestroyed) {\n            this.parent.off(beforeContentLoaded, this.createVirtualElement);\n            this.parent.off(beforeVirtualContentLoaded, this.translate);\n            this.parent.off(virtualContentLoaded, this.updateColumnWidth);\n            this.parent.off(onVerticalScroll, this.onVerticalScroll);\n            this.parent.off(onHorizontalScroll, this.onHorizontalScroll);\n            this.parent.off(updateUsedRange, this.updateUsedRange);\n            this.parent.off(rowHeightChanged, this.updateVTrackHeight);\n            this.parent.off(beforeHeaderLoaded, this.createHeaderElement);\n            this.parent.off(sheetsDestroyed, this.sliceScrollProps);\n            this.parent.off(sheetCreated, this.updateScrollProps);\n            this.parent.off(spreadsheetDestroyed, this.destroy);\n        }\n    };\n    return VirtualScroll;\n}());\nexport { VirtualScroll };\n","import { keyDown, cellNavigate, renameSheet } from '../common/index';\nimport { getCellIndexes, getRangeAddress, getRowHeight, getColumnWidth } from '../../workbook/index';\nimport { closest } from '@syncfusion/ej2-base';\n/**\n * Represents keyboard navigation support for Spreadsheet.\n */\nvar KeyboardNavigation = /** @class */ (function () {\n    /**\n     * Constructor for the Spreadsheet Keyboard Navigation module.\n     * @private\n     */\n    function KeyboardNavigation(parent) {\n        this.parent = parent;\n        this.addEventListener();\n        /* code snippet */\n    }\n    KeyboardNavigation.prototype.addEventListener = function () {\n        this.parent.on(keyDown, this.keyDownHandler, this);\n        /* code snippet */\n    };\n    KeyboardNavigation.prototype.removeEventListener = function () {\n        if (!this.parent.isDestroyed) {\n            this.parent.off(keyDown, this.keyDownHandler);\n        }\n        /* code snippet */\n    };\n    KeyboardNavigation.prototype.keyDownHandler = function (e) {\n        if (!this.parent.isEdit && (document.activeElement.classList.contains('e-spreadsheet') ||\n            closest(document.activeElement, '.e-sheet'))) {\n            var isNavigate = void 0;\n            var scrollIdxes = void 0;\n            var sheet = this.parent.getActiveSheet();\n            var actIdxes = getCellIndexes(this.parent.getActiveSheet().activeCell);\n            if ([9, 37, 38, 39, 40].indexOf(e.keyCode) > -1) {\n                e.preventDefault();\n            }\n            if ((!e.shiftKey && e.keyCode === 37) || (e.shiftKey && e.keyCode === 9)) { //left key\n                if (actIdxes[1] > 0) {\n                    actIdxes[1] -= 1;\n                    isNavigate = true;\n                }\n                else {\n                    var content = this.parent.getMainContent();\n                    if (actIdxes[1] === 0 && content.scrollLeft) {\n                        content.scrollLeft = 0;\n                    }\n                }\n            }\n            else if ((!e.shiftKey && e.keyCode === 38) || (e.shiftKey && e.keyCode === 13)) { // Up key\n                if (actIdxes[0] > 0) {\n                    actIdxes[0] -= 1;\n                    isNavigate = true;\n                }\n                else {\n                    var content = this.parent.getMainContent();\n                    if (actIdxes[0] === 0 && content.scrollTop) {\n                        content.scrollTop = 0;\n                    }\n                }\n            }\n            else if ((!e.shiftKey && e.keyCode === 39) || e.keyCode === 9) { // Right key\n                if (actIdxes[1] < sheet.colCount - 1) {\n                    actIdxes[1] += 1;\n                    isNavigate = true;\n                }\n            }\n            else if ((!e.shiftKey && e.keyCode === 40) || e.keyCode === 13) { // Down Key\n                if (actIdxes[0] < sheet.rowCount - 1) {\n                    actIdxes[0] += 1;\n                    isNavigate = true;\n                }\n            }\n            /* else if (e.keyCode === 36) {\n                actIdxes[1] = 0;\n                if (e.ctrlKey) {\n                    actIdxes[0] = 0;\n                }\n                isNavigate = true;\n                e.preventDefault();\n            } else if (e.keyCode === 35 && e.ctrlKey) {\n                actIdxes = [sheet.usedRange.rowIndex, sheet.usedRange.colIndex];\n                scrollIdxes = [sheet.usedRange.rowIndex - this.parent.viewport.rowCount,\n                    sheet.usedRange.colIndex - this.parent.viewport.colCount];\n                isNavigate = true;\n                e.preventDefault();\n            } */\n            if (isNavigate) {\n                this.scrollNavigation(scrollIdxes || actIdxes, scrollIdxes ? true : false);\n                sheet.activeCell = getRangeAddress(actIdxes);\n                this.parent.setProperties({ 'sheets': this.parent.sheets }, true);\n                this.parent.notify(cellNavigate, { range: actIdxes });\n            }\n        }\n        var target = e.target;\n        if (target.classList.contains('e-sheet-rename')) {\n            if (e.keyCode === 32) {\n                e.stopPropagation();\n            }\n            else if (e.keyCode === 13 || e.keyCode === 27) {\n                this.parent.notify(renameSheet, e);\n            }\n        }\n    };\n    KeyboardNavigation.prototype.scrollNavigation = function (actIdxes, isScroll) {\n        var cont = this.parent.getMainContent();\n        var sheet = this.parent.getActiveSheet();\n        var prevActIdxes = getCellIndexes(sheet.activeCell);\n        var topLeftIdxes = getCellIndexes(sheet.topLeftCell);\n        if (this.getBottomIdx(topLeftIdxes) <= actIdxes[0] || isScroll) {\n            cont.scrollTop += getRowHeight(sheet, actIdxes[0]);\n        }\n        else if (topLeftIdxes[0] > actIdxes[0]) {\n            cont.scrollTop -= getRowHeight(sheet, actIdxes[0]);\n        }\n        if (this.getRightIdx(topLeftIdxes) <= actIdxes[1] || isScroll) {\n            cont.scrollLeft += getColumnWidth(sheet, actIdxes[1]);\n        }\n        else if (topLeftIdxes[1] > actIdxes[1]) {\n            cont.scrollLeft -= getColumnWidth(sheet, actIdxes[1]);\n        }\n    };\n    KeyboardNavigation.prototype.getBottomIdx = function (topLeftIdxes) {\n        var hgt = 0;\n        var sheet = this.parent.getActiveSheet();\n        for (var i = topLeftIdxes[0];; i++) {\n            hgt += getRowHeight(sheet, i);\n            if (hgt >= this.parent.viewport.height - 17) {\n                return i;\n            }\n        }\n    };\n    KeyboardNavigation.prototype.getRightIdx = function (topLeftIdxes) {\n        var width = 0;\n        var sheet = this.parent.getActiveSheet();\n        var contWidth = this.parent.getMainContent().offsetWidth;\n        for (var i = topLeftIdxes[1];; i++) {\n            width += getColumnWidth(sheet, i);\n            if (width >= contWidth - 17) {\n                return i;\n            }\n        }\n    };\n    /**\n     * For internal use only - Get the module name.\n     * @private\n     */\n    KeyboardNavigation.prototype.getModuleName = function () {\n        return 'keyboardNavigation';\n    };\n    KeyboardNavigation.prototype.destroy = function () {\n        this.removeEventListener();\n        this.parent = null;\n    };\n    return KeyboardNavigation;\n}());\nexport { KeyboardNavigation };\n","import { keyDown, cut, paste, copy, clearCopy } from '../common/index';\nimport { setCellFormat, textDecorationUpdate, getCellIndexes } from '../../workbook/common/index';\n/**\n * Represents keyboard shortcut support for Spreadsheet.\n */\nvar KeyboardShortcut = /** @class */ (function () {\n    /**\n     * Constructor for the Spreadsheet Keyboard Shortcut module.\n     * @private\n     */\n    function KeyboardShortcut(parent) {\n        this.parent = parent;\n        this.addEventListener();\n    }\n    KeyboardShortcut.prototype.addEventListener = function () {\n        this.parent.on(keyDown, this.keyDownHandler, this);\n    };\n    KeyboardShortcut.prototype.removeEventListener = function () {\n        if (!this.parent.isDestroyed) {\n            this.parent.off(keyDown, this.keyDownHandler);\n        }\n    };\n    KeyboardShortcut.prototype.keyDownHandler = function (e) {\n        if (e.ctrlKey) {\n            if ([79, 83, 65].indexOf(e.keyCode) > -1) {\n                e.preventDefault();\n            }\n            if (e.keyCode === 79) {\n                this.parent.element.querySelector('#' + this.parent.element.id + '_fileUpload').click();\n            }\n            else if (e.keyCode === 83) {\n                this.parent.save();\n            }\n            else if (e.keyCode === 88) {\n                this.parent.notify(cut, null);\n            }\n            else if (e.keyCode === 67) {\n                this.parent.notify(copy, null);\n            }\n            else if (e.keyCode === 86) {\n                this.parent.notify(paste, null);\n            }\n            else if (e.keyCode === 66) {\n                e.preventDefault();\n                var value = this.parent.getCellStyleValue(['fontWeight'], getCellIndexes(this.parent.getActiveSheet().activeCell)).fontWeight;\n                value = value === 'bold' ? 'normal' : 'bold';\n                this.parent.notify(setCellFormat, { style: { fontWeight: value }, onActionUpdate: true, refreshRibbon: true });\n            }\n            else if (e.keyCode === 73) {\n                e.preventDefault();\n                var value = this.parent.getCellStyleValue(['fontStyle'], getCellIndexes(this.parent.getActiveSheet().activeCell)).fontStyle;\n                value = value === 'italic' ? 'normal' : 'italic';\n                this.parent.notify(setCellFormat, { style: { fontStyle: value }, onActionUpdate: true, refreshRibbon: true });\n            }\n            else if (e.keyCode === 85) {\n                e.preventDefault();\n                this.parent.notify(textDecorationUpdate, { style: { textDecoration: 'underline' }, refreshRibbon: true });\n            }\n            else if (e.keyCode === 53) {\n                e.preventDefault();\n                this.parent.notify(textDecorationUpdate, { style: { textDecoration: 'line-through' }, refreshRibbon: true });\n            }\n        }\n        if (e.keyCode === 27) {\n            this.parent.notify(clearCopy, null);\n        }\n    };\n    KeyboardShortcut.prototype.getModuleName = function () {\n        return 'keyboardShortcut';\n    };\n    KeyboardShortcut.prototype.destroy = function () {\n        this.removeEventListener();\n        this.parent = null;\n    };\n    return KeyboardShortcut;\n}());\nexport { KeyboardShortcut };\n","import { rowHeightChanged } from '../common/index';\nimport { getRowHeight, setRowHeight, applyCellFormat } from '../../workbook/index';\n/**\n * CellFormat module allows to format the cell styles.\n */\nvar CellFormat = /** @class */ (function () {\n    function CellFormat(parent) {\n        this.checkHeight = false;\n        //Spreadsheet.Inject(WorkbookCellFormat);\n        this.parent = parent;\n        this.row = parent.createElement('tr', { className: 'e-row' });\n        this.addEventListener();\n    }\n    CellFormat.prototype.applyCellFormat = function (args) {\n        var keys = Object.keys(args.style);\n        if (args.lastCell && !this.row.childElementCount && !keys.length) {\n            return;\n        }\n        var cell = args.cell || this.parent.getCell(args.rowIdx, args.colIdx);\n        if (cell) {\n            Object.assign(cell.style, args.style);\n            if (args.isHeightCheckNeeded) {\n                if (!args.manualUpdate) {\n                    if (this.isHeightCheckNeeded(args.style)) {\n                        var clonedCell = cell.cloneNode(true);\n                        if (!clonedCell.innerHTML) {\n                            clonedCell.textContent = 'Test';\n                        }\n                        this.row.appendChild(clonedCell);\n                    }\n                    if (args.lastCell && this.row.childElementCount) {\n                        var sheet = this.parent.getActiveSheet();\n                        var row = this.parent.getRow(args.rowIdx) || args.row;\n                        var prevHeight = getRowHeight(sheet, args.rowIdx);\n                        var height = this.getRowHeightOnInit();\n                        if (height > prevHeight) {\n                            row.style.height = height + \"px\";\n                            if (sheet.showHeaders) {\n                                (this.parent.getRow(args.rowIdx, this.parent.getRowHeaderTable()) || args.hRow).style.height =\n                                    height + \"px\";\n                            }\n                            setRowHeight(sheet, args.rowIdx, height);\n                        }\n                        this.row.innerHTML = '';\n                    }\n                }\n                else {\n                    if (!this.checkHeight) {\n                        this.checkHeight = this.isHeightCheckNeeded(args.style, args.onActionUpdate);\n                    }\n                    this.updateRowHeight(cell, args.rowIdx, args.lastCell, args.onActionUpdate);\n                }\n            }\n        }\n        else {\n            this.updateRowHeight(cell, args.rowIdx, true, args.onActionUpdate);\n        }\n    };\n    CellFormat.prototype.updateRowHeight = function (cell, rowIdx, isLastCell, onActionUpdate) {\n        if (this.checkHeight && isLastCell) {\n            this.checkHeight = false;\n            var sheet = this.parent.getActiveSheet();\n            var row = this.parent.getRow(rowIdx);\n            if (!row) {\n                return;\n            }\n            if (!cell) {\n                cell = row.lastElementChild;\n            }\n            var test = false;\n            row.style.height = '';\n            if (!cell.innerHTML) {\n                cell.textContent = 'test';\n                test = true;\n            }\n            var height = Math.ceil(row.getBoundingClientRect().height);\n            if (test) {\n                cell.textContent = '';\n            }\n            height = height < 20 ? 20 : height;\n            var prevHeight = getRowHeight(sheet, rowIdx);\n            var heightChanged = onActionUpdate ? height !== prevHeight : height > prevHeight;\n            if (heightChanged) {\n                row.style.height = height + \"px\";\n                if (sheet.showHeaders) {\n                    this.parent.getRow(rowIdx, this.parent.getRowHeaderTable()).style.height = height + \"px\";\n                }\n                setRowHeight(sheet, rowIdx, height);\n                this.parent.notify(rowHeightChanged, { rowIdx: rowIdx, threshold: height - prevHeight });\n            }\n            else {\n                row.style.height = prevHeight + \"px\";\n            }\n        }\n    };\n    CellFormat.prototype.isHeightCheckNeeded = function (style, onActionUpdate) {\n        var keys = Object.keys(style);\n        return (onActionUpdate ? keys.indexOf('fontSize') > -1 : keys.indexOf('fontSize') > -1\n            && Number(style.fontSize.split('pt')[0]) > 12) || keys.indexOf('fontFamily') > -1;\n    };\n    CellFormat.prototype.getRowHeightOnInit = function () {\n        var table = this.parent.createElement('table', { className: 'e-table e-test-table' });\n        var tBody = table.appendChild(this.parent.createElement('tbody'));\n        tBody.appendChild(this.row);\n        this.parent.element.appendChild(table);\n        var height = Math.round(this.row.getBoundingClientRect().height);\n        this.parent.element.removeChild(table);\n        return height < 20 ? 20 : height;\n    };\n    CellFormat.prototype.addEventListener = function () {\n        this.parent.on(applyCellFormat, this.applyCellFormat.bind(this));\n    };\n    CellFormat.prototype.removeEventListener = function () {\n        if (!this.parent.isDestroyed) {\n            this.parent.on(applyCellFormat, this.applyCellFormat.bind(this));\n        }\n    };\n    /**\n     * Destroy cell format module.\n     */\n    CellFormat.prototype.destroy = function () {\n        this.removeEventListener();\n        this.parent = null;\n        this.row = null;\n        this.checkHeight = null;\n    };\n    /**\n     * Get the cell format module name.\n     */\n    CellFormat.prototype.getModuleName = function () {\n        return 'cellformat';\n    };\n    return CellFormat;\n}());\nexport { CellFormat };\n","var __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    }\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nimport { Component, Property, NotifyPropertyChanges, Event, ChildProperty } from '@syncfusion/ej2-base';\nimport { getComponent, closest, EventHandler } from '@syncfusion/ej2-base';\nimport { Collection, Complex } from '@syncfusion/ej2-base';\nimport { Tab, Toolbar } from '@syncfusion/ej2-navigations';\nimport { Menu, Header, Item, MenuItem } from '@syncfusion/ej2-navigations';\n/**\n * An array of object that is used to configure the Tab.\n */\nvar RibbonItem = /** @class */ (function (_super) {\n    __extends(RibbonItem, _super);\n    function RibbonItem() {\n        return _super !== null && _super.apply(this, arguments) || this;\n    }\n    __decorate([\n        Complex({}, Header)\n    ], RibbonItem.prototype, \"header\", void 0);\n    __decorate([\n        Collection([], Item)\n    ], RibbonItem.prototype, \"content\", void 0);\n    __decorate([\n        Property({})\n    ], RibbonItem.prototype, \"cssClass\", void 0);\n    __decorate([\n        Property(false)\n    ], RibbonItem.prototype, \"disabled\", void 0);\n    __decorate([\n        Property('Tab')\n    ], RibbonItem.prototype, \"type\", void 0);\n    __decorate([\n        Collection([], MenuItem)\n    ], RibbonItem.prototype, \"menuItems\", void 0);\n    return RibbonItem;\n}(ChildProperty));\nexport { RibbonItem };\n/**\n * Represents Ribbon component.\n */\nvar Ribbon = /** @class */ (function (_super) {\n    __extends(Ribbon, _super);\n    /**\n     * Constructor for creating the widget.\n     * @param  {RibbonModel} options?\n     * @param  {string|HTMLDivElement} element?\n     */\n    function Ribbon(options, element) {\n        return _super.call(this, options) || this;\n    }\n    /**\n     * For internal use only.\n     * @returns void\n     * @private\n     */\n    Ribbon.prototype.preRender = function () {\n        /** */\n    };\n    /**\n     * For internal use only.\n     * @returns void\n     * @private\n     */\n    Ribbon.prototype.render = function () {\n        this.renderRibbon();\n    };\n    /**\n     * Destroys the component (detaches/removes all event handlers, attributes, classes, and empties the component element).\n     * @method destroy\n     * @return {void}\n     */\n    Ribbon.prototype.destroy = function () {\n        this.destroyComponent(this.element.querySelector('.e-file-menu'), Menu);\n        var expandCollapseElem = this.tabObj.element.querySelector('.e-drop-icon');\n        if (expandCollapseElem) {\n            expandCollapseElem.removeEventListener('click', this.ribbonExpandCollapse.bind(this));\n        }\n        this.toolbarObj.destroy();\n        this.tabObj.destroy();\n        _super.prototype.destroy.call(this);\n    };\n    Ribbon.prototype.getTabItems = function () {\n        var _this = this;\n        var tabItems = [];\n        this.items.forEach(function (item) {\n            switch (item.type) {\n                case 'Menu':\n                    tabItems.push({\n                        header: { text: _this.initMenu(item.menuItems) },\n                        content: _this.toolbarObj.element\n                    });\n                    break;\n                case 'Tab':\n                    tabItems.push({\n                        header: item.header,\n                        content: _this.toolbarObj.element\n                    });\n                    break;\n            }\n        });\n        return tabItems;\n    };\n    Ribbon.prototype.initMenu = function (menuItems) {\n        var _this = this;\n        var menu = this.createElement('ul');\n        this.element.appendChild(menu);\n        var menuObj = new Menu({\n            cssClass: 'e-file-menu',\n            items: menuItems,\n            showItemOnClick: true,\n            beforeOpen: function (args) {\n                if (args.parentItem.text === menuItems[0].text) {\n                    menuObj.showItemOnClick = false;\n                }\n                _this.trigger('beforeOpen', args);\n            },\n            select: function (args) {\n                _this.trigger('fileItemSelect', args);\n            },\n            beforeClose: function (args) {\n                if (args.event.type === 'mouseover' && !closest(args.event.target, '.e-menu-popup')) {\n                    args.cancel = true;\n                    return;\n                }\n                _this.trigger('beforeClose', args);\n                if (!args.parentItem || args.parentItem.text === menuItems[0].text) {\n                    requestAnimationFrame(function () { return menuObj.setProperties({ showItemOnClick: true }, true); });\n                }\n            }\n        });\n        menuObj.createElement = this.createElement;\n        menuObj.appendTo(menu);\n        return menu.parentElement;\n    };\n    Ribbon.prototype.renderRibbon = function () {\n        var _this = this;\n        var tabElement = this.createElement('div');\n        var tBarElement = this.createElement('div');\n        this.toolbarObj = new Toolbar({\n            clicked: function (args) {\n                _this.trigger('clicked', args);\n            }\n        });\n        this.toolbarObj.createElement = this.createElement;\n        this.toolbarObj.appendTo(tBarElement);\n        this.tabObj = new Tab({\n            selectedItem: 1,\n            animation: { next: { duration: 0 }, previous: { duration: 0 } },\n            items: this.getTabItems(),\n            selecting: function (args) {\n                if (_this.items[args.selectingIndex].type === 'Menu') {\n                    args.cancel = true;\n                }\n                else {\n                    _this.toolbarObj.items = _this.items[args.selectingIndex].content;\n                    _this.toolbarObj.dataBind();\n                    if (_this.element.classList.contains('e-collapsed')) {\n                        EventHandler.remove(_this.tabObj.element.querySelector('.e-tab-header .e-toolbar-item.e-active'), 'click', _this.ribbonExpandCollapse);\n                    }\n                }\n                _this.trigger('selecting', args);\n            },\n            selected: function () {\n                if (_this.element.classList.contains('e-collapsed')) {\n                    _this.element.classList.remove('e-collapsed');\n                    _this.trigger('expandCollapse', { element: _this.toolbarObj.element, expanded: true });\n                }\n            },\n            created: function () {\n                var collapseBtn = _this.createElement('span', { className: 'e-drop-icon e-icons' });\n                collapseBtn.addEventListener('click', _this.ribbonExpandCollapse.bind(_this));\n                _this.tabObj.element.querySelector('.e-tab-header').appendChild(collapseBtn);\n                _this.toolbarObj.refreshOverflow();\n            }\n        });\n        this.element.appendChild(tabElement);\n        this.tabObj.createElement = this.createElement;\n        this.tabObj.appendTo(tabElement);\n    };\n    Ribbon.prototype.ribbonExpandCollapse = function (e) {\n        var eventArgs = { element: this.toolbarObj.element, expanded: true };\n        var activeTab = this.tabObj.element.querySelector('.e-tab-header .e-toolbar-item.e-active');\n        if (this.element.classList.contains('e-collapsed')) {\n            this.element.classList.remove('e-collapsed');\n            EventHandler.remove(activeTab, 'click', this.ribbonExpandCollapse);\n            this.trigger('expandCollapse', eventArgs);\n        }\n        else {\n            this.element.classList.add('e-collapsed');\n            eventArgs.expanded = false;\n            EventHandler.add(activeTab, 'click', this.ribbonExpandCollapse, this);\n            this.trigger('expandCollapse', eventArgs);\n        }\n    };\n    /**\n     * Enables or disables the specified Ribbon items or all ribbon items.\n     * @param  {boolean} enable  - Boolean value that determines whether the command should be enabled or disabled.\n     * @param  {HTMLElement} items - DOM element or an array of items to be enabled or disabled.\n     * By default, `isEnable` is set to true.\n     * @returns void.\n     */\n    Ribbon.prototype.enableItems = function (enable, items) {\n        if (items) {\n            this.toolbarObj.enableItems(items, enable);\n        }\n        else {\n            this.toolbarObj.disable(!enable);\n        }\n    };\n    /**\n     * Get component name.\n     * @returns string\n     * @private\n     */\n    Ribbon.prototype.getModuleName = function () {\n        return 'ribbon';\n    };\n    /**\n     * Get the properties to be maintained in the persisted state.\n     * @returns string\n     * @private\n     */\n    Ribbon.prototype.getPersistData = function () {\n        return this.addOnPersist([]);\n    };\n    /**\n     * Called internally if any of the property value changed.\n     * @param  {RibbonModel} newProp\n     * @param  {RibbonModel} oldProp\n     * @returns void\n     * @private\n     */\n    Ribbon.prototype.onPropertyChanged = function (newProp, oldProp) {\n        /** code snippets */\n    };\n    Ribbon.prototype.destroyComponent = function (element, component) {\n        if (element) {\n            var compObj = getComponent(element, component);\n            if (compObj) {\n                compObj.destroy();\n            }\n        }\n    };\n    __decorate([\n        Property('')\n    ], Ribbon.prototype, \"cssClass\", void 0);\n    __decorate([\n        Collection([], RibbonItem)\n    ], Ribbon.prototype, \"items\", void 0);\n    __decorate([\n        Event()\n    ], Ribbon.prototype, \"selecting\", void 0);\n    __decorate([\n        Event()\n    ], Ribbon.prototype, \"fileItemSelect\", void 0);\n    __decorate([\n        Event()\n    ], Ribbon.prototype, \"beforeOpen\", void 0);\n    __decorate([\n        Event()\n    ], Ribbon.prototype, \"beforeClose\", void 0);\n    __decorate([\n        Event()\n    ], Ribbon.prototype, \"selectFormat\", void 0);\n    __decorate([\n        Event()\n    ], Ribbon.prototype, \"clicked\", void 0);\n    __decorate([\n        Event()\n    ], Ribbon.prototype, \"created\", void 0);\n    __decorate([\n        Event()\n    ], Ribbon.prototype, \"expandCollapse\", void 0);\n    Ribbon = __decorate([\n        NotifyPropertyChanges\n    ], Ribbon);\n    return Ribbon;\n}(Component));\nexport { Ribbon };\n","import { ColorPicker as ColorPickerComponent } from '@syncfusion/ej2-inputs';\nimport { addClass } from '@syncfusion/ej2-base';\nimport { spreadsheetDestroyed, fontColor, fillColor, beforeRibbonCreate, locale } from '../common/index';\nimport { destroyComponent } from '../common/index';\n/**\n * `Color Picker` module is used to handle ColorPicker functionality.\n * @hidden\n */\nvar ColorPicker = /** @class */ (function () {\n    function ColorPicker(parent) {\n        this.parent = parent;\n        this.addEventListener();\n    }\n    ColorPicker.prototype.render = function () {\n        var _this = this;\n        var id = this.parent.element.id;\n        var input = this.parent.createElement('input', { attrs: { 'type': 'color' } });\n        var fontColorPicker = new ColorPickerComponent({\n            value: '#000000ff',\n            mode: 'Palette',\n            showButtons: false,\n            presetColors: fontColor,\n            enableOpacity: false,\n            beforeClose: function (args) { return _this.beforeCloseHandler(fontColorPicker); },\n            open: this.openHandler.bind(this),\n            beforeModeSwitch: function (args) { return _this.beforeModeSwitch(fontColorPicker, args); },\n            change: function (args) {\n                var color = fontColorPicker.getValue(args.currentValue.rgba);\n                _this.updateSelectedColor(color, fontColorPicker.element);\n                _this.parent.cellFormat({ color: color });\n                _this.parent.element.focus();\n            },\n            created: function () { return _this.wireFocusEvent(fontColorPicker.element, '#000000'); }\n        });\n        fontColorPicker.createElement = this.parent.createElement;\n        this.parent.element.appendChild(input);\n        fontColorPicker.appendTo(input);\n        input.parentElement.id = id + \"_font_color_picker\";\n        addClass([input.nextElementSibling.getElementsByClassName('e-selected-color')[0]], ['e-icons', 'e-font-color']);\n        input = this.parent.createElement('input', { attrs: { 'type': 'color' } });\n        var filColorPicker = new ColorPickerComponent({\n            value: '#ffff00ff',\n            mode: 'Palette',\n            presetColors: fillColor,\n            showButtons: false,\n            enableOpacity: false,\n            open: this.openHandler.bind(this),\n            beforeClose: function (args) { return _this.beforeCloseHandler(filColorPicker); },\n            beforeModeSwitch: function (args) { return _this.beforeModeSwitch(filColorPicker, args); },\n            change: function (args) {\n                var color = filColorPicker.getValue(args.currentValue.rgba);\n                _this.updateSelectedColor(color, filColorPicker.element);\n                _this.parent.cellFormat({ backgroundColor: color });\n                _this.parent.element.focus();\n            },\n            created: function () { return _this.wireFocusEvent(filColorPicker.element, '#ffff00'); }\n        });\n        filColorPicker.createElement = this.parent.createElement;\n        this.parent.element.appendChild(input);\n        filColorPicker.appendTo(input);\n        input.parentElement.id = id + \"_fill_color_picker\";\n        addClass([input.nextElementSibling.getElementsByClassName('e-selected-color')[0]], ['e-icons', 'e-fill-color']);\n    };\n    ColorPicker.prototype.updateSelectedColor = function (color, ele) {\n        ele.nextElementSibling.querySelector('.e-selected-color').style.borderBottomColor = color;\n    };\n    ColorPicker.prototype.wireFocusEvent = function (element, color) {\n        var _this = this;\n        this.updateSelectedColor(color, element);\n        element = element.parentElement.querySelector('.e-split-colorpicker');\n        element.addEventListener('focus', function () {\n            _this.parent.element.focus();\n        });\n    };\n    ColorPicker.prototype.openHandler = function (args) {\n        args.element.querySelector('.e-mode-switch-btn').title =\n            this.parent.serviceLocator.getService(locale).getConstant('MoreColors');\n    };\n    ColorPicker.prototype.beforeCloseHandler = function (inst) {\n        if (!inst.modeSwitcher) {\n            inst.setProperties({ modeSwitcher: true }, true);\n        }\n        if (inst.showButtons) {\n            inst.setProperties({ showButtons: false }, true);\n        }\n    };\n    ColorPicker.prototype.beforeModeSwitch = function (inst, args) {\n        var l10n = this.parent.serviceLocator.getService(locale);\n        if (args.mode === 'Picker') {\n            inst.showButtons = true;\n            inst.dataBind();\n            args.element.querySelector('.e-apply').title = l10n.getConstant('Apply');\n            args.element.querySelector('.e-cancel').title = l10n.getConstant('Cancel');\n            args.element.querySelector('.e-mode-switch-btn').title = l10n.getConstant('StandardColors');\n        }\n        else {\n            inst.showButtons = false;\n            inst.dataBind();\n            args.element.querySelector('.e-mode-switch-btn').title = l10n.getConstant('MoreColors');\n        }\n    };\n    ColorPicker.prototype.destroy = function () {\n        this.removeEventListener();\n        var id = this.parent.element.id;\n        this.destroyColorPicker(id + \"_font_color_picker\");\n        this.destroyColorPicker(id + \"_fill_color_picker\");\n        this.parent = null;\n    };\n    ColorPicker.prototype.destroyColorPicker = function (id) {\n        var ele = document.getElementById(id);\n        if (ele) {\n            destroyComponent(ele.firstElementChild, ColorPickerComponent);\n        }\n    };\n    ColorPicker.prototype.addEventListener = function () {\n        this.parent.on(beforeRibbonCreate, this.render, this);\n        this.parent.on(spreadsheetDestroyed, this.destroy, this);\n    };\n    ColorPicker.prototype.removeEventListener = function () {\n        if (!this.parent.isDestroyed) {\n            this.parent.off(beforeRibbonCreate, this.render);\n            this.parent.off(spreadsheetDestroyed, this.destroy);\n        }\n    };\n    return ColorPicker;\n}());\nexport { ColorPicker };\n","import { Ribbon as RibbonComponent } from '../../ribbon/index';\nimport { ribbon, selectionComplete, beforeRibbonCreate, dialog, destroyComponent } from '../common/index';\nimport { enableRibbonItems, ribbonClick, paste, locale, refreshSheetTabs } from '../common/index';\nimport { tabSwitch, getUpdateUsingRaf, enableToolbar } from '../common/index';\nimport { Toolbar, Menu } from '@syncfusion/ej2-navigations';\nimport { extend, isNullOrUndefined, getComponent, closest, detach } from '@syncfusion/ej2-base';\nimport { getCellIndexes, getFormatFromType, getTypeFromFormat } from '../../workbook/index';\nimport { DropDownButton, SplitButton } from '@syncfusion/ej2-splitbuttons';\nimport { calculatePosition } from '@syncfusion/ej2-popups';\nimport { applyNumberFormatting, getFormattedCellObject, activeCellChanged, textDecorationUpdate } from '../../workbook/common/index';\nimport { sheetsDestroyed } from '../../workbook/common/index';\nimport { NumberFormatType, getCell, setCellFormat } from '../../workbook/index';\nimport { Button } from '@syncfusion/ej2-buttons';\nimport { ColorPicker } from './color-picker';\n/**\n * Represents Ribbon for Spreadsheet.\n */\nvar Ribbon = /** @class */ (function () {\n    function Ribbon(parent) {\n        this.fontNameIndex = 5;\n        this.numPopupWidth = 0;\n        this.activeTab = 1;\n        this.parent = parent;\n        this.addEventListener();\n        new ColorPicker(parent);\n    }\n    Ribbon.prototype.getModuleName = function () {\n        return 'ribbon';\n    };\n    Ribbon.prototype.initRibbon = function (args) {\n        if (!this.parent.showRibbon && this.ribbon) {\n            this.destroy();\n            return;\n        }\n        this.parent.notify(beforeRibbonCreate, {});\n        if (this.parent.isMobileView()) {\n            this.createMobileView();\n        }\n        else {\n            this.createRibbon(args);\n        }\n    };\n    Ribbon.prototype.getRibbonItems = function () {\n        var text;\n        var id = this.parent.element.id;\n        var l10n = this.parent.serviceLocator.getService(locale);\n        var items = [\n            {\n                type: 'Menu',\n                menuItems: [\n                    {\n                        text: this.parent.isMobileView() ? '' : l10n.getConstant('File'),\n                        iconCss: this.parent.isMobileView() ? 'e-icons e-file-menu-icon' : null,\n                        items: [\n                            { text: l10n.getConstant('New'), id: 'New', iconCss: 'e-new e-icons' },\n                            { text: l10n.getConstant('Open'), id: 'Open', iconCss: 'e-open e-icons' },\n                            {\n                                text: l10n.getConstant('SaveAs'),\n                                iconCss: 'e-save e-icons',\n                                items: [\n                                    { text: l10n.getConstant('ExcelXlsx'), id: 'Xlsx', iconCss: 'e-xlsx e-icons' },\n                                    { text: l10n.getConstant('ExcelXls'), id: 'Xls', iconCss: 'e-xls e-icons' },\n                                    { text: l10n.getConstant('CSV'), id: 'Csv', iconCss: 'e-csv e-icons' }\n                                ]\n                            }\n                        ]\n                    }\n                ]\n            },\n            {\n                header: { text: l10n.getConstant('Home') },\n                content: [\n                    { prefixIcon: 'e-cut-icon', tooltipText: l10n.getConstant('Cut') + \" (Ctrl+X)\", id: id + '_cut' },\n                    { prefixIcon: 'e-copy-icon', tooltipText: l10n.getConstant('Copy') + \" (Ctrl+C)\", id: id + '_copy' },\n                    { tooltipText: l10n.getConstant('Paste') + \" (Ctrl+V)\", template: this.getPasteBtn() },\n                    { type: 'Separator' },\n                    { template: this.parent.createElement('button', { id: id + '_number_format' }),\n                        tooltipText: l10n.getConstant('NumberFormat') }, { type: 'Separator' },\n                    { template: this.parent.createElement('button', { id: id + '_font_name' }),\n                        tooltipText: l10n.getConstant('Font') }, { type: 'Separator' },\n                    { template: this.parent.createElement('button', { id: id + '_font_size' }),\n                        tooltipText: l10n.getConstant('FontSize') }, { type: 'Separator' },\n                    { template: this.parent.createElement('button', { id: id + '_bold' }),\n                        tooltipText: l10n.getConstant('Bold') + \" (Ctrl+B)\" },\n                    { template: this.parent.createElement('button', { id: id + '_italic' }),\n                        tooltipText: l10n.getConstant('Italic') + \" (Ctrl+I)\" },\n                    { template: this.parent.createElement('button', { id: id + '_line-through' }),\n                        tooltipText: l10n.getConstant('Strikethrough') + \" (Ctrl+5)\" },\n                    { template: this.parent.createElement('button', { id: id + '_underline' }),\n                        tooltipText: l10n.getConstant('Underline') + \" (Ctrl+U)\" },\n                    { template: document.getElementById(id + \"_font_color_picker\"), tooltipText: l10n.getConstant('TextColor') },\n                    { type: 'Separator' },\n                    { template: document.getElementById(id + \"_fill_color_picker\"), tooltipText: l10n.getConstant('FillColor') },\n                    { type: 'Separator' }, { template: this.parent.createElement('button', { id: id + '_text_align' }),\n                        tooltipText: l10n.getConstant('HorizontalAlignment') },\n                    { template: this.parent.createElement('button', { id: id + '_vertical_align' }),\n                        tooltipText: l10n.getConstant('VerticalAlignment') }\n                ]\n            },\n            {\n                header: { text: l10n.getConstant('Formulas') },\n                content: [{ prefixIcon: 'e-insert-function', text: l10n.getConstant('InsertFunction'), id: id + '_insert_function' }]\n            },\n            {\n                header: { text: 'View' },\n                content: [\n                    { prefixIcon: 'e-hide-headers', text: this.getLocaleText(l10n, 'Headers'), id: id + '_headers' }, { type: 'Separator' },\n                    { prefixIcon: 'e-hide-gridlines', text: this.getLocaleText(l10n, 'GridLines'), id: id + '_gridlines' }\n                ]\n            }\n        ];\n        return items;\n    };\n    Ribbon.prototype.getPasteBtn = function () {\n        var _this = this;\n        var btn = this.parent.element.appendChild(this.parent.createElement('button', { id: this.parent.element.id + '_paste' }));\n        var l10n = this.parent.serviceLocator.getService(locale);\n        var pasteSplitBtn = new SplitButton({\n            iconCss: 'e-icons e-paste-icon',\n            items: [\n                { text: l10n.getConstant('All'), id: 'All' },\n                { text: l10n.getConstant('Values'), id: 'Values' },\n                { text: l10n.getConstant('Formats'), id: 'Formats' }\n            ],\n            select: function (args) {\n                _this.parent.notify(paste, { type: args.item.id });\n            },\n            click: function () {\n                _this.parent.notify(paste, null);\n            },\n            close: function () { _this.parent.element.focus(); }\n        });\n        pasteSplitBtn.createElement = this.parent.createElement;\n        pasteSplitBtn.appendTo(btn);\n        return btn.parentElement;\n    };\n    Ribbon.prototype.getLocaleText = function (l10n, str, setClass) {\n        var text;\n        var sheet = this.parent.getActiveSheet();\n        if (sheet['show' + str]) {\n            if (setClass) {\n                this.parent.getMainContent().classList.remove('e-hide-' + str.toLowerCase());\n            }\n            text = l10n.getConstant('Hide' + str);\n        }\n        else {\n            if (setClass) {\n                this.parent.getMainContent().classList.add('e-hide-' + str.toLowerCase());\n            }\n            text = l10n.getConstant('Show' + str);\n        }\n        return text;\n    };\n    Ribbon.prototype.createRibbon = function (args) {\n        var ribbonElement = this.parent.createElement('div');\n        this.ribbon = new RibbonComponent({\n            items: this.getRibbonItems(),\n            fileItemSelect: this.fileItemSelect.bind(this),\n            beforeOpen: this.fileMenuBeforeOpen.bind(this),\n            beforeClose: this.fileMenuBeforeClose.bind(this),\n            clicked: this.toolbarClicked.bind(this),\n            created: this.ribbonCreated.bind(this),\n            selecting: this.tabSelecting.bind(this),\n            expandCollapse: this.expandCollapseHandler.bind(this)\n        });\n        this.ribbon.createElement = this.parent.createElement;\n        if (args && args.uiUpdate) {\n            var refEle = this.parent.element.querySelector('.e-formula-bar-panel') ||\n                document.getElementById(this.parent.element.id + '_sheet_panel');\n            this.parent.element.insertBefore(ribbonElement, refEle);\n        }\n        else {\n            this.parent.element.appendChild(ribbonElement);\n        }\n        this.ribbon.appendTo(ribbonElement);\n    };\n    Ribbon.prototype.tabSelecting = function (args) {\n        if (args.selectingIndex && args.selectingIndex !== this.activeTab) {\n            this.activeTab = args.selectingIndex;\n            this.refreshRibbonContent();\n            this.parent.notify(tabSwitch, { idx: args.selectingIndex });\n        }\n    };\n    Ribbon.prototype.ribbonCreated = function () {\n        var _this = this;\n        var id = this.parent.element.id;\n        var l10n = this.parent.serviceLocator.getService(locale);\n        var numFormatBtn = document.getElementById(id + '_number_format');\n        numFormatBtn.appendChild(this.parent.createElement('span', { className: 'e-tbar-btn-text', innerHTML: 'General' }));\n        this.numFormatDDB = new DropDownButton({\n            items: this.getNumFormatDdbItems(l10n, id),\n            content: '',\n            select: function (args) { return _this.numDDBSelect(args); },\n            open: function (args) { return _this.numDDBOpen(args); },\n            beforeItemRender: function (args) { return _this.previewNumFormat(args); },\n            close: function () { return _this.parent.element.focus(); },\n            cssClass: 'e-flat e-numformat-ddb',\n            beforeOpen: this.tBarDdbBeforeOpen.bind(this)\n        });\n        this.numFormatDDB.createElement = this.parent.createElement;\n        this.numFormatDDB.appendTo(numFormatBtn);\n        if (this.parent.enableClipboard) {\n            this.enableRibbonItems({ id: id + '_paste', isEnable: false });\n        }\n        this.fontSizeDdb = new DropDownButton({\n            cssClass: 'e-font-size-ddb',\n            content: '11',\n            items: [{ text: '8' }, { text: '9' }, { text: '10' }, { text: '11' }, { text: '12' }, { text: '14' }, { text: '16' },\n                { text: '18' }, { text: '20' }, { text: '22' }, { text: '24' }, { text: '26' }, { text: '28' }, { text: '36' },\n                { text: '48' }, { text: '72' }],\n            beforeOpen: function (args) {\n                _this.tBarDdbBeforeOpen(args);\n                _this.refreshSelected(_this.fontSizeDdb, args.element, 'content', 'text');\n            },\n            select: function (args) {\n                _this.fontSizeDdb.content = args.item.text;\n                _this.fontSizeDdb.dataBind();\n                _this.parent.notify(setCellFormat, { style: { fontSize: args.item.text + \"pt\" }, onActionUpdate: true });\n            },\n            close: function () { return _this.parent.element.focus(); }\n        });\n        this.fontSizeDdb.createElement = this.parent.createElement;\n        this.fontSizeDdb.appendTo('#' + id + '_font_size');\n        var fontNameBtn = document.getElementById(id + '_font_name');\n        fontNameBtn.appendChild(this.parent.createElement('span', { className: 'e-tbar-btn-text', innerHTML: 'Calibri' }));\n        this.fontNameDdb = new DropDownButton({\n            cssClass: 'e-font-family',\n            items: this.getFontFamilyItems(),\n            select: function (args) {\n                _this.refreshFontNameSelection(args.item.text);\n                _this.parent.notify(setCellFormat, { style: { fontFamily: args.item.text }, onActionUpdate: true });\n            },\n            close: function () { return _this.parent.element.focus(); },\n            beforeOpen: this.tBarDdbBeforeOpen.bind(this)\n        });\n        this.fontNameDdb.createElement = this.parent.createElement;\n        this.fontNameDdb.appendTo(fontNameBtn);\n        this.textAlignDdb = new DropDownButton({\n            cssClass: 'e-align-ddb',\n            iconCss: 'e-icons e-left-icon',\n            items: [{ iconCss: 'e-icons e-left-icon' }, { iconCss: 'e-icons e-center-icon' }, { iconCss: 'e-icons e-right-icon' }],\n            beforeItemRender: this.alignItemRender.bind(this),\n            beforeOpen: function (args) {\n                _this.refreshSelected(_this.textAlignDdb, args.element, 'iconCss');\n            },\n            select: function (args) {\n                _this.textAlignDdb.iconCss = args.item.iconCss;\n                _this.textAlignDdb.dataBind();\n                _this.parent.notify(setCellFormat, {\n                    style: { textAlign: args.item.iconCss.split(' e-')[1].split('-icon')[0] }, onActionUpdate: true\n                });\n            },\n            close: function () { return _this.parent.element.focus(); }\n        });\n        this.textAlignDdb.createElement = this.parent.createElement;\n        this.textAlignDdb.appendTo('#' + id + '_text_align');\n        this.verticalAlignDdb = new DropDownButton({\n            cssClass: 'e-align-ddb',\n            iconCss: 'e-icons e-bottom-icon',\n            items: [{ iconCss: 'e-icons e-top-icon' }, { iconCss: 'e-icons e-middle-icon' }, { iconCss: 'e-icons e-bottom-icon' }],\n            beforeItemRender: this.alignItemRender.bind(this),\n            beforeOpen: function (args) {\n                _this.refreshSelected(_this.verticalAlignDdb, args.element, 'iconCss');\n            },\n            select: function (args) {\n                _this.verticalAlignDdb.iconCss = args.item.iconCss;\n                _this.verticalAlignDdb.dataBind();\n                _this.parent.notify(setCellFormat, {\n                    style: { verticalAlign: args.item.iconCss.split(' e-')[1].split('-icon')[0] }, onActionUpdate: true\n                });\n            },\n            close: function () { return _this.parent.element.focus(); }\n        });\n        this.verticalAlignDdb.createElement = this.parent.createElement;\n        this.verticalAlignDdb.appendTo('#' + id + '_vertical_align');\n        var btn;\n        ['bold', 'italic', 'line-through', 'underline'].forEach(function (name) {\n            var btnObj = new Button({ iconCss: \"e-icons e-\" + name + \"-icon\", isToggle: true });\n            btnObj.createElement = _this.parent.createElement;\n            btn = document.getElementById(id + \"_\" + name);\n            btnObj.appendTo(btn);\n            btnObj.element.addEventListener('click', _this.toggleBtnClicked.bind(_this));\n        });\n        this.ribbon.element.querySelector('.e-drop-icon').title = l10n.getConstant('CollapseToolbar');\n    };\n    Ribbon.prototype.alignItemRender = function (args) {\n        var text = args.item.iconCss.split(' e-')[1].split('-icon')[0];\n        text = text[0].toUpperCase() + text.slice(1, text.length);\n        args.element.title = this.parent.serviceLocator.getService(locale).getConstant('Align' + text);\n    };\n    Ribbon.prototype.toggleBtnClicked = function (e) {\n        var target = closest(e.target, '.e-btn');\n        var parentId = this.parent.element.id;\n        var id = target.id;\n        var property = setCellFormat;\n        var defaultModel;\n        var activeModel;\n        switch (id) {\n            case parentId + \"_bold\":\n                defaultModel = { fontWeight: 'normal' };\n                activeModel = { fontWeight: 'bold' };\n                break;\n            case parentId + \"_italic\":\n                defaultModel = { fontStyle: 'normal' };\n                activeModel = { fontStyle: 'italic' };\n                break;\n            case parentId + \"_line-through\":\n                property = textDecorationUpdate;\n                defaultModel = { textDecoration: 'line-through' };\n                activeModel = defaultModel;\n                break;\n            case parentId + \"_underline\":\n                property = textDecorationUpdate;\n                defaultModel = { textDecoration: 'underline' };\n                activeModel = defaultModel;\n                break;\n        }\n        if (target.classList.contains('e-active')) {\n            this.parent.notify(property, {\n                style: activeModel, onActionUpdate: true\n            });\n        }\n        else {\n            this.parent.notify(property, {\n                style: defaultModel, onActionUpdate: true\n            });\n        }\n        this.parent.element.focus();\n    };\n    Ribbon.prototype.getCellStyleValue = function (cssProp, indexes) {\n        var cell = getCell(indexes[0], indexes[1], this.parent.getActiveSheet());\n        var value = this.parent.cellStyle[cssProp];\n        if (cell && cell.style && cell.style[cssProp]) {\n            value = cell.style[cssProp];\n        }\n        return value;\n    };\n    Ribbon.prototype.refreshSelected = function (inst, element, key, itemKey) {\n        if (itemKey === void 0) { itemKey = key; }\n        for (var i = 0; i < inst.items.length; i++) {\n            if (inst.items[i][itemKey] === inst[key]) {\n                element.children[i].classList.add('e-selected');\n                break;\n            }\n        }\n    };\n    Ribbon.prototype.expandCollapseHandler = function (args) {\n        var target = this.ribbon.element.querySelector('.e-drop-icon');\n        var l10n = this.parent.serviceLocator.getService(locale);\n        if (args.expanded) {\n            target.title = l10n.getConstant('CollapseToolbar');\n        }\n        else {\n            target.title = l10n.getConstant('ExpandToolbar');\n        }\n        this.parent.setPanelSize();\n    };\n    Ribbon.prototype.getNumFormatDdbItems = function (l10n, id) {\n        return [\n            { id: id + 'item1', text: l10n.getConstant(NumberFormatType.General) },\n            { id: id + 'item2', text: l10n.getConstant(NumberFormatType.Number) },\n            { id: id + 'item3', text: l10n.getConstant(NumberFormatType.Currency) },\n            { id: id + 'item4', text: l10n.getConstant(NumberFormatType.Accounting) },\n            { id: id + 'item5', text: l10n.getConstant(NumberFormatType.ShortDate) },\n            { id: id + 'item6', text: l10n.getConstant(NumberFormatType.LongDate) },\n            { id: id + 'item7', text: l10n.getConstant(NumberFormatType.Time) },\n            { id: id + 'item8', text: l10n.getConstant(NumberFormatType.Percentage) },\n            { id: id + 'item9', text: l10n.getConstant(NumberFormatType.Fraction) },\n            { id: id + 'item10', text: l10n.getConstant(NumberFormatType.Scientific) },\n            { id: id + 'item11', text: l10n.getConstant(NumberFormatType.Text) }\n        ];\n    };\n    Ribbon.prototype.getFontFamilyItems = function () {\n        return [{ text: 'Arial' }, { text: 'Arial Black' }, { text: 'Axettac Demo' }, { text: 'Batang' }, { text: 'Book Antiqua' },\n            { text: 'Calibri', iconCss: 'e-icons e-selected-icon' }, { text: 'Courier' }, { text: 'Courier New' },\n            { text: 'Din Condensed' }, { text: 'Georgia' }, { text: 'Helvetica' }, { text: 'Helvetica New' }, { text: 'Roboto' },\n            { text: 'Tahoma' }, { text: 'Times New Roman' }, { text: 'Verdana' }];\n    };\n    Ribbon.prototype.enableToolbar = function (args) {\n        this.ribbon.enableItems(args.enable);\n    };\n    Ribbon.prototype.numDDBSelect = function (args) {\n        this.parent.notify(applyNumberFormatting, {\n            format: getFormatFromType(args.item.text),\n            range: this.parent.getActiveSheet().selectedRange\n        });\n        this.parent.notify(selectionComplete, { type: 'mousedown' });\n        this.refreshNumFormatSelection(args.item.text);\n    };\n    Ribbon.prototype.tBarDdbBeforeOpen = function (args) {\n        var viewportHeight = this.parent.viewport.height;\n        var actualHeight = (parseInt(getComputedStyle(args.element.firstElementChild).height, 10) * args.items.length) +\n            (parseInt(getComputedStyle(args.element).paddingTop, 10) * 2);\n        if (actualHeight > viewportHeight) {\n            args.element.style.height = viewportHeight + \"px\";\n            args.element.style.overflowY = 'auto';\n        }\n    };\n    Ribbon.prototype.numDDBOpen = function (args) {\n        this.numPopupWidth = 0;\n        var elemList = args.element.querySelectorAll('span.e-numformat-preview-text');\n        for (var i = 0, len = elemList.length; i < len; i++) {\n            if (this.numPopupWidth < elemList[i].offsetWidth) {\n                this.numPopupWidth = elemList[i].offsetWidth;\n            }\n        }\n        var popWidth = this.numPopupWidth + 160;\n        document.querySelector('.e-numformat-ddb.e-dropdown-popup').style.width = popWidth + \"px\";\n    };\n    Ribbon.prototype.previewNumFormat = function (args) {\n        var cellIndex = getCellIndexes(this.parent.getActiveSheet().activeCell);\n        var cell = getCell(cellIndex[0], cellIndex[1], this.parent.getActiveSheet());\n        var eventArgs = {\n            type: args.item.text,\n            formattedText: '',\n            value: cell && cell.value ? cell.value : '',\n            format: getFormatFromType(args.item.text),\n            sheetIndex: this.parent.activeSheetTab,\n            onLoad: true\n        };\n        var numElem = this.parent.createElement('div', {\n            className: 'e-numformat-text',\n            styles: 'width:100%',\n            innerHTML: args.element.innerHTML\n        });\n        args.element.innerHTML = '';\n        this.parent.notify(getFormattedCellObject, eventArgs);\n        var previewElem = this.parent.createElement('span', {\n            className: 'e-numformat-preview-text',\n            styles: 'float:right;',\n            innerHTML: eventArgs.formattedText.toString()\n        });\n        numElem.appendChild(previewElem);\n        args.element.appendChild(numElem);\n    };\n    Ribbon.prototype.refreshRibbonContent = function () {\n        switch (this.activeTab) {\n            case 1:\n                this.refreshFirstTabContent(getCellIndexes(this.parent.getActiveSheet().activeCell));\n                break;\n            case 2:\n                // Second tab functionality comes here\n                break;\n            case 3:\n                this.refreshThirdTabContent();\n                break;\n        }\n    };\n    Ribbon.prototype.refreshFirstTabContent = function (indexes) {\n        var _this = this;\n        if (!isNullOrUndefined(document.getElementById(this.parent.element.id + '_number_format'))) {\n            this.numFormatDDB = getComponent(document.getElementById(this.parent.element.id + '_number_format'), DropDownButton);\n        }\n        var actCell = getCellIndexes(this.parent.getActiveSheet().activeCell);\n        var l10n = this.parent.serviceLocator.getService(locale);\n        var cell = getCell(actCell[0], actCell[1], this.parent.getActiveSheet(), true);\n        cell = cell ? cell : {};\n        var type = getTypeFromFormat(cell.format ? cell.format : NumberFormatType.General);\n        if (this.numFormatDDB) {\n            this.refreshNumFormatSelection(l10n.getConstant(type));\n        }\n        if (this.fontNameDdb) {\n            this.refreshFontNameSelection(this.getCellStyleValue('fontFamily', indexes));\n        }\n        if (this.fontSizeDdb) {\n            var value_1 = this.getCellStyleValue('fontSize', indexes).split('pt')[0];\n            if (value_1 !== this.fontSizeDdb.content) {\n                this.fontSizeDdb.content = value_1;\n                this.fontSizeDdb.dataBind();\n            }\n        }\n        if (this.textAlignDdb) {\n            var value_2 = \"e-icons e-\" + this.getCellStyleValue('textAlign', indexes).toLowerCase() + \"-icon\";\n            if (value_2 !== this.textAlignDdb.iconCss) {\n                this.textAlignDdb.iconCss = value_2;\n                this.textAlignDdb.dataBind();\n            }\n        }\n        if (this.verticalAlignDdb) {\n            var value_3 = \"e-icons e-\" + this.getCellStyleValue('verticalAlign', indexes).toLowerCase() + \"-icon\";\n            if (value_3 !== this.verticalAlignDdb.iconCss) {\n                this.verticalAlignDdb.iconCss = value_3;\n                this.verticalAlignDdb.dataBind();\n            }\n        }\n        var btn;\n        var id = this.parent.element.id;\n        var value;\n        var fontProps = ['fontWeight', 'fontStyle', 'textDecoration', 'textDecoration'];\n        ['bold', 'italic', 'line-through', 'underline'].forEach(function (name, index) {\n            btn = document.getElementById(id + \"_\" + name);\n            if (btn) {\n                value = _this.getCellStyleValue(fontProps[index], indexes).toLowerCase();\n                if (value.indexOf(name) > -1) {\n                    btn.classList.add('e-active');\n                }\n                else {\n                    if (btn.classList.contains('e-active')) {\n                        btn.classList.remove('e-active');\n                    }\n                }\n            }\n        });\n    };\n    Ribbon.prototype.refreshFontNameSelection = function (fontFamily) {\n        if (fontFamily !== this.fontNameDdb.items[this.fontNameIndex].text) {\n            this.fontNameDdb.element.firstElementChild.textContent = fontFamily;\n            for (var i = 0; i < this.fontNameDdb.items.length; i++) {\n                if (this.fontNameDdb.items[i].text === fontFamily) {\n                    this.fontNameDdb.items[i].iconCss = 'e-icons e-selected-icon';\n                    this.fontNameDdb.items[this.fontNameIndex].iconCss = '';\n                    this.fontNameDdb.setProperties({ 'items': this.fontNameDdb.items }, true);\n                    this.fontNameIndex = i;\n                    break;\n                }\n            }\n        }\n    };\n    Ribbon.prototype.refreshNumFormatSelection = function (type) {\n        var l10n = this.parent.serviceLocator.getService(locale);\n        for (var i = 0; i < this.numFormatDDB.items.length; i++) {\n            if (this.numFormatDDB.items[i].iconCss !== '') {\n                this.numFormatDDB.items[i].iconCss = '';\n            }\n            if (this.numFormatDDB.items[i].text === type) {\n                this.numFormatDDB.items[i].iconCss = 'e-icons e-selected-icon';\n            }\n        }\n        this.numFormatDDB.element.firstElementChild.textContent = type;\n        this.numFormatDDB.setProperties({ 'items': this.numFormatDDB.items }, true);\n    };\n    Ribbon.prototype.fileItemSelect = function (args) {\n        var _this = this;\n        var selectArgs = extend({ cancel: false }, args);\n        this.parent.trigger('fileItemSelect', selectArgs);\n        if (!selectArgs.cancel) {\n            switch (args.item.id) {\n                case 'Open':\n                    this.parent.element.querySelector('#' + this.parent.element.id + '_fileUpload').click();\n                    break;\n                case 'Xlsx':\n                case 'Xls':\n                case 'Csv':\n                    this.parent.save({ saveType: args.item.id });\n                    break;\n                case 'New':\n                    var dialogInst_1 = this.parent.serviceLocator.getService(dialog);\n                    dialogInst_1.show({\n                        height: 200, width: 400, isModal: true, showCloseIcon: true,\n                        content: this.parent.serviceLocator.getService(locale).getConstant('DestroyAlert'),\n                        beforeOpen: function () { return _this.parent.element.focus(); },\n                        buttons: [{\n                                buttonModel: {\n                                    content: this.parent.serviceLocator.getService(locale).getConstant('Ok'), isPrimary: true\n                                },\n                                click: function () {\n                                    _this.parent.sheets.length = 0;\n                                    _this.parent.createSheet();\n                                    dialogInst_1.hide();\n                                    _this.parent.activeSheetTab = _this.parent.sheets.length;\n                                    _this.parent.setProperties({ 'activeSheetTab': _this.parent.sheets.length }, true);\n                                    _this.parent.notify(refreshSheetTabs, {});\n                                    _this.parent.notify(sheetsDestroyed, {});\n                                    _this.parent.renderModule.refreshSheet();\n                                }\n                            }]\n                    });\n                    break;\n            }\n        }\n    };\n    Ribbon.prototype.toolbarClicked = function (args) {\n        var parentId = this.parent.element.id;\n        var text;\n        var l10n = this.parent.serviceLocator.getService(locale);\n        var sheet = this.parent.getActiveSheet();\n        switch (args.item.id) {\n            case parentId + '_headers':\n                sheet.showHeaders = !sheet.showHeaders;\n                this.parent.setProperties({ 'sheets': this.parent.sheets }, true);\n                this.parent.serviceLocator.getService('sheet').showHideHeaders();\n                text = this.getLocaleText(l10n, 'Headers', false);\n                args.item.text = text;\n                this.ribbon.items[3].content[0].text = text;\n                this.updateToggleText('headers', text);\n                this.parent.element.focus();\n                break;\n            case parentId + '_gridlines':\n                sheet.showGridLines = !sheet.showGridLines;\n                this.parent.setProperties({ 'sheets': this.parent.sheets }, true);\n                text = this.getLocaleText(l10n, 'GridLines', true);\n                args.item.text = text;\n                this.ribbon.items[3].content[2].text = text;\n                this.updateToggleText('gridlines', text);\n                this.parent.element.focus();\n                break;\n        }\n        this.parent.notify(ribbonClick, args);\n    };\n    Ribbon.prototype.updateToggleText = function (item, text) {\n        var _this = this;\n        getUpdateUsingRaf(function () {\n            _this.ribbon.element.querySelector(\"#\" + _this.parent.element.id + \"_\" + item + \" .e-tbar-btn-text\").textContent = text;\n        });\n    };\n    Ribbon.prototype.refreshThirdTabContent = function () {\n        var _this = this;\n        var text;\n        var idx;\n        var sheet = this.parent.getActiveSheet();\n        var l10n = this.parent.serviceLocator.getService(locale);\n        var itemPos = [0, 2];\n        ['Headers', 'GridLines'].forEach(function (item, index) {\n            idx = itemPos[index];\n            if (sheet['show' + item]) {\n                if (_this.ribbon.items[3].content[idx].text === l10n.getConstant('Show' + item)) {\n                    _this.updateShowHideBtn('Hide', item, idx);\n                }\n            }\n            else {\n                if (_this.ribbon.items[3].content[idx].text === l10n.getConstant('Hide' + item)) {\n                    _this.updateShowHideBtn('Show', item, idx);\n                }\n            }\n        });\n    };\n    Ribbon.prototype.updateShowHideBtn = function (showHideText, item, idx) {\n        var l10n = this.parent.serviceLocator.getService(locale);\n        var text = l10n.getConstant(showHideText + item);\n        this.ribbon.items[3].content[idx].text = text;\n        this.ribbon.setProperties({ 'items': this.ribbon.items }, true);\n        this.updateToggleText(item.toLowerCase(), text);\n    };\n    Ribbon.prototype.enableRibbonItems = function (args) {\n        var ele = document.getElementById(args.id);\n        if (ele) {\n            this.ribbon.enableItems(args.isEnable, closest(ele, '.e-toolbar-item'));\n        }\n    };\n    Ribbon.prototype.createMobileView = function () {\n        var _this = this;\n        var parentId = this.parent.element.id;\n        var toobar = this.parent.createElement('div', { className: 'e-header-toolbar' });\n        var menu = this.parent.createElement('ul');\n        toobar.appendChild(menu);\n        var toolbarObj = new Toolbar({\n            items: [\n                { prefixIcon: 'e-tick-icon', align: 'Left', id: parentId + 'focused_tick', cssClass: 'e-focused-tick' },\n                { template: menu, align: 'Right', id: parentId + 'file_menu' },\n            ],\n            clicked: function (args) {\n                switch (args.item.id) {\n                    case parentId + 'focused_tick':\n                        _this.parent.element.classList.remove('e-mobile-focused');\n                        _this.parent.renderModule.setSheetPanelSize();\n                        break;\n                }\n            },\n            created: function () {\n                var menuObj = new Menu({\n                    cssClass: 'e-mobile e-file-menu',\n                    enableRtl: true,\n                    showItemOnClick: true,\n                    items: _this.ribbon.items[0].menuItems,\n                    select: _this.fileItemSelect.bind(_this),\n                    beforeOpen: function (args) {\n                        args.element.parentElement.classList.remove('e-rtl');\n                        _this.fileMenuBeforeOpen(args);\n                    },\n                    beforeClose: _this.fileMenuBeforeClose.bind(_this)\n                });\n                menuObj.createElement = _this.parent.createElement;\n                menuObj.appendTo(menu);\n            }\n        });\n        toolbarObj.createElement = this.parent.createElement;\n        toolbarObj.appendTo(toobar);\n        this.parent.element.insertBefore(toobar, this.parent.element.firstElementChild);\n        this.renderMobileToolbar();\n    };\n    Ribbon.prototype.renderMobileToolbar = function () {\n        var _this = this;\n        var toolbarPanel = this.parent.createElement('div', { className: 'e-toolbar-panel e-ribbon' });\n        var toolbar = this.parent.createElement('div');\n        var ddb = this.parent.createElement('button');\n        toolbarPanel.appendChild(toolbar);\n        toolbarPanel.appendChild(ddb);\n        toolbarPanel.style.display = 'block';\n        this.parent.element.appendChild(toolbarPanel);\n        var ddbObj = new DropDownButton({\n            cssClass: 'e-caret-hide',\n            content: this.ribbon.items[1].header.text,\n            items: [\n                { text: this.ribbon.items[1].header.text },\n                { text: this.ribbon.items[2].header.text },\n                { text: this.ribbon.items[3].header.text }\n            ],\n            select: function (args) {\n                if (args.item.text !== ddbObj.content) {\n                    toolbarObj.element.style.display = 'none';\n                    ddbObj.content = args.item.text;\n                    ddbObj.dataBind();\n                    toolbarObj.items = _this.ribbon.items[ddbObj.items.indexOf(args.item) + 1].content;\n                    toolbarObj.width = \"calc(100% - \" + ddb.getBoundingClientRect().width + \"px)\";\n                    toolbarObj.element.style.display = '';\n                    toolbarObj.dataBind();\n                    toolbarObj.items[0].text = args.item.text;\n                    toolbarObj.dataBind();\n                }\n            },\n            open: function (args) {\n                var element = args.element.parentElement;\n                var clientRect = element.getBoundingClientRect();\n                var offset = calculatePosition(ddbObj.element, 'right', 'bottom');\n                element.style.left = offset.left - clientRect.width + \"px\";\n                element.style.top = offset.top - clientRect.height + \"px\";\n                for (var i = 0; i < ddbObj.items.length; i++) {\n                    if (ddbObj.content === ddbObj.items[i].text) {\n                        args.element.children[i].classList.add('e-selected');\n                        break;\n                    }\n                }\n            },\n            close: function () { return _this.parent.element.focus(); }\n        });\n        ddbObj.createElement = this.parent.createElement;\n        ddbObj.appendTo(ddb);\n        var toolbarObj = new Toolbar({\n            width: \"calc(100% - \" + ddb.getBoundingClientRect().width + \"px)\",\n            items: this.ribbon.items[1].content,\n            clicked: this.toolbarClicked.bind(this)\n        });\n        toolbarObj.createElement = this.parent.createElement;\n        toolbarObj.appendTo(toolbar);\n        toolbarPanel.style.display = '';\n    };\n    Ribbon.prototype.fileMenuBeforeOpen = function (args) {\n        var _this = this;\n        var l10n = this.parent.serviceLocator.getService(locale);\n        var wrapper;\n        var contents = ['.xlsx', '.xls', '.csv'];\n        if (args.parentItem.text === l10n.getConstant('SaveAs')) {\n            [].slice.call(args.element.children).forEach(function (li, index) {\n                wrapper = _this.parent.createElement('div', { innerHTML: li.innerHTML });\n                li.innerHTML = '';\n                wrapper.appendChild(_this.parent.createElement('span', { className: 'e-extension', innerHTML: contents[index] }));\n                li.appendChild(wrapper);\n            });\n        }\n        this.parent.trigger('fileMenuBeforeOpen', args);\n    };\n    Ribbon.prototype.fileMenuBeforeClose = function (args) {\n        this.parent.trigger('fileMenuBeforeClose', args);\n    };\n    Ribbon.prototype.addEventListener = function () {\n        this.parent.on(ribbon, this.initRibbon, this);\n        this.parent.on(enableRibbonItems, this.enableRibbonItems, this);\n        this.parent.on(activeCellChanged, this.refreshRibbonContent, this);\n        this.parent.on(enableToolbar, this.enableToolbar, this);\n    };\n    Ribbon.prototype.destroy = function () {\n        var parentElem = this.parent.element;\n        var ribbonEle = this.ribbon.element;\n        var id = parentElem.id;\n        destroyComponent(parentElem.querySelector('#' + id + '_paste'), SplitButton);\n        destroyComponent(parentElem.querySelector('#' + id + '_number_format'), DropDownButton);\n        destroyComponent(parentElem.querySelector('#' + id + '_font_size'), DropDownButton);\n        destroyComponent(parentElem.querySelector('#' + id + '_font_name'), DropDownButton);\n        destroyComponent(parentElem.querySelector('#' + id + '_text_align'), DropDownButton);\n        destroyComponent(parentElem.querySelector('#' + id + '_vertical_align'), DropDownButton);\n        ['bold', 'italic', 'line-through', 'underline'].forEach(function (name) {\n            destroyComponent(parentElem.querySelector('#' + (id + \"_\" + name)), Button);\n        });\n        this.ribbon.destroy();\n        if (ribbonEle) {\n            detach(ribbonEle);\n        }\n        this.ribbon = null;\n        this.removeEventListener();\n    };\n    Ribbon.prototype.removeEventListener = function () {\n        if (!this.parent.isDestroyed) {\n            this.parent.off(ribbon, this.initRibbon);\n            this.parent.off(enableRibbonItems, this.enableRibbonItems);\n            this.parent.off(activeCellChanged, this.refreshRibbonContent);\n            this.parent.on(enableToolbar, this.enableToolbar, this);\n        }\n    };\n    return Ribbon;\n}());\nexport { Ribbon };\n","import { formulaBar, locale, selectionComplete } from '../common/index';\nimport { mouseUpAfterSelection, click } from '../common/index';\nimport { getRangeIndexes, getRangeFromAddress } from './../../workbook/common/address';\nimport { getSheetName, getTypeFromFormat, getSheet } from '../../workbook/index';\nimport { updateSelectedRange, getSheetNameFromAddress, getSheetIndex } from '../../workbook/index';\nimport { ComboBox, DropDownList } from '@syncfusion/ej2-dropdowns';\nimport { rippleEffect, EventHandler, detach, Internationalization, isNullOrUndefined, closest } from '@syncfusion/ej2-base';\nimport { editOperation, formulaBarOperation, keyDown, keyUp, formulaOperation } from '../common/event';\nimport { intToDate } from '../../workbook/common/math';\nimport { ListView } from '@syncfusion/ej2-lists';\nimport { workbookFormulaOperation } from '../../workbook/common/event';\n/**\n * Represents Formula bar for Spreadsheet.\n */\nvar FormulaBar = /** @class */ (function () {\n    function FormulaBar(parent) {\n        this.categoryCollection = [];\n        this.formulaCollection = [];\n        this.parent = parent;\n        this.addEventListener();\n    }\n    FormulaBar.prototype.getModuleName = function () {\n        return 'formulaBar';\n    };\n    FormulaBar.prototype.createFormulaBar = function (args) {\n        if (!this.parent.showFormulaBar && this.insertFnRipple) {\n            this.destroy();\n            return;\n        }\n        var l10n = this.parent.serviceLocator.getService(locale);\n        var id = this.parent.element.id;\n        var fBarWrapper = this.parent.createElement('div', { className: 'e-formula-bar-panel' });\n        if (!this.parent.isMobileView()) {\n            var nameBox = this.parent.createElement('input', { id: id + '_name_box', attrs: { type: 'text' } });\n            fBarWrapper.appendChild(nameBox);\n            this.comboBoxInstance = new ComboBox({\n                value: 'A1',\n                cssClass: 'e-name-box',\n                width: '',\n                noRecordsTemplate: '',\n                fields: { text: 'name', value: 'refersTo' },\n                beforeOpen: this.nameBoxBeforeOpen.bind(this),\n                blur: this.nameBoxBlur.bind(this),\n                select: this.nameBoxSelect.bind(this),\n                change: function (args) {\n                    /** */\n                }\n            });\n            this.comboBoxInstance.createElement = this.parent.createElement;\n            this.comboBoxInstance.appendTo(nameBox);\n            this.comboBoxInstance.element.parentElement.title = l10n.getConstant('NameBox');\n        }\n        var insertFnBtn = fBarWrapper.appendChild(this.parent.createElement('button', {\n            className: 'e-btn e-css e-flat e-icon-btn e-insert-function', attrs: { 'title': l10n.getConstant('InsertFunction') }\n        }));\n        insertFnBtn.appendChild(this.parent.createElement('span', { className: 'e-btn-icon e-icons' }));\n        this.insertFnRipple = rippleEffect(fBarWrapper, { selector: '.e-insert-function' });\n        fBarWrapper.appendChild(this.parent.createElement('div', { className: 'e-separator' }));\n        var textarea = fBarWrapper.appendChild(this.parent.createElement('textarea', {\n            className: 'e-formula-bar e-css', id: id + '_formula_input',\n            attrs: { 'title': l10n.getConstant('FormulaBar'), 'spellcheck': 'false' }\n        }));\n        textarea.rows = 1;\n        if (this.parent.isMobileView()) {\n            textarea.placeholder = l10n.getConstant('MobileFormulaBarPlaceHolder');\n            EventHandler.add(textarea, 'focus', this.textAreaFocusIn, this);\n            EventHandler.add(textarea, 'blur', this.textAreaFocusOut, this);\n        }\n        else {\n            fBarWrapper.appendChild(this.parent.createElement('span', {\n                className: 'e-drop-icon e-icons', attrs: { 'title': l10n.getConstant('ExpandFormulaBar') }\n            }));\n        }\n        if (args && args.uiUpdate) {\n            this.parent.element.insertBefore(fBarWrapper, document.getElementById(id + '_sheet_panel'));\n        }\n        else {\n            this.parent.element.appendChild(fBarWrapper);\n        }\n    };\n    FormulaBar.prototype.textAreaFocusIn = function (e) {\n        var formulaPanel = this.parent.element.querySelector('.e-formula-bar-panel');\n        var tickBtn = this.parent.createElement('button', { className: 'e-btn e-css e-flat e-icon-btn e-formula-submit' });\n        tickBtn.appendChild(this.parent.createElement('span', { className: 'e-btn-icon e-icons e-tick-icon' }));\n        formulaPanel.classList.add('e-focused');\n        formulaPanel.appendChild(tickBtn);\n    };\n    FormulaBar.prototype.textAreaFocusOut = function (e) {\n        var formulaPanel = this.parent.element.querySelector('.e-formula-bar-panel');\n        formulaPanel.classList.remove('e-focused');\n        detach(formulaPanel.querySelector('.e-formula-submit'));\n    };\n    FormulaBar.prototype.keyDownHandler = function (e) {\n        var trgtElem = e.target;\n        if (this.parent.isEdit) {\n            if (trgtElem.classList.contains('e-formula-bar')) {\n                this.parent.notify(editOperation, { action: 'refreshEditor', value: trgtElem.value, refreshEditorElem: true });\n            }\n        }\n    };\n    FormulaBar.prototype.keyUpHandler = function (e) {\n        if (this.parent.isEdit) {\n            var trgtElem = e.target;\n            if (trgtElem.classList.contains('e-formula-bar')) {\n                var eventArg = { action: 'getCurrentEditValue', editedValue: '' };\n                this.parent.notify(editOperation, eventArg);\n                if (eventArg.editedValue !== trgtElem.value) {\n                    this.parent.notify(editOperation, { action: 'refreshEditor', value: trgtElem.value, refreshEditorElem: true });\n                }\n            }\n        }\n    };\n    FormulaBar.prototype.nameBoxBeforeOpen = function (args) {\n        if (this.comboBoxInstance.element.classList.contains('e-name-editing')) {\n            args.cancel = true;\n        }\n        else {\n            this.comboBoxInstance.element.select();\n        }\n    };\n    FormulaBar.prototype.nameBoxBlur = function (args) {\n        if (this.comboBoxInstance.element.classList.contains('e-name-editing')) {\n            this.comboBoxInstance.element.classList.remove('e-name-editing');\n            this.UpdateValueAfterMouseUp();\n        }\n    };\n    FormulaBar.prototype.nameBoxSelect = function (args) {\n        if (args.isInteracted) {\n            var refersTo = args.itemData.refersTo.substr(1);\n            var sheetIdx = getSheetIndex(this.parent, getSheetNameFromAddress(refersTo));\n            var range = getRangeFromAddress(refersTo);\n            var sheet = getSheet(this.parent, sheetIdx);\n            if ((sheetIdx + 1) === this.parent.activeSheetTab) {\n                this.parent.selectRange(range);\n                this.parent.element.focus();\n            }\n            else {\n                updateSelectedRange(this.parent, range, sheet);\n                this.parent.activeSheetTab = sheetIdx + 1;\n            }\n        }\n    };\n    FormulaBar.prototype.formulaBarUpdateHandler = function (e) {\n        var _this = this;\n        var range = this.parent.getActiveSheet().selectedRange.split(':');\n        var address;\n        var intl = new Internationalization();\n        if (e.type === 'mousemove' || e.type === 'pointermove') {\n            var indexes1 = getRangeIndexes(range[0]);\n            var indexes2 = getRangeIndexes(range[1]);\n            address = Math.abs(indexes1[0] - indexes2[0]) + 1 + \"R x \" + (Math.abs(indexes1[1] - indexes2[1]) + 1) + \"C\";\n        }\n        else {\n            address = range[0];\n            var data = this.parent.getData(getSheetName(this.parent) + \"!\" + address);\n            data.then(function (values) {\n                var value = '';\n                var intDate;\n                values.forEach(function (cell, key) {\n                    var type = cell && cell.format ? getTypeFromFormat(cell.format) : 'General';\n                    if (cell) {\n                        if (!isNullOrUndefined(cell.value)) {\n                            intDate = intToDate(Number(cell.value));\n                            if (intDate.toString() !== 'Invalid Date' && (type === 'ShortDate' || type === 'LongDate')) {\n                                value = intl.formatDate(intDate, {\n                                    type: 'date',\n                                    skeleton: 'yMd'\n                                });\n                            }\n                            else if (intDate.toString() !== 'Invalid Date' && type === 'Time') {\n                                value = intl.formatDate(intDate, {\n                                    type: 'dateTime',\n                                    skeleton: 'yMd'\n                                }) + ' ' + intl.formatDate(intDate, {\n                                    type: 'dateTime',\n                                    skeleton: 'hms'\n                                });\n                            }\n                            else {\n                                value = cell.value;\n                            }\n                        }\n                        if (cell.formula) {\n                            value = cell.formula;\n                        }\n                    }\n                    document.getElementById(_this.parent.element.id + '_formula_input').value = value;\n                });\n            });\n        }\n        this.updateComboBoxValue(address);\n    };\n    FormulaBar.prototype.UpdateValueAfterMouseUp = function () {\n        this.updateComboBoxValue(this.parent.getActiveSheet().selectedRange.split(':')[0]);\n    };\n    FormulaBar.prototype.updateComboBoxValue = function (value) {\n        var sheet = this.parent.getActiveSheet();\n        var range = getSheetName(this.parent) + '!' + sheet.selectedRange;\n        var eventArgs = {\n            action: 'getNameFromRange', range: range, definedName: null\n        };\n        this.parent.notify(formulaOperation, eventArgs);\n        if (eventArgs.definedName) {\n            value = eventArgs.definedName.name;\n        }\n        if (!this.parent.isMobileView()) {\n            if (this.comboBoxInstance.text === value) {\n                return;\n            }\n            this.comboBoxInstance.text = value;\n            this.comboBoxInstance.dataBind();\n        }\n    };\n    FormulaBar.prototype.clickHandler = function (e) {\n        var _this = this;\n        var target = e.target;\n        if (target.classList.contains('e-drop-icon') && closest(target, '.e-formula-bar-panel')) {\n            this.toggleFormulaBar(target);\n        }\n        else if (target.classList.contains('e-formula-bar')) {\n            if (!this.parent.isEdit) {\n                this.parent.notify(editOperation, { action: 'startEdit', refreshCurPos: false });\n            }\n        }\n        else if (target.parentElement.classList.contains('e-name-box')) {\n            if (target.classList.contains('e-ddl-icon')) {\n                var eventArgs = { action: 'getNames', names: [] };\n                this.parent.notify(formulaOperation, eventArgs);\n                this.comboBoxInstance.dataSource = eventArgs.names;\n            }\n            else {\n                this.comboBoxInstance.element.classList.add('e-name-editing');\n                this.comboBoxInstance.element.select();\n            }\n        }\n        if (!isNullOrUndefined(target.offsetParent) && ((target.offsetParent.classList.contains('e-insert-function')) ||\n            (target.classList.contains('e-insert-function')) || (this.parent.element.id + '_insert_function' === target.offsetParent.id) ||\n            (this.parent.element.id + '_insert_function' === target.id) || target.parentElement.classList.contains('e-insert-function') ||\n            (this.parent.element.id + '_insert_function' === target.parentElement.id))) {\n            var isOpen = !this.parent.isEdit;\n            var args = { action: 'getCurrentEditValue', editedValue: '' };\n            if (!isOpen) {\n                var eventArgs = { action: 'isFormulaEditing', isFormulaEdit: false };\n                this.parent.notify(formulaOperation, eventArgs);\n                isOpen = eventArgs.isFormulaEdit;\n                this.parent.notify(editOperation, args);\n            }\n            if (isOpen || args.editedValue === '') {\n                if (args.editedValue === '') {\n                    this.parent.notify(editOperation, { action: 'refreshEditor', value: '=' });\n                }\n                var l10n = this.parent.serviceLocator.getService(locale);\n                var formulaDescription = this.parent.createElement('div', { className: 'e-formula-description', id: this.parent.element.id + '_description_content' });\n                var categoryContent = this.parent.createElement('div', {\n                    className: 'e-category-content', id: this.parent.element.id + '_category_content',\n                    innerHTML: l10n.getConstant('PickACategory')\n                });\n                var dropDownElement = this.parent.createElement('input', { className: 'e-formula-category', id: this.parent.element.id + '_formula_category' });\n                var listViewElement = this.parent.createElement('div', { className: 'e-formula-list', id: this.parent.element.id + '_formula_list' });\n                var descriptionContent = this.parent.createElement('div', { className: 'e-description-content', innerHTML: l10n.getConstant('Description') });\n                var headerContent = this.parent.createElement('div', { className: 'e-header-content', innerHTML: l10n.getConstant('InsertFunction') });\n                var categoryArgs = {\n                    action: 'getFormulaCategory', categoryCollection: []\n                };\n                this.parent.notify(workbookFormulaOperation, categoryArgs);\n                this.categoryCollection = categoryArgs.categoryCollection;\n                this.categoryList = new DropDownList({\n                    dataSource: this.categoryCollection, index: 0, width: '285px', popupHeight: '210px',\n                    select: this.dropDownSelect.bind(this)\n                });\n                var listArgs = {\n                    action: 'getLibraryFormulas', formulaCollection: []\n                };\n                this.parent.notify(workbookFormulaOperation, listArgs);\n                this.formulaCollection = listArgs.formulaCollection;\n                this.formulaList = new ListView({\n                    dataSource: this.formulaCollection.sort(),\n                    actionComplete: this.updateFormulaList.bind(this),\n                    select: this.listSelected.bind(this), width: '285px', height: '200px'\n                });\n                this.dialog = this.parent.serviceLocator.getService('dialog');\n                this.dialog.show({\n                    header: headerContent.outerHTML,\n                    content: categoryContent.outerHTML + dropDownElement.outerHTML + listViewElement.outerHTML +\n                        descriptionContent.outerHTML + formulaDescription.outerHTML,\n                    width: '320px', height: '485px', cssClass: 'e-spreadsheet-function-dlg',\n                    showCloseIcon: true, isModal: true,\n                    beforeOpen: function () { return _this.parent.element.focus(); },\n                    open: this.dialogOpen.bind(this),\n                    beforeClose: this.dialogBeforeClose.bind(this),\n                    close: this.dialogClose.bind(this),\n                    buttons: [\n                        {\n                            click: (this.selectFormula.bind(this, this.dialog, this)), buttonModel: { content: 'OK', isPrimary: true }\n                        }\n                    ]\n                });\n                this.categoryList.appendTo('#' + this.parent.element.id + '_formula_category');\n                this.formulaList.appendTo('#' + this.parent.element.id + '_formula_list');\n                EventHandler.add(this.formulaList.element, 'dblclick', this.formulaClickHandler, this);\n            }\n        }\n    };\n    FormulaBar.prototype.toggleFormulaBar = function (target) {\n        var parent = target.parentElement;\n        var l10n = this.parent.serviceLocator.getService(locale);\n        if (parent.classList.contains('e-expanded')) {\n            parent.classList.remove('e-expanded');\n            document.getElementById(this.parent.element.id + '_formula_input').rows = 1;\n            target.title = l10n.getConstant('ExpandFormulaBar');\n        }\n        else {\n            parent.classList.add('e-expanded');\n            document.getElementById(this.parent.element.id + '_formula_input').rows = 3;\n            target.title = l10n.getConstant('CollapseFormulaBar');\n        }\n        this.parent.setPanelSize();\n    };\n    FormulaBar.prototype.dialogOpen = function () {\n        this.focusOkButton();\n    };\n    FormulaBar.prototype.dialogClose = function () {\n        var args = { action: 'getCurrentEditValue', editedValue: '' };\n        this.parent.notify(editOperation, args);\n        if (args.editedValue.toString().trim() === '=') {\n            this.parent.notify(editOperation, { action: 'refreshEditor', value: '' });\n        }\n    };\n    FormulaBar.prototype.dialogBeforeClose = function () {\n        EventHandler.remove(this.formulaList.element, 'dblclick', this.formulaClickHandler);\n        var dialogContentEle = document.getElementById('_dialog-content');\n        dialogContentEle.parentNode.removeChild(dialogContentEle);\n        /* tslint:disable-next-line:no-any */\n        this.dialog.dialogInstance.storeActiveElement = document.getElementById(this.parent.element.id + '_edit');\n    };\n    FormulaBar.prototype.selectFormula = function (dialog, formulaBarObj) {\n        var formulaText = formulaBarObj.formulaList.getSelectedItems().text;\n        var sheet = getSheet(this.parent, this.parent.activeSheetTab - 1);\n        if (this.parent.isEdit) {\n            this.parent.notify(editOperation, {\n                action: 'refreshEditor', value: formulaText + '(', refreshFormulaBar: true,\n                refreshEditorElem: true, isAppend: true\n            });\n        }\n        else {\n            this.parent.notify(editOperation, { action: 'startEdit', value: '=' + formulaText + '(', address: sheet.activeCell });\n            this.parent.notify(formulaBarOperation, { action: 'refreshFormulabar', value: '=' + formulaText + '(' });\n        }\n        dialog.hide();\n    };\n    FormulaBar.prototype.listSelected = function () {\n        this.updateFormulaDescription();\n    };\n    FormulaBar.prototype.updateFormulaList = function () {\n        this.activeListFormula();\n        this.updateFormulaDescription();\n    };\n    FormulaBar.prototype.dropDownSelect = function (args) {\n        this.formulaCollection = [];\n        var listArgs = {\n            action: 'getLibraryFormulas',\n            formulaCollection: []\n        };\n        if (args.item.textContent === 'All') {\n            this.parent.notify(workbookFormulaOperation, listArgs);\n            this.formulaCollection = listArgs.formulaCollection;\n        }\n        else {\n            var category = args.item.textContent;\n            var selectArgs = {\n                action: 'dropDownSelectFormulas',\n                formulaCollection: [],\n                selectCategory: category,\n            };\n            this.parent.notify(workbookFormulaOperation, selectArgs);\n            this.formulaCollection = selectArgs.formulaCollection;\n        }\n        this.formulaList.dataSource = this.formulaCollection.sort();\n    };\n    FormulaBar.prototype.focusOkButton = function () {\n        var focusEle = document.getElementById('_dialog-content');\n        (focusEle.nextElementSibling.firstElementChild).focus();\n    };\n    FormulaBar.prototype.activeListFormula = function () {\n        var acListEle = document.getElementById(this.parent.element.id + '_formula_list');\n        var firstElement = acListEle.children[0].children[0].firstElementChild;\n        this.formulaList.selectItem(firstElement);\n    };\n    FormulaBar.prototype.updateFormulaDescription = function () {\n        var descriptionArea;\n        var selectedFormula = this.formulaList.getSelectedItems().text;\n        var descriptionArgs = {\n            action: 'getFormulaDescription',\n            description: '',\n            selectedList: selectedFormula,\n        };\n        this.parent.notify(workbookFormulaOperation, descriptionArgs);\n        this.focusOkButton();\n        descriptionArea = document.getElementById(this.parent.element.id + '_description_content');\n        descriptionArea.innerHTML = this.parent.serviceLocator.getService(locale).getConstant(selectedFormula);\n    };\n    FormulaBar.prototype.formulaClickHandler = function (args) {\n        var trgtElem = args.target;\n        var sheet = getSheet(this.parent, this.parent.activeSheetTab - 1);\n        if (trgtElem.offsetParent.classList.contains('e-text-content') || trgtElem.classList.contains('e-list-item')) {\n            if (this.parent.isEdit) {\n                this.parent.notify(editOperation, {\n                    action: 'refreshEditor', value: trgtElem.innerText + '(', refreshFormulaBar: true,\n                    refreshEditorElem: true, isAppend: true\n                });\n            }\n            else {\n                this.parent.notify(editOperation, { action: 'startEdit', value: '=' + trgtElem.innerText + '(', address: sheet.activeCell });\n                this.parent.notify(formulaBarOperation, { action: 'refreshFormulabar', value: '=' + trgtElem.innerText + '(' });\n            }\n            this.dialog.hide();\n        }\n    };\n    FormulaBar.prototype.addEventListener = function () {\n        this.parent.on(formulaBar, this.createFormulaBar, this);\n        this.parent.on(click, this.clickHandler, this);\n        this.parent.on(keyDown, this.keyDownHandler, this);\n        this.parent.on(keyUp, this.keyUpHandler, this);\n        this.parent.on(selectionComplete, this.formulaBarUpdateHandler, this);\n        this.parent.on(mouseUpAfterSelection, this.UpdateValueAfterMouseUp, this);\n        this.parent.on(formulaBarOperation, this.editOperationHandler, this);\n    };\n    FormulaBar.prototype.destroy = function () {\n        this.removeEventListener();\n        this.comboBoxInstance.destroy();\n        this.comboBoxInstance = null;\n        this.insertFnRipple();\n        this.insertFnRipple = null;\n        var formulaPanel = this.parent.element.querySelector('.e-formula-bar-panel');\n        if (formulaPanel) {\n            detach(formulaPanel);\n        }\n    };\n    FormulaBar.prototype.removeEventListener = function () {\n        if (!this.parent.isDestroyed) {\n            this.parent.off(formulaBar, this.createFormulaBar);\n            this.parent.off(click, this.clickHandler);\n            this.parent.off(keyDown, this.keyDownHandler);\n            this.parent.off(keyUp, this.keyUpHandler);\n            this.parent.off(selectionComplete, this.formulaBarUpdateHandler);\n            this.parent.off(mouseUpAfterSelection, this.UpdateValueAfterMouseUp);\n            this.parent.off(formulaBarOperation, this.editOperationHandler);\n        }\n    };\n    FormulaBar.prototype.editOperationHandler = function (args) {\n        var action = args.action;\n        switch (action) {\n            case 'refreshFormulabar':\n                this.getFormulaBar().value = args.value;\n                break;\n            case 'getPosition':\n                args.position = this.getFormulaBar().getBoundingClientRect();\n                break;\n        }\n    };\n    FormulaBar.prototype.getFormulaBar = function () {\n        return this.parent.element.querySelector('#' + this.parent.element.id + '_formula_input');\n    };\n    return FormulaBar;\n}());\nexport { FormulaBar };\n","import { formulaOperation, keyUp, keyDown, click } from '../common/event';\nimport { editOperation, formulaBarOperation } from '../common/event';\nimport { workbookFormulaOperation } from '../../workbook/common/event';\nimport { AutoComplete } from '@syncfusion/ej2-dropdowns';\nimport { detach } from '@syncfusion/ej2-base';\nimport { checkIsFormula, getSheet, getSheetName } from '../../workbook/index';\nimport { dialog, locale } from '../common/index';\n/**\n * @hidden\n * The `Formula` module is used to handle the formulas and its functionalities in Spreadsheet.\n */\nvar Formula = /** @class */ (function () {\n    /**\n     * Constructor for formula module in Spreadsheet.\n     * @private\n     */\n    function Formula(parent) {\n        this.isFormulaBar = false;\n        this.isFormula = false;\n        this.isPopupOpened = false;\n        this.isPreventClose = false;\n        this.isSubFormula = false;\n        this.keyCodes = {\n            UP: 38,\n            DOWN: 40,\n            LEFT: 37,\n            RIGHT: 39,\n            FIRSTALPHABET: 65,\n            LASTALPHABET: 90,\n            SPACE: 32,\n            BACKSPACE: 8,\n            TAB: 9,\n            DELETE: 46,\n            ENTER: 13,\n            ESC: 27\n        };\n        this.parent = parent;\n        this.addEventListener();\n        //Spreadsheet.Inject(WorkbookFormula);\n    }\n    /**\n     * Get the module name.\n     * @returns string\n     * @private\n     */\n    Formula.prototype.getModuleName = function () {\n        return 'formula';\n    };\n    /**\n     * To destroy the formula module.\n     * @return {void}\n     * @hidden\n     */\n    Formula.prototype.destroy = function () {\n        this.removeEventListener();\n        if (this.autocompleteInstance) {\n            this.autocompleteInstance.destroy();\n        }\n        this.autocompleteInstance = null;\n        this.parent = null;\n    };\n    Formula.prototype.addEventListener = function () {\n        this.parent.on(formulaOperation, this.performFormulaOperation, this);\n        this.parent.on(keyUp, this.keyUpHandler, this);\n        this.parent.on(keyDown, this.keyDownHandler, this);\n        this.parent.on(click, this.clickHandler, this);\n    };\n    Formula.prototype.removeEventListener = function () {\n        if (!this.parent.isDestroyed) {\n            this.parent.off(formulaOperation, this.performFormulaOperation);\n            this.parent.off(keyUp, this.keyUpHandler);\n            this.parent.off(keyDown, this.keyDownHandler);\n            this.parent.off(click, this.clickHandler);\n        }\n    };\n    Formula.prototype.performFormulaOperation = function (args) {\n        var action = args.action;\n        switch (action) {\n            case 'renderAutoComplete':\n                this.renderAutoComplete();\n                break;\n            case 'endEdit':\n                this.endEdit();\n                break;\n            case 'addDefinedName':\n                this.addDefinedName(args.definedName);\n                break;\n            case 'getNames':\n                if (!args.sheetName) {\n                    args.sheetName = getSheetName(this.parent);\n                }\n                args.names = this.getNames(args.sheetName);\n                break;\n            case 'getNameFromRange':\n                args.definedName = this.getNameFromRange(args.range);\n                break;\n            case 'isFormulaEditing':\n                args.isFormulaEdit = this.isFormula;\n                break;\n        }\n    };\n    Formula.prototype.renderAutoComplete = function () {\n        if (!this.parent.element.querySelector('#' + this.parent.element.id + '_ac')) {\n            var acElem = this.parent.createElement('input', { id: this.parent.element.id + '_ac', className: 'e-ss-ac' });\n            this.parent.element.appendChild(acElem);\n            var eventArgs = {\n                action: 'getLibraryFormulas',\n                formulaCollection: []\n            };\n            this.parent.notify(workbookFormulaOperation, eventArgs);\n            var autoCompleteOptions = {\n                dataSource: eventArgs.formulaCollection,\n                cssClass: 'e-ss-atc',\n                popupWidth: '130px',\n                allowFiltering: true,\n                filterType: 'StartsWith',\n                sortOrder: 'Ascending',\n                open: this.onSuggestionOpen.bind(this),\n                close: this.onSuggestionClose.bind(this),\n                select: this.onSelect.bind(this),\n                actionComplete: this.onSuggestionComplete.bind(this)\n            };\n            this.autocompleteInstance = new AutoComplete(autoCompleteOptions, acElem);\n            this.autocompleteInstance.createElement = this.parent.createElement;\n        }\n    };\n    Formula.prototype.onSuggestionOpen = function (e) {\n        var _this = this;\n        this.isPopupOpened = true;\n        var position = this.getPopupPosition();\n        e.popup.offsetX = position.left;\n        e.popup.offsetY = (position.top + position.height);\n        e.popup.refreshPosition();\n        e.popup.element.firstChild.style.maxHeight = '180px';\n        new Promise(function (resolve, reject) {\n            setTimeout(function () { resolve(); }, 100);\n        }).then(function () {\n            _this.triggerKeyDownEvent(_this.keyCodes.DOWN);\n        });\n    };\n    Formula.prototype.onSuggestionClose = function (e) {\n        if (this.isPreventClose) {\n            e.cancel = true;\n        }\n        else {\n            this.isPopupOpened = false;\n        }\n    };\n    Formula.prototype.onSelect = function (e) {\n        var updatedFormulaValue = '=' + e.itemData.value + '(';\n        if (this.isSubFormula) {\n            var editValue = this.getEditingValue();\n            var parseIndex = editValue.lastIndexOf(this.getArgumentSeparator());\n            if (parseIndex > -1) {\n                updatedFormulaValue = editValue.slice(0, parseIndex + 1);\n            }\n            else {\n                parseIndex = editValue.lastIndexOf('(');\n                if (parseIndex > -1) {\n                    updatedFormulaValue = editValue.slice(0, parseIndex + 1);\n                }\n            }\n            updatedFormulaValue += e.itemData.value + '(';\n        }\n        this.parent.notify(editOperation, {\n            action: 'refreshEditor', value: updatedFormulaValue,\n            refreshFormulaBar: true, refreshEditorElem: true, refreshCurPos: !this.isFormulaBar\n        });\n    };\n    Formula.prototype.onSuggestionComplete = function (args) {\n        this.isPreventClose = args.result.length > 0;\n        if (!this.isPreventClose) {\n            args.cancel = true;\n            this.hidePopUp();\n        }\n    };\n    Formula.prototype.keyUpHandler = function (e) {\n        if (this.parent.isEdit) {\n            var editValue = this.getEditingValue();\n            this.isFormula = checkIsFormula(editValue);\n            if (this.isFormula || this.isPopupOpened) {\n                if (e.keyCode !== this.keyCodes.TAB && this.isFormula) {\n                    editValue = this.getSuggestionKeyFromFormula(editValue);\n                }\n                this.refreshFormulaSuggestion(e, editValue);\n            }\n        }\n        else if (this.isPopupOpened) {\n            this.hidePopUp();\n        }\n    };\n    Formula.prototype.keyDownHandler = function (e) {\n        var keyCode = e.keyCode;\n        if (this.isFormula) {\n            if (this.isPopupOpened) {\n                switch (keyCode) {\n                    case this.keyCodes.UP:\n                    case this.keyCodes.DOWN:\n                        e.preventDefault();\n                        this.triggerKeyDownEvent(keyCode);\n                        break;\n                    case this.keyCodes.TAB:\n                        e.preventDefault();\n                        this.triggerKeyDownEvent(this.keyCodes.ENTER);\n                        break;\n                }\n            }\n        }\n        else {\n            var trgtElem = e.target;\n            if (trgtElem.id === this.parent.element.id + '_name_box') {\n                switch (keyCode) {\n                    case this.keyCodes.ENTER:\n                        this.addDefinedName({ name: trgtElem.value });\n                        this.parent.element.focus();\n                        break;\n                    case this.keyCodes.ESC:\n                        this.parent.element.focus();\n                        break;\n                }\n            }\n        }\n    };\n    Formula.prototype.clickHandler = function (e) {\n        if (this.parent.isEdit) {\n            var trgtElem = e.target;\n            this.isFormulaBar = trgtElem.classList.contains('e-formula-bar');\n        }\n    };\n    Formula.prototype.refreshFormulaSuggestion = function (e, formula) {\n        if (formula.length > 0) {\n            var autoCompleteElem = this.autocompleteInstance.element;\n            var keyCode = e.keyCode;\n            var isSuggestionAlreadyOpened = this.isPopupOpened;\n            if (!this.isNavigationKey(keyCode)) {\n                autoCompleteElem.value = formula;\n                autoCompleteElem.dispatchEvent(new Event('input'));\n                autoCompleteElem.dispatchEvent(new Event('keyup'));\n                if (isSuggestionAlreadyOpened) {\n                    this.triggerKeyDownEvent(this.keyCodes.DOWN);\n                }\n            }\n        }\n        else {\n            if (this.isPopupOpened) {\n                this.isPreventClose = false;\n                this.hidePopUp();\n            }\n        }\n    };\n    Formula.prototype.endEdit = function () {\n        this.isSubFormula = false;\n        this.isPreventClose = false;\n        this.isFormula = false;\n        this.isFormulaBar = false;\n        if (this.isPopupOpened) {\n            this.hidePopUp();\n            var suggPopupElem = document.querySelector('#' + this.parent.element.id + '_ac_popup');\n            if (suggPopupElem) {\n                detach(suggPopupElem);\n            }\n            this.isPopupOpened = false;\n        }\n    };\n    Formula.prototype.hidePopUp = function () {\n        this.autocompleteInstance.hidePopup();\n    };\n    Formula.prototype.getSuggestionKeyFromFormula = function (formula) {\n        var suggestValue = '';\n        formula = formula.substr(1); //remove = char.\n        if (formula) {\n            var bracketIndex = formula.lastIndexOf('(');\n            formula = formula.substr(bracketIndex + 1);\n            var fSplit = formula.split(this.getArgumentSeparator());\n            if (fSplit.length === 1) {\n                suggestValue = fSplit[0];\n                this.isSubFormula = bracketIndex > -1;\n            }\n            else {\n                suggestValue = fSplit[fSplit.length - 1];\n                this.isSubFormula = true;\n            }\n            var isAlphaNumeric = suggestValue.match(/\\w/);\n            if (!isAlphaNumeric || (isAlphaNumeric && isAlphaNumeric.index !== 0)) {\n                suggestValue = '';\n            }\n        }\n        return suggestValue;\n    };\n    Formula.prototype.getPopupPosition = function () {\n        var eventArgs = { position: null };\n        if (this.isFormulaBar) {\n            eventArgs.action = 'getPosition';\n            this.parent.notify(formulaBarOperation, eventArgs);\n        }\n        else {\n            eventArgs.action = 'getPosition';\n            this.parent.notify(editOperation, eventArgs);\n        }\n        return eventArgs.position;\n    };\n    Formula.prototype.getEditingValue = function () {\n        var eventArgs = { action: 'getCurrentEditValue', editedValue: '' };\n        this.parent.notify(editOperation, eventArgs);\n        return eventArgs.editedValue;\n    };\n    Formula.prototype.isNavigationKey = function (keyCode) {\n        return (keyCode === this.keyCodes.UP) || (keyCode === this.keyCodes.DOWN) || (keyCode === this.keyCodes.LEFT)\n            || (keyCode === this.keyCodes.RIGHT);\n    };\n    Formula.prototype.triggerKeyDownEvent = function (keyCode) {\n        var autoCompleteElem = this.autocompleteInstance.element;\n        autoCompleteElem.dispatchEvent(new Event('input'));\n        var eventArg = new Event('keydown');\n        // tslint:disable:no-string-literal\n        eventArg['keyCode'] = keyCode;\n        eventArg['which'] = keyCode;\n        eventArg['altKey'] = false;\n        eventArg['shiftKey'] = false;\n        eventArg['ctrlKey'] = false;\n        // tslint:enable:no-string-literal\n        autoCompleteElem.dispatchEvent(eventArg);\n    };\n    Formula.prototype.getArgumentSeparator = function () {\n        if (this.argumentSeparator) {\n            return this.argumentSeparator;\n        }\n        else {\n            var eventArgs = {\n                action: 'getArgumentSeparator', argumentSeparator: ''\n            };\n            this.parent.notify(workbookFormulaOperation, eventArgs);\n            this.argumentSeparator = eventArgs.argumentSeparator;\n            return eventArgs.argumentSeparator;\n        }\n    };\n    Formula.prototype.getNames = function (sheetName) {\n        var names = this.parent.definedNames.filter(function (name) { return name.scope === '' || name.scope === sheetName; });\n        return names;\n    };\n    Formula.prototype.getNameFromRange = function (range) {\n        var singleRange = range.slice(0, range.indexOf(':'));\n        var sRange = range.slice(range.indexOf('!') + 1).split(':');\n        var isSingleCell = sRange.length > 1 && sRange[0] === sRange[1];\n        var name = this.parent.definedNames.filter(function (name, index) {\n            if (isSingleCell && name.refersTo === '=' + singleRange) {\n                return true;\n            }\n            return name.refersTo === '=' + range;\n        });\n        return name && name[0];\n    };\n    Formula.prototype.addDefinedName = function (definedName) {\n        if (!definedName.refersTo) {\n            var sheet = getSheet(this.parent, this.parent.activeSheetTab - 1);\n            definedName.refersTo = getSheetName(this.parent) + '!' + sheet.selectedRange;\n        }\n        var eventArgs = {\n            action: 'addDefinedName', definedName: definedName, isAdded: false\n        };\n        this.parent.notify(workbookFormulaOperation, eventArgs);\n        if (!eventArgs.isAdded) {\n            this.parent.serviceLocator.getService(dialog).show({\n                content: this.parent.serviceLocator.getService(locale).getConstant('DefineNameExists'),\n                width: '300'\n            });\n        }\n        return true;\n    };\n    return Formula;\n}());\nexport { Formula };\n","import { Tab } from '@syncfusion/ej2-navigations';\nimport { refreshSheetTabs, locale, addSheetTab, cMenuBeforeOpen, dialog, renameSheet } from '../common/index';\nimport { sheetTabs, renameSheetTab, removeSheetTab, activeSheetChanged, onVerticalScroll, onHorizontalScroll } from '../common/index';\nimport { getSheetName } from '../../workbook/index';\nimport { DropDownButton } from '@syncfusion/ej2-splitbuttons';\nimport { isCollide, calculatePosition } from '@syncfusion/ej2-popups';\nimport { rippleEffect, closest, EventHandler, remove } from '@syncfusion/ej2-base';\nimport { sheetsDestroyed } from '../../workbook/common/index';\n/**\n * Represents SheetTabs for Spreadsheet.\n */\nvar SheetTabs = /** @class */ (function () {\n    function SheetTabs(parent) {\n        this.parent = parent;\n        this.addEventListener();\n    }\n    SheetTabs.prototype.getModuleName = function () {\n        return 'sheetTabs';\n    };\n    SheetTabs.prototype.createSheetTabs = function () {\n        var _this = this;\n        if (!this.parent.showSheetTabs && this.tabInstance) {\n            this.destroy();\n            return;\n        }\n        var l10n = this.parent.serviceLocator.getService(locale);\n        var panel = this.parent.createElement('div', {\n            className: 'e-sheet-tab-panel', id: this.parent.element.id + '_sheet_tab_panel'\n        });\n        var addBtn = this.parent.createElement('button', {\n            className: 'e-add-sheet-tab e-btn e-css e-flat e-icon-btn', attrs: { 'title': l10n.getConstant('AddSheet') }\n        });\n        addBtn.appendChild(this.parent.createElement('span', { className: 'e-btn-icon e-icons e-add-icon' }));\n        addBtn.addEventListener('click', this.addSheetTab.bind(this));\n        panel.appendChild(addBtn);\n        this.addBtnRipple = rippleEffect(panel, { selector: '.e-add-sheet-tab' });\n        var ddb = this.parent.createElement('button', { attrs: { 'title': l10n.getConstant('ListAllSheets') } });\n        panel.appendChild(ddb);\n        this.parent.element.appendChild(panel);\n        var items = this.getSheetTabItems();\n        this.dropDownInstance = new DropDownButton({\n            iconCss: 'e-icons',\n            items: items.ddbItems,\n            select: function (args) { return _this.updateSheetTab({ idx: _this.dropDownInstance.items.indexOf(args.item) }); },\n            beforeOpen: this.beforeOpenHandler.bind(this),\n            open: this.openHandler.bind(this),\n            cssClass: 'e-sheets-list e-flat e-caret-hide',\n            close: function () { return _this.parent.element.focus(); }\n        });\n        this.dropDownInstance.createElement = this.parent.createElement;\n        this.dropDownInstance.appendTo(ddb);\n        var sheetTab = this.parent.createElement('div', { className: 'e-sheet-tab' });\n        this.tabInstance = new Tab({\n            selectedItem: 0,\n            overflowMode: 'Scrollable',\n            items: items.tabItems,\n            selecting: function (args) {\n                /** */\n            },\n            selected: function (args) {\n                if (args.selectedIndex === args.previousIndex) {\n                    return;\n                }\n                _this.parent.activeSheetTab = args.selectedIndex + 1;\n                _this.parent.dataBind();\n                _this.updateDropDownItems(args.selectedIndex, args.previousIndex);\n                _this.parent.element.focus();\n            },\n            created: function () {\n                var tBarItems = _this.tabInstance.element.querySelector('.e-toolbar-items');\n                tBarItems.classList.add('e-sheet-tabs-items');\n                EventHandler.add(tBarItems, 'dblclick', _this.renameSheetTab, _this);\n            },\n        });\n        panel.appendChild(sheetTab);\n        this.tabInstance.createElement = this.parent.createElement;\n        this.tabInstance.appendTo(sheetTab);\n        // tslint:disable-next-line:no-any\n        EventHandler.remove(this.tabInstance.element, 'keydown', this.tabInstance.spaceKeyDown);\n    };\n    SheetTabs.prototype.updateDropDownItems = function (curIdx, prevIdx) {\n        if (prevIdx > -1) {\n            this.dropDownInstance.items[prevIdx].iconCss = '';\n        }\n        this.dropDownInstance.items[curIdx].iconCss = 'e-selected-icon e-icons';\n        this.dropDownInstance.setProperties({ 'items': this.dropDownInstance.items }, true);\n    };\n    SheetTabs.prototype.beforeOpenHandler = function (args) {\n        var viewportHeight = this.parent.viewport.height;\n        var actualHeight = (parseInt(getComputedStyle(args.element.firstElementChild).height, 10) *\n            this.dropDownInstance.items.length) + (parseInt(getComputedStyle(args.element).paddingTop, 10) * 2);\n        if (actualHeight > viewportHeight) {\n            args.element.style.height = viewportHeight + \"px\";\n            args.element.style.overflowY = 'auto';\n        }\n        args.element.parentElement.style.visibility = 'hidden';\n    };\n    SheetTabs.prototype.openHandler = function (args) {\n        var wrapper = args.element.parentElement;\n        var height;\n        var collide = isCollide(wrapper);\n        if (collide.indexOf('bottom') === -1) {\n            height = args.element.style.overflowY === 'auto' ? this.parent.viewport.height : wrapper.getBoundingClientRect().height;\n            var offset = calculatePosition(this.dropDownInstance.element, 'left', 'top');\n            wrapper.style.left = offset.left + \"px\";\n            wrapper.style.top = offset.top - height + \"px\";\n        }\n        wrapper.style.visibility = '';\n    };\n    SheetTabs.prototype.getSheetTabItems = function () {\n        var _this = this;\n        var tabItems = [];\n        var ddbItems = [];\n        var sheetName;\n        this.parent.sheets.forEach(function (sheet, index) {\n            sheetName = getSheetName(_this.parent, index + 1);\n            tabItems.push({ header: { 'text': sheetName } });\n            ddbItems.push({ text: sheetName, iconCss: index + 1 === _this.parent.activeSheetTab ? 'e-selected-icon e-icons' : '' });\n        });\n        return { tabItems: tabItems, ddbItems: ddbItems };\n    };\n    SheetTabs.prototype.refreshSheetTab = function () {\n        var items = this.getSheetTabItems();\n        this.dropDownInstance.items = items.ddbItems;\n        this.dropDownInstance.setProperties({ 'items': this.dropDownInstance.items }, true);\n        this.tabInstance.items = items.tabItems;\n        this.tabInstance.selectedItem = this.parent.activeSheetTab - 1;\n        this.tabInstance.dataBind();\n    };\n    SheetTabs.prototype.addSheetTab = function (args) {\n        var idx = args.text && args.text === 'Insert' ? this.parent.activeSheetTab - 1 : this.parent.activeSheetTab;\n        this.parent.createSheet(idx);\n        var sheetName = this.parent.sheets[idx].name;\n        this.dropDownInstance.items.splice(idx, 0, { text: sheetName });\n        this.dropDownInstance.setProperties({ 'items': this.dropDownInstance.items }, true);\n        this.tabInstance.addTab([{ header: { text: sheetName }, content: '' }], idx);\n        if (idx === this.parent.activeSheetTab - 1) {\n            this.parent.renderModule.refreshSheet();\n            this.updateDropDownItems(idx, idx + 1);\n        }\n        else {\n            this.updateSheetTab({ idx: idx });\n        }\n        this.parent.element.focus();\n    };\n    SheetTabs.prototype.updateSheetTab = function (args) {\n        this.tabInstance.selectedItem = args.idx;\n        this.tabInstance.dataBind();\n    };\n    SheetTabs.prototype.switchSheetTab = function (args) {\n        var target = closest(args.event.target, '.e-toolbar-item');\n        if (!target) {\n            return;\n        }\n        var text = target.querySelector('.e-tab-text').textContent;\n        for (var i = 0, len = this.tabInstance.items.length; i < len; i++) {\n            if (this.tabInstance.items[i].header.text === text) {\n                if (this.parent.activeSheetTab - 1 !== i) {\n                    this.updateSheetTab({ idx: i });\n                }\n                break;\n            }\n        }\n    };\n    SheetTabs.prototype.renameSheetTab = function () {\n        var target = this.tabInstance.element.querySelector('.e-toolbar-item.e-active');\n        if (target) {\n            target = target.querySelector('.e-text-wrap');\n            var value = target.querySelector('.e-tab-text').textContent;\n            var input = this.parent.createElement('input', {\n                id: this.parent.element.id + '_rename_input',\n                className: 'e-input e-sheet-rename', styles: \"width: \" + target.getBoundingClientRect().width + \"px\", attrs: {\n                    'type': 'text', 'name': 'Rename', 'required': '', 'value': value, 'spellcheck': 'false', 'maxlength': '31'\n                }\n            });\n            target.firstElementChild.style.display = 'none';\n            target.appendChild(input);\n            EventHandler.add(document, 'click', this.renameInputFocusOut, this);\n            EventHandler.add(input, 'input', this.updateWidth, this);\n            input.focus();\n            input.setSelectionRange(0, value.length);\n            EventHandler.remove(closest(target, '.e-toolbar-items'), 'dblclick', this.renameSheetTab);\n        }\n    };\n    SheetTabs.prototype.updateWidth = function (e) {\n        var target = e.target;\n        var len = target.value.length;\n        var value = target.value.split(' ');\n        if (value.length) {\n            var spaceLen = value.length - 1;\n            len -= spaceLen;\n            len += (spaceLen * 0.5);\n        }\n        target.style.width = len + \"ch\";\n    };\n    SheetTabs.prototype.renameInputFocusOut = function (e) {\n        var target = e.target;\n        if (e.type === 'click' && (target.classList.contains('e-sheet-rename') || closest(target, '.e-dlg-container'))) {\n            return;\n        }\n        target = document.getElementById(this.parent.element.id + '_rename_input');\n        if (e.type === 'keydown' && e.keyCode === 27) {\n            this.removeRenameInput(target);\n            this.parent.element.focus();\n            return;\n        }\n        var value = target.value;\n        var l10n = this.parent.serviceLocator.getService(locale);\n        if (value) {\n            var idx = this.tabInstance.selectedItem;\n            if (!value.match(new RegExp('.*[\\\\[\\\\]\\\\*\\\\\\\\\\/\\\\?].*'))) {\n                if (this.tabInstance.items[idx].header.text !== value) {\n                    for (var i = 0, len = this.parent.sheets.length; i < len; i++) {\n                        if (i + 1 !== this.parent.activeSheetTab && this.parent.sheets[i].name.toLowerCase() === value.toLowerCase()) {\n                            this.showRenameDialog(target, l10n.getConstant('SheetRenameAlreadyExistsAlert'));\n                            return;\n                        }\n                    }\n                }\n                var items = this.removeRenameInput(target);\n                if (this.tabInstance.items[idx].header.text !== value) {\n                    this.parent.sheets[idx].name = value;\n                    this.parent.setProperties({ 'sheets': this.parent.sheets }, true);\n                    this.tabInstance.items[idx].header.text = value;\n                    this.dropDownInstance.items[idx].text = value;\n                    this.dropDownInstance.setProperties({ 'items': this.dropDownInstance.items }, true);\n                    if (value.indexOf('  ') > -1) {\n                        this.tabInstance.setProperties({ 'items': this.tabInstance.items }, true);\n                        items.querySelector('.e-toolbar-item.e-active .e-tab-text').innerHTML = value;\n                    }\n                    else {\n                        this.tabInstance.items = this.tabInstance.items;\n                        this.tabInstance.dataBind();\n                    }\n                }\n                if (e.type === 'keydown' || (closest(e.target, '.e-spreadsheet'))) {\n                    this.parent.element.focus();\n                }\n            }\n            else {\n                this.showRenameDialog(target, l10n.getConstant('SheetRenameInvalidAlert'));\n            }\n        }\n        else {\n            this.showRenameDialog(target, l10n.getConstant('SheetRenameEmptyAlert'));\n        }\n    };\n    SheetTabs.prototype.removeRenameInput = function (target) {\n        var textEle = target.parentElement.querySelector('.e-tab-text');\n        var sheetItems = closest(target, '.e-toolbar-items');\n        EventHandler.add(sheetItems, 'dblclick', this.renameSheetTab, this);\n        EventHandler.remove(document, 'click', this.renameInputFocusOut);\n        EventHandler.remove(target, 'input', this.updateWidth);\n        remove(target);\n        textEle.style.display = '';\n        return sheetItems;\n    };\n    SheetTabs.prototype.showRenameDialog = function (target, content) {\n        this.parent.serviceLocator.getService(dialog).show({\n            target: document.getElementById(this.parent.element.id + '_sheet_panel'),\n            height: 180, width: 400, isModal: true, showCloseIcon: true,\n            content: content,\n            beforeOpen: function () { return target.focus(); },\n            close: function () { return target.setSelectionRange(0, target.value.length); }\n        });\n    };\n    SheetTabs.prototype.focusRenameInput = function () {\n        var input = document.getElementById(this.parent.element.id + '_rename_input');\n        if (input) {\n            input.focus();\n        }\n    };\n    SheetTabs.prototype.removeSheetTab = function (args) {\n        var _this = this;\n        var l10n = this.parent.serviceLocator.getService(locale);\n        if (this.parent.sheets.length > 1) {\n            var sheet = this.parent.getActiveSheet();\n            var isDataAvail = sheet.rows && sheet.rows.length ?\n                (sheet.rows.length === 1 ? (sheet.rows[0].cells && sheet.rows[0].cells.length ? true : false) : true) : false;\n            if (isDataAvail) {\n                var dialogInst_1 = this.parent.serviceLocator.getService(dialog);\n                dialogInst_1.show({\n                    height: 180, width: 400, isModal: true, showCloseIcon: true,\n                    content: l10n.getConstant('DeleteSheetAlert'),\n                    beforeOpen: function () { return _this.parent.element.focus(); },\n                    buttons: [{\n                            buttonModel: {\n                                content: l10n.getConstant('Ok'), isPrimary: true\n                            },\n                            click: function () {\n                                dialogInst_1.hide();\n                                _this.destroySheet();\n                            }\n                        }]\n                });\n            }\n            else {\n                this.destroySheet();\n            }\n        }\n        else {\n            this.parent.serviceLocator.getService(dialog).show({\n                target: document.getElementById(this.parent.element.id + '_sheet_panel'),\n                height: 180, width: 400, isModal: true, showCloseIcon: true,\n                content: l10n.getConstant('DeleteSingleLastSheetAlert'),\n                beforeOpen: function () { return _this.parent.element.focus(); }\n            });\n        }\n    };\n    SheetTabs.prototype.destroySheet = function () {\n        var activeSheetIdx = this.parent.activeSheetTab - 1;\n        this.parent.removeSheet(activeSheetIdx);\n        this.parent.notify(sheetsDestroyed, { sheetIndex: activeSheetIdx });\n        this.dropDownInstance.items.splice(activeSheetIdx, 1);\n        this.dropDownInstance.setProperties({ 'items': this.dropDownInstance.items }, true);\n        this.tabInstance.removeTab(activeSheetIdx);\n        this.parent.setProperties({ 'activeSheetTab': this.tabInstance.selectedItem + 1 }, true);\n        this.parent.renderModule.refreshSheet();\n        this.updateDropDownItems(this.tabInstance.selectedItem);\n        this.parent.element.focus();\n    };\n    SheetTabs.prototype.addEventListener = function () {\n        this.parent.on(sheetTabs, this.createSheetTabs, this);\n        this.parent.on(refreshSheetTabs, this.refreshSheetTab, this);\n        this.parent.on(addSheetTab, this.addSheetTab, this);\n        this.parent.on(removeSheetTab, this.removeSheetTab, this);\n        this.parent.on(renameSheetTab, this.renameSheetTab, this);\n        this.parent.on(cMenuBeforeOpen, this.switchSheetTab, this);\n        this.parent.on(activeSheetChanged, this.updateSheetTab, this);\n        this.parent.on(renameSheet, this.renameInputFocusOut, this);\n        this.parent.on(onVerticalScroll, this.focusRenameInput, this);\n        this.parent.on(onHorizontalScroll, this.focusRenameInput, this);\n    };\n    SheetTabs.prototype.destroy = function () {\n        this.removeEventListener();\n        this.dropDownInstance.destroy();\n        this.dropDownInstance = null;\n        this.tabInstance.destroy();\n        this.tabInstance = null;\n        this.addBtnRipple();\n        this.addBtnRipple = null;\n        EventHandler.remove(document, 'click', this.renameInputFocusOut);\n        var ele = document.getElementById(this.parent.element.id + '_sheet_tab_panel');\n        if (ele) {\n            remove(ele);\n        }\n        this.parent = null;\n    };\n    SheetTabs.prototype.removeEventListener = function () {\n        if (!this.parent.isDestroyed) {\n            this.parent.off(sheetTabs, this.createSheetTabs);\n            this.parent.off(refreshSheetTabs, this.refreshSheetTab);\n            this.parent.off(addSheetTab, this.addSheetTab);\n            this.parent.off(removeSheetTab, this.removeSheetTab);\n            this.parent.off(renameSheetTab, this.renameSheetTab);\n            this.parent.off(cMenuBeforeOpen, this.switchSheetTab);\n            this.parent.off(activeSheetChanged, this.updateSheetTab);\n            this.parent.off(renameSheet, this.renameInputFocusOut);\n            this.parent.off(onVerticalScroll, this.focusRenameInput);\n            this.parent.off(onHorizontalScroll, this.focusRenameInput);\n        }\n    };\n    return SheetTabs;\n}());\nexport { SheetTabs };\n","import { refreshSheetTabs } from '../common/event';\nimport { dialog } from '../common/index';\nimport { openSuccess, openFailure } from '../../workbook/index';\nvar Open = /** @class */ (function () {\n    function Open(parent) {\n        this.parent = parent;\n        this.addEventListener();\n        this.renderFileUpload();\n        //Spreadsheet.Inject(WorkbookOpen);\n    }\n    /**\n     * Adding event listener for success and failure\n     */\n    Open.prototype.addEventListener = function () {\n        this.parent.on(openSuccess, this.openSuccess, this);\n        this.parent.on(openFailure, this.openFailed, this);\n    };\n    /**\n     * Removing event listener for success and failure\n     */\n    Open.prototype.removeEventListener = function () {\n        if (!this.parent.isDestroyed) {\n            this.parent.off(openSuccess, this.openSuccess);\n            this.parent.off(openFailure, this.openFailed);\n        }\n    };\n    /**\n     * Rendering upload component for importing files.\n     */\n    Open.prototype.renderFileUpload = function () {\n        var uploadID = this.parent.element.id + '_fileUpload';\n        this.parent.element.appendChild(this.parent.createElement('input', {\n            id: uploadID,\n            attrs: { type: 'file', accept: '.xls, .xlsx, .csv', name: 'fileUpload' }\n        }));\n        var uploadBox = document.getElementById(uploadID);\n        uploadBox.onchange = this.fileSelect.bind(this);\n        uploadBox.onerror = this.openFailed.bind(this);\n        uploadBox.style.display = 'none';\n    };\n    /**\n     * Process after select the excel and image file.\n     * @param {Event} args - File select native event.\n     */\n    Open.prototype.fileSelect = function (args) {\n        /* tslint:disable-next-line:no-any */\n        var filesData = args.target.files[0];\n        if (filesData && filesData.length < 1) {\n            return;\n        }\n        var impArgs = {\n            file: filesData\n        };\n        this.parent.open(impArgs);\n        document.getElementById(this.parent.element.id + '_fileUpload').value = '';\n    };\n    /**\n     * File open success event declaration.\n     * @param {string} response - File open success response text.\n     */\n    Open.prototype.openSuccess = function (response) {\n        var openError = ['UnsupportedFile', 'InvalidUrl'];\n        if (openError.indexOf(response.data) > -1) {\n            this.parent.serviceLocator.getService(dialog).show({\n                content: this.parent.serviceLocator.getService('spreadsheetLocale')\n                    .getConstant(response.data),\n                width: '300'\n            });\n            this.parent.hideSpinner();\n            return;\n        }\n        if (!this.parent.element) {\n            return;\n        }\n        this.parent.renderModule.refreshSheet();\n        this.parent.notify(refreshSheetTabs, this);\n        this.parent.hideSpinner();\n    };\n    /**\n     * File open failure event declaration.\n     * @param {object} args - Open failure arguments.\n     */\n    Open.prototype.openFailed = function (args) {\n        this.parent.trigger('openFailure', args);\n        this.parent.hideSpinner();\n        /* Need to Implement */\n    };\n    /**\n     * To Remove the event listeners.\n     */\n    Open.prototype.destroy = function () {\n        this.removeEventListener();\n        this.parent = null;\n    };\n    /**\n     * Get the sheet open module name.\n     */\n    Open.prototype.getModuleName = function () {\n        return 'open';\n    };\n    return Open;\n}());\nexport { Open };\n","import { beginSave, saveCompleted } from '../../workbook/common/event';\n/**\n * `Save` module is used to handle the save action in Spreadsheet.\n */\nvar Save = /** @class */ (function () {\n    /**\n     * Constructor for Save module in Spreadsheet.\n     * @private\n     */\n    function Save(parent) {\n        this.parent = parent;\n        this.addEventListener();\n        //Spreadsheet.Inject(WorkbookSave);\n    }\n    /**\n     * To destroy the Save module.\n     * @return {void}\n     * @hidden\n     */\n    Save.prototype.destroy = function () {\n        this.removeEventListener();\n        this.parent = null;\n    };\n    Save.prototype.addEventListener = function () {\n        this.parent.on(beginSave, this.initiateSave, this);\n        this.parent.on(saveCompleted, this.saveCompleted, this);\n    };\n    Save.prototype.removeEventListener = function () {\n        if (!this.parent.isDestroyed) {\n            this.parent.off(beginSave, this.initiateSave);\n            this.parent.off(saveCompleted, this.saveCompleted);\n        }\n    };\n    /**\n     * Get the module name.\n     * @returns string\n     * @private\n     */\n    Save.prototype.getModuleName = function () {\n        return 'save';\n    };\n    /**\n     * Initiate save process.\n     * @hidden\n     */\n    Save.prototype.initiateSave = function (args) {\n        this.parent.showSpinner();\n    };\n    /**\n     * Save action completed.\n     * @hidden\n     */\n    Save.prototype.saveCompleted = function (args) {\n        this.parent.hideSpinner();\n    };\n    return Save;\n}());\nexport { Save };\n","import { ContextMenu as ContextMenuComponent } from '@syncfusion/ej2-navigations';\nimport { closest, extend, detach } from '@syncfusion/ej2-base';\nimport { addSheetTab, removeSheetTab, cMenuBeforeOpen, renameSheetTab, cut, copy, paste } from '../common/index';\nimport { addContextMenuItems, removeContextMenuItems, enableContextMenuItems } from '../common/index';\n/**\n * Represents context menu for Spreadsheet.\n */\nvar ContextMenu = /** @class */ (function () {\n    /**\n     * Constructor for ContextMenu module.\n     */\n    function ContextMenu(parent) {\n        this.parent = parent;\n        this.init();\n    }\n    ContextMenu.prototype.init = function () {\n        this.initContextMenu();\n        this.addEventListener();\n    };\n    ContextMenu.prototype.initContextMenu = function () {\n        var ul = document.createElement('ul');\n        ul.id = this.parent.element.id + '_contextmenu';\n        this.parent.element.appendChild(ul);\n        this.contextMenuInstance = new ContextMenuComponent({\n            cssClass: 'e-spreadsheet-contextmenu',\n            target: '#' + this.parent.element.id,\n            filter: 'e-numericcontainer e-active-cell e-selection e-row e-header-row e-select-all-cell e-sheet-tabs-items',\n            select: this.selectHandler.bind(this),\n            beforeOpen: this.beforeOpenHandler.bind(this),\n            beforeClose: this.beforeCloseHandler.bind(this)\n        }, ul);\n    };\n    /**\n     * Before close event handler.\n     */\n    ContextMenu.prototype.beforeCloseHandler = function (args) {\n        this.parent.trigger('contextMenuBeforeClose', args);\n    };\n    /**\n     * Select event handler.\n     */\n    ContextMenu.prototype.selectHandler = function (args) {\n        var selectArgs = extend({ cancel: false }, args);\n        this.parent.trigger('contextMenuItemSelect', selectArgs);\n        if (!selectArgs.cancel) {\n            switch (args.item.text) {\n                case 'Dialog':\n                    // Dialog functionality goes here\n                    break;\n                case 'Cut':\n                    this.parent.notify(cut, { isClick: true });\n                    break;\n                case 'Copy':\n                    this.parent.notify(copy, { isClick: true });\n                    break;\n                case 'Paste':\n                    this.parent.notify(paste, { isClick: true });\n                    break;\n                case 'Values':\n                    this.parent.notify(paste, { type: 'Values' });\n                    break;\n                case 'Formats':\n                    this.parent.notify(paste, { type: 'Formats' });\n                    break;\n                case 'Rename':\n                    this.parent.notify(renameSheetTab, {});\n                    break;\n                case 'Delete':\n                    this.parent.notify(removeSheetTab, {});\n                    break;\n                case 'Insert':\n                    this.parent.notify(addSheetTab, { text: args.item.text });\n                    break;\n                default:\n                // Rename functionality goes here\n            }\n        }\n    };\n    /**\n     * Before open event handler.\n     */\n    ContextMenu.prototype.beforeOpenHandler = function (args) {\n        var target = this.getTarget(args.event.target);\n        if (args.element.classList.contains('e-contextmenu')) {\n            var items = this.getDataSource(target);\n            this.contextMenuInstance.items = items;\n            this.contextMenuInstance.dataBind();\n        }\n        this.parent.trigger('contextMenuBeforeOpen', args);\n        this.parent.notify(cMenuBeforeOpen, extend(args, { target: target }));\n    };\n    /**\n     * To get target area based on right click.\n     */\n    ContextMenu.prototype.getTarget = function (target) {\n        if (closest(target, '.e-row-header') || closest(target, '.e-header-panel')) {\n            return 'Header';\n        }\n        else if (closest(target, '.e-main-content')) {\n            return 'Content';\n        }\n        else if (closest(target, '.e-sheet-tabs-items')) {\n            return 'Footer';\n        }\n        else {\n            return '';\n        }\n    };\n    /**\n     * To populate context menu items based on target area.\n     */\n    ContextMenu.prototype.getDataSource = function (target) {\n        var items = [];\n        if (target === 'Header') {\n            this.setClipboardData(items);\n        }\n        else if (target === 'Content') {\n            this.setClipboardData(items);\n        }\n        else if (target === 'Footer') {\n            items.push({\n                text: 'Insert'\n            });\n            items.push({\n                text: 'Delete', iconCss: 'e-icons e-delete'\n            });\n            items.push({\n                text: 'Rename'\n            });\n        }\n        return items;\n    };\n    ContextMenu.prototype.setClipboardData = function (items) {\n        if (this.parent.enableClipboard) {\n            items.push({\n                text: 'Cut',\n                iconCss: 'e-icons e-cut-icon'\n            });\n            items.push({\n                text: 'Copy',\n                iconCss: 'e-icons e-copy-icon'\n            });\n            items.push({\n                text: 'Paste',\n                iconCss: 'e-icons e-paste-icon'\n            });\n            items.push({\n                text: 'Paste Special',\n                iconCss: 'e-icons e-paste-icon',\n                items: [\n                    { text: 'Values' },\n                    { text: 'Formats' }\n                ]\n            });\n        }\n    };\n    /**\n     * To add event listener.\n     */\n    ContextMenu.prototype.addEventListener = function () {\n        this.parent.on(addContextMenuItems, this.addItemsHandler, this);\n        this.parent.on(removeContextMenuItems, this.removeItemsHandler, this);\n        this.parent.on(enableContextMenuItems, this.enableItemsHandler, this);\n    };\n    /**\n     * To add context menu items before / after particular item.\n     */\n    ContextMenu.prototype.addItemsHandler = function (args) {\n        if (args.insertAfter) {\n            this.contextMenuInstance.insertAfter(args.items, args.text, args.isUniqueId);\n        }\n        else {\n            this.contextMenuInstance.insertBefore(args.items, args.text, args.isUniqueId);\n        }\n    };\n    /**\n     * To remove context menu items.\n     */\n    ContextMenu.prototype.removeItemsHandler = function (args) {\n        this.contextMenuInstance.removeItems(args.items, args.isUniqueId);\n    };\n    /**\n     * To enable / disable context menu items.\n     */\n    ContextMenu.prototype.enableItemsHandler = function (args) {\n        this.contextMenuInstance.enableItems(args.items, args.enable, args.isUniqueId);\n    };\n    /**\n     * To remove event listener.\n     */\n    ContextMenu.prototype.removeEventListener = function () {\n        if (!this.parent.isDestroyed) {\n            this.parent.off(addContextMenuItems, this.addItemsHandler);\n            this.parent.off(removeContextMenuItems, this.removeItemsHandler);\n            this.parent.off(enableContextMenuItems, this.enableItemsHandler);\n        }\n    };\n    /**\n     * To get module name.\n     */\n    ContextMenu.prototype.getModuleName = function () {\n        return 'contextMenu';\n    };\n    /**\n     * Destroy method.\n     */\n    ContextMenu.prototype.destroy = function () {\n        this.removeEventListener();\n        this.contextMenuInstance.destroy();\n        var ele = document.getElementById(this.parent.element.id + '_contextmenu');\n        if (ele) {\n            detach(ele);\n        }\n        this.parent = null;\n    };\n    return ContextMenu;\n}());\nexport { ContextMenu };\n","import { refreshCellElement } from '../../workbook/common/event';\nimport { isNullOrUndefined } from '@syncfusion/ej2-base';\n/**\n * Specifies number format.\n */\nvar NumberFormat = /** @class */ (function () {\n    function NumberFormat(parent) {\n        this.parent = parent;\n        this.addEventListener();\n        //Spreadsheet.Inject(WorkbookNumberFormat);\n    }\n    NumberFormat.prototype.refreshCellElement = function (args) {\n        var cell = this.parent.getCell(args.rowIndex, args.colIndex);\n        if (!isNullOrUndefined(cell)) {\n            this.parent.refreshNode(cell, args);\n        }\n    };\n    /**\n     * Adding event listener for number format.\n     * @hidden\n     */\n    NumberFormat.prototype.addEventListener = function () {\n        this.parent.on(refreshCellElement, this.refreshCellElement, this);\n    };\n    /**\n     * Removing event listener for number format.\n     * @hidden\n     */\n    NumberFormat.prototype.removeEventListener = function () {\n        if (!this.parent.isDestroyed) {\n            this.parent.off(refreshCellElement, this.refreshCellElement);\n        }\n    };\n    /**\n     * To Remove the event listeners.\n     */\n    NumberFormat.prototype.destroy = function () {\n        this.removeEventListener();\n        this.parent = null;\n    };\n    /**\n     * Get the workbook import module name.\n     */\n    NumberFormat.prototype.getModuleName = function () {\n        return 'numberFormat';\n    };\n    return NumberFormat;\n}());\nexport { NumberFormat };\n","import { Spreadsheet } from '../index';\nimport { Selection, Edit, KeyboardNavigation, KeyboardShortcut, Clipboard, CellFormat } from '../actions/index';\nimport { Ribbon, FormulaBar, SheetTabs, Open, ContextMenu, Save, NumberFormat, Formula } from '../integrations/index';\nimport { DataBind } from '../../workbook/index';\n/**\n * Spreadsheet basic module.\n * @private\n */\nvar BasicModule = /** @class */ (function () {\n    /**\n     * Constructor for Spreadsheet basic module.\n     * @private\n     */\n    function BasicModule() {\n        Spreadsheet.Inject(Ribbon, FormulaBar, SheetTabs, Selection, Edit, KeyboardNavigation, KeyboardShortcut, Clipboard, DataBind, Open, ContextMenu, Save, NumberFormat, CellFormat, Formula);\n    }\n    /**\n     * For internal use only - Get the module name.\n     * @private\n     */\n    BasicModule.prototype.getModuleName = function () {\n        return 'basic';\n    };\n    /**\n     * Destroys the Spreadsheet basic module.\n     * @return {void}\n     */\n    BasicModule.prototype.destroy = function () {\n        /* code snippet */\n    };\n    return BasicModule;\n}());\nexport { BasicModule };\n","import { Spreadsheet } from '../index';\nimport { Selection, Edit, KeyboardNavigation, KeyboardShortcut, Clipboard, CellFormat } from '../actions/index';\nimport { Ribbon, FormulaBar, SheetTabs, Open, Save, NumberFormat, Formula } from '../integrations/index';\nimport { DataBind } from '../../workbook/integrations/index';\n/**\n * Spreadsheet all module.\n * @private\n */\nvar AllModule = /** @class */ (function () {\n    /**\n     * Constructor for Spreadsheet all module.\n     * @private\n     */\n    function AllModule() {\n        Spreadsheet.Inject(Ribbon, FormulaBar, SheetTabs, Selection, Edit, KeyboardNavigation, KeyboardShortcut, Clipboard, DataBind, Open, Save, NumberFormat, CellFormat, Formula);\n    }\n    /**\n     * For internal use only - Get the module name.\n     * @private\n     */\n    AllModule.prototype.getModuleName = function () {\n        return 'all';\n    };\n    /**\n     * Destroys the Spreadsheet all module.\n     * @return {void}\n     */\n    AllModule.prototype.destroy = function () {\n        /* code snippet */\n    };\n    return AllModule;\n}());\nexport { AllModule };\n","var __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    }\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nimport { Property, ChildProperty } from '@syncfusion/ej2-base';\n/**\n * Represents the scroll settings.\n */\nvar ScrollSettings = /** @class */ (function (_super) {\n    __extends(ScrollSettings, _super);\n    function ScrollSettings() {\n        return _super !== null && _super.apply(this, arguments) || this;\n    }\n    __decorate([\n        Property(false)\n    ], ScrollSettings.prototype, \"isFinite\", void 0);\n    __decorate([\n        Property(true)\n    ], ScrollSettings.prototype, \"enableVirtualization\", void 0);\n    return ScrollSettings;\n}(ChildProperty));\nexport { ScrollSettings };\n/**\n * Represents the selection settings.\n */\nvar SelectionSettings = /** @class */ (function (_super) {\n    __extends(SelectionSettings, _super);\n    function SelectionSettings() {\n        return _super !== null && _super.apply(this, arguments) || this;\n    }\n    __decorate([\n        Property('Multiple')\n    ], SelectionSettings.prototype, \"mode\", void 0);\n    return SelectionSettings;\n}(ChildProperty));\nexport { SelectionSettings };\n","/** @hidden */\nexport var DISABLED = 'e-disabled';\n/** @hidden */\nexport var locale = 'spreadsheetLocale';\n/** @hidden */\nexport var dialog = 'dialog';\n/** @hidden */\nexport var fontColor = {\n    'Custom': [\n        '#ffffff', '#000000', '#e7e6e6', '#44546a', '#4472c4', '#ed7d31', '#a5a5a5', '#ffc000', '#70ad47', '#ff0000',\n        '#f2f2f2', '#808080', '#cfcdcd', '#d5dce4', '#d9e2f3', '#fbe4d5', '#ededed', '#fff2cc', '#e2efd9', '#ffcccc',\n        '#d9d9d9', '#595959', '#aeaaaa', '#acb9ca', '#b4c6e7', '#f7caac', '#dbdbdb', '#ffe599', '#c5e0b3', '#ff8080',\n        '#bfbfbf', '#404040', '#747070', '#8496b0', '#8eaadb', '#f4b083', '#c9c9c9', '#ffd966', '#a8d08d', '#ff3333',\n        '#a6a6a6', '#262626', '#3b3838', '#323e4f', '#2f5496', '#c45911', '#7b7b7b', '#bf8f00', '#538135', '#b30000',\n        '#7f7f7f', '#0d0d0d', '#161616', '#212934', '#1f3763', '#823b0b', '#525252', '#7f5f00', '#375623', '#660000'\n    ]\n};\n/** @hidden */\nexport var fillColor = {\n    'Custom': [\n        '#ffffff', '#000000', '#ffff00', '#00ff00', '#00ffff', '#0000ff', '#ff0000', '#000080', '#800080', '#996633',\n        '#f2f2f2', '#808080', '#ffffcc', '#b3ffb3', '#ccffff', '#ccccff', '#ffcccc', '#ccccff', '#ff80ff', '#f2e6d9',\n        '#d9d9d9', '#595959', '#ffff80', '#80ff80', '#b3ffff', '#8080ff', '#ff8080', '#8080ff', '#ff00ff', '#dfbf9f',\n        '#bfbfbf', '#404040', '#ffff33', '#33ff33', '#33ffff', '#3333ff', '#ff3333', '#0000b3', '#b300b3', '#c68c53',\n        '#a6a6a6', '#262626', '#e6e600', '#00b300', '#009999', '#000099', '#b30000', '#000066', '#660066', '#86592d',\n        '#7f7f7f', '#0d0d0d', '#999900', '#006600', '#006666', '#000066', '#660000', '#00004d', '#4d004d', '#734d26',\n    ]\n};\n/**\n * Default locale text\n * @hidden\n */\nexport var defaultLocale = {\n    Cut: 'Cut',\n    Copy: 'Copy',\n    Paste: 'Paste',\n    All: 'All',\n    Values: 'Values',\n    Formats: 'Formats',\n    Bold: 'Bold',\n    Font: 'Font',\n    FontSize: 'Font Size',\n    Italic: 'Italic',\n    Underline: 'Underline',\n    Strikethrough: 'Strikethrough',\n    TextColor: 'Text Color',\n    FillColor: 'Fill Color',\n    HorizontalAlignment: 'Horizontal Alignment',\n    AlignLeft: 'Align Left',\n    AlignCenter: 'Center',\n    AlignRight: 'Align Right',\n    VerticalAlignment: 'Vertical Alignment',\n    AlignTop: 'Align Top',\n    AlignMiddle: 'Align Middle',\n    AlignBottom: 'Align Bottom',\n    InsertFunction: 'Insert Function',\n    NameBox: 'Name Box',\n    ShowHeaders: 'Show Headers',\n    HideHeaders: 'Hide Headers',\n    ShowGridLines: 'Show Gridlines',\n    HideGridLines: 'Hide Gridlines',\n    AddSheet: 'Add Sheet',\n    ListAllSheets: 'List All Sheets',\n    FullScreen: 'Full Screen',\n    CollapseToolbar: 'Collapse Toolbar',\n    ExpandToolbar: 'Expand Toolbar',\n    CollapseFormulaBar: 'Collapse Formula Bar',\n    ExpandFormulaBar: 'Expand Formula Bar',\n    File: 'File',\n    Home: 'Home',\n    Formulas: 'Formulas',\n    View: 'View',\n    New: 'New',\n    Open: 'Open',\n    SaveAs: 'Save As',\n    ExcelXlsx: 'Microsoft Excel',\n    ExcelXls: 'Microsoft Excel 97-2003',\n    CSV: 'Comma-separated values',\n    FormulaBar: 'Formula Bar',\n    Ok: 'Ok',\n    Close: 'Close',\n    Cancel: 'Cancel',\n    Apply: 'Apply',\n    MoreColors: 'More Colors',\n    StandardColors: 'Standard Colors',\n    General: 'General',\n    Number: 'Number',\n    Currency: 'Currency',\n    Accounting: 'Accounting',\n    ShortDate: 'Short Date',\n    LongDate: 'Long Date',\n    Time: 'Time',\n    Percentage: 'Percentage',\n    Fraction: 'Fraction',\n    Scientific: 'Scientific',\n    Text: 'Text',\n    MobileFormulaBarPlaceHolder: 'Enter value or Formula',\n    NumberFormat: 'Number Format',\n    PasteAlert: 'You can\\'t paste this here because the copy area and paste area aren\\'t in the same size.' +\n        '</br></br>Select just one cell in the paste area or an area that\\'s the same size, and try pasting again.',\n    DestroyAlert: 'Are you sure you want to destroy the current workbook without saving and create a new workbook?',\n    SheetRenameInvalidAlert: 'Sheet name contains invalid character.',\n    SheetRenameEmptyAlert: 'Sheet name cannot be empty.',\n    SheetRenameAlreadyExistsAlert: 'Sheet name already exists. Please enter another name.',\n    DeleteSheetAlert: 'Are you sure you want to delete this sheet?',\n    DeleteSingleLastSheetAlert: 'A Workbook must contain at least one visible worksheet.',\n    PickACategory: 'Pick a category',\n    Description: 'Description',\n    UnsupportedFile: 'Unsupported File',\n    InvalidUrl: 'Invalid Url',\n    SUM: 'Sums all values, cell references or ranges.',\n    SUMIFS: 'Sums the cells specified by a given set of conditions or criteria.',\n    ABS: 'Returns the absolute value of a number.',\n    RAND: 'Return a random number between 0 and 1.',\n    FLOOR: 'Returns the round a number down to the nearest multiple of significance.',\n    CEILING: 'Returns a number rounded up to a nearest multiple of significance.',\n    SUMIF: 'It will sum up cells that meet the given criteria.',\n    PRODUCT: 'Multiplies all the numbers given as arguments and returns the product.',\n    AVERAGE: 'The sum of the numbers divided by how many numbers are being averaged.',\n    AVERAGEIF: 'Computes the average of the numbers in a range that meet the supplied criteria.',\n    COUNT: 'Counts the numbers in the list of arguments, exclude text entries.',\n    COUNTA: 'Counts the non-empty values in the list of arguments.',\n    COUNTIF: 'Counts the number of cells in a range that meet a specified condition.',\n    COUNTIFS: 'Counts the number of times each cells in all the ranges that meet the specific conditions.',\n    AVERAGEA: 'Calculates the average of values in the list of arguments.Arguments can be numbers, names, arrays or references.',\n    AVERAGEIFS: 'Conditionally returns the average of the contents of cells for the set of ranges.',\n    MIN: 'Returns the smaller number in set of arguments.',\n    MAX: 'Returns the largest number in set of arguments.',\n    DATE: 'Returns the date, given the year, month and day of the month.',\n    DAY: 'Returns the day of a given date.',\n    DAYS: 'Returns the number of days between two dates.',\n    IF: 'Returns one value if a logical expression is TRUE and another if it is FALSE',\n    AND: 'Returns TRUE if all the arguments are considered TRUE, and FALSE otherwise.',\n    IFS: 'Checks multiple conditions and returns a value corresponding to the first TRUE result.',\n    IFERROR: 'Returns a value you specify if a formula evaluates to an error; otherwise, it returns the result of the formula.',\n    CHOOSE: 'Returns a value from a list, given an index number.',\n    INDEX: 'Returns a value from a table, given a row and column number.',\n    FIND: 'Returns the position of a string of text within another string.',\n    CONCATENATE: 'Used to join two or more strings together.',\n    CONCAT: 'Concatenates a list or range of text strings.',\n    SUBTOTAL: 'Returns a subtotal in a list or database.',\n    RADIANS: 'Converts degrees in to radians.',\n    OR: 'Returns TRUE if any arguments considered TRUE, and all the arguments are FALSE it will return FALSE.',\n    MATCH: 'Returns the relative position of an checked item in range that matches a specified value in a specified order.',\n    DefineNameExists: 'This name is already exists, try different name.'\n};\n","import { formatUnit, detach } from '@syncfusion/ej2-base';\nimport { getRangeIndexes } from './../../workbook/common/address';\nimport { getColumnWidth } from '../../workbook/base/column';\nimport { contentLoaded, editOperation, getUpdateUsingRaf, removeAllChildren } from '../common/index';\nimport { beforeContentLoaded, getColGroupWidth, virtualContentLoaded, setAriaOptions, dataBound } from '../common/index';\nimport { beforeHeaderLoaded } from '../common/index';\n/**\n * Sheet module is used to render Sheet\n * @hidden\n */\nvar SheetRender = /** @class */ (function () {\n    function SheetRender(parent) {\n        this.freezePane = false;\n        this.colGroupWidth = 30; //Row header and selectall table colgroup width\n        this.parent = parent;\n        this.col = parent.createElement('col');\n        this.rowRenderer = parent.serviceLocator.getService('row');\n        this.cellRenderer = parent.serviceLocator.getService('cell');\n    }\n    SheetRender.prototype.refreshSelectALLContent = function () {\n        var cell;\n        if (this.freezePane) {\n            var tHead = this.getSelectAllTable().querySelector('thead');\n            var row = this.rowRenderer.render(true);\n            tHead.appendChild(row);\n            cell = this.parent.createElement('th', { className: 'e-select-all-cell' });\n            row.appendChild(cell);\n        }\n        else {\n            cell = this.headerPanel.firstElementChild;\n            cell.classList.add('e-select-all-cell');\n        }\n        cell.appendChild(this.parent.createElement('button', { className: 'e-selectall e-icons',\n            id: this.parent.element.id + \"_select_all\" }));\n    };\n    SheetRender.prototype.updateLeftColGroup = function (width, table) {\n        if (width) {\n            this.colGroupWidth = width;\n        }\n        if (!table) {\n            table = this.getRowHeaderTable();\n        }\n        this.detachColGroup(table);\n        var colGrp = this.parent.createElement('colgroup');\n        var colGrpWidth = this.colGroupWidth + \"px\";\n        var col = this.col.cloneNode();\n        col.style.width = colGrpWidth;\n        colGrp.appendChild(col);\n        table.insertBefore(colGrp, table.querySelector('tbody'));\n        if (this.freezePane) {\n            table = this.getSelectAllTable();\n            this.detachColGroup(table);\n            table.insertBefore(colGrp.cloneNode(true), table.querySelector('thead'));\n        }\n        else {\n            this.getSelectAllContent().style.width = colGrpWidth;\n        }\n        if (this.parent.getActiveSheet().showHeaders) {\n            this.getColHeaderPanel().style.width = \"calc(100% - \" + colGrpWidth + \")\";\n            this.getContentPanel().style.width = \"calc(100% - \" + colGrpWidth + \")\";\n        }\n    };\n    SheetRender.prototype.detachColGroup = function (table) {\n        var colGrp = table.querySelector('colgroup');\n        if (colGrp) {\n            detach(colGrp);\n        }\n    };\n    SheetRender.prototype.renderPanel = function () {\n        this.contentPanel = this.parent.createElement('div', { className: 'e-main-panel' });\n        var sheet = this.parent.getActiveSheet();\n        var id = this.parent.element.id;\n        if (sheet.showHeaders) {\n            this.contentPanel.appendChild(this.parent.createElement('div', { className: 'e-row-header', id: id + \"_row_header\" }));\n            this.initHeaderPanel();\n            this.parent.scrollModule.setPadding();\n        }\n        else {\n            this.updateHideHeaders();\n        }\n        var content = this.contentPanel.appendChild(this.parent.createElement('div', { className: 'e-main-content', id: id + \"_main_content\" }));\n        if (!sheet.showGridLines) {\n            content.classList.add('e-hide-gridlines');\n        }\n        if (!this.parent.allowScrolling) {\n            content.style.overflow = 'hidden';\n        }\n    };\n    SheetRender.prototype.initHeaderPanel = function () {\n        var id = this.parent.element.id;\n        this.headerPanel = this.parent.createElement('div', { className: 'e-header-panel' });\n        this.headerPanel.appendChild(this.parent.createElement('div', { className: 'e-selectall-container', id: id + \"_selectall\" }));\n        this.headerPanel.appendChild(this.parent.createElement('div', { className: 'e-column-header', id: id + \"_col_header\" }));\n    };\n    SheetRender.prototype.createTable = function () {\n        if (this.parent.getActiveSheet().showHeaders) {\n            this.createHeaderTable();\n        }\n        this.updateTable('tbody', 'content', this.contentPanel.lastElementChild);\n    };\n    SheetRender.prototype.createHeaderTable = function (rowHdrEle) {\n        if (rowHdrEle === void 0) { rowHdrEle = this.contentPanel.querySelector('.e-row-header'); }\n        if (this.freezePane) {\n            this.updateTable('thead', 'selectall', this.headerPanel.querySelector('.e-selectall-container'));\n        }\n        this.updateTable('thead', 'colhdr', this.headerPanel.querySelector('.e-column-header'));\n        this.updateTable('tbody', 'rowhdr', rowHdrEle);\n        this.updateLeftColGroup(null, rowHdrEle.querySelector('table'));\n    };\n    SheetRender.prototype.updateTable = function (tagName, name, appendTo) {\n        var table = this.parent.createElement('table', { className: 'e-table', attrs: { 'role': 'grid' } });\n        table.classList.add(\"e-\" + name + \"-table\");\n        appendTo.appendChild(table);\n        table.appendChild(this.parent.createElement(tagName));\n    };\n    /**\n     * It is used to refresh the select all, row header, column header and content table contents.\n     */\n    SheetRender.prototype.renderTable = function (cells, rowIdx, colIdx, lastIdx, top, left) {\n        var _this = this;\n        var indexes;\n        var row;\n        var sheet = this.parent.getActiveSheet();\n        var frag = document.createDocumentFragment();\n        this.createTable();\n        var colGrp = this.parent.createElement('colgroup');\n        var cTBody = this.contentPanel.querySelector('.e-main-content tbody');\n        var rHdrTBody;\n        var cHdrTHead;\n        var cHdrRow;\n        if (sheet.showHeaders) {\n            frag.appendChild(this.headerPanel);\n            this.refreshSelectALLContent();\n            rHdrTBody = this.contentPanel.querySelector('.e-row-header tbody');\n            cHdrTHead = this.headerPanel.querySelector('.e-column-header thead');\n            this.getColHeaderTable().insertBefore(colGrp, cHdrTHead);\n            cHdrRow = this.rowRenderer.render(true);\n            cHdrTHead.appendChild(cHdrRow);\n        }\n        frag.appendChild(this.contentPanel);\n        this.parent.notify(beforeContentLoaded, { startColIdx: colIdx });\n        cells.forEach(function (value, key) {\n            indexes = getRangeIndexes(key);\n            if (indexes[0] === rowIdx) {\n                _this.updateCol(indexes[1], colGrp, sheet);\n                if (sheet.showHeaders) {\n                    cHdrRow.appendChild(_this.cellRenderer.renderColHeader(indexes[1]));\n                }\n            }\n            if (indexes[1] === colIdx) {\n                if (sheet.showHeaders) {\n                    row = _this.rowRenderer.render(false, indexes[0]);\n                    rHdrTBody.appendChild(row);\n                    row.appendChild(_this.cellRenderer.renderRowHeader(indexes[0]));\n                }\n                row = _this.rowRenderer.render(false, indexes[0]);\n                cTBody.appendChild(row);\n            }\n            row.appendChild(_this.cellRenderer.render({ colIdx: indexes[1], rowIdx: indexes[0], cell: value,\n                address: key, lastCell: indexes[1] === lastIdx, isHeightCheckNeeded: true }));\n        });\n        this.getContentTable().insertBefore(colGrp.cloneNode(true), cTBody);\n        getUpdateUsingRaf(function () {\n            var content = _this.parent.getMainContent();\n            document.getElementById(_this.parent.element.id + '_sheet').appendChild(frag);\n            if (top) {\n                content.scrollTop = top;\n                if (sheet.showHeaders) {\n                    _this.parent.getRowHeaderContent().scrollTop = top;\n                }\n            }\n            if (left) {\n                content.scrollLeft = left;\n                if (sheet.showHeaders) {\n                    _this.parent.getColumnHeaderContent().scrollLeft = left;\n                }\n            }\n            _this.parent.notify(contentLoaded, null);\n            _this.parent.notify(editOperation, { action: 'renderEditor' });\n            if (!_this.parent.isOpen) {\n                _this.parent.hideSpinner();\n            }\n            setAriaOptions(_this.parent.getMainContent(), { busy: false });\n            _this.parent.trigger(dataBound, {});\n        });\n    };\n    SheetRender.prototype.refreshColumnContent = function (cells, rowIndex, colIndex, lastIdx) {\n        var _this = this;\n        var indexes;\n        var row;\n        var table;\n        var count = 0;\n        var sheet = this.parent.getActiveSheet();\n        var frag = document.createDocumentFragment();\n        var hFrag = document.createDocumentFragment();\n        var tBody = this.parent.element.querySelector('.e-main-content tbody');\n        tBody = frag.appendChild(tBody.cloneNode(true));\n        var colGrp = this.parent.element.querySelector('.e-main-content colgroup');\n        colGrp = colGrp.cloneNode();\n        var hRow;\n        var tHead;\n        if (sheet.showHeaders) {\n            hFrag.appendChild(colGrp);\n            tHead = this.parent.element.querySelector('.e-column-header thead');\n            tHead = hFrag.appendChild(tHead.cloneNode(true));\n            hRow = tHead.querySelector('tr');\n            hRow.innerHTML = '';\n        }\n        cells.forEach(function (value, key) {\n            indexes = getRangeIndexes(key);\n            if (indexes[0] === rowIndex) {\n                _this.updateCol(indexes[1], colGrp, sheet);\n                if (sheet.showHeaders) {\n                    hRow.appendChild(_this.cellRenderer.renderColHeader(indexes[1]));\n                }\n            }\n            if (indexes[1] === colIndex) {\n                row = tBody.children[count];\n                if (row) {\n                    count++;\n                    row.innerHTML = '';\n                }\n                else {\n                    return;\n                }\n            }\n            row.appendChild(_this.cellRenderer.render({\n                colIdx: indexes[1], rowIdx: indexes[0], cell: value, address: key\n            }));\n        });\n        frag.insertBefore(colGrp.cloneNode(true), tBody);\n        getUpdateUsingRaf(function () {\n            if (sheet.showHeaders) {\n                table = _this.getColHeaderTable();\n                removeAllChildren(table);\n                table.appendChild(hFrag);\n            }\n            table = _this.getContentTable();\n            removeAllChildren(table);\n            table.appendChild(frag);\n            _this.parent.notify(virtualContentLoaded, { refresh: 'Column' });\n            if (!_this.parent.isOpen) {\n                _this.parent.hideSpinner();\n            }\n            setAriaOptions(_this.parent.getMainContent(), { busy: false });\n        });\n    };\n    SheetRender.prototype.refreshRowContent = function (cells, startIndex, lastIdx) {\n        var _this = this;\n        var indexes;\n        var row;\n        var hRow;\n        var colGroupWidth = this.colGroupWidth;\n        var sheet = this.parent.getActiveSheet();\n        var hFrag;\n        var hTBody;\n        var frag = document.createDocumentFragment();\n        var tBody = this.parent.createElement('tbody');\n        if (sheet.showHeaders) {\n            hFrag = document.createDocumentFragment();\n            hTBody = tBody.cloneNode();\n            hFrag.appendChild(hTBody);\n        }\n        frag.appendChild(tBody);\n        cells.forEach(function (value, key) {\n            indexes = getRangeIndexes(key);\n            if (indexes[1] === startIndex) {\n                if (sheet.showHeaders) {\n                    hRow = _this.rowRenderer.render(false, indexes[0]);\n                    hTBody.appendChild(hRow);\n                    hRow.appendChild(_this.cellRenderer.renderRowHeader(indexes[0]));\n                    colGroupWidth = getColGroupWidth(indexes[0] + 1);\n                }\n                row = _this.rowRenderer.render(false, indexes[0]);\n                tBody.appendChild(row);\n            }\n            row.appendChild(_this.cellRenderer.render({ rowIdx: indexes[0], colIdx: indexes[1], cell: value, address: key,\n                lastCell: indexes[1] === lastIdx, row: row, hRow: hRow, isHeightCheckNeeded: true }));\n        });\n        getUpdateUsingRaf(function () {\n            if (_this.parent.isDestroyed) {\n                return;\n            }\n            if (_this.colGroupWidth !== colGroupWidth) {\n                _this.updateLeftColGroup(colGroupWidth);\n            }\n            if (sheet.showHeaders) {\n                detach(_this.contentPanel.querySelector('.e-row-header tbody'));\n                _this.getRowHeaderTable().appendChild(hFrag);\n            }\n            detach(_this.contentPanel.querySelector('.e-main-content tbody'));\n            _this.getContentTable().appendChild(frag);\n            _this.parent.notify(virtualContentLoaded, { refresh: 'Row' });\n            if (!_this.parent.isOpen) {\n                _this.parent.hideSpinner();\n            }\n            setAriaOptions(_this.parent.getMainContent(), { busy: false });\n        });\n    };\n    SheetRender.prototype.updateCol = function (idx, appendTo, sheet) {\n        var col = this.col.cloneNode();\n        col.style.width = formatUnit(getColumnWidth(sheet, idx));\n        appendTo.appendChild(col);\n    };\n    SheetRender.prototype.updateColContent = function (cells, rowIdx, colIdx, lastIdx, direction) {\n        var _this = this;\n        getUpdateUsingRaf(function () {\n            var indexes;\n            var row;\n            var table;\n            var refChild;\n            var cell;\n            var hRow;\n            var rowCount = 0;\n            var col;\n            var hRefChild;\n            var sheet = _this.parent.getActiveSheet();\n            if (sheet.showHeaders) {\n                hRow = _this.parent.element.querySelector('.e-column-header .e-header-row');\n                hRefChild = hRow.firstElementChild;\n            }\n            var colGrp = _this.parent.element.querySelector('.e-main-content colgroup');\n            var colRefChild = colGrp.firstElementChild;\n            var tBody = _this.parent.element.querySelector('.e-main-content tbody');\n            cells.forEach(function (value, key) {\n                indexes = getRangeIndexes(key);\n                if (indexes[0] === rowIdx) {\n                    if (direction === 'first') {\n                        _this.updateCol(indexes[1], colGrp, sheet);\n                        if (sheet.showHeaders) {\n                            hRow.appendChild(_this.cellRenderer.renderColHeader(indexes[1]));\n                        }\n                    }\n                    else {\n                        col = _this.col.cloneNode();\n                        col.style.width = formatUnit(getColumnWidth(sheet, indexes[1]));\n                        colGrp.insertBefore(col, colRefChild);\n                        if (sheet.showHeaders) {\n                            hRow.insertBefore(_this.cellRenderer.renderColHeader(indexes[1]), hRefChild);\n                        }\n                    }\n                    if (_this.parent.scrollSettings.enableVirtualization) {\n                        // tslint:disable\n                        detach(colGrp[direction + 'ElementChild']);\n                        if (sheet.showHeaders) {\n                            detach(hRow[direction + 'ElementChild']);\n                        }\n                        // tslint:enable\n                    }\n                }\n                if (indexes[1] === colIdx) {\n                    row = tBody.children[rowCount];\n                    rowCount++;\n                    refChild = row.firstElementChild;\n                }\n                cell = _this.cellRenderer.render({ colIdx: indexes[1], rowIdx: indexes[0], cell: value, address: key,\n                    lastCell: indexes[1] === lastIdx, isHeightCheckNeeded: direction === 'first' });\n                if (direction === 'first') {\n                    row.appendChild(cell);\n                }\n                else {\n                    row.insertBefore(cell, refChild);\n                }\n                if (_this.parent.scrollSettings.enableVirtualization) {\n                    // tslint:disable-next-line:no-any\n                    detach(row[direction + 'ElementChild']);\n                }\n            });\n            if (sheet.showHeaders) {\n                table = _this.getColHeaderTable();\n                detach(table.querySelector('colgroup'));\n                table.insertBefore(colGrp.cloneNode(true), table.querySelector('thead'));\n            }\n            if (_this.parent.scrollSettings.enableVirtualization) {\n                _this.parent.notify(virtualContentLoaded, { refresh: 'Column' });\n            }\n            if (!_this.parent.isOpen) {\n                _this.parent.hideSpinner();\n            }\n            setAriaOptions(_this.parent.getMainContent(), { busy: false });\n        });\n    };\n    SheetRender.prototype.updateRowContent = function (cells, startIndex, lastIdx, direction) {\n        var _this = this;\n        var colGroupWidth = this.colGroupWidth;\n        var row;\n        var hRow;\n        var sheet = this.parent.getActiveSheet();\n        var tBody = this.parent.getMainContent().querySelector('tbody');\n        var rTBody;\n        var rFrag;\n        if (sheet.showHeaders) {\n            rFrag = document.createDocumentFragment();\n            rTBody = this.parent.getRowHeaderContent().querySelector('tbody');\n        }\n        var indexes;\n        var frag = document.createDocumentFragment();\n        this.parent.showSpinner();\n        cells.forEach(function (value, cKey) {\n            indexes = getRangeIndexes(cKey);\n            if (indexes[1] === startIndex) {\n                if (sheet.showHeaders) {\n                    hRow = _this.rowRenderer.render(false, indexes[0]);\n                    rFrag.appendChild(hRow);\n                    hRow.appendChild(_this.cellRenderer.renderRowHeader(indexes[0]));\n                    colGroupWidth = getColGroupWidth(indexes[0] + 1);\n                    if (_this.parent.scrollSettings.enableVirtualization) {\n                        // tslint:disable-next-line:no-any\n                        detach(rTBody[direction + 'ElementChild']);\n                    }\n                }\n                row = _this.rowRenderer.render(false, indexes[0]);\n                frag.appendChild(row);\n                if (_this.parent.scrollSettings.enableVirtualization) {\n                    // tslint:disable-next-line:no-any\n                    detach(tBody[direction + 'ElementChild']);\n                }\n            }\n            row.appendChild(_this.cellRenderer.render({ colIdx: indexes[1], rowIdx: indexes[0], cell: value,\n                address: cKey, lastCell: indexes[1] === lastIdx, row: row, hRow: hRow, isHeightCheckNeeded: direction === 'first' }));\n        });\n        getUpdateUsingRaf(function () {\n            if (_this.colGroupWidth !== colGroupWidth) {\n                _this.updateLeftColGroup(colGroupWidth);\n            }\n            if (direction === 'first') {\n                if (sheet.showHeaders) {\n                    rTBody.appendChild(rFrag);\n                }\n                tBody.appendChild(frag);\n            }\n            else {\n                if (sheet.showHeaders) {\n                    rTBody.insertBefore(rFrag, rTBody.firstElementChild);\n                }\n                tBody.insertBefore(frag, tBody.firstElementChild);\n            }\n            if (_this.parent.scrollSettings.enableVirtualization) {\n                _this.parent.notify(virtualContentLoaded, { refresh: 'Row' });\n            }\n            if (!_this.parent.isOpen) {\n                _this.parent.hideSpinner();\n            }\n            setAriaOptions(_this.parent.getMainContent(), { busy: false });\n        });\n    };\n    /**\n     * Used to toggle row and column headers.\n     */\n    SheetRender.prototype.showHideHeaders = function () {\n        var _this = this;\n        var sheet = this.parent.getActiveSheet();\n        if (sheet.showHeaders) {\n            if (this.parent.scrollSettings.enableVirtualization) {\n                var startIndex = [this.parent.viewport.topIndex, this.parent.viewport.leftIndex];\n                this.renderHeaders([startIndex[0], startIndex[0] + this.parent.viewport.rowCount + (this.parent.getThreshold('row') * 2)], [startIndex[1], startIndex[1] + this.parent.viewport.colCount + (this.parent.getThreshold('col') * 2)]);\n            }\n            else {\n                this.renderHeaders([0, sheet.rowCount - 1], [0, sheet.colCount - 1]);\n                if (sheet.topLeftCell !== 'A1') {\n                    this.parent.goTo(sheet.topLeftCell);\n                }\n            }\n        }\n        else {\n            getUpdateUsingRaf(function () {\n                detach(_this.headerPanel);\n                detach(_this.getRowHeaderPanel());\n                _this.getContentPanel().style.width = '';\n                _this.updateHideHeaders();\n            });\n        }\n    };\n    SheetRender.prototype.renderHeaders = function (rowIndexes, colIndexes) {\n        var _this = this;\n        this.initHeaderPanel();\n        var cFrag = document.createDocumentFragment();\n        var rFrag = document.createDocumentFragment();\n        cFrag.appendChild(this.headerPanel);\n        var rowHdrEle = rFrag.appendChild(this.parent.createElement('div', { className: 'e-row-header', id: this.parent.element.id + \"_row_header\" }));\n        this.createHeaderTable(rowHdrEle);\n        this.parent.notify(beforeHeaderLoaded, { element: rowHdrEle });\n        this.refreshSelectALLContent();\n        var rTBody = rowHdrEle.querySelector('tbody');\n        var cTHead = this.headerPanel.querySelector('.e-column-header thead');\n        var cRow = this.rowRenderer.render(true);\n        cTHead.appendChild(cRow);\n        var row;\n        for (var i = colIndexes[0]; i <= colIndexes[1]; i++) {\n            cRow.appendChild(this.cellRenderer.renderColHeader(i));\n        }\n        var colGroupWidth = getColGroupWidth(rowIndexes[1]);\n        if (this.colGroupWidth !== colGroupWidth) {\n            this.updateLeftColGroup(colGroupWidth);\n        }\n        for (var i = rowIndexes[0]; i <= rowIndexes[1]; i++) {\n            row = this.rowRenderer.render(false, i);\n            row.appendChild(this.cellRenderer.renderRowHeader(i));\n            rTBody.appendChild(row);\n        }\n        getUpdateUsingRaf(function () {\n            _this.getColHeaderTable().insertBefore(_this.getContentTable().querySelector('colgroup').cloneNode(true), cTHead);\n            var sheet = document.getElementById(_this.parent.element.id + '_sheet');\n            sheet.classList.remove('e-hide-headers');\n            sheet.insertBefore(cFrag, _this.contentPanel);\n            var content = _this.getContentPanel();\n            _this.contentPanel.insertBefore(rFrag, content);\n            _this.parent.scrollModule.setPadding();\n            rowHdrEle.scrollTop = content.scrollTop;\n            _this.getColHeaderPanel().scrollLeft = content.scrollLeft;\n        });\n    };\n    SheetRender.prototype.updateHideHeaders = function () {\n        document.getElementById(this.parent.element.id + '_sheet').classList.add('e-hide-headers');\n        this.headerPanel = null;\n    };\n    /**\n     * Get the select all table element of spreadsheet\n     * @return {HTMLElement}\n     */\n    SheetRender.prototype.getSelectAllContent = function () {\n        return this.headerPanel.getElementsByClassName('e-selectall-container')[0];\n    };\n    /**\n     * Get the select all table element of spreadsheet\n     * @return {Element}\n     */\n    SheetRender.prototype.getSelectAllTable = function () {\n        return this.headerPanel.getElementsByClassName('e-selectall-table')[0];\n    };\n    /**\n     * Get the column header element of spreadsheet\n     * @return {HTMLTableElement}\n     */\n    SheetRender.prototype.getColHeaderTable = function () {\n        return this.headerPanel.getElementsByClassName('e-colhdr-table')[0];\n    };\n    /**\n     * Get the row header table element of spreadsheet\n     * @return {HTMLTableElement}\n     */\n    SheetRender.prototype.getRowHeaderTable = function () {\n        return this.contentPanel.getElementsByClassName('e-rowhdr-table')[0];\n    };\n    /**\n     * Get the main content table element of spreadsheet\n     * @return {Element}\n     */\n    SheetRender.prototype.getContentTable = function () {\n        return this.contentPanel.getElementsByClassName('e-content-table')[0];\n    };\n    /**\n     * Get the row header div element of spreadsheet\n     * @return {Element}\n     */\n    SheetRender.prototype.getRowHeaderPanel = function () {\n        return this.contentPanel.getElementsByClassName('e-row-header')[0];\n    };\n    /**\n     * Get the column header div element of spreadsheet\n     * @return {Element}\n     */\n    SheetRender.prototype.getColHeaderPanel = function () {\n        return this.headerPanel.getElementsByClassName('e-column-header')[0];\n    };\n    /**\n     * Get the main content div element of spreadsheet\n     * @return {Element}\n     */\n    SheetRender.prototype.getContentPanel = function () {\n        return this.contentPanel.getElementsByClassName('e-main-content')[0];\n    };\n    return SheetRender;\n}());\nexport { SheetRender };\n","import { getRowHeight } from '../../workbook/base/index';\nimport { attributes } from '@syncfusion/ej2-base';\n/**\n * Sheet module is used for creating row element\n * @hidden\n */\nvar RowRenderer = /** @class */ (function () {\n    function RowRenderer(parent) {\n        this.parent = parent;\n        this.element = this.parent.createElement('tr');\n    }\n    RowRenderer.prototype.render = function (isHeader, index) {\n        var row = this.element.cloneNode();\n        if (isHeader) {\n            row.classList.add('e-header-row');\n            return row;\n        }\n        row.classList.add('e-row');\n        attributes(row, { 'role': 'row', 'aria-rowindex': index.toString() });\n        row.style.height = getRowHeight(this.parent.getActiveSheet(), index) + \"px\";\n        return row;\n    };\n    return RowRenderer;\n}());\nexport { RowRenderer };\n","import { inView } from '../common/index';\nimport { getColumnHeaderText, getCellAddress } from '../../workbook/common/index';\nimport { getCell, skipDefaultValue } from '../../workbook/base/index';\nimport { addClass, attributes, getNumberDependable, extend } from '@syncfusion/ej2-base';\nimport { getFormattedCellObject, applyCellFormat, workbookFormulaOperation, setCellFormat } from '../../workbook/common/event';\nimport { getTypeFromFormat } from '../../workbook/index';\nimport { checkIsFormula } from '../../workbook/common/util';\n/**\n * CellRenderer class which responsible for building cell content.\n * @hidden\n */\nvar CellRenderer = /** @class */ (function () {\n    function CellRenderer(parent) {\n        this.parent = parent;\n        this.element = this.parent.createElement('td');\n        this.th = this.parent.createElement('th', { className: 'e-header-cell' });\n    }\n    CellRenderer.prototype.renderColHeader = function (index) {\n        var headerCell = this.th.cloneNode();\n        attributes(headerCell, { 'role': 'columnheader', 'columnheader': index.toString(), 'tabindex': '-1' });\n        headerCell.innerHTML = getColumnHeaderText(index + 1);\n        return headerCell;\n    };\n    CellRenderer.prototype.renderRowHeader = function (index) {\n        var headerCell = this.element.cloneNode();\n        attributes(headerCell, { 'role': 'rowheader', 'tabindex': '-1' });\n        addClass([headerCell], 'e-header-cell');\n        headerCell.innerHTML = (index + 1).toString();\n        return headerCell;\n    };\n    CellRenderer.prototype.render = function (args) {\n        var td = this.element.cloneNode();\n        td.className = 'e-cell';\n        td.setAttribute('aria-colindex', args.colIdx.toString());\n        var eventArgs = { cell: args.cell, element: td, address: args.address };\n        this.parent.trigger('beforeCellRender', eventArgs);\n        this.updateCell(args.rowIdx, args.colIdx, td, args.cell, eventArgs, args.lastCell, args.row, args.hRow, args.isHeightCheckNeeded);\n        return eventArgs.element;\n    };\n    CellRenderer.prototype.updateCell = function (rowIdx, colIdx, td, cell, eventArgs, lastCell, row, hRow, isHeightCheckNeeded, isRefresh) {\n        if (!eventArgs) {\n            eventArgs = { cell: cell, element: td };\n        }\n        if (cell && cell.formula && !cell.value) {\n            var isFormula = checkIsFormula(cell.formula);\n            var eventArgs_1 = {\n                action: 'refreshCalculate',\n                value: cell.formula,\n                rowIndex: rowIdx,\n                colIndex: colIdx,\n                isFormula: isFormula\n            };\n            this.parent.notify(workbookFormulaOperation, eventArgs_1);\n        }\n        var formatArgs = {\n            type: cell && getTypeFromFormat(cell.format),\n            value: cell && cell.value, format: cell && cell.format ? cell.format : 'General',\n            formattedText: cell && cell.value, onLoad: true, isRightAlign: false, cell: cell\n        };\n        if (cell) {\n            this.parent.notify(getFormattedCellObject, formatArgs);\n        }\n        td.textContent = eventArgs.cell ? formatArgs.formattedText : '';\n        this.parent.refreshNode(td, {\n            type: formatArgs.type,\n            result: formatArgs.formattedText,\n            curSymbol: getNumberDependable(this.parent.locale, 'USD'),\n            isRightAlign: formatArgs.isRightAlign,\n            value: formatArgs.value || ''\n        });\n        var style = {};\n        if (eventArgs.cell && eventArgs.cell.style) {\n            if (eventArgs.cell.style.properties) {\n                style = skipDefaultValue(eventArgs.cell.style, true);\n            }\n            else {\n                style = eventArgs.cell.style;\n            }\n        }\n        if (Object.keys(style).length || Object.keys(this.parent.commonCellStyle).length || lastCell) {\n            if (isRefresh) {\n                this.parent.notify(setCellFormat, { style: style, range: getCellAddress(rowIdx, colIdx) });\n            }\n            else {\n                this.parent.notify(applyCellFormat, {\n                    style: extend({}, this.parent.commonCellStyle, style), rowIdx: rowIdx, colIdx: colIdx, cell: eventArgs.element,\n                    lastCell: lastCell, row: row, hRow: hRow, isHeightCheckNeeded: isHeightCheckNeeded, manualUpdate: false\n                });\n            }\n        }\n    };\n    /** @hidden */\n    CellRenderer.prototype.refreshRange = function (range) {\n        var sheet = this.parent.getActiveSheet();\n        var cRange = range.slice();\n        if (inView(this.parent, cRange, true)) {\n            for (var i = cRange[0]; i <= cRange[2]; i++) {\n                for (var j = cRange[1]; j <= cRange[3]; j++) {\n                    this.updateCell(i, j, this.parent.getCell(i, j), getCell(i, j, sheet), null, false, null, null, true, true);\n                }\n            }\n        }\n    };\n    return CellRenderer;\n}());\nexport { CellRenderer };\n","import { initialLoad, ribbon, formulaBar, beforeVirtualContentLoaded, getSiblingsHeight, setAriaOptions } from '../common/index';\nimport { SheetRender, RowRenderer, CellRenderer } from './index';\nimport { remove } from '@syncfusion/ej2-base';\nimport { getSheetName, getRowsHeight, getColumnsWidth } from '../../workbook/base/index';\nimport { getCellAddress, getCellIndexes } from '../../workbook/common/index';\nimport { dataRefresh, sheetTabs, onContentScroll, deInitProperties, beforeDataBound } from '../common/index';\nimport { spreadsheetDestroyed } from '../common/index';\n/**\n * Render module is used to render the spreadsheet\n * @hidden\n */\nvar Render = /** @class */ (function () {\n    function Render(parent) {\n        this.parent = parent;\n        this.addEventListener();\n    }\n    Render.prototype.render = function () {\n        if (!this.parent.isMobileView()) {\n            this.parent.notify(ribbon, null);\n            this.parent.notify(formulaBar, null);\n        }\n        var sheetPanel = this.parent.createElement('div', {\n            id: this.parent.element.id + '_sheet_panel', className: 'e-sheet-panel'\n        });\n        if (this.parent.enableRtl) {\n            sheetPanel.classList.add('e-rtl');\n        }\n        this.parent.element.appendChild(sheetPanel);\n        this.parent.notify(sheetTabs, null);\n        if (this.parent.isMobileView()) {\n            this.parent.notify(formulaBar, null);\n            this.parent.notify(ribbon, null);\n        }\n        this.setSheetPanelSize();\n        this.renderSheet(sheetPanel);\n        this.checkTopLeftCell();\n    };\n    Render.prototype.checkTopLeftCell = function () {\n        var sheet = this.parent.getActiveSheet();\n        if (!this.parent.scrollSettings.enableVirtualization || sheet.topLeftCell === 'A1') {\n            this.refreshUI();\n        }\n        else {\n            var indexes = getCellIndexes(sheet.topLeftCell);\n            var top_1 = indexes[0] ? getRowsHeight(sheet, 0, indexes[0] - 1) : 0;\n            var left = indexes[1] ? getColumnsWidth(sheet, 0, indexes[1] - 1) : 0;\n            this.parent.notify(onContentScroll, { scrollLeft: left, scrollTop: top_1, preventScroll: true });\n            var threshold = this.parent.getThreshold('row');\n            var rowIndex = indexes[0] > threshold ? indexes[0] - threshold : 0;\n            threshold = this.parent.getThreshold('col');\n            var colIndex = indexes[1] > threshold ? indexes[1] - threshold : 0;\n            this.refreshUI({ rowIndex: rowIndex, colIndex: colIndex, refresh: 'All', top: top_1, left: left });\n        }\n    };\n    Render.prototype.renderSheet = function (panel) {\n        if (panel === void 0) { panel = document.getElementById(this.parent.element.id + '_sheet_panel'); }\n        panel.appendChild(this.parent.createElement('div', { className: 'e-sheet', id: this.parent.element.id + '_sheet' }));\n        this.parent.serviceLocator.getService('sheet').renderPanel();\n    };\n    Render.prototype.refreshUI = function (args, address) {\n        if (args === void 0) { args = { rowIndex: 0, colIndex: 0, refresh: 'All' }; }\n        var sheetModule = this.parent.serviceLocator.getService('sheet');\n        var sheet = this.parent.getActiveSheet();\n        var sheetName = getSheetName(this.parent);\n        this.parent.showSpinner();\n        if (!address) {\n            address = this.parent.scrollSettings.enableVirtualization ? this.getAddress(args.rowIndex, args.colIndex) :\n                \"A1:\" + getCellAddress(sheet.rowCount - 1, sheet.colCount - 1);\n        }\n        this.parent.trigger(beforeDataBound, {});\n        setAriaOptions(this.parent.getMainContent(), { busy: true });\n        this.parent.getData(sheetName + \"!\" + address).then(function (values) {\n            var lastCellIdx = getCellIndexes(address.split(':')[1])[1];\n            switch (args.refresh) {\n                case 'All':\n                    sheetModule.renderTable(values, args.rowIndex, args.colIndex, lastCellIdx, args.top, args.left);\n                    break;\n                case 'Row':\n                    sheetModule.refreshRowContent(values, args.colIndex, lastCellIdx);\n                    break;\n                case 'Column':\n                    sheetModule.refreshColumnContent(values, args.rowIndex, args.colIndex, lastCellIdx);\n                    break;\n                case 'RowPart':\n                    sheetModule.updateRowContent(values, args.colIndex, lastCellIdx, args.direction);\n                    break;\n                case 'ColumnPart':\n                    sheetModule.updateColContent(values, args.rowIndex, args.colIndex, lastCellIdx, args.direction);\n                    break;\n            }\n        });\n        this.parent.notify(beforeVirtualContentLoaded, { refresh: args.refresh });\n    };\n    Render.prototype.removeSheet = function () {\n        remove(document.getElementById(this.parent.element.id + '_sheet'));\n    };\n    /**\n     * Refresh the active sheet\n     */\n    Render.prototype.refreshSheet = function () {\n        this.removeSheet();\n        this.renderSheet();\n        this.parent.notify(deInitProperties, {});\n        this.checkTopLeftCell();\n    };\n    Render.prototype.getAddress = function (rowIndex, colIndex) {\n        var sheet = this.parent.getActiveSheet();\n        var lastRowIdx = rowIndex + this.parent.viewport.rowCount + (this.parent.getThreshold('row') * 2);\n        var count = sheet.rowCount - 1;\n        if (this.parent.scrollSettings.isFinite && lastRowIdx > count) {\n            lastRowIdx = count;\n        }\n        var lastColIdx = colIndex + this.parent.viewport.colCount + (this.parent.getThreshold('col') * 2);\n        count = sheet.colCount - 1;\n        if (this.parent.scrollSettings.isFinite && lastColIdx > count) {\n            lastColIdx = count;\n        }\n        return getCellAddress(rowIndex, colIndex) + \":\" + getCellAddress(lastRowIdx, lastColIdx);\n    };\n    /**\n     * Used to set sheet panel size.\n     */\n    Render.prototype.setSheetPanelSize = function () {\n        var panel = document.getElementById(this.parent.element.id + '_sheet_panel');\n        var offset = this.parent.element.getBoundingClientRect();\n        var height;\n        if (this.parent.height === 'auto') {\n            panel.style.height = '260px';\n            height = 230;\n        }\n        else {\n            height = offset.height - getSiblingsHeight(panel);\n            panel.style.height = height + \"px\";\n            height -= 30;\n        }\n        this.parent.viewport.height = height;\n        this.parent.viewport.width = offset.width;\n        this.parent.viewport.rowCount = this.roundValue(height, 20);\n        this.parent.viewport.colCount = this.roundValue(offset.width, 64);\n    };\n    Render.prototype.roundValue = function (size, threshold) {\n        var value = size / threshold;\n        var roundedValue = Math.round(value);\n        return Math.abs(value - roundedValue) < 0.5 ? roundedValue : roundedValue - 1;\n    };\n    /**\n     * Registing the renderer related services.\n     */\n    Render.prototype.instantiateRenderer = function () {\n        this.parent.serviceLocator.register('row', new RowRenderer(this.parent));\n        this.parent.serviceLocator.register('cell', new CellRenderer(this.parent));\n        this.parent.serviceLocator.register('sheet', new SheetRender(this.parent));\n    };\n    /**\n     * Destroy the Render module.\n     * @return {void}\n     */\n    Render.prototype.destroy = function () {\n        this.removeEventListener();\n        this.parent = null;\n    };\n    Render.prototype.addEventListener = function () {\n        this.parent.on(initialLoad, this.instantiateRenderer, this);\n        this.parent.on(dataRefresh, this.refreshSheet, this);\n        this.parent.on(spreadsheetDestroyed, this.destroy, this);\n    };\n    Render.prototype.removeEventListener = function () {\n        this.parent.off(initialLoad, this.instantiateRenderer);\n        this.parent.off(dataRefresh, this.refreshSheet);\n        this.parent.off(spreadsheetDestroyed, this.destroy);\n    };\n    return Render;\n}());\nexport { Render };\n","import { isNullOrUndefined } from '@syncfusion/ej2-base';\n/**\n * ServiceLocator\n * @hidden\n */\nvar ServiceLocator = /** @class */ (function () {\n    function ServiceLocator() {\n        this.services = {};\n    }\n    ServiceLocator.prototype.getService = function (name) {\n        if (isNullOrUndefined(this.services[name])) {\n            throw \"The service \" + name + \" is not registered\";\n        }\n        return this.services[name];\n    };\n    ServiceLocator.prototype.register = function (name, type) {\n        if (isNullOrUndefined(this.services[name])) {\n            this.services[name] = type;\n        }\n    };\n    return ServiceLocator;\n}());\nexport { ServiceLocator };\n","import { Dialog as DialogComponent } from '@syncfusion/ej2-popups';\nimport { extend, remove } from '@syncfusion/ej2-base';\nimport { locale } from '../common/index';\n/**\n * Dialog Service.\n * @hidden\n */\nvar Dialog = /** @class */ (function () {\n    /**\n     * Constructor for initializing dialog service.\n     */\n    function Dialog(parent) {\n        this.parent = parent;\n    }\n    /**\n     * To show dialog.\n     */\n    Dialog.prototype.show = function (dialogModel) {\n        var _this = this;\n        var btnContent;\n        var closeHandler = dialogModel.close || null;\n        var model = {\n            header: 'Spreadsheet',\n            cssClass: this.parent.cssClass,\n            target: this.parent.element,\n            buttons: []\n        };\n        dialogModel.close = function () {\n            _this.dialogInstance.destroy();\n            remove(_this.dialogInstance.element);\n            _this.dialogInstance = null;\n            if (closeHandler) {\n                closeHandler();\n            }\n        };\n        extend(model, dialogModel);\n        btnContent = this.parent.serviceLocator.getService(locale).getConstant(model.buttons.length ? 'Cancel' : 'Ok');\n        model.buttons.push({\n            buttonModel: { content: btnContent, isPrimary: model.buttons.length === 0 },\n            click: this.hide.bind(this),\n        });\n        var div = this.parent.createElement('div');\n        document.body.appendChild(div);\n        this.dialogInstance = new DialogComponent(model);\n        this.dialogInstance.createElement = this.parent.createElement;\n        this.dialogInstance.appendTo(div);\n    };\n    /**\n     * To hide dialog.\n     */\n    Dialog.prototype.hide = function () {\n        this.dialogInstance.hide();\n    };\n    /**\n     * To clear private variables.\n     */\n    Dialog.prototype.destroy = function () {\n        this.parent = null;\n    };\n    return Dialog;\n}());\nexport { Dialog };\n","var __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    }\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\n/// <reference path='../../workbook/base/workbook-model.d.ts'/>\nimport { Property, NotifyPropertyChanges, EventHandler, Event } from '@syncfusion/ej2-base';\nimport { addClass, removeClass, Complex, formatUnit, detach, L10n, isNullOrUndefined, Browser } from '@syncfusion/ej2-base';\nimport { initialLoad, mouseDown, spreadsheetDestroyed, keyUp, keyDown, getSiblingsHeight } from '../common/index';\nimport { defaultLocale, locale, setAriaOptions } from '../common/index';\nimport { ribbon, formulaBar, sheetTabs } from '../common/index';\nimport { addContextMenuItems, removeContextMenuItems, enableContextMenuItems, selectRange } from '../common/index';\nimport { cut, copy, paste, dialog, editOperation, activeSheetChanged } from '../common/index';\nimport { Render } from '../renderer/render';\nimport { Scroll, VirtualScroll, Edit, CellFormat, Selection, KeyboardNavigation, KeyboardShortcut, Clipboard } from '../actions/index';\nimport { click } from '../common/index';\nimport { ServiceLocator, Dialog } from '../services/index';\nimport { getCellPosition, getColumnsWidth, getSheetIndex, getSheetNameFromAddress, DataBind } from './../../workbook/index';\nimport { getSheetIndexFromId, WorkbookEdit, WorkbookOpen, WorkbookSave, WorkbookCellFormat } from './../../workbook/index';\nimport { Workbook } from '../../workbook/base/workbook';\nimport { getRequiredModules, setStyleAttribute, ScrollSettings } from '../common/index';\nimport { SelectionSettings, getStartEvent } from '../common/index';\nimport { createSpinner, showSpinner, hideSpinner } from '@syncfusion/ej2-popups';\nimport { setRowHeight, getRowsHeight } from './../../workbook/base/row';\nimport { getRangeIndexes, getIndexesFromAddress, getCellIndexes, WorkbookNumberFormat, WorkbookFormula } from '../../workbook/index';\nimport { Ribbon, FormulaBar, SheetTabs, Open, ContextMenu, Save, NumberFormat, Formula } from '../integrations/index';\nimport { isNumber } from '../../workbook/common/math';\n/**\n * Represents the Spreadsheet component.\n * ```html\n * <div id='spreadsheet'></div>\n * <script>\n *  var spreadsheetObj = new Spreadsheet();\n *  spreadsheetObj.appendTo('#spreadsheet');\n * </script>\n * ```\n */\nvar Spreadsheet = /** @class */ (function (_super) {\n    __extends(Spreadsheet, _super);\n    /**\n     * Constructor for creating the widget.\n     * @param  {SpreadsheetModel} options? - Configures Spreadsheet options.\n     * @param  {string|HTMLElement} element? - Element to render Spreadsheet.\n     */\n    function Spreadsheet(options, element) {\n        var _this = _super.call(this, options) || this;\n        /** @hidden */\n        _this.isOpen = false;\n        /** @hidden */\n        _this.isEdit = false;\n        /** @hidden */\n        _this.viewport = { rowCount: 0, colCount: 0, height: 0, topIndex: 0, leftIndex: 0, width: 0 };\n        _this.needsID = true;\n        Spreadsheet_1.Inject(Ribbon, FormulaBar, SheetTabs, Selection, Edit, KeyboardNavigation, KeyboardShortcut, Clipboard, DataBind, Open, ContextMenu, Save, NumberFormat, CellFormat, Formula, WorkbookEdit, WorkbookOpen, WorkbookSave, WorkbookCellFormat, WorkbookNumberFormat, WorkbookFormula);\n        if (element) {\n            _this.appendTo(element);\n        }\n        return _this;\n    }\n    Spreadsheet_1 = Spreadsheet;\n    /**\n     * To get cell element.\n     * @returns HTMLElement\n     * @hidden\n     */\n    Spreadsheet.prototype.getCell = function (rowIndex, colIndex) {\n        if (this.scrollSettings.enableVirtualization) {\n            colIndex = colIndex - this.viewport.leftIndex;\n        }\n        var row = this.getRow(rowIndex);\n        return row ? row.cells[colIndex] : row;\n    };\n    /**\n     * Get cell element.\n     * @returns HTMLTableRowElement\n     * @hidden\n     */\n    Spreadsheet.prototype.getRow = function (rowIndex, table) {\n        if (this.scrollSettings.enableVirtualization) {\n            rowIndex = rowIndex - this.viewport.topIndex;\n        }\n        table = table || this.getContentTable();\n        return table ? table.rows[rowIndex] : null;\n    };\n    /**\n     * To initialize the services;\n     * @returns void\n     * @hidden\n     */\n    Spreadsheet.prototype.preRender = function () {\n        _super.prototype.preRender.call(this);\n        this.serviceLocator = new ServiceLocator;\n        this.initServices();\n    };\n    Spreadsheet.prototype.initServices = function () {\n        this.serviceLocator.register(locale, new L10n(this.getModuleName(), defaultLocale, this.locale));\n        this.serviceLocator.register(dialog, new Dialog(this));\n    };\n    /**\n     * To Initialize the component rendering.\n     * @returns void\n     * @hidden\n     */\n    Spreadsheet.prototype.render = function () {\n        _super.prototype.render.call(this);\n        this.element.setAttribute('tabindex', '0');\n        this.element.focus();\n        setAriaOptions(this.element, { role: 'grid' });\n        this.renderModule = new Render(this);\n        this.notify(initialLoad, null);\n        this.renderSpreadsheet();\n        this.wireEvents();\n    };\n    Spreadsheet.prototype.renderSpreadsheet = function () {\n        if (this.cssClass) {\n            addClass([this.element], this.cssClass.split(' '));\n        }\n        this.setHeight();\n        this.setWidth();\n        createSpinner({ target: this.element }, this.createElement);\n        if (this.isMobileView() && this.cssClass.indexOf('e-mobile-view') === -1) {\n            this.element.classList.add('e-mobile-view');\n        }\n        this.sheetModule = this.serviceLocator.getService('sheet');\n        if (this.allowScrolling) {\n            this.scrollModule = new Scroll(this);\n        }\n        if (this.scrollSettings.enableVirtualization) {\n            new VirtualScroll(this);\n        }\n        this.renderModule.render();\n    };\n    /**\n     * By default, Spreadsheet shows the spinner for all its actions. To manually show spinner you this method at your needed time.\n     * @return {void}\n     */\n    Spreadsheet.prototype.showSpinner = function () {\n        showSpinner(this.element);\n    };\n    /**\n     * To hide showed spinner manually.\n     * @return {void}\n     */\n    Spreadsheet.prototype.hideSpinner = function () {\n        hideSpinner(this.element);\n    };\n    /**\n     * Selection will navigates to the specified cell address in active sheet.\n     * @param {string} address - Specifies the cell address which needs to navigate.\n     */\n    Spreadsheet.prototype.goTo = function (address) {\n        var indexes = getRangeIndexes(address);\n        var content = this.getMainContent();\n        var sheet = this.getActiveSheet();\n        content.scrollTop = indexes[0] ? getRowsHeight(sheet, 0, indexes[0] - 1) : 0;\n        content.scrollLeft = indexes[1] ? getColumnsWidth(sheet, 0, indexes[1] - 1) : 0;\n    };\n    /**\n     * This method is used to resize the Spreadsheet component.\n     */\n    Spreadsheet.prototype.resize = function () {\n        this.renderModule.setSheetPanelSize();\n        if (this.scrollSettings.enableVirtualization) {\n            this.renderModule.refreshSheet();\n        }\n    };\n    /**\n     * To cut the specified cell or cells properties such as value, format, style etc...\n     * @param {string} address - Specifies the range address to cut.\n     */\n    Spreadsheet.prototype.cut = function (address) {\n        this.notify(cut, address ? {\n            range: getIndexesFromAddress(address),\n            sId: this.sheets[getSheetIndex(this, getSheetNameFromAddress(address))].id\n        } : null);\n    };\n    /**\n     * To copy the specified cell or cells properties such as value, format, style etc...\n     * @param {string} address - Specifies the range address.\n     */\n    Spreadsheet.prototype.copy = function (address) {\n        this.notify(copy, address ? {\n            range: getIndexesFromAddress(address),\n            sId: this.sheets[getSheetIndex(this, getSheetNameFromAddress(address))].id\n        } : null);\n    };\n    /**\n     * This method is used to paste the cut or copied cells in to specified address.\n     * @param {string} address - Specifies the cell or range address.\n     * @param {PasteSpecialType} type - Specifies the type of paste.\n     */\n    Spreadsheet.prototype.paste = function (address, type) {\n        this.notify(paste, {\n            range: getIndexesFromAddress(address), sIdx: getSheetIndex(this, getSheetNameFromAddress(address)),\n            type: type\n        });\n    };\n    Spreadsheet.prototype.setHeight = function () {\n        if (this.height.toString().indexOf('%') > -1) {\n            this.element.style.minHeight = '400px';\n        }\n        this.element.style.height = formatUnit(this.height);\n    };\n    Spreadsheet.prototype.setWidth = function () {\n        if (this.width.toString().indexOf('%') > -1 || this.width === 'auto') {\n            this.element.style.minWidth = '300px';\n        }\n        this.element.style.width = formatUnit(this.width);\n    };\n    /** @hidden */\n    Spreadsheet.prototype.setPanelSize = function () {\n        if (this.height !== 'auto') {\n            var panel = document.getElementById(this.element.id + '_sheet_panel');\n            panel.style.height = this.element.getBoundingClientRect().height - getSiblingsHeight(panel) + \"px\";\n        }\n    };\n    /**\n     * Opens the Excel file.\n     * @param {OpenOptions} options - Options for opening the excel file.\n     */\n    Spreadsheet.prototype.open = function (options) {\n        this.isOpen = true;\n        _super.prototype.open.call(this, options);\n        if (this.isOpen) {\n            this.showSpinner();\n        }\n    };\n    /**\n     * Gets the row header div of the Spreadsheet.\n     * @return {Element}\n     * @hidden\n     */\n    Spreadsheet.prototype.getRowHeaderContent = function () {\n        return this.sheetModule.getRowHeaderPanel();\n    };\n    /**\n     * Gets the column header div of the Spreadsheet.\n     * @return {Element}\n     * @hidden\n     */\n    Spreadsheet.prototype.getColumnHeaderContent = function () {\n        return this.sheetModule.getColHeaderPanel();\n    };\n    /**\n     * Gets the main content div of the Spreadsheet.\n     * @return {Element}\n     * @hidden\n     */\n    Spreadsheet.prototype.getMainContent = function () {\n        return this.sheetModule.getContentPanel();\n    };\n    /**\n     * Get the main content table element of spreadsheet.\n     * @return {HTMLTableElement}\n     * @hidden\n     */\n    Spreadsheet.prototype.getContentTable = function () {\n        return this.sheetModule.getContentTable();\n    };\n    /**\n     * Get the row header table element of spreadsheet.\n     * @return {HTMLTableElement}\n     * @hidden\n     */\n    Spreadsheet.prototype.getRowHeaderTable = function () {\n        return this.sheetModule.getRowHeaderTable();\n    };\n    /**\n     * Get the column header table element of spreadsheet.\n     * @return {HTMLTableElement}\n     * @hidden\n     */\n    Spreadsheet.prototype.getColHeaderTable = function () {\n        return this.sheetModule.getColHeaderTable();\n    };\n    /**\n     * Gets the Cell index in the Spreadsheet.\n     * @return {Element}\n     * @hidden\n     */\n    Spreadsheet.prototype.getCellIndex = function (cell) {\n        return [parseInt(cell.parentElement.getAttribute('aria-rowindex'), 10), parseInt(cell.getAttribute('aria-colindex'), 10)];\n    };\n    /**\n     * To get the backup element count for row and column virtualization.\n     * @hidden\n     */\n    Spreadsheet.prototype.getThreshold = function (layout) {\n        var threshold = Math.round((this.viewport[layout + 'Count'] + 1) / 2);\n        return threshold < 15 ? 15 : threshold;\n    };\n    /** @hidden */\n    Spreadsheet.prototype.isMobileView = function () {\n        return ((this.cssClass.indexOf('e-mobile-view') > -1 || Browser.isDevice) && this.cssClass.indexOf('e-desktop-view') === -1)\n            && false;\n    };\n    /** @hidden */\n    Spreadsheet.prototype.getValueRowCol = function (sheetIndex, rowIndex, colIndex) {\n        var val = _super.prototype.getValueRowCol.call(this, sheetIndex, rowIndex, colIndex);\n        return val;\n    };\n    /** @hidden */\n    Spreadsheet.prototype.setValueRowCol = function (sheetIndex, value, rowIndex, colIndex) {\n        _super.prototype.setValueRowCol.call(this, sheetIndex, value, rowIndex, colIndex);\n        sheetIndex = getSheetIndexFromId(this, sheetIndex);\n        this.notify(editOperation, {\n            action: 'refreshDependentCellValue', rowIdx: rowIndex, colIdx: colIndex,\n            sheetIdx: sheetIndex\n        });\n    };\n    /**\n     * Get component name.\n     * @returns string\n     * @hidden\n     */\n    Spreadsheet.prototype.getModuleName = function () {\n        return 'spreadsheet';\n    };\n    /** @hidden */\n    Spreadsheet.prototype.setRowHeight = function (sheetIndex, rowIndex, height) {\n        var actRowIdx = getCellIndexes(this.getActiveSheet().activeCell)[0];\n        var contentElem = this.element.querySelector('.e-main-content .e-table');\n        var rowHdrElem = this.element.querySelector('.e-row-header .e-table');\n        contentElem.rows[rowIndex].style.height = height + 'px';\n        rowHdrElem.rows[rowIndex].style.height = height + 'px';\n        setRowHeight(this.sheets[sheetIndex - 1], rowIndex, height);\n        if (actRowIdx === rowIndex) {\n            setStyleAttribute([{ element: this.element.getElementsByClassName('e-selection')[0], attrs: { 'height': height + 'px' } }]);\n        }\n        else {\n            var cellPosition = getCellPosition(this.getActiveSheet(), [actRowIdx, 0, actRowIdx, 0]);\n            setStyleAttribute([{\n                    element: this.element.getElementsByClassName('e-selection')[0],\n                    attrs: { 'top': cellPosition.top + 'px' }\n                }]);\n        }\n    };\n    /** @hidden */\n    Spreadsheet.prototype.refreshNode = function (td, args) {\n        var value;\n        var spanElem = td.querySelector('.' + this.element.id + '_currency');\n        var alignClass = 'e-right-align';\n        if (args) {\n            args.result = isNullOrUndefined(args.result) ? '' : args.result.toString();\n            if (args.type === 'Accounting' && isNumber(args.value)) {\n                td.innerHTML = '';\n                td.appendChild(this.createElement('span', {\n                    className: this.element.id + '_currency',\n                    innerHTML: \" \" + args.curSymbol,\n                    styles: 'float: left'\n                }));\n                td.innerHTML += args.result.split(args.curSymbol).join('');\n                td.classList.add(alignClass);\n                return;\n            }\n            else {\n                if (spanElem) {\n                    detach(spanElem);\n                }\n                if (args.result && (args.result.toLowerCase() === 'true' || args.result.toLowerCase() === 'false')) {\n                    args.result = args.result.toUpperCase();\n                    alignClass = 'e-center-align';\n                    args.isRightAlign = true; // Re-use this to center align the cell.\n                }\n                value = args.result;\n            }\n            args.isRightAlign ? td.classList.add(alignClass) : td.classList.remove(alignClass);\n        }\n        value = !isNullOrUndefined(value) ? value : '';\n        if (!isNullOrUndefined(td)) {\n            var node = td.lastChild;\n            if (node && (node.nodeType === 3 || (node.nodeType === 1))) {\n                node.nodeValue = value;\n            }\n            else {\n                td.appendChild(document.createTextNode(value));\n            }\n        }\n    };\n    Spreadsheet.prototype.mouseClickHandler = function (e) {\n        this.notify(click, e);\n    };\n    Spreadsheet.prototype.mouseDownHandler = function (e) {\n        this.notify(mouseDown, e);\n    };\n    Spreadsheet.prototype.keyUpHandler = function (e) {\n        this.notify(keyUp, e);\n    };\n    Spreadsheet.prototype.keyDownHandler = function (e) {\n        this.notify(keyDown, e);\n    };\n    /**\n     * Binding events to the element while component creation.\n     */\n    Spreadsheet.prototype.wireEvents = function () {\n        EventHandler.add(this.element, 'click', this.mouseClickHandler, this);\n        EventHandler.add(this.element, getStartEvent(), this.mouseDownHandler, this);\n        EventHandler.add(this.element, 'keyup', this.keyUpHandler, this);\n        EventHandler.add(this.element, 'keydown', this.keyDownHandler, this);\n        EventHandler.add(this.element, 'noderefresh', this.refreshNode, this);\n    };\n    /**\n     * Destroys the component (detaches/removes all event handlers, attributes, classes, and empties the component element).\n     */\n    Spreadsheet.prototype.destroy = function () {\n        this.unwireEvents();\n        this.notify(spreadsheetDestroyed, null);\n        _super.prototype.destroy.call(this);\n        this.element.innerHTML = '';\n        this.element.removeAttribute('tabindex');\n        this.element.removeAttribute('role');\n        this.element.style.removeProperty('height');\n        this.element.style.removeProperty('width');\n    };\n    /**\n     * Unbinding events from the element while component destroy.\n     */\n    Spreadsheet.prototype.unwireEvents = function () {\n        EventHandler.remove(this.element, 'click', this.mouseClickHandler);\n        EventHandler.remove(this.element, getStartEvent(), this.mouseDownHandler);\n        EventHandler.remove(this.element, 'keyup', this.keyUpHandler);\n        EventHandler.remove(this.element, 'keydown', this.keyDownHandler);\n        EventHandler.remove(this.element, 'noderefresh', this.refreshNode);\n    };\n    /**\n     * To add context menu items.\n     * @param {MenuItemModel[]} items - Items that needs to be added.\n     * @param {string} text - Item before / after that the element to be inserted.\n     * @param {boolean} insertAfter - Set `false` if the `items` need to be inserted before the `text`.\n     * By default, `items` are added after the `text`.\n     * @param {boolean} isUniqueId - Set `true` if the given `text` is a unique id.\n     */\n    Spreadsheet.prototype.addContextMenuItems = function (items, text, insertAfter, isUniqueId) {\n        if (insertAfter === void 0) { insertAfter = true; }\n        this.notify(addContextMenuItems, { items: items, text: text, insertAfter: insertAfter, isUniqueId: isUniqueId });\n    };\n    /**\n     * To remove existing context menu items.\n     * @param {string[]} items - Items that needs to be removed.\n     * @param {boolean} isUniqueId - Set `true` if the given `text` is a unique id.\n     */\n    Spreadsheet.prototype.removeContextMenuItems = function (items, isUniqueId) {\n        this.notify(removeContextMenuItems, { items: items, isUniqueId: isUniqueId });\n    };\n    /**\n     * To enable / disable context menu items.\n     * @param {string[]} items - Items that needs to be enabled / disabled.\n     * @param {boolean} enable - Set `true` / `false` to enable / disable the menu items.\n     * @param {boolean} isUniqueId - Set `true` if the given `text` is a unique id.\n     */\n    Spreadsheet.prototype.enableContextMenuItems = function (items, enable, isUniqueId) {\n        if (enable === void 0) { enable = true; }\n        this.notify(enableContextMenuItems, { items: items, enable: enable, isUniqueId: isUniqueId });\n    };\n    /**\n     * Selects the cell / range of cells with specified address.\n     * @param {string} address - Specifies the range address.\n     */\n    Spreadsheet.prototype.selectRange = function (address) {\n        this.notify(selectRange, getRangeIndexes(address));\n    };\n    /**\n     * Start edit the active cell.\n     * @return {void}\n     */\n    Spreadsheet.prototype.startEdit = function () {\n        this.notify(editOperation, { action: 'startEdit', isNewValueEdit: false });\n    };\n    /**\n     * Cancels the edited state, this will not update any value in the cell.\n     * @return {void}\n     */\n    Spreadsheet.prototype.closeEdit = function () {\n        this.notify(editOperation, { action: 'cancelEdit' });\n    };\n    /**\n     * If Spreadsheet is in editable state, you can save the cell by invoking endEdit.\n     * @return {void}\n     */\n    Spreadsheet.prototype.endEdit = function () {\n        this.notify(editOperation, { action: 'endEdit' });\n    };\n    /**\n     * Called internally if any of the property value changed.\n     * @param  {SpreadsheetModel} newProp\n     * @param  {SpreadsheetModel} oldProp\n     * @returns void\n     * @hidden\n     */\n    Spreadsheet.prototype.onPropertyChanged = function (newProp, oldProp) {\n        _super.prototype.onPropertyChanged.call(this, newProp, oldProp);\n        for (var _i = 0, _a = Object.keys(newProp); _i < _a.length; _i++) {\n            var prop = _a[_i];\n            switch (prop) {\n                case 'enableRtl':\n                    newProp.enableRtl ? document.getElementById(this.element.id + '_sheet_panel').classList.add('e-rtl') :\n                        document.getElementById(this.element.id + '_sheet_panel').classList.remove('e-rtl');\n                    break;\n                case 'cssClass':\n                    if (oldProp.cssClass) {\n                        removeClass([this.element], oldProp.cssClass.split(' '));\n                    }\n                    if (newProp.cssClass) {\n                        addClass([this.element], newProp.cssClass.split(' '));\n                    }\n                    break;\n                case 'activeSheetTab':\n                    this.renderModule.refreshSheet();\n                    this.notify(activeSheetChanged, { idx: newProp.activeSheetTab - 1 });\n                    break;\n                case 'width':\n                    this.setWidth();\n                    this.resize();\n                    break;\n                case 'height':\n                    this.setHeight();\n                    this.resize();\n                    break;\n                case 'showRibbon':\n                    this.notify(ribbon, { uiUpdate: true });\n                    break;\n                case 'showFormulaBar':\n                    this.notify(formulaBar, { uiUpdate: true });\n                    break;\n                case 'showSheetTabs':\n                    this.notify(sheetTabs, null);\n                    break;\n                case 'cellStyle':\n                    this.renderModule.refreshSheet();\n                    break;\n            }\n        }\n    };\n    /**\n     * To provide the array of modules needed for component rendering.\n     * @return {ModuleDeclaration[]}\n     * @hidden\n     */\n    Spreadsheet.prototype.requiredModules = function () {\n        return getRequiredModules(this);\n    };\n    /**\n     * Appends the control within the given HTML Div element.\n     * @param {string | HTMLElement} selector - Target element where control needs to be appended.\n     */\n    Spreadsheet.prototype.appendTo = function (selector) {\n        _super.prototype.appendTo.call(this, selector);\n    };\n    var Spreadsheet_1;\n    __decorate([\n        Property('')\n    ], Spreadsheet.prototype, \"cssClass\", void 0);\n    __decorate([\n        Property(true)\n    ], Spreadsheet.prototype, \"allowScrolling\", void 0);\n    __decorate([\n        Property(true)\n    ], Spreadsheet.prototype, \"enableClipboard\", void 0);\n    __decorate([\n        Property(true)\n    ], Spreadsheet.prototype, \"enableContextMenu\", void 0);\n    __decorate([\n        Property(true)\n    ], Spreadsheet.prototype, \"enableKeyboardNavigation\", void 0);\n    __decorate([\n        Property(true)\n    ], Spreadsheet.prototype, \"enableKeyboardShortcut\", void 0);\n    __decorate([\n        Complex({}, SelectionSettings)\n    ], Spreadsheet.prototype, \"selectionSettings\", void 0);\n    __decorate([\n        Complex({}, ScrollSettings)\n    ], Spreadsheet.prototype, \"scrollSettings\", void 0);\n    __decorate([\n        Event()\n    ], Spreadsheet.prototype, \"beforeCellRender\", void 0);\n    __decorate([\n        Event()\n    ], Spreadsheet.prototype, \"beforeSelect\", void 0);\n    __decorate([\n        Event()\n    ], Spreadsheet.prototype, \"select\", void 0);\n    __decorate([\n        Event()\n    ], Spreadsheet.prototype, \"contextMenuBeforeOpen\", void 0);\n    __decorate([\n        Event()\n    ], Spreadsheet.prototype, \"fileMenuBeforeOpen\", void 0);\n    __decorate([\n        Event()\n    ], Spreadsheet.prototype, \"contextMenuBeforeClose\", void 0);\n    __decorate([\n        Event()\n    ], Spreadsheet.prototype, \"fileMenuBeforeClose\", void 0);\n    __decorate([\n        Event()\n    ], Spreadsheet.prototype, \"contextMenuItemSelect\", void 0);\n    __decorate([\n        Event()\n    ], Spreadsheet.prototype, \"fileItemSelect\", void 0);\n    __decorate([\n        Event()\n    ], Spreadsheet.prototype, \"beforeDataBound\", void 0);\n    __decorate([\n        Event()\n    ], Spreadsheet.prototype, \"dataBound\", void 0);\n    __decorate([\n        Event()\n    ], Spreadsheet.prototype, \"cellEdit\", void 0);\n    __decorate([\n        Event()\n    ], Spreadsheet.prototype, \"cellEditing\", void 0);\n    __decorate([\n        Event()\n    ], Spreadsheet.prototype, \"cellSave\", void 0);\n    __decorate([\n        Event()\n    ], Spreadsheet.prototype, \"created\", void 0);\n    Spreadsheet = Spreadsheet_1 = __decorate([\n        NotifyPropertyChanges\n    ], Spreadsheet);\n    return Spreadsheet;\n}(Workbook));\nexport { Spreadsheet };\n","import * as index from './index';\nindex.Spreadsheet.Inject(index.Clipboard, index.Edit, index.KeyboardNavigation, index.KeyboardShortcut, index.Scroll, index.Selection, index.ContextMenu, index.FormulaBar, index.Ribbon, index.Save, index.Open, index.SheetTabs, index.DataBind, index.AllModule, index.BasicModule, index.CellFormat, index.NumberFormat, index.Formula);\nexport * from './index';\n"],"names":["getRangeIndexes","range","cellindexes","indexes","indexOf","split","forEach","address","getCellIndexes","push","parseInt","match","getColIndex","text","colIdx","i","reverse","join","length","charCodeAt","Math","pow","getCellAddress","sRow","sCol","getColumnHeaderText","getRangeAddress","colIndex","floor","String","fromCharCode","getIndexesFromAddress","getRangeFromAddress","getSwapRange","clonedRange","slice","swap","x","y","tmp","isSingleCell","executeTaskAsync","context","taskFn","callbackFn","data","preventCallback","WorkerHelper","toFraction","val","strVal","toString","top_1","bottom","replace","abs","getGcd","a","b","Number","intToDate","Date","getTime","dateToInt","isTime","startDate","diffDays","isDateTime","date","Object","prototype","call","isNaN","valueOf","isNumber","parseFloat","toDate","intl","defaultDateFormats","getDefaultDateObject","availabelDateTimeFormat","dateTimeFormats","availableFormats","dObj","dateObj","isCustom","type","toUpperCase","_i","_a","keys","dateFormats","key","parseDate","format","skeleton","isNullOrUndefined","_b","_c","_d","_e","timeFormats","getFormatFromType","code","NumberFormatType","General","Currency","Accounting","ShortDate","LongDate","Time","Percentage","Fraction","Scientific","Text","getTypeFromFormat","isUndefined","value","getModules","modules","includeBasicFormulas","member","args","getValue","nameSpace","obj","splits","j","setValue","keyValues","start","fromObj","undefined","getAlphalabel","col","cols","n","aCharNo","chs","getWorkbookRequiredModules","allowSave","allowOpen","allowEditing","allowNumberFormatting","allowCellFormatting","checkIsFormula","getCell","rowIndex","sheet","isInitRow","row","getRow","cells","rows","setCell","cell","isExtend","extend","getCellPosition","top","left","getRowsHeight","getColumnsWidth","skipDefaultValue","style","defaultKey","defaultProps","fontFamily","verticalAlign","textIndent","backgroundColor","color","textAlign","fontSize","fontWeight","fontStyle","textDecoration","changedProps","propName","getRowHeight","height","setRowHeight","startRow","endRow","getColumn","columns","getColumnWidth","index","width","startCol","endCol","getData","Promise","resolve","reject","Map","getSheet","getSheetIndex","getSheetNameFromAddress","promise","notify","then","set","getModel","model","idx","diff","prevIdx","splice","processIdx","isSheet","cnt","len","createSheet","id","getMaxSheetId","sheets","name","getSheetNameCount","setProperties","clearRange","sheetIdx","valueOnly","sCIdx","eCIdx","sRIdx","eRIdx","formula","getSheetIndexFromId","updateSelectedRange","selectedRange","getSelectedRange","toLowerCase","sheetNameCount","max","initSheet","initRow","getSheetName","activeSheetTab","getRequiredModules","pushBasicModules","showRibbon","showFormulaBar","showSheetTabs","enableContextMenu","selectionSettings","mode","enableKeyboardNavigation","enableKeyboardShortcut","enableClipboard","getUpdateUsingRaf","fn","requestAnimationFrame","removeAllChildren","parent","firstChild","removeChild","getColGroupWidth","getScrollBarWidth","scrollAreaWidth","htmlDivNode","document","createElement","result","cssText","body","appendChild","offsetWidth","clientWidth","getSiblingsHeight","element","classList","classes","getHeightFromDirection","direction","sibling","some","contains","offsetHeight","inView","isModify","scrollSettings","enableVirtualization","topIdx","viewport","topIndex","leftIdx","leftIndex","bottomIdx","rowCount","getThreshold","rightIdx","colCount","inView_1","locateElem","ele","swapRange","cellPosition","setStyleAttribute","attrs","styles","setBaseStyleAttribute","getStartEvent","Browser","isPointer","getMoveEvent","getEndEvent","isTouchStart","e","pointerType","isTouchMove","isTouchEnd","getClientX","changedTouches","clientX","getClientY","clientY","setAriaOptions","target","options","setAttribute","config","destroyComponent","component","compObj","getComponent","destroy","task","defaultListener","taskData","this","workerTask","workerData","initWorker","terminate","worker","URL","revokeObjectURL","workerUrl","taskBlob","Blob","getFnCode","createObjectURL","Worker","onmessage","messageFromWorker","bind","onerror","onError","postMessage","apply","message","workerCode","getMessageFn","getCallbackMessageFn","WorkbookNumberFormat","localeObj","getNumericObject","locale","decimalSep","decimal","groupSep","group","addEventListener","numberFormatting","getFormattedCell","sheetIndex","fResult","getActiveSheet","activeCell","rightAlign","currencySymbol","getNumberDependable","eventArgs","requestType","trigger","dateEventArgs","updatedVal","isDate","checkDateFormat","processFormats","onLoad","isRightAlign","curSymbol","usedRange","setUsedRange","formattedText","Internationalization","autoDetectGeneralFormat","curCode","applyNumberFormat","currencyFormat","percentageFormat","accountingFormat","shortDateFormat","longDateFormat","timeFormat","fractionFormat","scientificFormat","res","trim","findSuffix","zeros","resultSuffix","suffixLen","substr","formatArr","formatNumber","currency","shortDate","formatDate","longDate","time","prefix","findDecimalPlaces","toExponential","fractionResult","suffix","eIndex","decIndex","substring","formattedBarText","beforeText","on","removeEventListener","isDestroyed","off","getModuleName","DataBind","updateSheetFromDataSourceHandler","dataSourceChangedHandler","flds","sCellIdx","remoteUrl","dataManager","rowIdx","sRowIdx","sColIdx","loadedInfo","_this","requestedRange","sRanges","deferred","Deferred","rangeSettings","this_1","k","sRange","eRange","startCell","dataSource","DataManager","url","isLocalData","showFieldAsHeader","isEndReached","initRangeInfo","count","getMaxCount","getLoadedInfo","unloadedRange","isNotLoaded","query","Query","clone","executeQuery","requiresCount","info","fldLen","field","item","getCellDataFromProp","checkDataForFormat","loadedRange","prop","queries","min","nos","oldSheet","oldProp","oldRange","rangeIdx","indexes_1","WorkbookOpen","open","formData","FormData","file","isOpen","append","cancel","requestData","method","fetch","openUrl","response","ok","json","status","statusText","fetchSuccess","catch","error","fetchFailure","openError","workbookData","impData","JSON","parse","Workbook","updateModel","workbookModel","action","definedNames","SaveWorker","processSheet","Array","isArray","processSave","saveJSON","saveSettings","customParams","stringify","blob","__extends","extendStatics","d","setPrototypeOf","__proto__","p","hasOwnProperty","__","constructor","create","WorkbookSave","_super","isProcessCompleted","isFullPost","needBlobData","initiateSave","saveType","fileName","updateBasicSettings","processSheets","jsonStr","getStringifyObject","basicSettings","sheetCount","updateSheet","getSheetLength","save","initiateFullPostSave","updateSaveResult","blobData","ClientFileDownload","anchor","download","getFileNameWithExtension","href","click","formElem","inputElem","submit","detach","skipProp","properties","filename","fileExt","getFileExtension","lastIndexOf","CalculateCommon","ModuleLoader","loadedModules","inject","requiredModules","moduleList","reqLengthVal","clean","clearUnusedModule","modl","moduleList_1","module","modName","isModuleLoaded","moduleObject","createInstance","memberName","getMemberName","isProperty","loadedModule","classFunction","params","arrayParam","unshift","Function","moduleListName","usedModule","map","arg","removeModule_1","filter","moduleName","deleteObject","CommonErrors","FormulasErrorsStrings","BasicFormulas","formulas","formulaName","category","description","isConcat","init","addFormulaCollection","functionName","formulaCategory","libraryFormulas","fName","handler","ComputeSUM","arguments","formulaErrorStrings","invalid_arguments","orgValue","sum","argArr","argValue","isCellReference","cellCollection","getCellCollection","tic","getValueFromArg","getErrorStrings","trueValue","falseValue","ComputeCOUNT","wrong_number_arguments","argVal","cellColl","cellValue","ComputeDATE","year","month","day","days","num","getSerialDateFromDate","fromOADate","getFullYear","calculateDate","getMonth","getDate","ComputeFLOOR","fnum","significance","argCount","splitArg","divzero","ComputeCEILING","cnum","ceil","ComputeDAY","serialNumber","dateVal","ComputeIF","condition","requires_3_args","ComputeIFERROR","arithMarker","ComputePRODUCT","product","countNum","rangevalue","ComputeDAYS","argsArr","endDate","toDateString","d1","d2","round","ComputeCHOOSE","cond","indexNum","ComputeSUMIF","improper_formula","computeSumIfAndAvgIf","ComputeABS","absValue","absVal","cellvalue","ComputeAVERAGE","calculateAvg","ComputeAVERAGEIF","argList","resultVal","ComputeCONCATENATE","argsList","tempStr","i_1","ComputeCONCAT","ComputeMAX","computeMinMax","ComputeMIN","ComputeRAND","random","ComputeAND","computeAndOr","ComputeOR","ComputeFIND","findText","removeTics","withinText","loc","startNum","ComputeINDEX","ref","rangeValue","rangeArr","i_2","cellRef","convertAlpha","ComputeIFS","na","ComputeCOUNTA","ComputeAVERAGEA","cellCol","cellVal","argArrs","ComputeCOUNTIF","stack","op","startsWith","findWildCardValue","processLogical","ComputeSUMIFS","computeIfsFormulas","ComputeCOUNTIFS","ComputeAVERAGEIFS","ComputeMATCH","lookupVal","matchType","indexVal","ComputeLOOKUP","computeLookup","ComputeVLOOKUP","computeVLookup","ComputeSUBTOTAL","ComputeRADIANS","radVal","PI","Parser","emptyStr","storedStringText","sheetToken","tokenAdd","tokenSubtract","tokenMultiply","tokenDivide","tokenLess","charEm","charEp","tokenGreater","tokenEqual","tokenLessEq","tokenGreaterEq","tokenNotEqual","tokenAnd","tokenEm","tokenEp","tokenOr","charAnd","charLess","charGreater","charEqual","charLessEq","charGreaterEq","charNoEqual","stringGreaterEq","stringLessEq","stringNoEqual","stringAnd","stringOr","charOr","charAdd","charSubtract","charMultiply","charDivide","fixedReference","spaceString","ignoreBracet","isError","isFormulaParsed","findNamedRange","stringsColl","tokens","charNOTop","specialSym","isFailureTriggered","fkey","isTextEmpty","getFormulaCharacter","namedRanges","size","storedData","checkForNamedRangeAndKeyValue","formulaString","storeStrings","indexOfAny","family","getSheetFamilyItem","grid","sheetNameToParentObject","setTokensForSheets","getSheetToken","scopedRange","checkScopedRange","markLibraryFormulas","formulaAutoCorrection","ex","exception","isForceCalculable","formulaCorrection","computeForceCalculate","invalid_expression","get","formulaText","FormulaError","mismatched_parentheses","empty_expression","s","parseSimple","exceptionArgs","errorMessage","getErrorLine","setStrings","arithemeticArr","logicalSym","form","firstOp","secondprevOp","secondnextOp","firstDigit","secondDigit","countDigit","isDigit","rightBracket","has","leftBracket","isUpperChar","getParseArgumentSeparator","getSheetID","v","token","sheetNameToToken","tempString","storedString","ticLoc","singleTicLoc","singleTic","mismatched_tics","expTokenArray","mulTokenArray","addTokenArray","mulCharArray","addCharArray","compareTokenArray","compareCharArray","expCharArray","andTokenArray","andCharArray","orCharArray","orTokenArray","parseSimpleOperators","markers","operators","c","right","rightIndex","findLeftMarker","cannot_parse","bracketCount","l","period","getParseDecimalSeparator","number_contains_2_decimal_points","updateDependentCell","expression_cannot_end_with_an_operator","uFound","findRightMarker","jTemp","inbracket","arithMarker2","isCharacter","checkLetter","oneTokenFound","textLen","isChar","ret","bracketLevel","parseFormula","fKey","bracCount","rightParens","markNamedRanges","parenCount","leftParens","libFormula","getFunction","swapInnerParens","addParensToArgs","fSubstr","rightSides","marker","lastIndexOfAny","oneTimeOnly","end","getTableRange","namerangeValue","findNextEndIndex","found","__decorate","decorators","desc","r","getOwnPropertyDescriptor","Reflect","decorate","defineProperty","Calculate","lFormulas","keyToRowsMap","rowsToKeyMap","emptyString","leftBrace","rightBrace","cellPrefix","treatEmptyStringAsZero","parseDecimalSeparator","dependentCells","dependentFormulaCells","minValue","MIN_SAFE_INTEGER","maxValue","MAX_SAFE_INTEGER","categoryCollection","errorStrings","parseArgumentSeparator","dateTime1900","isParseDecimalSeparatorChanged","isArgumentSeparatorChanged","sheetFamilyID","defaultFamilyItem","sheetFamiliesList","modelToSheetID","tokenCount","sortedSheetNames","tempSheetPlaceHolder","formulaInfoTable","oaDate","millisecondsOfaDay","parseDateTimeSeparator","moduleLoader","Calculate_1","Inject","injectedModules","parentObject","parser","formulaColl","enumerable","configurable","setParseArgumentSeparator","getParseDateTimeSeparator","setTreatEmptyStringAsZero","getTreatEmptyStringAsZero","setParseDateTimeSeparator","getInjectedModules","onPropertyChanged","newProp","charCode","resetKeys","clear","parentObjectToToken","getDependentCells","formulaCells","isSheetMember","sheetDependentCells","getDependentFormulaCells","sheetDependentFormulaCells","getLibraryFormulas","getFormulaInfoTable","sheetFormulaInfotable","getFormula","getFormulaText","setParseDecimalSeparator","temp","bad_index","grd","isLetter","startIndex","CalcSheetFamilyItem","setKeyValue","str","FormulaInfo","fInfo","s1","clearFormulaDependentCells","setFormulaText","getFormulaValue","setParsedFormula","setFormulaValue","dependentFormula","dependent","arrayRemove","delete","array","getKeyValue","fText","computeFormula","getParsedFormula","addNamedRange","sheetScopeName","removeNamedRange","arrCol","aCharValue","cellRange","row1","row2","col1","col2","parsedText","lastIndexOfq","formulatResult","fNested","nestedFormula","findLastIndexOfq","sFormula","processNestedFormula","q","computeValue","criteria","opt","checkCriteria","criteriaRangeArray","sumRange","criteriaRange","getComputeSumIfValue","checkCrte","findMaxVal","criterias","lookupRangeArray","lookupRange","maxVal","sort","minVal","findMaxValue","lookupValue","firstCol","secCol","lookupCol","lookupCell","lookVal","finalText","checStr1","checStr2","newIndex","compRight","compLeft","leftVal","rightVal","value1","val1","parseVal","ranges","tempdate","pFormula","textName","getParentObjectCellValue","stackValue","pop","errIndex","getValArithmetic","countValue","operator","num1","num2","val2","value2","localeCompare","computeStoreCells","sCell","cellRanges","argArray","isCriteria","storeCell","storedCells","isCountIfs","isCountIfS","countVal","rangeLength","tempStoredCell","newCell","newCount","cellAlpha","newCellAlpha","isAvgIfs","storedCell","startRange","pText","doubleNumber","setTime","isValidMonth","tempDay","dateTime","toOADate","fString","pObjCVal","symbolArray","f","circular_reference","dateval","isValidCellReference","numArr","cellTxt","sheetToken1","containsBoth","isAlpha","isNum","charArray","sortedSheetNamesCollection","getSortedSheetNames","tokenToParentObject","saveCell","cValue","getParentCellValue","getValueRowCol","defineFunction","window","valueChanged","changeArgs","isCalculate","pgrid","isComputedValueChanged","isCompute","calcFamily","getRowIndex","setValueRowCol","formulaValue","arr_1","errorStack","createSheetFamilyID","operation","countStrVal","sumCell","avgVal","registerGridAsSheet","refName","tempRef","unregisterGridAsSheet","refName1","dispose","refresh","dCell","formulaInfo","Property","Event","NotifyPropertyChanges","Base","calcID","MIN_VALUE","calcID1","parsedFormula","ValueChangedArgs","setRowIndex","setColIndex","WorkbookFormula","workbook","initCalculate","registerSheet","initiateDefinedNames","calculateInstance","performFormulaOperation","from","values","formulaCollection","collection","selectCategory","selectedList","unRegisterSheet","autoCorrectFormula","refreshCalculate","isFormula","argumentSeparator","isAdded","addDefinedName","definedName","isRemoved","removeDefinedName","scope","sheetName","cellArgs","definedname","refersTo","comment","checkIsNameExist","getIndexFromNameColl","calcName","WorkbookCellFormat","lastCell","isHeightCheckNeeded","manualUpdate","onActionUpdate","refreshRibbon","textDecorationActionUpdate","changedStyle","changedValue","activeCellIndexes","getCellStyleValue","removeProp","WorkbookEdit","performEditOperation","updateCellValue","isValueOnly","WorkbookBasicModule","WorkbookAllModule","CellStyle","ChildProperty","DefineName","Cell","Complex","Row","Collection","Column","RangeSetting","UsedRange","Sheet","__assign","assign","t","commonCellStyle","cellStyle","dataBind","initEmptySheet","preRender","render","getPersistData","addOnPersist","cellFormat","cssProps","cssProp","numberFormat","removeSheet","merge","appendTo","selector","update","getRangeData","cellIndexes","saveOptions","saveUrl","Component","editOperation","keyUp","keyDown","cMenuBeforeOpen","cut","paste","role","selected","multiselectable","busy","colcount","Clipboard","className","contenteditable","getClipboardEle","copy","clearCopiedInfo","tabSwitchHandler","cMenuBeforeOpenHandler","ribbonClickHandler","initCopyIndicator","rowHeightChanged","EventHandler","add","remove","parentId","isClick","focus","copiedInfo","hidePaste","enableContextMenuItems","getElementsByClassName","threshold","setCopiedInfo","isEdit","preventDefault","getElementById","isExternal","clipboardData","copiedIdx","getCopiedIdx","cSIdx","sIdx","curSheet","prevSheet","selIdx","getExternalCells","cIdx","isRepeative","rfshRange","concat","isFinite","showDialog","isCut","serviceLocator","getService","refreshRange","select","rIdx","getEmptyStyle","hRow","sId","option","showSpinner","isIE","execCommand","hideSpinner","setExternalCells","getMainContent","copyIndicator","dialog","show","header","isModal","showCloseIcon","content","getConstant","isShow","isEnable","regex","setData","html","innerHTML","querySelector","querySelectorAll","tr","td","textContent","getStyle","children","child","getAttribute","setTimeout","char","charAt","Edit","editorElem","editCellData","isCellEdit","isNewValueEdit","keyCodes","BACKSPACE","SPACE","TAB","DELETE","ESC","ENTER","FIRSTALPHABET","LASTALPHABET","FIRSTNUMBER","LASTNUMBER","FIRSTNUMPAD","LASTNUMPAD","SYMBOLSETONESTART","SYMBOLSETONEEND","SYMBOLSETTWOSTART","SYMBOLSETTWOEND","FIREFOXEQUALPLUS","FIREFOXMINUS","F2","dblClickHandler","mouseDownHandler","keyUpHandler","keyDownHandler","renderEditor","refreshEditor","refreshFormulaBar","refreshEditorElem","isAppend","trigEvent","refreshCurPos","setCursorPosition","startEdit","endEdit","cancelEdit","editedValue","refreshDependentCellValue","position","getBoundingClientRect","trgtElem","keyCode","isWindows","hasFormulaSuggSelected","closest","isAlphabet","isNumeric","isNumpadKeys","isSymbolkeys","isFirefoxExceptionkeys","isF2Edit","shiftKey","ctrlKey","isBackSpace","altKey","editingHandler","editor","contentEditable","spellcheck","triggerEvent","updateEditCellDetail","initiateEditor","positionEditor","enable","elem","selection","getSelection","createRange","setStart","collapse","removeAllRanges","addRange","suggDdlElem","visibility","addr","cellElem","fullAddr","oldValue","tdElem","minHeight","inlineStyles","updateEditedValue","tdRefresh","cellIndex","getRefreshNodeArgs","refreshNode","fCode","resetEditState","focusElement","eventName","altEnter","textBefore","textAfter","offset","node","anchorNode","nodeType","anchorOffset","setEnd","elemRefresh","removeAttribute","Selection","mouseMoveEvt","mouseMoveHandler","virtualContentLoadedHandler","cellNavigateHandler","selectRange","getActiveCell","getSelectionElement","selectRangeByIdx","actRange","inRange","createSelectionElement","cont","getSheetElement","getRowIdxFromClientY","getColIdxFromClientX","activeIdx","isRowSelected","showHeaders","getRowHeaderContent","isColSelected","getColumnHeaderContent","which","isSelected","passive","mouseUpHandler","touchEvt","isMobileView","renderModule","setSheetPanelSize","getScrollContent","clientRect","isScrollDown","isScrollUp","isScrollRight","isScrollLeft","clearInterval","scrollInterval","setInterval","scrollTop","scrollLeft","highlightHdr","isScrollRefresh","isActCellChanged","UpdateRowColSelected","updateActiveCell","topLeftIdx","topLeftCell","isRowRefresh","isColRefresh","rowHdr","colHdr","getHdrIndexes","selectAll","removeClass","addClass","parentElement","previousElementSibling","Scroll","initProps","onContentScroll","scrollArgs","prevSize","enableRtl","initScrollValue","prevScroll","scrollRight","getColOffset","cur","prev","increase","preventScroll","updateTopLeftCell","updateNonVirtualCols","scrollDown","getRowOffset","updateNonVirtualRows","refreshUI","Infinity","wireEvents","onScroll","setPadding","allowScrolling","colHeader","rowHeader","scrollWidth","padding","border","marginBottom","VirtualScroll","scroll","createVirtualElement","container","colVTrack","rowVTrack","vTrack","initScroll","domCount","setScrollCount","startColIdx","translateX","translateY","cloneNode","transform","layout","activeSheetIdx","getAddress","getColAddress","updateScrollCount","usedRangeCount","onVerticalScroll","idxDiff","getThresholdHeight","lastIdx","checkLastIdx","onHorizontalScroll","getThresholdWidth","translate","updateColumnWidth","updateUsedRange","getVTrackHeight","updateVTrack","createHeaderElement","nextElementSibling","updateVTrackHeight","sizeStr","deInitProps","updateScrollProps","sliceScrollProps","KeyboardNavigation","activeElement","isNavigate","actIdxes","scrollNavigation","stopPropagation","isScroll","topLeftIdxes","getBottomIdx","getRightIdx","hgt","contWidth","KeyboardShortcut","CellFormat","checkHeight","applyCellFormat","childElementCount","updateRowHeight","clonedCell","prevHeight","getRowHeightOnInit","getRowHeaderTable","isLastCell","lastElementChild","test","table","RibbonItem","Header","Item","MenuItem","Ribbon","renderRibbon","Menu","expandCollapseElem","tabObj","ribbonExpandCollapse","toolbarObj","getTabItems","tabItems","items","initMenu","menuItems","menu","menuObj","cssClass","showItemOnClick","beforeOpen","parentItem","beforeClose","event","tabElement","tBarElement","Toolbar","clicked","Tab","selectedItem","animation","next","duration","previous","selecting","selectingIndex","expanded","created","collapseBtn","refreshOverflow","activeTab","enableItems","disable","ColorPicker","input","fontColorPicker","ColorPickerComponent","showButtons","presetColors","fontColor","enableOpacity","beforeCloseHandler","openHandler","beforeModeSwitch","change","currentValue","rgba","updateSelectedColor","wireFocusEvent","filColorPicker","fillColor","borderBottomColor","title","inst","modeSwitcher","l10n","destroyColorPicker","firstElementChild","fontNameIndex","numPopupWidth","initRibbon","ribbon","createMobileView","createRibbon","getRibbonItems","iconCss","prefixIcon","tooltipText","template","getPasteBtn","getLocaleText","btn","pasteSplitBtn","SplitButton","close","setClass","ribbonElement","RibbonComponent","fileItemSelect","fileMenuBeforeOpen","fileMenuBeforeClose","toolbarClicked","ribbonCreated","tabSelecting","expandCollapse","expandCollapseHandler","uiUpdate","refEle","insertBefore","refreshRibbonContent","numFormatBtn","numFormatDDB","DropDownButton","getNumFormatDdbItems","numDDBSelect","numDDBOpen","beforeItemRender","previewNumFormat","tBarDdbBeforeOpen","enableRibbonItems","fontSizeDdb","refreshSelected","fontNameBtn","fontNameDdb","getFontFamilyItems","refreshFontNameSelection","textAlignDdb","alignItemRender","verticalAlignDdb","btnObj","Button","isToggle","toggleBtnClicked","defaultModel","activeModel","property","itemKey","setPanelSize","enableToolbar","refreshNumFormatSelection","viewportHeight","getComputedStyle","paddingTop","overflowY","elemList","popWidth","numElem","previewElem","refreshFirstTabContent","refreshThirdTabContent","actCell","value_1","value_2","value_3","fontProps","selectArgs","dialogInst_1","buttons","buttonModel","isPrimary","hide","refreshSheet","showHideHeaders","updateToggleText","showGridLines","itemPos","updateShowHideBtn","showHideText","toobar","align","renderMobileToolbar","toolbarPanel","toolbar","ddb","display","ddbObj","calculatePosition","wrapper","contents","li","parentElem","ribbonEle","FormulaBar","createFormulaBar","insertFnRipple","fBarWrapper","nameBox","comboBoxInstance","ComboBox","noRecordsTemplate","fields","nameBoxBeforeOpen","blur","nameBoxBlur","nameBoxSelect","rippleEffect","textarea","placeholder","textAreaFocusIn","textAreaFocusOut","formulaPanel","tickBtn","eventArg","UpdateValueAfterMouseUp","isInteracted","itemData","formulaBarUpdateHandler","indexes1","indexes2","intDate","updateComboBoxValue","clickHandler","toggleFormulaBar","names","offsetParent","isFormulaEdit","formulaDescription","categoryContent","dropDownElement","listViewElement","descriptionContent","headerContent","categoryArgs","categoryList","DropDownList","popupHeight","dropDownSelect","listArgs","formulaList","ListView","actionComplete","updateFormulaList","listSelected","outerHTML","dialogOpen","dialogBeforeClose","dialogClose","selectFormula","formulaClickHandler","focusOkButton","dialogContentEle","parentNode","dialogInstance","storeActiveElement","formulaBarObj","getSelectedItems","updateFormulaDescription","activeListFormula","firstElement","selectItem","selectedFormula","descriptionArgs","innerText","editOperationHandler","getFormulaBar","Formula","isFormulaBar","isPopupOpened","isPreventClose","isSubFormula","UP","DOWN","LEFT","RIGHT","autocompleteInstance","renderAutoComplete","getNames","getNameFromRange","acElem","autoCompleteOptions","popupWidth","allowFiltering","filterType","sortOrder","onSuggestionOpen","onSuggestionClose","onSelect","onSuggestionComplete","AutoComplete","getPopupPosition","popup","offsetX","offsetY","refreshPosition","maxHeight","triggerKeyDownEvent","updatedFormulaValue","editValue","getEditingValue","parseIndex","getArgumentSeparator","hidePopUp","getSuggestionKeyFromFormula","refreshFormulaSuggestion","autoCompleteElem","isSuggestionAlreadyOpened","isNavigationKey","dispatchEvent","suggPopupElem","hidePopup","suggestValue","bracketIndex","fSplit","isAlphaNumeric","singleRange","SheetTabs","createSheetTabs","tabInstance","panel","addBtn","addSheetTab","addBtnRipple","getSheetTabItems","dropDownInstance","ddbItems","updateSheetTab","beforeOpenHandler","sheetTab","overflowMode","selectedIndex","previousIndex","updateDropDownItems","tBarItems","renameSheetTab","spaceKeyDown","curIdx","isCollide","refreshSheetTab","addTab","switchSheetTab","required","maxlength","renameInputFocusOut","updateWidth","setSelectionRange","spaceLen","removeRenameInput","RegExp","showRenameDialog","textEle","sheetItems","focusRenameInput","removeSheetTab","destroySheet","removeTab","Open","renderFileUpload","openSuccess","openFailed","uploadID","accept","uploadBox","onchange","fileSelect","filesData","files","impArgs","Save","saveCompleted","ContextMenu","initContextMenu","ul","contextMenuInstance","ContextMenuComponent","selectHandler","getTarget","getDataSource","setClipboardData","addItemsHandler","removeItemsHandler","enableItemsHandler","insertAfter","isUniqueId","removeItems","NumberFormat","refreshCellElement","BasicModule","Spreadsheet","AllModule","ScrollSettings","SelectionSettings","Custom","defaultLocale","Cut","Copy","Paste","All","Values","Formats","Bold","Font","FontSize","Italic","Underline","Strikethrough","TextColor","FillColor","HorizontalAlignment","AlignLeft","AlignCenter","AlignRight","VerticalAlignment","AlignTop","AlignMiddle","AlignBottom","InsertFunction","NameBox","ShowHeaders","HideHeaders","ShowGridLines","HideGridLines","AddSheet","ListAllSheets","FullScreen","CollapseToolbar","ExpandToolbar","CollapseFormulaBar","ExpandFormulaBar","File","Home","Formulas","View","New","SaveAs","ExcelXlsx","ExcelXls","CSV","Ok","Close","Cancel","Apply","MoreColors","StandardColors","MobileFormulaBarPlaceHolder","PasteAlert","DestroyAlert","SheetRenameInvalidAlert","SheetRenameEmptyAlert","SheetRenameAlreadyExistsAlert","DeleteSheetAlert","DeleteSingleLastSheetAlert","PickACategory","Description","UnsupportedFile","InvalidUrl","SUM","SUMIFS","ABS","RAND","FLOOR","CEILING","SUMIF","PRODUCT","AVERAGE","AVERAGEIF","COUNT","COUNTA","COUNTIF","COUNTIFS","AVERAGEA","AVERAGEIFS","MIN","MAX","DATE","DAY","DAYS","IF","AND","IFS","IFERROR","CHOOSE","INDEX","FIND","CONCATENATE","CONCAT","SUBTOTAL","RADIANS","OR","MATCH","DefineNameExists","SheetRender","freezePane","colGroupWidth","rowRenderer","cellRenderer","refreshSelectALLContent","tHead","getSelectAllTable","headerPanel","updateLeftColGroup","detachColGroup","colGrp","colGrpWidth","getSelectAllContent","getColHeaderPanel","getContentPanel","renderPanel","contentPanel","initHeaderPanel","scrollModule","updateHideHeaders","overflow","createTable","createHeaderTable","updateTable","rowHdrEle","tagName","renderTable","frag","createDocumentFragment","rHdrTBody","cHdrTHead","cHdrRow","cTBody","getColHeaderTable","updateCol","renderColHeader","renderRowHeader","getContentTable","refreshColumnContent","hFrag","tBody","refreshRowContent","hTBody","formatUnit","updateColContent","refChild","hRefChild","colRefChild","updateRowContent","rTBody","rFrag","cKey","renderHeaders","goTo","getRowHeaderPanel","rowIndexes","colIndexes","cFrag","cTHead","cRow","RowRenderer","isHeader","attributes","aria-rowindex","CellRenderer","th","headerCell","columnheader","tabindex","updateCell","isRefresh","eventArgs_1","formatArgs","cRange","Render","sheetPanel","renderSheet","checkTopLeftCell","sheetModule","lastCellIdx","lastRowIdx","lastColIdx","roundValue","roundedValue","instantiateRenderer","register","ServiceLocator","services","Dialog","dialogModel","btnContent","closeHandler","div","DialogComponent","needsID","Spreadsheet_1","initServices","L10n","renderSpreadsheet","setHeight","setWidth","createSpinner","resize","minWidth","getCellIndex","isDevice","actRowIdx","contentElem","rowHdrElem","spanElem","alignClass","lastChild","createTextNode","nodeValue","mouseClickHandler","unwireEvents","removeProperty","addContextMenuItems","removeContextMenuItems","closeEdit","index.Spreadsheet","index.Clipboard","index.Edit","index.KeyboardNavigation","index.KeyboardShortcut","index.Scroll","index.Selection","index.ContextMenu","index.FormulaBar","index.Ribbon","index.Save","index.Open","index.SheetTabs","index.DataBind","index.AllModule","index.BasicModule","index.CellFormat","index.NumberFormat","index.Formula"],"mappings":"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"}