{"version":3,"file":"ej2-spreadsheet.umd.min.js","sources":["../src/workbook/common/address.js","../src/workbook/common/worker.js","../src/workbook/common/math.js","../src/workbook/integrations/number-format.js","../src/calculate/common/common.js","../src/calculate/common/module.js","../src/calculate/common/module-loader.js","../src/calculate/base/calculate.js","../src/workbook/common/module.js","../src/workbook/common/util.js","../src/workbook/base/cell.js","../src/workbook/base/data.js","../src/workbook/base/sheet.js","../src/workbook/base/row.js","../src/workbook/base/column.js","../src/spreadsheet/common/module.js","../src/spreadsheet/common/util.js","../src/workbook/common/event.js","../src/workbook/integrations/data-bind.js","../src/spreadsheet/common/event.js","../src/workbook/integrations/open.js","../src/workbook/workers/save-worker.js","../src/workbook/integrations/save.js","../src/calculate/common/enum.js","../src/calculate/formulas/basic.js","../src/calculate/base/parser.js","../src/workbook/integrations/formula.js","../src/workbook/integrations/sort.js","../src/workbook/integrations/filter.js","../src/workbook/integrations/image.js","../src/workbook/integrations/chart.js","../src/workbook/actions/cell-format.js","../src/workbook/actions/edit.js","../src/workbook/actions/hyperlink.js","../src/workbook/actions/insert.js","../src/workbook/actions/delete.js","../src/workbook/actions/data-validation.js","../src/workbook/actions/find-and-replace.js","../src/workbook/actions/protect-sheet.js","../src/workbook/actions/merge.js","../src/workbook/actions/conditional-formatting.js","../src/workbook/common/basic-module.js","../src/workbook/common/all-module.js","../src/workbook/common/class.js","../src/workbook/common/constant.js","../src/workbook/services/service-locator.js","../src/workbook/base/workbook.js","../src/spreadsheet/actions/clipboard.js","../src/spreadsheet/actions/edit.js","../src/spreadsheet/actions/selection.js","../src/spreadsheet/actions/scroll.js","../src/spreadsheet/actions/virtual-scroll.js","../src/spreadsheet/actions/keyboard-navigation.js","../src/spreadsheet/actions/keyboard-shortcut.js","../src/spreadsheet/actions/cell-format.js","../src/spreadsheet/actions/resize.js","../src/spreadsheet/actions/collaborative-editing.js","../src/spreadsheet/actions/show-hide.js","../src/spreadsheet/actions/hyperlink.js","../src/spreadsheet/actions/undo-redo.js","../src/spreadsheet/actions/wrap.js","../src/spreadsheet/actions/insert.js","../src/spreadsheet/actions/delete.js","../src/spreadsheet/actions/data-validation.js","../src/spreadsheet/actions/protect-sheet.js","../src/spreadsheet/actions/find-and-replace.js","../src/spreadsheet/actions/merge.js","../src/spreadsheet/actions/conditional-formatting.js","../src/ribbon/ribbon.js","../src/spreadsheet/integrations/color-picker.js","../src/spreadsheet/integrations/ribbon.js","../src/spreadsheet/integrations/formula-bar.js","../src/spreadsheet/integrations/formula.js","../src/spreadsheet/integrations/sheet-tabs.js","../src/spreadsheet/integrations/open.js","../src/spreadsheet/integrations/save.js","../src/spreadsheet/integrations/context-menu.js","../src/spreadsheet/integrations/number-format.js","../src/spreadsheet/integrations/sort.js","../src/spreadsheet/integrations/filter.js","../src/spreadsheet/integrations/image.js","../src/spreadsheet/integrations/chart.js","../src/spreadsheet/common/basic-module.js","../src/spreadsheet/common/all-module.js","../src/spreadsheet/common/class.js","../src/spreadsheet/common/constant.js","../src/spreadsheet/renderer/sheet.js","../src/spreadsheet/renderer/row.js","../src/spreadsheet/renderer/cell.js","../src/spreadsheet/renderer/render.js","../src/spreadsheet/services/dialog.js","../src/spreadsheet/services/action-events.js","../src/spreadsheet/services/overlay.js","../src/spreadsheet/base/spreadsheet.js"],"sourcesContent":["import { isNullOrUndefined } from '@syncfusion/ej2-base';\nimport { getSheetIndex, getSheetNameFromAddress } from '../base/index';\n/**\n * To get range indexes.\n */\nexport function getRangeIndexes(range) {\n    var cellindexes;\n    var indexes = [];\n    range = range.indexOf('!') > -1 ? range.split('!')[1] : range;\n    range = range.indexOf(':') === -1 ? range + ':' + range : range;\n    range.split(':').forEach(function (address) {\n        cellindexes = getCellIndexes(address);\n        indexes.push(cellindexes[0]);\n        indexes.push(cellindexes[1]);\n    });\n    return indexes;\n}\n/**\n * To get single cell indexes\n */\nexport function getCellIndexes(address) {\n    return [parseInt(address.match(/\\d+/)[0], 10) - 1, getColIndex(address.match(/[A-Z]+/i)[0].toUpperCase())];\n}\n/**\n * To get column index from text.\n * @hidden\n */\nexport function getColIndex(text) {\n    var colIdx = 0;\n    text = text.split('').reverse().join('');\n    for (var i = text.length - 1; i >= 0; i--) {\n        colIdx += (text[i].charCodeAt(0) - 64) * (Math.pow(26, i));\n    }\n    return colIdx - 1;\n}\n/**\n * To get cell address from given row and column index.\n */\nexport function getCellAddress(sRow, sCol) {\n    return getColumnHeaderText(sCol + 1) + (sRow + 1);\n}\n/**\n * To get range address from given range indexes.\n */\nexport function getRangeAddress(range) {\n    return getCellAddress(range[0], range[1]) + ':' + (!isNullOrUndefined(range[2]) ?\n        getCellAddress(range[2], range[3]) : getCellAddress(range[0], range[1]));\n}\n/**\n * To get column header cell text\n */\nexport function getColumnHeaderText(colIndex) {\n    var alphabet = 'Z';\n    if (colIndex / 26 > 1) {\n        return getColumnHeaderText((colIndex % 26 === 0) ? (colIndex / 26 - 1) : Math.floor(colIndex / 26))\n            + String.fromCharCode((colIndex % 26) === 0 ? alphabet.charCodeAt(0) : 64 + (colIndex % 26));\n    }\n    else {\n        return String.fromCharCode(64 + (colIndex));\n    }\n}\n/**\n * @hidden\n */\nexport function getIndexesFromAddress(address) {\n    return getRangeIndexes(getRangeFromAddress(address));\n}\n/**\n * @hidden\n */\nexport function getRangeFromAddress(address) {\n    return address.split('!')[1] || address;\n}\n/**\n * Get complete address for selected range\n * @hidden\n */\nexport function getAddressFromSelectedRange(sheet) {\n    return sheet.name + '!' + sheet.selectedRange;\n}\n/**\n * @hidden\n */\nexport function getAddressInfo(context, address) {\n    var sIdx;\n    if (address.indexOf('!') > -1) {\n        sIdx = getSheetIndex(context, getSheetNameFromAddress(address));\n    }\n    else {\n        sIdx = context.activeSheetIndex;\n    }\n    return { sheetIndex: sIdx, indices: getIndexesFromAddress(address) };\n}\n/**\n * Given range will be swapped/arranged in increasing order.\n * @hidden\n */\nexport function getSwapRange(range) {\n    var clonedRange = range.slice();\n    if (range[0] > range[2]) {\n        swap(clonedRange, 0, 2);\n    }\n    if (range[1] > range[3]) {\n        swap(clonedRange, 1, 3);\n    }\n    return clonedRange;\n}\n/**\n * Interchange values in an array\n */\nfunction swap(range, x, y) {\n    var tmp = range[x];\n    range[x] = range[y];\n    range[y] = tmp;\n}\n/**\n * @hidden\n */\nexport function isSingleCell(range) {\n    return range[0] === range[2] && range[1] === range[3];\n}\n","/**\n * Worker task.\n */\nexport function executeTaskAsync(context, taskFn, callbackFn, data, preventCallback) {\n    return new WorkerHelper(context, taskFn, callbackFn, data, preventCallback);\n}\n/**\n * @hidden\n * The `WorkerHelper` module is used to perform multiple actions using Web Worker asynchronously.\n */\nvar WorkerHelper = /** @class */ (function () {\n    /**\n     * Constructor for WorkerHelper module in Workbook library.\n     * @private\n     */\n    function WorkerHelper(context, task, defaultListener, taskData, preventCallback) {\n        this.preventCallback = false;\n        this.context = context;\n        this.workerTask = task;\n        this.defaultListener = defaultListener;\n        this.workerData = taskData;\n        if (preventCallback) {\n            this.preventCallback = true;\n        }\n        this.initWorker();\n    }\n    /**\n     * To terminate the worker task.\n     * @private\n     */\n    WorkerHelper.prototype.terminate = function () {\n        this.worker.terminate();\n        URL.revokeObjectURL(this.workerUrl);\n    };\n    /**\n     * To initiate the worker.\n     * @private\n     */\n    WorkerHelper.prototype.initWorker = function () {\n        var taskBlob = new Blob([this.getFnCode()], { type: 'text/javascript' });\n        this.workerUrl = URL.createObjectURL(taskBlob);\n        this.worker = new Worker(this.workerUrl);\n        this.worker.onmessage = this.messageFromWorker.bind(this);\n        this.worker.onerror = this.onError.bind(this);\n        this.worker.postMessage(this.workerData);\n    };\n    /**\n     * Method for getting response from worker.\n     * @private\n     */\n    WorkerHelper.prototype.messageFromWorker = function (args) {\n        this.terminate();\n        this.defaultListener.apply(this.context, [args.data]);\n    };\n    /**\n     * Method for getting error message from worker if failed.\n     * @private\n     */\n    WorkerHelper.prototype.onError = function (args) {\n        this.terminate();\n        throw args.message || args;\n    };\n    /**\n     * Construct function code for worker.\n     * @private\n     */\n    WorkerHelper.prototype.getFnCode = function () {\n        var workerCode = '';\n        var i;\n        var keys;\n        var workerFunction = '';\n        var isHaveFunction = false;\n        if (typeof this.workerTask === 'function') {\n            if (this.workerTask.toString().indexOf('function') < 0) {\n                workerFunction = 'function ' + this.workerTask.toString();\n            }\n            else {\n                workerFunction = this.workerTask.toString();\n                isHaveFunction = true;\n            }\n            workerCode += ('self.workerTask = ' + workerFunction + '; \\n');\n        }\n        else {\n            if (typeof this.workerTask === 'object') {\n                keys = Object.keys(this.workerTask);\n                for (i = 0; i < keys.length; i++) {\n                    if (this.workerTask[keys[i]].toString().indexOf('function') < 0) {\n                        workerFunction = 'function ' + this.workerTask[keys[i]].toString();\n                    }\n                    else {\n                        workerFunction = this.workerTask[keys[i]].toString();\n                        isHaveFunction = true;\n                    }\n                    workerCode += ((i === 0 ? 'self.workerTask' : keys[i]) + '= ' + workerFunction + '; \\n');\n                }\n            }\n        }\n        workerCode += 'self.onmessage = ' + (isHaveFunction ? '' : ' function ') +\n            (this.preventCallback ? this.getMessageFn.toString() : this.getCallbackMessageFn.toString()) + '; \\n';\n        return workerCode;\n    };\n    /**\n     * Get default worker task with callback.\n     * @private\n     */\n    WorkerHelper.prototype.getCallbackMessageFn = function (args) {\n        postMessage(this.workerTask.apply(this, args.data));\n    };\n    /**\n     * Get default worker task without callback.\n     * @private\n     */\n    WorkerHelper.prototype.getMessageFn = function (args) {\n        this.workerTask.apply(this, args.data);\n    };\n    return WorkerHelper;\n}());\n","import { isNullOrUndefined, getDefaultDateObject } from '@syncfusion/ej2-base';\n/**\n * @hidden\n */\nexport function toFraction(val) {\n    var strVal = val.toString();\n    if (val === parseInt(strVal, 10)) {\n        return parseInt(strVal, 10) + '  ';\n    }\n    else {\n        var top_1 = strVal.indexOf('.') > -1 ? strVal.split('.')[1] : 0;\n        var bottom = Math.pow(10, top_1.toString().replace('-', '').length);\n        var abs = Math.abs(getGcd(top_1, bottom));\n        return (top_1 / abs) + '/' + (bottom / abs);\n    }\n}\n/**\n * @hidden\n */\nexport function getGcd(a, b) {\n    a = Number(a);\n    b = Number(b);\n    return (b) ? getGcd(b, a % b) : a;\n}\n/**\n * @hidden\n */\nexport function intToDate(val) {\n    val = Number(val);\n    val = (val > 0 && val < 1) ? (1 + val) : (val === 0) ? 1 : val;\n    if (val > 60) {\n        val -= 1; // Due to leap year issue of 1900 in MSExcel.\n    }\n    return new Date(((val - 1) * (1000 * 3600 * 24)) + new Date('01/01/1900').getTime());\n}\n/**\n * @hidden\n */\n/* tslint:disable no-any */\nexport function dateToInt(val, isTime) {\n    var startDate = new Date('01/01/1900');\n    var date = isDateTime(val) ? val : new Date(val);\n    var startDateUTC = Date.UTC(startDate.getFullYear(), startDate.getMonth(), startDate.getDate(), startDate.getHours(), startDate.getMinutes(), startDate.getSeconds(), startDate.getMilliseconds());\n    var dateUTC = Date.UTC(date.getFullYear(), date.getMonth(), date.getDate(), date.getHours(), date.getMinutes(), date.getSeconds(), date.getMilliseconds());\n    var diffDays = ((dateUTC - startDateUTC) / (1000 * 3600 * 24));\n    return isTime ? diffDays : parseInt(diffDays.toString(), 10) + 2;\n}\n/**\n * @hidden\n */\nexport function isDateTime(date) {\n    return Object.prototype.toString.call(date) === '[object Date]' && !isNaN(date.valueOf());\n}\n/**\n * @hidden\n */\nexport function isNumber(val) {\n    return val - parseFloat(val) >= 0;\n}\n/**\n * @hidden\n */\nexport function toDate(text, intl, format) {\n    var defaultDateFormats = getDefaultDateObject();\n    var availabelDateTimeFormat = defaultDateFormats.dateTimeFormats.availableFormats;\n    var dObj = { dateObj: null, isCustom: false, type: '' };\n    if (typeof text === 'string') {\n        text = text.toUpperCase();\n    }\n    if (format) {\n        dObj.dateObj = intl.parseDate(text, { format: format });\n        if (dObj.dateObj) {\n            dObj.type = text.toString().indexOf(':') > -1 ? 'time' : 'datetime';\n            dObj.isCustom = true;\n        }\n    }\n    if (isNullOrUndefined(dObj.dateObj)) {\n        for (var _i = 0, _a = Object.keys(defaultDateFormats.dateFormats); _i < _a.length; _i++) {\n            var key = _a[_i];\n            dObj.dateObj = intl.parseDate(text, { format: defaultDateFormats.dateFormats[key], skeleton: key });\n            if (dObj.dateObj) {\n                dObj.type = 'date';\n                dObj.isCustom = false;\n                break;\n            }\n        }\n        if (isNullOrUndefined(dObj.dateObj)) {\n            for (var _b = 0, _c = Object.keys(availabelDateTimeFormat); _b < _c.length; _b++) {\n                var key = _c[_b];\n                dObj.dateObj = intl.parseDate(text, { format: availabelDateTimeFormat[key], skeleton: key });\n                if (dObj.dateObj) {\n                    dObj.type = text.toString().indexOf(':') > -1 ? 'time' : 'datetime';\n                    if (dObj.type === 'time') {\n                        var time = dObj.dateObj.toLocaleTimeString();\n                        dObj.dateObj = new Date('01/01/1900 ' + time);\n                    }\n                    dObj.isCustom = true;\n                    break;\n                }\n            }\n        }\n        if (isNullOrUndefined(dObj.dateObj)) {\n            for (var _d = 0, _e = Object.keys(defaultDateFormats.timeFormats); _d < _e.length; _d++) {\n                var key = _e[_d];\n                dObj.dateObj = intl.parseDate(text, { format: defaultDateFormats.timeFormats[key], skeleton: key });\n                if (dObj.dateObj) {\n                    var time = dObj.dateObj.toLocaleTimeString();\n                    dObj.dateObj = new Date('01/01/1900 ' + time);\n                    dObj.type = 'time';\n                    dObj.isCustom = false;\n                    break;\n                }\n            }\n        }\n    }\n    if (text !== '#DIV/0!' && !dObj.dateObj && new Date(text).toString() !== 'Invalid Date') {\n        dObj.dateObj = new Date(text);\n    }\n    return dObj;\n}\n","import { getRangeIndexes } from '../common/index';\nimport { getCell, getSheet, setCell, getSheetIndex } from '../base/index';\nimport { Internationalization, getNumberDependable, getNumericObject, isNullOrUndefined } from '@syncfusion/ej2-base';\nimport { isNumber, toFraction, intToDate, toDate, dateToInt } from '../common/math';\nimport { applyNumberFormatting, getFormattedCellObject, refreshCellElement, checkDateFormat, getFormattedBarText } from '../common/event';\n/**\n * Specifies number format.\n */\nvar WorkbookNumberFormat = /** @class */ (function () {\n    function WorkbookNumberFormat(parent) {\n        this.parent = parent;\n        this.localeObj = getNumericObject(this.parent.locale);\n        /* tslint:disable:no-any */\n        this.decimalSep = this.localeObj.decimal;\n        this.groupSep = this.localeObj.group;\n        this.addEventListener();\n    }\n    WorkbookNumberFormat.prototype.numberFormatting = function (args) {\n        var activeSheetIndex = this.parent.activeSheetIndex;\n        if (args.range && args.range.indexOf('!') > -1) {\n            activeSheetIndex = getSheetIndex(this.parent, args.range.split('!')[0]);\n        }\n        var sheet = this.parent.sheets[activeSheetIndex];\n        var formatRange = args.range ? ((args.range.indexOf('!') > -1) ?\n            args.range.split('!')[1] : args.range) : sheet.selectedRange;\n        var selectedRange = getRangeIndexes(formatRange);\n        var cell;\n        for (var i = selectedRange[0]; i <= selectedRange[2]; i++) {\n            for (var j = selectedRange[1]; j <= selectedRange[3]; j++) {\n                setCell(i, j, sheet, { format: args.format }, true);\n                cell = getCell(i, j, sheet, true);\n                this.getFormattedCell({\n                    type: getTypeFromFormat(cell.format), value: cell.value,\n                    format: cell.format, rowIndex: i, colIndex: j,\n                    sheetIndex: activeSheetIndex, cell: cell\n                });\n            }\n        }\n    };\n    /**\n     * @hidden\n     */\n    WorkbookNumberFormat.prototype.getFormattedCell = function (args) {\n        var fResult = isNullOrUndefined(args.value) ? '' : args.value;\n        var sheet = this.parent.sheets[isNullOrUndefined(args.sheetIndex) ? this.parent.activeSheetIndex :\n            args.sheetIndex];\n        var range = getRangeIndexes(sheet.activeCell);\n        var sheetIdx = Number(args.sheetIndex) ? Number(args.sheetIndex) : this.parent.activeSheetIndex;\n        var cell = args.cell ? args.cell : getCell(range[0], range[1], sheet);\n        var rightAlign = false;\n        var currencySymbol = getNumberDependable(this.parent.locale, 'USD');\n        if (args.format === '' || args.format === 'General') {\n            cell = cell ? cell : {};\n            var dateEventArgs = {\n                value: args.value, rowIndex: range[0], colIndex: range[1], sheetIndex: this.parent.activeSheetIndex,\n                updatedVal: args.value, isDate: false, isTime: false\n            };\n            this.checkDateFormat(dateEventArgs);\n            if (dateEventArgs.isDate) {\n                rightAlign = true;\n                cell.value = args.value = dateEventArgs.updatedVal;\n                cell.format = args.format = getFormatFromType('ShortDate');\n            }\n            else if (dateEventArgs.isTime) {\n                rightAlign = true;\n                cell.value = args.value = dateEventArgs.updatedVal;\n                cell.format = args.format = getFormatFromType('Time');\n            }\n        }\n        args.type = args.format ? getTypeFromFormat(args.format) : 'General';\n        var result = this.processFormats(args, fResult, rightAlign, cell);\n        if ((this.parent.getActiveSheet().id - 1 === sheetIdx)) {\n            this.parent.notify(refreshCellElement, {\n                isRightAlign: result.rightAlign, result: result.fResult || args.value,\n                rowIndex: args.rowIndex, colIndex: args.colIndex, sheetIndex: args.sheetIndex,\n                type: args.type, curSymbol: currencySymbol, value: args.value || ''\n            });\n        }\n        if (!args.onLoad && (args.rowIndex > sheet.usedRange.rowIndex || args.colIndex > sheet.usedRange.colIndex)) {\n            this.parent.setUsedRange(args.rowIndex, args.colIndex);\n        }\n        args.formattedText = result.fResult || args.value;\n        args.isRightAlign = result.rightAlign;\n        args.curSymbol = currencySymbol;\n        return args.formattedText;\n    };\n    WorkbookNumberFormat.prototype.processFormats = function (args, fResult, isRightAlign, cell) {\n        var intl = new Internationalization();\n        var currencySymbol = getNumberDependable(this.parent.locale, 'USD');\n        var result;\n        args.format = args.format ? args.format : 'General';\n        if (fResult !== '') {\n            switch (args.type) {\n                case 'General':\n                    result = this.autoDetectGeneralFormat({\n                        args: args, currencySymbol: currencySymbol, fResult: fResult, intl: intl,\n                        isRightAlign: isRightAlign, curCode: 'USD', cell: cell, rowIdx: Number(args.rowIdx),\n                        colIdx: Number(args.colIdx)\n                    });\n                    fResult = result.fResult;\n                    isRightAlign = result.isRightAlign;\n                    break;\n                case 'Number':\n                    if (isNumber(fResult)) {\n                        fResult = this.applyNumberFormat(args, intl);\n                        isRightAlign = true;\n                    }\n                    break;\n                case 'Currency':\n                    if (isNumber(fResult)) {\n                        fResult = this.currencyFormat(args, intl);\n                        isRightAlign = true;\n                    }\n                    break;\n                case 'Percentage':\n                    if (isNumber(fResult)) {\n                        fResult = this.percentageFormat(args, intl);\n                        isRightAlign = true;\n                    }\n                    break;\n                case 'Accounting':\n                    if (isNumber(fResult)) {\n                        fResult = this.accountingFormat(args, intl);\n                        isRightAlign = true;\n                    }\n                    break;\n                case 'ShortDate':\n                    fResult = this.shortDateFormat(args, intl);\n                    isRightAlign = fResult ? true : false;\n                    break;\n                case 'LongDate':\n                    fResult = this.longDateFormat(args, intl);\n                    isRightAlign = fResult ? true : false;\n                    break;\n                case 'Time':\n                    fResult = this.timeFormat(args, intl);\n                    isRightAlign = fResult ? true : false;\n                    break;\n                case 'Fraction':\n                    if (isNumber(fResult)) {\n                        fResult = this.fractionFormat(args);\n                        isRightAlign = true;\n                    }\n                    break;\n                case 'Scientific':\n                    if (isNumber(fResult)) {\n                        fResult = this.scientificFormat(args);\n                        isRightAlign = true;\n                    }\n                    break;\n                case 'Text':\n                    isRightAlign = false;\n                    break;\n            }\n        }\n        return { fResult: fResult, rightAlign: isRightAlign };\n    };\n    WorkbookNumberFormat.prototype.autoDetectGeneralFormat = function (options) {\n        if (isNumber(options.fResult)) {\n            if (options.args.format && options.args.format !== '') {\n                if (options.args.format.toString().indexOf('%') > -1) {\n                    options.fResult = this.percentageFormat(options.args, options.intl);\n                }\n                else if (options.args.format.toString().indexOf(options.currencySymbol) > -1) {\n                    options.fResult = this.currencyFormat(options.args, options.intl);\n                }\n                else {\n                    options.fResult = this.applyNumberFormat(options.args, options.intl);\n                }\n            }\n            if (options.args.format === 'General' && options.fResult && options.fResult.toString().split(this.decimalSep)[0].length > 11) {\n                options.fResult = this.scientificFormat(options.args);\n            }\n            options.isRightAlign = true;\n        }\n        if (!isNullOrUndefined(options.fResult)) {\n            var res = options.fResult.toString();\n            if (res.indexOf('%') > -1 && res.split('%')[0] !== '' && res.split('%')[1].trim() === '' &&\n                Number(res.split('%')[0].split(this.groupSep).join('')).toString() !== 'NaN') {\n                options.args.value = Number(res.split('%')[0].split(this.groupSep).join(''));\n                options.cell.format = options.args.format = getFormatFromType('Percentage');\n                options.fResult = this.percentageFormat(options.args, options.intl);\n                options.cell.value = options.args.value.toString();\n                setCell(options.rowIdx, options.colIdx, this.parent.getActiveSheet(), options.cell, true);\n                options.isRightAlign = true;\n            }\n            else if (res.indexOf(options.currencySymbol) > -1 && res.split(options.currencySymbol)[1] !== '' &&\n                Number(res.split(options.currencySymbol)[1].split(this.groupSep).join('')).toString() !== 'NaN') {\n                options.args.value = Number(res.split(options.currencySymbol)[1].split(this.groupSep).join(''));\n                options.cell.format = options.args.format = getFormatFromType('Currency');\n                options.fResult = this.currencyFormat(options.args, options.intl);\n                options.cell.value = options.args.value.toString();\n                setCell(options.rowIdx, options.colIdx, this.parent.getActiveSheet(), options.cell, true);\n                options.isRightAlign = true;\n            }\n        }\n        return { isRightAlign: options.isRightAlign, fResult: options.fResult };\n    };\n    WorkbookNumberFormat.prototype.findSuffix = function (zeros, resultSuffix) {\n        var len = zeros.length;\n        var suffixLen = len - resultSuffix.length;\n        return zeros.substr(0, suffixLen < 0 ? 0 : suffixLen) + resultSuffix;\n    };\n    WorkbookNumberFormat.prototype.applyNumberFormat = function (args, intl) {\n        args.format = this.isCustomFormat(args.format.toString());\n        var formatArr = args.format.toString().split(';');\n        if (Number(args.value) >= 0) {\n            args.format = formatArr[0];\n        }\n        else {\n            args.format = !isNullOrUndefined(formatArr[1]) ? formatArr[1].split('*').join(' ') : formatArr[0];\n        }\n        return intl.formatNumber(Number(args.value), {\n            format: args.format\n        });\n    };\n    WorkbookNumberFormat.prototype.isCustomFormat = function (format) {\n        if (format === '_-* #,##0.00_-;-* #,##0.00_-;_-* \"-\"_-;_-@_-' || format === '_-* #,##0_-;-* #,##0_-;_-* \"-\"_-;_-@_-') {\n            format = '';\n        }\n        format = format === '' ? getFormatFromType('Number') : format;\n        format = format.toString().split('_)').join(' ').split('_(').join(' ').split('[Red]').join('');\n        return format;\n    };\n    WorkbookNumberFormat.prototype.currencyFormat = function (args, intl) {\n        args.format = args.format === '' ? getFormatFromType('Currency') : args.format;\n        args.format = args.format.toString().split('_(').join(' ').split('_)').join(' ').split('[Red]').join('');\n        var formatArr = args.format.toString().split(';');\n        if (Number(args.value) >= 0) {\n            args.format = formatArr[0];\n        }\n        else {\n            args.format = isNullOrUndefined(formatArr[1]) ? formatArr[0] : formatArr[1].split('*').join(' ');\n        }\n        return intl.formatNumber(Number(args.value), {\n            format: args.format,\n            currency: 'USD'\n        });\n    };\n    WorkbookNumberFormat.prototype.percentageFormat = function (args, intl) {\n        args.format = args.format === '' ? getFormatFromType('Percentage') : args.format;\n        return intl.formatNumber(Number(args.value), {\n            format: args.format\n        });\n    };\n    WorkbookNumberFormat.prototype.accountingFormat = function (args, intl) {\n        args.format = args.format === '' ? getFormatFromType('Accounting') : args.format;\n        args.format = args.format.split('_(').join(' ').split('_)').join(' ').split('[Red]').join('').split('_').join('');\n        var currencySymbol = getNumberDependable(this.parent.locale, 'USD');\n        var formatArr = args.format.split(';');\n        if (Number(args.value) >= 0) {\n            args.format = formatArr[0];\n        }\n        else {\n            args.format = formatArr[1].split('*').join(' ');\n        }\n        if (Number(args.value) === 0) {\n            return currencySymbol + '- ';\n        }\n        else {\n            return intl.formatNumber(Number(args.value), {\n                format: args.format,\n                currency: 'USD'\n            }).split('-').join('');\n        }\n    };\n    WorkbookNumberFormat.prototype.shortDateFormat = function (args, intl) {\n        var shortDate = intToDate(args.value);\n        var code = (args.format === '' || args.format === 'General') ? getFormatFromType('ShortDate')\n            : args.format.toString();\n        var dateObj;\n        if (code === getFormatFromType('ShortDate')) {\n            code = 'M/d/yy';\n            dateObj = {\n                type: 'date',\n                skeleton: 'yMd'\n            };\n        }\n        else {\n            dateObj = {\n                type: 'date',\n                format: code\n            };\n        }\n        return intl.formatDate(shortDate, dateObj);\n    };\n    WorkbookNumberFormat.prototype.longDateFormat = function (args, intl) {\n        var longDate = intToDate(args.value);\n        var code = (args.format === '' || args.format === 'General') ? getFormatFromType('LongDate')\n            : args.format.toString();\n        if (code === getFormatFromType('LongDate')) {\n            code = 'EEEE, MMMM d, y';\n        }\n        return intl.formatDate(longDate, {\n            type: 'date',\n            format: code\n        });\n    };\n    WorkbookNumberFormat.prototype.timeFormat = function (args, intl) {\n        if (isNullOrUndefined(args.value)) {\n            return '';\n        }\n        if (!isNullOrUndefined(args.value.toString().split(this.decimalSep)[1])) {\n            args.value = parseFloat('1' + this.decimalSep + args.value.toString().split(this.decimalSep)[1]) || args.value;\n        }\n        var time = intToDate(args.value);\n        var code = (args.format === '' || args.format === 'General') ? getFormatFromType('Time')\n            : args.format.toString();\n        if (code === getFormatFromType('Time')) {\n            code = 'h:mm:ss a';\n        }\n        return intl.formatDate(time, {\n            type: 'time',\n            skeleton: 'medium',\n            format: code\n        });\n    };\n    WorkbookNumberFormat.prototype.scientificFormat = function (args) {\n        args.format = args.format === '' ? getFormatFromType('Scientific') : args.format;\n        var zeros = args.format.split('+')[1];\n        var prefix = this.findDecimalPlaces(args.format, 'Scientific');\n        var fResult = Number(args.value).toExponential(prefix);\n        if (fResult.indexOf('e+') > -1) {\n            fResult = fResult.split('e+')[0] + 'E+' + this.findSuffix(zeros, fResult.split('e+')[1]);\n        }\n        else if (fResult.indexOf('e-') > -1) {\n            fResult = fResult.split('e-')[0] + 'E-' + +this.findSuffix(zeros, fResult.split('e-')[1]);\n        }\n        return fResult;\n    };\n    WorkbookNumberFormat.prototype.fractionFormat = function (args) {\n        args.format = args.format === '' ? getFormatFromType('Fraction') : args.format;\n        var suffix = '';\n        var fractionResult;\n        if (args.value.toString().indexOf(this.decimalSep) > -1 && isNumber(args.value)) {\n            suffix = args.value.toString().split(this.decimalSep)[0];\n            fractionResult = toFraction(Number(args.value));\n            return (Number(suffix) === 0) ? ' ' + fractionResult : suffix + ' ' + fractionResult;\n        }\n        return suffix;\n    };\n    WorkbookNumberFormat.prototype.findDecimalPlaces = function (code, type) {\n        switch (type) {\n            case 'Scientific':\n                var eIndex = code.toUpperCase().indexOf('E');\n                var decIndex = code.indexOf(this.decimalSep);\n                if (eIndex > -1) {\n                    return code.substring(decIndex + 1, eIndex).length;\n                }\n        }\n        return 2;\n    };\n    WorkbookNumberFormat.prototype.checkDateFormat = function (args) {\n        var dateObj;\n        var intl = new Internationalization();\n        var value = !isNullOrUndefined(args.value) ? args.value.toString() : '';\n        var checkedDate;\n        var cell = getCell(args.rowIndex, args.colIndex, getSheet(this.parent, isNullOrUndefined(args.sheetIndex) ? this.parent.activeSheetIndex : args.sheetIndex));\n        checkedDate = this.checkCustomDateFormat(value);\n        if (value && (value.indexOf('/') > -1 || value.indexOf('-') > 0 || value.indexOf(':') > -1) && checkedDate !== 'Invalid') {\n            value = checkedDate;\n            if (value && value.indexOf('/') > -1 || value.indexOf('-') > 0 || value.indexOf(':') > -1) {\n                dateObj = toDate(value, intl, cell && cell.format);\n                if (!isNullOrUndefined(dateObj.dateObj) && dateObj.dateObj.toString() !== 'Invalid Date') {\n                    cell = cell ? cell : {};\n                    value = dateToInt(dateObj.dateObj, value.indexOf(':') > -1).toString();\n                    if (!cell.format || cell.format === '') {\n                        if (dateObj.type === 'time') {\n                            cell.format = getFormatFromType('Time');\n                        }\n                        else {\n                            cell.format = getFormatFromType('ShortDate');\n                        }\n                    }\n                    args.isDate = dateObj.type === 'date' || dateObj.type === 'datetime';\n                    args.isTime = dateObj.type === 'time';\n                    args.dateObj = dateObj.dateObj;\n                }\n            }\n            args.updatedVal = value;\n        }\n    };\n    WorkbookNumberFormat.prototype.checkCustomDateFormat = function (val) {\n        var dateArr = val.indexOf('/') > -1 ? val.split('/') : val.indexOf('-') > 0 ? val.split('-') : '';\n        var months = ['jan', 'feb', 'mar', 'apr', 'may', 'jun', 'jul', 'aug', 'sep', 'sept', 'oct', 'nov', 'dec'];\n        if (dateArr.length === 2) {\n            if (months.indexOf(dateArr[0].toLowerCase()) > -1 && Number(dateArr[1]) <= 31) {\n                return '01-' + dateArr[0] + '-' + dateArr[1];\n            }\n            else if (months.indexOf(dateArr[1].toLowerCase()) > -1 && Number(dateArr[0]) <= 31) {\n                return dateArr[0] + '-' + dateArr[1] + '-' + new Date().getFullYear();\n            }\n            else if (Number(dateArr[0]) <= 31 && Number(dateArr[1]) <= 12) {\n                return dateArr[0] + '-' + dateArr[1] + '-' + new Date().getFullYear();\n            }\n            if (Number(dateArr[1]) <= 31 && Number(dateArr[0]) <= 12) {\n                return dateArr[0] + '-' + dateArr[1] + '-' + new Date().getFullYear();\n            }\n            if (Number(dateArr[0]) <= 12 && Number(dateArr[1]) <= 9999 && Number(dateArr[1]) >= 1900) {\n                return '01-' + dateArr[0] + '-' + dateArr[1];\n            }\n            else {\n                return 'Invalid';\n            }\n        }\n        return val;\n    };\n    WorkbookNumberFormat.prototype.formattedBarText = function (args) {\n        var type = getTypeFromFormat(args.cell ? args.cell.format : '');\n        var intl = new Internationalization();\n        var beforeText = args.value;\n        var date = (type === 'ShortDate' && args.cell && args.cell.format) ?\n            args.cell.format : getFormatFromType('ShortDate');\n        var time = getFormatFromType('Time');\n        switch (type) {\n            case 'ShortDate':\n            case 'LongDate':\n                args.value = this.shortDateFormat({ type: type, value: args.value, format: date }, intl);\n                break;\n            case 'Time':\n                args.value = this.shortDateFormat({ type: type, value: args.value, format: date }, intl) + ' ' +\n                    this.timeFormat({ type: type, value: args.value, format: time }, intl);\n                break;\n        }\n        if (!args.value || (args.value && args.value.toString().indexOf('null') > -1)) {\n            args.value = beforeText;\n        }\n    };\n    /**\n     * Adding event listener for number format.\n     */\n    WorkbookNumberFormat.prototype.addEventListener = function () {\n        this.parent.on(applyNumberFormatting, this.numberFormatting, this);\n        this.parent.on(getFormattedCellObject, this.getFormattedCell, this);\n        this.parent.on(checkDateFormat, this.checkDateFormat, this);\n        this.parent.on(getFormattedBarText, this.formattedBarText, this);\n    };\n    /**\n     * Removing event listener for number format.\n     */\n    WorkbookNumberFormat.prototype.removeEventListener = function () {\n        if (!this.parent.isDestroyed) {\n            this.parent.off(applyNumberFormatting, this.numberFormatting);\n            this.parent.off(getFormattedCellObject, this.getFormattedCell);\n            this.parent.off(checkDateFormat, this.checkDateFormat);\n            this.parent.off(getFormattedBarText, this.formattedBarText);\n        }\n    };\n    /**\n     * To Remove the event listeners.\n     */\n    WorkbookNumberFormat.prototype.destroy = function () {\n        this.removeEventListener();\n        this.parent = null;\n    };\n    /**\n     * Get the workbook number format module name.\n     */\n    WorkbookNumberFormat.prototype.getModuleName = function () {\n        return 'workbookNumberFormat';\n    };\n    return WorkbookNumberFormat;\n}());\nexport { WorkbookNumberFormat };\n/**\n * To Get the number built-in format code from the number format type.\n * @param {string} type - Specifies the type of the number formatting.\n */\nexport function getFormatFromType(type) {\n    var code = 'General';\n    switch (type.split(' ').join('')) {\n        case 'Number':\n            code = '0.00';\n            break;\n        case 'Currency':\n            code = '$#,##0.00';\n            break;\n        case 'Accounting':\n            code = '_($* #,##0.00_);_($* (#,##0.00);_($* \"-\"??_);_(@_)';\n            break;\n        case 'ShortDate':\n            code = 'mm-dd-yyyy';\n            break;\n        case 'LongDate':\n            code = 'dddd, mmmm dd, yyyy';\n            break;\n        case 'Time':\n            code = 'h:mm:ss AM/PM';\n            break;\n        case 'Percentage':\n            code = '0.00%';\n            break;\n        case 'Fraction':\n            code = '# ?/?';\n            break;\n        case 'Scientific':\n            code = '0.00E+00';\n            break;\n        case 'Text':\n            code = '@';\n            break;\n    }\n    return code;\n}\n/**\n * @hidden\n */\nexport function getTypeFromFormat(format) {\n    var code = 'General';\n    switch (format) {\n        case '0.00':\n        case '_-* #,##0.00_-;-* #,##0.00_-;_-* \"-\"_-;_-@_-':\n        case '_-* #,##0_-;-* #,##0_-;_-* \"-\"_-;_-@_-':\n            code = 'Number';\n            break;\n        case '$#,##0.00':\n        case '$#,##0_);[Red]($#,##0)':\n        case '$#,##0.00_);[Red]($#,##0.00)':\n        case '$#,##0.00_);($#,##0.00)':\n        case '$#,##0_);($#,##0)':\n            code = 'Currency';\n            break;\n        case '_($*#,##0.00_);_($*(#,##0.00);_($*\"-\"??_);_(@_)':\n        case '_($*#,##0.00_);_($* (#,##0.00);_($*\"-\"??_);_(@_)':\n        case '_($* #,##0.00_);_($* (#,##0.00);_($* \"-\"??_);_(@_)':\n        case '_ $ * #,##0.00_ ;_ $ * -#,##0.00_ ;_ $ * \"-\"??_ ;_ @_ ':\n            code = 'Accounting';\n            break;\n        case 'mm-dd-yyyy':\n        case 'dd-mm-yyyy':\n        case 'dd-mm-yy':\n        case 'mm-dd-yy':\n        case 'dd/MM/yyyy':\n        case 'yyyy-MM-dd':\n            code = 'ShortDate';\n            break;\n        case 'dddd, mmmm dd, yyyy':\n            code = 'LongDate';\n            break;\n        case 'h:mm:ss AM/PM':\n            code = 'Time';\n            break;\n        case '0.00%':\n        case '0%':\n            code = 'Percentage';\n            break;\n        case '# ?/?':\n        case '# ??/??':\n        case '# ???/???':\n            code = 'Fraction';\n            break;\n        case '0.00E+00':\n            code = 'Scientific';\n            break;\n        case '@':\n            code = 'Text';\n            break;\n    }\n    return code;\n}\n","/**\n * Represent the common codes for calculate\n */\nvar CalculateCommon = /** @class */ (function () {\n    function CalculateCommon(parent) {\n        this.parent = parent;\n    }\n    /**\n     * For internal use only - Get the module name.\n     * @private\n     */\n    CalculateCommon.prototype.getModuleName = function () {\n        return 'calc-common';\n    };\n    return CalculateCommon;\n}());\nexport { CalculateCommon };\n/**\n * To check whether the object is undefined.\n * @param {Object} value - To check the object is undefined\n * @return {boolean}\n * @private\n */\nexport function isUndefined(value) {\n    return ('undefined' === typeof value);\n}\n/** @hidden */\nexport function getSkeletonVal(value) {\n    switch (value) {\n        case 'dd-MMM-yyyy':\n        case 'dd MMM yyyy':\n            value = 'medium';\n            break;\n        case 'MMM-yyyy':\n        case 'MMM yyyy':\n            value = 'yMMM';\n            break;\n        case 'MM-dd-yyyy': //short\n        case 'dd-MM-yyyy':\n        case 'dd-MM-yy':\n        case 'MM/dd/yyyy':\n        case 'dd/MM/yyyy':\n        case 'dd/MM/yy':\n            value = 'short';\n            break;\n        case 'dddd MMMM dd yyyy': //long\n        case 'dd MMMM yyyy':\n            value = 'long';\n            break;\n        case 'd MMMM yyyy':\n            value = 'yMMMd';\n            break;\n        case 'yyyy':\n            value = 'y';\n            break;\n        case 'h:mm':\n            value = 'Hm';\n            break;\n        case 'h:mm tt':\n            value = 'hm';\n            break;\n        case 'h':\n            value = 'H';\n            break;\n        case 'h tt':\n            value = 'h';\n            break;\n        case 'dddd':\n            value = 'E';\n            break;\n        case 'h:mm:ss tt':\n            value = 'hms';\n            break;\n        case 'h:mm:ss':\n            value = 'Hms';\n            break;\n        case 'd':\n            value = 'd';\n            break;\n        case 'd dddd':\n            value = 'Ed';\n            break;\n        case 'M':\n            value = 'M';\n            break;\n        case 'Md':\n            value = 'Md';\n            break;\n        case 'MMM':\n            value = 'MMM';\n            break;\n        case 'ddd MMM d':\n            value = 'MMMEd';\n            break;\n        case 'MMM d':\n            value = 'MMMd';\n            break;\n        case 'M/yyyy':\n            value = 'yM';\n            break;\n        default:\n            value = '';\n            break;\n    }\n    return value;\n}\n","/**\n * Represents the getModules function.\n * @param {Calculate} context\n */\nexport function getModules(context) {\n    var modules = [];\n    if (context.includeBasicFormulas) {\n        modules.push({\n            member: 'basic-formulas',\n            args: [context]\n        });\n    }\n    return modules;\n}\n","/**\n * Module loading operations\n */\nimport { isNullOrUndefined, isUndefined } from '@syncfusion/ej2-base';\nvar MODULE_SUFFIX = 'Module';\n/**\n * To get nameSpace value from the desired object.\n * @param {string} nameSpace - String value to the get the inner object\n * @param {any} obj - Object to get the inner object value.\n * @return {any}\n * @private\n */\nexport function getValue(nameSpace, obj) {\n    /* tslint:disable no-any */\n    var value = obj;\n    var splits = nameSpace.replace(/\\[/g, '.').replace(/\\]/g, '').split('.');\n    for (var j = 0; j < splits.length && !isUndefined(value); j++) {\n        value = value[splits[j]];\n    }\n    return value;\n}\n/**\n * To set value for the nameSpace in desired object.\n * @param {string} nameSpace - String value to get the inner object\n * @param {any} value - Value that you need to set.\n * @param {any} obj - Object to get the inner object value.\n * @return {void}\n * @private\n */\nexport function setValue(nameSpace, value, obj) {\n    var keyValues = nameSpace.replace(/\\[/g, '.').replace(/\\]/g, '').split('.');\n    var start = obj || {};\n    var fromObj = start;\n    var j;\n    var length = keyValues.length;\n    var key;\n    for (j = 0; j < length; j++) {\n        key = keyValues[j];\n        if (j + 1 === length) {\n            fromObj[key] = value === undefined ? {} : value;\n        }\n        else if (isNullOrUndefined(fromObj[key])) {\n            fromObj[key] = {};\n        }\n        fromObj = fromObj[key];\n    }\n    return start;\n}\nvar ModuleLoader = /** @class */ (function () {\n    function ModuleLoader(parent) {\n        this.loadedModules = [];\n        this.parent = parent;\n    }\n    ;\n    /**\n     * Inject required modules in component library\n     * @hidden\n     */\n    ModuleLoader.prototype.inject = function (requiredModules, moduleList) {\n        var reqLengthVal = requiredModules.length;\n        if (reqLengthVal === 0) {\n            this.clean();\n            return;\n        }\n        if (this.loadedModules.length) {\n            this.clearUnusedModule(requiredModules);\n        }\n        for (var i = 0; i < reqLengthVal; i++) {\n            var modl = requiredModules[i];\n            for (var _i = 0, moduleList_1 = moduleList; _i < moduleList_1.length; _i++) {\n                var module = moduleList_1[_i];\n                var modName = modl.member;\n                if (module.prototype.getModuleName() === modl.member && !this.isModuleLoaded(modName)) {\n                    var moduleObject = this.createInstance(module, modl.args);\n                    var memberName = this.getMemberName(modName);\n                    if (modl.isProperty) {\n                        setValue(memberName, module, this.parent);\n                    }\n                    else {\n                        setValue(memberName, moduleObject, this.parent);\n                    }\n                    var loadedModule = modl;\n                    loadedModule.member = memberName;\n                    this.loadedModules.push(loadedModule);\n                }\n            }\n        }\n    };\n    /**\n     * Create Instance from constructor function with desired parameters.\n     * @param {Function} classFunction - Class function to which need to create instance\n     * @param {any[]} params - Parameters need to passed while creating instance\n     * @return {any}\n     * @private\n     */\n    ModuleLoader.prototype.createInstance = function (classFunction, params) {\n        var arrayParam = params;\n        arrayParam.unshift(undefined);\n        return new (Function.prototype.bind.apply(classFunction, arrayParam));\n    };\n    /**\n     * To remove the created object while control is destroyed\n     * @hidden\n     */\n    ModuleLoader.prototype.clean = function () {\n        for (var _i = 0, _a = this.loadedModules; _i < _a.length; _i++) {\n            var modules = _a[_i];\n            if (!modules.isProperty) {\n                getValue(modules.member, this.parent).destroy();\n            }\n        }\n        this.loadedModules = [];\n    };\n    /**\n     * Removes all unused modules\n     * @param {ModuleDeclaration[]} moduleListName\n     * @returns {void}\n     */\n    ModuleLoader.prototype.clearUnusedModule = function (moduleListName) {\n        var _this = this;\n        var usedModule = moduleListName.map(function (arg) { return _this.getMemberName(arg.member); });\n        var removeModule = this.loadedModules.filter(function (module) {\n            return usedModule.indexOf(module.member) === -1;\n        });\n        for (var _i = 0, removeModule_1 = removeModule; _i < removeModule_1.length; _i++) {\n            var moduleName = removeModule_1[_i];\n            if (!moduleName.isProperty) {\n                getValue(moduleName.member, this.parent).destroy();\n            }\n            this.loadedModules.splice(this.loadedModules.indexOf(moduleName), 1);\n            this.deleteObject(this.parent, moduleName.member);\n        }\n    };\n    /**\n     * To get the name of the member.\n     * @param {string} name\n     * @returns {string}\n     */\n    ModuleLoader.prototype.getMemberName = function (name) {\n        return name[0].toLowerCase() + name.substring(1) + MODULE_SUFFIX;\n    };\n    /**\n     * Delete an item from Object\n     * @param {any} obj - Object in which we need to delete an item.\n     * @param {string} params - String value to the get the inner object\n     * @return {void}\n     * @private\n     */\n    ModuleLoader.prototype.deleteObject = function (obj, key) {\n        delete obj[key];\n    };\n    /**\n     * Returns boolean based on whether the module specified is loaded or not\n     * @param {string} modName\n     * @returns {boolean}\n     */\n    ModuleLoader.prototype.isModuleLoaded = function (modName) {\n        for (var _i = 0, _a = this.loadedModules; _i < _a.length; _i++) {\n            var mod = _a[_i];\n            if (mod.member === this.getMemberName(modName)) {\n                return true;\n            }\n        }\n        return false;\n    };\n    return ModuleLoader;\n}());\nexport { ModuleLoader };\n","var __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    }\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\n/* tslint:disable-next-line:max-line-length */\nimport { getValue, Event, NotifyPropertyChanges, Base, Property, isNullOrUndefined, isUndefined } from '@syncfusion/ej2-base';\nimport { BasicFormulas } from './../formulas/index';\nimport { getModules, ModuleLoader } from '../common/index';\nimport { CommonErrors, FormulasErrorsStrings } from '../common/enum';\nimport { Parser } from './parser';\n/**\n * Represents the calculate library.\n */\nvar Calculate = /** @class */ (function (_super) {\n    __extends(Calculate, _super);\n    /**\n     * Base constructor for creating Calculate library.\n     */\n    function Calculate(parent) {\n        var _this = _super.call(this, null, null) || this;\n        _this.lFormulas = new Map();\n        /** @hidden */\n        _this.storedData = new Map();\n        _this.keyToRowsMap = new Map();\n        _this.rowsToKeyMap = new Map();\n        /** @hidden */\n        _this.rightBracket = String.fromCharCode(161);\n        /** @hidden */\n        _this.leftBracket = String.fromCharCode(162);\n        /** @hidden */\n        _this.sheetToken = '!';\n        _this.emptyString = '';\n        _this.leftBrace = '{';\n        _this.rightBrace = '}';\n        _this.cell = _this.emptyString;\n        _this.cellPrefix = '!0!A';\n        _this.treatEmptyStringAsZero = false;\n        /** @hidden */\n        _this.tic = '\\\"';\n        /** @hidden */\n        _this.singleTic = '\\'';\n        /** @hidden */\n        _this.trueValue = 'TRUE';\n        /** @hidden */\n        _this.falseValue = 'FALSE';\n        _this.parseDecimalSeparator = '.';\n        /** @hidden */\n        _this.arithMarker = String.fromCharCode(180);\n        /** @hidden */\n        _this.arithMarker2 = _this.arithMarker + _this.arithMarker;\n        _this.dependentCells = null;\n        _this.dependentFormulaCells = null;\n        _this.minValue = Number.MIN_SAFE_INTEGER;\n        _this.maxValue = Number.MAX_SAFE_INTEGER;\n        _this.categoryCollection = ['All'];\n        _this.dependencyLevel = 0;\n        _this.refreshedCells = new Map();\n        _this.computedValues = null;\n        /** @hidden */\n        _this.randomValues = new Map();\n        /** @hidden */\n        _this.isRandomVal = false;\n        /** @hidden */\n        _this.randCollection = [];\n        /**\n         * @hidden\n         */\n        _this.formulaErrorStrings = [\n            'binary operators cannot start an expression',\n            'cannot parse',\n            'bad library',\n            'invalid char in front of',\n            'number contains 2 decimal points',\n            'expression cannot end with an operator',\n            'invalid characters following an operator',\n            'invalid character in number',\n            'mismatched parentheses',\n            'unknown formula name',\n            'requires a single argument',\n            'requires 3 arguments',\n            'invalid Math argument',\n            'requires 2 arguments',\n            '#NAME?',\n            'too complex',\n            'circular reference: ',\n            'missing formula',\n            'improper formula',\n            'invalid expression',\n            'cell empty',\n            'bad formula',\n            'empty expression',\n            '',\n            'mismatched string quotes',\n            'wrong number of arguments',\n            'invalid arguments',\n            'iterations do not converge',\n            'Control is already registered',\n            'Calculation overflow',\n            'Missing sheet',\n            'cannot_parse',\n            'expression_cannot_end_with_an_operator'\n        ];\n        _this.errorStrings = null;\n        _this.parseArgumentSeparator = ',';\n        _this.dateTime1900 = new Date(1900, 0, 1, 0, 0, 0);\n        _this.isParseDecimalSeparatorChanged = false;\n        _this.isArgumentSeparatorChanged = false;\n        _this.sheetFamilyID = 0;\n        _this.defaultFamilyItem = null;\n        _this.sheetFamiliesList = null;\n        _this.modelToSheetID = null;\n        /** @hidden */\n        _this.tokenCount = 0;\n        _this.sortedSheetNames = null;\n        _this.tempSheetPlaceHolder = String.fromCharCode(133);\n        /** @hidden */\n        _this.namedRanges = new Map();\n        _this.formulaInfoTable = null;\n        _this.oaDate = new Date(1899, 11, 30);\n        _this.millisecondsOfaDay = 24 * 60 * 60 * 1000;\n        _this.parseDateTimeSeparator = '/';\n        var moduleLoader = new ModuleLoader(_this);\n        if (_this.includeBasicFormulas) {\n            Calculate_1.Inject(BasicFormulas);\n        }\n        if (_this.injectedModules && _this.injectedModules.length) {\n            moduleLoader.inject(_this.requiredModules(), _this.injectedModules);\n        }\n        _this.parentObject = isNullOrUndefined(parent) ? _this : parent;\n        _this.grid = _this.parentObject;\n        _this.parser = new Parser(_this);\n        return _this;\n    }\n    Calculate_1 = Calculate;\n    Object.defineProperty(Calculate.prototype, \"libraryFormulas\", {\n        /* tslint:disable-next-line:no-any */\n        get: function () {\n            return this.lFormulas;\n        },\n        /* tslint:disable-next-line:no-any */\n        set: function (formulaColl) {\n            this.lFormulas.set(formulaColl.fName, { handler: formulaColl.handler, category: formulaColl.category, description: formulaColl.description });\n        },\n        enumerable: true,\n        configurable: true\n    });\n    /**\n     * To get the argument separator to split the formula arguments.\n     * @returns string\n     */\n    Calculate.prototype.getParseArgumentSeparator = function () {\n        var seperator = ',';\n        if (!this.isArgumentSeparatorChanged && seperator !== this.parseArgumentSeparator) {\n            this.parseArgumentSeparator = seperator;\n        }\n        return this.parseArgumentSeparator;\n    };\n    /**\n     * To set the argument separator to split the formula arguments.\n     * @param {string} value - Argument separator based on the culture.\n     * @returns void\n     */\n    Calculate.prototype.setParseArgumentSeparator = function (value) {\n        this.parseArgumentSeparator = value;\n        this.isArgumentSeparatorChanged = true;\n    };\n    /**\n     * To get the date separator to split the date value.\n     * @returns string\n     */\n    Calculate.prototype.getParseDateTimeSeparator = function () {\n        return this.parseDateTimeSeparator;\n    };\n    /**\n     * To set whether the empty string is treated as zero or not.\n     * @param {boolean} value\n     * @returns boolean\n     */\n    Calculate.prototype.setTreatEmptyStringAsZero = function (value) {\n        this.treatEmptyStringAsZero = value;\n    };\n    /**\n     * To get whether the empty string is treated as zero or not.\n     * @returns boolean\n     */\n    Calculate.prototype.getTreatEmptyStringAsZero = function () {\n        return this.treatEmptyStringAsZero;\n    };\n    /**\n     * To set the date separator to split the date value.\n     * @param {string} value - Argument separator based on the culture.\n     * @returns void\n     */\n    Calculate.prototype.setParseDateTimeSeparator = function (value) {\n        this.parseDateTimeSeparator = value;\n    };\n    /**\n     * To provide the array of modules needed.\n     * @hidden\n     */\n    Calculate.prototype.requiredModules = function () {\n        return getModules(this);\n    };\n    /**\n     * Dynamically injects the required modules to the library.\n     * @hidden\n     */\n    Calculate.Inject = function () {\n        var moduleList = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            moduleList[_i] = arguments[_i];\n        }\n        if (!this.prototype.injectedModules) {\n            this.prototype.injectedModules = [];\n        }\n        for (var j = 0; j < moduleList.length; j++) {\n            if (this.prototype.injectedModules.indexOf(moduleList[j]) === -1) {\n                this.prototype.injectedModules.push(moduleList[j]);\n            }\n        }\n    };\n    /**\n     * Get injected modules\n     * @hidden\n     */\n    Calculate.prototype.getInjectedModules = function () {\n        return this.injectedModules;\n    };\n    Calculate.prototype.onPropertyChanged = function (newProp, oldProp) {\n        /** code snippets */\n    };\n    Calculate.prototype.getModuleName = function () {\n        return 'calculate';\n    };\n    /** @hidden */\n    Calculate.prototype.getFormulaCharacter = function () {\n        return '=';\n    };\n    /** @hidden */\n    Calculate.prototype.isUpperChar = function (text) {\n        var charCode = text.charCodeAt(0);\n        return ((charCode > 64) && (charCode < 91));\n    };\n    Calculate.prototype.resetKeys = function () {\n        this.storedData.clear();\n        this.keyToRowsMap.clear();\n        this.rowsToKeyMap.clear();\n    };\n    /**\n     * @hidden\n     */\n    Calculate.prototype.updateDependentCell = function (cellRef) {\n        var family = this.getSheetFamilyItem(this.grid);\n        var cell = this.cell;\n        if (cell !== this.emptyString) {\n            if (family.sheetNameToParentObject !== null) {\n                var token = family.parentObjectToToken.get(this.grid);\n                if (cell.indexOf(this.sheetToken) === -1) {\n                    cell = token + cell;\n                }\n                if (cellRef.indexOf(this.sheetToken) === -1) {\n                    cellRef = token + cellRef;\n                }\n            }\n            if (this.getDependentCells().has(cellRef)) {\n                var formulaCells = this.getDependentCells().get(cellRef);\n                if (formulaCells.indexOf(cell) < 0) {\n                    formulaCells.push(cell);\n                }\n            }\n            else {\n                this.getDependentCells().set(cellRef, [cell]);\n            }\n            this.addToFormulaDependentCells(cellRef);\n        }\n    };\n    Calculate.prototype.addToFormulaDependentCells = function (cellRef) {\n        var cell1 = this.cell;\n        var family = this.getSheetFamilyItem(this.grid);\n        if (family.sheetNameToParentObject != null && cell1.indexOf(this.sheetToken) === -1) {\n            var token = family.parentObjectToToken.get(this.grid);\n            cell1 = token + cell1;\n        }\n        if (!this.getDependentFormulaCells().has(cell1)) {\n            this.getDependentFormulaCells().set(cell1, new Map());\n            this.getDependentFormulaCells().get(cell1).set(cellRef, cellRef);\n        }\n        else if (!(this.getDependentFormulaCells().get(cell1)).has(cellRef)) {\n            this.getDependentFormulaCells().get(cell1).set(cellRef, cellRef);\n        }\n    };\n    /**\n     * @hidden\n     */\n    Calculate.prototype.getDependentCells = function () {\n        if (this.isSheetMember()) {\n            var family = this.getSheetFamilyItem(this.grid);\n            if (family.sheetDependentCells == null) {\n                family.sheetDependentCells = new Map();\n            }\n            return family.sheetDependentCells;\n        }\n        else {\n            if (this.dependentCells == null) {\n                this.dependentCells = new Map();\n            }\n            return this.dependentCells;\n        }\n    };\n    /**\n     * @hidden\n     */\n    Calculate.prototype.getDependentFormulaCells = function () {\n        if (this.isSheetMember()) {\n            var family = this.getSheetFamilyItem(this.grid);\n            if (family.sheetDependentFormulaCells == null) {\n                family.sheetDependentFormulaCells = new Map();\n            }\n            return family.sheetDependentFormulaCells;\n        }\n        else {\n            if (this.dependentFormulaCells == null) {\n                this.dependentFormulaCells = new Map();\n            }\n            return this.dependentFormulaCells;\n        }\n    };\n    /**\n     * To get library formulas collection.\n     * @returns Map<string, Function>\n     */\n    Calculate.prototype.getLibraryFormulas = function () {\n        return this.lFormulas;\n    };\n    /**\n     * To get library function.\n     * @param {string} libFormula - Library formula to get a corresponding function.\n     * @returns Function\n     */\n    Calculate.prototype.getFunction = function (libFormula) {\n        if (this.getLibraryFormulas().has(libFormula.toUpperCase())) {\n            return this.getLibraryFormulas().get(libFormula.toUpperCase()).handler;\n        }\n        else {\n            return null;\n        }\n    };\n    /** @hidden */\n    Calculate.prototype.intToDate = function (val) {\n        var dateVal = Number(val);\n        dateVal = (dateVal > 0 && dateVal < 1) ? (1 + dateVal) : (dateVal === 0) ? 1 : dateVal;\n        if (dateVal > 60) {\n            dateVal -= 1; // Due to leap year issue of 1900 in MSExcel.\n        }\n        return new Date(((dateVal - 1) * (1000 * 3600 * 24)) + new Date('01/01/1900').getTime());\n    };\n    Calculate.prototype.getFormulaInfoTable = function () {\n        if (this.isSheetMember()) {\n            var family = this.getSheetFamilyItem(this.grid);\n            if (family.sheetFormulaInfotable === null) {\n                family.sheetFormulaInfotable = new Map();\n            }\n            return family.sheetFormulaInfotable;\n        }\n        else {\n            if (this.formulaInfoTable === null) {\n                this.formulaInfoTable = new Map();\n            }\n            return this.formulaInfoTable;\n        }\n    };\n    /**\n     * To get the formula text.\n     * @private\n     */\n    Calculate.prototype.getFormula = function (key) {\n        key = key.toUpperCase();\n        if (this.storedData.has(key)) {\n            return this.storedData.get(key).getFormulaText();\n        }\n        return '';\n    };\n    /**\n     * To get the formula text.\n     * @returns void\n     */\n    Calculate.prototype.getParseDecimalSeparator = function () {\n        var seperator = '.';\n        if (!this.isParseDecimalSeparatorChanged && seperator !== this.parseDecimalSeparator) {\n            this.parseDecimalSeparator = seperator;\n        }\n        return this.parseDecimalSeparator;\n    };\n    /**\n     * To get the formula text.\n     * @param {string} value - Specifies the decimal separator value.\n     * @returns void\n     */\n    Calculate.prototype.setParseDecimalSeparator = function (value) {\n        this.parseDecimalSeparator = value;\n        this.isParseDecimalSeparatorChanged = true;\n    };\n    /** @hidden */\n    Calculate.prototype.getSheetToken = function (cellRef) {\n        var i = 0;\n        var temp = this.emptyString;\n        if (i < cellRef.length && cellRef[i] === this.sheetToken) {\n            i++;\n            while (i < cellRef.length && cellRef[i] !== this.sheetToken) {\n                i++;\n            }\n            temp = cellRef.substring(0, i + 1);\n        }\n        if (i < cellRef.length) {\n            return temp;\n        }\n        throw this.formulaErrorStrings[FormulasErrorsStrings.bad_index];\n    };\n    /** @hidden */\n    Calculate.prototype.getSheetID = function (grd) {\n        var family = this.getSheetFamilyItem(grd);\n        if (family.sheetNameToParentObject != null && family.sheetNameToParentObject.size > 0) {\n            var token = family.parentObjectToToken.get(grd);\n            token = token.split(this.sheetToken).join(this.emptyString);\n            var id = this.parseFloat(token);\n            if (!this.isNaN(id)) {\n                return id;\n            }\n        }\n        return -1;\n    };\n    /** @hidden */\n    Calculate.prototype.parseFloat = function (value) {\n        return Number(value);\n    };\n    /**\n     * To get the row index of the given cell.\n     * @param {string} cell - Cell address for getting row index.\n     * @returns number\n     */\n    Calculate.prototype.rowIndex = function (cell) {\n        var i = 0;\n        var result;\n        var isLetter = false;\n        if (i < cell.length && cell[i] === this.sheetToken) {\n            i++;\n            while (i < cell.length && cell[i] !== this.sheetToken) {\n                i++;\n            }\n            i++;\n        }\n        while (i < cell.length && this.isChar(cell[i])) {\n            isLetter = true;\n            i++;\n        }\n        result = parseInt(cell.substring(i), 10);\n        if (i < cell.length && !this.isNaN(result)) {\n            return result;\n        }\n        if (isLetter) {\n            return -1;\n        }\n        throw this.formulaErrorStrings[FormulasErrorsStrings.bad_index];\n    };\n    /**\n     * To get the column index of the given cell.\n     * @param {string} cell - Cell address for getting column index.\n     * @returns number\n     */\n    Calculate.prototype.colIndex = function (cell) {\n        var j = 0;\n        var k = 0;\n        cell = cell.toUpperCase();\n        if (j < cell.length && cell[j] === this.sheetToken) {\n            j++;\n            while (j < cell.length && cell[j] !== this.sheetToken) {\n                j++;\n            }\n            j++;\n        }\n        while (j < cell.length && this.isChar(cell[j])) {\n            var charCode = cell[j].charCodeAt(0);\n            k = k * 26 + charCode - 64;\n            j++;\n        }\n        if (k === 0) {\n            return -1;\n        }\n        return k;\n    };\n    /**\n     * To get the valid error strings.\n     * @hidden\n     */\n    Calculate.prototype.getErrorStrings = function () {\n        if (this.errorStrings === null) {\n            this.errorStrings = ['#N/A', '#VALUE!', '#REF!', '#DIV/0!', '#NUM!', '#NAME?', '#NULL!'];\n        }\n        return this.errorStrings;\n    };\n    /** @hidden */\n    Calculate.prototype.substring = function (text, startIndex, length) {\n        return text.substring(startIndex, length + startIndex);\n    };\n    /** @hidden */\n    Calculate.prototype.isChar = function (c) {\n        if ((c.charCodeAt(0) >= 65 && c.charCodeAt(0) <= 90) || (c.charCodeAt(0) >= 97 && c.charCodeAt(0) <= 122)) {\n            return true;\n        }\n        return false;\n    };\n    /** @hidden */\n    Calculate.prototype.getSheetFamilyItem = function (model) {\n        if (this.sheetFamilyID === 0) {\n            if (this.defaultFamilyItem == null) {\n                this.defaultFamilyItem = new CalcSheetFamilyItem();\n            }\n            return this.defaultFamilyItem;\n        }\n        if (this.sheetFamiliesList == null) {\n            this.sheetFamiliesList = new Map();\n        }\n        var i = this.modelToSheetID.get(model);\n        if (!this.sheetFamiliesList.has(i)) {\n            this.sheetFamiliesList.set(i, new CalcSheetFamilyItem());\n        }\n        return this.sheetFamiliesList.get(i);\n    };\n    /**\n     * Register a key value pair for formula.\n     * @param {string} key - Key for formula reference .\n     * @param {string | number} value - Value for the corresponding key.\n     * @returns void\n     */\n    Calculate.prototype.setKeyValue = function (key, value) {\n        key = key.toUpperCase();\n        var str = value.toString().trim();\n        if (!this.storedData.get(key) || str.indexOf(this.leftBrace) === 0) {\n            this.storedData.set(key, new FormulaInfo());\n            this.keyToRowsMap.set(key, this.keyToRowsMap.size + 1);\n            this.rowsToKeyMap.set(this.rowsToKeyMap.size + 1, key);\n        }\n        var fInfo = this.storedData.get(key);\n        if (fInfo.getFormulaText() != null && fInfo.getFormulaText().length > 0 && fInfo.getFormulaText() !== str) {\n            var s1 = this.cellPrefix + this.keyToRowsMap.get(key).toString();\n            var formulaDependent = this.getDependentFormulaCells().get(s1);\n            if (formulaDependent != null) {\n                this.clearFormulaDependentCells(s1);\n            }\n        }\n        if (str.length > 0 && str[0] === this.getFormulaCharacter()) {\n            fInfo.setFormulaText(str);\n        }\n        else if (fInfo.getFormulaValue() !== str) {\n            fInfo.setFormulaText('');\n            fInfo.setParsedFormula('');\n            fInfo.setFormulaValue(str);\n        }\n    };\n    /**\n     * @hidden\n     */\n    Calculate.prototype.clearFormulaDependentCells = function (cell) {\n        var _this = this;\n        var dependentFormula = this.getDependentFormulaCells().get(cell);\n        if (dependentFormula != null) {\n            dependentFormula.forEach(function (value, key) {\n                var s = key;\n                var dependent = _this.getDependentCells().get(s);\n                _this.arrayRemove(dependent, cell);\n                if (dependent.length === 0) {\n                    _this.getDependentCells().delete(s);\n                }\n            });\n            this.getDependentFormulaCells().delete(cell);\n        }\n    };\n    Calculate.prototype.arrayRemove = function (array, value) {\n        var index = array.indexOf(value);\n        if (index !== -1) {\n            array.splice(index, 1);\n        }\n        return array;\n    };\n    /**\n     * Register a key value pair for formula.\n     * @param {string} key - Key for getting the corresponding value.\n     * @returns string | number\n     */\n    Calculate.prototype.getKeyValue = function (key) {\n        key = key.toUpperCase();\n        if (this.storedData.has(key) !== null) {\n            var fInfo = this.storedData.get(key);\n            var fText = fInfo.getFormulaText();\n            if (fText.length > 0 && fText[0] === this.getFormulaCharacter()) {\n                this.cell = this.cellPrefix + this.keyToRowsMap.get(key).toString();\n                fText = fText.substring(1);\n                try {\n                    fInfo.setParsedFormula(this.parser.parseFormula(fText, key));\n                }\n                catch (ex) {\n                    var args = {\n                        message: ex.message, exception: ex, isForceCalculable: false,\n                        computeForceCalculate: false\n                    };\n                    this.trigger('onFailure', args);\n                    fInfo.setFormulaValue(args.message);\n                    return this.storedData.get(key).getFormulaValue();\n                }\n                try {\n                    fInfo.setFormulaValue(this.computeFormula(fInfo.getParsedFormula()));\n                }\n                catch (ex) {\n                    var args = {\n                        message: ex.message, exception: ex, isForceCalculable: false,\n                        computeForceCalculate: false\n                    };\n                    this.trigger('onFailure', args);\n                    var errorMessage = (typeof args.exception === 'string') ? args.exception : args.message;\n                    return (isNullOrUndefined(this.getErrorLine(ex)) ? '' : '#' + this.getErrorLine(ex) + ': ') + errorMessage;\n                }\n            }\n            return this.storedData.get(key).getFormulaValue();\n        }\n        else {\n            return this.emptyString;\n        }\n    };\n    Calculate.prototype.getNamedRanges = function () {\n        return this.namedRanges;\n    };\n    /**\n     * Adds a named range to the NamedRanges collection.\n     * @param {string} name - Name of the named range.\n     * @param {string} range - Range for the specified name.\n     * @param {number} sheetIndex - Defined scope for the specified name. Default - Workbook scope.\n     * @returns boolean\n     */\n    Calculate.prototype.addNamedRange = function (name, range) {\n        var sheetScopeName = name.split(this.sheetToken);\n        if (sheetScopeName.length > 1) {\n            var family = this.getSheetFamilyItem(this.grid);\n            if (!family.parentObjectToToken.get(sheetScopeName[0])) {\n                return false;\n            }\n            name = sheetScopeName[0] + this.sheetToken + sheetScopeName[1].toUpperCase();\n        }\n        else {\n            name = name.toUpperCase();\n        }\n        this.namedRanges.set(name, range);\n        return true;\n    };\n    /**\n     * Remove the specified named range form the named range collection.\n     * @param {string} name - Name of the specified named range.\n     * @returns boolean\n     */\n    Calculate.prototype.removeNamedRange = function (name) {\n        name = name.toUpperCase();\n        if (this.namedRanges.get(name) != null) {\n            this.namedRanges.delete(name);\n            return true;\n        }\n        return false;\n    };\n    /** @hidden */\n    Calculate.prototype.convertAlpha = function (col) {\n        var arrCol = [];\n        var n = 0;\n        var charText = 'A';\n        while (col > 0) {\n            col--;\n            var aCharValue = charText.charCodeAt(0);\n            arrCol[n] = String.fromCharCode(col % 26 + aCharValue);\n            col = parseInt((col / 26).toString(), 10);\n            n++;\n        }\n        return arrCol.join('');\n    };\n    /** @hidden */\n    Calculate.prototype.getCellCollection = function (cellRange) {\n        if (cellRange.indexOf(':') < 0) {\n            if (!this.isCellReference(cellRange)) {\n                return cellRange.split(this.getParseArgumentSeparator());\n            }\n            else {\n                cellRange = cellRange + ':' + cellRange;\n            }\n        }\n        var token = this.emptyString;\n        var sheetTokenIndex = cellRange.indexOf(this.sheetToken);\n        if (sheetTokenIndex > -1) {\n            var index = sheetTokenIndex;\n            var s = index + 1;\n            while (s < cellRange.length) {\n                if (cellRange[s] === this.sheetToken) {\n                    token = cellRange.substr(0, s + 1);\n                    break;\n                }\n                s++;\n            }\n        }\n        var i = cellRange.indexOf(':');\n        var row1;\n        var row2;\n        var col1;\n        var col2;\n        if (i > 0 && this.isChar(cellRange[i - 1])) {\n            var k = i - 2;\n            while (k >= 0 && this.isDigit(cellRange[k])) {\n                k--;\n            }\n        }\n        row1 = this.rowIndex(this.substring(cellRange, 0, i));\n        row2 = this.rowIndex(this.substring(cellRange, i + 1, i + cellRange.length - i - 1));\n        col1 = this.colIndex(this.substring(cellRange, 0, i));\n        col2 = this.colIndex(this.substring(cellRange, i + 1, i + cellRange.length - i - 1));\n        if (row1 > row2) {\n            i = row2;\n            row2 = row1;\n            row1 = i;\n        }\n        if (col1 > col2) {\n            i = col2;\n            col2 = col1;\n            col1 = i;\n        }\n        var cells = [];\n        var j;\n        var c = 0;\n        for (i = row1; i <= row2; i++) {\n            for (j = col1; j <= col2; j++) {\n                cells[c] = token + this.emptyString + this.convertAlpha(j) + i.toString();\n                c++;\n            }\n        }\n        return cells;\n    };\n    /**\n     * Compute the given formula.\n     * @param {string} formulaText - Specifies to compute the given formula.\n     * @returns string | number\n     */\n    Calculate.prototype.computeFormula = function (formulaText) {\n        var parsedText;\n        var lastIndexOfq;\n        var formulatResult;\n        var nestedFormula = false;\n        var fNested;\n        if (this.parser.isError) {\n            return formulaText;\n        }\n        if (!this.parser.isFormulaParsed) {\n            parsedText = this.parser.parseFormula(formulaText);\n        }\n        else {\n            parsedText = formulaText;\n        }\n        this.parser.isFormulaParsed = false;\n        try {\n            lastIndexOfq = this.findLastIndexOfq(parsedText);\n            if (lastIndexOfq > 0) {\n                nestedFormula = true;\n            }\n            if (parsedText !== this.emptyString && lastIndexOfq > -1) {\n                var i = lastIndexOfq + 1;\n                while (i > -1) {\n                    if (parsedText[i] !== this.rightBracket) {\n                        i++;\n                        continue;\n                    }\n                    var sFormula = parsedText.substring(lastIndexOfq, i + 1);\n                    var libFormula = sFormula.split(this.leftBracket)[0].split('q').join(this.emptyString);\n                    var args = sFormula.substring(sFormula.indexOf(this.leftBracket) + 1, sFormula.indexOf(this.rightBracket))\n                        .split(this.getParseArgumentSeparator());\n                    if (this.getLibraryFormulas().get(libFormula.toUpperCase()).isCustom) {\n                        var j = 0;\n                        var customArgs = [];\n                        for (j = 0; j < args.length; j++) {\n                            customArgs.push(this.getValueFromArg(args[j]));\n                        }\n                        args = customArgs;\n                    }\n                    formulatResult = isNullOrUndefined(this.getFunction(libFormula)) ? this.getErrorStrings()[CommonErrors.name] : this.getFunction(libFormula).apply(void 0, args);\n                    if (nestedFormula) {\n                        fNested = this.processNestedFormula(parsedText, sFormula, formulatResult);\n                        var q = this.findLastIndexOfq(fNested);\n                        if (q === 0) {\n                            nestedFormula = false;\n                        }\n                        if (q === -1) {\n                            formulatResult = this.computeValue(fNested);\n                        }\n                        lastIndexOfq = i = q;\n                        parsedText = fNested;\n                        continue;\n                    }\n                    break;\n                }\n            }\n            else if (this.formulaErrorStrings.indexOf(parsedText) > -1) {\n                formulatResult = parsedText;\n            }\n            else if (parsedText !== this.emptyString && lastIndexOfq === -1) {\n                formulatResult = this.computeValue(parsedText);\n            }\n        }\n        catch (ex) {\n            var args = { message: ex.message, exception: ex, isForceCalculable: false, computeForceCalculate: false };\n            this.trigger('onFailure', args);\n            var errorMessage = (typeof args.exception === 'string') ? args.exception : args.message;\n            formulatResult = (isNullOrUndefined(this.getErrorLine(ex)) ? '' : '#' + this.getErrorLine(ex) + ': ') + errorMessage;\n        }\n        return formulatResult;\n    };\n    /** @hidden */\n    Calculate.prototype.computeSumIfAndAvgIf = function (range) {\n        if (isNullOrUndefined(range) || range[0] === this.emptyString || range.length === 0) {\n            return this.formulaErrorStrings[FormulasErrorsStrings.wrong_number_arguments];\n        }\n        var argArr = range;\n        var argCount = argArr.length;\n        if (argCount !== 2 && argCount !== 3 && argCount === 0) {\n            return this.formulaErrorStrings[FormulasErrorsStrings.wrong_number_arguments];\n        }\n        var rangevalue = argArr[0];\n        var criteria = argArr[1].trim();\n        criteria = criteria.split(this.tic).join(this.emptyString);\n        if (criteria.length > 255) {\n            return this.getErrorStrings()[CommonErrors.value];\n        }\n        var opt = this.parser.tokenEqual;\n        if (criteria.startsWith('<=')) {\n            opt = this.parser.tokenLessEq;\n            criteria = criteria.substring(2);\n        }\n        else if (criteria.startsWith('>=')) {\n            opt = this.parser.tokenGreaterEq;\n            criteria = criteria.substring(2);\n        }\n        else if (criteria.startsWith('<>')) {\n            opt = this.parser.tokenNotEqual;\n            criteria = criteria.substring(2);\n        }\n        else if (criteria.startsWith('<')) {\n            opt = this.parser.tokenLess;\n            criteria = criteria.substring(1);\n        }\n        else if (criteria.startsWith('>')) {\n            opt = this.parser.tokenGreater;\n            criteria = criteria.substring(1);\n        }\n        else if (criteria.startsWith('=')) {\n            opt = this.parser.tokenEqual;\n            criteria = criteria.substring(1);\n        }\n        var checkCriteria = this.parseFloat(criteria);\n        var criteriaRangeArray = argArr[0];\n        var sumRange = this.getCellCollection(argCount > 2 ? argArr[2] : rangevalue);\n        var criteriaRange = this.getCellCollection(criteriaRangeArray);\n        var result = this.getComputeSumIfValue(criteriaRange, sumRange, criteria, checkCriteria, opt);\n        return [result[0], result[1]];\n    };\n    /** @hidden */\n    Calculate.prototype.computeLookup = function (range) {\n        if (range.length === 0) {\n            return this.formulaErrorStrings[FormulasErrorsStrings.wrong_number_arguments];\n        }\n        var checkCrte = [];\n        var findMaxVal = [];\n        var argArr = range;\n        var argCount = argArr.length;\n        var criterias = argArr[0].split(this.tic).join(this.emptyString);\n        var rangevalue = argArr[1];\n        var lookupRangeArray = argCount === 2 ? rangevalue : argArr[2];\n        var criteriaRange = this.getCellCollection(argArr[1]);\n        var lookupRange = this.getCellCollection(lookupRangeArray);\n        for (var i = 0; i < criteriaRange.length; i++) {\n            findMaxVal[i] = this.getValueFromArg(criteriaRange[i]).split(this.tic).join('');\n        }\n        var s = findMaxVal.toString().split(this.getParseArgumentSeparator());\n        var maxVal = this.parseFloat(s[s.sort().length - 1]);\n        var minVal = this.parseFloat(s[0]);\n        for (var j = 0; j < criteriaRange.length; j++) {\n            checkCrte[j] = this.getValueFromArg(criteriaRange[j]).split(this.tic).join('');\n            if (criterias === checkCrte[j]) {\n                return this.getValueFromArg(lookupRange[j]).split(this.tic).join('');\n            }\n            else if (this.parseFloat(criterias) === this.parseFloat(checkCrte[j])) {\n                return this.getValueFromArg(lookupRange[j]).split(this.tic).join('');\n            }\n            else if (this.parseFloat(criterias) < minVal) {\n                return this.getErrorStrings()[CommonErrors.na];\n            }\n            else if (this.parseFloat(criterias) > maxVal) {\n                var index = findMaxVal.indexOf(maxVal.toString());\n                return this.getValueFromArg(lookupRange[index]).split(this.tic).join('');\n            }\n        }\n        if (findMaxVal.indexOf(criterias) < 0) {\n            var temp = [];\n            for (var n = 0; n < s.length; n++) {\n                if (this.parseFloat(criterias) > this.parseFloat(s[n])) {\n                    temp.push(s[n]);\n                }\n            }\n            var index = findMaxVal.indexOf(temp[temp.length - 1]);\n            return this.getValueFromArg(lookupRange[index]).split(this.tic).join('');\n        }\n        return this.getErrorStrings()[CommonErrors.na];\n    };\n    Calculate.prototype.computeVLookup = function (range) {\n        var argArr = range;\n        var findMaxValue = [];\n        var lookupValue = argArr[0].split(this.tic).join('');\n        if (lookupValue.indexOf(':') > -1) {\n            return this.getErrorStrings()[CommonErrors.value];\n        }\n        if (this.isCellReference(lookupValue)) {\n            lookupValue = this.getValueFromArg(lookupValue);\n        }\n        if (argArr[1].indexOf(':') < -1) {\n            return this.getErrorStrings()[CommonErrors.na];\n        }\n        var lookupRange = [];\n        var firstCol = '';\n        var secCol = '';\n        if (this.isCellReference(argArr[1])) {\n            lookupRange = this.getCellCollection(argArr[1]);\n            if (argArr[1].indexOf(':') > -1) {\n                var index = argArr[1].indexOf(':');\n                for (var i = 0; i < index; i++) {\n                    var tempCell = this.isChar(argArr[1][i]) ? argArr[1][i] : '';\n                    firstCol = firstCol + tempCell;\n                }\n                for (var j = index; j < argArr[1].length; j++) {\n                    var tempCell2 = this.isChar(argArr[1][j]) ? argArr[1][j] : '';\n                    secCol = secCol + tempCell2;\n                }\n            }\n        }\n        var lookupCol = this.colIndex(firstCol) + this.parseFloat(argArr[2]);\n        if (lookupCol > this.colIndex(secCol)) {\n            return this.getErrorStrings()[CommonErrors.na];\n        }\n        if (lookupCol === this.colIndex(firstCol)) {\n            return this.getErrorStrings()[CommonErrors.na];\n        }\n        var lookupCell = this.convertAlpha(lookupCol);\n        argArr[3] = isNullOrUndefined(argArr[3]) ? this.trueValue : argArr[3].split(this.tic).join('');\n        var cellValue = '';\n        for (var i = 0; i < lookupRange.length; i++) {\n            findMaxValue[i] = this.getValueFromArg(lookupRange[i]).split(this.tic).join('');\n        }\n        var s = findMaxValue.toString().split(this.getParseArgumentSeparator());\n        var maxValue = this.parseFloat(s[s.sort().length - 1]);\n        var minValue = this.parseFloat(s[0]);\n        for (var j = 0; j < lookupRange.length; j++) {\n            cellValue = this.getValueFromArg(lookupRange[j]);\n            if (argArr[3].toUpperCase() === this.trueValue) {\n                if (lookupValue === cellValue) {\n                    return this.getValueFromArg(lookupCell + j).split(this.tic).join('');\n                }\n                else if (this.parseFloat(lookupValue) === this.parseFloat(cellValue)) {\n                    return this.getValueFromArg(lookupCell + j).split(this.tic).join('');\n                }\n                else if (this.parseFloat(lookupValue) < minValue) {\n                    return this.getErrorStrings()[CommonErrors.na];\n                }\n                else if (this.parseFloat(lookupValue) > maxValue) {\n                    var index = findMaxValue.indexOf(maxValue.toString());\n                    return this.getValueFromArg(lookupCell + index).split(this.tic).join('');\n                }\n            }\n            if (argArr[3] === this.falseValue) {\n                if (lookupValue === cellValue) {\n                    return this.getValueFromArg(lookupCell + j);\n                }\n            }\n        }\n        return this.getErrorStrings()[CommonErrors.na];\n    };\n    Calculate.prototype.findWildCardValue = function (lookVal, cellValue) {\n        var finalText = '';\n        if (lookVal.indexOf('?') > -1) {\n            var index = lookVal.indexOf('?');\n            var checStr1 = lookVal[index - 1];\n            var checStr2 = lookVal[index + 1];\n            if (cellValue.indexOf(checStr1) > -1 && cellValue.indexOf(checStr2) > -1) {\n                var newIndex = cellValue.indexOf(checStr1);\n                if (cellValue[newIndex] === checStr1 && cellValue[newIndex + 2] === checStr2) {\n                    finalText = lookVal;\n                }\n                else {\n                    finalText = cellValue;\n                }\n            }\n            else {\n                finalText = cellValue;\n            }\n        }\n        else if (lookVal.indexOf('*') > -1) {\n            var index = lookVal.indexOf('*');\n            var left = '';\n            var right = '';\n            var compRight = this.falseValue;\n            var compLeft = this.falseValue;\n            for (var i = index - 1; i >= 0; i--) {\n                left = left + lookVal[i];\n                compLeft = this.trueValue;\n            }\n            for (var i = index + 1; i < lookVal.length; i++) {\n                right = right + lookVal[i];\n                compRight = this.trueValue;\n            }\n            var leftVal = left === '' ? -1 : cellValue.indexOf(left.split('').reverse().join(''));\n            var rightVal = right === '' ? -1 : cellValue.indexOf(right);\n            if (leftVal > -1 || rightVal > -1) {\n                if (compLeft === this.trueValue) {\n                    finalText = (left.split('').reverse().join('') === cellValue.substr(0, left.length)) ? lookVal : cellValue;\n                }\n                else if (compRight === this.trueValue) {\n                    finalText = (right === cellValue.substring(cellValue.length - right.length, cellValue.length)) ? lookVal : cellValue;\n                }\n            }\n            else {\n                finalText = cellValue;\n            }\n        }\n        return finalText;\n    };\n    /** @hidden */\n    /* tslint:disable-next-line */\n    Calculate.prototype.getComputeSumIfValue = function (criteriaRange, sumRange, criteria, checkCriteria, op) {\n        var sum = 0;\n        var count = 0;\n        switch (op) {\n            case this.parser.tokenEqual:\n                {\n                    for (var i = 0; i < criteriaRange.length; i++) {\n                        var value = this.getValueFromArg(criteriaRange[i].split(this.tic).join(''));\n                        var val = this.parseFloat(value);\n                        if (value === criteria && val === checkCriteria) {\n                            var value1 = this.getValueFromArg(sumRange[i].split(this.tic).join(''));\n                            var val1 = this.parseFloat(value1);\n                            sum = sum + val1;\n                            count = count + 1;\n                        }\n                        else if (value === criteria) {\n                            var sumRangeVal = sumRange[i];\n                            sumRangeVal = this.getValueFromArg(sumRangeVal);\n                            sum = this.parseFloat(sumRangeVal.toString());\n                            count = count + 1;\n                        }\n                    }\n                }\n                break;\n            case this.parser.tokenLess:\n                {\n                    for (var i = 0; i < criteriaRange.length; i++) {\n                        var value = this.getValueFromArg(criteriaRange[i].split(this.tic).join(''));\n                        var val = this.parseFloat(value);\n                        if (val < checkCriteria) {\n                            var value1 = this.getValueFromArg(sumRange[i].split(this.tic).join(''));\n                            var val1 = this.parseFloat(value1);\n                            sum = sum + val1;\n                            count = count + 1;\n                        }\n                    }\n                }\n                break;\n            case this.parser.tokenGreater:\n                {\n                    for (var i = 0; i < criteriaRange.length; i++) {\n                        var value = this.getValueFromArg(criteriaRange[i].split(this.tic).join(''));\n                        var val = this.parseFloat(value);\n                        if (val > checkCriteria) {\n                            var value1 = this.getValueFromArg(sumRange[i].split(this.tic).join(''));\n                            var val1 = this.parseFloat(value1);\n                            sum = sum + val1;\n                            count = count + 1;\n                        }\n                    }\n                }\n                break;\n            case this.parser.tokenLessEq:\n                {\n                    for (var i = 0; i < criteriaRange.length; i++) {\n                        var value = this.getValueFromArg(criteriaRange[i].split(this.tic).join(''));\n                        var val = this.parseFloat(value);\n                        if (val <= checkCriteria) {\n                            var value1 = this.getValueFromArg(sumRange[i].split(this.tic).join(''));\n                            var val1 = this.parseFloat(value1);\n                            sum = sum + val1;\n                            count = count + 1;\n                        }\n                    }\n                }\n                break;\n            case this.parser.tokenGreaterEq:\n                {\n                    for (var i = 0; i < criteriaRange.length; i++) {\n                        var value = this.getValueFromArg(criteriaRange[i].split(this.tic).join(''));\n                        var val = this.parseFloat(value);\n                        if (val >= checkCriteria) {\n                            var value1 = this.getValueFromArg(sumRange[i].split(this.tic).join(''));\n                            var val1 = this.parseFloat(value1);\n                            sum = sum + val1;\n                            count = count + 1;\n                        }\n                    }\n                }\n                break;\n            case this.parser.tokenNotEqual:\n                {\n                    for (var i = 0; i < criteriaRange.length; i++) {\n                        var value = this.getValueFromArg(criteriaRange[i].split(this.tic).join(''));\n                        var val = this.parseFloat(value);\n                        if (value !== criteria && val !== checkCriteria) {\n                            var value1 = this.getValueFromArg(sumRange[i].split(this.tic).join(''));\n                            var val1 = this.parseFloat(value1);\n                            sum = sum + val1;\n                            count = count + 1;\n                        }\n                    }\n                }\n                break;\n        }\n        return [sum, count];\n    };\n    /** @hidden */\n    Calculate.prototype.computeAndOr = function (args, op) {\n        var result = op === 'and' ? true : false;\n        var value;\n        var parseVal;\n        if (args.length === 0) {\n            return this.formulaErrorStrings[FormulasErrorsStrings.wrong_number_arguments];\n        }\n        for (var l = 0, len = args.length; l < len; l++) {\n            if (args[l].split(this.tic).join('').trim() === this.emptyString) {\n                return this.getErrorStrings()[CommonErrors.value];\n            }\n        }\n        var ranges = args;\n        for (var i = 0; i < ranges.length; i++) {\n            if (ranges[i] === (this.tic)) {\n                return this.getErrorStrings()[CommonErrors.value];\n            }\n            if (ranges[i].indexOf(':') > -1 && this.isCellReference(ranges[i])) {\n                var cells = this.getCellCollection(ranges[i]);\n                for (var j = 0; j < cells.length; j++) {\n                    if (this.getErrorStrings().indexOf(cells[j]) > -1) {\n                        return cells[j];\n                    }\n                    else if (cells[j][0] === this.tic) {\n                        return this.getErrorStrings()[CommonErrors.name];\n                    }\n                    value = this.getValueFromArg(cells[j]);\n                    if (value === '') {\n                        value = this.trueValue;\n                    }\n                    if (this.getErrorStrings().indexOf(value) > -1) {\n                        return value;\n                    }\n                    parseVal = this.parseFloat(value);\n                }\n            }\n            else {\n                value = this.getValueFromArg(ranges[i]).split(this.tic).join('').toUpperCase();\n                if (this.getErrorStrings().indexOf(value) > -1) {\n                    return value;\n                }\n                var tempdate = Date.parse(value.split(this.tic).join(''));\n                if (!isNaN(tempdate)) {\n                    result = true;\n                }\n                else if (!(value === this.trueValue || value === this.falseValue)) {\n                    return this.getErrorStrings()[CommonErrors.value].toString();\n                }\n                parseVal = this.parseFloat(value);\n            }\n            result = op === 'and' ? (result && ((value === this.trueValue) || !(isNaN(parseVal)))) :\n                (result || ((value === this.trueValue) || !(isNaN(parseVal))));\n        }\n        return result ? this.trueValue : this.falseValue;\n    };\n    /** @hidden */\n    // To strip out the tic from the formula arguments.\n    Calculate.prototype.removeTics = function (text) {\n        if (text.length > 1 && text[0] === this.tic[0] && text[text.length - 1] === this.tic[0]) {\n            text = this.substring(text, 1, text.length - 2);\n        }\n        return text;\n    };\n    /** @hidden */\n    Calculate.prototype.getCellFrom = function (range) {\n        var cellRange = '';\n        var cells = range.indexOf(':') > -1 ? range.split(':') : [range];\n        //this.getCellsFromArgs(range);\n        var last = cells.length - 1;\n        var r1 = this.rowIndex(cells[0]);\n        var x;\n        if (r1 === this.rowIndex(cells[last])) {\n            var c1 = this.colIndex(cells[0]);\n            var c2 = this.colIndex(cells[last]);\n            var c = this.colIndex(this.cell);\n            if (c >= c1 && c <= c2) {\n                cellRange = getAlphalabel(c).toString() + r1.toString();\n            }\n        }\n        else if (this.colIndex(cells[0]) === this.colIndex(cells[last])) {\n            x = this.colIndex(cells[0]);\n            var r2 = this.rowIndex(cells[last]);\n            var r = this.rowIndex(this.cell);\n            if (r >= r1 && r <= r2) {\n                cellRange = getAlphalabel(x).toString() + r.toString();\n            }\n        }\n        return cellRange;\n    };\n    /* tslint:disable-next-line:max-func-body-length */\n    Calculate.prototype.computeValue = function (pFormula) {\n        try {\n            var stack = [];\n            var i = 0;\n            var sheet = '';\n            stack.length = 0;\n            while (i < pFormula.length) {\n                var uFound = pFormula[i] === 'u'; // for 3*-2\n                if (pFormula[i] === this.arithMarker) {\n                    i = i + 1;\n                    continue;\n                }\n                else if (this.isDigit(pFormula[i])) {\n                    var s = this.emptyString;\n                    while (i < pFormula.length && this.isDigit(pFormula[i])) {\n                        s = s + pFormula[i];\n                        i = i + 1;\n                    }\n                    stack.push(s);\n                }\n                if (pFormula[i] === this.sheetToken) {\n                    sheet = pFormula[i];\n                    i = i + 1;\n                    while (i < pFormula.length && pFormula[i] !== this.sheetToken) {\n                        sheet = sheet + pFormula[i];\n                        i = i + 1;\n                    }\n                    if (i < pFormula.length) {\n                        sheet = sheet + pFormula[i];\n                        i = i + 1;\n                    }\n                }\n                else if (this.isUpperChar(pFormula[i])) {\n                    var s = this.emptyString;\n                    var textName = '';\n                    while (i < pFormula.length && this.isUpperChar(pFormula[i])) {\n                        var char = pFormula[i];\n                        s = s + char;\n                        i = i + 1;\n                    }\n                    while (i < pFormula.length && this.isDigit(pFormula[i])) {\n                        var digit = pFormula[i];\n                        s = s + digit;\n                        i = i + 1;\n                    }\n                    if (i < pFormula.length && pFormula[i] === ':') {\n                        s = s + pFormula[i];\n                        i = i + 1;\n                        if (i < pFormula.length && pFormula[i] === this.sheetToken) {\n                            s = s + pFormula[i];\n                            i = i + 1;\n                            while (i < pFormula.length && pFormula[i] !== this.sheetToken) {\n                                s = s + pFormula[i];\n                                i = i + 1;\n                            }\n                        }\n                        while (i < pFormula.length && this.isUpperChar(pFormula[i])) {\n                            s = s + pFormula[i];\n                            i = i + 1;\n                        }\n                        while (i < pFormula.length && this.isDigit(pFormula[i])) {\n                            s = s + pFormula[i];\n                            i = i + 1;\n                        }\n                        s = sheet + this.getCellFrom(s);\n                    }\n                    else {\n                        s = sheet + s;\n                    }\n                    textName = this.getParentObjectCellValue(s).toString();\n                    if (typeof textName === 'string' && this.getErrorStrings().indexOf(textName) > -1) {\n                        return textName;\n                    }\n                    stack.push(textName);\n                }\n                else if (pFormula[i] === 'q') {\n                    var leftIdx = pFormula.substring(i + 1).indexOf(this.leftBracket);\n                    var j = pFormula.substring(i + leftIdx + 1).indexOf(this.rightBracket);\n                    pFormula = this.substring(pFormula, i + leftIdx + 2, j - 1);\n                }\n                else if (pFormula[i] === this.tic[0]) {\n                    var s = pFormula[i].toString();\n                    i = i + 1;\n                    while (i < pFormula.length && pFormula[i] !== this.tic[0]) {\n                        s = s + pFormula[i];\n                        i = i + 1;\n                    }\n                    stack.push(s.split(this.tic).join(this.emptyString));\n                    i = i + 1;\n                }\n                else if (pFormula[i] === '%' && stack.length > 0) {\n                    var stackValue = stack[0];\n                    var value = this.parseFloat(stackValue);\n                    if (!this.isNaN(value)) {\n                        stack.pop();\n                        stack.push((value / 100).toString());\n                    }\n                    i = i + 1;\n                }\n                else if ((pFormula.substring(i)).indexOf(this.trueValue) === 0) {\n                    stack.push(this.trueValue);\n                    i += this.trueValue.length;\n                }\n                else if (pFormula.substring(i).indexOf(this.falseValue) === 0) {\n                    stack.push(this.falseValue);\n                    i += this.falseValue.length;\n                }\n                else if (pFormula[i] === this.tic[0] || pFormula[i] === '|') {\n                    var s = pFormula[i].toString();\n                    i++;\n                    while (i < pFormula.length && pFormula[i] !== this.tic[0]) {\n                        s = s + pFormula[i];\n                        i = i + 1;\n                    }\n                    stack.push(s + this.tic);\n                    i += 1;\n                }\n                else {\n                    switch (pFormula[i]) {\n                        case '#':\n                            {\n                                var errIndex = 0;\n                                if (this.getErrorStrings().indexOf(pFormula.substring(i)) > -1) {\n                                    if (pFormula.indexOf('!') === -1 || pFormula.substring(i).indexOf('!') === -1) {\n                                        errIndex = pFormula.indexOf('#N/A') > -1 ?\n                                            (pFormula.indexOf('#N/A') + 4 + i) : pFormula.indexOf('?') + 1 + i;\n                                    }\n                                    else {\n                                        errIndex = pFormula.indexOf('!') + 1 + i;\n                                    }\n                                    stack.push(this.substring(pFormula, i, errIndex - i));\n                                }\n                                else {\n                                    errIndex = i + 1;\n                                    stack.push(this.substring(pFormula, i, errIndex - i));\n                                }\n                                i = errIndex;\n                            }\n                            break;\n                        case 'n':\n                            {\n                                i = i + 1;\n                                var s = '';\n                                if (pFormula.substring(i).indexOf('Infinity') === 0) {\n                                    s = 'Infinity';\n                                    i += s.length;\n                                }\n                                else {\n                                    if (pFormula[i] === 'u' || uFound) {\n                                        s = '-';\n                                        if (!uFound) {\n                                            i = i + 1;\n                                        }\n                                        else {\n                                            uFound = false;\n                                        }\n                                    }\n                                    while (i < pFormula.length && (this.isDigit(pFormula[i]))\n                                        || pFormula[i] === this.getParseDecimalSeparator()) {\n                                        s = s + pFormula[i];\n                                        i = i + 1;\n                                    }\n                                }\n                                stack.push(s);\n                            }\n                            break;\n                        case this.parser.tokenAdd:\n                            {\n                                this.getValArithmetic(stack, 'add');\n                                i = i + 1;\n                            }\n                            break;\n                        case this.parser.tokenSubtract:\n                            {\n                                this.getValArithmetic(stack, 'sub');\n                                i = i + 1;\n                            }\n                            break;\n                        case this.parser.tokenMultiply:\n                            {\n                                this.getValArithmetic(stack, 'mul');\n                                i = i + 1;\n                            }\n                            break;\n                        case this.parser.tokenDivide:\n                            {\n                                this.getValArithmetic(stack, 'div');\n                                i = i + 1;\n                            }\n                            break;\n                        case this.parser.tokenLess:\n                            {\n                                this.processLogical(stack, 'less');\n                                i = i + 1;\n                            }\n                            break;\n                        case this.parser.tokenGreater:\n                            {\n                                this.processLogical(stack, 'greater');\n                                i = i + 1;\n                            }\n                            break;\n                        case this.parser.tokenGreaterEq:\n                            {\n                                this.processLogical(stack, 'greaterEq');\n                                i = i + 1;\n                            }\n                            break;\n                        case this.parser.tokenLessEq:\n                            {\n                                this.processLogical(stack, 'lessEq');\n                                i = i + 1;\n                            }\n                            break;\n                        case this.parser.tokenNotEqual:\n                            {\n                                this.processLogical(stack, 'notEq');\n                                i = i + 1;\n                            }\n                            break;\n                        case this.parser.tokenOr:\n                            {\n                                this.processLogical(stack, 'or');\n                                i = i + 1;\n                            }\n                            break;\n                        case this.parser.tokenAnd:\n                            {\n                                this.processLogical(stack, 'and');\n                                i = i + 1;\n                            }\n                            break;\n                        case this.parser.tokenEqual:\n                            {\n                                this.processLogical(stack, 'equal');\n                                i = i + 1;\n                            }\n                            break;\n                        default: {\n                            return this.getErrorStrings()[CommonErrors.value];\n                        }\n                    }\n                }\n            }\n            if (stack.length === 0) {\n                return this.emptyString;\n            }\n            else {\n                var s = this.emptyString;\n                var countValue = stack.length;\n                while (countValue > 0) {\n                    s = stack.pop() + s;\n                    if (s === this.emptyString && this.isCellReference(pFormula) &&\n                        this.getTreatEmptyStringAsZero()) {\n                        return '0';\n                    }\n                    countValue--;\n                }\n                return s;\n            }\n        }\n        catch (ex) {\n            if (this.getErrorStrings().indexOf(ex) > -1 || this.formulaErrorStrings.indexOf(ex) > -1) {\n                throw ex;\n            }\n            throw new FormulaError(this.formulaErrorStrings[FormulasErrorsStrings.invalid_expression]);\n        }\n    };\n    Calculate.prototype.getValArithmetic = function (stack, operator) {\n        var num1 = stack.pop();\n        num1 = num1 === this.emptyString ? '0' : num1;\n        var num = Number(num1);\n        if (isNaN(num)) {\n            if (num1 === this.getErrorStrings()[CommonErrors.divzero]) {\n                throw this.getErrorStrings()[CommonErrors.divzero];\n            }\n            else {\n                throw this.getErrorStrings()[CommonErrors.value];\n            }\n        }\n        var num2 = stack.pop();\n        num2 = num2 === this.emptyString ? (stack.length ? stack.pop() : '0') : num2;\n        num = Number(num2);\n        if (isNaN(num)) {\n            if (num1 === this.getErrorStrings()[CommonErrors.divzero]) {\n                throw this.getErrorStrings()[CommonErrors.divzero];\n            }\n            else {\n                throw this.getErrorStrings()[CommonErrors.value];\n            }\n        }\n        if (operator === 'add') {\n            stack.push((Number(num2) + Number(num1)).toString());\n        }\n        if (operator === 'sub') {\n            stack.push((Number(num2) - Number(num1)).toString());\n        }\n        if (operator === 'mul') {\n            stack.push((Number(num2) * Number(num1)).toString());\n        }\n        if (operator === 'div') {\n            if (this.isNaN(this.parseFloat(num1)) || this.isNaN(this.parseFloat(num2))) {\n                stack.push(this.getErrorStrings()[CommonErrors.value]);\n            }\n            else if (this.parseFloat(num1) === 0) {\n                stack.push(this.getErrorStrings()[CommonErrors.divzero]);\n            }\n            else {\n                stack.push((Number(num2) / Number(num1)).toString());\n            }\n        }\n    };\n    /** @hidden */\n    Calculate.prototype.processLogical = function (stack, operator) {\n        var val1;\n        var val2;\n        var value1;\n        var value2;\n        if (operator !== 'and' && operator !== 'equal') {\n            val1 = stack.pop();\n            val2 = stack.pop();\n            value1 = val1.indexOf(this.tic) > -1 ? val1 : this.parseFloat(val1);\n            value2 = val2.indexOf(this.tic) > -1 ? val2 : this.parseFloat(val2);\n        }\n        var result;\n        if (operator === 'less') {\n            if (!this.isNaN(value1) && !this.isNaN(value2)) {\n                result = (value2 < value1) ? this.trueValue : this.falseValue;\n            }\n            else {\n                result = (val2.toUpperCase().split(this.tic).join('').localeCompare(val1.toUpperCase().split(this.tic).join('')) < 0) ?\n                    this.trueValue : this.falseValue;\n            }\n        }\n        if (operator === 'greater') {\n            if (!this.isNaN(value1) && !this.isNaN(value2)) {\n                result = (value2 > value1) ? this.trueValue : this.falseValue;\n            }\n            else {\n                result = (val2.toUpperCase().split(this.tic).join('').localeCompare(val1.toUpperCase().split(this.tic).join('')) > 0) ?\n                    this.trueValue : this.falseValue;\n            }\n        }\n        if (operator === 'lessEq') {\n            if (!this.isNaN(value1) && !this.isNaN(value2)) {\n                result = (value2 <= value1) ? this.trueValue : this.falseValue;\n            }\n            else {\n                result = (val2.toUpperCase().split(this.tic).join('').localeCompare(val1.toUpperCase().split(this.tic).join('')) <= 0) ?\n                    this.trueValue : this.falseValue;\n            }\n        }\n        if (operator === 'greaterEq') {\n            if (!this.isNaN(value1) && !this.isNaN(value2)) {\n                result = (value2 >= value1) ? this.trueValue : this.falseValue;\n            }\n            else {\n                result = (val2.toUpperCase().split(this.tic).join('').localeCompare(val1.toUpperCase().split(this.tic).join('')) >= 0) ?\n                    this.trueValue : this.falseValue;\n            }\n        }\n        if (operator === 'notEq') {\n            result = (val2 !== val1) ? this.trueValue : this.falseValue;\n        }\n        if (operator === 'and') {\n            val1 = stack.pop().toString();\n            val2 = '';\n            if (stack.length > 0) {\n                val2 = stack.pop().toString();\n            }\n            result = this.emptyString + val2 + val1 + this.emptyString;\n            result = result.split(this.tic).join('');\n        }\n        if (operator === 'equal') {\n            val1 = stack.pop().toString();\n            val2 = stack.pop().toString();\n            if (val2 === '' && val1 !== '') {\n                val2 = '0';\n            }\n            result = val1 === val2 ? this.trueValue : this.falseValue;\n        }\n        if (operator === 'or') {\n            result = Math.pow(this.parseFloat(value2), this.parseFloat(value1)).toString();\n        }\n        stack.push(result);\n        return result;\n    };\n    /** @hidden */\n    Calculate.prototype.computeStoreCells = function (sCell) {\n        var cellValue = sCell.cellValue;\n        var cellRanges = sCell.cellRange;\n        var criterias = sCell.criteria;\n        var argArr = sCell.argArray;\n        var isCriteria = sCell.isCriteria;\n        var storeCell = sCell.storedCells;\n        var isCountIfs = sCell.isCountIfS;\n        var i = sCell.countVal;\n        var rangeLength = isCriteria === this.trueValue ? storeCell : cellValue;\n        var tempStoredCell = [];\n        for (var j = 0; j < rangeLength.length; j++) {\n            var stack = [];\n            var cellVal = this.getValueFromArg(cellValue[j]);\n            var criteria = void 0;\n            var newCell = '';\n            criteria = argArr[2].split(this.tic).join(this.emptyString);\n            isCriteria = isCountIfs === this.trueValue ? this.trueValue : isCriteria;\n            if (isCriteria === this.trueValue) {\n                var cell = '';\n                var count = 0;\n                var newCount = 0;\n                storeCell[j] = isCountIfs === this.trueValue && i === 0 ? cellValue[j] : storeCell[j];\n                cell = storeCell[j];\n                // convert the new cell ranges  for find in range with criteria.\n                while (!this.isDigit(cell[count])) {\n                    count = count + 1;\n                }\n                if (this.isCellReference(cellRanges[i]) && cellRanges[i].indexOf(':') > -1) {\n                    var k = cellRanges[i].indexOf(':');\n                    newCell = this.substring(cellRanges[i], k);\n                    while (!this.isDigit(newCell[newCount])) {\n                        newCount = newCount + 1;\n                    }\n                }\n                var cellAlpha = this.substring(cell, count);\n                var newCellAlpha = this.substring(newCell, newCount);\n                newCell = storeCell[j].split(cellAlpha).join(newCellAlpha);\n                cellVal = this.getValueFromArg(newCell);\n                criteria = isCountIfs === this.trueValue ? criterias[i].split(this.tic).join(this.emptyString) :\n                    criterias[i - 1].split(this.tic).join(this.emptyString);\n            }\n            var op = 'equal';\n            if (criteria.startsWith('<=')) {\n                op = 'lessEq';\n                criteria = criteria.substring(2);\n            }\n            else if (criteria.startsWith('>=')) {\n                op = 'greaterEq';\n                criteria = criteria.substring(2);\n            }\n            else if (criteria.startsWith('<>')) {\n                op = 'notEq';\n                criteria = criteria.substring(2);\n            }\n            else if (criteria.startsWith('<')) {\n                op = 'less';\n                criteria = criteria.substring(1);\n            }\n            else if (criteria.startsWith('>')) {\n                op = 'greater';\n                criteria = criteria.substring(1);\n            }\n            else if (criteria.startsWith('=')) {\n                op = 'equal';\n                criteria = criteria.substring(1);\n            }\n            if (criteria.indexOf('*') > -1 || criteria.indexOf('?') > -1) {\n                cellVal = this.findWildCardValue(criteria, cellVal);\n            }\n            stack.push(cellVal.toLowerCase());\n            stack.push(criteria.toLowerCase());\n            if (this.processLogical(stack, op) === this.trueValue) {\n                if (isCriteria === this.falseValue) {\n                    tempStoredCell.push(cellValue[j]);\n                }\n                else {\n                    tempStoredCell.push(newCell);\n                }\n            }\n        }\n        storeCell = tempStoredCell;\n        tempStoredCell = [];\n        return storeCell;\n    };\n    Calculate.prototype.computeIfsFormulas = function (range, isCountIfs, isAvgIfs) {\n        if (isNullOrUndefined(range) || range[0] === '' || range.length === 0) {\n            return this.formulaErrorStrings[FormulasErrorsStrings.wrong_number_arguments];\n        }\n        var argArr = range;\n        var argCount = argArr.length;\n        if (argCount < 2 || argCount > 127) {\n            return this.formulaErrorStrings[FormulasErrorsStrings.wrong_number_arguments];\n        }\n        var cellRanges = [];\n        var criterias = [];\n        var storedCell = [];\n        var storedCellLength = 0;\n        var sum = 0;\n        for (var i = 0; i < argArr.length; i++) {\n            if (argArr[i].indexOf(':') > -1 && this.isCellReference(argArr[i])) {\n                cellRanges.push(argArr[i]);\n            }\n            else {\n                criterias.push(argArr[i]);\n            }\n        }\n        cellRanges = cellRanges.toString().split(',,').join(',');\n        cellRanges = cellRanges.split(this.getParseArgumentSeparator());\n        var len = [];\n        for (var i = 0; i < cellRanges.length; i++) {\n            len.push(this.getCellCollection(cellRanges[i]).length);\n        }\n        for (var j = 0; j < len.length; j++) {\n            if (len[j] && len[j + 1] && len[j] !== len[j + 1]) {\n                return this.getErrorStrings()[CommonErrors.value];\n            }\n        }\n        var cellvalue;\n        var isCriteria;\n        if (isCountIfs === this.falseValue) {\n            isCriteria = this.falseValue;\n            cellvalue = this.getCellCollection(cellRanges[1]);\n            var sCell = {\n                cellValue: cellvalue, cellRange: cellRanges, criteria: criterias,\n                argArray: argArr, isCriteria: isCriteria, storedCells: storedCell, isCountIfS: isCountIfs\n            };\n            storedCell = this.computeStoreCells(sCell);\n            storedCellLength = storedCell.length;\n            if (storedCellLength === 0) {\n                return 0;\n            }\n        }\n        // Compare criteria and convert the new cell ranges.\n        var startRange;\n        startRange = isCountIfs === this.trueValue ? 0 : 2;\n        for (var i = startRange; i < cellRanges.length; i++) {\n            isCriteria = this.trueValue;\n            isCriteria = isCountIfs === this.trueValue && i === 0 ? this.falseValue : this.trueValue;\n            cellvalue = this.getCellCollection(cellRanges[i]);\n            var sCell = {\n                cellValue: cellvalue, cellRange: cellRanges, criteria: criterias,\n                argArray: argArr, isCriteria: isCriteria, storedCells: storedCell, isCountIfS: isCountIfs, countVal: i\n            };\n            storedCell = this.computeStoreCells(sCell);\n            storedCellLength = storedCell.length;\n            if (storedCellLength === 0) {\n                return 0;\n            }\n        }\n        for (var j = 0; j < storedCell.length; j++) {\n            // convert the new cell ranges  for find sum in range 0(first range)\n            var cell = '';\n            var newCell = '';\n            var count = 0;\n            var newCount = 0;\n            cell = storedCell[j];\n            while (!this.isDigit(cell[count])) {\n                count = count + 1;\n            }\n            if (this.isCellReference(cellRanges[0]) && cellRanges[0].indexOf(':') > -1) {\n                var k = cellRanges[0].indexOf(':');\n                newCell = this.substring(cellRanges[0], k);\n                while (!this.isDigit(newCell[newCount])) {\n                    newCount = newCount + 1;\n                }\n            }\n            var cellAlpha = this.substring(cell, count);\n            var newCellAlpha = this.substring(newCell, newCount);\n            cellvalue = storedCell[j].split(cellAlpha).join(newCellAlpha);\n            if (isCountIfs === this.trueValue) {\n                sum = sum + 1;\n            }\n            else {\n                var argValue = this.getValueFromArg(cellvalue);\n                sum = sum + parseFloat(argValue === '' ? '0' : argValue);\n            }\n        }\n        if (isAvgIfs === this.trueValue) {\n            sum = sum / cellvalue.length;\n        }\n        return sum;\n    };\n    Calculate.prototype.processNestedFormula = function (pText, sFormula, fResult) {\n        var lastIndexq = this.findLastIndexOfq(pText);\n        var interiorCalcFString = pText.split(sFormula).join('n' + fResult);\n        return interiorCalcFString;\n    };\n    /** @hidden */\n    Calculate.prototype.isNaN = function (value) {\n        if (value.toString() === 'NaN' || typeof value === 'string') {\n            return true;\n        }\n        return false;\n    };\n    /** @hidden */\n    Calculate.prototype.fromOADate = function (doubleNumber) {\n        var result = new Date();\n        result.setTime((doubleNumber * this.millisecondsOfaDay) + Date.parse(this.oaDate.toString()));\n        return result;\n    };\n    /** @hidden */\n    Calculate.prototype.getSerialDateFromDate = function (year, month, day) {\n        var days = 0;\n        if (year < 1900) {\n            year += 1900;\n        }\n        var isValidMonth = false;\n        while (!isValidMonth) {\n            while (month > 12) {\n                year++;\n                month -= 12;\n            }\n            isValidMonth = true;\n            var tempDay = new Date(year, month, 1, -1).getDate();\n            while (day > tempDay) {\n                tempDay = new Date(year, month, 1, -1).getDate();\n                month++;\n                day -= tempDay;\n                isValidMonth = false;\n            }\n            if (day < 1) {\n                month--;\n                tempDay = new Date(year, month, 1, -1).getDate();\n                day = tempDay - day;\n            }\n        }\n        var dateTime = Date.parse(year.toString() + this.getParseDateTimeSeparator() + month.toString() +\n            this.getParseDateTimeSeparator() + day.toString());\n        if (!this.isNaN(dateTime)) {\n            days = this.toOADate(new Date(dateTime));\n        }\n        return days;\n    };\n    /** @hidden */\n    Calculate.prototype.toOADate = function (dateTime) {\n        var result = (dateTime.getTime() - Date.parse(this.oaDate.toString())) / this.millisecondsOfaDay;\n        return result;\n    };\n    /** @hidden */\n    Calculate.prototype.calculateDate = function (date) {\n        return (this.parseFloat(date) < 10) ? '0' + date : date;\n    };\n    /** @hidden */\n    Calculate.prototype.isTextEmpty = function (s) {\n        return s === null || s === '';\n    };\n    /** @hidden */\n    Calculate.prototype.isDigit = function (text) {\n        var charCode = text.charCodeAt(0);\n        if ((charCode > 47) && (charCode < 58)) {\n            return true;\n        }\n        return false;\n    };\n    Calculate.prototype.findLastIndexOfq = function (fString) {\n        return fString.lastIndexOf('q');\n    };\n    /**\n     * To get the exact value from argument.\n     * @param {string} arg - Formula argument for getting a exact value.\n     * @returns string\n     */\n    Calculate.prototype.getValueFromArg = function (arg) {\n        arg = arg.trim();\n        var s = arg;\n        var dateTime = this.dateTime1900;\n        var pObjCVal = s;\n        if (isNullOrUndefined(s) || this.isTextEmpty(s)) {\n            return s;\n        }\n        else if (arg[0] === this.tic || arg[0] === this.singleTic) {\n            dateTime = this.isDate(arg.split(this.tic).join(''));\n            if (this.isNaN(this.parseFloat(arg.split(this.tic).join(''))) && !isNullOrUndefined(dateTime) &&\n                !this.isNaN(dateTime.getDate()) && this.dateTime1900 <= dateTime) {\n                return this.toOADate(dateTime).toString();\n            }\n            return arg;\n        }\n        else {\n            arg = arg.split('u').join('-');\n            /* tslint:disable:max-line-length */\n            if (!this.isUpperChar(s[0]) && (this.isDigit(s[0]) || s[0] === this.getParseDecimalSeparator() || s[0] === '-' || s[0] === 'n')) {\n                if (s[0] === 'n') {\n                    s = s.substring(1);\n                    if (s.indexOf('\"n') > -1) {\n                        s = s.replace('\"n', '\"');\n                    }\n                }\n                return s;\n            }\n        }\n        var symbolArray = ['+', '-', '/', '*', ')', ')', '{'];\n        if ((this.parser.indexOfAny(s, symbolArray) === -1 && this.isUpperChar(s[0])) || s[0] === this.sheetToken) {\n            if (s !== this.trueValue && s !== this.falseValue && this.isCellReference(s)) {\n                var f = this.getSheetFamilyItem(this.grid);\n                if (f.sheetNameToParentObject !== null && f.sheetNameToParentObject.size > 0 && s.indexOf(this.sheetToken) === -1) {\n                    var token = f.parentObjectToToken.get(this.grid);\n                    s = token + s;\n                }\n            }\n            if (s === this.cell) {\n                var dependent = this.getDependentCells().get(s);\n                if (dependent != null && dependent.indexOf(s) > -1) {\n                    this.arrayRemove(dependent, s);\n                }\n                if (!this.getDependentFormulaCells().has(this.cell)) {\n                    this.clearFormulaDependentCells(this.cell);\n                }\n                throw this.formulaErrorStrings[FormulasErrorsStrings.circular_reference] + s;\n            }\n            pObjCVal = this.getParentObjectCellValue(s);\n            this.updateDependentCell(s);\n            return pObjCVal.toString();\n        }\n        if (this.getErrorStrings().indexOf(arg) > -1) {\n            return arg;\n        }\n        return this.computeValue(pObjCVal.toString());\n    };\n    /* tslint:disable-next-line */\n    Calculate.prototype.isDate = function (date) {\n        if (typeof date === 'object' || Date.parse(date) !== null) {\n            var dateval = new Date(Date.parse(date));\n            if (dateval >= this.dateTime1900) {\n                return dateval;\n            }\n            else {\n                return null;\n            }\n        }\n        else {\n            return null;\n        }\n    };\n    Calculate.prototype.isValidCellReference = function (text) {\n        var start = 0;\n        var end = 0;\n        var j = 0;\n        var numArr = [89, 71, 69];\n        var cellTxt = this.emptyString;\n        if (this.namedRanges.has(text)) {\n            return false;\n        }\n        for (var i = 0; i < text.length; i++) {\n            if (this.isChar(text[i])) {\n                end++;\n            }\n        }\n        cellTxt = text.substring(start, end);\n        if (cellTxt.length < 4) {\n            while (j < cellTxt.length) {\n                if (!isNullOrUndefined(cellTxt[j]) && cellTxt[j].charCodeAt(0) < numArr[j]) {\n                    j++;\n                    continue;\n                }\n                else if (isNullOrUndefined(cellTxt[j]) && j > 0) {\n                    break;\n                }\n                else {\n                    return false;\n                }\n            }\n            var cellNum = this.parseFloat(text.substring(end, text.length));\n            if (cellNum < 1048576) { // Maximum number of rows in excel.\n                return true;\n            }\n        }\n        return false;\n    };\n    /** @hidden */\n    /* tslint:disable-next-line */\n    Calculate.prototype.parseDate = function (date) {\n        if (!this.isNaN(date)) {\n            if (date instanceof Date) {\n                return new Date(date);\n            }\n            var d = parseInt(date, 10);\n            if (d < 0) {\n                return this.getErrorStrings()[CommonErrors.num];\n            }\n            if (d <= 60) {\n                return new Date(this.dateTime1900.getTime() + (d - 1) * 86400000);\n            }\n            return new Date(this.dateTime1900.getTime() + (d - 2) * 86400000);\n        }\n        if (typeof date === 'string') {\n            date = new Date(date);\n            if (!this.isNaN(date)) {\n                return date;\n            }\n        }\n        return this.getErrorStrings()[CommonErrors.value];\n    };\n    /** @hidden */\n    Calculate.prototype.isCellReference = function (args) {\n        if (args === this.emptyString) {\n            return false;\n        }\n        args = args.trim();\n        args = this.setTokensForSheets(args);\n        var sheetToken1 = this.getSheetToken(args);\n        var containsBoth = false;\n        if (sheetToken1 !== '') {\n            args = args.split(sheetToken1).join(this.emptyString);\n        }\n        var isAlpha = false;\n        var isNum = false;\n        if (args.indexOf(':') !== args.lastIndexOf(':')) {\n            return false;\n        }\n        var charArray = (args.split('').join(this.getParseArgumentSeparator())).split(this.getParseArgumentSeparator());\n        for (var c = 0; c < charArray.length; c++) {\n            if (this.isChar(charArray[c])) {\n                isAlpha = true;\n            }\n            else if (this.isDigit(charArray[c])) {\n                isNum = true;\n            }\n            else if (charArray[c] === ':') {\n                if (isAlpha && isNum) {\n                    containsBoth = true;\n                }\n                isAlpha = false;\n                isNum = false;\n            }\n            else {\n                return false;\n            }\n        }\n        if (args.indexOf(':') > -1 && args.indexOf(this.tic) === -1) {\n            if (containsBoth && isAlpha && isNum) {\n                return true;\n            }\n            else if (((isAlpha && !isNum) || (!isAlpha && isNum)) && !containsBoth) {\n                return true;\n            }\n            else {\n                return false;\n            }\n        }\n        if (isAlpha && isNum && args.indexOf(this.tic) === -1) {\n            return true;\n        }\n        return false;\n    };\n    /** @hidden */\n    Calculate.prototype.setTokensForSheets = function (text) {\n        var family = this.getSheetFamilyItem(this.grid);\n        var sortedSheetNamesCollection = this.getSortedSheetNames();\n        if (sortedSheetNamesCollection != null) {\n            for (var n = 0; n < sortedSheetNamesCollection.length; n++) {\n                var token = family.sheetNameToToken.get(sortedSheetNamesCollection[n]);\n                token = token.split(this.sheetToken).join(this.tempSheetPlaceHolder);\n                var s = this.singleTic + 'SHEET' + sortedSheetNamesCollection[n] + this.singleTic + this.sheetToken;\n                if (text.indexOf(s) === -1) {\n                    s = 'SHEET' + sortedSheetNamesCollection[n] + this.sheetToken;\n                }\n                text = text.split(s).join(token);\n                s = sortedSheetNamesCollection[n] + this.sheetToken;\n                text = text.split(s).join(token);\n            }\n        }\n        text = text.split(this.tempSheetPlaceHolder).join(this.sheetToken);\n        if (text.indexOf('!!') > -1) {\n            text = text.replace('!!', '!');\n            var textSplit = text.split('');\n            textSplit[1] = (parseInt(textSplit[1], 10) + 1).toString();\n            text = textSplit.join('');\n        }\n        return text;\n    };\n    Calculate.prototype.getParentObjectCellValue = function (val) {\n        if (val === this.trueValue || val === this.falseValue) {\n            return val;\n        }\n        var i = val.lastIndexOf(this.sheetToken);\n        var row = 0;\n        var col = 0;\n        var grid = this.grid;\n        var family = this.getSheetFamilyItem(grid);\n        if (i > -1 && family.tokenToParentObject !== null) {\n            this.grid = family.tokenToParentObject.get(val.substring(0, i + 1));\n            row = this.rowIndex(val);\n            col = this.colIndex(val);\n        }\n        else if (i === -1) {\n            var j = 0;\n            while (j < val.length && this.isChar(val[j])) {\n                j++;\n            }\n            if (j === val.length) {\n                val = val.toLowerCase();\n                return val === '' ? this.getErrorStrings()[CommonErrors.value] : this.getErrorStrings()[CommonErrors.name];\n            }\n            else {\n                row = this.rowIndex(val);\n                col = this.colIndex(val);\n                if (family.isSheetMember && family.parentObjectToToken != null) {\n                    val = family.parentObjectToToken.get(this.grid) + val;\n                }\n            }\n        }\n        var saveCell = (this.cell === '' || this.cell === null) ? '' : this.cell;\n        this.cell = val;\n        if (saveCell === this.cell) {\n            throw this.formulaErrorStrings[FormulasErrorsStrings.circular_reference];\n        }\n        var cValue = this.getParentCellValue(row, col, this.grid);\n        this.grid = grid;\n        this.cell = saveCell;\n        return cValue;\n    };\n    Calculate.prototype.getParentCellValue = function (row, col, grd) {\n        var alreadyComputed = false;\n        // formulainfotable\n        var cValue;\n        /* tslint:disable-next-line */\n        if (this.parentObject.getValueRowCol === undefined) {\n            cValue = this.getValueRowCol(this.getSheetID(grd), row, col);\n        }\n        else {\n            /* tslint:disable-next-line */\n            cValue = this.parentObject.getValueRowCol(this.getSheetID(grd), row, col);\n            return isNullOrUndefined(cValue) ? this.emptyString : cValue.toString();\n        }\n        if (cValue === '' || cValue === undefined) {\n            cValue = '';\n        }\n        // if (cValue[cValue.length - 1] == (\"%\") && !this.isNaN(d)) {\n        //     cValue = (Number(d) / 100).toString();\n        // }\n        return cValue;\n    };\n    /**\n     * Getting the formula result.\n     * @param {Object} grid - Specifies the parent object.\n     * @param {number} row - Row index of the parent object or key.\n     * @param {number} col - Column index of the parent object.\n     * @returns string\n     */\n    Calculate.prototype.getValueRowCol = function (grid, row, col) {\n        var key = this.rowsToKeyMap.get(row).toString();\n        var result = this.getKeyValue(key).toString();\n        if (result != null && result[result.length - 1] === ('%') && result.length > 1) {\n            var d = this.parseFloat(result.substring(0, result.length - 1));\n            if (this.isNaN(d)) {\n                result = (Number(d) / 100).toString();\n            }\n        }\n        return result;\n    };\n    /**\n     * To add custom library formula.\n     * @param {string} formulaName - Custom Formula name.\n     * @param {string} functionName - Custom function name.\n     * @returns void\n     */\n    Calculate.prototype.defineFunction = function (formulaName, functionName) {\n        if (typeof functionName === 'string') {\n            functionName = getValue(functionName, window);\n        }\n        formulaName = formulaName.toUpperCase();\n        this.libraryFormulas.set(formulaName, { handler: functionName, isCustom: true });\n    };\n    /**\n     * Specifies when changing the value.\n     * @param {string} grid - Parent object reference name.\n     * @param {ValueChangedArgs} changeArgs - Value changed arguments.\n     * @param {boolean} isCalculate - Value that allow to calculate.\n     */\n    Calculate.prototype.valueChanged = function (grid, changeArgs, isCalculate) {\n        var pgrid = grid;\n        this.grid = grid;\n        var isComputedValueChanged = true;\n        var isCompute = true;\n        var calcFamily = this.getSheetFamilyItem(pgrid);\n        var cellTxt = getAlphalabel(changeArgs.getColIndex()) + changeArgs.getRowIndex().toString();\n        if (calcFamily.sheetNameToParentObject !== null && calcFamily.sheetNameToParentObject.size > 0) {\n            var token = calcFamily.parentObjectToToken.get(pgrid);\n            cellTxt = token + cellTxt;\n        }\n        var argVal = changeArgs.getValue().toUpperCase();\n        if (argVal.indexOf('=RAND()') > -1 || argVal.indexOf('RAND()') > -1 || argVal.indexOf('=RANDBETWEEN(') > -1 ||\n            argVal.indexOf('RANDBETWEEN(') > -1 || this.randomValues.has(cellTxt)) {\n            var randStrVal = this.randCollection.toString();\n            if (!this.randomValues.has(cellTxt)) {\n                this.randomValues.set(cellTxt, changeArgs.getValue());\n                this.randCollection.push(cellTxt);\n                this.isRandomVal = true;\n            }\n            else if (this.randomValues.has(cellTxt)) {\n                if (argVal.indexOf('=RAND()') > -1 || argVal.indexOf('RAND()') > -1 || argVal.indexOf('=RANDBETWEEN(') > -1 ||\n                    argVal.indexOf('RANDBETWEEN(') > -1) {\n                    this.randomValues.set(cellTxt, changeArgs.getValue());\n                }\n                else if (changeArgs.getValue().toUpperCase() !== this.randomValues.get(cellTxt.toUpperCase())) {\n                    this.randomValues.delete(cellTxt);\n                    randStrVal = randStrVal.split(cellTxt + this.parseArgumentSeparator).join('').split(this.parseArgumentSeparator + cellTxt).join('').split(cellTxt).join('');\n                    this.randCollection = randStrVal.split(this.parseArgumentSeparator);\n                }\n                if (this.randomValues.size === 0 && this.randCollection.length) {\n                    this.isRandomVal = false;\n                    this.randomValues.clear();\n                    this.randCollection = [];\n                }\n            }\n        }\n        if (changeArgs.getValue() && changeArgs.getValue()[0] === this.getFormulaCharacter()) {\n            this.cell = cellTxt;\n            var formula = void 0;\n            if (!isNullOrUndefined(isCompute)) {\n                isCompute = isCalculate;\n            }\n            if (this.getFormulaInfoTable().has(cellTxt)) {\n                formula = this.getFormulaInfoTable().get(cellTxt);\n                if (changeArgs.getValue() !== formula.getFormulaText() || formula.getParsedFormula() == null) {\n                    formula.setFormulaText(changeArgs.getValue());\n                    if (this.getDependentFormulaCells().has(this.cell)) {\n                        this.clearFormulaDependentCells(this.cell);\n                    }\n                    try {\n                        formula.setParsedFormula(this.parser.parseFormula(changeArgs.getValue()));\n                    }\n                    catch (ex) {\n                        formula.setFormulaValue(ex);\n                        isCompute = false;\n                    }\n                }\n                if (isCompute) {\n                    this.parser.isFormulaParsed = true;\n                    var cValue = this.computeFormula(formula.getParsedFormula());\n                    isComputedValueChanged = (cValue !== formula.getFormulaValue());\n                    formula.setFormulaValue(cValue);\n                }\n            }\n            else {\n                formula = new FormulaInfo();\n                formula.setFormulaText(changeArgs.getValue());\n                if (!this.getDependentFormulaCells().has(cellTxt)) {\n                    this.getDependentFormulaCells().set(cellTxt, new Map());\n                }\n                try {\n                    formula.setParsedFormula(this.parser.parseFormula(changeArgs.getValue()));\n                }\n                catch (ex) {\n                    formula.setFormulaValue(ex);\n                    isCompute = false;\n                }\n                if (isCompute) {\n                    formula.setFormulaValue(this.computeFormula(formula.getParsedFormula()));\n                }\n                if (this.getFormulaInfoTable().has(cellTxt)) {\n                    this.getFormulaInfoTable().set(cellTxt, formula);\n                }\n                else {\n                    this.getFormulaInfoTable().set(cellTxt, formula);\n                }\n            }\n            if (isCompute) {\n                /* tslint:disable */\n                if (this.parentObject.setValueRowCol === undefined) {\n                    this.setValueRowCol(this.getSheetID(pgrid) + 1, formula.getFormulaValue(), changeArgs.getRowIndex(), changeArgs.getColIndex());\n                }\n                else {\n                    this.parentObject.setValueRowCol(this.getSheetID(pgrid) + 1, formula.getFormulaValue(), changeArgs.getRowIndex(), changeArgs.getColIndex());\n                }\n                /* tslint:enable */\n            }\n        }\n        else if (this.getFormulaInfoTable().has(cellTxt)) {\n            this.getFormulaInfoTable().delete(cellTxt);\n            if (this.getDependentFormulaCells().has(cellTxt)) {\n                this.clearFormulaDependentCells(cellTxt);\n            }\n        }\n        if (isCompute && isComputedValueChanged && this.getDependentCells().has(cellTxt) &&\n            this.getDependentCells().get(cellTxt).toString() !== cellTxt) {\n            this.getComputedValue().clear();\n            this.refresh(cellTxt);\n        }\n    };\n    /** @hidden */\n    Calculate.prototype.getComputedValue = function () {\n        if (this.computedValues === null) {\n            this.computedValues = new Map();\n        }\n        return this.computedValues;\n    };\n    /**\n     * @hidden\n     */\n    Calculate.prototype.setValueRowCol = function (value, formulaValue, row, col) {\n        /* No Implementation */\n    };\n    Calculate.prototype.getSortedSheetNames = function () {\n        var family = this.getSheetFamilyItem(this.grid);\n        if (family != null && family.sheetNameToToken != null) {\n            var arr_1 = [];\n            family.sheetNameToToken.forEach(function (value, key) {\n                arr_1.push(key);\n                arr_1.sort();\n            });\n            this.sortedSheetNames = arr_1;\n            this.sortedSheetNames.sort();\n        }\n        return this.sortedSheetNames;\n    };\n    /** @hidden */\n    Calculate.prototype.getErrorLine = function (error) {\n        /* tslint:disable-next-line */\n        var errorStack = error.stack ? error.stack.split('\\n')[1].split(':') : null;\n        return errorStack ? errorStack[errorStack.length - 2] : null; // Getting row number of the error file.\n    };\n    /** @hidden */\n    Calculate.prototype.createSheetFamilyID = function () {\n        if (this.sheetFamilyID === Number.MAX_SAFE_INTEGER) {\n            this.sheetFamilyID = Number.MIN_SAFE_INTEGER;\n        }\n        return this.sheetFamilyID++;\n    };\n    /** @hidden */\n    Calculate.prototype.computeMinMax = function (args, operation) {\n        var result;\n        var argVal;\n        var countStrVal = 0;\n        if (isNullOrUndefined(args) || args.length === 0) {\n            return this.formulaErrorStrings[FormulasErrorsStrings.wrong_number_arguments];\n        }\n        for (var k = 0, len = args.length; k < len; k++) {\n            if (args[k].split(this.tic).join('').trim() === this.emptyString) {\n                return this.getErrorStrings()[CommonErrors.value];\n            }\n        }\n        result = (operation === 'max') ? this.minValue : this.maxValue;\n        var argArr = args;\n        if (argArr.length > 255) {\n            return this.getErrorStrings()[CommonErrors.value];\n        }\n        for (var i = 0; i < argArr.length; i++) {\n            if (argArr[i].indexOf(':') > -1 && this.isCellReference(argArr[i])) {\n                var cellValue = this.getCellCollection(argArr[i]);\n                for (var j = 0; j < cellValue.length; j++) {\n                    argVal = this.getValueFromArg(cellValue[j]);\n                    if (this.getErrorStrings().indexOf(argVal) > -1) {\n                        return argVal;\n                    }\n                    var cellVal = this.parseFloat(argVal);\n                    if (argVal === '' || this.isNaN(this.parseFloat(cellVal))) {\n                        countStrVal = countStrVal + 1;\n                        if (countStrVal === cellValue.length) {\n                            result = 0;\n                        }\n                        continue;\n                    }\n                    else {\n                        result = (operation === 'max') ? Math.max(result, cellVal) : Math.min(result, cellVal);\n                    }\n                }\n            }\n            else {\n                var val = void 0;\n                val = this.getValueFromArg(argArr[i]);\n                if (this.getErrorStrings().indexOf(val) > -1) {\n                    return val;\n                }\n                var cellVal = this.parseFloat(val);\n                if (val === '' || this.isNaN(this.parseFloat(cellVal))) {\n                    countStrVal = countStrVal + 1;\n                    if (countStrVal === argVal.length) {\n                        result = 0;\n                    }\n                    continue;\n                }\n                else {\n                    result = (operation === 'max') ? Math.max(result, cellVal) : Math.min(result, cellVal);\n                }\n            }\n        }\n        return result.toString();\n    };\n    /** @hidden */\n    Calculate.prototype.calculateAvg = function (args) {\n        var sumCell = 0;\n        var argArr = args;\n        var cellVal = [];\n        var avgVal = 0;\n        var countNum = 0;\n        var countNum1 = 0;\n        for (var k = 0; k < argArr.length; k++) {\n            if (argArr[k].indexOf(':') > -1 && this.isCellReference(argArr[k])) {\n                countNum = 0;\n                cellVal = this.getCellCollection(argArr[k]);\n                avgVal = 0;\n                for (var i = 0; i < cellVal.length; i++) {\n                    var value = this.getValueFromArg(cellVal[i]);\n                    if (isNullOrUndefined(value) || isNaN(this.parseFloat(value))) {\n                        continue;\n                    }\n                    avgVal = avgVal + this.parseFloat(value);\n                    countNum = countNum + 1;\n                }\n                if (countNum === 0) {\n                    return this.getErrorStrings()[CommonErrors.divzero];\n                }\n                avgVal = avgVal / countNum;\n                sumCell = avgVal + sumCell;\n            }\n            else {\n                if (argArr[k].indexOf(this.tic) > -1) {\n                    if (isNaN(parseFloat(argArr[k].split(this.tic).join('')))) {\n                        return this.getErrorStrings()[CommonErrors.value];\n                    }\n                }\n                if (argArr[k].length === 0) {\n                    argArr[k] = '1';\n                }\n                var value = this.getValueFromArg(argArr[k].split(this.tic).join(''));\n                if (isNullOrUndefined(value) || isNaN(this.parseFloat(value))) {\n                    return this.getErrorStrings()[CommonErrors.name];\n                }\n                sumCell = sumCell + this.parseFloat(value);\n            }\n        }\n        return (sumCell / (argArr.length - countNum1)).toString();\n    };\n    /**\n     * @hidden\n     */\n    Calculate.prototype.registerGridAsSheet = function (refName, model, sheetFamilyID) {\n        if (isNullOrUndefined(this.modelToSheetID)) {\n            this.modelToSheetID = new Map();\n        }\n        if (isNullOrUndefined(this.modelToSheetID.get(model))) {\n            this.modelToSheetID.set(model, sheetFamilyID);\n        }\n        var family = this.getSheetFamilyItem(model);\n        family.isSheetMember = true;\n        var tempRef = refName.toUpperCase();\n        if (family.parentObjectToToken.size === 0) {\n            family.parentObjectToToken = new Map();\n        }\n        if (family.sheetNameToParentObject.size === 0) {\n            family.sheetNameToParentObject = new Map();\n        }\n        if (family.sheetNameToToken.size === 0) {\n            family.sheetNameToToken = new Map();\n        }\n        if (family.tokenToParentObject.size === 0) {\n            family.tokenToParentObject = new Map();\n        }\n        if (!isUndefined(family.sheetNameToParentObject.get(tempRef))) {\n            var token = family.sheetNameToToken.get(tempRef);\n            family.tokenToParentObject.set(token, model);\n            family.parentObjectToToken.set(model, token);\n        }\n        else {\n            var token = this.sheetToken + this.tokenCount.toString() + this.sheetToken;\n            this.tokenCount++;\n            family.tokenToParentObject.set(token, model);\n            family.parentObjectToToken.set(model, token);\n            family.sheetNameToToken.set(tempRef, token);\n            family.sheetNameToParentObject.set(tempRef, model);\n        }\n        return refName;\n    };\n    /**\n     * @hidden\n     */\n    Calculate.prototype.unregisterGridAsSheet = function (refName, model) {\n        var family = this.getSheetFamilyItem(model);\n        var refName1 = refName.toUpperCase();\n        if (family.sheetNameToParentObject != null && family.sheetNameToParentObject.has(refName1)) {\n            family.sheetNameToParentObject.delete(refName1);\n            var token = family.sheetNameToToken.get(refName1);\n            family.sheetNameToToken.delete(refName1);\n            family.tokenToParentObject.delete(token);\n            family.parentObjectToToken.delete(model);\n        }\n    };\n    ;\n    /**\n     * @hidden\n     */\n    Calculate.prototype.computeExpression = function (formula) {\n        var parsedFormula = this.parser.parseFormula(formula);\n        var calcValue = this.computeFormula(parsedFormula);\n        return calcValue;\n    };\n    ;\n    Calculate.prototype.isSheetMember = function () {\n        var family = this.getSheetFamilyItem(this.grid);\n        return isNullOrUndefined(family) ? false : family.isSheetMember;\n    };\n    /**\n     * To dispose the calculate engine.\n     * @returns void\n     */\n    Calculate.prototype.dispose = function () {\n        this.resetKeys();\n        // this.dependentCells.clear();\n        // this.dependentFormulaCells.clear();\n        this.namedRanges.clear();\n        // this.sheetFamiliesList.clear();\n        this.lFormulas.clear();\n    };\n    Calculate.prototype.refreshRandValues = function (cellRef) {\n        var rowIdx;\n        var colIdx;\n        var value;\n        var tokenRef = '';\n        var stringCollection = this.randCollection.toString();\n        var family;\n        if (this.randomValues.has(cellRef)) {\n            this.randomValues.delete(cellRef);\n            stringCollection = stringCollection.split(cellRef + this.parseArgumentSeparator).join('').split(this.parseArgumentSeparator + cellRef).join('').split(cellRef).join('');\n            if (this.randomValues.size === 0 && stringCollection === '') {\n                this.randomValues.clear();\n                this.randCollection = [];\n            }\n            else {\n                this.randCollection = stringCollection.split(this.parseArgumentSeparator);\n            }\n        }\n        for (var i = 0; i < this.randomValues.size; i++) {\n            rowIdx = this.rowIndex(this.randCollection[i]);\n            colIdx = this.colIndex(this.randCollection[i]);\n            tokenRef = (parseFloat(this.getSheetToken(this.randCollection[i]).split(this.sheetToken).join('')) + 1).toString();\n            family = this.getSheetFamilyItem(tokenRef);\n            this.grid = family.sheetNameToParentObject.get(tokenRef);\n            value = this.randomValues.get(this.randCollection[i]);\n            value = this.computeFormula(value);\n            if (this.parentObject.setValueRowCol === undefined) {\n                this.setValueRowCol(this.getSheetID(this.grid) + 1, value, rowIdx, colIdx);\n            }\n            else {\n                this.parentObject.setValueRowCol(this.getSheetID(this.grid) + 1, value, rowIdx, colIdx);\n            }\n        }\n    };\n    Calculate.prototype.refresh = function (cellRef) {\n        if (this.dependencyLevel === 0) {\n            this.refreshedCells.clear();\n        }\n        if (this.getDependentCells().has(cellRef) && this.getDependentCells().get(cellRef) !== null) {\n            var family = this.getSheetFamilyItem(this.grid);\n            this.dependencyLevel = this.dependencyLevel + 1;\n            try {\n                var dependentCells = this.getDependentCells().get(cellRef);\n                var i = void 0;\n                for (i = 0; i < dependentCells.length; i++) {\n                    var dCell = dependentCells[i];\n                    var token = this.getSheetToken(dCell);\n                    if (token.length) {\n                        this.grid = family.tokenToParentObject.get(token);\n                    }\n                    try {\n                        var rowIdx = this.rowIndex(dCell);\n                        var colIdx = this.colIndex(dCell);\n                        var formulaInfo = this.getFormulaInfoTable().get(dCell);\n                        var result = void 0;\n                        if (formulaInfo) {\n                            this.cell = dCell;\n                            if (!this.getComputedValue().has(dCell)) {\n                                this.parser.isFormulaParsed = true;\n                                result = this.computeFormula(formulaInfo.getParsedFormula());\n                                this.computedValues.set(dCell, result);\n                            }\n                            else {\n                                result = this.getComputedValue().get(dCell);\n                            }\n                            formulaInfo.setFormulaValue(result);\n                        }\n                        if (this.parentObject.setValueRowCol === undefined) {\n                            this.setValueRowCol(this.getSheetID(this.grid) + 1, formulaInfo.getFormulaValue(), rowIdx, colIdx);\n                        }\n                        else {\n                            this.parentObject.setValueRowCol(this.getSheetID(this.grid) + 1, formulaInfo.getFormulaValue(), rowIdx, colIdx);\n                        }\n                        if (!this.refreshedCells.has(dCell)) {\n                            this.refreshedCells.set(dCell, []);\n                            this.refresh(dCell);\n                        }\n                    }\n                    catch (ex) {\n                        continue;\n                    }\n                }\n            }\n            finally {\n                this.grid = family.tokenToParentObject.get(this.getSheetToken(cellRef));\n                this.dependencyLevel--;\n                if (this.dependencyLevel === 0) {\n                    this.refreshedCells.clear();\n                }\n            }\n        }\n    };\n    var Calculate_1;\n    __decorate([\n        Property(true)\n    ], Calculate.prototype, \"includeBasicFormulas\", void 0);\n    __decorate([\n        Event()\n    ], Calculate.prototype, \"onFailure\", void 0);\n    Calculate = Calculate_1 = __decorate([\n        NotifyPropertyChanges\n    ], Calculate);\n    return Calculate;\n}(Base));\nexport { Calculate };\n/** @hidden */\nvar FormulaError = /** @class */ (function () {\n    function FormulaError(errorMessage, formulaAutoCorrection) {\n        this.formulaCorrection = false;\n        this.message = errorMessage;\n        this.formulaCorrection = formulaAutoCorrection;\n    }\n    return FormulaError;\n}());\nexport { FormulaError };\n/** @hidden */\nvar FormulaInfo = /** @class */ (function () {\n    function FormulaInfo() {\n        /**\n         * @hidden\n         */\n        this.calcID = Number.MIN_VALUE + 1;\n        this.calcID1 = Number.MIN_VALUE + 1;\n    }\n    /**\n     * @hidden\n     */\n    FormulaInfo.prototype.getFormulaText = function () {\n        return this.formulaText;\n    };\n    /**\n     * @hidden\n     */\n    FormulaInfo.prototype.setFormulaText = function (value) {\n        this.formulaText = value;\n    };\n    /**\n     * @hidden\n     */\n    FormulaInfo.prototype.getFormulaValue = function () {\n        return this.formulaValue;\n    };\n    /**\n     * @hidden\n     */\n    FormulaInfo.prototype.setFormulaValue = function (value) {\n        this.formulaValue = value;\n    };\n    /**\n     * @hidden\n     */\n    FormulaInfo.prototype.getParsedFormula = function () {\n        return this.parsedFormula;\n    };\n    /**\n     * @hidden\n     */\n    FormulaInfo.prototype.setParsedFormula = function (value) {\n        this.parsedFormula = value;\n    };\n    return FormulaInfo;\n}());\nexport { FormulaInfo };\n/** @hidden */\nvar CalcSheetFamilyItem = /** @class */ (function () {\n    function CalcSheetFamilyItem() {\n        /**\n         * @hidden\n         */\n        this.isSheetMember = false;\n        /**\n         * @hidden\n         */\n        this.parentObjectToToken = new Map();\n        /**\n         * @hidden\n         */\n        this.sheetDependentCells = new Map();\n        /**\n         * @hidden\n         */\n        this.sheetDependentFormulaCells = new Map();\n        /**\n         * @hidden\n         */\n        this.sheetNameToParentObject = new Map();\n        /**\n         * @hidden\n         */\n        this.sheetNameToToken = new Map();\n        /**\n         * @hidden\n         */\n        this.tokenToParentObject = new Map();\n        /**\n         * @hidden\n         */\n        this.sheetFormulaInfotable = new Map();\n    }\n    return CalcSheetFamilyItem;\n}());\nexport { CalcSheetFamilyItem };\n/**\n * @hidden\n */\nexport function getAlphalabel(col) {\n    var cols = [];\n    var n = 0;\n    var charText = 'A';\n    while (col > 0 && n < 9) {\n        col--;\n        var aCharNo = charText.charCodeAt(0);\n        cols[n] = String.fromCharCode(col % 26 + aCharNo);\n        col = parseInt((col / 26).toString(), 10);\n        n++;\n    }\n    var chs = [];\n    for (var i = 0; i < n; i++) {\n        chs[n - i - 1] = cols[i];\n    }\n    return chs.join('');\n}\nvar ValueChangedArgs = /** @class */ (function () {\n    function ValueChangedArgs(row, col, value) {\n        this.row = row;\n        this.col = col;\n        this.value = value;\n        this.getRowIndex = function () {\n            return row;\n        };\n        this.setRowIndex = function (value) {\n            row = value;\n        };\n        this.getColIndex = function () {\n            return col;\n        };\n        this.setColIndex = function (value) {\n            col = value;\n        };\n        this.getValue = function () {\n            return value;\n        };\n        this.setValue = function (value) {\n            value = value;\n        };\n        return this;\n    }\n    return ValueChangedArgs;\n}());\nexport { ValueChangedArgs };\n","/**\n * To get Workbook required modules.\n * @hidden\n * @param {Workbook} context\n */\nexport function getWorkbookRequiredModules(context, modules) {\n    if (modules === void 0) { modules = []; }\n    modules.push({ member: 'workbookBasic', args: [] });\n    modules.push({ member: 'workbookAll', args: [] });\n    modules.push({\n        member: 'dataBind',\n        args: [context]\n    });\n    modules.push({\n        member: 'workbookProtectSheet',\n        args: [context]\n    });\n    if (context.allowSave) {\n        modules.push({\n            member: 'workbookSave',\n            args: [context]\n        });\n    }\n    if (context.allowOpen) {\n        modules.push({\n            member: 'workbookOpen',\n            args: [context]\n        });\n    }\n    if (context.allowEditing) {\n        modules.push({\n            member: 'workbookEdit',\n            args: [context]\n        });\n        modules.push({\n            member: 'workbookFormula',\n            args: [context]\n        });\n    }\n    if (context.allowNumberFormatting) {\n        modules.push({\n            member: 'workbookNumberFormat',\n            args: [context]\n        });\n    }\n    if (context.allowCellFormatting) {\n        modules.push({\n            member: 'workbookcellformat',\n            args: [context]\n        });\n    }\n    if (context.allowSorting) {\n        modules.push({ member: 'workbookSort', args: [context] });\n    }\n    if (context.allowHyperlink) {\n        modules.push({ member: 'workbookHyperlink', args: [context] });\n    }\n    if (context.allowFiltering) {\n        modules.push({ member: 'workbookFilter', args: [context] });\n    }\n    if (context.allowFindAndReplace) {\n        modules.push({ member: 'workbookfindAndReplace', args: [context] });\n    }\n    if (context.allowInsert) {\n        modules.push({ member: 'workbookinsert', args: [context] });\n    }\n    if (context.allowDelete) {\n        modules.push({ member: 'workbookdelete', args: [context] });\n    }\n    if (context.allowDataValidation) {\n        modules.push({ member: 'workbookDataValidation', args: [context] });\n    }\n    if (context.allowMerge) {\n        modules.push({ member: 'workbookmerge', args: [context] });\n    }\n    if (context.allowDataValidation) {\n        modules.push({ member: 'workbookConditionalFormatting', args: [context] });\n    }\n    if (context.allowImage) {\n        modules.push({ member: 'workbookImage', args: [context] });\n    }\n    if (context.allowChart) {\n        modules.push({ member: 'workbookChart', args: [context] });\n    }\n    return modules;\n}\n","/**\n * Check whether the text is formula or not.\n * @param text\n */\nexport function checkIsFormula(text) {\n    return text && text[0] === '=' && text.length > 1;\n}\n/**\n * Check whether the value is cell reference or not.\n * @param {string} value - Specify the value to check.\n */\nexport function isCellReference(value) {\n    var range = value;\n    range = range.split('$').join('');\n    if (range.indexOf(':') > -1) {\n        var rangeSplit = range.split(':');\n        if (isValidCellReference(rangeSplit[0]) && isValidCellReference(rangeSplit[1])) {\n            return true;\n        }\n    }\n    else if (range.indexOf(':') < 0) {\n        if (isValidCellReference(range)) {\n            return true;\n        }\n    }\n    return false;\n}\n/**\n * Check whether the value is character or not.\n * @param {string} value - Specify the value to check.\n */\nexport function isChar(value) {\n    if ((value.charCodeAt(0) >= 65 && value.charCodeAt(0) <= 90) || (value.charCodeAt(0) >= 97 && value.charCodeAt(0) <= 122)) {\n        return true;\n    }\n    return false;\n}\nexport function inRange(range, rowIdx, colIdx) {\n    return range && (rowIdx >= range[0] && rowIdx <= range[2] && colIdx >= range[1] && colIdx <= range[3]);\n}\n/**\n * Check whether the cell is locked or not\n * @hidden\n */\nexport function isLocked(cell, column) {\n    if (!cell) {\n        cell = {};\n    }\n    if (cell.isLocked) {\n        return true;\n    }\n    else if (cell.isLocked === false) {\n        return false;\n    }\n    else if (column && column.isLocked) {\n        return true;\n    }\n    else if (!cell.isLocked && (column && column.isLocked !== false)) {\n        return true;\n    }\n    return false;\n}\n/**\n * Check whether the value is cell reference or not.\n * @param {string} value - Specify the value to check.\n * @hidden\n */\nexport function isValidCellReference(value) {\n    var text = value;\n    var startNum = 0;\n    var endNum = 0;\n    var j = 0;\n    var numArr = [89, 71, 69];\n    // XFD is the last column, for that we are using ascii values of Z, G, E (89, 71, 69) to restrict the flow.\n    var cellText = '';\n    var textLength = text.length;\n    for (var i = 0; i < textLength; i++) {\n        if (isChar(text[i])) {\n            endNum++;\n        }\n    }\n    cellText = text.substring(startNum, endNum);\n    var cellTextLength = cellText.length;\n    if (cellTextLength !== textLength) {\n        if (cellTextLength < 4) {\n            if (textLength !== 1 && (isNaN(parseInt(text, 10)))) {\n                while (j < cellTextLength) {\n                    if ((cellText[j]) && cellText[j].charCodeAt(0) < numArr[j]) {\n                        j++;\n                        continue;\n                    }\n                    else if (!(cellText[j]) && j > 0) {\n                        break;\n                    }\n                    else {\n                        return false;\n                    }\n                }\n                var cellNumber = parseFloat(text.substring(endNum, textLength));\n                if (cellNumber > 0 && cellNumber < 1048577) { // 1048576 - Maximum number of rows in excel.\n                    return true;\n                }\n            }\n        }\n    }\n    return false;\n}\n","var __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    }\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nimport { extend, Property, ChildProperty, Complex, Collection, } from '@syncfusion/ej2-base';\nimport { CellStyle, wrapEvent, Chart } from '../common/index';\nimport { Image } from '../common/index';\nimport { getRow } from './index';\nimport { getSheet } from './sheet';\n/**\n * Represents the cell.\n */\nvar Cell = /** @class */ (function (_super) {\n    __extends(Cell, _super);\n    function Cell() {\n        return _super !== null && _super.apply(this, arguments) || this;\n    }\n    __decorate([\n        Collection([], Image)\n    ], Cell.prototype, \"image\", void 0);\n    __decorate([\n        Collection([], Chart)\n    ], Cell.prototype, \"chart\", void 0);\n    __decorate([\n        Property('')\n    ], Cell.prototype, \"value\", void 0);\n    __decorate([\n        Property('')\n    ], Cell.prototype, \"formula\", void 0);\n    __decorate([\n        Property(0)\n    ], Cell.prototype, \"index\", void 0);\n    __decorate([\n        Property('General')\n    ], Cell.prototype, \"format\", void 0);\n    __decorate([\n        Complex({}, CellStyle)\n    ], Cell.prototype, \"style\", void 0);\n    __decorate([\n        Property('')\n    ], Cell.prototype, \"hyperlink\", void 0);\n    __decorate([\n        Property(false)\n    ], Cell.prototype, \"wrap\", void 0);\n    __decorate([\n        Property(true)\n    ], Cell.prototype, \"isLocked\", void 0);\n    __decorate([\n        Property('')\n    ], Cell.prototype, \"validation\", void 0);\n    __decorate([\n        Property(1)\n    ], Cell.prototype, \"colSpan\", void 0);\n    __decorate([\n        Property(1)\n    ], Cell.prototype, \"rowSpan\", void 0);\n    return Cell;\n}(ChildProperty));\nexport { Cell };\n/**\n * @hidden\n */\nexport function getCell(rowIndex, colIndex, sheet, isInitRow) {\n    var row = getRow(sheet, rowIndex);\n    if (!row || !row.cells) {\n        if (isInitRow) {\n            if (!row) {\n                sheet.rows[rowIndex] = { cells: [] };\n            }\n            else {\n                sheet.rows[rowIndex].cells = [];\n            }\n        }\n        else {\n            return null;\n        }\n    }\n    return sheet.rows[rowIndex].cells[colIndex] || null;\n}\n/**\n * @hidden\n */\nexport function setCell(rowIndex, colIndex, sheet, cell, isExtend) {\n    if (!sheet.rows[rowIndex]) {\n        sheet.rows[rowIndex] = { cells: [] };\n    }\n    else if (!sheet.rows[rowIndex].cells) {\n        sheet.rows[rowIndex].cells = [];\n    }\n    if (isExtend && sheet.rows[rowIndex].cells[colIndex]) {\n        extend(sheet.rows[rowIndex].cells[colIndex], cell, null, true);\n    }\n    else {\n        sheet.rows[rowIndex].cells[colIndex] = cell;\n    }\n}\n/** @hidden */\nexport function skipDefaultValue(style, defaultKey) {\n    var defaultProps = { fontFamily: 'Calibri', verticalAlign: 'bottom', textIndent: '0pt', backgroundColor: '#ffffff',\n        color: '#000000', textAlign: 'left', fontSize: '11pt', fontWeight: 'normal', fontStyle: 'normal', textDecoration: 'none',\n        border: '', borderLeft: '', borderTop: '', borderRight: '', borderBottom: '' };\n    var changedProps = {};\n    Object.keys(defaultKey ? defaultProps : style).forEach(function (propName) {\n        if (style[propName] !== defaultProps[propName]) {\n            changedProps[propName] = style[propName];\n        }\n    });\n    return changedProps;\n}\n/** @hidden */\nexport function wrap(address, wrap, context) {\n    if (wrap === void 0) { wrap = true; }\n    var addressInfo = context.getAddressInfo(address);\n    var rng = addressInfo.indices;\n    var sheet = getSheet(context, addressInfo.sheetIndex);\n    for (var i = rng[0]; i <= rng[2]; i++) {\n        for (var j = rng[1]; j <= rng[3]; j++) {\n            setCell(i, j, sheet, { wrap: wrap }, true);\n        }\n    }\n    context.setProperties({ sheets: context.sheets }, true);\n    if (addressInfo.sheetIndex === context.activeSheetIndex) {\n        context.notify(wrapEvent, { range: rng, wrap: wrap, sheet: sheet });\n    }\n}\n","import { getSheetNameFromAddress, getSheetIndex, getSheet } from '../base/index';\nimport { getCellAddress, getIndexesFromAddress, getColumnHeaderText, updateSheetFromDataSource, checkDateFormat } from '../common/index';\nimport { queryCellInfo, cFDelete } from '../common/index';\nimport { getRow, getCell, isHiddenRow, isHiddenCol, getMaxSheetId, getSheetNameCount } from './index';\nimport { isUndefined, isNullOrUndefined } from '@syncfusion/ej2-base';\nimport { setCell } from './cell';\n/**\n * Update data source to Sheet and returns Sheet\n * @hidden\n */\nexport function getData(context, address, columnWiseData, valueOnly) {\n    return new Promise(function (resolve, reject) {\n        resolve((function () {\n            var i;\n            var cell;\n            var row;\n            var data = new Map();\n            var sheetIdx = getSheetIndex(context, getSheetNameFromAddress(address));\n            var sheet = getSheet(context, sheetIdx);\n            var indexes = getIndexesFromAddress(address);\n            var sRow = indexes[0];\n            var index = 0;\n            var args = {\n                sheet: sheet, indexes: indexes, promise: new Promise(function (resolve, reject) { resolve((function () { })()); })\n            };\n            context.notify(updateSheetFromDataSource, args);\n            return args.promise.then(function () {\n                while (sRow <= indexes[2]) {\n                    var cells = {};\n                    row = getRow(sheet, sRow);\n                    i = indexes[1];\n                    while (i <= indexes[3]) {\n                        if (columnWiseData) {\n                            if (data instanceof Map) {\n                                data = [];\n                            }\n                            var key = getColumnHeaderText(i + 1);\n                            var rowKey = '__rowIndex';\n                            if (valueOnly) {\n                                cells[key] = row ? getValueFromFormat(context, sRow, i, sheetIdx, sheet) : '';\n                            }\n                            else {\n                                cells[key] = row ? getCell(sRow, i, sheet) : null;\n                            }\n                            if (indexes[3] < i + 1) {\n                                cells[rowKey] = (sRow + 1).toString();\n                            }\n                            if (cells[key]) {\n                                data[index.toString()] = cells;\n                            }\n                        }\n                        else {\n                            var cellObj = {};\n                            Object.assign(cellObj, row ? getCell(sRow, i, sheet) : null);\n                            if (cellObj.colSpan > 1 && cellObj.rowSpan > 1) {\n                                var cell_1 = void 0;\n                                for (var j = sRow, len = sRow + cellObj.rowSpan; j < len; j++) {\n                                    for (var k = i, len_1 = i + cellObj.colSpan; k < len_1; k++) {\n                                        if (j === sRow && k === i) {\n                                            continue;\n                                        }\n                                        cell_1 = new Object();\n                                        if (j !== sRow) {\n                                            cell_1.rowSpan = sRow - j;\n                                        }\n                                        if (k !== i) {\n                                            cell_1.colSpan = i - k;\n                                        }\n                                        if (sheet.rows[j] && sheet.rows[j].cells && sheet.rows[j].cells[k]) {\n                                            delete sheet.rows[j].cells[k].value;\n                                            delete sheet.rows[j].cells[k].formula;\n                                        }\n                                        setCell(j, k, sheet, cell_1, true);\n                                    }\n                                }\n                            }\n                            else if (cellObj.colSpan > 1) {\n                                for (var j = i + 1, len = i + cellObj.colSpan; j < len; j++) {\n                                    setCell(sRow, j, sheet, { colSpan: i - j }, true);\n                                    if (sheet.rows[sRow] && sheet.rows[sRow].cells && sheet.rows[sRow].cells[j]) {\n                                        delete sheet.rows[sRow].cells[j].value;\n                                        delete sheet.rows[sRow].cells[j].formula;\n                                    }\n                                }\n                            }\n                            else if (cellObj.rowSpan > 1) {\n                                for (var j = sRow + 1, len = sRow + cellObj.rowSpan; j < len; j++) {\n                                    setCell(j, i, sheet, { rowSpan: sRow - j }, true);\n                                    if (sheet.rows[j] && sheet.rows[j].cells && sheet.rows[j].cells[i]) {\n                                        delete sheet.rows[j].cells[i].value;\n                                        delete sheet.rows[j].cells[i].formula;\n                                    }\n                                }\n                            }\n                            if (!valueOnly && isHiddenRow(sheet, sRow)) {\n                                sRow++;\n                                continue;\n                            }\n                            if (!valueOnly && isHiddenCol(sheet, i)) {\n                                i++;\n                                continue;\n                            }\n                            if (cellObj.style) {\n                                var style = {};\n                                Object.assign(style, cellObj.style);\n                                cellObj.style = style;\n                            }\n                            var eventArgs = { cell: cellObj, address: getCellAddress(sRow, i) };\n                            context.trigger(queryCellInfo, eventArgs);\n                            data.set(eventArgs.address, eventArgs.cell);\n                        }\n                        i++;\n                    }\n                    sRow++;\n                    index++;\n                }\n                return data;\n            });\n        })());\n    });\n}\nfunction getValueFromFormat(context, rowIndex, colIndex, sheetIdx, sheet) {\n    var cell = getCell(rowIndex, colIndex, sheet);\n    if (cell) {\n        if (cell.format) {\n            var args = {\n                value: context.getDisplayText(cell), rowIndex: rowIndex, colIndex: colIndex,\n                sheetIndex: sheetIdx, dateObj: '', isDate: false, isTime: false\n            };\n            context.notify(checkDateFormat, args);\n            if (args.isDate) {\n                return args.dateObj;\n            }\n            else {\n                return cell.value;\n            }\n        }\n        else {\n            return cell.value;\n        }\n    }\n    else {\n        return '';\n    }\n}\n/**\n * @hidden\n */\nexport function getModel(model, idx) {\n    var diff;\n    var j;\n    var prevIdx;\n    if (isUndefined(model[idx]) || !(model[idx] && model[idx].index === idx)) {\n        for (var i = 0; i <= idx; i++) {\n            if (model && model[i]) {\n                diff = model[i].index - i;\n                if (diff > 0) {\n                    model.forEach(function (value, index) {\n                        if (value && value.index) {\n                            prevIdx = value.index;\n                            j = 1;\n                        }\n                        if (value && !value.index && index !== 0) {\n                            value.index = prevIdx + j;\n                        }\n                        j++;\n                    });\n                    while (diff--) {\n                        model.splice(i, 0, null);\n                    }\n                    i += diff;\n                }\n            }\n            else if (model) {\n                model[i] = null;\n            }\n            else {\n                model = [];\n            }\n        }\n    }\n    return model[idx];\n}\n/**\n * @hidden\n */\nexport function processIdx(model, isSheet, context) {\n    var j;\n    var diff = 0;\n    var cnt;\n    var len = model.length;\n    var _loop_1 = function (i) {\n        if (!isNullOrUndefined(model[i]) && !isUndefined(model[i].index)) {\n            cnt = diff = model[i].index - i;\n            delete model[i].index;\n        }\n        if (diff > 0) {\n            j = 0;\n            while (diff--) {\n                if (isSheet) {\n                    context.createSheet(i + j);\n                    j++;\n                }\n                else {\n                    model.splice(i, 0, null);\n                }\n            }\n            i += cnt;\n            len += cnt;\n        }\n        if (isSheet) {\n            if (model[i].id < 1) {\n                model[i].id = getMaxSheetId(context.sheets);\n            }\n            if (!model[i].name) {\n                context.setSheetPropertyOnMute(model[i], 'name', 'Sheet' + getSheetNameCount(context));\n            }\n            var cellCnt_1 = 0;\n            model[i].rows.forEach(function (row) {\n                cellCnt_1 = Math.max(cellCnt_1, (row && row.cells && row.cells.length - 1) || 0);\n            });\n            context.setSheetPropertyOnMute(model[i], 'usedRange', { rowIndex: model[i].rows.length - 1, colIndex: cellCnt_1 });\n        }\n        out_i_1 = i;\n    };\n    var out_i_1;\n    for (var i = 0; i < len; i++) {\n        _loop_1(i);\n        i = out_i_1;\n    }\n}\n/**\n * @hidden\n */\nexport function clearRange(context, address, sheetIdx, valueOnly) {\n    var sheet = getSheet(context, sheetIdx);\n    var range = getIndexesFromAddress(address);\n    var sRIdx = range[0];\n    var eRIdx = range[2];\n    var sCIdx;\n    var eCIdx;\n    for (sRIdx; sRIdx <= eRIdx; sRIdx++) {\n        sCIdx = range[1];\n        eCIdx = range[3];\n        for (sCIdx; sCIdx <= eCIdx; sCIdx++) {\n            var cell = getCell(sRIdx, sCIdx, sheet);\n            context.notify(cFDelete, { rowIdx: sRIdx, colIdx: sCIdx });\n            if (!isNullOrUndefined(cell) && valueOnly) {\n                delete cell.value;\n                if (!isNullOrUndefined(cell.formula)) {\n                    delete cell.formula;\n                }\n            }\n        }\n    }\n}\n","var __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    }\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nimport { processIdx } from './data';\nimport { ConditionalFormat } from '../common/index';\nimport { ProtectSettings, getRangeIndexes, getRangeAddress } from '../common/index';\nimport { isUndefined, ChildProperty, Property, Complex, Collection } from '@syncfusion/ej2-base';\n/**\n * Configures the range processing for the spreadsheet.\n *  ```html\n * <div id='Spreadsheet'></div>\n * ```\n * ```typescript\n * let spreadsheet: Spreadsheet = new Spreadsheet({\n *      sheets: [{\n *                  name: 'First Sheet',\n *                  ranges: [{ dataSource: defaultData }],\n *                  rows: [{\n *                          index: 30,\n *                          cells: [{ index: 4, value: 'Total Amount:' },\n *                                  { formula: '=SUM(F2:F30)', style: { fontWeight: 'bold' } }]\n *                  }]\n * ...\n * });\n * spreadsheet.appendTo('#Spreadsheet');\n * ```\n */\nvar Range = /** @class */ (function (_super) {\n    __extends(Range, _super);\n    function Range() {\n        return _super !== null && _super.apply(this, arguments) || this;\n    }\n    Range.prototype.setProperties = function (prop, muteOnChange) {\n        var _this = this;\n        var name = 'name';\n        var instance = 'instance';\n        var parentObj = 'parentObj';\n        var currRangeIdx = 'currRangeIdx';\n        var controlParent = 'controlParent';\n        if (this[parentObj].isComplexArraySetter && this[controlParent] && this[controlParent].isAngular) {\n            if (Object.keys(prop).length) {\n                if (this[parentObj][currRangeIdx] === undefined) {\n                    this[parentObj][currRangeIdx] = 0;\n                }\n                else {\n                    this[parentObj][currRangeIdx] += 1;\n                }\n                var range = this[parentObj].ranges[this[parentObj][currRangeIdx]];\n                if (range && range.info) {\n                    this.info = range.info;\n                }\n                setTimeout(function () {\n                    if (_this[parentObj][currRangeIdx] !== undefined) {\n                        delete _this[parentObj][currRangeIdx];\n                    }\n                });\n            }\n            else if (this[controlParent].tagObjects[0].instance && this[controlParent].tagObjects[0].instance.hasChanges\n                && !this[controlParent].tagObjects[0].instance.isInitChanges) {\n                var sheetIdx = this[controlParent].sheets.indexOf(this[parentObj]);\n                if (this[parentObj].changedRangeIdx === undefined) {\n                    var rangeIdx_1;\n                    var tagObjects = this[controlParent].tagObjects[0].instance.list[sheetIdx].tagObjects;\n                    for (var i = 0; i < tagObjects.length; i++) {\n                        if (tagObjects[i][name] === 'ranges') {\n                            tagObjects[i][instance].list\n                                .forEach(function (range, idx) {\n                                if (range.hasChanges) {\n                                    rangeIdx_1 = idx;\n                                }\n                            });\n                            break;\n                        }\n                    }\n                    this[parentObj].changedRangeIdx = rangeIdx_1;\n                }\n            }\n        }\n        _super.prototype.setProperties.call(this, prop, muteOnChange);\n    };\n    __decorate([\n        Property(null)\n    ], Range.prototype, \"dataSource\", void 0);\n    __decorate([\n        Property('A1')\n    ], Range.prototype, \"startCell\", void 0);\n    __decorate([\n        Property(null)\n    ], Range.prototype, \"query\", void 0);\n    __decorate([\n        Property(true)\n    ], Range.prototype, \"showFieldAsHeader\", void 0);\n    __decorate([\n        Property('')\n    ], Range.prototype, \"template\", void 0);\n    __decorate([\n        Property('A1')\n    ], Range.prototype, \"address\", void 0);\n    return Range;\n}(ChildProperty));\nexport { Range };\n/**\n * Used range which contains end row index and end column index of the last used cell in sheet .\n */\nvar UsedRange = /** @class */ (function (_super) {\n    __extends(UsedRange, _super);\n    function UsedRange() {\n        return _super !== null && _super.apply(this, arguments) || this;\n    }\n    __decorate([\n        Property(0)\n    ], UsedRange.prototype, \"rowIndex\", void 0);\n    __decorate([\n        Property(0)\n    ], UsedRange.prototype, \"colIndex\", void 0);\n    return UsedRange;\n}(ChildProperty));\nexport { UsedRange };\n/**\n * Configures the sheet behavior for the spreadsheet.\n */\nvar Sheet = /** @class */ (function (_super) {\n    __extends(Sheet, _super);\n    function Sheet() {\n        return _super !== null && _super.apply(this, arguments) || this;\n    }\n    __decorate([\n        Property(null)\n    ], Sheet.prototype, \"rows\", void 0);\n    __decorate([\n        Property([])\n    ], Sheet.prototype, \"columns\", void 0);\n    __decorate([\n        Complex({}, ProtectSettings)\n    ], Sheet.prototype, \"protectSettings\", void 0);\n    __decorate([\n        Collection([], Range)\n    ], Sheet.prototype, \"ranges\", void 0);\n    __decorate([\n        Collection([], ConditionalFormat)\n    ], Sheet.prototype, \"conditionalFormats\", void 0);\n    __decorate([\n        Property(0)\n    ], Sheet.prototype, \"index\", void 0);\n    __decorate([\n        Property('')\n    ], Sheet.prototype, \"name\", void 0);\n    __decorate([\n        Property(100)\n    ], Sheet.prototype, \"rowCount\", void 0);\n    __decorate([\n        Property(100)\n    ], Sheet.prototype, \"colCount\", void 0);\n    __decorate([\n        Property('A1:A1')\n    ], Sheet.prototype, \"selectedRange\", void 0);\n    __decorate([\n        Property('A1')\n    ], Sheet.prototype, \"activeCell\", void 0);\n    __decorate([\n        Property({})\n    ], Sheet.prototype, \"usedRange\", void 0);\n    __decorate([\n        Property('A1')\n    ], Sheet.prototype, \"topLeftCell\", void 0);\n    __decorate([\n        Property(true)\n    ], Sheet.prototype, \"showHeaders\", void 0);\n    __decorate([\n        Property(true)\n    ], Sheet.prototype, \"showGridLines\", void 0);\n    __decorate([\n        Property(false)\n    ], Sheet.prototype, \"isProtected\", void 0);\n    __decorate([\n        Property('Visible')\n    ], Sheet.prototype, \"state\", void 0);\n    return Sheet;\n}(ChildProperty));\nexport { Sheet };\n/**\n * To get sheet index from address.\n * @hidden\n */\nexport function getSheetIndex(context, name) {\n    var idx;\n    for (var i = 0; i < context.sheets.length; i++) {\n        if (context.sheets[i].name.toLowerCase() === name.toLowerCase()) {\n            idx = i;\n            break;\n        }\n    }\n    return idx;\n}\n/**\n * To get sheet index from sheet id.\n * @hidden\n */\nexport function getSheetIndexFromId(context, id) {\n    var idx;\n    for (var i = 0; i < context.sheets.length; i++) {\n        if (context.sheets[i].id === id) {\n            idx = i;\n            break;\n        }\n    }\n    return idx;\n}\n/**\n * To get sheet name from address.\n * @hidden\n */\nexport function getSheetNameFromAddress(address) {\n    return address.split('!')[0].replace(/\\'/gi, '');\n}\n/**\n * To get sheet index from sheet name.\n * @hidden\n */\nexport function getSheetIndexByName(context, name, info) {\n    var len = info.length;\n    for (var i = 0; i < len; i++) {\n        if (info[i].sheet.toUpperCase() === name.toUpperCase()) {\n            return info[i].index;\n        }\n    }\n    return -1;\n}\n/**\n * update selected range\n * @hidden\n */\nexport function updateSelectedRange(context, range, sheet) {\n    if (sheet === void 0) { sheet = {}; }\n    context.setSheetPropertyOnMute(sheet, 'selectedRange', range);\n}\n/**\n * get selected range\n * @hidden\n */\nexport function getSelectedRange(sheet) {\n    return sheet && sheet.selectedRange || 'A1';\n}\n/**\n * @hidden\n */\nexport function getSheet(context, idx) {\n    return context.sheets[idx];\n}\n/**\n * @hidden\n */\nexport function getSheetNameCount(context) {\n    var name = [];\n    context.sheets.forEach(function (sheet) {\n        name.push(sheet.name.toLowerCase());\n    });\n    for (var i = 0; i < name.length; i++) {\n        if (name.indexOf('sheet' + context.sheetNameCount) > -1) {\n            context.sheetNameCount++;\n        }\n        else {\n            return context.sheetNameCount++;\n        }\n    }\n    return context.sheetNameCount++;\n}\n/**\n * @hidden\n */\nexport function getMaxSheetId(sheets) {\n    var cnt = 0;\n    sheets.forEach(function (sheet) {\n        cnt = Math.max(sheet.id, cnt);\n    });\n    return cnt + 1;\n}\n/**\n * @hidden\n */\nexport function initSheet(context, sheet) {\n    var sheets = sheet ? sheet : context.sheets;\n    sheets.forEach(function (sheet) {\n        sheet.id = sheet.id || 0;\n        sheet.name = sheet.name || '';\n        sheet.rowCount = isUndefined(sheet.rowCount) ? 100 : sheet.rowCount;\n        sheet.colCount = isUndefined(sheet.colCount) ? 100 : sheet.colCount;\n        sheet.topLeftCell = sheet.topLeftCell || 'A1';\n        sheet.activeCell = sheet.activeCell || 'A1';\n        sheet.selectedRange = getMaxSelectionRange(sheet.selectedRange || 'A1:A1', sheet);\n        sheet.usedRange = sheet.usedRange || { rowIndex: 0, colIndex: 0 };\n        context.setSheetPropertyOnMute(sheet, 'ranges', sheet.ranges ? sheet.ranges : []);\n        context.setSheetPropertyOnMute(sheet, 'rows', sheet.rows || []);\n        context.setSheetPropertyOnMute(sheet, 'columns', sheet.columns || []);\n        sheet.showHeaders = isUndefined(sheet.showHeaders) ? true : sheet.showHeaders;\n        sheet.showGridLines = isUndefined(sheet.showGridLines) ? true : sheet.showGridLines;\n        sheet.state = sheet.state || 'Visible';\n        sheet.maxHgts = [];\n        sheet.protectSettings = sheet.protectSettings || { selectCells: false, formatCells: false, formatRows: false, formatColumns: false,\n            insertLink: false };\n        sheet.isProtected = sheet.isProtected || false;\n        processIdx(sheet.columns);\n        initRow(sheet.rows);\n    });\n    processIdx(sheets, true, context);\n}\nfunction getMaxSelectionRange(range, sheet) {\n    var selectedIndex = getRangeIndexes(range);\n    if (selectedIndex[2] > sheet.rowCount) {\n        selectedIndex[2] = sheet.rowCount - 1;\n    }\n    if (selectedIndex[3] > sheet.colCount) {\n        selectedIndex[3] = sheet.colCount - 1;\n    }\n    return getRangeAddress(selectedIndex);\n}\nfunction initRangeSettings(ranges) {\n    ranges.forEach(function (range) {\n        range.startCell = range.startCell || 'A1';\n        range.address = range.address || 'A1';\n        range.template = range.template || '';\n        range.showFieldAsHeader = isUndefined(range.showFieldAsHeader) ? true : range.showFieldAsHeader;\n    });\n    return ranges;\n}\nfunction initRow(rows) {\n    rows.forEach(function (row) {\n        if (row && row.cells) {\n            processIdx(row.cells);\n        }\n    });\n    processIdx(rows);\n}\n/**\n * get sheet name\n * @hidden\n */\nexport function getSheetName(context, idx) {\n    if (idx === void 0) { idx = context.activeSheetIndex; }\n    return getSheet(context, idx).name;\n}\n","var __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    }\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nimport { ChildProperty, Collection, Property, Complex } from '@syncfusion/ej2-base';\nimport { Cell } from './cell';\nimport { Format } from '../common/index';\n/**\n * Configures the Row behavior for the spreadsheet.\n *  ```html\n * <div id='Spreadsheet'></div>\n * ```\n * ```typescript\n * let spreadsheet: Spreadsheet = new Spreadsheet({\n *      sheets: [{\n *                rows: [{\n *                        index: 30,\n *                        cells: [{ index: 4, value: 'Total Amount:' },\n *                               { formula: '=SUM(F2:F30)', style: { fontWeight: 'bold' } }]\n *                }]\n * ...\n * });\n * spreadsheet.appendTo('#Spreadsheet');\n * ```\n */\nvar Row = /** @class */ (function (_super) {\n    __extends(Row, _super);\n    function Row() {\n        return _super !== null && _super.apply(this, arguments) || this;\n    }\n    __decorate([\n        Collection([], Cell)\n    ], Row.prototype, \"cells\", void 0);\n    __decorate([\n        Property(0)\n    ], Row.prototype, \"index\", void 0);\n    __decorate([\n        Property(20)\n    ], Row.prototype, \"height\", void 0);\n    __decorate([\n        Property(false)\n    ], Row.prototype, \"customHeight\", void 0);\n    __decorate([\n        Property(false)\n    ], Row.prototype, \"hidden\", void 0);\n    __decorate([\n        Complex({}, Format)\n    ], Row.prototype, \"format\", void 0);\n    return Row;\n}(ChildProperty));\nexport { Row };\n/**\n * @hidden\n */\nexport function getRow(sheet, rowIndex) {\n    return sheet.rows[rowIndex];\n}\n/** @hidden */\nexport function setRow(sheet, rowIndex, row) {\n    if (!sheet.rows[rowIndex]) {\n        sheet.rows[rowIndex] = {};\n    }\n    Object.keys(row).forEach(function (key) {\n        sheet.rows[rowIndex][key] = row[key];\n    });\n}\n/** @hidden */\nexport function isHiddenRow(sheet, index) {\n    return sheet.rows[index] && sheet.rows[index].hidden;\n}\n/**\n * @hidden\n */\nexport function getRowHeight(sheet, rowIndex) {\n    if (sheet && sheet.rows && sheet.rows[rowIndex]) {\n        if (sheet.rows[rowIndex].hidden) {\n            return 0;\n        }\n        return sheet.rows[rowIndex].height === undefined ? 20 : sheet.rows[rowIndex].height;\n    }\n    else {\n        return 20;\n    }\n}\n/**\n * @hidden\n */\nexport function setRowHeight(sheet, rowIndex, height) {\n    if (sheet && sheet.rows) {\n        if (!sheet.rows[rowIndex]) {\n            sheet.rows[rowIndex] = {};\n        }\n        sheet.rows[rowIndex].height = height;\n    }\n}\n/**\n * @hidden\n */\nexport function getRowsHeight(sheet, startRow, endRow) {\n    if (endRow === void 0) { endRow = startRow; }\n    var height = 0;\n    var swap;\n    if (startRow > endRow) {\n        swap = startRow;\n        startRow = endRow;\n        endRow = swap;\n    }\n    for (var i = startRow; i <= endRow; i++) {\n        height += getRowHeight(sheet, i);\n    }\n    return height;\n}\n","var __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    }\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nimport { ChildProperty, Property, Complex } from '@syncfusion/ej2-base';\nimport { Format } from '../common/index';\n/**\n * Configures the Column behavior for the spreadsheet.\n */\nvar Column = /** @class */ (function (_super) {\n    __extends(Column, _super);\n    function Column() {\n        return _super !== null && _super.apply(this, arguments) || this;\n    }\n    __decorate([\n        Property(0)\n    ], Column.prototype, \"index\", void 0);\n    __decorate([\n        Property(64)\n    ], Column.prototype, \"width\", void 0);\n    __decorate([\n        Property(false)\n    ], Column.prototype, \"customWidth\", void 0);\n    __decorate([\n        Property(false)\n    ], Column.prototype, \"hidden\", void 0);\n    __decorate([\n        Complex({}, Format)\n    ], Column.prototype, \"format\", void 0);\n    __decorate([\n        Property(true)\n    ], Column.prototype, \"isLocked\", void 0);\n    return Column;\n}(ChildProperty));\nexport { Column };\n/**\n * @hidden\n */\nexport function getColumn(sheet, colIndex) {\n    if (sheet.columns) {\n        if (!sheet.columns[colIndex]) {\n            sheet.columns[colIndex] = {};\n        }\n    }\n    else {\n        sheet.columns = [];\n        sheet.columns[colIndex] = {};\n    }\n    return sheet.columns[colIndex];\n}\n/** @hidden */\nexport function setColumn(sheet, colIndex, column) {\n    var curColumn = getColumn(sheet, colIndex);\n    Object.keys(column).forEach(function (key) {\n        curColumn[key] = column[key];\n    });\n}\n/**\n * @hidden\n */\nexport function getColumnWidth(sheet, index, skipHidden) {\n    if (sheet && sheet.columns && sheet.columns[index]) {\n        if (!skipHidden && sheet.columns[index].hidden) {\n            return 0;\n        }\n        return (sheet.columns[index].width || sheet.columns[index].customWidth) ? sheet.columns[index].width : 64;\n    }\n    else {\n        return 64;\n    }\n}\n/**\n * @hidden\n */\nexport function getColumnsWidth(sheet, startCol, endCol) {\n    if (endCol === void 0) { endCol = startCol; }\n    var width = 0;\n    if (startCol > endCol) {\n        var swap = startCol;\n        startCol = endCol;\n        endCol = swap;\n    }\n    for (var i = startCol; i <= endCol; i++) {\n        width += getColumnWidth(sheet, i);\n    }\n    return width;\n}\n/** @hidden */\nexport function isHiddenCol(sheet, index) {\n    return sheet.columns[index] && sheet.columns[index].hidden;\n}\n","import { getWorkbookRequiredModules } from '../../workbook/common/module';\n/**\n * To get Spreadsheet required modules.\n * @hidden\n * @param {Spreadsheet} context\n */\nexport function getRequiredModules(context) {\n    var modules = [];\n    pushBasicModules(context, modules);\n    getWorkbookRequiredModules(context, modules);\n    return modules;\n}\n// tslint:disable-next-line:max-func-body-length\nfunction pushBasicModules(context, modules) {\n    modules.push({ member: 'basic', args: [] });\n    modules.push({ member: 'all', args: [] });\n    if (context.showRibbon) {\n        modules.push({\n            member: 'ribbon',\n            args: [context]\n        });\n    }\n    if (context.showFormulaBar) {\n        modules.push({\n            member: 'formulaBar',\n            args: [context]\n        });\n    }\n    if (context.showSheetTabs) {\n        modules.push({\n            member: 'sheetTabs',\n            args: [context]\n        });\n    }\n    if (context.allowEditing) {\n        modules.push({\n            member: 'edit',\n            args: [context]\n        });\n        modules.push({\n            member: 'formula',\n            args: [context]\n        });\n        modules.push({\n            member: 'workbookFormula',\n            args: [context]\n        });\n        modules.push({\n            member: 'workbookEdit',\n            args: [context]\n        });\n    }\n    if (context.allowOpen) {\n        modules.push({\n            member: 'open',\n            args: [context]\n        });\n    }\n    if (context.allowSave) {\n        modules.push({\n            member: 'save',\n            args: [context]\n        });\n    }\n    if (context.enableContextMenu) {\n        modules.push({\n            member: 'contextMenu',\n            args: [context]\n        });\n    }\n    if (context.selectionSettings.mode !== 'None') {\n        modules.push({\n            member: 'selection',\n            args: [context]\n        });\n    }\n    if (context.enableKeyboardNavigation) {\n        modules.push({\n            member: 'keyboardNavigation',\n            args: [context]\n        });\n    }\n    if (context.allowNumberFormatting) {\n        modules.push({\n            member: 'numberFormat',\n            args: [context]\n        });\n    }\n    if (context.enableKeyboardShortcut) {\n        modules.push({\n            member: 'keyboardShortcut',\n            args: [context]\n        });\n    }\n    if (context.enableClipboard) {\n        modules.push({\n            member: 'clipboard',\n            args: [context]\n        });\n    }\n    if (context.allowCellFormatting) {\n        modules.push({\n            member: 'cellformat',\n            args: [context]\n        });\n    }\n    if (context.allowSorting) {\n        modules.push({ member: 'sort', args: [context] });\n    }\n    if (context.allowResizing) {\n        modules.push({\n            member: 'resize',\n            args: [context]\n        });\n    }\n    modules.push({\n        member: 'collaborativeEditing',\n        args: [context]\n    });\n    modules.push({\n        member: 'protectSheet',\n        args: [context]\n    });\n    if (context.allowHyperlink) {\n        modules.push({\n            member: 'spreadsheetHyperlink',\n            args: [context]\n        });\n    }\n    if (context.allowUndoRedo) {\n        modules.push({\n            member: 'undoredo',\n            args: [context]\n        });\n    }\n    if (context.allowFiltering) {\n        modules.push({ member: 'filter', args: [context] });\n    }\n    if (context.allowWrap) {\n        modules.push({ member: 'wrapText', args: [context] });\n    }\n    if (context.allowInsert) {\n        modules.push({ member: 'insert', args: [context] });\n    }\n    if (context.allowDelete) {\n        modules.push({ member: 'delete', args: [context] });\n    }\n    if (context.allowDataValidation) {\n        modules.push({ member: 'dataValidation', args: [context] });\n    }\n    if (context.allowFindAndReplace) {\n        modules.push({ member: 'findAndReplace', args: [context] });\n    }\n    if (context.allowMerge) {\n        modules.push({ member: 'merge', args: [context] });\n    }\n    if (context.allowConditionalFormat) {\n        modules.push({ member: 'conditionalFormatting', args: [context] });\n    }\n    if (context.allowImage) {\n        modules.push({ member: 'spreadsheetImage', args: [context] });\n    }\n    if (context.allowChart) {\n        modules.push({ member: 'spreadsheetChart', args: [context] });\n    }\n}\n","import { Browser, setStyleAttribute as setBaseStyleAttribute, getComponent } from '@syncfusion/ej2-base';\nimport { clearViewer, deleteImage, createImageElement, refreshImgCellObj } from './index';\nimport { getRowsHeight, getColumnsWidth, getSwapRange, clearCells } from '../../workbook/index';\nimport { getRangeIndexes, wrap, setRowHeight, insertModel, } from '../../workbook/index';\nimport { initiateSort, getIndexesFromAddress, getRowHeight, setMerge } from '../../workbook/index';\nimport { setValidation, removeValidation, clearCFRule, setCFRule } from '../../workbook/index';\nimport { removeSheetTab, rowHeightChanged } from './index';\nimport { getCellIndexes, getCell, getColumnWidth, setChart, refreshChartSize } from '../../workbook/index';\nimport { deleteChart } from '../../spreadsheet/index';\nimport { initiateFilterUI } from './event';\n/**\n * The function used to update Dom using requestAnimationFrame.\n * @param  {Function} fn - Function that contains the actual action\n * @return {Promise<T>}\n * @hidden\n */\nexport function getUpdateUsingRaf(fn) {\n    requestAnimationFrame(function () {\n        fn();\n    });\n}\n/**\n * The function used to remove the dom element children.\n * @param  parent -\n * @hidden\n */\nexport function removeAllChildren(parent, index) {\n    while (parent.firstChild) {\n        parent.removeChild(parent.firstChild);\n    }\n}\n/**\n * The function used to get colgroup width based on the row index.\n * @param  parent -\n * @hidden\n */\nexport function getColGroupWidth(index) {\n    var width = 30;\n    if (index.toString().length > 3) {\n        width = index.toString().length * 10;\n    }\n    return width;\n}\nvar scrollAreaWidth = null;\n/** @hidden */\nexport function getScrollBarWidth() {\n    if (scrollAreaWidth !== null) {\n        return scrollAreaWidth;\n    }\n    var htmlDivNode = document.createElement('div');\n    var result = 0;\n    htmlDivNode.style.cssText = 'width:100px;height: 100px;overflow: scroll;position: absolute;top: -9999px;';\n    document.body.appendChild(htmlDivNode);\n    result = (htmlDivNode.offsetWidth - htmlDivNode.clientWidth) | 0;\n    document.body.removeChild(htmlDivNode);\n    return scrollAreaWidth = result;\n}\nvar classes = ['e-ribbon', 'e-formula-bar-panel', 'e-sheet-tab-panel', 'e-header-toolbar'];\n/** @hidden */\nexport function getSiblingsHeight(element, classList) {\n    if (classList === void 0) { classList = classes; }\n    var previous = getHeightFromDirection(element, 'previous', classList);\n    var next = getHeightFromDirection(element, 'next', classList);\n    return previous + next;\n}\nfunction getHeightFromDirection(element, direction, classList) {\n    // tslint:disable-next-line:no-any\n    var sibling = (element)[direction + 'ElementSibling'];\n    var result = 0;\n    while (sibling) {\n        if (classList.some(function (value) { return sibling.classList.contains(value); })) {\n            result += sibling.offsetHeight;\n        }\n        // tslint:disable-next-line:no-any\n        sibling = (sibling)[direction + 'ElementSibling'];\n    }\n    return result;\n}\n/**\n * @hidden\n */\nexport function inView(context, range, isModify) {\n    if (context.scrollSettings.enableVirtualization) {\n        var topIdx = context.viewport.topIndex;\n        var leftIdx = context.viewport.leftIndex;\n        var bottomIdx = topIdx + context.viewport.rowCount + context.getThreshold('row') * 2;\n        var rightIdx = leftIdx + context.viewport.colCount + context.getThreshold('col') * 2;\n        var inView_1 = topIdx <= range[0] && bottomIdx >= range[2] && leftIdx <= range[1] && rightIdx >= range[3];\n        if (inView_1) {\n            return true;\n        }\n        if (isModify) {\n            if (range[0] < topIdx && range[2] < topIdx || range[0] > bottomIdx && range[2] > bottomIdx) {\n                return false;\n            }\n            else {\n                if (range[0] < topIdx && range[2] > topIdx) {\n                    range[0] = topIdx;\n                    inView_1 = true;\n                }\n                if (range[2] > bottomIdx) {\n                    range[2] = bottomIdx;\n                    inView_1 = true;\n                }\n            }\n            if (range[1] < leftIdx && range[3] < leftIdx || range[1] > rightIdx && range[3] > rightIdx) {\n                return false;\n            }\n            else {\n                if (range[1] < leftIdx && range[3] > leftIdx) {\n                    range[1] = leftIdx;\n                    inView_1 = true;\n                }\n                if (range[3] > rightIdx) {\n                    range[3] = rightIdx;\n                    inView_1 = true;\n                }\n            }\n        }\n        return inView_1;\n    }\n    else {\n        return true;\n    }\n}\n/**\n * To get the top left cell position in viewport.\n * @hidden\n */\nexport function getCellPosition(sheet, indexes, offset) {\n    if (offset === void 0) { offset = { left: { idx: 0, size: 0 }, top: { idx: 0, size: 0 } }; }\n    var i;\n    var top = offset.top.size;\n    var left = offset.left.size;\n    for (i = offset.top.idx; i < indexes[0]; i++) {\n        top += getRowsHeight(sheet, i);\n    }\n    for (i = offset.left.idx; i < indexes[1]; i++) {\n        left += getColumnsWidth(sheet, i);\n    }\n    return { top: top, left: left };\n}\n/**\n * Position element with given range\n * @hidden\n */\nexport function locateElem(ele, range, sheet, isRtl, offset) {\n    var swapRange = getSwapRange(range);\n    var cellPosition = getCellPosition(sheet, swapRange, offset);\n    var startIndex = [skipHiddenIdx(sheet, 0, true), skipHiddenIdx(sheet, 0, true, 'columns')];\n    var attrs = {\n        'top': (swapRange[0] === startIndex[0] ? cellPosition.top : cellPosition.top - 1) + 'px',\n        'height': getRowsHeight(sheet, range[0], range[2]) + (swapRange[0] === startIndex[0] ? 0 : 1) + 'px',\n        'width': getColumnsWidth(sheet, range[1], range[3]) + (swapRange[1] === startIndex[1] ? 0 : 1) + 'px'\n    };\n    attrs[isRtl ? 'right' : 'left'] = (swapRange[1] === startIndex[1] ? cellPosition.left : cellPosition.left - 1) + 'px';\n    if (ele) {\n        setStyleAttribute([{ element: ele, attrs: attrs }]);\n    }\n}\n/**\n * To update element styles using request animation frame\n * @hidden\n */\nexport function setStyleAttribute(styles) {\n    requestAnimationFrame(function () {\n        styles.forEach(function (style) {\n            setBaseStyleAttribute(style.element, style.attrs);\n        });\n    });\n}\n/**\n * @hidden\n */\nexport function getStartEvent() {\n    return (Browser.isPointer ? 'pointerdown' : 'mousedown touchstart');\n}\n/**\n * @hidden\n */\nexport function getMoveEvent() {\n    return (Browser.isPointer ? 'pointermove' : 'mousemove touchmove');\n}\n/**\n * @hidden\n */\nexport function getEndEvent() {\n    return (Browser.isPointer ? 'pointerup' : 'mouseup touchend');\n}\n/**\n * @hidden\n */\nexport function isTouchStart(e) {\n    return e.type === 'touchstart' || (e.type === 'pointerdown' && e.pointerType === 'touch');\n}\n/**\n * @hidden\n */\nexport function isTouchMove(e) {\n    return e.type === 'touchmove' || (e.type === 'pointermove' && e.pointerType === 'touch');\n}\n/**\n * @hidden\n */\nexport function isTouchEnd(e) {\n    return e.type === 'touchend' || (e.type === 'pointerup' && e.pointerType === 'touch');\n}\n/**\n * @hidden\n */\nexport function getClientX(e) {\n    return e.changedTouches ? e.changedTouches[0].clientX : e.clientX;\n}\n/**\n * @hidden\n */\nexport function getClientY(e) {\n    return e.changedTouches ? e.changedTouches[0].clientY : e.clientY;\n}\nvar config = {\n    role: 'role',\n    selected: 'aria-selected',\n    multiselectable: 'aria-multiselectable',\n    busy: 'aria-busy',\n    colcount: 'aria-colcount'\n};\n/** @hidden */\nexport function setAriaOptions(target, options) {\n    var props = Object.keys(options);\n    props.forEach(function (name) {\n        if (target) {\n            target.setAttribute(config[name], options[name]);\n        }\n    });\n}\n/**\n * @hidden\n */\nexport function destroyComponent(element, component) {\n    if (element) {\n        var compObj = getComponent(element, component);\n        if (compObj) {\n            compObj.destroy();\n        }\n    }\n}\n/**\n * @hidden\n */\n// tslint:disable-next-line:max-func-body-length\nexport function setResize(index, value, isCol, parent) {\n    var curEle;\n    var curEleH;\n    var curEleC;\n    var preEle;\n    var preEleH;\n    var preEleC;\n    var nxtEle;\n    var nxtEleH;\n    var nxtEleC;\n    var sheet = parent.getActiveSheet();\n    if (isCol) {\n        curEle = parent.element.getElementsByClassName('e-column-header')[0].getElementsByTagName('th')[index];\n        curEleH = parent.element.getElementsByClassName('e-column-header')[0].getElementsByTagName('col')[index];\n        curEleC = parent.element.getElementsByClassName('e-sheet-content')[0].getElementsByTagName('col')[index];\n    }\n    else {\n        curEle = parent.element.getElementsByClassName('e-row-header')[0].getElementsByTagName('tr')[index];\n        curEleH = parent.element.getElementsByClassName('e-row-header')[0].getElementsByTagName('tr')[index];\n        curEleC = parent.element.getElementsByClassName('e-sheet-content')[0].getElementsByTagName('tr')[index];\n        curEleH.style.height = parseInt(value, 10) > 0 ? value : '2px';\n        curEleC.style.height = parseInt(value, 10) > 0 ? value : '0px';\n        var hdrRow = parent.getRowHeaderContent().getElementsByClassName('e-row');\n        var hdrClone = [];\n        hdrClone[0] = hdrRow[index].getElementsByTagName('td')[0].cloneNode(true);\n        var hdrFntSize = findMaxValue(parent.getRowHeaderTable(), hdrClone, false, parent) + 1;\n        var contentRow = parent.getMainContent().getElementsByClassName('e-row');\n        var contentClone = [];\n        for (var idx = 0; idx < contentRow[index].getElementsByTagName('td').length; idx++) {\n            contentClone[idx] = contentRow[index].getElementsByTagName('td')[idx].cloneNode(true);\n        }\n        var cntFntSize = findMaxValue(parent.getContentTable(), contentClone, false, parent) + 1;\n        var fntSize = hdrFntSize >= cntFntSize ? hdrFntSize : cntFntSize;\n        if (parseInt(curEleC.style.height, 10) < fntSize ||\n            (curEle.classList.contains('e-reach-fntsize') && parseInt(curEleC.style.height, 10) === fntSize)) {\n            curEle.classList.add('e-reach-fntsize');\n            curEleH.style.lineHeight = parseInt(value, 10) >= 4 ? ((parseInt(value, 10)) - 4) + 'px' :\n                parseInt(value, 10) > 0 ? ((parseInt(value, 10)) - 1) + 'px' : '0px';\n            curEleC.style.lineHeight = parseInt(value, 10) > 0 ? ((parseInt(value, 10)) - 1) + 'px' : '0px';\n        }\n        else {\n            curEleH.style.removeProperty('line-height');\n            curEleC.style.removeProperty('line-height');\n            if (curEle.classList.contains('e-reach-fntsize')) {\n                curEle.classList.remove('e-reach-fntsize');\n            }\n        }\n    }\n    preEle = curEle.previousElementSibling;\n    nxtEle = curEle.nextElementSibling;\n    if (preEle) {\n        preEle = curEle.previousElementSibling;\n        preEleH = curEleH.previousElementSibling;\n        preEleC = curEleC.previousElementSibling;\n    }\n    if (nxtEle) {\n        nxtEle = curEle.nextElementSibling;\n        nxtEleH = curEleH.nextElementSibling;\n        nxtEleC = curEleC.nextElementSibling;\n    }\n    if (parseInt(value, 10) <= 0 && !(curEle.classList.contains('e-zero') || curEle.classList.contains('e-zero-start'))) {\n        if (preEle && nxtEle) {\n            if (isCol) {\n                curEleH.style.width = '2px';\n                curEleC.style.width = '0px';\n            }\n            else {\n                curEleH.style.height = '2px';\n                curEleC.style.height = '0px';\n            }\n            if (preEle.classList.contains('e-zero-start')) {\n                curEle.classList.add('e-zero-start');\n                curEleC.classList.add('e-zero-start');\n            }\n            else {\n                curEle.classList.add('e-zero');\n                curEleC.classList.add('e-zero');\n            }\n            if (!nxtEle.classList.contains('e-zero') && !nxtEle.classList.contains('e-zero-last')) {\n                curEle.classList.add('e-zero-last');\n                curEleC.classList.add('e-zero-last');\n            }\n            if (preEle.classList.contains('e-zero-last')) {\n                preEle.classList.remove('e-zero-last');\n                preEleC.classList.remove('e-zero-last');\n            }\n            if (preEle.classList.contains('e-zero')) {\n                if (curEle.classList.contains('e-zero-end')) {\n                    setWidthAndHeight(preEleH, -2, isCol);\n                }\n                else {\n                    setWidthAndHeight(preEleH, -2, isCol);\n                }\n            }\n            else {\n                setWidthAndHeight(preEleH, -1, isCol);\n            }\n            if (preEle.classList.contains('e-zero-start')) {\n                setWidthAndHeight(curEleH, -1, isCol);\n            }\n            if (nxtEle.classList.contains('e-zero')) {\n                if (curEle.classList.contains('e-zero-start')) {\n                    while (nxtEle) {\n                        if (nxtEle.classList.contains('e-zero') && (parseInt(nxtEleH.style.height, 10) !== 0 && !isCol) ||\n                            (parseInt(nxtEleH.style.width, 10) !== 0 && isCol)) {\n                            if (isCol) {\n                                curEleH.style.width = parseInt(curEleH.style.width, 10) - 1 + 'px';\n                                nxtEleH.style.width = parseInt(nxtEleH.style.width, 10) - 1 + 'px';\n                            }\n                            else {\n                                curEleH.style.height = parseInt(curEleH.style.height, 10) - 1 + 'px';\n                                nxtEleH.style.height = parseInt(nxtEleH.style.height, 10) - 1 + 'px';\n                            }\n                            nxtEle.classList.remove('e-zero');\n                            nxtEle.classList.add('e-zero-start');\n                            break;\n                        }\n                        else {\n                            var nxtIndex = void 0;\n                            nxtEle.classList.remove('e-zero');\n                            nxtEle.classList.add('e-zero-start');\n                            if (isCol) {\n                                nxtIndex = parseInt(nxtEle.getAttribute('aria-colindex'), 10) - 1;\n                                nxtEle = parent.getColHeaderTable().getElementsByTagName('th')[nxtIndex + 1];\n                                nxtEleH = parent.getColHeaderTable().getElementsByTagName('col')[nxtIndex + 1];\n                            }\n                            else {\n                                nxtIndex = parseInt(nxtEle.getAttribute('aria-rowindex'), 10) - 1;\n                                nxtEle = parent.getRowHeaderTable().getElementsByTagName('tr')[nxtIndex + 1];\n                                nxtEleH = parent.getRowHeaderTable().getElementsByTagName('tr')[nxtIndex + 1];\n                            }\n                        }\n                    }\n                }\n                else {\n                    setWidthAndHeight(curEleH, -2, isCol);\n                }\n            }\n            else {\n                if (nxtEle.classList.contains('e-zero-end')) {\n                    if (isCol) {\n                        curEleH.style.width = '0px';\n                    }\n                    else {\n                        curEleH.style.height = '0px';\n                    }\n                }\n                else {\n                    setWidthAndHeight(nxtEleH, -1, isCol);\n                }\n            }\n        }\n        else if (preEle) {\n            if (isCol) {\n                curEleH.style.width = '1px';\n                curEleC.style.width = '0px';\n            }\n            else {\n                curEleH.style.height = '1px';\n                curEleC.style.height = '0px';\n            }\n            curEle.classList.add('e-zero-end');\n            curEleC.classList.add('e-zero-end');\n            curEle.classList.add('e-zero-last');\n            curEleC.classList.add('e-zero-last');\n            if (preEle.classList.contains('e-zero')) {\n                setWidthAndHeight(preEleH, -2, isCol);\n            }\n            else {\n                setWidthAndHeight(preEleH, -1, isCol);\n            }\n        }\n        else if (nxtEle) {\n            curEle.classList.add('e-zero-start');\n            curEleC.classList.add('e-zero-start');\n            if (!nxtEle.classList.contains('e-zero')) {\n                curEle.classList.add('e-zero-last');\n                curEleC.classList.add('e-zero-last');\n            }\n            if (isCol) {\n                curEleH.style.width = '1px';\n                curEleC.style.width = '0px';\n            }\n            else {\n                curEleH.style.height = '1px';\n                curEleC.style.height = '0px';\n            }\n            if (nxtEle.classList.contains('e-zero')) {\n                while (nxtEle) {\n                    if (nxtEle.classList.contains('e-zero') && (parseInt(nxtEleH.style.width, 10) !== 0\n                        && isCol) || (parseInt(nxtEleH.style.height, 10) !== 0 && !isCol)) {\n                        if (isCol) {\n                            nxtEleH.style.width = parseInt(nxtEleH.style.width, 10) - 1 + 'px';\n                            curEleH.style.width = parseInt(curEleH.style.width, 10) - 1 + 'px';\n                        }\n                        else {\n                            nxtEleH.style.height = parseInt(nxtEleH.style.height, 10) - 1 + 'px';\n                            curEleH.style.height = parseInt(curEleH.style.height, 10) - 1 + 'px';\n                        }\n                        nxtEle.classList.add('e-zero-start');\n                        nxtEle.classList.remove('e-zero');\n                        break;\n                    }\n                    else {\n                        var nxtIndex = void 0;\n                        nxtEle.classList.add('e-zero-start');\n                        nxtEle.classList.remove('e-zero');\n                        if (isCol) {\n                            nxtIndex = parseInt(nxtEle.getAttribute('aria-colindex'), 10) - 1;\n                            nxtEleH = parent.getColHeaderTable().getElementsByTagName('col')[nxtIndex + 1];\n                            nxtEle = parent.getColHeaderTable().getElementsByTagName('th')[nxtIndex + 1];\n                        }\n                        else {\n                            nxtIndex = parseInt(nxtEle.getAttribute('aria-rowindex'), 10) - 1;\n                            nxtEleH = parent.getRowHeaderTable().getElementsByTagName('tr')[nxtIndex + 1];\n                            nxtEle = parent.getRowHeaderTable().getElementsByTagName('tr')[nxtIndex + 1];\n                        }\n                    }\n                }\n            }\n            else {\n                setWidthAndHeight(nxtEleH, -1, isCol);\n            }\n        }\n    }\n    else if (parseInt(value, 10) > 0) {\n        if (isCol) {\n            curEleH.style.width = value;\n            curEleC.style.width = value;\n        }\n        else {\n            curEleH.style.height = value;\n            curEleC.style.height = value;\n        }\n        if (preEle && nxtEle) {\n            if (preEle.classList.contains('e-zero')) {\n                if (curEle.classList.contains('e-zero')) {\n                    if (isCol) {\n                        preEleH.style.width = parseInt(preEleH.style.width, 10) + 2 + 'px';\n                        curEleH.style.width = parseInt(curEleH.style.width, 10) - 1 + 'px';\n                    }\n                    else {\n                        preEleH.style.height = parseInt(preEleH.style.height, 10) + 2 + 'px';\n                        curEleH.style.height = parseInt(curEleH.style.height, 10) - 1 + 'px';\n                    }\n                }\n                else {\n                    setWidthAndHeight(curEleH, -1, isCol);\n                }\n            }\n            else {\n                if (curEle.classList.contains('e-zero')) {\n                    setWidthAndHeight(preEleH, 1, isCol);\n                }\n                else {\n                    if (curEle.classList.contains('e-zero-start')) {\n                        if (isCol) {\n                            preEleH.style.width = parseInt(preEleH.style.width, 10) + 1 + 'px';\n                            curEleH.style.width = parseInt(curEleH.style.width, 10) - 1 + 'px';\n                        }\n                        else {\n                            preEleH.style.height = parseInt(preEleH.style.height, 10) + 1 + 'px';\n                            curEleH.style.height = parseInt(curEleH.style.height, 10) - 1 + 'px';\n                        }\n                    }\n                }\n            }\n            if (nxtEle.classList.contains('e-zero')) {\n                setWidthAndHeight(curEleH, -1, isCol);\n            }\n            else {\n                if (curEle.classList.contains('e-zero') || curEle.classList.contains('e-zero-start')) {\n                    setWidthAndHeight(nxtEleH, 1, isCol);\n                }\n            }\n            if (curEle.classList.contains('e-zero')) {\n                curEle.classList.remove('e-zero');\n            }\n            if (curEle.classList.contains('e-zero-start')) {\n                curEle.classList.remove('e-zero-start');\n            }\n            if (curEleC.classList.contains('e-zero')) {\n                curEleC.classList.remove('e-zero');\n            }\n            if (curEleC.classList.contains('e-zero-start')) {\n                curEleC.classList.remove('e-zero-start');\n            }\n            if (curEle.classList.contains('e-zero-last')) {\n                curEle.classList.remove('e-zero-last');\n            }\n            if (curEleC.classList.contains('e-zero-last')) {\n                curEleC.classList.remove('e-zero-last');\n            }\n            if (preEle.classList.contains('e-zero') || preEle.classList.contains('e-zero-start')) {\n                preEle.classList.add('e-zero-last');\n                preEleC.classList.add('e-zero-last');\n            }\n        }\n        else if (preEle) {\n            if (preEle.classList.contains('e-zero')) {\n                if (curEle.classList.contains('e-zero')) {\n                    if (isCol) {\n                        curEleH.style.width = parseInt(curEleH.style.width, 10) - 1 + 'px';\n                        preEleH.style.width = parseInt(preEleH.style.width, 10) + 2 + 'px';\n                    }\n                    else {\n                        curEleH.style.height = parseInt(curEleH.style.height, 10) - 1 + 'px';\n                        preEleH.style.height = parseInt(preEleH.style.height, 10) + 2 + 'px';\n                    }\n                }\n                else {\n                    setWidthAndHeight(curEleH, -1, isCol);\n                }\n            }\n            else {\n                if (curEle.classList.contains('e-zero')) {\n                    setWidthAndHeight(preEleH, 1, isCol);\n                }\n                else {\n                    setWidthAndHeight(curEleH, -1, isCol);\n                }\n            }\n            if (curEle.classList.contains('e-zero')) {\n                curEle.classList.remove('e-zero');\n            }\n            if (curEle.classList.contains('e-zero-end')) {\n                curEle.classList.remove('e-zero-end');\n            }\n            if (curEleC.classList.contains('e-zero')) {\n                curEleC.classList.remove('e-zero');\n            }\n            if (curEleC.classList.contains('e-zero-end')) {\n                curEleC.classList.remove('e-zero-end');\n            }\n        }\n        else if (nxtEle) {\n            if (nxtEle.classList.contains('e-zero')) {\n                setWidthAndHeight(curEleH, -1, isCol);\n            }\n            else if (curEle.classList.contains('e-zero-start')) {\n                setWidthAndHeight(nxtEleH, 1, isCol);\n                curEle.classList.remove('e-zero-start');\n            }\n            if (curEle.classList.contains('e-zero')) {\n                curEle.classList.remove('e-zero');\n            }\n            if (curEleC.classList.contains('e-zero')) {\n                curEleC.classList.remove('e-zero');\n            }\n            if (curEle.classList.contains('e-zero-start')) {\n                curEle.classList.remove('e-zero-start');\n            }\n            if (curEleC.classList.contains('e-zero-start')) {\n                curEleC.classList.remove('e-zero-start');\n            }\n        }\n    }\n}\n/**\n * @hidden\n */\nexport function setWidthAndHeight(trgt, value, isCol) {\n    if (isCol) {\n        trgt.style.width = parseInt(trgt.style.width, 10) + value + 'px';\n    }\n    else {\n        trgt.style.height = parseInt(trgt.style.height, 10) + value + 'px';\n    }\n}\n/**\n * @hidden\n */\nexport function findMaxValue(table, text, isCol, parent, prevData, isWrap) {\n    var myTableDiv = parent.createElement('div', { className: parent.element.className, styles: 'display: block' });\n    var myTable = parent.createElement('table', {\n        className: table.className + 'e-resizetable',\n        styles: 'width: auto;height: auto'\n    });\n    var myTr = parent.createElement('tr');\n    if (isCol) {\n        text.forEach(function (element) {\n            var tr = myTr.cloneNode();\n            tr.appendChild(element);\n            myTable.appendChild(tr);\n        });\n    }\n    else {\n        text.forEach(function (element) {\n            myTr.appendChild(element.cloneNode(true));\n        });\n        myTable.appendChild(myTr);\n    }\n    myTableDiv.appendChild(myTable);\n    document.body.appendChild(myTableDiv);\n    var offsetWidthValue;\n    var offsetHeightValue;\n    if (!isWrap) {\n        offsetHeightValue = myTable.getBoundingClientRect().height;\n        offsetWidthValue = myTable.getBoundingClientRect().width;\n    }\n    else {\n        offsetHeightValue = parseInt(prevData, 10);\n        offsetWidthValue = parseInt(prevData, 10);\n    }\n    document.body.removeChild(myTableDiv);\n    if (isCol) {\n        return Math.ceil(offsetWidthValue);\n    }\n    else {\n        return Math.ceil(offsetHeightValue);\n    }\n}\n/**\n * @hidden\n */\n// tslint:disable-next-line\nexport function updateAction(options, spreadsheet, isRedo) {\n    /* tslint:disable-next-line no-any */\n    var eventArgs = options.eventArgs;\n    switch (options.action) {\n        case 'sorting':\n            var args = {\n                range: options.eventArgs.range,\n                sortOptions: options.eventArgs.sortOptions,\n                cancel: false\n            };\n            var promise = new Promise(function (resolve, reject) {\n                resolve((function () { })());\n            });\n            var sortArgs = { args: args, promise: promise };\n            spreadsheet.notify(initiateSort, sortArgs);\n            sortArgs.promise.then(function (args) {\n                spreadsheet.serviceLocator.getService('cell').refreshRange(getIndexesFromAddress(args.range));\n            });\n            break;\n        case 'cellSave':\n            var cellEvtArgs = options.eventArgs;\n            var cellValue = eventArgs.formula ? { formula: cellEvtArgs.formula } : { value: cellEvtArgs.value };\n            spreadsheet.updateCell(cellValue, cellEvtArgs.address);\n            break;\n        case 'format':\n            if (eventArgs.requestType === 'CellFormat') {\n                spreadsheet.cellFormat(eventArgs.style, eventArgs.range);\n            }\n            else {\n                spreadsheet.numberFormat(eventArgs.format, eventArgs.range);\n            }\n            break;\n        case 'clipboard':\n            if (eventArgs.copiedInfo.isCut && !isRedo) {\n                return;\n            }\n            var clipboardPromise = eventArgs.copiedInfo.isCut ? spreadsheet.cut(eventArgs.copiedRange)\n                : spreadsheet.copy(eventArgs.copiedRange);\n            clipboardPromise.then(function (args) {\n                spreadsheet.paste(eventArgs.pastedRange, eventArgs.type);\n            });\n            break;\n        case 'gridLines':\n            spreadsheet.setSheetPropertyOnMute(spreadsheet.sheets[eventArgs.sheetIdx], 'showGridLines', eventArgs.isShow);\n            break;\n        case 'headers':\n            spreadsheet.setSheetPropertyOnMute(spreadsheet.sheets[eventArgs.sheetIdx], 'showHeaders', eventArgs.isShow);\n            break;\n        case 'resize':\n        case 'resizeToFit':\n            if (eventArgs.isCol) {\n                if (eventArgs.hide === undefined) {\n                    spreadsheet.setColWidth(eventArgs.width, eventArgs.index, eventArgs.sheetIdx);\n                }\n                else {\n                    spreadsheet.hideColumn(eventArgs.index, eventArgs.index, eventArgs.hide);\n                }\n            }\n            else {\n                if (eventArgs.hide === undefined) {\n                    spreadsheet.setRowHeight(eventArgs.height, eventArgs.index, eventArgs.sheetIdx);\n                }\n                else {\n                    spreadsheet.hideRow(eventArgs.index, eventArgs.index, eventArgs.hide);\n                }\n            }\n            break;\n        case 'renameSheet':\n            spreadsheet.setSheetPropertyOnMute(spreadsheet.sheets[eventArgs.index - 1], 'name', eventArgs.value);\n            break;\n        case 'removeSheet':\n            spreadsheet.notify(removeSheetTab, {\n                index: eventArgs.index,\n                isAction: true,\n                count: eventArgs.sheetCount,\n                clicked: true\n            });\n            break;\n        case 'wrap':\n            wrap(options.eventArgs.address, options.eventArgs.wrap, spreadsheet);\n            break;\n        case 'hideShow':\n            eventArgs.isCol ? spreadsheet.hideColumn(eventArgs.startIndex, eventArgs.endIndex, eventArgs.hide) :\n                spreadsheet.hideRow(eventArgs.startIndex, eventArgs.endIndex, eventArgs.hide);\n            break;\n        case 'replace':\n            spreadsheet.updateCell({ value: eventArgs.compareVal }, eventArgs.address);\n            break;\n        case 'filter':\n            spreadsheet.notify(initiateFilterUI, { predicates: null, range: eventArgs.range, sIdx: eventArgs.index, isCut: true });\n            break;\n        case 'insert':\n            if (isRedo === false) {\n                spreadsheet.delete(options.eventArgs.index, options.eventArgs.index + (options.eventArgs.model.length - 1), options.eventArgs.modelType);\n            }\n            else {\n                spreadsheet.notify(insertModel, {\n                    model: options.eventArgs.modelType === 'Sheet' ? spreadsheet :\n                        spreadsheet.getActiveSheet(), start: options.eventArgs.index, end: options.eventArgs.index +\n                        (options.eventArgs.model.length - 1), modelType: options.eventArgs.modelType,\n                    isAction: false, checkCount: options.eventArgs.sheetCount,\n                    activeSheetIndex: options.eventArgs.activeSheetIndex\n                });\n            }\n            break;\n        case 'delete':\n            if (isRedo === false) {\n                spreadsheet.notify(insertModel, {\n                    model: options.eventArgs.modelType === 'Sheet' ? spreadsheet :\n                        spreadsheet.getActiveSheet(), start: options.eventArgs.deletedModel, modelType: options.eventArgs.modelType,\n                    isAction: false, columnCellsModel: options.eventArgs.deletedCellsModel\n                });\n            }\n            else {\n                spreadsheet.delete(options.eventArgs.startIndex, options.eventArgs.endIndex, options.eventArgs.modelType);\n            }\n            break;\n        case 'validation':\n            if (isRedo) {\n                var rules = {\n                    type: eventArgs.type, operator: eventArgs.operator, value1: eventArgs.value1,\n                    value2: eventArgs.value2, ignoreBlank: eventArgs.ignoreBlank, inCellDropDown: eventArgs.inCellDropDown\n                };\n                spreadsheet.notify(setValidation, { rules: rules, range: eventArgs.range });\n            }\n            else {\n                spreadsheet.notify(removeValidation, { range: eventArgs.range });\n            }\n            break;\n        case 'merge':\n            options.eventArgs.isAction = false;\n            spreadsheet.notify(setMerge, options.eventArgs);\n            break;\n        case 'clear':\n            spreadsheet.notify(clearViewer, { options: options.eventArgs, isPublic: true });\n            break;\n        case 'conditionalFormat':\n            if (isRedo) {\n                var conditionalFormat = {\n                    type: eventArgs.type, cFColor: eventArgs.cFColor, value: eventArgs.value,\n                    range: eventArgs.range\n                };\n                spreadsheet.notify(setCFRule, { conditionalFormat: conditionalFormat });\n            }\n            else {\n                spreadsheet.notify(clearCFRule, { range: eventArgs.range });\n            }\n            break;\n        case 'clearCF':\n            if (isRedo) {\n                spreadsheet.notify(clearCFRule, { range: eventArgs.selectedRange });\n            }\n            else {\n                spreadsheet.notify(clearCells, {\n                    conditionalFormats: eventArgs.cFormats,\n                    oldRange: eventArgs.oldRange, selectedRange: eventArgs.selectedRange\n                });\n            }\n            break;\n        case 'insertImage':\n            if (isRedo) {\n                spreadsheet.notify(createImageElement, {\n                    options: {\n                        src: options.eventArgs.imageData,\n                        height: options.eventArgs.imageHeight, width: options.eventArgs.imageWidth, imageId: options.eventArgs.id\n                    },\n                    range: options.eventArgs.range, isPublic: false, isUndoRedo: true\n                });\n            }\n            else {\n                spreadsheet.notify(deleteImage, {\n                    id: options.eventArgs.id, sheetIdx: options.eventArgs.sheetIndex + 1, range: options.eventArgs.range\n                });\n            }\n            break;\n        case 'imageRefresh':\n            var element = document.getElementById(options.eventArgs.id);\n            if (isRedo) {\n                options.eventArgs.isUndoRedo = true;\n                spreadsheet.notify(refreshImgCellObj, options.eventArgs);\n            }\n            else {\n                spreadsheet.notify(refreshImgCellObj, {\n                    prevTop: options.eventArgs.currentTop, prevLeft: options.eventArgs.currentLeft,\n                    currentTop: options.eventArgs.prevTop, currentLeft: options.eventArgs.prevLeft, id: options.eventArgs.id,\n                    currentHeight: options.eventArgs.prevHeight, currentWidth: options.eventArgs.prevWidth, requestType: 'imageRefresh',\n                    prevHeight: options.eventArgs.currentHeight, prevWidth: options.eventArgs.currentWidth, isUndoRedo: true\n                });\n            }\n            element.style.height = isRedo ? options.eventArgs.currentHeight + 'px' : options.eventArgs.prevHeight + 'px';\n            element.style.width = isRedo ? options.eventArgs.currentWidth + 'px' : options.eventArgs.prevWidth + 'px';\n            element.style.top = isRedo ? options.eventArgs.currentTop + 'px' : options.eventArgs.prevTop + 'px';\n            element.style.left = isRedo ? options.eventArgs.currentLeft + 'px' : options.eventArgs.prevLeft + 'px';\n            break;\n        case 'insertChart':\n            if (isRedo) {\n                var chartOptions = [{\n                        type: eventArgs.type, theme: eventArgs.theme, isSeriesInRows: eventArgs.isSeriesInRows,\n                        range: eventArgs.range, id: eventArgs.id\n                    }];\n                spreadsheet.notify(setChart, {\n                    chart: chartOptions, isInitCell: eventArgs.isInitCell, isUndoRedo: false, range: eventArgs.posRange\n                });\n            }\n            else {\n                spreadsheet.notify(deleteChart, { id: eventArgs.id });\n            }\n            break;\n        case 'deleteChart':\n            if (isRedo) {\n                spreadsheet.notify(deleteChart, { id: eventArgs.id });\n            }\n            else {\n                var chartOpts = [{\n                        type: eventArgs.type, theme: eventArgs.theme, isSeriesInRows: eventArgs.isSeriesInRows,\n                        range: eventArgs.range, id: eventArgs.id\n                    }];\n                spreadsheet.notify(setChart, {\n                    chart: chartOpts, isInitCell: eventArgs.isInitCell, isUndoRedo: false, range: eventArgs.posRange\n                });\n            }\n            break;\n        case 'chartRefresh':\n            var chartElement = document.getElementById(options.eventArgs.id);\n            if (chartElement) {\n                chartElement.style.height = isRedo ? options.eventArgs.currentHeight + 'px' : options.eventArgs.prevHeight + 'px';\n                chartElement.style.width = isRedo ? options.eventArgs.currentWidth + 'px' : options.eventArgs.prevWidth + 'px';\n                chartElement.style.top = isRedo ? options.eventArgs.currentTop + 'px' : options.eventArgs.prevTop + 'px';\n                chartElement.style.left = isRedo ? options.eventArgs.currentLeft + 'px' : options.eventArgs.prevLeft + 'px';\n            }\n            if (isRedo) {\n                options.eventArgs.isUndoRedo = true;\n                spreadsheet.notify(refreshChartSize, {\n                    height: chartElement.style.height, width: chartElement.style.width, overlayEle: chartElement\n                });\n            }\n            else {\n                spreadsheet.notify(refreshChartSize, {\n                    height: chartElement.style.height, width: chartElement.style.width, overlayEle: chartElement\n                });\n            }\n            break;\n    }\n}\n/**\n * @hidden\n */\nexport function hasTemplate(workbook, rowIdx, colIdx, sheetIdx) {\n    var sheet = workbook.sheets[sheetIdx];\n    var ranges = sheet.ranges;\n    var range;\n    for (var i = 0, len = ranges.length; i < len; i++) {\n        if (ranges[i].template) {\n            range = getRangeIndexes(ranges[i].address.length ? ranges[i].address : ranges[i].startCell);\n            if (range[0] <= rowIdx && range[1] <= colIdx && range[2] >= rowIdx && range[3] >= colIdx) {\n                return true;\n            }\n        }\n    }\n    return false;\n}\n/**\n * Setting row height in view an model.\n * @hidden\n */\nexport function setRowEleHeight(parent, sheet, height, rowIdx, row, hRow, notifyRowHgtChange) {\n    if (notifyRowHgtChange === void 0) { notifyRowHgtChange = true; }\n    var prevHgt = getRowHeight(sheet, rowIdx);\n    var edit = parent.element.querySelector('.e-spreadsheet-edit');\n    if (edit && (edit.innerHTML.indexOf('\\n') > -1)) {\n        var actCell = getCellIndexes(parent.getActiveSheet().activeCell);\n        var cell = getCell(actCell[0], actCell[1], sheet);\n        var i = void 0;\n        var splitVal = edit.innerHTML.split('\\n');\n        var n = 0;\n        var valLength = splitVal.length;\n        for (i = 0; i < valLength; i++) {\n            var lines = getLines(splitVal[i], getColumnWidth(sheet, actCell[1]), cell.style, parent.cellStyle);\n            if (lines === 0) {\n                lines = 1; // for empty new line\n            }\n            n = n + lines;\n        }\n        height = getTextHeight(parent, cell.style || parent.cellStyle, n) + 1;\n    }\n    if (row || parent.getRow(rowIdx)) {\n        (row || parent.getRow(rowIdx)).style.height = height + \"px\";\n    }\n    if (sheet.showHeaders && hRow || parent.getRow(rowIdx, parent.getRowHeaderTable())) {\n        (hRow || parent.getRow(rowIdx, parent.getRowHeaderTable())).style.height = height + \"px\";\n    }\n    setRowHeight(sheet, rowIdx, height);\n    parent.setProperties({ sheets: parent.sheets }, true);\n    if (notifyRowHgtChange) {\n        parent.notify(rowHeightChanged, { rowIdx: rowIdx, threshold: height - prevHgt });\n    }\n}\n/** @hidden */\nexport function getTextHeight(context, style, lines) {\n    if (lines === void 0) { lines = 1; }\n    var fontSize = (style && style.fontSize) || context.cellStyle.fontSize;\n    var fontSizePx = fontSize.indexOf('pt') > -1 ? parseInt(fontSize, 10) * 1.33 : parseInt(fontSize, 10);\n    return Math.ceil(fontSizePx * (style && style.fontFamily === 'Arial Black' ? 1.44 : 1.24) * lines);\n}\n/** @hidden */\nexport function getTextWidth(text, style, parentStyle) {\n    if (!style) {\n        style = parentStyle;\n    }\n    var canvas = document.createElement('canvas');\n    var context = canvas.getContext('2d');\n    context.font = (style.fontStyle || parentStyle.fontStyle) + ' ' + (style.fontWeight || parentStyle.fontWeight) + ' '\n        + (style.fontSize || parentStyle.fontSize) + ' ' + (style.fontFamily || parentStyle.fontFamily);\n    return context.measureText(text).width;\n}\n/**\n * @hidden\n */\nexport function getLines(text, colwidth, style, parentStyle) {\n    var width;\n    var prevWidth = 0;\n    var textArr = text.toString().split(' ');\n    var spaceWidth = getTextWidth(' ', style, parentStyle);\n    var lines;\n    var cnt = 0;\n    colwidth -= 5; // for padding\n    textArr.forEach(function (txt) {\n        var lWidth = 0;\n        var cWidth = 0;\n        width = getTextWidth(txt, style, parentStyle);\n        lines = (prevWidth + width) / colwidth;\n        if (lines >= 1) {\n            if (prevWidth) {\n                cnt++;\n            }\n            if (width / colwidth >= 1) {\n                txt.split('').forEach(function (val) {\n                    cWidth = getTextWidth(val, style, parentStyle);\n                    lWidth += cWidth;\n                    if (lWidth > colwidth) {\n                        cnt++;\n                        lWidth = cWidth;\n                    }\n                });\n                prevWidth = lWidth + spaceWidth;\n            }\n            else {\n                prevWidth = width + spaceWidth;\n            }\n        }\n        else {\n            prevWidth += (width + spaceWidth);\n        }\n    });\n    if (prevWidth) {\n        cnt += Math.ceil((prevWidth - spaceWidth) / colwidth);\n    }\n    return cnt;\n}\n/**\n * Setting maximum height while doing formats and wraptext\n * @hidden\n */\nexport function setMaxHgt(sheet, rIdx, cIdx, hgt) {\n    if (!sheet.maxHgts[rIdx]) {\n        sheet.maxHgts[rIdx] = {};\n    }\n    sheet.maxHgts[rIdx][cIdx] = hgt;\n}\n/**\n * Getting maximum height by comparing each cell's modified height.\n * @hidden\n */\nexport function getMaxHgt(sheet, rIdx) {\n    var maxHgt = 0;\n    var rowHgt = sheet.maxHgts[rIdx];\n    if (rowHgt) {\n        Object.keys(rowHgt).forEach(function (key) {\n            if (rowHgt[key] > maxHgt) {\n                maxHgt = rowHgt[key];\n            }\n        });\n    }\n    return maxHgt;\n}\n/** @hidden */\nexport function skipHiddenIdx(sheet, index, increase, layout) {\n    if (layout === void 0) { layout = 'rows'; }\n    if (index < 0) {\n        index = -1;\n    }\n    if ((sheet[layout])[index] && (sheet[layout])[index].hidden) {\n        increase ? index++ : index--;\n        index = skipHiddenIdx(sheet, index, increase, layout);\n    }\n    return index;\n}\n","/**\n * Specifies Workbook internal events.\n */\n/** @hidden */\nexport var workbookDestroyed = 'workbookDestroyed';\n/** @hidden */\nexport var updateSheetFromDataSource = 'updateSheetFromDataSource';\n/** @hidden */\nexport var dataSourceChanged = 'dataSourceChanged';\n/** @hidden */\nexport var dataChanged = 'dataChanged';\n/** @hidden */\nexport var workbookOpen = 'workbookOpen';\n/** @hidden */\nexport var beginSave = 'beginSave';\n/** @hidden */\nexport var getFilteredCollection = 'getFilteredCollection';\n/** @hidden */\nexport var saveCompleted = 'saveCompleted';\n/** @hidden */\nexport var applyNumberFormatting = 'applyNumber';\n/** @hidden */\nexport var getFormattedCellObject = 'getFormattedCell';\n/** @hidden */\nexport var refreshCellElement = 'refreshCellElem';\n/** @hidden */\nexport var setCellFormat = 'setCellFormat';\n/** @hidden */\nexport var findAllValues = 'findAllValues';\n/** @hidden */\nexport var textDecorationUpdate = 'textDecorationUpdate';\n/** @hidden */\nexport var applyCellFormat = 'applyCellFormat';\n/** @hidden */\nexport var updateUsedRange = 'updateUsedRange';\n/** @hidden */\nexport var workbookFormulaOperation = 'workbookFormulaOperation';\n/** @hidden */\nexport var workbookEditOperation = 'workbookEditOperation';\n/** @hidden */\nexport var checkDateFormat = 'checkDateFormat';\n/** @hidden */\nexport var getFormattedBarText = 'getFormattedBarText';\n/** @hidden */\nexport var activeCellChanged = 'activeCellChanged';\n/** @hidden */\nexport var openSuccess = 'openSuccess';\n/** @hidden */\nexport var openFailure = 'openFailure';\n/** @hidden */\nexport var sheetCreated = 'sheetCreated';\n/** @hidden */\nexport var sheetsDestroyed = 'sheetsDestroyed';\n/** @hidden */\nexport var aggregateComputation = 'aggregateComputation';\n/** @hidden */\nexport var beforeSort = 'beforeSort';\n/** @hidden */\nexport var initiateSort = 'initiateSort';\n/** @hidden */\nexport var sortComplete = 'sortComplete';\n/** @hidden */\nexport var sortRangeAlert = 'sortRangeAlert';\n/** @hidden */\nexport var initiatelink = 'initiatelink';\n/** @hidden */\nexport var beforeHyperlinkCreate = 'beforeHyperlinkCreate';\n/** @hidden */\nexport var afterHyperlinkCreate = 'afterHyperlinkCreate';\n/** @hidden */\nexport var beforeHyperlinkClick = 'beforeHyperlinkClick';\n/** @hidden */\nexport var afterHyperlinkClick = 'afterHyperlinkClick';\n/** @hidden */\nexport var addHyperlink = 'addHyperlink';\n/** @hidden */\nexport var setLinkModel = 'setLinkModel';\n/** @hidden */\nexport var beforeFilter = 'beforeFilter';\n/** @hidden */\nexport var initiateFilter = 'initiateFilter';\n/** @hidden */\nexport var filterComplete = 'filterComplete';\n/** @hidden */\nexport var filterRangeAlert = 'filterRangeAlert';\n/** @hidden */\nexport var clearAllFilter = 'clearAllFilter';\n/** @hidden */\nexport var wrapEvent = 'wrapText';\n/** @hidden */\nexport var onSave = 'onSave';\n/** @hidden */\nexport var insert = 'insert';\n/** @hidden */\nexport var deleteAction = 'delete';\n/** @hidden */\nexport var insertModel = 'insertModel';\n/** @hidden */\nexport var deleteModel = 'deleteModel';\n/** @hidden */\nexport var isValidation = 'isValidation';\n/** @hidden */\nexport var setValidation = 'setValidation';\n/** @hidden */\nexport var addHighlight = 'addHighlight';\n/** @hidden */\nexport var dataValidate = 'dataValidate';\n/** @hidden */\nexport var findNext = 'findNext';\n/** @hidden */\nexport var findPrevious = 'findPrevious';\n/** @hidden */\nexport var goto = 'gotoHandler';\n/** @hidden */\nexport var findWorkbookHandler = 'findHandler';\n/** @hidden */\nexport var replaceHandler = 'replace';\n/** @hidden */\nexport var replaceAllHandler = 'replaceAll';\n/** @hidden */\nexport var showDialog = 'ShowDialog';\n/** @hidden */\nexport var findUndoRedo = 'findUndoRedo';\n/** @hidden */\nexport var findKeyUp = 'findKeyUp';\n/** @hidden */\nexport var removeValidation = 'removeValidation';\n/** @hidden */\nexport var removeHighlight = 'removeHighlight';\n/** @hidden */\nexport var queryCellInfo = 'queryCellInfo';\n/** @hidden */\nexport var count = 'count';\n/** @hidden */\nexport var findCount = 'findCount';\n/** @hidden */\nexport var protectSheetWorkBook = 'protectSheet';\n/** @hidden */\nexport var updateToggle = 'updateToggleItem';\n/** @hidden */\nexport var protectsheetHandler = 'protectsheetHandler';\n/** @hidden */\nexport var replaceAllDialog = 'replaceAllDialog';\n/** @hidden */\nexport var unprotectsheetHandler = 'unprotectsheetHandler';\n/** @hidden */\nexport var workBookeditAlert = 'editAlert';\n/** @hidden */\nexport var setLockCells = 'setLockCells';\n/** @hidden */\nexport var applyLockCells = 'applyLockCells';\n/** @hidden */\nexport var setMerge = 'setMerge';\n/** @hidden */\nexport var applyMerge = 'applyMerge';\n/** @hidden */\nexport var mergedRange = 'mergedRange';\n/** @hidden */\nexport var activeCellMergedRange = 'activeCellMergedRange';\n/** @hidden */\nexport var insertMerge = 'insertMerge';\n/** @hidden */\nexport var pasteMerge = 'pasteMerge';\n/** @hidden */\nexport var setCFRule = 'setCFRule';\n/** @hidden */\nexport var cFInitialCheck = 'cFInitialCheck';\n/** @hidden */\nexport var clearCFRule = 'clearCFRule';\n/** @hidden */\nexport var initiateClearCFRule = 'initiateClearCFRule';\n/** @hidden */\nexport var cFRender = 'cFRender';\n/** @hidden */\nexport var cFDelete = 'cFDelete';\n/** @hidden */\nexport var clear = 'clear';\n/** @hidden */\nexport var clearCF = 'clearCF';\n/** @hidden */\nexport var clearCells = 'clearCells';\n/** @hidden */\nexport var setImage = 'setImage';\n/** @hidden */\nexport var setChart = 'setChart';\n/** @hidden */\nexport var initiateChart = 'initiateChart';\n/** @hidden */\nexport var refreshRibbonIcons = 'refreshRibbonIcons';\n/** @hidden */\nexport var refreshChart = 'refreshChart';\n/** @hidden */\nexport var refreshChartSize = 'refreshChartSize';\n/** @hidden */\nexport var updateChart = 'updateChart';\n/** @hidden */\nexport var deleteChartColl = 'deleteChartColl';\n/** @hidden */\nexport var initiateChartModel = 'initiateChartModel';\n/** @hidden */\nexport var focusChartBorder = 'focusChartBorder';\n","import { DataManager, Query, Deferred } from '@syncfusion/ej2-data';\nimport { getCell, setCell } from '../base/index';\nimport { getRangeIndexes, checkIsFormula, updateSheetFromDataSource, checkDateFormat, dataSourceChanged } from '../common/index';\nimport { getCellIndexes, dataChanged, getCellAddress } from '../common/index';\nimport { getFormatFromType } from './number-format';\n/**\n * Data binding module\n */\nvar DataBind = /** @class */ (function () {\n    function DataBind(parent) {\n        this.parent = parent;\n        this.requestedInfo = [];\n        this.addEventListener();\n    }\n    DataBind.prototype.addEventListener = function () {\n        this.parent.on(updateSheetFromDataSource, this.updateSheetFromDataSourceHandler, this);\n        this.parent.on(dataSourceChanged, this.dataSourceChangedHandler, this);\n        this.parent.on(dataChanged, this.dataChangedHandler, this);\n    };\n    DataBind.prototype.removeEventListener = function () {\n        if (!this.parent.isDestroyed) {\n            this.parent.off(updateSheetFromDataSource, this.updateSheetFromDataSourceHandler);\n            this.parent.off(dataSourceChanged, this.dataSourceChangedHandler);\n            this.parent.off(dataChanged, this.dataChangedHandler);\n        }\n    };\n    /**\n     * Update given data source to sheet.\n     */\n    // tslint:disable-next-line\n    DataBind.prototype.updateSheetFromDataSourceHandler = function (args) {\n        var _this = this;\n        var cell;\n        var flds;\n        var sCellIdx;\n        var result;\n        var remoteUrl;\n        var isLocal;\n        var dataManager;\n        var requestedRange = [];\n        var sRanges = [];\n        var rowIdx;\n        var deferred = new Deferred();\n        var sRowIdx;\n        var sColIdx;\n        var loadedInfo;\n        args.promise = deferred.promise;\n        if (args.sheet && args.sheet.ranges.length) {\n            var _loop_1 = function (k) {\n                var sRange = args.indexes[0];\n                var eRange = args.indexes[2];\n                var range = args.sheet.ranges[k];\n                sRowIdx = getRangeIndexes(range.startCell)[0];\n                dataManager = range.dataSource instanceof DataManager ? range.dataSource\n                    : range.dataSource ? new DataManager(range.dataSource) : new DataManager();\n                remoteUrl = remoteUrl || dataManager.dataSource.url;\n                args.sheet.isLocalData = isLocal || !dataManager.dataSource.url;\n                if (sRowIdx <= sRange) {\n                    sRange = sRange - sRowIdx;\n                }\n                else {\n                    if (sRowIdx <= eRange) {\n                        eRange = eRange - sRowIdx;\n                        sRange = 0;\n                    }\n                    else {\n                        sRange = -1;\n                    }\n                }\n                if (range.showFieldAsHeader && sRange !== 0) {\n                    sRange -= 1;\n                }\n                var isEndReached = false;\n                var insertRowCount = 0;\n                this_1.initRangeInfo(range);\n                var count = this_1.getMaxCount(range);\n                loadedInfo = this_1.getLoadedInfo(sRange, eRange, range);\n                sRange = loadedInfo.unloadedRange[0];\n                eRange = loadedInfo.unloadedRange[1];\n                if (range.info.insertRowRange) {\n                    range.info.insertRowRange.forEach(function (range) {\n                        insertRowCount += ((range[1] - range[0]) + 1);\n                    });\n                    sRange -= insertRowCount;\n                    eRange -= insertRowCount;\n                }\n                if (sRange > count) {\n                    isEndReached = true;\n                }\n                else if (eRange > count) {\n                    eRange = count;\n                }\n                this_1.requestedInfo.push({ deferred: deferred, indexes: args.indexes, isNotLoaded: loadedInfo.isNotLoaded });\n                if (sRange >= 0 && loadedInfo.isNotLoaded && !isEndReached) {\n                    sRanges[k] = sRange;\n                    requestedRange[k] = false;\n                    var query = (range.query ? range.query : new Query()).clone();\n                    dataManager.executeQuery(query.range(sRange, eRange >= count ? eRange : eRange + 1)\n                        .requiresCount()).then(function (e) {\n                        if (!_this.parent || _this.parent.isDestroyed) {\n                            return;\n                        }\n                        result = (e.result && e.result.result ? e.result.result : e.result);\n                        sCellIdx = getRangeIndexes(range.startCell);\n                        sRowIdx = sCellIdx[0];\n                        sColIdx = sCellIdx[1];\n                        if (result.length) {\n                            if (!range.info.count) {\n                                count = e.count;\n                                range.info.count = e.count;\n                            }\n                            flds = Object.keys(result[0]);\n                            if (!range.info.fldLen) {\n                                range.info.fldLen = flds.length;\n                                range.info.flds = flds;\n                            }\n                            if (range.info.insertColumnRange) {\n                                var insertCount_1 = 0;\n                                range.info.insertColumnRange.forEach(function (insertRange) {\n                                    for (var i = insertRange[0]; i <= insertRange[1]; i++) {\n                                        i <= sColIdx ? flds.splice(0, 0, \"emptyCell\" + insertCount_1) : flds.splice(i - sColIdx, 0, \"emptyCell\" + insertCount_1);\n                                        insertCount_1++;\n                                    }\n                                });\n                            }\n                            if (sRanges[k] === 0 && range.showFieldAsHeader) {\n                                rowIdx = sRowIdx + sRanges[k] + insertRowCount;\n                                flds.forEach(function (field, i) {\n                                    cell = getCell(rowIdx, sColIdx + i, args.sheet, true);\n                                    if (!cell) {\n                                        args.sheet.rows[sRowIdx + sRanges[k]].cells[sColIdx + i] = field.includes('emptyCell') ? {}\n                                            : { value: field };\n                                    }\n                                    else if (!cell.value && !field.includes('emptyCell')) {\n                                        cell.value = field;\n                                    }\n                                });\n                            }\n                            result.forEach(function (item, i) {\n                                rowIdx = sRowIdx + sRanges[k] + i + (range.showFieldAsHeader ? 1 : 0) + insertRowCount;\n                                for (var j = 0; j < flds.length; j++) {\n                                    cell = getCell(rowIdx, sColIdx + j, args.sheet, true);\n                                    if (cell) {\n                                        if (!cell.value && !flds[j].includes('emptyCell')) {\n                                            setCell(rowIdx, sColIdx + j, args.sheet, _this.getCellDataFromProp(item[flds[j]]), true);\n                                        }\n                                    }\n                                    else {\n                                        args.sheet.rows[rowIdx].cells[sColIdx + j] =\n                                            flds[j].includes('emptyCell') ? {} : _this.getCellDataFromProp(item[flds[j]]);\n                                    }\n                                    _this.checkDataForFormat({\n                                        args: args, cell: cell, colIndex: sColIdx + j, rowIndex: rowIdx, i: i, j: j, k: k,\n                                        range: range, sRanges: sRanges, value: item[flds[j]]\n                                    });\n                                }\n                            });\n                        }\n                        else {\n                            flds = [];\n                        }\n                        args.sheet.usedRange.rowIndex = Math.max((sRowIdx + (count || e.count) + (range.showFieldAsHeader ? 1 : 0) + insertRowCount) - 1, args.sheet.usedRange.rowIndex);\n                        args.sheet.usedRange.colIndex = Math.max(sColIdx + flds.length - 1, args.sheet.usedRange.colIndex);\n                        if (insertRowCount) {\n                            loadedInfo = _this.getLoadedInfo(sRange, eRange, range);\n                            sRange = loadedInfo.unloadedRange[0];\n                            eRange = loadedInfo.unloadedRange[1];\n                            if (sRange > count) {\n                                loadedInfo.isNotLoaded = false;\n                            }\n                            if (loadedInfo.isNotLoaded) {\n                                if (eRange > count) {\n                                    eRange = count;\n                                }\n                                range.info.loadedRange.push([sRange, eRange]);\n                            }\n                        }\n                        else {\n                            range.info.loadedRange.push([sRange, eRange]);\n                        }\n                        requestedRange[k] = true;\n                        if (requestedRange.indexOf(false) === -1) {\n                            if (eRange + sRowIdx < sRowIdx + range.info.count) {\n                                if (!args.rangeSettingCount) {\n                                    args.rangeSettingCount = [];\n                                }\n                                args.rangeSettingCount.push(k);\n                                //if (remoteUrl) {\n                                var unloadedArgs = {\n                                    sheet: args.sheet, indexes: [0, 0, args.sheet.usedRange.rowIndex, args.sheet.usedRange.colIndex],\n                                    promise: new Promise(function (resolve, reject) { resolve((function () { })()); }),\n                                    rangeSettingCount: args.rangeSettingCount\n                                };\n                                _this.updateSheetFromDataSourceHandler(unloadedArgs);\n                                unloadedArgs.promise.then(function () {\n                                    if (_this.parent.getModuleName() === 'workbook') {\n                                        return;\n                                    }\n                                    args.rangeSettingCount.pop();\n                                    if (!args.rangeSettingCount.length) {\n                                        _this.parent.notify('created', null);\n                                    }\n                                });\n                                //}\n                            }\n                            _this.checkResolve(args.indexes);\n                        }\n                    });\n                }\n                else if (k === 0 && requestedRange.indexOf(false) === -1) {\n                    this_1.checkResolve(args.indexes);\n                }\n            };\n            var this_1 = this;\n            for (var k = args.sheet.ranges.length - 1; k >= 0; k--) {\n                _loop_1(k);\n            }\n        }\n        else {\n            deferred.resolve();\n        }\n    };\n    DataBind.prototype.checkResolve = function (indexes) {\n        var resolved;\n        var isSameRng;\n        var cnt = 0;\n        this.requestedInfo.forEach(function (info, idx) {\n            isSameRng = JSON.stringify(info.indexes) === JSON.stringify(indexes);\n            if (isSameRng || resolved) {\n                if (idx === 0) {\n                    info.deferred.resolve();\n                    cnt++;\n                    resolved = true;\n                }\n                else {\n                    if (resolved && (info.isLoaded || !info.isNotLoaded)) {\n                        info.deferred.resolve();\n                        cnt++;\n                    }\n                    else if (isSameRng && resolved) {\n                        info.deferred.resolve();\n                        cnt++;\n                    }\n                    else if (isSameRng) {\n                        info.isLoaded = true;\n                    }\n                    else {\n                        resolved = false;\n                    }\n                }\n            }\n        });\n        this.requestedInfo.splice(0, cnt);\n    };\n    DataBind.prototype.getCellDataFromProp = function (prop) {\n        var data = {};\n        if (Object.prototype.toString.call(prop) === '[object Object]') {\n            if (prop.formula) {\n                data.formula = prop.formula;\n            }\n            else if (prop.value) {\n                if (typeof (prop.value) === 'string') {\n                    if (prop.value.indexOf('http://') === 0 || prop.value.indexOf('https://') === 0 ||\n                        prop.value.indexOf('ftp://') === 0 || prop.value.indexOf('www.') === 0) {\n                        data.hyperlink = prop.value;\n                    }\n                    else {\n                        data.value = prop.value;\n                    }\n                }\n                else {\n                    data.value = prop.value;\n                }\n            }\n        }\n        else {\n            if (checkIsFormula(prop)) {\n                data.formula = prop;\n            }\n            else {\n                if (typeof (prop) === 'string') {\n                    if (prop.indexOf('http://') === 0 || prop.indexOf('https://') === 0 ||\n                        prop.indexOf('ftp://') === 0 || prop.indexOf('www.') === 0) {\n                        data.hyperlink = prop;\n                    }\n                    else {\n                        data.value = prop;\n                    }\n                }\n                else {\n                    data.value = prop;\n                }\n            }\n        }\n        return data;\n    };\n    DataBind.prototype.checkDataForFormat = function (args) {\n        if (args.value !== '') {\n            var dateEventArgs = {\n                value: args.value,\n                rowIndex: args.rowIndex,\n                colIndex: args.colIndex,\n                isDate: false,\n                updatedVal: args.value,\n                isTime: false\n            };\n            this.parent.notify(checkDateFormat, dateEventArgs);\n            if (dateEventArgs.isDate) {\n                if (args.cell) {\n                    args.cell.format = getFormatFromType('ShortDate');\n                    args.cell.value = dateEventArgs.updatedVal;\n                }\n                else {\n                    args.args.sheet.rows[args.rowIndex]\n                        .cells[args.colIndex].format = getFormatFromType('ShortDate');\n                    args.args.sheet.rows[args.rowIndex]\n                        .cells[args.colIndex].value = dateEventArgs.updatedVal;\n                }\n            }\n            else if (dateEventArgs.isTime) {\n                if (args.cell) {\n                    args.cell.format = getFormatFromType('Time');\n                    args.cell.value = dateEventArgs.updatedVal;\n                }\n                else {\n                    args.args.sheet.rows[args.rowIndex]\n                        .cells[args.colIndex].format = getFormatFromType('Time');\n                    args.args.sheet.rows[args.rowIndex]\n                        .cells[args.colIndex].value = dateEventArgs.updatedVal;\n                }\n            }\n        }\n    };\n    DataBind.prototype.getLoadedInfo = function (sRange, eRange, range) {\n        var isNotLoaded = true;\n        range.info.loadedRange.forEach(function (range) {\n            if (range[0] <= sRange && sRange <= range[1]) {\n                if (range[0] <= eRange && eRange <= range[1]) {\n                    isNotLoaded = false;\n                }\n                else {\n                    sRange = range[1] + 1;\n                }\n            }\n            else if (range[0] <= eRange && eRange <= range[1]) {\n                eRange = range[0] - 1;\n            }\n        });\n        return { isNotLoaded: isNotLoaded, unloadedRange: [sRange, eRange] };\n    };\n    DataBind.prototype.getMaxCount = function (range) {\n        if (range.query) {\n            var query = range.query.queries;\n            for (var i = 0; i < query.length; i++) {\n                if (query[i].fn === 'onTake') {\n                    return Math.min(query[i].e.nos, range.info.count || query[i].e.nos);\n                }\n            }\n        }\n        return range.info.count;\n    };\n    DataBind.prototype.initRangeInfo = function (range) {\n        if (!range.info) {\n            range.info = { loadedRange: [] };\n        }\n    };\n    /**\n     * Remove old data from sheet.\n     */\n    DataBind.prototype.dataSourceChangedHandler = function (args) {\n        var _this = this;\n        var row;\n        var sheet = this.parent.sheets[args.sheetIdx];\n        var range = sheet.ranges[args.rangeIdx];\n        if (range && (this.checkRangeHasChanges(sheet, args.rangeIdx) || !range.info)) {\n            var showFieldAsHeader_1 = range.showFieldAsHeader;\n            var indexes_1 = getCellIndexes(range.startCell);\n            if (range.info) {\n                range.info.loadedRange.forEach(function (loadedRange) {\n                    for (var i = loadedRange[0]; i <= loadedRange[1] && (i < range.info.count + (showFieldAsHeader_1 ? 1 : 0)); i++) {\n                        row = sheet.rows[i + indexes_1[0]];\n                        if (row) {\n                            for (var j = indexes_1[1]; j < indexes_1[1] + range.info.fldLen; j++) {\n                                if (row.cells && row.cells[j]) {\n                                    delete row.cells[j];\n                                }\n                            }\n                        }\n                    }\n                });\n                range.info = null;\n            }\n            var viewport = this.parent.viewport;\n            var refreshRange_1 = [viewport.topIndex, viewport.leftIndex, viewport.bottomIndex, viewport.rightIndex];\n            var args_1 = {\n                sheet: sheet, indexes: refreshRange_1, promise: new Promise(function (resolve, reject) { resolve((function () { })()); })\n            };\n            this.updateSheetFromDataSourceHandler(args_1);\n            args_1.promise.then(function () {\n                _this.parent.notify('updateView', { indexes: refreshRange_1 });\n            });\n        }\n    };\n    DataBind.prototype.checkRangeHasChanges = function (sheet, rangeIdx) {\n        if (this.parent.isAngular) {\n            var changedRangeIdx = 'changedRangeIdx';\n            if (sheet[changedRangeIdx] === parseInt(rangeIdx, 10)) {\n                delete sheet[changedRangeIdx];\n                return true;\n            }\n            return false;\n        }\n        else {\n            return true;\n        }\n    };\n    /**\n     * Triggers dataSourceChange event when cell data changes\n     */\n    DataBind.prototype.dataChangedHandler = function (args) {\n        var _this = this;\n        var changedData = [{}];\n        var action;\n        var cell;\n        var dataRange;\n        var startCell;\n        var inRange;\n        var deleteRowDetails;\n        var sheetIdx = this.parent.activeSheetIndex;\n        var sheet = this.parent.sheets[sheetIdx];\n        var cellIndices;\n        sheet.ranges.forEach(function (range, idx) {\n            if (range.dataSource) {\n                var isNewRow = void 0;\n                startCell = getCellIndexes(range.startCell);\n                dataRange = startCell.concat([startCell[0] + range.info.count + (range.showFieldAsHeader ? 0 : -1),\n                    startCell[1] + range.info.fldLen - 1]);\n                if (args.modelType === 'Row') {\n                    if (args.insertType) {\n                        inRange = ((!range.showFieldAsHeader && args.insertType === 'above') ? dataRange[0] <= args.index\n                            : dataRange[0] < args.index) && dataRange[2] >= args.index;\n                        cellIndices = [args.index];\n                        if (!inRange) {\n                            if ((dataRange[2] + 1 === args.index && args.insertType === 'below')) {\n                                isNewRow = true;\n                                range.info.count += args.model.length;\n                            }\n                            else if (dataRange[0] >= args.index) {\n                                range.startCell = getCellAddress(startCell[0] + args.model.length, startCell[1]);\n                            }\n                        }\n                        else {\n                            isNewRow = true;\n                            range.info.count += args.model.length;\n                        }\n                    }\n                    else {\n                        inRange = dataRange[0] <= args.startIndex && dataRange[2] >= args.startIndex;\n                        action = 'delete';\n                    }\n                }\n                else {\n                    cellIndices = getCellIndexes(args.sheetIdx > -1 ? args.address : args.address.split('!')[1]);\n                    inRange = ((range.showFieldAsHeader ? dataRange[0] + 1 : dataRange[0]) <= cellIndices[0])\n                        && dataRange[2] >= cellIndices[0] && dataRange[1] <= cellIndices[1] && dataRange[3] >= cellIndices[1];\n                }\n                if (inRange || isNewRow) {\n                    if (args.modelType === 'Row' && !args.insertType) {\n                        args.deletedModel.forEach(function (row, rowIdx) {\n                            changedData[rowIdx] = {};\n                            range.info.flds.forEach(function (fld, idx) {\n                                if (row.cells) {\n                                    cell = row.cells[startCell[1] + idx];\n                                    changedData[rowIdx][fld] = (cell && cell.value) || null;\n                                }\n                                else {\n                                    changedData[rowIdx][fld] = null;\n                                }\n                            });\n                            range.info.count -= 1;\n                        });\n                        deleteRowDetails = { count: args.deletedModel.length, index: args.endIndex };\n                    }\n                    else {\n                        action = isNewRow ? 'add' : 'edit';\n                        var _loop_2 = function (i) {\n                            changedData[i] = {};\n                            range.info.flds.forEach(function (fld, idx) {\n                                cell = getCell(cellIndices[0], startCell[1] + idx, sheet);\n                                changedData[i][fld] = (cell && cell.value) || null;\n                            });\n                        };\n                        for (var i = 0; i < (isNewRow ? args.model.length : 1); i++) {\n                            _loop_2(i);\n                        }\n                    }\n                    _this.parent.trigger('dataSourceChanged', { data: changedData, action: action, rangeIndex: idx, sheetIndex: sheetIdx });\n                }\n                else if (deleteRowDetails && deleteRowDetails.count && dataRange[0] > deleteRowDetails.index) {\n                    range.startCell = getCellAddress(startCell[0] - deleteRowDetails.count, startCell[1]);\n                }\n            }\n        });\n    };\n    /**\n     * For internal use only - Get the module name.\n     * @private\n     */\n    DataBind.prototype.getModuleName = function () {\n        return 'dataBind';\n    };\n    /**\n     * Destroys the Data binding module.\n     * @return {void}\n     */\n    DataBind.prototype.destroy = function () {\n        this.removeEventListener();\n        this.parent = null;\n        this.requestedInfo = [];\n    };\n    return DataBind;\n}());\nexport { DataBind };\n","/**\n * Specifies spreadsheet internal events\n */\n/** @hidden */\nexport var ribbon = 'ribbon';\n/** @hidden */\nexport var formulaBar = 'formulaBar';\n/** @hidden */\nexport var sheetTabs = 'sheetTabs';\n/** @hidden */\nexport var refreshSheetTabs = 'refreshSheetTabs';\n/** @hidden */\nexport var isFormulaBarEdit = 'isFormulaBarEdit';\n/** @hidden */\nexport var dataRefresh = 'dataRefresh';\n/** @hidden */\nexport var initialLoad = 'initialLoad';\n/** @hidden */\nexport var contentLoaded = 'contentLoaded';\n/** @hidden */\nexport var mouseDown = 'mouseDown';\n/** @hidden */\nexport var spreadsheetDestroyed = 'spreadsheetDestroyed';\n/** @hidden */\nexport var editOperation = 'editOperation';\n/** @hidden */\nexport var formulaOperation = 'formulaOperation';\n/** @hidden */\nexport var formulaBarOperation = 'formulaBarOperation';\n/** @hidden */\nexport var click = 'click';\n/** @hidden */\nexport var keyUp = 'keyUp';\n/** @hidden */\nexport var keyDown = 'keyDown';\n/** @hidden */\nexport var formulaKeyUp = 'formulaKeyUp';\n/** @hidden */\nexport var formulaBarUpdate = 'formulaBarUpdate';\n/** @hidden */\nexport var onVerticalScroll = 'verticalScroll';\n/** @hidden */\nexport var onHorizontalScroll = 'horizontalScroll';\n/** @hidden */\nexport var beforeContentLoaded = 'beforeContentLoaded';\n/** @hidden */\nexport var beforeVirtualContentLoaded = 'beforeVirtualContentLoaded';\n/** @hidden */\nexport var virtualContentLoaded = 'virtualContentLoaded';\n/** @hidden */\nexport var contextMenuOpen = 'contextMenuOpen';\n/** @hidden */\nexport var cellNavigate = 'cellNavigate';\n/** @hidden */\nexport var mouseUpAfterSelection = 'mouseUpAfterSelection';\n/** @hidden */\nexport var selectionComplete = 'selectionComplete';\n/** @hidden */\nexport var cMenuBeforeOpen = 'contextmenuBeforeOpen';\n/** @hidden */\nexport var insertSheetTab = 'insertSheetTab';\n/** @hidden */\nexport var removeSheetTab = 'removeSheetTab';\n/** @hidden */\nexport var renameSheetTab = 'renameSheetTab';\n/** @hidden */\nexport var ribbonClick = 'ribboClick';\n/** @hidden */\nexport var refreshRibbon = 'ribbonRefresh';\n/** @hidden */\nexport var enableToolbarItems = 'enableToolbarItems';\n/** @hidden */\nexport var tabSwitch = 'tabSwitch';\n/** @hidden */\nexport var selectRange = 'selectRange';\n/** @hidden */\nexport var cut = 'cut';\n/** @hidden */\nexport var copy = 'copy';\n/** @hidden */\nexport var paste = 'paste';\n/** @hidden */\nexport var clearCopy = 'clearCopy';\n/** @hidden */\nexport var dataBound = 'dataBound';\n/** @hidden */\nexport var beforeDataBound = 'beforeDataBound';\n/** @hidden */\nexport var addContextMenuItems = 'addContextMenuItems';\n/** @hidden */\nexport var removeContextMenuItems = 'removeContextMenuItems';\n/** @hidden */\nexport var enableContextMenuItems = 'enableContextMenuItems';\n/** @hidden */\nexport var enableFileMenuItems = 'enableFileMenuItems';\n/** @hidden */\nexport var hideFileMenuItems = 'hideFileMenuItems';\n/** @hidden */\nexport var addFileMenuItems = 'addFileMenuItems';\n/** @hidden */\nexport var hideRibbonTabs = 'hideRibbonTabs';\n/** @hidden */\nexport var enableRibbonTabs = 'enableRibbonTabs';\n/** @hidden */\nexport var addRibbonTabs = 'addRibbonTabs';\n/** @hidden */\nexport var addToolbarItems = 'addToolbarItems';\n/** @hidden */\nexport var hideToolbarItems = 'hideToolbarItems';\n/** @hidden */\nexport var beforeRibbonCreate = 'beforeRibbonCreate';\n/** @hidden */\nexport var rowHeightChanged = 'rowHeightChanged';\n/** @hidden */\nexport var colWidthChanged = 'colWidthChanged';\n/** @hidden */\nexport var beforeHeaderLoaded = 'beforeHeaderLoaded';\n/** @hidden */\nexport var onContentScroll = 'onContentScroll';\n/** @hidden */\nexport var deInitProperties = 'deInitProperties';\n/** @hidden */\nexport var activeSheetChanged = 'activeSheetChanged';\n/** @hidden */\nexport var renameSheet = 'renameSheet';\n/** @hidden */\nexport var initiateCustomSort = 'initiateCustomSort';\n/** @hidden */\nexport var applySort = 'applySort';\n/** @hidden */\nexport var collaborativeUpdate = 'collaborativeUpdate';\n/** @hidden */\nexport var hideShow = 'hideShow';\n/** @hidden */\nexport var autoFit = 'autoFitRowsColumns';\n/** @hidden */\nexport var updateToggleItem = 'updateToggleItem';\n/** @hidden */\nexport var initiateHyperlink = 'initiateHyperlink';\n/** @hidden */\nexport var editHyperlink = 'editHyperlink';\n/** @hidden */\nexport var openHyperlink = 'openHyperlink';\n/** @hidden */\nexport var removeHyperlink = 'removeHyperlink';\n/** @hidden */\nexport var createHyperlinkElement = 'createHyperlinkElement';\n/** @hidden */\nexport var sheetNameUpdate = 'sheetNameUpdate';\n/** @hidden */\nexport var hideSheet = 'hideSheet';\n/** @hidden */\nexport var performUndoRedo = 'performUndoRedo';\n/** @hidden */\nexport var updateUndoRedoCollection = 'updateUndoRedoCollection';\n/** @hidden */\nexport var setActionData = 'setActionData';\n/** @hidden */\nexport var getBeforeActionData = 'getBeforeActionData';\n/** @hidden */\nexport var clearUndoRedoCollection = 'clearUndoRedoCollection';\n/** @hidden */\nexport var initiateFilterUI = 'initiateFilterUI';\n/** @hidden */\nexport var renderFilterCell = 'renderFilterCell';\n/** @hidden */\nexport var reapplyFilter = 'reapplyFilter';\n/** @hidden */\nexport var filterByCellValue = 'filterByCellValue';\n/** @hidden */\nexport var clearFilter = 'clearFilter';\n/** @hidden */\nexport var getFilteredColumn = 'getFilteredColumn';\n/** @hidden */\nexport var completeAction = 'actionComplete';\n/** @hidden */\nexport var beginAction = 'actionBegin';\n/** @hidden */\nexport var filterCellKeyDown = 'filterCellKeyDown';\n/** @hidden */\nexport var getFilterRange = 'getFilterRange';\n/** @hidden */\nexport var setAutoFit = 'setAutoFit';\n/** @hidden */\nexport var refreshFormulaDatasource = 'refreshFormulaDatasource';\n/** @hidden */\nexport var setScrollEvent = 'setScrollEvent';\n/** @hidden */\nexport var initiateDataValidation = 'initiatedatavalidation';\n/** @hidden */\nexport var validationError = 'validationError';\n/** @hidden */\nexport var startEdit = 'startEdit';\n/** @hidden */\nexport var invalidData = 'invalidData';\n/** @hidden */\nexport var clearInvalid = 'clearInvalid';\n/** @hidden */\nexport var protectSheet = 'protectSheet';\n/** @hidden */\nexport var applyProtect = 'applyProtect';\n/** @hidden */\nexport var unprotectSheet = 'unprotectSheet';\n/** @hidden */\nexport var protectCellFormat = 'protectCellFormat';\n/** @hidden */\nexport var gotoDlg = 'renderGotoDlgt';\n/** @hidden */\nexport var findDlg = 'renderFindDlg';\n/** @hidden */\nexport var findHandler = 'findHandler';\n/** @hidden */\nexport var replace = 'replaceHandler';\n/** @hidden */\nexport var created = 'created';\n/** @hidden */\nexport var editAlert = 'editAlert';\n/** @hidden */\nexport var setUndoRedo = 'setUndoRedo';\n/** @hidden */\nexport var enableFormulaInput = 'enableFormulaInput';\n/** @hidden */\nexport var protectSelection = 'protectSelection';\n/** @hidden */\nexport var hiddenMerge = 'hiddenMerge';\n/** @hidden */\nexport var checkPrevMerge = 'checkPrevMerge';\n/** @hidden */\nexport var checkMerge = 'checkMerge';\n/** @hidden */\nexport var removeDataValidation = 'removeDataValidation';\n/** @hidden */\nexport var showAggregate = 'showAggregate';\n/** @hidden */\nexport var initiateConditionalFormat = 'initiateConditionalFormat';\n/** @hidden */\nexport var checkConditionalFormat = 'checkConditionalFormat';\n/** @hidden */\nexport var setCF = 'setCF';\n/** @hidden */\nexport var clearViewer = 'clearViewer';\n/** @hidden */\nexport var initiateFormulaReference = 'initiateFormulaReference';\n/** @hidden */\nexport var initiateCur = 'initiateCur';\n/** @hidden */\nexport var clearCellRef = 'clearCellRef';\n/** @hidden */\nexport var editValue = 'editValue';\n/** @hidden */\nexport var addressHandle = 'addressHandle';\n/** @hidden */\nexport var initiateEdit = 'initiateEdit';\n/** @hidden */\nexport var forRefSelRender = 'forRefSelRender';\nexport var blankWorkbook = 'blankWorkbook';\n/** @hidden */\nexport var insertImage = 'insertImage';\n/** @hidden */\nexport var refreshImgElem = 'refreshImgElem';\n/** @hidden */\nexport var refreshImgCellObj = 'refreshImgCellObj';\n/** @hidden */\nexport var getRowIdxFromClientY = 'getRowIdxFromClientY';\n/** @hidden */\nexport var getColIdxFromClientX = 'getColIdxFromClientX';\n/** @hidden */\nexport var createImageElement = 'createImageElement';\n/** @hidden */\nexport var deleteImage = 'deleteImage';\n/** @hidden */\nexport var deleteChart = 'deleteChart';\n/** @hidden */\nexport var refreshChartCellObj = 'refreshChartCellObj';\n/** @hidden */\nexport var refreshImagePosition = 'refreshImagePosition';\n/** @hidden */\nexport var updateTableWidth = 'updateTableWidth';\n/** @hidden */\nexport var focusBorder = 'focusBorder';\n/** @hidden */\nexport var clearChartBorder = 'clearChartBorder';\n/** @hidden */\nexport var insertChart = 'insertChart';\n/** @hidden */\nexport var chartRangeSelection = 'chartRangeSelection';\n/** @hidden */\nexport var isReact = 'isReact';\n/** @hidden */\nexport var renderReactTemplates = 'renderReactTemplates';\n/** @hidden */\nexport var clearTemplate = 'clearTemplate';\n","/**\n * Open properties.\n */\nimport { isUndefined } from '@syncfusion/ej2-base';\nimport { workbookOpen, openSuccess, openFailure, sheetsDestroyed, workbookFormulaOperation } from '../common/index';\nimport { sheetCreated, protectSheetWorkBook } from '../common/index';\nimport { initSheet } from '../base/index';\nimport { beginAction } from '../../spreadsheet/common/event';\nvar WorkbookOpen = /** @class */ (function () {\n    function WorkbookOpen(parent) {\n        this.parent = parent;\n        this.addEventListener();\n    }\n    /**\n     * To open the excel file stream or excel url into the spreadsheet.\n     * @param {OpenOptions} options - Options to open a excel file.\n     */\n    WorkbookOpen.prototype.open = function (options) {\n        var _this = this;\n        if (!this.parent.allowOpen) {\n            return;\n        }\n        /* tslint:disable-next-line:no-any */\n        if (options.jsonObject) {\n            /* tslint:disable-next-line:no-any */\n            this.fetchSuccess(options.jsonObject);\n            return;\n        }\n        var formData = new FormData();\n        if (options.file) {\n            formData.append('file', options.file);\n        }\n        else {\n            this.parent.isOpen = false;\n            return;\n        }\n        var eventArgs = {\n            file: options.file || null,\n            cancel: false,\n            requestData: {\n                method: 'POST',\n                body: formData\n            }\n        };\n        this.parent.trigger('beforeOpen', eventArgs);\n        this.parent.notify(beginAction, { eventArgs: eventArgs, action: 'beforeOpen' });\n        if (eventArgs.cancel) {\n            return;\n        }\n        fetch(this.parent.openUrl, eventArgs.requestData)\n            .then(function (response) {\n            if (response.ok) {\n                return response.json();\n            }\n            else {\n                return Promise.reject({\n                    status: response.status,\n                    statusText: response.statusText,\n                    url: response.url\n                });\n            }\n        })\n            .then(function (data) { return _this.fetchSuccess(data); })\n            .catch(function (error) { return _this.fetchFailure(error); });\n    };\n    WorkbookOpen.prototype.fetchFailure = function (error) {\n        if (isUndefined(error.status) && isUndefined(error.statusText)) {\n            error.statusText = 'Improper response';\n        }\n        this.parent.notify(openFailure, error);\n        this.parent.isOpen = false;\n    };\n    WorkbookOpen.prototype.fetchSuccess = function (data) {\n        var openError = ['UnsupportedFile', 'InvalidUrl'];\n        var workbookData = data;\n        workbookData = (typeof data === 'string') ? JSON.parse(data) : data;\n        /* tslint:disable-next-line:no-any */\n        var impData = workbookData.Workbook;\n        if (openError.indexOf(impData) > -1) {\n            this.parent.notify(openSuccess, {\n                context: this, data: impData\n            });\n            return;\n        }\n        this.updateModel(impData);\n        this.parent.notify(openSuccess, {\n            context: this, data: impData\n        });\n        this.parent.isOpen = false;\n    };\n    WorkbookOpen.prototype.updateModel = function (workbookModel) {\n        this.parent.notify(workbookFormulaOperation, { action: 'unRegisterSheet' });\n        this.parent.sheetNameCount = 1;\n        this.parent.sheets = [];\n        this.parent.notify(sheetsDestroyed, {});\n        workbookModel.activeSheetIndex = workbookModel.activeSheetIndex || 0;\n        this.parent.setProperties({\n            'sheets': workbookModel.sheets,\n            'activeSheetIndex': workbookModel.activeSheetIndex,\n            'definedNames': workbookModel.definedNames || []\n        }, true);\n        initSheet(this.parent);\n        this.parent.notify(sheetCreated, null);\n        this.parent.notify(workbookFormulaOperation, { action: 'registerSheet', isImport: true });\n        this.parent.notify(workbookFormulaOperation, { action: 'initiateDefinedNames' });\n        this.parent.notify(protectSheetWorkBook, null);\n    };\n    /**\n     * Adding event listener for workbook open.\n     */\n    WorkbookOpen.prototype.addEventListener = function () {\n        this.parent.on(workbookOpen, this.open.bind(this));\n    };\n    /**\n     * Removing event listener workbook open.\n     */\n    WorkbookOpen.prototype.removeEventListener = function () {\n        if (!this.parent.isDestroyed) {\n            this.parent.off(workbookOpen, this.open.bind(this));\n        }\n    };\n    /**\n     * To Remove the event listeners\n     */\n    WorkbookOpen.prototype.destroy = function () {\n        this.removeEventListener();\n        this.parent = null;\n    };\n    /**\n     * Get the workbook open module name.\n     */\n    WorkbookOpen.prototype.getModuleName = function () {\n        return 'workbookOpen';\n    };\n    return WorkbookOpen;\n}());\nexport { WorkbookOpen };\n","/**\n * @hidden\n * The `SaveWorker` module is used to perform save functionality with Web Worker.\n */\nvar SaveWorker = /** @class */ (function () {\n    /**\n     * Constructor for SaveWorker module in Workbook library.\n     * @private\n     */\n    function SaveWorker(parent) {\n        this.parent = parent;\n    }\n    /**\n     * Process sheet.\n     * @hidden\n     */\n    SaveWorker.prototype.processSheet = function (sheet, sheetIndex) {\n        var parsedSheet = JSON.parse(sheet, function (key, value) {\n            //Remove empty properties\n            if ((Array.isArray(value) || typeof value === 'string') && !value.length) {\n                return undefined;\n            }\n            return value;\n        });\n        return [sheetIndex, parsedSheet];\n    };\n    /**\n     * Process save action.\n     * @hidden\n     */\n    SaveWorker.prototype.processSave = function (saveJSON, saveSettings, customParams) {\n        var formData = new FormData();\n        var i;\n        var keys = Object.keys(saveSettings);\n        formData.append('JSONData', JSON.stringify(saveJSON));\n        for (i = 0; i < keys.length; i++) {\n            formData.append(keys[i], saveSettings[keys[i]]);\n        }\n        keys = Object.keys(customParams);\n        for (i = 0; i < keys.length; i++) {\n            formData.append(keys[i], customParams[keys[i]]);\n        }\n        fetch(saveSettings.url, { method: 'POST', body: formData })\n            .then(function (response) {\n            if (response.ok) {\n                return response.blob();\n            }\n            else {\n                return Promise.reject({\n                    message: response.statusText\n                });\n            }\n        })\n            .then(function (data) {\n            postMessage(data);\n        })\n            .catch(function (error) {\n            postMessage({ error: error.message });\n        });\n        // try {\n        //     let httpRequest: XMLHttpRequest = new XMLHttpRequest();\n        //     let formData: FormData = new FormData();\n        //     let i: number;\n        //     let keys: string[] = Object.keys(saveSettings);\n        //     httpRequest.onreadystatechange = (event: Event) => {\n        //         if (httpRequest.readyState === 4 && httpRequest.status === 200) {\n        //             (postMessage as Function)(httpRequest.response);\n        //         }\n        //     };\n        //     httpRequest.onerror = (event: Event) => {\n        //         (postMessage as Function)(event);\n        //     };\n        //     formData.append('JSONData', JSON.stringify(saveJSON));\n        //     for (i = 0; i < keys.length; i++) {\n        //         formData.append(keys[i], (<{ [key: string]: string }>saveSettings)[keys[i]]);\n        //     }\n        //     httpRequest.open('POST', saveSettings.saveUrl, false);\n        //     httpRequest.send(formData);\n        // } catch (e) {\n        //     (postMessage as Function)({ error: e.message });\n        // }\n    };\n    return SaveWorker;\n}());\nexport { SaveWorker };\n","var __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    }\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nimport { executeTaskAsync } from '../common/worker';\nimport * as events from '../common/event';\nimport { SaveWorker } from '../workers/save-worker';\nimport { detach } from '@syncfusion/ej2-base';\n/**\n * @hidden\n * The `WorkbookSave` module is used to handle the save action in Workbook library.\n */\nvar WorkbookSave = /** @class */ (function (_super) {\n    __extends(WorkbookSave, _super);\n    /**\n     * Constructor for WorkbookSave module in Workbook library.\n     * @private\n     */\n    function WorkbookSave(parent) {\n        var _this = _super.call(this, parent) || this;\n        _this.isProcessCompleted = false;\n        _this.saveJSON = {};\n        _this.isFullPost = false;\n        _this.needBlobData = false;\n        _this.customParams = null;\n        _this.addEventListener();\n        return _this;\n    }\n    /**\n     * Get the module name.\n     * @returns string\n     * @private\n     */\n    WorkbookSave.prototype.getModuleName = function () {\n        return 'workbookSave';\n    };\n    /**\n     * To destroy the WorkbookSave module.\n     * @return {void}\n     * @hidden\n     */\n    WorkbookSave.prototype.destroy = function () {\n        this.removeEventListener();\n        this.parent = null;\n    };\n    /**\n     * @hidden\n     */\n    WorkbookSave.prototype.addEventListener = function () {\n        this.parent.on(events.beginSave, this.initiateSave, this);\n    };\n    /**\n     * @hidden\n     */\n    WorkbookSave.prototype.removeEventListener = function () {\n        if (!this.parent.isDestroyed) {\n            this.parent.off(events.beginSave, this.initiateSave);\n        }\n    };\n    /**\n     * Initiate save process.\n     * @hidden\n     */\n    WorkbookSave.prototype.initiateSave = function (args) {\n        var saveSettings = args.saveSettings;\n        this.saveSettings = {\n            saveType: saveSettings.saveType,\n            url: saveSettings.url,\n            fileName: saveSettings.fileName || 'Sample'\n        };\n        this.isFullPost = args.isFullPost;\n        this.needBlobData = args.needBlobData;\n        if (this.needBlobData) {\n            this.isFullPost = false;\n        }\n        this.customParams = args.customParams;\n        this.updateBasicSettings();\n        this.processSheets();\n    };\n    /**\n     * Update save JSON with basic settings.\n     * @hidden\n     */\n    WorkbookSave.prototype.updateBasicSettings = function () {\n        var jsonStr = this.getStringifyObject(this.parent, ['sheets', '_isScalar', 'observers', 'closed', 'isStopped', 'hasError',\n            '__isAsync', 'beforeCellFormat', 'beforeCellRender', 'beforeDataBound', 'beforeOpen', 'beforeSave', 'beforeSelect',\n            'beforeSort', 'cellEdit', 'cellEditing', 'cellSave', 'beforeCellSave', 'contextMenuItemSelect', 'contextMenuBeforeClose',\n            'contextMenuBeforeOpen', 'created', 'dataBound', 'fileMenuItemSelect', 'fileMenuBeforeClose', 'fileMenuBeforeOpen',\n            'saveComplete', 'sortComplete', 'select', 'actionBegin', 'actionComplete', 'afterHyperlinkClick', 'afterHyperlinkCreate',\n            'beforeHyperlinkClick', 'beforeHyperlinkCreate', 'openComplete', 'openFailure', 'queryCellInfo', 'dialogBeforeOpen',\n            'dataSourceChanged']);\n        var basicSettings = JSON.parse(jsonStr);\n        var sheetCount = this.parent.sheets.length;\n        var i = 0;\n        if (sheetCount) {\n            basicSettings.sheets = [];\n        }\n        this.saveJSON = basicSettings;\n    };\n    /**\n     * Process sheets properties.\n     * @hidden\n     */\n    WorkbookSave.prototype.processSheets = function () {\n        var i = 0;\n        var sheetCount = this.parent.sheets.length;\n        while (i < sheetCount) {\n            executeTaskAsync(this, this.processSheet, this.updateSheet, [this.getStringifyObject(this.parent.sheets[i]), i]);\n            i++;\n        }\n    };\n    /**\n     * Update processed sheet data.\n     * @hidden\n     */\n    WorkbookSave.prototype.updateSheet = function (data) {\n        this.saveJSON.sheets[data[0]] = data[1];\n        this.isProcessCompleted = this.getSheetLength(this.saveJSON.sheets) === this.parent.sheets.length;\n        if (this.isProcessCompleted) {\n            this.save(this.saveSettings);\n        }\n    };\n    WorkbookSave.prototype.getSheetLength = function (sheets) {\n        var len = 0;\n        sheets.forEach(function (sheet) {\n            if (sheet) {\n                len++;\n            }\n        });\n        return len;\n    };\n    /**\n     * Save process.\n     * @hidden\n     */\n    WorkbookSave.prototype.save = function (saveSettings) {\n        var args = { cancel: false, jsonObject: this.saveJSON };\n        this.parent.notify(events.onSave, args);\n        if (!args.cancel) {\n            if (this.isFullPost) {\n                this.initiateFullPostSave();\n            }\n            else {\n                executeTaskAsync(this, { 'workerTask': this.processSave }, this.updateSaveResult, [this.saveJSON, saveSettings, this.customParams], true);\n            }\n        }\n        this.saveJSON = {};\n    };\n    /**\n     * Update final save data.\n     * @hidden\n     */\n    WorkbookSave.prototype.updateSaveResult = function (result) {\n        var args = {\n            status: 'Success',\n            message: '',\n            url: this.saveSettings.url,\n            fileName: this.saveSettings.fileName,\n            saveType: this.saveSettings.saveType,\n            blobData: null\n        };\n        if (typeof (result) === 'object' && result.error) {\n            args.status = 'Failure';\n            args.message = result.error.toString();\n        }\n        else {\n            if (this.needBlobData) {\n                args.blobData = result;\n            }\n            else {\n                this.ClientFileDownload(result, this.saveSettings.fileName);\n            }\n        }\n        this.parent.trigger('saveComplete', args);\n        this.parent.notify(events.saveCompleted, args);\n    };\n    WorkbookSave.prototype.ClientFileDownload = function (blobData, fileName) {\n        var anchor = this.parent.createElement('a', { attrs: { download: this.getFileNameWithExtension() } });\n        var url = URL.createObjectURL(blobData);\n        anchor.href = url;\n        document.body.appendChild(anchor);\n        anchor.click();\n        URL.revokeObjectURL(url);\n        document.body.removeChild(anchor);\n    };\n    WorkbookSave.prototype.initiateFullPostSave = function () {\n        var keys = Object.keys(this.saveSettings);\n        var i;\n        var formElem = this.parent.createElement('form', { attrs: { method: 'POST', action: this.saveSettings.url } });\n        var inputElem = this.parent.createElement('input', { attrs: { type: 'hidden', name: 'JSONData' } });\n        inputElem.value = JSON.stringify(this.saveJSON);\n        formElem.appendChild(inputElem);\n        for (i = 0; i < keys.length; i++) {\n            inputElem = this.parent.createElement('input', { attrs: { type: 'hidden', name: keys[i] } });\n            inputElem.value = this.saveSettings[keys[i]];\n            formElem.appendChild(inputElem);\n        }\n        keys = Object.keys(this.customParams);\n        for (i = 0; i < keys.length; i++) {\n            inputElem = this.parent.createElement('input', { attrs: { type: 'hidden', name: keys[i] } });\n            inputElem.value = this.customParams[keys[i]];\n            formElem.appendChild(inputElem);\n        }\n        document.body.appendChild(formElem);\n        formElem.submit();\n        detach(formElem);\n        this.parent.notify(events.saveCompleted, {});\n    };\n    /**\n     * Get stringified workbook object.\n     * @hidden\n     */\n    WorkbookSave.prototype.getStringifyObject = function (value, skipProp) {\n        if (skipProp === void 0) { skipProp = []; }\n        return JSON.stringify(value, function (key, value) {\n            if (skipProp.indexOf(key) > -1) {\n                return undefined;\n            }\n            else {\n                if (value && typeof value === 'object' && value.hasOwnProperty('properties')) {\n                    return value.properties;\n                }\n                else if (value !== null) {\n                    return value;\n                }\n                else {\n                    return undefined;\n                }\n            }\n        });\n    };\n    WorkbookSave.prototype.getFileNameWithExtension = function (filename) {\n        if (!filename) {\n            filename = this.saveSettings.fileName;\n        }\n        var fileExt = this.getFileExtension();\n        var idx = filename.lastIndexOf('.');\n        if (idx > -1) {\n            filename = filename.substr(0, idx);\n        }\n        return (filename + fileExt);\n    };\n    WorkbookSave.prototype.getFileExtension = function () {\n        return ('.' + this.saveSettings.saveType.toLowerCase());\n    };\n    return WorkbookSave;\n}(SaveWorker));\nexport { WorkbookSave };\n","/**\n * @hidden\n */\nexport var CommonErrors;\n(function (CommonErrors) {\n    CommonErrors[CommonErrors[\"na\"] = 0] = \"na\";\n    CommonErrors[CommonErrors[\"value\"] = 1] = \"value\";\n    CommonErrors[CommonErrors[\"ref\"] = 2] = \"ref\";\n    CommonErrors[CommonErrors[\"divzero\"] = 3] = \"divzero\";\n    CommonErrors[CommonErrors[\"num\"] = 4] = \"num\";\n    CommonErrors[CommonErrors[\"name\"] = 5] = \"name\";\n    CommonErrors[CommonErrors[\"null\"] = 6] = \"null\";\n})(CommonErrors || (CommonErrors = {}));\n/**\n * @hidden\n */\nexport var FormulasErrorsStrings;\n(function (FormulasErrorsStrings) {\n    FormulasErrorsStrings[FormulasErrorsStrings[\"operators_cannot_start_with_expression\"] = 0] = \"operators_cannot_start_with_expression\";\n    FormulasErrorsStrings[FormulasErrorsStrings[\"reservedWord_And\"] = 1] = \"reservedWord_And\";\n    FormulasErrorsStrings[FormulasErrorsStrings[\"reservedWord_Xor\"] = 2] = \"reservedWord_Xor\";\n    FormulasErrorsStrings[FormulasErrorsStrings[\"reservedWord_If\"] = 3] = \"reservedWord_If\";\n    FormulasErrorsStrings[FormulasErrorsStrings[\"number_contains_2_decimal_points\"] = 4] = \"number_contains_2_decimal_points\";\n    FormulasErrorsStrings[FormulasErrorsStrings[\"reservedWord_Else\"] = 5] = \"reservedWord_Else\";\n    FormulasErrorsStrings[FormulasErrorsStrings[\"reservedWord_Not\"] = 6] = \"reservedWord_Not\";\n    FormulasErrorsStrings[FormulasErrorsStrings[\"invalid_char_in_number\"] = 7] = \"invalid_char_in_number\";\n    FormulasErrorsStrings[FormulasErrorsStrings[\"invalid_characters_following_with_operator\"] = 6] = \"invalid_characters_following_with_operator\";\n    FormulasErrorsStrings[FormulasErrorsStrings[\"mismatched_parentheses\"] = 8] = \"mismatched_parentheses\";\n    FormulasErrorsStrings[FormulasErrorsStrings[\"unknown_formula_name\"] = 9] = \"unknown_formula_name\";\n    FormulasErrorsStrings[FormulasErrorsStrings[\"requires_a_single_argument\"] = 10] = \"requires_a_single_argument\";\n    FormulasErrorsStrings[FormulasErrorsStrings[\"requires_3_args\"] = 11] = \"requires_3_args\";\n    FormulasErrorsStrings[FormulasErrorsStrings[\"invalid_Math_argument\"] = 12] = \"invalid_Math_argument\";\n    FormulasErrorsStrings[FormulasErrorsStrings[\"requires_2_args\"] = 13] = \"requires_2_args\";\n    FormulasErrorsStrings[FormulasErrorsStrings[\"bad_index\"] = 14] = \"bad_index\";\n    FormulasErrorsStrings[FormulasErrorsStrings[\"too_complex\"] = 15] = \"too_complex\";\n    FormulasErrorsStrings[FormulasErrorsStrings[\"circular_reference\"] = 16] = \"circular_reference\";\n    FormulasErrorsStrings[FormulasErrorsStrings[\"missing_formula\"] = 17] = \"missing_formula\";\n    FormulasErrorsStrings[FormulasErrorsStrings[\"improper_formula\"] = 18] = \"improper_formula\";\n    FormulasErrorsStrings[FormulasErrorsStrings[\"invalid_expression\"] = 19] = \"invalid_expression\";\n    FormulasErrorsStrings[FormulasErrorsStrings[\"cell_empty\"] = 20] = \"cell_empty\";\n    FormulasErrorsStrings[FormulasErrorsStrings[\"bad_formula\"] = 21] = \"bad_formula\";\n    FormulasErrorsStrings[FormulasErrorsStrings[\"empty_expression\"] = 22] = \"empty_expression\";\n    FormulasErrorsStrings[FormulasErrorsStrings[\"virtual_mode_required\"] = 23] = \"virtual_mode_required\";\n    FormulasErrorsStrings[FormulasErrorsStrings[\"mismatched_tics\"] = 24] = \"mismatched_tics\";\n    FormulasErrorsStrings[FormulasErrorsStrings[\"wrong_number_arguments\"] = 25] = \"wrong_number_arguments\";\n    FormulasErrorsStrings[FormulasErrorsStrings[\"invalid_arguments\"] = 26] = \"invalid_arguments\";\n    FormulasErrorsStrings[FormulasErrorsStrings[\"iterations_do_not_converge\"] = 27] = \"iterations_do_not_converge\";\n    FormulasErrorsStrings[FormulasErrorsStrings[\"calculation_overflow\"] = 29] = \"calculation_overflow\";\n    FormulasErrorsStrings[FormulasErrorsStrings[\"already_registered\"] = 28] = \"already_registered\";\n    FormulasErrorsStrings[FormulasErrorsStrings[\"missing_sheet\"] = 30] = \"missing_sheet\";\n    FormulasErrorsStrings[FormulasErrorsStrings[\"cannot_parse\"] = 31] = \"cannot_parse\";\n    FormulasErrorsStrings[FormulasErrorsStrings[\"expression_cannot_end_with_an_operator\"] = 32] = \"expression_cannot_end_with_an_operator\";\n})(FormulasErrorsStrings || (FormulasErrorsStrings = {}));\n","import { FormulasErrorsStrings, CommonErrors, getSkeletonVal } from '../common/index';\nimport { isNullOrUndefined, getValue, Internationalization } from '@syncfusion/ej2-base';\n/**\n * Represents the basic formulas module.\n */\nvar BasicFormulas = /** @class */ (function () {\n    function BasicFormulas(parent) {\n        this.formulas = [\n            { formulaName: 'SUM', category: 'Math & Trig', description: 'Sums individual values, cell references or ranges.' },\n            {\n                formulaName: 'SUMIFS', category: 'Math & Trig',\n                description: 'Sums the cells specified by a given set of conditionsor criteria.'\n            },\n            {\n                formulaName: 'SUMPRODUCT', category: 'Math & Trig',\n                description: 'Returns sum of the product of given ranges of arrays.'\n            },\n            { formulaName: 'ABS', category: 'Math & Trig', description: 'Returns the absolute value of a number.' },\n            { formulaName: 'RAND', category: 'Math & Trig', description: 'Return a random number between 0 and 1.' },\n            { formulaName: 'FLOOR', category: 'Math & Trig', description: 'Returns the round a number down to the nearest integer.' },\n            { formulaName: 'CEILING', category: 'Math & Trig', description: 'Returns a number rounded up to a multiple of another number.' },\n            {\n                formulaName: 'SUMIF', category: 'Math & Trig',\n                description: 'It will sum up cells that meet the given criteria.'\n            },\n            {\n                formulaName: 'PRODUCT', category: 'Math & Trig',\n                description: 'Multiplies all the numbers given as arguments and returns the product.'\n            },\n            {\n                formulaName: 'AVERAGE', category: 'Statistical',\n                description: 'The sum of the numbers divided by how many numbers are being averaged.'\n            },\n            {\n                formulaName: 'AVERAGEIF', category: 'Statistical',\n                description: 'Computes the average of the numbers in a range that meet the supplied criteria.'\n            },\n            {\n                formulaName: 'COUNT', category: 'Statistical',\n                description: 'Counts the numbers in the list of arguments, exclude text entries.'\n            },\n            { formulaName: 'COUNTA', category: 'Statistical', description: 'Counts the non-empty values in the list of arguments.' },\n            {\n                formulaName: 'COUNTIF', category: 'Statistical',\n                description: 'Counts the number of cells in a range that meet a specified condition.'\n            },\n            {\n                formulaName: 'COUNTIFS', category: 'Statistical',\n                description: 'Counts the number of times each cells in all the ranges that meet the specific conditions.'\n            },\n            {\n                formulaName: 'AVERAGEA', category: 'Statistical',\n                description: 'Calculates the average of values in the list of arguments.Arguments can be numbers, names, arrays or references.'\n            },\n            {\n                formulaName: 'AVERAGEIFS', category: 'Statistical',\n                description: 'Conditionally returns the average of the contents of cells for the set of ranges.'\n            },\n            {\n                formulaName: 'MIN', category: 'Statistical',\n                description: 'Returns the smaller number in set of arguments.'\n            },\n            { formulaName: 'MAX', category: 'Statistical', description: 'Returns the largest number in set of arguments.' },\n            { formulaName: 'DATE', category: 'Date', description: 'Returns the date, given the year, month and day of the month.' },\n            { formulaName: 'DAY', category: 'Date', description: 'Returns the day of a given date.' },\n            { formulaName: 'TODAY', category: 'Date', description: 'Returns the current date as date value.' },\n            { formulaName: 'DAYS', category: 'Date', description: 'Returns the number of days between two dates.' },\n            {\n                formulaName: 'IF', category: 'Logical',\n                description: 'Returns one value if a logical expression is TRUE and another if it is FALSE'\n            },\n            {\n                formulaName: 'AND', category: 'Logical',\n                description: 'Returns TRUE if all the arguments are considered TRUE, and FALSE otherwise.'\n            },\n            {\n                formulaName: 'IFS', category: 'Logical',\n                description: 'Checks multiple conditions and returns a value corresponding to the first TRUE result.'\n            },\n            {\n                formulaName: 'IFERROR', category: 'Logical',\n                description: 'Returns a value you specify if a formula evaluates to an error; otherwise, it returns the result of the formula.'\n            },\n            {\n                formulaName: 'CHOOSE', category: 'Lookup & Reference',\n                description: 'Returns a value from a list, given an index number.'\n            },\n            {\n                formulaName: 'INDEX', category: 'Lookup & Reference',\n                description: 'Returns a value from a table, given a row and column number.'\n            },\n            { formulaName: 'FIND', category: 'Text', description: 'Returns the position of a string of text within another string.' },\n            { formulaName: 'CONCATENATE', category: 'Text', description: ' Used to join two or more strings together.' },\n            { formulaName: 'CONCAT', category: 'Text', description: 'Concatenates a list or range of text strings.' },\n            { formulaName: 'SUBTOTAL', category: 'Lookup & Reference', description: 'Returns a subtotal in a list or database.' },\n            { formulaName: 'RADIANS', category: 'Math & Trig', description: 'Converts degrees to radians.' },\n            {\n                formulaName: 'OR', category: 'Logical',\n                description: 'Returns TRUE if any arguments considered TRUE, and all the arguments are FALSE it will return FALSE.'\n            },\n            {\n                formulaName: 'MATCH', category: 'Lookup & Reference',\n                description: 'Returns the relative position of an checked item in range that matches a specified value in a specified order'\n            },\n            {\n                formulaName: 'RANDBETWEEN', category: 'Math & Trig', description: 'Returns an integer random number in a specified range.'\n            },\n            {\n                formulaName: 'SLOPE', category: 'Statistical',\n                description: 'Returns the slope of the line from linear regression of the data points.'\n            },\n            {\n                formulaName: 'INTERCEPT', category: 'Statistical',\n                description: 'Calculates the point of the Y-intercept line via linear regression.'\n            },\n            {\n                formulaName: 'ROUNDUP', category: 'Math & Trig', description: 'Rounds a number away from zero.'\n            },\n            {\n                formulaName: 'INT', category: 'Math & Trig', description: 'Returns a number to the nearest integer.'\n            },\n            {\n                formulaName: 'LN', category: 'Math & Trig', description: 'Returns the natural logarithm of a number.'\n            },\n            {\n                formulaName: 'ISNUMBER', category: 'Information', description: 'Returns TRUE, if the argument is number and FALSE otherwise.'\n            },\n            {\n                formulaName: 'ROUND', category: 'Math & Trig', description: 'Rounds a number to a specified number of digits.'\n            },\n            {\n                formulaName: 'LOG', category: 'Math & Trig', description: 'Returns the logarithm of a number to the base that you specify.'\n            },\n            {\n                formulaName: 'POWER', category: 'Math & Trig', description: 'Returns the result of a number raised to power.'\n            },\n            {\n                formulaName: 'TRUNC', category: 'Math & Trig',\n                description: 'Returns the truncated value of a number to a specified number of decimal places.'\n            },\n            {\n                formulaName: 'EXP', category: 'Math & Trig', description: 'Returns e raised to the power of the given number.'\n            },\n            {\n                formulaName: 'GEOMEAN', category: 'Statistical',\n                description: 'Returns the geometric mean of an array or range of positive data.'\n            },\n            { formulaName: 'TEXT', category: 'Lookup & Reference', description: 'Returns the value in required format.' }\n        ];\n        this.isConcat = false;\n        this.parent = parent;\n        this.init();\n    }\n    BasicFormulas.prototype.init = function () {\n        var fn;\n        for (var i = 0; i < this.formulas.length; i++) {\n            fn = getValue('Compute' + this.formulas[i].formulaName, this).bind(this);\n            this.addFormulaCollection(this.formulas[i].formulaName.toUpperCase(), fn, this.formulas[i].category, this.formulas[i].description);\n        }\n    };\n    BasicFormulas.prototype.addFormulaCollection = function (formulaName, functionName, formulaCategory, description) {\n        this.parent.libraryFormulas = {\n            fName: formulaName, handler: functionName, category: formulaCategory,\n            description: description\n        };\n    };\n    /** @hidden */\n    BasicFormulas.prototype.ComputeSUM = function () {\n        var args = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            args[_i] = arguments[_i];\n        }\n        if (isNullOrUndefined(args) || (args.length === 1 && args[0] === '')) {\n            return this.parent.formulaErrorStrings[FormulasErrorsStrings.invalid_arguments];\n        }\n        var sum = 0;\n        var val;\n        var orgValue;\n        if (!isNullOrUndefined(args)) {\n            var argArr = args;\n            for (var i = 0; i < argArr.length; i++) {\n                var argValue = argArr[i].toString();\n                if (argValue.indexOf(':') > -1 && this.parent.isCellReference(argValue)) {\n                    var cellCollection = this.parent.getCellCollection(argValue.split(this.parent.tic).join(''));\n                    for (var j = 0; j < cellCollection.length; j++) {\n                        val = this.parent.getValueFromArg(cellCollection[j]);\n                        if (this.parent.getErrorStrings().indexOf(val) > -1) {\n                            return val;\n                        }\n                        if (isNullOrUndefined(val[0]) || isNaN(this.parent.parseFloat(val))) {\n                            continue;\n                        }\n                        sum = sum + this.parent.parseFloat(val);\n                    }\n                }\n                else {\n                    if (argArr[i].split(this.parent.tic).join('') === this.parent.trueValue) {\n                        argArr[i] = '1';\n                    }\n                    if (argArr[i].split(this.parent.tic).join('') === this.parent.falseValue) {\n                        argArr[i] = '0';\n                    }\n                    orgValue = this.parent.getValueFromArg(argArr[i].split(this.parent.tic).join(''));\n                    if (this.parent.getErrorStrings().indexOf(orgValue) > -1) {\n                        return orgValue;\n                    }\n                    if (isNullOrUndefined(orgValue) || isNaN(this.parent.parseFloat(orgValue))) {\n                        continue;\n                    }\n                    if (orgValue.length > 0) {\n                        sum = sum + this.parent.parseFloat(orgValue + '');\n                    }\n                }\n            }\n        }\n        return sum;\n    };\n    /** @hidden */\n    BasicFormulas.prototype.ComputeINT = function () {\n        var args = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            args[_i] = arguments[_i];\n        }\n        var str;\n        var num;\n        var index;\n        if (!isNullOrUndefined(args) && args.length !== 1 || args[0] === '') {\n            str = this.parent.formulaErrorStrings[FormulasErrorsStrings.invalid_arguments];\n        }\n        if (args[0] !== '' && args.length === 1) {\n            str = args[0];\n            index = str.indexOf('\"');\n            str = str.indexOf('\"') > -1 ? str.replace('\"', '') : str;\n            str = str.indexOf('\"') > -1 ? str.replace('\"', '') : str;\n            str = this.parent.getValueFromArg(str);\n            str = str.toUpperCase() === 'TRUE' ? '1' : (str === 'FALSE' ? '0' : str);\n            num = this.parent.parseFloat(str);\n            num = Math.floor(num);\n        }\n        if (isNaN(num)) {\n            str = index > -1 ? this.parent.getErrorStrings()[CommonErrors.value] : this.parent.getErrorStrings()[CommonErrors.name];\n        }\n        return num ? num : str;\n    };\n    ;\n    /** @hidden */\n    BasicFormulas.prototype.ComputeTODAY = function () {\n        var args = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            args[_i] = arguments[_i];\n        }\n        var str;\n        if (args && args[0] !== '') {\n            str = this.parent.formulaErrorStrings[FormulasErrorsStrings.invalid_arguments];\n        }\n        else {\n            var dt = new Date(Date.now());\n            str = dt.getFullYear() + '/' + this.parent.calculateDate((dt.getMonth() + 1).toString()) + '/'\n                + this.parent.calculateDate(dt.getDate().toString());\n        }\n        return str;\n    };\n    /** @hidden */\n    BasicFormulas.prototype.ComputeSUMPRODUCT = function () {\n        var args = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            args[_i] = arguments[_i];\n        }\n        var sum = 0;\n        var count = 0;\n        var index;\n        var mulValues = null;\n        var ranges = args;\n        for (var k = 0; k < ranges.length; ++k) {\n            var range = ranges[k];\n            if (!range.startsWith(this.parent.tic) && this.parent.isCellReference(range)) {\n                var i = range.indexOf(':');\n                var startRow = this.parent.rowIndex(range.substr(0, i));\n                var endRow = this.parent.rowIndex(range.substr(i + 1));\n                if (!(startRow !== -1 || endRow === -1) === (startRow === -1 || endRow !== -1)) {\n                    return this.parent.getErrorStrings()[CommonErrors.name];\n                }\n                var col1 = this.parent.colIndex(range.substr(0, i));\n                var col2 = this.parent.colIndex(range.substr(i + 1));\n                if (mulValues === null) {\n                    count = (endRow - startRow + 1) * (col2 - col1 + 1);\n                    mulValues = [];\n                    for (i = 0; i < count; ++i) {\n                        mulValues[i] = 1; //To create required index.\n                    }\n                }\n                i = 0;\n                for (var row = startRow; row <= endRow; ++row) {\n                    for (var col = col1; col <= col2; ++col) {\n                        var cellRef = '' + this.parent.convertAlpha(col) + (row);\n                        var result = this.parent.getValueFromArg(cellRef);\n                        if (!isNaN(parseFloat(result))) {\n                            //To return #VALUE! error when array dimensions are mismatched.\n                            if (isNaN(mulValues[i])) {\n                                return this.parent.getErrorStrings()[CommonErrors.name];\n                            }\n                            mulValues[i] = mulValues[i] * parseFloat(result);\n                        }\n                        else {\n                            mulValues[i] = 0;\n                        }\n                        i++;\n                    }\n                }\n            }\n            else {\n                var s1 = this.parent.getValueFromArg(range);\n                index = s1.indexOf('\"');\n                if (this.parent.getErrorStrings().indexOf(s1) > -1) {\n                    return s1;\n                }\n                else if (index > -1) {\n                    return 0;\n                }\n                else {\n                    return this.parent.formulaErrorStrings[FormulasErrorsStrings.invalid_arguments];\n                }\n            }\n        }\n        for (var i = 0; i < count; ++i) {\n            sum += mulValues[i];\n        }\n        return sum;\n    };\n    ;\n    /** @hidden */\n    BasicFormulas.prototype.ComputeROUNDUP = function () {\n        var args = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            args[_i] = arguments[_i];\n        }\n        var str;\n        var num;\n        var arg1;\n        var arg2;\n        var index;\n        var len = args.length;\n        if (!isNullOrUndefined(args) && len > 2) {\n            str = this.parent.formulaErrorStrings[FormulasErrorsStrings.invalid_arguments];\n        }\n        if (len === 1 && args[0] !== '') {\n            index = args[0].indexOf('\"');\n            arg1 = args[0].indexOf('\"') > -1 ? args[0].replace('\"', '') : args[0];\n            arg1 = arg1.indexOf('\"') > -1 ? arg1.replace('\"', '') : arg1;\n            arg1 = arg1.toUpperCase() === 'TRUE' ? '1' : (arg1 === 'FALSE' ? '0' : arg1);\n            arg1 = this.parent.getValueFromArg(arg1);\n            num = this.parent.parseFloat(arg1);\n            if (num > 0) {\n                num += .4999999999; // To round the number, we using this value.\n            }\n            else if (num < 0) {\n                num -= .4999999999;\n            }\n            num = this.parent.parseFloat(num.toFixed(0));\n            str = num.toString();\n        }\n        else if (len === 2 && args[0] !== '' && args[1] !== '') {\n            index = args[0].indexOf('\"') > -1 ? args[0].indexOf('\"') : (args[1].indexOf('\"') > -1 ? args[1].indexOf('\"') : -1);\n            arg1 = args[0].indexOf('\"') > -1 ? args[0].replace('\"', '') : args[0];\n            arg1 = arg1.indexOf('\"') > -1 ? arg1.replace('\"', '') : arg1;\n            arg2 = args[1].indexOf('\"') > -1 ? args[1].replace('\"', '') : args[1];\n            arg2 = arg2.indexOf('\"') > -1 ? arg2.replace('\"', '') : arg2;\n            arg1 = arg1.toUpperCase() === 'TRUE' ? '1' : (arg1 === 'FALSE' ? '0' : arg1);\n            arg2 = arg2.toUpperCase() === 'TRUE' ? '1' : (arg2 === 'FALSE' ? '0' : arg2);\n            arg1 = this.parent.getValueFromArg(arg1);\n            arg2 = this.parent.getValueFromArg(arg2);\n            var digits = Math.ceil(this.parent.parseFloat(arg2));\n            num = this.parent.parseFloat(arg1);\n            if (digits > 0) {\n                if (num > 0) {\n                    num += .4999999999 / Math.pow(10, digits);\n                }\n                else if (num < 0) {\n                    num -= .4999999999 / Math.pow(10, digits);\n                }\n                num = this.parent.parseFloat(num.toFixed(digits));\n                str = num.toFixed(digits);\n                if (isNaN(num)) {\n                    if (digits.toString().indexOf('\"') > -1) {\n                        str = this.parent.getErrorStrings()[CommonErrors.value];\n                    }\n                    else {\n                        str = this.parent.getErrorStrings()[CommonErrors.name];\n                    }\n                }\n            }\n            else {\n                if (num > 0) {\n                    num = (num / Math.pow(10, -digits)) + .49999;\n                }\n                else if (num < 0) {\n                    num = (num / Math.pow(10, -digits)) - .49999;\n                }\n                num = this.parent.parseFloat(num.toFixed(0)) * Math.pow(10, -digits);\n                str = num.toString();\n                if (isNaN(num)) {\n                    str = (digits.toString().indexOf('\"') > -1) ? this.parent.getErrorStrings()[CommonErrors.value] :\n                        str = this.parent.getErrorStrings()[CommonErrors.name];\n                }\n            }\n        }\n        else {\n            str = index > -1 ? this.parent.getErrorStrings()[CommonErrors.value] :\n                this.parent.formulaErrorStrings[FormulasErrorsStrings.invalid_arguments];\n        }\n        return str;\n    };\n    ;\n    /** @hidden */\n    BasicFormulas.prototype.ComputeCOUNT = function () {\n        var args = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            args[_i] = arguments[_i];\n        }\n        if (isNullOrUndefined(args) || (args.length === 1 && args[0] === '')) {\n            return this.parent.formulaErrorStrings[FormulasErrorsStrings.wrong_number_arguments];\n        }\n        var argArr = args;\n        var argVal;\n        var cellColl;\n        var result = 0;\n        var cellValue;\n        for (var i = 0; i < argArr.length; i++) {\n            argVal = argArr[i];\n            if (argVal.indexOf(':') > -1 && this.parent.isCellReference(argVal)) {\n                cellColl = this.parent.getCellCollection(argVal.split(this.parent.tic).join(''));\n                for (var j = 0; j < cellColl.length; j++) {\n                    cellValue = this.parent.getValueFromArg(cellColl[j]);\n                    if (!isNaN(this.parent.parseFloat(cellValue))) {\n                        if (argVal.length > 0 && argVal !== '' && argVal !== ' ') {\n                            result++;\n                        }\n                    }\n                }\n            }\n            else {\n                argVal = argVal.split(this.parent.tic).join('');\n                if (!isNaN(this.parent.parseFloat(this.parent.getValueFromArg(argVal)))) {\n                    if (argVal.length > 0 && argVal !== '' && argVal !== ' ') {\n                        result++;\n                    }\n                }\n            }\n        }\n        return result;\n    };\n    /** @hidden */\n    BasicFormulas.prototype.ComputeDATE = function () {\n        var args = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            args[_i] = arguments[_i];\n        }\n        if (isNullOrUndefined(args) || (args.length === 1 && args[0] === '')) {\n            return this.parent.formulaErrorStrings[FormulasErrorsStrings.wrong_number_arguments];\n        }\n        var argArr = args;\n        if (argArr.length !== 3) {\n            return this.parent.formulaErrorStrings[FormulasErrorsStrings.wrong_number_arguments];\n        }\n        for (var i = 0; i < argArr.length; ++i) {\n            argArr[i] = this.parent.getValueFromArg(argArr[i]);\n        }\n        /* tslint:disable */\n        argArr[0] = (argArr[0].split(this.parent.tic).join('') === 'TRUE') ? '1' : (argArr[0].split(this.parent.tic).join('') === 'FALSE') ? '0' : argArr[0];\n        argArr[1] = (argArr[1].split(this.parent.tic).join('') === 'TRUE') ? '1' : (argArr[1].split(this.parent.tic).join('') === 'FALSE') ? '0' : argArr[1];\n        argArr[2] = (argArr[2].split(this.parent.tic).join('') === 'TRUE') ? '1' : (argArr[2].split(this.parent.tic).join('') === 'FALSE') ? '0' : argArr[2];\n        /* tslint:enable */\n        var year = this.parent.parseFloat(argArr[0].split(this.parent.tic).join(''));\n        var month = this.parent.parseFloat(argArr[1].split(this.parent.tic).join(''));\n        var day = this.parent.parseFloat(argArr[2].split(this.parent.tic).join(''));\n        var days = 0;\n        if (!isNaN(year) && !isNaN(month) && !isNaN(day)) {\n            if (year < 0) {\n                return this.parent.getErrorStrings()[CommonErrors.num].toString();\n            }\n            while (month > 12) {\n                month -= 12;\n                year++;\n            }\n            days = this.parent.getSerialDateFromDate(year, month, day);\n        }\n        else {\n            return this.parent.getErrorStrings()[CommonErrors.value].toString();\n        }\n        if (days === 0) {\n            return this.parent.getErrorStrings()[CommonErrors.num].toString();\n        }\n        var date = this.parent.fromOADate(days);\n        if (date.toString() !== 'Invalid Date') {\n            /* tslint:disable-next-line */\n            return date.getFullYear() + '/' + this.parent.calculateDate((date.getMonth() + 1).toString()) + '/' + this.parent.calculateDate(date.getDate().toString());\n        }\n        return days.toString();\n    };\n    /** @hidden */\n    BasicFormulas.prototype.ComputeFLOOR = function () {\n        var args = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            args[_i] = arguments[_i];\n        }\n        if (isNullOrUndefined(args) || (args.length === 1 && args[0] === '')) {\n            return this.parent.formulaErrorStrings[FormulasErrorsStrings.invalid_arguments];\n        }\n        var argArr = args;\n        var argCount = argArr.length;\n        var splitArg = argArr[1].split(this.parent.tic).join('');\n        var argValue = [];\n        var fnum;\n        var significance;\n        if (argCount !== 2) {\n            return this.parent.formulaErrorStrings[FormulasErrorsStrings.wrong_number_arguments];\n        }\n        argValue.push(fnum = this.parent.parseFloat(this.parent.getValueFromArg(argArr[0].split(this.parent.tic).join(''))));\n        argArr[1] = (splitArg === this.parent.trueValue) ? '1' : (splitArg === this.parent.falseValue) ? '0' : argArr[1];\n        argValue.push(significance = this.parent.parseFloat(this.parent.getValueFromArg(argArr[1].split(this.parent.tic).join(''))));\n        if (fnum > 0 && significance < 0) {\n            return this.parent.getErrorStrings()[CommonErrors.num];\n        }\n        if (fnum > 0 && significance === 0) {\n            return this.parent.getErrorStrings()[CommonErrors.divzero];\n        }\n        for (var i = 0; i < argArr.length; i++) {\n            if (argArr[i].indexOf(this.parent.tic) > -1) {\n                return this.parent.getErrorStrings()[CommonErrors.value];\n            }\n        }\n        if (isNaN(fnum)) {\n            return this.parent.getErrorStrings()[CommonErrors.name];\n        }\n        return Math.floor(fnum / significance) * significance;\n    };\n    /** @hidden */\n    BasicFormulas.prototype.ComputeCEILING = function () {\n        var args = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            args[_i] = arguments[_i];\n        }\n        if (isNullOrUndefined(args) || (args.length === 1 && args[0] === '')) {\n            return this.parent.formulaErrorStrings[FormulasErrorsStrings.invalid_arguments];\n        }\n        var argArr = args;\n        var orgValue = [];\n        var argCount = argArr.length;\n        var splitArg = argArr[1].split(this.parent.tic).join('');\n        var cnum;\n        var significance;\n        if (argCount !== 2) {\n            return this.parent.formulaErrorStrings[FormulasErrorsStrings.wrong_number_arguments];\n        }\n        orgValue.push(cnum = this.parent.parseFloat(this.parent.getValueFromArg(argArr[0].split(this.parent.tic).join(''))));\n        argArr[1] = (splitArg === this.parent.trueValue) ? '1' : (splitArg === this.parent.falseValue) ? '0' : argArr[1];\n        orgValue.push(significance = this.parent.parseFloat(this.parent.getValueFromArg(argArr[1].split(this.parent.tic).join(''))));\n        if (cnum > 0 && significance < 0) {\n            return this.parent.getErrorStrings()[CommonErrors.num];\n        }\n        for (var i = 0; i < argArr.length; i++) {\n            if (argArr[i].indexOf(this.parent.tic) > -1) {\n                return this.parent.getErrorStrings()[CommonErrors.value];\n            }\n        }\n        if (isNaN(cnum)) {\n            return this.parent.getErrorStrings()[CommonErrors.name];\n        }\n        if (significance === 0) {\n            return 0;\n        }\n        return Math.ceil(cnum / significance) * significance;\n    };\n    /** @hidden */\n    BasicFormulas.prototype.ComputeDAY = function () {\n        var serialNumber = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            serialNumber[_i] = arguments[_i];\n        }\n        var date = serialNumber;\n        var result;\n        if (isNullOrUndefined(date) || (date.length === 1 && date[0] === '')) {\n            return this.parent.formulaErrorStrings[FormulasErrorsStrings.invalid_arguments];\n        }\n        if (date.length > 1) {\n            return this.parent.formulaErrorStrings[FormulasErrorsStrings.wrong_number_arguments];\n        }\n        var dateVal = this.parent.getValueFromArg(date[0].split(this.parent.tic).join(''));\n        if (!isNaN(this.parent.parseFloat(dateVal))) {\n            return this.parent.getErrorStrings()[CommonErrors.name];\n        }\n        else {\n            dateVal = dateVal;\n        }\n        result = this.parent.parseDate(dateVal);\n        if (Object.prototype.toString.call(result) === '[object Date]') {\n            /* tslint:disable-next-line */\n            result = result.getDate();\n        }\n        return result;\n    };\n    /** @hidden */\n    BasicFormulas.prototype.ComputeIF = function () {\n        var args = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            args[_i] = arguments[_i];\n        }\n        if (isNullOrUndefined(args) || (args.length === 1 && args[0] === '')) {\n            return this.parent.formulaErrorStrings[FormulasErrorsStrings.invalid_arguments];\n        }\n        if (this.parent.getErrorStrings().indexOf(args[0]) > 0) {\n            return args[0];\n        }\n        var argArr = args;\n        var condition;\n        var result;\n        if (argArr.length > 3 || argArr.length === 1) {\n            return this.parent.formulaErrorStrings[FormulasErrorsStrings.wrong_number_arguments];\n        }\n        else if (argArr.length <= 3) {\n            condition = this.parent.getValueFromArg(argArr[0]);\n            if (this.parent.getErrorStrings().indexOf(condition) > -1) {\n                return condition;\n            }\n            if (condition === this.parent.trueValue || this.parent.parseFloat(condition) > 0 || this.parent.parseFloat(condition) < 0) {\n                result = this.parent.getValueFromArg(argArr[1]);\n            }\n            else if (condition === this.parent.falseValue || this.parent.parseFloat(condition) === 0) {\n                if (isNullOrUndefined(argArr[2])) {\n                    return this.parent.falseValue;\n                }\n                result = this.parent.getValueFromArg(argArr[2]);\n            }\n            else {\n                return this.parent.formulaErrorStrings[FormulasErrorsStrings.requires_3_args];\n            }\n        }\n        if (result.indexOf(this.parent.tic) > -1) {\n            return result.split(this.parent.tic).join('');\n        }\n        else {\n            return result;\n        }\n    };\n    /** @hidden */\n    BasicFormulas.prototype.ComputeIFERROR = function () {\n        var args = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            args[_i] = arguments[_i];\n        }\n        if (isNullOrUndefined(args) || (args.length === 1 && args[0] === '')) {\n            return this.parent.formulaErrorStrings[FormulasErrorsStrings.invalid_arguments];\n        }\n        var argArr = args;\n        var condition;\n        if (argArr.length !== 2) {\n            return this.parent.formulaErrorStrings[FormulasErrorsStrings.wrong_number_arguments];\n        }\n        condition = this.parent.getValueFromArg(argArr[0]);\n        if (condition === this.parent.trueValue || condition === this.parent.falseValue) {\n            return condition;\n        }\n        if (condition[0] === this.parent.arithMarker) {\n            condition = condition.replace(this.parent.arithMarker, ' ');\n        }\n        condition = this.parent.getValueFromArg(condition).toUpperCase().split(this.parent.tic).join('');\n        if (condition[0] === '#' || condition.indexOf('Infinity') > -1 || this.parent.getErrorStrings().indexOf(condition) > -1) {\n            return this.parent.getValueFromArg(argArr[1]).split(this.parent.tic).join('');\n        }\n        else {\n            return condition;\n        }\n    };\n    /** @hidden */\n    BasicFormulas.prototype.ComputePRODUCT = function () {\n        var range = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            range[_i] = arguments[_i];\n        }\n        if (isNullOrUndefined(range) || (range.length === 1 && range[0] === '')) {\n            return this.parent.formulaErrorStrings[FormulasErrorsStrings.invalid_arguments];\n        }\n        var product = 1;\n        var val;\n        var orgValue;\n        var argsHit = true;\n        var parseVal;\n        if (!isNullOrUndefined(range)) {\n            var argArr = range;\n            for (var i = 0; i < argArr.length; i++) {\n                var rangevalue = argArr[i];\n                if (rangevalue.indexOf(':') > -1 && this.parent.isCellReference(rangevalue)) {\n                    var cellCollection = this.parent.getCellCollection(rangevalue);\n                    for (var j = 0; j < cellCollection.length; j++) {\n                        val = this.parent.getValueFromArg(cellCollection[j].split(this.parent.tic).join(''));\n                        if (this.parent.getErrorStrings().indexOf(val) > -1) {\n                            return val;\n                        }\n                        val = (val.split(this.parent.tic).join('') === 'TRUE') ? '1' :\n                            (val.split(this.parent.tic).join('') === 'FALSE') ? '0' : val;\n                        parseVal = this.parent.parseFloat(val);\n                        if (!isNaN(parseVal)) {\n                            if (val.length > 0) {\n                                product = product * parseVal;\n                                argsHit = false;\n                            }\n                        }\n                    }\n                }\n                else {\n                    orgValue = this.parent.getValueFromArg(argArr[i].split(this.parent.tic).join(''));\n                    if (this.parent.getErrorStrings().indexOf(orgValue) > -1) {\n                        return orgValue;\n                    }\n                    orgValue = (orgValue.split(this.parent.tic).join('') === 'TRUE') ? '1' :\n                        (orgValue.split(this.parent.tic).join('') === 'FALSE') ? '0' : orgValue;\n                    parseVal = this.parent.parseFloat(orgValue);\n                    if (!isNaN(parseVal)) {\n                        if (orgValue.length > 0) {\n                            product = product * parseVal;\n                            argsHit = false;\n                        }\n                    }\n                    if (this.parent.getErrorStrings().indexOf(orgValue) > -1) {\n                        return orgValue;\n                    }\n                }\n            }\n        }\n        return argsHit ? '0' : product.toString();\n    };\n    /** @hidden */\n    BasicFormulas.prototype.ComputeDAYS = function () {\n        var range = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            range[_i] = arguments[_i];\n        }\n        var result;\n        if (isNullOrUndefined(range) && (range.length === 1 && range[0] === '')) {\n            return this.parent.formulaErrorStrings[FormulasErrorsStrings.invalid_arguments];\n        }\n        if (range.length !== 2) {\n            return this.parent.formulaErrorStrings[FormulasErrorsStrings.wrong_number_arguments];\n        }\n        var argsArr = range;\n        if (argsArr[0].split(this.parent.tic).join('') === this.parent.trueValue) {\n            argsArr[0] = '1';\n        }\n        if (argsArr[0].split(this.parent.tic).join('') === this.parent.falseValue) {\n            argsArr[0] = '0';\n        }\n        var endDate = this.parent.getValueFromArg(argsArr[0].split(this.parent.tic).join(''));\n        var startDate = this.parent.getValueFromArg(argsArr[1].split(this.parent.tic).join(''));\n        startDate = (startDate === '' || startDate == null) ? new Date(Date.parse('1899-12-31')).toDateString() : startDate;\n        endDate = (endDate === '' || endDate == null) ? new Date(Date.parse('1899-12-31')).toDateString() : endDate;\n        if (endDate[0] === '#') {\n            return endDate;\n        }\n        if (startDate[0] === '#') {\n            return startDate;\n        }\n        var d1 = this.parent.intToDate(endDate);\n        var d2 = this.parent.intToDate(startDate);\n        if (d1.toString()[0] === '#') {\n            return d1.toString();\n        }\n        if (d2.toString()[0] === '#') {\n            return d2.toString();\n        }\n        if (Object.prototype.toString.call(d1) === '[object Date]' && Object.prototype.toString.call(d2) === '[object Date]') {\n            /* tslint:disable-next-line */\n            result = Math.ceil(d1.getTime() - d2.getTime()) / (1000 * 3600 * 24);\n        }\n        else {\n            return this.parent.getErrorStrings()[CommonErrors.value];\n        }\n        return Math.round(result);\n    };\n    /** @hidden */\n    BasicFormulas.prototype.ComputeCHOOSE = function () {\n        var args = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            args[_i] = arguments[_i];\n        }\n        if (isNullOrUndefined(args) || (args.length === 1 && args[0] === '')) {\n            return this.parent.formulaErrorStrings[FormulasErrorsStrings.invalid_arguments];\n        }\n        if (args.length < 2) {\n            return this.parent.formulaErrorStrings[FormulasErrorsStrings.wrong_number_arguments];\n        }\n        var argsArr = args;\n        if (argsArr[0].indexOf(':') > -1 && this.parent.isCellReference(argsArr[0])) {\n            var cellCollection = this.parent.getCellCollection(argsArr[0]);\n            if (cellCollection.length === 1) {\n                argsArr[0] = cellCollection[0];\n            }\n            else {\n                return this.parent.getErrorStrings()[CommonErrors.value];\n            }\n        }\n        var cond = this.parent.getValueFromArg(argsArr[0]);\n        if (this.parent.getErrorStrings().indexOf(cond) > -1) {\n            return cond;\n        }\n        var indexNum = this.parent.parseFloat(this.parent.getValueFromArg(argsArr[0].split(this.parent.tic).join('')));\n        if (indexNum < 1) {\n            return this.parent.getErrorStrings()[CommonErrors.value];\n        }\n        indexNum = Math.floor(indexNum);\n        var result;\n        if (isNullOrUndefined(argsArr[indexNum])) {\n            return this.parent.getErrorStrings()[CommonErrors.value];\n        }\n        result = argsArr[indexNum];\n        if (result === '') {\n            result = '0';\n        }\n        if (result.indexOf(':') > -1 && this.parent.isCellReference(result)) {\n            var cellCollection = this.parent.getCellCollection(argsArr[0].split(this.parent.tic).join(''));\n            if (cellCollection.length === 1) {\n                argsArr[0] = cellCollection[0];\n            }\n            else {\n                return this.parent.getErrorStrings()[CommonErrors.value];\n            }\n        }\n        return this.parent.getValueFromArg(result).split(this.parent.tic).join('');\n    };\n    /** @hidden */\n    BasicFormulas.prototype.ComputeSUMIF = function () {\n        var range = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            range[_i] = arguments[_i];\n        }\n        var argArr = range;\n        if (argArr[0].indexOf(':') < 0 && !this.parent.isCellReference(argArr[0])) {\n            return this.parent.formulaErrorStrings[FormulasErrorsStrings.improper_formula];\n        }\n        var result = this.parent.computeSumIfAndAvgIf(range);\n        if (typeof result === 'string' && (this.parent.formulaErrorStrings.indexOf(result)\n            || this.parent.getErrorStrings().indexOf(result))) {\n            return result;\n        }\n        return result[0];\n    };\n    /** @hidden */\n    BasicFormulas.prototype.ComputeABS = function () {\n        var absValue = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            absValue[_i] = arguments[_i];\n        }\n        var argArr = absValue;\n        var cellvalue = '';\n        var absVal;\n        if (absValue.length === 0 || absValue.length > 1) {\n            return this.parent.formulaErrorStrings[FormulasErrorsStrings.wrong_number_arguments];\n        }\n        if (argArr[0].toString().split(this.parent.tic).join('').trim() === '' || argArr[0].indexOf(this.parent.tic) > -1) {\n            return this.parent.getErrorStrings()[CommonErrors.value];\n        }\n        if (this.parent.isCellReference(argArr[0])) {\n            cellvalue = this.parent.getValueFromArg(argArr[0]);\n            if (cellvalue === '') {\n                return this.parent.getErrorStrings()[CommonErrors.name];\n            }\n            absVal = this.parent.parseFloat(cellvalue);\n            if (isNaN(absVal)) {\n                return this.parent.getErrorStrings()[CommonErrors.value];\n            }\n        }\n        else {\n            absVal = this.parent.parseFloat(argArr[0]);\n            if (isNaN(absVal)) {\n                return this.parent.getErrorStrings()[CommonErrors.name];\n            }\n        }\n        return Math.abs(absVal);\n    };\n    /** @hidden */\n    BasicFormulas.prototype.ComputeAVERAGE = function () {\n        var args = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            args[_i] = arguments[_i];\n        }\n        if (isNullOrUndefined(args) || (args.length === 1 && args[0] === '')) {\n            return this.parent.formulaErrorStrings[FormulasErrorsStrings.invalid_arguments];\n        }\n        var argArr = args;\n        for (var i = 0; i < argArr.length; i++) {\n            if (argArr[i].indexOf(':') > -1) {\n                if (argArr[i].indexOf(this.parent.tic) > -1) {\n                    return this.parent.getErrorStrings()[CommonErrors.value];\n                }\n            }\n        }\n        return this.parent.calculateAvg(argArr);\n    };\n    /** @hidden */\n    BasicFormulas.prototype.ComputeAVERAGEIF = function () {\n        var range = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            range[_i] = arguments[_i];\n        }\n        var argList = range;\n        if (argList[0].indexOf(':') < 0 && !this.parent.isCellReference(argList[0])) {\n            return this.parent.formulaErrorStrings[FormulasErrorsStrings.improper_formula];\n        }\n        var resultVal = this.parent.computeSumIfAndAvgIf(range);\n        if (typeof resultVal === 'string' && (this.parent.formulaErrorStrings.indexOf(resultVal)\n            || this.parent.getErrorStrings().indexOf(resultVal))) {\n            return resultVal;\n        }\n        return this.parent.parseFloat(resultVal[0]) / this.parent.parseFloat(resultVal[1]);\n    };\n    /** @hidden */\n    BasicFormulas.prototype.ComputeCONCATENATE = function () {\n        var range = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            range[_i] = arguments[_i];\n        }\n        if (isNullOrUndefined(range) || (range.length === 1 && range[0] === '')) {\n            return this.parent.formulaErrorStrings[FormulasErrorsStrings.invalid_arguments];\n        }\n        var argsList = range;\n        var result = '';\n        var tempStr = '';\n        for (var i = 0; i < argsList.length; i++) {\n            if (argsList[i].indexOf(':') > -1 && this.parent.isCellReference(argsList[i])) {\n                if (this.isConcat) {\n                    var cells = this.parent.getCellCollection(argsList[i]);\n                    for (var i_1 = 0; i_1 < cells.length; i_1++) {\n                        tempStr = this.parent.getValueFromArg(cells[i_1]);\n                        result = result + tempStr;\n                    }\n                }\n                else {\n                    return this.parent.getErrorStrings()[CommonErrors.value];\n                }\n            }\n            else {\n                if (argsList.length === 1 && argsList[0].indexOf(this.parent.tic) < 0) {\n                    return this.parent.getErrorStrings()[CommonErrors.name];\n                }\n                else {\n                    tempStr = this.parent.getValueFromArg(argsList[i]);\n                    result = result + tempStr;\n                }\n            }\n            if (this.parent.getErrorStrings().indexOf(tempStr) > -1) {\n                return tempStr;\n            }\n        }\n        return result.split(this.parent.tic).join('');\n    };\n    /** @hidden */\n    BasicFormulas.prototype.ComputeCONCAT = function () {\n        var range = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            range[_i] = arguments[_i];\n        }\n        this.isConcat = true;\n        return this.ComputeCONCATENATE.apply(this, range);\n    };\n    /** @hidden */\n    BasicFormulas.prototype.ComputeMAX = function () {\n        var args = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            args[_i] = arguments[_i];\n        }\n        return this.parent.computeMinMax(args, 'max');\n    };\n    /** @hidden */\n    BasicFormulas.prototype.ComputeMIN = function () {\n        var args = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            args[_i] = arguments[_i];\n        }\n        return this.parent.computeMinMax(args, 'min');\n    };\n    /** @hidden */\n    BasicFormulas.prototype.ComputeRAND = function () {\n        var args = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            args[_i] = arguments[_i];\n        }\n        if (args.length === 1 && args[0] === '') {\n            args.length = 0;\n        }\n        if (args.length > 0) {\n            return this.parent.formulaErrorStrings[FormulasErrorsStrings.wrong_number_arguments];\n        }\n        return Math.random().toString();\n    };\n    /** @hidden */\n    BasicFormulas.prototype.ComputeAND = function () {\n        var args = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            args[_i] = arguments[_i];\n        }\n        return this.parent.computeAndOr(args, 'and');\n    };\n    /** @hidden */\n    BasicFormulas.prototype.ComputeOR = function () {\n        var args = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            args[_i] = arguments[_i];\n        }\n        return this.parent.computeAndOr(args, 'or');\n    };\n    /** @hidden */\n    BasicFormulas.prototype.ComputeFIND = function () {\n        var args = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            args[_i] = arguments[_i];\n        }\n        if (isNullOrUndefined(args) || (args.length === 1 && args[0] === '')) {\n            return this.parent.formulaErrorStrings[FormulasErrorsStrings.wrong_number_arguments];\n        }\n        var argsList = args;\n        if (argsList.length > 3) {\n            return this.parent.formulaErrorStrings[FormulasErrorsStrings.wrong_number_arguments];\n        }\n        var findText = this.parent.removeTics(this.parent.getValueFromArg(argsList[0]));\n        var withinText = this.parent.removeTics(this.parent.getValueFromArg(argsList[1]));\n        if (this.parent.getErrorStrings().indexOf(findText) > -1 || this.parent.getErrorStrings().indexOf(withinText) > -1) {\n            return this.parent.getErrorStrings()[CommonErrors.name];\n        }\n        var startNum = 1;\n        var loc;\n        if (argsList.length === 3) {\n            startNum = this.parent.removeTics(this.parent.getValueFromArg(argsList[2]));\n            if (this.parent.getErrorStrings().indexOf(startNum) > -1) {\n                return startNum;\n            }\n            startNum = this.parent.parseFloat(startNum);\n            if (isNaN(startNum)) {\n                startNum = 1;\n            }\n        }\n        if (startNum <= 0 || startNum > withinText.length) {\n            return this.parent.getErrorStrings()[CommonErrors.value];\n        }\n        loc = withinText.indexOf(findText, startNum - 1);\n        if (loc < 0) {\n            return this.parent.getErrorStrings()[CommonErrors.value];\n        }\n        return (Number(loc) + Number(1)).toString();\n    };\n    /** @hidden */\n    BasicFormulas.prototype.ComputeINDEX = function () {\n        var range = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            range[_i] = arguments[_i];\n        }\n        var argArr = range;\n        var argCount = argArr.length;\n        if (isNullOrUndefined(range) || (argArr.length === 1 && argArr[0] === '')) {\n            return this.parent.formulaErrorStrings[FormulasErrorsStrings.wrong_number_arguments];\n        }\n        if (argCount > 3) {\n            return this.parent.getErrorStrings()[CommonErrors.ref];\n        }\n        var rangeValue = '';\n        var rangeArr = [];\n        if (argCount > 2) {\n            for (var i_2 = 0; i_2 < argCount; i_2++) {\n                if (this.parent.isCellReference(argArr[i_2]) && argArr[i_2].indexOf(':') < 0) {\n                    return this.parent.getErrorStrings()[CommonErrors.ref];\n                }\n                if (this.parent.isCellReference(argArr[i_2])) {\n                    rangeArr[i_2] = argArr[i_2];\n                }\n            }\n        }\n        rangeValue = argArr[0];\n        argArr[1] = argArr[1] === '' ? '1' : argArr[1];\n        argArr[1] = this.parent.getValueFromArg(argArr[1]);\n        if (this.parent.getErrorStrings().indexOf(argArr[1]) > -1) {\n            return argArr[1];\n        }\n        if (!isNullOrUndefined(argArr[2])) {\n            argArr[2] = argArr[2] === '' ? '1' : argArr[2];\n            argArr[2] = this.parent.getValueFromArg(argArr[2]);\n            if (this.parent.getErrorStrings().indexOf(argArr[2]) > -1) {\n                return argArr[2];\n            }\n            if (argArr[2] === '0') {\n                return this.parent.getErrorStrings()[CommonErrors.value];\n            }\n        }\n        var row = parseFloat(argArr[1]);\n        row = !isNaN(row) ? row : -1;\n        var col = parseFloat(argArr[2] ? argArr[2] : '1');\n        col = !isNaN(col) ? col : -1;\n        if (row === -1 || col === -1) {\n            return this.parent.getErrorStrings()[CommonErrors.value];\n        }\n        var i = argArr[0].indexOf(':');\n        var startRow = this.parent.rowIndex(rangeValue.substring(0, i));\n        var endRow = this.parent.rowIndex(rangeValue.substring(i + 1));\n        var startCol = this.parent.colIndex(rangeValue.substring(0, i));\n        var endCol = this.parent.colIndex(rangeValue.substring(i + 1));\n        if (row > endRow - startRow + 1 || col > endCol - startCol + 1) {\n            return this.parent.getErrorStrings()[CommonErrors.ref];\n        }\n        row = startRow + row - 1;\n        col = startCol + col - 1;\n        var cellRef = '' + this.parent.convertAlpha(col) + row;\n        var result = this.parent.getValueFromArg(cellRef);\n        if (result === '') {\n            return 0;\n        }\n        return result;\n    };\n    /** @hidden */\n    BasicFormulas.prototype.ComputeIFS = function () {\n        var range = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            range[_i] = arguments[_i];\n        }\n        var argArr = range;\n        if (isNullOrUndefined(range) || (argArr.length === 1 && argArr[0] === '')) {\n            return this.parent.formulaErrorStrings[FormulasErrorsStrings.wrong_number_arguments];\n        }\n        var condition = '';\n        var result = '';\n        for (var i = 0; i < argArr.length; i++) {\n            condition = this.parent.getValueFromArg(argArr[i]);\n            if (condition !== this.parent.trueValue && condition !== this.parent.falseValue) {\n                return this.parent.getErrorStrings()[CommonErrors.value];\n            }\n            if (condition === this.parent.trueValue) {\n                if (argArr[i + 1].indexOf(this.parent.arithMarker) > -1) {\n                    return this.parent.trueValue;\n                }\n                if (this.parent.isCellReference(argArr[i + 1].split(this.parent.tic).join(''))) {\n                    result = this.parent.getValueFromArg(argArr[i + 1]);\n                }\n                else {\n                    result = (argArr[i + 1].indexOf(this.parent.tic) > -1) ? argArr[i + 1].split(this.parent.tic).join('') :\n                        this.parent.getErrorStrings()[CommonErrors.name];\n                }\n                i = i + 1;\n                return result;\n            }\n            else if (condition === this.parent.falseValue) {\n                i = i + 1;\n            }\n        }\n        return this.parent.getErrorStrings()[CommonErrors.na];\n    };\n    /** @hidden */\n    BasicFormulas.prototype.ComputeCOUNTA = function () {\n        var args = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            args[_i] = arguments[_i];\n        }\n        if (isNullOrUndefined(args) || (args.length === 1 && args[0] === '')) {\n            return this.parent.formulaErrorStrings[FormulasErrorsStrings.wrong_number_arguments];\n        }\n        var argArr = args;\n        var cellColl;\n        var result = 0;\n        var cellValue;\n        for (var i = 0; i < argArr.length; i++) {\n            if (argArr[i].indexOf(':') > -1 && this.parent.isCellReference(argArr[i])) {\n                cellColl = this.parent.getCellCollection(argArr[i].split(this.parent.tic).join(''));\n                for (var j = 0; j < cellColl.length; j++) {\n                    cellValue = this.parent.getValueFromArg(cellColl[j]);\n                    if (cellValue.length > 0) {\n                        result++;\n                    }\n                }\n            }\n            else {\n                var cellValue_1 = this.parent.getValueFromArg(argArr[i].split(this.parent.tic).join(''));\n                if (cellValue_1.length > 0) {\n                    result++;\n                }\n            }\n        }\n        return result;\n    };\n    /** @hidden */\n    BasicFormulas.prototype.ComputeAVERAGEA = function () {\n        var args = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            args[_i] = arguments[_i];\n        }\n        if (isNullOrUndefined(args) || (args.length === 1 && args[0] === '')) {\n            return this.parent.formulaErrorStrings[FormulasErrorsStrings.wrong_number_arguments];\n        }\n        var argArrs = args;\n        var cellCol;\n        var result = 0;\n        var cellValue;\n        var length = 0;\n        var parseValue;\n        for (var k = 0; k < argArrs.length; k++) {\n            if (argArrs[k].indexOf(':') > -1 && this.parent.isCellReference(argArrs[k])) {\n                cellCol = this.parent.getCellCollection(argArrs[k].split(this.parent.tic).join(''));\n                for (var j = 0; j < cellCol.length; j++) {\n                    cellValue = this.parent.getValueFromArg(cellCol[j]);\n                    if (cellValue.toUpperCase() === this.parent.trueValue) {\n                        cellValue = '1';\n                    }\n                    else if (cellValue.toUpperCase() === this.parent.falseValue || cellValue === '') {\n                        cellValue = '0';\n                    }\n                    else if (this.parent.getErrorStrings().indexOf(cellValue) > -1) {\n                        return cellValue;\n                    }\n                    else if (cellValue.length > 0) {\n                        parseValue = parseFloat(cellValue);\n                        cellValue = !isNaN(parseValue) ? parseValue : 0;\n                        result = result + cellValue;\n                        length = length + 1;\n                    }\n                }\n                length = cellCol.length;\n            }\n            else {\n                if (argArrs[k] === this.parent.trueValue) {\n                    argArrs[k] = '1';\n                }\n                if (argArrs[k] === this.parent.falseValue || argArrs[k] === '') {\n                    argArrs[k] = '0';\n                }\n                cellValue = this.parent.getValueFromArg(argArrs[k].split(this.parent.tic).join(''));\n                if (this.parent.getErrorStrings().indexOf(cellValue) > -1) {\n                    return cellValue;\n                }\n                if (cellValue.length > 0) {\n                    parseValue = parseFloat(cellValue);\n                    cellValue = !isNaN(parseValue) ? parseValue : 0;\n                    result = result + cellValue;\n                    length = length + 1;\n                }\n            }\n            if (length === 0) {\n                return this.parent.getErrorStrings()[CommonErrors.divzero];\n            }\n        }\n        return result / length;\n    };\n    /** @hidden */\n    BasicFormulas.prototype.ComputeCOUNTIF = function () {\n        var args = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            args[_i] = arguments[_i];\n        }\n        var argArr = args;\n        if (isNullOrUndefined(args) || args[0] === '' || argArr.length < 2) {\n            return this.parent.formulaErrorStrings[FormulasErrorsStrings.wrong_number_arguments];\n        }\n        var cellColl;\n        var result = 0;\n        var cellValue;\n        var stack = [];\n        var op = 'equal';\n        var condition = argArr[1].split(this.parent.tic).join('');\n        if (condition.startsWith('<=')) {\n            op = 'lessEq';\n            condition = condition.substring(2);\n        }\n        else if (condition.startsWith('>=')) {\n            op = 'greaterEq';\n            condition = condition.substring(2);\n        }\n        else if (condition.startsWith('<>')) {\n            op = 'notEq';\n            condition = condition.substring(2);\n        }\n        else if (condition.startsWith('<')) {\n            op = 'less';\n            condition = condition.substring(1);\n        }\n        else if (condition.startsWith('>')) {\n            op = 'greater';\n            condition = condition.substring(1);\n        }\n        else if (condition.startsWith('=')) {\n            op = 'equal';\n            condition = condition.substring(1);\n        }\n        if (argArr[0].indexOf(':') > -1 && this.parent.isCellReference(argArr[0])) {\n            cellColl = this.parent.getCellCollection(argArr[0].split(this.parent.tic).join(''));\n            for (var j = 0; j < cellColl.length; j++) {\n                cellValue = this.parent.getValueFromArg(cellColl[j]);\n                if (condition.indexOf('*') > -1 || condition.indexOf('?') > -1) {\n                    cellValue = this.parent.findWildCardValue(condition, cellValue);\n                }\n                stack.push(cellValue);\n                stack.push(condition);\n                if (this.parent.processLogical(stack, op) === this.parent.trueValue) {\n                    result++;\n                }\n            }\n        }\n        return result;\n    };\n    /** @hidden */\n    BasicFormulas.prototype.ComputeSUMIFS = function () {\n        var range = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            range[_i] = arguments[_i];\n        }\n        var sum;\n        sum = this.parent.computeIfsFormulas(range, this.parent.falseValue);\n        return sum;\n    };\n    /** @hidden */\n    BasicFormulas.prototype.ComputeTEXT = function () {\n        var args = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            args[_i] = arguments[_i];\n        }\n        var checkArgs;\n        var argsLength = args.length;\n        for (var i = 0; i < argsLength; i++) {\n            if (isNullOrUndefined(checkArgs)) {\n                checkArgs = args[i];\n            }\n            else {\n                checkArgs = checkArgs + ',' + args[i];\n            }\n        }\n        var splitIndex = checkArgs.indexOf(',');\n        var frtArg = checkArgs.slice(0, splitIndex);\n        var scndArg = checkArgs.slice(checkArgs.indexOf('\"') + 1, checkArgs.length);\n        var checkScndArg = scndArg.indexOf('\"');\n        if (splitIndex > -1 && checkScndArg !== scndArg.length - 1) {\n            return this.parent.formulaErrorStrings[FormulasErrorsStrings.wrong_number_arguments];\n        }\n        var s1 = frtArg;\n        var s2 = scndArg.slice(0, scndArg.length - 1);\n        var dTime = new Date(1900, 0, 1, 0, 0, 0);\n        var checkString = s1 + ',' + s2;\n        var intl = new Internationalization();\n        if (this.parent.getErrorStrings().indexOf(checkString) > -1) {\n            return checkString;\n        }\n        s1 = this.parent.getValueFromArg(s1);\n        s2 = s2.split(this.parent.tic).join('');\n        if (s2 === '') {\n            return '';\n        }\n        if (s1 === '' && (s2.length > 0 && (s2.toUpperCase().indexOf('M') > -1 || s2.toUpperCase().indexOf('D') > -1\n            || s2.toUpperCase().indexOf('Y') > -1 || s2.toUpperCase().indexOf('S') > -1 || s2.toUpperCase().indexOf('T') > -1)\n            || s2.toUpperCase().indexOf('H') > -1)) {\n            s1 = dTime.toString();\n        }\n        var d = this.parseDouble(s1);\n        if (isNaN(d) && this.parent.isDate(new Date(s1)) !== null) {\n            d = this.parent.toOADate(new Date(s1));\n        }\n        dTime = Date.parse(s1.split(this.parent.tic).join(''));\n        if (!isNaN(d) || !isNaN(dTime)) {\n            if (s2[0] === '[') {\n                return this.parent.tic + s1 + this.parent.tic;\n            }\n            if (s2.length > 0 && (s2.toUpperCase().indexOf('M') > -1 || s2.toUpperCase().indexOf('D') > -1\n                || s2.toUpperCase().indexOf('Y') > -1 || s2.toUpperCase().indexOf('S') > -1 || s2.toUpperCase().indexOf('T') > -1)\n                || s2.toUpperCase().indexOf('H') > -1) {\n                s2 = s2.split('Y').join('y').split('D').join('d').split('H').join('h');\n                s2 = s2.split('S').join('s').split('m').join('M').split('AM/PM').join('tt');\n                var formatChar = s2.split('');\n                var isH = false;\n                var isMFound = false;\n                var isFirstM = false;\n                var i = 0;\n                var mcount = 0;\n                var lastCharIndex = 0;\n                var totalCharforM = 0;\n                for (i = 0; i < formatChar.length;) {\n                    var c = formatChar[i];\n                    if (c === 's' && formatChar[lastCharIndex] === 'M') {\n                        formatChar[lastCharIndex] = 'm';\n                        if (formatChar[lastCharIndex - 1] === 'M') {\n                            formatChar[lastCharIndex - 1] = 'm';\n                        }\n                    }\n                    if (this.parent.isChar(c)) {\n                        lastCharIndex = i;\n                        if (c === 'M') {\n                            mcount++;\n                            totalCharforM++;\n                        }\n                    }\n                    else if (totalCharforM > 1) {\n                        totalCharforM++;\n                    }\n                    if (c === 'M' && isH) {\n                        formatChar[i] = 'm';\n                        isMFound = true;\n                        isFirstM = (mcount === 1);\n                    }\n                    if (c === 'h') {\n                        isH = true;\n                    }\n                    else if (this.parent.isChar(c) && c !== 'M' && c !== 'h' && !isMFound) {\n                        isH = false;\n                        isMFound = false;\n                    }\n                    i++;\n                }\n                s2 = String(formatChar);\n                s2 = s2.split(',').join('').split('\\n').join(' ');\n                var dt = this.parent.fromOADate(d);\n                if (d === 0) {\n                    dt = dTime;\n                }\n                var getSkeleton = getSkeletonVal(s2);\n                if (getSkeleton === '') {\n                    return this.parent.getErrorStrings()[CommonErrors.name];\n                }\n                var dFormatter = intl.getDateFormat({ skeleton: getSkeleton, type: 'date' });\n                var formattedString = dFormatter(new Date(dt.toString()));\n                s1 = formattedString;\n            }\n            else {\n                s1 = intl.formatNumber(d, { format: s2 });\n            }\n        }\n        return s1;\n    };\n    /** @hidden */\n    BasicFormulas.prototype.ComputeCOUNTIFS = function () {\n        var args = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            args[_i] = arguments[_i];\n        }\n        var sum;\n        sum = this.parent.computeIfsFormulas(args, this.parent.trueValue);\n        return sum;\n    };\n    /** @hidden */\n    BasicFormulas.prototype.ComputeAVERAGEIFS = function () {\n        var args = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            args[_i] = arguments[_i];\n        }\n        var sum;\n        sum = this.parent.computeIfsFormulas(args, this.parent.falseValue, this.parent.trueValue);\n        return sum;\n    };\n    /** @hidden */\n    BasicFormulas.prototype.ComputeMATCH = function () {\n        var args = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            args[_i] = arguments[_i];\n        }\n        var argArr = args;\n        if (isNullOrUndefined(argArr) || (argArr.length === 1 && argArr[0] === '') || argArr.length < 2 || argArr.length > 3) {\n            return this.parent.formulaErrorStrings[FormulasErrorsStrings.wrong_number_arguments];\n        }\n        var cellColl;\n        var cellValue = [];\n        var lookupVal = argArr[0].split(this.parent.tic).join('');\n        argArr[2] = isNullOrUndefined(argArr[2]) ? '1' : argArr[2].split(this.parent.tic).join('');\n        if (argArr[2].split(this.parent.tic).join('') === this.parent.trueValue) {\n            argArr[2] = '1';\n        }\n        if (argArr[2].split(this.parent.tic).join('') === this.parent.falseValue) {\n            argArr[2] = '0';\n        }\n        var matchType = parseFloat(argArr[2]);\n        if (matchType !== -1 && matchType !== 0 && matchType !== 1) {\n            return this.parent.getErrorStrings()[CommonErrors.na];\n        }\n        var index = 0;\n        var indexVal = '';\n        if (argArr[1].indexOf(':') > -1 || this.parent.isCellReference(argArr[1])) {\n            cellColl = this.parent.getCellCollection(argArr[1].split(this.parent.tic).join(''));\n            for (var j = 0; j < cellColl.length; j++) {\n                cellValue[j] = this.parent.getValueFromArg(cellColl[j]).split(this.parent.tic).join('');\n            }\n            for (var i = 0; i < cellValue.length; i++) {\n                if (matchType === 1) {\n                    if (lookupVal === cellValue[i]) {\n                        return i + 1;\n                    }\n                    else if (lookupVal > cellValue[i]) {\n                        if (!indexVal) {\n                            index = i + 1;\n                            indexVal = cellValue[i];\n                        }\n                        else if (cellValue[i] > indexVal) {\n                            index = i + 1;\n                            indexVal = cellValue[i];\n                        }\n                    }\n                }\n                else if (matchType === 0) {\n                    if (lookupVal.indexOf('*') > -1 || lookupVal.indexOf('?') > -1) {\n                        cellValue[i] = this.parent.findWildCardValue(lookupVal, cellValue[i]);\n                    }\n                    if (lookupVal === cellValue[i]) {\n                        return i + 1;\n                    }\n                    if (this.parent.parseFloat(lookupVal) === this.parent.parseFloat(cellValue[i])) {\n                        return i + 1;\n                    }\n                }\n                else if (matchType === -1) {\n                    if (lookupVal === cellValue[i]) {\n                        return i + 1;\n                    }\n                    else if (lookupVal < cellValue[i]) {\n                        if (!indexVal) {\n                            index = i + 1;\n                            indexVal = cellValue[i];\n                        }\n                        else if (cellValue[i] < indexVal) {\n                            index = i + 1;\n                            indexVal = cellValue[i];\n                        }\n                    }\n                }\n            }\n        }\n        return index ? index : this.parent.getErrorStrings()[CommonErrors.na];\n    };\n    /** @hidden */\n    BasicFormulas.prototype.ComputeLOOKUP = function () {\n        var range = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            range[_i] = arguments[_i];\n        }\n        var argArr = range;\n        var result = '';\n        if (isNullOrUndefined(argArr) || (argArr.length === 1 && argArr[0] === '') || argArr.length < 2 || argArr.length > 3) {\n            return this.parent.formulaErrorStrings[FormulasErrorsStrings.wrong_number_arguments];\n        }\n        result = this.parent.computeLookup(argArr);\n        return result;\n    };\n    /** @hidden */\n    BasicFormulas.prototype.ComputeVLOOKUP = function () {\n        var range = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            range[_i] = arguments[_i];\n        }\n        var argArr = range;\n        var result = '';\n        if (isNullOrUndefined(argArr) || (argArr.length === 1 && argArr[0] === '') || argArr.length < 3 || argArr.length > 4) {\n            return this.parent.formulaErrorStrings[FormulasErrorsStrings.wrong_number_arguments];\n        }\n        result = this.parent.computeVLookup(argArr);\n        return result;\n    };\n    /** @hidden */\n    BasicFormulas.prototype.ComputeSUBTOTAL = function () {\n        var range = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            range[_i] = arguments[_i];\n        }\n        var argArr = range;\n        var result = '';\n        if (argArr.length < 2) {\n            return this.parent.formulaErrorStrings[FormulasErrorsStrings.wrong_number_arguments];\n        }\n        var formula = this.parent.parseFloat(this.parent.getValueFromArg(argArr[0].split(this.parent.tic).join('')));\n        if (isNaN(formula)) {\n            this.parent.getErrorStrings()[CommonErrors.value];\n        }\n        if ((formula < 1 || formula > 11) && (formula < 101 || formula > 111)) {\n            this.parent.getErrorStrings()[CommonErrors.value];\n        }\n        var cellRef = argArr.slice(1, argArr.length);\n        switch (formula) {\n            case 1:\n            case 101:\n                result = this.ComputeAVERAGE.apply(this, cellRef);\n                break;\n            case 2:\n            case 102:\n                result = this.ComputeCOUNT.apply(this, cellRef);\n                break;\n            case 3:\n            case 103:\n                result = this.ComputeCOUNTA.apply(this, cellRef);\n                break;\n            case 4:\n            case 104:\n                result = this.ComputeMAX.apply(this, cellRef);\n                break;\n            case 5:\n            case 105:\n                result = this.ComputeMIN.apply(this, cellRef);\n                break;\n            case 6:\n            case 106:\n                result = this.ComputePRODUCT.apply(this, cellRef);\n                break;\n            case 7:\n            case 107:\n                result = this.ComputeDAY.apply(this, cellRef);\n                break;\n            case 8:\n            case 108:\n                result = this.ComputeCONCAT.apply(this, cellRef);\n                break;\n            case 9:\n            case 109:\n                result = this.ComputeSUM.apply(this, cellRef);\n                break;\n            case 10:\n            case 110:\n                result = this.ComputeAVERAGEA.apply(this, cellRef);\n                break;\n            case 11:\n            case 111:\n                result = this.ComputeABS.apply(this, cellRef);\n                break;\n            default:\n                result = this.parent.getErrorStrings()[CommonErrors.value];\n                break;\n        }\n        return result;\n    };\n    /** @hidden */\n    BasicFormulas.prototype.ComputeRADIANS = function () {\n        var range = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            range[_i] = arguments[_i];\n        }\n        var argArr = range;\n        var result;\n        if (argArr[0] === '' || argArr.length > 1) {\n            return this.parent.formulaErrorStrings[FormulasErrorsStrings.wrong_number_arguments];\n        }\n        if (argArr[0].indexOf(':') > -1 || argArr[0].split(this.parent.tic).join('') === '') {\n            return this.parent.getErrorStrings()[CommonErrors.value];\n        }\n        var val = argArr[0].split(this.parent.tic).join('');\n        argArr[0] = isNaN(this.parent.parseFloat(val)) ? argArr[0] : val;\n        var cellvalue = this.parent.getValueFromArg(argArr[0]);\n        var radVal = this.parent.parseFloat(cellvalue);\n        if (!isNaN(radVal)) {\n            result = Math.PI * (radVal) / 180;\n        }\n        else {\n            if (cellvalue.indexOf(this.parent.tic) > -1) {\n                return this.parent.getErrorStrings()[CommonErrors.value];\n            }\n            else {\n                return this.parent.getErrorStrings()[CommonErrors.name];\n            }\n        }\n        return result;\n    };\n    /** @hidden */\n    BasicFormulas.prototype.ComputeRANDBETWEEN = function () {\n        var range = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            range[_i] = arguments[_i];\n        }\n        var argsLength = range.length;\n        var min;\n        var max;\n        var argVal;\n        if (argsLength !== 2) {\n            return this.parent.formulaErrorStrings[FormulasErrorsStrings.wrong_number_arguments];\n        }\n        for (var i = 0; i < argsLength; i++) {\n            if (range[i] === '') {\n                return this.parent.getErrorStrings()[CommonErrors.na];\n            }\n            if (range[i].indexOf(this.parent.tic) > -1) {\n                if (isNaN(parseFloat(range[i].split(this.parent.tic).join('')))) {\n                    return this.parent.getErrorStrings()[CommonErrors.value];\n                }\n                else {\n                    range[i] = range[i].split(this.parent.tic).join('');\n                }\n            }\n            argVal = parseFloat(this.parent.getValueFromArg(range[i]));\n            if (!this.parent.isCellReference(range[i])) {\n                if (isNaN(argVal)) {\n                    return this.parent.getErrorStrings()[CommonErrors.name];\n                }\n                i === 0 ? min = argVal : max = argVal;\n            }\n            else {\n                argVal = this.parent.getValueFromArg(range[i]) === '' ? 0 : argVal;\n                i === 0 ? min = argVal : max = argVal;\n                if (min === 0 && max === 0) {\n                    return '0';\n                }\n                if (isNaN(argVal)) {\n                    return this.parent.getErrorStrings()[CommonErrors.value];\n                }\n            }\n        }\n        if (max < min) {\n            return this.parent.getErrorStrings()[CommonErrors.num];\n        }\n        if (min === 0) {\n            return Math.floor(Math.random() * (max - (min - 1))) + min;\n        }\n        else {\n            return max - min === 1 ? Math.round((Math.random() * (max - min)) + min) : Math.floor(Math.random() * (max - (min - 1))) + min;\n        }\n    };\n    /** @hidden */\n    BasicFormulas.prototype.ComputeSLOPE = function () {\n        var range = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            range[_i] = arguments[_i];\n        }\n        var argArr = range;\n        if (argArr.length !== 2 || argArr[0] === '') {\n            return this.parent.formulaErrorStrings[FormulasErrorsStrings.wrong_number_arguments];\n        }\n        var yPoints;\n        var xPoints;\n        var xPointsRange = this.parent.getCellCollection(argArr[1].split(this.parent.tic).join(''));\n        var yPointsRange = this.parent.getCellCollection(argArr[0].split(this.parent.tic).join(''));\n        if (yPointsRange.length !== xPointsRange.length) {\n            return this.parent.getErrorStrings()[CommonErrors.na];\n        }\n        yPoints = this.getDataCollection(yPointsRange);\n        xPoints = this.getDataCollection(xPointsRange);\n        if (xPoints.indexOf('#NAME?') > -1 || yPoints.indexOf('#NAME?') > -1) {\n            return this.parent.getErrorStrings()[CommonErrors.name];\n        }\n        var sumXY = 0;\n        var sumX2 = 0;\n        var sumX = 0;\n        var sumY = 0;\n        for (var i = 0, len = xPoints.length; i < len; ++i) {\n            if (Number(xPoints[i]).toString() !== 'NaN' && Number(yPoints[i]).toString() !== 'NaN') {\n                sumXY += Number(xPoints[i]) * Number(yPoints[i]);\n                sumX += Number(xPoints[i]);\n                sumY += Number(yPoints[i]);\n                sumX2 += Number(xPoints[i]) * Number(xPoints[i]);\n            }\n        }\n        if ((sumXY - sumX * sumY) === 0 || (sumX2 - sumX * sumX) === 0) {\n            this.parent.getErrorStrings()[CommonErrors.divzero];\n        }\n        var result = ((sumXY - sumX * sumY / xPoints.length) / (sumX2 - sumX * sumX / xPoints.length)).toString();\n        if (result === 'NaN') {\n            return this.parent.getErrorStrings()[CommonErrors.divzero];\n        }\n        return result;\n    };\n    /** @hidden */\n    BasicFormulas.prototype.ComputeINTERCEPT = function () {\n        var range = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            range[_i] = arguments[_i];\n        }\n        var argArr = range;\n        if (argArr[0] === '' || argArr.length !== 2) {\n            return this.parent.formulaErrorStrings[FormulasErrorsStrings.wrong_number_arguments];\n        }\n        var xValues;\n        var yValues;\n        var yValuesRange = this.parent.getCellCollection(argArr[0].split(this.parent.tic).join(''));\n        var xValuesRange = this.parent.getCellCollection(argArr[1].split(this.parent.tic).join(''));\n        if (yValuesRange.length !== xValuesRange.length) {\n            return this.parent.getErrorStrings()[CommonErrors.na];\n        }\n        xValues = this.getDataCollection(xValuesRange);\n        yValues = this.getDataCollection(yValuesRange);\n        if (xValues.indexOf('#NAME?') > -1 || yValues.indexOf('#NAME?') > -1) {\n            return this.parent.getErrorStrings()[CommonErrors.name];\n        }\n        var sumX = 0;\n        var sumY = 0;\n        for (var i = 0, len = xValues.length; i < len; ++i) {\n            sumX += Number(xValues[i]);\n            sumY += Number(yValues[i]);\n        }\n        sumX = sumX / xValues.length;\n        sumY = sumY / xValues.length;\n        var sumXY = 0;\n        var sumX2 = 0;\n        var diff;\n        for (var i = 0, len = xValues.length; i < len; ++i) {\n            diff = Number(xValues[i]) - sumX;\n            sumXY += diff * (Number(yValues[i]) - sumY);\n            sumX2 += diff * diff;\n        }\n        var result = (sumY - sumXY / sumX2 * sumX).toString();\n        if ((sumY - sumXY) === 0 || (sumX2 * sumX) === 0) {\n            this.parent.getErrorStrings()[CommonErrors.divzero];\n        }\n        if (result === 'NaN') {\n            return this.parent.getErrorStrings()[CommonErrors.divzero];\n        }\n        return result;\n    };\n    /** @hidden */\n    BasicFormulas.prototype.ComputeLN = function () {\n        var logValue = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            logValue[_i] = arguments[_i];\n        }\n        var argArr = logValue;\n        var cellvalue = '';\n        var logVal;\n        var orgValue;\n        if (logValue.length === 0 || logValue.length > 1) {\n            return this.parent.formulaErrorStrings[FormulasErrorsStrings.wrong_number_arguments];\n        }\n        if (this.parent.isCellReference(argArr[0])) {\n            cellvalue = this.parent.getValueFromArg(argArr[0]);\n            logVal = this.parent.parseFloat(cellvalue);\n            if (logVal <= 0 || cellvalue === '') {\n                return this.parent.getErrorStrings()[CommonErrors.num];\n            }\n            if (isNaN(logVal)) {\n                return this.parent.getErrorStrings()[CommonErrors.value];\n            }\n        }\n        else {\n            orgValue = this.parent.getValueFromArg(argArr[0].split(this.parent.tic).join(''));\n            logVal = this.parent.parseFloat(orgValue);\n            if (logVal <= 0 || logVal.toString() === '') {\n                return this.parent.getErrorStrings()[CommonErrors.num];\n            }\n            if (isNaN(logVal)) {\n                return this.parent.getErrorStrings()[CommonErrors.value];\n            }\n        }\n        return Math.log(logVal);\n    };\n    /** @hidden */\n    BasicFormulas.prototype.ComputeISNUMBER = function () {\n        var logValue = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            logValue[_i] = arguments[_i];\n        }\n        var argArr = logValue;\n        var logVal;\n        var orgValue;\n        if (logValue.length === 0 || logValue.length > 1) {\n            return this.parent.formulaErrorStrings[FormulasErrorsStrings.wrong_number_arguments];\n        }\n        orgValue = (this.parent.isCellReference(argArr[0])) ? this.parent.getValueFromArg(argArr[0]) :\n            this.parent.getValueFromArg(argArr[0].split(this.parent.tic).join(''));\n        if (orgValue.toString() === '') {\n            return false;\n        }\n        logVal = this.parent.parseFloat(orgValue);\n        return !isNaN(logVal) ? true : false;\n    };\n    /** @hidden */\n    BasicFormulas.prototype.ComputeROUND = function () {\n        var logValue = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            logValue[_i] = arguments[_i];\n        }\n        var argArr = logValue;\n        var orgValue;\n        var x = 0;\n        var digits = 0;\n        var round;\n        var numStr;\n        var digStr;\n        var mult;\n        if (logValue.length === 0 || logValue.length > 2) {\n            return this.parent.formulaErrorStrings[FormulasErrorsStrings.wrong_number_arguments];\n        }\n        if (logValue.length === 1) {\n            orgValue = (argArr[0].split(this.parent.tic).join('') === 'TRUE')\n                ? '1'\n                : (argArr[0].split(this.parent.tic).join('') === 'FALSE')\n                    ? '0'\n                    : argArr[0];\n            return Math.round(this.parent.parseFloat(orgValue)).toString();\n        }\n        numStr = this.parent.getValueFromArg(argArr[0]);\n        digStr = (argArr[1].split(this.parent.tic).join('')) === '' ? '0' :\n            this.parent.getValueFromArg(argArr[1].split(this.parent.tic).join(''));\n        numStr = (numStr.split(this.parent.tic).join('') === 'TRUE')\n            ? '1'\n            : (numStr.split(this.parent.tic).join('') === 'FALSE')\n                ? '0' : numStr;\n        digStr = (digStr.split(this.parent.tic).join('') === 'TRUE') ? '1'\n            : (digStr.split(this.parent.tic).join('') === 'FALSE')\n                ? '0' : digStr;\n        if (numStr !== '' && digStr !== '') {\n            x = this.parent.parseFloat(numStr);\n            digits = this.parent.parseFloat(digStr);\n            if (!isNaN(digits) && !isNaN(x) && digits > 0) {\n                round = x.toFixed(digits);\n            }\n            else {\n                mult = Math.pow(10, -digits);\n                round = Math.round(x / mult) * mult;\n            }\n        }\n        return round.toString();\n    };\n    /** @hidden */\n    BasicFormulas.prototype.ComputePOWER = function () {\n        var logValue = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            logValue[_i] = arguments[_i];\n        }\n        var argArr = logValue;\n        var power;\n        var orgNumValue;\n        var orgPowValue;\n        var logNumValue;\n        var logPowValue;\n        if (logValue.length === 0 || logValue.length > 2) {\n            return this.parent.formulaErrorStrings[FormulasErrorsStrings.wrong_number_arguments];\n        }\n        orgNumValue = this.parent.getValueFromArg(argArr[0]);\n        orgPowValue = this.parent.getValueFromArg(argArr[1]);\n        orgNumValue = (orgNumValue.split(this.parent.tic).join('') === 'TRUE') ? '1' :\n            (orgNumValue.split(this.parent.tic).join('') === 'FALSE') ? '0' : orgNumValue;\n        orgPowValue = (orgPowValue.split(this.parent.tic).join('') === 'TRUE') ? '1' :\n            (orgPowValue.split(this.parent.tic).join('') === 'FALSE') ? '0' : orgPowValue;\n        logNumValue = this.parent.parseFloat(orgNumValue);\n        logPowValue = this.parent.parseFloat(orgPowValue);\n        if (!isNaN(logNumValue) && !isNaN(logPowValue)) {\n            if (logNumValue === 0 && logPowValue < 0) {\n                return this.parent.getErrorStrings()[CommonErrors.divzero];\n            }\n            if (logNumValue === 0 && logPowValue === 0) {\n                return this.parent.getErrorStrings()[CommonErrors.num];\n            }\n            power = Math.pow(logNumValue, logPowValue);\n        }\n        else {\n            return this.parent.getErrorStrings()[CommonErrors.value];\n        }\n        return power.toString();\n    };\n    /** @hidden */\n    BasicFormulas.prototype.ComputeLOG = function () {\n        var logValue = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            logValue[_i] = arguments[_i];\n        }\n        var argArr = logValue;\n        var orgNumValue;\n        var orgBaseValue;\n        var logNumValue;\n        var logBaseValue;\n        if (logValue.length === 0 || logValue.length > 2) {\n            return this.parent.formulaErrorStrings[FormulasErrorsStrings.wrong_number_arguments];\n        }\n        orgNumValue = this.parent.getValueFromArg(argArr[0]);\n        orgBaseValue = (logValue.length === 2) ? this.parent.getValueFromArg(argArr[1]) : '10';\n        if ((orgNumValue === '' || orgNumValue === null) || (orgBaseValue === '' || orgBaseValue === null)) {\n            return this.parent.getErrorStrings()[CommonErrors.num];\n        }\n        orgNumValue = (orgNumValue.split(this.parent.tic).join('') === 'TRUE') ? '1' :\n            (orgNumValue.split(this.parent.tic).join('') === 'FALSE') ? '0' : orgNumValue;\n        orgBaseValue = (orgBaseValue.split(this.parent.tic).join('') === 'TRUE') ? '1' :\n            (orgBaseValue.split(this.parent.tic).join('') === 'FALSE') ? '0' : orgBaseValue;\n        logNumValue = this.parent.parseFloat(orgNumValue);\n        logBaseValue = this.parent.parseFloat(orgBaseValue);\n        if (logNumValue <= 0 || logBaseValue <= 0) {\n            return this.parent.getErrorStrings()[CommonErrors.num];\n        }\n        if (logBaseValue === 1) {\n            return this.parent.getErrorStrings()[CommonErrors.divzero];\n        }\n        if (!isNaN(logNumValue) && !isNaN(logBaseValue)) {\n            return ((Math.log(logNumValue) / Math.LN10) / (Math.log(logBaseValue) / Math.LN10)).toString();\n        }\n        else {\n            return this.parent.getErrorStrings()[CommonErrors.value];\n        }\n    };\n    /** @hidden */\n    BasicFormulas.prototype.ComputeTRUNC = function () {\n        var logValue = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            logValue[_i] = arguments[_i];\n        }\n        var argArr = logValue;\n        var orgNumValue;\n        var orgDigitValue = 0;\n        var logNumValue;\n        var logDigitValue;\n        var normalizer;\n        if (logValue.length === 0 || logValue.length > 2) {\n            return this.parent.formulaErrorStrings[FormulasErrorsStrings.wrong_number_arguments];\n        }\n        if (logValue.length === 2) {\n            orgDigitValue = this.parent.getValueFromArg(argArr[1]);\n            orgDigitValue = (orgDigitValue.split(this.parent.tic).join('') === 'TRUE') ? '1' :\n                (orgDigitValue.split(this.parent.tic).join('') === 'FALSE') ? '0' : orgDigitValue;\n            orgDigitValue = this.parent.parseFloat(orgDigitValue);\n        }\n        orgNumValue = this.parent.getValueFromArg(argArr[0]);\n        orgNumValue = (orgNumValue.split(this.parent.tic).join('') === 'TRUE') ? '1' :\n            (orgNumValue.split(this.parent.tic).join('') === 'FALSE') ? '0' : orgNumValue;\n        logNumValue = this.parent.parseFloat(orgNumValue.split(this.parent.tic).join(''));\n        if (isNaN(logNumValue) || isNaN(orgDigitValue)) {\n            return (argArr[0] === this.parent.tic || this.parent.isCellReference(argArr[0]) || (argArr[1] === this.parent.tic\n                || this.parent.isCellReference(argArr[1]))) ? this.parent.getErrorStrings()[CommonErrors.value]\n                : this.parent.getErrorStrings()[CommonErrors.name];\n        }\n        normalizer = Math.pow(10, orgDigitValue);\n        logDigitValue = (logNumValue < 0) ? -1 : 1;\n        return (logDigitValue * Math.floor(normalizer * Math.abs(logNumValue)) / normalizer).toString();\n    };\n    /** @hidden */\n    BasicFormulas.prototype.ComputeEXP = function () {\n        var logValue = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            logValue[_i] = arguments[_i];\n        }\n        var argArr = logValue;\n        var orgNumValue;\n        var logNumValue;\n        if (logValue.length === 0 || logValue.length > 1) {\n            return this.parent.formulaErrorStrings[FormulasErrorsStrings.wrong_number_arguments];\n        }\n        orgNumValue = this.parent.getValueFromArg(argArr[0]);\n        orgNumValue = (orgNumValue.split(this.parent.tic).join('') === 'TRUE') ? '1' :\n            (orgNumValue.split(this.parent.tic).join('') === 'FALSE') ? '0' : orgNumValue;\n        if (orgNumValue === '') {\n            orgNumValue = '0';\n        }\n        logNumValue = this.parent.parseFloat(orgNumValue);\n        if (logNumValue > 709) {\n            return this.parent.getErrorStrings()[CommonErrors.num];\n        }\n        if (isNaN(logNumValue)) {\n            return (argArr[0] === this.parent.tic || this.parent.isCellReference(argArr[0])) ?\n                this.parent.getErrorStrings()[CommonErrors.value]\n                : this.parent.getErrorStrings()[CommonErrors.name];\n        }\n        return Math.exp(logNumValue).toString();\n    };\n    /** @hidden */\n    BasicFormulas.prototype.ComputeGEOMEAN = function () {\n        var logValue = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            logValue[_i] = arguments[_i];\n        }\n        var argArr = logValue;\n        var sum = 1;\n        var count = 0;\n        var cellVal = 0;\n        var dev;\n        var r;\n        var s;\n        var cell;\n        if (logValue.length === 0) {\n            return this.parent.formulaErrorStrings[FormulasErrorsStrings.wrong_number_arguments];\n        }\n        for (r = 0; r < argArr.length; r++) {\n            if (argArr[r].indexOf(':') > -1) {\n                if (argArr[0] === this.parent.tic) {\n                    return this.parent.getErrorStrings()[CommonErrors.value];\n                }\n                cell = this.parent.getCellCollection(argArr[r].split(this.parent.tic).join(''));\n                for (s = 0; s < cell.length; s++) {\n                    cellVal = this.parent.getValueFromArg(cell[s]);\n                    cellVal = (cellVal.split(this.parent.tic).join('') === 'TRUE') ? '1' :\n                        (cellVal.split(this.parent.tic).join('') === 'FALSE') ? '0' : cellVal;\n                    dev = this.parent.parseFloat(cellVal);\n                    if (dev <= 0) {\n                        return this.parent.getErrorStrings()[CommonErrors.num];\n                    }\n                    else if (!isNaN(dev)) {\n                        count++;\n                        sum = sum * dev;\n                    }\n                }\n            }\n            else {\n                cellVal = this.parent.getValueFromArg(argArr[r]);\n                if (cellVal.length > 0) {\n                    cellVal = (cellVal.split(this.parent.tic).join('') === 'TRUE') ? '1' :\n                        (cellVal.split(this.parent.tic).join('') === 'FALSE') ? '0' : cellVal;\n                    if (!this.parent.isCellReference(argArr[r])) {\n                        if (isNaN(this.parent.parseFloat(cellVal))) {\n                            return this.parent.getErrorStrings()[CommonErrors.name];\n                        }\n                    }\n                    dev = this.parent.parseFloat(cellVal);\n                    if (dev <= 0) {\n                        return this.parent.getErrorStrings()[CommonErrors.num];\n                    }\n                    else if (!isNaN(dev)) {\n                        count++;\n                        sum = sum * dev;\n                    }\n                }\n            }\n        }\n        if (count > 0) {\n            sum = Math.pow(sum, 1 / count);\n        }\n        return sum.toString();\n    };\n    BasicFormulas.prototype.getDataCollection = function (cells) {\n        var cellsData = [];\n        for (var i = 0, len = cells.length; i < len; i++) {\n            cellsData.push(this.parent.getValueFromArg(cells[i]));\n        }\n        return cellsData;\n    };\n    /** @hidden */\n    BasicFormulas.prototype.parseDouble = function (value) {\n        var val = this.parent.parseFloat(value.toString());\n        return !isNaN(val) ? val : NaN;\n    };\n    ;\n    BasicFormulas.prototype.getModuleName = function () {\n        return 'basic-formulas';\n    };\n    return BasicFormulas;\n}());\nexport { BasicFormulas };\n","import { FormulaError } from './index';\nimport { CommonErrors, FormulasErrorsStrings } from '../common/index';\nimport { isNullOrUndefined } from '@syncfusion/ej2-base';\nvar Parser = /** @class */ (function () {\n    function Parser(parent) {\n        this.emptyStr = '';\n        this.storedStringText = this.emptyStr;\n        this.sheetToken = '!';\n        /** @hidden */\n        this.tokenAdd = 'a';\n        /** @hidden */\n        this.tokenSubtract = 's';\n        /** @hidden */\n        this.tokenMultiply = 'm';\n        /** @hidden */\n        this.tokenDivide = 'd';\n        /** @hidden */\n        this.tokenLess = 'l';\n        this.charEm = 'r';\n        this.charEp = 'x';\n        /** @hidden */\n        this.tokenGreater = 'g';\n        /** @hidden */\n        this.tokenEqual = 'e';\n        /** @hidden */\n        this.tokenLessEq = 'k';\n        /** @hidden */\n        this.tokenGreaterEq = 'j';\n        /** @hidden */\n        this.tokenNotEqual = 'o';\n        /** @hidden */\n        this.tokenAnd = 'c';\n        this.tokenEm = 'v';\n        this.tokenEp = 't';\n        /** @hidden */\n        this.tokenOr = String.fromCharCode(126);\n        this.charAnd = 'i';\n        this.charLess = '<';\n        this.charGreater = '>';\n        this.charEqual = '=';\n        this.charLessEq = 'f';\n        this.charGreaterEq = 'h';\n        this.charNoEqual = 'z';\n        this.stringGreaterEq = '>=';\n        this.stringLessEq = '<=';\n        this.stringNoEqual = '<>';\n        this.stringAnd = '&';\n        this.stringOr = '^';\n        this.charOr = 'w';\n        this.charAdd = '+';\n        this.charSubtract = '-';\n        this.charMultiply = '*';\n        this.charDivide = '/';\n        this.fixedReference = '$';\n        this.spaceString = ' ';\n        this.ignoreBracet = false;\n        /** @hidden */\n        this.isError = false;\n        /** @hidden */\n        this.isFormulaParsed = false;\n        this.findNamedRange = false;\n        this.stringsColl = new Map();\n        this.tokens = [\n            this.tokenAdd, this.tokenSubtract, this.tokenMultiply, this.tokenDivide, this.tokenLess,\n            this.tokenGreater, this.tokenEqual, this.tokenLessEq, this.tokenGreaterEq, this.tokenNotEqual, this.tokenAnd, this.tokenOr\n        ];\n        this.charNOTop = String.fromCharCode(167);\n        this.specialSym = ['~', '@', '#', '?'];\n        this.isFailureTriggered = false;\n        this.parent = parent;\n    }\n    /** @hidden */\n    Parser.prototype.parse = function (text, fkey) {\n        if (this.parent.isTextEmpty(text)) {\n            return text;\n        }\n        if (this.parent.getFormulaCharacter() !== String.fromCharCode(0) && this.parent.getFormulaCharacter() === text[0]) {\n            text = text.substring(1);\n        }\n        if (this.parent.namedRanges.size > 0 || this.parent.storedData.size > 0) {\n            text = this.checkForNamedRangeAndKeyValue(text);\n            this.findNamedRange = false;\n        }\n        text = text.split('-+').join('-');\n        text = text.split('--').join('+');\n        text = text.split('+-').join('-');\n        text = text.split('-' + '(' + '-').join('(');\n        var formulaString = this.storeStrings(text);\n        text = this.storedStringText;\n        var i = 0;\n        if (isNullOrUndefined(formulaString)) {\n            text = text.split(' ').join('');\n        }\n        text = text.split('=>').join('>=');\n        text = text.split('=<').join('<=');\n        if (text[text.length - 1] !== this.parent.arithMarker || this.indexOfAny(text, this.tokens) !== (text.length - 2)) {\n            text = text.toUpperCase();\n        }\n        if (text.indexOf(this.sheetToken) > -1) {\n            var family = this.parent.getSheetFamilyItem(this.parent.grid);\n            if (family.sheetNameToParentObject != null && family.sheetNameToParentObject.size > 0) {\n                if (text[0] !== this.sheetToken.toString()) {\n                    text = this.parent.setTokensForSheets(text);\n                }\n                var sheetToken = this.parent.getSheetToken(text.split(this.parent.tic).join(this.emptyStr));\n                var scopedRange = this.checkScopedRange(text.split('\"').join(this.emptyStr).split(this.sheetToken).join(''));\n                if (isNullOrUndefined(sheetToken) && sheetToken !== '' && this.parent.namedRanges.size > 0 && scopedRange !== '') {\n                    text = scopedRange;\n                }\n            }\n        }\n        text = this.markLibraryFormulas(text);\n        try {\n            text = this.formulaAutoCorrection(text);\n        }\n        catch (ex) {\n            var args = {\n                message: ex.message, exception: ex, isForceCalculable: ex.formulaCorrection,\n                computeForceCalculate: false\n            };\n            if (!args.isForceCalculable) {\n                throw this.parent.formulaErrorStrings[FormulasErrorsStrings.invalid_expression];\n            }\n            if (!this.isFailureTriggered) {\n                this.parent.trigger('onFailure', args);\n                this.isFailureTriggered = true;\n            }\n            if (args.isForceCalculable && args.computeForceCalculate) {\n                text = this.formulaAutoCorrection(text, args);\n                this.parent.storedData.get(fkey).formulaText = '=' + text;\n            }\n            else {\n                throw this.parent.formulaErrorStrings[FormulasErrorsStrings.invalid_expression];\n            }\n        }\n        if (!this.ignoreBracet) {\n            i = text.indexOf(')');\n            while (i > -1) {\n                var k = text.substring(0, i).lastIndexOf('(');\n                if (k === -1) {\n                    throw new FormulaError(this.parent.formulaErrorStrings[FormulasErrorsStrings.mismatched_parentheses]);\n                }\n                if (k === i - 1) {\n                    throw new FormulaError(this.parent.formulaErrorStrings[FormulasErrorsStrings.empty_expression]);\n                }\n                var s = this.emptyStr;\n                if (this.ignoreBracet) {\n                    s = this.parent.substring(text, k, i - k + 1);\n                }\n                else {\n                    s = this.parent.substring(text, k + 1, i - k - 1);\n                }\n                try {\n                    text = text.substring(0, k) + this.parseSimple(s) + text.substring(i + 1);\n                }\n                catch (ex) {\n                    var args = this.exceptionArgs(ex);\n                    if (!this.isFailureTriggered) {\n                        this.parent.trigger('onFailure', args);\n                        this.isFailureTriggered = true;\n                    }\n                    var errorMessage = (typeof args.exception === 'string') ? args.exception : args.message;\n                    return (this.parent.getErrorLine(ex) ? '' : '#' + this.parent.getErrorLine(ex) + ': ') + errorMessage;\n                }\n                i = text.indexOf(')');\n            }\n        }\n        if (!this.ignoreBracet && text.indexOf('(') > -1) {\n            throw new FormulaError(this.parent.formulaErrorStrings[FormulasErrorsStrings.mismatched_parentheses]);\n        }\n        text = this.parseSimple(text);\n        if (formulaString !== null && formulaString.size > 0) {\n            text = this.setStrings(text, formulaString);\n        }\n        return text;\n    };\n    /* tslint:disable-next-line:no-any */\n    Parser.prototype.exceptionArgs = function (ex) {\n        return {\n            message: ex.message, exception: ex, isForceCalculable: ex.formulaCorrection,\n            computeForceCalculate: false\n        };\n    };\n    Parser.prototype.formulaAutoCorrection = function (formula, args) {\n        var arithemeticArr = ['*', '+', '-', '/', '^', '&'];\n        var logicalSym = ['>', '=', '<'];\n        var i = 0;\n        var form = '';\n        var op = '';\n        var firstOp = '';\n        var secondprevOp = '';\n        var secondnextOp = '';\n        var firstDigit = '';\n        var secondDigit = '';\n        var countDigit = 0;\n        if (this.parent.formulaErrorStrings.indexOf(formula) > -1) {\n            return formula;\n        }\n        else {\n            if (this.indexOfAny(formula, this.specialSym) > -1) {\n                throw new FormulaError(this.parent.formulaErrorStrings[FormulasErrorsStrings.invalid_expression], false);\n            }\n            while (i < formula.length) {\n                formula = formula.split('-*').join('-').split('/*').join('/').split('*/').join('*').split('-/').join('-').\n                    split('*+').join('*').split('+*').join('+');\n                if (formula.indexOf('*-') > -1 || formula.indexOf('/-') > -1) {\n                    formula = '-' + formula.split('*-').join('*').split('/-').join('/');\n                }\n                if ((this.parent.isDigit(formula[i]) && ((formula.length > i + 1)\n                    && (this.indexOfAny(formula[i + 1], arithemeticArr) > -1)) && ((formula.length > i + 2)\n                    && (!isNullOrUndefined(formula[i + 2]) && this.indexOfAny(formula[i + 2], arithemeticArr) > -1)))) {\n                    if (isNullOrUndefined(args)) {\n                        throw new FormulaError(this.parent.formulaErrorStrings[FormulasErrorsStrings.invalid_expression], true);\n                    }\n                    if (args.computeForceCalculate) {\n                        if (this.parent.isDigit(formula[i])) {\n                            if (countDigit < 1) {\n                                firstDigit = formula[i];\n                                firstOp = formula[i + 1];\n                                if (isNullOrUndefined(firstOp)) {\n                                    firstOp = this.emptyStr;\n                                }\n                                firstOp = firstOp === '&' ? '' : firstOp;\n                                countDigit = countDigit + 1;\n                                form = form + firstDigit + firstOp;\n                            }\n                            else if (countDigit < 2) {\n                                secondDigit = formula[i];\n                                secondprevOp = formula[i - 1];\n                                secondnextOp = formula[i + 1];\n                                countDigit = 0;\n                                if (secondprevOp === '-') {\n                                    secondnextOp = isNullOrUndefined(secondnextOp) ? this.emptyStr : secondnextOp;\n                                    secondnextOp = secondnextOp === '&' ? '' : secondnextOp;\n                                    form = form + secondprevOp + secondDigit + secondnextOp;\n                                }\n                                else {\n                                    secondnextOp = isNullOrUndefined(secondnextOp) ? this.emptyStr : secondnextOp;\n                                    form = form + secondDigit + secondnextOp;\n                                }\n                            }\n                            i = i + 2;\n                        }\n                        else {\n                            form = (formula[i] === '-') ? form + formula[i] : form;\n                            i = i + 1;\n                        }\n                    }\n                    else {\n                        throw this.parent.formulaErrorStrings[FormulasErrorsStrings.improper_formula];\n                    }\n                    /* tslint:disable-next-line */\n                }\n                else if ((this.parent.isDigit(formula[i]) || formula[i] === this.parent.rightBracket || this.parent.storedData.has(formula[i].toUpperCase())) && (isNullOrUndefined(formula[i + 1]) || this.indexOfAny(formula[i + 1], arithemeticArr)) > -1) {\n                    op = isNullOrUndefined(formula[i + 1]) ? this.emptyStr : formula[i + 1];\n                    op = op === '&' ? '' : op;\n                    form = formula[i - 1] === '-' ? form + formula[i - 1] + formula[i] + op : form + formula[i] + op;\n                    i = i + 2;\n                    /* tslint:disable-next-line */\n                }\n                else if (this.indexOfAny(formula[i], logicalSym) > -1 && !isNullOrUndefined(formula[i - 1]) && !isNullOrUndefined(formula[i + 1])) {\n                    form = form + formula[i];\n                    i = i + 1;\n                }\n                else if (formula[i] === 'q') {\n                    while (formula[i] !== this.parent.leftBracket) {\n                        form = form + formula[i];\n                        i = i + 1;\n                    }\n                    /* tslint:disable-next-line */\n                }\n                else if (formula[i] === this.parent.leftBracket || formula[i] === this.parent.rightBracket || formula[i] === '{' || formula[i] === '}' || formula[i] === '(' || formula[i] === ')') {\n                    form = form + formula[i];\n                    i = i + 1;\n                    /* tslint:disable-next-line */\n                }\n                else if (this.parent.isUpperChar(formula[i]) || formula[i].indexOf(':') > -1 || formula[i] === this.parent.getParseArgumentSeparator() || ((formula[i] === '%') && (this.parent.isDigit(formula[i - 1])))) {\n                    form = form + formula[i];\n                    i = i + 1;\n                }\n                else if (formula[i] === this.parent.tic || formula[i] === ' ' || formula[i] === '.' || formula[i] === this.sheetToken ||\n                    formula[i] === '$') {\n                    form = form + formula[i];\n                    i = i + 1;\n                }\n                else {\n                    if (this.parent.isDigit(formula[i])) {\n                        form = formula[i - 1] === '-' ? form + formula[i - 1] + formula[i] : form + formula[i];\n                    }\n                    if (formula[i] === '-' || formula[i] === '+') {\n                        form = form + formula[i];\n                        form = form.split('++').join('+').split('+-').join('-').split('-+').join('-');\n                    }\n                    if (formula[i] === '/' || formula[i] === '*') {\n                        form = form + formula[i];\n                    }\n                    i = i + 1;\n                }\n            }\n        }\n        form = form === this.emptyStr ? formula : form;\n        if (this.indexOfAny(form[form.length - 1], arithemeticArr) > -1) {\n            form = form.substring(0, form.length - 1);\n        }\n        form = form.split('--').join('-').split('-+').join('-').split('+-').join('-');\n        return form;\n    };\n    Parser.prototype.checkScopedRange = function (text) {\n        var _this = this;\n        var scopedRange = this.emptyStr;\n        var b = 'NaN';\n        var id = this.parent.getSheetID(this.parent.grid);\n        var sheet = this.parent.getSheetFamilyItem(this.parent.grid);\n        if (text[0] === this.sheetToken.toString()) {\n            var i = text.indexOf(this.sheetToken, 1);\n            var v = parseInt(text.substr(1, i - 1), 10);\n            if (i > 1 && !this.parent.isNaN(v)) {\n                text = text.substring(i + 1);\n                id = v;\n            }\n        }\n        var token = '!' + id.toString() + '!';\n        if (sheet === null || sheet.sheetNameToToken == null) {\n            return b;\n        }\n        sheet.sheetNameToToken.forEach(function (value, key) {\n            if (sheet.sheetNameToToken.get(key).toString() === token) {\n                var s_1 = _this.emptyStr;\n                _this.parent.namedRanges.forEach(function (value, key) {\n                    /* tslint:disable-next-line:no-any */\n                    if (!isNullOrUndefined(_this.parent.parentObject)) {\n                        /* tslint:disable-next-line:no-any */\n                        s_1 = (_this.parent.parentObject.getActiveSheet().name + _this.sheetToken + text).toUpperCase();\n                    }\n                    else {\n                        s_1 = sheet.sheetNameToToken.get(key).toUpperCase();\n                    }\n                    if (_this.parent.getNamedRanges().has(s_1)) {\n                        scopedRange = (_this.parent.getNamedRanges().get(s_1)).toUpperCase();\n                        b = scopedRange;\n                    }\n                });\n            }\n        });\n        return b;\n    };\n    Parser.prototype.storeStrings = function (tempString) {\n        var i = 0;\n        var j = 0;\n        var id = 0;\n        var key = '';\n        var storedString = null;\n        var condition;\n        var ticLoc = tempString.indexOf(this.parent.tic);\n        if (ticLoc > -1) {\n            i = tempString.indexOf(this.parent.tic);\n            while (i > -1 && tempString.length > 0) {\n                if (storedString === null) {\n                    storedString = this.stringsColl;\n                }\n                j = i + 1 < tempString.length ? tempString.indexOf(this.parent.tic, i + 1) : -1;\n                if (j === -1) {\n                    throw new FormulaError(this.parent.formulaErrorStrings[FormulasErrorsStrings.mismatched_tics]);\n                }\n                condition = this.parent.substring(tempString, i, j - i + 1);\n                key = this.parent.tic + this.spaceString + id.toString() + this.parent.tic;\n                storedString = storedString.set(key, condition);\n                tempString = tempString.substring(0, i) + key + tempString.substring(j + 1);\n                i = i + key.length;\n                if (i < tempString.length) {\n                    i = tempString.indexOf(this.parent.tic, i);\n                }\n                id++;\n            }\n        }\n        this.storedStringText = tempString;\n        return storedString;\n    };\n    Parser.prototype.setStrings = function (text, formulaString) {\n        for (var i = 0; i < formulaString.size; i++) {\n            formulaString.forEach(function (value, key) {\n                text = text.split(key).join(value);\n            });\n        }\n        return text;\n    };\n    /** @hidden */\n    Parser.prototype.parseSimple = function (formulaText) {\n        var needToContinue = true;\n        var text = formulaText;\n        if (text.length > 0 && text[0] === '+') {\n            text = text.substring(1);\n        }\n        if (text === '#DIV/0!') {\n            return '#DIV/0!';\n        }\n        if (text === '#NAME?') {\n            return '#NAME?';\n        }\n        if (text === '') {\n            return text;\n        }\n        if (this.parent.formulaErrorStrings.indexOf(text) > -1) {\n            return text;\n        }\n        text = text.split(this.stringLessEq).join(this.charLessEq);\n        text = text.split(this.stringGreaterEq).join(this.charGreaterEq);\n        text = text.split(this.stringNoEqual).join(this.charNoEqual);\n        text = text.split(this.stringAnd).join(this.charAnd);\n        text = text.split(this.stringOr).join(this.charOr);\n        text = text.split(this.fixedReference).join(this.emptyStr);\n        needToContinue = true;\n        var expTokenArray = [this.tokenEp, this.tokenEm];\n        var mulTokenArray = [this.tokenMultiply, this.tokenDivide];\n        var addTokenArray = [this.tokenAdd, this.tokenSubtract];\n        var mulCharArray = [this.charMultiply, this.charDivide];\n        var addCharArray = [this.charAdd, this.charSubtract];\n        var compareTokenArray = [this.tokenLess, this.tokenGreater, this.tokenEqual, this.tokenLessEq,\n            this.tokenGreaterEq, this.tokenNotEqual];\n        var compareCharArray = [this.charLess, this.charGreater, this.charEqual, this.charLessEq,\n            this.charGreaterEq, this.charNoEqual];\n        var expCharArray = [this.charEp, this.charEm];\n        var andTokenArray = [this.tokenAnd];\n        var andCharArray = [this.charAnd];\n        var orCharArray = [this.charOr];\n        var orTokenArray = [this.tokenOr];\n        text = this.parseSimpleOperators(text, expTokenArray, expCharArray);\n        text = this.parseSimpleOperators(text, orTokenArray, orCharArray);\n        if (needToContinue) {\n            text = this.parseSimpleOperators(text, mulTokenArray, mulCharArray);\n        }\n        if (needToContinue) {\n            text = this.parseSimpleOperators(text, addTokenArray, addCharArray);\n        }\n        if (needToContinue) {\n            text = this.parseSimpleOperators(text, compareTokenArray, compareCharArray);\n        }\n        if (needToContinue) {\n            text = this.parseSimpleOperators(text, andTokenArray, andCharArray);\n        }\n        return text;\n    };\n    /** @hidden */\n    // tslint:disable-next-line:max-func-body-length\n    Parser.prototype.parseSimpleOperators = function (formulaText, markers, operators) {\n        if (this.parent.getErrorStrings().indexOf(formulaText) > -1) {\n            return formulaText;\n        }\n        var text = formulaText;\n        var i = 0;\n        var op = '';\n        for (var c = 0; c < operators.length; c++) {\n            op = op + operators[c];\n        }\n        /* tslint:disable */\n        text = text.split(\"---\").join(\"-\").split(\"--\").join(\"+\").split(this.parent.getParseArgumentSeparator() + \"-\").join(this.parent.getParseArgumentSeparator() + \"u\").split(this.parent.leftBracket + \"-\").join(this.parent.leftBracket + \"u\").split(\"=-\").join(\"=u\");\n        text = text.split(',+').join(',').split(this.parent.leftBracket + '+').join(this.parent.leftBracket).split('=+').join('=').split('>+').join('>').split('<+').join('<').split('/+').join('/').split('*+').join('*').split('++').join('+').split(\"*-\").join(\"*u\").toString();\n        ;\n        /* tslint:enable */\n        if (text.length > 0 && text[0] === '-') {\n            text = text.substring(1).split('-').join(this.tokenOr);\n            text = '0-' + text;\n            text = this.parseSimpleOperators(text, [this.tokenSubtract], [this.charSubtract]);\n            text = text.split(this.tokenOr).join('-');\n        }\n        else if (text.length > 0 && text[0] === '+') {\n            text = text.substring(1);\n        }\n        else if (text.length > 0 && text[text.length - 1] === '+') {\n            text = text.substring(0, text.length - 1);\n        }\n        try {\n            if (this.indexOfAny(text, operators) > -1) {\n                i = this.indexOfAny(text, operators);\n                while (i > -1) {\n                    var left = '';\n                    var right = '';\n                    var leftIndex = 0;\n                    var rightIndex = 0;\n                    var isNotOperator = text[i] === this.charNOTop;\n                    var j = 0;\n                    if (!isNotOperator) {\n                        j = i - 1;\n                        if (text[j] === this.parent.arithMarker) {\n                            var k = this.findLeftMarker(text.substring(0, j - 1));\n                            if (k < 0) {\n                                throw new FormulaError(this.parent.formulaErrorStrings[FormulasErrorsStrings.cannot_parse]);\n                            }\n                            left = this.parent.substring(text, k + 1, j - k - 1);\n                            leftIndex = k + 1;\n                        }\n                        else if (text[j] === this.parent.rightBracket) {\n                            var bracketCount = 0;\n                            var k = j - 1;\n                            while (k > 0 && (text[k] !== 'q' || bracketCount !== 0)) {\n                                if (text[k] === 'q') {\n                                    bracketCount--;\n                                }\n                                else if (text[k] === this.parent.rightBracket) {\n                                    bracketCount++;\n                                }\n                                k--;\n                            }\n                            if (k < 0) {\n                                throw new FormulaError(this.parent.formulaErrorStrings[FormulasErrorsStrings.cannot_parse]);\n                            }\n                            left = this.parent.substring(text, k, j - k + 1);\n                            leftIndex = k;\n                        }\n                        else if (text[j] === this.parent.tic[0]) {\n                            var l = text.substring(0, j - 1).lastIndexOf(this.parent.tic);\n                            if (l < 0) {\n                                throw new FormulaError(this.parent.formulaErrorStrings[FormulasErrorsStrings.cannot_parse]);\n                            }\n                            left = this.parent.substring(text, l, j - l + 1);\n                            leftIndex = l;\n                        }\n                        else {\n                            var period = false;\n                            while (j > -1 && (this.parent.isDigit(text[j]) ||\n                                (!period && text[j] === this.parent.getParseDecimalSeparator()))) {\n                                if (text[j] === this.parent.getParseDecimalSeparator()) {\n                                    period = true;\n                                }\n                                j = j - 1;\n                            }\n                            if (j > -1 && period && text[j] === this.parent.getParseDecimalSeparator()) {\n                                /* tslint:disable-next-line */\n                                throw new FormulaError(this.parent.formulaErrorStrings[FormulasErrorsStrings.number_contains_2_decimal_points]);\n                            }\n                            j = j + 1;\n                            if (j === 0 || (j > 0 && !this.parent.isUpperChar(text[j - 1]))) {\n                                left = 'n' + this.parent.substring(text, j, i - j);\n                                leftIndex = j;\n                            }\n                            else {\n                                j = j - 1;\n                                while (j > -1 && (this.parent.isUpperChar(text[j]) || this.parent.isDigit(text[j]))) {\n                                    j = j - 1;\n                                }\n                                if (j > -1 && text[j] === this.sheetToken) {\n                                    j = j - 1;\n                                    while (j > -1 && text[j] !== this.sheetToken) {\n                                        j = j - 1;\n                                    }\n                                    if (j > -1 && text[j] === this.sheetToken) {\n                                        j = j - 1;\n                                    }\n                                }\n                                if (j > -1 && text[j] === ':') {\n                                    //// handle range operands\n                                    j = j - 1;\n                                    while (j > -1 && this.parent.isDigit(text[j])) {\n                                        j = j - 1;\n                                    }\n                                    while (j > -1 && this.parent.isUpperChar(text[j])) {\n                                        j = j - 1;\n                                    }\n                                    if (j > -1 && text[j] === this.sheetToken) {\n                                        j--;\n                                        while (j > -1 && text[j] !== this.sheetToken) {\n                                            j--;\n                                        }\n                                        if (j > -1 && text[j] === this.sheetToken) {\n                                            j--;\n                                        }\n                                    }\n                                    j = j + 1;\n                                    left = this.parent.substring(text, j, i - j);\n                                    left = this.parent.getCellFrom(left);\n                                }\n                                else {\n                                    j = j + 1;\n                                    left = this.parent.substring(text, j, i - j);\n                                }\n                                this.parent.updateDependentCell(left);\n                                leftIndex = j;\n                            }\n                            if ((this.parent.namedRanges.size > 0 && this.parent.namedRanges.has(left.toUpperCase())) ||\n                                (this.parent.storedData.has(left.toUpperCase()))) {\n                                left = 'n' + this.checkForNamedRangeAndKeyValue(left);\n                            }\n                        }\n                    }\n                    else {\n                        leftIndex = i;\n                    }\n                    if (i === text.length - 1) {\n                        /* tslint:disable-next-line */\n                        throw new FormulaError(this.parent.formulaErrorStrings[FormulasErrorsStrings.expression_cannot_end_with_an_operator]);\n                    }\n                    else {\n                        j = i + 1;\n                        var uFound = text[j] === 'u'; // for 3*-2\n                        if (uFound) {\n                            j = j + 1;\n                        }\n                        if (text[j] === this.parent.tic[0]) {\n                            var k = text.substring(j + 1).indexOf(this.parent.tic);\n                            if (k < 0) {\n                                throw this.parent.formulaErrorStrings[FormulasErrorsStrings.cannot_parse];\n                            }\n                            right = this.parent.substring(text, j, k + 2);\n                            rightIndex = k + j + 2;\n                        }\n                        else if (text[j] === this.parent.arithMarker) {\n                            var k = this.findRightMarker(text.substring(j + 1));\n                            if (k < 0) {\n                                throw new FormulaError(this.parent.formulaErrorStrings[FormulasErrorsStrings.cannot_parse]);\n                            }\n                            right = this.parent.substring(text, j + 1, k);\n                            rightIndex = k + j + 2;\n                        }\n                        else if (text[j] === 'q') {\n                            var bracketCount = 0;\n                            var k = j + 1;\n                            while (k < text.length && (text[k] !== this.parent.rightBracket || bracketCount !== 0)) {\n                                if (text[k] === this.parent.rightBracket) {\n                                    bracketCount++;\n                                }\n                                else if (text[k] === 'q') {\n                                    bracketCount--;\n                                }\n                                k++;\n                            }\n                            if (k === text.length) {\n                                throw this.parent.formulaErrorStrings[FormulasErrorsStrings.cannot_parse];\n                            }\n                            right = this.parent.substring(text, j, k - j + 1);\n                            if (uFound) {\n                                right = 'u' + right;\n                            }\n                            rightIndex = k + 1;\n                            /* tslint:disable-next-line */\n                        }\n                        else if (this.parent.isDigit(text[j]) || text[j] === this.parent.getParseDecimalSeparator()) {\n                            var period = (text[j] === this.parent.getParseDecimalSeparator());\n                            j = j + 1;\n                            /* tslint:disable-next-line */\n                            while (j < text.length && (this.parent.isDigit(text[j]) || (!period && text[j] === this.parent.getParseDecimalSeparator()))) {\n                                if (text[j] === this.parent.getParseDecimalSeparator()) {\n                                    period = true;\n                                }\n                                j = j + 1;\n                            }\n                            if (j < text.length && text[j] === '%') {\n                                j += 1;\n                            }\n                            if (period && j < text.length && text[j] === this.parent.getParseDecimalSeparator()) {\n                                throw this.parent.formulaErrorStrings[FormulasErrorsStrings.number_contains_2_decimal_points];\n                            }\n                            right = 'n' + this.parent.substring(text, i + 1, j - i - 1);\n                            rightIndex = j;\n                        }\n                        else if (this.parent.isUpperChar(text[j]) || text[j] === this.sheetToken || text[j] === 'u') {\n                            if (text[j] === this.sheetToken) {\n                                j = j + 1;\n                                while (j < text.length && text[j] !== this.sheetToken) {\n                                    j = j + 1;\n                                }\n                            }\n                            j = j + 1;\n                            var jTemp = 0;\n                            var inbracket = false;\n                            while (j < text.length && (this.parent.isUpperChar(text[j]) || text[j] === '_'\n                                || text[j] === '.' || text[j] === '[' || text[j] === ']' || text[j] === '#' || text[j] === ' '\n                                || text[j] === '%' || text[j] === this.parent.getParseDecimalSeparator() && inbracket)) {\n                                if (j !== text.length - 1 && text[j] === '[' && text[j + 1] === '[') {\n                                    inbracket = true;\n                                }\n                                if (j !== text.length - 1 && text[j] === ']' && text[j + 1] === ']') {\n                                    inbracket = false;\n                                }\n                                j++;\n                                jTemp++;\n                            }\n                            var noCellReference = (j === text.length) || !this.parent.isDigit(text[j]);\n                            if (jTemp > 1) {\n                                while (j < text.length && (this.parent.isUpperChar(text[j]) || this.parent.isDigit(text[j])\n                                    || text[j] === ' ' || text[j] === '_')) {\n                                    j++;\n                                }\n                                noCellReference = true;\n                            }\n                            while (j < text.length && this.parent.isDigit(text[j])) {\n                                j = j + 1;\n                            }\n                            if (j < text.length && text[j] === ':') {\n                                j = j + 1;\n                                if (j < text.length && text[j] === this.sheetToken) {\n                                    j++;\n                                    while (j < text.length && text[j] !== this.sheetToken) {\n                                        j = j + 1;\n                                    }\n                                    if (j < text.length && text[j] === this.sheetToken) {\n                                        j++;\n                                    }\n                                }\n                                while (j < text.length && this.parent.isUpperChar(text[j])) {\n                                    j = j + 1;\n                                }\n                                while (j < text.length && this.parent.isDigit(text[j])) {\n                                    j = j + 1;\n                                }\n                                j = j - 1;\n                                right = this.parent.substring(text, i + 1, j - i);\n                                right = this.parent.getCellFrom(right);\n                            }\n                            else {\n                                j = j - 1;\n                                right = this.parent.substring(text, i + 1, j - i);\n                                uFound = text[j] === 'u';\n                                if (uFound) {\n                                    right = 'u' + right;\n                                }\n                            }\n                            if (noCellReference && right.startsWith(this.sheetToken)) {\n                                noCellReference = !this.parent.isCellReference(right);\n                            }\n                            if (!noCellReference) {\n                                this.parent.updateDependentCell(right);\n                            }\n                            if ((this.parent.namedRanges.size > 0 && this.parent.namedRanges.has(right.toUpperCase()))\n                                || (this.parent.storedData.has(right.toUpperCase()))) {\n                                right = 'n' + this.checkForNamedRangeAndKeyValue(right);\n                            }\n                            rightIndex = j + 1;\n                        }\n                    }\n                    var p = op.indexOf(text[i]);\n                    var s = this.parent.arithMarker + left + right + markers[p] + this.parent.arithMarker;\n                    if (leftIndex > 0) {\n                        s = text.substring(0, leftIndex) + s;\n                    }\n                    if (rightIndex < text.length) {\n                        s = s + text.substring(rightIndex);\n                    }\n                    s = s.split(this.parent.arithMarker2).join(this.parent.arithMarker.toString());\n                    text = s;\n                    i = this.indexOfAny(text, operators);\n                }\n            }\n            else {\n                if (text.length > 0 && (this.parent.isUpperChar(text[0]) || text[0] === this.sheetToken)) {\n                    var isCharacter = true;\n                    var checkLetter = true;\n                    var oneTokenFound = false;\n                    var textLen = text.length;\n                    for (var k = 0; k < textLen; ++k) {\n                        if (text[k] === this.sheetToken) {\n                            if (k > 0 && !oneTokenFound) {\n                                throw this.parent.getErrorStrings()[CommonErrors.ref];\n                            }\n                            oneTokenFound = true;\n                            k++;\n                            while (k < textLen && this.parent.isDigit(text[k])) {\n                                k++;\n                            }\n                            if (k === textLen || text[k] !== this.sheetToken) {\n                                isCharacter = false;\n                                break;\n                            }\n                        }\n                        else {\n                            if (!checkLetter && this.parent.isChar(text[k])) {\n                                isCharacter = false;\n                                break;\n                            }\n                            if (this.parent.isChar(text[k]) || this.parent.isDigit(text[k]) || text[k] === this.sheetToken) {\n                                checkLetter = this.parent.isUpperChar(text[k]);\n                            }\n                            else {\n                                isCharacter = false;\n                                break;\n                            }\n                        }\n                    }\n                    if (isCharacter) {\n                        this.parent.updateDependentCell(text);\n                    }\n                }\n            }\n            return text;\n        }\n        catch (ex) {\n            return ex;\n        }\n    };\n    /** @hidden */\n    Parser.prototype.indexOfAny = function (text, operators) {\n        for (var i = 0; i < text.length; i++) {\n            if (operators.indexOf(text[i]) > -1) {\n                return i;\n            }\n        }\n        return -1;\n    };\n    /** @hidden */\n    Parser.prototype.findLeftMarker = function (text) {\n        var ret = -1;\n        if (text.indexOf(this.parent.arithMarker) > -1) {\n            var bracketLevel = 0;\n            for (var i = text.length - 1; i >= 0; --i) {\n                if (text[i] === this.parent.rightBracket) {\n                    bracketLevel--;\n                }\n                else if (text[i] === this.parent.leftBracket) {\n                    bracketLevel++;\n                }\n                else if (text[i] === this.parent.arithMarker && bracketLevel === 0) {\n                    ret = i;\n                    break;\n                }\n            }\n        }\n        return ret;\n    };\n    /** @hidden */\n    Parser.prototype.findRightMarker = function (text) {\n        var ret = -1;\n        if (text.indexOf(this.parent.arithMarker) > -1) {\n            var bracketLevel = 0;\n            for (var j = 0; j < text.length; ++j) {\n                if (text[j] === this.parent.rightBracket) {\n                    bracketLevel--;\n                }\n                else if (text[j] === this.parent.leftBracket) {\n                    bracketLevel++;\n                }\n                else if (text[j] === this.parent.arithMarker && bracketLevel === 0) {\n                    ret = j;\n                    break;\n                }\n            }\n        }\n        return ret;\n    };\n    /** @hidden */\n    Parser.prototype.parseFormula = function (formula, fKey) {\n        if (formula.length > 0 && formula[0] === this.parent.getFormulaCharacter()) {\n            formula = formula.substring(1);\n        }\n        if (formula.indexOf('#REF!') > -1) {\n            return this.parent.getErrorStrings()[CommonErrors.ref];\n        }\n        if (formula.length > 0 && formula[0] === '+') {\n            formula = formula.substring(1);\n        }\n        try {\n            this.isFailureTriggered = false;\n            this.isError = false;\n            formula = this.parse(formula.trim(), fKey);\n            this.isFormulaParsed = true;\n        }\n        catch (ex) {\n            var args = this.exceptionArgs(ex);\n            if (!this.isFailureTriggered) {\n                this.parent.trigger('onFailure', args);\n                this.isFailureTriggered = true;\n            }\n            var errorMessage = (typeof args.exception === 'string') ? args.exception : args.message;\n            formula = (isNullOrUndefined(this.parent.getErrorLine(ex)) ? '' : '#' + this.parent.getErrorLine(ex) + ': ') + errorMessage;\n            this.isError = true;\n        }\n        return formula;\n    };\n    /** @hidden */\n    Parser.prototype.markLibraryFormulas = function (formula) {\n        var bracCount = 0;\n        var rightParens = formula.indexOf(')');\n        if (rightParens === -1) {\n            formula = this.markNamedRanges(formula);\n        }\n        else {\n            while (rightParens > -1) {\n                var parenCount = 0;\n                var leftParens = rightParens - 1;\n                while (leftParens > -1 && (formula[leftParens] !== '(' || parenCount !== 0)) {\n                    if (formula[leftParens] === ')') {\n                        parenCount++;\n                    }\n                    else if (formula[leftParens] === ')') {\n                        parenCount--;\n                    }\n                    leftParens--;\n                }\n                if (leftParens === -1) {\n                    throw new FormulaError(this.parent.formulaErrorStrings[FormulasErrorsStrings.mismatched_parentheses]);\n                }\n                var i = leftParens - 1;\n                while (i > -1 && (this.parent.isChar(formula[i]))) {\n                    i--;\n                }\n                var len = leftParens - i - 1;\n                var libFormula = this.parent.substring(formula, i + 1, len);\n                if (len > 0 && !isNullOrUndefined(this.parent.getFunction(libFormula))) {\n                    if (this.parent.substring(formula, i + 1, len) === 'AREAS') {\n                        this.ignoreBracet = true;\n                    }\n                    else {\n                        this.ignoreBracet = false;\n                    }\n                    var substr = this.parent.substring(formula, leftParens, rightParens - leftParens + 1);\n                    try {\n                        var args = void 0;\n                        substr = substr.split('(').join('').split(')').join('');\n                        substr = '(' + this.formulaAutoCorrection(substr, args) + ')';\n                    }\n                    catch (ex) {\n                        var args = {\n                            message: ex.message, exception: ex,\n                            isForceCalculable: ex.formulaCorrection, computeForceCalculate: false\n                        };\n                        if (!args.isForceCalculable) {\n                            throw this.parent.formulaErrorStrings[FormulasErrorsStrings.improper_formula];\n                        }\n                        if (!this.isFailureTriggered) {\n                            this.parent.trigger('onFailure', args);\n                            this.isFailureTriggered = true;\n                            bracCount = bracCount + 1;\n                        }\n                        args.computeForceCalculate = bracCount > 0 ? true : args.computeForceCalculate;\n                        if (args.isForceCalculable) {\n                            if (args.computeForceCalculate) {\n                                substr = substr.split('(').join('').split(')').join('');\n                                substr = '(' + this.formulaAutoCorrection(substr, args) + ')';\n                            }\n                            else {\n                                throw this.parent.formulaErrorStrings[FormulasErrorsStrings.improper_formula];\n                            }\n                        }\n                        else {\n                            throw this.parent.formulaErrorStrings[FormulasErrorsStrings.improper_formula];\n                        }\n                    }\n                    substr = this.markNamedRanges(substr);\n                    substr = this.swapInnerParens(substr);\n                    substr = this.addParensToArgs(substr);\n                    var id = substr.lastIndexOf(this.parent.getParseArgumentSeparator());\n                    var k = 0;\n                    if (id === -1) {\n                        if (substr.length > 2 && substr[0] === '(' && substr[substr.length - 1] === ')') {\n                            if (substr[1] !== '{' && substr[1] !== '(') {\n                                substr = substr.substring(0, substr.length - 1) + '}' + substr.substring(substr.length - 1);\n                                substr = substr[0] + '{' + substr.substring(1);\n                            }\n                        }\n                    }\n                    formula = formula.substring(0, i + 1) + 'q' + this.parent.substring(formula, i + 1, len) +\n                        (substr.split('(').join(this.parent.leftBracket))\n                            .split(')').join(this.parent.rightBracket) + formula.substring(rightParens + 1);\n                }\n                else if (len > 0) {\n                    return this.parent.getErrorStrings()[CommonErrors.name];\n                }\n                else {\n                    var s = this.emptyStr;\n                    if (leftParens > 0) {\n                        s = formula.substring(0, leftParens);\n                    }\n                    s = s + '{' + this.parent.substring(formula, leftParens + 1, rightParens - leftParens - 1) + '}';\n                    if (rightParens < formula.length) {\n                        s = s + formula.substring(rightParens + 1);\n                    }\n                    s = this.markNamedRanges(s);\n                    formula = s;\n                }\n                rightParens = formula.indexOf(')');\n            }\n        }\n        formula = (formula.split('{').join('(')).split('}').join(')');\n        return formula;\n    };\n    /** @hidden */\n    Parser.prototype.swapInnerParens = function (fSubstr) {\n        if (fSubstr.length > 2) {\n            /* tslint:disable-next-line */\n            fSubstr = fSubstr[0] + fSubstr.substr(1, fSubstr.length - 2).split('(').join('{').split(')').join('}') + fSubstr[fSubstr.length - 1];\n        }\n        return fSubstr;\n    };\n    /** @hidden */\n    Parser.prototype.addParensToArgs = function (fSubstr) {\n        if (fSubstr.length === 0) {\n            return this.emptyStr;\n        }\n        var rightSides = [];\n        rightSides.push(this.parent.getParseArgumentSeparator());\n        rightSides.push(this.parent.rightBracket);\n        var id = fSubstr.lastIndexOf(this.parent.getParseArgumentSeparator());\n        var k = 0;\n        if (id === -1) {\n            if (fSubstr.length > 2 && fSubstr[0] === '(' && fSubstr[fSubstr.length - 1] === ')') {\n                if (fSubstr[1] !== '{' && fSubstr[1] !== '(') {\n                    fSubstr = fSubstr.substring(0, fSubstr.length - 1) + '}' + fSubstr.substring(fSubstr.length - 1);\n                    fSubstr = fSubstr[0] + '{' + fSubstr.substring(1);\n                }\n                else {\n                    var marker = ['+', '-', '*', '/'];\n                    id = this.lastIndexOfAny(fSubstr, marker);\n                    if (k === 0 && fSubstr[fSubstr.length - 1] === ')') {\n                        k = fSubstr.length - 1;\n                    }\n                    if (k > 0) {\n                        if (fSubstr[id + 1] !== '{' && fSubstr[id - 1] === '}') {\n                            fSubstr = fSubstr.substr(0, k) + '}' + fSubstr.substr(k);\n                            fSubstr = fSubstr.substr(0, id + 1) + '{' + fSubstr.substr(id + 1);\n                        }\n                    }\n                }\n            }\n        }\n        else {\n            var oneTimeOnly = true;\n            while (id > -1) {\n                var j = this.indexOfAny(fSubstr.substring(id + 1, fSubstr.length), rightSides);\n                if (j >= 0) {\n                    j = id + j + 1;\n                }\n                else if (j === -1 && fSubstr[fSubstr.length - 1] === ')') {\n                    j = fSubstr.length - 1;\n                }\n                if (j > 0) {\n                    if (fSubstr[id + 1] !== '{' && fSubstr[j - 1] !== '}') {\n                        fSubstr = fSubstr.substr(0, j) + '}' + fSubstr.substr(j);\n                        fSubstr = fSubstr.substr(0, id + 1) + '{' + fSubstr.substr(id + 1);\n                    }\n                }\n                id = fSubstr.substr(0, id).lastIndexOf(this.parent.getParseArgumentSeparator());\n                if (oneTimeOnly && id === -1 && fSubstr[0] === '(') {\n                    id = 0;\n                    oneTimeOnly = false;\n                }\n            }\n        }\n        fSubstr = fSubstr.split('{}').join(this.emptyStr);\n        return fSubstr;\n    };\n    /** @hidden */\n    Parser.prototype.lastIndexOfAny = function (text, operators) {\n        for (var i = text.length - 1; i > -1; i--) {\n            if (operators.indexOf(text[i]) > -1) {\n                return i;\n            }\n        }\n        return -1;\n    };\n    /** @hidden */\n    Parser.prototype.markNamedRanges = function (formula) {\n        var markers = [')', this.parent.getParseArgumentSeparator(), '}', '+', '-', '*', '/', '<', '>', '=', '&'];\n        var i = (formula.length > 0 && (formula[0] === '(' || formula[0] === '{')) ? 1 : 0;\n        if (formula.indexOf('#N/A') > -1) {\n            formula = formula.split('#N/A').join('#N~A');\n        }\n        if (formula.indexOf('#DIV/0!') > -1) {\n            formula = formula.split('#DIV/0!').join('#DIV~0!');\n        }\n        var end = this.indexOfAny(formula.substring(i), markers);\n        while (end > -1 && end + i < formula.length) {\n            var scopedRange = this.emptyStr;\n            var s = null;\n            if ((this.parent.substring(formula, i, end)).indexOf('[') > -1) {\n                s = this.getTableRange(this.parent.substring(formula, i, end));\n            }\n            else if (this.parent.storedData.has(this.parent.substring(formula, i, end))) {\n                s = this.checkForNamedRangeAndKeyValue(this.parent.substring(formula, i, end));\n            }\n            else if (this.parent.namedRanges.has(this.parent.substring(formula, i, end))) {\n                s = this.checkForNamedRangeAndKeyValue(this.parent.substring(formula, i, end));\n            }\n            if (isNullOrUndefined(s)) {\n                scopedRange = this.checkScopedRange(this.parent.substring(formula, i, end));\n                if (scopedRange !== 'NaN') {\n                    this.findNamedRange = true;\n                    s = scopedRange;\n                }\n                else if (this.parent.substring(formula, i, end).startsWith(this.sheetToken.toString())) {\n                    var formulaStr = this.parent.substring(formula, i, end).indexOf(this.sheetToken, 1);\n                    // if (formulaStr > 1) {\n                    //     s = this.parent.namedRanges.get(this.parent.substring\n                    // (formula.substring(i), formulaStr + 1, end - formulaStr - 1));\n                    // }\n                }\n                if (!isNullOrUndefined(s) && this.findNamedRange) {\n                    if (s.indexOf(this.fixedReference) > -1) {\n                        s = s.split(this.fixedReference).join(this.emptyStr);\n                    }\n                }\n            }\n            if (!isNullOrUndefined(s)) {\n                s = s.toUpperCase();\n                s = this.parent.setTokensForSheets(s);\n                s = this.markLibraryFormulas(s);\n            }\n            if (!isNullOrUndefined(s) && s !== this.emptyStr) {\n                formula = formula.substring(0, i) + s + formula.substring(i + end);\n                i += s.length + 1;\n            }\n            else {\n                i += end + 1;\n                while (i < formula.length && !this.parent.isUpperChar(formula[i]) && formula[i] !== this.sheetToken) {\n                    i++;\n                }\n            }\n            end = i;\n            if (i < formula.length - 1 && formula[i] === '{') {\n                i = i + 1;\n            }\n            end = this.indexOfAny(formula.substring(i), markers);\n            while (end === 0 && i < formula.length - 1) {\n                i++;\n                end = this.indexOfAny(formula.substring(i), markers);\n            }\n            if ((end === -1 || formula.substring(i).indexOf('[') > -1) && i < formula.length) {\n                if (formula.substring(i).indexOf('[') > -1) {\n                    s = this.getTableRange(formula.substring(i));\n                }\n                else {\n                    if (this.parent.storedData.has(formula.substring(i))) {\n                        s = this.parent.storedData.size > 0 ? this.checkForNamedRangeAndKeyValue(formula.substring(i)) : s;\n                    }\n                    else {\n                        s = this.parent.namedRanges.size > 0 ? this.checkForNamedRangeAndKeyValue(formula.substring(i)) : s;\n                    }\n                }\n                if (isNullOrUndefined(s)) {\n                    scopedRange = this.checkScopedRange(formula.substring(i));\n                    if (scopedRange !== 'NaN') {\n                        s = scopedRange;\n                    }\n                }\n                if (!isNullOrUndefined(s) && s !== this.emptyStr) {\n                    s = s.toUpperCase();\n                    s = this.parent.setTokensForSheets(s);\n                    s = this.markLibraryFormulas(s);\n                    if (s != null) {\n                        var val = formula.substring(i);\n                        if (val[val.length - 1] === ')') {\n                            formula = formula.substring(0, i) + s + ')';\n                        }\n                        else {\n                            formula = formula.substring(0, i) + s;\n                        }\n                        i += s.toString().length + 1;\n                    }\n                }\n                end = (i < formula.length) ? this.indexOfAny(formula.substring(i), markers) : -1;\n            }\n        }\n        if (formula.indexOf('#N~A') > -1) {\n            formula = formula.split('#N~A').join('#N/A');\n        }\n        if (formula.indexOf('#DIV~0!') > -1) {\n            formula = formula.split('#DIV~0!').join('#DIV/0!');\n        }\n        return formula;\n    };\n    /** @hidden */\n    Parser.prototype.checkForNamedRangeAndKeyValue = function (text) {\n        var scopedRange = this.emptyStr;\n        if (text.indexOf('[') > -1) {\n            var namerangeValue = this.getTableRange(text);\n            if (!isNullOrUndefined(namerangeValue)) {\n                this.findNamedRange = true;\n                text = namerangeValue;\n            }\n        }\n        scopedRange = this.checkScopedRange(text);\n        if (scopedRange !== 'NaN') {\n            this.findNamedRange = true;\n            text = scopedRange;\n        }\n        else {\n            if (text.indexOf(this.sheetToken) > -1) {\n                var sheet = this.parent.getSheetFamilyItem(this.parent.grid);\n                /* tslint:disable-next-line */\n                var value = text.split('\"').join(this.emptyStr);\n                value = value.substr(0, value.indexOf(this.sheetToken));\n                if (sheet.sheetNameToToken.has(value.toUpperCase())) {\n                    /* tslint:disable */\n                    var sheetIndex = parseInt(sheet.sheetNameToToken.get(value.toUpperCase()).split(this.sheetToken).join(this.emptyStr));\n                    // if (!ej.isNullOrUndefined(this.parentObject) && this.parentObject.pluginName == \"ejSpreadsheet\") {\n                    //     var name = text.replace(value, this.parentObject.model.sheets[(sheetIndex + 1)].sheetInfo.text.toUpperCase()).split(\"'\").join(this._string_empty);\n                    //     if (this.getNamedRanges().length > 0 && this.getNamedRanges().contains(name.toUpperCase())) {\n                    //         text = name;\n                    //     }\n                    // }\n                    /* tslint-enable */\n                }\n            }\n            if (this.parent.storedData.size > 0 && this.parent.storedData.has(text)) {\n                text = 'A' + this.parent.colIndex(text);\n            }\n            if (this.parent.namedRanges.size > 0 && this.parent.namedRanges.has(text.toUpperCase())) {\n                /* tslint:disable-next-line:no-any */\n                if (!isNullOrUndefined(this.parent.parentObject)) {\n                    text = this.parse(this.parent.namedRanges.get(text.toUpperCase()));\n                }\n                else {\n                    text = this.parse(this.parent.namedRanges.get(text.toUpperCase()));\n                    text = this.parent.setTokensForSheets(text);\n                    if (text.indexOf(this.fixedReference) > -1) {\n                        text.split(this.fixedReference).join(this.emptyStr);\n                    }\n                    this.findNamedRange = true;\n                }\n            }\n            if (this.findNamedRange) {\n                if (text[0] !== '!' && text[0] !== 'q' && text[0] !== 'bq') {\n                    text = this.parent.setTokensForSheets(text);\n                    if (text.indexOf(this.fixedReference) > -1) {\n                        text = text.split(this.fixedReference).join(this.emptyStr);\n                    }\n                }\n            }\n        }\n        return text;\n    };\n    Parser.prototype.getTableRange = function (text) {\n        text = text.replace(' ', this.emptyStr).toUpperCase();\n        var name = text.replace(']', this.emptyStr).replace('#DATA', this.emptyStr);\n        var tableName = name;\n        if (name.indexOf(this.parent.getParseArgumentSeparator()) > -1) {\n            tableName = name.substring(0, name.indexOf(this.parent.getParseArgumentSeparator())).replace('[', this.emptyStr);\n            name = name.replace('[', this.emptyStr).replace(this.parent.getParseArgumentSeparator(), '_');\n        }\n        var range = this.emptyStr;\n        return name.toUpperCase();\n    };\n    Parser.prototype.findNextEndIndex = function (formula, loc) {\n        var count = 0;\n        var l = loc;\n        var found = false;\n        while (!found && loc < formula.length) {\n            if (formula[l] === '[') {\n                count++;\n            }\n            else if (formula[l] === ']') {\n                count--;\n                if (count === 0) {\n                    found = true;\n                }\n            }\n            loc++;\n        }\n        loc = loc - l;\n        return loc;\n    };\n    ;\n    return Parser;\n}());\nexport { Parser };\n","/* tslint:disable-next-line:max-line-length */\nimport { getSheetName, getSheetIndex, getSheet, getSheetIndexByName, getCell } from '../base/index';\nimport { workbookFormulaOperation, getColumnHeaderText, aggregateComputation, getRangeIndexes } from '../common/index';\nimport { Calculate, ValueChangedArgs, CommonErrors, getAlphalabel } from '../../calculate/index';\nimport { isNullOrUndefined } from '@syncfusion/ej2-base';\nimport { getCellAddress, getFormattedCellObject, isNumber, checkIsFormula } from '../common/index';\nimport { workbookEditOperation, getRangeAddress, getRangeFromAddress, isCellReference } from '../common/index';\n/**\n * @hidden\n * The `WorkbookFormula` module is used to handle the formula operation in Workbook.\n */\nvar WorkbookFormula = /** @class */ (function () {\n    /**\n     * Constructor for formula module in Workbook.\n     * @private\n     */\n    function WorkbookFormula(workbook) {\n        this.uniqueOBracket = String.fromCharCode(129);\n        this.uniqueCBracket = String.fromCharCode(130);\n        this.uniqueCSeparator = String.fromCharCode(131);\n        this.uniqueCOperator = String.fromCharCode(132);\n        this.uniquePOperator = String.fromCharCode(133);\n        this.uniqueSOperator = String.fromCharCode(134);\n        this.uniqueMOperator = String.fromCharCode(135);\n        this.uniqueDOperator = String.fromCharCode(136);\n        this.uniqueModOperator = String.fromCharCode(137);\n        this.uniqueConcateOperator = String.fromCharCode(138);\n        this.uniqueEqualOperator = String.fromCharCode(139);\n        this.uniqueExpOperator = String.fromCharCode(140);\n        this.uniqueGTOperator = String.fromCharCode(141);\n        this.uniqueLTOperator = String.fromCharCode(142);\n        this.sheetInfo = [];\n        this.parent = workbook;\n        this.init();\n    }\n    WorkbookFormula.prototype.init = function () {\n        this.addEventListener();\n        this.initCalculate();\n        this.registerSheet();\n    };\n    /**\n     * To destroy the formula module.\n     * @return {void}\n     * @hidden\n     */\n    WorkbookFormula.prototype.destroy = function () {\n        this.removeEventListener();\n        this.calculateInstance.dispose();\n        this.calculateInstance = null;\n        this.parent = null;\n    };\n    WorkbookFormula.prototype.addEventListener = function () {\n        this.parent.on(workbookFormulaOperation, this.performFormulaOperation, this);\n        this.parent.on(aggregateComputation, this.aggregateComputation, this);\n    };\n    WorkbookFormula.prototype.removeEventListener = function () {\n        if (!this.parent.isDestroyed) {\n            this.parent.off(workbookFormulaOperation, this.performFormulaOperation);\n            this.parent.off(aggregateComputation, this.aggregateComputation);\n        }\n    };\n    /**\n     * Get the module name.\n     * @returns string\n     * @private\n     */\n    WorkbookFormula.prototype.getModuleName = function () {\n        return 'workbookFormula';\n    };\n    WorkbookFormula.prototype.initCalculate = function () {\n        this.calculateInstance = new Calculate(this.parent);\n        this.calcID = this.calculateInstance.createSheetFamilyID();\n        this.calculateInstance.setTreatEmptyStringAsZero(true);\n        this.calculateInstance.grid = this.parent.getActiveSheet().id.toString();\n    };\n    WorkbookFormula.prototype.performFormulaOperation = function (args) {\n        var action = args.action;\n        var formulas = this.calculateInstance.getLibraryFormulas();\n        var formulaInfo = (Array.from(formulas.values()));\n        switch (action) {\n            case 'getLibraryFormulas':\n                args.formulaCollection = Array.from(formulas.keys());\n                break;\n            case 'getFormulaCategory':\n                var collection = ['All'];\n                for (var i = 1; i < Array.from(formulas.values()).length; i++) {\n                    if (collection.indexOf(formulaInfo[i].category) < 0) {\n                        collection.push(formulaInfo[i].category);\n                    }\n                }\n                args.categoryCollection = collection;\n                break;\n            case 'dropDownSelectFormulas':\n                for (var i = 0; i < Array.from(formulas.values()).length; i++) {\n                    if (args.selectCategory === formulaInfo[i].category) {\n                        args.formulaCollection[i] = Array.from(formulas.keys())[i];\n                    }\n                }\n                break;\n            case 'getFormulaDescription':\n                for (var i = 0; i < Array.from(formulas.values()).length; i++) {\n                    if (args.selectedList === Array.from(formulas.keys())[i]) {\n                        args.description = formulaInfo[i].description;\n                    }\n                }\n                break;\n            case 'registerSheet':\n                this.registerSheet(args.sheetIndex, args.sheetCount);\n                if (args.isImport) {\n                    this.updateSheetInfo();\n                }\n                break;\n            case 'unRegisterSheet':\n                this.unRegisterSheet(args.sheetIndex, args.sheetCount);\n                break;\n            case 'refreshCalculate':\n                args.value = this.autoCorrectFormula(args.value, args.rowIndex, args.colIndex);\n                this.refreshCalculate(args.rowIndex, args.colIndex, args.value, args.isFormula, args.sheetIndex);\n                args.value = args.value ? args.value.toString().split('-*').join('-').split('/*').join('/').split('*/').\n                    join('*').split('-/').join('-').split('*+').join('*').split('+*').join('+') : args.value;\n                break;\n            case 'getArgumentSeparator':\n                args.argumentSeparator = this.calculateInstance.getParseArgumentSeparator();\n                break;\n            case 'addDefinedName':\n                args.isAdded = this.addDefinedName(args.definedName);\n                break;\n            case 'removeDefinedName':\n                args.isRemoved = this.removeDefinedName(args.definedName, args.scope);\n                break;\n            case 'initiateDefinedNames':\n                this.initiateDefinedNames();\n                break;\n            case 'renameUpdation':\n                this.renameUpdation(args.value, args.sheetId);\n                break;\n            case 'addSheet':\n                this.sheetInfo.push({ visibleName: args.visibleName, sheet: args.sheetName, index: args.index });\n                break;\n            case 'getSheetInfo':\n                args.sheetInfo = this.sheetInfo;\n                break;\n            case 'deleteSheetTab':\n                var length_1 = this.sheetInfo.length;\n                for (var i = 0; i < length_1; i++) {\n                    if (this.sheetInfo[i].index === args.index) {\n                        args.sheetName = this.sheetInfo[i].sheet;\n                        this.sheetInfo.splice(i, 1);\n                        break;\n                    }\n                }\n                this.calculateInstance.unregisterGridAsSheet((args.index - 1).toString(), args.index);\n                this.calculateInstance.tokenCount = this.calculateInstance.tokenCount - 1;\n                this.sheetDeletion(args.sheetName, args.index, args.index);\n                break;\n            case 'getReferenceError':\n                args.refError = this.referenceError();\n                break;\n            case 'getAlpha':\n                args.col = getAlphalabel(args.col);\n                break;\n            case 'addCustomFunction':\n                this.addCustomFunction(args.functionHandler, args.functionName);\n                break;\n            case 'computeExpression':\n                args.calcValue = this.calculateInstance.computeExpression(args.formula);\n                break;\n            case 'registerGridInCalc':\n                this.calculateInstance.grid = args.sheetID;\n                break;\n            case 'refreshInsDelFormula':\n                this.refreshInsDelFormula(args.insertArgs);\n                break;\n            case 'refreshNamedRange':\n                this.refreshNamedRange(args.insertArgs, action);\n                break;\n        }\n    };\n    WorkbookFormula.prototype.referenceError = function () {\n        return this.calculateInstance.getErrorStrings()[CommonErrors.ref];\n    };\n    WorkbookFormula.prototype.getSheetInfo = function () {\n        return this.sheetInfo;\n    };\n    WorkbookFormula.prototype.addCustomFunction = function (functionHandler, functionName) {\n        this.calculateInstance.defineFunction(functionName, functionHandler);\n    };\n    WorkbookFormula.prototype.updateSheetInfo = function () {\n        var _this = this;\n        this.sheetInfo = [];\n        this.parent.sheets.forEach(function (sheet, idx) {\n            _this.sheetInfo.push({ visibleName: sheet.name, sheet: 'Sheet' + sheet.id, index: idx });\n        });\n    };\n    WorkbookFormula.prototype.sheetDeletion = function (delSheetName, sheetId, index) {\n        var dependentCell = this.calculateInstance.getDependentCells();\n        var cellRef = [];\n        var fInfo = null;\n        var formulaVal = '';\n        var rowId;\n        var colId;\n        dependentCell.forEach(function (value, key) {\n            cellRef.push(key);\n        });\n        this.removeSheetTokenIndex(formulaVal, index);\n        for (var i = 0; i < cellRef.length; i++) {\n            var dependentCellRef = this.calculateInstance.getDependentCells().get(cellRef[i]);\n            for (var j = 0; j < dependentCellRef.length; j++) {\n                fInfo = this.calculateInstance.getFormulaInfoTable().get(dependentCellRef[j]);\n                sheetId = parseInt(dependentCellRef[j].split('!')[1], 10) + 1;\n                if (!isNullOrUndefined(fInfo) && sheetId > -1) {\n                    formulaVal = fInfo.formulaText;\n                    if (formulaVal.toUpperCase().indexOf(delSheetName.toUpperCase()) > -1) {\n                        formulaVal = formulaVal.toUpperCase().split(delSheetName.toUpperCase() +\n                            this.calculateInstance.sheetToken).join(this.referenceError());\n                        rowId = this.calculateInstance.rowIndex(dependentCellRef[j]);\n                        colId = this.calculateInstance.colIndex(dependentCellRef[j]);\n                        this.updateDataContainer([rowId - 1, colId - 1], { value: formulaVal, sheetId: sheetId, visible: false });\n                        this.calculateInstance.refresh(fInfo.getParsedFormula());\n                    }\n                }\n                if (delSheetName.split('Sheet')[1] === cellRef[i].split('!')[1]) {\n                    this.calculateInstance.getFormulaInfoTable().delete(cellRef[i]);\n                    this.calculateInstance.clearFormulaDependentCells(cellRef[i]);\n                }\n            }\n        }\n    };\n    WorkbookFormula.prototype.removeSheetTokenIndex = function (value, index) {\n        var family = this.calculateInstance.getSheetFamilyItem(this.calculateInstance.grid);\n        family.sheetNameToToken.delete(index.toString());\n        family.sheetNameToParentObject.delete(index.toString());\n        family.parentObjectToToken.delete(index.toString());\n        family.tokenToParentObject.delete('!' + (index - 1).toString() + '!');\n        return value;\n    };\n    WorkbookFormula.prototype.renameUpdation = function (name, sheetIdx) {\n        var dependentCellRef = this.calculateInstance.getDependentCells();\n        var cellRef = [];\n        var fInfo;\n        var formulaVal = '';\n        var savedTokens = [];\n        var isSheetRenamed = false;\n        var rowIndex;\n        var colIndex;\n        var sheetIndex;\n        dependentCellRef.forEach(function (value, key) {\n            cellRef.push(key);\n        });\n        for (var i = 0; i < this.sheetInfo.length; i++) {\n            if (this.sheetInfo[i].index === sheetIdx) {\n                this.sheetInfo[i].visibleName = name;\n                break;\n            }\n        }\n        var sheetNames = this.sheetInfo;\n        for (var i = 0; i < cellRef.length; i++) {\n            var dependentCells = this.calculateInstance.getDependentCells().get(cellRef[i]);\n            for (var j = 0; j < dependentCells.length; j++) {\n                fInfo = this.calculateInstance.getFormulaInfoTable().get(dependentCells[j]);\n                formulaVal = fInfo.formulaText;\n                for (var s = 0; s < sheetNames.length; s++) {\n                    if (sheetNames[s].visibleName !== sheetNames[s].sheet) {\n                        var name_1 = sheetNames[s].sheet.toUpperCase();\n                        if (formulaVal.toUpperCase().indexOf(name_1) > -1) {\n                            formulaVal = formulaVal.toUpperCase().split(name_1).join(s + '/');\n                            savedTokens.push(s);\n                            isSheetRenamed = true;\n                        }\n                    }\n                }\n                if (isSheetRenamed) {\n                    for (var k = 0; k < savedTokens.length; k++) {\n                        formulaVal = formulaVal.split(savedTokens[k].toString() + '/').join(sheetNames[savedTokens[k]].visibleName);\n                    }\n                    rowIndex = this.calculateInstance.rowIndex(dependentCells[j]);\n                    colIndex = this.calculateInstance.colIndex(dependentCells[j]);\n                    sheetIndex = getSheetIndexByName(this.parent, ('Sheet') + (parseInt(dependentCells[j].split('!')[1], 10) + 1), this.sheetInfo);\n                    this.updateDataContainer([rowIndex - 1, colIndex - 1], { value: formulaVal, sheetId: sheetIndex, visible: true });\n                }\n            }\n        }\n    };\n    WorkbookFormula.prototype.updateDataContainer = function (indexes, data) {\n        var rowIndex = indexes[0];\n        var colIndex = indexes[1];\n        var sheetData;\n        var rowData;\n        var colObj;\n        var len = this.parent.sheets.length;\n        for (var i = 0; i < len; i++) {\n            if (this.parent.sheets[i].id === data.sheetId) {\n                sheetData = this.parent.sheets[i].rows;\n                break;\n            }\n        }\n        if (!isNullOrUndefined(data)) {\n            if (rowIndex in sheetData) {\n                rowData = sheetData[rowIndex];\n                if (colIndex in rowData.cells) {\n                    colObj = rowData.cells[colIndex];\n                    colObj.formula = data.value;\n                    colObj.value = data.visible ? colObj.value : this.referenceError();\n                }\n                else {\n                    rowData.cells[colIndex] = colObj = {};\n                }\n            }\n            else {\n                rowData = sheetData[rowIndex] = {};\n                rowData[colIndex] = colObj = {};\n            }\n        }\n    };\n    WorkbookFormula.prototype.parseSheetRef = function (value) {\n        var regx;\n        var escapeRegx = new RegExp('[!@#$%^&()+=\\';,.{}|\\\":<>~_-]', 'g');\n        var i = 0;\n        var sheetCount = this.parent.sheets.length;\n        var temp = [];\n        temp.length = 0;\n        var sheetInfo = this.getSheetInfo();\n        var exp = '(?=[\\'!])(?=[^\"]*(?:\"[^\"]*\"[^\"]*)*$)';\n        for (i = 0; i < sheetCount; i++) {\n            if (sheetInfo[i].sheet !== sheetInfo[i].visibleName) {\n                regx = new RegExp(sheetInfo[i].visibleName.replace(escapeRegx, '\\\\$&') + exp, 'gi');\n                if (value.match(regx)) {\n                    value = value.replace(regx, i + '/');\n                    temp.push(i);\n                }\n            }\n        }\n        i = 0;\n        while (i < temp.length) {\n            regx = new RegExp(temp[i] + '/' + exp, 'gi');\n            value = value.replace(regx, sheetInfo[temp[i]].sheet);\n            i++;\n        }\n        return value;\n    };\n    WorkbookFormula.prototype.registerSheet = function (sheetIndex, sheetCount) {\n        if (sheetIndex === void 0) { sheetIndex = 0; }\n        if (sheetCount === void 0) { sheetCount = this.parent.sheets.length; }\n        var id;\n        while (sheetIndex < sheetCount) {\n            id = getSheet(this.parent, sheetIndex).id + '';\n            this.calculateInstance.registerGridAsSheet(id, id, this.calcID);\n            sheetIndex++;\n        }\n    };\n    WorkbookFormula.prototype.unRegisterSheet = function (sheetIndex, sheetCount) {\n        if (sheetIndex === void 0) { sheetIndex = 0; }\n        if (sheetCount === void 0) { sheetCount = this.parent.sheets.length; }\n        var id;\n        this.calculateInstance.tokenCount = 0;\n        while (sheetIndex < sheetCount) {\n            id = getSheet(this.parent, sheetIndex).id + '';\n            this.calculateInstance.unregisterGridAsSheet(id, id);\n            sheetIndex++;\n        }\n    };\n    WorkbookFormula.prototype.refreshCalculate = function (rowIdx, colIdx, value, isFormula, sheetIdx) {\n        if (sheetIdx === undefined) {\n            sheetIdx = this.parent.activeSheetIndex;\n        }\n        var sheetName = getSheet(this.parent, sheetIdx).id + '';\n        if (isFormula) {\n            value = this.parseSheetRef(value);\n            var cellArgs = new ValueChangedArgs(rowIdx + 1, colIdx + 1, value);\n            this.calculateInstance.valueChanged(sheetName, cellArgs, true);\n            var referenceCollection = this.calculateInstance.randCollection;\n            if (this.calculateInstance.isRandomVal === true) {\n                var rowId = void 0;\n                var colId = void 0;\n                var refValue = '';\n                if (this.calculateInstance.randomValues.size > 1 && this.calculateInstance.randomValues.size ===\n                    referenceCollection.length) {\n                    for (var i = 0; i < this.calculateInstance.randomValues.size; i++) {\n                        rowId = this.calculateInstance.rowIndex(referenceCollection[i]);\n                        colId = this.calculateInstance.colIndex(referenceCollection[i]);\n                        refValue = this.calculateInstance.randomValues.get(referenceCollection[i]);\n                        sheetName = (parseFloat(this.calculateInstance.getSheetToken(referenceCollection[i]).split(this.calculateInstance.sheetToken).join('')) + 1).toString();\n                        var tempArgs = new ValueChangedArgs(rowId, colId, refValue);\n                        this.calculateInstance.valueChanged(sheetName, tempArgs, true);\n                    }\n                }\n            }\n        }\n        else {\n            var family = this.calculateInstance.getSheetFamilyItem(sheetName);\n            var cellRef = getColumnHeaderText(colIdx + 1) + (rowIdx + 1);\n            if (family.isSheetMember && !isNullOrUndefined(family.parentObjectToToken)) {\n                cellRef = family.parentObjectToToken.get(sheetName) + cellRef;\n            }\n            if (this.calculateInstance.getFormulaInfoTable().has(cellRef)) {\n                this.calculateInstance.getFormulaInfoTable().delete(cellRef);\n                if (this.calculateInstance.getDependentCells().has(cellRef)) {\n                    this.calculateInstance.clearFormulaDependentCells(cellRef);\n                }\n            }\n            this.calculateInstance.getComputedValue().clear();\n            this.calculateInstance.refresh(cellRef);\n            this.calculateInstance.refreshRandValues(cellRef);\n        }\n        this.calculateInstance.cell = '';\n    };\n    WorkbookFormula.prototype.autoCorrectFormula = function (formula, rowIdx, colIdx) {\n        if (!isNullOrUndefined(formula)) {\n            formula = formula.toString();\n            if (formula.split('(').length === 2 && formula.indexOf(')') < 0) {\n                formula += ')';\n            }\n            formula = formula.indexOf('=') === 0 ? formula.slice(1) : formula;\n            var lessEq = formula.match(/</g);\n            var greaterEq = formula.match(/>/g);\n            var equal = formula.match(/=/g);\n            if (lessEq) {\n                var lessOp = '';\n                for (var i = 0; i < lessEq.length; i++) {\n                    lessOp = lessOp + lessEq[i];\n                }\n                formula = formula.replace(lessOp, '<');\n            }\n            if (greaterEq) {\n                var greaterOp = '';\n                for (var j = 0; j < greaterEq.length; j++) {\n                    greaterOp = greaterOp + greaterEq[j];\n                }\n                formula = formula.replace(greaterOp, '>');\n            }\n            if (equal) {\n                var equalOp = '';\n                for (var c = 0; c < equal.length; c++) {\n                    equalOp = equalOp + equal[c];\n                }\n                formula = formula.split(equalOp).join('=');\n            }\n            formula = '=' + formula;\n            if (lessEq || greaterEq || equal) {\n                getCell(rowIdx, colIdx, this.parent.getActiveSheet()).formula = formula;\n            }\n        }\n        return formula;\n    };\n    WorkbookFormula.prototype.initiateDefinedNames = function () {\n        var definedNames = this.parent.definedNames;\n        var i = 0;\n        while (i < definedNames.length) {\n            var definedname = definedNames[i];\n            var refersTo = this.parseSheetRef(definedname.refersTo);\n            var range = getRangeFromAddress(refersTo);\n            var cellRef = false;\n            var isLink = refersTo.indexOf('http:') > -1 ? true : (refersTo.indexOf('https:') > -1 ? true : false);\n            range = range.split('$').join('');\n            range = range.split('=').join('');\n            if (range.indexOf(':') > -1) {\n                var rangeSplit = range.split(':');\n                if (isCellReference(rangeSplit[0]) && isCellReference(rangeSplit[1])) {\n                    cellRef = true;\n                }\n            }\n            else if (range.indexOf(':') < 0) {\n                if (isCellReference(range)) {\n                    cellRef = true;\n                }\n            }\n            if (isLink) {\n                cellRef = false;\n            }\n            if (cellRef) {\n                this.addDefinedName(definedname, true);\n            }\n            else {\n                this.removeDefinedName(definedname.name, definedname.scope);\n                i--;\n            }\n            i++;\n        }\n    };\n    /**\n     * @hidden\n     * Used to add defined name to workbook.\n     * @param {DefineNameModel} name - Define named range.\n     */\n    WorkbookFormula.prototype.addDefinedName = function (definedName, isValidate) {\n        var isAdded = true;\n        var sheetIdx;\n        var name = definedName.name;\n        if (definedName.refersTo.indexOf('!') < 0) {\n            var sheetName = getSheetName(this.parent);\n            sheetName = sheetName.indexOf(' ') !== -1 ? '\\'' + sheetName + '\\'' : sheetName;\n            definedName.refersTo = sheetName + '!' + ((definedName.refersTo.indexOf('=') < 0) ?\n                definedName.refersTo : definedName.refersTo.split('=')[1]);\n        }\n        var visibleRefersTo = definedName.refersTo;\n        var refersTo = this.parseSheetRef(definedName.refersTo);\n        if (definedName.scope) {\n            sheetIdx = getSheetIndex(this.parent, definedName.scope);\n            if (sheetIdx > -1) {\n                name = getSheetName(this.parent, sheetIdx) + '!' + name;\n            }\n        }\n        else {\n            definedName.scope = '';\n        }\n        if (!definedName.comment) {\n            definedName.comment = '';\n        }\n        //need to extend once internal sheet value changes done.\n        if (!isValidate && this.checkIsNameExist(definedName.name, definedName.scope)) {\n            isAdded = false;\n        }\n        else {\n            this.calculateInstance.addNamedRange(name, refersTo[0] === '=' ? refersTo.substr(1) : refersTo);\n            if (refersTo[0] !== '=') {\n                definedName.refersTo = '=' + visibleRefersTo;\n            }\n            if (this.parent.definedNames.indexOf(definedName) < 0) {\n                this.parent.definedNames.push(definedName);\n            }\n        }\n        return isAdded;\n    };\n    /**\n     * @hidden\n     * Used to remove defined name from workbook.\n     * @param {string} name - Specifies the defined name.\n     * @param {string} scope - Specifies the scope of the define name.\n     */\n    WorkbookFormula.prototype.removeDefinedName = function (name, scope) {\n        var isRemoved = false;\n        var index = this.getIndexFromNameColl(name, scope);\n        if (index > -1) {\n            var calcName = name;\n            if (scope) {\n                var sheetIdx = getSheetIndex(this.parent, scope);\n                if (sheetIdx) {\n                    calcName = getSheetName(this.parent, sheetIdx) + '!' + name;\n                }\n            }\n            this.calculateInstance.removeNamedRange(calcName);\n            this.parent.definedNames.splice(index, 1);\n            isRemoved = true;\n        }\n        return isRemoved;\n    };\n    WorkbookFormula.prototype.checkIsNameExist = function (name, sheetName) {\n        var isExist = this.parent.definedNames.some(function (key) {\n            return key.name === name && (sheetName ? key.scope === sheetName : key.scope === '');\n        });\n        return isExist;\n    };\n    WorkbookFormula.prototype.getIndexFromNameColl = function (definedName, scope) {\n        if (scope === void 0) { scope = ''; }\n        var index = -1;\n        this.parent.definedNames.filter(function (name, idx) {\n            if (name.name === definedName && name.scope === scope) {\n                index = idx;\n            }\n        });\n        return index;\n    };\n    WorkbookFormula.prototype.toFixed = function (value) {\n        var num = Number(value);\n        if (Math.round(num) !== num) {\n            value = num.toFixed(2);\n        }\n        return value;\n    };\n    WorkbookFormula.prototype.aggregateComputation = function (args) {\n        var sheet = this.parent.getActiveSheet();\n        var range = sheet.selectedRange;\n        var indexes = getRangeIndexes(range.split(':')[1]);\n        var i;\n        var calcValue;\n        var formulaVal = ['SUM', 'AVERAGE', 'MIN', 'MAX'];\n        var formatedValues = [];\n        if (indexes[0] + 1 === sheet.rowCount && indexes[1] + 1 === sheet.colCount) {\n            range = \"A1:\" + getCellAddress(sheet.usedRange.rowIndex, sheet.usedRange.colIndex);\n        }\n        var actCell = getRangeIndexes(sheet.activeCell);\n        var actCellModel = sheet.rows[actCell[0]] ? sheet.rows[actCell[0]].cells ?\n            sheet.rows[actCell[0]].cells[actCell[1]] : {} : {};\n        var actCellfrmt = (actCellModel) ? actCellModel.format : '';\n        var cellValue;\n        var cellCol = this.calculateInstance.getCellCollection(range);\n        for (i = 0; i < cellCol.length; i++) {\n            cellValue = this.calculateInstance.getValueFromArg(cellCol[i]);\n            if (isNumber(cellValue)) {\n                args.countOnly = false;\n                break;\n            }\n        }\n        args.Count = this.calculateInstance.getFunction('COUNTA')(range);\n        if (!args.Count || args.countOnly) {\n            return;\n        }\n        for (i = 0; i < 4; i++) {\n            calcValue = this.toFixed(this.calculateInstance.getFunction(formulaVal[i])(range));\n            var eventArgs = {\n                formattedText: calcValue,\n                value: calcValue,\n                format: actCellfrmt,\n                onLoad: true\n            };\n            if (actCellfrmt) {\n                this.parent.notify(getFormattedCellObject, eventArgs);\n                calcValue = eventArgs.formattedText;\n            }\n            formatedValues.push(calcValue);\n        }\n        args.Sum = formatedValues[0];\n        args.Avg = formatedValues[1];\n        args.Min = formatedValues[2];\n        args.Max = formatedValues[3];\n    };\n    WorkbookFormula.prototype.clearFormula = function (args) {\n        if (this.parent.activeSheetIndex === args.sheetIdx) {\n            args.rowIdx = (args.type === 'Row') ? (args.status === 'insert') ? (args.rowIdx >= args.startIdx)\n                ? args.rowIdx - args.count : args.rowIdx : args.rowIdx + args.count : args.rowIdx;\n            args.colIdx = (args.type === 'Column') ? (args.status === 'insert') ? (args.colIdx >= args.startIdx) ?\n                args.colIdx - args.count : args.colIdx : args.colIdx + args.count : args.colIdx;\n        }\n        var cellRef = '!' + args.sheetIdx + '!' + getAlphalabel((args.colIdx === -1 ?\n            (args.colIdx + 2) : (args.colIdx + 1))) + (args.rowIdx === -1 ? (args.rowIdx + 2) : (args.rowIdx + 1));\n        this.calculateInstance.getFormulaInfoTable().delete(cellRef);\n        this.calculateInstance.clearFormulaDependentCells(cellRef);\n    };\n    WorkbookFormula.prototype.refreshFormula = function (formulaValue, count, status, type, startIdx, sheetIdx) {\n        var diff;\n        var diff1;\n        var val = formulaValue;\n        var nAlpha;\n        var range = [];\n        var actSheet = this.parent.getActiveSheet();\n        var deleteIdxs = [];\n        var i;\n        var splitFormula = [];\n        var fArg;\n        var ridx;\n        var hasREFVal = false;\n        var pVal;\n        if (checkIsFormula(val)) {\n            if (status === 'delete') {\n                for (i = 1; i <= count; i++) {\n                    deleteIdxs.push(startIdx + i);\n                }\n            }\n            splitFormula = this.parseFormula(val);\n            for (i = 0; i < splitFormula.length; i++) {\n                fArg = splitFormula[i].trim();\n                if (this.calculateInstance.isCellReference(fArg)) {\n                    pVal = i && splitFormula[i - 1].trim();\n                    if (pVal && pVal[pVal.length - 1] === '!') {\n                        pVal = pVal.replace(/['!]/g, '');\n                        if (pVal !== actSheet.name) {\n                            continue;\n                        }\n                    }\n                    else if (parseInt(pVal, 10) === 0 && pVal[pVal.length - 1] === undefined) {\n                        if ((actSheet.id - 1) !== sheetIdx) {\n                            continue;\n                        }\n                    }\n                    range = getRangeIndexes(fArg);\n                    diff = (type === 'Column') ? (status === 'insert') ? range[3] + count : range[3] - count :\n                        (status === 'insert') ? range[2] + count : range[2] - count;\n                    diff1 = (type === 'Column') ? (status === 'insert') ? range[1] + count : range[1] - count :\n                        (status === 'insert') ? range[0] + count : range[0] - count;\n                    diff1 = (type === 'Column') ? (startIdx > range[1]) ? range[1] : diff1 : (startIdx > range[0]) ? range[0] : diff1;\n                    diff = (type === 'Column') ? (startIdx > range[3]) ? range[3] : diff : (startIdx > range[2]) ? range[2] : diff;\n                    if (diff1 > -1) {\n                        nAlpha = (type === 'Column') ? getRangeAddress([range[0], diff1, range[2], diff]).split(':')[0] :\n                            getRangeAddress([diff1, range[1], diff, range[3]]).split(':')[0];\n                    }\n                    else {\n                        nAlpha = '#REF!';\n                        hasREFVal = true;\n                    }\n                    if (status === 'delete') {\n                        ridx = parseInt(type === 'Row' ? fArg.replace(/[A-Z]/g, '') : (fArg.replace(/[0-9]/g, '')), 10);\n                        if (deleteIdxs.indexOf(ridx) > -1) {\n                            nAlpha = '#REF!';\n                            hasREFVal = true;\n                        }\n                    }\n                    splitFormula[i] = nAlpha;\n                }\n            }\n            val = '=' + splitFormula.join('');\n        }\n        return val;\n    };\n    WorkbookFormula.prototype.refreshInsDelFormula = function (args) {\n        var count;\n        var sheet;\n        var sheets = this.parent.sheets;\n        var sheetLen = sheets.length;\n        var address;\n        var cell;\n        var s;\n        var updatedFormulaVal;\n        for (s = 0; s < sheetLen; s++) {\n            count = args.model.length;\n            sheet = this.parent.sheets[s];\n            address = [0, 0, sheet.usedRange.rowIndex, sheet.usedRange.colIndex];\n            for (var i = address[2]; i >= address[0]; i--) {\n                for (var j = address[1]; j <= address[3]; j++) {\n                    cell = getCell(i, j, sheet);\n                    if (cell && cell.formula && checkIsFormula(cell.formula)) {\n                        this.clearFormula({\n                            rowIdx: i, colIdx: j, sheetIdx: s, count: count, status: args.name,\n                            type: args.modelType, startIdx: args.startIndex\n                        });\n                        updatedFormulaVal = this.refreshFormula(cell.formula, count, args.name, args.modelType, args.startIndex, s);\n                        this.parent.notify(workbookEditOperation, {\n                            action: 'updateCellValue', address: [i, j, i,\n                                j], value: updatedFormulaVal, sheetIndex: s\n                        });\n                    }\n                }\n            }\n        }\n    };\n    WorkbookFormula.prototype.parseFormula = function (formula) {\n        var temp;\n        var str;\n        var len;\n        var i = 0;\n        var arr = [];\n        var formulaVal = [];\n        formulaVal = this.markSpecialChar(formula.replace('=', ''));\n        formulaVal = formulaVal.split(/\\(|\\)|=|\\^|>|<|,|:|\\+|-|\\*|\\/|%|&/g);\n        len = formulaVal.length;\n        while (i < len) {\n            temp = formulaVal[i];\n            if (!temp) {\n                i++;\n                continue;\n            }\n            if (temp.length === 1) {\n                arr.push(this.isUniqueChar(temp) ? this.getUniqueCharVal(temp) : temp);\n            }\n            else {\n                str = temp[0];\n                if (temp.indexOf('!') > 0) {\n                    if (this.isUniqueChar(str)) {\n                        arr.push(this.getUniqueCharVal(str));\n                        temp = temp.substr(1);\n                    }\n                    str = temp.indexOf('!') + 1;\n                    arr.push(temp.substr(0, str));\n                    arr.push(temp.substr(str));\n                }\n                else if (this.isUniqueChar(str)) {\n                    arr.push(this.getUniqueCharVal(str));\n                    arr.push(temp.substr(1));\n                }\n                else {\n                    arr.push(temp);\n                }\n            }\n            i++;\n        }\n        return arr;\n    };\n    WorkbookFormula.prototype.getUniqueCharVal = function (formula) {\n        switch (formula) {\n            case this.uniqueOBracket:\n                return '(';\n            case this.uniqueCBracket:\n                return ')';\n            case this.uniqueCSeparator:\n                return ',';\n            case this.uniqueCOperator:\n                return ':';\n            case this.uniquePOperator:\n                return '+';\n            case this.uniqueSOperator:\n                return '-';\n            case this.uniqueMOperator:\n                return '*';\n            case this.uniqueDOperator:\n                return '/';\n            case this.uniqueModOperator:\n                return '%';\n            case this.uniqueConcateOperator:\n                return '&';\n            case this.uniqueEqualOperator:\n                return '=';\n            case this.uniqueExpOperator:\n                return '^';\n            case this.uniqueGTOperator:\n                return '>';\n            case this.uniqueLTOperator:\n                return '<';\n        }\n        return '';\n    };\n    WorkbookFormula.prototype.isUniqueChar = function (formula) {\n        var code = formula.charCodeAt(formula);\n        return code >= 129 && code <= 142;\n    };\n    WorkbookFormula.prototype.markSpecialChar = function (formula) {\n        formula = formula.replace(/\\(/g, '(' + this.uniqueOBracket).replace(/\\)/g, ')' + this.uniqueCBracket);\n        formula = formula.replace(/,/g, ',' + this.uniqueCSeparator).replace(/:/g, ':' + this.uniqueCOperator);\n        formula = formula.replace(/\\+/g, '+' + this.uniquePOperator).replace(/-/g, '-' + this.uniqueSOperator);\n        formula = formula.replace(/\\*/g, '*' + this.uniqueMOperator).replace(/\\//g, '/' + this.uniqueDOperator);\n        formula = formula.replace(/&/g, '&' + this.uniqueConcateOperator);\n        formula = formula.replace(/=/g, '=' + this.uniqueEqualOperator);\n        formula = formula.replace(/\\^/g, '^' + this.uniqueExpOperator);\n        formula = formula.replace(/>/g, '>' + this.uniqueGTOperator).replace(/</g, '<' + this.uniqueLTOperator);\n        return formula.replace(/%/g, '%' + this.uniqueModOperator);\n    };\n    WorkbookFormula.prototype.refreshNamedRange = function (args, action) {\n        var isChanged = false;\n        var modelDefinedNames = this.parent.definedNames;\n        var definedNames = Object.assign({}, modelDefinedNames);\n        var definedName;\n        var definedNameCnt = modelDefinedNames.length;\n        var range;\n        var rangeIndex;\n        var count;\n        var startIndex;\n        var endIndex;\n        var newIndex;\n        var newRange;\n        var sheetName;\n        var sheetIndex;\n        var sheet;\n        for (var idx = 0; idx < definedNameCnt; idx++) {\n            definedName = definedNames[idx];\n            range = definedNames[idx].refersTo.split('!')[1];\n            rangeIndex = getRangeIndexes(range);\n            sheetName = definedName.refersTo.split('!')[0].split('=')[1];\n            sheetIndex = getSheetIndex(this.parent, sheetName.replace(/'/g, ''));\n            sheet = getSheet(this.parent, sheetIndex);\n            if (sheetIndex === this.parent.activeSheetIndex) {\n                if (args.name === 'insert') {\n                    count = args.model.length;\n                    startIndex = args.index;\n                    endIndex = args.index + count;\n                    if (args.modelType === 'Row') { // for above the named range index\n                        if ((rangeIndex[0] >= endIndex) || (rangeIndex[0] >= startIndex && rangeIndex[2] >= endIndex)) {\n                            newIndex = [rangeIndex[0] + count, rangeIndex[1], rangeIndex[2] + count, rangeIndex[3]];\n                            isChanged = true;\n                        }\n                        else if ((rangeIndex[0] <= startIndex && rangeIndex[2] >= startIndex) || (rangeIndex[2] >= endIndex)) {\n                            newIndex = [rangeIndex[0], rangeIndex[1], rangeIndex[2] + count, rangeIndex[3]];\n                            isChanged = true;\n                        }\n                    }\n                    else if (args.modelType === 'Column') {\n                        if ((rangeIndex[1] >= endIndex) || (rangeIndex[1] >= startIndex && rangeIndex[3] >= endIndex)) {\n                            newIndex = [rangeIndex[0], rangeIndex[1] + count, rangeIndex[2], rangeIndex[3] + count];\n                            isChanged = true;\n                        }\n                        else if ((rangeIndex[1] <= startIndex && rangeIndex[3] >= startIndex) || (rangeIndex[3] >= endIndex)) {\n                            newIndex = [rangeIndex[0], rangeIndex[1], rangeIndex[2], rangeIndex[3] + count];\n                            isChanged = true;\n                        }\n                    }\n                }\n                else {\n                    count = args.deletedModel.length;\n                    startIndex = args.startIndex;\n                    endIndex = args.endIndex;\n                    if (args.modelType === 'Row') { // for above the named range index\n                        if ((rangeIndex[0] >= endIndex) || (rangeIndex[0] >= startIndex && rangeIndex[2] >= endIndex)) {\n                            newIndex = [rangeIndex[0] - count, rangeIndex[1], rangeIndex[2] - count, rangeIndex[3]];\n                            isChanged = true;\n                        }\n                        else if ((rangeIndex[0] <= startIndex && rangeIndex[2] >= startIndex) || (rangeIndex[2] >= endIndex)) {\n                            newIndex = [rangeIndex[0], rangeIndex[1], rangeIndex[2] - count, rangeIndex[3]];\n                            isChanged = true;\n                        }\n                    }\n                    else if (args.modelType === 'Column') {\n                        if ((rangeIndex[1] >= endIndex) || (rangeIndex[1] >= startIndex && rangeIndex[3] >= endIndex)) {\n                            newIndex = [rangeIndex[0], rangeIndex[1] - count, rangeIndex[2], rangeIndex[3] - count];\n                            isChanged = true;\n                        }\n                        else if ((rangeIndex[1] <= startIndex && rangeIndex[3] >= startIndex) || (rangeIndex[3] >= endIndex)) {\n                            newIndex = [rangeIndex[0], rangeIndex[1], rangeIndex[2], rangeIndex[3] - count];\n                            isChanged = true;\n                        }\n                    }\n                }\n                if (isChanged) {\n                    newRange = getRangeAddress(newIndex);\n                    definedName.refersTo = sheetName + '!' + newRange;\n                    this.parent.removeDefinedName(definedName.name, definedName.scope);\n                    var eventArgs = {\n                        action: 'addDefinedName', definedName: definedName, isAdded: false\n                    };\n                    this.parent.notify(workbookFormulaOperation, eventArgs);\n                }\n            }\n            modelDefinedNames = definedNames;\n        }\n    };\n    return WorkbookFormula;\n}());\nexport { WorkbookFormula };\n","import { getCell, setCell, getData } from '../base/index';\nimport { DataManager, Query, DataUtil, Deferred } from '@syncfusion/ej2-data';\nimport { getCellIndexes, getIndexesFromAddress, getColumnHeaderText, getRangeAddress, workbookLocale } from '../common/index';\nimport { getSwapRange } from '../common/index';\nimport { initiateSort } from '../common/event';\nimport { isNullOrUndefined } from '@syncfusion/ej2-base';\n/**\n * The `WorkbookSort` module is used to handle sort action in Spreadsheet.\n */\nvar WorkbookSort = /** @class */ (function () {\n    /**\n     * Constructor for WorkbookSort module.\n     */\n    function WorkbookSort(parent) {\n        this.parent = parent;\n        this.addEventListener();\n    }\n    /**\n     * To destroy the sort module.\n     */\n    WorkbookSort.prototype.destroy = function () {\n        this.removeEventListener();\n        this.parent = null;\n    };\n    WorkbookSort.prototype.addEventListener = function () {\n        this.parent.on(initiateSort, this.initiateSortHandler, this);\n    };\n    WorkbookSort.prototype.removeEventListener = function () {\n        if (!this.parent.isDestroyed) {\n            this.parent.off(initiateSort, this.initiateSortHandler);\n        }\n    };\n    /**\n     * Sorts range of cells in the sheet.\n     * @param args - arguments for sorting.\n     */\n    WorkbookSort.prototype.initiateSortHandler = function (eventArgs) {\n        var _this = this;\n        var args = eventArgs.args;\n        var deferred = new Deferred();\n        var sheet = this.parent.getActiveSheet();\n        var range = getSwapRange(getIndexesFromAddress(args.range));\n        var sortOptions = args.sortOptions || { sortDescriptors: {}, containsHeader: true };\n        var isSingleCell = false;\n        eventArgs.promise = deferred.promise;\n        if (range[0] > sheet.usedRange.rowIndex || range[1] > sheet.usedRange.colIndex) {\n            deferred.reject(this.parent.serviceLocator.getService(workbookLocale).getConstant('SortOutOfRangeError'));\n            return;\n        }\n        var containsHeader = sortOptions.containsHeader;\n        if (range[0] === range[2]) { //if selected range is a single cell \n            range[0] = 0;\n            range[1] = 0;\n            range[2] = sheet.usedRange.rowIndex;\n            range[3] = sheet.usedRange.colIndex;\n            isSingleCell = true;\n            containsHeader = isNullOrUndefined(sortOptions.containsHeader) ? true : sortOptions.containsHeader;\n        }\n        if ((isNullOrUndefined(args.sortOptions) || isNullOrUndefined(args.sortOptions.containsHeader)) && !isSingleCell) {\n            if (!isNullOrUndefined(getCell(range[0], range[1], sheet)) && !isNullOrUndefined(getCell(range[0] + 1, range[1], sheet))) {\n                if (typeof getCell(range[0], range[1], sheet).value === typeof getCell(range[0] + 1, range[1], sheet).value) {\n                    containsHeader = false;\n                }\n                else {\n                    containsHeader = true;\n                }\n            }\n        }\n        var sRIdx = range[0] = containsHeader ? range[0] + 1 : range[0];\n        var sCIdx;\n        var eCIdx;\n        var cell = getCellIndexes(sheet.activeCell);\n        var header = getColumnHeaderText(cell[1] + 1);\n        var sortDescriptors = sortOptions.sortDescriptors;\n        var address = getRangeAddress(range);\n        getData(this.parent, sheet.name + \"!\" + address, true).then(function (jsonData) {\n            var dataManager = new DataManager(jsonData);\n            var query = new Query();\n            if (Array.isArray(sortDescriptors)) { //multi-column sorting.\n                if (!sortDescriptors || sortDescriptors.length === 0) {\n                    sortDescriptors = [{ field: header }];\n                }\n                for (var length_1 = sortDescriptors.length, i = length_1 - 1; i > -1; i--) {\n                    if (!sortDescriptors[length_1 - 1].field) {\n                        sortDescriptors[length_1 - 1].field = header;\n                    }\n                    if (!sortDescriptors[i].field) {\n                        continue;\n                    }\n                    var comparerFn = sortDescriptors[i].sortComparer\n                        || _this.sortComparer.bind(_this, sortDescriptors[i], sortOptions.caseSensitive);\n                    query.sortBy(sortDescriptors[i].field, comparerFn);\n                }\n            }\n            else { //single column sorting.\n                if (!sortDescriptors) {\n                    sortDescriptors = { field: header };\n                }\n                if (!sortDescriptors.field) {\n                    sortDescriptors.field = header;\n                }\n                var comparerFn = sortDescriptors.sortComparer\n                    || _this.sortComparer.bind(_this, sortDescriptors, sortOptions.caseSensitive);\n                query.sortBy(sortDescriptors.field, comparerFn);\n            }\n            dataManager.executeQuery(query).then(function (e) {\n                var colName;\n                var cell = {};\n                var rowKey = '__rowIndex';\n                Array.prototype.forEach.call(e.result, function (data, index) {\n                    if (!data || !jsonData[index]) {\n                        return;\n                    }\n                    sCIdx = range[1];\n                    eCIdx = range[3];\n                    sRIdx = parseInt(jsonData[index][rowKey], 10) - 1;\n                    for (sCIdx; sCIdx <= eCIdx; sCIdx++) {\n                        colName = getColumnHeaderText(sCIdx + 1);\n                        cell = data[colName];\n                        setCell(sRIdx, sCIdx, sheet, cell);\n                    }\n                });\n                var eventArgs = { range: sheet.name + \"!\" + address, sortOptions: args.sortOptions };\n                deferred.resolve(eventArgs);\n            });\n        });\n    };\n    WorkbookSort.prototype.getDataRange = function (rowIdx, colIdx, sheet) {\n        var range = [rowIdx, colIdx, rowIdx, colIdx];\n        var j;\n        var rIdx = rowIdx;\n        var cIdx = colIdx;\n        var loopLength = 0;\n        var length = sheet.usedRange.rowIndex + sheet.usedRange.colIndex;\n        for (var i = 1; i < length + 1; i++) {\n            for (j = -loopLength; j < loopLength + 1; j++) { // start from right\n                if (getCell(rIdx + j, cIdx + i, sheet)) {\n                    range[2] = range[2] > rIdx + j ? range[2] : rIdx + j;\n                    range[3] = range[3] > cIdx + i ? range[3] : cIdx + i;\n                }\n            }\n            if (getCell(rIdx + i, cIdx + i, sheet)) {\n                range[2] = range[2] > rIdx + i ? range[2] : rIdx + i;\n                range[3] = range[3] > cIdx + i ? range[3] : cIdx + i;\n            }\n            for (j = -loopLength; j < loopLength + 1; j++) {\n                if (getCell(rIdx + i, cIdx + j, sheet)) {\n                    range[2] = range[2] > rIdx + i ? range[2] : rIdx + i;\n                    range[3] = range[3] > cIdx + j ? range[3] : cIdx + j;\n                }\n            }\n            if (!getCell(rIdx, cIdx, sheet)) {\n                if (range[3] === colIdx && range[2] === rowIdx && range[0] === rowIdx && range[1] === colIdx) {\n                    if (loopLength === 0) {\n                        break;\n                    }\n                }\n            }\n            if (getCell(rIdx + i, cIdx - i, sheet)) {\n                range[2] = range[2] > rIdx + i ? range[2] : rIdx + i;\n                range[1] = range[1] < cIdx - i ? range[1] : cIdx - i;\n            }\n            for (j = -loopLength; j < loopLength + 1; j++) {\n                if (getCell(rIdx + j, cIdx - i, sheet)) {\n                    range[0] = range[0] < rIdx + j ? range[0] : rIdx + j;\n                    range[1] = range[1] < cIdx - i ? range[1] : cIdx - i;\n                    range[2] = range[2] > rIdx + j ? range[2] : rIdx + j;\n                }\n            }\n            if (getCell(rIdx - i, cIdx - i, sheet)) {\n                range[0] = range[0] < rIdx - i ? range[0] : rIdx - i;\n                range[1] = range[1] < cIdx - i ? range[1] : cIdx - i;\n            }\n            for (j = -loopLength; j < loopLength + 1; j++) {\n                if (getCell(rIdx - i, cIdx + j, sheet)) {\n                    range[0] = range[0] < rIdx - i ? range[0] : rIdx - i;\n                    range[1] = range[1] < cIdx + j ? range[1] : cIdx + j;\n                    range[3] = range[3] > cIdx + j ? range[3] : cIdx + j;\n                }\n            }\n            if (getCell(rIdx - i, cIdx + i, sheet)) {\n                range[0] = range[0] < rIdx - i ? range[0] : rIdx - i;\n                range[3] = range[3] > cIdx + i ? range[3] : cIdx + i;\n            }\n            if (range[3] === colIdx && range[2] === rowIdx && range[0] === rowIdx && range[1] === colIdx) {\n                break;\n            }\n            loopLength++;\n        }\n        return range;\n    };\n    /**\n     * Compares the two cells for sorting.\n     * @param sortDescriptor - protocol for sorting.\n     * @param caseSensitive - value for case sensitive.\n     * @param x - first cell\n     * @param y - second cell\n     */\n    WorkbookSort.prototype.sortComparer = function (sortDescriptor, caseSensitive, x, y) {\n        var direction = sortDescriptor.order || '';\n        var comparer = DataUtil.fnSort(direction);\n        var caseOptions = { sensitivity: caseSensitive ? 'case' : 'base' };\n        if (x && y && (typeof x.value === 'string' || typeof y.value === 'string')) {\n            var collator = new Intl.Collator(this.parent.locale, caseOptions);\n            if (!direction || direction.toLowerCase() === 'ascending') {\n                return collator.compare(x.value, y.value);\n            }\n            else {\n                return collator.compare(x.value, y.value) * -1;\n            }\n        }\n        return comparer(x ? x.value : x, y ? y.value : y);\n    };\n    /**\n     * Gets the module name.\n     * @returns string\n     */\n    WorkbookSort.prototype.getModuleName = function () {\n        return 'workbookSort';\n    };\n    return WorkbookSort;\n}());\nexport { WorkbookSort };\n","import { getData } from '../base/index';\nimport { DataManager, Query, Deferred, Predicate } from '@syncfusion/ej2-data';\nimport { getCellIndexes, getIndexesFromAddress, getSwapRange, getRangeAddress } from '../common/index';\nimport { initiateFilter, clearAllFilter } from '../common/event';\n/**\n * The `WorkbookFilter` module is used to handle filter action in Spreadsheet.\n */\nvar WorkbookFilter = /** @class */ (function () {\n    /**\n     * Constructor for WorkbookFilter module.\n     */\n    function WorkbookFilter(parent) {\n        this.parent = parent;\n        this.addEventListener();\n    }\n    /**\n     * To destroy the filter module.\n     */\n    WorkbookFilter.prototype.destroy = function () {\n        this.removeEventListener();\n        this.filterRange = null;\n        this.parent = null;\n    };\n    WorkbookFilter.prototype.addEventListener = function () {\n        this.parent.on(initiateFilter, this.initiateFilterHandler, this);\n        this.parent.on(clearAllFilter, this.clearAllFilterHandler, this);\n    };\n    WorkbookFilter.prototype.removeEventListener = function () {\n        if (!this.parent.isDestroyed) {\n            this.parent.off(initiateFilter, this.initiateFilterHandler);\n            this.parent.off(clearAllFilter, this.clearAllFilterHandler);\n        }\n    };\n    /**\n     * Filters a range of cells in the sheet.\n     * @param args - arguments for filtering.\n     */\n    WorkbookFilter.prototype.initiateFilterHandler = function (eventArgs) {\n        var _this = this;\n        var args = eventArgs.args;\n        var deferred = new Deferred();\n        var sheet = this.parent.getActiveSheet();\n        var filterOptions = args.filterOptions || {};\n        eventArgs.promise = deferred.promise;\n        this.filterRange = args.range;\n        if (filterOptions.datasource) {\n            this.setFilter(filterOptions.datasource, filterOptions.predicates);\n            var filterEventArgs = { range: args.range, filterOptions: filterOptions };\n            deferred.resolve(filterEventArgs);\n        }\n        else {\n            var range = getSwapRange(getIndexesFromAddress(args.range));\n            if (range[0] > sheet.usedRange.rowIndex || range[1] > sheet.usedRange.colIndex) {\n                deferred.reject('Select a cell or range inside the used range and try again.');\n                return;\n            }\n            if (range[0] === range[2] && (range[2] - range[0]) === 0) { //if selected range is a single cell \n                range[0] = 0;\n                range[1] = 0;\n                range[3] = sheet.usedRange.colIndex;\n            }\n            range[2] = sheet.usedRange.rowIndex; //filter range should be till used range.\n            range[0] = range[0] + 1; //ignore first row        \n            var address_1 = getRangeAddress(range);\n            getData(this.parent, sheet.name + \"!\" + address_1, true, true).then(function (jsonData) {\n                var dataManager = new DataManager(jsonData);\n                _this.setFilter(dataManager, filterOptions.predicates);\n                var filterEventArgs = { range: address_1, filterOptions: filterOptions };\n                deferred.resolve(filterEventArgs);\n            });\n        }\n    };\n    /**\n     * Hides or unhides the rows based on the filter predicates.\n     */\n    WorkbookFilter.prototype.setFilter = function (dataManager, predicates) {\n        var _this = this;\n        if (dataManager && predicates) {\n            var jsonData = dataManager.dataSource.json;\n            var query = new Query();\n            if (predicates.length) {\n                query.where(Predicate.and(predicates));\n            }\n            var result_1 = dataManager.executeLocal(query);\n            var rowKey_1 = '__rowIndex';\n            jsonData.forEach(function (data, index) {\n                if (!data) {\n                    return;\n                }\n                _this.parent.hideRow(parseInt(data[rowKey_1], 10) - 1, undefined, result_1.indexOf(data) < 0);\n            });\n        }\n    };\n    /**\n     * Clears all the filters in the sheet.\n     */\n    WorkbookFilter.prototype.clearAllFilterHandler = function () {\n        if (this.filterRange) {\n            var range = getCellIndexes(this.filterRange);\n            var sheet = this.parent.getActiveSheet();\n            this.parent.hideRow(range[0], sheet.usedRange.rowIndex - 1, false);\n        }\n    };\n    /**\n     * Gets the module name.\n     * @returns string\n     */\n    WorkbookFilter.prototype.getModuleName = function () {\n        return 'workbookFilter';\n    };\n    return WorkbookFilter;\n}());\nexport { WorkbookFilter };\n","import { getRangeIndexes } from '../common/index';\nimport { getCell, setCell, getSheetIndex } from '../base/index';\nimport { setImage } from '../common/event';\n/**\n * Specifies image.\n */\nvar WorkbookImage = /** @class */ (function () {\n    function WorkbookImage(parent) {\n        this.parent = parent;\n        this.addEventListener();\n    }\n    WorkbookImage.prototype.setImage = function (args) {\n        var imgRange = args.range ? (args.range.indexOf('!') > 0) ? args.range.split('!')[1] : args.range.split('!')[0]\n            : this.parent.getActiveSheet().selectedRange;\n        var sheetIdx = (args.range && args.range.indexOf('!') > 0) ?\n            getSheetIndex(this.parent, args.range.split('!')[0]) : this.parent.activeSheetIndex;\n        var indexes = getRangeIndexes(imgRange);\n        var sheet = sheetIdx ? this.parent.sheets[sheetIdx] : this.parent.getActiveSheet();\n        var cell = getCell(indexes[0], indexes[1], sheet);\n        var oldImgData;\n        var imgData = args.options;\n        if (cell && cell.image) {\n            oldImgData = cell.image;\n            for (var i = 0; i < imgData.length; i++) {\n                oldImgData.push(imgData[i]);\n            }\n        }\n        setCell(indexes[0], indexes[1], sheet, { image: (cell && cell.image) ? oldImgData : imgData }, true);\n    };\n    /**\n     * Adding event listener for number format.\n     */\n    WorkbookImage.prototype.addEventListener = function () {\n        this.parent.on(setImage, this.setImage, this);\n    };\n    /**\n     * Removing event listener for number format.\n     */\n    WorkbookImage.prototype.removeEventListener = function () {\n        if (!this.parent.isDestroyed) {\n            this.parent.off(setImage, this.setImage);\n        }\n    };\n    /**\n     * To Remove the event listeners.\n     */\n    WorkbookImage.prototype.destroy = function () {\n        this.removeEventListener();\n        this.parent = null;\n    };\n    /**\n     * Get the workbook number format module name.\n     */\n    WorkbookImage.prototype.getModuleName = function () {\n        return 'workbookImage';\n    };\n    return WorkbookImage;\n}());\nexport { WorkbookImage };\n","import { getRangeIndexes, inRange } from '../common/index';\nimport { setCell, getSheetIndex, getCell, getSheetNameFromAddress } from '../base/index';\nimport { setChart, initiateChart, refreshChart, updateChart, deleteChartColl, refreshChartSize, focusChartBorder } from '../common/event';\nimport { closest, isNullOrUndefined, getComponent } from '@syncfusion/ej2-base';\n/**\n * The `WorkbookChart` module is used to handle chart action in Spreadsheet.\n */\nvar WorkbookChart = /** @class */ (function () {\n    /**\n     * Constructor for WorkbookChart module.\n     */\n    function WorkbookChart(parent) {\n        this.parent = parent;\n        this.addEventListener();\n    }\n    WorkbookChart.prototype.addEventListener = function () {\n        this.parent.on(setChart, this.setChartHandler, this);\n        this.parent.on(refreshChart, this.refreshChartData, this);\n        this.parent.on(deleteChartColl, this.deleteChartColl, this);\n        this.parent.on(refreshChartSize, this.refreshChartSize, this);\n        this.parent.on(focusChartBorder, this.focusChartBorder, this);\n    };\n    WorkbookChart.prototype.removeEventListener = function () {\n        if (!this.parent.isDestroyed) {\n            this.parent.off(setChart, this.setChartHandler);\n            this.parent.off(refreshChart, this.refreshChartData);\n            this.parent.off(deleteChartColl, this.deleteChartColl);\n            this.parent.off(refreshChartSize, this.refreshChartSize);\n            this.parent.off(focusChartBorder, this.focusChartBorder);\n        }\n    };\n    WorkbookChart.prototype.setChartHandler = function (args) {\n        var i = 0;\n        args.isInitCell = isNullOrUndefined(args.isInitCell) ? false : args.isInitCell;\n        args.isUndoRedo = isNullOrUndefined(args.isUndoRedo) ? true : args.isUndoRedo;\n        args.isPaste = isNullOrUndefined(args.isPaste) ? false : args.isPaste;\n        var chart = args.chart;\n        if (chart.length > 0) {\n            while (i < chart.length) {\n                if (args.isCut === false) {\n                    if (document.getElementById(args.chart[i].id)) {\n                        chart[i] = {\n                            range: chart[i].range, id: 'e_spreadsheet_chart_' + this.parent.chartCount,\n                            isSeriesInRows: chart[i].isSeriesInRows, theme: chart[i].theme, type: chart[i].type\n                        };\n                        chart[i].id = 'e_spreadsheet_chart_' + this.parent.chartCount;\n                        args.isIdAvailabe = false;\n                    }\n                }\n                if (document.getElementById(args.chart[i].id)) {\n                    return;\n                }\n                var idAvailable = isNullOrUndefined(args.isIdAvailabe) ? true : args.isIdAvailabe;\n                chart[i].theme = chart[i].theme || 'Material';\n                chart[i].type = chart[i].type || 'Line';\n                chart[i].isSeriesInRows = chart[i].isSeriesInRows || false;\n                chart[i].range = chart[i].range || this.parent.getActiveSheet().selectedRange;\n                if (chart[i].range.indexOf('!') < 0) {\n                    chart[i].range = this.parent.getActiveSheet().name + '!' + chart[i].range;\n                }\n                if (isNullOrUndefined(chart[i].id)) {\n                    chart[i].id = 'e_spreadsheet_chart_' + this.parent.chartCount;\n                    idAvailable = false;\n                }\n                this.parent.notify(initiateChart, {\n                    option: chart[i], chartCount: this.parent.chartCount, isInitCell: args.isInitCell, isUndoRedo: args.isUndoRedo,\n                    dataSheetIdx: args.dataSheetIdx, range: args.range\n                });\n                this.parent.chartColl.push(chart[i]);\n                if (!idAvailable) {\n                    this.parent.chartCount++;\n                }\n                if (!args.isInitCell || args.isPaste) {\n                    var sheetIdx = (chart[i].range && chart[i].range.indexOf('!') > 0) ?\n                        getSheetIndex(this.parent, chart[i].range.split('!')[0]) : this.parent.activeSheetIndex;\n                    var indexes = args.isPaste ? getRangeIndexes(args.range) : getRangeIndexes(chart[i].range);\n                    var sheet = sheetIdx ? this.parent.sheets[sheetIdx] : this.parent.getActiveSheet();\n                    var cell = getCell(indexes[0], indexes[1], sheet);\n                    if (cell && cell.chart) {\n                        cell.chart.push(chart[i]);\n                    }\n                    else {\n                        setCell(indexes[0], indexes[1], sheet, { chart: [chart[i]] }, true);\n                    }\n                }\n                i++;\n            }\n        }\n    };\n    WorkbookChart.prototype.refreshChartData = function (args) {\n        var i;\n        var j = 1;\n        var cnt = this.parent.sheets.length + 1;\n        while (j < cnt) {\n            var charts = this.parent.chartColl;\n            i = charts ? charts.length : 0;\n            if (i) {\n                while (i--) {\n                    var chart = this.parent.chartColl[i];\n                    var isInRange = inRange(getRangeIndexes(chart.range), args.rIdx, args.cIdx);\n                    var rangeSheetIdx = chart.range.indexOf('!') > -1 ?\n                        getSheetIndex(this.parent, getSheetNameFromAddress(chart.range)) : this.parent.activeSheetIndex;\n                    if (isInRange && rangeSheetIdx === this.parent.activeSheetIndex) {\n                        this.parent.notify(updateChart, { chart: chart });\n                    }\n                }\n            }\n            j++;\n        }\n    };\n    WorkbookChart.prototype.refreshChartSize = function (args) {\n        var chartCnt;\n        var j = 1;\n        var sheetCnt = this.parent.sheets.length + 1;\n        while (j < sheetCnt) {\n            var charts = this.parent.chartColl;\n            chartCnt = charts ? charts.length : 0;\n            if (chartCnt) {\n                while (chartCnt--) {\n                    var chart = this.parent.chartColl[chartCnt];\n                    if (!isNullOrUndefined(args.overlayEle.querySelector('#' + chart.id))) {\n                        var chartObj = this.parent.element.querySelector('.' + chart.id);\n                        var excelFilter = getComponent(chartObj, 'chart');\n                        excelFilter.height = args.height;\n                        excelFilter.width = args.width;\n                    }\n                }\n            }\n            j++;\n        }\n    };\n    WorkbookChart.prototype.focusChartBorder = function (args) {\n        for (var idx = 0; idx < this.parent.chartColl.length; idx++) {\n            var overlayEle = document.getElementById(args.id);\n            var chartEle = document.getElementById(this.parent.chartColl[idx].id);\n            if (overlayEle && chartEle && closest(chartEle, '.' + overlayEle.classList[1]) === overlayEle) {\n                this.parent.notify(initiateChart, {\n                    option: this.parent.chartColl[idx], chartCount: this.parent.chartCount, isRefresh: true\n                });\n            }\n        }\n    };\n    WorkbookChart.prototype.deleteChartColl = function (args) {\n        for (var idx = 0; idx < this.parent.chartColl.length; idx++) {\n            var chartElement = document.getElementById(this.parent.chartColl[idx].id);\n            var overlayElement = document.getElementById(args.id);\n            if (overlayElement && chartElement && closest(chartElement, '.' + overlayElement.classList[1]) === overlayElement) {\n                this.parent.chartColl.splice(idx, 1);\n            }\n        }\n    };\n    /**\n     * To Remove the event listeners.\n     */\n    WorkbookChart.prototype.destroy = function () {\n        this.removeEventListener();\n        this.parent = null;\n    };\n    /**\n     * Get the workbook chart module name.\n     */\n    WorkbookChart.prototype.getModuleName = function () {\n        return 'workbookChart';\n    };\n    return WorkbookChart;\n}());\nexport { WorkbookChart };\n","import { getRangeIndexes, setCellFormat, applyCellFormat, activeCellChanged } from '../common/index';\nimport { getSwapRange, textDecorationUpdate } from '../common/index';\nimport { clear, getIndexesFromAddress } from '../common/index';\nimport { getSheetIndex, isHiddenRow, getSheet, getCell, setCell } from '../base/index';\n/**\n * Workbook Cell format.\n */\nvar WorkbookCellFormat = /** @class */ (function () {\n    function WorkbookCellFormat(parent) {\n        this.parent = parent;\n        this.addEventListener();\n    }\n    WorkbookCellFormat.prototype.format = function (args) {\n        var sheet;\n        var rng = args.range;\n        var eventArgs;\n        if (rng && typeof rng === 'string' && rng.indexOf('!') > -1) {\n            rng = rng.split('!')[1];\n            sheet = this.parent.sheets[getSheetIndex(this.parent, args.range.split('!')[0])];\n        }\n        else {\n            sheet = this.parent.getActiveSheet();\n        }\n        if (rng === undefined) {\n            rng = sheet.selectedRange;\n        }\n        var triggerEvent = typeof (rng) !== 'object' && args.onActionUpdate;\n        eventArgs = { range: rng, style: args.style, requestType: 'CellFormat' };\n        if (triggerEvent) {\n            this.parent.trigger('beforeCellFormat', eventArgs);\n            this.parent.notify('actionBegin', { eventArgs: eventArgs, action: 'format' });\n            if (eventArgs.cancel) {\n                args.cancel = true;\n                return;\n            }\n        }\n        var indexes = typeof (eventArgs.range) === 'object' ? eventArgs.range :\n            getSwapRange(getRangeIndexes(eventArgs.range));\n        if (args.borderType) {\n            this.setTypedBorder(sheet, args.style.border, indexes, args.borderType, args.onActionUpdate);\n            delete args.style.border;\n        }\n        if (eventArgs.style.borderTop !== undefined) {\n            for (var i = indexes[1]; i <= indexes[3]; i++) {\n                this.checkAdjustantBorder(sheet, 'borderBottom', indexes[0] - 1, i);\n                this.checkFullBorder(sheet, 'borderBottom', indexes[0] - 1, i);\n                this.checkFullBorder(sheet, 'borderTop', indexes[0], i);\n                this.setCellBorder(sheet, { borderTop: eventArgs.style.borderTop }, indexes[0], i, args.onActionUpdate, i === indexes[3]);\n            }\n            delete eventArgs.style.borderTop;\n        }\n        if (eventArgs.style.borderBottom !== undefined) {\n            for (var i = indexes[1]; i <= indexes[3]; i++) {\n                this.checkAdjustantBorder(sheet, 'borderTop', indexes[2] + 1, i);\n                this.checkFullBorder(sheet, 'borderTop', indexes[2] + 1, i);\n                this.checkFullBorder(sheet, 'borderBottom', indexes[2], i);\n                this.setCellBorder(sheet, { borderBottom: eventArgs.style.borderBottom }, indexes[2], i, args.onActionUpdate, i === indexes[3]);\n                this.setBottomBorderPriority(sheet, indexes[2], i);\n            }\n            delete eventArgs.style.borderBottom;\n        }\n        if (eventArgs.style.borderLeft !== undefined) {\n            for (var i = indexes[0]; i <= indexes[2]; i++) {\n                this.checkAdjustantBorder(sheet, 'borderRight', i, indexes[1] - 1);\n                this.checkFullBorder(sheet, 'borderRight', i, indexes[1] - 1);\n                this.checkFullBorder(sheet, 'borderLeft', i, indexes[1]);\n                this.setCellBorder(sheet, { borderLeft: eventArgs.style.borderLeft }, i, indexes[1], args.onActionUpdate);\n            }\n            delete eventArgs.style.borderLeft;\n        }\n        if (eventArgs.style.borderRight !== undefined) {\n            for (var i = indexes[0]; i <= indexes[2]; i++) {\n                this.checkAdjustantBorder(sheet, 'borderLeft', i, indexes[3] - 1);\n                this.checkFullBorder(sheet, 'borderLeft', i, indexes[3] - 1);\n                this.checkFullBorder(sheet, 'borderRight', i, indexes[3]);\n                this.setCellBorder(sheet, { borderRight: eventArgs.style.borderRight }, i, indexes[3], args.onActionUpdate);\n            }\n            delete eventArgs.style.borderRight;\n        }\n        var border;\n        var isFullBorder;\n        if (Object.keys(args.style).length) {\n            for (var i = indexes[0]; i <= indexes[2]; i++) {\n                for (var j = indexes[1]; j <= indexes[3]; j++) {\n                    if (isFullBorder === undefined) {\n                        if (eventArgs.style.border !== undefined) {\n                            border = eventArgs.style.border;\n                            eventArgs.style.border = undefined;\n                            isFullBorder = true;\n                        }\n                        else {\n                            isFullBorder = false;\n                        }\n                    }\n                    if (isFullBorder) {\n                        this.setFullBorder(sheet, border, indexes, i, j, args.onActionUpdate);\n                    }\n                    this.setCellStyle(sheet, i, j, eventArgs.style);\n                    if (this.parent.getActiveSheet().id === sheet.id) {\n                        this.parent.notify(applyCellFormat, { style: eventArgs.style, rowIdx: i, colIdx: j,\n                            lastCell: j === indexes[3], isHeightCheckNeeded: true, manualUpdate: true, onActionUpdate: args.onActionUpdate\n                        });\n                    }\n                }\n            }\n        }\n        if (isFullBorder) {\n            eventArgs.style.border = border;\n        }\n        this.parent.setUsedRange(indexes[2], indexes[3]);\n        if (args.refreshRibbon) {\n            this.parent.notify(activeCellChanged, null);\n        }\n        if (triggerEvent) {\n            eventArgs.range = sheet.name + \"!\" + rng;\n            this.parent.notify('actionComplete', { eventArgs: eventArgs, action: 'format' });\n        }\n    };\n    WorkbookCellFormat.prototype.setBottomBorderPriority = function (sheet, rowIdx, colIdx) {\n        if (isHiddenRow(sheet, rowIdx + 1)) {\n            var pIdx = this.skipHiddenRows(sheet, rowIdx + 1);\n            var pCellStyle = this.parent.getCellStyleValue(['borderTop'], [pIdx, colIdx]).borderTop;\n            if (pCellStyle !== '') {\n                sheet.rows[rowIdx].cells[colIdx].style.bottomPriority = true;\n            }\n        }\n    };\n    WorkbookCellFormat.prototype.setFullBorder = function (sheet, border, indexes, i, j, actionUpdate) {\n        var style = {};\n        if (i === indexes[0]) {\n            this.checkAdjustantBorder(sheet, 'borderBottom', i - 1, j);\n            this.checkFullBorder(sheet, 'borderBottom', i - 1, j);\n        }\n        if (j === indexes[1]) {\n            this.checkAdjustantBorder(sheet, 'borderRight', i, j - 1);\n            this.checkFullBorder(sheet, 'borderRight', i, j - 1);\n        }\n        if (j === indexes[3]) {\n            this.checkAdjustantBorder(sheet, 'borderLeft', i, j + 1);\n            this.checkFullBorder(sheet, 'borderLeft', i, j + 1);\n        }\n        else {\n            this.checkAdjustantBorder(sheet, 'border', i, j + 1);\n        }\n        style.borderRight = border;\n        style.borderTop = border;\n        style.borderLeft = border;\n        style.borderBottom = border;\n        this.setCellBorder(sheet, style, i, j, actionUpdate, j === indexes[3]);\n        if (i === indexes[2]) {\n            this.checkAdjustantBorder(sheet, 'borderTop', i + 1, j);\n            this.checkFullBorder(sheet, 'borderTop', i + 1, j);\n            this.setBottomBorderPriority(sheet, i, j);\n        }\n        else {\n            this.checkAdjustantBorder(sheet, 'border', i + 1, j);\n        }\n    };\n    WorkbookCellFormat.prototype.checkAdjustantBorder = function (sheet, prop, rowIdx, colIdx) {\n        var style = {};\n        if (this.parent.getCellStyleValue([prop], [rowIdx, colIdx])[prop] !== '') {\n            style[prop] = undefined;\n            this.setCellStyle(sheet, rowIdx, colIdx, style);\n        }\n    };\n    WorkbookCellFormat.prototype.checkFullBorder = function (sheet, prop, rowIdx, colIdx) {\n        var border = this.parent.getCellStyleValue(['border'], [rowIdx, colIdx]).border;\n        if (border !== '') {\n            var style_1 = { border: undefined };\n            ['borderBottom', 'borderTop', 'borderLeft', 'borderRight'].forEach(function (value) {\n                if (value !== prop) {\n                    style_1[value] = border;\n                }\n            });\n            this.setCellStyle(sheet, rowIdx, colIdx, style_1);\n        }\n    };\n    WorkbookCellFormat.prototype.textDecorationActionUpdate = function (args) {\n        var sheet = this.parent.getActiveSheet();\n        var eventArgs = { range: sheet.selectedRange, style: args.style, requestType: 'CellFormat' };\n        this.parent.trigger('beforeCellFormat', eventArgs);\n        this.parent.notify('actionBegin', { eventArgs: eventArgs, action: 'format' });\n        if (eventArgs.cancel) {\n            args.cancel = true;\n            return;\n        }\n        var indexes = getSwapRange(getRangeIndexes(sheet.selectedRange));\n        var value = args.style.textDecoration;\n        var changedValue = value;\n        var activeCellIndexes = getRangeIndexes(sheet.activeCell);\n        var cellValue = this.parent.getCellStyleValue(['textDecoration'], activeCellIndexes).textDecoration;\n        var changedStyle;\n        var removeProp = false;\n        if (cellValue === 'underline') {\n            changedValue = value === 'underline' ? 'none' : 'underline line-through';\n        }\n        else if (cellValue === 'line-through') {\n            changedValue = value === 'line-through' ? 'none' : 'underline line-through';\n        }\n        else if (cellValue === 'underline line-through') {\n            changedValue = value === 'underline' ? 'line-through' : 'underline';\n            removeProp = true;\n        }\n        if (changedValue === 'none') {\n            removeProp = true;\n        }\n        this.format({\n            style: { textDecoration: changedValue }, range: activeCellIndexes, refreshRibbon: args.refreshRibbon,\n            onActionUpdate: true\n        });\n        for (var i = indexes[0]; i <= indexes[2]; i++) {\n            for (var j = indexes[1]; j <= indexes[3]; j++) {\n                if (i === activeCellIndexes[0] && j === activeCellIndexes[1]) {\n                    continue;\n                }\n                changedStyle = {};\n                cellValue = this.parent.getCellStyleValue(['textDecoration'], [i, j]).textDecoration;\n                if (cellValue === 'none') {\n                    if (removeProp) {\n                        continue;\n                    }\n                    changedStyle.textDecoration = value;\n                }\n                else if (cellValue === 'underline' || cellValue === 'line-through') {\n                    if (removeProp) {\n                        if (value === cellValue) {\n                            changedStyle.textDecoration = 'none';\n                        }\n                        else {\n                            continue;\n                        }\n                    }\n                    else {\n                        changedStyle.textDecoration = value !== cellValue ? 'underline line-through' : value;\n                    }\n                }\n                else if (cellValue === 'underline line-through') {\n                    if (removeProp) {\n                        changedStyle.textDecoration = value === 'underline' ? 'line-through' : 'underline';\n                    }\n                    else {\n                        continue;\n                    }\n                }\n                this.format({\n                    style: changedStyle, range: [i, j, i, j], refreshRibbon: args.refreshRibbon,\n                    onActionUpdate: true\n                });\n            }\n        }\n        eventArgs.range = sheet.name + '!' + eventArgs.range;\n        this.parent.notify('actionComplete', { eventArgs: eventArgs, action: 'format' });\n    };\n    WorkbookCellFormat.prototype.setTypedBorder = function (sheet, border, range, type, actionUpdate) {\n        var prevBorder;\n        if (type === 'Outer') {\n            for (var colIdx = range[1]; colIdx <= range[3]; colIdx++) {\n                this.checkAdjustantBorder(sheet, 'borderBottom', range[0] - 1, colIdx);\n                this.checkFullBorder(sheet, 'borderBottom', range[0] - 1, colIdx);\n                this.setCellBorder(sheet, { borderTop: border }, range[0], colIdx, actionUpdate, colIdx === range[3]);\n                this.checkAdjustantBorder(sheet, 'borderTop', range[2] + 1, colIdx);\n                this.checkFullBorder(sheet, 'borderTop', range[2] + 1, colIdx);\n                this.setCellBorder(sheet, { borderBottom: border }, range[2], colIdx, actionUpdate, colIdx === range[3]);\n                this.setBottomBorderPriority(sheet, range[2], colIdx);\n            }\n            for (var rowIdx = range[0]; rowIdx <= range[2]; rowIdx++) {\n                this.checkAdjustantBorder(sheet, 'borderRight', rowIdx, range[1] - 1);\n                this.checkFullBorder(sheet, 'borderRight', rowIdx, range[1] - 1);\n                this.setCellBorder(sheet, { borderLeft: border }, rowIdx, range[1], actionUpdate);\n                this.checkAdjustantBorder(sheet, 'borderLeft', rowIdx, range[3] + 1);\n                this.checkFullBorder(sheet, 'borderLeft', rowIdx, range[3] + 1);\n                this.setCellBorder(sheet, { borderRight: border }, rowIdx, range[3], actionUpdate);\n            }\n        }\n        else if (type === 'Inner') {\n            for (var i = range[0]; i <= range[2]; i++) {\n                for (var j = range[1]; j <= range[3]; j++) {\n                    var style = {};\n                    prevBorder = this.parent.getCellStyleValue(['border'], [i, j]).border;\n                    if (prevBorder !== '') {\n                        style.border = undefined;\n                        if (j === range[3] || j === range[1] || i === range[0] || i === range[2]) {\n                            if (i === range[0]) {\n                                style.borderTop = prevBorder;\n                            }\n                            if (i === range[2]) {\n                                style.borderBottom = prevBorder;\n                            }\n                            if (j === range[3]) {\n                                style.borderRight = prevBorder;\n                            }\n                            if (j === range[1]) {\n                                style.borderLeft = prevBorder;\n                            }\n                        }\n                    }\n                    if (j !== range[3]) {\n                        style.borderRight = border;\n                    }\n                    if (i !== range[0]) {\n                        style.borderTop = border;\n                    }\n                    if (i !== range[2]) {\n                        style.borderBottom = border;\n                    }\n                    if (j !== range[1]) {\n                        style.borderLeft = border;\n                    }\n                    this.setCellBorder(sheet, style, i, j, actionUpdate, j === range[3]);\n                }\n            }\n        }\n        else if (type === 'Vertical') {\n            for (var i = range[0]; i <= range[2]; i++) {\n                for (var j = range[1]; j <= range[3]; j++) {\n                    var style = { borderRight: border, borderLeft: border };\n                    if (j === range[1]) {\n                        this.checkAdjustantBorder(sheet, 'borderRight', i, j - 1);\n                        this.checkFullBorder(sheet, 'borderRight', i, j - 1);\n                    }\n                    if (j === range[3]) {\n                        this.checkAdjustantBorder(sheet, 'borderLeft', i, j + 1);\n                        this.checkFullBorder(sheet, 'borderLeft', i, j + 1);\n                    }\n                    this.setCellBorder(sheet, style, i, j, actionUpdate);\n                }\n            }\n        }\n        else {\n            for (var i = range[0]; i <= range[2]; i++) {\n                for (var j = range[1]; j <= range[3]; j++) {\n                    var style = { borderTop: border, borderBottom: border };\n                    if (i === range[0]) {\n                        this.checkAdjustantBorder(sheet, 'borderBottom', i - 1, j);\n                        this.checkFullBorder(sheet, 'borderBottom', i - 1, j);\n                    }\n                    this.setCellBorder(sheet, style, i, j, actionUpdate, j === range[3]);\n                    if (i === range[2]) {\n                        this.checkAdjustantBorder(sheet, 'borderTop', i + 1, j);\n                        this.checkFullBorder(sheet, 'borderTop', i + 1, j);\n                        this.setBottomBorderPriority(sheet, i, j);\n                    }\n                }\n            }\n        }\n    };\n    WorkbookCellFormat.prototype.setCellBorder = function (sheet, style, rowIdx, colIdx, actionUpdate, lastCell) {\n        this.setCellStyle(sheet, rowIdx, colIdx, style);\n        if (this.parent.getActiveSheet().id === sheet.id) {\n            this.parent.notify(applyCellFormat, {\n                style: style, rowIdx: rowIdx, colIdx: colIdx, onActionUpdate: actionUpdate, first: '', lastCell: lastCell,\n                isHeightCheckNeeded: true, manualUpdate: true\n            });\n        }\n    };\n    WorkbookCellFormat.prototype.setCellStyle = function (sheet, rowIdx, colIdx, style) {\n        if (!sheet.rows[rowIdx]) {\n            sheet.rows[rowIdx] = { cells: [] };\n        }\n        else if (!sheet.rows[rowIdx].cells) {\n            sheet.rows[rowIdx].cells = [];\n        }\n        if (!sheet.rows[rowIdx].cells[colIdx]) {\n            sheet.rows[rowIdx].cells[colIdx] = {};\n        }\n        if (!sheet.rows[rowIdx].cells[colIdx].style) {\n            sheet.rows[rowIdx].cells[colIdx].style = {};\n        }\n        Object.assign(sheet.rows[rowIdx].cells[colIdx].style, style, null, true);\n    };\n    WorkbookCellFormat.prototype.skipHiddenRows = function (sheet, startIdx) {\n        startIdx++;\n        if (isHiddenRow(sheet, startIdx)) {\n            startIdx = this.skipHiddenRows(sheet, startIdx);\n        }\n        return startIdx;\n    };\n    WorkbookCellFormat.prototype.addEventListener = function () {\n        this.parent.on(setCellFormat, this.format, this);\n        this.parent.on(textDecorationUpdate, this.textDecorationActionUpdate, this);\n        this.parent.on(clear, this.clearCellObj, this);\n    };\n    WorkbookCellFormat.prototype.removeEventListener = function () {\n        if (!this.parent.isDestroyed) {\n            this.parent.off(setCellFormat, this.format);\n            this.parent.off(textDecorationUpdate, this.textDecorationActionUpdate);\n            this.parent.off(clear, this.clearCellObj);\n        }\n    };\n    WorkbookCellFormat.prototype.clearCellObj = function (options) {\n        var clrRange = options.range ? (options.range.indexOf('!') > 0) ? options.range.split('!')[1] : options.range.split('!')[0]\n            : this.parent.getActiveSheet().selectedRange;\n        var sheetIdx = (options.range && options.range.indexOf('!') > 0) ?\n            getSheetIndex(this.parent, options.range.split('!')[0]) : this.parent.activeSheetIndex;\n        var sheet = getSheet(this.parent, sheetIdx);\n        var range = getIndexesFromAddress(clrRange);\n        var sRowIdx = range[0];\n        var eRowIdx = range[2];\n        var sColIdx;\n        var eColIdx;\n        for (sRowIdx; sRowIdx <= eRowIdx; sRowIdx++) {\n            sColIdx = range[1];\n            eColIdx = range[3];\n            for (sColIdx; sColIdx <= eColIdx; sColIdx++) {\n                var cell = getCell(sRowIdx, sColIdx, sheet);\n                if (cell) {\n                    switch (options.type) {\n                        case 'Clear Formats':\n                            delete cell.format;\n                            delete cell.rowSpan;\n                            delete cell.style;\n                            delete cell.wrap;\n                            delete cell.colSpan;\n                            break;\n                        case 'Clear Contents':\n                            delete cell.value;\n                            delete cell.formula;\n                            break;\n                        case 'Clear Hyperlinks':\n                            delete cell.hyperlink;\n                            break;\n                        case 'Clear All':\n                            setCell(sRowIdx, sColIdx, sheet, {}, false);\n                            break;\n                    }\n                }\n            }\n        }\n    };\n    /**\n     * To destroy workbook cell format.\n     */\n    WorkbookCellFormat.prototype.destroy = function () {\n        this.removeEventListener();\n        this.parent = null;\n    };\n    /**\n     * Get the workbook cell format module name.\n     */\n    WorkbookCellFormat.prototype.getModuleName = function () {\n        return 'workbookcellformat';\n    };\n    return WorkbookCellFormat;\n}());\nexport { WorkbookCellFormat };\n","import { getCell, getSheet } from '../base/index';\nimport { workbookEditOperation, checkDateFormat, workbookFormulaOperation, refreshChart } from '../common/event';\nimport { getRangeIndexes } from '../common/index';\nimport { isNullOrUndefined, getNumericObject } from '@syncfusion/ej2-base';\nimport { checkIsFormula } from '../../workbook/common/index';\nimport { getTypeFromFormat } from '../integrations/index';\n/**\n * The `WorkbookEdit` module is used to handle the editing functionalities in Workbook.\n */\nvar WorkbookEdit = /** @class */ (function () {\n    /**\n     * Constructor for edit module in Workbook.\n     * @private\n     */\n    function WorkbookEdit(workbook) {\n        this.parent = workbook;\n        this.localeObj = getNumericObject(this.parent.locale);\n        /* tslint:disable:no-any */\n        this.decimalSep = this.localeObj.decimal;\n        this.addEventListener();\n    }\n    /**\n     * To destroy the edit module.\n     * @return {void}\n     * @hidden\n     */\n    WorkbookEdit.prototype.destroy = function () {\n        this.removeEventListener();\n        this.parent = null;\n    };\n    WorkbookEdit.prototype.addEventListener = function () {\n        this.parent.on(workbookEditOperation, this.performEditOperation, this);\n    };\n    WorkbookEdit.prototype.removeEventListener = function () {\n        if (!this.parent.isDestroyed) {\n            this.parent.off(workbookEditOperation, this.performEditOperation);\n        }\n    };\n    /**\n     * Get the module name.\n     * @returns string\n     * @private\n     */\n    WorkbookEdit.prototype.getModuleName = function () {\n        return 'workbookEdit';\n    };\n    WorkbookEdit.prototype.performEditOperation = function (args) {\n        var action = args.action;\n        switch (action) {\n            case 'updateCellValue':\n                this.updateCellValue(args.address, args.value, args.sheetIndex, args.isValueOnly);\n                break;\n        }\n    };\n    WorkbookEdit.prototype.checkDecimalPoint = function (value) {\n        if (Number(value)) {\n            var decIndex = value.toString().indexOf(this.decimalSep) + 1;\n            var checkDec = value.toString().substr(decIndex).length <= 6;\n            value = checkDec ? decIndex < 7 ? value : (parseFloat(value)).toFixed(0) : decIndex > 7 ? (parseFloat(value)).toFixed(0) :\n                (parseFloat(value)).toFixed(6 - decIndex + 2);\n        }\n        return value;\n    };\n    WorkbookEdit.prototype.updateCellValue = function (address, value, sheetIdx, isValueOnly) {\n        if (isValueOnly === void 0) { isValueOnly = false; }\n        if (sheetIdx === undefined) {\n            sheetIdx = this.parent.activeSheetIndex;\n        }\n        var range;\n        if (typeof address === 'string') {\n            range = getRangeIndexes(address);\n        }\n        else {\n            range = address;\n        }\n        var sheet = getSheet(this.parent, sheetIdx);\n        if (!sheet.rows[range[0]]) {\n            sheet.rows[range[0]] = {};\n            sheet.rows[range[0]].cells = [];\n        }\n        if (!sheet.rows[range[0]].cells) {\n            sheet.rows[range[0]].cells = [];\n        }\n        if (!sheet.rows[range[0]].cells[range[1]]) {\n            sheet.rows[range[0]].cells[range[1]] = {};\n        }\n        var cell = getCell(range[0], range[1], sheet);\n        if (!isValueOnly) {\n            var isFormula = checkIsFormula(value);\n            if (!isFormula) {\n                cell.formula = '';\n                cell.value = this.parseIntValue(value);\n            }\n            var eventArgs = {\n                action: 'refreshCalculate',\n                value: value,\n                rowIndex: range[0],\n                colIndex: range[1],\n                sheetIndex: sheetIdx,\n                isFormula: isFormula\n            };\n            this.parent.notify(workbookFormulaOperation, eventArgs);\n            if (isFormula) {\n                cell.formula = eventArgs.value;\n                value = cell.value;\n            }\n            if (getTypeFromFormat(cell.format) !== 'Text') {\n                var dateEventArgs = {\n                    value: value,\n                    rowIndex: range[0],\n                    colIndex: range[1],\n                    sheetIndex: sheetIdx,\n                    updatedVal: ''\n                };\n                this.parent.notify(checkDateFormat, dateEventArgs);\n                if (!isNullOrUndefined(dateEventArgs.updatedVal) && dateEventArgs.updatedVal.length > 0) {\n                    cell.value = dateEventArgs.updatedVal;\n                }\n            }\n        }\n        else {\n            if (value && value.toString().indexOf(this.decimalSep) > -1) {\n                value = this.checkDecimalPoint(value);\n            }\n            cell.value = value;\n        }\n        this.parent.setUsedRange(range[0], range[1]);\n        if (this.parent.allowChart) {\n            this.parent.notify(refreshChart, { cell: cell, rIdx: range[0], cIdx: range[1], sheetIdx: sheetIdx });\n        }\n    };\n    WorkbookEdit.prototype.parseIntValue = function (value) {\n        return /^\\d*\\.?\\d*$/.test(value) ? parseFloat(value) : value;\n    };\n    return WorkbookEdit;\n}());\nexport { WorkbookEdit };\n","import { setLinkModel } from '../common/event';\nimport { getRangeIndexes } from '../common/address';\nimport { isNullOrUndefined } from '@syncfusion/ej2-base';\n/**\n * The `WorkbookHyperlink` module is used to handle Hyperlink action in Spreadsheet.\n */\nvar WorkbookHyperlink = /** @class */ (function () {\n    /**\n     * Constructor for WorkbookSort module.\n     */\n    function WorkbookHyperlink(parent) {\n        this.parent = parent;\n        this.addEventListener();\n    }\n    /**\n     * To destroy the sort module.\n     */\n    WorkbookHyperlink.prototype.destroy = function () {\n        this.removeEventListener();\n        this.parent = null;\n    };\n    WorkbookHyperlink.prototype.addEventListener = function () {\n        this.parent.on(setLinkModel, this.setLinkHandler, this);\n    };\n    WorkbookHyperlink.prototype.removeEventListener = function () {\n        if (!this.parent.isDestroyed) {\n            this.parent.off(setLinkModel, this.setLinkHandler);\n        }\n    };\n    WorkbookHyperlink.prototype.setLinkHandler = function (args) {\n        var hyperlink = args.hyperlink;\n        var cellAddr = args.cell;\n        var range;\n        var sheetIdx;\n        var cellIdx;\n        var sheet = this.parent.getActiveSheet();\n        var address;\n        if (cellAddr && cellAddr.indexOf('!') !== -1) {\n            range = cellAddr.split('!');\n            var sheets = this.parent.sheets;\n            for (var idx = 0; idx < sheets.length; idx++) {\n                if (sheets[idx].name === range[0]) {\n                    sheetIdx = idx;\n                }\n            }\n            sheet = this.parent.sheets[sheetIdx];\n            cellAddr = range[1];\n        }\n        cellAddr = cellAddr ? cellAddr : this.parent.getActiveSheet().activeCell;\n        cellIdx = getRangeIndexes(cellAddr);\n        var rowIdx = cellIdx[0];\n        var colIdx = cellIdx[1];\n        if (!sheet) {\n            return;\n        }\n        if (isNullOrUndefined(sheet.rows[rowIdx])) {\n            sheet.rows[rowIdx] = {};\n        }\n        if (isNullOrUndefined(sheet.rows[rowIdx].cells)) {\n            sheet.rows[rowIdx].cells = [];\n        }\n        if (isNullOrUndefined(sheet.rows[rowIdx].cells[colIdx])) {\n            sheet.rows[rowIdx].cells[colIdx] = {};\n        }\n        if (typeof (hyperlink) === 'string') {\n            if (hyperlink.indexOf('http://') !== 0 && hyperlink.indexOf('https://') !== 0 && hyperlink.indexOf('ftp://') !== 0) {\n                hyperlink = hyperlink.toLowerCase().indexOf('www.') === 0 ? 'http://' + hyperlink : hyperlink;\n                address = hyperlink;\n            }\n            sheet.rows[rowIdx].cells[colIdx].hyperlink = hyperlink;\n        }\n        else {\n            address = hyperlink.address;\n            if (address.indexOf('http://') !== 0 && address.indexOf('https://') !== 0 && address.indexOf('ftp://') !== 0) {\n                address = address.toLowerCase().indexOf('www.') === 0 ? 'http://' + address : address;\n            }\n            sheet.rows[rowIdx].cells[colIdx].hyperlink = {\n                address: address,\n            };\n        }\n    };\n    /**\n     * Gets the module name.\n     * @returns string\n     */\n    WorkbookHyperlink.prototype.getModuleName = function () {\n        return 'workbookHyperlink';\n    };\n    return WorkbookHyperlink;\n}());\nexport { WorkbookHyperlink };\n","import { insert, insertModel, workbookFormulaOperation, } from '../../workbook/common/index';\nimport { insertMerge } from '../../workbook/common/index';\n/**\n * The `WorkbookInsert` module is used to insert cells, rows, columns and sheets in to workbook.\n */\nvar WorkbookInsert = /** @class */ (function () {\n    /**\n     * Constructor for the workbook insert module.\n     * @private\n     */\n    function WorkbookInsert(parent) {\n        this.parent = parent;\n        this.addEventListener();\n    }\n    WorkbookInsert.prototype.insertModel = function (args) {\n        var _this = this;\n        var _a, _b, _c;\n        var index;\n        var model = [];\n        var mergeCollection;\n        if (typeof (args.start) === 'number') {\n            index = args.start;\n            args.end = args.end || index;\n            if (index > args.end) {\n                index = args.end;\n                args.end = args.start;\n            }\n            for (var i = index; i <= args.end; i++) {\n                model.push({});\n            }\n        }\n        else {\n            if (args.start) {\n                index = args.start[0].index || 0;\n                model = args.start;\n            }\n            else {\n                index = 0;\n                model.push({});\n            }\n        }\n        if (args.modelType === 'Row') {\n            args.model = args.model;\n            if (!args.model.rows) {\n                args.model.rows = [];\n            }\n            (_a = args.model.rows).splice.apply(_a, [index, 0].concat(model));\n            //this.setInsertInfo(args.model, index, model.length, 'count');\n            if (index > args.model.usedRange.rowIndex) {\n                this.parent.setUsedRange(index + (model.length - 1), args.model.usedRange.colIndex);\n            }\n            else {\n                this.parent.setUsedRange(args.model.usedRange.rowIndex + model.length, args.model.usedRange.colIndex);\n            }\n            var curIdx = index + model.length;\n            for (var i = 0; i <= args.model.usedRange.colIndex; i++) {\n                if (args.model.rows[curIdx] && args.model.rows[curIdx].cells && args.model.rows[curIdx].cells[i] &&\n                    args.model.rows[curIdx].cells[i].rowSpan !== undefined && args.model.rows[curIdx].cells[i].rowSpan < 0 &&\n                    args.model.rows[curIdx].cells[i].colSpan === undefined) {\n                    this.parent.notify(insertMerge, {\n                        range: [curIdx, i, curIdx, i], insertCount: model.length,\n                        insertModel: 'Row'\n                    });\n                }\n            }\n        }\n        else if (args.modelType === 'Column') {\n            args.model = args.model;\n            if (!args.model.columns) {\n                args.model.columns = [];\n            }\n            (_b = args.model.columns).splice.apply(_b, [index, 0].concat(model));\n            //this.setInsertInfo(args.model, index, model.length, 'fldLen', 'Column');\n            if (index > args.model.usedRange.colIndex) {\n                this.parent.setUsedRange(args.model.usedRange.rowIndex, index + (model.length - 1));\n            }\n            else {\n                this.parent.setUsedRange(args.model.usedRange.rowIndex, args.model.usedRange.colIndex + model.length);\n            }\n            if (!args.model.rows) {\n                args.model.rows = [];\n            }\n            var cellModel = [];\n            if (!args.columnCellsModel) {\n                args.columnCellsModel = [];\n            }\n            for (var i = 0; i < model.length; i++) {\n                cellModel.push(null);\n            }\n            mergeCollection = [];\n            for (var i = 0; i <= args.model.usedRange.rowIndex; i++) {\n                if (!args.model.rows[i]) {\n                    args.model.rows[i] = { cells: [] };\n                }\n                else if (!args.model.rows[i].cells) {\n                    args.model.rows[i].cells = [];\n                }\n                if (index && !args.model.rows[i].cells[index - 1]) {\n                    args.model.rows[i].cells[index - 1] = {};\n                }\n                (_c = args.model.rows[i].cells).splice.apply(_c, [index, 0].concat((args.columnCellsModel[i] && args.columnCellsModel[i].cells ?\n                    args.columnCellsModel[i].cells : cellModel)));\n                var curIdx = index + model.length;\n                if (args.model.rows[i].cells[curIdx] && args.model.rows[i].cells[curIdx].colSpan !== undefined &&\n                    args.model.rows[i].cells[curIdx].colSpan < 0 && args.model.rows[i].cells[curIdx].rowSpan === undefined) {\n                    mergeCollection.push({\n                        range: [i, curIdx, i, curIdx], insertCount: cellModel.length,\n                        insertModel: 'Column'\n                    });\n                }\n            }\n            mergeCollection.forEach(function (mergeArgs) { _this.parent.notify(insertMerge, mergeArgs); });\n        }\n        else {\n            if (args.checkCount !== undefined && args.checkCount === this.parent.sheets.length) {\n                return;\n            }\n            delete model[0].index;\n            this.parent.createSheet(index, model);\n            var id_1;\n            if (args.activeSheetIndex) {\n                this.parent.setProperties({ activeSheetIndex: args.activeSheetIndex }, true);\n            }\n            model.forEach(function (sheet) {\n                id_1 = sheet.id;\n                _this.parent.notify(workbookFormulaOperation, {\n                    action: 'addSheet', visibleName: sheet.name, sheetName: 'Sheet' + id_1, index: id_1\n                });\n            });\n        }\n        var insertArgs = {\n            action: 'refreshNamedRange', insertArgs: {\n                model: model, index: index, modelType: args.modelType, isAction: args.isAction, activeSheetIndex: args.activeSheetIndex, sheetCount: this.parent.sheets.length, name: 'insert'\n            }\n        };\n        var eventArgs = {\n            action: 'refreshInsDelFormula', insertArgs: {\n                model: model, startIndex: args.start, endIndex: args.end, modelType: args.modelType, name: 'insert', activeSheetIndex: args.activeSheetIndex, sheetCount: this.parent.sheets.length\n            }\n        };\n        if (args.modelType === 'Column' || args.modelType === 'Row') {\n            this.parent.notify(workbookFormulaOperation, insertArgs);\n            this.parent.notify(workbookFormulaOperation, eventArgs);\n        }\n        this.parent.notify(insert, {\n            model: model, index: index, modelType: args.modelType, isAction: args.isAction, activeSheetIndex: args.activeSheetIndex, sheetCount: this.parent.sheets.length, insertType: args.insertType\n        });\n    };\n    WorkbookInsert.prototype.setInsertInfo = function (sheet, startIndex, count, totalKey, modelType) {\n        if (modelType === void 0) { modelType = 'Row'; }\n        var endIndex = count = startIndex + (count - 1);\n        sheet.ranges.forEach(function (range) {\n            if (range.info && startIndex < range.info[totalKey]) {\n                if (!range.info[\"insert\" + modelType + \"Range\"]) {\n                    range.info[\"insert\" + modelType + \"Range\"] = [[startIndex, endIndex]];\n                }\n                else {\n                    range.info[\"insert\" + modelType + \"Range\"].push([startIndex, endIndex]);\n                }\n                range.info[totalKey] += ((endIndex - startIndex) + 1);\n            }\n        });\n    };\n    WorkbookInsert.prototype.addEventListener = function () {\n        this.parent.on(insertModel, this.insertModel, this);\n    };\n    /**\n     * Destroy workbook insert module.\n     */\n    WorkbookInsert.prototype.destroy = function () {\n        this.removeEventListener();\n        this.parent = null;\n    };\n    WorkbookInsert.prototype.removeEventListener = function () {\n        if (!this.parent.isDestroyed) {\n            this.parent.off(insertModel, this.insertModel);\n        }\n    };\n    /**\n     * Get the workbook insert module name.\n     */\n    WorkbookInsert.prototype.getModuleName = function () {\n        return 'workbookinsert';\n    };\n    return WorkbookInsert;\n}());\nexport { WorkbookInsert };\n","import { getCell, setCell, getSheetIndex } from '../base/index';\nimport { deleteModel, deleteAction, updateUsedRange } from '../../workbook/common/index';\nimport { activeCellMergedRange, setMerge, workbookFormulaOperation } from '../../workbook/common/index';\n/**\n * The `WorkbookDelete` module is used to delete cells, rows, columns and sheets from workbook.\n */\nvar WorkbookDelete = /** @class */ (function () {\n    /**\n     * Constructor for the workbook delete module.\n     * @private\n     */\n    function WorkbookDelete(parent) {\n        this.parent = parent;\n        this.addEventListener();\n    }\n    // tslint:disable-next-line\n    WorkbookDelete.prototype.deleteModel = function (args) {\n        var _this = this;\n        var sheetLength = this.parent.sheets.length;\n        if (args.modelType === 'Sheet' && sheetLength === 1) {\n            return;\n        }\n        var modelName = args.modelType.toLowerCase() + \"s\";\n        args.start = args.start;\n        if (args.start > args.end) {\n            var temp = args.start;\n            args.start = args.end;\n            args.end = temp;\n        }\n        var deletedCells;\n        var mergeArgsCollection = [];\n        var count = (args.end - args.start) + 1;\n        var range;\n        var prevCell;\n        var sheetIndex;\n        if (args.modelType === 'Row') {\n            args.model = args.model;\n            if (args.start > args.model.usedRange.rowIndex) {\n                return;\n            }\n            if (args.end > args.model.usedRange.rowIndex) {\n                args.end -= (args.end - args.model.usedRange.rowIndex);\n            }\n            args.model.usedRange.rowIndex -= ((args.end - args.start) + 1);\n            if (args.model.usedRange.rowIndex < 0) {\n                args.model.usedRange.rowIndex = 0;\n            }\n            this.parent.notify(updateUsedRange, { index: args.model.usedRange.rowIndex, update: 'row' });\n            var curIdx = args.end + 1;\n            var cell = void 0;\n            var mergeArgs = void 0;\n            if (args.model.rows[args.start] && args.model.rows[args.start].cells) {\n                for (var i = 0; i <= args.model.usedRange.colIndex; i++) {\n                    if (args.model.rows[args.start].cells[i] && args.model.rows[args.start].cells[i].rowSpan !== undefined &&\n                        args.model.rows[args.start].cells[i].rowSpan < 0 && args.model.rows[args.start].cells[i].colSpan === undefined) {\n                        mergeArgs = { range: [args.start, i, args.start, i] };\n                        this.parent.notify(activeCellMergedRange, mergeArgs);\n                        mergeArgs.range = mergeArgs.range;\n                        if (mergeArgs.range[2] <= args.end) {\n                            prevCell = getCell(mergeArgs.range[0], i, args.model);\n                            if (prevCell && prevCell.rowSpan > 1) {\n                                if (prevCell.rowSpan - ((mergeArgs.range[2] - args.start) + 1) > 1) {\n                                    setCell(mergeArgs.range[0], i, args.model, { colSpan: prevCell.rowSpan - ((mergeArgs.range[2] - args.start) + 1) }, true);\n                                }\n                                else {\n                                    delete args.model.rows[mergeArgs.range[0]].cells[i].rowSpan;\n                                }\n                            }\n                            mergeArgs = null;\n                        }\n                    }\n                    if (args.model.rows[curIdx].cells && args.model.rows[curIdx].cells[i] &&\n                        args.model.rows[curIdx].cells[i].rowSpan !== undefined &&\n                        args.model.rows[curIdx].cells[i].rowSpan < 0 && args.model.rows[curIdx].cells[i].colSpan === undefined) {\n                        if (!mergeArgs) {\n                            mergeArgs = { range: [curIdx, i, curIdx, i] };\n                            this.parent.notify(activeCellMergedRange, mergeArgs);\n                        }\n                        cell = new Object();\n                        mergeArgs.range = mergeArgs.range;\n                        Object.assign(cell, getCell(mergeArgs.range[0], mergeArgs.range[1], args.model));\n                        if (cell && cell.rowSpan && (cell.rowSpan > 1 || cell.colSpan > 1)) {\n                            var indexes = [];\n                            indexes[1] = i;\n                            indexes[3] = cell.colSpan > 1 ? i + (cell.colSpan - 1) : i;\n                            mergeArgs.range = mergeArgs.range;\n                            if (mergeArgs.range[0] < args.start) {\n                                indexes[0] = indexes[2] = mergeArgs.range[0];\n                                if (cell.rowSpan - count > 1) {\n                                    indexes[2] += (cell.rowSpan - count - 1);\n                                }\n                            }\n                            else {\n                                indexes[0] = indexes[2] = args.start;\n                                if (cell.rowSpan - ((args.end - mergeArgs.range[0]) + 1) > 1) {\n                                    indexes[2] += ((cell.rowSpan - ((args.end - mergeArgs.range[0]) + 1)) - 1);\n                                }\n                            }\n                            mergeArgsCollection.push({\n                                range: indexes, isAction: false, preventRefresh: true, merge: true,\n                                type: 'All', skipChecking: true\n                            });\n                        }\n                    }\n                    mergeArgs = null;\n                }\n            }\n        }\n        else if (args.modelType === 'Column') {\n            args.model = args.model;\n            if (args.start > args.model.usedRange.colIndex) {\n                return;\n            }\n            if (args.end > args.model.usedRange.colIndex) {\n                args.end -= (args.end - args.model.usedRange.colIndex);\n            }\n            args.model.usedRange.colIndex -= count;\n            if (args.model.usedRange.colIndex < 0) {\n                args.model.usedRange.colIndex = 0;\n            }\n            //this.setDeleteInfo(args.start, args.end, 'fldLen', 'Column');\n            this.parent.notify(updateUsedRange, { index: args.model.usedRange.colIndex, update: 'col' });\n            deletedCells = [];\n            var curIdx = args.end + 1;\n            var cell = void 0;\n            var mergeArgs = void 0;\n            for (var i = 0; i <= args.model.usedRange.rowIndex; i++) {\n                deletedCells.push({});\n                if (args.model.rows[i] && args.model.rows[i].cells) {\n                    if (args.model.rows[i].cells[args.start] && args.model.rows[i].cells[args.start].colSpan !== undefined &&\n                        args.model.rows[i].cells[args.start].colSpan < 0 && args.model.rows[i].cells[args.start].rowSpan === undefined) {\n                        mergeArgs = { range: [i, args.start, i, args.start] };\n                        this.parent.notify(activeCellMergedRange, mergeArgs);\n                        mergeArgs.range = mergeArgs.range;\n                        if (mergeArgs.range[3] <= args.end) {\n                            var prevCell_1 = getCell(i, mergeArgs.range[1], args.model);\n                            if (prevCell_1 && prevCell_1.colSpan > 1) {\n                                if (prevCell_1.colSpan - ((mergeArgs.range[3] - args.start) + 1) > 1) {\n                                    setCell(i, mergeArgs.range[1], args.model, { colSpan: prevCell_1.colSpan - ((mergeArgs.range[3] - args.start) + 1) }, true);\n                                }\n                                else {\n                                    delete args.model.rows[i].cells[mergeArgs.range[1]].colSpan;\n                                }\n                            }\n                            mergeArgs = null;\n                        }\n                    }\n                    if (args.model.rows[i].cells[curIdx] && args.model.rows[i].cells[curIdx].colSpan !== undefined &&\n                        args.model.rows[i].cells[curIdx].colSpan < 0 && args.model.rows[i].cells[curIdx].rowSpan === undefined) {\n                        if (!mergeArgs) {\n                            mergeArgs = { range: [i, curIdx, i, curIdx] };\n                            this.parent.notify(activeCellMergedRange, mergeArgs);\n                        }\n                        cell = new Object();\n                        mergeArgs.range = mergeArgs.range;\n                        Object.assign(cell, getCell(mergeArgs.range[0], mergeArgs.range[1], args.model));\n                        if (cell && cell.colSpan && (cell.colSpan > 1 || cell.rowSpan > 1)) {\n                            var indexes = [];\n                            indexes[0] = i;\n                            indexes[2] = cell.rowSpan > 1 ? i + (cell.rowSpan - 1) : i;\n                            mergeArgs.range = mergeArgs.range;\n                            if (mergeArgs.range[1] < args.start) {\n                                indexes[1] = indexes[3] = mergeArgs.range[1];\n                                if (cell.colSpan - count > 1) {\n                                    indexes[3] += (cell.colSpan - count - 1);\n                                }\n                            }\n                            else {\n                                indexes[1] = indexes[3] = args.start;\n                                if (cell.colSpan - ((args.end - mergeArgs.range[1]) + 1) > 1) {\n                                    indexes[3] += ((cell.colSpan - ((args.end - mergeArgs.range[1]) + 1)) - 1);\n                                }\n                            }\n                            mergeArgsCollection.push({\n                                range: indexes, isAction: false, preventRefresh: true, merge: true,\n                                type: 'All', skipChecking: true\n                            });\n                        }\n                    }\n                    deletedCells[i].cells = args.model.rows[i].cells.splice(args.start, count);\n                    mergeArgs = null;\n                }\n            }\n        }\n        var deletedModel = [];\n        for (var i = args.start; i <= args.end; i++) {\n            if (args.model[modelName][args.start]) {\n                deletedModel.push(args.model[modelName][args.start]);\n                args.model[modelName].splice(args.start, 1);\n            }\n            else {\n                deletedModel.push({});\n            }\n            if (i === args.start) {\n                deletedModel[0].index = args.start;\n            }\n        }\n        mergeArgsCollection.forEach(function (merge) { _this.parent.notify(setMerge, merge); });\n        sheetIndex = getSheetIndex(this.parent, args.model.name);\n        var insertArgs = {\n            action: 'refreshNamedRange', insertArgs: {\n                startIndex: args.start, endIndex: args.end, modelType: args.modelType,\n                isAction: args.isAction, deletedModel: deletedModel, deletedCellsModel: deletedCells,\n                activeSheetIndex: this.parent.activeSheetIndex, name: 'delete'\n            }\n        };\n        var eventArgs = {\n            action: 'refreshInsDelFormula', insertArgs: {\n                model: deletedModel, startIndex: args.start, endIndex: args.end, modelType: args.modelType,\n                name: 'delete', activeSheetIndex: args.activeSheetIndex, sheetCount: this.parent.sheets.length\n            }\n        };\n        this.parent.notify(workbookFormulaOperation, insertArgs);\n        this.parent.notify(workbookFormulaOperation, eventArgs);\n        this.parent.notify(deleteAction, {\n            startIndex: args.start, endIndex: args.end, modelType: args.modelType,\n            isAction: args.isAction, deletedModel: deletedModel, deletedCellsModel: deletedCells,\n            activeSheetIndex: this.parent.activeSheetIndex\n        });\n    };\n    WorkbookDelete.prototype.setDeleteInfo = function (startIndex, endIndex, totalKey, modelType) {\n        if (modelType === void 0) { modelType = 'Row'; }\n        var total = (endIndex - startIndex) + 1;\n        var newRange = [];\n        var insertRange;\n        this.parent.getActiveSheet().ranges.forEach(function (range) {\n            if (range.info && startIndex < range.info[totalKey]) {\n                if (range.info[\"delete\" + modelType + \"Range\"]) {\n                    range.info[\"delete\" + modelType + \"Range\"].push([startIndex, endIndex]);\n                }\n                else {\n                    range.info[\"delete\" + modelType + \"Range\"] = [[startIndex, endIndex]];\n                }\n                range.info[totalKey] -= total;\n                if (range.info[\"insert\" + modelType + \"Range\"]) {\n                    range.info[\"insert\" + modelType + \"Range\"] = newRange;\n                }\n            }\n        });\n    };\n    WorkbookDelete.prototype.addEventListener = function () {\n        this.parent.on(deleteModel, this.deleteModel, this);\n    };\n    /**\n     * Destroy workbook delete module.\n     */\n    WorkbookDelete.prototype.destroy = function () {\n        this.removeEventListener();\n        this.parent = null;\n    };\n    WorkbookDelete.prototype.removeEventListener = function () {\n        if (!this.parent.isDestroyed) {\n            this.parent.off(deleteModel, this.deleteModel);\n        }\n    };\n    /**\n     * Get the workbook delete module name.\n     */\n    WorkbookDelete.prototype.getModuleName = function () {\n        return 'workbookdelete';\n    };\n    return WorkbookDelete;\n}());\nexport { WorkbookDelete };\n","import { setCell, setRow, getSheet } from '../base/index';\nimport { setValidation, applyCellFormat, isValidation, removeValidation, addHighlight } from '../common/index';\nimport { removeHighlight } from '../common/index';\nimport { getRangeIndexes } from '../common/index';\n/**\n * The `WorkbookHyperlink` module is used to handle Hyperlink action in Spreadsheet.\n */\nvar WorkbookDataValidation = /** @class */ (function () {\n    /**\n     * Constructor for WorkbookSort module.\n     */\n    function WorkbookDataValidation(parent) {\n        this.parent = parent;\n        this.addEventListener();\n    }\n    /**\n     * To destroy the sort module.\n     */\n    WorkbookDataValidation.prototype.destroy = function () {\n        this.removeEventListener();\n        this.parent = null;\n    };\n    WorkbookDataValidation.prototype.addEventListener = function () {\n        this.parent.on(setValidation, this.addValidationHandler, this);\n        this.parent.on(removeValidation, this.removeValidationHandler, this);\n        this.parent.on(addHighlight, this.addHighlightHandler, this);\n        this.parent.on(removeHighlight, this.removeHighlightHandler, this);\n    };\n    WorkbookDataValidation.prototype.removeEventListener = function () {\n        if (!this.parent.isDestroyed) {\n            this.parent.off(setValidation, this.addValidationHandler);\n            this.parent.off(removeValidation, this.removeValidationHandler);\n            this.parent.off(addHighlight, this.addHighlightHandler);\n            this.parent.off(removeHighlight, this.removeHighlightHandler);\n        }\n    };\n    WorkbookDataValidation.prototype.addValidationHandler = function (args) {\n        this.ValidationHandler(args.rules, args.range, false);\n    };\n    WorkbookDataValidation.prototype.removeValidationHandler = function (args) {\n        this.ValidationHandler(args.rules, args.range, true);\n    };\n    WorkbookDataValidation.prototype.ValidationHandler = function (rules, range, isRemoveValidation) {\n        var cell;\n        var sheet = getSheet(this.parent, this.parent.getAddressInfo(range).sheetIndex);\n        range = range || sheet.selectedRange;\n        var indexes = getRangeIndexes(range);\n        for (var rowIdx = indexes[0]; rowIdx <= indexes[2]; rowIdx++) {\n            if (!sheet.rows[rowIdx]) {\n                setRow(sheet, rowIdx, {});\n            }\n            for (var colIdx = indexes[1]; colIdx <= indexes[3]; colIdx++) {\n                if (!sheet.rows[rowIdx].cells || !sheet.rows[rowIdx].cells[colIdx]) {\n                    setCell(rowIdx, colIdx, sheet, {});\n                }\n                cell = sheet.rows[rowIdx].cells[colIdx];\n                if (isRemoveValidation) {\n                    if (cell.validation) {\n                        delete (cell.validation);\n                        var style = this.parent.getCellStyleValue(['backgroundColor', 'color'], [rowIdx, colIdx]);\n                        this.parent.notify(applyCellFormat, {\n                            style: style, rowIdx: rowIdx, colIdx: colIdx\n                        });\n                    }\n                }\n                else {\n                    cell.validation = {\n                        type: rules.type,\n                        operator: rules.operator,\n                        value1: (rules.type === 'List' && rules.value1.length > 256) ?\n                            rules.value1.substring(0, 255) : rules.value1,\n                        value2: rules.value2,\n                        ignoreBlank: rules.ignoreBlank,\n                        inCellDropDown: rules.inCellDropDown,\n                    };\n                }\n            }\n        }\n    };\n    WorkbookDataValidation.prototype.addHighlightHandler = function (args) {\n        this.InvalidDataHandler(args.range, false);\n    };\n    WorkbookDataValidation.prototype.removeHighlightHandler = function (args) {\n        this.InvalidDataHandler(args.range, true);\n    };\n    WorkbookDataValidation.prototype.InvalidDataHandler = function (range, isRemoveHighlightedData) {\n        var isCell = false;\n        var cell;\n        var value;\n        var sheet = this.parent.getActiveSheet();\n        range = range || sheet.selectedRange;\n        var indexes = range ? getRangeIndexes(range) : [];\n        var rowIdx = range ? indexes[0] : 0;\n        var lastRowIdx = range ? indexes[2] : sheet.rows.length;\n        for (rowIdx; rowIdx <= lastRowIdx; rowIdx++) {\n            if (sheet.rows[rowIdx]) {\n                var colIdx = range ? indexes[1] : 0;\n                var lastColIdx = range ? indexes[3] : sheet.rows[rowIdx].cells.length;\n                for (colIdx; colIdx <= lastColIdx; colIdx++) {\n                    if (sheet.rows[rowIdx].cells[colIdx]) {\n                        cell = sheet.rows[rowIdx].cells[colIdx];\n                        value = cell.value ? cell.value : '';\n                        var range_1 = [rowIdx, colIdx];\n                        var sheetIdx = this.parent.activeSheetIndex;\n                        if (cell.validation && this.parent.allowDataValidation) {\n                            this.parent.notify(isValidation, { value: value, range: range_1, sheetIdx: sheetIdx, isCell: isCell });\n                            var isValid = this.parent.allowDataValidation;\n                            this.parent.allowDataValidation = true;\n                            if (!isValid) {\n                                if (!isRemoveHighlightedData) {\n                                    this.parent.notify(applyCellFormat, {\n                                        style: { backgroundColor: '#ffff00', color: '#ff0000' }, rowIdx: rowIdx, colIdx: colIdx\n                                    });\n                                }\n                                else if (isRemoveHighlightedData) {\n                                    var style = this.parent.getCellStyleValue(['backgroundColor', 'color'], [rowIdx, colIdx]);\n                                    this.parent.notify(applyCellFormat, {\n                                        style: style, rowIdx: rowIdx, colIdx: colIdx\n                                    });\n                                }\n                            }\n                        }\n                    }\n                }\n            }\n        }\n    };\n    /**\n     * Gets the module name.\n     * @returns string\n     */\n    WorkbookDataValidation.prototype.getModuleName = function () {\n        return 'workbookDataValidation';\n    };\n    return WorkbookDataValidation;\n}());\nexport { WorkbookDataValidation };\n","import { getCellIndexes, getCellAddress, findNext, findPrevious, count, } from '../common/index';\nimport { goto, replaceHandler, replaceAllHandler, showDialog, findUndoRedo, replaceAllDialog } from '../common/index';\nimport { isNullOrUndefined } from '@syncfusion/ej2-base';\nimport { findAllValues, workBookeditAlert } from '../common/index';\n/**\n * `WorkbookFindAndReplace` module is used to handle the search action in Spreadsheet.\n */\nvar WorkbookFindAndReplace = /** @class */ (function () {\n    /**\n     * Constructor for WorkbookFindAndReplace module.\n     */\n    function WorkbookFindAndReplace(parent) {\n        this.parent = parent;\n        this.addEventListener();\n    }\n    /**\n     * To destroy the FindAndReplace module.\n     */\n    WorkbookFindAndReplace.prototype.destroy = function () {\n        this.removeEventListener();\n        this.parent = null;\n    };\n    WorkbookFindAndReplace.prototype.addEventListener = function () {\n        this.parent.on(findNext, this.findNext, this);\n        this.parent.on(findPrevious, this.findPrevious, this);\n        this.parent.on(replaceHandler, this.replace, this);\n        this.parent.on(replaceAllHandler, this.replaceAll, this);\n        this.parent.on(count, this.totalCount, this);\n        this.parent.on(findAllValues, this.findAllValues, this);\n    };\n    WorkbookFindAndReplace.prototype.removeEventListener = function () {\n        if (!this.parent.isDestroyed) {\n            this.parent.off(findNext, this.findNext);\n            this.parent.off(findPrevious, this.findPrevious);\n            this.parent.off(replaceHandler, this.replace);\n            this.parent.off(replaceAllHandler, this.replaceAll);\n            this.parent.off(count, this.totalCount);\n            this.parent.off(findAllValues, this.findAllValues);\n        }\n    };\n    WorkbookFindAndReplace.prototype.findNext = function (args) {\n        var sheets = this.parent.sheets;\n        var val;\n        var sheetIndex = args.sheetIndex;\n        var sheet = sheets[this.parent.activeSheetIndex];\n        var activecell = getCellIndexes(sheet.activeCell);\n        var usedRange = sheet.usedRange;\n        var endColumn = usedRange.colIndex;\n        var stringValue = args.value.toString();\n        var cidx;\n        var ridx;\n        var count = 0;\n        var endRow = usedRange.rowIndex;\n        var loopCount = 0;\n        var cellFormat;\n        var valueOfCell;\n        cidx = activecell[1];\n        ridx = activecell[0];\n        var startColumn = cidx;\n        var startRow = ridx;\n        if (sheet.rows[ridx]) {\n            if (sheet.rows[ridx].cells[cidx]) {\n                cellFormat = sheet.rows[ridx].cells[cidx].format;\n                if (cellFormat) {\n                    var dispTxt = this.parent.getDisplayText(sheet.rows[ridx].cells[cidx]);\n                    valueOfCell = dispTxt.toString();\n                }\n                else {\n                    if (sheet.rows[ridx].cells[cidx].value) {\n                        valueOfCell = sheet.rows[ridx].cells[cidx].value.toString();\n                    }\n                }\n            }\n        }\n        if (valueOfCell) {\n            var lcValueOfCell = valueOfCell.toLowerCase();\n            var ivalueOfCell = valueOfCell.indexOf(args.value) > -1;\n            var lowerCaseIndex = lcValueOfCell.indexOf(args.value.toString().toLowerCase()) > -1;\n            if ((stringValue === valueOfCell) || (stringValue === lcValueOfCell) || (ivalueOfCell) || (lowerCaseIndex)) {\n                if (args.searchBy === 'By Column') {\n                    ridx++;\n                }\n                else {\n                    cidx++;\n                }\n                count++;\n            }\n        }\n        if (activecell[0] > sheet.usedRange.rowIndex || activecell[1] > sheet.usedRange.colIndex) {\n            if (activecell[0] > sheet.usedRange.rowIndex && activecell[1] <= sheet.usedRange.colIndex) {\n                ridx = 0;\n                cidx = activecell[1];\n            }\n            else if (activecell[0] <= sheet.usedRange.rowIndex && activecell[1] > sheet.usedRange.colIndex) {\n                ridx = activecell[0];\n                cidx = 0;\n            }\n            else {\n                ridx = 0;\n                cidx = 0;\n            }\n        }\n        var findNextArgs = {\n            rowIndex: ridx, colIndex: cidx, usedRange: usedRange, endRow: endRow, endColumn: endColumn, startRow: startRow,\n            mode: args.mode, loopCount: loopCount, count: count, args: args, val: val, stringValue: stringValue,\n            sheetIndex: this.parent.activeSheetIndex, startColumn: startColumn, sheets: sheets\n        };\n        if (args.searchBy === 'By Row') {\n            this.findNxtRow(findNextArgs);\n        }\n        if (args.searchBy === 'By Column') {\n            this.findNxtCol(findNextArgs);\n        }\n    };\n    WorkbookFindAndReplace.prototype.findNxtRow = function (findNextArgs) {\n        var usedRange;\n        var sheet = findNextArgs.sheets[findNextArgs.sheetIndex];\n        var sheetsLen = this.parent.sheets.length;\n        var activecell = getCellIndexes(sheet.activeCell);\n        if (findNextArgs.colIndex >= findNextArgs.usedRange.colIndex + 1) {\n            findNextArgs.colIndex = 0;\n            findNextArgs.rowIndex++;\n        }\n        for (findNextArgs.rowIndex; findNextArgs.rowIndex <= findNextArgs.endRow + 1; findNextArgs.rowIndex++) {\n            if (findNextArgs.rowIndex > findNextArgs.endRow) {\n                if (findNextArgs.mode === 'Workbook') {\n                    var noCellfound = this.parent.activeSheetIndex;\n                    findNextArgs.sheetIndex++;\n                    if (sheetsLen === findNextArgs.sheetIndex) {\n                        findNextArgs.sheetIndex = 0;\n                    }\n                    if (noCellfound === findNextArgs.sheetIndex) {\n                        if (findNextArgs.count === 0) {\n                            this.parent.notify(showDialog, null);\n                            return;\n                        }\n                    }\n                    sheet = findNextArgs.sheets[findNextArgs.sheetIndex];\n                    usedRange = sheet.usedRange;\n                    activecell = getCellIndexes(sheet.activeCell);\n                    findNextArgs.rowIndex = 0;\n                    findNextArgs.colIndex = 0;\n                    findNextArgs.endColumn = usedRange.colIndex;\n                    findNextArgs.endRow = usedRange.rowIndex;\n                }\n                if (findNextArgs.colIndex === 0 && findNextArgs.rowIndex > findNextArgs.endRow) {\n                    if ((activecell[0] === 0 && activecell[1] === 0) ||\n                        (activecell[0] > sheet.usedRange.rowIndex || activecell[1] > sheet.usedRange.colIndex)) {\n                        if (findNextArgs.count === 0) {\n                            this.parent.notify(showDialog, null);\n                            return;\n                        }\n                    }\n                    else if ((activecell[0] !== 0 && activecell[1] !== 0) || (activecell[0] !== 0 || activecell[1] !== 0)) {\n                        findNextArgs.startColumn = 0;\n                        findNextArgs.startRow = 0;\n                        findNextArgs.endColumn = findNextArgs.usedRange.colIndex;\n                        findNextArgs.endRow = activecell[0];\n                        findNextArgs.rowIndex = findNextArgs.startRow;\n                        findNextArgs.colIndex = findNextArgs.startColumn;\n                        findNextArgs.loopCount++;\n                    }\n                }\n            }\n            if (findNextArgs.count > 0) {\n                if (findNextArgs.usedRange.rowIndex < findNextArgs.rowIndex) {\n                    findNextArgs.rowIndex = 0;\n                    if (findNextArgs.rowIndex === 0) {\n                        findNextArgs.colIndex = 0;\n                    }\n                }\n            }\n            if (sheet.rows[findNextArgs.rowIndex]) {\n                var row = sheet.rows[findNextArgs.rowIndex];\n                for (findNextArgs.colIndex; findNextArgs.colIndex <= findNextArgs.endColumn; findNextArgs.colIndex++) {\n                    if (row) {\n                        if (row.cells[findNextArgs.colIndex]) {\n                            var checkTrue = this.nextCommon(findNextArgs);\n                            if (checkTrue) {\n                                return;\n                            }\n                        }\n                    }\n                }\n                if (findNextArgs.colIndex > findNextArgs.endColumn) {\n                    findNextArgs.colIndex = 0;\n                }\n                if (findNextArgs.loopCount > 0) {\n                    if (activecell[0] === findNextArgs.rowIndex) {\n                        this.parent.notify(showDialog, null);\n                        return;\n                    }\n                }\n            }\n        }\n        if (findNextArgs.count === 0) {\n            this.parent.notify(showDialog, null);\n            return;\n        }\n    };\n    WorkbookFindAndReplace.prototype.findNxtCol = function (findNextArgs) {\n        var sheet = findNextArgs.sheets[findNextArgs.sheetIndex];\n        var noFound;\n        var activecell = getCellIndexes(sheet.activeCell);\n        var sheetsLen = this.parent.sheets.length;\n        if (findNextArgs.rowIndex >= findNextArgs.usedRange.rowIndex) {\n            findNextArgs.rowIndex = 0;\n            findNextArgs.colIndex++;\n        }\n        for (findNextArgs.colIndex; findNextArgs.colIndex <= findNextArgs.usedRange.colIndex + 1; findNextArgs.colIndex++) {\n            if (findNextArgs.colIndex >= findNextArgs.endColumn + 1) {\n                if (findNextArgs.mode === 'Workbook') {\n                    noFound = this.parent.activeSheetIndex;\n                    findNextArgs.sheetIndex++;\n                    if (sheetsLen === findNextArgs.sheetIndex) {\n                        findNextArgs.sheetIndex = 0;\n                    }\n                    if (noFound === findNextArgs.sheetIndex) {\n                        if (findNextArgs.count === 0) {\n                            this.parent.notify(showDialog, null);\n                            return;\n                        }\n                    }\n                    sheet = findNextArgs.sheets[findNextArgs.sheetIndex];\n                    findNextArgs.usedRange = sheet.usedRange;\n                    activecell = getCellIndexes(sheet.activeCell);\n                    findNextArgs.colIndex = 0;\n                    findNextArgs.rowIndex = 0;\n                    findNextArgs.endColumn = findNextArgs.usedRange.colIndex;\n                    findNextArgs.endRow = findNextArgs.usedRange.rowIndex;\n                }\n            }\n            if (findNextArgs.colIndex >= findNextArgs.endColumn + 1) {\n                findNextArgs.colIndex = 0;\n            }\n            if (findNextArgs.rowIndex > findNextArgs.endRow && findNextArgs.colIndex === 0) {\n                if ((activecell[0] === 0 && activecell[1] === 0) ||\n                    (activecell[1] > sheet.usedRange.rowIndex || activecell[0] > sheet.usedRange.colIndex)) {\n                    if (findNextArgs.count === 0) {\n                        this.parent.notify(showDialog, null);\n                        return;\n                    }\n                }\n                else if ((activecell[1] !== 0 || activecell[0] !== 0) || (activecell[1] !== 0 && activecell[0] !== 0)) {\n                    findNextArgs.startRow = 0;\n                    findNextArgs.startColumn = 0;\n                    findNextArgs.endRow = activecell[0];\n                    findNextArgs.endColumn = findNextArgs.usedRange.colIndex;\n                    findNextArgs.colIndex = findNextArgs.startColumn;\n                    findNextArgs.rowIndex = findNextArgs.startRow;\n                    findNextArgs.loopCount++;\n                }\n            }\n            if (findNextArgs.count > 0) {\n                if (findNextArgs.usedRange.colIndex + 1 < findNextArgs.colIndex) {\n                    findNextArgs.colIndex = 0;\n                    findNextArgs.rowIndex = 0;\n                }\n            }\n            if (findNextArgs.rowIndex >= findNextArgs.endRow) {\n                findNextArgs.rowIndex = 0;\n            }\n            if (findNextArgs.colIndex <= findNextArgs.usedRange.colIndex) {\n                for (findNextArgs.rowIndex; findNextArgs.rowIndex <= findNextArgs.usedRange.rowIndex; findNextArgs.rowIndex++) {\n                    if (sheet.rows[findNextArgs.rowIndex]) {\n                        if (sheet.rows[findNextArgs.rowIndex].cells[findNextArgs.colIndex]) {\n                            var checkTrue = this.nextCommon(findNextArgs);\n                            if (checkTrue) {\n                                return;\n                            }\n                        }\n                    }\n                }\n                if (findNextArgs.loopCount > 0) {\n                    if (activecell[1] === findNextArgs.colIndex) {\n                        this.parent.notify(showDialog, null);\n                        return;\n                    }\n                }\n            }\n        }\n        if (findNextArgs.count === 0) {\n            this.parent.notify(showDialog, null);\n            return;\n        }\n    };\n    WorkbookFindAndReplace.prototype.nextCommon = function (findNextArgs) {\n        var sheet = findNextArgs.sheets[findNextArgs.sheetIndex];\n        if (sheet.rows[findNextArgs.rowIndex]) {\n            var rowCol = sheet.rows[findNextArgs.rowIndex].cells[findNextArgs.colIndex];\n            if (rowCol && rowCol.value) {\n                var cellType = sheet.rows[findNextArgs.rowIndex].cells[findNextArgs.colIndex];\n                if (cellType) {\n                    var cellval = void 0;\n                    if (cellType.format) {\n                        var displayTxt = this.parent.getDisplayText(sheet.rows[findNextArgs.rowIndex].\n                            cells[findNextArgs.colIndex]);\n                        cellval = displayTxt;\n                    }\n                    else {\n                        cellval = sheet.rows[findNextArgs.rowIndex].cells[findNextArgs.colIndex].value.toString();\n                    }\n                    if (findNextArgs.args.isCSen && findNextArgs.args.isEMatch) {\n                        if (cellval === findNextArgs.stringValue) {\n                            var address = sheet.name + '!' + getCellAddress(findNextArgs.rowIndex, findNextArgs.colIndex);\n                            this.parent.notify(goto, { address: address });\n                            findNextArgs.count++;\n                            return true;\n                        }\n                    }\n                    else if (findNextArgs.args.isCSen && !findNextArgs.args.isEMatch) {\n                        var index = cellval.indexOf(findNextArgs.args.value) > -1;\n                        if ((cellval === findNextArgs.stringValue) || (index)) {\n                            var address = sheet.name + '!' + getCellAddress(findNextArgs.rowIndex, findNextArgs.colIndex);\n                            this.parent.notify(goto, { address: address });\n                            findNextArgs.count++;\n                            return true;\n                        }\n                    }\n                    else if (!findNextArgs.args.isCSen && findNextArgs.args.isEMatch) {\n                        findNextArgs.val = cellval.toString().toLowerCase();\n                        if (findNextArgs.val === findNextArgs.stringValue) {\n                            var address = sheet.name + '!' + getCellAddress(findNextArgs.rowIndex, findNextArgs.colIndex);\n                            this.parent.notify(goto, { address: address });\n                            findNextArgs.count++;\n                            return true;\n                        }\n                    }\n                    else if (!findNextArgs.args.isCSen && !findNextArgs.args.isEMatch) {\n                        findNextArgs.val = cellval.toString().toLowerCase();\n                        var index = findNextArgs.val.indexOf(findNextArgs.args.value.toString().toLowerCase()) > -1;\n                        var lowerCaseIndex = findNextArgs.val.indexOf(findNextArgs.args.value) > -1;\n                        if ((findNextArgs.val === findNextArgs.stringValue) || ((cellval === findNextArgs.stringValue) || (index)) ||\n                            (cellval === findNextArgs.stringValue) || (lowerCaseIndex)) {\n                            var address = sheet.name + '!' + getCellAddress(findNextArgs.rowIndex, findNextArgs.colIndex);\n                            this.parent.notify(goto, { address: address });\n                            findNextArgs.count++;\n                            return true;\n                        }\n                    }\n                }\n            }\n        }\n        return false;\n    };\n    WorkbookFindAndReplace.prototype.findPrevious = function (args) {\n        var sheets = this.parent.sheets;\n        var sheetIndex = args.sheetIndex;\n        var sheet = sheets[sheetIndex];\n        var valueOfCell;\n        var cellFormat;\n        var val;\n        var activecell = getCellIndexes(sheet.activeCell);\n        var loopCount = 0;\n        var count = 0;\n        var endRow = sheet.usedRange.rowIndex;\n        var endColumn = sheet.usedRange.colIndex;\n        var stringValue = args.value.toString();\n        var cidx = activecell[1];\n        var ridx = activecell[0];\n        var startColumn = cidx;\n        var startRow = ridx;\n        if (sheet.rows[ridx]) {\n            if (sheet.rows[ridx].cells[cidx]) {\n                cellFormat = sheet.rows[ridx].cells[cidx].format;\n                if (cellFormat) {\n                    var displayTxt = this.parent.getDisplayText(sheet.rows[ridx].cells[cidx]);\n                    valueOfCell = displayTxt.toString();\n                }\n                else {\n                    if (sheet.rows[ridx].cells[cidx].value) {\n                        valueOfCell = sheet.rows[ridx].cells[cidx].value.toString();\n                    }\n                }\n            }\n        }\n        if (valueOfCell) {\n            var lcValue = valueOfCell.toLowerCase();\n            var ivalue = valueOfCell.indexOf(args.value) > -1;\n            var lowerCaseIndex = lcValue.indexOf(args.value.toString().toLowerCase()) > -1;\n            if ((stringValue === valueOfCell) || (stringValue === lcValue) || (ivalue) || (lowerCaseIndex)) {\n                if (args.searchBy === 'By Row') {\n                    cidx--;\n                }\n                if (args.searchBy === 'By Column') {\n                    ridx--;\n                }\n                count++;\n            }\n        }\n        if (activecell[0] > sheet.usedRange.rowIndex || activecell[1] > sheet.usedRange.colIndex) {\n            if (activecell[0] > sheet.usedRange.rowIndex && activecell[1] <= sheet.usedRange.colIndex) {\n                ridx = sheet.usedRange.rowIndex;\n                cidx = activecell[1];\n            }\n            else if (activecell[0] <= sheet.usedRange.rowIndex && activecell[1] > sheet.usedRange.colIndex) {\n                ridx = activecell[0];\n                cidx = sheet.usedRange.colIndex;\n            }\n            else {\n                ridx = sheet.usedRange.rowIndex;\n                cidx = sheet.usedRange.colIndex;\n            }\n        }\n        var findPrevArgs = {\n            rowIndex: ridx, colIndex: cidx, endRow: endRow, endColumn: endColumn, startRow: startRow,\n            loopCount: loopCount, count: count, args: args, val: val, stringValue: stringValue,\n            sheets: sheets, sheetIndex: sheetIndex, startColumn: startColumn,\n        };\n        if (args.searchBy === 'By Row') {\n            this.findPreRow(findPrevArgs);\n        }\n        if (args.searchBy === 'By Column') {\n            this.findPreCol(findPrevArgs);\n        }\n    };\n    WorkbookFindAndReplace.prototype.findPreRow = function (findPrevArgs) {\n        var usedRan;\n        var sheet = findPrevArgs.sheets[findPrevArgs.sheetIndex];\n        var sheetsLength = this.parent.sheets.length;\n        var noValueBoolean = false;\n        var activecell = getCellIndexes(sheet.activeCell);\n        if (findPrevArgs.colIndex === -1) {\n            findPrevArgs.colIndex = findPrevArgs.endColumn;\n            findPrevArgs.rowIndex--;\n        }\n        for (findPrevArgs.rowIndex; findPrevArgs.rowIndex >= -1; findPrevArgs.rowIndex--) {\n            if (findPrevArgs.rowIndex < 0 && findPrevArgs.colIndex < 0) {\n                if (findPrevArgs.args.mode === 'Workbook') {\n                    var noCellfound = this.parent.activeSheetIndex;\n                    findPrevArgs.sheetIndex--;\n                    if (findPrevArgs.sheetIndex === -1) {\n                        findPrevArgs.sheetIndex = sheetsLength - 1;\n                    }\n                    if (noCellfound === findPrevArgs.sheetIndex) {\n                        if (findPrevArgs.count === 0) {\n                            this.parent.notify(showDialog, null);\n                            return;\n                        }\n                    }\n                    sheet = findPrevArgs.sheets[findPrevArgs.sheetIndex];\n                    usedRan = sheet.usedRange;\n                    activecell = getCellIndexes(sheet.activeCell);\n                    findPrevArgs.rowIndex = usedRan.rowIndex;\n                    findPrevArgs.colIndex = usedRan.colIndex;\n                    findPrevArgs.endColumn = 0;\n                    findPrevArgs.endRow = 0;\n                }\n                noValueBoolean = this.commonCondition(findPrevArgs, activecell);\n            }\n            if (!noValueBoolean) {\n                if (findPrevArgs.args.mode !== 'Workbook') {\n                    if (findPrevArgs.count > 0) {\n                        if (findPrevArgs.rowIndex === -1) {\n                            findPrevArgs.rowIndex = findPrevArgs.endRow;\n                        }\n                    }\n                }\n                if (findPrevArgs.rowIndex === -1) {\n                    findPrevArgs.rowIndex = sheet.usedRange.rowIndex;\n                    findPrevArgs.colIndex = sheet.usedRange.colIndex;\n                }\n                if (sheet.rows[findPrevArgs.rowIndex]) {\n                    if (findPrevArgs.colIndex === -1) {\n                        findPrevArgs.colIndex = sheet.usedRange.colIndex;\n                    }\n                    for (findPrevArgs.colIndex; findPrevArgs.colIndex >= 0; findPrevArgs.colIndex--) {\n                        if (sheet.rows[findPrevArgs.rowIndex]) {\n                            if (sheet.rows[findPrevArgs.rowIndex].cells[findPrevArgs.colIndex]) {\n                                var checkTrue = this.prevCommon(findPrevArgs);\n                                if (checkTrue) {\n                                    return;\n                                }\n                            }\n                        }\n                    }\n                    if (findPrevArgs.loopCount > 0) {\n                        if (activecell[0] === findPrevArgs.rowIndex) {\n                            this.parent.notify(showDialog, null);\n                            return;\n                        }\n                    }\n                }\n            }\n        }\n        if (!noValueBoolean) {\n            if (findPrevArgs.count === 0) {\n                this.parent.notify(showDialog, null);\n                return;\n            }\n        }\n    };\n    WorkbookFindAndReplace.prototype.findPreCol = function (findPrevArgs) {\n        var usedRange;\n        var sheet = findPrevArgs.sheets[findPrevArgs.sheetIndex];\n        var sheetsLen = this.parent.sheets.length;\n        var noValueBoolean = false;\n        var activecell = getCellIndexes(sheet.activeCell);\n        for (findPrevArgs.colIndex; findPrevArgs.colIndex >= -1; findPrevArgs.colIndex--) {\n            if (findPrevArgs.rowIndex < 0 && findPrevArgs.colIndex < 0) {\n                if (findPrevArgs.args.mode === 'Workbook') {\n                    var noCellfound = this.parent.activeSheetIndex;\n                    findPrevArgs.sheetIndex--;\n                    if (findPrevArgs.sheetIndex === -1) {\n                        findPrevArgs.sheetIndex = sheetsLen - 1;\n                    }\n                    if (noCellfound === findPrevArgs.sheetIndex) {\n                        if (findPrevArgs.count === 0) {\n                            this.parent.notify(showDialog, null);\n                            return;\n                        }\n                    }\n                    sheet = findPrevArgs.sheets[findPrevArgs.sheetIndex];\n                    usedRange = sheet.usedRange;\n                    activecell = getCellIndexes(sheet.activeCell);\n                    findPrevArgs.rowIndex = usedRange.rowIndex;\n                    findPrevArgs.colIndex = usedRange.colIndex;\n                    findPrevArgs.endColumn = 0;\n                    findPrevArgs.endRow = 0;\n                }\n                noValueBoolean = this.commonCondition(findPrevArgs, activecell);\n            }\n            if (!noValueBoolean) {\n                if (findPrevArgs.count > 0) {\n                    if (findPrevArgs.colIndex < 0) {\n                        findPrevArgs.colIndex = findPrevArgs.endColumn;\n                    }\n                }\n                if (findPrevArgs.rowIndex < 0) {\n                    findPrevArgs.rowIndex = sheet.usedRange.rowIndex;\n                }\n                if (findPrevArgs.colIndex < -1) {\n                    findPrevArgs.colIndex = sheet.usedRange.colIndex;\n                    findPrevArgs.rowIndex--;\n                }\n                if (sheet.rows[findPrevArgs.rowIndex]) {\n                    if (sheet.rows[findPrevArgs.rowIndex].cells[findPrevArgs.colIndex]) {\n                        if (findPrevArgs.rowIndex === -1) {\n                            findPrevArgs.rowIndex = sheet.usedRange.rowIndex;\n                        }\n                    }\n                }\n                for (findPrevArgs.rowIndex; findPrevArgs.rowIndex >= 0; findPrevArgs.rowIndex--) {\n                    if (sheet.rows[findPrevArgs.rowIndex]) {\n                        if (sheet.rows[findPrevArgs.rowIndex].cells[findPrevArgs.colIndex]) {\n                            var check = this.prevCommon(findPrevArgs);\n                            if (check) {\n                                return;\n                            }\n                        }\n                    }\n                    if (findPrevArgs.loopCount > 0) {\n                        if (activecell[1] === findPrevArgs.colIndex) {\n                            this.parent.notify(showDialog, null);\n                            return;\n                        }\n                    }\n                }\n            }\n        }\n        if (!noValueBoolean) {\n            if (findPrevArgs.count === 0) {\n                this.parent.notify(showDialog, null);\n                return;\n            }\n        }\n    };\n    WorkbookFindAndReplace.prototype.commonCondition = function (findPrevArgs, activecell) {\n        var sheet = findPrevArgs.sheets[findPrevArgs.sheetIndex];\n        var isTrue;\n        if ((activecell[0] !== findPrevArgs.endRow && activecell[1] !== findPrevArgs.endColumn) ||\n            (activecell[0] !== findPrevArgs.endRow || activecell[1] !== findPrevArgs.endColumn)) {\n            findPrevArgs.startColumn = sheet.usedRange.colIndex;\n            findPrevArgs.startRow = sheet.usedRange.rowIndex;\n            findPrevArgs.endColumn = 0;\n            findPrevArgs.endRow = activecell[0];\n            findPrevArgs.rowIndex = findPrevArgs.startRow;\n            findPrevArgs.colIndex = findPrevArgs.startColumn;\n            findPrevArgs.loopCount++;\n            isTrue = false;\n        }\n        else if ((activecell[0] === sheet.usedRange.rowIndex && activecell[1] === sheet.usedRange.colIndex) ||\n            (activecell[0] > sheet.usedRange.rowIndex || activecell[1] > sheet.usedRange.colIndex)) {\n            this.parent.notify(showDialog, null);\n            isTrue = true;\n        }\n        return isTrue;\n    };\n    WorkbookFindAndReplace.prototype.prevCommon = function (findPrevArgs) {\n        var sheet = findPrevArgs.sheets[findPrevArgs.sheetIndex];\n        if (sheet.rows[findPrevArgs.rowIndex]) {\n            var rowCol = sheet.rows[findPrevArgs.rowIndex].cells[findPrevArgs.colIndex];\n            if (rowCol && rowCol.value) {\n                var cellType = sheet.rows[findPrevArgs.rowIndex].cells[findPrevArgs.colIndex];\n                if (cellType) {\n                    var cellvalue = void 0;\n                    if (cellType.format) {\n                        var displayTxt = this.parent.getDisplayText(sheet.rows[findPrevArgs.rowIndex]\n                            .cells[findPrevArgs.colIndex]);\n                        cellvalue = displayTxt;\n                    }\n                    else {\n                        cellvalue = sheet.rows[findPrevArgs.rowIndex].cells[findPrevArgs.colIndex].value.toString();\n                    }\n                    if (findPrevArgs.args.isCSen && findPrevArgs.args.isEMatch) {\n                        if (cellvalue === findPrevArgs.stringValue) {\n                            var address = sheet.name + '!' + getCellAddress(findPrevArgs.rowIndex, findPrevArgs.colIndex);\n                            this.parent.notify(goto, { address: address });\n                            findPrevArgs.count++;\n                            return true;\n                        }\n                    }\n                    else if (findPrevArgs.args.isCSen && !findPrevArgs.args.isEMatch) {\n                        var index = cellvalue.indexOf(findPrevArgs.args.value) > -1;\n                        if ((cellvalue === findPrevArgs.stringValue) || (index)) {\n                            var address = sheet.name + '!' + getCellAddress(findPrevArgs.rowIndex, findPrevArgs.colIndex);\n                            this.parent.notify(goto, { address: address });\n                            findPrevArgs.count++;\n                            return true;\n                        }\n                    }\n                    else if (!findPrevArgs.args.isCSen && findPrevArgs.args.isEMatch) {\n                        findPrevArgs.val = cellvalue.toString().toLowerCase();\n                        if (findPrevArgs.val === findPrevArgs.stringValue) {\n                            var address = sheet.name + '!' + getCellAddress(findPrevArgs.rowIndex, findPrevArgs.colIndex);\n                            this.parent.notify(goto, { address: address });\n                            findPrevArgs.count++;\n                            return true;\n                        }\n                    }\n                    else if (!findPrevArgs.args.isCSen && !findPrevArgs.args.isEMatch) {\n                        findPrevArgs.val = cellvalue.toString().toLowerCase();\n                        var index = findPrevArgs.val.indexOf(findPrevArgs.args.value.toString().toLowerCase()) > -1;\n                        var lowerCaseIndex = findPrevArgs.val.indexOf(findPrevArgs.args.value) > -1;\n                        if ((cellvalue === findPrevArgs.stringValue) || ((cellvalue === findPrevArgs.stringValue) ||\n                            (index)) || (findPrevArgs.val === findPrevArgs.stringValue) || (lowerCaseIndex)) {\n                            var address = sheet.name + '!' + getCellAddress(findPrevArgs.rowIndex, findPrevArgs.colIndex);\n                            this.parent.notify(goto, { address: address });\n                            findPrevArgs.count++;\n                            return true;\n                        }\n                    }\n                }\n            }\n        }\n        return false;\n    };\n    WorkbookFindAndReplace.prototype.replace = function (args) {\n        if (this.parent.getActiveSheet().isProtected) {\n            this.parent.notify(workBookeditAlert, null);\n            return;\n        }\n        var sheet = this.parent.getActiveSheet();\n        var activecell = getCellIndexes(sheet.activeCell);\n        var currentCell = sheet.rows[activecell[0]].cells[activecell[1]].value.toString();\n        var index = currentCell.indexOf(args.value) > -1;\n        var lowerCaseIndex = currentCell.toLowerCase().indexOf(args.value.toString().toLowerCase()) > -1;\n        var val = currentCell.toString().toLowerCase();\n        if ((currentCell !== args.value) && (!index) && (val !== args.value) && (!lowerCaseIndex)) {\n            args.findOpt = 'next';\n            this.findNext(args);\n        }\n        this.parent.getActiveSheet();\n        var activecel = getCellIndexes(sheet.activeCell);\n        var address = sheet.activeCell;\n        var cell = sheet.rows[activecel[0]].cells[activecel[1]];\n        var cellFormat = sheet.rows[activecel[0]].cells[activecel[1]].format;\n        var compareVal;\n        var replaceAddress = sheet.name + '!' + getCellAddress(activecel[0], activecel[1]);\n        if (cellFormat) {\n            var dispTxt = this.parent.getDisplayText(sheet.rows[activecel[0]].cells[activecel[1]]);\n            compareVal = dispTxt.toString();\n        }\n        else {\n            compareVal = sheet.rows[activecel[0]].cells[activecel[1]].value.toString();\n        }\n        var replaceAllCollection = { undoRedoOpt: 'before', address: replaceAddress, compareVal: compareVal };\n        this.parent.notify(findUndoRedo, replaceAllCollection);\n        var lcValueOfCell = compareVal.toLowerCase();\n        var ivalueOfCell = compareVal.indexOf(args.value) > -1;\n        var caseInSensitive = lcValueOfCell.indexOf(args.value) > -1;\n        if ((args.value === compareVal) || (args.value === lcValueOfCell)) {\n            sheet.rows[activecel[0]].cells[activecel[1]].value = args.replaceValue;\n            this.parent.updateCell(cell, address);\n            var replaceAllCollection_1 = { address: replaceAddress, compareVal: args.replaceValue, undoRedoOpt: 'after' };\n            this.parent.notify(findUndoRedo, replaceAllCollection_1);\n        }\n        else if (ivalueOfCell) {\n            var newValue = compareVal.replace(args.value, args.replaceValue);\n            sheet.rows[activecel[0]].cells[activecel[1]].value = newValue;\n            this.parent.updateCell(cell, address);\n            var replaceAllCollection_2 = { address: replaceAddress, compareVal: args.replaceValue, undoRedoOpt: 'after' };\n            this.parent.notify(findUndoRedo, replaceAllCollection_2);\n        }\n        else if (caseInSensitive) {\n            var regx = new RegExp(args.value.toString().replace(/[.*+?^${}()|[\\]\\\\]/g, '\\\\$&'), 'ig');\n            var updateValue = compareVal.replace(regx, args.replaceValue);\n            sheet.rows[activecel[0]].cells[activecel[1]].value = updateValue;\n            this.parent.updateCell(cell, address);\n            var replaceAllCollection_3 = { address: replaceAddress, compareVal: args.replaceValue, undoRedoOpt: 'after' };\n            this.parent.notify(findUndoRedo, replaceAllCollection_3);\n        }\n    };\n    WorkbookFindAndReplace.prototype.replaceAll = function (args) {\n        var startSheet = 0;\n        var sheet = this.parent.sheets[startSheet];\n        var endRow = sheet.usedRange.rowIndex;\n        var count = 0;\n        var undoRedoOpt = 'beforeReplaceAll';\n        var startRow = 0;\n        var endColumn = sheet.usedRange.colIndex;\n        var startColumn = 0;\n        var addressCollection = [];\n        var address;\n        for (startRow; startRow <= endRow; startRow++) {\n            if (startColumn > endColumn && startRow === endRow) {\n                if (args.mode === 'Workbook') {\n                    startSheet++;\n                    sheet = this.parent.sheets[startSheet];\n                    if (sheet) {\n                        startColumn = 0;\n                        startRow = 0;\n                        endColumn = sheet.usedRange.colIndex;\n                        endRow = sheet.usedRange.rowIndex;\n                        sheet = sheet;\n                    }\n                }\n            }\n            if (sheet) {\n                if (sheet.rows[startRow]) {\n                    var row = sheet.rows[startRow];\n                    if (startColumn === endColumn + 1) {\n                        startColumn = 0;\n                    }\n                    for (startColumn; startColumn <= endColumn; startColumn++) {\n                        var cell = sheet.rows[startRow].cells[startColumn];\n                        if (row) {\n                            if (row.cells[startColumn] && row.cells[startColumn].value) {\n                                var cellType = sheet.rows[startRow].cells[startColumn];\n                                if (cellType) {\n                                    var cellTypeVal = cellType.format;\n                                    var cellval = void 0;\n                                    if (cellTypeVal) {\n                                        var displayTxt = this.parent.getDisplayText(sheet.rows[startRow].\n                                            cells[startColumn]);\n                                        cellval = displayTxt.toString();\n                                    }\n                                    else {\n                                        cellval = sheet.rows[startRow].cells[startColumn].value.toString();\n                                    }\n                                    if (args.isCSen && args.isEMatch) {\n                                        if (cellval === args.value) {\n                                            sheet.rows[startRow].cells[startColumn].value = args.replaceValue;\n                                            address = sheet.name + '!' + getCellAddress(startRow, startColumn);\n                                            this.parent.updateCell(cell, address);\n                                            addressCollection.push(address);\n                                            count++;\n                                        }\n                                    }\n                                    else if (args.isCSen && !args.isEMatch) {\n                                        var index = cellval.indexOf(args.value) > -1;\n                                        if ((cellval === args.value) || (index)) {\n                                            var newValue = cellval.replace(args.value, args.replaceValue);\n                                            sheet.rows[startRow].cells[startColumn].value = newValue;\n                                            address = sheet.name + '!' + getCellAddress(startRow, startColumn);\n                                            this.parent.updateCell(cell, address);\n                                            addressCollection.push(address);\n                                            count++;\n                                        }\n                                    }\n                                    else if (!args.isCSen && args.isEMatch) {\n                                        var val = cellval.toString().toLowerCase();\n                                        if (val === args.value) {\n                                            sheet.rows[startRow].cells[startColumn].value = args.replaceValue;\n                                            address = sheet.name + '!' + getCellAddress(startRow, startColumn);\n                                            this.parent.updateCell(cell, address);\n                                            addressCollection.push(address);\n                                            count++;\n                                        }\n                                    }\n                                    else if (!args.isCSen && !args.isEMatch) {\n                                        var val = cellval.toString().toLowerCase();\n                                        var index = val.indexOf(args.value.toString().toLowerCase()) > -1;\n                                        var lowerCaseValue = val.indexOf(args.value) > -1;\n                                        if (((cellval === args.value) || (index)) || (val === args.value) || (cellval === args.value) ||\n                                            (lowerCaseValue)) {\n                                            var regExepression = new RegExp(args.value.toString().replace(/[.*+?^${}()|[\\]\\\\]/g, '\\\\$&'), 'ig');\n                                            var newValue = cellval.replace(regExepression, args.replaceValue);\n                                            sheet.rows[startRow].cells[startColumn].value = newValue;\n                                            address = sheet.name + '!' + getCellAddress(startRow, startColumn);\n                                            this.parent.updateCell(cell, address);\n                                            addressCollection.push(address);\n                                            count++;\n                                        }\n                                    }\n                                }\n                            }\n                        }\n                    }\n                }\n            }\n        }\n        var replaceAllCollection = {\n            undoRedoOpt: undoRedoOpt, Collection: addressCollection,\n            replaceValue: args.value\n        };\n        this.parent.notify(findUndoRedo, replaceAllCollection);\n        replaceAllCollection = {\n            undoRedoOpt: 'afterReplaceAll', Collection: addressCollection,\n            replaceValue: args.replaceValue\n        };\n        this.parent.notify(findUndoRedo, replaceAllCollection);\n        var countNumber = count;\n        this.parent.notify(replaceAllDialog, { count: countNumber, replaceValue: args.replaceValue });\n    };\n    WorkbookFindAndReplace.prototype.totalCount = function (args) {\n        var startSheet = 0;\n        var sheet = this.parent.sheets[startSheet];\n        var endRow = sheet.usedRange.rowIndex;\n        var count = 0;\n        var rowIndex = 0;\n        var endColumn = sheet.usedRange.colIndex;\n        var columnIndex = 0;\n        for (rowIndex; rowIndex <= endRow; rowIndex++) {\n            if (sheet.rows[rowIndex]) {\n                var row = sheet.rows[rowIndex];\n                if (columnIndex === endColumn + 1) {\n                    columnIndex = 0;\n                }\n                for (columnIndex; columnIndex <= endColumn; columnIndex++) {\n                    if (row) {\n                        if (row.cells[columnIndex] && row.cells[columnIndex].value) {\n                            var cellType = sheet.rows[rowIndex].cells[columnIndex];\n                            if (cellType) {\n                                var cellFormat = cellType.format;\n                                var cellvalue = void 0;\n                                if (cellFormat) {\n                                    var displayTxt = this.parent.getDisplayText(sheet.rows[rowIndex].\n                                        cells[columnIndex]);\n                                    cellvalue = displayTxt.toString();\n                                }\n                                else {\n                                    cellvalue = cellType.value.toString();\n                                }\n                                if (args.isCSen && args.isEMatch) {\n                                    if (cellvalue === args.value) {\n                                        count++;\n                                    }\n                                }\n                                else if (args.isCSen && !args.isEMatch) {\n                                    var index = cellvalue.indexOf(args.value) > -1;\n                                    if ((cellvalue === args.value) || (index)) {\n                                        count++;\n                                    }\n                                }\n                                else if (!args.isCSen && args.isEMatch) {\n                                    var val = cellvalue.toString().toLowerCase();\n                                    if (val === args.value) {\n                                        count++;\n                                    }\n                                }\n                                else if (!args.isCSen && !args.isEMatch) {\n                                    var val = cellvalue.toString().toLowerCase();\n                                    var index = val.indexOf(args.value.toString().toLowerCase()) > -1;\n                                    var lowerCaseValue = val.indexOf(args.value) > -1;\n                                    if ((val === args.value) || ((cellvalue === args.value) || (index)) || (cellvalue === args.value) ||\n                                        (lowerCaseValue)) {\n                                        count++;\n                                    }\n                                }\n                            }\n                        }\n                    }\n                }\n            }\n        }\n        var totalCount = count;\n        var requiredCount = this.requiredCount(args) - 1;\n        count = totalCount - requiredCount;\n        if (count > totalCount) {\n            count = totalCount;\n        }\n        if (count !== 0) {\n            var activecel = getCellIndexes(sheet.activeCell);\n            var val = this.parent.getDisplayText(sheet.rows[activecel[0]].cells[activecel[1]]).toString().toLowerCase();\n            if (val.indexOf(args.value.toString().toLowerCase()) === -1) {\n                count = count - 1;\n            }\n        }\n        args.findCount = count + ' ' + 'of' + ' ' + totalCount;\n        return;\n    };\n    WorkbookFindAndReplace.prototype.requiredCount = function (args) {\n        var sheetIndex = this.parent.activeSheetIndex;\n        var sheet = this.parent.sheets[sheetIndex];\n        var activecel = getCellIndexes(sheet.activeCell);\n        var endRow = sheet.usedRange.rowIndex;\n        var requiredCount = 0;\n        var startRow = activecel[0];\n        var endColumn = sheet.usedRange.colIndex;\n        var startColumn = activecel[1];\n        for (startRow; startRow <= endRow; startRow++) {\n            if (sheet.rows[startRow]) {\n                var row = sheet.rows[startRow];\n                if (startColumn === endColumn + 1) {\n                    startColumn = 0;\n                }\n                for (startColumn; startColumn <= endColumn; startColumn++) {\n                    if (row) {\n                        if (row.cells[startColumn] && row.cells[startColumn].value) {\n                            if (sheet.rows[startRow].cells[startColumn]) {\n                                var cellval = void 0;\n                                if (sheet.rows[startRow].cells[startColumn].format) {\n                                    var displayTxt = this.parent.getDisplayText(sheet.rows[startRow].\n                                        cells[startColumn]);\n                                    cellval = displayTxt.toString();\n                                }\n                                else {\n                                    cellval = sheet.rows[startRow].cells[startColumn].value.toString();\n                                }\n                                if (args.isCSen && !args.isEMatch) {\n                                    var index = cellval.indexOf(args.value) > -1;\n                                    if ((cellval === args.value) || (index)) {\n                                        requiredCount++;\n                                    }\n                                }\n                                else if (args.isCSen && args.isEMatch) {\n                                    if (cellval === args.value) {\n                                        requiredCount++;\n                                    }\n                                }\n                                else if (!args.isCSen && args.isEMatch) {\n                                    var val = cellval.toString().toLowerCase();\n                                    if (val === args.value) {\n                                        requiredCount++;\n                                    }\n                                }\n                                else if (!args.isCSen && !args.isEMatch) {\n                                    var val = cellval.toString().toLowerCase();\n                                    var argsVal = args.value.toString().toLowerCase();\n                                    var index = val.indexOf(argsVal) > -1;\n                                    var lowerCaseVal = val.indexOf(args.value) > -1;\n                                    if ((cellval === args.value) || ((val === argsVal) || (index)) || (val === args.value) ||\n                                        (lowerCaseVal)) {\n                                        requiredCount++;\n                                    }\n                                }\n                            }\n                        }\n                    }\n                }\n            }\n        }\n        return requiredCount;\n    };\n    WorkbookFindAndReplace.prototype.findAllValues = function (findAllArguments) {\n        var startSheet = findAllArguments.sheetIndex;\n        var sheet = this.parent.sheets[startSheet - 1];\n        var endRow = sheet.usedRange.rowIndex;\n        var rowIndex = 0;\n        var count = 0;\n        var address;\n        var endColumn = sheet.usedRange.colIndex;\n        var columnIndex = 0;\n        var sheetName;\n        var sheetLength = this.parent.sheets.length;\n        var initialSheet = findAllArguments.sheetIndex;\n        for (rowIndex; rowIndex <= endRow + 1; rowIndex++) {\n            if ((initialSheet !== 1) && (findAllArguments.sheetIndex === sheetLength)) {\n                startSheet = 1;\n            }\n            if (rowIndex > endRow && columnIndex > endColumn) {\n                if (findAllArguments.mode === 'Workbook') {\n                    startSheet++;\n                    if (initialSheet === startSheet) {\n                        if (count === 0) {\n                            return;\n                        }\n                        return;\n                    }\n                    if (startSheet > sheetLength - 1) {\n                        startSheet = 0;\n                    }\n                    sheet = this.parent.sheets[startSheet];\n                    if (sheet) {\n                        rowIndex = 0;\n                        columnIndex = 0;\n                        endColumn = sheet.usedRange.colIndex;\n                        endRow = sheet.usedRange.rowIndex;\n                        sheet = sheet;\n                    }\n                }\n            }\n            if (!isNullOrUndefined(sheet)) {\n                if (sheet.rows[rowIndex]) {\n                    var row = sheet.rows[rowIndex];\n                    if (columnIndex === endColumn + 2) {\n                        columnIndex = 0;\n                    }\n                    for (columnIndex; columnIndex <= endColumn + 1; columnIndex++) {\n                        if (row) {\n                            if (row.cells[columnIndex]) {\n                                var cell = sheet.rows[rowIndex].cells[columnIndex];\n                                if (cell) {\n                                    var cellFormat = cell.format;\n                                    var cellvalue = void 0;\n                                    if (cellFormat) {\n                                        var displayTxt = this.parent.getDisplayText(sheet.rows[rowIndex].\n                                            cells[columnIndex]);\n                                        cellvalue = displayTxt.toString();\n                                    }\n                                    else {\n                                        cellvalue = cell.value.toString();\n                                    }\n                                    if (findAllArguments.isCSen && findAllArguments.isEMatch) {\n                                        if (cellvalue === findAllArguments.value) {\n                                            address = sheet.name + '!' + getCellAddress(rowIndex, columnIndex);\n                                            findAllArguments.findCollection.push(address);\n                                            count++;\n                                        }\n                                    }\n                                    else if (findAllArguments.isCSen && !findAllArguments.isEMatch) {\n                                        var index = cellvalue.indexOf(findAllArguments.value) > -1;\n                                        if ((cellvalue === findAllArguments.value) || (index)) {\n                                            address = sheet.name + '!' + getCellAddress(rowIndex, columnIndex);\n                                            findAllArguments.findCollection.push(address);\n                                            count++;\n                                        }\n                                    }\n                                    else if (!findAllArguments.isCSen && findAllArguments.isEMatch) {\n                                        var val = cellvalue.toString().toLowerCase();\n                                        if (val === findAllArguments.value) {\n                                            address = sheet.name + '!' + getCellAddress(rowIndex, columnIndex);\n                                            findAllArguments.findCollection.push(address);\n                                            count++;\n                                        }\n                                    }\n                                    else if (!findAllArguments.isCSen && !findAllArguments.isEMatch) {\n                                        var val = cellvalue.toString().toLowerCase();\n                                        var index = val.indexOf(findAllArguments.value.toLowerCase()) > -1;\n                                        if ((val === findAllArguments.value) || ((cellvalue === findAllArguments.value) || (index)) ||\n                                            ((cellvalue === findAllArguments.value))) {\n                                            address = sheet.name + '!' + getCellAddress(rowIndex, columnIndex);\n                                            findAllArguments.findCollection.push(address);\n                                            count++;\n                                        }\n                                    }\n                                }\n                            }\n                        }\n                    }\n                }\n            }\n        }\n        if (count === 0) {\n            return;\n        }\n        return;\n    };\n    /**\n     * Gets the module name.\n     * @returns string\n     */\n    WorkbookFindAndReplace.prototype.getModuleName = function () {\n        return 'workbookfindAndReplace';\n    };\n    return WorkbookFindAndReplace;\n}());\nexport { WorkbookFindAndReplace };\n","import { setColumn } from '../base/index';\nimport { applyLockCells } from '../common/index';\nimport { protectsheetHandler, protectSheetWorkBook, updateToggle, setLockCells } from '../common/index';\nimport { unprotectsheetHandler } from '../common/index';\nimport { getRangeIndexes, getSwapRange } from '../common/index';\nimport { isUndefined } from '@syncfusion/ej2-base';\n/**\n * The `WorkbookSpreadSheet` module is used to handle the Protecting functionalities in Workbook.\n */\nvar WorkbookProtectSheet = /** @class */ (function () {\n    /**\n     * Constructor for edit module in Workbook.\n     * @private\n     */\n    function WorkbookProtectSheet(workbook) {\n        this.parent = workbook;\n        this.addEventListener();\n    }\n    WorkbookProtectSheet.prototype.protectsheetHandler = function (args) {\n        var sheet = this.parent.getActiveSheet();\n        this.parent.setSheetPropertyOnMute(sheet, 'protectSettings', {\n            selectCells: args.selectCells, formatCells: args.formatCells,\n            formatColumns: args.formatColumns, formatRows: args.formatRows, insertLink: args.insertLink\n        });\n        this.parent.notify(protectSheetWorkBook, sheet.protectSettings);\n        this.parent.notify(updateToggle, { props: 'Protect' });\n        sheet.columns.forEach(function (column) {\n            if (column && isUndefined(column.isLocked)) {\n                column.isLocked = true;\n            }\n        });\n    };\n    WorkbookProtectSheet.prototype.unprotectsheetHandler = function (args) {\n        var sheet = this.parent.getActiveSheet();\n        if (args.sheet) {\n            sheet = this.parent.sheets[args.sheet];\n        }\n        sheet.protectSettings.formatCells = sheet.protectSettings.formatColumns = false;\n        sheet.protectSettings.formatRows = sheet.protectSettings.selectCells = false;\n        this.parent.setSheetPropertyOnMute(sheet, 'isProtected', false);\n        this.parent.notify(protectSheetWorkBook, sheet.protectSettings);\n        this.parent.notify(updateToggle, { props: 'Protect' });\n    };\n    /**\n     * To destroy the edit module.\n     * @return {void}\n     * @hidden\n     */\n    WorkbookProtectSheet.prototype.destroy = function () {\n        this.removeEventListener();\n        this.parent = null;\n    };\n    WorkbookProtectSheet.prototype.addEventListener = function () {\n        this.parent.on(protectsheetHandler, this.protectsheetHandler, this);\n        this.parent.on(unprotectsheetHandler, this.unprotectsheetHandler, this);\n        this.parent.on(setLockCells, this.lockCells, this);\n    };\n    WorkbookProtectSheet.prototype.removeEventListener = function () {\n        if (!this.parent.isDestroyed) {\n            this.parent.off(protectsheetHandler, this.protectsheetHandler);\n            this.parent.off(setLockCells, this.lockCells);\n            this.parent.off(protectsheetHandler, this.unprotectsheetHandler);\n        }\n    };\n    WorkbookProtectSheet.prototype.lockCells = function (args) {\n        var sheet = this.parent.getActiveSheet();\n        var range;\n        if (args) {\n            range = args.range;\n        }\n        else {\n            range = sheet.selectedRange;\n        }\n        var indexes = typeof (range) === 'object' ? range :\n            getSwapRange(getRangeIndexes(range));\n        if (indexes[0] === 0 && indexes[2] === sheet.rowCount - 1) {\n            for (var i = indexes[1]; i <= indexes[3]; i++) {\n                setColumn(sheet, i, { isLocked: args.isLocked });\n            }\n        }\n        for (var i = indexes[0]; i <= indexes[2]; i++) {\n            for (var j = indexes[1]; j <= indexes[3]; j++) {\n                if (this.parent.getActiveSheet().id === sheet.id) {\n                    this.parent.notify(applyLockCells, { rowIdx: i, colIdx: j, isLocked: args.isLocked\n                    });\n                }\n            }\n        }\n    };\n    /**\n     * Get the module name.\n     * @returns string\n     * @private\n     */\n    WorkbookProtectSheet.prototype.getModuleName = function () {\n        return 'workbookProtectSheet';\n    };\n    return WorkbookProtectSheet;\n}());\nexport { WorkbookProtectSheet };\n","import { getCell, setCell } from '../base/index';\nimport { setMerge, getSwapRange, getRangeIndexes, mergedRange, applyMerge, activeCellMergedRange } from './../common/index';\nimport { insertMerge, activeCellChanged, pasteMerge, getCellIndexes, checkIsFormula, setCellFormat } from './../common/index';\nimport { isNullOrUndefined } from '@syncfusion/ej2-base';\n/**\n * The `WorkbookMerge` module is used to merge the range of cells.\n */\nvar WorkbookMerge = /** @class */ (function () {\n    /**\n     * Constructor for the workbook merge module.\n     * @private\n     */\n    function WorkbookMerge(parent) {\n        this.parent = parent;\n        this.addEventListener();\n    }\n    WorkbookMerge.prototype.merge = function (args) {\n        if (args.isAction) {\n            this.parent.notify('actionBegin', { eventArgs: args, action: 'merge' });\n            if (!args.model) {\n                args.model = [];\n            }\n        }\n        if (typeof (args.range) === 'string') {\n            args.range = getRangeIndexes(args.range);\n        }\n        args.range = getSwapRange(args.range);\n        var sheet = args.sheet || this.parent.getActiveSheet();\n        if (!args.skipChecking) {\n            this.mergedRange(args);\n        }\n        if (!args.merge || args.type === 'All') {\n            this.mergeAll(args);\n            if (args.refreshRibbon) {\n                this.parent.notify(activeCellChanged, null);\n            }\n        }\n        else if (args.type === 'Horizontally') {\n            this.mergeHorizontally(args);\n        }\n        else if (args.type === 'Vertically') {\n            this.mergeVertically(args);\n        }\n        this.parent.setUsedRange(args.range[2], args.range[3]);\n        if (args.isAction) {\n            this.parent.notify('actionComplete', { eventArgs: args, action: 'merge' });\n        }\n        if (this.parent.sheets.indexOf(sheet) === this.parent.activeSheetIndex) {\n            this.parent.notify('selectRange', { indexes: getRangeIndexes(sheet.selectedRange), skipChecking: true });\n        }\n    };\n    WorkbookMerge.prototype.mergeAll = function (args) {\n        var rowSpan = 0;\n        var cell;\n        args.range = args.range;\n        var colSpan;\n        var value;\n        var sheet = args.sheet || this.parent.getActiveSheet();\n        var curCell;\n        var startCell = getCell(args.range[0], args.range[1], sheet);\n        var border = startCell ? (startCell.style ? startCell.style.borderLeft : null) : null;\n        if (border === 'none') {\n            border = startCell.style.borderRight !== 'none' ? startCell.style.borderRight :\n                (startCell.style.borderTop ? startCell.style.borderTop : null);\n        }\n        if (border === 'none') {\n            border = startCell.style.borderBottom !== 'none' ? startCell.style.borderBottom : null;\n        }\n        if (!isNullOrUndefined(startCell) && !isNullOrUndefined(border)) {\n            startCell.style.borderBottom = '';\n            startCell.style.borderLeft = '';\n            startCell.style.borderTop = '';\n            startCell.style.borderRight = '';\n        }\n        for (var i = args.range[0]; i <= args.range[2]; i++) {\n            colSpan = 0;\n            if (args.isAction) {\n                args.model.push({ cells: [] });\n            }\n            for (var j = args.range[1]; j <= args.range[3]; j++) {\n                cell = getCell(i, j, sheet);\n                if (cell && (cell.value || cell.formula) && !value) {\n                    value = cell.formula || cell.value;\n                }\n                if (args.isAction && args.merge) {\n                    args.model[i - args.range[0]].cells[j - args.range[1]] = {};\n                    Object.assign(args.model[i - args.range[0]].cells[j - args.range[1]], cell);\n                }\n                if (sheet.rows[i] && sheet.rows[i].cells && sheet.rows[i].cells[j]) {\n                    delete sheet.rows[i].cells[j].rowSpan;\n                    delete sheet.rows[i].cells[j].colSpan;\n                    if (!args.merge && !args.isAction && args.model && args.model[i - args.range[0]] && args.model[i - args.range[0]].\n                        cells[j - args.range[1]] && args.model[i - args.range[0]].cells[j - args.range[1]] !== {}) {\n                        setCell(i, j, sheet, args.model[i - args.range[0]].cells[j - args.range[1]]);\n                    }\n                }\n                if (args.merge) {\n                    cell = new Object();\n                    if (i === args.range[0] && j === args.range[1]) {\n                        if (args.range[3] - args.range[1] > 0) {\n                            cell.colSpan = (args.range[3] - args.range[1]) + 1;\n                        }\n                        if (args.range[2] - args.range[0] > 0) {\n                            cell.rowSpan = (args.range[2] - args.range[0]) + 1;\n                        }\n                        setCell(args.range[0], args.range[1], sheet, cell, true);\n                        continue;\n                    }\n                    else {\n                        if (i !== args.range[0]) {\n                            cell.rowSpan = -rowSpan;\n                        }\n                        if (j !== args.range[1]) {\n                            colSpan++;\n                            cell.colSpan = -colSpan;\n                        }\n                        if (sheet.rows[i] && sheet.rows[i].cells && sheet.rows[i].cells[j]) {\n                            delete sheet.rows[i].cells[j].value;\n                            delete sheet.rows[i].cells[j].formula;\n                        }\n                        curCell = getCell(i, j, sheet) || {};\n                        setCell(i, j, sheet, Object.assign(cell, curCell));\n                    }\n                }\n                if (!args.preventRefresh) {\n                    this.parent.notify(applyMerge, { rowIdx: i, colIdx: j });\n                }\n            }\n            rowSpan++;\n        }\n        if (args.merge) {\n            cell = this.getCellValue(args.range[0], args.range[1], value, sheet);\n            setCell(args.range[0], args.range[1], sheet, cell, true);\n            if (!args.preventRefresh) {\n                this.parent.notify(applyMerge, { rowIdx: args.range[0], colIdx: args.range[1] });\n            }\n        }\n        if (!isNullOrUndefined(border)) {\n            this.parent.notify(setCellFormat, { style: { border: border }, range: args.range, onActionUpdate: true });\n        }\n    };\n    WorkbookMerge.prototype.mergeHorizontally = function (args) {\n        var mergeCount;\n        args.range = args.range;\n        var cell;\n        var sheet = args.sheet || this.parent.getActiveSheet();\n        var newValue;\n        var rowIdx;\n        var curCell;\n        for (var i = args.range[0]; i <= args.range[2]; i++) {\n            mergeCount = 0;\n            if (args.isAction) {\n                args.model.push({ cells: [] });\n            }\n            for (var j = args.range[1]; j <= args.range[3]; j++) {\n                curCell = getCell(i, j, sheet);\n                cell = new Object();\n                if (args.isAction) {\n                    args.model[i - args.range[0]].cells[j - args.range[1]] = {};\n                    Object.assign(args.model[i - args.range[0]].cells[j - args.range[1]], curCell);\n                }\n                if (j === args.range[1]) {\n                    if (i === args.range[0]) {\n                        continue;\n                    }\n                    rowIdx = i - 1;\n                    if (sheet.rows[rowIdx] && sheet.rows[rowIdx].cells && sheet.rows[rowIdx].cells[j]) {\n                        delete sheet.rows[rowIdx].cells[j].rowSpan;\n                    }\n                    cell = this.getCellValue(rowIdx, j, newValue, sheet);\n                    if (args.range[3] - args.range[1] > 0) {\n                        cell.colSpan = (args.range[3] - args.range[1]) + 1;\n                    }\n                    newValue = null;\n                    setCell(rowIdx, j, sheet, cell, true);\n                }\n                else {\n                    if (curCell && (curCell.value || curCell.formula) && !newValue) {\n                        newValue = curCell.formula || curCell.value;\n                    }\n                    rowIdx = i;\n                    if (sheet.rows[rowIdx] && sheet.rows[rowIdx].cells && sheet.rows[rowIdx].cells[j]) {\n                        delete sheet.rows[rowIdx].cells[j].rowSpan;\n                        delete sheet.rows[rowIdx].cells[j].value;\n                        delete sheet.rows[rowIdx].cells[j].formula;\n                    }\n                    mergeCount++;\n                    cell.colSpan = -mergeCount;\n                    setCell(rowIdx, j, sheet, cell, true);\n                }\n                this.parent.notify(applyMerge, { rowIdx: rowIdx, colIdx: j });\n            }\n        }\n        if (sheet.rows[args.range[2]] && sheet.rows[args.range[2]].cells && sheet.rows[args.range[2]].cells[args.range[1]]) {\n            delete sheet.rows[args.range[2]].cells[args.range[1]].rowSpan;\n        }\n        cell = this.getCellValue(args.range[2], args.range[1], newValue, sheet);\n        if (args.range[3] - args.range[1] > 0) {\n            cell.colSpan = (args.range[3] - args.range[1]) + 1;\n        }\n        setCell(args.range[2], args.range[1], sheet, cell, true);\n        this.parent.notify(applyMerge, { rowIdx: args.range[2], colIdx: args.range[1] });\n    };\n    WorkbookMerge.prototype.getCellValue = function (rowIdx, colIdx, value, sheet) {\n        var cell = new Object();\n        var curCell = getCell(rowIdx, colIdx, sheet);\n        if (value && (!curCell || (!curCell.value && !curCell.formula))) {\n            if (checkIsFormula(value)) {\n                cell.formula = value;\n            }\n            else {\n                cell.value = value;\n            }\n        }\n        return cell;\n    };\n    WorkbookMerge.prototype.mergeVertically = function (args) {\n        var rowSpan = 0;\n        args.range = args.range;\n        var sheet = args.sheet || this.parent.getActiveSheet();\n        var cell;\n        var newValue;\n        var colIdx;\n        var curCell;\n        for (var i = args.range[1]; i <= args.range[3]; i++) {\n            for (var j = args.range[0]; j <= args.range[2]; j++) {\n                curCell = getCell(j, i, sheet);\n                if (args.isAction) {\n                    if (args.model[j - args.range[0]] === undefined) {\n                        args.model[j - args.range[0]] = { cells: [] };\n                    }\n                    args.model[j - args.range[0]].cells[i - args.range[1]] = {};\n                    Object.assign(args.model[j - args.range[0]].cells[i - args.range[1]], curCell);\n                }\n                if (j === args.range[0]) {\n                    rowSpan = 0;\n                    if (i === args.range[1]) {\n                        continue;\n                    }\n                    colIdx = i - 1;\n                    if (sheet.rows[j] && sheet.rows[j].cells && sheet.rows[j].cells[colIdx]) {\n                        delete sheet.rows[j].cells[colIdx].colSpan;\n                    }\n                    cell = this.getCellValue(j, colIdx, newValue, sheet);\n                    if (args.range[2] - args.range[0] > 0) {\n                        cell.rowSpan = (args.range[2] - args.range[0]) + 1;\n                    }\n                    newValue = null;\n                    setCell(j, colIdx, sheet, cell, true);\n                }\n                else {\n                    cell = new Object();\n                    if (curCell && (curCell.value || curCell.formula) && !newValue) {\n                        newValue = curCell.formula || curCell.value;\n                    }\n                    rowSpan++;\n                    colIdx = i;\n                    if (sheet.rows[j] && sheet.rows[j].cells && sheet.rows[j].cells[colIdx]) {\n                        delete sheet.rows[j].cells[colIdx].colSpan;\n                        delete sheet.rows[j].cells[colIdx].value;\n                        delete sheet.rows[j].cells[colIdx].formula;\n                    }\n                    cell.rowSpan = -rowSpan;\n                    setCell(j, colIdx, sheet, cell, true);\n                }\n                this.parent.notify(applyMerge, { rowIdx: j, colIdx: colIdx });\n            }\n        }\n        if (sheet.rows[args.range[0]] && sheet.rows[args.range[0]].cells && sheet.rows[args.range[0]].cells[args.range[3]]) {\n            delete sheet.rows[args.range[0]].cells[args.range[3]].colSpan;\n        }\n        cell = this.getCellValue(args.range[0], args.range[1], newValue, sheet);\n        if (args.range[2] - args.range[0] > 0) {\n            cell.rowSpan = (args.range[2] - args.range[0]) + 1;\n        }\n        setCell(args.range[0], args.range[3], sheet, cell, true);\n        this.parent.notify(applyMerge, { rowIdx: args.range[0], colIdx: args.range[3] });\n    };\n    WorkbookMerge.prototype.activeCellRange = function (args) {\n        args.range = args.range;\n        var sheet = this.parent.getActiveSheet();\n        var cell = getCell(args.range[0], args.range[1], sheet);\n        if (cell) {\n            if (!isNullOrUndefined(cell.rowSpan) && cell.rowSpan < 0) {\n                args.range[0] += cell.rowSpan;\n                if (args.insertCount) {\n                    args.range[0] -= args.insertCount;\n                }\n            }\n            if (!isNullOrUndefined(cell.colSpan) && cell.colSpan < 0) {\n                args.range[1] += cell.colSpan;\n                if (args.insertCount) {\n                    args.range[1] -= args.insertCount;\n                }\n            }\n            cell = getCell(args.range[0], args.range[1], sheet);\n            if (cell) {\n                if (cell.rowSpan > 1 && (args.range[0] + (cell.rowSpan - 1) >= args.range[2] || args.insertCount)) {\n                    args.range[2] = args.range[0] + (cell.rowSpan - 1);\n                }\n                if (cell.colSpan > 1 && (args.range[1] + (cell.colSpan - 1) >= args.range[3] || args.insertCount)) {\n                    args.range[3] = args.range[1] + (cell.colSpan - 1);\n                }\n            }\n        }\n    };\n    WorkbookMerge.prototype.mergedRange = function (args) {\n        if (typeof (args.range) === 'string') {\n            args.range = getRangeIndexes(args.range);\n        }\n        if (args.range[0] <= args.range[2] && args.range[1] <= args.range[3]) {\n            this.forward(args);\n        }\n        else if (args.range[0] >= args.range[2] && args.range[1] >= args.range[3]) {\n            this.reverse(args);\n        }\n        else if (args.range[0] < args.range[2] && args.range[1] > args.range[3]) {\n            this.forwardReverse(args);\n        }\n        else if (args.range[0] > args.range[2] && args.range[1] < args.range[3]) {\n            this.reverseForward(args);\n        }\n    };\n    WorkbookMerge.prototype.forward = function (args) {\n        args.range = args.range;\n        var sheet = args.sheet || this.parent.getActiveSheet();\n        var cell = getCell(args.range[0], args.range[1], sheet);\n        var endRowIdx;\n        var endColIdx;\n        var rowIdx = endRowIdx = args.range[0];\n        var colIdx = endColIdx = args.range[1];\n        if (cell) {\n            if (!isNullOrUndefined(cell.rowSpan) && cell.rowSpan < 0) {\n                rowIdx = endRowIdx = args.range[0] + cell.rowSpan;\n            }\n            if (!isNullOrUndefined(cell.colSpan) && cell.colSpan < 0) {\n                colIdx = endColIdx = args.range[1] + cell.colSpan;\n            }\n            cell = getCell(rowIdx, colIdx, sheet);\n            if (cell) {\n                if (cell.rowSpan > 1) {\n                    endRowIdx += (cell.rowSpan - 1);\n                    if (rowIdx + (cell.rowSpan - 1) >= args.range[2]) {\n                        args.range[2] = args.range[0];\n                        args.range[2] = rowIdx + (cell.rowSpan - 1);\n                    }\n                }\n                if (cell.colSpan > 1) {\n                    endColIdx += (cell.colSpan - 1);\n                    if (colIdx + (cell.colSpan - 1) >= args.range[3]) {\n                        args.range[3] = args.range[1];\n                        args.range[3] = colIdx + (cell.colSpan - 1);\n                    }\n                }\n            }\n        }\n        args.range[0] = rowIdx;\n        args.range[1] = colIdx;\n        if (args.range[0] === rowIdx && args.range[1] === colIdx && args.range[2] === endRowIdx && args.range[3] === endColIdx) {\n            args.isActiveCell = true;\n        }\n        if (args.skipChecking) {\n            return;\n        }\n        for (var i = args.range[1]; i <= args.range[3]; i++) {\n            cell = getCell(args.range[2], i, sheet);\n            if (cell) {\n                rowIdx = args.range[2];\n                colIdx = i;\n                if (!isNullOrUndefined(cell.colSpan) && cell.colSpan < 0) {\n                    colIdx += cell.colSpan;\n                    if (colIdx < args.range[1]) {\n                        args.range[1] = colIdx;\n                    }\n                }\n                if (!isNullOrUndefined(cell.rowSpan) && cell.rowSpan < 0) {\n                    rowIdx += cell.rowSpan;\n                    if (rowIdx < args.range[0]) {\n                        args.range[0] = rowIdx;\n                    }\n                }\n                cell = getCell(rowIdx, colIdx, sheet);\n                if (cell) {\n                    if (cell.colSpan > 1 && colIdx + (cell.colSpan - 1) > args.range[3]) {\n                        args.range[3] = colIdx;\n                        args.range[3] = colIdx + (cell.colSpan - 1);\n                    }\n                    if (cell.rowSpan > 1 && rowIdx + (cell.rowSpan - 1) > args.range[2]) {\n                        args.range[2] = rowIdx;\n                        args.range[2] = rowIdx + (cell.rowSpan - 1);\n                    }\n                }\n            }\n        }\n        var startRowIdx;\n        var startColIdx;\n        for (var i = args.range[1]; i <= args.range[3]; i++) {\n            cell = getCell(args.range[0], i, sheet);\n            if (cell) {\n                startColIdx = i;\n                startRowIdx = args.range[0];\n                if (!isNullOrUndefined(cell.colSpan) && cell.colSpan < 0) {\n                    startColIdx += cell.colSpan;\n                    if (startColIdx < args.range[1]) {\n                        args.range[1] = startColIdx;\n                    }\n                }\n                if (!isNullOrUndefined(cell.rowSpan) && cell.rowSpan < 0) {\n                    startRowIdx += cell.rowSpan;\n                    if (startRowIdx < args.range[0]) {\n                        args.range[0] = startRowIdx;\n                    }\n                }\n            }\n        }\n        for (var i = args.range[0]; i <= args.range[2]; i++) {\n            cell = getCell(i, args.range[3], sheet);\n            if (cell) {\n                rowIdx = i;\n                colIdx = args.range[3];\n                if (!isNullOrUndefined(cell.rowSpan) && cell.rowSpan < 0) {\n                    rowIdx += cell.rowSpan;\n                    if (rowIdx < args.range[0]) {\n                        args.range[0] = rowIdx;\n                    }\n                }\n                if (!isNullOrUndefined(cell.colSpan) && cell.colSpan < 0) {\n                    colIdx += cell.colSpan;\n                    if (colIdx < args.range[1]) {\n                        args.range[1] = colIdx;\n                    }\n                }\n                cell = getCell(rowIdx, colIdx, sheet);\n                if (cell) {\n                    if (cell.rowSpan > 1 && rowIdx + (cell.rowSpan - 1) > args.range[2]) {\n                        args.range[2] = rowIdx;\n                        args.range[2] = rowIdx + (cell.rowSpan - 1);\n                    }\n                    if (cell.colSpan > 1 && colIdx + (cell.colSpan - 1) > args.range[3]) {\n                        args.range[3] = colIdx;\n                        args.range[3] = colIdx + (cell.colSpan - 1);\n                    }\n                }\n            }\n        }\n    };\n    WorkbookMerge.prototype.forwardReverse = function (args) {\n        var sheet = this.parent.getActiveSheet();\n        args.range = args.range;\n        var colIndex = args.range[1];\n        var cell = getCell(args.range[0], args.range[1], sheet);\n        var rowIndex = args.range[0];\n        if (cell) {\n            if (!isNullOrUndefined(cell.colSpan) && cell.colSpan < 0) {\n                colIndex += cell.colSpan;\n                if (args.range[3] >= colIndex) {\n                    args.range[3] = colIndex;\n                }\n            }\n            if (!isNullOrUndefined(cell.rowSpan) && cell.rowSpan < 0) {\n                rowIndex += cell.rowSpan;\n                if (rowIndex < args.range[0]) {\n                    args.range[0] = rowIndex;\n                }\n            }\n            cell = getCell(rowIndex, colIndex, sheet);\n            if (cell) {\n                if (cell.rowSpan > 1 && rowIndex + (cell.rowSpan - 1) >= args.range[2]) {\n                    args.range[2] = rowIndex + (cell.rowSpan - 1);\n                }\n                if (cell.colSpan > 1 && colIndex + (cell.colSpan - 1) >= args.range[1]) {\n                    args.range[1] = colIndex + (cell.colSpan - 1);\n                }\n            }\n        }\n        args.range[0] = rowIndex;\n        if (args.skipChecking) {\n            return;\n        }\n        var rowIdx;\n        var cellIdx;\n        for (var i = args.range[3]; i <= args.range[1]; i++) {\n            cell = getCell(args.range[2], i, sheet);\n            if (cell) {\n                cellIdx = i;\n                rowIdx = args.range[2];\n                if (!isNullOrUndefined(cell.rowSpan) && cell.rowSpan < 0) {\n                    rowIdx += cell.rowSpan;\n                    if (rowIdx < args.range[0]) {\n                        args.range[0] = rowIdx;\n                    }\n                }\n                if (!isNullOrUndefined(cell.colSpan) && cell.colSpan < 0) {\n                    cellIdx += cell.colSpan;\n                    if (cellIdx < args.range[3]) {\n                        args.range[3] = cellIdx;\n                    }\n                }\n                cell = getCell(rowIdx, cellIdx, sheet);\n                if (cell) {\n                    if (cell.rowSpan > 1 && rowIdx + (cell.rowSpan - 1) > args.range[2]) {\n                        args.range[2] = rowIdx + (cell.rowSpan - 1);\n                    }\n                    if (cell.colSpan > 1 && cellIdx + (cell.colSpan - 1) > args.range[1]) {\n                        args.range[1] = cellIdx + (cell.colSpan - 1);\n                    }\n                }\n            }\n        }\n        var startRowIndex;\n        for (var i = args.range[3]; i <= args.range[1]; i++) {\n            cell = getCell(args.range[0], i, sheet);\n            if (cell) {\n                cellIdx = i;\n                startRowIndex = args.range[0];\n                if (!isNullOrUndefined(cell.rowSpan) && cell.rowSpan < 0) {\n                    startRowIndex += cell.rowSpan;\n                    if (startRowIndex < args.range[0]) {\n                        args.range[0] = startRowIndex;\n                    }\n                }\n                if (!isNullOrUndefined(cell.colSpan) && cell.colSpan < 0) {\n                    cellIdx += cell.colSpan;\n                }\n                cell = getCell(startRowIndex, cellIdx, sheet);\n                if (cell) {\n                    if (cell.rowSpan > 1 && startRowIndex + (cell.rowSpan - 1) > args.range[2]) {\n                        args.range[2] = startRowIndex + (cell.rowSpan - 1);\n                    }\n                    if (cell.colSpan > 1 && cellIdx + (cell.colSpan - 1) > args.range[1]) {\n                        args.range[1] = cellIdx;\n                        args.range[1] = cellIdx + (cell.colSpan - 1);\n                    }\n                }\n            }\n        }\n        var colIdx;\n        for (var i = args.range[0]; i <= args.range[2]; i++) {\n            cell = getCell(i, args.range[3], sheet);\n            if (cell) {\n                startRowIndex = i;\n                colIdx = args.range[3];\n                if (!isNullOrUndefined(cell.rowSpan) && cell.rowSpan < 0) {\n                    startRowIndex += cell.rowSpan;\n                    if (startRowIndex < args.range[0]) {\n                        args.range[0] = startRowIndex;\n                    }\n                }\n                if (!isNullOrUndefined(cell.colSpan) && cell.colSpan < 0) {\n                    colIdx += cell.colSpan;\n                    if (colIdx < args.range[3]) {\n                        args.range[3] = colIdx;\n                    }\n                }\n                cell = getCell(startRowIndex, colIdx, sheet);\n                if (cell) {\n                    if (cell.rowSpan > 1 && startRowIndex + (cell.rowSpan - 1) > args.range[2]) {\n                        args.range[2] = startRowIndex;\n                        args.range[2] = startRowIndex + (cell.rowSpan - 1);\n                    }\n                    if (cell.colSpan > 1 && colIdx + (cell.colSpan - 1) > args.range[1]) {\n                        args.range[1] = colIdx;\n                        args.range[1] = colIdx + (cell.colSpan - 1);\n                    }\n                }\n            }\n        }\n    };\n    WorkbookMerge.prototype.reverse = function (args) {\n        args.range = args.range;\n        var colnIdx = args.range[1];\n        var sheet = args.sheet || this.parent.getActiveSheet();\n        var cell = getCell(args.range[0], args.range[1], sheet);\n        var rowIdx = args.range[0];\n        if (cell) {\n            if (!isNullOrUndefined(cell.colSpan) && cell.colSpan < 0) {\n                colnIdx += cell.colSpan;\n            }\n            if (!isNullOrUndefined(cell.rowSpan) && cell.rowSpan < 0) {\n                rowIdx += cell.rowSpan;\n            }\n            if (args.range[2] >= rowIdx) {\n                args.range[2] = rowIdx;\n                args.isActiveCell = true;\n            }\n            if (args.range[3] >= colnIdx) {\n                args.range[3] = colnIdx;\n                if (args.range[2] === rowIdx) {\n                    args.isActiveCell = true;\n                }\n            }\n            else if (args.isActiveCell) {\n                args.isActiveCell = false;\n            }\n            cell = getCell(rowIdx, colnIdx, sheet);\n            if (cell) {\n                if (cell.rowSpan > 1 && rowIdx + (cell.rowSpan - 1) >= args.range[0]) {\n                    args.range[0] = rowIdx;\n                    args.range[0] = rowIdx + (cell.rowSpan - 1);\n                }\n                if (cell.colSpan > 1 && colnIdx + (cell.colSpan - 1) >= args.range[1]) {\n                    args.range[1] = colnIdx;\n                    args.range[1] = colnIdx + (cell.colSpan - 1);\n                }\n            }\n        }\n        var colIdx = args.range[3];\n        if (args.skipChecking) {\n            return;\n        }\n        for (var i = args.range[3]; i <= args.range[1]; i++) {\n            cell = getCell(args.range[2], i, sheet);\n            if (cell) {\n                colIdx = i;\n                rowIdx = args.range[2];\n                if (!isNullOrUndefined(cell.rowSpan) && cell.rowSpan < 0) {\n                    rowIdx += cell.rowSpan;\n                    if (rowIdx < args.range[2]) {\n                        args.range[2] = rowIdx;\n                    }\n                }\n                if (!isNullOrUndefined(cell.colSpan) && cell.colSpan < 0) {\n                    colIdx += cell.colSpan;\n                    if (colIdx < args.range[3]) {\n                        args.range[3] = colIdx;\n                    }\n                }\n                cell = getCell(rowIdx, colIdx, sheet);\n                if (cell) {\n                    if (cell.rowSpan > 1 && rowIdx + (cell.rowSpan - 1) > args.range[0]) {\n                        args.range[0] = rowIdx;\n                        args.range[0] = rowIdx + (cell.rowSpan - 1);\n                    }\n                    if (cell.colSpan > 1 && colIdx + (cell.colSpan - 1) > args.range[1]) {\n                        args.range[1] = colIdx;\n                        args.range[1] = colIdx + (cell.colSpan - 1);\n                    }\n                }\n            }\n        }\n        colIdx = args.range[3];\n        for (var i = args.range[3]; i <= args.range[1]; i++) {\n            cell = getCell(args.range[0], i, sheet);\n            if (cell) {\n                colIdx = i;\n                rowIdx = args.range[0];\n                if (!isNullOrUndefined(cell.colSpan) && cell.colSpan < 0) {\n                    colIdx += cell.colSpan;\n                }\n                if (!isNullOrUndefined(cell.rowSpan) && cell.rowSpan < 0) {\n                    rowIdx += cell.rowSpan;\n                }\n                cell = getCell(rowIdx, colIdx, sheet);\n                if (cell) {\n                    if (cell.colSpan > 1 && colIdx + (cell.colSpan - 1) > args.range[1]) {\n                        args.range[1] = colIdx;\n                        args.range[1] = colIdx + (cell.colSpan - 1);\n                    }\n                    if (cell.rowSpan > 1 && rowIdx + (cell.rowSpan - 1) > args.range[0]) {\n                        args.range[0] = rowIdx;\n                        args.range[0] = rowIdx + (cell.rowSpan - 1);\n                    }\n                }\n            }\n        }\n        var cellIndex;\n        var rIdx;\n        for (var i = args.range[2]; i <= args.range[0]; i++) {\n            cell = getCell(i, args.range[3], sheet);\n            if (cell) {\n                rIdx = i;\n                cellIndex = args.range[3];\n                if (!isNullOrUndefined(cell.rowSpan) && cell.rowSpan < 0) {\n                    rIdx += cell.rowSpan;\n                    if (rIdx < args.range[2]) {\n                        args.range[2] = rIdx;\n                    }\n                }\n                if (!isNullOrUndefined(cell.colSpan) && cell.colSpan < 0) {\n                    cellIndex += cell.colSpan;\n                    if (cellIndex < args.range[3]) {\n                        args.range[3] = cellIndex;\n                    }\n                }\n                cell = getCell(rIdx, cellIndex, sheet);\n                if (cell) {\n                    if (cell.rowSpan > 1 && rIdx + (cell.rowSpan - 1) > args.range[0]) {\n                        args.range[0] = rIdx;\n                        args.range[0] = rIdx + (cell.rowSpan - 1);\n                    }\n                    if (cell.colSpan > 1 && cellIndex + (cell.colSpan - 1) > args.range[1]) {\n                        args.range[1] = cellIndex;\n                        args.range[1] = cellIndex + (cell.colSpan - 1);\n                    }\n                }\n            }\n        }\n    };\n    WorkbookMerge.prototype.reverseForward = function (args) {\n        args.range = args.range;\n        var sheet = args.sheet || this.parent.getActiveSheet();\n        var rIdx = args.range[0];\n        var cIdx = args.range[1];\n        var cell = getCell(args.range[0], args.range[1], sheet);\n        if (cell) {\n            if (!isNullOrUndefined(cell.rowSpan) && cell.rowSpan < 0) {\n                rIdx += cell.rowSpan;\n                if (args.range[2] >= rIdx) {\n                    args.range[2] = rIdx;\n                }\n            }\n            if (!isNullOrUndefined(cell.colSpan) && cell.colSpan < 0) {\n                cIdx += cell.colSpan;\n            }\n            cell = getCell(rIdx, cIdx, sheet);\n            if (cell) {\n                if (cell.rowSpan > 1 && rIdx + (cell.rowSpan - 1) >= args.range[0]) {\n                    args.range[0] = rIdx;\n                    args.range[0] = rIdx + (cell.rowSpan - 1);\n                }\n                if (cell.colSpan > 1 && cIdx + (cell.colSpan - 1) >= args.range[3]) {\n                    args.range[3] = args.range[1];\n                    args.range[3] = cIdx + (cell.colSpan - 1);\n                }\n            }\n        }\n        if (args.skipChecking) {\n            return;\n        }\n        var cIndex = args.range[3];\n        var rIndex;\n        for (var i = args.range[1]; i <= args.range[3]; i++) {\n            cell = getCell(args.range[2], i, sheet);\n            if (cell) {\n                rIndex = args.range[2];\n                cIndex = i;\n                if (!isNullOrUndefined(cell.rowSpan) && cell.rowSpan < 0) {\n                    rIndex += cell.rowSpan;\n                    if (rIndex < args.range[2]) {\n                        args.range[2] = rIndex;\n                    }\n                }\n                if (!isNullOrUndefined(cell.colSpan) && cell.colSpan < 0) {\n                    cIndex += cell.colSpan;\n                    if (cIndex < args.range[1]) {\n                        args.range[1] = cIndex;\n                    }\n                }\n                cell = getCell(rIndex, cIndex, sheet);\n                if (cell) {\n                    if (cell.colSpan > 1 && cIndex + (cell.colSpan - 1) > args.range[3]) {\n                        args.range[3] = cIndex + (cell.colSpan - 1);\n                    }\n                    if (cell.rowSpan > 1 && (cell.rowSpan - 1) + rIndex > args.range[0]) {\n                        args.range[0] = (cell.rowSpan - 1) + rIndex;\n                    }\n                }\n            }\n        }\n        var sRowIdx;\n        var sColIdx;\n        for (var i = args.range[1]; i <= args.range[3]; i++) {\n            cell = getCell(args.range[0], i, sheet);\n            if (cell) {\n                sColIdx = i;\n                sRowIdx = args.range[0];\n                if (!isNullOrUndefined(cell.colSpan) && cell.colSpan < 0) {\n                    sColIdx += cell.colSpan;\n                    if (sColIdx < args.range[1]) {\n                        args.range[1] = sColIdx;\n                    }\n                }\n                if (!isNullOrUndefined(cell.rowSpan) && cell.rowSpan < 0) {\n                    sRowIdx += cell.rowSpan;\n                }\n                cell = getCell(sRowIdx, sColIdx, sheet);\n                if (cell) {\n                    if (cell.rowSpan > 1 && sRowIdx + (cell.rowSpan - 1) > args.range[0]) {\n                        args.range[0] = sRowIdx + (cell.rowSpan - 1);\n                    }\n                }\n            }\n        }\n        var cellIndex;\n        for (var i = args.range[2]; i <= args.range[0]; i++) {\n            cell = getCell(i, args.range[3], sheet);\n            if (cell) {\n                rIndex = i;\n                cellIndex = args.range[3];\n                if (!isNullOrUndefined(cell.rowSpan) && cell.rowSpan < 0) {\n                    rIndex += cell.rowSpan;\n                    if (rIndex < args.range[2]) {\n                        args.range[2] = rIndex;\n                    }\n                }\n                if (!isNullOrUndefined(cell.colSpan) && cell.colSpan < 0) {\n                    cellIndex += cell.colSpan;\n                    if (cellIndex < args.range[1]) {\n                        args.range[1] = cellIndex;\n                    }\n                }\n                cell = getCell(rIndex, cellIndex, sheet);\n                if (cell) {\n                    if (cell.rowSpan > 1 && (cell.rowSpan - 1) + rIndex > args.range[0]) {\n                        args.range[0] = (cell.rowSpan - 1) + rIndex;\n                    }\n                    if (cell.colSpan > 1 && (cell.colSpan - 1) + cellIndex > args.range[3]) {\n                        args.range[3] = cellIndex;\n                        args.range[3] = (cell.colSpan - 1) + cellIndex;\n                    }\n                }\n            }\n        }\n    };\n    WorkbookMerge.prototype.insertHandler = function (args) {\n        this.activeCellRange(args);\n        args.range = args.range;\n        if (args.insertModel === 'Row') {\n            args.range[2] += args.insertCount;\n        }\n        else {\n            args.range[3] += args.insertCount;\n        }\n        args.preventRefresh = true;\n        args.merge = true;\n        this.mergeAll(args);\n    };\n    WorkbookMerge.prototype.pasteHandler = function (args) {\n        var sheet = this.parent.getActiveSheet();\n        var cell;\n        var nextCell;\n        var prevCell;\n        var activeCell = getCellIndexes(sheet.activeCell);\n        for (var i = args.range[0], l = 0; i <= args.range[2]; i++, l++) {\n            for (var j = args.range[1], k = 0; j <= args.range[3]; j++, k++) {\n                cell = getCell(i, j, args.prevSheet) || {};\n                if (cell.rowSpan > 1) {\n                    prevCell = getCell(activeCell[0] + (cell.rowSpan - 1), activeCell[1], sheet) || {};\n                    nextCell = getCell(activeCell[0] + 1, activeCell[1], sheet) || {};\n                    if ((prevCell.colSpan !== undefined && prevCell.colSpan < 0) || (nextCell.colSpan !== undefined &&\n                        nextCell.colSpan < 0)) {\n                        args.cancel = true;\n                        this.parent.notify(applyMerge, { showDialog: true });\n                        return;\n                    }\n                }\n                if (cell.colSpan > 1) {\n                    prevCell = getCell(activeCell[0], activeCell[1] + (cell.colSpan - 1), sheet) || {};\n                    nextCell = getCell(activeCell[0], activeCell[1] + 1, sheet) || {};\n                    if ((prevCell.rowSpan !== undefined && prevCell.rowSpan < 0) || (nextCell.rowSpan !== undefined &&\n                        nextCell.rowSpan < 0)) {\n                        args.cancel = true;\n                        this.parent.notify(applyMerge, { showDialog: true });\n                        return;\n                    }\n                }\n            }\n        }\n    };\n    WorkbookMerge.prototype.addEventListener = function () {\n        this.parent.on(setMerge, this.merge, this);\n        this.parent.on(mergedRange, this.mergedRange, this);\n        this.parent.on(activeCellMergedRange, this.activeCellRange, this);\n        this.parent.on(insertMerge, this.insertHandler, this);\n        this.parent.on(pasteMerge, this.pasteHandler, this);\n    };\n    /**\n     * Destroy workbook merge module.\n     */\n    WorkbookMerge.prototype.destroy = function () {\n        this.removeEventListener();\n        this.parent = null;\n    };\n    WorkbookMerge.prototype.removeEventListener = function () {\n        if (!this.parent.isDestroyed) {\n            this.parent.off(setMerge, this.merge);\n            this.parent.off(mergedRange, this.mergedRange);\n            this.parent.off(activeCellMergedRange, this.activeCellRange);\n            this.parent.off(insertMerge, this.insertHandler);\n            this.parent.off(pasteMerge, this.pasteHandler);\n        }\n    };\n    /**\n     * Get the workbook merge module name.\n     */\n    WorkbookMerge.prototype.getModuleName = function () {\n        return 'workbookmerge';\n    };\n    return WorkbookMerge;\n}());\nexport { WorkbookMerge };\n","import { setCell, setRow, getSheet } from '../base/index';\nimport { setCFRule, clearCFRule, getRangeAddress, applyCellFormat } from '../common/index';\nimport { getRangeIndexes } from '../common/index';\nimport { cFInitialCheck, clearCF } from '../common/index';\nimport { completeAction } from '../../spreadsheet/common/event';\nimport { isNullOrUndefined } from '@syncfusion/ej2-base';\n/**\n * The `WorkbookConditionalFormat` module is used to handle conditional formatting action in Spreadsheet.\n */\nvar WorkbookConditionalFormat = /** @class */ (function () {\n    /**\n     * Constructor for WorkbookConditionalFormat module.\n     */\n    function WorkbookConditionalFormat(parent) {\n        this.parent = parent;\n        this.addEventListener();\n    }\n    /**\n     * To destroy the conditional format module.\n     */\n    WorkbookConditionalFormat.prototype.destroy = function () {\n        this.removeEventListener();\n        this.parent = null;\n    };\n    WorkbookConditionalFormat.prototype.addEventListener = function () {\n        this.parent.on(setCFRule, this.setCFrulHandler, this);\n        this.parent.on(clearCFRule, this.clearRules, this);\n    };\n    WorkbookConditionalFormat.prototype.removeEventListener = function () {\n        if (!this.parent.isDestroyed) {\n            this.parent.off(setCFRule, this.setCFrulHandler);\n            this.parent.off(clearCFRule, this.clearRules);\n        }\n    };\n    WorkbookConditionalFormat.prototype.setCFrulHandler = function (args) {\n        var conditionalFormat = args.conditionalFormat;\n        var range = conditionalFormat.range;\n        var sheetIndex = this.parent.getAddressInfo(range).sheetIndex;\n        var sheet = getSheet(this.parent, sheetIndex);\n        range = range || sheet.selectedRange;\n        conditionalFormat.range = range;\n        var indexes = getRangeIndexes(range);\n        var cfrCount;\n        if (!sheet.conditionalFormats) {\n            this.parent.setSheetPropertyOnMute(sheet, 'conditionalFormats', []);\n        }\n        cfrCount = sheet.conditionalFormats.length;\n        sheet.conditionalFormats[cfrCount] = conditionalFormat;\n        for (var rIdx = indexes[0]; rIdx <= indexes[2]; rIdx++) {\n            if (!sheet.rows[rIdx]) {\n                setRow(sheet, rIdx, {});\n            }\n            for (var cIdx = indexes[1]; cIdx <= indexes[3]; cIdx++) {\n                if (!sheet.rows[rIdx].cells || !sheet.rows[rIdx].cells[cIdx]) {\n                    setCell(rIdx, cIdx, sheet, {});\n                }\n                if (sheetIndex === this.parent.activeSheetIndex) {\n                    var cell = sheet.rows[rIdx].cells[cIdx];\n                    this.parent.notify(cFInitialCheck, { rowIdx: rIdx, colIdx: cIdx, cell: cell, conditionalFormat: conditionalFormat });\n                }\n            }\n        }\n    };\n    // tslint:disable-next-line:max-func-body-length\n    WorkbookConditionalFormat.prototype.clearRules = function (args) {\n        var isPublic = isNullOrUndefined(args.isPublic) ? true : false;\n        var cFormats = [];\n        var oldRange = [];\n        var isFirst = true;\n        var top;\n        var bottom;\n        var left;\n        var right;\n        var frontColIdx;\n        var backColIdx;\n        var topRowIdx;\n        var bottomRowIdx;\n        var range = args.range;\n        var sheetIndex = this.parent.getAddressInfo(range).sheetIndex;\n        var sheet = getSheet(this.parent, sheetIndex);\n        var cFRules = sheet.conditionalFormats;\n        var rangeIndexes = getRangeIndexes(range);\n        if (sheetIndex === this.parent.activeSheetIndex) {\n            for (var rIdx = rangeIndexes[0]; rIdx <= rangeIndexes[2]; rIdx++) {\n                for (var cIdx = rangeIndexes[1]; cIdx <= rangeIndexes[3]; cIdx++) {\n                    this.parent.notify(clearCF, { rIdx: rIdx, cIdx: cIdx });\n                }\n            }\n        }\n        if (!cFRules) {\n            return;\n        }\n        for (var cFRulesIdx = cFRules.length - 1; cFRulesIdx >= 0; cFRulesIdx--) {\n            var isPresent = false;\n            var result = '';\n            var cFRule = cFRules[cFRulesIdx];\n            var cFRanges = cFRule.range.split(',');\n            if (sheetIndex === this.parent.activeSheetIndex) {\n                for (var cFRangeIdx = 0; cFRangeIdx < cFRanges.length; cFRangeIdx++) {\n                    var isFull = false;\n                    var cFRange = cFRanges[cFRangeIdx];\n                    var cFRangeIndexes = getRangeIndexes(cFRange);\n                    topRowIdx = cFRangeIndexes[0];\n                    bottomRowIdx = cFRangeIndexes[0];\n                    frontColIdx = cFRangeIndexes[1];\n                    backColIdx = cFRangeIndexes[1];\n                    if (cFRangeIndexes[0] >= rangeIndexes[0] && cFRangeIndexes[2] <= rangeIndexes[2] &&\n                        cFRangeIndexes[1] >= rangeIndexes[1] && cFRangeIndexes[3] <= rangeIndexes[3]) {\n                        isFull = true;\n                    }\n                    for (var cFRRowIdx = cFRangeIndexes[0]; cFRRowIdx <= cFRangeIndexes[2]; cFRRowIdx++) {\n                        var isTrue = 0;\n                        for (var cFRColIdx = cFRangeIndexes[1]; cFRColIdx <= cFRangeIndexes[3]; cFRColIdx++) {\n                            for (var rRowIdx = rangeIndexes[0]; rRowIdx <= rangeIndexes[2]; rRowIdx++) {\n                                for (var rColIdx = rangeIndexes[1]; rColIdx <= rangeIndexes[3]; rColIdx++) {\n                                    if (rRowIdx === cFRRowIdx && rColIdx === cFRColIdx) {\n                                        var style = this.parent.getCellStyleValue(['backgroundColor', 'color'], [rRowIdx, rColIdx]);\n                                        this.parent.notify(applyCellFormat, {\n                                            style: style, rowIdx: rRowIdx, colIdx: rColIdx,\n                                            lastCell: true, isHeightCheckNeeded: true, manualUpdate: true\n                                        });\n                                        isTrue = isTrue + 1;\n                                        isPresent = true;\n                                        if (rRowIdx === cFRangeIndexes[0]) {\n                                            if (rColIdx === cFRangeIndexes[3]) {\n                                                if (frontColIdx === cFRangeIndexes[1]) {\n                                                    if (backColIdx === rColIdx) {\n                                                        backColIdx = rColIdx;\n                                                    }\n                                                    else {\n                                                        frontColIdx = rColIdx - 1;\n                                                    }\n                                                }\n                                                else if (frontColIdx !== cFRangeIndexes[1] && backColIdx + 1 === rColIdx) {\n                                                    backColIdx = cFRangeIndexes[1];\n                                                    frontColIdx = frontColIdx - 1;\n                                                }\n                                                else if (frontColIdx !== cFRangeIndexes[1] && backColIdx === cFRangeIndexes[1]) {\n                                                    frontColIdx = rangeIndexes[1] - 1;\n                                                }\n                                            }\n                                            else if (rColIdx === cFRangeIndexes[1]) {\n                                                if (backColIdx === cFRangeIndexes[1]) {\n                                                    backColIdx = rColIdx + 1;\n                                                }\n                                            }\n                                            else {\n                                                if (frontColIdx === cFRangeIndexes[1] && backColIdx === cFRangeIndexes[1]) {\n                                                    frontColIdx = rColIdx;\n                                                    backColIdx = rColIdx;\n                                                }\n                                                else if (frontColIdx === cFRangeIndexes[1] && backColIdx !== cFRangeIndexes[1]) {\n                                                    backColIdx = rColIdx + 1;\n                                                }\n                                                else {\n                                                    backColIdx = rColIdx;\n                                                }\n                                            }\n                                        }\n                                        else {\n                                            if (rColIdx === cFRangeIndexes[1]) {\n                                                if (backColIdx === cFRangeIndexes[1] && cFRangeIndexes[1] !== cFRangeIndexes[3]) {\n                                                    backColIdx = rColIdx + 1;\n                                                }\n                                            }\n                                            else if (rColIdx === cFRangeIndexes[3]) {\n                                                if (frontColIdx === cFRangeIndexes[1]) {\n                                                    if (backColIdx === rColIdx) {\n                                                        backColIdx = rColIdx;\n                                                    }\n                                                    else {\n                                                        frontColIdx = rColIdx - 1;\n                                                    }\n                                                }\n                                                else if (frontColIdx !== cFRangeIndexes[1] && backColIdx === cFRangeIndexes[1]) {\n                                                    frontColIdx = rangeIndexes[1] - 1;\n                                                }\n                                                else if (frontColIdx !== cFRangeIndexes[1] && backColIdx + 1 === rColIdx) {\n                                                    backColIdx = cFRangeIndexes[1];\n                                                    frontColIdx = rangeIndexes[1] - 1;\n                                                }\n                                                else {\n                                                    bottomRowIdx = rRowIdx;\n                                                }\n                                            }\n                                            else {\n                                                if (frontColIdx === cFRangeIndexes[1] && backColIdx === cFRangeIndexes[1]) {\n                                                    frontColIdx = rColIdx;\n                                                    backColIdx = rColIdx;\n                                                }\n                                                else if (backColIdx !== cFRangeIndexes[1] && frontColIdx !== cFRangeIndexes[1]) {\n                                                    backColIdx = rColIdx;\n                                                }\n                                                else if (frontColIdx !== cFRangeIndexes[1] && backColIdx === cFRangeIndexes[1]) {\n                                                    frontColIdx = rColIdx;\n                                                }\n                                                else {\n                                                    backColIdx = rColIdx + 1;\n                                                }\n                                            }\n                                        }\n                                    }\n                                }\n                            }\n                        }\n                        if (isTrue > 0 && !isFull) {\n                            if (isFirst) {\n                                top = topRowIdx;\n                                bottom = bottomRowIdx;\n                                left = frontColIdx;\n                                right = backColIdx;\n                            }\n                            if (frontColIdx === cFRangeIndexes[1] && backColIdx !== cFRangeIndexes[1]) {\n                                if (backColIdx === cFRangeIndexes[3]) {\n                                    if (topRowIdx !== cFRRowIdx) {\n                                        result = result + ' ' + getRangeAddress([topRowIdx, left, bottom, cFRangeIndexes[3]]);\n                                    }\n                                    if (frontColIdx === cFRangeIndexes[1] && backColIdx === cFRangeIndexes[3]) {\n                                        if (cFRRowIdx === cFRangeIndexes[2]) {\n                                            if (cFRangeIndexes[1] === rangeIndexes[3]) {\n                                                result = result + ' ' + getRangeAddress([cFRRowIdx, backColIdx, cFRRowIdx, cFRangeIndexes[3]]);\n                                            }\n                                        }\n                                        else {\n                                            if (rangeIndexes[2] === cFRangeIndexes[0] && backColIdx !== cFRangeIndexes[3]) {\n                                                result = result + ' ' + getRangeAddress([cFRRowIdx, backColIdx, cFRRowIdx, cFRangeIndexes[3]]);\n                                            }\n                                            topRowIdx = cFRRowIdx + 1;\n                                            bottomRowIdx = cFRRowIdx + 1;\n                                            backColIdx = cFRangeIndexes[1];\n                                        }\n                                    }\n                                }\n                                else if (right !== backColIdx) {\n                                    result = result + ' ' + getRangeAddress([topRowIdx, right, cFRRowIdx - 1, cFRangeIndexes[3]]);\n                                    if (backColIdx === cFRangeIndexes[3] && frontColIdx === cFRangeIndexes[1]) {\n                                        topRowIdx = cFRRowIdx + 1;\n                                        bottomRowIdx = cFRRowIdx + 1;\n                                        backColIdx = cFRangeIndexes[1];\n                                    }\n                                    else {\n                                        topRowIdx = cFRRowIdx;\n                                        bottomRowIdx = cFRRowIdx;\n                                    }\n                                    if (backColIdx === cFRangeIndexes[3] && frontColIdx !== cFRangeIndexes[1]) {\n                                        frontColIdx = cFRangeIndexes[1];\n                                    }\n                                }\n                                else if (left !== frontColIdx) {\n                                    result = result + ' ' + getRangeAddress([topRowIdx, cFRangeIndexes[1], cFRRowIdx - 1, left]);\n                                    topRowIdx = cFRRowIdx + 1;\n                                    bottomRowIdx = cFRRowIdx + 1;\n                                    frontColIdx = cFRangeIndexes[1];\n                                    backColIdx = cFRangeIndexes[1];\n                                }\n                                else if (cFRRowIdx === cFRangeIndexes[2]) {\n                                    result = result + ' ' + getRangeAddress([topRowIdx, backColIdx, cFRRowIdx, cFRangeIndexes[3]]);\n                                }\n                                else {\n                                    if (bottomRowIdx < cFRRowIdx || (frontColIdx === cFRangeIndexes[1] && backColIdx === cFRangeIndexes[3])) {\n                                        bottomRowIdx = cFRRowIdx;\n                                    }\n                                }\n                            }\n                            else if (backColIdx === cFRangeIndexes[1] && frontColIdx !== cFRangeIndexes[1]) {\n                                if (right !== backColIdx) {\n                                    result = result + ' ' + getRangeAddress([topRowIdx, right, cFRRowIdx - 1, cFRangeIndexes[3]]);\n                                    topRowIdx = cFRRowIdx;\n                                    bottomRowIdx = cFRRowIdx;\n                                }\n                                if (left !== frontColIdx) {\n                                    result = result + ' ' + getRangeAddress([topRowIdx, left, cFRRowIdx - 1, cFRangeIndexes[3]]);\n                                    topRowIdx = cFRRowIdx;\n                                    bottomRowIdx = cFRRowIdx;\n                                }\n                                if (cFRRowIdx === cFRangeIndexes[2]) {\n                                    result = result + ' ' + getRangeAddress([topRowIdx, backColIdx, cFRRowIdx, frontColIdx]);\n                                }\n                                else {\n                                    bottomRowIdx = cFRRowIdx;\n                                }\n                            }\n                            else if (backColIdx !== cFRangeIndexes[1] && frontColIdx !== cFRangeIndexes[1]) {\n                                if (cFRRowIdx === cFRangeIndexes[2] && cFRangeIndexes[2] === rangeIndexes[0]) {\n                                    if (cFRangeIndexes[0] === cFRangeIndexes[2]) {\n                                        result = result + ' ' + getRangeAddress([topRowIdx, cFRangeIndexes[1], bottomRowIdx, frontColIdx - 1]);\n                                        result = result + ' ' +\n                                            getRangeAddress([topRowIdx, backColIdx + 1, bottomRowIdx, cFRangeIndexes[3]]);\n                                    }\n                                    else {\n                                        result =\n                                            result + ' ' + getRangeAddress([topRowIdx, cFRangeIndexes[1], bottomRowIdx, cFRangeIndexes[3]]);\n                                        result = result + ' ' +\n                                            getRangeAddress([cFRangeIndexes[2], cFRangeIndexes[1], cFRangeIndexes[2], frontColIdx - 1]);\n                                        result = result + ' ' +\n                                            getRangeAddress([cFRangeIndexes[2], backColIdx + 1, cFRangeIndexes[2], cFRangeIndexes[3]]);\n                                    }\n                                }\n                                else if (cFRRowIdx === cFRangeIndexes[2]) {\n                                    result = result + ' ' + getRangeAddress([topRowIdx, cFRangeIndexes[1], cFRRowIdx, frontColIdx - 1]);\n                                    result = result + ' ' + getRangeAddress([topRowIdx, backColIdx + 1, cFRRowIdx, cFRangeIndexes[3]]);\n                                }\n                                else {\n                                    if (left === cFRangeIndexes[1] && right === cFRangeIndexes[1]) {\n                                        result = result + ' ' + getRangeAddress([topRowIdx, left, bottomRowIdx, cFRangeIndexes[3]]);\n                                        topRowIdx = cFRRowIdx;\n                                    }\n                                    bottomRowIdx = cFRRowIdx;\n                                }\n                            }\n                            else if (frontColIdx === cFRangeIndexes[1] && backColIdx === cFRangeIndexes[1]) {\n                                if (rangeIndexes[2] !== cFRangeIndexes[0]) {\n                                    if (cFRangeIndexes[2] >= rangeIndexes[2] && cFRRowIdx > rangeIndexes[2]) {\n                                        result = result + ' ' + getRangeAddress([topRowIdx, frontColIdx, bottomRowIdx, cFRangeIndexes[3]]);\n                                    }\n                                    if (cFRangeIndexes[1] === cFRangeIndexes[3] &&\n                                        cFRRowIdx <= cFRangeIndexes[2] && top !== cFRangeIndexes[2] && cFRRowIdx !== top) {\n                                        result = result + ' ' + getRangeAddress([topRowIdx, frontColIdx, bottomRowIdx, cFRangeIndexes[3]]);\n                                    }\n                                    if (cFRangeIndexes[1] === cFRangeIndexes[3]) {\n                                        topRowIdx = cFRRowIdx + 1;\n                                        bottomRowIdx = cFRRowIdx + 1;\n                                    }\n                                }\n                                else {\n                                    if (cFRRowIdx === cFRangeIndexes[2] || cFRRowIdx === cFRangeIndexes[0] &&\n                                        cFRangeIndexes[1] !== cFRangeIndexes[3]) {\n                                        result = result + ' ' + getRangeAddress([topRowIdx, frontColIdx, bottomRowIdx, backColIdx]);\n                                    }\n                                    topRowIdx = cFRRowIdx + 1;\n                                    bottomRowIdx = cFRRowIdx + 1;\n                                }\n                                if (cFRRowIdx === cFRangeIndexes[2] && cFRangeIndexes[0] !== cFRangeIndexes[2] &&\n                                    cFRangeIndexes[1] !== cFRangeIndexes[3]) {\n                                    result = result + ' ' + getRangeAddress([cFRRowIdx, frontColIdx, cFRRowIdx, backColIdx]);\n                                }\n                            }\n                            if (!isFirst) {\n                                top = topRowIdx;\n                                bottom = bottomRowIdx <= cFRangeIndexes[2] ? bottomRowIdx : cFRangeIndexes[2];\n                                left = frontColIdx;\n                                right = backColIdx <= cFRangeIndexes[3] ? backColIdx : cFRangeIndexes[3];\n                            }\n                            isFirst = false;\n                        }\n                        else if (!isFull) {\n                            if (isFirst) {\n                                top = topRowIdx;\n                                bottom = bottomRowIdx;\n                                left = frontColIdx;\n                                right = backColIdx;\n                            }\n                            if (frontColIdx === cFRangeIndexes[1] && backColIdx === cFRangeIndexes[1]) {\n                                if (cFRRowIdx === cFRangeIndexes[2]) {\n                                    result = result + ' ' + getRangeAddress([topRowIdx, frontColIdx, cFRRowIdx, cFRangeIndexes[3]]);\n                                }\n                                bottomRowIdx = cFRRowIdx;\n                            }\n                            if (backColIdx !== cFRangeIndexes[1] && frontColIdx !== cFRangeIndexes[1]) {\n                                result = result + ' ' + getRangeAddress([topRowIdx, cFRangeIndexes[1], (cFRRowIdx - 1), frontColIdx - 1]);\n                                result = result + ' ' + getRangeAddress([topRowIdx, backColIdx + 1, (cFRRowIdx - 1), cFRangeIndexes[3]]);\n                                topRowIdx = cFRRowIdx;\n                                bottomRowIdx = cFRRowIdx;\n                                frontColIdx = cFRangeIndexes[1];\n                                backColIdx = cFRangeIndexes[1];\n                            }\n                            if (backColIdx !== cFRangeIndexes[1] && frontColIdx === cFRangeIndexes[1]) {\n                                result = result + ' ' + getRangeAddress([topRowIdx, backColIdx, (cFRRowIdx - 1), cFRangeIndexes[3]]);\n                                topRowIdx = cFRRowIdx;\n                                bottomRowIdx = cFRRowIdx;\n                                frontColIdx = cFRangeIndexes[1];\n                                backColIdx = cFRangeIndexes[1];\n                            }\n                            if (frontColIdx !== cFRangeIndexes[1] && backColIdx === cFRangeIndexes[1]) {\n                                result = result + ' ' + getRangeAddress([topRowIdx, backColIdx, (cFRRowIdx - 1), frontColIdx]);\n                                topRowIdx = cFRRowIdx;\n                                bottomRowIdx = cFRRowIdx;\n                                frontColIdx = cFRangeIndexes[1];\n                                backColIdx = cFRangeIndexes[1];\n                            }\n                            if (!isFirst) {\n                                top = topRowIdx;\n                                bottom = bottomRowIdx <= cFRangeIndexes[2] ? bottomRowIdx : cFRangeIndexes[2];\n                                left = frontColIdx;\n                                right = backColIdx <= cFRangeIndexes[3] ? backColIdx : cFRangeIndexes[3];\n                            }\n                            isFirst = false;\n                        }\n                    }\n                }\n            }\n            if (result === '') {\n                oldRange.push(sheet.conditionalFormats[cFRulesIdx].range);\n                sheet.conditionalFormats.splice(cFRulesIdx, 1);\n            }\n            else {\n                oldRange.push(sheet.conditionalFormats[cFRulesIdx].range);\n                sheet.conditionalFormats[cFRulesIdx].range = result.trim().replace(' ', ',');\n            }\n            if (isPresent && !isPublic) {\n                cFRule.range = result.trim().replace(' ', ',');\n                cFormats.push(cFRule);\n            }\n        }\n        if (!isPublic) {\n            var eventArgs = { cFormats: cFormats, oldRange: oldRange, selectedRange: range };\n            this.parent.notify(completeAction, { eventArgs: eventArgs, action: 'clearCF' });\n        }\n    };\n    /**\n     * Gets the module name.\n     * @returns string\n     */\n    WorkbookConditionalFormat.prototype.getModuleName = function () {\n        return 'workbookConditionalFormatting';\n    };\n    return WorkbookConditionalFormat;\n}());\nexport { WorkbookConditionalFormat };\n","import { Workbook, DataBind } from '../index';\nimport { WorkbookSave, WorkbookFormula, WorkbookOpen, WorkbookSort, WorkbookFilter, WorkbookImage } from '../integrations/index';\nimport { WorkbookNumberFormat } from '../integrations/number-format';\nimport { WorkbookEdit, WorkbookCellFormat, WorkbookHyperlink, WorkbookInsert, WorkbookDelete } from '../actions/index';\nimport { WorkbookFindAndReplace, WorkbookProtectSheet, WorkbookDataValidation, WorkbookMerge } from '../actions/index';\nimport { WorkbookConditionalFormat } from '../actions/conditional-formatting';\nimport { WorkbookChart } from '../integrations/index';\n/**\n * Workbook basic module.\n * @private\n */\nvar WorkbookBasicModule = /** @class */ (function () {\n    /**\n     * Constructor for Workbook basic module.\n     * @private\n     */\n    function WorkbookBasicModule() {\n        Workbook.Inject(DataBind, WorkbookSave, WorkbookOpen, WorkbookNumberFormat, WorkbookCellFormat, WorkbookEdit, WorkbookFormula, WorkbookSort, WorkbookHyperlink, WorkbookFilter, WorkbookInsert, WorkbookDelete, WorkbookFindAndReplace, WorkbookProtectSheet, WorkbookDataValidation, WorkbookMerge, WorkbookConditionalFormat, WorkbookImage, WorkbookChart);\n    }\n    /**\n     * For internal use only - Get the module name.\n     * @private\n     */\n    WorkbookBasicModule.prototype.getModuleName = function () {\n        return 'workbookBasic';\n    };\n    /**\n     * Destroys the Workbook basic module.\n     * @return {void}\n     */\n    WorkbookBasicModule.prototype.destroy = function () {\n        /* code snippet */\n    };\n    return WorkbookBasicModule;\n}());\nexport { WorkbookBasicModule };\n","import { Workbook, DataBind } from '../../workbook/index';\nimport { WorkbookSave, WorkbookNumberFormat, WorkbookFormula, WorkbookOpen, WorkbookChart } from '../integrations/index';\nimport { WorkbookSort, WorkbookFilter, WorkbookImage } from '../integrations/index';\nimport { WorkbookEdit, WorkbookCellFormat, WorkbookHyperlink, WorkbookInsert, WorkbookDelete } from '../actions/index';\nimport { WorkbookFindAndReplace, WorkbookProtectSheet, WorkbookDataValidation, WorkbookMerge } from '../actions/index';\nimport { WorkbookConditionalFormat } from '../actions/conditional-formatting';\n/**\n * Workbook all module.\n * @private\n */\nvar WorkbookAllModule = /** @class */ (function () {\n    /**\n     * Constructor for Workbook all module.\n     * @private\n     */\n    function WorkbookAllModule() {\n        Workbook.Inject(DataBind, WorkbookSave, WorkbookNumberFormat, WorkbookCellFormat, WorkbookEdit, WorkbookFormula, WorkbookOpen, WorkbookSort, WorkbookHyperlink, WorkbookFilter, WorkbookInsert, WorkbookDelete, WorkbookFindAndReplace, WorkbookProtectSheet, WorkbookDataValidation, WorkbookMerge, WorkbookConditionalFormat, WorkbookImage, WorkbookChart);\n    }\n    /**\n     * For internal use only - Get the module name.\n     * @private\n     */\n    WorkbookAllModule.prototype.getModuleName = function () {\n        return 'workbook-all';\n    };\n    /**\n     * Destroys the Workbook all module.\n     * @return {void}\n     */\n    WorkbookAllModule.prototype.destroy = function () {\n        /* code snippet */\n    };\n    return WorkbookAllModule;\n}());\nexport { WorkbookAllModule };\n","var __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    }\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nimport { ChildProperty, Property, Complex } from '@syncfusion/ej2-base';\n/**\n * Represents the cell style.\n */\nvar CellStyle = /** @class */ (function (_super) {\n    __extends(CellStyle, _super);\n    function CellStyle() {\n        return _super !== null && _super.apply(this, arguments) || this;\n    }\n    __decorate([\n        Property('Calibri')\n    ], CellStyle.prototype, \"fontFamily\", void 0);\n    __decorate([\n        Property('bottom')\n    ], CellStyle.prototype, \"verticalAlign\", void 0);\n    __decorate([\n        Property('left')\n    ], CellStyle.prototype, \"textAlign\", void 0);\n    __decorate([\n        Property('0pt')\n    ], CellStyle.prototype, \"textIndent\", void 0);\n    __decorate([\n        Property('#000000')\n    ], CellStyle.prototype, \"color\", void 0);\n    __decorate([\n        Property('#ffffff')\n    ], CellStyle.prototype, \"backgroundColor\", void 0);\n    __decorate([\n        Property('normal')\n    ], CellStyle.prototype, \"fontWeight\", void 0);\n    __decorate([\n        Property('normal')\n    ], CellStyle.prototype, \"fontStyle\", void 0);\n    __decorate([\n        Property('11pt')\n    ], CellStyle.prototype, \"fontSize\", void 0);\n    __decorate([\n        Property('none')\n    ], CellStyle.prototype, \"textDecoration\", void 0);\n    __decorate([\n        Property('')\n    ], CellStyle.prototype, \"border\", void 0);\n    __decorate([\n        Property('')\n    ], CellStyle.prototype, \"borderTop\", void 0);\n    __decorate([\n        Property('')\n    ], CellStyle.prototype, \"borderBottom\", void 0);\n    __decorate([\n        Property('')\n    ], CellStyle.prototype, \"borderLeft\", void 0);\n    __decorate([\n        Property('')\n    ], CellStyle.prototype, \"borderRight\", void 0);\n    return CellStyle;\n}(ChildProperty));\nexport { CellStyle };\n/**\n * Represents the Filter Collection.\n */\nvar FilterCollection = /** @class */ (function (_super) {\n    __extends(FilterCollection, _super);\n    function FilterCollection() {\n        return _super !== null && _super.apply(this, arguments) || this;\n    }\n    __decorate([\n        Property()\n    ], FilterCollection.prototype, \"sheetIdx\", void 0);\n    __decorate([\n        Property()\n    ], FilterCollection.prototype, \"filterRange\", void 0);\n    __decorate([\n        Property(false)\n    ], FilterCollection.prototype, \"hasFilter\", void 0);\n    __decorate([\n        Property()\n    ], FilterCollection.prototype, \"column\", void 0);\n    __decorate([\n        Property()\n    ], FilterCollection.prototype, \"criteria\", void 0);\n    __decorate([\n        Property()\n    ], FilterCollection.prototype, \"value\", void 0);\n    __decorate([\n        Property()\n    ], FilterCollection.prototype, \"dataType\", void 0);\n    return FilterCollection;\n}(ChildProperty));\nexport { FilterCollection };\n/**\n * Represents the DefineName.\n */\nvar DefineName = /** @class */ (function (_super) {\n    __extends(DefineName, _super);\n    function DefineName() {\n        return _super !== null && _super.apply(this, arguments) || this;\n    }\n    __decorate([\n        Property('')\n    ], DefineName.prototype, \"name\", void 0);\n    __decorate([\n        Property('')\n    ], DefineName.prototype, \"scope\", void 0);\n    __decorate([\n        Property('')\n    ], DefineName.prototype, \"comment\", void 0);\n    __decorate([\n        Property('')\n    ], DefineName.prototype, \"refersTo\", void 0);\n    return DefineName;\n}(ChildProperty));\nexport { DefineName };\n/**\n * Configures the Protect behavior for the spreadsheet.\n */\nvar ProtectSettings = /** @class */ (function (_super) {\n    __extends(ProtectSettings, _super);\n    function ProtectSettings() {\n        return _super !== null && _super.apply(this, arguments) || this;\n    }\n    __decorate([\n        Property(false)\n    ], ProtectSettings.prototype, \"selectCells\", void 0);\n    __decorate([\n        Property(false)\n    ], ProtectSettings.prototype, \"formatCells\", void 0);\n    __decorate([\n        Property(false)\n    ], ProtectSettings.prototype, \"formatRows\", void 0);\n    __decorate([\n        Property(false)\n    ], ProtectSettings.prototype, \"formatColumns\", void 0);\n    __decorate([\n        Property(false)\n    ], ProtectSettings.prototype, \"insertLink\", void 0);\n    return ProtectSettings;\n}(ChildProperty));\nexport { ProtectSettings };\n/**\n * Represents the Hyperlink.\n */\nvar Hyperlink = /** @class */ (function (_super) {\n    __extends(Hyperlink, _super);\n    function Hyperlink() {\n        return _super !== null && _super.apply(this, arguments) || this;\n    }\n    __decorate([\n        Property('')\n    ], Hyperlink.prototype, \"address\", void 0);\n    return Hyperlink;\n}(ChildProperty));\nexport { Hyperlink };\n/**\n * Represents the DataValidation.\n */\nvar Validation = /** @class */ (function (_super) {\n    __extends(Validation, _super);\n    function Validation() {\n        return _super !== null && _super.apply(this, arguments) || this;\n    }\n    __decorate([\n        Property('WholeNumber')\n    ], Validation.prototype, \"type\", void 0);\n    __decorate([\n        Property('Between')\n    ], Validation.prototype, \"operator\", void 0);\n    __decorate([\n        Property('0')\n    ], Validation.prototype, \"value1\", void 0);\n    __decorate([\n        Property('0')\n    ], Validation.prototype, \"value2\", void 0);\n    __decorate([\n        Property(true)\n    ], Validation.prototype, \"ignoreBlank\", void 0);\n    __decorate([\n        Property(true)\n    ], Validation.prototype, \"inCellDropDown\", void 0);\n    __decorate([\n        Property(false)\n    ], Validation.prototype, \"isHighlighted\", void 0);\n    return Validation;\n}(ChildProperty));\nexport { Validation };\n/**\n * Represents the Format.\n */\nvar Format = /** @class */ (function (_super) {\n    __extends(Format, _super);\n    function Format() {\n        return _super !== null && _super.apply(this, arguments) || this;\n    }\n    __decorate([\n        Property('General')\n    ], Format.prototype, \"format\", void 0);\n    __decorate([\n        Complex({}, CellStyle)\n    ], Format.prototype, \"style\", void 0);\n    __decorate([\n        Property(true)\n    ], Format.prototype, \"isLocked\", void 0);\n    return Format;\n}(ChildProperty));\nexport { Format };\n/**\n * Represents the Conditional Formatting.\n */\nvar ConditionalFormat = /** @class */ (function (_super) {\n    __extends(ConditionalFormat, _super);\n    function ConditionalFormat() {\n        return _super !== null && _super.apply(this, arguments) || this;\n    }\n    __decorate([\n        Property('GreaterThan')\n    ], ConditionalFormat.prototype, \"type\", void 0);\n    __decorate([\n        Complex({}, Format)\n    ], ConditionalFormat.prototype, \"format\", void 0);\n    __decorate([\n        Property('RedFT')\n    ], ConditionalFormat.prototype, \"cFColor\", void 0);\n    __decorate([\n        Property('')\n    ], ConditionalFormat.prototype, \"value\", void 0);\n    __decorate([\n        Property('')\n    ], ConditionalFormat.prototype, \"range\", void 0);\n    return ConditionalFormat;\n}(ChildProperty));\nexport { ConditionalFormat };\n/**\n * Represents the Chart.\n */\nvar Chart = /** @class */ (function (_super) {\n    __extends(Chart, _super);\n    function Chart() {\n        return _super !== null && _super.apply(this, arguments) || this;\n    }\n    __decorate([\n        Property('Line')\n    ], Chart.prototype, \"type\", void 0);\n    __decorate([\n        Property('Material')\n    ], Chart.prototype, \"theme\", void 0);\n    __decorate([\n        Property(false)\n    ], Chart.prototype, \"isSeriesInRows\", void 0);\n    __decorate([\n        Property('')\n    ], Chart.prototype, \"range\", void 0);\n    __decorate([\n        Property('')\n    ], Chart.prototype, \"id\", void 0);\n    return Chart;\n}(ChildProperty));\nexport { Chart };\n/**\n * Represents the Image.\n */\nvar Image = /** @class */ (function (_super) {\n    __extends(Image, _super);\n    function Image() {\n        return _super !== null && _super.apply(this, arguments) || this;\n    }\n    __decorate([\n        Property('')\n    ], Image.prototype, \"src\", void 0);\n    __decorate([\n        Property('')\n    ], Image.prototype, \"id\", void 0);\n    __decorate([\n        Property(300)\n    ], Image.prototype, \"height\", void 0);\n    __decorate([\n        Property(400)\n    ], Image.prototype, \"width\", void 0);\n    __decorate([\n        Property(0)\n    ], Image.prototype, \"top\", void 0);\n    __decorate([\n        Property(0)\n    ], Image.prototype, \"left\", void 0);\n    return Image;\n}(ChildProperty));\nexport { Image };\n","/** @hidden */\nexport var workbookLocale = 'spreadsheetLocale';\n/**\n * Workbook locale text\n * @hidden\n */\nexport var localeData = {\n    SortOutOfRangeError: 'Select a cell or range inside the used range and try again.'\n};\n","import { isNullOrUndefined } from '@syncfusion/ej2-base';\n/**\n * ServiceLocator\n * @hidden\n */\nvar ServiceLocator = /** @class */ (function () {\n    function ServiceLocator() {\n        this.services = {};\n    }\n    ServiceLocator.prototype.getService = function (name) {\n        if (isNullOrUndefined(this.services[name])) {\n            throw \"The service \" + name + \" is not registered\";\n        }\n        return this.services[name];\n    };\n    ServiceLocator.prototype.register = function (name, type) {\n        if (isNullOrUndefined(this.services[name])) {\n            this.services[name] = type;\n        }\n    };\n    return ServiceLocator;\n}());\nexport { ServiceLocator };\n","var __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    }\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nvar __assign = (this && this.__assign) || function () {\n    __assign = Object.assign || function(t) {\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\n            s = arguments[i];\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\n                t[p] = s[p];\n        }\n        return t;\n    };\n    return __assign.apply(this, arguments);\n};\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nimport { Component, Property, NotifyPropertyChanges, Collection, Complex } from '@syncfusion/ej2-base';\nimport { initSheet, getSheet, getSheetIndexFromId, getSheetIndexByName, getSheetIndex, Sheet } from './sheet';\nimport { Event, merge, L10n, isNullOrUndefined } from '@syncfusion/ej2-base';\nimport { getWorkbookRequiredModules } from '../common/module';\nimport { getData, clearRange } from './index';\nimport { DefineName, CellStyle, updateUsedRange, getIndexesFromAddress, localeData, workbookLocale } from '../common/index';\nimport * as events from '../common/event';\nimport { insertModel, getAddressInfo } from '../common/index';\nimport { setCellFormat, sheetCreated, deleteModel, setLockCells } from '../common/index';\nimport { setMerge } from '../common/index';\nimport { getCell, skipDefaultValue, setCell, wrap as wrapText } from './cell';\nimport { DataBind, setRow, setColumn } from '../index';\nimport { WorkbookSave, WorkbookFormula, WorkbookOpen, WorkbookSort, WorkbookFilter, WorkbookImage } from '../integrations/index';\nimport { WorkbookChart } from '../integrations/index';\nimport { WorkbookNumberFormat } from '../integrations/number-format';\nimport { WorkbookEdit, WorkbookCellFormat, WorkbookHyperlink, WorkbookInsert, WorkbookProtectSheet } from '../actions/index';\nimport { WorkbookDataValidation, WorkbookMerge } from '../actions/index';\nimport { ServiceLocator } from '../services/index';\nimport { setLinkModel, setImage, setChart } from '../common/event';\nimport { beginAction, completeAction, deleteChart } from '../../spreadsheet/common/event';\nimport { WorkbookFindAndReplace } from '../actions/find-and-replace';\nimport { WorkbookConditionalFormat } from '../actions/conditional-formatting';\n/**\n * Represents the Workbook.\n */\nvar Workbook = /** @class */ (function (_super) {\n    __extends(Workbook, _super);\n    /**\n     * Constructor for initializing the library.\n     * @param options - Configures Workbook model.\n     */\n    function Workbook(options) {\n        var _this = _super.call(this, options) || this;\n        /**\n         * To generate sheet name based on sheet count.\n         * @hidden\n         */\n        _this.sheetNameCount = 1;\n        /**\n         * @hidden\n         */\n        _this.isOpen = false;\n        /**\n         * @hidden\n         */\n        _this.chartColl = [];\n        /**\n         * @hidden\n         */\n        _this.chartCount = 1;\n        Workbook_1.Inject(DataBind, WorkbookSave, WorkbookOpen, WorkbookNumberFormat, WorkbookCellFormat, WorkbookEdit, WorkbookFormula, WorkbookSort, WorkbookHyperlink, WorkbookFilter, WorkbookInsert, WorkbookFindAndReplace, WorkbookDataValidation, WorkbookProtectSheet, WorkbookMerge, WorkbookConditionalFormat, WorkbookImage, WorkbookChart);\n        _this.commonCellStyle = {};\n        if (options && options.cellStyle) {\n            _this.commonCellStyle = options.cellStyle;\n        }\n        if (_this.getModuleName() === 'workbook') {\n            _this.serviceLocator = new ServiceLocator;\n            _this.initWorkbookServices();\n            _this.dataBind();\n            _this.initEmptySheet();\n        }\n        return _this;\n    }\n    Workbook_1 = Workbook;\n    /**\n     * For internal use only.\n     * @returns void\n     * @hidden\n     */\n    Workbook.prototype.preRender = function () {\n        if (!Object.keys(this.commonCellStyle).length) {\n            this.commonCellStyle = skipDefaultValue(this.cellStyle, true);\n        }\n        if (this.getModuleName() === 'spreadsheet' && !this.refreshing) {\n            this.initEmptySheet();\n        }\n    };\n    Workbook.prototype.initWorkbookServices = function () {\n        this.serviceLocator.register(workbookLocale, new L10n(this.getModuleName(), localeData, this.locale));\n    };\n    /**\n     * For internal use only.\n     * @returns void\n     * @hidden\n     */\n    Workbook.prototype.render = function () {\n        /** code snippets */\n    };\n    /**\n     * To provide the array of modules needed for workbook.\n     * @return {ModuleDeclaration[]}\n     * @hidden\n     */\n    Workbook.prototype.requiredModules = function () {\n        return getWorkbookRequiredModules(this);\n    };\n    /**\n     * Get the properties to be maintained in the persisted state.\n     * @returns string\n     * @hidden\n     */\n    Workbook.prototype.getPersistData = function () {\n        return this.addOnPersist([]);\n    };\n    /**\n     * Applies the style (font family, font weight, background color, etc...) to the specified range of cells.\n     * @param {CellStyleModel} style - Specifies the cell style.\n     * @param {string} range? - Specifies the address for the range of cells.\n     * {% codeBlock src='spreadsheet/cellFormat/index.md' %}{% endcodeBlock %}\n     */\n    Workbook.prototype.cellFormat = function (style, range) {\n        var sheet = this.getActiveSheet();\n        range = range || sheet.selectedRange;\n        this.notify(setCellFormat, { style: style, range: range, refreshRibbon: range.indexOf(sheet.activeCell) > -1 ? true : false });\n    };\n    /**\n     * Applies cell lock to the specified range of cells.\n     * @param {string} range? - Specifies the address for the range of cells.\n     * @param {boolean} isLocked -Specifies the cell is locked or not.\n     * {% codeBlock src='spreadsheet/lockCells/index.md' %}{% endcodeBlock %}\n     */\n    Workbook.prototype.lockCells = function (range, isLocked) {\n        var sheet = this.getActiveSheet();\n        range = range || sheet.selectedRange;\n        this.notify(setLockCells, { range: range, isLocked: isLocked });\n    };\n    /** @hidden */\n    Workbook.prototype.getCellStyleValue = function (cssProps, indexes) {\n        var _this = this;\n        var cell = getCell(indexes[0], indexes[1], this.getActiveSheet());\n        var style = {};\n        cssProps.forEach(function (cssProp) {\n            style[cssProp] = _this.cellStyle[cssProp];\n            if (cell && cell.style && cell.style[cssProp]) {\n                style[cssProp] = cell.style[cssProp];\n            }\n        });\n        return style;\n    };\n    /**\n     * Applies the number format (number, currency, percentage, short date, etc...) to the specified range of cells.\n     * @param {string} format - Specifies the number format code.\n     * @param {string} range? - Specifies the address for the range of cells.\n     * {% codeBlock src='spreadsheet/numberFormat/index.md' %}{% endcodeBlock %}\n     */\n    Workbook.prototype.numberFormat = function (format, range) {\n        this.notify(events.applyNumberFormatting, { format: format, range: range });\n    };\n    /**\n     * Used to create new sheet.\n     * @hidden\n     */\n    Workbook.prototype.createSheet = function (index, sheets) {\n        if (index === void 0) { index = this.sheets.length; }\n        if (sheets === void 0) { sheets = [{}]; }\n        var _a;\n        (_a = this.sheets).splice.apply(_a, [index, 0].concat(sheets));\n        initSheet(this, sheets);\n        this.notify(sheetCreated, { sheetIndex: index || 0, sheets: sheets });\n        this.notify(events.workbookFormulaOperation, {\n            action: 'registerSheet', sheetIndex: index || 0, sheetCount: index + sheets.length\n        });\n    };\n    /**\n     * Used to remove sheet.\n     * @hidden\n     */\n    Workbook.prototype.removeSheet = function (idx) {\n        this.sheets.splice(idx, 1);\n    };\n    /**\n     * Destroys the Workbook library.\n     */\n    Workbook.prototype.destroy = function () {\n        this.notify(events.workbookDestroyed, null);\n        _super.prototype.destroy.call(this);\n    };\n    /**\n     * Called internally if any of the property value changed.\n     * @param  {WorkbookModel} newProp\n     * @param  {WorkbookModel} oldProp\n     * @returns void\n     * @hidden\n     */\n    Workbook.prototype.onPropertyChanged = function (newProp, oldProp) {\n        for (var _i = 0, _a = Object.keys(newProp); _i < _a.length; _i++) {\n            var prop = _a[_i];\n            switch (prop) {\n                case 'cellStyle':\n                    merge(this.commonCellStyle, skipDefaultValue(newProp.cellStyle));\n                    break;\n                case 'sheets':\n                    initSheet(this);\n                    break;\n            }\n        }\n    };\n    /**\n     * Not applicable for workbook.\n     * @hidden\n     */\n    Workbook.prototype.appendTo = function (selector) {\n        _super.prototype.appendTo.call(this, selector);\n    };\n    /**\n     * Used to hide/show the rows in spreadsheet.\n     * @param {number} startRow - Specifies the start row index.\n     * @param {number} endRow? - Specifies the end row index.\n     * @param {boolean} hide? - To hide/show the rows in specified range.\n     * @returns void\n     */\n    Workbook.prototype.hideRow = function (startIndex, endIndex, hide) {\n        if (endIndex === void 0) { endIndex = startIndex; }\n        if (hide === void 0) { hide = true; }\n        var sheet = this.getActiveSheet();\n        for (var i = startIndex; i <= endIndex; i++) {\n            setRow(sheet, i, { hidden: hide });\n        }\n    };\n    /**\n     * Used to hide/show the columns in spreadsheet.\n     * @param {number} startIndex - Specifies the start column index.\n     * @param {number} endIndex? - Specifies the end column index.\n     * @param {boolean} hide? - Set `true` / `false` to hide / show the columns.\n     * @returns void\n     */\n    Workbook.prototype.hideColumn = function (startIndex, endIndex, hide) {\n        if (endIndex === void 0) { endIndex = startIndex; }\n        if (hide === void 0) { hide = true; }\n        var sheet = this.getActiveSheet();\n        for (var i = startIndex; i <= endIndex; i++) {\n            setColumn(sheet, i, { hidden: hide });\n        }\n    };\n    /**\n     * Sets the border to specified range of cells.\n     * @param {CellStyleModel} style? - Specifies the style property which contains border value.\n     * @param {string} range? - Specifies the range of cell reference. If not specified, it will considered the active cell reference.\n     * @param {BorderType} type? - Specifies the range of cell reference. If not specified, it will considered the active cell reference.\n     * @returns void\n     * {% codeBlock src='spreadsheet/setBorder/index.md' %}{% endcodeBlock %}\n     */\n    Workbook.prototype.setBorder = function (style, range, type) {\n        this.notify(setCellFormat, {\n            style: style, borderType: type, range: range || this.getActiveSheet().selectedRange\n        });\n    };\n    /**\n     * Used to insert rows in to the spreadsheet.\n     * @param {number | RowModel[]} startRow? - Specifies the start row index / row model which needs to be inserted.\n     * @param {number} endRow? - Specifies the end row index.\n     * @returns void\n     * {% codeBlock src='spreadsheet/insertRow/index.md' %}{% endcodeBlock %}\n     */\n    Workbook.prototype.insertRow = function (startRow, endRow) {\n        this.notify(insertModel, { model: this.getActiveSheet(), start: startRow, end: endRow, modelType: 'Row' });\n    };\n    /**\n     * Used to insert columns in to the spreadsheet.\n     * @param {number | ColumnModel[]} startColumn? - Specifies the start column index / column model which needs to be inserted.\n     * @param {number} endColumn? - Specifies the end column index.\n     * @returns void\n     * {% codeBlock src='spreadsheet/insertColumn/index.md' %}{% endcodeBlock %}\n     */\n    Workbook.prototype.insertColumn = function (startColumn, endColumn) {\n        this.notify(insertModel, {\n            model: this.getActiveSheet(), start: startColumn, end: endColumn,\n            modelType: 'Column'\n        });\n    };\n    /**\n     * Used to insert sheets in to the spreadsheet.\n     * @param {number | SheetModel[]} startSheet? - Specifies the start sheet index / sheet model which needs to be inserted.\n     * @param {number} endSheet? - Specifies the end sheet index.\n     * @returns void\n     * {% codeBlock src='spreadsheet/insertSheet/index.md' %}{% endcodeBlock %}\n     */\n    Workbook.prototype.insertSheet = function (startSheet, endSheet) {\n        this.notify(insertModel, { model: this, start: startSheet, end: endSheet, modelType: 'Sheet' });\n    };\n    /**\n     * Used to delete rows, columns and sheets from the spreadsheet.\n     * @param {number | RowModel[]} startIndex? - Specifies the start sheet / row / column index.\n     * @param {number} endIndex? - Specifies the end sheet / row / column index.\n     * @param {ModelType} model? - Specifies the delete model type. By default, the model is considered as `Sheet`. The possible values are,\n     * - Row: To delete rows.\n     * - Column: To delete columns.\n     * - Sheet: To delete sheets.\n     * @returns void\n     * {% codeBlock src='spreadsheet/delete/index.md' %}{% endcodeBlock %}\n     */\n    Workbook.prototype.delete = function (startIndex, endIndex, model) {\n        this.notify(deleteModel, {\n            model: !model || model === 'Sheet' ? this : this.getActiveSheet(), start: startIndex || 0, end: endIndex || 0, modelType: model || 'Sheet'\n        });\n    };\n    /**\n     * Used to merge the range of cells.\n     * @param {string} range? - Specifies the rnage of cells as address.\n     * @param {MergeType} type? - Specifies the merge type. The possible values are,\n     * - All: Merge all the cells between provided range.\n     * - Horizontally: Merge the cells row-wise.\n     * - Vertically: Merge the cells column-wise.\n     * @returns void\n     * {% codeBlock src='spreadsheet/merge/index.md' %}{% endcodeBlock %}\n     */\n    Workbook.prototype.merge = function (range, type) {\n        var sheetIdx = this.getAddressInfo(range).sheetIndex;\n        var sheet = getSheet(this, sheetIdx);\n        range = range || sheet.selectedRange;\n        this.notify(setMerge, { merge: true, range: range, type: type || 'All', sheet: sheet, refreshRibbon: range.indexOf(sheet.activeCell) > -1 ? true : false, preventRefresh: this.activeSheetIndex !== sheetIdx });\n    };\n    /** Used to compute the specified expression/formula.\n     * @param {string} formula - Specifies the formula(=SUM(A1:A3)) or expression(2+3).\n     * @returns string | number\n     * {% codeBlock src='spreadsheet/computeExpression/index.md' %}{% endcodeBlock %}\n     */\n    Workbook.prototype.computeExpression = function (formula) {\n        var args = {\n            action: 'computeExpression', formula: formula\n        };\n        this.notify(events.workbookFormulaOperation, args);\n        return args.calcValue;\n    };\n    Workbook.prototype.initEmptySheet = function () {\n        if (!this.sheets.length) {\n            this.createSheet();\n        }\n        else {\n            initSheet(this);\n        }\n    };\n    /** @hidden */\n    Workbook.prototype.getActiveSheet = function () {\n        return this.sheets[this.activeSheetIndex];\n    };\n    /**\n     * Used for setting the used range row and column index.\n     * @hidden\n     */\n    Workbook.prototype.setUsedRange = function (rowIdx, colIdx) {\n        var sheet = this.getActiveSheet();\n        if (rowIdx > sheet.usedRange.rowIndex) {\n            sheet.usedRange.rowIndex = rowIdx;\n            this.notify(updateUsedRange, { index: rowIdx, update: 'row' });\n        }\n        if (colIdx > sheet.usedRange.colIndex) {\n            sheet.usedRange.colIndex = colIdx;\n            this.notify(updateUsedRange, { index: colIdx, update: 'col' });\n        }\n    };\n    /**\n     * Gets the range of data as JSON from the specified address.\n     * @param {string} address - Specifies the address for range of cells.\n     * {% codeBlock src='spreadsheet/getData/index.md' %}{% endcodeBlock %}\n     */\n    Workbook.prototype.getData = function (address) {\n        return getData(this, address);\n    };\n    /**\n     * Get component name.\n     * @returns string\n     * @hidden\n     */\n    Workbook.prototype.getModuleName = function () {\n        return 'workbook';\n    };\n    /** @hidden */\n    Workbook.prototype.getValueRowCol = function (sheetIndex, rowIndex, colIndex) {\n        var args = {\n            action: 'getSheetInfo', sheetInfo: []\n        };\n        this.notify(events.workbookFormulaOperation, args);\n        var id = getSheetIndexByName(this, 'Sheet' + (sheetIndex + 1), args.sheetInfo);\n        if (id === -1) {\n            var errArgs = { action: 'getReferenceError', refError: '' };\n            this.notify(events.workbookFormulaOperation, errArgs);\n            return errArgs.refError;\n        }\n        sheetIndex = getSheetIndexFromId(this, sheetIndex + 1);\n        var sheet = getSheet(this, sheetIndex);\n        var cell = getCell(rowIndex - 1, colIndex - 1, sheet);\n        return (cell && cell.value) || '';\n    };\n    /** @hidden */\n    Workbook.prototype.setValueRowCol = function (sheetIndex, value, rowIndex, colIndex) {\n        sheetIndex = getSheetIndexFromId(this, sheetIndex);\n        this.notify(events.workbookEditOperation, {\n            action: 'updateCellValue', address: [rowIndex - 1, colIndex - 1], value: value,\n            sheetIndex: sheetIndex, isValueOnly: true\n        });\n    };\n    /**\n     * Opens the specified excel file or stream.\n     * @param {OpenOptions} options - Options for opening the excel file.\n     */\n    Workbook.prototype.open = function (options) {\n        this.notify(events.workbookOpen, options);\n    };\n    /**\n     * Opens the specified JSON object.\n     * <br><br>\n     * The available arguments in options are:\n     * * file: Specifies the spreadsheet model as object or string. And the object contains the jsonObject,\n     * which is saved from spreadsheet using saveAsJson method.\n     *\n     * @param options - Options for opening the JSON object.\n     * {% codeBlock src='spreadsheet/openFromJson/index.md' %}{% endcodeBlock %}\n     */\n    Workbook.prototype.openFromJson = function (options) {\n        this.isOpen = true;\n        var jsonObject = typeof options.file === 'object' ? JSON.stringify(options.file) : options.file;\n        this.notify(events.workbookOpen, { jsonObject: jsonObject });\n    };\n    /**\n     * Saves the Spreadsheet data to Excel file.\n     * <br><br>\n     * The available arguments in saveOptions are:\n     * * url: Specifies the save URL.\n     * * fileName: Specifies the file name.\n     * * saveType: Specifies the file type need to be saved.\n     *\n     * @param {SaveOptions} saveOptions - Options for saving the excel file.\n     * {% codeBlock src='spreadsheet/save/index.md' %}{% endcodeBlock %}\n     */\n    Workbook.prototype.save = function (saveOptions) {\n        if (saveOptions === void 0) { saveOptions = {}; }\n        if (this.allowSave) {\n            var defaultProps = {\n                url: this.saveUrl,\n                fileName: saveOptions.fileName || 'Sample',\n                saveType: 'Xlsx'\n            };\n            var eventArgs = __assign({}, defaultProps, saveOptions, { customParams: {}, isFullPost: true, needBlobData: false, cancel: false });\n            this.trigger('beforeSave', eventArgs);\n            this.notify(beginAction, { eventArgs: eventArgs, action: 'beforeSave' });\n            if (!eventArgs.cancel) {\n                this.notify(events.beginSave, {\n                    saveSettings: eventArgs, isFullPost: eventArgs.isFullPost,\n                    needBlobData: eventArgs.needBlobData, customParams: eventArgs.customParams\n                });\n            }\n        }\n    };\n    /**\n     * Saves the Spreadsheet data as JSON object.\n     * {% codeBlock src='spreadsheet/saveAsJson/index.md' %}{% endcodeBlock %}\n     */\n    Workbook.prototype.saveAsJson = function () {\n        var _this = this;\n        return new Promise(function (resolve) {\n            _this.on(events.onSave, function (args) {\n                args.cancel = true;\n                _this.off(events.onSave);\n                resolve({ jsonObject: { Workbook: args.jsonObject } });\n                _this.notify(events.saveCompleted, args);\n            });\n            _this.save();\n        });\n    };\n    Workbook.prototype.addHyperlink = function (hyperlink, cellAddress) {\n        var args = { hyperlink: hyperlink, cell: cellAddress };\n        this.notify(setLinkModel, args);\n    };\n    /**\n     * To find the specified cell value.\n     * @param args - options for find.\n     * {% codeBlock src='spreadsheet/findHandler/index.md' %}{% endcodeBlock %}\n     */\n    Workbook.prototype.findHandler = function (args) {\n        if (args.findOpt === 'next') {\n            this.notify(events.findNext, args);\n        }\n        else if (args.findOpt === 'prev') {\n            this.notify(events.findPrevious, args);\n        }\n    };\n    /**\n     * To replace the specified cell or entire match value.\n     * @param args - options for replace.\n     * {% codeBlock src='spreadsheet/replaceHandler/index.md' %}{% endcodeBlock %}\n     */\n    Workbook.prototype.replaceHandler = function (args) {\n        if (args.replaceBy === 'replace') {\n            this.notify(events.replaceHandler, args);\n        }\n        else {\n            this.notify(events.replaceAllHandler, args);\n        }\n    };\n    /**\n     * Protect the active sheet based on the protect sheetings.\n     * @param protectSettings - Specifies the protect settings of the sheet.\n     */\n    Workbook.prototype.protectSheet = function (sheet, protectSettings) {\n        this.notify(events.protectsheetHandler, protectSettings);\n    };\n    /**\n     * Unprotect the active sheet.\n     * @param sheet - Specifies the sheet to Unprotect.\n     */\n    Workbook.prototype.unprotectSheet = function (sheet) {\n        var args = { sheet: sheet };\n        this.notify(events.unprotectsheetHandler, args);\n    };\n    /**\n     * Sorts the range of cells in the active Spreadsheet.\n     * @param sortOptions - options for sorting.\n     * @param range - address of the data range.\n     */\n    Workbook.prototype.sort = function (sortOptions, range) {\n        if (!this.allowSorting) {\n            return Promise.reject();\n        }\n        var eventArgs = {\n            range: range || this.getActiveSheet().selectedRange,\n            sortOptions: sortOptions || { sortDescriptors: {} },\n            cancel: false\n        };\n        var promise = new Promise(function (resolve, reject) { resolve((function () { })()); });\n        var sortArgs = { args: eventArgs, promise: promise };\n        this.notify(events.initiateSort, sortArgs);\n        return sortArgs.promise;\n    };\n    Workbook.prototype.addDataValidation = function (rules, range) {\n        range = range ? range : this.getActiveSheet().selectedRange;\n        var eventArgs = {\n            range: range, type: rules.type, operator: rules.operator, value1: rules.value1,\n            value2: rules.value2, ignoreBlank: rules.ignoreBlank, inCellDropDown: rules.inCellDropDown, cancel: false\n        };\n        this.notify(beginAction, { eventArgs: eventArgs, action: 'validation' });\n        if (!eventArgs.cancel) {\n            range = eventArgs.range;\n            rules.type = eventArgs.type;\n            rules.operator = eventArgs.operator;\n            rules.value1 = eventArgs.value1;\n            rules.value2 = eventArgs.value2;\n            rules.ignoreBlank = eventArgs.ignoreBlank;\n            rules.inCellDropDown = eventArgs.inCellDropDown;\n            this.notify(events.setValidation, { rules: rules, range: range });\n            delete eventArgs.cancel;\n            this.notify(completeAction, { eventArgs: eventArgs, action: 'validation' });\n        }\n    };\n    Workbook.prototype.removeDataValidation = function (range) {\n        this.notify(events.removeValidation, { range: range });\n    };\n    Workbook.prototype.addInvalidHighlight = function (range) {\n        this.notify(events.addHighlight, { range: range });\n    };\n    Workbook.prototype.removeInvalidHighlight = function (range) {\n        this.notify(events.removeHighlight, { range: range });\n    };\n    Workbook.prototype.conditionalFormat = function (conditionalFormat) {\n        conditionalFormat.range = conditionalFormat.range || this.getActiveSheet().selectedRange;\n        this.notify(events.setCFRule, { conditionalFormat: conditionalFormat });\n    };\n    Workbook.prototype.clearConditionalFormat = function (range) {\n        range = range || this.getActiveSheet().selectedRange;\n        this.notify(events.clearCFRule, { range: range });\n    };\n    /**\n     * To update a cell properties.\n     * @param {CellModel} cell - Cell properties.\n     * @param {string} address - Address to update.\n     * {% codeBlock src='spreadsheet/updateCell/index.md' %}{% endcodeBlock %}\n     */\n    Workbook.prototype.updateCell = function (cell, address) {\n        var sheetIdx;\n        var range = getIndexesFromAddress(address);\n        if (address.includes('!')) {\n            sheetIdx = getSheetIndex(this, address.split('!')[0]);\n            if (sheetIdx === undefined) {\n                sheetIdx = this.activeSheetIndex;\n            }\n        }\n        else {\n            sheetIdx = this.activeSheetIndex;\n        }\n        setCell(range[0], range[1], this.sheets[sheetIdx], cell, true);\n        if (cell.value) {\n            this.notify(events.workbookEditOperation, {\n                action: 'updateCellValue', address: range, value: cell.value,\n                sheetIndex: sheetIdx\n            });\n        }\n    };\n    /**\n     * This method is used to wrap/unwrap the text content of the cell.\n     * @param address - Address of the cell to be wrapped.\n     * @param wrap - Set `false` if the text content of the cell to be unwrapped.\n     * @returns void\n     * {% codeBlock src='spreadsheet/wrap/index.md' %}{% endcodeBlock %}\n     */\n    Workbook.prototype.wrap = function (address, wrap) {\n        if (wrap === void 0) { wrap = true; }\n        wrapText(address, wrap, this);\n    };\n    /**\n     * Adds the defined name to the Spreadsheet.\n     * @param {DefineNameModel} definedName - Specifies the name.\n     * @return {boolean} - Return the added status of the defined name.\n     * {% codeBlock src='spreadsheet/addDefinedName/index.md' %}{% endcodeBlock %}\n     */\n    Workbook.prototype.addDefinedName = function (definedName) {\n        var eventArgs = {\n            action: 'addDefinedName',\n            isAdded: false,\n            definedName: definedName\n        };\n        this.notify(events.workbookFormulaOperation, eventArgs);\n        return eventArgs.isAdded;\n    };\n    /**\n     * Removes the defined name from the Spreadsheet.\n     * @param {string} definedName - Specifies the name.\n     * @param {string} scope - Specifies the scope of the defined name.\n     * @return {boolean} - Return the removed status of the defined name.\n     * {% codeBlock src='spreadsheet/removeDefinedName/index.md' %}{% endcodeBlock %}\n     */\n    Workbook.prototype.removeDefinedName = function (definedName, scope) {\n        if (scope === void 0) { scope = ''; }\n        var eventArgs = {\n            action: 'removeDefinedName',\n            isRemoved: false,\n            definedName: definedName,\n            scope: scope\n        };\n        this.notify(events.workbookFormulaOperation, eventArgs);\n        return eventArgs.isRemoved;\n    };\n    /** @hidden */\n    Workbook.prototype.clearRange = function (address, sheetIndex, valueOnly) {\n        if (valueOnly === void 0) { valueOnly = true; }\n        clearRange(this, address || this.getActiveSheet().selectedRange, isNullOrUndefined(sheetIndex) ? this.activeSheetIndex : sheetIndex, valueOnly);\n    };\n    /**\n     * Used to set the image in spreadsheet.\n     * @param {ImageModel} images - Specifies the options to insert image in spreadsheet.\n     * @param {string} range - Specifies the range in spreadsheet.\n     * @returns void\n     */\n    Workbook.prototype.insertImage = function (images, range) {\n        this.notify(setImage, { options: images, range: range ? range : this.getActiveSheet().selectedRange });\n    };\n    /**\n     * Used to set the chart in spreadsheet.\n     * @param {ChartModel} chart - Specifies the options to insert chart in spreadsheet.\n     * @returns void\n     */\n    Workbook.prototype.insertChart = function (chart) {\n        this.notify(setChart, { chart: chart });\n    };\n    /**\n     * Used to delete the chart from spreadsheet.\n     * @param {string} id - Specifies the chart element id.\n     * @returns void\n     */\n    Workbook.prototype.deleteChart = function (id) {\n        this.notify(deleteChart, { id: id });\n    };\n    /**\n     * Filters the range of cells in the sheet.\n     */\n    Workbook.prototype.filter = function (filterOptions, range) {\n        if (!this.allowFiltering) {\n            return Promise.reject();\n        }\n        var eventArgs = {\n            range: range || this.getActiveSheet().selectedRange,\n            filterOptions: filterOptions,\n            cancel: false\n        };\n        var promise = new Promise(function (resolve, reject) { resolve((function () { })()); });\n        var filterArgs = { args: eventArgs, promise: promise };\n        this.notify(events.initiateFilter, filterArgs);\n        return filterArgs.promise;\n    };\n    /**\n     * Clears the filter changes of the sheet.\n     * {% codeBlock src='spreadsheet/clearFilter/index.md' %}{% endcodeBlock %}\n     */\n    Workbook.prototype.clearFilter = function () {\n        this.notify(events.clearAllFilter, null);\n    };\n    /**\n     * To add custom library function.\n     * @param {string} functionHandler - Custom function handler name\n     * @param {string} functionName - Custom function name\n     * {% codeBlock src='spreadsheet/addCustomFunction/index.md' %}{% endcodeBlock %}\n     */\n    Workbook.prototype.addCustomFunction = function (functionHandler, functionName) {\n        functionName = functionName ? functionName : typeof functionHandler === 'string' ? functionHandler :\n            functionHandler.name.replace('bound ', '');\n        var eventArgs = {\n            action: 'addCustomFunction',\n            functionHandler: functionHandler,\n            functionName: functionName\n        };\n        this.notify(events.workbookFormulaOperation, eventArgs);\n    };\n    /**\n     * This method is used to Clear contents, formats and hyperlinks in spreadsheet.\n     *    * @param {ClearOptions} options - Options for clearing the content, formats and hyperlinks in spreadsheet.\n     */\n    Workbook.prototype.clear = function (options) {\n        this.notify(events.clear, options);\n    };\n    /**\n     * Gets the formatted text of the cell.\n     * {% codeBlock src='spreadsheet/getDisplayText/index.md' %}{% endcodeBlock %}\n     */\n    Workbook.prototype.getDisplayText = function (cell) {\n        if (!cell) {\n            return '';\n        }\n        if (cell.value && cell.format) {\n            var eventArgs = {\n                formattedText: cell.value, value: cell.value, format: cell.format, onLoad: true\n            };\n            this.notify(events.getFormattedCellObject, eventArgs);\n            return eventArgs.formattedText;\n        }\n        else if (!cell.value && cell.hyperlink) {\n            return typeof cell.hyperlink === 'string' ? cell.hyperlink : cell.hyperlink.address;\n        }\n        else {\n            return cell.value ? cell.value.toString() : '';\n        }\n    };\n    /**\n     * @hidden\n     */\n    Workbook.prototype.getAddressInfo = function (address) {\n        return getAddressInfo(this, address);\n    };\n    /**\n     * @hidden\n     */\n    Workbook.prototype.setSheetPropertyOnMute = function (sheet, prop, value) {\n        this.isProtectedOnChange = true;\n        sheet[prop] = value;\n        this.isProtectedOnChange = false;\n    };\n    var Workbook_1;\n    __decorate([\n        Collection([], Sheet)\n    ], Workbook.prototype, \"sheets\", void 0);\n    __decorate([\n        Property(0)\n    ], Workbook.prototype, \"activeSheetIndex\", void 0);\n    __decorate([\n        Property('100%')\n    ], Workbook.prototype, \"height\", void 0);\n    __decorate([\n        Property(true)\n    ], Workbook.prototype, \"allowFindAndReplace\", void 0);\n    __decorate([\n        Property()\n    ], Workbook.prototype, \"filterCollection\", void 0);\n    __decorate([\n        Property('100%')\n    ], Workbook.prototype, \"width\", void 0);\n    __decorate([\n        Property(true)\n    ], Workbook.prototype, \"showRibbon\", void 0);\n    __decorate([\n        Property(true)\n    ], Workbook.prototype, \"showFormulaBar\", void 0);\n    __decorate([\n        Property(true)\n    ], Workbook.prototype, \"showSheetTabs\", void 0);\n    __decorate([\n        Property(true)\n    ], Workbook.prototype, \"allowEditing\", void 0);\n    __decorate([\n        Property(true)\n    ], Workbook.prototype, \"allowOpen\", void 0);\n    __decorate([\n        Property(true)\n    ], Workbook.prototype, \"allowSave\", void 0);\n    __decorate([\n        Property(true)\n    ], Workbook.prototype, \"allowSorting\", void 0);\n    __decorate([\n        Property(true)\n    ], Workbook.prototype, \"allowFiltering\", void 0);\n    __decorate([\n        Property(true)\n    ], Workbook.prototype, \"allowNumberFormatting\", void 0);\n    __decorate([\n        Property(true)\n    ], Workbook.prototype, \"allowCellFormatting\", void 0);\n    __decorate([\n        Property(true)\n    ], Workbook.prototype, \"allowHyperlink\", void 0);\n    __decorate([\n        Property(true)\n    ], Workbook.prototype, \"allowInsert\", void 0);\n    __decorate([\n        Property(true)\n    ], Workbook.prototype, \"allowDelete\", void 0);\n    __decorate([\n        Property(true)\n    ], Workbook.prototype, \"allowMerge\", void 0);\n    __decorate([\n        Property(true)\n    ], Workbook.prototype, \"allowDataValidation\", void 0);\n    __decorate([\n        Property(true)\n    ], Workbook.prototype, \"allowImage\", void 0);\n    __decorate([\n        Property(true)\n    ], Workbook.prototype, \"allowChart\", void 0);\n    __decorate([\n        Property(true)\n    ], Workbook.prototype, \"allowConditionalFormat\", void 0);\n    __decorate([\n        Complex({}, CellStyle)\n    ], Workbook.prototype, \"cellStyle\", void 0);\n    __decorate([\n        Property('')\n    ], Workbook.prototype, \"openUrl\", void 0);\n    __decorate([\n        Property('')\n    ], Workbook.prototype, \"saveUrl\", void 0);\n    __decorate([\n        Collection([], DefineName)\n    ], Workbook.prototype, \"definedNames\", void 0);\n    __decorate([\n        Event()\n    ], Workbook.prototype, \"beforeOpen\", void 0);\n    __decorate([\n        Event()\n    ], Workbook.prototype, \"openFailure\", void 0);\n    __decorate([\n        Event()\n    ], Workbook.prototype, \"beforeSave\", void 0);\n    __decorate([\n        Event()\n    ], Workbook.prototype, \"saveComplete\", void 0);\n    __decorate([\n        Event()\n    ], Workbook.prototype, \"beforeCellFormat\", void 0);\n    __decorate([\n        Event()\n    ], Workbook.prototype, \"queryCellInfo\", void 0);\n    Workbook = Workbook_1 = __decorate([\n        NotifyPropertyChanges\n    ], Workbook);\n    return Workbook;\n}(Component));\nexport { Workbook };\n","import { detach, EventHandler, Browser, extend, isNullOrUndefined } from '@syncfusion/ej2-base';\nimport { getRangeIndexes, getCell, setCell, getSheet, getSwapRange, wrapEvent, inRange } from '../../workbook/index';\nimport { getRangeAddress, workbookEditOperation, getSheetIndexFromId, getSheetName } from '../../workbook/index';\nimport { getFormattedCellObject, workbookFormulaOperation, applyCellFormat, checkIsFormula } from '../../workbook/index';\nimport { pasteMerge, setMerge, getCellIndexes, getCellAddress } from '../../workbook/index';\nimport { ribbonClick, cut, copy, paste, initiateFilterUI } from '../common/index';\nimport { hasTemplate, createImageElement } from '../common/index';\nimport { enableToolbarItems, rowHeightChanged, completeAction, beginAction } from '../common/index';\nimport { clearCopy, locateElem, selectRange, dialog, contentLoaded, tabSwitch, cMenuBeforeOpen, locale } from '../common/index';\nimport { getMaxHgt, setMaxHgt, setRowEleHeight, deleteImage, getRowIdxFromClientY, getColIdxFromClientX } from '../common/index';\nimport { Deferred } from '@syncfusion/ej2-data';\nimport { refreshRibbonIcons, isCellReference, getColumn, isLocked as isCellLocked } from '../../workbook/index';\nimport { skipDefaultValue, getFilteredCollection, getColumnHeaderText, setChart } from '../../workbook/index';\n/**\n * Represents clipboard support for Spreadsheet.\n */\nvar Clipboard = /** @class */ (function () {\n    function Clipboard(parent) {\n        this.externalMerge = false;\n        this.parent = parent;\n        this.init();\n        this.addEventListener();\n    }\n    Clipboard.prototype.init = function () {\n        this.parent.element\n            .appendChild(this.parent.createElement('input', { className: 'e-clipboard', attrs: { 'contenteditable': 'true' } }));\n    };\n    Clipboard.prototype.addEventListener = function () {\n        var ele = this.getClipboardEle();\n        this.parent.on(cut, this.cut, this);\n        this.parent.on(copy, this.copy, this);\n        this.parent.on(paste, this.paste, this);\n        this.parent.on(clearCopy, this.clearCopiedInfo, this);\n        this.parent.on(tabSwitch, this.tabSwitchHandler, this);\n        this.parent.on(cMenuBeforeOpen, this.cMenuBeforeOpenHandler, this);\n        this.parent.on(ribbonClick, this.ribbonClickHandler, this);\n        this.parent.on(contentLoaded, this.initCopyIndicator, this);\n        this.parent.on(rowHeightChanged, this.rowHeightChanged, this);\n        EventHandler.add(ele, 'cut', this.cut, this);\n        EventHandler.add(ele, 'copy', this.copy, this);\n        EventHandler.add(ele, 'paste', this.paste, this);\n    };\n    Clipboard.prototype.removeEventListener = function () {\n        var ele = this.getClipboardEle();\n        if (!this.parent.isDestroyed) {\n            this.parent.off(cut, this.cut);\n            this.parent.off(copy, this.copy);\n            this.parent.off(paste, this.paste);\n            this.parent.off(clearCopy, this.clearCopiedInfo);\n            this.parent.off(tabSwitch, this.tabSwitchHandler);\n            this.parent.off(cMenuBeforeOpen, this.cMenuBeforeOpenHandler);\n            this.parent.off(ribbonClick, this.ribbonClickHandler);\n            this.parent.off(contentLoaded, this.initCopyIndicator);\n            this.parent.off(rowHeightChanged, this.rowHeightChanged);\n        }\n        EventHandler.remove(ele, 'cut', this.cut);\n        EventHandler.remove(ele, 'copy', this.copy);\n        EventHandler.remove(ele, 'paste', this.paste);\n    };\n    Clipboard.prototype.ribbonClickHandler = function (args) {\n        var parentId = this.parent.element.id;\n        switch (args.item.id) {\n            case parentId + '_cut':\n                this.cut({ isAction: true });\n                break;\n            case parentId + '_copy':\n                this.copy({ isAction: true });\n                break;\n        }\n        this.parent.element.focus();\n    };\n    Clipboard.prototype.tabSwitchHandler = function (args) {\n        if (args.activeTab === 0 && !this.copiedInfo && !this.copiedShapeInfo) {\n            this.hidePaste();\n        }\n    };\n    Clipboard.prototype.cMenuBeforeOpenHandler = function (e) {\n        var sheet = this.parent.getActiveSheet();\n        var l10n = this.parent.serviceLocator.getService(locale);\n        var delRowItems = [];\n        var hideRowItems = [];\n        var delColItems = [];\n        var hideColItems = [];\n        var actCell = sheet.activeCell;\n        var actCellIndex = getCellIndexes(actCell);\n        var cellObj = getCell(actCellIndex[0], actCellIndex[1], sheet);\n        var isLocked = sheet.isProtected && isCellLocked(cellObj, getColumn(sheet, actCellIndex[1]));\n        if (e.target === 'Content' || e.target === 'RowHeader' || e.target === 'ColumnHeader') {\n            this.parent.enableContextMenuItems([l10n.getConstant('Paste'), l10n.getConstant('PasteSpecial')], (this.copiedInfo ||\n                this.copiedShapeInfo && !isLocked) ? true : false);\n            this.parent.enableContextMenuItems([l10n.getConstant('Cut')], (!isLocked) ? true : false);\n        }\n        if ((e.target === 'Content') && isLocked) {\n            this.parent.enableContextMenuItems([l10n.getConstant('Cut'), l10n.getConstant('Filter'), l10n.getConstant('Sort')], false);\n        }\n        if ((e.target === 'Content') && (isLocked && !sheet.protectSettings.insertLink)) {\n            this.parent.enableContextMenuItems([l10n.getConstant('Hyperlink')], false);\n        }\n        if (e.target === 'ColumnHeader' && sheet.isProtected) {\n            delColItems = [l10n.getConstant('DeleteColumn'), l10n.getConstant('DeleteColumns'),\n                l10n.getConstant('InsertColumn'), l10n.getConstant('InsertColumns')];\n            hideColItems = [l10n.getConstant('HideColumn'), l10n.getConstant('HideColumns'),\n                l10n.getConstant('UnHideColumns')];\n            this.parent.enableContextMenuItems(delColItems, false);\n            this.parent.enableContextMenuItems(hideColItems, (sheet.protectSettings.formatColumns) ? true : false);\n        }\n        if (e.target === 'RowHeader' && sheet.isProtected) {\n            delRowItems = [l10n.getConstant('DeleteRow'), l10n.getConstant('DeleteRows'),\n                l10n.getConstant('InsertRow'), l10n.getConstant('InsertRows')];\n            hideRowItems = [l10n.getConstant('HideRow'), l10n.getConstant('HideRows'), l10n.getConstant('UnHideRows')];\n            this.parent.enableContextMenuItems(delRowItems, false);\n            this.parent.enableContextMenuItems(hideRowItems, (sheet.protectSettings.formatRows) ? true : false);\n        }\n    };\n    Clipboard.prototype.rowHeightChanged = function (args) {\n        if (this.copiedInfo && this.copiedInfo.range[0] > args.rowIdx) {\n            var ele = this.parent.element.getElementsByClassName('e-copy-indicator')[0];\n            if (ele) {\n                ele.style.top = parseInt(ele.style.top, 10) + args.threshold + \"px\";\n            }\n        }\n    };\n    Clipboard.prototype.cut = function (args) {\n        this.setCopiedInfo(args, true);\n    };\n    Clipboard.prototype.copy = function (args) {\n        this.copiedSheet = this.parent.getActiveSheet();\n        this.setCopiedInfo(args, false);\n    };\n    Clipboard.prototype.paste = function (args) {\n        if (this.parent.isEdit) {\n            return;\n        }\n        var rfshRange;\n        args.isAction = true;\n        /* tslint:disable-next-line */\n        var isExternal = ((args && args.clipboardData) || window['clipboardData']);\n        var copiedIdx = this.getCopiedIdx();\n        var isCut;\n        var copyInfo = Object.assign({}, this.copiedInfo);\n        if (isExternal || this.copiedShapeInfo || (args.isInternal && this.copiedInfo)) {\n            var cSIdx = (args && args.sIdx > -1) ? args.sIdx : this.parent.activeSheetIndex;\n            var curSheet = getSheet(this.parent, cSIdx);\n            var selIdx = getSwapRange(args && args.range || getRangeIndexes(curSheet.selectedRange));\n            var rows = isExternal && this.getExternalCells(args);\n            if (!args.isInternal && rows && rows.internal) {\n                isExternal = false;\n                if (!this.copiedInfo) {\n                    return;\n                }\n            }\n            if (isExternal && !rows.length) { // If image pasted\n                return;\n            }\n            var cellLength = 0;\n            if (rows) {\n                for (var i = 0; i < rows.length; i++) {\n                    cellLength = rows[i].cells.length > cellLength ? rows[i].cells.length : cellLength;\n                }\n            }\n            var rowIdx = selIdx[0];\n            var cIdx = isExternal\n                ? [0, 0, rows.length - 1, cellLength - 1] : getSwapRange(this.copiedShapeInfo ?\n                getRangeIndexes(curSheet.selectedRange) : this.copiedInfo.range);\n            var isRepeative = (selIdx[2] - selIdx[0] + 1) % (cIdx[2] - cIdx[0] + 1) === 0\n                && (selIdx[3] - selIdx[1] + 1) % (cIdx[3] - cIdx[1] + 1) === 0;\n            rfshRange = isRepeative ? selIdx : [selIdx[0], selIdx[1]]\n                .concat([selIdx[0] + cIdx[2] - cIdx[0], selIdx[1] + cIdx[3] - cIdx[1] || selIdx[1]]);\n            var beginEventArgs = {\n                requestType: 'paste',\n                copiedInfo: this.copiedInfo,\n                copiedRange: getRangeAddress(cIdx),\n                pastedRange: getRangeAddress(rfshRange),\n                type: (args && args.type) || 'All',\n                cancel: false\n            };\n            if (args.isAction && !this.copiedShapeInfo && this.copiedInfo) {\n                this.parent.notify(beginAction, { eventArgs: beginEventArgs, action: 'clipboard' });\n            }\n            if (beginEventArgs.cancel) {\n                return;\n            }\n            var cell = void 0;\n            var isExtend = void 0;\n            var prevCell = void 0;\n            var mergeCollection = [];\n            var prevSheet = getSheet(this.parent, isExternal ? cSIdx : copiedIdx);\n            selIdx = getRangeIndexes(beginEventArgs.pastedRange);\n            rowIdx = selIdx[0];\n            cIdx = isExternal\n                ? [0, 0, rows.length - 1, cellLength - 1] : getSwapRange(this.copiedShapeInfo ?\n                getRangeIndexes(curSheet.selectedRange) : this.copiedInfo.range);\n            isRepeative = (selIdx[2] - selIdx[0] + 1) % (cIdx[2] - cIdx[0] + 1) === 0 && (selIdx[3] - selIdx[1] + 1) %\n                (cIdx[3] - cIdx[1] + 1) === 0;\n            var mergeArgs = {\n                range: cIdx, prevSheet: prevSheet, cancel: false\n            };\n            rfshRange = isRepeative ? selIdx : [selIdx[0], selIdx[1]]\n                .concat([selIdx[0] + cIdx[2] - cIdx[0], selIdx[1] + cIdx[3] - cIdx[1] || selIdx[1]]);\n            var copiedAddress = getCellAddress(cIdx[0], cIdx[1]);\n            var copiedIndex = getCellIndexes(copiedAddress);\n            this.parent.notify(refreshRibbonIcons, copiedIndex);\n            if (this.copiedShapeInfo && !this.copiedInfo) {\n                var pictureElem = this.copiedShapeInfo.pictureElem;\n                if (pictureElem.classList.contains('e-datavisualization-chart')) {\n                    this.parent.notify(setChart, {\n                        chart: [this.copiedShapeInfo.chartInfo], isInitCell: true, isUndoRedo: true, isPaste: true,\n                        dataSheetIdx: this.copiedShapeInfo.sheetIdx, isCut: this.copiedShapeInfo.isCut,\n                        range: args.range || curSheet.selectedRange, isIdAvailabe: false\n                    });\n                }\n                else {\n                    this.parent.notify(createImageElement, {\n                        options: {\n                            src: pictureElem.style.backgroundImage.replace(/url\\((['\"])?(.*?)\\1\\)/gi, '$2'),\n                            height: this.copiedShapeInfo.height, width: this.copiedShapeInfo.width,\n                            imageId: this.copiedShapeInfo.isCut ? pictureElem.id : ''\n                        },\n                        range: getRangeAddress([rowIdx, selIdx[1], rowIdx, selIdx[1]]), isPublic: false, isUndoRedo: true\n                    });\n                }\n                var pastedCell = getCell(rowIdx, selIdx[1], curSheet);\n                if (pastedCell && !isNullOrUndefined(pastedCell.image)) {\n                    var imgLen = pastedCell.image ? pastedCell.image.length - 1 : 0;\n                    var eventArgs = {\n                        requestType: 'imagePaste',\n                        copiedShapeInfo: this.copiedShapeInfo,\n                        pasteSheetIndex: this.parent.activeSheetIndex,\n                        pastedRange: getSheetName(this.parent) + '!' + getRangeAddress([rowIdx, selIdx[1], rowIdx, selIdx[1]]),\n                        pastedPictureElement: document.getElementById(pastedCell.image[imgLen].id)\n                    };\n                    this.parent.notify(completeAction, { eventArgs: eventArgs, action: 'clipboard' });\n                }\n            }\n            else {\n                this.parent.notify(pasteMerge, mergeArgs);\n                if (mergeArgs.cancel) {\n                    return;\n                }\n                var pasteType = beginEventArgs.type ? beginEventArgs.type : args.type;\n                var cRows = [];\n                var inRange_1 = this.isInRange(cIdx, selIdx);\n                for (var i = cIdx[0], l = 0; i <= cIdx[2]; i++, l++) {\n                    if (inRange_1) {\n                        cRows[selIdx[0] + l] = { cells: [] };\n                    }\n                    for (var j = cIdx[1], k = 0; j <= cIdx[3]; j++, k++) {\n                        if (inRange_1) {\n                            cRows[selIdx[0] + l].cells[selIdx[1] + k] = getCell(selIdx[0] + l, selIdx[1] + k, prevSheet);\n                        }\n                        cell = isExternal ? rows[i].cells[j] : Object.assign({}, (inRange_1 && cRows[i] && cRows[i].cells[j])\n                            ? cRows[i].cells[j] : getCell(i, j, prevSheet));\n                        this.copiedCell = [i, j];\n                        if (cell && args && args.type || pasteType) {\n                            switch (pasteType) {\n                                case 'Formats':\n                                    cell = { format: cell.format, style: cell.style };\n                                    break;\n                                case 'Values':\n                                    cell = { value: cell.value };\n                                    if (cell.value && cell.value.toString().indexOf('\\n') > -1) {\n                                        var ele = this.parent.getCell(selIdx[0], selIdx[1]);\n                                        ele.classList.add('e-alt-unwrap');\n                                    }\n                                    break;\n                            }\n                            isExtend = ['Formats', 'Values'].indexOf(args.type) > -1;\n                        }\n                        if ((!this.parent.scrollSettings.isFinite && (cIdx[2] - cIdx[0] > (1048575 - selIdx[0])\n                            || cIdx[3] - cIdx[1] > (16383 - selIdx[1])))\n                            || (this.parent.scrollSettings.isFinite && (cIdx[2] - cIdx[0] > (curSheet.rowCount - 1 - selIdx[0])\n                                || cIdx[3] - cIdx[1] > (curSheet.colCount - 1 - selIdx[1])))) {\n                            this.showDialog();\n                            return;\n                        }\n                        if (isRepeative) {\n                            for (var x = selIdx[0]; x <= selIdx[2]; x += (cIdx[2] - cIdx[0]) + 1) {\n                                for (var y = selIdx[1]; y <= selIdx[3]; y += (cIdx[3] - cIdx[1] + 1)) {\n                                    prevCell = getCell(x + l, y + k, curSheet) || {};\n                                    if (!this.externalMerge && prevCell.colSpan !== undefined || prevCell.rowSpan !== undefined) {\n                                        mergeArgs = { range: [x + l, y + k, x + l, y + k] };\n                                        var merge = { range: mergeArgs.range, merge: false, isAction: false, type: 'All' };\n                                        mergeCollection.push(merge);\n                                        if (this.parent.activeSheetIndex === curSheet.index) {\n                                            this.parent.notify(setMerge, merge);\n                                        }\n                                    }\n                                    var colInd = y + k;\n                                    if (this.externalMerge && this.externalMergeRow === x + l) {\n                                        colInd = colInd + 1;\n                                    }\n                                    else {\n                                        this.externalMerge = false;\n                                    }\n                                    var newFormula = this.isFormula([x + l, colInd]);\n                                    if (!isNullOrUndefined(newFormula)) {\n                                        cell.formula = newFormula;\n                                    }\n                                    this.setCell(x + l, colInd, curSheet, cell, isExtend);\n                                    var sId = this.parent.activeSheetIndex;\n                                    var cellElem = this.parent.getCell(x + l, colInd);\n                                    var address = getCellAddress(x + l, colInd);\n                                    var cellArgs = {\n                                        address: this.parent.sheets[sId].name + '!' + address,\n                                        requestType: 'paste',\n                                        value: getCell(x + l, colInd, curSheet) ? getCell(x + l, colInd, curSheet).value : '',\n                                        oldValue: prevCell.value,\n                                        element: cellElem,\n                                        displayText: this.parent.getDisplayText(cell)\n                                    };\n                                    this.parent.trigger('cellSave', cellArgs);\n                                }\n                            }\n                        }\n                        else {\n                            if (!hasTemplate(this.parent, i, j, copiedIdx)) {\n                                this.setCell(rowIdx, selIdx[1] + k, curSheet, cell, isExtend);\n                            }\n                        }\n                        if (!isExternal && this.copiedInfo.isCut) {\n                            this.setCell(i, j, prevSheet, null, false, true);\n                        }\n                    }\n                    rowIdx++;\n                }\n                this.parent.setUsedRange(rfshRange[2] + 1, rfshRange[3]);\n                if (cSIdx === this.parent.activeSheetIndex) {\n                    this.parent.serviceLocator.getService('cell').refreshRange(rfshRange);\n                    this.parent.notify(selectRange, { indexes: rfshRange });\n                }\n                if (!isExternal && this.copiedInfo.isCut) {\n                    isCut = this.copiedInfo.isCut;\n                    if (copiedIdx === this.parent.activeSheetIndex) {\n                        this.parent.serviceLocator.getService('cell').refreshRange(cIdx);\n                    }\n                    this.clearCopiedInfo();\n                    this.cutInfo = isCut;\n                }\n                if (isExternal && this.copiedInfo) {\n                    this.clearCopiedInfo();\n                }\n                if (isExternal || (args && args.isAction)) {\n                    this.parent.element.focus();\n                }\n                if (args.isAction) {\n                    var sheetIndex = copyInfo && copyInfo.sId ? getSheetIndexFromId(this.parent, copyInfo.sId) :\n                        this.parent.activeSheetIndex;\n                    var eventArgs = {\n                        requestType: 'paste',\n                        copiedInfo: copyInfo,\n                        mergeCollection: mergeCollection,\n                        pasteSheetIndex: this.parent.activeSheetIndex,\n                        copiedRange: this.parent.sheets[sheetIndex].name + '!' + getRangeAddress(copyInfo && copyInfo.range ?\n                            copyInfo.range : getRangeIndexes(this.parent.sheets[sheetIndex].selectedRange)),\n                        pastedRange: getSheetName(this.parent) + '!' + getRangeAddress(rfshRange),\n                        type: pasteType || 'All'\n                    };\n                    this.parent.notify(completeAction, { eventArgs: eventArgs, action: 'clipboard' });\n                }\n                if (isCut) {\n                    this.updateFilter(copyInfo);\n                    setMaxHgt(prevSheet, cIdx[0], cIdx[1], 20);\n                    var hgt = getMaxHgt(prevSheet, cIdx[0]);\n                    setRowEleHeight(this.parent, prevSheet, hgt, cIdx[0]);\n                }\n            }\n        }\n        else {\n            this.getClipboardEle().select();\n        }\n    };\n    Clipboard.prototype.updateFilter = function (copyInfo) {\n        if (!this.isFilterCut) {\n            this.parent.notify(getFilteredCollection, null);\n            for (var i = 0; i < this.parent.sheets.length; i++) {\n                if (this.parent.filterCollection && this.parent.filterCollection[i] &&\n                    this.parent.filterCollection[i].sheetIdx === getSheetIndexFromId(this.parent, copyInfo.sId)) {\n                    var range = copyInfo.range;\n                    var fRange = getRangeIndexes(this.parent.filterCollection[i].filterRange);\n                    var endCol = getColumnHeaderText(range[3]);\n                    var fEndCol = getColumnHeaderText(fRange[3]);\n                    if (fRange[0] === range[0] && fRange[1] === range[1] && endCol === fEndCol) {\n                        this.isFilterCut = true;\n                    }\n                }\n            }\n        }\n        if (this.isFilterCut) {\n            for (var n = 0; n < this.parent.filterCollection.length; n++) {\n                var filterCol = this.parent.filterCollection[n];\n                var sheetIndex = copyInfo && copyInfo.sId ? getSheetIndexFromId(this.parent, copyInfo.sId) :\n                    this.parent.activeSheetIndex;\n                if (filterCol.sheetIdx === sheetIndex) {\n                    this.parent.notify(initiateFilterUI, { predicates: null, range: filterCol.filterRange, sIdx: sheetIndex, isCut: true });\n                }\n            }\n            this.parent.notify(initiateFilterUI, { predicates: null, range: null, sIdx: null, isCut: true });\n            this.isFilterCut = false;\n        }\n    };\n    Clipboard.prototype.isInRange = function (cRng, pRng) {\n        return inRange(cRng, pRng[0], pRng[1]) || inRange(cRng, pRng[2], pRng[3]);\n    };\n    Clipboard.prototype.isFormula = function (selIdx) {\n        var cIdxValue;\n        var cell;\n        var sheet;\n        if (!isNullOrUndefined(this.copiedCell)) {\n            sheet = !isNullOrUndefined(this.copiedSheet) ? this.copiedSheet : this.parent.getActiveSheet();\n            cell = getCell(this.copiedCell[0], this.copiedCell[1], sheet);\n            if (!isNullOrUndefined(cell)) {\n                cIdxValue = cell.formula ? cell.formula.toUpperCase() : '';\n            }\n        }\n        if (cIdxValue !== '' && !isNullOrUndefined(cIdxValue)) {\n            if (cIdxValue.indexOf('=') === 0) {\n                cIdxValue = cIdxValue.slice(1);\n            }\n            var start = cIdxValue.indexOf('(');\n            var end = cIdxValue.indexOf(')');\n            if (start > -1 && end > -1) {\n                cIdxValue = cIdxValue.slice(start + 1, end);\n            }\n            var difIndex = [];\n            var formulaOperators = ['+', '-', '*', '/'];\n            var splitArray = void 0;\n            var value = cIdxValue;\n            for (var i = 0; i < formulaOperators.length; i++) {\n                splitArray = value.split(formulaOperators[i]);\n                value = splitArray.join(',');\n            }\n            splitArray = value.split(',');\n            for (var j = 0; j < splitArray.length; j++) {\n                if (isCellReference(splitArray[j])) {\n                    var range = getCellIndexes(splitArray[j]);\n                    var diff = [this.copiedCell[0] - range[0], this.copiedCell[1] - range[1]];\n                    difIndex.push(diff[0]);\n                    difIndex.push(diff[1]);\n                }\n            }\n            var newAddress = [];\n            for (var j = 0; j < difIndex.length; j++) {\n                var address = getCellAddress(selIdx[0] - difIndex[0 + j], selIdx[1] - difIndex[1 + j]);\n                newAddress.push(address);\n                j++;\n            }\n            for (var a = 0; a < newAddress.length; a++) {\n                if (isCellReference(newAddress[a])) {\n                    var range = getRangeIndexes(newAddress[a]);\n                    if (range[0] < 0 || range[1] < 0) {\n                        newAddress[a] = '#REF!';\n                    }\n                }\n                else {\n                    newAddress[a] = '#REF!';\n                }\n            }\n            cIdxValue = cell.formula.toUpperCase();\n            for (var i = 0; i < splitArray.length; i++) {\n                for (var j = 0; j < newAddress.length; j++) {\n                    cIdxValue = cIdxValue.replace(splitArray[i].toUpperCase(), newAddress[j].toUpperCase());\n                    i++;\n                }\n            }\n            return cIdxValue;\n        }\n        else {\n            return null;\n        }\n    };\n    Clipboard.prototype.setCell = function (rIdx, cIdx, sheet, cell, isExtend, isCut) {\n        setCell(rIdx, cIdx, sheet, isCut ? null : cell, isExtend);\n        if (cell && cell.formula) {\n            this.parent.notify(workbookFormulaOperation, {\n                action: 'refreshCalculate', value: isCut ? '' : cell.formula, rowIndex: rIdx,\n                colIndex: cIdx, sheetIndex: this.parent.activeSheetIndex, isFormula: true\n            });\n        }\n        if (cell && !cell.formula) {\n            this.parent.notify(workbookEditOperation, {\n                action: 'updateCellValue', address: [rIdx, cIdx, rIdx,\n                    cIdx], value: cell.value\n            });\n        }\n        if (cell) {\n            if (cell.style) {\n                var style = {};\n                if (cell.style.properties) {\n                    style = skipDefaultValue(cell.style, true);\n                }\n                else {\n                    style = cell.style;\n                }\n                this.parent.notify(applyCellFormat, {\n                    style: extend({}, this.parent.commonCellStyle, style), rowIdx: rIdx, colIdx: cIdx, cell: null,\n                    lastCell: null, row: null, hRow: null, isHeightCheckNeeded: true, manualUpdate: false\n                });\n            }\n            if (cell.wrap) {\n                this.parent.notify(wrapEvent, { range: [rIdx, cIdx, rIdx, cIdx], wrap: false, sheet: sheet });\n            }\n            if (cell.colSpan > 1) {\n                setCell(rIdx, cIdx + cell.colSpan - 1, sheet, isCut ? null : { colSpan: -1 }, isExtend);\n                this.externalMerge = true;\n                this.externalMergeRow = rIdx;\n                this.parent.notify(setMerge, { merge: true, range: [rIdx, cIdx, rIdx, cIdx + cell.colSpan - 1],\n                    type: 'All', isAction: true, refreshRibbon: true });\n            }\n        }\n    };\n    Clipboard.prototype.getEmptyStyle = function (cellStyle) {\n        var style = {};\n        Object.keys(cellStyle).forEach(function (key) {\n            style[key] = '';\n        });\n        return style;\n    };\n    Clipboard.prototype.getCopiedIdx = function () {\n        if (this.copiedInfo) {\n            for (var i = 0; i < this.parent.sheets.length; i++) {\n                if (this.parent.sheets[i].id === this.copiedInfo.sId) {\n                    return i;\n                }\n            }\n            this.clearCopiedInfo();\n        }\n        return -1;\n    };\n    Clipboard.prototype.setCopiedInfo = function (args, isCut) {\n        var _this = this;\n        if (this.parent.isEdit || this.isFilterCut) {\n            return;\n        }\n        var deferred = new Deferred();\n        args.promise = deferred.promise;\n        var sheet = this.parent.getActiveSheet();\n        var range = (args && args.range) || getRangeIndexes(sheet.selectedRange);\n        if (isCut) {\n            this.parent.notify(getFilteredCollection, null);\n            for (var i = 0; i < this.parent.sheets.length; i++) {\n                if (this.parent.filterCollection && this.parent.filterCollection[i] &&\n                    this.parent.filterCollection[i].sheetIdx === this.parent.activeSheetIndex) {\n                    var fRange = getRangeIndexes(this.parent.filterCollection[i].filterRange);\n                    var endCol = getColumnHeaderText(range[3]);\n                    var fEndCol = getColumnHeaderText(fRange[3]);\n                    if (fRange[0] === range[0] && fRange[1] === range[1] && endCol === fEndCol) {\n                        this.isFilterCut = true;\n                    }\n                }\n            }\n        }\n        var option = {\n            sheet: sheet, indexes: [0, 0, sheet.rowCount - 1, sheet.colCount - 1], promise: new Promise(function (resolve, reject) { resolve((function () { })()); })\n        };\n        var pictureElements = document.getElementsByClassName('e-ss-overlay-active');\n        var pictureLen = pictureElements.length;\n        if (sheet.isLocalData && !(args && args.clipboardData) && range[0] === 0 && range[2] === (sheet.rowCount - 1)) {\n            this.parent.showSpinner();\n            this.parent.notify('updateSheetFromDataSource', option);\n        }\n        option.promise.then(function () {\n            if (pictureLen > 0) {\n                var imgRowIdx = {\n                    clientY: pictureElements[0].offsetTop,\n                    isImage: true\n                };\n                _this.parent.notify(getRowIdxFromClientY, imgRowIdx);\n                var imgColIdx = {\n                    clientX: pictureElements[0].offsetLeft,\n                    isImage: true\n                };\n                _this.parent.notify(getColIdxFromClientX, imgColIdx);\n                _this.copiedShapeInfo = {\n                    sId: (args && args.sId) ? args.sId : sheet.id, sheetIdx: sheet.index, isCut: isCut, pictureElem: pictureElements[0], copiedRange: getRangeAddress([imgRowIdx.clientY, imgColIdx.clientX,\n                        imgRowIdx.clientY, imgColIdx.clientX]), height: pictureElements[0].offsetHeight,\n                    width: pictureElements[0].offsetWidth,\n                    chartInfo: _this.getChartElemInfo(pictureElements[0], isCut)\n                };\n                _this.hidePaste(true);\n                if (isCut) {\n                    if (pictureElements[0].classList.contains('e-datavisualization-chart')) {\n                        _this.parent.deleteChart(_this.copiedShapeInfo.chartInfo.id);\n                    }\n                    else {\n                        _this.parent.notify(deleteImage, {\n                            id: _this.copiedShapeInfo.pictureElem.id, sheetIdx: _this.copiedShapeInfo.sId, range: _this.copiedShapeInfo.copiedRange\n                        });\n                    }\n                }\n            }\n            else if (!(args && args.clipboardData)) {\n                if (_this.copiedInfo) {\n                    _this.clearCopiedInfo();\n                }\n                _this.copiedInfo = {\n                    range: range, sId: (args && args.sId) ? args.sId : sheet.id, isCut: isCut\n                };\n                _this.hidePaste(true);\n                _this.initCopyIndicator();\n                if (!Browser.isIE) {\n                    _this.getClipboardEle().select();\n                }\n                if (args && args.isAction) {\n                    document.execCommand(isCut ? 'cut' : 'copy');\n                }\n                _this.parent.hideSpinner();\n            }\n            if (Browser.isIE) {\n                _this.setExternalCells(args);\n            }\n            deferred.resolve();\n        });\n        if (args && args.clipboardData) {\n            this.setExternalCells(args);\n            this.parent.element.focus();\n        }\n    };\n    Clipboard.prototype.getChartElemInfo = function (overlayEle, isCut) {\n        var chartColl = this.parent.chartColl;\n        if (overlayEle.classList.contains('e-datavisualization-chart')) {\n            var chartId = overlayEle.getElementsByClassName('e-control')[0].id;\n            for (var idx = 0; idx < chartColl.length; idx++) {\n                if (chartColl[idx].id === chartId) {\n                    var chart = chartColl[idx];\n                    return chart;\n                }\n            }\n        }\n        return null;\n    };\n    Clipboard.prototype.clearCopiedInfo = function () {\n        if (this.copiedInfo) {\n            if (this.parent.getActiveSheet().id === this.copiedInfo.sId) {\n                detach(this.parent.getMainContent().getElementsByClassName('e-copy-indicator')[0]);\n            }\n            this.copiedInfo = null;\n            this.hidePaste();\n        }\n        if (this.copiedShapeInfo) {\n            this.copiedShapeInfo = null;\n            this.hidePaste();\n        }\n    };\n    Clipboard.prototype.initCopyIndicator = function () {\n        if (this.copiedInfo && this.parent.getActiveSheet().id === this.copiedInfo.sId) {\n            var copyIndicator = this.parent.createElement('div', { className: 'e-copy-indicator' });\n            copyIndicator.appendChild(this.parent.createElement('div', { className: 'e-top' }));\n            copyIndicator.appendChild(this.parent.createElement('div', { className: 'e-bottom' }));\n            copyIndicator.appendChild(this.parent.createElement('div', { className: 'e-left' }));\n            copyIndicator.appendChild(this.parent.createElement('div', { className: 'e-right' }));\n            locateElem(copyIndicator, this.copiedInfo.range, this.parent.getActiveSheet(), false);\n            this.parent.getMainContent().appendChild(copyIndicator);\n        }\n    };\n    Clipboard.prototype.showDialog = function () {\n        var _this = this;\n        this.parent.serviceLocator.getService(dialog).show({\n            header: 'Spreadsheet',\n            target: this.parent.element,\n            height: 205, width: 340, isModal: true, showCloseIcon: true,\n            content: this.parent.serviceLocator.getService(locale).getConstant('PasteAlert'),\n            beforeOpen: function (args) {\n                var dlgArgs = {\n                    dialogName: 'PasteDialog',\n                    element: args.element, target: args.target, cancel: args.cancel\n                };\n                _this.parent.trigger('dialogBeforeOpen', dlgArgs);\n                if (dlgArgs.cancel) {\n                    args.cancel = true;\n                }\n            }\n        });\n    };\n    Clipboard.prototype.hidePaste = function (isShow) {\n        if (this.parent.getActiveSheet().isProtected) {\n            isShow = false;\n        }\n        this.parent.notify(enableToolbarItems, [{ items: [this.parent.element.id + '_paste'], enable: isShow || false }]);\n    };\n    Clipboard.prototype.setExternalCells = function (args) {\n        var cell;\n        var text = '';\n        var range = this.copiedInfo.range;\n        var sheet = this.parent.getActiveSheet();\n        var data = '<html><body><table class=\"e-spreadsheet\" xmlns=\"http://www.w3.org/1999/xhtml\"><tbody>';\n        for (var i = range[0]; i <= range[2]; i++) {\n            data += '<tr>';\n            for (var j = range[1]; j <= range[3]; j++) {\n                data += '<td style=\"white-space:nowrap;vertical-align:bottom;';\n                cell = getCell(i, j, sheet);\n                if (cell && cell.style) {\n                    Object.keys(cell.style).forEach(function (style) {\n                        var regex = style.match(/[A-Z]/);\n                        data += (style === 'backgroundColor' ? 'background' : (regex ? style.replace(regex[0], '-'\n                            + regex[0].toLowerCase()) : style)) + ':' + ((style === 'backgroundColor' || style === 'color')\n                            ? cell.style[style].slice(0, 7) : cell.style[style]) + ';';\n                    });\n                }\n                data += '\">';\n                if (cell && cell.value) {\n                    var eventArgs = {\n                        formattedText: cell.value,\n                        value: cell.value,\n                        format: cell.format,\n                        onLoad: true\n                    };\n                    if (cell.format) {\n                        this.parent.notify(getFormattedCellObject, eventArgs);\n                    }\n                    data += eventArgs.formattedText;\n                    text += eventArgs.formattedText;\n                }\n                data += '</td>';\n                text += j === range[3] ? '' : '\\t';\n            }\n            data += '</tr>';\n            text += i === range[2] ? '' : '\\n';\n        }\n        data += '</tbody></table></body></html>';\n        if (Browser.isIE) {\n            /* tslint:disable-next-line */\n            window['clipboardData'].setData('text', text);\n        }\n        else {\n            args.clipboardData.setData('text/html', data);\n            args.clipboardData.setData('text/plain', text);\n            args.preventDefault();\n        }\n    };\n    Clipboard.prototype.getExternalCells = function (args) {\n        var _this = this;\n        var html;\n        var text;\n        var rows = [];\n        var cells = [];\n        var cellStyle;\n        var ele = this.parent.createElement('span');\n        if (Browser.isIE) {\n            /* tslint:disable-next-line */\n            text = window['clipboardData'].getData('text');\n        }\n        else {\n            html = args.clipboardData.getData('text/html');\n            text = args.clipboardData.getData('text/plain');\n            ele.innerHTML = html;\n        }\n        if (ele.querySelector('table')) {\n            if (ele.querySelector('.e-spreadsheet')) {\n                rows = { internal: true };\n            }\n            else {\n                ele.querySelectorAll('tr').forEach(function (tr) {\n                    tr.querySelectorAll('td').forEach(function (td, j) {\n                        td.textContent = td.textContent.replace(/(\\r\\n|\\n|\\r)/gm, '');\n                        var cSpan = isNaN(parseInt(td.getAttribute('colspan'), 10)) ? 1 : parseInt(td.getAttribute('colspan'), 10);\n                        var rSpan = isNaN(parseInt(td.getAttribute('rowspan'), 10)) ? 1 : parseInt(td.getAttribute('rowspan'), 10);\n                        cells[j] = { value: td.textContent, style: _this.getStyle(td, ele), colSpan: cSpan, rowSpan: rSpan };\n                    });\n                    rows.push({ cells: cells });\n                    cells = [];\n                });\n            }\n        }\n        else if (text) {\n            if (html) {\n                [].slice.call(ele.children).forEach(function (child) {\n                    if (child.getAttribute('style')) {\n                        cellStyle = _this.getStyle(child, ele);\n                    }\n                });\n            }\n            text.trim().split('\\n').forEach(function (row) {\n                row.split('\\t').forEach(function (col, j) {\n                    cells[j] = { style: cellStyle };\n                    if (checkIsFormula(col)) {\n                        cells[j].formula = col;\n                    }\n                    else {\n                        cells[j].value = col;\n                    }\n                });\n                rows.push({ cells: cells });\n                cells = [];\n            });\n        }\n        setTimeout(function () { _this.getClipboardEle().innerHTML = ''; }, 0);\n        return rows;\n    };\n    Clipboard.prototype.getStyle = function (td, ele) {\n        var styles = [];\n        var cellStyle = {};\n        if (td.classList.length || td.getAttribute('style')) {\n            if (td.classList.length) {\n                if (ele.querySelector('style').innerHTML.indexOf(td.classList[0]) > -1) {\n                    styles.push(ele.querySelector('style').innerHTML.split(td.classList[0])[1].split('{')[1].split('}')[0]);\n                }\n            }\n            if (td.getAttribute('style')) {\n                styles.push(td.getAttribute('style'));\n            }\n            styles.forEach(function (styles) {\n                styles.split(';').forEach(function (style) {\n                    var char = style.split(':')[0].trim();\n                    if (['font-family', 'vertical-align', 'text-align', 'text-indent', 'color', 'background', 'font-weight', 'font-style',\n                        'font-size', 'text-decoration', 'border-bottom', 'border-top', 'border-right', 'border-left',\n                        'border'].indexOf(char) > -1) {\n                        char = char === 'background' ? 'backgroundColor' : char;\n                        var regex = char.match(/-[a-z]/);\n                        cellStyle[regex ? char.replace(regex[0], regex[0].charAt(1).toUpperCase()) : char] = style.split(':')[1];\n                    }\n                });\n            });\n        }\n        return cellStyle;\n    };\n    Clipboard.prototype.getClipboardEle = function () {\n        return this.parent.element.getElementsByClassName('e-clipboard')[0];\n    };\n    Clipboard.prototype.getModuleName = function () {\n        return 'clipboard';\n    };\n    Clipboard.prototype.destroy = function () {\n        this.removeEventListener();\n        var ele = this.getClipboardEle();\n        detach(ele);\n        this.parent = null;\n    };\n    return Clipboard;\n}());\nexport { Clipboard };\n","import { EventHandler, Browser, closest, isUndefined, isNullOrUndefined, select } from '@syncfusion/ej2-base';\nimport { getRangeIndexes, getRangeFromAddress, getIndexesFromAddress, getRangeAddress, isSingleCell } from '../../workbook/common/address';\nimport { keyDown, editOperation, clearCopy, mouseDown, selectionComplete, enableToolbarItems, completeAction } from '../common/event';\nimport { formulaBarOperation, formulaOperation, setActionData, keyUp, getCellPosition, deleteImage } from '../common/index';\nimport { workbookEditOperation, getFormattedBarText, getFormattedCellObject, wrapEvent, isValidation } from '../../workbook/common/event';\nimport { getSheetName, getSheetIndex, getCell, getColumn } from '../../workbook/base/index';\nimport { getSheetNameFromAddress, getSheet } from '../../workbook/base/index';\nimport { hasTemplate, editAlert } from '../common/index';\nimport { getSwapRange, getCellIndexes, wrap as wrapText, checkIsFormula, dataChanged, isNumber, isLocked } from '../../workbook/index';\nimport { checkConditionalFormat, initiateFormulaReference, initiateCur, clearCellRef, addressHandle } from '../common/event';\nimport { editValue, initiateEdit, forRefSelRender, isFormulaBarEdit, deleteChart } from '../common/event';\n/**\n * The `Protect-Sheet` module is used to handle the Protecting functionalities in Spreadsheet.\n */\nvar Edit = /** @class */ (function () {\n    /**\n     * Constructor for protect-sheet module in Spreadsheet.\n     * @private\n     */\n    function Edit(parent) {\n        this.editorElem = null;\n        this.editCellData = {};\n        this.isEdit = false;\n        this.isCellEdit = true;\n        this.isNewValueEdit = true;\n        this.isAltEnter = false;\n        this.validCharacters = ['+', '-', '*', '/', ',', '(', '=', '&'];\n        this.keyCodes = {\n            BACKSPACE: 8,\n            SPACE: 32,\n            TAB: 9,\n            DELETE: 46,\n            ESC: 27,\n            ENTER: 13,\n            FIRSTALPHABET: 65,\n            LASTALPHABET: 90,\n            FIRSTNUMBER: 48,\n            LASTNUMBER: 59,\n            FIRSTNUMPAD: 96,\n            LASTNUMPAD: 111,\n            SYMBOLSETONESTART: 186,\n            SYMBOLSETONEEND: 192,\n            SYMBOLSETTWOSTART: 219,\n            SYMBOLSETTWOEND: 222,\n            FIREFOXEQUALPLUS: 61,\n            FIREFOXMINUS: 173,\n            F2: 113\n        };\n        this.parent = parent;\n        this.init();\n        //Spreadsheet.Inject(WorkbookEdit);\n    }\n    Edit.prototype.init = function () {\n        this.addEventListener();\n    };\n    /**\n     * To destroy the edit module.\n     * @return {void}\n     * @hidden\n     */\n    Edit.prototype.destroy = function () {\n        this.removeEventListener();\n        this.parent = null;\n        this.editorElem = null;\n    };\n    Edit.prototype.addEventListener = function () {\n        EventHandler.add(this.parent.element, 'dblclick', this.dblClickHandler, this);\n        this.parent.on(mouseDown, this.mouseDownHandler, this);\n        this.parent.on(keyUp, this.keyUpHandler, this);\n        this.parent.on(keyDown, this.keyDownHandler, this);\n        this.parent.on(editOperation, this.performEditOperation, this);\n        this.parent.on(initiateCur, this.initiateCurPosition, this);\n        this.parent.on(editValue, this.updateFormulaBarValue, this);\n        this.parent.on(addressHandle, this.addressHandler, this);\n        this.parent.on(initiateEdit, this.initiateRefSelection, this);\n        this.parent.on(forRefSelRender, this.refSelectionRender, this);\n    };\n    Edit.prototype.removeEventListener = function () {\n        EventHandler.remove(this.parent.element, 'dblclick', this.dblClickHandler);\n        if (!this.parent.isDestroyed) {\n            this.parent.off(mouseDown, this.mouseDownHandler);\n            this.parent.off(keyUp, this.keyUpHandler);\n            this.parent.off(keyDown, this.keyDownHandler);\n            this.parent.off(editOperation, this.performEditOperation);\n            this.parent.off(initiateCur, this.initiateCurPosition);\n            this.parent.off(editValue, this.updateFormulaBarValue);\n            this.parent.off(addressHandle, this.addressHandler);\n            this.parent.off(initiateEdit, this.initiateRefSelection);\n            this.parent.off(forRefSelRender, this.refSelectionRender);\n        }\n    };\n    /**\n     * Get the module name.\n     * @returns string\n     * @private\n     */\n    Edit.prototype.getModuleName = function () {\n        return 'edit';\n    };\n    Edit.prototype.performEditOperation = function (args) {\n        var action = args.action;\n        switch (action) {\n            case 'renderEditor':\n                this.renderEditor();\n                break;\n            case 'refreshEditor':\n                this.refreshEditor(args.value, args.refreshFormulaBar, args.refreshEditorElem, args.isAppend, args.trigEvent);\n                if (args.refreshCurPos) {\n                    this.setCursorPosition();\n                }\n                break;\n            case 'startEdit':\n                if (!this.isEdit) {\n                    this.isNewValueEdit = args.isNewValueEdit;\n                    this.startEdit(args.address, args.value, args.refreshCurPos);\n                }\n                else {\n                    var isEdit = false;\n                    var arg = { isEdit: isEdit };\n                    this.parent.notify(isFormulaBarEdit, arg);\n                    if (arg.isEdit) {\n                        this.isNewValueEdit = args.isNewValueEdit;\n                        this.startEdit(args.address, args.value, args.refreshCurPos);\n                    }\n                }\n                break;\n            case 'endEdit':\n                if (this.isEdit) {\n                    this.endEdit(args.refreshFormulaBar);\n                }\n                break;\n            case 'cancelEdit':\n                if (this.isEdit) {\n                    this.cancelEdit(args.refreshFormulaBar);\n                }\n                break;\n            case 'getCurrentEditValue':\n                args.editedValue = this.editCellData.value;\n                break;\n            case 'refreshDependentCellValue':\n                this.refreshDependentCellValue(args.rowIdx, args.colIdx, args.sheetIdx);\n                break;\n            case 'getPosition':\n                args.position = this.editorElem.getBoundingClientRect();\n                break;\n            case 'focusEditorElem':\n                this.editorElem.focus();\n                break;\n            case 'getCurrentEditSheetIdx':\n                args.sheetIndex = this.editCellData.sheetIndex;\n                break;\n        }\n    };\n    Edit.prototype.keyUpHandler = function (e) {\n        if (this.isEdit) {\n            if (e.altKey && e.keyCode === 13) {\n                var editElement = this.parent.element.querySelector('.e-spreadsheet-edit');\n                editElement.focus();\n                this.altEnter();\n                this.isAltEnter = true;\n            }\n            else if (this.isCellEdit && this.editCellData.value !== this.editorElem.textContent && e.keyCode !== 16) {\n                this.refreshEditor(this.editorElem.textContent, this.isCellEdit);\n            }\n            var isFormulaEdit = checkIsFormula(this.editCellData.value) ||\n                (this.editCellData.value && this.editCellData.value.toString().indexOf('=') === 0);\n            if (isFormulaEdit && e.keyCode !== 16) {\n                var formulaRefIndicator = this.parent.element.querySelector('.e-formularef-indicator');\n                if (formulaRefIndicator) {\n                    formulaRefIndicator.parentElement.removeChild(formulaRefIndicator);\n                }\n                if (this.editCellData.value !== this.editorElem.textContent) {\n                    this.refreshEditor(this.editorElem.textContent, true);\n                }\n                var sheetIdx = this.editCellData.sheetIndex;\n                var editValue_1 = this.editCellData.value;\n                this.parent.notify(initiateFormulaReference, { range: editValue_1, formulaSheetIdx: sheetIdx });\n            }\n        }\n    };\n    Edit.prototype.keyDownHandler = function (e) {\n        var trgtElem = e.target;\n        var keyCode = e.keyCode;\n        var sheet = this.parent.getActiveSheet();\n        var actCell = getCellIndexes(sheet.activeCell);\n        var cell = getCell(actCell[0], actCell[1], sheet) || {};\n        if (!closest(e.target, '.e-findtool-dlg') && !closest(e.target, '.e-validationerror-dlg')) {\n            if (!sheet.isProtected || closest(e.target, '.e-sheet-rename') || !isLocked(cell, getColumn(sheet, actCell[1]))) {\n                if (this.isEdit) {\n                    var isFormulaEdit = checkIsFormula(this.editCellData.value) ||\n                        (this.editCellData.value && this.editCellData.value.toString().indexOf('=') === 0);\n                    if (this.isCellEdit || (isFormulaEdit && this.editCellData.value !== this.editorElem.textContent && e.keyCode !== 16)) {\n                        this.refreshEditor(this.editorElem.textContent, this.isCellEdit);\n                    }\n                    if (!e.altKey) {\n                        switch (keyCode) {\n                            case this.keyCodes.ENTER:\n                                if (Browser.isWindows) {\n                                    e.preventDefault();\n                                }\n                                if (this.isAltEnter) {\n                                    var text = this.parent.element.querySelector('.e-spreadsheet-edit').textContent;\n                                    if (text && text.indexOf('\\n') > -1) {\n                                        wrapText(this.parent.getActiveSheet().selectedRange, true, this.parent);\n                                        this.refreshEditor(this.editorElem.textContent, this.isCellEdit);\n                                        this.isAltEnter = false;\n                                    }\n                                }\n                                if (!isFormulaEdit) {\n                                    this.endEdit(false, e);\n                                }\n                                else {\n                                    var formulaRefIndicator = this.parent.element.querySelector('.e-formularef-indicator');\n                                    if (formulaRefIndicator) {\n                                        formulaRefIndicator.parentElement.removeChild(formulaRefIndicator);\n                                    }\n                                    if (this.editCellData.sheetIndex === sheet.id - 1) {\n                                        this.endEdit(false, e);\n                                    }\n                                    else {\n                                        this.parent.goTo(this.editCellData.fullAddr);\n                                        this.endEdit(false, e);\n                                    }\n                                }\n                                break;\n                            case this.keyCodes.TAB:\n                                if (!this.hasFormulaSuggSelected()) {\n                                    this.endEdit(false, e);\n                                }\n                                break;\n                            case this.keyCodes.ESC:\n                                this.cancelEdit(true, true, e);\n                                break;\n                        }\n                    }\n                }\n                else {\n                    if (!this.isEdit && (trgtElem.classList.contains('e-spreadsheet') || closest(trgtElem, '.e-sheet-panel'))) {\n                        var isAlphabet = (keyCode >= this.keyCodes.FIRSTALPHABET && keyCode <= this.keyCodes.LASTALPHABET);\n                        var isNumeric = (keyCode >= this.keyCodes.FIRSTNUMBER && keyCode <= this.keyCodes.LASTNUMBER);\n                        var isNumpadKeys = (keyCode >= this.keyCodes.FIRSTNUMPAD && keyCode <= this.keyCodes.LASTNUMPAD);\n                        var isSymbolkeys = (keyCode >= this.keyCodes.SYMBOLSETONESTART &&\n                            keyCode <= this.keyCodes.SYMBOLSETONEEND);\n                        if (!isSymbolkeys) {\n                            isSymbolkeys = (keyCode >= this.keyCodes.SYMBOLSETTWOSTART && keyCode <= this.keyCodes.SYMBOLSETTWOEND);\n                        }\n                        var isFirefoxExceptionkeys = (keyCode === this.keyCodes.FIREFOXEQUALPLUS) ||\n                            (keyCode === this.keyCodes.FIREFOXMINUS);\n                        var isF2Edit = (!e.shiftKey && !e.ctrlKey && !e.metaKey && keyCode === this.keyCodes.F2);\n                        var isBackSpace = keyCode === this.keyCodes.BACKSPACE;\n                        if ((!e.ctrlKey && !e.metaKey && !e.altKey && ((!e.shiftKey && keyCode === this.keyCodes.SPACE) || isAlphabet || isNumeric ||\n                            isNumpadKeys || isSymbolkeys || (Browser.info.name === 'mozilla' && isFirefoxExceptionkeys))) || isF2Edit || isBackSpace) {\n                            if (isF2Edit) {\n                                this.isNewValueEdit = false;\n                            }\n                            var pictureElements = document.getElementsByClassName('e-ss-overlay-active');\n                            var pictureLen = pictureElements.length;\n                            if (pictureLen > 0) {\n                                this.parent.notify(deleteImage, {\n                                    id: pictureElements[0].id, sheetIdx: this.parent.activeSheetIndex + 1\n                                });\n                            }\n                            else {\n                                this.startEdit(null, null, true, true);\n                            }\n                        }\n                        if (keyCode === this.keyCodes.DELETE) {\n                            this.isLockCellDelete(e);\n                            this.editingHandler('delete');\n                        }\n                    }\n                }\n            }\n            else {\n                if (((keyCode >= this.keyCodes.FIRSTALPHABET && keyCode <= this.keyCodes.LASTALPHABET) ||\n                    (keyCode >= this.keyCodes.FIRSTNUMBER && keyCode <= this.keyCodes.LASTNUMBER)\n                    || (keyCode === this.keyCodes.DELETE) || (keyCode === this.keyCodes.BACKSPACE) || (keyCode === this.keyCodes.SPACE)\n                    || (keyCode >= this.keyCodes.FIRSTNUMPAD && keyCode <= this.keyCodes.LASTNUMPAD) ||\n                    (keyCode >= this.keyCodes.SYMBOLSETONESTART && keyCode <= this.keyCodes.SYMBOLSETONEEND)\n                    || (keyCode >= 219 && keyCode <= 222) || (!e.shiftKey && !e.ctrlKey && !e.metaKey && keyCode === this.keyCodes.F2))\n                    && (keyCode !== 67) && (keyCode !== 89) && (keyCode !== 90)) {\n                    if (sheet.protectSettings.insertLink && keyCode === 75) {\n                        return;\n                    }\n                    if (!this.parent.element.querySelector('.e-editAlert-dlg')) {\n                        this.parent.notify(editAlert, null);\n                    }\n                }\n            }\n        }\n    };\n    Edit.prototype.isLockCellDelete = function (e) {\n        var sheet = this.parent.getActiveSheet();\n        var count = 0;\n        var address = getRangeIndexes(sheet.selectedRange);\n        for (var row = address[2]; row <= address[0]; row++) {\n            for (var col = address[3]; col <= address[1]; col++) {\n                var cell = getCell(row, col, sheet);\n                if (isLocked(cell, getColumn(sheet, col))) {\n                    e.preventDefault();\n                    count++;\n                }\n            }\n        }\n        if (count > 0) {\n            return;\n        }\n    };\n    Edit.prototype.renderEditor = function () {\n        if (!this.editorElem || !select('#' + this.parent.element.id + '_edit', this.parent.element)) {\n            var editor = void 0;\n            editor = this.parent.createElement('div', { id: this.parent.element.id + '_edit', className: 'e-spreadsheet-edit' });\n            editor.contentEditable = 'true';\n            editor.spellcheck = false;\n            this.editorElem = editor;\n            if (this.parent.element.getElementsByClassName('e-spreadsheet-edit')[0]) {\n                this.parent.element.getElementsByClassName('e-spreadsheet-edit')[0].remove();\n            }\n            this.parent.element.querySelector('.e-sheet-content').appendChild(this.editorElem);\n        }\n        this.parent.notify(formulaOperation, { action: 'renderAutoComplete' });\n    };\n    Edit.prototype.refreshEditor = function (value, refreshFormulaBar, refreshEditorElem, isAppend, trigEvent) {\n        if (trigEvent === void 0) { trigEvent = true; }\n        if (isAppend) {\n            value = this.editCellData.value = this.editCellData.value + value;\n        }\n        else {\n            this.editCellData.value = value;\n        }\n        if (refreshEditorElem) {\n            this.editorElem.textContent = value;\n        }\n        if (refreshFormulaBar) {\n            this.parent.notify(formulaBarOperation, { action: 'refreshFormulabar', value: value });\n        }\n        if (trigEvent && this.editCellData.value === this.editorElem.textContent) {\n            if (this.triggerEvent('cellEditing')) {\n                this.cancelEdit();\n            }\n        }\n        // if (this.editorElem.scrollHeight + 2 <= this.editCellData.element.offsetHeight) {\n        //     this.editorElem.style.height = (this.editCellData.element.offsetHeight + 1) + 'px';\n        // } else {\n        //     this.editorElem.style.removeProperty('height');\n        // }\n    };\n    Edit.prototype.startEdit = function (address, value, refreshCurPos, preventFormulaReference) {\n        if (refreshCurPos === void 0) { refreshCurPos = true; }\n        if (this.parent.showSheetTabs) {\n            this.parent.element.querySelector('.e-add-sheet-tab').setAttribute('disabled', 'true');\n        }\n        var sheet = this.parent.getActiveSheet();\n        var actCell = getCellIndexes(sheet.activeCell);\n        var cell = getCell(actCell[0], actCell[1], sheet) || {};\n        var range = getRangeIndexes(sheet.activeCell);\n        if (hasTemplate(this.parent, range[0], range[1], this.parent.activeSheetIndex)) {\n            var cellEle = this.parent.getCell(range[0], range[1]);\n            var isDelTemplate = false;\n            var value_1 = cellEle.innerHTML;\n            if (cellEle) {\n                if (value_1.indexOf('<') > -1 && value_1.indexOf('>') > -1 && value_1.indexOf('input') > -1) {\n                    isDelTemplate = true;\n                }\n            }\n            if (isDelTemplate) {\n                return;\n            }\n        }\n        this.updateEditCellDetail(address, value);\n        this.initiateEditor(refreshCurPos);\n        this.positionEditor();\n        this.parent.isEdit = this.isEdit = true;\n        this.parent.notify(clearCopy, null);\n        this.parent.notify(enableToolbarItems, [{ enable: false }]);\n        if (cell.formula && !preventFormulaReference) {\n            this.parent.notify(initiateFormulaReference, { range: cell.formula, formulaSheetIdx: this.editCellData.sheetIndex });\n        }\n    };\n    Edit.prototype.setCursorPosition = function () {\n        var elem = this.editorElem;\n        var textLen = elem.textContent.length;\n        if (textLen) {\n            var selection = document.getSelection();\n            var range = document.createRange();\n            range.setStart(elem.firstChild, textLen);\n            range.collapse(true);\n            selection.removeAllRanges();\n            selection.addRange(range);\n        }\n        elem.focus();\n    };\n    Edit.prototype.hasFormulaSuggSelected = function () {\n        var suggDdlElem = document.getElementById(this.parent.element.id + '_ac_popup');\n        return suggDdlElem && suggDdlElem.style.visibility === 'visible' &&\n            suggDdlElem.querySelectorAll('.e-item-focus').length > 0;\n    };\n    Edit.prototype.editingHandler = function (action) {\n        var pictureElements = document.getElementsByClassName('e-ss-overlay-active');\n        var pictureLen = pictureElements.length;\n        switch (action) {\n            case 'delete':\n                if (pictureLen > 0) {\n                    if (pictureElements[0].classList.contains('e-datavisualization-chart')) {\n                        this.parent.notify(deleteChart, {\n                            id: pictureElements[0].id, sheetIdx: this.parent.activeSheetIndex + 1\n                        });\n                    }\n                    else {\n                        this.parent.notify(deleteImage, {\n                            id: pictureElements[0].id, sheetIdx: this.parent.activeSheetIndex + 1\n                        });\n                    }\n                }\n                else {\n                    var address = this.parent.getActiveSheet().selectedRange;\n                    var range = getIndexesFromAddress(address);\n                    range = range[0] > range[2] ? getSwapRange(range) : range;\n                    address = getRangeAddress(range);\n                    this.parent.clearRange(address, null, true);\n                    this.parent.serviceLocator.getService('cell').refreshRange(range);\n                    this.parent.notify(selectionComplete, {});\n                    this.parent.notify(dataChanged, { address: address, sheetIdx: this.parent.activeSheetIndex, action: 'delete' });\n                }\n                break;\n        }\n    };\n    Edit.prototype.mouseDownHandler = function (e) {\n        if (!closest(e.target, '.e-findtool-dlg')) {\n            if (this.isEdit) {\n                var trgtElem = e.target;\n                var sheet = this.parent.getActiveSheet();\n                var formulaRefIndicator = this.parent.element.querySelector('.e-formularef-indicator');\n                this.isCellEdit = trgtElem.classList.contains('e-spreadsheet-edit');\n                var isFormula = checkIsFormula(this.editCellData.value) ||\n                    (this.editCellData.value && this.editCellData.value.toString().indexOf('=') === 0);\n                if (trgtElem.classList.contains('e-cell') || trgtElem.classList.contains('e-header-cell') ||\n                    trgtElem.classList.contains('e-selectall') || closest(trgtElem, '.e-toolbar-item.e-active')) {\n                    if (this.isAltEnter) {\n                        var editText = this.parent.element.querySelector('.e-spreadsheet-edit').textContent;\n                        if (editText && editText.indexOf('\\n') > -1) {\n                            this.isAltEnter = false;\n                            wrapText(this.parent.getActiveSheet().selectedRange, true, this.parent);\n                            this.refreshEditor(this.editorElem.textContent, this.isCellEdit);\n                        }\n                    }\n                    if (!isFormula) {\n                        this.endEdit(false, e);\n                    }\n                    else {\n                        var curPos = window.getSelection().focusOffset;\n                        var actCellIdx = getCellIndexes(sheet.activeCell);\n                        var cell = getCell(actCellIdx[0], actCellIdx[1], sheet);\n                        if (this.editCellData.value === this.editorElem.textContent && (this.editorElem.textContent.indexOf('(') !==\n                            this.editorElem.textContent.length - 1 && this.editorElem.textContent.indexOf('(') !== -1)) {\n                            if (this.editCellData.sheetIndex !== sheet.id - 1) {\n                                var elem = this.parent.element.querySelector('.e-formula-bar');\n                                if (this.editorElem.textContent.substring(elem.selectionEnd - 1, elem.selectionEnd) !== ',' &&\n                                    !e.shiftKey) {\n                                    if (formulaRefIndicator) {\n                                        formulaRefIndicator.parentElement.removeChild(formulaRefIndicator);\n                                    }\n                                    this.parent.goTo(this.editCellData.fullAddr);\n                                    this.endEdit(false, e);\n                                    return;\n                                }\n                            }\n                            else {\n                                if (this.validCharacters.indexOf(this.editorElem.textContent.substring(curPos - 1, curPos)) === -1) {\n                                    if (formulaRefIndicator) {\n                                        formulaRefIndicator.parentElement.removeChild(formulaRefIndicator);\n                                    }\n                                    this.endEdit(false, e);\n                                    return;\n                                }\n                            }\n                        }\n                        if (!cell) {\n                            return;\n                        }\n                        isFormula = cell.formula ?\n                            checkIsFormula(getCell(actCellIdx[0], actCellIdx[1], sheet).formula) ||\n                                (this.editCellData.value && this.editCellData.value.toString().indexOf('=') === 0) : false;\n                        if (isFormula) {\n                            var curPos_1 = window.getSelection().focusOffset;\n                            if (this.editCellData.value.length === curPos_1) {\n                                if (this.editCellData.value.substring(this.editCellData.value.length - 1) === ')' ||\n                                    isNumber(this.editCellData.value.substring(this.editCellData.value.length - 1))) {\n                                    if (formulaRefIndicator) {\n                                        formulaRefIndicator.parentElement.removeChild(formulaRefIndicator);\n                                    }\n                                    this.endEdit(false, e);\n                                }\n                            }\n                            else if (this.editCellData.value === this.editorElem.textContent) {\n                                if ((this.editCellData.value + sheet.selectedRange).substring(curPos_1 - 1, curPos_1) !== ',') {\n                                    if (formulaRefIndicator) {\n                                        formulaRefIndicator.parentElement.removeChild(formulaRefIndicator);\n                                    }\n                                    this.endEdit(false, e);\n                                }\n                                else if (this.editCellData.value.substring(curPos_1) !== ')') {\n                                    if (formulaRefIndicator) {\n                                        formulaRefIndicator.parentElement.removeChild(formulaRefIndicator);\n                                    }\n                                    this.endEdit(false, e);\n                                }\n                            }\n                        }\n                    }\n                }\n                else {\n                    if (isFormula && this.editCellData.value === this.editorElem.textContent && this.editorElem.textContent.indexOf('(') !==\n                        this.editorElem.textContent.length - 1) {\n                        if (this.editCellData.sheetIndex === sheet.id - 1) {\n                            var curPos = window.getSelection().focusOffset;\n                            if (this.validCharacters.indexOf(this.editorElem.textContent.substring(curPos - 1, curPos)) === -1) {\n                                if (formulaRefIndicator) {\n                                    formulaRefIndicator.parentElement.removeChild(formulaRefIndicator);\n                                }\n                                this.parent.goTo(this.editCellData.fullAddr);\n                                this.endEdit(false, e);\n                                return;\n                            }\n                        }\n                    }\n                }\n            }\n        }\n    };\n    Edit.prototype.dblClickHandler = function (e) {\n        var trgtElem = e.target;\n        var sheet = this.parent.getActiveSheet();\n        var actCell = getCellIndexes(sheet.activeCell);\n        var cell = getCell(actCell[0], actCell[1], sheet) || {};\n        if (closest(trgtElem, '.e-datavisualization-chart')) {\n            return;\n        }\n        if (!sheet.isProtected || !isLocked(cell, getColumn(sheet, actCell[1]))) {\n            if ((trgtElem.className.indexOf('e-ss-overlay') < 0) &&\n                (trgtElem.classList.contains('e-active-cell') || trgtElem.classList.contains('e-cell')\n                    || closest(trgtElem, '.e-sheet-content'))) {\n                if (this.isEdit) {\n                    if (checkIsFormula(this.editCellData.value)) {\n                        var sheetName = this.editCellData.fullAddr.substring(0, this.editCellData.fullAddr.indexOf('!'));\n                        if (this.parent.getActiveSheet().name === sheetName) {\n                            this.endEdit();\n                        }\n                    }\n                    else {\n                        this.endEdit();\n                    }\n                }\n                else {\n                    this.isNewValueEdit = false;\n                    this.startEdit();\n                }\n            }\n        }\n        else {\n            if (trgtElem.classList.contains('e-active-cell') || trgtElem.classList.contains('e-cell')) {\n                this.parent.notify(editAlert, null);\n            }\n        }\n    };\n    Edit.prototype.updateEditCellDetail = function (addr, value) {\n        var sheetIdx;\n        var sheet;\n        if (!this.editCellData.sheetIndex) {\n            if (addr && addr.split('!').length > 1) {\n                sheetIdx = getSheetIndex(this.parent, getSheetNameFromAddress(addr));\n            }\n            else {\n                sheetIdx = this.parent.activeSheetIndex;\n            }\n        }\n        if (!this.editCellData.addr) {\n            sheet = getSheet(this.parent, sheetIdx);\n            if (addr) {\n                addr = getRangeFromAddress(addr);\n            }\n            else {\n                addr = sheet.activeCell;\n            }\n        }\n        else if (checkIsFormula(this.editCellData.value)) {\n            sheet = getSheet(this.parent, sheetIdx);\n            this.isNewValueEdit = false;\n        }\n        if (addr) {\n            var range = getRangeIndexes(addr);\n            var rowIdx = range[0];\n            var colIdx = range[1];\n            var cellElem = this.parent.getCell(rowIdx, colIdx);\n            var cellPosition = getCellPosition(sheet, range);\n            this.editCellData = {\n                addr: addr,\n                fullAddr: getSheetName(this.parent, sheetIdx) + '!' + addr,\n                rowIndex: rowIdx,\n                colIndex: colIdx,\n                sheetIndex: sheetIdx,\n                element: cellElem,\n                value: value || '',\n                position: cellPosition\n            };\n        }\n    };\n    Edit.prototype.initiateEditor = function (refreshCurPos) {\n        var _this = this;\n        var data = this.parent.getData(this.editCellData.fullAddr);\n        data.then(function (values) {\n            values.forEach(function (cell, key) {\n                var args = { cell: cell, value: cell ? cell.value : '' };\n                _this.parent.notify(getFormattedBarText, args);\n                var value = cell ? args.value : '';\n                if (cell && cell.formula) {\n                    value = cell.formula;\n                }\n                _this.editCellData.oldValue = value;\n                if (_this.editCellData.value) {\n                    value = _this.editCellData.value;\n                }\n                else {\n                    _this.editCellData.value = value;\n                }\n                if (_this.isNewValueEdit) {\n                    value = '';\n                }\n                else {\n                    _this.isNewValueEdit = true;\n                }\n                if (!isUndefined(value)) {\n                    _this.refreshEditor(value, false, true, false, false);\n                }\n                if (refreshCurPos) {\n                    _this.setCursorPosition();\n                }\n                if (_this.triggerEvent('cellEdit')) {\n                    _this.cancelEdit(true, false);\n                }\n            });\n        });\n    };\n    Edit.prototype.positionEditor = function (isWrap) {\n        var tdElem = this.editCellData.element;\n        var isEdit = false;\n        var cellEle;\n        var arg = { isEdit: isEdit };\n        this.parent.notify(isFormulaBarEdit, arg);\n        if (arg.isEdit && isNullOrUndefined(tdElem)) {\n            cellEle = this.parent.getCell(this.editCellData.rowIndex, this.editCellData.colIndex);\n            tdElem = cellEle;\n            this.editCellData.element = cellEle;\n        }\n        if (tdElem) {\n            tdElem.classList.add('e-ss-edited');\n            var cell = getCell(this.editCellData.rowIndex, this.editCellData.colIndex, this.parent.getActiveSheet());\n            var left = this.editCellData.position.left + 1;\n            var top_1 = this.editCellData.position.top + 1;\n            var minHeight = this.parent.getCell(this.editCellData.rowIndex, this.editCellData.colIndex).offsetHeight - 3;\n            var minWidth = this.editCellData.element.offsetWidth - 3;\n            var mainContElement = this.parent.getMainContent();\n            var editWidth = mainContElement.offsetWidth - left - 28;\n            var height = ((cell && cell.wrap) || (tdElem && isWrap)) ? 'height:auto' : (minHeight) + 'px;';\n            // let editHeight: number = mainContElement.offsetHeight - top - 28;\n            var inlineStyles = 'display:block;top:' + top_1 + 'px;' + (this.parent.enableRtl ? 'right:' : 'left:') + left + 'px;' +\n                'min-width:' + minWidth + 'px;max-width:' + editWidth + 'px;' + 'height:' + height +\n                ((cell && cell.wrap) ? ('width:' + minWidth + 'px;') : '') + 'min-height:' + minHeight + 'px;';\n            inlineStyles += tdElem.style.cssText;\n            this.editorElem.setAttribute('style', inlineStyles);\n            this.parent.element.querySelector('.e-active-cell').style.height =\n                (this.editCellData.element.offsetHeight + 1) + 'px'; // we using edit div height as auto , while editing div enlarges and \n            // hide active cell bottom border for that we increasing 1px height to active cell.\n            if (tdElem.classList.contains('e-right-align')) {\n                this.editorElem.classList.add('e-right-align');\n            }\n            else if (tdElem.classList.contains('e-center-align')) {\n                this.editorElem.classList.add('e-center-align');\n            }\n        }\n    };\n    Edit.prototype.updateEditedValue = function (tdRefresh) {\n        if (tdRefresh === void 0) { tdRefresh = true; }\n        var oldCellValue = this.editCellData.oldValue;\n        var oldValue = oldCellValue ? oldCellValue.toString().toUpperCase() : '';\n        var isValidate = true;\n        var address = this.editCellData.addr;\n        var cellIndex = getRangeIndexes(this.parent.getActiveSheet().activeCell);\n        var sheet = this.parent.getActiveSheet();\n        var cell = getCell(cellIndex[0], cellIndex[1], sheet);\n        /* To set the before cell details for undo redo. */\n        this.parent.notify(setActionData, { args: { action: 'beforeCellSave', eventArgs: { address: this.editCellData.addr } } });\n        if (this.parent.allowDataValidation && cell && cell.validation) {\n            var value = this.parent.element.getElementsByClassName('e-spreadsheet-edit')[0].innerText;\n            var isCell = true;\n            var sheetIdx = this.parent.activeSheetIndex;\n            var range = void 0;\n            if (typeof address === 'string') {\n                range = getRangeIndexes(address);\n            }\n            else {\n                range = address;\n            }\n            this.parent.notify(isValidation, { value: value, range: range, sheetIdx: sheetIdx, isCell: isCell });\n            isValidate = this.parent.allowDataValidation;\n            this.editCellData.value = isValidate ? value : this.editCellData.value;\n            this.parent.allowDataValidation = true;\n        }\n        if ((oldCellValue !== this.editCellData.value || oldValue.indexOf('=RAND()') > -1 || oldValue.indexOf('RAND()') > -1 ||\n            oldValue.indexOf('=RANDBETWEEN(') > -1 || oldValue.indexOf('RANDBETWEEN(') > -1) && isValidate) {\n            var sheet_1 = this.parent.getActiveSheet();\n            var cellIndex_1 = getRangeIndexes(sheet_1.activeCell);\n            this.parent.notify(workbookEditOperation, { action: 'updateCellValue', address: this.editCellData.addr, value: this.editCellData.value });\n            var cell_1 = getCell(cellIndex_1[0], cellIndex_1[1], sheet_1, true);\n            var eventArgs = this.getRefreshNodeArgs(cell_1);\n            this.editCellData.value = eventArgs.value;\n            if (cell_1 && cell_1.formula) {\n                this.editCellData.formula = cell_1.formula;\n            }\n            if (cell_1.wrap) {\n                this.parent.notify(wrapEvent, { range: cellIndex_1, wrap: true, sheet: sheet_1 });\n            }\n            if (tdRefresh) {\n                this.parent.refreshNode(this.editCellData.element, eventArgs);\n            }\n        }\n        if (this.parent.allowConditionalFormat) {\n            this.parent.notify(checkConditionalFormat, { rowIdx: cellIndex[0], colIdx: cellIndex[1], cell: cell });\n        }\n        return isValidate;\n    };\n    Edit.prototype.refreshDependentCellValue = function (rowIdx, colIdx, sheetIdx) {\n        if (rowIdx && colIdx) {\n            rowIdx--;\n            colIdx--;\n            if ((this.editCellData.rowIndex !== rowIdx || this.editCellData.colIndex !== colIdx)\n                && this.parent.activeSheetIndex === sheetIdx) {\n                var td = this.parent.getCell(rowIdx, colIdx);\n                if (td) {\n                    var sheet = getSheet(this.parent, sheetIdx);\n                    var cell = getCell(rowIdx, colIdx, sheet);\n                    var eventArgs = this.getRefreshNodeArgs(cell);\n                    this.parent.refreshNode(td, eventArgs);\n                }\n            }\n        }\n    };\n    Edit.prototype.getRefreshNodeArgs = function (cell) {\n        cell = cell ? cell : {};\n        var fCode = (cell && cell.format) ? cell.format : '';\n        var eventArgs = {\n            value: cell.value, format: fCode, onLoad: true,\n            formattedText: '', isRightAlign: false, type: 'General'\n        };\n        var args;\n        this.parent.notify(getFormattedCellObject, eventArgs);\n        eventArgs.formattedText = this.parent.allowNumberFormatting ? eventArgs.formattedText : eventArgs.value;\n        args = {\n            isRightAlign: eventArgs.isRightAlign,\n            result: eventArgs.formattedText,\n            type: eventArgs.type,\n            value: eventArgs.value,\n            curSymbol: eventArgs.curSymbol\n        };\n        return args;\n    };\n    Edit.prototype.endEdit = function (refreshFormulaBar, event) {\n        if (refreshFormulaBar === void 0) { refreshFormulaBar = false; }\n        var sheet = this.parent.getActiveSheet();\n        var actCell = getCellIndexes(sheet.activeCell);\n        var cell = this.parent.getCell(actCell[0], actCell[1]);\n        var fSize = '';\n        if (this.editCellData.element.children[0] && this.editCellData.element.children[0].className === 'e-cf-databar') {\n            fSize = cell.children[0].querySelector('.e-databar-value').style.fontSize;\n        }\n        if (refreshFormulaBar) {\n            this.refreshEditor(this.editCellData.oldValue, false, true, false, false);\n        }\n        if (this.triggerEvent('beforeCellSave')) {\n            event.preventDefault();\n            return;\n        }\n        var isValidate = this.updateEditedValue();\n        if (isValidate) {\n            this.triggerEvent('cellSave', event);\n            this.resetEditState();\n            this.focusElement();\n        }\n        else if (event) {\n            event.preventDefault();\n        }\n        if (fSize !== '') {\n            cell.children[0].querySelector('.e-databar-value').style.fontSize = fSize;\n        }\n        if (this.parent.showSheetTabs) {\n            this.parent.element.querySelector('.e-add-sheet-tab').removeAttribute('disabled');\n        }\n    };\n    Edit.prototype.cancelEdit = function (refreshFormulaBar, trigEvent, event) {\n        if (refreshFormulaBar === void 0) { refreshFormulaBar = true; }\n        if (trigEvent === void 0) { trigEvent = true; }\n        this.refreshEditor(this.editCellData.oldValue, refreshFormulaBar, false, false, false);\n        if (trigEvent) {\n            this.triggerEvent('cellSave', event);\n        }\n        this.resetEditState();\n        this.focusElement();\n    };\n    Edit.prototype.focusElement = function () {\n        this.parent.element.focus();\n        this.parent.notify(enableToolbarItems, [{ enable: true }]);\n    };\n    Edit.prototype.triggerEvent = function (eventName, event) {\n        var cell = getCell(this.editCellData.rowIndex, this.editCellData.colIndex, this.parent.getActiveSheet());\n        var eventArgs = {\n            element: this.editCellData.element,\n            value: this.editCellData.value,\n            oldValue: this.editCellData.oldValue,\n            address: this.editCellData.fullAddr,\n            displayText: this.parent.getDisplayText(cell)\n        };\n        if (eventName === 'cellSave') {\n            if (this.editCellData.formula) {\n                eventArgs.formula = this.editCellData.formula;\n            }\n            eventArgs.originalEvent = event;\n            this.parent.notify(dataChanged, eventArgs);\n            this.parent.notify(completeAction, { eventArgs: eventArgs, action: 'cellSave' });\n        }\n        if (eventName !== 'cellSave') {\n            eventArgs.cancel = false;\n        }\n        this.parent.trigger(eventName, eventArgs);\n        return eventArgs.cancel;\n    };\n    Edit.prototype.altEnter = function () {\n        this.positionEditor(true);\n        var text;\n        var textBefore;\n        var textAfter;\n        var selection = window.getSelection();\n        var node = selection.anchorNode;\n        var offset;\n        var range = document.createRange();\n        offset = (node.nodeType === 3) ? selection.anchorOffset : node.textContent.length;\n        if (offset === 0 && node.textContent.length > 0) {\n            offset = node.textContent.length;\n        }\n        text = node.textContent;\n        textBefore = text.slice(0, offset);\n        textAfter = text.slice(offset) || ' ';\n        node.textContent = textBefore + '\\n' + textAfter;\n        range = document.createRange();\n        if (node.nodeType === 3) {\n            range.setStart(node, offset + 1);\n            range.setEnd(node, offset + 1);\n        }\n        else if (node.nodeType === 1) {\n            range.setStart(node.firstChild, offset + 1);\n            range.setEnd(node.firstChild, offset + 1);\n        }\n        selection.removeAllRanges();\n        selection.addRange(range);\n    };\n    Edit.prototype.resetEditState = function (elemRefresh) {\n        if (elemRefresh === void 0) { elemRefresh = true; }\n        if (elemRefresh) {\n            if (checkIsFormula(this.editorElem.textContent)) {\n                this.parent.notify(clearCellRef, null);\n            }\n            if (this.editCellData.element) {\n                this.editCellData.element.classList.remove('e-ss-edited');\n                this.editorElem.textContent = '';\n                this.editorElem.removeAttribute('style');\n                this.editorElem.classList.remove('e-right-align');\n            }\n        }\n        this.editCellData = {};\n        this.parent.isEdit = this.isEdit = false;\n        this.isCellEdit = true;\n        this.parent.notify(formulaOperation, { action: 'endEdit' });\n    };\n    Edit.prototype.refSelectionRender = function () {\n        if (this.editorElem) {\n            if (checkIsFormula(this.editorElem.textContent)) {\n                this.parent.notify(initiateFormulaReference, {\n                    range: this.editorElem.textContent, formulaSheetIdx: this.editCellData.sheetIndex\n                });\n            }\n        }\n    };\n    // Start edit the formula cell and set cursor position\n    Edit.prototype.initiateRefSelection = function () {\n        var sheetName = this.editCellData.fullAddr.substring(0, this.editCellData.fullAddr.indexOf('!'));\n        var value = this.parent.element.querySelector('.e-formula-bar').value;\n        if (this.parent.getActiveSheet().name === sheetName && checkIsFormula(this.editCellData.value)) {\n            this.startEdit(this.editCellData.addr, value, false);\n            this.parent.notify(initiateFormulaReference, {\n                range: this.editCellData.value, formulaSheetIdx: this.editCellData.sheetIndex\n            });\n            this.parent.element.querySelector('.e-spreadsheet-edit').innerHTML = value;\n            this.initiateCurPosition();\n        }\n        else {\n            this.initiateCurPosition();\n        }\n    };\n    Edit.prototype.addressHandler = function (args) {\n        var eventArgs = { action: 'getCurrentEditValue', editedValue: '' };\n        this.parent.notify(editOperation, eventArgs);\n        var address = args.range;\n        var sheetName = this.editCellData.fullAddr.substring(0, this.editCellData.fullAddr.indexOf('!'));\n        var sheetIdx = this.editCellData.sheetIndex;\n        var editorEle = this.parent.element.querySelector('.e-spreadsheet-edit');\n        if (this.parent.getActiveSheet().name !== sheetName) {\n            address = '\\'' + this.parent.getActiveSheet().name + '\\'' + '!' + address;\n        }\n        if (args.isSelect) {\n            this.parent.notify(initiateFormulaReference, { range: eventArgs.editedValue + address, formulaSheetIdx: sheetIdx });\n        }\n        else {\n            var editedValue = eventArgs.editedValue;\n            if (editedValue.indexOf(')') === editedValue.length - 1) {\n                editorEle.textContent = editedValue.substring(0, editedValue.length - 1)\n                    + address + editedValue.substring(editedValue.length - 1);\n            }\n            else {\n                editorEle.textContent = editedValue + address;\n            }\n        }\n    };\n    Edit.prototype.updateFormulaBarValue = function () {\n        var value = this.editCellData.value;\n        var address = this.parent.getActiveSheet().selectedRange;\n        address = isSingleCell(getIndexesFromAddress(address)) ? address.split(':')[0] : address;\n        var formulaBar = this.parent.element.querySelector('.e-formula-bar');\n        if (value && checkIsFormula(value)) {\n            var sheetName = this.editCellData.fullAddr.substring(0, this.editCellData.fullAddr.indexOf('!'));\n            if (this.parent.getActiveSheet().name !== sheetName) {\n                address = '\\'' + this.parent.getActiveSheet().name + '\\'' + '!' + address;\n            }\n            if (value.indexOf(')') === value.length - 1) {\n                formulaBar.value = value.substring(0, value.length - 1) + address + value.substring(value.length - 1);\n            }\n            else {\n                formulaBar.value = value + address;\n            }\n        }\n    };\n    Edit.prototype.setFormulaBarCurPosition = function (input, selectionStart, selectionEnd) {\n        if (input.setSelectionRange) {\n            input.focus();\n            input.selectionStart = selectionStart;\n            input.selectionEnd = selectionStart;\n            input.setSelectionRange(selectionStart, selectionEnd);\n        }\n    };\n    Edit.prototype.initiateCurPosition = function () {\n        var el = this.parent.element.querySelector('.e-spreadsheet-edit');\n        if (el.innerText) {\n            var range = document.createRange();\n            if (el.innerText.indexOf(')') === el.innerText.length - 1) {\n                range.setStart(el.childNodes[0], el.innerText.length - 1);\n                range.setEnd(el.childNodes[0], el.innerText.length - 1);\n            }\n            else {\n                range.setStart(el.childNodes[0], el.innerText.length);\n                range.setEnd(el.childNodes[0], el.innerText.length);\n            }\n            var selection = window.getSelection();\n            selection.removeAllRanges();\n            selection.addRange(range);\n        }\n        var sheetIdx = this.editCellData.sheetIndex;\n        if (sheetIdx !== this.parent.getActiveSheet().id - 1) {\n            var elem = this.parent.element.querySelector('.e-formula-bar');\n            if (elem.value) {\n                var valueLength = elem.value.length;\n                if (elem.value.indexOf(')') === valueLength - 1) {\n                    this.setFormulaBarCurPosition(elem, valueLength - 1, valueLength - 1);\n                }\n                else {\n                    this.setFormulaBarCurPosition(elem, valueLength, valueLength);\n                }\n            }\n        }\n    };\n    return Edit;\n}());\nexport { Edit };\n","import { contentLoaded, mouseDown, virtualContentLoaded, cellNavigate, getUpdateUsingRaf, focusBorder } from '../common/index';\nimport { showAggregate, refreshImgElem, getRowIdxFromClientY, getColIdxFromClientX, clearChartBorder } from '../common/index';\nimport { getColumnsWidth, updateSelectedRange, getColumnWidth, mergedRange, activeCellMergedRange } from '../../workbook/index';\nimport { getRowHeight, isSingleCell, activeCellChanged, checkIsFormula, getSheetIndex } from '../../workbook/index';\nimport { EventHandler, addClass, removeClass, isNullOrUndefined, Browser, closest } from '@syncfusion/ej2-base';\nimport { selectionComplete, getMoveEvent, getEndEvent, isTouchStart, locateElem } from '../common/index';\nimport { isTouchEnd, isTouchMove, getClientX, getClientY, mouseUpAfterSelection, selectRange, rowHeightChanged } from '../common/index';\nimport { colWidthChanged, protectSelection, editOperation, initiateFormulaReference, initiateCur, clearCellRef } from '../common/index';\nimport { getRangeIndexes, getCellAddress, getRangeAddress, getCellIndexes, getSwapRange } from '../../workbook/common/address';\nimport { addressHandle } from '../common/index';\nimport { isCellReference } from '../../workbook/index';\nimport { getIndexesFromAddress } from '../../workbook/common/address';\n/**\n * Represents selection support for Spreadsheet.\n */\nvar Selection = /** @class */ (function () {\n    /**\n     * Constructor for the Spreadsheet selection module.\n     * @private\n     */\n    function Selection(parent) {\n        this.uniqueOBracket = String.fromCharCode(129);\n        this.uniqueCBracket = String.fromCharCode(130);\n        this.uniqueCSeparator = String.fromCharCode(131);\n        this.uniqueCOperator = String.fromCharCode(132);\n        this.uniquePOperator = String.fromCharCode(133);\n        this.uniqueSOperator = String.fromCharCode(134);\n        this.uniqueMOperator = String.fromCharCode(135);\n        this.uniqueDOperator = String.fromCharCode(136);\n        this.uniqueModOperator = String.fromCharCode(137);\n        this.uniqueConcateOperator = String.fromCharCode(138);\n        this.uniqueEqualOperator = String.fromCharCode(139);\n        this.uniqueExpOperator = String.fromCharCode(140);\n        this.uniqueGTOperator = String.fromCharCode(141);\n        this.uniqueLTOperator = String.fromCharCode(142);\n        this.invalidOperators = ['%'];\n        this.formulaRange = [];\n        this.tableRangesFormula = {};\n        this.parent = parent;\n        this.addEventListener();\n        this.mouseMoveEvt = this.mouseMoveHandler.bind(this);\n    }\n    Selection.prototype.addEventListener = function () {\n        this.parent.on(contentLoaded, this.init, this);\n        this.parent.on(mouseDown, this.mouseDownHandler, this);\n        this.parent.on(virtualContentLoaded, this.virtualContentLoadedHandler, this);\n        this.parent.on(cellNavigate, this.cellNavigateHandler, this);\n        this.parent.on(selectRange, this.selectRange, this);\n        this.parent.on(rowHeightChanged, this.rowHeightChanged, this);\n        this.parent.on(colWidthChanged, this.colWidthChanged, this);\n        this.parent.on(protectSelection, this.protectHandler, this);\n        this.parent.on(initiateFormulaReference, this.initiateFormulaSelection, this);\n        this.parent.on(clearCellRef, this.clearBorder, this);\n        this.parent.on(getRowIdxFromClientY, this.getRowIdxFromClientY, this);\n        this.parent.on(getColIdxFromClientX, this.getColIdxFromClientX, this);\n        this.parent.on(focusBorder, this.chartBorderHandler, this);\n    };\n    Selection.prototype.removeEventListener = function () {\n        if (!this.parent.isDestroyed) {\n            this.parent.off(contentLoaded, this.init);\n            this.parent.off(mouseDown, this.mouseDownHandler);\n            this.parent.off(virtualContentLoaded, this.virtualContentLoadedHandler);\n            this.parent.off(cellNavigate, this.cellNavigateHandler);\n            this.parent.off(selectRange, this.selectRange);\n            this.parent.off(rowHeightChanged, this.rowHeightChanged);\n            this.parent.off(colWidthChanged, this.colWidthChanged);\n            this.parent.off(protectSelection, this.protectHandler);\n            this.parent.off(initiateFormulaReference, this.initiateFormulaSelection);\n            this.parent.off(clearCellRef, this.clearBorder);\n            this.parent.off(getRowIdxFromClientY, this.getRowIdxFromClientY);\n            this.parent.off(getColIdxFromClientX, this.getColIdxFromClientX);\n            this.parent.off(focusBorder, this.chartBorderHandler);\n        }\n    };\n    Selection.prototype.rowHeightChanged = function (args) {\n        var _this = this;\n        getUpdateUsingRaf(function () {\n            var ele = _this.getActiveCell();\n            var cellIndex = getCellIndexes(_this.parent.getActiveSheet().activeCell)[0];\n            if (cellIndex === args.rowIdx && ele) {\n                ele.style.height = parseInt(ele.style.height, 10) + args.threshold + \"px\";\n            }\n            else if (cellIndex > args.rowIdx && ele) {\n                ele.style.top = parseInt(ele.style.top, 10) + args.threshold + \"px\";\n            }\n            ele = _this.getSelectionElement();\n            if (ele) {\n                var selectedRange = getRangeIndexes(_this.parent.getActiveSheet().selectedRange);\n                var sRange = getSwapRange(selectedRange);\n                var rowStart = sRange[0];\n                var rowEnd = sRange[2];\n                if (rowStart <= args.rowIdx && rowEnd >= args.rowIdx && ele) {\n                    ele.style.height = parseInt(ele.style.height, 10) + args.threshold + \"px\";\n                }\n                else if (rowStart > args.rowIdx && ele) {\n                    ele.style.top = parseInt(ele.style.top, 10) + args.threshold + \"px\";\n                }\n            }\n        });\n    };\n    Selection.prototype.colWidthChanged = function (args) {\n        var _this = this;\n        getUpdateUsingRaf(function () {\n            var ele = _this.getActiveCell();\n            var cellIndex = getCellIndexes(_this.parent.getActiveSheet().activeCell)[1];\n            if (cellIndex === args.colIdx && ele) {\n                ele.style.width = parseInt(ele.style.width, 10) + args.threshold + \"px\";\n            }\n            else if (cellIndex > args.colIdx && ele) {\n                ele.style.left = parseInt(ele.style.left, 10) + args.threshold + \"px\";\n            }\n            ele = _this.getSelectionElement();\n            var selectedRange = getRangeIndexes(_this.parent.getActiveSheet().selectedRange);\n            var sRange = getSwapRange(selectedRange);\n            var colStart = sRange[1];\n            var colEnd = sRange[3];\n            if (colStart <= args.colIdx && colEnd >= args.colIdx && ele) {\n                ele.style.width = parseInt(ele.style.width, 10) + args.threshold + \"px\";\n            }\n            else if (colStart > args.colIdx && ele) {\n                ele.style.left = parseInt(ele.style.left, 10) + args.threshold + \"px\";\n            }\n        });\n    };\n    Selection.prototype.selectRange = function (args) {\n        this.selectRangeByIdx(this.parent.selectionSettings.mode === 'Single' ? args.indexes.slice(0, 2).concat(args.indexes.slice(0, 2)) : args.indexes, null, null, null, null, args.skipChecking);\n    };\n    Selection.prototype.init = function () {\n        var isInit = true;\n        var sheet = this.parent.getActiveSheet();\n        var range = getRangeIndexes(this.parent.getActiveSheet().selectedRange);\n        var sRange = getSwapRange(range);\n        var actRange = getCellIndexes(this.parent.getActiveSheet().activeCell);\n        var inRange = sRange[0] <= actRange[0] && sRange[2] >= actRange[0] && sRange[1] <= actRange[1]\n            && sRange[3] >= actRange[1];\n        this.createSelectionElement();\n        this.selectRangeByIdx(range, null, null, inRange, isInit);\n    };\n    Selection.prototype.createSelectionElement = function () {\n        var cont = this.parent.getMainContent();\n        var ele = this.parent.createElement('div', { className: 'e-selection' });\n        var activeCell = this.parent.createElement('div', { className: 'e-active-cell' });\n        cont.appendChild(ele);\n        cont.appendChild(activeCell);\n    };\n    Selection.prototype.mouseDownHandler = function (e) {\n        var eventArgs = { action: 'getCurrentEditValue', editedValue: '' };\n        this.parent.notify(editOperation, eventArgs);\n        var isFormulaEdit = (eventArgs.editedValue && eventArgs.editedValue.toString().indexOf('=') === 0) ||\n            checkIsFormula(eventArgs.editedValue);\n        if (!this.parent.isEdit || isFormulaEdit) {\n            var overlayElem = document.getElementById(this.parent.element.id + '_overlay');\n            if (typeof (e.target.className) === 'string') {\n                if (e.target.className.indexOf('e-ss-overlay') > -1) {\n                    return;\n                }\n            }\n            else if (overlayElem) {\n                overlayElem.classList.remove('e-ss-overlay-active');\n            }\n            if (closest(e.target, '.e-datavisualization-chart')) {\n                return;\n            }\n            if (this.parent.getActiveSheet().isProtected && !this.parent.getActiveSheet().protectSettings.selectCells) {\n                return;\n            }\n            if (!closest(e.target, '.e-findtool-dlg')) {\n                if (this.getSheetElement().contains(e.target) && !e.target.classList.contains('e-colresize')\n                    && !e.target.classList.contains('e-rowresize')) {\n                    var sheet = this.parent.getActiveSheet();\n                    var mode = this.parent.selectionSettings.mode;\n                    var rowIdx = this.getRowIdxFromClientY({ clientY: getClientY(e) });\n                    var colIdx = this.getColIdxFromClientX({ clientX: getClientX(e) });\n                    var activeIdx = getCellIndexes(sheet.activeCell);\n                    var isRowSelected = sheet.showHeaders && this.parent.getRowHeaderContent().contains(e.target);\n                    var isColSelected = sheet.showHeaders && this.parent.getColumnHeaderContent().contains(e.target);\n                    if (e.which === 3 && this.isSelected(rowIdx, colIdx)) {\n                        return;\n                    }\n                    if (mode === 'Multiple' && (!isTouchEnd(e) && (!isTouchStart(e) ||\n                        (isTouchStart(e) && activeIdx[0] === rowIdx && activeIdx[1] === colIdx)) || isColSelected || isRowSelected)) {\n                        document.addEventListener(getMoveEvent().split(' ')[0], this.mouseMoveEvt);\n                        if (!Browser.isPointer) {\n                            document.addEventListener(getMoveEvent().split(' ')[1], this.mouseMoveEvt, { passive: false });\n                        }\n                    }\n                    if (!isTouchEnd(e)) {\n                        EventHandler.add(document, getEndEvent(), this.mouseUpHandler, this);\n                    }\n                    if (isTouchStart(e) && !(isColSelected || isRowSelected)) {\n                        this.touchEvt = e;\n                        return;\n                    }\n                    if (isRowSelected) {\n                        this.isRowSelected = true;\n                        if (!e.shiftKey || mode === 'Single') {\n                            this.startCell = [rowIdx, 0];\n                        }\n                        this.selectRangeByIdx([this.startCell[0], 0, rowIdx, sheet.colCount - 1], e);\n                    }\n                    else if (isColSelected) {\n                        this.isColSelected = true;\n                        if (!e.shiftKey || mode === 'Single') {\n                            this.startCell = [0, colIdx];\n                        }\n                        this.selectRangeByIdx([0, this.startCell[1], sheet.rowCount - 1, colIdx], e);\n                    }\n                    else if (e.target.classList.contains('e-selectall')) {\n                        this.startCell = [0, 0];\n                        this.selectRangeByIdx([].concat(this.startCell, [sheet.rowCount - 1, sheet.colCount - 1]), e);\n                    }\n                    else if (!e.target.classList.contains('e-sheet-content')) {\n                        if (!e.shiftKey || mode === 'Single') {\n                            this.startCell = [rowIdx, colIdx];\n                        }\n                        this.selectRangeByIdx([].concat(this.startCell ? this.startCell : getCellIndexes(sheet.activeCell), [rowIdx, colIdx]), e);\n                    }\n                    if (this.parent.isMobileView()) {\n                        this.parent.element.classList.add('e-mobile-focused');\n                        this.parent.renderModule.setSheetPanelSize();\n                    }\n                }\n            }\n        }\n        if (isFormulaEdit && (e.target.classList.contains('e-cell') ||\n            e.target.classList.contains('e-header-cell')) && this.parent.isEdit) {\n            var range = this.parent.getActiveSheet().selectedRange;\n            range = isSingleCell(getIndexesFromAddress(range)) ? range.split(':')[0] : range;\n            this.parent.notify(addressHandle, { range: range, isSelect: false });\n        }\n    };\n    Selection.prototype.mouseMoveHandler = function (e) {\n        var _this = this;\n        var sheet = this.parent.getActiveSheet();\n        if (isTouchMove(e)) {\n            e.preventDefault();\n        }\n        var eventArgs = { action: 'getCurrentEditValue', editedValue: '' };\n        this.parent.notify(editOperation, eventArgs);\n        var isFormulaEdit = checkIsFormula(eventArgs.editedValue) ||\n            (eventArgs.editedValue && eventArgs.editedValue.toString().indexOf('=') === 0);\n        var cont = this.getScrollContent();\n        var clientRect = cont.getBoundingClientRect();\n        var clientX = getClientX(e);\n        var clientY = getClientY(e);\n        // remove math.min or handle top and left auto scroll\n        var colIdx = this.isRowSelected ? sheet.colCount - 1 :\n            this.getColIdxFromClientX({ clientX: Math.min(clientX, clientRect.right) });\n        var rowIdx = this.isColSelected ? sheet.rowCount - 1 :\n            this.getRowIdxFromClientY({ clientY: Math.min(clientY, clientRect.bottom) });\n        var prevIndex = getRangeIndexes(sheet.selectedRange);\n        var mergeArgs = { range: [rowIdx, colIdx, rowIdx, colIdx] };\n        this.parent.notify(activeCellMergedRange, mergeArgs);\n        if (mergeArgs.range[2] === prevIndex[2] && mergeArgs.range[3] === prevIndex[3]) {\n            return;\n        }\n        var isScrollDown = clientY > clientRect.bottom && rowIdx < sheet.rowCount;\n        var isScrollUp = clientY < clientRect.top && rowIdx >= 0 && !this.isColSelected;\n        var isScrollRight = clientX > clientRect.right && colIdx < sheet.colCount;\n        var isScrollLeft = clientX < clientRect.left && colIdx >= 0 && !this.isRowSelected;\n        this.clearInterval();\n        if (!isFormulaEdit && !this.isColSelected && !this.isRowSelected) {\n            prevIndex = getCellIndexes(sheet.activeCell);\n        }\n        if (isScrollDown || isScrollUp || isScrollRight || isScrollLeft) {\n            this.scrollInterval = setInterval(function () {\n                if ((isScrollDown || isScrollUp) && !_this.isColSelected) {\n                    rowIdx = _this.getRowIdxFromClientY({ clientY: isScrollDown ? clientRect.bottom : clientRect.top });\n                    if (rowIdx >= sheet.rowCount) { // clear interval when scroll up\n                        _this.clearInterval();\n                        return;\n                    }\n                    cont.scrollTop += (isScrollDown ? 1 : -1) * getRowHeight(sheet, rowIdx);\n                }\n                if ((isScrollRight || isScrollLeft) && !_this.isRowSelected) {\n                    colIdx = _this.getColIdxFromClientX({ clientX: isScrollRight ? clientRect.right : clientRect.left });\n                    if (colIdx >= sheet.colCount) { // clear interval when scroll left\n                        _this.clearInterval();\n                        return;\n                    }\n                    cont.scrollLeft += (isScrollRight ? 1 : -1) * getColumnWidth(sheet, colIdx);\n                }\n                _this.selectRangeByIdx([].concat(prevIndex[0], prevIndex[1], [rowIdx, colIdx]), e);\n                // tslint:disable-next-line\n            }, 100);\n        }\n        else {\n            this.selectRangeByIdx([].concat(prevIndex[0], prevIndex[1], [rowIdx, colIdx]), e);\n        }\n        if (isFormulaEdit && this.parent.isEdit) {\n            var range = this.parent.getActiveSheet().selectedRange;\n            this.parent.notify(addressHandle, { range: range, isSelect: false });\n        }\n    };\n    Selection.prototype.mouseUpHandler = function (e) {\n        var rowIdx = this.getRowIdxFromClientY({ clientY: getClientY(e) });\n        var colIdx = this.getColIdxFromClientX({ clientX: getClientX(e) });\n        this.clearInterval();\n        if (isTouchEnd(e) && !(this.isColSelected || this.isRowSelected) &&\n            (this.getRowIdxFromClientY({ clientY: getClientY(this.touchEvt) }) === rowIdx &&\n                this.getColIdxFromClientX({ clientX: getClientX(this.touchEvt) }) === colIdx)) {\n            this.mouseDownHandler(e);\n        }\n        this.parent.trigger('select', { range: this.parent.getActiveSheet().selectedRange });\n        document.removeEventListener(getMoveEvent().split(' ')[0], this.mouseMoveEvt);\n        if (!Browser.isPointer) {\n            document.removeEventListener(getMoveEvent().split(' ')[1], this.mouseMoveEvt);\n        }\n        EventHandler.remove(document, getEndEvent(), this.mouseUpHandler);\n        this.parent.notify(mouseUpAfterSelection, e);\n        var eventArgs = { action: 'getCurrentEditValue', editedValue: '' };\n        this.parent.notify(editOperation, eventArgs);\n        var isFormulaEdit = checkIsFormula(eventArgs.editedValue) ||\n            (eventArgs.editedValue && eventArgs.editedValue.toString().indexOf('=') === 0);\n        if (isFormulaEdit && this.parent.isEdit && !e.target.classList.contains('e-spreadsheet-edit')) {\n            this.parent.notify(initiateCur, {});\n        }\n    };\n    Selection.prototype.isSelected = function (rowIdx, colIdx) {\n        var indexes = getSwapRange(getRangeIndexes(this.parent.getActiveSheet().selectedRange));\n        return indexes[0] <= rowIdx && rowIdx <= indexes[2] && indexes[1] <= colIdx && colIdx <= indexes[3];\n    };\n    Selection.prototype.virtualContentLoadedHandler = function () {\n        var sheet = this.parent.getActiveSheet();\n        var indexes = getRangeIndexes(sheet.selectedRange);\n        if (this.isColSelected && this.isRowSelected) {\n            this.selectRangeByIdx([0, 0, sheet.rowCount - 1, sheet.colCount - 1], null, true);\n        }\n        else if (this.isColSelected) {\n            this.selectRangeByIdx([0, indexes[1], sheet.rowCount - 1, indexes[3]], null, true);\n        }\n        else if (this.isRowSelected) {\n            this.selectRangeByIdx([indexes[0], 0, indexes[2], sheet.colCount - 1], null, true);\n        }\n        else {\n            this.highlightHdr(indexes, indexes[0] >= this.parent.viewport.topIndex || indexes[2] >= this.parent.viewport.topIndex, indexes[1] >= this.parent.viewport.leftIndex || indexes[3] >= this.parent.viewport.leftIndex);\n        }\n    };\n    Selection.prototype.clearInterval = function () {\n        clearInterval(this.scrollInterval);\n        this.scrollInterval = null;\n    };\n    Selection.prototype.getScrollContent = function () {\n        return this.parent.getMainContent();\n    };\n    Selection.prototype.getScrollLeft = function () {\n        return this.parent.scrollModule ? this.parent.scrollModule.prevScroll.scrollLeft : 0;\n    };\n    Selection.prototype.cellNavigateHandler = function (args) {\n        var sheet = this.parent.getActiveSheet();\n        if (sheet.isProtected && !sheet.protectSettings.selectCells) {\n            return;\n        }\n        this.selectRangeByIdx(args.range.concat(args.range));\n    };\n    Selection.prototype.getColIdxFromClientX = function (args) {\n        var width = 0;\n        var sheet = this.parent.getActiveSheet();\n        var cliRect = this.parent.getMainContent().getBoundingClientRect();\n        var left = 0;\n        left = (args.isImage) ? args.clientX : (this.parent.enableRtl ? (cliRect.right - args.clientX) :\n            (args.clientX - cliRect.left)) + this.getScrollLeft();\n        for (var i = 0;; i++) {\n            width += getColumnsWidth(sheet, i);\n            if (left < width) {\n                args.clientX = i;\n                return i;\n            }\n        }\n    };\n    Selection.prototype.getRowIdxFromClientY = function (args) {\n        var height = 0;\n        var sheet = this.parent.getActiveSheet();\n        var top = 0;\n        top = args.isImage ? args.clientY : (args.clientY - this.parent.getMainContent().getBoundingClientRect().top)\n            + this.parent.getMainContent().scrollTop;\n        for (var i = 0;; i++) {\n            height += getRowHeight(sheet, i);\n            if (top < height) {\n                args.clientY = i;\n                return i;\n            }\n        }\n    };\n    Selection.prototype.initFormulaReferenceIndicator = function (range) {\n        if (this.parent.isEdit) {\n            var forRefIndicator = this.parent.createElement('div', { className: 'e-formularef-indicator' });\n            forRefIndicator.appendChild(this.parent.createElement('div', { className: 'e-top' }));\n            forRefIndicator.appendChild(this.parent.createElement('div', { className: 'e-bottom' }));\n            forRefIndicator.appendChild(this.parent.createElement('div', { className: 'e-left' }));\n            forRefIndicator.appendChild(this.parent.createElement('div', { className: 'e-right' }));\n            locateElem(forRefIndicator, range, this.parent.getActiveSheet(), false);\n            this.parent.getMainContent().appendChild(forRefIndicator);\n        }\n    };\n    Selection.prototype.selectRangeByIdx = function (range, e, isScrollRefresh, isActCellChanged, isInit, skipChecking) {\n        var eventArgs = { action: 'getCurrentEditValue', editedValue: '' };\n        this.parent.notify(editOperation, eventArgs);\n        var isFormulaEdit = checkIsFormula(eventArgs.editedValue) ||\n            (eventArgs.editedValue && eventArgs.editedValue.toString().indexOf('=') === 0);\n        var ele = this.getSelectionElement();\n        var sheet = this.parent.getActiveSheet();\n        var formulaRefIndicator = this.parent.element.querySelector('.e-formularef-indicator');\n        var mergeArgs = { range: [].slice.call(range), isActiveCell: false, skipChecking: skipChecking };\n        var isMergeRange;\n        if (!this.isColSelected && !this.isRowSelected) {\n            this.parent.notify(mergedRange, mergeArgs);\n        }\n        if (range !== mergeArgs.range) {\n            isMergeRange = true;\n        }\n        range = mergeArgs.range;\n        var args = { range: getRangeAddress(range), cancel: false };\n        this.parent.trigger('beforeSelect', args);\n        if (args.cancel === true) {\n            return;\n        }\n        if (isFormulaEdit && formulaRefIndicator) {\n            formulaRefIndicator.parentElement.removeChild(formulaRefIndicator);\n        }\n        if (isSingleCell(range) || mergeArgs.isActiveCell) {\n            if (ele) {\n                ele.classList.add('e-hide');\n            }\n            if (isFormulaEdit && e && !e.target.classList.contains('e-spreadsheet-edit') && this.parent.isEdit) {\n                this.parent.notify(addressHandle, { range: getRangeAddress(range).split(':')[0], isSelect: true });\n                this.initFormulaReferenceIndicator(range);\n            }\n        }\n        else {\n            if (isFormulaEdit && this.parent.isEdit) {\n                if (e && !e.target.classList.contains('e-spreadsheet-edit') && this.parent.isEdit) {\n                    this.parent.notify(addressHandle, { range: getRangeAddress(range), isSelect: true });\n                    this.initFormulaReferenceIndicator(range);\n                }\n            }\n            else {\n                if (ele) {\n                    ele.classList.remove('e-hide');\n                }\n                var offset = (this.isColSelected && this.isRowSelected) ? undefined\n                    : this.getOffset(range[2], range[3]);\n                if (isMergeRange && offset) { // Need to handle half hidden merge cell in better way\n                    offset.left = { idx: 0, size: 0 };\n                }\n                locateElem(ele, range, sheet, this.parent.enableRtl);\n            }\n        }\n        var eArgs = { action: 'getCurrentEditSheetIdx', sheetIndex: null };\n        this.parent.notify(editOperation, eArgs);\n        if (!isFormulaEdit) {\n            updateSelectedRange(this.parent, getRangeAddress(range), sheet);\n        }\n        else if (!isInit) {\n            updateSelectedRange(this.parent, getRangeAddress(range), sheet);\n        }\n        this.UpdateRowColSelected(range);\n        this.highlightHdr(range);\n        if (!isScrollRefresh && !(e && (e.type === 'mousemove' || isTouchMove(e)))) {\n            if (!isFormulaEdit) {\n                this.updateActiveCell(isActCellChanged ? getRangeIndexes(sheet.activeCell) : range, isInit);\n            }\n            else if (eArgs.sheetIndex === this.parent.getActiveSheet().id - 1 && isInit) {\n                isActCellChanged = true;\n                this.updateActiveCell(isActCellChanged ? getRangeIndexes(sheet.activeCell) : range, isInit);\n            }\n            else if (!this.parent.isEdit) {\n                this.updateActiveCell(isActCellChanged ? getRangeIndexes(sheet.activeCell) : range, isInit);\n            }\n        }\n        if (isNullOrUndefined(e)) {\n            e = { type: 'mousedown' };\n        }\n        if (!isFormulaEdit) {\n            this.parent.notify(selectionComplete, e);\n        }\n        else if (!isInit) {\n            this.parent.notify(selectionComplete, e);\n        }\n        this.parent.notify(showAggregate, {});\n        this.parent.notify(refreshImgElem, {});\n        this.parent.notify(clearChartBorder, {});\n    };\n    Selection.prototype.UpdateRowColSelected = function (indexes) {\n        var sheet = this.parent.getActiveSheet();\n        this.isRowSelected = (indexes[1] === 0 && indexes[3] === sheet.colCount - 1);\n        this.isColSelected = (indexes[0] === 0 && indexes[2] === sheet.rowCount - 1);\n    };\n    Selection.prototype.updateActiveCell = function (range, isInit) {\n        var sheet = this.parent.getActiveSheet();\n        var topLeftIdx = getRangeIndexes(sheet.topLeftCell);\n        var rowIdx;\n        var colIdx;\n        var cell;\n        var isMergeRange;\n        if (this.isColSelected) {\n            rowIdx = topLeftIdx[0];\n            colIdx = range[1];\n            if (this.isRowSelected) {\n                colIdx = topLeftIdx[1];\n            }\n        }\n        else {\n            rowIdx = range[0];\n            colIdx = range[1];\n            if (this.isRowSelected) {\n                colIdx = topLeftIdx[1];\n            }\n        }\n        var mergeArgs = { range: [rowIdx, colIdx].concat([rowIdx, colIdx]) };\n        this.parent.notify(activeCellMergedRange, mergeArgs);\n        if (range !== mergeArgs.range) {\n            isMergeRange = true;\n        }\n        range = mergeArgs.range;\n        if (sheet.activeCell !== getCellAddress(range[0], range[1]) || isInit) {\n            this.parent.setSheetPropertyOnMute(sheet, 'activeCell', getCellAddress(range[0], range[1]));\n            if (this.getActiveCell()) {\n                var offset = this.getOffset(range[2], range[3]);\n                if (isMergeRange) {\n                    offset.left = { idx: 0, size: 0 };\n                }\n                locateElem(this.getActiveCell(), range, sheet, this.parent.enableRtl);\n            }\n            this.parent.notify(activeCellChanged, null);\n        }\n        else {\n            locateElem(this.getActiveCell(), range, sheet, this.parent.enableRtl);\n        }\n    };\n    Selection.prototype.getOffset = function (rowIdx, colIdx) {\n        var offset = { left: { idx: 0, size: 0 }, top: { idx: 0, size: 0 } };\n        if (this.parent.scrollModule) {\n            if (colIdx >= this.parent.scrollModule.offset.left.idx) {\n                offset.left = this.parent.scrollModule.offset.left;\n            }\n            if (rowIdx >= this.parent.scrollModule.offset.top.idx) {\n                offset.top = this.parent.scrollModule.offset.top;\n            }\n        }\n        return offset;\n    };\n    Selection.prototype.getSelectionElement = function () {\n        return this.parent.element.getElementsByClassName('e-selection')[0];\n    };\n    Selection.prototype.getActiveCell = function () {\n        return this.parent.getMainContent().getElementsByClassName('e-active-cell')[0];\n    };\n    Selection.prototype.getSheetElement = function () {\n        return document.getElementById(this.parent.element.id + '_sheet');\n    };\n    Selection.prototype.highlightHdr = function (range, isRowRefresh, isColRefresh) {\n        if (isRowRefresh === void 0) { isRowRefresh = true; }\n        if (isColRefresh === void 0) { isColRefresh = true; }\n        if (this.parent.getActiveSheet().showHeaders) {\n            var sheet = this.parent.getActiveSheet();\n            var rowHdr = [];\n            var colHdr = [];\n            var swapRange = getSwapRange(range);\n            swapRange = this.getHdrIndexes(swapRange);\n            var selectAll = this.parent.element.getElementsByClassName('e-select-all-cell')[0];\n            removeClass(this.getSheetElement().querySelectorAll('.e-highlight'), 'e-highlight');\n            removeClass(this.getSheetElement().querySelectorAll('.e-prev-highlight'), 'e-prev-highlight');\n            if (selectAll) {\n                removeClass([selectAll], ['e-prev-highlight-right', 'e-prev-highlight-bottom']);\n            }\n            if (isRowRefresh) {\n                rowHdr = [].slice.call(this.parent.getRowHeaderContent().querySelectorAll('td')).slice(swapRange[0], swapRange[2] + 1);\n            }\n            if (isColRefresh) {\n                colHdr = [].slice.call(this.parent.getColumnHeaderContent().querySelectorAll('th')).slice(swapRange[1], swapRange[3] + 1);\n            }\n            if (sheet.isProtected && !sheet.protectSettings.selectCells) {\n                removeClass([].concat(rowHdr, colHdr), 'e-highlight');\n            }\n            else {\n                addClass([].concat(rowHdr, colHdr), 'e-highlight');\n            }\n            if (rowHdr.length && rowHdr[0].parentElement.previousElementSibling) {\n                rowHdr[0].parentElement.previousElementSibling.classList.add('e-prev-highlight');\n            }\n            if (colHdr.length && colHdr[0].previousElementSibling) {\n                colHdr[0].previousElementSibling.classList.add('e-prev-highlight');\n            }\n            if (this.isRowSelected && this.isColSelected) {\n                if (sheet.isProtected && !sheet.protectSettings.selectCells) {\n                    document.getElementById(this.parent.element.id + \"_select_all\").classList.remove('e-highlight');\n                }\n                else {\n                    document.getElementById(this.parent.element.id + \"_select_all\").classList.add('e-highlight');\n                }\n            }\n            if (selectAll) {\n                if (swapRange[0] === 0) {\n                    selectAll.classList.add('e-prev-highlight-bottom');\n                }\n                if (swapRange[1] === 0) {\n                    selectAll.classList.add('e-prev-highlight-right');\n                }\n            }\n        }\n    };\n    Selection.prototype.protectHandler = function () {\n        var range = getRangeIndexes(this.parent.getActiveSheet().selectedRange);\n        var swapRange = getSwapRange(range);\n        var actRange = getCellIndexes(this.parent.getActiveSheet().activeCell);\n        var inRange = swapRange[0] <= actRange[0] && swapRange[2] >= actRange[0] && swapRange[1] <= actRange[1]\n            && swapRange[3] >= actRange[1];\n        this.selectRangeByIdx(range, null, null, inRange);\n    };\n    Selection.prototype.getHdrIndexes = function (range) {\n        if (this.parent.scrollSettings.enableVirtualization) {\n            var indexes = [];\n            var hiddenRowCount = this.parent.hiddenCount(this.parent.viewport.topIndex, range[0]);\n            var hiddenColCount = this.parent.hiddenCount(this.parent.viewport.leftIndex, range[1], 'columns');\n            indexes[0] = this.isColSelected ? range[0] : (range[0] - this.parent.viewport.topIndex) < 0\n                ? 0 : ((range[0] - hiddenRowCount) - this.parent.viewport.topIndex);\n            indexes[1] = this.isRowSelected ? range[1] : (range[1] - this.parent.viewport.leftIndex) < 0\n                ? 0 : ((range[1] - hiddenColCount) - this.parent.viewport.leftIndex);\n            indexes[2] = this.isColSelected ? this.parent.viewport.rowCount + this.parent.getThreshold('row') * 2 : range[2] -\n                this.parent.hiddenCount(range[0], range[2]) - hiddenRowCount - this.parent.viewport.topIndex;\n            indexes[3] = this.isRowSelected ? this.parent.viewport.colCount + this.parent.getThreshold('col') * 2 :\n                range[3] - this.parent.hiddenCount(range[1], range[3], 'columns') - hiddenColCount - this.parent.viewport.leftIndex;\n            return indexes;\n        }\n        return range;\n    };\n    Selection.prototype.initiateFormulaSelection = function (args) {\n        this.processFormulaEditRange(args.range, args.formulaSheetIdx);\n    };\n    Selection.prototype.processFormulaEditRange = function (val, formulaStartSheetIdx) {\n        var str;\n        var actSheetIdx;\n        var formulaSheetIdx = formulaStartSheetIdx;\n        var lastChar;\n        var i = 0;\n        var parsedVal = this.parseFormula(val);\n        var len = parsedVal.length;\n        var ctrlKeyCount = 0;\n        var formulaBorder = [['e-vborderright', 'e-vborderbottom'], ['e-pborderright', 'e-pborderbottom'],\n            ['e-cborderright', 'e-cborderbottom'], ['e-gborderright', 'e-gborderbottom'], ['e-oborderright', 'e-oborderbottom'],\n            ['e-bborderright', 'e-bborderbottom']];\n        this.clearBorder();\n        actSheetIdx = this.parent.getActiveSheet().id - 1;\n        while (i < len) {\n            str = parsedVal[i];\n            if (this.invalidOperators.indexOf(str) > -1) {\n                break;\n            }\n            if (isCellReference(str.toUpperCase())) {\n                str = str.replace(/\\$/g, '');\n                if (i > 0) {\n                    if (parsedVal[i - 1].indexOf('!') === parsedVal[i - 1].length - 1) {\n                        var splitStr = parsedVal[i - 1].split('!');\n                        formulaSheetIdx = getSheetIndex(this.parent, splitStr[0].substring(1, splitStr[0].length - 1));\n                    }\n                }\n                if (parsedVal[i + 1] === ':') {\n                    i++;\n                    if (parsedVal[i + 1] && isCellReference(parsedVal[i + 1].toUpperCase())) {\n                        str = str + ':' + parsedVal[i + 1];\n                        i++;\n                    }\n                }\n                if (actSheetIdx === formulaSheetIdx) {\n                    this.updateFormulaEditRange(str, ctrlKeyCount, formulaBorder);\n                }\n                formulaSheetIdx = formulaStartSheetIdx;\n                ctrlKeyCount++;\n            }\n            i++;\n        }\n    };\n    Selection.prototype.updateFormulaEditRange = function (str, i, formulaBorder) {\n        var indices = getRangeIndexes(str);\n        this.formulaRange[i] = str;\n        this.dStartCell = { rowIndex: indices[0], colIndex: indices[1] };\n        this.dEndCell = { rowIndex: indices[2], colIndex: indices[3] };\n        this.focusBorder(this.dStartCell, this.dEndCell, formulaBorder[i % 6]);\n    };\n    Selection.prototype.chartBorderHandler = function (args) {\n        this.focusBorder(args.startcell, args.endcell, args.classes, true);\n    };\n    Selection.prototype.focusBorder = function (startcell, endcell, classes, isChart) {\n        isChart = isNullOrUndefined(isChart) ? false : isChart;\n        var range = getSwapRange([startcell.rowIndex, startcell.colIndex, endcell.rowIndex, endcell.colIndex]);\n        var minr = range[0];\n        var minc = range[1];\n        var maxr = range[2];\n        var maxc = range[3];\n        if (minr) {\n            (this.getEleFromRange([minr - 1, minc, minr - 1, maxc])).forEach(function (td) {\n                if (td) {\n                    td.classList.add(classes[1]);\n                    if (!isChart) {\n                        td.classList.add('e-formularef-selection');\n                    }\n                }\n            }); // top                            \n        }\n        (this.getEleFromRange([minr, maxc, maxr, maxc])).forEach(function (td) {\n            if (td) {\n                td.classList.add(classes[0]);\n                if (!isChart) {\n                    td.classList.add('e-formularef-selection');\n                }\n            }\n        }); // right\n        this.getEleFromRange([maxr, minc, maxr, maxc]).forEach(function (td) {\n            if (td) {\n                td.classList.add(classes[1]);\n                if (!isChart) {\n                    td.classList.add('e-formularef-selection');\n                }\n            }\n        }); // bottom\n        if (minc) {\n            (this.getEleFromRange([minr, minc - 1, maxr, minc - 1])).forEach(function (td) {\n                if (td) {\n                    td.classList.add(classes[0]);\n                    if (!isChart) {\n                        td.classList.add('e-formularef-selection');\n                    }\n                }\n            }); // left\n        }\n    };\n    Selection.prototype.getEleFromRange = function (range, sheetIdx) {\n        sheetIdx = this.parent.getActiveSheet().index;\n        var sheet = this.parent.getActiveSheet();\n        var startRIndex = range[0];\n        var startCIndex = range[1];\n        var endRIndex = range[2];\n        var endCIndex = range[3];\n        var i;\n        var rowIdx;\n        var temp;\n        var len;\n        var tempCells = [];\n        var rowCells;\n        var cells = [];\n        if (startRIndex > endRIndex) {\n            temp = startRIndex;\n            startRIndex = endRIndex;\n            endRIndex = temp;\n        }\n        if (startCIndex > endCIndex) {\n            temp = startCIndex;\n            startCIndex = endCIndex;\n            endCIndex = temp;\n        }\n        if (this.parent.scrollSettings.enableVirtualization) {\n            for (i = startRIndex; i <= endRIndex; i++) {\n                rowIdx = i;\n                if (rowIdx > -1) {\n                    var row = this.parent.getRow(rowIdx);\n                    if (row) {\n                        rowCells = row.getElementsByClassName('e-cell');\n                        tempCells = (endCIndex === startCIndex) ?\n                            [rowCells[endCIndex]] : this.getRowCells(rowCells, startCIndex, endCIndex + 1);\n                        this.merge(cells, tempCells);\n                    }\n                }\n            }\n        }\n        return cells;\n    };\n    Selection.prototype.getRowCells = function (rowCells, startCIndex, endCIndex) {\n        var tdCol = [];\n        for (startCIndex; startCIndex < endCIndex; startCIndex++) {\n            if (rowCells[startCIndex]) {\n                tdCol.push(rowCells[startCIndex]);\n            }\n        }\n        return tdCol;\n    };\n    Selection.prototype.merge = function (first, second) {\n        if (!first || !second) {\n            return;\n        }\n        Array.prototype.push.apply(first, second);\n    };\n    ;\n    Selection.prototype.clearBorder = function () {\n        var borderEleColl = this.parent.element.getElementsByClassName('e-formularef-selection');\n        for (var idx = 0; idx < borderEleColl.length; idx++) {\n            var td = borderEleColl[idx];\n            var classArr = ['e-vborderright', 'e-vborderbottom', 'e-pborderright', 'e-pborderbottom',\n                'e-cborderright', 'e-cborderbottom', 'e-gborderright', 'e-gborderbottom', 'e-oborderright',\n                'e-oborderbottom', 'e-bborderright', 'e-bborderbottom'];\n            for (var idx_1 = 0; idx_1 < classArr.length; idx_1++) {\n                td.classList.remove(classArr[idx_1]);\n            }\n        }\n        for (var idx = 0; idx < borderEleColl.length; idx++) {\n            var td = borderEleColl[idx];\n        }\n    };\n    Selection.prototype.parseFormula = function (formulaStr) {\n        var tempStr;\n        var str;\n        var len;\n        var i = 0;\n        var arr = [];\n        formulaStr = this.markSpecialChar(formulaStr.replace('=', ''));\n        var formula = formulaStr.split(/\\(|\\)|=|\\^|>|<|,|:|\\+|-|\\*|\\/|%|&/g);\n        len = formula.length;\n        while (i < len) {\n            tempStr = formula[i];\n            if (!tempStr) {\n                i++;\n                continue;\n            }\n            if (tempStr.length === 1) {\n                arr.push(this.isUniqueChar(tempStr) ? this.getUniqueCharVal(tempStr) : tempStr);\n            }\n            else {\n                str = tempStr[0];\n                if (tempStr.indexOf('!') > 0) {\n                    if (this.isUniqueChar(str)) {\n                        arr.push(this.getUniqueCharVal(str));\n                        tempStr = tempStr.substr(1);\n                    }\n                    var strVal = tempStr.indexOf('!') + 1;\n                    arr.push(tempStr.substr(0, strVal));\n                    arr.push(tempStr.substr(strVal));\n                }\n                else if (this.isUniqueChar(str)) {\n                    arr.push(this.getUniqueCharVal(str));\n                    arr.push(tempStr.substr(1));\n                }\n                else {\n                    arr.push(tempStr);\n                }\n            }\n            i++;\n        }\n        return arr;\n    };\n    Selection.prototype.isUniqueChar = function (str) {\n        var code = str.charCodeAt(str.charAt[0]);\n        return code >= 129 && code <= 142;\n    };\n    Selection.prototype.getUniqueCharVal = function (tempStr) {\n        switch (tempStr) {\n            case this.uniqueOBracket:\n                return '(';\n            case this.uniqueCBracket:\n                return ')';\n            case this.uniqueCOperator:\n                return ':';\n            case this.uniqueSOperator:\n                return '-';\n            case this.uniquePOperator:\n                return '+';\n            case this.uniqueMOperator:\n                return '*';\n            case this.uniqueDOperator:\n                return '/';\n            case this.uniqueModOperator:\n                return '%';\n            case this.uniqueCSeparator:\n                return ',';\n            case this.uniqueConcateOperator:\n                return '&';\n            case this.uniqueEqualOperator:\n                return '=';\n            case this.uniqueExpOperator:\n                return '^';\n            case this.uniqueLTOperator:\n                return '<';\n            case this.uniqueGTOperator:\n                return '>';\n        }\n        return '';\n    };\n    Selection.prototype.markSpecialChar = function (formulaVal) {\n        formulaVal = formulaVal.replace(/\\(/g, '(' + this.uniqueOBracket).replace(/\\)/g, ')' + this.uniqueCBracket);\n        formulaVal = formulaVal.replace(/,/g, ',' + this.uniqueCSeparator).replace(/:/g, ':' + this.uniqueCOperator);\n        formulaVal = formulaVal.replace(/\\+/g, '+' + this.uniquePOperator).replace(/-/g, '-' + this.uniqueSOperator);\n        formulaVal = formulaVal.replace(/\\*/g, '*' + this.uniqueMOperator).replace(/\\//g, '/' + this.uniqueDOperator);\n        formulaVal = formulaVal.replace(/&/g, '&' + this.uniqueConcateOperator);\n        formulaVal = formulaVal.replace(/=/g, '=' + this.uniqueEqualOperator);\n        formulaVal = formulaVal.replace(/\\^/g, '^' + this.uniqueExpOperator);\n        formulaVal = formulaVal.replace(/>/g, '>' + this.uniqueGTOperator).replace(/</g, '<' + this.uniqueLTOperator);\n        return formulaVal.replace(/%/g, '%' + this.uniqueModOperator);\n    };\n    /**\n     * For internal use only - Get the module name.\n     * @private\n     */\n    Selection.prototype.getModuleName = function () {\n        return 'selection';\n    };\n    Selection.prototype.destroy = function () {\n        this.removeEventListener();\n        this.parent = null;\n    };\n    return Selection;\n}());\nexport { Selection };\n","import { EventHandler, Browser } from '@syncfusion/ej2-base';\nimport { contentLoaded, spreadsheetDestroyed, onVerticalScroll, onHorizontalScroll, getScrollBarWidth } from '../common/index';\nimport { onContentScroll, deInitProperties, setScrollEvent, skipHiddenIdx } from '../common/index';\nimport { getRowHeight, getColumnWidth, getCellAddress } from '../../workbook/index';\nimport { isFormulaBarEdit } from '../common/index';\n/**\n * The `Scroll` module is used to handle scrolling behavior.\n * @hidden\n */\nvar Scroll = /** @class */ (function () {\n    /**\n     * Constructor for the Spreadsheet scroll module.\n     * @private\n     */\n    function Scroll(parent) {\n        this.parent = parent;\n        this.addEventListener();\n        this.initProps();\n    }\n    Scroll.prototype.onContentScroll = function (e) {\n        var target = this.parent.getMainContent();\n        var scrollLeft = e.scrollLeft || target.scrollLeft;\n        var top = e.scrollTop || target.scrollTop;\n        var left = this.parent.enableRtl ? this.initScrollValue - scrollLeft : scrollLeft;\n        var scrollArgs;\n        var prevSize;\n        if (this.prevScroll.scrollLeft !== left) {\n            var scrollRight = left > this.prevScroll.scrollLeft;\n            prevSize = this.offset.left.size;\n            this.offset.left = this.getColOffset(left, scrollRight, e.skipHidden);\n            if (this.parent.getActiveSheet().showHeaders) {\n                this.parent.getColumnHeaderContent().scrollLeft = scrollLeft;\n            }\n            scrollArgs = {\n                cur: this.offset.left, prev: { idx: this.leftIndex, size: prevSize }, increase: scrollRight, preventScroll: e.preventScroll\n            };\n            this.parent.notify(onHorizontalScroll, scrollArgs);\n            this.updateTopLeftCell(scrollRight);\n            if (!this.parent.scrollSettings.enableVirtualization && scrollRight && !this.parent.scrollSettings.isFinite) {\n                this.updateNonVirtualCols();\n            }\n            this.leftIndex = scrollArgs.prev.idx;\n            this.prevScroll.scrollLeft = left;\n        }\n        if (this.prevScroll.scrollTop !== top) {\n            var scrollDown = top > this.prevScroll.scrollTop;\n            prevSize = this.offset.top.size;\n            this.offset.top = this.getRowOffset(top, scrollDown);\n            if (this.parent.getActiveSheet().showHeaders) {\n                this.parent.getRowHeaderContent().scrollTop = top;\n            }\n            scrollArgs = {\n                cur: this.offset.top, prev: { idx: this.topIndex, size: prevSize }, increase: scrollDown, preventScroll: e.preventScroll\n            };\n            this.parent.notify(onVerticalScroll, scrollArgs);\n            this.updateTopLeftCell(scrollDown);\n            if (!this.parent.scrollSettings.enableVirtualization && scrollDown && !this.parent.scrollSettings.isFinite) {\n                this.updateNonVirtualRows();\n            }\n            this.topIndex = scrollArgs.prev.idx;\n            this.prevScroll.scrollTop = top;\n        }\n        var isEdit = false;\n        var args = { isEdit: isEdit };\n        this.parent.notify(isFormulaBarEdit, args);\n        if (args.isEdit) {\n            var textArea = this.parent.element.querySelector('.e-formula-bar');\n            textArea.focus();\n        }\n    };\n    Scroll.prototype.updateNonVirtualRows = function () {\n        var sheet = this.parent.getActiveSheet();\n        var threshold = this.parent.getThreshold('row');\n        if (this.offset.top.idx > sheet.rowCount - (this.parent.viewport.rowCount + threshold)) {\n            this.parent.renderModule.refreshUI({ colIndex: 0, direction: 'first', refresh: 'RowPart' }, getCellAddress(sheet.rowCount, 0) + \":\" + getCellAddress(sheet.rowCount + threshold - 1, sheet.colCount - 1));\n            sheet.rowCount += threshold;\n        }\n    };\n    Scroll.prototype.updateNonVirtualCols = function () {\n        var sheet = this.parent.getActiveSheet();\n        var threshold = this.parent.getThreshold('col');\n        if (this.offset.left.idx > sheet.colCount - (this.parent.viewport.colCount + threshold)) {\n            this.parent.renderModule.refreshUI({ rowIndex: 0, colIndex: sheet.colCount, direction: 'first', refresh: 'ColumnPart' }, getCellAddress(0, sheet.colCount) + \":\" + getCellAddress(sheet.rowCount - 1, sheet.colCount + threshold - 1));\n            sheet.colCount += threshold;\n        }\n    };\n    Scroll.prototype.updateTopLeftCell = function (increase) {\n        var top = this.offset.top.idx;\n        var left = this.offset.left.idx;\n        if (!increase) {\n            var sheet = this.parent.getActiveSheet();\n            top = skipHiddenIdx(sheet, top, true);\n            left = skipHiddenIdx(sheet, left, true, 'columns');\n        }\n        this.parent.setSheetPropertyOnMute(this.parent.getActiveSheet(), 'topLeftCell', getCellAddress(top, left));\n    };\n    Scroll.prototype.getRowOffset = function (scrollTop, scrollDown) {\n        var temp = this.offset.top.size;\n        var sheet = this.parent.getActiveSheet();\n        var i = scrollDown ? this.offset.top.idx + 1 : (this.offset.top.idx ? this.offset.top.idx - 1 : 0);\n        var count;\n        if (this.parent.scrollSettings.isFinite) {\n            count = sheet.rowCount;\n            if (scrollDown && i + this.parent.viewport.rowCount + this.parent.getThreshold('row') >= count) {\n                return { idx: this.offset.top.idx, size: this.offset.top.size };\n            }\n        }\n        else {\n            count = Infinity;\n        }\n        while (i < count) {\n            if (scrollDown) {\n                temp += getRowHeight(sheet, i - 1);\n                if (temp === scrollTop) {\n                    return { idx: i, size: temp };\n                }\n                if (temp > scrollTop) {\n                    return { idx: i - 1, size: temp - getRowHeight(sheet, i - 1) };\n                }\n                i++;\n            }\n            else {\n                if (temp === 0) {\n                    return { idx: 0, size: 0 };\n                }\n                temp -= getRowHeight(sheet, i);\n                if (temp === scrollTop) {\n                    return { idx: i, size: temp };\n                }\n                if (temp < scrollTop) {\n                    temp += getRowHeight(sheet, i);\n                    if (temp > scrollTop) {\n                        return { idx: i, size: temp - getRowHeight(sheet, i) < 0 ? 0 : temp - getRowHeight(sheet, i) };\n                    }\n                    else {\n                        return { idx: i + 1, size: temp };\n                    }\n                }\n                i--;\n            }\n        }\n        return { idx: this.offset.top.idx, size: this.offset.top.size };\n    };\n    Scroll.prototype.getColOffset = function (scrollLeft, increase, skipHidden) {\n        var temp = this.offset.left.size;\n        var sheet = this.parent.getActiveSheet();\n        var i = increase ? this.offset.left.idx + 1 : this.offset.left.idx - 1;\n        var count;\n        if (this.parent.scrollSettings.isFinite) {\n            count = sheet.colCount;\n            if (increase && i + this.parent.viewport.colCount + this.parent.getThreshold('col') >= count) {\n                return { idx: this.offset.left.idx, size: this.offset.left.size };\n            }\n        }\n        else {\n            count = Infinity;\n        }\n        while (i < count) {\n            if (increase) {\n                temp += getColumnWidth(sheet, i - 1, skipHidden);\n                if (temp === scrollLeft) {\n                    return { idx: i, size: temp };\n                }\n                if (temp > scrollLeft) {\n                    return { idx: i - 1, size: temp - getColumnWidth(sheet, i - 1, skipHidden) };\n                }\n                i++;\n            }\n            else {\n                if (temp === 0) {\n                    return { idx: 0, size: 0 };\n                }\n                temp -= getColumnWidth(sheet, i, skipHidden);\n                if (temp === scrollLeft) {\n                    return { idx: i, size: temp };\n                }\n                if (temp < scrollLeft) {\n                    temp += getColumnWidth(sheet, i, skipHidden);\n                    if (temp > scrollLeft) {\n                        return { idx: i, size: temp - getColumnWidth(sheet, i, skipHidden) };\n                    }\n                    else {\n                        return { idx: i + 1, size: temp };\n                    }\n                }\n                i--;\n            }\n        }\n        return { idx: this.offset.left.idx, size: this.offset.left.size };\n    };\n    Scroll.prototype.contentLoaded = function () {\n        this.onScroll = this.onContentScroll.bind(this);\n        this.setScrollEvent();\n        if (this.parent.enableRtl) {\n            this.initScrollValue = this.parent.getMainContent().scrollLeft;\n        }\n    };\n    Scroll.prototype.setScrollEvent = function (args) {\n        if (args === void 0) { args = { set: true }; }\n        args.set ? EventHandler.add(this.parent.getMainContent(), 'scroll', this.onScroll, this) :\n            EventHandler.remove(this.parent.getMainContent(), 'scroll', this.onScroll);\n    };\n    Scroll.prototype.initProps = function () {\n        this.topIndex = 0;\n        this.leftIndex = 0;\n        this.prevScroll = { scrollLeft: 0, scrollTop: 0 };\n        this.offset = { left: { idx: 0, size: 0 }, top: { idx: 0, size: 0 } };\n    };\n    Scroll.prototype.getThreshold = function () {\n        /* Some browsers places the scroller outside the content,\n         * hence the padding should be adjusted.*/\n        if (Browser.info.name === 'mozilla') {\n            return 0.5;\n        }\n        return 1;\n    };\n    /**\n     * @hidden\n     */\n    Scroll.prototype.setPadding = function () {\n        if (!this.parent.allowScrolling) {\n            return;\n        }\n        var colHeader = this.parent.getColumnHeaderContent();\n        var rowHeader = this.parent.getRowHeaderContent();\n        var scrollWidth = getScrollBarWidth() - this.getThreshold();\n        var cssProps = this.parent.enableRtl ? { padding: 'paddingLeft', border: 'borderLeftWidth' }\n            : { padding: 'paddingRight', border: 'borderRightWidth' };\n        if (scrollWidth > 0) {\n            colHeader.parentElement.style[cssProps.padding] = scrollWidth + 'px';\n            colHeader.style[cssProps.border] = '1px';\n            rowHeader.style.marginBottom = scrollWidth + 'px';\n        }\n    };\n    Scroll.prototype.addEventListener = function () {\n        this.parent.on(contentLoaded, this.contentLoaded, this);\n        this.parent.on(onContentScroll, this.onContentScroll, this);\n        this.parent.on(deInitProperties, this.initProps, this);\n        this.parent.on(spreadsheetDestroyed, this.destroy, this);\n        this.parent.on(setScrollEvent, this.setScrollEvent, this);\n    };\n    Scroll.prototype.destroy = function () {\n        EventHandler.remove(this.parent.getMainContent(), 'scroll', this.onScroll);\n        this.removeEventListener();\n        this.parent = null;\n    };\n    Scroll.prototype.removeEventListener = function () {\n        this.parent.off(contentLoaded, this.contentLoaded);\n        this.parent.off(onContentScroll, this.onContentScroll);\n        this.parent.off(deInitProperties, this.initProps);\n        this.parent.off(spreadsheetDestroyed, this.destroy);\n        this.parent.off(setScrollEvent, this.setScrollEvent);\n    };\n    return Scroll;\n}());\nexport { Scroll };\n","import { isNullOrUndefined } from '@syncfusion/ej2-base';\nimport { spreadsheetDestroyed, beforeContentLoaded, beforeVirtualContentLoaded, virtualContentLoaded } from '../common/index';\nimport { colWidthChanged, updateTableWidth } from '../common/index';\nimport { onVerticalScroll, onHorizontalScroll, rowHeightChanged, beforeHeaderLoaded, deInitProperties } from '../common/index';\nimport { getRowHeight, getRowsHeight, getColumnWidth, getColumnsWidth } from './../../workbook/index';\nimport { getRangeAddress } from '../../workbook/common/index';\nimport { updateUsedRange, sheetCreated, sheetsDestroyed } from '../../workbook/common/event';\n/**\n * VirtualScroll module\n * @hidden\n */\nvar VirtualScroll = /** @class */ (function () {\n    function VirtualScroll(parent) {\n        this.scroll = [];\n        this.parent = parent;\n        this.addEventListener();\n    }\n    VirtualScroll.prototype.createVirtualElement = function (args) {\n        var sheet = this.parent.getActiveSheet();\n        var container = this.parent.getMainContent();\n        this.content = this.parent.createElement('div', { className: 'e-virtualable' });\n        this.content.appendChild(container.querySelector('.e-table'));\n        container.appendChild(this.content);\n        var vTrack = container.appendChild(this.parent.createElement('div', { className: 'e-virtualtrack' }));\n        var colVTrack;\n        var rowVTrack;\n        var height;\n        var width;\n        if (this.parent.sheets.length > this.scroll.length) {\n            this.initScroll();\n        }\n        var domCount = this.parent.viewport.rowCount + 1 + (this.parent.getThreshold('row') * 2);\n        if (sheet.rowCount > domCount || sheet.usedRange.rowIndex > domCount - 1) {\n            if (!this.parent.scrollSettings.isFinite && sheet.rowCount <= sheet.usedRange.rowIndex) {\n                this.parent.setSheetPropertyOnMute(sheet, 'rowCount', sheet.usedRange.rowIndex + 1);\n            }\n            this.setScrollCount(sheet.rowCount, 'row');\n            height = getRowsHeight(sheet, 0, this.scroll[this.parent.activeSheetIndex].rowCount - 1);\n        }\n        else {\n            if (!this.parent.scrollSettings.isFinite) {\n                this.parent.setSheetPropertyOnMute(sheet, 'rowCount', domCount);\n            }\n            this.scroll[this.parent.activeSheetIndex].rowCount = sheet.rowCount;\n            height = 1;\n        }\n        domCount = this.parent.viewport.colCount + 1 + (this.parent.getThreshold('col') * 2);\n        var size;\n        if (sheet.colCount > domCount || sheet.usedRange.colIndex > domCount - 1) {\n            if (!this.parent.scrollSettings.isFinite && sheet.colCount <= sheet.usedRange.colIndex) {\n                this.parent.setSheetPropertyOnMute(sheet, 'colCount', sheet.usedRange.colIndex + 1);\n            }\n            size = getColumnsWidth(sheet, 0, domCount - 1);\n            this.setScrollCount(sheet.colCount, 'col');\n            width = size + getColumnsWidth(sheet, domCount, this.scroll[this.parent.activeSheetIndex].colCount - 1);\n        }\n        else {\n            if (!this.parent.scrollSettings.isFinite) {\n                this.parent.setSheetPropertyOnMute(sheet, 'colCount', domCount);\n            }\n            size = getColumnsWidth(sheet, 0, sheet.colCount - 1);\n            this.scroll[this.parent.activeSheetIndex].colCount = sheet.colCount;\n            width = size;\n        }\n        if (args.startColIdx) {\n            size = getColumnsWidth(sheet, args.startColIdx, args.startColIdx + domCount - 1);\n        }\n        if (isNullOrUndefined(this.parent.viewport.leftIndex)) {\n            this.parent.viewport.leftIndex = 0;\n        }\n        if (isNullOrUndefined(this.parent.viewport.topIndex)) {\n            this.parent.viewport.topIndex = 0;\n        }\n        if (isNullOrUndefined(this.translateX)) {\n            this.translateX = 0;\n        }\n        if (isNullOrUndefined(this.translateY)) {\n            this.translateY = 0;\n        }\n        if (sheet.showHeaders) {\n            container = this.parent.getRowHeaderContent();\n            this.rowHeader = this.content.cloneNode();\n            this.rowHeader.appendChild(container.querySelector('.e-table'));\n            container.appendChild(this.rowHeader);\n            rowVTrack = container.appendChild(vTrack.cloneNode());\n            this.rowHeader.style.transform = \"translate(0px, \" + this.translateY + \"px)\";\n            container = this.parent.getColumnHeaderContent();\n            this.colHeader = this.content.cloneNode();\n            this.colHeader.appendChild(container.querySelector('.e-table'));\n            container.appendChild(this.colHeader);\n            colVTrack = container.appendChild(vTrack.cloneNode());\n            this.colHeader.style.width = size + \"px\";\n            rowVTrack.style.height = height + \"px\";\n            colVTrack.style.width = width + \"px\";\n            this.colHeader.style.transform = \"translate(\" + this.translateX + \"px, 0px)\";\n        }\n        this.content.style.transform = \"translate(\" + this.translateX + \"px, \" + this.translateY + \"px)\";\n        this.content.style.width = size + \"px\";\n        vTrack.style.height = height + \"px\";\n        vTrack.style.width = width + \"px\";\n    };\n    VirtualScroll.prototype.initScroll = function () {\n        var i = 0;\n        while (i < this.parent.sheets.length) {\n            if (!this.scroll[i]) {\n                this.scroll.push({ rowCount: 0, colCount: 0 });\n            }\n            i++;\n        }\n    };\n    VirtualScroll.prototype.setScrollCount = function (count, layout) {\n        var activeSheetIdx = this.parent.activeSheetIndex;\n        if (!this.scroll[activeSheetIdx][layout + 'Count']) {\n            this.scroll[activeSheetIdx][layout + 'Count'] = count;\n        }\n    };\n    VirtualScroll.prototype.getRowAddress = function (indexes) {\n        return getRangeAddress([indexes[0], this.parent.viewport.leftIndex, indexes[1], this.parent.viewport.rightIndex]);\n    };\n    VirtualScroll.prototype.getColAddress = function (indexes) {\n        return getRangeAddress([this.parent.viewport.topIndex, indexes[0], this.parent.viewport.bottomIndex, indexes[1]]);\n    };\n    VirtualScroll.prototype.updateScrollCount = function (idx, layout, threshold) {\n        if (threshold === void 0) { threshold = idx; }\n        var sheet = this.parent.getActiveSheet();\n        var rowCount = idx + this.parent.viewport[layout + 'Count'] + 1 + threshold;\n        var usedRangeCount = this.scroll[this.parent.activeSheetIndex][layout + 'Count'];\n        if (rowCount < usedRangeCount) {\n            if (sheet[layout + 'Count'] === usedRangeCount) {\n                return;\n            }\n            rowCount = usedRangeCount;\n        }\n        if (!this.parent.scrollSettings.isFinite) {\n            this.parent.setSheetPropertyOnMute(sheet, layout + 'Count', rowCount);\n        }\n    };\n    VirtualScroll.prototype.onVerticalScroll = function (args) {\n        var idx = args.cur.idx;\n        var height = args.cur.size;\n        var prevIdx = args.prev.idx;\n        var idxDiff = Math.abs(idx - prevIdx);\n        var threshold = this.parent.getThreshold('row');\n        if (idxDiff > Math.round(threshold / 2)) {\n            var startIdx = void 0;\n            var lastIdx = void 0;\n            var prevTopIdx = void 0;\n            if (idx <= threshold) {\n                if (!args.increase) {\n                    if (this.translateY && prevIdx > threshold) {\n                        this.translateY = 0;\n                        this.parent.viewport.topIndex = prevIdx - threshold;\n                        if (!args.preventScroll) {\n                            if (idxDiff < this.parent.viewport.rowCount + threshold) {\n                                lastIdx = this.parent.viewport.topIndex - 1;\n                                startIdx = this.parent.skipHidden(0, lastIdx)[0];\n                                this.parent.viewport.topIndex = startIdx;\n                                var hiddenCount = this.hiddenCount(startIdx, lastIdx);\n                                var skippedHiddenIdx = this.skipHiddenIdx((this.parent.viewport.bottomIndex - ((lastIdx - startIdx + 1) - hiddenCount)), args.increase);\n                                this.parent.viewport.bottomIndex -= (((lastIdx - startIdx + 1) - hiddenCount) +\n                                    (this.hiddenCount(skippedHiddenIdx, this.parent.viewport.bottomIndex)));\n                                this.parent.renderModule.refreshUI({\n                                    colIndex: this.parent.viewport.leftIndex, rowIndex: startIdx, direction: 'last', refresh: 'RowPart',\n                                    skipUpdateOnFirst: true\n                                }, this.getRowAddress([0, this.skipHiddenIdx(lastIdx, false)]));\n                            }\n                            else {\n                                this.parent.renderModule.refreshUI({ rowIndex: 0, colIndex: this.parent.viewport.leftIndex, refresh: 'Row', skipUpdateOnFirst: true });\n                            }\n                            this.parent.element.focus();\n                        }\n                    }\n                    this.updateScrollCount(threshold, 'row');\n                }\n            }\n            if (prevIdx < threshold) {\n                idxDiff = Math.abs(idx - threshold);\n            }\n            if (idx > threshold) {\n                prevTopIdx = this.parent.viewport.topIndex;\n                this.parent.viewport.topIndex = idx - threshold;\n                if (args.increase && prevTopIdx > this.parent.viewport.topIndex) {\n                    this.parent.viewport.topIndex = prevTopIdx;\n                    return;\n                }\n                this.translateY = height - this.getThresholdHeight(this.parent.viewport.topIndex, threshold);\n                if (!args.preventScroll) {\n                    if (idxDiff < this.parent.viewport.rowCount + threshold) {\n                        if (args.increase) {\n                            startIdx = this.parent.viewport.bottomIndex + 1;\n                            lastIdx = this.parent.viewport.bottomIndex + (this.parent.viewport.topIndex - prevTopIdx);\n                            lastIdx -= this.hiddenCount(prevTopIdx, this.parent.viewport.topIndex - 1);\n                            this.parent.viewport.topIndex = this.skipHiddenIdx(this.parent.viewport.topIndex, args.increase);\n                            if (lastIdx <= this.parent.viewport.bottomIndex) {\n                                return;\n                            }\n                            var indexes = this.parent.skipHidden(startIdx, lastIdx);\n                            startIdx = indexes[0];\n                            lastIdx = this.checkLastIdx(indexes[1], 'row');\n                            this.parent.viewport.bottomIndex = lastIdx;\n                            this.parent.renderModule.refreshUI({ colIndex: this.parent.viewport.leftIndex, rowIndex: startIdx, direction: 'first', refresh: 'RowPart' }, this.getRowAddress([startIdx, lastIdx]));\n                        }\n                        else {\n                            startIdx = this.parent.viewport.topIndex;\n                            lastIdx = startIdx + idxDiff - 1;\n                            var hiddenCount = this.hiddenCount(startIdx, lastIdx);\n                            var skippedHiddenIdx = this.skipHiddenIdx((this.parent.viewport.bottomIndex - ((lastIdx - startIdx) - hiddenCount)), args.increase);\n                            this.parent.viewport.bottomIndex -= ((idxDiff - hiddenCount) +\n                                (this.hiddenCount(skippedHiddenIdx, this.parent.viewport.bottomIndex)));\n                            startIdx = this.parent.skipHidden(startIdx, lastIdx)[0];\n                            this.parent.viewport.topIndex = startIdx;\n                            this.parent.renderModule.refreshUI({ colIndex: this.parent.viewport.leftIndex, rowIndex: startIdx, direction: 'last', refresh: 'RowPart' }, this.getRowAddress([startIdx, lastIdx]));\n                        }\n                    }\n                    else {\n                        this.parent.renderModule.refreshUI({\n                            rowIndex: this.parent.viewport.topIndex, colIndex: this.parent.viewport.leftIndex, refresh: 'Row'\n                        });\n                    }\n                    this.updateScrollCount(idx, 'row', threshold);\n                    this.parent.element.focus();\n                }\n            }\n            args.prev.idx = idx;\n        }\n    };\n    VirtualScroll.prototype.skipHiddenIdx = function (index, increase, layout, sheet) {\n        if (layout === void 0) { layout = 'rows'; }\n        if (sheet === void 0) { sheet = this.parent.getActiveSheet(); }\n        if ((sheet[layout])[index] && (sheet[layout])[index].hidden) {\n            increase ? index++ : index--;\n            index = this.skipHiddenIdx(index, increase, layout, sheet);\n        }\n        return index;\n    };\n    VirtualScroll.prototype.hiddenCount = function (startIdx, endIdx, layout) {\n        if (layout === void 0) { layout = 'rows'; }\n        var index = 0;\n        var sheet = this.parent.getActiveSheet();\n        for (var i = startIdx; i <= endIdx; i++) {\n            if ((sheet[layout])[i] && (sheet[layout])[i].hidden) {\n                index++;\n            }\n        }\n        return index;\n    };\n    VirtualScroll.prototype.checkLastIdx = function (idx, layout) {\n        if (this.parent.scrollSettings.isFinite) {\n            var count = this.parent.getActiveSheet()[layout + 'Count'] - 1;\n            if (idx > count) {\n                idx = count;\n            }\n        }\n        return idx;\n    };\n    VirtualScroll.prototype.onHorizontalScroll = function (args) {\n        var idx = args.cur.idx;\n        var width = args.cur.size;\n        var prevIdx = args.prev.idx;\n        var idxDiff = Math.abs(idx - prevIdx);\n        var threshold = this.parent.getThreshold('col');\n        if (idxDiff > Math.round(threshold / 2)) {\n            var startIdx = void 0;\n            var endIdx = void 0;\n            var prevLeftIdx = void 0;\n            if (idx <= threshold) {\n                if (!args.increase) {\n                    if (this.translateX && prevIdx > threshold) {\n                        this.translateX = 0;\n                        this.parent.viewport.leftIndex = prevIdx - threshold;\n                        if (!args.preventScroll) {\n                            if (idxDiff < this.parent.viewport.colCount + threshold) {\n                                endIdx = this.parent.viewport.leftIndex - 1;\n                                startIdx = this.parent.skipHidden(0, endIdx, 'columns')[0];\n                                this.parent.viewport.leftIndex = startIdx;\n                                var hiddenCount = this.hiddenCount(startIdx, endIdx, 'columns');\n                                var skippedHiddenIdx = this.skipHiddenIdx((this.parent.viewport.rightIndex - ((endIdx - startIdx + 1) - hiddenCount)), args.increase, 'columns');\n                                this.parent.viewport.rightIndex -= (((endIdx - startIdx + 1) - hiddenCount) +\n                                    (this.hiddenCount(skippedHiddenIdx, this.parent.viewport.rightIndex, 'columns')));\n                                this.parent.renderModule.refreshUI({ rowIndex: this.parent.viewport.topIndex, colIndex: startIdx, direction: 'last', refresh: 'ColumnPart',\n                                    skipUpdateOnFirst: true }, this.getColAddress([0, this.skipHiddenIdx(endIdx, false, 'columns')]));\n                            }\n                            else {\n                                this.parent.renderModule.refreshUI({ rowIndex: this.parent.viewport.topIndex, colIndex: 0, refresh: 'Column', skipUpdateOnFirst: true });\n                            }\n                            this.parent.element.focus();\n                        }\n                    }\n                    this.updateScrollCount(threshold, 'col');\n                }\n            }\n            if (prevIdx < threshold) {\n                idxDiff = Math.abs(idx - threshold);\n            }\n            if (idx > threshold) {\n                prevLeftIdx = this.parent.viewport.leftIndex;\n                this.parent.viewport.leftIndex = idx - threshold;\n                if (args.increase && prevLeftIdx > this.parent.viewport.leftIndex) {\n                    this.parent.viewport.leftIndex = prevLeftIdx;\n                    return;\n                }\n                this.translateX = width - this.getThresholdWidth(this.parent.viewport.leftIndex, threshold);\n                if (!args.preventScroll) {\n                    if (idxDiff < this.parent.viewport.colCount + threshold) {\n                        if (args.increase) {\n                            startIdx = this.parent.viewport.rightIndex + 1;\n                            endIdx = this.parent.viewport.rightIndex + (this.parent.viewport.leftIndex - prevLeftIdx);\n                            endIdx -= this.hiddenCount(prevLeftIdx, this.parent.viewport.leftIndex - 1, 'columns');\n                            this.parent.viewport.leftIndex = this.skipHiddenIdx(this.parent.viewport.leftIndex, args.increase, 'columns');\n                            if (endIdx <= this.parent.viewport.rightIndex) {\n                                return;\n                            }\n                            var indexes = this.parent.skipHidden(startIdx, endIdx, 'columns');\n                            startIdx = indexes[0];\n                            endIdx = this.checkLastIdx(indexes[1], 'col');\n                            this.parent.viewport.rightIndex = endIdx;\n                            this.parent.renderModule.refreshUI({ rowIndex: this.parent.viewport.topIndex, colIndex: startIdx, direction: 'first', refresh: 'ColumnPart' }, this.getColAddress([startIdx, endIdx]));\n                        }\n                        else {\n                            startIdx = this.parent.viewport.leftIndex;\n                            endIdx = startIdx + idxDiff - 1;\n                            var hiddenCount = this.hiddenCount(startIdx, endIdx, 'columns');\n                            var skippedHiddenIdx = this.skipHiddenIdx((this.parent.viewport.rightIndex - ((endIdx - startIdx) - hiddenCount)), args.increase, 'columns');\n                            this.parent.viewport.rightIndex -= ((idxDiff - hiddenCount) +\n                                (this.hiddenCount(skippedHiddenIdx, this.parent.viewport.rightIndex, 'columns')));\n                            startIdx = this.parent.skipHidden(startIdx, endIdx, 'columns')[0];\n                            this.parent.viewport.leftIndex = startIdx;\n                            this.parent.renderModule.refreshUI({ rowIndex: this.parent.viewport.topIndex, colIndex: startIdx, direction: 'last', refresh: 'ColumnPart' }, this.getColAddress([startIdx, endIdx]));\n                        }\n                    }\n                    else {\n                        this.parent.renderModule.refreshUI({\n                            rowIndex: this.parent.viewport.topIndex, colIndex: this.parent.viewport.leftIndex, refresh: 'Column'\n                        });\n                    }\n                    this.updateScrollCount(idx, 'col', threshold);\n                    this.parent.element.focus();\n                }\n            }\n            args.prev.idx = idx;\n        }\n    };\n    VirtualScroll.prototype.getThresholdHeight = function (idx, threshold) {\n        var height = 0;\n        var sheet = this.parent.getActiveSheet();\n        for (var i = idx; i < idx + threshold; i++) {\n            height += getRowHeight(sheet, i);\n        }\n        return height;\n    };\n    VirtualScroll.prototype.getThresholdWidth = function (idx, threshold) {\n        var width = 0;\n        var sheet = this.parent.getActiveSheet();\n        for (var i = idx; i < idx + threshold; i++) {\n            width += getColumnWidth(sheet, i);\n        }\n        return width;\n    };\n    VirtualScroll.prototype.translate = function (args) {\n        var sheet = this.parent.getActiveSheet();\n        if (args.refresh === 'Row' || args.refresh === 'RowPart') {\n            this.content.style.transform = \"translate(\" + this.translateX + \"px, \" + this.translateY + \"px)\";\n            if (sheet.showHeaders) {\n                this.rowHeader.style.transform = \"translate(0px, \" + this.translateY + \"px)\";\n            }\n        }\n        if (args.refresh === 'Column' || args.refresh === 'ColumnPart') {\n            var translateX = this.parent.enableRtl ? -this.translateX : this.translateX;\n            this.content.style.transform = \"translate(\" + translateX + \"px, \" + this.translateY + \"px)\";\n            if (sheet.showHeaders) {\n                this.colHeader.style.transform = \"translate(\" + translateX + \"px, 0px)\";\n            }\n        }\n    };\n    VirtualScroll.prototype.updateColumnWidth = function (args) {\n        if (args.refresh === 'Column') {\n            this.content.style.width = '';\n            var width = getColumnsWidth(this.parent.getActiveSheet(), this.parent.viewport.leftIndex, this.parent.viewport.rightIndex);\n            if (this.parent.getActiveSheet().showHeaders) {\n                this.colHeader.style.width = width + 'px';\n            }\n            this.content.style.width = width + 'px';\n        }\n    };\n    VirtualScroll.prototype.updateUsedRange = function (args) {\n        if (!this.scroll.length) {\n            return;\n        }\n        var sheet = this.parent.getActiveSheet();\n        if (args.update === 'row') {\n            if (args.index !== this.scroll[this.parent.activeSheetIndex].rowCount - 1) {\n                var height = this.getVTrackHeight('height');\n                if (args.index >= this.scroll[this.parent.activeSheetIndex].rowCount) {\n                    height += getRowsHeight(sheet, this.scroll[this.parent.activeSheetIndex].rowCount, args.index);\n                }\n                else {\n                    height -= getRowsHeight(sheet, args.index + 1, this.scroll[this.parent.activeSheetIndex].rowCount - 1);\n                }\n                this.scroll[this.parent.activeSheetIndex].rowCount = args.index + 1;\n                this.updateVTrack(this.rowHeader, height, 'height');\n                if (this.scroll[this.parent.activeSheetIndex].rowCount > sheet.rowCount) {\n                    this.parent.setSheetPropertyOnMute(sheet, 'rowCount', this.scroll[this.parent.activeSheetIndex].rowCount);\n                }\n            }\n        }\n        else {\n            if (args.index > this.scroll[this.parent.activeSheetIndex].colCount) {\n                var width = this.getVTrackHeight('width');\n                width += getColumnsWidth(sheet, this.scroll[this.parent.activeSheetIndex].colCount, args.index);\n                this.scroll[this.parent.activeSheetIndex].colCount = args.index + 1;\n                this.updateVTrack(this.colHeader, width, 'width');\n                if (this.scroll[this.parent.activeSheetIndex].colCount > sheet.colCount) {\n                    this.parent.setSheetPropertyOnMute(sheet, 'colCount', this.scroll[this.parent.activeSheetIndex].colCount);\n                }\n            }\n        }\n    };\n    VirtualScroll.prototype.createHeaderElement = function (args) {\n        this.rowHeader = this.content.cloneNode();\n        this.colHeader = this.rowHeader.cloneNode();\n        this.rowHeader.style.width = '';\n        this.rowHeader.style.transform = \"translate(0px, \" + this.translateY + \"px)\";\n        this.colHeader.style.transform = \"translate(\" + (this.parent.enableRtl ? -this.translateX : this.translateX) + \"px, 0px)\";\n        this.rowHeader.appendChild(args.element.querySelector('table'));\n        args.element.appendChild(this.rowHeader);\n        var container = this.parent.getColumnHeaderContent();\n        this.colHeader.appendChild(container.querySelector('table'));\n        container.appendChild(this.colHeader);\n        var rowVTrack = this.content.nextElementSibling.cloneNode();\n        var colVTrack = rowVTrack.cloneNode();\n        rowVTrack.style.width = '';\n        colVTrack.style.height = '';\n        args.element.appendChild(rowVTrack);\n        container.appendChild(colVTrack);\n    };\n    VirtualScroll.prototype.getVTrackHeight = function (str) {\n        var height = this.content.nextElementSibling.style[str];\n        if (height.includes('e+')) {\n            height = height.split('px')[0];\n            var heightArr = height.split('e+');\n            return Number(heightArr[0]) * Math.pow(10, Number(heightArr[1]));\n        }\n        else {\n            return parseInt(height, 10);\n        }\n    };\n    VirtualScroll.prototype.updateVTrackHeight = function (args) {\n        var domCount = this.parent.viewport.rowCount + 1 + (this.parent.getThreshold('row') * 2);\n        if (args.rowIdx >= domCount && args.rowIdx < this.scroll[this.parent.activeSheetIndex].rowCount) {\n            this.updateVTrack(this.rowHeader, this.getVTrackHeight('height') + args.threshold, 'height');\n        }\n    };\n    VirtualScroll.prototype.updateVTrackWidth = function (args) {\n        if (args.colIdx >= this.parent.viewport.leftIndex && args.colIdx <= this.parent.viewport.rightIndex) {\n            if (this.parent.getActiveSheet().showHeaders) {\n                var hdrVTrack = this.parent.getColumnHeaderContent().getElementsByClassName('e-virtualtrack')[0];\n                hdrVTrack.style.width = parseInt(hdrVTrack.style.width, 10) + args.threshold + 'px';\n            }\n            var cntVTrack = this.parent.getMainContent().getElementsByClassName('e-virtualtrack')[0];\n            cntVTrack.style.width = parseInt(cntVTrack.style.width, 10) + args.threshold + 'px';\n            if (this.parent.getActiveSheet().showHeaders) {\n                var hdrColumn = this.parent.getColumnHeaderContent().getElementsByClassName('e-virtualable')[0];\n                hdrColumn.style.width = parseInt(hdrColumn.style.width, 10) + args.threshold + 'px';\n            }\n            var cntColumn = this.parent.getMainContent().getElementsByClassName('e-virtualable')[0];\n            cntColumn.style.width = parseInt(cntColumn.style.width, 10) + args.threshold + 'px';\n        }\n    };\n    VirtualScroll.prototype.updateVTrack = function (header, size, sizeStr) {\n        if (this.parent.getActiveSheet().showHeaders) {\n            header.nextElementSibling.style[sizeStr] = size + \"px\";\n        }\n        this.content.nextElementSibling.style[sizeStr] = size + \"px\";\n    };\n    VirtualScroll.prototype.deInitProps = function () {\n        this.parent.viewport.leftIndex = null;\n        this.parent.viewport.topIndex = null;\n        this.parent.viewport.bottomIndex = null;\n        this.translateX = null;\n        this.translateY = null;\n    };\n    VirtualScroll.prototype.updateScrollProps = function (args) {\n        var _this = this;\n        if (args === void 0) { args = { sheetIndex: 0, sheets: this.parent.sheets }; }\n        if (this.scroll.length === 0) {\n            this.initScroll();\n        }\n        else {\n            args.sheets.forEach(function () { _this.scroll.splice(args.sheetIndex, 0, { rowCount: 0, colCount: 0 }); });\n        }\n    };\n    VirtualScroll.prototype.sliceScrollProps = function (args) {\n        if (isNullOrUndefined(args.sheetIndex)) {\n            this.scroll.length = 0;\n        }\n        else {\n            this.scroll.splice(args.sheetIndex, 1);\n        }\n    };\n    VirtualScroll.prototype.addEventListener = function () {\n        this.parent.on(beforeContentLoaded, this.createVirtualElement, this);\n        this.parent.on(beforeVirtualContentLoaded, this.translate, this);\n        this.parent.on(virtualContentLoaded, this.updateColumnWidth, this);\n        this.parent.on(updateTableWidth, this.updateColumnWidth, this);\n        this.parent.on(onVerticalScroll, this.onVerticalScroll, this);\n        this.parent.on(onHorizontalScroll, this.onHorizontalScroll, this);\n        this.parent.on(updateUsedRange, this.updateUsedRange, this);\n        this.parent.on(rowHeightChanged, this.updateVTrackHeight, this);\n        this.parent.on(colWidthChanged, this.updateVTrackWidth, this);\n        this.parent.on(beforeHeaderLoaded, this.createHeaderElement, this);\n        this.parent.on(deInitProperties, this.deInitProps, this);\n        this.parent.on(sheetsDestroyed, this.sliceScrollProps, this);\n        this.parent.on(sheetCreated, this.updateScrollProps, this);\n        this.parent.on(spreadsheetDestroyed, this.destroy, this);\n    };\n    VirtualScroll.prototype.destroy = function () {\n        this.removeEventListener();\n        this.rowHeader = null;\n        this.colHeader = null;\n        this.content = null;\n        this.parent = null;\n        this.scroll.length = 0;\n        this.translateX = null;\n        this.translateY = null;\n    };\n    VirtualScroll.prototype.removeEventListener = function () {\n        this.parent.off(beforeContentLoaded, this.createVirtualElement);\n        this.parent.off(beforeVirtualContentLoaded, this.translate);\n        this.parent.off(virtualContentLoaded, this.updateColumnWidth);\n        this.parent.off(updateTableWidth, this.updateColumnWidth);\n        this.parent.off(onVerticalScroll, this.onVerticalScroll);\n        this.parent.off(onHorizontalScroll, this.onHorizontalScroll);\n        this.parent.off(updateUsedRange, this.updateUsedRange);\n        this.parent.off(rowHeightChanged, this.updateVTrackHeight);\n        this.parent.off(colWidthChanged, this.updateVTrackWidth);\n        this.parent.off(beforeHeaderLoaded, this.createHeaderElement);\n        this.parent.off(sheetsDestroyed, this.sliceScrollProps);\n        this.parent.off(sheetCreated, this.updateScrollProps);\n        this.parent.off(spreadsheetDestroyed, this.destroy);\n    };\n    return VirtualScroll;\n}());\nexport { VirtualScroll };\n","import { keyDown, cellNavigate, renameSheet, filterCellKeyDown } from '../common/index';\nimport { getCellIndexes, getRangeAddress, getRowHeight, getColumnWidth, getCell } from '../../workbook/index';\nimport { closest } from '@syncfusion/ej2-base';\n/**\n * Represents keyboard navigation support for Spreadsheet.\n */\nvar KeyboardNavigation = /** @class */ (function () {\n    /**\n     * Constructor for the Spreadsheet Keyboard Navigation module.\n     * @private\n     */\n    function KeyboardNavigation(parent) {\n        this.parent = parent;\n        this.addEventListener();\n        /* code snippet */\n    }\n    KeyboardNavigation.prototype.addEventListener = function () {\n        this.parent.on(keyDown, this.keyDownHandler, this);\n        /* code snippet */\n    };\n    KeyboardNavigation.prototype.removeEventListener = function () {\n        if (!this.parent.isDestroyed) {\n            this.parent.off(keyDown, this.keyDownHandler);\n        }\n        /* code snippet */\n    };\n    KeyboardNavigation.prototype.keyDownHandler = function (e) {\n        if (!this.parent.isEdit && (document.activeElement.classList.contains('e-spreadsheet') ||\n            closest(document.activeElement, '.e-sheet'))) {\n            var isNavigate = void 0;\n            var scrollIdxes = void 0;\n            var isRtl = this.parent.enableRtl;\n            var sheet = this.parent.getActiveSheet();\n            var filterArgs = { e: e, isFilterCell: false };\n            var actIdxes = getCellIndexes(this.parent.getActiveSheet().activeCell);\n            if ([9, 37, 38, 39, 40].indexOf(e.keyCode) > -1) {\n                e.preventDefault();\n            }\n            if (!e.shiftKey && e.altKey && (e.keyCode === 38 || e.keyCode === 40)) {\n                this.parent.notify(filterCellKeyDown, filterArgs);\n            }\n            if ((!e.shiftKey && ((!isRtl && e.keyCode === 37) || (isRtl && e.keyCode === 39)))\n                || (e.shiftKey && e.keyCode === 9)) { //left key\n                if (actIdxes[1] > 0) {\n                    actIdxes[1] -= 1;\n                    isNavigate = true;\n                }\n                else {\n                    var content = this.parent.getMainContent();\n                    if (actIdxes[1] === 0 && content.scrollLeft && !isRtl) {\n                        content.scrollLeft = 0;\n                    }\n                }\n            }\n            else if ((!filterArgs.isFilterCell && !e.shiftKey && e.keyCode === 38) || (e.shiftKey && e.keyCode === 13)) { // Up key\n                if (actIdxes[0] > 0) {\n                    actIdxes[0] -= 1;\n                    isNavigate = true;\n                }\n                else {\n                    var content = this.parent.getMainContent();\n                    if (actIdxes[0] === 0 && content.scrollTop) {\n                        content.scrollTop = 0;\n                    }\n                }\n            }\n            else if ((!e.shiftKey && ((!isRtl && e.keyCode === 39) || (isRtl && e.keyCode === 37))) || e.keyCode === 9) { // Right key\n                var cell = getCell(actIdxes[0], actIdxes[1], sheet);\n                if (cell && cell.colSpan > 1) {\n                    actIdxes[1] += (cell.colSpan - 1);\n                }\n                if (actIdxes[1] < sheet.colCount - 1) {\n                    actIdxes[1] += 1;\n                    isNavigate = true;\n                }\n            }\n            else if ((!filterArgs.isFilterCell && !e.shiftKey && e.keyCode === 40) || e.keyCode === 13) { // Down Key\n                var cell = getCell(actIdxes[0], actIdxes[1], sheet);\n                if (cell && cell.rowSpan > 1) {\n                    actIdxes[0] += (cell.rowSpan - 1);\n                }\n                if (actIdxes[0] < sheet.rowCount - 1) {\n                    actIdxes[0] += 1;\n                    isNavigate = true;\n                }\n            }\n            /* else if (e.keyCode === 36) {\n                actIdxes[1] = 0;\n                if (e.ctrlKey) {\n                    actIdxes[0] = 0;\n                }\n                isNavigate = true;\n                e.preventDefault();\n            } else if (e.keyCode === 35 && e.ctrlKey) {\n                actIdxes = [sheet.usedRange.rowIndex, sheet.usedRange.colIndex];\n                scrollIdxes = [sheet.usedRange.rowIndex - this.parent.viewport.rowCount,\n                    sheet.usedRange.colIndex - this.parent.viewport.colCount];\n                isNavigate = true;\n                e.preventDefault();\n            } */\n            if (isNavigate) {\n                this.scrollNavigation(scrollIdxes || actIdxes, scrollIdxes ? true : false);\n                this.parent.setSheetPropertyOnMute(sheet, 'activeCell', getRangeAddress(actIdxes));\n                this.parent.notify(cellNavigate, { range: actIdxes });\n            }\n        }\n        var target = e.target;\n        if (target.classList.contains('e-sheet-rename')) {\n            if (e.keyCode === 32) {\n                e.stopPropagation();\n            }\n            else if (e.keyCode === 13 || e.keyCode === 27) {\n                this.parent.notify(renameSheet, e);\n            }\n        }\n    };\n    KeyboardNavigation.prototype.scrollNavigation = function (actIdxes, isScroll) {\n        var x = this.parent.enableRtl ? -1 : 1;\n        var cont = this.parent.getMainContent();\n        var sheet = this.parent.getActiveSheet();\n        var prevActIdxes = getCellIndexes(sheet.activeCell);\n        var topLeftIdxes = getCellIndexes(sheet.topLeftCell);\n        if (this.getBottomIdx(topLeftIdxes) <= actIdxes[0] || isScroll) {\n            cont.scrollTop += getRowHeight(sheet, actIdxes[0]);\n        }\n        else if (topLeftIdxes[0] > actIdxes[0]) {\n            cont.scrollTop -= getRowHeight(sheet, actIdxes[0]);\n        }\n        if (this.getRightIdx(topLeftIdxes) <= actIdxes[1] || isScroll) {\n            cont.scrollLeft += getColumnWidth(sheet, actIdxes[1]) * x;\n        }\n        else if (topLeftIdxes[1] > actIdxes[1]) {\n            cont.scrollLeft -= getColumnWidth(sheet, actIdxes[1]) * x;\n        }\n    };\n    KeyboardNavigation.prototype.getBottomIdx = function (topLeftIdxes) {\n        var hgt = 0;\n        var sheet = this.parent.getActiveSheet();\n        for (var i = topLeftIdxes[0];; i++) {\n            hgt += getRowHeight(sheet, i);\n            if (hgt >= this.parent.viewport.height - 17) {\n                return i;\n            }\n        }\n    };\n    KeyboardNavigation.prototype.getRightIdx = function (topLeftIdxes) {\n        var width = 0;\n        var sheet = this.parent.getActiveSheet();\n        var contWidth = this.parent.getMainContent().offsetWidth;\n        for (var i = topLeftIdxes[1];; i++) {\n            width += getColumnWidth(sheet, i);\n            if (width >= contWidth - 17) {\n                return i;\n            }\n        }\n    };\n    /**\n     * For internal use only - Get the module name.\n     * @private\n     */\n    KeyboardNavigation.prototype.getModuleName = function () {\n        return 'keyboardNavigation';\n    };\n    KeyboardNavigation.prototype.destroy = function () {\n        this.removeEventListener();\n        this.parent = null;\n    };\n    return KeyboardNavigation;\n}());\nexport { KeyboardNavigation };\n","import { keyDown, cut, paste, copy, clearCopy, performUndoRedo, initiateHyperlink, editHyperlink } from '../common/index';\nimport { findDlg, gotoDlg } from '../common/index';\nimport { setCellFormat, textDecorationUpdate, getCellIndexes } from '../../workbook/common/index';\nimport { getColumn, isLocked as isCellLocked } from '../../workbook/index';\nimport { setCell, getCell } from '../../workbook/base/cell';\nimport { isNullOrUndefined, closest, select } from '@syncfusion/ej2-base';\n/**\n * Represents keyboard shortcut support for Spreadsheet.\n */\nvar KeyboardShortcut = /** @class */ (function () {\n    /**\n     * Constructor for the Spreadsheet Keyboard Shortcut module.\n     * @private\n     */\n    function KeyboardShortcut(parent) {\n        this.parent = parent;\n        this.addEventListener();\n    }\n    KeyboardShortcut.prototype.addEventListener = function () {\n        this.parent.on(keyDown, this.keyDownHandler, this);\n    };\n    KeyboardShortcut.prototype.removeEventListener = function () {\n        if (!this.parent.isDestroyed) {\n            this.parent.off(keyDown, this.keyDownHandler);\n        }\n    };\n    KeyboardShortcut.prototype.keyDownHandler = function (e) {\n        if (e.ctrlKey || e.metaKey) {\n            if (!closest(e.target, '.e-find-dlg')) {\n                if ([79, 83, 65].indexOf(e.keyCode) > -1) {\n                    e.preventDefault();\n                }\n            }\n            if (e.keyCode === 79) {\n                select('#' + this.parent.element.id + '_fileUpload', this.parent.element).click();\n            }\n            else if (e.keyCode === 83) {\n                if (this.parent.saveUrl && this.parent.allowSave) {\n                    this.parent.save();\n                }\n            }\n            else if (e.keyCode === 67) {\n                this.parent.notify(copy, { promise: Promise });\n            }\n            else if (e.keyCode === 75) {\n                var sheet = this.parent.getActiveSheet();\n                var indexes = getCellIndexes(sheet.activeCell);\n                var row = this.parent.sheets[this.parent.getActiveSheet().id - 1].rows[indexes[0]];\n                var cell = void 0;\n                e.preventDefault();\n                if (!isNullOrUndefined(row)) {\n                    cell = row.cells[indexes[1]];\n                }\n                if (isNullOrUndefined(cell)) {\n                    setCell(indexes[0], indexes[1], this.parent.getActiveSheet(), cell, false);\n                }\n                if (cell && cell.hyperlink) {\n                    this.parent.notify(editHyperlink, null);\n                }\n                else {\n                    this.parent.notify(initiateHyperlink, null);\n                }\n            }\n            else if (e.keyCode === 90) { /* Ctrl + Z */\n                if (!this.parent.isEdit) {\n                    e.preventDefault();\n                    this.parent.notify(performUndoRedo, { isUndo: true });\n                }\n            }\n            else if (e.keyCode === 89) { /* Ctrl + Y */\n                if (!this.parent.isEdit) {\n                    e.preventDefault();\n                    this.parent.notify(performUndoRedo, { isUndo: false });\n                }\n            }\n            var actSheet = this.parent.sheets[this.parent.getActiveSheet().id - 1];\n            var actCell = actSheet.activeCell;\n            var actCellIndex = getCellIndexes(actCell);\n            var cellObj = getCell(actCellIndex[0], actCellIndex[1], actSheet);\n            var isLocked = actSheet.isProtected && isCellLocked(cellObj, getColumn(actSheet, actCellIndex[1]));\n            if (!isLocked || !actSheet.isProtected) {\n                if (e.keyCode === 70) {\n                    e.preventDefault();\n                    var toolBarElem = document.querySelector('.e-spreadsheet-find-ddb');\n                    if (!isNullOrUndefined(toolBarElem)) {\n                        toolBarElem.click();\n                    }\n                }\n                else if (e.keyCode === 71) {\n                    e.preventDefault();\n                    this.parent.notify(gotoDlg, null);\n                }\n                else if (e.keyCode === 72) {\n                    e.preventDefault();\n                    this.parent.notify(findDlg, null);\n                }\n                else if (e.keyCode === 88) {\n                    this.parent.notify(cut, { promise: Promise });\n                }\n                else if (e.keyCode === 86) {\n                    if (!isLocked) {\n                        this.parent.notify(paste, { isAction: true });\n                    }\n                }\n                else if (e.keyCode === 66) {\n                    e.preventDefault();\n                    var value = this.parent.getCellStyleValue(['fontWeight'], getCellIndexes(this.parent.getActiveSheet().activeCell)).fontWeight;\n                    value = value === 'bold' ? 'normal' : 'bold';\n                    this.parent.notify(setCellFormat, { style: { fontWeight: value }, onActionUpdate: true, refreshRibbon: true });\n                }\n                else if (e.keyCode === 73) {\n                    e.preventDefault();\n                    var value = this.parent.getCellStyleValue(['fontStyle'], getCellIndexes(this.parent.getActiveSheet().activeCell)).fontStyle;\n                    value = value === 'italic' ? 'normal' : 'italic';\n                    this.parent.notify(setCellFormat, { style: { fontStyle: value }, onActionUpdate: true, refreshRibbon: true });\n                }\n                else if (e.keyCode === 85) {\n                    e.preventDefault();\n                    this.parent.notify(textDecorationUpdate, { style: { textDecoration: 'underline' }, refreshRibbon: true });\n                }\n                else if (e.keyCode === 53) {\n                    e.preventDefault();\n                    this.parent.notify(textDecorationUpdate, { style: { textDecoration: 'line-through' }, refreshRibbon: true });\n                }\n                if (e.shiftKey) {\n                    if (e.keyCode === 76) { /* Ctrl + Shift + L */\n                        if (!this.parent.isEdit) {\n                            e.preventDefault();\n                            this.parent.applyFilter();\n                        }\n                    }\n                }\n            }\n        }\n        if (e.keyCode === 27) {\n            this.parent.notify(clearCopy, null);\n        }\n    };\n    KeyboardShortcut.prototype.getModuleName = function () {\n        return 'keyboardShortcut';\n    };\n    KeyboardShortcut.prototype.destroy = function () {\n        this.removeEventListener();\n        this.parent = null;\n    };\n    return KeyboardShortcut;\n}());\nexport { KeyboardShortcut };\n","import { clearViewer, beginAction } from '../../spreadsheet/index';\nimport { rowHeightChanged, setRowEleHeight, setMaxHgt, getTextHeight, getMaxHgt, getLines, initialLoad } from '../common/index';\nimport { getRowHeight, applyCellFormat } from '../../workbook/index';\nimport { isHiddenRow, getCell, getColumnWidth, getRangeIndexes, getSheetIndex, clearCFRule } from '../../workbook/index';\nimport { wrapEvent, getRangeAddress, clear } from '../../workbook/index';\nimport { removeClass, isNullOrUndefined } from '@syncfusion/ej2-base';\n/**\n * CellFormat module allows to format the cell styles.\n */\nvar CellFormat = /** @class */ (function () {\n    function CellFormat(parent) {\n        this.checkHeight = false;\n        this.parent = parent;\n        this.row = parent.createElement('tr', { className: 'e-row' });\n        this.parent.on(initialLoad, this.addEventListener, this);\n    }\n    CellFormat.prototype.applyCellFormat = function (args) {\n        var keys = Object.keys(args.style);\n        var sheet = this.parent.getActiveSheet();\n        if (args.lastCell && getMaxHgt(sheet, args.rowIdx) <= 20 && !keys.length) {\n            return;\n        }\n        var cell = args.cell || this.parent.getCell(args.rowIdx, args.colIdx);\n        if (cell) {\n            if (args.style.border !== undefined || args.style.borderTop !== undefined || args.style.borderLeft !== undefined) {\n                var curStyle_1 = {};\n                Object.keys(args.style).forEach(function (key) { curStyle_1[key] = args.style[key]; });\n                if (curStyle_1.border !== undefined) {\n                    Object.assign(cell.style, { borderRight: args.style.border, borderBottom: args.style.border });\n                    this.setLeftBorder(args.style.border, cell, args.rowIdx, args.colIdx, args.row, args.onActionUpdate, args.first);\n                    this.setTopBorder(args.style.border, cell, args.rowIdx, args.colIdx, args.pRow, args.pHRow, args.onActionUpdate, args.first, args.lastCell, args.manualUpdate);\n                    delete curStyle_1.border;\n                }\n                if (curStyle_1.borderTop !== undefined) {\n                    this.setTopBorder(args.style.borderTop, cell, args.rowIdx, args.colIdx, args.pRow, args.pHRow, args.onActionUpdate, args.first, args.lastCell, args.manualUpdate);\n                    delete curStyle_1.borderTop;\n                }\n                if (curStyle_1.borderLeft !== undefined) {\n                    this.setLeftBorder(args.style.borderLeft, cell, args.rowIdx, args.colIdx, args.row, args.onActionUpdate, args.first);\n                    delete curStyle_1.borderLeft;\n                }\n                if (Object.keys(curStyle_1).length) {\n                    if (curStyle_1.borderBottom !== undefined) {\n                        this.setThickBorderHeight(curStyle_1.borderBottom, args.rowIdx, args.colIdx, cell, args.row, args.hRow, args.onActionUpdate, args.lastCell, args.manualUpdate);\n                    }\n                    Object.assign(cell.style, curStyle_1);\n                }\n            }\n            else {\n                if (args.style.borderBottom !== undefined) {\n                    this.setThickBorderHeight(args.style.borderBottom, args.rowIdx, args.colIdx, cell, args.row, args.hRow, args.onActionUpdate, args.lastCell, args.manualUpdate);\n                }\n                Object.assign(cell.style, args.style);\n            }\n            if (args.isHeightCheckNeeded) {\n                if (!sheet.rows[args.rowIdx] || !sheet.rows[args.rowIdx].customHeight) {\n                    if (!args.manualUpdate) {\n                        var cellModel = getCell(args.rowIdx, args.colIdx, sheet);\n                        if (!(cellModel && cellModel.wrap) && this.isHeightCheckNeeded(args.style)) {\n                            setMaxHgt(sheet, args.rowIdx, args.colIdx, getTextHeight(this.parent, args.style));\n                        }\n                        if (args.lastCell) {\n                            var height = getMaxHgt(sheet, args.rowIdx);\n                            if (height > 20 && height > getRowHeight(sheet, args.rowIdx)) {\n                                setRowEleHeight(this.parent, sheet, height, args.rowIdx, args.row, args.hRow, false);\n                            }\n                        }\n                    }\n                    else {\n                        if (!this.checkHeight) {\n                            this.checkHeight = this.isHeightCheckNeeded(args.style, args.onActionUpdate);\n                        }\n                        var isFontSize = false;\n                        if (args.style.fontSize) {\n                            isFontSize = true;\n                        }\n                        if (cell && cell.children[0] && cell.children[0].className === 'e-cf-databar' && args.style.fontSize) {\n                            cell.children[0].querySelector('.e-databar-value').style.fontSize = args.style.fontSize;\n                        }\n                        this.updateRowHeight(args.rowIdx, args.colIdx, args.lastCell, args.onActionUpdate, 0, isFontSize);\n                    }\n                }\n            }\n        }\n        else {\n            this.updateRowHeight(args.rowIdx, args.colIdx, true, args.onActionUpdate);\n        }\n    };\n    CellFormat.prototype.updateRowHeight = function (rowIdx, colIdx, isLastCell, onActionUpdate, borderSize, isFontSize) {\n        if (borderSize === void 0) { borderSize = 0; }\n        if (this.checkHeight) {\n            var hgt = 0;\n            var maxHgt = void 0;\n            var sheet = this.parent.getActiveSheet();\n            var cell = getCell(rowIdx, colIdx, sheet);\n            var td = this.parent.getCell(rowIdx, colIdx);\n            hgt = getTextHeight(this.parent, (cell && cell.style) || this.parent.cellStyle, (cell && cell.wrap) ?\n                getLines(this.parent.getDisplayText(cell), getColumnWidth(sheet, colIdx), cell.style, this.parent.cellStyle) : 1);\n            if (cell && !isNullOrUndefined(cell.value)) {\n                var val = cell.value.toString();\n                if (val.indexOf('\\n') > -1) {\n                    var i = void 0;\n                    var splitVal = cell.value.split('\\n');\n                    var n = 0;\n                    var valLength = splitVal.length;\n                    for (i = 0; i < valLength; i++) {\n                        var lines = getLines(splitVal[i], getColumnWidth(sheet, colIdx), cell.style, this.parent.cellStyle);\n                        if (lines === 0) {\n                            lines = 1; // for empty new line\n                        }\n                        n = n + lines;\n                    }\n                    hgt = getTextHeight(this.parent, cell.style || this.parent.cellStyle, n) + 1;\n                }\n            }\n            if (hgt + borderSize < 20 && isFontSize && getMaxHgt(sheet, rowIdx) >= 20) {\n                hgt = 20; // default height\n            }\n            if (td && td.children[0] && td.children[0].className === 'e-cf-databar') {\n                td.children[0].style.height = '100%';\n                td.children[0].firstElementChild.nextElementSibling.style.height = '100%';\n            }\n            setMaxHgt(sheet, rowIdx, colIdx, hgt + borderSize);\n            if (isLastCell) {\n                this.checkHeight = false;\n                var row = this.parent.getRow(rowIdx);\n                if (!row) {\n                    return;\n                }\n                var prevHeight = getRowHeight(sheet, rowIdx);\n                maxHgt = getMaxHgt(sheet, rowIdx);\n                var heightChanged = onActionUpdate ? maxHgt !== prevHeight : maxHgt > prevHeight;\n                if (heightChanged) {\n                    setRowEleHeight(this.parent, sheet, maxHgt, rowIdx, row);\n                }\n            }\n        }\n    };\n    CellFormat.prototype.isHeightCheckNeeded = function (style, onActionUpdate) {\n        var keys = Object.keys(style);\n        return (onActionUpdate ? keys.indexOf('fontSize') > -1 : keys.indexOf('fontSize') > -1\n            && Number(style.fontSize.split('pt')[0]) > 12) || keys.indexOf('fontFamily') > -1;\n    };\n    CellFormat.prototype.setLeftBorder = function (border, cell, rowIdx, colIdx, row, actionUpdate, first) {\n        if (first && first.includes('Column')) {\n            return;\n        }\n        for (var j = 0; j < cell.rowSpan; j++) {\n            var prevCell = this.parent.getCell(rowIdx + j, colIdx - 1, row);\n            var i = 1;\n            while (prevCell && prevCell.style.display === 'none') {\n                prevCell = this.parent.getCell(rowIdx + j, colIdx - 1 - i, row);\n                i++;\n            }\n            if (prevCell) {\n                if (actionUpdate && border !== '' && colIdx === this.parent.viewport.leftIndex) {\n                    this.parent.getMainContent().scrollLeft -= this.getBorderSize(border);\n                }\n                prevCell.style.borderRight = (border === 'none') ? prevCell.style.borderRight : border;\n            }\n            else {\n                cell.style.borderLeft = border;\n            }\n        }\n    };\n    CellFormat.prototype.setTopBorder = function (border, cell, rowIdx, colIdx, pRow, pHRow, actionUpdate, first, lastCell, manualUpdate) {\n        if (first && first.includes('Row')) {\n            return;\n        }\n        for (var j = 0; j < cell.colSpan; j++) {\n            var prevCell = this.parent.getCell(rowIdx - 1, colIdx + j, pRow);\n            if (prevCell) {\n                if (isHiddenRow(this.parent.getActiveSheet(), rowIdx - 1)) {\n                    var index = [Number(prevCell.parentElement.getAttribute('aria-rowindex')) - 1, colIdx];\n                    if (this.parent.getCellStyleValue(['bottomPriority'], index).bottomPriority) {\n                        return;\n                    }\n                }\n                if (actionUpdate && border !== '' && this.parent.getActiveSheet().topLeftCell.includes(\"\" + (rowIdx + 1))) {\n                    this.parent.getMainContent().scrollTop -= this.getBorderSize(border);\n                }\n                this.setThickBorderHeight(border, rowIdx - 1, colIdx + j, prevCell, pRow, pHRow, actionUpdate, lastCell, manualUpdate);\n                prevCell.style.borderBottom = (border === 'none') ? prevCell.style.borderBottom : border;\n            }\n            else {\n                cell.style.borderTop = border;\n            }\n        }\n    };\n    CellFormat.prototype.setThickBorderHeight = function (border, rowIdx, colIdx, cell, row, hRow, actionUpdate, lastCell, manualUpdate) {\n        var size = border ? this.getBorderSize(border) : 1;\n        var sheet = this.parent.getActiveSheet();\n        if (size > 2 && (!sheet.rows[rowIdx] || !sheet.rows[rowIdx].customHeight)) {\n            if (manualUpdate) {\n                if (!this.checkHeight) {\n                    this.checkHeight = true;\n                }\n                this.updateRowHeight(rowIdx, colIdx, lastCell, actionUpdate, size);\n            }\n            else {\n                var prevHeight = getRowHeight(sheet, rowIdx);\n                var height = Math.ceil(this.parent.calculateHeight(this.parent.getCellStyleValue(['fontFamily', 'fontSize'], [rowIdx, colIdx]), 1, 3));\n                if (height > prevHeight) {\n                    setRowEleHeight(this.parent, sheet, height, rowIdx, row, hRow, false);\n                    this.parent.notify(rowHeightChanged, { rowIdx: rowIdx, threshold: height - 20 });\n                }\n            }\n        }\n        if (actionUpdate && (lastCell || !this.checkHeight) && size < 3 && (!sheet.rows[rowIdx] || !sheet.rows[rowIdx].customHeight)) {\n            if (!this.checkHeight) {\n                this.checkHeight = true;\n            }\n            this.updateRowHeight(rowIdx, colIdx, lastCell, actionUpdate, size);\n        }\n    };\n    CellFormat.prototype.getBorderSize = function (border) {\n        var size = border.split(' ')[0];\n        return size === 'thin' ? 1 : (size === 'medium' ? 2 : (size === 'thick' ? 3 :\n            (parseInt(size, 10) ? parseInt(size, 10) : 1)));\n    };\n    CellFormat.prototype.clearObj = function (args) {\n        var options = args.options;\n        var range = options.range ? (options.range.indexOf('!') > 0) ? options.range.split('!')[1] : options.range.split('!')[0]\n            : this.parent.getActiveSheet().selectedRange;\n        var sheetIndex = (options.range && options.range.indexOf('!') > 0) ?\n            getSheetIndex(this.parent, options.range.split('!')[0]) : this.parent.activeSheetIndex;\n        var rangeIdx = getRangeIndexes(range);\n        var sheet = this.parent.sheets[sheetIndex];\n        var sRIdx = rangeIdx[0];\n        var eRIdx = rangeIdx[2];\n        var sCIdx;\n        var eCIdx;\n        var eventArgs = { range: range, type: options.type, requestType: 'clear', sheetIndex: sheetIndex };\n        if (!args.isPublic) {\n            this.parent.notify(beginAction, { action: 'beforeClear', eventArgs: eventArgs });\n        }\n        if (options.type === 'Clear Formats' || options.type === 'Clear All') {\n            this.parent.notify(clearCFRule, { range: range, isPublic: false });\n            for (sRIdx; sRIdx <= eRIdx; sRIdx++) {\n                sCIdx = rangeIdx[1];\n                eCIdx = rangeIdx[3];\n                for (sCIdx; sCIdx <= eCIdx; sCIdx++) {\n                    var cell = getCell(sRIdx, sCIdx, sheet);\n                    var cellElem = this.parent.getCell(sRIdx, sCIdx);\n                    if (cell) {\n                        if (cell.wrap) {\n                            this.parent.notify(wrapEvent, { range: [sRIdx, sCIdx, sRIdx, sCIdx], wrap: false, sheet: sheet });\n                        }\n                        if (cell.hyperlink) {\n                            removeClass(cellElem.querySelectorAll('.e-hyperlink'), 'e-hyperlink-style');\n                            if (options.type === 'Clear All') {\n                                this.parent.removeHyperlink(getRangeAddress([sRIdx, sCIdx, sRIdx, sCIdx]));\n                            }\n                        }\n                    }\n                }\n            }\n        }\n        if (options.type === 'Clear Hyperlinks') {\n            this.parent.removeHyperlink(range);\n        }\n        this.parent.notify(clear, { range: sheet.name + '!' + range, type: options.type });\n        this.parent.serviceLocator.getService('cell').refreshRange(getRangeIndexes(range));\n        if (!args.isPublic) {\n            eventArgs = { range: sheet.name + '!' + range, type: options.type, sheetIndex: sheetIndex };\n            this.parent.notify('actionComplete', { eventArgs: eventArgs, action: 'clear' });\n        }\n    };\n    CellFormat.prototype.addEventListener = function () {\n        this.parent.on(applyCellFormat, this.applyCellFormat, this);\n        this.parent.on(clearViewer, this.clearObj, this);\n    };\n    CellFormat.prototype.removeEventListener = function () {\n        if (!this.parent.isDestroyed) {\n            this.parent.off(initialLoad, this.addEventListener);\n            this.parent.off(applyCellFormat, this.applyCellFormat);\n            this.parent.off(clearViewer, this.clearObj);\n        }\n    };\n    /**\n     * Destroy cell format module.\n     */\n    CellFormat.prototype.destroy = function () {\n        this.removeEventListener();\n        this.parent = null;\n        this.row = null;\n        this.checkHeight = null;\n    };\n    /**\n     * Get the cell format module name.\n     */\n    CellFormat.prototype.getModuleName = function () {\n        return 'cellformat';\n    };\n    return CellFormat;\n}());\nexport { CellFormat };\n","import { closest, EventHandler } from '@syncfusion/ej2-base';\nimport { colWidthChanged, rowHeightChanged, beforeHeaderLoaded, contentLoaded, hideShow, getFilterRange } from '../common/index';\nimport { findMaxValue, setResize, autoFit, completeAction, setAutoFit } from '../common/index';\nimport { setRowHeight, isHiddenRow, getRowHeight, getColumnWidth, setColumn, isHiddenCol } from '../../workbook/base/index';\nimport { getColumn, setRow, getCell } from '../../workbook/base/index';\nimport { getRangeIndexes, getSwapRange, getCellIndexes, setMerge } from '../../workbook/common/index';\n/**\n * The `Resize` module is used to handle the resizing functionalities in Spreadsheet.\n */\nvar Resize = /** @class */ (function () {\n    /**\n     * Constructor for resize module in Spreadsheet.\n     * @private\n     */\n    function Resize(parent) {\n        this.parent = parent;\n        this.addEventListener();\n    }\n    Resize.prototype.addEventListener = function () {\n        this.parent.on(contentLoaded, this.wireEvents, this);\n        this.parent.on(beforeHeaderLoaded, this.wireEvents, this);\n        this.parent.on(autoFit, this.autoFit, this);\n        this.parent.on(setAutoFit, this.setAutoFitHandler, this);\n    };\n    Resize.prototype.autoFit = function (args) {\n        var element = args.isRow ? this.parent.getRowHeaderTable() : this.parent.getColHeaderTable().rows[0];\n        for (var i = args.startIndex; i <= args.endIndex; i++) {\n            this.trgtEle = args.isRow ? this.parent.getRow(i, element) :\n                this.parent.getCell(null, i, element);\n            this.setAutofit(i, !args.isRow);\n        }\n    };\n    Resize.prototype.wireEvents = function (args) {\n        if (this.parent.getActiveSheet().showHeaders) {\n            var rowHeader = args ? args.element : this.parent.getRowHeaderContent();\n            var colHeader = this.parent.getColumnHeaderContent();\n            EventHandler.add(colHeader, 'dblclick', this.dblClickHandler, this);\n            EventHandler.add(rowHeader, 'dblclick', this.dblClickHandler, this);\n            EventHandler.add(colHeader, 'mousedown', this.mouseDownHandler, this);\n            EventHandler.add(rowHeader, 'mousedown', this.mouseDownHandler, this);\n            this.wireResizeCursorEvent(rowHeader, colHeader);\n        }\n    };\n    Resize.prototype.wireResizeCursorEvent = function (rowHeader, colHeader) {\n        EventHandler.add(rowHeader, 'mousemove', this.setTarget, this);\n        EventHandler.add(colHeader, 'mousemove', this.setTarget, this);\n    };\n    Resize.prototype.unWireResizeCursorEvent = function () {\n        EventHandler.remove(this.parent.getRowHeaderContent(), 'mousemove', this.setTarget);\n        EventHandler.remove(this.parent.getColumnHeaderContent(), 'mousemove', this.setTarget);\n    };\n    Resize.prototype.unwireEvents = function () {\n        if (this.parent.getActiveSheet().showHeaders) {\n            EventHandler.remove(this.parent.getColumnHeaderContent(), 'dblclick', this.dblClickHandler);\n            EventHandler.remove(this.parent.getRowHeaderContent(), 'dblclick', this.dblClickHandler);\n            EventHandler.remove(this.parent.getColumnHeaderContent(), 'mousedown', this.mouseDownHandler);\n            EventHandler.remove(this.parent.getRowHeaderContent(), 'mousedown', this.mouseDownHandler);\n            this.unWireResizeCursorEvent();\n        }\n    };\n    Resize.prototype.removeEventListener = function () {\n        if (!this.parent.isDestroyed) {\n            this.parent.off(contentLoaded, this.wireEvents);\n            this.parent.off(beforeHeaderLoaded, this.wireEvents);\n            this.parent.off(autoFit, this.autoFit);\n            this.parent.off(setAutoFit, this.setAutoFitHandler);\n        }\n    };\n    Resize.prototype.mouseMoveHandler = function (e) {\n        var sheetPanel = this.parent.element.getElementsByClassName('e-sheet-panel')[0];\n        var colResizeHandler = this.parent.element.getElementsByClassName('e-colresize-handler')[0];\n        var rowResizeHandler = this.parent.element.getElementsByClassName('e-rowresize-handler')[0];\n        if (colResizeHandler || rowResizeHandler) {\n            this.isMouseMoved = true;\n            if (colResizeHandler) {\n                if (e.x > this.trgtEle.parentElement.firstChild.getBoundingClientRect().left) {\n                    colResizeHandler.style.left = e.clientX - this.parent.element.getBoundingClientRect().left + 'px';\n                }\n            }\n            else if (rowResizeHandler) {\n                if (e.y >= this.trgtEle.parentElement.parentElement.firstChild.getBoundingClientRect().top) {\n                    rowResizeHandler.style.top = e.clientY - sheetPanel.getBoundingClientRect().top + 'px';\n                }\n            }\n        }\n    };\n    Resize.prototype.mouseDownHandler = function (e) {\n        this.event = e;\n        this.trgtEle = e.target;\n        if (this.trgtEle.parentElement.classList.contains('e-hide-end') || this.trgtEle.classList.contains('e-hide-end')) {\n            var offsetSize = this.trgtEle.offsetHeight;\n            var offset = e.offsetY;\n            if ((offsetSize >= 10 && offset < 5) || (offsetSize - 2 < 8 && offset < Math.ceil((offset - 2) / 2))) {\n                this.trgtEle.classList.add('e-skip-resize');\n            }\n        }\n        this.updateTarget(e, this.trgtEle);\n        var trgt = this.trgtEle;\n        var className = trgt.classList.contains('e-colresize') ? 'e-colresize-handler' :\n            trgt.classList.contains('e-rowresize') ? 'e-rowresize-handler' : '';\n        this.createResizeHandler(trgt, className);\n        this.unWireResizeCursorEvent();\n        EventHandler.add(this.parent.element, 'mousemove', this.mouseMoveHandler, this);\n        EventHandler.add(document, 'mouseup', this.mouseUpHandler, this);\n    };\n    Resize.prototype.mouseUpHandler = function (e) {\n        var colResizeHandler = this.parent.element.getElementsByClassName('e-colresize-handler')[0];\n        var rowResizeHandler = this.parent.element.getElementsByClassName('e-rowresize-handler')[0];\n        this.resizeOn(e);\n        this.isMouseMoved = null;\n        var resizeHandler = colResizeHandler ? colResizeHandler : rowResizeHandler;\n        if (resizeHandler) {\n            this.parent.element.getElementsByClassName('e-sheet-panel')[0].removeChild(resizeHandler);\n            this.updateCursor(e);\n        }\n        EventHandler.remove(document, 'mouseup', this.mouseUpHandler);\n        EventHandler.remove(this.parent.element, 'mousemove', this.mouseMoveHandler);\n        this.wireResizeCursorEvent(this.parent.getRowHeaderContent(), this.parent.getColumnHeaderContent());\n    };\n    Resize.prototype.dblClickHandler = function (e) {\n        this.trgtEle = e.target;\n        this.updateTarget(e, this.trgtEle);\n        if (this.trgtEle.classList.contains('e-colresize')) {\n            var colIndx = parseInt(this.trgtEle.getAttribute('aria-colindex'), 10) - 1;\n            var prevWidth = getColumnWidth(this.parent.getActiveSheet(), colIndx) + \"px\";\n            if (this.trgtEle.classList.contains('e-unhide-column')) {\n                this.showHiddenColumns(colIndx - 1);\n            }\n            else {\n                this.setAutofit(colIndx, true, prevWidth);\n            }\n        }\n        else if (this.trgtEle.classList.contains('e-rowresize')) {\n            var rowIndx = parseInt(this.trgtEle.parentElement.getAttribute('aria-rowindex'), 10) - 1;\n            var prevHeight = getRowHeight(this.parent.getActiveSheet(), rowIndx) + \"px\";\n            this.setAutofit(rowIndx, false, prevHeight);\n        }\n    };\n    Resize.prototype.setTarget = function (e) {\n        var trgt = e.target;\n        var sheet = this.parent.getActiveSheet();\n        if (sheet.isProtected && (!sheet.protectSettings.formatColumns || !sheet.protectSettings.formatRows)) {\n            if (!sheet.protectSettings.formatRows && !sheet.protectSettings.formatColumns) {\n                return;\n            }\n            if (sheet.protectSettings.formatRows) {\n                if (closest(trgt, '.e-colhdr-table')) {\n                    return;\n                }\n            }\n            if (sheet.protectSettings.formatColumns) {\n                if (closest(trgt, '.e-rowhdr-table')) {\n                    return;\n                }\n            }\n        }\n        var newTrgt;\n        var tOffsetV;\n        var eOffsetV;\n        var tClass;\n        if (closest(trgt, '.e-header-row')) {\n            eOffsetV = e.offsetX;\n            tOffsetV = trgt.offsetWidth;\n            tClass = 'e-colresize';\n            if (trgt.previousElementSibling) {\n                newTrgt = trgt.previousElementSibling;\n            }\n            else {\n                if (Number(trgt.getAttribute('aria-colindex')) > 1) {\n                    newTrgt = trgt;\n                }\n            }\n        }\n        else if (closest(trgt, '.e-row')) {\n            eOffsetV = e.offsetY;\n            tOffsetV = trgt.offsetHeight;\n            tClass = 'e-rowresize';\n            if (trgt.parentElement.previousElementSibling) {\n                newTrgt = trgt.parentElement.previousElementSibling.firstElementChild;\n            }\n            else {\n                if (Number(trgt.parentElement.getAttribute('aria-rowindex')) > 1) {\n                    newTrgt = trgt;\n                }\n            }\n        }\n        if (tOffsetV - 2 < 8 && eOffsetV !== Math.ceil((tOffsetV - 2) / 2)) {\n            if (eOffsetV < Math.ceil((tOffsetV - 2) / 2)) {\n                trgt.classList.add(tClass);\n                newTrgt.classList.add(tClass);\n            }\n            else if (eOffsetV > Math.ceil((tOffsetV - 2) / 2)) {\n                trgt.classList.add(tClass);\n            }\n        }\n        else if (tOffsetV - 5 < eOffsetV && eOffsetV <= tOffsetV && tOffsetV >= 10) {\n            trgt.classList.add(tClass);\n        }\n        else if (eOffsetV < 5 && newTrgt && tOffsetV >= 10) {\n            trgt.classList.add(tClass);\n            newTrgt.classList.add(tClass);\n        }\n        else {\n            var resEle = (tClass === 'e-colresize' ? trgt.parentElement.getElementsByClassName(tClass)\n                : this.parent.getRowHeaderTable().getElementsByClassName(tClass));\n            for (var index = 0; index < resEle.length; index++) {\n                resEle[index].classList.remove(tClass);\n            }\n        }\n    };\n    Resize.prototype.updateTarget = function (e, trgt) {\n        if (closest(trgt, '.e-header-row')) {\n            if ((trgt.offsetWidth < 10 && e.offsetX < Math.ceil((trgt.offsetWidth - 2) / 2)) || (e.offsetX < 5 &&\n                trgt.offsetWidth >= 10) && trgt.classList.contains('e-colresize')) {\n                var sheet = this.parent.getActiveSheet();\n                var prevIdx = Number(this.trgtEle.getAttribute('aria-colindex')) - 2;\n                if (trgt.previousElementSibling && !isHiddenCol(sheet, prevIdx)) {\n                    this.trgtEle = trgt.previousElementSibling;\n                }\n                else {\n                    if (prevIdx > -1) {\n                        this.trgtEle.classList.add('e-unhide-column');\n                    }\n                }\n            }\n        }\n        else {\n            if ((trgt.offsetHeight < 10 && e.offsetY < Math.ceil((trgt.offsetHeight - 2) / 2)) || (e.offsetY < 5 &&\n                trgt.offsetHeight >= 10) && trgt.classList.contains('e-rowresize')) {\n                var sheet = this.parent.getActiveSheet();\n                var prevIdx = Number(trgt.parentElement.getAttribute('aria-rowindex')) - 2;\n                if (trgt.parentElement.previousElementSibling || isHiddenRow(sheet, prevIdx)) {\n                    if (e.type === 'dblclick' && isHiddenRow(sheet, prevIdx)) {\n                        var selectRange = getSwapRange(getRangeIndexes(this.parent.getActiveSheet().selectedRange));\n                        var eventArgs = void 0;\n                        if (prevIdx <= selectRange[2] && prevIdx > selectRange[0]) {\n                            eventArgs = { startIndex: selectRange[0], endIndex: selectRange[2], hide: false, autoFit: true };\n                        }\n                        else {\n                            eventArgs = { startIndex: prevIdx, endIndex: prevIdx, hide: false, autoFit: true };\n                        }\n                        this.parent.notify(hideShow, eventArgs);\n                    }\n                    else {\n                        if (!isHiddenRow(sheet, prevIdx)) {\n                            this.trgtEle = trgt.parentElement.previousElementSibling.getElementsByClassName('e-header-cell')[0];\n                        }\n                    }\n                }\n            }\n        }\n    };\n    Resize.prototype.setAutoFitHandler = function (args) {\n        this.setAutofit(args.idx, args.isCol);\n    };\n    // tslint:disable-next-line:max-func-body-length\n    Resize.prototype.setAutofit = function (idx, isCol, prevData) {\n        var index = 0;\n        var sheet = this.parent.getActiveSheet();\n        var mainContent = this.parent.getMainContent();\n        var oldValue = isCol ? getColumnWidth(this.parent.getActiveSheet(), idx) + \"px\" :\n            getRowHeight(this.parent.getActiveSheet(), idx) + \"px\";\n        var contentClone = [];\n        var contentTable = mainContent.getElementsByClassName('e-content-table')[0];\n        if (this.parent.getActiveSheet().showHeaders) {\n            var headerTable = isCol ? this.parent.getColHeaderTable() : this.parent.getRowHeaderTable();\n            var headerRow = headerTable.getElementsByTagName('tr');\n        }\n        var headerText;\n        var isWrap = false;\n        if (isCol) {\n            var rowLength = sheet.rows.length;\n            for (var rowIdx = 0; rowIdx < rowLength; rowIdx++) {\n                if (sheet.rows[rowIdx] && sheet.rows[rowIdx].cells && sheet.rows[rowIdx].cells[idx]) {\n                    if (getCell(rowIdx, idx, sheet).wrap) {\n                        isWrap = true;\n                    }\n                    var td = this.parent.createElement('td', { className: 'e-cell' });\n                    td.textContent = this.parent.getDisplayText(sheet.rows[rowIdx].cells[idx]);\n                    if (sheet.rows[rowIdx].cells[idx].style) {\n                        var style = sheet.rows[rowIdx].cells[idx].style;\n                        if (style.fontFamily) {\n                            td.style.fontFamily = style.fontFamily;\n                        }\n                        if (style.fontSize) {\n                            td.style.fontSize = style.fontSize;\n                        }\n                    }\n                    contentClone[index] = td;\n                    index++;\n                }\n            }\n        }\n        else {\n            var colLength = sheet.rows[idx] && sheet.rows[idx].cells ? sheet.rows[idx].cells.length : 0;\n            for (var colIdx = 0; colIdx < colLength; colIdx++) {\n                if (sheet.rows[idx] && sheet.rows[idx].cells[colIdx]) {\n                    if (getCell(idx, colIdx, sheet).wrap) {\n                        isWrap = true;\n                    }\n                    var style = sheet.rows[idx].cells[colIdx].style;\n                    var td = this.parent.createElement('td');\n                    td.textContent = this.parent.getDisplayText(sheet.rows[idx].cells[colIdx]);\n                    if (sheet.rows[idx].cells[colIdx].style) {\n                        var style_1 = sheet.rows[idx].cells[colIdx].style;\n                        if (style_1.fontFamily) {\n                            td.style.fontFamily = style_1.fontFamily;\n                        }\n                        if (style_1.fontSize) {\n                            td.style.fontSize = style_1.fontSize;\n                        }\n                    }\n                    contentClone[index] = td;\n                    index++;\n                }\n            }\n        }\n        var contentFit = findMaxValue(contentTable, contentClone, isCol, this.parent, prevData, isWrap);\n        if (isCol) {\n            contentFit = this.getFloatingElementWidth(contentFit, idx);\n        }\n        var autofitValue = contentFit === 0 ? parseInt(oldValue, 10) : contentFit;\n        var threshold = parseInt(oldValue, 10) > autofitValue ?\n            -(parseInt(oldValue, 10) - autofitValue) : autofitValue - parseInt(oldValue, 10);\n        if (isCol) {\n            if (idx >= this.parent.viewport.leftIndex && idx <= this.parent.viewport.rightIndex) {\n                getColumn(sheet, idx).width = autofitValue > 0 ? autofitValue : 0;\n                this.parent.notify(colWidthChanged, { threshold: threshold, colIdx: idx });\n                this.resizeStart(idx, this.parent.getViewportIndex(idx, true), autofitValue + 'px', isCol, true, prevData);\n            }\n            else {\n                var oldWidth = getColumnWidth(sheet, idx);\n                var threshold_1;\n                if (autofitValue > 0) {\n                    threshold_1 = -(oldWidth - autofitValue);\n                }\n                else {\n                    threshold_1 = -oldWidth;\n                }\n                this.parent.notify(colWidthChanged, { threshold: threshold_1, colIdx: idx });\n                getColumn(sheet, idx).width = autofitValue > 0 ? autofitValue : 0;\n            }\n        }\n        else if (!isCol) {\n            if (idx >= this.parent.viewport.topIndex && idx <= this.parent.viewport.bottomIndex) {\n                autofitValue = autofitValue > 20 ? autofitValue : 20;\n                setRowHeight(sheet, idx, autofitValue > 0 ? autofitValue : 0);\n                this.parent.notify(rowHeightChanged, { threshold: threshold, rowIdx: idx });\n                this.resizeStart(idx, this.parent.getViewportIndex(idx), autofitValue + 'px', isCol, true, prevData);\n            }\n            else {\n                var oldHeight = getRowHeight(sheet, idx);\n                var threshold_2;\n                if (autofitValue > 0) {\n                    threshold_2 = -(oldHeight - autofitValue);\n                }\n                else {\n                    threshold_2 = -oldHeight;\n                }\n                this.parent.notify(rowHeightChanged, { threshold: threshold_2, rowIdx: idx });\n                setRowHeight(sheet, idx, autofitValue > 0 ? autofitValue : 0);\n            }\n        }\n    };\n    Resize.prototype.createResizeHandler = function (trgt, className) {\n        var editor = this.parent.createElement('div', { className: className });\n        if (trgt.classList.contains('e-colresize')) {\n            editor.style.height = this.parent.getMainContent().clientHeight + trgt.offsetHeight + 'px';\n            editor.style.left = this.event.clientX - this.parent.element.getBoundingClientRect().left + 'px';\n            editor.style.top = '0px';\n        }\n        else if (trgt.classList.contains('e-rowresize')) {\n            editor.style.width = this.parent.getMainContent().clientWidth + trgt.offsetWidth + 'px';\n            editor.style.left = '0px';\n            editor.style.top = this.event.clientY\n                - this.parent.element.getElementsByClassName('e-sheet-panel')[0].getBoundingClientRect().top + 'px';\n        }\n        this.parent.element.getElementsByClassName('e-sheet-panel')[0].appendChild(editor);\n        this.updateCursor(this.event);\n    };\n    Resize.prototype.setColWidth = function (index, viewportIdx, width, curWidth) {\n        var sheet = this.parent.getActiveSheet();\n        var threshold = width - curWidth;\n        if (threshold < 0 && curWidth < -(threshold)) {\n            threshold = -curWidth;\n        }\n        if (width > 0) {\n            if (this.isMouseMoved && this.trgtEle.classList.contains('e-unhide-column')) {\n                this.showHiddenColumns(index, width);\n                this.parent.notify(completeAction, {\n                    eventArgs: {\n                        index: index, width: 0 + \"px\", isCol: true, sheetIdx: this.parent.activeSheetIndex, oldWidth: curWidth + \"px\",\n                        hide: false\n                    }, action: 'resize'\n                });\n                return;\n            }\n            this.parent.notify(colWidthChanged, { threshold: threshold, colIdx: index });\n            this.resizeStart(index, viewportIdx, width + \"px\", true, false, curWidth + \"px\");\n            setColumn(sheet, index, { width: width, customWidth: true });\n        }\n        else {\n            if (this.isMouseMoved) {\n                this.parent.hideColumn(index);\n                this.parent.notify(completeAction, {\n                    eventArgs: {\n                        index: index, width: 0 + \"px\", isCol: true, sheetIdx: this.parent.activeSheetIndex, oldWidth: curWidth + \"px\",\n                        hide: true\n                    }, action: 'resize'\n                });\n            }\n        }\n    };\n    Resize.prototype.showHiddenColumns = function (index, width) {\n        var sheet = this.parent.getActiveSheet();\n        var selectedRange = getRangeIndexes(sheet.selectedRange);\n        var startIdx;\n        var endIdx;\n        var colgroup;\n        if (index >= selectedRange[1] && index <= selectedRange[3] && selectedRange[2] === sheet.rowCount - 1 &&\n            getCellIndexes(sheet.activeCell)[0] === getCellIndexes(sheet.topLeftCell)[0]) {\n            startIdx = selectedRange[1];\n            endIdx = selectedRange[3];\n            colgroup = this.parent.getMainContent().querySelector('colgroup');\n        }\n        else {\n            startIdx = endIdx = index;\n        }\n        if (width !== undefined) {\n            for (var i = startIdx; i <= endIdx; i++) {\n                setColumn(sheet, i, { width: width, customWidth: true });\n                if (i >= this.parent.viewport.leftIndex && i <= this.parent.viewport.rightIndex && !isHiddenCol(sheet, i)) {\n                    colgroup.children[this.parent.getViewportIndex(i, true)].style.width = width + \"px\";\n                }\n            }\n        }\n        this.trgtEle.classList.remove('e-unhide-column');\n        this.parent.hideColumn(startIdx, endIdx, false);\n        if (width === undefined) {\n            this.autoFit({ isRow: false, startIndex: startIdx, endIndex: endIdx });\n        }\n    };\n    Resize.prototype.setRowHeight = function (rowIdx, viewportIdx, height, prevData) {\n        var sheet = this.parent.getActiveSheet();\n        var eleHeight = parseInt(this.parent.getMainContent().getElementsByTagName('tr')[viewportIdx].style.height, 10);\n        var rowHeight = height;\n        var threshold = parseInt(rowHeight, 10) - eleHeight;\n        if (threshold < 0 && eleHeight < -(threshold)) {\n            threshold = -eleHeight;\n        }\n        this.parent.notify(rowHeightChanged, { threshold: threshold, rowIdx: rowIdx, isCustomHgt: true });\n        this.resizeStart(rowIdx, viewportIdx, rowHeight, false, false, prevData);\n        setRow(sheet, rowIdx, { height: parseInt(rowHeight, 10) > 0 ? parseInt(rowHeight, 10) : 0, customHeight: true });\n    };\n    Resize.prototype.resizeOn = function (e) {\n        var _this = this;\n        var idx;\n        var actualIdx;\n        if (this.trgtEle.classList.contains('e-rowresize')) {\n            var sheet = this.parent.getActiveSheet();\n            var prevIdx = Number(this.trgtEle.parentElement.getAttribute('aria-rowindex')) - 2;\n            if (this.isMouseMoved && isHiddenRow(sheet, prevIdx) && this.trgtEle.classList.contains('e-skip-resize') &&\n                e.clientY > this.trgtEle.getBoundingClientRect().top) {\n                this.trgtEle.classList.remove('e-skip-resize');\n                var eventArgs = { startIndex: prevIdx, endIndex: prevIdx, hide: false, skipAppend: true };\n                this.parent.notify(hideShow, eventArgs);\n                var rTbody = this.parent.getRowHeaderTable().tBodies[0];\n                var tbody = this.parent.getContentTable().tBodies[0];\n                eventArgs.hdrRow.style.display = 'none';\n                eventArgs.row.style.display = 'none';\n                rTbody.insertBefore(eventArgs.hdrRow, rTbody.children[eventArgs.insertIdx]);\n                tbody.insertBefore(eventArgs.row, tbody.children[eventArgs.insertIdx]);\n                this.trgtEle = eventArgs.hdrRow.firstElementChild;\n                eventArgs.hdrRow.nextElementSibling.classList.remove('e-hide-end');\n                eventArgs.mergeCollection.forEach(function (mergeArgs) { _this.parent.notify(setMerge, mergeArgs); });\n            }\n            else {\n                if (this.trgtEle.classList.contains('e-skip-resize')) {\n                    this.trgtEle.classList.remove('e-skip-resize');\n                    if ((!this.isMouseMoved && isHiddenRow(sheet, prevIdx)) || !this.trgtEle.parentElement.previousElementSibling) {\n                        return;\n                    }\n                    this.trgtEle = this.trgtEle.parentElement.previousElementSibling.getElementsByClassName('e-header-cell')[0];\n                }\n            }\n            actualIdx = idx = parseInt(this.trgtEle.parentElement.getAttribute('aria-rowindex'), 10) - 1;\n            idx = this.parent.getViewportIndex(actualIdx);\n            var prevData = this.parent.getMainContent().getElementsByClassName('e-row')[idx].style.height;\n            var rowHeight = e.clientY - this.event.clientY + parseInt(prevData, 10);\n            if (rowHeight <= 0) {\n                this.parent.hideRow(actualIdx);\n                setRow(sheet, actualIdx, { height: 0, customHeight: true });\n                this.parent.notify(completeAction, {\n                    eventArgs: { index: actualIdx, height: '0px', isCol: false, sheetIdx: this.parent.activeSheetIndex, oldHeight: prevData },\n                    action: 'resize'\n                });\n                return;\n            }\n            this.setRowHeight(actualIdx, idx, rowHeight + \"px\", prevData);\n            if (this.trgtEle.parentElement.style.display === 'none') {\n                var sheet_1 = this.parent.getActiveSheet();\n                var selectedRange = getSwapRange(getRangeIndexes(sheet_1.selectedRange));\n                if (actualIdx <= selectedRange[2] && actualIdx > selectedRange[0]) {\n                    rowHeight = sheet_1.rows[actualIdx].height;\n                    var count = void 0;\n                    for (var i = selectedRange[0]; i <= selectedRange[2]; i++) {\n                        if (i === actualIdx) {\n                            continue;\n                        }\n                        prevData = getRowHeight(sheet_1, i) + \"px\";\n                        setRow(sheet_1, i, { customHeight: true, height: rowHeight });\n                        if (isHiddenRow(sheet_1, i)) {\n                            if (!count) {\n                                count = i;\n                            }\n                        }\n                        else {\n                            this.parent.getRow(i).style.height = rowHeight + \"px\";\n                            if (sheet_1.showHeaders) {\n                                this.parent.getRow(i, this.parent.getRowHeaderTable()).style.height = rowHeight + \"px\";\n                            }\n                        }\n                        this.parent.notify(completeAction, {\n                            eventArgs: {\n                                index: i, height: rowHeight + \"px\", isCol: false,\n                                sheetIdx: this.parent.activeSheetIndex, oldHeight: prevData\n                            },\n                            action: 'resize'\n                        });\n                    }\n                    this.parent.hideRow(selectedRange[0], actualIdx - 1, false);\n                    idx += Math.abs(actualIdx - count);\n                }\n                else {\n                    if (idx !== 0 && !isHiddenRow(sheet_1, actualIdx - 1)) {\n                        this.trgtEle.parentElement.previousElementSibling.classList.remove('e-hide-start');\n                    }\n                    else {\n                        if (idx !== 0) {\n                            this.trgtEle.parentElement.classList.add('e-hide-end');\n                        }\n                    }\n                    this.parent.selectRange(sheet_1.selectedRange);\n                }\n                this.trgtEle.parentElement.style.display = '';\n                this.parent.getContentTable().rows[idx].style.display = '';\n            }\n        }\n        else if (this.trgtEle.classList.contains('e-colresize')) {\n            if (this.isMouseMoved && this.trgtEle.classList.contains('e-unhide-column') &&\n                e.clientX < this.trgtEle.getBoundingClientRect().left) {\n                this.trgtEle.classList.remove('e-unhide-column');\n                if (this.trgtEle.previousElementSibling) {\n                    this.trgtEle = this.trgtEle.previousElementSibling;\n                }\n            }\n            idx = parseInt(this.trgtEle.getAttribute('aria-colindex'), 10) - 1;\n            var curWidth = void 0;\n            if (this.trgtEle.classList.contains('e-unhide-column')) {\n                idx -= 1;\n                curWidth = 0;\n            }\n            else {\n                curWidth = getColumnWidth(this.parent.getActiveSheet(), idx);\n            }\n            this.setColWidth(idx, this.parent.getViewportIndex(idx, true), (e.clientX - this.event.clientX) + curWidth, curWidth);\n        }\n    };\n    Resize.prototype.setWidthAndHeight = function (trgt, value, isCol) {\n        if (isCol) {\n            trgt.style.width = parseInt(trgt.style.width, 10) + value + 'px';\n        }\n        else {\n            trgt.style.height = parseInt(trgt.style.height, 10) + value + 'px';\n        }\n    };\n    Resize.prototype.resizeStart = function (idx, viewportIdx, value, isCol, isFit, prevData) {\n        if (this.parent.getActiveSheet().showHeaders) {\n            setResize(viewportIdx, value, isCol, this.parent);\n        }\n        else {\n            if (isCol) {\n                var curEle = this.parent.element.getElementsByClassName('e-sheet-content')[0].getElementsByTagName('col')[viewportIdx];\n                curEle.style.width = value;\n            }\n            else {\n                var curEle = this.parent.element.getElementsByClassName('e-sheet-content')[0].getElementsByTagName('tr')[viewportIdx];\n                curEle.style.height = value;\n            }\n        }\n        var action = isFit ? 'resizeToFit' : 'resize';\n        var eventArgs;\n        var isAction;\n        if (isCol) {\n            eventArgs = { index: idx, width: value, isCol: isCol, sheetIdx: this.parent.activeSheetIndex, oldWidth: prevData };\n            isAction = prevData !== value;\n        }\n        else {\n            eventArgs = { index: idx, height: value, isCol: isCol, sheetIdx: this.parent.activeSheetIndex, oldHeight: prevData };\n            isAction = prevData !== value;\n        }\n        if (isAction) {\n            this.parent.notify(completeAction, { eventArgs: eventArgs, action: action });\n        }\n    };\n    Resize.prototype.updateCursor = function (e) {\n        if (this.parent.element.getElementsByClassName('e-colresize-handler')[0]) {\n            this.parent.element.classList.add('e-col-resizing');\n        }\n        else if (this.parent.element.classList.contains('e-col-resizing')) {\n            this.parent.element.classList.remove('e-col-resizing');\n        }\n        if (this.parent.element.getElementsByClassName('e-rowresize-handler')[0]) {\n            this.parent.element.classList.add('e-row-resizing');\n        }\n        else if (this.parent.element.classList.contains('e-row-resizing')) {\n            this.parent.element.classList.remove('e-row-resizing');\n        }\n    };\n    // To get the floating element width like filter\n    Resize.prototype.getFloatingElementWidth = function (oldWidth, colIdx) {\n        var floatingWidth = oldWidth;\n        var eventArgs = { filterRange: [], hasFilter: false };\n        this.parent.notify(getFilterRange, eventArgs);\n        if (eventArgs.hasFilter && eventArgs.filterRange) {\n            if (eventArgs.filterRange[1] <= colIdx && eventArgs.filterRange[3] >= colIdx) {\n                floatingWidth = oldWidth + 22; // default width and padding for button \n            }\n        }\n        return floatingWidth;\n    };\n    /**\n     * To destroy the resize module.\n     * @return {void}\n     */\n    Resize.prototype.destroy = function () {\n        this.unwireEvents();\n        this.removeEventListener();\n        this.parent = null;\n    };\n    /**\n     * Get the module name.\n     * @returns string\n     */\n    Resize.prototype.getModuleName = function () {\n        return 'resize';\n    };\n    return Resize;\n}());\nexport { Resize };\n","import { collaborativeUpdate, updateAction } from '../common/index';\n/**\n * Collaborative Editing module for real time changes in the Spreadsheet.\n */\nvar CollaborativeEditing = /** @class */ (function () {\n    function CollaborativeEditing(parent) {\n        this.parent = parent;\n        this.addEventListener();\n    }\n    CollaborativeEditing.prototype.refreshClients = function (options) {\n        updateAction(options, this.parent);\n    };\n    CollaborativeEditing.prototype.addEventListener = function () {\n        this.parent.on(collaborativeUpdate, this.refreshClients, this);\n    };\n    CollaborativeEditing.prototype.removeEventListener = function () {\n        if (!this.parent.isDestroyed) {\n            this.parent.off(collaborativeUpdate, this.refreshClients);\n        }\n    };\n    /**\n     * Destroy collaborative editing module.\n     */\n    CollaborativeEditing.prototype.destroy = function () {\n        this.removeEventListener();\n        this.parent = null;\n    };\n    /**\n     * Get the collaborative editing module name.\n     */\n    CollaborativeEditing.prototype.getModuleName = function () {\n        return 'collaborativeEditing';\n    };\n    return CollaborativeEditing;\n}());\nexport { CollaborativeEditing };\n","import { spreadsheetDestroyed, getUpdateUsingRaf } from '../common/index';\nimport { autoFit, hideShow, virtualContentLoaded, completeAction, setScrollEvent, onContentScroll, skipHiddenIdx } from '../common/index';\nimport { beginAction, hiddenMerge, updateTableWidth } from '../common/index';\nimport { getCellAddress, isHiddenRow, setRow, setColumn, isHiddenCol, getRangeAddress, getCell } from '../../workbook/index';\nimport { getCellIndexes, getColumnWidth, applyCellFormat } from '../../workbook/index';\nimport { activeCellMergedRange, setMerge } from '../../workbook/index';\nimport { detach } from '@syncfusion/ej2-base';\n/**\n * The `ShowHide` module is used to perform hide/show the rows and columns.\n * @hidden\n */\nvar ShowHide = /** @class */ (function () {\n    /**\n     * Constructor for the Spreadsheet show hide module.\n     * @private\n     */\n    function ShowHide(parent) {\n        this.parent = parent;\n        this.addEventListener();\n    }\n    ShowHide.prototype.hideShow = function (args) {\n        if (args.startIndex > args.endIndex) {\n            var temp = args.startIndex;\n            args.startIndex = args.endIndex;\n            args.endIndex = temp;\n        }\n        if (args.actionUpdate) {\n            this.parent.notify(beginAction, { eventArgs: args, action: 'hideShow' });\n        }\n        args.isCol ? this.hideCol(args) : this.hideRow(args);\n        if (args.actionUpdate) {\n            this.parent.notify(completeAction, { eventArgs: args, action: 'hideShow' });\n        }\n    };\n    // tslint:disable-next-line\n    ShowHide.prototype.hideRow = function (args) {\n        var _this = this;\n        var sheet = this.parent.getActiveSheet();\n        var cell;\n        var count = 0;\n        var idx;\n        var nextIdx;\n        var merge;\n        if (args.hide) {\n            var content = void 0;\n            var rowHdr = void 0;\n            var row = void 0;\n            for (var i = args.startIndex; i <= args.endIndex; i++) {\n                if (isHiddenRow(sheet, i)) {\n                    continue;\n                }\n                if (idx === undefined) {\n                    if (sheet.showHeaders) {\n                        rowHdr = this.parent.getRowHeaderTable();\n                    }\n                    content = this.parent.getContentTable();\n                    idx = this.parent.getViewportIndex(i);\n                    count = 0;\n                }\n                setRow(sheet, i, { hidden: true });\n                row = content.rows[idx];\n                if (row) {\n                    if (!merge) {\n                        for (var j = 0; j <= sheet.usedRange.colIndex; j++) {\n                            cell = getCell(i, j, sheet) || {};\n                            if ((cell.colSpan || cell.rowSpan) && (args.startIndex >= this.parent.viewport.topIndex ||\n                                this.parent.scrollSettings.enableVirtualization)) {\n                                merge = true;\n                                break;\n                            }\n                        }\n                    }\n                    if (merge) {\n                        continue;\n                    }\n                    if (sheet.showHeaders) {\n                        detach(rowHdr.rows[idx]);\n                    }\n                    detach(row);\n                    count++;\n                    row = content.rows[idx];\n                    if (row && i === args.endIndex) {\n                        var cell_1 = void 0;\n                        nextIdx = skipHiddenIdx(sheet, i + 1, true);\n                        var first = nextIdx !== skipHiddenIdx(sheet, 0, true) && nextIdx ===\n                            (this.parent.viewport.topIndex >= args.startIndex ? args.endIndex + 1 : this.parent.viewport.topIndex) ? 'Row' : '';\n                        for (var j = this.parent.viewport.leftIndex; j <= this.parent.viewport.rightIndex; j++) {\n                            var borderTop = this.parent.getCellStyleValue(['borderTop'], [nextIdx, j]).borderTop;\n                            if (borderTop !== '') {\n                                cell_1 = row.cells[j];\n                                this.parent.notify(applyCellFormat, { onActionUpdate: false, rowIdx: nextIdx, colIdx: j,\n                                    style: { borderTop: borderTop }, row: row, pRow: row.previousElementSibling,\n                                    first: first, cell: cell_1 });\n                            }\n                        }\n                    }\n                }\n                else {\n                    if (i <= this.parent.viewport.bottomIndex) {\n                        count++;\n                    }\n                    else {\n                        count--;\n                    }\n                }\n            }\n            if (merge && (args.startIndex >= this.parent.viewport.topIndex || !this.parent.scrollSettings.enableVirtualization)) {\n                this.parent.selectRange(sheet.selectedRange);\n                this.parent.renderModule.refreshUI({\n                    rowIndex: this.parent.viewport.topIndex, colIndex: this.parent.viewport.leftIndex, refresh: 'Row'\n                });\n                return;\n            }\n            if (!count) {\n                return;\n            }\n            this.parent.selectRange(sheet.selectedRange);\n            if (this.parent.scrollSettings.enableVirtualization) {\n                if (this.parent.viewport.topIndex >= args.startIndex) {\n                    this.parent.viewport.topIndex = args.endIndex + 1;\n                }\n                args.startIndex = this.parent.viewport.bottomIndex + 1;\n                args.endIndex = args.startIndex + count - 1;\n                var indexes = this.parent.skipHidden(args.startIndex, args.endIndex);\n                args.startIndex = indexes[0];\n                args.endIndex = indexes[1];\n                this.parent.viewport.bottomIndex = args.endIndex;\n                this.parent.renderModule.refreshUI({ colIndex: this.parent.viewport.leftIndex, direction: '', refresh: 'RowPart' }, getCellAddress(args.startIndex, this.parent.viewport.leftIndex) + \":\" + getCellAddress(args.endIndex, this.parent.viewport.leftIndex + this.parent.viewport.colCount + (this.parent.getThreshold('col') * 2)));\n            }\n            if (sheet.showHeaders) {\n                if (idx === 0) {\n                    if (rowHdr.rows[0]) {\n                        rowHdr.rows[0].classList.add('e-hide-end');\n                    }\n                }\n                else {\n                    if (rowHdr.rows[idx - 1]) {\n                        rowHdr.rows[idx - 1].classList.add('e-hide-start');\n                    }\n                    if (rowHdr.rows[idx]) {\n                        rowHdr.rows[idx].classList.add('e-hide-end');\n                    }\n                }\n            }\n        }\n        else {\n            var hFrag = void 0;\n            var frag = void 0;\n            var hRow = void 0;\n            var row = void 0;\n            var rowRenderer = void 0;\n            var rTBody = void 0;\n            var tBody = void 0;\n            var startRow = void 0;\n            var endRow = args.startIndex - 1;\n            var newStartRow = void 0;\n            var mergeCollection = [];\n            for (var i = args.startIndex, len = args.endIndex; i <= len; i++) {\n                if (!isHiddenRow(sheet, i)) {\n                    if (args.startIndex === args.endIndex) {\n                        return;\n                    }\n                    if (idx === undefined) {\n                        endRow++;\n                    }\n                    else {\n                        newStartRow = i;\n                    }\n                    continue;\n                }\n                if (newStartRow !== undefined) {\n                    len = i;\n                    continue;\n                }\n                if (i > this.parent.viewport.bottomIndex) {\n                    setRow(sheet, i, { hidden: false });\n                    if (startRow === undefined) {\n                        return;\n                    }\n                    continue;\n                }\n                if (startRow === undefined) {\n                    startRow = i;\n                }\n                setRow(sheet, i, { hidden: false });\n                if (idx === undefined) {\n                    hFrag = document.createDocumentFragment();\n                    frag = document.createDocumentFragment();\n                    rowRenderer = this.parent.serviceLocator.getService('row');\n                    if (sheet.showHeaders) {\n                        rTBody = this.parent.getRowHeaderTable().tBodies[0];\n                    }\n                    tBody = this.parent.getContentTable().tBodies[0];\n                    if (i < this.parent.viewport.topIndex) {\n                        this.parent.viewport.topIndex = i;\n                    }\n                    if (i === 0) {\n                        idx = 0;\n                    }\n                    else {\n                        idx = this.parent.getViewportIndex(i);\n                    }\n                }\n                endRow++;\n                if (sheet.showHeaders) {\n                    hRow = rowRenderer.refresh(i, null, null, true);\n                    hFrag.appendChild(hRow);\n                    detach(rTBody.lastElementChild);\n                }\n                row = frag.appendChild(rowRenderer.refresh(i, row, hRow));\n                detach(tBody.lastElementChild);\n                for (var j = this.parent.viewport.leftIndex; j <= this.parent.viewport.rightIndex; j++) {\n                    cell = getCell(i, j, sheet) || {};\n                    if (cell.rowSpan !== undefined) {\n                        var mergeArgs = { range: [i, j, i, j], isAction: false, merge: true,\n                            type: 'All', skipChecking: true };\n                        this.parent.notify(activeCellMergedRange, mergeArgs);\n                        if (!mergeCollection.length || mergeArgs.range[1] !== mergeCollection[mergeCollection.length - 1].range[1]) {\n                            mergeCollection.push(mergeArgs);\n                        }\n                    }\n                }\n            }\n            this.parent.viewport.bottomIndex = this.parent.viewport.topIndex + this.parent.viewport.rowCount +\n                (this.parent.getThreshold('row') * 2);\n            count = this.parent.hiddenCount(this.parent.viewport.topIndex, args.startIndex) +\n                this.parent.hiddenCount(args.endIndex + 1, this.parent.viewport.bottomIndex);\n            this.parent.viewport.bottomIndex += count;\n            args.insertIdx = idx;\n            args.row = frag.querySelector('.e-row');\n            args.mergeCollection = mergeCollection;\n            if (sheet.showHeaders) {\n                args.hdrRow = hFrag.querySelector('.e-row');\n                if (idx !== 0 && !isHiddenRow(sheet, endRow - 1) && rTBody.children[idx - 1]) {\n                    rTBody.children[idx - 1].classList.remove('e-hide-start');\n                }\n                if (args.startIndex !== 0 && isHiddenRow(sheet, args.startIndex - 1)) {\n                    args.hdrRow.classList.add('e-hide-end');\n                }\n                if (isHiddenRow(sheet, endRow + 1)) {\n                    hFrag.lastElementChild.classList.add('e-hide-start');\n                }\n                else {\n                    if (rTBody.children[idx]) {\n                        rTBody.children[idx].classList.remove('e-hide-end');\n                    }\n                }\n            }\n            if (row && tBody.children[idx]) {\n                nextIdx = skipHiddenIdx(sheet, endRow + 1, true);\n                for (var i = this.parent.viewport.leftIndex; i <= this.parent.viewport.rightIndex; i++) {\n                    var borderTop = this.parent.getCellStyleValue(['borderTop'], [nextIdx, i]).borderTop;\n                    if (borderTop !== '') {\n                        this.parent.notify(applyCellFormat, { onActionUpdate: false, rowIdx: nextIdx, colIdx: i,\n                            style: { borderTop: borderTop }, pRow: row, cell: tBody.children[idx].children[i],\n                            first: '' });\n                        var prevIdx = skipHiddenIdx(sheet, startRow - 1, false);\n                        if (prevIdx > -1) {\n                            if (tBody.children[idx - 1] && !this.parent.getCellStyleValue(['borderBottom'], [prevIdx, i]).borderBottom &&\n                                !this.parent.getCellStyleValue(['borderTop'], [startRow, i]).borderTop) {\n                                tBody.children[idx - 1].children[i].style.borderBottom = '';\n                            }\n                        }\n                        else {\n                            tBody.children[idx].children[i].style.borderTop = '';\n                        }\n                    }\n                }\n            }\n            if (args.skipAppend) {\n                return;\n            }\n            if (sheet.showHeaders) {\n                rTBody.insertBefore(hFrag, rTBody.children[idx]);\n            }\n            tBody.insertBefore(frag, tBody.children[idx]);\n            this.parent.selectRange(sheet.selectedRange);\n            if (args.autoFit && sheet.showHeaders) {\n                this.parent.notify(autoFit, { startIndex: args.startIndex, endIndex: args.endIndex, isRow: true });\n            }\n            mergeCollection.forEach(function (mergeArgs) { _this.parent.notify(setMerge, mergeArgs); });\n            if (newStartRow !== undefined && newStartRow !== args.endIndex) {\n                args.startIndex = newStartRow;\n                this.hideRow(args);\n            }\n        }\n    };\n    ShowHide.prototype.hideCol = function (args) {\n        var _this = this;\n        var sheet = this.parent.getActiveSheet();\n        var hiddenIndex = [];\n        var beforeViewportIdx = [];\n        var topLeftCell = getCellIndexes(sheet.topLeftCell);\n        var scrollable;\n        for (var i = args.startIndex; i <= args.endIndex; i++) {\n            if (args.hide ? isHiddenCol(sheet, i) : !isHiddenCol(sheet, i)) {\n                continue;\n            }\n            setColumn(sheet, i, { hidden: args.hide });\n            if (this.parent.scrollSettings.enableVirtualization && (i < this.parent.viewport.leftIndex ||\n                i > this.parent.viewport.rightIndex)) {\n                if (i < this.parent.viewport.leftIndex) {\n                    beforeViewportIdx.push(i);\n                }\n                continue;\n            }\n            hiddenIndex.push(i);\n            if (args.hide && topLeftCell[1] === i) {\n                scrollable = true;\n            }\n        }\n        if (!beforeViewportIdx.length && !hiddenIndex.length) {\n            return;\n        }\n        if (args.hide) {\n            if (!hiddenIndex.length) {\n                return;\n            }\n            if (hiddenIndex.length <= this.parent.getThreshold('col') || !this.parent.scrollSettings.enableVirtualization) {\n                this.removeCell(sheet, hiddenIndex);\n            }\n            if (this.parent.scrollSettings.enableVirtualization) {\n                if (hiddenIndex[0] === this.parent.viewport.leftIndex) {\n                    this.parent.viewport.leftIndex = skipHiddenIdx(sheet, hiddenIndex[hiddenIndex.length - 1] + 1, true, 'columns');\n                }\n                if (scrollable) {\n                    var scrollWidth_1 = 0;\n                    hiddenIndex.slice(0, hiddenIndex.indexOf(topLeftCell[1])).forEach(function (colIdx) {\n                        scrollWidth_1 += getColumnWidth(sheet, colIdx, true);\n                    });\n                    if (scrollWidth_1) {\n                        this.parent.notify(setScrollEvent, { set: false });\n                        var content = this.parent.getMainContent();\n                        content.scrollLeft -= scrollWidth_1;\n                        this.parent.notify(onContentScroll, { scrollLeft: content.scrollLeft, preventScroll: true, skipHidden: true });\n                        getUpdateUsingRaf(function () { return _this.parent.notify(setScrollEvent, { set: true }); });\n                    }\n                }\n                if (this.parent.scrollSettings.isFinite) {\n                    var colCount = skipHiddenIdx(sheet, sheet.colCount - 1, false, 'columns');\n                    var startIdx = this.parent.viewport.leftIndex;\n                    var endIndex = this.parent.viewport.rightIndex;\n                    if (endIndex + hiddenIndex.length >= colCount) {\n                        var index = skipHiddenIdx(sheet, startIdx - ((endIndex + hiddenIndex.length) - colCount), false, 'columns');\n                        if (index > -1) {\n                            this.parent.viewport.leftIndex = index;\n                            this.parent.viewport.leftIndex -= this.parent.hiddenCount(endIndex, colCount);\n                        }\n                        this.parent.viewport.rightIndex = colCount;\n                        if (startIdx !== this.parent.viewport.leftIndex || endIndex !== this.parent.viewport.rightIndex) {\n                            this.parent.renderModule.refreshUI({ skipUpdateOnFirst: this.parent.viewport.leftIndex === skipHiddenIdx(sheet, 0, true, 'columns'), rowIndex: this.parent.viewport.topIndex, colIndex: this.parent.viewport.leftIndex, refresh: 'Column' });\n                        }\n                        else {\n                            this.parent.notify(updateTableWidth, { refresh: 'Column' });\n                        }\n                        this.parent.selectRange(sheet.selectedRange);\n                        return;\n                    }\n                }\n                if (hiddenIndex.length <= this.parent.getThreshold('col')) {\n                    var indexes = this.parent.skipHidden(this.parent.viewport.rightIndex + 1, this.parent.viewport.rightIndex + hiddenIndex.length, 'columns');\n                    this.parent.viewport.rightIndex = indexes[1];\n                    this.parent.renderModule.refreshUI({ rowIndex: this.parent.viewport.topIndex, colIndex: indexes[0], direction: '', refresh: 'ColumnPart' }, \"\" + getRangeAddress([this.parent.viewport.topIndex, indexes[0], this.parent.viewport.bottomIndex, indexes[1]]));\n                }\n                else {\n                    this.parent.renderModule.refreshUI({ skipUpdateOnFirst: this.parent.viewport.leftIndex === skipHiddenIdx(sheet, 0, true, 'columns'), rowIndex: this.parent.viewport.topIndex, colIndex: this.parent.viewport.leftIndex,\n                        refresh: 'Column' });\n                }\n            }\n            this.parent.selectRange(sheet.selectedRange);\n        }\n        else {\n            if (beforeViewportIdx.length) {\n                beforeViewportIdx.sort(function (i, j) { return i - j; });\n                if (this.parent.scrollSettings.enableVirtualization && beforeViewportIdx[0] < this.parent.getThreshold('col')) {\n                    var rowIdx = getCellIndexes(sheet.topLeftCell)[0] + 1;\n                    this.parent.setSheetPropertyOnMute(sheet, 'topLeftCell', \"A\" + rowIdx);\n                    this.parent.renderModule.refreshUI({ skipUpdateOnFirst: true, rowIndex: this.parent.viewport.topIndex, colIndex: 0,\n                        refresh: 'Column' });\n                    this.parent.selectRange(sheet.selectedRange);\n                }\n                else {\n                    this.parent.goTo(getCellAddress(this.parent.viewport.topIndex, beforeViewportIdx[0]));\n                }\n                return;\n            }\n            if (hiddenIndex.length <= this.parent.getThreshold('col') || !this.parent.scrollSettings.enableVirtualization) {\n                this.appendCell(sheet, hiddenIndex);\n                if (this.parent.scrollSettings.enableVirtualization) {\n                    this.parent.notify(virtualContentLoaded, { refresh: 'Column' });\n                }\n            }\n            else {\n                this.parent.renderModule.refreshUI({ skipUpdateOnFirst: this.parent.viewport.leftIndex === skipHiddenIdx(sheet, 0, true, 'columns'), rowIndex: this.parent.viewport.topIndex, colIndex: this.parent.viewport.leftIndex,\n                    refresh: 'Column' });\n            }\n            this.parent.selectRange(sheet.selectedRange);\n        }\n    };\n    ShowHide.prototype.removeCell = function (sheet, indexes) {\n        var _this = this;\n        var startIdx;\n        var endIdx;\n        var hRow;\n        var row;\n        var hColgrp;\n        var colgrp;\n        var rowIdx = 0;\n        var cellIdx = this.parent.getViewportIndex(indexes[0], true) + 1;\n        var cell;\n        if (this.parent.scrollSettings.enableVirtualization) {\n            startIdx = this.parent.viewport.topIndex;\n            endIdx = this.parent.viewport.bottomIndex;\n        }\n        else {\n            startIdx = 0;\n            endIdx = sheet.rowCount - 1;\n        }\n        var table = this.parent.getContentTable();\n        var nextIdx;\n        colgrp = table.getElementsByTagName('colgroup')[0];\n        var colSpan;\n        if (sheet.showHeaders) {\n            var hTable = this.parent.getColHeaderTable();\n            hColgrp = hTable.getElementsByTagName('colgroup')[0];\n            hRow = hTable.rows[0];\n        }\n        var modelLen = indexes.length - 1;\n        var prevIdx;\n        while (startIdx <= endIdx) {\n            if (isHiddenRow(sheet, startIdx)) {\n                startIdx++;\n                continue;\n            }\n            row = table.rows[rowIdx];\n            indexes.forEach(function (idx, index) {\n                detach(row.cells[cellIdx]);\n                if (rowIdx === 0) {\n                    if (sheet.showHeaders) {\n                        detach(hRow.cells[cellIdx]);\n                        detach(hColgrp.children[cellIdx]);\n                    }\n                    detach(colgrp.children[cellIdx]);\n                }\n                if (index === 0) {\n                    cell = getCell(startIdx, idx, sheet) || {};\n                    if (cell.colSpan !== undefined && (cell.rowSpan === undefined || cell.colSpan > 1)) {\n                        _this.parent.notify(hiddenMerge, { rowIdx: startIdx, colIdx: idx, model: 'col',\n                            start: indexes[0], end: indexes[modelLen] });\n                    }\n                }\n                if (index === modelLen) {\n                    nextIdx = skipHiddenIdx(sheet, idx + 1, true, 'columns');\n                    var borderLeft = _this.parent.getCellStyleValue(['borderLeft'], [rowIdx, nextIdx]).borderLeft;\n                    if (borderLeft !== '') {\n                        _this.parent.notify(applyCellFormat, { onActionUpdate: false, rowIdx: rowIdx, colIdx: nextIdx,\n                            style: { borderLeft: borderLeft }, row: row, first: '' });\n                    }\n                    cell = getCell(startIdx, idx, sheet) || {};\n                    if (cell.colSpan !== undefined && (cell.rowSpan === undefined || cell.colSpan > 1)) {\n                        _this.parent.notify(hiddenMerge, { rowIdx: startIdx, colIdx: idx, model: 'col',\n                            start: indexes[0], end: indexes[modelLen], isEnd: true });\n                    }\n                }\n            });\n            startIdx++;\n            rowIdx++;\n        }\n        if (cellIdx - 1 > -1) {\n            if (sheet.showHeaders && hRow.cells[cellIdx - 1]) {\n                hRow.cells[cellIdx - 1].classList.add('e-hide-start');\n            }\n        }\n        if (hRow.cells[cellIdx]) {\n            hRow.cells[cellIdx].classList.add('e-hide-end');\n        }\n    };\n    ShowHide.prototype.appendCell = function (sheet, indexes) {\n        var _this = this;\n        var startIdx;\n        var endIdx;\n        var hRow;\n        var row;\n        var hColgrp;\n        var colgrp;\n        var rowIdx = 0;\n        var prevIdx;\n        var hFrag = document.createDocumentFragment();\n        var frag = document.createDocumentFragment();\n        var colFrag = document.createDocumentFragment();\n        if (this.parent.scrollSettings.enableVirtualization) {\n            startIdx = this.parent.viewport.topIndex;\n            endIdx = this.parent.viewport.bottomIndex;\n        }\n        else {\n            startIdx = 0;\n            endIdx = sheet.rowCount - 1;\n        }\n        var table = this.parent.getContentTable();\n        var hTable = this.parent.getColHeaderTable();\n        colgrp = table.getElementsByTagName('colgroup')[0];\n        if (sheet.showHeaders) {\n            hColgrp = hTable.getElementsByTagName('colgroup')[0];\n            hRow = hTable.rows[0];\n        }\n        var cellRenderer = this.parent.serviceLocator.getService('cell');\n        indexes.sort(function (i, j) { return i - j; });\n        var cellModel;\n        var mergeCollection = [];\n        var cellIdx = [];\n        var cell;\n        var refCell;\n        var modelLen = indexes.length - 1;\n        while (startIdx <= endIdx) {\n            if (isHiddenRow(sheet, startIdx)) {\n                startIdx++;\n                continue;\n            }\n            row = table.rows[rowIdx];\n            indexes.forEach(function (idx, index) {\n                if (rowIdx === 0) {\n                    cellIdx[index] = _this.parent.getViewportIndex(idx, true);\n                    if (colgrp.children[cellIdx[index]]) {\n                        colgrp.insertBefore(_this.parent.sheetModule.updateCol(sheet, idx), colgrp.children[cellIdx[index]]);\n                        if (sheet.showHeaders) {\n                            refCell = hRow.cells[cellIdx[index]];\n                            if (index === 0 && indexes[index] && !isHiddenCol(sheet, indexes[index] - 1)) {\n                                refCell.previousElementSibling.classList.remove('e-hide-start');\n                            }\n                            hRow.insertBefore(cellRenderer.renderColHeader(idx), refCell);\n                            if (index === modelLen) {\n                                refCell.classList.remove('e-hide-end');\n                            }\n                        }\n                    }\n                    else {\n                        colgrp.appendChild(_this.parent.sheetModule.updateCol(sheet, idx));\n                        if (sheet.showHeaders) {\n                            hRow.appendChild(cellRenderer.renderColHeader(idx));\n                        }\n                    }\n                    detach(colgrp.lastChild);\n                    if (sheet.showHeaders) {\n                        detach(hRow.lastChild);\n                        if (index === modelLen) {\n                            detach(hColgrp);\n                            hTable.insertBefore(colgrp.cloneNode(true), hTable.tHead[0]);\n                        }\n                    }\n                }\n                detach(row.lastChild);\n                refCell = row.cells[cellIdx[index]];\n                cell = cellRenderer.render({ rowIdx: startIdx, colIdx: idx, cell: getCell(startIdx, idx, sheet),\n                    address: getCellAddress(startIdx, idx), lastCell: idx === modelLen, isHeightCheckNeeded: true,\n                    first: idx !== skipHiddenIdx(sheet, 0, true, 'columns') && idx === _this.parent.viewport.leftIndex ? 'Column' : '',\n                    checkNextBorder: index === modelLen ? 'Column' : '' });\n                refCell ? row.insertBefore(cell, refCell) : row.appendChild(cell);\n                if (index === 0 && cell.previousSibling) {\n                    var borderLeft = _this.parent.getCellStyleValue(['borderLeft'], [rowIdx, skipHiddenIdx(sheet, indexes[indexes.length - 1] + 1, true, 'columns')]).borderLeft;\n                    if (borderLeft !== '') {\n                        prevIdx = skipHiddenIdx(sheet, indexes[0] - 1, false, 'columns');\n                        if (prevIdx > -1 && !_this.parent.getCellStyleValue(['borderRight'], [rowIdx, prevIdx]).borderRight &&\n                            !_this.parent.getCellStyleValue(['borderLeft'], [rowIdx, indexes[0]]).borderLeft) {\n                            cell.previousSibling.style.borderRight = '';\n                        }\n                    }\n                }\n                cellModel = getCell(rowIdx, idx, sheet) || {};\n                if (cellModel.colSpan !== undefined && (cellModel.rowSpan === undefined || cellModel.colSpan > 1)) {\n                    var mergeArgs = { range: [rowIdx, idx, rowIdx, idx], isAction: false, merge: true,\n                        type: 'All', skipChecking: true };\n                    _this.parent.notify(activeCellMergedRange, mergeArgs);\n                    if (!mergeCollection.length || mergeArgs.range[1] !== mergeCollection[mergeCollection.length - 1].range[1]) {\n                        mergeCollection.push(mergeArgs);\n                    }\n                }\n            });\n            startIdx++;\n            rowIdx++;\n        }\n        mergeCollection.forEach(function (mergeArgs) { _this.parent.notify(setMerge, mergeArgs); });\n        this.parent.viewport.rightIndex = skipHiddenIdx(sheet, this.parent.viewport.rightIndex - indexes.length, false, 'columns');\n    };\n    ShowHide.prototype.addEventListener = function () {\n        this.parent.on(hideShow, this.hideShow, this);\n        this.parent.on(spreadsheetDestroyed, this.destroy, this);\n    };\n    ShowHide.prototype.destroy = function () {\n        this.removeEventListener();\n        this.parent = null;\n    };\n    ShowHide.prototype.removeEventListener = function () {\n        this.parent.off(hideShow, this.hideShow);\n        this.parent.off(spreadsheetDestroyed, this.destroy);\n    };\n    return ShowHide;\n}());\nexport { ShowHide };\n","import { initiateHyperlink, locale, dialog, click, keyUp, createHyperlinkElement, getUpdateUsingRaf } from '../common/index';\nimport { editHyperlink, removeHyperlink, openHyperlink, editAlert } from '../common/index';\nimport { isNullOrUndefined, closest } from '@syncfusion/ej2-base';\nimport { getRangeIndexes, getCellIndexes, getCellAddress, getRangeAddress } from '../../workbook/common/address';\nimport { getTypeFromFormat, getCell } from '../../workbook/index';\nimport { beforeHyperlinkClick, afterHyperlinkClick } from '../../workbook/common/event';\nimport { isCellReference } from '../../workbook/index';\nimport { Tab, TreeView } from '@syncfusion/ej2-navigations';\n/**\n * `Hyperlink` module\n */\nvar SpreadsheetHyperlink = /** @class */ (function () {\n    /**\n     * Constructor for Hyperlink module.\n     */\n    function SpreadsheetHyperlink(parent) {\n        this.parent = parent;\n        this.addEventListener();\n    }\n    /**\n     * To destroy the Hyperlink module.\n     * @return {void}\n     */\n    SpreadsheetHyperlink.prototype.destroy = function () {\n        this.removeEventListener();\n        this.parent = null;\n    };\n    SpreadsheetHyperlink.prototype.addEventListener = function () {\n        this.parent.on(initiateHyperlink, this.initiateHyperlinkHandler, this);\n        this.parent.on(editHyperlink, this.editHyperlinkHandler, this);\n        this.parent.on(removeHyperlink, this.removeHyperlinkHandler, this);\n        this.parent.on(openHyperlink, this.openHyperlinkHandler, this);\n        this.parent.on(click, this.hyperlinkClickHandler, this);\n        this.parent.on(createHyperlinkElement, this.createHyperlinkElementHandler, this);\n        this.parent.on(keyUp, this.keyUpHandler, this);\n    };\n    SpreadsheetHyperlink.prototype.removeEventListener = function () {\n        if (!this.parent.isDestroyed) {\n            this.parent.off(initiateHyperlink, this.initiateHyperlinkHandler);\n            this.parent.off(editHyperlink, this.editHyperlinkHandler);\n            this.parent.off(removeHyperlink, this.removeHyperlinkHandler);\n            this.parent.off(openHyperlink, this.openHyperlinkHandler);\n            this.parent.off(click, this.hyperlinkClickHandler);\n            this.parent.off(createHyperlinkElement, this.createHyperlinkElementHandler);\n            this.parent.off(keyUp, this.keyUpHandler);\n        }\n    };\n    /**\n     * Gets the module name.\n     * @returns string\n     */\n    SpreadsheetHyperlink.prototype.getModuleName = function () {\n        return 'spreadsheetHyperlink';\n    };\n    SpreadsheetHyperlink.prototype.keyUpHandler = function (e) {\n        var trgt = e.target;\n        if (closest(trgt, '.e-document')) {\n            var hyperlinkText = document.querySelector('.e-hyp-text');\n            var hyperlinkSpan = this.parent.element.querySelector('.e-hyperlink-alert-span');\n            var dlgElement = closest(trgt, '.e-hyperlink-dlg') || closest(trgt, '.e-edithyperlink-dlg');\n            var footerEle = dlgElement.getElementsByClassName('e-footer-content')[0];\n            var insertBut = footerEle.firstChild;\n            if (hyperlinkText && hyperlinkText.value) {\n                if (!isCellReference(hyperlinkText.value.toUpperCase())) {\n                    this.showDialog();\n                    insertBut.setAttribute('disabled', 'true');\n                }\n                else if (hyperlinkSpan) {\n                    hyperlinkSpan.remove();\n                    insertBut.removeAttribute('disabled');\n                }\n            }\n        }\n        if (trgt.classList.contains('e-text') && closest(trgt, '.e-cont')) {\n            if (closest(trgt, '.e-webpage') && closest(trgt, '.e-webpage').getElementsByClassName('e-cont')[1] === trgt.parentElement) {\n                var dlgEle = closest(trgt, '.e-hyperlink-dlg') || closest(trgt, '.e-edithyperlink-dlg');\n                var ftrEle = dlgEle.getElementsByClassName('e-footer-content')[0];\n                var insertBut = ftrEle.firstChild;\n                if (trgt.value !== '') {\n                    insertBut.removeAttribute('disabled');\n                }\n                else {\n                    var linkDialog = closest(trgt, '.e-link-dialog');\n                    var webPage = linkDialog.querySelector('.e-webpage');\n                    var isUrl = webPage.querySelectorAll('.e-cont')[1].querySelector('.e-text').value ? true : false;\n                    if (!isUrl) {\n                        insertBut.setAttribute('disabled', 'true');\n                    }\n                }\n            }\n        }\n    };\n    SpreadsheetHyperlink.prototype.initiateHyperlinkHandler = function () {\n        var _this = this;\n        var l10n = this.parent.serviceLocator.getService(locale);\n        var sheet = this.parent.getActiveSheet();\n        if (sheet.isProtected && !sheet.protectSettings.insertLink) {\n            this.parent.notify(editAlert, null);\n            return;\n        }\n        if (!this.parent.element.querySelector('.e-hyperlink-dlg')) {\n            var dialogInst_1 = this.parent.serviceLocator.getService(dialog);\n            dialogInst_1.show({\n                width: 323, isModal: true, showCloseIcon: true, cssClass: 'e-hyperlink-dlg',\n                header: l10n.getConstant('InsertLink'),\n                beforeOpen: function (args) {\n                    var dlgArgs = {\n                        dialogName: 'InsertLinkDialog',\n                        element: args.element, target: args.target, cancel: args.cancel\n                    };\n                    _this.parent.trigger('dialogBeforeOpen', dlgArgs);\n                    if (dlgArgs.cancel) {\n                        args.cancel = true;\n                    }\n                    dialogInst_1.dialogInstance.content = _this.hyperlinkContent();\n                    dialogInst_1.dialogInstance.dataBind();\n                    _this.parent.element.focus();\n                },\n                buttons: [{\n                        buttonModel: {\n                            content: l10n.getConstant('Insert'), isPrimary: true, disabled: true\n                        },\n                        click: function () {\n                            _this.dlgClickHandler(dialogInst_1);\n                            dialogInst_1.hide();\n                        }\n                    }]\n            });\n        }\n    };\n    SpreadsheetHyperlink.prototype.dlgClickHandler = function (dialogInst) {\n        var value;\n        var address;\n        var spreadsheetInst = this.parent;\n        var item = this.parent.element.querySelector('.e-link-dialog').\n            getElementsByClassName('e-content')[0].querySelector('.e-item.e-active');\n        if (item) {\n            if (item.querySelector('.e-webpage')) {\n                value = item.getElementsByClassName('e-cont')[0].querySelector('.e-text').value;\n                address = item.getElementsByClassName('e-cont')[1].querySelector('.e-text').value;\n                var args = { address: address };\n                this.parent.insertHyperlink(args, this.parent.getActiveSheet().activeCell, value, false);\n            }\n            else {\n                value = item.getElementsByClassName('e-cont')[0].querySelector('.e-text').value;\n                address = item.getElementsByClassName('e-cont')[1].querySelector('.e-text').value;\n                var sheetIdx = void 0;\n                var dlgContent = item.getElementsByClassName('e-cont')[2];\n                if (dlgContent.getElementsByClassName('e-list-item')[0].querySelector('.e-active')) {\n                    var sheetName = item.getElementsByClassName('e-cont')[2].querySelector('.e-active').textContent;\n                    var sheets = spreadsheetInst.sheets;\n                    for (var idx = 0; idx < sheets.length; idx++) {\n                        if (sheets[idx].name === sheetName) {\n                            sheetIdx = idx + 1;\n                        }\n                    }\n                    address = sheetName + '!' + address.toUpperCase();\n                    var args = { address: address };\n                    this.parent.insertHyperlink(args, this.parent.getActiveSheet().activeCell, value, false);\n                }\n                else if (dlgContent.querySelector('.e-active')) {\n                    var definedName = item.getElementsByClassName('e-cont')[2].querySelector('.e-active').textContent;\n                    for (var idx = 0; idx < this.parent.definedNames.length; idx++) {\n                        if (this.parent.definedNames[idx].name === definedName) {\n                            var args = {\n                                address: this.parent.definedNames[idx].name,\n                            };\n                            this.parent.insertHyperlink(args, this.parent.getActiveSheet().activeCell, value, false);\n                        }\n                    }\n                }\n            }\n        }\n    };\n    SpreadsheetHyperlink.prototype.showDialog = function () {\n        if (this.parent.element.querySelector('.e-hyperlink-alert-span')) {\n            this.parent.element.querySelector('.e-hyperlink-alert-span').remove();\n        }\n        var l10n = this.parent.serviceLocator.getService(locale);\n        var hyperlinkSpan = this.parent.createElement('span', {\n            className: 'e-hyperlink-alert-span',\n            innerHTML: l10n.getConstant('HyperlinkAlert')\n        });\n        (this.parent.element.querySelector('.e-hyperlink-dlg').querySelector('.e-dlg-content')).appendChild(hyperlinkSpan);\n    };\n    SpreadsheetHyperlink.prototype.editHyperlinkHandler = function () {\n        var _this = this;\n        var isWeb = true;\n        var l10n = this.parent.serviceLocator.getService(locale);\n        var dialogInst = this.parent.serviceLocator.getService(dialog);\n        dialogInst.show({\n            width: 323, isModal: true, showCloseIcon: true, cssClass: 'e-edithyperlink-dlg',\n            header: l10n.getConstant('EditLink'),\n            beforeOpen: function (args) {\n                var dlgArgs = {\n                    dialogName: 'EditLinkDialog',\n                    element: args.element, target: args.target, cancel: args.cancel\n                };\n                _this.parent.trigger('dialogBeforeOpen', dlgArgs);\n                if (dlgArgs.cancel) {\n                    args.cancel = true;\n                }\n                dialogInst.dialogInstance.content = _this.hyperEditContent();\n                dialogInst.dialogInstance.dataBind();\n                _this.parent.element.focus();\n            },\n            buttons: [{\n                    buttonModel: {\n                        content: l10n.getConstant('Update'), isPrimary: true\n                    },\n                    click: function () {\n                        _this.dlgClickHandler(dialogInst);\n                        dialogInst.hide();\n                    }\n                }]\n        });\n    };\n    SpreadsheetHyperlink.prototype.openHyperlinkHandler = function () {\n        var cellIndexes = getCellIndexes(this.parent.getActiveSheet().activeCell);\n        var trgt = this.parent.getCell(cellIndexes[0], cellIndexes[1]);\n        if (trgt.getElementsByClassName('e-hyperlink')[0]) {\n            trgt = trgt.querySelector('.e-hyperlink');\n        }\n        this.hlOpenHandler(trgt);\n    };\n    SpreadsheetHyperlink.prototype.removeHyperlinkHandler = function (cell) {\n        this.parent.removeHyperlink(cell);\n    };\n    // tslint:disable-next-line:max-func-body-length\n    SpreadsheetHyperlink.prototype.hlOpenHandler = function (trgt) {\n        var _this = this;\n        if (trgt.classList.contains('e-hyperlink')) {\n            var range = ['', ''];\n            var selRange = void 0;\n            var rangeIndexes = void 0;\n            var isEmpty = true;\n            trgt.style.color = '#551A8B';\n            var sheet = this.parent.getActiveSheet();\n            var colIdx = parseInt(trgt.parentElement.getAttribute('aria-colindex'), 10) - 1;\n            var rowIdx = parseInt(trgt.parentElement.parentElement.getAttribute('aria-rowindex'), 10) - 1;\n            var rangeAddr = sheet.rows[rowIdx].cells[colIdx].hyperlink;\n            var address = void 0;\n            var befArgs = void 0;\n            var aftArgs = void 0;\n            befArgs = { hyperlink: rangeAddr, cell: this.parent.getActiveSheet().activeCell, target: '_blank', cancel: false };\n            this.parent.trigger(beforeHyperlinkClick, befArgs);\n            if (befArgs.cancel) {\n                return;\n            }\n            rangeAddr = befArgs.hyperlink;\n            aftArgs = { hyperlink: rangeAddr, cell: this.parent.getActiveSheet().activeCell };\n            if (typeof (rangeAddr) === 'string') {\n                address = rangeAddr;\n            }\n            if (typeof (rangeAddr) === 'object') {\n                address = rangeAddr.address;\n            }\n            var definedNameCheck = address;\n            if (address.indexOf('http://') === -1 && address.indexOf('https://') === -1 && address.indexOf('ftp://') === -1) {\n                if (!isNullOrUndefined(address)) {\n                    if (this.parent.definedNames) {\n                        for (var idx = 0; idx < this.parent.definedNames.length; idx++) {\n                            if (this.parent.definedNames[idx].name === address) {\n                                address = this.parent.definedNames[idx].refersTo;\n                                address = address.slice(1);\n                                break;\n                            }\n                        }\n                    }\n                    if (address.indexOf('!') !== -1) {\n                        range = address.split('!');\n                        if (range[0].indexOf(' ') !== -1) {\n                            range[0] = range[0].slice(1, range[0].length - 1);\n                        }\n                    }\n                    else {\n                        range[0] = this.parent.getActiveSheet().name;\n                        range[1] = address;\n                    }\n                    selRange = range[1];\n                    var sheetIdx_1;\n                    for (var idx = 0; idx < this.parent.sheets.length; idx++) {\n                        if (this.parent.sheets[idx].name === range[0]) {\n                            sheetIdx_1 = idx;\n                        }\n                    }\n                    sheet = this.parent.sheets[sheetIdx_1];\n                    if (range[1].indexOf(':') !== -1) {\n                        var colIndex = range[1].indexOf(':');\n                        var left = range[1].substr(0, colIndex);\n                        var right = range[1].substr(colIndex + 1, range[1].length);\n                        left = left.replace('$', '');\n                        right = right.replace('$', '');\n                        if (right.match(/\\D/g) && !right.match(/[0-9]/g) && left.match(/\\D/g) && !left.match(/[0-9]/g)) {\n                            selRange = left + '1' + ':' + right + sheet.rowCount;\n                            left = left + '1';\n                            right = right + sheet.rowCount;\n                            range[1] = left + ':' + right;\n                        }\n                        else if (!right.match(/\\D/g) && right.match(/[0-9]/g) && !left.match(/\\D/g) && left.match(/[0-9]/g)) {\n                            selRange = getCellAddress(parseInt(left, 10) - 1, 0) + ':' +\n                                getCellAddress(parseInt(right, 10) - 1, sheet.colCount - 1);\n                            rangeIndexes = [parseInt(left, 10) - 1, 0, parseInt(right, 10) - 1, sheet.colCount - 1];\n                            isEmpty = false;\n                        }\n                    }\n                    var isDefinedNamed = void 0;\n                    var definedname = this.parent.definedNames;\n                    if (!isNullOrUndefined(definedname)) {\n                        for (var idx = 0; idx < definedname.length; idx++) {\n                            if (definedname[idx].name === definedNameCheck) {\n                                isDefinedNamed = true;\n                                break;\n                            }\n                        }\n                    }\n                    if (isCellReference(range[1]) || isDefinedNamed) {\n                        rangeIndexes = isEmpty ? getRangeIndexes(range[1]) : rangeIndexes;\n                        if (this.parent.scrollSettings.enableVirtualization) {\n                            rangeIndexes[0] = rangeIndexes[0] >= this.parent.viewport.topIndex ?\n                                rangeIndexes[0] - this.parent.viewport.topIndex : rangeIndexes[0];\n                            rangeIndexes[1] = rangeIndexes[1] >= this.parent.viewport.leftIndex ?\n                                rangeIndexes[1] - this.parent.viewport.leftIndex : rangeIndexes[1];\n                        }\n                        if (!isNullOrUndefined(sheet)) {\n                            var rangeAddr_1 = getRangeAddress(rangeIndexes);\n                            if (sheet === this.parent.getActiveSheet()) {\n                                getUpdateUsingRaf(function () { _this.parent.goTo(rangeAddr_1); });\n                            }\n                            else {\n                                if (rangeAddr_1.indexOf(':') >= 0) {\n                                    var addArr = rangeAddr_1.split(':');\n                                    rangeAddr_1 = addArr[0] === addArr[1] ? addArr[0] : rangeAddr_1;\n                                }\n                                getUpdateUsingRaf(function () { _this.parent.goTo(_this.parent.sheets[sheetIdx_1].name + '!' + rangeAddr_1); });\n                            }\n                        }\n                    }\n                }\n            }\n            else {\n                trgt.setAttribute('target', befArgs.target);\n            }\n            this.parent.trigger(afterHyperlinkClick, aftArgs);\n        }\n    };\n    SpreadsheetHyperlink.prototype.hyperlinkClickHandler = function (e) {\n        var trgt = e.target;\n        if (closest(trgt, '.e-link-dialog') && closest(trgt, '.e-toolbar-item')) {\n            var dlgEle = closest(trgt, '.e-hyperlink-dlg') || closest(trgt, '.e-edithyperlink-dlg');\n            var ftrEle = dlgEle.getElementsByClassName('e-footer-content')[0];\n            var insertBut = ftrEle.firstChild;\n            var docEle = dlgEle.querySelector('.e-document');\n            var webEle = dlgEle.querySelector('.e-webpage');\n            var webEleText = webEle ? webEle.querySelectorAll('.e-cont')[0].querySelector('.e-text').value :\n                docEle.querySelectorAll('.e-cont')[0].querySelector('.e-text').value;\n            var docEleText = docEle ? docEle.querySelectorAll('.e-cont')[0].querySelector('.e-text').value :\n                webEleText;\n            var toolbarItems = closest(trgt, '.e-toolbar-items');\n            if (toolbarItems.getElementsByClassName('e-toolbar-item')[1].classList.contains('e-active')) {\n                var actEle = docEle.querySelectorAll('.e-cont')[2].querySelector('.e-active');\n                docEle.querySelectorAll('.e-cont')[0].querySelector('.e-text').value = webEleText;\n                if (closest(actEle, '.e-list-item').classList.contains('e-level-2') && insertBut.hasAttribute('disabled')) {\n                    insertBut.removeAttribute('disabled');\n                }\n                else if (closest(actEle, '.e-list-item').classList.contains('e-level-1') && !insertBut.hasAttribute('disabled')) {\n                    insertBut.setAttribute('disabled', 'true');\n                }\n            }\n            else {\n                var isEmpty = webEle.querySelectorAll('.e-cont')[1].querySelector('.e-text').value ? false : true;\n                webEle.querySelectorAll('.e-cont')[0].querySelector('.e-text').value = docEleText;\n                if (isEmpty && !insertBut.hasAttribute('disabled')) {\n                    insertBut.setAttribute('disabled', 'true');\n                }\n                else if (!isEmpty && insertBut.hasAttribute('disabled')) {\n                    insertBut.removeAttribute('disabled');\n                }\n            }\n        }\n        if (closest(trgt, '.e-list-item') && trgt.classList.contains('e-fullrow')) {\n            var item = this.parent.element.getElementsByClassName('e-link-dialog')[0].\n                getElementsByClassName('e-content')[0].getElementsByClassName('e-active')[0];\n            var cellRef = item.getElementsByClassName('e-cont')[1].getElementsByClassName('e-text')[0];\n            var dlgEle = closest(trgt, '.e-hyperlink-dlg') || closest(trgt, '.e-edithyperlink-dlg');\n            var ftrEle = dlgEle.getElementsByClassName('e-footer-content')[0];\n            var insertBut = ftrEle.firstChild;\n            if (closest(trgt, '.e-list-item').classList.contains('e-level-2')) {\n                if (closest(trgt, '.e-list-item').getAttribute('data-uid') === 'defName') {\n                    if (!cellRef.classList.contains('e-disabled') && !cellRef.hasAttribute('readonly')) {\n                        cellRef.setAttribute('readonly', 'true');\n                        cellRef.classList.add('e-disabled');\n                        cellRef.setAttribute('disabled', 'true');\n                    }\n                }\n                else if (closest(trgt, '.e-list-item').getAttribute('data-uid') === 'sheet') {\n                    if (cellRef.classList.contains('e-disabled') && cellRef.hasAttribute('readonly')) {\n                        cellRef.removeAttribute('readonly');\n                        cellRef.classList.remove('e-disabled');\n                        cellRef.removeAttribute('disabled');\n                    }\n                }\n                if (insertBut.hasAttribute('disabled')) {\n                    insertBut.removeAttribute('disabled');\n                }\n            }\n            else if (closest(trgt, '.e-list-item').classList.contains('e-level-1')) {\n                insertBut.setAttribute('disabled', 'true');\n            }\n        }\n        else {\n            this.hlOpenHandler(trgt);\n        }\n    };\n    SpreadsheetHyperlink.prototype.createHyperlinkElementHandler = function (args) {\n        var cell = args.cell;\n        var td = args.td;\n        var rowIdx = args.rowIdx;\n        var colIdx = args.colIdx;\n        var hyperEle = this.parent.createElement('a', { className: 'e-hyperlink e-hyperlink-style' });\n        if (!isNullOrUndefined(cell.hyperlink)) {\n            var hyperlink = cell.hyperlink;\n            if (typeof (hyperlink) === 'string') {\n                if (hyperlink.indexOf('http://') === -1 && hyperlink.indexOf('https://') === -1 &&\n                    hyperlink.indexOf('ftp://') === -1 && hyperlink.indexOf('www.') !== -1) {\n                    hyperlink = 'http://' + hyperlink;\n                }\n                if (hyperlink.indexOf('http://') === 0 || hyperlink.indexOf('https://') === 0 || hyperlink.indexOf('ftp://') === 0) {\n                    hyperEle.setAttribute('href', hyperlink);\n                    hyperEle.setAttribute('target', '_blank');\n                }\n                else if (hyperlink.includes('=') || hyperlink.includes('!')) {\n                    hyperEle.setAttribute('ref', hyperlink);\n                }\n                hyperEle.innerText = td.innerText !== '' ? td.innerText : hyperlink;\n                td.textContent = '';\n                td.innerText = '';\n                td.appendChild(hyperEle);\n            }\n            else if (typeof (hyperlink) === 'object') {\n                if (hyperlink.address.indexOf('http://') === 0 || hyperlink.address.indexOf('https://') === 0 ||\n                    hyperlink.address.indexOf('ftp://') === 0) {\n                    hyperEle.setAttribute('href', hyperlink.address);\n                    hyperEle.setAttribute('target', '_blank');\n                }\n                else if (hyperlink.address.includes('=') || hyperlink.address.includes('!')) {\n                    hyperEle.setAttribute('ref', hyperlink.address);\n                }\n                if (getTypeFromFormat(cell.format) === 'Accounting') {\n                    hyperEle.innerHTML = td.innerHTML;\n                }\n                else {\n                    hyperEle.innerText = td.innerText !== '' ? td.innerText : hyperlink.address;\n                }\n                td.textContent = '';\n                td.innerText = '';\n                td.appendChild(hyperEle);\n            }\n        }\n        else if (td.querySelector('a') && cell.hyperlink) {\n            if (typeof (cell.hyperlink) === 'string') {\n                td.querySelector('a').setAttribute('href', cell.hyperlink);\n            }\n        }\n    };\n    SpreadsheetHyperlink.prototype.hyperEditContent = function () {\n        var isWeb = true;\n        var dialog = this.hyperlinkContent();\n        var indexes = getRangeIndexes(this.parent.getActiveSheet().activeCell);\n        var cell = this.parent.sheets[this.parent.getActiveSheet().id - 1].rows[indexes[0]].cells[indexes[1]];\n        if (this.parent.scrollSettings.enableVirtualization) {\n            indexes[0] = indexes[0] - this.parent.viewport.topIndex;\n            indexes[1] = indexes[1] - this.parent.viewport.leftIndex;\n        }\n        var value = this.parent.getDisplayText(cell);\n        var address;\n        var hyperlink = cell.hyperlink;\n        if (typeof (hyperlink) === 'string') {\n            address = hyperlink;\n            value = value || address;\n            if (address.indexOf('http://') === -1 && address.indexOf('https://') === -1 && address.indexOf('ftp://') === -1) {\n                isWeb = false;\n            }\n        }\n        else if (typeof (hyperlink) === 'object') {\n            address = hyperlink.address;\n            value = value || address;\n            if (address.indexOf('http://') === -1 && address.indexOf('https://') === -1 && address.indexOf('ftp://') === -1) {\n                isWeb = false;\n            }\n        }\n        var item = dialog.querySelector('.e-content');\n        if (isWeb) {\n            var webContElem = item.querySelector('.e-webpage');\n            webContElem.getElementsByClassName('e-cont')[0].getElementsByClassName('e-text')[0].setAttribute('value', value);\n            if (typeof (hyperlink) === 'string') {\n                webContElem.getElementsByClassName('e-cont')[1].querySelector('.e-text').setAttribute('value', hyperlink);\n            }\n            else {\n                var address_1;\n                address_1 = webContElem.getElementsByClassName('e-cont')[1].querySelector('.e-text');\n                address_1.setAttribute('value', hyperlink.address);\n            }\n        }\n        else {\n            var isDefinedNamed = void 0;\n            var docContElem = item.querySelector('.e-document');\n            docContElem.getElementsByClassName('e-cont')[0].getElementsByClassName('e-text')[0].setAttribute('value', value);\n            var rangeArr = void 0;\n            var sheet = this.parent.getActiveSheet();\n            var sheetIdx = void 0;\n            if (this.parent.definedNames) {\n                for (var idx = 0; idx < this.parent.definedNames.length; idx++) {\n                    if (this.parent.definedNames[idx].name === address) {\n                        isDefinedNamed = true;\n                        break;\n                    }\n                }\n            }\n            if (isDefinedNamed) {\n                var cellRef = void 0;\n                cellRef = docContElem.getElementsByClassName('e-cont')[1].getElementsByClassName('e-text')[0];\n                cellRef.setAttribute('readonly', 'true');\n                cellRef.classList.add('e-disabled');\n                cellRef.setAttribute('disabled', 'true');\n                var treeCont = docContElem.getElementsByClassName('e-cont')[2];\n                var listEle = treeCont.querySelectorAll('.e-list-item.e-level-1')[1];\n                for (var idx = 0; idx < listEle.getElementsByTagName('li').length; idx++) {\n                    if (listEle.getElementsByTagName('li')[idx].innerText === address) {\n                        listEle.getElementsByTagName('li')[idx].classList.add('e-active');\n                    }\n                }\n            }\n            else {\n                if (address && address.indexOf('!') !== -1) {\n                    rangeArr = address.split('!');\n                    sheetIdx = parseInt(rangeArr[0].replace(/\\D/g, ''), 10) - 1;\n                    sheet = this.parent.sheets[sheetIdx];\n                }\n                var sheetName = rangeArr[0];\n                docContElem.getElementsByClassName('e-cont')[1].querySelector('.e-text').setAttribute('value', rangeArr[1]);\n                var treeCont = docContElem.getElementsByClassName('e-cont')[2];\n                var listEle = treeCont.querySelectorAll('.e-list-item.e-level-1')[0];\n                for (var idx = 0; idx < listEle.getElementsByTagName('li').length; idx++) {\n                    if (listEle.getElementsByTagName('li')[idx].innerText === sheetName) {\n                        if (listEle.getElementsByTagName('li')[idx].classList.contains('e-active')) {\n                            break;\n                        }\n                        else {\n                            listEle.getElementsByTagName('li')[idx].classList.add('e-active');\n                        }\n                    }\n                    else {\n                        if (listEle.getElementsByTagName('li')[idx].classList.contains('e-active')) {\n                            listEle.getElementsByTagName('li')[idx].classList.remove('e-active');\n                        }\n                    }\n                }\n            }\n        }\n        return dialog;\n    };\n    // tslint:disable-next-line:max-func-body-length\n    SpreadsheetHyperlink.prototype.hyperlinkContent = function () {\n        var l10n = this.parent.serviceLocator.getService(locale);\n        var idx = 0;\n        var selIdx = 0;\n        var isWeb = true;\n        var isDefinedName;\n        var isCellRef = true;\n        var address;\n        var indexes = getRangeIndexes(this.parent.getActiveSheet().activeCell);\n        var sheet = this.parent.getActiveSheet();\n        var cell = getCell(indexes[0], indexes[1], sheet);\n        var isEnable = true;\n        if (cell) {\n            if ((cell.value && typeof (cell.value) === 'string' && cell.value.match('[A-Za-z]+') !== null) ||\n                cell.value === '' || isNullOrUndefined(cell.value)) {\n                isEnable = true;\n            }\n            else {\n                isEnable = false;\n            }\n            var hyperlink = cell.hyperlink;\n            if (typeof (hyperlink) === 'string') {\n                var hl = hyperlink;\n                if (hl.indexOf('http://') === -1 && hl.indexOf('https://') === -1 && hl.indexOf('ftp://') === -1) {\n                    address = hyperlink;\n                    isWeb = false;\n                }\n            }\n            else if (typeof (hyperlink) === 'object') {\n                var hl = hyperlink.address;\n                if (hl.indexOf('http://') === -1 && hl.indexOf('https://') === -1 && hl.indexOf('ftp://') === -1) {\n                    address = hyperlink.address;\n                    isWeb = false;\n                }\n            }\n            if (isWeb) {\n                selIdx = 0;\n            }\n            else {\n                selIdx = 1;\n            }\n            if (this.parent.definedNames) {\n                for (var idx_1 = 0; idx_1 < this.parent.definedNames.length; idx_1++) {\n                    if (this.parent.definedNames[idx_1].name === address) {\n                        isDefinedName = true;\n                        isCellRef = false;\n                        break;\n                    }\n                }\n            }\n        }\n        var dialogElem = this.parent.createElement('div', { className: 'e-link-dialog' });\n        var webContElem = this.parent.createElement('div', { className: 'e-webpage' });\n        var docContElem = this.parent.createElement('div', { className: 'e-document' });\n        var headerTabs = new Tab({\n            selectedItem: selIdx,\n            items: [\n                {\n                    header: { 'text': l10n.getConstant('WebPage') },\n                    content: webContElem\n                },\n                {\n                    header: { 'text': l10n.getConstant('ThisDocument') },\n                    content: docContElem\n                },\n            ]\n        });\n        headerTabs.appendTo(dialogElem);\n        if (isWeb) {\n            dialogElem.querySelector('.e-toolbar-items').querySelector('.e-indicator').setAttribute('style', 'left: 0; right: 136px');\n        }\n        else {\n            dialogElem.querySelector('.e-toolbar-items').querySelector('.e-indicator').setAttribute('style', 'left: 136px; right: 0');\n        }\n        var textCont = this.parent.createElement('div', { className: 'e-cont' });\n        var urlCont = this.parent.createElement('div', { className: 'e-cont' });\n        var textH = this.parent.createElement('div', { className: 'e-header', innerHTML: l10n.getConstant('DisplayText') });\n        var urlH = this.parent.createElement('div', { className: 'e-header', innerHTML: l10n.getConstant('Url') });\n        var textInput = this.parent.createElement('input', { className: 'e-input e-text', attrs: { 'type': 'Text' }, });\n        if (!isEnable) {\n            textInput.classList.add('e-disabled');\n            textInput.setAttribute('readonly', 'true');\n            textInput.setAttribute('disabled', 'true');\n        }\n        if (cell && isNullOrUndefined(cell.hyperlink)) {\n            textInput.setAttribute('value', this.parent.getDisplayText(cell));\n        }\n        var urlInput = this.parent.createElement('input', { className: 'e-input e-text', attrs: { 'type': 'Text' } });\n        textInput.setAttribute('placeholder', l10n.getConstant('EnterTheTextToDisplay'));\n        urlInput.setAttribute('placeholder', l10n.getConstant('EnterTheUrl'));\n        textCont.appendChild(textInput);\n        textCont.insertBefore(textH, textInput);\n        urlCont.appendChild(urlInput);\n        urlCont.insertBefore(urlH, urlInput);\n        webContElem.appendChild(urlCont);\n        webContElem.insertBefore(textCont, urlCont);\n        var cellRef = [];\n        var definedName = [];\n        var sheets = this.parent.sheets;\n        for (idx; idx < this.parent.sheets.length; idx++) {\n            var sheetName = this.parent.sheets[idx].name;\n            if (sheets[idx] === this.parent.getActiveSheet()) {\n                cellRef.push({\n                    nodeId: 'sheet',\n                    nodeText: sheetName.indexOf(' ') !== -1 ? '\\'' + sheetName + '\\'' : sheetName,\n                    selected: true\n                });\n            }\n            else {\n                cellRef.push({\n                    nodeId: 'sheet',\n                    nodeText: sheetName.indexOf(' ') !== -1 ? '\\'' + sheetName + '\\'' : sheetName\n                });\n            }\n        }\n        for (idx = 0; idx < this.parent.definedNames.length; idx++) {\n            definedName.push({\n                nodeId: 'defName',\n                nodeText: this.parent.definedNames[idx].name\n            });\n        }\n        var data = [\n            {\n                nodeId: '01', nodeText: l10n.getConstant('CellReference'), expanded: isCellRef,\n                nodeChild: cellRef\n            },\n            {\n                nodeId: '02', nodeText: l10n.getConstant('DefinedNames'), expanded: isDefinedName,\n                nodeChild: definedName\n            },\n        ];\n        var treeObj = new TreeView({\n            fields: { dataSource: data, id: 'nodeId', text: 'nodeText', child: 'nodeChild' }\n        });\n        var cellrefCont = this.parent.createElement('div', { className: 'e-cont' });\n        var cellrefH = this.parent.createElement('div', { className: 'e-header', innerHTML: l10n.getConstant('CellReference') });\n        var cellrefInput = this.parent.createElement('input', {\n            className: 'e-input e-text e-hyp-text',\n            attrs: { 'type': 'Text' }\n        });\n        cellrefInput.setAttribute('value', 'A1');\n        cellrefCont.appendChild(cellrefInput);\n        cellrefCont.insertBefore(cellrefH, cellrefInput);\n        var textCont1 = this.parent.createElement('div', { className: 'e-cont' });\n        var textH1 = this.parent.createElement('div', { className: 'e-header', innerHTML: l10n.getConstant('DisplayText') });\n        var textInput1 = this.parent.createElement('input', { className: 'e-input e-text', attrs: { 'type': 'Text' } });\n        if (!isEnable) {\n            textInput1.classList.add('e-disabled');\n            textInput1.setAttribute('readonly', 'true');\n            textInput1.setAttribute('disabled', 'true');\n        }\n        if (cell && isNullOrUndefined(cell.hyperlink)) {\n            textInput1.setAttribute('value', this.parent.getDisplayText(cell));\n        }\n        textInput1.setAttribute('placeholder', l10n.getConstant('EnterTheTextToDisplay'));\n        textCont1.appendChild(textInput1);\n        textCont1.insertBefore(textH1, textInput1);\n        var sheetCont = this.parent.createElement('div', { className: 'e-cont' });\n        var sheetH = this.parent.createElement('div', { className: 'e-header', innerHTML: l10n.getConstant('Sheet') });\n        var refCont = this.parent.createElement('div', { className: 'e-refcont' });\n        sheetCont.appendChild(refCont);\n        sheetCont.insertBefore(sheetH, refCont);\n        docContElem.appendChild(cellrefCont);\n        docContElem.insertBefore(textCont1, cellrefCont);\n        treeObj.appendTo(refCont);\n        docContElem.appendChild(sheetCont);\n        return dialogElem;\n    };\n    return SpreadsheetHyperlink;\n}());\nexport { SpreadsheetHyperlink };\n","import { locale, deleteImage, createImageElement } from '../../spreadsheet/index';\nimport { performUndoRedo, updateUndoRedoCollection, enableToolbarItems, completeAction } from '../common/index';\nimport { setActionData, getBeforeActionData, updateAction, initiateFilterUI } from '../common/index';\nimport { setUndoRedo } from '../common/index';\nimport { selectRange, clearUndoRedoCollection, setMaxHgt, getMaxHgt, setRowEleHeight } from '../common/index';\nimport { getRangeFromAddress, getRangeIndexes, getSheet, workbookEditOperation } from '../../workbook/index';\nimport { getCell, setCell, getSheetIndex, wrapEvent, getSheetIndexFromId } from '../../workbook/index';\nimport { setMerge, getRangeAddress, getColumnHeaderText } from '../../workbook/index';\nimport { addClass } from '@syncfusion/ej2-base';\nimport { getFilteredCollection } from '../../workbook/index';\n/**\n * UndoRedo module allows to perform undo redo functionalities.\n */\nvar UndoRedo = /** @class */ (function () {\n    function UndoRedo(parent) {\n        this.undoCollection = [];\n        this.redoCollection = [];\n        this.isUndo = false;\n        this.undoRedoStep = 100;\n        this.parent = parent;\n        this.addEventListener();\n    }\n    UndoRedo.prototype.setActionData = function (options) {\n        var sheet = this.parent.getActiveSheet();\n        var address;\n        var cells = [];\n        var cutCellDetails = [];\n        var args = options.args;\n        var eventArgs = args.eventArgs;\n        switch (args.action) {\n            case 'format':\n                address = getRangeIndexes(args.eventArgs.range);\n                break;\n            case 'clipboard':\n                var copiedInfo = eventArgs.copiedInfo;\n                address = getRangeIndexes(getRangeFromAddress(eventArgs.pastedRange));\n                if (copiedInfo.isCut) {\n                    cutCellDetails = this.getCellDetails(copiedInfo.range, getSheet(this.parent, getSheetIndexFromId(this.parent, copiedInfo.sId)));\n                }\n                break;\n            case 'beforeSort':\n                address = getRangeIndexes(args.eventArgs.range);\n                if (address[0] === address[2] && (address[2] - address[0]) === 0) { //if selected range is a single cell \n                    address[0] = 0;\n                    address[1] = 0;\n                    address[2] = sheet.usedRange.rowIndex;\n                    address[3] = sheet.usedRange.colIndex;\n                }\n                break;\n            case 'beforeCellSave':\n                address = getRangeIndexes(eventArgs.address);\n                break;\n            case 'beforeWrap':\n                address = this.parent.getAddressInfo(eventArgs.address).indices;\n                break;\n            case 'beforeReplace':\n                address = this.parent.getAddressInfo(eventArgs.address).indices;\n                break;\n            case 'beforeClear':\n                address = getRangeIndexes(eventArgs.range);\n                break;\n            case 'beforeInsertImage':\n                address = getRangeIndexes(eventArgs.range);\n                break;\n            case 'beforeInsertChart':\n                address = getRangeIndexes(eventArgs.range);\n                break;\n            case 'filter':\n                address = getRangeIndexes(eventArgs.range);\n                break;\n        }\n        cells = this.getCellDetails(address, sheet);\n        this.beforeActionData = { cellDetails: cells, cutCellDetails: cutCellDetails };\n    };\n    UndoRedo.prototype.getBeforeActionData = function (args) {\n        args.beforeDetails = this.beforeActionData;\n    };\n    UndoRedo.prototype.performUndoRedo = function (args) {\n        var undoRedoArgs = args.isUndo ? this.undoCollection.pop() : this.redoCollection.pop();\n        this.isUndo = args.isUndo;\n        if (undoRedoArgs) {\n            switch (undoRedoArgs.action) {\n                case 'cellSave':\n                case 'format':\n                case 'sorting':\n                case 'wrap':\n                    undoRedoArgs = this.performOperation(undoRedoArgs);\n                    break;\n                case 'clipboard':\n                    undoRedoArgs = this.undoForClipboard(undoRedoArgs);\n                    break;\n                case 'resize':\n                    undoRedoArgs = this.undoForResize(undoRedoArgs);\n                    break;\n                case 'hideShow':\n                    undoRedoArgs.eventArgs.hide = !undoRedoArgs.eventArgs.hide;\n                    updateAction(undoRedoArgs, this.parent);\n                    break;\n                case 'replace':\n                    undoRedoArgs = this.performOperation(undoRedoArgs);\n                    break;\n                case 'insert':\n                case 'filter':\n                    updateAction(undoRedoArgs, this.parent, !args.isUndo);\n                    break;\n                case 'delete':\n                    updateAction(undoRedoArgs, this.parent, !args.isUndo);\n                    break;\n                case 'validation':\n                    updateAction(undoRedoArgs, this.parent, !args.isUndo);\n                    break;\n                case 'merge':\n                    undoRedoArgs.eventArgs.merge = !undoRedoArgs.eventArgs.merge;\n                    updateAction(undoRedoArgs, this.parent);\n                    break;\n                case 'clear':\n                    undoRedoArgs = this.performOperation(undoRedoArgs);\n                    break;\n                case 'conditionalFormat':\n                    updateAction(undoRedoArgs, this.parent, !args.isUndo);\n                    break;\n                case 'clearCF':\n                    updateAction(undoRedoArgs, this.parent, !args.isUndo);\n                    break;\n                case 'insertImage':\n                    updateAction(undoRedoArgs, this.parent, !args.isUndo);\n                    break;\n                case 'imageRefresh':\n                    updateAction(undoRedoArgs, this.parent, !args.isUndo);\n                    break;\n                case 'insertChart':\n                case 'deleteChart':\n                    updateAction(undoRedoArgs, this.parent, !args.isUndo);\n                    break;\n                case 'chartRefresh':\n                    updateAction(undoRedoArgs, this.parent, !args.isUndo);\n                    break;\n            }\n            args.isUndo ? this.redoCollection.push(undoRedoArgs) : this.undoCollection.push(undoRedoArgs);\n            if (this.undoCollection.length > this.undoRedoStep) {\n                this.undoCollection.splice(0, 1);\n            }\n            if (this.redoCollection.length > this.undoRedoStep) {\n                this.redoCollection.splice(0, 1);\n            }\n            this.updateUndoRedoIcons();\n            var completeArgs = Object.assign({}, undoRedoArgs.eventArgs);\n            completeArgs.requestType = args.isUndo ? 'undo' : 'redo';\n            delete completeArgs.beforeActionData;\n            if (!args.isPublic) {\n                this.parent.notify(completeAction, { eventArgs: completeArgs, action: 'undoRedo' });\n            }\n        }\n    };\n    UndoRedo.prototype.updateUndoRedoCollection = function (options) {\n        var actionList = ['clipboard', 'format', 'sorting', 'cellSave', 'resize', 'resizeToFit', 'wrap', 'hideShow', 'replace',\n            'validation', 'merge', 'clear', 'conditionalFormat', 'clearCF', 'insertImage', 'imageRefresh', 'insertChart', 'deleteChart',\n            'chartRefresh', 'filter'];\n        if ((options.args.action === 'insert' || options.args.action === 'delete') && options.args.eventArgs.modelType !== 'Sheet') {\n            actionList.push(options.args.action);\n        }\n        var action = options.args.action;\n        if (actionList.indexOf(action) === -1 && !options.isPublic) {\n            return;\n        }\n        var eventArgs = options.args.eventArgs;\n        if (action === 'clipboard' || action === 'sorting' || action === 'format' || action === 'cellSave' ||\n            action === 'wrap' || action === 'replace' || action === 'validation' || action === 'clear' || action === 'conditionalFormat' ||\n            action === 'clearCF' || action === 'insertImage' || action === 'imageRefresh' || action === 'insertChart' ||\n            action === 'chartRefresh' || action === 'filter') {\n            var beforeActionDetails = { beforeDetails: { cellDetails: [] } };\n            this.parent.notify(getBeforeActionData, beforeActionDetails);\n            eventArgs.beforeActionData = beforeActionDetails.beforeDetails;\n        }\n        this.undoCollection.push(options.args);\n        this.redoCollection = [];\n        if (this.undoCollection.length > this.undoRedoStep) {\n            this.undoCollection.splice(0, 1);\n        }\n        this.updateUndoRedoIcons();\n    };\n    UndoRedo.prototype.clearUndoRedoCollection = function () {\n        this.undoCollection = [];\n        this.redoCollection = [];\n        this.updateUndoRedoIcons();\n    };\n    UndoRedo.prototype.updateUndoRedoIcons = function () {\n        var l10n = this.parent.serviceLocator.getService(locale);\n        this.parent.notify(enableToolbarItems, [{\n                tab: l10n.getConstant('Home'), items: [this.parent.element.id + '_undo'],\n                enable: this.undoCollection.length > 0\n            }]);\n        this.parent.notify(enableToolbarItems, [{\n                tab: l10n.getConstant('Home'), items: [this.parent.element.id + '_redo'],\n                enable: this.redoCollection.length > 0\n            }]);\n    };\n    UndoRedo.prototype.undoForClipboard = function (args) {\n        var _this = this;\n        var eventArgs = args.eventArgs;\n        var address = eventArgs.pastedRange.split('!');\n        var range = getRangeIndexes(address[1]);\n        var sheetIndex = getSheetIndex(this.parent, address[0]);\n        var sheet = getSheet(this.parent, sheetIndex);\n        var copiedInfo = eventArgs.copiedInfo;\n        var actionData = eventArgs.beforeActionData;\n        var isRefresh = this.checkRefreshNeeded(sheetIndex);\n        var pictureElem;\n        if (args.eventArgs.requestType === 'imagePaste') {\n            var copiedShapeInfo = eventArgs.copiedShapeInfo;\n            if (this.isUndo) {\n                pictureElem = copiedShapeInfo.pictureElem;\n                if (copiedShapeInfo.isCut) {\n                    this.parent.notify(deleteImage, {\n                        id: pictureElem.id, sheetIdx: eventArgs.pasteSheetIndex + 1\n                    });\n                    this.parent.notify(createImageElement, {\n                        options: {\n                            data: pictureElem.style.backgroundImage.replace(/url\\((['\"])?(.*?)\\1\\)/gi, '$2'),\n                            height: copiedShapeInfo.height, width: copiedShapeInfo.width, imageId: pictureElem.id\n                        },\n                        range: copiedShapeInfo.copiedRange, isPublic: false, isUndoRedo: true\n                    });\n                }\n                else {\n                    this.parent.notify(deleteImage, {\n                        id: eventArgs.pastedPictureElement.id, sheetIdx: eventArgs.pasteSheetIndex + 1\n                    });\n                }\n            }\n            else {\n                if (copiedShapeInfo.isCut) {\n                    pictureElem = copiedShapeInfo.pictureElem;\n                    this.parent.notify(deleteImage, {\n                        id: pictureElem.id, sheetIdx: copiedShapeInfo.sId\n                    });\n                    this.parent.notify(createImageElement, {\n                        options: {\n                            data: pictureElem.style.backgroundImage.replace(/url\\((['\"])?(.*?)\\1\\)/gi, '$2'),\n                            height: copiedShapeInfo.height, width: copiedShapeInfo.width, imageId: pictureElem.id\n                        },\n                        range: copiedShapeInfo.pastedRange, isPublic: false, isUndoRedo: true\n                    });\n                }\n                else {\n                    pictureElem = eventArgs.pastedPictureElement;\n                    this.parent.notify(createImageElement, {\n                        options: {\n                            data: pictureElem.style.backgroundImage.replace(/url\\((['\"])?(.*?)\\1\\)/gi, '$2'),\n                            height: pictureElem.offsetHeight, width: pictureElem.offsetWidth, imageId: pictureElem.id\n                        },\n                        range: copiedShapeInfo.pastedRange, isPublic: false, isUndoRedo: true\n                    });\n                }\n            }\n        }\n        else {\n            if (this.isUndo) {\n                if (copiedInfo.isCut) {\n                    var cells = actionData.cutCellDetails;\n                    this.updateCellDetails(cells, getSheet(this.parent, getSheetIndexFromId(this.parent, copiedInfo.sId)), copiedInfo.range, isRefresh);\n                    this.parent.notify(getFilteredCollection, null);\n                    for (var i = 0; i < this.parent.sheets.length; i++) {\n                        var sheetIndex_1 = getSheetIndexFromId(this.parent, copiedInfo.sId);\n                        if (this.parent.filterCollection && this.parent.filterCollection[i] &&\n                            this.parent.filterCollection[i].sheetIdx === eventArgs.pasteSheetIndex) {\n                            var filterCol = this.parent.filterCollection[i];\n                            var fRange = getRangeIndexes(filterCol.filterRange);\n                            var endCol = getColumnHeaderText(range[3]);\n                            var fEndCol = getColumnHeaderText(fRange[3]);\n                            if (fRange[0] === range[0] && fRange[1] === range[1] && endCol === fEndCol) {\n                                this.parent.notify(initiateFilterUI, {\n                                    predicates: null, range: filterCol.filterRange,\n                                    sIdx: eventArgs.pasteSheetIndex, isCut: true\n                                });\n                                this.parent.notify(initiateFilterUI, {\n                                    predicates: null,\n                                    range: getRangeAddress(copiedInfo.range), sIdx: sheetIndex_1, isCut: true\n                                });\n                            }\n                        }\n                    }\n                }\n                this.updateCellDetails(actionData.cellDetails, sheet, range, isRefresh);\n                setMaxHgt(sheet, range[0], range[1], 20);\n                var hgt = getMaxHgt(sheet, range[0]);\n                setRowEleHeight(this.parent, sheet, hgt, range[0]);\n                eventArgs.mergeCollection.forEach(function (mergeArgs) {\n                    mergeArgs.merge = !mergeArgs.merge;\n                    _this.parent.notify(setMerge, mergeArgs);\n                    mergeArgs.merge = !mergeArgs.merge;\n                });\n            }\n            else {\n                updateAction(args, this.parent, copiedInfo.isCut);\n            }\n            if (isRefresh) {\n                this.parent.notify(selectRange, { indexes: range });\n            }\n        }\n        return args;\n    };\n    UndoRedo.prototype.undoForResize = function (args) {\n        var eventArgs = args.eventArgs;\n        if (eventArgs.hide === undefined) {\n            if (eventArgs.isCol) {\n                var temp = eventArgs.oldWidth;\n                eventArgs.oldWidth = eventArgs.width;\n                eventArgs.width = temp;\n            }\n            else {\n                var temp = eventArgs.oldHeight;\n                eventArgs.oldHeight = eventArgs.height;\n                eventArgs.height = temp;\n            }\n        }\n        else {\n            eventArgs.hide = !eventArgs.hide;\n        }\n        updateAction(args, this.parent);\n        return args;\n    };\n    UndoRedo.prototype.performOperation = function (args) {\n        var eventArgs = args.eventArgs;\n        var address = (args.action === 'cellSave' || args.action === 'wrap' || args.action === 'replace') ?\n            eventArgs.address.split('!')\n            : eventArgs.range.split('!');\n        var range = getRangeIndexes(address[1]);\n        var sheetIndex = getSheetIndex(this.parent, address[0]);\n        var sheet = getSheet(this.parent, sheetIndex);\n        var actionData = eventArgs.beforeActionData;\n        var isRefresh = this.checkRefreshNeeded(sheetIndex);\n        if (this.isUndo) {\n            this.updateCellDetails(actionData.cellDetails, sheet, range, isRefresh, args);\n            setMaxHgt(sheet, range[0], range[1], 20);\n            var hgt = getMaxHgt(sheet, range[0]);\n            setRowEleHeight(this.parent, sheet, hgt, range[0]);\n        }\n        else {\n            updateAction(args, this.parent);\n        }\n        if (isRefresh) {\n            this.parent.notify(selectRange, { indexes: range });\n        }\n        return args;\n    };\n    UndoRedo.prototype.getCellDetails = function (address, sheet) {\n        var cells = [];\n        var cell;\n        for (var i = address[0]; i <= address[2]; i++) {\n            for (var j = address[1]; j <= address[3]; j++) {\n                cell = getCell(i, j, sheet);\n                cells.push({\n                    rowIndex: i, colIndex: j, format: cell ? cell.format : null,\n                    style: cell && cell.style ? Object.assign({}, cell.style) : null, value: cell ? cell.value : '', formula: cell ?\n                        cell.formula : '', wrap: cell && cell.wrap, rowSpan: cell && cell.rowSpan, colSpan: cell && cell.colSpan,\n                    hyperlink: cell && cell.hyperlink, image: cell && cell.image && cell.chart\n                });\n            }\n        }\n        return cells;\n    };\n    UndoRedo.prototype.updateCellDetails = function (cells, sheet, range, isRefresh, args) {\n        var len = cells.length;\n        var cellElem;\n        for (var i = 0; i < len; i++) {\n            setCell(cells[i].rowIndex, cells[i].colIndex, sheet, {\n                value: cells[i].value, format: cells[i].format,\n                style: cells[i].style && Object.assign({}, cells[i].style), formula: cells[i].formula,\n                wrap: cells[i].wrap, rowSpan: cells[i].rowSpan,\n                colSpan: cells[i].colSpan, hyperlink: cells[i].hyperlink\n            });\n            if (cells[i].formula) {\n                this.parent.notify(workbookEditOperation, {\n                    action: 'updateCellValue', address: [cells[i].rowIndex, cells[i].colIndex, cells[i].rowIndex,\n                        cells[i].colIndex], value: cells[i].formula\n                });\n            }\n            if (args && args.action === 'wrap' && args.eventArgs.wrap) {\n                this.parent.notify(wrapEvent, {\n                    range: [cells[i].rowIndex, cells[i].colIndex, cells[i].rowIndex,\n                        cells[i].colIndex], wrap: false, sheet: sheet\n                });\n            }\n            if (args && cells[i].hyperlink && args.action === 'clear') {\n                args.eventArgs.range = sheet.name + '!' + getRangeAddress([cells[i].rowIndex, cells[i].colIndex, cells[i].rowIndex,\n                    cells[i].colIndex]);\n                cellElem = this.parent.getCell(cells[i].rowIndex, cells[i].colIndex);\n                if (args.eventArgs.type === 'Clear All' || args.eventArgs.type === 'Clear Hyperlinks') {\n                    this.parent.addHyperlink(cells[i].hyperlink, args.eventArgs.range);\n                }\n                else if (args.eventArgs.type === 'Clear Formats') {\n                    addClass(cellElem.querySelectorAll('.e-hyperlink'), 'e-hyperlink-style');\n                }\n            }\n        }\n        if (isRefresh) {\n            this.parent.serviceLocator.getService('cell').refreshRange(range);\n        }\n    };\n    UndoRedo.prototype.checkRefreshNeeded = function (sheetIndex) {\n        var isRefresh = true;\n        if (sheetIndex !== this.parent.activeSheetIndex) {\n            this.parent.activeSheetIndex = sheetIndex;\n            this.parent.dataBind();\n            isRefresh = false;\n        }\n        return isRefresh;\n    };\n    UndoRedo.prototype.addEventListener = function () {\n        this.parent.on(performUndoRedo, this.performUndoRedo, this);\n        this.parent.on(updateUndoRedoCollection, this.updateUndoRedoCollection, this);\n        this.parent.on(setActionData, this.setActionData, this);\n        this.parent.on(getBeforeActionData, this.getBeforeActionData, this);\n        this.parent.on(clearUndoRedoCollection, this.clearUndoRedoCollection, this);\n        this.parent.on(setUndoRedo, this.updateUndoRedoIcons, this);\n    };\n    UndoRedo.prototype.removeEventListener = function () {\n        if (!this.parent.isDestroyed) {\n            this.parent.off(performUndoRedo, this.performUndoRedo);\n            this.parent.off(updateUndoRedoCollection, this.updateUndoRedoCollection);\n            this.parent.off(setActionData, this.setActionData);\n            this.parent.off(getBeforeActionData, this.getBeforeActionData);\n            this.parent.off(clearUndoRedoCollection, this.clearUndoRedoCollection);\n            this.parent.off(setUndoRedo, this.updateUndoRedoIcons);\n        }\n    };\n    /**\n     * Destroy undo redo module.\n     */\n    UndoRedo.prototype.destroy = function () {\n        this.removeEventListener();\n        this.parent = null;\n    };\n    /**\n     * Get the undo redo module name.\n     */\n    UndoRedo.prototype.getModuleName = function () {\n        return 'undoredo';\n    };\n    return UndoRedo;\n}());\nexport { UndoRedo };\n","import { closest, Browser } from '@syncfusion/ej2-base';\nimport { ribbonClick, inView, setMaxHgt, getMaxHgt, WRAPTEXT, setRowEleHeight, rowHeightChanged, beginAction } from '../common/index';\nimport { completeAction, getTextHeight, getLines, } from '../common/index';\nimport { getCell, wrap as wrapText, wrapEvent, getRow } from '../../workbook/index';\nimport { getRowHeight, getAddressFromSelectedRange, getColumnsWidth } from '../../workbook/index';\n/**\n * Represents Wrap Text support for Spreadsheet.\n */\nvar WrapText = /** @class */ (function () {\n    /**\n     * Constructor for the Spreadsheet Wrap Text module.\n     * @private\n     */\n    function WrapText(parent) {\n        this.parent = parent;\n        this.addEventListener();\n    }\n    WrapText.prototype.addEventListener = function () {\n        this.parent.on(ribbonClick, this.ribbonClickHandler, this);\n        this.parent.on(wrapEvent, this.wrapTextHandler, this);\n        this.parent.on(rowHeightChanged, this.rowHeightChangedHandler, this);\n    };\n    WrapText.prototype.removeEventListener = function () {\n        if (!this.parent.isDestroyed) {\n            this.parent.off(ribbonClick, this.ribbonClickHandler);\n            this.parent.off(wrapEvent, this.wrapTextHandler);\n            this.parent.off(rowHeightChanged, this.rowHeightChangedHandler);\n        }\n    };\n    WrapText.prototype.wrapTextHandler = function (args) {\n        if (inView(this.parent, args.range, true)) {\n            var ele = void 0;\n            var cell = void 0;\n            var colwidth = void 0;\n            var isCustomHgt = void 0;\n            var maxHgt = void 0;\n            var hgt = void 0;\n            for (var i = args.range[0]; i <= args.range[2]; i++) {\n                maxHgt = 0;\n                isCustomHgt = getRow(args.sheet, i).customHeight;\n                for (var j = args.range[1]; j <= args.range[3]; j++) {\n                    ele = args.initial ? args.td : this.parent.getCell(i, j);\n                    if (ele) {\n                        args.wrap ? ele.classList.add(WRAPTEXT) : ele.classList.remove(WRAPTEXT);\n                        if (isCustomHgt) {\n                            ele.innerHTML\n                                = this.parent.createElement('span', { className: 'e-wrap-content', innerHTML: ele.innerHTML }).outerHTML;\n                        }\n                    }\n                    if (Browser.isIE) {\n                        ele.classList.add('e-ie-wrap');\n                    }\n                    if (!isCustomHgt) {\n                        cell = getCell(i, j, args.sheet);\n                        colwidth = getColumnsWidth(args.sheet, j, cell.colSpan > 1 ? j + cell.colSpan - 1 : j);\n                        var displayText = this.parent.getDisplayText(cell);\n                        if (displayText.indexOf('\\n') < 0) {\n                            var editElem = this.parent.element.querySelector('.e-spreadsheet-edit');\n                            if (editElem) {\n                                if (editElem.textContent.indexOf('\\n') > -1) {\n                                    displayText = editElem.textContent;\n                                }\n                            }\n                        }\n                        if (displayText) {\n                            if (args.wrap) {\n                                if (ele && ele.classList.contains('e-alt-unwrap')) {\n                                    ele.classList.remove('e-alt-unwrap');\n                                }\n                                var lines = void 0;\n                                var n = 0;\n                                var p = void 0;\n                                if (displayText.indexOf('\\n') > -1) {\n                                    var splitVal = displayText.split('\\n');\n                                    var valLength = splitVal.length;\n                                    for (p = 0; p < valLength; p++) {\n                                        lines = getLines(splitVal[p], colwidth, cell.style, this.parent.cellStyle);\n                                        if (lines === 0) {\n                                            lines = 1; // for empty new line\n                                        }\n                                        n = n + lines;\n                                    }\n                                    lines = n;\n                                }\n                                else {\n                                    lines = getLines(displayText, colwidth, cell.style, this.parent.cellStyle);\n                                }\n                                hgt = getTextHeight(this.parent, cell.style || this.parent.cellStyle, lines) + 1;\n                                maxHgt = Math.max(maxHgt, hgt);\n                                setMaxHgt(args.sheet, i, j, hgt);\n                            }\n                            else {\n                                if (displayText.indexOf('\\n') > -1) {\n                                    ele.classList.add('e-alt-unwrap');\n                                }\n                                hgt = getTextHeight(this.parent, cell.style || this.parent.cellStyle, 1);\n                                setMaxHgt(args.sheet, i, j, hgt);\n                                maxHgt = Math.max(getMaxHgt(args.sheet, i), 20);\n                            }\n                        }\n                        else if (!args.wrap) {\n                            setMaxHgt(args.sheet, i, j, 20);\n                            maxHgt = 20;\n                        }\n                        if (j === args.range[3] && ((args.wrap && maxHgt > 20 && getMaxHgt(args.sheet, i) <= maxHgt) || (!args.wrap\n                            && getMaxHgt(args.sheet, i) < getRowHeight(args.sheet, i) && getRowHeight(args.sheet, i) > 20))) {\n                            setRowEleHeight(this.parent, args.sheet, maxHgt, i, args.row, args.hRow);\n                        }\n                    }\n                }\n            }\n        }\n    };\n    WrapText.prototype.ribbonClickHandler = function (args) {\n        var target = closest(args.originalEvent.target, '.e-btn');\n        if (target && target.id === this.parent.element.id + '_wrap') {\n            var wrap = target.classList.contains('e-active');\n            var address = getAddressFromSelectedRange(this.parent.getActiveSheet());\n            var eventArgs = { address: address, wrap: wrap, cancel: false };\n            this.parent.notify(beginAction, { action: 'beforeWrap', eventArgs: eventArgs });\n            if (!eventArgs.cancel) {\n                wrapText(this.parent.getActiveSheet().selectedRange, wrap, this.parent);\n                this.parent.notify(completeAction, { action: 'wrap', eventArgs: { address: address, wrap: wrap } });\n            }\n        }\n    };\n    WrapText.prototype.getTextWidth = function (text, style) {\n        if (style === void 0) { style = this.parent.cellStyle; }\n        var defaultStyle = this.parent.cellStyle;\n        var canvas = document.createElement('canvas');\n        var context = canvas.getContext('2d');\n        context.font = (style.fontStyle || defaultStyle.fontStyle) + ' ' + (style.fontWeight || defaultStyle.fontWeight) + ' '\n            + (style.fontSize || defaultStyle.fontSize) + ' ' + (style.fontFamily || defaultStyle.fontFamily);\n        return context.measureText(text).width;\n    };\n    WrapText.prototype.rowHeightChangedHandler = function (args) {\n        if (args.isCustomHgt) {\n            var sheet = this.parent.getActiveSheet();\n            var leftIdx = this.parent.viewport.leftIndex;\n            var rightIdx = leftIdx + this.parent.viewport.colCount + this.parent.getThreshold('col') * 2;\n            for (var i = leftIdx; i < rightIdx; i++) {\n                var cell = getCell(args.rowIdx, i, sheet);\n                if (cell && cell.wrap) {\n                    var ele = this.parent.getCell(args.rowIdx, i);\n                    ele.innerHTML = this.parent.createElement('span', { className: 'e-wrap-content', innerHTML: ele.innerHTML }).outerHTML;\n                }\n            }\n        }\n    };\n    /**\n     * For internal use only - Get the module name.\n     * @private\n     */\n    WrapText.prototype.getModuleName = function () {\n        return 'wrapText';\n    };\n    WrapText.prototype.destroy = function () {\n        this.removeEventListener();\n        this.parent = null;\n    };\n    return WrapText;\n}());\nexport { WrapText };\n","import { beginAction, completeAction, insertSheetTab, skipHiddenIdx, refreshImagePosition } from '../common/index';\nimport { insert, dataChanged } from '../../workbook/common/index';\nimport { getCell } from '../../workbook/index';\n/**\n * The `Insert` module is used to insert cells, rows, columns and sheets in to the spreadsheet.\n */\nvar Insert = /** @class */ (function () {\n    /**\n     * Constructor for the Spreadsheet insert module.\n     * @private\n     */\n    function Insert(parent) {\n        this.parent = parent;\n        this.addEventListener();\n    }\n    Insert.prototype.insert = function (args) {\n        var isAction;\n        if (args.isAction) {\n            isAction = true;\n            delete args.isAction;\n        }\n        if (isAction) {\n            this.parent.notify(beginAction, { eventArgs: args, action: 'insert' });\n        }\n        switch (args.modelType) {\n            case 'Sheet':\n                this.parent.notify(insertSheetTab, { startIdx: args.index, endIdx: args.index + (args.model.length - 1), preventUpdate: !isAction });\n                if (args.index === this.parent.activeSheetIndex) {\n                    this.parent.renderModule.refreshSheet();\n                }\n                this.parent.element.focus();\n                break;\n            case 'Row':\n                if (!this.parent.scrollSettings.enableVirtualization || args.index <= this.parent.viewport.bottomIndex) {\n                    if (this.parent.scrollSettings.enableVirtualization) {\n                        if (args.index < this.parent.viewport.topIndex) {\n                            this.parent.viewport.topIndex += args.model.length;\n                        }\n                        this.parent.renderModule.refreshUI({\n                            skipUpdateOnFirst: this.parent.viewport.topIndex === skipHiddenIdx(this.parent.getActiveSheet(), 0, true), rowIndex: this.parent.viewport.topIndex, colIndex: this.parent.viewport.leftIndex, refresh: 'Row'\n                        });\n                    }\n                    else {\n                        this.parent.renderModule.refreshUI({ skipUpdateOnFirst: true, rowIndex: args.index, colIndex: 0, refresh: 'Row' });\n                    }\n                    this.parent.notify(dataChanged, args);\n                    this.parent.selectRange(this.parent.getActiveSheet().selectedRange);\n                }\n                break;\n            case 'Column':\n                if (!this.parent.scrollSettings.enableVirtualization || args.index <= this.parent.viewport.rightIndex) {\n                    if (this.parent.scrollSettings.enableVirtualization) {\n                        if (args.index < this.parent.viewport.leftIndex) {\n                            this.parent.viewport.leftIndex += args.model.length;\n                        }\n                        this.parent.renderModule.refreshUI({\n                            skipUpdateOnFirst: this.parent.viewport.leftIndex === skipHiddenIdx(this.parent.getActiveSheet(), 0, true, 'columns'), rowIndex: this.parent.viewport.topIndex, colIndex: this.parent.viewport.leftIndex, refresh: 'Column'\n                        });\n                    }\n                    else {\n                        this.parent.renderModule.refreshUI({\n                            skipUpdateOnFirst: true, rowIndex: 0, colIndex: args.index, refresh: 'Column'\n                        });\n                    }\n                    this.parent.selectRange(this.parent.getActiveSheet().selectedRange);\n                }\n                break;\n        }\n        this.refreshImgElement(args.model.length, this.parent.activeSheetIndex, args.modelType, args.index);\n        if (isAction) {\n            this.parent.notify(completeAction, { eventArgs: args, action: 'insert' });\n        }\n    };\n    Insert.prototype.refreshImgElement = function (count, sheetIdx, modelType, index) {\n        var sheet = this.parent.sheets[sheetIdx];\n        var cellObj;\n        var indexes = [0, 0, sheet.usedRange.rowIndex, sheet.usedRange.colIndex];\n        for (var i = 0; i <= indexes[2]; i++) {\n            for (var j = indexes[1]; j <= indexes[3]; j++) {\n                cellObj = getCell(i, j, sheet);\n                if (cellObj && cellObj.image && cellObj.image.length > 0) {\n                    if ((modelType === 'Row' && i >= index) || (modelType === 'Column' && j >= index)) {\n                        this.parent.notify(refreshImagePosition, {\n                            rowIdx: i, colIdx: j, sheetIdx: sheetIdx, type: modelType, count: count, status: 'insert'\n                        });\n                    }\n                }\n            }\n        }\n    };\n    Insert.prototype.addEventListener = function () {\n        this.parent.on(insert, this.insert, this);\n    };\n    /**\n     * Destroy insert module.\n     */\n    Insert.prototype.destroy = function () {\n        this.removeEventListener();\n        this.parent = null;\n    };\n    Insert.prototype.removeEventListener = function () {\n        if (!this.parent.isDestroyed) {\n            this.parent.off(insert, this.insert);\n        }\n    };\n    /**\n     * Get the insert module name.\n     */\n    Insert.prototype.getModuleName = function () {\n        return 'insert';\n    };\n    return Insert;\n}());\nexport { Insert };\n","import { beginAction, completeAction, skipHiddenIdx, refreshSheetTabs, refreshImagePosition } from '../common/index';\nimport { deleteAction, dataChanged } from '../../workbook/common/index';\nimport { getCell } from '../../workbook/index';\n/**\n * The `Delete` module is used to delete cells, rows, columns and sheets from the spreadsheet.\n */\nvar Delete = /** @class */ (function () {\n    /**\n     * Constructor for the Spreadsheet insert module.\n     * @private\n     */\n    function Delete(parent) {\n        this.parent = parent;\n        this.addEventListener();\n    }\n    Delete.prototype.delete = function (args) {\n        var isAction;\n        if (args.isAction) {\n            isAction = true;\n            delete args.isAction;\n        }\n        if (isAction) {\n            this.parent.notify(beginAction, { eventArgs: args, action: 'delete' });\n        }\n        if (args.modelType === 'Sheet') {\n            this.parent.setProperties({ activeSheetIndex: args.activeSheetIndex - 1 }, true);\n            this.parent.notify(refreshSheetTabs, this);\n            this.parent.renderModule.refreshSheet();\n            this.parent.element.focus();\n        }\n        else if (args.modelType === 'Row') {\n            if (!this.parent.scrollSettings.enableVirtualization || args.startIndex <= this.parent.viewport.bottomIndex) {\n                if (this.parent.scrollSettings.enableVirtualization) {\n                    if (args.startIndex < this.parent.viewport.topIndex) {\n                        this.parent.viewport.topIndex -= args.model.length;\n                    }\n                    this.parent.renderModule.refreshUI({\n                        skipUpdateOnFirst: this.parent.viewport.topIndex === skipHiddenIdx(this.parent.getActiveSheet(), 0, true), rowIndex: this.parent.viewport.topIndex, refresh: 'Row',\n                        colIndex: this.parent.viewport.leftIndex\n                    });\n                }\n                else {\n                    this.parent.renderModule.refreshUI({ skipUpdateOnFirst: true, refresh: 'Row', rowIndex: args.startIndex, colIndex: 0 });\n                }\n            }\n            this.parent.selectRange(this.parent.getActiveSheet().selectedRange);\n        }\n        else {\n            if (!this.parent.scrollSettings.enableVirtualization || args.startIndex <= this.parent.viewport.rightIndex) {\n                if (this.parent.scrollSettings.enableVirtualization) {\n                    if (args.startIndex < this.parent.viewport.leftIndex) {\n                        this.parent.viewport.leftIndex -= args.model.length;\n                    }\n                    this.parent.renderModule.refreshUI({\n                        skipUpdateOnFirst: this.parent.viewport.leftIndex === skipHiddenIdx(this.parent.getActiveSheet(), 0, true, 'columns'), rowIndex: this.parent.viewport.topIndex, refresh: 'Column',\n                        colIndex: this.parent.viewport.leftIndex\n                    });\n                }\n                else {\n                    this.parent.renderModule.refreshUI({\n                        skipUpdateOnFirst: true, refresh: 'Column', rowIndex: 0,\n                        colIndex: args.startIndex\n                    });\n                }\n            }\n            this.parent.selectRange(this.parent.getActiveSheet().selectedRange);\n        }\n        this.refreshImgElement(args.deletedModel.length, this.parent.activeSheetIndex, args.modelType, args.startIndex);\n        if (isAction) {\n            this.parent.notify(completeAction, { eventArgs: args, action: 'delete' });\n        }\n        if (args.modelType === 'Row') {\n            this.parent.notify(dataChanged, args);\n        }\n    };\n    Delete.prototype.refreshImgElement = function (count, sheetIdx, modelType, index) {\n        var sheet = this.parent.sheets[sheetIdx];\n        var cell;\n        var address = [0, 0, sheet.usedRange.rowIndex, sheet.usedRange.colIndex];\n        for (var i = 0; i <= address[2]; i++) {\n            for (var j = address[1]; j <= address[3]; j++) {\n                cell = getCell(i, j, sheet);\n                if (cell && cell.image && cell.image.length > 0) {\n                    if ((modelType === 'Row' && i >= index) || (modelType === 'Column' && j >= index)) {\n                        this.parent.notify(refreshImagePosition, {\n                            rowIdx: i, colIdx: j, sheetIdx: sheetIdx, type: modelType, count: count, status: 'delete'\n                        });\n                    }\n                }\n            }\n        }\n    };\n    Delete.prototype.addEventListener = function () {\n        this.parent.on(deleteAction, this.delete, this);\n    };\n    /**\n     * Destroy delete module.\n     */\n    Delete.prototype.destroy = function () {\n        this.removeEventListener();\n        this.parent = null;\n    };\n    Delete.prototype.removeEventListener = function () {\n        if (!this.parent.isDestroyed) {\n            this.parent.off(deleteAction, this.delete);\n        }\n    };\n    /**\n     * Get the delete module name.\n     */\n    Delete.prototype.getModuleName = function () {\n        return 'delete';\n    };\n    return Delete;\n}());\nexport { Delete };\n","import { editAlert } from '../index';\nimport { isValidation, checkDateFormat, applyCellFormat, workbookEditOperation, activeCellChanged } from '../../workbook/common/event';\nimport { getCell, setCell } from '../../workbook/base/cell';\nimport { FormValidator, NumericTextBox } from '@syncfusion/ej2-inputs';\nimport { EventHandler, remove, closest, isNullOrUndefined, select } from '@syncfusion/ej2-base';\nimport { dialog, locale, initiateDataValidation, invalidData, editOperation, keyUp } from '../common/index';\nimport { formulaBarOperation, removeDataValidation } from '../common/index';\nimport { CheckBox } from '@syncfusion/ej2-buttons';\nimport { setRow } from '../../workbook/base/row';\nimport { getRangeIndexes, getIndexesFromAddress, getCellIndexes } from '../../workbook/common/address';\nimport { DropDownList } from '@syncfusion/ej2-dropdowns';\nimport { getSheet, getSheetIndex } from '../../workbook/index';\nimport { getColumn, isLocked } from '../../workbook/index';\n/**\n * Represents Data Validation support for Spreadsheet.\n */\nvar DataValidation = /** @class */ (function () {\n    /**\n     * Constructor for the Spreadsheet Data Validation module.\n     */\n    function DataValidation(parent) {\n        this.data = [];\n        this.parent = parent;\n        this.addEventListener();\n    }\n    /**\n     * To destroy the Data Validation module.\n     * @return {void}\n     */\n    DataValidation.prototype.destroy = function () {\n        this.removeEventListener();\n        var dataValPopup = select('#' + this.parent.element.id + '_datavalidation-popup');\n        if (dataValPopup) {\n            dataValPopup.remove();\n        }\n        this.parent = null;\n    };\n    DataValidation.prototype.addEventListener = function () {\n        EventHandler.add(this.parent.element, 'dblclick', this.listOpen, this);\n        EventHandler.add(document, 'mousedown', this.mouseDownHandler, this);\n        this.parent.on(initiateDataValidation, this.initiateDataValidationHandler, this);\n        this.parent.on(invalidData, this.invalidDataHandler, this);\n        this.parent.on(isValidation, this.checkDataValidation, this);\n        this.parent.on(activeCellChanged, this.listHandler, this);\n        this.parent.on(keyUp, this.keyUpHandler, this);\n        this.parent.on(removeDataValidation, this.removeValidationHandler, this);\n    };\n    DataValidation.prototype.removeEventListener = function () {\n        EventHandler.remove(this.parent.element, 'dblclick', this.listOpen);\n        EventHandler.remove(document, 'mousedown', this.mouseDownHandler);\n        if (!this.parent.isDestroyed) {\n            this.parent.off(initiateDataValidation, this.initiateDataValidationHandler);\n            this.parent.off(invalidData, this.invalidDataHandler);\n            this.parent.off(isValidation, this.checkDataValidation);\n            this.parent.off(activeCellChanged, this.listHandler);\n            this.parent.off(keyUp, this.keyUpHandler);\n            this.parent.off(removeDataValidation, this.removeValidationHandler);\n        }\n    };\n    DataValidation.prototype.removeValidationHandler = function (e) {\n        this.parent.removeDataValidation(this.parent.getActiveSheet().selectedRange);\n    };\n    DataValidation.prototype.mouseDownHandler = function (e) {\n        var target = e.target;\n        var parEle = closest(target, '.e-ddl');\n        if (parEle && parEle.getAttribute('id') === 'listValid_popup') {\n            this.parent.notify(formulaBarOperation, { action: 'refreshFormulabar', value: target.innerText });\n        }\n    };\n    DataValidation.prototype.keyUpHandler = function (e) {\n        var target = e.target;\n        var dlgEle = this.parent.element.querySelector('.e-datavalidation-dlg');\n        if (closest(target, '.e-values') && dlgEle && e.keyCode !== 13) {\n            var valuesCont = dlgEle.querySelector('.e-values');\n            var errorEle = valuesCont.querySelector('.e-dlg-error');\n            var footerCont = dlgEle.querySelector('.e-footer-content');\n            var primaryBut = footerCont.querySelector('.e-primary');\n            if (primaryBut.hasAttribute('disabled')) {\n                primaryBut.removeAttribute('disabled');\n            }\n            if (errorEle) {\n                valuesCont.removeChild(errorEle);\n            }\n        }\n    };\n    DataValidation.prototype.listOpen = function (e) {\n        var target = e.target;\n        if (this.listObj && target.classList.contains('e-cell') && target.querySelector('.e-validation-list')) {\n            this.listObj.showPopup();\n        }\n    };\n    DataValidation.prototype.invalidDataHandler = function (args) {\n        if (args.isRemoveHighlight) {\n            this.parent.removeInvalidHighlight();\n        }\n        else {\n            this.parent.addInvalidHighlight();\n        }\n    };\n    DataValidation.prototype.listHandler = function () {\n        var _this = this;\n        if (this.parent.allowDataValidation) {\n            var sheet = this.parent.getActiveSheet();\n            var mainCont = this.parent.getMainContent();\n            var indexes = getCellIndexes(sheet.activeCell);\n            var colIdx = indexes[1];\n            var rowIdx = indexes[0];\n            var cell_1 = getCell(indexes[0], indexes[1], sheet);\n            var tdEle_1;\n            tdEle_1 = this.parent.getCell(indexes[0], indexes[1]);\n            if (!tdEle_1) {\n                return;\n            }\n            if (document.getElementsByClassName('e-validation-list')[0]) {\n                remove(document.getElementsByClassName('e-validation-list')[0]);\n                this.data = [];\n            }\n            if (cell_1 && cell_1.validation && cell_1.validation.type === 'List') {\n                cell_1.validation.ignoreBlank = !isNullOrUndefined(cell_1.validation.ignoreBlank) ? cell_1.validation.ignoreBlank : true;\n                cell_1.validation.inCellDropDown = !isNullOrUndefined(cell_1.validation.inCellDropDown) ?\n                    cell_1.validation.inCellDropDown : true;\n                if (cell_1.validation.inCellDropDown) {\n                    var ddlCont = this.parent.createElement('div', { className: 'e-validation-list' });\n                    var ddlEle = this.parent.createElement('input', { id: 'listValid' });\n                    ddlCont.appendChild(ddlEle);\n                    if (!cell_1.validation.inCellDropDown) {\n                        ddlCont.style.display = 'none';\n                    }\n                    tdEle_1.insertBefore(ddlCont, tdEle_1.firstChild);\n                    this.listObj = new DropDownList({\n                        index: 0,\n                        dataSource: this.data,\n                        fields: { text: 'text', value: 'id' },\n                        width: '0px',\n                        popupWidth: '200px',\n                        popupHeight: '200px',\n                        beforeOpen: function () {\n                            _this.listObj.popupWidth = tdEle_1.offsetWidth - 1;\n                            _this.data = [];\n                            _this.updateDataSource(_this.listObj, cell_1);\n                        },\n                        change: function () { _this.listValueChange(_this.listObj.text); },\n                        open: function (args) {\n                            args.popup.offsetX = -(tdEle_1.offsetWidth - 20) + 4;\n                            args.popup.offsetY = -13;\n                        }\n                    });\n                    this.listObj.appendTo('#listValid');\n                }\n            }\n        }\n    };\n    DataValidation.prototype.updateDataSource = function (listObj, cell) {\n        var count = 0;\n        var value = cell.validation.value1;\n        var isRange = value.indexOf('=') !== -1;\n        if (isRange) {\n            var sheet = value.indexOf('!') > -1 ?\n                getSheet(this.parent, getSheetIndex(this.parent, value.split('=')[1].split('!')[0])) : this.parent.getActiveSheet();\n            var address = value.indexOf('!') > -1 ? value.split('!')[1] : value.split('=')[1];\n            var indexes = void 0;\n            var range = address.split(':');\n            if ((range[0].match(/[a-z]+$/ig) && range[1].match(/[a-z]+$/ig)) || (range[0].match(/^[0-9]/g) && range[1].match(/^[0-9]/g))) {\n                var addressInfo = this.parent.getIndexes(address);\n                if (addressInfo.isCol) {\n                    indexes = [0, addressInfo.startIdx, sheet.usedRange.rowIndex, addressInfo.startIdx];\n                }\n                else {\n                    indexes = [addressInfo.startIdx, 0, addressInfo.startIdx, sheet.usedRange.colIndex];\n                }\n            }\n            else {\n                indexes = getRangeIndexes(address);\n            }\n            for (var rowIdx = indexes[0]; rowIdx <= indexes[2]; rowIdx++) {\n                if (!sheet.rows[rowIdx]) {\n                    setRow(sheet, rowIdx, {});\n                }\n                for (var colIdx = indexes[1]; colIdx <= indexes[3]; colIdx++) {\n                    if (!sheet.rows[rowIdx].cells) {\n                        setCell(rowIdx, colIdx, sheet, {});\n                    }\n                    count += 1;\n                    cell = sheet.rows[rowIdx].cells[colIdx];\n                    var data = this.parent.getDisplayText(cell) ? this.parent.getDisplayText(cell) : '';\n                    this.data.push({ text: data, id: 'list-' + count });\n                }\n            }\n        }\n        else {\n            var listValues = value.split(',');\n            for (var idx = 0; idx < listValues.length; idx++) {\n                count += 1;\n                this.data.push({ text: listValues[idx], id: 'list-' + count });\n            }\n        }\n        listObj.dataSource = this.data;\n    };\n    DataValidation.prototype.listValueChange = function (value) {\n        var sheet = this.parent.getActiveSheet();\n        var cellIdx = getIndexesFromAddress(sheet.activeCell);\n        var cellObj = getCell(cellIdx[0], cellIdx[1], sheet);\n        if (sheet.isProtected && isLocked(cellObj, getColumn(sheet, cellIdx[1]))) {\n            this.parent.notify(editAlert, null);\n        }\n        else {\n            this.parent.notify(workbookEditOperation, { action: 'updateCellValue', address: sheet.activeCell, value: value });\n            this.parent.serviceLocator.getService('cell').refreshRange(cellIdx);\n        }\n    };\n    DataValidation.prototype.initiateDataValidationHandler = function () {\n        var _this = this;\n        var l10n = this.parent.serviceLocator.getService(locale);\n        var type;\n        var operator;\n        var value1;\n        var value2;\n        var ignoreBlank = true;\n        var inCellDropDown = true;\n        var isNew = true;\n        var sheet = this.parent.getActiveSheet();\n        var cell;\n        var indexes = getRangeIndexes(sheet.selectedRange);\n        for (var rowIdx = indexes[0]; rowIdx <= indexes[2]; rowIdx++) {\n            if (sheet.rows[rowIdx]) {\n                for (var colIdx = indexes[1]; colIdx <= indexes[3]; colIdx++) {\n                    if (sheet.rows[rowIdx].cells && sheet.rows[rowIdx].cells[colIdx]) {\n                        cell = sheet.rows[rowIdx].cells[colIdx];\n                        if (cell.validation) {\n                            isNew = false;\n                            type = cell.validation.type;\n                            operator = cell.validation.operator;\n                            value1 = cell.validation.value1;\n                            value2 = cell.validation.value2;\n                            ignoreBlank = !isNullOrUndefined(cell.validation.ignoreBlank) ?\n                                cell.validation.ignoreBlank : ignoreBlank;\n                            inCellDropDown = !isNullOrUndefined(cell.validation.inCellDropDown) ?\n                                cell.validation.inCellDropDown : inCellDropDown;\n                        }\n                    }\n                }\n            }\n        }\n        if (!this.parent.element.querySelector('.e-datavalidation-dlg')) {\n            var dialogInst_1 = this.parent.serviceLocator.getService(dialog);\n            dialogInst_1.show({\n                width: 375, showCloseIcon: true, isModal: true, cssClass: 'e-datavalidation-dlg',\n                header: l10n.getConstant('DataValidation'),\n                target: document.querySelector('.e-control.e-spreadsheet'),\n                beforeOpen: function (args) {\n                    var dlgArgs = {\n                        dialogName: 'ValidationDialog', element: args.element,\n                        target: args.target, cancel: args.cancel\n                    };\n                    _this.parent.trigger('dialogBeforeOpen', dlgArgs);\n                    if (dlgArgs.cancel) {\n                        args.cancel = true;\n                    }\n                    dialogInst_1.dialogInstance.content =\n                        _this.dataValidationContent(isNew, type, operator, value1, value2, ignoreBlank, inCellDropDown);\n                    dialogInst_1.dialogInstance.dataBind();\n                    _this.parent.element.focus();\n                },\n                buttons: [{\n                        buttonModel: {\n                            content: l10n.getConstant('CLEARALL'),\n                            cssClass: 'e-btn e-clearall-btn e-flat'\n                        },\n                        click: function () {\n                            dialogInst_1.dialogInstance.content =\n                                _this.dataValidationContent(true, type, operator, value1, value2, ignoreBlank, inCellDropDown);\n                            dialogInst_1.dialogInstance.dataBind();\n                            _this.parent.element.focus();\n                        }\n                    },\n                    {\n                        buttonModel: {\n                            content: l10n.getConstant('APPLY'), isPrimary: true\n                        },\n                        click: function () {\n                            _this.dlgClickHandler(dialogInst_1);\n                        }\n                    }]\n            });\n            dialogInst_1.dialogInstance.refresh();\n        }\n    };\n    // tslint:disable-next-line:max-func-body-length\n    DataValidation.prototype.dataValidationContent = function (isNew, type, operator, val1, val2, ignoreBlank, inCellDropDown) {\n        var _this = this;\n        var l10n = this.parent.serviceLocator.getService(locale);\n        var value1 = isNew ? '0' : val1;\n        var value2 = isNew ? '0' : val2;\n        var dlgContent = this.parent.createElement('div', { className: 'e-validation-dlg' });\n        var cellRangeCont = this.parent.createElement('div', { className: 'e-cellrange' });\n        var allowDataCont = this.parent.createElement('div', { className: 'e-allowdata' });\n        var valuesCont = this.parent.createElement('div', { className: 'e-values' });\n        var ignoreBlankCont = this.parent.createElement('div', { className: 'e-ignoreblank' });\n        dlgContent.appendChild(cellRangeCont);\n        dlgContent.appendChild(allowDataCont);\n        dlgContent.appendChild(valuesCont);\n        dlgContent.appendChild(ignoreBlankCont);\n        var cellRangeText = this.parent.createElement('span', { className: 'e-header', innerHTML: l10n.getConstant('CellRange') });\n        var cellRangeEle = this.parent.createElement('input', {\n            className: 'e-input',\n            attrs: { value: this.parent.getActiveSheet().selectedRange }\n        });\n        cellRangeCont.appendChild(cellRangeText);\n        cellRangeCont.appendChild(cellRangeEle);\n        var allowCont = this.parent.createElement('div', { className: 'e-allow' });\n        var dataCont = this.parent.createElement('div', { className: 'e-data' });\n        allowDataCont.appendChild(allowCont);\n        allowDataCont.appendChild(dataCont);\n        var allowText = this.parent.createElement('span', { className: 'e-header', innerHTML: l10n.getConstant('Allow') });\n        this.typeData = [\n            { text: l10n.getConstant('WholeNumber'), id: 'type-1' },\n            { text: l10n.getConstant('Decimal'), id: 'type-2' },\n            { text: l10n.getConstant('Date'), id: 'type-3' },\n            { text: l10n.getConstant('Time'), id: 'type-4' },\n            { text: l10n.getConstant('TextLength'), id: 'type-5' },\n            { text: l10n.getConstant('List'), id: 'type-6' }\n        ];\n        this.operatorData = [\n            { text: l10n.getConstant('Between'), id: 'operator-1' },\n            { text: l10n.getConstant('NotBetween'), id: 'operator-2' },\n            { text: l10n.getConstant('EqualTo'), id: 'operator-3' },\n            { text: l10n.getConstant('NotEqualTo'), id: 'operator-4' },\n            { text: l10n.getConstant('Greaterthan'), id: 'operator-5' },\n            { text: l10n.getConstant('Lessthan'), id: 'operator-6' },\n            { text: l10n.getConstant('GreaterThanOrEqualTo'), id: 'operator-7' },\n            { text: l10n.getConstant('LessThanOrEqualTo'), id: 'operator-8' }\n        ];\n        var allowSelectEle = this.parent.createElement('input', { className: 'e-select' });\n        var allowIdx = 0;\n        if (!isNew) {\n            for (var idx = 0; idx < this.typeData.length; idx++) {\n                if (type === this.typeData[idx].text.replace(' ', '')) {\n                    allowIdx = idx;\n                    break;\n                }\n            }\n        }\n        if (isNew || type !== 'List') {\n            var dataIdx = 0;\n            var dataText = this.parent.createElement('span', { className: 'e-header', innerHTML: l10n.getConstant('Data') });\n            var dataSelectEle = this.parent.createElement('input', { className: 'e-select' });\n            if (!isNew) {\n                for (var idx = 0; idx < this.operatorData.length; idx++) {\n                    if (operator === this.FormattedValue(this.operatorData[idx].text)) {\n                        dataIdx = idx;\n                        break;\n                    }\n                }\n            }\n            dataCont.appendChild(dataText);\n            dataCont.appendChild(dataSelectEle);\n            this.dataList = new DropDownList({\n                dataSource: this.operatorData,\n                index: dataIdx,\n                popupHeight: '200px',\n                change: function () { _this.userInput(listObj, _this.dataList); }\n            });\n            this.dataList.appendTo(dataSelectEle);\n        }\n        else {\n            var ignoreBlankEle_1 = this.parent.createElement('input', { className: 'e-checkbox' });\n            dataCont.appendChild(ignoreBlankEle_1);\n            var ignoreBlankObj_1 = new CheckBox({ label: l10n.getConstant('InCellDropDown'), checked: inCellDropDown });\n            ignoreBlankObj_1.appendTo(ignoreBlankEle_1);\n        }\n        allowCont.appendChild(allowText);\n        allowCont.appendChild(allowSelectEle);\n        var listObj = new DropDownList({\n            dataSource: this.typeData,\n            index: allowIdx,\n            popupHeight: '200px',\n            change: function () { _this.userInput(listObj, _this.dataList); }\n        });\n        listObj.appendTo(allowSelectEle);\n        if (isNew || (listObj.value !== 'List' && (this.dataList.value === 'Between' || this.dataList.value === 'Not between'))) {\n            var minimumCont = this.parent.createElement('div', { className: 'e-minimum' });\n            var maximumCont = this.parent.createElement('div', { className: 'e-maximum' });\n            valuesCont.appendChild(minimumCont);\n            valuesCont.appendChild(maximumCont);\n            var minimumText = this.parent.createElement('span', { className: 'e-header', innerHTML: l10n.getConstant('Minimum') });\n            var maximumText = this.parent.createElement('span', { className: 'e-header', innerHTML: l10n.getConstant('Maximum') });\n            var minimumInp = this.parent.createElement('input', {\n                id: 'minvalue',\n                className: 'e-input', attrs: { value: value1 }\n            });\n            var maximumInp = this.parent.createElement('input', {\n                id: 'maxvalue',\n                className: 'e-input', attrs: { value: value2 }\n            });\n            minimumCont.appendChild(minimumText);\n            minimumCont.appendChild(minimumInp);\n            maximumCont.appendChild(maximumText);\n            maximumCont.appendChild(maximumInp);\n            var numericMin = new NumericTextBox({\n                value: 0\n            });\n            numericMin.appendTo('#minvalue');\n            var numericMax = new NumericTextBox({\n                value: 0\n            });\n            numericMax.appendTo('#maxvalue');\n        }\n        else if (!isNew || type === ' List') {\n            var valueText = this.parent.createElement('span', {\n                className: 'e-header', innerHTML: l10n.getConstant('Sources')\n            });\n            var valueEle = this.parent.createElement('input', { className: 'e-input', attrs: { value: value1 } });\n            valuesCont.appendChild(valueText);\n            valuesCont.appendChild(valueEle);\n        }\n        else {\n            var valueText = this.parent.createElement('span', {\n                className: 'e-header', innerHTML: l10n.getConstant('Value')\n            });\n            var valueEle = this.parent.createElement('input', { className: 'e-input', attrs: { value: value1 } });\n            valuesCont.appendChild(valueText);\n            valuesCont.appendChild(valueEle);\n        }\n        var isChecked = ignoreBlank;\n        var ignoreBlankEle = this.parent.createElement('input', { className: 'e-checkbox' });\n        ignoreBlankCont.appendChild(ignoreBlankEle);\n        var ignoreBlankObj = new CheckBox({ label: l10n.getConstant('IgnoreBlank'), checked: isChecked });\n        ignoreBlankObj.appendTo(ignoreBlankEle);\n        return dlgContent;\n    };\n    DataValidation.prototype.userInput = function (listObj, listObj1) {\n        var dlgEle = this.parent.element.querySelector('.e-datavalidation-dlg');\n        var dlgCont = dlgEle.querySelector('.e-validation-dlg');\n        var allowDataCont = dlgCont.querySelector('.e-allowdata');\n        var valuesCont = dlgCont.querySelector('.e-values');\n        var l10n = this.parent.serviceLocator.getService(locale);\n        var dataCont = allowDataCont.querySelector('.e-data');\n        var opeEle = dataCont.querySelector('.e-valid-input');\n        while (valuesCont.lastChild) {\n            valuesCont.removeChild(valuesCont.lastChild);\n        }\n        if (listObj.value === 'List') {\n            while (dataCont.lastChild) {\n                dataCont.removeChild(dataCont.lastChild);\n            }\n            var ignoreBlankEle = this.parent.createElement('input', { className: 'e-checkbox' });\n            dataCont.appendChild(ignoreBlankEle);\n            var ignoreBlankObj = new CheckBox({ label: l10n.getConstant('InCellDropDown'), checked: true });\n            ignoreBlankObj.appendTo(ignoreBlankEle);\n        }\n        else {\n            if (dataCont.getElementsByClassName('e-checkbox-wrapper')[0]) {\n                while (dataCont.lastChild) {\n                    dataCont.removeChild(dataCont.lastChild);\n                }\n                var dataText = this.parent.createElement('span', { className: 'e-header', innerHTML: 'Data' });\n                var dataSelectEle = this.parent.createElement('input', { className: 'e-select' });\n                dataCont.appendChild(dataText);\n                dataCont.appendChild(dataSelectEle);\n                listObj1.appendTo(dataSelectEle);\n            }\n        }\n        if (listObj.value !== 'List' && (listObj1.value === 'Between' || listObj1.value === 'Not between')) {\n            var minimumCont = this.parent.createElement('div', { className: 'e-minimum' });\n            var maximumCont = this.parent.createElement('div', { className: 'e-maximum' });\n            valuesCont.appendChild(minimumCont);\n            valuesCont.appendChild(maximumCont);\n            var minimumText = this.parent.createElement('span', { className: 'e-header', innerHTML: l10n.getConstant('Minimum') });\n            var maximumText = this.parent.createElement('span', { className: 'e-header', innerHTML: l10n.getConstant('Maximum') });\n            var minimumInp = this.parent.createElement('input', { id: 'min', className: 'e-input', attrs: { value: '0' } });\n            var maximumInp = this.parent.createElement('input', { id: 'max', className: 'e-input', attrs: { value: '0' } });\n            var numericMin = new NumericTextBox({\n                value: 0\n            });\n            numericMin.appendTo('min');\n            var numericMax = new NumericTextBox({\n                value: 0\n            });\n            numericMax.appendTo('max');\n            minimumCont.appendChild(minimumText);\n            minimumCont.appendChild(minimumInp);\n            maximumCont.appendChild(maximumText);\n            maximumCont.appendChild(maximumInp);\n        }\n        else {\n            var text = listObj.value === 'List' ? l10n.getConstant('Sources') : l10n.getConstant('Value');\n            var valueText = this.parent.createElement('span', { className: 'e-header', innerHTML: text });\n            var valueEle = listObj.value === 'List' ? this.parent.createElement('input', {\n                className: 'e-input',\n                attrs: { placeholder: 'Enter value' }\n            }) :\n                this.parent.createElement('input', { className: 'e-input', attrs: { value: '0' } });\n            valuesCont.appendChild(valueText);\n            valuesCont.appendChild(valueEle);\n        }\n    };\n    DataValidation.prototype.dlgClickHandler = function (dialogInst) {\n        var l10n = this.parent.serviceLocator.getService(locale);\n        var isValidList = true;\n        var errorMsg;\n        var dlgEle = this.parent.element.querySelector('.e-datavalidation-dlg');\n        var dlgFooter = dlgEle.querySelector('.e-footer-content');\n        var dlgContEle = dlgEle.getElementsByClassName('e-dlg-content')[0].\n            getElementsByClassName('e-validation-dlg')[0];\n        var allowData = dlgContEle.getElementsByClassName('e-allowdata')[0];\n        var allowEle = allowData.getElementsByClassName('e-allow')[0].getElementsByTagName('input')[0];\n        var dataEle = allowData.getElementsByClassName('e-data')[0].getElementsByTagName('input')[0];\n        var values = dlgContEle.getElementsByClassName('e-values')[0];\n        var value1 = values.getElementsByTagName('input')[0].value;\n        var value2 = values.getElementsByTagName('input')[1] ? values.getElementsByTagName('input')[1].value : '';\n        var ignoreBlank = dlgContEle.querySelector('.e-ignoreblank').querySelector('.e-checkbox-wrapper').\n            getAttribute('aria-checked') === 'true' ? true : false;\n        var inCellDropDown = allowData.querySelector('.e-data').querySelector('.e-checkbox-wrapper') ?\n            allowData.querySelector('.e-data').querySelector('.e-checkbox-wrapper').querySelector('.e-check') ? true : false : null;\n        var range = dlgContEle.querySelector('.e-cellrange').getElementsByTagName('input')[0].value;\n        var operator;\n        var type = allowEle.value;\n        if (dataEle) {\n            operator = dataEle.value;\n            operator = this.FormattedValue(operator);\n        }\n        if (type) {\n            type = type.replace(' ', '');\n        }\n        var rangeAdd = [];\n        var valArr = [];\n        if (value1 !== '') {\n            valArr.push(value1);\n        }\n        if (value2 !== '') {\n            valArr.push(value2);\n        }\n        if (type === 'List') {\n            if (value1.indexOf('=') !== -1) {\n                if (value1.indexOf(':') !== -1) {\n                    var address = value1.indexOf('!') > -1 ? value1.split('!')[1] : value1.split('=')[1];\n                    var isSheetNameValid = value1.indexOf('!') > -1 ?\n                        getSheetIndex(this.parent, value1.split('=')[1].split('!')[0]) > -1 : true;\n                    rangeAdd = address.split(':');\n                    var isSingleCol = address.match(/[a-z]/gi) ?\n                        rangeAdd[0].replace(/[0-9]/g, '') === rangeAdd[1].replace(/[0-9]/g, '') : false;\n                    var isSingleRow = address.match(/\\d/g) ?\n                        rangeAdd[0].replace(/\\D/g, '') === rangeAdd[1].replace(/\\D/g, '') : false;\n                    isValidList = isSheetNameValid ? (isSingleCol ? true : isSingleRow ? true : false) : false;\n                    if (!isValidList) {\n                        errorMsg = l10n.getConstant('DialogError');\n                    }\n                }\n            }\n            else if (value1.length > 256) {\n                isValidList = false;\n                errorMsg = l10n.getConstant('ListLengthError');\n            }\n        }\n        if (type !== 'List' || isValidList) {\n            var sheet = this.parent.getActiveSheet();\n            var format = type;\n            var validDlg = this.isDialogValidator(valArr, format, operator);\n            errorMsg = validDlg.errorMsg;\n            isValidList = validDlg.isValidate;\n            if (isValidList) {\n                var indexes = getCellIndexes(this.parent.getActiveSheet().activeCell);\n                if (sheet && sheet.rows[indexes[0]] && sheet.rows[indexes[0]].cells[indexes[1]] &&\n                    sheet.rows[indexes[0]].cells[indexes[1]].validation &&\n                    sheet.rows[indexes[0]].cells[indexes[1]].validation.type === 'List') {\n                    var tdEle = this.parent.getMainContent().\n                        getElementsByTagName('tr')[indexes[0]].getElementsByClassName('e-cell')[indexes[1]];\n                    if (tdEle && tdEle.getElementsByClassName('e-validation-list')[0]) {\n                        tdEle.removeChild(tdEle.getElementsByClassName('e-validation-list')[0]);\n                        this.listObj.destroy();\n                    }\n                }\n                var rules = {\n                    type: type, operator: operator,\n                    value1: value1, value2: value2, ignoreBlank: ignoreBlank, inCellDropDown: inCellDropDown\n                };\n                this.parent.addDataValidation(rules, range);\n                if (type === 'List' && isValidList) {\n                    this.listHandler();\n                }\n                if (!document.getElementsByClassName('e-validationerror-dlg')[0]) {\n                    if (dialogInst.dialogInstance) {\n                        dialogInst.dialogInstance.hide();\n                    }\n                    else {\n                        dialogInst.hide();\n                    }\n                }\n            }\n        }\n        if (!isValidList) {\n            var errorEle = this.parent.createElement('div', {\n                className: 'e-dlg-error', id: 'e-invalid', innerHTML: errorMsg\n            });\n            values.appendChild(errorEle);\n            dlgFooter.querySelector('.e-primary').setAttribute('disabled', 'true');\n        }\n    };\n    DataValidation.prototype.FormattedValue = function (value) {\n        switch (value) {\n            case 'Between':\n                value = 'Between';\n                break;\n            case 'Not between':\n                value = 'NotBetween';\n                break;\n            case 'Equal to':\n                value = 'EqualTo';\n                break;\n            case 'Not equal to':\n                value = 'NotEqualTo';\n                break;\n            case 'Greater than':\n                value = 'GreaterThan';\n                break;\n            case 'Less than':\n                value = 'LessThan';\n                break;\n            case 'Greater than or equal to':\n                value = 'GreaterThanOrEqualTo';\n                break;\n            case 'Less than or equal to':\n                value = 'LessThanOrEqualTo';\n                break;\n            default:\n                value = 'Between';\n                break;\n        }\n        return value;\n    };\n    DataValidation.prototype.isDialogValidator = function (values, type, operator) {\n        var l10n = this.parent.serviceLocator.getService(locale);\n        var count = 0;\n        var isEmpty = false;\n        var formValidation;\n        if (type === 'List') {\n            isEmpty = values.length > 0 ? false : true;\n        }\n        else {\n            if (operator === 'Between' || operator === 'NotBetween') {\n                isEmpty = values.length === 2 ? false : true;\n            }\n            else {\n                isEmpty = values.length > 0 ? false : true;\n            }\n        }\n        if (!isEmpty) {\n            for (var idx = 0; idx < values.length; idx++) {\n                formValidation = this.formatValidation(values[idx], type);\n                if (formValidation.isValidate) {\n                    count = count + 1;\n                }\n                else {\n                    break;\n                }\n            }\n            formValidation.isValidate = count === values.length ? true : false;\n        }\n        else {\n            formValidation = { isValidate: false, errorMsg: l10n.getConstant('EmptyError') };\n        }\n        return { isValidate: formValidation.isValidate, errorMsg: formValidation.errorMsg };\n    };\n    // tslint:disable-next-line:max-func-body-length\n    DataValidation.prototype.isValidationHandler = function (args) {\n        var l10n = this.parent.serviceLocator.getService(locale);\n        args.value = args.value ? args.value : '';\n        var isValidate;\n        var errorMsg;\n        var enterValue = args.value;\n        var sheet = this.parent.sheets[args.sheetIdx];\n        var cell = getCell(args.range[0], args.range[1], sheet);\n        var value = args.value;\n        var value1 = cell.validation.value1;\n        var value2 = cell.validation.value2;\n        var opt = cell.validation.operator;\n        var type = cell.validation.type;\n        var ignoreBlank = !isNullOrUndefined(cell.validation.ignoreBlank) ? cell.validation.ignoreBlank : true;\n        var formValidation = this.formatValidation(args.value, type);\n        isValidate = formValidation.isValidate;\n        errorMsg = formValidation.errorMsg;\n        if (isValidate) {\n            isValidate = false;\n            if (type === 'Date' || type === 'Time') {\n                for (var idx = 0; idx <= 3; idx++) {\n                    args.value = idx === 0 ? args.value : idx === 1 ? cell.validation.value1 : cell.validation.value2;\n                    var dateEventArgs = {\n                        value: args.value,\n                        rowIndex: args.range[0],\n                        colIndex: args.range[1],\n                        sheetIndex: args.sheetIdx,\n                        updatedVal: ''\n                    };\n                    if (args.value !== '') {\n                        this.parent.notify(checkDateFormat, dateEventArgs);\n                    }\n                    var updatedVal = dateEventArgs.updatedVal;\n                    if (idx === 0) {\n                        value = type === 'Date' ? args.value : updatedVal.slice(updatedVal.indexOf('.') + 1, updatedVal.length);\n                    }\n                    else if (idx === 1) {\n                        value1 = type === 'Date' ? updatedVal : updatedVal.slice(updatedVal.indexOf('.') + 1, updatedVal.length);\n                    }\n                    else {\n                        value2 = type === 'Date' ? updatedVal : updatedVal.slice(updatedVal.indexOf('.') + 1, updatedVal.length);\n                    }\n                }\n            }\n            else if (cell.validation.type === 'TextLength') {\n                value = args.value.toString().length.toString();\n            }\n            if (type === 'List') {\n                if (value1.indexOf('=') !== -1) {\n                    for (var idx = 0; idx < this.data.length; idx++) {\n                        if (args.value === this.data[idx].text) {\n                            isValidate = true;\n                        }\n                    }\n                }\n                else {\n                    var values = value1.split(',');\n                    for (var idx = 0; idx < values.length; idx++) {\n                        if (args.value === values[idx]) {\n                            isValidate = true;\n                        }\n                    }\n                }\n            }\n            else {\n                if (type === 'Decimal') {\n                    value = parseFloat(value.toString());\n                    value1 = parseFloat(value1.toString());\n                    value2 = value2 ? parseFloat(value2.toString()) : null;\n                }\n                else {\n                    value = parseInt(value.toString(), 10);\n                    value1 = parseInt(value1.toString(), 10);\n                    value2 = value2 ? parseInt(value2.toString(), 10) : null;\n                }\n                switch (opt) {\n                    case 'EqualTo':\n                        if (value === value1) {\n                            isValidate = true;\n                        }\n                        else if (ignoreBlank && enterValue === '') {\n                            isValidate = true;\n                        }\n                        else {\n                            isValidate = false;\n                        }\n                        break;\n                    case 'NotEqualTo':\n                        if (value !== value1) {\n                            isValidate = true;\n                        }\n                        else if (ignoreBlank && enterValue === '') {\n                            isValidate = true;\n                        }\n                        else {\n                            isValidate = false;\n                        }\n                        break;\n                    case 'Between':\n                        if (value >= value1 && value <= value2) {\n                            isValidate = true;\n                        }\n                        else if (ignoreBlank && enterValue === '') {\n                            isValidate = true;\n                        }\n                        else {\n                            isValidate = false;\n                        }\n                        break;\n                    case 'NotBetween':\n                        if (value >= value1 && value <= value2) {\n                            isValidate = false;\n                        }\n                        else if (ignoreBlank && enterValue === '') {\n                            isValidate = true;\n                        }\n                        else {\n                            isValidate = true;\n                        }\n                        break;\n                    case 'GreaterThan':\n                        if (value > value1) {\n                            isValidate = true;\n                        }\n                        else if (ignoreBlank && enterValue === '') {\n                            isValidate = true;\n                        }\n                        else {\n                            isValidate = false;\n                        }\n                        break;\n                    case 'LessThan':\n                        if (value < value1) {\n                            isValidate = true;\n                        }\n                        else if (ignoreBlank && enterValue === '') {\n                            isValidate = true;\n                        }\n                        else {\n                            isValidate = false;\n                        }\n                        break;\n                    case 'GreaterThanOrEqualTo':\n                        if (value >= value1) {\n                            isValidate = true;\n                        }\n                        else if (ignoreBlank && enterValue === '') {\n                            isValidate = true;\n                        }\n                        else {\n                            isValidate = false;\n                        }\n                        break;\n                    case 'LessThanOrEqualTo':\n                        if (value <= value1) {\n                            isValidate = true;\n                        }\n                        else if (ignoreBlank && enterValue === '') {\n                            isValidate = true;\n                        }\n                        else {\n                            isValidate = false;\n                        }\n                        break;\n                    default:\n                        break;\n                }\n            }\n        }\n        errorMsg = l10n.getConstant('ValidationError');\n        if (isValidate) {\n            var style = this.parent.getCellStyleValue(['backgroundColor', 'color'], [args.range[0], args.range[1]]);\n            this.parent.notify(applyCellFormat, {\n                style: style, rowIdx: args.range[0],\n                colIdx: args.range[1], isHeightCheckNeeded: true, manualUpdate: true,\n                onActionUpdate: true\n            });\n        }\n        return { isValidate: isValidate, errorMsg: errorMsg };\n    };\n    DataValidation.prototype.checkDataValidation = function (args) {\n        var isValid = this.isValidationHandler({\n            value: args.value, range: args.range, sheetIdx: args.sheetIdx\n        });\n        if (!isValid.isValidate && args.isCell) {\n            this.validationErrorHandler(isValid.errorMsg);\n        }\n        this.parent.allowDataValidation = isValid.isValidate;\n    };\n    DataValidation.prototype.formatValidation = function (value, type) {\n        var sheetPanel = this.parent.element.getElementsByClassName('e-sheet-panel')[0];\n        var isValidate;\n        var errorMsg;\n        var formEle = this.parent.createElement('form', {\n            id: 'formId',\n            className: 'form-horizontal'\n        });\n        var inputEle = this.parent.createElement('input', {\n            id: 'e-validation', innerHTML: value\n        });\n        inputEle.setAttribute('name', 'validation');\n        inputEle.setAttribute('type', 'text');\n        inputEle.setAttribute('value', value);\n        formEle.appendChild(inputEle);\n        sheetPanel.appendChild(formEle);\n        var options;\n        switch (type) {\n            case 'Date':\n                options = {\n                    rules: {\n                        'validation': { date: true },\n                    },\n                    customPlacement: function (inputElement, error) {\n                        errorMsg = error.innerText;\n                    }\n                };\n                break;\n            case 'Decimal':\n                options = {\n                    rules: {\n                        'validation': { number: true },\n                    },\n                    customPlacement: function (inputElement, error) {\n                        errorMsg = error.innerText;\n                    }\n                };\n                break;\n            case 'WholeNumber':\n                options = {\n                    rules: {\n                        'validation': { regex: /^\\d*\\.?[0]*$/ },\n                    },\n                    customPlacement: function (inputElement, error) {\n                        errorMsg = error.innerText;\n                    }\n                };\n                break;\n            default:\n                break;\n        }\n        var formObj = new FormValidator('#formId', options);\n        isValidate = formObj.validate();\n        sheetPanel.removeChild(sheetPanel.getElementsByClassName('form-horizontal')[0]);\n        return { isValidate: isValidate, errorMsg: errorMsg };\n    };\n    DataValidation.prototype.validationErrorHandler = function (error) {\n        var _this = this;\n        var el = document.getElementsByClassName('e-spreadsheet-edit')[0];\n        var l10n = this.parent.serviceLocator.getService(locale);\n        if (!this.parent.element.querySelector('.e-validationerror-dlg')) {\n            var erroDialogInst_1 = this.parent.serviceLocator.getService(dialog);\n            var disableCancel = false;\n            var dlgModel = {\n                width: 400, height: 200, isModal: true, showCloseIcon: true, cssClass: 'e-validationerror-dlg',\n                target: document.querySelector('.e-control.e-spreadsheet'),\n                beforeOpen: function (args) {\n                    var dlgArgs = {\n                        dialogName: 'ValidationErrorDialog',\n                        element: args.element, target: args.target, cancel: args.cancel, content: error\n                    };\n                    _this.parent.trigger('dialogBeforeOpen', dlgArgs);\n                    if (dlgArgs.cancel) {\n                        _this.errorDlgHandler(erroDialogInst_1, 'Cancel');\n                        args.cancel = true;\n                    }\n                    el.focus();\n                    erroDialogInst_1.dialogInstance.content = dlgArgs.content;\n                    erroDialogInst_1.dialogInstance.dataBind();\n                },\n                buttons: [{\n                        buttonModel: {\n                            content: l10n.getConstant('Retry'), isPrimary: true,\n                        },\n                        click: function () {\n                            _this.errorDlgHandler(erroDialogInst_1, 'Retry');\n                        }\n                    },\n                    {\n                        buttonModel: {\n                            content: l10n.getConstant('Cancel'),\n                        },\n                        click: function () {\n                            _this.errorDlgHandler(erroDialogInst_1, 'Cancel');\n                        }\n                    }]\n            };\n            erroDialogInst_1.show(dlgModel, disableCancel);\n        }\n    };\n    DataValidation.prototype.errorDlgHandler = function (errorDialogInst, buttonName) {\n        if (buttonName === 'Retry') {\n            var el = document.getElementsByClassName('e-spreadsheet-edit')[0];\n            var mainCont = this.parent.getMainContent();\n            errorDialogInst.hide();\n            if (el.innerText) {\n                var range = document.createRange();\n                range.setStart(el.childNodes[0], 0);\n                range.setEnd(el.childNodes[0], el.innerText.length);\n                var selection = window.getSelection();\n                selection.removeAllRanges();\n                selection.addRange(range);\n                if (this.listObj) {\n                    this.listObj.showPopup();\n                }\n            }\n        }\n        else {\n            var indexes = getCellIndexes(this.parent.getActiveSheet().activeCell);\n            var value = this.parent.getDisplayText(this.parent.getActiveSheet().rows[indexes[0]].cells[indexes[1]]);\n            this.parent.notify(editOperation, {\n                action: 'cancelEdit', value: value, refreshFormulaBar: true,\n                refreshEditorElem: true, isAppend: false, trigEvent: true\n            });\n            errorDialogInst.hide();\n        }\n    };\n    /**\n     * Gets the module name.\n     * @returns string\n     */\n    DataValidation.prototype.getModuleName = function () {\n        return 'dataValidation';\n    };\n    return DataValidation;\n}());\nexport { DataValidation };\n","import { applyProtect, protectSheet, protectCellFormat, editAlert, enableFormulaInput } from '../common/event';\nimport { clearCopy, protectSelection, clearUndoRedoCollection } from '../common/index';\nimport { ListView } from '@syncfusion/ej2-lists';\nimport { EventHandler } from '@syncfusion/ej2-base';\nimport { locale, updateToggleItem } from '../common/index';\nimport { CheckBox } from '@syncfusion/ej2-buttons';\nimport { applyLockCells, setCell } from '../../workbook/index';\n/**\n * The `Protect-sheet` module is used to handle the Protecting functionalities in Spreadsheet.\n */\nvar ProtectSheet = /** @class */ (function () {\n    /**\n     * Constructor for protectSheet module in Spreadsheet.\n     * @private\n     */\n    function ProtectSheet(parent) {\n        this.parent = parent;\n        this.init();\n    }\n    ProtectSheet.prototype.init = function () {\n        this.addEventListener();\n    };\n    /**\n     * To destroy the protectSheet module.\n     * @return {void}\n     * @hidden\n     */\n    ProtectSheet.prototype.destroy = function () {\n        this.removeEventListener();\n        this.parent = null;\n    };\n    ProtectSheet.prototype.addEventListener = function () {\n        this.parent.on(applyProtect, this.protect, this);\n        this.parent.on(protectSheet, this.protectSheetHandler, this);\n        this.parent.on(editAlert, this.editProtectedAlert, this);\n        this.parent.on(applyLockCells, this.lockCellsHandler, this);\n    };\n    ProtectSheet.prototype.removeEventListener = function () {\n        if (!this.parent.isDestroyed) {\n            this.parent.off(applyProtect, this.protect);\n            this.parent.off(protectSheet, this.protectSheetHandler);\n            this.parent.off(editAlert, this.editProtectedAlert);\n            this.parent.off(applyLockCells, this.lockCellsHandler);\n        }\n    };\n    ProtectSheet.prototype.protect = function (args) {\n        this.parent.notify(clearCopy, null);\n        if (!args.isActive) {\n            this.createDialogue();\n        }\n        else {\n            this.parent.setSheetPropertyOnMute(this.parent.getActiveSheet(), 'isProtected', false);\n            this.parent.notify(updateToggleItem, { props: 'Protect' });\n            this.parent.notify(protectSheet, { isActive: args.isActive });\n            this.parent.notify(protectSelection, null);\n        }\n    };\n    ProtectSheet.prototype.createDialogue = function () {\n        var _this = this;\n        var l10n = this.parent.serviceLocator.getService(locale);\n        var listData = [\n            { text: l10n.getConstant('SelectCells'), id: '1' },\n            { text: l10n.getConstant('FormatCells'), id: '2' },\n            { text: l10n.getConstant('FormatRows'), id: '3' },\n            { text: l10n.getConstant('FormatColumns'), id: '4' },\n            { text: l10n.getConstant('InsertLinks'), id: '5' }\n        ];\n        this.optionList = new ListView({\n            width: '250px',\n            dataSource: listData,\n            showCheckBox: true,\n            select: this.dialogOpen.bind(this),\n        });\n        var protectHeaderCntent = this.parent.createElement('div', { className: 'e-protect-content',\n            innerHTML: l10n.getConstant('ProtectAllowUser') });\n        this.parent.setSheetPropertyOnMute(this.parent.getActiveSheet(), 'isProtected', false);\n        var checkbox = new CheckBox({ checked: true, label: l10n.getConstant('ProtectContent'), cssClass: 'e-protect-checkbox' });\n        var listViewElement = this.parent.createElement('div', { className: 'e-protect-option-list',\n            id: this.parent.element.id + '_option_list' });\n        var headerContent = this.parent.createElement('div', { className: 'e-header-content', innerHTML: l10n.getConstant('ProtectSheet') });\n        var checkBoxElement = this.parent.createElement('input', { id: this.parent.element.id + '_protect_check', attrs: { type: 'checkbox' } });\n        this.dialog = this.parent.serviceLocator.getService('dialog');\n        this.dialog.show({\n            header: headerContent.outerHTML,\n            content: checkBoxElement.outerHTML + protectHeaderCntent.outerHTML + listViewElement.outerHTML,\n            showCloseIcon: true, isModal: true,\n            cssClass: 'e-protect-dlg',\n            beforeOpen: function (args) {\n                var dlgArgs = {\n                    dialogName: 'ProtectSheetDialog',\n                    element: args.element, target: args.target, cancel: args.cancel\n                };\n                _this.parent.trigger('dialogBeforeOpen', dlgArgs);\n                if (dlgArgs.cancel) {\n                    args.cancel = true;\n                }\n                _this.parent.element.focus();\n            },\n            open: function () {\n                _this.okBtnFocus();\n            },\n            beforeClose: function () {\n                var checkboxElement = document.getElementById(_this.parent.element.id + '_protect_check');\n                EventHandler.remove(checkboxElement, 'focus', _this.okBtnFocus);\n                EventHandler.remove(checkbox.element, 'click', _this.checkBoxClickHandler);\n                _this.parent.element.focus();\n            },\n            buttons: [{ click: (this.selectOption.bind(this, this.dialog, this)),\n                    buttonModel: { content: l10n.getConstant('Ok'), isPrimary: true } }]\n        });\n        checkbox.appendTo('#' + this.parent.element.id + '_protect_check');\n        this.optionList.appendTo('#' + this.parent.element.id + '_option_list');\n        this.optionList.selectMultipleItems([{ id: '1' }]);\n        EventHandler.add(checkbox.element, 'click', this.checkBoxClickHandler, this);\n    };\n    ;\n    ProtectSheet.prototype.okBtnFocus = function () {\n        var _this = this;\n        var checkboxElement = document.getElementById(this.parent.element.id + '_protect_check');\n        checkboxElement.addEventListener('focus', function () {\n            _this.dialog.dialogInstance.element.getElementsByClassName('e-footer-content')[0].querySelector('button').focus();\n        });\n    };\n    ProtectSheet.prototype.checkBoxClickHandler = function () {\n        var ch = document.getElementById(this.parent.element.id + '_protect_check');\n        if (ch.checked === false) {\n            this.dialog.dialogInstance.element.getElementsByClassName('e-footer-content')[0].querySelector('button').disabled = true;\n        }\n        else {\n            this.dialog.dialogInstance.element.getElementsByClassName('e-footer-content')[0].querySelector('button').disabled = false;\n            this.dialog.dialogInstance.element.getElementsByClassName('e-footer-content')[0].querySelector('button').focus();\n        }\n    };\n    ProtectSheet.prototype.dialogOpen = function () {\n        this.dialog.dialogInstance.element.getElementsByClassName('e-footer-content')[0].querySelector('button').focus();\n    };\n    ProtectSheet.prototype.selectOption = function () {\n        var l10n = this.parent.serviceLocator.getService(locale);\n        var selectedItems = this.optionList.getSelectedItems();\n        this.parent.setSheetPropertyOnMute(this.parent.getActiveSheet(), 'isProtected', true);\n        var protectSettings = { selectCells: selectedItems.text.indexOf(l10n.getConstant('SelectCells')) > -1,\n            formatCells: selectedItems.text.indexOf(l10n.getConstant('FormatCells')) > -1,\n            formatRows: selectedItems.text.indexOf(l10n.getConstant('FormatRows')) > -1,\n            formatColumns: selectedItems.text.indexOf(l10n.getConstant('FormatColumns')) > -1,\n            insertLink: selectedItems.text.indexOf(l10n.getConstant('InsertLinks')) > -1 };\n        this.parent.protectSheet(null, protectSettings);\n        this.parent.notify(protectSelection, null);\n        this.parent.notify(clearUndoRedoCollection, null);\n        this.dialog.hide();\n    };\n    ProtectSheet.prototype.protectSheetHandler = function (args) {\n        var sheet = this.parent.getActiveSheet();\n        var id = this.parent.element.id;\n        var disableHomeBtnId = [id + '_undo', id + '_redo', id + '_cut', id + '_copy', id + '_paste', id + '_number_format',\n            id + '_font_name', id + '_font_size', id + '_bold', id + '_italic', id + '_line-through', id + '_underline',\n            id + '_font_color_picker', id + '_fill_color_picker', id + '_borders', id + '_merge_cells', id + '_text_align',\n            id + '_vertical_align', id + '_wrap', id + '_sorting', id + '_clear', id + '_conditionalformatting'];\n        var enableHomeBtnId = [id + '_cut', id + '_copy', id + '_number_format', id + '_font_name', id + '_font_size',\n            id + '_bold', id + '_italic', id + '_line-through', id + '_underline', id + '_font_color_picker', id + '_fill_color_picker',\n            id + '_borders', id + '_text_align', id + '_vertical_align', id + '_wrap', id + '_sorting',\n            id + '_clear', id + '_conditionalformatting'];\n        var enableFrmlaBtnId = [id + '_insert_function'];\n        var enableInsertBtnId = [id + '_hyperlink', id + '_', id + '_chart'];\n        var imageBtnId = [id + '_'];\n        var findBtnId = [id + '_find'];\n        var dataValidationBtnId = [id + '_datavalidation'];\n        var chartBtnId = [id + '_chart'];\n        var sheetElement = document.getElementById(this.parent.element.id + '_sheet_panel');\n        if (sheetElement) {\n            if ((sheet.isProtected && sheet.protectSettings.selectCells)) {\n                {\n                    sheetElement.classList.remove('e-protected');\n                }\n            }\n            else {\n                sheetElement.classList.add('e-protected');\n            }\n            if (!sheet.isProtected) {\n                sheetElement.classList.remove('e-protected');\n            }\n        }\n        this.parent.dataBind();\n        this.parent.notify(protectCellFormat, { disableHomeBtnId: disableHomeBtnId,\n            enableHomeBtnId: enableHomeBtnId, enableFrmlaBtnId: enableFrmlaBtnId, enableInsertBtnId: enableInsertBtnId,\n            findBtnId: findBtnId, dataValidationBtnId: dataValidationBtnId, imageBtnId: imageBtnId, chartBtnId: chartBtnId });\n        this.parent.notify(enableFormulaInput, null);\n        this.parent.notify(updateToggleItem, { props: 'Protect' });\n    };\n    ProtectSheet.prototype.editProtectedAlert = function () {\n        var _this = this;\n        var l10n = this.parent.serviceLocator.getService(locale);\n        this.dialog = this.parent.serviceLocator.getService('dialog');\n        this.dialog.show({\n            content: l10n.getConstant('EditAlert'),\n            isModal: true,\n            closeOnEscape: true,\n            showCloseIcon: true,\n            width: '400px',\n            cssClass: 'e-editAlert-dlg',\n            beforeOpen: function (args) {\n                var dlgArgs = {\n                    dialogName: 'EditAlertDialog',\n                    element: args.element, target: args.target, cancel: args.cancel\n                };\n                _this.parent.trigger('dialogBeforeOpen', dlgArgs);\n                if (dlgArgs.cancel) {\n                    args.cancel = true;\n                }\n                _this.parent.element.focus();\n            },\n            close: function () { return _this.parent.element.focus(); }\n        });\n    };\n    ProtectSheet.prototype.lockCellsHandler = function (args) {\n        var sheet = this.parent.getActiveSheet();\n        var cellObj = { isLocked: args.isLocked ? args.isLocked : false };\n        setCell(args.rowIdx, args.colIdx, sheet, cellObj, true);\n    };\n    /**\n     * Get the module name.\n     * @returns string\n     *\n     * @private\n     */\n    ProtectSheet.prototype.getModuleName = function () {\n        return 'protectSheet';\n    };\n    return ProtectSheet;\n}());\nexport { ProtectSheet };\n","import { findDlg, locale, dialog, gotoDlg, replace, findHandler, beginAction } from '../common/index';\nimport { completeAction } from '../common/index';\nimport { getComponent, isNullOrUndefined } from '@syncfusion/ej2-base';\nimport { goto, showDialog, findUndoRedo, count, replaceAllDialog, findKeyUp } from '../../workbook/index';\nimport { CheckBox } from '@syncfusion/ej2-buttons';\nimport { DropDownList } from '@syncfusion/ej2-dropdowns';\nimport { TextBox } from '@syncfusion/ej2-inputs';\n/**\n * `FindAndReplace` module is used to handle the search action in Spreadsheet.\n */\nvar FindAndReplace = /** @class */ (function () {\n    /**\n     * Constructor for FindAndReplace module.\n     */\n    function FindAndReplace(parent) {\n        this.shortValue = '';\n        this.parent = parent;\n        this.addEventListener();\n    }\n    FindAndReplace.prototype.addEventListener = function () {\n        this.parent.on(findDlg, this.renderFindDlg, this);\n        this.parent.on(gotoDlg, this.renderGotoDlg, this);\n        this.parent.on(goto, this.gotoHandler, this);\n        this.parent.on(findHandler, this.findHandler, this);\n        this.parent.on(replace, this.replaceHandler, this);\n        this.parent.on(showDialog, this.showDialog, this);\n        this.parent.on(replaceAllDialog, this.replaceAllDialog, this);\n        this.parent.on(findUndoRedo, this.findUndoRedo, this);\n        this.parent.on(findKeyUp, this.findKeyUp, this);\n    };\n    FindAndReplace.prototype.removeEventListener = function () {\n        if (!this.parent.isDestroyed) {\n            this.parent.off(findDlg, this.renderFindDlg);\n            this.parent.off(gotoDlg, this.renderGotoDlg);\n            this.parent.off(goto, this.gotoHandler);\n            this.parent.off(findHandler, this.findHandler);\n            this.parent.off(replace, this.replaceHandler);\n            this.parent.off(showDialog, this.showDialog);\n            this.parent.off(replaceAllDialog, this.replaceAllDialog);\n            this.parent.off(findUndoRedo, this.findUndoRedo);\n            this.parent.off(findKeyUp, this.findKeyUp);\n        }\n    };\n    FindAndReplace.prototype.findUndoRedo = function (options) {\n        var eventArgs = { address: options.address, compareVal: options.compareVal, cancel: false };\n        if (options.undoRedoOpt === 'before') {\n            this.parent.notify(beginAction, { action: 'beforeReplace', eventArgs: eventArgs });\n        }\n        else if (options.undoRedoOpt === 'after') {\n            if (!eventArgs.cancel) {\n                var eventArgs_1 = { address: options.address, compareVal: options.compareVal };\n                this.parent.notify(completeAction, { action: 'replace', eventArgs: eventArgs_1 });\n            }\n        }\n        else if (options.undoRedoOpt === 'beforeReplaceAll') {\n            if (!eventArgs.cancel) {\n                var eventArgs_2 = { replaceValue: options.replaceValue, addressCollection: options.Collection };\n                this.parent.notify(beginAction, { action: 'beforeReplaceAll', eventArgs: eventArgs_2 });\n            }\n        }\n        else if (options.undoRedoOpt === 'afterReplaceAll') {\n            if (!eventArgs.cancel) {\n                var eventArgs_3 = { replaceValue: options.replaceValue, addressCollection: options.Collection };\n                this.parent.notify(completeAction, { action: 'replaceAll', eventArgs: eventArgs_3 });\n            }\n        }\n    };\n    FindAndReplace.prototype.renderFindDlg = function () {\n        var _this = this;\n        var l10n = this.parent.serviceLocator.getService(locale);\n        var dialogInst = this.parent.serviceLocator.getService(dialog);\n        var cancelButton = false;\n        if (isNullOrUndefined(this.parent.element.querySelector('.e-find-dlg'))) {\n            var dlg = {\n                isModal: false, showCloseIcon: true, cssClass: 'e-find-dlg', allowDragging: true,\n                header: l10n.getConstant('FindAndReplace'), closeOnEscape: false,\n                beforeOpen: function (args) {\n                    var dlgArgs = {\n                        dialogName: 'FindAndReplaceDialog',\n                        element: args.element, target: args.target, cancel: args.cancel\n                    };\n                    _this.parent.trigger('dialogBeforeOpen', dlgArgs);\n                    if (dlgArgs.cancel) {\n                        args.cancel = true;\n                    }\n                    dialogInst.dialogInstance.content = _this.findandreplaceContent();\n                    dialogInst.dialogInstance.dataBind();\n                    _this.parent.element.focus();\n                },\n                buttons: [{\n                        buttonModel: {\n                            content: l10n.getConstant('FindPreviousBtn'), isPrimary: true, cssClass: 'e-btn-findPrevious', disabled: true\n                        },\n                        click: function () {\n                            _this.dialogMessage();\n                            _this.findDlgClick('prev');\n                        }\n                    }, {\n                        buttonModel: {\n                            content: l10n.getConstant('FindNextBtn'), isPrimary: true, cssClass: 'e-btn-findNext', disabled: true\n                        },\n                        click: function () {\n                            _this.dialogMessage();\n                            _this.findDlgClick('next');\n                        }\n                    }, {\n                        buttonModel: {\n                            content: l10n.getConstant('ReplaceBtn'), isPrimary: true, cssClass: 'e-btn-replace', disabled: true\n                        },\n                        click: function () {\n                            _this.dialogMessage();\n                            _this.findDlgClick('replace');\n                        }\n                    }, {\n                        buttonModel: {\n                            content: l10n.getConstant('ReplaceAllBtn'), isPrimary: true, cssClass: 'e-btn-replaceAll', disabled: true\n                        },\n                        click: function () {\n                            _this.dialogMessage();\n                            _this.findDlgClick('replaceAll');\n                        }\n                    }], open: function () {\n                    var findInput = _this.parent.element.querySelector('.e-text-findNext').value;\n                    if (findInput) {\n                        var prevButton = _this.parent.element.querySelector('.e-btn-findPrevious');\n                        var prevButtonObj = getComponent(prevButton, 'btn');\n                        prevButtonObj.disabled = false;\n                        getComponent(_this.parent.element.querySelector('.e-btn-findNext'), 'btn').disabled = false;\n                    }\n                }, close: function () {\n                    dialogInst.hide();\n                }\n            };\n            dialogInst.show(dlg, cancelButton);\n        }\n        else {\n            dialogInst.hide();\n        }\n    };\n    FindAndReplace.prototype.dialogMessage = function () {\n        if (this.parent.element.querySelector('.e-replace-alert-span')) {\n            this.parent.element.querySelector('.e-replace-alert-span').remove();\n        }\n        else if (this.parent.element.querySelector('.e-find-alert-span')) {\n            this.parent.element.querySelector('.e-find-alert-span').remove();\n        }\n    };\n    FindAndReplace.prototype.renderGotoDlg = function () {\n        var _this = this;\n        var l10n = this.parent.serviceLocator.getService(locale);\n        var dialogInst = this.parent.serviceLocator.getService(dialog);\n        var cancelBtn = false;\n        if (isNullOrUndefined(this.parent.element.querySelector('.e-find-dlg'))) {\n            var dlg = {\n                width: 300, isModal: false, showCloseIcon: true, cssClass: 'e-goto-dlg', allowDragging: true,\n                header: l10n.getConstant('GotoHeader'),\n                beforeOpen: function (args) {\n                    var dlgArgs = {\n                        dialogName: 'GoToDialog',\n                        element: args.element, target: args.target, cancel: args.cancel\n                    };\n                    _this.parent.trigger('dialogBeforeOpen', dlgArgs);\n                    if (dlgArgs.cancel) {\n                        args.cancel = true;\n                    }\n                    dialogInst.dialogInstance.content = _this.GotoContent();\n                    dialogInst.dialogInstance.dataBind();\n                    _this.parent.element.focus();\n                },\n                buttons: [{\n                        buttonModel: {\n                            content: l10n.getConstant('Ok'), isPrimary: true, cssClass: 'e-btn-goto-ok'\n                        },\n                        click: function () {\n                            _this.gotoHandler();\n                        },\n                    }], close: function () {\n                    dialogInst.hide();\n                }, open: function () {\n                    _this.textFocus();\n                },\n            };\n            dialogInst.show(dlg, cancelBtn);\n        }\n        else {\n            dialogInst.hide();\n        }\n    };\n    FindAndReplace.prototype.textFocus = function () {\n        var _this = this;\n        var element = this.parent.element.querySelector('.e-text-goto');\n        element.addEventListener('focus', function () {\n            if (_this.parent.element.querySelector('.e-goto-alert-span')) {\n                _this.parent.element.querySelector('.e-goto-alert-span').remove();\n            }\n        });\n    };\n    FindAndReplace.prototype.findDlgClick = function (findDlgArgs) {\n        if (findDlgArgs === 'prev') {\n            this.findHandler({ findOption: findDlgArgs });\n        }\n        else if (findDlgArgs === 'next') {\n            this.findHandler({ findOption: findDlgArgs });\n        }\n        else {\n            this.replaceHandler({ findDlgArgs: findDlgArgs });\n        }\n    };\n    FindAndReplace.prototype.findHandler = function (findOpt) {\n        var findInput = this.parent.element.querySelector('.e-text-findNext');\n        if (!findInput) {\n            findInput = this.parent.element.querySelector('.e-text-findNext-short');\n            if (!findInput) {\n                this.gotoAlert();\n            }\n        }\n        var value = findInput.value;\n        if (findInput.value !== '') {\n            var sheetIndex = this.parent.activeSheetIndex;\n            var checkCase = this.parent.element.querySelector('.e-findnreplace-checkcase');\n            var isCSen = void 0;\n            if (!checkCase) {\n                isCSen = false;\n            }\n            else {\n                var caseCheckbox = getComponent(checkCase, 'checkbox');\n                isCSen = caseCheckbox.checked;\n            }\n            var checkmatch = this.parent.element.querySelector('.e-findnreplace-checkmatch');\n            var isEMatch = void 0;\n            if (!checkmatch) {\n                isEMatch = false;\n            }\n            else {\n                var entireMatchCheckbox = getComponent(checkmatch, 'checkbox');\n                isEMatch = entireMatchCheckbox.checked;\n            }\n            var searchitem = this.parent.element.querySelector('.e-findnreplace-searchby');\n            var searchBy = void 0;\n            if (!searchitem) {\n                searchBy = 'By Row';\n            }\n            else {\n                var searchDDL = getComponent(searchitem, 'dropdownlist');\n                searchBy = searchDDL.value.toString();\n            }\n            var modeitem = this.parent.element.querySelector('.e-findnreplace-searchwithin');\n            var mode = void 0;\n            if (!modeitem) {\n                mode = 'Sheet';\n            }\n            else {\n                var modeDDL = getComponent(modeitem, 'dropdownlist');\n                mode = modeDDL.value.toString();\n            }\n            var args = {\n                value: value, sheetIndex: sheetIndex, findOpt: findOpt.findOption, mode: mode, isCSen: isCSen,\n                isEMatch: isEMatch, searchBy: searchBy\n            };\n            if (findOpt.findOption === 'next' || findOpt.findOption === 'prev') {\n                this.parent.find(args);\n            }\n            else if (findOpt.countArgs.countOpt === 'count') {\n                this.parent.notify(count, args);\n                findOpt.countArgs.findCount = args.findCount;\n            }\n        }\n    };\n    FindAndReplace.prototype.replaceHandler = function (replace) {\n        var sheetIndex = this.parent.activeSheetIndex;\n        var findInput = this.parent.element.querySelector('.e-text-findNext');\n        var replaceWith = this.parent.element.querySelector('.e-text-replaceInp');\n        var checkCase = this.parent.element.querySelector('.e-findnreplace-checkcase');\n        var caseCheckbox = getComponent(checkCase, 'checkbox');\n        var checkmatch = this.parent.element.querySelector('.e-findnreplace-checkmatch');\n        var eMatchCheckbox = getComponent(checkmatch, 'checkbox');\n        var searchitem = this.parent.element.querySelector('.e-findnreplace-searchby');\n        var searchDDL = getComponent(searchitem, 'dropdownlist');\n        var modeitem = this.parent.element.querySelector('.e-findnreplace-searchwithin');\n        var modeDDL = getComponent(modeitem, 'dropdownlist');\n        var findOption = 'next';\n        var args = {\n            value: findInput.value, mode: modeDDL.value.toString(), isCSen: caseCheckbox.checked,\n            isEMatch: eMatchCheckbox.checked, searchBy: searchDDL.value.toString(), findOpt: findOption, replaceValue: replaceWith.value,\n            replaceBy: replace.findDlgArgs ? replace.findDlgArgs : replace.replaceMode, sheetIndex: sheetIndex\n        };\n        this.parent.replace(args);\n    };\n    FindAndReplace.prototype.gotoHandler = function (address) {\n        if (address) {\n            this.parent.goTo(address.address);\n        }\n        else {\n            var item = this.parent.element.querySelector('.e-text-goto');\n            var gotoaddress = item.value;\n            var splitAddress = gotoaddress.split('');\n            if ((gotoaddress === '') || isNaN(parseInt(splitAddress[1], 10))) {\n                this.gotoAlert();\n                return;\n            }\n            else {\n                var address_1 = gotoaddress.toString().toUpperCase();\n                this.parent.goTo(address_1);\n            }\n        }\n    };\n    FindAndReplace.prototype.gotoAlert = function () {\n        var l10n = this.parent.serviceLocator.getService(locale);\n        var gotoSpan = this.parent.createElement('span', {\n            className: 'e-goto-alert-span',\n            innerHTML: l10n.getConstant('InsertingEmptyValue')\n        });\n        (this.parent.element.querySelector('.e-goto-dlg').querySelector('.e-dlg-content')).appendChild(gotoSpan);\n    };\n    FindAndReplace.prototype.showDialog = function () {\n        if (this.parent.element.querySelector('.e-replace-alert-span')) {\n            this.parent.element.querySelector('.e-replace-alert-span').remove();\n        }\n        var l10n = this.parent.serviceLocator.getService(locale);\n        var findSpan = this.parent.createElement('span', {\n            className: 'e-find-alert-span',\n            innerHTML: l10n.getConstant('NoElements')\n        });\n        (this.parent.element.querySelector('.e-find-dlg').querySelector('.e-dlg-content')).appendChild(findSpan);\n    };\n    FindAndReplace.prototype.replaceAllDialog = function (options) {\n        if (this.parent.element.querySelector('.e-find-alert-span')) {\n            this.parent.element.querySelector('.e-find-alert-span').remove();\n        }\n        var l10n = (this.parent.serviceLocator.getService(locale));\n        var replaceSpan = this.parent.createElement('span', {\n            className: 'e-replace-alert-span',\n            innerHTML: options.count + l10n.getConstant('ReplaceAllEnd') + options.replaceValue\n        });\n        if (this.parent.element.querySelector('.e-find-dlg')) {\n            (this.parent.element.querySelector('.e-find-dlg').querySelector('.e-dlg-content')).appendChild(replaceSpan);\n        }\n    };\n    FindAndReplace.prototype.findKeyUp = function (e) {\n        if (e.target, 'e-text-findNext') {\n            var findValue_1 = this.parent.element.querySelector('.e-text-findNext').value;\n            if (!isNullOrUndefined(findValue_1) && findValue_1 !== '') {\n                var prevButton = this.parent.element.querySelector('.e-btn-findPrevious');\n                var prevButtonObj = getComponent(prevButton, 'btn');\n                prevButtonObj.disabled = false;\n                getComponent(this.parent.element.querySelector('.e-btn-findNext'), 'btn').disabled = false;\n            }\n            else {\n                getComponent(this.parent.element.querySelector('.e-btn-findPrevious'), 'btn').disabled = true;\n                getComponent(this.parent.element.querySelector('.e-btn-findNext'), 'btn').disabled = true;\n                this.dialogMessage();\n            }\n        }\n        var findValue = this.parent.element.querySelector('.e-text-findNext').value;\n        var replaceValue = this.parent.element.querySelector('.e-text-replaceInp').value;\n        if (!isNullOrUndefined(findValue) && !isNullOrUndefined(replaceValue) && (findValue !== '') && (replaceValue !== '')) {\n            if (this.parent.getActiveSheet().isProtected === false) {\n                getComponent(this.parent.element.querySelector('.e-btn-replace'), 'btn').disabled = false;\n                getComponent(this.parent.element.querySelector('.e-btn-replaceAll'), 'btn').disabled = false;\n            }\n        }\n        else {\n            getComponent(this.parent.element.querySelector('.e-btn-replace'), 'btn').disabled = true;\n            getComponent(this.parent.element.querySelector('.e-btn-replaceAll'), 'btn').disabled = true;\n            this.dialogMessage();\n        }\n    };\n    FindAndReplace.prototype.findandreplaceContent = function () {\n        if (this.parent.element.querySelector('.e-text-findNext-short')) {\n            this.shortValue = this.parent.element.querySelector('.e-text-findNext-short').value;\n        }\n        var dialogElem = this.parent.createElement('div', { className: 'e-link-dialog' });\n        var findElem = this.parent.createElement('div', { className: 'e-find' });\n        var findCheck = this.parent.createElement('div', { className: 'e-findCheck' });\n        var l10n = this.parent.serviceLocator.getService(locale);\n        dialogElem.appendChild(findElem);\n        var findTextE = this.parent.createElement('div', { className: 'e-cont' });\n        var findTextH = this.parent.createElement('p', { className: 'e-header', innerHTML: l10n.getConstant('FindWhat') });\n        var findTextIp = this.parent.createElement('input', {\n            className: 'e-input e-text-findNext', attrs: {\n                'type': 'Text', 'placeholder': l10n.getConstant('FindValue'),\n                'value': this.shortValue\n            }\n        });\n        findTextE.appendChild(findTextIp);\n        findTextE.insertBefore(findTextH, findTextIp);\n        findElem.appendChild(findTextE);\n        var findTextBox = new TextBox({ width: '70%' });\n        findTextBox.createElement = this.parent.createElement;\n        findTextBox.appendTo(findTextIp);\n        var replaceTextE = this.parent.createElement('div', { className: 'e-cont' });\n        var replaceTextH = this.parent.createElement('p', { className: 'e-header', innerHTML: l10n.getConstant('ReplaceWith') });\n        var replaceTextIp = this.parent.createElement('input', {\n            className: 'e-input e-text-replaceInp', attrs: { 'type': 'Text', 'placeholder': l10n.getConstant('ReplaceValue') }\n        });\n        replaceTextE.appendChild(replaceTextIp);\n        replaceTextE.insertBefore(replaceTextH, replaceTextIp);\n        findElem.appendChild(replaceTextE);\n        var replaceTextBox = new TextBox({ width: '70%' });\n        replaceTextBox.createElement = this.parent.createElement;\n        replaceTextBox.appendTo(replaceTextIp);\n        var withinData = [\n            { Id: 'Sheet', Within: l10n.getConstant('Sheet') },\n            { Id: 'Workbook', Within: l10n.getConstant('Workbook') }\n        ];\n        var withInDDL = new DropDownList({\n            dataSource: withinData,\n            cssClass: 'e-searchby',\n            fields: { value: 'Id', text: 'Within' }, width: '50%', index: 0\n        });\n        var withIn = this.parent.createElement('input', {\n            className: 'e-findnreplace-searchwithin', attrs: { type: 'select', label: l10n.getConstant('SearchBy') }\n        });\n        var withinTextH = this.parent.createElement('p', { className: 'e-header', innerHTML: l10n.getConstant('SearchWithin') });\n        findElem.appendChild(withinTextH);\n        findElem.appendChild(withIn);\n        withInDDL.createElement = this.parent.createElement;\n        withInDDL.appendTo(withIn);\n        var searchData = [\n            { Id: 'By Row', Search: l10n.getConstant('ByRow') },\n            { Id: 'By Column', Search: l10n.getConstant('ByColumn') }\n        ];\n        var searchDDL = new DropDownList({\n            dataSource: searchData,\n            cssClass: 'e-searchby',\n            fields: { value: 'Id', text: 'Search' }, width: '50%', index: 0\n        });\n        var searchIn = this.parent.createElement('input', {\n            className: 'e-findnreplace-searchby', attrs: { type: 'select', label: l10n.getConstant('SearchBy') }\n        });\n        var searchTextH = this.parent.createElement('p', { className: 'e-header', innerHTML: l10n.getConstant('SearchBy') });\n        findElem.appendChild(searchTextH);\n        findElem.appendChild(searchIn);\n        searchDDL.createElement = this.parent.createElement;\n        searchDDL.appendTo(searchIn);\n        var isCSen = new CheckBox({\n            label: l10n.getConstant('MatchCase'), checked: false,\n            cssClass: 'e-findnreplace-casecheckbox'\n        });\n        var caaseCheckbox = this.parent.createElement('input', {\n            className: 'e-findnreplace-checkcase', attrs: { type: 'checkbox' }\n        });\n        findCheck.appendChild(caaseCheckbox);\n        isCSen.createElement = this.parent.createElement;\n        isCSen.appendTo(caaseCheckbox);\n        var isEMatch = new CheckBox({\n            label: l10n.getConstant('MatchExactCellElements'), checked: false,\n            cssClass: 'e-findnreplace-exactmatchcheckbox',\n        });\n        var entirematchCheckbox = this.parent.createElement('input', {\n            className: 'e-findnreplace-checkmatch', attrs: { type: 'checkbox' }\n        });\n        findCheck.appendChild(entirematchCheckbox);\n        isEMatch.createElement = this.parent.createElement;\n        isEMatch.appendTo(entirematchCheckbox);\n        findElem.appendChild(findCheck);\n        return dialogElem;\n    };\n    FindAndReplace.prototype.GotoContent = function () {\n        var l10n = this.parent.serviceLocator.getService(locale);\n        var dialogElem = this.parent.createElement('div', { className: 'e-link-dialog' });\n        var gotoElem = this.parent.createElement('div', { className: 'e-goto' });\n        dialogElem.appendChild(gotoElem);\n        var gotoTextE = this.parent.createElement('div', { className: 'e-cont' });\n        var gotoTextH = this.parent.createElement('p', { className: 'e-header', innerHTML: l10n.getConstant('Reference') });\n        var gotoTextBox = new TextBox({\n            placeholder: l10n.getConstant('EntercellAddress')\n        });\n        var gotoTextIp = this.parent.createElement('input', { className: 'e-text-goto', attrs: { 'type': 'Text' } });\n        gotoTextE.appendChild(gotoTextIp);\n        gotoTextE.insertBefore(gotoTextH, gotoTextIp);\n        gotoElem.appendChild(gotoTextE);\n        gotoTextBox.createElement = this.parent.createElement;\n        gotoTextBox.appendTo(gotoTextIp);\n        return dialogElem;\n    };\n    /**\n     * To destroy the find-and-replace module.\n     * @return {void}\n     */\n    FindAndReplace.prototype.destroy = function () {\n        this.removeEventListener();\n        this.parent = null;\n    };\n    /**\n     * Gets the module name.\n     * @returns string\n     */\n    FindAndReplace.prototype.getModuleName = function () {\n        return 'findAndReplace';\n    };\n    return FindAndReplace;\n}());\nexport { FindAndReplace };\n","import { applyMerge, activeCellMergedRange } from '../../workbook/common/index';\nimport { hiddenMerge, dialog, locale } from '../common/index';\nimport { checkPrevMerge, checkMerge } from '../common/index';\nimport { getCell, isHiddenCol, isHiddenRow } from '../../workbook/index';\n/**\n * The `Merge` module is used to to merge the range of cells.\n */\nvar Merge = /** @class */ (function () {\n    /**\n     * Constructor for the Spreadsheet merge module.\n     * @private\n     */\n    function Merge(parent) {\n        this.parent = parent;\n        this.addEventListener();\n    }\n    Merge.prototype.merge = function (args) {\n        var _this = this;\n        if (args.showDialog) {\n            this.parent.serviceLocator.getService(dialog).show({\n                target: this.parent.element,\n                height: 180, width: 400, isModal: true, showCloseIcon: true,\n                content: this.parent.serviceLocator.getService(locale).getConstant('PasteMergeAlert'),\n                beforeOpen: function (args) {\n                    var dlgArgs = {\n                        dialogName: 'MergeDialog',\n                        element: args.element, target: args.target, cancel: args.cancel\n                    };\n                    _this.parent.trigger('dialogBeforeOpen', dlgArgs);\n                    if (dlgArgs.cancel) {\n                        args.cancel = true;\n                    }\n                    _this.parent.element.focus();\n                },\n            });\n            return;\n        }\n        this.parent.serviceLocator.getService('cell').refresh(args.rowIdx, args.colIdx, args.lastCell, args.element);\n    };\n    Merge.prototype.hideHandler = function (args) {\n        var sheet = this.parent.getActiveSheet();\n        var mergeArgs = { range: [args.rowIdx, args.colIdx, args.rowIdx, args.colIdx] };\n        this.parent.notify(activeCellMergedRange, mergeArgs);\n        mergeArgs.range = mergeArgs.range;\n        var endIdx;\n        var cell = getCell(mergeArgs.range[0], mergeArgs.range[1], sheet) || {};\n        var startIdx = args.model === 'row' ? mergeArgs.range[0] : mergeArgs.range[1];\n        endIdx = startIdx + ((cell[args.model + \"Span\"] || 1) - 1);\n        if ((!args.isEnd && (args.start === startIdx || isHiddenCol(sheet, startIdx))) || (args.isEnd && (args.start > startIdx &&\n            !isHiddenCol(sheet, startIdx)))) {\n            return;\n        }\n        if (cell[args.model + \"Span\"] > 1 && endIdx >= args.start) {\n            if (args.model === 'row' ? isHiddenRow(sheet, startIdx) : isHiddenCol(sheet, startIdx)) {\n                if (args.end < endIdx && (endIdx - args.end > 1 || cell.rowSpan > 1)) {\n                    var cellEle = this.parent.getCell(args.rowIdx, args.end + 1);\n                    if (cellEle) {\n                        if (endIdx - args.end > 1) {\n                            cellEle.colSpan = endIdx - args.end;\n                        }\n                        cellEle.style.display = '';\n                    }\n                    if (cell.rowSpan > 1) {\n                        var rowSpan = cell.rowSpan - this.parent.hiddenCount(args.rowIdx, args.rowIdx + (cell.rowSpan - 1));\n                        if (rowSpan > 1) {\n                            cellEle.rowSpan = rowSpan;\n                        }\n                    }\n                }\n            }\n            else {\n                this.merge({ rowIdx: mergeArgs.range[0], colIdx: mergeArgs.range[1] });\n            }\n        }\n    };\n    Merge.prototype.checkPrevMerge = function (args) {\n        var cell;\n        var sheet = this.parent.getActiveSheet();\n        var mergeArgs;\n        var mergeCount;\n        if (args.isRow) {\n            if (args.rowIdx - 1 > -1 && isHiddenRow(sheet, args.rowIdx - 1)) {\n                cell = getCell(args.rowIdx - 1, args.colIdx, sheet) || {};\n                if ((cell.rowSpan !== undefined || cell.colSpan !== undefined) && (cell.colSpan === undefined || cell.colSpan > 1 ||\n                    (args.colIdx - 1 > -1 && isHiddenCol(sheet, args.colIdx - 1)))) {\n                    mergeArgs = { range: [args.rowIdx - 1, args.colIdx, args.rowIdx - 1, args.colIdx] };\n                    this.parent.notify(activeCellMergedRange, mergeArgs);\n                    mergeArgs.range = mergeArgs.range;\n                    if (isHiddenRow(sheet, mergeArgs.range[0]) && mergeArgs.range[2] >= args.rowIdx) {\n                        cell = getCell(mergeArgs.range[0], mergeArgs.range[1], sheet) || {};\n                        if (cell.rowSpan > 1) {\n                            mergeCount = (mergeArgs.range[2] - args.rowIdx) + 1 - this.parent.hiddenCount(args.rowIdx, args.rowIdx + (mergeArgs.range[2] - args.rowIdx));\n                            if (mergeCount > 1) {\n                                args.td.rowSpan = mergeCount;\n                                args.td.style.display = '';\n                            }\n                            if (cell.colSpan > 1 && !(args.colIdx - 1 > -1 && isHiddenCol(sheet, args.colIdx - 1))) {\n                                mergeCount = cell.colSpan - this.parent.hiddenCount(args.colIdx, args.colIdx + (cell.colSpan - 1), 'columns');\n                                if (mergeCount > 1) {\n                                    args.td.colSpan = mergeCount;\n                                    args.td.style.display = '';\n                                }\n                            }\n                        }\n                    }\n                }\n            }\n            return;\n        }\n        if (args.colIdx - 1 > -1 && isHiddenCol(sheet, args.colIdx - 1)) {\n            cell = getCell(args.rowIdx, args.colIdx - 1, sheet) || {};\n            if ((cell.colSpan !== undefined || cell.rowSpan !== undefined) && (cell.rowSpan === undefined || cell.rowSpan > 1 ||\n                (args.rowIdx - 1 > -1 && isHiddenRow(sheet, args.rowIdx - 1)))) {\n                mergeArgs = { range: [args.rowIdx, args.colIdx - 1, args.rowIdx, args.colIdx - 1] };\n                this.parent.notify(activeCellMergedRange, mergeArgs);\n                mergeArgs.range = mergeArgs.range;\n                if (isHiddenCol(sheet, mergeArgs.range[1]) && mergeArgs.range[3] >= args.colIdx) {\n                    cell = getCell(mergeArgs.range[0], mergeArgs.range[1], sheet) || {};\n                    if (cell.colSpan > 1) {\n                        mergeCount = (mergeArgs.range[3] - args.colIdx) + 1 - this.parent.hiddenCount(args.colIdx, args.colIdx + (cell.colSpan - 1), 'columns');\n                        if (mergeCount > 1) {\n                            args.td.colSpan = mergeCount;\n                            args.td.style.display = '';\n                        }\n                        if (cell.rowSpan > 1 && !(args.rowIdx - 1 > -1 && isHiddenRow(sheet, args.rowIdx - 1))) {\n                            mergeCount = cell.rowSpan - this.parent.hiddenCount(args.rowIdx, args.rowIdx + (cell.rowSpan - 1));\n                            if (mergeCount > 1) {\n                                args.td.rowSpan = mergeCount;\n                                args.td.style.display = '';\n                            }\n                        }\n                    }\n                }\n            }\n        }\n    };\n    Merge.prototype.checkMerge = function (args) {\n        var sheet = this.parent.getActiveSheet();\n        var cell = getCell(args.rowIdx, args.colIdx, sheet) || {};\n        if (args.isRow) {\n            if (cell.colSpan === undefined || isHiddenCol(sheet, args.colIdx - 1)) {\n                var mergeArgs = { range: [args.rowIdx, args.colIdx, args.rowIdx, args.colIdx] };\n                mergeArgs.range = mergeArgs.range;\n                this.parent.notify(activeCellMergedRange, mergeArgs);\n                if (isHiddenCol(sheet, args.colIdx - 1) && !isHiddenCol(sheet, mergeArgs.range[1])) {\n                    return;\n                }\n                cell = getCell(mergeArgs.range[0], mergeArgs.range[1], sheet);\n                var mergeCount = (mergeArgs.range[2] - args.rowIdx) + 1 - this.parent.hiddenCount(args.rowIdx, mergeArgs.range[2]);\n                if (mergeCount > 1) {\n                    this.merge({ rowIdx: mergeArgs.range[0], colIdx: mergeArgs.range[1], element: args.td });\n                    args.td.rowSpan = mergeCount;\n                    args.td.style.display = '';\n                }\n            }\n        }\n        else {\n            if (cell.rowSpan === undefined || isHiddenRow(sheet, args.rowIdx - 1)) {\n                var mergeArgs = { range: [args.rowIdx, args.colIdx, args.rowIdx, args.colIdx] };\n                mergeArgs.range = mergeArgs.range;\n                this.parent.notify(activeCellMergedRange, mergeArgs);\n                if (isHiddenRow(sheet, args.rowIdx - 1) && !isHiddenRow(sheet, mergeArgs.range[0])) {\n                    return;\n                }\n                cell = getCell(mergeArgs.range[0], mergeArgs.range[1], sheet);\n                var mergeCount = (mergeArgs.range[3] - args.colIdx) + 1 - this.parent.hiddenCount(args.colIdx, mergeArgs.range[3], 'columns');\n                if (mergeCount > 1) {\n                    this.merge({ rowIdx: mergeArgs.range[0], colIdx: mergeArgs.range[1], element: args.td });\n                    args.td.colSpan = mergeCount;\n                    args.td.style.display = '';\n                }\n            }\n        }\n    };\n    Merge.prototype.addEventListener = function () {\n        this.parent.on(applyMerge, this.merge, this);\n        this.parent.on(hiddenMerge, this.hideHandler, this);\n        this.parent.on(checkPrevMerge, this.checkPrevMerge, this);\n        this.parent.on(checkMerge, this.checkMerge, this);\n    };\n    /**\n     * Destroy merge module.\n     */\n    Merge.prototype.destroy = function () {\n        this.removeEventListener();\n        this.parent = null;\n    };\n    Merge.prototype.removeEventListener = function () {\n        if (!this.parent.isDestroyed) {\n            this.parent.off(applyMerge, this.merge);\n            this.parent.off(hiddenMerge, this.hideHandler);\n            this.parent.off(checkPrevMerge, this.checkPrevMerge);\n            this.parent.off(checkMerge, this.checkMerge);\n        }\n    };\n    /**\n     * Get the merge module name.\n     */\n    Merge.prototype.getModuleName = function () {\n        return 'merge';\n    };\n    return Merge;\n}());\nexport { Merge };\n","import { checkConditionalFormat, initiateConditionalFormat, locale, dialog, setCF } from '../common/index';\nimport { beginAction, completeAction } from '../common/index';\nimport { getCell, setRow, setCell } from '../../workbook/base/index';\nimport { getRangeIndexes, checkDateFormat, cFInitialCheck, isNumber, cFRender, cFDelete } from '../../workbook/common/index';\nimport { isDateTime, dateToInt, applyCellFormat, clearCF } from '../../workbook/common/index';\nimport { setCFRule, clearCells } from '../../workbook/common/index';\nimport { isNullOrUndefined } from '@syncfusion/ej2-base';\nimport { DropDownList } from '@syncfusion/ej2-dropdowns';\nimport { NumericTextBox } from '@syncfusion/ej2-inputs';\n/**\n * Represents Conditional Formatting support for Spreadsheet.\n */\nvar ConditionalFormatting = /** @class */ (function () {\n    /**\n     * Constructor for the Spreadsheet Conditional Formatting module.\n     */\n    function ConditionalFormatting(parent) {\n        this.parent = parent;\n        this.addEventListener();\n    }\n    /**\n     * To destroy the Conditional Formatting module.\n     * @return {void}\n     */\n    ConditionalFormatting.prototype.destroy = function () {\n        this.removeEventListener();\n    };\n    ConditionalFormatting.prototype.addEventListener = function () {\n        this.parent.on(cFRender, this.cFInitialRender, this);\n        this.parent.on(cFInitialCheck, this.cFInitialCheckHandler, this);\n        this.parent.on(checkConditionalFormat, this.checkConditionalFormatHandler, this);\n        this.parent.on(initiateConditionalFormat, this.initiateCFHandler, this);\n        this.parent.on(setCF, this.setCFHandler, this);\n        this.parent.on(cFDelete, this.cFDeleteHandler, this);\n        this.parent.on(clearCF, this.clearCFHandler, this);\n        this.parent.on(clearCells, this.addClearCFHandler, this);\n    };\n    ConditionalFormatting.prototype.removeEventListener = function () {\n        if (!this.parent.isDestroyed) {\n            this.parent.off(cFRender, this.cFInitialRender);\n            this.parent.off(cFInitialCheck, this.cFInitialCheckHandler);\n            this.parent.off(checkConditionalFormat, this.checkConditionalFormatHandler);\n            this.parent.off(initiateConditionalFormat, this.initiateCFHandler);\n            this.parent.off(setCF, this.setCFHandler);\n            this.parent.off(cFDelete, this.cFDeleteHandler);\n            this.parent.off(clearCF, this.clearCFHandler);\n        }\n    };\n    ConditionalFormatting.prototype.setCF = function (conditionalFormat) {\n        conditionalFormat.range = conditionalFormat.range || this.parent.getActiveSheet().selectedRange;\n        var eventArgs = {\n            range: conditionalFormat.range, type: conditionalFormat.type, cFColor: conditionalFormat.cFColor,\n            value: conditionalFormat.value, cancel: false\n        };\n        this.parent.notify(beginAction, { eventArgs: eventArgs, action: 'conditionalFormat' });\n        if (!eventArgs.cancel) {\n            conditionalFormat.type = eventArgs.type;\n            conditionalFormat.cFColor = eventArgs.cFColor;\n            conditionalFormat.value = eventArgs.value;\n            conditionalFormat.range = eventArgs.range;\n            this.parent.notify(setCFRule, { conditionalFormat: conditionalFormat });\n            delete eventArgs.cancel;\n            this.parent.notify(completeAction, { eventArgs: eventArgs, action: 'conditionalFormat' });\n        }\n    };\n    ConditionalFormatting.prototype.addClearCFHandler = function (args) {\n        var sheet = this.parent.getActiveSheet();\n        var clearCFormats = args.conditionalFormats;\n        var oldRange = args.oldRange;\n        var selectedRange = args.selectedRange;\n        var conditionalFormats = sheet.conditionalFormats;\n        for (var cCFIdx = 0; cCFIdx < clearCFormats.length; cCFIdx++) {\n            var isApply = false;\n            for (var cFIdx = 0; cFIdx < conditionalFormats.length; cFIdx++) {\n                if (conditionalFormats[cFIdx].type === clearCFormats[cCFIdx].type &&\n                    conditionalFormats[cFIdx].range === clearCFormats[cCFIdx].range) {\n                    isApply = true;\n                    conditionalFormats[cFIdx].range = oldRange[cCFIdx];\n                    sheet.conditionalFormats[cFIdx].range = oldRange[cCFIdx];\n                    var sRangeIdx = getRangeIndexes(selectedRange);\n                    var cFRanges = oldRange[cCFIdx].split(',');\n                    for (var cFRangeIdx = 0; cFRangeIdx < cFRanges.length; cFRangeIdx++) {\n                        var newRangeIdxs = getRangeIndexes(cFRanges[cFRangeIdx]);\n                        for (var cFRowIdx = newRangeIdxs[0]; cFRowIdx <= newRangeIdxs[2]; cFRowIdx++) {\n                            for (var cFColIdx = newRangeIdxs[1]; cFColIdx <= newRangeIdxs[3]; cFColIdx++) {\n                                for (var sRRowIdx = sRangeIdx[0]; sRRowIdx <= sRangeIdx[2]; sRRowIdx++) {\n                                    for (var sRColIdx = sRangeIdx[1]; sRColIdx <= sRangeIdx[3]; sRColIdx++) {\n                                        if (sRRowIdx === cFRowIdx && sRColIdx === cFColIdx) {\n                                            var td = this.parent.getCell(cFRowIdx, cFColIdx);\n                                            var cell = sheet.rows[cFRowIdx] ? sheet.rows[cFRowIdx].cells[cFColIdx] ?\n                                                sheet.rows[cFRowIdx].cells[cFColIdx] : null : null;\n                                            if (cell) {\n                                                this.cFInitialCheckHandler({\n                                                    rowIdx: cFRowIdx, colIdx: cFColIdx,\n                                                    cell: cell, td: td, conditionalFormat: conditionalFormats[cFIdx]\n                                                });\n                                            }\n                                        }\n                                    }\n                                }\n                            }\n                        }\n                    }\n                }\n            }\n            if (!isApply) {\n                var conditionalFormat = clearCFormats[cCFIdx];\n                conditionalFormat.range = oldRange[cCFIdx];\n                this.parent.notify(setCFRule, { conditionalFormat: conditionalFormat });\n            }\n        }\n    };\n    ConditionalFormatting.prototype.cFDeleteHandler = function (args) {\n        var td = this.parent.getCell(args.rowIdx, args.colIdx);\n        if (td) {\n            if (td.querySelector('.e-cf-databar')) {\n                td.removeChild(td.querySelector('.e-cf-databar'));\n            }\n            if (td.querySelector('.e-iconsetspan')) {\n                td.removeChild(td.querySelector('.e-iconsetspan'));\n            }\n        }\n    };\n    ConditionalFormatting.prototype.clearCFHandler = function (args) {\n        var sheet = this.parent.getActiveSheet();\n        var tdEle = this.parent.getCell(args.rIdx, args.cIdx);\n        var cell = getCell(args.rIdx, args.cIdx, sheet);\n        if (!tdEle) {\n            return;\n        }\n        tdEle.classList.remove('e-redft');\n        tdEle.classList.remove('e-yellowft');\n        tdEle.classList.remove('e-greenft');\n        tdEle.classList.remove('e-redf');\n        tdEle.classList.remove('e-redt');\n        tdEle.classList.remove('e-iconset');\n        if (tdEle.style) {\n            if (tdEle.style.backgroundColor) {\n                tdEle.style.backgroundColor = '';\n                var style = this.parent.getCellStyleValue(['backgroundColor'], [args.rIdx, args.cIdx]);\n                this.parent.notify(applyCellFormat, {\n                    style: style, rowIdx: args.rIdx, colIdx: args.cIdx\n                });\n            }\n            if (tdEle.style.color) {\n                tdEle.style.color = '';\n                var style = this.parent.getCellStyleValue(['color'], [args.rIdx, args.cIdx]);\n                this.parent.notify(applyCellFormat, {\n                    style: style, rowIdx: args.rIdx, colIdx: args.cIdx\n                });\n            }\n        }\n        if (tdEle.querySelector('.e-cf-databar')) {\n            tdEle.removeChild(tdEle.querySelector('.e-cf-databar'));\n            tdEle.textContent = this.parent.getDisplayText(cell);\n        }\n        if (tdEle.querySelector('.e-iconsetspan')) {\n            tdEle.removeChild(tdEle.querySelector('.e-iconsetspan'));\n            tdEle.textContent = this.parent.getDisplayText(cell);\n        }\n    };\n    ConditionalFormatting.prototype.setCFHandler = function (args) {\n        if (args.action === 'cf_databars') {\n            this.setCF({ type: args.id });\n        }\n        else if (args.action === 'cf_colorscales') {\n            this.setCF({ type: args.id });\n        }\n        else if (args.action === 'cf_iconsets') {\n            this.setCF({ type: args.id });\n        }\n    };\n    ConditionalFormatting.prototype.initiateCFHandler = function (args) {\n        var _this = this;\n        var l10n = this.parent.serviceLocator.getService(locale);\n        var dialogInst = this.parent.serviceLocator.getService(dialog);\n        dialogInst.show({\n            width: 375, showCloseIcon: true, isModal: true, cssClass: 'e-conditionalformatting-dlg',\n            header: args.action.replace('...', ''),\n            target: document.querySelector('.e-control.e-spreadsheet'),\n            beforeOpen: function () {\n                dialogInst.dialogInstance.content = _this.cFDlgContent(args.action);\n                dialogInst.dialogInstance.dataBind();\n                _this.parent.element.focus();\n            },\n            buttons: [{\n                    buttonModel: {\n                        content: l10n.getConstant('Ok'),\n                        isPrimary: true,\n                        cssClass: 'e-btn e-clearall-btn e-flat'\n                    },\n                    click: function () {\n                        _this.dlgClickHandler(args.action);\n                        dialogInst.hide();\n                    }\n                }]\n        });\n        dialogInst.dialogInstance.refresh();\n    };\n    ConditionalFormatting.prototype.dlgClickHandler = function (action) {\n        var value1 = '';\n        var value2 = '';\n        var dlgCont = this.parent.element.querySelector('.e-conditionalformatting-dlg').\n            getElementsByClassName('e-dlg-content')[0].querySelector('.e-cf-dlg');\n        var mainCont = dlgCont.querySelector('.e-cfmain');\n        if (mainCont) {\n            var inpEle = mainCont.getElementsByTagName('input')[0];\n            if (inpEle && inpEle.parentElement.classList.contains('e-cfmain')) {\n                value1 = mainCont.getElementsByTagName('input')[0].value;\n            }\n            value2 = mainCont.getElementsByTagName('input')[1] ?\n                dlgCont.querySelector('.e-cfmain').getElementsByTagName('input')[1].value : '';\n        }\n        var cFColor = this.getCFColor(dlgCont.querySelector('.e-cfsub').getElementsByTagName('input')[0].value);\n        var cFType = action === 'Duplicate Values...' ?\n            dlgCont.querySelector('.e-cfmain').getElementsByTagName('input')[0].value : this.getType(action);\n        if (value1 !== '' && value2 !== '') {\n            this.setCF({\n                type: cFType,\n                cFColor: cFColor, value: value1 + ',' + value2\n            });\n        }\n        else if (value1 !== '') {\n            this.setCF({\n                type: cFType,\n                cFColor: cFColor, value: value1\n            });\n        }\n        else {\n            this.setCF({\n                type: cFType,\n                cFColor: cFColor, value: value2\n            });\n        }\n    };\n    ConditionalFormatting.prototype.getType = function (action) {\n        var l10n = this.parent.serviceLocator.getService(locale);\n        var result = '';\n        switch (action) {\n            case l10n.getConstant('GreaterThan') + '...':\n                result = 'GreaterThan';\n                break;\n            case l10n.getConstant('LessThan') + '...':\n                result = 'LessThan';\n                break;\n            case l10n.getConstant('Between') + '...':\n                result = 'Between';\n                break;\n            case l10n.getConstant('CFEqualTo') + '...':\n                result = 'EqualTo';\n                break;\n            case l10n.getConstant('TextThatContains') + '...':\n                result = 'ContainsText';\n                break;\n            case l10n.getConstant('ADateOccuring') + '...':\n                result = 'DateOccur';\n                break;\n            case l10n.getConstant('Top10Items') + '...':\n                result = 'Top10Items';\n                break;\n            case l10n.getConstant('Bottom10Items') + '...':\n                result = 'Bottom10Items';\n                break;\n            case l10n.getConstant('Top10') + ' %...':\n                result = 'Top10Percentage';\n                break;\n            case l10n.getConstant('Bottom10') + ' %...':\n                result = 'Bottom10Percentage';\n                break;\n            case l10n.getConstant('AboveAverage') + '...':\n                result = 'AboveAverage';\n                break;\n            case l10n.getConstant('BelowAverage') + '...':\n                result = 'BelowAverage';\n                break;\n        }\n        return result;\n    };\n    ConditionalFormatting.prototype.getCFColor = function (value) {\n        var l10n = this.parent.serviceLocator.getService(locale);\n        var result = 'RedFT';\n        switch (value) {\n            case l10n.getConstant('LightRedFillWithDarkRedText'):\n                result = 'RedFT';\n                break;\n            case l10n.getConstant('YellowFillWithDarkYellowText'):\n                result = 'YellowFT';\n                break;\n            case l10n.getConstant('GreenFillWithDarkGreenText'):\n                result = 'GreenFT';\n                break;\n            case l10n.getConstant('RedFill'):\n                result = 'RedF';\n                break;\n            case l10n.getConstant('RedText'):\n                result = 'RedT';\n                break;\n        }\n        return result;\n    };\n    ConditionalFormatting.prototype.cFDlgContent = function (action) {\n        var dlgText = this.getDlgText(action);\n        var l10n = this.parent.serviceLocator.getService(locale);\n        var dlgContent = this.parent.createElement('div', { className: 'e-cf-dlg' });\n        var mainDiv = this.parent.createElement('div', { className: 'e-cfmain' });\n        var subDiv = this.parent.createElement('div', { className: 'e-cfsub' });\n        var value1Text = this.parent.createElement('span', { className: 'e-header e-top-header', innerHTML: dlgText });\n        var value1Inp = this.parent.createElement('input', { className: 'e-input', id: 'valueInput', attrs: { type: 'text' } });\n        var duplicateSelectEle = this.parent.createElement('input', { className: 'e-select' });\n        var subDivText = this.parent.createElement('span', { className: 'e-header', innerHTML: l10n.getConstant('With') });\n        var colorSelectEle = this.parent.createElement('input', { className: 'e-select' });\n        dlgContent.appendChild(mainDiv);\n        dlgContent.appendChild(subDiv);\n        mainDiv.appendChild(value1Text);\n        if (action !== l10n.getConstant('DuplicateValues') + '...') {\n            if (action !== l10n.getConstant('AboveAverage') + '...' && action !== l10n.getConstant('BelowAverage') + '...') {\n                mainDiv.appendChild(value1Inp);\n                if (action === l10n.getConstant('Top10Items') + '...' || action === l10n.getConstant('Top10') + ' %...' ||\n                    action === l10n.getConstant('Bottom10Items') + '...' || action === l10n.getConstant('Bottom10') + ' %...') {\n                    var numeric = new NumericTextBox({\n                        value: 10\n                    });\n                    numeric.appendTo(value1Inp);\n                }\n            }\n        }\n        else {\n            mainDiv.appendChild(duplicateSelectEle);\n            var dupData = [\n                { text: l10n.getConstant('Duplicate'), id: 'duplicate' },\n                { text: l10n.getConstant('Unique'), id: 'unique' },\n            ];\n            var dupList = new DropDownList({\n                dataSource: dupData,\n                index: 0,\n                popupHeight: '200px'\n            });\n            dupList.appendTo(duplicateSelectEle);\n        }\n        if (action === l10n.getConstant('Between') + '...') {\n            var value2Text = this.parent.createElement('span', { className: 'e-header e-header-2', innerHTML: l10n.getConstant('And') });\n            var value2Inp = this.parent.createElement('input', { className: 'e-input' });\n            mainDiv.appendChild(value2Text);\n            mainDiv.appendChild(value2Inp);\n        }\n        subDiv.appendChild(subDivText);\n        subDiv.appendChild(colorSelectEle);\n        var colorData = [\n            { text: l10n.getConstant('LightRedFillWithDarkRedText'), value: 'redft', id: 'redft' },\n            { text: l10n.getConstant('YellowFillWithDarkYellowText'), id: 'yellowft' },\n            { text: l10n.getConstant('GreenFillWithDarkGreenText'), id: 'greenft' },\n            { text: l10n.getConstant('RedFill'), id: 'redf' },\n            { text: l10n.getConstant('RedText'), id: 'redt' },\n        ];\n        var colorList = new DropDownList({\n            dataSource: colorData,\n            index: 0,\n            popupHeight: '200px'\n        });\n        colorList.appendTo(colorSelectEle);\n        return dlgContent;\n    };\n    ConditionalFormatting.prototype.checkCellHandler = function (rowIdx, colIdx, conditionalFormat) {\n        var isApply = false;\n        var ranges = conditionalFormat.range.trim().split(',');\n        for (var rangeIdx = 0; rangeIdx < ranges.length; rangeIdx++) {\n            var cFrange = ranges[rangeIdx];\n            cFrange = cFrange.indexOf(':') > -1 ? cFrange : cFrange + ':' + cFrange;\n            var indexes = getRangeIndexes(cFrange);\n            if (rowIdx >= indexes[0] && rowIdx <= indexes[2] && colIdx >= indexes[1] && colIdx <= indexes[3]) {\n                isApply = true;\n                break;\n            }\n        }\n        return isApply;\n    };\n    ConditionalFormatting.prototype.getDlgText = function (action) {\n        var l10n = this.parent.serviceLocator.getService(locale);\n        var result = '';\n        switch (action) {\n            case l10n.getConstant('GreaterThan') + '...':\n                result = l10n.getConstant('FormatCellsGreaterThan');\n                break;\n            case l10n.getConstant('LessThan') + '...':\n                result = l10n.getConstant('FormatCellsLessThan');\n                break;\n            case l10n.getConstant('Between') + '...':\n                result = l10n.getConstant('FormatCellsBetween');\n                break;\n            case l10n.getConstant('CFEqualTo') + '...':\n                result = l10n.getConstant('FormatCellsEqualTo');\n                break;\n            case l10n.getConstant('TextThatContains') + '...':\n                result = l10n.getConstant('FormatCellsThatContainTheText');\n                break;\n            case l10n.getConstant('ADateOccuring') + '...':\n                result = l10n.getConstant('FormatCellsThatContainADateOccurring');\n                break;\n            case l10n.getConstant('DuplicateValues') + '...':\n                result = l10n.getConstant('FormatCellsDuplicate');\n                break;\n            case l10n.getConstant('Top10Items') + '...':\n                result = l10n.getConstant('FormatCellsTop');\n                break;\n            case l10n.getConstant('Top10') + ' %...':\n                result = l10n.getConstant('FormatCellsTop');\n                break;\n            case l10n.getConstant('Bottom10Items') + '...':\n                result = l10n.getConstant('FormatCellsBottom');\n                break;\n            case l10n.getConstant('Bottom10') + ' %...':\n                result = l10n.getConstant('FormatCellsBottom');\n                break;\n            case l10n.getConstant('AboveAverage') + '...':\n                result = l10n.getConstant('FormatCellsAbove');\n                break;\n            case l10n.getConstant('BelowAverage') + '...':\n                result = l10n.getConstant('FormatCellsBelow');\n                break;\n        }\n        return result;\n    };\n    ConditionalFormatting.prototype.cFInitialRender = function (args) {\n        var cFRules = this.parent.getActiveSheet().conditionalFormats;\n        if (cFRules) {\n            for (var cFRIdx = 0; cFRIdx < cFRules.length; cFRIdx++) {\n                var isApply = false;\n                isApply = this.checkCellHandler(args.rowIdx, args.colIdx, cFRules[cFRIdx]);\n                if (isApply) {\n                    this.cFInitialCheckHandler({\n                        rowIdx: args.rowIdx, colIdx: args.colIdx,\n                        cell: args.cell, td: args.td, conditionalFormat: cFRules[cFRIdx]\n                    });\n                }\n            }\n        }\n    };\n    ConditionalFormatting.prototype.cFInitialCheckHandler = function (args) {\n        var sheet = this.parent.getActiveSheet();\n        var formatStyle;\n        var isApply = false;\n        var cFColors = ['e-redft', 'e-yellowft', 'e-greenft', 'e-redf', 'e-redt'];\n        var value = args.cell.value || '';\n        var cFRule = args.conditionalFormat;\n        var td = args.td || this.parent.getCell(args.rowIdx, args.colIdx);\n        if (!td) {\n            return;\n        }\n        cFRule.type = cFRule.type || 'GreaterThan';\n        cFRule.cFColor = cFRule.cFColor ? cFRule.cFColor : cFRule.format ? cFRule.cFColor : 'RedFT';\n        isApply = this.cFRCheck(cFRule, value, td, args.rowIdx, args.colIdx, true);\n        if (isApply) {\n            for (var idx = 0; idx < cFColors.length; idx++) {\n                if (td.classList.contains(cFColors[idx])) {\n                    td.classList.remove(cFColors[idx]);\n                    break;\n                }\n            }\n            if (cFRule.format && cFRule.format.style) {\n                formatStyle = cFRule.format.style;\n            }\n            var style = {};\n            if (cFRule.cFColor) {\n                td.classList.add('e-' + cFRule.cFColor.toLowerCase());\n                style = this.setFormat(style, cFRule);\n            }\n            else {\n                style = formatStyle;\n            }\n            if (style.backgroundColor) {\n                td.style.setProperty('background-color', style.backgroundColor);\n            }\n            if (style.color) {\n                td.style.setProperty('color', style.color);\n            }\n            if (style.fontWeight) {\n                td.style.setProperty('font-weight', style.fontWeight);\n            }\n            if (style.fontStyle) {\n                td.style.setProperty('font-style', style.fontStyle);\n            }\n            if (style.textDecoration) {\n                td.style.setProperty('text-decoration', style.textDecoration);\n            }\n        }\n    };\n    ConditionalFormatting.prototype.checkConditionalFormatHandler = function (args) {\n        var indexes;\n        var isApply = false;\n        var result = false;\n        var sheet = this.parent.getActiveSheet();\n        var cell = args.cell;\n        var td;\n        var cFRules = sheet.conditionalFormats;\n        var mainCnt = this.parent.getMainContent();\n        var value = !cell ? '' : !isNullOrUndefined(cell.value) ? cell.value : '';\n        var cFColors = ['e-redft', 'e-yellowft', 'e-greenft', 'e-redf', 'e-redt'];\n        var cFRIdx;\n        td = this.parent.getCell(args.rowIdx, args.colIdx);\n        if (!cFRules || cFRules.length < 1) {\n            return;\n        }\n        for (var cFRuleIdx = 0; cFRuleIdx < cFRules.length; cFRuleIdx++) {\n            var cFRanges = cFRules[cFRuleIdx].range.trim().split(',');\n            for (var rangeIdx = 0; rangeIdx < cFRanges.length; rangeIdx++) {\n                var range = cFRanges[rangeIdx];\n                range = range.indexOf(':') > -1 ? range : range + ':' + range;\n                indexes = getRangeIndexes(range);\n                if (args.rowIdx >= indexes[0] && args.colIdx >= indexes[1] && args.rowIdx <= indexes[2] && args.colIdx <= indexes[3]) {\n                    cFRIdx = cFRuleIdx;\n                    result = true;\n                    break;\n                }\n            }\n            if (result) {\n                if (('GreaterThan' + 'LessThan' + 'EqualTo' + 'Between' + 'ContainsText' +\n                    'DateOccur').includes(sheet.conditionalFormats[cFRuleIdx].type)) {\n                    var cellVal = getCell(args.rowIdx, args.colIdx, sheet) && getCell(args.rowIdx, args.colIdx, sheet).value ?\n                        getCell(args.rowIdx, args.colIdx, sheet).value : '';\n                    if (isNullOrUndefined(cellVal) && cellVal === '') {\n                        isApply = false;\n                    }\n                    else {\n                        isApply = this.cFRCheck(sheet.conditionalFormats[cFRuleIdx], cellVal, td);\n                    }\n                    this.setColor(td, args.rowIdx, args.colIdx, cFRuleIdx, isApply);\n                }\n                else if (('Top10Items' + 'Bottom10Items' + 'Top10%' + 'Bottom10%' + 'AboveAverage' +\n                    'BelowAverage' + 'Duplicate' + 'Unique').includes(sheet.conditionalFormats[cFRuleIdx].type)) {\n                    for (var rangeIdx = 0; rangeIdx < cFRanges.length; rangeIdx++) {\n                        var range = cFRanges[rangeIdx];\n                        range = range.indexOf(':') > -1 ? range : range + ':' + range;\n                        indexes = getRangeIndexes(range);\n                        for (var rIdx = indexes[0]; rIdx <= indexes[2]; rIdx++) {\n                            if (!sheet.rows[rIdx]) {\n                                setRow(sheet, rIdx, {});\n                            }\n                            for (var cIdx = indexes[1]; cIdx <= indexes[3]; cIdx++) {\n                                if (!sheet.rows[rIdx].cells || !sheet.rows[rIdx].cells[cIdx]) {\n                                    setCell(rIdx, cIdx, sheet, {});\n                                }\n                                var cellVal = getCell(rIdx, cIdx, sheet) && getCell(rIdx, cIdx, sheet).value ?\n                                    getCell(rIdx, cIdx, sheet).value : '';\n                                isApply = this.cFRCheck(sheet.conditionalFormats[cFRuleIdx], cellVal, td, rIdx, cIdx, false);\n                                td = this.parent.getCell(rIdx, cIdx);\n                                this.setColor(td, rIdx, cIdx, cFRuleIdx, isApply);\n                            }\n                        }\n                    }\n                }\n                else if (('BlueDataBar' + 'GreenDataBar' + 'RedDataBar' + 'OrangeDataBar' + 'LightBlueDataBar' + 'PurpleColorScale' +\n                    'GYRColorScale' + 'RYGColorScale' + 'GWRColorScale' + 'RWGColorScale' + 'BWRColorScale' + 'RWBColorScale' +\n                    'WRColorScale' + 'RWColorScale' + 'GWColorScale' + 'WGColorScale' + 'GYColorScale' + 'YGColorScale' + 'ThreeArrows' +\n                    'ThreeArrowsGray' + 'FourArrowsGray' + 'FourArrows' + 'FiveArrowsGray' + 'FiveArrows' + 'ThreeTrafficLights1' +\n                    'ThreeTrafficLights2' + 'ThreeSigns' + 'FourTrafficLights' + 'FourRedToBlack' + 'ThreeSymbols' + 'ThreeSymbols2' +\n                    'ThreeFlags' + 'FourRating' + 'FiveQuarters' + 'FiveRating' + 'ThreeTriangles' + 'ThreeStars' + 'FiveBoxes').\n                    includes(sheet.conditionalFormats[cFRuleIdx].type)) {\n                    for (var idx = 0; idx < cFColors.length; idx++) {\n                        if (td.classList.contains(cFColors[idx])) {\n                            td.classList.remove(cFColors[idx]);\n                        }\n                    }\n                    isApply = this.cFRCheck(sheet.conditionalFormats[cFRuleIdx], value, td, args.rowIdx, args.colIdx, false);\n                }\n                result = false;\n            }\n        }\n    };\n    ConditionalFormatting.prototype.setColor = function (td, rIdx, cIdx, cFRuleIdx, isApply) {\n        var sheet = this.parent.getActiveSheet();\n        var cFRules = sheet.conditionalFormats;\n        var cFColors = ['e-redft', 'e-yellowft', 'e-greenft', 'e-redf', 'e-redt'];\n        var isActiveCF = false;\n        if (cFRules[cFRuleIdx].cFColor) {\n            if (td && td.classList.contains('e-' + cFRules[cFRuleIdx].cFColor.toLowerCase())) {\n                isActiveCF = true;\n            }\n        }\n        else if (cFRules[cFRuleIdx].format.style.backgroundColor && td.style.backgroundColor) {\n            var rgb = this.hexToRgb(cFRules[cFRuleIdx].format.style.backgroundColor);\n            if ('rgb(' + rgb.r + ', ' + rgb.g + ', ' + rgb.b + ')' === td.style.backgroundColor) {\n                isActiveCF = true;\n            }\n        }\n        if (isApply) {\n            if (isActiveCF) {\n                for (var idx = 0; idx < cFColors.length; idx++) {\n                    if (td.classList.contains(cFColors[idx])) {\n                        td.classList.remove(cFColors[idx]);\n                        break;\n                    }\n                }\n            }\n            var style = {};\n            if (cFRules[cFRuleIdx].cFColor) {\n                td.classList.add('e-' + cFRules[cFRuleIdx].cFColor.toLowerCase());\n                style = this.setFormat(style, cFRules[cFRuleIdx]);\n            }\n            else {\n                style = cFRules[cFRuleIdx].format.style;\n            }\n            this.parent.notify(applyCellFormat, {\n                style: style, rowIdx: rIdx, colIdx: cIdx,\n                lastCell: true, isHeightCheckNeeded: true, manualUpdate: true\n            });\n        }\n        else {\n            if (isActiveCF) {\n                for (var idx = 0; idx < cFColors.length; idx++) {\n                    if (td.classList.contains(cFColors[idx])) {\n                        td.classList.remove(cFColors[idx]);\n                        break;\n                    }\n                }\n                td.removeAttribute('style');\n            }\n            var cell = getCell(rIdx, cIdx, this.parent.getActiveSheet());\n            var style = cell.style ? cell.style : {};\n            this.parent.notify(applyCellFormat, {\n                style: style, rowIdx: rIdx, colIdx: cIdx\n            });\n        }\n    };\n    ConditionalFormatting.prototype.hexToRgb = function (hex) {\n        var result = /^#?([a-f\\d]{2})([a-f\\d]{2})([a-f\\d]{2})$/i.exec(hex);\n        return result ? {\n            r: parseInt(result[1], 16),\n            g: parseInt(result[2], 16),\n            b: parseInt(result[3], 16)\n        } : null;\n    };\n    // tslint:disable-next-line:max-func-body-length\n    ConditionalFormatting.prototype.cFRCheck = function (cFRule, value, td, rIdx, cIdx, isInitial) {\n        var cFRuleValue1 = '';\n        var cFRuleValue2 = '';\n        var cellValue = value.toString();\n        if (cFRule.value) {\n            var valueArr = cFRule.value.split(',');\n            if (valueArr.length > 1) {\n                if (valueArr[0].split('(').length > 1) {\n                    var valueStr = '';\n                    for (var idx = 0; idx < valueArr.length; idx++) {\n                        valueStr += valueArr[idx] + ',';\n                        if (valueStr.split('(').length === valueStr.split(')').length && cFRuleValue1 === '') {\n                            cFRuleValue1 = valueStr.substring(0, valueStr.length - 1);\n                            valueStr = '';\n                        }\n                    }\n                    cFRuleValue2 = valueStr.substring(0, valueStr.length - 1);\n                }\n                else {\n                    cFRuleValue1 = valueArr[0];\n                    for (var idx = 1; idx < valueArr.length; idx++) {\n                        cFRuleValue2 += idx + 1 === valueArr.length ? valueArr[idx] : valueArr[idx] + ',';\n                    }\n                }\n            }\n            else {\n                cFRuleValue1 = cFRule.value;\n            }\n        }\n        var isApply = false;\n        var type = cFRule.type;\n        if (('BlueDataBar' + 'GreenDataBar' + 'RedDataBar' + 'OrangeDataBar' + 'LightBlueDataBar' + 'PurpleDataBar').includes(type)) {\n            type = 'DataBar';\n        }\n        if (('GYRColorScale' + 'RYGColorScale' + 'GWRColorScale' + 'RWGColorScale' + 'BWRColorScale' + 'RWBColorScale' + 'WRColorScale' +\n            'RWColorScale' + 'GWColorScale' + 'WGColorScale' + 'GYColorScale' + 'YGColorScale').includes(type)) {\n            type = 'ColorScale';\n        }\n        if (('ThreeArrows' + 'ThreeArrowsGray' + 'FourArrowsGray' + 'FourArrows' + 'FiveArrowsGray' +\n            'FiveArrows' + 'ThreeTrafficLights1' + 'ThreeTrafficLights2' + 'ThreeSigns' + 'FourTrafficLights' +\n            'FourRedToBlack' + 'ThreeSymbols' + 'ThreeSymbols2' + 'ThreeFlags' + 'FourRating' + 'FiveQuarters' +\n            'FiveRating' + 'ThreeTriangles' + 'ThreeStars' + 'FiveBoxes').includes(type)) {\n            type = 'IconSet';\n        }\n        switch (type) {\n            case 'GreaterThan':\n                isApply = this.isGreaterThanLessThan(cFRule, cellValue, cFRuleValue1, true);\n                break;\n            case 'LessThan':\n                isApply = this.isGreaterThanLessThan(cFRule, cellValue, cFRuleValue1, false);\n                break;\n            case 'Between':\n                isApply = this.isBetWeen(cFRule, cellValue, cFRuleValue1, cFRuleValue2);\n                break;\n            case 'EqualTo':\n                isApply = this.isEqualTo(cFRule, cellValue, cFRuleValue1);\n                break;\n            case 'ContainsText':\n                isApply = this.isContainsText(cellValue, cFRuleValue1);\n                break;\n            case 'DateOccur':\n                var dateEventArgs = {\n                    value: cFRuleValue1,\n                    rowIndex: 0,\n                    colIndex: 0,\n                    sheetIndex: 0,\n                    updatedVal: ''\n                };\n                this.parent.notify(checkDateFormat, dateEventArgs);\n                if (cellValue === dateEventArgs.updatedVal) {\n                    isApply = true;\n                }\n                break;\n            case 'Unique':\n            case 'Duplicate':\n                isApply = this.isDuplicateUnique(cellValue, cFRule, false);\n                break;\n            case 'Top10Items':\n                isApply = this.isTopBottomTenValue(cellValue, cFRuleValue1, cFRule, true);\n                break;\n            case 'Bottom10Items':\n                isApply = this.isTopBottomTenValue(cellValue, cFRuleValue1, cFRule, false);\n                break;\n            case 'Top10Percentage':\n                isApply = this.isTopBottomTenPercentage(cellValue, cFRuleValue1, cFRule, true);\n                break;\n            case 'Bottom10Percentage':\n                isApply = this.isTopBottomTenPercentage(cellValue, cFRuleValue1, cFRule, false);\n                break;\n            case 'AboveAverage':\n                isApply = this.isAboveBelowAverage(cellValue, cFRuleValue1, cFRule, true);\n                break;\n            case 'BelowAverage':\n                isApply = this.isAboveBelowAverage(cellValue, cFRuleValue1, cFRule, false);\n                break;\n            case 'DataBar':\n                this.isDataBarColorScalesIconSets(type, cellValue, cFRule, td, rIdx, cIdx, isInitial);\n                break;\n            case 'ColorScale':\n                this.isDataBarColorScalesIconSets(type, cellValue, cFRule, td, rIdx, cIdx, isInitial);\n                break;\n            case 'IconSet':\n                this.isDataBarColorScalesIconSets(type, cellValue, cFRule, td, rIdx, cIdx, isInitial);\n                break;\n        }\n        return isApply;\n    };\n    ConditionalFormatting.prototype.isDataBarColorScalesIconSets = function (type, cellValue, cFRule, td, rIdx, cIdx, isInitial) {\n        var sheet = this.parent.getActiveSheet();\n        if (isInitial) {\n            type === 'DataBar' ? this.applyDataBars(cellValue, cFRule, td, rIdx, cIdx) : type === 'ColorScale' ?\n                this.applyColorScale(cellValue, cFRule, td, rIdx, cIdx, isInitial) :\n                this.applyIconSet(cellValue, cFRule, td, rIdx, cIdx, isInitial);\n        }\n        else {\n            td = null;\n            var rangeArr = cFRule.range.split(',');\n            for (var rangeIdx = 0; rangeIdx < rangeArr.length; rangeIdx++) {\n                var selIndexes = getRangeIndexes(rangeArr[rangeIdx]);\n                for (var rIdx_1 = selIndexes[0]; rIdx_1 <= selIndexes[2]; rIdx_1++) {\n                    for (var cIdx_1 = selIndexes[1]; cIdx_1 <= selIndexes[3]; cIdx_1++) {\n                        if (getCell(rIdx_1, cIdx_1, sheet)) {\n                            var cellVal = getCell(rIdx_1, cIdx_1, sheet).value;\n                            td = this.parent.getCell(rIdx_1, cIdx_1);\n                            type === 'DataBar' ? this.applyDataBars(cellVal, cFRule, td, rIdx_1, cIdx_1) :\n                                type === 'ColorScale' ?\n                                    this.applyColorScale(cellVal, cFRule, td, rIdx_1, cIdx_1, isInitial) :\n                                    this.applyIconSet(cellVal, cFRule, td, rIdx_1, cIdx_1, isInitial);\n                        }\n                    }\n                }\n            }\n        }\n    };\n    ConditionalFormatting.prototype.applyIconSet = function (val, cFRule, tdEle, rIdx, cIdx, isInitial) {\n        var value = parseInt(val, 10);\n        var rowIdx;\n        var colIdx;\n        var iconList = this.getIconList(cFRule.type).split(',');\n        var min;\n        var max;\n        var valArr = [];\n        var sheet = this.parent.getActiveSheet();\n        var actCell = sheet.rows[rIdx] && sheet.rows[rIdx].cells[cIdx] ? sheet.rows[rIdx].cells[cIdx] : null;\n        if (!actCell) {\n            return;\n        }\n        var td = tdEle ||\n            this.parent.getMainContent().getElementsByClassName('e-row')[rIdx].getElementsByClassName('e-cell')[cIdx];\n        var rangeArr = cFRule.range.split(',');\n        for (var rIdx_2 = 0; rIdx_2 < rangeArr.length; rIdx_2++) {\n            var selIndexes = getRangeIndexes(rangeArr[rIdx_2]);\n            valArr = this.getNumericArray(selIndexes, valArr);\n        }\n        valArr = valArr.sort(function (n1, n2) { return n1 - n2; });\n        min = valArr[0];\n        max = valArr[valArr.length - 1];\n        var currentSymbol;\n        if (iconList.length === 3) {\n            var maxPercent = min + (0.67 * ((max) - (min)));\n            var minPercent = min + (0.33 * ((max) - (min)));\n            currentSymbol =\n                'e-' + (value >= maxPercent ? iconList[0].trim() : value >= minPercent ? iconList[1].trim() : iconList[2].trim());\n        }\n        else if (iconList.length === 4) {\n            var percent1 = min + (0.25 * ((max) - (min)));\n            var percent2 = min + (0.50 * ((max) - (min)));\n            var percent3 = min + (0.75 * ((max) - (min)));\n            currentSymbol =\n                'e-' + (value >= percent3 ? iconList[0].trim() : value >= percent2 ? iconList[1].trim() : value >= percent1 ?\n                    iconList[2].trim() : iconList[3].trim());\n        }\n        else if (iconList.length === 5) {\n            var percent1 = min + (0.20 * ((max) - (min)));\n            var percent2 = min + (0.40 * ((max) - (min)));\n            var percent3 = min + (0.60 * ((max) - (min)));\n            var percent4 = min + (0.80 * ((max) - (min)));\n            currentSymbol =\n                'e-' + (value >= percent4 ? iconList[0].trim() : value >= percent3 ? iconList[1].trim() : value >= percent2 ?\n                    iconList[2].trim() : value >= percent1 ? iconList[3].trim() : iconList[4].trim());\n        }\n        if (!isNullOrUndefined(actCell)) {\n            var cfIcon = this.parent.createElement('span', { className: 'e-icon' });\n            cfIcon.classList.add('e-iconsetspan');\n            cfIcon.classList.add(currentSymbol);\n            this.applyIconSetIcon({ rowIndex: rIdx, colIndex: cIdx }, cfIcon, td);\n        }\n    };\n    ConditionalFormatting.prototype.applyIconSetIcon = function (activeObj, cfIcon, td) {\n        var sheet = this.parent.getActiveSheet();\n        var rowIdx = activeObj.rowIndex;\n        var colIdx = activeObj.colIndex;\n        var cellVal = getCell(rowIdx, colIdx, sheet).value;\n        var activeEle = td;\n        var sheetIdx = sheet.index;\n        if (activeEle.classList.contains('e-iconset') && activeEle.querySelector('.e-iconsetspan')) {\n            activeEle.removeChild(activeEle.querySelector('.e-iconsetspan'));\n        }\n        if (isNumber(cellVal)) {\n            activeEle.insertBefore(cfIcon, activeEle.childNodes[0]);\n            activeEle.classList.add('e-iconset');\n        }\n    };\n    ConditionalFormatting.prototype.getIconList = function (iconName) {\n        var result = '3arrows-1,3arrows-2,3arrows-3';\n        switch (iconName) {\n            case 'ThreeArrows':\n                return '3arrows-1,3arrows-2,3arrows-3';\n            case 'ThreeArrowsGray':\n                return '3arrowsgray-1,3arrowsgray-2,3arrowsgray-3';\n            case 'FourArrowsGray':\n                return '4arrowsgray-1,4arrowsgray-2,4arrowsgray-3,4arrowsgray-4';\n            case 'FourArrows':\n                return '4arrows-1,4arrows-2,4arrows-3,4arrows-4';\n            case 'FiveArrowsGray':\n                return '5arrowsgray-1,5arrowsgray-2,5arrowsgray-3,5arrowsgray-4,5arrowsgray-5';\n            case 'FiveArrows':\n                return '5arrows-1,5arrows-2,5arrows-3,5arrows-4,5arrows-5';\n            case 'ThreeTrafficLights1':\n                return '3trafficlights-1,3trafficlights-2,3trafficlights-3';\n            case 'ThreeTrafficLights2':\n                return '3rafficlights2-1,3rafficlights2-2,3rafficlights2-3';\n            case 'ThreeSigns':\n                return '3signs-1,3signs-2,3signs-3';\n            case 'FourTrafficLights':\n                return '4trafficlights-1,4trafficlights-2,4trafficlights-3,4trafficlights-4';\n            case 'FourRedToBlack':\n                return '4redtoblack-1,4redtoblack-2,4redtoblack-3,4redtoblack-4';\n            case 'ThreeSymbols':\n                return '3symbols-1,3symbols-2,3symbols-3';\n            case 'ThreeSymbols2':\n                return '3symbols2-1,3symbols2-2,3symbols2-3';\n            case 'ThreeFlags':\n                return '3flags-1,3flags-2,3flags-3';\n            case 'FourRating':\n                return '4rating-1,4rating-2,4rating-3,4rating-4';\n            case 'FiveQuarters':\n                return '5quarters-1,5quarters-2,5quarters-3,5quarters-4,5quarters-5';\n            case 'FiveRating':\n                return '5rating-1,5rating-2,5rating-3,5rating-4,5rating-5';\n            case 'ThreeTriangles':\n                return '3triangles-1,3triangles-2,3triangles-3';\n            case 'ThreeStars':\n                return '3stars-1,3stars-2,3stars-3';\n            case 'FiveBoxes':\n                return '5boxes-1,5boxes-2,5boxes-3,5boxes-4,5boxes-5';\n        }\n        return result;\n    };\n    ConditionalFormatting.prototype.applyColorScale = function (val, cFRule, tdEle, rIdx, cIdx, isInitial) {\n        var sheet = this.parent.getActiveSheet();\n        var value = parseInt(val, 10);\n        var rowIdx;\n        var colIdx;\n        var id;\n        var valArr = [];\n        var colors = this.getColor(cFRule.type);\n        var actCell = sheet.rows[rIdx] && sheet.rows[rIdx].cells[cIdx] ? sheet.rows[rIdx].cells[cIdx] : null;\n        if (!actCell) {\n            return;\n        }\n        var rangeArr = cFRule.range.split(',');\n        var td = tdEle ||\n            this.parent.getMainContent().getElementsByClassName('e-row')[rIdx].getElementsByClassName('e-cell')[cIdx];\n        for (var rIdx_3 = 0; rIdx_3 < rangeArr.length; rIdx_3++) {\n            var selIndexes = getRangeIndexes(rangeArr[rIdx_3]);\n            valArr = this.getNumericArray(selIndexes, valArr);\n        }\n        valArr = valArr.sort(function (n1, n2) { return n1 - n2; }).reverse();\n        for (var i = 0; i < valArr.length; i++) {\n            if (valArr[i] === value) {\n                id = i;\n                break;\n            }\n        }\n        var hexcode = (id === 0) ? colors[0] : (id === valArr.length - 1) ? colors[colors.length - 1] :\n            (valArr.length === 3 && id === 1) ? colors[1] : this.getGradient(id, colors[0], colors[1], colors[2], valArr.length);\n        if (!isNullOrUndefined(actCell)) {\n            var style = {};\n            if (!isNullOrUndefined(id)) {\n                style = { backgroundColor: hexcode };\n                td.style.backgroundColor = hexcode;\n            }\n            else {\n                style = this.parent.getCellStyleValue(['backgroundColor'], [rIdx, cIdx]);\n                td.style.backgroundColor = style.backgroundColor;\n            }\n        }\n    };\n    // tslint:disable-next-line:max-func-body-length\n    ConditionalFormatting.prototype.applyDataBars = function (val, cFRule, tdEle, rIdx, cIdx) {\n        var value;\n        var rowIdx;\n        var colIdx;\n        var sheet = this.parent.getActiveSheet();\n        var left = {};\n        var right = {};\n        var posColor = '';\n        var negColor = '';\n        var cFColor = cFRule.type;\n        var actCell = sheet.rows[rIdx] && sheet.rows[rIdx].cells[cIdx] ? sheet.rows[rIdx].cells[cIdx] : null;\n        if (!actCell) {\n            return;\n        }\n        var valArr = [];\n        var row = this.parent.getMainContent().getElementsByClassName('e-row')[rIdx];\n        var td = tdEle ||\n            this.parent.getMainContent().getElementsByClassName('e-row')[rIdx].getElementsByClassName('e-cell')[cIdx];\n        var rowHeight = !row ? 20 : row.style ? parseInt(row.style.height, 10) : 20;\n        var posArr = [];\n        var negArr = [];\n        var topVal;\n        var leftStandardWidth = 0;\n        value = parseInt(val, 10);\n        var rangeArr = cFRule.range.split(',');\n        for (var rIdx_4 = 0; rIdx_4 < rangeArr.length; rIdx_4++) {\n            var selIndexes = getRangeIndexes(rangeArr[rIdx_4]);\n            valArr = this.getNumericArray(selIndexes, valArr);\n        }\n        for (var idx = 0; idx < valArr.length; idx++) {\n            valArr[idx] > 0 ? posArr.push(valArr[idx]) : negArr.push(valArr[idx]);\n        }\n        cFColor = cFColor === 'BlueDataBar' ? 'B' : cFColor === 'GreenDataBar' ? 'G' : cFColor === 'RedDataBar' ? 'R' :\n            cFColor === 'OrangeDataBar' ? 'O' : cFColor === 'LightBlueDataBar' ? 'LB' : cFColor === 'PurpleDataBar' ? 'P' : '';\n        posColor = this.getColor(cFColor)[0];\n        negColor = this.getColor('R')[0];\n        posArr = posArr.sort(function (n1, n2) { return n1 - n2; }).reverse();\n        negArr = negArr.sort(function (n1, n2) { return n1 - n2; });\n        if (negArr.length && posArr.length) {\n            topVal = posArr[0] + Math.abs(negArr[0]);\n            leftStandardWidth = (Math.abs((negArr[0] / topVal) * 100));\n        }\n        else if (negArr.length || posArr.length) {\n            topVal = negArr.length ? negArr[0] : posArr[0];\n        }\n        else {\n            return;\n        }\n        if (td) {\n            if (isNullOrUndefined(value) || val === '') {\n                if (td.getElementsByClassName('e-cf-databar')[0]) {\n                    td.removeChild(td.getElementsByClassName('e-cf-databar')[0]);\n                }\n            }\n        }\n        if (isNumber(value)) {\n            var databar = this.parent.createElement('div', { id: 'spreadsheet-databar', className: 'e-cf-databar' });\n            var leftSpan = this.parent.createElement('span', { id: 'spreadsheet-leftspan', className: 'e-databar' });\n            var rightSpan = this.parent.createElement('span', { id: 'spreadsheet-rightspan', className: 'e-databar' });\n            var dataSpan = this.parent.createElement('span', { id: 'spreadsheet-dataspan', className: 'e-databar-value' });\n            var iconSetSpan = void 0;\n            left = leftSpan.style;\n            right = rightSpan.style;\n            databar.appendChild(dataSpan);\n            databar.insertBefore(rightSpan, dataSpan);\n            databar.insertBefore(leftSpan, rightSpan);\n            if (td.querySelector('.e-iconsetspan')) {\n                iconSetSpan = td.querySelector('.e-iconsetspan');\n            }\n            td.textContent = '';\n            td.appendChild(databar);\n            if (iconSetSpan) {\n                td.insertBefore(iconSetSpan, td.firstElementChild);\n            }\n            dataSpan.innerHTML = this.parent.getDisplayText(actCell);\n            databar.style.height = rowHeight - 1 + 'px';\n            dataSpan.style.fontSize = '11pt';\n            if (!negArr.length) {\n                right.width = '' + Math.ceil(Math.abs((value / topVal) * 100)) + '%';\n                right.height = rowHeight - 3 + 'px';\n                right.backgroundColor = cFColor = posColor;\n                right.left = '0px';\n            }\n            else if (!posArr.length) {\n                right.width = '' + Math.ceil(Math.abs((value / topVal) * 100)) + '%';\n                right.height = rowHeight - 3 + 'px';\n                right.backgroundColor = cFColor = negColor;\n                right.left = '0px';\n            }\n            else {\n                if (value > -1) {\n                    left.width = leftStandardWidth + '%';\n                    left.height = rowHeight - 3 + 'px'; // -3 buffer of data bar.\n                    left.backgroundColor = 'transparent';\n                    left.left = '0px';\n                    right.width = '' + Math.ceil(Math.abs((value / topVal) * 100)) + '%';\n                    right.height = rowHeight - 3 + 'px';\n                    right.backgroundColor = cFColor = posColor;\n                    right.left = leftStandardWidth + '%';\n                }\n                else if (value < 0) {\n                    left.width = '' + Math.ceil(Math.abs((value / topVal) * 100)) + '%';\n                    left.height = rowHeight - 3 + 'px';\n                    left.backgroundColor = negColor;\n                    if (left.width === leftStandardWidth + '%') {\n                        left.left = '0px';\n                    }\n                    else {\n                        left.right = (100 - leftStandardWidth) + '%';\n                    }\n                }\n            }\n        }\n    };\n    ConditionalFormatting.prototype.getNumericArray = function (selIndexes, valArr) {\n        var sheet = this.parent.getActiveSheet();\n        for (var rIdx = selIndexes[0]; rIdx <= selIndexes[2]; rIdx++) {\n            for (var cIdx = selIndexes[1]; cIdx <= selIndexes[3]; cIdx++) {\n                var cellVal = getCell(rIdx, cIdx, sheet) && getCell(rIdx, cIdx, sheet).value ? getCell(rIdx, cIdx, sheet).value : '';\n                if (!isNullOrUndefined(cellVal) && !isNumber(cellVal) && !isDateTime(cellVal)) {\n                    continue;\n                }\n                else {\n                    var cellValue = parseInt(cellVal, 10);\n                    if (!isNullOrUndefined(cellVal) && cellVal !== '') {\n                        valArr.push(cellValue);\n                    }\n                }\n            }\n        }\n        return valArr;\n    };\n    ConditionalFormatting.prototype.getColor = function (cfColor) {\n        if (cfColor === 'LB') {\n            return ['#008aef'];\n        }\n        var colorCodeArr = cfColor.split('');\n        var colorArr = [];\n        for (var i = 0; i < colorCodeArr.length; i++) {\n            switch (colorCodeArr[i]) {\n                case 'G':\n                    colorArr.push('#63be7b');\n                    break;\n                case 'Y':\n                    colorArr.push('#ffeb84');\n                    break;\n                case 'R':\n                    colorArr.push('#f8696b');\n                    break;\n                case 'W':\n                    colorArr.push('#ffffff');\n                    break;\n                case 'B':\n                    colorArr.push('#5a8ac6');\n                    break;\n                case 'O':\n                    colorArr.push('#ffb628');\n                    break;\n                case 'LB':\n                    colorArr.push('#008aef');\n                    break;\n                case 'P':\n                    colorArr.push('#d6007b');\n                    break;\n            }\n        }\n        return colorArr;\n    };\n    ConditionalFormatting.prototype.getGradient = function (t, start, middle, end, large) {\n        if (isNullOrUndefined(end)) {\n            return this.getLinear(start, middle, t / large);\n        }\n        else {\n            var center = large / 2;\n            return t >= center ? this.getLinear(middle, end, Math.abs((t - center) / center)) : this.getLinear(start, middle, t / center);\n        }\n    };\n    ConditionalFormatting.prototype.getLinear = function (s, e, x) {\n        var r = this.byteLinear(s[1] + s[2], e[1] + e[2], x);\n        var g = this.byteLinear(s[3] + s[4], e[3] + e[4], x);\n        var b = this.byteLinear(s[5] + s[6], e[5] + e[6], x);\n        return '#' + r + g + b;\n    };\n    ConditionalFormatting.prototype.byteLinear = function (a, b, x) {\n        var y = (parseInt(a, 16) * (1 - x) + parseInt(b, 16) * x) | 0;\n        return Math.abs(y).toString(16);\n    };\n    ConditionalFormatting.prototype.isGreaterThanLessThan = function (cFRule, value, input, isGrearThan) {\n        var numRegx = new RegExp(/[^.0-9]+/g);\n        var txtRegx = new RegExp(/[^.-a-zA-Z 0-9]+/g);\n        var isApply = false;\n        if (isNumber(value)) {\n            if (isNumber(input)) {\n                isApply = isGrearThan ? parseFloat(value) > parseFloat(input.replace(txtRegx, '')) :\n                    parseFloat(value) < parseFloat(input.replace(txtRegx, ''));\n            }\n            else {\n                var dateEventArgs = {\n                    value: input,\n                    rowIndex: 0,\n                    colIndex: 0,\n                    sheetIndex: 0,\n                    isDate: false,\n                    updatedVal: '',\n                    isTime: false\n                };\n                this.parent.notify(checkDateFormat, dateEventArgs);\n                if (dateEventArgs.isDate || dateEventArgs.isTime) {\n                    isApply = isGrearThan ? value > dateEventArgs.updatedVal : value < dateEventArgs.updatedVal;\n                    cFRule.value = dateEventArgs.updatedVal.toString();\n                }\n                else {\n                    isApply = isGrearThan ? value.toLowerCase() > input.toLowerCase() : value.toLowerCase() < input.toLowerCase();\n                }\n            }\n        }\n        else if (value === '' && !isGrearThan) {\n            isApply = true;\n        }\n        return isApply;\n    };\n    ConditionalFormatting.prototype.isBetWeen = function (cFRule, value, input1, input2) {\n        var numRegx = new RegExp(/[^.0-9]+/g);\n        var txtRegx = new RegExp(/[^.-a-zA-Z 0-9]+/g);\n        var isApply = false;\n        input1 = input1.replace(txtRegx, '');\n        input2 = input2.replace(txtRegx, '');\n        if (isNumber(value)) {\n            if (isNumber(input1)) {\n                isApply = parseFloat(value) >= parseFloat(input1) && parseFloat(value) <= parseFloat(input2);\n            }\n            else {\n                if (input1 && input2) {\n                    var dateEventArgs1 = {\n                        value: input1,\n                        rowIndex: 0,\n                        colIndex: 0,\n                        sheetIndex: 0,\n                        isDate: false,\n                        updatedVal: '',\n                        isTime: false\n                    };\n                    var dateEventArgs2 = {\n                        value: input2,\n                        rowIndex: 0,\n                        colIndex: 0,\n                        sheetIndex: 0,\n                        isDate: false,\n                        updatedVal: '',\n                        isTime: false\n                    };\n                    this.parent.notify(checkDateFormat, dateEventArgs1);\n                    this.parent.notify(checkDateFormat, dateEventArgs2);\n                    if ((dateEventArgs1.isDate || dateEventArgs1.isTime) && (dateEventArgs2.isDate || dateEventArgs2.isTime)) {\n                        isApply = value >= dateEventArgs1.updatedVal && value <= dateEventArgs2.updatedVal;\n                        cFRule.value = dateEventArgs1.updatedVal.toString() + ',' + dateEventArgs2.updatedVal.toString();\n                    }\n                    else {\n                        isApply = value.toLowerCase() >= input1.toLowerCase() && value.toLowerCase() <= input2.toLowerCase();\n                    }\n                }\n            }\n        }\n        return isApply;\n    };\n    ConditionalFormatting.prototype.isEqualTo = function (cFRule, value, input) {\n        var numRegx = new RegExp(/[^.0-9]+/g);\n        var txtRegx = new RegExp(/[^.-a-zA-Z 0-9]+/g);\n        var isApply = false;\n        if (isNumber(value)) {\n            if (isNumber(input)) {\n                isApply = parseFloat(value) === parseFloat(input.replace(txtRegx, ''));\n            }\n            else {\n                var dateTimeArgs = {\n                    value: input,\n                    rowIndex: 0,\n                    colIndex: 0,\n                    sheetIndex: 0,\n                    isDate: false,\n                    updatedVal: '',\n                    isTime: false\n                };\n                this.parent.notify(checkDateFormat, dateTimeArgs);\n                if (dateTimeArgs.isTime || dateTimeArgs.isDate) {\n                    isApply = value === dateTimeArgs.updatedVal;\n                    cFRule.value = dateTimeArgs.updatedVal.toString();\n                }\n                else {\n                    isApply = value.toLowerCase() === input.toLowerCase();\n                }\n            }\n        }\n        return isApply;\n    };\n    ConditionalFormatting.prototype.isContainsText = function (value, input) {\n        var numRegx = new RegExp(/[^.0-9]+/g);\n        var txtRegx = new RegExp(/[^.-a-zA-Z 0-9]+/g);\n        var isApply = false;\n        if (isNullOrUndefined(value) || !value.length) {\n            isApply = false;\n        }\n        else if (isNumber(input.replace(txtRegx, ''))) {\n            input = input.replace(txtRegx, '');\n            if (isDateTime(value)) {\n                value = ((dateToInt(value))).toString();\n            }\n            isApply = value.indexOf(input) > -1;\n        }\n        else if (isDateTime(input)) {\n            if (isDateTime(value)) {\n                value = dateToInt(value).toString();\n            }\n            isApply = value.indexOf(dateToInt(input).toString()) > -1;\n        }\n        else {\n            isApply = value.toLowerCase().indexOf(input.toLowerCase()) > -1;\n        }\n        return isApply;\n    };\n    ConditionalFormatting.prototype.isTopBottomTenValue = function (cellValue, inp, cFRule, isTop) {\n        var sheet = this.parent.getActiveSheet();\n        var numRegx = new RegExp(/[^.0-9]+/g);\n        var txtRegx = new RegExp(/[^.-a-zA-Z 0-9]+/g);\n        var value = parseInt(cellValue, 10);\n        var input = parseInt(inp, 10);\n        var result = false;\n        if (isNumber(inp)) {\n            if (isNumber(cellValue)) {\n                value = parseFloat(cellValue);\n                input = parseFloat(inp.replace(txtRegx, ''));\n            }\n            else if (isDateTime(cellValue)) {\n                value = dateToInt(cellValue);\n                input = parseFloat(inp);\n            }\n            var dataArray = [];\n            var cellVal = void 0;\n            var rangeArr = cFRule.range.split(',');\n            for (var rangeIdx = 0; rangeIdx < rangeArr.length; rangeIdx++) {\n                var cFRuleIndexes = getRangeIndexes(rangeArr[rangeIdx]);\n                for (var rowIdx = cFRuleIndexes[0]; rowIdx <= cFRuleIndexes[2]; rowIdx++) {\n                    for (var colIdx = cFRuleIndexes[1]; colIdx <= cFRuleIndexes[3]; colIdx++) {\n                        cellVal = getCell(rowIdx, colIdx, sheet) && getCell(rowIdx, colIdx, sheet).value ?\n                            getCell(rowIdx, colIdx, sheet).value : '';\n                        if (cellVal && isNumber(cellVal)) {\n                            cellVal = parseFloat(cellVal);\n                            dataArray.push(cellVal);\n                        }\n                    }\n                }\n            }\n            dataArray =\n                isTop ? dataArray.sort(function (n1, n2) { return n1 - n2; }).reverse() : dataArray.sort(function (n1, n2) { return n1 - n2; });\n            dataArray = dataArray.slice(0, input);\n            result = (dataArray.indexOf(value) > -1);\n        }\n        return result;\n    };\n    ConditionalFormatting.prototype.isTopBottomTenPercentage = function (val, inp, cFRule, isTop) {\n        var sheet = this.parent.getActiveSheet();\n        var numRegx = new RegExp(/[^.0-9]+/g);\n        var txtRegx = new RegExp(/[^.-a-zA-Z 0-9]+/g);\n        var value = parseInt(val, 10);\n        var input = parseInt(inp, 10);\n        var result = false;\n        if (isNumber(inp)) {\n            if (isNumber(val)) {\n                value = parseFloat(val);\n                input = parseFloat(inp.replace(txtRegx, ''));\n            }\n            else if (isDateTime(val)) {\n                value = dateToInt(val);\n                input = parseFloat(inp);\n            }\n            var dataArr = [];\n            var cellVal = void 0;\n            var diff = void 0;\n            var count = 0;\n            var considerCount = void 0;\n            var rangeArr = cFRule.range.split(',');\n            for (var rangeIdx = 0; rangeIdx < rangeArr.length; rangeIdx++) {\n                var cFRuleIndexes = getRangeIndexes(rangeArr[rangeIdx]);\n                for (var rIdx = cFRuleIndexes[0]; rIdx <= cFRuleIndexes[2]; rIdx++) {\n                    for (var cIdx = cFRuleIndexes[1]; cIdx <= cFRuleIndexes[3]; cIdx++) {\n                        cellVal = getCell(rIdx, cIdx, sheet) && getCell(rIdx, cIdx, sheet).value ? getCell(rIdx, cIdx, sheet).value : '';\n                        if (cellVal && isNumber(cellVal)) {\n                            cellVal = parseFloat(cellVal);\n                            dataArr.push(cellVal);\n                        }\n                        count++;\n                    }\n                }\n            }\n            diff = 100 / count;\n            considerCount = input / diff;\n            considerCount = Math.ceil(considerCount);\n            dataArr =\n                isTop ? dataArr.sort(function (n1, n2) { return n1 - n2; }).reverse() : dataArr.sort(function (n1, n2) { return n1 - n2; });\n            dataArr = dataArr.slice(0, considerCount ? considerCount : 1);\n            result = (dataArr.indexOf(value) > -1);\n        }\n        return result;\n    };\n    ConditionalFormatting.prototype.isAboveBelowAverage = function (val, inp, cFRule, isAbove) {\n        var sheet = this.parent.getActiveSheet();\n        var value = parseFloat(val);\n        var rangeColl = cFRule.range.split(',');\n        var result = false;\n        var dataArr = [];\n        var cellValue;\n        var average = 0;\n        for (var rangeIdx = 0; rangeIdx < rangeColl.length; rangeIdx++) {\n            var cFRuleIndexes = getRangeIndexes(rangeColl[rangeIdx]);\n            for (var rIdx = cFRuleIndexes[0]; rIdx <= cFRuleIndexes[2]; rIdx++) {\n                for (var cIdx = cFRuleIndexes[1]; cIdx <= cFRuleIndexes[3]; cIdx++) {\n                    cellValue = getCell(rIdx, cIdx, sheet) && getCell(rIdx, cIdx, sheet).value ? getCell(rIdx, cIdx, sheet).value : '';\n                    if (cellValue && isNumber(cellValue)) {\n                        cellValue = parseFloat(cellValue);\n                        dataArr.push(cellValue);\n                    }\n                }\n            }\n        }\n        for (var idx = 0; idx < dataArr.length; idx++) {\n            average += dataArr[idx];\n        }\n        average = average / dataArr.length;\n        result = isAbove ? (value > average) : (value < average);\n        return result;\n    };\n    ConditionalFormatting.prototype.isDuplicateUnique = function (val, cFRule, isAbove) {\n        var type = cFRule.type;\n        var count = 0;\n        var sheet = this.parent.getActiveSheet();\n        var value = val;\n        var rangeColl = cFRule.range.split(',');\n        var cellValue;\n        if (isNullOrUndefined(value) || value === '') {\n            return false;\n        }\n        for (var rIdx = 0; rIdx < rangeColl.length; rIdx++) {\n            var cFRuleIndexes = getRangeIndexes(rangeColl[rIdx]);\n            for (var rowIdx = cFRuleIndexes[0]; rowIdx <= cFRuleIndexes[2]; rowIdx++) {\n                for (var colIdx = cFRuleIndexes[1]; colIdx <= cFRuleIndexes[3]; colIdx++) {\n                    cellValue = getCell(rowIdx, colIdx, sheet) && getCell(rowIdx, colIdx, sheet).value ?\n                        getCell(rowIdx, colIdx, sheet).value.toString() : '';\n                    if (cellValue && cellValue !== '') {\n                        count = value.toLowerCase() === cellValue.toLowerCase() ? count + 1 : count;\n                        if (count === 2) {\n                            return type === 'Duplicate' ? true : false;\n                        }\n                    }\n                }\n            }\n        }\n        return type === 'Duplicate' ? false : true;\n    };\n    ConditionalFormatting.prototype.setFormat = function (style, cFRule) {\n        switch (cFRule.cFColor) {\n            case 'RedFT':\n                style.backgroundColor = '#ffc7ce';\n                style.color = '#9c0055';\n                break;\n            case 'YellowFT':\n                style.backgroundColor = '#ffeb9c';\n                style.color = '#9c6500';\n                break;\n            case 'GreenFT':\n                style.backgroundColor = '#c6efce';\n                style.color = '#006100';\n                break;\n            case 'RedF':\n                style.backgroundColor = '#ffc7ce';\n                break;\n            case 'RedT':\n                style.color = '#9c0055';\n                break;\n        }\n        return style;\n    };\n    /**\n     * Gets the module name.\n     * @returns string\n     */\n    ConditionalFormatting.prototype.getModuleName = function () {\n        return 'conditionalFormatting';\n    };\n    return ConditionalFormatting;\n}());\nexport { ConditionalFormatting };\n","var __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    }\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nvar __assign = (this && this.__assign) || function () {\n    __assign = Object.assign || function(t) {\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\n            s = arguments[i];\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\n                t[p] = s[p];\n        }\n        return t;\n    };\n    return __assign.apply(this, arguments);\n};\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nimport { Component, Property, NotifyPropertyChanges, Event, ChildProperty } from '@syncfusion/ej2-base';\nimport { getComponent, closest, EventHandler, getUniqueID, isNullOrUndefined } from '@syncfusion/ej2-base';\nimport { Collection, Complex } from '@syncfusion/ej2-base';\nimport { Tab, Toolbar } from '@syncfusion/ej2-navigations';\nimport { Menu, Item, MenuItem } from '@syncfusion/ej2-navigations';\n/**\n * Objects used for configuring the Ribbon tab header properties.\n */\nvar RibbonHeader = /** @class */ (function (_super) {\n    __extends(RibbonHeader, _super);\n    function RibbonHeader() {\n        return _super !== null && _super.apply(this, arguments) || this;\n    }\n    __decorate([\n        Property('')\n    ], RibbonHeader.prototype, \"text\", void 0);\n    __decorate([\n        Property('')\n    ], RibbonHeader.prototype, \"iconCss\", void 0);\n    __decorate([\n        Property('left')\n    ], RibbonHeader.prototype, \"iconPosition\", void 0);\n    return RibbonHeader;\n}(ChildProperty));\nexport { RibbonHeader };\n/**\n * An array of object that is used to configure the Tab.\n */\nvar RibbonItem = /** @class */ (function (_super) {\n    __extends(RibbonItem, _super);\n    function RibbonItem() {\n        return _super !== null && _super.apply(this, arguments) || this;\n    }\n    __decorate([\n        Complex({}, RibbonHeader)\n    ], RibbonItem.prototype, \"header\", void 0);\n    __decorate([\n        Collection([], Item)\n    ], RibbonItem.prototype, \"content\", void 0);\n    __decorate([\n        Property('')\n    ], RibbonItem.prototype, \"cssClass\", void 0);\n    __decorate([\n        Property(false)\n    ], RibbonItem.prototype, \"disabled\", void 0);\n    return RibbonItem;\n}(ChildProperty));\nexport { RibbonItem };\n/**\n * Represents Ribbon component.\n */\nvar Ribbon = /** @class */ (function (_super) {\n    __extends(Ribbon, _super);\n    /**\n     * Constructor for creating the widget.\n     * @param  {RibbonModel} options?\n     * @param  {string|HTMLDivElement} element?\n     */\n    function Ribbon(options, element) {\n        return _super.call(this, options) || this;\n    }\n    /**\n     * For internal use only.\n     * @returns void\n     * @private\n     */\n    Ribbon.prototype.preRender = function () {\n        /** */\n    };\n    /**\n     * For internal use only.\n     * @returns void\n     * @private\n     */\n    Ribbon.prototype.render = function () {\n        if (!this.element.id) {\n            this.element.id = getUniqueID('ribbon');\n        }\n        this.renderRibbon();\n    };\n    /**\n     * Destroys the component (detaches/removes all event handlers, attributes, classes, and empties the component element).\n     * @method destroy\n     * @return {void}\n     * {% codeBlock src='spreadsheet/destroy/index.md' %}{% endcodeBlock %}\n     */\n    Ribbon.prototype.destroy = function () {\n        var expandCollapseElem = this.element.querySelector('.e-drop-icon');\n        if (expandCollapseElem) {\n            expandCollapseElem.removeEventListener('click', this.ribbonExpandCollapse.bind(this));\n        }\n        if (this.menuItems.length) {\n            var fileMenu = document.getElementById(this.element.id + \"_menu\");\n            if (fileMenu) {\n                getComponent(fileMenu, 'menu').destroy();\n            }\n        }\n        this.toolbarObj.destroy();\n        this.tabObj.destroy();\n        this.element.innerHTML = '';\n        this.toolbarObj = null;\n        this.tabObj = null;\n        _super.prototype.destroy.call(this);\n    };\n    Ribbon.prototype.getTabItems = function () {\n        var _this = this;\n        var tabItems = [];\n        if (this.menuItems.length) {\n            tabItems.push({\n                header: { text: this.initMenu(this.menuItems) },\n                content: this.toolbarObj.element,\n                cssClass: 'e-menu-tab'\n            });\n        }\n        this.items.forEach(function (item) {\n            tabItems.push({\n                header: item.header,\n                content: _this.toolbarObj.element\n            });\n        });\n        return tabItems;\n    };\n    Ribbon.prototype.initMenu = function (menuItems) {\n        var _this = this;\n        var menu = this.createElement('ul', { id: this.element.id + \"_menu\" });\n        this.element.appendChild(menu);\n        var menuObj = new Menu({\n            cssClass: 'e-file-menu',\n            items: menuItems,\n            showItemOnClick: true,\n            beforeOpen: function (args) {\n                if (args.parentItem.text === menuItems[0].text) {\n                    menuObj.showItemOnClick = false;\n                }\n                _this.trigger('beforeOpen', args);\n            },\n            select: function (args) {\n                _this.trigger('fileMenuItemSelect', args);\n            },\n            beforeClose: function (args) {\n                if (args.event.type === 'mouseover' && !closest(args.event.target, '.e-menu-popup')) {\n                    args.cancel = true;\n                    return;\n                }\n                _this.trigger('beforeClose', args);\n                if (!args.parentItem || args.parentItem.text === menuItems[0].text) {\n                    requestAnimationFrame(function () { return menuObj.setProperties({ showItemOnClick: true }, true); });\n                }\n            },\n            beforeItemRender: function (args) {\n                _this.trigger('beforeFileMenuItemRender', args);\n            }\n        });\n        menuObj.createElement = this.createElement;\n        menuObj.appendTo(menu);\n        return menu.parentElement;\n    };\n    Ribbon.prototype.renderRibbon = function () {\n        var _this = this;\n        var tabElement = this.createElement('div');\n        var tBarElement = this.createElement('div');\n        this.toolbarObj = new Toolbar({\n            items: this.items[this.selectedTab].content,\n            clicked: function (args) { return _this.trigger('clicked', args); }\n        });\n        this.toolbarObj.createElement = this.createElement;\n        this.toolbarObj.appendTo(tBarElement);\n        this.tabObj = new Tab({\n            selectedItem: this.getIndex(this.selectedTab),\n            animation: { next: { duration: 0 }, previous: { duration: 0 } },\n            items: this.getTabItems(),\n            selecting: function (args) {\n                if (_this.menuItems.length && args.selectingIndex === 0) {\n                    args.cancel = true;\n                }\n                else {\n                    if (args.selectingIndex === _this.getIndex(_this.selectedTab)) {\n                        return;\n                    }\n                    _this.updateToolbar(_this.getIndex(args.selectingIndex, true));\n                    _this.toolbarObj.dataBind();\n                    if (_this.element.classList.contains('e-collapsed')) {\n                        EventHandler.remove(args.selectedItem, 'click', _this.ribbonExpandCollapse);\n                    }\n                    var eventArgs = void 0;\n                    if (_this.menuItems.length) {\n                        eventArgs = __assign({}, args);\n                        eventArgs.selectingIndex -= 1;\n                        eventArgs.selectedIndex -= 1;\n                    }\n                    else {\n                        eventArgs = args;\n                    }\n                    _this.trigger('selecting', eventArgs);\n                }\n            },\n            selected: function (args) {\n                if (args.selectedIndex === _this.getIndex(_this.selectedTab)) {\n                    return;\n                }\n                _this.setProperties({ 'selectedTab': _this.getIndex(args.selectedIndex, true) }, true);\n                if (_this.element.classList.contains('e-collapsed')) {\n                    _this.element.classList.remove('e-collapsed');\n                    _this.trigger('expandCollapse', { element: _this.toolbarObj.element, expanded: true });\n                }\n            },\n            created: function () {\n                _this.toolbarObj.refreshOverflow();\n            }\n        });\n        this.element.appendChild(tabElement);\n        this.tabObj.createElement = this.createElement;\n        this.tabObj.appendTo(tabElement);\n        var collapseBtn = this.createElement('span', { className: 'e-drop-icon e-icons' });\n        collapseBtn.addEventListener('click', this.ribbonExpandCollapse.bind(this));\n        this.element.appendChild(collapseBtn);\n    };\n    Ribbon.prototype.ribbonExpandCollapse = function (e) {\n        var eventArgs = { element: this.toolbarObj.element, expanded: true };\n        var activeTab;\n        if (this.element.classList.contains('e-collapsed')) {\n            activeTab = this.tabObj.element.querySelector('.e-tab-header').getElementsByClassName('e-toolbar-item')[this.tabObj.selectedItem];\n            this.element.classList.remove('e-collapsed');\n            activeTab.classList.add('e-active');\n            EventHandler.remove(activeTab, 'click', this.ribbonExpandCollapse);\n            this.trigger('expandCollapse', eventArgs);\n        }\n        else {\n            activeTab = this.tabObj.element.querySelector('.e-tab-header .e-toolbar-item.e-active');\n            this.element.classList.add('e-collapsed');\n            eventArgs.expanded = false;\n            activeTab.classList.remove('e-active');\n            EventHandler.add(activeTab, 'click', this.ribbonExpandCollapse, this);\n            this.trigger('expandCollapse', eventArgs);\n        }\n    };\n    Ribbon.prototype.getIndex = function (index, decrement) {\n        return this.menuItems.length ? (decrement ? index - 1 : index + 1) : index;\n    };\n    Ribbon.prototype.updateToolbar = function (index) {\n        this.toolbarObj.items = this.items[index].content;\n        this.toolbarObj.dataBind();\n    };\n    /**\n     * To enable / disable the ribbon menu items.\n     * @param {string[]} items - Items that needs to be enabled / disabled.\n     * @param {boolean} enable - Set `true` / `false` to enable / disable the menu items.\n     * @param {boolean} isUniqueId? - Set `true` if the given menu items `text` is a unique id.\n     * @returns void.\n     */\n    Ribbon.prototype.enableMenuItems = function (items, enable, isUniqueId) {\n        if (enable === void 0) { enable = true; }\n        if (!this.menuItems.length) {\n            return;\n        }\n        getComponent(document.getElementById(this.element.id + \"_menu\"), 'menu').enableItems(items, enable, isUniqueId);\n    };\n    /**\n     * To show/hide the menu items in Ribbon.\n     * @param {string[]} items - Specifies the menu items text which is to be show/hide.\n     * @param {boolean} hide - Set `true` / `false` to hide / show the menu items.\n     * @param {boolean} isUniqueId? - Set `true` if the given menu items `text` is a unique id.\n     * @returns void.\n     */\n    Ribbon.prototype.hideMenuItems = function (items, hide, isUniqueId) {\n        if (hide === void 0) { hide = true; }\n        if (!this.menuItems.length) {\n            return;\n        }\n        var menuInstance = getComponent(document.getElementById(this.element.id + \"_menu\"), 'menu');\n        hide ? menuInstance.hideItems(items, isUniqueId) : menuInstance.showItems(items, isUniqueId);\n    };\n    /**\n     * To add custom menu items.\n     * @param {MenuItemModel[]} items - Specifies the Ribbon menu items to be inserted.\n     * @param {string} text - Specifies the existing file menu item text before / after which the new file menu items to be inserted.\n     * @param {boolean} insertAfter? - Set `false` if the `items` need to be inserted before the `text`.\n     * By default, `items` are added after the `text`.\n     * @param {boolean} isUniqueId? - Set `true` if the given menu items `text` is a unique id.\n     * @returns void.\n     */\n    Ribbon.prototype.addMenuItems = function (items, text, insertAfter, isUniqueId) {\n        if (insertAfter === void 0) { insertAfter = true; }\n        if (!this.menuItems.length) {\n            return;\n        }\n        var menuInstance = getComponent(document.getElementById(this.element.id + \"_menu\"), 'menu');\n        insertAfter ? menuInstance.insertAfter(items.reverse(), text, isUniqueId) : menuInstance.insertBefore(items, text, isUniqueId);\n    };\n    /**\n     * To show/hide the Ribbon tabs.\n     * @param {string[]} tabs - Specifies the tab header text which needs to be shown/hidden.\n     * @param {boolean} hide? - Set `true` / `false` to hide / show the ribbon tabs.\n     * @returns void.\n     */\n    Ribbon.prototype.hideTabs = function (tabs, hide) {\n        var _this = this;\n        if (hide === void 0) { hide = true; }\n        var idx;\n        var activeTab;\n        var stateChanged;\n        var isAllHidden;\n        if (!hide) {\n            isAllHidden = this.isAllHidden();\n        }\n        tabs.forEach(function (tab) {\n            idx = _this.getTabIndex(tab, -1);\n            if (idx > -1) {\n                if (hide) {\n                    if (!_this.items[idx].cssClass.includes(' e-hide')) {\n                        _this.items[idx].cssClass = _this.items[idx].cssClass + \" e-hide\";\n                        _this.tabObj.items[_this.getIndex(idx)].cssClass = _this.items[idx].cssClass;\n                        if (activeTab === undefined && idx === _this.selectedTab) {\n                            activeTab = true;\n                        }\n                        stateChanged = true;\n                    }\n                }\n                else {\n                    if (_this.items[idx].cssClass.includes(' e-hide')) {\n                        _this.items[idx].cssClass = _this.items[idx].cssClass.replace(' e-hide', '');\n                        _this.tabObj.items[_this.getIndex(idx)].cssClass = _this.items[idx].cssClass;\n                        if (activeTab === undefined && idx === _this.selectedTab) {\n                            activeTab = true;\n                        }\n                        stateChanged = true;\n                    }\n                }\n            }\n        });\n        this.setProperties({ 'items': this.items }, true);\n        this.tabObj.items = this.tabObj.items;\n        this.tabObj.dataBind();\n        if (hide) {\n            isAllHidden = this.isAllHidden();\n            if (isAllHidden) {\n                activeTab = false;\n            }\n        }\n        if (!hide && isAllHidden) {\n            activeTab = activeTab ? false : true;\n        }\n        if (stateChanged && isAllHidden) {\n            if (this.element.classList.contains('e-collapsed')) {\n                this.element.classList.remove('e-collapsed');\n                this.element.querySelector('.e-drop-icon').classList.remove('e-hide');\n            }\n            else {\n                this.element.classList.add('e-collapsed');\n                this.element.querySelector('.e-drop-icon').classList.add('e-hide');\n            }\n        }\n        if (activeTab) {\n            for (var i = 0; i < this.items.length; i++) {\n                if (!this.items[i].cssClass.includes(' e-hide')) {\n                    this.tabObj.selectedItem = this.getIndex(i);\n                    this.tabObj.dataBind();\n                    break;\n                }\n            }\n        }\n    };\n    Ribbon.prototype.isAllHidden = function () {\n        var allHidden = true;\n        for (var i = 0; i < this.items.length; i++) {\n            if (!this.items[i].cssClass.includes(' e-hide')) {\n                allHidden = false;\n                break;\n            }\n        }\n        return allHidden;\n    };\n    /**\n     * To enable / disable the Ribbon tabs.\n     * @param {string[]} tabs - Specifies the tab header text which needs to be enabled / disabled.\n     * @param {boolean} enable? - Set `true` / `false` to enable / disable the ribbon tabs.\n     * @returns void.\n     */\n    Ribbon.prototype.enableTabs = function (tabs, enable) {\n        var _this = this;\n        if (enable === void 0) { enable = true; }\n        tabs.forEach(function (tab) {\n            var idx = (_this.getTabIndex(tab, -1));\n            if (idx > -1) {\n                _this.items[idx].disabled = !enable;\n                idx = _this.getIndex(idx);\n                _this.tabObj.enableTab(idx, enable);\n            }\n        });\n        this.setProperties({ 'items': this.items }, true);\n    };\n    /**\n     * To add custom tabs.\n     * @param {RibbonItemModel[]} items - Specifies the Ribbon tab items to be inserted.\n     * @param {string} insertBefore? - Specifies the existing Ribbon header text before which the new tabs will be inserted.\n     * If not specified, the new tabs will be inserted at the end.\n     * @returns void.\n     */\n    Ribbon.prototype.addTabs = function (items, insertBefore) {\n        var _this = this;\n        var idx = this.getTabIndex(insertBefore);\n        items.forEach(function (item) {\n            item = new RibbonItem(_this.items[0], 'items', item, true);\n            _this.items.splice(idx, 0, item);\n            _this.tabObj.addTab([{ header: item.header, content: _this.toolbarObj.element }], _this.getIndex(idx));\n            idx++;\n        });\n        this.setProperties({ 'items': this.items }, true);\n        this.setProperties({ 'selectedTab': this.getIndex(this.tabObj.selectedItem, true) }, true);\n    };\n    Ribbon.prototype.getTabIndex = function (headerText, idx) {\n        if (idx === void 0) { idx = this.items.length; }\n        if (headerText) {\n            for (var i = 0; i < this.items.length; i++) {\n                if (this.items[i].header.text === headerText) {\n                    idx = i;\n                    break;\n                }\n            }\n        }\n        return idx;\n    };\n    /**\n     * To add the custom items in Ribbon toolbar.\n     * @param {string} tab - Specifies the ribbon tab header text under which the specified items will be inserted..\n     * @param {ItemModel[]} items - Specifies the ribbon toolbar items that needs to be inserted.\n     * @param {number} index? - Specifies the index text before which the new items will be inserted.\n     * If not specified, the new items will be inserted at the end of the toolbar.\n     */\n    Ribbon.prototype.addToolbarItems = function (tab, items, index) {\n        var _this = this;\n        var tabIdx = this.getTabIndex(tab);\n        if (isNullOrUndefined(index)) {\n            index = this.items[tabIdx].content.length;\n        }\n        items.forEach(function (item) {\n            item = new Item(_this.items[tabIdx].content[0], 'content', item, true);\n            _this.items[tabIdx].content.splice(index, 0, item);\n            index++;\n        });\n        this.setProperties({ 'items': this.items }, true);\n        if (tabIdx === this.selectedTab && items.length) {\n            this.updateToolbar(tabIdx);\n        }\n    };\n    /**\n     * Enables or disables the specified Ribbon toolbar items or all ribbon items.\n     * @param {string} tab - Specifies the ribbon tab header text under which the toolbar items need to be enabled / disabled.\n     * @param {string[]} items? - Specifies the toolbar item indexes / unique id's which needs to be enabled / disabled.\n     * If it is not specified the entire toolbar items will be enabled / disabled.\n     * @param  {boolean} enable? - Boolean value that determines whether the toolbar items should be enabled or disabled.\n     * @returns void.\n     */\n    Ribbon.prototype.enableItems = function (tab, items, enable) {\n        if (enable === undefined) {\n            enable = true;\n        }\n        if (items) {\n            var tabIdx = this.getTabIndex(tab, -1);\n            if (tabIdx < 0) {\n                return;\n            }\n            for (var i = 0; i < items.length; i++) {\n                if (typeof (items[i]) === 'string') {\n                    for (var j = 0; j < this.items[tabIdx].content.length; j++) {\n                        if (this.items[tabIdx].content[j].id === items[i]) {\n                            items[i] = j;\n                            break;\n                        }\n                    }\n                }\n                if (typeof (items[i]) === 'string') {\n                    return;\n                }\n                this.items[tabIdx].content[items[i]].disabled = !enable;\n            }\n            if (tabIdx === this.selectedTab) {\n                this.updateToolbar(tabIdx);\n            }\n        }\n        else {\n            this.toolbarObj.disable(!enable);\n        }\n    };\n    /**\n     * To show/hide the existing Ribbon toolbar items.\n     * @param {string} tab - Specifies the ribbon tab header text under which the specified items need to be hidden / shown.\n     * @param {string[]} indexes - Specifies the toolbar indexes which needs to be shown/hidden from UI.\n     * @param {boolean} hide? - Set `true` / `false` to hide / show the toolbar items.\n     * @returns void.\n     */\n    Ribbon.prototype.hideToolbarItems = function (tab, indexes, hide) {\n        var _this = this;\n        if (hide === void 0) { hide = true; }\n        var tabIdx;\n        for (var i = 0; i < this.items.length; i++) {\n            if (this.items[i].header.text === tab) {\n                tabIdx = i;\n                indexes.forEach(function (idx) {\n                    if (_this.items[tabIdx].content[idx]) {\n                        if (hide) {\n                            if (!_this.items[tabIdx].content[idx].cssClass.includes(' e-hide')) {\n                                _this.items[tabIdx].content[idx].cssClass = _this.items[tabIdx].content[idx].cssClass + ' e-hide';\n                            }\n                        }\n                        else {\n                            if (_this.items[tabIdx].content[idx].cssClass.includes(' e-hide')) {\n                                _this.items[tabIdx].content[idx].cssClass = _this.items[tabIdx].content[idx].cssClass.replace(' e-hide', '');\n                            }\n                        }\n                    }\n                });\n                break;\n            }\n        }\n        this.setProperties({ 'items': this.items }, true);\n        if (tabIdx !== undefined && tabIdx === this.selectedTab) {\n            this.updateToolbar(tabIdx);\n        }\n    };\n    /**\n     * Get component name.\n     * @returns string\n     * @private\n     */\n    Ribbon.prototype.getModuleName = function () {\n        return 'ribbon';\n    };\n    /**\n     * Get the properties to be maintained in the persisted state.\n     * @returns string\n     * @private\n     */\n    Ribbon.prototype.getPersistData = function () {\n        return this.addOnPersist([]);\n    };\n    /**\n     * Called internally if any of the property value changed.\n     * @param  {RibbonModel} newProp\n     * @param  {RibbonModel} oldProp\n     * @returns void\n     * @private\n     */\n    Ribbon.prototype.onPropertyChanged = function (newProp, oldProp) {\n        for (var _i = 0, _a = Object.keys(newProp); _i < _a.length; _i++) {\n            var prop = _a[_i];\n            switch (prop) {\n                case 'selectedTab':\n                    this.tabObj.selectedItem = this.getIndex(newProp.selectedTab);\n                    this.tabObj.dataBind();\n                    break;\n            }\n        }\n    };\n    __decorate([\n        Property('')\n    ], Ribbon.prototype, \"cssClass\", void 0);\n    __decorate([\n        Property(true)\n    ], Ribbon.prototype, \"menuType\", void 0);\n    __decorate([\n        Collection([], MenuItem)\n    ], Ribbon.prototype, \"menuItems\", void 0);\n    __decorate([\n        Property(0)\n    ], Ribbon.prototype, \"selectedTab\", void 0);\n    __decorate([\n        Collection([], RibbonItem)\n    ], Ribbon.prototype, \"items\", void 0);\n    __decorate([\n        Event()\n    ], Ribbon.prototype, \"selecting\", void 0);\n    __decorate([\n        Event()\n    ], Ribbon.prototype, \"fileMenuItemSelect\", void 0);\n    __decorate([\n        Event()\n    ], Ribbon.prototype, \"beforeFileMenuItemRender\", void 0);\n    __decorate([\n        Event()\n    ], Ribbon.prototype, \"beforeOpen\", void 0);\n    __decorate([\n        Event()\n    ], Ribbon.prototype, \"beforeClose\", void 0);\n    __decorate([\n        Event()\n    ], Ribbon.prototype, \"selectFormat\", void 0);\n    __decorate([\n        Event()\n    ], Ribbon.prototype, \"clicked\", void 0);\n    __decorate([\n        Event()\n    ], Ribbon.prototype, \"created\", void 0);\n    __decorate([\n        Event()\n    ], Ribbon.prototype, \"expandCollapse\", void 0);\n    Ribbon = __decorate([\n        NotifyPropertyChanges\n    ], Ribbon);\n    return Ribbon;\n}(Component));\nexport { Ribbon };\n","import { ColorPicker as ColorPickerComponent } from '@syncfusion/ej2-inputs';\nimport { addClass } from '@syncfusion/ej2-base';\nimport { spreadsheetDestroyed, fontColor, fillColor, beforeRibbonCreate, locale } from '../common/index';\nimport { setCellFormat } from '../../workbook/common/index';\n/**\n * `Color Picker` module is used to handle ColorPicker functionality.\n * @hidden\n */\nvar ColorPicker = /** @class */ (function () {\n    function ColorPicker(parent) {\n        this.parent = parent;\n        this.addEventListener();\n    }\n    ColorPicker.prototype.render = function () {\n        var _this = this;\n        var id = this.parent.element.id;\n        var input = this.parent.createElement('input', { attrs: { 'type': 'color' } });\n        this.fontColorPicker = new ColorPickerComponent({\n            value: '#000000ff',\n            mode: 'Palette',\n            showButtons: false,\n            presetColors: fontColor,\n            enableOpacity: false,\n            beforeClose: function (args) { return _this.beforeCloseHandler(_this.fontColorPicker); },\n            open: this.openHandler.bind(this),\n            beforeModeSwitch: function (args) { return _this.beforeModeSwitch(_this.fontColorPicker, args); },\n            change: function (args) {\n                var color = _this.fontColorPicker.getValue(args.currentValue.rgba);\n                var eventArgs = { style: { color: color }, onActionUpdate: true };\n                _this.parent.notify(setCellFormat, eventArgs);\n                if (eventArgs.cancel) {\n                    _this.fontColorPicker.setProperties({ 'value': _this.fontColorPicker.getValue(args.previousValue.rgba, 'HEXA') }, true);\n                }\n                else {\n                    _this.updateSelectedColor(eventArgs.style.color, _this.fontColorPicker.element);\n                }\n                _this.parent.element.focus();\n            },\n            created: function () { return _this.wireFocusEvent(_this.fontColorPicker.element, '#000000'); }\n        });\n        this.fontColorPicker.createElement = this.parent.createElement;\n        this.parent.element.appendChild(input);\n        this.fontColorPicker.appendTo(input);\n        input.parentElement.id = id + \"_font_color_picker\";\n        addClass([input.nextElementSibling.getElementsByClassName('e-selected-color')[0]], ['e-icons', 'e-font-color']);\n        input = this.parent.createElement('input', { attrs: { 'type': 'color' } });\n        this.filColorPicker = new ColorPickerComponent({\n            value: '#ffff00ff',\n            mode: 'Palette',\n            presetColors: fillColor,\n            showButtons: false,\n            enableOpacity: false,\n            open: this.openHandler.bind(this),\n            beforeClose: function (args) { return _this.beforeCloseHandler(_this.filColorPicker); },\n            beforeModeSwitch: function (args) { return _this.beforeModeSwitch(_this.filColorPicker, args); },\n            change: function (args) {\n                var color = _this.filColorPicker.getValue(args.currentValue.rgba);\n                var eventArgs = { style: { backgroundColor: color }, onActionUpdate: true };\n                _this.parent.notify(setCellFormat, eventArgs);\n                if (eventArgs.cancel) {\n                    _this.filColorPicker.setProperties({ 'value': _this.filColorPicker.getValue(args.previousValue.rgba, 'HEXA') }, true);\n                }\n                else {\n                    _this.updateSelectedColor(eventArgs.style.backgroundColor, _this.filColorPicker.element);\n                }\n                _this.parent.element.focus();\n            },\n            created: function () { return _this.wireFocusEvent(_this.filColorPicker.element, '#ffff00'); }\n        });\n        this.filColorPicker.createElement = this.parent.createElement;\n        this.parent.element.appendChild(input);\n        this.filColorPicker.appendTo(input);\n        input.parentElement.id = id + \"_fill_color_picker\";\n        addClass([input.nextElementSibling.getElementsByClassName('e-selected-color')[0]], ['e-icons', 'e-fill-color']);\n    };\n    ColorPicker.prototype.updateSelectedColor = function (color, ele) {\n        ele.nextElementSibling.querySelector('.e-selected-color').style.borderBottomColor = color;\n    };\n    ColorPicker.prototype.wireFocusEvent = function (element, color) {\n        var _this = this;\n        this.updateSelectedColor(color, element);\n        element = element.parentElement.querySelector('.e-split-colorpicker');\n        element.addEventListener('focus', function () {\n            _this.parent.element.focus();\n        });\n    };\n    ColorPicker.prototype.openHandler = function (args) {\n        args.element.querySelector('.e-mode-switch-btn').title =\n            this.parent.serviceLocator.getService(locale).getConstant('MoreColors');\n    };\n    ColorPicker.prototype.beforeCloseHandler = function (inst) {\n        if (!inst.modeSwitcher) {\n            inst.setProperties({ modeSwitcher: true }, true);\n        }\n        if (inst.showButtons) {\n            inst.setProperties({ showButtons: false }, true);\n        }\n    };\n    ColorPicker.prototype.beforeModeSwitch = function (inst, args) {\n        var l10n = this.parent.serviceLocator.getService(locale);\n        if (args.mode === 'Picker') {\n            inst.showButtons = true;\n            inst.dataBind();\n            args.element.querySelector('.e-apply').title = l10n.getConstant('Apply');\n            args.element.querySelector('.e-cancel').title = l10n.getConstant('Cancel');\n            args.element.querySelector('.e-mode-switch-btn').title = l10n.getConstant('StandardColors');\n        }\n        else {\n            inst.showButtons = false;\n            inst.dataBind();\n            args.element.querySelector('.e-mode-switch-btn').title = l10n.getConstant('MoreColors');\n        }\n    };\n    ColorPicker.prototype.destroy = function () {\n        if (this.parent) {\n            this.removeEventListener();\n            this.fontColorPicker.destroy();\n            this.fontColorPicker = null;\n            this.filColorPicker.destroy();\n            this.filColorPicker = null;\n            this.parent = null;\n        }\n    };\n    ColorPicker.prototype.addEventListener = function () {\n        this.parent.on(beforeRibbonCreate, this.render, this);\n        this.parent.on('destroyRibbonComponents', this.destroy, this);\n        this.parent.on(spreadsheetDestroyed, this.destroy, this);\n    };\n    ColorPicker.prototype.removeEventListener = function () {\n        this.parent.off(beforeRibbonCreate, this.render);\n        this.parent.off('destroyRibbonComponents', this.destroy);\n        this.parent.on(spreadsheetDestroyed, this.destroy, this);\n    };\n    return ColorPicker;\n}());\nexport { ColorPicker };\n","import { Ribbon as RibbonComponent } from '../../ribbon/index';\nimport { ribbon, selectionComplete, beforeRibbonCreate, removeDataValidation, clearViewer } from '../common/index';\nimport { initiateDataValidation, invalidData, setUndoRedo, initiateConditionalFormat, setCF } from '../common/index';\nimport { dialog, reapplyFilter, enableFileMenuItems, applyProtect, protectCellFormat } from '../common/index';\nimport { findHandler, insertChart } from '../common/index';\nimport { destroyComponent, performUndoRedo, beginAction, completeAction, applySort, hideRibbonTabs } from '../common/index';\nimport { enableToolbarItems, ribbonClick, paste, locale, refreshSheetTabs, initiateCustomSort, getFilteredColumn } from '../common/index';\nimport { tabSwitch, getUpdateUsingRaf, updateToggleItem, initiateHyperlink, editHyperlink } from '../common/index';\nimport { addRibbonTabs, addToolbarItems, hideFileMenuItems, addFileMenuItems, hideToolbarItems, enableRibbonTabs } from '../common/index';\nimport { Toolbar, Menu } from '@syncfusion/ej2-navigations';\nimport { ColorPicker } from '@syncfusion/ej2-inputs';\nimport { extend, isNullOrUndefined, getComponent, closest, detach, selectAll, select, EventHandler } from '@syncfusion/ej2-base';\nimport { getCellIndexes, getFormatFromType, getTypeFromFormat, setCell } from '../../workbook/index';\nimport { DropDownButton, SplitButton } from '@syncfusion/ej2-splitbuttons';\nimport { calculatePosition } from '@syncfusion/ej2-popups';\nimport { applyNumberFormatting, getFormattedCellObject, getRangeIndexes, setMerge } from '../../workbook/common/index';\nimport { activeCellChanged, textDecorationUpdate, isNumber } from '../../workbook/common/index';\nimport { sheetsDestroyed, getRangeAddress, clearCFRule } from '../../workbook/common/index';\nimport { getCell, setCellFormat } from '../../workbook/index';\nimport { Button } from '@syncfusion/ej2-buttons';\nimport { ColorPicker as RibbonColorPicker } from './color-picker';\nimport { Dialog as FindDialog } from '@syncfusion/ej2-popups';\nimport { findDlg } from '../common/index';\nimport { refreshRibbonIcons } from '../../workbook/common/index';\n/**\n * Represents Ribbon for Spreadsheet.\n */\nvar Ribbon = /** @class */ (function () {\n    function Ribbon(parent) {\n        this.border = '1px solid #000000';\n        this.fontNameIndex = 5;\n        this.numPopupWidth = 0;\n        this.findValue = '';\n        this.parent = parent;\n        this.addEventListener();\n        new RibbonColorPicker(parent);\n    }\n    Ribbon.prototype.getModuleName = function () {\n        return 'ribbon';\n    };\n    Ribbon.prototype.initRibbon = function (args) {\n        if (!this.parent.showRibbon && this.ribbon) {\n            this.destroy();\n            return;\n        }\n        this.parent.notify(beforeRibbonCreate, {});\n        if (this.parent.isMobileView()) {\n            this.createMobileView();\n        }\n        else {\n            this.createRibbon(args);\n        }\n    };\n    Ribbon.prototype.getRibbonMenuItems = function () {\n        var l10n = this.parent.serviceLocator.getService(locale);\n        var id = this.parent.element.id;\n        return [{\n                text: this.parent.isMobileView() ? '' : l10n.getConstant('File'),\n                iconCss: this.parent.isMobileView() ? 'e-icons e-file-menu-icon' : null, id: id + \"_File\",\n                items: [\n                    { text: l10n.getConstant('New'), id: id + \"_New\", iconCss: 'e-new e-icons' },\n                    { text: l10n.getConstant('Open'), id: id + \"_Open\", iconCss: 'e-open e-icons' },\n                    {\n                        text: l10n.getConstant('SaveAs'), iconCss: 'e-save e-icons', id: id + \"_Save_As\",\n                        items: [\n                            { text: l10n.getConstant('ExcelXlsx'), id: id + \"_Xlsx\", iconCss: 'e-xlsx e-icons' },\n                            { text: l10n.getConstant('ExcelXls'), id: id + \"_Xls\", iconCss: 'e-xls e-icons' },\n                            { text: l10n.getConstant('CSV'), id: id + \"_Csv\", iconCss: 'e-csv e-icons' }\n                        ]\n                    }\n                ]\n            }];\n    };\n    // tslint:disable-next-line:max-func-body-length\n    Ribbon.prototype.getRibbonItems = function () {\n        var _this = this;\n        var id = this.parent.element.id;\n        var l10n = this.parent.serviceLocator.getService(locale);\n        var items = [{\n                header: { text: l10n.getConstant('Home') },\n                content: [\n                    { prefixIcon: 'e-undo-icon', tooltipText: l10n.getConstant('Undo') + \" (Ctrl+Z)\", id: id + '_undo', disabled: true },\n                    { prefixIcon: 'e-redo-icon', tooltipText: l10n.getConstant('Redo') + \" (Ctrl+Y)\", id: id + '_redo', disabled: true },\n                    { type: 'Separator', id: id + '_separator_1' },\n                    { prefixIcon: 'e-cut-icon', tooltipText: l10n.getConstant('Cut') + \" (Ctrl+X)\", id: id + '_cut' },\n                    { prefixIcon: 'e-copy-icon', tooltipText: l10n.getConstant('Copy') + \" (Ctrl+C)\", id: id + '_copy' },\n                    { tooltipText: l10n.getConstant('Paste') + \" (Ctrl+V)\", template: this.getPasteBtn(id), id: id + '_paste',\n                        disabled: true\n                    }, { type: 'Separator', id: id + '_separator_2' },\n                    { template: this.getNumFormatDDB(id), tooltipText: l10n.getConstant('NumberFormat'), id: id + '_number_format' },\n                    { type: 'Separator', id: id + '_separator_3' },\n                    { template: this.getFontNameDDB(id), tooltipText: l10n.getConstant('Font'), id: id + '_font_name' },\n                    { type: 'Separator', id: id + '_separator_4' },\n                    { template: this.getFontSizeDDB(id), tooltipText: l10n.getConstant('FontSize'), id: id + '_font_size' },\n                    { type: 'Separator', id: id + '_separator_5' },\n                    { template: this.getBtn(id, 'bold'), tooltipText: l10n.getConstant('Bold') + \" (Ctrl+B)\", id: id + '_bold' },\n                    { template: this.getBtn(id, 'italic'), tooltipText: l10n.getConstant('Italic') + \" (Ctrl+I)\", id: id + '_italic' },\n                    { template: this.getBtn(id, 'line-through'), tooltipText: l10n.getConstant('Strikethrough') + \" (Ctrl+5)\",\n                        id: id + '_line-through' },\n                    { template: this.getBtn(id, 'underline'), tooltipText: l10n.getConstant('Underline') + \" (Ctrl+U)\",\n                        id: id + '_underline' },\n                    { template: document.getElementById(id + \"_font_color_picker\"), tooltipText: l10n.getConstant('TextColor'),\n                        id: id + '_font_color_picker' }, { type: 'Separator', id: id + '_separator_6' },\n                    { template: document.getElementById(id + \"_fill_color_picker\"), tooltipText: l10n.getConstant('FillColor'),\n                        id: id + '_fill_color_picker' },\n                    { template: this.getBordersDBB(id), tooltipText: l10n.getConstant('Borders'), id: id + '_borders' }, {\n                        template: this.getMergeSplitBtn(id), tooltipText: l10n.getConstant('MergeCells'), id: id + '_merge_cells',\n                        disabled: true\n                    }, { type: 'Separator', id: id + '_separator_7' },\n                    { template: this.getTextAlignDDB(id), tooltipText: l10n.getConstant('HorizontalAlignment'), id: id + '_text_align' }, { template: this.getVerticalAlignDDB(id), tooltipText: l10n.getConstant('VerticalAlignment'), id: id + '_vertical_align' },\n                    { template: this.getBtn(id, 'wrap', false), tooltipText: \"\" + l10n.getConstant('WrapText'), id: id + '_wrap' }\n                ]\n            },\n            {\n                header: { text: l10n.getConstant('Insert') }, content: [\n                    {\n                        prefixIcon: 'e-hyperlink-icon', text: l10n.getConstant('Link'),\n                        id: id + '_hyperlink', tooltipText: l10n.getConstant('Link'), click: function () { _this.getHyperlinkDlg(); }\n                    },\n                    {\n                        prefixIcon: 'e-image-icon', text: l10n.getConstant('Image'),\n                        id: id + '_', tooltipText: l10n.getConstant('Image'), click: function () {\n                            select('#' + id + '_imageUpload', _this.parent.element).click();\n                        }\n                    }\n                ]\n            },\n            {\n                header: { text: l10n.getConstant('Formulas') }, content: [{\n                        prefixIcon: 'e-insert-function', tooltipText: l10n.getConstant('InsertFunction'),\n                        text: l10n.getConstant('InsertFunction'), id: id + '_insert_function'\n                    }]\n            },\n            {\n                header: { text: l10n.getConstant('Data') }, content: [\n                    {\n                        prefixIcon: 'e-protect-icon', text: l10n.getConstant('ProtectSheet'), id: id + '_protect',\n                        tooltipText: l10n.getConstant('ProtectSheet')\n                    }, { type: 'Separator', id: id + '_separator_8' },\n                    {\n                        template: this.datavalidationDDB(id), tooltipText: l10n.getConstant('DataValidation'),\n                        id: id + '_datavalidation'\n                    }\n                ]\n            },\n            {\n                header: { text: l10n.getConstant('View') }, content: [\n                    {\n                        prefixIcon: 'e-hide-headers', text: this.getLocaleText('Headers'), id: id + '_headers',\n                        tooltipText: this.getLocaleText('Headers')\n                    }, { type: 'Separator', id: id + '_separator_9' },\n                    {\n                        prefixIcon: 'e-hide-gridlines', text: this.getLocaleText('GridLines'), id: id + '_gridlines',\n                        tooltipText: this.getLocaleText('GridLines')\n                    }\n                ]\n            }];\n        if (this.parent.allowConditionalFormat) {\n            items.find(function (x) { return x.header && x.header.text === l10n.getConstant('Home'); }).content.push({ type: 'Separator', id: id + '_separator_10' }, { template: this.getCFDBB(id), tooltipText: l10n.getConstant('ConditionalFormatting'), id: id + '_conditionalformatting' });\n        }\n        if (this.parent.allowChart) {\n            items.find(function (x) { return x.header && x.header.text === l10n.getConstant('Insert'); }).content.push({ type: 'Separator', id: id + '_separator_11' }, {\n                template: this.getChartDBB(id), text: l10n.getConstant('Chart'),\n                tooltipText: l10n.getConstant('Chart'), id: id + '_chart'\n            });\n        }\n        if (this.parent.allowCellFormatting) {\n            items.find(function (x) { return x.header && x.header.text === l10n.getConstant('Home'); }).content.push({ type: 'Separator', id: id + '_separator_12' }, { template: this.getClearDDB(id), tooltipText: l10n.getConstant('Clear'), id: id + '_clear' });\n        }\n        if (this.parent.allowSorting || this.parent.allowFiltering) {\n            items.find(function (x) { return x.header && x.header.text === l10n.getConstant('Home'); }).content.push({ template: this.getSortFilterDDB(id), tooltipText: l10n.getConstant('SortAndFilter'), id: id + '_sorting' });\n        }\n        if (this.parent.allowFindAndReplace) {\n            items.find(function (x) { return x.header && x.header.text === l10n.getConstant('Home'); }).content.push({\n                template: this.getFindDDb(id), prefixIcon: 'e-tbar-search-icon tb-icons',\n                tooltipText: l10n.getConstant('FindReplaceTooltip'), id: id + '_find'\n            });\n        }\n        return items;\n    };\n    Ribbon.prototype.getPasteBtn = function (id) {\n        var _this = this;\n        var btn = this.parent.element.appendChild(this.parent.createElement('button', { id: id + '_paste' }));\n        var l10n = this.parent.serviceLocator.getService(locale);\n        this.pasteSplitBtn = new SplitButton({\n            iconCss: 'e-icons e-paste-icon',\n            items: [\n                { text: l10n.getConstant('All'), id: 'All' },\n                { text: l10n.getConstant('Values'), id: 'Values' },\n                { text: l10n.getConstant('Formats'), id: 'Formats' }\n            ],\n            select: function (args) {\n                _this.parent.notify(paste, { type: args.item.id, isAction: true, isInternal: true });\n            },\n            click: function () {\n                _this.parent.notify(paste, { isAction: true, isInternal: true });\n            },\n            close: function () { _this.parent.element.focus(); }\n        });\n        this.pasteSplitBtn.createElement = this.parent.createElement;\n        this.pasteSplitBtn.appendTo(btn);\n        return btn.parentElement;\n    };\n    Ribbon.prototype.getHyperlinkDlg = function () {\n        var indexes = getRangeIndexes(this.parent.getActiveSheet().activeCell);\n        var row = this.parent.sheets[this.parent.getActiveSheet().id - 1].rows[indexes[0]];\n        var cell;\n        if (!isNullOrUndefined(row)) {\n            cell = row.cells[indexes[1]];\n        }\n        if (isNullOrUndefined(cell)) {\n            setCell(indexes[0], indexes[1], this.parent.getActiveSheet(), cell, false);\n        }\n        if (cell && cell.hyperlink) {\n            this.parent.notify(editHyperlink, null);\n        }\n        else {\n            this.parent.notify(initiateHyperlink, null);\n        }\n    };\n    Ribbon.prototype.getLocaleText = function (str, setClass) {\n        var text;\n        var l10n = this.parent.serviceLocator.getService(locale);\n        var sheet = this.parent.getActiveSheet();\n        if (sheet['show' + str]) {\n            if (setClass) {\n                this.parent.getMainContent().classList.remove('e-hide-' + str.toLowerCase());\n            }\n            text = l10n.getConstant('Hide' + str);\n        }\n        else {\n            if (setClass) {\n                this.parent.getMainContent().classList.add('e-hide-' + str.toLowerCase());\n            }\n            text = l10n.getConstant('Show' + str);\n        }\n        return text;\n    };\n    Ribbon.prototype.getLocaleProtectText = function (str, setClass) {\n        var text;\n        var l10n = this.parent.serviceLocator.getService(locale);\n        var sheet = this.parent.getActiveSheet();\n        if (sheet.isProtected) {\n            if (setClass) {\n                this.parent.getMainContent().classList.remove('e-hide-' + str.toLowerCase());\n            }\n            text = l10n.getConstant('Unprotect' + str);\n        }\n        else {\n            if (setClass) {\n                this.parent.getMainContent().classList.add('e-hide-' + str.toLowerCase());\n            }\n            text = l10n.getConstant('Protect' + str);\n        }\n        return text;\n    };\n    Ribbon.prototype.createRibbon = function (args) {\n        var ribbonElement = this.parent.createElement('div', { id: this.parent.element.id + \"_ribbon\" });\n        this.ribbon = new RibbonComponent({\n            selectedTab: 0,\n            menuItems: this.getRibbonMenuItems(),\n            items: this.getRibbonItems(),\n            fileMenuItemSelect: this.fileMenuItemSelect.bind(this),\n            beforeOpen: this.fileMenuBeforeOpen.bind(this),\n            beforeClose: this.fileMenuBeforeClose.bind(this),\n            clicked: this.toolbarClicked.bind(this),\n            created: this.ribbonCreated.bind(this),\n            selecting: this.tabSelecting.bind(this),\n            expandCollapse: this.expandCollapseHandler.bind(this),\n            beforeFileMenuItemRender: this.beforeRenderHandler.bind(this)\n        });\n        this.ribbon.createElement = this.parent.createElement;\n        if (args && args.uiUpdate) {\n            var refEle = this.parent.element.querySelector('.e-formula-bar-panel') ||\n                document.getElementById(this.parent.element.id + '_sheet_panel');\n            this.parent.element.insertBefore(ribbonElement, refEle);\n        }\n        else {\n            this.parent.element.appendChild(ribbonElement);\n        }\n        this.ribbon.appendTo(ribbonElement);\n    };\n    Ribbon.prototype.tabSelecting = function (args) {\n        if (args.selectingIndex !== this.ribbon.selectedTab) {\n            this.refreshRibbonContent(args.selectingIndex);\n            this.parent.notify(tabSwitch, { activeTab: args.selectingIndex });\n        }\n    };\n    Ribbon.prototype.beforeRenderHandler = function (args) {\n        var l10n = this.parent.serviceLocator.getService(locale);\n        if (args.item.text === l10n.getConstant('Open') && (!this.parent.openUrl || !this.parent.allowOpen)) {\n            args.element.classList.add('e-disabled');\n        }\n        if (args.item.text === l10n.getConstant('SaveAs') && (!this.parent.saveUrl || !this.parent.allowSave)) {\n            args.element.classList.add('e-disabled');\n        }\n    };\n    Ribbon.prototype.getNumFormatDDB = function (id) {\n        var _this = this;\n        var numFormatBtn = this.parent.createElement('button', { id: id + '_number_format' });\n        numFormatBtn.appendChild(this.parent.createElement('span', { className: 'e-tbar-btn-text', innerHTML: 'General' }));\n        this.numFormatDDB = new DropDownButton({\n            items: this.getNumFormatDdbItems(id),\n            content: '',\n            select: function (args) { return _this.numDDBSelect(args); },\n            open: function (args) { return _this.numDDBOpen(args); },\n            beforeItemRender: function (args) { return _this.previewNumFormat(args); },\n            close: function () { return _this.parent.element.focus(); },\n            cssClass: 'e-flat e-numformat-ddb',\n            beforeOpen: function (args) { return _this.tBarDdbBeforeOpen(args.element, args.items); }\n        });\n        this.numFormatDDB.createElement = this.parent.createElement;\n        this.numFormatDDB.appendTo(numFormatBtn);\n        return numFormatBtn;\n    };\n    Ribbon.prototype.getFontSizeDDB = function (id) {\n        var _this = this;\n        this.fontSizeDdb = new DropDownButton({\n            cssClass: 'e-font-size-ddb',\n            content: '11',\n            items: [{ text: '8' }, { text: '9' }, { text: '10' }, { text: '11' }, { text: '12' }, { text: '14' }, { text: '16' },\n                { text: '18' }, { text: '20' }, { text: '22' }, { text: '24' }, { text: '26' }, { text: '28' }, { text: '36' },\n                { text: '48' }, { text: '72' }],\n            beforeOpen: function (args) {\n                _this.tBarDdbBeforeOpen(args.element, args.items);\n                _this.refreshSelected(_this.fontSizeDdb, args.element, 'content', 'text');\n            },\n            select: function (args) {\n                var eventArgs = { style: { fontSize: args.item.text + \"pt\" }, onActionUpdate: true };\n                _this.parent.notify(setCellFormat, eventArgs);\n                if (!eventArgs.cancel) {\n                    _this.fontSizeDdb.content = eventArgs.style.fontSize.split('pt')[0];\n                    _this.fontSizeDdb.dataBind();\n                }\n            },\n            close: function () { return _this.parent.element.focus(); }\n        });\n        this.fontSizeDdb.createElement = this.parent.createElement;\n        this.fontSizeDdb.appendTo(this.parent.createElement('button', { id: id + '_font_size' }));\n        return this.fontSizeDdb.element;\n    };\n    // tslint:disable-next-line:max-func-body-length\n    Ribbon.prototype.getChartDBB = function (id) {\n        var _this = this;\n        var l10n = this.parent.serviceLocator.getService(locale);\n        this.chartMenu = new Menu({\n            cssClass: 'e-chart-menu',\n            items: [\n                {\n                    iconCss: 'e-icons e-column', text: l10n.getConstant('Column'),\n                    items: [{ id: 'column_chart' }]\n                },\n                {\n                    iconCss: 'e-icons e-bar', text: l10n.getConstant('Bar'),\n                    items: [{ id: 'bar_chart' }]\n                },\n                {\n                    iconCss: 'e-icons e-area', text: l10n.getConstant('Area'),\n                    items: [{ id: 'area_chart' }]\n                },\n                {\n                    iconCss: 'e-icons e-pie-doughnut', text: l10n.getConstant('PieAndDoughnut'),\n                    items: [{ id: 'pie_doughnut_chart' }]\n                },\n                {\n                    iconCss: 'e-icons e-line', text: l10n.getConstant('Line'),\n                    items: [{ id: 'line_chart' }]\n                },\n                // {\n                //     iconCss: 'e-icons e-radar', text: l10n.getConstant('Radar'),\n                //     items: [{ id: 'radar_chart' }]\n                // },\n                {\n                    iconCss: 'e-icons e-scatter', text: l10n.getConstant('Scatter'),\n                    items: [{ id: 'scatter_chart' }]\n                }\n            ],\n            orientation: 'Vertical',\n            beforeOpen: function (args) {\n                if (args.parentItem.text === l10n.getConstant('Column')) {\n                    args.element.firstChild.appendChild(column);\n                    args.element.parentElement.classList.add('e-column-chart');\n                }\n                else if (args.parentItem.text === l10n.getConstant('Bar')) {\n                    args.element.firstChild.appendChild(bar);\n                    args.element.parentElement.classList.add('e-bar-chart');\n                }\n                else if (args.parentItem.text === l10n.getConstant('Area')) {\n                    args.element.firstChild.appendChild(area);\n                    args.element.parentElement.classList.add('e-area-chart');\n                }\n                else if (args.parentItem.text === l10n.getConstant('Line')) {\n                    args.element.firstChild.appendChild(line);\n                    args.element.parentElement.classList.add('e-line-chart');\n                }\n                else if (args.parentItem.text === l10n.getConstant('PieAndDoughnut')) {\n                    args.element.firstChild.appendChild(pie);\n                    args.element.parentElement.classList.add('e-pie-doughnut-chart');\n                }\n                else if (args.parentItem.text === l10n.getConstant('Radar')) {\n                    args.element.firstChild.appendChild(radar);\n                    args.element.parentElement.classList.add('e-radar-chart');\n                }\n                else if (args.parentItem.text === l10n.getConstant('Scatter')) {\n                    args.element.firstChild.appendChild(scatter);\n                    args.element.parentElement.classList.add('e-scatter-chart');\n                }\n            },\n            select: this.chartSelected.bind(this)\n        });\n        this.chartMenu.createElement = this.parent.createElement;\n        var column = this.parent.createElement('div', { id: 'column_main', className: 'e-column-main' });\n        var column1Text = this.parent.createElement('div', { id: 'column1_text', className: 'e-column1-text', innerHTML: l10n.getConstant('Column') });\n        var column1Cont = this.parent.createElement('div', { id: 'column1_cont', className: 'e-column1-cont' });\n        var column2Text = this.parent.createElement('div', { id: 'column2_text', className: 'e-column2-text' });\n        var column2Cont = this.parent.createElement('div', { id: 'column2_cont', className: 'e-column2-cont' });\n        column.appendChild(column1Text);\n        column.appendChild(column1Cont);\n        //column.appendChild(column2Text);\n        //column.appendChild(column2Cont);\n        var clusteredColumn = this.parent.createElement('span', { id: 'clusteredColumn', className: 'e-clusteredcolumn e-column-icon e-menu-icon e-icons' });\n        var stackedColumn = this.parent.createElement('span', {\n            id: 'stackedColumn', className: 'e-stackedcolumn e-column-icon e-menu-icon e-icons'\n        });\n        var stackedColumn100 = this.parent.createElement('span', {\n            id: 'stackedColumn100', className: 'e-stackedcolumn100 e-column-icon e-menu-icon e-icons'\n        });\n        var clusteredColumn3D = this.parent.createElement('span', {\n            id: 'clusteredColumn3D', className: 'e-clusteredColumn3D e-column-icon'\n        });\n        var stackedColumn3D = this.parent.createElement('span', { id: 'stackedColumn3D', className: 'e-stackedColumn3D e-column-icon' });\n        var stackedColumn1003D = this.parent.createElement('span', { id: 'stackedColumn1003D', className: 'e-stackedColumn1003D e-column-icon' });\n        clusteredColumn.title = l10n.getConstant('ClusteredColumn');\n        stackedColumn.title = l10n.getConstant('StackedColumn');\n        stackedColumn100.title = l10n.getConstant('StackedColumn100');\n        stackedColumn1003D.title = l10n.getConstant('OrangeDataBar');\n        stackedColumn3D.title = l10n.getConstant('LightblueDataBar');\n        clusteredColumn3D.title = l10n.getConstant('PurpleDataBar');\n        column1Cont.appendChild(clusteredColumn);\n        column1Cont.appendChild(stackedColumn);\n        column1Cont.appendChild(stackedColumn100);\n        column2Cont.appendChild(clusteredColumn3D);\n        column2Cont.appendChild(stackedColumn3D);\n        column2Cont.appendChild(stackedColumn1003D);\n        var bar = this.parent.createElement('div', { id: 'bar_main', className: 'e-bar-main' });\n        var bar1Text = this.parent.createElement('div', { id: 'bar1_text', className: 'e-bar1-text', innerHTML: l10n.getConstant('Bar') });\n        var bar1Cont = this.parent.createElement('div', { id: 'bar1_cont', className: 'e-bar1-cont' });\n        var bar2Text = this.parent.createElement('div', { id: 'bar2_text', className: 'e-bar2-text' });\n        var bar2Cont = this.parent.createElement('div', { id: 'bar2_cont', className: 'e-bar2-cont' });\n        bar.appendChild(bar1Text);\n        bar.appendChild(bar1Cont);\n        //bar.appendChild(bar2Text);\n        //bar.appendChild(bar2Cont);\n        var clusteredBar = this.parent.createElement('span', { id: 'clusteredBar', className: 'e-clusteredbar e-bar-icon e-menu-icon e-icons' });\n        var stackedBar = this.parent.createElement('span', { id: 'stackedBar', className: 'e-stackedbar e-bar-icon e-menu-icon e-icons' });\n        var stackedBar100 = this.parent.createElement('span', { id: 'stackedBar100', className: 'e-stackedbar100 e-bar-icon e-menu-icon e-icons' });\n        var clusteredBar3D = this.parent.createElement('span', { id: 'clusteredBar3D', className: 'e-clusteredBar3D e-bar-icon' });\n        var stackedBar3D = this.parent.createElement('span', { id: 'stackedBar3D', className: 'e-stackedBar3D e-bar-icon' });\n        var stackedBar1003D = this.parent.createElement('span', { id: 'stackedBar1003D', className: 'e-stackedBar1003D e-bar-icon' });\n        clusteredBar.title = l10n.getConstant('ClusteredBar');\n        stackedBar.title = l10n.getConstant('StackedBar');\n        stackedBar100.title = l10n.getConstant('StackedBar100');\n        stackedBar1003D.title = l10n.getConstant('OrangeDataBar');\n        stackedBar3D.title = l10n.getConstant('LightblueDataBar');\n        clusteredBar3D.title = l10n.getConstant('PurpleDataBar');\n        bar1Cont.appendChild(clusteredBar);\n        bar1Cont.appendChild(stackedBar);\n        bar1Cont.appendChild(stackedBar100);\n        bar2Cont.appendChild(clusteredBar3D);\n        bar2Cont.appendChild(stackedBar3D);\n        bar2Cont.appendChild(stackedBar1003D);\n        var area = this.parent.createElement('div', { id: 'area_main', className: 'e-area-main' });\n        var areaText = this.parent.createElement('div', { id: 'area_text', className: 'e-area-text', innerHTML: l10n.getConstant('Area') });\n        var areaCont = this.parent.createElement('div', { id: 'area_cont', className: 'e-area-cont' });\n        area.appendChild(areaText);\n        area.appendChild(areaCont);\n        var defArea = this.parent.createElement('span', { id: 'area', className: 'e-area e-area-icon e-menu-icon e-icons' });\n        var stackedArea = this.parent.createElement('span', { id: 'stackedArea', className: 'e-stackedarea e-area-icon e-menu-icon e-icons' });\n        var stackedArea100 = this.parent.createElement('span', { id: 'stackedArea100', className: 'e-stackedarea100 e-area-icon e-menu-icon e-icons' });\n        defArea.title = l10n.getConstant('Area');\n        stackedArea.title = l10n.getConstant('StackedArea');\n        stackedArea100.title = l10n.getConstant('StackedArea100');\n        areaCont.appendChild(defArea);\n        areaCont.appendChild(stackedArea);\n        areaCont.appendChild(stackedArea100);\n        var line = this.parent.createElement('div', { id: 'line_main', className: 'e-line-main' });\n        var lineText = this.parent.createElement('div', { id: 'line_text', className: 'e-line-text', innerHTML: l10n.getConstant('Line') });\n        var lineCont = this.parent.createElement('div', { id: 'line_cont', className: 'e-line-cont' });\n        line.appendChild(lineText);\n        line.appendChild(lineCont);\n        var defLine = this.parent.createElement('span', { id: 'line', className: 'e-line e-line-icon e-menu-icon e-icons' });\n        var stackedLine = this.parent.createElement('span', { id: 'stackedLine', className: 'e-stackedline e-line-icon e-menu-icon e-icons' });\n        var stackedLine100 = this.parent.createElement('span', {\n            id: 'stackedline100', className: 'e-stackedline100 e-line-icon e-menu-icon e-icons'\n        });\n        defLine.title = l10n.getConstant('Line');\n        stackedLine.title = l10n.getConstant('StackedLine');\n        stackedLine100.title = l10n.getConstant('StackedLine100');\n        lineCont.appendChild(defLine);\n        lineCont.appendChild(stackedLine);\n        lineCont.appendChild(stackedLine100);\n        var pie = this.parent.createElement('div', { id: 'pie_main', className: 'e-pie-main' });\n        var pieText = this.parent.createElement('div', { id: 'pie_text', className: 'e-pie-text', innerHTML: l10n.getConstant('Pie') });\n        var pieCont = this.parent.createElement('div', { id: 'pie_cont', className: 'e-pie-cont' });\n        pie.appendChild(pieText);\n        pie.appendChild(pieCont);\n        var defPie = this.parent.createElement('span', { id: 'pie', className: 'e-pie e-pie-icon e-menu-icon e-icons' });\n        var doughnut = this.parent.createElement('span', { id: 'doughnut', className: 'e-doughnut e-pie-icon e-menu-icon e-icons' });\n        defPie.title = l10n.getConstant('Pie');\n        doughnut.title = l10n.getConstant('Doughnut');\n        pieCont.appendChild(defPie);\n        pieCont.appendChild(doughnut);\n        var radar = this.parent.createElement('div', { id: 'radar_main', className: 'e-radar-main' });\n        var radarText = this.parent.createElement('div', { id: 'radar_text', className: 'e-radar-text', innerHTML: 'Radar' });\n        var radarCont = this.parent.createElement('div', { id: 'radar_cont', className: 'e-radar-cont' });\n        radar.appendChild(radarText);\n        radar.appendChild(radarCont);\n        var defradar = this.parent.createElement('span', { id: 'radar', className: 'e-radar e-radar-icon e-menu-icon e-icons' });\n        var radarMarkers = this.parent.createElement('span', { id: 'radar_markers', className: 'e-radar-markers e-radar-icon e-menu-icon e-icons' });\n        defradar.title = l10n.getConstant('BlueDataBar');\n        radarMarkers.title = l10n.getConstant('GreenDataBar');\n        radarCont.appendChild(defradar);\n        radarCont.appendChild(radarMarkers);\n        var scatter = this.parent.createElement('div', { id: 'scatter_main', className: 'e-scatter-main' });\n        var scatterText = this.parent.createElement('div', { id: 'scatter_text', className: 'e-scatter-text', innerHTML: l10n.getConstant('Scatter') });\n        var scatterCont = this.parent.createElement('div', { id: 'scatter_cont', className: 'e-scatter-cont' });\n        scatter.appendChild(scatterText);\n        scatter.appendChild(scatterCont);\n        var defscatter = this.parent.createElement('span', { id: 'scatter', className: 'e-scatter e-scatter-icon e-menu-icon e-icons' });\n        defscatter.title = l10n.getConstant('Scatter');\n        scatterCont.appendChild(defscatter);\n        var ul = this.parent.element.appendChild(this.parent.createElement('ul', {\n            id: id + '_chart_menu', styles: 'display: none;'\n        }));\n        this.chartMenu.appendTo(ul);\n        ul.classList.add('e-ul');\n        this.chartDdb = new DropDownButton({\n            iconCss: 'e-icons e-chart-icon',\n            cssClass: 'e-chart-ddb',\n            target: this.chartMenu.element.parentElement,\n            created: function () { _this.chartMenu.element.style.display = ''; },\n            beforeClose: function (args) {\n                if (args.event && closest(args.event.target, '.e-chart-ddb')) {\n                    args.cancel = true;\n                }\n            },\n            close: function () { return _this.parent.element.focus(); }\n        });\n        this.chartDdb.createElement = this.parent.createElement;\n        var chartBtn = this.parent.createElement('button', { id: id + '_chart-btn' });\n        chartBtn.appendChild(this.parent.createElement('span', { id: id + '_chart', innerHTML: 'Chart' }));\n        this.chartDdb.appendTo(chartBtn);\n        return this.chartDdb.element;\n    };\n    // tslint:disable-next-line:max-func-body-length\n    Ribbon.prototype.getCFDBB = function (id) {\n        var _this = this;\n        var l10n = this.parent.serviceLocator.getService(locale);\n        this.cFMenu = new Menu({\n            cssClass: 'e-cf-menu',\n            items: [{\n                    iconCss: 'e-icons e-hlcellrules', text: l10n.getConstant('HighlightCellsRules'),\n                    items: [{ iconCss: 'e-icons e-greaterthan', id: 'cf_greaterthan', text: l10n.getConstant('GreaterThan') + '...' },\n                        { iconCss: 'e-icons e-lessthan', id: 'cf_lessthan', text: l10n.getConstant('LessThan') + '...' },\n                        { iconCss: 'e-icons e-between', id: 'cf_between', text: l10n.getConstant('Between') + '...' },\n                        { iconCss: 'e-icons e-equalto', id: 'cf_eqaulto', text: l10n.getConstant('CFEqualTo') + '...' }, {\n                            iconCss: 'e-icons e-textcontains', id: 'cf_textthatcontains',\n                            text: l10n.getConstant('TextThatContains') + '...'\n                        }, { iconCss: 'e-icons e-adateoccuring', id: 'cf_adateoccuring', text: l10n.getConstant('ADateOccuring') + '...' }, {\n                            iconCss: 'e-icons e-duplicate', id: 'cf_duplicatevalues',\n                            text: l10n.getConstant('DuplicateValues') + '...'\n                        }]\n                },\n                {\n                    iconCss: 'e-icons e-topbottomrules', text: l10n.getConstant('TopBottomRules'),\n                    items: [{ iconCss: 'e-icons e-top10items', id: 'cf_top10items', text: l10n.getConstant('Top10Items') + '...' },\n                        { iconCss: 'e-icons e-top10', id: 'cf_top10', text: l10n.getConstant('Top10') + ' %...' },\n                        { iconCss: 'e-icons e-bottom10items', id: 'cf_bottom10items', text: l10n.getConstant('Bottom10Items') + '...' },\n                        { iconCss: 'e-icons e-bottom10', id: 'cf_bottom10', text: l10n.getConstant('Bottom10') + ' %...' },\n                        { iconCss: 'e-icons e-aboveaverage', id: 'cf_aboveaverage', text: l10n.getConstant('AboveAverage') + '...' },\n                        { iconCss: 'e-icons e-belowaverage', id: 'cf_belowaverage', text: l10n.getConstant('BelowAverage') + '...' }]\n                },\n                {\n                    iconCss: 'e-icons e-databars', text: l10n.getConstant('DataBars'),\n                    items: [{ id: 'cf_databars' }]\n                },\n                {\n                    iconCss: 'e-icons e-colorscales', text: l10n.getConstant('ColorScales'),\n                    items: [{ id: 'cf_colorscales' }]\n                },\n                {\n                    iconCss: 'e-icons e-iconsets', text: l10n.getConstant('IconSets'),\n                    items: [{ id: 'cf_iconsets' }]\n                },\n                {\n                    iconCss: 'e-icons e-clearrules', text: l10n.getConstant('ClearRules'),\n                    items: [{ id: 'cf_cr_cells', text: l10n.getConstant('SelectedCells') },\n                        { id: 'cf_cr_sheet', text: l10n.getConstant('EntireSheet') }]\n                }],\n            orientation: 'Vertical',\n            beforeOpen: function (args) {\n                if (args.parentItem.text === l10n.getConstant('DataBars')) {\n                    args.element.firstChild.appendChild(dataBars);\n                    args.element.parentElement.classList.add('e-databars');\n                }\n                else if (args.parentItem.text === l10n.getConstant('ColorScales')) {\n                    args.element.firstChild.appendChild(colorScales);\n                    args.element.parentElement.classList.add('e-colorscales');\n                }\n                else if (args.parentItem.text === l10n.getConstant('IconSets')) {\n                    args.element.firstChild.appendChild(iconSets);\n                    args.element.parentElement.classList.add('e-iconsets');\n                }\n            },\n            select: this.cFSelected.bind(this)\n        });\n        var dataBars = this.parent.createElement('div', { id: 'db', className: 'e-db' });\n        var db1 = this.parent.createElement('div', { id: 'db1', className: 'e-db1' });\n        var db2 = this.parent.createElement('div', { id: 'db2', className: 'e-db2' });\n        dataBars.appendChild(db1);\n        dataBars.appendChild(db2);\n        var bBar = this.parent.createElement('span', { id: 'BlueDataBar', className: 'e-bdatabar e-databar-icon' });\n        var gBar = this.parent.createElement('span', { id: 'GreenDataBar', className: 'e-gdatabar e-databar-icon' });\n        var rBar = this.parent.createElement('span', { id: 'RedDataBar', className: 'e-rdatabar e-databar-icon' });\n        var oBar = this.parent.createElement('span', { id: 'OrangeDataBar', className: 'e-odatabar e-databar-icon' });\n        var lBBar = this.parent.createElement('span', { id: 'LightBlueDataBar', className: 'e-lbdatabar e-databar-icon' });\n        var pBar = this.parent.createElement('span', { id: 'PurpleDataBar', className: 'e-pdatabar e-databar-icon' });\n        bBar.title = l10n.getConstant('BlueDataBar');\n        gBar.title = l10n.getConstant('GreenDataBar');\n        rBar.title = l10n.getConstant('RedDataBar');\n        oBar.title = l10n.getConstant('OrangeDataBar');\n        lBBar.title = l10n.getConstant('LightblueDataBar');\n        pBar.title = l10n.getConstant('PurpleDataBar');\n        db1.appendChild(bBar);\n        db1.appendChild(gBar);\n        db1.appendChild(rBar);\n        db2.appendChild(oBar);\n        db2.appendChild(lBBar);\n        db2.appendChild(pBar);\n        this.cFMenu.createElement = this.parent.createElement;\n        var colorScales = this.parent.createElement('div', { id: 'db', className: 'e-cs' });\n        var cs1 = this.parent.createElement('div', { id: 'cs1', className: 'e-cs1' });\n        var cs2 = this.parent.createElement('div', { id: 'cs2', className: 'e-cs2' });\n        var cs3 = this.parent.createElement('div', { id: 'cs3', className: 'e-cs3' });\n        colorScales.appendChild(cs1);\n        colorScales.appendChild(cs2);\n        colorScales.appendChild(cs3);\n        var gyr = this.parent.createElement('span', { id: 'GYRColorScale', className: 'e-gyr e-colorscale-icon' });\n        var ryg = this.parent.createElement('span', { id: 'RYGColorScale', className: 'e-ryg e-colorscale-icon' });\n        var gwr = this.parent.createElement('span', { id: 'GWRColorScale', className: 'e-gwr e-colorscale-icon' });\n        var rwg = this.parent.createElement('span', { id: 'RWGColorScale', className: 'e-rwg e-colorscale-icon' });\n        var bwr = this.parent.createElement('span', { id: 'BWRColorScale', className: 'e-bwr e-colorscale-icon' });\n        var rwb = this.parent.createElement('span', { id: 'RWBColorScale', className: 'e-rwb e-colorscale-icon' });\n        var wr = this.parent.createElement('span', { id: 'WRColorScale', className: 'e-wr e-colorscale-icon' });\n        var rw = this.parent.createElement('span', { id: 'RWColorScale', className: 'e-rw e-colorscale-icon' });\n        var gw = this.parent.createElement('span', { id: 'GWColorScale', className: 'e-gw e-colorscale-icon' });\n        var wg = this.parent.createElement('span', { id: 'WGColorScale', className: 'e-wg e-colorscale-icon' });\n        var gy = this.parent.createElement('span', { id: 'GYColorScale', className: 'e-gy e-colorscale-icon' });\n        var yg = this.parent.createElement('span', { id: 'YGColorScale', className: 'e-yg e-colorscale-icon' });\n        gyr.title = l10n.getConstant('GYRColorScale');\n        ryg.title = l10n.getConstant('RYGColorScale');\n        gwr.title = l10n.getConstant('GWRColorScale');\n        rwg.title = l10n.getConstant('RWGColorScale');\n        bwr.title = l10n.getConstant('BWRColorScale');\n        rwb.title = l10n.getConstant('RWBColorScale');\n        wr.title = l10n.getConstant('WRColorScale');\n        rw.title = l10n.getConstant('RWColorScale');\n        gw.title = l10n.getConstant('GWColorScale');\n        wg.title = l10n.getConstant('WGColorScale');\n        gy.title = l10n.getConstant('GYColorScale');\n        yg.title = l10n.getConstant('YGColorScale');\n        cs1.appendChild(gyr);\n        cs1.appendChild(ryg);\n        cs1.appendChild(gwr);\n        cs1.appendChild(rwg);\n        cs2.appendChild(bwr);\n        cs2.appendChild(rwb);\n        cs2.appendChild(wr);\n        cs2.appendChild(rw);\n        cs3.appendChild(gw);\n        cs3.appendChild(wg);\n        cs3.appendChild(gy);\n        cs3.appendChild(yg);\n        var iconSets = this.parent.createElement('div', { id: 'is', className: 'e-is' });\n        var is1 = this.parent.createElement('div', { id: 'is1', className: 'e-is1', innerHTML: 'Directional' });\n        var is2 = this.parent.createElement('div', { id: 'is2', className: 'e-is2' });\n        var is3 = this.parent.createElement('div', { id: 'is3', className: 'e-is3', innerHTML: 'Shapes' });\n        var is4 = this.parent.createElement('div', { id: 'is4', className: 'e-is4' });\n        var is5 = this.parent.createElement('div', { id: 'is5', className: 'e-is5', innerHTML: 'Indicators' });\n        var is6 = this.parent.createElement('div', { id: 'is6', className: 'e-is6' });\n        var is7 = this.parent.createElement('div', { id: 'is7', className: 'e-is7', innerHTML: 'Ratings' });\n        var is8 = this.parent.createElement('div', { id: 'is8', className: 'e-is8' });\n        is1.title = l10n.getConstant('GYColorScale');\n        is2.title = l10n.getConstant('YGColorScale');\n        is3.title = l10n.getConstant('GYColorScale');\n        is4.title = l10n.getConstant('YGColorScale');\n        is5.title = l10n.getConstant('GYColorScale');\n        is6.title = l10n.getConstant('YGColorScale');\n        is7.title = l10n.getConstant('GYColorScale');\n        is8.title = l10n.getConstant('YGColorScale');\n        iconSets.appendChild(is1);\n        iconSets.appendChild(is2);\n        iconSets.appendChild(is3);\n        iconSets.appendChild(is4);\n        iconSets.appendChild(is5);\n        iconSets.appendChild(is6);\n        iconSets.appendChild(is7);\n        iconSets.appendChild(is8);\n        var directional1 = this.parent.createElement('div', { id: 'ThreeArrows', className: 'e-3arrows e-is-wrapper' });\n        var directional2 = this.parent.createElement('div', { id: 'ThreeArrowsGray', className: 'e-3arrowsgray e-is-wrapper' });\n        var directional3 = this.parent.createElement('div', { id: 'ThreeTriangles', className: 'e-3triangles e-is-wrapper' });\n        var directional4 = this.parent.createElement('div', { id: 'FourArrowsGray', className: 'e-4arrowsgray e-is-wrapper' });\n        var directional5 = this.parent.createElement('div', { id: 'FourArrows', className: 'e-4arrows e-is-wrapper' });\n        var directional6 = this.parent.createElement('div', { id: 'FiveArrowsGray', className: 'e-5arrowsgray e-is-wrapper' });\n        var directional7 = this.parent.createElement('div', { id: 'FiveArrows', className: 'e-5arrows e-is-wrapper' });\n        directional1.title = l10n.getConstant('ThreeArrowsColor');\n        directional2.title = l10n.getConstant('ThreeArrowsGray');\n        directional3.title = l10n.getConstant('ThreeTriangles');\n        directional4.title = l10n.getConstant('FourArrowsColor');\n        directional5.title = l10n.getConstant('FourArrowsGray');\n        directional6.title = l10n.getConstant('FiveArrowsColor');\n        directional7.title = l10n.getConstant('FiveArrowsGray');\n        is2.appendChild(directional1);\n        is2.appendChild(directional2);\n        is2.appendChild(directional3);\n        is2.appendChild(directional4);\n        is2.appendChild(directional5);\n        is2.appendChild(directional6);\n        is2.appendChild(directional7);\n        var shapes1 = this.parent.createElement('div', { id: 'ThreeTrafficLights1', className: 'e-3trafficlights e-is-wrapper' });\n        var shapes2 = this.parent.createElement('div', { id: 'ThreeTrafficLights2', className: 'e-3rafficlights2 e-is-wrapper' });\n        var shapes3 = this.parent.createElement('div', { id: 'ThreeSigns', className: 'e-3signs e-is-wrapper' });\n        var shapes4 = this.parent.createElement('div', { id: 'FourTrafficLights', className: 'e-4trafficlights e-is-wrapper' });\n        var shapes5 = this.parent.createElement('div', { id: 'FourRedToBlack', className: 'e-4redtoblack e-is-wrapper' });\n        shapes1.title = l10n.getConstant('ThreeTrafficLights1');\n        shapes2.title = l10n.getConstant('ThreeTrafficLights2');\n        shapes3.title = l10n.getConstant('ThreeSigns');\n        shapes4.title = l10n.getConstant('FourTrafficLights');\n        shapes5.title = l10n.getConstant('RedToBlack');\n        is4.appendChild(shapes1);\n        is4.appendChild(shapes2);\n        is4.appendChild(shapes3);\n        is4.appendChild(shapes4);\n        is4.appendChild(shapes5);\n        var indicators1 = this.parent.createElement('div', { id: 'ThreeSymbols', className: 'e-3symbols e-is-wrapper' });\n        var indicators2 = this.parent.createElement('div', { id: 'ThreeSymbols2', className: 'e-3symbols2 e-is-wrapper' });\n        var indicators3 = this.parent.createElement('div', { id: 'ThreeFlags', className: 'e-3flags e-is-wrapper' });\n        indicators1.title = l10n.getConstant('ThreeSymbols1');\n        indicators2.title = l10n.getConstant('ThreeSymbols2');\n        indicators3.title = l10n.getConstant('ThreeFlags');\n        is6.appendChild(indicators1);\n        is6.appendChild(indicators2);\n        is6.appendChild(indicators3);\n        var ratings1 = this.parent.createElement('div', { id: 'ThreeStars', className: 'e-3stars e-is-wrapper' });\n        var ratings2 = this.parent.createElement('div', { id: 'FourRating', className: 'e-4rating e-is-wrapper' });\n        var ratings3 = this.parent.createElement('div', { id: 'FiveQuarters', className: 'e-5quarters e-is-wrapper' });\n        var ratings4 = this.parent.createElement('div', { id: 'FiveRating', className: 'e-5rating e-is-wrapper' });\n        var ratings5 = this.parent.createElement('div', { id: 'FiveBoxes', className: 'e-5boxes e-is-wrapper' });\n        ratings1.title = l10n.getConstant('ThreeStars');\n        ratings2.title = l10n.getConstant('FourRatings');\n        ratings3.title = l10n.getConstant('FiveQuarters');\n        ratings4.title = l10n.getConstant('FiveRatings');\n        ratings5.title = l10n.getConstant('FiveBoxes');\n        is8.appendChild(ratings1);\n        is8.appendChild(ratings2);\n        is8.appendChild(ratings3);\n        is8.appendChild(ratings4);\n        is8.appendChild(ratings5);\n        directional1.appendChild(this.createElement('span', 'e-3arrows-1 e-iconsetspan'));\n        directional1.appendChild(this.createElement('span', 'e-3arrows-2 e-iconsetspan'));\n        directional1.appendChild(this.createElement('span', 'e-3arrows-3 e-iconsetspan'));\n        directional2.appendChild(this.createElement('span', 'e-3arrowsgray-1 e-iconsetspan'));\n        directional2.appendChild(this.createElement('span', 'e-3arrowsgray-2 e-iconsetspan'));\n        directional2.appendChild(this.createElement('span', 'e-3arrowsgray-3 e-iconsetspan'));\n        directional3.appendChild(this.createElement('span', 'e-3triangles-1 e-iconsetspan'));\n        directional3.appendChild(this.createElement('span', 'e-3triangles-2 e-iconsetspan'));\n        directional3.appendChild(this.createElement('span', 'e-3triangles-3 e-iconsetspan'));\n        directional4.appendChild(this.createElement('span', 'e-4arrowsgray-1 e-iconsetspan'));\n        directional4.appendChild(this.createElement('span', 'e-4arrowsgray-2 e-iconsetspan'));\n        directional4.appendChild(this.createElement('span', 'e-4arrowsgray-3 e-iconsetspan'));\n        directional4.appendChild(this.createElement('span', 'e-4arrowsgray-4 e-iconsetspan'));\n        directional5.appendChild(this.createElement('span', 'e-4arrows-1 e-iconsetspan'));\n        directional5.appendChild(this.createElement('span', 'e-4arrows-2 e-iconsetspan'));\n        directional5.appendChild(this.createElement('span', 'e-4arrows-3 e-iconsetspan'));\n        directional5.appendChild(this.createElement('span', 'e-4arrows-4 e-iconsetspan'));\n        directional6.appendChild(this.createElement('span', 'e-5arrowsgray-1 e-iconsetspan'));\n        directional6.appendChild(this.createElement('span', 'e-5arrowsgray-2 e-iconsetspan'));\n        directional6.appendChild(this.createElement('span', 'e-5arrowsgray-3 e-iconsetspan'));\n        directional6.appendChild(this.createElement('span', 'e-5arrowsgray-4 e-iconsetspan'));\n        directional6.appendChild(this.createElement('span', 'e-5arrowsgray-5 e-iconsetspan'));\n        directional7.appendChild(this.createElement('span', 'e-5arrows-1 e-iconsetspan'));\n        directional7.appendChild(this.createElement('span', 'e-5arrows-2 e-iconsetspan'));\n        directional7.appendChild(this.createElement('span', 'e-5arrows-3 e-iconsetspan'));\n        directional7.appendChild(this.createElement('span', 'e-5arrows-4 e-iconsetspan'));\n        directional7.appendChild(this.createElement('span', 'e-5arrows-5 e-iconsetspan'));\n        shapes1.appendChild(this.createElement('span', 'e-3trafficlights-1 e-iconsetspan'));\n        shapes1.appendChild(this.createElement('span', 'e-3trafficlights-2 e-iconsetspan'));\n        shapes1.appendChild(this.createElement('span', 'e-3trafficlights-3 e-iconsetspan'));\n        shapes2.appendChild(this.createElement('span', 'e-3rafficlights2-1 e-iconsetspan'));\n        shapes2.appendChild(this.createElement('span', 'e-3rafficlights2-2 e-iconsetspan'));\n        shapes2.appendChild(this.createElement('span', 'e-3rafficlights2-3 e-iconsetspan'));\n        shapes3.appendChild(this.createElement('span', 'e-3signs-1 e-iconsetspan'));\n        shapes3.appendChild(this.createElement('span', 'e-3signs-2 e-iconsetspan'));\n        shapes3.appendChild(this.createElement('span', 'e-3signs-3 e-iconsetspan'));\n        shapes4.appendChild(this.createElement('span', 'e-4trafficlights-1 e-iconsetspan'));\n        shapes4.appendChild(this.createElement('span', 'e-4trafficlights-2 e-iconsetspan'));\n        shapes4.appendChild(this.createElement('span', 'e-4trafficlights-3 e-iconsetspan'));\n        shapes4.appendChild(this.createElement('span', 'e-4trafficlights-4 e-iconsetspan'));\n        shapes5.appendChild(this.createElement('span', 'e-4redtoblack-1 e-iconsetspan'));\n        shapes5.appendChild(this.createElement('span', 'e-4redtoblack-2 e-iconsetspan'));\n        shapes5.appendChild(this.createElement('span', 'e-4redtoblack-3 e-iconsetspan'));\n        shapes5.appendChild(this.createElement('span', 'e-4redtoblack-4 e-iconsetspan'));\n        indicators1.appendChild(this.createElement('span', 'e-3symbols-1 e-iconsetspan'));\n        indicators1.appendChild(this.createElement('span', 'e-3symbols-2 e-iconsetspan'));\n        indicators1.appendChild(this.createElement('span', 'e-3symbols-3 e-iconsetspan'));\n        indicators2.appendChild(this.createElement('span', 'e-3symbols2-1 e-iconsetspan'));\n        indicators2.appendChild(this.createElement('span', 'e-3symbols2-2 e-iconsetspan'));\n        indicators2.appendChild(this.createElement('span', 'e-3symbols2-3 e-iconsetspan'));\n        indicators3.appendChild(this.createElement('span', 'e-3flags-1 e-iconsetspan'));\n        indicators3.appendChild(this.createElement('span', 'e-3flags-2 e-iconsetspan'));\n        indicators3.appendChild(this.createElement('span', 'e-3flags-3 e-iconsetspan'));\n        ratings1.appendChild(this.createElement('span', 'e-3stars-1 e-iconsetspan'));\n        ratings1.appendChild(this.createElement('span', 'e-3stars-2 e-iconsetspan'));\n        ratings1.appendChild(this.createElement('span', 'e-3stars-3 e-iconsetspan'));\n        ratings2.appendChild(this.createElement('span', 'e-4rating-1 e-iconsetspan'));\n        ratings2.appendChild(this.createElement('span', 'e-4rating-2 e-iconsetspan'));\n        ratings2.appendChild(this.createElement('span', 'e-4rating-3 e-iconsetspan'));\n        ratings2.appendChild(this.createElement('span', 'e-4rating-4 e-iconsetspan'));\n        ratings3.appendChild(this.createElement('span', 'e-5quarters-1 e-iconsetspan'));\n        ratings3.appendChild(this.createElement('span', 'e-5quarters-2 e-iconsetspan'));\n        ratings3.appendChild(this.createElement('span', 'e-5quarters-3 e-iconsetspan'));\n        ratings3.appendChild(this.createElement('span', 'e-5quarters-4 e-iconsetspan'));\n        ratings3.appendChild(this.createElement('span', 'e-5quarters-5 e-iconsetspan'));\n        ratings4.appendChild(this.createElement('span', 'e-5rating-1 e-iconsetspan'));\n        ratings4.appendChild(this.createElement('span', 'e-5rating-2 e-iconsetspan'));\n        ratings4.appendChild(this.createElement('span', 'e-5rating-3 e-iconsetspan'));\n        ratings4.appendChild(this.createElement('span', 'e-5rating-4 e-iconsetspan'));\n        ratings4.appendChild(this.createElement('span', 'e-5rating-5 e-iconsetspan'));\n        ratings5.appendChild(this.createElement('span', 'e-5boxes-1 e-iconsetspan'));\n        ratings5.appendChild(this.createElement('span', 'e-5boxes-2 e-iconsetspan'));\n        ratings5.appendChild(this.createElement('span', 'e-5boxes-3 e-iconsetspan'));\n        ratings5.appendChild(this.createElement('span', 'e-5boxes-4 e-iconsetspan'));\n        ratings5.appendChild(this.createElement('span', 'e-5boxes-5 e-iconsetspan'));\n        var ul = this.parent.element.appendChild(this.parent.createElement('ul', {\n            id: id + '_cf_menu', styles: 'display: none;'\n        }));\n        this.cFMenu.appendTo(ul);\n        ul.classList.add('e-ul');\n        this.cFDdb = new DropDownButton({\n            iconCss: 'e-icons e-conditionalformatting-icon',\n            cssClass: 'e-cf-ddb',\n            target: this.cFMenu.element.parentElement,\n            created: function () { _this.cFMenu.element.style.display = ''; },\n            beforeClose: function (args) {\n                if (args.event && closest(args.event.target, '.e-cf-ddb')) {\n                    args.cancel = true;\n                }\n            },\n            close: function () { return _this.parent.element.focus(); }\n        });\n        this.cFDdb.createElement = this.parent.createElement;\n        this.cFDdb.appendTo(this.parent.createElement('button', { id: id + '_conditionalformatting' }));\n        return this.cFDdb.element;\n    };\n    Ribbon.prototype.createElement = function (tag, className, id) {\n        return this.parent.createElement(tag, { className: className });\n    };\n    Ribbon.prototype.getBordersDBB = function (id) {\n        var _this = this;\n        var cPickerWrapper;\n        var l10n = this.parent.serviceLocator.getService(locale);\n        this.bordersMenu = new Menu({\n            cssClass: 'e-borders-menu',\n            items: [{ iconCss: 'e-icons e-top-borders', text: l10n.getConstant('TopBorders') }, {\n                    iconCss: 'e-icons e-left-borders',\n                    text: l10n.getConstant('LeftBorders')\n                }, { iconCss: 'e-icons e-right-borders', text: l10n.getConstant('RightBorders') }, {\n                    iconCss: 'e-icons e-bottom-borders', text: l10n.getConstant('BottomBorders')\n                }, {\n                    iconCss: 'e-icons e-all-borders', text: l10n.getConstant('AllBorders')\n                }, { iconCss: 'e-icons e-horizontal-borders', text: l10n.getConstant('HorizontalBorders') }, {\n                    iconCss: 'e-icons e-vertical-borders', text: l10n.getConstant('VerticalBorders')\n                }, {\n                    iconCss: 'e-icons e-outside-borders',\n                    text: l10n.getConstant('OutsideBorders')\n                }, { iconCss: 'e-icons e-inside-borders', text: l10n.getConstant('InsideBorders') },\n                { iconCss: 'e-icons e-no-borders', text: l10n.getConstant('NoBorders') }, { separator: true }, {\n                    text: l10n.getConstant('BorderColor'), items: [{ id: id + \"_border_colors\" }]\n                }, {\n                    text: l10n.getConstant('BorderStyle'), items: [\n                        { iconCss: 'e-icons e-selected-icon', id: id + \"_1px\" }, { id: id + \"_2px\" },\n                        { id: id + \"_3px\" }, { id: id + \"_dashed\" },\n                        { id: id + \"_dotted\" }, { id: id + \"_double\" }\n                    ]\n                }],\n            orientation: 'Vertical',\n            beforeOpen: function (args) {\n                if (args.parentItem.text === 'Border Color') {\n                    _this.colorPicker.refresh();\n                    cPickerWrapper = _this.colorPicker.element.parentElement;\n                    args.element.firstElementChild.appendChild(cPickerWrapper);\n                    cPickerWrapper.style.display = 'inline-block';\n                    args.element.parentElement.classList.add('e-border-color');\n                }\n                else {\n                    args.element.classList.add('e-border-style');\n                }\n            },\n            beforeClose: function (args) {\n                if (args.parentItem.text === 'Border Color') {\n                    if (!closest(args.event.target, '.e-border-colorpicker') ||\n                        closest(args.event.target, '.e-apply') || closest(args.event.target, '.e-cancel')) {\n                        _this.colorPicker = getComponent(cPickerEle, 'colorpicker');\n                        if (_this.colorPicker.mode === 'Picker') {\n                            _this.colorPicker.mode = 'Palette';\n                            _this.colorPicker.dataBind();\n                        }\n                        cPickerWrapper.style.display = '';\n                        _this.parent.element.appendChild(cPickerWrapper);\n                    }\n                    else {\n                        args.cancel = true;\n                    }\n                }\n            },\n            onOpen: function (args) {\n                if (args.parentItem.text === 'Border Color') {\n                    args.element.parentElement.style.overflow = 'visible';\n                }\n            },\n            select: this.borderSelected.bind(this)\n        });\n        this.bordersMenu.createElement = this.parent.createElement;\n        var ul = this.parent.element.appendChild(this.parent.createElement('ul', {\n            id: id + '_borders_menu', styles: 'display: none;'\n        }));\n        this.bordersMenu.appendTo(ul);\n        ul.classList.add('e-ul');\n        var cPickerEle = this.parent.createElement('input', { id: id + \"_cell_border_color\", attrs: { 'type': 'color' } });\n        this.parent.element.appendChild(cPickerEle);\n        this.colorPicker = new ColorPicker({\n            cssClass: 'e-border-colorpicker',\n            mode: 'Palette',\n            inline: true,\n            change: function (args) {\n                var border = _this.border.split(' ');\n                border[2] = args.currentValue.hex;\n                _this.border = border.join(' ');\n            },\n            created: function () { cPickerWrapper = _this.colorPicker.element.parentElement; }\n        });\n        this.colorPicker.createElement = this.parent.createElement;\n        this.colorPicker.appendTo(cPickerEle);\n        this.bordersDdb = new DropDownButton({\n            iconCss: 'e-icons e-bottom-borders',\n            cssClass: 'e-borders-ddb',\n            target: this.bordersMenu.element.parentElement,\n            created: function () { _this.bordersMenu.element.style.display = ''; },\n            beforeOpen: function (args) { return _this.tBarDdbBeforeOpen(args.element.firstElementChild, _this.bordersMenu.items, 1); },\n            beforeClose: function (args) {\n                if (args.event && closest(args.event.target, '.e-borders-menu')) {\n                    args.cancel = true;\n                }\n            },\n            close: function () { return _this.parent.element.focus(); }\n        });\n        this.bordersDdb.createElement = this.parent.createElement;\n        this.bordersDdb.appendTo(this.parent.createElement('button', { id: id + '_borders' }));\n        return this.bordersDdb.element;\n    };\n    Ribbon.prototype.chartSelected = function (args) {\n        var eleId = args.element.id;\n        if (('column_chart' + 'bar_chart' + 'area_chart' + 'pie_doughnut_chart' +\n            'line_chart' + 'radar_chart' + 'scatter_chart').includes(eleId)) {\n            var id = args.event.target.id;\n            this.parent.notify(insertChart, { action: eleId, id: id });\n        }\n    };\n    Ribbon.prototype.cFSelected = function (args) {\n        var eleId = args.element.id;\n        if (('cf_greaterthan' + 'cf_lessthan' + 'cf_between' + 'cf_eqaulto' + 'cf_textthatcontains' +\n            'cf_adateoccuring' + 'cf_duplicatevalues' + 'cf_top10items' + 'cf_top10' + 'cf_bottom10items' +\n            'cf_bottom10' + 'cf_aboveaverage' + 'cf_belowaverage').includes(eleId)) {\n            this.parent.notify(initiateConditionalFormat, { action: args.item.text });\n        }\n        else if (('cf_databars' + 'cf_colorscales').includes(eleId)) {\n            var id = args.event.target.id;\n            this.parent.notify(setCF, { action: eleId, id: id });\n        }\n        else if ('cf_iconsets' === args.element.id) {\n            var target = args.event.target;\n            var iconName = (target.id === '') ? target.parentElement.id : target.id;\n            this.parent.notify(setCF, { action: eleId, id: iconName });\n        }\n        if (eleId === 'cf_cr_cells') {\n            this.parent.notify(clearCFRule, { range: this.parent.getActiveSheet().selectedRange, isPublic: false });\n        }\n        else if (eleId === 'cf_cr_sheet') {\n            var sheet = this.parent.getActiveSheet();\n            var range = getRangeAddress([0, 0, sheet.rowCount - 1, sheet.colCount - 1]);\n            this.parent.conditionalFormat = null;\n            this.parent.notify(clearCFRule, { range: range, isPublic: false });\n        }\n    };\n    Ribbon.prototype.borderSelected = function (args) {\n        if (args.item.items.length || args.item.id === this.parent.element.id + \"_border_colors\") {\n            return;\n        }\n        if (!args.item.text) {\n            var id = this.parent.element.id;\n            var border = this.border.split(' ');\n            var prevStyleId_1 = border[1] === 'solid' ? id + \"_\" + border[0] : id + \"_\" + border[1];\n            if (prevStyleId_1 === args.item.id) {\n                return;\n            }\n            if (args.item.id === id + \"_1px\" || args.item.id === id + \"_2px\" || args.item.id === id + \"_3px\") {\n                border[0] = args.item.id.split(id + \"_\")[1];\n                border[1] = 'solid';\n            }\n            else {\n                border[1] = args.item.id.split(id + \"_\")[1];\n                border[0] = border[1] === 'double' ? '3px' : '1px';\n            }\n            this.border = border.join(' ');\n            this.bordersMenu.items[12].items.forEach(function (item) {\n                if (item.id === prevStyleId_1) {\n                    item.iconCss = null;\n                }\n                if (item.id === args.item.id) {\n                    item.iconCss = 'e-icons e-selected-icon';\n                }\n            });\n            this.bordersMenu.setProperties({ 'items': this.bordersMenu.items }, true);\n            return;\n        }\n        this.bordersDdb.toggle();\n        this.parent.showSpinner();\n        switch (args.item.text) {\n            case 'Top Borders':\n                this.parent.notify(setCellFormat, { style: { borderTop: this.border }, onActionUpdate: true });\n                break;\n            case 'Left Borders':\n                this.parent.notify(setCellFormat, { style: { borderLeft: this.border }, onActionUpdate: true });\n                break;\n            case 'Right Borders':\n                this.parent.notify(setCellFormat, { style: { borderRight: this.border }, onActionUpdate: true });\n                break;\n            case 'Bottom Borders':\n                this.parent.notify(setCellFormat, { style: { borderBottom: this.border }, onActionUpdate: true });\n                break;\n            case 'All Borders':\n                this.parent.notify(setCellFormat, { style: { border: this.border }, onActionUpdate: true });\n                break;\n            case 'Horizontal Borders':\n                this.parent.notify(setCellFormat, { style: { border: this.border }, onActionUpdate: true, borderType: 'Horizontal' });\n                break;\n            case 'Vertical Borders':\n                this.parent.notify(setCellFormat, { style: { border: this.border }, onActionUpdate: true, borderType: 'Vertical' });\n                break;\n            case 'Outside Borders':\n                this.parent.notify(setCellFormat, { style: { border: this.border }, onActionUpdate: true, borderType: 'Outer' });\n                break;\n            case 'Inside Borders':\n                this.parent.notify(setCellFormat, { style: { border: this.border }, onActionUpdate: true, borderType: 'Inner' });\n                break;\n            case 'No Borders':\n                this.parent.notify(setCellFormat, { style: { border: '' }, onActionUpdate: true });\n                break;\n        }\n        this.parent.hideSpinner();\n    };\n    Ribbon.prototype.getFontNameDDB = function (id) {\n        var _this = this;\n        var fontNameBtn = this.parent.createElement('button', { id: id + '_font_name' });\n        fontNameBtn.appendChild(this.parent.createElement('span', { className: 'e-tbar-btn-text', innerHTML: 'Calibri' }));\n        this.fontNameDdb = new DropDownButton({\n            cssClass: 'e-font-family',\n            items: this.getFontFamilyItems(),\n            select: function (args) {\n                var eventArgs = { style: { fontFamily: args.item.text }, onActionUpdate: true };\n                _this.parent.notify(setCellFormat, eventArgs);\n                if (!eventArgs.cancel) {\n                    _this.refreshFontNameSelection(eventArgs.style.fontFamily);\n                }\n            },\n            close: function () { return _this.parent.element.focus(); },\n            beforeOpen: function (args) { return _this.tBarDdbBeforeOpen(args.element, args.items); }\n        });\n        this.fontNameDdb.createElement = this.parent.createElement;\n        this.fontNameDdb.appendTo(fontNameBtn);\n        return fontNameBtn;\n    };\n    Ribbon.prototype.getBtn = function (id, name, bindEvent) {\n        if (bindEvent === void 0) { bindEvent = true; }\n        var btnObj = new Button({ iconCss: \"e-icons e-\" + name + \"-icon\", isToggle: true });\n        btnObj.createElement = this.parent.createElement;\n        btnObj.appendTo(this.parent.createElement('button', { id: id + \"_\" + name }));\n        if (bindEvent) {\n            btnObj.element.addEventListener('click', this.toggleBtnClicked.bind(this));\n        }\n        return btnObj.element;\n    };\n    Ribbon.prototype.datavalidationDDB = function (id) {\n        var _this = this;\n        var l10n = this.parent.serviceLocator.getService(locale);\n        this.datavalidationDdb = new DropDownButton({\n            cssClass: 'e-datavalidation-ddb',\n            iconCss: 'e-datavalidation-icon e-icons',\n            items: [\n                { text: l10n.getConstant('DataValidation') },\n                { text: l10n.getConstant('HighlightInvalidData') },\n                { text: l10n.getConstant('ClearHighlight') },\n                { text: l10n.getConstant('ClearValidation') }\n            ],\n            beforeOpen: function (args) {\n                _this.refreshSelected(_this.datavalidationDdb, args.element, 'iconCss');\n            },\n            select: function (args) {\n                switch (args.item.text) {\n                    case l10n.getConstant('DataValidation'):\n                        _this.parent.notify(initiateDataValidation, null);\n                        break;\n                    case l10n.getConstant('HighlightInvalidData'):\n                        _this.parent.notify(invalidData, { isRemoveHighlight: false });\n                        break;\n                    case l10n.getConstant('ClearHighlight'):\n                        _this.parent.notify(invalidData, { isRemoveHighlight: true });\n                        break;\n                    case l10n.getConstant('ClearValidation'):\n                        _this.parent.notify(removeDataValidation, null);\n                        break;\n                    default:\n                        var direction = args.item.text === l10n.getConstant('SortAscending') ? 'Ascending' : 'Descending';\n                        _this.parent.notify(applySort, { sortOptions: { sortDescriptors: { order: direction } } });\n                        break;\n                }\n            },\n            close: function () { return _this.parent.element.focus(); }\n        });\n        this.datavalidationDdb.createElement = this.parent.createElement;\n        this.datavalidationDdb.appendTo(this.parent.createElement('button', { id: id + '_datavalidation' }));\n        return this.datavalidationDdb.element;\n    };\n    Ribbon.prototype.getTextAlignDDB = function (id) {\n        var _this = this;\n        this.textAlignDdb = new DropDownButton({\n            cssClass: 'e-align-ddb',\n            iconCss: 'e-icons e-left-icon',\n            items: [{ iconCss: 'e-icons e-left-icon' }, { iconCss: 'e-icons e-center-icon' }, { iconCss: 'e-icons e-right-icon' }],\n            beforeItemRender: this.alignItemRender.bind(this),\n            beforeOpen: function (args) {\n                _this.refreshSelected(_this.textAlignDdb, args.element, 'iconCss');\n            },\n            select: function (args) {\n                var eventArgs = {\n                    style: { textAlign: args.item.iconCss.split(' e-')[1].split('-icon')[0] }, onActionUpdate: true\n                };\n                _this.parent.notify(setCellFormat, eventArgs);\n                if (!eventArgs.cancel) {\n                    _this.textAlignDdb.iconCss = \"e-icons e-\" + eventArgs.style.textAlign + \"-icon\";\n                    _this.textAlignDdb.dataBind();\n                }\n            },\n            close: function () { return _this.parent.element.focus(); }\n        });\n        this.textAlignDdb.createElement = this.parent.createElement;\n        this.textAlignDdb.appendTo(this.parent.createElement('button', { id: id + '_text_align' }));\n        return this.textAlignDdb.element;\n    };\n    Ribbon.prototype.getVerticalAlignDDB = function (id) {\n        var _this = this;\n        this.verticalAlignDdb = new DropDownButton({\n            cssClass: 'e-align-ddb',\n            iconCss: 'e-icons e-bottom-icon',\n            items: [{ iconCss: 'e-icons e-top-icon' }, { iconCss: 'e-icons e-middle-icon' }, { iconCss: 'e-icons e-bottom-icon' }],\n            beforeItemRender: this.alignItemRender.bind(this),\n            beforeOpen: function (args) {\n                _this.refreshSelected(_this.verticalAlignDdb, args.element, 'iconCss');\n            },\n            select: function (args) {\n                var eventArgs = {\n                    style: { verticalAlign: args.item.iconCss.split(' e-')[1].split('-icon')[0] }, onActionUpdate: true\n                };\n                _this.parent.notify(setCellFormat, eventArgs);\n                if (!eventArgs.cancel) {\n                    _this.verticalAlignDdb.iconCss = \"e-icons e-\" + eventArgs.style.verticalAlign + \"-icon\";\n                    _this.verticalAlignDdb.dataBind();\n                }\n            },\n            close: function () { return _this.parent.element.focus(); }\n        });\n        this.verticalAlignDdb.createElement = this.parent.createElement;\n        this.verticalAlignDdb.appendTo(this.parent.createElement('button', { id: id + '_vertical_align' }));\n        return this.verticalAlignDdb.element;\n    };\n    Ribbon.prototype.getMergeSplitBtn = function (id) {\n        var _this = this;\n        this.parent.element.appendChild(this.parent.createElement('button', { id: id + '_merge' }));\n        var l10n = this.parent.serviceLocator.getService(locale);\n        this.mergeSplitBtn = new SplitButton({\n            cssClass: 'e-merge-ddb',\n            iconCss: 'e-icons e-merge-icon',\n            items: [{ text: l10n.getConstant('MergeAll'), id: id + \"_merge_all\" }, { text: l10n.getConstant('MergeHorizontally'), id: id + \"_merge_horizontally\" }, { text: l10n.getConstant('MergeVertically'), id: id + \"_merge_vertically\" },\n                { separator: true, id: id + \"_merge_separator\" }, { text: l10n.getConstant('Unmerge'), id: id + \"_unmerge\" }],\n            select: this.mergeSelectHandler.bind(this),\n            close: function () { return _this.parent.element.focus(); },\n            click: function (args) {\n                if (args.element.classList.contains('e-active')) {\n                    _this.toggleActiveState(false);\n                    _this.unMerge();\n                }\n                else {\n                    _this.toggleActiveState(true);\n                    _this.merge(_this.parent.element.id + \"_merge_all\");\n                }\n            },\n            created: function () {\n                _this.mergeSplitBtn.element.title = l10n.getConstant('MergeCells');\n                _this.mergeSplitBtn.element.nextElementSibling.title = l10n.getConstant('SelectMergeType');\n            }\n        });\n        this.mergeSplitBtn.createElement = this.parent.createElement;\n        this.mergeSplitBtn.appendTo('#' + id + '_merge');\n        return this.mergeSplitBtn.element.parentElement;\n    };\n    Ribbon.prototype.mergeSelectHandler = function (args) {\n        args.item.id === this.parent.element.id + \"_unmerge\" ? this.unMerge() : this.merge(args.item.id);\n    };\n    Ribbon.prototype.unMerge = function () {\n        this.parent.showSpinner();\n        this.parent.notify(setMerge, { merge: false, range: this.parent.getActiveSheet().selectedRange,\n            isAction: true, refreshRibbon: true, type: 'All' });\n        this.parent.hideSpinner();\n    };\n    Ribbon.prototype.merge = function (itemId) {\n        var _this = this;\n        var sheet = this.parent.getActiveSheet();\n        var indexes = getRangeIndexes(sheet.selectedRange);\n        var cell;\n        var isDataPresent;\n        for (var i = indexes[0]; i <= indexes[2]; i++) {\n            for (var j = indexes[1]; j <= indexes[3]; j++) {\n                if (i === indexes[0] && j === indexes[1] && itemId.includes('merge_all')) {\n                    continue;\n                }\n                if (i === indexes[0] && itemId.includes('merge_vertically')) {\n                    continue;\n                }\n                if (j === indexes[1] && itemId.includes('_merge_horizontally')) {\n                    continue;\n                }\n                cell = getCell(i, j, sheet) || {};\n                if (cell.value || cell.formula) {\n                    isDataPresent = true;\n                }\n            }\n        }\n        if (!isDataPresent) {\n            this.performMerge(itemId);\n            return;\n        }\n        var dialogInst = this.parent.serviceLocator.getService(dialog);\n        dialogInst.show({\n            target: this.parent.element, height: 200, width: 400, isModal: true, showCloseIcon: true,\n            content: this.parent.serviceLocator.getService(locale).getConstant('MergeCellsAlert'),\n            beforeOpen: function (args) {\n                var dlgArgs = {\n                    dialogName: 'MergeAlertDialog',\n                    element: args.element, target: args.target, cancel: args.cancel\n                };\n                _this.parent.trigger('dialogBeforeOpen', dlgArgs);\n                if (dlgArgs.cancel) {\n                    args.cancel = true;\n                }\n                _this.parent.element.focus();\n            },\n            buttons: [{\n                    buttonModel: { content: this.parent.serviceLocator.getService(locale).getConstant('Ok'), isPrimary: true },\n                    click: function () { dialogInst.hide(); _this.performMerge(itemId); }\n                }]\n        });\n    };\n    Ribbon.prototype.performMerge = function (itemId) {\n        var id = this.parent.element.id;\n        this.parent.showSpinner();\n        switch (itemId) {\n            case id + \"_merge_all\":\n                this.parent.notify(setMerge, { merge: true, range: this.parent.getActiveSheet().selectedRange,\n                    type: 'All', isAction: true, refreshRibbon: true });\n                break;\n            case id + \"_merge_horizontally\":\n                this.parent.notify(setMerge, { merge: true, range: this.parent.getActiveSheet().selectedRange,\n                    type: 'Horizontally', isAction: true });\n                break;\n            case id + \"_merge_vertically\":\n                this.parent.notify(setMerge, { merge: true, range: this.parent.getActiveSheet().selectedRange,\n                    type: 'Vertically', isAction: true });\n                break;\n        }\n        this.parent.hideSpinner();\n    };\n    Ribbon.prototype.getSortFilterDDB = function (id) {\n        var _this = this;\n        var l10n = this.parent.serviceLocator.getService(locale);\n        this.sortingDdb = new DropDownButton({\n            cssClass: 'e-sort-filter-ddb',\n            iconCss: 'e-icons e-sort-filter-icon',\n            items: [\n                { text: l10n.getConstant('SortAscending'), iconCss: 'e-icons e-sort-asc' },\n                { text: l10n.getConstant('SortDescending'), iconCss: 'e-icons e-sort-desc' },\n                { text: l10n.getConstant('CustomSort') + '...', iconCss: 'e-icons e-sort-custom' },\n                { separator: true },\n                { text: l10n.getConstant('Filter'), iconCss: 'e-icons e-filter-apply', id: id + '_applyfilter' },\n                { text: l10n.getConstant('ClearAllFilter'), iconCss: 'e-icons e-filter-clear', id: id + '_clearfilter' },\n                { text: l10n.getConstant('ReapplyFilter'), iconCss: 'e-icons e-filter-reapply', id: id + '_reapplyfilter' }\n            ],\n            beforeItemRender: function (args) {\n                var eventArgs = { isFiltered: false, isClearAll: true };\n                _this.parent.notify(getFilteredColumn, eventArgs);\n                if (args.item.id === id + '_clearfilter' || args.item.id === id + '_reapplyfilter') {\n                    if (!eventArgs.isFiltered) {\n                        args.element.classList.add('e-disabled');\n                    }\n                    else {\n                        args.element.classList.remove('e-disabled');\n                    }\n                }\n            },\n            beforeOpen: function (args) {\n                _this.refreshSelected(_this.sortingDdb, args.element, 'iconCss');\n            },\n            select: function (args) {\n                switch (args.item.text) {\n                    case l10n.getConstant('Filter'):\n                        _this.parent.applyFilter();\n                        break;\n                    case l10n.getConstant('ClearAllFilter'):\n                        _this.parent.clearFilter();\n                        break;\n                    case l10n.getConstant('ReapplyFilter'):\n                        _this.parent.notify(reapplyFilter, null);\n                        break;\n                    case l10n.getConstant('CustomSort') + '...':\n                        _this.parent.notify(initiateCustomSort, null);\n                        break;\n                    default:\n                        var direction = args.item.text === l10n.getConstant('SortAscending') ? 'Ascending' : 'Descending';\n                        _this.parent.notify(applySort, { sortOptions: { sortDescriptors: { order: direction } } });\n                        break;\n                }\n            },\n            close: function () { return _this.parent.element.focus(); }\n        });\n        this.sortingDdb.createElement = this.parent.createElement;\n        this.sortingDdb.appendTo(this.parent.createElement('button', { id: id + '_sorting' }));\n        return this.sortingDdb.element;\n    };\n    Ribbon.prototype.getFindDDb = function (id) {\n        var _this = this;\n        var findToolbtn = this.parent.createElement('button', { id: id + '_findbtn' });\n        this.findDdb = new Button({\n            cssClass: 'e-spreadsheet-find-ddb e-caret-hide',\n            iconCss: 'e-icons e-search-icon'\n        });\n        this.findDdb.createElement = this.parent.createElement;\n        this.findDdb.appendTo(findToolbtn);\n        findToolbtn.onclick = function () {\n            _this.findToolDlg();\n        };\n        return this.findDdb.element;\n    };\n    Ribbon.prototype.findToolDlg = function () {\n        var _this = this;\n        var countArgs;\n        if (isNullOrUndefined(this.parent.element.querySelector('.e-findtool-dlg'))) {\n            var toolbarObj_1;\n            var findTextElement = this.parent.createElement('div', { className: 'e-input-group' });\n            var findTextInput = this.parent.createElement('input', {\n                className: 'e-input e-text-findNext-short', attrs: { 'type': 'Text', value: this.findValue },\n            });\n            findTextInput.setAttribute('placeholder', 'FindValue');\n            var findSpan_1 = this.parent.createElement('span', { className: 'e-input-group-icon' });\n            findTextInput.onkeyup = function () {\n                countArgs = { countOpt: 'count', findCount: '' };\n                _this.parent.notify(findHandler, { countArgs: countArgs });\n                findSpan_1.textContent = countArgs.findCount;\n                var element = document.querySelector('.e-text-findNext-short');\n                var value = element.value;\n                var nextElement = document.querySelector('.e-findRib-next');\n                var prevElement = document.querySelector('.e-findRib-prev');\n                if (isNullOrUndefined(value) || (value === '') || (countArgs.findCount === '0 of 0')) {\n                    toolbarObj_1.enableItems(nextElement, false);\n                    toolbarObj_1.enableItems(prevElement, false);\n                    findSpan_1.textContent = '0 of 0';\n                }\n                else if (!isNullOrUndefined(value) || (countArgs.findCount !== '0 of 0')) {\n                    toolbarObj_1.enableItems(nextElement, true);\n                    toolbarObj_1.enableItems(prevElement, true);\n                }\n            };\n            findTextInput.onkeydown = function (e) {\n                countArgs = { countOpt: 'count', findCount: '' };\n                _this.parent.notify(findHandler, { countArgs: countArgs });\n                var count = countArgs.findCount;\n                _this.findOnKeyDown(e, count);\n            };\n            findTextElement.appendChild(findTextInput);\n            findTextElement.appendChild(findSpan_1);\n            var toolItemModel = [\n                { type: 'Input', template: findTextElement },\n                {\n                    prefixIcon: 'e-icons e-prev-icon', tooltipText: 'Find Previous', type: 'Button', cssClass: 'e-findRib-prev',\n                    disabled: true\n                },\n                { prefixIcon: 'e-icons e-next-icon', tooltipText: 'Find Next', type: 'Button', cssClass: 'e-findRib-next', disabled: true },\n                { type: 'Separator' },\n                { prefixIcon: 'e-icons e-option-icon', tooltipText: 'More Options', type: 'Button', cssClass: 'e-findRib-more' },\n                { prefixIcon: 'e-icons e-close', tooltipText: 'Close', type: 'Button', cssClass: 'e-findRib-close' }\n            ];\n            toolbarObj_1 = new Toolbar({\n                clicked: function (args) {\n                    if (args.item.cssClass === 'e-findRib-next') {\n                        _this.parent.notify(findHandler, { findOption: 'next' });\n                        countArgs = { countOpt: 'count', findCount: '' };\n                        _this.parent.notify(findHandler, { countArgs: countArgs });\n                        findSpan_1.textContent = countArgs.findCount;\n                    }\n                    else if (args.item.cssClass === 'e-findRib-prev') {\n                        _this.parent.notify(findHandler, { findOption: 'prev' });\n                        countArgs = { countOpt: 'count', findCount: '' };\n                        _this.parent.notify(findHandler, { countArgs: countArgs });\n                        findSpan_1.textContent = countArgs.findCount;\n                    }\n                    else if (args.item.cssClass === 'e-findRib-more') {\n                        _this.parent.notify(findDlg, null);\n                        _this.findDialog.hide();\n                    }\n                }, width: 'auto', height: 'auto', items: toolItemModel, cssClass: 'e-find-toolObj'\n            });\n            var toolbarElement_1 = this.parent.createElement('div', { className: 'e-find-toolbar' });\n            var dialogDiv = this.parent.createElement('div', { className: 'e-dlg-div' });\n            this.findDialog = new FindDialog({\n                isModal: false, showCloseIcon: false, cssClass: 'e-findtool-dlg', content: toolbarElement_1, visible: false,\n                allowDragging: true, target: this.parent.element.querySelector('.e-main-panel'),\n                beforeOpen: function () {\n                    EventHandler.add(document, 'click', _this.closeDialog, _this);\n                },\n                open: function () {\n                    _this.textFocus(toolbarObj_1.element);\n                },\n                beforeClose: function () {\n                    _this.findValue = _this.parent.element.querySelector('.e-text-findNext-short').value;\n                    toolbarObj_1.destroy();\n                    var element = document.querySelector('.e-find-toolbar');\n                    EventHandler.remove(element, 'focus', _this.textFocus);\n                    EventHandler.remove(document, 'click', _this.closeDialog);\n                    _this.parent.element.focus();\n                },\n                created: function () {\n                    toolbarObj_1.createElement = _this.parent.createElement;\n                    toolbarObj_1.appendTo(toolbarElement_1);\n                    _this.findDialog.width = getComputedStyle(document.querySelector('.e-findtool-dlg')).width;\n                    var calculate = _this.parent.element.querySelector('.e-main-panel').getBoundingClientRect();\n                    var dialogWidth = _this.findDialog.width;\n                    var rightValue = calculate.width - parseInt(dialogWidth.toString(), 10) - 14; /** 14- width of scroll bar */\n                    /** 31- height of sheetHeader */\n                    var topValue = _this.parent.sheets[_this.parent.activeSheetIndex].showHeaders ? 31 : 0;\n                    _this.findDialog.position = { X: rightValue, Y: topValue };\n                    _this.findDialog.dataBind();\n                    _this.findDialog.show();\n                },\n            });\n            this.findDialog.createElement = this.parent.createElement;\n            this.findDialog.appendTo(dialogDiv);\n        }\n        else {\n            if (!isNullOrUndefined(this.parent.element.querySelector('.e-findtool-dlg'))) {\n                this.findDialog.hide();\n                detach(this.parent.element.querySelector('.e-findtool-dlg'));\n                this.findDialog = null;\n                this.parent.element.focus();\n            }\n        }\n    };\n    Ribbon.prototype.findOnKeyDown = function (e, count) {\n        if (document.querySelector('.e-text-findNext-short').value) {\n            if (count !== '0 of 0') {\n                if (e.shiftKey) {\n                    if (e.keyCode === 13) {\n                        var buttonArgs = { findOption: 'prev' };\n                        this.parent.notify(findHandler, buttonArgs);\n                    }\n                }\n                else if (e.keyCode === 13) {\n                    var buttonArg = { findOption: 'next' };\n                    this.parent.notify(findHandler, buttonArg);\n                }\n            }\n        }\n    };\n    Ribbon.prototype.closeDialog = function (e) {\n        if ((closest(e.target, '.e-findRib-close')) || (!closest(e.target, '.e-spreadsheet'))) {\n            if (!isNullOrUndefined(this.findDialog)) {\n                this.findDialog.hide();\n                detach(this.parent.element.querySelector('.e-findtool-dlg'));\n                this.findDialog = null;\n            }\n        }\n    };\n    Ribbon.prototype.textFocus = function (element) {\n        element = document.querySelector('.e-find-toolbar');\n        element.addEventListener('focus', function () {\n            var elements = document.querySelector('.e-text-findNext-short');\n            elements.focus();\n            elements.classList.add('e-input-focus');\n            (elements).setSelectionRange(0, elements.value.length);\n        });\n    };\n    Ribbon.prototype.getClearDDB = function (id) {\n        var _this = this;\n        var l10n = this.parent.serviceLocator.getService(locale);\n        this.clearDdb = new DropDownButton({\n            cssClass: 'e-clear-ddb',\n            iconCss: 'e-icons e-clear-icon',\n            items: [\n                { text: l10n.getConstant('ClearAll') },\n                { text: l10n.getConstant('ClearFormats') },\n                { text: l10n.getConstant('ClearContents') },\n                { text: l10n.getConstant('ClearHyperlinks') }\n            ],\n            select: function (args) {\n                _this.parent.notify(clearViewer, { options: { type: args.item.text } });\n            },\n            close: function () { return _this.parent.element.focus(); }\n        });\n        this.clearDdb.createElement = this.parent.createElement;\n        this.clearDdb.appendTo(this.parent.createElement('button', { id: id + '_clear' }));\n        return this.clearDdb.element;\n    };\n    Ribbon.prototype.ribbonCreated = function () {\n        this.ribbon.element.querySelector('.e-drop-icon').title\n            = this.parent.serviceLocator.getService(locale).getConstant('CollapseToolbar');\n    };\n    Ribbon.prototype.alignItemRender = function (args) {\n        var text = args.item.iconCss.split(' e-')[1].split('-icon')[0];\n        text = text[0].toUpperCase() + text.slice(1, text.length);\n        args.element.title = this.parent.serviceLocator.getService(locale).getConstant('Align' + text);\n    };\n    Ribbon.prototype.toggleBtnClicked = function (e) {\n        var target = closest(e.target, '.e-btn');\n        var parentId = this.parent.element.id;\n        var id = target.id;\n        var property = setCellFormat;\n        var value;\n        var defaultModel;\n        var activeModel;\n        var eventArgs;\n        var key;\n        switch (id) {\n            case parentId + \"_bold\":\n                defaultModel = { fontWeight: 'normal' };\n                activeModel = { fontWeight: 'bold' };\n                key = 'fontWeight';\n                break;\n            case parentId + \"_italic\":\n                defaultModel = { fontStyle: 'normal' };\n                activeModel = { fontStyle: 'italic' };\n                key = 'fontStyle';\n                break;\n            case parentId + \"_line-through\":\n                property = textDecorationUpdate;\n                defaultModel = { textDecoration: 'line-through' };\n                activeModel = defaultModel;\n                key = 'textDecoration';\n                break;\n            case parentId + \"_underline\":\n                property = textDecorationUpdate;\n                defaultModel = { textDecoration: 'underline' };\n                activeModel = defaultModel;\n                key = 'textDecoration';\n                break;\n        }\n        if (target.classList.contains('e-active')) {\n            value = activeModel[key];\n            eventArgs = { style: activeModel, onActionUpdate: true };\n            this.parent.notify(property, eventArgs);\n            if (eventArgs.cancel) {\n                target.classList.remove('e-active');\n            }\n        }\n        else {\n            value = defaultModel[key];\n            eventArgs = { style: defaultModel, onActionUpdate: true };\n            this.parent.notify(property, eventArgs);\n            if (eventArgs.cancel) {\n                target.classList.add('e-active');\n            }\n        }\n        if (!eventArgs.cancel && value !== eventArgs.style[key]) {\n            this.refreshToggleBtn(getCellIndexes(this.parent.getActiveSheet().activeCell));\n        }\n        this.parent.element.focus();\n    };\n    Ribbon.prototype.getCellStyleValue = function (cssProp, indexes) {\n        var cell = getCell(indexes[0], indexes[1], this.parent.getActiveSheet());\n        var value = this.parent.cellStyle[cssProp];\n        if (cell && cell.style && cell.style[cssProp]) {\n            value = cell.style[cssProp];\n        }\n        return value;\n    };\n    Ribbon.prototype.refreshSelected = function (inst, element, key, itemKey) {\n        if (itemKey === void 0) { itemKey = key; }\n        for (var i = 0; i < inst.items.length; i++) {\n            if (inst.items[i][itemKey] === inst[key]) {\n                element.children[i].classList.add('e-selected');\n                break;\n            }\n        }\n    };\n    Ribbon.prototype.expandCollapseHandler = function (args) {\n        var target = this.ribbon.element.querySelector('.e-drop-icon');\n        var l10n = this.parent.serviceLocator.getService(locale);\n        if (args.expanded) {\n            target.title = l10n.getConstant('CollapseToolbar');\n        }\n        else {\n            target.title = l10n.getConstant('ExpandToolbar');\n        }\n        this.parent.setPanelSize();\n    };\n    Ribbon.prototype.getNumFormatDdbItems = function (id) {\n        var l10n = this.parent.serviceLocator.getService(locale);\n        return [\n            { id: id + 'item1', text: l10n.getConstant('General') },\n            { id: id + 'item2', text: l10n.getConstant('Number') },\n            { id: id + 'item3', text: l10n.getConstant('Currency') },\n            { id: id + 'item4', text: l10n.getConstant('Accounting') },\n            { id: id + 'item5', text: l10n.getConstant('ShortDate') },\n            { id: id + 'item6', text: l10n.getConstant('LongDate') },\n            { id: id + 'item7', text: l10n.getConstant('Time') },\n            { id: id + 'item8', text: l10n.getConstant('Percentage') },\n            { id: id + 'item9', text: l10n.getConstant('Fraction') },\n            { id: id + 'item10', text: l10n.getConstant('Scientific') },\n            { id: id + 'item11', text: l10n.getConstant('Text') }\n        ];\n    };\n    Ribbon.prototype.getFontFamilyItems = function () {\n        return [{ text: 'Arial' }, { text: 'Arial Black' }, { text: 'Axettac Demo' }, { text: 'Batang' }, { text: 'Book Antiqua' },\n            { text: 'Calibri', iconCss: 'e-icons e-selected-icon' }, { text: 'Courier' }, { text: 'Courier New' },\n            { text: 'Din Condensed' }, { text: 'Georgia' }, { text: 'Helvetica' }, { text: 'Helvetica New' }, { text: 'Roboto' },\n            { text: 'Tahoma' }, { text: 'Times New Roman' }, { text: 'Verdana' }];\n    };\n    Ribbon.prototype.numDDBSelect = function (args) {\n        var eventArgs = {\n            format: getFormatFromType(args.item.text),\n            range: this.parent.getActiveSheet().selectedRange, cancel: false, requestType: 'NumberFormat'\n        };\n        var actionArgs = {\n            range: this.parent.getActiveSheet().name + '!' + eventArgs.range,\n            format: eventArgs.format, requestType: 'NumberFormat'\n        };\n        this.parent.trigger('beforeCellFormat', eventArgs);\n        this.parent.notify(beginAction, { eventArgs: eventArgs, action: 'format' });\n        if (eventArgs.cancel) {\n            return;\n        }\n        this.parent.notify(applyNumberFormatting, eventArgs);\n        this.parent.notify(selectionComplete, { type: 'mousedown' });\n        this.refreshNumFormatSelection(args.item.text);\n        this.parent.notify(completeAction, { eventArgs: actionArgs, action: 'format' });\n    };\n    Ribbon.prototype.tBarDdbBeforeOpen = function (element, items, separatorCount) {\n        if (separatorCount === void 0) { separatorCount = 0; }\n        var viewportHeight = this.parent.viewport.height;\n        var actualHeight = (parseInt(getComputedStyle(element.firstElementChild).height, 10) * (items.length - separatorCount)) +\n            (parseInt(getComputedStyle(element).paddingTop, 10) * 2);\n        if (separatorCount) {\n            var separatorStyle = getComputedStyle(element.querySelector('.e-separator'));\n            actualHeight += (separatorCount * (parseInt(separatorStyle.borderBottomWidth, 10) + (parseInt(separatorStyle.marginTop, 10) * 2)));\n        }\n        if (actualHeight > viewportHeight) {\n            element.style.height = viewportHeight + \"px\";\n            element.style.overflowY = 'auto';\n        }\n        else {\n            if (element.style.height) {\n                element.style.height = '';\n                element.style.overflowY = '';\n            }\n        }\n    };\n    Ribbon.prototype.numDDBOpen = function (args) {\n        this.numPopupWidth = 0;\n        var elemList = args.element.querySelectorAll('span.e-numformat-preview-text');\n        for (var i = 0, len = elemList.length; i < len; i++) {\n            if (this.numPopupWidth < elemList[i].offsetWidth) {\n                this.numPopupWidth = elemList[i].offsetWidth;\n            }\n        }\n        var popWidth = this.numPopupWidth + 160;\n        document.querySelector('.e-numformat-ddb.e-dropdown-popup').style.width = popWidth + \"px\";\n    };\n    Ribbon.prototype.previewNumFormat = function (args) {\n        var cellIndex = getCellIndexes(this.parent.getActiveSheet().activeCell);\n        var cell = getCell(cellIndex[0], cellIndex[1], this.parent.getActiveSheet());\n        var eventArgs = {\n            type: args.item.text,\n            formattedText: '',\n            value: cell && cell.value ? cell.value : '',\n            format: getFormatFromType(args.item.text),\n            sheetIndex: this.parent.activeSheetIndex,\n            onLoad: true\n        };\n        var numElem = this.parent.createElement('div', {\n            className: 'e-numformat-text',\n            styles: 'width:100%',\n            innerHTML: args.element.innerHTML\n        });\n        args.element.innerHTML = '';\n        this.parent.notify(getFormattedCellObject, eventArgs);\n        var previewElem = this.parent.createElement('span', {\n            className: 'e-numformat-preview-text',\n            styles: 'float:right;',\n            innerHTML: eventArgs.formattedText.toString()\n        });\n        numElem.appendChild(previewElem);\n        args.element.appendChild(numElem);\n    };\n    Ribbon.prototype.refreshRibbonContent = function (activeTab) {\n        if (!this.ribbon) {\n            return;\n        }\n        if (isNullOrUndefined(activeTab)) {\n            activeTab = this.ribbon.selectedTab;\n        }\n        var l10n = this.parent.serviceLocator.getService(locale);\n        var sheet = this.parent.getActiveSheet();\n        switch (this.ribbon.items[activeTab].header.text) {\n            case l10n.getConstant('Home'):\n                this.refreshHomeTabContent(getCellIndexes(sheet.activeCell));\n                break;\n            case l10n.getConstant('Insert'):\n                // Second tab functionality comes here\n                break;\n            case l10n.getConstant('Formulas'):\n                // Third tab functionality comes here\n                break;\n            case l10n.getConstant('Data'):\n                this.refreshDataTabContent(activeTab);\n                break;\n            case l10n.getConstant('View'):\n                this.refreshViewTabContent(activeTab);\n                break;\n        }\n    };\n    Ribbon.prototype.refreshHomeTabContent = function (indexes) {\n        if (!isNullOrUndefined(document.getElementById(this.parent.element.id + '_number_format'))) {\n            this.numFormatDDB = getComponent(document.getElementById(this.parent.element.id + '_number_format'), DropDownButton);\n        }\n        var sheet = this.parent.getActiveSheet();\n        var actCell = getCellIndexes(this.parent.getActiveSheet().activeCell);\n        var l10n = this.parent.serviceLocator.getService(locale);\n        var cell = getCell(actCell[0], actCell[1], this.parent.getActiveSheet()) || {};\n        var type = getTypeFromFormat(cell.format ? cell.format : 'General');\n        if (this.numFormatDDB) {\n            if (sheet.isProtected && !sheet.protectSettings.formatCells) {\n                type = 'General';\n                this.refreshNumFormatSelection(type);\n            }\n            else {\n                this.refreshNumFormatSelection(l10n.getConstant(type));\n            }\n        }\n        if (this.fontNameDdb) {\n            if (sheet.isProtected && !sheet.protectSettings.formatCells) {\n                this.refreshFontNameSelection('Calibri');\n            }\n            else {\n                this.refreshFontNameSelection(this.getCellStyleValue('fontFamily', indexes));\n            }\n        }\n        if (this.fontSizeDdb) {\n            var value = this.getCellStyleValue('fontSize', indexes);\n            if (sheet.isProtected && !sheet.protectSettings.formatCells) {\n                this.fontSizeDdb.content = '11';\n            }\n            else {\n                value = value.includes('pt') ? value.split('pt')[0] : '11';\n                if (value !== this.fontSizeDdb.content) {\n                    this.fontSizeDdb.content = value;\n                    this.fontSizeDdb.dataBind();\n                }\n            }\n        }\n        if (this.textAlignDdb) {\n            var style = this.getCellStyleValue('textAlign', indexes);\n            if (sheet.isProtected && !sheet.protectSettings.formatCells) {\n                this.textAlignDdb.iconCss = 'e-icons e-left-icon';\n            }\n            else {\n                if (cell.value !== undefined && style === 'left' && (type === 'Accounting' || isNumber(cell.value))) {\n                    style = 'right';\n                }\n                var value = \"e-icons e-\" + style.toLowerCase() + \"-icon\";\n                if (value !== this.textAlignDdb.iconCss) {\n                    this.textAlignDdb.iconCss = value;\n                    this.textAlignDdb.dataBind();\n                }\n            }\n        }\n        if (this.verticalAlignDdb) {\n            var value = \"e-icons e-\" + this.getCellStyleValue('verticalAlign', indexes).toLowerCase() + \"-icon\";\n            if (sheet.isProtected && !sheet.protectSettings.formatCells) {\n                this.verticalAlignDdb.iconCss = 'e-icons e-bottom-icon';\n            }\n            else {\n                if (value !== this.verticalAlignDdb.iconCss) {\n                    this.verticalAlignDdb.iconCss = value;\n                    this.verticalAlignDdb.dataBind();\n                }\n            }\n        }\n        this.refreshToggleBtn(indexes);\n        if (!sheet.isProtected && (cell.rowSpan > 1 || cell.colSpan > 1)) {\n            this.enableToolbarItems([{ tab: l10n.getConstant('Home'), items: [this.parent.element.id + \"_merge_cells\"],\n                    enable: true }]);\n            this.toggleActiveState(true);\n        }\n        else {\n            var indexes_1 = getRangeIndexes(sheet.selectedRange);\n            this.enableToolbarItems([{ tab: l10n.getConstant('Home'), items: [this.parent.element.id + \"_merge_cells\"],\n                    enable: indexes_1[0] !== indexes_1[2] || indexes_1[1] !== indexes_1[3] ? true : false }]);\n            this.toggleActiveState(false);\n        }\n    };\n    Ribbon.prototype.toggleActiveState = function (active) {\n        var l10n = this.parent.serviceLocator.getService(locale);\n        if (!this.parent.getActiveSheet().isProtected) {\n            if (active) {\n                this.mergeSplitBtn.element.classList.add('e-active');\n                this.mergeSplitBtn.element.title = l10n.getConstant('UnmergeCells');\n            }\n            else {\n                if (this.mergeSplitBtn.element.classList.contains('e-active')) {\n                    this.mergeSplitBtn.element.classList.remove('e-active');\n                }\n                this.mergeSplitBtn.element.title = l10n.getConstant('MergeCells');\n            }\n        }\n    };\n    Ribbon.prototype.refreshToggleBtn = function (indexes) {\n        var _this = this;\n        var sheet = this.parent.getActiveSheet();\n        var btn;\n        var id = this.parent.element.id;\n        var value;\n        var isActive;\n        var cell = getCell(indexes[0], indexes[1], sheet);\n        var fontProps = ['fontWeight', 'fontStyle', 'textDecoration', 'textDecoration'];\n        ['bold', 'italic', 'line-through', 'underline', 'wrap'].forEach(function (name, index) {\n            btn = document.getElementById(id + \"_\" + name);\n            if (btn) {\n                if (sheet.isProtected && !sheet.protectSettings.formatCells) {\n                    btn.classList.remove('e-active');\n                }\n                else if (name === 'wrap') {\n                    isActive = cell && cell.wrap;\n                }\n                else {\n                    value = _this.getCellStyleValue(fontProps[index], indexes).toLowerCase();\n                    isActive = value.indexOf(name) > -1;\n                }\n                if (isActive) {\n                    btn.classList.add('e-active');\n                }\n                else {\n                    if (btn.classList.contains('e-active')) {\n                        btn.classList.remove('e-active');\n                    }\n                }\n            }\n        });\n    };\n    Ribbon.prototype.refreshFontNameSelection = function (fontFamily) {\n        if (fontFamily !== this.fontNameDdb.items[this.fontNameIndex].text) {\n            this.fontNameDdb.element.firstElementChild.textContent = fontFamily;\n            for (var i = 0; i < this.fontNameDdb.items.length; i++) {\n                if (this.fontNameDdb.items[i].text === fontFamily) {\n                    this.fontNameDdb.items[i].iconCss = 'e-icons e-selected-icon';\n                    this.fontNameDdb.items[this.fontNameIndex].iconCss = '';\n                    this.fontNameDdb.setProperties({ 'items': this.fontNameDdb.items }, true);\n                    this.fontNameIndex = i;\n                    break;\n                }\n            }\n        }\n    };\n    Ribbon.prototype.refreshNumFormatSelection = function (type) {\n        var l10n = this.parent.serviceLocator.getService(locale);\n        for (var i = 0; i < this.numFormatDDB.items.length; i++) {\n            if (this.numFormatDDB.items[i].iconCss !== '') {\n                this.numFormatDDB.items[i].iconCss = '';\n            }\n            if (this.numFormatDDB.items[i].text === type) {\n                this.numFormatDDB.items[i].iconCss = 'e-icons e-selected-icon';\n            }\n        }\n        this.numFormatDDB.element.firstElementChild.textContent = type;\n        this.numFormatDDB.setProperties({ 'items': this.numFormatDDB.items }, true);\n    };\n    Ribbon.prototype.fileMenuItemSelect = function (args) {\n        var _this = this;\n        var selectArgs = extend({ cancel: false }, args);\n        this.parent.trigger('fileMenuItemSelect', selectArgs);\n        var id = this.parent.element.id;\n        if (!selectArgs.cancel) {\n            switch (args.item.id) {\n                case id + \"_Open\":\n                    select('#' + id + '_fileUpload', this.parent.element).click();\n                    break;\n                case id + \"_Xlsx\":\n                case id + \"_Xls\":\n                case id + \"_Csv\":\n                    this.parent.save({ saveType: args.item.id.split(id + \"_\")[1] });\n                    break;\n                case id + \"_New\":\n                    var dialogInst_1 = this.parent.serviceLocator.getService(dialog);\n                    dialogInst_1.show({\n                        height: 200, width: 400, isModal: true, showCloseIcon: true,\n                        content: this.parent.serviceLocator.getService(locale).getConstant('DestroyAlert'),\n                        beforeOpen: function (args) {\n                            var dlgArgs = {\n                                dialogName: 'DestroySheetDialog',\n                                element: args.element, target: args.target, cancel: args.cancel\n                            };\n                            _this.parent.trigger('dialogBeforeOpen', dlgArgs);\n                            if (dlgArgs.cancel) {\n                                args.cancel = true;\n                            }\n                            _this.parent.element.focus();\n                        },\n                        buttons: [{\n                                buttonModel: {\n                                    content: this.parent.serviceLocator.getService(locale).getConstant('Ok'), isPrimary: true\n                                },\n                                click: function () {\n                                    _this.parent.sheets.length = 0;\n                                    _this.parent.createSheet();\n                                    dialogInst_1.hide();\n                                    _this.parent.activeSheetIndex = _this.parent.sheets.length - 1;\n                                    _this.parent.notify(refreshSheetTabs, {});\n                                    _this.parent.notify(sheetsDestroyed, {});\n                                    _this.parent.renderModule.refreshSheet();\n                                }\n                            }]\n                    });\n                    break;\n            }\n        }\n    };\n    Ribbon.prototype.toolbarClicked = function (args) {\n        if (!(args.item.id === 'spreadsheet_find')) {\n            var parentId = this.parent.element.id;\n            var sheet = this.parent.getActiveSheet();\n            switch (args.item.id) {\n                case parentId + '_headers':\n                    var evtHArgs = {\n                        isShow: !sheet.showHeaders,\n                        sheetIdx: this.parent.activeSheetIndex,\n                        cancel: false\n                    };\n                    this.parent.notify(completeAction, { eventArgs: evtHArgs, action: 'headers' });\n                    if (evtHArgs.cancel) {\n                        return;\n                    }\n                    this.parent.setSheetPropertyOnMute(sheet, 'showHeaders', !sheet.showHeaders);\n                    this.parent.serviceLocator.getService('sheet').showHideHeaders();\n                    this.toggleRibbonItems({ props: 'Headers', activeTab: this.ribbon.selectedTab });\n                    this.parent.element.focus();\n                    break;\n                case parentId + '_gridlines':\n                    var evtglArgs = {\n                        isShow: !sheet.showGridLines,\n                        sheetIdx: this.parent.activeSheetIndex,\n                        cancel: false\n                    };\n                    this.parent.notify(completeAction, { eventArgs: evtglArgs, action: 'gridLines' });\n                    if (evtglArgs.cancel) {\n                        return;\n                    }\n                    this.parent.setSheetPropertyOnMute(sheet, 'showGridLines', !sheet.showGridLines);\n                    this.toggleRibbonItems({ props: 'GridLines', activeTab: this.ribbon.selectedTab });\n                    this.parent.element.focus();\n                    break;\n                case parentId + '_protect':\n                    this.parent.setSheetPropertyOnMute(sheet, 'isProtected', !sheet.isProtected);\n                    var isActive = false;\n                    sheet.isProtected ? isActive = false : isActive = true;\n                    this.parent.notify(applyProtect, { isActive: isActive, id: parentId + '_protect' });\n                    break;\n                case parentId + '_undo':\n                    this.parent.notify(performUndoRedo, { isUndo: true });\n                    break;\n                case parentId + '_redo':\n                    this.parent.notify(performUndoRedo, { isUndo: false });\n                    break;\n            }\n            this.parent.notify(ribbonClick, args);\n        }\n    };\n    Ribbon.prototype.toggleRibbonItems = function (args) {\n        var viewtabHeader = this.parent.serviceLocator.getService(locale).getConstant('View');\n        var datatabHeader = this.parent.serviceLocator.getService(locale).getConstant('Data');\n        if (this.ribbon.items[this.ribbon.selectedTab].header.text === viewtabHeader) {\n            if (isNullOrUndefined(args.activeTab)) {\n                for (var i = 0, len_1 = this.ribbon.items.length; i < len_1; i++) {\n                    if (this.ribbon.items[i].header.text === viewtabHeader) {\n                        args.activeTab = i;\n                        break;\n                    }\n                }\n            }\n            var text = this.getLocaleText(args.props, true);\n            var id = this.parent.element.id + \"_\" + args.props.toLowerCase();\n            var len = this.ribbon.items[args.activeTab].content.length;\n            for (var i = void 0; i < len; i++) {\n                if (this.ribbon.items[args.activeTab].content[i].type === 'Separator') {\n                    continue;\n                }\n                if (this.ribbon.items[args.activeTab].content[i].id === id) {\n                    this.ribbon.items[args.activeTab].content[i].text = text;\n                    this.ribbon.setProperties({ 'items': this.ribbon.items }, true);\n                }\n            }\n            if (this.ribbon.items[this.ribbon.selectedTab].header.text === viewtabHeader) {\n                this.updateToggleText(args.props.toLowerCase(), text);\n            }\n        }\n        if (this.ribbon.items[this.ribbon.selectedTab].header.text === datatabHeader) {\n            if (isNullOrUndefined(args.activeTab)) {\n                for (var i = 0, len_2 = this.ribbon.items.length; i < len_2; i++) {\n                    if (this.ribbon.items[i].header.text === datatabHeader) {\n                        args.activeTab = i;\n                        break;\n                    }\n                }\n            }\n            var text = this.getLocaleProtectText('Sheet', true);\n            var id = this.parent.element.id + \"_\" + args.props.toLowerCase();\n            var len = this.ribbon.items[args.activeTab].content.length;\n            for (var i = void 0; i < len; i++) {\n                if (this.ribbon.items[args.activeTab].content[i].type === 'Separator') {\n                    continue;\n                }\n                if (this.ribbon.items[args.activeTab].content[i].id === id) {\n                    this.ribbon.items[args.activeTab].content[i].text = text;\n                    this.ribbon.setProperties({ 'items': this.ribbon.items }, true);\n                }\n            }\n            if (this.ribbon.items[this.ribbon.selectedTab].header.text === datatabHeader) {\n                this.updateToggleText(args.props.toLowerCase(), text);\n            }\n        }\n    };\n    Ribbon.prototype.enableFileMenuItems = function (args) {\n        this.ribbon.enableMenuItems(args.items, args.enable, args.isUniqueId);\n    };\n    Ribbon.prototype.hideRibbonTabs = function (args) {\n        this.ribbon.hideTabs(args.tabs, args.hide);\n    };\n    Ribbon.prototype.addRibbonTabs = function (args) {\n        this.ribbon.addTabs(args.items, args.insertBefore);\n        var nextTab = select('.e-ribbon .e-tab-header .e-toolbar-item:not(.e-menu-tab).e-hide', this.parent.element);\n        if (nextTab) {\n            this.parent.updateActiveBorder(selectAll('.e-ribbon .e-tab-header .e-toolbar-item:not(.e-menu-tab)', this.parent.element)[this.ribbon.selectedTab]);\n        }\n    };\n    Ribbon.prototype.updateToggleText = function (item, text) {\n        var _this = this;\n        getUpdateUsingRaf(function () {\n            select(\"#\" + _this.parent.element.id + \"_\" + item + \" .e-tbar-btn-text\", _this.ribbon.element).textContent = text;\n        });\n    };\n    Ribbon.prototype.refreshViewTabContent = function (activeTab) {\n        var id = this.parent.element.id;\n        var updated;\n        for (var i = 0; i < this.ribbon.items[activeTab].content.length; i++) {\n            if (this.ribbon.items[activeTab].content[i].type === 'Separator') {\n                continue;\n            }\n            if (this.ribbon.items[activeTab].content[i].id === id + \"_headers\") {\n                this.updateViewTabContent(activeTab, 'Headers', i);\n                if (updated) {\n                    break;\n                }\n                updated = true;\n            }\n            if (this.ribbon.items[activeTab].content[i].id === id + \"_gridlines\") {\n                this.updateViewTabContent(activeTab, 'GridLines', i);\n                if (updated) {\n                    break;\n                }\n                updated = true;\n            }\n        }\n    };\n    Ribbon.prototype.updateViewTabContent = function (activeTab, item, idx) {\n        var sheet = this.parent.getActiveSheet();\n        var l10n = this.parent.serviceLocator.getService(locale);\n        if (sheet['show' + item]) {\n            if (this.ribbon.items[activeTab].content[idx].text === l10n.getConstant('Show' + item)) {\n                this.updateShowHideBtn('Hide', item, idx, activeTab);\n            }\n        }\n        else {\n            if (this.ribbon.items[activeTab].content[idx].text === l10n.getConstant('Hide' + item)) {\n                this.updateShowHideBtn('Show', item, idx, activeTab);\n            }\n        }\n    };\n    Ribbon.prototype.updateShowHideBtn = function (showHideText, item, idx, activeTab) {\n        var l10n = this.parent.serviceLocator.getService(locale);\n        var text = l10n.getConstant(showHideText + item);\n        this.ribbon.items[activeTab].content[idx].text = text;\n        this.ribbon.setProperties({ 'items': this.ribbon.items }, true);\n        this.updateToggleText(item.toLowerCase(), text);\n    };\n    Ribbon.prototype.refreshDataTabContent = function (activeTab) {\n        var id = this.parent.element.id;\n        var updated;\n        for (var j = 0; j < this.ribbon.items[activeTab].content.length; j++) {\n            if (this.ribbon.items[activeTab].content[j].type === 'Separator') {\n                continue;\n            }\n            if (this.ribbon.items[activeTab].content[j].id === id + \"_protect\") {\n                this.updateDataTabContent(activeTab, 'Sheet', j);\n                if (updated) {\n                    break;\n                }\n                updated = true;\n            }\n        }\n    };\n    Ribbon.prototype.updateDataTabContent = function (activeTab, item, idx) {\n        var sheet = this.parent.getActiveSheet();\n        var l10n = this.parent.serviceLocator.getService(locale);\n        if (sheet.isProtected) {\n            if (this.ribbon.items[activeTab].content[idx].text === l10n.getConstant('Protect' + item)) {\n                this.ribbon.items[activeTab].content[idx].cssClass = 'e-active';\n                this.updateProtectBtn('Unprotect', item, idx, activeTab);\n            }\n        }\n        else {\n            this.updateProtectBtn('Protect', item, idx, activeTab);\n        }\n    };\n    Ribbon.prototype.updateProtectBtn = function (protectText, item, idx, activeTab) {\n        var l10n = this.parent.serviceLocator.getService(locale);\n        var text = l10n.getConstant(protectText + item);\n        this.ribbon.items[activeTab].content[idx].text = text;\n        this.ribbon.setProperties({ 'items': this.ribbon.items }, true);\n        this.updateToggleText('protect', text);\n    };\n    Ribbon.prototype.addToolbarItems = function (args) {\n        this.ribbon.addToolbarItems(args.tab, args.items, args.index);\n    };\n    Ribbon.prototype.enableToolbarItems = function (args) {\n        var _this = this;\n        args.forEach(function (arg) {\n            _this.ribbon.enableItems(arg.tab || _this.ribbon.items[_this.ribbon.selectedTab].header.text, arg.items, arg.enable);\n        });\n    };\n    Ribbon.prototype.createMobileView = function () {\n        var _this = this;\n        var parentId = this.parent.element.id;\n        var toobar = this.parent.createElement('div', { className: 'e-header-toolbar' });\n        var menu = this.parent.createElement('ul');\n        toobar.appendChild(menu);\n        var toolbarObj = new Toolbar({\n            items: [\n                { prefixIcon: 'e-tick-icon', align: 'Left', id: parentId + 'focused_tick', cssClass: 'e-focused-tick' },\n                { template: menu, align: 'Right', id: parentId + 'file_menu' },\n            ],\n            clicked: function (args) {\n                switch (args.item.id) {\n                    case parentId + 'focused_tick':\n                        _this.parent.element.classList.remove('e-mobile-focused');\n                        _this.parent.renderModule.setSheetPanelSize();\n                        break;\n                }\n            },\n            created: function () {\n                var menuObj = new Menu({\n                    cssClass: 'e-mobile e-file-menu',\n                    enableRtl: true,\n                    showItemOnClick: true,\n                    items: _this.getRibbonMenuItems(),\n                    select: _this.fileMenuItemSelect.bind(_this),\n                    beforeOpen: function (args) {\n                        args.element.parentElement.classList.remove('e-rtl');\n                        _this.fileMenuBeforeOpen(args);\n                    },\n                    beforeClose: _this.fileMenuBeforeClose.bind(_this)\n                });\n                menuObj.createElement = _this.parent.createElement;\n                menuObj.appendTo(menu);\n            }\n        });\n        toolbarObj.createElement = this.parent.createElement;\n        toolbarObj.appendTo(toobar);\n        this.parent.element.insertBefore(toobar, this.parent.element.firstElementChild);\n        this.renderMobileToolbar();\n    };\n    Ribbon.prototype.renderMobileToolbar = function () {\n        var _this = this;\n        var toolbarPanel = this.parent.createElement('div', { className: 'e-toolbar-panel e-ribbon' });\n        var toolbar = this.parent.createElement('div');\n        var ddb = this.parent.createElement('button');\n        toolbarPanel.appendChild(toolbar);\n        toolbarPanel.appendChild(ddb);\n        toolbarPanel.style.display = 'block';\n        this.parent.element.appendChild(toolbarPanel);\n        var ddbObj = new DropDownButton({\n            cssClass: 'e-caret-hide',\n            content: this.ribbon.items[0].header.text,\n            items: [\n                { text: this.ribbon.items[0].header.text },\n                { text: this.ribbon.items[1].header.text },\n                { text: this.ribbon.items[2].header.text },\n                { text: this.ribbon.items[3].header.text }\n            ],\n            select: function (args) {\n                if (args.item.text !== ddbObj.content) {\n                    toolbarObj.element.style.display = 'none';\n                    ddbObj.content = args.item.text;\n                    ddbObj.dataBind();\n                    toolbarObj.items = _this.ribbon.items[ddbObj.items.indexOf(args.item) + 1].content;\n                    toolbarObj.width = \"calc(100% - \" + ddb.getBoundingClientRect().width + \"px)\";\n                    toolbarObj.element.style.display = '';\n                    toolbarObj.dataBind();\n                    toolbarObj.items[0].text = args.item.text;\n                    toolbarObj.dataBind();\n                }\n            },\n            open: function (args) {\n                var element = args.element.parentElement;\n                var clientRect = element.getBoundingClientRect();\n                var offset = calculatePosition(ddbObj.element, 'right', 'bottom');\n                element.style.left = offset.left - clientRect.width + \"px\";\n                element.style.top = offset.top - clientRect.height + \"px\";\n                for (var i = 0; i < ddbObj.items.length; i++) {\n                    if (ddbObj.content === ddbObj.items[i].text) {\n                        args.element.children[i].classList.add('e-selected');\n                        break;\n                    }\n                }\n            },\n            close: function () { return _this.parent.element.focus(); }\n        });\n        ddbObj.createElement = this.parent.createElement;\n        ddbObj.appendTo(ddb);\n        var toolbarObj = new Toolbar({\n            width: \"calc(100% - \" + ddb.getBoundingClientRect().width + \"px)\",\n            items: this.ribbon.items[0].content,\n            clicked: this.toolbarClicked.bind(this)\n        });\n        toolbarObj.createElement = this.parent.createElement;\n        toolbarObj.appendTo(toolbar);\n        toolbarPanel.style.display = '';\n    };\n    Ribbon.prototype.fileMenuBeforeOpen = function (args) {\n        var _this = this;\n        var l10n = this.parent.serviceLocator.getService(locale);\n        var wrapper;\n        var contents = ['.xlsx', '.xls', '.csv'];\n        if (args.parentItem.text === l10n.getConstant('SaveAs')) {\n            [].slice.call(args.element.children).forEach(function (li, index) {\n                wrapper = _this.parent.createElement('div', { innerHTML: li.innerHTML });\n                li.innerHTML = '';\n                wrapper.appendChild(_this.parent.createElement('span', { className: 'e-extension', innerHTML: contents[index] }));\n                li.appendChild(wrapper);\n            });\n        }\n        this.parent.trigger('fileMenuBeforeOpen', args);\n    };\n    Ribbon.prototype.enableRibbonTabs = function (args) {\n        this.ribbon.enableTabs(args.tabs, args.enable);\n    };\n    Ribbon.prototype.fileMenuBeforeClose = function (args) {\n        this.parent.trigger('fileMenuBeforeClose', args);\n    };\n    Ribbon.prototype.hideFileMenuItems = function (args) {\n        this.ribbon.hideMenuItems(args.items, args.hide, args.isUniqueId);\n    };\n    Ribbon.prototype.addFileMenuItems = function (args) {\n        this.ribbon.addMenuItems(args.items, args.text, args.insertAfter, args.isUniqueId);\n    };\n    Ribbon.prototype.hideToolbarItems = function (args) {\n        this.ribbon.hideToolbarItems(args.tab, args.indexes, args.hide);\n    };\n    Ribbon.prototype.protectSheetHandler = function (args) {\n        var sheet = this.parent.getActiveSheet();\n        var l10n = this.parent.serviceLocator.getService(locale);\n        if ((sheet.isProtected && sheet.protectSettings.formatCells) || !sheet.isProtected) {\n            this.enableToolbarItems([{ tab: l10n.getConstant('Home'), items: args.enableHomeBtnId, enable: true }]);\n            this.parent.notify(setUndoRedo, null);\n        }\n        else {\n            this.enableToolbarItems([{ tab: l10n.getConstant('Home'), items: args.disableHomeBtnId, enable: false }]);\n        }\n        if ((sheet.isProtected && sheet.protectSettings.insertLink) || !sheet.isProtected) {\n            this.enableToolbarItems([{ tab: l10n.getConstant('Insert'), items: args.enableInsertBtnId, enable: true }]);\n        }\n        else {\n            this.enableToolbarItems([{ tab: l10n.getConstant('Insert'), items: args.enableInsertBtnId, enable: false }]);\n        }\n        if ((sheet.isProtected && sheet.protectSettings.selectCells) || !sheet.isProtected) {\n            this.enableToolbarItems([{ tab: l10n.getConstant('Home'), items: args.findBtnId, enable: true }]);\n        }\n        else {\n            this.enableToolbarItems([{ tab: l10n.getConstant('Home'), items: args.findBtnId, enable: false }]);\n        }\n        if (sheet.isProtected) {\n            this.enableToolbarItems([{ tab: l10n.getConstant('Data'), items: args.dataValidationBtnId, enable: false }]);\n            this.enableToolbarItems([{ tab: l10n.getConstant('Formulas'), items: args.enableFrmlaBtnId, enable: false }]);\n            this.enableToolbarItems([{ tab: l10n.getConstant('Insert'), items: args.imageBtnId, enable: false }]);\n            this.enableToolbarItems([{ tab: l10n.getConstant('Insert'), items: args.chartBtnId, enable: false }]);\n        }\n        else {\n            this.enableToolbarItems([{ tab: l10n.getConstant('Data'), items: args.dataValidationBtnId, enable: true }]);\n            this.enableToolbarItems([{ tab: l10n.getConstant('Formulas'), items: args.enableFrmlaBtnId, enable: true }]);\n            this.enableToolbarItems([{ tab: l10n.getConstant('Insert'), items: args.imageBtnId, enable: true }]);\n            this.enableToolbarItems([{ tab: l10n.getConstant('Insert'), items: args.chartBtnId, enable: true }]);\n        }\n    };\n    Ribbon.prototype.updateMergeItem = function (e) {\n        if (e.type === 'mousemove' || e.type === 'pointermove' || (e.shiftKey && e.type === 'mousedown')) {\n            var indexes = getRangeIndexes(this.parent.getActiveSheet().selectedRange);\n            if ((indexes[1] !== indexes[3] || indexes[0] !== indexes[2]) && !this.parent.getActiveSheet().isProtected) {\n                this.enableToolbarItems([{ tab: this.parent.serviceLocator.getService(locale).getConstant('Home'),\n                        items: [this.parent.element.id + \"_merge_cells\"], enable: true }]);\n                this.toggleActiveState(false);\n            }\n        }\n    };\n    Ribbon.prototype.addEventListener = function () {\n        this.parent.on(ribbon, this.initRibbon, this);\n        this.parent.on(enableToolbarItems, this.enableToolbarItems, this);\n        this.parent.on(activeCellChanged, this.refreshRibbonContent, this);\n        this.parent.on(updateToggleItem, this.toggleRibbonItems, this);\n        this.parent.on(enableFileMenuItems, this.enableFileMenuItems, this);\n        this.parent.on(hideRibbonTabs, this.hideRibbonTabs, this);\n        this.parent.on(addRibbonTabs, this.addRibbonTabs, this);\n        this.parent.on(addToolbarItems, this.addToolbarItems, this);\n        this.parent.on(hideFileMenuItems, this.hideFileMenuItems, this);\n        this.parent.on(addFileMenuItems, this.addFileMenuItems, this);\n        this.parent.on(hideToolbarItems, this.hideToolbarItems, this);\n        this.parent.on(enableRibbonTabs, this.enableRibbonTabs, this);\n        this.parent.on(protectCellFormat, this.protectSheetHandler, this);\n        this.parent.on(selectionComplete, this.updateMergeItem, this);\n        this.parent.on(refreshRibbonIcons, this.refreshToggleBtn, this);\n    };\n    Ribbon.prototype.destroy = function () {\n        var parentElem = this.parent.element;\n        var ribbonEle = this.ribbon.element;\n        var id = parentElem.id;\n        ['bold', 'italic', 'line-through', 'underline'].forEach(function (name) {\n            destroyComponent(select('#' + (id + \"_\" + name), parentElem), Button);\n        });\n        this.pasteSplitBtn.destroy();\n        this.pasteSplitBtn = null;\n        this.mergeSplitBtn.destroy();\n        this.mergeSplitBtn = null;\n        this.numFormatDDB.destroy();\n        this.numFormatDDB = null;\n        this.fontSizeDdb.destroy();\n        this.fontSizeDdb = null;\n        this.fontNameDdb.destroy();\n        this.fontNameDdb = null;\n        this.textAlignDdb.destroy();\n        this.textAlignDdb = null;\n        this.verticalAlignDdb.destroy();\n        this.verticalAlignDdb = null;\n        this.sortingDdb.destroy();\n        this.sortingDdb = null;\n        this.clearDdb.destroy();\n        this.clearDdb = null;\n        this.colorPicker.destroy();\n        this.colorPicker = null;\n        this.bordersMenu.destroy();\n        this.bordersMenu = null;\n        this.bordersDdb.destroy();\n        this.bordersDdb = null;\n        this.findDdb.destroy();\n        this.findDdb = null;\n        this.chartDdb.destroy();\n        this.chartDdb = null;\n        this.chartMenu.destroy();\n        this.chartMenu = null;\n        this.parent.notify('destroyRibbonComponents', null);\n        this.ribbon.destroy();\n        if (ribbonEle) {\n            detach(ribbonEle);\n        }\n        this.ribbon = null;\n        this.removeEventListener();\n    };\n    Ribbon.prototype.removeEventListener = function () {\n        if (!this.parent.isDestroyed) {\n            this.parent.off(ribbon, this.initRibbon);\n            this.parent.off(enableToolbarItems, this.enableToolbarItems);\n            this.parent.off(activeCellChanged, this.refreshRibbonContent);\n            this.parent.off(updateToggleItem, this.toggleRibbonItems);\n            this.parent.off(enableFileMenuItems, this.enableFileMenuItems);\n            this.parent.off(hideRibbonTabs, this.hideRibbonTabs);\n            this.parent.off(addRibbonTabs, this.addRibbonTabs);\n            this.parent.off(addToolbarItems, this.addToolbarItems);\n            this.parent.off(hideFileMenuItems, this.hideFileMenuItems);\n            this.parent.off(addFileMenuItems, this.addFileMenuItems);\n            this.parent.off(hideToolbarItems, this.hideToolbarItems);\n            this.parent.off(enableRibbonTabs, this.enableRibbonTabs);\n            this.parent.off(protectCellFormat, this.protectSheetHandler);\n            this.parent.off(selectionComplete, this.updateMergeItem);\n            this.parent.off(refreshRibbonIcons, this.refreshToggleBtn);\n        }\n    };\n    return Ribbon;\n}());\nexport { Ribbon };\n","import { formulaBar, locale, selectionComplete, enableFormulaInput } from '../common/index';\nimport { mouseUpAfterSelection, click } from '../common/index';\nimport { getRangeIndexes, getRangeFromAddress, getCellAddress, getCellIndexes } from './../../workbook/common/address';\nimport { getSheetName, getTypeFromFormat, getSheet, checkIsFormula } from '../../workbook/index';\nimport { updateSelectedRange, getSheetNameFromAddress, getSheetIndex } from '../../workbook/index';\nimport { ComboBox, DropDownList } from '@syncfusion/ej2-dropdowns';\nimport { rippleEffect, EventHandler, detach, Internationalization, isNullOrUndefined, closest, select } from '@syncfusion/ej2-base';\nimport { isUndefined } from '@syncfusion/ej2-base';\nimport { editOperation, formulaBarOperation, keyDown, keyUp, formulaOperation, editAlert, editValue } from '../common/event';\nimport { intToDate } from '../../workbook/common/math';\nimport { ListView } from '@syncfusion/ej2-lists';\nimport { workbookFormulaOperation } from '../../workbook/common/event';\nimport { isFormulaBarEdit } from '../common/event';\n/**\n * Represents Formula bar for Spreadsheet.\n */\nvar FormulaBar = /** @class */ (function () {\n    function FormulaBar(parent) {\n        this.categoryCollection = [];\n        this.formulaCollection = [];\n        this.isGoto = false;\n        this.parent = parent;\n        this.addEventListener();\n    }\n    FormulaBar.prototype.getModuleName = function () {\n        return 'formulaBar';\n    };\n    FormulaBar.prototype.createFormulaBar = function (args) {\n        if (!this.parent.showFormulaBar && this.insertFnRipple) {\n            this.destroy();\n            return;\n        }\n        var l10n = this.parent.serviceLocator.getService(locale);\n        var id = this.parent.element.id;\n        var fBarWrapper = this.parent.createElement('div', { className: 'e-formula-bar-panel' });\n        if (!this.parent.isMobileView()) {\n            var nameBox = this.parent.createElement('input', { id: id + '_name_box', attrs: { type: 'text' } });\n            fBarWrapper.appendChild(nameBox);\n            this.comboBoxInstance = new ComboBox({\n                value: 'A1',\n                cssClass: 'e-name-box',\n                width: '',\n                noRecordsTemplate: '',\n                fields: { text: 'name', value: 'refersTo' },\n                beforeOpen: this.nameBoxBeforeOpen.bind(this),\n                blur: this.nameBoxBlur.bind(this),\n                select: this.nameBoxSelect.bind(this),\n                change: function (args) {\n                    /** */\n                }\n            });\n            this.comboBoxInstance.createElement = this.parent.createElement;\n            this.comboBoxInstance.appendTo(nameBox);\n            this.comboBoxInstance.element.parentElement.title = l10n.getConstant('NameBox');\n        }\n        var insertFnBtn = fBarWrapper.appendChild(this.parent.createElement('button', {\n            className: 'e-btn e-css e-flat e-icon-btn e-insert-function', attrs: { 'title': l10n.getConstant('InsertFunction') }\n        }));\n        insertFnBtn.appendChild(this.parent.createElement('span', { className: 'e-btn-icon e-icons' }));\n        this.insertFnRipple = rippleEffect(fBarWrapper, { selector: '.e-insert-function' });\n        fBarWrapper.appendChild(this.parent.createElement('div', { className: 'e-separator' }));\n        var textarea = fBarWrapper.appendChild(this.parent.createElement('textarea', {\n            className: 'e-formula-bar e-css', id: id + '_formula_input',\n            attrs: { 'title': l10n.getConstant('FormulaBar'), 'spellcheck': 'false' }\n        }));\n        textarea.rows = 1;\n        if (this.parent.isMobileView()) {\n            textarea.placeholder = l10n.getConstant('MobileFormulaBarPlaceHolder');\n            EventHandler.add(textarea, 'focus', this.textAreaFocusIn, this);\n            EventHandler.add(textarea, 'blur', this.textAreaFocusOut, this);\n        }\n        else {\n            fBarWrapper.appendChild(this.parent.createElement('span', {\n                className: 'e-drop-icon e-icons', attrs: { 'title': l10n.getConstant('ExpandFormulaBar') }\n            }));\n        }\n        if (args && args.uiUpdate) {\n            this.parent.element.insertBefore(fBarWrapper, document.getElementById(id + '_sheet_panel'));\n        }\n        else {\n            this.parent.element.appendChild(fBarWrapper);\n        }\n    };\n    FormulaBar.prototype.textAreaFocusIn = function (e) {\n        var formulaPanel = this.parent.element.querySelector('.e-formula-bar-panel');\n        var tickBtn = this.parent.createElement('button', { className: 'e-btn e-css e-flat e-icon-btn e-formula-submit' });\n        tickBtn.appendChild(this.parent.createElement('span', { className: 'e-btn-icon e-icons e-tick-icon' }));\n        formulaPanel.classList.add('e-focused');\n        formulaPanel.appendChild(tickBtn);\n    };\n    FormulaBar.prototype.textAreaFocusOut = function (e) {\n        var formulaPanel = this.parent.element.querySelector('.e-formula-bar-panel');\n        formulaPanel.classList.remove('e-focused');\n        detach(formulaPanel.querySelector('.e-formula-submit'));\n    };\n    FormulaBar.prototype.keyDownHandler = function (e) {\n        var trgtElem = e.target;\n        if (this.parent.isEdit && !this.parent.getActiveSheet().isProtected) {\n            if ((checkIsFormula(trgtElem.value) || (trgtElem.validity && trgtElem.value.toString().indexOf('=') === 0)) &&\n                e.keyCode === 16) {\n                return;\n            }\n            if (trgtElem.classList.contains('e-formula-bar')) {\n                this.parent.notify(editOperation, { action: 'refreshEditor', value: trgtElem.value, refreshEditorElem: true });\n            }\n        }\n    };\n    FormulaBar.prototype.keyUpHandler = function (e) {\n        if (this.parent.isEdit) {\n            var trgtElem = e.target;\n            if (trgtElem.classList.contains('e-formula-bar')) {\n                var eventArg = { action: 'getCurrentEditValue', editedValue: '' };\n                this.parent.notify(editOperation, eventArg);\n                if (eventArg.editedValue !== trgtElem.value && e.keyCode !== 16) {\n                    this.parent.notify(editOperation, { action: 'refreshEditor', value: trgtElem.value, refreshEditorElem: true });\n                }\n            }\n        }\n    };\n    FormulaBar.prototype.nameBoxBeforeOpen = function (args) {\n        if (this.comboBoxInstance.element.classList.contains('e-name-editing')) {\n            args.cancel = true;\n        }\n        else {\n            this.comboBoxInstance.element.select();\n        }\n    };\n    FormulaBar.prototype.nameBoxBlur = function (args) {\n        if (this.comboBoxInstance.element.classList.contains('e-name-editing')) {\n            this.comboBoxInstance.element.classList.remove('e-name-editing');\n            this.UpdateValueAfterMouseUp();\n        }\n    };\n    FormulaBar.prototype.nameBoxSelect = function (args) {\n        if (args.isInteracted) {\n            var refersTo = args.itemData.refersTo.substr(1);\n            var sheetIdx = getSheetIndex(this.parent, getSheetNameFromAddress(refersTo));\n            var range = getRangeFromAddress(refersTo);\n            var sheet = getSheet(this.parent, sheetIdx);\n            if (range.indexOf(':') !== -1) {\n                var colIndex = range.indexOf(':');\n                var left = range.substr(0, colIndex);\n                var right = range.substr(colIndex + 1, range.length);\n                left = left.replace('$', '');\n                right = right.replace('$', '');\n                if (right.match(/\\D/g) && !right.match(/[0-9]/g) && left.match(/\\D/g) && !left.match(/[0-9]/g)) {\n                    left = left + '1';\n                    right = right + sheet.rowCount;\n                    range = left + ':' + right;\n                }\n                else if (!right.match(/\\D/g) && right.match(/[0-9]/g) && !left.match(/\\D/g) && left.match(/[0-9]/g)) {\n                    left = getCellAddress(parseInt(left, 10) - 1, 0);\n                    right = getCellAddress(parseInt(right, 10) - 1, sheet.colCount - 1);\n                    range = left + ':' + right;\n                }\n            }\n            if ((sheetIdx) === this.parent.activeSheetIndex) {\n                this.parent.selectRange(range);\n                this.parent.element.focus();\n            }\n            else {\n                updateSelectedRange(this.parent, range, sheet);\n                this.parent.activeSheetIndex = sheetIdx;\n            }\n        }\n    };\n    FormulaBar.prototype.formulaBarUpdateHandler = function (e) {\n        var _this = this;\n        var sheet = this.parent.getActiveSheet();\n        var range = sheet.selectedRange.split(':');\n        var address;\n        var intl = new Internationalization();\n        if (e.type === 'mousemove' || e.type === 'pointermove') {\n            var indexes1 = getRangeIndexes(range[0]);\n            var indexes2 = getRangeIndexes(range[1]);\n            address = Math.abs(indexes1[0] - indexes2[0]) + 1 + \"R x \" + (Math.abs(indexes1[1] - indexes2[1]) + 1) + \"C\";\n            if (this.parent.isEdit) {\n                this.parent.notify(editValue, null);\n            }\n        }\n        else {\n            address = range[0];\n            var data = this.parent.getData(getSheetName(this.parent) + \"!\" + address);\n            data.then(function (values) {\n                var value = '';\n                var intDate;\n                values.forEach(function (cell, key) {\n                    var type = cell && cell.format ? getTypeFromFormat(cell.format) : 'General';\n                    if (cell) {\n                        if (!isNullOrUndefined(cell.value)) {\n                            intDate = intToDate(Number(cell.value));\n                            if (intDate.toString() !== 'Invalid Date' && (type === 'ShortDate' || type === 'LongDate')) {\n                                value = intl.formatDate(intDate, {\n                                    type: 'date',\n                                    skeleton: 'yMd'\n                                });\n                            }\n                            else if (intDate.toString() !== 'Invalid Date' && type === 'Time') {\n                                value = intl.formatDate(intDate, {\n                                    type: 'dateTime',\n                                    skeleton: 'yMd'\n                                }) + ' ' + intl.formatDate(intDate, {\n                                    type: 'dateTime',\n                                    skeleton: 'hms'\n                                });\n                            }\n                            else {\n                                value = cell.value;\n                            }\n                        }\n                        if (cell.formula) {\n                            value = cell.formula;\n                        }\n                    }\n                    var eventArgs = { action: 'getCurrentEditValue', editedValue: '' };\n                    _this.parent.notify(editOperation, eventArgs);\n                    var isFormulaEdit = (eventArgs.editedValue && eventArgs.editedValue.toString().indexOf('=') === 0) ||\n                        checkIsFormula(eventArgs.editedValue);\n                    var formulaInp = document.getElementById(_this.parent.element.id + '_formula_input');\n                    formulaInp.value = value;\n                    if (!isNullOrUndefined(value) && !isFormulaEdit) {\n                        _this.parent.notify(editOperation, { action: 'refreshEditor', value: formulaInp.value, refreshEditorElem: true });\n                    }\n                    if (_this.parent.isEdit) {\n                        _this.parent.notify(editValue, null);\n                    }\n                });\n            });\n        }\n        this.updateComboBoxValue(address);\n    };\n    FormulaBar.prototype.UpdateValueAfterMouseUp = function () {\n        this.updateComboBoxValue(this.parent.getActiveSheet().selectedRange.split(':')[0]);\n    };\n    FormulaBar.prototype.updateComboBoxValue = function (value) {\n        var sheet = this.parent.getActiveSheet();\n        var range = getSheetName(this.parent) + '!' + sheet.selectedRange;\n        var eventArgs = {\n            action: 'getNameFromRange', range: range, definedName: null\n        };\n        this.parent.notify(formulaOperation, eventArgs);\n        if (eventArgs.definedName) {\n            value = eventArgs.definedName.name;\n        }\n        if (!this.parent.isMobileView()) {\n            if (this.comboBoxInstance.text === value) {\n                return;\n            }\n            this.comboBoxInstance.text = value;\n            this.comboBoxInstance.dataBind();\n        }\n    };\n    FormulaBar.prototype.disabletextarea = function () {\n        var element = this.getFormulaBar();\n        if (this.parent.getActiveSheet().isProtected) {\n            element.disabled = true;\n        }\n        else {\n            element.disabled = false;\n        }\n    };\n    FormulaBar.prototype.formulaBarScrollEdit = function () {\n        var index = getRangeIndexes(this.parent.getActiveSheet().selectedRange);\n        var viewportIndexes = getCellIndexes(this.parent.getActiveSheet().topLeftCell);\n        if (index[0] < viewportIndexes[0]) {\n            this.parent.goTo(this.parent.getActiveSheet().selectedRange);\n            this.isGoto = true;\n        }\n        this.parent.notify(editOperation, { action: 'startEdit', refreshCurPos: false });\n    };\n    FormulaBar.prototype.formulaBarClickHandler = function (e) {\n        var _this = this;\n        var target = e.target;\n        if (target.classList.contains('e-drop-icon') && closest(target, '.e-formula-bar-panel')) {\n            this.toggleFormulaBar(target);\n        }\n        else if (target.classList.contains('e-formula-bar')) {\n            if (!this.parent.isEdit && !this.parent.getActiveSheet().isProtected) {\n                this.formulaBarScrollEdit();\n            }\n            else if (this.parent.getActiveSheet().isProtected) {\n                this.parent.notify(editAlert, null);\n            }\n        }\n        else if (target.parentElement && target.parentElement.classList.contains('e-name-box')) {\n            if (target.classList.contains('e-ddl-icon')) {\n                var eventArgs = { action: 'getNames', names: [] };\n                this.parent.notify(formulaOperation, eventArgs);\n                this.comboBoxInstance.dataSource = eventArgs.names;\n            }\n            else {\n                this.comboBoxInstance.element.classList.add('e-name-editing');\n                this.comboBoxInstance.element.select();\n            }\n        }\n        if (!isNullOrUndefined(target.offsetParent) && ((target.offsetParent.classList.contains('e-insert-function')) ||\n            (target.classList.contains('e-insert-function')) || (this.parent.element.id + '_insert_function' === target.offsetParent.id)\n            || (this.parent.element.id + '_insert_function' === target.id) ||\n            target.parentElement.classList.contains('e-insert-function')\n            || (this.parent.element.id + '_insert_function' === target.parentElement.id))) {\n            if (this.parent.getActiveSheet().isProtected) {\n                this.parent.notify(editAlert, null);\n                return;\n            }\n            var isOpen = !this.parent.isEdit;\n            var args = { action: 'getCurrentEditValue', editedValue: '' };\n            if (!isOpen) {\n                var eventArgs = { action: 'isFormulaEditing', isFormulaEdit: false };\n                this.parent.notify(formulaOperation, eventArgs);\n                isOpen = eventArgs.isFormulaEdit;\n                this.parent.notify(editOperation, args);\n            }\n            if (isOpen || args.editedValue === '') {\n                if (args.editedValue === '') {\n                    this.parent.notify(editOperation, { action: 'refreshEditor', value: '=' });\n                }\n                var l10n = this.parent.serviceLocator.getService(locale);\n                var formulaDescription = this.parent.createElement('div', { className: 'e-formula-description', id: this.parent.element.id + '_description_content' });\n                var categoryContent = this.parent.createElement('div', {\n                    className: 'e-category-content', id: this.parent.element.id + '_category_content',\n                    innerHTML: l10n.getConstant('PickACategory')\n                });\n                var dropDownElement = this.parent.createElement('input', { className: 'e-formula-category', id: this.parent.element.id + '_formula_category' });\n                var listViewElement = this.parent.createElement('div', { className: 'e-formula-list', id: this.parent.element.id + '_formula_list' });\n                var descriptionContent = this.parent.createElement('div', { className: 'e-description-content', innerHTML: l10n.getConstant('Description') });\n                var headerContent = this.parent.createElement('div', { className: 'e-header-content', innerHTML: l10n.getConstant('InsertFunction') });\n                var categoryArgs = {\n                    action: 'getFormulaCategory', categoryCollection: []\n                };\n                this.parent.notify(workbookFormulaOperation, categoryArgs);\n                this.categoryCollection = categoryArgs.categoryCollection;\n                this.categoryList = new DropDownList({\n                    dataSource: this.categoryCollection, index: 0, width: '285px', popupHeight: '210px',\n                    select: this.dropDownSelect.bind(this)\n                });\n                var listArgs = {\n                    action: 'getLibraryFormulas', formulaCollection: []\n                };\n                this.parent.notify(workbookFormulaOperation, listArgs);\n                this.formulaCollection = listArgs.formulaCollection;\n                this.formulaList = new ListView({\n                    dataSource: this.formulaCollection.sort(),\n                    actionComplete: this.updateFormulaList.bind(this),\n                    select: this.listSelected.bind(this), width: '285px', height: '200px'\n                });\n                this.dialog = this.parent.serviceLocator.getService('dialog');\n                this.dialog.show({\n                    header: headerContent.outerHTML,\n                    content: categoryContent.outerHTML + dropDownElement.outerHTML + listViewElement.outerHTML +\n                        descriptionContent.outerHTML + formulaDescription.outerHTML,\n                    width: '320px', height: '485px', cssClass: 'e-spreadsheet-function-dlg',\n                    showCloseIcon: true, isModal: true,\n                    beforeOpen: function (args) {\n                        var dlgArgs = {\n                            dialogName: 'InsertFunctionDialog', element: args.element, target: args.target, cancel: args.cancel\n                        };\n                        _this.parent.trigger('dialogBeforeOpen', dlgArgs);\n                        if (dlgArgs.cancel) {\n                            args.cancel = true;\n                        }\n                        _this.parent.element.focus();\n                    },\n                    open: this.dialogOpen.bind(this), beforeClose: this.dialogBeforeClose.bind(this), close: this.dialogClose.bind(this),\n                    buttons: [\n                        {\n                            click: (this.selectFormula.bind(this, this.dialog, this)),\n                            buttonModel: { content: l10n.getConstant('Ok'), isPrimary: true }\n                        }\n                    ]\n                });\n                this.categoryList.appendTo('#' + this.parent.element.id + '_formula_category');\n                this.formulaList.appendTo('#' + this.parent.element.id + '_formula_list');\n                EventHandler.add(this.formulaList.element, 'dblclick', this.formulaClickHandler, this);\n            }\n        }\n    };\n    FormulaBar.prototype.toggleFormulaBar = function (target) {\n        var parent = target.parentElement;\n        var l10n = this.parent.serviceLocator.getService(locale);\n        if (parent.classList.contains('e-expanded')) {\n            parent.classList.remove('e-expanded');\n            document.getElementById(this.parent.element.id + '_formula_input').rows = 1;\n            target.title = l10n.getConstant('ExpandFormulaBar');\n        }\n        else {\n            parent.classList.add('e-expanded');\n            document.getElementById(this.parent.element.id + '_formula_input').rows = 3;\n            target.title = l10n.getConstant('CollapseFormulaBar');\n        }\n        this.parent.setPanelSize();\n    };\n    FormulaBar.prototype.dialogOpen = function () {\n        this.focusOkButton();\n    };\n    FormulaBar.prototype.dialogClose = function () {\n        var args = { action: 'getCurrentEditValue', editedValue: '' };\n        this.parent.notify(editOperation, args);\n        if (args.editedValue.toString().trim() === '=') {\n            this.parent.notify(editOperation, { action: 'refreshEditor', value: '' });\n        }\n    };\n    FormulaBar.prototype.dialogBeforeClose = function () {\n        EventHandler.remove(this.formulaList.element, 'dblclick', this.formulaClickHandler);\n        var dialogContentEle = document.getElementById('_dialog-content');\n        dialogContentEle.parentNode.removeChild(dialogContentEle);\n        /* tslint:disable-next-line:no-any */\n        this.dialog.dialogInstance.storeActiveElement = document.getElementById(this.parent.element.id + '_edit');\n    };\n    FormulaBar.prototype.selectFormula = function (dialog, formulaBarObj) {\n        var formulaText = formulaBarObj.formulaList.getSelectedItems().text;\n        var sheet = getSheet(this.parent, this.parent.activeSheetIndex);\n        if (this.parent.isEdit) {\n            this.parent.notify(editOperation, {\n                action: 'refreshEditor', value: formulaText + '(', refreshFormulaBar: true,\n                refreshEditorElem: true, isAppend: true\n            });\n        }\n        else {\n            this.parent.notify(editOperation, { action: 'startEdit', value: '=' + formulaText + '(', address: sheet.activeCell });\n            this.parent.notify(formulaBarOperation, { action: 'refreshFormulabar', value: '=' + formulaText + '(' });\n        }\n        dialog.hide();\n    };\n    FormulaBar.prototype.listSelected = function () {\n        this.updateFormulaDescription();\n    };\n    FormulaBar.prototype.updateFormulaList = function () {\n        this.activeListFormula();\n        this.updateFormulaDescription();\n    };\n    FormulaBar.prototype.dropDownSelect = function (args) {\n        this.formulaCollection = [];\n        var listArgs = {\n            action: 'getLibraryFormulas',\n            formulaCollection: []\n        };\n        if (args.item.textContent === 'All') {\n            this.parent.notify(workbookFormulaOperation, listArgs);\n            this.formulaCollection = listArgs.formulaCollection;\n        }\n        else {\n            var category = args.item.textContent;\n            var selectArgs = {\n                action: 'dropDownSelectFormulas',\n                formulaCollection: [],\n                selectCategory: category,\n            };\n            this.parent.notify(workbookFormulaOperation, selectArgs);\n            this.formulaCollection = selectArgs.formulaCollection;\n        }\n        this.formulaList.dataSource = this.formulaCollection.sort();\n    };\n    FormulaBar.prototype.focusOkButton = function () {\n        var focusEle = document.getElementById('_dialog-content');\n        (focusEle.nextElementSibling.firstElementChild).focus();\n    };\n    FormulaBar.prototype.activeListFormula = function () {\n        var acListEle = document.getElementById(this.parent.element.id + '_formula_list');\n        var firstElement = acListEle.children[0].children[0].firstElementChild;\n        this.formulaList.selectItem(firstElement);\n    };\n    FormulaBar.prototype.updateFormulaDescription = function () {\n        var descriptionArea;\n        var selectedFormula = this.formulaList.getSelectedItems().text;\n        var descriptionArgs = {\n            action: 'getFormulaDescription',\n            description: '',\n            selectedList: selectedFormula,\n        };\n        this.parent.notify(workbookFormulaOperation, descriptionArgs);\n        this.focusOkButton();\n        descriptionArea = document.getElementById(this.parent.element.id + '_description_content');\n        selectedFormula = (selectedFormula === 'AND') ? 'CalculateAND' : (selectedFormula === 'OR') ? 'CalculateOR' : selectedFormula;\n        descriptionArea.innerHTML = this.parent.serviceLocator.getService(locale).getConstant(selectedFormula);\n    };\n    FormulaBar.prototype.formulaClickHandler = function (args) {\n        var trgtElem = args.target;\n        var sheet = getSheet(this.parent, this.parent.activeSheetIndex);\n        if (trgtElem.offsetParent.classList.contains('e-text-content') || trgtElem.classList.contains('e-list-item')) {\n            if (this.parent.isEdit) {\n                this.parent.notify(editOperation, {\n                    action: 'refreshEditor', value: trgtElem.innerText + '(', refreshFormulaBar: true,\n                    refreshEditorElem: true, isAppend: true\n                });\n            }\n            else {\n                this.parent.notify(editOperation, { action: 'startEdit', value: '=' + trgtElem.innerText + '(', address: sheet.activeCell });\n                this.parent.notify(formulaBarOperation, { action: 'refreshFormulabar', value: '=' + trgtElem.innerText + '(' });\n            }\n            this.dialog.hide();\n        }\n    };\n    FormulaBar.prototype.addEventListener = function () {\n        this.parent.on(formulaBar, this.createFormulaBar, this);\n        this.parent.on(click, this.formulaBarClickHandler, this);\n        this.parent.on(keyDown, this.keyDownHandler, this);\n        this.parent.on(keyUp, this.keyUpHandler, this);\n        this.parent.on(selectionComplete, this.formulaBarUpdateHandler, this);\n        this.parent.on(mouseUpAfterSelection, this.UpdateValueAfterMouseUp, this);\n        this.parent.on(formulaBarOperation, this.editOperationHandler, this);\n        this.parent.on(enableFormulaInput, this.disabletextarea, this);\n        this.parent.on(isFormulaBarEdit, this.isFormulaBarEdit, this);\n    };\n    FormulaBar.prototype.destroy = function () {\n        this.removeEventListener();\n        this.comboBoxInstance.destroy();\n        this.comboBoxInstance = null;\n        this.insertFnRipple();\n        this.insertFnRipple = null;\n        var formulaPanel = this.parent.element.querySelector('.e-formula-bar-panel');\n        if (formulaPanel) {\n            detach(formulaPanel);\n        }\n    };\n    FormulaBar.prototype.removeEventListener = function () {\n        if (!this.parent.isDestroyed) {\n            this.parent.off(formulaBar, this.createFormulaBar);\n            this.parent.off(click, this.formulaBarClickHandler);\n            this.parent.off(keyDown, this.keyDownHandler);\n            this.parent.off(keyUp, this.keyUpHandler);\n            this.parent.off(selectionComplete, this.formulaBarUpdateHandler);\n            this.parent.off(mouseUpAfterSelection, this.UpdateValueAfterMouseUp);\n            this.parent.off(formulaBarOperation, this.editOperationHandler);\n            this.parent.off(enableFormulaInput, this.disabletextarea);\n            this.parent.off(isFormulaBarEdit, this.isFormulaBarEdit);\n        }\n    };\n    FormulaBar.prototype.editOperationHandler = function (args) {\n        var action = args.action;\n        switch (action) {\n            case 'refreshFormulabar':\n                this.getFormulaBar().value = isUndefined(args.value) ? '' : args.value;\n                break;\n            case 'getPosition':\n                args.position = this.getFormulaBar().getBoundingClientRect();\n                break;\n        }\n    };\n    FormulaBar.prototype.isFormulaBarEdit = function (args) {\n        var edit = this.parent.isEdit;\n        if (edit && this.isGoto) {\n            args.isEdit = true;\n        }\n        else {\n            args.isEdit = false;\n        }\n    };\n    FormulaBar.prototype.getFormulaBar = function () {\n        return select('#' + this.parent.element.id + '_formula_input', this.parent.element);\n    };\n    return FormulaBar;\n}());\nexport { FormulaBar };\n","import { formulaOperation, keyUp, keyDown, click, refreshFormulaDatasource } from '../common/event';\nimport { editOperation, formulaBarOperation } from '../common/event';\nimport { workbookFormulaOperation } from '../../workbook/common/event';\nimport { AutoComplete } from '@syncfusion/ej2-dropdowns';\nimport { detach, isNullOrUndefined, select } from '@syncfusion/ej2-base';\nimport { checkIsFormula, getSheet, getSheetName, getCellIndexes } from '../../workbook/index';\nimport { dialog, locale } from '../common/index';\n/**\n * @hidden\n * The `Formula` module is used to handle the formulas and its functionalities in Spreadsheet.\n */\nvar Formula = /** @class */ (function () {\n    /**\n     * Constructor for formula module in Spreadsheet.\n     * @private\n     */\n    function Formula(parent) {\n        this.isFormulaBar = false;\n        this.isFormula = false;\n        this.isPopupOpened = false;\n        this.isPreventClose = false;\n        this.isSubFormula = false;\n        this.keyCodes = {\n            UP: 38,\n            DOWN: 40,\n            LEFT: 37,\n            RIGHT: 39,\n            FIRSTALPHABET: 65,\n            LASTALPHABET: 90,\n            SPACE: 32,\n            BACKSPACE: 8,\n            TAB: 9,\n            DELETE: 46,\n            ENTER: 13,\n            ESC: 27\n        };\n        this.parent = parent;\n        this.addEventListener();\n        //Spreadsheet.Inject(WorkbookFormula);\n    }\n    /**\n     * Get the module name.\n     * @returns string\n     * @private\n     */\n    Formula.prototype.getModuleName = function () {\n        return 'formula';\n    };\n    /**\n     * To destroy the formula module.\n     * @return {void}\n     * @hidden\n     */\n    Formula.prototype.destroy = function () {\n        this.removeEventListener();\n        if (this.autocompleteInstance) {\n            this.autocompleteInstance.destroy();\n            if (this.autocompleteInstance.element) {\n                this.autocompleteInstance.element.remove();\n            }\n        }\n        this.autocompleteInstance = null;\n        this.parent = null;\n    };\n    Formula.prototype.addEventListener = function () {\n        this.parent.on(formulaOperation, this.performFormulaOperation, this);\n        this.parent.on(keyUp, this.keyUpHandler, this);\n        this.parent.on(keyDown, this.keyDownHandler, this);\n        this.parent.on(click, this.formulaClick, this);\n        this.parent.on(refreshFormulaDatasource, this.refreshFormulaDatasource, this);\n    };\n    Formula.prototype.removeEventListener = function () {\n        if (!this.parent.isDestroyed) {\n            this.parent.off(formulaOperation, this.performFormulaOperation);\n            this.parent.off(keyUp, this.keyUpHandler);\n            this.parent.off(keyDown, this.keyDownHandler);\n            this.parent.off(click, this.formulaClick);\n            this.parent.off(refreshFormulaDatasource, this.refreshFormulaDatasource);\n        }\n    };\n    Formula.prototype.performFormulaOperation = function (args) {\n        var _this = this;\n        var action = args.action;\n        switch (action) {\n            case 'renderAutoComplete':\n                this.renderAutoComplete();\n                break;\n            case 'endEdit':\n                this.endEdit();\n                break;\n            case 'addDefinedName':\n                args.isAdded = this.addDefinedName(args.definedName);\n                break;\n            case 'getNames':\n                if (!args.sheetName) {\n                    args.sheetName = getSheetName(this.parent);\n                }\n                args.names = this.getNames(args.sheetName);\n                break;\n            case 'getNameFromRange':\n                args.definedName = this.getNameFromRange(args.range);\n                break;\n            case 'isFormulaEditing':\n                args.isFormulaEdit = this.isFormula;\n                break;\n            case 'isCircularReference':\n                var l10n = this.parent.serviceLocator.getService(locale);\n                var dialogInst = this.parent.serviceLocator.getService(dialog);\n                dialogInst.show({\n                    height: 180, width: 400, isModal: true, showCloseIcon: true,\n                    content: l10n.getConstant('CircularReference'),\n                    beforeOpen: function (args) {\n                        var dlgArgs = {\n                            dialogName: 'CircularReferenceDialog',\n                            element: args.element, target: args.target, cancel: args.cancel\n                        };\n                        _this.parent.trigger('dialogBeforeOpen', dlgArgs);\n                        if (dlgArgs.cancel) {\n                            args.cancel = true;\n                        }\n                    },\n                });\n                args.argValue = '0';\n                break;\n        }\n    };\n    Formula.prototype.renderAutoComplete = function () {\n        if (!select('#' + this.parent.element.id + '_ac', this.parent.element)) {\n            var acElem = this.parent.createElement('input', { id: this.parent.element.id + '_ac', className: 'e-ss-ac' });\n            this.parent.element.appendChild(acElem);\n            var eventArgs = {\n                action: 'getLibraryFormulas',\n                formulaCollection: []\n            };\n            this.parent.notify(workbookFormulaOperation, eventArgs);\n            var autoCompleteOptions = {\n                dataSource: eventArgs.formulaCollection,\n                cssClass: 'e-ss-atc',\n                popupWidth: '130px',\n                allowFiltering: true,\n                filterType: 'StartsWith',\n                sortOrder: 'Ascending',\n                open: this.onSuggestionOpen.bind(this),\n                close: this.onSuggestionClose.bind(this),\n                select: this.onSelect.bind(this),\n                actionComplete: this.onSuggestionComplete.bind(this)\n            };\n            this.autocompleteInstance = new AutoComplete(autoCompleteOptions, acElem);\n            this.autocompleteInstance.createElement = this.parent.createElement;\n        }\n    };\n    Formula.prototype.onSuggestionOpen = function (e) {\n        var _this = this;\n        this.isPopupOpened = true;\n        var position = this.getPopupPosition();\n        e.popup.offsetX = position.left;\n        e.popup.offsetY = (position.top + position.height);\n        e.popup.refreshPosition();\n        e.popup.element.firstChild.style.maxHeight = '180px';\n        new Promise(function (resolve, reject) {\n            setTimeout(function () { resolve(); }, 100);\n        }).then(function () {\n            _this.triggerKeyDownEvent(_this.keyCodes.DOWN);\n        });\n    };\n    Formula.prototype.onSuggestionClose = function (e) {\n        if (this.isPreventClose) {\n            e.cancel = true;\n        }\n        else {\n            this.isPopupOpened = false;\n        }\n    };\n    Formula.prototype.onSelect = function (e) {\n        var updatedFormulaValue = '=' + e.itemData.value + '(';\n        if (this.isSubFormula) {\n            var editValue = this.getEditingValue();\n            var parseIndex = editValue.lastIndexOf(this.getArgumentSeparator());\n            if (parseIndex > -1) {\n                updatedFormulaValue = editValue.slice(0, parseIndex + 1);\n            }\n            else {\n                parseIndex = editValue.lastIndexOf('(');\n                if (parseIndex > -1) {\n                    updatedFormulaValue = editValue.slice(0, parseIndex + 1);\n                }\n            }\n            updatedFormulaValue += e.itemData.value + '(';\n        }\n        this.parent.notify(editOperation, {\n            action: 'refreshEditor', value: updatedFormulaValue,\n            refreshFormulaBar: true, refreshEditorElem: true, refreshCurPos: !this.isFormulaBar\n        });\n    };\n    Formula.prototype.onSuggestionComplete = function (args) {\n        this.isPreventClose = args.result.length > 0;\n        if (!this.isPreventClose) {\n            args.cancel = true;\n            this.hidePopUp();\n        }\n    };\n    Formula.prototype.refreshFormulaDatasource = function () {\n        var eventArgs = {\n            action: 'getLibraryFormulas',\n            formulaCollection: []\n        };\n        this.parent.notify(workbookFormulaOperation, eventArgs);\n        this.autocompleteInstance.dataSource = eventArgs.formulaCollection;\n    };\n    Formula.prototype.keyUpHandler = function (e) {\n        if (this.parent.isEdit) {\n            var editValue = this.getEditingValue();\n            this.isFormula = checkIsFormula(editValue);\n            if (this.isFormula || this.isPopupOpened) {\n                if (e.keyCode !== this.keyCodes.TAB && this.isFormula) {\n                    editValue = this.getSuggestionKeyFromFormula(editValue);\n                }\n                this.refreshFormulaSuggestion(e, editValue);\n            }\n        }\n        else if (this.isPopupOpened) {\n            this.hidePopUp();\n        }\n    };\n    Formula.prototype.keyDownHandler = function (e) {\n        var keyCode = e.keyCode;\n        if (this.isFormula) {\n            if (this.isPopupOpened) {\n                switch (keyCode) {\n                    case this.keyCodes.UP:\n                    case this.keyCodes.DOWN:\n                        e.preventDefault();\n                        this.triggerKeyDownEvent(keyCode);\n                        break;\n                    case this.keyCodes.TAB:\n                        e.preventDefault();\n                        this.triggerKeyDownEvent(this.keyCodes.ENTER);\n                        break;\n                }\n            }\n        }\n        else {\n            var trgtElem = e.target;\n            if (trgtElem.id === this.parent.element.id + '_name_box') {\n                switch (keyCode) {\n                    case this.keyCodes.ENTER:\n                        this.addDefinedName({ name: trgtElem.value });\n                        this.parent.element.focus();\n                        break;\n                    case this.keyCodes.ESC:\n                        this.parent.element.focus();\n                        break;\n                }\n            }\n        }\n    };\n    Formula.prototype.formulaClick = function (e) {\n        if (this.parent.isEdit) {\n            var trgtElem = e.target;\n            this.isFormulaBar = trgtElem.classList.contains('e-formula-bar');\n        }\n    };\n    Formula.prototype.refreshFormulaSuggestion = function (e, formula) {\n        if (formula.length > 0) {\n            var autoCompleteElem = this.autocompleteInstance.element;\n            var keyCode = e.keyCode;\n            var isSuggestionAlreadyOpened = this.isPopupOpened;\n            if (!this.isNavigationKey(keyCode)) {\n                autoCompleteElem.value = formula;\n                autoCompleteElem.dispatchEvent(new Event('input'));\n                autoCompleteElem.dispatchEvent(new Event('keyup'));\n                if (isSuggestionAlreadyOpened) {\n                    this.triggerKeyDownEvent(this.keyCodes.DOWN);\n                }\n            }\n        }\n        else {\n            if (this.isPopupOpened) {\n                this.isPreventClose = false;\n                this.hidePopUp();\n            }\n        }\n    };\n    Formula.prototype.endEdit = function () {\n        this.isSubFormula = false;\n        this.isPreventClose = false;\n        this.isFormula = false;\n        this.isFormulaBar = false;\n        if (this.isPopupOpened) {\n            this.hidePopUp();\n            var suggPopupElem = select('#' + this.parent.element.id + '_ac_popup');\n            if (suggPopupElem) {\n                detach(suggPopupElem);\n            }\n            this.isPopupOpened = false;\n        }\n    };\n    Formula.prototype.hidePopUp = function () {\n        this.autocompleteInstance.hidePopup();\n    };\n    Formula.prototype.getSuggestionKeyFromFormula = function (formula) {\n        var suggestValue = '';\n        formula = formula.substr(1); //remove = char.\n        if (formula) {\n            var bracketIndex = formula.lastIndexOf('(');\n            formula = formula.substr(bracketIndex + 1);\n            var fSplit = formula.split(this.getArgumentSeparator());\n            if (fSplit.length === 1) {\n                suggestValue = fSplit[0];\n                this.isSubFormula = bracketIndex > -1;\n            }\n            else {\n                suggestValue = fSplit[fSplit.length - 1];\n                this.isSubFormula = true;\n            }\n            var isAlphaNumeric = suggestValue.match(/\\w/);\n            if (!isAlphaNumeric || (isAlphaNumeric && isAlphaNumeric.index !== 0)) {\n                suggestValue = '';\n            }\n        }\n        return suggestValue;\n    };\n    Formula.prototype.getPopupPosition = function () {\n        var eventArgs = { position: null };\n        if (this.isFormulaBar) {\n            eventArgs.action = 'getPosition';\n            this.parent.notify(formulaBarOperation, eventArgs);\n        }\n        else {\n            eventArgs.action = 'getPosition';\n            this.parent.notify(editOperation, eventArgs);\n        }\n        return eventArgs.position;\n    };\n    Formula.prototype.getEditingValue = function () {\n        var eventArgs = { action: 'getCurrentEditValue', editedValue: '' };\n        this.parent.notify(editOperation, eventArgs);\n        return eventArgs.editedValue;\n    };\n    Formula.prototype.isNavigationKey = function (keyCode) {\n        return (keyCode === this.keyCodes.UP) || (keyCode === this.keyCodes.DOWN) || (keyCode === this.keyCodes.LEFT)\n            || (keyCode === this.keyCodes.RIGHT);\n    };\n    Formula.prototype.triggerKeyDownEvent = function (keyCode) {\n        var autoCompleteElem = this.autocompleteInstance.element;\n        autoCompleteElem.dispatchEvent(new Event('input'));\n        var eventArg = new Event('keydown');\n        // tslint:disable:no-string-literal\n        eventArg['keyCode'] = keyCode;\n        eventArg['which'] = keyCode;\n        eventArg['altKey'] = false;\n        eventArg['shiftKey'] = false;\n        eventArg['ctrlKey'] = false;\n        // tslint:enable:no-string-literal\n        autoCompleteElem.dispatchEvent(eventArg);\n    };\n    Formula.prototype.getArgumentSeparator = function () {\n        if (this.argumentSeparator) {\n            return this.argumentSeparator;\n        }\n        else {\n            var eventArgs = {\n                action: 'getArgumentSeparator', argumentSeparator: ''\n            };\n            this.parent.notify(workbookFormulaOperation, eventArgs);\n            this.argumentSeparator = eventArgs.argumentSeparator;\n            return eventArgs.argumentSeparator;\n        }\n    };\n    Formula.prototype.getNames = function (sheetName) {\n        var names = this.parent.definedNames.filter(function (name) { return name.scope === 'Workbook' || name.scope === '' || name.scope === sheetName; });\n        return names;\n    };\n    Formula.prototype.getNameFromRange = function (range) {\n        var singleRange = range.slice(0, range.indexOf(':'));\n        var sRange = range.slice(range.indexOf('!') + 1).split(':');\n        var isSingleCell = sRange.length > 1 && sRange[0] === sRange[1];\n        var name = this.parent.definedNames.filter(function (name, index) {\n            if (isSingleCell && name.refersTo === '=' + singleRange) {\n                return true;\n            }\n            return name.refersTo === '=' + range;\n        });\n        return name && name[0];\n    };\n    Formula.prototype.addDefinedName = function (definedName) {\n        var _this = this;\n        var name = definedName.name;\n        var isAdded = false;\n        if (!definedName.refersTo) {\n            var sheet = getSheet(this.parent, this.parent.activeSheetIndex);\n            var sheetName = getSheetName(this.parent);\n            sheetName = sheetName.indexOf(' ') !== -1 ? '\\'' + sheetName + '\\'' : sheetName;\n            var selectRange = sheet.selectedRange;\n            if (!isNullOrUndefined(selectRange)) {\n                var colIndex = selectRange.indexOf(':');\n                var left = selectRange.substr(0, colIndex);\n                var right = selectRange.substr(colIndex + 1, selectRange.length);\n                if (parseInt(right.replace(/\\D/g, ''), 10) === sheet.rowCount && parseInt(left.replace(/\\D/g, ''), 10) === 1) {\n                    right = right.replace(/[0-9]/g, '');\n                    left = left.replace(/[0-9]/g, '');\n                    selectRange = '$' + left + ':$' + right;\n                }\n                else if (getCellIndexes(right)[1] === sheet.colCount - 1 && getCellIndexes(left)[1] === 0) {\n                    right = right.replace(/\\D/g, '');\n                    left = left.replace(/\\D/g, '');\n                    selectRange = '$' + left + ':$' + right;\n                }\n                else {\n                    selectRange = left === right ? left : selectRange;\n                }\n            }\n            definedName.refersTo = sheetName + '!' + selectRange;\n            definedName.scope = 'Workbook';\n        }\n        if (name.length > 0 && (/^([a-zA-Z_0-9.]){0,255}$/.test(name))) {\n            var eventArgs = {\n                action: 'addDefinedName', definedName: definedName, isAdded: false\n            };\n            this.parent.notify(workbookFormulaOperation, eventArgs);\n            isAdded = eventArgs.isAdded;\n            if (!eventArgs.isAdded) {\n                this.parent.serviceLocator.getService(dialog).show({\n                    content: this.parent.serviceLocator.getService(locale).getConstant('DefineNameExists'),\n                    width: '300',\n                    beforeOpen: function (args) {\n                        var dlgArgs = {\n                            dialogName: 'DefineNameExistsDialog',\n                            element: args.element, target: args.target, cancel: args.cancel\n                        };\n                        _this.parent.trigger('dialogBeforeOpen', dlgArgs);\n                        if (dlgArgs.cancel) {\n                            args.cancel = true;\n                        }\n                    },\n                });\n            }\n        }\n        else {\n            this.parent.serviceLocator.getService(dialog).show({\n                content: this.parent.serviceLocator.getService(locale).getConstant('DefineNameInValid'),\n                width: '300',\n                beforeOpen: function (args) {\n                    var dlgArgs = {\n                        dialogName: 'DefineNameInValidDialog',\n                        element: args.element, target: args.target, cancel: args.cancel\n                    };\n                    _this.parent.trigger('dialogBeforeOpen', dlgArgs);\n                    if (dlgArgs.cancel) {\n                        args.cancel = true;\n                    }\n                },\n            });\n        }\n        return isAdded;\n    };\n    return Formula;\n}());\nexport { Formula };\n","import { Tab } from '@syncfusion/ej2-navigations';\nimport { refreshSheetTabs, locale, insertSheetTab, cMenuBeforeOpen, dialog, renameSheet, hideSheet, beginAction } from '../common/index';\nimport { sheetNameUpdate, clearUndoRedoCollection, completeAction, showAggregate } from '../common/index';\nimport { sheetTabs, renameSheetTab, removeSheetTab, activeSheetChanged, onVerticalScroll, onHorizontalScroll } from '../common/index';\nimport { protectSheet, editOperation } from '../common/index';\nimport { getSheetName, aggregateComputation } from '../../workbook/index';\nimport { isSingleCell, getRangeIndexes, getSheet, getSheetIndex } from '../../workbook/index';\nimport { DropDownButton } from '@syncfusion/ej2-splitbuttons';\nimport { isCollide, calculatePosition } from '@syncfusion/ej2-popups';\nimport { rippleEffect, closest, EventHandler, remove, isNullOrUndefined } from '@syncfusion/ej2-base';\nimport { sheetsDestroyed, activeCellChanged, workbookFormulaOperation } from '../../workbook/common/index';\nimport { insertModel, checkIsFormula } from './../../workbook/common/index';\n/**\n * Represents SheetTabs for Spreadsheet.\n */\nvar SheetTabs = /** @class */ (function () {\n    function SheetTabs(parent) {\n        this.aggregateContent = '';\n        this.isSelectCancel = false;\n        this.selaggregateCnt = 'Sum';\n        this.parent = parent;\n        this.addEventListener();\n    }\n    SheetTabs.prototype.getModuleName = function () {\n        return 'sheetTabs';\n    };\n    SheetTabs.prototype.createSheetTabs = function () {\n        var _this = this;\n        if (!this.parent.showSheetTabs && this.tabInstance) {\n            this.destroy();\n            return;\n        }\n        var l10n = this.parent.serviceLocator.getService(locale);\n        var panel = this.parent.createElement('div', {\n            className: 'e-sheet-tab-panel', id: this.parent.element.id + '_sheet_tab_panel'\n        });\n        var addBtn = this.parent.createElement('button', {\n            className: 'e-add-sheet-tab e-btn e-css e-flat e-icon-btn' + (this.parent.allowInsert ? '' : ' e-disabled'),\n            attrs: { 'title': l10n.getConstant('AddSheet') }\n        });\n        addBtn.appendChild(this.parent.createElement('span', { className: 'e-btn-icon e-icons e-add-icon' }));\n        addBtn.addEventListener('click', this.addSheetTab.bind(this));\n        addBtn.disabled = !this.parent.allowInsert;\n        panel.appendChild(addBtn);\n        if (this.parent.allowInsert) {\n            this.addBtnRipple = rippleEffect(panel, { selector: '.e-add-sheet-tab' });\n        }\n        var ddb = this.parent.createElement('button', { attrs: { 'title': l10n.getConstant('ListAllSheets') } });\n        panel.appendChild(ddb);\n        this.parent.element.appendChild(panel);\n        var items = this.getSheetTabItems();\n        this.dropDownInstance = new DropDownButton({\n            iconCss: 'e-icons',\n            items: items.ddbItems,\n            beforeItemRender: function (args) {\n                var sheet = _this.parent.sheets[_this.dropDownInstance.items.indexOf(args.item)];\n                if (sheet.state === 'Hidden') {\n                    args.element.classList.add('e-hide');\n                }\n                else if (sheet.state === 'VeryHidden') {\n                    args.element.style.display = 'none';\n                }\n            },\n            select: function (args) { return _this.updateSheetTab({ idx: _this.dropDownInstance.items.indexOf(args.item) }); },\n            beforeOpen: function (args) { return _this.beforeOpenHandler(_this.dropDownInstance, args.element); },\n            open: function (args) { return _this.openHandler(_this.dropDownInstance, args.element, 'left'); },\n            cssClass: 'e-sheets-list e-flat e-caret-hide',\n            close: function () { return _this.parent.element.focus(); }\n        });\n        this.dropDownInstance.createElement = this.parent.createElement;\n        this.dropDownInstance.appendTo(ddb);\n        var sheetTab = this.parent.createElement('div', { className: 'e-sheet-tab' });\n        this.tabInstance = new Tab({\n            selectedItem: this.parent.activeSheetIndex,\n            overflowMode: 'Scrollable',\n            items: items.tabItems,\n            scrollStep: 250,\n            selecting: function (args) {\n                var beginEventArgs = {\n                    currentSheetIndex: args.selectingIndex, previousSheetIndex: args.selectedIndex, cancel: false\n                };\n                if (!_this.isSelectCancel) {\n                    _this.parent.notify(beginAction, { eventArgs: beginEventArgs, action: 'gotoSheet' });\n                }\n                _this.isSelectCancel = beginEventArgs.cancel;\n            },\n            selected: function (args) {\n                if (args.selectedIndex === args.previousIndex) {\n                    return;\n                }\n                if (_this.parent.isEdit) {\n                    _this.parent.endEdit();\n                }\n                if (_this.isSelectCancel) {\n                    _this.tabInstance.selectedItem = args.previousIndex;\n                    _this.tabInstance.dataBind();\n                    _this.parent.element.focus();\n                }\n                else {\n                    _this.parent.activeSheetIndex = args.selectedIndex;\n                    _this.parent.dataBind();\n                    _this.updateDropDownItems(args.selectedIndex, args.previousIndex);\n                    _this.parent.element.focus();\n                    var completeEventArgs = {\n                        previousSheetIndex: args.previousIndex, currentSheetIndex: args.selectedIndex\n                    };\n                    _this.parent.notify(completeAction, { eventArgs: completeEventArgs, action: 'gotoSheet' });\n                    var eventArgs = {\n                        action: 'registerGridInCalc',\n                        sheetID: (args.selectedIndex + 1).toString()\n                    };\n                    _this.parent.notify(workbookFormulaOperation, eventArgs);\n                }\n            },\n            created: function () {\n                var tBarItems = _this.tabInstance.element.querySelector('.e-toolbar-items');\n                tBarItems.classList.add('e-sheet-tabs-items');\n                EventHandler.add(tBarItems, 'dblclick', _this.renameSheetTab, _this);\n            },\n        });\n        panel.appendChild(sheetTab);\n        this.tabInstance.createElement = this.parent.createElement;\n        this.tabInstance.appendTo(sheetTab);\n        // tslint:disable-next-line:no-any\n        EventHandler.remove(this.tabInstance.element, 'keydown', this.tabInstance.spaceKeyDown);\n        var sheetCount = items.tabItems.length;\n        for (var i = 0; i < sheetCount; i++) {\n            var sheetName = getSheetName(this.parent, i);\n            var arg = { action: 'addSheet', sheetName: 'Sheet' + (i + 1), index: i + 1, visibleName: sheetName };\n            this.parent.notify(workbookFormulaOperation, arg);\n        }\n        this.parent.notify(workbookFormulaOperation, { action: 'initiateDefinedNames' });\n        this.parent.notify(protectSheet, null);\n    };\n    SheetTabs.prototype.updateDropDownItems = function (curIdx, prevIdx) {\n        if (prevIdx > -1) {\n            this.dropDownInstance.items[prevIdx].iconCss = '';\n        }\n        this.dropDownInstance.items[curIdx].iconCss = 'e-selected-icon e-icons';\n        this.dropDownInstance.setProperties({ 'items': this.dropDownInstance.items }, true);\n    };\n    SheetTabs.prototype.beforeOpenHandler = function (instance, element) {\n        var viewportHeight = this.parent.viewport.height;\n        var actualHeight = (parseInt(getComputedStyle(element.firstElementChild).height, 10) *\n            instance.items.length) + (parseInt(getComputedStyle(element).paddingTop, 10) * 2);\n        if (actualHeight > viewportHeight) {\n            element.style.height = viewportHeight + \"px\";\n            element.style.overflowY = 'auto';\n        }\n        element.parentElement.style.visibility = 'hidden';\n    };\n    SheetTabs.prototype.openHandler = function (instance, element, positionX) {\n        var wrapper = element.parentElement;\n        var height;\n        var collide = isCollide(wrapper);\n        if (collide.indexOf('bottom') === -1) {\n            height = element.style.overflowY === 'auto' ? this.parent.viewport.height : wrapper.getBoundingClientRect().height;\n            var offset = calculatePosition(instance.element, positionX, 'top');\n            if (positionX === 'right') {\n                offset.left -= wrapper.getBoundingClientRect().width;\n            }\n            wrapper.style.left = offset.left + \"px\";\n            wrapper.style.top = offset.top - height + \"px\";\n        }\n        wrapper.style.visibility = '';\n    };\n    SheetTabs.prototype.getSheetTabItems = function () {\n        var _this = this;\n        var tabItems = [];\n        var ddbItems = [];\n        var sheetName;\n        this.parent.sheets.forEach(function (sheet, index) {\n            sheetName = getSheetName(_this.parent, index);\n            tabItems.push({ header: { 'text': sheetName }, cssClass: sheet.state === 'Visible' ? '' : 'e-hide' });\n            ddbItems.push({ text: sheetName, iconCss: index === _this.parent.activeSheetIndex ? 'e-selected-icon e-icons' : '' });\n        });\n        return { tabItems: tabItems, ddbItems: ddbItems };\n    };\n    SheetTabs.prototype.refreshSheetTab = function () {\n        var items = this.getSheetTabItems();\n        this.dropDownInstance.items = items.ddbItems;\n        this.dropDownInstance.setProperties({ 'items': this.dropDownInstance.items }, true);\n        this.tabInstance.items = items.tabItems;\n        this.tabInstance.selectedItem = this.parent.activeSheetIndex;\n        this.tabInstance.dataBind();\n    };\n    SheetTabs.prototype.addSheetTab = function () {\n        var eventArgs = { action: 'getCurrentEditValue', editedValue: '' };\n        this.parent.notify(editOperation, eventArgs);\n        var val = eventArgs.editedValue;\n        var isFormulaEdit = checkIsFormula(val) || val && val !== '' ? val.indexOf('=') === 0 : false;\n        this.parent.notify(insertModel, { model: this.parent, start: this.parent.activeSheetIndex + 1, end: this.parent.activeSheetIndex + 1, modelType: 'Sheet', isAction: true, activeSheetIndex: this.parent.activeSheetIndex + 1 });\n        this.parent.element.focus();\n    };\n    SheetTabs.prototype.insertSheetTab = function (args) {\n        if (!args.preventUpdate || args.startIdx === this.tabInstance.selectedItem) {\n            this.dropDownInstance.items[this.tabInstance.selectedItem].iconCss = '';\n        }\n        for (var i = args.startIdx; i <= args.endIdx; i++) {\n            var sheetName = this.parent.sheets[i].name;\n            this.dropDownInstance.items.splice(i, 0, { text: sheetName });\n            this.tabInstance.addTab([{ header: { text: sheetName }, content: '' }], i);\n        }\n        if (!args.preventUpdate || args.startIdx === this.tabInstance.selectedItem) {\n            this.dropDownInstance.items[args.startIdx].iconCss = 'e-selected-icon e-icons';\n        }\n        this.dropDownInstance.setProperties({ 'items': this.dropDownInstance.items }, true);\n        if (!args.preventUpdate) {\n            this.updateSheetTab({ idx: args.startIdx });\n        }\n    };\n    SheetTabs.prototype.updateSheetTab = function (args) {\n        if (args.name === 'activeSheetChanged') {\n            args.idx = this.parent.skipHiddenSheets(args.idx);\n        }\n        else {\n            if (this.parent.sheets[args.idx].state === 'Hidden') {\n                this.parent.setSheetPropertyOnMute(this.parent.sheets[args.idx], 'state', 'Visible');\n                this.tabInstance.items[args.idx].cssClass = '';\n                this.tabInstance.items = this.tabInstance.items;\n                this.tabInstance.dataBind();\n            }\n        }\n        this.tabInstance.selectedItem = args.idx;\n        this.tabInstance.dataBind();\n        this.parent.notify(protectSheet, null);\n    };\n    SheetTabs.prototype.switchSheetTab = function (args) {\n        var target = closest(args.event.target, '.e-toolbar-item');\n        if (!target) {\n            return;\n        }\n        var text = target.querySelector('.e-tab-text').textContent;\n        for (var i = 0, len = this.tabInstance.items.length; i < len; i++) {\n            if (this.tabInstance.items[i].header.text === text) {\n                if (this.parent.activeSheetIndex !== i) {\n                    this.updateSheetTab({ idx: i });\n                }\n                break;\n            }\n        }\n        if (args.element.classList.contains('e-contextmenu') && args.items[0] &&\n            args.items[0].id === this.parent.element.id + \"_cmenu_insert_sheet\") {\n            if (this.skipHiddenSheets() === 1) {\n                //let id: string = `${this.parent.element.id}_cmenu`;\n                //this.parent.enableFileMenuItems([`${id}_hide_sheet`, `${id}_delete_sheet`], false, true);\n                args.element.children[1].classList.add('e-disabled');\n                args.element.children[3].classList.add('e-disabled');\n            }\n            if (!this.parent.allowInsert) {\n                args.element.children[0].classList.add('e-disabled');\n            }\n            if (!this.parent.allowDelete) {\n                args.element.children[1].classList.add('e-disabled');\n            }\n        }\n    };\n    SheetTabs.prototype.skipHiddenSheets = function () {\n        var count = this.parent.sheets.length;\n        this.parent.sheets.forEach(function (sheet) {\n            if (sheet.state !== 'Visible') {\n                --count;\n            }\n        });\n        return count;\n    };\n    SheetTabs.prototype.renameSheetTab = function () {\n        var target = this.tabInstance.element.querySelector('.e-toolbar-item.e-active');\n        if (target) {\n            target = target.querySelector('.e-text-wrap');\n            var value = target.querySelector('.e-tab-text').textContent;\n            var input = this.parent.createElement('input', {\n                id: this.parent.element.id + '_rename_input',\n                className: 'e-input e-sheet-rename', styles: \"width: \" + target.getBoundingClientRect().width + \"px\", attrs: {\n                    'type': 'text', 'name': 'Rename', 'required': '', 'value': value, 'spellcheck': 'false', 'maxlength': '31'\n                }\n            });\n            target.firstElementChild.style.display = 'none';\n            target.appendChild(input);\n            EventHandler.add(document, 'mousedown touchstart', this.renameInputFocusOut, this);\n            EventHandler.add(input, 'input', this.updateWidth, this);\n            input.focus();\n            input.setSelectionRange(0, value.length);\n            EventHandler.remove(closest(target, '.e-toolbar-items'), 'dblclick', this.renameSheetTab);\n        }\n    };\n    SheetTabs.prototype.updateWidth = function (e) {\n        var target = e.target;\n        var len = target.value.length;\n        var value = target.value.split(' ');\n        if (value.length) {\n            var spaceLen = value.length - 1;\n            len -= spaceLen;\n            len += (spaceLen * 0.5);\n        }\n        target.style.width = len + \"ch\";\n    };\n    SheetTabs.prototype.renameInputFocusOut = function (e) {\n        var target = e.target;\n        if ((e.type === 'mousedown' || e.type === 'touchstart') && (target.classList.contains('e-sheet-rename') ||\n            closest(target, '.e-dlg-container'))) {\n            return;\n        }\n        target = document.getElementById(this.parent.element.id + '_rename_input');\n        if (e.type === 'keydown' && e.keyCode === 27) {\n            this.removeRenameInput(target);\n            this.parent.element.focus();\n            return;\n        }\n        var value = target.value;\n        var l10n = this.parent.serviceLocator.getService(locale);\n        if (value) {\n            var idx = this.tabInstance.selectedItem;\n            if (!value.match(new RegExp('.*[\\\\[\\\\]\\\\*\\\\\\\\\\/\\\\?].*'))) {\n                if (this.tabInstance.items[idx].header.text !== value) {\n                    for (var i = 0, len = this.parent.sheets.length; i < len; i++) {\n                        if (i !== this.parent.activeSheetIndex && this.parent.sheets[i].name.toLowerCase() === value.toLowerCase()) {\n                            this.showRenameDialog(target, l10n.getConstant('SheetRenameAlreadyExistsAlert'));\n                            return;\n                        }\n                    }\n                }\n                var items = this.removeRenameInput(target);\n                if (this.tabInstance.items[idx].header.text !== value) {\n                    this.parent.setSheetPropertyOnMute(this.parent.sheets[idx], 'name', value);\n                    this.updateSheetName({ value: value, idx: idx, items: items });\n                }\n                if (e.type === 'keydown' || (closest(e.target, '.e-spreadsheet'))) {\n                    this.parent.element.focus();\n                }\n            }\n            else {\n                this.showRenameDialog(target, l10n.getConstant('SheetRenameInvalidAlert'));\n            }\n        }\n        else {\n            this.showRenameDialog(target, l10n.getConstant('SheetRenameEmptyAlert'));\n        }\n        var sheetIndex = this.parent.getActiveSheet().id;\n        var args = { action: 'renameUpdation', value: value, sheetId: sheetIndex };\n        this.parent.notify(workbookFormulaOperation, args);\n        var eventArgs = {\n            index: sheetIndex,\n            value: value\n        };\n        this.parent.notify(completeAction, { eventArgs: eventArgs, action: 'renameSheet' });\n    };\n    SheetTabs.prototype.updateSheetName = function (args) {\n        this.tabInstance.items[args.idx].header.text = args.value;\n        this.dropDownInstance.items[args.idx].text = args.value;\n        this.dropDownInstance.setProperties({ 'items': this.dropDownInstance.items }, true);\n        if (args.value.indexOf('  ') > -1) {\n            this.tabInstance.setProperties({ 'items': this.tabInstance.items }, true);\n            args.items.querySelector('.e-toolbar-item.e-active .e-tab-text').textContent = args.value;\n        }\n        else {\n            this.tabInstance.items = this.tabInstance.items;\n            this.tabInstance.dataBind();\n        }\n    };\n    SheetTabs.prototype.hideSheet = function () {\n        this.parent.setSheetPropertyOnMute(this.parent.getActiveSheet(), 'state', 'Hidden');\n        this.tabInstance.items[this.parent.activeSheetIndex].cssClass = 'e-hide';\n        this.tabInstance.items = this.tabInstance.items;\n        this.tabInstance.dataBind();\n        this.tabInstance.selectedItem = this.parent.skipHiddenSheets(this.parent.activeSheetIndex === this.parent.sheets.length - 1 ? this.parent.activeSheetIndex - 1 :\n            this.parent.activeSheetIndex + 1);\n        this.tabInstance.dataBind();\n    };\n    SheetTabs.prototype.removeRenameInput = function (target) {\n        var textEle = target.parentElement.querySelector('.e-tab-text');\n        var sheetItems = closest(target, '.e-toolbar-items');\n        EventHandler.add(sheetItems, 'dblclick', this.renameSheetTab, this);\n        EventHandler.remove(document, 'mousedown touchstart', this.renameInputFocusOut);\n        EventHandler.remove(target, 'input', this.updateWidth);\n        remove(target);\n        textEle.style.display = '';\n        return sheetItems;\n    };\n    SheetTabs.prototype.showRenameDialog = function (target, content) {\n        var _this = this;\n        var dialogInst = this.parent.serviceLocator.getService(dialog);\n        dialogInst.show({\n            target: document.getElementById(this.parent.element.id + '_sheet_panel'),\n            height: 180, width: 400, isModal: true, showCloseIcon: true,\n            content: content,\n            beforeOpen: function (args) {\n                var dlgArgs = {\n                    dialogName: 'SheetRenameDialog',\n                    element: args.element, target: args.target, cancel: args.cancel\n                };\n                _this.parent.trigger('dialogBeforeOpen', dlgArgs);\n                if (dlgArgs.cancel) {\n                    args.cancel = true;\n                }\n                target.focus();\n            },\n            close: function () { return target.setSelectionRange(0, target.value.length); }\n        });\n    };\n    SheetTabs.prototype.focusRenameInput = function () {\n        var input = document.getElementById(this.parent.element.id + '_rename_input');\n        if (input) {\n            input.focus();\n        }\n    };\n    SheetTabs.prototype.removeSheetTab = function (args) {\n        var _this = this;\n        if (args.count && (args.count === this.parent.sheets.length)) {\n            return;\n        }\n        var l10n = this.parent.serviceLocator.getService(locale);\n        if (this.skipHiddenSheets() > 1) {\n            var sheet = args.sheetName ? getSheet(this.parent, getSheetIndex(this.parent, args.sheetName)) :\n                this.parent.getActiveSheet();\n            var sheetIndex_1 = args.index || getSheetIndex(this.parent, sheet.name);\n            var eventArgs_1 = {\n                index: sheetIndex_1,\n                sheetCount: this.parent.sheets.length,\n                sheetName: sheet.name\n            };\n            var isDataAvail = sheet.rows && sheet.rows.length ?\n                (sheet.rows.length === 1 ? (sheet.rows[0].cells && sheet.rows[0].cells.length ? true : false) : true) : false;\n            if (isDataAvail) {\n                var dialogInst_1 = this.parent.serviceLocator.getService(dialog);\n                if (args.clicked) {\n                    this.forceDelete(sheetIndex_1);\n                }\n                else {\n                    dialogInst_1.show({\n                        height: 200, width: 400, isModal: true, showCloseIcon: true,\n                        content: l10n.getConstant('DeleteSheetAlert'),\n                        beforeOpen: function (args) {\n                            var dlgArgs = {\n                                dialogName: 'DeleteSheetDialog',\n                                element: args.element, target: args.target, cancel: args.cancel\n                            };\n                            _this.parent.trigger('dialogBeforeOpen', dlgArgs);\n                            if (dlgArgs.cancel) {\n                                args.cancel = true;\n                            }\n                            _this.parent.element.focus();\n                        },\n                        buttons: [{\n                                buttonModel: {\n                                    content: l10n.getConstant('Ok'), isPrimary: true\n                                },\n                                click: function () {\n                                    dialogInst_1.hide();\n                                    _this.forceDelete(sheetIndex_1);\n                                    _this.parent.notify(clearUndoRedoCollection, null);\n                                    if (args && !args.isAction) {\n                                        eventArgs_1.sheetCount = _this.parent.sheets.length;\n                                        _this.parent.notify(completeAction, { eventArgs: eventArgs_1, action: 'removeSheet' });\n                                    }\n                                }\n                            }]\n                    });\n                }\n            }\n            else {\n                var sheetArgs = {\n                    action: 'deleteSheetTab', sheetName: '', index: sheetIndex_1 + 1\n                };\n                this.parent.notify(workbookFormulaOperation, sheetArgs);\n                this.destroySheet(sheetIndex_1);\n                this.parent.notify(clearUndoRedoCollection, null);\n                if (args && !args.isAction) {\n                    eventArgs_1.sheetCount = this.parent.sheets.length;\n                    this.parent.notify(completeAction, { eventArgs: eventArgs_1, action: 'removeSheet' });\n                }\n            }\n        }\n        else {\n            this.parent.serviceLocator.getService(dialog).show({\n                target: document.getElementById(this.parent.element.id + '_sheet_panel'),\n                height: 180, width: 400, isModal: true, showCloseIcon: true,\n                content: l10n.getConstant('DeleteSingleLastSheetAlert'),\n                beforeOpen: function (args) {\n                    var dlgArgs = {\n                        dialogName: 'DeleteSingleSheetDialog',\n                        element: args.element, target: args.target, cancel: args.cancel\n                    };\n                    _this.parent.trigger('dialogBeforeOpen', dlgArgs);\n                    if (dlgArgs.cancel) {\n                        args.cancel = true;\n                    }\n                    _this.parent.element.focus();\n                },\n            });\n        }\n    };\n    SheetTabs.prototype.forceDelete = function (sheetIndex) {\n        var sheetArgs = {\n            action: 'deleteSheetTab', sheetName: '', index: sheetIndex + 1\n        };\n        this.parent.notify(workbookFormulaOperation, sheetArgs);\n        this.destroySheet(sheetIndex);\n    };\n    SheetTabs.prototype.destroySheet = function (sheetIndex) {\n        var activeSheetIdx = sheetIndex || this.parent.activeSheetIndex;\n        this.parent.removeSheet(activeSheetIdx);\n        this.parent.notify(sheetsDestroyed, { sheetIndex: activeSheetIdx });\n        this.dropDownInstance.items.splice(activeSheetIdx, 1);\n        this.dropDownInstance.setProperties({ 'items': this.dropDownInstance.items }, true);\n        this.tabInstance.removeTab(activeSheetIdx);\n        var activeIndex = this.parent.skipHiddenSheets(this.tabInstance.selectedItem);\n        this.parent.activeSheetIndex = activeIndex;\n        this.parent.setProperties({ activeSheetIndex: activeIndex }, true);\n        this.parent.renderModule.refreshSheet();\n        this.tabInstance.selectedItem = activeIndex;\n        this.tabInstance.dataBind();\n        this.updateDropDownItems(activeIndex);\n        this.parent.notify(protectSheet, null);\n        this.parent.element.focus();\n    };\n    SheetTabs.prototype.showAggregate = function () {\n        var _this = this;\n        if (isSingleCell(getRangeIndexes(this.parent.getActiveSheet().selectedRange))) {\n            return;\n        }\n        var eventArgs = { Count: 0, Sum: '0', Avg: '0', Min: '0', Max: '0', countOnly: true };\n        this.parent.notify(aggregateComputation, eventArgs);\n        if (eventArgs.Count > 1) {\n            this.aggregateContent = eventArgs.countOnly ? 'Count' : this.selaggregateCnt;\n            if (eventArgs.countOnly) {\n                this.aggregateContent = 'Count';\n                delete eventArgs.Sum;\n                delete eventArgs.Avg;\n                delete eventArgs.Min;\n                delete eventArgs.Max;\n            }\n            var btnClass = eventArgs.countOnly ? 'e-aggregate-list e-flat e-aggregate-list-countonly e-caret-hide'\n                : 'e-aggregate-list e-flat';\n            delete eventArgs.countOnly;\n            var key = this.aggregateContent;\n            var content = key + \": \" + eventArgs[key];\n            if (!this.aggregateDropDown) {\n                var aggregateEle = this.parent.createElement('button');\n                document.getElementById(this.parent.element.id + \"_sheet_tab_panel\").appendChild(aggregateEle);\n                this.aggregateDropDown = new DropDownButton({\n                    content: content,\n                    items: this.getAggregateItems(eventArgs),\n                    select: function (args) { return _this.updateAggregateContent(args.item.text, eventArgs, true); },\n                    beforeOpen: function (args) {\n                        return _this.beforeOpenHandler(_this.aggregateDropDown, args.element);\n                    },\n                    open: function (args) { return _this.openHandler(_this.aggregateDropDown, args.element, 'right'); },\n                    close: function () { return _this.parent.element.focus(); },\n                    cssClass: btnClass\n                });\n                this.aggregateDropDown.createElement = this.parent.createElement;\n                this.aggregateDropDown.appendTo(aggregateEle);\n            }\n            else {\n                this.updateAggregateContent(content, eventArgs);\n            }\n        }\n        else {\n            this.removeAggregate();\n        }\n    };\n    SheetTabs.prototype.getAggregateItems = function (args) {\n        var _this = this;\n        var items = [];\n        var text;\n        var iconCss;\n        Object.keys(args).forEach(function (key) {\n            if (args[key] !== aggregateComputation) {\n                text = key + \": \" + args[key];\n                iconCss = key === _this.aggregateContent ? 'e-selected-icon e-icons' : '';\n                items.push({ text: text, iconCss: iconCss });\n            }\n        });\n        return items;\n    };\n    SheetTabs.prototype.updateAggregateContent = function (text, eventArgs, isSelect) {\n        this.aggregateContent = text.split(': ')[0];\n        if (isSelect) {\n            this.selaggregateCnt = text.split(': ')[0];\n        }\n        this.aggregateDropDown.content = text;\n        this.aggregateDropDown.dataBind();\n        this.aggregateDropDown.setProperties({ 'items': this.getAggregateItems(eventArgs) }, true);\n    };\n    SheetTabs.prototype.removeAggregate = function () {\n        if (!isNullOrUndefined(this.aggregateDropDown)) {\n            this.aggregateDropDown.destroy();\n            remove(this.aggregateDropDown.element);\n            this.aggregateDropDown = null;\n        }\n    };\n    SheetTabs.prototype.addEventListener = function () {\n        this.parent.on(sheetTabs, this.createSheetTabs, this);\n        this.parent.on(refreshSheetTabs, this.refreshSheetTab, this);\n        this.parent.on(insertSheetTab, this.insertSheetTab, this);\n        this.parent.on(removeSheetTab, this.removeSheetTab, this);\n        this.parent.on(renameSheetTab, this.renameSheetTab, this);\n        this.parent.on(cMenuBeforeOpen, this.switchSheetTab, this);\n        this.parent.on(activeSheetChanged, this.updateSheetTab, this);\n        this.parent.on(renameSheet, this.renameInputFocusOut, this);\n        this.parent.on(activeCellChanged, this.removeAggregate, this);\n        this.parent.on(onVerticalScroll, this.focusRenameInput, this);\n        this.parent.on(onHorizontalScroll, this.focusRenameInput, this);\n        this.parent.on(sheetNameUpdate, this.updateSheetName, this);\n        this.parent.on(hideSheet, this.hideSheet, this);\n        this.parent.on(showAggregate, this.showAggregate, this);\n    };\n    SheetTabs.prototype.destroy = function () {\n        this.removeEventListener();\n        this.dropDownInstance.destroy();\n        this.dropDownInstance = null;\n        this.tabInstance.destroy();\n        this.tabInstance = null;\n        this.aggregateDropDown = null;\n        this.aggregateContent = null;\n        this.addBtnRipple();\n        this.addBtnRipple = null;\n        EventHandler.remove(document, 'mousedown touchstart', this.renameInputFocusOut);\n        var ele = document.getElementById(this.parent.element.id + '_sheet_tab_panel');\n        if (ele) {\n            remove(ele);\n        }\n        this.parent = null;\n    };\n    SheetTabs.prototype.removeEventListener = function () {\n        if (!this.parent.isDestroyed) {\n            this.parent.off(sheetTabs, this.createSheetTabs);\n            this.parent.off(refreshSheetTabs, this.refreshSheetTab);\n            this.parent.off(insertSheetTab, this.insertSheetTab);\n            this.parent.off(removeSheetTab, this.removeSheetTab);\n            this.parent.off(renameSheetTab, this.renameSheetTab);\n            this.parent.off(cMenuBeforeOpen, this.switchSheetTab);\n            this.parent.off(activeSheetChanged, this.updateSheetTab);\n            this.parent.off(renameSheet, this.renameInputFocusOut);\n            this.parent.off(activeCellChanged, this.removeAggregate);\n            this.parent.off(onVerticalScroll, this.focusRenameInput);\n            this.parent.off(onHorizontalScroll, this.focusRenameInput);\n            this.parent.off(sheetNameUpdate, this.updateSheetName);\n            this.parent.off(hideSheet, this.hideSheet);\n            this.parent.off(showAggregate, this.showAggregate);\n        }\n    };\n    return SheetTabs;\n}());\nexport { SheetTabs };\n","import { refreshSheetTabs, completeAction } from '../common/event';\nimport { dialog } from '../common/index';\nimport { openSuccess, openFailure } from '../../workbook/index';\nvar Open = /** @class */ (function () {\n    function Open(parent) {\n        this.parent = parent;\n        this.addEventListener();\n        this.renderFileUpload();\n        //Spreadsheet.Inject(WorkbookOpen);\n    }\n    /**\n     * Adding event listener for success and failure\n     */\n    Open.prototype.addEventListener = function () {\n        this.parent.on(openSuccess, this.openSuccess, this);\n        this.parent.on(openFailure, this.openFailed, this);\n    };\n    /**\n     * Removing event listener for success and failure\n     */\n    Open.prototype.removeEventListener = function () {\n        if (!this.parent.isDestroyed) {\n            this.parent.off(openSuccess, this.openSuccess);\n            this.parent.off(openFailure, this.openFailed);\n        }\n    };\n    /**\n     * Rendering upload component for importing files.\n     */\n    Open.prototype.renderFileUpload = function () {\n        var uploadID = this.parent.element.id + '_fileUpload';\n        this.parent.element.appendChild(this.parent.createElement('input', {\n            id: uploadID,\n            attrs: { type: 'file', accept: '.xls, .xlsx, .csv, .xlsm', name: 'fileUpload' }\n        }));\n        var uploadBox = document.getElementById(uploadID);\n        uploadBox.onchange = this.fileSelect.bind(this);\n        uploadBox.onerror = this.openFailed.bind(this);\n        uploadBox.style.display = 'none';\n    };\n    /**\n     * Process after select the excel and image file.\n     * @param {Event} args - File select native event.\n     */\n    Open.prototype.fileSelect = function (args) {\n        /* tslint:disable-next-line:no-any */\n        var filesData = args.target.files[0];\n        if (filesData && filesData.length < 1) {\n            return;\n        }\n        var impArgs = {\n            file: filesData\n        };\n        this.parent.open(impArgs);\n        document.getElementById(this.parent.element.id + '_fileUpload').value = '';\n    };\n    /**\n     * File open success event declaration.\n     * @param {string} response - File open success response text.\n     */\n    Open.prototype.openSuccess = function (response) {\n        var _this = this;\n        var openError = ['UnsupportedFile', 'InvalidUrl'];\n        if (openError.indexOf(response.data) > -1) {\n            this.parent.serviceLocator.getService(dialog).show({\n                content: this.parent.serviceLocator.getService('spreadsheetLocale')\n                    .getConstant(response.data),\n                width: '300',\n                beforeOpen: function (args) {\n                    var dlgArgs = {\n                        dialogName: 'OpenDialog',\n                        element: args.element, target: args.target, cancel: args.cancel\n                    };\n                    _this.parent.trigger('dialogBeforeOpen', dlgArgs);\n                    if (dlgArgs.cancel) {\n                        args.cancel = true;\n                    }\n                },\n            });\n            this.parent.hideSpinner();\n            return;\n        }\n        if (!this.parent.element) {\n            return;\n        }\n        this.parent.trigger('openComplete', { response: response });\n        this.parent.notify(completeAction, { response: response, action: 'import' });\n        this.parent.renderModule.refreshSheet();\n        this.parent.notify(refreshSheetTabs, this);\n        this.parent.hideSpinner();\n    };\n    /**\n     * File open failure event declaration.\n     * @param {object} args - Open failure arguments.\n     */\n    Open.prototype.openFailed = function (args) {\n        this.parent.trigger('openFailure', args);\n        this.parent.hideSpinner();\n        /* Need to Implement */\n    };\n    /**\n     * To Remove the event listeners.\n     */\n    Open.prototype.destroy = function () {\n        this.removeEventListener();\n        this.parent = null;\n    };\n    /**\n     * Get the sheet open module name.\n     */\n    Open.prototype.getModuleName = function () {\n        return 'open';\n    };\n    return Open;\n}());\nexport { Open };\n","import { beginSave, saveCompleted } from '../../workbook/common/event';\n/**\n * `Save` module is used to handle the save action in Spreadsheet.\n */\nvar Save = /** @class */ (function () {\n    /**\n     * Constructor for Save module in Spreadsheet.\n     * @private\n     */\n    function Save(parent) {\n        this.parent = parent;\n        this.addEventListener();\n        //Spreadsheet.Inject(WorkbookSave);\n    }\n    /**\n     * To destroy the Save module.\n     * @return {void}\n     * @hidden\n     */\n    Save.prototype.destroy = function () {\n        this.removeEventListener();\n        this.parent = null;\n    };\n    Save.prototype.addEventListener = function () {\n        this.parent.on(beginSave, this.initiateSave, this);\n        this.parent.on(saveCompleted, this.saveCompleted, this);\n    };\n    Save.prototype.removeEventListener = function () {\n        if (!this.parent.isDestroyed) {\n            this.parent.off(beginSave, this.initiateSave);\n            this.parent.off(saveCompleted, this.saveCompleted);\n        }\n    };\n    /**\n     * Get the module name.\n     * @returns string\n     * @private\n     */\n    Save.prototype.getModuleName = function () {\n        return 'save';\n    };\n    /**\n     * Initiate save process.\n     * @hidden\n     */\n    Save.prototype.initiateSave = function (args) {\n        this.parent.showSpinner();\n    };\n    /**\n     * Save action completed.\n     * @hidden\n     */\n    Save.prototype.saveCompleted = function (args) {\n        this.parent.hideSpinner();\n    };\n    return Save;\n}());\nexport { Save };\n","import { ContextMenu as ContextMenuComponent } from '@syncfusion/ej2-navigations';\nimport { closest, extend, detach } from '@syncfusion/ej2-base';\nimport { removeSheetTab, cMenuBeforeOpen, renameSheetTab, cut, copy, paste } from '../common/index';\nimport { addContextMenuItems, removeContextMenuItems, enableContextMenuItems, initiateCustomSort, hideSheet } from '../common/index';\nimport { openHyperlink, initiateHyperlink, editHyperlink, hideShow, applyProtect } from '../common/index';\nimport { filterByCellValue, reapplyFilter, clearFilter, getFilteredColumn, applySort, locale } from '../common/index';\nimport { getRangeIndexes, getColumnHeaderText, getCellIndexes, insertModel } from '../../workbook/common/index';\nimport { getSwapRange } from '../../workbook/index';\n/**\n * Represents context menu for Spreadsheet.\n */\nvar ContextMenu = /** @class */ (function () {\n    /**\n     * Constructor for ContextMenu module.\n     */\n    function ContextMenu(parent) {\n        this.parent = parent;\n        this.init();\n    }\n    ContextMenu.prototype.init = function () {\n        this.initContextMenu();\n        this.addEventListener();\n    };\n    ContextMenu.prototype.initContextMenu = function () {\n        var ul = document.createElement('ul');\n        ul.id = this.parent.element.id + '_contextmenu';\n        this.parent.element.appendChild(ul);\n        this.contextMenuInstance = new ContextMenuComponent({\n            cssClass: 'e-spreadsheet-contextmenu',\n            target: '#' + this.parent.element.id,\n            filter: 'e-numericcontainer e-active-cell e-selection e-row e-header-row e-select-all-cell e-sheet-tabs-items',\n            select: this.selectHandler.bind(this),\n            beforeOpen: this.beforeOpenHandler.bind(this),\n            beforeClose: this.beforeCloseHandler.bind(this)\n        }, ul);\n    };\n    /**\n     * Before close event handler.\n     */\n    ContextMenu.prototype.beforeCloseHandler = function (args) {\n        this.parent.trigger('contextMenuBeforeClose', args);\n    };\n    /**\n     * Select event handler.\n     */\n    // tslint:disable-next-line\n    ContextMenu.prototype.selectHandler = function (args) {\n        var selectArgs = extend({ cancel: false }, args);\n        this.parent.trigger('contextMenuItemSelect', selectArgs);\n        var id = this.parent.element.id + '_cmenu';\n        if (!selectArgs.cancel) {\n            var l10n = this.parent.serviceLocator.getService(locale);\n            var indexes = void 0;\n            switch (args.item.id) {\n                case id + '_cut':\n                    this.parent.notify(cut, { isAction: true, promise: Promise });\n                    break;\n                case id + '_copy':\n                    this.parent.notify(copy, { isAction: true, promise: Promise });\n                    break;\n                case id + '_paste':\n                    this.parent.notify(paste, { isAction: true, isInternal: true });\n                    break;\n                case id + '_pastevalues':\n                    this.parent.notify(paste, { type: 'Values', isAction: true, isInternal: true });\n                    break;\n                case id + '_pasteformats':\n                    this.parent.notify(paste, { type: 'Formats', isAction: true, isInternal: true });\n                    break;\n                case id + '_rename':\n                    this.parent.notify(renameSheetTab, {});\n                    break;\n                case id + '_delete_sheet':\n                    this.parent.notify(removeSheetTab, {});\n                    break;\n                case id + '_insert_sheet':\n                    this.parent.notify(insertModel, { model: this.parent, start: this.parent.activeSheetIndex,\n                        end: this.parent.activeSheetIndex, modelType: 'Sheet', isAction: true });\n                    break;\n                case id + '_hide_sheet':\n                    this.parent.notify(hideSheet, null);\n                    break;\n                case id + '_ascending':\n                    this.parent.notify(applySort, null);\n                    break;\n                case id + '_descending':\n                    this.parent.notify(applySort, { sortOptions: { sortDescriptors: { order: 'Descending' } } });\n                    break;\n                case id + '_customsort':\n                    this.parent.notify(initiateCustomSort, null);\n                    break;\n                case id + '_filtercellvalue':\n                    this.parent.notify(filterByCellValue, null);\n                    break;\n                case id + '_clearfilter':\n                    var field = getColumnHeaderText(getCellIndexes(this.parent.getActiveSheet().activeCell)[1] + 1);\n                    this.parent.notify(clearFilter, { field: field });\n                    break;\n                case id + '_reapplyfilter':\n                    this.parent.notify(reapplyFilter, null);\n                    break;\n                case id + '_hide_row':\n                    indexes = getRangeIndexes(this.parent.getActiveSheet().selectedRange);\n                    this.parent.notify(hideShow, {\n                        startIndex: indexes[0], endIndex: indexes[2], hide: true, isCol: false, actionUpdate: true\n                    });\n                    this.parent.element.focus();\n                    break;\n                case id + '_unhide_row':\n                    indexes = getRangeIndexes(this.parent.getActiveSheet().selectedRange);\n                    this.parent.notify(hideShow, {\n                        startIndex: indexes[0], endIndex: indexes[2], hide: false, isCol: false, actionUpdate: true\n                    });\n                    this.parent.element.focus();\n                    break;\n                case id + '_hide_column':\n                    indexes = getRangeIndexes(this.parent.getActiveSheet().selectedRange);\n                    this.parent.notify(hideShow, {\n                        startIndex: indexes[1], endIndex: indexes[3], hide: true, isCol: true, actionUpdate: true\n                    });\n                    this.parent.element.focus();\n                    break;\n                case id + '_unhide_column':\n                    indexes = getRangeIndexes(this.parent.getActiveSheet().selectedRange);\n                    this.parent.notify(hideShow, {\n                        startIndex: indexes[1], endIndex: indexes[3], hide: false, isCol: true, actionUpdate: true\n                    });\n                    this.parent.element.focus();\n                    break;\n                case id + '_insert_row_above':\n                case id + '_delete_row':\n                    indexes = getRangeIndexes(this.parent.getActiveSheet().selectedRange);\n                    this.parent.notify(args.item.id.substr(id.length + 1, 6) + \"Model\", { model: this.parent.getActiveSheet(), start: indexes[0], end: indexes[2], modelType: 'Row', isAction: true,\n                        insertType: 'above' });\n                    this.parent.element.focus();\n                    break;\n                case id + '_insert_row_below':\n                    indexes = getSwapRange(getRangeIndexes(this.parent.getActiveSheet().selectedRange));\n                    this.parent.notify(insertModel, { model: this.parent.getActiveSheet(), start: indexes[2] + 1, end: indexes[2] + 1 + (indexes[2] - indexes[0]), modelType: 'Row', isAction: true,\n                        insertType: 'below' });\n                    this.parent.element.focus();\n                    break;\n                case id + '_insert_column_before':\n                case id + '_delete_column':\n                    indexes = getRangeIndexes(this.parent.getActiveSheet().selectedRange);\n                    this.parent.notify(args.item.id.substr(id.length + 1, 6) + \"Model\", { model: this.parent.getActiveSheet(), start: indexes[1], end: indexes[3], modelType: 'Column', isAction: true });\n                    this.parent.element.focus();\n                    break;\n                case id + '_insert_column_after':\n                    indexes = getSwapRange(getRangeIndexes(this.parent.getActiveSheet().selectedRange));\n                    this.parent.notify(insertModel, { model: this.parent.getActiveSheet(), start: indexes[3] + 1, end: indexes[3] + 1 + (indexes[3] - indexes[1]), modelType: 'Column', isAction: true });\n                    this.parent.element.focus();\n                    break;\n                case id + '_hyperlink':\n                    this.parent.notify(initiateHyperlink, null);\n                    break;\n                case id + '_editHyperlink':\n                    this.parent.notify(editHyperlink, null);\n                    break;\n                case id + '_openHyperlink':\n                    this.parent.notify(openHyperlink, null);\n                    break;\n                case id + '_removeHyperlink':\n                    this.parent.removeHyperlink(this.parent.getActiveSheet().selectedRange);\n                    break;\n                case id + '_protect':\n                    var sheet = this.parent.getActiveSheet();\n                    this.parent.setSheetPropertyOnMute(sheet, 'isProtected', !sheet.isProtected);\n                    var isActive = void 0;\n                    sheet.isProtected ? isActive = false : isActive = true;\n                    this.parent.notify(applyProtect, { isActive: isActive });\n                    break;\n            }\n        }\n    };\n    ContextMenu.prototype.getInsertModel = function (startIndex, endIndex) {\n        var model = [];\n        for (var i = startIndex; i <= endIndex; i++) {\n            if (i === startIndex) {\n                model.push({ index: i });\n            }\n            else {\n                model.push({});\n            }\n        }\n        return model;\n    };\n    /**\n     * Before open event handler.\n     */\n    ContextMenu.prototype.beforeOpenHandler = function (args) {\n        var target = this.getTarget(args.event.target);\n        var items;\n        if (args.element.classList.contains('e-contextmenu')) {\n            items = this.getDataSource(target);\n            this.contextMenuInstance.items = items;\n            this.contextMenuInstance.dataBind();\n        }\n        else {\n            items = args.items;\n        }\n        if (target === 'ColumnHeader' || target === 'RowHeader') {\n            if (args.element && args.element.childElementCount > 0) {\n                var insertEle = target === 'ColumnHeader' ? args.element.querySelector('#' + this.parent.element.id + '_cmenu_insert_column') :\n                    args.element.querySelector('#' + this.parent.element.id + '_cmenu_insert_row');\n                var deleteEle = target ===\n                    'ColumnHeader' ? args.element.querySelector('#' + this.parent.element.id + '_cmenu_delete_column') :\n                    args.element.querySelector('#' + this.parent.element.id + '_cmenu_delete_row');\n                if (this.parent.allowInsert && insertEle.classList.contains('e-disabled')) {\n                    insertEle.classList.remove('e-disabled');\n                }\n                else if (!this.parent.allowInsert && !insertEle.classList.contains('e-disabled')) {\n                    insertEle.classList.add('e-disabled');\n                }\n                if (this.parent.allowDelete && deleteEle.classList.contains('e-disabled')) {\n                    deleteEle.classList.remove('e-disabled');\n                }\n                else if (!this.parent.allowDelete && !deleteEle.classList.contains('e-disabled')) {\n                    deleteEle.classList.add('e-disabled');\n                }\n            }\n        }\n        this.parent.trigger('contextMenuBeforeOpen', args);\n        this.parent.notify(cMenuBeforeOpen, extend(args, { target: target, items: items }));\n    };\n    /**\n     * To get target area based on right click.\n     */\n    ContextMenu.prototype.getTarget = function (target) {\n        if (closest(target, '.e-sheet-content')) {\n            return 'Content';\n        }\n        else if (closest(target, '.e-column-header')) {\n            return 'ColumnHeader';\n        }\n        else if (closest(target, '.e-row-header')) {\n            return 'RowHeader';\n        }\n        else if (closest(target, '.e-sheet-tabs-items')) {\n            return 'Footer';\n        }\n        else if (closest(target, '.e-selectall-container')) {\n            return 'SelectAll';\n        }\n        else {\n            return '';\n        }\n    };\n    /**\n     * To populate context menu items based on target area.\n     */\n    ContextMenu.prototype.getDataSource = function (target) {\n        var l10n = this.parent.serviceLocator.getService(locale);\n        var items = [];\n        var id = this.parent.element.id + '_cmenu';\n        if (target === 'Content') {\n            this.setClipboardData(items, l10n, id);\n            items.push({ separator: true });\n            //push filter and sort items here\n            this.setFilterItems(items, id);\n            this.setSortItems(items, id);\n            items.push({ separator: true });\n            this.setHyperLink(items, id);\n        }\n        else if (target === 'RowHeader') {\n            this.setClipboardData(items, l10n, id);\n            var indexes = getRangeIndexes(this.parent.getActiveSheet().selectedRange);\n            this.setInsertDeleteItems(items, l10n, 'Row', id, [indexes[0], indexes[2]], ['Above', 'Below']);\n            this.setHideShowItems(items, l10n, 'Row', id, [indexes[0], indexes[2]]);\n        }\n        else if (target === 'ColumnHeader') {\n            this.setClipboardData(items, l10n, id);\n            var indexes = getRangeIndexes(this.parent.getActiveSheet().selectedRange);\n            this.setInsertDeleteItems(items, l10n, 'Column', id, [indexes[1], indexes[3]], ['Before', 'After']);\n            this.setHideShowItems(items, l10n, 'Column', id, [indexes[1], indexes[3]]);\n        }\n        else if (target === 'SelectAll') {\n            this.setClipboardData(items, l10n, id);\n            this.setFilterItems(items, id);\n            this.setSortItems(items, id);\n        }\n        else if (target === 'Footer') {\n            items.push({\n                text: l10n.getConstant('Insert'), id: id + '_insert_sheet'\n            });\n            items.push({\n                text: l10n.getConstant('Delete'), iconCss: 'e-icons e-delete', id: id + '_delete_sheet'\n            });\n            items.push({\n                text: l10n.getConstant('Rename'), id: id + '_rename'\n            });\n            items.push({\n                text: l10n.getConstant('Hide'), id: id + '_hide_sheet'\n            });\n            this.setProtectSheetItems(items, id);\n        }\n        return items;\n    };\n    ContextMenu.prototype.setProtectSheetItems = function (items, id) {\n        var l10n = this.parent.serviceLocator.getService(locale);\n        if (this.parent.getActiveSheet().isProtected) {\n            items.push({\n                text: l10n.getConstant('UnprotectSheet'), id: id + '_protect', iconCss: 'e-icons e-protect-icon',\n            });\n        }\n        else {\n            items.push({\n                text: l10n.getConstant('ProtectSheet'), id: id + '_protect', iconCss: 'e-icons e-protect-icon',\n            });\n        }\n    };\n    /**\n     * Sets sorting related items to the context menu.\n     */\n    ContextMenu.prototype.setFilterItems = function (items, id) {\n        if (this.parent.allowFiltering) {\n            var l10n = this.parent.serviceLocator.getService(locale);\n            var args = { clearFilterText: null, isFiltered: false };\n            this.parent.notify(getFilteredColumn, args);\n            items.push({\n                text: l10n.getConstant('Filter'), id: id + '_filter',\n                iconCss: '',\n                items: [\n                    { text: args.clearFilterText, iconCss: 'e-icons e-filter-clear', id: id + '_clearfilter' },\n                    { text: l10n.getConstant('ReapplyFilter'), iconCss: 'e-icons e-filter-reapply', id: id + '_reapplyfilter' },\n                    { separator: true },\n                    { text: l10n.getConstant('FilterCellValue'), iconCss: '', id: id + '_filtercellvalue' }\n                ]\n            });\n        }\n    };\n    /**\n     * Sets sorting related items to the context menu.\n     */\n    ContextMenu.prototype.setSortItems = function (items, id) {\n        var l10n = this.parent.serviceLocator.getService(locale);\n        if (this.parent.allowSorting) {\n            items.push({\n                text: l10n.getConstant('Sort'), id: id + '_sort',\n                iconCss: 'e-icons e-sort-icon',\n                items: [\n                    { text: l10n.getConstant('SortAscending'), iconCss: 'e-icons e-sort-asc', id: id + '_ascending' },\n                    { text: l10n.getConstant('SortDescending'), iconCss: 'e-icons e-sort-desc', id: id + '_descending' },\n                    { text: l10n.getConstant('CustomSort') + '...', iconCss: 'e-icons e-sort-custom', id: id + '_customsort' }\n                ]\n            });\n        }\n    };\n    ContextMenu.prototype.setHyperLink = function (items, id) {\n        var sheet = this.parent.getActiveSheet();\n        if (this.parent.allowHyperlink) {\n            var l10n = this.parent.serviceLocator.getService(locale);\n            if ((!document.activeElement.getElementsByClassName('e-hyperlink')[0] &&\n                !document.activeElement.classList.contains('e-hyperlink')) || (sheet.isProtected && !sheet.protectSettings.insertLink)) {\n                items.push({\n                    text: l10n.getConstant('Hyperlink'), iconCss: 'e-icons e-hyperlink-icon', id: id + '_hyperlink'\n                });\n            }\n            else {\n                items.push({ text: l10n.getConstant('EditHyperlink'), iconCss: 'e-icons e-edithyperlink-icon', id: id + '_editHyperlink' }, { text: l10n.getConstant('OpenHyperlink'), iconCss: 'e-icons e-openhyperlink-icon', id: id + '_openHyperlink' }, { text: l10n.getConstant('RemoveHyperlink'), iconCss: 'e-icons e-removehyperlink-icon', id: id + '_removeHyperlink' });\n            }\n        }\n    };\n    ContextMenu.prototype.setClipboardData = function (items, l10n, id) {\n        if (this.parent.enableClipboard) {\n            items.push({\n                text: l10n.getConstant('Cut'),\n                iconCss: 'e-icons e-cut-icon', id: id + '_cut'\n            });\n            items.push({\n                text: l10n.getConstant('Copy'),\n                iconCss: 'e-icons e-copy-icon', id: id + '_copy'\n            });\n            items.push({\n                text: l10n.getConstant('Paste'),\n                iconCss: 'e-icons e-paste-icon', id: id + '_paste'\n            });\n            items.push({\n                text: l10n.getConstant('PasteSpecial'), id: id + '_pastespecial',\n                items: [\n                    { text: l10n.getConstant('Values'), id: id + '_pastevalues' },\n                    { text: l10n.getConstant('Formats'), id: id + '_pasteformats' }\n                ]\n            });\n        }\n    };\n    ContextMenu.prototype.setInsertDeleteItems = function (items, l10n, layout, id, indexes, subItems) {\n        items.push({ separator: true });\n        ['Insert', 'Delete'].forEach(function (action) {\n            if (indexes[0] === indexes[1]) {\n                items.push({ text: l10n.getConstant(\"\" + action + layout), id: id + (\"_\" + action.toLowerCase() + \"_\" + layout.toLowerCase()) });\n            }\n            else {\n                items.push({ text: l10n.getConstant(\"\" + action + layout + \"s\"), id: id + (\"_\" + action.toLowerCase() + \"_\" + layout.toLowerCase()) });\n            }\n            if (action === 'Insert') {\n                items[items.length - 1].items = [];\n                subItems.forEach(function (item) {\n                    items[items.length - 1].items.push({\n                        text: l10n.getConstant(item), id: items[items.length - 1].id + \"_\" + item.toLowerCase()\n                    });\n                });\n            }\n        });\n    };\n    ContextMenu.prototype.setHideShowItems = function (items, l10n, layout, id, indexes) {\n        if (indexes[0] === indexes[1]) {\n            items.push({ text: l10n.getConstant(\"Hide\" + layout), id: id + (\"_hide_\" + layout.toLowerCase()) });\n        }\n        else {\n            items.push({ text: l10n.getConstant(\"Hide\" + layout + \"s\"), id: id + (\"_hide_\" + layout.toLowerCase()) });\n        }\n        if (this.parent.hiddenCount(indexes[0], indexes[1], layout.toLowerCase() + \"s\")) {\n            items.push({ text: l10n.getConstant(\"UnHide\" + layout + \"s\"), id: id + (\"_unhide_\" + layout.toLowerCase()) });\n        }\n    };\n    /**\n     * To add event listener.\n     */\n    ContextMenu.prototype.addEventListener = function () {\n        this.parent.on(addContextMenuItems, this.addItemsHandler, this);\n        this.parent.on(removeContextMenuItems, this.removeItemsHandler, this);\n        this.parent.on(enableContextMenuItems, this.enableItemsHandler, this);\n    };\n    /**\n     * To add context menu items before / after particular item.\n     */\n    ContextMenu.prototype.addItemsHandler = function (args) {\n        if (args.insertAfter) {\n            this.contextMenuInstance.insertAfter(args.items, args.text, args.isUniqueId);\n        }\n        else {\n            this.contextMenuInstance.insertBefore(args.items, args.text, args.isUniqueId);\n        }\n    };\n    /**\n     * To remove context menu items.\n     */\n    ContextMenu.prototype.removeItemsHandler = function (args) {\n        this.contextMenuInstance.removeItems(args.items, args.isUniqueId);\n    };\n    /**\n     * To enable / disable context menu items.\n     */\n    ContextMenu.prototype.enableItemsHandler = function (args) {\n        this.contextMenuInstance.enableItems(args.items, args.enable, args.isUniqueId);\n    };\n    /**\n     * To remove event listener.\n     */\n    ContextMenu.prototype.removeEventListener = function () {\n        if (!this.parent.isDestroyed) {\n            this.parent.off(addContextMenuItems, this.addItemsHandler);\n            this.parent.off(removeContextMenuItems, this.removeItemsHandler);\n            this.parent.off(enableContextMenuItems, this.enableItemsHandler);\n        }\n    };\n    /**\n     * To get module name.\n     */\n    ContextMenu.prototype.getModuleName = function () {\n        return 'contextMenu';\n    };\n    /**\n     * Destroy method.\n     */\n    ContextMenu.prototype.destroy = function () {\n        this.removeEventListener();\n        this.contextMenuInstance.destroy();\n        var ele = document.getElementById(this.parent.element.id + '_contextmenu');\n        if (ele) {\n            detach(ele);\n        }\n        this.parent = null;\n    };\n    return ContextMenu;\n}());\nexport { ContextMenu };\n","import { refreshCellElement } from '../../workbook/common/event';\nimport { isNullOrUndefined } from '@syncfusion/ej2-base';\n/**\n * Specifies number format.\n */\nvar NumberFormat = /** @class */ (function () {\n    function NumberFormat(parent) {\n        this.parent = parent;\n        this.addEventListener();\n        //Spreadsheet.Inject(WorkbookNumberFormat);\n    }\n    NumberFormat.prototype.refreshCellElement = function (args) {\n        var cell = this.parent.getCell(args.rowIndex, args.colIndex);\n        if (!isNullOrUndefined(cell)) {\n            this.parent.refreshNode(cell, args);\n        }\n    };\n    /**\n     * Adding event listener for number format.\n     * @hidden\n     */\n    NumberFormat.prototype.addEventListener = function () {\n        this.parent.on(refreshCellElement, this.refreshCellElement, this);\n    };\n    /**\n     * Removing event listener for number format.\n     * @hidden\n     */\n    NumberFormat.prototype.removeEventListener = function () {\n        if (!this.parent.isDestroyed) {\n            this.parent.off(refreshCellElement, this.refreshCellElement);\n        }\n    };\n    /**\n     * To Remove the event listeners.\n     */\n    NumberFormat.prototype.destroy = function () {\n        this.removeEventListener();\n        this.parent = null;\n    };\n    /**\n     * Get the workbook import module name.\n     */\n    NumberFormat.prototype.getModuleName = function () {\n        return 'numberFormat';\n    };\n    return NumberFormat;\n}());\nexport { NumberFormat };\n","import { initiateCustomSort, locale, dialog, getFilterRange } from '../index';\nimport { applySort, completeAction, beginAction } from '../index';\nimport { sortComplete, beforeSort, getFormattedCellObject } from '../../workbook/common/event';\nimport { getIndexesFromAddress, getSwapRange, getCell, inRange } from '../../workbook/index';\nimport { getColumnHeaderText, getRangeAddress } from '../../workbook/index';\nimport { getUniqueID, getComponent, enableRipple } from '@syncfusion/ej2-base';\nimport { DropDownList } from '@syncfusion/ej2-dropdowns';\nimport { RadioButton, CheckBox } from '@syncfusion/ej2-buttons';\nimport { ListView } from '@syncfusion/ej2-lists';\n/**\n * `Sort` module is used to handle the sort action in Spreadsheet.\n */\nvar Sort = /** @class */ (function () {\n    /**\n     * Constructor for sort module.\n     */\n    function Sort(parent) {\n        this.parent = parent;\n        this.addEventListener();\n    }\n    /**\n     * To destroy the sort module.\n     * @return {void}\n     */\n    Sort.prototype.destroy = function () {\n        this.removeEventListener();\n        this.parent = null;\n    };\n    Sort.prototype.addEventListener = function () {\n        this.parent.on(applySort, this.applySortHandler, this);\n        this.parent.on(sortComplete, this.sortCompleteHandler, this);\n        this.parent.on(initiateCustomSort, this.initiateCustomSortHandler, this);\n    };\n    Sort.prototype.removeEventListener = function () {\n        if (!this.parent.isDestroyed) {\n            this.parent.off(applySort, this.applySortHandler);\n            this.parent.off(sortComplete, this.sortCompleteHandler);\n            this.parent.off(initiateCustomSort, this.initiateCustomSortHandler);\n        }\n    };\n    /**\n     * Gets the module name.\n     * @returns string\n     */\n    Sort.prototype.getModuleName = function () {\n        return 'sort';\n    };\n    /**\n     * Validates the range and returns false when invalid.\n     */\n    Sort.prototype.isValidSortRange = function () {\n        var sheet = this.parent.getActiveSheet();\n        var range = getSwapRange(getIndexesFromAddress(sheet.selectedRange));\n        if (range[0] > sheet.usedRange.rowIndex || range[1] > sheet.usedRange.colIndex) {\n            return false;\n        }\n        return true;\n    };\n    /**\n     * Shows the range error alert dialog.\n     * @param error - range error string.\n     */\n    Sort.prototype.sortRangeAlertHandler = function (args) {\n        var _this = this;\n        var dialogInst = this.parent.serviceLocator.getService(dialog);\n        dialogInst.show({\n            height: 180, width: 400, isModal: true, showCloseIcon: true,\n            content: args.error,\n            beforeOpen: function (args) {\n                var dlgArgs = {\n                    dialogName: 'SortRangeDialog',\n                    element: args.element, target: args.target, cancel: args.cancel\n                };\n                _this.parent.trigger('dialogBeforeOpen', dlgArgs);\n                if (dlgArgs.cancel) {\n                    args.cancel = true;\n                }\n            },\n        });\n        this.parent.hideSpinner();\n    };\n    /**\n     * Initiates the custom sort dialog.\n     */\n    Sort.prototype.initiateCustomSortHandler = function () {\n        var _this = this;\n        var l10n = this.parent.serviceLocator.getService(locale);\n        if (!this.isValidSortRange()) {\n            this.sortRangeAlertHandler({ error: l10n.getConstant('SortOutOfRangeError') });\n            return;\n        }\n        var dialogInst = this.parent.serviceLocator.getService(dialog);\n        dialogInst.show({\n            height: 400, width: 560, isModal: true, showCloseIcon: true, cssClass: 'e-customsort-dlg',\n            header: l10n.getConstant('CustomSort'),\n            beforeOpen: function (args) {\n                var dlgArgs = {\n                    dialogName: 'CustomSortDialog',\n                    element: args.element, target: args.target, cancel: args.cancel\n                };\n                _this.parent.trigger('dialogBeforeOpen', dlgArgs);\n                if (dlgArgs.cancel) {\n                    args.cancel = true;\n                }\n                dialogInst.dialogInstance.content = _this.customSortContent();\n                dialogInst.dialogInstance.dataBind();\n                _this.parent.element.focus();\n            },\n            buttons: [{\n                    buttonModel: {\n                        content: l10n.getConstant('Ok'), isPrimary: true\n                    },\n                    click: function () {\n                        var element = dialogInst.dialogInstance.content;\n                        var list = element.getElementsByClassName('e-list-sort e-listview e-lib')[0];\n                        var listview = getComponent(list, 'listview');\n                        var data = listview.dataSource;\n                        _this.clearError();\n                        var errorElem = element.getElementsByClassName('e-sort-error')[0];\n                        errorElem.style.display = 'block';\n                        if (!_this.validateError(data, element, errorElem)) {\n                            dialogInst.hide();\n                            var headercheck = element.getElementsByClassName('e-sort-checkheader')[0];\n                            var headerCheckbox = getComponent(headercheck, 'checkbox');\n                            var caseCheckbox = getComponent(element.getElementsByClassName('e-sort-checkcase')[0], 'checkbox');\n                            var hasHeader = headerCheckbox.checked;\n                            _this.applySortHandler({ sortOptions: { sortDescriptors: data, containsHeader: hasHeader, caseSensitive: caseCheckbox.checked } });\n                        }\n                    }\n                }]\n        });\n    };\n    /**\n     * Validates the errors of the sort criteria and displays the error.\n     * @param json - listview datasource.\n     * @param dialogElem - dialog content element.\n     * @param errorElem - element to display error.\n     */\n    Sort.prototype.validateError = function (json, dialogElem, errorElem) {\n        var l10n = this.parent.serviceLocator.getService(locale);\n        var hasEmpty = json.some(function (element) { return element.field.toString() === ''; });\n        if (hasEmpty) {\n            Array.prototype.some.call(dialogElem.getElementsByClassName('e-sort-field'), function (dropDown) {\n                var hasError = !getComponent(dropDown, 'dropdownlist').value;\n                if (hasError) {\n                    dropDown.parentElement.classList.add('e-error');\n                }\n                return hasError; //breaks the loop if only one error added.\n            });\n            errorElem.innerText = l10n.getConstant('SortEmptyFieldError');\n            return true;\n        }\n        var temp = new Set();\n        var duplicateField = '';\n        var hasDuplicate = json.some(function (element) {\n            duplicateField = element.field.toString();\n            return temp.size === temp.add(element.field).size;\n        });\n        var errorField = '';\n        if (hasDuplicate) {\n            var count_1 = 0;\n            Array.prototype.some.call(dialogElem.getElementsByClassName('e-sort-field'), function (dropDown) {\n                var dropDownList = getComponent(dropDown, 'dropdownlist');\n                if (dropDownList.value === duplicateField) {\n                    dropDown.parentElement.classList.add('e-error');\n                    errorField = dropDownList.text;\n                    count_1++;\n                }\n                return count_1 === 2; //breaks the loop when 2 errors added.\n            });\n            errorElem.innerHTML = '<strong>' + errorField + '</strong>' + l10n.getConstant('SortDuplicateFieldError');\n            return true;\n        }\n        return false;\n    };\n    /**\n     * Creates all the elements and generates the dialog content element.\n     */\n    Sort.prototype.customSortContent = function () {\n        var dialogElem = this.parent.createElement('div', { className: 'e-sort-dialog' });\n        var fields = this.getFields();\n        var listId = getUniqueID('customSort');\n        var listviewObj = this.getCustomListview(listId);\n        this.setHeaderTab(dialogElem, listviewObj, fields);\n        var contentElem = this.parent.createElement('div', {\n            className: 'e-sort-listsection',\n            styles: ''\n        });\n        dialogElem.appendChild(contentElem);\n        var listview = this.parent.createElement('div', { className: 'e-list-sort', styles: '' });\n        contentElem.appendChild(listview);\n        listviewObj.createElement = this.parent.createElement;\n        listviewObj.appendTo(listview);\n        this.renderListItem(listId, listviewObj, true, fields);\n        var errorElem = this.parent.createElement('div', { className: 'e-sort-error' });\n        dialogElem.appendChild(errorElem);\n        return dialogElem;\n    };\n    /**\n     * Gets the fields data from the selected range.\n     */\n    Sort.prototype.getFields = function () {\n        var sheet = this.parent.getActiveSheet();\n        var range = getSwapRange(getIndexesFromAddress(sheet.selectedRange));\n        if (range[0] === range[2] && (range[2] - range[0]) === 0) { //for entire range\n            range[0] = 0;\n            range[1] = 0;\n            range[3] = sheet.usedRange.colIndex;\n            var args = { filterRange: [], hasFilter: false };\n            this.parent.notify(getFilterRange, args);\n            if (args.hasFilter && args.filterRange) {\n                range[0] = args.filterRange[0];\n            }\n        }\n        var fields = [];\n        var fieldName;\n        for (range[1]; range[1] <= range[3]; range[1]++) {\n            var cell = getCell(range[0], range[1], sheet);\n            if (cell && cell.value) {\n                var eventArgs = {\n                    formattedText: cell.value,\n                    value: cell.value,\n                    format: cell.format,\n                    onLoad: true\n                };\n                if (cell.format) {\n                    this.parent.notify(getFormattedCellObject, eventArgs);\n                }\n                fieldName = eventArgs.formattedText;\n            }\n            else {\n                fieldName = 'Column ' + getColumnHeaderText(range[1] + 1);\n            }\n            fields.push({ text: fieldName, value: 'Column ' + getColumnHeaderText(range[1] + 1) });\n        }\n        return fields;\n    };\n    /**\n     * Creates the header tab for the custom sort dialog.\n     * @param dialogElem - dialog content element.\n     * @param listviewObj - listview instance.\n     * @param fields - fields data.\n     */\n    Sort.prototype.setHeaderTab = function (dialogElem, listviewObj, fields) {\n        var _this = this;\n        var l10n = this.parent.serviceLocator.getService(locale);\n        var headerTabElement = this.parent.createElement('div', {\n            className: 'e-sort-header',\n            styles: '',\n            innerHTML: ''\n        });\n        dialogElem.appendChild(headerTabElement);\n        var addButton = this.parent.createElement('button', {\n            className: 'e-btn e-sort-addbtn e-flat',\n            innerHTML: l10n.getConstant('AddColumn')\n        });\n        var footer = this.parent.element.querySelector('.e-customsort-dlg .e-footer-content');\n        footer.insertBefore(addButton, footer.firstElementChild);\n        addButton.addEventListener('click', function () {\n            if (listviewObj) {\n                var listId = getUniqueID('customSort');\n                listviewObj.addItem([{ id: listId, text: l10n.getConstant('ThenBy'), field: '', order: 'ascending' }]);\n                _this.renderListItem(listId, listviewObj, checkHeaderObj.checked, fields, true);\n            }\n        });\n        var checkHeaderObj = new CheckBox({\n            label: l10n.getConstant('ContainsHeader'),\n            checked: true,\n            change: function (args) {\n                var fieldsMap = args.checked ? { text: 'text', value: 'value' } : { text: 'value' };\n                Array.prototype.forEach.call(dialogElem.getElementsByClassName('e-sort-field e-dropdownlist e-lib'), function (dropDown) {\n                    var dropDownListObj = getComponent(dropDown, 'dropdownlist');\n                    dropDownListObj.dataSource = null; //reset datasource.\n                    dropDownListObj.dataSource = fields;\n                    dropDownListObj.fields = fieldsMap;\n                    dropDownListObj.dataBind();\n                });\n            },\n            cssClass: 'e-sort-headercheckbox'\n        });\n        var headerCheckbox = this.parent.createElement('input', {\n            className: 'e-sort-checkheader', attrs: { type: 'checkbox' }\n        });\n        headerTabElement.appendChild(headerCheckbox);\n        checkHeaderObj.createElement = this.parent.createElement;\n        checkHeaderObj.appendTo(headerCheckbox);\n        var checkCaseObj = new CheckBox({\n            label: l10n.getConstant('CaseSensitive'),\n            checked: false,\n            cssClass: 'e-sort-casecheckbox'\n        });\n        var caseCheckbox = this.parent.createElement('input', {\n            className: 'e-sort-checkcase', attrs: { type: 'checkbox' }\n        });\n        headerTabElement.appendChild(caseCheckbox);\n        checkCaseObj.createElement = this.parent.createElement;\n        checkCaseObj.appendTo(caseCheckbox);\n    };\n    /**\n     * Creates a listview instance.\n     * @param listId - unique id of the list item.\n     */\n    Sort.prototype.getCustomListview = function (listId) {\n        var l10n = this.parent.serviceLocator.getService(locale);\n        var data = [{ id: listId, text: l10n.getConstant('SortBy'), field: '', order: 'ascending' }];\n        enableRipple(false);\n        var listviewObj = new ListView({\n            dataSource: data,\n            fields: { id: 'id' },\n            height: '100%',\n            template: '<div class=\"e-sort-listwrapper\">' +\n                '<span class=\"text\">${text}</span>' +\n                '<div class=\"e-sort-row\"><div class=\"e-sort-field\"></div>' +\n                '<div class=\"e-sort-order\">' +\n                '<span class=\"e-sort-ordertxt\" style=\"display:none;\">${order}</span></div>' +\n                '<span class=\"e-icons e-sort-delete\"></span></div>',\n            cssClass: 'e-sort-template',\n        });\n        return listviewObj;\n    };\n    /**\n     * Triggers the click event for delete icon.\n     * @param element - current list item element.\n     * @param listviewObj - listview instance.\n     */\n    Sort.prototype.deleteHandler = function (element, listviewObj) {\n        var iconEle = element.getElementsByClassName('e-sort-delete')[0];\n        //Event handler to bind the click event for delete icon\n        iconEle.addEventListener('click', function () {\n            if (element) {\n                listviewObj.removeItem(element);\n            }\n        });\n    };\n    /**\n     * Renders the dropdown and radio button components inside list item.\n     * @param id - unique id of the list item.\n     * @param listviewObj - listview instance.\n     * @param containsHeader - data contains header.\n     * @param fields - fields data.\n     */\n    Sort.prototype.renderListItem = function (id, lvObj, containsHeader, fields, btn) {\n        var _this = this;\n        var l10n = this.parent.serviceLocator.getService(locale);\n        var element = lvObj.element.querySelector('li[data-uid=' + id + ']');\n        var fieldsMap = containsHeader ? { text: 'text', value: 'value' } : { text: 'value' };\n        var dropDown = element.getElementsByClassName('e-sort-field')[0];\n        var dropDownListObj = new DropDownList({\n            dataSource: fields,\n            width: 'auto',\n            cssClass: 'e-sort-field-ddl',\n            fields: fieldsMap,\n            placeholder: l10n.getConstant('SelectAColumn'),\n            change: function (args) {\n                if (!args.value) {\n                    return;\n                }\n                Array.prototype.some.call(lvObj.dataSource, function (item) {\n                    if (item.id === id) {\n                        item.field = args.value.toString().replace('Column ', '');\n                    }\n                    return item.id === id; //breaks the loop when proper id found\n                });\n                _this.clearError();\n            }\n        });\n        dropDownListObj.createElement = this.parent.createElement;\n        dropDownListObj.appendTo(dropDown);\n        if (!btn) {\n            dropDownListObj.index = 0;\n        }\n        /* sort ascending radio button */\n        var orderRadio = element.getElementsByClassName('e-sort-order')[0];\n        var ordertxtElem = orderRadio.getElementsByClassName('e-sort-ordertxt')[0];\n        var isAscending = ordertxtElem.innerText.toLocaleLowerCase() === 'ascending';\n        var radiobutton = new RadioButton({\n            label: l10n.getConstant('SortAscending'),\n            name: 'sortAZ_' + id, value: 'ascending', checked: isAscending, cssClass: 'e-sort-radiobutton',\n            change: function (args) { _this.setRadioBtnValue(lvObj, id, args.value); }\n        });\n        var radio = this.parent.createElement('input', {\n            id: 'orderAsc_' + id, className: 'e-sort-radioasc', styles: '', attrs: { type: 'radio' }\n        });\n        orderRadio.appendChild(radio);\n        radiobutton.createElement = this.parent.createElement;\n        radiobutton.appendTo(radio);\n        /* sort descending radio button */\n        var radiobutton2 = new RadioButton({\n            label: l10n.getConstant('SortDescending'),\n            name: 'sortAZ_' + id, value: 'descending', checked: !isAscending, cssClass: 'e-sort-radiobutton',\n            change: function (args) { _this.setRadioBtnValue(lvObj, id, args.value); }\n        });\n        var radio2 = this.parent.createElement('input', {\n            id: 'orderDesc_' + id, className: 'e-sort-radiodesc', styles: '', attrs: { type: 'radio' }\n        });\n        orderRadio.appendChild(radio2);\n        radiobutton2.createElement = this.parent.createElement;\n        radiobutton2.appendTo(radio2);\n        this.deleteHandler(element, lvObj);\n    };\n    /**\n     * Sets the new value of the radio button.\n     * @param listviewObj - listview instance.\n     * @param id - unique id of the list item.\n     * @param value - new value.\n     */\n    Sort.prototype.setRadioBtnValue = function (listviewObj, id, value) {\n        if (!value) {\n            return;\n        }\n        Array.prototype.some.call(listviewObj.dataSource, function (item) {\n            if (item.id === id) {\n                item.order = value;\n            }\n            return item.id === id; //breaks the loop when proper id found\n        });\n    };\n    /**\n     * Clears the error from the dialog.\n     * @param dialogElem - dialog content element.\n     */\n    Sort.prototype.clearError = function () {\n        var dialogElem = document.getElementsByClassName('e-sort-dialog')[0];\n        var errorElem = dialogElem.getElementsByClassName('e-sort-error')[0];\n        if (errorElem.style.display !== 'none' && errorElem.innerHTML !== '') {\n            errorElem.style.display = 'none';\n            Array.prototype.forEach.call(dialogElem.getElementsByClassName('e-error'), function (element) {\n                element.classList.remove('e-error');\n            });\n        }\n    };\n    /**\n     * Triggers sort events and applies sorting.\n     */\n    Sort.prototype.applySortHandler = function (args) {\n        var _this = this;\n        var sheet = this.parent.getActiveSheet();\n        var address = args && args.range || sheet.selectedRange;\n        var sortOptions = args && args.sortOptions || { sortDescriptors: {} };\n        var beforeArgs = { range: address, sortOptions: sortOptions, cancel: false };\n        this.parent.trigger(beforeSort, beforeArgs);\n        if (beforeArgs.cancel) {\n            return;\n        }\n        this.parent.notify(beginAction, { eventArgs: beforeArgs, action: 'beforeSort' });\n        this.parent.showSpinner();\n        var range = getSwapRange(getIndexesFromAddress(beforeArgs.range));\n        var eventArgs = { filterRange: [], hasFilter: false };\n        if (range[0] === range[2] && (range[2] - range[0]) === 0) { //check for filter range\n            this.parent.notify(getFilterRange, eventArgs);\n            if (eventArgs.hasFilter && inRange(eventArgs.filterRange, range[0], range[1])) {\n                range[0] = eventArgs.filterRange[0];\n                range[1] = 0;\n                range[2] = sheet.usedRange.rowIndex;\n                range[3] = sheet.usedRange.colIndex;\n                beforeArgs.sortOptions.containsHeader = true;\n            }\n        }\n        this.parent.sort(beforeArgs.sortOptions, getRangeAddress(range)).then(function (sortArgs) {\n            _this.parent.trigger(sortComplete, sortArgs);\n            _this.parent.notify(completeAction, { eventArgs: sortArgs, action: 'sorting' });\n            return Promise.resolve(sortArgs);\n        }).catch(function (error) {\n            _this.sortRangeAlertHandler({ error: error });\n            return Promise.reject(error);\n        });\n    };\n    /**\n     * Invoked when the sort action is completed.\n     */\n    Sort.prototype.sortCompleteHandler = function (args) {\n        var range = getIndexesFromAddress(args.range);\n        this.parent.serviceLocator.getService('cell').refreshRange(range);\n        this.parent.hideSpinner();\n    };\n    return Sort;\n}());\nexport { Sort };\n","import { locale, dialog, mouseDown, renderFilterCell, initiateFilterUI } from '../index';\nimport { reapplyFilter, filterCellKeyDown } from '../index';\nimport { getFilteredColumn, cMenuBeforeOpen, filterByCellValue, clearFilter, getFilterRange, applySort, getCellPosition } from '../index';\nimport { filterRangeAlert, filterComplete, beforeFilter, clearAllFilter, getFilteredCollection } from '../../workbook/common/event';\nimport { getIndexesFromAddress, getSwapRange, getColumnHeaderText } from '../../workbook/index';\nimport { getData, getTypeFromFormat, getCell, getCellIndexes, getRangeAddress, getSheet } from '../../workbook/index';\nimport { getComponent } from '@syncfusion/ej2-base';\nimport { ExcelFilterBase, beforeFltrcMenuOpen, CheckBoxFilterBase } from '@syncfusion/ej2-grids';\nimport { beforeCustomFilterOpen, parentsUntil, filterCboxValue } from '@syncfusion/ej2-grids';\nimport { Button } from '@syncfusion/ej2-buttons';\nimport { Query, DataManager } from '@syncfusion/ej2-data';\n/**\n * `Filter` module is used to handle the filter action in Spreadsheet.\n */\nvar Filter = /** @class */ (function () {\n    /**\n     * Constructor for filter module.\n     */\n    function Filter(parent) {\n        this.parent = parent;\n        this.filterCollection = new Map();\n        this.filterClassList = new Map();\n        this.filterRange = new Map();\n        this.addEventListener();\n    }\n    /**\n     * To destroy the filter module.\n     * @return {void}\n     */\n    Filter.prototype.destroy = function () {\n        this.removeEventListener();\n        this.filterRange = null;\n        this.filterCollection = null;\n        this.filterClassList = null;\n        this.parent = null;\n    };\n    Filter.prototype.addEventListener = function () {\n        this.parent.on(filterRangeAlert, this.filterRangeAlertHandler, this);\n        this.parent.on(initiateFilterUI, this.initiateFilterUIHandler, this);\n        this.parent.on(mouseDown, this.filterMouseDownHandler, this);\n        this.parent.on(renderFilterCell, this.renderFilterCellHandler, this);\n        this.parent.on(clearAllFilter, this.clearAllFilterHandler, this);\n        this.parent.on(beforeFltrcMenuOpen, this.beforeFilterMenuOpenHandler, this);\n        this.parent.on(beforeCustomFilterOpen, this.beforeCustomFilterOpenHandler, this);\n        this.parent.on(reapplyFilter, this.reapplyFilterHandler, this);\n        this.parent.on(filterByCellValue, this.filterByCellValueHandler, this);\n        this.parent.on(clearFilter, this.clearFilterHandler, this);\n        this.parent.on(getFilteredColumn, this.getFilteredColumnHandler, this);\n        this.parent.on(cMenuBeforeOpen, this.cMenuBeforeOpenHandler, this);\n        this.parent.on(filterCboxValue, this.filterCboxValueHandler, this);\n        this.parent.on(getFilterRange, this.getFilterRangeHandler, this);\n        this.parent.on(filterCellKeyDown, this.filterCellKeyDownHandler, this);\n        this.parent.on(getFilteredCollection, this.getFilteredCollection, this);\n    };\n    Filter.prototype.removeEventListener = function () {\n        if (!this.parent.isDestroyed) {\n            this.parent.off(filterRangeAlert, this.filterRangeAlertHandler);\n            this.parent.off(initiateFilterUI, this.initiateFilterUIHandler);\n            this.parent.off(mouseDown, this.filterMouseDownHandler);\n            this.parent.off(renderFilterCell, this.renderFilterCellHandler);\n            this.parent.off(clearAllFilter, this.clearAllFilterHandler);\n            this.parent.off(beforeFltrcMenuOpen, this.beforeFilterMenuOpenHandler);\n            this.parent.off(beforeCustomFilterOpen, this.beforeCustomFilterOpenHandler);\n            this.parent.off(reapplyFilter, this.reapplyFilterHandler);\n            this.parent.off(filterByCellValue, this.filterByCellValueHandler);\n            this.parent.off(clearFilter, this.clearFilterHandler);\n            this.parent.off(getFilteredColumn, this.getFilteredColumnHandler);\n            this.parent.off(cMenuBeforeOpen, this.cMenuBeforeOpenHandler);\n            this.parent.on(filterCboxValue, this.filterCboxValueHandler);\n            this.parent.off(getFilterRange, this.getFilterRangeHandler);\n            this.parent.off(filterCellKeyDown, this.filterCellKeyDownHandler);\n            this.parent.off(getFilteredCollection, this.getFilteredCollection);\n        }\n    };\n    /**\n     * Gets the module name.\n     * @returns string\n     */\n    Filter.prototype.getModuleName = function () {\n        return 'filter';\n    };\n    /**\n     * Validates the range and returns false when invalid.\n     */\n    Filter.prototype.isInValidFilterRange = function (sheet, range) {\n        var selectedRange = range ? getSwapRange(getIndexesFromAddress(range)) :\n            getSwapRange(getIndexesFromAddress(sheet.selectedRange));\n        return selectedRange[0] > sheet.usedRange.rowIndex || selectedRange[1] > sheet.usedRange.colIndex;\n    };\n    /**\n     * Shows the range error alert dialog.\n     * @param error - range error string.\n     */\n    Filter.prototype.filterRangeAlertHandler = function (args) {\n        var _this = this;\n        var dialogInst = this.parent.serviceLocator.getService(dialog);\n        dialogInst.show({\n            content: args.error, isModal: true,\n            height: 180, width: 400, showCloseIcon: true,\n            beforeOpen: function (args) {\n                var dlgArgs = {\n                    dialogName: 'FilterRangeDialog',\n                    element: args.element, target: args.target, cancel: args.cancel\n                };\n                _this.parent.trigger('dialogBeforeOpen', dlgArgs);\n                if (dlgArgs.cancel) {\n                    args.cancel = true;\n                }\n            },\n        });\n        this.parent.hideSpinner();\n    };\n    /**\n     * Triggers before filter context menu opened and used to add sorting items.\n     */\n    Filter.prototype.beforeFilterMenuOpenHandler = function (args) {\n        var l10n = this.parent.serviceLocator.getService(locale);\n        args.element.classList.add('e-spreadsheet-contextmenu'); // to show sort icons\n        var ul = args.element.querySelector('ul');\n        this.addMenuItem(ul, l10n.getConstant('SortDescending'), 'e-filter-sortdesc', 'e-sort-desc');\n        this.addMenuItem(ul, l10n.getConstant('SortAscending'), 'e-filter-sortasc', 'e-sort-asc');\n        args.element.appendChild(ul);\n    };\n    /**\n     * Creates new menu item element\n     */\n    Filter.prototype.addMenuItem = function (ul, text, className, iconCss) {\n        var li = this.parent.createElement('li', { className: className + ' e-menu-item' });\n        li.innerHTML = text;\n        li.insertBefore(this.parent.createElement('span', { className: 'e-menu-icon e-icons ' + iconCss }), li.firstChild);\n        ul.insertBefore(li, ul.firstChild);\n    };\n    /**\n     * Initiates the filter UI for the selected range.\n     */\n    Filter.prototype.initiateFilterUIHandler = function (args) {\n        var _this = this;\n        var predicates = args ? args.predicates : null;\n        var sheetIdx = args.sIdx;\n        if (!sheetIdx && sheetIdx !== 0) {\n            sheetIdx = this.parent.activeSheetIndex;\n        }\n        if (this.filterRange.size > 0 && this.filterRange.has(sheetIdx)) { //disable filter\n            this.removeFilter(sheetIdx);\n            if (!predicates) {\n                return;\n            }\n        }\n        var sheet = getSheet(this.parent, sheetIdx);\n        if (this.isInValidFilterRange(sheet, args.range)) {\n            var l10n = this.parent.serviceLocator.getService(locale);\n            this.filterRangeAlertHandler({ error: l10n.getConstant('FilterOutOfRangeError') });\n            return;\n        }\n        this.processRange(sheet, sheetIdx, args ? args.range : null);\n        if (predicates) {\n            var range = this.filterRange.get(sheetIdx).slice();\n            range[0] = range[0] + 1; // to skip first row.\n            range[2] = sheet.usedRange.rowIndex; //filter range should be till used range.\n            getData(this.parent, sheet.name + \"!\" + getRangeAddress(range), true, true).then(function (jsonData) {\n                _this.filterSuccessHandler(new DataManager(jsonData), {\n                    action: 'filtering',\n                    filterCollection: predicates, field: predicates[0].field, sIdx: args.sIdx\n                });\n                predicates.forEach(function (predicate) {\n                    if (_this.filterClassList.get(sheetIdx)[predicate.field] &&\n                        _this.filterClassList.get(sheetIdx)[predicate.field].indexOf(' e-filtered') < 0) {\n                        _this.filterClassList.get(sheetIdx)[predicate.field] += ' e-filtered';\n                    }\n                });\n                _this.refreshFilterRange(null, false, args.sIdx);\n            });\n        }\n    };\n    /**\n     * Processes the range if no filter applied.\n     */\n    Filter.prototype.processRange = function (sheet, sheetIdx, filterRange) {\n        var range = getSwapRange(getIndexesFromAddress(filterRange || sheet.selectedRange));\n        if (range[0] === range[2] && range[1] === range[3]) { //if selected range is a single cell \n            range[0] = 0;\n            range[1] = 0;\n            range[2] = sheet.usedRange.rowIndex;\n            range[3] = sheet.usedRange.colIndex;\n        }\n        this.filterRange.set(sheetIdx, range);\n        this.filterCollection.set(sheetIdx, []);\n        this.filterClassList.set(sheetIdx, {});\n        this.refreshFilterRange(range, false, sheetIdx);\n    };\n    /**\n     * Removes all the filter related collections for the active sheet.\n     */\n    Filter.prototype.removeFilter = function (sheetIdx) {\n        if (this.filterCollection.get(sheetIdx).length) {\n            this.parent.clearFilter();\n        }\n        var range = this.filterRange.get(sheetIdx).slice();\n        this.filterRange.delete(sheetIdx);\n        this.filterCollection.delete(sheetIdx);\n        this.filterClassList.delete(sheetIdx);\n        this.refreshFilterRange(range, true, sheetIdx);\n    };\n    /**\n     * Handles filtering cell value based on context menu.\n     */\n    Filter.prototype.filterByCellValueHandler = function () {\n        var _this = this;\n        var sheetIdx = this.parent.activeSheetIndex;\n        var sheet = this.parent.getActiveSheet();\n        if (this.isInValidFilterRange(sheet)) {\n            var l10n = this.parent.serviceLocator.getService(locale);\n            this.filterRangeAlertHandler({ error: l10n.getConstant('FilterOutOfRangeError') });\n            return;\n        }\n        var cell = getCellIndexes(sheet.activeCell);\n        if (!this.isFilterRange(sheetIdx, cell[0], cell[1])) {\n            this.processRange(sheet, sheetIdx);\n        }\n        var range = this.filterRange.get(sheetIdx).slice();\n        range[0] = range[0] + 1; // to skip first row.\n        range[2] = sheet.usedRange.rowIndex; //filter range should be till used range.\n        var field = getColumnHeaderText(cell[1] + 1);\n        var type = this.getColumnType(sheet, cell[1] + 1, range);\n        var predicates = [{\n                field: field,\n                operator: type === 'date' || type === 'datetime' || type === 'boolean' ? 'equal' : 'contains',\n                value: getCell(cell[0], cell[1], sheet).value, matchCase: false, type: type\n            }];\n        getData(this.parent, sheet.name + \"!\" + getRangeAddress(range), true, true).then(function (jsonData) {\n            _this.filterSuccessHandler(new DataManager(jsonData), { action: 'filtering', filterCollection: predicates, field: field });\n        });\n    };\n    /**\n     * Creates filter buttons and renders the filter applied cells.\n     */\n    Filter.prototype.renderFilterCellHandler = function (args) {\n        var sheetIdx = args.sIdx | this.parent.activeSheetIndex;\n        if (this.filterRange.has(sheetIdx) && this.isFilterCell(sheetIdx, args.rowIndex, args.colIndex)) {\n            if (!args.td) {\n                return;\n            }\n            var field = getColumnHeaderText(args.colIndex + 1);\n            if (this.filterClassList.has(sheetIdx) && !this.filterClassList.get(sheetIdx)[field]) {\n                this.filterClassList.get(sheetIdx)[field] = '';\n            }\n            if (args.td.querySelector('.e-filter-btn')) {\n                var element = args.td.querySelector('.e-filter-iconbtn');\n                var filterBtnObj = getComponent(element, 'btn');\n                filterBtnObj.iconCss = 'e-icons e-filter-icon' + this.filterClassList.get(sheetIdx)[field];\n            }\n            else {\n                var filterButton = this.parent.createElement('div', { className: 'e-filter-btn' });\n                var filterBtnObj = new Button({ iconCss: 'e-icons e-filter-icon' + this.filterClassList.get(sheetIdx)[field], cssClass: 'e-filter-iconbtn' });\n                args.td.insertBefore(filterButton, args.td.firstChild);\n                filterBtnObj.createElement = this.parent.createElement;\n                filterBtnObj.appendTo(filterButton);\n            }\n        }\n    };\n    /**\n     * Refreshes the filter header range.\n     */\n    Filter.prototype.refreshFilterRange = function (filterRange, remove, sIdx) {\n        var sheetIdx = sIdx;\n        if (!sheetIdx && sheetIdx !== 0) {\n            sheetIdx = this.parent.activeSheetIndex;\n        }\n        var range = filterRange || this.filterRange.get(sheetIdx).slice();\n        for (var index = range[1]; index <= range[3]; index++) {\n            var cell = this.parent.getCell(range[0], index);\n            if (remove) {\n                if (cell && cell.hasChildNodes()) {\n                    var element = cell.querySelector('.e-filter-btn');\n                    if (element) {\n                        cell.removeChild(element);\n                    }\n                }\n            }\n            else {\n                this.renderFilterCellHandler({ td: cell, rowIndex: range[0], colIndex: index, sIdx: sheetIdx });\n            }\n        }\n    };\n    /**\n     * Checks whether the provided cell is a filter cell.\n     */\n    Filter.prototype.isFilterCell = function (sheetIdx, rowIndex, colIndex) {\n        var range = this.filterRange.get(sheetIdx);\n        return (range && range[0] === rowIndex && range[1] <= colIndex && range[3] >= colIndex);\n    };\n    /**\n     * Checks whether the provided cell is in a filter range\n     */\n    Filter.prototype.isFilterRange = function (sheetIdx, rowIndex, colIndex) {\n        var range = this.filterRange.get(sheetIdx);\n        return (range && range[0] <= rowIndex && range[2] >= rowIndex && range[1] <= colIndex && range[3] >= colIndex);\n    };\n    /**\n     * Gets the filter information from active cell\n     */\n    Filter.prototype.getFilteredColumnHandler = function (args) {\n        var sheetIdx = this.parent.activeSheetIndex;\n        var l10n = this.parent.serviceLocator.getService(locale);\n        args.clearFilterText = l10n.getConstant('ClearFilter');\n        if (this.filterRange.has(sheetIdx)) {\n            var filterCollection = this.filterCollection.get(sheetIdx);\n            if (args.isClearAll) {\n                args.isFiltered = filterCollection && filterCollection.length > 0;\n                return;\n            }\n            var range = this.filterRange.get(sheetIdx).slice();\n            var sheet = this.parent.getActiveSheet();\n            var cell = getCellIndexes(sheet.activeCell);\n            if (this.isFilterRange(sheetIdx, cell[0], cell[1])) {\n                args.field = getColumnHeaderText(cell[1] + 1);\n                var headerCell = getCell(range[0], cell[1], sheet);\n                var cellValue = this.parent.getDisplayText(headerCell);\n                args.clearFilterText = l10n.getConstant('ClearFilterFrom') + '\\\"'\n                    + (cellValue ? cellValue.toString() : 'Column ' + args.field) + '\\\"';\n                filterCollection.some(function (value) {\n                    args.isFiltered = value.field === args.field;\n                    return args.isFiltered;\n                });\n            }\n        }\n    };\n    /**\n     * Triggers before context menu created to enable or disable items.\n     */\n    Filter.prototype.cMenuBeforeOpenHandler = function (e) {\n        var id = this.parent.element.id + '_cmenu';\n        if (e.parentItem && e.parentItem.id === id + '_filter' && e.target === '') {\n            var args = { isFiltered: false };\n            this.getFilteredColumnHandler(args);\n            this.parent.enableContextMenuItems([id + '_clearfilter', id + '_reapplyfilter'], !!args.isFiltered, true);\n        }\n    };\n    /**\n     * Closes the filter popup.\n     */\n    Filter.prototype.closeDialog = function () {\n        var filterPopup = this.parent.element.querySelector('.e-filter-popup');\n        var excelFilter = getComponent(filterPopup, 'dialog');\n        if (excelFilter) {\n            excelFilter.hide();\n        }\n    };\n    /**\n     * Returns true if the filter popup is opened.\n     */\n    Filter.prototype.isPopupOpened = function () {\n        var filterPopup = this.parent.element.querySelector('.e-filter-popup');\n        return filterPopup && filterPopup.style.display !== 'none';\n    };\n    Filter.prototype.filterCellKeyDownHandler = function (args) {\n        var sheetIdx = this.parent.activeSheetIndex;\n        var sheet = this.parent.getActiveSheet();\n        var indexes = getCellIndexes(sheet.activeCell);\n        if (this.isFilterCell(sheetIdx, indexes[0], indexes[1])) {\n            args.isFilterCell = true;\n            var pos = getCellPosition(sheet, indexes);\n            var target = this.parent.getCell(indexes[0], indexes[1]);\n            if (this.isPopupOpened()) {\n                this.closeDialog();\n            }\n            this.openDialog(target, pos.left, pos.top);\n        }\n        else {\n            args.isFilterCell = false;\n        }\n    };\n    /**\n     * Opens the filter popup dialog on filter button click.\n     */\n    Filter.prototype.filterMouseDownHandler = function (e) {\n        var target = e.target;\n        if (target.classList.contains('e-filter-icon')) {\n            if (this.isPopupOpened()) {\n                this.closeDialog();\n                return;\n            }\n            this.openDialog(target, e.x, e.y);\n        }\n        else if (this.isPopupOpened()) {\n            if (!target.classList.contains('e-searchinput') && !target.classList.contains('e-searchclear')\n                && (target.offsetParent && !target.offsetParent.classList.contains('e-filter-popup'))) {\n                this.closeDialog();\n            }\n            else {\n                this.selectSortItemHandler(target);\n            }\n        }\n    };\n    /**\n     * Opens the excel filter dialog based on target.\n     */\n    Filter.prototype.openDialog = function (target, xPos, yPos) {\n        var _this = this;\n        var cell = parentsUntil(target, 'e-cell');\n        var colIndex = parseInt(cell.getAttribute('aria-colindex'), 10);\n        var field = getColumnHeaderText(colIndex);\n        //Update datasource dynamically\n        this.parent.showSpinner();\n        var sheetIdx = this.parent.activeSheetIndex;\n        var range = this.filterRange.get(sheetIdx).slice();\n        var sheet = this.parent.getActiveSheet();\n        var filterCell = getCell(range[0], colIndex - 1, sheet);\n        var displayName = this.parent.getDisplayText(filterCell);\n        range[0] = range[0] + 1; // to skip first row.\n        range[2] = sheet.usedRange.rowIndex; //filter range should be till used range.\n        getData(this.parent, sheet.name + \"!\" + getRangeAddress(range), true, true).then(function (jsonData) {\n            //to avoid undefined array data\n            var checkBoxData;\n            jsonData.some(function (value, index) {\n                if (value) {\n                    checkBoxData = new DataManager(jsonData.slice(index));\n                }\n                return !!value;\n            });\n            var options = {\n                type: _this.getColumnType(sheet, colIndex, range), field: field, displayName: displayName || 'Column ' + field,\n                dataSource: checkBoxData, height: _this.parent.element.classList.contains('e-bigger') ? 800 : 500, columns: [],\n                hideSearchbox: false, filteredColumns: _this.filterCollection.get(sheetIdx), column: { 'field': field, 'filter': {} },\n                handler: _this.filterSuccessHandler.bind(_this, new DataManager(jsonData)), target: target,\n                position: { X: xPos, Y: yPos }, localeObj: _this.parent.serviceLocator.getService(locale)\n            };\n            var excelFilter = new ExcelFilterBase(_this.parent, _this.getLocalizedCustomOperators());\n            excelFilter.openDialog(options);\n            _this.parent.hideSpinner();\n        });\n    };\n    /**\n     * Formats cell value for listing it in filter popup.\n     */\n    Filter.prototype.filterCboxValueHandler = function (args) {\n        if (args.column && args.data) {\n            var fieldKey = 'field';\n            var field = args.column[fieldKey];\n            var dataKey = 'dataObj';\n            var rowKey = '__rowIndex';\n            if (args.value) {\n                var indexes = getCellIndexes(field + args.data[dataKey][rowKey]);\n                var cell = getCell(indexes[0], indexes[1], this.parent.getActiveSheet());\n                if (cell && cell.format) {\n                    args.value = this.parent.getDisplayText(cell);\n                }\n            }\n        }\n    };\n    /**\n     * Triggers when sorting items are chosen on context menu of filter popup.\n     */\n    Filter.prototype.selectSortItemHandler = function (target) {\n        var sortOrder = target.classList.contains('e-filter-sortasc') ? 'Ascending'\n            : target.classList.contains('e-filter-sortdesc') ? 'Descending' : null;\n        if (!sortOrder) {\n            return;\n        }\n        var sheet = this.parent.getActiveSheet();\n        var sheetIdx = this.parent.activeSheetIndex;\n        var range = this.filterRange.get(sheetIdx).slice();\n        range[0] = range[0] + 1; // to skip first row.\n        range[2] = sheet.usedRange.rowIndex; //filter range should be till used range.\n        this.parent.notify(applySort, { sortOptions: { sortDescriptors: { order: sortOrder } }, range: getRangeAddress(range) });\n        var cell = getIndexesFromAddress(sheet.activeCell);\n        var field = getColumnHeaderText(cell[1] + 1);\n        for (var _i = 0, _a = Object.keys(this.filterClassList.get(sheetIdx)); _i < _a.length; _i++) {\n            var key = _a[_i];\n            var className = this.filterClassList.get(sheetIdx)[key].replace(/\\se-sortasc-filter|\\se-sortdesc-filter/gi, '');\n            if (key === field) {\n                className += sortOrder === 'Ascending' ? ' e-sortasc-filter' : ' e-sortdesc-filter';\n            }\n            this.filterClassList.get(sheetIdx)[key] = className;\n        }\n        this.refreshFilterRange();\n        this.closeDialog();\n    };\n    /**\n     * Triggers when OK button or clear filter item is selected\n     */\n    Filter.prototype.filterSuccessHandler = function (dataSource, args) {\n        var sheetIdx = args.sIdx;\n        if (!sheetIdx && sheetIdx !== 0) {\n            sheetIdx = this.parent.activeSheetIndex;\n        }\n        var predicates = this.filterCollection.get(sheetIdx);\n        var dataManager = new DataManager(predicates);\n        var query = new Query();\n        var fields = dataManager.executeLocal(query.where('field', 'equal', args.field));\n        for (var index = 0; index < fields.length; index++) {\n            var sameIndex = -1;\n            for (var filterIndex = 0; filterIndex < predicates.length; filterIndex++) {\n                if (predicates[filterIndex].field === fields[index].field) {\n                    sameIndex = filterIndex;\n                    break;\n                }\n            }\n            if (sameIndex !== -1) {\n                predicates.splice(sameIndex, 1);\n            }\n        }\n        if (args.action === 'filtering') {\n            predicates = predicates.concat(args.filterCollection);\n            if (predicates.length && this.filterClassList.get(sheetIdx)[args.field].indexOf(' e-filtered') < 0) {\n                this.filterClassList.get(sheetIdx)[args.field] += ' e-filtered';\n            }\n        }\n        else {\n            this.filterClassList.get(sheetIdx)[args.field] = this.filterClassList.get(sheetIdx)[args.field].replace(' e-filtered', '');\n        }\n        this.filterCollection.set(sheetIdx, predicates);\n        var filterOptions = {\n            datasource: dataSource,\n            predicates: this.getPredicates(sheetIdx),\n        };\n        this.filterRange.get(sheetIdx)[2] = getSheet(this.parent, sheetIdx).usedRange.rowIndex; //extend the range if filtered\n        this.applyFilter(filterOptions, getRangeAddress(this.filterRange.get(sheetIdx)));\n    };\n    /**\n     * Triggers events for filtering and applies filter.\n     */\n    Filter.prototype.applyFilter = function (filterOptions, range) {\n        var _this = this;\n        var args = { range: range, filterOptions: filterOptions, cancel: false };\n        this.parent.trigger(beforeFilter, args);\n        if (args.cancel) {\n            return;\n        }\n        this.parent.showSpinner();\n        this.parent.filter(filterOptions, range).then(function (args) {\n            _this.refreshFilterRange();\n            _this.parent.hideSpinner();\n            _this.parent.trigger(filterComplete, args);\n            return Promise.resolve(args);\n        }).catch(function (error) {\n            _this.filterRangeAlertHandler({ error: error });\n            return Promise.reject(error);\n        });\n    };\n    /**\n     * Gets the predicates for the sheet\n     */\n    Filter.prototype.getPredicates = function (sheetIdx) {\n        var predicateList = [];\n        var excelPredicate = CheckBoxFilterBase.getPredicate(this.filterCollection.get(sheetIdx));\n        for (var _i = 0, _a = Object.keys(excelPredicate); _i < _a.length; _i++) {\n            var prop = _a[_i];\n            predicateList.push(excelPredicate[prop]);\n        }\n        return predicateList;\n    };\n    /**\n     * Gets the column type to pass it into the excel filter options.\n     */\n    Filter.prototype.getColumnType = function (sheet, colIndex, range) {\n        var num = 0;\n        var str = 0;\n        var date = 0;\n        var time = 0;\n        for (var i = range[0]; i <= sheet.usedRange.rowIndex; i++) {\n            var cell = getCell(i, colIndex - 1, sheet);\n            if (cell) {\n                if (cell.format) {\n                    var type = getTypeFromFormat(cell.format).toLowerCase();\n                    switch (type) {\n                        case 'number':\n                        case 'currency':\n                        case 'accounting':\n                        case 'percentage':\n                            num++;\n                            break;\n                        case 'shortdate':\n                        case 'longdate':\n                            date++;\n                            break;\n                        case 'time':\n                            num++;\n                            break;\n                        default:\n                            str++;\n                            break;\n                    }\n                }\n                else {\n                    if (typeof cell.value === 'string') {\n                        str++;\n                    }\n                    else {\n                        num++;\n                    }\n                }\n            }\n            else {\n                str++;\n            }\n        }\n        return (num > str && num > date && num > time) ? 'number' : (str > num && str > date && str > time) ? 'string'\n            : (date > num && date > str && date > time) ? 'date' : 'datetime';\n    };\n    /**\n     * Triggers before the custom filter dialog opened.\n     */\n    Filter.prototype.beforeCustomFilterOpenHandler = function () {\n        this.closeDialog();\n    };\n    /**\n     * Clears all the filtered columns in the active sheet.\n     */\n    Filter.prototype.clearAllFilterHandler = function () {\n        if (this.filterRange.has(this.parent.activeSheetIndex)) {\n            this.filterCollection.set(this.parent.activeSheetIndex, []);\n            for (var _i = 0, _a = Object.keys(this.filterClassList.get(this.parent.activeSheetIndex)); _i < _a.length; _i++) {\n                var key = _a[_i];\n                this.filterClassList.get(this.parent.activeSheetIndex)[key] = '';\n            }\n            this.refreshFilterRange();\n        }\n    };\n    /**\n     * Clear filter from the field.\n     */\n    Filter.prototype.clearFilterHandler = function (args) {\n        this.filterSuccessHandler(null, { action: 'clear-filter', filterCollection: [], field: args.field });\n    };\n    /**\n     * Reapplies the filter.\n     */\n    Filter.prototype.reapplyFilterHandler = function () {\n        var sheetIdx = this.parent.activeSheetIndex;\n        if (this.filterRange.has(sheetIdx)) {\n            this.applyFilter({ predicates: this.getPredicates(sheetIdx) }, getRangeAddress(this.filterRange.get(sheetIdx)));\n        }\n    };\n    /**\n     * Gets the filter information of the sheet.\n     */\n    Filter.prototype.getFilterRangeHandler = function (args) {\n        var sheetIdx = args.sheetIdx;\n        if (this.filterRange && this.filterRange.has(sheetIdx)) {\n            args.hasFilter = true;\n            args.filterRange = this.filterRange.get(sheetIdx);\n        }\n        else {\n            args.hasFilter = false;\n            args.filterRange = null;\n        }\n    };\n    /**\n     * Returns the custom operators for filter items.\n     */\n    Filter.prototype.getLocalizedCustomOperators = function () {\n        var l10n = this.parent.serviceLocator.getService(locale);\n        var numOptr = [\n            { value: 'equal', text: l10n.getConstant('Equal') },\n            { value: 'greaterthan', text: l10n.getConstant('GreaterThan') },\n            { value: 'greaterthanorequal', text: l10n.getConstant('GreaterThanOrEqual') },\n            { value: 'lessthan', text: l10n.getConstant('LessThan') },\n            { value: 'lessthanorequal', text: l10n.getConstant('LessThanOrEqual') },\n            { value: 'notequal', text: l10n.getConstant('NotEqual') }\n        ];\n        var customOperators = {\n            stringOperator: [\n                { value: 'startswith', text: l10n.getConstant('StartsWith') },\n                { value: 'endswith', text: l10n.getConstant('EndsWith') },\n                { value: 'contains', text: l10n.getConstant('Contains') },\n                { value: 'equal', text: l10n.getConstant('Equal') },\n                { value: 'notequal', text: l10n.getConstant('NotEqual') }\n            ],\n            numberOperator: numOptr,\n            dateOperator: numOptr,\n            datetimeOperator: numOptr,\n            booleanOperator: [\n                { value: 'equal', text: l10n.getConstant('Equal') },\n                { value: 'notequal', text: l10n.getConstant('NotEqual') }\n            ]\n        };\n        return customOperators;\n    };\n    /**\n     * To get filtered range and predicates collections\n     */\n    Filter.prototype.getFilteredCollection = function () {\n        var sheetLen = this.parent.sheets.length;\n        var col = [];\n        var fil;\n        for (var i = 0; i < sheetLen; i++) {\n            var range = void 0;\n            var hasFilter = void 0;\n            var args = { sheetIdx: i, filterRange: range, hasFilter: hasFilter };\n            this.getFilterRangeHandler(args);\n            if (args.hasFilter) {\n                var colCollection = [];\n                var condition = [];\n                var value = [];\n                var type = [];\n                var predicate = this.filterCollection.get(args.sheetIdx);\n                for (var i_1 = 0; i_1 < predicate.length; i_1++) {\n                    if (predicate[i_1].field && predicate[i_1].operator) {\n                        var colIdx = getCellIndexes(predicate[i_1].field + '1')[1];\n                        colCollection.push(colIdx);\n                        condition.push(predicate[i_1].operator);\n                        value.push(predicate[i_1].value);\n                        type.push(predicate[i_1].type);\n                    }\n                }\n                var address = getRangeAddress(args.filterRange);\n                fil = {\n                    sheetIdx: args.sheetIdx, filterRange: address, hasFilter: args.hasFilter, column: colCollection,\n                    criteria: condition, value: value, dataType: type\n                };\n                col.push(fil);\n            }\n        }\n        if (fil) {\n            this.parent.filterCollection = col;\n        }\n    };\n    return Filter;\n}());\nexport { Filter };\n","import { getColIdxFromClientX, createImageElement, deleteImage, refreshImagePosition } from '../common/event';\nimport { insertImage, refreshImgElem, refreshImgCellObj, getRowIdxFromClientY, } from '../common/event';\nimport { overlay, dialog } from '../common/index';\nimport { removeClass } from '@syncfusion/ej2-base';\nimport { getCell, setCell, getSheetIndex } from '../../workbook/index';\nimport { getRangeIndexes, setImage } from '../../workbook/index';\nvar SpreadsheetImage = /** @class */ (function () {\n    function SpreadsheetImage(parent) {\n        this.pictureCount = 1;\n        this.parent = parent;\n        this.addEventListener();\n        this.renderImageUpload();\n    }\n    /**\n     * Adding event listener for success and failure\n     */\n    SpreadsheetImage.prototype.addEventListener = function () {\n        this.parent.on(insertImage, this.insertImage, this);\n        this.parent.on(refreshImgElem, this.refreshImgElem, this);\n        this.parent.on(refreshImgCellObj, this.refreshImgCellObj, this);\n        this.parent.on(createImageElement, this.createImageElement, this);\n        this.parent.on(deleteImage, this.deleteImage, this);\n        this.parent.on(refreshImagePosition, this.refreshInsDelImagePosition, this);\n    };\n    /**\n     * Rendering upload component for importing images.\n     */\n    SpreadsheetImage.prototype.renderImageUpload = function () {\n        var uploadID = this.parent.element.id + '_imageUpload';\n        this.parent.element.appendChild(this.parent.createElement('input', {\n            id: uploadID,\n            attrs: { type: 'file', accept: '.image, .jpg, .png, .gif ,jpeg', name: 'fileUpload' }\n        }));\n        var uploadBox = document.getElementById(uploadID);\n        uploadBox.onchange = this.imageSelect.bind(this);\n        uploadBox.style.display = 'none';\n    };\n    /**\n     * Process after select the excel and image file.\n     * @param {Event} args - File select native event.\n     */\n    SpreadsheetImage.prototype.imageSelect = function (args) {\n        /* tslint:disable-next-line:no-any */\n        var filesData = args.target.files[0];\n        if (filesData && filesData.length < 1) {\n            return;\n        }\n        var impArgs = {\n            file: filesData\n        };\n        /* tslint:disable-next-line:no-any */\n        if (impArgs.file.type.indexOf('image') === 0) {\n            this.insertImage(impArgs);\n        }\n        else {\n            this.parent.serviceLocator.getService(dialog).show({\n                content: this.parent.serviceLocator.getService('spreadsheetLocale')\n                    .getConstant('UnsupportedFile'),\n                width: '300'\n            });\n        }\n        document.getElementById(this.parent.element.id + '_imageUpload').value = '';\n    };\n    /**\n     * Removing event listener for success and failure\n     */\n    SpreadsheetImage.prototype.removeEventListener = function () {\n        if (!this.parent.isDestroyed) {\n            this.parent.off(insertImage, this.insertImage);\n            this.parent.off(refreshImgCellObj, this.refreshImgCellObj);\n            this.parent.off(createImageElement, this.createImageElement);\n            this.parent.off(deleteImage, this.deleteImage);\n            this.parent.off(refreshImagePosition, this.refreshInsDelImagePosition);\n        }\n    };\n    // tslint:disable\n    SpreadsheetImage.prototype.insertImage = function (args, range) {\n        var _this = this;\n        this.binaryStringVal(args).then(function (src) { return _this.createImageElement({ options: { src: src }, range: range, isPublic: true }); });\n    };\n    SpreadsheetImage.prototype.binaryStringVal = function (args) {\n        return new Promise(function (resolve, reject) {\n            var reader = new FileReader();\n            reader.readAsDataURL(args.file);\n            reader.onload = function () { return resolve(reader.result); };\n            reader.onerror = function (error) { return reject(error); };\n        });\n    };\n    // tslint:enable\n    SpreadsheetImage.prototype.createImageElement = function (args) {\n        var range = args.range ? (args.range.indexOf('!') > 0) ? args.range.split('!')[1] : args.range.split('!')[0]\n            : this.parent.getActiveSheet().selectedRange;\n        var sheetIndex = (args.range && args.range.indexOf('!') > 0) ?\n            getSheetIndex(this.parent, args.range.split('!')[0]) : this.parent.activeSheetIndex;\n        var overlayObj = this.parent.serviceLocator.getService(overlay);\n        var id = args.options.imageId ? args.options.imageId : this.parent.element.id + '_overlay_picture_' + this.pictureCount;\n        var indexes = getRangeIndexes(range);\n        var sheet = sheetIndex ? this.parent.sheets[sheetIndex] : this.parent.getActiveSheet();\n        if (document.getElementById(id)) {\n            return;\n        }\n        var eventArgs = {\n            requestType: 'beforeInsertImage', range: sheet.name + '!' + range,\n            imageData: args.options.src, sheetIndex: sheetIndex\n        };\n        if (args.isPublic) {\n            this.parent.notify('actionBegin', { eventArgs: eventArgs, action: 'beforeInsertImage' });\n        }\n        if (eventArgs.cancel) {\n            return;\n        }\n        var element = overlayObj.insertOverlayElement(id, range, sheetIndex);\n        element.style.backgroundImage = 'url(\\'' + args.options.src + '\\')';\n        if (args.options.height || args.options.left) {\n            element.style.height = args.options.height + 'px';\n            element.style.width = args.options.width + 'px';\n            element.style.top = args.options.top + 'px';\n            element.style.left = args.options.left + 'px';\n        }\n        if (!args.options.imageId) {\n            this.pictureCount++;\n        }\n        var imgData = {\n            src: args.options.src, id: id, height: parseFloat(element.style.height.replace('px', '')),\n            width: parseFloat(element.style.width.replace('px', '')), top: parseFloat(element.style.top.replace('px', '')),\n            left: parseFloat(element.style.left.replace('px', ''))\n        };\n        this.parent.setUsedRange(indexes[0], indexes[1]);\n        if (args.isPublic || args.isUndoRedo) {\n            this.parent.notify(setImage, { options: [imgData], range: sheet.name + '!' + range });\n        }\n        var currCell = getCell(indexes[0], indexes[1], sheet);\n        if (!currCell.image[currCell.image.length - 1].id) {\n            currCell.image[currCell.image.length - 1].id = imgData.id;\n        }\n        eventArgs = {\n            requestType: 'insertImage', range: sheet.name + '!' + range, imageHeight: args.options.height ? args.options.height : 300,\n            imageWidth: args.options.width ? args.options.width : 400, imageData: args.options.src, id: id, sheetIndex: sheetIndex\n        };\n        if (!args.isUndoRedo && args.isPublic) {\n            this.parent.notify('actionComplete', { eventArgs: eventArgs, action: 'insertImage' });\n        }\n    };\n    SpreadsheetImage.prototype.refreshImgElem = function () {\n        var overlayElem = document.getElementsByClassName('e-ss-overlay-active')[0];\n        if (overlayElem) {\n            removeClass([overlayElem], 'e-ss-overlay-active');\n        }\n    };\n    SpreadsheetImage.prototype.refreshInsDelImagePosition = function (args) {\n        var count = args.count;\n        var sheetIdx = args.sheetIdx;\n        var sheet = this.parent.sheets[sheetIdx];\n        var pictureElements;\n        var currCellObj = getCell(args.rowIdx, args.colIdx, sheet);\n        var imageLen = currCellObj.image.length;\n        var top;\n        var left;\n        for (var i = 0; i < imageLen; i++) {\n            pictureElements = document.getElementById(currCellObj.image[i].id);\n            top = (args.type === 'Row') ? (args.status === 'insert') ? currCellObj.image[i].top + (count * 20) :\n                currCellObj.image[i].top - (count * 20) : currCellObj.image[i].top;\n            left = (args.type === 'Column') ? (args.status === 'insert') ? currCellObj.image[i].left + (count * 64) :\n                currCellObj.image[i].left - (count * 64) : currCellObj.image[i].left;\n            currCellObj.image[i].top = top;\n            currCellObj.image[i].left = left;\n            pictureElements.style.top = top + 'px';\n            pictureElements.style.left = left + 'px';\n        }\n    };\n    SpreadsheetImage.prototype.refreshImgCellObj = function (args) {\n        var prevRowIdx = { clientY: args.prevTop, isImage: true };\n        this.parent.notify(getRowIdxFromClientY, prevRowIdx);\n        var currRowIdx = { clientY: args.currentTop, isImage: true };\n        this.parent.notify(getRowIdxFromClientY, currRowIdx);\n        var prevColIdx = { clientX: args.prevLeft, isImage: true };\n        this.parent.notify(getColIdxFromClientX, prevColIdx);\n        var currColIdx = { clientX: args.currentLeft, isImage: true };\n        this.parent.notify(getColIdxFromClientX, currColIdx);\n        var sheet = this.parent.sheets[this.parent.activeSheetIndex];\n        var prevCellObj = getCell(prevRowIdx.clientY, prevColIdx.clientX, sheet);\n        var currCellObj = getCell(currRowIdx.clientY, currColIdx.clientX, sheet);\n        var prevCellImg = prevCellObj ? prevCellObj.image : [];\n        var prevImgObj;\n        var currImgObj;\n        var prevCellImgLen = (prevCellImg && prevCellImg.length) ? prevCellImg.length : 0;\n        if (prevCellObj && prevCellObj.image && prevCellImg.length > 0) {\n            for (var i = 0; i < prevCellImgLen; i++) {\n                if (prevCellImg[i].id === args.id) {\n                    prevImgObj = prevCellImg[i];\n                    prevImgObj.height = args.currentHeight;\n                    prevImgObj.width = args.currentWidth;\n                    prevImgObj.top = args.currentTop;\n                    prevImgObj.left = args.currentLeft;\n                    prevCellImg.splice(i, 1);\n                }\n            }\n            if (currCellObj && currCellObj.image) {\n                currImgObj = currCellObj.image;\n                if (prevImgObj) {\n                    currImgObj.push(prevImgObj);\n                }\n            }\n            (currImgObj) ? setCell(currRowIdx.clientY, currColIdx.clientX, sheet, { image: currImgObj }, true) :\n                setCell(currRowIdx.clientY, currColIdx.clientX, sheet, { image: [prevImgObj] }, true);\n            if (args.requestType === 'imageRefresh' && !args.isUndoRedo) {\n                var eventArgs = {\n                    requestType: 'imageRefresh', currentRowIdx: currRowIdx.clientY, currentColIdx: currColIdx.clientX,\n                    prevRowIdx: prevRowIdx.clientY, prevColIdx: prevColIdx.clientX, prevTop: args.prevTop, prevLeft: args.prevLeft,\n                    currentTop: args.currentTop, currentLeft: args.currentLeft, currentHeight: args.currentHeight,\n                    currentWidth: args.currentWidth, prevHeight: args.prevHeight, prevWidth: args.prevWidth,\n                    id: args.id, sheetIdx: this.parent.activeSheetIndex\n                };\n                this.parent.notify('actionComplete', { eventArgs: eventArgs, action: 'imageRefresh' });\n            }\n        }\n    };\n    SpreadsheetImage.prototype.deleteImage = function (args) {\n        var sheet;\n        var pictureElements = document.getElementById(args.id);\n        var rowIdx;\n        var colIdx;\n        var cellObj;\n        var prevCellImg;\n        var imgLength;\n        if (pictureElements) {\n            var imgTop = { clientY: pictureElements.offsetTop, isImage: true };\n            this.parent.notify(getRowIdxFromClientY, imgTop);\n            var imgleft = { clientX: pictureElements.offsetLeft, isImage: true };\n            this.parent.notify(getColIdxFromClientX, imgleft);\n            document.getElementById(args.id).remove();\n            rowIdx = imgTop.clientY;\n            colIdx = imgleft.clientX;\n            sheet = this.parent.sheets[this.parent.activeSheetIndex];\n        }\n        else {\n            var rangeVal = args.range ? args.range.indexOf('!') > 0 ? args.range.split('!')[1] : args.range.split('!')[0] :\n                this.parent.getActiveSheet().selectedRange;\n            var sheetIndex = args.range && args.range.indexOf('!') > 0 ? getSheetIndex(this.parent, args.range.split('!')[0]) :\n                this.parent.activeSheetIndex;\n            var index = getRangeIndexes(rangeVal);\n            rowIdx = index[0];\n            colIdx = index[1];\n            sheet = this.parent.sheets[sheetIndex];\n        }\n        cellObj = getCell(rowIdx, colIdx, sheet);\n        prevCellImg = cellObj.image;\n        imgLength = prevCellImg.length;\n        for (var i = 0; i < imgLength; i++) {\n            if (prevCellImg[i].id === args.id) {\n                prevCellImg.splice(i, 1);\n            }\n        }\n        setCell(rowIdx, colIdx, sheet, { image: prevCellImg }, true);\n    };\n    /**\n     * To Remove the event listeners.\n     */\n    SpreadsheetImage.prototype.destroy = function () {\n        this.removeEventListener();\n        this.parent = null;\n    };\n    /**\n     * Get the sheet picture module name.\n     */\n    SpreadsheetImage.prototype.getModuleName = function () {\n        return 'spreadsheetImage';\n    };\n    return SpreadsheetImage;\n}());\nexport { SpreadsheetImage };\n","import { getSheetIndex, isHiddenRow, getCell, setCell } from '../../workbook/base/index';\nimport { initiateChart, getRangeIndexes, isNumber, isDateTime, dateToInt } from '../../workbook/common/index';\nimport { overlay, locale, refreshChartCellObj, getRowIdxFromClientY, getColIdxFromClientX, deleteChart } from '../common/index';\nimport { beginAction, completeAction, clearChartBorder, focusBorder } from '../common/index';\nimport { Chart, ColumnSeries, Category, StackingColumnSeries, BarSeries } from '@syncfusion/ej2-charts';\nimport { AreaSeries, StackingAreaSeries, AccumulationChart } from '@syncfusion/ej2-charts';\nimport { Legend, StackingBarSeries, LineSeries, StackingLineSeries, ScatterSeries } from '@syncfusion/ej2-charts';\nimport { AccumulationLegend, PieSeries, AccumulationTooltip, AccumulationDataLabel } from '@syncfusion/ej2-charts';\nimport { isNullOrUndefined, getComponent, closest, detach } from '@syncfusion/ej2-base';\nimport { Tooltip } from '@syncfusion/ej2-popups';\nimport { getTypeFromFormat } from '../../workbook/integrations/index';\nimport { updateChart, deleteChartColl, getFormattedCellObject, setChart, getCellAddress } from '../../workbook/common/index';\nimport { insertChart, chartRangeSelection } from '../common/index';\nChart.Inject(ColumnSeries, LineSeries, BarSeries, AreaSeries, StackingColumnSeries, StackingLineSeries, StackingBarSeries, ScatterSeries);\nChart.Inject(StackingAreaSeries, Category, Legend, Tooltip);\nAccumulationChart.Inject(PieSeries, AccumulationTooltip, AccumulationDataLabel, AccumulationLegend);\n/**\n * Represents Chart support for Spreadsheet.\n */\nvar SpreadsheetChart = /** @class */ (function () {\n    /**\n     * Constructor for the Spreadsheet Chart module.\n     */\n    function SpreadsheetChart(parent) {\n        this.parent = parent;\n        this.addEventListener();\n    }\n    /**\n     * Adding event listener for success and failure\n     */\n    SpreadsheetChart.prototype.addEventListener = function () {\n        this.parent.on(initiateChart, this.initiateChartHandler, this);\n        this.parent.on(refreshChartCellObj, this.refreshChartCellObj, this);\n        this.parent.on(updateChart, this.updateChartHandler, this);\n        this.parent.on(deleteChart, this.deleteChart, this);\n        this.parent.on(clearChartBorder, this.clearBorder, this);\n        this.parent.on(insertChart, this.insertChartHandler, this);\n        this.parent.on(chartRangeSelection, this.chartRangeHandler, this);\n    };\n    SpreadsheetChart.prototype.insertChartHandler = function (args) {\n        var chartType = 'Column';\n        switch (args.id) {\n            case 'clusteredColumn':\n                chartType = 'Column';\n                break;\n            case 'stackedColumn':\n                chartType = 'StackingColumn';\n                break;\n            case 'stackedColumn100':\n                chartType = 'StackingColumn100';\n                break;\n            case 'clusteredBar':\n                chartType = 'Bar';\n                break;\n            case 'stackedBar':\n                chartType = 'StackingBar';\n                break;\n            case 'stackedBar100':\n                chartType = 'StackingBar100';\n                break;\n            case 'area':\n                chartType = 'Area';\n                break;\n            case 'stackedArea':\n                chartType = 'StackingArea';\n                break;\n            case 'stackedArea100':\n                chartType = 'StackingArea100';\n                break;\n            case 'line':\n                chartType = 'Line';\n                break;\n            case 'stackedLine':\n                chartType = 'StackingLine';\n                break;\n            case 'stackedLine100':\n                chartType = 'StackingLine100';\n                break;\n            case 'pie':\n                chartType = 'Pie';\n                break;\n            case 'doughnut':\n                chartType = 'Doughnut';\n                break;\n            //  case 'radar':\n            //     chartType = ;\n            //     break;\n            //  case 'radar_markers':\n            //     chartType = 'Column';\n            //     break;\n            case 'scatter':\n                chartType = 'Scatter';\n                break;\n        }\n        var chart = [{ type: chartType }];\n        this.parent.notify(setChart, { chart: chart });\n    };\n    SpreadsheetChart.prototype.chartRangeHandler = function () {\n        var overlayEle = document.querySelector('.e-datavisualization-chart.e-ss-overlay-active');\n        if (overlayEle) {\n            var chartId = overlayEle.getElementsByClassName('e-control')[0].id;\n            var chartColl = this.parent.chartColl;\n            var chartCollLen = chartColl.length;\n            for (var idx = 0; idx < chartCollLen; idx++) {\n                var chartEle = document.getElementById(chartColl[idx].id);\n                if (overlayEle && chartEle && chartColl[idx].id === chartId) {\n                    this.parent.notify(initiateChart, {\n                        option: chartColl[idx], chartCount: this.parent.chartCount, isRefresh: true\n                    });\n                }\n            }\n        }\n    };\n    SpreadsheetChart.prototype.getPropertyValue = function (rIdx, cIdx, sheetIndex) {\n        var sheets = this.parent.sheets;\n        if (sheets[sheetIndex] && sheets[sheetIndex].rows[rIdx] && sheets[sheetIndex].rows[rIdx].cells[cIdx]) {\n            var cell = getCell(rIdx, cIdx, this.parent.sheets[sheetIndex]);\n            var value = '';\n            if (cell.format) {\n                var formatObj = {\n                    type: getTypeFromFormat(cell.format),\n                    value: cell && cell.value, format: cell && cell.format ?\n                        cell.format : 'General', formattedText: cell && cell.value,\n                    onLoad: true, isRightAlign: false, cell: cell,\n                    rowIdx: rIdx.toString(), colIdx: cIdx.toString()\n                };\n                if (cell) {\n                    this.parent.notify(getFormattedCellObject, formatObj);\n                    if (typeof (formatObj.value) === 'number') {\n                        var escapeRegx = new RegExp('[!@#$%^&()+=\\';,{}|\\\":<>~_-]', 'g');\n                        formatObj.formattedText = (formatObj.formattedText.toString()).replace(escapeRegx, '');\n                        value = parseInt(formatObj.formattedText.toString(), 10);\n                    }\n                    else {\n                        value = formatObj.formattedText.toString();\n                        parseFloat('');\n                    }\n                }\n            }\n            else {\n                value = this.parent.sheets[sheetIndex].rows[rIdx].cells[cIdx].value;\n            }\n            return value;\n        }\n        else {\n            return '';\n        }\n    };\n    SpreadsheetChart.prototype.updateChartHandler = function (args) {\n        var series = this.initiateChartHandler({ option: args.chart, isRefresh: true });\n        var chartObj = this.parent.element.querySelector('.' + args.chart.id);\n        if (chartObj) {\n            var chartComp = getComponent(chartObj, 'chart');\n            chartComp.series = series;\n        }\n    };\n    SpreadsheetChart.prototype.refreshChartCellObj = function (args) {\n        var currRowIdx = { clientY: args.currentTop, isImage: true };\n        this.parent.notify(getRowIdxFromClientY, currRowIdx);\n        var prevRowIdx = { clientY: args.prevTop, isImage: true };\n        this.parent.notify(getRowIdxFromClientY, prevRowIdx);\n        var currColIdx = { clientX: args.currentLeft, isImage: true };\n        this.parent.notify(getColIdxFromClientX, currColIdx);\n        var prevColIdx = { clientX: args.prevLeft, isImage: true };\n        this.parent.notify(getColIdxFromClientX, prevColIdx);\n        var sheet = this.parent.sheets[this.parent.activeSheetIndex];\n        var prevCellObj = getCell(prevRowIdx.clientY, prevColIdx.clientX, sheet);\n        var currCellObj = getCell(currRowIdx.clientY, currColIdx.clientX, sheet);\n        var prevCellChart = prevCellObj ? prevCellObj.chart : [];\n        var prevChartObj;\n        var currChartObj;\n        var prevCellImgLen = (prevCellChart && prevCellChart.length) ? prevCellChart.length : 0;\n        if (prevCellObj && prevCellObj.chart) {\n            for (var i = 0; i < prevCellImgLen; i++) {\n                var overlayEle = document.getElementById(args.id);\n                var chartEleClassName = document.getElementById(prevCellChart[i].id);\n                if (closest(chartEleClassName, '.' + overlayEle.classList[1]) === overlayEle) {\n                    prevChartObj = prevCellChart[i];\n                    prevCellChart.splice(i, 1);\n                }\n            }\n            if (currCellObj && currCellObj.chart) {\n                currChartObj = currCellObj.chart;\n                if (prevChartObj) {\n                    currChartObj.push(prevChartObj);\n                }\n            }\n            (currChartObj) ? setCell(currRowIdx.clientY, currColIdx.clientX, sheet, { chart: currChartObj }, true) :\n                setCell(currRowIdx.clientY, currColIdx.clientX, sheet, { chart: [prevChartObj] }, true);\n            if (args.requestType === 'chartRefresh' && !args.isUndoRedo) {\n                var eventArgs = {\n                    requestType: 'chartRefresh', currentRowIdx: currRowIdx.clientY, currentColIdx: currColIdx.clientX,\n                    currentWidth: args.currentWidth, prevHeight: args.prevHeight, prevWidth: args.prevWidth,\n                    prevRowIdx: prevRowIdx.clientY, prevColIdx: prevColIdx.clientX, prevTop: args.prevTop, prevLeft: args.prevLeft,\n                    currentTop: args.currentTop, currentLeft: args.currentLeft, currentHeight: args.currentHeight,\n                    id: args.id, sheetIdx: this.parent.activeSheetIndex\n                };\n                this.parent.notify('actionComplete', { eventArgs: eventArgs, action: 'chartRefresh' });\n            }\n        }\n    };\n    SpreadsheetChart.prototype.processChartRange = function (range, dataSheetIdx, opt) {\n        var xRange;\n        var yRange;\n        var lRange;\n        var trVal;\n        var blVal;\n        var tlVal;\n        var minr = range[0];\n        var minc = range[1];\n        var isStringSeries = false;\n        var maxr = range[2];\n        var maxc = range[3];\n        var isSingleRow = minr === maxr;\n        var isSingleCol = minc === maxc;\n        trVal = this.getPropertyValue(minr, maxc, dataSheetIdx);\n        // trVal = this.getParseValue(trVal);\n        blVal = this.getPropertyValue(maxr, minc, dataSheetIdx);\n        // blVal = this.getParseValue(blVal);\n        tlVal = this.getPropertyValue(minr, minc, dataSheetIdx);\n        // tlVal = this.getParseValue(tlVal);\n        if (!isNumber(blVal) || !tlVal) {\n            isStringSeries = true;\n        }\n        if (isNullOrUndefined(tlVal) && !isSingleRow && !isSingleCol || (opt.type === 'Scatter' && range[3] - range[1] === 1)) {\n            xRange = [minr + 1, minc, maxr, minc];\n            yRange = [minr + 1, minc + 1, maxr, maxc];\n            lRange = [minr, minc + 1, minr, maxc];\n        }\n        else if ((!isNullOrUndefined(blVal) && isStringSeries && !isSingleRow && !isSingleCol)) {\n            if (!isNullOrUndefined(trVal) && (!isNumber(trVal) || !tlVal)) {\n                xRange = [minr + 1, minc, maxr, minc];\n                yRange = [minr + 1, minc + 1, maxr, maxc];\n                lRange = [minr, minc + 1, minr, maxc];\n            }\n            else {\n                xRange = [minr, minc, maxr, minc];\n                yRange = [minr, minc + 1, maxr, maxc];\n            }\n        }\n        else {\n            yRange = [minr, minc, maxr, maxc];\n            if ((!isNullOrUndefined(trVal) && !isNumber(trVal) && !isDateTime(trVal))) {\n                lRange = [minr, minc, minr, maxc];\n                yRange[0] = yRange[0] + 1;\n            }\n            else if (isNullOrUndefined(tlVal) && (isSingleRow || isSingleCol)) {\n                lRange = [minr, minc, minr, maxc];\n                if (isSingleRow) {\n                    yRange[1] = yRange[1] + 1;\n                    lRange[3] = lRange[1];\n                }\n                else {\n                    yRange[0] = yRange[0] + 1;\n                }\n            }\n        }\n        return { xRange: xRange, yRange: yRange, lRange: lRange };\n    };\n    SpreadsheetChart.prototype.toIntrnlRange = function (range, sheetIdx) {\n        if (!range) {\n            range = getRangeIndexes[this.parent.sheets[sheetIdx].selectedRange];\n        }\n        else if (typeof (range) === 'string') {\n            range = getRangeIndexes[range];\n        }\n        return range;\n    };\n    SpreadsheetChart.prototype.getRangeData = function (options) {\n        options.sheetIdx = isNullOrUndefined(options.sheetIdx) ? this.parent.getActiveSheet().index : options.sheetIdx;\n        var sheet = this.parent.sheets[options.sheetIdx];\n        options.range = this.toIntrnlRange(options.range, options.sheetIdx);\n        var minc;\n        var minr;\n        var maxr;\n        var maxc;\n        var skipVirtualHiddenRow;\n        var isRowHidden;\n        var rowIdx = [];\n        var arr = [];\n        skipVirtualHiddenRow = false;\n        minr = options.range[0];\n        maxr = options.range[2];\n        maxc = options.range[3];\n        isRowHidden = isHiddenRow(sheet, minr);\n        if (skipVirtualHiddenRow && isRowHidden) {\n            maxr++;\n        }\n        else if (!isRowHidden) {\n            minc = skipVirtualHiddenRow ? 0 : options.range[1];\n            this.pushRowData(options, minr, minc, maxr, maxc, arr, rowIdx, true, options.isYvalue);\n        }\n        return arr;\n    };\n    SpreadsheetChart.prototype.pushRowData = function (options, minr, minc, maxr, maxc, arr, rowIdx, isDataSrcEnsured, isYvalue) {\n        var minCol = minc;\n        while (minr <= maxr) {\n            minc = minCol;\n            while (minc <= maxc) {\n                var value = '';\n                var cell = getCell(minr, minc, this.parent.getActiveSheet());\n                if (cell && cell.format && !isYvalue) {\n                    var forArgs = {\n                        value: cell && cell.value, format: cell && cell.format ? cell.format : 'General',\n                        formattedText: cell && cell.value, onLoad: true,\n                        type: cell && getTypeFromFormat(cell.format),\n                        rowIdx: minr.toString(), colIdx: minc.toString(),\n                        isRightAlign: false, cell: cell,\n                    };\n                    this.parent.notify(getFormattedCellObject, forArgs);\n                    value = forArgs.formattedText.toString();\n                }\n                else {\n                    value = this.parent.getValueRowCol(options.sheetIdx, minr + 1, minc + 1);\n                }\n                // = this.parent.getValueRowCol(options.sheetIdx, minr + 1, minc + 1);\n                arr.push({ value: value });\n                minc++;\n            }\n            minr++;\n        }\n        rowIdx.push(minr);\n    };\n    SpreadsheetChart.prototype.toArrayData = function (args) {\n        var prop = 'value';\n        var obj;\n        var i = 0;\n        var temp = [];\n        var len = args.length;\n        while (i < len) {\n            obj = args[i];\n            if (Object.keys(obj).length) {\n                if (prop in obj) {\n                    temp.push(obj[prop]);\n                }\n            }\n            else {\n                temp.push('');\n            }\n            i++;\n        }\n        return temp;\n    };\n    SpreadsheetChart.prototype.getVirtualXValues = function (limit) {\n        var i = 1;\n        var arr = [];\n        while (i < limit) {\n            arr.push(i.toString());\n            i++;\n        }\n        return arr;\n    };\n    // tslint:disable-next-line:max-func-body-length\n    SpreadsheetChart.prototype.processChartSeries = function (options, sheetIndex, xRange, yRange, lRange) {\n        options = options || {};\n        var seriesName = '';\n        var val;\n        var len;\n        var xValue;\n        var yValue;\n        var lValue;\n        var diff;\n        var pArr;\n        var pObj = {};\n        var j;\n        var inc;\n        var i = 0;\n        var yInc = 0;\n        var sArr = [];\n        var tArr = ['value2'];\n        var dtVal;\n        yValue = this.getRangeData({ range: yRange, sheetIdx: sheetIndex, skipFormula: true, isYvalue: true });\n        var rDiff = (yRange[2] - yRange[0]) + 1;\n        var cDiff = (yRange[3] - yRange[1]) + 1;\n        if (options.isSeriesInRows) {\n            xValue = lRange ? this.toArrayData(this.getRangeData({ range: lRange, sheetIdx: sheetIndex, skipFormula: false, isYvalue: false })) :\n                this.getVirtualXValues(cDiff + 1);\n            if (xRange) {\n                lValue = this.toArrayData(this.getRangeData({ range: xRange, sheetIdx: sheetIndex, skipFormula: false, isYvalue: false }));\n            }\n            diff = rDiff;\n        }\n        else {\n            xValue = xRange ? this.toArrayData(this.getRangeData({ range: xRange, sheetIdx: sheetIndex, skipFormula: false, isYvalue: false })) :\n                this.getVirtualXValues(rDiff + 1);\n            if (lRange) {\n                lValue = this.toArrayData(this.getRangeData({ range: lRange, sheetIdx: sheetIndex, skipFormula: false, isYvalue: false }));\n            }\n            diff = cDiff;\n        }\n        len = xValue.length;\n        inc = options.isSeriesInRows ? 1 : diff;\n        while (i < diff) {\n            j = 0;\n            pArr = [];\n            yInc = options.isSeriesInRows ? yInc : i;\n            while (j < len) {\n                if (yValue[yInc]) {\n                    val = yValue[yInc].value;\n                    if (isNumber(val)) {\n                        val = Number(val);\n                    }\n                    else {\n                        dtVal = dateToInt(val);\n                        val = isNaN(dtVal) ? 0 : dtVal;\n                    }\n                    pArr.push({ x: xValue[j], y: val });\n                }\n                yInc += inc;\n                j++;\n            }\n            if (lValue && lValue.length > 0) {\n                seriesName = lValue[i];\n            }\n            else {\n                seriesName = 'series' + i;\n            }\n            if (options.type) {\n                var type = options.type;\n                if (type === 'Line' || type === 'StackingLine' || type === 'StackingLine100') {\n                    pObj = {\n                        dataSource: pArr, type: options.type, xName: 'x', yName: 'y', name: seriesName.toString(), marker: {\n                            visible: true,\n                            width: 10,\n                            height: 10\n                        }\n                    };\n                }\n                else if (type === 'Scatter') {\n                    pObj = {\n                        dataSource: pArr, type: options.type, xName: 'x', yName: 'y', name: seriesName.toString(), marker: {\n                            visible: false,\n                            width: 12,\n                            height: 12,\n                            shape: 'Circle'\n                        }\n                    };\n                }\n                else if (type === 'Pie' || type === 'Doughnut') {\n                    var innerRadius = options.type === 'Pie' ? '0%' : '40%';\n                    pObj = {\n                        dataSource: pArr,\n                        dataLabel: {\n                            visible: true, position: 'Inside', name: 'text', font: { fontWeight: '600' }\n                        },\n                        radius: '100%', xName: 'x', yName: 'y', startAngle: 0, endAngle: 360, innerRadius: innerRadius, explode: true,\n                        explodeOffset: '10%', explodeIndex: 0, name: 'Browser'\n                    };\n                }\n                else {\n                    pObj = { dataSource: pArr, type: options.type, xName: 'x', yName: 'y', name: seriesName.toString() };\n                }\n            }\n            sArr.push(pObj);\n            i++;\n        }\n        var retVal;\n        if (options.type) {\n            var type = options.type;\n            retVal = {\n                series: sArr, xRange: options.isSeriesInRows ? lRange : xRange,\n                yRange: yRange, lRange: options.isSeriesInRows ? xRange : lRange\n            };\n        }\n        return retVal;\n    };\n    SpreadsheetChart.prototype.primaryYAxisFormat = function (yRange) {\n        if (isNullOrUndefined(yRange)) {\n            return '{value}';\n        }\n        var type;\n        var cell = getCell(yRange[0], yRange[1], this.parent.getActiveSheet());\n        if (cell && cell.format) {\n            type = getTypeFromFormat(cell.format);\n            if (type === 'Accounting') {\n                return '${value}';\n            }\n            else if (type === 'Currency') {\n                return '${value}';\n            }\n            else if (type === 'Percentage') {\n                return '{value}%';\n            }\n        }\n        return '{value}';\n    };\n    SpreadsheetChart.prototype.focusChartRange = function (xRange, yRange, lRange) {\n        var border = ['e-rcborderright', 'e-rcborderbottom', 'e-vcborderright', 'e-vcborderbottom', 'e-bcborderright', 'e-bcborderbottom'];\n        this.clearBorder();\n        if (lRange) {\n            this.parent.notify(focusBorder, {\n                startcell: { rowIndex: lRange[0], colIndex: lRange[1] },\n                endcell: { rowIndex: lRange[2], colIndex: lRange[3] }, classes: [border[0], border[1]]\n            });\n        }\n        if (xRange) {\n            this.parent.notify(focusBorder, {\n                startcell: { rowIndex: xRange[0], colIndex: xRange[1] },\n                endcell: { rowIndex: xRange[2], colIndex: xRange[3] }, classes: [border[2], border[3]]\n            });\n        }\n        this.parent.notify(focusBorder, {\n            startcell: { rowIndex: yRange[0], colIndex: yRange[1] },\n            endcell: { rowIndex: yRange[2], colIndex: yRange[3] }, classes: [border[4], border[5]]\n        });\n    };\n    SpreadsheetChart.prototype.clearBorder = function () {\n        var mainCont = this.parent.getMainContent();\n        var border = ['e-rcborderright', 'e-rcborderbottom', 'e-vcborderright', 'e-vcborderbottom', 'e-bcborderright', 'e-bcborderbottom'];\n        for (var borderIdx = 0; borderIdx < border.length; borderIdx++) {\n            var eleColl = mainCont.querySelectorAll('.' + border[borderIdx]);\n            for (var tdIdx = 0; tdIdx < eleColl.length; tdIdx++) {\n                var td = eleColl[tdIdx];\n                td.classList.remove(border[borderIdx]);\n            }\n        }\n    };\n    // tslint:disable-next-line:max-func-body-length\n    SpreadsheetChart.prototype.initiateChartHandler = function (argsOpt) {\n        var isRangeSelect = true;\n        isRangeSelect = isNullOrUndefined(argsOpt.isInitCell) ? true : !argsOpt.isInitCell;\n        var l10n = this.parent.serviceLocator.getService(locale);\n        argsOpt.isUndoRedo = isNullOrUndefined(argsOpt.isUndoRedo) ? true : argsOpt.isUndoRedo;\n        var seriesModel;\n        argsOpt.isRefresh = isNullOrUndefined(argsOpt.isRefresh) ? false : argsOpt.isRefresh;\n        var sheet = this.parent.getActiveSheet();\n        var range = argsOpt.option.range ? (argsOpt.option.range.indexOf('!') > 0) ?\n            argsOpt.option.range.split('!')[1] : argsOpt.option.range.split('!')[0]\n            : this.parent.getActiveSheet().selectedRange;\n        var rangeIdx = getRangeIndexes(range);\n        var top;\n        var left;\n        var position;\n        var options = {};\n        var isRowLesser;\n        var xRange;\n        var yRange;\n        var lRange;\n        var eventArgs;\n        if (!this.parent.allowChart && sheet.isProtected) {\n            return seriesModel;\n        }\n        var sheetIdx = (argsOpt.option.range && argsOpt.option.range.indexOf('!') > 0) ?\n            getSheetIndex(this.parent, argsOpt.option.range.split('!')[0]) : this.parent.activeSheetIndex;\n        var args = {\n            sheetIndex: sheetIdx, reqType: 'shape', type: 'actionBegin', shapeType: 'chart',\n            action: 'create', options: argsOpt.option, range: range, operation: 'create',\n        };\n        options = args.options;\n        range = args.range;\n        options = options || {};\n        var chartOptions;\n        var chartRange;\n        var type = 'chart';\n        if (rangeIdx.length > 0) {\n            var rDiff = rangeIdx[2] - rangeIdx[0];\n            var cDiff = rangeIdx[3] - rangeIdx[1];\n            if (rDiff < cDiff) {\n                isRowLesser = true;\n            }\n        }\n        options.isSeriesInRows = isRowLesser ? true : options.isSeriesInRows ? options.isSeriesInRows : false;\n        argsOpt.dataSheetIdx = isNullOrUndefined(argsOpt.dataSheetIdx) ? sheetIdx : argsOpt.dataSheetIdx;\n        chartRange = this.processChartRange(rangeIdx, argsOpt.dataSheetIdx, options);\n        xRange = chartRange.xRange;\n        yRange = chartRange.yRange;\n        lRange = chartRange.lRange;\n        if (sheetIdx === this.parent.activeSheetIndex && isRangeSelect) {\n            this.focusChartRange(xRange, yRange, lRange);\n        }\n        chartOptions = this.processChartSeries(options, argsOpt.dataSheetIdx, xRange, yRange, lRange);\n        var primaryXAxis = {\n            majorGridLines: { width: 0 },\n            minorGridLines: { width: 0 },\n            majorTickLines: { width: 0 },\n            minorTickLines: { width: 0 },\n            lineStyle: { width: 0 },\n            valueType: 'Category'\n        };\n        var primaryYAxis = {\n            lineStyle: { width: 0 },\n            majorTickLines: { width: 0 },\n            majorGridLines: { width: 1 },\n            minorGridLines: { width: 1 },\n            minorTickLines: { width: 0 },\n            labelFormat: this.primaryYAxisFormat(yRange)\n        };\n        if (argsOpt.isRefresh) {\n            return chartOptions.series;\n        }\n        if (argsOpt.isUndoRedo) {\n            eventArgs = {\n                type: argsOpt.option.type, theme: argsOpt.option.theme, isSeriesInRows: argsOpt.option.isSeriesInRows,\n                range: argsOpt.option.range, id: argsOpt.option.id, posRange: argsOpt.range, isInitCell: argsOpt.isInitCell, cancel: false\n            };\n            this.parent.notify(beginAction, { eventArgs: eventArgs, action: 'beforeInsertChart' });\n            if (eventArgs.cancel) {\n                return [];\n            }\n            argsOpt.option.type = eventArgs.type;\n            argsOpt.option.theme = eventArgs.theme;\n            argsOpt.option.isSeriesInRows = eventArgs.isSeriesInRows;\n            argsOpt.option.range = eventArgs.range;\n            argsOpt.option.id = eventArgs.id;\n        }\n        var id = argsOpt.option.id + '_overlay';\n        var sheetIndex = (argsOpt.option.range && argsOpt.option.range.indexOf('!') > 0) ?\n            getSheetIndex(this.parent, argsOpt.option.range.split('!')[0]) : this.parent.activeSheetIndex;\n        var overlayObj = this.parent.serviceLocator.getService(overlay);\n        var eleRange = !isNullOrUndefined(argsOpt.isInitCell) && argsOpt.isInitCell ? argsOpt.range : range;\n        var element = overlayObj.insertOverlayElement(id, eleRange, sheetIndex);\n        element.classList.add('e-datavisualization-chart');\n        element.style.width = '482px';\n        element.style.height = '290px';\n        var chartContent = this.parent.createElement('div', {\n            id: argsOpt.option.id, className: argsOpt.option.id\n        });\n        if (argsOpt.option.type !== 'Pie' && argsOpt.option.type !== 'Doughnut') {\n            this.chart = new Chart({\n                primaryXAxis: primaryXAxis,\n                primaryYAxis: primaryYAxis,\n                chartArea: {\n                    border: {\n                        width: 0\n                    }\n                },\n                series: chartOptions.series,\n                tooltip: {\n                    enable: true\n                },\n                width: element.style.width,\n                height: element.style.height,\n                load: function (args) {\n                    var selectedTheme = argsOpt.option.theme;\n                    selectedTheme = selectedTheme ? selectedTheme : 'Material';\n                    args.chart.theme = (selectedTheme.charAt(0).toUpperCase() +\n                        selectedTheme.slice(1)).replace(/-dark/i, 'Dark').replace(/contrast/i, 'Contrast');\n                },\n                beforeResize: function (args) {\n                    args.cancelResizedEvent = true; // This is for cancel the resized event.\n                }\n            });\n            this.chart.appendTo(chartContent);\n        }\n        else {\n            this.chart = new AccumulationChart({\n                series: chartOptions.series,\n                width: element.style.width,\n                height: element.style.height,\n                center: { x: '50%', y: '50%' },\n                enableSmartLabels: true,\n                enableAnimation: true,\n                legendSettings: { visible: true, position: 'Bottom' },\n                load: function (args) {\n                    var selectedTheme = location.hash.split('/')[1];\n                    selectedTheme = selectedTheme ? selectedTheme : 'Material';\n                    args.accumulation.theme = (selectedTheme.charAt(0).toUpperCase() +\n                        selectedTheme.slice(1)).replace(/-dark/i, 'Dark').replace(/contrast/i, 'Contrast');\n                }\n            });\n            this.chart.appendTo(chartContent);\n        }\n        element.appendChild(chartContent);\n        if (argsOpt.isUndoRedo) {\n            this.parent.notify(completeAction, { eventArgs: eventArgs, action: 'insertChart' });\n        }\n        return seriesModel;\n    };\n    SpreadsheetChart.prototype.deleteChart = function (args) {\n        this.clearBorder();\n        var chartElements = null;\n        var sheet;\n        if (isNullOrUndefined(args.id)) {\n            chartElements = document.querySelector('.e-datavisualization-chart.e-ss-overlay-active');\n            args.id = chartElements ? chartElements.getElementsByClassName('e-control')[0].id : null;\n        }\n        else {\n            args.id = args.id.includes('overlay') ? args.id : args.id + '_overlay';\n            chartElements = document.getElementById(args.id);\n        }\n        if (isNullOrUndefined(args.id) || isNullOrUndefined(chartElements)) {\n            return;\n        }\n        else {\n            args.id = args.id.includes('overlay') ? args.id : args.id + '_overlay';\n        }\n        var rowIdx;\n        var colIdx;\n        var cellObj;\n        var prevCellChart;\n        var chartLength;\n        var isRemoveEle = false;\n        var chartObj;\n        for (var i = 0; i < this.parent.chartColl.length; i++) {\n            if (this.parent.chartColl[i].id === args.id.split('_overlay')[0]) {\n                chartObj = this.parent.chartColl[i];\n                break;\n            }\n        }\n        var eventArgs = {\n            id: chartObj.id, range: chartObj.range, type: chartObj.type, theme: chartObj.theme,\n            isSeriesInRows: chartObj.isSeriesInRows, isInitCell: true, posRange: null, cancel: false\n        };\n        if (chartElements) {\n            this.parent.notify(deleteChartColl, { id: args.id });\n            var imgTop = { clientY: chartElements.offsetTop, isImage: true };\n            this.parent.notify(getRowIdxFromClientY, imgTop);\n            var imgleft = { clientX: chartElements.offsetLeft, isImage: true };\n            this.parent.notify(getColIdxFromClientX, imgleft);\n            isRemoveEle = true;\n            rowIdx = imgTop.clientY;\n            colIdx = imgleft.clientX;\n            sheet = this.parent.sheets[this.parent.activeSheetIndex];\n        }\n        else {\n            this.parent.notify(deleteChartColl, { id: args.id });\n            var sheetIndex = args.range && args.range.indexOf('!') > 0 ? getSheetIndex(this.parent, args.range.split('!')[0]) :\n                this.parent.activeSheetIndex;\n            var rangeVal = args.range ? args.range.indexOf('!') > 0 ? args.range.split('!')[1] : args.range.split('!')[0] :\n                this.parent.getActiveSheet().selectedRange;\n            var index = getRangeIndexes(rangeVal);\n            rowIdx = index[0];\n            colIdx = index[1];\n            sheet = this.parent.sheets[sheetIndex];\n        }\n        cellObj = getCell(rowIdx, colIdx, sheet);\n        if (cellObj) {\n            prevCellChart = cellObj.chart;\n        }\n        chartLength = prevCellChart ? prevCellChart.length : chartLength;\n        for (var i = 0; i < chartLength; i++) {\n            var overlayEle = document.getElementById(args.id);\n            var chartEleClassName = document.getElementById(prevCellChart[i].id);\n            if (closest(chartEleClassName, '.' + overlayEle.classList[1]) === overlayEle) {\n                prevCellChart.splice(i, 1);\n            }\n        }\n        if (isRemoveEle) {\n            document.getElementById(args.id).remove();\n        }\n        setCell(rowIdx, colIdx, sheet, { chart: prevCellChart }, true);\n        eventArgs.posRange = getCellAddress(rowIdx, colIdx);\n        this.parent.notify(completeAction, { eventArgs: eventArgs, action: 'deleteChart' });\n    };\n    /**\n     * Removing event listener for success and failure\n     */\n    SpreadsheetChart.prototype.removeEventListener = function () {\n        if (!this.parent.isDestroyed) {\n            this.parent.off(initiateChart, this.initiateChartHandler);\n            this.parent.off(refreshChartCellObj, this.refreshChartCellObj);\n            this.parent.off(updateChart, this.updateChartHandler);\n            this.parent.off(deleteChart, this.deleteChart);\n            this.parent.off(clearChartBorder, this.clearBorder);\n            this.parent.off(insertChart, this.insertChartHandler);\n            this.parent.off(chartRangeSelection, this.chartRangeHandler);\n        }\n    };\n    /**\n     * To Remove the event listeners.\n     */\n    SpreadsheetChart.prototype.destroy = function () {\n        this.removeEventListener();\n        this.parent = null;\n        var chartEle = null;\n        if (this.chart) {\n            chartEle = this.chart.element;\n            this.chart.destroy();\n        }\n        if (chartEle) {\n            detach(chartEle);\n        }\n        this.chart = null;\n    };\n    /**\n     * Get the sheet chart module name.\n     */\n    SpreadsheetChart.prototype.getModuleName = function () {\n        return 'spreadsheetChart';\n    };\n    return SpreadsheetChart;\n}());\nexport { SpreadsheetChart };\n","import { Spreadsheet } from '../index';\nimport { Selection, Edit, KeyboardNavigation, KeyboardShortcut, Clipboard, WrapText, Insert, Delete, ProtectSheet } from '../actions/index';\nimport { CellFormat, CollaborativeEditing, UndoRedo, Resize, SpreadsheetHyperlink, FindAndReplace, Merge } from '../actions/index';\nimport { Formula, Sort, Filter, SpreadsheetImage, SpreadsheetChart } from '../integrations/index';\nimport { Ribbon, FormulaBar, SheetTabs, Open, ContextMenu, Save, NumberFormat } from '../integrations/index';\nimport { DataBind } from '../../workbook/index';\nimport { DataValidation } from '../actions/data-validation';\nimport { ConditionalFormatting } from '../actions/conditional-formatting';\n/**\n * Spreadsheet basic module.\n * @private\n */\nvar BasicModule = /** @class */ (function () {\n    /**\n     * Constructor for Spreadsheet basic module.\n     * @private\n     */\n    function BasicModule() {\n        Spreadsheet.Inject(Ribbon, FormulaBar, SheetTabs, Selection, Edit, KeyboardNavigation, KeyboardShortcut, Clipboard, DataBind, Open, ContextMenu, Save, NumberFormat, CellFormat, Formula, Sort, CollaborativeEditing, UndoRedo, Resize, Filter, SpreadsheetHyperlink, WrapText, Insert, Delete, ProtectSheet, DataValidation, FindAndReplace, Merge, ConditionalFormatting, SpreadsheetImage, SpreadsheetChart);\n    }\n    /**\n     * For internal use only - Get the module name.\n     * @private\n     */\n    BasicModule.prototype.getModuleName = function () {\n        return 'basic';\n    };\n    /**\n     * Destroys the Spreadsheet basic module.\n     * @return {void}\n     */\n    BasicModule.prototype.destroy = function () {\n        /* code snippet */\n    };\n    return BasicModule;\n}());\nexport { BasicModule };\n","import { Spreadsheet } from '../index';\nimport { Selection, Edit, KeyboardNavigation, KeyboardShortcut, Clipboard, CellFormat, WrapText, ProtectSheet } from '../actions/index';\nimport { CollaborativeEditing, UndoRedo, Resize, SpreadsheetHyperlink, Insert, Delete, FindAndReplace, Merge } from '../actions/index';\nimport { Ribbon, FormulaBar, SheetTabs, Open, Save, NumberFormat, Formula, Sort, Filter, SpreadsheetImage } from '../integrations/index';\nimport { SpreadsheetChart } from '../integrations/index';\nimport { DataBind } from '../../workbook/integrations/index';\nimport { DataValidation } from '../actions/data-validation';\nimport { ConditionalFormatting } from '../actions/conditional-formatting';\n/**\n * Spreadsheet all module.\n * @private\n */\nvar AllModule = /** @class */ (function () {\n    /**\n     * Constructor for Spreadsheet all module.\n     * @private\n     */\n    function AllModule() {\n        Spreadsheet.Inject(Ribbon, FormulaBar, SheetTabs, Selection, Edit, KeyboardNavigation, KeyboardShortcut, Clipboard, DataBind, Open, Save, NumberFormat, CellFormat, Formula, Sort, Resize, CollaborativeEditing, UndoRedo, Filter, SpreadsheetHyperlink, WrapText, Insert, Delete, DataValidation, ProtectSheet, FindAndReplace, Merge, SpreadsheetImage, ConditionalFormatting, SpreadsheetChart);\n    }\n    /**\n     * For internal use only - Get the module name.\n     * @private\n     */\n    AllModule.prototype.getModuleName = function () {\n        return 'all';\n    };\n    /**\n     * Destroys the Spreadsheet all module.\n     * @return {void}\n     */\n    AllModule.prototype.destroy = function () {\n        /* code snippet */\n    };\n    return AllModule;\n}());\nexport { AllModule };\n","var __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    }\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nimport { Property, ChildProperty } from '@syncfusion/ej2-base';\n/**\n * Represents the scroll settings.\n */\nvar ScrollSettings = /** @class */ (function (_super) {\n    __extends(ScrollSettings, _super);\n    function ScrollSettings() {\n        return _super !== null && _super.apply(this, arguments) || this;\n    }\n    __decorate([\n        Property(false)\n    ], ScrollSettings.prototype, \"isFinite\", void 0);\n    __decorate([\n        Property(true)\n    ], ScrollSettings.prototype, \"enableVirtualization\", void 0);\n    return ScrollSettings;\n}(ChildProperty));\nexport { ScrollSettings };\n/**\n * Represents the selection settings.\n */\nvar SelectionSettings = /** @class */ (function (_super) {\n    __extends(SelectionSettings, _super);\n    function SelectionSettings() {\n        return _super !== null && _super.apply(this, arguments) || this;\n    }\n    __decorate([\n        Property('Multiple')\n    ], SelectionSettings.prototype, \"mode\", void 0);\n    return SelectionSettings;\n}(ChildProperty));\nexport { SelectionSettings };\n","/** @hidden */\nexport var DISABLED = 'e-disabled';\n/** @hidden */\nexport var WRAPTEXT = 'e-wraptext';\n/** @hidden */\nexport var locale = 'spreadsheetLocale';\n/** @hidden */\nexport var dialog = 'dialog';\n/** @hidden */\nexport var actionEvents = 'actionEvents';\n/** @hidden */\nexport var overlay = 'shape';\n/** @hidden */\nexport var fontColor = {\n    'Custom': [\n        '#ffffff', '#000000', '#e7e6e6', '#44546a', '#4472c4', '#ed7d31', '#a5a5a5', '#ffc000', '#70ad47', '#ff0000',\n        '#f2f2f2', '#808080', '#cfcdcd', '#d5dce4', '#d9e2f3', '#fbe4d5', '#ededed', '#fff2cc', '#e2efd9', '#ffcccc',\n        '#d9d9d9', '#595959', '#aeaaaa', '#acb9ca', '#b4c6e7', '#f7caac', '#dbdbdb', '#ffe599', '#c5e0b3', '#ff8080',\n        '#bfbfbf', '#404040', '#747070', '#8496b0', '#8eaadb', '#f4b083', '#c9c9c9', '#ffd966', '#a8d08d', '#ff3333',\n        '#a6a6a6', '#262626', '#3b3838', '#323e4f', '#2f5496', '#c45911', '#7b7b7b', '#bf8f00', '#538135', '#b30000',\n        '#7f7f7f', '#0d0d0d', '#161616', '#212934', '#1f3763', '#823b0b', '#525252', '#7f5f00', '#375623', '#660000'\n    ]\n};\n/** @hidden */\nexport var fillColor = {\n    'Custom': [\n        '#ffffff', '#000000', '#ffff00', '#00ff00', '#00ffff', '#0000ff', '#ff0000', '#000080', '#800080', '#996633',\n        '#f2f2f2', '#808080', '#ffffcc', '#b3ffb3', '#ccffff', '#ccccff', '#ffcccc', '#ccccff', '#ff80ff', '#f2e6d9',\n        '#d9d9d9', '#595959', '#ffff80', '#80ff80', '#b3ffff', '#8080ff', '#ff8080', '#8080ff', '#ff00ff', '#dfbf9f',\n        '#bfbfbf', '#404040', '#ffff33', '#33ff33', '#33ffff', '#3333ff', '#ff3333', '#0000b3', '#b300b3', '#c68c53',\n        '#a6a6a6', '#262626', '#e6e600', '#00b300', '#009999', '#000099', '#b30000', '#000066', '#660066', '#86592d',\n        '#7f7f7f', '#0d0d0d', '#999900', '#006600', '#006666', '#000066', '#660000', '#00004d', '#4d004d', '#734d26',\n    ]\n};\n/**\n * Default locale text\n * @hidden\n */\nexport var defaultLocale = {\n    FindValue: 'Find value',\n    ReplaceValue: 'Replace value',\n    FindReplaceTooltip: 'Find & Replace',\n    InsertingEmptyValue: 'Reference value is not valid.',\n    ReplaceAllEnd: ' matches replaced with ',\n    ByRow: 'By Rows',\n    ByColumn: 'By Columns',\n    MatchCase: 'Match case   ',\n    MatchExactCellElements: 'Match exact cell contents',\n    Replace: 'Replace...',\n    Find: 'Find and Replace...',\n    Goto: 'Goto...',\n    EntercellAddress: 'Enter cell address',\n    GotoSpecial: 'GotoSpecial...',\n    FindAndReplace: 'Find and Replace',\n    FindNextBtn: 'Find Next',\n    FindPreviousBtn: 'Find Previous',\n    ReplaceBtn: 'Replace',\n    ReplaceAllBtn: 'Replace All',\n    GotoHeader: 'Go To',\n    GotoSpecialHeader: 'Go To Special',\n    Sheet: 'Sheet',\n    Workbook: 'Workbook',\n    NoElements: 'We couldn\\'t find what you were looking for.',\n    FindWhat: 'Find what',\n    ReplaceWith: 'Replace with',\n    Cut: 'Cut',\n    Copy: 'Copy',\n    Paste: 'Paste',\n    PasteSpecial: 'Paste Special',\n    Link: 'Link',\n    SpreadsheetHyperlink: 'SpreadsheetHyperlink',\n    Hyperlink: 'Hyperlink',\n    EditHyperlink: 'Edit Hyperlink',\n    OpenHyperlink: 'Open Hyperlink',\n    RemoveHyperlink: 'Remove Hyperlink',\n    InsertLink: 'Insert Link',\n    EditLink: 'Edit Link',\n    All: 'All',\n    Values: 'Values',\n    Formats: 'Formats',\n    Bold: 'Bold',\n    Font: 'Font',\n    FontSize: 'Font Size',\n    Italic: 'Italic',\n    Underline: 'Underline',\n    Strikethrough: 'Strikethrough',\n    TextColor: 'Text Color',\n    FillColor: 'Fill Color',\n    HorizontalAlignment: 'Horizontal Alignment',\n    AlignLeft: 'Align Left',\n    AlignCenter: 'Center',\n    AlignRight: 'Align Right',\n    VerticalAlignment: 'Vertical Alignment',\n    AlignTop: 'Align Top',\n    AlignMiddle: 'Align Middle',\n    AlignBottom: 'Align Bottom',\n    WrapText: 'Wrap Text',\n    MergeCells: 'Merge Cells',\n    MergeAll: 'Merge All',\n    MergeHorizontally: 'Merge Horizontally',\n    MergeVertically: 'Merge Vertically',\n    Unmerge: 'Unmerge',\n    UnmergeCells: 'Unmerge Cells',\n    SelectMergeType: 'Select Merge Type',\n    MergeCellsAlert: 'Merging cells will only preserve the top-leftmost(Uppermost) value. Merge anyway?',\n    PasteMergeAlert: 'We can\"t do that to a merge cell.',\n    Borders: 'Borders',\n    TopBorders: 'Top Borders',\n    LeftBorders: 'Left Borders',\n    RightBorders: 'Right Borders',\n    BottomBorders: 'Bottom Borders',\n    AllBorders: 'All Borders',\n    HorizontalBorders: 'Horizontal Borders',\n    VerticalBorders: 'Vertical Borders',\n    OutsideBorders: 'Outside Borders',\n    InsideBorders: 'Inside Borders',\n    NoBorders: 'No Borders',\n    BorderColor: 'Border Color',\n    BorderStyle: 'Border Style',\n    InsertFunction: 'Insert Function',\n    Insert: 'Insert',\n    Delete: 'Delete',\n    Rename: 'Rename',\n    Hide: 'Hide',\n    Unhide: 'Unhide',\n    NameBox: 'Name Box',\n    ShowHeaders: 'Show Headers',\n    HideHeaders: 'Hide Headers',\n    ShowGridLines: 'Show Gridlines',\n    HideGridLines: 'Hide Gridlines',\n    AddSheet: 'Add Sheet',\n    ListAllSheets: 'List All Sheets',\n    FullScreen: 'Full Screen',\n    CollapseToolbar: 'Collapse Toolbar',\n    ExpandToolbar: 'Expand Toolbar',\n    CollapseFormulaBar: 'Collapse Formula Bar',\n    ExpandFormulaBar: 'Expand Formula Bar',\n    File: 'File',\n    Home: 'Home',\n    Formulas: 'Formulas',\n    View: 'View',\n    New: 'New',\n    Open: 'Open',\n    SaveAs: 'Save As',\n    Update: 'Update',\n    ExcelXlsx: 'Microsoft Excel',\n    ExcelXls: 'Microsoft Excel 97-2003',\n    CSV: 'Comma-separated values',\n    FormulaBar: 'Formula Bar',\n    Sort: 'Sort',\n    SortAscending: 'Ascending',\n    SortDescending: 'Descending',\n    CustomSort: 'Custom Sort',\n    AddColumn: 'Add Column',\n    ContainsHeader: 'Data contains header',\n    CaseSensitive: 'Case sensitive',\n    SortBy: 'Sort by',\n    ThenBy: 'Then by',\n    SelectAColumn: 'Select a column',\n    SortEmptyFieldError: 'Sort criteria column should not be empty.',\n    SortDuplicateFieldError: ' is mentioned more than once. Duplicate columns must be removed.',\n    SortOutOfRangeError: 'Select a cell or range inside the used range and try again.',\n    SortAndFilter: 'Sort & Filter',\n    Filter: 'Filter',\n    ClearAllFilter: 'Clear',\n    ClearFilterFrom: 'Clear Filter From ',\n    ReapplyFilter: 'Reapply',\n    FilterCellValue: 'Filter by Value of Selected Cell',\n    FilterOutOfRangeError: 'Select a cell or range inside the used range and try again.',\n    HideRow: 'Hide Row',\n    HideRows: 'Hide Rows',\n    UnHideRows: 'UnHide Rows',\n    HideColumn: 'Hide Column',\n    HideColumns: 'Hide Columns',\n    UnHideColumns: 'UnHide Columns',\n    InsertRow: 'Insert Row',\n    InsertRows: 'Insert Rows',\n    Above: 'Above',\n    Below: 'Below',\n    InsertColumn: 'Insert Column',\n    InsertColumns: 'Insert Columns',\n    Before: 'Before',\n    After: 'After',\n    DeleteRow: 'Delete Row',\n    DeleteRows: 'Delete Rows',\n    DeleteColumn: 'Delete Column',\n    DeleteColumns: 'Delete Columns',\n    Ok: 'Ok',\n    Close: 'Close',\n    Cancel: 'Cancel',\n    Apply: 'Apply',\n    MoreColors: 'More Colors',\n    StandardColors: 'Standard Colors',\n    General: 'General',\n    Number: 'Number',\n    Currency: 'Currency',\n    Accounting: 'Accounting',\n    ShortDate: 'Short Date',\n    LongDate: 'Long Date',\n    Time: 'Time',\n    Percentage: 'Percentage',\n    Fraction: 'Fraction',\n    Scientific: 'Scientific',\n    Text: 'Text',\n    MobileFormulaBarPlaceHolder: 'Enter value or Formula',\n    NumberFormat: 'Number Format',\n    PasteAlert: 'You can\\'t paste this here, because the copy area and paste area aren\\'t in the same size. ' +\n        'Please try pasting in a different range.',\n    DestroyAlert: 'Are you sure you want to destroy the current workbook without saving and create a new workbook?',\n    SheetRenameInvalidAlert: 'Sheet name contains invalid character.',\n    SheetRenameEmptyAlert: 'Sheet name cannot be empty.',\n    SheetRenameAlreadyExistsAlert: 'Sheet name already exists. Please enter another name.',\n    DeleteSheetAlert: 'You can\\'t undo deleting sheets, and you might be removing some data. If you don\\'t need it, click OK to delete.',\n    DeleteSingleLastSheetAlert: 'A Workbook must contain at least one visible worksheet.',\n    PickACategory: 'Pick a category',\n    Description: 'Description',\n    UnsupportedFile: 'Unsupported File',\n    InvalidUrl: 'Invalid URL',\n    SUM: 'Adds a series of numbers and/or cells.',\n    SUMIF: 'Adds the cells based on specified condition.',\n    SUMIFS: 'Adds the cells based on specified conditions.',\n    ABS: 'Returns the value of a number without its sign.',\n    RAND: 'Returns a random number between 0 and 1.',\n    RANDBETWEEN: 'Returns a random integer based on specified values.',\n    FLOOR: 'Rounds a number down to the nearest multiple of a given factor.',\n    CEILING: 'Rounds a number up to the nearest multiple of a given factor.',\n    PRODUCT: 'Multiplies a series of numbers and/or cells.',\n    INT: 'Returns a number to the nearest integer.',\n    ROUNDUP: 'Rounds a number away from zero.',\n    SUMPRODUCT: 'Returns sum of the product of given ranges of arrays.',\n    TODAY: 'Returns the current date as date value.',\n    AVERAGE: 'Calculates average for the series of numbers and/or cells excluding text.',\n    AVERAGEIF: 'Calculates average for the cells based on specified criterion.',\n    AVERAGEIFS: 'Calculates average for the cells based on specified conditions.',\n    AVERAGEA: 'Calculates the average for the cells evaluating TRUE as 1, text and FALSE as 0.',\n    COUNT: 'Counts the cells that contain numeric values in a range.',\n    COUNTIF: 'Counts the cells based on specified condition.',\n    COUNTIFS: 'Counts the cells based on specified conditions.',\n    COUNTA: 'Counts the cells that contains values in a range.',\n    MIN: 'Returns the smallest number of the given arguments.',\n    MAX: 'Returns the largest number of the given arguments.',\n    DATE: 'Returns the date based on given year, month, and day.',\n    DAY: 'Returns the day from the given date.',\n    DAYS: 'Returns the number of days between two dates.',\n    IF: 'Returns value based on the given expression.',\n    IFS: 'Returns value based on the given multiple expressions.',\n    CalculateAND: 'Returns TRUE if all the arguments are TRUE, otherwise returns FALSE.',\n    CalculateOR: 'Returns TRUE if any of the arguments are TRUE, otherwise returns FALSE.',\n    IFERROR: 'Returns value if no error found else it will return specified value.',\n    CHOOSE: 'Returns a value from list of values, based on index number.',\n    INDEX: 'Returns a value of the cell in a given range based on row and column number.',\n    FIND: 'Returns the position of a string within another string, which is case sensitive',\n    CONCATENATE: 'Combines two or more strings together.',\n    CONCAT: 'Concatenates a list or a range of text strings.',\n    SUBTOTAL: 'Returns subtotal for a range using the given function number.',\n    RADIANS: 'Converts degrees into radians.',\n    MATCH: 'Returns the relative position of a specified value in given range.',\n    LN: 'Returns the natural logarithm of a number.',\n    INTERCEPT: 'Calculates the point of the Y-intercept line via linear regression.',\n    SLOPE: 'Returns the slope of the line from linear regression of the data points.',\n    DefineNameExists: 'This name already exists, try different name.',\n    DefineNameInValid: 'The name that you entered is not valid.',\n    CircularReference: 'When a formula refers to one or more circular references, this may result in an incorrect calculation.',\n    ShowRowsWhere: 'Show rows where:',\n    OR: 'OR',\n    AND: 'AND',\n    CustomFilterDatePlaceHolder: 'Choose a date',\n    CustomFilterPlaceHolder: 'Enter the value',\n    CustomFilter: 'Custom Filter',\n    Between: 'Between',\n    DateTimeFilter: 'DateTime Filters',\n    Undo: 'Undo',\n    Redo: 'Redo',\n    DateFilter: 'Date Filters',\n    TextFilter: 'Text Filters',\n    NumberFilter: 'Number Filters',\n    ClearFilter: 'Clear Filter',\n    NoResult: 'No Matches Found',\n    FilterFalse: 'False',\n    FilterTrue: 'True',\n    Blanks: 'Blanks',\n    SelectAll: 'Select All',\n    GreaterThanOrEqual: 'Greater Than Or Equal',\n    GreaterThan: 'Greater Than',\n    LessThanOrEqual: 'Less Than Or Equal',\n    LessThan: 'Less Than',\n    NotEqual: 'Not Equal',\n    Equal: 'Equal',\n    Contains: 'Contains',\n    EndsWith: 'Ends With',\n    StartsWith: 'Starts With',\n    ClearButton: 'Clear',\n    FilterButton: 'Filter',\n    CancelButton: 'Cancel',\n    OKButton: 'OK',\n    Search: 'Search',\n    ProtectSheet: 'Protect Sheet',\n    UnprotectSheet: 'Unprotect Sheet',\n    LockCells: 'Lock Cells',\n    SelectCells: 'Select cells',\n    FormatCells: 'Format cells',\n    FormatRows: 'Format rows',\n    FormatColumns: 'Format columns',\n    InsertLinks: 'Insert links',\n    ProtectContent: 'Protect the contents of locked cells',\n    ProtectAllowUser: ' Allow all users of this worksheet to:',\n    EditAlert: 'The cell you\\'re trying to change is protected. To make change, unprotect the sheet.',\n    SearchWithin: 'Search within',\n    SearchBy: 'Search by',\n    Reference: 'Reference',\n    DataValidation: 'Data Validation',\n    CLEARALL: 'CLEAR ALL',\n    APPLY: 'APPLY',\n    CellRange: 'Cell Range',\n    Allow: 'Allow',\n    Data: 'Data',\n    Minimum: 'Minimum',\n    Maximum: 'Maximum',\n    IgnoreBlank: 'Ignore blank',\n    WholeNumber: 'Whole Number',\n    Decimal: 'Decimal',\n    Date: 'Date',\n    TextLength: 'Text Length',\n    List: 'List',\n    NotBetween: 'Not between',\n    EqualTo: 'Equal to',\n    NotEqualTo: 'Not equal to',\n    Greaterthan: 'Greater than',\n    Lessthan: 'Less than',\n    GreaterThanOrEqualTo: 'Greater than or equal to',\n    LessThanOrEqualTo: 'Less than or equal to',\n    InCellDropDown: 'In-cell-dropdown',\n    Sources: 'Sources',\n    Value: 'Value',\n    Retry: 'Retry',\n    EnterValue: 'Enter value',\n    DialogError: 'The list source must be a reference to single row or column.',\n    ListLengthError: 'The list values allows only upto 256 charcters',\n    ValidationError: 'This value doesn' + '\\'' + 't match the data validation restrictions defined for the cell.',\n    EmptyError: 'You must enter a value',\n    ClearHighlight: 'Clear Highlight',\n    HighlightInvalidData: 'Highlight Invalid Data',\n    ClearValidation: 'Clear Validation',\n    HighlightCellsRules: 'Highlight Cells Rules',\n    CFEqualTo: 'Equal To',\n    TextThatContains: 'Text that Contains',\n    ADateOccuring: 'A Date Occuring',\n    DuplicateValues: 'Duplicate Values',\n    TopBottomRules: 'Top/Bottom Rules',\n    Top10Items: 'Top 10 Items',\n    Top10: 'Top 10',\n    Bottom10Items: 'Bottom 10 Items',\n    Bottom10: 'Bottom 10',\n    AboveAverage: 'Above Average',\n    BelowAverage: 'Below Average',\n    FormatCellsGreaterThan: 'Format cells that are GREATER THAN:',\n    FormatCellsLessThan: 'Format cells that are LESS THAN:',\n    FormatCellsBetween: 'Format cells that are BETWEEN:',\n    FormatCellsEqualTo: 'Format cells that are EQUAL TO:',\n    FormatCellsThatContainTheText: 'Format cells that contain the text:',\n    FormatCellsThatContainADateOccurring: 'Format cells that contain a date occurring:',\n    FormatCellsDuplicate: 'Format cells that contain:',\n    FormatCellsTop: 'Format cells that rank in the TOP:',\n    FormatCellsBottom: 'Format cells that rank in the BOTTOM:',\n    FormatCellsAbove: 'Format cells that are ABOVE AVERAGE:',\n    FormatCellsBelow: 'Format cells that are BELOW AVERAGE:',\n    With: 'with',\n    DataBars: 'Data Bars',\n    ColorScales: 'Color Scales',\n    IconSets: 'Icon Sets',\n    ClearRules: 'Clear Rules',\n    SelectedCells: 'Clear Rules from Selected Cells',\n    EntireSheet: 'Clear Rules from Entire Sheet',\n    ISNUMBER: 'Returns true when the value parses as a numeric value.',\n    ROUND: 'Rounds a number to a specified number of digits.',\n    GEOMEAN: 'Returns the geometric mean of an array or range of positive data.',\n    POWER: 'Returns the result of a number raised to power',\n    LOG: 'Returns the logarithm of a number to the base that you specify.',\n    TRUNC: 'Returns the truncated value of a number to a specified number of decimal places.',\n    EXP: 'Returns e raised to the power of the given number.',\n    Clear: 'Clear',\n    ClearContents: 'Clear Contents',\n    ClearAll: 'Clear All',\n    ClearFormats: 'Clear Formats',\n    ClearHyperlinks: 'Clear Hyperlinks',\n    LightRedFillWithDarkRedText: 'Light Red Fill with Dark Red Text',\n    YellowFillWithDarkYellowText: 'Yellow Fill with Dark Yellow Text',\n    GreenFillWithDarkGreenText: 'Green Fill with Dark Green Text',\n    RedFill: 'Red Fill',\n    RedText: 'Red Text',\n    Duplicate: 'Duplicate',\n    Unique: 'Unique',\n    And: 'and',\n    WebPage: 'WEB PAGE',\n    ThisDocument: 'THIS DOCUMENT',\n    DisplayText: 'Display Text',\n    Url: 'URL',\n    CellReference: 'Cell Reference',\n    DefinedNames: 'Defined Names',\n    EnterTheTextToDisplay: 'Enter the text to display',\n    EnterTheUrl: 'Enter the URL',\n    Image: 'Image',\n    ConditionalFormatting: 'Conditional Formatting',\n    BlueDataBar: 'Blue Data Bar',\n    GreenDataBar: 'Green Data Bar',\n    RedDataBar: 'Red Data Bar',\n    OrangeDataBar: 'Orange Data Bar',\n    LightblueDataBar: 'Light blue Data Bar',\n    PurpleDataBar: 'Purple Data Bar',\n    GYRColorScale: 'Green - Yellow - Red Color Scale',\n    RYGColorScale: 'Red - Yellow - Green Color Scale',\n    GWRColorScale: 'Green - White - Red Color Scale',\n    RWGColorScale: 'Red - White - Green Color Scale',\n    BWRColorScale: 'Blue - White - Red Color Scale',\n    RWBColorScale: 'Red - White - Blue Color Scale',\n    WRColorScale: 'White - Red Color Scale',\n    RWColorScale: 'Red - White Color Scale',\n    GWColorScale: 'Green - White Color Scale',\n    WGColorScale: 'White - Green Color Scale',\n    GYColorScale: 'Green - Yellow Color Scale',\n    YGColorScale: 'Yellow - Green Color Scale',\n    ThreeArrowsColor: '3 Arrows (Colored)',\n    ThreeArrowsGray: '3 Arrows (Gray)',\n    ThreeTriangles: '3 Triangles',\n    FourArrowsColor: '4 Arrows (Gray)',\n    FourArrowsGray: '4 Arrows (Colored)',\n    FiveArrowsColor: '5 Arrows (Gray)',\n    FiveArrowsGray: '5 Arrows (Colored)',\n    ThreeTrafficLights1: '3 Traffic Lights (Unrimmed)',\n    ThreeTrafficLights2: '3 Traffic Lights (Rimmed)',\n    ThreeSigns: '3 Signs',\n    FourTrafficLights: '4 Traffic Lights',\n    RedToBlack: 'Red To Black',\n    ThreeSymbols1: '3 Symbols (Circled)',\n    ThreeSymbols2: '3 Symbols (Uncircled)',\n    ThreeFlags: '3 Flags',\n    ThreeStars: '3 Stars',\n    FourRatings: '4 Ratings',\n    FiveQuarters: '5 Quarters',\n    FiveRatings: '5 Ratings',\n    FiveBoxes: '5 Boxes',\n    Chart: 'Chart',\n    Column: 'Column',\n    Bar: 'Bar',\n    Area: 'Area',\n    Pie: 'Pie',\n    Doughnut: 'Doughnut',\n    PieAndDoughnut: 'Pie/Doughnut',\n    Line: 'Line',\n    Radar: 'Radar',\n    Scatter: 'Scatter',\n    ChartDesign: 'Chart Design',\n    ClusteredColumn: 'Clustered Column',\n    StackedColumn: 'Stacked Column',\n    StackedColumn100: '100% Stacked Column',\n    ClusteredBar: 'Clustered Bar',\n    StackedBar: 'Stacked Bar',\n    StackedBar100: '100% Stacked Bar',\n    StackedArea: 'Stacked Area',\n    StackedArea100: '100% Stacked Area',\n    StackedLine: 'Stacked Line',\n    StackedLine100: '100% Stacked Line',\n};\n","import { formatUnit, detach, attributes, isNullOrUndefined } from '@syncfusion/ej2-base';\nimport { getRangeIndexes } from './../../workbook/common/address';\nimport { getColumnWidth, isHiddenCol } from '../../workbook/base/column';\nimport { contentLoaded, editOperation, getUpdateUsingRaf, removeAllChildren } from '../common/index';\nimport { beforeContentLoaded, getColGroupWidth, virtualContentLoaded, setAriaOptions, dataBound } from '../common/index';\nimport { beforeHeaderLoaded, created, spreadsheetDestroyed, skipHiddenIdx, isReact } from '../common/index';\nimport { checkMerge, forRefSelRender, initiateEdit, chartRangeSelection, renderReactTemplates } from '../common/index';\nimport { getCell, isHiddenRow } from '../../workbook/index';\n/**\n * Sheet module is used to render Sheet\n * @hidden\n */\nvar SheetRender = /** @class */ (function () {\n    function SheetRender(parent) {\n        this.freezePane = false;\n        this.colGroupWidth = 30; //Row header and selectall table colgroup width\n        this.parent = parent;\n        this.col = parent.createElement('col');\n        this.rowRenderer = parent.serviceLocator.getService('row');\n        this.cellRenderer = parent.serviceLocator.getService('cell');\n        this.addEventListener();\n    }\n    SheetRender.prototype.refreshSelectALLContent = function () {\n        var cell;\n        if (this.freezePane) {\n            var tHead = this.getSelectAllTable().querySelector('thead');\n            var row = this.rowRenderer.render();\n            tHead.appendChild(row);\n            cell = this.parent.createElement('th', { className: 'e-select-all-cell' });\n            row.appendChild(cell);\n        }\n        else {\n            cell = this.headerPanel.firstElementChild;\n            cell.classList.add('e-select-all-cell');\n        }\n        cell.appendChild(this.parent.createElement('button', { className: 'e-selectall e-icons',\n            id: this.parent.element.id + \"_select_all\" }));\n    };\n    SheetRender.prototype.updateLeftColGroup = function (width, rowHdr) {\n        if (width) {\n            this.colGroupWidth = width;\n        }\n        if (!rowHdr) {\n            rowHdr = this.getRowHeaderPanel();\n        }\n        var table = rowHdr.querySelector('table');\n        this.detachColGroup(table);\n        var colGrp = this.parent.createElement('colgroup');\n        var colGrpWidth = this.colGroupWidth + \"px\";\n        var col = this.col.cloneNode();\n        col.style.width = colGrpWidth;\n        colGrp.appendChild(col);\n        table.insertBefore(colGrp, table.querySelector('tbody'));\n        rowHdr.style.width = colGrpWidth;\n        if (this.freezePane) {\n            table = this.getSelectAllTable();\n            this.detachColGroup(table);\n            table.insertBefore(colGrp.cloneNode(true), table.querySelector('thead'));\n        }\n        else {\n            this.getSelectAllContent().style.width = colGrpWidth;\n        }\n        if (this.parent.getActiveSheet().showHeaders) {\n            this.getColHeaderPanel().style.width = \"calc(100% - \" + colGrpWidth + \")\";\n            this.getContentPanel().style.width = \"calc(100% - \" + colGrpWidth + \")\";\n        }\n    };\n    SheetRender.prototype.detachColGroup = function (table) {\n        var colGrp = table.querySelector('colgroup');\n        if (colGrp) {\n            detach(colGrp);\n        }\n    };\n    SheetRender.prototype.renderPanel = function () {\n        this.contentPanel = this.parent.createElement('div', { className: 'e-main-panel' });\n        var sheet = this.parent.getActiveSheet();\n        var id = this.parent.element.id;\n        if (sheet.showHeaders) {\n            this.contentPanel.appendChild(this.parent.createElement('div', { className: 'e-row-header', id: id + \"_row_header\" }));\n            this.initHeaderPanel();\n            if (this.parent.allowScrolling) {\n                this.parent.scrollModule.setPadding();\n            }\n        }\n        else {\n            this.updateHideHeaders();\n        }\n        var content = this.contentPanel.appendChild(this.parent.createElement('div', { className: 'e-sheet-content', id: id + \"_main_content\" }));\n        if (!sheet.showGridLines) {\n            content.classList.add('e-hide-gridlines');\n        }\n        if (!this.parent.allowScrolling) {\n            content.style.overflow = 'hidden';\n        }\n    };\n    SheetRender.prototype.initHeaderPanel = function () {\n        var id = this.parent.element.id;\n        this.headerPanel = this.parent.createElement('div', { className: 'e-header-panel' });\n        this.headerPanel.appendChild(this.parent.createElement('div', { className: 'e-selectall-container', id: id + \"_selectall\" }));\n        this.headerPanel.appendChild(this.parent.createElement('div', { className: 'e-column-header', id: id + \"_col_header\" }));\n    };\n    SheetRender.prototype.createTable = function () {\n        if (this.parent.getActiveSheet().showHeaders) {\n            this.createHeaderTable();\n        }\n        this.updateTable('tbody', 'content', this.contentPanel.lastElementChild);\n    };\n    SheetRender.prototype.createHeaderTable = function (rowHdrEle) {\n        if (rowHdrEle === void 0) { rowHdrEle = this.contentPanel.querySelector('.e-row-header'); }\n        if (this.freezePane) {\n            this.updateTable('thead', 'selectall', this.headerPanel.querySelector('.e-selectall-container'));\n        }\n        this.updateTable('thead', 'colhdr', this.headerPanel.querySelector('.e-column-header'));\n        this.updateTable('tbody', 'rowhdr', rowHdrEle);\n        this.updateLeftColGroup(null, rowHdrEle);\n    };\n    SheetRender.prototype.updateTable = function (tagName, name, appendTo) {\n        var table = this.parent.createElement('table', { className: 'e-table', attrs: { 'role': 'grid' } });\n        table.classList.add(\"e-\" + name + \"-table\");\n        appendTo.appendChild(table);\n        table.appendChild(this.parent.createElement(tagName));\n    };\n    /**\n     * It is used to refresh the select all, row header, column header and content of the spreadsheet.\n     */\n    SheetRender.prototype.renderTable = function (args) {\n        var _this = this;\n        var indexes;\n        var row;\n        var hRow;\n        var sheet = this.parent.getActiveSheet();\n        var frag = document.createDocumentFragment();\n        this.createTable();\n        var colGrp = this.parent.createElement('colgroup');\n        var cTBody = this.contentPanel.querySelector('.e-sheet-content tbody');\n        var rHdrTBody;\n        var cHdrTHead;\n        var cHdrRow;\n        if (sheet.showHeaders) {\n            frag.appendChild(this.headerPanel);\n            this.refreshSelectALLContent();\n            rHdrTBody = this.contentPanel.querySelector('.e-row-header tbody');\n            cHdrTHead = this.headerPanel.querySelector('.e-column-header thead');\n            this.getColHeaderTable().insertBefore(colGrp, cHdrTHead);\n            cHdrRow = this.rowRenderer.render();\n            cHdrTHead.appendChild(cHdrRow);\n        }\n        frag.appendChild(this.contentPanel);\n        this.parent.notify(beforeContentLoaded, { startColIdx: args.indexes[1] });\n        var colCount = sheet.colCount.toString();\n        var rowCount = sheet.colCount.toString();\n        var layout = args.top && args.left ? 'RowColumn' : (args.top ? 'Row' : (args.left ? 'Column' : ''));\n        if (sheet.showHeaders) {\n            this.parent.getColHeaderTable().setAttribute('aria-colcount', colCount);\n            this.parent.getRowHeaderTable().setAttribute('aria-rowcount', rowCount);\n        }\n        attributes(this.parent.getContentTable(), { 'aria-rowcount': rowCount, 'aria-colcount': colCount });\n        args.cells.forEach(function (value, key) {\n            indexes = getRangeIndexes(key);\n            if (indexes[1] === args.indexes[1]) {\n                if (sheet.showHeaders) {\n                    hRow = _this.rowRenderer.render(indexes[0], true);\n                    rHdrTBody.appendChild(hRow);\n                    hRow.appendChild(_this.cellRenderer.renderRowHeader(indexes[0]));\n                }\n                row = _this.rowRenderer.render(indexes[0]);\n                cTBody.appendChild(row);\n            }\n            row.appendChild(_this.cellRenderer.render({ colIdx: indexes[1], rowIdx: indexes[0], cell: value,\n                address: key, lastCell: indexes[1] === args.indexes[3], isHeightCheckNeeded: true, row: row, hRow: hRow,\n                pRow: row.previousSibling, pHRow: sheet.showHeaders ? hRow.previousSibling : null,\n                first: layout ? (layout.includes('Row') ? (indexes[0] === args.indexes[0] ? 'Row' : (layout.includes('Column') ? (indexes[1] === args.indexes[1] ? 'Column' : '') : '')) : (indexes[1] === args.indexes[1] ? 'Column' : '')) : '' }));\n            if (indexes[0] === args.indexes[0]) {\n                _this.updateCol(sheet, indexes[1], colGrp);\n                if (sheet.showHeaders) {\n                    cHdrRow.appendChild(_this.cellRenderer.renderColHeader(indexes[1]));\n                }\n            }\n        });\n        if (this.parent[isReact]) {\n            this.parent[renderReactTemplates]();\n        }\n        this.getContentTable().insertBefore(colGrp.cloneNode(true), cTBody);\n        getUpdateUsingRaf(function () {\n            var content = _this.parent.getMainContent();\n            document.getElementById(_this.parent.element.id + '_sheet').appendChild(frag);\n            if (args.top) {\n                content.scrollTop = args.top;\n                if (sheet.showHeaders) {\n                    _this.parent.getRowHeaderContent().scrollTop = args.top;\n                }\n            }\n            if (args.left) {\n                content.scrollLeft = args.left;\n                if (sheet.showHeaders) {\n                    _this.parent.getColumnHeaderContent().scrollLeft = args.left;\n                }\n            }\n            _this.parent.notify(contentLoaded, null);\n            _this.parent.notify(editOperation, { action: 'renderEditor' });\n            if (!args.initLoad && !_this.parent.isOpen) {\n                _this.parent.hideSpinner();\n            }\n            setAriaOptions(_this.parent.getMainContent(), { busy: false });\n            _this.parent.trigger(dataBound, {});\n            if (_this.parent.isEdit) {\n                _this.parent.notify(initiateEdit, null);\n            }\n            if (args.initLoad) {\n                var triggerEvent = true;\n                if (_this.parent.scrollSettings.enableVirtualization) {\n                    for (var i = 0; i < sheet.ranges.length; i++) {\n                        if (sheet.ranges[i].info.count - 1 > _this.parent.viewport.bottomIndex) {\n                            triggerEvent = false;\n                            break;\n                        }\n                    }\n                }\n                if (triggerEvent) {\n                    _this.triggerCreatedEvent();\n                }\n            }\n        });\n    };\n    SheetRender.prototype.triggerCreatedEvent = function () {\n        if (!this.parent.isOpen) {\n            this.parent.hideSpinner();\n        }\n        if (this.parent.createdHandler) {\n            if (this.parent.createdHandler.observers) {\n                this.parent[created].observers = this.parent.createdHandler.observers;\n            }\n            else {\n                this.parent.setProperties({ created: this.parent.createdHandler }, true);\n            }\n            this.parent.createdHandler = undefined;\n            this.parent.trigger(created, null);\n        }\n    };\n    SheetRender.prototype.refreshColumnContent = function (args) {\n        var _this = this;\n        var indexes;\n        var row;\n        var table;\n        var count = 0;\n        var cell;\n        var sheet = this.parent.getActiveSheet();\n        var frag = document.createDocumentFragment();\n        var hFrag = document.createDocumentFragment();\n        var tBody = this.parent.element.querySelector('.e-sheet-content tbody');\n        tBody = frag.appendChild(tBody.cloneNode(true));\n        var colGrp = this.parent.element.querySelector('.e-sheet-content colgroup');\n        colGrp = colGrp.cloneNode();\n        var hRow;\n        var tHead;\n        if (sheet.showHeaders) {\n            hFrag.appendChild(colGrp);\n            tHead = this.parent.element.querySelector('.e-column-header thead');\n            tHead = hFrag.appendChild(tHead.cloneNode(true));\n            hRow = tHead.querySelector('tr');\n            hRow.innerHTML = '';\n        }\n        args.cells.forEach(function (value, key) {\n            indexes = getRangeIndexes(key);\n            if (indexes[0] === args.indexes[0]) {\n                _this.updateCol(sheet, indexes[1], colGrp);\n                if (sheet.showHeaders) {\n                    hRow.appendChild(_this.cellRenderer.renderColHeader(indexes[1]));\n                }\n            }\n            if (indexes[1] === args.indexes[1]) {\n                row = tBody.children[count];\n                if (row) {\n                    row.innerHTML = '';\n                    count++;\n                }\n                else {\n                    return;\n                }\n            }\n            cell = row.appendChild(_this.cellRenderer.render({\n                colIdx: indexes[1], rowIdx: indexes[0], cell: value, address: key, row: row, pRow: row.previousSibling,\n                first: !args.skipUpdateOnFirst && indexes[1] === args.indexes[1] ? 'Column' : (_this.parent.scrollSettings.\n                    enableVirtualization && indexes[0] === args.indexes[0] && _this.parent.viewport.topIndex !== skipHiddenIdx(sheet, 0, true)\n                    ? 'Row' : '')\n            }));\n            _this.checkColMerge(indexes, args.indexes, cell, value);\n        });\n        frag.insertBefore(colGrp.cloneNode(true), tBody);\n        getUpdateUsingRaf(function () {\n            if (sheet.showHeaders) {\n                table = _this.getColHeaderTable();\n                removeAllChildren(table);\n                table.appendChild(hFrag);\n            }\n            table = _this.getContentTable();\n            removeAllChildren(table);\n            table.appendChild(frag);\n            _this.parent.notify(virtualContentLoaded, { refresh: 'Column' });\n            if (_this.parent.isEdit) {\n                _this.parent.notify(forRefSelRender, {});\n            }\n            if (_this.parent.allowChart) {\n                _this.parent.notify(chartRangeSelection, null);\n            }\n            if (!_this.parent.isOpen) {\n                _this.parent.hideSpinner();\n            }\n            setAriaOptions(_this.parent.getMainContent(), { busy: false });\n        });\n    };\n    SheetRender.prototype.refreshRowContent = function (args) {\n        var _this = this;\n        var indexes;\n        var row;\n        var hdrRow;\n        var colGroupWidth = this.colGroupWidth;\n        var sheet = this.parent.getActiveSheet();\n        var hFrag;\n        var hTBody;\n        var cell;\n        var frag = document.createDocumentFragment();\n        var tBody = this.parent.createElement('tbody');\n        if (sheet.showHeaders) {\n            hFrag = document.createDocumentFragment();\n            hTBody = tBody.cloneNode();\n            hFrag.appendChild(hTBody);\n        }\n        frag.appendChild(tBody);\n        args.cells.forEach(function (value, key) {\n            indexes = getRangeIndexes(key);\n            if (indexes[1] === args.indexes[1]) {\n                if (sheet.showHeaders) {\n                    hdrRow = _this.rowRenderer.render(indexes[0], true);\n                    hTBody.appendChild(hdrRow);\n                    hdrRow.appendChild(_this.cellRenderer.renderRowHeader(indexes[0]));\n                    colGroupWidth = getColGroupWidth(indexes[0] + 1);\n                }\n                row = _this.rowRenderer.render(indexes[0]);\n                tBody.appendChild(row);\n            }\n            cell = row.appendChild(_this.cellRenderer.render({ rowIdx: indexes[0], colIdx: indexes[1], cell: value, address: key, lastCell: indexes[1] === args.indexes[3], row: row, hRow: hdrRow, pRow: row.previousSibling, pHRow: sheet.showHeaders ?\n                    hdrRow.previousSibling : null, isHeightCheckNeeded: true, first: !args.skipUpdateOnFirst && indexes[0] === args.indexes[0] ?\n                    'Row' : (_this.parent.scrollSettings.enableVirtualization && indexes[1] === args.indexes[1] && _this.parent.viewport.leftIndex\n                    !== skipHiddenIdx(sheet, 0, true, 'columns') ? 'Column' : '') }));\n            _this.checkRowMerge(indexes, args.indexes, cell, value);\n        });\n        if (this.colGroupWidth !== colGroupWidth) {\n            this.updateLeftColGroup(colGroupWidth);\n        }\n        if (sheet.showHeaders) {\n            if (this.contentPanel.querySelector('.e-row-header tbody')) {\n                detach(this.contentPanel.querySelector('.e-row-header tbody'));\n                this.getRowHeaderTable().appendChild(hFrag);\n            }\n        }\n        if (this.contentPanel.querySelector('.e-sheet-content tbody')) {\n            detach(this.contentPanel.querySelector('.e-sheet-content tbody'));\n            this.getContentTable().appendChild(frag);\n        }\n        this.parent.notify(virtualContentLoaded, { refresh: 'Row' });\n        if (this.parent.allowChart) {\n            this.parent.notify(chartRangeSelection, {});\n        }\n        if (this.parent.isEdit) {\n            this.parent.notify(forRefSelRender, null);\n        }\n        if (!this.parent.isOpen) {\n            this.parent.hideSpinner();\n        }\n        setAriaOptions(this.parent.getMainContent(), { busy: false });\n    };\n    SheetRender.prototype.updateCol = function (sheet, idx, appendTo) {\n        var col = this.col.cloneNode();\n        col.style.width = formatUnit(getColumnWidth(sheet, idx));\n        return appendTo ? appendTo.appendChild(col) : col;\n    };\n    SheetRender.prototype.updateColContent = function (args) {\n        var _this = this;\n        getUpdateUsingRaf(function () {\n            var indexes;\n            var row;\n            var table;\n            var refChild;\n            var cell;\n            var hRow;\n            var rowCount = 0;\n            var col;\n            var hRefChild;\n            var sheet = _this.parent.getActiveSheet();\n            if (sheet.showHeaders) {\n                hRow = _this.parent.element.querySelector('.e-column-header .e-header-row');\n                hRefChild = hRow.firstElementChild;\n            }\n            var colGrp = _this.parent.element.querySelector('.e-sheet-content colgroup');\n            var colRefChild = colGrp.firstElementChild;\n            var skipRender;\n            var tBody = _this.parent.element.querySelector('.e-sheet-content tbody');\n            args.cells.forEach(function (value, key) {\n                if (skipRender) {\n                    return;\n                }\n                indexes = getRangeIndexes(key);\n                if (args.direction === 'first' && indexes[1] === args.indexes[1]) {\n                    _this.checkColMerge([indexes[0], _this.parent.viewport.leftIndex], args.indexes, (tBody.rows[rowCount] || { cells: [] }).cells[(args.indexes[3] - args.indexes[1]) + 1], getCell(indexes[0], _this.parent.viewport.leftIndex, sheet) || {});\n                }\n                if (indexes[0] === args.indexes[0]) {\n                    if (args.direction === 'last') {\n                        col = _this.col.cloneNode();\n                        col.style.width = formatUnit(getColumnWidth(sheet, indexes[1]));\n                        colGrp.insertBefore(col, colRefChild);\n                        if (sheet.showHeaders) {\n                            hRow.insertBefore(_this.cellRenderer.renderColHeader(indexes[1]), hRefChild);\n                        }\n                    }\n                    else {\n                        _this.updateCol(sheet, indexes[1], colGrp);\n                        if (sheet.showHeaders) {\n                            hRow.appendChild(_this.cellRenderer.renderColHeader(indexes[1]));\n                        }\n                    }\n                    if (_this.parent.scrollSettings.enableVirtualization && args.direction) {\n                        // tslint:disable\n                        detach(colGrp[args.direction + 'ElementChild']);\n                        if (sheet.showHeaders) {\n                            detach(hRow[args.direction + 'ElementChild']);\n                        }\n                        // tslint:enable\n                    }\n                }\n                if (indexes[1] === args.indexes[1]) {\n                    row = tBody.children[rowCount];\n                    rowCount++;\n                    if (!row) {\n                        skipRender = true;\n                        return;\n                    }\n                    refChild = row.firstElementChild;\n                }\n                cell = _this.cellRenderer.render({ colIdx: indexes[1], rowIdx: indexes[0], cell: value, address: key,\n                    lastCell: indexes[1] === args.indexes[3], isHeightCheckNeeded: args.direction === 'first',\n                    first: args.direction === 'last' && !args.skipUpdateOnFirst && indexes[1] === args.indexes[1] ? 'Column' : '',\n                    checkNextBorder: args.direction === 'last' && indexes[3] === args.indexes[3] ? 'Column' : '', });\n                if (args.direction === 'last') {\n                    _this.checkColMerge(indexes, args.indexes, cell, value, (tBody.rows[rowCount - 1] || { cells: [] }).cells[0]);\n                    row.insertBefore(cell, refChild);\n                }\n                else {\n                    row.appendChild(cell);\n                }\n                if (_this.parent.scrollSettings.enableVirtualization && args.direction) {\n                    // tslint:disable-next-line:no-any\n                    detach(row[args.direction + 'ElementChild']);\n                }\n            });\n            if (sheet.showHeaders) {\n                table = _this.getColHeaderTable();\n                detach(table.querySelector('colgroup'));\n                table.insertBefore(colGrp.cloneNode(true), table.querySelector('thead'));\n            }\n            if (_this.parent.scrollSettings.enableVirtualization) {\n                _this.parent.notify(virtualContentLoaded, { refresh: 'Column' });\n            }\n            if (_this.parent.allowChart) {\n                _this.parent.notify(chartRangeSelection, null);\n            }\n            if (_this.parent.isEdit) {\n                _this.parent.notify(forRefSelRender, {});\n            }\n            if (!_this.parent.isOpen) {\n                _this.parent.hideSpinner();\n            }\n            setAriaOptions(_this.parent.getMainContent(), { busy: false });\n        });\n    };\n    SheetRender.prototype.updateRowContent = function (args) {\n        var _this = this;\n        var colGroupWidth = this.colGroupWidth;\n        var row;\n        var hRow;\n        var cell;\n        var sheet = this.parent.getActiveSheet();\n        var cellModel;\n        var count = 0;\n        var tBody = this.parent.getMainContent().querySelector('tbody');\n        var rTBody;\n        var rFrag;\n        var index;\n        if (sheet.showHeaders) {\n            rFrag = document.createDocumentFragment();\n            rTBody = this.parent.getRowHeaderContent().querySelector('tbody');\n        }\n        var indexes;\n        var frag = document.createDocumentFragment();\n        this.parent.showSpinner();\n        args.cells.forEach(function (value, cKey) {\n            indexes = getRangeIndexes(cKey);\n            if (args.direction === 'first' && indexes[0] === args.indexes[0]) {\n                _this.checkRowMerge([_this.parent.viewport.topIndex, indexes[1]], args.indexes, (tBody.rows[(args.indexes[2] - args.indexes[0]) + 1] || { cells: [] }).cells[count], getCell(_this.parent.viewport.topIndex, indexes[1], sheet) || {});\n            }\n            if (indexes[1] === args.indexes[1]) {\n                if (sheet.showHeaders) {\n                    hRow = _this.rowRenderer.render(indexes[0], true);\n                    rFrag.appendChild(hRow);\n                    hRow.appendChild(_this.cellRenderer.renderRowHeader(indexes[0]));\n                    colGroupWidth = getColGroupWidth(indexes[0] + 1);\n                    if (_this.parent.scrollSettings.enableVirtualization && args.direction) {\n                        // tslint:disable-next-line:no-any\n                        detach(rTBody[args.direction + 'ElementChild']);\n                    }\n                }\n                row = _this.rowRenderer.render(indexes[0]);\n                frag.appendChild(row);\n                if (_this.parent.scrollSettings.enableVirtualization && args.direction) {\n                    // tslint:disable-next-line:no-any\n                    detach(tBody[args.direction + 'ElementChild']);\n                }\n            }\n            cell = row.appendChild(_this.cellRenderer.render({ colIdx: indexes[1], rowIdx: indexes[2], cell: value, address: cKey, lastCell: indexes[1] === args.indexes[3], row: row, pHRow: sheet.showHeaders ? hRow.previousSibling : null,\n                checkNextBorder: args.direction === 'last' && indexes[2] === args.indexes[2] ? 'Row' : '', pRow: row.previousSibling,\n                isHeightCheckNeeded: args.direction === 'first' || args.direction === '', hRow: hRow, first: args.direction === 'last' &&\n                    !args.skipUpdateOnFirst && indexes[0] === args.indexes[0] ? 'Row' : '' }));\n            if (args.direction === 'last') {\n                _this.checkRowMerge(indexes, args.indexes, cell, value, tBody.rows[0].cells[count]);\n            }\n            count++;\n        });\n        if (this.colGroupWidth !== colGroupWidth) {\n            this.updateLeftColGroup(colGroupWidth);\n        }\n        if (args.direction === 'last') {\n            if (sheet.showHeaders) {\n                rTBody.insertBefore(rFrag, rTBody.firstElementChild);\n            }\n            tBody.insertBefore(frag, tBody.firstElementChild);\n        }\n        else {\n            if (sheet.showHeaders) {\n                rTBody.appendChild(rFrag);\n            }\n            tBody.appendChild(frag);\n        }\n        if (this.parent.scrollSettings.enableVirtualization) {\n            this.parent.notify(virtualContentLoaded, { refresh: 'Row' });\n        }\n        if (this.parent.isEdit) {\n            this.parent.notify(forRefSelRender, null);\n        }\n        if (this.parent.allowChart) {\n            this.parent.notify(chartRangeSelection, {});\n        }\n        if (!this.parent.isOpen) {\n            this.parent.hideSpinner();\n        }\n        setAriaOptions(this.parent.getMainContent(), { busy: false });\n    };\n    SheetRender.prototype.checkRowMerge = function (indexes, range, cell, model, firstcell) {\n        if (this.parent.scrollSettings.enableVirtualization && cell &&\n            (!isNullOrUndefined(model.rowSpan) || !isNullOrUndefined(model.colSpan))) {\n            if (indexes[0] === this.parent.viewport.topIndex) {\n                if (model.rowSpan < 0) {\n                    this.parent.notify(checkMerge, { td: cell, rowIdx: indexes[0], colIdx: indexes[1], isRow: true });\n                    if (this.parent.viewport.topIndex >= range[0]) {\n                        this.refreshPrevMerge(range[0] + 1, indexes[1]);\n                    }\n                }\n                if (firstcell && (firstcell.colSpan || firstcell.rowSpan)) {\n                    this.cellRenderer.refresh(indexes[0] + (range[2] - range[0]) + 1, indexes[1], null, firstcell);\n                }\n            }\n            else if (model.rowSpan > 1) {\n                var prevTopIdx = range[2] + 1;\n                if (indexes[0] + model.rowSpan - 1 > prevTopIdx && indexes[0] < prevTopIdx) {\n                    this.refreshPrevMerge(prevTopIdx, indexes[1], this.parent.viewport.topIndex);\n                }\n            }\n        }\n    };\n    SheetRender.prototype.refreshPrevMerge = function (prevTopIdx, colIndex, currTopIdx) {\n        var td = this.parent.getCell(prevTopIdx, colIndex, this.parent.getRow(currTopIdx ? currTopIdx : 0));\n        if (td && td.rowSpan > 1) {\n            this.cellRenderer.refresh(prevTopIdx, colIndex, null, td);\n        }\n    };\n    SheetRender.prototype.checkColMerge = function (indexes, range, cell, model, firstcell) {\n        if (this.parent.scrollSettings.enableVirtualization && cell && indexes[1] === this.parent.viewport.leftIndex &&\n            (!isNullOrUndefined(model.rowSpan) || !isNullOrUndefined(model.colSpan))) {\n            if (model.colSpan < 0) {\n                this.parent.notify(checkMerge, { td: cell, colIdx: indexes[1], rowIdx: indexes[0] });\n            }\n            if (firstcell && (firstcell.colSpan || firstcell.rowSpan)) {\n                this.cellRenderer.refresh(indexes[0], indexes[1] + (range[3] - range[1]) + 1, null, firstcell);\n            }\n        }\n    };\n    /**\n     * Used to toggle row and column headers.\n     */\n    SheetRender.prototype.showHideHeaders = function () {\n        var _this = this;\n        var sheet = this.parent.getActiveSheet();\n        if (sheet.showHeaders) {\n            if (this.parent.scrollSettings.enableVirtualization) {\n                var indexes = [this.parent.viewport.topIndex, this.parent.viewport.leftIndex,\n                    this.parent.viewport.bottomIndex, this.parent.viewport.rightIndex];\n                this.renderHeaders([indexes[0], indexes[2]], [indexes[1], indexes[3]]);\n            }\n            else {\n                this.renderHeaders([0, sheet.rowCount - 1], [0, sheet.colCount - 1]);\n                if (sheet.topLeftCell !== 'A1') {\n                    this.parent.goTo(sheet.topLeftCell);\n                }\n            }\n        }\n        else {\n            getUpdateUsingRaf(function () {\n                detach(_this.headerPanel);\n                detach(_this.getRowHeaderPanel());\n                _this.getContentPanel().style.width = '';\n                _this.updateHideHeaders();\n            });\n        }\n    };\n    SheetRender.prototype.renderHeaders = function (rowIndexes, colIndexes) {\n        var _this = this;\n        var sheet = this.parent.getActiveSheet();\n        this.initHeaderPanel();\n        var cFrag = document.createDocumentFragment();\n        var rFrag = document.createDocumentFragment();\n        cFrag.appendChild(this.headerPanel);\n        var rowHdrEle = rFrag.appendChild(this.parent.createElement('div', { className: 'e-row-header', id: this.parent.element.id + \"_row_header\" }));\n        this.createHeaderTable(rowHdrEle);\n        this.parent.notify(beforeHeaderLoaded, { element: rowHdrEle });\n        this.refreshSelectALLContent();\n        var rTBody = rowHdrEle.querySelector('tbody');\n        var cTHead = this.headerPanel.querySelector('.e-column-header thead');\n        var cRow = this.rowRenderer.render();\n        cTHead.appendChild(cRow);\n        var row;\n        for (var i = colIndexes[0]; i <= colIndexes[1]; i++) {\n            if (!isHiddenCol(sheet, i)) {\n                cRow.appendChild(this.cellRenderer.renderColHeader(i));\n            }\n        }\n        var colGroupWidth = getColGroupWidth(rowIndexes[1]);\n        if (this.colGroupWidth !== colGroupWidth) {\n            this.updateLeftColGroup(colGroupWidth, rowHdrEle);\n        }\n        for (var i = rowIndexes[0]; i <= rowIndexes[1]; i++) {\n            if (!isHiddenRow(sheet, i)) {\n                row = this.rowRenderer.render(i, true);\n                row.appendChild(this.cellRenderer.renderRowHeader(i));\n                rTBody.appendChild(row);\n            }\n        }\n        getUpdateUsingRaf(function () {\n            _this.getColHeaderTable().insertBefore(_this.getContentTable().querySelector('colgroup').cloneNode(true), cTHead);\n            var sheet = document.getElementById(_this.parent.element.id + '_sheet');\n            sheet.classList.remove('e-hide-headers');\n            sheet.insertBefore(cFrag, _this.contentPanel);\n            var content = _this.getContentPanel();\n            _this.contentPanel.insertBefore(rFrag, content);\n            _this.parent.scrollModule.setPadding();\n            rowHdrEle.scrollTop = content.scrollTop;\n            _this.getColHeaderPanel().scrollLeft = content.scrollLeft;\n        });\n    };\n    SheetRender.prototype.updateHideHeaders = function () {\n        document.getElementById(this.parent.element.id + '_sheet').classList.add('e-hide-headers');\n        this.headerPanel = null;\n    };\n    /**\n     * Get the select all table element of spreadsheet\n     * @return {HTMLElement}\n     */\n    SheetRender.prototype.getSelectAllContent = function () {\n        return this.headerPanel.getElementsByClassName('e-selectall-container')[0];\n    };\n    /**\n     * Get the select all table element of spreadsheet\n     * @return {Element}\n     */\n    SheetRender.prototype.getSelectAllTable = function () {\n        return this.headerPanel.getElementsByClassName('e-selectall-table')[0];\n    };\n    /**\n     * Get the column header element of spreadsheet\n     * @return {HTMLTableElement}\n     */\n    SheetRender.prototype.getColHeaderTable = function () {\n        return this.headerPanel.getElementsByClassName('e-colhdr-table')[0];\n    };\n    /**\n     * Get the row header table element of spreadsheet\n     * @return {HTMLTableElement}\n     */\n    SheetRender.prototype.getRowHeaderTable = function () {\n        return this.contentPanel.getElementsByClassName('e-rowhdr-table')[0];\n    };\n    /**\n     * Get the main content table element of spreadsheet\n     * @return {Element}\n     */\n    SheetRender.prototype.getContentTable = function () {\n        return this.contentPanel.getElementsByClassName('e-content-table')[0];\n    };\n    /**\n     * Get the row header div element of spreadsheet\n     * @return {Element}\n     */\n    SheetRender.prototype.getRowHeaderPanel = function () {\n        return this.contentPanel.getElementsByClassName('e-row-header')[0];\n    };\n    /**\n     * Get the column header div element of spreadsheet\n     * @return {Element}\n     */\n    SheetRender.prototype.getColHeaderPanel = function () {\n        return this.headerPanel.getElementsByClassName('e-column-header')[0];\n    };\n    /**\n     * Get the main content div element of spreadsheet\n     * @return {Element}\n     */\n    SheetRender.prototype.getContentPanel = function () {\n        return this.contentPanel.getElementsByClassName('e-sheet-content')[0];\n    };\n    SheetRender.prototype.addEventListener = function () {\n        this.parent.on(created, this.triggerCreatedEvent, this);\n        this.parent.on(spreadsheetDestroyed, this.destroy, this);\n    };\n    SheetRender.prototype.destroy = function () {\n        this.removeEventListener();\n        this.parent = null;\n    };\n    SheetRender.prototype.removeEventListener = function () {\n        this.parent.off(created, this.triggerCreatedEvent);\n        this.parent.off(spreadsheetDestroyed, this.destroy);\n    };\n    return SheetRender;\n}());\nexport { SheetRender };\n","import { skipHiddenIdx } from '../common/index';\nimport { getRowHeight, getCell, isHiddenRow } from '../../workbook/base/index';\nimport { attributes } from '@syncfusion/ej2-base';\nimport { getCellAddress } from '../../workbook/common/index';\n/**\n * Sheet module is used for creating row element\n * @hidden\n */\nvar RowRenderer = /** @class */ (function () {\n    function RowRenderer(parent) {\n        this.parent = parent;\n        this.element = this.parent.createElement('tr', { attrs: { 'role': 'row' } });\n        this.cellRenderer = parent.serviceLocator.getService('cell');\n    }\n    RowRenderer.prototype.render = function (index, isRowHeader, skipHidden) {\n        var row = this.element.cloneNode();\n        if (index === undefined) {\n            row.classList.add('e-header-row');\n            return row;\n        }\n        row.classList.add('e-row');\n        var sheet = this.parent.getActiveSheet();\n        attributes(row, { 'aria-rowindex': (index + 1).toString() });\n        row.style.height = getRowHeight(sheet, index) + \"px\";\n        if (isRowHeader && !skipHidden) {\n            if (isHiddenRow(sheet, index + 1) && !isHiddenRow(sheet, index - 1)) {\n                row.classList.add('e-hide-start');\n            }\n            if (index !== 0 && isHiddenRow(sheet, index - 1) && !isHiddenRow(sheet, index + 1)) {\n                row.classList.add('e-hide-end');\n            }\n        }\n        return row;\n    };\n    RowRenderer.prototype.refresh = function (index, pRow, hRow, header) {\n        var row;\n        var sheet = this.parent.getActiveSheet();\n        if (header) {\n            row = this.render(index, true, true);\n            row.appendChild(this.cellRenderer.renderRowHeader(index));\n        }\n        else {\n            row = this.render(index);\n            var len = this.parent.viewport.leftIndex + this.parent.viewport.colCount + (this.parent.getThreshold('col') * 2);\n            for (var i = this.parent.viewport.leftIndex; i <= len; i++) {\n                row.appendChild(this.cellRenderer.render({ colIdx: i, rowIdx: index, cell: getCell(index, i, sheet),\n                    address: getCellAddress(index, i), lastCell: i === len, row: row, hRow: hRow, isHeightCheckNeeded: true, pRow: pRow,\n                    first: index === this.parent.viewport.topIndex && skipHiddenIdx(sheet, index, true) !== skipHiddenIdx(sheet, 0, true) ?\n                        'Row' : '' }));\n            }\n        }\n        return row;\n    };\n    return RowRenderer;\n}());\nexport { RowRenderer };\n","import { inView, renderFilterCell, checkConditionalFormat } from '../common/index';\nimport { hasTemplate, createHyperlinkElement, checkPrevMerge, createImageElement } from '../common/index';\nimport { getColumnHeaderText, getRangeIndexes, getRangeAddress } from '../../workbook/common/index';\nimport { setChart, refreshChart, getCellAddress } from '../../workbook/common/index';\nimport { getCell, skipDefaultValue, isHiddenRow, isHiddenCol } from '../../workbook/base/index';\nimport { getRowHeight, setRowHeight } from '../../workbook/base/index';\nimport { addClass, attributes, getNumberDependable, extend, compile, isNullOrUndefined } from '@syncfusion/ej2-base';\nimport { getFormattedCellObject, applyCellFormat, workbookFormulaOperation, wrapEvent, cFRender } from '../../workbook/common/event';\nimport { getTypeFromFormat } from '../../workbook/index';\nimport { checkIsFormula } from '../../workbook/common/util';\n/**\n * CellRenderer class which responsible for building cell content.\n * @hidden\n */\nvar CellRenderer = /** @class */ (function () {\n    function CellRenderer(parent) {\n        this.parent = parent;\n        this.element = this.parent.createElement('td');\n        this.th = this.parent.createElement('th', { className: 'e-header-cell' });\n        this.tableRow = parent.createElement('tr', { className: 'e-row' });\n        this.parent.on('updateView', this.updateView, this);\n    }\n    CellRenderer.prototype.renderColHeader = function (index) {\n        var headerCell = this.th.cloneNode();\n        attributes(headerCell, { 'role': 'columnheader', 'aria-colindex': (index + 1).toString(), 'tabindex': '-1' });\n        headerCell.innerHTML = getColumnHeaderText(index + 1);\n        var sheet = this.parent.getActiveSheet();\n        if (isHiddenCol(sheet, index + 1)) {\n            headerCell.classList.add('e-hide-start');\n        }\n        if (index !== 0 && isHiddenCol(sheet, index - 1)) {\n            headerCell.classList.add('e-hide-end');\n        }\n        return headerCell;\n    };\n    CellRenderer.prototype.renderRowHeader = function (index) {\n        var headerCell = this.element.cloneNode();\n        addClass([headerCell], 'e-header-cell');\n        attributes(headerCell, { 'role': 'rowheader', 'tabindex': '-1' });\n        headerCell.innerHTML = (index + 1).toString();\n        return headerCell;\n    };\n    CellRenderer.prototype.render = function (args) {\n        args.td = this.element.cloneNode();\n        args.td.className = 'e-cell';\n        attributes(args.td, { 'role': 'gridcell', 'aria-colindex': (args.colIdx + 1).toString(), 'tabindex': '-1' });\n        var sheet = this.parent.getActiveSheet();\n        if (this.checkMerged(args)) {\n            return args.td;\n        }\n        var compiledTemplate = this.processTemplates(args.cell, args.rowIdx, args.colIdx);\n        if (typeof compiledTemplate === 'string') {\n            args.td.innerHTML = compiledTemplate;\n        }\n        else {\n            args.td.appendChild(compiledTemplate);\n        }\n        args.isRefresh = false;\n        this.update(args);\n        if (args.cell && args.td) {\n            this.parent.notify(cFRender, { rowIdx: args.rowIdx, colIdx: args.colIdx, cell: args.cell, td: args.td, isChecked: false });\n            if (args.td && args.td.children[0] && args.td.children[0].className === 'e-cf-databar') {\n                if (args.cell.style && args.cell.style.fontSize) {\n                    args.td.children[0].querySelector('.e-databar-value').style.fontSize = args.cell.style.fontSize;\n                }\n                args.td.children[0].style.height = '100%';\n                args.td.children[0].firstElementChild.nextElementSibling.style.height = '100%';\n            }\n        }\n        if (!hasTemplate(this.parent, args.rowIdx, args.colIdx, this.parent.activeSheetIndex)) {\n            this.parent.notify(renderFilterCell, { td: args.td, rowIndex: args.rowIdx, colIndex: args.colIdx });\n        }\n        var evtArgs = { cell: args.cell, element: args.td, address: args.address };\n        this.parent.trigger('beforeCellRender', evtArgs);\n        this.updateRowHeight({\n            rowIdx: args.rowIdx,\n            cell: evtArgs.element,\n            lastCell: args.lastCell,\n            rowHgt: 20,\n            row: args.row,\n            hRow: args.hRow\n        });\n        var isWrap = args.td.classList.contains('e-wraptext');\n        var cellValue = args.td.innerHTML;\n        if (cellValue.indexOf('\\n') > -1 && !isWrap) {\n            var splitVal = cellValue.split('\\n');\n            if (splitVal.length > 1) {\n                this.parent.notify(wrapEvent, {\n                    range: [args.rowIdx, args.colIdx, args.rowIdx, args.colIdx], wrap: true, initial: true, sheet: this.parent.getActiveSheet(), td: args.td, row: args.row, hRow: args.hRow\n                });\n            }\n        }\n        return evtArgs.element;\n    };\n    // tslint:disable-next-line:max-func-body-length\n    CellRenderer.prototype.update = function (args) {\n        if (args.isRefresh) {\n            if (args.td.rowSpan) {\n                args.td.removeAttribute('rowSpan');\n            }\n            if (args.td.colSpan) {\n                args.td.removeAttribute('colSpan');\n            }\n            if (this.checkMerged(args)) {\n                return;\n            }\n        }\n        if (args.cell && args.cell.formula && !args.cell.value) {\n            var isFormula = checkIsFormula(args.cell.formula);\n            var eventArgs = {\n                action: 'refreshCalculate', value: args.cell.formula, rowIndex: args.rowIdx, colIndex: args.colIdx, isFormula: isFormula\n            };\n            this.parent.notify(workbookFormulaOperation, eventArgs);\n            args.cell.value = getCell(args.rowIdx, args.colIdx, this.parent.getActiveSheet()).value;\n        }\n        var formatArgs = {\n            type: args.cell && getTypeFromFormat(args.cell.format),\n            value: args.cell && args.cell.value, format: args.cell && args.cell.format ? args.cell.format : 'General',\n            formattedText: args.cell && args.cell.value, onLoad: true, isRightAlign: false, cell: args.cell,\n            rowIdx: args.rowIdx.toString(), colIdx: args.colIdx.toString()\n        };\n        if (args.cell) {\n            this.parent.notify(getFormattedCellObject, formatArgs);\n        }\n        if (!isNullOrUndefined(args.td)) {\n            this.parent.refreshNode(args.td, { type: formatArgs.type, result: formatArgs.formattedText,\n                curSymbol: getNumberDependable(this.parent.locale, 'USD'), isRightAlign: formatArgs.isRightAlign,\n                value: formatArgs.value || ''\n            });\n        }\n        var style = {};\n        if (args.cell) {\n            if (args.cell.style) {\n                if (args.cell.style.properties) {\n                    style = skipDefaultValue(args.cell.style, true);\n                }\n                else {\n                    style = args.cell.style;\n                }\n            }\n            if (args.cell.chart && args.cell.chart.length > 0) {\n                this.parent.notify(setChart, { chart: args.cell.chart, isInitCell: true, range: getCellAddress(args.rowIdx, args.colIdx) });\n            }\n            if (args.cell.hyperlink) {\n                this.parent.notify(createHyperlinkElement, { cell: args.cell, td: args.td, rowIdx: args.rowIdx, colIdx: args.colIdx });\n            }\n            if (args.cell.wrap) {\n                this.parent.notify(wrapEvent, {\n                    range: [args.rowIdx, args.colIdx, args.rowIdx, args.colIdx], wrap: true, sheet: this.parent.getActiveSheet(), initial: true, td: args.td, row: args.row, hRow: args.hRow\n                });\n            }\n            if (args.cell.rowSpan > 1) {\n                var rowSpan = args.cell.rowSpan - this.parent.hiddenCount(args.rowIdx, args.rowIdx + (args.cell.rowSpan - 1));\n                if (rowSpan > 1) {\n                    args.td.rowSpan = rowSpan;\n                }\n            }\n            if (args.cell.colSpan > 1) {\n                var colSpan = args.cell.colSpan -\n                    this.parent.hiddenCount(args.colIdx, args.colIdx + (args.cell.colSpan - 1), 'columns');\n                if (colSpan > 1) {\n                    args.td.colSpan = colSpan;\n                }\n            }\n            if (args.cell.image) {\n                for (var i = 0; i < args.cell.image.length; i++) {\n                    this.parent.notify(createImageElement, {\n                        options: {\n                            src: args.cell.image[i].src, imageId: args.cell.image[i].id,\n                            height: args.cell.image[i].height, width: args.cell.image[i].width,\n                            top: args.cell.image[i].top, left: args.cell.image[i].left\n                        },\n                        range: getRangeAddress([args.rowIdx, args.colIdx, args.rowIdx, args.colIdx]), isPublic: false\n                    });\n                }\n            }\n        }\n        if (args.isRefresh) {\n            this.removeStyle(args.td, args.rowIdx, args.colIdx);\n        }\n        if (this.parent.allowConditionalFormat && args.lastCell) {\n            this.parent.notify(checkConditionalFormat, { rowIdx: args.rowIdx, colIdx: args.colIdx, cell: args.cell });\n        }\n        if (this.parent.allowChart && args.lastCell) {\n            this.parent.notify(refreshChart, {\n                cell: args.cell, rIdx: args.rowIdx, cIdx: args.colIdx, sheetIdx: this.parent.activeSheetIndex\n            });\n        }\n        if (Object.keys(style).length || Object.keys(this.parent.commonCellStyle).length || args.lastCell) {\n            this.parent.notify(applyCellFormat, {\n                style: extend({}, this.parent.commonCellStyle, style), rowIdx: args.rowIdx, colIdx: args.colIdx, cell: args.td,\n                first: args.first, row: args.row, lastCell: args.lastCell, hRow: args.hRow, pRow: args.pRow, isHeightCheckNeeded: args.isHeightCheckNeeded, manualUpdate: args.manualUpdate\n            });\n        }\n        if (args.checkNextBorder === 'Row') {\n            var borderTop = this.parent.getCellStyleValue(['borderTop'], [Number(this.parent.getContentTable().rows[0].getAttribute('aria-rowindex')) - 1, args.colIdx]).borderTop;\n            if (borderTop !== '' && (!args.cell || !args.cell.style || !args.cell.style.bottomPriority)) {\n                this.parent.notify(applyCellFormat, { style: { borderBottom: borderTop }, rowIdx: args.rowIdx,\n                    colIdx: args.colIdx, cell: args.td });\n            }\n        }\n        if (args.checkNextBorder === 'Column') {\n            var borderLeft = this.parent.getCellStyleValue(['borderLeft'], [args.rowIdx, args.colIdx + 1]).borderLeft;\n            if (borderLeft !== '' && (!args.cell || !args.cell.style || (!args.cell.style.borderRight && !args.cell.style.border))) {\n                this.parent.notify(applyCellFormat, { style: { borderRight: borderLeft }, rowIdx: args.rowIdx, colIdx: args.colIdx,\n                    cell: args.td });\n            }\n        }\n        if (args.cell && args.cell.hyperlink && !hasTemplate(this.parent, args.rowIdx, args.colIdx, this.parent.activeSheetIndex)) {\n            var address = void 0;\n            if (typeof (args.cell.hyperlink) === 'string') {\n                address = args.cell.hyperlink;\n                if (address.indexOf('http://') !== 0 && address.indexOf('https://') !== 0 && address.indexOf('ftp://') !== 0) {\n                    args.cell.hyperlink = address.toLowerCase().indexOf('www.') === 0 ? 'http://' + address : address;\n                }\n            }\n            else {\n                address = args.cell.hyperlink.address;\n                if (address.indexOf('http://') !== 0 && address.indexOf('https://') !== 0 && address.indexOf('ftp://') !== 0) {\n                    args.cell.hyperlink.address = address.toLowerCase().indexOf('www.') === 0 ? 'http://' + address : address;\n                }\n            }\n            this.parent.notify(createHyperlinkElement, { cell: args.cell, td: args.td, rowIdx: args.rowIdx, colIdx: args.colIdx });\n        }\n    };\n    CellRenderer.prototype.checkMerged = function (args) {\n        if (args.cell && (args.cell.colSpan < 0 || args.cell.rowSpan < 0)) {\n            args.td.style.display = 'none';\n            if (args.cell.colSpan < 0) {\n                this.parent.notify(checkPrevMerge, args);\n            }\n            if (args.cell.rowSpan < 0) {\n                args.isRow = true;\n                this.parent.notify(checkPrevMerge, args);\n            }\n            return true;\n        }\n        return false;\n    };\n    CellRenderer.prototype.processTemplates = function (cell, rowIdx, colIdx) {\n        var sheet = this.parent.getActiveSheet();\n        var ranges = sheet.ranges;\n        var range;\n        for (var j = 0, len = ranges.length; j < len; j++) {\n            if (ranges[j].template) {\n                range = getRangeIndexes(ranges[j].address.length ? ranges[j].address : ranges[j].startCell);\n                if (range[0] <= rowIdx && range[1] <= colIdx && range[2] >= rowIdx && range[3] >= colIdx) {\n                    if (cell) {\n                        return this.compileCellTemplate(ranges[j].template);\n                    }\n                    else {\n                        if (!getCell(rowIdx, colIdx, sheet, true)) {\n                            return this.compileCellTemplate(ranges[j].template);\n                        }\n                    }\n                }\n            }\n        }\n        return '';\n    };\n    CellRenderer.prototype.compileCellTemplate = function (template) {\n        var compiledStr;\n        if (typeof template === 'string') {\n            var templateString = void 0;\n            if (template.trim().indexOf('#') === 0) {\n                templateString = document.querySelector(template).innerHTML.trim();\n            }\n            else {\n                templateString = template;\n            }\n            compiledStr = compile(templateString);\n            return compiledStr({}, null, null, '', true)[0].outerHTML;\n        }\n        else {\n            compiledStr = compile(template);\n            return compiledStr({}, this.parent, 'ranges', '')[0];\n        }\n    };\n    CellRenderer.prototype.updateRowHeight = function (args) {\n        if (args.cell && args.cell.children.length) {\n            var clonedCell = args.cell.cloneNode(true);\n            this.tableRow.appendChild(clonedCell);\n        }\n        if (args.lastCell && this.tableRow.childElementCount) {\n            var sheet = this.parent.getActiveSheet();\n            var tableRow = args.row || this.parent.getRow(args.rowIdx);\n            var previouseHeight = getRowHeight(sheet, args.rowIdx);\n            var rowHeight = this.getRowHeightOnInit();\n            if (rowHeight > previouseHeight) {\n                tableRow.style.height = rowHeight + \"px\";\n                if (sheet.showHeaders) {\n                    (args.hRow || this.parent.getRow(args.rowIdx, this.parent.getRowHeaderTable())).style.height =\n                        rowHeight + \"px\";\n                }\n                setRowHeight(sheet, args.rowIdx, rowHeight);\n            }\n            this.tableRow.innerHTML = '';\n        }\n    };\n    CellRenderer.prototype.getRowHeightOnInit = function () {\n        var tTable = this.parent.createElement('table', { className: 'e-table e-test-table' });\n        var tBody = tTable.appendChild(this.parent.createElement('tbody'));\n        tBody.appendChild(this.tableRow);\n        this.parent.element.appendChild(tTable);\n        var height = Math.round(this.tableRow.getBoundingClientRect().height);\n        this.parent.element.removeChild(tTable);\n        return height < 20 ? 20 : height;\n    };\n    CellRenderer.prototype.removeStyle = function (element, rowIdx, colIdx) {\n        var cellStyle;\n        if (element.style.length) {\n            cellStyle = this.parent.getCellStyleValue(['borderLeft', 'border'], [rowIdx, colIdx + 1]);\n            var rightBorder_1 = cellStyle.borderLeft || cellStyle.border;\n            cellStyle = this.parent.getCellStyleValue(['borderTop', 'border'], [rowIdx + 1, colIdx]);\n            var bottomBorder_1 = cellStyle.borderTop || cellStyle.border;\n            if (rightBorder_1 || bottomBorder_1) {\n                [].slice.call(element.style).forEach(function (style) {\n                    if ((rightBorder_1 && !(style.indexOf('border-right') > -1) && !bottomBorder_1) ||\n                        (bottomBorder_1 && !(style.indexOf('border-bottom') > -1) && !rightBorder_1)) {\n                        element.style.removeProperty(style);\n                    }\n                });\n            }\n            else {\n                element.removeAttribute('style');\n            }\n        }\n        var prevRowCell = this.parent.getCell(rowIdx - 1, colIdx);\n        if (prevRowCell && prevRowCell.style.borderBottom) {\n            var prevRowIdx = Number(prevRowCell.parentElement.getAttribute('aria-rowindex')) - 1;\n            cellStyle = this.parent.getCellStyleValue(['borderBottom', 'border'], [prevRowIdx, colIdx]);\n            if (!(cellStyle.borderBottom || cellStyle.border)) {\n                prevRowCell.style.borderBottom = '';\n            }\n        }\n        var prevColCell = element.previousElementSibling;\n        if (prevColCell && prevColCell.style.borderRight) {\n            colIdx = Number(prevColCell.getAttribute('aria-colindex')) - 1;\n            cellStyle = this.parent.getCellStyleValue(['borderRight', 'border'], [rowIdx, colIdx]);\n            if (!(cellStyle.borderRight || cellStyle.border)) {\n                prevColCell.style.borderRight = '';\n            }\n        }\n    };\n    /** @hidden */\n    CellRenderer.prototype.refreshRange = function (range) {\n        var sheet = this.parent.getActiveSheet();\n        var cRange = range.slice();\n        if (inView(this.parent, cRange, true)) {\n            for (var i = cRange[0]; i <= cRange[2]; i++) {\n                if (isHiddenRow(sheet, i)) {\n                    continue;\n                }\n                for (var j = cRange[1]; j <= cRange[3]; j++) {\n                    var cell = this.parent.getCell(i, j);\n                    if (cell) {\n                        this.update({ rowIdx: i, colIdx: j, td: cell, cell: getCell(i, j, sheet), lastCell: j === cRange[3], isRefresh: true, isHeightCheckNeeded: true, manualUpdate: true, first: '' });\n                        this.parent.notify(renderFilterCell, { td: cell, rowIndex: i, colIndex: j });\n                    }\n                }\n            }\n        }\n    };\n    CellRenderer.prototype.refresh = function (rowIdx, colIdx, lastCell, element) {\n        var sheet = this.parent.getActiveSheet();\n        if (!element && (isHiddenRow(sheet, rowIdx) || isHiddenCol(sheet, colIdx))) {\n            return;\n        }\n        if (element || !this.parent.scrollSettings.enableVirtualization || (rowIdx >= this.parent.viewport.topIndex && rowIdx <=\n            this.parent.viewport.bottomIndex && colIdx >= this.parent.viewport.leftIndex && colIdx <=\n            this.parent.viewport.rightIndex)) {\n            var cell = element || this.parent.getCell(rowIdx, colIdx);\n            this.update({ rowIdx: rowIdx, colIdx: colIdx, td: cell, cell: getCell(rowIdx, colIdx, sheet), lastCell: lastCell, isRefresh: true, isHeightCheckNeeded: true,\n                manualUpdate: true, first: '' });\n            this.parent.notify(renderFilterCell, { td: cell, rowIndex: rowIdx, colIndex: colIdx });\n        }\n    };\n    CellRenderer.prototype.updateView = function (args) {\n        this.refreshRange(args.indexes);\n    };\n    return CellRenderer;\n}());\nexport { CellRenderer };\n","import { initialLoad, ribbon, formulaBar, beforeVirtualContentLoaded, setAriaOptions, getSiblingsHeight } from '../common/index';\nimport { SheetRender, RowRenderer, CellRenderer } from './index';\nimport { remove } from '@syncfusion/ej2-base';\nimport { getSheetName, getRowsHeight, getColumnsWidth } from '../../workbook/base/index';\nimport { getCellAddress, getCellIndexes, workbookFormulaOperation } from '../../workbook/common/index';\nimport { dataRefresh, sheetTabs, onContentScroll, deInitProperties, beforeDataBound, isReact } from '../common/index';\nimport { spreadsheetDestroyed, isFormulaBarEdit, editOperation, renderReactTemplates } from '../common/index';\n/**\n * Render module is used to render the spreadsheet\n * @hidden\n */\nvar Render = /** @class */ (function () {\n    function Render(parent) {\n        this.parent = parent;\n        this.addEventListener();\n    }\n    Render.prototype.render = function () {\n        this.parent.activeSheetIndex = this.parent.skipHiddenSheets(this.parent.activeSheetIndex);\n        if (!this.parent.isMobileView()) {\n            this.parent.notify(ribbon, null);\n            this.parent.notify(formulaBar, null);\n        }\n        var sheetPanel = this.parent.createElement('div', {\n            id: this.parent.element.id + '_sheet_panel', className: 'e-sheet-panel'\n        });\n        if (this.parent.enableRtl) {\n            sheetPanel.classList.add('e-rtl');\n        }\n        this.parent.element.appendChild(sheetPanel);\n        if (this.parent.showSheetTabs) {\n            this.parent.notify(sheetTabs, null);\n        }\n        else { // for formula calculation\n            var sheetName = getSheetName(this.parent, 0);\n            var arg = { action: 'addSheet', sheetName: 'Sheet1', index: 1, visibleName: sheetName };\n            this.parent.notify(workbookFormulaOperation, arg);\n            this.parent.notify(workbookFormulaOperation, { action: 'initiateDefinedNames' });\n        }\n        if (this.parent.isMobileView()) {\n            this.parent.notify(formulaBar, null);\n            this.parent.notify(ribbon, null);\n        }\n        this.setSheetPanelSize();\n        this.renderSheet(sheetPanel);\n        this.checkTopLeftCell(true);\n    };\n    Render.prototype.checkTopLeftCell = function (initLoad) {\n        var sheet = this.parent.getActiveSheet();\n        if (!this.parent.scrollSettings.enableVirtualization || sheet.topLeftCell === 'A1') {\n            this.refreshUI({ rowIndex: 0, colIndex: 0, refresh: 'All' }, null, initLoad);\n        }\n        else {\n            var indexes = getCellIndexes(sheet.topLeftCell);\n            var top_1 = indexes[0] ? getRowsHeight(sheet, 0, indexes[0] - 1) : 0;\n            var left = indexes[1] ? getColumnsWidth(sheet, 0, indexes[1] - 1) : 0;\n            this.parent.notify(onContentScroll, { scrollLeft: left, scrollTop: top_1, preventScroll: true });\n            var threshold = this.parent.getThreshold('row');\n            var rowIndex = indexes[0] > threshold ? indexes[0] - threshold : 0;\n            threshold = this.parent.getThreshold('col');\n            var colIndex = indexes[1] > threshold ? indexes[1] - threshold : 0;\n            this.refreshUI({ rowIndex: rowIndex, colIndex: colIndex, refresh: 'All', top: top_1, left: left });\n        }\n    };\n    Render.prototype.renderSheet = function (panel) {\n        if (panel === void 0) { panel = document.getElementById(this.parent.element.id + '_sheet_panel'); }\n        panel.appendChild(this.parent.createElement('div', { className: 'e-sheet', id: this.parent.element.id + '_sheet' }));\n        this.parent.serviceLocator.getService('sheet').renderPanel();\n    };\n    Render.prototype.refreshUI = function (args, address, initLoad) {\n        var _this = this;\n        var sheetModule = this.parent.serviceLocator.getService('sheet');\n        var sheet = this.parent.getActiveSheet();\n        var sheetName = getSheetName(this.parent);\n        this.parent.showSpinner();\n        if (!address) {\n            if (this.parent.scrollSettings.enableVirtualization) {\n                var lastRow = args.rowIndex + this.parent.viewport.rowCount + (this.parent.getThreshold('row') * 2);\n                var count = sheet.rowCount - 1;\n                if (this.parent.scrollSettings.isFinite && lastRow > count) {\n                    lastRow = count;\n                }\n                var lastCol = args.colIndex + this.parent.viewport.colCount + (this.parent.getThreshold('col') * 2);\n                count = sheet.colCount - 1;\n                if (this.parent.scrollSettings.isFinite && lastCol > count) {\n                    lastCol = count;\n                }\n                var indexes = this.parent.skipHidden(args.rowIndex, lastRow);\n                var startRow = args.rowIndex;\n                if (args.rowIndex !== indexes[0]) {\n                    var topLeftCell = getCellIndexes(sheet.topLeftCell);\n                    if (topLeftCell[0] === args.rowIndex) {\n                        this.parent.setSheetPropertyOnMute(sheet, 'topLeftCell', getCellAddress(indexes[0], topLeftCell[1]));\n                    }\n                    args.rowIndex = indexes[0];\n                }\n                lastRow = indexes[1];\n                indexes = this.parent.skipHidden(args.colIndex, lastCol, 'columns');\n                var startCol = args.colIndex;\n                if (args.colIndex !== indexes[0]) {\n                    var topLeftCell = getCellIndexes(sheet.topLeftCell);\n                    if (topLeftCell[1] === args.colIndex) {\n                        this.parent.setSheetPropertyOnMute(sheet, 'topLeftCell', getCellAddress(topLeftCell[0], indexes[0]));\n                    }\n                    args.colIndex = indexes[0];\n                }\n                lastCol = indexes[1];\n                this.parent.viewport.topIndex = args.rowIndex;\n                this.parent.viewport.bottomIndex = lastRow;\n                this.parent.viewport.leftIndex = args.colIndex;\n                this.parent.viewport.rightIndex = lastCol;\n                address = getCellAddress(startRow, startCol) + \":\" + getCellAddress(lastRow, lastCol);\n            }\n            else {\n                address = \"A1:\" + getCellAddress(sheet.rowCount - 1, sheet.colCount - 1);\n            }\n        }\n        if (args.refresh === 'All') {\n            this.parent.trigger(beforeDataBound, {});\n        }\n        setAriaOptions(this.parent.getMainContent(), { busy: true });\n        this.parent.getData(sheetName + \"!\" + address).then(function (values) {\n            var indexes = [args.rowIndex, args.colIndex].concat(getCellIndexes(address.split(':')[1]));\n            switch (args.refresh) {\n                case 'All':\n                    sheetModule.renderTable({ cells: values, indexes: indexes, top: args.top, left: args.left, initLoad: initLoad });\n                    break;\n                case 'Row':\n                    sheetModule.refreshRowContent({ cells: values, indexes: indexes, skipUpdateOnFirst: args.skipUpdateOnFirst });\n                    var isEdit = false;\n                    var arg = { isEdit: isEdit };\n                    _this.parent.notify(isFormulaBarEdit, arg);\n                    if (arg.isEdit) {\n                        _this.parent.notify(editOperation, { action: 'startEdit', refreshCurPos: false });\n                    }\n                    break;\n                case 'Column':\n                    sheetModule.refreshColumnContent({ cells: values, indexes: indexes, skipUpdateOnFirst: args.skipUpdateOnFirst });\n                    break;\n                case 'RowPart':\n                    sheetModule.updateRowContent({\n                        cells: values, indexes: indexes, direction: args.direction, skipUpdateOnFirst: args.skipUpdateOnFirst\n                    });\n                    break;\n                case 'ColumnPart':\n                    sheetModule.updateColContent({\n                        cells: values, indexes: indexes, direction: args.direction, skipUpdateOnFirst: args.skipUpdateOnFirst\n                    });\n                    break;\n            }\n            if (_this.parent[isReact]) {\n                _this.parent[renderReactTemplates]();\n            }\n        });\n        this.parent.notify(beforeVirtualContentLoaded, { refresh: args.refresh });\n    };\n    Render.prototype.removeSheet = function () {\n        remove(document.getElementById(this.parent.element.id + '_sheet'));\n    };\n    /**\n     * Refresh the active sheet\n     */\n    Render.prototype.refreshSheet = function () {\n        this.removeSheet();\n        this.renderSheet();\n        this.parent.notify(deInitProperties, {});\n        this.checkTopLeftCell();\n    };\n    /**\n     * Used to set sheet panel size.\n     */\n    Render.prototype.setSheetPanelSize = function () {\n        var panel = document.getElementById(this.parent.element.id + '_sheet_panel');\n        var offset = this.parent.element.getBoundingClientRect();\n        var height;\n        if (this.parent.height === 'auto') {\n            panel.style.height = '260px';\n            height = 230;\n        }\n        else {\n            height = offset.height - getSiblingsHeight(panel);\n            panel.style.height = height + \"px\";\n            height -= 32;\n        }\n        this.parent.viewport.height = height;\n        this.parent.viewport.width = offset.width - 32;\n        this.parent.viewport.rowCount = this.roundValue(height, 20);\n        this.parent.viewport.colCount = this.roundValue(offset.width, 64);\n    };\n    Render.prototype.roundValue = function (size, threshold) {\n        var value = size / threshold;\n        var roundedValue = Math.round(value);\n        return Math.abs(value - roundedValue) < 0.5 ? roundedValue : roundedValue - 1;\n    };\n    /**\n     * Registing the renderer related services.\n     */\n    Render.prototype.instantiateRenderer = function () {\n        this.parent.serviceLocator.register('cell', new CellRenderer(this.parent));\n        this.parent.serviceLocator.register('row', new RowRenderer(this.parent));\n        this.parent.serviceLocator.register('sheet', new SheetRender(this.parent));\n    };\n    /**\n     * Destroy the Render module.\n     * @return {void}\n     */\n    Render.prototype.destroy = function () {\n        this.removeEventListener();\n        this.parent = null;\n    };\n    Render.prototype.addEventListener = function () {\n        this.parent.on(initialLoad, this.instantiateRenderer, this);\n        this.parent.on(dataRefresh, this.refreshSheet, this);\n        this.parent.on(spreadsheetDestroyed, this.destroy, this);\n    };\n    Render.prototype.removeEventListener = function () {\n        this.parent.off(initialLoad, this.instantiateRenderer);\n        this.parent.off(dataRefresh, this.refreshSheet);\n        this.parent.off(spreadsheetDestroyed, this.destroy);\n    };\n    return Render;\n}());\nexport { Render };\n","import { Dialog as DialogComponent } from '@syncfusion/ej2-popups';\nimport { extend, remove, isNullOrUndefined } from '@syncfusion/ej2-base';\nimport { locale } from '../common/index';\n/**\n * Dialog Service.\n * @hidden\n */\nvar Dialog = /** @class */ (function () {\n    /**\n     * Constructor for initializing dialog service.\n     */\n    function Dialog(parent) {\n        this.parent = parent;\n    }\n    /**\n     * To show dialog.\n     */\n    Dialog.prototype.show = function (dialogModel, cancelBtn) {\n        var _this = this;\n        var btnContent;\n        cancelBtn = isNullOrUndefined(cancelBtn) ? true : false;\n        var closeHandler = dialogModel.close || null;\n        var model = {\n            header: 'Spreadsheet',\n            cssClass: this.parent.cssClass,\n            target: this.parent.element,\n            buttons: []\n        };\n        dialogModel.close = function () {\n            _this.dialogInstance.destroy();\n            remove(_this.dialogInstance.element);\n            _this.dialogInstance = null;\n            if (closeHandler) {\n                closeHandler();\n            }\n        };\n        extend(model, dialogModel);\n        if (cancelBtn) {\n            btnContent = this.parent.serviceLocator.getService(locale).getConstant(model.buttons.length ? 'Cancel' : 'Ok');\n            model.buttons.push({\n                buttonModel: { content: btnContent, isPrimary: model.buttons.length === 0 },\n                click: this.hide.bind(this),\n            });\n        }\n        var div = this.parent.createElement('div');\n        document.body.appendChild(div);\n        this.dialogInstance = new DialogComponent(model);\n        this.dialogInstance.createElement = this.parent.createElement;\n        this.dialogInstance.appendTo(div);\n        this.dialogInstance.refreshPosition();\n    };\n    /**\n     * To hide dialog.\n     */\n    Dialog.prototype.hide = function () {\n        if (this.dialogInstance) {\n            this.dialogInstance.hide();\n        }\n    };\n    /**\n     * To clear private variables.\n     */\n    Dialog.prototype.destroy = function () {\n        this.parent = null;\n    };\n    return Dialog;\n}());\nexport { Dialog };\n","import { completeAction, beginAction } from '../common/index';\nimport { setActionData, updateUndoRedoCollection } from '../common/index';\n/**\n *  Begin and complete events.\n * @hidden\n */\nvar ActionEvents = /** @class */ (function () {\n    /**\n     * Constructor for initializing action begin and action complete services.\n     */\n    function ActionEvents(parent) {\n        this.parent = parent;\n        this.addEventListener();\n        //this.initializeActionBegin();\n        //this.initializeActionComplete();\n    }\n    ActionEvents.prototype.initializeActionBegin = function () {\n        var _this = this;\n        var cellFormat = this.parent.beforeCellFormat;\n        this.parent.beforeCellFormat = function (args) {\n            _this.actionEventHandler({ evtArgs: args, evtFunc: cellFormat, actionType: 'begin', eventType: 'format' });\n        };\n        var beforeOpen = this.parent.beforeOpen;\n        this.parent.beforeOpen = function (args) {\n            _this.actionEventHandler({ evtArgs: args, evtFunc: beforeOpen, actionType: 'begin', eventType: 'beforeOpen' });\n        };\n        var beforeSave = this.parent.beforeSave;\n        this.parent.beforeSave = function (args) {\n            _this.actionEventHandler({ evtArgs: args, evtFunc: beforeSave, actionType: 'begin', eventType: 'beforeSave' });\n        };\n        var beforeSort = this.parent.beforeSort;\n        this.parent.beforeSort = function (args) {\n            _this.actionEventHandler({ evtArgs: args, evtFunc: beforeSort, actionType: 'begin', eventType: 'beforeSort' });\n        };\n    };\n    ActionEvents.prototype.initializeActionComplete = function () {\n        var _this = this;\n        var sortComplete = this.parent.sortComplete;\n        this.parent.sortComplete = function (args) {\n            _this.actionEventHandler({ evtArgs: args, evtFunc: sortComplete, actionType: 'complete', eventType: 'sorting' });\n        };\n        var cellSave = this.parent.cellSave;\n        this.parent.cellSave = function (args) {\n            _this.actionEventHandler({ evtArgs: args, evtFunc: cellSave, actionType: 'complete', eventType: 'cellSave' });\n        };\n    };\n    ActionEvents.prototype.actionEventHandler = function (args) {\n        if (args.evtFunc) {\n            args.evtFunc.apply(this, [args]);\n        }\n        if (args.actionType === 'begin') {\n            this.actionBeginHandler({ eventArgs: args.evtArgs, action: args.eventType });\n        }\n        else {\n            this.actionCompleteHandler({ eventArgs: args.evtArgs, action: args.eventType });\n        }\n    };\n    ActionEvents.prototype.actionBeginHandler = function (args) {\n        this.parent.trigger('actionBegin', { action: args.action, args: args });\n        if (args.action === 'clipboard' || args.action === 'beforeSort' || args.action === 'format' || args.action === 'cellSave'\n            || args.action === 'beforeWrap' || args.action === 'beforeReplace'\n            || args.action === 'beforeClear' || args.action === 'beforeInsertImage' || args.action === 'beforeInsertChart'\n            || args.action === 'filter') {\n            this.parent.notify(setActionData, { args: args });\n        }\n    };\n    ActionEvents.prototype.actionCompleteHandler = function (args) {\n        this.parent.trigger('actionComplete', args);\n        if (args.action !== 'undoRedo' && args.action !== 'gotoSheet') {\n            this.parent.notify(updateUndoRedoCollection, { args: args });\n        }\n    };\n    ActionEvents.prototype.addEventListener = function () {\n        this.parent.on(completeAction, this.actionCompleteHandler, this);\n        this.parent.on(beginAction, this.actionBeginHandler, this);\n    };\n    ActionEvents.prototype.removeEventListener = function () {\n        this.parent.off(completeAction, this.actionCompleteHandler);\n        this.parent.off(beginAction, this.actionBeginHandler);\n    };\n    return ActionEvents;\n}());\nexport { ActionEvents };\n","import { getCellPosition, refreshImgCellObj, refreshChartCellObj } from '../common/index';\nimport { getRangeIndexes, refreshChartSize, focusChartBorder } from '../../workbook/index';\nimport { EventHandler, removeClass, closest } from '@syncfusion/ej2-base';\n/**\n * Specifes to create or modify overlay.\n * @hidden\n */\nvar Overlay = /** @class */ (function () {\n    /**\n     * Constructor for initializing Overlay service.\n     */\n    function Overlay(parent) {\n        this.minHeight = '300px';\n        this.minWidth = '400px';\n        this.isOverlayClicked = false;\n        this.isResizerClicked = false;\n        this.currentWidth = 400;\n        this.currenHeight = 300;\n        this.parent = parent;\n    }\n    /**\n     * To insert a shape.\n     * @hidden\n     */\n    Overlay.prototype.insertOverlayElement = function (id, range, sheetIndex) {\n        var div = this.parent.createElement('div', {\n            id: id,\n            attrs: { 'class': 'e-ss-overlay' },\n            styles: 'width: ' + this.minWidth + ';  height: ' + this.minHeight\n        });\n        var indexes = getRangeIndexes(range);\n        var sheet = this.parent.sheets[sheetIndex];\n        var pos = getCellPosition(sheet, indexes);\n        div.style.top = pos.top + 'px';\n        div.style.left = pos.left + 'px';\n        this.parent.getMainContent().appendChild(div);\n        this.renderResizeHandles(div);\n        this.addEventListener(div);\n        this.originalWidth = parseFloat(getComputedStyle(div, null).getPropertyValue('width').replace('px', ''));\n        this.originalHeight = parseFloat(getComputedStyle(div, null).getPropertyValue('height').replace('px', ''));\n        return div;\n    };\n    Overlay.prototype.addEventListener = function (div) {\n        var overlayElem = div;\n        EventHandler.add(overlayElem, 'mousedown', this.overlayClickHandler, this);\n        EventHandler.add(overlayElem, 'mousemove', this.overlayMouseMoveHandler, this);\n        EventHandler.add(this.parent.getMainContent(), 'mousemove', this.overlayMouseMoveHandler, this);\n        EventHandler.add(document, 'mouseup', this.overlayMouseUpHandler, this);\n    };\n    Overlay.prototype.overlayMouseMoveHandler = function (e) {\n        var target = e.target;\n        var overlayElem = document.getElementsByClassName('e-ss-overlay-active')[0];\n        if (this.isOverlayClicked && this.isResizerClicked) {\n            switch (this.resizer) {\n                case 'e-ss-overlay-t':\n                    var height1 = Math.max(this.originalMouseY - e.clientY + this.originalHeight, 20);\n                    var top_1 = e.clientY - (this.originalMouseY - this.originalResizeTop);\n                    if (height1 > 180 && top_1 > -1) {\n                        overlayElem.style.height = height1 + 'px';\n                        overlayElem.style.top = top_1 + 'px';\n                        this.resizedReorderTop = top_1; // resized divTop\n                        this.currenHeight = height1;\n                        this.parent.notify(refreshChartSize, {\n                            height: overlayElem.style.height, width: overlayElem.style.width, overlayEle: overlayElem\n                        });\n                    }\n                    break;\n                case 'e-ss-overlay-r':\n                    var width1 = this.originalWidth + (e.pageX - this.originalMouseX);\n                    if (width1 > 180) {\n                        overlayElem.style.width = width1 + 'px';\n                        this.currentWidth = width1;\n                        this.parent.notify(refreshChartSize, {\n                            height: overlayElem.style.height, width: overlayElem.style.width, overlayEle: overlayElem\n                        });\n                    }\n                    break;\n                case 'e-ss-overlay-b':\n                    var height2 = this.originalHeight + (e.pageY - this.originalMouseY);\n                    if (height2 > 180) {\n                        overlayElem.style.height = height2 + 'px';\n                        this.currenHeight = height2;\n                        this.parent.notify(refreshChartSize, {\n                            height: overlayElem.style.height, width: overlayElem.style.width, overlayEle: overlayElem\n                        });\n                    }\n                    break;\n                case 'e-ss-overlay-l':\n                    var width2 = Math.max(this.originalMouseX - e.clientX + this.originalWidth, 20);\n                    var left = e.clientX - (this.originalMouseX - this.originalResizeLeft);\n                    if (width2 > 180 && left > -1) {\n                        overlayElem.style.width = width2 + 'px';\n                        overlayElem.style.left = left + 'px';\n                        this.resizedReorderLeft = left; //resized divLeft\n                        this.currentWidth = width2;\n                        this.parent.notify(refreshChartSize, {\n                            height: overlayElem.style.height, width: overlayElem.style.width, overlayEle: overlayElem\n                        });\n                    }\n                    break;\n            }\n        }\n        else if (this.isOverlayClicked) {\n            var posX = e.clientX;\n            var posY = e.clientY;\n            var aX = posX - this.diffX;\n            var aY = posY - this.diffY;\n            if (aX > -1) {\n                overlayElem.style.left = aX + 'px';\n            }\n            if (aY > -1) {\n                overlayElem.style.top = aY + 'px';\n            }\n            this.resizedReorderLeft = aX; //resized divLeft\n            this.resizedReorderTop = aY; // resized divTop\n        }\n    };\n    Overlay.prototype.overlayMouseUpHandler = function (e) {\n        if (this.parent.getActiveSheet().isProtected) {\n            return;\n        }\n        this.isOverlayClicked = false;\n        this.isResizerClicked = false;\n        var elem = e.target;\n        if (!elem.classList.contains('e-ss-overlay')) {\n            elem = closest(e.target, '.e-datavisualization-chart') ?\n                closest(e.target, '.e-datavisualization-chart') : elem;\n        }\n        var eventArgs = {\n            prevTop: this.originalReorderTop, prevLeft: this.originalReorderLeft,\n            currentTop: this.resizedReorderTop ? this.resizedReorderTop : this.originalReorderTop, currentLeft: this.resizedReorderLeft ?\n                this.resizedReorderLeft : this.originalReorderLeft, id: elem.id, currentHeight: this.currenHeight,\n            currentWidth: this.currentWidth, requestType: 'imageRefresh',\n            prevHeight: this.originalHeight, prevWidth: this.originalWidth\n        };\n        if (elem.id.indexOf('overlay') > 0 || elem.classList.contains('e-ss-resizer')) {\n            if (this.originalReorderTop !== this.resizedReorderTop || this.originalReorderLeft !== this.resizedReorderLeft) {\n                eventArgs.id = elem.id;\n                if (elem.classList.contains('e-datavisualization-chart')) {\n                    eventArgs.requestType = 'chartRefresh';\n                    this.parent.notify(refreshChartCellObj, eventArgs);\n                }\n                this.parent.notify(refreshImgCellObj, eventArgs);\n                this.resizedReorderTop = this.originalReorderTop;\n                this.resizedReorderLeft = this.originalReorderLeft;\n            }\n            else if (this.currenHeight !== this.originalHeight || this.originalWidth !== this.currentWidth) {\n                eventArgs.id = elem.id.indexOf('overlay') > 0 ? elem.id : elem.parentElement.id;\n                if (elem.classList.contains('e-datavisualization-chart')) {\n                    eventArgs.requestType = 'chartRefresh';\n                    this.parent.notify(refreshChartCellObj, eventArgs);\n                }\n                this.parent.notify(refreshImgCellObj, eventArgs);\n                this.originalHeight = this.currenHeight;\n                this.originalWidth = this.currentWidth;\n            }\n        }\n    };\n    Overlay.prototype.overlayClickHandler = function (e) {\n        if (this.parent.getActiveSheet().isProtected) {\n            return;\n        }\n        this.isOverlayClicked = true;\n        var target = e.target;\n        var overlayElem = e.target;\n        if (!target.classList.contains('e-ss-overlay')) {\n            overlayElem = closest(e.target, '.e-datavisualization-chart') ?\n                closest(e.target, '.e-datavisualization-chart') : target.parentElement;\n        }\n        this.originalReorderLeft = parseInt(overlayElem.style.left, 10); //divLeft\n        this.originalReorderTop = parseInt(overlayElem.style.top, 10); // divTop\n        this.resizedReorderLeft = parseInt(overlayElem.style.left, 10); //resized divLeft\n        this.resizedReorderTop = parseInt(overlayElem.style.top, 10); // resized divTop\n        this.originalResizeTop = this.originalReorderTop;\n        this.originalResizeLeft = this.originalReorderLeft;\n        this.originalMouseX = e.clientX; // posX\n        this.originalMouseY = e.clientY; // posY\n        this.diffX = this.originalMouseX - this.originalReorderLeft;\n        this.diffY = this.originalMouseY - this.originalReorderTop;\n        var actOverlayElem = document.getElementsByClassName('e-ss-overlay-active')[0];\n        if (actOverlayElem) {\n            removeClass([actOverlayElem], 'e-ss-overlay-active');\n        }\n        document.getElementById(overlayElem.id).classList.add('e-ss-overlay-active');\n        if (target.classList.contains('e-ss-resizer')) {\n            this.resizer = target.classList[0];\n            this.originalWidth = parseFloat(getComputedStyle(overlayElem, null).getPropertyValue('width').replace('px', ''));\n            this.originalHeight = parseFloat(getComputedStyle(overlayElem, null).getPropertyValue('height').replace('px', ''));\n            this.isResizerClicked = true;\n        }\n        if (overlayElem.classList.contains('e-datavisualization-chart')) {\n            this.parent.notify(focusChartBorder, { id: overlayElem.id });\n        }\n    };\n    Overlay.prototype.renderResizeHandles = function (div) {\n        var handles = ['e-ss-overlay-t', 'e-ss-overlay-r', 'e-ss-overlay-b', 'e-ss-overlay-l'];\n        var i = 0;\n        var handleElem;\n        var overlay = div;\n        while (handles.length > i) {\n            handleElem = this.parent.createElement('div', {\n                attrs: { 'class': handles[i] + ' ' + 'e-ss-resizer' },\n                styles: 'width: 8px; height: 8px; border-radius: 4px;'\n            });\n            overlay.appendChild(handleElem);\n            i++;\n        }\n    };\n    Overlay.prototype.removeEventListener = function () {\n        var overlayElem = document.getElementById(this.parent.element.id + '_overlay');\n        EventHandler.remove(overlayElem, 'mousedown', this.overlayClickHandler);\n        EventHandler.remove(overlayElem, 'mousemove', this.overlayMouseMoveHandler);\n        EventHandler.remove(this.parent.getMainContent(), 'mousemove', this.overlayMouseMoveHandler);\n        EventHandler.remove(document, 'mouseup', this.overlayMouseUpHandler);\n    };\n    /**\n     * To clear private variables.\n     */\n    Overlay.prototype.destroy = function () {\n        this.removeEventListener();\n        this.parent = null;\n    };\n    return Overlay;\n}());\nexport { Overlay };\n","var __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    }\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\n/// <reference path='../../workbook/base/workbook-model.d.ts'/>\nimport { Property, NotifyPropertyChanges, Event, isUndefined } from '@syncfusion/ej2-base';\nimport { addClass, removeClass, Complex, formatUnit, L10n, isNullOrUndefined, Browser } from '@syncfusion/ej2-base';\nimport { detach, select, closest, setStyleAttribute, EventHandler } from '@syncfusion/ej2-base';\nimport { initialLoad, mouseDown, spreadsheetDestroyed, keyUp, clearViewer, blankWorkbook } from '../common/index';\nimport { hideShow, performUndoRedo, overlay, createImageElement, deleteImage } from '../common/index';\nimport { sheetNameUpdate, updateUndoRedoCollection, getUpdateUsingRaf, setAutoFit, created } from '../common/index';\nimport { actionEvents, keyDown, enableFileMenuItems, hideToolbarItems, updateAction } from '../common/index';\nimport { colWidthChanged, rowHeightChanged, hideRibbonTabs, addFileMenuItems, getSiblingsHeight } from '../common/index';\nimport { defaultLocale, locale, setAriaOptions, setResize, initiateFilterUI, clearFilter, clearTemplate, isReact } from '../common/index';\nimport { ribbon, formulaBar, sheetTabs, formulaOperation, addRibbonTabs } from '../common/index';\nimport { addContextMenuItems, removeContextMenuItems, enableContextMenuItems, selectRange, addToolbarItems } from '../common/index';\nimport { cut, copy, paste, dialog, editOperation, activeSheetChanged, refreshFormulaDatasource } from '../common/index';\nimport { Render } from '../renderer/render';\nimport { Scroll, VirtualScroll, Edit, CellFormat, Selection, KeyboardNavigation, KeyboardShortcut, WrapText } from '../actions/index';\nimport { Clipboard, ShowHide, UndoRedo, SpreadsheetHyperlink, Resize, Insert, Delete, FindAndReplace, Merge } from '../actions/index';\nimport { ProtectSheet } from '../actions/index';\nimport { click, hideFileMenuItems } from '../common/index';\nimport { Dialog, ActionEvents, Overlay } from '../services/index';\nimport { ServiceLocator } from '../../workbook/services/index';\nimport { getColumnsWidth, getSheetIndex, WorkbookHyperlink } from './../../workbook/index';\nimport { getCellAddress } from './../../workbook/common/index';\nimport { activeCellChanged, afterHyperlinkCreate, getColIndex } from './../../workbook/index';\nimport { WorkbookInsert, WorkbookDelete, WorkbookMerge } from './../../workbook/index';\nimport { getSheetNameFromAddress, DataBind, beforeHyperlinkCreate } from './../../workbook/index';\nimport { sortComplete, dataSourceChanged } from './../../workbook/index';\nimport { getSheetIndexFromId, WorkbookEdit, WorkbookOpen, WorkbookSave, WorkbookCellFormat, WorkbookSort } from './../../workbook/index';\nimport { findKeyUp } from './../../workbook/index';\nimport { Workbook } from '../../workbook/base/workbook';\nimport { getRequiredModules, ScrollSettings, enableToolbarItems } from '../common/index';\nimport { SelectionSettings, getStartEvent, enableRibbonTabs } from '../common/index';\nimport { createSpinner, showSpinner, hideSpinner } from '@syncfusion/ej2-popups';\nimport { setRowHeight, getRowsHeight, getColumnWidth, getRowHeight } from './../../workbook/base/index';\nimport { getRangeIndexes, getIndexesFromAddress, getCellIndexes, WorkbookNumberFormat, WorkbookFormula } from '../../workbook/index';\nimport { Ribbon, FormulaBar, SheetTabs, Open, ContextMenu, Save, NumberFormat, Formula } from '../integrations/index';\nimport { Sort, Filter, SpreadsheetImage, SpreadsheetChart } from '../integrations/index';\nimport { isNumber, getColumn, WorkbookFilter } from '../../workbook/index';\nimport { DataValidation } from '../actions/index';\nimport { WorkbookDataValidation, WorkbookConditionalFormat, WorkbookFindAndReplace } from '../../workbook/actions/index';\nimport { findAllValues } from './../../workbook/common/index';\nimport { ConditionalFormatting } from '../actions/conditional-formatting';\nimport { WorkbookImage, WorkbookChart } from '../../workbook/integrations/index';\nimport { WorkbookProtectSheet } from '../../workbook/actions/index';\n/**\n * Represents the Spreadsheet component.\n * ```html\n * <div id='spreadsheet'></div>\n * <script>\n *  var spreadsheetObj = new Spreadsheet();\n *  spreadsheetObj.appendTo('#spreadsheet');\n * </script>\n * ```\n */\nvar Spreadsheet = /** @class */ (function (_super) {\n    __extends(Spreadsheet, _super);\n    /**\n     * Constructor for creating the widget.\n     * @param  {SpreadsheetModel} options? - Configures Spreadsheet options.\n     * @param  {string|HTMLElement} element? - Element to render Spreadsheet.\n     */\n    function Spreadsheet(options, element) {\n        var _this = _super.call(this, options) || this;\n        /** @hidden */\n        _this.isEdit = false;\n        /** @hidden */\n        _this.viewport = {\n            rowCount: 0, colCount: 0, height: 0, topIndex: 0, leftIndex: 0, width: 0,\n            bottomIndex: 0, rightIndex: 0\n        };\n        _this.needsID = true;\n        Spreadsheet_1.Inject(Ribbon, FormulaBar, SheetTabs, Selection, Edit, KeyboardNavigation, KeyboardShortcut, Clipboard, DataBind, Open, ContextMenu, Save, NumberFormat, CellFormat, Formula, WrapText, WorkbookEdit, WorkbookOpen, WorkbookSave, WorkbookCellFormat, WorkbookNumberFormat, WorkbookFormula, Sort, WorkbookSort, Resize, UndoRedo, WorkbookFilter, Filter, SpreadsheetHyperlink, WorkbookHyperlink, Insert, Delete, WorkbookInsert, WorkbookDelete, DataValidation, WorkbookDataValidation, ProtectSheet, WorkbookProtectSheet, FindAndReplace, WorkbookFindAndReplace, Merge, WorkbookMerge, SpreadsheetImage, ConditionalFormatting, WorkbookImage, WorkbookConditionalFormat, SpreadsheetChart, WorkbookChart);\n        if (element) {\n            _this.appendTo(element);\n        }\n        return _this;\n    }\n    Spreadsheet_1 = Spreadsheet;\n    /**\n     * To get cell element.\n     * @returns HTMLElement\n     * @hidden\n     */\n    Spreadsheet.prototype.getCell = function (rowIndex, colIndex, row) {\n        colIndex = this.getViewportIndex(colIndex, true);\n        if (!row) {\n            row = this.getRow(rowIndex);\n        }\n        return row ? row.cells[colIndex] : row;\n    };\n    /**\n     * Get cell element.\n     * @returns HTMLTableRowElement\n     * @hidden\n     */\n    Spreadsheet.prototype.getRow = function (index, table) {\n        index = this.getViewportIndex(index);\n        table = table || this.getContentTable();\n        return table ? table.rows[index] : null;\n    };\n    /**\n     * To get hidden row/column count between two specified index.\n     * Set `layout` as `columns` if you want to get column hidden count.\n     * @hidden\n     */\n    Spreadsheet.prototype.hiddenCount = function (startIndex, endIndex, layout) {\n        if (layout === void 0) { layout = 'rows'; }\n        var sheet = this.getActiveSheet();\n        var count = 0;\n        for (var i = startIndex; i <= endIndex; i++) {\n            if ((sheet[layout])[i] && (sheet[layout])[i].hidden) {\n                count++;\n            }\n        }\n        return count;\n    };\n    /**\n     * To get row/column viewport index.\n     * @hidden\n     */\n    Spreadsheet.prototype.getViewportIndex = function (index, isCol) {\n        if (this.scrollSettings.enableVirtualization) {\n            if (isCol) {\n                index -= this.hiddenCount(this.viewport.leftIndex, index, 'columns');\n                index -= this.viewport.leftIndex;\n            }\n            else {\n                index -= this.hiddenCount(this.viewport.topIndex, index);\n                index -= this.viewport.topIndex;\n            }\n        }\n        return index;\n    };\n    /**\n     * To initialize the services;\n     * @returns void\n     * @hidden\n     */\n    Spreadsheet.prototype.preRender = function () {\n        _super.prototype.preRender.call(this);\n        this.serviceLocator = new ServiceLocator;\n        this.initServices();\n    };\n    Spreadsheet.prototype.initServices = function () {\n        this.serviceLocator.register(locale, new L10n(this.getModuleName(), defaultLocale, this.locale));\n        this.serviceLocator.register(dialog, new Dialog(this));\n        this.serviceLocator.register(actionEvents, new ActionEvents(this));\n        this.serviceLocator.register(overlay, new Overlay(this));\n    };\n    /**\n     * To Initialize the component rendering.\n     * @returns void\n     * @hidden\n     */\n    Spreadsheet.prototype.render = function () {\n        _super.prototype.render.call(this);\n        this.element.setAttribute('tabindex', '0');\n        setAriaOptions(this.element, { role: 'grid' });\n        this.renderModule = new Render(this);\n        this.notify(initialLoad, null);\n        this.renderSpreadsheet();\n        this.wireEvents();\n        if (this.created) {\n            if (this[created].observers) {\n                if (this[created].observers.length > 0) {\n                    this.createdHandler = { observers: this[created].observers };\n                    this[created].observers = [];\n                }\n            }\n            else {\n                this.createdHandler = this.created;\n                this.setProperties({ created: undefined }, true);\n            }\n        }\n    };\n    Spreadsheet.prototype.renderSpreadsheet = function () {\n        if (this.cssClass) {\n            addClass([this.element], this.cssClass.split(' '));\n        }\n        this.setHeight();\n        this.setWidth();\n        createSpinner({ target: this.element }, this.createElement);\n        if (this.isMobileView() && this.cssClass.indexOf('e-mobile-view') === -1) {\n            this.element.classList.add('e-mobile-view');\n        }\n        this.sheetModule = this.serviceLocator.getService('sheet');\n        if (this.allowScrolling) {\n            this.scrollModule = new Scroll(this);\n        }\n        if (this.scrollSettings.enableVirtualization) {\n            new VirtualScroll(this);\n        }\n        this.renderModule.render();\n        new ShowHide(this);\n    };\n    /**\n     * By default, Spreadsheet shows the spinner for all its actions. To manually show spinner you this method at your needed time.\n     * @return {void}\n     * {% codeBlock src='spreadsheet/showSpinner/index.md' %}{% endcodeBlock %}\n     */\n    Spreadsheet.prototype.showSpinner = function () {\n        showSpinner(this.element);\n    };\n    /**\n     * To hide showed spinner manually.\n     * @return {void}\n     * {% codeBlock src='spreadsheet/hideSpinner/index.md' %}{% endcodeBlock %}\n     */\n    Spreadsheet.prototype.hideSpinner = function () {\n        hideSpinner(this.element);\n    };\n    /**\n     * To protect the particular sheet.\n     * @param {number | string} sheet - Specifies the sheet to protect.\n     * @param {ProtectSettingsModel} protectSettings - Specifies the protect sheet options.\n     * @default { selectCells: 'false', formatCells: 'false', formatRows: 'false', formatColumns:'false', insertLink:'false' }\n     * @return {void}\n     * {% codeBlock src='spreadsheet/protectSheet/index.md' %}{% endcodeBlock %}\n     */\n    Spreadsheet.prototype.protectSheet = function (sheet, protectSettings) {\n        if (typeof (sheet) === 'string') {\n            sheet = getSheetIndex(this, sheet);\n        }\n        if (sheet) {\n            this.setSheetPropertyOnMute(this.sheets[sheet], 'isProtected', true);\n            this.setSheetPropertyOnMute(this.sheets[sheet], 'protectSettings', protectSettings);\n        }\n        sheet = this.getActiveSheet().index;\n        this.setSheetPropertyOnMute(this.getActiveSheet(), 'isProtected', true);\n        _super.prototype.protectSheet.call(this, sheet, protectSettings);\n    };\n    /**\n     * To unprotect the particular sheet.\n     * @param {number | string} sheet - Specifies the sheet to Unprotect.\n     * @return {void}\n     * {% codeBlock src='spreadsheet/unprotectSheet/index.md' %}{% endcodeBlock %}\n     */\n    Spreadsheet.prototype.unprotectSheet = function (sheet) {\n        if (typeof (sheet) === 'string') {\n            sheet = getSheetIndex(this, sheet);\n        }\n        if (sheet) {\n            this.sheets[sheet].isProtected = false;\n        }\n        else {\n            this.getActiveSheet().isProtected = false;\n        }\n        _super.prototype.unprotectSheet.call(this, sheet);\n    };\n    /**\n     * To find the specified cell value.\n     * @param {FindOptions} args - Specifies the replace value with find args to replace specified cell value.\n     * @param {string} args.value - Specifies the value to be find.\n     * @param {FindModeType} args.mode - Specifies the value to be find within sheet or workbook.\n     * @param {string} args.searchBy - Specifies the value to be find by row or column.\n     * @param {boolean} args.isCSen - Specifies the find match with case sensitive or not.\n     * @param {boolean} args.isEMatch - Specifies the find match with entire match or not.\n     * @param {string} args.findOpt - Specifies the next or previous find match.\n     * @param {number} args.sheetIndex - Specifies the current sheet to find.\n     * @default { mode: 'Sheet', searchBy: 'By Row', isCSen: 'false', isEMatch:'false' }\n     * @return {void}\n     * {% codeBlock src='spreadsheet/find/index.md' %}{% endcodeBlock %}\n     */\n    Spreadsheet.prototype.find = function (args) {\n        _super.prototype.findHandler.call(this, args);\n    };\n    /**\n     * To replace the specified cell value.\n     * @param {FindOptions} args - Specifies the replace value with find args to replace specified cell value.\n     * @param {string} args.replaceValue - Specifies the replacing value.\n     * @param {string} args.replaceBy - Specifies the value to be replaced for one or all.\n     * @param {string} args.value - Specifies the value to be replaced\n     * @return {void}\n     * {% codeBlock src='spreadsheet/replace/index.md' %}{% endcodeBlock %}\n     */\n    Spreadsheet.prototype.replace = function (args) {\n        args = {\n            value: args.value, mode: args.mode ? args.mode : 'Sheet', isCSen: args.isCSen ? args.isCSen : false,\n            isEMatch: args.isEMatch ? args.isEMatch : false, searchBy: args.searchBy ? args.searchBy : 'By Row',\n            replaceValue: args.replaceValue, replaceBy: args.replaceBy,\n            sheetIndex: args.sheetIndex ? args.sheetIndex : this.activeSheetIndex, findOpt: args.findOpt ? args.findOpt : ''\n        };\n        _super.prototype.replaceHandler.call(this, args);\n    };\n    /**\n     * To Find All the Match values Address within Sheet or Workbook.\n     * @param {string} value - Specifies the value to find.\n     * @param {FindModeType} mode - Specifies the value to be find within Sheet/Workbook.\n     * @param {boolean} isCSen - Specifies the find match with case sensitive or not.\n     * @param {boolean} isEMatch - Specifies the find match with entire match or not.\n     * @param {number} sheetIndex - Specifies the sheetIndex. If not specified, it will consider the active sheet.\n     * @return {string[]}\n     * {% codeBlock src='spreadsheet/findAll/index.md' %}{% endcodeBlock %}\n     */\n    Spreadsheet.prototype.findAll = function (value, mode, isCSen, isEMatch, sheetIndex) {\n        mode = mode ? mode : 'Sheet';\n        sheetIndex = sheetIndex ? sheetIndex : this.activeSheetIndex;\n        isCSen = isCSen ? isCSen : false;\n        isEMatch = isEMatch ? isEMatch : false;\n        var findCollection = [];\n        var findAllArguments = {\n            value: value, mode: mode, sheetIndex: sheetIndex, isCSen: isCSen,\n            isEMatch: isEMatch, findCollection: findCollection\n        };\n        this.notify(findAllValues, findAllArguments);\n        return findCollection;\n    };\n    /**\n     * Used to navigate to cell address within workbook.\n     * @param {string} address - Specifies the cell address you need to navigate.\n     * You can specify the address in two formats,\n     * `{sheet name}!{cell address}` - Switch to specified sheet and navigate to specified cell address.\n     * `{cell address}` - Navigate to specified cell address with in the active sheet.\n     * @return {void}\n     * {% codeBlock src='spreadsheet/goTo/index.md' %}{% endcodeBlock %}\n     */\n    Spreadsheet.prototype.goTo = function (address) {\n        if (address.includes('!')) {\n            var addrArr = address.split('!');\n            var idx = getSheetIndex(this, addrArr[0]);\n            if (idx === undefined) {\n                return;\n            }\n            if (idx !== this.activeSheetIndex) {\n                var activeCell = addrArr[1].split(':')[0];\n                this.setSheetPropertyOnMute(this.sheets[idx], 'activeCell', activeCell);\n                this.setSheetPropertyOnMute(this.sheets[idx], 'selectedRange', addrArr[1]);\n                var cellIndex = getCellIndexes(activeCell);\n                if (cellIndex[0] < this.viewport.rowCount) {\n                    cellIndex[0] = 0;\n                }\n                if (cellIndex[1] < this.viewport.colCount) {\n                    cellIndex[1] = 0;\n                }\n                this.setSheetPropertyOnMute(this.sheets[idx], 'topLeftCell', getCellAddress(cellIndex[0], cellIndex[1]));\n                this.activeSheetIndex = idx;\n                this.dataBind();\n                return;\n            }\n        }\n        var indexes = getRangeIndexes(address);\n        var sheet = this.getActiveSheet();\n        var insideDomCount = indexes[0] >= this.viewport.topIndex && indexes[0] < this.viewport.bottomIndex && indexes[1] >=\n            this.viewport.leftIndex && indexes[1] < this.viewport.rightIndex;\n        if (insideDomCount) {\n            this.selectRange(address);\n            var viewportIndexes = getCellIndexes(sheet.topLeftCell);\n            viewportIndexes[2] = viewportIndexes[0] + this.viewport.rowCount;\n            viewportIndexes[3] = viewportIndexes[1] + this.viewport.colCount;\n            if (indexes[0] >= viewportIndexes[0] && indexes[0] < viewportIndexes[2] && indexes[1] >= viewportIndexes[1] &&\n                indexes[1] < viewportIndexes[3]) {\n                return;\n            }\n        }\n        var content = this.getMainContent();\n        var vTrack;\n        var cVTrack;\n        var rVTrack;\n        var offset;\n        var vWidth;\n        var vHeight;\n        var scrollableSize;\n        if (indexes[0] === 0) {\n            offset = getRowsHeight(sheet, 0);\n        }\n        else {\n            offset = getRowsHeight(sheet, 0, indexes[0] - 1);\n            if (this.scrollSettings.enableVirtualization) {\n                scrollableSize = offset + this.getContentTable().getBoundingClientRect().height;\n                vHeight = parseInt(content.querySelector('.e-virtualtrack').style.height, 10);\n                if (scrollableSize > vHeight) {\n                    scrollableSize += 10;\n                    vTrack = content.querySelector('.e-virtualtrack');\n                    vTrack.style.height = scrollableSize + \"px\";\n                    if (sheet.showHeaders) {\n                        rVTrack = this.getRowHeaderContent().querySelector('.e-virtualtrack');\n                        rVTrack.style.height = scrollableSize + \"px\";\n                    }\n                    getUpdateUsingRaf(function () {\n                        vTrack.style.height = vHeight + \"px\";\n                        if (sheet.showHeaders) {\n                            rVTrack.style.height = vHeight + \"px\";\n                        }\n                    });\n                }\n            }\n        }\n        content.scrollTop = offset;\n        if (indexes[1] === 0) {\n            offset = getColumnsWidth(sheet, 0);\n        }\n        else {\n            offset = getColumnsWidth(sheet, 0, indexes[1] - 1);\n            if (this.scrollSettings.enableVirtualization) {\n                scrollableSize = offset + this.getContentTable().getBoundingClientRect().width;\n                vWidth = parseInt(content.querySelector('.e-virtualtrack').style.width, 10);\n                if (scrollableSize > vWidth) {\n                    scrollableSize += 10;\n                    vTrack = content.querySelector('.e-virtualtrack');\n                    vTrack.style.width = scrollableSize + \"px\";\n                    if (sheet.showHeaders) {\n                        cVTrack = this.getColumnHeaderContent().querySelector('.e-virtualtrack');\n                        cVTrack.style.width = scrollableSize + \"px\";\n                    }\n                    getUpdateUsingRaf(function () {\n                        vTrack.style.width = vWidth + \"px\";\n                        if (sheet.showHeaders) {\n                            cVTrack.style.width = vWidth + \"px\";\n                        }\n                    });\n                }\n            }\n        }\n        content.scrollLeft = offset;\n        if (!insideDomCount) {\n            this.selectRange(address);\n        }\n    };\n    /**\n     * Used to resize the Spreadsheet.\n     * {% codeBlock src='spreadsheet/resize/index.md' %}{% endcodeBlock %}\n     */\n    Spreadsheet.prototype.resize = function () {\n        this.renderModule.setSheetPanelSize();\n        if (this.scrollSettings.enableVirtualization) {\n            this.renderModule.refreshSheet();\n        }\n    };\n    /**\n     * To cut the specified cell or cells properties such as value, format, style etc...\n     * @param {string} address - Specifies the range address to cut.\n     * {% codeBlock src='spreadsheet/cut/index.md' %}{% endcodeBlock %}\n     */\n    Spreadsheet.prototype.cut = function (address) {\n        var promise = new Promise(function (resolve, reject) { resolve((function () { })()); });\n        this.notify(cut, address ? {\n            range: getIndexesFromAddress(address),\n            sId: this.sheets[getSheetIndex(this, getSheetNameFromAddress(address))].id,\n            promise: promise\n        } : { promise: promise });\n        return promise;\n    };\n    /**\n     * To copy the specified cell or cells properties such as value, format, style etc...\n     * @param {string} address - Specifies the range address.\n     * {% codeBlock src='spreadsheet/copy/index.md' %}{% endcodeBlock %}\n     */\n    Spreadsheet.prototype.copy = function (address) {\n        var activeAddress = this.getActiveSheet().name + '!' + this.getActiveSheet().activeCell;\n        address = !isNullOrUndefined(address) ? address : activeAddress;\n        var promise = new Promise(function (resolve, reject) { resolve((function () { })()); });\n        this.notify(copy, address ? {\n            range: getIndexesFromAddress(address),\n            sId: this.sheets[getSheetIndex(this, getSheetNameFromAddress(address))].id,\n            promise: promise\n        } : { promise: promise });\n        return promise;\n    };\n    /**\n     * This method is used to paste the cut or copied cells in to specified address.\n     * @param {string} address - Specifies the cell or range address.\n     * @param {PasteSpecialType} type - Specifies the type of paste.\n     * {% codeBlock src='spreadsheet/paste/index.md' %}{% endcodeBlock %}\n     */\n    Spreadsheet.prototype.paste = function (address, type) {\n        this.notify(paste, {\n            range: getIndexesFromAddress(address), sIdx: getSheetIndex(this, getSheetNameFromAddress(address)),\n            type: type, isAction: false, isInternal: true\n        });\n    };\n    /**\n     * To update the action which need to perform.\n     * @param {string} options - It describes an action and event args to perform.\n     * @param {string} options.action - specifies an action.\n     * @param {string} options.eventArgs - specifies an args to perform an action.\n     * {% codeBlock src='spreadsheet/updateAction/index.md' %}{% endcodeBlock %}\n     */\n    Spreadsheet.prototype.updateAction = function (options) {\n        updateAction(options, this);\n    };\n    Spreadsheet.prototype.setHeight = function () {\n        if (this.height.toString().indexOf('%') > -1) {\n            this.element.style.minHeight = '400px';\n        }\n        this.element.style.height = formatUnit(this.height);\n    };\n    Spreadsheet.prototype.setWidth = function () {\n        if (this.width.toString().indexOf('%') > -1 || this.width === 'auto') {\n            this.element.style.minWidth = '300px';\n        }\n        this.element.style.width = formatUnit(this.width);\n    };\n    /**\n     * Set the width of column.\n     * @param {number} width\n     * @param {number} colIndex\n     * @param {number} sheetIndex\n     * {% codeBlock src='spreadsheet/setColWidth/index.md' %}{% endcodeBlock %}\n     */\n    Spreadsheet.prototype.setColWidth = function (width, colIndex, sheetIndex) {\n        if (width === void 0) { width = 64; }\n        if (colIndex === void 0) { colIndex = 0; }\n        var colThreshold = this.getThreshold('col');\n        var lastIdx = this.viewport.leftIndex + this.viewport.colCount + (colThreshold * 2);\n        var sheet = isNullOrUndefined(sheetIndex) ? this.getActiveSheet() : this.sheets[sheetIndex];\n        if (sheet) {\n            var mIndex = colIndex;\n            var colWidth = (typeof width === 'number') ? width + 'px' : width;\n            colIndex = isNullOrUndefined(colIndex) ? getCellIndexes(sheet.activeCell)[1] : colIndex;\n            if (sheet === this.getActiveSheet()) {\n                if (colIndex >= this.viewport.leftIndex && colIndex <= lastIdx) {\n                    if (this.scrollSettings.enableVirtualization) {\n                        colIndex = colIndex - this.viewport.leftIndex;\n                    }\n                    var trgt = this.getColumnHeaderContent().getElementsByClassName('e-header-cell')[colIndex];\n                    var eleWidth = parseInt(this.getMainContent().getElementsByTagName('col')[colIndex].style.width, 10);\n                    var threshold = parseInt(colWidth, 10) - eleWidth;\n                    if (threshold < 0 && eleWidth < -(threshold)) {\n                        getCellIndexes(sheet.activeCell);\n                        threshold = -eleWidth;\n                    }\n                    var oldIdx = parseInt(trgt.getAttribute('aria-colindex'), 10) - 1;\n                    if (this.getActiveSheet() === sheet) {\n                        this.notify(colWidthChanged, { threshold: threshold, colIdx: oldIdx });\n                        setResize(colIndex, colWidth, true, this);\n                    }\n                }\n                else {\n                    var oldWidth = getColumnWidth(sheet, colIndex);\n                    var threshold = void 0;\n                    if (parseInt(colWidth, 10) > 0) {\n                        threshold = -(oldWidth - parseInt(colWidth, 10));\n                    }\n                    else {\n                        threshold = -oldWidth;\n                    }\n                    this.notify(colWidthChanged, { threshold: threshold, colIdx: colIndex });\n                }\n            }\n            getColumn(sheet, mIndex).width = parseInt(colWidth, 10) > 0 ? parseInt(colWidth, 10) : 0;\n            sheet.columns[mIndex].customWidth = true;\n        }\n    };\n    /**\n     * Set the height of row.\n     * @param {number} height? - Specifies height needs to be updated. If not specified, it will set the default height 20.\n     * @param {number} rowIndex? - Specifies the row index. If not specified, it will consider the first row.\n     * @param {number} sheetIndex? - Specifies the sheetIndex. If not specified, it will consider the active sheet.\n     * {% codeBlock src='spreadsheet/setRowHeight/index.md' %}{% endcodeBlock %}\n     */\n    Spreadsheet.prototype.setRowHeight = function (height, rowIndex, sheetIndex, edited) {\n        if (height === void 0) { height = 20; }\n        if (rowIndex === void 0) { rowIndex = 0; }\n        var sheet = isNullOrUndefined(sheetIndex) ? this.getActiveSheet() : this.sheets[sheetIndex - 1];\n        if (sheet) {\n            var mIndex = rowIndex;\n            var rowHeight = (typeof height === 'number') ? height + 'px' : height;\n            rowIndex = isNullOrUndefined(rowIndex) ? getCellIndexes(sheet.activeCell)[0] : rowIndex;\n            if (sheet === this.getActiveSheet()) {\n                if (rowIndex <= this.viewport.bottomIndex && rowIndex >= this.viewport.topIndex) {\n                    if (this.scrollSettings.enableVirtualization) {\n                        rowIndex = rowIndex - this.viewport.topIndex;\n                    }\n                    var trgt = this.getRowHeaderContent().getElementsByClassName('e-header-cell')[rowIndex];\n                    var eleHeight = parseInt(this.getMainContent().getElementsByTagName('tr')[rowIndex].style.height, 10);\n                    var threshold = parseInt(rowHeight, 10) - eleHeight;\n                    if (threshold < 0 && eleHeight < -(threshold)) {\n                        threshold = -eleHeight;\n                    }\n                    var oldIdx = parseInt(trgt.parentElement.getAttribute('aria-rowindex'), 10) - 1;\n                    if (this.getActiveSheet() === sheet) {\n                        this.notify(rowHeightChanged, { threshold: threshold, rowIdx: oldIdx });\n                        if (isNullOrUndefined(edited)) {\n                            edited = false;\n                        }\n                        if (!edited) {\n                            setResize(rowIndex, rowHeight, false, this);\n                            edited = false;\n                        }\n                    }\n                }\n                else {\n                    var oldHeight = getRowHeight(sheet, rowIndex);\n                    var threshold = void 0;\n                    if (parseInt(rowHeight, 10) > 0) {\n                        threshold = -(oldHeight - parseInt(rowHeight, 10));\n                    }\n                    else {\n                        threshold = -oldHeight;\n                    }\n                    this.notify(rowHeightChanged, { threshold: threshold, rowIdx: rowIndex });\n                }\n            }\n            setRowHeight(sheet, mIndex, parseInt(rowHeight, 10) > 0 ? parseInt(rowHeight, 10) : 0);\n            sheet.rows[mIndex].customHeight = true;\n        }\n    };\n    /**\n     * This method is used to autofit the range of rows or columns\n     * @param {string} range - range that needs to be autofit.\n     *\n     * ```html\n     * <div id='Spreadsheet'></div>\n     * ```\n     * ```typescript\n     * let spreadsheet = new Spreadsheet({\n     *      allowResizing: true\n     * ...\n     * }, '#Spreadsheet');\n     * spreadsheet.autoFit('A:D'); // Auto fit from A to D columns\n     * Spreadsheet.autoFit('1:4'); // Auto fit from 1 to 4 rows\n     *\n     * ```\n     * {% codeBlock src='spreadsheet/autoFit/index.md' %}{% endcodeBlock %}\n     */\n    Spreadsheet.prototype.autoFit = function (range) {\n        var values = this.getIndexes(range);\n        var startIdx = values.startIdx;\n        var endIdx = values.endIdx;\n        var isCol = values.isCol;\n        var maximumColInx = isCol ? getColIndex('XFD') : 1048576;\n        if (startIdx <= maximumColInx) {\n            if (endIdx > maximumColInx) {\n                endIdx = maximumColInx;\n            }\n        }\n        else {\n            return;\n        }\n        for (startIdx; startIdx <= endIdx; startIdx++) {\n            this.notify(setAutoFit, { idx: startIdx, isCol: isCol });\n        }\n    };\n    /** @hidden */\n    Spreadsheet.prototype.getIndexes = function (range) {\n        var startIsCol;\n        var endIsCol;\n        var start;\n        var end;\n        var isCol;\n        if (range.indexOf(':') !== -1) {\n            var starttoend = range.split(':');\n            start = starttoend[0];\n            end = starttoend[1];\n        }\n        else {\n            start = range;\n            end = range;\n        }\n        if (!isNullOrUndefined(start)) {\n            var startValues = this.getAddress(start);\n            start = startValues.address;\n            startIsCol = startValues.isCol;\n        }\n        if (!isNullOrUndefined(end)) {\n            var endValues = this.getAddress(end);\n            end = endValues.address;\n            endIsCol = endValues.isCol;\n        }\n        isCol = startIsCol === true && endIsCol === true ? true : false;\n        var startIdx = isCol ? getColIndex(start.toUpperCase()) : parseInt(start, 10);\n        var endIdx = isCol ? getColIndex(end.toUpperCase()) : parseInt(end, 10);\n        return { startIdx: startIdx, endIdx: endIdx, isCol: isCol };\n    };\n    Spreadsheet.prototype.getAddress = function (address) {\n        var isCol;\n        if (address.substring(0, 1).match(/\\D/g)) {\n            isCol = true;\n            address = address.replace(/[0-9]/g, '');\n            return { address: address, isCol: isCol };\n        }\n        else if (address.substring(0, 1).match(/[0-9]/g) && address.match(/\\D/g)) {\n            return { address: '', isCol: false };\n        }\n        else {\n            address = (parseInt(address, 10) - 1).toString();\n            return { address: address, isCol: isCol };\n        }\n    };\n    /**\n     * To add the hyperlink in the cell\n     * @param {string | HyperlinkModel} hyperlink\n     * @param {string} address\n     * {% codeBlock src='spreadsheet/addHyperlink/index.md' %}{% endcodeBlock %}\n     */\n    Spreadsheet.prototype.addHyperlink = function (hyperlink, address) {\n        this.insertHyperlink(hyperlink, address, '', true);\n    };\n    /**\n     * To remove the hyperlink in the cell\n     * @param {string} range\n     * {% codeBlock src='spreadsheet/removeHyperlink/index.md' %}{% endcodeBlock %}\n     */\n    Spreadsheet.prototype.removeHyperlink = function (range) {\n        var rangeArr;\n        var sheet = this.getActiveSheet();\n        var sheetIdx;\n        if (range && range.indexOf('!') !== -1) {\n            rangeArr = range.split('!');\n            var sheets = this.sheets;\n            for (var idx = 0; idx < sheets.length; idx++) {\n                if (sheets[idx].name === rangeArr[0]) {\n                    sheetIdx = idx;\n                }\n            }\n            sheet = this.sheets[sheetIdx];\n            range = rangeArr[1];\n        }\n        var rangeIndexes = range ? getRangeIndexes(range) : getRangeIndexes(this.getActiveSheet().activeCell);\n        var cellMod;\n        for (var rowIdx = rangeIndexes[0]; rowIdx <= rangeIndexes[2]; rowIdx++) {\n            for (var colIdx = rangeIndexes[1]; colIdx <= rangeIndexes[3]; colIdx++) {\n                if (sheet && sheet.rows[rowIdx] && sheet.rows[rowIdx].cells[colIdx]) {\n                    cellMod = sheet.rows[rowIdx].cells[colIdx];\n                    if (cellMod) {\n                        if (typeof (cellMod.hyperlink) === 'string') {\n                            cellMod.value = cellMod.value ? cellMod.value : cellMod.hyperlink;\n                        }\n                        else {\n                            cellMod.value = cellMod.value ? cellMod.value : cellMod.hyperlink.address;\n                        }\n                        delete (cellMod.hyperlink);\n                        if (sheet === this.getActiveSheet()) {\n                            var eleRowIdx = void 0;\n                            var eleColIdx = void 0;\n                            if (this.scrollSettings.enableVirtualization) {\n                                eleRowIdx = rowIdx - this.viewport.topIndex;\n                                eleColIdx = colIdx - this.viewport.leftIndex;\n                            }\n                            var cell = this.element.getElementsByClassName('e-sheet-content')[0].\n                                getElementsByClassName('e-row')[eleRowIdx].getElementsByClassName('e-cell')[eleColIdx];\n                            if (cell.getElementsByClassName('e-hyperlink')[0]) {\n                                cell.innerText = cell.getElementsByClassName('e-hyperlink')[0].innerHTML;\n                            }\n                        }\n                    }\n                }\n            }\n        }\n    };\n    /** @hidden */\n    Spreadsheet.prototype.insertHyperlink = function (hyperlink, address, displayText, isMethod) {\n        if (this.allowHyperlink) {\n            var value = void 0;\n            var addrRange = void 0;\n            var sheetIdx = void 0;\n            var cellIdx = void 0;\n            var sheet = this.getActiveSheet();\n            var isEmpty = void 0;\n            address = address ? address : this.getActiveSheet().activeCell;\n            var befArgs = { hyperlink: hyperlink, cell: address, cancel: false };\n            var aftArgs = { hyperlink: hyperlink, cell: address };\n            if (!isMethod) {\n                this.trigger(beforeHyperlinkCreate, befArgs);\n            }\n            if (!befArgs.cancel) {\n                hyperlink = befArgs.hyperlink;\n                address = befArgs.cell;\n                _super.prototype.addHyperlink.call(this, hyperlink, address);\n                if (address && address.indexOf('!') !== -1) {\n                    addrRange = address.split('!');\n                    var sheets = this.sheets;\n                    for (var idx = 0; idx < sheets.length; idx++) {\n                        if (sheets[idx].name === addrRange[0]) {\n                            sheetIdx = idx;\n                        }\n                    }\n                    sheet = this.sheets[sheetIdx];\n                    address = addrRange[1];\n                }\n                if (!sheet) {\n                    return;\n                }\n                address = address ? address : this.getActiveSheet().activeCell;\n                cellIdx = getRangeIndexes(address);\n                if (typeof (hyperlink) === 'string') {\n                    value = hyperlink;\n                }\n                else {\n                    value = hyperlink.address;\n                }\n                var mCell = sheet.rows[cellIdx[0]].cells[cellIdx[1]];\n                if (isNullOrUndefined(mCell.value) || mCell.value === '') {\n                    isEmpty = true;\n                }\n                if (!isMethod) {\n                    this.trigger(afterHyperlinkCreate, aftArgs);\n                }\n                if (sheet === this.getActiveSheet()) {\n                    this.serviceLocator.getService('cell').refreshRange(cellIdx);\n                }\n            }\n        }\n    };\n    /**\n     * This method is used to add data validation.\n     * @param {ValidationModel} rules - specifies the validation rules.\n     * @param {string} range - range that needs to be add validation.\n     * {% codeBlock src='spreadsheet/addDataValidation/index.md' %}{% endcodeBlock %}\n     */\n    Spreadsheet.prototype.addDataValidation = function (rules, range) {\n        _super.prototype.addDataValidation.call(this, rules, range);\n    };\n    /**\n     * This method is used for remove validation.\n     * @param {string} range - range that needs to be remove validation.\n     * {% codeBlock src='spreadsheet/removeDataValidation/index.md' %}{% endcodeBlock %}\n     */\n    Spreadsheet.prototype.removeDataValidation = function (range) {\n        _super.prototype.removeDataValidation.call(this, range);\n    };\n    /**\n     * This method is used to highlight the invalid data.\n     * @param {string} range - range that needs to be highlight the invalid data.\n     * {% codeBlock src='spreadsheet/addInvalidHighlight/index.md' %}{% endcodeBlock %}\n     */\n    Spreadsheet.prototype.addInvalidHighlight = function (range) {\n        _super.prototype.addInvalidHighlight.call(this, range);\n    };\n    /**\n     * This method is used for remove highlight from invalid data.\n     * @param {string} range - range that needs to be remove invalid highlight.\n     * {% codeBlock src='spreadsheet/removeInvalidHighlight/index.md' %}{% endcodeBlock %}\n     */\n    Spreadsheet.prototype.removeInvalidHighlight = function (range) {\n        _super.prototype.removeInvalidHighlight.call(this, range);\n    };\n    /**\n     * This method is used to add conditional formatting.\n     * @param  {string} type - Conditional formatting HighlightCell, TopBottom, DataBar, ColorScale, IconSet Type.\n     * HighlightCell- 'GreaterThan' | 'LessThan' | 'Between' | 'EqualTo' | 'ContainsText' | 'DateOccur' | 'Duplicate' | 'Unique',\n     * TopBottom - 'Top10Items' | 'Bottom10Items' | 'Top10Percentage' | 'Bottom10Percentage' | 'BelowAverage' | 'AboveAverage',\n     * DataBar - 'BlueDataBar' | 'GreenDataBar' | 'RedDataBar' | 'OrangeDataBar' | 'LightBlueDataBar' | 'PurpleDataBar',\n     * ColorScale - 'GYRColorScale' | 'RYGColorScale' | 'GWRColorScale' | 'RWGColorScale' | 'BWRColorScale' | 'RWBColorScale' |\n     * 'WRColorScale' | 'RWColorScale' | 'GWColorScale' | 'WGColorScale' | 'GYColorScale' | 'YGColorScale',\n     * IconSet - 'ThreeArrows' | 'ThreeArrowsGray' | 'FourArrowsGray' | 'FourArrows' | 'FiveArrowsGray' | 'FiveArrows' |\n     * 'ThreeTrafficLights1' | 'ThreeTrafficLights2' | 'ThreeSigns' | 'FourTrafficLights' | 'FourRedToBlack' | 'ThreeSymbols' |\n     * 'ThreeSymbols2' | 'ThreeFlags' | 'FourRating' | 'FiveQuarters' | 'FiveRating' | 'ThreeTriangles' | 'ThreeStars' | 'FiveBoxes';\n     * @param  {string} cFColor - Pass the cFcolor to set the conditional formatting.\n     * CFColor - 'RedFT' | 'YellowFT' | 'GreenFT' | 'RedF' | 'RedT'.\n     * @param  {string} value - Pass the value to set the conditional formatting.\n     * @param  {string} range - Pass the range to set the conditional formatting.\n     * {% codeBlock src='spreadsheet/conditionalFormat/index.md' %}{% endcodeBlock %}\n     */\n    Spreadsheet.prototype.conditionalFormat = function (conditionalFormat) {\n        _super.prototype.conditionalFormat.call(this, conditionalFormat);\n    };\n    /**\n     * This method is used for remove conditional formatting.\n     * @param {string} range - range that needs to be remove conditional formatting.\n     * {% codeBlock src='spreadsheet/clearConditionalFormat/index.md' %}{% endcodeBlock %}\n     */\n    Spreadsheet.prototype.clearConditionalFormat = function (range) {\n        range = range || this.getActiveSheet().selectedRange;\n        _super.prototype.clearConditionalFormat.call(this, range);\n    };\n    /** @hidden */\n    Spreadsheet.prototype.setPanelSize = function () {\n        if (this.height !== 'auto') {\n            var panel = document.getElementById(this.element.id + '_sheet_panel');\n            panel.style.height = this.element.getBoundingClientRect().height - getSiblingsHeight(panel) + \"px\";\n        }\n    };\n    /**\n     * Opens the Excel file.\n     * @param {OpenOptions} options - Options for opening the excel file.\n     * {% codeBlock src='spreadsheet/open/index.md' %}{% endcodeBlock %}\n     */\n    Spreadsheet.prototype.open = function (options) {\n        this.isOpen = true;\n        _super.prototype.open.call(this, options);\n        if (this.isOpen) {\n            this.showSpinner();\n        }\n    };\n    /** @hidden */\n    Spreadsheet.prototype.hideRow = function (startIndex, endIndex, hide) {\n        if (endIndex === void 0) { endIndex = startIndex; }\n        if (hide === void 0) { hide = true; }\n        if (this.renderModule) {\n            this.notify(hideShow, { startIndex: startIndex, endIndex: endIndex, hide: hide });\n        }\n        else {\n            _super.prototype.hideRow.call(this, startIndex, endIndex, hide);\n        }\n    };\n    /** @hidden */\n    Spreadsheet.prototype.hideColumn = function (startIndex, endIndex, hide) {\n        if (endIndex === void 0) { endIndex = startIndex; }\n        if (hide === void 0) { hide = true; }\n        if (this.renderModule) {\n            this.notify(hideShow, { startIndex: startIndex, endIndex: endIndex, hide: hide, isCol: true });\n        }\n        else {\n            _super.prototype.hideColumn.call(this, startIndex, endIndex, hide);\n        }\n    };\n    /**\n     * This method is used to Clear contents, formats and hyperlinks in spreadsheet.\n     *    * @param {ClearOptions} options - Options for clearing the content, formats and hyperlinks in spreadsheet.\n     * {% codeBlock src='spreadsheet/clear/index.md' %}{% endcodeBlock %}\n     */\n    Spreadsheet.prototype.clear = function (options) {\n        this.notify(clearViewer, { options: options, isPublic: true });\n    };\n    /**\n     * Used to refresh the spreadsheet.\n     * @param {boolean} isNew - Specifies `true` / `false` to create new workbook in spreadsheet.\n     * @returns void\n     * {% codeBlock src='spreadsheet/refresh/index.md' %}{% endcodeBlock %}\n     */\n    Spreadsheet.prototype.refresh = function (isNew) {\n        if (this[isReact]) {\n            this[clearTemplate]();\n        }\n        (isNew) ? this.notify(blankWorkbook, {}) : _super.prototype.refresh.call(this);\n    };\n    /**\n     * Used to set the image in spreadsheet.\n     * @param {ImageModel} images - Specifies the options to insert image in spreadsheet.\n     * @param {string} range - Specifies the range in spreadsheet.\n     * @returns void\n     */\n    Spreadsheet.prototype.insertImage = function (images, range) {\n        var i;\n        for (i = 0; i < images.length; i++) {\n            this.notify(createImageElement, {\n                options: images[i],\n                range: range ? range : this.getActiveSheet().selectedRange, isPublic: true\n            });\n        }\n    };\n    /**\n     * Used to delete the image in spreadsheet.\n     * @param {string} id - Specifies the id of the image element to be deleted.\n     * @param {string} range - Specifies the range in spreadsheet.\n     * @returns void\n     */\n    Spreadsheet.prototype.deleteImage = function (id, range) {\n        this.notify(deleteImage, { id: id, range: range ? range : this.getActiveSheet().selectedRange });\n    };\n    /**\n     * Gets the row header div of the Spreadsheet.\n     * @return {Element}\n     * @hidden\n     */\n    Spreadsheet.prototype.getRowHeaderContent = function () {\n        return this.sheetModule.getRowHeaderPanel();\n    };\n    /**\n     * Gets the column header div of the Spreadsheet.\n     * @return {Element}\n     * @hidden\n     */\n    Spreadsheet.prototype.getColumnHeaderContent = function () {\n        return this.sheetModule.getColHeaderPanel();\n    };\n    /**\n     * Gets the main content div of the Spreadsheet.\n     * @return {Element}\n     * @hidden\n     */\n    Spreadsheet.prototype.getMainContent = function () {\n        return this.sheetModule.getContentPanel();\n    };\n    /**\n     * Get the main content table element of spreadsheet.\n     * @return {HTMLTableElement}\n     * @hidden\n     */\n    Spreadsheet.prototype.getContentTable = function () {\n        return this.sheetModule.getContentTable();\n    };\n    /**\n     * Get the row header table element of spreadsheet.\n     * @return {HTMLTableElement}\n     * @hidden\n     */\n    Spreadsheet.prototype.getRowHeaderTable = function () {\n        return this.sheetModule.getRowHeaderTable();\n    };\n    /**\n     * Get the column header table element of spreadsheet.\n     * @return {HTMLTableElement}\n     * @hidden\n     */\n    Spreadsheet.prototype.getColHeaderTable = function () {\n        return this.sheetModule.getColHeaderTable();\n    };\n    /**\n     * To get the backup element count for row and column virtualization.\n     * @hidden\n     */\n    Spreadsheet.prototype.getThreshold = function (layout) {\n        var threshold = Math.round((this.viewport[layout + 'Count'] + 1) / 2);\n        return threshold < 15 ? 15 : threshold;\n    };\n    /** @hidden */\n    Spreadsheet.prototype.isMobileView = function () {\n        return ((this.cssClass.indexOf('e-mobile-view') > -1 || Browser.isDevice) && this.cssClass.indexOf('e-desktop-view') === -1)\n            && false;\n    };\n    /** @hidden */\n    Spreadsheet.prototype.getValueRowCol = function (sheetIndex, rowIndex, colIndex) {\n        var val = _super.prototype.getValueRowCol.call(this, sheetIndex, rowIndex, colIndex);\n        return val;\n    };\n    /**\n     * To update a cell properties.\n     * @param {CellModel} cell - Cell properties.\n     * @param {string} address - Address to update.\n     */\n    Spreadsheet.prototype.updateCell = function (cell, address) {\n        address = address || this.getActiveSheet().activeCell;\n        _super.prototype.updateCell.call(this, cell, address);\n        this.serviceLocator.getService('cell').refreshRange(getIndexesFromAddress(address));\n        this.notify(activeCellChanged, null);\n    };\n    /**\n     * Sorts the range of cells in the active sheet.\n     * @param sortOptions - options for sorting.\n     * @param range - address of the data range.\n     * {% codeBlock src='spreadsheet/sort/index.md' %}{% endcodeBlock %}\n     */\n    Spreadsheet.prototype.sort = function (sortOptions, range) {\n        var _this = this;\n        if (!this.allowSorting) {\n            return Promise.reject();\n        }\n        return _super.prototype.sort.call(this, sortOptions, range).then(function (args) {\n            _this.notify(sortComplete, args);\n            return Promise.resolve(args);\n        });\n    };\n    /** @hidden */\n    Spreadsheet.prototype.setValueRowCol = function (sheetIndex, value, rowIndex, colIndex) {\n        if (value === 'circular reference: ') {\n            var circularArgs = {\n                action: 'isCircularReference', argValue: value\n            };\n            this.notify(formulaOperation, circularArgs);\n            value = circularArgs.argValue;\n        }\n        _super.prototype.setValueRowCol.call(this, sheetIndex, value, rowIndex, colIndex);\n        sheetIndex = getSheetIndexFromId(this, sheetIndex);\n        this.notify(editOperation, {\n            action: 'refreshDependentCellValue', rowIdx: rowIndex, colIdx: colIndex,\n            sheetIdx: sheetIndex\n        });\n    };\n    /**\n     * Get component name.\n     * @returns string\n     * @hidden\n     */\n    Spreadsheet.prototype.getModuleName = function () {\n        return 'spreadsheet';\n    };\n    /** @hidden */\n    Spreadsheet.prototype.refreshNode = function (td, args) {\n        var value;\n        if (td) {\n            var spanElem = select('#' + this.element.id + '_currency', td);\n            var alignClass = 'e-right-align';\n            if (args) {\n                args.result = isNullOrUndefined(args.result) ? '' : args.result.toString();\n                if (spanElem) {\n                    detach(spanElem);\n                }\n                if (args.type === 'Accounting' && isNumber(args.value)) {\n                    if (td.querySelector('a')) {\n                        td.querySelector('a').textContent = args.result.split(args.curSymbol).join('');\n                    }\n                    else {\n                        td.innerHTML = '';\n                    }\n                    td.appendChild(this.createElement('span', {\n                        id: this.element.id + '_currency',\n                        innerHTML: \"\" + args.curSymbol,\n                        styles: 'float: left'\n                    }));\n                    if (!td.querySelector('a')) {\n                        td.innerHTML += args.result.split(args.curSymbol).join('');\n                    }\n                    td.classList.add(alignClass);\n                    return;\n                }\n                else {\n                    if (args.result && (args.result.toLowerCase() === 'true' || args.result.toLowerCase() === 'false')) {\n                        args.result = args.result.toUpperCase();\n                        alignClass = 'e-center-align';\n                        args.isRightAlign = true; // Re-use this to center align the cell.\n                    }\n                    value = args.result;\n                }\n                args.isRightAlign ? td.classList.add(alignClass) : td.classList.remove(alignClass);\n            }\n            value = !isNullOrUndefined(value) ? value : '';\n            if (!isNullOrUndefined(td)) {\n                var node = td.lastChild;\n                if (td.querySelector('.e-hyperlink')) {\n                    node = td.querySelector('.e-hyperlink').lastChild;\n                }\n                if (node && (node.nodeType === 3 || node.nodeType === 1)) {\n                    node.nodeValue = value;\n                }\n                else {\n                    td.appendChild(document.createTextNode(value));\n                }\n            }\n        }\n    };\n    /** @hidden */\n    Spreadsheet.prototype.calculateHeight = function (style, lines, borderWidth) {\n        if (lines === void 0) { lines = 1; }\n        if (borderWidth === void 0) { borderWidth = 1; }\n        var fontSize = (style && style.fontSize) || this.cellStyle.fontSize;\n        var threshold = style.fontFamily === 'Arial Black' ? 1.44 : 1.24;\n        return ((fontSize.indexOf('pt') > -1 ? parseInt(fontSize, 10) * 1.33 : parseInt(fontSize, 10)) * threshold * lines) +\n            (borderWidth * threshold);\n    };\n    /** @hidden */\n    Spreadsheet.prototype.skipHidden = function (startIdx, endIdx, layout) {\n        if (layout === void 0) { layout = 'rows'; }\n        var sheet = this.getActiveSheet();\n        var totalCount;\n        if (this.scrollSettings.isFinite) {\n            totalCount = (layout === 'rows' ? sheet.rowCount : sheet.colCount) - 1;\n        }\n        for (var i = startIdx; i <= endIdx; i++) {\n            if ((sheet[layout])[i] && (sheet[layout])[i].hidden) {\n                if (startIdx === i) {\n                    startIdx++;\n                }\n                endIdx++;\n                if (totalCount && endIdx > totalCount) {\n                    endIdx = totalCount;\n                    break;\n                }\n            }\n        }\n        return [startIdx, endIdx];\n    };\n    /** @hidden */\n    Spreadsheet.prototype.updateActiveBorder = function (nextTab, selector) {\n        if (selector === void 0) { selector = '.e-ribbon'; }\n        var indicator = select(selector + \" .e-tab-header .e-indicator\", this.element);\n        indicator.style.display = 'none';\n        setStyleAttribute(indicator, { 'left': '', 'right': '' });\n        setStyleAttribute(indicator, {\n            'left': nextTab.offsetLeft + 'px', 'right': nextTab.parentElement.offsetWidth - (nextTab.offsetLeft + nextTab.offsetWidth) + 'px'\n        });\n        indicator.style.display = '';\n    };\n    /** @hidden */\n    Spreadsheet.prototype.skipHiddenSheets = function (index, initIdx, hiddenCount) {\n        if (hiddenCount === void 0) { hiddenCount = 0; }\n        if (this.sheets[index] && this.sheets[index].state !== 'Visible') {\n            if (initIdx === undefined) {\n                initIdx = index;\n            }\n            if (index && index + 1 === this.sheets.length) {\n                index = initIdx - 1;\n            }\n            else {\n                index < initIdx ? index-- : index++;\n            }\n            index = this.skipHiddenSheets(index, initIdx, ++hiddenCount);\n        }\n        if (hiddenCount === this.sheets.length) {\n            this.setSheetPropertyOnMute(this.sheets[0], 'state', 'Visible');\n            return 0;\n        }\n        return index;\n    };\n    /**\n     * To perform the undo operation in spreadsheet.\n     * {% codeBlock src='spreadsheet/undo/index.md' %}{% endcodeBlock %}\n     */\n    Spreadsheet.prototype.undo = function () {\n        this.notify(performUndoRedo, { isUndo: true, isPublic: true });\n    };\n    /**\n     * To perform the redo operation in spreadsheet.\n     * {% codeBlock src='spreadsheet/redo/index.md' %}{% endcodeBlock %}\n     */\n    Spreadsheet.prototype.redo = function () {\n        this.notify(performUndoRedo, { isUndo: false, isPublic: true });\n    };\n    /**\n     * To update the undo redo collection in spreadsheet.\n     * @param {object} args - options for undo redo.\n     * {% codeBlock src='spreadsheet/updateUndoRedoCollection/index.md' %}{% endcodeBlock %}\n     */\n    Spreadsheet.prototype.updateUndoRedoCollection = function (args) {\n        this.notify(updateUndoRedoCollection, { args: args, isPublic: true });\n    };\n    /**\n     * Adds the defined name to the Spreadsheet.\n     * @param {DefineNameModel} definedName - Specifies the name.\n     * @return {boolean} - Return the added status of the defined name.\n     */\n    Spreadsheet.prototype.addDefinedName = function (definedName) {\n        var eventArgs = {\n            action: 'addDefinedName',\n            isAdded: false,\n            definedName: definedName\n        };\n        this.notify(formulaOperation, eventArgs);\n        return eventArgs.isAdded;\n    };\n    /**\n     * Removes the defined name from the Spreadsheet.\n     * @param {string} definedName - Specifies the name.\n     * @param {string} scope - Specifies the scope of the defined name.\n     * @return {boolean} - Return the removed status of the defined name.\n     */\n    Spreadsheet.prototype.removeDefinedName = function (definedName, scope) {\n        return _super.prototype.removeDefinedName.call(this, definedName, scope);\n    };\n    Spreadsheet.prototype.mouseClickHandler = function (e) {\n        this.notify(click, e);\n    };\n    Spreadsheet.prototype.mouseDownHandler = function (e) {\n        this.notify(mouseDown, e);\n    };\n    Spreadsheet.prototype.keyUpHandler = function (e) {\n        if (closest(e.target, '.e-find-dlg')) {\n            this.notify(findKeyUp, e);\n        }\n        else {\n            this.notify(keyUp, e);\n        }\n    };\n    Spreadsheet.prototype.keyDownHandler = function (e) {\n        if (!closest(e.target, '.e-findtool-dlg')) {\n            this.notify(keyDown, e);\n        }\n    };\n    /**\n     * Binding events to the element while component creation.\n     */\n    Spreadsheet.prototype.wireEvents = function () {\n        EventHandler.add(this.element, 'click', this.mouseClickHandler, this);\n        EventHandler.add(this.element, getStartEvent(), this.mouseDownHandler, this);\n        EventHandler.add(this.element, 'keyup', this.keyUpHandler, this);\n        EventHandler.add(this.element, 'keydown', this.keyDownHandler, this);\n        EventHandler.add(this.element, 'noderefresh', this.refreshNode, this);\n    };\n    /**\n     * Destroys the component (detaches/removes all event handlers, attributes, classes, and empties the component element).\n     */\n    Spreadsheet.prototype.destroy = function () {\n        if (this[isReact]) {\n            this[clearTemplate]();\n        }\n        this.unwireEvents();\n        this.notify(spreadsheetDestroyed, null);\n        _super.prototype.destroy.call(this);\n        this.element.innerHTML = '';\n        this.element.removeAttribute('tabindex');\n        this.element.removeAttribute('role');\n        this.element.style.removeProperty('height');\n        this.element.style.removeProperty('width');\n        this.element.style.removeProperty('min-height');\n        this.element.style.removeProperty('min-width');\n    };\n    /**\n     * Unbinding events from the element while component destroy.\n     */\n    Spreadsheet.prototype.unwireEvents = function () {\n        EventHandler.remove(this.element, 'click', this.mouseClickHandler);\n        EventHandler.remove(this.element, getStartEvent(), this.mouseDownHandler);\n        EventHandler.remove(this.element, 'keyup', this.keyUpHandler);\n        EventHandler.remove(this.element, 'keydown', this.keyDownHandler);\n        EventHandler.remove(this.element, 'noderefresh', this.refreshNode);\n    };\n    /**\n     * To add context menu items.\n     * @param {MenuItemModel[]} items - Items that needs to be added.\n     * @param {string} text - Item before / after that the element to be inserted.\n     * @param {boolean} insertAfter - Set `false` if the `items` need to be inserted before the `text`.\n     * By default, `items` are added after the `text`.\n     * @param {boolean} isUniqueId - Set `true` if the given `text` is a unique id.\n     * {% codeBlock src='spreadsheet/addContextMenu/index.md' %}{% endcodeBlock %}\n     */\n    Spreadsheet.prototype.addContextMenuItems = function (items, text, insertAfter, isUniqueId) {\n        if (insertAfter === void 0) { insertAfter = true; }\n        this.notify(addContextMenuItems, { items: items, text: text, insertAfter: insertAfter, isUniqueId: isUniqueId });\n    };\n    /**\n     * To remove existing context menu items.\n     * @param {string[]} items - Items that needs to be removed.\n     * @param {boolean} isUniqueId - Set `true` if the given `text` is a unique id.\n     * {% codeBlock src='spreadsheet/removeContextMenuItems/index.md' %}{% endcodeBlock %}\n     */\n    Spreadsheet.prototype.removeContextMenuItems = function (items, isUniqueId) {\n        this.notify(removeContextMenuItems, { items: items, isUniqueId: isUniqueId });\n    };\n    /**\n     * To enable / disable context menu items.\n     * @param {string[]} items - Items that needs to be enabled / disabled.\n     * @param {boolean} enable - Set `true` / `false` to enable / disable the menu items.\n     * @param {boolean} isUniqueId - Set `true` if the given `text` is a unique id.\n     * {% codeBlock src='spreadsheet/enableContextMenuItems/index.md' %}{% endcodeBlock %}\n     */\n    Spreadsheet.prototype.enableContextMenuItems = function (items, enable, isUniqueId) {\n        if (enable === void 0) { enable = true; }\n        this.notify(enableContextMenuItems, { items: items, enable: enable, isUniqueId: isUniqueId });\n    };\n    /**\n     * To enable / disable file menu items.\n     * @param {string[]} items - Items that needs to be enabled / disabled.\n     * @param {boolean} enable? - Set `true` / `false` to enable / disable the menu items.\n     * @param {boolean} isUniqueId? - Set `true` if the given file menu items `text` is a unique id.\n     * @returns void.\n     * {% codeBlock src='spreadsheet/enableFileMenuItems/index.md' %}{% endcodeBlock %}\n     */\n    Spreadsheet.prototype.enableFileMenuItems = function (items, enable, isUniqueId) {\n        if (enable === void 0) { enable = true; }\n        this.notify(enableFileMenuItems, { items: items, enable: enable, isUniqueId: isUniqueId });\n    };\n    /**\n     * To show/hide the file menu items in Spreadsheet ribbon.\n     * @param {string[]} items - Specifies the file menu items text which is to be show/hide.\n     * @param {boolean} hide? - Set `true` / `false` to hide / show the file menu items.\n     * @param {boolean} isUniqueId? - Set `true` if the given file menu items `text` is a unique id.\n     * @returns void.\n     * {% codeBlock src='spreadsheet/hideFileMenuItems/index.md' %}{% endcodeBlock %}\n     */\n    Spreadsheet.prototype.hideFileMenuItems = function (items, hide, isUniqueId) {\n        if (hide === void 0) { hide = true; }\n        this.notify(hideFileMenuItems, { items: items, hide: hide, isUniqueId: isUniqueId });\n    };\n    /**\n     * To add custom file menu items.\n     * @param {MenuItemModel[]} items - Specifies the ribbon file menu items to be inserted.\n     * @param {string} text - Specifies the existing file menu item text before / after which the new file menu items to be inserted.\n     * @param {boolean} insertAfter? - Set `false` if the `items` need to be inserted before the `text`.\n     * By default, `items` are added after the `text`.\n     * @param {boolean} isUniqueId? - Set `true` if the given file menu items `text` is a unique id.\n     * @returns void.\n     * {% codeBlock src='spreadsheet/addFileMenuItems/index.md' %}{% endcodeBlock %}\n     */\n    Spreadsheet.prototype.addFileMenuItems = function (items, text, insertAfter, isUniqueId) {\n        if (insertAfter === void 0) { insertAfter = true; }\n        this.notify(addFileMenuItems, { items: items, text: text, insertAfter: insertAfter, isUniqueId: isUniqueId });\n    };\n    /**\n     * To show/hide the existing ribbon tabs.\n     * @param {string[]} tabs - Specifies the tab header text which needs to be shown/hidden.\n     * @param {boolean} hide? - Set `true` / `false` to hide / show the ribbon tabs.\n     * @returns void.\n     * {% codeBlock src='spreadsheet/hideRibbonTabs/index.md' %}{% endcodeBlock %}\n     */\n    Spreadsheet.prototype.hideRibbonTabs = function (tabs, hide) {\n        if (hide === void 0) { hide = true; }\n        this.notify(hideRibbonTabs, { tabs: tabs, hide: hide });\n    };\n    /**\n     * To enable / disable the existing ribbon tabs.\n     * @param {string[]} tabs - Specifies the tab header text which needs to be enabled / disabled.\n     * @param {boolean} enable? - Set `true` / `false` to enable / disable the ribbon tabs.\n     * @returns void.\n     * {% codeBlock src='spreadsheet/enableRibbonTabs/index.md' %}{% endcodeBlock %}\n     */\n    Spreadsheet.prototype.enableRibbonTabs = function (tabs, enable) {\n        if (enable === void 0) { enable = true; }\n        this.notify(enableRibbonTabs, { tabs: tabs, enable: enable });\n    };\n    /**\n     * To add custom ribbon tabs.\n     * @param {RibbonItemModel[]} items - Specifies the ribbon tab items to be inserted.\n     * @param {string} insertBefore? - Specifies the existing ribbon header text before which the new tabs will be inserted.\n     * If not specified, the new tabs will be inserted at the end.\n     * @returns void.\n     * {% codeBlock src='spreadsheet/addRibbonTabs/index.md' %}{% endcodeBlock %}\n     */\n    Spreadsheet.prototype.addRibbonTabs = function (items, insertBefore) {\n        this.notify(addRibbonTabs, { items: items, insertBefore: insertBefore });\n    };\n    /**\n     * Enables or disables the specified ribbon toolbar items or all ribbon items.\n     * @param {string} tab - Specifies the ribbon tab header text under which the toolbar items need to be enabled / disabled.\n     * @param {string[]} items? - Specifies the toolbar item indexes / unique id's which needs to be enabled / disabled.\n     * If it is not specified the entire toolbar items will be enabled / disabled.\n     * @param  {boolean} enable? - Boolean value that determines whether the toolbar items should be enabled or disabled.\n     * @returns void.\n     * {% codeBlock src='spreadsheet/enableToolbarItems/index.md' %}{% endcodeBlock %}\n     */\n    Spreadsheet.prototype.enableToolbarItems = function (tab, items, enable) {\n        this.notify(enableToolbarItems, [{ tab: tab, items: items, enable: enable === undefined ? true : enable }]);\n    };\n    /**\n     * To show/hide the existing Spreadsheet ribbon toolbar items.\n     * @param {string} tab - Specifies the ribbon tab header text under which the specified items needs to be hidden / shown.\n     * @param {string[]} indexes - Specifies the toolbar indexes which needs to be shown/hidden from UI.\n     * @param {boolean} hide? - Set `true` / `false` to hide / show the toolbar items.\n     * @returns void.\n     * {% codeBlock src='spreadsheet/hideToolbarItems/index.md' %}{% endcodeBlock %}\n     */\n    Spreadsheet.prototype.hideToolbarItems = function (tab, indexes, hide) {\n        if (hide === void 0) { hide = true; }\n        this.notify(hideToolbarItems, { tab: tab, indexes: indexes, hide: hide });\n    };\n    /**\n     * To add the custom items in Spreadsheet ribbon toolbar.\n     * @param {string} tab - Specifies the ribbon tab header text under which the specified items will be inserted.\n     * @param {ItemModel[]} items - Specifies the ribbon toolbar items that needs to be inserted.\n     * @param {number} index? - Specifies the index text before which the new items will be inserted.\n     * If not specified, the new items will be inserted at the end of the toolbar.\n     * @returns void.\n     * * {% codeBlock src='spreadsheet/addToolbarItems/index.md' %}{% endcodeBlock %}\n     */\n    Spreadsheet.prototype.addToolbarItems = function (tab, items, index) {\n        this.notify(addToolbarItems, { tab: tab, items: items, index: index });\n    };\n    /**\n     * Selects the cell / range of cells with specified address.\n     * @param {string} address - Specifies the range address.\n     * {% codeBlock src='spreadsheet/selectRange/index.md' %}{% endcodeBlock %}\n     */\n    Spreadsheet.prototype.selectRange = function (address) {\n        this.notify(selectRange, { indexes: getRangeIndexes(address) });\n    };\n    /**\n     * Start edit the active cell.\n     * @return {void}\n     * {% codeBlock src='spreadsheet/startEdit/index.md' %}{% endcodeBlock %}\n     */\n    Spreadsheet.prototype.startEdit = function () {\n        this.notify(editOperation, { action: 'startEdit', isNewValueEdit: false });\n    };\n    /**\n     * Cancels the edited state, this will not update any value in the cell.\n     * @return {void}\n     * {% codeBlock src='spreadsheet/closeEdit/index.md' %}{% endcodeBlock %}\n     */\n    Spreadsheet.prototype.closeEdit = function () {\n        this.notify(editOperation, { action: 'cancelEdit' });\n    };\n    /**\n     * If Spreadsheet is in editable state, you can save the cell by invoking endEdit.\n     * @return {void}\n     * {% codeBlock src='spreadsheet/endEdit/index.md' %}{% endcodeBlock %}\n     */\n    Spreadsheet.prototype.endEdit = function () {\n        this.notify(editOperation, { action: 'endEdit' });\n    };\n    /**\n     * Called internally if any of the property value changed.\n     * @param  {SpreadsheetModel} newProp\n     * @param  {SpreadsheetModel} oldProp\n     * @returns void\n     * @hidden\n     */\n    Spreadsheet.prototype.onPropertyChanged = function (newProp, oldProp) {\n        var _this = this;\n        _super.prototype.onPropertyChanged.call(this, newProp, oldProp);\n        for (var _i = 0, _a = Object.keys(newProp); _i < _a.length; _i++) {\n            var prop = _a[_i];\n            switch (prop) {\n                case 'enableRtl':\n                    newProp.enableRtl ? document.getElementById(this.element.id + '_sheet_panel').classList.add('e-rtl') :\n                        document.getElementById(this.element.id + '_sheet_panel').classList.remove('e-rtl');\n                    break;\n                case 'cssClass':\n                    if (oldProp.cssClass) {\n                        removeClass([this.element], oldProp.cssClass.split(' '));\n                    }\n                    if (newProp.cssClass) {\n                        addClass([this.element], newProp.cssClass.split(' '));\n                    }\n                    break;\n                case 'activeSheetIndex':\n                    this.renderModule.refreshSheet();\n                    this.notify(activeSheetChanged, { idx: newProp.activeSheetIndex });\n                    break;\n                case 'width':\n                    this.setWidth();\n                    this.resize();\n                    break;\n                case 'height':\n                    this.setHeight();\n                    this.resize();\n                    break;\n                case 'showRibbon':\n                    this.notify(ribbon, { uiUpdate: true });\n                    break;\n                case 'showFormulaBar':\n                    this.notify(formulaBar, { uiUpdate: true });\n                    break;\n                case 'showSheetTabs':\n                    this.notify(sheetTabs, null);\n                    break;\n                case 'cellStyle':\n                    this.renderModule.refreshSheet();\n                    break;\n                case 'allowEditing':\n                    if (this.allowEditing) {\n                        this.notify(editOperation, { action: 'renderEditor' });\n                    }\n                    break;\n                case 'sheets':\n                    // Object.keys(newProp.sheets).forEach((sheetIdx: string): void => {\n                    // if (this.activeSheetIndex === Number(sheetIdx)) {\n                    //     if (newProp.sheets[sheetIdx].showGridLines !== undefined) {\n                    //         this.notify(updateToggleItem, { props: 'GridLines', pos: 2 });\n                    //     }\n                    //     if (newProp.sheets[sheetIdx].showHeaders !== undefined) {\n                    //         this.sheetModule.showHideHeaders();\n                    //         this.notify(updateToggleItem, { props: 'Headers', pos: 0 });\n                    //     }\n                    // }\n                    // if (newProp.sheets[sheetIdx].name !== undefined) {\n                    //     this.notify(sheetNameUpdate, {\n                    //         items: this.element.querySelector('.e-sheet-tabs-items').children[sheetIdx],\n                    //         value: newProp.sheets[sheetIdx].name,\n                    //         idx: sheetIdx\n                    //     });\n                    // }\n                    // if (newProp.sheets[sheetIdx].range) {\n                    //     this.sheets[sheetIdx].range = newProp.sheets[sheetIdx].range;\n                    Object.keys(newProp.sheets).forEach(function (sheetIdx, index) {\n                        var sheet = newProp.sheets[sheetIdx];\n                        if (sheet.ranges && Object.keys(sheet.ranges).length) {\n                            var ranges_1 = Object.keys(sheet.ranges);\n                            var newRangeIdx_1;\n                            ranges_1.forEach(function (rangeIdx, idx) {\n                                if (!sheet.ranges[rangeIdx].info) {\n                                    newRangeIdx_1 = idx;\n                                }\n                            });\n                            ranges_1.forEach(function (rangeIdx, idx) {\n                                if (sheet.ranges[rangeIdx].dataSource && (isUndefined(newRangeIdx_1)\n                                    || (!isUndefined(newRangeIdx_1) && newRangeIdx_1 === idx))) {\n                                    _this.notify(dataSourceChanged, {\n                                        sheetIdx: sheetIdx, rangeIdx: rangeIdx,\n                                        isLastRange: ranges_1.length - 1 === idx\n                                    });\n                                }\n                            });\n                        }\n                        else {\n                            if (index === 0) {\n                                _this.renderModule.refreshSheet();\n                            }\n                            if (_this.showSheetTabs && sheet.name) {\n                                _this.notify(sheetNameUpdate, {\n                                    items: _this.element.querySelector('.e-sheet-tabs-items').children[sheetIdx],\n                                    value: sheet.name,\n                                    idx: sheetIdx\n                                });\n                            }\n                        }\n                    });\n                    break;\n                case 'locale':\n                    this.refresh();\n                    break;\n            }\n        }\n    };\n    /**\n     * To provide the array of modules needed for component rendering.\n     * @return {ModuleDeclaration[]}\n     * @hidden\n     */\n    Spreadsheet.prototype.requiredModules = function () {\n        return getRequiredModules(this);\n    };\n    /**\n     * Appends the control within the given HTML Div element.\n     * @param {string | HTMLElement} selector - Target element where control needs to be appended.\n     * {% codeBlock src='spreadsheet/appendTo/index.md' %}{% endcodeBlock %}\n     */\n    Spreadsheet.prototype.appendTo = function (selector) {\n        _super.prototype.appendTo.call(this, selector);\n    };\n    /**\n     * Filters the range of cells in the sheet.\n     */\n    Spreadsheet.prototype.filter = function (filterOptions, range) {\n        if (!this.allowFiltering) {\n            return Promise.reject();\n        }\n        range = range || this.getActiveSheet().selectedRange;\n        return _super.prototype.filter.call(this, filterOptions, range);\n    };\n    /**\n     * Clears the filter changes of the sheet.\n     */\n    Spreadsheet.prototype.clearFilter = function (field) {\n        if (field) {\n            this.notify(clearFilter, { field: field });\n        }\n        else {\n            _super.prototype.clearFilter.call(this);\n        }\n    };\n    /**\n     * Applies the filter UI in the range of cells in the sheet.\n     * {% codeBlock src='spreadsheet/applyFilter/index.md' %}{% endcodeBlock %}\n     */\n    Spreadsheet.prototype.applyFilter = function (predicates, range) {\n        this.notify(initiateFilterUI, { predicates: predicates, range: range });\n    };\n    /**\n     * To add custom library function.\n     * @param {string} functionHandler - Custom function handler name\n     * @param {string} functionName - Custom function name\n     */\n    Spreadsheet.prototype.addCustomFunction = function (functionHandler, functionName) {\n        _super.prototype.addCustomFunction.call(this, functionHandler, functionName);\n        this.notify(refreshFormulaDatasource, null);\n    };\n    var Spreadsheet_1;\n    __decorate([\n        Property('')\n    ], Spreadsheet.prototype, \"cssClass\", void 0);\n    __decorate([\n        Property(true)\n    ], Spreadsheet.prototype, \"allowScrolling\", void 0);\n    __decorate([\n        Property(true)\n    ], Spreadsheet.prototype, \"allowResizing\", void 0);\n    __decorate([\n        Property(true)\n    ], Spreadsheet.prototype, \"enableClipboard\", void 0);\n    __decorate([\n        Property(true)\n    ], Spreadsheet.prototype, \"enableContextMenu\", void 0);\n    __decorate([\n        Property(true)\n    ], Spreadsheet.prototype, \"enableKeyboardNavigation\", void 0);\n    __decorate([\n        Property(true)\n    ], Spreadsheet.prototype, \"enableKeyboardShortcut\", void 0);\n    __decorate([\n        Property(true)\n    ], Spreadsheet.prototype, \"allowUndoRedo\", void 0);\n    __decorate([\n        Property(true)\n    ], Spreadsheet.prototype, \"allowWrap\", void 0);\n    __decorate([\n        Complex({}, SelectionSettings)\n    ], Spreadsheet.prototype, \"selectionSettings\", void 0);\n    __decorate([\n        Complex({}, ScrollSettings)\n    ], Spreadsheet.prototype, \"scrollSettings\", void 0);\n    __decorate([\n        Event()\n    ], Spreadsheet.prototype, \"beforeCellRender\", void 0);\n    __decorate([\n        Event()\n    ], Spreadsheet.prototype, \"beforeSelect\", void 0);\n    __decorate([\n        Event()\n    ], Spreadsheet.prototype, \"select\", void 0);\n    __decorate([\n        Event()\n    ], Spreadsheet.prototype, \"contextMenuBeforeOpen\", void 0);\n    __decorate([\n        Event()\n    ], Spreadsheet.prototype, \"fileMenuBeforeOpen\", void 0);\n    __decorate([\n        Event()\n    ], Spreadsheet.prototype, \"contextMenuBeforeClose\", void 0);\n    __decorate([\n        Event()\n    ], Spreadsheet.prototype, \"dialogBeforeOpen\", void 0);\n    __decorate([\n        Event()\n    ], Spreadsheet.prototype, \"fileMenuBeforeClose\", void 0);\n    __decorate([\n        Event()\n    ], Spreadsheet.prototype, \"contextMenuItemSelect\", void 0);\n    __decorate([\n        Event()\n    ], Spreadsheet.prototype, \"fileMenuItemSelect\", void 0);\n    __decorate([\n        Event()\n    ], Spreadsheet.prototype, \"beforeDataBound\", void 0);\n    __decorate([\n        Event()\n    ], Spreadsheet.prototype, \"dataBound\", void 0);\n    __decorate([\n        Event()\n    ], Spreadsheet.prototype, \"dataSourceChanged\", void 0);\n    __decorate([\n        Event()\n    ], Spreadsheet.prototype, \"cellEdit\", void 0);\n    __decorate([\n        Event()\n    ], Spreadsheet.prototype, \"cellEditing\", void 0);\n    __decorate([\n        Event()\n    ], Spreadsheet.prototype, \"cellSave\", void 0);\n    __decorate([\n        Event()\n    ], Spreadsheet.prototype, \"beforeCellSave\", void 0);\n    __decorate([\n        Event()\n    ], Spreadsheet.prototype, \"created\", void 0);\n    __decorate([\n        Event()\n    ], Spreadsheet.prototype, \"beforeSort\", void 0);\n    __decorate([\n        Event()\n    ], Spreadsheet.prototype, \"beforeHyperlinkCreate\", void 0);\n    __decorate([\n        Event()\n    ], Spreadsheet.prototype, \"afterHyperlinkCreate\", void 0);\n    __decorate([\n        Event()\n    ], Spreadsheet.prototype, \"beforeHyperlinkClick\", void 0);\n    __decorate([\n        Event()\n    ], Spreadsheet.prototype, \"afterHyperlinkClick\", void 0);\n    __decorate([\n        Event()\n    ], Spreadsheet.prototype, \"actionBegin\", void 0);\n    __decorate([\n        Event()\n    ], Spreadsheet.prototype, \"actionComplete\", void 0);\n    __decorate([\n        Event()\n    ], Spreadsheet.prototype, \"openComplete\", void 0);\n    __decorate([\n        Event()\n    ], Spreadsheet.prototype, \"sortComplete\", void 0);\n    Spreadsheet = Spreadsheet_1 = __decorate([\n        NotifyPropertyChanges\n    ], Spreadsheet);\n    return Spreadsheet;\n}(Workbook));\nexport { Spreadsheet };\n"],"names":["getRangeIndexes","range","cellindexes","indexes","indexOf","split","forEach","address","getCellIndexes","push","parseInt","match","getColIndex","toUpperCase","text","colIdx","i","reverse","join","length","charCodeAt","Math","pow","getCellAddress","sRow","sCol","getColumnHeaderText","getRangeAddress","isNullOrUndefined","colIndex","floor","String","fromCharCode","getIndexesFromAddress","getRangeFromAddress","getAddressFromSelectedRange","sheet","name","selectedRange","getAddressInfo","context","sIdx","getSheetIndex","getSheetNameFromAddress","activeSheetIndex","sheetIndex","indices","getSwapRange","clonedRange","slice","swap","x","y","tmp","isSingleCell","executeTaskAsync","taskFn","callbackFn","data","preventCallback","WorkerHelper","toFraction","val","strVal","toString","top_1","bottom","replace","abs","getGcd","a","b","Number","intToDate","Date","getTime","dateToInt","isTime","startDate","date","isDateTime","startDateUTC","UTC","getFullYear","getMonth","getDate","getHours","getMinutes","getSeconds","getMilliseconds","diffDays","Object","prototype","call","isNaN","valueOf","isNumber","parseFloat","toDate","intl","format","defaultDateFormats","getDefaultDateObject","availabelDateTimeFormat","dateTimeFormats","availableFormats","dObj","dateObj","isCustom","type","parseDate","_i","_a","keys","dateFormats","key","skeleton","_b","_c","time","toLocaleTimeString","_d","_e","timeFormats","getFormatFromType","code","getTypeFromFormat","getSkeletonVal","value","getModules","modules","includeBasicFormulas","member","args","getValue","nameSpace","obj","splits","j","isUndefined","setValue","keyValues","start","fromObj","undefined","getAlphalabel","col","cols","n","aCharNo","chs","getWorkbookRequiredModules","allowSave","allowOpen","allowEditing","allowNumberFormatting","allowCellFormatting","allowSorting","allowHyperlink","allowFiltering","allowFindAndReplace","allowInsert","allowDelete","allowDataValidation","allowMerge","allowImage","allowChart","checkIsFormula","isCellReference","rangeSplit","isValidCellReference","isChar","inRange","rowIdx","isLocked","cell","column","endNum","numArr","cellText","textLength","cellTextLength","substring","cellNumber","getCell","rowIndex","isInitRow","row","getRow","cells","rows","setCell","isExtend","extend","skipDefaultValue","style","defaultKey","defaultProps","fontFamily","verticalAlign","textIndent","backgroundColor","color","textAlign","fontSize","fontWeight","fontStyle","textDecoration","border","borderLeft","borderTop","borderRight","borderBottom","changedProps","propName","wrap","addressInfo","rng","getSheet","setProperties","sheets","notify","wrapEvent","getData","columnWiseData","valueOnly","Promise","resolve","reject","Map","sheetIdx","index","promise","updateSheetFromDataSource","then","getDisplayText","isDate","checkDateFormat","getValueFromFormat","cellObj","assign","colSpan","rowSpan","cell_1","len","k","len_1","formula","isHiddenRow","isHiddenCol","eventArgs","trigger","queryCellInfo","set","processIdx","model","isSheet","cnt","out_i_1","diff","_loop_1","createSheet","splice","id","getMaxSheetId","setSheetPropertyOnMute","getSheetNameCount","cellCnt_1","max","clearRange","sCIdx","eCIdx","sRIdx","eRIdx","cFDelete","idx","toLowerCase","getSheetIndexFromId","getSheetIndexByName","info","updateSelectedRange","sheetNameCount","initSheet","rowCount","colCount","topLeftCell","activeCell","selectedIndex","getMaxSelectionRange","usedRange","ranges","columns","showHeaders","showGridLines","state","maxHgts","protectSettings","selectCells","formatCells","formatRows","formatColumns","insertLink","isProtected","initRow","getSheetName","setRow","hidden","getRowHeight","height","setRowHeight","getRowsHeight","startRow","endRow","getColumn","setColumn","curColumn","getColumnWidth","skipHidden","width","customWidth","getColumnsWidth","startCol","endCol","getRequiredModules","showRibbon","showFormulaBar","showSheetTabs","enableContextMenu","selectionSettings","mode","enableKeyboardNavigation","enableKeyboardShortcut","enableClipboard","allowResizing","allowUndoRedo","allowWrap","allowConditionalFormat","pushBasicModules","getUpdateUsingRaf","fn","requestAnimationFrame","removeAllChildren","parent","firstChild","removeChild","getColGroupWidth","getScrollBarWidth","scrollAreaWidth","htmlDivNode","document","createElement","result","cssText","body","appendChild","offsetWidth","clientWidth","getSiblingsHeight","element","classList","classes","getHeightFromDirection","direction","sibling","some","contains","offsetHeight","inView","isModify","scrollSettings","enableVirtualization","topIdx","viewport","topIndex","leftIdx","leftIndex","bottomIdx","getThreshold","rightIdx","inView_1","getCellPosition","offset","left","size","top","locateElem","ele","isRtl","swapRange","cellPosition","startIndex","skipHiddenIdx","attrs","setStyleAttribute","styles","setBaseStyleAttribute","getStartEvent","Browser","isPointer","getMoveEvent","getEndEvent","isTouchStart","e","pointerType","isTouchMove","isTouchEnd","getClientX","changedTouches","clientX","getClientY","clientY","setAriaOptions","target","options","setAttribute","config","destroyComponent","component","compObj","getComponent","destroy","setResize","isCol","curEle","curEleH","curEleC","preEle","preEleH","preEleC","nxtEle","nxtEleH","getActiveSheet","getElementsByClassName","getElementsByTagName","hdrRow","getRowHeaderContent","hdrClone","cloneNode","hdrFntSize","findMaxValue","getRowHeaderTable","contentRow","getMainContent","contentClone","cntFntSize","getContentTable","fntSize","add","lineHeight","removeProperty","remove","previousElementSibling","nextElementSibling","setWidthAndHeight","nxtIndex","getAttribute","getColHeaderTable","trgt","table","prevData","isWrap","myTableDiv","className","myTable","myTr","tr","offsetWidthValue","offsetHeightValue","getBoundingClientRect","ceil","updateAction","spreadsheet","isRedo","action","sortArgs","sortOptions","cancel","initiateSort","serviceLocator","getService","refreshRange","cellEvtArgs","cellValue","updateCell","requestType","cellFormat","numberFormat","copiedInfo","isCut","cut","copiedRange","copy","paste","pastedRange","isShow","hide","setColWidth","hideColumn","hideRow","removeSheetTab","isAction","count","sheetCount","clicked","endIndex","compareVal","initiateFilterUI","predicates","delete","modelType","insertModel","end","checkCount","deletedModel","columnCellsModel","deletedCellsModel","rules","operator","value1","value2","ignoreBlank","inCellDropDown","setValidation","removeValidation","setMerge","clearViewer","isPublic","conditionalFormat","cFColor","setCFRule","clearCFRule","clearCells","conditionalFormats","cFormats","oldRange","createImageElement","src","imageData","imageHeight","imageWidth","imageId","isUndoRedo","deleteImage","getElementById","refreshImgCellObj","prevTop","currentTop","prevLeft","currentLeft","currentHeight","prevHeight","currentWidth","prevWidth","chartOptions","theme","isSeriesInRows","setChart","chart","isInitCell","posRange","deleteChart","chartOpts","chartElement","refreshChartSize","overlayEle","hasTemplate","workbook","template","startCell","setRowEleHeight","hRow","notifyRowHgtChange","prevHgt","edit","querySelector","innerHTML","actCell","splitVal","valLength","lines","getLines","cellStyle","getTextHeight","rowHeightChanged","threshold","fontSizePx","getTextWidth","parentStyle","getContext","font","measureText","colwidth","textArr","spaceWidth","txt","lWidth","cWidth","setMaxHgt","rIdx","cIdx","hgt","getMaxHgt","maxHgt","rowHgt","increase","layout","task","defaultListener","taskData","this","workerTask","workerData","initWorker","terminate","worker","URL","revokeObjectURL","workerUrl","taskBlob","Blob","getFnCode","createObjectURL","Worker","onmessage","messageFromWorker","bind","onerror","onError","postMessage","apply","message","workerCode","workerFunction","isHaveFunction","getMessageFn","getCallbackMessageFn","workbookDestroyed","dataSourceChanged","dataChanged","workbookOpen","beginSave","getFilteredCollection","saveCompleted","applyNumberFormatting","getFormattedCellObject","refreshCellElement","setCellFormat","findAllValues","textDecorationUpdate","applyCellFormat","updateUsedRange","workbookFormulaOperation","workbookEditOperation","getFormattedBarText","activeCellChanged","openSuccess","openFailure","sheetCreated","sheetsDestroyed","aggregateComputation","sortComplete","beforeHyperlinkCreate","afterHyperlinkCreate","beforeHyperlinkClick","afterHyperlinkClick","setLinkModel","initiateFilter","filterComplete","filterRangeAlert","clearAllFilter","onSave","insert","deleteAction","deleteModel","isValidation","addHighlight","findNext","findPrevious","goto","replaceHandler","replaceAllHandler","showDialog","findUndoRedo","findKeyUp","removeHighlight","protectSheetWorkBook","updateToggle","protectsheetHandler","replaceAllDialog","unprotectsheetHandler","setLockCells","applyLockCells","applyMerge","mergedRange","activeCellMergedRange","insertMerge","pasteMerge","cFInitialCheck","cFRender","clear","clearCF","setImage","initiateChart","refreshRibbonIcons","refreshChart","updateChart","deleteChartColl","focusChartBorder","WorkbookNumberFormat","localeObj","getNumericObject","locale","decimalSep","decimal","groupSep","group","addEventListener","numberFormatting","getFormattedCell","fResult","rightAlign","currencySymbol","getNumberDependable","dateEventArgs","updatedVal","processFormats","isRightAlign","curSymbol","onLoad","setUsedRange","formattedText","Internationalization","autoDetectGeneralFormat","curCode","applyNumberFormat","currencyFormat","percentageFormat","accountingFormat","shortDateFormat","longDateFormat","timeFormat","fractionFormat","scientificFormat","res","trim","findSuffix","zeros","resultSuffix","suffixLen","substr","isCustomFormat","formatArr","formatNumber","currency","shortDate","formatDate","longDate","prefix","findDecimalPlaces","toExponential","fractionResult","suffix","eIndex","decIndex","checkedDate","checkCustomDateFormat","dateArr","months","formattedBarText","beforeText","on","removeEventListener","isDestroyed","off","getModuleName","DataBind","requestedInfo","updateSheetFromDataSourceHandler","dataSourceChangedHandler","dataChangedHandler","flds","sCellIdx","remoteUrl","dataManager","sRowIdx","sColIdx","loadedInfo","_this","requestedRange","sRanges","deferred","Deferred","sRange","eRange","dataSource","DataManager","url","isLocalData","showFieldAsHeader","isEndReached","insertRowCount","this_1","initRangeInfo","getMaxCount","getLoadedInfo","unloadedRange","insertRowRange","isNotLoaded","query","Query","clone","executeQuery","requiresCount","fldLen","insertColumnRange","insertCount_1","insertRange","field","includes","item","getCellDataFromProp","checkDataForFormat","loadedRange","rangeSettingCount","unloadedArgs","pop","checkResolve","resolved","isSameRng","JSON","stringify","isLoaded","prop","hyperlink","queries","min","nos","rangeIdx","checkRangeHasChanges","showFieldAsHeader_1","indexes_1","refreshRange_1","bottomIndex","rightIndex","args_1","isAngular","changedRangeIdx","dataRange","deleteRowDetails","cellIndices","changedData","isNewRow","concat","insertType","_loop_2","fld","rangeIndex","ribbon","formulaBar","sheetTabs","refreshSheetTabs","isFormulaBarEdit","dataRefresh","initialLoad","contentLoaded","mouseDown","spreadsheetDestroyed","editOperation","formulaOperation","formulaBarOperation","click","keyUp","keyDown","onVerticalScroll","onHorizontalScroll","beforeContentLoaded","beforeVirtualContentLoaded","virtualContentLoaded","cellNavigate","mouseUpAfterSelection","selectionComplete","cMenuBeforeOpen","insertSheetTab","renameSheetTab","ribbonClick","enableToolbarItems","tabSwitch","selectRange","clearCopy","beforeDataBound","addContextMenuItems","removeContextMenuItems","enableContextMenuItems","enableFileMenuItems","hideFileMenuItems","addFileMenuItems","hideRibbonTabs","enableRibbonTabs","addRibbonTabs","addToolbarItems","hideToolbarItems","beforeRibbonCreate","colWidthChanged","beforeHeaderLoaded","onContentScroll","deInitProperties","activeSheetChanged","renameSheet","initiateCustomSort","applySort","collaborativeUpdate","hideShow","autoFit","updateToggleItem","initiateHyperlink","editHyperlink","openHyperlink","removeHyperlink","createHyperlinkElement","sheetNameUpdate","hideSheet","performUndoRedo","updateUndoRedoCollection","setActionData","getBeforeActionData","clearUndoRedoCollection","renderFilterCell","reapplyFilter","filterByCellValue","clearFilter","getFilteredColumn","completeAction","beginAction","filterCellKeyDown","getFilterRange","setAutoFit","refreshFormulaDatasource","setScrollEvent","initiateDataValidation","invalidData","protectSheet","applyProtect","protectCellFormat","gotoDlg","findDlg","findHandler","created","editAlert","setUndoRedo","enableFormulaInput","protectSelection","hiddenMerge","checkPrevMerge","checkMerge","removeDataValidation","showAggregate","initiateConditionalFormat","checkConditionalFormat","setCF","initiateFormulaReference","initiateCur","clearCellRef","editValue","addressHandle","initiateEdit","forRefSelRender","blankWorkbook","insertImage","refreshImgElem","getRowIdxFromClientY","getColIdxFromClientX","refreshChartCellObj","refreshImagePosition","updateTableWidth","focusBorder","clearChartBorder","insertChart","chartRangeSelection","isReact","renderReactTemplates","clearTemplate","WorkbookOpen","open","jsonObject","fetchSuccess","formData","FormData","file","append","requestData","method","fetch","openUrl","response","ok","json","status","statusText","catch","error","fetchFailure","isOpen","impData","parse","Workbook","updateModel","workbookModel","definedNames","isImport","SaveWorker","processSheet","Array","isArray","processSave","saveJSON","saveSettings","customParams","blob","__extends","extendStatics","d","setPrototypeOf","__proto__","p","hasOwnProperty","__","constructor","create","WorkbookSave","_super","isProcessCompleted","isFullPost","needBlobData","events.beginSave","initiateSave","saveType","fileName","updateBasicSettings","processSheets","jsonStr","getStringifyObject","basicSettings","updateSheet","getSheetLength","save","events.onSave","initiateFullPostSave","updateSaveResult","blobData","ClientFileDownload","events.saveCompleted","anchor","download","getFileNameWithExtension","href","formElem","inputElem","submit","detach","skipProp","properties","filename","fileExt","getFileExtension","lastIndexOf","CalculateCommon","ModuleLoader","loadedModules","inject","requiredModules","moduleList","reqLengthVal","clearUnusedModule","modl","moduleList_1","module","modName","isModuleLoaded","moduleObject","createInstance","memberName","getMemberName","isProperty","loadedModule","clean","classFunction","params","arrayParam","unshift","Function","moduleListName","usedModule","map","arg","removeModule_1","filter","moduleName","deleteObject","CommonErrors","FormulasErrorsStrings","BasicFormulas","formulas","formulaName","category","description","isConcat","init","addFormulaCollection","functionName","formulaCategory","libraryFormulas","fName","handler","ComputeSUM","arguments","formulaErrorStrings","invalid_arguments","orgValue","sum","argArr","argValue","cellCollection","getCellCollection","tic","getValueFromArg","getErrorStrings","trueValue","falseValue","ComputeINT","str","num","ComputeTODAY","dt","now","calculateDate","ComputeSUMPRODUCT","mulValues","startsWith","s1","col1","col2","cellRef","convertAlpha","ComputeROUNDUP","arg1","arg2","toFixed","digits","ComputeCOUNT","wrong_number_arguments","argVal","cellColl","ComputeDATE","year","month","day","days","getSerialDateFromDate","fromOADate","ComputeFLOOR","fnum","significance","argCount","splitArg","divzero","ComputeCEILING","cnum","ComputeDAY","serialNumber","dateVal","ComputeIF","condition","requires_3_args","ComputeIFERROR","arithMarker","ComputePRODUCT","parseVal","product","argsHit","rangevalue","ComputeDAYS","argsArr","endDate","toDateString","d1","d2","round","ComputeCHOOSE","cond","indexNum","ComputeSUMIF","improper_formula","computeSumIfAndAvgIf","ComputeABS","absValue","absVal","cellvalue","ComputeAVERAGE","calculateAvg","ComputeAVERAGEIF","argList","resultVal","ComputeCONCATENATE","argsList","tempStr","i_1","ComputeCONCAT","ComputeMAX","computeMinMax","ComputeMIN","ComputeRAND","random","ComputeAND","computeAndOr","ComputeOR","ComputeFIND","findText","removeTics","withinText","loc","startNum","ComputeINDEX","ref","rangeValue","rangeArr","i_2","ComputeIFS","na","ComputeCOUNTA","ComputeAVERAGEA","cellCol","parseValue","argArrs","ComputeCOUNTIF","stack","op","findWildCardValue","processLogical","ComputeSUMIFS","computeIfsFormulas","ComputeTEXT","checkArgs","argsLength","splitIndex","frtArg","scndArg","checkScndArg","s2","dTime","checkString","parseDouble","toOADate","formatChar","isH","isMFound","lastCharIndex","totalCharforM","c","getSkeleton","getDateFormat","dFormatter","ComputeCOUNTIFS","ComputeAVERAGEIFS","ComputeMATCH","lookupVal","matchType","indexVal","ComputeLOOKUP","computeLookup","ComputeVLOOKUP","computeVLookup","ComputeSUBTOTAL","ComputeRADIANS","radVal","PI","ComputeRANDBETWEEN","ComputeSLOPE","yPoints","xPoints","xPointsRange","yPointsRange","getDataCollection","sumXY","sumX2","sumX","sumY","ComputeINTERCEPT","xValues","yValues","yValuesRange","xValuesRange","ComputeLN","logValue","logVal","log","ComputeISNUMBER","ComputeROUND","numStr","digStr","mult","ComputePOWER","orgNumValue","orgPowValue","logNumValue","logPowValue","ComputeLOG","orgBaseValue","logBaseValue","LN10","ComputeTRUNC","normalizer","orgDigitValue","ComputeEXP","exp","ComputeGEOMEAN","dev","r","s","cellVal","cellsData","NaN","Parser","emptyStr","storedStringText","sheetToken","tokenAdd","tokenSubtract","tokenMultiply","tokenDivide","tokenLess","charEm","charEp","tokenGreater","tokenEqual","tokenLessEq","tokenGreaterEq","tokenNotEqual","tokenAnd","tokenEm","tokenEp","tokenOr","charAnd","charLess","charGreater","charEqual","charLessEq","charGreaterEq","charNoEqual","stringGreaterEq","stringLessEq","stringNoEqual","stringAnd","stringOr","charOr","charAdd","charSubtract","charMultiply","charDivide","fixedReference","spaceString","ignoreBracet","isError","isFormulaParsed","findNamedRange","stringsColl","tokens","charNOTop","specialSym","isFailureTriggered","fkey","isTextEmpty","getFormulaCharacter","namedRanges","storedData","checkForNamedRangeAndKeyValue","formulaString","storeStrings","indexOfAny","family","getSheetFamilyItem","grid","sheetNameToParentObject","setTokensForSheets","getSheetToken","scopedRange","checkScopedRange","markLibraryFormulas","formulaAutoCorrection","ex","exception","isForceCalculable","formulaCorrection","computeForceCalculate","invalid_expression","get","formulaText","FormulaError","mismatched_parentheses","empty_expression","parseSimple","exceptionArgs","errorMessage","getErrorLine","setStrings","arithemeticArr","logicalSym","form","firstOp","secondprevOp","secondnextOp","firstDigit","secondDigit","countDigit","isDigit","rightBracket","has","leftBracket","isUpperChar","getParseArgumentSeparator","getSheetID","v","token","sheetNameToToken","s_1","parentObject","getNamedRanges","tempString","storedString","mismatched_tics","expTokenArray","mulTokenArray","addTokenArray","mulCharArray","addCharArray","compareTokenArray","compareCharArray","expCharArray","andTokenArray","andCharArray","orCharArray","orTokenArray","parseSimpleOperators","markers","operators","right","findLeftMarker","cannot_parse","bracketCount","l","period","getParseDecimalSeparator","number_contains_2_decimal_points","getCellFrom","updateDependentCell","expression_cannot_end_with_an_operator","uFound","findRightMarker","jTemp","inbracket","noCellReference","arithMarker2","isCharacter","checkLetter","oneTokenFound","textLen","ret","bracketLevel","parseFormula","fKey","bracCount","rightParens","markNamedRanges","parenCount","leftParens","libFormula","getFunction","swapInnerParens","addParensToArgs","fSubstr","rightSides","lastIndexOfAny","oneTimeOnly","getTableRange","namerangeValue","findNextEndIndex","found","__decorate","decorators","desc","getOwnPropertyDescriptor","Reflect","decorate","defineProperty","Calculate","lFormulas","keyToRowsMap","rowsToKeyMap","emptyString","leftBrace","rightBrace","cellPrefix","treatEmptyStringAsZero","singleTic","parseDecimalSeparator","dependentCells","dependentFormulaCells","minValue","MIN_SAFE_INTEGER","maxValue","MAX_SAFE_INTEGER","categoryCollection","dependencyLevel","refreshedCells","computedValues","randomValues","isRandomVal","randCollection","errorStrings","parseArgumentSeparator","dateTime1900","isParseDecimalSeparatorChanged","isArgumentSeparatorChanged","sheetFamilyID","defaultFamilyItem","sheetFamiliesList","modelToSheetID","tokenCount","sortedSheetNames","tempSheetPlaceHolder","formulaInfoTable","oaDate","millisecondsOfaDay","parseDateTimeSeparator","moduleLoader","Calculate_1","Inject","injectedModules","parser","formulaColl","enumerable","configurable","setParseArgumentSeparator","getParseDateTimeSeparator","setTreatEmptyStringAsZero","getTreatEmptyStringAsZero","setParseDateTimeSeparator","getInjectedModules","onPropertyChanged","newProp","oldProp","charCode","resetKeys","parentObjectToToken","getDependentCells","formulaCells","addToFormulaDependentCells","cell1","getDependentFormulaCells","isSheetMember","sheetDependentCells","sheetDependentFormulaCells","getLibraryFormulas","getFormulaInfoTable","sheetFormulaInfotable","getFormula","getFormulaText","setParseDecimalSeparator","temp","bad_index","grd","isLetter","CalcSheetFamilyItem","setKeyValue","FormulaInfo","fInfo","clearFormulaDependentCells","setFormulaText","getFormulaValue","setParsedFormula","setFormulaValue","dependentFormula","dependent","arrayRemove","array","getKeyValue","fText","computeFormula","getParsedFormula","addNamedRange","sheetScopeName","removeNamedRange","arrCol","aCharValue","cellRange","sheetTokenIndex","row1","row2","parsedText","lastIndexOfq","formulatResult","fNested","nestedFormula","findLastIndexOfq","sFormula","customArgs","processNestedFormula","q","computeValue","criteria","opt","checkCriteria","criteriaRangeArray","sumRange","criteriaRange","getComputeSumIfValue","checkCrte","findMaxVal","criterias","lookupRangeArray","lookupRange","maxVal","sort","minVal","lookupValue","firstCol","secCol","lookupCol","lookupCell","lookVal","finalText","checStr1","checStr2","newIndex","compRight","compLeft","leftVal","rightVal","sumRangeVal","tempdate","last","r1","c1","c2","r2","pFormula","textName","getParentObjectCellValue","stackValue","errIndex","getValArithmetic","countValue","num1","num2","val1","val2","localeCompare","computeStoreCells","sCell","cellRanges","argArray","isCriteria","storeCell","storedCells","isCountIfs","isCountIfS","countVal","rangeLength","tempStoredCell","newCell","newCount","cellAlpha","newCellAlpha","isAvgIfs","storedCell","pText","doubleNumber","setTime","isValidMonth","tempDay","dateTime","fString","pObjCVal","f","circular_reference","dateval","cellTxt","sheetToken1","containsBoth","isAlpha","isNum","charArray","sortedSheetNamesCollection","getSortedSheetNames","textSplit","tokenToParentObject","saveCell","cValue","getParentCellValue","getValueRowCol","defineFunction","window","valueChanged","changeArgs","isCalculate","pgrid","isComputedValueChanged","isCompute","calcFamily","getRowIndex","randStrVal","setValueRowCol","getComputedValue","refresh","formulaValue","arr_1","errorStack","createSheetFamilyID","operation","countStrVal","sumCell","avgVal","countNum","registerGridAsSheet","refName","tempRef","unregisterGridAsSheet","refName1","computeExpression","parsedFormula","dispose","refreshRandValues","tokenRef","stringCollection","dCell","formulaInfo","Property","Event","NotifyPropertyChanges","Base","calcID","MIN_VALUE","calcID1","ValueChangedArgs","setRowIndex","setColIndex","WorkbookFormula","uniqueOBracket","uniqueCBracket","uniqueCSeparator","uniqueCOperator","uniquePOperator","uniqueSOperator","uniqueMOperator","uniqueDOperator","uniqueModOperator","uniqueConcateOperator","uniqueEqualOperator","uniqueExpOperator","uniqueGTOperator","uniqueLTOperator","sheetInfo","initCalculate","registerSheet","calculateInstance","performFormulaOperation","from","values","formulaCollection","collection","selectCategory","selectedList","updateSheetInfo","unRegisterSheet","autoCorrectFormula","refreshCalculate","isFormula","argumentSeparator","isAdded","addDefinedName","definedName","isRemoved","removeDefinedName","scope","initiateDefinedNames","renameUpdation","sheetId","visibleName","sheetName","length_1","sheetDeletion","refError","referenceError","addCustomFunction","functionHandler","calcValue","sheetID","refreshInsDelFormula","insertArgs","refreshNamedRange","getSheetInfo","delSheetName","rowId","colId","formulaVal","removeSheetTokenIndex","dependentCellRef","updateDataContainer","visible","savedTokens","isSheetRenamed","sheetNames","name_1","sheetData","rowData","colObj","parseSheetRef","regx","escapeRegx","RegExp","cellArgs","referenceCollection","refValue","tempArgs","lessEq","greaterEq","equal","lessOp","greaterOp","equalOp","definedname","refersTo","isLink","isValidate","visibleRefersTo","comment","checkIsNameExist","getIndexFromNameColl","calcName","formatedValues","actCellModel","actCellfrmt","countOnly","Count","Sum","Avg","Min","Max","clearFormula","startIdx","refreshFormula","diff1","nAlpha","fArg","ridx","pVal","actSheet","deleteIdxs","splitFormula","updatedFormulaVal","sheetLen","arr","markSpecialChar","isUniqueChar","getUniqueCharVal","newRange","isChanged","modelDefinedNames","definedNameCnt","WorkbookSort","initiateSortHandler","sortDescriptors","containsHeader","workbookLocale","getConstant","header","jsonData","comparerFn","sortComparer","caseSensitive","sortBy","colName","getDataRange","loopLength","sortDescriptor","order","comparer","DataUtil","fnSort","caseOptions","sensitivity","collator","Intl","Collator","compare","WorkbookFilter","filterRange","initiateFilterHandler","clearAllFilterHandler","filterOptions","datasource","setFilter","filterEventArgs","address_1","where","Predicate","and","result_1","executeLocal","WorkbookImage","oldImgData","imgRange","imgData","image","WorkbookChart","setChartHandler","refreshChartData","isPaste","chartCount","isIdAvailabe","idAvailable","option","dataSheetIdx","chartColl","charts","isInRange","rangeSheetIdx","chartCnt","sheetCnt","chartObj","excelFilter","chartEle","closest","isRefresh","overlayElement","WorkbookCellFormat","triggerEvent","onActionUpdate","borderType","setTypedBorder","checkAdjustantBorder","checkFullBorder","setCellBorder","setBottomBorderPriority","isFullBorder","setFullBorder","setCellStyle","lastCell","isHeightCheckNeeded","manualUpdate","refreshRibbon","pIdx","skipHiddenRows","getCellStyleValue","bottomPriority","actionUpdate","style_1","textDecorationActionUpdate","changedStyle","changedValue","activeCellIndexes","removeProp","prevBorder","first","clearCellObj","eColIdx","clrRange","eRowIdx","WorkbookEdit","performEditOperation","updateCellValue","isValueOnly","checkDecimalPoint","parseIntValue","test","WorkbookHyperlink","setLinkHandler","cellIdx","cellAddr","WorkbookInsert","mergeCollection","curIdx","insertCount","cellModel","mergeArgs","id_1","setInsertInfo","totalKey","WorkbookDelete","sheetLength","modelName","deletedCells","prevCell","mergeArgsCollection","update","preventRefresh","merge","skipChecking","prevCell_1","setDeleteInfo","total","WorkbookDataValidation","addValidationHandler","removeValidationHandler","addHighlightHandler","removeHighlightHandler","ValidationHandler","isRemoveValidation","validation","InvalidDataHandler","isRemoveHighlightedData","lastRowIdx","lastColIdx","range_1","isCell","isValid","WorkbookFindAndReplace","replaceAll","totalCount","cidx","valueOfCell","activecell","endColumn","stringValue","startColumn","lcValueOfCell","ivalueOfCell","lowerCaseIndex","searchBy","findNextArgs","loopCount","findNxtRow","findNxtCol","sheetsLen","noCellfound","nextCommon","noFound","rowCol","cellType","cellval","isCSen","isEMatch","lcValue","ivalue","findPrevArgs","findPreRow","findPreCol","usedRan","sheetsLength","noValueBoolean","commonCondition","prevCommon","isTrue","currentCell","findOpt","activecel","replaceAddress","replaceAllCollection","undoRedoOpt","caseInSensitive","replaceValue","replaceAllCollection_1","newValue","replaceAllCollection_2","updateValue","replaceAllCollection_3","startSheet","addressCollection","lowerCaseValue","regExepression","Collection","countNumber","columnIndex","requiredCount","findCount","argsVal","lowerCaseVal","findAllArguments","initialSheet","findCollection","WorkbookProtectSheet","props","lockCells","WorkbookMerge","mergeHorizontally","mergeVertically","mergeAll","curCell","getCellValue","mergeCount","activeCellRange","forward","forwardReverse","reverseForward","endRowIdx","endColIdx","isActiveCell","startRowIdx","startColIdx","startRowIndex","colnIdx","cellIndex","rIndex","cIndex","insertHandler","pasteHandler","nextCell","prevSheet","WorkbookConditionalFormat","setCFrulHandler","clearRules","cfrCount","frontColIdx","backColIdx","topRowIdx","bottomRowIdx","isFirst","cFRules","rangeIndexes","cFRulesIdx","isPresent","cFRule","cFRanges","cFRangeIdx","isFull","cFRangeIndexes","cFRRowIdx","cFRColIdx","rRowIdx","rColIdx","WorkbookBasicModule","WorkbookAllModule","CellStyle","ChildProperty","FilterCollection","DefineName","ProtectSettings","Hyperlink","Validation","Format","Complex","ConditionalFormat","Chart","Image","localeData","SortOutOfRangeError","Cell","Range","muteOnChange","parentObj","currRangeIdx","controlParent","isComplexArraySetter","setTimeout","tagObjects","instance","hasChanges","isInitChanges","rangeIdx_1","list","UsedRange","Sheet","ServiceLocator","services","register","__assign","t","Workbook_1","commonCellStyle","initWorkbookServices","dataBind","initEmptySheet","preRender","refreshing","L10n","render","getPersistData","addOnPersist","cssProps","cssProp","events.applyNumberFormatting","events.workbookFormulaOperation","removeSheet","events.workbookDestroyed","appendTo","selector","setBorder","insertRow","insertColumn","insertSheet","endSheet","errArgs","events.workbookEditOperation","events.workbookOpen","openFromJson","saveOptions","saveUrl","saveAsJson","addHyperlink","cellAddress","events.findNext","events.findPrevious","replaceBy","events.replaceHandler","events.replaceAllHandler","events.protectsheetHandler","unprotectSheet","events.unprotectsheetHandler","events.initiateSort","addDataValidation","events.setValidation","events.removeValidation","addInvalidHighlight","events.addHighlight","removeInvalidHighlight","events.removeHighlight","events.setCFRule","clearConditionalFormat","events.clearCFRule","wrapText","images","filterArgs","events.initiateFilter","events.clearAllFilter","events.clear","events.getFormattedCellObject","isProtectedOnChange","Component","Row","Column","role","selected","multiselectable","busy","colcount","Clipboard","externalMerge","contenteditable","getClipboardEle","clearCopiedInfo","tabSwitchHandler","cMenuBeforeOpenHandler","ribbonClickHandler","initCopyIndicator","EventHandler","parentId","focus","activeTab","copiedShapeInfo","hidePaste","l10n","delRowItems","hideRowItems","delColItems","hideColItems","actCellIndex","isCellLocked","setCopiedInfo","copiedSheet","isEdit","rfshRange","isExternal","clipboardData","copiedIdx","getCopiedIdx","copyInfo","isInternal","cSIdx","curSheet","selIdx","getExternalCells","internal","cellLength","isRepeative","beginEventArgs","copiedIndex","pictureElem","chartInfo","backgroundImage","pastedCell","imgLen","pasteSheetIndex","pastedPictureElement","pasteType","cRows","inRange_1","copiedCell","isFinite","colInd","externalMergeRow","newFormula","sId","cellElem","oldValue","displayText","cutInfo","updateFilter","select","isFilterCut","filterCollection","fRange","fEndCol","filterCol","cRng","pRng","cIdxValue","difIndex","formulaOperators","splitArray","newAddress","getEmptyStyle","pictureElements","pictureLen","showSpinner","imgRowIdx","offsetTop","isImage","imgColIdx","offsetLeft","getChartElemInfo","isIE","execCommand","hideSpinner","setExternalCells","chartId","copyIndicator","dialog","show","isModal","showCloseIcon","content","beforeOpen","dlgArgs","dialogName","items","enable","regex","setData","preventDefault","html","querySelectorAll","td","textContent","cSpan","rSpan","getStyle","children","child","char","charAt","Edit","editorElem","editCellData","isCellEdit","isNewValueEdit","isAltEnter","validCharacters","keyCodes","BACKSPACE","SPACE","TAB","DELETE","ESC","ENTER","FIRSTALPHABET","LASTALPHABET","FIRSTNUMBER","LASTNUMBER","FIRSTNUMPAD","LASTNUMPAD","SYMBOLSETONESTART","SYMBOLSETONEEND","SYMBOLSETTWOSTART","SYMBOLSETTWOEND","FIREFOXEQUALPLUS","FIREFOXMINUS","F2","dblClickHandler","mouseDownHandler","keyUpHandler","keyDownHandler","initiateCurPosition","updateFormulaBarValue","addressHandler","initiateRefSelection","refSelectionRender","renderEditor","refreshEditor","refreshFormulaBar","refreshEditorElem","isAppend","trigEvent","refreshCurPos","setCursorPosition","startEdit","endEdit","cancelEdit","editedValue","refreshDependentCellValue","position","altKey","keyCode","altEnter","formulaRefIndicator","parentElement","editValue_1","formulaSheetIdx","trgtElem","shiftKey","ctrlKey","metaKey","isFormulaEdit","isWindows","goTo","fullAddr","hasFormulaSuggSelected","isAlphabet","isNumeric","isNumpadKeys","isSymbolkeys","isFirefoxExceptionkeys","isF2Edit","isBackSpace","isLockCellDelete","editingHandler","editor","contentEditable","spellcheck","preventFormulaReference","cellEle","isDelTemplate","value_1","updateEditCellDetail","initiateEditor","positionEditor","elem","selection","getSelection","createRange","setStart","collapse","removeAllRanges","addRange","suggDdlElem","visibility","editText","curPos","focusOffset","actCellIdx","selectionEnd","curPos_1","addr","tdElem","minHeight","minWidth","editWidth","inlineStyles","enableRtl","updateEditedValue","tdRefresh","oldCellValue","innerText","sheet_1","cellIndex_1","getRefreshNodeArgs","refreshNode","fCode","event","fSize","resetEditState","focusElement","removeAttribute","eventName","originalEvent","textBefore","textAfter","node","anchorNode","nodeType","anchorOffset","setEnd","elemRefresh","editorEle","isSelect","setFormulaBarCurPosition","input","selectionStart","setSelectionRange","el","childNodes","valueLength","Selection","invalidOperators","formulaRange","tableRangesFormula","mouseMoveEvt","mouseMoveHandler","virtualContentLoadedHandler","cellNavigateHandler","protectHandler","initiateFormulaSelection","clearBorder","chartBorderHandler","getActiveCell","getSelectionElement","rowStart","rowEnd","colStart","colEnd","selectRangeByIdx","actRange","createSelectionElement","cont","overlayElem","getSheetElement","activeIdx","isRowSelected","isColSelected","getColumnHeaderContent","which","isSelected","passive","mouseUpHandler","touchEvt","isMobileView","renderModule","setSheetPanelSize","getScrollContent","clientRect","prevIndex","isScrollDown","isScrollUp","isScrollRight","isScrollLeft","clearInterval","scrollInterval","setInterval","scrollTop","scrollLeft","highlightHdr","getScrollLeft","scrollModule","prevScroll","cliRect","initFormulaReferenceIndicator","forRefIndicator","isScrollRefresh","isActCellChanged","isInit","isMergeRange","getOffset","eArgs","UpdateRowColSelected","updateActiveCell","topLeftIdx","isRowRefresh","isColRefresh","rowHdr","colHdr","getHdrIndexes","selectAll","removeClass","addClass","hiddenRowCount","hiddenCount","hiddenColCount","processFormulaEditRange","formulaStartSheetIdx","actSheetIdx","parsedVal","ctrlKeyCount","formulaBorder","splitStr","updateFormulaEditRange","dStartCell","dEndCell","startcell","endcell","isChart","minr","minc","maxr","maxc","getEleFromRange","rowCells","startRIndex","startCIndex","endRIndex","endCIndex","tempCells","getRowCells","tdCol","second","borderEleColl","classArr","idx_1","formulaStr","Scroll","initProps","scrollArgs","prevSize","initScrollValue","scrollRight","getColOffset","cur","prev","preventScroll","updateTopLeftCell","updateNonVirtualCols","scrollDown","getRowOffset","updateNonVirtualRows","refreshUI","Infinity","onScroll","setPadding","allowScrolling","colHeader","rowHeader","scrollWidth","padding","marginBottom","VirtualScroll","scroll","createVirtualElement","container","colVTrack","rowVTrack","vTrack","initScroll","domCount","setScrollCount","translateX","translateY","transform","activeSheetIdx","getRowAddress","getColAddress","updateScrollCount","usedRangeCount","prevIdx","idxDiff","lastIdx","prevTopIdx","skippedHiddenIdx","skipUpdateOnFirst","getThresholdHeight","checkLastIdx","endIdx","prevLeftIdx","getThresholdWidth","translate","updateColumnWidth","getVTrackHeight","updateVTrack","createHeaderElement","heightArr","updateVTrackHeight","updateVTrackWidth","hdrVTrack","cntVTrack","hdrColumn","cntColumn","sizeStr","deInitProps","updateScrollProps","sliceScrollProps","KeyboardNavigation","activeElement","isNavigate","isFilterCell","actIdxes","scrollNavigation","stopPropagation","isScroll","topLeftIdxes","getBottomIdx","getRightIdx","contWidth","KeyboardShortcut","isUndo","toolBarElem","applyFilter","CellFormat","checkHeight","curStyle_1","setLeftBorder","setTopBorder","pRow","pHRow","setThickBorderHeight","customHeight","isFontSize","updateRowHeight","isLastCell","borderSize","firstElementChild","display","getBorderSize","calculateHeight","clearObj","Resize","wireEvents","setAutoFitHandler","isRow","trgtEle","setAutofit","wireResizeCursorEvent","setTarget","unWireResizeCursorEvent","unwireEvents","sheetPanel","colResizeHandler","rowResizeHandler","isMouseMoved","offsetSize","offsetY","updateTarget","createResizeHandler","resizeOn","resizeHandler","updateCursor","colIndx","showHiddenColumns","rowIndx","newTrgt","tOffsetV","eOffsetV","tClass","offsetX","resEle","mainContent","contentTable","rowLength","colLength","contentFit","getFloatingElementWidth","autofitValue","resizeStart","getViewportIndex","threshold_1","oldWidth","threshold_2","oldHeight","clientHeight","viewportIdx","curWidth","colgroup","eleHeight","rowHeight","isCustomHgt","actualIdx","skipAppend","rTbody","tBodies","tbody","insertBefore","insertIdx","isFit","floatingWidth","hasFilter","CollaborativeEditing","refreshClients","ShowHide","hideCol","nextIdx","hFrag","frag","rowRenderer","rTBody","tBody","newStartRow","createDocumentFragment","lastElementChild","scrollable","hiddenIndex","beforeViewportIdx","removeCell","scrollWidth_1","appendCell","hColgrp","colgrp","hTable","modelLen","isEnd","cellRenderer","refCell","sheetModule","updateCol","renderColHeader","lastChild","tHead","checkNextBorder","previousSibling","SpreadsheetHyperlink","initiateHyperlinkHandler","editHyperlinkHandler","removeHyperlinkHandler","openHyperlinkHandler","hyperlinkClickHandler","createHyperlinkElementHandler","hyperlinkText","hyperlinkSpan","insertBut","dialogInst_1","cssClass","dialogInstance","hyperlinkContent","buttons","buttonModel","isPrimary","disabled","dlgClickHandler","dialogInst","spreadsheetInst","insertHyperlink","dlgContent","hyperEditContent","cellIndexes","hlOpenHandler","isEmpty","rangeAddr","befArgs","aftArgs","definedNameCheck","sheetIdx_1","isDefinedNamed","rangeAddr_1","addArr","dlgEle","docEle","webEle","webEleText","docEleText","actEle","hasAttribute","hyperEle","isWeb","webContElem","docContElem","listEle","isDefinedName","isCellRef","isEnable","hl","dialogElem","Tab","selectedItem","textCont","urlCont","textH","urlH","textInput","urlInput","nodeId","nodeText","expanded","nodeChild","treeObj","TreeView","fields","cellrefCont","cellrefH","cellrefInput","textCont1","textH1","textInput1","sheetCont","sheetH","refCont","UndoRedo","undoCollection","redoCollection","undoRedoStep","cutCellDetails","getCellDetails","beforeActionData","cellDetails","beforeDetails","undoRedoArgs","performOperation","undoForClipboard","undoForResize","updateUndoRedoIcons","completeArgs","actionList","beforeActionDetails","tab","actionData","checkRefreshNeeded","updateCellDetails","sheetIndex_1","WrapText","wrapTextHandler","rowHeightChangedHandler","initial","WRAPTEXT","outerHTML","editElem","defaultStyle","Insert","preventUpdate","refreshSheet","refreshImgElement","Delete","DataValidation","dataValPopup","listOpen","initiateDataValidationHandler","invalidDataHandler","checkDataValidation","listHandler","parEle","valuesCont","errorEle","primaryBut","listObj","showPopup","isRemoveHighlight","tdEle_1","ddlCont","ddlEle","DropDownList","popupWidth","popupHeight","updateDataSource","change","listValueChange","popup","getIndexes","listValues","isNew","dataValidationContent","cellRangeCont","allowDataCont","ignoreBlankCont","cellRangeText","cellRangeEle","allowCont","dataCont","allowText","typeData","operatorData","allowSelectEle","allowIdx","dataIdx","dataText","dataSelectEle","FormattedValue","dataList","userInput","ignoreBlankEle_1","CheckBox","label","checked","minimumCont","maximumCont","minimumText","maximumText","minimumInp","maximumInp","NumericTextBox","valueText","valueEle","isChecked","ignoreBlankEle","listObj1","dlgCont","placeholder","errorMsg","isValidList","dlgFooter","dlgContEle","allowData","allowEle","dataEle","rangeAdd","valArr","isSheetNameValid","isSingleCol","isSingleRow","validDlg","isDialogValidator","tdEle","formValidation","formatValidation","isValidationHandler","enterValue","validationErrorHandler","formEle","inputEle","customPlacement","inputElement","number","FormValidator","validate","erroDialogInst_1","dlgModel","errorDlgHandler","errorDialogInst","buttonName","ProtectSheet","protect","protectSheetHandler","editProtectedAlert","lockCellsHandler","isActive","createDialogue","listData","optionList","ListView","showCheckBox","dialogOpen","protectHeaderCntent","checkbox","listViewElement","headerContent","checkBoxElement","okBtnFocus","beforeClose","checkboxElement","checkBoxClickHandler","selectOption","selectMultipleItems","selectedItems","getSelectedItems","disableHomeBtnId","enableHomeBtnId","enableFrmlaBtnId","enableInsertBtnId","imageBtnId","findBtnId","dataValidationBtnId","chartBtnId","sheetElement","closeOnEscape","close","FindAndReplace","shortValue","renderFindDlg","renderGotoDlg","gotoHandler","eventArgs_1","eventArgs_2","eventArgs_3","dlg","allowDragging","findandreplaceContent","dialogMessage","findDlgClick","prevButton","GotoContent","textFocus","findDlgArgs","findOption","findInput","gotoAlert","checkCase","checkmatch","searchitem","modeitem","find","countArgs","countOpt","replaceWith","caseCheckbox","eMatchCheckbox","searchDDL","modeDDL","replaceMode","gotoaddress","splitAddress","gotoSpan","findSpan","replaceSpan","findValue_1","findValue","findElem","findCheck","findTextE","findTextH","findTextIp","findTextBox","TextBox","replaceTextE","replaceTextH","replaceTextIp","replaceTextBox","withinData","Id","Within","withInDDL","withIn","withinTextH","searchData","Search","searchIn","searchTextH","caaseCheckbox","entirematchCheckbox","gotoElem","gotoTextE","gotoTextH","gotoTextBox","gotoTextIp","Merge","hideHandler","ConditionalFormatting","cFInitialRender","cFInitialCheckHandler","checkConditionalFormatHandler","initiateCFHandler","setCFHandler","cFDeleteHandler","clearCFHandler","addClearCFHandler","clearCFormats","cCFIdx","isApply","cFIdx","sRangeIdx","newRangeIdxs","cFRowIdx","cFColIdx","sRRowIdx","sRColIdx","cFDlgContent","mainCont","inpEle","getCFColor","cFType","getType","dlgText","getDlgText","mainDiv","subDiv","value1Text","value1Inp","duplicateSelectEle","subDivText","colorSelectEle","dupData","value2Text","value2Inp","colorData","checkCellHandler","cFrange","cFRIdx","formatStyle","cFColors","cFRCheck","setFormat","setProperty","cFRuleIdx","setColor","isActiveCF","rgb","hexToRgb","g","hex","exec","isInitial","cFRuleValue1","cFRuleValue2","valueArr","valueStr","isGreaterThanLessThan","isBetWeen","isEqualTo","isContainsText","isDuplicateUnique","isTopBottomTenValue","isTopBottomTenPercentage","isAboveBelowAverage","isDataBarColorScalesIconSets","applyDataBars","applyColorScale","applyIconSet","selIndexes","rIdx_1","cIdx_1","iconList","getIconList","rIdx_2","getNumericArray","n1","n2","currentSymbol","minPercent","percent1","percent2","percent3","cfIcon","applyIconSetIcon","activeObj","activeEle","iconName","colors","getColor","rIdx_3","hexcode","getGradient","posColor","negColor","topVal","posArr","negArr","leftStandardWidth","rIdx_4","databar","leftSpan","rightSpan","dataSpan","iconSetSpan","cfColor","colorCodeArr","colorArr","middle","large","getLinear","center","byteLinear","isGrearThan","txtRegx","input1","input2","dateEventArgs1","dateEventArgs2","dateTimeArgs","inp","isTop","dataArray","cFRuleIndexes","dataArr","considerCount","isAbove","rangeColl","average","RibbonHeader","RibbonItem","Item","Ribbon","getUniqueID","renderRibbon","expandCollapseElem","ribbonExpandCollapse","menuItems","fileMenu","toolbarObj","tabObj","getTabItems","tabItems","initMenu","menu","menuObj","Menu","showItemOnClick","parentItem","beforeItemRender","tabElement","tBarElement","Toolbar","selectedTab","getIndex","animation","next","duration","previous","selecting","selectingIndex","updateToolbar","refreshOverflow","collapseBtn","decrement","enableMenuItems","isUniqueId","enableItems","hideMenuItems","menuInstance","hideItems","showItems","addMenuItems","insertAfter","hideTabs","tabs","stateChanged","isAllHidden","getTabIndex","allHidden","enableTabs","enableTab","addTabs","addTab","headerText","tabIdx","disable","MenuItem","ColorPicker","fontColorPicker","ColorPickerComponent","showButtons","presetColors","fontColor","enableOpacity","beforeCloseHandler","openHandler","beforeModeSwitch","currentValue","rgba","previousValue","updateSelectedColor","wireFocusEvent","filColorPicker","fillColor","borderBottomColor","title","inst","modeSwitcher","fontNameIndex","numPopupWidth","RibbonColorPicker","initRibbon","createMobileView","createRibbon","getRibbonMenuItems","iconCss","getRibbonItems","prefixIcon","tooltipText","getPasteBtn","getNumFormatDDB","getFontNameDDB","getFontSizeDDB","getBtn","getBordersDBB","getMergeSplitBtn","getTextAlignDDB","getVerticalAlignDDB","getHyperlinkDlg","datavalidationDDB","getLocaleText","getCFDBB","getChartDBB","getClearDDB","getSortFilterDDB","getFindDDb","btn","pasteSplitBtn","SplitButton","setClass","getLocaleProtectText","ribbonElement","RibbonComponent","fileMenuItemSelect","fileMenuBeforeOpen","fileMenuBeforeClose","toolbarClicked","ribbonCreated","tabSelecting","expandCollapse","expandCollapseHandler","beforeFileMenuItemRender","beforeRenderHandler","uiUpdate","refEle","refreshRibbonContent","numFormatBtn","numFormatDDB","DropDownButton","getNumFormatDdbItems","numDDBSelect","numDDBOpen","previewNumFormat","tBarDdbBeforeOpen","fontSizeDdb","refreshSelected","chartMenu","orientation","bar","area","line","pie","radar","scatter","chartSelected","column1Text","column1Cont","column2Cont","clusteredColumn","stackedColumn","stackedColumn100","clusteredColumn3D","stackedColumn3D","stackedColumn1003D","bar1Text","bar1Cont","bar2Cont","clusteredBar","stackedBar","stackedBar100","clusteredBar3D","stackedBar3D","stackedBar1003D","areaText","areaCont","defArea","stackedArea","stackedArea100","lineText","lineCont","defLine","stackedLine","stackedLine100","pieText","pieCont","defPie","doughnut","radarText","radarCont","defradar","radarMarkers","scatterText","scatterCont","defscatter","ul","chartDdb","chartBtn","cFMenu","dataBars","colorScales","iconSets","cFSelected","db1","db2","bBar","gBar","rBar","oBar","lBBar","pBar","cs1","cs2","cs3","gyr","ryg","gwr","rwg","bwr","rwb","wr","rw","gw","wg","gy","yg","is1","is2","is3","is4","is5","is6","is7","is8","directional1","directional2","directional3","directional4","directional5","directional6","directional7","shapes1","shapes2","shapes3","shapes4","shapes5","indicators1","indicators2","indicators3","ratings1","ratings2","ratings3","ratings4","ratings5","cFDdb","tag","cPickerWrapper","bordersMenu","separator","colorPicker","cPickerEle","onOpen","overflow","borderSelected","inline","bordersDdb","eleId","prevStyleId_1","toggle","fontNameBtn","fontNameDdb","getFontFamilyItems","refreshFontNameSelection","bindEvent","btnObj","Button","isToggle","toggleBtnClicked","datavalidationDdb","textAlignDdb","alignItemRender","verticalAlignDdb","mergeSplitBtn","mergeSelectHandler","toggleActiveState","unMerge","itemId","isDataPresent","performMerge","sortingDdb","isFiltered","isClearAll","findToolbtn","findDdb","onclick","findToolDlg","toolbarObj_1","findTextElement","findTextInput","findSpan_1","onkeyup","nextElement","prevElement","onkeydown","findOnKeyDown","toolItemModel","findDialog","toolbarElement_1","dialogDiv","FindDialog","closeDialog","getComputedStyle","calculate","dialogWidth","rightValue","topValue","X","Y","elements","clearDdb","defaultModel","activeModel","property","refreshToggleBtn","itemKey","setPanelSize","actionArgs","refreshNumFormatSelection","separatorCount","viewportHeight","actualHeight","paddingTop","separatorStyle","borderBottomWidth","marginTop","overflowY","elemList","popWidth","numElem","previewElem","refreshHomeTabContent","refreshDataTabContent","refreshViewTabContent","active","fontProps","selectArgs","evtHArgs","showHideHeaders","toggleRibbonItems","evtglArgs","viewtabHeader","datatabHeader","updateToggleText","len_2","updateActiveBorder","updated","updateViewTabContent","updateShowHideBtn","showHideText","updateDataTabContent","updateProtectBtn","protectText","toobar","align","renderMobileToolbar","toolbarPanel","toolbar","ddb","ddbObj","calculatePosition","wrapper","contents","li","updateMergeItem","parentElem","ribbonEle","FormulaBar","isGoto","createFormulaBar","insertFnRipple","fBarWrapper","nameBox","comboBoxInstance","ComboBox","noRecordsTemplate","nameBoxBeforeOpen","blur","nameBoxBlur","nameBoxSelect","rippleEffect","textarea","textAreaFocusIn","textAreaFocusOut","formulaPanel","tickBtn","validity","eventArg","UpdateValueAfterMouseUp","isInteracted","itemData","formulaBarUpdateHandler","indexes1","indexes2","intDate","formulaInp","updateComboBoxValue","disabletextarea","getFormulaBar","formulaBarScrollEdit","viewportIndexes","formulaBarClickHandler","toggleFormulaBar","names","offsetParent","formulaDescription","categoryContent","dropDownElement","descriptionContent","categoryArgs","categoryList","dropDownSelect","listArgs","formulaList","actionComplete","updateFormulaList","listSelected","dialogBeforeClose","dialogClose","selectFormula","formulaClickHandler","focusOkButton","dialogContentEle","parentNode","storeActiveElement","formulaBarObj","updateFormulaDescription","activeListFormula","firstElement","selectItem","descriptionArea","selectedFormula","descriptionArgs","editOperationHandler","Formula","isFormulaBar","isPopupOpened","isPreventClose","isSubFormula","UP","DOWN","LEFT","RIGHT","autocompleteInstance","formulaClick","renderAutoComplete","getNames","getNameFromRange","acElem","autoCompleteOptions","filterType","sortOrder","onSuggestionOpen","onSuggestionClose","onSelect","onSuggestionComplete","AutoComplete","getPopupPosition","refreshPosition","maxHeight","triggerKeyDownEvent","updatedFormulaValue","getEditingValue","parseIndex","getArgumentSeparator","hidePopUp","getSuggestionKeyFromFormula","refreshFormulaSuggestion","autoCompleteElem","isSuggestionAlreadyOpened","isNavigationKey","dispatchEvent","suggPopupElem","hidePopup","suggestValue","bracketIndex","fSplit","isAlphaNumeric","singleRange","SheetTabs","aggregateContent","isSelectCancel","selaggregateCnt","createSheetTabs","tabInstance","panel","addBtn","addSheetTab","addBtnRipple","getSheetTabItems","dropDownInstance","ddbItems","updateSheetTab","beforeOpenHandler","sheetTab","overflowMode","scrollStep","currentSheetIndex","previousSheetIndex","previousIndex","updateDropDownItems","completeEventArgs","tBarItems","spaceKeyDown","positionX","isCollide","refreshSheetTab","skipHiddenSheets","switchSheetTab","required","maxlength","renameInputFocusOut","updateWidth","spaceLen","removeRenameInput","showRenameDialog","updateSheetName","textEle","sheetItems","focusRenameInput","forceDelete","sheetArgs","destroySheet","removeTab","activeIndex","btnClass","aggregateDropDown","updateAggregateContent","aggregateEle","getAggregateItems","removeAggregate","Open","renderFileUpload","openFailed","uploadID","accept","uploadBox","onchange","fileSelect","filesData","files","impArgs","Save","ContextMenu","initContextMenu","contextMenuInstance","ContextMenuComponent","selectHandler","getInsertModel","getTarget","getDataSource","childElementCount","insertEle","deleteEle","setClipboardData","setFilterItems","setSortItems","setHyperLink","setInsertDeleteItems","setHideShowItems","setProtectSheetItems","clearFilterText","subItems","addItemsHandler","removeItemsHandler","enableItemsHandler","removeItems","NumberFormat","Sort","applySortHandler","sortCompleteHandler","initiateCustomSortHandler","isValidSortRange","sortRangeAlertHandler","customSortContent","clearError","errorElem","validateError","headercheck","headerCheckbox","hasHeader","dropDown","hasError","Set","duplicateField","errorField","count_1","dropDownList","getFields","listId","listviewObj","getCustomListview","setHeaderTab","contentElem","listview","renderListItem","fieldName","headerTabElement","addButton","footer","addItem","checkHeaderObj","fieldsMap","dropDownListObj","checkCaseObj","enableRipple","deleteHandler","removeItem","lvObj","orderRadio","isAscending","toLocaleLowerCase","radiobutton","RadioButton","setRadioBtnValue","radio","radiobutton2","radio2","beforeArgs","Filter","filterClassList","filterRangeAlertHandler","initiateFilterUIHandler","filterMouseDownHandler","renderFilterCellHandler","beforeFltrcMenuOpen","beforeFilterMenuOpenHandler","beforeCustomFilterOpen","beforeCustomFilterOpenHandler","reapplyFilterHandler","filterByCellValueHandler","clearFilterHandler","getFilteredColumnHandler","filterCboxValue","filterCboxValueHandler","getFilterRangeHandler","filterCellKeyDownHandler","isInValidFilterRange","addMenuItem","removeFilter","processRange","filterSuccessHandler","predicate","refreshFilterRange","isFilterRange","getColumnType","matchCase","filterBtnObj","filterButton","hasChildNodes","headerCell","filterPopup","pos","openDialog","selectSortItemHandler","xPos","yPos","parentsUntil","filterCell","displayName","checkBoxData","hideSearchbox","filteredColumns","ExcelFilterBase","getLocalizedCustomOperators","sameIndex","filterIndex","getPredicates","predicateList","excelPredicate","CheckBoxFilterBase","getPredicate","numOptr","stringOperator","numberOperator","dateOperator","datetimeOperator","booleanOperator","fil","colCollection","dataType","SpreadsheetImage","pictureCount","renderImageUpload","refreshInsDelImagePosition","imageSelect","binaryStringVal","reader","FileReader","readAsDataURL","onload","overlayObj","overlay","insertOverlayElement","currCell","currCellObj","imageLen","prevRowIdx","currRowIdx","prevColIdx","currColIdx","prevImgObj","currImgObj","prevCellObj","prevCellImg","prevCellImgLen","currentRowIdx","currentColIdx","imgLength","imgTop","imgleft","rangeVal","ColumnSeries","LineSeries","BarSeries","AreaSeries","StackingColumnSeries","StackingLineSeries","StackingBarSeries","ScatterSeries","StackingAreaSeries","Category","Legend","Tooltip","AccumulationChart","PieSeries","AccumulationTooltip","AccumulationDataLabel","AccumulationLegend","SpreadsheetChart","initiateChartHandler","updateChartHandler","insertChartHandler","chartRangeHandler","chartType","chartCollLen","getPropertyValue","formatObj","series","prevChartObj","currChartObj","prevCellChart","chartEleClassName","processChartRange","xRange","yRange","lRange","trVal","blVal","tlVal","isStringSeries","toIntrnlRange","getRangeData","pushRowData","isYvalue","isDataSrcEnsured","minCol","forArgs","toArrayData","getVirtualXValues","limit","processChartSeries","xValue","yValue","lValue","pArr","inc","dtVal","seriesName","pObj","yInc","sArr","skipFormula","rDiff","cDiff","xName","yName","marker","shape","dataLabel","radius","startAngle","endAngle","innerRadius","explode","explodeOffset","explodeIndex","retVal","primaryYAxisFormat","focusChartRange","borderIdx","eleColl","tdIdx","argsOpt","isRangeSelect","isRowLesser","reqType","shapeType","chartRange","primaryYAxis","lineStyle","majorTickLines","majorGridLines","minorGridLines","minorTickLines","labelFormat","eleRange","chartContent","primaryXAxis","valueType","chartArea","tooltip","load","selectedTheme","beforeResize","cancelResizedEvent","enableSmartLabels","enableAnimation","legendSettings","location","hash","accumulation","chartElements","chartLength","isRemoveEle","BasicModule","Spreadsheet","AllModule","ScrollSettings","SelectionSettings","Custom","defaultLocale","FindValue","ReplaceValue","FindReplaceTooltip","InsertingEmptyValue","ReplaceAllEnd","ByRow","ByColumn","MatchCase","MatchExactCellElements","Replace","Find","Goto","EntercellAddress","GotoSpecial","FindNextBtn","FindPreviousBtn","ReplaceBtn","ReplaceAllBtn","GotoHeader","GotoSpecialHeader","NoElements","FindWhat","ReplaceWith","Cut","Copy","Paste","PasteSpecial","Link","EditHyperlink","OpenHyperlink","RemoveHyperlink","InsertLink","EditLink","All","Values","Formats","Bold","Font","FontSize","Italic","Underline","Strikethrough","TextColor","FillColor","HorizontalAlignment","AlignLeft","AlignCenter","AlignRight","VerticalAlignment","AlignTop","AlignMiddle","AlignBottom","MergeCells","MergeAll","MergeHorizontally","MergeVertically","Unmerge","UnmergeCells","SelectMergeType","MergeCellsAlert","PasteMergeAlert","Borders","TopBorders","LeftBorders","RightBorders","BottomBorders","AllBorders","HorizontalBorders","VerticalBorders","OutsideBorders","InsideBorders","NoBorders","BorderColor","BorderStyle","InsertFunction","Rename","Hide","Unhide","NameBox","ShowHeaders","HideHeaders","ShowGridLines","HideGridLines","AddSheet","ListAllSheets","FullScreen","CollapseToolbar","ExpandToolbar","CollapseFormulaBar","ExpandFormulaBar","File","Home","Formulas","View","New","SaveAs","Update","ExcelXlsx","ExcelXls","CSV","SortAscending","SortDescending","CustomSort","AddColumn","ContainsHeader","CaseSensitive","SortBy","ThenBy","SelectAColumn","SortEmptyFieldError","SortDuplicateFieldError","SortAndFilter","ClearAllFilter","ClearFilterFrom","ReapplyFilter","FilterCellValue","FilterOutOfRangeError","HideRow","HideRows","UnHideRows","HideColumn","HideColumns","UnHideColumns","InsertRow","InsertRows","Above","Below","InsertColumn","InsertColumns","Before","After","DeleteRow","DeleteRows","DeleteColumn","DeleteColumns","Ok","Close","Cancel","Apply","MoreColors","StandardColors","General","Currency","Accounting","ShortDate","LongDate","Time","Percentage","Fraction","Scientific","Text","MobileFormulaBarPlaceHolder","PasteAlert","DestroyAlert","SheetRenameInvalidAlert","SheetRenameEmptyAlert","SheetRenameAlreadyExistsAlert","DeleteSheetAlert","DeleteSingleLastSheetAlert","PickACategory","Description","UnsupportedFile","InvalidUrl","SUM","SUMIF","SUMIFS","ABS","RAND","RANDBETWEEN","FLOOR","CEILING","PRODUCT","INT","ROUNDUP","SUMPRODUCT","TODAY","AVERAGE","AVERAGEIF","AVERAGEIFS","AVERAGEA","COUNT","COUNTIF","COUNTIFS","COUNTA","MIN","MAX","DATE","DAY","DAYS","IF","IFS","CalculateAND","CalculateOR","IFERROR","CHOOSE","INDEX","FIND","CONCATENATE","CONCAT","SUBTOTAL","RADIANS","MATCH","LN","INTERCEPT","SLOPE","DefineNameExists","DefineNameInValid","CircularReference","ShowRowsWhere","OR","AND","CustomFilterDatePlaceHolder","CustomFilterPlaceHolder","CustomFilter","Between","DateTimeFilter","Undo","Redo","DateFilter","TextFilter","NumberFilter","ClearFilter","NoResult","FilterFalse","FilterTrue","Blanks","SelectAll","GreaterThanOrEqual","GreaterThan","LessThanOrEqual","LessThan","NotEqual","Equal","Contains","EndsWith","StartsWith","ClearButton","FilterButton","CancelButton","OKButton","UnprotectSheet","LockCells","SelectCells","FormatCells","FormatRows","FormatColumns","InsertLinks","ProtectContent","ProtectAllowUser","EditAlert","SearchWithin","SearchBy","Reference","CLEARALL","APPLY","CellRange","Allow","Data","Minimum","Maximum","IgnoreBlank","WholeNumber","Decimal","TextLength","List","NotBetween","EqualTo","NotEqualTo","Greaterthan","Lessthan","GreaterThanOrEqualTo","LessThanOrEqualTo","InCellDropDown","Sources","Value","Retry","EnterValue","DialogError","ListLengthError","ValidationError","EmptyError","ClearHighlight","HighlightInvalidData","ClearValidation","HighlightCellsRules","CFEqualTo","TextThatContains","ADateOccuring","DuplicateValues","TopBottomRules","Top10Items","Top10","Bottom10Items","Bottom10","AboveAverage","BelowAverage","FormatCellsGreaterThan","FormatCellsLessThan","FormatCellsBetween","FormatCellsEqualTo","FormatCellsThatContainTheText","FormatCellsThatContainADateOccurring","FormatCellsDuplicate","FormatCellsTop","FormatCellsBottom","FormatCellsAbove","FormatCellsBelow","With","DataBars","ColorScales","IconSets","ClearRules","SelectedCells","EntireSheet","ISNUMBER","ROUND","GEOMEAN","POWER","LOG","TRUNC","EXP","Clear","ClearContents","ClearAll","ClearFormats","ClearHyperlinks","LightRedFillWithDarkRedText","YellowFillWithDarkYellowText","GreenFillWithDarkGreenText","RedFill","RedText","Duplicate","Unique","And","WebPage","ThisDocument","DisplayText","Url","CellReference","DefinedNames","EnterTheTextToDisplay","EnterTheUrl","BlueDataBar","GreenDataBar","RedDataBar","OrangeDataBar","LightblueDataBar","PurpleDataBar","GYRColorScale","RYGColorScale","GWRColorScale","RWGColorScale","BWRColorScale","RWBColorScale","WRColorScale","RWColorScale","GWColorScale","WGColorScale","GYColorScale","YGColorScale","ThreeArrowsColor","ThreeArrowsGray","ThreeTriangles","FourArrowsColor","FourArrowsGray","FiveArrowsColor","FiveArrowsGray","ThreeTrafficLights1","ThreeTrafficLights2","ThreeSigns","FourTrafficLights","RedToBlack","ThreeSymbols1","ThreeSymbols2","ThreeFlags","ThreeStars","FourRatings","FiveQuarters","FiveRatings","FiveBoxes","Bar","Area","Pie","Doughnut","PieAndDoughnut","Line","Radar","Scatter","ChartDesign","ClusteredColumn","StackedColumn","StackedColumn100","ClusteredBar","StackedBar","StackedBar100","StackedArea","StackedArea100","StackedLine","StackedLine100","SheetRender","freezePane","colGroupWidth","refreshSelectALLContent","getSelectAllTable","headerPanel","updateLeftColGroup","getRowHeaderPanel","detachColGroup","colGrp","colGrpWidth","getSelectAllContent","getColHeaderPanel","getContentPanel","renderPanel","contentPanel","initHeaderPanel","updateHideHeaders","createTable","createHeaderTable","updateTable","rowHdrEle","tagName","renderTable","rHdrTBody","cHdrTHead","cHdrRow","cTBody","attributes","aria-rowcount","aria-colcount","renderRowHeader","initLoad","triggerCreatedEvent","createdHandler","observers","refreshColumnContent","checkColMerge","refreshRowContent","hTBody","checkRowMerge","formatUnit","updateColContent","refChild","hRefChild","skipRender","colRefChild","updateRowContent","rFrag","cKey","firstcell","refreshPrevMerge","currTopIdx","renderHeaders","rowIndexes","colIndexes","cFrag","cTHead","cRow","RowRenderer","isRowHeader","aria-rowindex","CellRenderer","th","tableRow","updateView","aria-colindex","tabindex","checkMerged","compiledTemplate","processTemplates","evtArgs","formatArgs","removeStyle","compileCellTemplate","templateString","compile","compiledStr","clonedCell","previouseHeight","getRowHeightOnInit","tTable","rightBorder_1","bottomBorder_1","prevRowCell","prevColCell","cRange","Render","renderSheet","checkTopLeftCell","lastRow","lastCol","roundValue","roundedValue","instantiateRenderer","Dialog","dialogModel","cancelBtn","btnContent","closeHandler","div","DialogComponent","ActionEvents","initializeActionBegin","beforeCellFormat","actionEventHandler","evtFunc","actionType","eventType","beforeSave","beforeSort","initializeActionComplete","cellSave","actionBeginHandler","actionCompleteHandler","Overlay","isOverlayClicked","isResizerClicked","currenHeight","class","renderResizeHandles","originalWidth","originalHeight","overlayClickHandler","overlayMouseMoveHandler","overlayMouseUpHandler","resizer","height1","originalMouseY","originalResizeTop","resizedReorderTop","width1","pageX","originalMouseX","height2","pageY","width2","originalResizeLeft","resizedReorderLeft","posX","posY","aX","diffX","aY","diffY","originalReorderTop","originalReorderLeft","actOverlayElem","handleElem","handles","needsID","Spreadsheet_1","initServices","renderSpreadsheet","setHeight","setWidth","createSpinner","findAll","addrArr","insideDomCount","cVTrack","rVTrack","vWidth","vHeight","scrollableSize","resize","activeAddress","colThreshold","mIndex","colWidth","eleWidth","oldIdx","edited","maximumColInx","startIsCol","endIsCol","starttoend","startValues","getAddress","endValues","cellMod","eleRowIdx","eleColIdx","isMethod","addrRange","mCell","isDevice","circularArgs","spanElem","alignClass","createTextNode","nodeValue","borderWidth","nextTab","indicator","initIdx","undo","redo","mouseClickHandler","closeEdit","newRangeIdx_1","ranges_1","isLastRange"],"mappings":"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"}