{"version":3,"file":"ej2-spreadsheet.umd.min.js","sources":["../src/workbook/common/address.js","../src/workbook/common/worker.js","../src/workbook/common/math.js","../src/workbook/integrations/number-format.js","../src/calculate/common/common.js","../src/calculate/common/module.js","../src/calculate/common/module-loader.js","../src/calculate/base/calculate.js","../src/workbook/common/module.js","../src/workbook/common/util.js","../src/workbook/base/cell.js","../src/workbook/base/data.js","../src/workbook/base/sheet.js","../src/workbook/base/row.js","../src/workbook/base/column.js","../src/spreadsheet/common/module.js","../src/spreadsheet/common/util.js","../src/workbook/common/event.js","../src/workbook/integrations/data-bind.js","../src/spreadsheet/common/event.js","../src/workbook/integrations/open.js","../src/workbook/workers/save-worker.js","../src/workbook/integrations/save.js","../src/calculate/common/enum.js","../src/calculate/formulas/basic.js","../src/calculate/base/parser.js","../src/workbook/integrations/formula.js","../src/workbook/integrations/sort.js","../src/workbook/integrations/filter.js","../src/workbook/integrations/image.js","../src/workbook/integrations/chart.js","../src/workbook/actions/cell-format.js","../src/workbook/actions/edit.js","../src/workbook/actions/hyperlink.js","../src/workbook/actions/insert.js","../src/workbook/actions/delete.js","../src/workbook/actions/data-validation.js","../src/workbook/actions/find-and-replace.js","../src/workbook/actions/protect-sheet.js","../src/workbook/actions/merge.js","../src/workbook/actions/conditional-formatting.js","../src/workbook/common/basic-module.js","../src/workbook/common/all-module.js","../src/workbook/common/class.js","../src/workbook/common/constant.js","../src/workbook/services/service-locator.js","../src/workbook/base/workbook.js","../src/spreadsheet/actions/clipboard.js","../src/spreadsheet/actions/edit.js","../src/spreadsheet/actions/selection.js","../src/spreadsheet/actions/scroll.js","../src/spreadsheet/actions/virtual-scroll.js","../src/spreadsheet/actions/keyboard-navigation.js","../src/spreadsheet/actions/keyboard-shortcut.js","../src/spreadsheet/actions/cell-format.js","../src/spreadsheet/actions/resize.js","../src/spreadsheet/actions/collaborative-editing.js","../src/spreadsheet/actions/show-hide.js","../src/spreadsheet/actions/hyperlink.js","../src/spreadsheet/actions/undo-redo.js","../src/spreadsheet/actions/wrap.js","../src/spreadsheet/actions/insert.js","../src/spreadsheet/actions/delete.js","../src/spreadsheet/actions/data-validation.js","../src/spreadsheet/actions/protect-sheet.js","../src/spreadsheet/actions/find-and-replace.js","../src/spreadsheet/actions/merge.js","../src/spreadsheet/actions/conditional-formatting.js","../src/ribbon/ribbon.js","../src/spreadsheet/integrations/color-picker.js","../src/spreadsheet/integrations/ribbon.js","../src/spreadsheet/integrations/formula-bar.js","../src/spreadsheet/integrations/formula.js","../src/spreadsheet/integrations/sheet-tabs.js","../src/spreadsheet/integrations/open.js","../src/spreadsheet/integrations/save.js","../src/spreadsheet/integrations/context-menu.js","../src/spreadsheet/integrations/number-format.js","../src/spreadsheet/integrations/sort.js","../src/spreadsheet/integrations/filter.js","../src/spreadsheet/integrations/image.js","../src/spreadsheet/integrations/chart.js","../src/spreadsheet/common/basic-module.js","../src/spreadsheet/common/all-module.js","../src/spreadsheet/common/class.js","../src/spreadsheet/common/constant.js","../src/spreadsheet/renderer/sheet.js","../src/spreadsheet/renderer/row.js","../src/spreadsheet/renderer/cell.js","../src/spreadsheet/renderer/render.js","../src/spreadsheet/services/dialog.js","../src/spreadsheet/services/action-events.js","../src/spreadsheet/services/overlay.js","../src/spreadsheet/base/spreadsheet.js"],"sourcesContent":["import { isNullOrUndefined } from '@syncfusion/ej2-base';\nimport { getSheetIndex, getSheetNameFromAddress } from '../base/index';\n/**\n * To get range indexes.\n */\nexport function getRangeIndexes(range) {\n    var cellindexes;\n    var indexes = [];\n    range = range.indexOf('!') > -1 ? range.split('!')[1] : range;\n    range = range.indexOf(':') === -1 ? range + ':' + range : range;\n    range.split(':').forEach(function (address) {\n        cellindexes = getCellIndexes(address);\n        indexes.push(cellindexes[0]);\n        indexes.push(cellindexes[1]);\n    });\n    return indexes;\n}\n/**\n * To get single cell indexes\n */\nexport function getCellIndexes(address) {\n    return [parseInt(address.match(/\\d+/)[0], 10) - 1, getColIndex(address.match(/[A-Z]+/i)[0].toUpperCase())];\n}\n/**\n * To get column index from text.\n * @hidden\n */\nexport function getColIndex(text) {\n    var colIdx = 0;\n    text = text.split('').reverse().join('');\n    for (var i = text.length - 1; i >= 0; i--) {\n        colIdx += (text[i].charCodeAt(0) - 64) * (Math.pow(26, i));\n    }\n    return colIdx - 1;\n}\n/**\n * To get cell address from given row and column index.\n */\nexport function getCellAddress(sRow, sCol) {\n    return getColumnHeaderText(sCol + 1) + (sRow + 1);\n}\n/**\n * To get range address from given range indexes.\n */\nexport function getRangeAddress(range) {\n    return getCellAddress(range[0], range[1]) + ':' + (!isNullOrUndefined(range[2]) ?\n        getCellAddress(range[2], range[3]) : getCellAddress(range[0], range[1]));\n}\n/**\n * To get column header cell text\n */\nexport function getColumnHeaderText(colIndex) {\n    var alphabet = 'Z';\n    if (colIndex / 26 > 1) {\n        return getColumnHeaderText((colIndex % 26 === 0) ? (colIndex / 26 - 1) : Math.floor(colIndex / 26))\n            + String.fromCharCode((colIndex % 26) === 0 ? alphabet.charCodeAt(0) : 64 + (colIndex % 26));\n    }\n    else {\n        return String.fromCharCode(64 + (colIndex));\n    }\n}\n/**\n * @hidden\n */\nexport function getIndexesFromAddress(address) {\n    return getRangeIndexes(getRangeFromAddress(address));\n}\n/**\n * @hidden\n */\nexport function getRangeFromAddress(address) {\n    return address.split('!')[1] || address;\n}\n/**\n * Get complete address for selected range\n * @hidden\n */\nexport function getAddressFromSelectedRange(sheet) {\n    return sheet.name + '!' + sheet.selectedRange;\n}\n/**\n * @hidden\n */\nexport function getAddressInfo(context, address) {\n    var sIdx;\n    if (address.indexOf('!') > -1) {\n        sIdx = getSheetIndex(context, getSheetNameFromAddress(address));\n    }\n    else {\n        sIdx = context.activeSheetIndex;\n    }\n    return { sheetIndex: sIdx, indices: getIndexesFromAddress(address) };\n}\n/**\n * Given range will be swapped/arranged in increasing order.\n * @hidden\n */\nexport function getSwapRange(range) {\n    var clonedRange = range.slice();\n    if (range[0] > range[2]) {\n        swap(clonedRange, 0, 2);\n    }\n    if (range[1] > range[3]) {\n        swap(clonedRange, 1, 3);\n    }\n    return clonedRange;\n}\n/**\n * Interchange values in an array\n */\nfunction swap(range, x, y) {\n    var tmp = range[x];\n    range[x] = range[y];\n    range[y] = tmp;\n}\n/**\n * @hidden\n */\nexport function isSingleCell(range) {\n    return range[0] === range[2] && range[1] === range[3];\n}\n","/**\n * Worker task.\n */\nexport function executeTaskAsync(context, taskFn, callbackFn, data, preventCallback) {\n    return new WorkerHelper(context, taskFn, callbackFn, data, preventCallback);\n}\n/**\n * @hidden\n * The `WorkerHelper` module is used to perform multiple actions using Web Worker asynchronously.\n */\nvar WorkerHelper = /** @class */ (function () {\n    /**\n     * Constructor for WorkerHelper module in Workbook library.\n     * @private\n     */\n    function WorkerHelper(context, task, defaultListener, taskData, preventCallback) {\n        this.preventCallback = false;\n        this.context = context;\n        this.workerTask = task;\n        this.defaultListener = defaultListener;\n        this.workerData = taskData;\n        if (preventCallback) {\n            this.preventCallback = true;\n        }\n        this.initWorker();\n    }\n    /**\n     * To terminate the worker task.\n     * @private\n     */\n    WorkerHelper.prototype.terminate = function () {\n        this.worker.terminate();\n        URL.revokeObjectURL(this.workerUrl);\n    };\n    /**\n     * To initiate the worker.\n     * @private\n     */\n    WorkerHelper.prototype.initWorker = function () {\n        var taskBlob = new Blob([this.getFnCode()], { type: 'text/javascript' });\n        this.workerUrl = URL.createObjectURL(taskBlob);\n        this.worker = new Worker(this.workerUrl);\n        this.worker.onmessage = this.messageFromWorker.bind(this);\n        this.worker.onerror = this.onError.bind(this);\n        this.worker.postMessage(this.workerData);\n    };\n    /**\n     * Method for getting response from worker.\n     * @private\n     */\n    WorkerHelper.prototype.messageFromWorker = function (args) {\n        this.terminate();\n        this.defaultListener.apply(this.context, [args.data]);\n    };\n    /**\n     * Method for getting error message from worker if failed.\n     * @private\n     */\n    WorkerHelper.prototype.onError = function (args) {\n        this.terminate();\n        throw args.message || args;\n    };\n    /**\n     * Construct function code for worker.\n     * @private\n     */\n    WorkerHelper.prototype.getFnCode = function () {\n        var workerCode = '';\n        var i;\n        var keys;\n        var workerFunction = '';\n        var isHaveFunction = false;\n        if (typeof this.workerTask === 'function') {\n            if (this.workerTask.toString().indexOf('function') < 0) {\n                workerFunction = 'function ' + this.workerTask.toString();\n            }\n            else {\n                workerFunction = this.workerTask.toString();\n                isHaveFunction = true;\n            }\n            workerCode += ('self.workerTask = ' + workerFunction + '; \\n');\n        }\n        else {\n            if (typeof this.workerTask === 'object') {\n                keys = Object.keys(this.workerTask);\n                for (i = 0; i < keys.length; i++) {\n                    if (this.workerTask[keys[i]].toString().indexOf('function') < 0) {\n                        workerFunction = 'function ' + this.workerTask[keys[i]].toString();\n                    }\n                    else {\n                        workerFunction = this.workerTask[keys[i]].toString();\n                        isHaveFunction = true;\n                    }\n                    workerCode += ((i === 0 ? 'self.workerTask' : keys[i]) + '= ' + workerFunction + '; \\n');\n                }\n            }\n        }\n        workerCode += 'self.onmessage = ' + (isHaveFunction ? '' : ' function ') +\n            (this.preventCallback ? this.getMessageFn.toString() : this.getCallbackMessageFn.toString()) + '; \\n';\n        return workerCode;\n    };\n    /**\n     * Get default worker task with callback.\n     * @private\n     */\n    WorkerHelper.prototype.getCallbackMessageFn = function (args) {\n        postMessage(this.workerTask.apply(this, args.data));\n    };\n    /**\n     * Get default worker task without callback.\n     * @private\n     */\n    WorkerHelper.prototype.getMessageFn = function (args) {\n        this.workerTask.apply(this, args.data);\n    };\n    return WorkerHelper;\n}());\n","import { isNullOrUndefined, getDefaultDateObject } from '@syncfusion/ej2-base';\n/**\n * @hidden\n */\nexport function toFraction(val) {\n    var strVal = val.toString();\n    if (val === parseInt(strVal, 10)) {\n        return parseInt(strVal, 10) + '  ';\n    }\n    else {\n        var top_1 = strVal.indexOf('.') > -1 ? strVal.split('.')[1] : 0;\n        var bottom = Math.pow(10, top_1.toString().replace('-', '').length);\n        var abs = Math.abs(getGcd(top_1, bottom));\n        return (top_1 / abs) + '/' + (bottom / abs);\n    }\n}\n/**\n * @hidden\n */\nexport function getGcd(a, b) {\n    a = Number(a);\n    b = Number(b);\n    return (b) ? getGcd(b, a % b) : a;\n}\n/**\n * @hidden\n */\nexport function intToDate(val) {\n    val = Number(val);\n    val = (val > 0 && val < 1) ? (1 + val) : (val === 0) ? 1 : val;\n    if (val > 60) {\n        val -= 1; // Due to leap year issue of 1900 in MSExcel.\n    }\n    return new Date(((val - 1) * (1000 * 3600 * 24)) + new Date('01/01/1900').getTime());\n}\n/**\n * @hidden\n */\n/* tslint:disable no-any */\nexport function dateToInt(val, isTime) {\n    var startDate = new Date('01/01/1900');\n    var date = isDateTime(val) ? val : new Date(val);\n    var startDateUTC = Date.UTC(startDate.getFullYear(), startDate.getMonth(), startDate.getDate(), startDate.getHours(), startDate.getMinutes(), startDate.getSeconds(), startDate.getMilliseconds());\n    var dateUTC = Date.UTC(date.getFullYear(), date.getMonth(), date.getDate(), date.getHours(), date.getMinutes(), date.getSeconds(), date.getMilliseconds());\n    var diffDays = ((dateUTC - startDateUTC) / (1000 * 3600 * 24));\n    return isTime ? diffDays : parseInt(diffDays.toString(), 10) + 2;\n}\n/**\n * @hidden\n */\nexport function isDateTime(date) {\n    return Object.prototype.toString.call(date) === '[object Date]' && !isNaN(date.valueOf());\n}\n/**\n * @hidden\n */\nexport function isNumber(val) {\n    return val - parseFloat(val) >= 0;\n}\n/**\n * @hidden\n */\nexport function toDate(text, intl, format) {\n    var defaultDateFormats = getDefaultDateObject();\n    var availabelDateTimeFormat = defaultDateFormats.dateTimeFormats.availableFormats;\n    var dObj = { dateObj: null, isCustom: false, type: '' };\n    if (typeof text === 'string') {\n        text = text.toUpperCase();\n    }\n    if (format) {\n        dObj.dateObj = intl.parseDate(text, { format: format });\n        if (dObj.dateObj) {\n            dObj.type = text.toString().indexOf(':') > -1 ? 'time' : 'datetime';\n            dObj.isCustom = true;\n        }\n    }\n    if (isNullOrUndefined(dObj.dateObj)) {\n        for (var _i = 0, _a = Object.keys(defaultDateFormats.dateFormats); _i < _a.length; _i++) {\n            var key = _a[_i];\n            dObj.dateObj = intl.parseDate(text, { format: defaultDateFormats.dateFormats[key], skeleton: key });\n            if (dObj.dateObj) {\n                dObj.type = 'date';\n                dObj.isCustom = false;\n                break;\n            }\n        }\n        if (isNullOrUndefined(dObj.dateObj)) {\n            for (var _b = 0, _c = Object.keys(availabelDateTimeFormat); _b < _c.length; _b++) {\n                var key = _c[_b];\n                dObj.dateObj = intl.parseDate(text, { format: availabelDateTimeFormat[key], skeleton: key });\n                if (dObj.dateObj) {\n                    dObj.type = text.toString().indexOf(':') > -1 ? 'time' : 'datetime';\n                    if (dObj.type === 'time') {\n                        var time = dObj.dateObj.toLocaleTimeString();\n                        dObj.dateObj = new Date('01/01/1900 ' + time);\n                    }\n                    dObj.isCustom = true;\n                    break;\n                }\n            }\n        }\n        if (isNullOrUndefined(dObj.dateObj)) {\n            for (var _d = 0, _e = Object.keys(defaultDateFormats.timeFormats); _d < _e.length; _d++) {\n                var key = _e[_d];\n                dObj.dateObj = intl.parseDate(text, { format: defaultDateFormats.timeFormats[key], skeleton: key });\n                if (dObj.dateObj) {\n                    var time = dObj.dateObj.toLocaleTimeString();\n                    dObj.dateObj = new Date('01/01/1900 ' + time);\n                    dObj.type = 'time';\n                    dObj.isCustom = false;\n                    break;\n                }\n            }\n        }\n    }\n    if (text !== '#DIV/0!' && !dObj.dateObj && new Date(text).toString() !== 'Invalid Date') {\n        dObj.dateObj = new Date(text);\n    }\n    return dObj;\n}\n","import { getRangeIndexes } from '../common/index';\nimport { getCell, getSheet, setCell, getSheetIndex } from '../base/index';\nimport { Internationalization, getNumberDependable, getNumericObject, isNullOrUndefined } from '@syncfusion/ej2-base';\nimport { isNumber, toFraction, intToDate, toDate, dateToInt } from '../common/math';\nimport { applyNumberFormatting, getFormattedCellObject, refreshCellElement, checkDateFormat, getFormattedBarText } from '../common/event';\n/**\n * Specifies number format.\n */\nvar WorkbookNumberFormat = /** @class */ (function () {\n    function WorkbookNumberFormat(parent) {\n        this.parent = parent;\n        this.localeObj = getNumericObject(this.parent.locale);\n        /* tslint:disable:no-any */\n        this.decimalSep = this.localeObj.decimal;\n        this.groupSep = this.localeObj.group;\n        this.addEventListener();\n    }\n    WorkbookNumberFormat.prototype.numberFormatting = function (args) {\n        var activeSheetIndex = this.parent.activeSheetIndex;\n        if (args.range && args.range.indexOf('!') > -1) {\n            activeSheetIndex = getSheetIndex(this.parent, args.range.split('!')[0]);\n        }\n        var sheet = this.parent.sheets[activeSheetIndex];\n        var formatRange = args.range ? ((args.range.indexOf('!') > -1) ?\n            args.range.split('!')[1] : args.range) : sheet.selectedRange;\n        var selectedRange = getRangeIndexes(formatRange);\n        var cell;\n        for (var i = selectedRange[0]; i <= selectedRange[2]; i++) {\n            for (var j = selectedRange[1]; j <= selectedRange[3]; j++) {\n                setCell(i, j, sheet, { format: args.format }, true);\n                cell = getCell(i, j, sheet, true);\n                this.getFormattedCell({\n                    type: getTypeFromFormat(cell.format), value: cell.value,\n                    format: cell.format, rowIndex: i, colIndex: j,\n                    sheetIndex: activeSheetIndex, cell: cell\n                });\n            }\n        }\n    };\n    /**\n     * @hidden\n     */\n    WorkbookNumberFormat.prototype.getFormattedCell = function (args) {\n        var fResult = isNullOrUndefined(args.value) ? '' : args.value;\n        var sheet = this.parent.sheets[isNullOrUndefined(args.sheetIndex) ? this.parent.activeSheetIndex :\n            args.sheetIndex];\n        var range = getRangeIndexes(sheet.activeCell);\n        var sheetIdx = Number(args.sheetIndex) ? Number(args.sheetIndex) : this.parent.activeSheetIndex;\n        var cell = args.cell ? args.cell : getCell(range[0], range[1], sheet);\n        var rightAlign = false;\n        var currencySymbol = getNumberDependable(this.parent.locale, 'USD');\n        if (args.format === '' || args.format === 'General') {\n            cell = cell ? cell : {};\n            var dateEventArgs = {\n                value: args.value, rowIndex: range[0], colIndex: range[1], sheetIndex: this.parent.activeSheetIndex,\n                updatedVal: args.value, isDate: false, isTime: false\n            };\n            this.checkDateFormat(dateEventArgs);\n            if (dateEventArgs.isDate) {\n                rightAlign = true;\n                cell.value = args.value = dateEventArgs.updatedVal;\n                cell.format = args.format = getFormatFromType('ShortDate');\n            }\n            else if (dateEventArgs.isTime) {\n                rightAlign = true;\n                cell.value = args.value = dateEventArgs.updatedVal;\n                cell.format = args.format = getFormatFromType('Time');\n            }\n        }\n        args.type = args.format ? getTypeFromFormat(args.format) : 'General';\n        var result = this.processFormats(args, fResult, rightAlign, cell);\n        if ((this.parent.getActiveSheet().id - 1 === sheetIdx)) {\n            this.parent.notify(refreshCellElement, {\n                isRightAlign: result.rightAlign, result: result.fResult || args.value,\n                rowIndex: args.rowIndex, colIndex: args.colIndex, sheetIndex: args.sheetIndex,\n                type: args.type, curSymbol: currencySymbol, value: args.value || ''\n            });\n        }\n        if (!args.onLoad && (args.rowIndex > sheet.usedRange.rowIndex || args.colIndex > sheet.usedRange.colIndex)) {\n            this.parent.setUsedRange(args.rowIndex, args.colIndex);\n        }\n        args.formattedText = result.fResult || args.value;\n        args.isRightAlign = result.rightAlign;\n        args.curSymbol = currencySymbol;\n        return args.formattedText;\n    };\n    WorkbookNumberFormat.prototype.processFormats = function (args, fResult, isRightAlign, cell) {\n        var intl = new Internationalization();\n        var currencySymbol = getNumberDependable(this.parent.locale, 'USD');\n        var result;\n        args.format = args.format ? args.format : 'General';\n        if (fResult !== '') {\n            switch (args.type) {\n                case 'General':\n                    result = this.autoDetectGeneralFormat({\n                        args: args, currencySymbol: currencySymbol, fResult: fResult, intl: intl,\n                        isRightAlign: isRightAlign, curCode: 'USD', cell: cell, rowIdx: Number(args.rowIdx),\n                        colIdx: Number(args.colIdx)\n                    });\n                    fResult = result.fResult;\n                    isRightAlign = result.isRightAlign;\n                    break;\n                case 'Number':\n                    if (isNumber(fResult)) {\n                        fResult = this.applyNumberFormat(args, intl);\n                        isRightAlign = true;\n                    }\n                    break;\n                case 'Currency':\n                    if (isNumber(fResult)) {\n                        fResult = this.currencyFormat(args, intl);\n                        isRightAlign = true;\n                    }\n                    break;\n                case 'Percentage':\n                    if (isNumber(fResult)) {\n                        fResult = this.percentageFormat(args, intl);\n                        isRightAlign = true;\n                    }\n                    break;\n                case 'Accounting':\n                    if (isNumber(fResult)) {\n                        fResult = this.accountingFormat(args, intl);\n                        isRightAlign = true;\n                    }\n                    break;\n                case 'ShortDate':\n                    fResult = this.shortDateFormat(args, intl);\n                    isRightAlign = fResult ? true : false;\n                    break;\n                case 'LongDate':\n                    fResult = this.longDateFormat(args, intl);\n                    isRightAlign = fResult ? true : false;\n                    break;\n                case 'Time':\n                    fResult = this.timeFormat(args, intl);\n                    isRightAlign = fResult ? true : false;\n                    break;\n                case 'Fraction':\n                    if (isNumber(fResult)) {\n                        fResult = this.fractionFormat(args);\n                        isRightAlign = true;\n                    }\n                    break;\n                case 'Scientific':\n                    if (isNumber(fResult)) {\n                        fResult = this.scientificFormat(args);\n                        isRightAlign = true;\n                    }\n                    break;\n                case 'Text':\n                    isRightAlign = false;\n                    break;\n            }\n        }\n        return { fResult: fResult, rightAlign: isRightAlign };\n    };\n    WorkbookNumberFormat.prototype.autoDetectGeneralFormat = function (options) {\n        if (isNumber(options.fResult)) {\n            if (options.args.format && options.args.format !== '') {\n                if (options.args.format.toString().indexOf('%') > -1) {\n                    options.fResult = this.percentageFormat(options.args, options.intl);\n                }\n                else if (options.args.format.toString().indexOf(options.currencySymbol) > -1) {\n                    options.fResult = this.currencyFormat(options.args, options.intl);\n                }\n                else {\n                    options.fResult = this.applyNumberFormat(options.args, options.intl);\n                }\n            }\n            if (options.args.format === 'General' && options.fResult && options.fResult.toString().split(this.decimalSep)[0].length > 11) {\n                options.fResult = this.scientificFormat(options.args);\n            }\n            options.isRightAlign = true;\n        }\n        if (!isNullOrUndefined(options.fResult)) {\n            var res = options.fResult.toString();\n            if (res.indexOf('%') > -1 && res.split('%')[0] !== '' && res.split('%')[1].trim() === '' &&\n                Number(res.split('%')[0].split(this.groupSep).join('')).toString() !== 'NaN' &&\n                !this.parent.isEdit) {\n                options.args.value = Number(res.split('%')[0].split(this.groupSep).join(''));\n                options.cell.format = options.args.format = getFormatFromType('Percentage');\n                options.fResult = this.percentageFormat(options.args, options.intl);\n                options.cell.value = options.args.value.toString();\n                setCell(options.rowIdx, options.colIdx, this.parent.getActiveSheet(), options.cell, true);\n                options.isRightAlign = true;\n            }\n            else if (res.indexOf(options.currencySymbol) > -1 && res.split(options.currencySymbol)[1] !== '' &&\n                Number(res.split(options.currencySymbol)[1].split(this.groupSep).join('')).toString() !== 'NaN' &&\n                !this.parent.isEdit) {\n                options.args.value = Number(res.split(options.currencySymbol)[1].split(this.groupSep).join(''));\n                options.cell.format = options.args.format = getFormatFromType('Currency');\n                options.fResult = this.currencyFormat(options.args, options.intl);\n                options.cell.value = options.args.value.toString();\n                setCell(options.rowIdx, options.colIdx, this.parent.getActiveSheet(), options.cell, true);\n                options.isRightAlign = true;\n            }\n        }\n        return { isRightAlign: options.isRightAlign, fResult: options.fResult };\n    };\n    WorkbookNumberFormat.prototype.findSuffix = function (zeros, resultSuffix) {\n        var len = zeros.length;\n        var suffixLen = len - resultSuffix.length;\n        return zeros.substr(0, suffixLen < 0 ? 0 : suffixLen) + resultSuffix;\n    };\n    WorkbookNumberFormat.prototype.applyNumberFormat = function (args, intl) {\n        args.format = this.isCustomFormat(args.format.toString());\n        var formatArr = args.format.toString().split(';');\n        if (Number(args.value) >= 0) {\n            args.format = formatArr[0];\n        }\n        else {\n            args.format = !isNullOrUndefined(formatArr[1]) ? formatArr[1].split('*').join(' ') : formatArr[0];\n        }\n        return intl.formatNumber(Number(args.value), {\n            format: args.format\n        });\n    };\n    WorkbookNumberFormat.prototype.isCustomFormat = function (format) {\n        if (format === '_-* #,##0.00_-;-* #,##0.00_-;_-* \"-\"_-;_-@_-' || format === '_-* #,##0_-;-* #,##0_-;_-* \"-\"_-;_-@_-') {\n            format = '';\n        }\n        format = format === '' ? getFormatFromType('Number') : format;\n        format = format.toString().split('_)').join(' ').split('_(').join(' ').split('[Red]').join('');\n        return format;\n    };\n    WorkbookNumberFormat.prototype.currencyFormat = function (args, intl) {\n        args.format = args.format === '' ? getFormatFromType('Currency') : args.format;\n        args.format = args.format.toString().split('_(').join(' ').split('_)').join(' ').split('[Red]').join('');\n        var formatArr = args.format.toString().split(';');\n        if (Number(args.value) >= 0) {\n            args.format = formatArr[0];\n        }\n        else {\n            args.format = isNullOrUndefined(formatArr[1]) ? formatArr[0] : formatArr[1].split('*').join(' ');\n        }\n        return intl.formatNumber(Number(args.value), {\n            format: args.format,\n            currency: 'USD'\n        });\n    };\n    WorkbookNumberFormat.prototype.percentageFormat = function (args, intl) {\n        args.format = args.format === '' ? getFormatFromType('Percentage') : args.format;\n        return intl.formatNumber(Number(args.value), {\n            format: args.format\n        });\n    };\n    WorkbookNumberFormat.prototype.accountingFormat = function (args, intl) {\n        args.format = args.format === '' ? getFormatFromType('Accounting') : args.format;\n        args.format = args.format.split('_(').join(' ').split('_)').join(' ').split('[Red]').join('').split('_').join('');\n        var currencySymbol = getNumberDependable(this.parent.locale, 'USD');\n        var formatArr = args.format.split(';');\n        if (Number(args.value) >= 0) {\n            args.format = formatArr[0];\n        }\n        else {\n            args.format = formatArr[1].split('*').join(' ');\n        }\n        if (Number(args.value) === 0) {\n            return currencySymbol + '- ';\n        }\n        else {\n            return intl.formatNumber(Number(args.value), {\n                format: args.format,\n                currency: 'USD'\n            }).split('-').join('');\n        }\n    };\n    WorkbookNumberFormat.prototype.shortDateFormat = function (args, intl) {\n        var shortDate = intToDate(args.value);\n        var code = (args.format === '' || args.format === 'General') ? getFormatFromType('ShortDate')\n            : args.format.toString();\n        var dateObj;\n        if (code === getFormatFromType('ShortDate')) {\n            code = 'M/d/yy';\n            dateObj = {\n                type: 'date',\n                skeleton: 'yMd'\n            };\n        }\n        else {\n            dateObj = {\n                type: 'date',\n                format: code\n            };\n        }\n        return intl.formatDate(shortDate, dateObj);\n    };\n    WorkbookNumberFormat.prototype.longDateFormat = function (args, intl) {\n        var longDate = intToDate(args.value);\n        var code = (args.format === '' || args.format === 'General') ? getFormatFromType('LongDate')\n            : args.format.toString();\n        if (code === getFormatFromType('LongDate')) {\n            code = 'EEEE, MMMM d, y';\n        }\n        return intl.formatDate(longDate, {\n            type: 'date',\n            format: code\n        });\n    };\n    WorkbookNumberFormat.prototype.timeFormat = function (args, intl) {\n        if (isNullOrUndefined(args.value)) {\n            return '';\n        }\n        if (!isNullOrUndefined(args.value.toString().split(this.decimalSep)[1])) {\n            args.value = parseFloat('1' + this.decimalSep + args.value.toString().split(this.decimalSep)[1]) || args.value;\n        }\n        var time = intToDate(args.value);\n        var code = (args.format === '' || args.format === 'General') ? getFormatFromType('Time')\n            : args.format.toString();\n        if (code === getFormatFromType('Time')) {\n            code = 'h:mm:ss a';\n        }\n        return intl.formatDate(time, {\n            type: 'time',\n            skeleton: 'medium',\n            format: code\n        });\n    };\n    WorkbookNumberFormat.prototype.scientificFormat = function (args) {\n        args.format = args.format === '' ? getFormatFromType('Scientific') : args.format;\n        var zeros = args.format.split('+')[1];\n        var prefix = this.findDecimalPlaces(args.format, 'Scientific');\n        var fResult = Number(args.value).toExponential(prefix);\n        if (fResult.indexOf('e+') > -1) {\n            fResult = fResult.split('e+')[0] + 'E+' + this.findSuffix(zeros, fResult.split('e+')[1]);\n        }\n        else if (fResult.indexOf('e-') > -1) {\n            fResult = fResult.split('e-')[0] + 'E-' + +this.findSuffix(zeros, fResult.split('e-')[1]);\n        }\n        return fResult;\n    };\n    WorkbookNumberFormat.prototype.fractionFormat = function (args) {\n        args.format = args.format === '' ? getFormatFromType('Fraction') : args.format;\n        var suffix = '';\n        var fractionResult;\n        if (args.value.toString().indexOf(this.decimalSep) > -1 && isNumber(args.value)) {\n            suffix = args.value.toString().split(this.decimalSep)[0];\n            fractionResult = toFraction(Number(args.value));\n            return (Number(suffix) === 0) ? ' ' + fractionResult : suffix + ' ' + fractionResult;\n        }\n        return suffix;\n    };\n    WorkbookNumberFormat.prototype.findDecimalPlaces = function (code, type) {\n        switch (type) {\n            case 'Scientific':\n                var eIndex = code.toUpperCase().indexOf('E');\n                var decIndex = code.indexOf(this.decimalSep);\n                if (eIndex > -1) {\n                    return code.substring(decIndex + 1, eIndex).length;\n                }\n        }\n        return 2;\n    };\n    WorkbookNumberFormat.prototype.checkDateFormat = function (args) {\n        var dateObj;\n        var intl = new Internationalization();\n        var value = !isNullOrUndefined(args.value) ? args.value.toString() : '';\n        var checkedDate;\n        var cell = getCell(args.rowIndex, args.colIndex, getSheet(this.parent, isNullOrUndefined(args.sheetIndex) ? this.parent.activeSheetIndex : args.sheetIndex));\n        checkedDate = this.checkCustomDateFormat(value);\n        if (value && (value.indexOf('/') > -1 || value.indexOf('-') > 0 || value.indexOf(':') > -1) && checkedDate !== 'Invalid') {\n            value = checkedDate;\n            if (value && value.indexOf('/') > -1 || value.indexOf('-') > 0 || value.indexOf(':') > -1) {\n                dateObj = toDate(value, intl, cell && cell.format);\n                if (!isNullOrUndefined(dateObj.dateObj) && dateObj.dateObj.toString() !== 'Invalid Date') {\n                    cell = cell ? cell : {};\n                    value = dateToInt(dateObj.dateObj, value.indexOf(':') > -1).toString();\n                    if (!cell.format || cell.format === '') {\n                        if (dateObj.type === 'time') {\n                            cell.format = getFormatFromType('Time');\n                        }\n                        else {\n                            cell.format = getFormatFromType('ShortDate');\n                        }\n                    }\n                    args.isDate = dateObj.type === 'date' || dateObj.type === 'datetime';\n                    args.isTime = dateObj.type === 'time';\n                    args.dateObj = dateObj.dateObj;\n                }\n            }\n            args.updatedVal = value;\n        }\n    };\n    WorkbookNumberFormat.prototype.checkCustomDateFormat = function (val) {\n        var dateArr = val.indexOf('/') > -1 ? val.split('/') : val.indexOf('-') > 0 ? val.split('-') : '';\n        var months = ['jan', 'feb', 'mar', 'apr', 'may', 'jun', 'jul', 'aug', 'sep', 'sept', 'oct', 'nov', 'dec'];\n        if (dateArr.length === 2) {\n            if (months.indexOf(dateArr[0].toLowerCase()) > -1 && Number(dateArr[1]) <= 31) {\n                return '01-' + dateArr[0] + '-' + dateArr[1];\n            }\n            else if (months.indexOf(dateArr[1].toLowerCase()) > -1 && Number(dateArr[0]) <= 31) {\n                return dateArr[0] + '-' + dateArr[1] + '-' + new Date().getFullYear();\n            }\n            else if (Number(dateArr[0]) <= 31 && Number(dateArr[1]) <= 12) {\n                return dateArr[0] + '-' + dateArr[1] + '-' + new Date().getFullYear();\n            }\n            if (Number(dateArr[1]) <= 31 && Number(dateArr[0]) <= 12) {\n                return dateArr[0] + '-' + dateArr[1] + '-' + new Date().getFullYear();\n            }\n            if (Number(dateArr[0]) <= 12 && Number(dateArr[1]) <= 9999 && Number(dateArr[1]) >= 1900) {\n                return '01-' + dateArr[0] + '-' + dateArr[1];\n            }\n            else {\n                return 'Invalid';\n            }\n        }\n        return val;\n    };\n    WorkbookNumberFormat.prototype.formattedBarText = function (args) {\n        var type = getTypeFromFormat(args.cell ? args.cell.format : '');\n        var intl = new Internationalization();\n        var beforeText = args.value;\n        var date = (type === 'ShortDate' && args.cell && args.cell.format) ?\n            args.cell.format : getFormatFromType('ShortDate');\n        var time = getFormatFromType('Time');\n        switch (type) {\n            case 'ShortDate':\n            case 'LongDate':\n                args.value = this.shortDateFormat({ type: type, value: args.value, format: date }, intl);\n                break;\n            case 'Time':\n                args.value = this.shortDateFormat({ type: type, value: args.value, format: date }, intl) + ' ' +\n                    this.timeFormat({ type: type, value: args.value, format: time }, intl);\n                break;\n        }\n        if (!args.value || (args.value && args.value.toString().indexOf('null') > -1)) {\n            args.value = beforeText;\n        }\n    };\n    /**\n     * Adding event listener for number format.\n     */\n    WorkbookNumberFormat.prototype.addEventListener = function () {\n        this.parent.on(applyNumberFormatting, this.numberFormatting, this);\n        this.parent.on(getFormattedCellObject, this.getFormattedCell, this);\n        this.parent.on(checkDateFormat, this.checkDateFormat, this);\n        this.parent.on(getFormattedBarText, this.formattedBarText, this);\n    };\n    /**\n     * Removing event listener for number format.\n     */\n    WorkbookNumberFormat.prototype.removeEventListener = function () {\n        if (!this.parent.isDestroyed) {\n            this.parent.off(applyNumberFormatting, this.numberFormatting);\n            this.parent.off(getFormattedCellObject, this.getFormattedCell);\n            this.parent.off(checkDateFormat, this.checkDateFormat);\n            this.parent.off(getFormattedBarText, this.formattedBarText);\n        }\n    };\n    /**\n     * To Remove the event listeners.\n     */\n    WorkbookNumberFormat.prototype.destroy = function () {\n        this.removeEventListener();\n        this.parent = null;\n    };\n    /**\n     * Get the workbook number format module name.\n     */\n    WorkbookNumberFormat.prototype.getModuleName = function () {\n        return 'workbookNumberFormat';\n    };\n    return WorkbookNumberFormat;\n}());\nexport { WorkbookNumberFormat };\n/**\n * To Get the number built-in format code from the number format type.\n * @param {string} type - Specifies the type of the number formatting.\n */\nexport function getFormatFromType(type) {\n    var code = 'General';\n    switch (type.split(' ').join('')) {\n        case 'Number':\n            code = '0.00';\n            break;\n        case 'Currency':\n            code = '$#,##0.00';\n            break;\n        case 'Accounting':\n            code = '_($* #,##0.00_);_($* (#,##0.00);_($* \"-\"??_);_(@_)';\n            break;\n        case 'ShortDate':\n            code = 'mm-dd-yyyy';\n            break;\n        case 'LongDate':\n            code = 'dddd, mmmm dd, yyyy';\n            break;\n        case 'Time':\n            code = 'h:mm:ss AM/PM';\n            break;\n        case 'Percentage':\n            code = '0.00%';\n            break;\n        case 'Fraction':\n            code = '# ?/?';\n            break;\n        case 'Scientific':\n            code = '0.00E+00';\n            break;\n        case 'Text':\n            code = '@';\n            break;\n    }\n    return code;\n}\n/**\n * @hidden\n */\nexport function getTypeFromFormat(format) {\n    var code = 'General';\n    switch (format) {\n        case '0.00':\n        case '_-* #,##0.00_-;-* #,##0.00_-;_-* \"-\"_-;_-@_-':\n        case '_-* #,##0_-;-* #,##0_-;_-* \"-\"_-;_-@_-':\n            code = 'Number';\n            break;\n        case '$#,##0.00':\n        case '$#,##0_);[Red]($#,##0)':\n        case '$#,##0.00_);[Red]($#,##0.00)':\n        case '$#,##0.00_);($#,##0.00)':\n        case '$#,##0_);($#,##0)':\n            code = 'Currency';\n            break;\n        case '_($*#,##0.00_);_($*(#,##0.00);_($*\"-\"??_);_(@_)':\n        case '_($*#,##0.00_);_($* (#,##0.00);_($*\"-\"??_);_(@_)':\n        case '_($* #,##0.00_);_($* (#,##0.00);_($* \"-\"??_);_(@_)':\n        case '_ $ * #,##0.00_ ;_ $ * -#,##0.00_ ;_ $ * \"-\"??_ ;_ @_ ':\n            code = 'Accounting';\n            break;\n        case 'mm-dd-yyyy':\n        case 'dd-mm-yyyy':\n        case 'dd-mm-yy':\n        case 'mm-dd-yy':\n        case 'dd/MM/yyyy':\n        case 'yyyy-MM-dd':\n            code = 'ShortDate';\n            break;\n        case 'dddd, mmmm dd, yyyy':\n            code = 'LongDate';\n            break;\n        case 'h:mm:ss AM/PM':\n            code = 'Time';\n            break;\n        case '0.00%':\n        case '0%':\n            code = 'Percentage';\n            break;\n        case '# ?/?':\n        case '# ??/??':\n        case '# ???/???':\n            code = 'Fraction';\n            break;\n        case '0.00E+00':\n            code = 'Scientific';\n            break;\n        case '@':\n            code = 'Text';\n            break;\n    }\n    return code;\n}\n","/**\n * Represent the common codes for calculate\n */\nvar CalculateCommon = /** @class */ (function () {\n    function CalculateCommon(parent) {\n        this.parent = parent;\n    }\n    /**\n     * For internal use only - Get the module name.\n     * @private\n     */\n    CalculateCommon.prototype.getModuleName = function () {\n        return 'calc-common';\n    };\n    return CalculateCommon;\n}());\nexport { CalculateCommon };\n/**\n * To check whether the object is undefined.\n * @param {Object} value - To check the object is undefined\n * @return {boolean}\n * @private\n */\nexport function isUndefined(value) {\n    return ('undefined' === typeof value);\n}\n/** @hidden */\nexport function getSkeletonVal(value) {\n    switch (value) {\n        case 'dd-MMM-yyyy':\n        case 'dd MMM yyyy':\n            value = 'medium';\n            break;\n        case 'MMM-yyyy':\n        case 'MMM yyyy':\n            value = 'yMMM';\n            break;\n        case 'MM-dd-yyyy': //short\n        case 'dd-MM-yyyy':\n        case 'dd-MM-yy':\n        case 'MM/dd/yyyy':\n        case 'dd/MM/yyyy':\n        case 'dd/MM/yy':\n            value = 'short';\n            break;\n        case 'dddd MMMM dd yyyy': //long\n        case 'dd MMMM yyyy':\n            value = 'long';\n            break;\n        case 'd MMMM yyyy':\n            value = 'yMMMd';\n            break;\n        case 'yyyy':\n            value = 'y';\n            break;\n        case 'h:mm':\n            value = 'Hm';\n            break;\n        case 'h:mm tt':\n            value = 'hm';\n            break;\n        case 'h':\n            value = 'H';\n            break;\n        case 'h tt':\n            value = 'h';\n            break;\n        case 'dddd':\n            value = 'E';\n            break;\n        case 'h:mm:ss tt':\n            value = 'hms';\n            break;\n        case 'h:mm:ss':\n            value = 'Hms';\n            break;\n        case 'd':\n            value = 'd';\n            break;\n        case 'd dddd':\n            value = 'Ed';\n            break;\n        case 'M':\n            value = 'M';\n            break;\n        case 'Md':\n            value = 'Md';\n            break;\n        case 'MMM':\n            value = 'MMM';\n            break;\n        case 'ddd MMM d':\n            value = 'MMMEd';\n            break;\n        case 'MMM d':\n            value = 'MMMd';\n            break;\n        case 'M/yyyy':\n            value = 'yM';\n            break;\n        default:\n            value = '';\n            break;\n    }\n    return value;\n}\n","/**\n * Represents the getModules function.\n * @param {Calculate} context\n */\nexport function getModules(context) {\n    var modules = [];\n    if (context.includeBasicFormulas) {\n        modules.push({\n            member: 'basic-formulas',\n            args: [context]\n        });\n    }\n    return modules;\n}\n","/**\n * Module loading operations\n */\nimport { isNullOrUndefined, isUndefined } from '@syncfusion/ej2-base';\nvar MODULE_SUFFIX = 'Module';\n/**\n * To get nameSpace value from the desired object.\n * @param {string} nameSpace - String value to the get the inner object\n * @param {any} obj - Object to get the inner object value.\n * @return {any}\n * @private\n */\nexport function getValue(nameSpace, obj) {\n    /* tslint:disable no-any */\n    var value = obj;\n    var splits = nameSpace.replace(/\\[/g, '.').replace(/\\]/g, '').split('.');\n    for (var j = 0; j < splits.length && !isUndefined(value); j++) {\n        value = value[splits[j]];\n    }\n    return value;\n}\n/**\n * To set value for the nameSpace in desired object.\n * @param {string} nameSpace - String value to get the inner object\n * @param {any} value - Value that you need to set.\n * @param {any} obj - Object to get the inner object value.\n * @return {void}\n * @private\n */\nexport function setValue(nameSpace, value, obj) {\n    var keyValues = nameSpace.replace(/\\[/g, '.').replace(/\\]/g, '').split('.');\n    var start = obj || {};\n    var fromObj = start;\n    var j;\n    var length = keyValues.length;\n    var key;\n    for (j = 0; j < length; j++) {\n        key = keyValues[j];\n        if (j + 1 === length) {\n            fromObj[key] = value === undefined ? {} : value;\n        }\n        else if (isNullOrUndefined(fromObj[key])) {\n            fromObj[key] = {};\n        }\n        fromObj = fromObj[key];\n    }\n    return start;\n}\nvar ModuleLoader = /** @class */ (function () {\n    function ModuleLoader(parent) {\n        this.loadedModules = [];\n        this.parent = parent;\n    }\n    ;\n    /**\n     * Inject required modules in component library\n     * @hidden\n     */\n    ModuleLoader.prototype.inject = function (requiredModules, moduleList) {\n        var reqLengthVal = requiredModules.length;\n        if (reqLengthVal === 0) {\n            this.clean();\n            return;\n        }\n        if (this.loadedModules.length) {\n            this.clearUnusedModule(requiredModules);\n        }\n        for (var i = 0; i < reqLengthVal; i++) {\n            var modl = requiredModules[i];\n            for (var _i = 0, moduleList_1 = moduleList; _i < moduleList_1.length; _i++) {\n                var module = moduleList_1[_i];\n                var modName = modl.member;\n                if (module.prototype.getModuleName() === modl.member && !this.isModuleLoaded(modName)) {\n                    var moduleObject = this.createInstance(module, modl.args);\n                    var memberName = this.getMemberName(modName);\n                    if (modl.isProperty) {\n                        setValue(memberName, module, this.parent);\n                    }\n                    else {\n                        setValue(memberName, moduleObject, this.parent);\n                    }\n                    var loadedModule = modl;\n                    loadedModule.member = memberName;\n                    this.loadedModules.push(loadedModule);\n                }\n            }\n        }\n    };\n    /**\n     * Create Instance from constructor function with desired parameters.\n     * @param {Function} classFunction - Class function to which need to create instance\n     * @param {any[]} params - Parameters need to passed while creating instance\n     * @return {any}\n     * @private\n     */\n    ModuleLoader.prototype.createInstance = function (classFunction, params) {\n        var arrayParam = params;\n        arrayParam.unshift(undefined);\n        return new (Function.prototype.bind.apply(classFunction, arrayParam));\n    };\n    /**\n     * To remove the created object while control is destroyed\n     * @hidden\n     */\n    ModuleLoader.prototype.clean = function () {\n        for (var _i = 0, _a = this.loadedModules; _i < _a.length; _i++) {\n            var modules = _a[_i];\n            if (!modules.isProperty) {\n                getValue(modules.member, this.parent).destroy();\n            }\n        }\n        this.loadedModules = [];\n    };\n    /**\n     * Removes all unused modules\n     * @param {ModuleDeclaration[]} moduleListName\n     * @returns {void}\n     */\n    ModuleLoader.prototype.clearUnusedModule = function (moduleListName) {\n        var _this = this;\n        var usedModule = moduleListName.map(function (arg) { return _this.getMemberName(arg.member); });\n        var removeModule = this.loadedModules.filter(function (module) {\n            return usedModule.indexOf(module.member) === -1;\n        });\n        for (var _i = 0, removeModule_1 = removeModule; _i < removeModule_1.length; _i++) {\n            var moduleName = removeModule_1[_i];\n            if (!moduleName.isProperty) {\n                getValue(moduleName.member, this.parent).destroy();\n            }\n            this.loadedModules.splice(this.loadedModules.indexOf(moduleName), 1);\n            this.deleteObject(this.parent, moduleName.member);\n        }\n    };\n    /**\n     * To get the name of the member.\n     * @param {string} name\n     * @returns {string}\n     */\n    ModuleLoader.prototype.getMemberName = function (name) {\n        return name[0].toLowerCase() + name.substring(1) + MODULE_SUFFIX;\n    };\n    /**\n     * Delete an item from Object\n     * @param {any} obj - Object in which we need to delete an item.\n     * @param {string} params - String value to the get the inner object\n     * @return {void}\n     * @private\n     */\n    ModuleLoader.prototype.deleteObject = function (obj, key) {\n        delete obj[key];\n    };\n    /**\n     * Returns boolean based on whether the module specified is loaded or not\n     * @param {string} modName\n     * @returns {boolean}\n     */\n    ModuleLoader.prototype.isModuleLoaded = function (modName) {\n        for (var _i = 0, _a = this.loadedModules; _i < _a.length; _i++) {\n            var mod = _a[_i];\n            if (mod.member === this.getMemberName(modName)) {\n                return true;\n            }\n        }\n        return false;\n    };\n    return ModuleLoader;\n}());\nexport { ModuleLoader };\n","var __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    }\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\n/* tslint:disable-next-line:max-line-length */\nimport { getValue, Event, NotifyPropertyChanges, Base, Property, isNullOrUndefined, isUndefined } from '@syncfusion/ej2-base';\nimport { BasicFormulas } from './../formulas/index';\nimport { getModules, ModuleLoader } from '../common/index';\nimport { CommonErrors, FormulasErrorsStrings } from '../common/enum';\nimport { Parser } from './parser';\n/**\n * Represents the calculate library.\n */\nvar Calculate = /** @class */ (function (_super) {\n    __extends(Calculate, _super);\n    /**\n     * Base constructor for creating Calculate library.\n     */\n    function Calculate(parent) {\n        var _this = _super.call(this, null, null) || this;\n        _this.lFormulas = new Map();\n        /** @hidden */\n        _this.storedData = new Map();\n        _this.keyToRowsMap = new Map();\n        _this.rowsToKeyMap = new Map();\n        /** @hidden */\n        _this.rightBracket = String.fromCharCode(161);\n        /** @hidden */\n        _this.leftBracket = String.fromCharCode(162);\n        /** @hidden */\n        _this.sheetToken = '!';\n        _this.emptyString = '';\n        _this.leftBrace = '{';\n        _this.rightBrace = '}';\n        _this.cell = _this.emptyString;\n        _this.cellPrefix = '!0!A';\n        _this.treatEmptyStringAsZero = false;\n        /** @hidden */\n        _this.tic = '\\\"';\n        /** @hidden */\n        _this.singleTic = '\\'';\n        /** @hidden */\n        _this.trueValue = 'TRUE';\n        /** @hidden */\n        _this.falseValue = 'FALSE';\n        _this.parseDecimalSeparator = '.';\n        /** @hidden */\n        _this.arithMarker = String.fromCharCode(180);\n        /** @hidden */\n        _this.arithMarker2 = _this.arithMarker + _this.arithMarker;\n        _this.dependentCells = null;\n        _this.dependentFormulaCells = null;\n        _this.minValue = Number.MIN_SAFE_INTEGER;\n        _this.maxValue = Number.MAX_SAFE_INTEGER;\n        _this.categoryCollection = ['All'];\n        _this.dependencyLevel = 0;\n        _this.refreshedCells = new Map();\n        _this.computedValues = null;\n        /** @hidden */\n        _this.randomValues = new Map();\n        /** @hidden */\n        _this.isRandomVal = false;\n        /** @hidden */\n        _this.randCollection = [];\n        /**\n         * @hidden\n         */\n        _this.formulaErrorStrings = [\n            'binary operators cannot start an expression',\n            'cannot parse',\n            'bad library',\n            'invalid char in front of',\n            'number contains 2 decimal points',\n            'expression cannot end with an operator',\n            'invalid characters following an operator',\n            'invalid character in number',\n            'mismatched parentheses',\n            'unknown formula name',\n            'requires a single argument',\n            'requires 3 arguments',\n            'invalid Math argument',\n            'requires 2 arguments',\n            '#NAME?',\n            'too complex',\n            'circular reference: ',\n            'missing formula',\n            'improper formula',\n            'invalid expression',\n            'cell empty',\n            'bad formula',\n            'empty expression',\n            '',\n            'mismatched string quotes',\n            'wrong number of arguments',\n            'invalid arguments',\n            'iterations do not converge',\n            'Control is already registered',\n            'Calculation overflow',\n            'Missing sheet',\n            'cannot_parse',\n            'expression_cannot_end_with_an_operator'\n        ];\n        _this.errorStrings = null;\n        _this.parseArgumentSeparator = ',';\n        _this.dateTime1900 = new Date(1900, 0, 1, 0, 0, 0);\n        _this.isParseDecimalSeparatorChanged = false;\n        _this.isArgumentSeparatorChanged = false;\n        _this.sheetFamilyID = 0;\n        _this.defaultFamilyItem = null;\n        _this.sheetFamiliesList = null;\n        _this.modelToSheetID = null;\n        /** @hidden */\n        _this.tokenCount = 0;\n        _this.sortedSheetNames = null;\n        _this.tempSheetPlaceHolder = String.fromCharCode(133);\n        /** @hidden */\n        _this.namedRanges = new Map();\n        _this.formulaInfoTable = null;\n        _this.oaDate = new Date(1899, 11, 30);\n        _this.millisecondsOfaDay = 24 * 60 * 60 * 1000;\n        _this.parseDateTimeSeparator = '/';\n        var moduleLoader = new ModuleLoader(_this);\n        if (_this.includeBasicFormulas) {\n            Calculate_1.Inject(BasicFormulas);\n        }\n        if (_this.injectedModules && _this.injectedModules.length) {\n            moduleLoader.inject(_this.requiredModules(), _this.injectedModules);\n        }\n        _this.parentObject = isNullOrUndefined(parent) ? _this : parent;\n        _this.grid = _this.parentObject;\n        _this.parser = new Parser(_this);\n        return _this;\n    }\n    Calculate_1 = Calculate;\n    Object.defineProperty(Calculate.prototype, \"libraryFormulas\", {\n        /* tslint:disable-next-line:no-any */\n        get: function () {\n            return this.lFormulas;\n        },\n        /* tslint:disable-next-line:no-any */\n        set: function (formulaColl) {\n            this.lFormulas.set(formulaColl.fName, { handler: formulaColl.handler, category: formulaColl.category, description: formulaColl.description });\n        },\n        enumerable: true,\n        configurable: true\n    });\n    /**\n     * To get the argument separator to split the formula arguments.\n     * @returns string\n     */\n    Calculate.prototype.getParseArgumentSeparator = function () {\n        var seperator = ',';\n        if (!this.isArgumentSeparatorChanged && seperator !== this.parseArgumentSeparator) {\n            this.parseArgumentSeparator = seperator;\n        }\n        return this.parseArgumentSeparator;\n    };\n    /**\n     * To set the argument separator to split the formula arguments.\n     * @param {string} value - Argument separator based on the culture.\n     * @returns void\n     */\n    Calculate.prototype.setParseArgumentSeparator = function (value) {\n        this.parseArgumentSeparator = value;\n        this.isArgumentSeparatorChanged = true;\n    };\n    /**\n     * To get the date separator to split the date value.\n     * @returns string\n     */\n    Calculate.prototype.getParseDateTimeSeparator = function () {\n        return this.parseDateTimeSeparator;\n    };\n    /**\n     * To set whether the empty string is treated as zero or not.\n     * @param {boolean} value\n     * @returns boolean\n     */\n    Calculate.prototype.setTreatEmptyStringAsZero = function (value) {\n        this.treatEmptyStringAsZero = value;\n    };\n    /**\n     * To get whether the empty string is treated as zero or not.\n     * @returns boolean\n     */\n    Calculate.prototype.getTreatEmptyStringAsZero = function () {\n        return this.treatEmptyStringAsZero;\n    };\n    /**\n     * To set the date separator to split the date value.\n     * @param {string} value - Argument separator based on the culture.\n     * @returns void\n     */\n    Calculate.prototype.setParseDateTimeSeparator = function (value) {\n        this.parseDateTimeSeparator = value;\n    };\n    /**\n     * To provide the array of modules needed.\n     * @hidden\n     */\n    Calculate.prototype.requiredModules = function () {\n        return getModules(this);\n    };\n    /**\n     * Dynamically injects the required modules to the library.\n     * @hidden\n     */\n    Calculate.Inject = function () {\n        var moduleList = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            moduleList[_i] = arguments[_i];\n        }\n        if (!this.prototype.injectedModules) {\n            this.prototype.injectedModules = [];\n        }\n        for (var j = 0; j < moduleList.length; j++) {\n            if (this.prototype.injectedModules.indexOf(moduleList[j]) === -1) {\n                this.prototype.injectedModules.push(moduleList[j]);\n            }\n        }\n    };\n    /**\n     * Get injected modules\n     * @hidden\n     */\n    Calculate.prototype.getInjectedModules = function () {\n        return this.injectedModules;\n    };\n    Calculate.prototype.onPropertyChanged = function (newProp, oldProp) {\n        /** code snippets */\n    };\n    Calculate.prototype.getModuleName = function () {\n        return 'calculate';\n    };\n    /** @hidden */\n    Calculate.prototype.getFormulaCharacter = function () {\n        return '=';\n    };\n    /** @hidden */\n    Calculate.prototype.isUpperChar = function (text) {\n        var charCode = text.charCodeAt(0);\n        return ((charCode > 64) && (charCode < 91));\n    };\n    Calculate.prototype.resetKeys = function () {\n        this.storedData.clear();\n        this.keyToRowsMap.clear();\n        this.rowsToKeyMap.clear();\n    };\n    /**\n     * @hidden\n     */\n    Calculate.prototype.updateDependentCell = function (cellRef) {\n        var family = this.getSheetFamilyItem(this.grid);\n        var cell = this.cell;\n        if (cell !== this.emptyString) {\n            if (family.sheetNameToParentObject !== null) {\n                var token = family.parentObjectToToken.get(this.grid);\n                if (cell.indexOf(this.sheetToken) === -1) {\n                    cell = token + cell;\n                }\n                if (cellRef.indexOf(this.sheetToken) === -1) {\n                    cellRef = token + cellRef;\n                }\n            }\n            if (this.getDependentCells().has(cellRef)) {\n                var formulaCells = this.getDependentCells().get(cellRef);\n                if (formulaCells.indexOf(cell) < 0) {\n                    formulaCells.push(cell);\n                }\n            }\n            else {\n                this.getDependentCells().set(cellRef, [cell]);\n            }\n            this.addToFormulaDependentCells(cellRef);\n        }\n    };\n    Calculate.prototype.addToFormulaDependentCells = function (cellRef) {\n        var cell1 = this.cell;\n        var family = this.getSheetFamilyItem(this.grid);\n        if (family.sheetNameToParentObject != null && cell1.indexOf(this.sheetToken) === -1) {\n            var token = family.parentObjectToToken.get(this.grid);\n            cell1 = token + cell1;\n        }\n        if (!this.getDependentFormulaCells().has(cell1)) {\n            this.getDependentFormulaCells().set(cell1, new Map());\n            this.getDependentFormulaCells().get(cell1).set(cellRef, cellRef);\n        }\n        else if (!(this.getDependentFormulaCells().get(cell1)).has(cellRef)) {\n            this.getDependentFormulaCells().get(cell1).set(cellRef, cellRef);\n        }\n    };\n    /**\n     * @hidden\n     */\n    Calculate.prototype.getDependentCells = function () {\n        if (this.isSheetMember()) {\n            var family = this.getSheetFamilyItem(this.grid);\n            if (family.sheetDependentCells == null) {\n                family.sheetDependentCells = new Map();\n            }\n            return family.sheetDependentCells;\n        }\n        else {\n            if (this.dependentCells == null) {\n                this.dependentCells = new Map();\n            }\n            return this.dependentCells;\n        }\n    };\n    /**\n     * @hidden\n     */\n    Calculate.prototype.getDependentFormulaCells = function () {\n        if (this.isSheetMember()) {\n            var family = this.getSheetFamilyItem(this.grid);\n            if (family.sheetDependentFormulaCells == null) {\n                family.sheetDependentFormulaCells = new Map();\n            }\n            return family.sheetDependentFormulaCells;\n        }\n        else {\n            if (this.dependentFormulaCells == null) {\n                this.dependentFormulaCells = new Map();\n            }\n            return this.dependentFormulaCells;\n        }\n    };\n    /**\n     * To get library formulas collection.\n     * @returns Map<string, Function>\n     */\n    Calculate.prototype.getLibraryFormulas = function () {\n        return this.lFormulas;\n    };\n    /**\n     * To get library function.\n     * @param {string} libFormula - Library formula to get a corresponding function.\n     * @returns Function\n     */\n    Calculate.prototype.getFunction = function (libFormula) {\n        if (this.getLibraryFormulas().has(libFormula.toUpperCase())) {\n            return this.getLibraryFormulas().get(libFormula.toUpperCase()).handler;\n        }\n        else {\n            return null;\n        }\n    };\n    /** @hidden */\n    Calculate.prototype.intToDate = function (val) {\n        var dateVal = Number(val);\n        dateVal = (dateVal > 0 && dateVal < 1) ? (1 + dateVal) : (dateVal === 0) ? 1 : dateVal;\n        if (dateVal > 60) {\n            dateVal -= 1; // Due to leap year issue of 1900 in MSExcel.\n        }\n        return new Date(((dateVal - 1) * (1000 * 3600 * 24)) + new Date('01/01/1900').getTime());\n    };\n    Calculate.prototype.getFormulaInfoTable = function () {\n        if (this.isSheetMember()) {\n            var family = this.getSheetFamilyItem(this.grid);\n            if (family.sheetFormulaInfotable === null) {\n                family.sheetFormulaInfotable = new Map();\n            }\n            return family.sheetFormulaInfotable;\n        }\n        else {\n            if (this.formulaInfoTable === null) {\n                this.formulaInfoTable = new Map();\n            }\n            return this.formulaInfoTable;\n        }\n    };\n    /**\n     * To get the formula text.\n     * @private\n     */\n    Calculate.prototype.getFormula = function (key) {\n        key = key.toUpperCase();\n        if (this.storedData.has(key)) {\n            return this.storedData.get(key).getFormulaText();\n        }\n        return '';\n    };\n    /**\n     * To get the formula text.\n     * @returns void\n     */\n    Calculate.prototype.getParseDecimalSeparator = function () {\n        var seperator = '.';\n        if (!this.isParseDecimalSeparatorChanged && seperator !== this.parseDecimalSeparator) {\n            this.parseDecimalSeparator = seperator;\n        }\n        return this.parseDecimalSeparator;\n    };\n    /**\n     * To get the formula text.\n     * @param {string} value - Specifies the decimal separator value.\n     * @returns void\n     */\n    Calculate.prototype.setParseDecimalSeparator = function (value) {\n        this.parseDecimalSeparator = value;\n        this.isParseDecimalSeparatorChanged = true;\n    };\n    /** @hidden */\n    Calculate.prototype.getSheetToken = function (cellRef) {\n        var i = 0;\n        var temp = this.emptyString;\n        if (i < cellRef.length && cellRef[i] === this.sheetToken) {\n            i++;\n            while (i < cellRef.length && cellRef[i] !== this.sheetToken) {\n                i++;\n            }\n            temp = cellRef.substring(0, i + 1);\n        }\n        if (i < cellRef.length) {\n            return temp;\n        }\n        throw this.formulaErrorStrings[FormulasErrorsStrings.bad_index];\n    };\n    /** @hidden */\n    Calculate.prototype.getSheetID = function (grd) {\n        var family = this.getSheetFamilyItem(grd);\n        if (family.sheetNameToParentObject != null && family.sheetNameToParentObject.size > 0) {\n            var token = family.parentObjectToToken.get(grd);\n            token = token.split(this.sheetToken).join(this.emptyString);\n            var id = this.parseFloat(token);\n            if (!this.isNaN(id)) {\n                return id;\n            }\n        }\n        return -1;\n    };\n    /** @hidden */\n    Calculate.prototype.parseFloat = function (value) {\n        return Number(value);\n    };\n    /**\n     * To get the row index of the given cell.\n     * @param {string} cell - Cell address for getting row index.\n     * @returns number\n     */\n    Calculate.prototype.rowIndex = function (cell) {\n        var i = 0;\n        var result;\n        var isLetter = false;\n        if (i < cell.length && cell[i] === this.sheetToken) {\n            i++;\n            while (i < cell.length && cell[i] !== this.sheetToken) {\n                i++;\n            }\n            i++;\n        }\n        while (i < cell.length && this.isChar(cell[i])) {\n            isLetter = true;\n            i++;\n        }\n        result = parseInt(cell.substring(i), 10);\n        if (i < cell.length && !this.isNaN(result)) {\n            return result;\n        }\n        if (isLetter) {\n            return -1;\n        }\n        throw this.formulaErrorStrings[FormulasErrorsStrings.bad_index];\n    };\n    /**\n     * To get the column index of the given cell.\n     * @param {string} cell - Cell address for getting column index.\n     * @returns number\n     */\n    Calculate.prototype.colIndex = function (cell) {\n        var j = 0;\n        var k = 0;\n        cell = cell.toUpperCase();\n        if (j < cell.length && cell[j] === this.sheetToken) {\n            j++;\n            while (j < cell.length && cell[j] !== this.sheetToken) {\n                j++;\n            }\n            j++;\n        }\n        while (j < cell.length && this.isChar(cell[j])) {\n            var charCode = cell[j].charCodeAt(0);\n            k = k * 26 + charCode - 64;\n            j++;\n        }\n        if (k === 0) {\n            return -1;\n        }\n        return k;\n    };\n    /**\n     * To get the valid error strings.\n     * @hidden\n     */\n    Calculate.prototype.getErrorStrings = function () {\n        if (this.errorStrings === null) {\n            this.errorStrings = ['#N/A', '#VALUE!', '#REF!', '#DIV/0!', '#NUM!', '#NAME?', '#NULL!'];\n        }\n        return this.errorStrings;\n    };\n    /** @hidden */\n    Calculate.prototype.substring = function (text, startIndex, length) {\n        return text.substring(startIndex, length + startIndex);\n    };\n    /** @hidden */\n    Calculate.prototype.isChar = function (c) {\n        if ((c.charCodeAt(0) >= 65 && c.charCodeAt(0) <= 90) || (c.charCodeAt(0) >= 97 && c.charCodeAt(0) <= 122)) {\n            return true;\n        }\n        return false;\n    };\n    /** @hidden */\n    Calculate.prototype.getSheetFamilyItem = function (model) {\n        if (this.sheetFamilyID === 0) {\n            if (this.defaultFamilyItem == null) {\n                this.defaultFamilyItem = new CalcSheetFamilyItem();\n            }\n            return this.defaultFamilyItem;\n        }\n        if (this.sheetFamiliesList == null) {\n            this.sheetFamiliesList = new Map();\n        }\n        var i = this.modelToSheetID.get(model);\n        if (!this.sheetFamiliesList.has(i)) {\n            this.sheetFamiliesList.set(i, new CalcSheetFamilyItem());\n        }\n        return this.sheetFamiliesList.get(i);\n    };\n    /**\n     * Register a key value pair for formula.\n     * @param {string} key - Key for formula reference .\n     * @param {string | number} value - Value for the corresponding key.\n     * @returns void\n     */\n    Calculate.prototype.setKeyValue = function (key, value) {\n        key = key.toUpperCase();\n        var str = value.toString().trim();\n        if (!this.storedData.get(key) || str.indexOf(this.leftBrace) === 0) {\n            this.storedData.set(key, new FormulaInfo());\n            this.keyToRowsMap.set(key, this.keyToRowsMap.size + 1);\n            this.rowsToKeyMap.set(this.rowsToKeyMap.size + 1, key);\n        }\n        var fInfo = this.storedData.get(key);\n        if (fInfo.getFormulaText() != null && fInfo.getFormulaText().length > 0 && fInfo.getFormulaText() !== str) {\n            var s1 = this.cellPrefix + this.keyToRowsMap.get(key).toString();\n            var formulaDependent = this.getDependentFormulaCells().get(s1);\n            if (formulaDependent != null) {\n                this.clearFormulaDependentCells(s1);\n            }\n        }\n        if (str.length > 0 && str[0] === this.getFormulaCharacter()) {\n            fInfo.setFormulaText(str);\n        }\n        else if (fInfo.getFormulaValue() !== str) {\n            fInfo.setFormulaText('');\n            fInfo.setParsedFormula('');\n            fInfo.setFormulaValue(str);\n        }\n    };\n    /**\n     * @hidden\n     */\n    Calculate.prototype.clearFormulaDependentCells = function (cell) {\n        var _this = this;\n        var dependentFormula = this.getDependentFormulaCells().get(cell);\n        if (dependentFormula != null) {\n            dependentFormula.forEach(function (value, key) {\n                var s = key;\n                var dependent = _this.getDependentCells().get(s);\n                _this.arrayRemove(dependent, cell);\n                if (dependent.length === 0) {\n                    _this.getDependentCells().delete(s);\n                }\n            });\n            this.getDependentFormulaCells().delete(cell);\n        }\n    };\n    Calculate.prototype.arrayRemove = function (array, value) {\n        var index = array.indexOf(value);\n        if (index !== -1) {\n            array.splice(index, 1);\n        }\n        return array;\n    };\n    /**\n     * Register a key value pair for formula.\n     * @param {string} key - Key for getting the corresponding value.\n     * @returns string | number\n     */\n    Calculate.prototype.getKeyValue = function (key) {\n        key = key.toUpperCase();\n        if (this.storedData.has(key) !== null) {\n            var fInfo = this.storedData.get(key);\n            var fText = fInfo.getFormulaText();\n            if (fText.length > 0 && fText[0] === this.getFormulaCharacter()) {\n                this.cell = this.cellPrefix + this.keyToRowsMap.get(key).toString();\n                fText = fText.substring(1);\n                try {\n                    fInfo.setParsedFormula(this.parser.parseFormula(fText, key));\n                }\n                catch (ex) {\n                    var args = {\n                        message: ex.message, exception: ex, isForceCalculable: false,\n                        computeForceCalculate: false\n                    };\n                    this.trigger('onFailure', args);\n                    fInfo.setFormulaValue(args.message);\n                    return this.storedData.get(key).getFormulaValue();\n                }\n                try {\n                    fInfo.setFormulaValue(this.computeFormula(fInfo.getParsedFormula()));\n                }\n                catch (ex) {\n                    var args = {\n                        message: ex.message, exception: ex, isForceCalculable: false,\n                        computeForceCalculate: false\n                    };\n                    this.trigger('onFailure', args);\n                    var errorMessage = (typeof args.exception === 'string') ? args.exception : args.message;\n                    return (isNullOrUndefined(this.getErrorLine(ex)) ? '' : '#' + this.getErrorLine(ex) + ': ') + errorMessage;\n                }\n            }\n            return this.storedData.get(key).getFormulaValue();\n        }\n        else {\n            return this.emptyString;\n        }\n    };\n    Calculate.prototype.getNamedRanges = function () {\n        return this.namedRanges;\n    };\n    /**\n     * Adds a named range to the NamedRanges collection.\n     * @param {string} name - Name of the named range.\n     * @param {string} range - Range for the specified name.\n     * @param {number} sheetIndex - Defined scope for the specified name. Default - Workbook scope.\n     * @returns boolean\n     */\n    Calculate.prototype.addNamedRange = function (name, range) {\n        var sheetScopeName = name.split(this.sheetToken);\n        if (sheetScopeName.length > 1) {\n            var family = this.getSheetFamilyItem(this.grid);\n            if (!family.parentObjectToToken.get(sheetScopeName[0])) {\n                return false;\n            }\n            name = sheetScopeName[0] + this.sheetToken + sheetScopeName[1].toUpperCase();\n        }\n        else {\n            name = name.toUpperCase();\n        }\n        this.namedRanges.set(name, range);\n        return true;\n    };\n    /**\n     * Remove the specified named range form the named range collection.\n     * @param {string} name - Name of the specified named range.\n     * @returns boolean\n     */\n    Calculate.prototype.removeNamedRange = function (name) {\n        name = name.toUpperCase();\n        if (this.namedRanges.get(name) != null) {\n            this.namedRanges.delete(name);\n            return true;\n        }\n        return false;\n    };\n    /** @hidden */\n    Calculate.prototype.convertAlpha = function (col) {\n        var arrCol = [];\n        var n = 0;\n        var charText = 'A';\n        while (col > 0) {\n            col--;\n            var aCharValue = charText.charCodeAt(0);\n            arrCol[n] = String.fromCharCode(col % 26 + aCharValue);\n            col = parseInt((col / 26).toString(), 10);\n            n++;\n        }\n        var arr = [];\n        for (var i = 0; i < n; i++) {\n            arr[n - i - 1] = arrCol[i];\n        }\n        return arr.join('');\n    };\n    /** @hidden */\n    Calculate.prototype.getCellCollection = function (cellRange) {\n        if (cellRange.indexOf(':') < 0) {\n            if (!this.isCellReference(cellRange)) {\n                return cellRange.split(this.getParseArgumentSeparator());\n            }\n            else {\n                cellRange = cellRange + ':' + cellRange;\n            }\n        }\n        var token = this.emptyString;\n        var sheetTokenIndex = cellRange.indexOf(this.sheetToken);\n        if (sheetTokenIndex > -1) {\n            var index = sheetTokenIndex;\n            var s = index + 1;\n            while (s < cellRange.length) {\n                if (cellRange[s] === this.sheetToken) {\n                    token = cellRange.substr(0, s + 1);\n                    break;\n                }\n                s++;\n            }\n        }\n        var i = cellRange.indexOf(':');\n        var row1;\n        var row2;\n        var col1;\n        var col2;\n        if (i > 0 && this.isChar(cellRange[i - 1])) {\n            var k = i - 2;\n            while (k >= 0 && this.isDigit(cellRange[k])) {\n                k--;\n            }\n        }\n        row1 = this.rowIndex(this.substring(cellRange, 0, i));\n        row2 = this.rowIndex(this.substring(cellRange, i + 1, i + cellRange.length - i - 1));\n        col1 = this.colIndex(this.substring(cellRange, 0, i));\n        col2 = this.colIndex(this.substring(cellRange, i + 1, i + cellRange.length - i - 1));\n        if (row1 > row2) {\n            i = row2;\n            row2 = row1;\n            row1 = i;\n        }\n        if (col1 > col2) {\n            i = col2;\n            col2 = col1;\n            col1 = i;\n        }\n        var cells = [];\n        var j;\n        var c = 0;\n        for (i = row1; i <= row2; i++) {\n            for (j = col1; j <= col2; j++) {\n                cells[c] = token + this.emptyString + this.convertAlpha(j) + i.toString();\n                c++;\n            }\n        }\n        return cells;\n    };\n    /**\n     * Compute the given formula.\n     * @param {string} formulaText - Specifies to compute the given formula.\n     * @returns string | number\n     */\n    Calculate.prototype.computeFormula = function (formulaText) {\n        var parsedText;\n        var lastIndexOfq;\n        var formulatResult;\n        var nestedFormula = false;\n        var fNested;\n        if (this.parser.isError) {\n            return formulaText;\n        }\n        if (!this.parser.isFormulaParsed) {\n            parsedText = this.parser.parseFormula(formulaText);\n        }\n        else {\n            parsedText = formulaText;\n        }\n        this.parser.isFormulaParsed = false;\n        try {\n            lastIndexOfq = this.findLastIndexOfq(parsedText);\n            if (lastIndexOfq > 0) {\n                nestedFormula = true;\n            }\n            if (parsedText !== this.emptyString && lastIndexOfq > -1) {\n                var i = lastIndexOfq + 1;\n                while (i > -1) {\n                    if (parsedText[i] !== this.rightBracket) {\n                        i++;\n                        continue;\n                    }\n                    var sFormula = parsedText.substring(lastIndexOfq, i + 1);\n                    var libFormula = sFormula.split(this.leftBracket)[0].split('q').join(this.emptyString);\n                    var args = sFormula.substring(sFormula.indexOf(this.leftBracket) + 1, sFormula.indexOf(this.rightBracket))\n                        .split(this.getParseArgumentSeparator());\n                    if (this.getLibraryFormulas().get(libFormula.toUpperCase()).isCustom) {\n                        var j = 0;\n                        var customArgs = [];\n                        for (j = 0; j < args.length; j++) {\n                            customArgs.push(this.getValueFromArg(args[j]));\n                        }\n                        args = customArgs;\n                    }\n                    formulatResult = isNullOrUndefined(this.getFunction(libFormula)) ? this.getErrorStrings()[CommonErrors.name] : this.getFunction(libFormula).apply(void 0, args);\n                    if (nestedFormula) {\n                        fNested = this.processNestedFormula(parsedText, sFormula, formulatResult);\n                        var q = this.findLastIndexOfq(fNested);\n                        if (q === 0) {\n                            nestedFormula = false;\n                        }\n                        if (q === -1) {\n                            formulatResult = this.computeValue(fNested);\n                        }\n                        lastIndexOfq = i = q;\n                        parsedText = fNested;\n                        continue;\n                    }\n                    break;\n                }\n            }\n            else if (this.formulaErrorStrings.indexOf(parsedText) > -1) {\n                formulatResult = parsedText;\n            }\n            else if (parsedText !== this.emptyString && lastIndexOfq === -1) {\n                formulatResult = this.computeValue(parsedText);\n            }\n        }\n        catch (ex) {\n            var args = { message: ex.message, exception: ex, isForceCalculable: false, computeForceCalculate: false };\n            this.trigger('onFailure', args);\n            var errorMessage = (typeof args.exception === 'string') ? args.exception : args.message;\n            formulatResult = (isNullOrUndefined(this.getErrorLine(ex)) ? '' : '#' + this.getErrorLine(ex) + ': ') + errorMessage;\n        }\n        return formulatResult;\n    };\n    /** @hidden */\n    Calculate.prototype.computeSumIfAndAvgIf = function (range) {\n        if (isNullOrUndefined(range) || range[0] === this.emptyString || range.length === 0) {\n            return this.formulaErrorStrings[FormulasErrorsStrings.wrong_number_arguments];\n        }\n        var argArr = range;\n        var argCount = argArr.length;\n        if (argCount !== 2 && argCount !== 3 && argCount === 0) {\n            return this.formulaErrorStrings[FormulasErrorsStrings.wrong_number_arguments];\n        }\n        var rangevalue = argArr[0];\n        var criteria = argArr[1].trim();\n        criteria = criteria.split(this.tic).join(this.emptyString);\n        if (criteria.length > 255) {\n            return this.getErrorStrings()[CommonErrors.value];\n        }\n        var opt = this.parser.tokenEqual;\n        if (criteria.startsWith('<=')) {\n            opt = this.parser.tokenLessEq;\n            criteria = criteria.substring(2);\n        }\n        else if (criteria.startsWith('>=')) {\n            opt = this.parser.tokenGreaterEq;\n            criteria = criteria.substring(2);\n        }\n        else if (criteria.startsWith('<>')) {\n            opt = this.parser.tokenNotEqual;\n            criteria = criteria.substring(2);\n        }\n        else if (criteria.startsWith('<')) {\n            opt = this.parser.tokenLess;\n            criteria = criteria.substring(1);\n        }\n        else if (criteria.startsWith('>')) {\n            opt = this.parser.tokenGreater;\n            criteria = criteria.substring(1);\n        }\n        else if (criteria.startsWith('=')) {\n            opt = this.parser.tokenEqual;\n            criteria = criteria.substring(1);\n        }\n        var checkCriteria = this.parseFloat(criteria);\n        var criteriaRangeArray = argArr[0];\n        var sumRange = this.getCellCollection(argCount > 2 ? argArr[2] : rangevalue);\n        var criteriaRange = this.getCellCollection(criteriaRangeArray);\n        var result = this.getComputeSumIfValue(criteriaRange, sumRange, criteria, checkCriteria, opt);\n        return [result[0], result[1]];\n    };\n    /** @hidden */\n    Calculate.prototype.computeLookup = function (range) {\n        if (range.length === 0) {\n            return this.formulaErrorStrings[FormulasErrorsStrings.wrong_number_arguments];\n        }\n        var checkCrte = [];\n        var findMaxVal = [];\n        var argArr = range;\n        var argCount = argArr.length;\n        var criterias = argArr[0].split(this.tic).join(this.emptyString);\n        var rangevalue = argArr[1];\n        var lookupRangeArray = argCount === 2 ? rangevalue : argArr[2];\n        var criteriaRange = this.getCellCollection(argArr[1]);\n        var lookupRange = this.getCellCollection(lookupRangeArray);\n        for (var i = 0; i < criteriaRange.length; i++) {\n            findMaxVal[i] = this.getValueFromArg(criteriaRange[i]).split(this.tic).join('');\n        }\n        var s = findMaxVal.toString().split(this.getParseArgumentSeparator());\n        var maxVal = this.parseFloat(s[s.sort().length - 1]);\n        var minVal = this.parseFloat(s[0]);\n        for (var j = 0; j < criteriaRange.length; j++) {\n            checkCrte[j] = this.getValueFromArg(criteriaRange[j]).split(this.tic).join('');\n            if (criterias === checkCrte[j]) {\n                return this.getValueFromArg(lookupRange[j]).split(this.tic).join('');\n            }\n            else if (this.parseFloat(criterias) === this.parseFloat(checkCrte[j])) {\n                return this.getValueFromArg(lookupRange[j]).split(this.tic).join('');\n            }\n            else if (this.parseFloat(criterias) < minVal) {\n                return this.getErrorStrings()[CommonErrors.na];\n            }\n            else if (this.parseFloat(criterias) > maxVal) {\n                var index = findMaxVal.indexOf(maxVal.toString());\n                return this.getValueFromArg(lookupRange[index]).split(this.tic).join('');\n            }\n        }\n        if (findMaxVal.indexOf(criterias) < 0) {\n            var temp = [];\n            for (var n = 0; n < s.length; n++) {\n                if (this.parseFloat(criterias) > this.parseFloat(s[n])) {\n                    temp.push(s[n]);\n                }\n            }\n            var index = findMaxVal.indexOf(temp[temp.length - 1]);\n            return this.getValueFromArg(lookupRange[index]).split(this.tic).join('');\n        }\n        return this.getErrorStrings()[CommonErrors.na];\n    };\n    Calculate.prototype.computeVLookup = function (range) {\n        var argArr = range;\n        var findMaxValue = [];\n        var lookupValue = argArr[0].split(this.tic).join('');\n        if (lookupValue.indexOf(':') > -1) {\n            return this.getErrorStrings()[CommonErrors.value];\n        }\n        if (this.isCellReference(lookupValue)) {\n            lookupValue = this.getValueFromArg(lookupValue);\n        }\n        if (argArr[1].indexOf(':') < -1) {\n            return this.getErrorStrings()[CommonErrors.na];\n        }\n        var lookupRange = [];\n        var firstCol = '';\n        var secCol = '';\n        if (this.isCellReference(argArr[1])) {\n            lookupRange = this.getCellCollection(argArr[1]);\n            if (argArr[1].indexOf(':') > -1) {\n                var index = argArr[1].indexOf(':');\n                for (var i = 0; i < index; i++) {\n                    var tempCell = this.isChar(argArr[1][i]) ? argArr[1][i] : '';\n                    firstCol = firstCol + tempCell;\n                }\n                for (var j = index; j < argArr[1].length; j++) {\n                    var tempCell2 = this.isChar(argArr[1][j]) ? argArr[1][j] : '';\n                    secCol = secCol + tempCell2;\n                }\n            }\n        }\n        var lookupCol = this.colIndex(firstCol) + this.parseFloat(argArr[2]);\n        if (lookupCol > this.colIndex(secCol)) {\n            return this.getErrorStrings()[CommonErrors.na];\n        }\n        if (lookupCol === this.colIndex(firstCol)) {\n            return this.getErrorStrings()[CommonErrors.na];\n        }\n        var lookupCell = this.convertAlpha(lookupCol);\n        argArr[3] = isNullOrUndefined(argArr[3]) ? this.trueValue : argArr[3].split(this.tic).join('');\n        var cellValue = '';\n        for (var i = 0; i < lookupRange.length; i++) {\n            findMaxValue[i] = this.getValueFromArg(lookupRange[i]).split(this.tic).join('');\n        }\n        var s = findMaxValue.toString().split(this.getParseArgumentSeparator());\n        var maxValue = this.parseFloat(s[s.sort().length - 1]);\n        var minValue = this.parseFloat(s[0]);\n        for (var j = 0; j < lookupRange.length; j++) {\n            cellValue = this.getValueFromArg(lookupRange[j]);\n            if (argArr[3].toUpperCase() === this.trueValue) {\n                if (lookupValue === cellValue) {\n                    return this.getValueFromArg(lookupCell + j).split(this.tic).join('');\n                }\n                else if (this.parseFloat(lookupValue) === this.parseFloat(cellValue)) {\n                    return this.getValueFromArg(lookupCell + j).split(this.tic).join('');\n                }\n                else if (this.parseFloat(lookupValue) < minValue) {\n                    return this.getErrorStrings()[CommonErrors.na];\n                }\n                else if (this.parseFloat(lookupValue) > maxValue) {\n                    var index = findMaxValue.indexOf(maxValue.toString());\n                    return this.getValueFromArg(lookupCell + index).split(this.tic).join('');\n                }\n            }\n            if (argArr[3] === this.falseValue) {\n                if (lookupValue === cellValue) {\n                    return this.getValueFromArg(lookupCell + j);\n                }\n            }\n        }\n        return this.getErrorStrings()[CommonErrors.na];\n    };\n    Calculate.prototype.findWildCardValue = function (lookVal, cellValue) {\n        var finalText = '';\n        if (lookVal.indexOf('?') > -1) {\n            var index = lookVal.indexOf('?');\n            var checStr1 = lookVal[index - 1];\n            var checStr2 = lookVal[index + 1];\n            if (cellValue.indexOf(checStr1) > -1 && cellValue.indexOf(checStr2) > -1) {\n                var newIndex = cellValue.indexOf(checStr1);\n                if (cellValue[newIndex] === checStr1 && cellValue[newIndex + 2] === checStr2) {\n                    finalText = lookVal;\n                }\n                else {\n                    finalText = cellValue;\n                }\n            }\n            else {\n                finalText = cellValue;\n            }\n        }\n        else if (lookVal.indexOf('*') > -1) {\n            var index = lookVal.indexOf('*');\n            var left = '';\n            var right = '';\n            var compRight = this.falseValue;\n            var compLeft = this.falseValue;\n            for (var i = index - 1; i >= 0; i--) {\n                left = left + lookVal[i];\n                compLeft = this.trueValue;\n            }\n            for (var i = index + 1; i < lookVal.length; i++) {\n                right = right + lookVal[i];\n                compRight = this.trueValue;\n            }\n            var leftVal = left === '' ? -1 : cellValue.indexOf(left.split('').reverse().join(''));\n            var rightVal = right === '' ? -1 : cellValue.indexOf(right);\n            if (leftVal > -1 || rightVal > -1) {\n                if (compLeft === this.trueValue) {\n                    finalText = (left.split('').reverse().join('') === cellValue.substr(0, left.length)) ? lookVal : cellValue;\n                }\n                else if (compRight === this.trueValue) {\n                    finalText = (right === cellValue.substring(cellValue.length - right.length, cellValue.length)) ? lookVal : cellValue;\n                }\n            }\n            else {\n                finalText = cellValue;\n            }\n        }\n        return finalText;\n    };\n    /** @hidden */\n    /* tslint:disable-next-line */\n    Calculate.prototype.getComputeSumIfValue = function (criteriaRange, sumRange, criteria, checkCriteria, op) {\n        var sum = 0;\n        var count = 0;\n        switch (op) {\n            case this.parser.tokenEqual:\n                {\n                    for (var i = 0; i < criteriaRange.length; i++) {\n                        var value = this.getValueFromArg(criteriaRange[i].split(this.tic).join(''));\n                        var val = this.parseFloat(value);\n                        if (value === criteria && val === checkCriteria) {\n                            var value1 = this.getValueFromArg(sumRange[i].split(this.tic).join(''));\n                            var val1 = this.parseFloat(value1);\n                            sum = sum + val1;\n                            count = count + 1;\n                        }\n                        else if (value === criteria) {\n                            var sumRangeVal = sumRange[i];\n                            sumRangeVal = this.getValueFromArg(sumRangeVal);\n                            sum = this.parseFloat(sumRangeVal.toString());\n                            count = count + 1;\n                        }\n                    }\n                }\n                break;\n            case this.parser.tokenLess:\n                {\n                    for (var i = 0; i < criteriaRange.length; i++) {\n                        var value = this.getValueFromArg(criteriaRange[i].split(this.tic).join(''));\n                        var val = this.parseFloat(value);\n                        if (val < checkCriteria) {\n                            var value1 = this.getValueFromArg(sumRange[i].split(this.tic).join(''));\n                            var val1 = this.parseFloat(value1);\n                            sum = sum + val1;\n                            count = count + 1;\n                        }\n                    }\n                }\n                break;\n            case this.parser.tokenGreater:\n                {\n                    for (var i = 0; i < criteriaRange.length; i++) {\n                        var value = this.getValueFromArg(criteriaRange[i].split(this.tic).join(''));\n                        var val = this.parseFloat(value);\n                        if (val > checkCriteria) {\n                            var value1 = this.getValueFromArg(sumRange[i].split(this.tic).join(''));\n                            var val1 = this.parseFloat(value1);\n                            sum = sum + val1;\n                            count = count + 1;\n                        }\n                    }\n                }\n                break;\n            case this.parser.tokenLessEq:\n                {\n                    for (var i = 0; i < criteriaRange.length; i++) {\n                        var value = this.getValueFromArg(criteriaRange[i].split(this.tic).join(''));\n                        var val = this.parseFloat(value);\n                        if (val <= checkCriteria) {\n                            var value1 = this.getValueFromArg(sumRange[i].split(this.tic).join(''));\n                            var val1 = this.parseFloat(value1);\n                            sum = sum + val1;\n                            count = count + 1;\n                        }\n                    }\n                }\n                break;\n            case this.parser.tokenGreaterEq:\n                {\n                    for (var i = 0; i < criteriaRange.length; i++) {\n                        var value = this.getValueFromArg(criteriaRange[i].split(this.tic).join(''));\n                        var val = this.parseFloat(value);\n                        if (val >= checkCriteria) {\n                            var value1 = this.getValueFromArg(sumRange[i].split(this.tic).join(''));\n                            var val1 = this.parseFloat(value1);\n                            sum = sum + val1;\n                            count = count + 1;\n                        }\n                    }\n                }\n                break;\n            case this.parser.tokenNotEqual:\n                {\n                    for (var i = 0; i < criteriaRange.length; i++) {\n                        var value = this.getValueFromArg(criteriaRange[i].split(this.tic).join(''));\n                        var val = this.parseFloat(value);\n                        if (value !== criteria && val !== checkCriteria) {\n                            var value1 = this.getValueFromArg(sumRange[i].split(this.tic).join(''));\n                            var val1 = this.parseFloat(value1);\n                            sum = sum + val1;\n                            count = count + 1;\n                        }\n                    }\n                }\n                break;\n        }\n        return [sum, count];\n    };\n    /** @hidden */\n    Calculate.prototype.computeAndOr = function (args, op) {\n        var result = op === 'and' ? true : false;\n        var value;\n        var parseVal;\n        if (args.length === 0) {\n            return this.formulaErrorStrings[FormulasErrorsStrings.wrong_number_arguments];\n        }\n        for (var l = 0, len = args.length; l < len; l++) {\n            if (args[l].split(this.tic).join('').trim() === this.emptyString) {\n                return this.getErrorStrings()[CommonErrors.value];\n            }\n        }\n        var ranges = args;\n        for (var i = 0; i < ranges.length; i++) {\n            if (ranges[i] === (this.tic)) {\n                return this.getErrorStrings()[CommonErrors.value];\n            }\n            if (ranges[i].indexOf(':') > -1 && this.isCellReference(ranges[i])) {\n                var cells = this.getCellCollection(ranges[i]);\n                for (var j = 0; j < cells.length; j++) {\n                    if (this.getErrorStrings().indexOf(cells[j]) > -1) {\n                        return cells[j];\n                    }\n                    else if (cells[j][0] === this.tic) {\n                        return this.getErrorStrings()[CommonErrors.name];\n                    }\n                    value = this.getValueFromArg(cells[j]);\n                    if (value === '') {\n                        value = this.trueValue;\n                    }\n                    if (this.getErrorStrings().indexOf(value) > -1) {\n                        return value;\n                    }\n                    parseVal = this.parseFloat(value);\n                }\n            }\n            else {\n                value = this.getValueFromArg(ranges[i]).split(this.tic).join('').toUpperCase();\n                if (this.getErrorStrings().indexOf(value) > -1) {\n                    return value;\n                }\n                var tempdate = Date.parse(value.split(this.tic).join(''));\n                if (!isNaN(tempdate)) {\n                    result = true;\n                }\n                else if (!(value === this.trueValue || value === this.falseValue)) {\n                    return this.getErrorStrings()[CommonErrors.value].toString();\n                }\n                parseVal = this.parseFloat(value);\n            }\n            result = op === 'and' ? (result && ((value === this.trueValue) || !(isNaN(parseVal)))) :\n                (result || ((value === this.trueValue) || !(isNaN(parseVal))));\n        }\n        return result ? this.trueValue : this.falseValue;\n    };\n    /** @hidden */\n    // To strip out the tic from the formula arguments.\n    Calculate.prototype.removeTics = function (text) {\n        if (text.length > 1 && text[0] === this.tic[0] && text[text.length - 1] === this.tic[0]) {\n            text = this.substring(text, 1, text.length - 2);\n        }\n        return text;\n    };\n    /** @hidden */\n    Calculate.prototype.getCellFrom = function (range) {\n        var cellRange = '';\n        var cells = range.indexOf(':') > -1 ? range.split(':') : [range];\n        //this.getCellsFromArgs(range);\n        var last = cells.length - 1;\n        var r1 = this.rowIndex(cells[0]);\n        var x;\n        if (r1 === this.rowIndex(cells[last])) {\n            var c1 = this.colIndex(cells[0]);\n            var c2 = this.colIndex(cells[last]);\n            var c = this.colIndex(this.cell);\n            if (c >= c1 && c <= c2) {\n                cellRange = getAlphalabel(c).toString() + r1.toString();\n            }\n        }\n        else if (this.colIndex(cells[0]) === this.colIndex(cells[last])) {\n            x = this.colIndex(cells[0]);\n            var r2 = this.rowIndex(cells[last]);\n            var r = this.rowIndex(this.cell);\n            if (r >= r1 && r <= r2) {\n                cellRange = getAlphalabel(x).toString() + r.toString();\n            }\n        }\n        return cellRange;\n    };\n    /* tslint:disable-next-line:max-func-body-length */\n    Calculate.prototype.computeValue = function (pFormula) {\n        try {\n            var stack = [];\n            var i = 0;\n            var sheet = '';\n            stack.length = 0;\n            while (i < pFormula.length) {\n                var uFound = pFormula[i] === 'u'; // for 3*-2\n                if (pFormula[i] === this.arithMarker) {\n                    i = i + 1;\n                    continue;\n                }\n                else if (this.isDigit(pFormula[i])) {\n                    var s = this.emptyString;\n                    while (i < pFormula.length && (this.isDigit(pFormula[i]) || pFormula[i] === this.parseDecimalSeparator)) {\n                        s = s + pFormula[i];\n                        i = i + 1;\n                    }\n                    stack.push(s);\n                }\n                if (pFormula[i] === this.sheetToken) {\n                    sheet = pFormula[i];\n                    i = i + 1;\n                    while (i < pFormula.length && pFormula[i] !== this.sheetToken) {\n                        sheet = sheet + pFormula[i];\n                        i = i + 1;\n                    }\n                    if (i < pFormula.length) {\n                        sheet = sheet + pFormula[i];\n                        i = i + 1;\n                    }\n                }\n                else if (this.isUpperChar(pFormula[i])) {\n                    var s = this.emptyString;\n                    var textName = '';\n                    while (i < pFormula.length && this.isUpperChar(pFormula[i])) {\n                        var char = pFormula[i];\n                        s = s + char;\n                        i = i + 1;\n                    }\n                    while (i < pFormula.length && this.isDigit(pFormula[i])) {\n                        var digit = pFormula[i];\n                        s = s + digit;\n                        i = i + 1;\n                    }\n                    if (i < pFormula.length && pFormula[i] === ':') {\n                        s = s + pFormula[i];\n                        i = i + 1;\n                        if (i < pFormula.length && pFormula[i] === this.sheetToken) {\n                            s = s + pFormula[i];\n                            i = i + 1;\n                            while (i < pFormula.length && pFormula[i] !== this.sheetToken) {\n                                s = s + pFormula[i];\n                                i = i + 1;\n                            }\n                        }\n                        while (i < pFormula.length && this.isUpperChar(pFormula[i])) {\n                            s = s + pFormula[i];\n                            i = i + 1;\n                        }\n                        while (i < pFormula.length && this.isDigit(pFormula[i])) {\n                            s = s + pFormula[i];\n                            i = i + 1;\n                        }\n                        s = sheet + this.getCellFrom(s);\n                    }\n                    else {\n                        s = sheet + s;\n                    }\n                    textName = this.getParentObjectCellValue(s).toString();\n                    if (typeof textName === 'string' && this.getErrorStrings().indexOf(textName) > -1) {\n                        return textName;\n                    }\n                    stack.push(textName);\n                }\n                else if (pFormula[i] === 'q') {\n                    var leftIdx = pFormula.substring(i + 1).indexOf(this.leftBracket);\n                    var j = pFormula.substring(i + leftIdx + 1).indexOf(this.rightBracket);\n                    pFormula = this.substring(pFormula, i + leftIdx + 2, j - 1);\n                }\n                else if (pFormula[i] === this.tic[0]) {\n                    var s = pFormula[i].toString();\n                    i = i + 1;\n                    while (i < pFormula.length && pFormula[i] !== this.tic[0]) {\n                        s = s + pFormula[i];\n                        i = i + 1;\n                    }\n                    stack.push(s.split(this.tic).join(this.emptyString));\n                    i = i + 1;\n                }\n                else if (pFormula[i] === '%' && stack.length > 0) {\n                    var stackValue = stack[0];\n                    var value = this.parseFloat(stackValue);\n                    if (!this.isNaN(value)) {\n                        stack.pop();\n                        stack.push((value / 100).toString());\n                    }\n                    i = i + 1;\n                }\n                else if ((pFormula.substring(i)).indexOf(this.trueValue) === 0) {\n                    stack.push(this.trueValue);\n                    i += this.trueValue.length;\n                }\n                else if (pFormula.substring(i).indexOf(this.falseValue) === 0) {\n                    stack.push(this.falseValue);\n                    i += this.falseValue.length;\n                }\n                else if (pFormula[i] === this.tic[0] || pFormula[i] === '|') {\n                    var s = pFormula[i].toString();\n                    i++;\n                    while (i < pFormula.length && pFormula[i] !== this.tic[0]) {\n                        s = s + pFormula[i];\n                        i = i + 1;\n                    }\n                    stack.push(s + this.tic);\n                    i += 1;\n                }\n                else {\n                    switch (pFormula[i]) {\n                        case '#':\n                            {\n                                var errIndex = 0;\n                                if (this.getErrorStrings().indexOf(pFormula.substring(i)) > -1) {\n                                    if (pFormula.indexOf('!') === -1 || pFormula.substring(i).indexOf('!') === -1) {\n                                        errIndex = pFormula.indexOf('#N/A') > -1 ?\n                                            (pFormula.indexOf('#N/A') + 4 + i) : pFormula.indexOf('?') + 1 + i;\n                                    }\n                                    else {\n                                        errIndex = pFormula.indexOf('!') + 1 + i;\n                                    }\n                                    stack.push(this.substring(pFormula, i, errIndex - i));\n                                }\n                                else {\n                                    errIndex = i + 1;\n                                    stack.push(this.substring(pFormula, i, errIndex - i));\n                                }\n                                i = errIndex;\n                            }\n                            break;\n                        case 'n':\n                            {\n                                i = i + 1;\n                                var s = '';\n                                if (pFormula.substring(i).indexOf('Infinity') === 0) {\n                                    s = 'Infinity';\n                                    i += s.length;\n                                }\n                                else {\n                                    if (pFormula[i] === 'u' || uFound) {\n                                        s = '-';\n                                        if (!uFound) {\n                                            i = i + 1;\n                                        }\n                                        else {\n                                            uFound = false;\n                                        }\n                                    }\n                                    while (i < pFormula.length && (this.isDigit(pFormula[i]))\n                                        || pFormula[i] === this.getParseDecimalSeparator()) {\n                                        s = s + pFormula[i];\n                                        i = i + 1;\n                                    }\n                                    if (i < pFormula.length && pFormula[i] === '%') {\n                                        i = i + 1;\n                                        if (s === '') {\n                                            if (stack.length > 0) {\n                                                var stackValue = stack[0];\n                                                var value = this.parseFloat(stackValue);\n                                                if (!this.isNaN(value)) {\n                                                    stack.pop();\n                                                    stack.push((value / 100).toString());\n                                                }\n                                            }\n                                        }\n                                        else {\n                                            s = (this.parseFloat(s) / 100).toString();\n                                        }\n                                    }\n                                }\n                                stack.push(s);\n                            }\n                            break;\n                        case this.parser.tokenAdd:\n                            {\n                                this.getValArithmetic(stack, 'add');\n                                i = i + 1;\n                            }\n                            break;\n                        case this.parser.tokenSubtract:\n                            {\n                                this.getValArithmetic(stack, 'sub');\n                                i = i + 1;\n                            }\n                            break;\n                        case this.parser.tokenMultiply:\n                            {\n                                this.getValArithmetic(stack, 'mul');\n                                i = i + 1;\n                            }\n                            break;\n                        case this.parser.tokenDivide:\n                            {\n                                this.getValArithmetic(stack, 'div');\n                                i = i + 1;\n                            }\n                            break;\n                        case this.parser.tokenLess:\n                            {\n                                this.processLogical(stack, 'less');\n                                i = i + 1;\n                            }\n                            break;\n                        case this.parser.tokenGreater:\n                            {\n                                this.processLogical(stack, 'greater');\n                                i = i + 1;\n                            }\n                            break;\n                        case this.parser.tokenGreaterEq:\n                            {\n                                this.processLogical(stack, 'greaterEq');\n                                i = i + 1;\n                            }\n                            break;\n                        case this.parser.tokenLessEq:\n                            {\n                                this.processLogical(stack, 'lessEq');\n                                i = i + 1;\n                            }\n                            break;\n                        case this.parser.tokenNotEqual:\n                            {\n                                this.processLogical(stack, 'notEq');\n                                i = i + 1;\n                            }\n                            break;\n                        case this.parser.tokenOr:\n                            {\n                                this.processLogical(stack, 'or');\n                                i = i + 1;\n                            }\n                            break;\n                        case this.parser.tokenAnd:\n                            {\n                                this.processLogical(stack, 'and');\n                                i = i + 1;\n                            }\n                            break;\n                        case this.parser.tokenEqual:\n                            {\n                                this.processLogical(stack, 'equal');\n                                i = i + 1;\n                            }\n                            break;\n                        default: {\n                            return this.getErrorStrings()[CommonErrors.value];\n                        }\n                    }\n                }\n            }\n            if (stack.length === 0) {\n                return this.emptyString;\n            }\n            else {\n                var s = this.emptyString;\n                var countValue = stack.length;\n                while (countValue > 0) {\n                    s = stack.pop() + s;\n                    if (s === this.emptyString && this.isCellReference(pFormula) &&\n                        this.getTreatEmptyStringAsZero()) {\n                        return '0';\n                    }\n                    countValue--;\n                }\n                return s;\n            }\n        }\n        catch (ex) {\n            if (this.getErrorStrings().indexOf(ex) > -1 || this.formulaErrorStrings.indexOf(ex) > -1) {\n                throw ex;\n            }\n            throw new FormulaError(this.formulaErrorStrings[FormulasErrorsStrings.invalid_expression]);\n        }\n    };\n    Calculate.prototype.getValArithmetic = function (stack, operator) {\n        var num1 = stack.pop();\n        num1 = num1 === this.emptyString ? '0' : num1;\n        var num = Number(num1);\n        if (isNaN(num)) {\n            if (num1 === this.getErrorStrings()[CommonErrors.divzero]) {\n                throw this.getErrorStrings()[CommonErrors.divzero];\n            }\n            else {\n                throw this.getErrorStrings()[CommonErrors.value];\n            }\n        }\n        var num2 = stack.pop();\n        num2 = num2 === this.emptyString ? (stack.length ? stack.pop() : '0') : num2;\n        num = Number(num2);\n        if (isNaN(num)) {\n            if (num1 === this.getErrorStrings()[CommonErrors.divzero]) {\n                throw this.getErrorStrings()[CommonErrors.divzero];\n            }\n            else {\n                throw this.getErrorStrings()[CommonErrors.value];\n            }\n        }\n        if (operator === 'add') {\n            stack.push((Number(num2) + Number(num1)).toString());\n        }\n        if (operator === 'sub') {\n            stack.push((Number(num2) - Number(num1)).toString());\n        }\n        if (operator === 'mul') {\n            stack.push((Number(num2) * Number(num1)).toString());\n        }\n        if (operator === 'div') {\n            if (this.isNaN(this.parseFloat(num1)) || this.isNaN(this.parseFloat(num2))) {\n                stack.push(this.getErrorStrings()[CommonErrors.value]);\n            }\n            else if (this.parseFloat(num1) === 0) {\n                stack.push(this.getErrorStrings()[CommonErrors.divzero]);\n            }\n            else {\n                stack.push((Number(num2) / Number(num1)).toString());\n            }\n        }\n    };\n    /** @hidden */\n    Calculate.prototype.processLogical = function (stack, operator) {\n        var val1;\n        var val2;\n        var value1;\n        var value2;\n        if (operator !== 'and' && operator !== 'equal') {\n            val1 = stack.pop();\n            val2 = stack.pop();\n            value1 = val1.indexOf(this.tic) > -1 ? val1 : this.parseFloat(val1);\n            value2 = val2.indexOf(this.tic) > -1 ? val2 : this.parseFloat(val2);\n        }\n        var result;\n        if (operator === 'less') {\n            if (!this.isNaN(value1) && !this.isNaN(value2)) {\n                result = (value2 < value1) ? this.trueValue : this.falseValue;\n            }\n            else {\n                result = (val2.toUpperCase().split(this.tic).join('').localeCompare(val1.toUpperCase().split(this.tic).join('')) < 0) ?\n                    this.trueValue : this.falseValue;\n            }\n        }\n        if (operator === 'greater') {\n            if (!this.isNaN(value1) && !this.isNaN(value2)) {\n                result = (value2 > value1) ? this.trueValue : this.falseValue;\n            }\n            else {\n                result = (val2.toUpperCase().split(this.tic).join('').localeCompare(val1.toUpperCase().split(this.tic).join('')) > 0) ?\n                    this.trueValue : this.falseValue;\n            }\n        }\n        if (operator === 'lessEq') {\n            if (!this.isNaN(value1) && !this.isNaN(value2)) {\n                result = (value2 <= value1) ? this.trueValue : this.falseValue;\n            }\n            else {\n                result = (val2.toUpperCase().split(this.tic).join('').localeCompare(val1.toUpperCase().split(this.tic).join('')) <= 0) ?\n                    this.trueValue : this.falseValue;\n            }\n        }\n        if (operator === 'greaterEq') {\n            if (!this.isNaN(value1) && !this.isNaN(value2)) {\n                result = (value2 >= value1) ? this.trueValue : this.falseValue;\n            }\n            else {\n                result = (val2.toUpperCase().split(this.tic).join('').localeCompare(val1.toUpperCase().split(this.tic).join('')) >= 0) ?\n                    this.trueValue : this.falseValue;\n            }\n        }\n        if (operator === 'notEq') {\n            result = (val2 !== val1) ? this.trueValue : this.falseValue;\n        }\n        if (operator === 'and') {\n            val1 = stack.pop().toString();\n            val2 = '';\n            if (stack.length > 0) {\n                val2 = stack.pop().toString();\n            }\n            result = this.emptyString + val2 + val1 + this.emptyString;\n            result = result.split(this.tic).join('');\n        }\n        if (operator === 'equal') {\n            val1 = stack.pop().toString();\n            val2 = stack.pop().toString();\n            if (val2 === '' && val1 !== '') {\n                val2 = '0';\n            }\n            result = val1 === val2 ? this.trueValue : this.falseValue;\n        }\n        if (operator === 'or') {\n            result = Math.pow(this.parseFloat(value2), this.parseFloat(value1)).toString();\n        }\n        stack.push(result);\n        return result;\n    };\n    /** @hidden */\n    Calculate.prototype.computeStoreCells = function (sCell) {\n        var cellValue = sCell.cellValue;\n        var cellRanges = sCell.cellRange;\n        var criterias = sCell.criteria;\n        var argArr = sCell.argArray;\n        var isCriteria = sCell.isCriteria;\n        var storeCell = sCell.storedCells;\n        var isCountIfs = sCell.isCountIfS;\n        var i = sCell.countVal;\n        var rangeLength = isCriteria === this.trueValue ? storeCell : cellValue;\n        var tempStoredCell = [];\n        for (var j = 0; j < rangeLength.length; j++) {\n            var stack = [];\n            var cellVal = this.getValueFromArg(cellValue[j]);\n            var criteria = void 0;\n            var newCell = '';\n            criteria = argArr[2].split(this.tic).join(this.emptyString);\n            isCriteria = isCountIfs === this.trueValue ? this.trueValue : isCriteria;\n            if (isCriteria === this.trueValue) {\n                var cell = '';\n                var count = 0;\n                var newCount = 0;\n                storeCell[j] = isCountIfs === this.trueValue && i === 0 ? cellValue[j] : storeCell[j];\n                cell = storeCell[j];\n                // convert the new cell ranges  for find in range with criteria.\n                while (!this.isDigit(cell[count])) {\n                    count = count + 1;\n                }\n                if (this.isCellReference(cellRanges[i]) && cellRanges[i].indexOf(':') > -1) {\n                    var k = cellRanges[i].indexOf(':');\n                    newCell = this.substring(cellRanges[i], k);\n                    while (!this.isDigit(newCell[newCount])) {\n                        newCount = newCount + 1;\n                    }\n                }\n                var cellAlpha = this.substring(cell, count);\n                var newCellAlpha = this.substring(newCell, newCount);\n                newCell = storeCell[j].split(cellAlpha).join(newCellAlpha);\n                cellVal = this.getValueFromArg(newCell);\n                criteria = isCountIfs === this.trueValue ? criterias[i].split(this.tic).join(this.emptyString) :\n                    criterias[i - 1].split(this.tic).join(this.emptyString);\n            }\n            var op = 'equal';\n            if (criteria.startsWith('<=')) {\n                op = 'lessEq';\n                criteria = criteria.substring(2);\n            }\n            else if (criteria.startsWith('>=')) {\n                op = 'greaterEq';\n                criteria = criteria.substring(2);\n            }\n            else if (criteria.startsWith('<>')) {\n                op = 'notEq';\n                criteria = criteria.substring(2);\n            }\n            else if (criteria.startsWith('<')) {\n                op = 'less';\n                criteria = criteria.substring(1);\n            }\n            else if (criteria.startsWith('>')) {\n                op = 'greater';\n                criteria = criteria.substring(1);\n            }\n            else if (criteria.startsWith('=')) {\n                op = 'equal';\n                criteria = criteria.substring(1);\n            }\n            if (criteria.indexOf('*') > -1 || criteria.indexOf('?') > -1) {\n                cellVal = this.findWildCardValue(criteria, cellVal);\n            }\n            stack.push(cellVal.toLowerCase());\n            stack.push(criteria.toLowerCase());\n            if (this.processLogical(stack, op) === this.trueValue) {\n                if (isCriteria === this.falseValue) {\n                    tempStoredCell.push(cellValue[j]);\n                }\n                else {\n                    tempStoredCell.push(newCell);\n                }\n            }\n        }\n        storeCell = tempStoredCell;\n        tempStoredCell = [];\n        return storeCell;\n    };\n    Calculate.prototype.computeIfsFormulas = function (range, isCountIfs, isAvgIfs) {\n        if (isNullOrUndefined(range) || range[0] === '' || range.length === 0) {\n            return this.formulaErrorStrings[FormulasErrorsStrings.wrong_number_arguments];\n        }\n        var argArr = range;\n        var argCount = argArr.length;\n        if (argCount < 2 || argCount > 127) {\n            return this.formulaErrorStrings[FormulasErrorsStrings.wrong_number_arguments];\n        }\n        var cellRanges = [];\n        var criterias = [];\n        var storedCell = [];\n        var storedCellLength = 0;\n        var sum = 0;\n        for (var i = 0; i < argArr.length; i++) {\n            if (argArr[i].indexOf(':') > -1 && this.isCellReference(argArr[i])) {\n                cellRanges.push(argArr[i]);\n            }\n            else {\n                criterias.push(argArr[i]);\n            }\n        }\n        cellRanges = cellRanges.toString().split(',,').join(',');\n        cellRanges = cellRanges.split(this.getParseArgumentSeparator());\n        var len = [];\n        for (var i = 0; i < cellRanges.length; i++) {\n            len.push(this.getCellCollection(cellRanges[i]).length);\n        }\n        for (var j = 0; j < len.length; j++) {\n            if (len[j] && len[j + 1] && len[j] !== len[j + 1]) {\n                return this.getErrorStrings()[CommonErrors.value];\n            }\n        }\n        var cellvalue;\n        var isCriteria;\n        if (isCountIfs === this.falseValue) {\n            isCriteria = this.falseValue;\n            cellvalue = this.getCellCollection(cellRanges[1]);\n            var sCell = {\n                cellValue: cellvalue, cellRange: cellRanges, criteria: criterias,\n                argArray: argArr, isCriteria: isCriteria, storedCells: storedCell, isCountIfS: isCountIfs\n            };\n            storedCell = this.computeStoreCells(sCell);\n            storedCellLength = storedCell.length;\n            if (storedCellLength === 0) {\n                return 0;\n            }\n        }\n        // Compare criteria and convert the new cell ranges.\n        var startRange;\n        startRange = isCountIfs === this.trueValue ? 0 : 2;\n        for (var i = startRange; i < cellRanges.length; i++) {\n            isCriteria = this.trueValue;\n            isCriteria = isCountIfs === this.trueValue && i === 0 ? this.falseValue : this.trueValue;\n            cellvalue = this.getCellCollection(cellRanges[i]);\n            var sCell = {\n                cellValue: cellvalue, cellRange: cellRanges, criteria: criterias,\n                argArray: argArr, isCriteria: isCriteria, storedCells: storedCell, isCountIfS: isCountIfs, countVal: i\n            };\n            storedCell = this.computeStoreCells(sCell);\n            storedCellLength = storedCell.length;\n            if (storedCellLength === 0) {\n                return 0;\n            }\n        }\n        for (var j = 0; j < storedCell.length; j++) {\n            // convert the new cell ranges  for find sum in range 0(first range)\n            var cell = '';\n            var newCell = '';\n            var count = 0;\n            var newCount = 0;\n            cell = storedCell[j];\n            while (!this.isDigit(cell[count])) {\n                count = count + 1;\n            }\n            if (this.isCellReference(cellRanges[0]) && cellRanges[0].indexOf(':') > -1) {\n                var k = cellRanges[0].indexOf(':');\n                newCell = this.substring(cellRanges[0], k);\n                while (!this.isDigit(newCell[newCount])) {\n                    newCount = newCount + 1;\n                }\n            }\n            var cellAlpha = this.substring(cell, count);\n            var newCellAlpha = this.substring(newCell, newCount);\n            cellvalue = storedCell[j].split(cellAlpha).join(newCellAlpha);\n            if (isCountIfs === this.trueValue) {\n                sum = sum + 1;\n            }\n            else {\n                var argValue = this.getValueFromArg(cellvalue);\n                sum = sum + parseFloat(argValue === '' ? '0' : argValue);\n            }\n        }\n        if (isAvgIfs === this.trueValue) {\n            sum = sum / cellvalue.length;\n        }\n        return sum;\n    };\n    Calculate.prototype.processNestedFormula = function (pText, sFormula, fResult) {\n        var lastIndexq = this.findLastIndexOfq(pText);\n        var interiorCalcFString = pText.split(sFormula).join('n' + fResult);\n        return interiorCalcFString;\n    };\n    /** @hidden */\n    Calculate.prototype.isNaN = function (value) {\n        if (value.toString() === 'NaN' || typeof value === 'string') {\n            return true;\n        }\n        return false;\n    };\n    /** @hidden */\n    Calculate.prototype.fromOADate = function (doubleNumber) {\n        var result = new Date();\n        result.setTime((doubleNumber * this.millisecondsOfaDay) + Date.parse(this.oaDate.toString()));\n        return result;\n    };\n    /** @hidden */\n    Calculate.prototype.getSerialDateFromDate = function (year, month, day) {\n        var days = 0;\n        if (year < 1900) {\n            year += 1900;\n        }\n        var isValidMonth = false;\n        while (!isValidMonth) {\n            while (month > 12) {\n                year++;\n                month -= 12;\n            }\n            isValidMonth = true;\n            var tempDay = new Date(year, month, 1, -1).getDate();\n            while (day > tempDay) {\n                tempDay = new Date(year, month, 1, -1).getDate();\n                month++;\n                day -= tempDay;\n                isValidMonth = false;\n            }\n            if (day < 1) {\n                month--;\n                tempDay = new Date(year, month, 1, -1).getDate();\n                day = tempDay - day;\n            }\n        }\n        var dateTime = Date.parse(year.toString() + this.getParseDateTimeSeparator() + month.toString() +\n            this.getParseDateTimeSeparator() + day.toString());\n        if (!this.isNaN(dateTime)) {\n            days = this.toOADate(new Date(dateTime));\n        }\n        return days;\n    };\n    /** @hidden */\n    Calculate.prototype.toOADate = function (dateTime) {\n        var result = (dateTime.getTime() - Date.parse(this.oaDate.toString())) / this.millisecondsOfaDay;\n        return result;\n    };\n    /** @hidden */\n    Calculate.prototype.calculateDate = function (date) {\n        return (this.parseFloat(date) < 10) ? '0' + date : date;\n    };\n    /** @hidden */\n    Calculate.prototype.isTextEmpty = function (s) {\n        return s === null || s === '';\n    };\n    /** @hidden */\n    Calculate.prototype.isDigit = function (text) {\n        var charCode = text.charCodeAt(0);\n        if ((charCode > 47) && (charCode < 58)) {\n            return true;\n        }\n        return false;\n    };\n    Calculate.prototype.findLastIndexOfq = function (fString) {\n        return fString.lastIndexOf('q');\n    };\n    /**\n     * To get the exact value from argument.\n     * @param {string} arg - Formula argument for getting a exact value.\n     * @returns string\n     */\n    Calculate.prototype.getValueFromArg = function (arg) {\n        arg = arg.trim();\n        var s = arg;\n        var dateTime = this.dateTime1900;\n        var pObjCVal = s;\n        if (isNullOrUndefined(s) || this.isTextEmpty(s)) {\n            return s;\n        }\n        else if (arg[0] === this.tic || arg[0] === this.singleTic) {\n            dateTime = this.isDate(arg.split(this.tic).join(''));\n            if (this.isNaN(this.parseFloat(arg.split(this.tic).join(''))) && !isNullOrUndefined(dateTime) &&\n                !this.isNaN(dateTime.getDate()) && this.dateTime1900 <= dateTime) {\n                return this.toOADate(dateTime).toString();\n            }\n            return arg;\n        }\n        else {\n            arg = arg.split('u').join('-');\n            /* tslint:disable:max-line-length */\n            if (!this.isUpperChar(s[0]) && (this.isDigit(s[0]) || s[0] === this.getParseDecimalSeparator() || s[0] === '-' || s[0] === 'n')) {\n                if (s[0] === 'n') {\n                    s = s.substring(1);\n                    if (s.indexOf('\"n') > -1) {\n                        s = s.replace('\"n', '\"');\n                    }\n                }\n                return s;\n            }\n        }\n        var symbolArray = ['+', '-', '/', '*', ')', ')', '{'];\n        if ((this.parser.indexOfAny(s, symbolArray) === -1 && this.isUpperChar(s[0])) || s[0] === this.sheetToken) {\n            if (s !== this.trueValue && s !== this.falseValue && this.isCellReference(s)) {\n                var f = this.getSheetFamilyItem(this.grid);\n                if (f.sheetNameToParentObject !== null && f.sheetNameToParentObject.size > 0 && s.indexOf(this.sheetToken) === -1) {\n                    var token = f.parentObjectToToken.get(this.grid);\n                    s = token + s;\n                }\n            }\n            if (s === this.cell) {\n                var dependent = this.getDependentCells().get(s);\n                if (dependent != null && dependent.indexOf(s) > -1) {\n                    this.arrayRemove(dependent, s);\n                }\n                if (!this.getDependentFormulaCells().has(this.cell)) {\n                    this.clearFormulaDependentCells(this.cell);\n                }\n                throw this.formulaErrorStrings[FormulasErrorsStrings.circular_reference] + s;\n            }\n            pObjCVal = this.getParentObjectCellValue(s);\n            this.updateDependentCell(s);\n            return pObjCVal.toString();\n        }\n        if (this.getErrorStrings().indexOf(arg) > -1) {\n            return arg;\n        }\n        return this.computeValue(pObjCVal.toString());\n    };\n    /* tslint:disable-next-line */\n    Calculate.prototype.isDate = function (date) {\n        if (typeof date === 'object' || Date.parse(date) !== null) {\n            var dateval = new Date(Date.parse(date));\n            if (dateval >= this.dateTime1900) {\n                return dateval;\n            }\n            else {\n                return null;\n            }\n        }\n        else {\n            return null;\n        }\n    };\n    Calculate.prototype.isValidCellReference = function (text) {\n        var start = 0;\n        var end = 0;\n        var j = 0;\n        var numArr = [89, 71, 69];\n        var cellTxt = this.emptyString;\n        if (this.namedRanges.has(text)) {\n            return false;\n        }\n        for (var i = 0; i < text.length; i++) {\n            if (this.isChar(text[i])) {\n                end++;\n            }\n        }\n        cellTxt = text.substring(start, end);\n        if (cellTxt.length < 4) {\n            while (j < cellTxt.length) {\n                if (!isNullOrUndefined(cellTxt[j]) && cellTxt[j].charCodeAt(0) < numArr[j]) {\n                    j++;\n                    continue;\n                }\n                else if (isNullOrUndefined(cellTxt[j]) && j > 0) {\n                    break;\n                }\n                else {\n                    return false;\n                }\n            }\n            var cellNum = this.parseFloat(text.substring(end, text.length));\n            if (cellNum < 1048576) { // Maximum number of rows in excel.\n                return true;\n            }\n        }\n        return false;\n    };\n    /** @hidden */\n    /* tslint:disable-next-line */\n    Calculate.prototype.parseDate = function (date) {\n        if (!this.isNaN(date)) {\n            if (date instanceof Date) {\n                return new Date(date);\n            }\n            var d = parseInt(date, 10);\n            if (d < 0) {\n                return this.getErrorStrings()[CommonErrors.num];\n            }\n            if (d <= 60) {\n                return new Date(this.dateTime1900.getTime() + (d - 1) * 86400000);\n            }\n            return new Date(this.dateTime1900.getTime() + (d - 2) * 86400000);\n        }\n        if (typeof date === 'string') {\n            date = new Date(date);\n            if (!this.isNaN(date)) {\n                return date;\n            }\n        }\n        return this.getErrorStrings()[CommonErrors.value];\n    };\n    /** @hidden */\n    Calculate.prototype.isCellReference = function (args) {\n        if (args === this.emptyString) {\n            return false;\n        }\n        args = args.trim();\n        args = this.setTokensForSheets(args);\n        var sheetToken1 = this.getSheetToken(args);\n        var containsBoth = false;\n        if (sheetToken1 !== '') {\n            args = args.split(sheetToken1).join(this.emptyString);\n        }\n        var isAlpha = false;\n        var isNum = false;\n        if (args.indexOf(':') !== args.lastIndexOf(':')) {\n            return false;\n        }\n        var charArray = (args.split('').join(this.getParseArgumentSeparator())).split(this.getParseArgumentSeparator());\n        for (var c = 0; c < charArray.length; c++) {\n            if (this.isChar(charArray[c])) {\n                isAlpha = true;\n            }\n            else if (this.isDigit(charArray[c])) {\n                isNum = true;\n            }\n            else if (charArray[c] === ':') {\n                if (isAlpha && isNum) {\n                    containsBoth = true;\n                }\n                isAlpha = false;\n                isNum = false;\n            }\n            else {\n                return false;\n            }\n        }\n        if (args.indexOf(':') > -1 && args.indexOf(this.tic) === -1) {\n            if (containsBoth && isAlpha && isNum) {\n                return true;\n            }\n            else if (((isAlpha && !isNum) || (!isAlpha && isNum)) && !containsBoth) {\n                return true;\n            }\n            else {\n                return false;\n            }\n        }\n        if (isAlpha && isNum && args.indexOf(this.tic) === -1) {\n            return true;\n        }\n        return false;\n    };\n    /** @hidden */\n    Calculate.prototype.setTokensForSheets = function (text) {\n        var family = this.getSheetFamilyItem(this.grid);\n        var sortedSheetNamesCollection = this.getSortedSheetNames();\n        if (sortedSheetNamesCollection != null) {\n            for (var n = 0; n < sortedSheetNamesCollection.length; n++) {\n                var token = family.sheetNameToToken.get(sortedSheetNamesCollection[n]);\n                token = token.split(this.sheetToken).join(this.tempSheetPlaceHolder);\n                var s = this.singleTic + 'SHEET' + sortedSheetNamesCollection[n] + this.singleTic + this.sheetToken;\n                if (text.indexOf(s) === -1) {\n                    s = 'SHEET' + sortedSheetNamesCollection[n] + this.sheetToken;\n                }\n                text = text.split(s).join(token);\n                s = sortedSheetNamesCollection[n] + this.sheetToken;\n                text = text.split(s).join(token);\n            }\n        }\n        text = text.split(this.tempSheetPlaceHolder).join(this.sheetToken);\n        if (text.indexOf('!!') > -1) {\n            text = text.replace('!!', '!');\n            var textSplit = text.split('');\n            textSplit[1] = (parseInt(textSplit[1], 10) + 1).toString();\n            text = textSplit.join('');\n        }\n        return text;\n    };\n    Calculate.prototype.getParentObjectCellValue = function (val) {\n        if (val === this.trueValue || val === this.falseValue) {\n            return val;\n        }\n        var i = val.lastIndexOf(this.sheetToken);\n        var row = 0;\n        var col = 0;\n        var grid = this.grid;\n        var family = this.getSheetFamilyItem(grid);\n        if (i > -1 && family.tokenToParentObject !== null) {\n            this.grid = family.tokenToParentObject.get(val.substring(0, i + 1));\n            row = this.rowIndex(val);\n            col = this.colIndex(val);\n        }\n        else if (i === -1) {\n            var j = 0;\n            while (j < val.length && this.isChar(val[j])) {\n                j++;\n            }\n            if (j === val.length) {\n                val = val.toLowerCase();\n                return val === '' ? this.getErrorStrings()[CommonErrors.value] : this.getErrorStrings()[CommonErrors.name];\n            }\n            else {\n                row = this.rowIndex(val);\n                col = this.colIndex(val);\n                if (family.isSheetMember && family.parentObjectToToken != null) {\n                    val = family.parentObjectToToken.get(this.grid) + val;\n                }\n            }\n        }\n        var saveCell = (this.cell === '' || this.cell === null) ? '' : this.cell;\n        this.cell = val;\n        if (saveCell === this.cell) {\n            throw this.formulaErrorStrings[FormulasErrorsStrings.circular_reference];\n        }\n        var cValue = this.getParentCellValue(row, col, this.grid);\n        this.grid = grid;\n        this.cell = saveCell;\n        return cValue;\n    };\n    Calculate.prototype.getParentCellValue = function (row, col, grd) {\n        var alreadyComputed = false;\n        // formulainfotable\n        var cValue;\n        /* tslint:disable-next-line */\n        if (this.parentObject.getValueRowCol === undefined) {\n            cValue = this.getValueRowCol(this.getSheetID(grd), row, col);\n        }\n        else {\n            /* tslint:disable-next-line */\n            cValue = this.parentObject.getValueRowCol(this.getSheetID(grd), row, col);\n            return isNullOrUndefined(cValue) ? this.emptyString : cValue.toString();\n        }\n        if (cValue === '' || cValue === undefined) {\n            cValue = '';\n        }\n        // if (cValue[cValue.length - 1] == (\"%\") && !this.isNaN(d)) {\n        //     cValue = (Number(d) / 100).toString();\n        // }\n        return cValue;\n    };\n    /**\n     * Getting the formula result.\n     * @param {Object} grid - Specifies the parent object.\n     * @param {number} row - Row index of the parent object or key.\n     * @param {number} col - Column index of the parent object.\n     * @returns string\n     */\n    Calculate.prototype.getValueRowCol = function (grid, row, col) {\n        var key = this.rowsToKeyMap.get(row).toString();\n        var result = this.getKeyValue(key).toString();\n        if (result != null && result[result.length - 1] === ('%') && result.length > 1) {\n            var d = this.parseFloat(result.substring(0, result.length - 1));\n            if (this.isNaN(d)) {\n                result = (Number(d) / 100).toString();\n            }\n        }\n        return result;\n    };\n    /**\n     * To add custom library formula.\n     * @param {string} formulaName - Custom Formula name.\n     * @param {string} functionName - Custom function name.\n     * @returns void\n     */\n    Calculate.prototype.defineFunction = function (formulaName, functionName) {\n        if (typeof functionName === 'string') {\n            functionName = getValue(functionName, window);\n        }\n        formulaName = formulaName.toUpperCase();\n        this.libraryFormulas.set(formulaName, { handler: functionName, isCustom: true });\n    };\n    /**\n     * Specifies when changing the value.\n     * @param {string} grid - Parent object reference name.\n     * @param {ValueChangedArgs} changeArgs - Value changed arguments.\n     * @param {boolean} isCalculate - Value that allow to calculate.\n     */\n    Calculate.prototype.valueChanged = function (grid, changeArgs, isCalculate) {\n        var pgrid = grid;\n        this.grid = grid;\n        var isComputedValueChanged = true;\n        var isCompute = true;\n        var calcFamily = this.getSheetFamilyItem(pgrid);\n        var cellTxt = getAlphalabel(changeArgs.getColIndex()) + changeArgs.getRowIndex().toString();\n        if (calcFamily.sheetNameToParentObject !== null && calcFamily.sheetNameToParentObject.size > 0) {\n            var token = calcFamily.parentObjectToToken.get(pgrid);\n            cellTxt = token + cellTxt;\n        }\n        var argVal = changeArgs.getValue().toUpperCase();\n        if (argVal.indexOf('=RAND()') > -1 || argVal.indexOf('RAND()') > -1 || argVal.indexOf('=RANDBETWEEN(') > -1 ||\n            argVal.indexOf('RANDBETWEEN(') > -1 || this.randomValues.has(cellTxt)) {\n            var randStrVal = this.randCollection.toString();\n            if (!this.randomValues.has(cellTxt)) {\n                this.randomValues.set(cellTxt, changeArgs.getValue());\n                this.randCollection.push(cellTxt);\n                this.isRandomVal = true;\n            }\n            else if (this.randomValues.has(cellTxt)) {\n                if (argVal.indexOf('=RAND()') > -1 || argVal.indexOf('RAND()') > -1 || argVal.indexOf('=RANDBETWEEN(') > -1 ||\n                    argVal.indexOf('RANDBETWEEN(') > -1) {\n                    this.randomValues.set(cellTxt, changeArgs.getValue());\n                }\n                else if (changeArgs.getValue().toUpperCase() !== this.randomValues.get(cellTxt.toUpperCase())) {\n                    this.randomValues.delete(cellTxt);\n                    randStrVal = randStrVal.split(cellTxt + this.parseArgumentSeparator).join('').split(this.parseArgumentSeparator + cellTxt).join('').split(cellTxt).join('');\n                    this.randCollection = randStrVal.split(this.parseArgumentSeparator);\n                }\n                if (this.randomValues.size === 0 && this.randCollection.length) {\n                    this.isRandomVal = false;\n                    this.randomValues.clear();\n                    this.randCollection = [];\n                }\n            }\n        }\n        if (changeArgs.getValue() && changeArgs.getValue()[0] === this.getFormulaCharacter()) {\n            this.cell = cellTxt;\n            var formula = void 0;\n            if (!isNullOrUndefined(isCompute)) {\n                isCompute = isCalculate;\n            }\n            if (this.getFormulaInfoTable().has(cellTxt)) {\n                formula = this.getFormulaInfoTable().get(cellTxt);\n                if (changeArgs.getValue() !== formula.getFormulaText() || formula.getParsedFormula() == null) {\n                    formula.setFormulaText(changeArgs.getValue());\n                    if (this.getDependentFormulaCells().has(this.cell)) {\n                        this.clearFormulaDependentCells(this.cell);\n                    }\n                    try {\n                        formula.setParsedFormula(this.parser.parseFormula(changeArgs.getValue()));\n                    }\n                    catch (ex) {\n                        formula.setFormulaValue(ex);\n                        isCompute = false;\n                    }\n                }\n                if (isCompute) {\n                    this.parser.isFormulaParsed = true;\n                    var cValue = this.computeFormula(formula.getParsedFormula());\n                    isComputedValueChanged = (cValue !== formula.getFormulaValue());\n                    formula.setFormulaValue(cValue);\n                }\n            }\n            else {\n                formula = new FormulaInfo();\n                formula.setFormulaText(changeArgs.getValue());\n                if (!this.getDependentFormulaCells().has(cellTxt)) {\n                    this.getDependentFormulaCells().set(cellTxt, new Map());\n                }\n                try {\n                    formula.setParsedFormula(this.parser.parseFormula(changeArgs.getValue()));\n                }\n                catch (ex) {\n                    formula.setFormulaValue(ex);\n                    isCompute = false;\n                }\n                if (isCompute) {\n                    formula.setFormulaValue(this.computeFormula(formula.getParsedFormula()));\n                }\n                if (this.getFormulaInfoTable().has(cellTxt)) {\n                    this.getFormulaInfoTable().set(cellTxt, formula);\n                }\n                else {\n                    this.getFormulaInfoTable().set(cellTxt, formula);\n                }\n            }\n            if (isCompute) {\n                /* tslint:disable */\n                if (this.parentObject.setValueRowCol === undefined) {\n                    this.setValueRowCol(this.getSheetID(pgrid) + 1, formula.getFormulaValue(), changeArgs.getRowIndex(), changeArgs.getColIndex());\n                }\n                else {\n                    this.parentObject.setValueRowCol(this.getSheetID(pgrid) + 1, formula.getFormulaValue(), changeArgs.getRowIndex(), changeArgs.getColIndex());\n                }\n                /* tslint:enable */\n            }\n        }\n        else if (this.getFormulaInfoTable().has(cellTxt)) {\n            this.getFormulaInfoTable().delete(cellTxt);\n            if (this.getDependentFormulaCells().has(cellTxt)) {\n                this.clearFormulaDependentCells(cellTxt);\n            }\n        }\n        if (isCompute && isComputedValueChanged && this.getDependentCells().has(cellTxt) &&\n            this.getDependentCells().get(cellTxt).toString() !== cellTxt) {\n            this.getComputedValue().clear();\n            this.refresh(cellTxt);\n        }\n    };\n    /** @hidden */\n    Calculate.prototype.getComputedValue = function () {\n        if (this.computedValues === null) {\n            this.computedValues = new Map();\n        }\n        return this.computedValues;\n    };\n    /**\n     * @hidden\n     */\n    Calculate.prototype.setValueRowCol = function (value, formulaValue, row, col) {\n        /* No Implementation */\n    };\n    Calculate.prototype.getSortedSheetNames = function () {\n        var family = this.getSheetFamilyItem(this.grid);\n        if (family != null && family.sheetNameToToken != null) {\n            var arr_1 = [];\n            family.sheetNameToToken.forEach(function (value, key) {\n                arr_1.push(key);\n                arr_1.sort();\n            });\n            this.sortedSheetNames = arr_1;\n            this.sortedSheetNames.sort();\n        }\n        return this.sortedSheetNames;\n    };\n    /** @hidden */\n    Calculate.prototype.getErrorLine = function (error) {\n        /* tslint:disable-next-line */\n        var errorStack = error.stack ? error.stack.split('\\n')[1].split(':') : null;\n        return errorStack ? errorStack[errorStack.length - 2] : null; // Getting row number of the error file.\n    };\n    /** @hidden */\n    Calculate.prototype.createSheetFamilyID = function () {\n        if (this.sheetFamilyID === Number.MAX_SAFE_INTEGER) {\n            this.sheetFamilyID = Number.MIN_SAFE_INTEGER;\n        }\n        return this.sheetFamilyID++;\n    };\n    /** @hidden */\n    Calculate.prototype.computeMinMax = function (args, operation) {\n        var result;\n        var argVal;\n        var countStrVal = 0;\n        if (isNullOrUndefined(args) || args.length === 0) {\n            return this.formulaErrorStrings[FormulasErrorsStrings.wrong_number_arguments];\n        }\n        for (var k = 0, len = args.length; k < len; k++) {\n            if (args[k].split(this.tic).join('').trim() === this.emptyString) {\n                return this.getErrorStrings()[CommonErrors.value];\n            }\n        }\n        result = (operation === 'max') ? this.minValue : this.maxValue;\n        var argArr = args;\n        if (argArr.length > 255) {\n            return this.getErrorStrings()[CommonErrors.value];\n        }\n        for (var i = 0; i < argArr.length; i++) {\n            if (argArr[i].indexOf(':') > -1 && this.isCellReference(argArr[i])) {\n                var cellValue = this.getCellCollection(argArr[i]);\n                for (var j = 0; j < cellValue.length; j++) {\n                    argVal = this.getValueFromArg(cellValue[j]);\n                    if (this.getErrorStrings().indexOf(argVal) > -1) {\n                        return argVal;\n                    }\n                    var cellVal = this.parseFloat(argVal);\n                    if (argVal === '' || this.isNaN(this.parseFloat(cellVal))) {\n                        countStrVal = countStrVal + 1;\n                        if (countStrVal === cellValue.length) {\n                            result = 0;\n                        }\n                        continue;\n                    }\n                    else {\n                        result = (operation === 'max') ? Math.max(result, cellVal) : Math.min(result, cellVal);\n                    }\n                }\n            }\n            else {\n                var val = void 0;\n                val = this.getValueFromArg(argArr[i]);\n                if (this.getErrorStrings().indexOf(val) > -1) {\n                    return val;\n                }\n                var cellVal = this.parseFloat(val);\n                if (val === '' || this.isNaN(this.parseFloat(cellVal))) {\n                    countStrVal = countStrVal + 1;\n                    if (countStrVal === argVal.length) {\n                        result = 0;\n                    }\n                    continue;\n                }\n                else {\n                    result = (operation === 'max') ? Math.max(result, cellVal) : Math.min(result, cellVal);\n                }\n            }\n        }\n        return result.toString();\n    };\n    /** @hidden */\n    Calculate.prototype.calculateAvg = function (args) {\n        var sumCell = 0;\n        var argArr = args;\n        var cellVal = [];\n        var avgVal = 0;\n        var countNum = 0;\n        var countNum1 = 0;\n        for (var k = 0; k < argArr.length; k++) {\n            if (argArr[k].indexOf(':') > -1 && this.isCellReference(argArr[k])) {\n                countNum = 0;\n                cellVal = this.getCellCollection(argArr[k]);\n                avgVal = 0;\n                for (var i = 0; i < cellVal.length; i++) {\n                    var value = this.getValueFromArg(cellVal[i]);\n                    if (isNullOrUndefined(value) || isNaN(this.parseFloat(value))) {\n                        continue;\n                    }\n                    avgVal = avgVal + this.parseFloat(value);\n                    countNum = countNum + 1;\n                }\n                if (countNum === 0) {\n                    return this.getErrorStrings()[CommonErrors.divzero];\n                }\n                avgVal = avgVal / countNum;\n                sumCell = avgVal + sumCell;\n            }\n            else {\n                if (argArr[k].indexOf(this.tic) > -1) {\n                    if (isNaN(parseFloat(argArr[k].split(this.tic).join('')))) {\n                        return this.getErrorStrings()[CommonErrors.value];\n                    }\n                }\n                if (argArr[k].length === 0) {\n                    argArr[k] = '1';\n                }\n                var value = this.getValueFromArg(argArr[k].split(this.tic).join(''));\n                if (isNullOrUndefined(value) || isNaN(this.parseFloat(value))) {\n                    return this.getErrorStrings()[CommonErrors.name];\n                }\n                sumCell = sumCell + this.parseFloat(value);\n            }\n        }\n        return (sumCell / (argArr.length - countNum1)).toString();\n    };\n    /**\n     * @hidden\n     */\n    Calculate.prototype.registerGridAsSheet = function (refName, model, sheetFamilyID) {\n        if (isNullOrUndefined(this.modelToSheetID)) {\n            this.modelToSheetID = new Map();\n        }\n        if (isNullOrUndefined(this.modelToSheetID.get(model))) {\n            this.modelToSheetID.set(model, sheetFamilyID);\n        }\n        var family = this.getSheetFamilyItem(model);\n        family.isSheetMember = true;\n        var tempRef = refName.toUpperCase();\n        if (family.parentObjectToToken.size === 0) {\n            family.parentObjectToToken = new Map();\n        }\n        if (family.sheetNameToParentObject.size === 0) {\n            family.sheetNameToParentObject = new Map();\n        }\n        if (family.sheetNameToToken.size === 0) {\n            family.sheetNameToToken = new Map();\n        }\n        if (family.tokenToParentObject.size === 0) {\n            family.tokenToParentObject = new Map();\n        }\n        if (!isUndefined(family.sheetNameToParentObject.get(tempRef))) {\n            var token = family.sheetNameToToken.get(tempRef);\n            family.tokenToParentObject.set(token, model);\n            family.parentObjectToToken.set(model, token);\n        }\n        else {\n            var token = this.sheetToken + this.tokenCount.toString() + this.sheetToken;\n            this.tokenCount++;\n            family.tokenToParentObject.set(token, model);\n            family.parentObjectToToken.set(model, token);\n            family.sheetNameToToken.set(tempRef, token);\n            family.sheetNameToParentObject.set(tempRef, model);\n        }\n        return refName;\n    };\n    /**\n     * @hidden\n     */\n    Calculate.prototype.unregisterGridAsSheet = function (refName, model) {\n        var family = this.getSheetFamilyItem(model);\n        var refName1 = refName.toUpperCase();\n        if (family.sheetNameToParentObject != null && family.sheetNameToParentObject.has(refName1)) {\n            family.sheetNameToParentObject.delete(refName1);\n            var token = family.sheetNameToToken.get(refName1);\n            family.sheetNameToToken.delete(refName1);\n            family.tokenToParentObject.delete(token);\n            family.parentObjectToToken.delete(model);\n        }\n    };\n    ;\n    /**\n     * @hidden\n     */\n    Calculate.prototype.computeExpression = function (formula) {\n        var parsedFormula = this.parser.parseFormula(formula);\n        var calcValue = this.computeFormula(parsedFormula);\n        return calcValue;\n    };\n    ;\n    Calculate.prototype.isSheetMember = function () {\n        var family = this.getSheetFamilyItem(this.grid);\n        return isNullOrUndefined(family) ? false : family.isSheetMember;\n    };\n    /**\n     * To dispose the calculate engine.\n     * @returns void\n     */\n    Calculate.prototype.dispose = function () {\n        this.resetKeys();\n        // this.dependentCells.clear();\n        // this.dependentFormulaCells.clear();\n        this.namedRanges.clear();\n        // this.sheetFamiliesList.clear();\n        this.lFormulas.clear();\n    };\n    Calculate.prototype.refreshRandValues = function (cellRef) {\n        var rowIdx;\n        var colIdx;\n        var value;\n        var tokenRef = '';\n        var stringCollection = this.randCollection.toString();\n        var family;\n        if (this.randomValues.has(cellRef)) {\n            this.randomValues.delete(cellRef);\n            stringCollection = stringCollection.split(cellRef + this.parseArgumentSeparator).join('').split(this.parseArgumentSeparator + cellRef).join('').split(cellRef).join('');\n            if (this.randomValues.size === 0 && stringCollection === '') {\n                this.randomValues.clear();\n                this.randCollection = [];\n            }\n            else {\n                this.randCollection = stringCollection.split(this.parseArgumentSeparator);\n            }\n        }\n        for (var i = 0; i < this.randomValues.size; i++) {\n            rowIdx = this.rowIndex(this.randCollection[i]);\n            colIdx = this.colIndex(this.randCollection[i]);\n            tokenRef = (parseFloat(this.getSheetToken(this.randCollection[i]).split(this.sheetToken).join('')) + 1).toString();\n            family = this.getSheetFamilyItem(tokenRef);\n            this.grid = family.sheetNameToParentObject.get(tokenRef);\n            value = this.randomValues.get(this.randCollection[i]);\n            value = this.computeFormula(value);\n            if (this.parentObject.setValueRowCol === undefined) {\n                this.setValueRowCol(this.getSheetID(this.grid) + 1, value, rowIdx, colIdx);\n            }\n            else {\n                this.parentObject.setValueRowCol(this.getSheetID(this.grid) + 1, value, rowIdx, colIdx);\n            }\n        }\n    };\n    Calculate.prototype.refresh = function (cellRef) {\n        if (this.dependencyLevel === 0) {\n            this.refreshedCells.clear();\n        }\n        if (this.getDependentCells().has(cellRef) && this.getDependentCells().get(cellRef) !== null) {\n            var family = this.getSheetFamilyItem(this.grid);\n            this.dependencyLevel = this.dependencyLevel + 1;\n            try {\n                var dependentCells = this.getDependentCells().get(cellRef);\n                var i = void 0;\n                for (i = 0; i < dependentCells.length; i++) {\n                    var dCell = dependentCells[i];\n                    var token = this.getSheetToken(dCell);\n                    if (token.length) {\n                        this.grid = family.tokenToParentObject.get(token);\n                    }\n                    try {\n                        var rowIdx = this.rowIndex(dCell);\n                        var colIdx = this.colIndex(dCell);\n                        var formulaInfo = this.getFormulaInfoTable().get(dCell);\n                        var result = void 0;\n                        if (formulaInfo) {\n                            this.cell = dCell;\n                            if (!this.getComputedValue().has(dCell)) {\n                                this.parser.isFormulaParsed = true;\n                                result = this.computeFormula(formulaInfo.getParsedFormula());\n                                this.computedValues.set(dCell, result);\n                            }\n                            else {\n                                result = this.getComputedValue().get(dCell);\n                            }\n                            formulaInfo.setFormulaValue(result);\n                        }\n                        if (this.parentObject.setValueRowCol === undefined) {\n                            this.setValueRowCol(this.getSheetID(this.grid) + 1, formulaInfo.getFormulaValue(), rowIdx, colIdx);\n                        }\n                        else {\n                            this.parentObject.setValueRowCol(this.getSheetID(this.grid) + 1, formulaInfo.getFormulaValue(), rowIdx, colIdx);\n                        }\n                        if (!this.refreshedCells.has(dCell)) {\n                            this.refreshedCells.set(dCell, []);\n                            this.refresh(dCell);\n                        }\n                    }\n                    catch (ex) {\n                        continue;\n                    }\n                }\n            }\n            finally {\n                this.grid = family.tokenToParentObject.get(this.getSheetToken(cellRef));\n                this.dependencyLevel--;\n                if (this.dependencyLevel === 0) {\n                    this.refreshedCells.clear();\n                }\n            }\n        }\n    };\n    var Calculate_1;\n    __decorate([\n        Property(true)\n    ], Calculate.prototype, \"includeBasicFormulas\", void 0);\n    __decorate([\n        Event()\n    ], Calculate.prototype, \"onFailure\", void 0);\n    Calculate = Calculate_1 = __decorate([\n        NotifyPropertyChanges\n    ], Calculate);\n    return Calculate;\n}(Base));\nexport { Calculate };\n/** @hidden */\nvar FormulaError = /** @class */ (function () {\n    function FormulaError(errorMessage, formulaAutoCorrection) {\n        this.formulaCorrection = false;\n        this.message = errorMessage;\n        this.formulaCorrection = formulaAutoCorrection;\n    }\n    return FormulaError;\n}());\nexport { FormulaError };\n/** @hidden */\nvar FormulaInfo = /** @class */ (function () {\n    function FormulaInfo() {\n        /**\n         * @hidden\n         */\n        this.calcID = Number.MIN_VALUE + 1;\n        this.calcID1 = Number.MIN_VALUE + 1;\n    }\n    /**\n     * @hidden\n     */\n    FormulaInfo.prototype.getFormulaText = function () {\n        return this.formulaText;\n    };\n    /**\n     * @hidden\n     */\n    FormulaInfo.prototype.setFormulaText = function (value) {\n        this.formulaText = value;\n    };\n    /**\n     * @hidden\n     */\n    FormulaInfo.prototype.getFormulaValue = function () {\n        return this.formulaValue;\n    };\n    /**\n     * @hidden\n     */\n    FormulaInfo.prototype.setFormulaValue = function (value) {\n        this.formulaValue = value;\n    };\n    /**\n     * @hidden\n     */\n    FormulaInfo.prototype.getParsedFormula = function () {\n        return this.parsedFormula;\n    };\n    /**\n     * @hidden\n     */\n    FormulaInfo.prototype.setParsedFormula = function (value) {\n        this.parsedFormula = value;\n    };\n    return FormulaInfo;\n}());\nexport { FormulaInfo };\n/** @hidden */\nvar CalcSheetFamilyItem = /** @class */ (function () {\n    function CalcSheetFamilyItem() {\n        /**\n         * @hidden\n         */\n        this.isSheetMember = false;\n        /**\n         * @hidden\n         */\n        this.parentObjectToToken = new Map();\n        /**\n         * @hidden\n         */\n        this.sheetDependentCells = new Map();\n        /**\n         * @hidden\n         */\n        this.sheetDependentFormulaCells = new Map();\n        /**\n         * @hidden\n         */\n        this.sheetNameToParentObject = new Map();\n        /**\n         * @hidden\n         */\n        this.sheetNameToToken = new Map();\n        /**\n         * @hidden\n         */\n        this.tokenToParentObject = new Map();\n        /**\n         * @hidden\n         */\n        this.sheetFormulaInfotable = new Map();\n    }\n    return CalcSheetFamilyItem;\n}());\nexport { CalcSheetFamilyItem };\n/**\n * @hidden\n */\nexport function getAlphalabel(col) {\n    var cols = [];\n    var n = 0;\n    var charText = 'A';\n    while (col > 0 && n < 9) {\n        col--;\n        var aCharNo = charText.charCodeAt(0);\n        cols[n] = String.fromCharCode(col % 26 + aCharNo);\n        col = parseInt((col / 26).toString(), 10);\n        n++;\n    }\n    var chs = [];\n    for (var i = 0; i < n; i++) {\n        chs[n - i - 1] = cols[i];\n    }\n    return chs.join('');\n}\nvar ValueChangedArgs = /** @class */ (function () {\n    function ValueChangedArgs(row, col, value) {\n        this.row = row;\n        this.col = col;\n        this.value = value;\n        this.getRowIndex = function () {\n            return row;\n        };\n        this.setRowIndex = function (value) {\n            row = value;\n        };\n        this.getColIndex = function () {\n            return col;\n        };\n        this.setColIndex = function (value) {\n            col = value;\n        };\n        this.getValue = function () {\n            return value;\n        };\n        this.setValue = function (value) {\n            value = value;\n        };\n        return this;\n    }\n    return ValueChangedArgs;\n}());\nexport { ValueChangedArgs };\n","/**\n * To get Workbook required modules.\n * @hidden\n * @param {Workbook} context\n */\nexport function getWorkbookRequiredModules(context, modules) {\n    if (modules === void 0) { modules = []; }\n    modules.push({ member: 'workbookBasic', args: [] });\n    modules.push({ member: 'workbookAll', args: [] });\n    modules.push({\n        member: 'dataBind',\n        args: [context]\n    });\n    modules.push({\n        member: 'workbookProtectSheet',\n        args: [context]\n    });\n    if (context.allowSave) {\n        modules.push({\n            member: 'workbookSave',\n            args: [context]\n        });\n    }\n    if (context.allowOpen) {\n        modules.push({\n            member: 'workbookOpen',\n            args: [context]\n        });\n    }\n    if (context.allowEditing) {\n        modules.push({\n            member: 'workbookEdit',\n            args: [context]\n        });\n        modules.push({\n            member: 'workbookFormula',\n            args: [context]\n        });\n    }\n    if (context.allowNumberFormatting) {\n        modules.push({\n            member: 'workbookNumberFormat',\n            args: [context]\n        });\n    }\n    if (context.allowCellFormatting) {\n        modules.push({\n            member: 'workbookcellformat',\n            args: [context]\n        });\n    }\n    if (context.allowSorting) {\n        modules.push({ member: 'workbookSort', args: [context] });\n    }\n    if (context.allowHyperlink) {\n        modules.push({ member: 'workbookHyperlink', args: [context] });\n    }\n    if (context.allowFiltering) {\n        modules.push({ member: 'workbookFilter', args: [context] });\n    }\n    if (context.allowFindAndReplace) {\n        modules.push({ member: 'workbookfindAndReplace', args: [context] });\n    }\n    if (context.allowInsert) {\n        modules.push({ member: 'workbookinsert', args: [context] });\n    }\n    if (context.allowDelete) {\n        modules.push({ member: 'workbookdelete', args: [context] });\n    }\n    if (context.allowDataValidation) {\n        modules.push({ member: 'workbookDataValidation', args: [context] });\n    }\n    if (context.allowMerge) {\n        modules.push({ member: 'workbookmerge', args: [context] });\n    }\n    if (context.allowDataValidation) {\n        modules.push({ member: 'workbookConditionalFormatting', args: [context] });\n    }\n    if (context.allowImage) {\n        modules.push({ member: 'workbookImage', args: [context] });\n    }\n    if (context.allowChart) {\n        modules.push({ member: 'workbookChart', args: [context] });\n    }\n    return modules;\n}\n","/**\n * Check whether the text is formula or not.\n * @param text\n */\nexport function checkIsFormula(text) {\n    return text && text[0] === '=' && text.length > 1;\n}\n/**\n * Check whether the value is cell reference or not.\n * @param {string} value - Specify the value to check.\n */\nexport function isCellReference(value) {\n    var range = value;\n    range = range.split('$').join('');\n    if (range.indexOf(':') > -1) {\n        var rangeSplit = range.split(':');\n        if (isValidCellReference(rangeSplit[0]) && isValidCellReference(rangeSplit[1])) {\n            return true;\n        }\n    }\n    else if (range.indexOf(':') < 0) {\n        if (isValidCellReference(range)) {\n            return true;\n        }\n    }\n    return false;\n}\n/**\n * Check whether the value is character or not.\n * @param {string} value - Specify the value to check.\n */\nexport function isChar(value) {\n    if ((value.charCodeAt(0) >= 65 && value.charCodeAt(0) <= 90) || (value.charCodeAt(0) >= 97 && value.charCodeAt(0) <= 122)) {\n        return true;\n    }\n    return false;\n}\nexport function inRange(range, rowIdx, colIdx) {\n    return range && (rowIdx >= range[0] && rowIdx <= range[2] && colIdx >= range[1] && colIdx <= range[3]);\n}\n/**\n * Check whether the cell is locked or not\n * @hidden\n */\nexport function isLocked(cell, column) {\n    if (!cell) {\n        cell = {};\n    }\n    if (cell.isLocked) {\n        return true;\n    }\n    else if (cell.isLocked === false) {\n        return false;\n    }\n    else if (column && column.isLocked) {\n        return true;\n    }\n    else if (!cell.isLocked && (column && column.isLocked !== false)) {\n        return true;\n    }\n    return false;\n}\n/**\n * Check whether the value is cell reference or not.\n * @param {string} value - Specify the value to check.\n * @hidden\n */\nexport function isValidCellReference(value) {\n    var text = value;\n    var startNum = 0;\n    var endNum = 0;\n    var j = 0;\n    var numArr = [89, 71, 69];\n    // XFD is the last column, for that we are using ascii values of Z, G, E (89, 71, 69) to restrict the flow.\n    var cellText = '';\n    var textLength = text.length;\n    for (var i = 0; i < textLength; i++) {\n        if (isChar(text[i])) {\n            endNum++;\n        }\n    }\n    cellText = text.substring(startNum, endNum);\n    var cellTextLength = cellText.length;\n    if (cellTextLength !== textLength) {\n        if (cellTextLength < 4) {\n            if (textLength !== 1 && (isNaN(parseInt(text, 10)))) {\n                while (j < cellTextLength) {\n                    if ((cellText[j]) && cellText[j].charCodeAt(0) < numArr[j]) {\n                        j++;\n                        continue;\n                    }\n                    else if (!(cellText[j]) && j > 0) {\n                        break;\n                    }\n                    else {\n                        return false;\n                    }\n                }\n                var cellNumber = parseFloat(text.substring(endNum, textLength));\n                if (cellNumber > 0 && cellNumber < 1048577) { // 1048576 - Maximum number of rows in excel.\n                    return true;\n                }\n            }\n        }\n    }\n    return false;\n}\n","var __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    }\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nimport { extend, Property, ChildProperty, Complex, Collection, } from '@syncfusion/ej2-base';\nimport { CellStyle, wrapEvent, Chart } from '../common/index';\nimport { Image } from '../common/index';\nimport { getRow } from './index';\nimport { getSheet } from './sheet';\n/**\n * Represents the cell.\n */\nvar Cell = /** @class */ (function (_super) {\n    __extends(Cell, _super);\n    function Cell() {\n        return _super !== null && _super.apply(this, arguments) || this;\n    }\n    __decorate([\n        Collection([], Image)\n    ], Cell.prototype, \"image\", void 0);\n    __decorate([\n        Collection([], Chart)\n    ], Cell.prototype, \"chart\", void 0);\n    __decorate([\n        Property('')\n    ], Cell.prototype, \"value\", void 0);\n    __decorate([\n        Property('')\n    ], Cell.prototype, \"formula\", void 0);\n    __decorate([\n        Property(0)\n    ], Cell.prototype, \"index\", void 0);\n    __decorate([\n        Property('General')\n    ], Cell.prototype, \"format\", void 0);\n    __decorate([\n        Complex({}, CellStyle)\n    ], Cell.prototype, \"style\", void 0);\n    __decorate([\n        Property('')\n    ], Cell.prototype, \"hyperlink\", void 0);\n    __decorate([\n        Property(false)\n    ], Cell.prototype, \"wrap\", void 0);\n    __decorate([\n        Property(true)\n    ], Cell.prototype, \"isLocked\", void 0);\n    __decorate([\n        Property('')\n    ], Cell.prototype, \"validation\", void 0);\n    __decorate([\n        Property(1)\n    ], Cell.prototype, \"colSpan\", void 0);\n    __decorate([\n        Property(1)\n    ], Cell.prototype, \"rowSpan\", void 0);\n    return Cell;\n}(ChildProperty));\nexport { Cell };\n/**\n * @hidden\n */\nexport function getCell(rowIndex, colIndex, sheet, isInitRow, returnEmptyObjIfNull) {\n    var row = getRow(sheet, rowIndex);\n    if (!row || !row.cells) {\n        if (isInitRow) {\n            if (!row) {\n                sheet.rows[rowIndex] = { cells: [] };\n            }\n            else {\n                sheet.rows[rowIndex].cells = [];\n            }\n        }\n        else {\n            return returnEmptyObjIfNull ? {} : null;\n        }\n    }\n    return sheet.rows[rowIndex].cells[colIndex] || (returnEmptyObjIfNull ? {} : null);\n}\n/**\n * @hidden\n */\nexport function setCell(rowIndex, colIndex, sheet, cell, isExtend) {\n    if (!sheet.rows[rowIndex]) {\n        sheet.rows[rowIndex] = { cells: [] };\n    }\n    else if (!sheet.rows[rowIndex].cells) {\n        sheet.rows[rowIndex].cells = [];\n    }\n    if (isExtend && sheet.rows[rowIndex].cells[colIndex]) {\n        extend(sheet.rows[rowIndex].cells[colIndex], cell, null, true);\n    }\n    else {\n        sheet.rows[rowIndex].cells[colIndex] = cell;\n    }\n}\n/** @hidden */\nexport function skipDefaultValue(style, defaultKey) {\n    var defaultProps = { fontFamily: 'Calibri', verticalAlign: 'bottom', textIndent: '0pt', backgroundColor: '#ffffff',\n        color: '#000000', textAlign: 'left', fontSize: '11pt', fontWeight: 'normal', fontStyle: 'normal', textDecoration: 'none',\n        border: '', borderLeft: '', borderTop: '', borderRight: '', borderBottom: '' };\n    var changedProps = {};\n    Object.keys(defaultKey ? defaultProps : style).forEach(function (propName) {\n        if (style[propName] !== defaultProps[propName]) {\n            changedProps[propName] = style[propName];\n        }\n    });\n    return changedProps;\n}\n/** @hidden */\nexport function wrap(address, wrap, context) {\n    if (wrap === void 0) { wrap = true; }\n    var addressInfo = context.getAddressInfo(address);\n    var rng = addressInfo.indices;\n    var sheet = getSheet(context, addressInfo.sheetIndex);\n    for (var i = rng[0]; i <= rng[2]; i++) {\n        for (var j = rng[1]; j <= rng[3]; j++) {\n            setCell(i, j, sheet, { wrap: wrap }, true);\n        }\n    }\n    context.setProperties({ sheets: context.sheets }, true);\n    if (addressInfo.sheetIndex === context.activeSheetIndex) {\n        context.notify(wrapEvent, { range: rng, wrap: wrap, sheet: sheet });\n    }\n}\n","import { getSheetNameFromAddress, getSheetIndex, getSheet } from '../base/index';\nimport { getCellAddress, getIndexesFromAddress, getColumnHeaderText, updateSheetFromDataSource, checkDateFormat } from '../common/index';\nimport { queryCellInfo, cFDelete } from '../common/index';\nimport { getRow, getCell, isHiddenRow, isHiddenCol, getMaxSheetId, getSheetNameCount } from './index';\nimport { isUndefined, isNullOrUndefined } from '@syncfusion/ej2-base';\nimport { setCell } from './cell';\n/**\n * Update data source to Sheet and returns Sheet\n * @hidden\n */\nexport function getData(context, address, columnWiseData, valueOnly) {\n    return new Promise(function (resolve, reject) {\n        resolve((function () {\n            var i;\n            var cell;\n            var row;\n            var data = new Map();\n            var sheetIdx = getSheetIndex(context, getSheetNameFromAddress(address));\n            var sheet = getSheet(context, sheetIdx);\n            var indexes = getIndexesFromAddress(address);\n            var sRow = indexes[0];\n            var index = 0;\n            var args = {\n                sheet: sheet, indexes: indexes, promise: new Promise(function (resolve, reject) { resolve((function () { })()); })\n            };\n            context.notify(updateSheetFromDataSource, args);\n            return args.promise.then(function () {\n                while (sRow <= indexes[2]) {\n                    var cells = {};\n                    row = getRow(sheet, sRow);\n                    i = indexes[1];\n                    while (i <= indexes[3]) {\n                        if (columnWiseData) {\n                            if (data instanceof Map) {\n                                data = [];\n                            }\n                            var key = getColumnHeaderText(i + 1);\n                            var rowKey = '__rowIndex';\n                            if (valueOnly) {\n                                cells[key] = row ? getValueFromFormat(context, sRow, i, sheetIdx, sheet) : '';\n                            }\n                            else {\n                                cells[key] = row ? getCell(sRow, i, sheet) : null;\n                            }\n                            if (indexes[3] < i + 1) {\n                                cells[rowKey] = (sRow + 1).toString();\n                            }\n                            data[index.toString()] = cells;\n                        }\n                        else {\n                            var cellObj = {};\n                            Object.assign(cellObj, row ? getCell(sRow, i, sheet) : null);\n                            if (cellObj.colSpan > 1 && cellObj.rowSpan > 1) {\n                                var cell_1 = void 0;\n                                for (var j = sRow, len = sRow + cellObj.rowSpan; j < len; j++) {\n                                    for (var k = i, len_1 = i + cellObj.colSpan; k < len_1; k++) {\n                                        if (j === sRow && k === i) {\n                                            continue;\n                                        }\n                                        cell_1 = new Object();\n                                        if (j !== sRow) {\n                                            cell_1.rowSpan = sRow - j;\n                                        }\n                                        if (k !== i) {\n                                            cell_1.colSpan = i - k;\n                                        }\n                                        if (sheet.rows[j] && sheet.rows[j].cells && sheet.rows[j].cells[k]) {\n                                            delete sheet.rows[j].cells[k].value;\n                                            delete sheet.rows[j].cells[k].formula;\n                                        }\n                                        setCell(j, k, sheet, cell_1, true);\n                                    }\n                                }\n                            }\n                            else if (cellObj.colSpan > 1) {\n                                for (var j = i + 1, len = i + cellObj.colSpan; j < len; j++) {\n                                    setCell(sRow, j, sheet, { colSpan: i - j }, true);\n                                    if (sheet.rows[sRow] && sheet.rows[sRow].cells && sheet.rows[sRow].cells[j]) {\n                                        delete sheet.rows[sRow].cells[j].value;\n                                        delete sheet.rows[sRow].cells[j].formula;\n                                    }\n                                }\n                            }\n                            else if (cellObj.rowSpan > 1) {\n                                for (var j = sRow + 1, len = sRow + cellObj.rowSpan; j < len; j++) {\n                                    setCell(j, i, sheet, { rowSpan: sRow - j }, true);\n                                    if (sheet.rows[j] && sheet.rows[j].cells && sheet.rows[j].cells[i]) {\n                                        delete sheet.rows[j].cells[i].value;\n                                        delete sheet.rows[j].cells[i].formula;\n                                    }\n                                }\n                            }\n                            if (!valueOnly && isHiddenRow(sheet, sRow)) {\n                                sRow++;\n                                continue;\n                            }\n                            if (!valueOnly && isHiddenCol(sheet, i)) {\n                                i++;\n                                continue;\n                            }\n                            if (cellObj.style) {\n                                var style = {};\n                                Object.assign(style, cellObj.style);\n                                cellObj.style = style;\n                            }\n                            var eventArgs = { cell: cellObj, address: getCellAddress(sRow, i) };\n                            context.trigger(queryCellInfo, eventArgs);\n                            data.set(eventArgs.address, eventArgs.cell);\n                        }\n                        i++;\n                    }\n                    sRow++;\n                    index++;\n                }\n                return data;\n            });\n        })());\n    });\n}\nfunction getValueFromFormat(context, rowIndex, colIndex, sheetIdx, sheet) {\n    var cell = getCell(rowIndex, colIndex, sheet);\n    if (cell) {\n        if (cell.format) {\n            var args = {\n                value: context.getDisplayText(cell), rowIndex: rowIndex, colIndex: colIndex,\n                sheetIndex: sheetIdx, dateObj: '', isDate: false, isTime: false\n            };\n            context.notify(checkDateFormat, args);\n            if (args.isDate) {\n                return args.dateObj;\n            }\n            else {\n                return cell.value;\n            }\n        }\n        else {\n            return cell.value;\n        }\n    }\n    else {\n        return '';\n    }\n}\n/**\n * @hidden\n */\nexport function getModel(model, idx) {\n    var diff;\n    var j;\n    var prevIdx;\n    if (isUndefined(model[idx]) || !(model[idx] && model[idx].index === idx)) {\n        for (var i = 0; i <= idx; i++) {\n            if (model && model[i]) {\n                diff = model[i].index - i;\n                if (diff > 0) {\n                    model.forEach(function (value, index) {\n                        if (value && value.index) {\n                            prevIdx = value.index;\n                            j = 1;\n                        }\n                        if (value && !value.index && index !== 0) {\n                            value.index = prevIdx + j;\n                        }\n                        j++;\n                    });\n                    while (diff--) {\n                        model.splice(i, 0, null);\n                    }\n                    i += diff;\n                }\n            }\n            else if (model) {\n                model[i] = null;\n            }\n            else {\n                model = [];\n            }\n        }\n    }\n    return model[idx];\n}\n/**\n * @hidden\n */\nexport function processIdx(model, isSheet, context) {\n    var j;\n    var diff = 0;\n    var cnt;\n    var len = model.length;\n    var _loop_1 = function (i) {\n        if (!isNullOrUndefined(model[i]) && !isUndefined(model[i].index)) {\n            cnt = diff = model[i].index - i;\n            delete model[i].index;\n        }\n        if (diff > 0) {\n            j = 0;\n            while (diff--) {\n                if (isSheet) {\n                    context.createSheet(i + j);\n                    j++;\n                }\n                else {\n                    model.splice(i, 0, null);\n                }\n            }\n            i += cnt;\n            len += cnt;\n        }\n        if (isSheet) {\n            if (model[i].id < 1) {\n                model[i].id = getMaxSheetId(context.sheets);\n            }\n            if (!model[i].name) {\n                context.setSheetPropertyOnMute(model[i], 'name', 'Sheet' + getSheetNameCount(context));\n            }\n            var cellCnt_1 = 0;\n            model[i].rows.forEach(function (row) {\n                cellCnt_1 = Math.max(cellCnt_1, (row && row.cells && row.cells.length - 1) || 0);\n            });\n            context.setSheetPropertyOnMute(model[i], 'usedRange', { rowIndex: model[i].rows.length - 1, colIndex: cellCnt_1 });\n        }\n        out_i_1 = i;\n    };\n    var out_i_1;\n    for (var i = 0; i < len; i++) {\n        _loop_1(i);\n        i = out_i_1;\n    }\n}\n/**\n * @hidden\n */\nexport function clearRange(context, address, sheetIdx, valueOnly) {\n    var sheet = getSheet(context, sheetIdx);\n    var range = getIndexesFromAddress(address);\n    var sRIdx = range[0];\n    var eRIdx = range[2];\n    var sCIdx;\n    var eCIdx;\n    for (sRIdx; sRIdx <= eRIdx; sRIdx++) {\n        sCIdx = range[1];\n        eCIdx = range[3];\n        for (sCIdx; sCIdx <= eCIdx; sCIdx++) {\n            var cell = getCell(sRIdx, sCIdx, sheet);\n            context.notify(cFDelete, { rowIdx: sRIdx, colIdx: sCIdx });\n            if (!isNullOrUndefined(cell) && valueOnly) {\n                delete cell.value;\n                if (!isNullOrUndefined(cell.formula)) {\n                    delete cell.formula;\n                }\n            }\n        }\n    }\n}\n","var __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    }\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nimport { processIdx } from './data';\nimport { ConditionalFormat } from '../common/index';\nimport { ProtectSettings } from '../common/index';\nimport { isUndefined, ChildProperty, Property, Complex, Collection } from '@syncfusion/ej2-base';\n/**\n * Configures the range processing for the spreadsheet.\n *  ```html\n * <div id='Spreadsheet'></div>\n * ```\n * ```typescript\n * let spreadsheet: Spreadsheet = new Spreadsheet({\n *      sheets: [{\n *                  name: 'First Sheet',\n *                  ranges: [{ dataSource: defaultData }],\n *                  rows: [{\n *                          index: 30,\n *                          cells: [{ index: 4, value: 'Total Amount:' },\n *                                  { formula: '=SUM(F2:F30)', style: { fontWeight: 'bold' } }]\n *                  }]\n * ...\n * });\n * spreadsheet.appendTo('#Spreadsheet');\n * ```\n */\nvar Range = /** @class */ (function (_super) {\n    __extends(Range, _super);\n    function Range() {\n        return _super !== null && _super.apply(this, arguments) || this;\n    }\n    Range.prototype.setProperties = function (prop, muteOnChange) {\n        var _this = this;\n        var name = 'name';\n        var instance = 'instance';\n        var parentObj = 'parentObj';\n        var currRangeIdx = 'currRangeIdx';\n        var controlParent = 'controlParent';\n        if (this[parentObj].isComplexArraySetter && this[controlParent] && this[controlParent].isAngular) {\n            if (Object.keys(prop).length) {\n                if (this[parentObj][currRangeIdx] === undefined) {\n                    this[parentObj][currRangeIdx] = 0;\n                }\n                else {\n                    this[parentObj][currRangeIdx] += 1;\n                }\n                var range = this[parentObj].ranges[this[parentObj][currRangeIdx]];\n                if (range && range.info) {\n                    this.info = range.info;\n                }\n                setTimeout(function () {\n                    if (_this[parentObj][currRangeIdx] !== undefined) {\n                        delete _this[parentObj][currRangeIdx];\n                    }\n                });\n            }\n            else if (this[controlParent].tagObjects[0].instance && this[controlParent].tagObjects[0].instance.hasChanges\n                && !this[controlParent].tagObjects[0].instance.isInitChanges) {\n                var sheetIdx = this[controlParent].sheets.indexOf(this[parentObj]);\n                if (this[parentObj].changedRangeIdx === undefined) {\n                    var rangeIdx_1;\n                    var tagObjects = this[controlParent].tagObjects[0].instance.list[sheetIdx].tagObjects;\n                    for (var i = 0; i < tagObjects.length; i++) {\n                        if (tagObjects[i][name] === 'ranges') {\n                            tagObjects[i][instance].list\n                                .forEach(function (range, idx) {\n                                if (range.hasChanges) {\n                                    rangeIdx_1 = idx;\n                                }\n                            });\n                            break;\n                        }\n                    }\n                    this[parentObj].changedRangeIdx = rangeIdx_1;\n                }\n            }\n        }\n        _super.prototype.setProperties.call(this, prop, muteOnChange);\n    };\n    __decorate([\n        Property(null)\n    ], Range.prototype, \"dataSource\", void 0);\n    __decorate([\n        Property('A1')\n    ], Range.prototype, \"startCell\", void 0);\n    __decorate([\n        Property(null)\n    ], Range.prototype, \"query\", void 0);\n    __decorate([\n        Property(true)\n    ], Range.prototype, \"showFieldAsHeader\", void 0);\n    __decorate([\n        Property('')\n    ], Range.prototype, \"template\", void 0);\n    __decorate([\n        Property('A1')\n    ], Range.prototype, \"address\", void 0);\n    return Range;\n}(ChildProperty));\nexport { Range };\n/**\n * Used range which contains end row index and end column index of the last used cell in sheet .\n */\nvar UsedRange = /** @class */ (function (_super) {\n    __extends(UsedRange, _super);\n    function UsedRange() {\n        return _super !== null && _super.apply(this, arguments) || this;\n    }\n    __decorate([\n        Property(0)\n    ], UsedRange.prototype, \"rowIndex\", void 0);\n    __decorate([\n        Property(0)\n    ], UsedRange.prototype, \"colIndex\", void 0);\n    return UsedRange;\n}(ChildProperty));\nexport { UsedRange };\n/**\n * Configures the sheet behavior for the spreadsheet.\n */\nvar Sheet = /** @class */ (function (_super) {\n    __extends(Sheet, _super);\n    function Sheet() {\n        return _super !== null && _super.apply(this, arguments) || this;\n    }\n    __decorate([\n        Property(null)\n    ], Sheet.prototype, \"rows\", void 0);\n    __decorate([\n        Property([])\n    ], Sheet.prototype, \"columns\", void 0);\n    __decorate([\n        Complex({}, ProtectSettings)\n    ], Sheet.prototype, \"protectSettings\", void 0);\n    __decorate([\n        Collection([], Range)\n    ], Sheet.prototype, \"ranges\", void 0);\n    __decorate([\n        Collection([], ConditionalFormat)\n    ], Sheet.prototype, \"conditionalFormats\", void 0);\n    __decorate([\n        Property(0)\n    ], Sheet.prototype, \"index\", void 0);\n    __decorate([\n        Property('')\n    ], Sheet.prototype, \"name\", void 0);\n    __decorate([\n        Property(100)\n    ], Sheet.prototype, \"rowCount\", void 0);\n    __decorate([\n        Property(100)\n    ], Sheet.prototype, \"colCount\", void 0);\n    __decorate([\n        Property('A1:A1')\n    ], Sheet.prototype, \"selectedRange\", void 0);\n    __decorate([\n        Property('A1')\n    ], Sheet.prototype, \"activeCell\", void 0);\n    __decorate([\n        Property({})\n    ], Sheet.prototype, \"usedRange\", void 0);\n    __decorate([\n        Property('A1')\n    ], Sheet.prototype, \"topLeftCell\", void 0);\n    __decorate([\n        Property(true)\n    ], Sheet.prototype, \"showHeaders\", void 0);\n    __decorate([\n        Property(true)\n    ], Sheet.prototype, \"showGridLines\", void 0);\n    __decorate([\n        Property(false)\n    ], Sheet.prototype, \"isProtected\", void 0);\n    __decorate([\n        Property('Visible')\n    ], Sheet.prototype, \"state\", void 0);\n    return Sheet;\n}(ChildProperty));\nexport { Sheet };\n/**\n * To get sheet index from address.\n * @hidden\n */\nexport function getSheetIndex(context, name) {\n    var idx;\n    for (var i = 0; i < context.sheets.length; i++) {\n        if (context.sheets[i].name.toLowerCase() === name.toLowerCase()) {\n            idx = i;\n            break;\n        }\n    }\n    return idx;\n}\n/**\n * To get sheet index from sheet id.\n * @hidden\n */\nexport function getSheetIndexFromId(context, id) {\n    var idx;\n    for (var i = 0; i < context.sheets.length; i++) {\n        if (context.sheets[i].id === id) {\n            idx = i;\n            break;\n        }\n    }\n    return idx;\n}\n/**\n * To get sheet name from address.\n * @hidden\n */\nexport function getSheetNameFromAddress(address) {\n    return address.split('!')[0].replace(/\\'/gi, '');\n}\n/**\n * To get sheet index from sheet name.\n * @hidden\n */\nexport function getSheetIndexByName(context, name, info) {\n    var len = info.length;\n    for (var i = 0; i < len; i++) {\n        if (info[i].sheet.toUpperCase() === name.toUpperCase()) {\n            return info[i].index;\n        }\n    }\n    return -1;\n}\n/**\n * update selected range\n * @hidden\n */\nexport function updateSelectedRange(context, range, sheet) {\n    if (sheet === void 0) { sheet = {}; }\n    context.setSheetPropertyOnMute(sheet, 'selectedRange', range);\n}\n/**\n * get selected range\n * @hidden\n */\nexport function getSelectedRange(sheet) {\n    return sheet && sheet.selectedRange || 'A1';\n}\n/**\n * @hidden\n */\nexport function getSheet(context, idx) {\n    return context.sheets[idx];\n}\n/**\n * @hidden\n */\nexport function getSheetNameCount(context) {\n    var name = [];\n    context.sheets.forEach(function (sheet) {\n        name.push(sheet.name.toLowerCase());\n    });\n    for (var i = 0; i < name.length; i++) {\n        if (name.indexOf('sheet' + context.sheetNameCount) > -1) {\n            context.sheetNameCount++;\n        }\n        else {\n            return context.sheetNameCount++;\n        }\n    }\n    return context.sheetNameCount++;\n}\n/**\n * @hidden\n */\nexport function getMaxSheetId(sheets) {\n    var cnt = 0;\n    sheets.forEach(function (sheet) {\n        cnt = Math.max(sheet.id, cnt);\n    });\n    return cnt + 1;\n}\n/**\n * @hidden\n */\nexport function initSheet(context, sheet) {\n    var sheets = sheet ? sheet : context.sheets;\n    sheets.forEach(function (sheet) {\n        sheet.id = sheet.id || 0;\n        sheet.name = sheet.name || '';\n        sheet.rowCount = isUndefined(sheet.rowCount) ? 100 : sheet.rowCount;\n        sheet.colCount = isUndefined(sheet.colCount) ? 100 : sheet.colCount;\n        sheet.topLeftCell = sheet.topLeftCell || 'A1';\n        sheet.activeCell = sheet.activeCell || 'A1';\n        sheet.selectedRange = sheet.selectedRange || 'A1:A1';\n        sheet.usedRange = sheet.usedRange || { rowIndex: 0, colIndex: 0 };\n        context.setSheetPropertyOnMute(sheet, 'ranges', sheet.ranges ? sheet.ranges : []);\n        context.setSheetPropertyOnMute(sheet, 'rows', sheet.rows || []);\n        context.setSheetPropertyOnMute(sheet, 'columns', sheet.columns || []);\n        sheet.showHeaders = isUndefined(sheet.showHeaders) ? true : sheet.showHeaders;\n        sheet.showGridLines = isUndefined(sheet.showGridLines) ? true : sheet.showGridLines;\n        sheet.state = sheet.state || 'Visible';\n        sheet.maxHgts = [];\n        sheet.protectSettings = sheet.protectSettings || { selectCells: false, formatCells: false, formatRows: false, formatColumns: false,\n            insertLink: false };\n        sheet.isProtected = sheet.isProtected || false;\n        processIdx(sheet.columns);\n        initRow(sheet.rows);\n    });\n    processIdx(sheets, true, context);\n}\nfunction initRangeSettings(ranges) {\n    ranges.forEach(function (range) {\n        range.startCell = range.startCell || 'A1';\n        range.address = range.address || 'A1';\n        range.template = range.template || '';\n        range.showFieldAsHeader = isUndefined(range.showFieldAsHeader) ? true : range.showFieldAsHeader;\n    });\n    return ranges;\n}\nfunction initRow(rows) {\n    rows.forEach(function (row) {\n        if (row && row.cells) {\n            processIdx(row.cells);\n        }\n    });\n    processIdx(rows);\n}\n/**\n * get sheet name\n * @hidden\n */\nexport function getSheetName(context, idx) {\n    if (idx === void 0) { idx = context.activeSheetIndex; }\n    return getSheet(context, idx).name;\n}\n","var __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    }\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nimport { ChildProperty, Collection, Property, Complex } from '@syncfusion/ej2-base';\nimport { Cell } from './cell';\nimport { Format } from '../common/index';\n/**\n * Configures the Row behavior for the spreadsheet.\n *  ```html\n * <div id='Spreadsheet'></div>\n * ```\n * ```typescript\n * let spreadsheet: Spreadsheet = new Spreadsheet({\n *      sheets: [{\n *                rows: [{\n *                        index: 30,\n *                        cells: [{ index: 4, value: 'Total Amount:' },\n *                               { formula: '=SUM(F2:F30)', style: { fontWeight: 'bold' } }]\n *                }]\n * ...\n * });\n * spreadsheet.appendTo('#Spreadsheet');\n * ```\n */\nvar Row = /** @class */ (function (_super) {\n    __extends(Row, _super);\n    function Row() {\n        return _super !== null && _super.apply(this, arguments) || this;\n    }\n    __decorate([\n        Collection([], Cell)\n    ], Row.prototype, \"cells\", void 0);\n    __decorate([\n        Property(0)\n    ], Row.prototype, \"index\", void 0);\n    __decorate([\n        Property(20)\n    ], Row.prototype, \"height\", void 0);\n    __decorate([\n        Property(false)\n    ], Row.prototype, \"customHeight\", void 0);\n    __decorate([\n        Property(false)\n    ], Row.prototype, \"hidden\", void 0);\n    __decorate([\n        Complex({}, Format)\n    ], Row.prototype, \"format\", void 0);\n    return Row;\n}(ChildProperty));\nexport { Row };\n/**\n * @hidden\n */\nexport function getRow(sheet, rowIndex) {\n    return sheet.rows[rowIndex];\n}\n/** @hidden */\nexport function setRow(sheet, rowIndex, row) {\n    if (!sheet.rows[rowIndex]) {\n        sheet.rows[rowIndex] = {};\n    }\n    Object.keys(row).forEach(function (key) {\n        sheet.rows[rowIndex][key] = row[key];\n    });\n}\n/** @hidden */\nexport function isHiddenRow(sheet, index) {\n    return sheet.rows[index] && sheet.rows[index].hidden;\n}\n/**\n * @hidden\n */\nexport function getRowHeight(sheet, rowIndex) {\n    if (sheet && sheet.rows && sheet.rows[rowIndex]) {\n        if (sheet.rows[rowIndex].hidden) {\n            return 0;\n        }\n        return sheet.rows[rowIndex].height === undefined ? 20 : sheet.rows[rowIndex].height;\n    }\n    else {\n        return 20;\n    }\n}\n/**\n * @hidden\n */\nexport function setRowHeight(sheet, rowIndex, height) {\n    if (sheet && sheet.rows) {\n        if (!sheet.rows[rowIndex]) {\n            sheet.rows[rowIndex] = {};\n        }\n        sheet.rows[rowIndex].height = height;\n    }\n}\n/**\n * @hidden\n */\nexport function getRowsHeight(sheet, startRow, endRow) {\n    if (endRow === void 0) { endRow = startRow; }\n    var height = 0;\n    var swap;\n    if (startRow > endRow) {\n        swap = startRow;\n        startRow = endRow;\n        endRow = swap;\n    }\n    for (var i = startRow; i <= endRow; i++) {\n        height += getRowHeight(sheet, i);\n    }\n    return height;\n}\n","var __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    }\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nimport { ChildProperty, Property, Complex } from '@syncfusion/ej2-base';\nimport { Format } from '../common/index';\n/**\n * Configures the Column behavior for the spreadsheet.\n */\nvar Column = /** @class */ (function (_super) {\n    __extends(Column, _super);\n    function Column() {\n        return _super !== null && _super.apply(this, arguments) || this;\n    }\n    __decorate([\n        Property(0)\n    ], Column.prototype, \"index\", void 0);\n    __decorate([\n        Property(64)\n    ], Column.prototype, \"width\", void 0);\n    __decorate([\n        Property(false)\n    ], Column.prototype, \"customWidth\", void 0);\n    __decorate([\n        Property(false)\n    ], Column.prototype, \"hidden\", void 0);\n    __decorate([\n        Complex({}, Format)\n    ], Column.prototype, \"format\", void 0);\n    __decorate([\n        Property(true)\n    ], Column.prototype, \"isLocked\", void 0);\n    return Column;\n}(ChildProperty));\nexport { Column };\n/**\n * @hidden\n */\nexport function getColumn(sheet, colIndex) {\n    if (sheet.columns) {\n        if (!sheet.columns[colIndex]) {\n            sheet.columns[colIndex] = {};\n        }\n    }\n    else {\n        sheet.columns = [];\n        sheet.columns[colIndex] = {};\n    }\n    return sheet.columns[colIndex];\n}\n/** @hidden */\nexport function setColumn(sheet, colIndex, column) {\n    var curColumn = getColumn(sheet, colIndex);\n    Object.keys(column).forEach(function (key) {\n        curColumn[key] = column[key];\n    });\n}\n/**\n * @hidden\n */\nexport function getColumnWidth(sheet, index, skipHidden) {\n    if (sheet && sheet.columns && sheet.columns[index]) {\n        if (!skipHidden && sheet.columns[index].hidden) {\n            return 0;\n        }\n        return (sheet.columns[index].width || sheet.columns[index].customWidth) ? sheet.columns[index].width : 64;\n    }\n    else {\n        return 64;\n    }\n}\n/**\n * @hidden\n */\nexport function getColumnsWidth(sheet, startCol, endCol) {\n    if (endCol === void 0) { endCol = startCol; }\n    var width = 0;\n    if (startCol > endCol) {\n        var swap = startCol;\n        startCol = endCol;\n        endCol = swap;\n    }\n    for (var i = startCol; i <= endCol; i++) {\n        width += getColumnWidth(sheet, i);\n    }\n    return width;\n}\n/** @hidden */\nexport function isHiddenCol(sheet, index) {\n    return sheet.columns[index] && sheet.columns[index].hidden;\n}\n","import { getWorkbookRequiredModules } from '../../workbook/common/module';\n/**\n * To get Spreadsheet required modules.\n * @hidden\n * @param {Spreadsheet} context\n */\nexport function getRequiredModules(context) {\n    var modules = [];\n    pushBasicModules(context, modules);\n    getWorkbookRequiredModules(context, modules);\n    return modules;\n}\n// tslint:disable-next-line:max-func-body-length\nfunction pushBasicModules(context, modules) {\n    modules.push({ member: 'basic', args: [] });\n    modules.push({ member: 'all', args: [] });\n    if (context.showRibbon) {\n        modules.push({\n            member: 'ribbon',\n            args: [context]\n        });\n    }\n    if (context.showFormulaBar) {\n        modules.push({\n            member: 'formulaBar',\n            args: [context]\n        });\n    }\n    if (context.showSheetTabs) {\n        modules.push({\n            member: 'sheetTabs',\n            args: [context]\n        });\n    }\n    if (context.allowEditing) {\n        modules.push({\n            member: 'edit',\n            args: [context]\n        });\n        modules.push({\n            member: 'formula',\n            args: [context]\n        });\n        modules.push({\n            member: 'workbookFormula',\n            args: [context]\n        });\n        modules.push({\n            member: 'workbookEdit',\n            args: [context]\n        });\n    }\n    if (context.allowOpen) {\n        modules.push({\n            member: 'open',\n            args: [context]\n        });\n    }\n    if (context.allowSave) {\n        modules.push({\n            member: 'save',\n            args: [context]\n        });\n    }\n    if (context.enableContextMenu) {\n        modules.push({\n            member: 'contextMenu',\n            args: [context]\n        });\n    }\n    if (context.selectionSettings.mode !== 'None') {\n        modules.push({\n            member: 'selection',\n            args: [context]\n        });\n    }\n    if (context.enableKeyboardNavigation) {\n        modules.push({\n            member: 'keyboardNavigation',\n            args: [context]\n        });\n    }\n    if (context.allowNumberFormatting) {\n        modules.push({\n            member: 'numberFormat',\n            args: [context]\n        });\n    }\n    if (context.enableKeyboardShortcut) {\n        modules.push({\n            member: 'keyboardShortcut',\n            args: [context]\n        });\n    }\n    if (context.enableClipboard) {\n        modules.push({\n            member: 'clipboard',\n            args: [context]\n        });\n    }\n    if (context.allowCellFormatting) {\n        modules.push({\n            member: 'cellformat',\n            args: [context]\n        });\n    }\n    if (context.allowSorting) {\n        modules.push({ member: 'sort', args: [context] });\n    }\n    if (context.allowResizing) {\n        modules.push({\n            member: 'resize',\n            args: [context]\n        });\n    }\n    modules.push({\n        member: 'collaborativeEditing',\n        args: [context]\n    });\n    modules.push({\n        member: 'protectSheet',\n        args: [context]\n    });\n    if (context.allowHyperlink) {\n        modules.push({\n            member: 'spreadsheetHyperlink',\n            args: [context]\n        });\n    }\n    if (context.allowUndoRedo) {\n        modules.push({\n            member: 'undoredo',\n            args: [context]\n        });\n    }\n    if (context.allowFiltering) {\n        modules.push({ member: 'filter', args: [context] });\n    }\n    if (context.allowWrap) {\n        modules.push({ member: 'wrapText', args: [context] });\n    }\n    if (context.allowInsert) {\n        modules.push({ member: 'insert', args: [context] });\n    }\n    if (context.allowDelete) {\n        modules.push({ member: 'delete', args: [context] });\n    }\n    if (context.allowDataValidation) {\n        modules.push({ member: 'dataValidation', args: [context] });\n    }\n    if (context.allowFindAndReplace) {\n        modules.push({ member: 'findAndReplace', args: [context] });\n    }\n    if (context.allowMerge) {\n        modules.push({ member: 'merge', args: [context] });\n    }\n    if (context.allowConditionalFormat) {\n        modules.push({ member: 'conditionalFormatting', args: [context] });\n    }\n    if (context.allowImage) {\n        modules.push({ member: 'spreadsheetImage', args: [context] });\n    }\n    if (context.allowChart) {\n        modules.push({ member: 'spreadsheetChart', args: [context] });\n    }\n}\n","import { Browser, setStyleAttribute as setBaseStyleAttribute, getComponent } from '@syncfusion/ej2-base';\nimport { clearViewer, deleteImage, createImageElement, refreshImgCellObj } from './index';\nimport { getRowsHeight, getColumnsWidth, getSwapRange, clearCells } from '../../workbook/index';\nimport { getRangeIndexes, wrap, setRowHeight, insertModel, } from '../../workbook/index';\nimport { initiateSort, getIndexesFromAddress, getRowHeight, setMerge } from '../../workbook/index';\nimport { setValidation, removeValidation, clearCFRule, setCFRule } from '../../workbook/index';\nimport { removeSheetTab, rowHeightChanged } from './index';\nimport { getCellIndexes, getCell, getColumnWidth, setChart, refreshChartSize } from '../../workbook/index';\nimport { deleteChart } from '../../spreadsheet/index';\nimport { initiateFilterUI } from './event';\n/**\n * The function used to update Dom using requestAnimationFrame.\n * @param  {Function} fn - Function that contains the actual action\n * @return {Promise<T>}\n * @hidden\n */\nexport function getUpdateUsingRaf(fn) {\n    requestAnimationFrame(function () {\n        fn();\n    });\n}\n/**\n * The function used to remove the dom element children.\n * @param  parent -\n * @hidden\n */\nexport function removeAllChildren(parent, index) {\n    while (parent.firstChild) {\n        parent.removeChild(parent.firstChild);\n    }\n}\n/**\n * The function used to get colgroup width based on the row index.\n * @param  parent -\n * @hidden\n */\nexport function getColGroupWidth(index) {\n    var width = 30;\n    if (index.toString().length > 3) {\n        width = index.toString().length * 10;\n    }\n    return width;\n}\nvar scrollAreaWidth = null;\n/** @hidden */\nexport function getScrollBarWidth() {\n    if (scrollAreaWidth !== null) {\n        return scrollAreaWidth;\n    }\n    var htmlDivNode = document.createElement('div');\n    var result = 0;\n    htmlDivNode.style.cssText = 'width:100px;height: 100px;overflow: scroll;position: absolute;top: -9999px;';\n    document.body.appendChild(htmlDivNode);\n    result = (htmlDivNode.offsetWidth - htmlDivNode.clientWidth) | 0;\n    document.body.removeChild(htmlDivNode);\n    return scrollAreaWidth = result;\n}\nvar classes = ['e-ribbon', 'e-formula-bar-panel', 'e-sheet-tab-panel', 'e-header-toolbar'];\n/** @hidden */\nexport function getSiblingsHeight(element, classList) {\n    if (classList === void 0) { classList = classes; }\n    var previous = getHeightFromDirection(element, 'previous', classList);\n    var next = getHeightFromDirection(element, 'next', classList);\n    return previous + next;\n}\nfunction getHeightFromDirection(element, direction, classList) {\n    // tslint:disable-next-line:no-any\n    var sibling = (element)[direction + 'ElementSibling'];\n    var result = 0;\n    while (sibling) {\n        if (classList.some(function (value) { return sibling.classList.contains(value); })) {\n            result += sibling.offsetHeight;\n        }\n        // tslint:disable-next-line:no-any\n        sibling = (sibling)[direction + 'ElementSibling'];\n    }\n    return result;\n}\n/**\n * @hidden\n */\nexport function inView(context, range, isModify) {\n    if (context.scrollSettings.enableVirtualization) {\n        var topIdx = context.viewport.topIndex;\n        var leftIdx = context.viewport.leftIndex;\n        var bottomIdx = topIdx + context.viewport.rowCount + context.getThreshold('row') * 2;\n        var rightIdx = leftIdx + context.viewport.colCount + context.getThreshold('col') * 2;\n        var inView_1 = topIdx <= range[0] && bottomIdx >= range[2] && leftIdx <= range[1] && rightIdx >= range[3];\n        if (inView_1) {\n            return true;\n        }\n        if (isModify) {\n            if (range[0] < topIdx && range[2] < topIdx || range[0] > bottomIdx && range[2] > bottomIdx) {\n                return false;\n            }\n            else {\n                if (range[0] < topIdx && range[2] > topIdx) {\n                    range[0] = topIdx;\n                    inView_1 = true;\n                }\n                if (range[2] > bottomIdx) {\n                    range[2] = bottomIdx;\n                    inView_1 = true;\n                }\n            }\n            if (range[1] < leftIdx && range[3] < leftIdx || range[1] > rightIdx && range[3] > rightIdx) {\n                return false;\n            }\n            else {\n                if (range[1] < leftIdx && range[3] > leftIdx) {\n                    range[1] = leftIdx;\n                    inView_1 = true;\n                }\n                if (range[3] > rightIdx) {\n                    range[3] = rightIdx;\n                    inView_1 = true;\n                }\n            }\n        }\n        return inView_1;\n    }\n    else {\n        return true;\n    }\n}\n/**\n * To get the top left cell position in viewport.\n * @hidden\n */\nexport function getCellPosition(sheet, indexes, offset) {\n    if (offset === void 0) { offset = { left: { idx: 0, size: 0 }, top: { idx: 0, size: 0 } }; }\n    var i;\n    var top = offset.top.size;\n    var left = offset.left.size;\n    for (i = offset.top.idx; i < indexes[0]; i++) {\n        top += getRowsHeight(sheet, i);\n    }\n    for (i = offset.left.idx; i < indexes[1]; i++) {\n        left += getColumnsWidth(sheet, i);\n    }\n    return { top: top, left: left };\n}\n/**\n * Position element with given range\n * @hidden\n */\nexport function locateElem(ele, range, sheet, isRtl, offset) {\n    var swapRange = getSwapRange(range);\n    var cellPosition = getCellPosition(sheet, swapRange, offset);\n    var startIndex = [skipHiddenIdx(sheet, 0, true), skipHiddenIdx(sheet, 0, true, 'columns')];\n    var attrs = {\n        'top': (swapRange[0] === startIndex[0] ? cellPosition.top : cellPosition.top - 1) + 'px',\n        'height': getRowsHeight(sheet, range[0], range[2]) + (swapRange[0] === startIndex[0] ? 0 : 1) + 'px',\n        'width': getColumnsWidth(sheet, range[1], range[3]) + (swapRange[1] === startIndex[1] ? 0 : 1) + 'px'\n    };\n    attrs[isRtl ? 'right' : 'left'] = (swapRange[1] === startIndex[1] ? cellPosition.left : cellPosition.left - 1) + 'px';\n    if (ele) {\n        setStyleAttribute([{ element: ele, attrs: attrs }]);\n    }\n}\n/**\n * To update element styles using request animation frame\n * @hidden\n */\nexport function setStyleAttribute(styles) {\n    requestAnimationFrame(function () {\n        styles.forEach(function (style) {\n            setBaseStyleAttribute(style.element, style.attrs);\n        });\n    });\n}\n/**\n * @hidden\n */\nexport function getStartEvent() {\n    return (Browser.isPointer ? 'pointerdown' : 'mousedown touchstart');\n}\n/**\n * @hidden\n */\nexport function getMoveEvent() {\n    return (Browser.isPointer ? 'pointermove' : 'mousemove touchmove');\n}\n/**\n * @hidden\n */\nexport function getEndEvent() {\n    return (Browser.isPointer ? 'pointerup' : 'mouseup touchend');\n}\n/**\n * @hidden\n */\nexport function isTouchStart(e) {\n    return e.type === 'touchstart' || (e.type === 'pointerdown' && e.pointerType === 'touch');\n}\n/**\n * @hidden\n */\nexport function isTouchMove(e) {\n    return e.type === 'touchmove' || (e.type === 'pointermove' && e.pointerType === 'touch');\n}\n/**\n * @hidden\n */\nexport function isTouchEnd(e) {\n    return e.type === 'touchend' || (e.type === 'pointerup' && e.pointerType === 'touch');\n}\n/**\n * @hidden\n */\nexport function getClientX(e) {\n    return e.changedTouches ? e.changedTouches[0].clientX : e.clientX;\n}\n/**\n * @hidden\n */\nexport function getClientY(e) {\n    return e.changedTouches ? e.changedTouches[0].clientY : e.clientY;\n}\nvar config = {\n    role: 'role',\n    selected: 'aria-selected',\n    multiselectable: 'aria-multiselectable',\n    busy: 'aria-busy',\n    colcount: 'aria-colcount'\n};\n/** @hidden */\nexport function setAriaOptions(target, options) {\n    var props = Object.keys(options);\n    props.forEach(function (name) {\n        if (target) {\n            target.setAttribute(config[name], options[name]);\n        }\n    });\n}\n/**\n * @hidden\n */\nexport function destroyComponent(element, component) {\n    if (element) {\n        var compObj = getComponent(element, component);\n        if (compObj) {\n            compObj.destroy();\n        }\n    }\n}\n/**\n * @hidden\n */\n// tslint:disable-next-line:max-func-body-length\nexport function setResize(index, value, isCol, parent) {\n    var curEle;\n    var curEleH;\n    var curEleC;\n    var preEle;\n    var preEleH;\n    var preEleC;\n    var nxtEle;\n    var nxtEleH;\n    var nxtEleC;\n    var sheet = parent.getActiveSheet();\n    if (isCol) {\n        curEle = parent.element.getElementsByClassName('e-column-header')[0].getElementsByTagName('th')[index];\n        curEleH = parent.element.getElementsByClassName('e-column-header')[0].getElementsByTagName('col')[index];\n        curEleC = parent.element.getElementsByClassName('e-sheet-content')[0].getElementsByTagName('col')[index];\n    }\n    else {\n        curEle = parent.element.getElementsByClassName('e-row-header')[0].getElementsByTagName('tr')[index];\n        curEleH = parent.element.getElementsByClassName('e-row-header')[0].getElementsByTagName('tr')[index];\n        curEleC = parent.element.getElementsByClassName('e-sheet-content')[0].getElementsByTagName('tr')[index];\n        curEleH.style.height = parseInt(value, 10) > 0 ? value : '2px';\n        curEleC.style.height = parseInt(value, 10) > 0 ? value : '0px';\n        var hdrRow = parent.getRowHeaderContent().getElementsByClassName('e-row');\n        var hdrClone = [];\n        hdrClone[0] = hdrRow[index].getElementsByTagName('td')[0].cloneNode(true);\n        var hdrFntSize = findMaxValue(parent.getRowHeaderTable(), hdrClone, false, parent) + 1;\n        var contentRow = parent.getMainContent().getElementsByClassName('e-row');\n        var contentClone = [];\n        for (var idx = 0; idx < contentRow[index].getElementsByTagName('td').length; idx++) {\n            contentClone[idx] = contentRow[index].getElementsByTagName('td')[idx].cloneNode(true);\n        }\n        var cntFntSize = findMaxValue(parent.getContentTable(), contentClone, false, parent) + 1;\n        var fntSize = hdrFntSize >= cntFntSize ? hdrFntSize : cntFntSize;\n        if (parseInt(curEleC.style.height, 10) < fntSize ||\n            (curEle.classList.contains('e-reach-fntsize') && parseInt(curEleC.style.height, 10) === fntSize)) {\n            curEle.classList.add('e-reach-fntsize');\n            curEleH.style.lineHeight = parseInt(value, 10) >= 4 ? ((parseInt(value, 10)) - 4) + 'px' :\n                parseInt(value, 10) > 0 ? ((parseInt(value, 10)) - 1) + 'px' : '0px';\n            curEleC.style.lineHeight = parseInt(value, 10) > 0 ? ((parseInt(value, 10)) - 1) + 'px' : '0px';\n        }\n        else {\n            curEleH.style.removeProperty('line-height');\n            curEleC.style.removeProperty('line-height');\n            if (curEle.classList.contains('e-reach-fntsize')) {\n                curEle.classList.remove('e-reach-fntsize');\n            }\n        }\n    }\n    preEle = curEle.previousElementSibling;\n    nxtEle = curEle.nextElementSibling;\n    if (preEle) {\n        preEle = curEle.previousElementSibling;\n        preEleH = curEleH.previousElementSibling;\n        preEleC = curEleC.previousElementSibling;\n    }\n    if (nxtEle) {\n        nxtEle = curEle.nextElementSibling;\n        nxtEleH = curEleH.nextElementSibling;\n        nxtEleC = curEleC.nextElementSibling;\n    }\n    if (parseInt(value, 10) <= 0 && !(curEle.classList.contains('e-zero') || curEle.classList.contains('e-zero-start'))) {\n        if (preEle && nxtEle) {\n            if (isCol) {\n                curEleH.style.width = '2px';\n                curEleC.style.width = '0px';\n            }\n            else {\n                curEleH.style.height = '2px';\n                curEleC.style.height = '0px';\n            }\n            if (preEle.classList.contains('e-zero-start')) {\n                curEle.classList.add('e-zero-start');\n                curEleC.classList.add('e-zero-start');\n            }\n            else {\n                curEle.classList.add('e-zero');\n                curEleC.classList.add('e-zero');\n            }\n            if (!nxtEle.classList.contains('e-zero') && !nxtEle.classList.contains('e-zero-last')) {\n                curEle.classList.add('e-zero-last');\n                curEleC.classList.add('e-zero-last');\n            }\n            if (preEle.classList.contains('e-zero-last')) {\n                preEle.classList.remove('e-zero-last');\n                preEleC.classList.remove('e-zero-last');\n            }\n            if (preEle.classList.contains('e-zero')) {\n                if (curEle.classList.contains('e-zero-end')) {\n                    setWidthAndHeight(preEleH, -2, isCol);\n                }\n                else {\n                    setWidthAndHeight(preEleH, -2, isCol);\n                }\n            }\n            else {\n                setWidthAndHeight(preEleH, -1, isCol);\n            }\n            if (preEle.classList.contains('e-zero-start')) {\n                setWidthAndHeight(curEleH, -1, isCol);\n            }\n            if (nxtEle.classList.contains('e-zero')) {\n                if (curEle.classList.contains('e-zero-start')) {\n                    while (nxtEle) {\n                        if (nxtEle.classList.contains('e-zero') && (parseInt(nxtEleH.style.height, 10) !== 0 && !isCol) ||\n                            (parseInt(nxtEleH.style.width, 10) !== 0 && isCol)) {\n                            if (isCol) {\n                                curEleH.style.width = parseInt(curEleH.style.width, 10) - 1 + 'px';\n                                nxtEleH.style.width = parseInt(nxtEleH.style.width, 10) - 1 + 'px';\n                            }\n                            else {\n                                curEleH.style.height = parseInt(curEleH.style.height, 10) - 1 + 'px';\n                                nxtEleH.style.height = parseInt(nxtEleH.style.height, 10) - 1 + 'px';\n                            }\n                            nxtEle.classList.remove('e-zero');\n                            nxtEle.classList.add('e-zero-start');\n                            break;\n                        }\n                        else {\n                            var nxtIndex = void 0;\n                            nxtEle.classList.remove('e-zero');\n                            nxtEle.classList.add('e-zero-start');\n                            if (isCol) {\n                                nxtIndex = parseInt(nxtEle.getAttribute('aria-colindex'), 10) - 1;\n                                nxtEle = parent.getColHeaderTable().getElementsByTagName('th')[nxtIndex + 1];\n                                nxtEleH = parent.getColHeaderTable().getElementsByTagName('col')[nxtIndex + 1];\n                            }\n                            else {\n                                nxtIndex = parseInt(nxtEle.getAttribute('aria-rowindex'), 10) - 1;\n                                nxtEle = parent.getRowHeaderTable().getElementsByTagName('tr')[nxtIndex + 1];\n                                nxtEleH = parent.getRowHeaderTable().getElementsByTagName('tr')[nxtIndex + 1];\n                            }\n                        }\n                    }\n                }\n                else {\n                    setWidthAndHeight(curEleH, -2, isCol);\n                }\n            }\n            else {\n                if (nxtEle.classList.contains('e-zero-end')) {\n                    if (isCol) {\n                        curEleH.style.width = '0px';\n                    }\n                    else {\n                        curEleH.style.height = '0px';\n                    }\n                }\n                else {\n                    setWidthAndHeight(nxtEleH, -1, isCol);\n                }\n            }\n        }\n        else if (preEle) {\n            if (isCol) {\n                curEleH.style.width = '1px';\n                curEleC.style.width = '0px';\n            }\n            else {\n                curEleH.style.height = '1px';\n                curEleC.style.height = '0px';\n            }\n            curEle.classList.add('e-zero-end');\n            curEleC.classList.add('e-zero-end');\n            curEle.classList.add('e-zero-last');\n            curEleC.classList.add('e-zero-last');\n            if (preEle.classList.contains('e-zero')) {\n                setWidthAndHeight(preEleH, -2, isCol);\n            }\n            else {\n                setWidthAndHeight(preEleH, -1, isCol);\n            }\n        }\n        else if (nxtEle) {\n            curEle.classList.add('e-zero-start');\n            curEleC.classList.add('e-zero-start');\n            if (!nxtEle.classList.contains('e-zero')) {\n                curEle.classList.add('e-zero-last');\n                curEleC.classList.add('e-zero-last');\n            }\n            if (isCol) {\n                curEleH.style.width = '1px';\n                curEleC.style.width = '0px';\n            }\n            else {\n                curEleH.style.height = '1px';\n                curEleC.style.height = '0px';\n            }\n            if (nxtEle.classList.contains('e-zero')) {\n                while (nxtEle) {\n                    if (nxtEle.classList.contains('e-zero') && (parseInt(nxtEleH.style.width, 10) !== 0\n                        && isCol) || (parseInt(nxtEleH.style.height, 10) !== 0 && !isCol)) {\n                        if (isCol) {\n                            nxtEleH.style.width = parseInt(nxtEleH.style.width, 10) - 1 + 'px';\n                            curEleH.style.width = parseInt(curEleH.style.width, 10) - 1 + 'px';\n                        }\n                        else {\n                            nxtEleH.style.height = parseInt(nxtEleH.style.height, 10) - 1 + 'px';\n                            curEleH.style.height = parseInt(curEleH.style.height, 10) - 1 + 'px';\n                        }\n                        nxtEle.classList.add('e-zero-start');\n                        nxtEle.classList.remove('e-zero');\n                        break;\n                    }\n                    else {\n                        var nxtIndex = void 0;\n                        nxtEle.classList.add('e-zero-start');\n                        nxtEle.classList.remove('e-zero');\n                        if (isCol) {\n                            nxtIndex = parseInt(nxtEle.getAttribute('aria-colindex'), 10) - 1;\n                            nxtEleH = parent.getColHeaderTable().getElementsByTagName('col')[nxtIndex + 1];\n                            nxtEle = parent.getColHeaderTable().getElementsByTagName('th')[nxtIndex + 1];\n                        }\n                        else {\n                            nxtIndex = parseInt(nxtEle.getAttribute('aria-rowindex'), 10) - 1;\n                            nxtEleH = parent.getRowHeaderTable().getElementsByTagName('tr')[nxtIndex + 1];\n                            nxtEle = parent.getRowHeaderTable().getElementsByTagName('tr')[nxtIndex + 1];\n                        }\n                    }\n                }\n            }\n            else {\n                setWidthAndHeight(nxtEleH, -1, isCol);\n            }\n        }\n    }\n    else if (parseInt(value, 10) > 0) {\n        if (isCol) {\n            curEleH.style.width = value;\n            curEleC.style.width = value;\n        }\n        else {\n            curEleH.style.height = value;\n            curEleC.style.height = value;\n        }\n        if (preEle && nxtEle) {\n            if (preEle.classList.contains('e-zero')) {\n                if (curEle.classList.contains('e-zero')) {\n                    if (isCol) {\n                        preEleH.style.width = parseInt(preEleH.style.width, 10) + 2 + 'px';\n                        curEleH.style.width = parseInt(curEleH.style.width, 10) - 1 + 'px';\n                    }\n                    else {\n                        preEleH.style.height = parseInt(preEleH.style.height, 10) + 2 + 'px';\n                        curEleH.style.height = parseInt(curEleH.style.height, 10) - 1 + 'px';\n                    }\n                }\n                else {\n                    setWidthAndHeight(curEleH, -1, isCol);\n                }\n            }\n            else {\n                if (curEle.classList.contains('e-zero')) {\n                    setWidthAndHeight(preEleH, 1, isCol);\n                }\n                else {\n                    if (curEle.classList.contains('e-zero-start')) {\n                        if (isCol) {\n                            preEleH.style.width = parseInt(preEleH.style.width, 10) + 1 + 'px';\n                            curEleH.style.width = parseInt(curEleH.style.width, 10) - 1 + 'px';\n                        }\n                        else {\n                            preEleH.style.height = parseInt(preEleH.style.height, 10) + 1 + 'px';\n                            curEleH.style.height = parseInt(curEleH.style.height, 10) - 1 + 'px';\n                        }\n                    }\n                }\n            }\n            if (nxtEle.classList.contains('e-zero')) {\n                setWidthAndHeight(curEleH, -1, isCol);\n            }\n            else {\n                if (curEle.classList.contains('e-zero') || curEle.classList.contains('e-zero-start')) {\n                    setWidthAndHeight(nxtEleH, 1, isCol);\n                }\n            }\n            if (curEle.classList.contains('e-zero')) {\n                curEle.classList.remove('e-zero');\n            }\n            if (curEle.classList.contains('e-zero-start')) {\n                curEle.classList.remove('e-zero-start');\n            }\n            if (curEleC.classList.contains('e-zero')) {\n                curEleC.classList.remove('e-zero');\n            }\n            if (curEleC.classList.contains('e-zero-start')) {\n                curEleC.classList.remove('e-zero-start');\n            }\n            if (curEle.classList.contains('e-zero-last')) {\n                curEle.classList.remove('e-zero-last');\n            }\n            if (curEleC.classList.contains('e-zero-last')) {\n                curEleC.classList.remove('e-zero-last');\n            }\n            if (preEle.classList.contains('e-zero') || preEle.classList.contains('e-zero-start')) {\n                preEle.classList.add('e-zero-last');\n                preEleC.classList.add('e-zero-last');\n            }\n        }\n        else if (preEle) {\n            if (preEle.classList.contains('e-zero')) {\n                if (curEle.classList.contains('e-zero')) {\n                    if (isCol) {\n                        curEleH.style.width = parseInt(curEleH.style.width, 10) - 1 + 'px';\n                        preEleH.style.width = parseInt(preEleH.style.width, 10) + 2 + 'px';\n                    }\n                    else {\n                        curEleH.style.height = parseInt(curEleH.style.height, 10) - 1 + 'px';\n                        preEleH.style.height = parseInt(preEleH.style.height, 10) + 2 + 'px';\n                    }\n                }\n                else {\n                    setWidthAndHeight(curEleH, -1, isCol);\n                }\n            }\n            else {\n                if (curEle.classList.contains('e-zero')) {\n                    setWidthAndHeight(preEleH, 1, isCol);\n                }\n                else {\n                    setWidthAndHeight(curEleH, -1, isCol);\n                }\n            }\n            if (curEle.classList.contains('e-zero')) {\n                curEle.classList.remove('e-zero');\n            }\n            if (curEle.classList.contains('e-zero-end')) {\n                curEle.classList.remove('e-zero-end');\n            }\n            if (curEleC.classList.contains('e-zero')) {\n                curEleC.classList.remove('e-zero');\n            }\n            if (curEleC.classList.contains('e-zero-end')) {\n                curEleC.classList.remove('e-zero-end');\n            }\n        }\n        else if (nxtEle) {\n            if (nxtEle.classList.contains('e-zero')) {\n                setWidthAndHeight(curEleH, -1, isCol);\n            }\n            else if (curEle.classList.contains('e-zero-start')) {\n                setWidthAndHeight(nxtEleH, 1, isCol);\n                curEle.classList.remove('e-zero-start');\n            }\n            if (curEle.classList.contains('e-zero')) {\n                curEle.classList.remove('e-zero');\n            }\n            if (curEleC.classList.contains('e-zero')) {\n                curEleC.classList.remove('e-zero');\n            }\n            if (curEle.classList.contains('e-zero-start')) {\n                curEle.classList.remove('e-zero-start');\n            }\n            if (curEleC.classList.contains('e-zero-start')) {\n                curEleC.classList.remove('e-zero-start');\n            }\n        }\n    }\n}\n/**\n * @hidden\n */\nexport function setWidthAndHeight(trgt, value, isCol) {\n    if (isCol) {\n        trgt.style.width = parseInt(trgt.style.width, 10) + value + 'px';\n    }\n    else {\n        trgt.style.height = parseInt(trgt.style.height, 10) + value + 'px';\n    }\n}\n/**\n * @hidden\n */\nexport function findMaxValue(table, text, isCol, parent, prevData, isWrap) {\n    var myTableDiv = parent.createElement('div', { className: parent.element.className, styles: 'display: block' });\n    var myTable = parent.createElement('table', {\n        className: table.className + 'e-resizetable',\n        styles: 'width: auto;height: auto'\n    });\n    var myTr = parent.createElement('tr');\n    if (isCol) {\n        text.forEach(function (element) {\n            var tr = myTr.cloneNode();\n            tr.appendChild(element);\n            myTable.appendChild(tr);\n        });\n    }\n    else {\n        text.forEach(function (element) {\n            myTr.appendChild(element.cloneNode(true));\n        });\n        myTable.appendChild(myTr);\n    }\n    myTableDiv.appendChild(myTable);\n    document.body.appendChild(myTableDiv);\n    var offsetWidthValue;\n    var offsetHeightValue;\n    if (!isWrap) {\n        offsetHeightValue = myTable.getBoundingClientRect().height;\n        offsetWidthValue = myTable.getBoundingClientRect().width;\n    }\n    else {\n        offsetHeightValue = parseInt(prevData, 10);\n        offsetWidthValue = parseInt(prevData, 10);\n    }\n    document.body.removeChild(myTableDiv);\n    if (isCol) {\n        return Math.ceil(offsetWidthValue);\n    }\n    else {\n        return Math.ceil(offsetHeightValue);\n    }\n}\n/**\n * @hidden\n */\n// tslint:disable-next-line\nexport function updateAction(options, spreadsheet, isRedo) {\n    /* tslint:disable-next-line no-any */\n    var eventArgs = options.eventArgs;\n    switch (options.action) {\n        case 'sorting':\n            var args = {\n                range: options.eventArgs.range,\n                sortOptions: options.eventArgs.sortOptions,\n                cancel: false\n            };\n            var promise = new Promise(function (resolve, reject) {\n                resolve((function () { })());\n            });\n            var sortArgs = { args: args, promise: promise };\n            spreadsheet.notify(initiateSort, sortArgs);\n            sortArgs.promise.then(function (args) {\n                spreadsheet.serviceLocator.getService('cell').refreshRange(getIndexesFromAddress(args.range));\n            });\n            break;\n        case 'cellSave':\n            var cellEvtArgs = options.eventArgs;\n            var cellValue = eventArgs.formula ? { formula: cellEvtArgs.formula } : { value: cellEvtArgs.value };\n            spreadsheet.updateCell(cellValue, cellEvtArgs.address);\n            break;\n        case 'format':\n            if (eventArgs.requestType === 'CellFormat') {\n                spreadsheet.cellFormat(eventArgs.style, eventArgs.range);\n            }\n            else {\n                spreadsheet.numberFormat(eventArgs.format, eventArgs.range);\n            }\n            break;\n        case 'clipboard':\n            if (eventArgs.copiedInfo.isCut && !isRedo) {\n                return;\n            }\n            var clipboardPromise = eventArgs.copiedInfo.isCut ? spreadsheet.cut(eventArgs.copiedRange)\n                : spreadsheet.copy(eventArgs.copiedRange);\n            clipboardPromise.then(function (args) {\n                spreadsheet.paste(eventArgs.pastedRange, eventArgs.type);\n            });\n            break;\n        case 'gridLines':\n            spreadsheet.setSheetPropertyOnMute(spreadsheet.sheets[eventArgs.sheetIdx], 'showGridLines', eventArgs.isShow);\n            break;\n        case 'headers':\n            spreadsheet.setSheetPropertyOnMute(spreadsheet.sheets[eventArgs.sheetIdx], 'showHeaders', eventArgs.isShow);\n            break;\n        case 'resize':\n        case 'resizeToFit':\n            if (eventArgs.isCol) {\n                if (eventArgs.hide === undefined) {\n                    spreadsheet.setColWidth(eventArgs.width, eventArgs.index, eventArgs.sheetIdx);\n                }\n                else {\n                    spreadsheet.hideColumn(eventArgs.index, eventArgs.index, eventArgs.hide);\n                }\n            }\n            else {\n                if (eventArgs.hide === undefined) {\n                    spreadsheet.setRowHeight(eventArgs.height, eventArgs.index, eventArgs.sheetIdx);\n                }\n                else {\n                    spreadsheet.hideRow(eventArgs.index, eventArgs.index, eventArgs.hide);\n                }\n            }\n            break;\n        case 'renameSheet':\n            spreadsheet.setSheetPropertyOnMute(spreadsheet.sheets[eventArgs.index - 1], 'name', eventArgs.value);\n            break;\n        case 'removeSheet':\n            spreadsheet.notify(removeSheetTab, {\n                index: eventArgs.index,\n                isAction: true,\n                count: eventArgs.sheetCount,\n                clicked: true\n            });\n            break;\n        case 'wrap':\n            wrap(options.eventArgs.address, options.eventArgs.wrap, spreadsheet);\n            break;\n        case 'hideShow':\n            eventArgs.isCol ? spreadsheet.hideColumn(eventArgs.startIndex, eventArgs.endIndex, eventArgs.hide) :\n                spreadsheet.hideRow(eventArgs.startIndex, eventArgs.endIndex, eventArgs.hide);\n            break;\n        case 'replace':\n            spreadsheet.updateCell({ value: eventArgs.compareVal }, eventArgs.address);\n            break;\n        case 'filter':\n            spreadsheet.notify(initiateFilterUI, { predicates: null, range: eventArgs.range, sIdx: eventArgs.index, isCut: true });\n            break;\n        case 'insert':\n            if (isRedo === false) {\n                spreadsheet.delete(options.eventArgs.index, options.eventArgs.index + (options.eventArgs.model.length - 1), options.eventArgs.modelType);\n            }\n            else {\n                spreadsheet.notify(insertModel, {\n                    model: options.eventArgs.modelType === 'Sheet' ? spreadsheet :\n                        spreadsheet.getActiveSheet(), start: options.eventArgs.index, end: options.eventArgs.index +\n                        (options.eventArgs.model.length - 1), modelType: options.eventArgs.modelType,\n                    isAction: false, checkCount: options.eventArgs.sheetCount,\n                    activeSheetIndex: options.eventArgs.activeSheetIndex\n                });\n            }\n            break;\n        case 'delete':\n            if (isRedo === false) {\n                spreadsheet.notify(insertModel, {\n                    model: options.eventArgs.modelType === 'Sheet' ? spreadsheet :\n                        spreadsheet.getActiveSheet(), start: options.eventArgs.deletedModel, modelType: options.eventArgs.modelType,\n                    isAction: false, columnCellsModel: options.eventArgs.deletedCellsModel\n                });\n            }\n            else {\n                spreadsheet.delete(options.eventArgs.startIndex, options.eventArgs.endIndex, options.eventArgs.modelType);\n            }\n            break;\n        case 'validation':\n            if (isRedo) {\n                var rules = {\n                    type: eventArgs.type, operator: eventArgs.operator, value1: eventArgs.value1,\n                    value2: eventArgs.value2, ignoreBlank: eventArgs.ignoreBlank, inCellDropDown: eventArgs.inCellDropDown\n                };\n                spreadsheet.notify(setValidation, { rules: rules, range: eventArgs.range });\n            }\n            else {\n                spreadsheet.notify(removeValidation, { range: eventArgs.range });\n            }\n            break;\n        case 'merge':\n            options.eventArgs.isAction = false;\n            spreadsheet.notify(setMerge, options.eventArgs);\n            break;\n        case 'clear':\n            spreadsheet.notify(clearViewer, { options: options.eventArgs, isPublic: true });\n            break;\n        case 'conditionalFormat':\n            if (isRedo) {\n                var conditionalFormat = {\n                    type: eventArgs.type, cFColor: eventArgs.cFColor, value: eventArgs.value,\n                    range: eventArgs.range\n                };\n                spreadsheet.notify(setCFRule, { conditionalFormat: conditionalFormat });\n            }\n            else {\n                spreadsheet.notify(clearCFRule, { range: eventArgs.range });\n            }\n            break;\n        case 'clearCF':\n            if (isRedo) {\n                spreadsheet.notify(clearCFRule, { range: eventArgs.selectedRange });\n            }\n            else {\n                spreadsheet.notify(clearCells, {\n                    conditionalFormats: eventArgs.cFormats,\n                    oldRange: eventArgs.oldRange, selectedRange: eventArgs.selectedRange\n                });\n            }\n            break;\n        case 'insertImage':\n            if (isRedo) {\n                spreadsheet.notify(createImageElement, {\n                    options: {\n                        src: options.eventArgs.imageData,\n                        height: options.eventArgs.imageHeight, width: options.eventArgs.imageWidth, imageId: options.eventArgs.id\n                    },\n                    range: options.eventArgs.range, isPublic: false, isUndoRedo: true\n                });\n            }\n            else {\n                spreadsheet.notify(deleteImage, {\n                    id: options.eventArgs.id, sheetIdx: options.eventArgs.sheetIndex + 1, range: options.eventArgs.range\n                });\n            }\n            break;\n        case 'imageRefresh':\n            var element = document.getElementById(options.eventArgs.id);\n            if (isRedo) {\n                options.eventArgs.isUndoRedo = true;\n                spreadsheet.notify(refreshImgCellObj, options.eventArgs);\n            }\n            else {\n                spreadsheet.notify(refreshImgCellObj, {\n                    prevTop: options.eventArgs.currentTop, prevLeft: options.eventArgs.currentLeft,\n                    currentTop: options.eventArgs.prevTop, currentLeft: options.eventArgs.prevLeft, id: options.eventArgs.id,\n                    currentHeight: options.eventArgs.prevHeight, currentWidth: options.eventArgs.prevWidth, requestType: 'imageRefresh',\n                    prevHeight: options.eventArgs.currentHeight, prevWidth: options.eventArgs.currentWidth, isUndoRedo: true\n                });\n            }\n            element.style.height = isRedo ? options.eventArgs.currentHeight + 'px' : options.eventArgs.prevHeight + 'px';\n            element.style.width = isRedo ? options.eventArgs.currentWidth + 'px' : options.eventArgs.prevWidth + 'px';\n            element.style.top = isRedo ? options.eventArgs.currentTop + 'px' : options.eventArgs.prevTop + 'px';\n            element.style.left = isRedo ? options.eventArgs.currentLeft + 'px' : options.eventArgs.prevLeft + 'px';\n            break;\n        case 'insertChart':\n            if (isRedo) {\n                var chartOptions = [{\n                        type: eventArgs.type, theme: eventArgs.theme, isSeriesInRows: eventArgs.isSeriesInRows,\n                        range: eventArgs.range, id: eventArgs.id, height: eventArgs.height, width: eventArgs.width\n                    }];\n                spreadsheet.notify(setChart, {\n                    chart: chartOptions, isInitCell: eventArgs.isInitCell, isUndoRedo: false, range: eventArgs.posRange\n                });\n            }\n            else {\n                spreadsheet.notify(deleteChart, { id: eventArgs.id });\n            }\n            break;\n        case 'deleteChart':\n            if (isRedo) {\n                spreadsheet.notify(deleteChart, { id: eventArgs.id });\n            }\n            else {\n                var chartOpts = [{\n                        type: eventArgs.type, theme: eventArgs.theme, isSeriesInRows: eventArgs.isSeriesInRows,\n                        range: eventArgs.range, id: eventArgs.id, height: eventArgs.height, width: eventArgs.width\n                    }];\n                spreadsheet.notify(setChart, {\n                    chart: chartOpts, isInitCell: eventArgs.isInitCell, isUndoRedo: false, range: eventArgs.posRange\n                });\n            }\n            break;\n        case 'chartRefresh':\n            var chartElement = document.getElementById(options.eventArgs.id);\n            if (chartElement) {\n                chartElement.style.height = isRedo ? options.eventArgs.currentHeight + 'px' : options.eventArgs.prevHeight + 'px';\n                chartElement.style.width = isRedo ? options.eventArgs.currentWidth + 'px' : options.eventArgs.prevWidth + 'px';\n                chartElement.style.top = isRedo ? options.eventArgs.currentTop + 'px' : options.eventArgs.prevTop + 'px';\n                chartElement.style.left = isRedo ? options.eventArgs.currentLeft + 'px' : options.eventArgs.prevLeft + 'px';\n            }\n            if (isRedo) {\n                options.eventArgs.isUndoRedo = true;\n                spreadsheet.notify(refreshChartSize, {\n                    height: chartElement.style.height, width: chartElement.style.width, overlayEle: chartElement\n                });\n            }\n            else {\n                spreadsheet.notify(refreshChartSize, {\n                    height: chartElement.style.height, width: chartElement.style.width, overlayEle: chartElement\n                });\n            }\n            break;\n    }\n}\n/**\n * @hidden\n */\nexport function hasTemplate(workbook, rowIdx, colIdx, sheetIdx) {\n    var sheet = workbook.sheets[sheetIdx];\n    var ranges = sheet.ranges;\n    var range;\n    for (var i = 0, len = ranges.length; i < len; i++) {\n        if (ranges[i].template) {\n            range = getRangeIndexes(ranges[i].address.length ? ranges[i].address : ranges[i].startCell);\n            if (range[0] <= rowIdx && range[1] <= colIdx && range[2] >= rowIdx && range[3] >= colIdx) {\n                return true;\n            }\n        }\n    }\n    return false;\n}\n/**\n * Setting row height in view an model.\n * @hidden\n */\nexport function setRowEleHeight(parent, sheet, height, rowIdx, row, hRow, notifyRowHgtChange) {\n    if (notifyRowHgtChange === void 0) { notifyRowHgtChange = true; }\n    var prevHgt = getRowHeight(sheet, rowIdx);\n    var edit = parent.element.querySelector('.e-spreadsheet-edit');\n    if (edit && (edit.innerHTML.indexOf('\\n') > -1)) {\n        var actCell = getCellIndexes(parent.getActiveSheet().activeCell);\n        var cell = getCell(actCell[0], actCell[1], sheet);\n        var i = void 0;\n        var splitVal = edit.innerHTML.split('\\n');\n        var n = 0;\n        var valLength = splitVal.length;\n        for (i = 0; i < valLength; i++) {\n            var lines = getLines(splitVal[i], getColumnWidth(sheet, actCell[1]), cell.style, parent.cellStyle);\n            if (lines === 0) {\n                lines = 1; // for empty new line\n            }\n            n = n + lines;\n        }\n        height = getTextHeight(parent, cell.style || parent.cellStyle, n) + 1;\n    }\n    if (row || parent.getRow(rowIdx)) {\n        (row || parent.getRow(rowIdx)).style.height = height + \"px\";\n    }\n    if (sheet.showHeaders && hRow || parent.getRow(rowIdx, parent.getRowHeaderTable())) {\n        (hRow || parent.getRow(rowIdx, parent.getRowHeaderTable())).style.height = height + \"px\";\n    }\n    setRowHeight(sheet, rowIdx, height);\n    parent.setProperties({ sheets: parent.sheets }, true);\n    if (notifyRowHgtChange) {\n        parent.notify(rowHeightChanged, { rowIdx: rowIdx, threshold: height - prevHgt });\n    }\n}\n/** @hidden */\nexport function getTextHeight(context, style, lines) {\n    if (lines === void 0) { lines = 1; }\n    var fontSize = (style && style.fontSize) || context.cellStyle.fontSize;\n    var fontSizePx = fontSize.indexOf('pt') > -1 ? parseInt(fontSize, 10) * 1.33 : parseInt(fontSize, 10);\n    return Math.ceil(fontSizePx * (style && style.fontFamily === 'Arial Black' ? 1.44 : 1.24) * lines);\n}\n/** @hidden */\nexport function getTextWidth(text, style, parentStyle) {\n    if (!style) {\n        style = parentStyle;\n    }\n    var canvas = document.createElement('canvas');\n    var context = canvas.getContext('2d');\n    context.font = (style.fontStyle || parentStyle.fontStyle) + ' ' + (style.fontWeight || parentStyle.fontWeight) + ' '\n        + (style.fontSize || parentStyle.fontSize) + ' ' + (style.fontFamily || parentStyle.fontFamily);\n    return context.measureText(text).width;\n}\n/**\n * @hidden\n */\nexport function getLines(text, colwidth, style, parentStyle) {\n    var width;\n    var prevWidth = 0;\n    var textArr = text.toString().split(' ');\n    var spaceWidth = getTextWidth(' ', style, parentStyle);\n    var lines;\n    var cnt = 0;\n    colwidth -= 5; // for padding\n    textArr.forEach(function (txt) {\n        var lWidth = 0;\n        var cWidth = 0;\n        width = getTextWidth(txt, style, parentStyle);\n        lines = (prevWidth + width) / colwidth;\n        if (lines >= 1) {\n            if (prevWidth) {\n                cnt++;\n            }\n            if (width / colwidth >= 1) {\n                txt.split('').forEach(function (val) {\n                    cWidth = getTextWidth(val, style, parentStyle);\n                    lWidth += cWidth;\n                    if (lWidth > colwidth) {\n                        cnt++;\n                        lWidth = cWidth;\n                    }\n                });\n                prevWidth = lWidth + spaceWidth;\n            }\n            else {\n                prevWidth = width + spaceWidth;\n            }\n        }\n        else {\n            prevWidth += (width + spaceWidth);\n        }\n    });\n    if (prevWidth) {\n        cnt += Math.ceil((prevWidth - spaceWidth) / colwidth);\n    }\n    return cnt;\n}\n/**\n * Setting maximum height while doing formats and wraptext\n * @hidden\n */\nexport function setMaxHgt(sheet, rIdx, cIdx, hgt) {\n    if (!sheet.maxHgts[rIdx]) {\n        sheet.maxHgts[rIdx] = {};\n    }\n    sheet.maxHgts[rIdx][cIdx] = hgt;\n}\n/**\n * Getting maximum height by comparing each cell's modified height.\n * @hidden\n */\nexport function getMaxHgt(sheet, rIdx) {\n    var maxHgt = 0;\n    var rowHgt = sheet.maxHgts[rIdx];\n    if (rowHgt) {\n        Object.keys(rowHgt).forEach(function (key) {\n            if (rowHgt[key] > maxHgt) {\n                maxHgt = rowHgt[key];\n            }\n        });\n    }\n    return maxHgt;\n}\n/** @hidden */\nexport function skipHiddenIdx(sheet, index, increase, layout) {\n    if (layout === void 0) { layout = 'rows'; }\n    if (index < 0) {\n        index = -1;\n    }\n    if ((sheet[layout])[index] && (sheet[layout])[index].hidden) {\n        increase ? index++ : index--;\n        index = skipHiddenIdx(sheet, index, increase, layout);\n    }\n    return index;\n}\n","/**\n * Specifies Workbook internal events.\n */\n/** @hidden */\nexport var workbookDestroyed = 'workbookDestroyed';\n/** @hidden */\nexport var updateSheetFromDataSource = 'updateSheetFromDataSource';\n/** @hidden */\nexport var dataSourceChanged = 'dataSourceChanged';\n/** @hidden */\nexport var dataChanged = 'dataChanged';\n/** @hidden */\nexport var workbookOpen = 'workbookOpen';\n/** @hidden */\nexport var beginSave = 'beginSave';\n/** @hidden */\nexport var getFilteredCollection = 'getFilteredCollection';\n/** @hidden */\nexport var saveCompleted = 'saveCompleted';\n/** @hidden */\nexport var applyNumberFormatting = 'applyNumber';\n/** @hidden */\nexport var getFormattedCellObject = 'getFormattedCell';\n/** @hidden */\nexport var refreshCellElement = 'refreshCellElem';\n/** @hidden */\nexport var setCellFormat = 'setCellFormat';\n/** @hidden */\nexport var findAllValues = 'findAllValues';\n/** @hidden */\nexport var textDecorationUpdate = 'textDecorationUpdate';\n/** @hidden */\nexport var applyCellFormat = 'applyCellFormat';\n/** @hidden */\nexport var updateUsedRange = 'updateUsedRange';\n/** @hidden */\nexport var workbookFormulaOperation = 'workbookFormulaOperation';\n/** @hidden */\nexport var workbookEditOperation = 'workbookEditOperation';\n/** @hidden */\nexport var checkDateFormat = 'checkDateFormat';\n/** @hidden */\nexport var getFormattedBarText = 'getFormattedBarText';\n/** @hidden */\nexport var activeCellChanged = 'activeCellChanged';\n/** @hidden */\nexport var openSuccess = 'openSuccess';\n/** @hidden */\nexport var openFailure = 'openFailure';\n/** @hidden */\nexport var sheetCreated = 'sheetCreated';\n/** @hidden */\nexport var sheetsDestroyed = 'sheetsDestroyed';\n/** @hidden */\nexport var aggregateComputation = 'aggregateComputation';\n/** @hidden */\nexport var beforeSort = 'beforeSort';\n/** @hidden */\nexport var initiateSort = 'initiateSort';\n/** @hidden */\nexport var sortComplete = 'sortComplete';\n/** @hidden */\nexport var sortRangeAlert = 'sortRangeAlert';\n/** @hidden */\nexport var initiatelink = 'initiatelink';\n/** @hidden */\nexport var beforeHyperlinkCreate = 'beforeHyperlinkCreate';\n/** @hidden */\nexport var afterHyperlinkCreate = 'afterHyperlinkCreate';\n/** @hidden */\nexport var beforeHyperlinkClick = 'beforeHyperlinkClick';\n/** @hidden */\nexport var afterHyperlinkClick = 'afterHyperlinkClick';\n/** @hidden */\nexport var addHyperlink = 'addHyperlink';\n/** @hidden */\nexport var setLinkModel = 'setLinkModel';\n/** @hidden */\nexport var beforeFilter = 'beforeFilter';\n/** @hidden */\nexport var initiateFilter = 'initiateFilter';\n/** @hidden */\nexport var filterComplete = 'filterComplete';\n/** @hidden */\nexport var filterRangeAlert = 'filterRangeAlert';\n/** @hidden */\nexport var clearAllFilter = 'clearAllFilter';\n/** @hidden */\nexport var wrapEvent = 'wrapText';\n/** @hidden */\nexport var onSave = 'onSave';\n/** @hidden */\nexport var insert = 'insert';\n/** @hidden */\nexport var deleteAction = 'delete';\n/** @hidden */\nexport var insertModel = 'insertModel';\n/** @hidden */\nexport var deleteModel = 'deleteModel';\n/** @hidden */\nexport var isValidation = 'isValidation';\n/** @hidden */\nexport var setValidation = 'setValidation';\n/** @hidden */\nexport var addHighlight = 'addHighlight';\n/** @hidden */\nexport var dataValidate = 'dataValidate';\n/** @hidden */\nexport var findNext = 'findNext';\n/** @hidden */\nexport var findPrevious = 'findPrevious';\n/** @hidden */\nexport var goto = 'gotoHandler';\n/** @hidden */\nexport var findWorkbookHandler = 'findHandler';\n/** @hidden */\nexport var replaceHandler = 'replace';\n/** @hidden */\nexport var replaceAllHandler = 'replaceAll';\n/** @hidden */\nexport var showDialog = 'ShowDialog';\n/** @hidden */\nexport var findUndoRedo = 'findUndoRedo';\n/** @hidden */\nexport var findKeyUp = 'findKeyUp';\n/** @hidden */\nexport var removeValidation = 'removeValidation';\n/** @hidden */\nexport var removeHighlight = 'removeHighlight';\n/** @hidden */\nexport var queryCellInfo = 'queryCellInfo';\n/** @hidden */\nexport var count = 'count';\n/** @hidden */\nexport var findCount = 'findCount';\n/** @hidden */\nexport var protectSheetWorkBook = 'protectSheet';\n/** @hidden */\nexport var updateToggle = 'updateToggleItem';\n/** @hidden */\nexport var protectsheetHandler = 'protectsheetHandler';\n/** @hidden */\nexport var replaceAllDialog = 'replaceAllDialog';\n/** @hidden */\nexport var unprotectsheetHandler = 'unprotectsheetHandler';\n/** @hidden */\nexport var workBookeditAlert = 'editAlert';\n/** @hidden */\nexport var setLockCells = 'setLockCells';\n/** @hidden */\nexport var applyLockCells = 'applyLockCells';\n/** @hidden */\nexport var setMerge = 'setMerge';\n/** @hidden */\nexport var applyMerge = 'applyMerge';\n/** @hidden */\nexport var mergedRange = 'mergedRange';\n/** @hidden */\nexport var activeCellMergedRange = 'activeCellMergedRange';\n/** @hidden */\nexport var insertMerge = 'insertMerge';\n/** @hidden */\nexport var pasteMerge = 'pasteMerge';\n/** @hidden */\nexport var setCFRule = 'setCFRule';\n/** @hidden */\nexport var cFInitialCheck = 'cFInitialCheck';\n/** @hidden */\nexport var clearCFRule = 'clearCFRule';\n/** @hidden */\nexport var initiateClearCFRule = 'initiateClearCFRule';\n/** @hidden */\nexport var cFRender = 'cFRender';\n/** @hidden */\nexport var cFDelete = 'cFDelete';\n/** @hidden */\nexport var clear = 'clear';\n/** @hidden */\nexport var clearCF = 'clearCF';\n/** @hidden */\nexport var clearCells = 'clearCells';\n/** @hidden */\nexport var setImage = 'setImage';\n/** @hidden */\nexport var setChart = 'setChart';\n/** @hidden */\nexport var initiateChart = 'initiateChart';\n/** @hidden */\nexport var refreshRibbonIcons = 'refreshRibbonIcons';\n/** @hidden */\nexport var refreshChart = 'refreshChart';\n/** @hidden */\nexport var refreshChartSize = 'refreshChartSize';\n/** @hidden */\nexport var updateChart = 'updateChart';\n/** @hidden */\nexport var deleteChartColl = 'deleteChartColl';\n/** @hidden */\nexport var initiateChartModel = 'initiateChartModel';\n/** @hidden */\nexport var focusChartBorder = 'focusChartBorder';\n/** @hidden */\nexport var saveError = 'saveError';\n","import { DataManager, Query, Deferred } from '@syncfusion/ej2-data';\nimport { getCell, setCell } from '../base/index';\nimport { getRangeIndexes, checkIsFormula, updateSheetFromDataSource, checkDateFormat, dataSourceChanged } from '../common/index';\nimport { getCellIndexes, dataChanged, getCellAddress } from '../common/index';\nimport { getFormatFromType } from './number-format';\n/**\n * Data binding module\n */\nvar DataBind = /** @class */ (function () {\n    function DataBind(parent) {\n        this.parent = parent;\n        this.requestedInfo = [];\n        this.addEventListener();\n    }\n    DataBind.prototype.addEventListener = function () {\n        this.parent.on(updateSheetFromDataSource, this.updateSheetFromDataSourceHandler, this);\n        this.parent.on(dataSourceChanged, this.dataSourceChangedHandler, this);\n        this.parent.on(dataChanged, this.dataChangedHandler, this);\n    };\n    DataBind.prototype.removeEventListener = function () {\n        if (!this.parent.isDestroyed) {\n            this.parent.off(updateSheetFromDataSource, this.updateSheetFromDataSourceHandler);\n            this.parent.off(dataSourceChanged, this.dataSourceChangedHandler);\n            this.parent.off(dataChanged, this.dataChangedHandler);\n        }\n    };\n    /**\n     * Update given data source to sheet.\n     */\n    // tslint:disable-next-line\n    DataBind.prototype.updateSheetFromDataSourceHandler = function (args) {\n        var _this = this;\n        var cell;\n        var flds;\n        var sCellIdx;\n        var result;\n        var remoteUrl;\n        var isLocal;\n        var dataManager;\n        var requestedRange = [];\n        var sRanges = [];\n        var rowIdx;\n        var deferred = new Deferred();\n        var sRowIdx;\n        var sColIdx;\n        var loadedInfo;\n        args.promise = deferred.promise;\n        if (args.sheet && args.sheet.ranges.length) {\n            var _loop_1 = function (k) {\n                var sRange = args.indexes[0];\n                var eRange = args.indexes[2];\n                var range = args.sheet.ranges[k];\n                sRowIdx = getRangeIndexes(range.startCell)[0];\n                dataManager = range.dataSource instanceof DataManager ? range.dataSource\n                    : range.dataSource ? new DataManager(range.dataSource) : new DataManager();\n                remoteUrl = remoteUrl || dataManager.dataSource.url;\n                args.sheet.isLocalData = isLocal || !dataManager.dataSource.url;\n                if (sRowIdx <= sRange) {\n                    sRange = sRange - sRowIdx;\n                }\n                else {\n                    if (sRowIdx <= eRange) {\n                        eRange = eRange - sRowIdx;\n                        sRange = 0;\n                    }\n                    else {\n                        sRange = -1;\n                    }\n                }\n                if (range.showFieldAsHeader && sRange !== 0) {\n                    sRange -= 1;\n                }\n                var isEndReached = false;\n                var insertRowCount = 0;\n                this_1.initRangeInfo(range);\n                var count = this_1.getMaxCount(range);\n                loadedInfo = this_1.getLoadedInfo(sRange, eRange, range);\n                sRange = loadedInfo.unloadedRange[0];\n                eRange = loadedInfo.unloadedRange[1];\n                if (range.info.insertRowRange) {\n                    range.info.insertRowRange.forEach(function (range) {\n                        insertRowCount += ((range[1] - range[0]) + 1);\n                    });\n                    sRange -= insertRowCount;\n                    eRange -= insertRowCount;\n                }\n                if (sRange > count) {\n                    isEndReached = true;\n                }\n                else if (eRange > count) {\n                    eRange = count;\n                }\n                this_1.requestedInfo.push({ deferred: deferred, indexes: args.indexes, isNotLoaded: loadedInfo.isNotLoaded });\n                if (sRange >= 0 && loadedInfo.isNotLoaded && !isEndReached) {\n                    sRanges[k] = sRange;\n                    requestedRange[k] = false;\n                    var query = (range.query ? range.query : new Query()).clone();\n                    dataManager.executeQuery(query.range(sRange, eRange >= count ? eRange : eRange + 1)\n                        .requiresCount()).then(function (e) {\n                        if (!_this.parent || _this.parent.isDestroyed) {\n                            return;\n                        }\n                        result = (e.result && e.result.result ? e.result.result : e.result);\n                        sCellIdx = getRangeIndexes(range.startCell);\n                        sRowIdx = sCellIdx[0];\n                        sColIdx = sCellIdx[1];\n                        if (result.length) {\n                            if (!range.info.count) {\n                                count = e.count;\n                                range.info.count = e.count;\n                            }\n                            flds = Object.keys(result[0]);\n                            if (!range.info.fldLen) {\n                                range.info.fldLen = flds.length;\n                                range.info.flds = flds;\n                            }\n                            if (range.info.insertColumnRange) {\n                                var insertCount_1 = 0;\n                                range.info.insertColumnRange.forEach(function (insertRange) {\n                                    for (var i = insertRange[0]; i <= insertRange[1]; i++) {\n                                        i <= sColIdx ? flds.splice(0, 0, \"emptyCell\" + insertCount_1) : flds.splice(i - sColIdx, 0, \"emptyCell\" + insertCount_1);\n                                        insertCount_1++;\n                                    }\n                                });\n                            }\n                            if (sRanges[k] === 0 && range.showFieldAsHeader) {\n                                rowIdx = sRowIdx + sRanges[k] + insertRowCount;\n                                flds.forEach(function (field, i) {\n                                    cell = getCell(rowIdx, sColIdx + i, args.sheet, true);\n                                    if (!cell) {\n                                        args.sheet.rows[sRowIdx + sRanges[k]].cells[sColIdx + i] = field.includes('emptyCell') ? {}\n                                            : { value: field };\n                                    }\n                                    else if (!cell.value && !field.includes('emptyCell')) {\n                                        cell.value = field;\n                                    }\n                                });\n                            }\n                            result.forEach(function (item, i) {\n                                rowIdx = sRowIdx + sRanges[k] + i + (range.showFieldAsHeader ? 1 : 0) + insertRowCount;\n                                for (var j = 0; j < flds.length; j++) {\n                                    cell = getCell(rowIdx, sColIdx + j, args.sheet, true);\n                                    if (cell) {\n                                        if (!cell.value && !flds[j].includes('emptyCell')) {\n                                            setCell(rowIdx, sColIdx + j, args.sheet, _this.getCellDataFromProp(item[flds[j]]), true);\n                                        }\n                                    }\n                                    else {\n                                        args.sheet.rows[rowIdx].cells[sColIdx + j] =\n                                            flds[j].includes('emptyCell') ? {} : _this.getCellDataFromProp(item[flds[j]]);\n                                    }\n                                    _this.checkDataForFormat({\n                                        args: args, cell: cell, colIndex: sColIdx + j, rowIndex: rowIdx, i: i, j: j, k: k,\n                                        range: range, sRanges: sRanges, value: item[flds[j]]\n                                    });\n                                }\n                            });\n                        }\n                        else {\n                            flds = [];\n                        }\n                        args.sheet.usedRange.rowIndex = Math.max((sRowIdx + (count || e.count) + (range.showFieldAsHeader ? 1 : 0) + insertRowCount) - 1, args.sheet.usedRange.rowIndex);\n                        args.sheet.usedRange.colIndex = Math.max(sColIdx + flds.length - 1, args.sheet.usedRange.colIndex);\n                        if (insertRowCount) {\n                            loadedInfo = _this.getLoadedInfo(sRange, eRange, range);\n                            sRange = loadedInfo.unloadedRange[0];\n                            eRange = loadedInfo.unloadedRange[1];\n                            if (sRange > count) {\n                                loadedInfo.isNotLoaded = false;\n                            }\n                            if (loadedInfo.isNotLoaded) {\n                                if (eRange > count) {\n                                    eRange = count;\n                                }\n                                range.info.loadedRange.push([sRange, eRange]);\n                            }\n                        }\n                        else {\n                            range.info.loadedRange.push([sRange, eRange]);\n                        }\n                        requestedRange[k] = true;\n                        if (requestedRange.indexOf(false) === -1) {\n                            if (eRange + sRowIdx < sRowIdx + range.info.count) {\n                                if (!args.rangeSettingCount) {\n                                    args.rangeSettingCount = [];\n                                }\n                                args.rangeSettingCount.push(k);\n                                //if (remoteUrl) {\n                                var unloadedArgs = {\n                                    sheet: args.sheet, indexes: [0, 0, args.sheet.usedRange.rowIndex, args.sheet.usedRange.colIndex],\n                                    promise: new Promise(function (resolve, reject) { resolve((function () { })()); }),\n                                    rangeSettingCount: args.rangeSettingCount\n                                };\n                                _this.updateSheetFromDataSourceHandler(unloadedArgs);\n                                unloadedArgs.promise.then(function () {\n                                    if (_this.parent.getModuleName() === 'workbook') {\n                                        return;\n                                    }\n                                    args.rangeSettingCount.pop();\n                                    if (!args.rangeSettingCount.length) {\n                                        _this.parent.notify('created', null);\n                                    }\n                                });\n                                //}\n                            }\n                            _this.checkResolve(args.indexes);\n                        }\n                    });\n                }\n                else if (k === 0 && requestedRange.indexOf(false) === -1) {\n                    this_1.checkResolve(args.indexes);\n                }\n            };\n            var this_1 = this;\n            for (var k = args.sheet.ranges.length - 1; k >= 0; k--) {\n                _loop_1(k);\n            }\n        }\n        else {\n            deferred.resolve();\n        }\n    };\n    DataBind.prototype.checkResolve = function (indexes) {\n        var resolved;\n        var isSameRng;\n        var cnt = 0;\n        this.requestedInfo.forEach(function (info, idx) {\n            isSameRng = JSON.stringify(info.indexes) === JSON.stringify(indexes);\n            if (isSameRng || resolved) {\n                if (idx === 0) {\n                    info.deferred.resolve();\n                    cnt++;\n                    resolved = true;\n                }\n                else {\n                    if (resolved && (info.isLoaded || !info.isNotLoaded)) {\n                        info.deferred.resolve();\n                        cnt++;\n                    }\n                    else if (isSameRng && resolved) {\n                        info.deferred.resolve();\n                        cnt++;\n                    }\n                    else if (isSameRng) {\n                        info.isLoaded = true;\n                    }\n                    else {\n                        resolved = false;\n                    }\n                }\n            }\n        });\n        this.requestedInfo.splice(0, cnt);\n    };\n    DataBind.prototype.getCellDataFromProp = function (prop) {\n        var data = {};\n        if (Object.prototype.toString.call(prop) === '[object Object]') {\n            if (prop.formula) {\n                data.formula = prop.formula;\n            }\n            else if (prop.value) {\n                if (typeof (prop.value) === 'string') {\n                    if (prop.value.indexOf('http://') === 0 || prop.value.indexOf('https://') === 0 ||\n                        prop.value.indexOf('ftp://') === 0 || prop.value.indexOf('www.') === 0) {\n                        data.hyperlink = prop.value;\n                    }\n                    else {\n                        data.value = prop.value;\n                    }\n                }\n                else {\n                    data.value = prop.value;\n                }\n            }\n        }\n        else {\n            if (checkIsFormula(prop)) {\n                data.formula = prop;\n            }\n            else {\n                if (typeof (prop) === 'string') {\n                    if (prop.indexOf('http://') === 0 || prop.indexOf('https://') === 0 ||\n                        prop.indexOf('ftp://') === 0 || prop.indexOf('www.') === 0) {\n                        data.hyperlink = prop;\n                    }\n                    else {\n                        data.value = prop;\n                    }\n                }\n                else {\n                    data.value = prop;\n                }\n            }\n        }\n        return data;\n    };\n    DataBind.prototype.checkDataForFormat = function (args) {\n        if (args.value !== '') {\n            var dateEventArgs = {\n                value: args.value,\n                rowIndex: args.rowIndex,\n                colIndex: args.colIndex,\n                isDate: false,\n                updatedVal: args.value,\n                isTime: false\n            };\n            this.parent.notify(checkDateFormat, dateEventArgs);\n            if (dateEventArgs.isDate) {\n                if (args.cell) {\n                    args.cell.format = getFormatFromType('ShortDate');\n                    args.cell.value = dateEventArgs.updatedVal;\n                }\n                else {\n                    args.args.sheet.rows[args.rowIndex]\n                        .cells[args.colIndex].format = getFormatFromType('ShortDate');\n                    args.args.sheet.rows[args.rowIndex]\n                        .cells[args.colIndex].value = dateEventArgs.updatedVal;\n                }\n            }\n            else if (dateEventArgs.isTime) {\n                if (args.cell) {\n                    args.cell.format = getFormatFromType('Time');\n                    args.cell.value = dateEventArgs.updatedVal;\n                }\n                else {\n                    args.args.sheet.rows[args.rowIndex]\n                        .cells[args.colIndex].format = getFormatFromType('Time');\n                    args.args.sheet.rows[args.rowIndex]\n                        .cells[args.colIndex].value = dateEventArgs.updatedVal;\n                }\n            }\n        }\n    };\n    DataBind.prototype.getLoadedInfo = function (sRange, eRange, range) {\n        var isNotLoaded = true;\n        range.info.loadedRange.forEach(function (range) {\n            if (range[0] <= sRange && sRange <= range[1]) {\n                if (range[0] <= eRange && eRange <= range[1]) {\n                    isNotLoaded = false;\n                }\n                else {\n                    sRange = range[1] + 1;\n                }\n            }\n            else if (range[0] <= eRange && eRange <= range[1]) {\n                eRange = range[0] - 1;\n            }\n        });\n        return { isNotLoaded: isNotLoaded, unloadedRange: [sRange, eRange] };\n    };\n    DataBind.prototype.getMaxCount = function (range) {\n        if (range.query) {\n            var query = range.query.queries;\n            for (var i = 0; i < query.length; i++) {\n                if (query[i].fn === 'onTake') {\n                    return Math.min(query[i].e.nos, range.info.count || query[i].e.nos);\n                }\n            }\n        }\n        return range.info.count;\n    };\n    DataBind.prototype.initRangeInfo = function (range) {\n        if (!range.info) {\n            range.info = { loadedRange: [] };\n        }\n    };\n    /**\n     * Remove old data from sheet.\n     */\n    DataBind.prototype.dataSourceChangedHandler = function (args) {\n        var _this = this;\n        var row;\n        var sheet = this.parent.sheets[args.sheetIdx];\n        var range = sheet.ranges[args.rangeIdx];\n        if (range && (this.checkRangeHasChanges(sheet, args.rangeIdx) || !range.info)) {\n            var showFieldAsHeader_1 = range.showFieldAsHeader;\n            var indexes_1 = getCellIndexes(range.startCell);\n            if (range.info) {\n                range.info.loadedRange.forEach(function (loadedRange) {\n                    for (var i = loadedRange[0]; i <= loadedRange[1] && (i < range.info.count + (showFieldAsHeader_1 ? 1 : 0)); i++) {\n                        row = sheet.rows[i + indexes_1[0]];\n                        if (row) {\n                            for (var j = indexes_1[1]; j < indexes_1[1] + range.info.fldLen; j++) {\n                                if (row.cells && row.cells[j]) {\n                                    delete row.cells[j];\n                                }\n                            }\n                        }\n                    }\n                });\n                range.info = null;\n            }\n            var viewport = this.parent.viewport;\n            var refreshRange_1 = [viewport.topIndex, viewport.leftIndex, viewport.bottomIndex, viewport.rightIndex];\n            var args_1 = {\n                sheet: sheet, indexes: refreshRange_1, promise: new Promise(function (resolve, reject) { resolve((function () { })()); })\n            };\n            this.updateSheetFromDataSourceHandler(args_1);\n            args_1.promise.then(function () {\n                _this.parent.notify('updateView', { indexes: refreshRange_1 });\n            });\n        }\n    };\n    DataBind.prototype.checkRangeHasChanges = function (sheet, rangeIdx) {\n        if (this.parent.isAngular) {\n            var changedRangeIdx = 'changedRangeIdx';\n            if (sheet[changedRangeIdx] === parseInt(rangeIdx, 10)) {\n                delete sheet[changedRangeIdx];\n                return true;\n            }\n            return false;\n        }\n        else {\n            return true;\n        }\n    };\n    /**\n     * Triggers dataSourceChange event when cell data changes\n     */\n    DataBind.prototype.dataChangedHandler = function (args) {\n        var _this = this;\n        var changedData = [{}];\n        var action;\n        var cell;\n        var dataRange;\n        var startCell;\n        var inRange;\n        var deleteRowDetails;\n        var sheetIdx = this.parent.activeSheetIndex;\n        var sheet = this.parent.sheets[sheetIdx];\n        var cellIndices;\n        sheet.ranges.forEach(function (range, idx) {\n            if (range.dataSource) {\n                var isNewRow = void 0;\n                startCell = getCellIndexes(range.startCell);\n                dataRange = startCell.concat([startCell[0] + range.info.count + (range.showFieldAsHeader ? 0 : -1),\n                    startCell[1] + range.info.fldLen - 1]);\n                if (args.modelType === 'Row') {\n                    if (args.insertType) {\n                        inRange = ((!range.showFieldAsHeader && args.insertType === 'above') ? dataRange[0] <= args.index\n                            : dataRange[0] < args.index) && dataRange[2] >= args.index;\n                        cellIndices = [args.index];\n                        if (!inRange) {\n                            if ((dataRange[2] + 1 === args.index && args.insertType === 'below')) {\n                                isNewRow = true;\n                                range.info.count += args.model.length;\n                            }\n                            else if (dataRange[0] >= args.index) {\n                                range.startCell = getCellAddress(startCell[0] + args.model.length, startCell[1]);\n                            }\n                        }\n                        else {\n                            isNewRow = true;\n                            range.info.count += args.model.length;\n                        }\n                    }\n                    else {\n                        inRange = dataRange[0] <= args.startIndex && dataRange[2] >= args.startIndex;\n                        action = 'delete';\n                    }\n                }\n                else {\n                    cellIndices = getCellIndexes(args.sheetIdx > -1 ? args.address : args.address.split('!')[1]);\n                    inRange = ((range.showFieldAsHeader ? dataRange[0] + 1 : dataRange[0]) <= cellIndices[0])\n                        && dataRange[2] >= cellIndices[0] && dataRange[1] <= cellIndices[1] && dataRange[3] >= cellIndices[1];\n                }\n                if (inRange || isNewRow) {\n                    if (args.modelType === 'Row' && !args.insertType) {\n                        args.deletedModel.forEach(function (row, rowIdx) {\n                            changedData[rowIdx] = {};\n                            range.info.flds.forEach(function (fld, idx) {\n                                if (row.cells) {\n                                    cell = row.cells[startCell[1] + idx];\n                                    changedData[rowIdx][fld] = (cell && cell.value) || null;\n                                }\n                                else {\n                                    changedData[rowIdx][fld] = null;\n                                }\n                            });\n                            range.info.count -= 1;\n                        });\n                        deleteRowDetails = { count: args.deletedModel.length, index: args.endIndex };\n                    }\n                    else {\n                        action = isNewRow ? 'add' : 'edit';\n                        var _loop_2 = function (i) {\n                            changedData[i] = {};\n                            range.info.flds.forEach(function (fld, idx) {\n                                cell = getCell(cellIndices[0], startCell[1] + idx, sheet);\n                                changedData[i][fld] = (cell && cell.value) || null;\n                            });\n                        };\n                        for (var i = 0; i < (isNewRow ? args.model.length : 1); i++) {\n                            _loop_2(i);\n                        }\n                    }\n                    _this.parent.trigger('dataSourceChanged', { data: changedData, action: action, rangeIndex: idx, sheetIndex: sheetIdx });\n                }\n                else if (deleteRowDetails && deleteRowDetails.count && dataRange[0] > deleteRowDetails.index) {\n                    range.startCell = getCellAddress(startCell[0] - deleteRowDetails.count, startCell[1]);\n                }\n            }\n        });\n    };\n    /**\n     * For internal use only - Get the module name.\n     * @private\n     */\n    DataBind.prototype.getModuleName = function () {\n        return 'dataBind';\n    };\n    /**\n     * Destroys the Data binding module.\n     * @return {void}\n     */\n    DataBind.prototype.destroy = function () {\n        this.removeEventListener();\n        this.parent = null;\n        this.requestedInfo = [];\n    };\n    return DataBind;\n}());\nexport { DataBind };\n","/**\n * Specifies spreadsheet internal events\n */\n/** @hidden */\nexport var ribbon = 'ribbon';\n/** @hidden */\nexport var formulaBar = 'formulaBar';\n/** @hidden */\nexport var sheetTabs = 'sheetTabs';\n/** @hidden */\nexport var refreshSheetTabs = 'refreshSheetTabs';\n/** @hidden */\nexport var isFormulaBarEdit = 'isFormulaBarEdit';\n/** @hidden */\nexport var dataRefresh = 'dataRefresh';\n/** @hidden */\nexport var initialLoad = 'initialLoad';\n/** @hidden */\nexport var contentLoaded = 'contentLoaded';\n/** @hidden */\nexport var mouseDown = 'mouseDown';\n/** @hidden */\nexport var spreadsheetDestroyed = 'spreadsheetDestroyed';\n/** @hidden */\nexport var editOperation = 'editOperation';\n/** @hidden */\nexport var formulaOperation = 'formulaOperation';\n/** @hidden */\nexport var formulaBarOperation = 'formulaBarOperation';\n/** @hidden */\nexport var click = 'click';\n/** @hidden */\nexport var keyUp = 'keyUp';\n/** @hidden */\nexport var keyDown = 'keyDown';\n/** @hidden */\nexport var formulaKeyUp = 'formulaKeyUp';\n/** @hidden */\nexport var formulaBarUpdate = 'formulaBarUpdate';\n/** @hidden */\nexport var onVerticalScroll = 'verticalScroll';\n/** @hidden */\nexport var onHorizontalScroll = 'horizontalScroll';\n/** @hidden */\nexport var beforeContentLoaded = 'beforeContentLoaded';\n/** @hidden */\nexport var beforeVirtualContentLoaded = 'beforeVirtualContentLoaded';\n/** @hidden */\nexport var virtualContentLoaded = 'virtualContentLoaded';\n/** @hidden */\nexport var contextMenuOpen = 'contextMenuOpen';\n/** @hidden */\nexport var cellNavigate = 'cellNavigate';\n/** @hidden */\nexport var mouseUpAfterSelection = 'mouseUpAfterSelection';\n/** @hidden */\nexport var selectionComplete = 'selectionComplete';\n/** @hidden */\nexport var cMenuBeforeOpen = 'contextmenuBeforeOpen';\n/** @hidden */\nexport var insertSheetTab = 'insertSheetTab';\n/** @hidden */\nexport var removeSheetTab = 'removeSheetTab';\n/** @hidden */\nexport var renameSheetTab = 'renameSheetTab';\n/** @hidden */\nexport var ribbonClick = 'ribboClick';\n/** @hidden */\nexport var refreshRibbon = 'ribbonRefresh';\n/** @hidden */\nexport var enableToolbarItems = 'enableToolbarItems';\n/** @hidden */\nexport var tabSwitch = 'tabSwitch';\n/** @hidden */\nexport var selectRange = 'selectRange';\n/** @hidden */\nexport var cut = 'cut';\n/** @hidden */\nexport var copy = 'copy';\n/** @hidden */\nexport var paste = 'paste';\n/** @hidden */\nexport var clearCopy = 'clearCopy';\n/** @hidden */\nexport var dataBound = 'dataBound';\n/** @hidden */\nexport var beforeDataBound = 'beforeDataBound';\n/** @hidden */\nexport var addContextMenuItems = 'addContextMenuItems';\n/** @hidden */\nexport var removeContextMenuItems = 'removeContextMenuItems';\n/** @hidden */\nexport var enableContextMenuItems = 'enableContextMenuItems';\n/** @hidden */\nexport var enableFileMenuItems = 'enableFileMenuItems';\n/** @hidden */\nexport var hideFileMenuItems = 'hideFileMenuItems';\n/** @hidden */\nexport var addFileMenuItems = 'addFileMenuItems';\n/** @hidden */\nexport var hideRibbonTabs = 'hideRibbonTabs';\n/** @hidden */\nexport var enableRibbonTabs = 'enableRibbonTabs';\n/** @hidden */\nexport var addRibbonTabs = 'addRibbonTabs';\n/** @hidden */\nexport var addToolbarItems = 'addToolbarItems';\n/** @hidden */\nexport var hideToolbarItems = 'hideToolbarItems';\n/** @hidden */\nexport var beforeRibbonCreate = 'beforeRibbonCreate';\n/** @hidden */\nexport var rowHeightChanged = 'rowHeightChanged';\n/** @hidden */\nexport var colWidthChanged = 'colWidthChanged';\n/** @hidden */\nexport var beforeHeaderLoaded = 'beforeHeaderLoaded';\n/** @hidden */\nexport var onContentScroll = 'onContentScroll';\n/** @hidden */\nexport var deInitProperties = 'deInitProperties';\n/** @hidden */\nexport var activeSheetChanged = 'activeSheetChanged';\n/** @hidden */\nexport var renameSheet = 'renameSheet';\n/** @hidden */\nexport var initiateCustomSort = 'initiateCustomSort';\n/** @hidden */\nexport var applySort = 'applySort';\n/** @hidden */\nexport var collaborativeUpdate = 'collaborativeUpdate';\n/** @hidden */\nexport var hideShow = 'hideShow';\n/** @hidden */\nexport var autoFit = 'autoFitRowsColumns';\n/** @hidden */\nexport var updateToggleItem = 'updateToggleItem';\n/** @hidden */\nexport var initiateHyperlink = 'initiateHyperlink';\n/** @hidden */\nexport var editHyperlink = 'editHyperlink';\n/** @hidden */\nexport var openHyperlink = 'openHyperlink';\n/** @hidden */\nexport var removeHyperlink = 'removeHyperlink';\n/** @hidden */\nexport var createHyperlinkElement = 'createHyperlinkElement';\n/** @hidden */\nexport var sheetNameUpdate = 'sheetNameUpdate';\n/** @hidden */\nexport var hideSheet = 'hideSheet';\n/** @hidden */\nexport var performUndoRedo = 'performUndoRedo';\n/** @hidden */\nexport var updateUndoRedoCollection = 'updateUndoRedoCollection';\n/** @hidden */\nexport var setActionData = 'setActionData';\n/** @hidden */\nexport var getBeforeActionData = 'getBeforeActionData';\n/** @hidden */\nexport var clearUndoRedoCollection = 'clearUndoRedoCollection';\n/** @hidden */\nexport var initiateFilterUI = 'initiateFilterUI';\n/** @hidden */\nexport var renderFilterCell = 'renderFilterCell';\n/** @hidden */\nexport var reapplyFilter = 'reapplyFilter';\n/** @hidden */\nexport var filterByCellValue = 'filterByCellValue';\n/** @hidden */\nexport var clearFilter = 'clearFilter';\n/** @hidden */\nexport var getFilteredColumn = 'getFilteredColumn';\n/** @hidden */\nexport var completeAction = 'actionComplete';\n/** @hidden */\nexport var beginAction = 'actionBegin';\n/** @hidden */\nexport var filterCellKeyDown = 'filterCellKeyDown';\n/** @hidden */\nexport var getFilterRange = 'getFilterRange';\n/** @hidden */\nexport var setAutoFit = 'setAutoFit';\n/** @hidden */\nexport var refreshFormulaDatasource = 'refreshFormulaDatasource';\n/** @hidden */\nexport var setScrollEvent = 'setScrollEvent';\n/** @hidden */\nexport var initiateDataValidation = 'initiatedatavalidation';\n/** @hidden */\nexport var validationError = 'validationError';\n/** @hidden */\nexport var startEdit = 'startEdit';\n/** @hidden */\nexport var invalidData = 'invalidData';\n/** @hidden */\nexport var clearInvalid = 'clearInvalid';\n/** @hidden */\nexport var protectSheet = 'protectSheet';\n/** @hidden */\nexport var applyProtect = 'applyProtect';\n/** @hidden */\nexport var unprotectSheet = 'unprotectSheet';\n/** @hidden */\nexport var protectCellFormat = 'protectCellFormat';\n/** @hidden */\nexport var gotoDlg = 'renderGotoDlgt';\n/** @hidden */\nexport var findDlg = 'renderFindDlg';\n/** @hidden */\nexport var findHandler = 'findHandler';\n/** @hidden */\nexport var replace = 'replaceHandler';\n/** @hidden */\nexport var created = 'created';\n/** @hidden */\nexport var editAlert = 'editAlert';\n/** @hidden */\nexport var setUndoRedo = 'setUndoRedo';\n/** @hidden */\nexport var enableFormulaInput = 'enableFormulaInput';\n/** @hidden */\nexport var protectSelection = 'protectSelection';\n/** @hidden */\nexport var hiddenMerge = 'hiddenMerge';\n/** @hidden */\nexport var checkPrevMerge = 'checkPrevMerge';\n/** @hidden */\nexport var checkMerge = 'checkMerge';\n/** @hidden */\nexport var removeDataValidation = 'removeDataValidation';\n/** @hidden */\nexport var showAggregate = 'showAggregate';\n/** @hidden */\nexport var initiateConditionalFormat = 'initiateConditionalFormat';\n/** @hidden */\nexport var checkConditionalFormat = 'checkConditionalFormat';\n/** @hidden */\nexport var setCF = 'setCF';\n/** @hidden */\nexport var clearViewer = 'clearViewer';\n/** @hidden */\nexport var initiateFormulaReference = 'initiateFormulaReference';\n/** @hidden */\nexport var initiateCur = 'initiateCur';\n/** @hidden */\nexport var clearCellRef = 'clearCellRef';\n/** @hidden */\nexport var editValue = 'editValue';\n/** @hidden */\nexport var addressHandle = 'addressHandle';\n/** @hidden */\nexport var initiateEdit = 'initiateEdit';\n/** @hidden */\nexport var forRefSelRender = 'forRefSelRender';\nexport var blankWorkbook = 'blankWorkbook';\n/** @hidden */\nexport var insertImage = 'insertImage';\n/** @hidden */\nexport var refreshImgElem = 'refreshImgElem';\n/** @hidden */\nexport var refreshImgCellObj = 'refreshImgCellObj';\n/** @hidden */\nexport var getRowIdxFromClientY = 'getRowIdxFromClientY';\n/** @hidden */\nexport var getColIdxFromClientX = 'getColIdxFromClientX';\n/** @hidden */\nexport var createImageElement = 'createImageElement';\n/** @hidden */\nexport var deleteImage = 'deleteImage';\n/** @hidden */\nexport var deleteChart = 'deleteChart';\n/** @hidden */\nexport var refreshChartCellObj = 'refreshChartCellObj';\n/** @hidden */\nexport var refreshImagePosition = 'refreshImagePosition';\n/** @hidden */\nexport var updateTableWidth = 'updateTableWidth';\n/** @hidden */\nexport var focusBorder = 'focusBorder';\n/** @hidden */\nexport var clearChartBorder = 'clearChartBorder';\n/** @hidden */\nexport var insertChart = 'insertChart';\n/** @hidden */\nexport var chartRangeSelection = 'chartRangeSelection';\n/** @hidden */\nexport var isReact = 'isReact';\n/** @hidden */\nexport var renderReactTemplates = 'renderReactTemplates';\n/** @hidden */\nexport var clearTemplate = 'clearTemplate';\n","/**\n * Open properties.\n */\nimport { isUndefined } from '@syncfusion/ej2-base';\nimport { workbookOpen, openSuccess, openFailure, sheetsDestroyed, workbookFormulaOperation, getRangeIndexes } from '../common/index';\nimport { sheetCreated, protectSheetWorkBook, getRangeAddress } from '../common/index';\nimport { initSheet } from '../base/index';\nimport { beginAction } from '../../spreadsheet/common/event';\nvar WorkbookOpen = /** @class */ (function () {\n    function WorkbookOpen(parent) {\n        this.parent = parent;\n        this.addEventListener();\n    }\n    /**\n     * To open the excel file stream or excel url into the spreadsheet.\n     * @param {OpenOptions} options - Options to open a excel file.\n     */\n    WorkbookOpen.prototype.open = function (options) {\n        var _this = this;\n        if (!this.parent.allowOpen) {\n            return;\n        }\n        /* tslint:disable-next-line:no-any */\n        if (options.jsonObject) {\n            /* tslint:disable-next-line:no-any */\n            this.fetchSuccess(options.jsonObject);\n            return;\n        }\n        var formData = new FormData();\n        if (options.file) {\n            formData.append('file', options.file);\n        }\n        else {\n            this.parent.isOpen = false;\n            return;\n        }\n        var eventArgs = {\n            file: options.file || null,\n            cancel: false,\n            requestData: {\n                method: 'POST',\n                body: formData\n            }\n        };\n        this.parent.trigger('beforeOpen', eventArgs);\n        this.parent.notify(beginAction, { eventArgs: eventArgs, action: 'beforeOpen' });\n        if (eventArgs.cancel) {\n            return;\n        }\n        fetch(this.parent.openUrl, eventArgs.requestData)\n            .then(function (response) {\n            if (response.ok) {\n                return response.json();\n            }\n            else {\n                return Promise.reject({\n                    status: response.status,\n                    statusText: response.statusText,\n                    url: response.url\n                });\n            }\n        })\n            .then(function (data) { return _this.fetchSuccess(data); })\n            .catch(function (error) { return _this.fetchFailure(error); });\n    };\n    WorkbookOpen.prototype.fetchFailure = function (error) {\n        if (isUndefined(error.status) && isUndefined(error.statusText)) {\n            error.statusText = 'Improper response';\n        }\n        this.parent.notify(openFailure, error);\n        this.parent.isOpen = false;\n    };\n    WorkbookOpen.prototype.fetchSuccess = function (data) {\n        var openError = ['UnsupportedFile', 'InvalidUrl'];\n        var workbookData = data;\n        workbookData = (typeof data === 'string') ? JSON.parse(data) : data;\n        /* tslint:disable-next-line:no-any */\n        var impData = workbookData.Workbook;\n        if (openError.indexOf(impData) > -1) {\n            this.parent.notify(openSuccess, {\n                context: this, data: impData\n            });\n            return;\n        }\n        this.updateModel(impData);\n        this.parent.notify(openSuccess, {\n            context: this, data: impData\n        });\n        this.parent.isOpen = false;\n    };\n    WorkbookOpen.prototype.updateModel = function (workbookModel) {\n        this.parent.notify(workbookFormulaOperation, { action: 'unRegisterSheet' });\n        this.parent.sheetNameCount = 1;\n        this.parent.sheets = [];\n        this.parent.notify(sheetsDestroyed, {});\n        workbookModel.activeSheetIndex = workbookModel.activeSheetIndex || 0;\n        this.setSelectAllRange(workbookModel.sheets);\n        this.parent.setProperties({\n            'sheets': workbookModel.sheets,\n            'activeSheetIndex': workbookModel.activeSheetIndex,\n            'definedNames': workbookModel.definedNames || []\n        }, true);\n        initSheet(this.parent);\n        this.parent.notify(sheetCreated, null);\n        this.parent.notify(workbookFormulaOperation, { action: 'registerSheet', isImport: true });\n        this.parent.notify(workbookFormulaOperation, { action: 'initiateDefinedNames' });\n        this.parent.notify(protectSheetWorkBook, null);\n    };\n    WorkbookOpen.prototype.setSelectAllRange = function (sheets) {\n        sheets.forEach(function (sheet) {\n            if (sheet.selectedRange) {\n                var selectedIndex = getRangeIndexes(sheet.selectedRange);\n                var rowCount = (isUndefined(sheet.rowCount) ? 100 : sheet.rowCount) - 1;\n                var colCount = (isUndefined(sheet.colCount) ? 100 : sheet.colCount) - 1;\n                if (selectedIndex[2] === 65535) {\n                    selectedIndex[2] = rowCount;\n                }\n                if (selectedIndex[3] === 255) {\n                    selectedIndex[3] = colCount;\n                }\n                if (selectedIndex[0] === 65535) {\n                    selectedIndex[0] = rowCount;\n                }\n                if (selectedIndex[1] === 255) {\n                    selectedIndex[1] = colCount;\n                }\n                sheet.selectedRange = getRangeAddress(selectedIndex);\n            }\n        });\n    };\n    /**\n     * Adding event listener for workbook open.\n     */\n    WorkbookOpen.prototype.addEventListener = function () {\n        this.parent.on(workbookOpen, this.open.bind(this));\n    };\n    /**\n     * Removing event listener workbook open.\n     */\n    WorkbookOpen.prototype.removeEventListener = function () {\n        if (!this.parent.isDestroyed) {\n            this.parent.off(workbookOpen, this.open.bind(this));\n        }\n    };\n    /**\n     * To Remove the event listeners\n     */\n    WorkbookOpen.prototype.destroy = function () {\n        this.removeEventListener();\n        this.parent = null;\n    };\n    /**\n     * Get the workbook open module name.\n     */\n    WorkbookOpen.prototype.getModuleName = function () {\n        return 'workbookOpen';\n    };\n    return WorkbookOpen;\n}());\nexport { WorkbookOpen };\n","/**\n * @hidden\n * The `SaveWorker` module is used to perform save functionality with Web Worker.\n */\nvar SaveWorker = /** @class */ (function () {\n    /**\n     * Constructor for SaveWorker module in Workbook library.\n     * @private\n     */\n    function SaveWorker(parent) {\n        this.parent = parent;\n    }\n    /**\n     * Process sheet.\n     * @hidden\n     */\n    SaveWorker.prototype.processSheet = function (sheet, sheetIndex) {\n        var parsedSheet = JSON.parse(sheet, function (key, value) {\n            //Remove empty properties\n            if ((Array.isArray(value) || typeof value === 'string') && !value.length) {\n                return undefined;\n            }\n            return value;\n        });\n        return [sheetIndex, parsedSheet];\n    };\n    /**\n     * Process save action.\n     * @hidden\n     */\n    SaveWorker.prototype.processSave = function (saveJSON, saveSettings, customParams) {\n        var formData = new FormData();\n        var i;\n        var keys = Object.keys(saveSettings);\n        formData.append('JSONData', JSON.stringify(saveJSON));\n        for (i = 0; i < keys.length; i++) {\n            formData.append(keys[i], saveSettings[keys[i]]);\n        }\n        keys = Object.keys(customParams);\n        for (i = 0; i < keys.length; i++) {\n            formData.append(keys[i], customParams[keys[i]]);\n        }\n        fetch(saveSettings.url, { method: 'POST', body: formData })\n            .then(function (response) {\n            if (response.ok) {\n                return response.blob();\n            }\n            else {\n                return Promise.reject({\n                    message: response.statusText\n                });\n            }\n        })\n            .then(function (data) {\n            new Promise(function (resolve) {\n                var reader = new FileReader();\n                reader.onload = function () {\n                    if (reader.result.toString().indexOf('data:text/plain;base64,') > -1) {\n                        var str = atob(reader.result.replace('data:text/plain;base64,', '')).split(/(\\r\\n|\\n|\\r)/gm);\n                        if (str.length) {\n                            postMessage({ dialog: str[0] });\n                        }\n                    }\n                    else {\n                        postMessage(data);\n                    }\n                    resolve(reader.result);\n                };\n                reader.readAsDataURL(data);\n            });\n        })\n            .catch(function (error) {\n            postMessage({ error: error.message });\n        });\n        // try {\n        //     let httpRequest: XMLHttpRequest = new XMLHttpRequest();\n        //     let formData: FormData = new FormData();\n        //     let i: number;\n        //     let keys: string[] = Object.keys(saveSettings);\n        //     httpRequest.onreadystatechange = (event: Event) => {\n        //         if (httpRequest.readyState === 4 && httpRequest.status === 200) {\n        //             (postMessage as Function)(httpRequest.response);\n        //         }\n        //     };\n        //     httpRequest.onerror = (event: Event) => {\n        //         (postMessage as Function)(event);\n        //     };\n        //     formData.append('JSONData', JSON.stringify(saveJSON));\n        //     for (i = 0; i < keys.length; i++) {\n        //         formData.append(keys[i], (<{ [key: string]: string }>saveSettings)[keys[i]]);\n        //     }\n        //     httpRequest.open('POST', saveSettings.saveUrl, false);\n        //     httpRequest.send(formData);\n        // } catch (e) {\n        //     (postMessage as Function)({ error: e.message });\n        // }\n    };\n    return SaveWorker;\n}());\nexport { SaveWorker };\n","var __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    }\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nimport { executeTaskAsync } from '../common/worker';\nimport * as events from '../common/event';\nimport { SaveWorker } from '../workers/save-worker';\nimport { detach } from '@syncfusion/ej2-base';\n/**\n * @hidden\n * The `WorkbookSave` module is used to handle the save action in Workbook library.\n */\nvar WorkbookSave = /** @class */ (function (_super) {\n    __extends(WorkbookSave, _super);\n    /**\n     * Constructor for WorkbookSave module in Workbook library.\n     * @private\n     */\n    function WorkbookSave(parent) {\n        var _this = _super.call(this, parent) || this;\n        _this.isProcessCompleted = false;\n        _this.saveJSON = {};\n        _this.isFullPost = false;\n        _this.needBlobData = false;\n        _this.customParams = null;\n        _this.addEventListener();\n        return _this;\n    }\n    /**\n     * Get the module name.\n     * @returns string\n     * @private\n     */\n    WorkbookSave.prototype.getModuleName = function () {\n        return 'workbookSave';\n    };\n    /**\n     * To destroy the WorkbookSave module.\n     * @return {void}\n     * @hidden\n     */\n    WorkbookSave.prototype.destroy = function () {\n        this.removeEventListener();\n        this.parent = null;\n    };\n    /**\n     * @hidden\n     */\n    WorkbookSave.prototype.addEventListener = function () {\n        this.parent.on(events.beginSave, this.initiateSave, this);\n    };\n    /**\n     * @hidden\n     */\n    WorkbookSave.prototype.removeEventListener = function () {\n        if (!this.parent.isDestroyed) {\n            this.parent.off(events.beginSave, this.initiateSave);\n        }\n    };\n    /**\n     * Initiate save process.\n     * @hidden\n     */\n    WorkbookSave.prototype.initiateSave = function (args) {\n        var saveSettings = args.saveSettings;\n        this.saveSettings = {\n            saveType: saveSettings.saveType,\n            url: saveSettings.url,\n            fileName: saveSettings.fileName || 'Sample'\n        };\n        this.isFullPost = args.isFullPost;\n        this.needBlobData = args.needBlobData;\n        if (this.needBlobData) {\n            this.isFullPost = false;\n        }\n        this.customParams = args.customParams;\n        this.updateBasicSettings();\n        this.processSheets();\n    };\n    /**\n     * Update save JSON with basic settings.\n     * @hidden\n     */\n    WorkbookSave.prototype.updateBasicSettings = function () {\n        var jsonStr = this.getStringifyObject(this.parent, ['sheets', '_isScalar', 'observers', 'closed', 'isStopped', 'hasError',\n            '__isAsync', 'beforeCellFormat', 'beforeCellRender', 'beforeDataBound', 'beforeOpen', 'beforeSave', 'beforeSelect',\n            'beforeSort', 'cellEdit', 'cellEditing', 'cellSave', 'beforeCellSave', 'contextMenuItemSelect', 'contextMenuBeforeClose',\n            'contextMenuBeforeOpen', 'created', 'dataBound', 'fileMenuItemSelect', 'fileMenuBeforeClose', 'fileMenuBeforeOpen',\n            'saveComplete', 'sortComplete', 'select', 'actionBegin', 'actionComplete', 'afterHyperlinkClick', 'afterHyperlinkCreate',\n            'beforeHyperlinkClick', 'beforeHyperlinkCreate', 'openComplete', 'openFailure', 'queryCellInfo', 'dialogBeforeOpen',\n            'dataSourceChanged']);\n        var basicSettings = JSON.parse(jsonStr);\n        var sheetCount = this.parent.sheets.length;\n        var i = 0;\n        if (sheetCount) {\n            basicSettings.sheets = [];\n        }\n        this.saveJSON = basicSettings;\n    };\n    /**\n     * Process sheets properties.\n     * @hidden\n     */\n    WorkbookSave.prototype.processSheets = function () {\n        var i = 0;\n        var sheetCount = this.parent.sheets.length;\n        while (i < sheetCount) {\n            executeTaskAsync(this, this.processSheet, this.updateSheet, [this.getStringifyObject(this.parent.sheets[i]), i]);\n            i++;\n        }\n    };\n    /**\n     * Update processed sheet data.\n     * @hidden\n     */\n    WorkbookSave.prototype.updateSheet = function (data) {\n        this.saveJSON.sheets[data[0]] = data[1];\n        this.isProcessCompleted = this.getSheetLength(this.saveJSON.sheets) === this.parent.sheets.length;\n        if (this.isProcessCompleted) {\n            this.save(this.saveSettings);\n        }\n    };\n    WorkbookSave.prototype.getSheetLength = function (sheets) {\n        var len = 0;\n        sheets.forEach(function (sheet) {\n            if (sheet) {\n                len++;\n            }\n        });\n        return len;\n    };\n    /**\n     * Save process.\n     * @hidden\n     */\n    WorkbookSave.prototype.save = function (saveSettings) {\n        var args = { cancel: false, jsonObject: this.saveJSON };\n        this.parent.notify(events.onSave, args);\n        if (!args.cancel) {\n            if (this.isFullPost) {\n                this.initiateFullPostSave();\n            }\n            else {\n                executeTaskAsync(this, { 'workerTask': this.processSave }, this.updateSaveResult, [this.saveJSON, saveSettings, this.customParams], true);\n            }\n        }\n        this.saveJSON = {};\n    };\n    /**\n     * Update final save data.\n     * @hidden\n     */\n    WorkbookSave.prototype.updateSaveResult = function (result) {\n        var args = {\n            status: 'Success',\n            message: '',\n            url: this.saveSettings.url,\n            fileName: this.saveSettings.fileName,\n            saveType: this.saveSettings.saveType,\n            blobData: null\n        };\n        if (typeof (result) === 'object' && result.error) {\n            args.status = 'Failure';\n            args.message = result.error.toString();\n        }\n        else if (typeof (result) === 'object' && result.dialog) {\n            this.parent.notify(events.saveError, { content: result.dialog });\n        }\n        else {\n            if (this.needBlobData) {\n                args.blobData = result;\n            }\n            else {\n                this.ClientFileDownload(result, this.saveSettings.fileName);\n            }\n        }\n        this.parent.trigger('saveComplete', args);\n        this.parent.notify(events.saveCompleted, args);\n    };\n    WorkbookSave.prototype.ClientFileDownload = function (blobData, fileName) {\n        var anchor = this.parent.createElement('a', { attrs: { download: this.getFileNameWithExtension() } });\n        var url = URL.createObjectURL(blobData);\n        anchor.href = url;\n        document.body.appendChild(anchor);\n        anchor.click();\n        URL.revokeObjectURL(url);\n        document.body.removeChild(anchor);\n    };\n    WorkbookSave.prototype.initiateFullPostSave = function () {\n        var keys = Object.keys(this.saveSettings);\n        var i;\n        var formElem = this.parent.createElement('form', { attrs: { method: 'POST', action: this.saveSettings.url } });\n        var inputElem = this.parent.createElement('input', { attrs: { type: 'hidden', name: 'JSONData' } });\n        inputElem.value = JSON.stringify(this.saveJSON);\n        formElem.appendChild(inputElem);\n        for (i = 0; i < keys.length; i++) {\n            inputElem = this.parent.createElement('input', { attrs: { type: 'hidden', name: keys[i] } });\n            inputElem.value = this.saveSettings[keys[i]];\n            formElem.appendChild(inputElem);\n        }\n        keys = Object.keys(this.customParams);\n        for (i = 0; i < keys.length; i++) {\n            inputElem = this.parent.createElement('input', { attrs: { type: 'hidden', name: keys[i] } });\n            inputElem.value = this.customParams[keys[i]];\n            formElem.appendChild(inputElem);\n        }\n        document.body.appendChild(formElem);\n        formElem.submit();\n        detach(formElem);\n        this.parent.notify(events.saveCompleted, {});\n    };\n    /**\n     * Get stringified workbook object.\n     * @hidden\n     */\n    WorkbookSave.prototype.getStringifyObject = function (value, skipProp) {\n        if (skipProp === void 0) { skipProp = []; }\n        return JSON.stringify(value, function (key, value) {\n            if (skipProp.indexOf(key) > -1) {\n                return undefined;\n            }\n            else {\n                if (value && typeof value === 'object' && value.hasOwnProperty('properties')) {\n                    return value.properties;\n                }\n                else if (value !== null) {\n                    return value;\n                }\n                else {\n                    return undefined;\n                }\n            }\n        });\n    };\n    WorkbookSave.prototype.getFileNameWithExtension = function (filename) {\n        if (!filename) {\n            filename = this.saveSettings.fileName;\n        }\n        var fileExt = this.getFileExtension();\n        var idx = filename.lastIndexOf('.');\n        if (idx > -1) {\n            filename = filename.substr(0, idx);\n        }\n        return (filename + fileExt);\n    };\n    WorkbookSave.prototype.getFileExtension = function () {\n        return ('.' + this.saveSettings.saveType.toLowerCase());\n    };\n    return WorkbookSave;\n}(SaveWorker));\nexport { WorkbookSave };\n","/**\n * @hidden\n */\nexport var CommonErrors;\n(function (CommonErrors) {\n    CommonErrors[CommonErrors[\"na\"] = 0] = \"na\";\n    CommonErrors[CommonErrors[\"value\"] = 1] = \"value\";\n    CommonErrors[CommonErrors[\"ref\"] = 2] = \"ref\";\n    CommonErrors[CommonErrors[\"divzero\"] = 3] = \"divzero\";\n    CommonErrors[CommonErrors[\"num\"] = 4] = \"num\";\n    CommonErrors[CommonErrors[\"name\"] = 5] = \"name\";\n    CommonErrors[CommonErrors[\"null\"] = 6] = \"null\";\n})(CommonErrors || (CommonErrors = {}));\n/**\n * @hidden\n */\nexport var FormulasErrorsStrings;\n(function (FormulasErrorsStrings) {\n    FormulasErrorsStrings[FormulasErrorsStrings[\"operators_cannot_start_with_expression\"] = 0] = \"operators_cannot_start_with_expression\";\n    FormulasErrorsStrings[FormulasErrorsStrings[\"reservedWord_And\"] = 1] = \"reservedWord_And\";\n    FormulasErrorsStrings[FormulasErrorsStrings[\"reservedWord_Xor\"] = 2] = \"reservedWord_Xor\";\n    FormulasErrorsStrings[FormulasErrorsStrings[\"reservedWord_If\"] = 3] = \"reservedWord_If\";\n    FormulasErrorsStrings[FormulasErrorsStrings[\"number_contains_2_decimal_points\"] = 4] = \"number_contains_2_decimal_points\";\n    FormulasErrorsStrings[FormulasErrorsStrings[\"reservedWord_Else\"] = 5] = \"reservedWord_Else\";\n    FormulasErrorsStrings[FormulasErrorsStrings[\"reservedWord_Not\"] = 6] = \"reservedWord_Not\";\n    FormulasErrorsStrings[FormulasErrorsStrings[\"invalid_char_in_number\"] = 7] = \"invalid_char_in_number\";\n    FormulasErrorsStrings[FormulasErrorsStrings[\"invalid_characters_following_with_operator\"] = 6] = \"invalid_characters_following_with_operator\";\n    FormulasErrorsStrings[FormulasErrorsStrings[\"mismatched_parentheses\"] = 8] = \"mismatched_parentheses\";\n    FormulasErrorsStrings[FormulasErrorsStrings[\"unknown_formula_name\"] = 9] = \"unknown_formula_name\";\n    FormulasErrorsStrings[FormulasErrorsStrings[\"requires_a_single_argument\"] = 10] = \"requires_a_single_argument\";\n    FormulasErrorsStrings[FormulasErrorsStrings[\"requires_3_args\"] = 11] = \"requires_3_args\";\n    FormulasErrorsStrings[FormulasErrorsStrings[\"invalid_Math_argument\"] = 12] = \"invalid_Math_argument\";\n    FormulasErrorsStrings[FormulasErrorsStrings[\"requires_2_args\"] = 13] = \"requires_2_args\";\n    FormulasErrorsStrings[FormulasErrorsStrings[\"bad_index\"] = 14] = \"bad_index\";\n    FormulasErrorsStrings[FormulasErrorsStrings[\"too_complex\"] = 15] = \"too_complex\";\n    FormulasErrorsStrings[FormulasErrorsStrings[\"circular_reference\"] = 16] = \"circular_reference\";\n    FormulasErrorsStrings[FormulasErrorsStrings[\"missing_formula\"] = 17] = \"missing_formula\";\n    FormulasErrorsStrings[FormulasErrorsStrings[\"improper_formula\"] = 18] = \"improper_formula\";\n    FormulasErrorsStrings[FormulasErrorsStrings[\"invalid_expression\"] = 19] = \"invalid_expression\";\n    FormulasErrorsStrings[FormulasErrorsStrings[\"cell_empty\"] = 20] = \"cell_empty\";\n    FormulasErrorsStrings[FormulasErrorsStrings[\"bad_formula\"] = 21] = \"bad_formula\";\n    FormulasErrorsStrings[FormulasErrorsStrings[\"empty_expression\"] = 22] = \"empty_expression\";\n    FormulasErrorsStrings[FormulasErrorsStrings[\"virtual_mode_required\"] = 23] = \"virtual_mode_required\";\n    FormulasErrorsStrings[FormulasErrorsStrings[\"mismatched_tics\"] = 24] = \"mismatched_tics\";\n    FormulasErrorsStrings[FormulasErrorsStrings[\"wrong_number_arguments\"] = 25] = \"wrong_number_arguments\";\n    FormulasErrorsStrings[FormulasErrorsStrings[\"invalid_arguments\"] = 26] = \"invalid_arguments\";\n    FormulasErrorsStrings[FormulasErrorsStrings[\"iterations_do_not_converge\"] = 27] = \"iterations_do_not_converge\";\n    FormulasErrorsStrings[FormulasErrorsStrings[\"calculation_overflow\"] = 29] = \"calculation_overflow\";\n    FormulasErrorsStrings[FormulasErrorsStrings[\"already_registered\"] = 28] = \"already_registered\";\n    FormulasErrorsStrings[FormulasErrorsStrings[\"missing_sheet\"] = 30] = \"missing_sheet\";\n    FormulasErrorsStrings[FormulasErrorsStrings[\"cannot_parse\"] = 31] = \"cannot_parse\";\n    FormulasErrorsStrings[FormulasErrorsStrings[\"expression_cannot_end_with_an_operator\"] = 32] = \"expression_cannot_end_with_an_operator\";\n})(FormulasErrorsStrings || (FormulasErrorsStrings = {}));\n","import { FormulasErrorsStrings, CommonErrors, getSkeletonVal } from '../common/index';\nimport { isNullOrUndefined, getValue, Internationalization } from '@syncfusion/ej2-base';\n/**\n * Represents the basic formulas module.\n */\nvar BasicFormulas = /** @class */ (function () {\n    function BasicFormulas(parent) {\n        this.formulas = [\n            { formulaName: 'SUM', category: 'Math & Trig', description: 'Sums individual values, cell references or ranges.' },\n            {\n                formulaName: 'SUMIFS', category: 'Math & Trig',\n                description: 'Sums the cells specified by a given set of conditionsor criteria.'\n            },\n            {\n                formulaName: 'SUMPRODUCT', category: 'Math & Trig',\n                description: 'Returns sum of the product of given ranges of arrays.'\n            },\n            { formulaName: 'ABS', category: 'Math & Trig', description: 'Returns the absolute value of a number.' },\n            { formulaName: 'RAND', category: 'Math & Trig', description: 'Return a random number between 0 and 1.' },\n            { formulaName: 'FLOOR', category: 'Math & Trig', description: 'Returns the round a number down to the nearest integer.' },\n            { formulaName: 'CEILING', category: 'Math & Trig', description: 'Returns a number rounded up to a multiple of another number.' },\n            {\n                formulaName: 'SUMIF', category: 'Math & Trig',\n                description: 'It will sum up cells that meet the given criteria.'\n            },\n            {\n                formulaName: 'PRODUCT', category: 'Math & Trig',\n                description: 'Multiplies all the numbers given as arguments and returns the product.'\n            },\n            {\n                formulaName: 'AVERAGE', category: 'Statistical',\n                description: 'The sum of the numbers divided by how many numbers are being averaged.'\n            },\n            {\n                formulaName: 'AVERAGEIF', category: 'Statistical',\n                description: 'Computes the average of the numbers in a range that meet the supplied criteria.'\n            },\n            {\n                formulaName: 'COUNT', category: 'Statistical',\n                description: 'Counts the numbers in the list of arguments, exclude text entries.'\n            },\n            { formulaName: 'COUNTA', category: 'Statistical', description: 'Counts the non-empty values in the list of arguments.' },\n            {\n                formulaName: 'COUNTIF', category: 'Statistical',\n                description: 'Counts the number of cells in a range that meet a specified condition.'\n            },\n            {\n                formulaName: 'COUNTIFS', category: 'Statistical',\n                description: 'Counts the number of times each cells in all the ranges that meet the specific conditions.'\n            },\n            {\n                formulaName: 'AVERAGEA', category: 'Statistical',\n                description: 'Calculates the average of values in the list of arguments.Arguments can be numbers, names, arrays or references.'\n            },\n            {\n                formulaName: 'AVERAGEIFS', category: 'Statistical',\n                description: 'Conditionally returns the average of the contents of cells for the set of ranges.'\n            },\n            {\n                formulaName: 'MIN', category: 'Statistical',\n                description: 'Returns the smaller number in set of arguments.'\n            },\n            { formulaName: 'MAX', category: 'Statistical', description: 'Returns the largest number in set of arguments.' },\n            { formulaName: 'DATE', category: 'Date', description: 'Returns the date, given the year, month and day of the month.' },\n            { formulaName: 'DAY', category: 'Date', description: 'Returns the day of a given date.' },\n            { formulaName: 'TODAY', category: 'Date', description: 'Returns the current date as date value.' },\n            { formulaName: 'DAYS', category: 'Date', description: 'Returns the number of days between two dates.' },\n            {\n                formulaName: 'IF', category: 'Logical',\n                description: 'Returns one value if a logical expression is TRUE and another if it is FALSE'\n            },\n            {\n                formulaName: 'AND', category: 'Logical',\n                description: 'Returns TRUE if all the arguments are considered TRUE, and FALSE otherwise.'\n            },\n            {\n                formulaName: 'IFS', category: 'Logical',\n                description: 'Checks multiple conditions and returns a value corresponding to the first TRUE result.'\n            },\n            {\n                formulaName: 'IFERROR', category: 'Logical',\n                description: 'Returns a value you specify if a formula evaluates to an error; otherwise, it returns the result of the formula.'\n            },\n            {\n                formulaName: 'CHOOSE', category: 'Lookup & Reference',\n                description: 'Returns a value from a list, given an index number.'\n            },\n            {\n                formulaName: 'INDEX', category: 'Lookup & Reference',\n                description: 'Returns a value from a table, given a row and column number.'\n            },\n            { formulaName: 'FIND', category: 'Text', description: 'Returns the position of a string of text within another string.' },\n            { formulaName: 'CONCATENATE', category: 'Text', description: ' Used to join two or more strings together.' },\n            { formulaName: 'CONCAT', category: 'Text', description: 'Concatenates a list or range of text strings.' },\n            { formulaName: 'SUBTOTAL', category: 'Lookup & Reference', description: 'Returns a subtotal in a list or database.' },\n            { formulaName: 'RADIANS', category: 'Math & Trig', description: 'Converts degrees to radians.' },\n            {\n                formulaName: 'OR', category: 'Logical',\n                description: 'Returns TRUE if any arguments considered TRUE, and all the arguments are FALSE it will return FALSE.'\n            },\n            {\n                formulaName: 'MATCH', category: 'Lookup & Reference',\n                description: 'Returns the relative position of an checked item in range that matches a specified value in a specified order'\n            },\n            {\n                formulaName: 'RANDBETWEEN', category: 'Math & Trig', description: 'Returns an integer random number in a specified range.'\n            },\n            {\n                formulaName: 'SLOPE', category: 'Statistical',\n                description: 'Returns the slope of the line from linear regression of the data points.'\n            },\n            {\n                formulaName: 'INTERCEPT', category: 'Statistical',\n                description: 'Calculates the point of the Y-intercept line via linear regression.'\n            },\n            {\n                formulaName: 'ROUNDUP', category: 'Math & Trig', description: 'Rounds a number away from zero.'\n            },\n            {\n                formulaName: 'INT', category: 'Math & Trig', description: 'Returns a number to the nearest integer.'\n            },\n            {\n                formulaName: 'LN', category: 'Math & Trig', description: 'Returns the natural logarithm of a number.'\n            },\n            {\n                formulaName: 'ISNUMBER', category: 'Information', description: 'Returns TRUE, if the argument is number and FALSE otherwise.'\n            },\n            {\n                formulaName: 'ROUND', category: 'Math & Trig', description: 'Rounds a number to a specified number of digits.'\n            },\n            {\n                formulaName: 'LOG', category: 'Math & Trig', description: 'Returns the logarithm of a number to the base that you specify.'\n            },\n            {\n                formulaName: 'POWER', category: 'Math & Trig', description: 'Returns the result of a number raised to power.'\n            },\n            {\n                formulaName: 'TRUNC', category: 'Math & Trig',\n                description: 'Returns the truncated value of a number to a specified number of decimal places.'\n            },\n            {\n                formulaName: 'EXP', category: 'Math & Trig', description: 'Returns e raised to the power of the given number.'\n            },\n            {\n                formulaName: 'GEOMEAN', category: 'Statistical',\n                description: 'Returns the geometric mean of an array or range of positive data.'\n            },\n            { formulaName: 'TEXT', category: 'Lookup & Reference', description: 'Returns the value in required format.' }\n        ];\n        this.isConcat = false;\n        this.parent = parent;\n        this.init();\n    }\n    BasicFormulas.prototype.init = function () {\n        var fn;\n        for (var i = 0; i < this.formulas.length; i++) {\n            fn = getValue('Compute' + this.formulas[i].formulaName, this).bind(this);\n            this.addFormulaCollection(this.formulas[i].formulaName.toUpperCase(), fn, this.formulas[i].category, this.formulas[i].description);\n        }\n    };\n    BasicFormulas.prototype.addFormulaCollection = function (formulaName, functionName, formulaCategory, description) {\n        this.parent.libraryFormulas = {\n            fName: formulaName, handler: functionName, category: formulaCategory,\n            description: description\n        };\n    };\n    /** @hidden */\n    BasicFormulas.prototype.ComputeSUM = function () {\n        var args = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            args[_i] = arguments[_i];\n        }\n        if (isNullOrUndefined(args) || (args.length === 1 && args[0] === '')) {\n            return this.parent.formulaErrorStrings[FormulasErrorsStrings.invalid_arguments];\n        }\n        var sum = 0;\n        var val;\n        var orgValue;\n        if (!isNullOrUndefined(args)) {\n            var argArr = args;\n            for (var i = 0; i < argArr.length; i++) {\n                var argValue = argArr[i].toString();\n                if (argValue.indexOf(':') > -1 && this.parent.isCellReference(argValue)) {\n                    var cellCollection = this.parent.getCellCollection(argValue.split(this.parent.tic).join(''));\n                    for (var j = 0; j < cellCollection.length; j++) {\n                        val = this.parent.getValueFromArg(cellCollection[j]);\n                        if (this.parent.getErrorStrings().indexOf(val) > -1) {\n                            return val;\n                        }\n                        if (isNullOrUndefined(val[0]) || isNaN(this.parent.parseFloat(val))) {\n                            continue;\n                        }\n                        sum = sum + this.parent.parseFloat(val);\n                    }\n                }\n                else {\n                    if (argArr[i].split(this.parent.tic).join('') === this.parent.trueValue) {\n                        argArr[i] = '1';\n                    }\n                    if (argArr[i].split(this.parent.tic).join('') === this.parent.falseValue) {\n                        argArr[i] = '0';\n                    }\n                    orgValue = this.parent.getValueFromArg(argArr[i].split(this.parent.tic).join(''));\n                    if (this.parent.getErrorStrings().indexOf(orgValue) > -1) {\n                        return orgValue;\n                    }\n                    if (isNullOrUndefined(orgValue) || isNaN(this.parent.parseFloat(orgValue))) {\n                        continue;\n                    }\n                    if (orgValue.length > 0) {\n                        sum = sum + this.parent.parseFloat(orgValue + '');\n                    }\n                }\n            }\n        }\n        return sum;\n    };\n    /** @hidden */\n    BasicFormulas.prototype.ComputeINT = function () {\n        var args = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            args[_i] = arguments[_i];\n        }\n        var str;\n        var num;\n        var index;\n        if (!isNullOrUndefined(args) && args.length !== 1 || args[0] === '') {\n            str = this.parent.formulaErrorStrings[FormulasErrorsStrings.invalid_arguments];\n        }\n        if (args[0] !== '' && args.length === 1) {\n            str = args[0];\n            index = str.indexOf('\"');\n            str = str.indexOf('\"') > -1 ? str.replace('\"', '') : str;\n            str = str.indexOf('\"') > -1 ? str.replace('\"', '') : str;\n            str = this.parent.getValueFromArg(str);\n            str = str.toUpperCase() === 'TRUE' ? '1' : (str === 'FALSE' ? '0' : str);\n            num = this.parent.parseFloat(str);\n            num = Math.floor(num);\n        }\n        if (isNaN(num)) {\n            str = index > -1 ? this.parent.getErrorStrings()[CommonErrors.value] : this.parent.getErrorStrings()[CommonErrors.name];\n        }\n        return num ? num : str;\n    };\n    ;\n    /** @hidden */\n    BasicFormulas.prototype.ComputeTODAY = function () {\n        var args = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            args[_i] = arguments[_i];\n        }\n        var str;\n        if (args && args[0] !== '') {\n            str = this.parent.formulaErrorStrings[FormulasErrorsStrings.invalid_arguments];\n        }\n        else {\n            var dt = new Date(Date.now());\n            str = dt.getFullYear() + '/' + this.parent.calculateDate((dt.getMonth() + 1).toString()) + '/'\n                + this.parent.calculateDate(dt.getDate().toString());\n        }\n        return str;\n    };\n    /** @hidden */\n    BasicFormulas.prototype.ComputeSUMPRODUCT = function () {\n        var args = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            args[_i] = arguments[_i];\n        }\n        var sum = 0;\n        var count = 0;\n        var index;\n        var mulValues = null;\n        var ranges = args;\n        for (var k = 0; k < ranges.length; ++k) {\n            var range = ranges[k];\n            if (!range.startsWith(this.parent.tic) && this.parent.isCellReference(range)) {\n                var i = range.indexOf(':');\n                var startRow = this.parent.rowIndex(range.substr(0, i));\n                var endRow = this.parent.rowIndex(range.substr(i + 1));\n                if (!(startRow !== -1 || endRow === -1) === (startRow === -1 || endRow !== -1)) {\n                    return this.parent.getErrorStrings()[CommonErrors.name];\n                }\n                var col1 = this.parent.colIndex(range.substr(0, i));\n                var col2 = this.parent.colIndex(range.substr(i + 1));\n                if (mulValues === null) {\n                    count = (endRow - startRow + 1) * (col2 - col1 + 1);\n                    mulValues = [];\n                    for (i = 0; i < count; ++i) {\n                        mulValues[i] = 1; //To create required index.\n                    }\n                }\n                i = 0;\n                for (var row = startRow; row <= endRow; ++row) {\n                    for (var col = col1; col <= col2; ++col) {\n                        var cellRef = '' + this.parent.convertAlpha(col) + (row);\n                        var result = this.parent.getValueFromArg(cellRef);\n                        if (!isNaN(parseFloat(result))) {\n                            //To return #VALUE! error when array dimensions are mismatched.\n                            if (isNaN(mulValues[i])) {\n                                return this.parent.getErrorStrings()[CommonErrors.name];\n                            }\n                            mulValues[i] = mulValues[i] * parseFloat(result);\n                        }\n                        else {\n                            mulValues[i] = 0;\n                        }\n                        i++;\n                    }\n                }\n            }\n            else {\n                var s1 = this.parent.getValueFromArg(range);\n                index = s1.indexOf('\"');\n                if (this.parent.getErrorStrings().indexOf(s1) > -1) {\n                    return s1;\n                }\n                else if (index > -1) {\n                    return 0;\n                }\n                else {\n                    return this.parent.formulaErrorStrings[FormulasErrorsStrings.invalid_arguments];\n                }\n            }\n        }\n        for (var i = 0; i < count; ++i) {\n            sum += mulValues[i];\n        }\n        return sum;\n    };\n    ;\n    /** @hidden */\n    BasicFormulas.prototype.ComputeROUNDUP = function () {\n        var args = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            args[_i] = arguments[_i];\n        }\n        var str;\n        var num;\n        var arg1;\n        var arg2;\n        var index;\n        var len = args.length;\n        if (!isNullOrUndefined(args) && len > 2) {\n            str = this.parent.formulaErrorStrings[FormulasErrorsStrings.invalid_arguments];\n        }\n        if (len === 1 && args[0] !== '') {\n            index = args[0].indexOf('\"');\n            arg1 = args[0].indexOf('\"') > -1 ? args[0].replace('\"', '') : args[0];\n            arg1 = arg1.indexOf('\"') > -1 ? arg1.replace('\"', '') : arg1;\n            arg1 = arg1.toUpperCase() === 'TRUE' ? '1' : (arg1 === 'FALSE' ? '0' : arg1);\n            arg1 = this.parent.getValueFromArg(arg1);\n            num = this.parent.parseFloat(arg1);\n            if (num > 0) {\n                num += .4999999999; // To round the number, we using this value.\n            }\n            else if (num < 0) {\n                num -= .4999999999;\n            }\n            num = this.parent.parseFloat(num.toFixed(0));\n            str = num.toString();\n        }\n        else if (len === 2 && args[0] !== '' && args[1] !== '') {\n            index = args[0].indexOf('\"') > -1 ? args[0].indexOf('\"') : (args[1].indexOf('\"') > -1 ? args[1].indexOf('\"') : -1);\n            arg1 = args[0].indexOf('\"') > -1 ? args[0].replace('\"', '') : args[0];\n            arg1 = arg1.indexOf('\"') > -1 ? arg1.replace('\"', '') : arg1;\n            arg2 = args[1].indexOf('\"') > -1 ? args[1].replace('\"', '') : args[1];\n            arg2 = arg2.indexOf('\"') > -1 ? arg2.replace('\"', '') : arg2;\n            arg1 = arg1.toUpperCase() === 'TRUE' ? '1' : (arg1 === 'FALSE' ? '0' : arg1);\n            arg2 = arg2.toUpperCase() === 'TRUE' ? '1' : (arg2 === 'FALSE' ? '0' : arg2);\n            arg1 = this.parent.getValueFromArg(arg1);\n            arg2 = this.parent.getValueFromArg(arg2);\n            var digits = Math.ceil(this.parent.parseFloat(arg2));\n            num = this.parent.parseFloat(arg1);\n            if (digits > 0) {\n                if (num > 0) {\n                    num += .4999999999 / Math.pow(10, digits);\n                }\n                else if (num < 0) {\n                    num -= .4999999999 / Math.pow(10, digits);\n                }\n                num = this.parent.parseFloat(num.toFixed(digits));\n                str = num.toFixed(digits);\n                if (isNaN(num)) {\n                    if (digits.toString().indexOf('\"') > -1) {\n                        str = this.parent.getErrorStrings()[CommonErrors.value];\n                    }\n                    else {\n                        str = this.parent.getErrorStrings()[CommonErrors.name];\n                    }\n                }\n            }\n            else {\n                if (num > 0) {\n                    num = (num / Math.pow(10, -digits)) + .49999;\n                }\n                else if (num < 0) {\n                    num = (num / Math.pow(10, -digits)) - .49999;\n                }\n                num = this.parent.parseFloat(num.toFixed(0)) * Math.pow(10, -digits);\n                str = num.toString();\n                if (isNaN(num)) {\n                    str = (digits.toString().indexOf('\"') > -1) ? this.parent.getErrorStrings()[CommonErrors.value] :\n                        str = this.parent.getErrorStrings()[CommonErrors.name];\n                }\n            }\n        }\n        else {\n            str = index > -1 ? this.parent.getErrorStrings()[CommonErrors.value] :\n                this.parent.formulaErrorStrings[FormulasErrorsStrings.invalid_arguments];\n        }\n        return str;\n    };\n    ;\n    /** @hidden */\n    BasicFormulas.prototype.ComputeCOUNT = function () {\n        var args = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            args[_i] = arguments[_i];\n        }\n        if (isNullOrUndefined(args) || (args.length === 1 && args[0] === '')) {\n            return this.parent.formulaErrorStrings[FormulasErrorsStrings.wrong_number_arguments];\n        }\n        var argArr = args;\n        var argVal;\n        var cellColl;\n        var result = 0;\n        var cellValue;\n        for (var i = 0; i < argArr.length; i++) {\n            argVal = argArr[i];\n            if (argVal.indexOf(':') > -1 && this.parent.isCellReference(argVal)) {\n                cellColl = this.parent.getCellCollection(argVal.split(this.parent.tic).join(''));\n                for (var j = 0; j < cellColl.length; j++) {\n                    cellValue = this.parent.getValueFromArg(cellColl[j]);\n                    if (!isNaN(this.parent.parseFloat(cellValue))) {\n                        if (argVal.length > 0 && argVal !== '' && argVal !== ' ') {\n                            result++;\n                        }\n                    }\n                }\n            }\n            else {\n                argVal = argVal.split(this.parent.tic).join('');\n                if (!isNaN(this.parent.parseFloat(this.parent.getValueFromArg(argVal)))) {\n                    if (argVal.length > 0 && argVal !== '' && argVal !== ' ') {\n                        result++;\n                    }\n                }\n            }\n        }\n        return result;\n    };\n    /** @hidden */\n    BasicFormulas.prototype.ComputeDATE = function () {\n        var args = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            args[_i] = arguments[_i];\n        }\n        if (isNullOrUndefined(args) || (args.length === 1 && args[0] === '')) {\n            return this.parent.formulaErrorStrings[FormulasErrorsStrings.wrong_number_arguments];\n        }\n        var argArr = args;\n        if (argArr.length !== 3) {\n            return this.parent.formulaErrorStrings[FormulasErrorsStrings.wrong_number_arguments];\n        }\n        for (var i = 0; i < argArr.length; ++i) {\n            argArr[i] = this.parent.getValueFromArg(argArr[i]);\n        }\n        /* tslint:disable */\n        argArr[0] = (argArr[0].split(this.parent.tic).join('') === 'TRUE') ? '1' : (argArr[0].split(this.parent.tic).join('') === 'FALSE') ? '0' : argArr[0];\n        argArr[1] = (argArr[1].split(this.parent.tic).join('') === 'TRUE') ? '1' : (argArr[1].split(this.parent.tic).join('') === 'FALSE') ? '0' : argArr[1];\n        argArr[2] = (argArr[2].split(this.parent.tic).join('') === 'TRUE') ? '1' : (argArr[2].split(this.parent.tic).join('') === 'FALSE') ? '0' : argArr[2];\n        /* tslint:enable */\n        var year = this.parent.parseFloat(argArr[0].split(this.parent.tic).join(''));\n        var month = this.parent.parseFloat(argArr[1].split(this.parent.tic).join(''));\n        var day = this.parent.parseFloat(argArr[2].split(this.parent.tic).join(''));\n        var days = 0;\n        if (!isNaN(year) && !isNaN(month) && !isNaN(day)) {\n            if (year < 0) {\n                return this.parent.getErrorStrings()[CommonErrors.num].toString();\n            }\n            while (month > 12) {\n                month -= 12;\n                year++;\n            }\n            days = this.parent.getSerialDateFromDate(year, month, day);\n        }\n        else {\n            return this.parent.getErrorStrings()[CommonErrors.value].toString();\n        }\n        if (days === 0) {\n            return this.parent.getErrorStrings()[CommonErrors.num].toString();\n        }\n        var date = this.parent.fromOADate(days);\n        if (date.toString() !== 'Invalid Date') {\n            /* tslint:disable-next-line */\n            return date.getFullYear() + '/' + this.parent.calculateDate((date.getMonth() + 1).toString()) + '/' + this.parent.calculateDate(date.getDate().toString());\n        }\n        return days.toString();\n    };\n    /** @hidden */\n    BasicFormulas.prototype.ComputeFLOOR = function () {\n        var args = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            args[_i] = arguments[_i];\n        }\n        if (isNullOrUndefined(args) || (args.length === 1 && args[0] === '')) {\n            return this.parent.formulaErrorStrings[FormulasErrorsStrings.invalid_arguments];\n        }\n        var argArr = args;\n        var argCount = argArr.length;\n        var splitArg = argArr[1].split(this.parent.tic).join('');\n        var argValue = [];\n        var fnum;\n        var significance;\n        if (argCount !== 2) {\n            return this.parent.formulaErrorStrings[FormulasErrorsStrings.wrong_number_arguments];\n        }\n        argValue.push(fnum = this.parent.parseFloat(this.parent.getValueFromArg(argArr[0].split(this.parent.tic).join(''))));\n        argArr[1] = (splitArg === this.parent.trueValue) ? '1' : (splitArg === this.parent.falseValue) ? '0' : argArr[1];\n        argValue.push(significance = this.parent.parseFloat(this.parent.getValueFromArg(argArr[1].split(this.parent.tic).join(''))));\n        if (fnum > 0 && significance < 0) {\n            return this.parent.getErrorStrings()[CommonErrors.num];\n        }\n        if (fnum > 0 && significance === 0) {\n            return this.parent.getErrorStrings()[CommonErrors.divzero];\n        }\n        for (var i = 0; i < argArr.length; i++) {\n            if (argArr[i].indexOf(this.parent.tic) > -1) {\n                return this.parent.getErrorStrings()[CommonErrors.value];\n            }\n        }\n        if (isNaN(fnum)) {\n            return this.parent.getErrorStrings()[CommonErrors.name];\n        }\n        return Math.floor(fnum / significance) * significance;\n    };\n    /** @hidden */\n    BasicFormulas.prototype.ComputeCEILING = function () {\n        var args = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            args[_i] = arguments[_i];\n        }\n        if (isNullOrUndefined(args) || (args.length === 1 && args[0] === '')) {\n            return this.parent.formulaErrorStrings[FormulasErrorsStrings.invalid_arguments];\n        }\n        var argArr = args;\n        var orgValue = [];\n        var argCount = argArr.length;\n        var splitArg = argArr[1].split(this.parent.tic).join('');\n        var cnum;\n        var significance;\n        if (argCount !== 2) {\n            return this.parent.formulaErrorStrings[FormulasErrorsStrings.wrong_number_arguments];\n        }\n        orgValue.push(cnum = this.parent.parseFloat(this.parent.getValueFromArg(argArr[0].split(this.parent.tic).join(''))));\n        argArr[1] = (splitArg === this.parent.trueValue) ? '1' : (splitArg === this.parent.falseValue) ? '0' : argArr[1];\n        orgValue.push(significance = this.parent.parseFloat(this.parent.getValueFromArg(argArr[1].split(this.parent.tic).join(''))));\n        if (cnum > 0 && significance < 0) {\n            return this.parent.getErrorStrings()[CommonErrors.num];\n        }\n        for (var i = 0; i < argArr.length; i++) {\n            if (argArr[i].indexOf(this.parent.tic) > -1) {\n                return this.parent.getErrorStrings()[CommonErrors.value];\n            }\n        }\n        if (isNaN(cnum)) {\n            return this.parent.getErrorStrings()[CommonErrors.name];\n        }\n        if (significance === 0) {\n            return 0;\n        }\n        return Math.ceil(cnum / significance) * significance;\n    };\n    /** @hidden */\n    BasicFormulas.prototype.ComputeDAY = function () {\n        var serialNumber = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            serialNumber[_i] = arguments[_i];\n        }\n        var date = serialNumber;\n        var result;\n        if (isNullOrUndefined(date) || (date.length === 1 && date[0] === '')) {\n            return this.parent.formulaErrorStrings[FormulasErrorsStrings.invalid_arguments];\n        }\n        if (date.length > 1) {\n            return this.parent.formulaErrorStrings[FormulasErrorsStrings.wrong_number_arguments];\n        }\n        var dateVal = this.parent.getValueFromArg(date[0].split(this.parent.tic).join(''));\n        if (!isNaN(this.parent.parseFloat(dateVal))) {\n            return this.parent.getErrorStrings()[CommonErrors.name];\n        }\n        else {\n            dateVal = dateVal;\n        }\n        result = this.parent.parseDate(dateVal);\n        if (Object.prototype.toString.call(result) === '[object Date]') {\n            /* tslint:disable-next-line */\n            result = result.getDate();\n        }\n        return result;\n    };\n    /** @hidden */\n    BasicFormulas.prototype.ComputeIF = function () {\n        var args = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            args[_i] = arguments[_i];\n        }\n        if (isNullOrUndefined(args) || (args.length === 1 && args[0] === '')) {\n            return this.parent.formulaErrorStrings[FormulasErrorsStrings.invalid_arguments];\n        }\n        if (this.parent.getErrorStrings().indexOf(args[0]) > 0) {\n            return args[0];\n        }\n        var argArr = args;\n        var condition;\n        var result;\n        if (argArr.length > 3 || argArr.length === 1) {\n            return this.parent.formulaErrorStrings[FormulasErrorsStrings.wrong_number_arguments];\n        }\n        else if (argArr.length <= 3) {\n            condition = this.parent.getValueFromArg(argArr[0]);\n            if (this.parent.getErrorStrings().indexOf(condition) > -1) {\n                return condition;\n            }\n            if (condition === this.parent.trueValue || this.parent.parseFloat(condition) > 0 || this.parent.parseFloat(condition) < 0) {\n                result = this.parent.getValueFromArg(argArr[1]);\n            }\n            else if (condition === this.parent.falseValue || this.parent.parseFloat(condition) === 0) {\n                if (isNullOrUndefined(argArr[2])) {\n                    return this.parent.falseValue;\n                }\n                result = this.parent.getValueFromArg(argArr[2]);\n            }\n            else {\n                return this.parent.formulaErrorStrings[FormulasErrorsStrings.requires_3_args];\n            }\n        }\n        if (result.indexOf(this.parent.tic) > -1) {\n            return result.split(this.parent.tic).join('');\n        }\n        else {\n            return result;\n        }\n    };\n    /** @hidden */\n    BasicFormulas.prototype.ComputeIFERROR = function () {\n        var args = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            args[_i] = arguments[_i];\n        }\n        if (isNullOrUndefined(args) || (args.length === 1 && args[0] === '')) {\n            return this.parent.formulaErrorStrings[FormulasErrorsStrings.invalid_arguments];\n        }\n        var argArr = args;\n        var condition;\n        if (argArr.length !== 2) {\n            return this.parent.formulaErrorStrings[FormulasErrorsStrings.wrong_number_arguments];\n        }\n        condition = this.parent.getValueFromArg(argArr[0]);\n        if (condition === this.parent.trueValue || condition === this.parent.falseValue) {\n            return condition;\n        }\n        if (condition[0] === this.parent.arithMarker) {\n            condition = condition.replace(this.parent.arithMarker, ' ');\n        }\n        condition = this.parent.getValueFromArg(condition).toUpperCase().split(this.parent.tic).join('');\n        if (condition[0] === '#' || condition.indexOf('Infinity') > -1 || this.parent.getErrorStrings().indexOf(condition) > -1) {\n            return this.parent.getValueFromArg(argArr[1]).split(this.parent.tic).join('');\n        }\n        else {\n            return condition;\n        }\n    };\n    /** @hidden */\n    BasicFormulas.prototype.ComputePRODUCT = function () {\n        var range = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            range[_i] = arguments[_i];\n        }\n        if (isNullOrUndefined(range) || (range.length === 1 && range[0] === '')) {\n            return this.parent.formulaErrorStrings[FormulasErrorsStrings.invalid_arguments];\n        }\n        var product = 1;\n        var val;\n        var orgValue;\n        var argsHit = true;\n        var parseVal;\n        if (!isNullOrUndefined(range)) {\n            var argArr = range;\n            for (var i = 0; i < argArr.length; i++) {\n                var rangevalue = argArr[i];\n                if (rangevalue.indexOf(':') > -1 && this.parent.isCellReference(rangevalue)) {\n                    var cellCollection = this.parent.getCellCollection(rangevalue);\n                    for (var j = 0; j < cellCollection.length; j++) {\n                        val = this.parent.getValueFromArg(cellCollection[j].split(this.parent.tic).join(''));\n                        if (this.parent.getErrorStrings().indexOf(val) > -1) {\n                            return val;\n                        }\n                        val = (val.split(this.parent.tic).join('') === 'TRUE') ? '1' :\n                            (val.split(this.parent.tic).join('') === 'FALSE') ? '0' : val;\n                        parseVal = this.parent.parseFloat(val);\n                        if (!isNaN(parseVal)) {\n                            if (val.length > 0) {\n                                product = product * parseVal;\n                                argsHit = false;\n                            }\n                        }\n                    }\n                }\n                else {\n                    orgValue = this.parent.getValueFromArg(argArr[i].split(this.parent.tic).join(''));\n                    if (this.parent.getErrorStrings().indexOf(orgValue) > -1) {\n                        return orgValue;\n                    }\n                    orgValue = (orgValue.split(this.parent.tic).join('') === 'TRUE') ? '1' :\n                        (orgValue.split(this.parent.tic).join('') === 'FALSE') ? '0' : orgValue;\n                    parseVal = this.parent.parseFloat(orgValue);\n                    if (!isNaN(parseVal)) {\n                        if (orgValue.length > 0) {\n                            product = product * parseVal;\n                            argsHit = false;\n                        }\n                    }\n                    if (this.parent.getErrorStrings().indexOf(orgValue) > -1) {\n                        return orgValue;\n                    }\n                }\n            }\n        }\n        return argsHit ? '0' : product.toString();\n    };\n    /** @hidden */\n    BasicFormulas.prototype.ComputeDAYS = function () {\n        var range = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            range[_i] = arguments[_i];\n        }\n        var result;\n        if (isNullOrUndefined(range) && (range.length === 1 && range[0] === '')) {\n            return this.parent.formulaErrorStrings[FormulasErrorsStrings.invalid_arguments];\n        }\n        if (range.length !== 2) {\n            return this.parent.formulaErrorStrings[FormulasErrorsStrings.wrong_number_arguments];\n        }\n        var argsArr = range;\n        if (argsArr[0].split(this.parent.tic).join('') === this.parent.trueValue) {\n            argsArr[0] = '1';\n        }\n        if (argsArr[0].split(this.parent.tic).join('') === this.parent.falseValue) {\n            argsArr[0] = '0';\n        }\n        var endDate = this.parent.getValueFromArg(argsArr[0].split(this.parent.tic).join(''));\n        var startDate = this.parent.getValueFromArg(argsArr[1].split(this.parent.tic).join(''));\n        startDate = (startDate === '' || startDate == null) ? new Date(Date.parse('1899-12-31')).toDateString() : startDate;\n        endDate = (endDate === '' || endDate == null) ? new Date(Date.parse('1899-12-31')).toDateString() : endDate;\n        if (endDate[0] === '#') {\n            return endDate;\n        }\n        if (startDate[0] === '#') {\n            return startDate;\n        }\n        var d1 = this.parent.intToDate(endDate);\n        var d2 = this.parent.intToDate(startDate);\n        if (d1.toString()[0] === '#') {\n            return d1.toString();\n        }\n        if (d2.toString()[0] === '#') {\n            return d2.toString();\n        }\n        if (Object.prototype.toString.call(d1) === '[object Date]' && Object.prototype.toString.call(d2) === '[object Date]') {\n            /* tslint:disable-next-line */\n            result = Math.ceil(d1.getTime() - d2.getTime()) / (1000 * 3600 * 24);\n        }\n        else {\n            return this.parent.getErrorStrings()[CommonErrors.value];\n        }\n        return Math.round(result);\n    };\n    /** @hidden */\n    BasicFormulas.prototype.ComputeCHOOSE = function () {\n        var args = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            args[_i] = arguments[_i];\n        }\n        if (isNullOrUndefined(args) || (args.length === 1 && args[0] === '')) {\n            return this.parent.formulaErrorStrings[FormulasErrorsStrings.invalid_arguments];\n        }\n        if (args.length < 2) {\n            return this.parent.formulaErrorStrings[FormulasErrorsStrings.wrong_number_arguments];\n        }\n        var argsArr = args;\n        if (argsArr[0].indexOf(':') > -1 && this.parent.isCellReference(argsArr[0])) {\n            var cellCollection = this.parent.getCellCollection(argsArr[0]);\n            if (cellCollection.length === 1) {\n                argsArr[0] = cellCollection[0];\n            }\n            else {\n                return this.parent.getErrorStrings()[CommonErrors.value];\n            }\n        }\n        var cond = this.parent.getValueFromArg(argsArr[0]);\n        if (this.parent.getErrorStrings().indexOf(cond) > -1) {\n            return cond;\n        }\n        var indexNum = this.parent.parseFloat(this.parent.getValueFromArg(argsArr[0].split(this.parent.tic).join('')));\n        if (indexNum < 1) {\n            return this.parent.getErrorStrings()[CommonErrors.value];\n        }\n        indexNum = Math.floor(indexNum);\n        var result;\n        if (isNullOrUndefined(argsArr[indexNum])) {\n            return this.parent.getErrorStrings()[CommonErrors.value];\n        }\n        result = argsArr[indexNum];\n        if (result === '') {\n            result = '0';\n        }\n        if (result.indexOf(':') > -1 && this.parent.isCellReference(result)) {\n            var cellCollection = this.parent.getCellCollection(argsArr[0].split(this.parent.tic).join(''));\n            if (cellCollection.length === 1) {\n                argsArr[0] = cellCollection[0];\n            }\n            else {\n                return this.parent.getErrorStrings()[CommonErrors.value];\n            }\n        }\n        return this.parent.getValueFromArg(result).split(this.parent.tic).join('');\n    };\n    /** @hidden */\n    BasicFormulas.prototype.ComputeSUMIF = function () {\n        var range = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            range[_i] = arguments[_i];\n        }\n        var argArr = range;\n        if (argArr[0].indexOf(':') < 0 && !this.parent.isCellReference(argArr[0])) {\n            return this.parent.formulaErrorStrings[FormulasErrorsStrings.improper_formula];\n        }\n        var result = this.parent.computeSumIfAndAvgIf(range);\n        if (typeof result === 'string' && (this.parent.formulaErrorStrings.indexOf(result)\n            || this.parent.getErrorStrings().indexOf(result))) {\n            return result;\n        }\n        return result[0];\n    };\n    /** @hidden */\n    BasicFormulas.prototype.ComputeABS = function () {\n        var absValue = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            absValue[_i] = arguments[_i];\n        }\n        var argArr = absValue;\n        var cellvalue = '';\n        var absVal;\n        if (absValue.length === 0 || absValue.length > 1) {\n            return this.parent.formulaErrorStrings[FormulasErrorsStrings.wrong_number_arguments];\n        }\n        if (argArr[0].toString().split(this.parent.tic).join('').trim() === '' || argArr[0].indexOf(this.parent.tic) > -1) {\n            return this.parent.getErrorStrings()[CommonErrors.value];\n        }\n        if (this.parent.isCellReference(argArr[0])) {\n            cellvalue = this.parent.getValueFromArg(argArr[0]);\n            if (cellvalue === '') {\n                return this.parent.getErrorStrings()[CommonErrors.name];\n            }\n            absVal = this.parent.parseFloat(cellvalue);\n            if (isNaN(absVal)) {\n                return this.parent.getErrorStrings()[CommonErrors.value];\n            }\n        }\n        else {\n            absVal = this.parent.parseFloat(argArr[0]);\n            if (isNaN(absVal)) {\n                return this.parent.getErrorStrings()[CommonErrors.name];\n            }\n        }\n        return Math.abs(absVal);\n    };\n    /** @hidden */\n    BasicFormulas.prototype.ComputeAVERAGE = function () {\n        var args = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            args[_i] = arguments[_i];\n        }\n        if (isNullOrUndefined(args) || (args.length === 1 && args[0] === '')) {\n            return this.parent.formulaErrorStrings[FormulasErrorsStrings.invalid_arguments];\n        }\n        var argArr = args;\n        for (var i = 0; i < argArr.length; i++) {\n            if (argArr[i].indexOf(':') > -1) {\n                if (argArr[i].indexOf(this.parent.tic) > -1) {\n                    return this.parent.getErrorStrings()[CommonErrors.value];\n                }\n            }\n        }\n        return this.parent.calculateAvg(argArr);\n    };\n    /** @hidden */\n    BasicFormulas.prototype.ComputeAVERAGEIF = function () {\n        var range = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            range[_i] = arguments[_i];\n        }\n        var argList = range;\n        if (argList[0].indexOf(':') < 0 && !this.parent.isCellReference(argList[0])) {\n            return this.parent.formulaErrorStrings[FormulasErrorsStrings.improper_formula];\n        }\n        var resultVal = this.parent.computeSumIfAndAvgIf(range);\n        if (typeof resultVal === 'string' && (this.parent.formulaErrorStrings.indexOf(resultVal)\n            || this.parent.getErrorStrings().indexOf(resultVal))) {\n            return resultVal;\n        }\n        return this.parent.parseFloat(resultVal[0]) / this.parent.parseFloat(resultVal[1]);\n    };\n    /** @hidden */\n    BasicFormulas.prototype.ComputeCONCATENATE = function () {\n        var range = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            range[_i] = arguments[_i];\n        }\n        if (isNullOrUndefined(range) || (range.length === 1 && range[0] === '')) {\n            return this.parent.formulaErrorStrings[FormulasErrorsStrings.invalid_arguments];\n        }\n        var argsList = range;\n        var result = '';\n        var tempStr = '';\n        for (var i = 0; i < argsList.length; i++) {\n            if (argsList[i].indexOf(':') > -1 && this.parent.isCellReference(argsList[i])) {\n                if (this.isConcat) {\n                    var cells = this.parent.getCellCollection(argsList[i]);\n                    for (var i_1 = 0; i_1 < cells.length; i_1++) {\n                        tempStr = this.parent.getValueFromArg(cells[i_1]);\n                        result = result + tempStr;\n                    }\n                }\n                else {\n                    return this.parent.getErrorStrings()[CommonErrors.value];\n                }\n            }\n            else {\n                if (argsList.length === 1 && argsList[0].indexOf(this.parent.tic) < 0) {\n                    return this.parent.getErrorStrings()[CommonErrors.name];\n                }\n                else {\n                    tempStr = this.parent.getValueFromArg(argsList[i]);\n                    result = result + tempStr;\n                }\n            }\n            if (this.parent.getErrorStrings().indexOf(tempStr) > -1) {\n                return tempStr;\n            }\n        }\n        return result.split(this.parent.tic).join('');\n    };\n    /** @hidden */\n    BasicFormulas.prototype.ComputeCONCAT = function () {\n        var range = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            range[_i] = arguments[_i];\n        }\n        this.isConcat = true;\n        return this.ComputeCONCATENATE.apply(this, range);\n    };\n    /** @hidden */\n    BasicFormulas.prototype.ComputeMAX = function () {\n        var args = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            args[_i] = arguments[_i];\n        }\n        return this.parent.computeMinMax(args, 'max');\n    };\n    /** @hidden */\n    BasicFormulas.prototype.ComputeMIN = function () {\n        var args = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            args[_i] = arguments[_i];\n        }\n        return this.parent.computeMinMax(args, 'min');\n    };\n    /** @hidden */\n    BasicFormulas.prototype.ComputeRAND = function () {\n        var args = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            args[_i] = arguments[_i];\n        }\n        if (args.length === 1 && args[0] === '') {\n            args.length = 0;\n        }\n        if (args.length > 0) {\n            return this.parent.formulaErrorStrings[FormulasErrorsStrings.wrong_number_arguments];\n        }\n        return Math.random().toString();\n    };\n    /** @hidden */\n    BasicFormulas.prototype.ComputeAND = function () {\n        var args = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            args[_i] = arguments[_i];\n        }\n        return this.parent.computeAndOr(args, 'and');\n    };\n    /** @hidden */\n    BasicFormulas.prototype.ComputeOR = function () {\n        var args = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            args[_i] = arguments[_i];\n        }\n        return this.parent.computeAndOr(args, 'or');\n    };\n    /** @hidden */\n    BasicFormulas.prototype.ComputeFIND = function () {\n        var args = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            args[_i] = arguments[_i];\n        }\n        if (isNullOrUndefined(args) || (args.length === 1 && args[0] === '')) {\n            return this.parent.formulaErrorStrings[FormulasErrorsStrings.wrong_number_arguments];\n        }\n        var argsList = args;\n        if (argsList.length > 3) {\n            return this.parent.formulaErrorStrings[FormulasErrorsStrings.wrong_number_arguments];\n        }\n        var findText = this.parent.removeTics(this.parent.getValueFromArg(argsList[0]));\n        var withinText = this.parent.removeTics(this.parent.getValueFromArg(argsList[1]));\n        if (this.parent.getErrorStrings().indexOf(findText) > -1 || this.parent.getErrorStrings().indexOf(withinText) > -1) {\n            return this.parent.getErrorStrings()[CommonErrors.name];\n        }\n        var startNum = 1;\n        var loc;\n        if (argsList.length === 3) {\n            startNum = this.parent.removeTics(this.parent.getValueFromArg(argsList[2]));\n            if (this.parent.getErrorStrings().indexOf(startNum) > -1) {\n                return startNum;\n            }\n            startNum = this.parent.parseFloat(startNum);\n            if (isNaN(startNum)) {\n                startNum = 1;\n            }\n        }\n        if (startNum <= 0 || startNum > withinText.length) {\n            return this.parent.getErrorStrings()[CommonErrors.value];\n        }\n        loc = withinText.indexOf(findText, startNum - 1);\n        if (loc < 0) {\n            return this.parent.getErrorStrings()[CommonErrors.value];\n        }\n        return (Number(loc) + Number(1)).toString();\n    };\n    /** @hidden */\n    BasicFormulas.prototype.ComputeINDEX = function () {\n        var range = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            range[_i] = arguments[_i];\n        }\n        var argArr = range;\n        var argCount = argArr.length;\n        if (isNullOrUndefined(range) || (argArr.length === 1 && argArr[0] === '')) {\n            return this.parent.formulaErrorStrings[FormulasErrorsStrings.wrong_number_arguments];\n        }\n        if (argCount > 3) {\n            return this.parent.getErrorStrings()[CommonErrors.ref];\n        }\n        var rangeValue = '';\n        var rangeArr = [];\n        if (argCount > 2) {\n            for (var i_2 = 0; i_2 < argCount; i_2++) {\n                if (this.parent.isCellReference(argArr[i_2]) && argArr[i_2].indexOf(':') < 0) {\n                    return this.parent.getErrorStrings()[CommonErrors.ref];\n                }\n                if (this.parent.isCellReference(argArr[i_2])) {\n                    rangeArr[i_2] = argArr[i_2];\n                }\n            }\n        }\n        rangeValue = argArr[0];\n        argArr[1] = argArr[1] === '' ? '1' : argArr[1];\n        argArr[1] = this.parent.getValueFromArg(argArr[1]);\n        if (this.parent.getErrorStrings().indexOf(argArr[1]) > -1) {\n            return argArr[1];\n        }\n        if (!isNullOrUndefined(argArr[2])) {\n            argArr[2] = argArr[2] === '' ? '1' : argArr[2];\n            argArr[2] = this.parent.getValueFromArg(argArr[2]);\n            if (this.parent.getErrorStrings().indexOf(argArr[2]) > -1) {\n                return argArr[2];\n            }\n            if (argArr[2] === '0') {\n                return this.parent.getErrorStrings()[CommonErrors.value];\n            }\n        }\n        var row = parseFloat(argArr[1]);\n        row = !isNaN(row) ? row : -1;\n        var col = parseFloat(argArr[2] ? argArr[2] : '1');\n        col = !isNaN(col) ? col : -1;\n        if (row === -1 || col === -1) {\n            return this.parent.getErrorStrings()[CommonErrors.value];\n        }\n        var i = argArr[0].indexOf(':');\n        var startRow = this.parent.rowIndex(rangeValue.substring(0, i));\n        var endRow = this.parent.rowIndex(rangeValue.substring(i + 1));\n        var startCol = this.parent.colIndex(rangeValue.substring(0, i));\n        var endCol = this.parent.colIndex(rangeValue.substring(i + 1));\n        if (row > endRow - startRow + 1 || col > endCol - startCol + 1) {\n            return this.parent.getErrorStrings()[CommonErrors.ref];\n        }\n        row = startRow + row - 1;\n        col = startCol + col - 1;\n        var cellRef = '' + this.parent.convertAlpha(col) + row;\n        var result = this.parent.getValueFromArg(cellRef);\n        if (result === '') {\n            return 0;\n        }\n        return result;\n    };\n    /** @hidden */\n    BasicFormulas.prototype.ComputeIFS = function () {\n        var range = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            range[_i] = arguments[_i];\n        }\n        var argArr = range;\n        if (isNullOrUndefined(range) || (argArr.length === 1 && argArr[0] === '')) {\n            return this.parent.formulaErrorStrings[FormulasErrorsStrings.wrong_number_arguments];\n        }\n        var condition = '';\n        var result = '';\n        for (var i = 0; i < argArr.length; i++) {\n            condition = this.parent.getValueFromArg(argArr[i]);\n            if (condition !== this.parent.trueValue && condition !== this.parent.falseValue) {\n                return this.parent.getErrorStrings()[CommonErrors.value];\n            }\n            if (condition === this.parent.trueValue) {\n                if (argArr[i + 1].indexOf(this.parent.arithMarker) > -1) {\n                    return this.parent.trueValue;\n                }\n                if (this.parent.isCellReference(argArr[i + 1].split(this.parent.tic).join(''))) {\n                    result = this.parent.getValueFromArg(argArr[i + 1]);\n                }\n                else {\n                    result = (argArr[i + 1].indexOf(this.parent.tic) > -1) ? argArr[i + 1].split(this.parent.tic).join('') :\n                        this.parent.getErrorStrings()[CommonErrors.name];\n                }\n                i = i + 1;\n                return result;\n            }\n            else if (condition === this.parent.falseValue) {\n                i = i + 1;\n            }\n        }\n        return this.parent.getErrorStrings()[CommonErrors.na];\n    };\n    /** @hidden */\n    BasicFormulas.prototype.ComputeCOUNTA = function () {\n        var args = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            args[_i] = arguments[_i];\n        }\n        if (isNullOrUndefined(args) || (args.length === 1 && args[0] === '')) {\n            return this.parent.formulaErrorStrings[FormulasErrorsStrings.wrong_number_arguments];\n        }\n        var argArr = args;\n        var cellColl;\n        var result = 0;\n        var cellValue;\n        for (var i = 0; i < argArr.length; i++) {\n            if (argArr[i].indexOf(':') > -1 && this.parent.isCellReference(argArr[i])) {\n                cellColl = this.parent.getCellCollection(argArr[i].split(this.parent.tic).join(''));\n                for (var j = 0; j < cellColl.length; j++) {\n                    cellValue = this.parent.getValueFromArg(cellColl[j]);\n                    if (cellValue.length > 0) {\n                        result++;\n                    }\n                }\n            }\n            else {\n                var cellValue_1 = this.parent.getValueFromArg(argArr[i].split(this.parent.tic).join(''));\n                if (cellValue_1.length > 0) {\n                    result++;\n                }\n            }\n        }\n        return result;\n    };\n    /** @hidden */\n    BasicFormulas.prototype.ComputeAVERAGEA = function () {\n        var args = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            args[_i] = arguments[_i];\n        }\n        if (isNullOrUndefined(args) || (args.length === 1 && args[0] === '')) {\n            return this.parent.formulaErrorStrings[FormulasErrorsStrings.wrong_number_arguments];\n        }\n        var argArrs = args;\n        var cellCol;\n        var result = 0;\n        var cellValue;\n        var length = 0;\n        var parseValue;\n        for (var k = 0; k < argArrs.length; k++) {\n            if (argArrs[k].indexOf(':') > -1 && this.parent.isCellReference(argArrs[k])) {\n                cellCol = this.parent.getCellCollection(argArrs[k].split(this.parent.tic).join(''));\n                for (var j = 0; j < cellCol.length; j++) {\n                    cellValue = this.parent.getValueFromArg(cellCol[j]);\n                    if (cellValue.toUpperCase() === this.parent.trueValue) {\n                        cellValue = '1';\n                    }\n                    else if (cellValue.toUpperCase() === this.parent.falseValue || cellValue === '') {\n                        cellValue = '0';\n                    }\n                    else if (this.parent.getErrorStrings().indexOf(cellValue) > -1) {\n                        return cellValue;\n                    }\n                    else if (cellValue.length > 0) {\n                        parseValue = parseFloat(cellValue);\n                        cellValue = !isNaN(parseValue) ? parseValue : 0;\n                        result = result + cellValue;\n                        length = length + 1;\n                    }\n                }\n                length = cellCol.length;\n            }\n            else {\n                if (argArrs[k] === this.parent.trueValue) {\n                    argArrs[k] = '1';\n                }\n                if (argArrs[k] === this.parent.falseValue || argArrs[k] === '') {\n                    argArrs[k] = '0';\n                }\n                cellValue = this.parent.getValueFromArg(argArrs[k].split(this.parent.tic).join(''));\n                if (this.parent.getErrorStrings().indexOf(cellValue) > -1) {\n                    return cellValue;\n                }\n                if (cellValue.length > 0) {\n                    parseValue = parseFloat(cellValue);\n                    cellValue = !isNaN(parseValue) ? parseValue : 0;\n                    result = result + cellValue;\n                    length = length + 1;\n                }\n            }\n            if (length === 0) {\n                return this.parent.getErrorStrings()[CommonErrors.divzero];\n            }\n        }\n        return result / length;\n    };\n    /** @hidden */\n    BasicFormulas.prototype.ComputeCOUNTIF = function () {\n        var args = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            args[_i] = arguments[_i];\n        }\n        var argArr = args;\n        if (isNullOrUndefined(args) || args[0] === '' || argArr.length < 2) {\n            return this.parent.formulaErrorStrings[FormulasErrorsStrings.wrong_number_arguments];\n        }\n        var cellColl;\n        var result = 0;\n        var cellValue;\n        var stack = [];\n        var op = 'equal';\n        var condition = argArr[1].split(this.parent.tic).join('');\n        if (condition.startsWith('<=')) {\n            op = 'lessEq';\n            condition = condition.substring(2);\n        }\n        else if (condition.startsWith('>=')) {\n            op = 'greaterEq';\n            condition = condition.substring(2);\n        }\n        else if (condition.startsWith('<>')) {\n            op = 'notEq';\n            condition = condition.substring(2);\n        }\n        else if (condition.startsWith('<')) {\n            op = 'less';\n            condition = condition.substring(1);\n        }\n        else if (condition.startsWith('>')) {\n            op = 'greater';\n            condition = condition.substring(1);\n        }\n        else if (condition.startsWith('=')) {\n            op = 'equal';\n            condition = condition.substring(1);\n        }\n        if (argArr[0].indexOf(':') > -1 && this.parent.isCellReference(argArr[0])) {\n            cellColl = this.parent.getCellCollection(argArr[0].split(this.parent.tic).join(''));\n            for (var j = 0; j < cellColl.length; j++) {\n                cellValue = this.parent.getValueFromArg(cellColl[j]);\n                if (condition.indexOf('*') > -1 || condition.indexOf('?') > -1) {\n                    cellValue = this.parent.findWildCardValue(condition, cellValue);\n                }\n                stack.push(cellValue);\n                stack.push(condition);\n                if (this.parent.processLogical(stack, op) === this.parent.trueValue) {\n                    result++;\n                }\n            }\n        }\n        return result;\n    };\n    /** @hidden */\n    BasicFormulas.prototype.ComputeSUMIFS = function () {\n        var range = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            range[_i] = arguments[_i];\n        }\n        var sum;\n        sum = this.parent.computeIfsFormulas(range, this.parent.falseValue);\n        return sum;\n    };\n    /** @hidden */\n    BasicFormulas.prototype.ComputeTEXT = function () {\n        var args = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            args[_i] = arguments[_i];\n        }\n        var checkArgs;\n        var argsLength = args.length;\n        for (var i = 0; i < argsLength; i++) {\n            if (isNullOrUndefined(checkArgs)) {\n                checkArgs = args[i];\n            }\n            else {\n                checkArgs = checkArgs + ',' + args[i];\n            }\n        }\n        var splitIndex = checkArgs.indexOf(',');\n        var frtArg = checkArgs.slice(0, splitIndex);\n        var scndArg = checkArgs.slice(checkArgs.indexOf('\"') + 1, checkArgs.length);\n        var checkScndArg = scndArg.indexOf('\"');\n        if (splitIndex > -1 && checkScndArg !== scndArg.length - 1) {\n            return this.parent.formulaErrorStrings[FormulasErrorsStrings.wrong_number_arguments];\n        }\n        var s1 = frtArg;\n        var s2 = scndArg.slice(0, scndArg.length - 1);\n        var dTime = new Date(1900, 0, 1, 0, 0, 0);\n        var checkString = s1 + ',' + s2;\n        var intl = new Internationalization();\n        if (this.parent.getErrorStrings().indexOf(checkString) > -1) {\n            return checkString;\n        }\n        s1 = this.parent.getValueFromArg(s1);\n        s2 = s2.split(this.parent.tic).join('');\n        if (s2 === '') {\n            return '';\n        }\n        if (s1 === '' && (s2.length > 0 && (s2.toUpperCase().indexOf('M') > -1 || s2.toUpperCase().indexOf('D') > -1\n            || s2.toUpperCase().indexOf('Y') > -1 || s2.toUpperCase().indexOf('S') > -1 || s2.toUpperCase().indexOf('T') > -1)\n            || s2.toUpperCase().indexOf('H') > -1)) {\n            s1 = dTime.toString();\n        }\n        var d = this.parseDouble(s1);\n        if (isNaN(d) && this.parent.isDate(new Date(s1)) !== null) {\n            d = this.parent.toOADate(new Date(s1));\n        }\n        dTime = Date.parse(s1.split(this.parent.tic).join(''));\n        if (!isNaN(d) || !isNaN(dTime)) {\n            if (s2[0] === '[') {\n                return this.parent.tic + s1 + this.parent.tic;\n            }\n            if (s2.length > 0 && (s2.toUpperCase().indexOf('M') > -1 || s2.toUpperCase().indexOf('D') > -1\n                || s2.toUpperCase().indexOf('Y') > -1 || s2.toUpperCase().indexOf('S') > -1 || s2.toUpperCase().indexOf('T') > -1)\n                || s2.toUpperCase().indexOf('H') > -1) {\n                s2 = s2.split('Y').join('y').split('D').join('d').split('H').join('h');\n                s2 = s2.split('S').join('s').split('m').join('M').split('AM/PM').join('tt');\n                var formatChar = s2.split('');\n                var isH = false;\n                var isMFound = false;\n                var isFirstM = false;\n                var i = 0;\n                var mcount = 0;\n                var lastCharIndex = 0;\n                var totalCharforM = 0;\n                for (i = 0; i < formatChar.length;) {\n                    var c = formatChar[i];\n                    if (c === 's' && formatChar[lastCharIndex] === 'M') {\n                        formatChar[lastCharIndex] = 'm';\n                        if (formatChar[lastCharIndex - 1] === 'M') {\n                            formatChar[lastCharIndex - 1] = 'm';\n                        }\n                    }\n                    if (this.parent.isChar(c)) {\n                        lastCharIndex = i;\n                        if (c === 'M') {\n                            mcount++;\n                            totalCharforM++;\n                        }\n                    }\n                    else if (totalCharforM > 1) {\n                        totalCharforM++;\n                    }\n                    if (c === 'M' && isH) {\n                        formatChar[i] = 'm';\n                        isMFound = true;\n                        isFirstM = (mcount === 1);\n                    }\n                    if (c === 'h') {\n                        isH = true;\n                    }\n                    else if (this.parent.isChar(c) && c !== 'M' && c !== 'h' && !isMFound) {\n                        isH = false;\n                        isMFound = false;\n                    }\n                    i++;\n                }\n                s2 = String(formatChar);\n                s2 = s2.split(',').join('').split('\\n').join(' ');\n                var dt = this.parent.fromOADate(d);\n                if (d === 0) {\n                    dt = dTime;\n                }\n                var getSkeleton = getSkeletonVal(s2);\n                if (getSkeleton === '') {\n                    return this.parent.getErrorStrings()[CommonErrors.name];\n                }\n                var dFormatter = intl.getDateFormat({ skeleton: getSkeleton, type: 'date' });\n                var formattedString = dFormatter(new Date(dt.toString()));\n                s1 = formattedString;\n            }\n            else {\n                s1 = intl.formatNumber(d, { format: s2 });\n            }\n        }\n        return s1;\n    };\n    /** @hidden */\n    BasicFormulas.prototype.ComputeCOUNTIFS = function () {\n        var args = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            args[_i] = arguments[_i];\n        }\n        var sum;\n        sum = this.parent.computeIfsFormulas(args, this.parent.trueValue);\n        return sum;\n    };\n    /** @hidden */\n    BasicFormulas.prototype.ComputeAVERAGEIFS = function () {\n        var args = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            args[_i] = arguments[_i];\n        }\n        var sum;\n        sum = this.parent.computeIfsFormulas(args, this.parent.falseValue, this.parent.trueValue);\n        return sum;\n    };\n    /** @hidden */\n    BasicFormulas.prototype.ComputeMATCH = function () {\n        var args = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            args[_i] = arguments[_i];\n        }\n        var argArr = args;\n        if (isNullOrUndefined(argArr) || (argArr.length === 1 && argArr[0] === '') || argArr.length < 2 || argArr.length > 3) {\n            return this.parent.formulaErrorStrings[FormulasErrorsStrings.wrong_number_arguments];\n        }\n        var cellColl;\n        var cellValue = [];\n        var lookupVal = argArr[0].split(this.parent.tic).join('');\n        argArr[2] = isNullOrUndefined(argArr[2]) ? '1' : argArr[2].split(this.parent.tic).join('');\n        if (argArr[2].split(this.parent.tic).join('') === this.parent.trueValue) {\n            argArr[2] = '1';\n        }\n        if (argArr[2].split(this.parent.tic).join('') === this.parent.falseValue) {\n            argArr[2] = '0';\n        }\n        var matchType = parseFloat(argArr[2]);\n        if (matchType !== -1 && matchType !== 0 && matchType !== 1) {\n            return this.parent.getErrorStrings()[CommonErrors.na];\n        }\n        var index = 0;\n        var indexVal = '';\n        if (argArr[1].indexOf(':') > -1 || this.parent.isCellReference(argArr[1])) {\n            cellColl = this.parent.getCellCollection(argArr[1].split(this.parent.tic).join(''));\n            for (var j = 0; j < cellColl.length; j++) {\n                cellValue[j] = this.parent.getValueFromArg(cellColl[j]).split(this.parent.tic).join('');\n            }\n            for (var i = 0; i < cellValue.length; i++) {\n                if (matchType === 1) {\n                    if (lookupVal === cellValue[i]) {\n                        return i + 1;\n                    }\n                    else if (lookupVal > cellValue[i]) {\n                        if (!indexVal) {\n                            index = i + 1;\n                            indexVal = cellValue[i];\n                        }\n                        else if (cellValue[i] > indexVal) {\n                            index = i + 1;\n                            indexVal = cellValue[i];\n                        }\n                    }\n                }\n                else if (matchType === 0) {\n                    if (lookupVal.indexOf('*') > -1 || lookupVal.indexOf('?') > -1) {\n                        cellValue[i] = this.parent.findWildCardValue(lookupVal, cellValue[i]);\n                    }\n                    if (lookupVal === cellValue[i]) {\n                        return i + 1;\n                    }\n                    if (this.parent.parseFloat(lookupVal) === this.parent.parseFloat(cellValue[i])) {\n                        return i + 1;\n                    }\n                }\n                else if (matchType === -1) {\n                    if (lookupVal === cellValue[i]) {\n                        return i + 1;\n                    }\n                    else if (lookupVal < cellValue[i]) {\n                        if (!indexVal) {\n                            index = i + 1;\n                            indexVal = cellValue[i];\n                        }\n                        else if (cellValue[i] < indexVal) {\n                            index = i + 1;\n                            indexVal = cellValue[i];\n                        }\n                    }\n                }\n            }\n        }\n        return index ? index : this.parent.getErrorStrings()[CommonErrors.na];\n    };\n    /** @hidden */\n    BasicFormulas.prototype.ComputeLOOKUP = function () {\n        var range = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            range[_i] = arguments[_i];\n        }\n        var argArr = range;\n        var result = '';\n        if (isNullOrUndefined(argArr) || (argArr.length === 1 && argArr[0] === '') || argArr.length < 2 || argArr.length > 3) {\n            return this.parent.formulaErrorStrings[FormulasErrorsStrings.wrong_number_arguments];\n        }\n        result = this.parent.computeLookup(argArr);\n        return result;\n    };\n    /** @hidden */\n    BasicFormulas.prototype.ComputeVLOOKUP = function () {\n        var range = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            range[_i] = arguments[_i];\n        }\n        var argArr = range;\n        var result = '';\n        if (isNullOrUndefined(argArr) || (argArr.length === 1 && argArr[0] === '') || argArr.length < 3 || argArr.length > 4) {\n            return this.parent.formulaErrorStrings[FormulasErrorsStrings.wrong_number_arguments];\n        }\n        result = this.parent.computeVLookup(argArr);\n        return result;\n    };\n    /** @hidden */\n    BasicFormulas.prototype.ComputeSUBTOTAL = function () {\n        var range = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            range[_i] = arguments[_i];\n        }\n        var argArr = range;\n        var result = '';\n        if (argArr.length < 2) {\n            return this.parent.formulaErrorStrings[FormulasErrorsStrings.wrong_number_arguments];\n        }\n        var formula = this.parent.parseFloat(this.parent.getValueFromArg(argArr[0].split(this.parent.tic).join('')));\n        if (isNaN(formula)) {\n            this.parent.getErrorStrings()[CommonErrors.value];\n        }\n        if ((formula < 1 || formula > 11) && (formula < 101 || formula > 111)) {\n            this.parent.getErrorStrings()[CommonErrors.value];\n        }\n        var cellRef = argArr.slice(1, argArr.length);\n        switch (formula) {\n            case 1:\n            case 101:\n                result = this.ComputeAVERAGE.apply(this, cellRef);\n                break;\n            case 2:\n            case 102:\n                result = this.ComputeCOUNT.apply(this, cellRef);\n                break;\n            case 3:\n            case 103:\n                result = this.ComputeCOUNTA.apply(this, cellRef);\n                break;\n            case 4:\n            case 104:\n                result = this.ComputeMAX.apply(this, cellRef);\n                break;\n            case 5:\n            case 105:\n                result = this.ComputeMIN.apply(this, cellRef);\n                break;\n            case 6:\n            case 106:\n                result = this.ComputePRODUCT.apply(this, cellRef);\n                break;\n            case 7:\n            case 107:\n                result = this.ComputeDAY.apply(this, cellRef);\n                break;\n            case 8:\n            case 108:\n                result = this.ComputeCONCAT.apply(this, cellRef);\n                break;\n            case 9:\n            case 109:\n                result = this.ComputeSUM.apply(this, cellRef);\n                break;\n            case 10:\n            case 110:\n                result = this.ComputeAVERAGEA.apply(this, cellRef);\n                break;\n            case 11:\n            case 111:\n                result = this.ComputeABS.apply(this, cellRef);\n                break;\n            default:\n                result = this.parent.getErrorStrings()[CommonErrors.value];\n                break;\n        }\n        return result;\n    };\n    /** @hidden */\n    BasicFormulas.prototype.ComputeRADIANS = function () {\n        var range = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            range[_i] = arguments[_i];\n        }\n        var argArr = range;\n        var result;\n        if (argArr[0] === '' || argArr.length > 1) {\n            return this.parent.formulaErrorStrings[FormulasErrorsStrings.wrong_number_arguments];\n        }\n        if (argArr[0].indexOf(':') > -1 || argArr[0].split(this.parent.tic).join('') === '') {\n            return this.parent.getErrorStrings()[CommonErrors.value];\n        }\n        var val = argArr[0].split(this.parent.tic).join('');\n        argArr[0] = isNaN(this.parent.parseFloat(val)) ? argArr[0] : val;\n        var cellvalue = this.parent.getValueFromArg(argArr[0]);\n        var radVal = this.parent.parseFloat(cellvalue);\n        if (!isNaN(radVal)) {\n            result = Math.PI * (radVal) / 180;\n        }\n        else {\n            if (cellvalue.indexOf(this.parent.tic) > -1) {\n                return this.parent.getErrorStrings()[CommonErrors.value];\n            }\n            else {\n                return this.parent.getErrorStrings()[CommonErrors.name];\n            }\n        }\n        return result;\n    };\n    /** @hidden */\n    BasicFormulas.prototype.ComputeRANDBETWEEN = function () {\n        var range = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            range[_i] = arguments[_i];\n        }\n        var argsLength = range.length;\n        var min;\n        var max;\n        var argVal;\n        if (argsLength !== 2) {\n            return this.parent.formulaErrorStrings[FormulasErrorsStrings.wrong_number_arguments];\n        }\n        for (var i = 0; i < argsLength; i++) {\n            if (range[i] === '') {\n                return this.parent.getErrorStrings()[CommonErrors.na];\n            }\n            if (range[i].indexOf(this.parent.tic) > -1) {\n                if (isNaN(parseFloat(range[i].split(this.parent.tic).join('')))) {\n                    return this.parent.getErrorStrings()[CommonErrors.value];\n                }\n                else {\n                    range[i] = range[i].split(this.parent.tic).join('');\n                }\n            }\n            argVal = parseFloat(this.parent.getValueFromArg(range[i]));\n            if (!this.parent.isCellReference(range[i])) {\n                if (isNaN(argVal)) {\n                    return this.parent.getErrorStrings()[CommonErrors.name];\n                }\n                i === 0 ? min = argVal : max = argVal;\n            }\n            else {\n                argVal = this.parent.getValueFromArg(range[i]) === '' ? 0 : argVal;\n                i === 0 ? min = argVal : max = argVal;\n                if (min === 0 && max === 0) {\n                    return '0';\n                }\n                if (isNaN(argVal)) {\n                    return this.parent.getErrorStrings()[CommonErrors.value];\n                }\n            }\n        }\n        if (max < min) {\n            return this.parent.getErrorStrings()[CommonErrors.num];\n        }\n        if (min === 0) {\n            return Math.floor(Math.random() * (max - (min - 1))) + min;\n        }\n        else {\n            return max - min === 1 ? Math.round((Math.random() * (max - min)) + min) : Math.floor(Math.random() * (max - (min - 1))) + min;\n        }\n    };\n    /** @hidden */\n    BasicFormulas.prototype.ComputeSLOPE = function () {\n        var range = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            range[_i] = arguments[_i];\n        }\n        var argArr = range;\n        if (argArr.length !== 2 || argArr[0] === '') {\n            return this.parent.formulaErrorStrings[FormulasErrorsStrings.wrong_number_arguments];\n        }\n        var yPoints;\n        var xPoints;\n        var xPointsRange = this.parent.getCellCollection(argArr[1].split(this.parent.tic).join(''));\n        var yPointsRange = this.parent.getCellCollection(argArr[0].split(this.parent.tic).join(''));\n        if (yPointsRange.length !== xPointsRange.length) {\n            return this.parent.getErrorStrings()[CommonErrors.na];\n        }\n        yPoints = this.getDataCollection(yPointsRange);\n        xPoints = this.getDataCollection(xPointsRange);\n        if (xPoints.indexOf('#NAME?') > -1 || yPoints.indexOf('#NAME?') > -1) {\n            return this.parent.getErrorStrings()[CommonErrors.name];\n        }\n        var sumXY = 0;\n        var sumX2 = 0;\n        var sumX = 0;\n        var sumY = 0;\n        for (var i = 0, len = xPoints.length; i < len; ++i) {\n            if (Number(xPoints[i]).toString() !== 'NaN' && Number(yPoints[i]).toString() !== 'NaN') {\n                sumXY += Number(xPoints[i]) * Number(yPoints[i]);\n                sumX += Number(xPoints[i]);\n                sumY += Number(yPoints[i]);\n                sumX2 += Number(xPoints[i]) * Number(xPoints[i]);\n            }\n        }\n        if ((sumXY - sumX * sumY) === 0 || (sumX2 - sumX * sumX) === 0) {\n            this.parent.getErrorStrings()[CommonErrors.divzero];\n        }\n        var result = ((sumXY - sumX * sumY / xPoints.length) / (sumX2 - sumX * sumX / xPoints.length)).toString();\n        if (result === 'NaN') {\n            return this.parent.getErrorStrings()[CommonErrors.divzero];\n        }\n        return result;\n    };\n    /** @hidden */\n    BasicFormulas.prototype.ComputeINTERCEPT = function () {\n        var range = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            range[_i] = arguments[_i];\n        }\n        var argArr = range;\n        if (argArr[0] === '' || argArr.length !== 2) {\n            return this.parent.formulaErrorStrings[FormulasErrorsStrings.wrong_number_arguments];\n        }\n        var xValues;\n        var yValues;\n        var yValuesRange = this.parent.getCellCollection(argArr[0].split(this.parent.tic).join(''));\n        var xValuesRange = this.parent.getCellCollection(argArr[1].split(this.parent.tic).join(''));\n        if (yValuesRange.length !== xValuesRange.length) {\n            return this.parent.getErrorStrings()[CommonErrors.na];\n        }\n        xValues = this.getDataCollection(xValuesRange);\n        yValues = this.getDataCollection(yValuesRange);\n        if (xValues.indexOf('#NAME?') > -1 || yValues.indexOf('#NAME?') > -1) {\n            return this.parent.getErrorStrings()[CommonErrors.name];\n        }\n        var sumX = 0;\n        var sumY = 0;\n        for (var i = 0, len = xValues.length; i < len; ++i) {\n            sumX += Number(xValues[i]);\n            sumY += Number(yValues[i]);\n        }\n        sumX = sumX / xValues.length;\n        sumY = sumY / xValues.length;\n        var sumXY = 0;\n        var sumX2 = 0;\n        var diff;\n        for (var i = 0, len = xValues.length; i < len; ++i) {\n            diff = Number(xValues[i]) - sumX;\n            sumXY += diff * (Number(yValues[i]) - sumY);\n            sumX2 += diff * diff;\n        }\n        var result = (sumY - sumXY / sumX2 * sumX).toString();\n        if ((sumY - sumXY) === 0 || (sumX2 * sumX) === 0) {\n            this.parent.getErrorStrings()[CommonErrors.divzero];\n        }\n        if (result === 'NaN') {\n            return this.parent.getErrorStrings()[CommonErrors.divzero];\n        }\n        return result;\n    };\n    /** @hidden */\n    BasicFormulas.prototype.ComputeLN = function () {\n        var logValue = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            logValue[_i] = arguments[_i];\n        }\n        var argArr = logValue;\n        var cellvalue = '';\n        var logVal;\n        var orgValue;\n        if (logValue.length === 0 || logValue.length > 1) {\n            return this.parent.formulaErrorStrings[FormulasErrorsStrings.wrong_number_arguments];\n        }\n        if (this.parent.isCellReference(argArr[0])) {\n            cellvalue = this.parent.getValueFromArg(argArr[0]);\n            logVal = this.parent.parseFloat(cellvalue);\n            if (logVal <= 0 || cellvalue === '') {\n                return this.parent.getErrorStrings()[CommonErrors.num];\n            }\n            if (isNaN(logVal)) {\n                return this.parent.getErrorStrings()[CommonErrors.value];\n            }\n        }\n        else {\n            orgValue = this.parent.getValueFromArg(argArr[0].split(this.parent.tic).join(''));\n            logVal = this.parent.parseFloat(orgValue);\n            if (logVal <= 0 || logVal.toString() === '') {\n                return this.parent.getErrorStrings()[CommonErrors.num];\n            }\n            if (isNaN(logVal)) {\n                return this.parent.getErrorStrings()[CommonErrors.value];\n            }\n        }\n        return Math.log(logVal);\n    };\n    /** @hidden */\n    BasicFormulas.prototype.ComputeISNUMBER = function () {\n        var logValue = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            logValue[_i] = arguments[_i];\n        }\n        var argArr = logValue;\n        var logVal;\n        var orgValue;\n        if (logValue.length === 0 || logValue.length > 1) {\n            return this.parent.formulaErrorStrings[FormulasErrorsStrings.wrong_number_arguments];\n        }\n        orgValue = (this.parent.isCellReference(argArr[0])) ? this.parent.getValueFromArg(argArr[0]) :\n            this.parent.getValueFromArg(argArr[0].split(this.parent.tic).join(''));\n        if (orgValue.toString() === '') {\n            return false;\n        }\n        logVal = this.parent.parseFloat(orgValue);\n        return !isNaN(logVal) ? true : false;\n    };\n    /** @hidden */\n    BasicFormulas.prototype.ComputeROUND = function () {\n        var logValue = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            logValue[_i] = arguments[_i];\n        }\n        var argArr = logValue;\n        var orgValue;\n        var x = 0;\n        var digits = 0;\n        var round;\n        var numStr;\n        var digStr;\n        var mult;\n        if (logValue.length === 0 || logValue.length > 2) {\n            return this.parent.formulaErrorStrings[FormulasErrorsStrings.wrong_number_arguments];\n        }\n        if (logValue.length === 1) {\n            orgValue = (argArr[0].split(this.parent.tic).join('') === 'TRUE')\n                ? '1'\n                : (argArr[0].split(this.parent.tic).join('') === 'FALSE')\n                    ? '0'\n                    : argArr[0];\n            return Math.round(this.parent.parseFloat(orgValue)).toString();\n        }\n        numStr = this.parent.getValueFromArg(argArr[0]);\n        digStr = (argArr[1].split(this.parent.tic).join('')) === '' ? '0' :\n            this.parent.getValueFromArg(argArr[1].split(this.parent.tic).join(''));\n        numStr = (numStr.split(this.parent.tic).join('') === 'TRUE')\n            ? '1'\n            : (numStr.split(this.parent.tic).join('') === 'FALSE')\n                ? '0' : numStr;\n        digStr = (digStr.split(this.parent.tic).join('') === 'TRUE') ? '1'\n            : (digStr.split(this.parent.tic).join('') === 'FALSE')\n                ? '0' : digStr;\n        if (numStr !== '' && digStr !== '') {\n            x = this.parent.parseFloat(numStr);\n            digits = this.parent.parseFloat(digStr);\n            if (!isNaN(digits) && !isNaN(x) && digits > 0) {\n                round = x.toFixed(digits);\n            }\n            else {\n                mult = Math.pow(10, -digits);\n                round = Math.round(x / mult) * mult;\n            }\n        }\n        return round.toString();\n    };\n    /** @hidden */\n    BasicFormulas.prototype.ComputePOWER = function () {\n        var logValue = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            logValue[_i] = arguments[_i];\n        }\n        var argArr = logValue;\n        var power;\n        var orgNumValue;\n        var orgPowValue;\n        var logNumValue;\n        var logPowValue;\n        if (logValue.length === 0 || logValue.length > 2) {\n            return this.parent.formulaErrorStrings[FormulasErrorsStrings.wrong_number_arguments];\n        }\n        orgNumValue = this.parent.getValueFromArg(argArr[0]);\n        orgPowValue = this.parent.getValueFromArg(argArr[1]);\n        orgNumValue = (orgNumValue.split(this.parent.tic).join('') === 'TRUE') ? '1' :\n            (orgNumValue.split(this.parent.tic).join('') === 'FALSE') ? '0' : orgNumValue;\n        orgPowValue = (orgPowValue.split(this.parent.tic).join('') === 'TRUE') ? '1' :\n            (orgPowValue.split(this.parent.tic).join('') === 'FALSE') ? '0' : orgPowValue;\n        logNumValue = this.parent.parseFloat(orgNumValue);\n        logPowValue = this.parent.parseFloat(orgPowValue);\n        if (!isNaN(logNumValue) && !isNaN(logPowValue)) {\n            if (logNumValue === 0 && logPowValue < 0) {\n                return this.parent.getErrorStrings()[CommonErrors.divzero];\n            }\n            if (logNumValue === 0 && logPowValue === 0) {\n                return this.parent.getErrorStrings()[CommonErrors.num];\n            }\n            power = Math.pow(logNumValue, logPowValue);\n        }\n        else {\n            return this.parent.getErrorStrings()[CommonErrors.value];\n        }\n        return power.toString();\n    };\n    /** @hidden */\n    BasicFormulas.prototype.ComputeLOG = function () {\n        var logValue = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            logValue[_i] = arguments[_i];\n        }\n        var argArr = logValue;\n        var orgNumValue;\n        var orgBaseValue;\n        var logNumValue;\n        var logBaseValue;\n        if (logValue.length === 0 || logValue.length > 2) {\n            return this.parent.formulaErrorStrings[FormulasErrorsStrings.wrong_number_arguments];\n        }\n        orgNumValue = this.parent.getValueFromArg(argArr[0]);\n        orgBaseValue = (logValue.length === 2) ? this.parent.getValueFromArg(argArr[1]) : '10';\n        if ((orgNumValue === '' || orgNumValue === null) || (orgBaseValue === '' || orgBaseValue === null)) {\n            return this.parent.getErrorStrings()[CommonErrors.num];\n        }\n        orgNumValue = (orgNumValue.split(this.parent.tic).join('') === 'TRUE') ? '1' :\n            (orgNumValue.split(this.parent.tic).join('') === 'FALSE') ? '0' : orgNumValue;\n        orgBaseValue = (orgBaseValue.split(this.parent.tic).join('') === 'TRUE') ? '1' :\n            (orgBaseValue.split(this.parent.tic).join('') === 'FALSE') ? '0' : orgBaseValue;\n        logNumValue = this.parent.parseFloat(orgNumValue);\n        logBaseValue = this.parent.parseFloat(orgBaseValue);\n        if (logNumValue <= 0 || logBaseValue <= 0) {\n            return this.parent.getErrorStrings()[CommonErrors.num];\n        }\n        if (logBaseValue === 1) {\n            return this.parent.getErrorStrings()[CommonErrors.divzero];\n        }\n        if (!isNaN(logNumValue) && !isNaN(logBaseValue)) {\n            return ((Math.log(logNumValue) / Math.LN10) / (Math.log(logBaseValue) / Math.LN10)).toString();\n        }\n        else {\n            return this.parent.getErrorStrings()[CommonErrors.value];\n        }\n    };\n    /** @hidden */\n    BasicFormulas.prototype.ComputeTRUNC = function () {\n        var logValue = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            logValue[_i] = arguments[_i];\n        }\n        var argArr = logValue;\n        var orgNumValue;\n        var orgDigitValue = 0;\n        var logNumValue;\n        var logDigitValue;\n        var normalizer;\n        if (logValue.length === 0 || logValue.length > 2) {\n            return this.parent.formulaErrorStrings[FormulasErrorsStrings.wrong_number_arguments];\n        }\n        if (logValue.length === 2) {\n            orgDigitValue = this.parent.getValueFromArg(argArr[1]);\n            orgDigitValue = (orgDigitValue.split(this.parent.tic).join('') === 'TRUE') ? '1' :\n                (orgDigitValue.split(this.parent.tic).join('') === 'FALSE') ? '0' : orgDigitValue;\n            orgDigitValue = this.parent.parseFloat(orgDigitValue);\n        }\n        orgNumValue = this.parent.getValueFromArg(argArr[0]);\n        orgNumValue = (orgNumValue.split(this.parent.tic).join('') === 'TRUE') ? '1' :\n            (orgNumValue.split(this.parent.tic).join('') === 'FALSE') ? '0' : orgNumValue;\n        logNumValue = this.parent.parseFloat(orgNumValue.split(this.parent.tic).join(''));\n        if (isNaN(logNumValue) || isNaN(orgDigitValue)) {\n            return (argArr[0] === this.parent.tic || this.parent.isCellReference(argArr[0]) || (argArr[1] === this.parent.tic\n                || this.parent.isCellReference(argArr[1]))) ? this.parent.getErrorStrings()[CommonErrors.value]\n                : this.parent.getErrorStrings()[CommonErrors.name];\n        }\n        normalizer = Math.pow(10, orgDigitValue);\n        logDigitValue = (logNumValue < 0) ? -1 : 1;\n        return (logDigitValue * Math.floor(normalizer * Math.abs(logNumValue)) / normalizer).toString();\n    };\n    /** @hidden */\n    BasicFormulas.prototype.ComputeEXP = function () {\n        var logValue = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            logValue[_i] = arguments[_i];\n        }\n        var argArr = logValue;\n        var orgNumValue;\n        var logNumValue;\n        if (logValue.length === 0 || logValue.length > 1) {\n            return this.parent.formulaErrorStrings[FormulasErrorsStrings.wrong_number_arguments];\n        }\n        orgNumValue = this.parent.getValueFromArg(argArr[0]);\n        orgNumValue = (orgNumValue.split(this.parent.tic).join('') === 'TRUE') ? '1' :\n            (orgNumValue.split(this.parent.tic).join('') === 'FALSE') ? '0' : orgNumValue;\n        if (orgNumValue === '') {\n            orgNumValue = '0';\n        }\n        logNumValue = this.parent.parseFloat(orgNumValue);\n        if (logNumValue > 709) {\n            return this.parent.getErrorStrings()[CommonErrors.num];\n        }\n        if (isNaN(logNumValue)) {\n            return (argArr[0] === this.parent.tic || this.parent.isCellReference(argArr[0])) ?\n                this.parent.getErrorStrings()[CommonErrors.value]\n                : this.parent.getErrorStrings()[CommonErrors.name];\n        }\n        return Math.exp(logNumValue).toString();\n    };\n    /** @hidden */\n    BasicFormulas.prototype.ComputeGEOMEAN = function () {\n        var logValue = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            logValue[_i] = arguments[_i];\n        }\n        var argArr = logValue;\n        var sum = 1;\n        var count = 0;\n        var cellVal = 0;\n        var dev;\n        var r;\n        var s;\n        var cell;\n        if (logValue.length === 0) {\n            return this.parent.formulaErrorStrings[FormulasErrorsStrings.wrong_number_arguments];\n        }\n        for (r = 0; r < argArr.length; r++) {\n            if (argArr[r].indexOf(':') > -1) {\n                if (argArr[0] === this.parent.tic) {\n                    return this.parent.getErrorStrings()[CommonErrors.value];\n                }\n                cell = this.parent.getCellCollection(argArr[r].split(this.parent.tic).join(''));\n                for (s = 0; s < cell.length; s++) {\n                    cellVal = this.parent.getValueFromArg(cell[s]);\n                    cellVal = (cellVal.split(this.parent.tic).join('') === 'TRUE') ? '1' :\n                        (cellVal.split(this.parent.tic).join('') === 'FALSE') ? '0' : cellVal;\n                    dev = this.parent.parseFloat(cellVal);\n                    if (dev <= 0) {\n                        return this.parent.getErrorStrings()[CommonErrors.num];\n                    }\n                    else if (!isNaN(dev)) {\n                        count++;\n                        sum = sum * dev;\n                    }\n                }\n            }\n            else {\n                cellVal = this.parent.getValueFromArg(argArr[r]);\n                if (cellVal.length > 0) {\n                    cellVal = (cellVal.split(this.parent.tic).join('') === 'TRUE') ? '1' :\n                        (cellVal.split(this.parent.tic).join('') === 'FALSE') ? '0' : cellVal;\n                    if (!this.parent.isCellReference(argArr[r])) {\n                        if (isNaN(this.parent.parseFloat(cellVal))) {\n                            return this.parent.getErrorStrings()[CommonErrors.name];\n                        }\n                    }\n                    dev = this.parent.parseFloat(cellVal);\n                    if (dev <= 0) {\n                        return this.parent.getErrorStrings()[CommonErrors.num];\n                    }\n                    else if (!isNaN(dev)) {\n                        count++;\n                        sum = sum * dev;\n                    }\n                }\n            }\n        }\n        if (count > 0) {\n            sum = Math.pow(sum, 1 / count);\n        }\n        return sum.toString();\n    };\n    BasicFormulas.prototype.getDataCollection = function (cells) {\n        var cellsData = [];\n        for (var i = 0, len = cells.length; i < len; i++) {\n            cellsData.push(this.parent.getValueFromArg(cells[i]));\n        }\n        return cellsData;\n    };\n    /** @hidden */\n    BasicFormulas.prototype.parseDouble = function (value) {\n        var val = this.parent.parseFloat(value.toString());\n        return !isNaN(val) ? val : NaN;\n    };\n    ;\n    BasicFormulas.prototype.getModuleName = function () {\n        return 'basic-formulas';\n    };\n    return BasicFormulas;\n}());\nexport { BasicFormulas };\n","import { FormulaError } from './index';\nimport { CommonErrors, FormulasErrorsStrings } from '../common/index';\nimport { isNullOrUndefined } from '@syncfusion/ej2-base';\nvar Parser = /** @class */ (function () {\n    function Parser(parent) {\n        this.emptyStr = '';\n        this.storedStringText = this.emptyStr;\n        this.sheetToken = '!';\n        /** @hidden */\n        this.tokenAdd = 'a';\n        /** @hidden */\n        this.tokenSubtract = 's';\n        /** @hidden */\n        this.tokenMultiply = 'm';\n        /** @hidden */\n        this.tokenDivide = 'd';\n        /** @hidden */\n        this.tokenLess = 'l';\n        this.charEm = 'r';\n        this.charEp = 'x';\n        /** @hidden */\n        this.tokenGreater = 'g';\n        /** @hidden */\n        this.tokenEqual = 'e';\n        /** @hidden */\n        this.tokenLessEq = 'k';\n        /** @hidden */\n        this.tokenGreaterEq = 'j';\n        /** @hidden */\n        this.tokenNotEqual = 'o';\n        /** @hidden */\n        this.tokenAnd = 'c';\n        this.tokenEm = 'v';\n        this.tokenEp = 't';\n        /** @hidden */\n        this.tokenOr = String.fromCharCode(126);\n        this.charAnd = 'i';\n        this.charLess = '<';\n        this.charGreater = '>';\n        this.charEqual = '=';\n        this.charLessEq = 'f';\n        this.charGreaterEq = 'h';\n        this.charNoEqual = 'z';\n        this.stringGreaterEq = '>=';\n        this.stringLessEq = '<=';\n        this.stringNoEqual = '<>';\n        this.stringAnd = '&';\n        this.stringOr = '^';\n        this.charOr = 'w';\n        this.charAdd = '+';\n        this.charSubtract = '-';\n        this.charMultiply = '*';\n        this.charDivide = '/';\n        this.fixedReference = '$';\n        this.spaceString = ' ';\n        this.ignoreBracet = false;\n        /** @hidden */\n        this.isError = false;\n        /** @hidden */\n        this.isFormulaParsed = false;\n        this.findNamedRange = false;\n        this.stringsColl = new Map();\n        this.tokens = [\n            this.tokenAdd, this.tokenSubtract, this.tokenMultiply, this.tokenDivide, this.tokenLess,\n            this.tokenGreater, this.tokenEqual, this.tokenLessEq, this.tokenGreaterEq, this.tokenNotEqual, this.tokenAnd, this.tokenOr\n        ];\n        this.charNOTop = String.fromCharCode(167);\n        this.specialSym = ['~', '@', '#', '?'];\n        this.isFailureTriggered = false;\n        this.parent = parent;\n    }\n    /** @hidden */\n    Parser.prototype.parse = function (text, fkey) {\n        if (this.parent.isTextEmpty(text)) {\n            return text;\n        }\n        if (this.parent.getFormulaCharacter() !== String.fromCharCode(0) && this.parent.getFormulaCharacter() === text[0]) {\n            text = text.substring(1);\n        }\n        if (this.parent.namedRanges.size > 0 || this.parent.storedData.size > 0) {\n            text = this.checkForNamedRangeAndKeyValue(text);\n            this.findNamedRange = false;\n        }\n        text = text.split('-+').join('-');\n        text = text.split('--').join('+');\n        text = text.split('+-').join('-');\n        text = text.split('-' + '(' + '-').join('(');\n        var formulaString = this.storeStrings(text);\n        text = this.storedStringText;\n        var i = 0;\n        if (isNullOrUndefined(formulaString)) {\n            text = text.split(' ').join('');\n        }\n        text = text.split('=>').join('>=');\n        text = text.split('=<').join('<=');\n        if (text[text.length - 1] !== this.parent.arithMarker || this.indexOfAny(text, this.tokens) !== (text.length - 2)) {\n            text = text.toUpperCase();\n        }\n        if (text.indexOf(this.sheetToken) > -1) {\n            var family = this.parent.getSheetFamilyItem(this.parent.grid);\n            if (family.sheetNameToParentObject != null && family.sheetNameToParentObject.size > 0) {\n                if (text[0] !== this.sheetToken.toString()) {\n                    text = this.parent.setTokensForSheets(text);\n                }\n                var sheetToken = this.parent.getSheetToken(text.split(this.parent.tic).join(this.emptyStr));\n                var scopedRange = this.checkScopedRange(text.split('\"').join(this.emptyStr).split(this.sheetToken).join(''));\n                if (isNullOrUndefined(sheetToken) && sheetToken !== '' && this.parent.namedRanges.size > 0 && scopedRange !== '') {\n                    text = scopedRange;\n                }\n            }\n        }\n        text = this.markLibraryFormulas(text);\n        try {\n            text = this.formulaAutoCorrection(text);\n        }\n        catch (ex) {\n            var args = {\n                message: ex.message, exception: ex, isForceCalculable: ex.formulaCorrection,\n                computeForceCalculate: false\n            };\n            if (!args.isForceCalculable) {\n                throw this.parent.formulaErrorStrings[FormulasErrorsStrings.invalid_expression];\n            }\n            if (!this.isFailureTriggered) {\n                this.parent.trigger('onFailure', args);\n                this.isFailureTriggered = true;\n            }\n            if (args.isForceCalculable && args.computeForceCalculate) {\n                text = this.formulaAutoCorrection(text, args);\n                this.parent.storedData.get(fkey).formulaText = '=' + text;\n            }\n            else {\n                throw this.parent.formulaErrorStrings[FormulasErrorsStrings.invalid_expression];\n            }\n        }\n        if (!this.ignoreBracet) {\n            i = text.indexOf(')');\n            while (i > -1) {\n                var k = text.substring(0, i).lastIndexOf('(');\n                if (k === -1) {\n                    throw new FormulaError(this.parent.formulaErrorStrings[FormulasErrorsStrings.mismatched_parentheses]);\n                }\n                if (k === i - 1) {\n                    throw new FormulaError(this.parent.formulaErrorStrings[FormulasErrorsStrings.empty_expression]);\n                }\n                var s = this.emptyStr;\n                if (this.ignoreBracet) {\n                    s = this.parent.substring(text, k, i - k + 1);\n                }\n                else {\n                    s = this.parent.substring(text, k + 1, i - k - 1);\n                }\n                try {\n                    text = text.substring(0, k) + this.parseSimple(s) + text.substring(i + 1);\n                }\n                catch (ex) {\n                    var args = this.exceptionArgs(ex);\n                    if (!this.isFailureTriggered) {\n                        this.parent.trigger('onFailure', args);\n                        this.isFailureTriggered = true;\n                    }\n                    var errorMessage = (typeof args.exception === 'string') ? args.exception : args.message;\n                    return (this.parent.getErrorLine(ex) ? '' : '#' + this.parent.getErrorLine(ex) + ': ') + errorMessage;\n                }\n                i = text.indexOf(')');\n            }\n        }\n        if (!this.ignoreBracet && text.indexOf('(') > -1) {\n            throw new FormulaError(this.parent.formulaErrorStrings[FormulasErrorsStrings.mismatched_parentheses]);\n        }\n        text = this.parseSimple(text);\n        if (formulaString !== null && formulaString.size > 0) {\n            text = this.setStrings(text, formulaString);\n        }\n        return text;\n    };\n    /* tslint:disable-next-line:no-any */\n    Parser.prototype.exceptionArgs = function (ex) {\n        return {\n            message: ex.message, exception: ex, isForceCalculable: ex.formulaCorrection,\n            computeForceCalculate: false\n        };\n    };\n    Parser.prototype.formulaAutoCorrection = function (formula, args) {\n        var arithemeticArr = ['*', '+', '-', '/', '^', '&'];\n        var logicalSym = ['>', '=', '<'];\n        var i = 0;\n        var form = '';\n        var op = '';\n        var firstOp = '';\n        var secondprevOp = '';\n        var secondnextOp = '';\n        var firstDigit = '';\n        var secondDigit = '';\n        var countDigit = 0;\n        if (this.parent.formulaErrorStrings.indexOf(formula) > -1) {\n            return formula;\n        }\n        else {\n            if (this.indexOfAny(formula, this.specialSym) > -1) {\n                throw new FormulaError(this.parent.formulaErrorStrings[FormulasErrorsStrings.invalid_expression], false);\n            }\n            while (i < formula.length) {\n                formula = formula.split('-*').join('-').split('/*').join('/').split('*/').join('*').split('-/').join('-').\n                    split('*+').join('*').split('+*').join('+');\n                if (formula.indexOf('*-') > -1 || formula.indexOf('/-') > -1) {\n                    formula = '-' + formula.split('*-').join('*').split('/-').join('/');\n                }\n                if ((this.parent.isDigit(formula[i]) && ((formula.length > i + 1)\n                    && (this.indexOfAny(formula[i + 1], arithemeticArr) > -1)) && ((formula.length > i + 2)\n                    && (!isNullOrUndefined(formula[i + 2]) && this.indexOfAny(formula[i + 2], arithemeticArr) > -1)))) {\n                    if (isNullOrUndefined(args)) {\n                        throw new FormulaError(this.parent.formulaErrorStrings[FormulasErrorsStrings.invalid_expression], true);\n                    }\n                    if (args.computeForceCalculate) {\n                        if (this.parent.isDigit(formula[i])) {\n                            if (countDigit < 1) {\n                                firstDigit = formula[i];\n                                firstOp = formula[i + 1];\n                                if (isNullOrUndefined(firstOp)) {\n                                    firstOp = this.emptyStr;\n                                }\n                                firstOp = firstOp === '&' ? '' : firstOp;\n                                countDigit = countDigit + 1;\n                                form = form + firstDigit + firstOp;\n                            }\n                            else if (countDigit < 2) {\n                                secondDigit = formula[i];\n                                secondprevOp = formula[i - 1];\n                                secondnextOp = formula[i + 1];\n                                countDigit = 0;\n                                if (secondprevOp === '-') {\n                                    secondnextOp = isNullOrUndefined(secondnextOp) ? this.emptyStr : secondnextOp;\n                                    secondnextOp = secondnextOp === '&' ? '' : secondnextOp;\n                                    form = form + secondprevOp + secondDigit + secondnextOp;\n                                }\n                                else {\n                                    secondnextOp = isNullOrUndefined(secondnextOp) ? this.emptyStr : secondnextOp;\n                                    form = form + secondDigit + secondnextOp;\n                                }\n                            }\n                            i = i + 2;\n                        }\n                        else {\n                            form = (formula[i] === '-') ? form + formula[i] : form;\n                            i = i + 1;\n                        }\n                    }\n                    else {\n                        throw this.parent.formulaErrorStrings[FormulasErrorsStrings.improper_formula];\n                    }\n                    /* tslint:disable-next-line */\n                }\n                else if ((this.parent.isDigit(formula[i]) || formula[i] === this.parent.rightBracket || this.parent.storedData.has(formula[i].toUpperCase())) && (isNullOrUndefined(formula[i + 1]) || this.indexOfAny(formula[i + 1], arithemeticArr)) > -1) {\n                    op = isNullOrUndefined(formula[i + 1]) ? this.emptyStr : formula[i + 1];\n                    op = op === '&' ? '' : op;\n                    form = formula[i - 1] === '-' ? form + formula[i - 1] + formula[i] + op : form + formula[i] + op;\n                    i = i + 2;\n                    /* tslint:disable-next-line */\n                }\n                else if (this.indexOfAny(formula[i], logicalSym) > -1 && !isNullOrUndefined(formula[i - 1]) && !isNullOrUndefined(formula[i + 1])) {\n                    form = form + formula[i];\n                    i = i + 1;\n                }\n                else if (formula[i] === 'q') {\n                    while (formula[i] !== this.parent.leftBracket) {\n                        form = form + formula[i];\n                        i = i + 1;\n                    }\n                    /* tslint:disable-next-line */\n                }\n                else if (formula[i] === this.parent.leftBracket || formula[i] === this.parent.rightBracket || formula[i] === '{' || formula[i] === '}' || formula[i] === '(' || formula[i] === ')') {\n                    form = form + formula[i];\n                    i = i + 1;\n                    /* tslint:disable-next-line */\n                }\n                else if (this.parent.isUpperChar(formula[i]) || formula[i].indexOf(':') > -1 || formula[i] === this.parent.getParseArgumentSeparator() || ((formula[i] === '%') && (this.parent.isDigit(formula[i - 1])))) {\n                    form = form + formula[i];\n                    i = i + 1;\n                }\n                else if (formula[i] === this.parent.tic || formula[i] === ' ' || formula[i] === '.' || formula[i] === this.sheetToken ||\n                    formula[i] === '$') {\n                    form = form + formula[i];\n                    i = i + 1;\n                }\n                else {\n                    if (this.parent.isDigit(formula[i])) {\n                        form = formula[i - 1] === '-' ? form + formula[i - 1] + formula[i] : form + formula[i];\n                    }\n                    if (formula[i] === '-' || formula[i] === '+') {\n                        form = form + formula[i];\n                        form = form.split('++').join('+').split('+-').join('-').split('-+').join('-');\n                    }\n                    if (formula[i] === '/' || formula[i] === '*') {\n                        form = form + formula[i];\n                    }\n                    i = i + 1;\n                }\n            }\n        }\n        form = form === this.emptyStr ? formula : form;\n        if (this.indexOfAny(form[form.length - 1], arithemeticArr) > -1) {\n            form = form.substring(0, form.length - 1);\n        }\n        form = form.split('--').join('-').split('-+').join('-').split('+-').join('-');\n        return form;\n    };\n    Parser.prototype.checkScopedRange = function (text) {\n        var _this = this;\n        var scopedRange = this.emptyStr;\n        var b = 'NaN';\n        var id = this.parent.getSheetID(this.parent.grid);\n        var sheet = this.parent.getSheetFamilyItem(this.parent.grid);\n        if (text[0] === this.sheetToken.toString()) {\n            var i = text.indexOf(this.sheetToken, 1);\n            var v = parseInt(text.substr(1, i - 1), 10);\n            if (i > 1 && !this.parent.isNaN(v)) {\n                text = text.substring(i + 1);\n                id = v;\n            }\n        }\n        var token = '!' + id.toString() + '!';\n        if (sheet === null || sheet.sheetNameToToken == null) {\n            return b;\n        }\n        sheet.sheetNameToToken.forEach(function (value, key) {\n            if (sheet.sheetNameToToken.get(key).toString() === token) {\n                var s_1 = _this.emptyStr;\n                _this.parent.namedRanges.forEach(function (value, key) {\n                    /* tslint:disable-next-line:no-any */\n                    if (!isNullOrUndefined(_this.parent.parentObject)) {\n                        /* tslint:disable-next-line:no-any */\n                        s_1 = (_this.parent.parentObject.getActiveSheet().name + _this.sheetToken + text).toUpperCase();\n                    }\n                    else {\n                        s_1 = sheet.sheetNameToToken.get(key).toUpperCase();\n                    }\n                    if (_this.parent.getNamedRanges().has(s_1)) {\n                        scopedRange = (_this.parent.getNamedRanges().get(s_1)).toUpperCase();\n                        b = scopedRange;\n                    }\n                });\n            }\n        });\n        return b;\n    };\n    Parser.prototype.storeStrings = function (tempString) {\n        var i = 0;\n        var j = 0;\n        var id = 0;\n        var key = '';\n        var storedString = null;\n        var condition;\n        var ticLoc = tempString.indexOf(this.parent.tic);\n        if (ticLoc > -1) {\n            i = tempString.indexOf(this.parent.tic);\n            while (i > -1 && tempString.length > 0) {\n                if (storedString === null) {\n                    storedString = this.stringsColl;\n                }\n                j = i + 1 < tempString.length ? tempString.indexOf(this.parent.tic, i + 1) : -1;\n                if (j === -1) {\n                    throw new FormulaError(this.parent.formulaErrorStrings[FormulasErrorsStrings.mismatched_tics]);\n                }\n                condition = this.parent.substring(tempString, i, j - i + 1);\n                key = this.parent.tic + this.spaceString + id.toString() + this.parent.tic;\n                storedString = storedString.set(key, condition);\n                tempString = tempString.substring(0, i) + key + tempString.substring(j + 1);\n                i = i + key.length;\n                if (i < tempString.length) {\n                    i = tempString.indexOf(this.parent.tic, i);\n                }\n                id++;\n            }\n        }\n        this.storedStringText = tempString;\n        return storedString;\n    };\n    Parser.prototype.setStrings = function (text, formulaString) {\n        for (var i = 0; i < formulaString.size; i++) {\n            formulaString.forEach(function (value, key) {\n                text = text.split(key).join(value);\n            });\n        }\n        return text;\n    };\n    /** @hidden */\n    Parser.prototype.parseSimple = function (formulaText) {\n        var needToContinue = true;\n        var text = formulaText;\n        if (text.length > 0 && text[0] === '+') {\n            text = text.substring(1);\n        }\n        if (text === '#DIV/0!') {\n            return '#DIV/0!';\n        }\n        if (text === '#NAME?') {\n            return '#NAME?';\n        }\n        if (text === '') {\n            return text;\n        }\n        if (this.parent.formulaErrorStrings.indexOf(text) > -1) {\n            return text;\n        }\n        text = text.split(this.stringLessEq).join(this.charLessEq);\n        text = text.split(this.stringGreaterEq).join(this.charGreaterEq);\n        text = text.split(this.stringNoEqual).join(this.charNoEqual);\n        text = text.split(this.stringAnd).join(this.charAnd);\n        text = text.split(this.stringOr).join(this.charOr);\n        text = text.split(this.fixedReference).join(this.emptyStr);\n        needToContinue = true;\n        var expTokenArray = [this.tokenEp, this.tokenEm];\n        var mulTokenArray = [this.tokenMultiply, this.tokenDivide];\n        var addTokenArray = [this.tokenAdd, this.tokenSubtract];\n        var mulCharArray = [this.charMultiply, this.charDivide];\n        var addCharArray = [this.charAdd, this.charSubtract];\n        var compareTokenArray = [this.tokenLess, this.tokenGreater, this.tokenEqual, this.tokenLessEq,\n            this.tokenGreaterEq, this.tokenNotEqual];\n        var compareCharArray = [this.charLess, this.charGreater, this.charEqual, this.charLessEq,\n            this.charGreaterEq, this.charNoEqual];\n        var expCharArray = [this.charEp, this.charEm];\n        var andTokenArray = [this.tokenAnd];\n        var andCharArray = [this.charAnd];\n        var orCharArray = [this.charOr];\n        var orTokenArray = [this.tokenOr];\n        text = this.parseSimpleOperators(text, expTokenArray, expCharArray);\n        text = this.parseSimpleOperators(text, orTokenArray, orCharArray);\n        if (needToContinue) {\n            text = this.parseSimpleOperators(text, mulTokenArray, mulCharArray);\n        }\n        if (needToContinue) {\n            text = this.parseSimpleOperators(text, addTokenArray, addCharArray);\n        }\n        if (needToContinue) {\n            text = this.parseSimpleOperators(text, compareTokenArray, compareCharArray);\n        }\n        if (needToContinue) {\n            text = this.parseSimpleOperators(text, andTokenArray, andCharArray);\n        }\n        return text;\n    };\n    /** @hidden */\n    // tslint:disable-next-line:max-func-body-length\n    Parser.prototype.parseSimpleOperators = function (formulaText, markers, operators) {\n        if (this.parent.getErrorStrings().indexOf(formulaText) > -1) {\n            return formulaText;\n        }\n        var text = formulaText;\n        var i = 0;\n        var op = '';\n        for (var c = 0; c < operators.length; c++) {\n            op = op + operators[c];\n        }\n        /* tslint:disable */\n        text = text.split(\"---\").join(\"-\").split(\"--\").join(\"+\").split(this.parent.getParseArgumentSeparator() + \"-\").join(this.parent.getParseArgumentSeparator() + \"u\").split(this.parent.leftBracket + \"-\").join(this.parent.leftBracket + \"u\").split(\"=-\").join(\"=u\");\n        text = text.split(',+').join(',').split(this.parent.leftBracket + '+').join(this.parent.leftBracket).split('=+').join('=').split('>+').join('>').split('<+').join('<').split('/+').join('/').split('*+').join('*').split('++').join('+').split(\"*-\").join(\"*u\").toString();\n        ;\n        /* tslint:enable */\n        if (text.length > 0 && text[0] === '-') {\n            text = text.substring(1).split('-').join(this.tokenOr);\n            text = '0-' + text;\n            text = this.parseSimpleOperators(text, [this.tokenSubtract], [this.charSubtract]);\n            text = text.split(this.tokenOr).join('-');\n        }\n        else if (text.length > 0 && text[0] === '+') {\n            text = text.substring(1);\n        }\n        else if (text.length > 0 && text[text.length - 1] === '+') {\n            text = text.substring(0, text.length - 1);\n        }\n        try {\n            if (this.indexOfAny(text, operators) > -1) {\n                i = this.indexOfAny(text, operators);\n                while (i > -1) {\n                    var left = '';\n                    var right = '';\n                    var leftIndex = 0;\n                    var rightIndex = 0;\n                    var isNotOperator = text[i] === this.charNOTop;\n                    var j = 0;\n                    if (!isNotOperator) {\n                        j = i - 1;\n                        if (text[j] === this.parent.arithMarker) {\n                            var k = this.findLeftMarker(text.substring(0, j - 1));\n                            if (k < 0) {\n                                throw new FormulaError(this.parent.formulaErrorStrings[FormulasErrorsStrings.cannot_parse]);\n                            }\n                            left = this.parent.substring(text, k + 1, j - k - 1);\n                            leftIndex = k + 1;\n                        }\n                        else if (text[j] === this.parent.rightBracket) {\n                            var bracketCount = 0;\n                            var k = j - 1;\n                            while (k > 0 && (text[k] !== 'q' || bracketCount !== 0)) {\n                                if (text[k] === 'q') {\n                                    bracketCount--;\n                                }\n                                else if (text[k] === this.parent.rightBracket) {\n                                    bracketCount++;\n                                }\n                                k--;\n                            }\n                            if (k < 0) {\n                                throw new FormulaError(this.parent.formulaErrorStrings[FormulasErrorsStrings.cannot_parse]);\n                            }\n                            left = this.parent.substring(text, k, j - k + 1);\n                            leftIndex = k;\n                        }\n                        else if (text[j] === this.parent.tic[0]) {\n                            var l = text.substring(0, j - 1).lastIndexOf(this.parent.tic);\n                            if (l < 0) {\n                                throw new FormulaError(this.parent.formulaErrorStrings[FormulasErrorsStrings.cannot_parse]);\n                            }\n                            left = this.parent.substring(text, l, j - l + 1);\n                            leftIndex = l;\n                        }\n                        else {\n                            var period = false;\n                            while (j > -1 && (this.parent.isDigit(text[j]) ||\n                                (!period && text[j] === this.parent.getParseDecimalSeparator()))) {\n                                if (text[j] === this.parent.getParseDecimalSeparator()) {\n                                    period = true;\n                                }\n                                j = j - 1;\n                            }\n                            if (j > -1 && period && text[j] === this.parent.getParseDecimalSeparator()) {\n                                /* tslint:disable-next-line */\n                                throw new FormulaError(this.parent.formulaErrorStrings[FormulasErrorsStrings.number_contains_2_decimal_points]);\n                            }\n                            j = j + 1;\n                            if (j === 0 || (j > 0 && !this.parent.isUpperChar(text[j - 1]))) {\n                                left = 'n' + this.parent.substring(text, j, i - j);\n                                leftIndex = j;\n                            }\n                            else {\n                                j = j - 1;\n                                while (j > -1 && (this.parent.isUpperChar(text[j]) || this.parent.isDigit(text[j]))) {\n                                    j = j - 1;\n                                }\n                                if (j > -1 && text[j] === this.sheetToken) {\n                                    j = j - 1;\n                                    while (j > -1 && text[j] !== this.sheetToken) {\n                                        j = j - 1;\n                                    }\n                                    if (j > -1 && text[j] === this.sheetToken) {\n                                        j = j - 1;\n                                    }\n                                }\n                                if (j > -1 && text[j] === ':') {\n                                    //// handle range operands\n                                    j = j - 1;\n                                    while (j > -1 && this.parent.isDigit(text[j])) {\n                                        j = j - 1;\n                                    }\n                                    while (j > -1 && this.parent.isUpperChar(text[j])) {\n                                        j = j - 1;\n                                    }\n                                    if (j > -1 && text[j] === this.sheetToken) {\n                                        j--;\n                                        while (j > -1 && text[j] !== this.sheetToken) {\n                                            j--;\n                                        }\n                                        if (j > -1 && text[j] === this.sheetToken) {\n                                            j--;\n                                        }\n                                    }\n                                    j = j + 1;\n                                    left = this.parent.substring(text, j, i - j);\n                                    left = this.parent.getCellFrom(left);\n                                }\n                                else {\n                                    j = j + 1;\n                                    left = this.parent.substring(text, j, i - j);\n                                }\n                                this.parent.updateDependentCell(left);\n                                leftIndex = j;\n                            }\n                            if ((this.parent.namedRanges.size > 0 && this.parent.namedRanges.has(left.toUpperCase())) ||\n                                (this.parent.storedData.has(left.toUpperCase()))) {\n                                left = 'n' + this.checkForNamedRangeAndKeyValue(left);\n                            }\n                        }\n                    }\n                    else {\n                        leftIndex = i;\n                    }\n                    if (i === text.length - 1) {\n                        /* tslint:disable-next-line */\n                        throw new FormulaError(this.parent.formulaErrorStrings[FormulasErrorsStrings.expression_cannot_end_with_an_operator]);\n                    }\n                    else {\n                        j = i + 1;\n                        var uFound = text[j] === 'u'; // for 3*-2\n                        if (uFound) {\n                            j = j + 1;\n                        }\n                        if (text[j] === this.parent.tic[0]) {\n                            var k = text.substring(j + 1).indexOf(this.parent.tic);\n                            if (k < 0) {\n                                throw this.parent.formulaErrorStrings[FormulasErrorsStrings.cannot_parse];\n                            }\n                            right = this.parent.substring(text, j, k + 2);\n                            rightIndex = k + j + 2;\n                        }\n                        else if (text[j] === this.parent.arithMarker) {\n                            var k = this.findRightMarker(text.substring(j + 1));\n                            if (k < 0) {\n                                throw new FormulaError(this.parent.formulaErrorStrings[FormulasErrorsStrings.cannot_parse]);\n                            }\n                            right = this.parent.substring(text, j + 1, k);\n                            rightIndex = k + j + 2;\n                        }\n                        else if (text[j] === 'q') {\n                            var bracketCount = 0;\n                            var k = j + 1;\n                            while (k < text.length && (text[k] !== this.parent.rightBracket || bracketCount !== 0)) {\n                                if (text[k] === this.parent.rightBracket) {\n                                    bracketCount++;\n                                }\n                                else if (text[k] === 'q') {\n                                    bracketCount--;\n                                }\n                                k++;\n                            }\n                            if (k === text.length) {\n                                throw this.parent.formulaErrorStrings[FormulasErrorsStrings.cannot_parse];\n                            }\n                            right = this.parent.substring(text, j, k - j + 1);\n                            if (uFound) {\n                                right = 'u' + right;\n                            }\n                            rightIndex = k + 1;\n                            /* tslint:disable-next-line */\n                        }\n                        else if (this.parent.isDigit(text[j]) || text[j] === this.parent.getParseDecimalSeparator()) {\n                            var period = (text[j] === this.parent.getParseDecimalSeparator());\n                            j = j + 1;\n                            /* tslint:disable-next-line */\n                            while (j < text.length && (this.parent.isDigit(text[j]) || (!period && text[j] === this.parent.getParseDecimalSeparator()))) {\n                                if (text[j] === this.parent.getParseDecimalSeparator()) {\n                                    period = true;\n                                }\n                                j = j + 1;\n                            }\n                            if (j < text.length && text[j] === '%') {\n                                j += 1;\n                            }\n                            if (period && j < text.length && text[j] === this.parent.getParseDecimalSeparator()) {\n                                throw this.parent.formulaErrorStrings[FormulasErrorsStrings.number_contains_2_decimal_points];\n                            }\n                            right = 'n' + this.parent.substring(text, i + 1, j - i - 1);\n                            rightIndex = j;\n                        }\n                        else if (this.parent.isUpperChar(text[j]) || text[j] === this.sheetToken || text[j] === 'u') {\n                            if (text[j] === this.sheetToken) {\n                                j = j + 1;\n                                while (j < text.length && text[j] !== this.sheetToken) {\n                                    j = j + 1;\n                                }\n                            }\n                            j = j + 1;\n                            var jTemp = 0;\n                            var inbracket = false;\n                            while (j < text.length && (this.parent.isUpperChar(text[j]) || text[j] === '_'\n                                || text[j] === '.' || text[j] === '[' || text[j] === ']' || text[j] === '#' || text[j] === ' '\n                                || text[j] === '%' || text[j] === this.parent.getParseDecimalSeparator() && inbracket)) {\n                                if (j !== text.length - 1 && text[j] === '[' && text[j + 1] === '[') {\n                                    inbracket = true;\n                                }\n                                if (j !== text.length - 1 && text[j] === ']' && text[j + 1] === ']') {\n                                    inbracket = false;\n                                }\n                                j++;\n                                jTemp++;\n                            }\n                            var noCellReference = (j === text.length) || !this.parent.isDigit(text[j]);\n                            if (jTemp > 1) {\n                                while (j < text.length && (this.parent.isUpperChar(text[j]) || this.parent.isDigit(text[j])\n                                    || text[j] === ' ' || text[j] === '_')) {\n                                    j++;\n                                }\n                                noCellReference = true;\n                            }\n                            while (j < text.length && this.parent.isDigit(text[j])) {\n                                j = j + 1;\n                            }\n                            if (j < text.length && text[j] === ':') {\n                                j = j + 1;\n                                if (j < text.length && text[j] === this.sheetToken) {\n                                    j++;\n                                    while (j < text.length && text[j] !== this.sheetToken) {\n                                        j = j + 1;\n                                    }\n                                    if (j < text.length && text[j] === this.sheetToken) {\n                                        j++;\n                                    }\n                                }\n                                while (j < text.length && this.parent.isUpperChar(text[j])) {\n                                    j = j + 1;\n                                }\n                                while (j < text.length && this.parent.isDigit(text[j])) {\n                                    j = j + 1;\n                                }\n                                j = j - 1;\n                                right = this.parent.substring(text, i + 1, j - i);\n                                right = this.parent.getCellFrom(right);\n                            }\n                            else {\n                                j = j - 1;\n                                right = this.parent.substring(text, i + 1, j - i);\n                                uFound = text[j] === 'u';\n                                if (uFound) {\n                                    right = 'u' + right;\n                                }\n                            }\n                            if (noCellReference && right.startsWith(this.sheetToken)) {\n                                noCellReference = !this.parent.isCellReference(right);\n                            }\n                            if (!noCellReference) {\n                                this.parent.updateDependentCell(right);\n                            }\n                            if ((this.parent.namedRanges.size > 0 && this.parent.namedRanges.has(right.toUpperCase()))\n                                || (this.parent.storedData.has(right.toUpperCase()))) {\n                                right = 'n' + this.checkForNamedRangeAndKeyValue(right);\n                            }\n                            rightIndex = j + 1;\n                        }\n                    }\n                    var p = op.indexOf(text[i]);\n                    var s = this.parent.arithMarker + left + right + markers[p] + this.parent.arithMarker;\n                    if (leftIndex > 0) {\n                        s = text.substring(0, leftIndex) + s;\n                    }\n                    if (rightIndex < text.length) {\n                        s = s + text.substring(rightIndex);\n                    }\n                    s = s.split(this.parent.arithMarker2).join(this.parent.arithMarker.toString());\n                    text = s;\n                    i = this.indexOfAny(text, operators);\n                }\n            }\n            else {\n                if (text.length > 0 && (this.parent.isUpperChar(text[0]) || text[0] === this.sheetToken)) {\n                    var isCharacter = true;\n                    var checkLetter = true;\n                    var oneTokenFound = false;\n                    var textLen = text.length;\n                    for (var k = 0; k < textLen; ++k) {\n                        if (text[k] === this.sheetToken) {\n                            if (k > 0 && !oneTokenFound) {\n                                throw this.parent.getErrorStrings()[CommonErrors.ref];\n                            }\n                            oneTokenFound = true;\n                            k++;\n                            while (k < textLen && this.parent.isDigit(text[k])) {\n                                k++;\n                            }\n                            if (k === textLen || text[k] !== this.sheetToken) {\n                                isCharacter = false;\n                                break;\n                            }\n                        }\n                        else {\n                            if (!checkLetter && this.parent.isChar(text[k])) {\n                                isCharacter = false;\n                                break;\n                            }\n                            if (this.parent.isChar(text[k]) || this.parent.isDigit(text[k]) || text[k] === this.sheetToken) {\n                                checkLetter = this.parent.isUpperChar(text[k]);\n                            }\n                            else {\n                                isCharacter = false;\n                                break;\n                            }\n                        }\n                    }\n                    if (isCharacter) {\n                        this.parent.updateDependentCell(text);\n                    }\n                }\n            }\n            return text;\n        }\n        catch (ex) {\n            return ex;\n        }\n    };\n    /** @hidden */\n    Parser.prototype.indexOfAny = function (text, operators) {\n        for (var i = 0; i < text.length; i++) {\n            if (operators.indexOf(text[i]) > -1) {\n                return i;\n            }\n        }\n        return -1;\n    };\n    /** @hidden */\n    Parser.prototype.findLeftMarker = function (text) {\n        var ret = -1;\n        if (text.indexOf(this.parent.arithMarker) > -1) {\n            var bracketLevel = 0;\n            for (var i = text.length - 1; i >= 0; --i) {\n                if (text[i] === this.parent.rightBracket) {\n                    bracketLevel--;\n                }\n                else if (text[i] === this.parent.leftBracket) {\n                    bracketLevel++;\n                }\n                else if (text[i] === this.parent.arithMarker && bracketLevel === 0) {\n                    ret = i;\n                    break;\n                }\n            }\n        }\n        return ret;\n    };\n    /** @hidden */\n    Parser.prototype.findRightMarker = function (text) {\n        var ret = -1;\n        if (text.indexOf(this.parent.arithMarker) > -1) {\n            var bracketLevel = 0;\n            for (var j = 0; j < text.length; ++j) {\n                if (text[j] === this.parent.rightBracket) {\n                    bracketLevel--;\n                }\n                else if (text[j] === this.parent.leftBracket) {\n                    bracketLevel++;\n                }\n                else if (text[j] === this.parent.arithMarker && bracketLevel === 0) {\n                    ret = j;\n                    break;\n                }\n            }\n        }\n        return ret;\n    };\n    /** @hidden */\n    Parser.prototype.parseFormula = function (formula, fKey) {\n        if (formula.length > 0 && formula[0] === this.parent.getFormulaCharacter()) {\n            formula = formula.substring(1);\n        }\n        if (formula.indexOf('#REF!') > -1) {\n            return this.parent.getErrorStrings()[CommonErrors.ref];\n        }\n        if (formula.length > 0 && formula[0] === '+') {\n            formula = formula.substring(1);\n        }\n        try {\n            this.isFailureTriggered = false;\n            this.isError = false;\n            formula = this.parse(formula.trim(), fKey);\n            this.isFormulaParsed = true;\n        }\n        catch (ex) {\n            var args = this.exceptionArgs(ex);\n            if (!this.isFailureTriggered) {\n                this.parent.trigger('onFailure', args);\n                this.isFailureTriggered = true;\n            }\n            var errorMessage = (typeof args.exception === 'string') ? args.exception : args.message;\n            formula = (isNullOrUndefined(this.parent.getErrorLine(ex)) ? '' : '#' + this.parent.getErrorLine(ex) + ': ') + errorMessage;\n            this.isError = true;\n        }\n        return formula;\n    };\n    /** @hidden */\n    Parser.prototype.markLibraryFormulas = function (formula) {\n        var bracCount = 0;\n        var rightParens = formula.indexOf(')');\n        if (rightParens === -1) {\n            formula = this.markNamedRanges(formula);\n        }\n        else {\n            while (rightParens > -1) {\n                var parenCount = 0;\n                var leftParens = rightParens - 1;\n                while (leftParens > -1 && (formula[leftParens] !== '(' || parenCount !== 0)) {\n                    if (formula[leftParens] === ')') {\n                        parenCount++;\n                    }\n                    else if (formula[leftParens] === ')') {\n                        parenCount--;\n                    }\n                    leftParens--;\n                }\n                if (leftParens === -1) {\n                    throw new FormulaError(this.parent.formulaErrorStrings[FormulasErrorsStrings.mismatched_parentheses]);\n                }\n                var i = leftParens - 1;\n                while (i > -1 && (this.parent.isChar(formula[i]))) {\n                    i--;\n                }\n                var len = leftParens - i - 1;\n                var libFormula = this.parent.substring(formula, i + 1, len);\n                if (len > 0 && !isNullOrUndefined(this.parent.getFunction(libFormula))) {\n                    if (this.parent.substring(formula, i + 1, len) === 'AREAS') {\n                        this.ignoreBracet = true;\n                    }\n                    else {\n                        this.ignoreBracet = false;\n                    }\n                    var substr = this.parent.substring(formula, leftParens, rightParens - leftParens + 1);\n                    try {\n                        var args = void 0;\n                        substr = substr.split('(').join('').split(')').join('');\n                        substr = '(' + this.formulaAutoCorrection(substr, args) + ')';\n                    }\n                    catch (ex) {\n                        var args = {\n                            message: ex.message, exception: ex,\n                            isForceCalculable: ex.formulaCorrection, computeForceCalculate: false\n                        };\n                        if (!args.isForceCalculable) {\n                            throw this.parent.formulaErrorStrings[FormulasErrorsStrings.improper_formula];\n                        }\n                        if (!this.isFailureTriggered) {\n                            this.parent.trigger('onFailure', args);\n                            this.isFailureTriggered = true;\n                            bracCount = bracCount + 1;\n                        }\n                        args.computeForceCalculate = bracCount > 0 ? true : args.computeForceCalculate;\n                        if (args.isForceCalculable) {\n                            if (args.computeForceCalculate) {\n                                substr = substr.split('(').join('').split(')').join('');\n                                substr = '(' + this.formulaAutoCorrection(substr, args) + ')';\n                            }\n                            else {\n                                throw this.parent.formulaErrorStrings[FormulasErrorsStrings.improper_formula];\n                            }\n                        }\n                        else {\n                            throw this.parent.formulaErrorStrings[FormulasErrorsStrings.improper_formula];\n                        }\n                    }\n                    substr = this.markNamedRanges(substr);\n                    substr = this.swapInnerParens(substr);\n                    substr = this.addParensToArgs(substr);\n                    var id = substr.lastIndexOf(this.parent.getParseArgumentSeparator());\n                    var k = 0;\n                    if (id === -1) {\n                        if (substr.length > 2 && substr[0] === '(' && substr[substr.length - 1] === ')') {\n                            if (substr[1] !== '{' && substr[1] !== '(') {\n                                substr = substr.substring(0, substr.length - 1) + '}' + substr.substring(substr.length - 1);\n                                substr = substr[0] + '{' + substr.substring(1);\n                            }\n                        }\n                    }\n                    formula = formula.substring(0, i + 1) + 'q' + this.parent.substring(formula, i + 1, len) +\n                        (substr.split('(').join(this.parent.leftBracket))\n                            .split(')').join(this.parent.rightBracket) + formula.substring(rightParens + 1);\n                }\n                else if (len > 0) {\n                    return this.parent.getErrorStrings()[CommonErrors.name];\n                }\n                else {\n                    var s = this.emptyStr;\n                    if (leftParens > 0) {\n                        s = formula.substring(0, leftParens);\n                    }\n                    s = s + '{' + this.parent.substring(formula, leftParens + 1, rightParens - leftParens - 1) + '}';\n                    if (rightParens < formula.length) {\n                        s = s + formula.substring(rightParens + 1);\n                    }\n                    s = this.markNamedRanges(s);\n                    formula = s;\n                }\n                rightParens = formula.indexOf(')');\n            }\n        }\n        formula = (formula.split('{').join('(')).split('}').join(')');\n        return formula;\n    };\n    /** @hidden */\n    Parser.prototype.swapInnerParens = function (fSubstr) {\n        if (fSubstr.length > 2) {\n            /* tslint:disable-next-line */\n            fSubstr = fSubstr[0] + fSubstr.substr(1, fSubstr.length - 2).split('(').join('{').split(')').join('}') + fSubstr[fSubstr.length - 1];\n        }\n        return fSubstr;\n    };\n    /** @hidden */\n    Parser.prototype.addParensToArgs = function (fSubstr) {\n        if (fSubstr.length === 0) {\n            return this.emptyStr;\n        }\n        var rightSides = [];\n        rightSides.push(this.parent.getParseArgumentSeparator());\n        rightSides.push(this.parent.rightBracket);\n        var id = fSubstr.lastIndexOf(this.parent.getParseArgumentSeparator());\n        var k = 0;\n        if (id === -1) {\n            if (fSubstr.length > 2 && fSubstr[0] === '(' && fSubstr[fSubstr.length - 1] === ')') {\n                if (fSubstr[1] !== '{' && fSubstr[1] !== '(') {\n                    fSubstr = fSubstr.substring(0, fSubstr.length - 1) + '}' + fSubstr.substring(fSubstr.length - 1);\n                    fSubstr = fSubstr[0] + '{' + fSubstr.substring(1);\n                }\n                else {\n                    var marker = ['+', '-', '*', '/'];\n                    id = this.lastIndexOfAny(fSubstr, marker);\n                    if (k === 0 && fSubstr[fSubstr.length - 1] === ')') {\n                        k = fSubstr.length - 1;\n                    }\n                    if (k > 0) {\n                        if (fSubstr[id + 1] !== '{' && fSubstr[id - 1] === '}') {\n                            fSubstr = fSubstr.substr(0, k) + '}' + fSubstr.substr(k);\n                            fSubstr = fSubstr.substr(0, id + 1) + '{' + fSubstr.substr(id + 1);\n                        }\n                    }\n                }\n            }\n        }\n        else {\n            var oneTimeOnly = true;\n            while (id > -1) {\n                var j = this.indexOfAny(fSubstr.substring(id + 1, fSubstr.length), rightSides);\n                if (j >= 0) {\n                    j = id + j + 1;\n                }\n                else if (j === -1 && fSubstr[fSubstr.length - 1] === ')') {\n                    j = fSubstr.length - 1;\n                }\n                if (j > 0) {\n                    if (fSubstr[id + 1] !== '{' && fSubstr[j - 1] !== '}') {\n                        fSubstr = fSubstr.substr(0, j) + '}' + fSubstr.substr(j);\n                        fSubstr = fSubstr.substr(0, id + 1) + '{' + fSubstr.substr(id + 1);\n                    }\n                }\n                id = fSubstr.substr(0, id).lastIndexOf(this.parent.getParseArgumentSeparator());\n                if (oneTimeOnly && id === -1 && fSubstr[0] === '(') {\n                    id = 0;\n                    oneTimeOnly = false;\n                }\n            }\n        }\n        fSubstr = fSubstr.split('{}').join(this.emptyStr);\n        return fSubstr;\n    };\n    /** @hidden */\n    Parser.prototype.lastIndexOfAny = function (text, operators) {\n        for (var i = text.length - 1; i > -1; i--) {\n            if (operators.indexOf(text[i]) > -1) {\n                return i;\n            }\n        }\n        return -1;\n    };\n    /** @hidden */\n    Parser.prototype.markNamedRanges = function (formula) {\n        var markers = [')', this.parent.getParseArgumentSeparator(), '}', '+', '-', '*', '/', '<', '>', '=', '&'];\n        var i = (formula.length > 0 && (formula[0] === '(' || formula[0] === '{')) ? 1 : 0;\n        if (formula.indexOf('#N/A') > -1) {\n            formula = formula.split('#N/A').join('#N~A');\n        }\n        if (formula.indexOf('#DIV/0!') > -1) {\n            formula = formula.split('#DIV/0!').join('#DIV~0!');\n        }\n        var end = this.indexOfAny(formula.substring(i), markers);\n        while (end > -1 && end + i < formula.length) {\n            var scopedRange = this.emptyStr;\n            var s = null;\n            if ((this.parent.substring(formula, i, end)).indexOf('[') > -1) {\n                s = this.getTableRange(this.parent.substring(formula, i, end));\n            }\n            else if (this.parent.storedData.has(this.parent.substring(formula, i, end))) {\n                s = this.checkForNamedRangeAndKeyValue(this.parent.substring(formula, i, end));\n            }\n            else if (this.parent.namedRanges.has(this.parent.substring(formula, i, end))) {\n                s = this.checkForNamedRangeAndKeyValue(this.parent.substring(formula, i, end));\n            }\n            if (isNullOrUndefined(s)) {\n                scopedRange = this.checkScopedRange(this.parent.substring(formula, i, end));\n                if (scopedRange !== 'NaN') {\n                    this.findNamedRange = true;\n                    s = scopedRange;\n                }\n                else if (this.parent.substring(formula, i, end).startsWith(this.sheetToken.toString())) {\n                    var formulaStr = this.parent.substring(formula, i, end).indexOf(this.sheetToken, 1);\n                    // if (formulaStr > 1) {\n                    //     s = this.parent.namedRanges.get(this.parent.substring\n                    // (formula.substring(i), formulaStr + 1, end - formulaStr - 1));\n                    // }\n                }\n                if (!isNullOrUndefined(s) && this.findNamedRange) {\n                    if (s.indexOf(this.fixedReference) > -1) {\n                        s = s.split(this.fixedReference).join(this.emptyStr);\n                    }\n                }\n            }\n            if (!isNullOrUndefined(s)) {\n                s = s.toUpperCase();\n                s = this.parent.setTokensForSheets(s);\n                s = this.markLibraryFormulas(s);\n            }\n            if (!isNullOrUndefined(s) && s !== this.emptyStr) {\n                formula = formula.substring(0, i) + s + formula.substring(i + end);\n                i += s.length + 1;\n            }\n            else {\n                i += end + 1;\n                while (i < formula.length && !this.parent.isUpperChar(formula[i]) && formula[i] !== this.sheetToken) {\n                    i++;\n                }\n            }\n            end = i;\n            if (i < formula.length - 1 && formula[i] === '{') {\n                i = i + 1;\n            }\n            end = this.indexOfAny(formula.substring(i), markers);\n            while (end === 0 && i < formula.length - 1) {\n                i++;\n                end = this.indexOfAny(formula.substring(i), markers);\n            }\n            if ((end === -1 || formula.substring(i).indexOf('[') > -1) && i < formula.length) {\n                if (formula.substring(i).indexOf('[') > -1) {\n                    s = this.getTableRange(formula.substring(i));\n                }\n                else {\n                    if (this.parent.storedData.has(formula.substring(i))) {\n                        s = this.parent.storedData.size > 0 ? this.checkForNamedRangeAndKeyValue(formula.substring(i)) : s;\n                    }\n                    else {\n                        s = this.parent.namedRanges.size > 0 ? this.checkForNamedRangeAndKeyValue(formula.substring(i)) : s;\n                    }\n                }\n                if (isNullOrUndefined(s)) {\n                    scopedRange = this.checkScopedRange(formula.substring(i));\n                    if (scopedRange !== 'NaN') {\n                        s = scopedRange;\n                    }\n                }\n                if (!isNullOrUndefined(s) && s !== this.emptyStr) {\n                    s = s.toUpperCase();\n                    s = this.parent.setTokensForSheets(s);\n                    s = this.markLibraryFormulas(s);\n                    if (s != null) {\n                        var val = formula.substring(i);\n                        if (val[val.length - 1] === ')') {\n                            formula = formula.substring(0, i) + s + ')';\n                        }\n                        else {\n                            formula = formula.substring(0, i) + s;\n                        }\n                        i += s.toString().length + 1;\n                    }\n                }\n                end = (i < formula.length) ? this.indexOfAny(formula.substring(i), markers) : -1;\n            }\n        }\n        if (formula.indexOf('#N~A') > -1) {\n            formula = formula.split('#N~A').join('#N/A');\n        }\n        if (formula.indexOf('#DIV~0!') > -1) {\n            formula = formula.split('#DIV~0!').join('#DIV/0!');\n        }\n        return formula;\n    };\n    /** @hidden */\n    Parser.prototype.checkForNamedRangeAndKeyValue = function (text) {\n        var scopedRange = this.emptyStr;\n        if (text.indexOf('[') > -1) {\n            var namerangeValue = this.getTableRange(text);\n            if (!isNullOrUndefined(namerangeValue)) {\n                this.findNamedRange = true;\n                text = namerangeValue;\n            }\n        }\n        scopedRange = this.checkScopedRange(text);\n        if (scopedRange !== 'NaN') {\n            this.findNamedRange = true;\n            text = scopedRange;\n        }\n        else {\n            if (text.indexOf(this.sheetToken) > -1) {\n                var sheet = this.parent.getSheetFamilyItem(this.parent.grid);\n                /* tslint:disable-next-line */\n                var value = text.split('\"').join(this.emptyStr);\n                value = value.substr(0, value.indexOf(this.sheetToken));\n                if (sheet.sheetNameToToken.has(value.toUpperCase())) {\n                    /* tslint:disable */\n                    var sheetIndex = parseInt(sheet.sheetNameToToken.get(value.toUpperCase()).split(this.sheetToken).join(this.emptyStr));\n                    // if (!ej.isNullOrUndefined(this.parentObject) && this.parentObject.pluginName == \"ejSpreadsheet\") {\n                    //     var name = text.replace(value, this.parentObject.model.sheets[(sheetIndex + 1)].sheetInfo.text.toUpperCase()).split(\"'\").join(this._string_empty);\n                    //     if (this.getNamedRanges().length > 0 && this.getNamedRanges().contains(name.toUpperCase())) {\n                    //         text = name;\n                    //     }\n                    // }\n                    /* tslint-enable */\n                }\n            }\n            if (this.parent.storedData.size > 0 && this.parent.storedData.has(text)) {\n                text = 'A' + this.parent.colIndex(text);\n            }\n            if (this.parent.namedRanges.size > 0 && this.parent.namedRanges.has(text.toUpperCase())) {\n                /* tslint:disable-next-line:no-any */\n                if (!isNullOrUndefined(this.parent.parentObject)) {\n                    text = this.parse(this.parent.namedRanges.get(text.toUpperCase()));\n                }\n                else {\n                    text = this.parse(this.parent.namedRanges.get(text.toUpperCase()));\n                    text = this.parent.setTokensForSheets(text);\n                    if (text.indexOf(this.fixedReference) > -1) {\n                        text.split(this.fixedReference).join(this.emptyStr);\n                    }\n                    this.findNamedRange = true;\n                }\n            }\n            if (this.findNamedRange) {\n                if (text[0] !== '!' && text[0] !== 'q' && text[0] !== 'bq') {\n                    text = this.parent.setTokensForSheets(text);\n                    if (text.indexOf(this.fixedReference) > -1) {\n                        text = text.split(this.fixedReference).join(this.emptyStr);\n                    }\n                }\n            }\n        }\n        return text;\n    };\n    Parser.prototype.getTableRange = function (text) {\n        text = text.replace(' ', this.emptyStr).toUpperCase();\n        var name = text.replace(']', this.emptyStr).replace('#DATA', this.emptyStr);\n        var tableName = name;\n        if (name.indexOf(this.parent.getParseArgumentSeparator()) > -1) {\n            tableName = name.substring(0, name.indexOf(this.parent.getParseArgumentSeparator())).replace('[', this.emptyStr);\n            name = name.replace('[', this.emptyStr).replace(this.parent.getParseArgumentSeparator(), '_');\n        }\n        var range = this.emptyStr;\n        return name.toUpperCase();\n    };\n    Parser.prototype.findNextEndIndex = function (formula, loc) {\n        var count = 0;\n        var l = loc;\n        var found = false;\n        while (!found && loc < formula.length) {\n            if (formula[l] === '[') {\n                count++;\n            }\n            else if (formula[l] === ']') {\n                count--;\n                if (count === 0) {\n                    found = true;\n                }\n            }\n            loc++;\n        }\n        loc = loc - l;\n        return loc;\n    };\n    ;\n    return Parser;\n}());\nexport { Parser };\n","/* tslint:disable-next-line:max-line-length */\nimport { getSheetName, getSheetIndex, getSheet, getSheetIndexByName, getCell } from '../base/index';\nimport { workbookFormulaOperation, getColumnHeaderText, aggregateComputation, getRangeIndexes } from '../common/index';\nimport { Calculate, ValueChangedArgs, CommonErrors, getAlphalabel } from '../../calculate/index';\nimport { isNullOrUndefined } from '@syncfusion/ej2-base';\nimport { getCellAddress, getFormattedCellObject, isNumber, checkIsFormula } from '../common/index';\nimport { workbookEditOperation, getRangeAddress, getRangeFromAddress, isCellReference } from '../common/index';\n/**\n * @hidden\n * The `WorkbookFormula` module is used to handle the formula operation in Workbook.\n */\nvar WorkbookFormula = /** @class */ (function () {\n    /**\n     * Constructor for formula module in Workbook.\n     * @private\n     */\n    function WorkbookFormula(workbook) {\n        this.uniqueOBracket = String.fromCharCode(129);\n        this.uniqueCBracket = String.fromCharCode(130);\n        this.uniqueCSeparator = String.fromCharCode(131);\n        this.uniqueCOperator = String.fromCharCode(132);\n        this.uniquePOperator = String.fromCharCode(133);\n        this.uniqueSOperator = String.fromCharCode(134);\n        this.uniqueMOperator = String.fromCharCode(135);\n        this.uniqueDOperator = String.fromCharCode(136);\n        this.uniqueModOperator = String.fromCharCode(137);\n        this.uniqueConcateOperator = String.fromCharCode(138);\n        this.uniqueEqualOperator = String.fromCharCode(139);\n        this.uniqueExpOperator = String.fromCharCode(140);\n        this.uniqueGTOperator = String.fromCharCode(141);\n        this.uniqueLTOperator = String.fromCharCode(142);\n        this.sheetInfo = [];\n        this.parent = workbook;\n        this.init();\n    }\n    WorkbookFormula.prototype.init = function () {\n        this.addEventListener();\n        this.initCalculate();\n        this.registerSheet();\n    };\n    /**\n     * To destroy the formula module.\n     * @return {void}\n     * @hidden\n     */\n    WorkbookFormula.prototype.destroy = function () {\n        this.removeEventListener();\n        this.calculateInstance.dispose();\n        this.calculateInstance = null;\n        this.parent = null;\n    };\n    WorkbookFormula.prototype.addEventListener = function () {\n        this.parent.on(workbookFormulaOperation, this.performFormulaOperation, this);\n        this.parent.on(aggregateComputation, this.aggregateComputation, this);\n    };\n    WorkbookFormula.prototype.removeEventListener = function () {\n        if (!this.parent.isDestroyed) {\n            this.parent.off(workbookFormulaOperation, this.performFormulaOperation);\n            this.parent.off(aggregateComputation, this.aggregateComputation);\n        }\n    };\n    /**\n     * Get the module name.\n     * @returns string\n     * @private\n     */\n    WorkbookFormula.prototype.getModuleName = function () {\n        return 'workbookFormula';\n    };\n    WorkbookFormula.prototype.initCalculate = function () {\n        this.calculateInstance = new Calculate(this.parent);\n        this.calcID = this.calculateInstance.createSheetFamilyID();\n        this.calculateInstance.setTreatEmptyStringAsZero(true);\n        this.calculateInstance.grid = this.parent.getActiveSheet().id.toString();\n    };\n    WorkbookFormula.prototype.performFormulaOperation = function (args) {\n        var action = args.action;\n        var formulas = this.calculateInstance.getLibraryFormulas();\n        var formulaInfo = (Array.from(formulas.values()));\n        switch (action) {\n            case 'getLibraryFormulas':\n                args.formulaCollection = Array.from(formulas.keys());\n                break;\n            case 'getFormulaCategory':\n                var collection = ['All'];\n                for (var i = 1; i < Array.from(formulas.values()).length; i++) {\n                    if (collection.indexOf(formulaInfo[i].category) < 0) {\n                        collection.push(formulaInfo[i].category);\n                    }\n                }\n                args.categoryCollection = collection;\n                break;\n            case 'dropDownSelectFormulas':\n                for (var i = 0; i < Array.from(formulas.values()).length; i++) {\n                    if (args.selectCategory === formulaInfo[i].category) {\n                        args.formulaCollection[i] = Array.from(formulas.keys())[i];\n                    }\n                }\n                break;\n            case 'getFormulaDescription':\n                for (var i = 0; i < Array.from(formulas.values()).length; i++) {\n                    if (args.selectedList === Array.from(formulas.keys())[i]) {\n                        args.description = formulaInfo[i].description;\n                    }\n                }\n                break;\n            case 'registerSheet':\n                this.registerSheet(args.sheetIndex, args.sheetCount);\n                if (args.isImport) {\n                    this.updateSheetInfo();\n                }\n                break;\n            case 'unRegisterSheet':\n                this.unRegisterSheet(args.sheetIndex, args.sheetCount);\n                break;\n            case 'refreshCalculate':\n                args.value = this.autoCorrectFormula(args.value, args.rowIndex, args.colIndex);\n                this.refreshCalculate(args.rowIndex, args.colIndex, args.value, args.isFormula, args.sheetIndex);\n                args.value = args.value ? args.value.toString().split('-*').join('-').split('/*').join('/').split('*/').\n                    join('*').split('-/').join('-').split('*+').join('*').split('+*').join('+') : args.value;\n                break;\n            case 'getArgumentSeparator':\n                args.argumentSeparator = this.calculateInstance.getParseArgumentSeparator();\n                break;\n            case 'addDefinedName':\n                args.isAdded = this.addDefinedName(args.definedName);\n                break;\n            case 'removeDefinedName':\n                args.isRemoved = this.removeDefinedName(args.definedName, args.scope);\n                break;\n            case 'initiateDefinedNames':\n                this.initiateDefinedNames();\n                break;\n            case 'renameUpdation':\n                this.renameUpdation(args.value, args.sheetId);\n                break;\n            case 'addSheet':\n                this.sheetInfo.push({ visibleName: args.visibleName, sheet: args.sheetName, index: args.index });\n                break;\n            case 'getSheetInfo':\n                args.sheetInfo = this.sheetInfo;\n                break;\n            case 'deleteSheetTab':\n                var length_1 = this.sheetInfo.length;\n                for (var i = 0; i < length_1; i++) {\n                    if (this.sheetInfo[i].index === args.index) {\n                        args.sheetName = this.sheetInfo[i].sheet;\n                        this.sheetInfo.splice(i, 1);\n                        break;\n                    }\n                }\n                this.calculateInstance.unregisterGridAsSheet((args.index - 1).toString(), args.index);\n                this.calculateInstance.tokenCount = this.calculateInstance.tokenCount - 1;\n                this.sheetDeletion(args.sheetName, args.index, args.index);\n                break;\n            case 'getReferenceError':\n                args.refError = this.referenceError();\n                break;\n            case 'getAlpha':\n                args.col = getAlphalabel(args.col);\n                break;\n            case 'addCustomFunction':\n                this.addCustomFunction(args.functionHandler, args.functionName);\n                break;\n            case 'computeExpression':\n                args.calcValue = this.calculateInstance.computeExpression(args.formula);\n                break;\n            case 'registerGridInCalc':\n                this.calculateInstance.grid = args.sheetID;\n                break;\n            case 'refreshInsDelFormula':\n                this.refreshInsDelFormula(args.insertArgs);\n                break;\n            case 'refreshNamedRange':\n                this.refreshNamedRange(args.insertArgs, action);\n                break;\n        }\n    };\n    WorkbookFormula.prototype.referenceError = function () {\n        return this.calculateInstance.getErrorStrings()[CommonErrors.ref];\n    };\n    WorkbookFormula.prototype.getSheetInfo = function () {\n        return this.sheetInfo;\n    };\n    WorkbookFormula.prototype.addCustomFunction = function (functionHandler, functionName) {\n        this.calculateInstance.defineFunction(functionName, functionHandler);\n    };\n    WorkbookFormula.prototype.updateSheetInfo = function () {\n        var _this = this;\n        this.sheetInfo = [];\n        this.parent.sheets.forEach(function (sheet, idx) {\n            _this.sheetInfo.push({ visibleName: sheet.name, sheet: 'Sheet' + sheet.id, index: idx });\n        });\n    };\n    WorkbookFormula.prototype.sheetDeletion = function (delSheetName, sheetId, index) {\n        var dependentCell = this.calculateInstance.getDependentCells();\n        var cellRef = [];\n        var fInfo = null;\n        var formulaVal = '';\n        var rowId;\n        var colId;\n        dependentCell.forEach(function (value, key) {\n            cellRef.push(key);\n        });\n        this.removeSheetTokenIndex(formulaVal, index);\n        for (var i = 0; i < cellRef.length; i++) {\n            var dependentCellRef = this.calculateInstance.getDependentCells().get(cellRef[i]);\n            for (var j = 0; j < dependentCellRef.length; j++) {\n                fInfo = this.calculateInstance.getFormulaInfoTable().get(dependentCellRef[j]);\n                sheetId = parseInt(dependentCellRef[j].split('!')[1], 10) + 1;\n                if (!isNullOrUndefined(fInfo) && sheetId > -1) {\n                    formulaVal = fInfo.formulaText;\n                    if (formulaVal.toUpperCase().indexOf(delSheetName.toUpperCase()) > -1) {\n                        formulaVal = formulaVal.toUpperCase().split(delSheetName.toUpperCase() +\n                            this.calculateInstance.sheetToken).join(this.referenceError());\n                        rowId = this.calculateInstance.rowIndex(dependentCellRef[j]);\n                        colId = this.calculateInstance.colIndex(dependentCellRef[j]);\n                        this.updateDataContainer([rowId - 1, colId - 1], { value: formulaVal, sheetId: sheetId, visible: false });\n                        this.calculateInstance.refresh(fInfo.getParsedFormula());\n                    }\n                }\n                if (delSheetName.split('Sheet')[1] === cellRef[i].split('!')[1]) {\n                    this.calculateInstance.getFormulaInfoTable().delete(cellRef[i]);\n                    this.calculateInstance.clearFormulaDependentCells(cellRef[i]);\n                }\n            }\n        }\n    };\n    WorkbookFormula.prototype.removeSheetTokenIndex = function (value, index) {\n        var family = this.calculateInstance.getSheetFamilyItem(this.calculateInstance.grid);\n        family.sheetNameToToken.delete(index.toString());\n        family.sheetNameToParentObject.delete(index.toString());\n        family.parentObjectToToken.delete(index.toString());\n        family.tokenToParentObject.delete('!' + (index - 1).toString() + '!');\n        return value;\n    };\n    WorkbookFormula.prototype.renameUpdation = function (name, sheetIdx) {\n        var dependentCellRef = this.calculateInstance.getDependentCells();\n        var cellRef = [];\n        var fInfo;\n        var formulaVal = '';\n        var savedTokens = [];\n        var isSheetRenamed = false;\n        var rowIndex;\n        var colIndex;\n        var sheetIndex;\n        dependentCellRef.forEach(function (value, key) {\n            cellRef.push(key);\n        });\n        for (var i = 0; i < this.sheetInfo.length; i++) {\n            if (this.sheetInfo[i].index === sheetIdx) {\n                this.sheetInfo[i].visibleName = name;\n                break;\n            }\n        }\n        var sheetNames = this.sheetInfo;\n        for (var i = 0; i < cellRef.length; i++) {\n            var dependentCells = this.calculateInstance.getDependentCells().get(cellRef[i]);\n            for (var j = 0; j < dependentCells.length; j++) {\n                fInfo = this.calculateInstance.getFormulaInfoTable().get(dependentCells[j]);\n                formulaVal = fInfo.formulaText;\n                for (var s = 0; s < sheetNames.length; s++) {\n                    if (sheetNames[s].visibleName !== sheetNames[s].sheet) {\n                        var name_1 = sheetNames[s].sheet.toUpperCase();\n                        if (formulaVal.toUpperCase().indexOf(name_1) > -1) {\n                            formulaVal = formulaVal.toUpperCase().split(name_1).join(s + '/');\n                            savedTokens.push(s);\n                            isSheetRenamed = true;\n                        }\n                    }\n                }\n                if (isSheetRenamed) {\n                    for (var k = 0; k < savedTokens.length; k++) {\n                        formulaVal = formulaVal.split(savedTokens[k].toString() + '/').join(sheetNames[savedTokens[k]].visibleName);\n                    }\n                    rowIndex = this.calculateInstance.rowIndex(dependentCells[j]);\n                    colIndex = this.calculateInstance.colIndex(dependentCells[j]);\n                    sheetIndex = getSheetIndexByName(this.parent, ('Sheet') + (parseInt(dependentCells[j].split('!')[1], 10) + 1), this.sheetInfo);\n                    this.updateDataContainer([rowIndex - 1, colIndex - 1], { value: formulaVal, sheetId: sheetIndex, visible: true });\n                }\n            }\n        }\n    };\n    WorkbookFormula.prototype.updateDataContainer = function (indexes, data) {\n        var rowIndex = indexes[0];\n        var colIndex = indexes[1];\n        var sheetData;\n        var rowData;\n        var colObj;\n        var len = this.parent.sheets.length;\n        for (var i = 0; i < len; i++) {\n            if (this.parent.sheets[i].id === data.sheetId) {\n                sheetData = this.parent.sheets[i].rows;\n                break;\n            }\n        }\n        if (!isNullOrUndefined(data)) {\n            if (rowIndex in sheetData) {\n                rowData = sheetData[rowIndex];\n                if (colIndex in rowData.cells) {\n                    colObj = rowData.cells[colIndex];\n                    colObj.formula = data.value;\n                    colObj.value = data.visible ? colObj.value : this.referenceError();\n                }\n                else {\n                    rowData.cells[colIndex] = colObj = {};\n                }\n            }\n            else {\n                rowData = sheetData[rowIndex] = {};\n                rowData[colIndex] = colObj = {};\n            }\n        }\n    };\n    WorkbookFormula.prototype.parseSheetRef = function (value) {\n        var regx;\n        var escapeRegx = new RegExp('[!@#$%^&()+=\\';,.{}|\\\":<>~_-]', 'g');\n        var i = 0;\n        var sheetCount = this.parent.sheets.length;\n        var temp = [];\n        temp.length = 0;\n        var sheetInfo = this.getSheetInfo();\n        var exp = '(?=[\\'!])(?=[^\"]*(?:\"[^\"]*\"[^\"]*)*$)';\n        for (i = 0; i < sheetCount; i++) {\n            if (sheetInfo[i].sheet !== sheetInfo[i].visibleName) {\n                regx = new RegExp(sheetInfo[i].visibleName.replace(escapeRegx, '\\\\$&') + exp, 'gi');\n                if (value.match(regx)) {\n                    value = value.replace(regx, i + '/');\n                    temp.push(i);\n                }\n            }\n        }\n        i = 0;\n        while (i < temp.length) {\n            regx = new RegExp(temp[i] + '/' + exp, 'gi');\n            value = value.replace(regx, sheetInfo[temp[i]].sheet);\n            i++;\n        }\n        return value;\n    };\n    WorkbookFormula.prototype.registerSheet = function (sheetIndex, sheetCount) {\n        if (sheetIndex === void 0) { sheetIndex = 0; }\n        if (sheetCount === void 0) { sheetCount = this.parent.sheets.length; }\n        var id;\n        while (sheetIndex < sheetCount) {\n            id = getSheet(this.parent, sheetIndex).id + '';\n            this.calculateInstance.registerGridAsSheet(id, id, this.calcID);\n            sheetIndex++;\n        }\n    };\n    WorkbookFormula.prototype.unRegisterSheet = function (sheetIndex, sheetCount) {\n        if (sheetIndex === void 0) { sheetIndex = 0; }\n        if (sheetCount === void 0) { sheetCount = this.parent.sheets.length; }\n        var id;\n        this.calculateInstance.tokenCount = 0;\n        while (sheetIndex < sheetCount) {\n            id = getSheet(this.parent, sheetIndex).id + '';\n            this.calculateInstance.unregisterGridAsSheet(id, id);\n            sheetIndex++;\n        }\n    };\n    WorkbookFormula.prototype.refreshCalculate = function (rowIdx, colIdx, value, isFormula, sheetIdx) {\n        if (sheetIdx === undefined) {\n            sheetIdx = this.parent.activeSheetIndex;\n        }\n        var sheetName = getSheet(this.parent, sheetIdx).id + '';\n        if (isFormula) {\n            value = this.parseSheetRef(value);\n            var cellArgs = new ValueChangedArgs(rowIdx + 1, colIdx + 1, value);\n            this.calculateInstance.valueChanged(sheetName, cellArgs, true);\n            var referenceCollection = this.calculateInstance.randCollection;\n            if (this.calculateInstance.isRandomVal === true) {\n                var rowId = void 0;\n                var colId = void 0;\n                var refValue = '';\n                if (this.calculateInstance.randomValues.size > 1 && this.calculateInstance.randomValues.size ===\n                    referenceCollection.length) {\n                    for (var i = 0; i < this.calculateInstance.randomValues.size; i++) {\n                        rowId = this.calculateInstance.rowIndex(referenceCollection[i]);\n                        colId = this.calculateInstance.colIndex(referenceCollection[i]);\n                        refValue = this.calculateInstance.randomValues.get(referenceCollection[i]);\n                        sheetName = (parseFloat(this.calculateInstance.getSheetToken(referenceCollection[i]).split(this.calculateInstance.sheetToken).join('')) + 1).toString();\n                        var tempArgs = new ValueChangedArgs(rowId, colId, refValue);\n                        this.calculateInstance.valueChanged(sheetName, tempArgs, true);\n                    }\n                }\n            }\n        }\n        else {\n            var family = this.calculateInstance.getSheetFamilyItem(sheetName);\n            var cellRef = getColumnHeaderText(colIdx + 1) + (rowIdx + 1);\n            if (family.isSheetMember && !isNullOrUndefined(family.parentObjectToToken)) {\n                cellRef = family.parentObjectToToken.get(sheetName) + cellRef;\n            }\n            if (this.calculateInstance.getFormulaInfoTable().has(cellRef)) {\n                this.calculateInstance.getFormulaInfoTable().delete(cellRef);\n                if (this.calculateInstance.getDependentCells().has(cellRef)) {\n                    this.calculateInstance.clearFormulaDependentCells(cellRef);\n                }\n            }\n            this.calculateInstance.getComputedValue().clear();\n            this.calculateInstance.refresh(cellRef);\n            this.calculateInstance.refreshRandValues(cellRef);\n        }\n        this.calculateInstance.cell = '';\n    };\n    WorkbookFormula.prototype.autoCorrectFormula = function (formula, rowIdx, colIdx) {\n        if (!isNullOrUndefined(formula)) {\n            formula = formula.toString();\n            if (formula.split('(').length === 2 && formula.indexOf(')') < 0) {\n                formula += ')';\n            }\n            var isEqual = void 0;\n            if (formula.indexOf('=') === 0) {\n                formula = formula.slice(1);\n                isEqual = true;\n            }\n            var lessEq = formula.match(/</g);\n            var greaterEq = formula.match(/>/g);\n            var equal = formula.match(/=/g);\n            if (lessEq) {\n                var lessOp = '';\n                for (var i = 0; i < lessEq.length; i++) {\n                    lessOp = lessOp + lessEq[i];\n                }\n                formula = formula.replace(lessOp, '<');\n            }\n            if (greaterEq) {\n                var greaterOp = '';\n                for (var j = 0; j < greaterEq.length; j++) {\n                    greaterOp = greaterOp + greaterEq[j];\n                }\n                formula = formula.replace(greaterOp, '>');\n            }\n            if (equal) {\n                var equalOp = '';\n                for (var c = 0; c < equal.length; c++) {\n                    equalOp = equalOp + equal[c];\n                }\n                formula = formula.split(equalOp).join('=');\n            }\n            formula = isEqual ? '=' + formula : formula;\n            if (lessEq || greaterEq || equal) {\n                getCell(rowIdx, colIdx, this.parent.getActiveSheet()).formula = formula;\n            }\n        }\n        return formula;\n    };\n    WorkbookFormula.prototype.initiateDefinedNames = function () {\n        var definedNames = this.parent.definedNames;\n        var i = 0;\n        while (i < definedNames.length) {\n            var definedname = definedNames[i];\n            var refersTo = this.parseSheetRef(definedname.refersTo);\n            var range = getRangeFromAddress(refersTo);\n            var cellRef = false;\n            var isLink = refersTo.indexOf('http:') > -1 ? true : (refersTo.indexOf('https:') > -1 ? true : false);\n            range = range.split('$').join('');\n            range = range.split('=').join('');\n            if (range.indexOf(':') > -1) {\n                var rangeSplit = range.split(':');\n                if (isCellReference(rangeSplit[0]) && isCellReference(rangeSplit[1])) {\n                    cellRef = true;\n                }\n            }\n            else if (range.indexOf(':') < 0) {\n                if (isCellReference(range)) {\n                    cellRef = true;\n                }\n            }\n            if (isLink) {\n                cellRef = false;\n            }\n            if (cellRef) {\n                this.addDefinedName(definedname, true);\n            }\n            else {\n                this.removeDefinedName(definedname.name, definedname.scope);\n                i--;\n            }\n            i++;\n        }\n    };\n    /**\n     * @hidden\n     * Used to add defined name to workbook.\n     * @param {DefineNameModel} name - Define named range.\n     */\n    WorkbookFormula.prototype.addDefinedName = function (definedName, isValidate) {\n        var isAdded = true;\n        var sheetIdx;\n        var name = definedName.name;\n        if (definedName.refersTo.indexOf('!') < 0) {\n            var sheetName = getSheetName(this.parent);\n            sheetName = sheetName.indexOf(' ') !== -1 ? '\\'' + sheetName + '\\'' : sheetName;\n            definedName.refersTo = sheetName + '!' + ((definedName.refersTo.indexOf('=') < 0) ?\n                definedName.refersTo : definedName.refersTo.split('=')[1]);\n        }\n        var visibleRefersTo = definedName.refersTo;\n        var refersTo = this.parseSheetRef(definedName.refersTo);\n        if (definedName.scope) {\n            sheetIdx = getSheetIndex(this.parent, definedName.scope);\n            if (sheetIdx > -1) {\n                name = getSheetName(this.parent, sheetIdx) + '!' + name;\n            }\n        }\n        else {\n            definedName.scope = '';\n        }\n        if (!definedName.comment) {\n            definedName.comment = '';\n        }\n        //need to extend once internal sheet value changes done.\n        if (!isValidate && this.checkIsNameExist(definedName.name, definedName.scope)) {\n            isAdded = false;\n        }\n        else {\n            this.calculateInstance.addNamedRange(name, refersTo[0] === '=' ? refersTo.substr(1) : refersTo);\n            if (refersTo[0] !== '=') {\n                definedName.refersTo = '=' + visibleRefersTo;\n            }\n            if (this.parent.definedNames.indexOf(definedName) < 0) {\n                this.parent.definedNames.push(definedName);\n            }\n        }\n        return isAdded;\n    };\n    /**\n     * @hidden\n     * Used to remove defined name from workbook.\n     * @param {string} name - Specifies the defined name.\n     * @param {string} scope - Specifies the scope of the define name.\n     */\n    WorkbookFormula.prototype.removeDefinedName = function (name, scope) {\n        var isRemoved = false;\n        var index = this.getIndexFromNameColl(name, scope);\n        if (index > -1) {\n            var calcName = name;\n            if (scope) {\n                var sheetIdx = getSheetIndex(this.parent, scope);\n                if (sheetIdx) {\n                    calcName = getSheetName(this.parent, sheetIdx) + '!' + name;\n                }\n            }\n            this.calculateInstance.removeNamedRange(calcName);\n            this.parent.definedNames.splice(index, 1);\n            isRemoved = true;\n        }\n        return isRemoved;\n    };\n    WorkbookFormula.prototype.checkIsNameExist = function (name, sheetName) {\n        var isExist = this.parent.definedNames.some(function (key) {\n            return key.name === name && (sheetName ? key.scope === sheetName : key.scope === '');\n        });\n        return isExist;\n    };\n    WorkbookFormula.prototype.getIndexFromNameColl = function (definedName, scope) {\n        if (scope === void 0) { scope = ''; }\n        var index = -1;\n        this.parent.definedNames.filter(function (name, idx) {\n            if (name.name === definedName && name.scope === scope) {\n                index = idx;\n            }\n        });\n        return index;\n    };\n    WorkbookFormula.prototype.toFixed = function (value) {\n        var num = Number(value);\n        if (Math.round(num) !== num) {\n            value = num.toFixed(2);\n        }\n        return value;\n    };\n    WorkbookFormula.prototype.aggregateComputation = function (args) {\n        var sheet = this.parent.getActiveSheet();\n        var range = sheet.selectedRange;\n        var indexes = getRangeIndexes(range.split(':')[1]);\n        var i;\n        var calcValue;\n        var formulaVal = ['SUM', 'AVERAGE', 'MIN', 'MAX'];\n        var formatedValues = [];\n        if (indexes[0] + 1 === sheet.rowCount && indexes[1] + 1 === sheet.colCount) {\n            range = \"A1:\" + getCellAddress(sheet.usedRange.rowIndex, sheet.usedRange.colIndex);\n        }\n        var actCell = getRangeIndexes(sheet.activeCell);\n        var actCellModel = sheet.rows[actCell[0]] ? sheet.rows[actCell[0]].cells ?\n            sheet.rows[actCell[0]].cells[actCell[1]] : {} : {};\n        var actCellfrmt = (actCellModel) ? actCellModel.format : '';\n        var cellValue;\n        var cellCol = this.calculateInstance.getCellCollection(range);\n        for (i = 0; i < cellCol.length; i++) {\n            cellValue = this.calculateInstance.getValueFromArg(cellCol[i]);\n            if (isNumber(cellValue)) {\n                args.countOnly = false;\n                break;\n            }\n        }\n        args.Count = this.calculateInstance.getFunction('COUNTA')(range);\n        if (!args.Count || args.countOnly) {\n            return;\n        }\n        for (i = 0; i < 4; i++) {\n            calcValue = this.toFixed(this.calculateInstance.getFunction(formulaVal[i])(range));\n            var eventArgs = {\n                formattedText: calcValue,\n                value: calcValue,\n                format: actCellfrmt,\n                onLoad: true\n            };\n            if (actCellfrmt) {\n                this.parent.notify(getFormattedCellObject, eventArgs);\n                calcValue = eventArgs.formattedText;\n            }\n            formatedValues.push(calcValue);\n        }\n        args.Sum = formatedValues[0];\n        args.Avg = formatedValues[1];\n        args.Min = formatedValues[2];\n        args.Max = formatedValues[3];\n    };\n    WorkbookFormula.prototype.clearFormula = function (args) {\n        if (this.parent.activeSheetIndex === args.sheetIdx) {\n            args.rowIdx = (args.type === 'Row') ? (args.status === 'insert') ? (args.rowIdx >= args.startIdx)\n                ? args.rowIdx - args.count : args.rowIdx : args.rowIdx + args.count : args.rowIdx;\n            args.colIdx = (args.type === 'Column') ? (args.status === 'insert') ? (args.colIdx >= args.startIdx) ?\n                args.colIdx - args.count : args.colIdx : args.colIdx + args.count : args.colIdx;\n        }\n        var cellRef = '!' + args.sheetIdx + '!' + getAlphalabel((args.colIdx === -1 ?\n            (args.colIdx + 2) : (args.colIdx + 1))) + (args.rowIdx === -1 ? (args.rowIdx + 2) : (args.rowIdx + 1));\n        this.calculateInstance.getFormulaInfoTable().delete(cellRef);\n        this.calculateInstance.clearFormulaDependentCells(cellRef);\n    };\n    WorkbookFormula.prototype.refreshFormula = function (formulaValue, count, status, type, startIdx, sheetIdx) {\n        var diff;\n        var diff1;\n        var val = formulaValue;\n        var nAlpha;\n        var range = [];\n        var actSheet = this.parent.getActiveSheet();\n        var deleteIdxs = [];\n        var i;\n        var splitFormula = [];\n        var fArg;\n        var ridx;\n        var hasREFVal = false;\n        var pVal;\n        if (checkIsFormula(val)) {\n            if (status === 'delete') {\n                for (i = 1; i <= count; i++) {\n                    deleteIdxs.push(startIdx + i);\n                }\n            }\n            splitFormula = this.parseFormula(val);\n            for (i = 0; i < splitFormula.length; i++) {\n                fArg = splitFormula[i].trim();\n                if (this.calculateInstance.isCellReference(fArg)) {\n                    pVal = i && splitFormula[i - 1].trim();\n                    if (pVal && pVal[pVal.length - 1] === '!') {\n                        pVal = pVal.replace(/['!]/g, '');\n                        if (pVal !== actSheet.name) {\n                            continue;\n                        }\n                    }\n                    else if (parseInt(pVal, 10) === 0 && pVal[pVal.length - 1] === undefined) {\n                        if ((actSheet.id - 1) !== sheetIdx) {\n                            continue;\n                        }\n                    }\n                    range = getRangeIndexes(fArg);\n                    diff = (type === 'Column') ? (status === 'insert') ? range[3] + count : range[3] - count :\n                        (status === 'insert') ? range[2] + count : range[2] - count;\n                    diff1 = (type === 'Column') ? (status === 'insert') ? range[1] + count : range[1] - count :\n                        (status === 'insert') ? range[0] + count : range[0] - count;\n                    diff1 = (type === 'Column') ? (startIdx > range[1]) ? range[1] : diff1 : (startIdx > range[0]) ? range[0] : diff1;\n                    diff = (type === 'Column') ? (startIdx > range[3]) ? range[3] : diff : (startIdx > range[2]) ? range[2] : diff;\n                    if (diff1 > -1) {\n                        nAlpha = (type === 'Column') ? getRangeAddress([range[0], diff1, range[2], diff]).split(':')[0] :\n                            getRangeAddress([diff1, range[1], diff, range[3]]).split(':')[0];\n                    }\n                    else {\n                        nAlpha = '#REF!';\n                        hasREFVal = true;\n                    }\n                    if (status === 'delete') {\n                        ridx = parseInt(type === 'Row' ? fArg.replace(/[A-Z]/g, '') : (fArg.replace(/[0-9]/g, '')), 10);\n                        if (deleteIdxs.indexOf(ridx) > -1) {\n                            nAlpha = '#REF!';\n                            hasREFVal = true;\n                        }\n                    }\n                    splitFormula[i] = nAlpha;\n                }\n            }\n            val = '=' + splitFormula.join('');\n        }\n        return val;\n    };\n    WorkbookFormula.prototype.refreshInsDelFormula = function (args) {\n        var count;\n        var sheet;\n        var sheets = this.parent.sheets;\n        var sheetLen = sheets.length;\n        var address;\n        var cell;\n        var s;\n        var updatedFormulaVal;\n        for (s = 0; s < sheetLen; s++) {\n            count = args.model.length;\n            sheet = this.parent.sheets[s];\n            address = [0, 0, sheet.usedRange.rowIndex, sheet.usedRange.colIndex];\n            for (var i = address[2]; i >= address[0]; i--) {\n                for (var j = address[1]; j <= address[3]; j++) {\n                    cell = getCell(i, j, sheet);\n                    if (cell && cell.formula && checkIsFormula(cell.formula)) {\n                        this.clearFormula({\n                            rowIdx: i, colIdx: j, sheetIdx: s, count: count, status: args.name,\n                            type: args.modelType, startIdx: args.startIndex\n                        });\n                        updatedFormulaVal = this.refreshFormula(cell.formula, count, args.name, args.modelType, args.startIndex, s);\n                        this.parent.notify(workbookEditOperation, {\n                            action: 'updateCellValue', address: [i, j, i,\n                                j], value: updatedFormulaVal, sheetIndex: s\n                        });\n                    }\n                }\n            }\n        }\n    };\n    WorkbookFormula.prototype.parseFormula = function (formula) {\n        var temp;\n        var str;\n        var len;\n        var i = 0;\n        var arr = [];\n        var formulaVal = [];\n        formulaVal = this.markSpecialChar(formula.replace('=', ''));\n        formulaVal = formulaVal.split(/\\(|\\)|=|\\^|>|<|,|:|\\+|-|\\*|\\/|%|&/g);\n        len = formulaVal.length;\n        while (i < len) {\n            temp = formulaVal[i];\n            if (!temp) {\n                i++;\n                continue;\n            }\n            if (temp.length === 1) {\n                arr.push(this.isUniqueChar(temp) ? this.getUniqueCharVal(temp) : temp);\n            }\n            else {\n                str = temp[0];\n                if (temp.indexOf('!') > 0) {\n                    if (this.isUniqueChar(str)) {\n                        arr.push(this.getUniqueCharVal(str));\n                        temp = temp.substr(1);\n                    }\n                    str = temp.indexOf('!') + 1;\n                    arr.push(temp.substr(0, str));\n                    arr.push(temp.substr(str));\n                }\n                else if (this.isUniqueChar(str)) {\n                    arr.push(this.getUniqueCharVal(str));\n                    arr.push(temp.substr(1));\n                }\n                else {\n                    arr.push(temp);\n                }\n            }\n            i++;\n        }\n        return arr;\n    };\n    WorkbookFormula.prototype.getUniqueCharVal = function (formula) {\n        switch (formula) {\n            case this.uniqueOBracket:\n                return '(';\n            case this.uniqueCBracket:\n                return ')';\n            case this.uniqueCSeparator:\n                return ',';\n            case this.uniqueCOperator:\n                return ':';\n            case this.uniquePOperator:\n                return '+';\n            case this.uniqueSOperator:\n                return '-';\n            case this.uniqueMOperator:\n                return '*';\n            case this.uniqueDOperator:\n                return '/';\n            case this.uniqueModOperator:\n                return '%';\n            case this.uniqueConcateOperator:\n                return '&';\n            case this.uniqueEqualOperator:\n                return '=';\n            case this.uniqueExpOperator:\n                return '^';\n            case this.uniqueGTOperator:\n                return '>';\n            case this.uniqueLTOperator:\n                return '<';\n        }\n        return '';\n    };\n    WorkbookFormula.prototype.isUniqueChar = function (formula) {\n        var code = formula.charCodeAt(formula);\n        return code >= 129 && code <= 142;\n    };\n    WorkbookFormula.prototype.markSpecialChar = function (formula) {\n        formula = formula.replace(/\\(/g, '(' + this.uniqueOBracket).replace(/\\)/g, ')' + this.uniqueCBracket);\n        formula = formula.replace(/,/g, ',' + this.uniqueCSeparator).replace(/:/g, ':' + this.uniqueCOperator);\n        formula = formula.replace(/\\+/g, '+' + this.uniquePOperator).replace(/-/g, '-' + this.uniqueSOperator);\n        formula = formula.replace(/\\*/g, '*' + this.uniqueMOperator).replace(/\\//g, '/' + this.uniqueDOperator);\n        formula = formula.replace(/&/g, '&' + this.uniqueConcateOperator);\n        formula = formula.replace(/=/g, '=' + this.uniqueEqualOperator);\n        formula = formula.replace(/\\^/g, '^' + this.uniqueExpOperator);\n        formula = formula.replace(/>/g, '>' + this.uniqueGTOperator).replace(/</g, '<' + this.uniqueLTOperator);\n        return formula.replace(/%/g, '%' + this.uniqueModOperator);\n    };\n    WorkbookFormula.prototype.refreshNamedRange = function (args, action) {\n        var isChanged = false;\n        var modelDefinedNames = this.parent.definedNames;\n        var definedNames = Object.assign({}, modelDefinedNames);\n        var definedName;\n        var definedNameCnt = modelDefinedNames.length;\n        var range;\n        var rangeIndex;\n        var count;\n        var startIndex;\n        var endIndex;\n        var newIndex;\n        var newRange;\n        var sheetName;\n        var sheetIndex;\n        var sheet;\n        for (var idx = 0; idx < definedNameCnt; idx++) {\n            definedName = definedNames[idx];\n            range = definedNames[idx].refersTo.split('!')[1];\n            rangeIndex = getRangeIndexes(range);\n            sheetName = definedName.refersTo.split('!')[0].split('=')[1];\n            sheetIndex = getSheetIndex(this.parent, sheetName.replace(/'/g, ''));\n            sheet = getSheet(this.parent, sheetIndex);\n            if (sheetIndex === this.parent.activeSheetIndex) {\n                if (args.name === 'insert') {\n                    count = args.model.length;\n                    startIndex = args.index;\n                    endIndex = args.index + count;\n                    if (args.modelType === 'Row') { // for above the named range index\n                        if ((rangeIndex[0] >= endIndex) || (rangeIndex[0] >= startIndex && rangeIndex[2] >= endIndex)) {\n                            newIndex = [rangeIndex[0] + count, rangeIndex[1], rangeIndex[2] + count, rangeIndex[3]];\n                            isChanged = true;\n                        }\n                        else if ((rangeIndex[0] <= startIndex && rangeIndex[2] >= startIndex) || (rangeIndex[2] >= endIndex)) {\n                            newIndex = [rangeIndex[0], rangeIndex[1], rangeIndex[2] + count, rangeIndex[3]];\n                            isChanged = true;\n                        }\n                    }\n                    else if (args.modelType === 'Column') {\n                        if ((rangeIndex[1] >= endIndex) || (rangeIndex[1] >= startIndex && rangeIndex[3] >= endIndex)) {\n                            newIndex = [rangeIndex[0], rangeIndex[1] + count, rangeIndex[2], rangeIndex[3] + count];\n                            isChanged = true;\n                        }\n                        else if ((rangeIndex[1] <= startIndex && rangeIndex[3] >= startIndex) || (rangeIndex[3] >= endIndex)) {\n                            newIndex = [rangeIndex[0], rangeIndex[1], rangeIndex[2], rangeIndex[3] + count];\n                            isChanged = true;\n                        }\n                    }\n                }\n                else {\n                    count = args.deletedModel.length;\n                    startIndex = args.startIndex;\n                    endIndex = args.endIndex;\n                    if (args.modelType === 'Row') { // for above the named range index\n                        if ((rangeIndex[0] >= endIndex) || (rangeIndex[0] >= startIndex && rangeIndex[2] >= endIndex)) {\n                            newIndex = [rangeIndex[0] - count, rangeIndex[1], rangeIndex[2] - count, rangeIndex[3]];\n                            isChanged = true;\n                        }\n                        else if ((rangeIndex[0] <= startIndex && rangeIndex[2] >= startIndex) || (rangeIndex[2] >= endIndex)) {\n                            newIndex = [rangeIndex[0], rangeIndex[1], rangeIndex[2] - count, rangeIndex[3]];\n                            isChanged = true;\n                        }\n                    }\n                    else if (args.modelType === 'Column') {\n                        if ((rangeIndex[1] >= endIndex) || (rangeIndex[1] >= startIndex && rangeIndex[3] >= endIndex)) {\n                            newIndex = [rangeIndex[0], rangeIndex[1] - count, rangeIndex[2], rangeIndex[3] - count];\n                            isChanged = true;\n                        }\n                        else if ((rangeIndex[1] <= startIndex && rangeIndex[3] >= startIndex) || (rangeIndex[3] >= endIndex)) {\n                            newIndex = [rangeIndex[0], rangeIndex[1], rangeIndex[2], rangeIndex[3] - count];\n                            isChanged = true;\n                        }\n                    }\n                }\n                if (isChanged) {\n                    newRange = getRangeAddress(newIndex);\n                    definedName.refersTo = sheetName + '!' + newRange;\n                    this.parent.removeDefinedName(definedName.name, definedName.scope);\n                    var eventArgs = {\n                        action: 'addDefinedName', definedName: definedName, isAdded: false\n                    };\n                    this.parent.notify(workbookFormulaOperation, eventArgs);\n                }\n            }\n            modelDefinedNames = definedNames;\n        }\n    };\n    return WorkbookFormula;\n}());\nexport { WorkbookFormula };\n","import { getCell, setCell, getData } from '../base/index';\nimport { DataManager, Query, DataUtil, Deferred } from '@syncfusion/ej2-data';\nimport { getCellIndexes, getIndexesFromAddress, getColumnHeaderText, getRangeAddress, workbookLocale } from '../common/index';\nimport { getSwapRange } from '../common/index';\nimport { initiateSort } from '../common/event';\nimport { isNullOrUndefined } from '@syncfusion/ej2-base';\n/**\n * The `WorkbookSort` module is used to handle sort action in Spreadsheet.\n */\nvar WorkbookSort = /** @class */ (function () {\n    /**\n     * Constructor for WorkbookSort module.\n     */\n    function WorkbookSort(parent) {\n        this.parent = parent;\n        this.addEventListener();\n    }\n    /**\n     * To destroy the sort module.\n     */\n    WorkbookSort.prototype.destroy = function () {\n        this.removeEventListener();\n        this.parent = null;\n    };\n    WorkbookSort.prototype.addEventListener = function () {\n        this.parent.on(initiateSort, this.initiateSortHandler, this);\n    };\n    WorkbookSort.prototype.removeEventListener = function () {\n        if (!this.parent.isDestroyed) {\n            this.parent.off(initiateSort, this.initiateSortHandler);\n        }\n    };\n    /**\n     * Sorts range of cells in the sheet.\n     * @param args - arguments for sorting.\n     */\n    WorkbookSort.prototype.initiateSortHandler = function (eventArgs) {\n        var _this = this;\n        var args = eventArgs.args;\n        var deferred = new Deferred();\n        var sheet = this.parent.getActiveSheet();\n        var range = getSwapRange(getIndexesFromAddress(args.range));\n        var sortOptions = args.sortOptions || { sortDescriptors: {}, containsHeader: true };\n        var isSingleCell = false;\n        eventArgs.promise = deferred.promise;\n        if (range[0] > sheet.usedRange.rowIndex || range[1] > sheet.usedRange.colIndex) {\n            deferred.reject(this.parent.serviceLocator.getService(workbookLocale).getConstant('SortOutOfRangeError'));\n            return;\n        }\n        var containsHeader = sortOptions.containsHeader;\n        if (range[0] === range[2]) { //if selected range is a single cell \n            range = this.getSortDataRange(range[0], range[1], sheet);\n            isSingleCell = true;\n            if (isNullOrUndefined(sortOptions.containsHeader)) {\n                if (typeof getCell(range[0], range[1], sheet, null, true).value ===\n                    typeof getCell(range[0] + 1, range[1], sheet, null, true).value) {\n                    containsHeader = this.isSameStyle(getCell(range[0], range[1], sheet, null, true).style, getCell(range[0] + 1, range[1], sheet, null, true).style) ? false : true;\n                }\n                else {\n                    containsHeader = true;\n                }\n            }\n        }\n        if ((isNullOrUndefined(args.sortOptions) || isNullOrUndefined(args.sortOptions.containsHeader)) && !isSingleCell) {\n            if (!isNullOrUndefined(getCell(range[0], range[1], sheet)) && !isNullOrUndefined(getCell(range[0] + 1, range[1], sheet))) {\n                if (typeof getCell(range[0], range[1], sheet).value === typeof getCell(range[0] + 1, range[1], sheet).value) {\n                    containsHeader = false;\n                }\n                else {\n                    containsHeader = true;\n                }\n            }\n        }\n        var sRIdx = range[0] = containsHeader ? range[0] + 1 : range[0];\n        var sCIdx;\n        var eCIdx;\n        var cell = getCellIndexes(sheet.activeCell);\n        var header = getColumnHeaderText(cell[1] + 1);\n        var sortDescriptors = sortOptions.sortDescriptors;\n        var address = getRangeAddress(range);\n        getData(this.parent, sheet.name + \"!\" + address, true).then(function (jsonData) {\n            var dataManager = new DataManager(jsonData);\n            var query = new Query();\n            if (Array.isArray(sortDescriptors)) { //multi-column sorting.\n                if (!sortDescriptors || sortDescriptors.length === 0) {\n                    sortDescriptors = [{ field: header }];\n                }\n                for (var length_1 = sortDescriptors.length, i = length_1 - 1; i > -1; i--) {\n                    if (!sortDescriptors[length_1 - 1].field) {\n                        sortDescriptors[length_1 - 1].field = header;\n                    }\n                    if (!sortDescriptors[i].field) {\n                        continue;\n                    }\n                    var comparerFn = sortDescriptors[i].sortComparer\n                        || _this.sortComparer.bind(_this, sortDescriptors[i], sortOptions.caseSensitive);\n                    query.sortBy(sortDescriptors[i].field, comparerFn);\n                }\n            }\n            else { //single column sorting.\n                if (!sortDescriptors) {\n                    sortDescriptors = { field: header };\n                }\n                if (!sortDescriptors.field) {\n                    sortDescriptors.field = header;\n                }\n                var comparerFn = sortDescriptors.sortComparer\n                    || _this.sortComparer.bind(_this, sortDescriptors, sortOptions.caseSensitive);\n                query.sortBy(sortDescriptors.field, comparerFn);\n            }\n            dataManager.executeQuery(query).then(function (e) {\n                var colName;\n                var cell = {};\n                var rowKey = '__rowIndex';\n                Array.prototype.forEach.call(e.result, function (data, index) {\n                    if (!data) {\n                        return;\n                    }\n                    sCIdx = range[1];\n                    eCIdx = range[3];\n                    sRIdx = parseInt(jsonData[index][rowKey], 10) - 1;\n                    for (sCIdx; sCIdx <= eCIdx; sCIdx++) {\n                        colName = getColumnHeaderText(sCIdx + 1);\n                        cell = data[colName];\n                        setCell(sRIdx, sCIdx, sheet, cell);\n                    }\n                });\n                var eventArgs = { range: sheet.name + \"!\" + address, sortOptions: args.sortOptions };\n                deferred.resolve(eventArgs);\n            });\n        });\n    };\n    WorkbookSort.prototype.isSameStyle = function (firstCellStyle, secondCellStyle) {\n        if (firstCellStyle === void 0) { firstCellStyle = {}; }\n        if (secondCellStyle === void 0) { secondCellStyle = {}; }\n        var sameStyle = true;\n        var keys = Object.keys(firstCellStyle);\n        for (var i = 0; i < keys.length; i++) {\n            if (firstCellStyle[keys[i]] === secondCellStyle[keys[i]] || this.parent.cellStyle[keys[i]] === firstCellStyle[keys[i]]) {\n                sameStyle = true;\n            }\n            else {\n                sameStyle = false;\n                break;\n            }\n        }\n        return sameStyle;\n    };\n    WorkbookSort.prototype.getSortDataRange = function (rowIdx, colIdx, sheet) {\n        var topIdx = rowIdx;\n        var btmIdx = rowIdx;\n        var leftIdx = colIdx;\n        var prevleftIdx;\n        var rightIdx = colIdx;\n        var prevrightIdx;\n        var topReached;\n        var btmReached;\n        var leftReached;\n        var rightReached;\n        for (var i = 1;; i++) {\n            if (!btmReached && getCell(rowIdx + i, colIdx, sheet, null, true).value) {\n                btmIdx = rowIdx + i;\n            }\n            else {\n                btmReached = true;\n            }\n            if (!topReached && getCell(rowIdx - i, colIdx, sheet, null, true).value) {\n                topIdx = rowIdx - i;\n            }\n            else {\n                topReached = true;\n            }\n            if (topReached && btmReached) {\n                break;\n            }\n        }\n        for (var j = 1;; j++) {\n            prevleftIdx = leftIdx;\n            prevrightIdx = rightIdx;\n            for (var i = topIdx; i <= btmIdx; i++) {\n                if (!leftReached && getCell(i, leftIdx - 1, sheet, null, true).value) {\n                    leftIdx = prevleftIdx - 1;\n                }\n                if (!rightReached && getCell(i, rightIdx + 1, sheet, null, true).value) {\n                    rightIdx = prevrightIdx + 1;\n                }\n                if (i === btmIdx) {\n                    if (leftIdx === prevleftIdx) {\n                        leftReached = true;\n                    }\n                    if (rightIdx === prevrightIdx) {\n                        rightReached = true;\n                    }\n                }\n                if (rightReached && leftReached) {\n                    return [topIdx, leftIdx, btmIdx, rightIdx];\n                }\n            }\n        }\n    };\n    /**\n     * Compares the two cells for sorting.\n     * @param sortDescriptor - protocol for sorting.\n     * @param caseSensitive - value for case sensitive.\n     * @param x - first cell\n     * @param y - second cell\n     */\n    WorkbookSort.prototype.sortComparer = function (sortDescriptor, caseSensitive, x, y) {\n        var direction = sortDescriptor.order || '';\n        var comparer = DataUtil.fnSort(direction);\n        var caseOptions = { sensitivity: caseSensitive ? 'case' : 'base' };\n        if (x && y && (typeof x.value === 'string' || typeof y.value === 'string')) {\n            var collator = new Intl.Collator(this.parent.locale, caseOptions);\n            if (!direction || direction.toLowerCase() === 'ascending') {\n                return collator.compare(x.value, y.value);\n            }\n            else {\n                return collator.compare(x.value, y.value) * -1;\n            }\n        }\n        if ((x === null || isNullOrUndefined(x.value)) && (y === null || isNullOrUndefined(y.value))) {\n            return -1;\n        }\n        if (x === null || isNullOrUndefined(x.value)) {\n            return 1;\n        }\n        if (y === null || isNullOrUndefined(y.value)) {\n            return -1;\n        }\n        return comparer(x ? x.value : x, y ? y.value : y);\n    };\n    /**\n     * Gets the module name.\n     * @returns string\n     */\n    WorkbookSort.prototype.getModuleName = function () {\n        return 'workbookSort';\n    };\n    return WorkbookSort;\n}());\nexport { WorkbookSort };\n","import { getData } from '../base/index';\nimport { DataManager, Query, Deferred, Predicate } from '@syncfusion/ej2-data';\nimport { getCellIndexes, getIndexesFromAddress, getSwapRange, getRangeAddress } from '../common/index';\nimport { initiateFilter, clearAllFilter } from '../common/event';\n/**\n * The `WorkbookFilter` module is used to handle filter action in Spreadsheet.\n */\nvar WorkbookFilter = /** @class */ (function () {\n    /**\n     * Constructor for WorkbookFilter module.\n     */\n    function WorkbookFilter(parent) {\n        this.parent = parent;\n        this.addEventListener();\n    }\n    /**\n     * To destroy the filter module.\n     */\n    WorkbookFilter.prototype.destroy = function () {\n        this.removeEventListener();\n        this.filterRange = null;\n        this.parent = null;\n    };\n    WorkbookFilter.prototype.addEventListener = function () {\n        this.parent.on(initiateFilter, this.initiateFilterHandler, this);\n        this.parent.on(clearAllFilter, this.clearAllFilterHandler, this);\n    };\n    WorkbookFilter.prototype.removeEventListener = function () {\n        if (!this.parent.isDestroyed) {\n            this.parent.off(initiateFilter, this.initiateFilterHandler);\n            this.parent.off(clearAllFilter, this.clearAllFilterHandler);\n        }\n    };\n    /**\n     * Filters a range of cells in the sheet.\n     * @param args - arguments for filtering.\n     */\n    WorkbookFilter.prototype.initiateFilterHandler = function (eventArgs) {\n        var _this = this;\n        var args = eventArgs.args;\n        var deferred = new Deferred();\n        var sheet = this.parent.getActiveSheet();\n        var filterOptions = args.filterOptions || {};\n        eventArgs.promise = deferred.promise;\n        this.filterRange = args.range;\n        if (filterOptions.datasource) {\n            this.setFilter(filterOptions.datasource, filterOptions.predicates);\n            var filterEventArgs = { range: args.range, filterOptions: filterOptions };\n            deferred.resolve(filterEventArgs);\n        }\n        else {\n            var range = getSwapRange(getIndexesFromAddress(args.range));\n            if (range[0] > sheet.usedRange.rowIndex || range[1] > sheet.usedRange.colIndex) {\n                deferred.reject('Select a cell or range inside the used range and try again.');\n                return;\n            }\n            if (range[0] === range[2] && (range[2] - range[0]) === 0) { //if selected range is a single cell \n                range[0] = 0;\n                range[1] = 0;\n                range[3] = sheet.usedRange.colIndex;\n            }\n            range[2] = sheet.usedRange.rowIndex; //filter range should be till used range.\n            range[0] = range[0] + 1; //ignore first row        \n            var address_1 = getRangeAddress(range);\n            getData(this.parent, sheet.name + \"!\" + address_1, true, true).then(function (jsonData) {\n                var dataManager = new DataManager(jsonData);\n                _this.setFilter(dataManager, filterOptions.predicates);\n                var filterEventArgs = { range: address_1, filterOptions: filterOptions };\n                deferred.resolve(filterEventArgs);\n            });\n        }\n    };\n    /**\n     * Hides or unhides the rows based on the filter predicates.\n     */\n    WorkbookFilter.prototype.setFilter = function (dataManager, predicates) {\n        var _this = this;\n        if (dataManager && predicates) {\n            var jsonData = dataManager.dataSource.json;\n            var query = new Query();\n            if (predicates.length) {\n                query.where(Predicate.and(predicates));\n            }\n            var result_1 = dataManager.executeLocal(query);\n            var rowKey_1 = '__rowIndex';\n            jsonData.forEach(function (data, index) {\n                if (!data) {\n                    return;\n                }\n                _this.parent.hideRow(parseInt(data[rowKey_1], 10) - 1, undefined, result_1.indexOf(data) < 0);\n            });\n        }\n    };\n    /**\n     * Clears all the filters in the sheet.\n     */\n    WorkbookFilter.prototype.clearAllFilterHandler = function () {\n        if (this.filterRange) {\n            var range = getCellIndexes(this.filterRange);\n            var sheet = this.parent.getActiveSheet();\n            this.parent.hideRow(range[0], sheet.usedRange.rowIndex - 1, false);\n        }\n    };\n    /**\n     * Gets the module name.\n     * @returns string\n     */\n    WorkbookFilter.prototype.getModuleName = function () {\n        return 'workbookFilter';\n    };\n    return WorkbookFilter;\n}());\nexport { WorkbookFilter };\n","import { getRangeIndexes } from '../common/index';\nimport { getCell, setCell, getSheetIndex } from '../base/index';\nimport { setImage } from '../common/event';\n/**\n * Specifies image.\n */\nvar WorkbookImage = /** @class */ (function () {\n    function WorkbookImage(parent) {\n        this.parent = parent;\n        this.addEventListener();\n    }\n    WorkbookImage.prototype.setImage = function (args) {\n        var imgRange = args.range ? (args.range.indexOf('!') > 0) ? args.range.split('!')[1] : args.range.split('!')[0]\n            : this.parent.getActiveSheet().selectedRange;\n        var sheetIdx = (args.range && args.range.indexOf('!') > 0) ?\n            getSheetIndex(this.parent, args.range.split('!')[0]) : this.parent.activeSheetIndex;\n        var indexes = getRangeIndexes(imgRange);\n        var sheet = sheetIdx ? this.parent.sheets[sheetIdx] : this.parent.getActiveSheet();\n        var cell = getCell(indexes[0], indexes[1], sheet);\n        var oldImgData;\n        var imgData = args.options;\n        if (cell && cell.image) {\n            oldImgData = cell.image;\n            for (var i = 0; i < imgData.length; i++) {\n                oldImgData.push(imgData[i]);\n            }\n        }\n        setCell(indexes[0], indexes[1], sheet, { image: (cell && cell.image) ? oldImgData : imgData }, true);\n    };\n    /**\n     * Adding event listener for number format.\n     */\n    WorkbookImage.prototype.addEventListener = function () {\n        this.parent.on(setImage, this.setImage, this);\n    };\n    /**\n     * Removing event listener for number format.\n     */\n    WorkbookImage.prototype.removeEventListener = function () {\n        if (!this.parent.isDestroyed) {\n            this.parent.off(setImage, this.setImage);\n        }\n    };\n    /**\n     * To Remove the event listeners.\n     */\n    WorkbookImage.prototype.destroy = function () {\n        this.removeEventListener();\n        this.parent = null;\n    };\n    /**\n     * Get the workbook number format module name.\n     */\n    WorkbookImage.prototype.getModuleName = function () {\n        return 'workbookImage';\n    };\n    return WorkbookImage;\n}());\nexport { WorkbookImage };\n","import { getRangeIndexes, inRange } from '../common/index';\nimport { setCell, getSheetIndex, getCell, getSheetNameFromAddress } from '../base/index';\nimport { setChart, initiateChart, refreshChart, updateChart, deleteChartColl, refreshChartSize, focusChartBorder } from '../common/event';\nimport { closest, isNullOrUndefined, getComponent } from '@syncfusion/ej2-base';\n/**\n * The `WorkbookChart` module is used to handle chart action in Spreadsheet.\n */\nvar WorkbookChart = /** @class */ (function () {\n    /**\n     * Constructor for WorkbookChart module.\n     */\n    function WorkbookChart(parent) {\n        this.parent = parent;\n        this.addEventListener();\n    }\n    WorkbookChart.prototype.addEventListener = function () {\n        this.parent.on(setChart, this.setChartHandler, this);\n        this.parent.on(refreshChart, this.refreshChartData, this);\n        this.parent.on(deleteChartColl, this.deleteChartColl, this);\n        this.parent.on(refreshChartSize, this.refreshChartSize, this);\n        this.parent.on(focusChartBorder, this.focusChartBorder, this);\n    };\n    WorkbookChart.prototype.removeEventListener = function () {\n        if (!this.parent.isDestroyed) {\n            this.parent.off(setChart, this.setChartHandler);\n            this.parent.off(refreshChart, this.refreshChartData);\n            this.parent.off(deleteChartColl, this.deleteChartColl);\n            this.parent.off(refreshChartSize, this.refreshChartSize);\n            this.parent.off(focusChartBorder, this.focusChartBorder);\n        }\n    };\n    WorkbookChart.prototype.setChartHandler = function (args) {\n        var i = 0;\n        args.isInitCell = isNullOrUndefined(args.isInitCell) ? false : args.isInitCell;\n        args.isUndoRedo = isNullOrUndefined(args.isUndoRedo) ? true : args.isUndoRedo;\n        args.isPaste = isNullOrUndefined(args.isPaste) ? false : args.isPaste;\n        var chart = args.chart;\n        if (chart.length > 0) {\n            while (i < chart.length) {\n                if (args.isCut === false) {\n                    if (document.getElementById(args.chart[i].id)) {\n                        chart[i] = {\n                            range: chart[i].range, id: 'e_spreadsheet_chart_' + this.parent.chartCount,\n                            isSeriesInRows: chart[i].isSeriesInRows, theme: chart[i].theme, type: chart[i].type\n                        };\n                        chart[i].id = 'e_spreadsheet_chart_' + this.parent.chartCount;\n                        args.isIdAvailabe = false;\n                    }\n                }\n                if (document.getElementById(args.chart[i].id)) {\n                    return;\n                }\n                var idAvailable = isNullOrUndefined(args.isIdAvailabe) ? true : args.isIdAvailabe;\n                chart[i].theme = chart[i].theme || 'Material';\n                chart[i].type = chart[i].type || 'Line';\n                chart[i].isSeriesInRows = chart[i].isSeriesInRows || false;\n                chart[i].range = chart[i].range || this.parent.getActiveSheet().selectedRange;\n                if (chart[i].range.indexOf('!') < 0) {\n                    chart[i].range = this.parent.getActiveSheet().name + '!' + chart[i].range;\n                }\n                if (isNullOrUndefined(chart[i].id)) {\n                    chart[i].id = 'e_spreadsheet_chart_' + this.parent.chartCount;\n                    idAvailable = false;\n                }\n                chart[i].height = chart[i].height || 290;\n                chart[i].width = chart[i].width || 480;\n                this.parent.notify(initiateChart, {\n                    option: chart[i], chartCount: this.parent.chartCount, isInitCell: args.isInitCell, isUndoRedo: args.isUndoRedo,\n                    dataSheetIdx: args.dataSheetIdx, range: args.range\n                });\n                this.parent.chartColl.push(chart[i]);\n                if (!idAvailable) {\n                    this.parent.chartCount++;\n                }\n                if (!args.isInitCell || args.isPaste) {\n                    var sheetIdx = (chart[i].range && chart[i].range.indexOf('!') > 0) ?\n                        getSheetIndex(this.parent, chart[i].range.split('!')[0]) : this.parent.activeSheetIndex;\n                    var indexes = args.isPaste ? getRangeIndexes(args.range) : getRangeIndexes(chart[i].range);\n                    var sheet = sheetIdx ? this.parent.sheets[sheetIdx] : this.parent.getActiveSheet();\n                    var cell = getCell(indexes[0], indexes[1], sheet);\n                    if (cell && cell.chart) {\n                        cell.chart.push(chart[i]);\n                    }\n                    else {\n                        setCell(indexes[0], indexes[1], sheet, { chart: [chart[i]] }, true);\n                    }\n                }\n                i++;\n            }\n        }\n    };\n    WorkbookChart.prototype.refreshChartData = function (args) {\n        var i;\n        var j = 1;\n        var cnt = this.parent.sheets.length + 1;\n        while (j < cnt) {\n            var charts = this.parent.chartColl;\n            i = charts ? charts.length : 0;\n            if (i) {\n                while (i--) {\n                    var chart = this.parent.chartColl[i];\n                    var isInRange = inRange(getRangeIndexes(chart.range), args.rIdx, args.cIdx);\n                    var rangeSheetIdx = chart.range.indexOf('!') > -1 ?\n                        getSheetIndex(this.parent, getSheetNameFromAddress(chart.range)) : this.parent.activeSheetIndex;\n                    if (isInRange && rangeSheetIdx === this.parent.activeSheetIndex) {\n                        this.parent.notify(updateChart, { chart: chart });\n                    }\n                }\n            }\n            j++;\n        }\n    };\n    WorkbookChart.prototype.refreshChartSize = function (args) {\n        var chartCnt;\n        var j = 1;\n        var sheetCnt = this.parent.sheets.length + 1;\n        while (j < sheetCnt) {\n            var charts = this.parent.chartColl;\n            chartCnt = charts ? charts.length : 0;\n            if (chartCnt) {\n                while (chartCnt--) {\n                    var chart = this.parent.chartColl[chartCnt];\n                    if (!isNullOrUndefined(args.overlayEle.querySelector('#' + chart.id))) {\n                        var chartObj = this.parent.element.querySelector('.' + chart.id);\n                        var excelFilter = getComponent(chartObj, 'chart');\n                        excelFilter.height = args.height;\n                        excelFilter.width = args.width;\n                    }\n                }\n            }\n            j++;\n        }\n    };\n    WorkbookChart.prototype.focusChartBorder = function (args) {\n        for (var idx = 0; idx < this.parent.chartColl.length; idx++) {\n            var overlayEle = document.getElementById(args.id);\n            var chartEle = document.getElementById(this.parent.chartColl[idx].id);\n            if (overlayEle && chartEle && closest(chartEle, '.' + overlayEle.classList[1]) === overlayEle) {\n                this.parent.notify(initiateChart, {\n                    option: this.parent.chartColl[idx], chartCount: this.parent.chartCount, isRefresh: true\n                });\n            }\n        }\n    };\n    WorkbookChart.prototype.deleteChartColl = function (args) {\n        for (var idx = 0; idx < this.parent.chartColl.length; idx++) {\n            var chartElement = document.getElementById(this.parent.chartColl[idx].id);\n            var overlayElement = document.getElementById(args.id);\n            if (overlayElement && chartElement && closest(chartElement, '.' + overlayElement.classList[1]) === overlayElement) {\n                this.parent.chartColl.splice(idx, 1);\n            }\n        }\n    };\n    /**\n     * To Remove the event listeners.\n     */\n    WorkbookChart.prototype.destroy = function () {\n        this.removeEventListener();\n        this.parent = null;\n    };\n    /**\n     * Get the workbook chart module name.\n     */\n    WorkbookChart.prototype.getModuleName = function () {\n        return 'workbookChart';\n    };\n    return WorkbookChart;\n}());\nexport { WorkbookChart };\n","import { getRangeIndexes, setCellFormat, applyCellFormat, activeCellChanged } from '../common/index';\nimport { getSwapRange, textDecorationUpdate } from '../common/index';\nimport { clear, getIndexesFromAddress } from '../common/index';\nimport { getSheetIndex, isHiddenRow, getSheet, getCell, setCell } from '../base/index';\n/**\n * Workbook Cell format.\n */\nvar WorkbookCellFormat = /** @class */ (function () {\n    function WorkbookCellFormat(parent) {\n        this.parent = parent;\n        this.addEventListener();\n    }\n    WorkbookCellFormat.prototype.format = function (args) {\n        var sheet;\n        var rng = args.range;\n        var eventArgs;\n        if (rng && typeof rng === 'string' && rng.indexOf('!') > -1) {\n            rng = rng.split('!')[1];\n            sheet = this.parent.sheets[getSheetIndex(this.parent, args.range.split('!')[0])];\n        }\n        else {\n            sheet = this.parent.getActiveSheet();\n        }\n        if (rng === undefined) {\n            rng = sheet.selectedRange;\n        }\n        var triggerEvent = typeof (rng) !== 'object' && args.onActionUpdate;\n        eventArgs = { range: rng, style: args.style, requestType: 'CellFormat' };\n        if (triggerEvent) {\n            this.parent.trigger('beforeCellFormat', eventArgs);\n            this.parent.notify('actionBegin', { eventArgs: eventArgs, action: 'format' });\n            if (eventArgs.cancel) {\n                args.cancel = true;\n                return;\n            }\n        }\n        var indexes = typeof (eventArgs.range) === 'object' ? eventArgs.range :\n            getSwapRange(getRangeIndexes(eventArgs.range));\n        if (args.borderType) {\n            this.setTypedBorder(sheet, args.style.border, indexes, args.borderType, args.onActionUpdate);\n            delete args.style.border;\n        }\n        if (eventArgs.style.borderTop !== undefined) {\n            for (var i = indexes[1]; i <= indexes[3]; i++) {\n                this.checkAdjustantBorder(sheet, 'borderBottom', indexes[0] - 1, i);\n                this.checkFullBorder(sheet, 'borderBottom', indexes[0] - 1, i);\n                this.checkFullBorder(sheet, 'borderTop', indexes[0], i);\n                this.setCellBorder(sheet, { borderTop: eventArgs.style.borderTop }, indexes[0], i, args.onActionUpdate, i === indexes[3]);\n            }\n            delete eventArgs.style.borderTop;\n        }\n        if (eventArgs.style.borderBottom !== undefined) {\n            for (var i = indexes[1]; i <= indexes[3]; i++) {\n                this.checkAdjustantBorder(sheet, 'borderTop', indexes[2] + 1, i);\n                this.checkFullBorder(sheet, 'borderTop', indexes[2] + 1, i);\n                this.checkFullBorder(sheet, 'borderBottom', indexes[2], i);\n                this.setCellBorder(sheet, { borderBottom: eventArgs.style.borderBottom }, indexes[2], i, args.onActionUpdate, i === indexes[3]);\n                this.setBottomBorderPriority(sheet, indexes[2], i);\n            }\n            delete eventArgs.style.borderBottom;\n        }\n        if (eventArgs.style.borderLeft !== undefined) {\n            for (var i = indexes[0]; i <= indexes[2]; i++) {\n                this.checkAdjustantBorder(sheet, 'borderRight', i, indexes[1] - 1);\n                this.checkFullBorder(sheet, 'borderRight', i, indexes[1] - 1);\n                this.checkFullBorder(sheet, 'borderLeft', i, indexes[1]);\n                this.setCellBorder(sheet, { borderLeft: eventArgs.style.borderLeft }, i, indexes[1], args.onActionUpdate);\n            }\n            delete eventArgs.style.borderLeft;\n        }\n        if (eventArgs.style.borderRight !== undefined) {\n            for (var i = indexes[0]; i <= indexes[2]; i++) {\n                this.checkAdjustantBorder(sheet, 'borderLeft', i, indexes[3] - 1);\n                this.checkFullBorder(sheet, 'borderLeft', i, indexes[3] - 1);\n                this.checkFullBorder(sheet, 'borderRight', i, indexes[3]);\n                this.setCellBorder(sheet, { borderRight: eventArgs.style.borderRight }, i, indexes[3], args.onActionUpdate);\n            }\n            delete eventArgs.style.borderRight;\n        }\n        var border;\n        var isFullBorder;\n        if (Object.keys(args.style).length) {\n            for (var i = indexes[0]; i <= indexes[2]; i++) {\n                for (var j = indexes[1]; j <= indexes[3]; j++) {\n                    if (isFullBorder === undefined) {\n                        if (eventArgs.style.border !== undefined) {\n                            border = eventArgs.style.border;\n                            eventArgs.style.border = undefined;\n                            isFullBorder = true;\n                        }\n                        else {\n                            isFullBorder = false;\n                        }\n                    }\n                    if (isFullBorder) {\n                        this.setFullBorder(sheet, border, indexes, i, j, args.onActionUpdate);\n                    }\n                    this.setCellStyle(sheet, i, j, eventArgs.style);\n                    if (this.parent.getActiveSheet().id === sheet.id) {\n                        this.parent.notify(applyCellFormat, { style: eventArgs.style, rowIdx: i, colIdx: j,\n                            lastCell: j === indexes[3], isHeightCheckNeeded: true, manualUpdate: true, onActionUpdate: args.onActionUpdate\n                        });\n                    }\n                }\n            }\n        }\n        if (isFullBorder) {\n            eventArgs.style.border = border;\n        }\n        this.parent.setUsedRange(indexes[2], indexes[3]);\n        if (args.refreshRibbon) {\n            this.parent.notify(activeCellChanged, null);\n        }\n        if (triggerEvent) {\n            eventArgs.range = sheet.name + \"!\" + rng;\n            this.parent.notify('actionComplete', { eventArgs: eventArgs, action: 'format' });\n        }\n    };\n    WorkbookCellFormat.prototype.setBottomBorderPriority = function (sheet, rowIdx, colIdx) {\n        if (isHiddenRow(sheet, rowIdx + 1)) {\n            var pIdx = this.skipHiddenRows(sheet, rowIdx + 1);\n            var pCellStyle = this.parent.getCellStyleValue(['borderTop'], [pIdx, colIdx]).borderTop;\n            if (pCellStyle !== '') {\n                sheet.rows[rowIdx].cells[colIdx].style.bottomPriority = true;\n            }\n        }\n    };\n    WorkbookCellFormat.prototype.setFullBorder = function (sheet, border, indexes, i, j, actionUpdate) {\n        var style = {};\n        if (i === indexes[0]) {\n            this.checkAdjustantBorder(sheet, 'borderBottom', i - 1, j);\n            this.checkFullBorder(sheet, 'borderBottom', i - 1, j);\n        }\n        if (j === indexes[1]) {\n            this.checkAdjustantBorder(sheet, 'borderRight', i, j - 1);\n            this.checkFullBorder(sheet, 'borderRight', i, j - 1);\n        }\n        if (j === indexes[3]) {\n            this.checkAdjustantBorder(sheet, 'borderLeft', i, j + 1);\n            this.checkFullBorder(sheet, 'borderLeft', i, j + 1);\n        }\n        else {\n            this.checkAdjustantBorder(sheet, 'border', i, j + 1);\n        }\n        style.borderRight = border;\n        style.borderTop = border;\n        style.borderLeft = border;\n        style.borderBottom = border;\n        this.setCellBorder(sheet, style, i, j, actionUpdate, j === indexes[3]);\n        if (i === indexes[2]) {\n            this.checkAdjustantBorder(sheet, 'borderTop', i + 1, j);\n            this.checkFullBorder(sheet, 'borderTop', i + 1, j);\n            this.setBottomBorderPriority(sheet, i, j);\n        }\n        else {\n            this.checkAdjustantBorder(sheet, 'border', i + 1, j);\n        }\n    };\n    WorkbookCellFormat.prototype.checkAdjustantBorder = function (sheet, prop, rowIdx, colIdx) {\n        var style = {};\n        if (this.parent.getCellStyleValue([prop], [rowIdx, colIdx])[prop] !== '') {\n            style[prop] = undefined;\n            this.setCellStyle(sheet, rowIdx, colIdx, style);\n        }\n    };\n    WorkbookCellFormat.prototype.checkFullBorder = function (sheet, prop, rowIdx, colIdx) {\n        var border = this.parent.getCellStyleValue(['border'], [rowIdx, colIdx]).border;\n        if (border !== '') {\n            var style_1 = { border: undefined };\n            ['borderBottom', 'borderTop', 'borderLeft', 'borderRight'].forEach(function (value) {\n                if (value !== prop) {\n                    style_1[value] = border;\n                }\n            });\n            this.setCellStyle(sheet, rowIdx, colIdx, style_1);\n        }\n    };\n    WorkbookCellFormat.prototype.textDecorationActionUpdate = function (args) {\n        var sheet = this.parent.getActiveSheet();\n        var eventArgs = { range: sheet.selectedRange, style: args.style, requestType: 'CellFormat' };\n        this.parent.trigger('beforeCellFormat', eventArgs);\n        this.parent.notify('actionBegin', { eventArgs: eventArgs, action: 'format' });\n        if (eventArgs.cancel) {\n            args.cancel = true;\n            return;\n        }\n        var indexes = getSwapRange(getRangeIndexes(sheet.selectedRange));\n        var value = args.style.textDecoration;\n        var changedValue = value;\n        var activeCellIndexes = getRangeIndexes(sheet.activeCell);\n        var cellValue = this.parent.getCellStyleValue(['textDecoration'], activeCellIndexes).textDecoration;\n        var changedStyle;\n        var removeProp = false;\n        if (cellValue === 'underline') {\n            changedValue = value === 'underline' ? 'none' : 'underline line-through';\n        }\n        else if (cellValue === 'line-through') {\n            changedValue = value === 'line-through' ? 'none' : 'underline line-through';\n        }\n        else if (cellValue === 'underline line-through') {\n            changedValue = value === 'underline' ? 'line-through' : 'underline';\n            removeProp = true;\n        }\n        if (changedValue === 'none') {\n            removeProp = true;\n        }\n        this.format({\n            style: { textDecoration: changedValue }, range: activeCellIndexes, refreshRibbon: args.refreshRibbon,\n            onActionUpdate: true\n        });\n        for (var i = indexes[0]; i <= indexes[2]; i++) {\n            for (var j = indexes[1]; j <= indexes[3]; j++) {\n                if (i === activeCellIndexes[0] && j === activeCellIndexes[1]) {\n                    continue;\n                }\n                changedStyle = {};\n                cellValue = this.parent.getCellStyleValue(['textDecoration'], [i, j]).textDecoration;\n                if (cellValue === 'none') {\n                    if (removeProp) {\n                        continue;\n                    }\n                    changedStyle.textDecoration = value;\n                }\n                else if (cellValue === 'underline' || cellValue === 'line-through') {\n                    if (removeProp) {\n                        if (value === cellValue) {\n                            changedStyle.textDecoration = 'none';\n                        }\n                        else {\n                            continue;\n                        }\n                    }\n                    else {\n                        changedStyle.textDecoration = value !== cellValue ? 'underline line-through' : value;\n                    }\n                }\n                else if (cellValue === 'underline line-through') {\n                    if (removeProp) {\n                        changedStyle.textDecoration = value === 'underline' ? 'line-through' : 'underline';\n                    }\n                    else {\n                        continue;\n                    }\n                }\n                this.format({\n                    style: changedStyle, range: [i, j, i, j], refreshRibbon: args.refreshRibbon,\n                    onActionUpdate: true\n                });\n            }\n        }\n        eventArgs.range = sheet.name + '!' + eventArgs.range;\n        this.parent.notify('actionComplete', { eventArgs: eventArgs, action: 'format' });\n    };\n    WorkbookCellFormat.prototype.setTypedBorder = function (sheet, border, range, type, actionUpdate) {\n        var prevBorder;\n        if (type === 'Outer') {\n            for (var colIdx = range[1]; colIdx <= range[3]; colIdx++) {\n                this.checkAdjustantBorder(sheet, 'borderBottom', range[0] - 1, colIdx);\n                this.checkFullBorder(sheet, 'borderBottom', range[0] - 1, colIdx);\n                this.setCellBorder(sheet, { borderTop: border }, range[0], colIdx, actionUpdate, colIdx === range[3]);\n                this.checkAdjustantBorder(sheet, 'borderTop', range[2] + 1, colIdx);\n                this.checkFullBorder(sheet, 'borderTop', range[2] + 1, colIdx);\n                this.setCellBorder(sheet, { borderBottom: border }, range[2], colIdx, actionUpdate, colIdx === range[3]);\n                this.setBottomBorderPriority(sheet, range[2], colIdx);\n            }\n            for (var rowIdx = range[0]; rowIdx <= range[2]; rowIdx++) {\n                this.checkAdjustantBorder(sheet, 'borderRight', rowIdx, range[1] - 1);\n                this.checkFullBorder(sheet, 'borderRight', rowIdx, range[1] - 1);\n                this.setCellBorder(sheet, { borderLeft: border }, rowIdx, range[1], actionUpdate);\n                this.checkAdjustantBorder(sheet, 'borderLeft', rowIdx, range[3] + 1);\n                this.checkFullBorder(sheet, 'borderLeft', rowIdx, range[3] + 1);\n                this.setCellBorder(sheet, { borderRight: border }, rowIdx, range[3], actionUpdate);\n            }\n        }\n        else if (type === 'Inner') {\n            for (var i = range[0]; i <= range[2]; i++) {\n                for (var j = range[1]; j <= range[3]; j++) {\n                    var style = {};\n                    prevBorder = this.parent.getCellStyleValue(['border'], [i, j]).border;\n                    if (prevBorder !== '') {\n                        style.border = undefined;\n                        if (j === range[3] || j === range[1] || i === range[0] || i === range[2]) {\n                            if (i === range[0]) {\n                                style.borderTop = prevBorder;\n                            }\n                            if (i === range[2]) {\n                                style.borderBottom = prevBorder;\n                            }\n                            if (j === range[3]) {\n                                style.borderRight = prevBorder;\n                            }\n                            if (j === range[1]) {\n                                style.borderLeft = prevBorder;\n                            }\n                        }\n                    }\n                    if (j !== range[3]) {\n                        style.borderRight = border;\n                    }\n                    if (i !== range[0]) {\n                        style.borderTop = border;\n                    }\n                    if (i !== range[2]) {\n                        style.borderBottom = border;\n                    }\n                    if (j !== range[1]) {\n                        style.borderLeft = border;\n                    }\n                    this.setCellBorder(sheet, style, i, j, actionUpdate, j === range[3]);\n                }\n            }\n        }\n        else if (type === 'Vertical') {\n            for (var i = range[0]; i <= range[2]; i++) {\n                for (var j = range[1]; j <= range[3]; j++) {\n                    var style = { borderRight: border, borderLeft: border };\n                    if (j === range[1]) {\n                        this.checkAdjustantBorder(sheet, 'borderRight', i, j - 1);\n                        this.checkFullBorder(sheet, 'borderRight', i, j - 1);\n                    }\n                    if (j === range[3]) {\n                        this.checkAdjustantBorder(sheet, 'borderLeft', i, j + 1);\n                        this.checkFullBorder(sheet, 'borderLeft', i, j + 1);\n                    }\n                    this.setCellBorder(sheet, style, i, j, actionUpdate);\n                }\n            }\n        }\n        else {\n            for (var i = range[0]; i <= range[2]; i++) {\n                for (var j = range[1]; j <= range[3]; j++) {\n                    var style = { borderTop: border, borderBottom: border };\n                    if (i === range[0]) {\n                        this.checkAdjustantBorder(sheet, 'borderBottom', i - 1, j);\n                        this.checkFullBorder(sheet, 'borderBottom', i - 1, j);\n                    }\n                    this.setCellBorder(sheet, style, i, j, actionUpdate, j === range[3]);\n                    if (i === range[2]) {\n                        this.checkAdjustantBorder(sheet, 'borderTop', i + 1, j);\n                        this.checkFullBorder(sheet, 'borderTop', i + 1, j);\n                        this.setBottomBorderPriority(sheet, i, j);\n                    }\n                }\n            }\n        }\n    };\n    WorkbookCellFormat.prototype.setCellBorder = function (sheet, style, rowIdx, colIdx, actionUpdate, lastCell) {\n        this.setCellStyle(sheet, rowIdx, colIdx, style);\n        if (this.parent.getActiveSheet().id === sheet.id) {\n            this.parent.notify(applyCellFormat, {\n                style: style, rowIdx: rowIdx, colIdx: colIdx, onActionUpdate: actionUpdate, first: '', lastCell: lastCell,\n                isHeightCheckNeeded: true, manualUpdate: true\n            });\n        }\n    };\n    WorkbookCellFormat.prototype.setCellStyle = function (sheet, rowIdx, colIdx, style) {\n        if (!sheet.rows[rowIdx]) {\n            sheet.rows[rowIdx] = { cells: [] };\n        }\n        else if (!sheet.rows[rowIdx].cells) {\n            sheet.rows[rowIdx].cells = [];\n        }\n        if (!sheet.rows[rowIdx].cells[colIdx]) {\n            sheet.rows[rowIdx].cells[colIdx] = {};\n        }\n        if (!sheet.rows[rowIdx].cells[colIdx].style) {\n            sheet.rows[rowIdx].cells[colIdx].style = {};\n        }\n        Object.assign(sheet.rows[rowIdx].cells[colIdx].style, style, null, true);\n    };\n    WorkbookCellFormat.prototype.skipHiddenRows = function (sheet, startIdx) {\n        startIdx++;\n        if (isHiddenRow(sheet, startIdx)) {\n            startIdx = this.skipHiddenRows(sheet, startIdx);\n        }\n        return startIdx;\n    };\n    WorkbookCellFormat.prototype.addEventListener = function () {\n        this.parent.on(setCellFormat, this.format, this);\n        this.parent.on(textDecorationUpdate, this.textDecorationActionUpdate, this);\n        this.parent.on(clear, this.clearCellObj, this);\n    };\n    WorkbookCellFormat.prototype.removeEventListener = function () {\n        if (!this.parent.isDestroyed) {\n            this.parent.off(setCellFormat, this.format);\n            this.parent.off(textDecorationUpdate, this.textDecorationActionUpdate);\n            this.parent.off(clear, this.clearCellObj);\n        }\n    };\n    WorkbookCellFormat.prototype.clearCellObj = function (options) {\n        var clrRange = options.range ? (options.range.indexOf('!') > 0) ? options.range.split('!')[1] : options.range.split('!')[0]\n            : this.parent.getActiveSheet().selectedRange;\n        var sheetIdx = (options.range && options.range.indexOf('!') > 0) ?\n            getSheetIndex(this.parent, options.range.split('!')[0]) : this.parent.activeSheetIndex;\n        var sheet = getSheet(this.parent, sheetIdx);\n        var range = getIndexesFromAddress(clrRange);\n        var sRowIdx = range[0];\n        var eRowIdx = range[2];\n        var sColIdx;\n        var eColIdx;\n        for (sRowIdx; sRowIdx <= eRowIdx; sRowIdx++) {\n            sColIdx = range[1];\n            eColIdx = range[3];\n            for (sColIdx; sColIdx <= eColIdx; sColIdx++) {\n                var cell = getCell(sRowIdx, sColIdx, sheet);\n                if (cell) {\n                    switch (options.type) {\n                        case 'Clear Formats':\n                            delete cell.format;\n                            delete cell.rowSpan;\n                            delete cell.style;\n                            delete cell.wrap;\n                            delete cell.colSpan;\n                            break;\n                        case 'Clear Contents':\n                            delete cell.value;\n                            delete cell.formula;\n                            break;\n                        case 'Clear Hyperlinks':\n                            delete cell.hyperlink;\n                            break;\n                        case 'Clear All':\n                            setCell(sRowIdx, sColIdx, sheet, {}, false);\n                            break;\n                    }\n                }\n            }\n        }\n    };\n    /**\n     * To destroy workbook cell format.\n     */\n    WorkbookCellFormat.prototype.destroy = function () {\n        this.removeEventListener();\n        this.parent = null;\n    };\n    /**\n     * Get the workbook cell format module name.\n     */\n    WorkbookCellFormat.prototype.getModuleName = function () {\n        return 'workbookcellformat';\n    };\n    return WorkbookCellFormat;\n}());\nexport { WorkbookCellFormat };\n","import { getCell, getSheet } from '../base/index';\nimport { workbookEditOperation, checkDateFormat, workbookFormulaOperation, refreshChart } from '../common/event';\nimport { getRangeIndexes } from '../common/index';\nimport { isNullOrUndefined, getNumericObject } from '@syncfusion/ej2-base';\nimport { checkIsFormula } from '../../workbook/common/index';\nimport { getTypeFromFormat } from '../integrations/index';\n/**\n * The `WorkbookEdit` module is used to handle the editing functionalities in Workbook.\n */\nvar WorkbookEdit = /** @class */ (function () {\n    /**\n     * Constructor for edit module in Workbook.\n     * @private\n     */\n    function WorkbookEdit(workbook) {\n        this.parent = workbook;\n        this.localeObj = getNumericObject(this.parent.locale);\n        /* tslint:disable:no-any */\n        this.decimalSep = this.localeObj.decimal;\n        this.addEventListener();\n    }\n    /**\n     * To destroy the edit module.\n     * @return {void}\n     * @hidden\n     */\n    WorkbookEdit.prototype.destroy = function () {\n        this.removeEventListener();\n        this.parent = null;\n    };\n    WorkbookEdit.prototype.addEventListener = function () {\n        this.parent.on(workbookEditOperation, this.performEditOperation, this);\n    };\n    WorkbookEdit.prototype.removeEventListener = function () {\n        if (!this.parent.isDestroyed) {\n            this.parent.off(workbookEditOperation, this.performEditOperation);\n        }\n    };\n    /**\n     * Get the module name.\n     * @returns string\n     * @private\n     */\n    WorkbookEdit.prototype.getModuleName = function () {\n        return 'workbookEdit';\n    };\n    WorkbookEdit.prototype.performEditOperation = function (args) {\n        var action = args.action;\n        switch (action) {\n            case 'updateCellValue':\n                this.updateCellValue(args.address, args.value, args.sheetIndex, args.isValueOnly);\n                break;\n        }\n    };\n    WorkbookEdit.prototype.checkDecimalPoint = function (value) {\n        if (Number(value)) {\n            var decIndex = value.toString().indexOf(this.decimalSep) + 1;\n            var checkDec = value.toString().substr(decIndex).length <= 6;\n            value = checkDec ? decIndex < 7 ? value : (parseFloat(value)).toFixed(0) : decIndex > 7 ? (parseFloat(value)).toFixed(0) :\n                (parseFloat(value)).toFixed(6 - decIndex + 2);\n        }\n        return value;\n    };\n    WorkbookEdit.prototype.updateCellValue = function (address, value, sheetIdx, isValueOnly) {\n        if (isValueOnly === void 0) { isValueOnly = false; }\n        if (sheetIdx === undefined) {\n            sheetIdx = this.parent.activeSheetIndex;\n        }\n        var range;\n        if (typeof address === 'string') {\n            range = getRangeIndexes(address);\n        }\n        else {\n            range = address;\n        }\n        var sheet = getSheet(this.parent, sheetIdx);\n        if (!sheet.rows[range[0]]) {\n            sheet.rows[range[0]] = {};\n            sheet.rows[range[0]].cells = [];\n        }\n        if (!sheet.rows[range[0]].cells) {\n            sheet.rows[range[0]].cells = [];\n        }\n        if (!sheet.rows[range[0]].cells[range[1]]) {\n            sheet.rows[range[0]].cells[range[1]] = {};\n        }\n        var cell = getCell(range[0], range[1], sheet);\n        if (!isValueOnly) {\n            var isFormula = checkIsFormula(value);\n            if (!isFormula) {\n                cell.formula = '';\n                cell.value = this.parseIntValue(value);\n            }\n            var eventArgs = {\n                action: 'refreshCalculate',\n                value: value,\n                rowIndex: range[0],\n                colIndex: range[1],\n                sheetIndex: sheetIdx,\n                isFormula: isFormula\n            };\n            this.parent.notify(workbookFormulaOperation, eventArgs);\n            if (isFormula) {\n                cell.formula = eventArgs.value;\n                value = cell.value;\n            }\n            if (getTypeFromFormat(cell.format) !== 'Text') {\n                var dateEventArgs = {\n                    value: value,\n                    rowIndex: range[0],\n                    colIndex: range[1],\n                    sheetIndex: sheetIdx,\n                    updatedVal: ''\n                };\n                this.parent.notify(checkDateFormat, dateEventArgs);\n                if (!isNullOrUndefined(dateEventArgs.updatedVal) && dateEventArgs.updatedVal.length > 0) {\n                    cell.value = dateEventArgs.updatedVal;\n                }\n            }\n        }\n        else {\n            if (value && value.toString().indexOf(this.decimalSep) > -1) {\n                value = this.checkDecimalPoint(value);\n            }\n            cell.value = value;\n        }\n        this.parent.setUsedRange(range[0], range[1]);\n        if (this.parent.allowChart) {\n            this.parent.notify(refreshChart, { cell: cell, rIdx: range[0], cIdx: range[1], sheetIdx: sheetIdx });\n        }\n    };\n    WorkbookEdit.prototype.parseIntValue = function (value) {\n        return (value && /^\\d*\\.?\\d*$/.test(value)) ? parseFloat(value) : value;\n    };\n    return WorkbookEdit;\n}());\nexport { WorkbookEdit };\n","import { setLinkModel } from '../common/event';\nimport { getRangeIndexes } from '../common/address';\nimport { isNullOrUndefined } from '@syncfusion/ej2-base';\n/**\n * The `WorkbookHyperlink` module is used to handle Hyperlink action in Spreadsheet.\n */\nvar WorkbookHyperlink = /** @class */ (function () {\n    /**\n     * Constructor for WorkbookSort module.\n     */\n    function WorkbookHyperlink(parent) {\n        this.parent = parent;\n        this.addEventListener();\n    }\n    /**\n     * To destroy the sort module.\n     */\n    WorkbookHyperlink.prototype.destroy = function () {\n        this.removeEventListener();\n        this.parent = null;\n    };\n    WorkbookHyperlink.prototype.addEventListener = function () {\n        this.parent.on(setLinkModel, this.setLinkHandler, this);\n    };\n    WorkbookHyperlink.prototype.removeEventListener = function () {\n        if (!this.parent.isDestroyed) {\n            this.parent.off(setLinkModel, this.setLinkHandler);\n        }\n    };\n    WorkbookHyperlink.prototype.setLinkHandler = function (args) {\n        var hyperlink = args.hyperlink;\n        var cellAddr = args.cell;\n        var range;\n        var sheetIdx;\n        var cellIdx;\n        var sheet = this.parent.getActiveSheet();\n        var address;\n        if (cellAddr && cellAddr.indexOf('!') !== -1) {\n            range = cellAddr.split('!');\n            var sheets = this.parent.sheets;\n            for (var idx = 0; idx < sheets.length; idx++) {\n                if (sheets[idx].name === range[0]) {\n                    sheetIdx = idx;\n                }\n            }\n            sheet = this.parent.sheets[sheetIdx];\n            cellAddr = range[1];\n        }\n        cellAddr = cellAddr ? cellAddr : this.parent.getActiveSheet().activeCell;\n        cellIdx = getRangeIndexes(cellAddr);\n        var rowIdx = cellIdx[0];\n        var colIdx = cellIdx[1];\n        if (!sheet) {\n            return;\n        }\n        if (isNullOrUndefined(sheet.rows[rowIdx])) {\n            sheet.rows[rowIdx] = {};\n        }\n        if (isNullOrUndefined(sheet.rows[rowIdx].cells)) {\n            sheet.rows[rowIdx].cells = [];\n        }\n        if (isNullOrUndefined(sheet.rows[rowIdx].cells[colIdx])) {\n            sheet.rows[rowIdx].cells[colIdx] = {};\n        }\n        if (typeof (hyperlink) === 'string') {\n            if (hyperlink.indexOf('http://') !== 0 && hyperlink.indexOf('https://') !== 0 && hyperlink.indexOf('ftp://') !== 0) {\n                hyperlink = hyperlink.toLowerCase().indexOf('www.') === 0 ? 'http://' + hyperlink : hyperlink;\n                address = hyperlink;\n            }\n            sheet.rows[rowIdx].cells[colIdx].hyperlink = hyperlink;\n        }\n        else {\n            address = hyperlink.address;\n            if (address.indexOf('http://') !== 0 && address.indexOf('https://') !== 0 && address.indexOf('ftp://') !== 0) {\n                address = address.toLowerCase().indexOf('www.') === 0 ? 'http://' + address : address;\n            }\n            sheet.rows[rowIdx].cells[colIdx].hyperlink = {\n                address: address,\n            };\n        }\n    };\n    /**\n     * Gets the module name.\n     * @returns string\n     */\n    WorkbookHyperlink.prototype.getModuleName = function () {\n        return 'workbookHyperlink';\n    };\n    return WorkbookHyperlink;\n}());\nexport { WorkbookHyperlink };\n","import { insert, insertModel, workbookFormulaOperation, } from '../../workbook/common/index';\nimport { insertMerge } from '../../workbook/common/index';\n/**\n * The `WorkbookInsert` module is used to insert cells, rows, columns and sheets in to workbook.\n */\nvar WorkbookInsert = /** @class */ (function () {\n    /**\n     * Constructor for the workbook insert module.\n     * @private\n     */\n    function WorkbookInsert(parent) {\n        this.parent = parent;\n        this.addEventListener();\n    }\n    WorkbookInsert.prototype.insertModel = function (args) {\n        var _this = this;\n        var _a, _b, _c;\n        var index;\n        var model = [];\n        var mergeCollection;\n        var isModel;\n        if (typeof (args.start) === 'number') {\n            index = args.start;\n            args.end = args.end || index;\n            if (index > args.end) {\n                index = args.end;\n                args.end = args.start;\n            }\n            for (var i = index; i <= args.end; i++) {\n                model.push({});\n            }\n        }\n        else {\n            if (args.start) {\n                index = args.start[0].index || 0;\n                model = args.start;\n                isModel = true;\n            }\n            else {\n                index = 0;\n                model.push({});\n            }\n        }\n        if (args.modelType === 'Row') {\n            args.model = args.model;\n            if (!args.model.rows) {\n                args.model.rows = [];\n            }\n            (_a = args.model.rows).splice.apply(_a, [index, 0].concat(model));\n            //this.setInsertInfo(args.model, index, model.length, 'count');\n            if (index > args.model.usedRange.rowIndex) {\n                this.parent.setUsedRange(index + (model.length - 1), args.model.usedRange.colIndex);\n            }\n            else {\n                this.parent.setUsedRange(args.model.usedRange.rowIndex + model.length, args.model.usedRange.colIndex);\n            }\n            var curIdx = index + model.length;\n            for (var i = 0; i <= args.model.usedRange.colIndex; i++) {\n                if (args.model.rows[curIdx] && args.model.rows[curIdx].cells && args.model.rows[curIdx].cells[i] &&\n                    args.model.rows[curIdx].cells[i].rowSpan !== undefined && args.model.rows[curIdx].cells[i].rowSpan < 0 &&\n                    args.model.rows[curIdx].cells[i].colSpan === undefined) {\n                    this.parent.notify(insertMerge, {\n                        range: [curIdx, i, curIdx, i], insertCount: model.length,\n                        insertModel: 'Row'\n                    });\n                }\n            }\n        }\n        else if (args.modelType === 'Column') {\n            args.model = args.model;\n            if (!args.model.columns) {\n                args.model.columns = [];\n            }\n            (_b = args.model.columns).splice.apply(_b, [index, 0].concat(model));\n            //this.setInsertInfo(args.model, index, model.length, 'fldLen', 'Column');\n            if (index > args.model.usedRange.colIndex) {\n                this.parent.setUsedRange(args.model.usedRange.rowIndex, index + (model.length - 1));\n            }\n            else {\n                this.parent.setUsedRange(args.model.usedRange.rowIndex, args.model.usedRange.colIndex + model.length);\n            }\n            if (!args.model.rows) {\n                args.model.rows = [];\n            }\n            var cellModel = [];\n            if (!args.columnCellsModel) {\n                args.columnCellsModel = [];\n            }\n            for (var i = 0; i < model.length; i++) {\n                cellModel.push(null);\n            }\n            mergeCollection = [];\n            for (var i = 0; i <= args.model.usedRange.rowIndex; i++) {\n                if (!args.model.rows[i]) {\n                    args.model.rows[i] = { cells: [] };\n                }\n                else if (!args.model.rows[i].cells) {\n                    args.model.rows[i].cells = [];\n                }\n                if (index && !args.model.rows[i].cells[index - 1]) {\n                    args.model.rows[i].cells[index - 1] = {};\n                }\n                (_c = args.model.rows[i].cells).splice.apply(_c, [index, 0].concat((args.columnCellsModel[i] && args.columnCellsModel[i].cells ?\n                    args.columnCellsModel[i].cells : cellModel)));\n                var curIdx = index + model.length;\n                if (args.model.rows[i].cells[curIdx] && args.model.rows[i].cells[curIdx].colSpan !== undefined &&\n                    args.model.rows[i].cells[curIdx].colSpan < 0 && args.model.rows[i].cells[curIdx].rowSpan === undefined) {\n                    mergeCollection.push({\n                        range: [i, curIdx, i, curIdx], insertCount: cellModel.length,\n                        insertModel: 'Column'\n                    });\n                }\n            }\n            mergeCollection.forEach(function (mergeArgs) { _this.parent.notify(insertMerge, mergeArgs); });\n        }\n        else {\n            if (args.checkCount !== undefined && args.checkCount === this.parent.sheets.length) {\n                return;\n            }\n            delete model[0].index;\n            this.parent.createSheet(index, model);\n            var id_1;\n            if (args.activeSheetIndex) {\n                this.parent.setProperties({ activeSheetIndex: args.activeSheetIndex }, true);\n            }\n            else if (!args.isAction && args.start < this.parent.activeSheetIndex) {\n                this.parent.setProperties({ activeSheetIndex: this.parent.skipHiddenSheets(this.parent.activeSheetIndex) }, true);\n            }\n            model.forEach(function (sheet) {\n                if (isModel) {\n                    _this.updateRangeModel(sheet.ranges);\n                }\n                id_1 = sheet.id;\n                _this.parent.notify(workbookFormulaOperation, {\n                    action: 'addSheet', visibleName: sheet.name, sheetName: 'Sheet' + id_1, index: id_1\n                });\n            });\n        }\n        var insertArgs = {\n            action: 'refreshNamedRange', insertArgs: {\n                model: model, index: index, modelType: args.modelType, isAction: args.isAction, activeSheetIndex: args.activeSheetIndex, sheetCount: this.parent.sheets.length, name: 'insert'\n            }\n        };\n        var eventArgs = {\n            action: 'refreshInsDelFormula', insertArgs: {\n                model: model, startIndex: args.start, endIndex: args.end, modelType: args.modelType, name: 'insert', activeSheetIndex: args.activeSheetIndex, sheetCount: this.parent.sheets.length\n            }\n        };\n        if (args.modelType === 'Column' || args.modelType === 'Row') {\n            this.parent.notify(workbookFormulaOperation, insertArgs);\n            this.parent.notify(workbookFormulaOperation, eventArgs);\n        }\n        this.parent.notify(insert, {\n            model: model, index: index, modelType: args.modelType, isAction: args.isAction, activeSheetIndex: args.activeSheetIndex, sheetCount: this.parent.sheets.length, insertType: args.insertType\n        });\n    };\n    WorkbookInsert.prototype.updateRangeModel = function (ranges) {\n        ranges.forEach(function (range) {\n            if (range.dataSource) {\n                range.startCell = range.startCell || 'A1';\n                range.showFieldAsHeader = range.showFieldAsHeader === undefined || range.showFieldAsHeader;\n                range.template = range.template || '';\n                range.address = range.address || 'A1';\n            }\n        });\n    };\n    WorkbookInsert.prototype.setInsertInfo = function (sheet, startIndex, count, totalKey, modelType) {\n        if (modelType === void 0) { modelType = 'Row'; }\n        var endIndex = count = startIndex + (count - 1);\n        sheet.ranges.forEach(function (range) {\n            if (range.info && startIndex < range.info[totalKey]) {\n                if (!range.info[\"insert\" + modelType + \"Range\"]) {\n                    range.info[\"insert\" + modelType + \"Range\"] = [[startIndex, endIndex]];\n                }\n                else {\n                    range.info[\"insert\" + modelType + \"Range\"].push([startIndex, endIndex]);\n                }\n                range.info[totalKey] += ((endIndex - startIndex) + 1);\n            }\n        });\n    };\n    WorkbookInsert.prototype.addEventListener = function () {\n        this.parent.on(insertModel, this.insertModel, this);\n    };\n    /**\n     * Destroy workbook insert module.\n     */\n    WorkbookInsert.prototype.destroy = function () {\n        this.removeEventListener();\n        this.parent = null;\n    };\n    WorkbookInsert.prototype.removeEventListener = function () {\n        if (!this.parent.isDestroyed) {\n            this.parent.off(insertModel, this.insertModel);\n        }\n    };\n    /**\n     * Get the workbook insert module name.\n     */\n    WorkbookInsert.prototype.getModuleName = function () {\n        return 'workbookinsert';\n    };\n    return WorkbookInsert;\n}());\nexport { WorkbookInsert };\n","import { getCell, setCell } from '../base/index';\nimport { deleteModel, deleteAction, updateUsedRange } from '../../workbook/common/index';\nimport { activeCellMergedRange, setMerge, workbookFormulaOperation } from '../../workbook/common/index';\n/**\n * The `WorkbookDelete` module is used to delete cells, rows, columns and sheets from workbook.\n */\nvar WorkbookDelete = /** @class */ (function () {\n    /**\n     * Constructor for the workbook delete module.\n     * @private\n     */\n    function WorkbookDelete(parent) {\n        this.parent = parent;\n        this.addEventListener();\n    }\n    // tslint:disable-next-line\n    WorkbookDelete.prototype.deleteModel = function (args) {\n        var _this = this;\n        var sheetLength = this.parent.sheets.length;\n        if (args.modelType === 'Sheet' && sheetLength === 1) {\n            return;\n        }\n        var modelName = args.modelType.toLowerCase() + \"s\";\n        args.start = args.start;\n        if (args.start > args.end) {\n            var temp = args.start;\n            args.start = args.end;\n            args.end = temp;\n        }\n        var deletedCells;\n        var mergeArgsCollection = [];\n        var count = (args.end - args.start) + 1;\n        var range;\n        var prevCell;\n        if (args.modelType === 'Row') {\n            args.model = args.model;\n            if (args.start > args.model.usedRange.rowIndex) {\n                return;\n            }\n            if (args.end > args.model.usedRange.rowIndex) {\n                args.end -= (args.end - args.model.usedRange.rowIndex);\n            }\n            args.model.usedRange.rowIndex -= ((args.end - args.start) + 1);\n            if (args.model.usedRange.rowIndex < 0) {\n                args.model.usedRange.rowIndex = 0;\n            }\n            this.parent.notify(updateUsedRange, { index: args.model.usedRange.rowIndex, update: 'row' });\n            var curIdx = args.end + 1;\n            var cell = void 0;\n            var mergeArgs = void 0;\n            if (args.model.rows[args.start] && args.model.rows[args.start].cells) {\n                for (var i = 0; i <= args.model.usedRange.colIndex; i++) {\n                    if (args.model.rows[args.start].cells[i] && args.model.rows[args.start].cells[i].rowSpan !== undefined &&\n                        args.model.rows[args.start].cells[i].rowSpan < 0 && args.model.rows[args.start].cells[i].colSpan === undefined) {\n                        mergeArgs = { range: [args.start, i, args.start, i] };\n                        this.parent.notify(activeCellMergedRange, mergeArgs);\n                        mergeArgs.range = mergeArgs.range;\n                        if (mergeArgs.range[2] <= args.end) {\n                            prevCell = getCell(mergeArgs.range[0], i, args.model);\n                            if (prevCell && prevCell.rowSpan > 1) {\n                                if (prevCell.rowSpan - ((mergeArgs.range[2] - args.start) + 1) > 1) {\n                                    setCell(mergeArgs.range[0], i, args.model, { colSpan: prevCell.rowSpan - ((mergeArgs.range[2] - args.start) + 1) }, true);\n                                }\n                                else {\n                                    delete args.model.rows[mergeArgs.range[0]].cells[i].rowSpan;\n                                }\n                            }\n                            mergeArgs = null;\n                        }\n                    }\n                    if (args.model.rows[curIdx].cells && args.model.rows[curIdx].cells[i] &&\n                        args.model.rows[curIdx].cells[i].rowSpan !== undefined &&\n                        args.model.rows[curIdx].cells[i].rowSpan < 0 && args.model.rows[curIdx].cells[i].colSpan === undefined) {\n                        if (!mergeArgs) {\n                            mergeArgs = { range: [curIdx, i, curIdx, i] };\n                            this.parent.notify(activeCellMergedRange, mergeArgs);\n                        }\n                        cell = new Object();\n                        mergeArgs.range = mergeArgs.range;\n                        Object.assign(cell, getCell(mergeArgs.range[0], mergeArgs.range[1], args.model));\n                        if (cell && cell.rowSpan && (cell.rowSpan > 1 || cell.colSpan > 1)) {\n                            var indexes = [];\n                            indexes[1] = i;\n                            indexes[3] = cell.colSpan > 1 ? i + (cell.colSpan - 1) : i;\n                            mergeArgs.range = mergeArgs.range;\n                            if (mergeArgs.range[0] < args.start) {\n                                indexes[0] = indexes[2] = mergeArgs.range[0];\n                                if (cell.rowSpan - count > 1) {\n                                    indexes[2] += (cell.rowSpan - count - 1);\n                                }\n                            }\n                            else {\n                                indexes[0] = indexes[2] = args.start;\n                                if (cell.rowSpan - ((args.end - mergeArgs.range[0]) + 1) > 1) {\n                                    indexes[2] += ((cell.rowSpan - ((args.end - mergeArgs.range[0]) + 1)) - 1);\n                                }\n                            }\n                            mergeArgsCollection.push({\n                                range: indexes, isAction: false, preventRefresh: true, merge: true,\n                                type: 'All', skipChecking: true\n                            });\n                        }\n                    }\n                    mergeArgs = null;\n                }\n            }\n        }\n        else if (args.modelType === 'Column') {\n            args.model = args.model;\n            if (args.start > args.model.usedRange.colIndex) {\n                return;\n            }\n            if (args.end > args.model.usedRange.colIndex) {\n                args.end -= (args.end - args.model.usedRange.colIndex);\n            }\n            args.model.usedRange.colIndex -= count;\n            if (args.model.usedRange.colIndex < 0) {\n                args.model.usedRange.colIndex = 0;\n            }\n            //this.setDeleteInfo(args.start, args.end, 'fldLen', 'Column');\n            this.parent.notify(updateUsedRange, { index: args.model.usedRange.colIndex, update: 'col' });\n            deletedCells = [];\n            var curIdx = args.end + 1;\n            var cell = void 0;\n            var mergeArgs = void 0;\n            for (var i = 0; i <= args.model.usedRange.rowIndex; i++) {\n                deletedCells.push({});\n                if (args.model.rows[i] && args.model.rows[i].cells) {\n                    if (args.model.rows[i].cells[args.start] && args.model.rows[i].cells[args.start].colSpan !== undefined &&\n                        args.model.rows[i].cells[args.start].colSpan < 0 && args.model.rows[i].cells[args.start].rowSpan === undefined) {\n                        mergeArgs = { range: [i, args.start, i, args.start] };\n                        this.parent.notify(activeCellMergedRange, mergeArgs);\n                        mergeArgs.range = mergeArgs.range;\n                        if (mergeArgs.range[3] <= args.end) {\n                            var prevCell_1 = getCell(i, mergeArgs.range[1], args.model);\n                            if (prevCell_1 && prevCell_1.colSpan > 1) {\n                                if (prevCell_1.colSpan - ((mergeArgs.range[3] - args.start) + 1) > 1) {\n                                    setCell(i, mergeArgs.range[1], args.model, { colSpan: prevCell_1.colSpan - ((mergeArgs.range[3] - args.start) + 1) }, true);\n                                }\n                                else {\n                                    delete args.model.rows[i].cells[mergeArgs.range[1]].colSpan;\n                                }\n                            }\n                            mergeArgs = null;\n                        }\n                    }\n                    if (args.model.rows[i].cells[curIdx] && args.model.rows[i].cells[curIdx].colSpan !== undefined &&\n                        args.model.rows[i].cells[curIdx].colSpan < 0 && args.model.rows[i].cells[curIdx].rowSpan === undefined) {\n                        if (!mergeArgs) {\n                            mergeArgs = { range: [i, curIdx, i, curIdx] };\n                            this.parent.notify(activeCellMergedRange, mergeArgs);\n                        }\n                        cell = new Object();\n                        mergeArgs.range = mergeArgs.range;\n                        Object.assign(cell, getCell(mergeArgs.range[0], mergeArgs.range[1], args.model));\n                        if (cell && cell.colSpan && (cell.colSpan > 1 || cell.rowSpan > 1)) {\n                            var indexes = [];\n                            indexes[0] = i;\n                            indexes[2] = cell.rowSpan > 1 ? i + (cell.rowSpan - 1) : i;\n                            mergeArgs.range = mergeArgs.range;\n                            if (mergeArgs.range[1] < args.start) {\n                                indexes[1] = indexes[3] = mergeArgs.range[1];\n                                if (cell.colSpan - count > 1) {\n                                    indexes[3] += (cell.colSpan - count - 1);\n                                }\n                            }\n                            else {\n                                indexes[1] = indexes[3] = args.start;\n                                if (cell.colSpan - ((args.end - mergeArgs.range[1]) + 1) > 1) {\n                                    indexes[3] += ((cell.colSpan - ((args.end - mergeArgs.range[1]) + 1)) - 1);\n                                }\n                            }\n                            mergeArgsCollection.push({\n                                range: indexes, isAction: false, preventRefresh: true, merge: true,\n                                type: 'All', skipChecking: true\n                            });\n                        }\n                    }\n                    deletedCells[i].cells = args.model.rows[i].cells.splice(args.start, count);\n                    mergeArgs = null;\n                }\n            }\n        }\n        else {\n            if (args.end - args.start === this.parent.sheets.length - 1) {\n                return;\n            }\n        }\n        var deletedModel = [];\n        for (var i = args.start; i <= args.end; i++) {\n            if (args.model[modelName][args.start]) {\n                deletedModel.push(args.model[modelName][args.start]);\n                args.model[modelName].splice(args.start, 1);\n            }\n            else {\n                deletedModel.push({});\n            }\n            if (i === args.start) {\n                deletedModel[0].index = args.start;\n            }\n        }\n        mergeArgsCollection.forEach(function (merge) { _this.parent.notify(setMerge, merge); });\n        var insertArgs = {\n            action: 'refreshNamedRange', insertArgs: {\n                startIndex: args.start, endIndex: args.end, modelType: args.modelType,\n                isAction: args.isAction, deletedModel: deletedModel, deletedCellsModel: deletedCells,\n                activeSheetIndex: this.parent.activeSheetIndex, name: 'delete'\n            }\n        };\n        var eventArgs = {\n            action: 'refreshInsDelFormula', insertArgs: {\n                model: deletedModel, startIndex: args.start, endIndex: args.end, modelType: args.modelType,\n                name: 'delete', activeSheetIndex: args.activeSheetIndex, sheetCount: this.parent.sheets.length\n            }\n        };\n        this.parent.notify(workbookFormulaOperation, insertArgs);\n        this.parent.notify(workbookFormulaOperation, eventArgs);\n        this.parent.notify(deleteAction, {\n            startIndex: args.start, endIndex: args.end, modelType: args.modelType,\n            isAction: args.isAction, deletedModel: deletedModel, deletedCellsModel: deletedCells,\n            activeSheetIndex: this.parent.activeSheetIndex\n        });\n    };\n    WorkbookDelete.prototype.setDeleteInfo = function (startIndex, endIndex, totalKey, modelType) {\n        if (modelType === void 0) { modelType = 'Row'; }\n        var total = (endIndex - startIndex) + 1;\n        var newRange = [];\n        var insertRange;\n        this.parent.getActiveSheet().ranges.forEach(function (range) {\n            if (range.info && startIndex < range.info[totalKey]) {\n                if (range.info[\"delete\" + modelType + \"Range\"]) {\n                    range.info[\"delete\" + modelType + \"Range\"].push([startIndex, endIndex]);\n                }\n                else {\n                    range.info[\"delete\" + modelType + \"Range\"] = [[startIndex, endIndex]];\n                }\n                range.info[totalKey] -= total;\n                if (range.info[\"insert\" + modelType + \"Range\"]) {\n                    range.info[\"insert\" + modelType + \"Range\"] = newRange;\n                }\n            }\n        });\n    };\n    WorkbookDelete.prototype.addEventListener = function () {\n        this.parent.on(deleteModel, this.deleteModel, this);\n    };\n    /**\n     * Destroy workbook delete module.\n     */\n    WorkbookDelete.prototype.destroy = function () {\n        this.removeEventListener();\n        this.parent = null;\n    };\n    WorkbookDelete.prototype.removeEventListener = function () {\n        if (!this.parent.isDestroyed) {\n            this.parent.off(deleteModel, this.deleteModel);\n        }\n    };\n    /**\n     * Get the workbook delete module name.\n     */\n    WorkbookDelete.prototype.getModuleName = function () {\n        return 'workbookdelete';\n    };\n    return WorkbookDelete;\n}());\nexport { WorkbookDelete };\n","import { setCell, setRow, getSheet } from '../base/index';\nimport { setValidation, applyCellFormat, isValidation, removeValidation, addHighlight } from '../common/index';\nimport { removeHighlight } from '../common/index';\nimport { getRangeIndexes } from '../common/index';\n/**\n * The `WorkbookHyperlink` module is used to handle Hyperlink action in Spreadsheet.\n */\nvar WorkbookDataValidation = /** @class */ (function () {\n    /**\n     * Constructor for WorkbookSort module.\n     */\n    function WorkbookDataValidation(parent) {\n        this.parent = parent;\n        this.addEventListener();\n    }\n    /**\n     * To destroy the sort module.\n     */\n    WorkbookDataValidation.prototype.destroy = function () {\n        this.removeEventListener();\n        this.parent = null;\n    };\n    WorkbookDataValidation.prototype.addEventListener = function () {\n        this.parent.on(setValidation, this.addValidationHandler, this);\n        this.parent.on(removeValidation, this.removeValidationHandler, this);\n        this.parent.on(addHighlight, this.addHighlightHandler, this);\n        this.parent.on(removeHighlight, this.removeHighlightHandler, this);\n    };\n    WorkbookDataValidation.prototype.removeEventListener = function () {\n        if (!this.parent.isDestroyed) {\n            this.parent.off(setValidation, this.addValidationHandler);\n            this.parent.off(removeValidation, this.removeValidationHandler);\n            this.parent.off(addHighlight, this.addHighlightHandler);\n            this.parent.off(removeHighlight, this.removeHighlightHandler);\n        }\n    };\n    WorkbookDataValidation.prototype.addValidationHandler = function (args) {\n        this.ValidationHandler(args.rules, args.range, false);\n    };\n    WorkbookDataValidation.prototype.removeValidationHandler = function (args) {\n        this.ValidationHandler(args.rules, args.range, true);\n    };\n    WorkbookDataValidation.prototype.ValidationHandler = function (rules, range, isRemoveValidation) {\n        var cell;\n        var sheet = getSheet(this.parent, this.parent.getAddressInfo(range).sheetIndex);\n        range = range || sheet.selectedRange;\n        var indexes = getRangeIndexes(range);\n        for (var rowIdx = indexes[0]; rowIdx <= indexes[2]; rowIdx++) {\n            if (!sheet.rows[rowIdx]) {\n                setRow(sheet, rowIdx, {});\n            }\n            for (var colIdx = indexes[1]; colIdx <= indexes[3]; colIdx++) {\n                if (!sheet.rows[rowIdx].cells || !sheet.rows[rowIdx].cells[colIdx]) {\n                    setCell(rowIdx, colIdx, sheet, {});\n                }\n                cell = sheet.rows[rowIdx].cells[colIdx];\n                if (isRemoveValidation) {\n                    if (cell.validation) {\n                        delete (cell.validation);\n                        var style = this.parent.getCellStyleValue(['backgroundColor', 'color'], [rowIdx, colIdx]);\n                        this.parent.notify(applyCellFormat, {\n                            style: style, rowIdx: rowIdx, colIdx: colIdx\n                        });\n                    }\n                }\n                else {\n                    cell.validation = {\n                        type: rules.type,\n                        operator: rules.operator,\n                        value1: (rules.type === 'List' && rules.value1.length > 256) ?\n                            rules.value1.substring(0, 255) : rules.value1,\n                        value2: rules.value2,\n                        ignoreBlank: rules.ignoreBlank,\n                        inCellDropDown: rules.inCellDropDown,\n                    };\n                }\n            }\n        }\n    };\n    WorkbookDataValidation.prototype.addHighlightHandler = function (args) {\n        this.InvalidDataHandler(args.range, false);\n    };\n    WorkbookDataValidation.prototype.removeHighlightHandler = function (args) {\n        this.InvalidDataHandler(args.range, true);\n    };\n    WorkbookDataValidation.prototype.InvalidDataHandler = function (range, isRemoveHighlightedData) {\n        var isCell = false;\n        var cell;\n        var value;\n        var sheet = this.parent.getActiveSheet();\n        range = range || sheet.selectedRange;\n        var indexes = range ? getRangeIndexes(range) : [];\n        var rowIdx = range ? indexes[0] : 0;\n        var lastRowIdx = range ? indexes[2] : sheet.rows.length;\n        for (rowIdx; rowIdx <= lastRowIdx; rowIdx++) {\n            if (sheet.rows[rowIdx]) {\n                var colIdx = range ? indexes[1] : 0;\n                var lastColIdx = range ? indexes[3] : sheet.rows[rowIdx].cells.length;\n                for (colIdx; colIdx <= lastColIdx; colIdx++) {\n                    if (sheet.rows[rowIdx].cells[colIdx]) {\n                        cell = sheet.rows[rowIdx].cells[colIdx];\n                        value = cell.value ? cell.value : '';\n                        var range_1 = [rowIdx, colIdx];\n                        var sheetIdx = this.parent.activeSheetIndex;\n                        if (cell.validation && this.parent.allowDataValidation) {\n                            this.parent.notify(isValidation, { value: value, range: range_1, sheetIdx: sheetIdx, isCell: isCell });\n                            var isValid = this.parent.allowDataValidation;\n                            this.parent.allowDataValidation = true;\n                            if (!isValid) {\n                                if (!isRemoveHighlightedData) {\n                                    this.parent.notify(applyCellFormat, {\n                                        style: { backgroundColor: '#ffff00', color: '#ff0000' }, rowIdx: rowIdx, colIdx: colIdx\n                                    });\n                                }\n                                else if (isRemoveHighlightedData) {\n                                    var style = this.parent.getCellStyleValue(['backgroundColor', 'color'], [rowIdx, colIdx]);\n                                    this.parent.notify(applyCellFormat, {\n                                        style: style, rowIdx: rowIdx, colIdx: colIdx\n                                    });\n                                }\n                            }\n                        }\n                    }\n                }\n            }\n        }\n    };\n    /**\n     * Gets the module name.\n     * @returns string\n     */\n    WorkbookDataValidation.prototype.getModuleName = function () {\n        return 'workbookDataValidation';\n    };\n    return WorkbookDataValidation;\n}());\nexport { WorkbookDataValidation };\n","import { getCellIndexes, getCellAddress, findNext, findPrevious, count, } from '../common/index';\nimport { goto, replaceHandler, replaceAllHandler, showDialog, findUndoRedo, replaceAllDialog } from '../common/index';\nimport { isNullOrUndefined } from '@syncfusion/ej2-base';\nimport { findAllValues, workBookeditAlert } from '../common/index';\n/**\n * `WorkbookFindAndReplace` module is used to handle the search action in Spreadsheet.\n */\nvar WorkbookFindAndReplace = /** @class */ (function () {\n    /**\n     * Constructor for WorkbookFindAndReplace module.\n     */\n    function WorkbookFindAndReplace(parent) {\n        this.parent = parent;\n        this.addEventListener();\n    }\n    /**\n     * To destroy the FindAndReplace module.\n     */\n    WorkbookFindAndReplace.prototype.destroy = function () {\n        this.removeEventListener();\n        this.parent = null;\n    };\n    WorkbookFindAndReplace.prototype.addEventListener = function () {\n        this.parent.on(findNext, this.findNext, this);\n        this.parent.on(findPrevious, this.findPrevious, this);\n        this.parent.on(replaceHandler, this.replace, this);\n        this.parent.on(replaceAllHandler, this.replaceAll, this);\n        this.parent.on(count, this.totalCount, this);\n        this.parent.on(findAllValues, this.findAllValues, this);\n    };\n    WorkbookFindAndReplace.prototype.removeEventListener = function () {\n        if (!this.parent.isDestroyed) {\n            this.parent.off(findNext, this.findNext);\n            this.parent.off(findPrevious, this.findPrevious);\n            this.parent.off(replaceHandler, this.replace);\n            this.parent.off(replaceAllHandler, this.replaceAll);\n            this.parent.off(count, this.totalCount);\n            this.parent.off(findAllValues, this.findAllValues);\n        }\n    };\n    WorkbookFindAndReplace.prototype.findNext = function (args) {\n        var sheets = this.parent.sheets;\n        var val;\n        var sheetIndex = args.sheetIndex;\n        var sheet = sheets[this.parent.activeSheetIndex];\n        var activecell = getCellIndexes(sheet.activeCell);\n        var usedRange = sheet.usedRange;\n        var endColumn = usedRange.colIndex;\n        var stringValue = args.value.toString();\n        var cidx;\n        var ridx;\n        var count = 0;\n        var endRow = usedRange.rowIndex;\n        var loopCount = 0;\n        var cellFormat;\n        var valueOfCell;\n        cidx = activecell[1];\n        ridx = activecell[0];\n        var startColumn = cidx;\n        var startRow = ridx;\n        if (sheet.rows[ridx]) {\n            if (sheet.rows[ridx].cells[cidx]) {\n                cellFormat = sheet.rows[ridx].cells[cidx].format;\n                if (cellFormat) {\n                    var dispTxt = this.parent.getDisplayText(sheet.rows[ridx].cells[cidx]);\n                    valueOfCell = dispTxt.toString();\n                }\n                else {\n                    if (sheet.rows[ridx].cells[cidx].value) {\n                        valueOfCell = sheet.rows[ridx].cells[cidx].value.toString();\n                    }\n                }\n            }\n        }\n        if (valueOfCell) {\n            var lcValueOfCell = valueOfCell.toLowerCase();\n            var ivalueOfCell = valueOfCell.indexOf(args.value) > -1;\n            var lowerCaseIndex = lcValueOfCell.indexOf(args.value.toString().toLowerCase()) > -1;\n            if ((stringValue === valueOfCell) || (stringValue === lcValueOfCell) || (ivalueOfCell) || (lowerCaseIndex)) {\n                if (args.searchBy === 'By Column') {\n                    ridx++;\n                }\n                else {\n                    cidx++;\n                }\n                count++;\n            }\n        }\n        if (activecell[0] > sheet.usedRange.rowIndex || activecell[1] > sheet.usedRange.colIndex) {\n            if (activecell[0] > sheet.usedRange.rowIndex && activecell[1] <= sheet.usedRange.colIndex) {\n                ridx = 0;\n                cidx = activecell[1];\n            }\n            else if (activecell[0] <= sheet.usedRange.rowIndex && activecell[1] > sheet.usedRange.colIndex) {\n                ridx = activecell[0];\n                cidx = 0;\n            }\n            else {\n                ridx = 0;\n                cidx = 0;\n            }\n        }\n        var findNextArgs = {\n            rowIndex: ridx, colIndex: cidx, usedRange: usedRange, endRow: endRow, endColumn: endColumn, startRow: startRow,\n            mode: args.mode, loopCount: loopCount, count: count, args: args, val: val, stringValue: stringValue,\n            sheetIndex: this.parent.activeSheetIndex, startColumn: startColumn, sheets: sheets\n        };\n        if (args.searchBy === 'By Row') {\n            this.findNxtRow(findNextArgs);\n        }\n        if (args.searchBy === 'By Column') {\n            this.findNxtCol(findNextArgs);\n        }\n    };\n    WorkbookFindAndReplace.prototype.findNxtRow = function (findNextArgs) {\n        var usedRange;\n        var sheet = findNextArgs.sheets[findNextArgs.sheetIndex];\n        var sheetsLen = this.parent.sheets.length;\n        var activecell = getCellIndexes(sheet.activeCell);\n        if (findNextArgs.colIndex >= findNextArgs.usedRange.colIndex + 1) {\n            findNextArgs.colIndex = 0;\n            findNextArgs.rowIndex++;\n        }\n        for (findNextArgs.rowIndex; findNextArgs.rowIndex <= findNextArgs.endRow + 1; findNextArgs.rowIndex++) {\n            if (findNextArgs.rowIndex > findNextArgs.endRow) {\n                if (findNextArgs.mode === 'Workbook') {\n                    var noCellfound = this.parent.activeSheetIndex;\n                    findNextArgs.sheetIndex++;\n                    if (sheetsLen === findNextArgs.sheetIndex) {\n                        findNextArgs.sheetIndex = 0;\n                    }\n                    if (noCellfound === findNextArgs.sheetIndex) {\n                        if (findNextArgs.count === 0) {\n                            this.parent.notify(showDialog, null);\n                            return;\n                        }\n                    }\n                    sheet = findNextArgs.sheets[findNextArgs.sheetIndex];\n                    usedRange = sheet.usedRange;\n                    activecell = getCellIndexes(sheet.activeCell);\n                    findNextArgs.rowIndex = 0;\n                    findNextArgs.colIndex = 0;\n                    findNextArgs.endColumn = usedRange.colIndex;\n                    findNextArgs.endRow = usedRange.rowIndex;\n                }\n                if (findNextArgs.colIndex === 0 && findNextArgs.rowIndex > findNextArgs.endRow) {\n                    if ((activecell[0] === 0 && activecell[1] === 0) ||\n                        (activecell[0] > sheet.usedRange.rowIndex || activecell[1] > sheet.usedRange.colIndex)) {\n                        if (findNextArgs.count === 0) {\n                            this.parent.notify(showDialog, null);\n                            return;\n                        }\n                    }\n                    else if ((activecell[0] !== 0 && activecell[1] !== 0) || (activecell[0] !== 0 || activecell[1] !== 0)) {\n                        findNextArgs.startColumn = 0;\n                        findNextArgs.startRow = 0;\n                        findNextArgs.endColumn = findNextArgs.usedRange.colIndex;\n                        findNextArgs.endRow = activecell[0];\n                        findNextArgs.rowIndex = findNextArgs.startRow;\n                        findNextArgs.colIndex = findNextArgs.startColumn;\n                        findNextArgs.loopCount++;\n                    }\n                }\n            }\n            if (findNextArgs.count > 0) {\n                if (findNextArgs.usedRange.rowIndex < findNextArgs.rowIndex) {\n                    findNextArgs.rowIndex = 0;\n                    if (findNextArgs.rowIndex === 0) {\n                        findNextArgs.colIndex = 0;\n                    }\n                }\n            }\n            if (sheet.rows[findNextArgs.rowIndex]) {\n                var row = sheet.rows[findNextArgs.rowIndex];\n                for (findNextArgs.colIndex; findNextArgs.colIndex <= findNextArgs.endColumn; findNextArgs.colIndex++) {\n                    if (row) {\n                        if (row.cells[findNextArgs.colIndex]) {\n                            var checkTrue = this.nextCommon(findNextArgs);\n                            if (checkTrue) {\n                                return;\n                            }\n                        }\n                    }\n                }\n                if (findNextArgs.colIndex > findNextArgs.endColumn) {\n                    findNextArgs.colIndex = 0;\n                }\n                if (findNextArgs.loopCount > 0) {\n                    if (activecell[0] === findNextArgs.rowIndex) {\n                        this.parent.notify(showDialog, null);\n                        return;\n                    }\n                }\n            }\n        }\n        if (findNextArgs.count === 0) {\n            this.parent.notify(showDialog, null);\n            return;\n        }\n    };\n    WorkbookFindAndReplace.prototype.findNxtCol = function (findNextArgs) {\n        var sheet = findNextArgs.sheets[findNextArgs.sheetIndex];\n        var noFound;\n        var activecell = getCellIndexes(sheet.activeCell);\n        var sheetsLen = this.parent.sheets.length;\n        if (findNextArgs.rowIndex >= findNextArgs.usedRange.rowIndex) {\n            findNextArgs.rowIndex = 0;\n            findNextArgs.colIndex++;\n        }\n        for (findNextArgs.colIndex; findNextArgs.colIndex <= findNextArgs.usedRange.colIndex + 1; findNextArgs.colIndex++) {\n            if (findNextArgs.colIndex >= findNextArgs.endColumn + 1) {\n                if (findNextArgs.mode === 'Workbook') {\n                    noFound = this.parent.activeSheetIndex;\n                    findNextArgs.sheetIndex++;\n                    if (sheetsLen === findNextArgs.sheetIndex) {\n                        findNextArgs.sheetIndex = 0;\n                    }\n                    if (noFound === findNextArgs.sheetIndex) {\n                        if (findNextArgs.count === 0) {\n                            this.parent.notify(showDialog, null);\n                            return;\n                        }\n                    }\n                    sheet = findNextArgs.sheets[findNextArgs.sheetIndex];\n                    findNextArgs.usedRange = sheet.usedRange;\n                    activecell = getCellIndexes(sheet.activeCell);\n                    findNextArgs.colIndex = 0;\n                    findNextArgs.rowIndex = 0;\n                    findNextArgs.endColumn = findNextArgs.usedRange.colIndex;\n                    findNextArgs.endRow = findNextArgs.usedRange.rowIndex;\n                }\n            }\n            if (findNextArgs.colIndex >= findNextArgs.endColumn + 1) {\n                findNextArgs.colIndex = 0;\n            }\n            if (findNextArgs.rowIndex > findNextArgs.endRow && findNextArgs.colIndex === 0) {\n                if ((activecell[0] === 0 && activecell[1] === 0) ||\n                    (activecell[1] > sheet.usedRange.rowIndex || activecell[0] > sheet.usedRange.colIndex)) {\n                    if (findNextArgs.count === 0) {\n                        this.parent.notify(showDialog, null);\n                        return;\n                    }\n                }\n                else if ((activecell[1] !== 0 || activecell[0] !== 0) || (activecell[1] !== 0 && activecell[0] !== 0)) {\n                    findNextArgs.startRow = 0;\n                    findNextArgs.startColumn = 0;\n                    findNextArgs.endRow = activecell[0];\n                    findNextArgs.endColumn = findNextArgs.usedRange.colIndex;\n                    findNextArgs.colIndex = findNextArgs.startColumn;\n                    findNextArgs.rowIndex = findNextArgs.startRow;\n                    findNextArgs.loopCount++;\n                }\n            }\n            if (findNextArgs.count > 0) {\n                if (findNextArgs.usedRange.colIndex + 1 < findNextArgs.colIndex) {\n                    findNextArgs.colIndex = 0;\n                    findNextArgs.rowIndex = 0;\n                }\n            }\n            if (findNextArgs.rowIndex >= findNextArgs.endRow) {\n                findNextArgs.rowIndex = 0;\n            }\n            if (findNextArgs.colIndex <= findNextArgs.usedRange.colIndex) {\n                for (findNextArgs.rowIndex; findNextArgs.rowIndex <= findNextArgs.usedRange.rowIndex; findNextArgs.rowIndex++) {\n                    if (sheet.rows[findNextArgs.rowIndex]) {\n                        if (sheet.rows[findNextArgs.rowIndex].cells[findNextArgs.colIndex]) {\n                            var checkTrue = this.nextCommon(findNextArgs);\n                            if (checkTrue) {\n                                return;\n                            }\n                        }\n                    }\n                }\n                if (findNextArgs.loopCount > 0) {\n                    if (activecell[1] === findNextArgs.colIndex) {\n                        this.parent.notify(showDialog, null);\n                        return;\n                    }\n                }\n            }\n        }\n        if (findNextArgs.count === 0) {\n            this.parent.notify(showDialog, null);\n            return;\n        }\n    };\n    WorkbookFindAndReplace.prototype.nextCommon = function (findNextArgs) {\n        var sheet = findNextArgs.sheets[findNextArgs.sheetIndex];\n        if (sheet.rows[findNextArgs.rowIndex]) {\n            var rowCol = sheet.rows[findNextArgs.rowIndex].cells[findNextArgs.colIndex];\n            if (rowCol && rowCol.value) {\n                var cellType = sheet.rows[findNextArgs.rowIndex].cells[findNextArgs.colIndex];\n                if (cellType) {\n                    var cellval = void 0;\n                    if (cellType.format) {\n                        var displayTxt = this.parent.getDisplayText(sheet.rows[findNextArgs.rowIndex].\n                            cells[findNextArgs.colIndex]);\n                        cellval = displayTxt;\n                    }\n                    else {\n                        cellval = sheet.rows[findNextArgs.rowIndex].cells[findNextArgs.colIndex].value.toString();\n                    }\n                    if (findNextArgs.args.isCSen && findNextArgs.args.isEMatch) {\n                        if (cellval === findNextArgs.stringValue) {\n                            var address = sheet.name + '!' + getCellAddress(findNextArgs.rowIndex, findNextArgs.colIndex);\n                            this.parent.notify(goto, { address: address });\n                            findNextArgs.count++;\n                            return true;\n                        }\n                    }\n                    else if (findNextArgs.args.isCSen && !findNextArgs.args.isEMatch) {\n                        var index = cellval.indexOf(findNextArgs.args.value) > -1;\n                        if ((cellval === findNextArgs.stringValue) || (index)) {\n                            var address = sheet.name + '!' + getCellAddress(findNextArgs.rowIndex, findNextArgs.colIndex);\n                            this.parent.notify(goto, { address: address });\n                            findNextArgs.count++;\n                            return true;\n                        }\n                    }\n                    else if (!findNextArgs.args.isCSen && findNextArgs.args.isEMatch) {\n                        findNextArgs.val = cellval.toString().toLowerCase();\n                        if (findNextArgs.val === findNextArgs.stringValue) {\n                            var address = sheet.name + '!' + getCellAddress(findNextArgs.rowIndex, findNextArgs.colIndex);\n                            this.parent.notify(goto, { address: address });\n                            findNextArgs.count++;\n                            return true;\n                        }\n                    }\n                    else if (!findNextArgs.args.isCSen && !findNextArgs.args.isEMatch) {\n                        findNextArgs.val = cellval.toString().toLowerCase();\n                        var index = findNextArgs.val.indexOf(findNextArgs.args.value.toString().toLowerCase()) > -1;\n                        var lowerCaseIndex = findNextArgs.val.indexOf(findNextArgs.args.value) > -1;\n                        if ((findNextArgs.val === findNextArgs.stringValue) || ((cellval === findNextArgs.stringValue) || (index)) ||\n                            (cellval === findNextArgs.stringValue) || (lowerCaseIndex)) {\n                            var address = sheet.name + '!' + getCellAddress(findNextArgs.rowIndex, findNextArgs.colIndex);\n                            this.parent.notify(goto, { address: address });\n                            findNextArgs.count++;\n                            return true;\n                        }\n                    }\n                }\n            }\n        }\n        return false;\n    };\n    WorkbookFindAndReplace.prototype.findPrevious = function (args) {\n        var sheets = this.parent.sheets;\n        var sheetIndex = args.sheetIndex;\n        var sheet = sheets[sheetIndex];\n        var valueOfCell;\n        var cellFormat;\n        var val;\n        var activecell = getCellIndexes(sheet.activeCell);\n        var loopCount = 0;\n        var count = 0;\n        var endRow = sheet.usedRange.rowIndex;\n        var endColumn = sheet.usedRange.colIndex;\n        var stringValue = args.value.toString();\n        var cidx = activecell[1];\n        var ridx = activecell[0];\n        var startColumn = cidx;\n        var startRow = ridx;\n        if (sheet.rows[ridx]) {\n            if (sheet.rows[ridx].cells[cidx]) {\n                cellFormat = sheet.rows[ridx].cells[cidx].format;\n                if (cellFormat) {\n                    var displayTxt = this.parent.getDisplayText(sheet.rows[ridx].cells[cidx]);\n                    valueOfCell = displayTxt.toString();\n                }\n                else {\n                    if (sheet.rows[ridx].cells[cidx].value) {\n                        valueOfCell = sheet.rows[ridx].cells[cidx].value.toString();\n                    }\n                }\n            }\n        }\n        if (valueOfCell) {\n            var lcValue = valueOfCell.toLowerCase();\n            var ivalue = valueOfCell.indexOf(args.value) > -1;\n            var lowerCaseIndex = lcValue.indexOf(args.value.toString().toLowerCase()) > -1;\n            if ((stringValue === valueOfCell) || (stringValue === lcValue) || (ivalue) || (lowerCaseIndex)) {\n                if (args.searchBy === 'By Row') {\n                    cidx--;\n                }\n                if (args.searchBy === 'By Column') {\n                    ridx--;\n                }\n                count++;\n            }\n        }\n        if (activecell[0] > sheet.usedRange.rowIndex || activecell[1] > sheet.usedRange.colIndex) {\n            if (activecell[0] > sheet.usedRange.rowIndex && activecell[1] <= sheet.usedRange.colIndex) {\n                ridx = sheet.usedRange.rowIndex;\n                cidx = activecell[1];\n            }\n            else if (activecell[0] <= sheet.usedRange.rowIndex && activecell[1] > sheet.usedRange.colIndex) {\n                ridx = activecell[0];\n                cidx = sheet.usedRange.colIndex;\n            }\n            else {\n                ridx = sheet.usedRange.rowIndex;\n                cidx = sheet.usedRange.colIndex;\n            }\n        }\n        var findPrevArgs = {\n            rowIndex: ridx, colIndex: cidx, endRow: endRow, endColumn: endColumn, startRow: startRow,\n            loopCount: loopCount, count: count, args: args, val: val, stringValue: stringValue,\n            sheets: sheets, sheetIndex: sheetIndex, startColumn: startColumn,\n        };\n        if (args.searchBy === 'By Row') {\n            this.findPreRow(findPrevArgs);\n        }\n        if (args.searchBy === 'By Column') {\n            this.findPreCol(findPrevArgs);\n        }\n    };\n    WorkbookFindAndReplace.prototype.findPreRow = function (findPrevArgs) {\n        var usedRan;\n        var sheet = findPrevArgs.sheets[findPrevArgs.sheetIndex];\n        var sheetsLength = this.parent.sheets.length;\n        var noValueBoolean = false;\n        var activecell = getCellIndexes(sheet.activeCell);\n        if (findPrevArgs.colIndex === -1) {\n            findPrevArgs.colIndex = findPrevArgs.endColumn;\n            findPrevArgs.rowIndex--;\n        }\n        for (findPrevArgs.rowIndex; findPrevArgs.rowIndex >= -1; findPrevArgs.rowIndex--) {\n            if (findPrevArgs.rowIndex < 0 && findPrevArgs.colIndex < 0) {\n                if (findPrevArgs.args.mode === 'Workbook') {\n                    var noCellfound = this.parent.activeSheetIndex;\n                    findPrevArgs.sheetIndex--;\n                    if (findPrevArgs.sheetIndex === -1) {\n                        findPrevArgs.sheetIndex = sheetsLength - 1;\n                    }\n                    if (noCellfound === findPrevArgs.sheetIndex) {\n                        if (findPrevArgs.count === 0) {\n                            this.parent.notify(showDialog, null);\n                            return;\n                        }\n                    }\n                    sheet = findPrevArgs.sheets[findPrevArgs.sheetIndex];\n                    usedRan = sheet.usedRange;\n                    activecell = getCellIndexes(sheet.activeCell);\n                    findPrevArgs.rowIndex = usedRan.rowIndex;\n                    findPrevArgs.colIndex = usedRan.colIndex;\n                    findPrevArgs.endColumn = 0;\n                    findPrevArgs.endRow = 0;\n                }\n                noValueBoolean = this.commonCondition(findPrevArgs, activecell);\n            }\n            if (!noValueBoolean) {\n                if (findPrevArgs.args.mode !== 'Workbook') {\n                    if (findPrevArgs.count > 0) {\n                        if (findPrevArgs.rowIndex === -1) {\n                            findPrevArgs.rowIndex = findPrevArgs.endRow;\n                        }\n                    }\n                }\n                if (findPrevArgs.rowIndex === -1) {\n                    findPrevArgs.rowIndex = sheet.usedRange.rowIndex;\n                    findPrevArgs.colIndex = sheet.usedRange.colIndex;\n                }\n                if (sheet.rows[findPrevArgs.rowIndex]) {\n                    if (findPrevArgs.colIndex === -1) {\n                        findPrevArgs.colIndex = sheet.usedRange.colIndex;\n                    }\n                    for (findPrevArgs.colIndex; findPrevArgs.colIndex >= 0; findPrevArgs.colIndex--) {\n                        if (sheet.rows[findPrevArgs.rowIndex]) {\n                            if (sheet.rows[findPrevArgs.rowIndex].cells[findPrevArgs.colIndex]) {\n                                var checkTrue = this.prevCommon(findPrevArgs);\n                                if (checkTrue) {\n                                    return;\n                                }\n                            }\n                        }\n                    }\n                    if (findPrevArgs.loopCount > 0) {\n                        if (activecell[0] === findPrevArgs.rowIndex) {\n                            this.parent.notify(showDialog, null);\n                            return;\n                        }\n                    }\n                }\n            }\n        }\n        if (!noValueBoolean) {\n            if (findPrevArgs.count === 0) {\n                this.parent.notify(showDialog, null);\n                return;\n            }\n        }\n    };\n    WorkbookFindAndReplace.prototype.findPreCol = function (findPrevArgs) {\n        var usedRange;\n        var sheet = findPrevArgs.sheets[findPrevArgs.sheetIndex];\n        var sheetsLen = this.parent.sheets.length;\n        var noValueBoolean = false;\n        var activecell = getCellIndexes(sheet.activeCell);\n        for (findPrevArgs.colIndex; findPrevArgs.colIndex >= -1; findPrevArgs.colIndex--) {\n            if (findPrevArgs.rowIndex < 0 && findPrevArgs.colIndex < 0) {\n                if (findPrevArgs.args.mode === 'Workbook') {\n                    var noCellfound = this.parent.activeSheetIndex;\n                    findPrevArgs.sheetIndex--;\n                    if (findPrevArgs.sheetIndex === -1) {\n                        findPrevArgs.sheetIndex = sheetsLen - 1;\n                    }\n                    if (noCellfound === findPrevArgs.sheetIndex) {\n                        if (findPrevArgs.count === 0) {\n                            this.parent.notify(showDialog, null);\n                            return;\n                        }\n                    }\n                    sheet = findPrevArgs.sheets[findPrevArgs.sheetIndex];\n                    usedRange = sheet.usedRange;\n                    activecell = getCellIndexes(sheet.activeCell);\n                    findPrevArgs.rowIndex = usedRange.rowIndex;\n                    findPrevArgs.colIndex = usedRange.colIndex;\n                    findPrevArgs.endColumn = 0;\n                    findPrevArgs.endRow = 0;\n                }\n                noValueBoolean = this.commonCondition(findPrevArgs, activecell);\n            }\n            if (!noValueBoolean) {\n                if (findPrevArgs.count > 0) {\n                    if (findPrevArgs.colIndex < 0) {\n                        findPrevArgs.colIndex = findPrevArgs.endColumn;\n                    }\n                }\n                if (findPrevArgs.rowIndex < 0) {\n                    findPrevArgs.rowIndex = sheet.usedRange.rowIndex;\n                }\n                if (findPrevArgs.colIndex < -1) {\n                    findPrevArgs.colIndex = sheet.usedRange.colIndex;\n                    findPrevArgs.rowIndex--;\n                }\n                if (sheet.rows[findPrevArgs.rowIndex]) {\n                    if (sheet.rows[findPrevArgs.rowIndex].cells[findPrevArgs.colIndex]) {\n                        if (findPrevArgs.rowIndex === -1) {\n                            findPrevArgs.rowIndex = sheet.usedRange.rowIndex;\n                        }\n                    }\n                }\n                for (findPrevArgs.rowIndex; findPrevArgs.rowIndex >= 0; findPrevArgs.rowIndex--) {\n                    if (sheet.rows[findPrevArgs.rowIndex]) {\n                        if (sheet.rows[findPrevArgs.rowIndex].cells[findPrevArgs.colIndex]) {\n                            var check = this.prevCommon(findPrevArgs);\n                            if (check) {\n                                return;\n                            }\n                        }\n                    }\n                    if (findPrevArgs.loopCount > 0) {\n                        if (activecell[1] === findPrevArgs.colIndex) {\n                            this.parent.notify(showDialog, null);\n                            return;\n                        }\n                    }\n                }\n            }\n        }\n        if (!noValueBoolean) {\n            if (findPrevArgs.count === 0) {\n                this.parent.notify(showDialog, null);\n                return;\n            }\n        }\n    };\n    WorkbookFindAndReplace.prototype.commonCondition = function (findPrevArgs, activecell) {\n        var sheet = findPrevArgs.sheets[findPrevArgs.sheetIndex];\n        var isTrue;\n        if ((activecell[0] !== findPrevArgs.endRow && activecell[1] !== findPrevArgs.endColumn) ||\n            (activecell[0] !== findPrevArgs.endRow || activecell[1] !== findPrevArgs.endColumn)) {\n            findPrevArgs.startColumn = sheet.usedRange.colIndex;\n            findPrevArgs.startRow = sheet.usedRange.rowIndex;\n            findPrevArgs.endColumn = 0;\n            findPrevArgs.endRow = activecell[0];\n            findPrevArgs.rowIndex = findPrevArgs.startRow;\n            findPrevArgs.colIndex = findPrevArgs.startColumn;\n            findPrevArgs.loopCount++;\n            isTrue = false;\n        }\n        else if ((activecell[0] === sheet.usedRange.rowIndex && activecell[1] === sheet.usedRange.colIndex) ||\n            (activecell[0] > sheet.usedRange.rowIndex || activecell[1] > sheet.usedRange.colIndex)) {\n            this.parent.notify(showDialog, null);\n            isTrue = true;\n        }\n        return isTrue;\n    };\n    WorkbookFindAndReplace.prototype.prevCommon = function (findPrevArgs) {\n        var sheet = findPrevArgs.sheets[findPrevArgs.sheetIndex];\n        if (sheet.rows[findPrevArgs.rowIndex]) {\n            var rowCol = sheet.rows[findPrevArgs.rowIndex].cells[findPrevArgs.colIndex];\n            if (rowCol && rowCol.value) {\n                var cellType = sheet.rows[findPrevArgs.rowIndex].cells[findPrevArgs.colIndex];\n                if (cellType) {\n                    var cellvalue = void 0;\n                    if (cellType.format) {\n                        var displayTxt = this.parent.getDisplayText(sheet.rows[findPrevArgs.rowIndex]\n                            .cells[findPrevArgs.colIndex]);\n                        cellvalue = displayTxt;\n                    }\n                    else {\n                        cellvalue = sheet.rows[findPrevArgs.rowIndex].cells[findPrevArgs.colIndex].value.toString();\n                    }\n                    if (findPrevArgs.args.isCSen && findPrevArgs.args.isEMatch) {\n                        if (cellvalue === findPrevArgs.stringValue) {\n                            var address = sheet.name + '!' + getCellAddress(findPrevArgs.rowIndex, findPrevArgs.colIndex);\n                            this.parent.notify(goto, { address: address });\n                            findPrevArgs.count++;\n                            return true;\n                        }\n                    }\n                    else if (findPrevArgs.args.isCSen && !findPrevArgs.args.isEMatch) {\n                        var index = cellvalue.indexOf(findPrevArgs.args.value) > -1;\n                        if ((cellvalue === findPrevArgs.stringValue) || (index)) {\n                            var address = sheet.name + '!' + getCellAddress(findPrevArgs.rowIndex, findPrevArgs.colIndex);\n                            this.parent.notify(goto, { address: address });\n                            findPrevArgs.count++;\n                            return true;\n                        }\n                    }\n                    else if (!findPrevArgs.args.isCSen && findPrevArgs.args.isEMatch) {\n                        findPrevArgs.val = cellvalue.toString().toLowerCase();\n                        if (findPrevArgs.val === findPrevArgs.stringValue) {\n                            var address = sheet.name + '!' + getCellAddress(findPrevArgs.rowIndex, findPrevArgs.colIndex);\n                            this.parent.notify(goto, { address: address });\n                            findPrevArgs.count++;\n                            return true;\n                        }\n                    }\n                    else if (!findPrevArgs.args.isCSen && !findPrevArgs.args.isEMatch) {\n                        findPrevArgs.val = cellvalue.toString().toLowerCase();\n                        var index = findPrevArgs.val.indexOf(findPrevArgs.args.value.toString().toLowerCase()) > -1;\n                        var lowerCaseIndex = findPrevArgs.val.indexOf(findPrevArgs.args.value) > -1;\n                        if ((cellvalue === findPrevArgs.stringValue) || ((cellvalue === findPrevArgs.stringValue) ||\n                            (index)) || (findPrevArgs.val === findPrevArgs.stringValue) || (lowerCaseIndex)) {\n                            var address = sheet.name + '!' + getCellAddress(findPrevArgs.rowIndex, findPrevArgs.colIndex);\n                            this.parent.notify(goto, { address: address });\n                            findPrevArgs.count++;\n                            return true;\n                        }\n                    }\n                }\n            }\n        }\n        return false;\n    };\n    WorkbookFindAndReplace.prototype.replace = function (args) {\n        if (this.parent.getActiveSheet().isProtected) {\n            this.parent.notify(workBookeditAlert, null);\n            return;\n        }\n        var sheet = this.parent.getActiveSheet();\n        var activecell = getCellIndexes(sheet.activeCell);\n        var currentCell = sheet.rows[activecell[0]].cells[activecell[1]].value.toString();\n        var index = currentCell.indexOf(args.value) > -1;\n        var lowerCaseIndex = currentCell.toLowerCase().indexOf(args.value.toString().toLowerCase()) > -1;\n        var val = currentCell.toString().toLowerCase();\n        if ((currentCell !== args.value) && (!index) && (val !== args.value) && (!lowerCaseIndex)) {\n            args.findOpt = 'next';\n            this.findNext(args);\n        }\n        this.parent.getActiveSheet();\n        var activecel = getCellIndexes(sheet.activeCell);\n        var address = sheet.activeCell;\n        var cell = sheet.rows[activecel[0]].cells[activecel[1]];\n        var cellFormat = sheet.rows[activecel[0]].cells[activecel[1]].format;\n        var compareVal;\n        var replaceAddress = sheet.name + '!' + getCellAddress(activecel[0], activecel[1]);\n        if (cellFormat) {\n            var dispTxt = this.parent.getDisplayText(sheet.rows[activecel[0]].cells[activecel[1]]);\n            compareVal = dispTxt.toString();\n        }\n        else {\n            compareVal = sheet.rows[activecel[0]].cells[activecel[1]].value.toString();\n        }\n        var replaceAllCollection = { undoRedoOpt: 'before', address: replaceAddress, compareVal: compareVal };\n        this.parent.notify(findUndoRedo, replaceAllCollection);\n        var lcValueOfCell = compareVal.toLowerCase();\n        var ivalueOfCell = compareVal.indexOf(args.value) > -1;\n        var caseInSensitive = lcValueOfCell.indexOf(args.value) > -1;\n        if ((args.value === compareVal) || (args.value === lcValueOfCell)) {\n            sheet.rows[activecel[0]].cells[activecel[1]].value = args.replaceValue;\n            this.parent.updateCell(cell, address);\n            var replaceAllCollection_1 = { address: replaceAddress, compareVal: args.replaceValue, undoRedoOpt: 'after' };\n            this.parent.notify(findUndoRedo, replaceAllCollection_1);\n        }\n        else if (ivalueOfCell) {\n            var newValue = compareVal.replace(args.value, args.replaceValue);\n            sheet.rows[activecel[0]].cells[activecel[1]].value = newValue;\n            this.parent.updateCell(cell, address);\n            var replaceAllCollection_2 = { address: replaceAddress, compareVal: args.replaceValue, undoRedoOpt: 'after' };\n            this.parent.notify(findUndoRedo, replaceAllCollection_2);\n        }\n        else if (caseInSensitive) {\n            var regx = new RegExp(args.value.toString().replace(/[.*+?^${}()|[\\]\\\\]/g, '\\\\$&'), 'ig');\n            var updateValue = compareVal.replace(regx, args.replaceValue);\n            sheet.rows[activecel[0]].cells[activecel[1]].value = updateValue;\n            this.parent.updateCell(cell, address);\n            var replaceAllCollection_3 = { address: replaceAddress, compareVal: args.replaceValue, undoRedoOpt: 'after' };\n            this.parent.notify(findUndoRedo, replaceAllCollection_3);\n        }\n    };\n    WorkbookFindAndReplace.prototype.replaceAll = function (args) {\n        var startSheet = 0;\n        var sheet = this.parent.sheets[startSheet];\n        var endRow = sheet.usedRange.rowIndex;\n        var count = 0;\n        var undoRedoOpt = 'beforeReplaceAll';\n        var startRow = 0;\n        var endColumn = sheet.usedRange.colIndex;\n        var startColumn = 0;\n        var addressCollection = [];\n        var address;\n        for (startRow; startRow <= endRow; startRow++) {\n            if (startColumn > endColumn && startRow === endRow) {\n                if (args.mode === 'Workbook') {\n                    startSheet++;\n                    sheet = this.parent.sheets[startSheet];\n                    if (sheet) {\n                        startColumn = 0;\n                        startRow = 0;\n                        endColumn = sheet.usedRange.colIndex;\n                        endRow = sheet.usedRange.rowIndex;\n                        sheet = sheet;\n                    }\n                }\n            }\n            if (sheet) {\n                if (sheet.rows[startRow]) {\n                    var row = sheet.rows[startRow];\n                    if (startColumn === endColumn + 1) {\n                        startColumn = 0;\n                    }\n                    for (startColumn; startColumn <= endColumn; startColumn++) {\n                        var cell = sheet.rows[startRow].cells[startColumn];\n                        if (row) {\n                            if (row.cells[startColumn] && row.cells[startColumn].value) {\n                                var cellType = sheet.rows[startRow].cells[startColumn];\n                                if (cellType) {\n                                    var cellTypeVal = cellType.format;\n                                    var cellval = void 0;\n                                    if (cellTypeVal) {\n                                        var displayTxt = this.parent.getDisplayText(sheet.rows[startRow].\n                                            cells[startColumn]);\n                                        cellval = displayTxt.toString();\n                                    }\n                                    else {\n                                        cellval = sheet.rows[startRow].cells[startColumn].value.toString();\n                                    }\n                                    if (args.isCSen && args.isEMatch) {\n                                        if (cellval === args.value) {\n                                            sheet.rows[startRow].cells[startColumn].value = args.replaceValue;\n                                            address = sheet.name + '!' + getCellAddress(startRow, startColumn);\n                                            this.parent.updateCell(cell, address);\n                                            addressCollection.push(address);\n                                            count++;\n                                        }\n                                    }\n                                    else if (args.isCSen && !args.isEMatch) {\n                                        var index = cellval.indexOf(args.value) > -1;\n                                        if ((cellval === args.value) || (index)) {\n                                            var newValue = cellval.replace(args.value, args.replaceValue);\n                                            sheet.rows[startRow].cells[startColumn].value = newValue;\n                                            address = sheet.name + '!' + getCellAddress(startRow, startColumn);\n                                            this.parent.updateCell(cell, address);\n                                            addressCollection.push(address);\n                                            count++;\n                                        }\n                                    }\n                                    else if (!args.isCSen && args.isEMatch) {\n                                        var val = cellval.toString().toLowerCase();\n                                        if (val === args.value) {\n                                            sheet.rows[startRow].cells[startColumn].value = args.replaceValue;\n                                            address = sheet.name + '!' + getCellAddress(startRow, startColumn);\n                                            this.parent.updateCell(cell, address);\n                                            addressCollection.push(address);\n                                            count++;\n                                        }\n                                    }\n                                    else if (!args.isCSen && !args.isEMatch) {\n                                        var val = cellval.toString().toLowerCase();\n                                        var index = val.indexOf(args.value.toString().toLowerCase()) > -1;\n                                        var lowerCaseValue = val.indexOf(args.value) > -1;\n                                        if (((cellval === args.value) || (index)) || (val === args.value) || (cellval === args.value) ||\n                                            (lowerCaseValue)) {\n                                            var regExepression = new RegExp(args.value.toString().replace(/[.*+?^${}()|[\\]\\\\]/g, '\\\\$&'), 'ig');\n                                            var newValue = cellval.replace(regExepression, args.replaceValue);\n                                            sheet.rows[startRow].cells[startColumn].value = newValue;\n                                            address = sheet.name + '!' + getCellAddress(startRow, startColumn);\n                                            this.parent.updateCell(cell, address);\n                                            addressCollection.push(address);\n                                            count++;\n                                        }\n                                    }\n                                }\n                            }\n                        }\n                    }\n                }\n            }\n        }\n        var replaceAllCollection = {\n            undoRedoOpt: undoRedoOpt, Collection: addressCollection,\n            replaceValue: args.value\n        };\n        this.parent.notify(findUndoRedo, replaceAllCollection);\n        replaceAllCollection = {\n            undoRedoOpt: 'afterReplaceAll', Collection: addressCollection,\n            replaceValue: args.replaceValue\n        };\n        this.parent.notify(findUndoRedo, replaceAllCollection);\n        var countNumber = count;\n        this.parent.notify(replaceAllDialog, { count: countNumber, replaceValue: args.replaceValue });\n    };\n    WorkbookFindAndReplace.prototype.totalCount = function (args) {\n        var startSheet = 0;\n        var sheet = this.parent.sheets[startSheet];\n        var endRow = sheet.usedRange.rowIndex;\n        var count = 0;\n        var rowIndex = 0;\n        var endColumn = sheet.usedRange.colIndex;\n        var columnIndex = 0;\n        for (rowIndex; rowIndex <= endRow; rowIndex++) {\n            if (sheet.rows[rowIndex]) {\n                var row = sheet.rows[rowIndex];\n                if (columnIndex === endColumn + 1) {\n                    columnIndex = 0;\n                }\n                for (columnIndex; columnIndex <= endColumn; columnIndex++) {\n                    if (row) {\n                        if (row.cells[columnIndex] && row.cells[columnIndex].value) {\n                            var cellType = sheet.rows[rowIndex].cells[columnIndex];\n                            if (cellType) {\n                                var cellFormat = cellType.format;\n                                var cellvalue = void 0;\n                                if (cellFormat) {\n                                    var displayTxt = this.parent.getDisplayText(sheet.rows[rowIndex].\n                                        cells[columnIndex]);\n                                    cellvalue = displayTxt.toString();\n                                }\n                                else {\n                                    cellvalue = cellType.value.toString();\n                                }\n                                if (args.isCSen && args.isEMatch) {\n                                    if (cellvalue === args.value) {\n                                        count++;\n                                    }\n                                }\n                                else if (args.isCSen && !args.isEMatch) {\n                                    var index = cellvalue.indexOf(args.value) > -1;\n                                    if ((cellvalue === args.value) || (index)) {\n                                        count++;\n                                    }\n                                }\n                                else if (!args.isCSen && args.isEMatch) {\n                                    var val = cellvalue.toString().toLowerCase();\n                                    if (val === args.value) {\n                                        count++;\n                                    }\n                                }\n                                else if (!args.isCSen && !args.isEMatch) {\n                                    var val = cellvalue.toString().toLowerCase();\n                                    var index = val.indexOf(args.value.toString().toLowerCase()) > -1;\n                                    var lowerCaseValue = val.indexOf(args.value) > -1;\n                                    if ((val === args.value) || ((cellvalue === args.value) || (index)) || (cellvalue === args.value) ||\n                                        (lowerCaseValue)) {\n                                        count++;\n                                    }\n                                }\n                            }\n                        }\n                    }\n                }\n            }\n        }\n        var totalCount = count;\n        var requiredCount = this.requiredCount(args) - 1;\n        count = totalCount - requiredCount;\n        if (count > totalCount) {\n            count = totalCount;\n        }\n        if (count !== 0) {\n            var activecel = getCellIndexes(sheet.activeCell);\n            var val = this.parent.getDisplayText(sheet.rows[activecel[0]].cells[activecel[1]]).toString().toLowerCase();\n            if (val.indexOf(args.value.toString().toLowerCase()) === -1) {\n                count = count - 1;\n            }\n        }\n        args.findCount = count + ' ' + 'of' + ' ' + totalCount;\n        return;\n    };\n    WorkbookFindAndReplace.prototype.requiredCount = function (args) {\n        var sheetIndex = this.parent.activeSheetIndex;\n        var sheet = this.parent.sheets[sheetIndex];\n        var activecel = getCellIndexes(sheet.activeCell);\n        var endRow = sheet.usedRange.rowIndex;\n        var requiredCount = 0;\n        var startRow = activecel[0];\n        var endColumn = sheet.usedRange.colIndex;\n        var startColumn = activecel[1];\n        for (startRow; startRow <= endRow; startRow++) {\n            if (sheet.rows[startRow]) {\n                var row = sheet.rows[startRow];\n                if (startColumn === endColumn + 1) {\n                    startColumn = 0;\n                }\n                for (startColumn; startColumn <= endColumn; startColumn++) {\n                    if (row) {\n                        if (row.cells[startColumn] && row.cells[startColumn].value) {\n                            if (sheet.rows[startRow].cells[startColumn]) {\n                                var cellval = void 0;\n                                if (sheet.rows[startRow].cells[startColumn].format) {\n                                    var displayTxt = this.parent.getDisplayText(sheet.rows[startRow].\n                                        cells[startColumn]);\n                                    cellval = displayTxt.toString();\n                                }\n                                else {\n                                    cellval = sheet.rows[startRow].cells[startColumn].value.toString();\n                                }\n                                if (args.isCSen && !args.isEMatch) {\n                                    var index = cellval.indexOf(args.value) > -1;\n                                    if ((cellval === args.value) || (index)) {\n                                        requiredCount++;\n                                    }\n                                }\n                                else if (args.isCSen && args.isEMatch) {\n                                    if (cellval === args.value) {\n                                        requiredCount++;\n                                    }\n                                }\n                                else if (!args.isCSen && args.isEMatch) {\n                                    var val = cellval.toString().toLowerCase();\n                                    if (val === args.value) {\n                                        requiredCount++;\n                                    }\n                                }\n                                else if (!args.isCSen && !args.isEMatch) {\n                                    var val = cellval.toString().toLowerCase();\n                                    var argsVal = args.value.toString().toLowerCase();\n                                    var index = val.indexOf(argsVal) > -1;\n                                    var lowerCaseVal = val.indexOf(args.value) > -1;\n                                    if ((cellval === args.value) || ((val === argsVal) || (index)) || (val === args.value) ||\n                                        (lowerCaseVal)) {\n                                        requiredCount++;\n                                    }\n                                }\n                            }\n                        }\n                    }\n                }\n            }\n        }\n        return requiredCount;\n    };\n    WorkbookFindAndReplace.prototype.findAllValues = function (findAllArguments) {\n        var startSheet = findAllArguments.sheetIndex;\n        var sheet = this.parent.sheets[startSheet - 1];\n        var endRow = sheet.usedRange.rowIndex;\n        var rowIndex = 0;\n        var count = 0;\n        var address;\n        var endColumn = sheet.usedRange.colIndex;\n        var columnIndex = 0;\n        var sheetName;\n        var sheetLength = this.parent.sheets.length;\n        var initialSheet = findAllArguments.sheetIndex;\n        for (rowIndex; rowIndex <= endRow + 1; rowIndex++) {\n            if ((initialSheet !== 1) && (findAllArguments.sheetIndex === sheetLength)) {\n                startSheet = 1;\n            }\n            if (rowIndex > endRow && columnIndex > endColumn) {\n                if (findAllArguments.mode === 'Workbook') {\n                    startSheet++;\n                    if (initialSheet === startSheet) {\n                        if (count === 0) {\n                            return;\n                        }\n                        return;\n                    }\n                    if (startSheet > sheetLength - 1) {\n                        startSheet = 0;\n                    }\n                    sheet = this.parent.sheets[startSheet];\n                    if (sheet) {\n                        rowIndex = 0;\n                        columnIndex = 0;\n                        endColumn = sheet.usedRange.colIndex;\n                        endRow = sheet.usedRange.rowIndex;\n                        sheet = sheet;\n                    }\n                }\n            }\n            if (!isNullOrUndefined(sheet)) {\n                if (sheet.rows[rowIndex]) {\n                    var row = sheet.rows[rowIndex];\n                    if (columnIndex === endColumn + 2) {\n                        columnIndex = 0;\n                    }\n                    for (columnIndex; columnIndex <= endColumn + 1; columnIndex++) {\n                        if (row) {\n                            if (row.cells[columnIndex]) {\n                                var cell = sheet.rows[rowIndex].cells[columnIndex];\n                                if (cell) {\n                                    var cellFormat = cell.format;\n                                    var cellvalue = void 0;\n                                    if (cellFormat) {\n                                        var displayTxt = this.parent.getDisplayText(sheet.rows[rowIndex].\n                                            cells[columnIndex]);\n                                        cellvalue = displayTxt.toString();\n                                    }\n                                    else {\n                                        cellvalue = cell.value.toString();\n                                    }\n                                    if (findAllArguments.isCSen && findAllArguments.isEMatch) {\n                                        if (cellvalue === findAllArguments.value) {\n                                            address = sheet.name + '!' + getCellAddress(rowIndex, columnIndex);\n                                            findAllArguments.findCollection.push(address);\n                                            count++;\n                                        }\n                                    }\n                                    else if (findAllArguments.isCSen && !findAllArguments.isEMatch) {\n                                        var index = cellvalue.indexOf(findAllArguments.value) > -1;\n                                        if ((cellvalue === findAllArguments.value) || (index)) {\n                                            address = sheet.name + '!' + getCellAddress(rowIndex, columnIndex);\n                                            findAllArguments.findCollection.push(address);\n                                            count++;\n                                        }\n                                    }\n                                    else if (!findAllArguments.isCSen && findAllArguments.isEMatch) {\n                                        var val = cellvalue.toString().toLowerCase();\n                                        if (val === findAllArguments.value) {\n                                            address = sheet.name + '!' + getCellAddress(rowIndex, columnIndex);\n                                            findAllArguments.findCollection.push(address);\n                                            count++;\n                                        }\n                                    }\n                                    else if (!findAllArguments.isCSen && !findAllArguments.isEMatch) {\n                                        var val = cellvalue.toString().toLowerCase();\n                                        var index = val.indexOf(findAllArguments.value.toLowerCase()) > -1;\n                                        if ((val === findAllArguments.value) || ((cellvalue === findAllArguments.value) || (index)) ||\n                                            ((cellvalue === findAllArguments.value))) {\n                                            address = sheet.name + '!' + getCellAddress(rowIndex, columnIndex);\n                                            findAllArguments.findCollection.push(address);\n                                            count++;\n                                        }\n                                    }\n                                }\n                            }\n                        }\n                    }\n                }\n            }\n        }\n        if (count === 0) {\n            return;\n        }\n        return;\n    };\n    /**\n     * Gets the module name.\n     * @returns string\n     */\n    WorkbookFindAndReplace.prototype.getModuleName = function () {\n        return 'workbookfindAndReplace';\n    };\n    return WorkbookFindAndReplace;\n}());\nexport { WorkbookFindAndReplace };\n","import { setColumn } from '../base/index';\nimport { applyLockCells } from '../common/index';\nimport { protectsheetHandler, protectSheetWorkBook, updateToggle, setLockCells } from '../common/index';\nimport { unprotectsheetHandler } from '../common/index';\nimport { getRangeIndexes, getSwapRange } from '../common/index';\nimport { isUndefined } from '@syncfusion/ej2-base';\n/**\n * The `WorkbookSpreadSheet` module is used to handle the Protecting functionalities in Workbook.\n */\nvar WorkbookProtectSheet = /** @class */ (function () {\n    /**\n     * Constructor for edit module in Workbook.\n     * @private\n     */\n    function WorkbookProtectSheet(workbook) {\n        this.parent = workbook;\n        this.addEventListener();\n    }\n    WorkbookProtectSheet.prototype.protectsheetHandler = function (args) {\n        var sheet = this.parent.getActiveSheet();\n        this.parent.setSheetPropertyOnMute(sheet, 'protectSettings', {\n            selectCells: args.selectCells, formatCells: args.formatCells,\n            formatColumns: args.formatColumns, formatRows: args.formatRows, insertLink: args.insertLink\n        });\n        this.parent.notify(protectSheetWorkBook, sheet.protectSettings);\n        this.parent.notify(updateToggle, { props: 'Protect' });\n        sheet.columns.forEach(function (column) {\n            if (column && isUndefined(column.isLocked)) {\n                column.isLocked = true;\n            }\n        });\n    };\n    WorkbookProtectSheet.prototype.unprotectsheetHandler = function (args) {\n        var sheet = this.parent.getActiveSheet();\n        if (args.sheet) {\n            sheet = this.parent.sheets[args.sheet];\n        }\n        sheet.protectSettings.formatCells = sheet.protectSettings.formatColumns = false;\n        sheet.protectSettings.formatRows = sheet.protectSettings.selectCells = false;\n        this.parent.setSheetPropertyOnMute(sheet, 'isProtected', false);\n        this.parent.notify(protectSheetWorkBook, sheet.protectSettings);\n        this.parent.notify(updateToggle, { props: 'Protect' });\n    };\n    /**\n     * To destroy the edit module.\n     * @return {void}\n     * @hidden\n     */\n    WorkbookProtectSheet.prototype.destroy = function () {\n        this.removeEventListener();\n        this.parent = null;\n    };\n    WorkbookProtectSheet.prototype.addEventListener = function () {\n        this.parent.on(protectsheetHandler, this.protectsheetHandler, this);\n        this.parent.on(unprotectsheetHandler, this.unprotectsheetHandler, this);\n        this.parent.on(setLockCells, this.lockCells, this);\n    };\n    WorkbookProtectSheet.prototype.removeEventListener = function () {\n        if (!this.parent.isDestroyed) {\n            this.parent.off(protectsheetHandler, this.protectsheetHandler);\n            this.parent.off(setLockCells, this.lockCells);\n            this.parent.off(protectsheetHandler, this.unprotectsheetHandler);\n        }\n    };\n    WorkbookProtectSheet.prototype.lockCells = function (args) {\n        var sheet = this.parent.getActiveSheet();\n        var range;\n        if (args) {\n            range = args.range;\n        }\n        else {\n            range = sheet.selectedRange;\n        }\n        var indexes = typeof (range) === 'object' ? range :\n            getSwapRange(getRangeIndexes(range));\n        if (indexes[0] === 0 && indexes[2] === sheet.rowCount - 1) {\n            for (var i = indexes[1]; i <= indexes[3]; i++) {\n                setColumn(sheet, i, { isLocked: args.isLocked });\n            }\n        }\n        for (var i = indexes[0]; i <= indexes[2]; i++) {\n            for (var j = indexes[1]; j <= indexes[3]; j++) {\n                if (this.parent.getActiveSheet().id === sheet.id) {\n                    this.parent.notify(applyLockCells, { rowIdx: i, colIdx: j, isLocked: args.isLocked\n                    });\n                }\n            }\n        }\n    };\n    /**\n     * Get the module name.\n     * @returns string\n     * @private\n     */\n    WorkbookProtectSheet.prototype.getModuleName = function () {\n        return 'workbookProtectSheet';\n    };\n    return WorkbookProtectSheet;\n}());\nexport { WorkbookProtectSheet };\n","import { getCell, setCell } from '../base/index';\nimport { setMerge, getSwapRange, getRangeIndexes, mergedRange, applyMerge, activeCellMergedRange } from './../common/index';\nimport { insertMerge, activeCellChanged, pasteMerge, getCellIndexes, checkIsFormula, setCellFormat } from './../common/index';\nimport { isNullOrUndefined } from '@syncfusion/ej2-base';\n/**\n * The `WorkbookMerge` module is used to merge the range of cells.\n */\nvar WorkbookMerge = /** @class */ (function () {\n    /**\n     * Constructor for the workbook merge module.\n     * @private\n     */\n    function WorkbookMerge(parent) {\n        this.parent = parent;\n        this.addEventListener();\n    }\n    WorkbookMerge.prototype.merge = function (args) {\n        if (args.isAction) {\n            this.parent.notify('actionBegin', { eventArgs: args, action: 'merge' });\n            if (!args.model) {\n                args.model = [];\n            }\n        }\n        if (typeof (args.range) === 'string') {\n            args.range = getRangeIndexes(args.range);\n        }\n        args.range = getSwapRange(args.range);\n        var sheet = args.sheet || this.parent.getActiveSheet();\n        if (!args.skipChecking) {\n            this.mergedRange(args);\n        }\n        if (!args.merge || args.type === 'All') {\n            this.mergeAll(args);\n            if (args.refreshRibbon) {\n                this.parent.notify(activeCellChanged, null);\n            }\n        }\n        else if (args.type === 'Horizontally') {\n            this.mergeHorizontally(args);\n        }\n        else if (args.type === 'Vertically') {\n            this.mergeVertically(args);\n        }\n        this.parent.setUsedRange(args.range[2], args.range[3]);\n        if (args.isAction) {\n            this.parent.notify('actionComplete', { eventArgs: args, action: 'merge' });\n        }\n        if (this.parent.sheets.indexOf(sheet) === this.parent.activeSheetIndex) {\n            this.parent.notify('selectRange', { indexes: getRangeIndexes(sheet.selectedRange), skipChecking: true });\n        }\n    };\n    WorkbookMerge.prototype.mergeAll = function (args) {\n        var rowSpan = 0;\n        var cell;\n        args.range = args.range;\n        var colSpan;\n        var value;\n        var sheet = args.sheet || this.parent.getActiveSheet();\n        var curCell;\n        var startCell = getCell(args.range[0], args.range[1], sheet);\n        var border = startCell ? (startCell.style ? startCell.style.borderLeft : null) : null;\n        if (border === 'none') {\n            border = startCell.style.borderRight !== 'none' ? startCell.style.borderRight :\n                (startCell.style.borderTop ? startCell.style.borderTop : null);\n        }\n        if (border === 'none') {\n            border = startCell.style.borderBottom !== 'none' ? startCell.style.borderBottom : null;\n        }\n        if (!isNullOrUndefined(startCell) && !isNullOrUndefined(border)) {\n            startCell.style.borderBottom = '';\n            startCell.style.borderLeft = '';\n            startCell.style.borderTop = '';\n            startCell.style.borderRight = '';\n        }\n        for (var i = args.range[0]; i <= args.range[2]; i++) {\n            colSpan = 0;\n            if (args.isAction) {\n                args.model.push({ cells: [] });\n            }\n            for (var j = args.range[1]; j <= args.range[3]; j++) {\n                cell = getCell(i, j, sheet);\n                if (cell && (cell.value || cell.formula) && !value) {\n                    value = cell.formula || cell.value;\n                }\n                if (args.isAction && args.merge) {\n                    args.model[i - args.range[0]].cells[j - args.range[1]] = {};\n                    Object.assign(args.model[i - args.range[0]].cells[j - args.range[1]], cell);\n                }\n                if (sheet.rows[i] && sheet.rows[i].cells && sheet.rows[i].cells[j]) {\n                    delete sheet.rows[i].cells[j].rowSpan;\n                    delete sheet.rows[i].cells[j].colSpan;\n                    if (!args.merge && !args.isAction && args.model && args.model[i - args.range[0]] && args.model[i - args.range[0]].\n                        cells[j - args.range[1]] && args.model[i - args.range[0]].cells[j - args.range[1]] !== {}) {\n                        setCell(i, j, sheet, args.model[i - args.range[0]].cells[j - args.range[1]]);\n                    }\n                }\n                if (args.merge) {\n                    cell = new Object();\n                    if (i === args.range[0] && j === args.range[1]) {\n                        if (args.range[3] - args.range[1] > 0) {\n                            cell.colSpan = (args.range[3] - args.range[1]) + 1;\n                        }\n                        if (args.range[2] - args.range[0] > 0) {\n                            cell.rowSpan = (args.range[2] - args.range[0]) + 1;\n                        }\n                        setCell(args.range[0], args.range[1], sheet, cell, true);\n                        continue;\n                    }\n                    else {\n                        if (i !== args.range[0]) {\n                            cell.rowSpan = -rowSpan;\n                        }\n                        if (j !== args.range[1]) {\n                            colSpan++;\n                            cell.colSpan = -colSpan;\n                        }\n                        if (sheet.rows[i] && sheet.rows[i].cells && sheet.rows[i].cells[j]) {\n                            delete sheet.rows[i].cells[j].value;\n                            delete sheet.rows[i].cells[j].formula;\n                        }\n                        curCell = getCell(i, j, sheet) || {};\n                        setCell(i, j, sheet, Object.assign(cell, curCell));\n                    }\n                }\n                if (!args.preventRefresh) {\n                    this.parent.notify(applyMerge, { rowIdx: i, colIdx: j });\n                }\n            }\n            rowSpan++;\n        }\n        if (args.merge) {\n            cell = this.getCellValue(args.range[0], args.range[1], value, sheet);\n            setCell(args.range[0], args.range[1], sheet, cell, true);\n            if (!args.preventRefresh) {\n                this.parent.notify(applyMerge, { rowIdx: args.range[0], colIdx: args.range[1] });\n            }\n        }\n        if (!isNullOrUndefined(border)) {\n            this.parent.notify(setCellFormat, { style: { border: border }, range: args.range, onActionUpdate: true });\n        }\n    };\n    WorkbookMerge.prototype.mergeHorizontally = function (args) {\n        var mergeCount;\n        args.range = args.range;\n        var cell;\n        var sheet = args.sheet || this.parent.getActiveSheet();\n        var newValue;\n        var rowIdx;\n        var curCell;\n        for (var i = args.range[0]; i <= args.range[2]; i++) {\n            mergeCount = 0;\n            if (args.isAction) {\n                args.model.push({ cells: [] });\n            }\n            for (var j = args.range[1]; j <= args.range[3]; j++) {\n                curCell = getCell(i, j, sheet);\n                cell = new Object();\n                if (args.isAction) {\n                    args.model[i - args.range[0]].cells[j - args.range[1]] = {};\n                    Object.assign(args.model[i - args.range[0]].cells[j - args.range[1]], curCell);\n                }\n                if (j === args.range[1]) {\n                    if (i === args.range[0]) {\n                        continue;\n                    }\n                    rowIdx = i - 1;\n                    if (sheet.rows[rowIdx] && sheet.rows[rowIdx].cells && sheet.rows[rowIdx].cells[j]) {\n                        delete sheet.rows[rowIdx].cells[j].rowSpan;\n                    }\n                    cell = this.getCellValue(rowIdx, j, newValue, sheet);\n                    if (args.range[3] - args.range[1] > 0) {\n                        cell.colSpan = (args.range[3] - args.range[1]) + 1;\n                    }\n                    newValue = null;\n                    setCell(rowIdx, j, sheet, cell, true);\n                }\n                else {\n                    if (curCell && (curCell.value || curCell.formula) && !newValue) {\n                        newValue = curCell.formula || curCell.value;\n                    }\n                    rowIdx = i;\n                    if (sheet.rows[rowIdx] && sheet.rows[rowIdx].cells && sheet.rows[rowIdx].cells[j]) {\n                        delete sheet.rows[rowIdx].cells[j].rowSpan;\n                        delete sheet.rows[rowIdx].cells[j].value;\n                        delete sheet.rows[rowIdx].cells[j].formula;\n                    }\n                    mergeCount++;\n                    cell.colSpan = -mergeCount;\n                    setCell(rowIdx, j, sheet, cell, true);\n                }\n                this.parent.notify(applyMerge, { rowIdx: rowIdx, colIdx: j });\n            }\n        }\n        if (sheet.rows[args.range[2]] && sheet.rows[args.range[2]].cells && sheet.rows[args.range[2]].cells[args.range[1]]) {\n            delete sheet.rows[args.range[2]].cells[args.range[1]].rowSpan;\n        }\n        cell = this.getCellValue(args.range[2], args.range[1], newValue, sheet);\n        if (args.range[3] - args.range[1] > 0) {\n            cell.colSpan = (args.range[3] - args.range[1]) + 1;\n        }\n        setCell(args.range[2], args.range[1], sheet, cell, true);\n        this.parent.notify(applyMerge, { rowIdx: args.range[2], colIdx: args.range[1] });\n    };\n    WorkbookMerge.prototype.getCellValue = function (rowIdx, colIdx, value, sheet) {\n        var cell = new Object();\n        var curCell = getCell(rowIdx, colIdx, sheet);\n        if (value && (!curCell || (!curCell.value && !curCell.formula))) {\n            if (checkIsFormula(value)) {\n                cell.formula = value;\n            }\n            else {\n                cell.value = value;\n            }\n        }\n        return cell;\n    };\n    WorkbookMerge.prototype.mergeVertically = function (args) {\n        var rowSpan = 0;\n        args.range = args.range;\n        var sheet = args.sheet || this.parent.getActiveSheet();\n        var cell;\n        var newValue;\n        var colIdx;\n        var curCell;\n        for (var i = args.range[1]; i <= args.range[3]; i++) {\n            for (var j = args.range[0]; j <= args.range[2]; j++) {\n                curCell = getCell(j, i, sheet);\n                if (args.isAction) {\n                    if (args.model[j - args.range[0]] === undefined) {\n                        args.model[j - args.range[0]] = { cells: [] };\n                    }\n                    args.model[j - args.range[0]].cells[i - args.range[1]] = {};\n                    Object.assign(args.model[j - args.range[0]].cells[i - args.range[1]], curCell);\n                }\n                if (j === args.range[0]) {\n                    rowSpan = 0;\n                    if (i === args.range[1]) {\n                        continue;\n                    }\n                    colIdx = i - 1;\n                    if (sheet.rows[j] && sheet.rows[j].cells && sheet.rows[j].cells[colIdx]) {\n                        delete sheet.rows[j].cells[colIdx].colSpan;\n                    }\n                    cell = this.getCellValue(j, colIdx, newValue, sheet);\n                    if (args.range[2] - args.range[0] > 0) {\n                        cell.rowSpan = (args.range[2] - args.range[0]) + 1;\n                    }\n                    newValue = null;\n                    setCell(j, colIdx, sheet, cell, true);\n                }\n                else {\n                    cell = new Object();\n                    if (curCell && (curCell.value || curCell.formula) && !newValue) {\n                        newValue = curCell.formula || curCell.value;\n                    }\n                    rowSpan++;\n                    colIdx = i;\n                    if (sheet.rows[j] && sheet.rows[j].cells && sheet.rows[j].cells[colIdx]) {\n                        delete sheet.rows[j].cells[colIdx].colSpan;\n                        delete sheet.rows[j].cells[colIdx].value;\n                        delete sheet.rows[j].cells[colIdx].formula;\n                    }\n                    cell.rowSpan = -rowSpan;\n                    setCell(j, colIdx, sheet, cell, true);\n                }\n                this.parent.notify(applyMerge, { rowIdx: j, colIdx: colIdx });\n            }\n        }\n        if (sheet.rows[args.range[0]] && sheet.rows[args.range[0]].cells && sheet.rows[args.range[0]].cells[args.range[3]]) {\n            delete sheet.rows[args.range[0]].cells[args.range[3]].colSpan;\n        }\n        cell = this.getCellValue(args.range[0], args.range[1], newValue, sheet);\n        if (args.range[2] - args.range[0] > 0) {\n            cell.rowSpan = (args.range[2] - args.range[0]) + 1;\n        }\n        setCell(args.range[0], args.range[3], sheet, cell, true);\n        this.parent.notify(applyMerge, { rowIdx: args.range[0], colIdx: args.range[3] });\n    };\n    WorkbookMerge.prototype.activeCellRange = function (args) {\n        args.range = args.range;\n        var sheet = this.parent.getActiveSheet();\n        var cell = getCell(args.range[0], args.range[1], sheet);\n        if (cell) {\n            if (!isNullOrUndefined(cell.rowSpan) && cell.rowSpan < 0) {\n                args.range[0] += cell.rowSpan;\n                if (args.insertCount) {\n                    args.range[0] -= args.insertCount;\n                }\n            }\n            if (!isNullOrUndefined(cell.colSpan) && cell.colSpan < 0) {\n                args.range[1] += cell.colSpan;\n                if (args.insertCount) {\n                    args.range[1] -= args.insertCount;\n                }\n            }\n            cell = getCell(args.range[0], args.range[1], sheet);\n            if (cell) {\n                if (cell.rowSpan > 1 && (args.range[0] + (cell.rowSpan - 1) >= args.range[2] || args.insertCount)) {\n                    args.range[2] = args.range[0] + (cell.rowSpan - 1);\n                }\n                if (cell.colSpan > 1 && (args.range[1] + (cell.colSpan - 1) >= args.range[3] || args.insertCount)) {\n                    args.range[3] = args.range[1] + (cell.colSpan - 1);\n                }\n            }\n        }\n    };\n    WorkbookMerge.prototype.mergedRange = function (args) {\n        if (typeof (args.range) === 'string') {\n            args.range = getRangeIndexes(args.range);\n        }\n        if (args.range[0] <= args.range[2] && args.range[1] <= args.range[3]) {\n            this.forward(args);\n        }\n        else if (args.range[0] >= args.range[2] && args.range[1] >= args.range[3]) {\n            this.reverse(args);\n        }\n        else if (args.range[0] < args.range[2] && args.range[1] > args.range[3]) {\n            this.forwardReverse(args);\n        }\n        else if (args.range[0] > args.range[2] && args.range[1] < args.range[3]) {\n            this.reverseForward(args);\n        }\n    };\n    WorkbookMerge.prototype.forward = function (args) {\n        args.range = args.range;\n        var sheet = args.sheet || this.parent.getActiveSheet();\n        var cell = getCell(args.range[0], args.range[1], sheet);\n        var endRowIdx;\n        var endColIdx;\n        var rowIdx = endRowIdx = args.range[0];\n        var colIdx = endColIdx = args.range[1];\n        if (cell) {\n            if (!isNullOrUndefined(cell.rowSpan) && cell.rowSpan < 0) {\n                rowIdx = endRowIdx = args.range[0] + cell.rowSpan;\n            }\n            if (!isNullOrUndefined(cell.colSpan) && cell.colSpan < 0) {\n                colIdx = endColIdx = args.range[1] + cell.colSpan;\n            }\n            cell = getCell(rowIdx, colIdx, sheet);\n            if (cell) {\n                if (cell.rowSpan > 1) {\n                    endRowIdx += (cell.rowSpan - 1);\n                    if (rowIdx + (cell.rowSpan - 1) >= args.range[2]) {\n                        args.range[2] = args.range[0];\n                        args.range[2] = rowIdx + (cell.rowSpan - 1);\n                    }\n                }\n                if (cell.colSpan > 1) {\n                    endColIdx += (cell.colSpan - 1);\n                    if (colIdx + (cell.colSpan - 1) >= args.range[3]) {\n                        args.range[3] = args.range[1];\n                        args.range[3] = colIdx + (cell.colSpan - 1);\n                    }\n                }\n            }\n        }\n        args.range[0] = rowIdx;\n        args.range[1] = colIdx;\n        if (args.range[0] === rowIdx && args.range[1] === colIdx && args.range[2] === endRowIdx && args.range[3] === endColIdx) {\n            args.isActiveCell = true;\n        }\n        if (args.skipChecking) {\n            return;\n        }\n        for (var i = args.range[1]; i <= args.range[3]; i++) {\n            cell = getCell(args.range[2], i, sheet);\n            if (cell) {\n                rowIdx = args.range[2];\n                colIdx = i;\n                if (!isNullOrUndefined(cell.colSpan) && cell.colSpan < 0) {\n                    colIdx += cell.colSpan;\n                    if (colIdx < args.range[1]) {\n                        args.range[1] = colIdx;\n                    }\n                }\n                if (!isNullOrUndefined(cell.rowSpan) && cell.rowSpan < 0) {\n                    rowIdx += cell.rowSpan;\n                    if (rowIdx < args.range[0]) {\n                        args.range[0] = rowIdx;\n                    }\n                }\n                cell = getCell(rowIdx, colIdx, sheet);\n                if (cell) {\n                    if (cell.colSpan > 1 && colIdx + (cell.colSpan - 1) > args.range[3]) {\n                        args.range[3] = colIdx;\n                        args.range[3] = colIdx + (cell.colSpan - 1);\n                    }\n                    if (cell.rowSpan > 1 && rowIdx + (cell.rowSpan - 1) > args.range[2]) {\n                        args.range[2] = rowIdx;\n                        args.range[2] = rowIdx + (cell.rowSpan - 1);\n                    }\n                }\n            }\n        }\n        var startRowIdx;\n        var startColIdx;\n        for (var i = args.range[1]; i <= args.range[3]; i++) {\n            cell = getCell(args.range[0], i, sheet);\n            if (cell) {\n                startColIdx = i;\n                startRowIdx = args.range[0];\n                if (!isNullOrUndefined(cell.colSpan) && cell.colSpan < 0) {\n                    startColIdx += cell.colSpan;\n                    if (startColIdx < args.range[1]) {\n                        args.range[1] = startColIdx;\n                    }\n                }\n                if (!isNullOrUndefined(cell.rowSpan) && cell.rowSpan < 0) {\n                    startRowIdx += cell.rowSpan;\n                    if (startRowIdx < args.range[0]) {\n                        args.range[0] = startRowIdx;\n                    }\n                }\n            }\n        }\n        for (var i = args.range[0]; i <= args.range[2]; i++) {\n            cell = getCell(i, args.range[3], sheet);\n            if (cell) {\n                rowIdx = i;\n                colIdx = args.range[3];\n                if (!isNullOrUndefined(cell.rowSpan) && cell.rowSpan < 0) {\n                    rowIdx += cell.rowSpan;\n                    if (rowIdx < args.range[0]) {\n                        args.range[0] = rowIdx;\n                    }\n                }\n                if (!isNullOrUndefined(cell.colSpan) && cell.colSpan < 0) {\n                    colIdx += cell.colSpan;\n                    if (colIdx < args.range[1]) {\n                        args.range[1] = colIdx;\n                    }\n                }\n                cell = getCell(rowIdx, colIdx, sheet);\n                if (cell) {\n                    if (cell.rowSpan > 1 && rowIdx + (cell.rowSpan - 1) > args.range[2]) {\n                        args.range[2] = rowIdx;\n                        args.range[2] = rowIdx + (cell.rowSpan - 1);\n                    }\n                    if (cell.colSpan > 1 && colIdx + (cell.colSpan - 1) > args.range[3]) {\n                        args.range[3] = colIdx;\n                        args.range[3] = colIdx + (cell.colSpan - 1);\n                    }\n                }\n            }\n        }\n    };\n    WorkbookMerge.prototype.forwardReverse = function (args) {\n        var sheet = this.parent.getActiveSheet();\n        args.range = args.range;\n        var colIndex = args.range[1];\n        var cell = getCell(args.range[0], args.range[1], sheet);\n        var rowIndex = args.range[0];\n        if (cell) {\n            if (!isNullOrUndefined(cell.colSpan) && cell.colSpan < 0) {\n                colIndex += cell.colSpan;\n                if (args.range[3] >= colIndex) {\n                    args.range[3] = colIndex;\n                }\n            }\n            if (!isNullOrUndefined(cell.rowSpan) && cell.rowSpan < 0) {\n                rowIndex += cell.rowSpan;\n                if (rowIndex < args.range[0]) {\n                    args.range[0] = rowIndex;\n                }\n            }\n            cell = getCell(rowIndex, colIndex, sheet);\n            if (cell) {\n                if (cell.rowSpan > 1 && rowIndex + (cell.rowSpan - 1) >= args.range[2]) {\n                    args.range[2] = rowIndex + (cell.rowSpan - 1);\n                }\n                if (cell.colSpan > 1 && colIndex + (cell.colSpan - 1) >= args.range[1]) {\n                    args.range[1] = colIndex + (cell.colSpan - 1);\n                }\n            }\n        }\n        args.range[0] = rowIndex;\n        if (args.skipChecking) {\n            return;\n        }\n        var rowIdx;\n        var cellIdx;\n        for (var i = args.range[3]; i <= args.range[1]; i++) {\n            cell = getCell(args.range[2], i, sheet);\n            if (cell) {\n                cellIdx = i;\n                rowIdx = args.range[2];\n                if (!isNullOrUndefined(cell.rowSpan) && cell.rowSpan < 0) {\n                    rowIdx += cell.rowSpan;\n                    if (rowIdx < args.range[0]) {\n                        args.range[0] = rowIdx;\n                    }\n                }\n                if (!isNullOrUndefined(cell.colSpan) && cell.colSpan < 0) {\n                    cellIdx += cell.colSpan;\n                    if (cellIdx < args.range[3]) {\n                        args.range[3] = cellIdx;\n                    }\n                }\n                cell = getCell(rowIdx, cellIdx, sheet);\n                if (cell) {\n                    if (cell.rowSpan > 1 && rowIdx + (cell.rowSpan - 1) > args.range[2]) {\n                        args.range[2] = rowIdx + (cell.rowSpan - 1);\n                    }\n                    if (cell.colSpan > 1 && cellIdx + (cell.colSpan - 1) > args.range[1]) {\n                        args.range[1] = cellIdx + (cell.colSpan - 1);\n                    }\n                }\n            }\n        }\n        var startRowIndex;\n        for (var i = args.range[3]; i <= args.range[1]; i++) {\n            cell = getCell(args.range[0], i, sheet);\n            if (cell) {\n                cellIdx = i;\n                startRowIndex = args.range[0];\n                if (!isNullOrUndefined(cell.rowSpan) && cell.rowSpan < 0) {\n                    startRowIndex += cell.rowSpan;\n                    if (startRowIndex < args.range[0]) {\n                        args.range[0] = startRowIndex;\n                    }\n                }\n                if (!isNullOrUndefined(cell.colSpan) && cell.colSpan < 0) {\n                    cellIdx += cell.colSpan;\n                }\n                cell = getCell(startRowIndex, cellIdx, sheet);\n                if (cell) {\n                    if (cell.rowSpan > 1 && startRowIndex + (cell.rowSpan - 1) > args.range[2]) {\n                        args.range[2] = startRowIndex + (cell.rowSpan - 1);\n                    }\n                    if (cell.colSpan > 1 && cellIdx + (cell.colSpan - 1) > args.range[1]) {\n                        args.range[1] = cellIdx;\n                        args.range[1] = cellIdx + (cell.colSpan - 1);\n                    }\n                }\n            }\n        }\n        var colIdx;\n        for (var i = args.range[0]; i <= args.range[2]; i++) {\n            cell = getCell(i, args.range[3], sheet);\n            if (cell) {\n                startRowIndex = i;\n                colIdx = args.range[3];\n                if (!isNullOrUndefined(cell.rowSpan) && cell.rowSpan < 0) {\n                    startRowIndex += cell.rowSpan;\n                    if (startRowIndex < args.range[0]) {\n                        args.range[0] = startRowIndex;\n                    }\n                }\n                if (!isNullOrUndefined(cell.colSpan) && cell.colSpan < 0) {\n                    colIdx += cell.colSpan;\n                    if (colIdx < args.range[3]) {\n                        args.range[3] = colIdx;\n                    }\n                }\n                cell = getCell(startRowIndex, colIdx, sheet);\n                if (cell) {\n                    if (cell.rowSpan > 1 && startRowIndex + (cell.rowSpan - 1) > args.range[2]) {\n                        args.range[2] = startRowIndex;\n                        args.range[2] = startRowIndex + (cell.rowSpan - 1);\n                    }\n                    if (cell.colSpan > 1 && colIdx + (cell.colSpan - 1) > args.range[1]) {\n                        args.range[1] = colIdx;\n                        args.range[1] = colIdx + (cell.colSpan - 1);\n                    }\n                }\n            }\n        }\n    };\n    WorkbookMerge.prototype.reverse = function (args) {\n        args.range = args.range;\n        var colnIdx = args.range[1];\n        var sheet = args.sheet || this.parent.getActiveSheet();\n        var cell = getCell(args.range[0], args.range[1], sheet);\n        var rowIdx = args.range[0];\n        if (cell) {\n            if (!isNullOrUndefined(cell.colSpan) && cell.colSpan < 0) {\n                colnIdx += cell.colSpan;\n            }\n            if (!isNullOrUndefined(cell.rowSpan) && cell.rowSpan < 0) {\n                rowIdx += cell.rowSpan;\n            }\n            if (args.range[2] >= rowIdx) {\n                args.range[2] = rowIdx;\n                args.isActiveCell = true;\n            }\n            if (args.range[3] >= colnIdx) {\n                args.range[3] = colnIdx;\n                if (args.range[2] === rowIdx) {\n                    args.isActiveCell = true;\n                }\n            }\n            else if (args.isActiveCell) {\n                args.isActiveCell = false;\n            }\n            cell = getCell(rowIdx, colnIdx, sheet);\n            if (cell) {\n                if (cell.rowSpan > 1 && rowIdx + (cell.rowSpan - 1) >= args.range[0]) {\n                    args.range[0] = rowIdx;\n                    args.range[0] = rowIdx + (cell.rowSpan - 1);\n                }\n                if (cell.colSpan > 1 && colnIdx + (cell.colSpan - 1) >= args.range[1]) {\n                    args.range[1] = colnIdx;\n                    args.range[1] = colnIdx + (cell.colSpan - 1);\n                }\n            }\n        }\n        var colIdx = args.range[3];\n        if (args.skipChecking) {\n            return;\n        }\n        for (var i = args.range[3]; i <= args.range[1]; i++) {\n            cell = getCell(args.range[2], i, sheet);\n            if (cell) {\n                colIdx = i;\n                rowIdx = args.range[2];\n                if (!isNullOrUndefined(cell.rowSpan) && cell.rowSpan < 0) {\n                    rowIdx += cell.rowSpan;\n                    if (rowIdx < args.range[2]) {\n                        args.range[2] = rowIdx;\n                    }\n                }\n                if (!isNullOrUndefined(cell.colSpan) && cell.colSpan < 0) {\n                    colIdx += cell.colSpan;\n                    if (colIdx < args.range[3]) {\n                        args.range[3] = colIdx;\n                    }\n                }\n                cell = getCell(rowIdx, colIdx, sheet);\n                if (cell) {\n                    if (cell.rowSpan > 1 && rowIdx + (cell.rowSpan - 1) > args.range[0]) {\n                        args.range[0] = rowIdx;\n                        args.range[0] = rowIdx + (cell.rowSpan - 1);\n                    }\n                    if (cell.colSpan > 1 && colIdx + (cell.colSpan - 1) > args.range[1]) {\n                        args.range[1] = colIdx;\n                        args.range[1] = colIdx + (cell.colSpan - 1);\n                    }\n                }\n            }\n        }\n        colIdx = args.range[3];\n        for (var i = args.range[3]; i <= args.range[1]; i++) {\n            cell = getCell(args.range[0], i, sheet);\n            if (cell) {\n                colIdx = i;\n                rowIdx = args.range[0];\n                if (!isNullOrUndefined(cell.colSpan) && cell.colSpan < 0) {\n                    colIdx += cell.colSpan;\n                }\n                if (!isNullOrUndefined(cell.rowSpan) && cell.rowSpan < 0) {\n                    rowIdx += cell.rowSpan;\n                }\n                cell = getCell(rowIdx, colIdx, sheet);\n                if (cell) {\n                    if (cell.colSpan > 1 && colIdx + (cell.colSpan - 1) > args.range[1]) {\n                        args.range[1] = colIdx;\n                        args.range[1] = colIdx + (cell.colSpan - 1);\n                    }\n                    if (cell.rowSpan > 1 && rowIdx + (cell.rowSpan - 1) > args.range[0]) {\n                        args.range[0] = rowIdx;\n                        args.range[0] = rowIdx + (cell.rowSpan - 1);\n                    }\n                }\n            }\n        }\n        var cellIndex;\n        var rIdx;\n        for (var i = args.range[2]; i <= args.range[0]; i++) {\n            cell = getCell(i, args.range[3], sheet);\n            if (cell) {\n                rIdx = i;\n                cellIndex = args.range[3];\n                if (!isNullOrUndefined(cell.rowSpan) && cell.rowSpan < 0) {\n                    rIdx += cell.rowSpan;\n                    if (rIdx < args.range[2]) {\n                        args.range[2] = rIdx;\n                    }\n                }\n                if (!isNullOrUndefined(cell.colSpan) && cell.colSpan < 0) {\n                    cellIndex += cell.colSpan;\n                    if (cellIndex < args.range[3]) {\n                        args.range[3] = cellIndex;\n                    }\n                }\n                cell = getCell(rIdx, cellIndex, sheet);\n                if (cell) {\n                    if (cell.rowSpan > 1 && rIdx + (cell.rowSpan - 1) > args.range[0]) {\n                        args.range[0] = rIdx;\n                        args.range[0] = rIdx + (cell.rowSpan - 1);\n                    }\n                    if (cell.colSpan > 1 && cellIndex + (cell.colSpan - 1) > args.range[1]) {\n                        args.range[1] = cellIndex;\n                        args.range[1] = cellIndex + (cell.colSpan - 1);\n                    }\n                }\n            }\n        }\n    };\n    WorkbookMerge.prototype.reverseForward = function (args) {\n        args.range = args.range;\n        var sheet = args.sheet || this.parent.getActiveSheet();\n        var rIdx = args.range[0];\n        var cIdx = args.range[1];\n        var cell = getCell(args.range[0], args.range[1], sheet);\n        if (cell) {\n            if (!isNullOrUndefined(cell.rowSpan) && cell.rowSpan < 0) {\n                rIdx += cell.rowSpan;\n                if (args.range[2] >= rIdx) {\n                    args.range[2] = rIdx;\n                }\n            }\n            if (!isNullOrUndefined(cell.colSpan) && cell.colSpan < 0) {\n                cIdx += cell.colSpan;\n            }\n            cell = getCell(rIdx, cIdx, sheet);\n            if (cell) {\n                if (cell.rowSpan > 1 && rIdx + (cell.rowSpan - 1) >= args.range[0]) {\n                    args.range[0] = rIdx;\n                    args.range[0] = rIdx + (cell.rowSpan - 1);\n                }\n                if (cell.colSpan > 1 && cIdx + (cell.colSpan - 1) >= args.range[3]) {\n                    args.range[3] = args.range[1];\n                    args.range[3] = cIdx + (cell.colSpan - 1);\n                }\n            }\n        }\n        if (args.skipChecking) {\n            return;\n        }\n        var cIndex = args.range[3];\n        var rIndex;\n        for (var i = args.range[1]; i <= args.range[3]; i++) {\n            cell = getCell(args.range[2], i, sheet);\n            if (cell) {\n                rIndex = args.range[2];\n                cIndex = i;\n                if (!isNullOrUndefined(cell.rowSpan) && cell.rowSpan < 0) {\n                    rIndex += cell.rowSpan;\n                    if (rIndex < args.range[2]) {\n                        args.range[2] = rIndex;\n                    }\n                }\n                if (!isNullOrUndefined(cell.colSpan) && cell.colSpan < 0) {\n                    cIndex += cell.colSpan;\n                    if (cIndex < args.range[1]) {\n                        args.range[1] = cIndex;\n                    }\n                }\n                cell = getCell(rIndex, cIndex, sheet);\n                if (cell) {\n                    if (cell.colSpan > 1 && cIndex + (cell.colSpan - 1) > args.range[3]) {\n                        args.range[3] = cIndex + (cell.colSpan - 1);\n                    }\n                    if (cell.rowSpan > 1 && (cell.rowSpan - 1) + rIndex > args.range[0]) {\n                        args.range[0] = (cell.rowSpan - 1) + rIndex;\n                    }\n                }\n            }\n        }\n        var sRowIdx;\n        var sColIdx;\n        for (var i = args.range[1]; i <= args.range[3]; i++) {\n            cell = getCell(args.range[0], i, sheet);\n            if (cell) {\n                sColIdx = i;\n                sRowIdx = args.range[0];\n                if (!isNullOrUndefined(cell.colSpan) && cell.colSpan < 0) {\n                    sColIdx += cell.colSpan;\n                    if (sColIdx < args.range[1]) {\n                        args.range[1] = sColIdx;\n                    }\n                }\n                if (!isNullOrUndefined(cell.rowSpan) && cell.rowSpan < 0) {\n                    sRowIdx += cell.rowSpan;\n                }\n                cell = getCell(sRowIdx, sColIdx, sheet);\n                if (cell) {\n                    if (cell.rowSpan > 1 && sRowIdx + (cell.rowSpan - 1) > args.range[0]) {\n                        args.range[0] = sRowIdx + (cell.rowSpan - 1);\n                    }\n                }\n            }\n        }\n        var cellIndex;\n        for (var i = args.range[2]; i <= args.range[0]; i++) {\n            cell = getCell(i, args.range[3], sheet);\n            if (cell) {\n                rIndex = i;\n                cellIndex = args.range[3];\n                if (!isNullOrUndefined(cell.rowSpan) && cell.rowSpan < 0) {\n                    rIndex += cell.rowSpan;\n                    if (rIndex < args.range[2]) {\n                        args.range[2] = rIndex;\n                    }\n                }\n                if (!isNullOrUndefined(cell.colSpan) && cell.colSpan < 0) {\n                    cellIndex += cell.colSpan;\n                    if (cellIndex < args.range[1]) {\n                        args.range[1] = cellIndex;\n                    }\n                }\n                cell = getCell(rIndex, cellIndex, sheet);\n                if (cell) {\n                    if (cell.rowSpan > 1 && (cell.rowSpan - 1) + rIndex > args.range[0]) {\n                        args.range[0] = (cell.rowSpan - 1) + rIndex;\n                    }\n                    if (cell.colSpan > 1 && (cell.colSpan - 1) + cellIndex > args.range[3]) {\n                        args.range[3] = cellIndex;\n                        args.range[3] = (cell.colSpan - 1) + cellIndex;\n                    }\n                }\n            }\n        }\n    };\n    WorkbookMerge.prototype.insertHandler = function (args) {\n        this.activeCellRange(args);\n        args.range = args.range;\n        if (args.insertModel === 'Row') {\n            args.range[2] += args.insertCount;\n        }\n        else {\n            args.range[3] += args.insertCount;\n        }\n        args.preventRefresh = true;\n        args.merge = true;\n        this.mergeAll(args);\n    };\n    WorkbookMerge.prototype.pasteHandler = function (args) {\n        var sheet = this.parent.getActiveSheet();\n        var cell;\n        var nextCell;\n        var prevCell;\n        var activeCell = getCellIndexes(sheet.activeCell);\n        for (var i = args.range[0], l = 0; i <= args.range[2]; i++, l++) {\n            for (var j = args.range[1], k = 0; j <= args.range[3]; j++, k++) {\n                cell = getCell(i, j, args.prevSheet) || {};\n                if (cell.rowSpan > 1) {\n                    prevCell = getCell(activeCell[0] + (cell.rowSpan - 1), activeCell[1], sheet) || {};\n                    nextCell = getCell(activeCell[0] + 1, activeCell[1], sheet) || {};\n                    if ((prevCell.colSpan !== undefined && prevCell.colSpan < 0) || (nextCell.colSpan !== undefined &&\n                        nextCell.colSpan < 0)) {\n                        args.cancel = true;\n                        this.parent.notify(applyMerge, { showDialog: true });\n                        return;\n                    }\n                }\n                if (cell.colSpan > 1) {\n                    prevCell = getCell(activeCell[0], activeCell[1] + (cell.colSpan - 1), sheet) || {};\n                    nextCell = getCell(activeCell[0], activeCell[1] + 1, sheet) || {};\n                    if ((prevCell.rowSpan !== undefined && prevCell.rowSpan < 0) || (nextCell.rowSpan !== undefined &&\n                        nextCell.rowSpan < 0)) {\n                        args.cancel = true;\n                        this.parent.notify(applyMerge, { showDialog: true });\n                        return;\n                    }\n                }\n            }\n        }\n    };\n    WorkbookMerge.prototype.addEventListener = function () {\n        this.parent.on(setMerge, this.merge, this);\n        this.parent.on(mergedRange, this.mergedRange, this);\n        this.parent.on(activeCellMergedRange, this.activeCellRange, this);\n        this.parent.on(insertMerge, this.insertHandler, this);\n        this.parent.on(pasteMerge, this.pasteHandler, this);\n    };\n    /**\n     * Destroy workbook merge module.\n     */\n    WorkbookMerge.prototype.destroy = function () {\n        this.removeEventListener();\n        this.parent = null;\n    };\n    WorkbookMerge.prototype.removeEventListener = function () {\n        if (!this.parent.isDestroyed) {\n            this.parent.off(setMerge, this.merge);\n            this.parent.off(mergedRange, this.mergedRange);\n            this.parent.off(activeCellMergedRange, this.activeCellRange);\n            this.parent.off(insertMerge, this.insertHandler);\n            this.parent.off(pasteMerge, this.pasteHandler);\n        }\n    };\n    /**\n     * Get the workbook merge module name.\n     */\n    WorkbookMerge.prototype.getModuleName = function () {\n        return 'workbookmerge';\n    };\n    return WorkbookMerge;\n}());\nexport { WorkbookMerge };\n","import { setCell, setRow, getSheet } from '../base/index';\nimport { setCFRule, clearCFRule, getRangeAddress, applyCellFormat } from '../common/index';\nimport { getRangeIndexes } from '../common/index';\nimport { cFInitialCheck, clearCF } from '../common/index';\nimport { completeAction } from '../../spreadsheet/common/event';\nimport { isNullOrUndefined } from '@syncfusion/ej2-base';\n/**\n * The `WorkbookConditionalFormat` module is used to handle conditional formatting action in Spreadsheet.\n */\nvar WorkbookConditionalFormat = /** @class */ (function () {\n    /**\n     * Constructor for WorkbookConditionalFormat module.\n     */\n    function WorkbookConditionalFormat(parent) {\n        this.parent = parent;\n        this.addEventListener();\n    }\n    /**\n     * To destroy the conditional format module.\n     */\n    WorkbookConditionalFormat.prototype.destroy = function () {\n        this.removeEventListener();\n        this.parent = null;\n    };\n    WorkbookConditionalFormat.prototype.addEventListener = function () {\n        this.parent.on(setCFRule, this.setCFrulHandler, this);\n        this.parent.on(clearCFRule, this.clearRules, this);\n    };\n    WorkbookConditionalFormat.prototype.removeEventListener = function () {\n        if (!this.parent.isDestroyed) {\n            this.parent.off(setCFRule, this.setCFrulHandler);\n            this.parent.off(clearCFRule, this.clearRules);\n        }\n    };\n    WorkbookConditionalFormat.prototype.setCFrulHandler = function (args) {\n        var conditionalFormat = args.conditionalFormat;\n        var range = conditionalFormat.range;\n        var sheetIndex = this.parent.getAddressInfo(range).sheetIndex;\n        var sheet = getSheet(this.parent, sheetIndex);\n        range = range || sheet.selectedRange;\n        conditionalFormat.range = range;\n        var indexes = getRangeIndexes(range);\n        var cfrCount;\n        if (!sheet.conditionalFormats) {\n            this.parent.setSheetPropertyOnMute(sheet, 'conditionalFormats', []);\n        }\n        cfrCount = sheet.conditionalFormats.length;\n        sheet.conditionalFormats[cfrCount] = conditionalFormat;\n        for (var rIdx = indexes[0]; rIdx <= indexes[2]; rIdx++) {\n            if (!sheet.rows[rIdx]) {\n                setRow(sheet, rIdx, {});\n            }\n            for (var cIdx = indexes[1]; cIdx <= indexes[3]; cIdx++) {\n                if (!sheet.rows[rIdx].cells || !sheet.rows[rIdx].cells[cIdx]) {\n                    setCell(rIdx, cIdx, sheet, {});\n                }\n                if (sheetIndex === this.parent.activeSheetIndex) {\n                    var cell = sheet.rows[rIdx].cells[cIdx];\n                    this.parent.notify(cFInitialCheck, { rowIdx: rIdx, colIdx: cIdx, cell: cell, conditionalFormat: conditionalFormat });\n                }\n            }\n        }\n    };\n    // tslint:disable-next-line:max-func-body-length\n    WorkbookConditionalFormat.prototype.clearRules = function (args) {\n        var isPublic = isNullOrUndefined(args.isPublic) ? true : false;\n        var cFormats = [];\n        var oldRange = [];\n        var isFirst = true;\n        var top;\n        var bottom;\n        var left;\n        var right;\n        var frontColIdx;\n        var backColIdx;\n        var topRowIdx;\n        var bottomRowIdx;\n        var range = args.range;\n        var sheetIndex = this.parent.getAddressInfo(range).sheetIndex;\n        var sheet = getSheet(this.parent, sheetIndex);\n        var cFRules = sheet.conditionalFormats;\n        var rangeIndexes = getRangeIndexes(range);\n        if (sheetIndex === this.parent.activeSheetIndex) {\n            for (var rIdx = rangeIndexes[0]; rIdx <= rangeIndexes[2]; rIdx++) {\n                for (var cIdx = rangeIndexes[1]; cIdx <= rangeIndexes[3]; cIdx++) {\n                    this.parent.notify(clearCF, { rIdx: rIdx, cIdx: cIdx });\n                }\n            }\n        }\n        if (!cFRules) {\n            return;\n        }\n        for (var cFRulesIdx = cFRules.length - 1; cFRulesIdx >= 0; cFRulesIdx--) {\n            var isPresent = false;\n            var result = '';\n            var cFRule = cFRules[cFRulesIdx];\n            var cFRanges = cFRule.range.split(',');\n            if (sheetIndex === this.parent.activeSheetIndex) {\n                for (var cFRangeIdx = 0; cFRangeIdx < cFRanges.length; cFRangeIdx++) {\n                    var isFull = false;\n                    var cFRange = cFRanges[cFRangeIdx];\n                    var cFRangeIndexes = getRangeIndexes(cFRange);\n                    topRowIdx = cFRangeIndexes[0];\n                    bottomRowIdx = cFRangeIndexes[0];\n                    frontColIdx = cFRangeIndexes[1];\n                    backColIdx = cFRangeIndexes[1];\n                    if (cFRangeIndexes[0] >= rangeIndexes[0] && cFRangeIndexes[2] <= rangeIndexes[2] &&\n                        cFRangeIndexes[1] >= rangeIndexes[1] && cFRangeIndexes[3] <= rangeIndexes[3]) {\n                        isFull = true;\n                    }\n                    for (var cFRRowIdx = cFRangeIndexes[0]; cFRRowIdx <= cFRangeIndexes[2]; cFRRowIdx++) {\n                        var isTrue = 0;\n                        for (var cFRColIdx = cFRangeIndexes[1]; cFRColIdx <= cFRangeIndexes[3]; cFRColIdx++) {\n                            for (var rRowIdx = rangeIndexes[0]; rRowIdx <= rangeIndexes[2]; rRowIdx++) {\n                                for (var rColIdx = rangeIndexes[1]; rColIdx <= rangeIndexes[3]; rColIdx++) {\n                                    if (rRowIdx === cFRRowIdx && rColIdx === cFRColIdx) {\n                                        var style = this.parent.getCellStyleValue(['backgroundColor', 'color'], [rRowIdx, rColIdx]);\n                                        this.parent.notify(applyCellFormat, {\n                                            style: style, rowIdx: rRowIdx, colIdx: rColIdx,\n                                            lastCell: true, isHeightCheckNeeded: true, manualUpdate: true\n                                        });\n                                        isTrue = isTrue + 1;\n                                        isPresent = true;\n                                        if (rRowIdx === cFRangeIndexes[0]) {\n                                            if (rColIdx === cFRangeIndexes[3]) {\n                                                if (frontColIdx === cFRangeIndexes[1]) {\n                                                    if (backColIdx === rColIdx) {\n                                                        backColIdx = rColIdx;\n                                                    }\n                                                    else {\n                                                        frontColIdx = rColIdx - 1;\n                                                    }\n                                                }\n                                                else if (frontColIdx !== cFRangeIndexes[1] && backColIdx + 1 === rColIdx) {\n                                                    backColIdx = cFRangeIndexes[1];\n                                                    frontColIdx = frontColIdx - 1;\n                                                }\n                                                else if (frontColIdx !== cFRangeIndexes[1] && backColIdx === cFRangeIndexes[1]) {\n                                                    frontColIdx = rangeIndexes[1] - 1;\n                                                }\n                                            }\n                                            else if (rColIdx === cFRangeIndexes[1]) {\n                                                if (backColIdx === cFRangeIndexes[1]) {\n                                                    backColIdx = rColIdx + 1;\n                                                }\n                                            }\n                                            else {\n                                                if (frontColIdx === cFRangeIndexes[1] && backColIdx === cFRangeIndexes[1]) {\n                                                    frontColIdx = rColIdx;\n                                                    backColIdx = rColIdx;\n                                                }\n                                                else if (frontColIdx === cFRangeIndexes[1] && backColIdx !== cFRangeIndexes[1]) {\n                                                    backColIdx = rColIdx + 1;\n                                                }\n                                                else {\n                                                    backColIdx = rColIdx;\n                                                }\n                                            }\n                                        }\n                                        else {\n                                            if (rColIdx === cFRangeIndexes[1]) {\n                                                if (backColIdx === cFRangeIndexes[1] && cFRangeIndexes[1] !== cFRangeIndexes[3]) {\n                                                    backColIdx = rColIdx + 1;\n                                                }\n                                            }\n                                            else if (rColIdx === cFRangeIndexes[3]) {\n                                                if (frontColIdx === cFRangeIndexes[1]) {\n                                                    if (backColIdx === rColIdx) {\n                                                        backColIdx = rColIdx;\n                                                    }\n                                                    else {\n                                                        frontColIdx = rColIdx - 1;\n                                                    }\n                                                }\n                                                else if (frontColIdx !== cFRangeIndexes[1] && backColIdx === cFRangeIndexes[1]) {\n                                                    frontColIdx = rangeIndexes[1] - 1;\n                                                }\n                                                else if (frontColIdx !== cFRangeIndexes[1] && backColIdx + 1 === rColIdx) {\n                                                    backColIdx = cFRangeIndexes[1];\n                                                    frontColIdx = rangeIndexes[1] - 1;\n                                                }\n                                                else {\n                                                    bottomRowIdx = rRowIdx;\n                                                }\n                                            }\n                                            else {\n                                                if (frontColIdx === cFRangeIndexes[1] && backColIdx === cFRangeIndexes[1]) {\n                                                    frontColIdx = rColIdx;\n                                                    backColIdx = rColIdx;\n                                                }\n                                                else if (backColIdx !== cFRangeIndexes[1] && frontColIdx !== cFRangeIndexes[1]) {\n                                                    backColIdx = rColIdx;\n                                                }\n                                                else if (frontColIdx !== cFRangeIndexes[1] && backColIdx === cFRangeIndexes[1]) {\n                                                    frontColIdx = rColIdx;\n                                                }\n                                                else {\n                                                    backColIdx = rColIdx + 1;\n                                                }\n                                            }\n                                        }\n                                    }\n                                }\n                            }\n                        }\n                        if (isTrue > 0 && !isFull) {\n                            if (isFirst) {\n                                top = topRowIdx;\n                                bottom = bottomRowIdx;\n                                left = frontColIdx;\n                                right = backColIdx;\n                            }\n                            if (frontColIdx === cFRangeIndexes[1] && backColIdx !== cFRangeIndexes[1]) {\n                                if (backColIdx === cFRangeIndexes[3]) {\n                                    if (topRowIdx !== cFRRowIdx) {\n                                        result = result + ' ' + getRangeAddress([topRowIdx, left, bottom, cFRangeIndexes[3]]);\n                                    }\n                                    if (frontColIdx === cFRangeIndexes[1] && backColIdx === cFRangeIndexes[3]) {\n                                        if (cFRRowIdx === cFRangeIndexes[2]) {\n                                            if (cFRangeIndexes[1] === rangeIndexes[3]) {\n                                                result = result + ' ' + getRangeAddress([cFRRowIdx, backColIdx, cFRRowIdx, cFRangeIndexes[3]]);\n                                            }\n                                        }\n                                        else {\n                                            if (rangeIndexes[2] === cFRangeIndexes[0] && backColIdx !== cFRangeIndexes[3]) {\n                                                result = result + ' ' + getRangeAddress([cFRRowIdx, backColIdx, cFRRowIdx, cFRangeIndexes[3]]);\n                                            }\n                                            topRowIdx = cFRRowIdx + 1;\n                                            bottomRowIdx = cFRRowIdx + 1;\n                                            backColIdx = cFRangeIndexes[1];\n                                        }\n                                    }\n                                }\n                                else if (right !== backColIdx) {\n                                    result = result + ' ' + getRangeAddress([topRowIdx, right, cFRRowIdx - 1, cFRangeIndexes[3]]);\n                                    if (backColIdx === cFRangeIndexes[3] && frontColIdx === cFRangeIndexes[1]) {\n                                        topRowIdx = cFRRowIdx + 1;\n                                        bottomRowIdx = cFRRowIdx + 1;\n                                        backColIdx = cFRangeIndexes[1];\n                                    }\n                                    else {\n                                        topRowIdx = cFRRowIdx;\n                                        bottomRowIdx = cFRRowIdx;\n                                    }\n                                    if (backColIdx === cFRangeIndexes[3] && frontColIdx !== cFRangeIndexes[1]) {\n                                        frontColIdx = cFRangeIndexes[1];\n                                    }\n                                }\n                                else if (left !== frontColIdx) {\n                                    result = result + ' ' + getRangeAddress([topRowIdx, cFRangeIndexes[1], cFRRowIdx - 1, left]);\n                                    topRowIdx = cFRRowIdx + 1;\n                                    bottomRowIdx = cFRRowIdx + 1;\n                                    frontColIdx = cFRangeIndexes[1];\n                                    backColIdx = cFRangeIndexes[1];\n                                }\n                                else if (cFRRowIdx === cFRangeIndexes[2]) {\n                                    result = result + ' ' + getRangeAddress([topRowIdx, backColIdx, cFRRowIdx, cFRangeIndexes[3]]);\n                                }\n                                else {\n                                    if (bottomRowIdx < cFRRowIdx || (frontColIdx === cFRangeIndexes[1] && backColIdx === cFRangeIndexes[3])) {\n                                        bottomRowIdx = cFRRowIdx;\n                                    }\n                                }\n                            }\n                            else if (backColIdx === cFRangeIndexes[1] && frontColIdx !== cFRangeIndexes[1]) {\n                                if (right !== backColIdx) {\n                                    result = result + ' ' + getRangeAddress([topRowIdx, right, cFRRowIdx - 1, cFRangeIndexes[3]]);\n                                    topRowIdx = cFRRowIdx;\n                                    bottomRowIdx = cFRRowIdx;\n                                }\n                                if (left !== frontColIdx) {\n                                    result = result + ' ' + getRangeAddress([topRowIdx, left, cFRRowIdx - 1, cFRangeIndexes[3]]);\n                                    topRowIdx = cFRRowIdx;\n                                    bottomRowIdx = cFRRowIdx;\n                                }\n                                if (cFRRowIdx === cFRangeIndexes[2]) {\n                                    result = result + ' ' + getRangeAddress([topRowIdx, backColIdx, cFRRowIdx, frontColIdx]);\n                                }\n                                else {\n                                    bottomRowIdx = cFRRowIdx;\n                                }\n                            }\n                            else if (backColIdx !== cFRangeIndexes[1] && frontColIdx !== cFRangeIndexes[1]) {\n                                if (cFRRowIdx === cFRangeIndexes[2] && cFRangeIndexes[2] === rangeIndexes[0]) {\n                                    if (cFRangeIndexes[0] === cFRangeIndexes[2]) {\n                                        result = result + ' ' + getRangeAddress([topRowIdx, cFRangeIndexes[1], bottomRowIdx, frontColIdx - 1]);\n                                        result = result + ' ' +\n                                            getRangeAddress([topRowIdx, backColIdx + 1, bottomRowIdx, cFRangeIndexes[3]]);\n                                    }\n                                    else {\n                                        result =\n                                            result + ' ' + getRangeAddress([topRowIdx, cFRangeIndexes[1], bottomRowIdx, cFRangeIndexes[3]]);\n                                        result = result + ' ' +\n                                            getRangeAddress([cFRangeIndexes[2], cFRangeIndexes[1], cFRangeIndexes[2], frontColIdx - 1]);\n                                        result = result + ' ' +\n                                            getRangeAddress([cFRangeIndexes[2], backColIdx + 1, cFRangeIndexes[2], cFRangeIndexes[3]]);\n                                    }\n                                }\n                                else if (cFRRowIdx === cFRangeIndexes[2]) {\n                                    result = result + ' ' + getRangeAddress([topRowIdx, cFRangeIndexes[1], cFRRowIdx, frontColIdx - 1]);\n                                    result = result + ' ' + getRangeAddress([topRowIdx, backColIdx + 1, cFRRowIdx, cFRangeIndexes[3]]);\n                                }\n                                else {\n                                    if (left === cFRangeIndexes[1] && right === cFRangeIndexes[1]) {\n                                        result = result + ' ' + getRangeAddress([topRowIdx, left, bottomRowIdx, cFRangeIndexes[3]]);\n                                        topRowIdx = cFRRowIdx;\n                                    }\n                                    bottomRowIdx = cFRRowIdx;\n                                }\n                            }\n                            else if (frontColIdx === cFRangeIndexes[1] && backColIdx === cFRangeIndexes[1]) {\n                                if (rangeIndexes[2] !== cFRangeIndexes[0]) {\n                                    if (cFRangeIndexes[2] >= rangeIndexes[2] && cFRRowIdx > rangeIndexes[2]) {\n                                        result = result + ' ' + getRangeAddress([topRowIdx, frontColIdx, bottomRowIdx, cFRangeIndexes[3]]);\n                                    }\n                                    if (cFRangeIndexes[1] === cFRangeIndexes[3] &&\n                                        cFRRowIdx <= cFRangeIndexes[2] && top !== cFRangeIndexes[2] && cFRRowIdx !== top) {\n                                        result = result + ' ' + getRangeAddress([topRowIdx, frontColIdx, bottomRowIdx, cFRangeIndexes[3]]);\n                                    }\n                                    if (cFRangeIndexes[1] === cFRangeIndexes[3]) {\n                                        topRowIdx = cFRRowIdx + 1;\n                                        bottomRowIdx = cFRRowIdx + 1;\n                                    }\n                                }\n                                else {\n                                    if (cFRRowIdx === cFRangeIndexes[2] || cFRRowIdx === cFRangeIndexes[0] &&\n                                        cFRangeIndexes[1] !== cFRangeIndexes[3]) {\n                                        result = result + ' ' + getRangeAddress([topRowIdx, frontColIdx, bottomRowIdx, backColIdx]);\n                                    }\n                                    topRowIdx = cFRRowIdx + 1;\n                                    bottomRowIdx = cFRRowIdx + 1;\n                                }\n                                if (cFRRowIdx === cFRangeIndexes[2] && cFRangeIndexes[0] !== cFRangeIndexes[2] &&\n                                    cFRangeIndexes[1] !== cFRangeIndexes[3]) {\n                                    result = result + ' ' + getRangeAddress([cFRRowIdx, frontColIdx, cFRRowIdx, backColIdx]);\n                                }\n                            }\n                            if (!isFirst) {\n                                top = topRowIdx;\n                                bottom = bottomRowIdx <= cFRangeIndexes[2] ? bottomRowIdx : cFRangeIndexes[2];\n                                left = frontColIdx;\n                                right = backColIdx <= cFRangeIndexes[3] ? backColIdx : cFRangeIndexes[3];\n                            }\n                            isFirst = false;\n                        }\n                        else if (!isFull) {\n                            if (isFirst) {\n                                top = topRowIdx;\n                                bottom = bottomRowIdx;\n                                left = frontColIdx;\n                                right = backColIdx;\n                            }\n                            if (frontColIdx === cFRangeIndexes[1] && backColIdx === cFRangeIndexes[1]) {\n                                if (cFRRowIdx === cFRangeIndexes[2]) {\n                                    result = result + ' ' + getRangeAddress([topRowIdx, frontColIdx, cFRRowIdx, cFRangeIndexes[3]]);\n                                }\n                                bottomRowIdx = cFRRowIdx;\n                            }\n                            if (backColIdx !== cFRangeIndexes[1] && frontColIdx !== cFRangeIndexes[1]) {\n                                result = result + ' ' + getRangeAddress([topRowIdx, cFRangeIndexes[1], (cFRRowIdx - 1), frontColIdx - 1]);\n                                result = result + ' ' + getRangeAddress([topRowIdx, backColIdx + 1, (cFRRowIdx - 1), cFRangeIndexes[3]]);\n                                topRowIdx = cFRRowIdx;\n                                bottomRowIdx = cFRRowIdx;\n                                frontColIdx = cFRangeIndexes[1];\n                                backColIdx = cFRangeIndexes[1];\n                            }\n                            if (backColIdx !== cFRangeIndexes[1] && frontColIdx === cFRangeIndexes[1]) {\n                                result = result + ' ' + getRangeAddress([topRowIdx, backColIdx, (cFRRowIdx - 1), cFRangeIndexes[3]]);\n                                topRowIdx = cFRRowIdx;\n                                bottomRowIdx = cFRRowIdx;\n                                frontColIdx = cFRangeIndexes[1];\n                                backColIdx = cFRangeIndexes[1];\n                            }\n                            if (frontColIdx !== cFRangeIndexes[1] && backColIdx === cFRangeIndexes[1]) {\n                                result = result + ' ' + getRangeAddress([topRowIdx, backColIdx, (cFRRowIdx - 1), frontColIdx]);\n                                topRowIdx = cFRRowIdx;\n                                bottomRowIdx = cFRRowIdx;\n                                frontColIdx = cFRangeIndexes[1];\n                                backColIdx = cFRangeIndexes[1];\n                            }\n                            if (!isFirst) {\n                                top = topRowIdx;\n                                bottom = bottomRowIdx <= cFRangeIndexes[2] ? bottomRowIdx : cFRangeIndexes[2];\n                                left = frontColIdx;\n                                right = backColIdx <= cFRangeIndexes[3] ? backColIdx : cFRangeIndexes[3];\n                            }\n                            isFirst = false;\n                        }\n                    }\n                }\n            }\n            if (result === '') {\n                oldRange.push(sheet.conditionalFormats[cFRulesIdx].range);\n                sheet.conditionalFormats.splice(cFRulesIdx, 1);\n            }\n            else {\n                oldRange.push(sheet.conditionalFormats[cFRulesIdx].range);\n                sheet.conditionalFormats[cFRulesIdx].range = result.trim().replace(' ', ',');\n            }\n            if (isPresent && !isPublic) {\n                cFRule.range = result.trim().replace(' ', ',');\n                cFormats.push(cFRule);\n            }\n        }\n        if (!isPublic) {\n            var eventArgs = { cFormats: cFormats, oldRange: oldRange, selectedRange: range };\n            this.parent.notify(completeAction, { eventArgs: eventArgs, action: 'clearCF' });\n        }\n    };\n    /**\n     * Gets the module name.\n     * @returns string\n     */\n    WorkbookConditionalFormat.prototype.getModuleName = function () {\n        return 'workbookConditionalFormatting';\n    };\n    return WorkbookConditionalFormat;\n}());\nexport { WorkbookConditionalFormat };\n","import { Workbook, DataBind } from '../index';\nimport { WorkbookSave, WorkbookFormula, WorkbookOpen, WorkbookSort, WorkbookFilter, WorkbookImage } from '../integrations/index';\nimport { WorkbookNumberFormat } from '../integrations/number-format';\nimport { WorkbookEdit, WorkbookCellFormat, WorkbookHyperlink, WorkbookInsert, WorkbookDelete } from '../actions/index';\nimport { WorkbookFindAndReplace, WorkbookProtectSheet, WorkbookDataValidation, WorkbookMerge } from '../actions/index';\nimport { WorkbookConditionalFormat } from '../actions/conditional-formatting';\nimport { WorkbookChart } from '../integrations/index';\n/**\n * Workbook basic module.\n * @private\n */\nvar WorkbookBasicModule = /** @class */ (function () {\n    /**\n     * Constructor for Workbook basic module.\n     * @private\n     */\n    function WorkbookBasicModule() {\n        Workbook.Inject(DataBind, WorkbookSave, WorkbookOpen, WorkbookNumberFormat, WorkbookCellFormat, WorkbookEdit, WorkbookFormula, WorkbookSort, WorkbookHyperlink, WorkbookFilter, WorkbookInsert, WorkbookDelete, WorkbookFindAndReplace, WorkbookProtectSheet, WorkbookDataValidation, WorkbookMerge, WorkbookConditionalFormat, WorkbookImage, WorkbookChart);\n    }\n    /**\n     * For internal use only - Get the module name.\n     * @private\n     */\n    WorkbookBasicModule.prototype.getModuleName = function () {\n        return 'workbookBasic';\n    };\n    /**\n     * Destroys the Workbook basic module.\n     * @return {void}\n     */\n    WorkbookBasicModule.prototype.destroy = function () {\n        /* code snippet */\n    };\n    return WorkbookBasicModule;\n}());\nexport { WorkbookBasicModule };\n","import { Workbook, DataBind } from '../../workbook/index';\nimport { WorkbookSave, WorkbookNumberFormat, WorkbookFormula, WorkbookOpen, WorkbookChart } from '../integrations/index';\nimport { WorkbookSort, WorkbookFilter, WorkbookImage } from '../integrations/index';\nimport { WorkbookEdit, WorkbookCellFormat, WorkbookHyperlink, WorkbookInsert, WorkbookDelete } from '../actions/index';\nimport { WorkbookFindAndReplace, WorkbookProtectSheet, WorkbookDataValidation, WorkbookMerge } from '../actions/index';\nimport { WorkbookConditionalFormat } from '../actions/conditional-formatting';\n/**\n * Workbook all module.\n * @private\n */\nvar WorkbookAllModule = /** @class */ (function () {\n    /**\n     * Constructor for Workbook all module.\n     * @private\n     */\n    function WorkbookAllModule() {\n        Workbook.Inject(DataBind, WorkbookSave, WorkbookNumberFormat, WorkbookCellFormat, WorkbookEdit, WorkbookFormula, WorkbookOpen, WorkbookSort, WorkbookHyperlink, WorkbookFilter, WorkbookInsert, WorkbookDelete, WorkbookFindAndReplace, WorkbookProtectSheet, WorkbookDataValidation, WorkbookMerge, WorkbookConditionalFormat, WorkbookImage, WorkbookChart);\n    }\n    /**\n     * For internal use only - Get the module name.\n     * @private\n     */\n    WorkbookAllModule.prototype.getModuleName = function () {\n        return 'workbook-all';\n    };\n    /**\n     * Destroys the Workbook all module.\n     * @return {void}\n     */\n    WorkbookAllModule.prototype.destroy = function () {\n        /* code snippet */\n    };\n    return WorkbookAllModule;\n}());\nexport { WorkbookAllModule };\n","var __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    }\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nimport { ChildProperty, Property, Complex } from '@syncfusion/ej2-base';\n/**\n * Represents the cell style.\n */\nvar CellStyle = /** @class */ (function (_super) {\n    __extends(CellStyle, _super);\n    function CellStyle() {\n        return _super !== null && _super.apply(this, arguments) || this;\n    }\n    __decorate([\n        Property('Calibri')\n    ], CellStyle.prototype, \"fontFamily\", void 0);\n    __decorate([\n        Property('bottom')\n    ], CellStyle.prototype, \"verticalAlign\", void 0);\n    __decorate([\n        Property('left')\n    ], CellStyle.prototype, \"textAlign\", void 0);\n    __decorate([\n        Property('0pt')\n    ], CellStyle.prototype, \"textIndent\", void 0);\n    __decorate([\n        Property('#000000')\n    ], CellStyle.prototype, \"color\", void 0);\n    __decorate([\n        Property('#ffffff')\n    ], CellStyle.prototype, \"backgroundColor\", void 0);\n    __decorate([\n        Property('normal')\n    ], CellStyle.prototype, \"fontWeight\", void 0);\n    __decorate([\n        Property('normal')\n    ], CellStyle.prototype, \"fontStyle\", void 0);\n    __decorate([\n        Property('11pt')\n    ], CellStyle.prototype, \"fontSize\", void 0);\n    __decorate([\n        Property('none')\n    ], CellStyle.prototype, \"textDecoration\", void 0);\n    __decorate([\n        Property('')\n    ], CellStyle.prototype, \"border\", void 0);\n    __decorate([\n        Property('')\n    ], CellStyle.prototype, \"borderTop\", void 0);\n    __decorate([\n        Property('')\n    ], CellStyle.prototype, \"borderBottom\", void 0);\n    __decorate([\n        Property('')\n    ], CellStyle.prototype, \"borderLeft\", void 0);\n    __decorate([\n        Property('')\n    ], CellStyle.prototype, \"borderRight\", void 0);\n    return CellStyle;\n}(ChildProperty));\nexport { CellStyle };\n/**\n * Represents the Filter Collection.\n */\nvar FilterCollection = /** @class */ (function (_super) {\n    __extends(FilterCollection, _super);\n    function FilterCollection() {\n        return _super !== null && _super.apply(this, arguments) || this;\n    }\n    __decorate([\n        Property()\n    ], FilterCollection.prototype, \"sheetIdx\", void 0);\n    __decorate([\n        Property()\n    ], FilterCollection.prototype, \"filterRange\", void 0);\n    __decorate([\n        Property(false)\n    ], FilterCollection.prototype, \"hasFilter\", void 0);\n    __decorate([\n        Property()\n    ], FilterCollection.prototype, \"column\", void 0);\n    __decorate([\n        Property()\n    ], FilterCollection.prototype, \"criteria\", void 0);\n    __decorate([\n        Property()\n    ], FilterCollection.prototype, \"value\", void 0);\n    __decorate([\n        Property()\n    ], FilterCollection.prototype, \"dataType\", void 0);\n    return FilterCollection;\n}(ChildProperty));\nexport { FilterCollection };\n/**\n * Represents the DefineName.\n */\nvar DefineName = /** @class */ (function (_super) {\n    __extends(DefineName, _super);\n    function DefineName() {\n        return _super !== null && _super.apply(this, arguments) || this;\n    }\n    __decorate([\n        Property('')\n    ], DefineName.prototype, \"name\", void 0);\n    __decorate([\n        Property('')\n    ], DefineName.prototype, \"scope\", void 0);\n    __decorate([\n        Property('')\n    ], DefineName.prototype, \"comment\", void 0);\n    __decorate([\n        Property('')\n    ], DefineName.prototype, \"refersTo\", void 0);\n    return DefineName;\n}(ChildProperty));\nexport { DefineName };\n/**\n * Configures the Protect behavior for the spreadsheet.\n */\nvar ProtectSettings = /** @class */ (function (_super) {\n    __extends(ProtectSettings, _super);\n    function ProtectSettings() {\n        return _super !== null && _super.apply(this, arguments) || this;\n    }\n    __decorate([\n        Property(false)\n    ], ProtectSettings.prototype, \"selectCells\", void 0);\n    __decorate([\n        Property(false)\n    ], ProtectSettings.prototype, \"formatCells\", void 0);\n    __decorate([\n        Property(false)\n    ], ProtectSettings.prototype, \"formatRows\", void 0);\n    __decorate([\n        Property(false)\n    ], ProtectSettings.prototype, \"formatColumns\", void 0);\n    __decorate([\n        Property(false)\n    ], ProtectSettings.prototype, \"insertLink\", void 0);\n    return ProtectSettings;\n}(ChildProperty));\nexport { ProtectSettings };\n/**\n * Represents the Hyperlink.\n */\nvar Hyperlink = /** @class */ (function (_super) {\n    __extends(Hyperlink, _super);\n    function Hyperlink() {\n        return _super !== null && _super.apply(this, arguments) || this;\n    }\n    __decorate([\n        Property('')\n    ], Hyperlink.prototype, \"address\", void 0);\n    return Hyperlink;\n}(ChildProperty));\nexport { Hyperlink };\n/**\n * Represents the DataValidation.\n */\nvar Validation = /** @class */ (function (_super) {\n    __extends(Validation, _super);\n    function Validation() {\n        return _super !== null && _super.apply(this, arguments) || this;\n    }\n    __decorate([\n        Property('WholeNumber')\n    ], Validation.prototype, \"type\", void 0);\n    __decorate([\n        Property('Between')\n    ], Validation.prototype, \"operator\", void 0);\n    __decorate([\n        Property('0')\n    ], Validation.prototype, \"value1\", void 0);\n    __decorate([\n        Property('0')\n    ], Validation.prototype, \"value2\", void 0);\n    __decorate([\n        Property(true)\n    ], Validation.prototype, \"ignoreBlank\", void 0);\n    __decorate([\n        Property(true)\n    ], Validation.prototype, \"inCellDropDown\", void 0);\n    __decorate([\n        Property(false)\n    ], Validation.prototype, \"isHighlighted\", void 0);\n    return Validation;\n}(ChildProperty));\nexport { Validation };\n/**\n * Represents the Format.\n */\nvar Format = /** @class */ (function (_super) {\n    __extends(Format, _super);\n    function Format() {\n        return _super !== null && _super.apply(this, arguments) || this;\n    }\n    __decorate([\n        Property('General')\n    ], Format.prototype, \"format\", void 0);\n    __decorate([\n        Complex({}, CellStyle)\n    ], Format.prototype, \"style\", void 0);\n    __decorate([\n        Property(true)\n    ], Format.prototype, \"isLocked\", void 0);\n    return Format;\n}(ChildProperty));\nexport { Format };\n/**\n * Represents the Conditional Formatting.\n */\nvar ConditionalFormat = /** @class */ (function (_super) {\n    __extends(ConditionalFormat, _super);\n    function ConditionalFormat() {\n        return _super !== null && _super.apply(this, arguments) || this;\n    }\n    __decorate([\n        Property('GreaterThan')\n    ], ConditionalFormat.prototype, \"type\", void 0);\n    __decorate([\n        Complex({}, Format)\n    ], ConditionalFormat.prototype, \"format\", void 0);\n    __decorate([\n        Property('RedFT')\n    ], ConditionalFormat.prototype, \"cFColor\", void 0);\n    __decorate([\n        Property('')\n    ], ConditionalFormat.prototype, \"value\", void 0);\n    __decorate([\n        Property('')\n    ], ConditionalFormat.prototype, \"range\", void 0);\n    return ConditionalFormat;\n}(ChildProperty));\nexport { ConditionalFormat };\n/**\n * Represents the Chart.\n */\nvar Chart = /** @class */ (function (_super) {\n    __extends(Chart, _super);\n    function Chart() {\n        return _super !== null && _super.apply(this, arguments) || this;\n    }\n    __decorate([\n        Property('Line')\n    ], Chart.prototype, \"type\", void 0);\n    __decorate([\n        Property('Material')\n    ], Chart.prototype, \"theme\", void 0);\n    __decorate([\n        Property(false)\n    ], Chart.prototype, \"isSeriesInRows\", void 0);\n    __decorate([\n        Property('')\n    ], Chart.prototype, \"range\", void 0);\n    __decorate([\n        Property('')\n    ], Chart.prototype, \"id\", void 0);\n    __decorate([\n        Property(290)\n    ], Chart.prototype, \"height\", void 0);\n    __decorate([\n        Property(480)\n    ], Chart.prototype, \"width\", void 0);\n    __decorate([\n        Property(0)\n    ], Chart.prototype, \"top\", void 0);\n    __decorate([\n        Property(0)\n    ], Chart.prototype, \"left\", void 0);\n    return Chart;\n}(ChildProperty));\nexport { Chart };\n/**\n * Represents the Image.\n */\nvar Image = /** @class */ (function (_super) {\n    __extends(Image, _super);\n    function Image() {\n        return _super !== null && _super.apply(this, arguments) || this;\n    }\n    __decorate([\n        Property('')\n    ], Image.prototype, \"src\", void 0);\n    __decorate([\n        Property('')\n    ], Image.prototype, \"id\", void 0);\n    __decorate([\n        Property(300)\n    ], Image.prototype, \"height\", void 0);\n    __decorate([\n        Property(400)\n    ], Image.prototype, \"width\", void 0);\n    __decorate([\n        Property(0)\n    ], Image.prototype, \"top\", void 0);\n    __decorate([\n        Property(0)\n    ], Image.prototype, \"left\", void 0);\n    return Image;\n}(ChildProperty));\nexport { Image };\n","/** @hidden */\nexport var workbookLocale = 'spreadsheetLocale';\n/**\n * Workbook locale text\n * @hidden\n */\nexport var localeData = {\n    SortOutOfRangeError: 'Select a cell or range inside the used range and try again.'\n};\n","import { isNullOrUndefined } from '@syncfusion/ej2-base';\n/**\n * ServiceLocator\n * @hidden\n */\nvar ServiceLocator = /** @class */ (function () {\n    function ServiceLocator() {\n        this.services = {};\n    }\n    ServiceLocator.prototype.getService = function (name) {\n        if (isNullOrUndefined(this.services[name])) {\n            throw \"The service \" + name + \" is not registered\";\n        }\n        return this.services[name];\n    };\n    ServiceLocator.prototype.register = function (name, type) {\n        if (isNullOrUndefined(this.services[name])) {\n            this.services[name] = type;\n        }\n    };\n    return ServiceLocator;\n}());\nexport { ServiceLocator };\n","var __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    }\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nvar __assign = (this && this.__assign) || function () {\n    __assign = Object.assign || function(t) {\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\n            s = arguments[i];\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\n                t[p] = s[p];\n        }\n        return t;\n    };\n    return __assign.apply(this, arguments);\n};\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nimport { Component, Property, NotifyPropertyChanges, Collection, Complex } from '@syncfusion/ej2-base';\nimport { initSheet, getSheet, getSheetIndexFromId, getSheetIndexByName, getSheetIndex, Sheet } from './sheet';\nimport { Event, merge, L10n, isNullOrUndefined } from '@syncfusion/ej2-base';\nimport { getWorkbookRequiredModules } from '../common/module';\nimport { getData, clearRange } from './index';\nimport { DefineName, CellStyle, updateUsedRange, getIndexesFromAddress, localeData, workbookLocale } from '../common/index';\nimport * as events from '../common/event';\nimport { insertModel, getAddressInfo } from '../common/index';\nimport { setCellFormat, sheetCreated, deleteModel, setLockCells } from '../common/index';\nimport { setMerge } from '../common/index';\nimport { getCell, skipDefaultValue, setCell, wrap as wrapText } from './cell';\nimport { DataBind, setRow, setColumn } from '../index';\nimport { WorkbookSave, WorkbookFormula, WorkbookOpen, WorkbookSort, WorkbookFilter, WorkbookImage } from '../integrations/index';\nimport { WorkbookChart } from '../integrations/index';\nimport { WorkbookNumberFormat } from '../integrations/number-format';\nimport { WorkbookEdit, WorkbookCellFormat, WorkbookHyperlink, WorkbookInsert, WorkbookProtectSheet } from '../actions/index';\nimport { WorkbookDataValidation, WorkbookMerge } from '../actions/index';\nimport { ServiceLocator } from '../services/index';\nimport { setLinkModel, setImage, setChart } from '../common/event';\nimport { beginAction, completeAction, deleteChart } from '../../spreadsheet/common/event';\nimport { WorkbookFindAndReplace } from '../actions/find-and-replace';\nimport { WorkbookConditionalFormat } from '../actions/conditional-formatting';\n/**\n * Represents the Workbook.\n */\nvar Workbook = /** @class */ (function (_super) {\n    __extends(Workbook, _super);\n    /**\n     * Constructor for initializing the library.\n     * @param options - Configures Workbook model.\n     */\n    function Workbook(options) {\n        var _this = _super.call(this, options) || this;\n        /** @hidden */\n        _this.isEdit = false;\n        /**\n         * To generate sheet name based on sheet count.\n         * @hidden\n         */\n        _this.sheetNameCount = 1;\n        /**\n         * @hidden\n         */\n        _this.isOpen = false;\n        /**\n         * @hidden\n         */\n        _this.chartColl = [];\n        /**\n         * @hidden\n         */\n        _this.chartCount = 1;\n        Workbook_1.Inject(DataBind, WorkbookSave, WorkbookOpen, WorkbookNumberFormat, WorkbookCellFormat, WorkbookEdit, WorkbookFormula, WorkbookSort, WorkbookHyperlink, WorkbookFilter, WorkbookInsert, WorkbookFindAndReplace, WorkbookDataValidation, WorkbookProtectSheet, WorkbookMerge, WorkbookConditionalFormat, WorkbookImage, WorkbookChart);\n        _this.commonCellStyle = {};\n        if (options && options.cellStyle) {\n            _this.commonCellStyle = options.cellStyle;\n        }\n        if (_this.getModuleName() === 'workbook') {\n            _this.serviceLocator = new ServiceLocator;\n            _this.initWorkbookServices();\n            _this.dataBind();\n            _this.initEmptySheet();\n        }\n        return _this;\n    }\n    Workbook_1 = Workbook;\n    /**\n     * For internal use only.\n     * @returns void\n     * @hidden\n     */\n    Workbook.prototype.preRender = function () {\n        if (!Object.keys(this.commonCellStyle).length) {\n            this.commonCellStyle = skipDefaultValue(this.cellStyle, true);\n        }\n        if (this.getModuleName() === 'spreadsheet' && !this.refreshing) {\n            this.initEmptySheet();\n        }\n    };\n    Workbook.prototype.initWorkbookServices = function () {\n        this.serviceLocator.register(workbookLocale, new L10n(this.getModuleName(), localeData, this.locale));\n    };\n    /**\n     * For internal use only.\n     * @returns void\n     * @hidden\n     */\n    Workbook.prototype.render = function () {\n        /** code snippets */\n    };\n    /**\n     * To provide the array of modules needed for workbook.\n     * @return {ModuleDeclaration[]}\n     * @hidden\n     */\n    Workbook.prototype.requiredModules = function () {\n        return getWorkbookRequiredModules(this);\n    };\n    /**\n     * Get the properties to be maintained in the persisted state.\n     * @returns string\n     * @hidden\n     */\n    Workbook.prototype.getPersistData = function () {\n        return this.addOnPersist([]);\n    };\n    /**\n     * Applies the style (font family, font weight, background color, etc...) to the specified range of cells.\n     * {% codeBlock src='spreadsheet/cellFormat/index.md' %}{% endcodeBlock %}\n     * @param {CellStyleModel} style - Specifies the cell style.\n     * @param {string} range? - Specifies the address for the range of cells.\n     */\n    Workbook.prototype.cellFormat = function (style, range) {\n        var sheet = this.getActiveSheet();\n        range = range || sheet.selectedRange;\n        this.notify(setCellFormat, { style: style, range: range, refreshRibbon: range.indexOf(sheet.activeCell) > -1 ? true : false });\n    };\n    /**\n     * Applies cell lock to the specified range of cells.\n     * {% codeBlock src='spreadsheet/lockCells/index.md' %}{% endcodeBlock %}\n     * @param {string} range? - Specifies the address for the range of cells.\n     * @param {boolean} isLocked -Specifies the cell is locked or not.\n     */\n    Workbook.prototype.lockCells = function (range, isLocked) {\n        var sheet = this.getActiveSheet();\n        range = range || sheet.selectedRange;\n        this.notify(setLockCells, { range: range, isLocked: isLocked });\n    };\n    /** @hidden */\n    Workbook.prototype.getCellStyleValue = function (cssProps, indexes) {\n        var _this = this;\n        var cell = getCell(indexes[0], indexes[1], this.getActiveSheet());\n        var style = {};\n        cssProps.forEach(function (cssProp) {\n            style[cssProp] = _this.cellStyle[cssProp];\n            if (cell && cell.style && cell.style[cssProp]) {\n                style[cssProp] = cell.style[cssProp];\n            }\n        });\n        return style;\n    };\n    /**\n     * Applies the number format (number, currency, percentage, short date, etc...) to the specified range of cells.\n     * {% codeBlock src='spreadsheet/numberFormat/index.md' %}{% endcodeBlock %}\n     * @param {string} format - Specifies the number format code.\n     * @param {string} range? - Specifies the address for the range of cells.\n     */\n    Workbook.prototype.numberFormat = function (format, range) {\n        this.notify(events.applyNumberFormatting, { format: format, range: range });\n    };\n    /**\n     * Used to create new sheet.\n     * @hidden\n     */\n    Workbook.prototype.createSheet = function (index, sheets) {\n        if (index === void 0) { index = this.sheets.length; }\n        if (sheets === void 0) { sheets = [{}]; }\n        var _a;\n        (_a = this.sheets).splice.apply(_a, [index, 0].concat(sheets));\n        initSheet(this, sheets);\n        this.notify(sheetCreated, { sheetIndex: index || 0, sheets: sheets });\n        this.notify(events.workbookFormulaOperation, {\n            action: 'registerSheet', sheetIndex: index || 0, sheetCount: index + sheets.length\n        });\n    };\n    /**\n     * Used to remove sheet.\n     * @hidden\n     */\n    Workbook.prototype.removeSheet = function (idx) {\n        this.sheets.splice(idx, 1);\n    };\n    /**\n     * Destroys the Workbook library.\n     */\n    Workbook.prototype.destroy = function () {\n        this.notify(events.workbookDestroyed, null);\n        _super.prototype.destroy.call(this);\n    };\n    /**\n     * Called internally if any of the property value changed.\n     * @param  {WorkbookModel} newProp\n     * @param  {WorkbookModel} oldProp\n     * @returns void\n     * @hidden\n     */\n    Workbook.prototype.onPropertyChanged = function (newProp, oldProp) {\n        for (var _i = 0, _a = Object.keys(newProp); _i < _a.length; _i++) {\n            var prop = _a[_i];\n            switch (prop) {\n                case 'cellStyle':\n                    merge(this.commonCellStyle, skipDefaultValue(newProp.cellStyle));\n                    break;\n                case 'sheets':\n                    initSheet(this);\n                    break;\n            }\n        }\n    };\n    /**\n     * Not applicable for workbook.\n     * @hidden\n     */\n    Workbook.prototype.appendTo = function (selector) {\n        _super.prototype.appendTo.call(this, selector);\n    };\n    /**\n     * Used to hide/show the rows in spreadsheet.\n     * @param {number} startRow - Specifies the start row index.\n     * @param {number} endRow? - Specifies the end row index.\n     * @param {boolean} hide? - To hide/show the rows in specified range.\n     * @returns void\n     */\n    Workbook.prototype.hideRow = function (startIndex, endIndex, hide) {\n        if (endIndex === void 0) { endIndex = startIndex; }\n        if (hide === void 0) { hide = true; }\n        var sheet = this.getActiveSheet();\n        for (var i = startIndex; i <= endIndex; i++) {\n            setRow(sheet, i, { hidden: hide });\n        }\n    };\n    /**\n     * Used to hide/show the columns in spreadsheet.\n     * @param {number} startIndex - Specifies the start column index.\n     * @param {number} endIndex? - Specifies the end column index.\n     * @param {boolean} hide? - Set `true` / `false` to hide / show the columns.\n     * @returns void\n     */\n    Workbook.prototype.hideColumn = function (startIndex, endIndex, hide) {\n        if (endIndex === void 0) { endIndex = startIndex; }\n        if (hide === void 0) { hide = true; }\n        var sheet = this.getActiveSheet();\n        for (var i = startIndex; i <= endIndex; i++) {\n            setColumn(sheet, i, { hidden: hide });\n        }\n    };\n    /**\n     * Sets the border to specified range of cells.\n     * {% codeBlock src='spreadsheet/setBorder/index.md' %}{% endcodeBlock %}\n     * @param {CellStyleModel} style? - Specifies the style property which contains border value.\n     * @param {string} range? - Specifies the range of cell reference. If not specified, it will considered the active cell reference.\n     * @param {BorderType} type? - Specifies the range of cell reference. If not specified, it will considered the active cell reference.\n     * @returns void\n     */\n    Workbook.prototype.setBorder = function (style, range, type) {\n        this.notify(setCellFormat, {\n            style: style, borderType: type, range: range || this.getActiveSheet().selectedRange\n        });\n    };\n    /**\n     * Used to insert rows in to the spreadsheet.\n     * {% codeBlock src='spreadsheet/insertRow/index.md' %}{% endcodeBlock %}\n     * @param {number | RowModel[]} startRow? - Specifies the start row index / row model which needs to be inserted.\n     * @param {number} endRow? - Specifies the end row index.\n     * @returns void\n     */\n    Workbook.prototype.insertRow = function (startRow, endRow) {\n        this.notify(insertModel, { model: this.getActiveSheet(), start: startRow, end: endRow, modelType: 'Row' });\n    };\n    /**\n     * Used to insert columns in to the spreadsheet.\n     * {% codeBlock src='spreadsheet/insertColumn/index.md' %}{% endcodeBlock %}\n     * @param {number | ColumnModel[]} startColumn? - Specifies the start column index / column model which needs to be inserted.\n     * @param {number} endColumn? - Specifies the end column index.\n     * @returns void\n     */\n    Workbook.prototype.insertColumn = function (startColumn, endColumn) {\n        this.notify(insertModel, {\n            model: this.getActiveSheet(), start: startColumn, end: endColumn,\n            modelType: 'Column'\n        });\n    };\n    /**\n     * Used to insert sheets in to the spreadsheet.\n     * {% codeBlock src='spreadsheet/insertSheet/index.md' %}{% endcodeBlock %}\n     * @param {number | SheetModel[]} startSheet? - Specifies the start sheet index / sheet model which needs to be inserted.\n     * @param {number} endSheet? - Specifies the end sheet index.\n     * @returns void\n     */\n    Workbook.prototype.insertSheet = function (startSheet, endSheet) {\n        this.notify(insertModel, { model: this, start: startSheet, end: endSheet, modelType: 'Sheet' });\n    };\n    /**\n     * Used to delete rows, columns and sheets from the spreadsheet.\n     * {% codeBlock src='spreadsheet/delete/index.md' %}{% endcodeBlock %}\n     * @param {number | RowModel[]} startIndex? - Specifies the start sheet / row / column index.\n     * @param {number} endIndex? - Specifies the end sheet / row / column index.\n     * @param {ModelType} model? - Specifies the delete model type. By default, the model is considered as `Sheet`. The possible values are,\n     * - Row: To delete rows.\n     * - Column: To delete columns.\n     * - Sheet: To delete sheets.\n     * @returns void\n     */\n    Workbook.prototype.delete = function (startIndex, endIndex, model) {\n        startIndex = startIndex || 0;\n        this.notify(deleteModel, {\n            model: !model || model === 'Sheet' ? this : this.getActiveSheet(), start: startIndex,\n            end: isNullOrUndefined(endIndex) ? startIndex : endIndex, modelType: model || 'Sheet'\n        });\n    };\n    /**\n     * Used to merge the range of cells.\n     * {% codeBlock src='spreadsheet/merge/index.md' %}{% endcodeBlock %}\n     * @param {string} range? - Specifies the rnage of cells as address.\n     * @param {MergeType} type? - Specifies the merge type. The possible values are,\n     * - All: Merge all the cells between provided range.\n     * - Horizontally: Merge the cells row-wise.\n     * - Vertically: Merge the cells column-wise.\n     * @returns void\n     */\n    Workbook.prototype.merge = function (range, type) {\n        var sheetIdx = this.getAddressInfo(range).sheetIndex;\n        var sheet = getSheet(this, sheetIdx);\n        range = range || sheet.selectedRange;\n        this.notify(setMerge, { merge: true, range: range, type: type || 'All', sheet: sheet, refreshRibbon: range.indexOf(sheet.activeCell) > -1 ? true : false, preventRefresh: this.activeSheetIndex !== sheetIdx });\n    };\n    /** Used to compute the specified expression/formula.\n     * {% codeBlock src='spreadsheet/computeExpression/index.md' %}{% endcodeBlock %}\n     * @param {string} formula - Specifies the formula(=SUM(A1:A3)) or expression(2+3).\n     * @returns string | number\n     */\n    Workbook.prototype.computeExpression = function (formula) {\n        var args = {\n            action: 'computeExpression', formula: formula\n        };\n        this.notify(events.workbookFormulaOperation, args);\n        return args.calcValue;\n    };\n    Workbook.prototype.initEmptySheet = function () {\n        if (!this.sheets.length) {\n            this.createSheet();\n        }\n        else {\n            initSheet(this);\n        }\n    };\n    /** @hidden */\n    Workbook.prototype.getActiveSheet = function () {\n        return this.sheets[this.activeSheetIndex];\n    };\n    /** @hidden */\n    Workbook.prototype.skipHiddenSheets = function (index, initIdx, hiddenCount) {\n        if (hiddenCount === void 0) { hiddenCount = 0; }\n        if (this.sheets[index] && this.sheets[index].state !== 'Visible') {\n            if (initIdx === undefined) {\n                initIdx = index;\n            }\n            if (index && index + 1 === this.sheets.length) {\n                index = initIdx - 1;\n            }\n            else {\n                index < initIdx ? index-- : index++;\n            }\n            index = this.skipHiddenSheets(index, initIdx, ++hiddenCount);\n        }\n        if (hiddenCount === this.sheets.length) {\n            this.setSheetPropertyOnMute(this.sheets[0], 'state', 'Visible');\n            return 0;\n        }\n        return index;\n    };\n    /**\n     * Used for setting the used range row and column index.\n     * @hidden\n     */\n    Workbook.prototype.setUsedRange = function (rowIdx, colIdx) {\n        var sheet = this.getActiveSheet();\n        if (rowIdx > sheet.usedRange.rowIndex) {\n            sheet.usedRange.rowIndex = rowIdx;\n            this.notify(updateUsedRange, { index: rowIdx, update: 'row' });\n        }\n        if (colIdx > sheet.usedRange.colIndex) {\n            sheet.usedRange.colIndex = colIdx;\n            this.notify(updateUsedRange, { index: colIdx, update: 'col' });\n        }\n    };\n    /**\n     * Gets the range of data as JSON from the specified address.\n     * {% codeBlock src='spreadsheet/getData/index.md' %}{% endcodeBlock %}\n     * @param {string} address - Specifies the address for range of cells.\n     */\n    Workbook.prototype.getData = function (address) {\n        return getData(this, address);\n    };\n    /**\n     * Get component name.\n     * @returns string\n     * @hidden\n     */\n    Workbook.prototype.getModuleName = function () {\n        return 'workbook';\n    };\n    /** @hidden */\n    Workbook.prototype.getValueRowCol = function (sheetIndex, rowIndex, colIndex) {\n        var args = {\n            action: 'getSheetInfo', sheetInfo: []\n        };\n        this.notify(events.workbookFormulaOperation, args);\n        var id = getSheetIndexByName(this, 'Sheet' + (sheetIndex + 1), args.sheetInfo);\n        if (id === -1) {\n            var errArgs = { action: 'getReferenceError', refError: '' };\n            this.notify(events.workbookFormulaOperation, errArgs);\n            return errArgs.refError;\n        }\n        sheetIndex = getSheetIndexFromId(this, sheetIndex + 1);\n        var sheet = getSheet(this, sheetIndex);\n        var cell = getCell(rowIndex - 1, colIndex - 1, sheet);\n        return (cell && cell.value) || '';\n    };\n    /** @hidden */\n    Workbook.prototype.setValueRowCol = function (sheetIndex, value, rowIndex, colIndex) {\n        sheetIndex = getSheetIndexFromId(this, sheetIndex);\n        this.notify(events.workbookEditOperation, {\n            action: 'updateCellValue', address: [rowIndex - 1, colIndex - 1], value: value,\n            sheetIndex: sheetIndex, isValueOnly: true\n        });\n    };\n    /**\n     * Opens the specified excel file or stream.\n     * @param {OpenOptions} options - Options for opening the excel file.\n     */\n    Workbook.prototype.open = function (options) {\n        this.notify(events.workbookOpen, options);\n    };\n    /**\n     * Opens the specified JSON object.\n     * {% codeBlock src='spreadsheet/openFromJson/index.md' %}{% endcodeBlock %}\n     * <br><br>\n     * The available arguments in options are:\n     * * file: Specifies the spreadsheet model as object or string. And the object contains the jsonObject,\n     * which is saved from spreadsheet using saveAsJson method.\n     *\n     * @param options - Options for opening the JSON object.\n     */\n    Workbook.prototype.openFromJson = function (options) {\n        this.isOpen = true;\n        var jsonObject = typeof options.file === 'object' ? JSON.stringify(options.file) : options.file;\n        this.notify(events.workbookOpen, { jsonObject: jsonObject });\n    };\n    /**\n     * Saves the Spreadsheet data to Excel file.\n     * <br><br>\n     * The available arguments in saveOptions are:\n     * * url: Specifies the save URL.\n     * * fileName: Specifies the file name.\n     * * saveType: Specifies the file type need to be saved.\n     *\n     * {% codeBlock src='spreadsheet/save/index.md' %}{% endcodeBlock %}\n     * @param {SaveOptions} saveOptions - Options for saving the excel file.\n     */\n    Workbook.prototype.save = function (saveOptions) {\n        if (saveOptions === void 0) { saveOptions = {}; }\n        if (this.allowSave) {\n            var defaultProps = {\n                url: this.saveUrl,\n                fileName: saveOptions.fileName || 'Sample',\n                saveType: 'Xlsx'\n            };\n            var eventArgs = __assign({}, defaultProps, saveOptions, { customParams: {}, isFullPost: true, needBlobData: false, cancel: false });\n            this.trigger('beforeSave', eventArgs);\n            this.notify(beginAction, { eventArgs: eventArgs, action: 'beforeSave' });\n            if (!eventArgs.cancel) {\n                this.notify(events.beginSave, {\n                    saveSettings: eventArgs, isFullPost: eventArgs.isFullPost,\n                    needBlobData: eventArgs.needBlobData, customParams: eventArgs.customParams\n                });\n            }\n        }\n    };\n    /**\n     * Saves the Spreadsheet data as JSON object.\n     * {% codeBlock src='spreadsheet/saveAsJson/index.md' %}{% endcodeBlock %}\n     */\n    Workbook.prototype.saveAsJson = function () {\n        var _this = this;\n        return new Promise(function (resolve) {\n            _this.on(events.onSave, function (args) {\n                args.cancel = true;\n                _this.off(events.onSave);\n                resolve({ jsonObject: { Workbook: args.jsonObject } });\n                _this.notify(events.saveCompleted, args);\n            });\n            _this.save();\n        });\n    };\n    Workbook.prototype.addHyperlink = function (hyperlink, cellAddress) {\n        var args = { hyperlink: hyperlink, cell: cellAddress };\n        this.notify(setLinkModel, args);\n    };\n    /**\n     * To find the specified cell value.\n     * @hidden\n     * @param args - options for find.\n     */\n    Workbook.prototype.findHandler = function (args) {\n        if (args.findOpt === 'next') {\n            this.notify(events.findNext, args);\n        }\n        else if (args.findOpt === 'prev') {\n            this.notify(events.findPrevious, args);\n        }\n    };\n    /**\n     * @hidden\n     */\n    Workbook.prototype.replaceHandler = function (args) {\n        if (args.replaceBy === 'replace') {\n            this.notify(events.replaceHandler, args);\n        }\n        else {\n            this.notify(events.replaceAllHandler, args);\n        }\n    };\n    /**\n     * Protect the active sheet based on the protect sheetings.\n     * @param protectSettings - Specifies the protect settings of the sheet.\n     */\n    Workbook.prototype.protectSheet = function (sheet, protectSettings) {\n        this.notify(events.protectsheetHandler, protectSettings);\n    };\n    /**\n     * Unprotect the active sheet.\n     * @param sheet - Specifies the sheet to Unprotect.\n     */\n    Workbook.prototype.unprotectSheet = function (sheet) {\n        var args = { sheet: sheet };\n        this.notify(events.unprotectsheetHandler, args);\n    };\n    /**\n     * Sorts the range of cells in the active Spreadsheet.\n     * @param sortOptions - options for sorting.\n     * @param range - address of the data range.\n     */\n    Workbook.prototype.sort = function (sortOptions, range) {\n        if (!this.allowSorting) {\n            return Promise.reject();\n        }\n        var eventArgs = {\n            range: range || this.getActiveSheet().selectedRange,\n            sortOptions: sortOptions || { sortDescriptors: {} },\n            cancel: false\n        };\n        var promise = new Promise(function (resolve, reject) { resolve((function () { })()); });\n        var sortArgs = { args: eventArgs, promise: promise };\n        this.notify(events.initiateSort, sortArgs);\n        return sortArgs.promise;\n    };\n    Workbook.prototype.addDataValidation = function (rules, range) {\n        range = range ? range : this.getActiveSheet().selectedRange;\n        var eventArgs = {\n            range: range, type: rules.type, operator: rules.operator, value1: rules.value1,\n            value2: rules.value2, ignoreBlank: rules.ignoreBlank, inCellDropDown: rules.inCellDropDown, cancel: false\n        };\n        this.notify(beginAction, { eventArgs: eventArgs, action: 'validation' });\n        if (!eventArgs.cancel) {\n            range = eventArgs.range;\n            rules.type = eventArgs.type;\n            rules.operator = eventArgs.operator;\n            rules.value1 = eventArgs.value1;\n            rules.value2 = eventArgs.value2;\n            rules.ignoreBlank = eventArgs.ignoreBlank;\n            rules.inCellDropDown = eventArgs.inCellDropDown;\n            this.notify(events.setValidation, { rules: rules, range: range });\n            delete eventArgs.cancel;\n            this.notify(completeAction, { eventArgs: eventArgs, action: 'validation' });\n        }\n    };\n    Workbook.prototype.removeDataValidation = function (range) {\n        this.notify(events.removeValidation, { range: range });\n    };\n    Workbook.prototype.addInvalidHighlight = function (range) {\n        this.notify(events.addHighlight, { range: range });\n    };\n    Workbook.prototype.removeInvalidHighlight = function (range) {\n        this.notify(events.removeHighlight, { range: range });\n    };\n    Workbook.prototype.conditionalFormat = function (conditionalFormat) {\n        conditionalFormat.range = conditionalFormat.range || this.getActiveSheet().selectedRange;\n        this.notify(events.setCFRule, { conditionalFormat: conditionalFormat });\n    };\n    Workbook.prototype.clearConditionalFormat = function (range) {\n        range = range || this.getActiveSheet().selectedRange;\n        this.notify(events.clearCFRule, { range: range });\n    };\n    /**\n     * To update a cell properties.\n     * @param {CellModel} cell - Cell properties.\n     * @param {string} address - Address to update.\n     */\n    Workbook.prototype.updateCell = function (cell, address) {\n        var sheetIdx;\n        var range = getIndexesFromAddress(address);\n        if (address.includes('!')) {\n            sheetIdx = getSheetIndex(this, address.split('!')[0]);\n            if (sheetIdx === undefined) {\n                sheetIdx = this.activeSheetIndex;\n            }\n        }\n        else {\n            sheetIdx = this.activeSheetIndex;\n        }\n        setCell(range[0], range[1], this.sheets[sheetIdx], cell, true);\n        if (cell.value) {\n            this.notify(events.workbookEditOperation, {\n                action: 'updateCellValue', address: range, value: cell.value,\n                sheetIndex: sheetIdx\n            });\n        }\n    };\n    /**\n     * This method is used to wrap/unwrap the text content of the cell.\n     * {% codeBlock src='spreadsheet/wrap/index.md' %}{% endcodeBlock %}\n     * @param address - Address of the cell to be wrapped.\n     * @param wrap - Set `false` if the text content of the cell to be unwrapped.\n     * @returns void\n     */\n    Workbook.prototype.wrap = function (address, wrap) {\n        if (wrap === void 0) { wrap = true; }\n        wrapText(address, wrap, this);\n    };\n    /**\n     * Adds the defined name to the Spreadsheet.\n     * @param {DefineNameModel} definedName - Specifies the name.\n     * @return {boolean} - Return the added status of the defined name.\n     */\n    Workbook.prototype.addDefinedName = function (definedName) {\n        var eventArgs = {\n            action: 'addDefinedName',\n            isAdded: false,\n            definedName: definedName\n        };\n        this.notify(events.workbookFormulaOperation, eventArgs);\n        return eventArgs.isAdded;\n    };\n    /**\n     * Removes the defined name from the Spreadsheet.\n     * @param {string} definedName - Specifies the name.\n     * @param {string} scope - Specifies the scope of the defined name.\n     * @return {boolean} - Return the removed status of the defined name.\n     */\n    Workbook.prototype.removeDefinedName = function (definedName, scope) {\n        if (scope === void 0) { scope = ''; }\n        var eventArgs = {\n            action: 'removeDefinedName',\n            isRemoved: false,\n            definedName: definedName,\n            scope: scope\n        };\n        this.notify(events.workbookFormulaOperation, eventArgs);\n        return eventArgs.isRemoved;\n    };\n    /** @hidden */\n    Workbook.prototype.clearRange = function (address, sheetIndex, valueOnly) {\n        if (valueOnly === void 0) { valueOnly = true; }\n        clearRange(this, address || this.getActiveSheet().selectedRange, isNullOrUndefined(sheetIndex) ? this.activeSheetIndex : sheetIndex, valueOnly);\n    };\n    /**\n     * Used to set the image in spreadsheet.\n     * @param {ImageModel} images - Specifies the options to insert image in spreadsheet.\n     * @param {string} range - Specifies the range in spreadsheet.\n     * @returns void\n     */\n    Workbook.prototype.insertImage = function (images, range) {\n        this.notify(setImage, { options: images, range: range ? range : this.getActiveSheet().selectedRange });\n    };\n    /**\n     * Used to set the chart in spreadsheet.\n     * {% codeBlock src='spreadsheet/insertChart/index.md' %}{% endcodeBlock %}\n     * @param {ChartModel} chart - Specifies the options to insert chart in spreadsheet.\n     * @returns void\n     */\n    Workbook.prototype.insertChart = function (chart) {\n        this.notify(setChart, { chart: chart });\n    };\n    /**\n     * Used to delete the chart from spreadsheet.\n     * {% codeBlock src='spreadsheet/deleteChart/index.md' %}{% endcodeBlock %}\n     * @param {string} id - Specifies the chart element id.\n     * @returns void\n     */\n    Workbook.prototype.deleteChart = function (id) {\n        this.notify(deleteChart, { id: id });\n    };\n    /**\n     * Filters the range of cells in the sheet.\n     */\n    Workbook.prototype.filter = function (filterOptions, range) {\n        if (!this.allowFiltering) {\n            return Promise.reject();\n        }\n        var eventArgs = {\n            range: range || this.getActiveSheet().selectedRange,\n            filterOptions: filterOptions,\n            cancel: false\n        };\n        var promise = new Promise(function (resolve, reject) { resolve((function () { })()); });\n        var filterArgs = { args: eventArgs, promise: promise };\n        this.notify(events.initiateFilter, filterArgs);\n        return filterArgs.promise;\n    };\n    /**\n     * Clears the filter changes of the sheet.\n     */\n    Workbook.prototype.clearFilter = function () {\n        this.notify(events.clearAllFilter, null);\n    };\n    /**\n     * To add custom library function.\n     * @param {string} functionHandler - Custom function handler name\n     * @param {string} functionName - Custom function name\n     */\n    Workbook.prototype.addCustomFunction = function (functionHandler, functionName) {\n        functionName = functionName ? functionName : typeof functionHandler === 'string' ? functionHandler :\n            functionHandler.name.replace('bound ', '');\n        var eventArgs = {\n            action: 'addCustomFunction',\n            functionHandler: functionHandler,\n            functionName: functionName\n        };\n        this.notify(events.workbookFormulaOperation, eventArgs);\n    };\n    /**\n     * This method is used to Clear contents, formats and hyperlinks in spreadsheet.\n     *    * @param {ClearOptions} options - Options for clearing the content, formats and hyperlinks in spreadsheet.\n     */\n    Workbook.prototype.clear = function (options) {\n        this.notify(events.clear, options);\n    };\n    /**\n     * Gets the formatted text of the cell.\n     * {% codeBlock src='spreadsheet/getDisplayText/index.md' %}{% endcodeBlock %}\n     */\n    Workbook.prototype.getDisplayText = function (cell) {\n        if (!cell) {\n            return '';\n        }\n        if (cell.value && cell.format) {\n            var eventArgs = {\n                formattedText: cell.value, value: cell.value, format: cell.format, onLoad: true\n            };\n            this.notify(events.getFormattedCellObject, eventArgs);\n            return eventArgs.formattedText;\n        }\n        else if (!cell.value && cell.hyperlink) {\n            return typeof cell.hyperlink === 'string' ? cell.hyperlink : cell.hyperlink.address;\n        }\n        else {\n            return cell.value ? cell.value.toString() : '';\n        }\n    };\n    /**\n     * @hidden\n     */\n    Workbook.prototype.getAddressInfo = function (address) {\n        return getAddressInfo(this, address);\n    };\n    /**\n     * @hidden\n     */\n    Workbook.prototype.setSheetPropertyOnMute = function (sheet, prop, value) {\n        this.isProtectedOnChange = true;\n        sheet[prop] = value;\n        this.isProtectedOnChange = false;\n    };\n    var Workbook_1;\n    __decorate([\n        Collection([], Sheet)\n    ], Workbook.prototype, \"sheets\", void 0);\n    __decorate([\n        Property(0)\n    ], Workbook.prototype, \"activeSheetIndex\", void 0);\n    __decorate([\n        Property('100%')\n    ], Workbook.prototype, \"height\", void 0);\n    __decorate([\n        Property(true)\n    ], Workbook.prototype, \"allowFindAndReplace\", void 0);\n    __decorate([\n        Property()\n    ], Workbook.prototype, \"filterCollection\", void 0);\n    __decorate([\n        Property('100%')\n    ], Workbook.prototype, \"width\", void 0);\n    __decorate([\n        Property(true)\n    ], Workbook.prototype, \"showRibbon\", void 0);\n    __decorate([\n        Property(true)\n    ], Workbook.prototype, \"showFormulaBar\", void 0);\n    __decorate([\n        Property(true)\n    ], Workbook.prototype, \"showSheetTabs\", void 0);\n    __decorate([\n        Property(true)\n    ], Workbook.prototype, \"allowEditing\", void 0);\n    __decorate([\n        Property(true)\n    ], Workbook.prototype, \"allowOpen\", void 0);\n    __decorate([\n        Property(true)\n    ], Workbook.prototype, \"allowSave\", void 0);\n    __decorate([\n        Property(true)\n    ], Workbook.prototype, \"allowSorting\", void 0);\n    __decorate([\n        Property(true)\n    ], Workbook.prototype, \"allowFiltering\", void 0);\n    __decorate([\n        Property(true)\n    ], Workbook.prototype, \"allowNumberFormatting\", void 0);\n    __decorate([\n        Property(true)\n    ], Workbook.prototype, \"allowCellFormatting\", void 0);\n    __decorate([\n        Property(true)\n    ], Workbook.prototype, \"allowHyperlink\", void 0);\n    __decorate([\n        Property(true)\n    ], Workbook.prototype, \"allowInsert\", void 0);\n    __decorate([\n        Property(true)\n    ], Workbook.prototype, \"allowDelete\", void 0);\n    __decorate([\n        Property(true)\n    ], Workbook.prototype, \"allowMerge\", void 0);\n    __decorate([\n        Property(true)\n    ], Workbook.prototype, \"allowDataValidation\", void 0);\n    __decorate([\n        Property(true)\n    ], Workbook.prototype, \"allowImage\", void 0);\n    __decorate([\n        Property(true)\n    ], Workbook.prototype, \"allowChart\", void 0);\n    __decorate([\n        Property(true)\n    ], Workbook.prototype, \"allowConditionalFormat\", void 0);\n    __decorate([\n        Complex({}, CellStyle)\n    ], Workbook.prototype, \"cellStyle\", void 0);\n    __decorate([\n        Property('')\n    ], Workbook.prototype, \"openUrl\", void 0);\n    __decorate([\n        Property('')\n    ], Workbook.prototype, \"saveUrl\", void 0);\n    __decorate([\n        Collection([], DefineName)\n    ], Workbook.prototype, \"definedNames\", void 0);\n    __decorate([\n        Event()\n    ], Workbook.prototype, \"beforeOpen\", void 0);\n    __decorate([\n        Event()\n    ], Workbook.prototype, \"openFailure\", void 0);\n    __decorate([\n        Event()\n    ], Workbook.prototype, \"beforeSave\", void 0);\n    __decorate([\n        Event()\n    ], Workbook.prototype, \"saveComplete\", void 0);\n    __decorate([\n        Event()\n    ], Workbook.prototype, \"beforeCellFormat\", void 0);\n    __decorate([\n        Event()\n    ], Workbook.prototype, \"queryCellInfo\", void 0);\n    Workbook = Workbook_1 = __decorate([\n        NotifyPropertyChanges\n    ], Workbook);\n    return Workbook;\n}(Component));\nexport { Workbook };\n","import { detach, EventHandler, Browser, extend, isNullOrUndefined } from '@syncfusion/ej2-base';\nimport { getRangeIndexes, getCell, setCell, getSheet, getSwapRange, wrapEvent, inRange } from '../../workbook/index';\nimport { getRangeAddress, workbookEditOperation, getSheetIndexFromId, getSheetName } from '../../workbook/index';\nimport { getFormattedCellObject, workbookFormulaOperation, applyCellFormat, checkIsFormula } from '../../workbook/index';\nimport { pasteMerge, setMerge, getCellIndexes, getCellAddress } from '../../workbook/index';\nimport { ribbonClick, cut, copy, paste, initiateFilterUI } from '../common/index';\nimport { hasTemplate, createImageElement } from '../common/index';\nimport { enableToolbarItems, rowHeightChanged, completeAction, beginAction } from '../common/index';\nimport { clearCopy, locateElem, selectRange, dialog, contentLoaded, tabSwitch, cMenuBeforeOpen, locale } from '../common/index';\nimport { getMaxHgt, setMaxHgt, setRowEleHeight, deleteImage, getRowIdxFromClientY, getColIdxFromClientX } from '../common/index';\nimport { Deferred } from '@syncfusion/ej2-data';\nimport { refreshRibbonIcons, isCellReference, getColumn, isLocked as isCellLocked } from '../../workbook/index';\nimport { skipDefaultValue, getFilteredCollection, getColumnHeaderText, setChart } from '../../workbook/index';\n/**\n * Represents clipboard support for Spreadsheet.\n */\nvar Clipboard = /** @class */ (function () {\n    function Clipboard(parent) {\n        this.externalMerge = false;\n        this.parent = parent;\n        this.init();\n        this.addEventListener();\n    }\n    Clipboard.prototype.init = function () {\n        this.parent.element\n            .appendChild(this.parent.createElement('input', { className: 'e-clipboard', attrs: { 'contenteditable': 'true' } }));\n    };\n    Clipboard.prototype.addEventListener = function () {\n        var ele = this.getClipboardEle();\n        this.parent.on(cut, this.cut, this);\n        this.parent.on(copy, this.copy, this);\n        this.parent.on(paste, this.paste, this);\n        this.parent.on(clearCopy, this.clearCopiedInfo, this);\n        this.parent.on(tabSwitch, this.tabSwitchHandler, this);\n        this.parent.on(cMenuBeforeOpen, this.cMenuBeforeOpenHandler, this);\n        this.parent.on(ribbonClick, this.ribbonClickHandler, this);\n        this.parent.on(contentLoaded, this.initCopyIndicator, this);\n        this.parent.on(rowHeightChanged, this.rowHeightChanged, this);\n        EventHandler.add(ele, 'cut', this.cut, this);\n        EventHandler.add(ele, 'copy', this.copy, this);\n        EventHandler.add(ele, 'paste', this.paste, this);\n    };\n    Clipboard.prototype.removeEventListener = function () {\n        var ele = this.getClipboardEle();\n        if (!this.parent.isDestroyed) {\n            this.parent.off(cut, this.cut);\n            this.parent.off(copy, this.copy);\n            this.parent.off(paste, this.paste);\n            this.parent.off(clearCopy, this.clearCopiedInfo);\n            this.parent.off(tabSwitch, this.tabSwitchHandler);\n            this.parent.off(cMenuBeforeOpen, this.cMenuBeforeOpenHandler);\n            this.parent.off(ribbonClick, this.ribbonClickHandler);\n            this.parent.off(contentLoaded, this.initCopyIndicator);\n            this.parent.off(rowHeightChanged, this.rowHeightChanged);\n        }\n        EventHandler.remove(ele, 'cut', this.cut);\n        EventHandler.remove(ele, 'copy', this.copy);\n        EventHandler.remove(ele, 'paste', this.paste);\n    };\n    Clipboard.prototype.ribbonClickHandler = function (args) {\n        var parentId = this.parent.element.id;\n        switch (args.item.id) {\n            case parentId + '_cut':\n                this.cut({ isAction: true });\n                break;\n            case parentId + '_copy':\n                this.copy({ isAction: true });\n                break;\n        }\n        this.parent.element.focus();\n    };\n    Clipboard.prototype.tabSwitchHandler = function (args) {\n        if (args.activeTab === 0 && !this.copiedInfo && !this.copiedShapeInfo) {\n            this.hidePaste();\n        }\n    };\n    Clipboard.prototype.cMenuBeforeOpenHandler = function (e) {\n        var sheet = this.parent.getActiveSheet();\n        var l10n = this.parent.serviceLocator.getService(locale);\n        var delRowItems = [];\n        var hideRowItems = [];\n        var delColItems = [];\n        var hideColItems = [];\n        var actCell = sheet.activeCell;\n        var actCellIndex = getCellIndexes(actCell);\n        var cellObj = getCell(actCellIndex[0], actCellIndex[1], sheet);\n        var isLocked = sheet.isProtected && isCellLocked(cellObj, getColumn(sheet, actCellIndex[1]));\n        if (e.target === 'Content' || e.target === 'RowHeader' || e.target === 'ColumnHeader') {\n            this.parent.enableContextMenuItems([l10n.getConstant('Paste'), l10n.getConstant('PasteSpecial')], (this.copiedInfo ||\n                this.copiedShapeInfo && !isLocked) ? true : false);\n            this.parent.enableContextMenuItems([l10n.getConstant('Cut')], (!isLocked) ? true : false);\n        }\n        if ((e.target === 'Content') && isLocked) {\n            this.parent.enableContextMenuItems([l10n.getConstant('Cut'), l10n.getConstant('Filter'), l10n.getConstant('Sort')], false);\n        }\n        if ((e.target === 'Content') && (isLocked && !sheet.protectSettings.insertLink)) {\n            this.parent.enableContextMenuItems([l10n.getConstant('Hyperlink')], false);\n        }\n        if (e.target === 'ColumnHeader' && sheet.isProtected) {\n            delColItems = [l10n.getConstant('DeleteColumn'), l10n.getConstant('DeleteColumns'),\n                l10n.getConstant('InsertColumn'), l10n.getConstant('InsertColumns')];\n            hideColItems = [l10n.getConstant('HideColumn'), l10n.getConstant('HideColumns'),\n                l10n.getConstant('UnHideColumns')];\n            this.parent.enableContextMenuItems(delColItems, false);\n            this.parent.enableContextMenuItems(hideColItems, (sheet.protectSettings.formatColumns) ? true : false);\n        }\n        if (e.target === 'RowHeader' && sheet.isProtected) {\n            delRowItems = [l10n.getConstant('DeleteRow'), l10n.getConstant('DeleteRows'),\n                l10n.getConstant('InsertRow'), l10n.getConstant('InsertRows')];\n            hideRowItems = [l10n.getConstant('HideRow'), l10n.getConstant('HideRows'), l10n.getConstant('UnHideRows')];\n            this.parent.enableContextMenuItems(delRowItems, false);\n            this.parent.enableContextMenuItems(hideRowItems, (sheet.protectSettings.formatRows) ? true : false);\n        }\n    };\n    Clipboard.prototype.rowHeightChanged = function (args) {\n        if (this.copiedInfo && this.copiedInfo.range[0] > args.rowIdx) {\n            var ele = this.parent.element.getElementsByClassName('e-copy-indicator')[0];\n            if (ele) {\n                ele.style.top = parseInt(ele.style.top, 10) + args.threshold + \"px\";\n            }\n        }\n    };\n    Clipboard.prototype.cut = function (args) {\n        this.setCopiedInfo(args, true);\n    };\n    Clipboard.prototype.copy = function (args) {\n        this.copiedSheet = this.parent.getActiveSheet();\n        this.setCopiedInfo(args, false);\n    };\n    Clipboard.prototype.paste = function (args) {\n        if (this.parent.isEdit) {\n            return;\n        }\n        var rfshRange;\n        args.isAction = true;\n        /* tslint:disable-next-line */\n        var isExternal = ((args && args.clipboardData) || window['clipboardData']);\n        var copiedIdx = this.getCopiedIdx();\n        var isCut;\n        var copyInfo = Object.assign({}, this.copiedInfo);\n        if (isExternal || this.copiedShapeInfo || (args.isInternal && this.copiedInfo)) {\n            var cSIdx = (args && args.sIdx > -1) ? args.sIdx : this.parent.activeSheetIndex;\n            var curSheet = getSheet(this.parent, cSIdx);\n            var selIdx = getSwapRange(args && args.range || getRangeIndexes(curSheet.selectedRange));\n            var rows = isExternal && this.getExternalCells(args);\n            if (!args.isInternal && rows && rows.internal) {\n                isExternal = false;\n                if (!this.copiedInfo) {\n                    return;\n                }\n            }\n            if (isExternal && !rows.length) { // If image pasted\n                return;\n            }\n            var cellLength = 0;\n            if (rows) {\n                for (var i = 0; i < rows.length; i++) {\n                    cellLength = rows[i].cells.length > cellLength ? rows[i].cells.length : cellLength;\n                }\n            }\n            var rowIdx = selIdx[0];\n            var cIdx = isExternal\n                ? [0, 0, rows.length - 1, cellLength - 1] : getSwapRange(this.copiedShapeInfo ?\n                getRangeIndexes(curSheet.selectedRange) : this.copiedInfo.range);\n            var isRepeative = (selIdx[2] - selIdx[0] + 1) % (cIdx[2] - cIdx[0] + 1) === 0\n                && (selIdx[3] - selIdx[1] + 1) % (cIdx[3] - cIdx[1] + 1) === 0;\n            rfshRange = isRepeative ? selIdx : [selIdx[0], selIdx[1]]\n                .concat([selIdx[0] + cIdx[2] - cIdx[0], selIdx[1] + cIdx[3] - cIdx[1] || selIdx[1]]);\n            var beginEventArgs = {\n                requestType: 'paste',\n                copiedInfo: this.copiedInfo,\n                copiedRange: getRangeAddress(cIdx),\n                pastedRange: getRangeAddress(rfshRange),\n                type: (args && args.type) || 'All',\n                cancel: false\n            };\n            if (args.isAction && !this.copiedShapeInfo && this.copiedInfo) {\n                this.parent.notify(beginAction, { eventArgs: beginEventArgs, action: 'clipboard' });\n            }\n            if (beginEventArgs.cancel) {\n                return;\n            }\n            var cell = void 0;\n            var isExtend = void 0;\n            var prevCell = void 0;\n            var mergeCollection = [];\n            var prevSheet = getSheet(this.parent, isExternal ? cSIdx : copiedIdx);\n            selIdx = getRangeIndexes(beginEventArgs.pastedRange);\n            rowIdx = selIdx[0];\n            cIdx = isExternal\n                ? [0, 0, rows.length - 1, cellLength - 1] : getSwapRange(this.copiedShapeInfo ?\n                getRangeIndexes(curSheet.selectedRange) : this.copiedInfo.range);\n            isRepeative = (selIdx[2] - selIdx[0] + 1) % (cIdx[2] - cIdx[0] + 1) === 0 && (selIdx[3] - selIdx[1] + 1) %\n                (cIdx[3] - cIdx[1] + 1) === 0;\n            var mergeArgs = {\n                range: cIdx, prevSheet: prevSheet, cancel: false\n            };\n            rfshRange = isRepeative ? selIdx : [selIdx[0], selIdx[1]]\n                .concat([selIdx[0] + cIdx[2] - cIdx[0], selIdx[1] + cIdx[3] - cIdx[1] || selIdx[1]]);\n            var copiedAddress = getCellAddress(cIdx[0], cIdx[1]);\n            var copiedIndex = getCellIndexes(copiedAddress);\n            this.parent.notify(refreshRibbonIcons, copiedIndex);\n            if (this.copiedShapeInfo && !this.copiedInfo) {\n                var pictureElem = this.copiedShapeInfo.pictureElem;\n                if (pictureElem.classList.contains('e-datavisualization-chart')) {\n                    this.parent.notify(setChart, {\n                        chart: [this.copiedShapeInfo.chartInfo], isInitCell: true, isUndoRedo: true, isPaste: true,\n                        dataSheetIdx: this.copiedShapeInfo.sheetIdx, isCut: this.copiedShapeInfo.isCut,\n                        range: args.range || curSheet.selectedRange, isIdAvailabe: false\n                    });\n                }\n                else {\n                    this.parent.notify(createImageElement, {\n                        options: {\n                            src: pictureElem.style.backgroundImage.replace(/url\\((['\"])?(.*?)\\1\\)/gi, '$2'),\n                            height: this.copiedShapeInfo.height, width: this.copiedShapeInfo.width,\n                            imageId: this.copiedShapeInfo.isCut ? pictureElem.id : ''\n                        },\n                        range: getRangeAddress([rowIdx, selIdx[1], rowIdx, selIdx[1]]), isPublic: false, isUndoRedo: true\n                    });\n                }\n                var pastedCell = getCell(rowIdx, selIdx[1], curSheet);\n                if (pastedCell && !isNullOrUndefined(pastedCell.image)) {\n                    var imgLen = pastedCell.image ? pastedCell.image.length - 1 : 0;\n                    var eventArgs = {\n                        requestType: 'imagePaste',\n                        copiedShapeInfo: this.copiedShapeInfo,\n                        pasteSheetIndex: this.parent.activeSheetIndex,\n                        pastedRange: getSheetName(this.parent) + '!' + getRangeAddress([rowIdx, selIdx[1], rowIdx, selIdx[1]]),\n                        pastedPictureElement: document.getElementById(pastedCell.image[imgLen].id)\n                    };\n                    this.parent.notify(completeAction, { eventArgs: eventArgs, action: 'clipboard' });\n                }\n            }\n            else {\n                this.parent.notify(pasteMerge, mergeArgs);\n                if (mergeArgs.cancel) {\n                    return;\n                }\n                var pasteType = beginEventArgs.type ? beginEventArgs.type : args.type;\n                var cRows = [];\n                var inRange_1 = this.isInRange(cIdx, selIdx);\n                for (var i = cIdx[0], l = 0; i <= cIdx[2]; i++, l++) {\n                    if (inRange_1) {\n                        cRows[selIdx[0] + l] = { cells: [] };\n                    }\n                    for (var j = cIdx[1], k = 0; j <= cIdx[3]; j++, k++) {\n                        if (inRange_1) {\n                            cRows[selIdx[0] + l].cells[selIdx[1] + k] = getCell(selIdx[0] + l, selIdx[1] + k, prevSheet);\n                        }\n                        cell = isExternal ? rows[i].cells[j] : Object.assign({}, (inRange_1 && cRows[i] && cRows[i].cells[j])\n                            ? cRows[i].cells[j] : getCell(i, j, prevSheet));\n                        this.copiedCell = [i, j];\n                        if (cell && args && args.type || pasteType) {\n                            switch (pasteType) {\n                                case 'Formats':\n                                    cell = { format: cell.format, style: cell.style };\n                                    break;\n                                case 'Values':\n                                    cell = { value: cell.value };\n                                    if (cell.value && cell.value.toString().indexOf('\\n') > -1) {\n                                        var ele = this.parent.getCell(selIdx[0], selIdx[1]);\n                                        ele.classList.add('e-alt-unwrap');\n                                    }\n                                    break;\n                            }\n                            isExtend = ['Formats', 'Values'].indexOf(args.type) > -1;\n                        }\n                        if ((!this.parent.scrollSettings.isFinite && (cIdx[2] - cIdx[0] > (1048575 - selIdx[0])\n                            || cIdx[3] - cIdx[1] > (16383 - selIdx[1])))\n                            || (this.parent.scrollSettings.isFinite && (cIdx[2] - cIdx[0] > (curSheet.rowCount - 1 - selIdx[0])\n                                || cIdx[3] - cIdx[1] > (curSheet.colCount - 1 - selIdx[1])))) {\n                            this.showDialog();\n                            return;\n                        }\n                        if (isRepeative) {\n                            for (var x = selIdx[0]; x <= selIdx[2]; x += (cIdx[2] - cIdx[0]) + 1) {\n                                for (var y = selIdx[1]; y <= selIdx[3]; y += (cIdx[3] - cIdx[1] + 1)) {\n                                    prevCell = getCell(x + l, y + k, curSheet) || {};\n                                    if (!this.externalMerge && prevCell.colSpan !== undefined || prevCell.rowSpan !== undefined) {\n                                        mergeArgs = { range: [x + l, y + k, x + l, y + k] };\n                                        var merge = { range: mergeArgs.range, merge: false, isAction: false, type: 'All' };\n                                        mergeCollection.push(merge);\n                                        if (this.parent.activeSheetIndex === curSheet.index) {\n                                            this.parent.notify(setMerge, merge);\n                                        }\n                                    }\n                                    var colInd = y + k;\n                                    if (this.externalMerge && this.externalMergeRow === x + l) {\n                                        colInd = colInd + 1;\n                                    }\n                                    else {\n                                        this.externalMerge = false;\n                                    }\n                                    var newFormula = this.isFormula([x + l, colInd]);\n                                    if (!isNullOrUndefined(newFormula)) {\n                                        cell.formula = newFormula;\n                                    }\n                                    this.setCell(x + l, colInd, curSheet, cell, isExtend);\n                                    var sId = this.parent.activeSheetIndex;\n                                    var cellElem = this.parent.getCell(x + l, colInd);\n                                    var address = getCellAddress(x + l, colInd);\n                                    var cellArgs = {\n                                        address: this.parent.sheets[sId].name + '!' + address,\n                                        requestType: 'paste',\n                                        value: getCell(x + l, colInd, curSheet) ? getCell(x + l, colInd, curSheet).value : '',\n                                        oldValue: prevCell.value,\n                                        element: cellElem,\n                                        displayText: this.parent.getDisplayText(cell)\n                                    };\n                                    this.parent.trigger('cellSave', cellArgs);\n                                }\n                            }\n                        }\n                        else {\n                            if (!hasTemplate(this.parent, i, j, copiedIdx)) {\n                                this.setCell(rowIdx, selIdx[1] + k, curSheet, cell, isExtend);\n                            }\n                        }\n                        if (!isExternal && this.copiedInfo.isCut) {\n                            this.setCell(i, j, prevSheet, null, false, true);\n                        }\n                    }\n                    rowIdx++;\n                }\n                this.parent.setUsedRange(rfshRange[2] + 1, rfshRange[3]);\n                if (cSIdx === this.parent.activeSheetIndex) {\n                    this.parent.serviceLocator.getService('cell').refreshRange(rfshRange);\n                    this.parent.notify(selectRange, { indexes: rfshRange });\n                }\n                if (!isExternal && this.copiedInfo.isCut) {\n                    isCut = this.copiedInfo.isCut;\n                    if (copiedIdx === this.parent.activeSheetIndex) {\n                        this.parent.serviceLocator.getService('cell').refreshRange(cIdx);\n                    }\n                    this.clearCopiedInfo();\n                    this.cutInfo = isCut;\n                }\n                if ((isExternal || inRange_1) && this.copiedInfo) {\n                    this.clearCopiedInfo();\n                }\n                if (isExternal || (args && args.isAction)) {\n                    this.parent.element.focus();\n                }\n                if (args.isAction) {\n                    var sheetIndex = copyInfo && copyInfo.sId ? getSheetIndexFromId(this.parent, copyInfo.sId) :\n                        this.parent.activeSheetIndex;\n                    var eventArgs = {\n                        requestType: 'paste',\n                        copiedInfo: copyInfo,\n                        mergeCollection: mergeCollection,\n                        pasteSheetIndex: this.parent.activeSheetIndex,\n                        copiedRange: this.parent.sheets[sheetIndex].name + '!' + getRangeAddress(copyInfo && copyInfo.range ?\n                            copyInfo.range : getRangeIndexes(this.parent.sheets[sheetIndex].selectedRange)),\n                        pastedRange: getSheetName(this.parent) + '!' + getRangeAddress(rfshRange),\n                        type: pasteType || 'All'\n                    };\n                    this.parent.notify(completeAction, { eventArgs: eventArgs, action: 'clipboard' });\n                }\n                if (isCut) {\n                    this.updateFilter(copyInfo, rfshRange);\n                    setMaxHgt(prevSheet, cIdx[0], cIdx[1], 20);\n                    var hgt = getMaxHgt(prevSheet, cIdx[0]);\n                    setRowEleHeight(this.parent, prevSheet, hgt, cIdx[0]);\n                }\n            }\n        }\n        else {\n            this.getClipboardEle().select();\n        }\n    };\n    Clipboard.prototype.updateFilter = function (copyInfo, pastedRange) {\n        var isFilterCut;\n        this.parent.notify(getFilteredCollection, null);\n        for (var i = 0; i < this.parent.sheets.length; i++) {\n            if (this.parent.filterCollection && this.parent.filterCollection[i] &&\n                this.parent.filterCollection[i].sheetIdx === getSheetIndexFromId(this.parent, copyInfo.sId)) {\n                var range = copyInfo.range;\n                var fRange = getRangeIndexes(this.parent.filterCollection[i].filterRange);\n                var endCol = getColumnHeaderText(range[3]);\n                var fEndCol = getColumnHeaderText(fRange[3]);\n                if ((fRange[0] === range[0] && fRange[1] === range[1] && endCol === fEndCol) ||\n                    (fRange[0] === range[2] && fRange[1] === range[3] && endCol === fEndCol)) {\n                    isFilterCut = true;\n                }\n            }\n        }\n        var cell = this.parent.getCell(copyInfo.range[0], copyInfo.range[1]);\n        cell = cell.querySelector('.e-filter-icon') ? cell : this.parent.getCell(copyInfo.range[2], copyInfo.range[3]);\n        var asc = cell.querySelector('.e-sortasc-filter');\n        var desc = cell.querySelector('.e-sortdesc-filter');\n        if (isFilterCut) {\n            for (var n = 0; n < this.parent.filterCollection.length; n++) {\n                var filterCol = this.parent.filterCollection[n];\n                var sheetIndex = copyInfo && copyInfo.sId ? getSheetIndexFromId(this.parent, copyInfo.sId) :\n                    this.parent.activeSheetIndex;\n                if (filterCol.sheetIdx === sheetIndex) {\n                    this.parent.notify(initiateFilterUI, { predicates: null, range: filterCol.filterRange, sIdx: sheetIndex, isCut: true });\n                }\n                if (filterCol.sheetIdx === sheetIndex && sheetIndex === this.parent.activeSheetIndex) {\n                    this.parent.notify(initiateFilterUI, { predicates: null, range: null, sIdx: null, isCut: true });\n                    if (copyInfo.range[3] === copyInfo.range[1]) { // To update sorted icon after pasting.\n                        var filteredCell = this.parent.getCell(pastedRange[0], pastedRange[1]);\n                        if (asc && filteredCell) {\n                            filteredCell.querySelector('.e-filter-icon').classList.add('e-sortasc-filter');\n                        }\n                        if (desc && filteredCell) {\n                            filteredCell.querySelector('.e-filter-icon').classList.add('e-sortdesc-filter');\n                        }\n                    }\n                }\n            }\n        }\n    };\n    Clipboard.prototype.isInRange = function (cRng, pRng) {\n        return inRange(cRng, pRng[0], pRng[1]) || inRange(cRng, pRng[2], pRng[3]);\n    };\n    Clipboard.prototype.isFormula = function (selIdx) {\n        var cIdxValue;\n        var cell;\n        var sheet;\n        if (!isNullOrUndefined(this.copiedCell)) {\n            sheet = !isNullOrUndefined(this.copiedSheet) ? this.copiedSheet : this.parent.getActiveSheet();\n            cell = getCell(this.copiedCell[0], this.copiedCell[1], sheet);\n            if (!isNullOrUndefined(cell)) {\n                cIdxValue = cell.formula ? cell.formula.toUpperCase() : '';\n            }\n        }\n        if (cIdxValue !== '' && !isNullOrUndefined(cIdxValue)) {\n            if (cIdxValue.indexOf('=') === 0) {\n                cIdxValue = cIdxValue.slice(1);\n            }\n            var start = cIdxValue.indexOf('(');\n            var end = cIdxValue.indexOf(')');\n            if (start > -1 && end > -1) {\n                cIdxValue = cIdxValue.slice(start + 1, end);\n            }\n            var difIndex = [];\n            var formulaOperators = ['+', '-', '*', '/'];\n            var splitArray = void 0;\n            var value = cIdxValue;\n            for (var i = 0; i < formulaOperators.length; i++) {\n                splitArray = value.split(formulaOperators[i]);\n                value = splitArray.join(',');\n            }\n            splitArray = value.split(',');\n            for (var j = 0; j < splitArray.length; j++) {\n                if (isCellReference(splitArray[j])) {\n                    var range = getCellIndexes(splitArray[j]);\n                    var diff = [this.copiedCell[0] - range[0], this.copiedCell[1] - range[1]];\n                    difIndex.push(diff[0]);\n                    difIndex.push(diff[1]);\n                }\n            }\n            var newAddress = [];\n            for (var j = 0; j < difIndex.length; j++) {\n                var address = getCellAddress(selIdx[0] - difIndex[0 + j], selIdx[1] - difIndex[1 + j]);\n                newAddress.push(address);\n                j++;\n            }\n            for (var a = 0; a < newAddress.length; a++) {\n                if (isCellReference(newAddress[a])) {\n                    var range = getRangeIndexes(newAddress[a]);\n                    if (range[0] < 0 || range[1] < 0) {\n                        newAddress[a] = '#REF!';\n                    }\n                }\n                else {\n                    newAddress[a] = '#REF!';\n                }\n            }\n            cIdxValue = cell.formula.toUpperCase();\n            for (var i = 0; i < splitArray.length; i++) {\n                for (var j = 0; j < newAddress.length; j++) {\n                    cIdxValue = cIdxValue.replace(splitArray[i].toUpperCase(), newAddress[j].toUpperCase());\n                    i++;\n                }\n            }\n            return cIdxValue;\n        }\n        else {\n            return null;\n        }\n    };\n    Clipboard.prototype.setCell = function (rIdx, cIdx, sheet, cell, isExtend, isCut) {\n        setCell(rIdx, cIdx, sheet, isCut ? null : cell, isExtend);\n        if (cell && cell.formula) {\n            this.parent.notify(workbookFormulaOperation, {\n                action: 'refreshCalculate', value: isCut ? '' : cell.formula, rowIndex: rIdx,\n                colIndex: cIdx, sheetIndex: this.parent.activeSheetIndex, isFormula: true\n            });\n        }\n        if (cell && !cell.formula) {\n            this.parent.notify(workbookEditOperation, {\n                action: 'updateCellValue', address: [rIdx, cIdx, rIdx,\n                    cIdx], value: cell.value\n            });\n        }\n        if (cell) {\n            if (cell.style) {\n                var style = {};\n                if (cell.style.properties) {\n                    style = skipDefaultValue(cell.style, true);\n                }\n                else {\n                    style = cell.style;\n                }\n                this.parent.notify(applyCellFormat, {\n                    style: extend({}, this.parent.commonCellStyle, style), rowIdx: rIdx, colIdx: cIdx, cell: null,\n                    lastCell: null, row: null, hRow: null, isHeightCheckNeeded: true, manualUpdate: false\n                });\n            }\n            if (cell.wrap) {\n                this.parent.notify(wrapEvent, { range: [rIdx, cIdx, rIdx, cIdx], wrap: false, sheet: sheet });\n            }\n            if (cell.colSpan > 1) {\n                setCell(rIdx, cIdx + cell.colSpan - 1, sheet, isCut ? null : { colSpan: -1 }, isExtend);\n                this.externalMerge = true;\n                this.externalMergeRow = rIdx;\n                this.parent.notify(setMerge, { merge: true, range: [rIdx, cIdx, rIdx, cIdx + cell.colSpan - 1],\n                    type: 'All', isAction: true, refreshRibbon: true });\n            }\n        }\n    };\n    Clipboard.prototype.getEmptyStyle = function (cellStyle) {\n        var style = {};\n        Object.keys(cellStyle).forEach(function (key) {\n            style[key] = '';\n        });\n        return style;\n    };\n    Clipboard.prototype.getCopiedIdx = function () {\n        if (this.copiedInfo) {\n            for (var i = 0; i < this.parent.sheets.length; i++) {\n                if (this.parent.sheets[i].id === this.copiedInfo.sId) {\n                    return i;\n                }\n            }\n            this.clearCopiedInfo();\n        }\n        return -1;\n    };\n    Clipboard.prototype.setCopiedInfo = function (args, isCut) {\n        var _this = this;\n        if (this.parent.isEdit) {\n            return;\n        }\n        var deferred = new Deferred();\n        args.promise = deferred.promise;\n        var sheet = this.parent.getActiveSheet();\n        var range = (args && args.range) || getRangeIndexes(sheet.selectedRange);\n        var option = {\n            sheet: sheet, indexes: [0, 0, sheet.rowCount - 1, sheet.colCount - 1], promise: new Promise(function (resolve, reject) { resolve((function () { })()); })\n        };\n        var pictureElements = document.getElementsByClassName('e-ss-overlay-active');\n        var pictureLen = pictureElements.length;\n        if (sheet.isLocalData && !(args && args.clipboardData) && range[0] === 0 && range[2] === (sheet.rowCount - 1)) {\n            this.parent.showSpinner();\n            this.parent.notify('updateSheetFromDataSource', option);\n        }\n        option.promise.then(function () {\n            if (pictureLen > 0) {\n                var imgRowIdx = {\n                    clientY: pictureElements[0].offsetTop,\n                    isImage: true\n                };\n                _this.parent.notify(getRowIdxFromClientY, imgRowIdx);\n                var imgColIdx = {\n                    clientX: pictureElements[0].offsetLeft,\n                    isImage: true\n                };\n                _this.parent.notify(getColIdxFromClientX, imgColIdx);\n                _this.copiedShapeInfo = {\n                    sId: (args && args.sId) ? args.sId : sheet.id, sheetIdx: sheet.index, isCut: isCut, pictureElem: pictureElements[0], copiedRange: getRangeAddress([imgRowIdx.clientY, imgColIdx.clientX,\n                        imgRowIdx.clientY, imgColIdx.clientX]), height: pictureElements[0].offsetHeight,\n                    width: pictureElements[0].offsetWidth,\n                    chartInfo: _this.getChartElemInfo(pictureElements[0], isCut)\n                };\n                _this.hidePaste(true);\n                if (isCut) {\n                    if (pictureElements[0].classList.contains('e-datavisualization-chart')) {\n                        _this.parent.deleteChart(_this.copiedShapeInfo.chartInfo.id);\n                    }\n                    else {\n                        _this.parent.notify(deleteImage, {\n                            id: _this.copiedShapeInfo.pictureElem.id, sheetIdx: _this.copiedShapeInfo.sId, range: _this.copiedShapeInfo.copiedRange\n                        });\n                    }\n                }\n            }\n            else if (!(args && args.clipboardData)) {\n                if (_this.copiedInfo) {\n                    _this.clearCopiedInfo();\n                }\n                _this.copiedInfo = {\n                    range: range, sId: (args && args.sId) ? args.sId : sheet.id, isCut: isCut\n                };\n                _this.hidePaste(true);\n                _this.initCopyIndicator();\n                if (!Browser.isIE) {\n                    _this.getClipboardEle().select();\n                }\n                if (args && args.isAction) {\n                    document.execCommand(isCut ? 'cut' : 'copy');\n                }\n                _this.parent.hideSpinner();\n            }\n            if (Browser.isIE) {\n                _this.setExternalCells(args);\n            }\n            deferred.resolve();\n        });\n        if (args && args.clipboardData) {\n            this.setExternalCells(args);\n            this.parent.element.focus();\n        }\n    };\n    Clipboard.prototype.getChartElemInfo = function (overlayEle, isCut) {\n        var chartColl = this.parent.chartColl;\n        if (overlayEle.classList.contains('e-datavisualization-chart')) {\n            var chartId = overlayEle.getElementsByClassName('e-control')[0].id;\n            for (var idx = 0; idx < chartColl.length; idx++) {\n                if (chartColl[idx].id === chartId) {\n                    var chart = chartColl[idx];\n                    return chart;\n                }\n            }\n        }\n        return null;\n    };\n    Clipboard.prototype.clearCopiedInfo = function () {\n        if (this.copiedInfo) {\n            if (this.parent.getActiveSheet().id === this.copiedInfo.sId) {\n                detach(this.parent.getMainContent().getElementsByClassName('e-copy-indicator')[0]);\n            }\n            this.copiedInfo = null;\n            this.hidePaste();\n        }\n        if (this.copiedShapeInfo) {\n            this.copiedShapeInfo = null;\n            this.hidePaste();\n        }\n    };\n    Clipboard.prototype.initCopyIndicator = function () {\n        if (this.copiedInfo && this.parent.getActiveSheet().id === this.copiedInfo.sId) {\n            var copyIndicator = this.parent.createElement('div', { className: 'e-copy-indicator' });\n            copyIndicator.appendChild(this.parent.createElement('div', { className: 'e-top' }));\n            copyIndicator.appendChild(this.parent.createElement('div', { className: 'e-bottom' }));\n            copyIndicator.appendChild(this.parent.createElement('div', { className: 'e-left' }));\n            copyIndicator.appendChild(this.parent.createElement('div', { className: 'e-right' }));\n            locateElem(copyIndicator, this.copiedInfo.range, this.parent.getActiveSheet(), false);\n            this.parent.getMainContent().appendChild(copyIndicator);\n        }\n    };\n    Clipboard.prototype.showDialog = function () {\n        var _this = this;\n        this.parent.serviceLocator.getService(dialog).show({\n            header: 'Spreadsheet',\n            target: this.parent.element,\n            height: 205, width: 340, isModal: true, showCloseIcon: true,\n            content: this.parent.serviceLocator.getService(locale).getConstant('PasteAlert'),\n            beforeOpen: function (args) {\n                var dlgArgs = {\n                    dialogName: 'PasteDialog',\n                    element: args.element, target: args.target, cancel: args.cancel\n                };\n                _this.parent.trigger('dialogBeforeOpen', dlgArgs);\n                if (dlgArgs.cancel) {\n                    args.cancel = true;\n                }\n            }\n        });\n    };\n    Clipboard.prototype.hidePaste = function (isShow) {\n        if (this.parent.getActiveSheet().isProtected) {\n            isShow = false;\n        }\n        this.parent.notify(enableToolbarItems, [{ items: [this.parent.element.id + '_paste'], enable: isShow || false }]);\n    };\n    Clipboard.prototype.setExternalCells = function (args) {\n        var cell;\n        var text = '';\n        var range = this.copiedInfo.range;\n        var sheet = this.parent.getActiveSheet();\n        var data = '<html><body><table class=\"e-spreadsheet\" xmlns=\"http://www.w3.org/1999/xhtml\"><tbody>';\n        for (var i = range[0]; i <= range[2]; i++) {\n            data += '<tr>';\n            for (var j = range[1]; j <= range[3]; j++) {\n                cell = getCell(i, j, sheet);\n                data += '<td style=\"white-space:' + ((cell && cell.wrap) ? 'normal' : 'nowrap') + ';vertical-align:bottom;';\n                if (cell && cell.style) {\n                    Object.keys(cell.style).forEach(function (style) {\n                        var regex = style.match(/[A-Z]/);\n                        data += (style === 'backgroundColor' ? 'background' : (regex ? style.replace(regex[0], '-'\n                            + regex[0].toLowerCase()) : style)) + ':' + ((style === 'backgroundColor' || style === 'color')\n                            ? cell.style[style].slice(0, 7) : cell.style[style]) + ';';\n                    });\n                }\n                data += '\">';\n                if (cell && cell.value) {\n                    var eventArgs = {\n                        formattedText: cell.value,\n                        value: cell.value,\n                        format: cell.format,\n                        onLoad: true\n                    };\n                    if (cell.format) {\n                        this.parent.notify(getFormattedCellObject, eventArgs);\n                    }\n                    data += eventArgs.formattedText;\n                    text += eventArgs.formattedText;\n                }\n                data += '</td>';\n                text += j === range[3] ? '' : '\\t';\n            }\n            data += '</tr>';\n            text += i === range[2] ? '' : '\\n';\n        }\n        data += '</tbody></table></body></html>';\n        if (Browser.isIE) {\n            /* tslint:disable-next-line */\n            window['clipboardData'].setData('text', text);\n        }\n        else {\n            args.clipboardData.setData('text/html', data);\n            args.clipboardData.setData('text/plain', text);\n            args.preventDefault();\n        }\n    };\n    Clipboard.prototype.getExternalCells = function (args) {\n        var _this = this;\n        var html;\n        var text;\n        var rows = [];\n        var cells = [];\n        var cellStyle;\n        var ele = this.parent.createElement('span');\n        if (Browser.isIE) {\n            /* tslint:disable-next-line */\n            text = window['clipboardData'].getData('text');\n        }\n        else {\n            html = args.clipboardData.getData('text/html');\n            text = args.clipboardData.getData('text/plain');\n            ele.innerHTML = html;\n        }\n        if (ele.querySelector('table')) {\n            if (ele.querySelector('.e-spreadsheet')) {\n                rows = { internal: true };\n            }\n            else {\n                ele.querySelectorAll('tr').forEach(function (tr) {\n                    tr.querySelectorAll('td').forEach(function (td, j) {\n                        td.textContent = td.textContent.replace(/(\\r\\n|\\n|\\r)/gm, '');\n                        var cSpan = isNaN(parseInt(td.getAttribute('colspan'), 10)) ? 1 : parseInt(td.getAttribute('colspan'), 10);\n                        var rSpan = isNaN(parseInt(td.getAttribute('rowspan'), 10)) ? 1 : parseInt(td.getAttribute('rowspan'), 10);\n                        cellStyle = _this.getStyle(td, ele);\n                        cells[j] = { value: td.textContent, style: cellStyle, colSpan: cSpan, rowSpan: rSpan };\n                        if (cellStyle.whiteSpace) {\n                            cells[j].wrap = true;\n                        }\n                    });\n                    rows.push({ cells: cells });\n                    cells = [];\n                });\n            }\n        }\n        else if (text) {\n            if (html) {\n                [].slice.call(ele.children).forEach(function (child) {\n                    if (child.getAttribute('style')) {\n                        cellStyle = _this.getStyle(child, ele);\n                    }\n                });\n            }\n            text.trim().split('\\n').forEach(function (row) {\n                row.split('\\t').forEach(function (col, j) {\n                    cells[j] = { style: cellStyle };\n                    if (cellStyle.whiteSpace) {\n                        cells[j].wrap = true;\n                    }\n                    if (checkIsFormula(col)) {\n                        cells[j].formula = col;\n                    }\n                    else {\n                        cells[j].value = col;\n                    }\n                });\n                rows.push({ cells: cells });\n                cells = [];\n            });\n        }\n        setTimeout(function () { _this.getClipboardEle().innerHTML = ''; }, 0);\n        return rows;\n    };\n    Clipboard.prototype.getStyle = function (td, ele) {\n        var styles = [];\n        var cellStyle = {};\n        if (td.classList.length || td.getAttribute('style')) {\n            if (td.classList.length) {\n                if (ele.querySelector('style').innerHTML.indexOf(td.classList[0]) > -1) {\n                    styles.push(ele.querySelector('style').innerHTML.split(td.classList[0])[1].split('{')[1].split('}')[0]);\n                }\n            }\n            if (td.getAttribute('style')) {\n                styles.push(td.getAttribute('style'));\n            }\n            styles.forEach(function (styles) {\n                styles.split(';').forEach(function (style) {\n                    var char = style.split(':')[0].trim();\n                    if (['font-family', 'vertical-align', 'text-align', 'text-indent', 'color', 'background', 'font-weight', 'font-style',\n                        'font-size', 'text-decoration', 'border-bottom', 'border-top', 'border-right', 'border-left',\n                        'border', 'white-space'].indexOf(char) > -1) {\n                        char = char === 'background' ? 'backgroundColor' : char;\n                        var regex = char.match(/-[a-z]/);\n                        cellStyle[regex ? char.replace(regex[0], regex[0].charAt(1).toUpperCase()) : char] = style.split(':')[1];\n                    }\n                });\n            });\n        }\n        return cellStyle;\n    };\n    Clipboard.prototype.getClipboardEle = function () {\n        return this.parent.element.getElementsByClassName('e-clipboard')[0];\n    };\n    Clipboard.prototype.getModuleName = function () {\n        return 'clipboard';\n    };\n    Clipboard.prototype.destroy = function () {\n        this.removeEventListener();\n        var ele = this.getClipboardEle();\n        detach(ele);\n        this.parent = null;\n    };\n    return Clipboard;\n}());\nexport { Clipboard };\n","import { EventHandler, Browser, closest, isUndefined, isNullOrUndefined, select } from '@syncfusion/ej2-base';\nimport { getRangeIndexes, getRangeFromAddress, getIndexesFromAddress, getRangeAddress, isSingleCell } from '../../workbook/common/address';\nimport { keyDown, editOperation, clearCopy, mouseDown, selectionComplete, enableToolbarItems, completeAction } from '../common/event';\nimport { formulaBarOperation, formulaOperation, setActionData, keyUp, getCellPosition, deleteImage } from '../common/index';\nimport { workbookEditOperation, getFormattedBarText, getFormattedCellObject, wrapEvent, isValidation } from '../../workbook/common/event';\nimport { getSheetName, getSheetIndex, getCell, getColumn } from '../../workbook/base/index';\nimport { getSheetNameFromAddress, getSheet } from '../../workbook/base/index';\nimport { hasTemplate, editAlert } from '../common/index';\nimport { getSwapRange, getCellIndexes, wrap as wrapText, checkIsFormula, dataChanged, isNumber, isLocked } from '../../workbook/index';\nimport { checkConditionalFormat, initiateFormulaReference, initiateCur, clearCellRef, addressHandle } from '../common/event';\nimport { editValue, initiateEdit, forRefSelRender, isFormulaBarEdit, deleteChart } from '../common/event';\n/**\n * The `Protect-Sheet` module is used to handle the Protecting functionalities in Spreadsheet.\n */\nvar Edit = /** @class */ (function () {\n    /**\n     * Constructor for protect-sheet module in Spreadsheet.\n     * @private\n     */\n    function Edit(parent) {\n        this.editorElem = null;\n        this.editCellData = {};\n        this.isEdit = false;\n        this.isCellEdit = true;\n        this.isNewValueEdit = true;\n        this.isAltEnter = false;\n        this.validCharacters = ['+', '-', '*', '/', ',', '(', '=', '&'];\n        this.keyCodes = {\n            BACKSPACE: 8,\n            SPACE: 32,\n            TAB: 9,\n            DELETE: 46,\n            ESC: 27,\n            ENTER: 13,\n            FIRSTALPHABET: 65,\n            LASTALPHABET: 90,\n            FIRSTNUMBER: 48,\n            LASTNUMBER: 59,\n            FIRSTNUMPAD: 96,\n            LASTNUMPAD: 111,\n            SYMBOLSETONESTART: 186,\n            SYMBOLSETONEEND: 192,\n            SYMBOLSETTWOSTART: 219,\n            SYMBOLSETTWOEND: 222,\n            FIREFOXEQUALPLUS: 61,\n            FIREFOXMINUS: 173,\n            F2: 113\n        };\n        this.parent = parent;\n        this.init();\n        //Spreadsheet.Inject(WorkbookEdit);\n    }\n    Edit.prototype.init = function () {\n        this.addEventListener();\n    };\n    /**\n     * To destroy the edit module.\n     * @return {void}\n     * @hidden\n     */\n    Edit.prototype.destroy = function () {\n        this.removeEventListener();\n        this.parent = null;\n        this.editorElem = null;\n    };\n    Edit.prototype.addEventListener = function () {\n        EventHandler.add(this.parent.element, 'dblclick', this.dblClickHandler, this);\n        this.parent.on(mouseDown, this.mouseDownHandler, this);\n        this.parent.on(keyUp, this.keyUpHandler, this);\n        this.parent.on(keyDown, this.keyDownHandler, this);\n        this.parent.on(editOperation, this.performEditOperation, this);\n        this.parent.on(initiateCur, this.initiateCurPosition, this);\n        this.parent.on(editValue, this.updateFormulaBarValue, this);\n        this.parent.on(addressHandle, this.addressHandler, this);\n        this.parent.on(initiateEdit, this.initiateRefSelection, this);\n        this.parent.on(forRefSelRender, this.refSelectionRender, this);\n    };\n    Edit.prototype.removeEventListener = function () {\n        EventHandler.remove(this.parent.element, 'dblclick', this.dblClickHandler);\n        if (!this.parent.isDestroyed) {\n            this.parent.off(mouseDown, this.mouseDownHandler);\n            this.parent.off(keyUp, this.keyUpHandler);\n            this.parent.off(keyDown, this.keyDownHandler);\n            this.parent.off(editOperation, this.performEditOperation);\n            this.parent.off(initiateCur, this.initiateCurPosition);\n            this.parent.off(editValue, this.updateFormulaBarValue);\n            this.parent.off(addressHandle, this.addressHandler);\n            this.parent.off(initiateEdit, this.initiateRefSelection);\n            this.parent.off(forRefSelRender, this.refSelectionRender);\n        }\n    };\n    /**\n     * Get the module name.\n     * @returns string\n     * @private\n     */\n    Edit.prototype.getModuleName = function () {\n        return 'edit';\n    };\n    Edit.prototype.performEditOperation = function (args) {\n        var action = args.action;\n        switch (action) {\n            case 'renderEditor':\n                this.renderEditor();\n                break;\n            case 'refreshEditor':\n                this.refreshEditor(args.value, args.refreshFormulaBar, args.refreshEditorElem, args.isAppend, args.trigEvent);\n                if (args.refreshCurPos) {\n                    this.setCursorPosition();\n                }\n                break;\n            case 'startEdit':\n                if (!this.isEdit) {\n                    this.isNewValueEdit = args.isNewValueEdit;\n                    this.startEdit(args.address, args.value, args.refreshCurPos);\n                }\n                else {\n                    var isEdit = false;\n                    var arg = { isEdit: isEdit };\n                    this.parent.notify(isFormulaBarEdit, arg);\n                    if (arg.isEdit) {\n                        this.isNewValueEdit = args.isNewValueEdit;\n                        this.startEdit(args.address, args.value, args.refreshCurPos);\n                    }\n                }\n                break;\n            case 'endEdit':\n                if (this.isEdit) {\n                    this.endEdit(args.refreshFormulaBar);\n                }\n                break;\n            case 'cancelEdit':\n                if (this.isEdit) {\n                    this.cancelEdit(args.refreshFormulaBar);\n                }\n                break;\n            case 'getCurrentEditValue':\n                args.editedValue = this.editCellData.value;\n                break;\n            case 'refreshDependentCellValue':\n                this.refreshDependentCellValue(args.rowIdx, args.colIdx, args.sheetIdx);\n                break;\n            case 'getPosition':\n                args.position = this.editorElem.getBoundingClientRect();\n                break;\n            case 'focusEditorElem':\n                this.editorElem.focus();\n                break;\n            case 'getCurrentEditSheetIdx':\n                args.sheetIndex = this.editCellData.sheetIndex;\n                break;\n        }\n    };\n    Edit.prototype.keyUpHandler = function (e) {\n        if (this.isEdit) {\n            if (e.altKey && e.keyCode === 13) {\n                var editElement = this.parent.element.querySelector('.e-spreadsheet-edit');\n                editElement.focus();\n                this.altEnter();\n                this.isAltEnter = true;\n            }\n            else if (this.isCellEdit && this.editCellData.value !== this.editorElem.textContent && e.keyCode !== 16) {\n                this.refreshEditor(this.editorElem.textContent, this.isCellEdit);\n            }\n            var isFormulaEdit = checkIsFormula(this.editCellData.value) ||\n                (this.editCellData.value && this.editCellData.value.toString().indexOf('=') === 0);\n            if (isFormulaEdit && e.keyCode !== 16) {\n                var formulaRefIndicator = this.parent.element.querySelector('.e-formularef-indicator');\n                if (formulaRefIndicator) {\n                    formulaRefIndicator.parentElement.removeChild(formulaRefIndicator);\n                }\n                if (this.editCellData.value !== this.editorElem.textContent) {\n                    this.refreshEditor(this.editorElem.textContent, true);\n                }\n                var sheetIdx = this.editCellData.sheetIndex;\n                var editValue_1 = this.editCellData.value;\n                this.parent.notify(initiateFormulaReference, { range: editValue_1, formulaSheetIdx: sheetIdx });\n            }\n        }\n    };\n    Edit.prototype.keyDownHandler = function (e) {\n        var trgtElem = e.target;\n        var keyCode = e.keyCode;\n        var sheet = this.parent.getActiveSheet();\n        var actCell = getCellIndexes(sheet.activeCell);\n        var cell = getCell(actCell[0], actCell[1], sheet) || {};\n        if (!closest(e.target, '.e-findtool-dlg') && !closest(e.target, '.e-validationerror-dlg')) {\n            if (!sheet.isProtected || closest(e.target, '.e-sheet-rename') || !isLocked(cell, getColumn(sheet, actCell[1]))) {\n                if (this.isEdit) {\n                    var isFormulaEdit = checkIsFormula(this.editCellData.value) ||\n                        (this.editCellData.value && this.editCellData.value.toString().indexOf('=') === 0);\n                    if (this.isCellEdit || (isFormulaEdit && this.editCellData.value !== this.editorElem.textContent && e.keyCode !== 16)) {\n                        this.refreshEditor(this.editorElem.textContent, this.isCellEdit);\n                    }\n                    if (!e.altKey) {\n                        switch (keyCode) {\n                            case this.keyCodes.ENTER:\n                                if (Browser.isWindows) {\n                                    e.preventDefault();\n                                }\n                                if (this.isAltEnter) {\n                                    var text = this.parent.element.querySelector('.e-spreadsheet-edit').textContent;\n                                    if (text && text.indexOf('\\n') > -1) {\n                                        wrapText(this.parent.getActiveSheet().selectedRange, true, this.parent);\n                                        this.refreshEditor(this.editorElem.textContent, this.isCellEdit);\n                                        this.isAltEnter = false;\n                                    }\n                                }\n                                if (!isFormulaEdit) {\n                                    this.endEdit(false, e);\n                                }\n                                else {\n                                    var formulaRefIndicator = this.parent.element.querySelector('.e-formularef-indicator');\n                                    if (formulaRefIndicator) {\n                                        formulaRefIndicator.parentElement.removeChild(formulaRefIndicator);\n                                    }\n                                    if (this.editCellData.sheetIndex === sheet.id - 1) {\n                                        this.endEdit(false, e);\n                                    }\n                                    else {\n                                        this.parent.goTo(this.editCellData.fullAddr);\n                                        this.endEdit(false, e);\n                                    }\n                                }\n                                break;\n                            case this.keyCodes.TAB:\n                                if (!this.hasFormulaSuggSelected()) {\n                                    this.endEdit(false, e);\n                                }\n                                break;\n                            case this.keyCodes.ESC:\n                                this.cancelEdit(true, true, e);\n                                break;\n                        }\n                    }\n                }\n                else {\n                    if (!this.isEdit && (trgtElem.classList.contains('e-spreadsheet') || closest(trgtElem, '.e-sheet-panel'))) {\n                        var isAlphabet = (keyCode >= this.keyCodes.FIRSTALPHABET && keyCode <= this.keyCodes.LASTALPHABET);\n                        var isNumeric = (keyCode >= this.keyCodes.FIRSTNUMBER && keyCode <= this.keyCodes.LASTNUMBER);\n                        var isNumpadKeys = (keyCode >= this.keyCodes.FIRSTNUMPAD && keyCode <= this.keyCodes.LASTNUMPAD);\n                        var isSymbolkeys = (keyCode >= this.keyCodes.SYMBOLSETONESTART &&\n                            keyCode <= this.keyCodes.SYMBOLSETONEEND);\n                        if (!isSymbolkeys) {\n                            isSymbolkeys = (keyCode >= this.keyCodes.SYMBOLSETTWOSTART && keyCode <= this.keyCodes.SYMBOLSETTWOEND);\n                        }\n                        var isFirefoxExceptionkeys = (keyCode === this.keyCodes.FIREFOXEQUALPLUS) ||\n                            (keyCode === this.keyCodes.FIREFOXMINUS);\n                        var isF2Edit = (!e.shiftKey && !e.ctrlKey && !e.metaKey && keyCode === this.keyCodes.F2);\n                        var isBackSpace = keyCode === this.keyCodes.BACKSPACE;\n                        if ((!e.ctrlKey && !e.metaKey && !e.altKey && ((!e.shiftKey && keyCode === this.keyCodes.SPACE) || isAlphabet || isNumeric ||\n                            isNumpadKeys || isSymbolkeys || (Browser.info.name === 'mozilla' && isFirefoxExceptionkeys))) || isF2Edit || isBackSpace) {\n                            if (isF2Edit) {\n                                this.isNewValueEdit = false;\n                            }\n                            var pictureElements = document.getElementsByClassName('e-ss-overlay-active');\n                            var pictureLen = pictureElements.length;\n                            if (pictureLen > 0) {\n                                this.parent.notify(deleteImage, {\n                                    id: pictureElements[0].id, sheetIdx: this.parent.activeSheetIndex + 1\n                                });\n                            }\n                            else {\n                                this.startEdit(null, null, true, true);\n                            }\n                        }\n                        if (keyCode === this.keyCodes.DELETE) {\n                            this.isLockCellDelete(e);\n                            this.editingHandler('delete');\n                        }\n                    }\n                }\n            }\n            else {\n                if (((keyCode >= this.keyCodes.FIRSTALPHABET && keyCode <= this.keyCodes.LASTALPHABET) ||\n                    (keyCode >= this.keyCodes.FIRSTNUMBER && keyCode <= this.keyCodes.LASTNUMBER)\n                    || (keyCode === this.keyCodes.DELETE) || (keyCode === this.keyCodes.BACKSPACE) || (keyCode === this.keyCodes.SPACE)\n                    || (keyCode >= this.keyCodes.FIRSTNUMPAD && keyCode <= this.keyCodes.LASTNUMPAD) ||\n                    (keyCode >= this.keyCodes.SYMBOLSETONESTART && keyCode <= this.keyCodes.SYMBOLSETONEEND)\n                    || (keyCode >= 219 && keyCode <= 222) || (!e.shiftKey && !e.ctrlKey && !e.metaKey && keyCode === this.keyCodes.F2))\n                    && (keyCode !== 67) && (keyCode !== 89) && (keyCode !== 90)) {\n                    if (sheet.protectSettings.insertLink && keyCode === 75) {\n                        return;\n                    }\n                    if (!this.parent.element.querySelector('.e-editAlert-dlg')) {\n                        this.parent.notify(editAlert, null);\n                    }\n                }\n            }\n        }\n    };\n    Edit.prototype.isLockCellDelete = function (e) {\n        var sheet = this.parent.getActiveSheet();\n        var count = 0;\n        var address = getRangeIndexes(sheet.selectedRange);\n        for (var row = address[2]; row <= address[0]; row++) {\n            for (var col = address[3]; col <= address[1]; col++) {\n                var cell = getCell(row, col, sheet);\n                if (isLocked(cell, getColumn(sheet, col))) {\n                    e.preventDefault();\n                    count++;\n                }\n            }\n        }\n        if (count > 0) {\n            return;\n        }\n    };\n    Edit.prototype.renderEditor = function () {\n        if (!this.editorElem || !select('#' + this.parent.element.id + '_edit', this.parent.element)) {\n            var editor = void 0;\n            editor = this.parent.createElement('div', { id: this.parent.element.id + '_edit', className: 'e-spreadsheet-edit' });\n            editor.contentEditable = 'true';\n            editor.spellcheck = false;\n            this.editorElem = editor;\n            if (this.parent.element.getElementsByClassName('e-spreadsheet-edit')[0]) {\n                this.parent.element.getElementsByClassName('e-spreadsheet-edit')[0].remove();\n            }\n            this.parent.element.querySelector('.e-sheet-content').appendChild(this.editorElem);\n        }\n        this.parent.notify(formulaOperation, { action: 'renderAutoComplete' });\n    };\n    Edit.prototype.refreshEditor = function (value, refreshFormulaBar, refreshEditorElem, isAppend, trigEvent) {\n        if (trigEvent === void 0) { trigEvent = true; }\n        if (isAppend) {\n            value = this.editCellData.value = this.editCellData.value + value;\n        }\n        else {\n            this.editCellData.value = value;\n        }\n        if (refreshEditorElem) {\n            this.editorElem.textContent = value;\n        }\n        if (refreshFormulaBar) {\n            this.parent.notify(formulaBarOperation, { action: 'refreshFormulabar', value: value });\n        }\n        if (trigEvent && this.editCellData.value === this.editorElem.textContent) {\n            if (this.triggerEvent('cellEditing')) {\n                this.cancelEdit();\n            }\n        }\n        // if (this.editorElem.scrollHeight + 2 <= this.editCellData.element.offsetHeight) {\n        //     this.editorElem.style.height = (this.editCellData.element.offsetHeight + 1) + 'px';\n        // } else {\n        //     this.editorElem.style.removeProperty('height');\n        // }\n    };\n    Edit.prototype.startEdit = function (address, value, refreshCurPos, preventFormulaReference) {\n        if (refreshCurPos === void 0) { refreshCurPos = true; }\n        if (this.parent.showSheetTabs) {\n            this.parent.element.querySelector('.e-add-sheet-tab').setAttribute('disabled', 'true');\n        }\n        var sheet = this.parent.getActiveSheet();\n        var actCell = getCellIndexes(sheet.activeCell);\n        var cell = getCell(actCell[0], actCell[1], sheet) || {};\n        var range = getRangeIndexes(sheet.activeCell);\n        if (hasTemplate(this.parent, range[0], range[1], this.parent.activeSheetIndex)) {\n            var cellEle = this.parent.getCell(range[0], range[1]);\n            var isDelTemplate = false;\n            var value_1 = cellEle.innerHTML;\n            if (cellEle) {\n                if (value_1.indexOf('<') > -1 && value_1.indexOf('>') > -1 && value_1.indexOf('input') > -1) {\n                    isDelTemplate = true;\n                }\n            }\n            if (isDelTemplate) {\n                return;\n            }\n        }\n        this.updateEditCellDetail(address, value);\n        this.initiateEditor(refreshCurPos);\n        this.positionEditor();\n        this.parent.isEdit = this.isEdit = true;\n        this.parent.notify(clearCopy, null);\n        this.parent.notify(enableToolbarItems, [{ enable: false }]);\n        if (cell.formula && !preventFormulaReference) {\n            this.parent.notify(initiateFormulaReference, { range: cell.formula, formulaSheetIdx: this.editCellData.sheetIndex });\n        }\n    };\n    Edit.prototype.setCursorPosition = function () {\n        var elem = this.editorElem;\n        var textLen = elem.textContent.length;\n        if (textLen) {\n            var selection = document.getSelection();\n            var range = document.createRange();\n            range.setStart(elem.firstChild, textLen);\n            range.collapse(true);\n            selection.removeAllRanges();\n            selection.addRange(range);\n        }\n        elem.focus();\n    };\n    Edit.prototype.hasFormulaSuggSelected = function () {\n        var suggDdlElem = document.getElementById(this.parent.element.id + '_ac_popup');\n        return suggDdlElem && suggDdlElem.style.visibility === 'visible' &&\n            suggDdlElem.querySelectorAll('.e-item-focus').length > 0;\n    };\n    Edit.prototype.editingHandler = function (action) {\n        var pictureElements = document.getElementsByClassName('e-ss-overlay-active');\n        var pictureLen = pictureElements.length;\n        switch (action) {\n            case 'delete':\n                if (pictureLen > 0) {\n                    if (pictureElements[0].classList.contains('e-datavisualization-chart')) {\n                        this.parent.notify(deleteChart, {\n                            id: pictureElements[0].id, sheetIdx: this.parent.activeSheetIndex + 1\n                        });\n                    }\n                    else {\n                        this.parent.notify(deleteImage, {\n                            id: pictureElements[0].id, sheetIdx: this.parent.activeSheetIndex + 1\n                        });\n                    }\n                }\n                else {\n                    var address = this.parent.getActiveSheet().selectedRange;\n                    var range = getIndexesFromAddress(address);\n                    range = range[0] > range[2] ? getSwapRange(range) : range;\n                    address = getRangeAddress(range);\n                    this.parent.clearRange(address, null, true);\n                    this.parent.serviceLocator.getService('cell').refreshRange(range);\n                    this.parent.notify(selectionComplete, {});\n                    this.parent.notify(dataChanged, { address: address, sheetIdx: this.parent.activeSheetIndex, action: 'delete' });\n                }\n                break;\n        }\n    };\n    Edit.prototype.mouseDownHandler = function (e) {\n        if (!closest(e.target, '.e-findtool-dlg')) {\n            if (this.isEdit) {\n                var trgtElem = e.target;\n                var sheet = this.parent.getActiveSheet();\n                var formulaRefIndicator = this.parent.element.querySelector('.e-formularef-indicator');\n                this.isCellEdit = trgtElem.classList.contains('e-spreadsheet-edit');\n                var isFormula = checkIsFormula(this.editCellData.value) ||\n                    (this.editCellData.value && this.editCellData.value.toString().indexOf('=') === 0);\n                if (trgtElem.classList.contains('e-cell') || trgtElem.classList.contains('e-header-cell') ||\n                    trgtElem.classList.contains('e-selectall') || closest(trgtElem, '.e-toolbar-item.e-active')) {\n                    if (this.isAltEnter) {\n                        var editText = this.parent.element.querySelector('.e-spreadsheet-edit').textContent;\n                        if (editText && editText.indexOf('\\n') > -1) {\n                            this.isAltEnter = false;\n                            wrapText(this.parent.getActiveSheet().selectedRange, true, this.parent);\n                            this.refreshEditor(this.editorElem.textContent, this.isCellEdit);\n                        }\n                    }\n                    if (!isFormula) {\n                        this.endEdit(false, e);\n                    }\n                    else {\n                        var curPos = window.getSelection().focusOffset;\n                        var actCellIdx = getCellIndexes(sheet.activeCell);\n                        var cell = getCell(actCellIdx[0], actCellIdx[1], sheet);\n                        if (this.editCellData.value === this.editorElem.textContent && (this.editorElem.textContent.indexOf('(') !==\n                            this.editorElem.textContent.length - 1 && this.editorElem.textContent.indexOf('(') !== -1)) {\n                            if (this.editCellData.sheetIndex !== sheet.id - 1) {\n                                var elem = this.parent.element.querySelector('.e-formula-bar');\n                                if (this.editorElem.textContent.substring(elem.selectionEnd - 1, elem.selectionEnd) !== ',' &&\n                                    !e.shiftKey) {\n                                    if (formulaRefIndicator) {\n                                        formulaRefIndicator.parentElement.removeChild(formulaRefIndicator);\n                                    }\n                                    this.parent.goTo(this.editCellData.fullAddr);\n                                    this.endEdit(false, e);\n                                    return;\n                                }\n                            }\n                            else {\n                                if (this.validCharacters.indexOf(this.editorElem.textContent.substring(curPos - 1, curPos)) === -1) {\n                                    if (formulaRefIndicator) {\n                                        formulaRefIndicator.parentElement.removeChild(formulaRefIndicator);\n                                    }\n                                    this.endEdit(false, e);\n                                    return;\n                                }\n                            }\n                        }\n                        if (!cell) {\n                            return;\n                        }\n                        isFormula = cell.formula ?\n                            checkIsFormula(getCell(actCellIdx[0], actCellIdx[1], sheet).formula) ||\n                                (this.editCellData.value && this.editCellData.value.toString().indexOf('=') === 0) : false;\n                        if (isFormula) {\n                            var curPos_1 = window.getSelection().focusOffset;\n                            if (this.editCellData.value.length === curPos_1) {\n                                if (this.editCellData.value.substring(this.editCellData.value.length - 1) === ')' ||\n                                    isNumber(this.editCellData.value.substring(this.editCellData.value.length - 1))) {\n                                    if (formulaRefIndicator) {\n                                        formulaRefIndicator.parentElement.removeChild(formulaRefIndicator);\n                                    }\n                                    this.endEdit(false, e);\n                                }\n                            }\n                            else if (this.editCellData.value === this.editorElem.textContent) {\n                                if ((this.editCellData.value + sheet.selectedRange).substring(curPos_1 - 1, curPos_1) !== ',') {\n                                    if (formulaRefIndicator) {\n                                        formulaRefIndicator.parentElement.removeChild(formulaRefIndicator);\n                                    }\n                                    this.endEdit(false, e);\n                                }\n                                else if (this.editCellData.value.substring(curPos_1) !== ')') {\n                                    if (formulaRefIndicator) {\n                                        formulaRefIndicator.parentElement.removeChild(formulaRefIndicator);\n                                    }\n                                    this.endEdit(false, e);\n                                }\n                            }\n                        }\n                    }\n                }\n                else {\n                    if (isFormula && this.editCellData.value === this.editorElem.textContent && this.editorElem.textContent.indexOf('(') !==\n                        this.editorElem.textContent.length - 1) {\n                        if (this.editCellData.sheetIndex === sheet.id - 1) {\n                            var curPos = window.getSelection().focusOffset;\n                            if (this.validCharacters.indexOf(this.editorElem.textContent.substring(curPos - 1, curPos)) === -1) {\n                                if (formulaRefIndicator) {\n                                    formulaRefIndicator.parentElement.removeChild(formulaRefIndicator);\n                                }\n                                this.parent.goTo(this.editCellData.fullAddr);\n                                this.endEdit(false, e);\n                                return;\n                            }\n                        }\n                    }\n                }\n            }\n        }\n    };\n    Edit.prototype.dblClickHandler = function (e) {\n        var trgtElem = e.target;\n        var sheet = this.parent.getActiveSheet();\n        var actCell = getCellIndexes(sheet.activeCell);\n        var cell = getCell(actCell[0], actCell[1], sheet) || {};\n        if (closest(trgtElem, '.e-datavisualization-chart')) {\n            return;\n        }\n        if (!sheet.isProtected || !isLocked(cell, getColumn(sheet, actCell[1]))) {\n            if ((trgtElem.className.indexOf('e-ss-overlay') < 0) &&\n                (trgtElem.classList.contains('e-active-cell') || trgtElem.classList.contains('e-cell')\n                    || closest(trgtElem, '.e-sheet-content'))) {\n                if (this.isEdit) {\n                    if (checkIsFormula(this.editCellData.value)) {\n                        var sheetName = this.editCellData.fullAddr.substring(0, this.editCellData.fullAddr.indexOf('!'));\n                        if (this.parent.getActiveSheet().name === sheetName) {\n                            this.endEdit();\n                        }\n                    }\n                    else {\n                        this.endEdit();\n                    }\n                }\n                else {\n                    this.isNewValueEdit = false;\n                    this.startEdit();\n                }\n            }\n        }\n        else {\n            if (trgtElem.classList.contains('e-active-cell') || trgtElem.classList.contains('e-cell')) {\n                this.parent.notify(editAlert, null);\n            }\n        }\n    };\n    Edit.prototype.updateEditCellDetail = function (addr, value) {\n        var sheetIdx;\n        var sheet;\n        if (!this.editCellData.sheetIndex) {\n            if (addr && addr.split('!').length > 1) {\n                sheetIdx = getSheetIndex(this.parent, getSheetNameFromAddress(addr));\n            }\n            else {\n                sheetIdx = this.parent.activeSheetIndex;\n            }\n        }\n        if (!this.editCellData.addr) {\n            sheet = getSheet(this.parent, sheetIdx);\n            if (addr) {\n                addr = getRangeFromAddress(addr);\n            }\n            else {\n                addr = sheet.activeCell;\n            }\n        }\n        else if (checkIsFormula(this.editCellData.value)) {\n            sheet = getSheet(this.parent, sheetIdx);\n            this.isNewValueEdit = false;\n        }\n        if (addr) {\n            var range = getRangeIndexes(addr);\n            var rowIdx = range[0];\n            var colIdx = range[1];\n            var cellElem = this.parent.getCell(rowIdx, colIdx);\n            var cellPosition = getCellPosition(sheet, range);\n            this.editCellData = {\n                addr: addr,\n                fullAddr: getSheetName(this.parent, sheetIdx) + '!' + addr,\n                rowIndex: rowIdx,\n                colIndex: colIdx,\n                sheetIndex: sheetIdx,\n                element: cellElem,\n                value: value || '',\n                position: cellPosition\n            };\n        }\n    };\n    Edit.prototype.initiateEditor = function (refreshCurPos) {\n        var _this = this;\n        var data = this.parent.getData(this.editCellData.fullAddr);\n        data.then(function (values) {\n            values.forEach(function (cell, key) {\n                var args = { cell: cell, value: cell ? cell.value : '' };\n                _this.parent.notify(getFormattedBarText, args);\n                var value = cell ? args.value : '';\n                if (cell && cell.formula) {\n                    value = cell.formula;\n                }\n                _this.editCellData.oldValue = value;\n                if (_this.editCellData.value) {\n                    value = _this.editCellData.value;\n                }\n                else {\n                    _this.editCellData.value = value;\n                }\n                if (_this.isNewValueEdit) {\n                    value = '';\n                }\n                else {\n                    _this.isNewValueEdit = true;\n                }\n                if (!isUndefined(value)) {\n                    _this.refreshEditor(value, false, true, false, false);\n                }\n                if (refreshCurPos) {\n                    _this.setCursorPosition();\n                }\n                if (_this.triggerEvent('cellEdit')) {\n                    _this.cancelEdit(true, false);\n                }\n            });\n        });\n    };\n    Edit.prototype.positionEditor = function (isWrap) {\n        var tdElem = this.editCellData.element;\n        var isEdit = false;\n        var cellEle;\n        var arg = { isEdit: isEdit };\n        this.parent.notify(isFormulaBarEdit, arg);\n        if (arg.isEdit && isNullOrUndefined(tdElem)) {\n            cellEle = this.parent.getCell(this.editCellData.rowIndex, this.editCellData.colIndex);\n            tdElem = cellEle;\n            this.editCellData.element = cellEle;\n        }\n        if (tdElem) {\n            tdElem.classList.add('e-ss-edited');\n            var cell = getCell(this.editCellData.rowIndex, this.editCellData.colIndex, this.parent.getActiveSheet());\n            var left = this.editCellData.position.left + 1;\n            var top_1 = this.editCellData.position.top + 1;\n            var minHeight = this.parent.getCell(this.editCellData.rowIndex, this.editCellData.colIndex).offsetHeight - 3;\n            var minWidth = this.editCellData.element.offsetWidth - 3;\n            var mainContElement = this.parent.getMainContent();\n            var editWidth = mainContElement.offsetWidth - left - 28;\n            var height = ((cell && cell.wrap) || (tdElem && isWrap)) ? 'height:auto' : (minHeight) + 'px;';\n            // let editHeight: number = mainContElement.offsetHeight - top - 28;\n            var inlineStyles = 'display:block;top:' + top_1 + 'px;' + (this.parent.enableRtl ? 'right:' : 'left:') + left + 'px;' +\n                'min-width:' + minWidth + 'px;max-width:' + editWidth + 'px;' + 'height:' + height +\n                ((cell && cell.wrap) ? ('width:' + minWidth + 'px;') : '') + 'min-height:' + minHeight + 'px;';\n            inlineStyles += tdElem.style.cssText;\n            this.editorElem.setAttribute('style', inlineStyles);\n            this.parent.element.querySelector('.e-active-cell').style.height =\n                (this.editCellData.element.offsetHeight + 1) + 'px'; // we using edit div height as auto , while editing div enlarges and \n            // hide active cell bottom border for that we increasing 1px height to active cell.\n            if (tdElem.classList.contains('e-right-align')) {\n                this.editorElem.classList.add('e-right-align');\n            }\n            else if (tdElem.classList.contains('e-center-align')) {\n                this.editorElem.classList.add('e-center-align');\n            }\n        }\n    };\n    Edit.prototype.updateEditedValue = function (tdRefresh) {\n        if (tdRefresh === void 0) { tdRefresh = true; }\n        var oldCellValue = this.editCellData.oldValue;\n        var oldValue = oldCellValue ? oldCellValue.toString().toUpperCase() : '';\n        var isValidate = true;\n        var address = this.editCellData.addr;\n        var cellIndex = getRangeIndexes(this.parent.getActiveSheet().activeCell);\n        var sheet = this.parent.getActiveSheet();\n        var cell = getCell(cellIndex[0], cellIndex[1], sheet);\n        /* To set the before cell details for undo redo. */\n        this.parent.notify(setActionData, { args: { action: 'beforeCellSave', eventArgs: { address: this.editCellData.addr } } });\n        if (this.parent.allowDataValidation && cell && cell.validation) {\n            var value = this.parent.element.getElementsByClassName('e-spreadsheet-edit')[0].innerText;\n            var isCell = true;\n            var sheetIdx = this.parent.activeSheetIndex;\n            var range = void 0;\n            if (typeof address === 'string') {\n                range = getRangeIndexes(address);\n            }\n            else {\n                range = address;\n            }\n            this.parent.notify(isValidation, { value: value, range: range, sheetIdx: sheetIdx, isCell: isCell });\n            isValidate = this.parent.allowDataValidation;\n            this.editCellData.value = isValidate ? value : this.editCellData.value;\n            this.parent.allowDataValidation = true;\n        }\n        if ((oldCellValue !== this.editCellData.value || oldValue.indexOf('=RAND()') > -1 || oldValue.indexOf('RAND()') > -1 ||\n            oldValue.indexOf('=RANDBETWEEN(') > -1 || oldValue.indexOf('RANDBETWEEN(') > -1) && isValidate) {\n            var sheet_1 = this.parent.getActiveSheet();\n            var cellIndex_1 = getRangeIndexes(sheet_1.activeCell);\n            this.parent.notify(workbookEditOperation, { action: 'updateCellValue', address: this.editCellData.addr, value: this.editCellData.value });\n            var cell_1 = getCell(cellIndex_1[0], cellIndex_1[1], sheet_1, true);\n            var eventArgs = this.getRefreshNodeArgs(cell_1);\n            this.editCellData.value = eventArgs.value;\n            if (cell_1 && cell_1.formula) {\n                this.editCellData.formula = cell_1.formula;\n            }\n            if (cell_1.wrap) {\n                this.parent.notify(wrapEvent, { range: cellIndex_1, wrap: true, sheet: sheet_1 });\n            }\n            if (tdRefresh) {\n                this.parent.refreshNode(this.editCellData.element, eventArgs);\n            }\n        }\n        if (this.parent.allowConditionalFormat) {\n            this.parent.notify(checkConditionalFormat, { rowIdx: cellIndex[0], colIdx: cellIndex[1], cell: cell });\n        }\n        return isValidate;\n    };\n    Edit.prototype.refreshDependentCellValue = function (rowIdx, colIdx, sheetIdx) {\n        if (rowIdx && colIdx) {\n            rowIdx--;\n            colIdx--;\n            if ((this.editCellData.rowIndex !== rowIdx || this.editCellData.colIndex !== colIdx)\n                && this.parent.activeSheetIndex === sheetIdx) {\n                var td = this.parent.getCell(rowIdx, colIdx);\n                if (td) {\n                    var sheet = getSheet(this.parent, sheetIdx);\n                    var cell = getCell(rowIdx, colIdx, sheet);\n                    var eventArgs = this.getRefreshNodeArgs(cell);\n                    this.parent.refreshNode(td, eventArgs);\n                }\n            }\n        }\n    };\n    Edit.prototype.getRefreshNodeArgs = function (cell) {\n        cell = cell ? cell : {};\n        var fCode = (cell && cell.format) ? cell.format : '';\n        var eventArgs = {\n            value: cell.value, format: fCode, onLoad: true,\n            formattedText: '', isRightAlign: false, type: 'General'\n        };\n        var args;\n        this.parent.notify(getFormattedCellObject, eventArgs);\n        eventArgs.formattedText = this.parent.allowNumberFormatting ? eventArgs.formattedText : eventArgs.value;\n        args = {\n            isRightAlign: eventArgs.isRightAlign,\n            result: eventArgs.formattedText,\n            type: eventArgs.type,\n            value: eventArgs.value,\n            curSymbol: eventArgs.curSymbol\n        };\n        return args;\n    };\n    Edit.prototype.endEdit = function (refreshFormulaBar, event) {\n        if (refreshFormulaBar === void 0) { refreshFormulaBar = false; }\n        var sheet = this.parent.getActiveSheet();\n        var actCell = getCellIndexes(sheet.activeCell);\n        var cell = this.parent.getCell(actCell[0], actCell[1]);\n        var fSize = '';\n        if (this.editCellData.element.children[0] && this.editCellData.element.children[0].className === 'e-cf-databar') {\n            fSize = cell.children[0].querySelector('.e-databar-value').style.fontSize;\n        }\n        if (refreshFormulaBar) {\n            this.refreshEditor(this.editCellData.oldValue, false, true, false, false);\n        }\n        if (this.triggerEvent('beforeCellSave')) {\n            event.preventDefault();\n            return;\n        }\n        var isValidate = this.updateEditedValue();\n        if (isValidate) {\n            this.triggerEvent('cellSave', event);\n            this.resetEditState();\n            this.focusElement();\n        }\n        else if (event) {\n            event.preventDefault();\n        }\n        if (fSize !== '') {\n            cell.children[0].querySelector('.e-databar-value').style.fontSize = fSize;\n        }\n        if (this.parent.showSheetTabs) {\n            this.parent.element.querySelector('.e-add-sheet-tab').removeAttribute('disabled');\n        }\n    };\n    Edit.prototype.cancelEdit = function (refreshFormulaBar, trigEvent, event) {\n        if (refreshFormulaBar === void 0) { refreshFormulaBar = true; }\n        if (trigEvent === void 0) { trigEvent = true; }\n        this.refreshEditor(this.editCellData.oldValue, refreshFormulaBar, false, false, false);\n        if (trigEvent) {\n            this.triggerEvent('cellSave', event);\n        }\n        this.resetEditState();\n        this.focusElement();\n    };\n    Edit.prototype.focusElement = function () {\n        this.parent.element.focus();\n        this.parent.notify(enableToolbarItems, [{ enable: true }]);\n    };\n    Edit.prototype.triggerEvent = function (eventName, event) {\n        var cell = getCell(this.editCellData.rowIndex, this.editCellData.colIndex, this.parent.getActiveSheet());\n        var eventArgs = {\n            element: this.editCellData.element,\n            value: this.editCellData.value,\n            oldValue: this.editCellData.oldValue,\n            address: this.editCellData.fullAddr,\n            displayText: this.parent.getDisplayText(cell)\n        };\n        if (eventName === 'cellSave') {\n            if (this.editCellData.formula) {\n                eventArgs.formula = this.editCellData.formula;\n            }\n            eventArgs.originalEvent = event;\n            this.parent.notify(dataChanged, eventArgs);\n            this.parent.notify(completeAction, { eventArgs: eventArgs, action: 'cellSave' });\n        }\n        if (eventName !== 'cellSave') {\n            eventArgs.cancel = false;\n        }\n        this.parent.trigger(eventName, eventArgs);\n        return eventArgs.cancel;\n    };\n    Edit.prototype.altEnter = function () {\n        this.positionEditor(true);\n        var text;\n        var textBefore;\n        var textAfter;\n        var selection = window.getSelection();\n        var node = selection.anchorNode;\n        var offset;\n        var range = document.createRange();\n        offset = (node.nodeType === 3) ? selection.anchorOffset : node.textContent.length;\n        if (offset === 0 && node.textContent.length > 0) {\n            offset = node.textContent.length;\n        }\n        text = node.textContent;\n        textBefore = text.slice(0, offset);\n        textAfter = text.slice(offset) || ' ';\n        node.textContent = textBefore + '\\n' + textAfter;\n        range = document.createRange();\n        if (node.nodeType === 3) {\n            range.setStart(node, offset + 1);\n            range.setEnd(node, offset + 1);\n        }\n        else if (node.nodeType === 1) {\n            range.setStart(node.firstChild, offset + 1);\n            range.setEnd(node.firstChild, offset + 1);\n        }\n        selection.removeAllRanges();\n        selection.addRange(range);\n    };\n    Edit.prototype.resetEditState = function (elemRefresh) {\n        if (elemRefresh === void 0) { elemRefresh = true; }\n        if (elemRefresh) {\n            if (checkIsFormula(this.editorElem.textContent)) {\n                this.parent.notify(clearCellRef, null);\n            }\n            if (this.editCellData.element) {\n                this.editCellData.element.classList.remove('e-ss-edited');\n                this.editorElem.textContent = '';\n                this.editorElem.removeAttribute('style');\n                this.editorElem.classList.remove('e-right-align');\n            }\n        }\n        this.editCellData = {};\n        this.parent.isEdit = this.isEdit = false;\n        this.isCellEdit = true;\n        this.parent.notify(formulaOperation, { action: 'endEdit' });\n    };\n    Edit.prototype.refSelectionRender = function () {\n        if (this.editorElem) {\n            if (checkIsFormula(this.editorElem.textContent)) {\n                this.parent.notify(initiateFormulaReference, {\n                    range: this.editorElem.textContent, formulaSheetIdx: this.editCellData.sheetIndex\n                });\n            }\n        }\n    };\n    // Start edit the formula cell and set cursor position\n    Edit.prototype.initiateRefSelection = function () {\n        var sheetName = this.editCellData.fullAddr.substring(0, this.editCellData.fullAddr.indexOf('!'));\n        var value = this.parent.element.querySelector('.e-formula-bar').value;\n        if (this.parent.getActiveSheet().name === sheetName && checkIsFormula(this.editCellData.value)) {\n            this.startEdit(this.editCellData.addr, value, false);\n            this.parent.notify(initiateFormulaReference, {\n                range: this.editCellData.value, formulaSheetIdx: this.editCellData.sheetIndex\n            });\n            this.parent.element.querySelector('.e-spreadsheet-edit').innerHTML = value;\n            this.initiateCurPosition();\n        }\n        else {\n            this.initiateCurPosition();\n        }\n    };\n    Edit.prototype.addressHandler = function (args) {\n        var eventArgs = { action: 'getCurrentEditValue', editedValue: '' };\n        this.parent.notify(editOperation, eventArgs);\n        var address = args.range;\n        var sheetName = this.editCellData.fullAddr.substring(0, this.editCellData.fullAddr.indexOf('!'));\n        var sheetIdx = this.editCellData.sheetIndex;\n        var editorEle = this.parent.element.querySelector('.e-spreadsheet-edit');\n        if (this.parent.getActiveSheet().name !== sheetName) {\n            address = '\\'' + this.parent.getActiveSheet().name + '\\'' + '!' + address;\n        }\n        if (args.isSelect) {\n            this.parent.notify(initiateFormulaReference, { range: eventArgs.editedValue + address, formulaSheetIdx: sheetIdx });\n        }\n        else {\n            var editedValue = eventArgs.editedValue;\n            if (editedValue.indexOf(')') === editedValue.length - 1) {\n                editorEle.textContent = editedValue.substring(0, editedValue.length - 1)\n                    + address + editedValue.substring(editedValue.length - 1);\n            }\n            else {\n                editorEle.textContent = editedValue + address;\n            }\n        }\n    };\n    Edit.prototype.updateFormulaBarValue = function () {\n        var value = this.editCellData.value;\n        var address = this.parent.getActiveSheet().selectedRange;\n        address = isSingleCell(getIndexesFromAddress(address)) ? address.split(':')[0] : address;\n        var formulaBar = this.parent.element.querySelector('.e-formula-bar');\n        if (value && checkIsFormula(value)) {\n            var sheetName = this.editCellData.fullAddr.substring(0, this.editCellData.fullAddr.indexOf('!'));\n            if (this.parent.getActiveSheet().name !== sheetName) {\n                address = '\\'' + this.parent.getActiveSheet().name + '\\'' + '!' + address;\n            }\n            if (value.indexOf(')') === value.length - 1) {\n                formulaBar.value = value.substring(0, value.length - 1) + address + value.substring(value.length - 1);\n            }\n            else {\n                formulaBar.value = value + address;\n            }\n        }\n    };\n    Edit.prototype.setFormulaBarCurPosition = function (input, selectionStart, selectionEnd) {\n        if (input.setSelectionRange) {\n            input.focus();\n            input.selectionStart = selectionStart;\n            input.selectionEnd = selectionStart;\n            input.setSelectionRange(selectionStart, selectionEnd);\n        }\n    };\n    Edit.prototype.initiateCurPosition = function () {\n        var el = this.parent.element.querySelector('.e-spreadsheet-edit');\n        if (el.innerText) {\n            var range = document.createRange();\n            if (el.innerText.indexOf(')') === el.innerText.length - 1) {\n                range.setStart(el.childNodes[0], el.innerText.length - 1);\n                range.setEnd(el.childNodes[0], el.innerText.length - 1);\n            }\n            else {\n                range.setStart(el.childNodes[0], el.innerText.length);\n                range.setEnd(el.childNodes[0], el.innerText.length);\n            }\n            var selection = window.getSelection();\n            selection.removeAllRanges();\n            selection.addRange(range);\n        }\n        var sheetIdx = this.editCellData.sheetIndex;\n        if (sheetIdx !== this.parent.getActiveSheet().id - 1) {\n            var elem = this.parent.element.querySelector('.e-formula-bar');\n            if (elem.value) {\n                var valueLength = elem.value.length;\n                if (elem.value.indexOf(')') === valueLength - 1) {\n                    this.setFormulaBarCurPosition(elem, valueLength - 1, valueLength - 1);\n                }\n                else {\n                    this.setFormulaBarCurPosition(elem, valueLength, valueLength);\n                }\n            }\n        }\n    };\n    return Edit;\n}());\nexport { Edit };\n","import { contentLoaded, mouseDown, virtualContentLoaded, cellNavigate, getUpdateUsingRaf, focusBorder } from '../common/index';\nimport { showAggregate, refreshImgElem, getRowIdxFromClientY, getColIdxFromClientX, clearChartBorder } from '../common/index';\nimport { getColumnsWidth, updateSelectedRange, getColumnWidth, mergedRange, activeCellMergedRange } from '../../workbook/index';\nimport { getRowHeight, isSingleCell, activeCellChanged, checkIsFormula, getSheetIndex } from '../../workbook/index';\nimport { EventHandler, addClass, removeClass, isNullOrUndefined, Browser, closest } from '@syncfusion/ej2-base';\nimport { selectionComplete, getMoveEvent, getEndEvent, isTouchStart, locateElem } from '../common/index';\nimport { isTouchEnd, isTouchMove, getClientX, getClientY, mouseUpAfterSelection, selectRange, rowHeightChanged } from '../common/index';\nimport { colWidthChanged, protectSelection, editOperation, initiateFormulaReference, initiateCur, clearCellRef } from '../common/index';\nimport { getRangeIndexes, getCellAddress, getRangeAddress, getCellIndexes, getSwapRange } from '../../workbook/common/address';\nimport { addressHandle } from '../common/index';\nimport { isCellReference } from '../../workbook/index';\nimport { getIndexesFromAddress } from '../../workbook/common/address';\n/**\n * Represents selection support for Spreadsheet.\n */\nvar Selection = /** @class */ (function () {\n    /**\n     * Constructor for the Spreadsheet selection module.\n     * @private\n     */\n    function Selection(parent) {\n        this.uniqueOBracket = String.fromCharCode(129);\n        this.uniqueCBracket = String.fromCharCode(130);\n        this.uniqueCSeparator = String.fromCharCode(131);\n        this.uniqueCOperator = String.fromCharCode(132);\n        this.uniquePOperator = String.fromCharCode(133);\n        this.uniqueSOperator = String.fromCharCode(134);\n        this.uniqueMOperator = String.fromCharCode(135);\n        this.uniqueDOperator = String.fromCharCode(136);\n        this.uniqueModOperator = String.fromCharCode(137);\n        this.uniqueConcateOperator = String.fromCharCode(138);\n        this.uniqueEqualOperator = String.fromCharCode(139);\n        this.uniqueExpOperator = String.fromCharCode(140);\n        this.uniqueGTOperator = String.fromCharCode(141);\n        this.uniqueLTOperator = String.fromCharCode(142);\n        this.invalidOperators = ['%'];\n        this.formulaRange = [];\n        this.tableRangesFormula = {};\n        this.parent = parent;\n        this.addEventListener();\n        this.mouseMoveEvt = this.mouseMoveHandler.bind(this);\n    }\n    Selection.prototype.addEventListener = function () {\n        this.parent.on(contentLoaded, this.init, this);\n        this.parent.on(mouseDown, this.mouseDownHandler, this);\n        this.parent.on(virtualContentLoaded, this.virtualContentLoadedHandler, this);\n        this.parent.on(cellNavigate, this.cellNavigateHandler, this);\n        this.parent.on(selectRange, this.selectRange, this);\n        this.parent.on(rowHeightChanged, this.rowHeightChanged, this);\n        this.parent.on(colWidthChanged, this.colWidthChanged, this);\n        this.parent.on(protectSelection, this.protectHandler, this);\n        this.parent.on(initiateFormulaReference, this.initiateFormulaSelection, this);\n        this.parent.on(clearCellRef, this.clearBorder, this);\n        this.parent.on(getRowIdxFromClientY, this.getRowIdxFromClientY, this);\n        this.parent.on(getColIdxFromClientX, this.getColIdxFromClientX, this);\n        this.parent.on(focusBorder, this.chartBorderHandler, this);\n    };\n    Selection.prototype.removeEventListener = function () {\n        if (!this.parent.isDestroyed) {\n            this.parent.off(contentLoaded, this.init);\n            this.parent.off(mouseDown, this.mouseDownHandler);\n            this.parent.off(virtualContentLoaded, this.virtualContentLoadedHandler);\n            this.parent.off(cellNavigate, this.cellNavigateHandler);\n            this.parent.off(selectRange, this.selectRange);\n            this.parent.off(rowHeightChanged, this.rowHeightChanged);\n            this.parent.off(colWidthChanged, this.colWidthChanged);\n            this.parent.off(protectSelection, this.protectHandler);\n            this.parent.off(initiateFormulaReference, this.initiateFormulaSelection);\n            this.parent.off(clearCellRef, this.clearBorder);\n            this.parent.off(getRowIdxFromClientY, this.getRowIdxFromClientY);\n            this.parent.off(getColIdxFromClientX, this.getColIdxFromClientX);\n            this.parent.off(focusBorder, this.chartBorderHandler);\n        }\n    };\n    Selection.prototype.rowHeightChanged = function (args) {\n        var _this = this;\n        getUpdateUsingRaf(function () {\n            var ele = _this.getActiveCell();\n            var cellIndex = getCellIndexes(_this.parent.getActiveSheet().activeCell)[0];\n            if (cellIndex === args.rowIdx && ele) {\n                ele.style.height = parseInt(ele.style.height, 10) + args.threshold + \"px\";\n            }\n            else if (cellIndex > args.rowIdx && ele) {\n                ele.style.top = parseInt(ele.style.top, 10) + args.threshold + \"px\";\n            }\n            ele = _this.getSelectionElement();\n            if (ele) {\n                var selectedRange = getRangeIndexes(_this.parent.getActiveSheet().selectedRange);\n                var sRange = getSwapRange(selectedRange);\n                var rowStart = sRange[0];\n                var rowEnd = sRange[2];\n                if (rowStart <= args.rowIdx && rowEnd >= args.rowIdx && ele) {\n                    ele.style.height = parseInt(ele.style.height, 10) + args.threshold + \"px\";\n                }\n                else if (rowStart > args.rowIdx && ele) {\n                    ele.style.top = parseInt(ele.style.top, 10) + args.threshold + \"px\";\n                }\n            }\n        });\n    };\n    Selection.prototype.colWidthChanged = function (args) {\n        var _this = this;\n        getUpdateUsingRaf(function () {\n            var ele = _this.getActiveCell();\n            var cellIndex = getCellIndexes(_this.parent.getActiveSheet().activeCell)[1];\n            if (cellIndex === args.colIdx && ele) {\n                ele.style.width = parseInt(ele.style.width, 10) + args.threshold + \"px\";\n            }\n            else if (cellIndex > args.colIdx && ele) {\n                ele.style.left = parseInt(ele.style.left, 10) + args.threshold + \"px\";\n            }\n            ele = _this.getSelectionElement();\n            var selectedRange = getRangeIndexes(_this.parent.getActiveSheet().selectedRange);\n            var sRange = getSwapRange(selectedRange);\n            var colStart = sRange[1];\n            var colEnd = sRange[3];\n            if (colStart <= args.colIdx && colEnd >= args.colIdx && ele) {\n                ele.style.width = parseInt(ele.style.width, 10) + args.threshold + \"px\";\n            }\n            else if (colStart > args.colIdx && ele) {\n                ele.style.left = parseInt(ele.style.left, 10) + args.threshold + \"px\";\n            }\n        });\n    };\n    Selection.prototype.selectRange = function (args) {\n        this.selectRangeByIdx(this.parent.selectionSettings.mode === 'Single' ? args.indexes.slice(0, 2).concat(args.indexes.slice(0, 2)) : args.indexes, null, null, null, null, args.skipChecking);\n    };\n    Selection.prototype.init = function () {\n        var isInit = true;\n        var sheet = this.parent.getActiveSheet();\n        var range = getRangeIndexes(this.parent.getActiveSheet().selectedRange);\n        var sRange = getSwapRange(range);\n        var actRange = getCellIndexes(this.parent.getActiveSheet().activeCell);\n        var inRange = sRange[0] <= actRange[0] && sRange[2] >= actRange[0] && sRange[1] <= actRange[1]\n            && sRange[3] >= actRange[1];\n        this.createSelectionElement();\n        this.selectRangeByIdx(range, null, null, inRange, isInit);\n    };\n    Selection.prototype.createSelectionElement = function () {\n        var cont = this.parent.getMainContent();\n        var ele = this.parent.createElement('div', { className: 'e-selection' });\n        var activeCell = this.parent.createElement('div', { className: 'e-active-cell' });\n        cont.appendChild(ele);\n        cont.appendChild(activeCell);\n    };\n    Selection.prototype.mouseDownHandler = function (e) {\n        var eventArgs = { action: 'getCurrentEditValue', editedValue: '' };\n        this.parent.notify(editOperation, eventArgs);\n        var isFormulaEdit = (eventArgs.editedValue && eventArgs.editedValue.toString().indexOf('=') === 0) ||\n            checkIsFormula(eventArgs.editedValue);\n        if (!this.parent.isEdit || isFormulaEdit) {\n            var overlayElem = document.getElementById(this.parent.element.id + '_overlay');\n            if (typeof (e.target.className) === 'string') {\n                if (e.target.className.indexOf('e-ss-overlay') > -1) {\n                    return;\n                }\n            }\n            else if (overlayElem) {\n                overlayElem.classList.remove('e-ss-overlay-active');\n            }\n            if (closest(e.target, '.e-datavisualization-chart')) {\n                return;\n            }\n            if (this.parent.getActiveSheet().isProtected && !this.parent.getActiveSheet().protectSettings.selectCells) {\n                return;\n            }\n            if (!closest(e.target, '.e-findtool-dlg')) {\n                if (this.getSheetElement().contains(e.target) && !e.target.classList.contains('e-colresize')\n                    && !e.target.classList.contains('e-rowresize')) {\n                    var sheet = this.parent.getActiveSheet();\n                    var mode = this.parent.selectionSettings.mode;\n                    var rowIdx = this.getRowIdxFromClientY({ clientY: getClientY(e) });\n                    var colIdx = this.getColIdxFromClientX({ clientX: getClientX(e) });\n                    var activeIdx = getCellIndexes(sheet.activeCell);\n                    var isRowSelected = sheet.showHeaders && this.parent.getRowHeaderContent().contains(e.target);\n                    var isColSelected = sheet.showHeaders && this.parent.getColumnHeaderContent().contains(e.target);\n                    if (e.which === 3 && this.isSelected(rowIdx, colIdx)) {\n                        return;\n                    }\n                    if (mode === 'Multiple' && (!isTouchEnd(e) && (!isTouchStart(e) ||\n                        (isTouchStart(e) && activeIdx[0] === rowIdx && activeIdx[1] === colIdx)) || isColSelected || isRowSelected)) {\n                        document.addEventListener(getMoveEvent().split(' ')[0], this.mouseMoveEvt);\n                        if (!Browser.isPointer) {\n                            document.addEventListener(getMoveEvent().split(' ')[1], this.mouseMoveEvt, { passive: false });\n                        }\n                    }\n                    if (!isTouchEnd(e)) {\n                        EventHandler.add(document, getEndEvent(), this.mouseUpHandler, this);\n                    }\n                    if (isTouchStart(e) && !(isColSelected || isRowSelected)) {\n                        this.touchEvt = e;\n                        return;\n                    }\n                    if (isRowSelected) {\n                        this.isRowSelected = true;\n                        if (!e.shiftKey || mode === 'Single') {\n                            this.startCell = [rowIdx, 0];\n                        }\n                        this.selectRangeByIdx([this.startCell[0], 0, rowIdx, sheet.colCount - 1], e);\n                    }\n                    else if (isColSelected) {\n                        this.isColSelected = true;\n                        if (!e.shiftKey || mode === 'Single') {\n                            this.startCell = [0, colIdx];\n                        }\n                        this.selectRangeByIdx([0, this.startCell[1], sheet.rowCount - 1, colIdx], e);\n                    }\n                    else if (e.target.classList.contains('e-selectall')) {\n                        this.startCell = [0, 0];\n                        this.selectRangeByIdx([].concat(this.startCell, [sheet.rowCount - 1, sheet.colCount - 1]), e);\n                    }\n                    else if (!e.target.classList.contains('e-sheet-content')) {\n                        if (!e.shiftKey || mode === 'Single') {\n                            this.startCell = [rowIdx, colIdx];\n                        }\n                        this.selectRangeByIdx([].concat(this.startCell ? this.startCell : getCellIndexes(sheet.activeCell), [rowIdx, colIdx]), e);\n                    }\n                    if (this.parent.isMobileView()) {\n                        this.parent.element.classList.add('e-mobile-focused');\n                        this.parent.renderModule.setSheetPanelSize();\n                    }\n                }\n            }\n        }\n        if (isFormulaEdit && (e.target.classList.contains('e-cell') ||\n            e.target.classList.contains('e-header-cell')) && this.parent.isEdit) {\n            var range = this.parent.getActiveSheet().selectedRange;\n            range = isSingleCell(getIndexesFromAddress(range)) ? range.split(':')[0] : range;\n            this.parent.notify(addressHandle, { range: range, isSelect: false });\n        }\n    };\n    Selection.prototype.mouseMoveHandler = function (e) {\n        var _this = this;\n        var sheet = this.parent.getActiveSheet();\n        if (isTouchMove(e)) {\n            e.preventDefault();\n        }\n        var eventArgs = { action: 'getCurrentEditValue', editedValue: '' };\n        this.parent.notify(editOperation, eventArgs);\n        var isFormulaEdit = checkIsFormula(eventArgs.editedValue) ||\n            (eventArgs.editedValue && eventArgs.editedValue.toString().indexOf('=') === 0);\n        var cont = this.getScrollContent();\n        var clientRect = cont.getBoundingClientRect();\n        var clientX = getClientX(e);\n        var clientY = getClientY(e);\n        // remove math.min or handle top and left auto scroll\n        var colIdx = this.isRowSelected ? sheet.colCount - 1 :\n            this.getColIdxFromClientX({ clientX: Math.min(clientX, clientRect.right) });\n        var rowIdx = this.isColSelected ? sheet.rowCount - 1 :\n            this.getRowIdxFromClientY({ clientY: Math.min(clientY, clientRect.bottom) });\n        var prevIndex = getRangeIndexes(sheet.selectedRange);\n        var mergeArgs = { range: [rowIdx, colIdx, rowIdx, colIdx] };\n        this.parent.notify(activeCellMergedRange, mergeArgs);\n        if (mergeArgs.range[2] === prevIndex[2] && mergeArgs.range[3] === prevIndex[3]) {\n            return;\n        }\n        var isScrollDown = clientY > clientRect.bottom && rowIdx < sheet.rowCount;\n        var isScrollUp = clientY < clientRect.top && rowIdx >= 0 && !this.isColSelected;\n        var isScrollRight = clientX > clientRect.right && colIdx < sheet.colCount;\n        var isScrollLeft = clientX < clientRect.left && colIdx >= 0 && !this.isRowSelected;\n        this.clearInterval();\n        if (!isFormulaEdit && !this.isColSelected && !this.isRowSelected) {\n            prevIndex = getCellIndexes(sheet.activeCell);\n        }\n        if (isScrollDown || isScrollUp || isScrollRight || isScrollLeft) {\n            this.scrollInterval = setInterval(function () {\n                if ((isScrollDown || isScrollUp) && !_this.isColSelected) {\n                    rowIdx = _this.getRowIdxFromClientY({ clientY: isScrollDown ? clientRect.bottom : clientRect.top });\n                    if (rowIdx >= sheet.rowCount) { // clear interval when scroll up\n                        _this.clearInterval();\n                        return;\n                    }\n                    cont.scrollTop += (isScrollDown ? 1 : -1) * getRowHeight(sheet, rowIdx);\n                }\n                if ((isScrollRight || isScrollLeft) && !_this.isRowSelected) {\n                    colIdx = _this.getColIdxFromClientX({ clientX: isScrollRight ? clientRect.right : clientRect.left });\n                    if (colIdx >= sheet.colCount) { // clear interval when scroll left\n                        _this.clearInterval();\n                        return;\n                    }\n                    cont.scrollLeft += (isScrollRight ? 1 : -1) * getColumnWidth(sheet, colIdx);\n                }\n                _this.selectRangeByIdx([].concat(prevIndex[0], prevIndex[1], [rowIdx, colIdx]), e);\n                // tslint:disable-next-line\n            }, 100);\n        }\n        else {\n            this.selectRangeByIdx([].concat(prevIndex[0], prevIndex[1], [rowIdx, colIdx]), e);\n        }\n        if (isFormulaEdit && this.parent.isEdit) {\n            var range = this.parent.getActiveSheet().selectedRange;\n            this.parent.notify(addressHandle, { range: range, isSelect: false });\n        }\n    };\n    Selection.prototype.mouseUpHandler = function (e) {\n        var rowIdx = this.getRowIdxFromClientY({ clientY: getClientY(e) });\n        var colIdx = this.getColIdxFromClientX({ clientX: getClientX(e) });\n        this.clearInterval();\n        if (isTouchEnd(e) && !(this.isColSelected || this.isRowSelected) &&\n            (this.getRowIdxFromClientY({ clientY: getClientY(this.touchEvt) }) === rowIdx &&\n                this.getColIdxFromClientX({ clientX: getClientX(this.touchEvt) }) === colIdx)) {\n            this.mouseDownHandler(e);\n        }\n        this.parent.trigger('select', { range: this.parent.getActiveSheet().selectedRange });\n        document.removeEventListener(getMoveEvent().split(' ')[0], this.mouseMoveEvt);\n        if (!Browser.isPointer) {\n            document.removeEventListener(getMoveEvent().split(' ')[1], this.mouseMoveEvt);\n        }\n        EventHandler.remove(document, getEndEvent(), this.mouseUpHandler);\n        this.parent.notify(mouseUpAfterSelection, e);\n        var eventArgs = { action: 'getCurrentEditValue', editedValue: '' };\n        this.parent.notify(editOperation, eventArgs);\n        var isFormulaEdit = checkIsFormula(eventArgs.editedValue) ||\n            (eventArgs.editedValue && eventArgs.editedValue.toString().indexOf('=') === 0);\n        if (isFormulaEdit && this.parent.isEdit && !e.target.classList.contains('e-spreadsheet-edit')) {\n            this.parent.notify(initiateCur, {});\n        }\n    };\n    Selection.prototype.isSelected = function (rowIdx, colIdx) {\n        var indexes = getSwapRange(getRangeIndexes(this.parent.getActiveSheet().selectedRange));\n        return indexes[0] <= rowIdx && rowIdx <= indexes[2] && indexes[1] <= colIdx && colIdx <= indexes[3];\n    };\n    Selection.prototype.virtualContentLoadedHandler = function () {\n        var sheet = this.parent.getActiveSheet();\n        var indexes = getRangeIndexes(sheet.selectedRange);\n        if (this.isColSelected && this.isRowSelected) {\n            this.selectRangeByIdx([0, 0, sheet.rowCount - 1, sheet.colCount - 1], null, true);\n        }\n        else if (this.isColSelected) {\n            this.selectRangeByIdx([0, indexes[1], sheet.rowCount - 1, indexes[3]], null, true);\n        }\n        else if (this.isRowSelected) {\n            this.selectRangeByIdx([indexes[0], 0, indexes[2], sheet.colCount - 1], null, true);\n        }\n        else {\n            this.highlightHdr(indexes, indexes[0] >= this.parent.viewport.topIndex || indexes[2] >= this.parent.viewport.topIndex, indexes[1] >= this.parent.viewport.leftIndex || indexes[3] >= this.parent.viewport.leftIndex);\n        }\n    };\n    Selection.prototype.clearInterval = function () {\n        clearInterval(this.scrollInterval);\n        this.scrollInterval = null;\n    };\n    Selection.prototype.getScrollContent = function () {\n        return this.parent.getMainContent();\n    };\n    Selection.prototype.getScrollLeft = function () {\n        return this.parent.scrollModule ? this.parent.scrollModule.prevScroll.scrollLeft : 0;\n    };\n    Selection.prototype.cellNavigateHandler = function (args) {\n        var sheet = this.parent.getActiveSheet();\n        if (sheet.isProtected && !sheet.protectSettings.selectCells) {\n            return;\n        }\n        this.selectRangeByIdx(args.range.concat(args.range));\n    };\n    Selection.prototype.getColIdxFromClientX = function (args) {\n        var width = 0;\n        var sheet = this.parent.getActiveSheet();\n        var cliRect = this.parent.getMainContent().getBoundingClientRect();\n        var left = 0;\n        left = (args.isImage) ? args.clientX : (this.parent.enableRtl ? (cliRect.right - args.clientX) :\n            (args.clientX - cliRect.left)) + this.getScrollLeft();\n        for (var i = 0;; i++) {\n            width += getColumnsWidth(sheet, i);\n            if (left < width) {\n                args.clientX = i;\n                return i;\n            }\n        }\n    };\n    Selection.prototype.getRowIdxFromClientY = function (args) {\n        var height = 0;\n        var sheet = this.parent.getActiveSheet();\n        var top = 0;\n        top = args.isImage ? args.clientY : (args.clientY - this.parent.getMainContent().getBoundingClientRect().top)\n            + this.parent.getMainContent().scrollTop;\n        for (var i = 0;; i++) {\n            height += getRowHeight(sheet, i);\n            if (top < height) {\n                args.clientY = i;\n                return i;\n            }\n        }\n    };\n    Selection.prototype.initFormulaReferenceIndicator = function (range) {\n        if (this.parent.isEdit) {\n            var forRefIndicator = this.parent.createElement('div', { className: 'e-formularef-indicator' });\n            forRefIndicator.appendChild(this.parent.createElement('div', { className: 'e-top' }));\n            forRefIndicator.appendChild(this.parent.createElement('div', { className: 'e-bottom' }));\n            forRefIndicator.appendChild(this.parent.createElement('div', { className: 'e-left' }));\n            forRefIndicator.appendChild(this.parent.createElement('div', { className: 'e-right' }));\n            locateElem(forRefIndicator, range, this.parent.getActiveSheet(), false);\n            this.parent.getMainContent().appendChild(forRefIndicator);\n        }\n    };\n    Selection.prototype.selectRangeByIdx = function (range, e, isScrollRefresh, isActCellChanged, isInit, skipChecking) {\n        var eventArgs = { action: 'getCurrentEditValue', editedValue: '' };\n        this.parent.notify(editOperation, eventArgs);\n        var isFormulaEdit = checkIsFormula(eventArgs.editedValue) ||\n            (eventArgs.editedValue && eventArgs.editedValue.toString().indexOf('=') === 0);\n        var ele = this.getSelectionElement();\n        var sheet = this.parent.getActiveSheet();\n        var formulaRefIndicator = this.parent.element.querySelector('.e-formularef-indicator');\n        var mergeArgs = { range: [].slice.call(range), isActiveCell: false, skipChecking: skipChecking };\n        var isMergeRange;\n        if (!this.isColSelected && !this.isRowSelected) {\n            this.parent.notify(mergedRange, mergeArgs);\n        }\n        if (range !== mergeArgs.range) {\n            isMergeRange = true;\n        }\n        range = mergeArgs.range;\n        var args = { range: getRangeAddress(range), cancel: false };\n        this.parent.trigger('beforeSelect', args);\n        if (args.cancel === true) {\n            return;\n        }\n        if (isFormulaEdit && formulaRefIndicator) {\n            formulaRefIndicator.parentElement.removeChild(formulaRefIndicator);\n        }\n        if (isSingleCell(range) || mergeArgs.isActiveCell) {\n            if (ele) {\n                ele.classList.add('e-hide');\n            }\n            if (isFormulaEdit && e && !e.target.classList.contains('e-spreadsheet-edit') && this.parent.isEdit) {\n                this.parent.notify(addressHandle, { range: getRangeAddress(range).split(':')[0], isSelect: true });\n                this.initFormulaReferenceIndicator(range);\n            }\n        }\n        else {\n            if (isFormulaEdit && this.parent.isEdit) {\n                if (e && !e.target.classList.contains('e-spreadsheet-edit') && this.parent.isEdit) {\n                    this.parent.notify(addressHandle, { range: getRangeAddress(range), isSelect: true });\n                    this.initFormulaReferenceIndicator(range);\n                }\n            }\n            else {\n                if (ele) {\n                    ele.classList.remove('e-hide');\n                }\n                var offset = (this.isColSelected && this.isRowSelected) ? undefined\n                    : this.getOffset(range[2], range[3]);\n                if (isMergeRange && offset) { // Need to handle half hidden merge cell in better way\n                    offset.left = { idx: 0, size: 0 };\n                }\n                locateElem(ele, range, sheet, this.parent.enableRtl);\n            }\n        }\n        var eArgs = { action: 'getCurrentEditSheetIdx', sheetIndex: null };\n        this.parent.notify(editOperation, eArgs);\n        if (!isFormulaEdit) {\n            updateSelectedRange(this.parent, getRangeAddress(range), sheet);\n        }\n        else if (!isInit) {\n            updateSelectedRange(this.parent, getRangeAddress(range), sheet);\n        }\n        this.UpdateRowColSelected(range);\n        this.highlightHdr(range);\n        if (!isScrollRefresh && !(e && (e.type === 'mousemove' || isTouchMove(e)))) {\n            if (!isFormulaEdit) {\n                this.updateActiveCell(isActCellChanged ? getRangeIndexes(sheet.activeCell) : range, isInit);\n            }\n            else if (eArgs.sheetIndex === this.parent.getActiveSheet().id - 1 && isInit) {\n                isActCellChanged = true;\n                this.updateActiveCell(isActCellChanged ? getRangeIndexes(sheet.activeCell) : range, isInit);\n            }\n            else if (!this.parent.isEdit) {\n                this.updateActiveCell(isActCellChanged ? getRangeIndexes(sheet.activeCell) : range, isInit);\n            }\n        }\n        if (isNullOrUndefined(e)) {\n            e = { type: 'mousedown' };\n        }\n        if (!isFormulaEdit) {\n            this.parent.notify(selectionComplete, e);\n        }\n        else if (!isInit) {\n            this.parent.notify(selectionComplete, e);\n        }\n        this.parent.notify(showAggregate, {});\n        this.parent.notify(refreshImgElem, {});\n        this.parent.notify(clearChartBorder, {});\n    };\n    Selection.prototype.UpdateRowColSelected = function (indexes) {\n        var sheet = this.parent.getActiveSheet();\n        this.isRowSelected = (indexes[1] === 0 && indexes[3] === sheet.colCount - 1);\n        this.isColSelected = (indexes[0] === 0 && indexes[2] === sheet.rowCount - 1);\n    };\n    Selection.prototype.updateActiveCell = function (range, isInit) {\n        var sheet = this.parent.getActiveSheet();\n        var topLeftIdx = getRangeIndexes(sheet.topLeftCell);\n        var rowIdx;\n        var colIdx;\n        var cell;\n        var isMergeRange;\n        if (this.isColSelected) {\n            rowIdx = topLeftIdx[0];\n            colIdx = range[1];\n            if (this.isRowSelected) {\n                colIdx = topLeftIdx[1];\n            }\n        }\n        else {\n            rowIdx = range[0];\n            colIdx = range[1];\n            if (this.isRowSelected) {\n                colIdx = topLeftIdx[1];\n            }\n        }\n        var mergeArgs = { range: [rowIdx, colIdx].concat([rowIdx, colIdx]) };\n        this.parent.notify(activeCellMergedRange, mergeArgs);\n        if (range !== mergeArgs.range) {\n            isMergeRange = true;\n        }\n        range = mergeArgs.range;\n        if (sheet.activeCell !== getCellAddress(range[0], range[1]) || isInit) {\n            this.parent.setSheetPropertyOnMute(sheet, 'activeCell', getCellAddress(range[0], range[1]));\n            if (this.getActiveCell()) {\n                var offset = this.getOffset(range[2], range[3]);\n                if (isMergeRange) {\n                    offset.left = { idx: 0, size: 0 };\n                }\n                locateElem(this.getActiveCell(), range, sheet, this.parent.enableRtl);\n            }\n            this.parent.notify(activeCellChanged, null);\n        }\n        else {\n            locateElem(this.getActiveCell(), range, sheet, this.parent.enableRtl);\n        }\n    };\n    Selection.prototype.getOffset = function (rowIdx, colIdx) {\n        var offset = { left: { idx: 0, size: 0 }, top: { idx: 0, size: 0 } };\n        if (this.parent.scrollModule) {\n            if (colIdx >= this.parent.scrollModule.offset.left.idx) {\n                offset.left = this.parent.scrollModule.offset.left;\n            }\n            if (rowIdx >= this.parent.scrollModule.offset.top.idx) {\n                offset.top = this.parent.scrollModule.offset.top;\n            }\n        }\n        return offset;\n    };\n    Selection.prototype.getSelectionElement = function () {\n        return this.parent.element.getElementsByClassName('e-selection')[0];\n    };\n    Selection.prototype.getActiveCell = function () {\n        return this.parent.getMainContent().getElementsByClassName('e-active-cell')[0];\n    };\n    Selection.prototype.getSheetElement = function () {\n        return document.getElementById(this.parent.element.id + '_sheet');\n    };\n    Selection.prototype.highlightHdr = function (range, isRowRefresh, isColRefresh) {\n        if (isRowRefresh === void 0) { isRowRefresh = true; }\n        if (isColRefresh === void 0) { isColRefresh = true; }\n        if (this.parent.getActiveSheet().showHeaders) {\n            var sheet = this.parent.getActiveSheet();\n            var rowHdr = [];\n            var colHdr = [];\n            var swapRange = getSwapRange(range);\n            swapRange = this.getHdrIndexes(swapRange);\n            var selectAll = this.parent.element.getElementsByClassName('e-select-all-cell')[0];\n            removeClass(this.getSheetElement().querySelectorAll('.e-highlight'), 'e-highlight');\n            removeClass(this.getSheetElement().querySelectorAll('.e-prev-highlight'), 'e-prev-highlight');\n            if (selectAll) {\n                removeClass([selectAll], ['e-prev-highlight-right', 'e-prev-highlight-bottom']);\n            }\n            if (isRowRefresh) {\n                rowHdr = [].slice.call(this.parent.getRowHeaderContent().querySelectorAll('td')).slice(swapRange[0], swapRange[2] + 1);\n            }\n            if (isColRefresh) {\n                colHdr = [].slice.call(this.parent.getColumnHeaderContent().querySelectorAll('th')).slice(swapRange[1], swapRange[3] + 1);\n            }\n            if (sheet.isProtected && !sheet.protectSettings.selectCells) {\n                removeClass([].concat(rowHdr, colHdr), 'e-highlight');\n            }\n            else {\n                addClass([].concat(rowHdr, colHdr), 'e-highlight');\n            }\n            if (rowHdr.length && rowHdr[0].parentElement.previousElementSibling) {\n                rowHdr[0].parentElement.previousElementSibling.classList.add('e-prev-highlight');\n            }\n            if (colHdr.length && colHdr[0].previousElementSibling) {\n                colHdr[0].previousElementSibling.classList.add('e-prev-highlight');\n            }\n            if (this.isRowSelected && this.isColSelected) {\n                if (sheet.isProtected && !sheet.protectSettings.selectCells) {\n                    document.getElementById(this.parent.element.id + \"_select_all\").classList.remove('e-highlight');\n                }\n                else {\n                    document.getElementById(this.parent.element.id + \"_select_all\").classList.add('e-highlight');\n                }\n            }\n            if (selectAll) {\n                if (swapRange[0] === 0) {\n                    selectAll.classList.add('e-prev-highlight-bottom');\n                }\n                if (swapRange[1] === 0) {\n                    selectAll.classList.add('e-prev-highlight-right');\n                }\n            }\n        }\n    };\n    Selection.prototype.protectHandler = function () {\n        var range = getRangeIndexes(this.parent.getActiveSheet().selectedRange);\n        var swapRange = getSwapRange(range);\n        var actRange = getCellIndexes(this.parent.getActiveSheet().activeCell);\n        var inRange = swapRange[0] <= actRange[0] && swapRange[2] >= actRange[0] && swapRange[1] <= actRange[1]\n            && swapRange[3] >= actRange[1];\n        this.selectRangeByIdx(range, null, null, inRange);\n    };\n    Selection.prototype.getHdrIndexes = function (range) {\n        if (this.parent.scrollSettings.enableVirtualization) {\n            var indexes = [];\n            var hiddenRowCount = this.parent.hiddenCount(this.parent.viewport.topIndex, range[0]);\n            var hiddenColCount = this.parent.hiddenCount(this.parent.viewport.leftIndex, range[1], 'columns');\n            indexes[0] = this.isColSelected ? range[0] : (range[0] - this.parent.viewport.topIndex) < 0\n                ? 0 : ((range[0] - hiddenRowCount) - this.parent.viewport.topIndex);\n            indexes[1] = this.isRowSelected ? range[1] : (range[1] - this.parent.viewport.leftIndex) < 0\n                ? 0 : ((range[1] - hiddenColCount) - this.parent.viewport.leftIndex);\n            indexes[2] = this.isColSelected ? this.parent.viewport.rowCount + this.parent.getThreshold('row') * 2 : range[2] -\n                this.parent.hiddenCount(range[0], range[2]) - hiddenRowCount - this.parent.viewport.topIndex;\n            indexes[3] = this.isRowSelected ? this.parent.viewport.colCount + this.parent.getThreshold('col') * 2 :\n                range[3] - this.parent.hiddenCount(range[1], range[3], 'columns') - hiddenColCount - this.parent.viewport.leftIndex;\n            return indexes;\n        }\n        return range;\n    };\n    Selection.prototype.initiateFormulaSelection = function (args) {\n        this.processFormulaEditRange(args.range, args.formulaSheetIdx);\n    };\n    Selection.prototype.processFormulaEditRange = function (val, formulaStartSheetIdx) {\n        var str;\n        var actSheetIdx;\n        var formulaSheetIdx = formulaStartSheetIdx;\n        var lastChar;\n        var i = 0;\n        var parsedVal = this.parseFormula(val);\n        var len = parsedVal.length;\n        var ctrlKeyCount = 0;\n        var formulaBorder = [['e-vborderright', 'e-vborderbottom'], ['e-pborderright', 'e-pborderbottom'],\n            ['e-cborderright', 'e-cborderbottom'], ['e-gborderright', 'e-gborderbottom'], ['e-oborderright', 'e-oborderbottom'],\n            ['e-bborderright', 'e-bborderbottom']];\n        this.clearBorder();\n        actSheetIdx = this.parent.getActiveSheet().id - 1;\n        while (i < len) {\n            str = parsedVal[i];\n            if (this.invalidOperators.indexOf(str) > -1) {\n                break;\n            }\n            if (isCellReference(str.toUpperCase())) {\n                str = str.replace(/\\$/g, '');\n                if (i > 0) {\n                    if (parsedVal[i - 1].indexOf('!') === parsedVal[i - 1].length - 1) {\n                        var splitStr = parsedVal[i - 1].split('!');\n                        formulaSheetIdx = getSheetIndex(this.parent, splitStr[0].substring(1, splitStr[0].length - 1));\n                    }\n                }\n                if (parsedVal[i + 1] === ':') {\n                    i++;\n                    if (parsedVal[i + 1] && isCellReference(parsedVal[i + 1].toUpperCase())) {\n                        str = str + ':' + parsedVal[i + 1];\n                        i++;\n                    }\n                }\n                if (actSheetIdx === formulaSheetIdx) {\n                    this.updateFormulaEditRange(str, ctrlKeyCount, formulaBorder);\n                }\n                formulaSheetIdx = formulaStartSheetIdx;\n                ctrlKeyCount++;\n            }\n            i++;\n        }\n    };\n    Selection.prototype.updateFormulaEditRange = function (str, i, formulaBorder) {\n        var indices = getRangeIndexes(str);\n        this.formulaRange[i] = str;\n        this.dStartCell = { rowIndex: indices[0], colIndex: indices[1] };\n        this.dEndCell = { rowIndex: indices[2], colIndex: indices[3] };\n        this.focusBorder(this.dStartCell, this.dEndCell, formulaBorder[i % 6]);\n    };\n    Selection.prototype.chartBorderHandler = function (args) {\n        this.focusBorder(args.startcell, args.endcell, args.classes, true);\n    };\n    Selection.prototype.focusBorder = function (startcell, endcell, classes, isChart) {\n        isChart = isNullOrUndefined(isChart) ? false : isChart;\n        var range = getSwapRange([startcell.rowIndex, startcell.colIndex, endcell.rowIndex, endcell.colIndex]);\n        var minr = range[0];\n        var minc = range[1];\n        var maxr = range[2];\n        var maxc = range[3];\n        if (minr) {\n            (this.getEleFromRange([minr - 1, minc, minr - 1, maxc])).forEach(function (td) {\n                if (td) {\n                    td.classList.add(classes[1]);\n                    if (!isChart) {\n                        td.classList.add('e-formularef-selection');\n                    }\n                }\n            }); // top                            \n        }\n        (this.getEleFromRange([minr, maxc, maxr, maxc])).forEach(function (td) {\n            if (td) {\n                td.classList.add(classes[0]);\n                if (!isChart) {\n                    td.classList.add('e-formularef-selection');\n                }\n            }\n        }); // right\n        this.getEleFromRange([maxr, minc, maxr, maxc]).forEach(function (td) {\n            if (td) {\n                td.classList.add(classes[1]);\n                if (!isChart) {\n                    td.classList.add('e-formularef-selection');\n                }\n            }\n        }); // bottom\n        if (minc) {\n            (this.getEleFromRange([minr, minc - 1, maxr, minc - 1])).forEach(function (td) {\n                if (td) {\n                    td.classList.add(classes[0]);\n                    if (!isChart) {\n                        td.classList.add('e-formularef-selection');\n                    }\n                }\n            }); // left\n        }\n    };\n    Selection.prototype.getEleFromRange = function (range, sheetIdx) {\n        sheetIdx = this.parent.getActiveSheet().index;\n        var sheet = this.parent.getActiveSheet();\n        var startRIndex = range[0];\n        var startCIndex = range[1];\n        var endRIndex = range[2];\n        var endCIndex = range[3];\n        var i;\n        var rowIdx;\n        var temp;\n        var len;\n        var tempCells = [];\n        var rowCells;\n        var cells = [];\n        if (startRIndex > endRIndex) {\n            temp = startRIndex;\n            startRIndex = endRIndex;\n            endRIndex = temp;\n        }\n        if (startCIndex > endCIndex) {\n            temp = startCIndex;\n            startCIndex = endCIndex;\n            endCIndex = temp;\n        }\n        if (this.parent.scrollSettings.enableVirtualization) {\n            for (i = startRIndex; i <= endRIndex; i++) {\n                rowIdx = i;\n                if (rowIdx > -1) {\n                    var row = this.parent.getRow(rowIdx);\n                    if (row) {\n                        rowCells = row.getElementsByClassName('e-cell');\n                        tempCells = (endCIndex === startCIndex) ?\n                            [rowCells[endCIndex]] : this.getRowCells(rowCells, startCIndex, endCIndex + 1);\n                        this.merge(cells, tempCells);\n                    }\n                }\n            }\n        }\n        return cells;\n    };\n    Selection.prototype.getRowCells = function (rowCells, startCIndex, endCIndex) {\n        var tdCol = [];\n        for (startCIndex; startCIndex < endCIndex; startCIndex++) {\n            if (rowCells[startCIndex]) {\n                tdCol.push(rowCells[startCIndex]);\n            }\n        }\n        return tdCol;\n    };\n    Selection.prototype.merge = function (first, second) {\n        if (!first || !second) {\n            return;\n        }\n        Array.prototype.push.apply(first, second);\n    };\n    ;\n    Selection.prototype.clearBorder = function () {\n        var borderEleColl = this.parent.element.getElementsByClassName('e-formularef-selection');\n        for (var idx = 0; idx < borderEleColl.length; idx++) {\n            var td = borderEleColl[idx];\n            var classArr = ['e-vborderright', 'e-vborderbottom', 'e-pborderright', 'e-pborderbottom',\n                'e-cborderright', 'e-cborderbottom', 'e-gborderright', 'e-gborderbottom', 'e-oborderright',\n                'e-oborderbottom', 'e-bborderright', 'e-bborderbottom'];\n            for (var idx_1 = 0; idx_1 < classArr.length; idx_1++) {\n                td.classList.remove(classArr[idx_1]);\n            }\n        }\n        for (var idx = 0; idx < borderEleColl.length; idx++) {\n            var td = borderEleColl[idx];\n        }\n    };\n    Selection.prototype.parseFormula = function (formulaStr) {\n        var tempStr;\n        var str;\n        var len;\n        var i = 0;\n        var arr = [];\n        formulaStr = this.markSpecialChar(formulaStr.replace('=', ''));\n        var formula = formulaStr.split(/\\(|\\)|=|\\^|>|<|,|:|\\+|-|\\*|\\/|%|&/g);\n        len = formula.length;\n        while (i < len) {\n            tempStr = formula[i];\n            if (!tempStr) {\n                i++;\n                continue;\n            }\n            if (tempStr.length === 1) {\n                arr.push(this.isUniqueChar(tempStr) ? this.getUniqueCharVal(tempStr) : tempStr);\n            }\n            else {\n                str = tempStr[0];\n                if (tempStr.indexOf('!') > 0) {\n                    if (this.isUniqueChar(str)) {\n                        arr.push(this.getUniqueCharVal(str));\n                        tempStr = tempStr.substr(1);\n                    }\n                    var strVal = tempStr.indexOf('!') + 1;\n                    arr.push(tempStr.substr(0, strVal));\n                    arr.push(tempStr.substr(strVal));\n                }\n                else if (this.isUniqueChar(str)) {\n                    arr.push(this.getUniqueCharVal(str));\n                    arr.push(tempStr.substr(1));\n                }\n                else {\n                    arr.push(tempStr);\n                }\n            }\n            i++;\n        }\n        return arr;\n    };\n    Selection.prototype.isUniqueChar = function (str) {\n        var code = str.charCodeAt(str.charAt[0]);\n        return code >= 129 && code <= 142;\n    };\n    Selection.prototype.getUniqueCharVal = function (tempStr) {\n        switch (tempStr) {\n            case this.uniqueOBracket:\n                return '(';\n            case this.uniqueCBracket:\n                return ')';\n            case this.uniqueCOperator:\n                return ':';\n            case this.uniqueSOperator:\n                return '-';\n            case this.uniquePOperator:\n                return '+';\n            case this.uniqueMOperator:\n                return '*';\n            case this.uniqueDOperator:\n                return '/';\n            case this.uniqueModOperator:\n                return '%';\n            case this.uniqueCSeparator:\n                return ',';\n            case this.uniqueConcateOperator:\n                return '&';\n            case this.uniqueEqualOperator:\n                return '=';\n            case this.uniqueExpOperator:\n                return '^';\n            case this.uniqueLTOperator:\n                return '<';\n            case this.uniqueGTOperator:\n                return '>';\n        }\n        return '';\n    };\n    Selection.prototype.markSpecialChar = function (formulaVal) {\n        formulaVal = formulaVal.replace(/\\(/g, '(' + this.uniqueOBracket).replace(/\\)/g, ')' + this.uniqueCBracket);\n        formulaVal = formulaVal.replace(/,/g, ',' + this.uniqueCSeparator).replace(/:/g, ':' + this.uniqueCOperator);\n        formulaVal = formulaVal.replace(/\\+/g, '+' + this.uniquePOperator).replace(/-/g, '-' + this.uniqueSOperator);\n        formulaVal = formulaVal.replace(/\\*/g, '*' + this.uniqueMOperator).replace(/\\//g, '/' + this.uniqueDOperator);\n        formulaVal = formulaVal.replace(/&/g, '&' + this.uniqueConcateOperator);\n        formulaVal = formulaVal.replace(/=/g, '=' + this.uniqueEqualOperator);\n        formulaVal = formulaVal.replace(/\\^/g, '^' + this.uniqueExpOperator);\n        formulaVal = formulaVal.replace(/>/g, '>' + this.uniqueGTOperator).replace(/</g, '<' + this.uniqueLTOperator);\n        return formulaVal.replace(/%/g, '%' + this.uniqueModOperator);\n    };\n    /**\n     * For internal use only - Get the module name.\n     * @private\n     */\n    Selection.prototype.getModuleName = function () {\n        return 'selection';\n    };\n    Selection.prototype.destroy = function () {\n        this.removeEventListener();\n        this.parent = null;\n    };\n    return Selection;\n}());\nexport { Selection };\n","import { EventHandler, Browser } from '@syncfusion/ej2-base';\nimport { contentLoaded, spreadsheetDestroyed, onVerticalScroll, onHorizontalScroll, getScrollBarWidth } from '../common/index';\nimport { onContentScroll, deInitProperties, setScrollEvent, skipHiddenIdx } from '../common/index';\nimport { getRowHeight, getColumnWidth, getCellAddress } from '../../workbook/index';\nimport { isFormulaBarEdit } from '../common/index';\n/**\n * The `Scroll` module is used to handle scrolling behavior.\n * @hidden\n */\nvar Scroll = /** @class */ (function () {\n    /**\n     * Constructor for the Spreadsheet scroll module.\n     * @private\n     */\n    function Scroll(parent) {\n        this.parent = parent;\n        this.addEventListener();\n        this.initProps();\n    }\n    Scroll.prototype.onContentScroll = function (e) {\n        var target = this.parent.getMainContent();\n        var scrollLeft = e.scrollLeft || target.scrollLeft;\n        var top = e.scrollTop || target.scrollTop;\n        var left = this.parent.enableRtl ? this.initScrollValue - scrollLeft : scrollLeft;\n        var scrollArgs;\n        var prevSize;\n        if (this.prevScroll.scrollLeft !== left) {\n            var scrollRight = left > this.prevScroll.scrollLeft;\n            prevSize = this.offset.left.size;\n            this.offset.left = this.getColOffset(left, scrollRight, e.skipHidden);\n            if (this.parent.getActiveSheet().showHeaders) {\n                this.parent.getColumnHeaderContent().scrollLeft = scrollLeft;\n            }\n            scrollArgs = {\n                cur: this.offset.left, prev: { idx: this.leftIndex, size: prevSize }, increase: scrollRight, preventScroll: e.preventScroll\n            };\n            this.parent.notify(onHorizontalScroll, scrollArgs);\n            this.updateTopLeftCell(scrollRight);\n            if (!this.parent.scrollSettings.enableVirtualization && scrollRight && !this.parent.scrollSettings.isFinite) {\n                this.updateNonVirtualCols();\n            }\n            this.leftIndex = scrollArgs.prev.idx;\n            this.prevScroll.scrollLeft = left;\n        }\n        if (this.prevScroll.scrollTop !== top) {\n            var scrollDown = top > this.prevScroll.scrollTop;\n            prevSize = this.offset.top.size;\n            this.offset.top = this.getRowOffset(top, scrollDown);\n            if (this.parent.getActiveSheet().showHeaders) {\n                this.parent.getRowHeaderContent().scrollTop = top;\n            }\n            scrollArgs = {\n                cur: this.offset.top, prev: { idx: this.topIndex, size: prevSize }, increase: scrollDown, preventScroll: e.preventScroll\n            };\n            this.parent.notify(onVerticalScroll, scrollArgs);\n            this.updateTopLeftCell(scrollDown);\n            if (!this.parent.scrollSettings.enableVirtualization && scrollDown && !this.parent.scrollSettings.isFinite) {\n                this.updateNonVirtualRows();\n            }\n            this.topIndex = scrollArgs.prev.idx;\n            this.prevScroll.scrollTop = top;\n        }\n        var isEdit = false;\n        var args = { isEdit: isEdit };\n        this.parent.notify(isFormulaBarEdit, args);\n        if (args.isEdit) {\n            var textArea = this.parent.element.querySelector('.e-formula-bar');\n            textArea.focus();\n        }\n    };\n    Scroll.prototype.updateNonVirtualRows = function () {\n        var sheet = this.parent.getActiveSheet();\n        var threshold = this.parent.getThreshold('row');\n        if (this.offset.top.idx > sheet.rowCount - (this.parent.viewport.rowCount + threshold)) {\n            this.parent.renderModule.refreshUI({ colIndex: 0, direction: 'first', refresh: 'RowPart' }, getCellAddress(sheet.rowCount, 0) + \":\" + getCellAddress(sheet.rowCount + threshold - 1, sheet.colCount - 1));\n            sheet.rowCount += threshold;\n        }\n    };\n    Scroll.prototype.updateNonVirtualCols = function () {\n        var sheet = this.parent.getActiveSheet();\n        var threshold = this.parent.getThreshold('col');\n        if (this.offset.left.idx > sheet.colCount - (this.parent.viewport.colCount + threshold)) {\n            this.parent.renderModule.refreshUI({ rowIndex: 0, colIndex: sheet.colCount, direction: 'first', refresh: 'ColumnPart' }, getCellAddress(0, sheet.colCount) + \":\" + getCellAddress(sheet.rowCount - 1, sheet.colCount + threshold - 1));\n            sheet.colCount += threshold;\n        }\n    };\n    Scroll.prototype.updateTopLeftCell = function (increase) {\n        var top = this.offset.top.idx;\n        var left = this.offset.left.idx;\n        if (!increase) {\n            var sheet = this.parent.getActiveSheet();\n            top = skipHiddenIdx(sheet, top, true);\n            left = skipHiddenIdx(sheet, left, true, 'columns');\n        }\n        this.parent.setSheetPropertyOnMute(this.parent.getActiveSheet(), 'topLeftCell', getCellAddress(top, left));\n    };\n    Scroll.prototype.getRowOffset = function (scrollTop, scrollDown) {\n        var temp = this.offset.top.size;\n        var sheet = this.parent.getActiveSheet();\n        var i = scrollDown ? this.offset.top.idx + 1 : (this.offset.top.idx ? this.offset.top.idx - 1 : 0);\n        var count;\n        if (this.parent.scrollSettings.isFinite) {\n            count = sheet.rowCount;\n            if (scrollDown && i + this.parent.viewport.rowCount + this.parent.getThreshold('row') >= count) {\n                return { idx: this.offset.top.idx, size: this.offset.top.size };\n            }\n        }\n        else {\n            count = Infinity;\n        }\n        while (i < count) {\n            if (scrollDown) {\n                temp += getRowHeight(sheet, i - 1);\n                if (temp === scrollTop) {\n                    return { idx: i, size: temp };\n                }\n                if (temp > scrollTop) {\n                    return { idx: i - 1, size: temp - getRowHeight(sheet, i - 1) };\n                }\n                i++;\n            }\n            else {\n                if (temp === 0) {\n                    return { idx: 0, size: 0 };\n                }\n                temp -= getRowHeight(sheet, i);\n                if (temp === scrollTop) {\n                    return { idx: i, size: temp };\n                }\n                if (temp < scrollTop) {\n                    temp += getRowHeight(sheet, i);\n                    if (temp > scrollTop) {\n                        return { idx: i, size: temp - getRowHeight(sheet, i) < 0 ? 0 : temp - getRowHeight(sheet, i) };\n                    }\n                    else {\n                        return { idx: i + 1, size: temp };\n                    }\n                }\n                i--;\n            }\n        }\n        return { idx: this.offset.top.idx, size: this.offset.top.size };\n    };\n    Scroll.prototype.getColOffset = function (scrollLeft, increase, skipHidden) {\n        var temp = this.offset.left.size;\n        var sheet = this.parent.getActiveSheet();\n        var i = increase ? this.offset.left.idx + 1 : this.offset.left.idx - 1;\n        var count;\n        if (this.parent.scrollSettings.isFinite) {\n            count = sheet.colCount;\n            if (increase && i + this.parent.viewport.colCount + this.parent.getThreshold('col') >= count) {\n                return { idx: this.offset.left.idx, size: this.offset.left.size };\n            }\n        }\n        else {\n            count = Infinity;\n        }\n        while (i < count) {\n            if (increase) {\n                temp += getColumnWidth(sheet, i - 1, skipHidden);\n                if (temp === scrollLeft) {\n                    return { idx: i, size: temp };\n                }\n                if (temp > scrollLeft) {\n                    return { idx: i - 1, size: temp - getColumnWidth(sheet, i - 1, skipHidden) };\n                }\n                i++;\n            }\n            else {\n                if (temp === 0) {\n                    return { idx: 0, size: 0 };\n                }\n                temp -= getColumnWidth(sheet, i, skipHidden);\n                if (temp === scrollLeft) {\n                    return { idx: i, size: temp };\n                }\n                if (temp < scrollLeft) {\n                    temp += getColumnWidth(sheet, i, skipHidden);\n                    if (temp > scrollLeft) {\n                        return { idx: i, size: temp - getColumnWidth(sheet, i, skipHidden) };\n                    }\n                    else {\n                        return { idx: i + 1, size: temp };\n                    }\n                }\n                i--;\n            }\n        }\n        return { idx: this.offset.left.idx, size: this.offset.left.size };\n    };\n    Scroll.prototype.contentLoaded = function () {\n        this.onScroll = this.onContentScroll.bind(this);\n        this.setScrollEvent();\n        if (this.parent.enableRtl) {\n            this.initScrollValue = this.parent.getMainContent().scrollLeft;\n        }\n    };\n    Scroll.prototype.setScrollEvent = function (args) {\n        if (args === void 0) { args = { set: true }; }\n        args.set ? EventHandler.add(this.parent.getMainContent(), 'scroll', this.onScroll, this) :\n            EventHandler.remove(this.parent.getMainContent(), 'scroll', this.onScroll);\n    };\n    Scroll.prototype.initProps = function () {\n        this.topIndex = 0;\n        this.leftIndex = 0;\n        this.prevScroll = { scrollLeft: 0, scrollTop: 0 };\n        this.offset = { left: { idx: 0, size: 0 }, top: { idx: 0, size: 0 } };\n    };\n    Scroll.prototype.getThreshold = function () {\n        /* Some browsers places the scroller outside the content,\n         * hence the padding should be adjusted.*/\n        if (Browser.info.name === 'mozilla') {\n            return 0.5;\n        }\n        return 1;\n    };\n    /**\n     * @hidden\n     */\n    Scroll.prototype.setPadding = function () {\n        if (!this.parent.allowScrolling) {\n            return;\n        }\n        var colHeader = this.parent.getColumnHeaderContent();\n        var rowHeader = this.parent.getRowHeaderContent();\n        var scrollWidth = getScrollBarWidth() - this.getThreshold();\n        var cssProps = this.parent.enableRtl ? { padding: 'paddingLeft', border: 'borderLeftWidth' }\n            : { padding: 'paddingRight', border: 'borderRightWidth' };\n        if (scrollWidth > 0) {\n            colHeader.parentElement.style[cssProps.padding] = scrollWidth + 'px';\n            colHeader.style[cssProps.border] = '1px';\n            rowHeader.style.marginBottom = scrollWidth + 'px';\n        }\n    };\n    Scroll.prototype.addEventListener = function () {\n        this.parent.on(contentLoaded, this.contentLoaded, this);\n        this.parent.on(onContentScroll, this.onContentScroll, this);\n        this.parent.on(deInitProperties, this.initProps, this);\n        this.parent.on(spreadsheetDestroyed, this.destroy, this);\n        this.parent.on(setScrollEvent, this.setScrollEvent, this);\n    };\n    Scroll.prototype.destroy = function () {\n        EventHandler.remove(this.parent.getMainContent(), 'scroll', this.onScroll);\n        this.removeEventListener();\n        this.parent = null;\n    };\n    Scroll.prototype.removeEventListener = function () {\n        this.parent.off(contentLoaded, this.contentLoaded);\n        this.parent.off(onContentScroll, this.onContentScroll);\n        this.parent.off(deInitProperties, this.initProps);\n        this.parent.off(spreadsheetDestroyed, this.destroy);\n        this.parent.off(setScrollEvent, this.setScrollEvent);\n    };\n    return Scroll;\n}());\nexport { Scroll };\n","import { isNullOrUndefined } from '@syncfusion/ej2-base';\nimport { spreadsheetDestroyed, beforeContentLoaded, beforeVirtualContentLoaded, virtualContentLoaded } from '../common/index';\nimport { colWidthChanged, updateTableWidth } from '../common/index';\nimport { onVerticalScroll, onHorizontalScroll, rowHeightChanged, beforeHeaderLoaded, deInitProperties } from '../common/index';\nimport { getRowHeight, getRowsHeight, getColumnWidth, getColumnsWidth } from './../../workbook/index';\nimport { getRangeAddress } from '../../workbook/common/index';\nimport { updateUsedRange, sheetCreated, sheetsDestroyed } from '../../workbook/common/event';\n/**\n * VirtualScroll module\n * @hidden\n */\nvar VirtualScroll = /** @class */ (function () {\n    function VirtualScroll(parent) {\n        this.scroll = [];\n        this.parent = parent;\n        this.addEventListener();\n    }\n    VirtualScroll.prototype.createVirtualElement = function (args) {\n        var sheet = this.parent.getActiveSheet();\n        var container = this.parent.getMainContent();\n        this.content = this.parent.createElement('div', { className: 'e-virtualable' });\n        this.content.appendChild(container.querySelector('.e-table'));\n        container.appendChild(this.content);\n        var vTrack = container.appendChild(this.parent.createElement('div', { className: 'e-virtualtrack' }));\n        var colVTrack;\n        var rowVTrack;\n        var height;\n        var width;\n        if (this.parent.sheets.length > this.scroll.length) {\n            this.initScroll();\n        }\n        var domCount = this.parent.viewport.rowCount + 1 + (this.parent.getThreshold('row') * 2);\n        if (sheet.rowCount > domCount || sheet.usedRange.rowIndex > domCount - 1) {\n            if (!this.parent.scrollSettings.isFinite && sheet.rowCount <= sheet.usedRange.rowIndex) {\n                this.parent.setSheetPropertyOnMute(sheet, 'rowCount', sheet.usedRange.rowIndex + 1);\n            }\n            this.setScrollCount(sheet.rowCount, 'row');\n            height = getRowsHeight(sheet, 0, this.scroll[this.parent.activeSheetIndex].rowCount - 1);\n        }\n        else {\n            if (!this.parent.scrollSettings.isFinite) {\n                this.parent.setSheetPropertyOnMute(sheet, 'rowCount', domCount);\n            }\n            this.scroll[this.parent.activeSheetIndex].rowCount = sheet.rowCount;\n            height = 1;\n        }\n        domCount = this.parent.viewport.colCount + 1 + (this.parent.getThreshold('col') * 2);\n        var size;\n        if (sheet.colCount > domCount || sheet.usedRange.colIndex > domCount - 1) {\n            if (!this.parent.scrollSettings.isFinite && sheet.colCount <= sheet.usedRange.colIndex) {\n                this.parent.setSheetPropertyOnMute(sheet, 'colCount', sheet.usedRange.colIndex + 1);\n            }\n            size = getColumnsWidth(sheet, 0, domCount - 1);\n            this.setScrollCount(sheet.colCount, 'col');\n            width = size + getColumnsWidth(sheet, domCount, this.scroll[this.parent.activeSheetIndex].colCount - 1);\n        }\n        else {\n            if (!this.parent.scrollSettings.isFinite) {\n                this.parent.setSheetPropertyOnMute(sheet, 'colCount', domCount);\n            }\n            size = getColumnsWidth(sheet, 0, sheet.colCount - 1);\n            this.scroll[this.parent.activeSheetIndex].colCount = sheet.colCount;\n            width = size;\n        }\n        if (args.startColIdx) {\n            size = getColumnsWidth(sheet, args.startColIdx, args.startColIdx + domCount - 1);\n        }\n        if (isNullOrUndefined(this.parent.viewport.leftIndex)) {\n            this.parent.viewport.leftIndex = 0;\n        }\n        if (isNullOrUndefined(this.parent.viewport.topIndex)) {\n            this.parent.viewport.topIndex = 0;\n        }\n        if (isNullOrUndefined(this.translateX)) {\n            this.translateX = 0;\n        }\n        if (isNullOrUndefined(this.translateY)) {\n            this.translateY = 0;\n        }\n        if (sheet.showHeaders) {\n            container = this.parent.getRowHeaderContent();\n            this.rowHeader = this.content.cloneNode();\n            this.rowHeader.appendChild(container.querySelector('.e-table'));\n            container.appendChild(this.rowHeader);\n            rowVTrack = container.appendChild(vTrack.cloneNode());\n            this.rowHeader.style.transform = \"translate(0px, \" + this.translateY + \"px)\";\n            container = this.parent.getColumnHeaderContent();\n            this.colHeader = this.content.cloneNode();\n            this.colHeader.appendChild(container.querySelector('.e-table'));\n            container.appendChild(this.colHeader);\n            colVTrack = container.appendChild(vTrack.cloneNode());\n            this.colHeader.style.width = size + \"px\";\n            rowVTrack.style.height = height + \"px\";\n            colVTrack.style.width = width + \"px\";\n            this.colHeader.style.transform = \"translate(\" + this.translateX + \"px, 0px)\";\n        }\n        this.content.style.transform = \"translate(\" + this.translateX + \"px, \" + this.translateY + \"px)\";\n        this.content.style.width = size + \"px\";\n        vTrack.style.height = height + \"px\";\n        vTrack.style.width = width + \"px\";\n    };\n    VirtualScroll.prototype.initScroll = function () {\n        var i = 0;\n        while (i < this.parent.sheets.length) {\n            if (!this.scroll[i]) {\n                this.scroll.push({ rowCount: 0, colCount: 0 });\n            }\n            i++;\n        }\n    };\n    VirtualScroll.prototype.setScrollCount = function (count, layout) {\n        var activeSheetIdx = this.parent.activeSheetIndex;\n        if (!this.scroll[activeSheetIdx][layout + 'Count']) {\n            this.scroll[activeSheetIdx][layout + 'Count'] = count;\n        }\n    };\n    VirtualScroll.prototype.getRowAddress = function (indexes) {\n        return getRangeAddress([indexes[0], this.parent.viewport.leftIndex, indexes[1], this.parent.viewport.rightIndex]);\n    };\n    VirtualScroll.prototype.getColAddress = function (indexes) {\n        return getRangeAddress([this.parent.viewport.topIndex, indexes[0], this.parent.viewport.bottomIndex, indexes[1]]);\n    };\n    VirtualScroll.prototype.updateScrollCount = function (idx, layout, threshold) {\n        if (threshold === void 0) { threshold = idx; }\n        var sheet = this.parent.getActiveSheet();\n        var rowCount = idx + this.parent.viewport[layout + 'Count'] + 1 + threshold;\n        var usedRangeCount = this.scroll[this.parent.activeSheetIndex][layout + 'Count'];\n        if (rowCount < usedRangeCount) {\n            if (sheet[layout + 'Count'] === usedRangeCount) {\n                return;\n            }\n            rowCount = usedRangeCount;\n        }\n        if (!this.parent.scrollSettings.isFinite) {\n            this.parent.setSheetPropertyOnMute(sheet, layout + 'Count', rowCount);\n        }\n    };\n    VirtualScroll.prototype.onVerticalScroll = function (args) {\n        var idx = args.cur.idx;\n        var height = args.cur.size;\n        var prevIdx = args.prev.idx;\n        var idxDiff = Math.abs(idx - prevIdx);\n        var threshold = this.parent.getThreshold('row');\n        if (idxDiff > Math.round(threshold / 2)) {\n            var startIdx = void 0;\n            var lastIdx = void 0;\n            var prevTopIdx = void 0;\n            if (idx <= threshold) {\n                if (!args.increase) {\n                    if (this.translateY && prevIdx > threshold) {\n                        this.translateY = 0;\n                        this.parent.viewport.topIndex = prevIdx - threshold;\n                        if (!args.preventScroll) {\n                            if (idxDiff < this.parent.viewport.rowCount + threshold) {\n                                lastIdx = this.parent.viewport.topIndex - 1;\n                                startIdx = this.parent.skipHidden(0, lastIdx)[0];\n                                this.parent.viewport.topIndex = startIdx;\n                                var hiddenCount = this.hiddenCount(startIdx, lastIdx);\n                                var skippedHiddenIdx = this.skipHiddenIdx((this.parent.viewport.bottomIndex - ((lastIdx - startIdx + 1) - hiddenCount)), args.increase);\n                                this.parent.viewport.bottomIndex -= (((lastIdx - startIdx + 1) - hiddenCount) +\n                                    (this.hiddenCount(skippedHiddenIdx, this.parent.viewport.bottomIndex)));\n                                this.parent.renderModule.refreshUI({\n                                    colIndex: this.parent.viewport.leftIndex, rowIndex: startIdx, direction: 'last', refresh: 'RowPart',\n                                    skipUpdateOnFirst: true\n                                }, this.getRowAddress([0, this.skipHiddenIdx(lastIdx, false)]));\n                            }\n                            else {\n                                this.parent.renderModule.refreshUI({ rowIndex: 0, colIndex: this.parent.viewport.leftIndex, refresh: 'Row', skipUpdateOnFirst: true });\n                            }\n                            this.parent.element.focus();\n                        }\n                    }\n                    this.updateScrollCount(threshold, 'row');\n                }\n            }\n            if (prevIdx < threshold) {\n                idxDiff = Math.abs(idx - threshold);\n            }\n            if (idx > threshold) {\n                prevTopIdx = this.parent.viewport.topIndex;\n                this.parent.viewport.topIndex = idx - threshold;\n                if (args.increase && prevTopIdx > this.parent.viewport.topIndex) {\n                    this.parent.viewport.topIndex = prevTopIdx;\n                    return;\n                }\n                this.translateY = height - this.getThresholdHeight(this.parent.viewport.topIndex, threshold);\n                if (!args.preventScroll) {\n                    if (idxDiff < this.parent.viewport.rowCount + threshold) {\n                        if (args.increase) {\n                            startIdx = this.parent.viewport.bottomIndex + 1;\n                            lastIdx = this.parent.viewport.bottomIndex + (this.parent.viewport.topIndex - prevTopIdx);\n                            lastIdx -= this.hiddenCount(prevTopIdx, this.parent.viewport.topIndex - 1);\n                            this.parent.viewport.topIndex = this.skipHiddenIdx(this.parent.viewport.topIndex, args.increase);\n                            if (lastIdx <= this.parent.viewport.bottomIndex) {\n                                return;\n                            }\n                            var indexes = this.parent.skipHidden(startIdx, lastIdx);\n                            startIdx = indexes[0];\n                            lastIdx = this.checkLastIdx(indexes[1], 'row');\n                            this.parent.viewport.bottomIndex = lastIdx;\n                            this.parent.renderModule.refreshUI({ colIndex: this.parent.viewport.leftIndex, rowIndex: startIdx, direction: 'first', refresh: 'RowPart' }, this.getRowAddress([startIdx, lastIdx]));\n                        }\n                        else {\n                            startIdx = this.parent.viewport.topIndex;\n                            lastIdx = startIdx + idxDiff - 1;\n                            var hiddenCount = this.hiddenCount(startIdx, lastIdx);\n                            var skippedHiddenIdx = this.skipHiddenIdx((this.parent.viewport.bottomIndex - ((lastIdx - startIdx) - hiddenCount)), args.increase);\n                            this.parent.viewport.bottomIndex -= ((idxDiff - hiddenCount) +\n                                (this.hiddenCount(skippedHiddenIdx, this.parent.viewport.bottomIndex)));\n                            startIdx = this.parent.skipHidden(startIdx, lastIdx)[0];\n                            this.parent.viewport.topIndex = startIdx;\n                            this.parent.renderModule.refreshUI({ colIndex: this.parent.viewport.leftIndex, rowIndex: startIdx, direction: 'last', refresh: 'RowPart' }, this.getRowAddress([startIdx, lastIdx]));\n                        }\n                    }\n                    else {\n                        this.parent.renderModule.refreshUI({\n                            rowIndex: this.parent.viewport.topIndex, colIndex: this.parent.viewport.leftIndex, refresh: 'Row'\n                        });\n                    }\n                    this.updateScrollCount(idx, 'row', threshold);\n                    this.parent.element.focus();\n                }\n            }\n            args.prev.idx = idx;\n        }\n    };\n    VirtualScroll.prototype.skipHiddenIdx = function (index, increase, layout, sheet) {\n        if (layout === void 0) { layout = 'rows'; }\n        if (sheet === void 0) { sheet = this.parent.getActiveSheet(); }\n        if ((sheet[layout])[index] && (sheet[layout])[index].hidden) {\n            increase ? index++ : index--;\n            index = this.skipHiddenIdx(index, increase, layout, sheet);\n        }\n        return index;\n    };\n    VirtualScroll.prototype.hiddenCount = function (startIdx, endIdx, layout) {\n        if (layout === void 0) { layout = 'rows'; }\n        var index = 0;\n        var sheet = this.parent.getActiveSheet();\n        for (var i = startIdx; i <= endIdx; i++) {\n            if ((sheet[layout])[i] && (sheet[layout])[i].hidden) {\n                index++;\n            }\n        }\n        return index;\n    };\n    VirtualScroll.prototype.checkLastIdx = function (idx, layout) {\n        if (this.parent.scrollSettings.isFinite) {\n            var count = this.parent.getActiveSheet()[layout + 'Count'] - 1;\n            if (idx > count) {\n                idx = count;\n            }\n        }\n        return idx;\n    };\n    VirtualScroll.prototype.onHorizontalScroll = function (args) {\n        var idx = args.cur.idx;\n        var width = args.cur.size;\n        var prevIdx = args.prev.idx;\n        var idxDiff = Math.abs(idx - prevIdx);\n        var threshold = this.parent.getThreshold('col');\n        if (idxDiff > Math.round(threshold / 2)) {\n            var startIdx = void 0;\n            var endIdx = void 0;\n            var prevLeftIdx = void 0;\n            if (idx <= threshold) {\n                if (!args.increase) {\n                    if (this.translateX && prevIdx > threshold) {\n                        this.translateX = 0;\n                        this.parent.viewport.leftIndex = prevIdx - threshold;\n                        if (!args.preventScroll) {\n                            if (idxDiff < this.parent.viewport.colCount + threshold) {\n                                endIdx = this.parent.viewport.leftIndex - 1;\n                                startIdx = this.parent.skipHidden(0, endIdx, 'columns')[0];\n                                this.parent.viewport.leftIndex = startIdx;\n                                var hiddenCount = this.hiddenCount(startIdx, endIdx, 'columns');\n                                var skippedHiddenIdx = this.skipHiddenIdx((this.parent.viewport.rightIndex - ((endIdx - startIdx + 1) - hiddenCount)), args.increase, 'columns');\n                                this.parent.viewport.rightIndex -= (((endIdx - startIdx + 1) - hiddenCount) +\n                                    (this.hiddenCount(skippedHiddenIdx, this.parent.viewport.rightIndex, 'columns')));\n                                this.parent.renderModule.refreshUI({ rowIndex: this.parent.viewport.topIndex, colIndex: startIdx, direction: 'last', refresh: 'ColumnPart',\n                                    skipUpdateOnFirst: true }, this.getColAddress([0, this.skipHiddenIdx(endIdx, false, 'columns')]));\n                            }\n                            else {\n                                this.parent.renderModule.refreshUI({ rowIndex: this.parent.viewport.topIndex, colIndex: 0, refresh: 'Column', skipUpdateOnFirst: true });\n                            }\n                            this.parent.element.focus();\n                        }\n                    }\n                    this.updateScrollCount(threshold, 'col');\n                }\n            }\n            if (prevIdx < threshold) {\n                idxDiff = Math.abs(idx - threshold);\n            }\n            if (idx > threshold) {\n                prevLeftIdx = this.parent.viewport.leftIndex;\n                this.parent.viewport.leftIndex = idx - threshold;\n                if (args.increase && prevLeftIdx > this.parent.viewport.leftIndex) {\n                    this.parent.viewport.leftIndex = prevLeftIdx;\n                    return;\n                }\n                this.translateX = width - this.getThresholdWidth(this.parent.viewport.leftIndex, threshold);\n                if (!args.preventScroll) {\n                    if (idxDiff < this.parent.viewport.colCount + threshold) {\n                        if (args.increase) {\n                            startIdx = this.parent.viewport.rightIndex + 1;\n                            endIdx = this.parent.viewport.rightIndex + (this.parent.viewport.leftIndex - prevLeftIdx);\n                            endIdx -= this.hiddenCount(prevLeftIdx, this.parent.viewport.leftIndex - 1, 'columns');\n                            this.parent.viewport.leftIndex = this.skipHiddenIdx(this.parent.viewport.leftIndex, args.increase, 'columns');\n                            if (endIdx <= this.parent.viewport.rightIndex) {\n                                return;\n                            }\n                            var indexes = this.parent.skipHidden(startIdx, endIdx, 'columns');\n                            startIdx = indexes[0];\n                            endIdx = this.checkLastIdx(indexes[1], 'col');\n                            this.parent.viewport.rightIndex = endIdx;\n                            this.parent.renderModule.refreshUI({ rowIndex: this.parent.viewport.topIndex, colIndex: startIdx, direction: 'first', refresh: 'ColumnPart' }, this.getColAddress([startIdx, endIdx]));\n                        }\n                        else {\n                            startIdx = this.parent.viewport.leftIndex;\n                            endIdx = startIdx + idxDiff - 1;\n                            var hiddenCount = this.hiddenCount(startIdx, endIdx, 'columns');\n                            var skippedHiddenIdx = this.skipHiddenIdx((this.parent.viewport.rightIndex - ((endIdx - startIdx) - hiddenCount)), args.increase, 'columns');\n                            this.parent.viewport.rightIndex -= ((idxDiff - hiddenCount) +\n                                (this.hiddenCount(skippedHiddenIdx, this.parent.viewport.rightIndex, 'columns')));\n                            startIdx = this.parent.skipHidden(startIdx, endIdx, 'columns')[0];\n                            this.parent.viewport.leftIndex = startIdx;\n                            this.parent.renderModule.refreshUI({ rowIndex: this.parent.viewport.topIndex, colIndex: startIdx, direction: 'last', refresh: 'ColumnPart' }, this.getColAddress([startIdx, endIdx]));\n                        }\n                    }\n                    else {\n                        this.parent.renderModule.refreshUI({\n                            rowIndex: this.parent.viewport.topIndex, colIndex: this.parent.viewport.leftIndex, refresh: 'Column'\n                        });\n                    }\n                    this.updateScrollCount(idx, 'col', threshold);\n                    this.parent.element.focus();\n                }\n            }\n            args.prev.idx = idx;\n        }\n    };\n    VirtualScroll.prototype.getThresholdHeight = function (idx, threshold) {\n        var height = 0;\n        var sheet = this.parent.getActiveSheet();\n        for (var i = idx; i < idx + threshold; i++) {\n            height += getRowHeight(sheet, i);\n        }\n        return height;\n    };\n    VirtualScroll.prototype.getThresholdWidth = function (idx, threshold) {\n        var width = 0;\n        var sheet = this.parent.getActiveSheet();\n        for (var i = idx; i < idx + threshold; i++) {\n            width += getColumnWidth(sheet, i);\n        }\n        return width;\n    };\n    VirtualScroll.prototype.translate = function (args) {\n        var sheet = this.parent.getActiveSheet();\n        if (args.refresh === 'Row' || args.refresh === 'RowPart') {\n            this.content.style.transform = \"translate(\" + this.translateX + \"px, \" + this.translateY + \"px)\";\n            if (sheet.showHeaders) {\n                this.rowHeader.style.transform = \"translate(0px, \" + this.translateY + \"px)\";\n            }\n        }\n        if (args.refresh === 'Column' || args.refresh === 'ColumnPart') {\n            var translateX = this.parent.enableRtl ? -this.translateX : this.translateX;\n            this.content.style.transform = \"translate(\" + translateX + \"px, \" + this.translateY + \"px)\";\n            if (sheet.showHeaders) {\n                this.colHeader.style.transform = \"translate(\" + translateX + \"px, 0px)\";\n            }\n        }\n    };\n    VirtualScroll.prototype.updateColumnWidth = function (args) {\n        if (args.refresh === 'Column') {\n            this.content.style.width = '';\n            var width = getColumnsWidth(this.parent.getActiveSheet(), this.parent.viewport.leftIndex, this.parent.viewport.rightIndex);\n            if (this.parent.getActiveSheet().showHeaders) {\n                this.colHeader.style.width = width + 'px';\n            }\n            this.content.style.width = width + 'px';\n        }\n    };\n    VirtualScroll.prototype.updateUsedRange = function (args) {\n        if (!this.scroll.length) {\n            return;\n        }\n        var sheet = this.parent.getActiveSheet();\n        if (args.update === 'row') {\n            if (args.index !== this.scroll[this.parent.activeSheetIndex].rowCount - 1) {\n                var height = this.getVTrackHeight('height');\n                if (args.index >= this.scroll[this.parent.activeSheetIndex].rowCount) {\n                    height += getRowsHeight(sheet, this.scroll[this.parent.activeSheetIndex].rowCount, args.index);\n                }\n                else {\n                    height -= getRowsHeight(sheet, args.index + 1, this.scroll[this.parent.activeSheetIndex].rowCount - 1);\n                }\n                this.scroll[this.parent.activeSheetIndex].rowCount = args.index + 1;\n                this.updateVTrack(this.rowHeader, height, 'height');\n                if (this.scroll[this.parent.activeSheetIndex].rowCount > sheet.rowCount) {\n                    this.parent.setSheetPropertyOnMute(sheet, 'rowCount', this.scroll[this.parent.activeSheetIndex].rowCount);\n                }\n            }\n        }\n        else {\n            if (args.index > this.scroll[this.parent.activeSheetIndex].colCount) {\n                var width = this.getVTrackHeight('width');\n                width += getColumnsWidth(sheet, this.scroll[this.parent.activeSheetIndex].colCount, args.index);\n                this.scroll[this.parent.activeSheetIndex].colCount = args.index + 1;\n                this.updateVTrack(this.colHeader, width, 'width');\n                if (this.scroll[this.parent.activeSheetIndex].colCount > sheet.colCount) {\n                    this.parent.setSheetPropertyOnMute(sheet, 'colCount', this.scroll[this.parent.activeSheetIndex].colCount);\n                }\n            }\n        }\n    };\n    VirtualScroll.prototype.createHeaderElement = function (args) {\n        this.rowHeader = this.content.cloneNode();\n        this.colHeader = this.rowHeader.cloneNode();\n        this.rowHeader.style.width = '';\n        this.rowHeader.style.transform = \"translate(0px, \" + this.translateY + \"px)\";\n        this.colHeader.style.transform = \"translate(\" + (this.parent.enableRtl ? -this.translateX : this.translateX) + \"px, 0px)\";\n        this.rowHeader.appendChild(args.element.querySelector('table'));\n        args.element.appendChild(this.rowHeader);\n        var container = this.parent.getColumnHeaderContent();\n        this.colHeader.appendChild(container.querySelector('table'));\n        container.appendChild(this.colHeader);\n        var rowVTrack = this.content.nextElementSibling.cloneNode();\n        var colVTrack = rowVTrack.cloneNode();\n        rowVTrack.style.width = '';\n        colVTrack.style.height = '';\n        args.element.appendChild(rowVTrack);\n        container.appendChild(colVTrack);\n    };\n    VirtualScroll.prototype.getVTrackHeight = function (str) {\n        var height = this.content.nextElementSibling.style[str];\n        if (height.includes('e+')) {\n            height = height.split('px')[0];\n            var heightArr = height.split('e+');\n            return Number(heightArr[0]) * Math.pow(10, Number(heightArr[1]));\n        }\n        else {\n            return parseInt(height, 10);\n        }\n    };\n    VirtualScroll.prototype.updateVTrackHeight = function (args) {\n        var domCount = this.parent.viewport.rowCount + 1 + (this.parent.getThreshold('row') * 2);\n        if (args.rowIdx >= domCount && args.rowIdx < this.scroll[this.parent.activeSheetIndex].rowCount) {\n            this.updateVTrack(this.rowHeader, this.getVTrackHeight('height') + args.threshold, 'height');\n        }\n    };\n    VirtualScroll.prototype.updateVTrackWidth = function (args) {\n        if (args.colIdx >= this.parent.viewport.leftIndex && args.colIdx <= this.parent.viewport.rightIndex) {\n            if (this.parent.getActiveSheet().showHeaders) {\n                var hdrVTrack = this.parent.getColumnHeaderContent().getElementsByClassName('e-virtualtrack')[0];\n                hdrVTrack.style.width = parseInt(hdrVTrack.style.width, 10) + args.threshold + 'px';\n            }\n            var cntVTrack = this.parent.getMainContent().getElementsByClassName('e-virtualtrack')[0];\n            cntVTrack.style.width = parseInt(cntVTrack.style.width, 10) + args.threshold + 'px';\n            if (this.parent.getActiveSheet().showHeaders) {\n                var hdrColumn = this.parent.getColumnHeaderContent().getElementsByClassName('e-virtualable')[0];\n                hdrColumn.style.width = parseInt(hdrColumn.style.width, 10) + args.threshold + 'px';\n            }\n            var cntColumn = this.parent.getMainContent().getElementsByClassName('e-virtualable')[0];\n            cntColumn.style.width = parseInt(cntColumn.style.width, 10) + args.threshold + 'px';\n        }\n    };\n    VirtualScroll.prototype.updateVTrack = function (header, size, sizeStr) {\n        if (this.parent.getActiveSheet().showHeaders) {\n            header.nextElementSibling.style[sizeStr] = size + \"px\";\n        }\n        this.content.nextElementSibling.style[sizeStr] = size + \"px\";\n    };\n    VirtualScroll.prototype.deInitProps = function () {\n        this.parent.viewport.leftIndex = null;\n        this.parent.viewport.topIndex = null;\n        this.parent.viewport.bottomIndex = null;\n        this.translateX = null;\n        this.translateY = null;\n    };\n    VirtualScroll.prototype.updateScrollProps = function (args) {\n        var _this = this;\n        if (args === void 0) { args = { sheetIndex: 0, sheets: this.parent.sheets }; }\n        if (this.scroll.length === 0) {\n            this.initScroll();\n        }\n        else {\n            args.sheets.forEach(function () { _this.scroll.splice(args.sheetIndex, 0, { rowCount: 0, colCount: 0 }); });\n        }\n    };\n    VirtualScroll.prototype.sliceScrollProps = function (args) {\n        if (isNullOrUndefined(args.sheetIndex)) {\n            this.scroll.length = 0;\n        }\n        else {\n            this.scroll.splice(args.sheetIndex, 1);\n        }\n    };\n    VirtualScroll.prototype.addEventListener = function () {\n        this.parent.on(beforeContentLoaded, this.createVirtualElement, this);\n        this.parent.on(beforeVirtualContentLoaded, this.translate, this);\n        this.parent.on(virtualContentLoaded, this.updateColumnWidth, this);\n        this.parent.on(updateTableWidth, this.updateColumnWidth, this);\n        this.parent.on(onVerticalScroll, this.onVerticalScroll, this);\n        this.parent.on(onHorizontalScroll, this.onHorizontalScroll, this);\n        this.parent.on(updateUsedRange, this.updateUsedRange, this);\n        this.parent.on(rowHeightChanged, this.updateVTrackHeight, this);\n        this.parent.on(colWidthChanged, this.updateVTrackWidth, this);\n        this.parent.on(beforeHeaderLoaded, this.createHeaderElement, this);\n        this.parent.on(deInitProperties, this.deInitProps, this);\n        this.parent.on(sheetsDestroyed, this.sliceScrollProps, this);\n        this.parent.on(sheetCreated, this.updateScrollProps, this);\n        this.parent.on(spreadsheetDestroyed, this.destroy, this);\n    };\n    VirtualScroll.prototype.destroy = function () {\n        this.removeEventListener();\n        this.rowHeader = null;\n        this.colHeader = null;\n        this.content = null;\n        this.parent = null;\n        this.scroll.length = 0;\n        this.translateX = null;\n        this.translateY = null;\n    };\n    VirtualScroll.prototype.removeEventListener = function () {\n        this.parent.off(beforeContentLoaded, this.createVirtualElement);\n        this.parent.off(beforeVirtualContentLoaded, this.translate);\n        this.parent.off(virtualContentLoaded, this.updateColumnWidth);\n        this.parent.off(updateTableWidth, this.updateColumnWidth);\n        this.parent.off(onVerticalScroll, this.onVerticalScroll);\n        this.parent.off(onHorizontalScroll, this.onHorizontalScroll);\n        this.parent.off(updateUsedRange, this.updateUsedRange);\n        this.parent.off(rowHeightChanged, this.updateVTrackHeight);\n        this.parent.off(colWidthChanged, this.updateVTrackWidth);\n        this.parent.off(beforeHeaderLoaded, this.createHeaderElement);\n        this.parent.off(sheetsDestroyed, this.sliceScrollProps);\n        this.parent.off(sheetCreated, this.updateScrollProps);\n        this.parent.off(spreadsheetDestroyed, this.destroy);\n    };\n    return VirtualScroll;\n}());\nexport { VirtualScroll };\n","import { keyDown, cellNavigate, renameSheet, filterCellKeyDown } from '../common/index';\nimport { getCellIndexes, getRangeAddress, getRowHeight, getColumnWidth, getCell } from '../../workbook/index';\nimport { closest } from '@syncfusion/ej2-base';\n/**\n * Represents keyboard navigation support for Spreadsheet.\n */\nvar KeyboardNavigation = /** @class */ (function () {\n    /**\n     * Constructor for the Spreadsheet Keyboard Navigation module.\n     * @private\n     */\n    function KeyboardNavigation(parent) {\n        this.parent = parent;\n        this.addEventListener();\n        /* code snippet */\n    }\n    KeyboardNavigation.prototype.addEventListener = function () {\n        this.parent.on(keyDown, this.keyDownHandler, this);\n        /* code snippet */\n    };\n    KeyboardNavigation.prototype.removeEventListener = function () {\n        if (!this.parent.isDestroyed) {\n            this.parent.off(keyDown, this.keyDownHandler);\n        }\n        /* code snippet */\n    };\n    KeyboardNavigation.prototype.keyDownHandler = function (e) {\n        if (!this.parent.isEdit && (document.activeElement.classList.contains('e-spreadsheet') ||\n            closest(document.activeElement, '.e-sheet'))) {\n            var isNavigate = void 0;\n            var scrollIdxes = void 0;\n            var isRtl = this.parent.enableRtl;\n            var sheet = this.parent.getActiveSheet();\n            var filterArgs = { e: e, isFilterCell: false };\n            var actIdxes = getCellIndexes(this.parent.getActiveSheet().activeCell);\n            if ([9, 37, 38, 39, 40].indexOf(e.keyCode) > -1) {\n                e.preventDefault();\n            }\n            if (!e.shiftKey && e.altKey && (e.keyCode === 38 || e.keyCode === 40)) {\n                this.parent.notify(filterCellKeyDown, filterArgs);\n            }\n            if ((!e.shiftKey && ((!isRtl && e.keyCode === 37) || (isRtl && e.keyCode === 39)))\n                || (e.shiftKey && e.keyCode === 9)) { //left key\n                if (actIdxes[1] > 0) {\n                    actIdxes[1] -= 1;\n                    isNavigate = true;\n                }\n                else {\n                    var content = this.parent.getMainContent();\n                    if (actIdxes[1] === 0 && content.scrollLeft && !isRtl) {\n                        content.scrollLeft = 0;\n                    }\n                }\n            }\n            else if ((!filterArgs.isFilterCell && !e.shiftKey && e.keyCode === 38) || (e.shiftKey && e.keyCode === 13)) { // Up key\n                if (actIdxes[0] > 0) {\n                    actIdxes[0] -= 1;\n                    isNavigate = true;\n                }\n                else {\n                    var content = this.parent.getMainContent();\n                    if (actIdxes[0] === 0 && content.scrollTop) {\n                        content.scrollTop = 0;\n                    }\n                }\n            }\n            else if ((!e.shiftKey && ((!isRtl && e.keyCode === 39) || (isRtl && e.keyCode === 37))) || e.keyCode === 9) { // Right key\n                var cell = getCell(actIdxes[0], actIdxes[1], sheet);\n                if (cell && cell.colSpan > 1) {\n                    actIdxes[1] += (cell.colSpan - 1);\n                }\n                if (actIdxes[1] < sheet.colCount - 1) {\n                    actIdxes[1] += 1;\n                    isNavigate = true;\n                }\n            }\n            else if ((!filterArgs.isFilterCell && !e.shiftKey && e.keyCode === 40) || e.keyCode === 13) { // Down Key\n                var cell = getCell(actIdxes[0], actIdxes[1], sheet);\n                if (cell && cell.rowSpan > 1) {\n                    actIdxes[0] += (cell.rowSpan - 1);\n                }\n                if (actIdxes[0] < sheet.rowCount - 1) {\n                    actIdxes[0] += 1;\n                    isNavigate = true;\n                }\n            }\n            /* else if (e.keyCode === 36) {\n                actIdxes[1] = 0;\n                if (e.ctrlKey) {\n                    actIdxes[0] = 0;\n                }\n                isNavigate = true;\n                e.preventDefault();\n            } else if (e.keyCode === 35 && e.ctrlKey) {\n                actIdxes = [sheet.usedRange.rowIndex, sheet.usedRange.colIndex];\n                scrollIdxes = [sheet.usedRange.rowIndex - this.parent.viewport.rowCount,\n                    sheet.usedRange.colIndex - this.parent.viewport.colCount];\n                isNavigate = true;\n                e.preventDefault();\n            } */\n            if (isNavigate) {\n                this.scrollNavigation(scrollIdxes || actIdxes, scrollIdxes ? true : false);\n                this.parent.setSheetPropertyOnMute(sheet, 'activeCell', getRangeAddress(actIdxes));\n                this.parent.notify(cellNavigate, { range: actIdxes });\n            }\n        }\n        var target = e.target;\n        if (target.classList.contains('e-sheet-rename')) {\n            if (e.keyCode === 32) {\n                e.stopPropagation();\n            }\n            else if (e.keyCode === 13 || e.keyCode === 27) {\n                this.parent.notify(renameSheet, e);\n            }\n        }\n    };\n    KeyboardNavigation.prototype.scrollNavigation = function (actIdxes, isScroll) {\n        var x = this.parent.enableRtl ? -1 : 1;\n        var cont = this.parent.getMainContent();\n        var sheet = this.parent.getActiveSheet();\n        var prevActIdxes = getCellIndexes(sheet.activeCell);\n        var topLeftIdxes = getCellIndexes(sheet.topLeftCell);\n        if (this.getBottomIdx(topLeftIdxes) <= actIdxes[0] || isScroll) {\n            cont.scrollTop += getRowHeight(sheet, actIdxes[0]);\n        }\n        else if (topLeftIdxes[0] > actIdxes[0]) {\n            cont.scrollTop -= getRowHeight(sheet, actIdxes[0]);\n        }\n        if (this.getRightIdx(topLeftIdxes) <= actIdxes[1] || isScroll) {\n            cont.scrollLeft += getColumnWidth(sheet, actIdxes[1]) * x;\n        }\n        else if (topLeftIdxes[1] > actIdxes[1]) {\n            cont.scrollLeft -= getColumnWidth(sheet, actIdxes[1]) * x;\n        }\n    };\n    KeyboardNavigation.prototype.getBottomIdx = function (topLeftIdxes) {\n        var hgt = 0;\n        var sheet = this.parent.getActiveSheet();\n        for (var i = topLeftIdxes[0];; i++) {\n            hgt += getRowHeight(sheet, i);\n            if (hgt >= this.parent.viewport.height - 17) {\n                return i;\n            }\n        }\n    };\n    KeyboardNavigation.prototype.getRightIdx = function (topLeftIdxes) {\n        var width = 0;\n        var sheet = this.parent.getActiveSheet();\n        var contWidth = this.parent.getMainContent().offsetWidth;\n        for (var i = topLeftIdxes[1];; i++) {\n            width += getColumnWidth(sheet, i);\n            if (width >= contWidth - 17) {\n                return i;\n            }\n        }\n    };\n    /**\n     * For internal use only - Get the module name.\n     * @private\n     */\n    KeyboardNavigation.prototype.getModuleName = function () {\n        return 'keyboardNavigation';\n    };\n    KeyboardNavigation.prototype.destroy = function () {\n        this.removeEventListener();\n        this.parent = null;\n    };\n    return KeyboardNavigation;\n}());\nexport { KeyboardNavigation };\n","import { keyDown, cut, paste, copy, clearCopy, performUndoRedo, initiateHyperlink, editHyperlink } from '../common/index';\nimport { findDlg, gotoDlg } from '../common/index';\nimport { setCellFormat, textDecorationUpdate, getCellIndexes } from '../../workbook/common/index';\nimport { getColumn, isLocked as isCellLocked } from '../../workbook/index';\nimport { setCell, getCell } from '../../workbook/base/cell';\nimport { isNullOrUndefined, closest, select } from '@syncfusion/ej2-base';\n/**\n * Represents keyboard shortcut support for Spreadsheet.\n */\nvar KeyboardShortcut = /** @class */ (function () {\n    /**\n     * Constructor for the Spreadsheet Keyboard Shortcut module.\n     * @private\n     */\n    function KeyboardShortcut(parent) {\n        this.parent = parent;\n        this.addEventListener();\n    }\n    KeyboardShortcut.prototype.addEventListener = function () {\n        this.parent.on(keyDown, this.keyDownHandler, this);\n    };\n    KeyboardShortcut.prototype.removeEventListener = function () {\n        if (!this.parent.isDestroyed) {\n            this.parent.off(keyDown, this.keyDownHandler);\n        }\n    };\n    KeyboardShortcut.prototype.keyDownHandler = function (e) {\n        if (e.ctrlKey || e.metaKey) {\n            if (!closest(e.target, '.e-find-dlg')) {\n                if ([79, 83, 65].indexOf(e.keyCode) > -1) {\n                    e.preventDefault();\n                }\n            }\n            if (e.keyCode === 79) {\n                select('#' + this.parent.element.id + '_fileUpload', this.parent.element).click();\n            }\n            else if (e.keyCode === 83) {\n                if (this.parent.saveUrl && this.parent.allowSave) {\n                    this.parent.save();\n                }\n            }\n            else if (e.keyCode === 67) {\n                this.parent.notify(copy, { promise: Promise });\n            }\n            else if (e.keyCode === 75) {\n                var sheet = this.parent.getActiveSheet();\n                var indexes = getCellIndexes(sheet.activeCell);\n                var row = this.parent.sheets[this.parent.getActiveSheet().id - 1].rows[indexes[0]];\n                var cell = void 0;\n                e.preventDefault();\n                if (!isNullOrUndefined(row)) {\n                    cell = row.cells[indexes[1]];\n                }\n                if (isNullOrUndefined(cell)) {\n                    setCell(indexes[0], indexes[1], this.parent.getActiveSheet(), cell, false);\n                }\n                if (cell && cell.hyperlink) {\n                    this.parent.notify(editHyperlink, null);\n                }\n                else {\n                    this.parent.notify(initiateHyperlink, null);\n                }\n            }\n            else if (e.keyCode === 90) { /* Ctrl + Z */\n                if (!this.parent.isEdit) {\n                    e.preventDefault();\n                    this.parent.notify(performUndoRedo, { isUndo: true });\n                }\n            }\n            else if (e.keyCode === 89) { /* Ctrl + Y */\n                if (!this.parent.isEdit) {\n                    e.preventDefault();\n                    this.parent.notify(performUndoRedo, { isUndo: false });\n                }\n            }\n            var actSheet = this.parent.sheets[this.parent.getActiveSheet().id - 1];\n            var actCell = actSheet.activeCell;\n            var actCellIndex = getCellIndexes(actCell);\n            var cellObj = getCell(actCellIndex[0], actCellIndex[1], actSheet);\n            var isLocked = actSheet.isProtected && isCellLocked(cellObj, getColumn(actSheet, actCellIndex[1]));\n            if (!isLocked || !actSheet.isProtected) {\n                if (e.keyCode === 70) {\n                    e.preventDefault();\n                    var toolBarElem = document.querySelector('.e-spreadsheet-find-ddb');\n                    if (!isNullOrUndefined(toolBarElem)) {\n                        toolBarElem.click();\n                    }\n                }\n                else if (e.keyCode === 71) {\n                    e.preventDefault();\n                    this.parent.notify(gotoDlg, null);\n                }\n                else if (e.keyCode === 72) {\n                    e.preventDefault();\n                    this.parent.notify(findDlg, null);\n                }\n                else if (e.keyCode === 88) {\n                    this.parent.notify(cut, { promise: Promise });\n                }\n                else if (e.keyCode === 86) {\n                    if (!isLocked) {\n                        this.parent.notify(paste, { isAction: true });\n                    }\n                }\n                else if (e.keyCode === 66) {\n                    e.preventDefault();\n                    var value = this.parent.getCellStyleValue(['fontWeight'], getCellIndexes(this.parent.getActiveSheet().activeCell)).fontWeight;\n                    value = value === 'bold' ? 'normal' : 'bold';\n                    this.parent.notify(setCellFormat, { style: { fontWeight: value }, onActionUpdate: true, refreshRibbon: true });\n                }\n                else if (e.keyCode === 73) {\n                    e.preventDefault();\n                    var value = this.parent.getCellStyleValue(['fontStyle'], getCellIndexes(this.parent.getActiveSheet().activeCell)).fontStyle;\n                    value = value === 'italic' ? 'normal' : 'italic';\n                    this.parent.notify(setCellFormat, { style: { fontStyle: value }, onActionUpdate: true, refreshRibbon: true });\n                }\n                else if (e.keyCode === 85) {\n                    e.preventDefault();\n                    this.parent.notify(textDecorationUpdate, { style: { textDecoration: 'underline' }, refreshRibbon: true });\n                }\n                else if (e.keyCode === 53) {\n                    e.preventDefault();\n                    this.parent.notify(textDecorationUpdate, { style: { textDecoration: 'line-through' }, refreshRibbon: true });\n                }\n                if (e.shiftKey) {\n                    if (e.keyCode === 76) { /* Ctrl + Shift + L */\n                        if (!this.parent.isEdit) {\n                            e.preventDefault();\n                            this.parent.applyFilter();\n                        }\n                    }\n                }\n            }\n        }\n        if (e.keyCode === 27) {\n            this.parent.notify(clearCopy, null);\n        }\n    };\n    KeyboardShortcut.prototype.getModuleName = function () {\n        return 'keyboardShortcut';\n    };\n    KeyboardShortcut.prototype.destroy = function () {\n        this.removeEventListener();\n        this.parent = null;\n    };\n    return KeyboardShortcut;\n}());\nexport { KeyboardShortcut };\n","import { clearViewer, beginAction } from '../../spreadsheet/index';\nimport { rowHeightChanged, setRowEleHeight, setMaxHgt, getTextHeight, getMaxHgt, getLines, initialLoad } from '../common/index';\nimport { getRowHeight, applyCellFormat } from '../../workbook/index';\nimport { isHiddenRow, getCell, getColumnWidth, getRangeIndexes, getSheetIndex, clearCFRule } from '../../workbook/index';\nimport { wrapEvent, getRangeAddress, clear } from '../../workbook/index';\nimport { removeClass, isNullOrUndefined } from '@syncfusion/ej2-base';\n/**\n * CellFormat module allows to format the cell styles.\n */\nvar CellFormat = /** @class */ (function () {\n    function CellFormat(parent) {\n        this.checkHeight = false;\n        this.parent = parent;\n        this.row = parent.createElement('tr', { className: 'e-row' });\n        this.parent.on(initialLoad, this.addEventListener, this);\n    }\n    CellFormat.prototype.applyCellFormat = function (args) {\n        var keys = Object.keys(args.style);\n        var sheet = this.parent.getActiveSheet();\n        if (args.lastCell && getMaxHgt(sheet, args.rowIdx) <= 20 && !keys.length) {\n            return;\n        }\n        var cell = args.cell || this.parent.getCell(args.rowIdx, args.colIdx);\n        if (cell) {\n            if (args.style.border !== undefined || args.style.borderTop !== undefined || args.style.borderLeft !== undefined) {\n                var curStyle_1 = {};\n                Object.keys(args.style).forEach(function (key) { curStyle_1[key] = args.style[key]; });\n                if (curStyle_1.border !== undefined) {\n                    Object.assign(cell.style, { borderRight: args.style.border, borderBottom: args.style.border });\n                    this.setLeftBorder(args.style.border, cell, args.rowIdx, args.colIdx, args.row, args.onActionUpdate, args.first);\n                    this.setTopBorder(args.style.border, cell, args.rowIdx, args.colIdx, args.pRow, args.pHRow, args.onActionUpdate, args.first, args.lastCell, args.manualUpdate);\n                    delete curStyle_1.border;\n                }\n                if (curStyle_1.borderTop !== undefined) {\n                    this.setTopBorder(args.style.borderTop, cell, args.rowIdx, args.colIdx, args.pRow, args.pHRow, args.onActionUpdate, args.first, args.lastCell, args.manualUpdate);\n                    delete curStyle_1.borderTop;\n                }\n                if (curStyle_1.borderLeft !== undefined) {\n                    this.setLeftBorder(args.style.borderLeft, cell, args.rowIdx, args.colIdx, args.row, args.onActionUpdate, args.first);\n                    delete curStyle_1.borderLeft;\n                }\n                if (Object.keys(curStyle_1).length) {\n                    if (curStyle_1.borderBottom !== undefined) {\n                        this.setThickBorderHeight(curStyle_1.borderBottom, args.rowIdx, args.colIdx, cell, args.row, args.hRow, args.onActionUpdate, args.lastCell, args.manualUpdate);\n                    }\n                    Object.assign(cell.style, curStyle_1);\n                }\n            }\n            else {\n                if (args.style.borderBottom !== undefined) {\n                    this.setThickBorderHeight(args.style.borderBottom, args.rowIdx, args.colIdx, cell, args.row, args.hRow, args.onActionUpdate, args.lastCell, args.manualUpdate);\n                }\n                Object.assign(cell.style, args.style);\n            }\n            if (args.isHeightCheckNeeded) {\n                if (!sheet.rows[args.rowIdx] || !sheet.rows[args.rowIdx].customHeight) {\n                    if (!args.manualUpdate) {\n                        var cellModel = getCell(args.rowIdx, args.colIdx, sheet);\n                        if (!(cellModel && cellModel.wrap) && this.isHeightCheckNeeded(args.style)) {\n                            setMaxHgt(sheet, args.rowIdx, args.colIdx, getTextHeight(this.parent, args.style));\n                        }\n                        if (args.lastCell) {\n                            var height = getMaxHgt(sheet, args.rowIdx);\n                            if (height > 20 && height > getRowHeight(sheet, args.rowIdx)) {\n                                setRowEleHeight(this.parent, sheet, height, args.rowIdx, args.row, args.hRow, false);\n                            }\n                        }\n                    }\n                    else {\n                        if (!this.checkHeight) {\n                            this.checkHeight = this.isHeightCheckNeeded(args.style, args.onActionUpdate);\n                        }\n                        var isFontSize = false;\n                        if (args.style.fontSize) {\n                            isFontSize = true;\n                        }\n                        if (cell && cell.children[0] && cell.children[0].className === 'e-cf-databar' && args.style.fontSize) {\n                            cell.children[0].querySelector('.e-databar-value').style.fontSize = args.style.fontSize;\n                        }\n                        this.updateRowHeight(args.rowIdx, args.colIdx, args.lastCell, args.onActionUpdate, 0, isFontSize);\n                    }\n                }\n            }\n        }\n        else {\n            this.updateRowHeight(args.rowIdx, args.colIdx, true, args.onActionUpdate);\n        }\n    };\n    CellFormat.prototype.updateRowHeight = function (rowIdx, colIdx, isLastCell, onActionUpdate, borderSize, isFontSize) {\n        if (borderSize === void 0) { borderSize = 0; }\n        if (this.checkHeight) {\n            var hgt = 0;\n            var maxHgt = void 0;\n            var sheet = this.parent.getActiveSheet();\n            var cell = getCell(rowIdx, colIdx, sheet);\n            var td = this.parent.getCell(rowIdx, colIdx);\n            hgt = getTextHeight(this.parent, (cell && cell.style) || this.parent.cellStyle, (cell && cell.wrap) ?\n                getLines(this.parent.getDisplayText(cell), getColumnWidth(sheet, colIdx), cell.style, this.parent.cellStyle) : 1);\n            if (cell && !isNullOrUndefined(cell.value)) {\n                var val = cell.value.toString();\n                if (val.indexOf('\\n') > -1) {\n                    var i = void 0;\n                    var splitVal = cell.value.split('\\n');\n                    var n = 0;\n                    var valLength = splitVal.length;\n                    for (i = 0; i < valLength; i++) {\n                        var lines = getLines(splitVal[i], getColumnWidth(sheet, colIdx), cell.style, this.parent.cellStyle);\n                        if (lines === 0) {\n                            lines = 1; // for empty new line\n                        }\n                        n = n + lines;\n                    }\n                    hgt = getTextHeight(this.parent, cell.style || this.parent.cellStyle, n) + 1;\n                }\n            }\n            if (hgt + borderSize < 20 && isFontSize && getMaxHgt(sheet, rowIdx) >= 20) {\n                hgt = 20; // default height\n            }\n            if (td && td.children[0] && td.children[0].className === 'e-cf-databar') {\n                td.children[0].style.height = '100%';\n                td.children[0].firstElementChild.nextElementSibling.style.height = '100%';\n            }\n            setMaxHgt(sheet, rowIdx, colIdx, hgt + borderSize);\n            if (isLastCell) {\n                this.checkHeight = false;\n                var row = this.parent.getRow(rowIdx);\n                if (!row) {\n                    return;\n                }\n                var prevHeight = getRowHeight(sheet, rowIdx);\n                maxHgt = getMaxHgt(sheet, rowIdx);\n                var heightChanged = onActionUpdate ? maxHgt !== prevHeight : maxHgt > prevHeight;\n                if (heightChanged) {\n                    setRowEleHeight(this.parent, sheet, maxHgt, rowIdx, row);\n                }\n            }\n        }\n    };\n    CellFormat.prototype.isHeightCheckNeeded = function (style, onActionUpdate) {\n        var keys = Object.keys(style);\n        return (onActionUpdate ? keys.indexOf('fontSize') > -1 : keys.indexOf('fontSize') > -1\n            && Number(style.fontSize.split('pt')[0]) > 12) || keys.indexOf('fontFamily') > -1;\n    };\n    CellFormat.prototype.setLeftBorder = function (border, cell, rowIdx, colIdx, row, actionUpdate, first) {\n        if (first && first.includes('Column')) {\n            return;\n        }\n        for (var j = 0; j < cell.rowSpan; j++) {\n            var prevCell = this.parent.getCell(rowIdx + j, colIdx - 1, row);\n            var i = 1;\n            while (prevCell && prevCell.style.display === 'none') {\n                prevCell = this.parent.getCell(rowIdx + j, colIdx - 1 - i, row);\n                i++;\n            }\n            if (prevCell) {\n                if (actionUpdate && border !== '' && colIdx === this.parent.viewport.leftIndex) {\n                    this.parent.getMainContent().scrollLeft -= this.getBorderSize(border);\n                }\n                prevCell.style.borderRight = (border === 'none') ? prevCell.style.borderRight : border;\n            }\n            else {\n                cell.style.borderLeft = border;\n            }\n        }\n    };\n    CellFormat.prototype.setTopBorder = function (border, cell, rowIdx, colIdx, pRow, pHRow, actionUpdate, first, lastCell, manualUpdate) {\n        if (first && first.includes('Row')) {\n            return;\n        }\n        for (var j = 0; j < cell.colSpan; j++) {\n            var prevCell = this.parent.getCell(rowIdx - 1, colIdx + j, pRow);\n            if (prevCell) {\n                if (isHiddenRow(this.parent.getActiveSheet(), rowIdx - 1)) {\n                    var index = [Number(prevCell.parentElement.getAttribute('aria-rowindex')) - 1, colIdx];\n                    if (this.parent.getCellStyleValue(['bottomPriority'], index).bottomPriority) {\n                        return;\n                    }\n                }\n                if (actionUpdate && border !== '' && this.parent.getActiveSheet().topLeftCell.includes(\"\" + (rowIdx + 1))) {\n                    this.parent.getMainContent().scrollTop -= this.getBorderSize(border);\n                }\n                this.setThickBorderHeight(border, rowIdx - 1, colIdx + j, prevCell, pRow, pHRow, actionUpdate, lastCell, manualUpdate);\n                prevCell.style.borderBottom = (border === 'none') ? prevCell.style.borderBottom : border;\n            }\n            else {\n                cell.style.borderTop = border;\n            }\n        }\n    };\n    CellFormat.prototype.setThickBorderHeight = function (border, rowIdx, colIdx, cell, row, hRow, actionUpdate, lastCell, manualUpdate) {\n        var size = border ? this.getBorderSize(border) : 1;\n        var sheet = this.parent.getActiveSheet();\n        if (size > 2 && (!sheet.rows[rowIdx] || !sheet.rows[rowIdx].customHeight)) {\n            if (manualUpdate) {\n                if (!this.checkHeight) {\n                    this.checkHeight = true;\n                }\n                this.updateRowHeight(rowIdx, colIdx, lastCell, actionUpdate, size);\n            }\n            else {\n                var prevHeight = getRowHeight(sheet, rowIdx);\n                var height = Math.ceil(this.parent.calculateHeight(this.parent.getCellStyleValue(['fontFamily', 'fontSize'], [rowIdx, colIdx]), 1, 3));\n                if (height > prevHeight) {\n                    setRowEleHeight(this.parent, sheet, height, rowIdx, row, hRow, false);\n                    this.parent.notify(rowHeightChanged, { rowIdx: rowIdx, threshold: height - 20 });\n                }\n            }\n        }\n        if (actionUpdate && (lastCell || !this.checkHeight) && size < 3 && (!sheet.rows[rowIdx] || !sheet.rows[rowIdx].customHeight)) {\n            if (!this.checkHeight) {\n                this.checkHeight = true;\n            }\n            this.updateRowHeight(rowIdx, colIdx, lastCell, actionUpdate, size);\n        }\n    };\n    CellFormat.prototype.getBorderSize = function (border) {\n        var size = border.split(' ')[0];\n        return size === 'thin' ? 1 : (size === 'medium' ? 2 : (size === 'thick' ? 3 :\n            (parseInt(size, 10) ? parseInt(size, 10) : 1)));\n    };\n    CellFormat.prototype.clearObj = function (args) {\n        var options = args.options;\n        var range = options.range ? (options.range.indexOf('!') > 0) ? options.range.split('!')[1] : options.range.split('!')[0]\n            : this.parent.getActiveSheet().selectedRange;\n        var sheetIndex = (options.range && options.range.indexOf('!') > 0) ?\n            getSheetIndex(this.parent, options.range.split('!')[0]) : this.parent.activeSheetIndex;\n        var rangeIdx = getRangeIndexes(range);\n        var sheet = this.parent.sheets[sheetIndex];\n        var sRIdx = rangeIdx[0];\n        var eRIdx = rangeIdx[2];\n        var sCIdx;\n        var eCIdx;\n        var eventArgs = { range: range, type: options.type, requestType: 'clear', sheetIndex: sheetIndex };\n        if (!args.isPublic) {\n            this.parent.notify(beginAction, { action: 'beforeClear', eventArgs: eventArgs });\n        }\n        if (options.type === 'Clear Formats' || options.type === 'Clear All') {\n            this.parent.notify(clearCFRule, { range: range, isPublic: false });\n            for (sRIdx; sRIdx <= eRIdx; sRIdx++) {\n                sCIdx = rangeIdx[1];\n                eCIdx = rangeIdx[3];\n                for (sCIdx; sCIdx <= eCIdx; sCIdx++) {\n                    var cell = getCell(sRIdx, sCIdx, sheet);\n                    var cellElem = this.parent.getCell(sRIdx, sCIdx);\n                    if (cell) {\n                        if (cell.wrap) {\n                            this.parent.notify(wrapEvent, { range: [sRIdx, sCIdx, sRIdx, sCIdx], wrap: false, sheet: sheet });\n                        }\n                        if (cell.hyperlink) {\n                            removeClass(cellElem.querySelectorAll('.e-hyperlink'), 'e-hyperlink-style');\n                            if (options.type === 'Clear All') {\n                                this.parent.removeHyperlink(getRangeAddress([sRIdx, sCIdx, sRIdx, sCIdx]));\n                            }\n                        }\n                    }\n                }\n            }\n        }\n        if (options.type === 'Clear Hyperlinks') {\n            this.parent.removeHyperlink(range);\n        }\n        this.parent.notify(clear, { range: sheet.name + '!' + range, type: options.type });\n        this.parent.serviceLocator.getService('cell').refreshRange(getRangeIndexes(range));\n        if (!args.isPublic) {\n            eventArgs = { range: sheet.name + '!' + range, type: options.type, sheetIndex: sheetIndex };\n            this.parent.notify('actionComplete', { eventArgs: eventArgs, action: 'clear' });\n        }\n    };\n    CellFormat.prototype.addEventListener = function () {\n        this.parent.on(applyCellFormat, this.applyCellFormat, this);\n        this.parent.on(clearViewer, this.clearObj, this);\n    };\n    CellFormat.prototype.removeEventListener = function () {\n        if (!this.parent.isDestroyed) {\n            this.parent.off(initialLoad, this.addEventListener);\n            this.parent.off(applyCellFormat, this.applyCellFormat);\n            this.parent.off(clearViewer, this.clearObj);\n        }\n    };\n    /**\n     * Destroy cell format module.\n     */\n    CellFormat.prototype.destroy = function () {\n        this.removeEventListener();\n        this.parent = null;\n        this.row = null;\n        this.checkHeight = null;\n    };\n    /**\n     * Get the cell format module name.\n     */\n    CellFormat.prototype.getModuleName = function () {\n        return 'cellformat';\n    };\n    return CellFormat;\n}());\nexport { CellFormat };\n","import { closest, EventHandler } from '@syncfusion/ej2-base';\nimport { colWidthChanged, rowHeightChanged, beforeHeaderLoaded, contentLoaded, hideShow, getFilterRange } from '../common/index';\nimport { findMaxValue, setResize, autoFit, completeAction, setAutoFit } from '../common/index';\nimport { setRowHeight, isHiddenRow, getRowHeight, getColumnWidth, setColumn, isHiddenCol } from '../../workbook/base/index';\nimport { getColumn, setRow, getCell } from '../../workbook/base/index';\nimport { getRangeIndexes, getSwapRange, getCellIndexes, setMerge } from '../../workbook/common/index';\n/**\n * The `Resize` module is used to handle the resizing functionalities in Spreadsheet.\n */\nvar Resize = /** @class */ (function () {\n    /**\n     * Constructor for resize module in Spreadsheet.\n     * @private\n     */\n    function Resize(parent) {\n        this.parent = parent;\n        this.addEventListener();\n    }\n    Resize.prototype.addEventListener = function () {\n        this.parent.on(contentLoaded, this.wireEvents, this);\n        this.parent.on(beforeHeaderLoaded, this.wireEvents, this);\n        this.parent.on(autoFit, this.autoFit, this);\n        this.parent.on(setAutoFit, this.setAutoFitHandler, this);\n    };\n    Resize.prototype.autoFit = function (args) {\n        var element = args.isRow ? this.parent.getRowHeaderTable() : this.parent.getColHeaderTable().rows[0];\n        for (var i = args.startIndex; i <= args.endIndex; i++) {\n            this.trgtEle = args.isRow ? this.parent.getRow(i, element) :\n                this.parent.getCell(null, i, element);\n            this.setAutofit(i, !args.isRow);\n        }\n    };\n    Resize.prototype.wireEvents = function (args) {\n        if (this.parent.getActiveSheet().showHeaders) {\n            var rowHeader = args ? args.element : this.parent.getRowHeaderContent();\n            var colHeader = this.parent.getColumnHeaderContent();\n            EventHandler.add(colHeader, 'dblclick', this.dblClickHandler, this);\n            EventHandler.add(rowHeader, 'dblclick', this.dblClickHandler, this);\n            EventHandler.add(colHeader, 'mousedown', this.mouseDownHandler, this);\n            EventHandler.add(rowHeader, 'mousedown', this.mouseDownHandler, this);\n            this.wireResizeCursorEvent(rowHeader, colHeader);\n        }\n    };\n    Resize.prototype.wireResizeCursorEvent = function (rowHeader, colHeader) {\n        EventHandler.add(rowHeader, 'mousemove', this.setTarget, this);\n        EventHandler.add(colHeader, 'mousemove', this.setTarget, this);\n    };\n    Resize.prototype.unWireResizeCursorEvent = function () {\n        EventHandler.remove(this.parent.getRowHeaderContent(), 'mousemove', this.setTarget);\n        EventHandler.remove(this.parent.getColumnHeaderContent(), 'mousemove', this.setTarget);\n    };\n    Resize.prototype.unwireEvents = function () {\n        if (this.parent.getActiveSheet().showHeaders) {\n            EventHandler.remove(this.parent.getColumnHeaderContent(), 'dblclick', this.dblClickHandler);\n            EventHandler.remove(this.parent.getRowHeaderContent(), 'dblclick', this.dblClickHandler);\n            EventHandler.remove(this.parent.getColumnHeaderContent(), 'mousedown', this.mouseDownHandler);\n            EventHandler.remove(this.parent.getRowHeaderContent(), 'mousedown', this.mouseDownHandler);\n            this.unWireResizeCursorEvent();\n        }\n    };\n    Resize.prototype.removeEventListener = function () {\n        if (!this.parent.isDestroyed) {\n            this.parent.off(contentLoaded, this.wireEvents);\n            this.parent.off(beforeHeaderLoaded, this.wireEvents);\n            this.parent.off(autoFit, this.autoFit);\n            this.parent.off(setAutoFit, this.setAutoFitHandler);\n        }\n    };\n    Resize.prototype.mouseMoveHandler = function (e) {\n        var sheetPanel = this.parent.element.getElementsByClassName('e-sheet-panel')[0];\n        var colResizeHandler = this.parent.element.getElementsByClassName('e-colresize-handler')[0];\n        var rowResizeHandler = this.parent.element.getElementsByClassName('e-rowresize-handler')[0];\n        if (colResizeHandler || rowResizeHandler) {\n            this.isMouseMoved = true;\n            if (colResizeHandler) {\n                if (e.x > this.trgtEle.parentElement.firstChild.getBoundingClientRect().left) {\n                    colResizeHandler.style.left = e.clientX - this.parent.element.getBoundingClientRect().left + 'px';\n                }\n            }\n            else if (rowResizeHandler) {\n                if (e.y >= this.trgtEle.parentElement.parentElement.firstChild.getBoundingClientRect().top) {\n                    rowResizeHandler.style.top = e.clientY - sheetPanel.getBoundingClientRect().top + 'px';\n                }\n            }\n        }\n    };\n    Resize.prototype.mouseDownHandler = function (e) {\n        this.event = e;\n        this.trgtEle = e.target;\n        if (this.trgtEle.parentElement.classList.contains('e-hide-end') || this.trgtEle.classList.contains('e-hide-end')) {\n            var offsetSize = this.trgtEle.offsetHeight;\n            var offset = e.offsetY;\n            if ((offsetSize >= 10 && offset < 5) || (offsetSize - 2 < 8 && offset < Math.ceil((offset - 2) / 2))) {\n                this.trgtEle.classList.add('e-skip-resize');\n            }\n        }\n        this.updateTarget(e, this.trgtEle);\n        var trgt = this.trgtEle;\n        var className = trgt.classList.contains('e-colresize') ? 'e-colresize-handler' :\n            trgt.classList.contains('e-rowresize') ? 'e-rowresize-handler' : '';\n        this.createResizeHandler(trgt, className);\n        this.unWireResizeCursorEvent();\n        EventHandler.add(this.parent.element, 'mousemove', this.mouseMoveHandler, this);\n        EventHandler.add(document, 'mouseup', this.mouseUpHandler, this);\n    };\n    Resize.prototype.mouseUpHandler = function (e) {\n        var colResizeHandler = this.parent.element.getElementsByClassName('e-colresize-handler')[0];\n        var rowResizeHandler = this.parent.element.getElementsByClassName('e-rowresize-handler')[0];\n        this.resizeOn(e);\n        this.isMouseMoved = null;\n        var resizeHandler = colResizeHandler ? colResizeHandler : rowResizeHandler;\n        if (resizeHandler) {\n            this.parent.element.getElementsByClassName('e-sheet-panel')[0].removeChild(resizeHandler);\n            this.updateCursor(e);\n        }\n        EventHandler.remove(document, 'mouseup', this.mouseUpHandler);\n        EventHandler.remove(this.parent.element, 'mousemove', this.mouseMoveHandler);\n        this.wireResizeCursorEvent(this.parent.getRowHeaderContent(), this.parent.getColumnHeaderContent());\n    };\n    Resize.prototype.dblClickHandler = function (e) {\n        this.trgtEle = e.target;\n        this.updateTarget(e, this.trgtEle);\n        if (this.trgtEle.classList.contains('e-colresize')) {\n            var colIndx = parseInt(this.trgtEle.getAttribute('aria-colindex'), 10) - 1;\n            var prevWidth = getColumnWidth(this.parent.getActiveSheet(), colIndx) + \"px\";\n            if (this.trgtEle.classList.contains('e-unhide-column')) {\n                this.showHiddenColumns(colIndx - 1);\n            }\n            else {\n                this.setAutofit(colIndx, true, prevWidth);\n            }\n        }\n        else if (this.trgtEle.classList.contains('e-rowresize')) {\n            var rowIndx = parseInt(this.trgtEle.parentElement.getAttribute('aria-rowindex'), 10) - 1;\n            var prevHeight = getRowHeight(this.parent.getActiveSheet(), rowIndx) + \"px\";\n            this.setAutofit(rowIndx, false, prevHeight);\n        }\n    };\n    Resize.prototype.setTarget = function (e) {\n        var trgt = e.target;\n        var sheet = this.parent.getActiveSheet();\n        if (sheet.isProtected && (!sheet.protectSettings.formatColumns || !sheet.protectSettings.formatRows)) {\n            if (!sheet.protectSettings.formatRows && !sheet.protectSettings.formatColumns) {\n                return;\n            }\n            if (sheet.protectSettings.formatRows) {\n                if (closest(trgt, '.e-colhdr-table')) {\n                    return;\n                }\n            }\n            if (sheet.protectSettings.formatColumns) {\n                if (closest(trgt, '.e-rowhdr-table')) {\n                    return;\n                }\n            }\n        }\n        var newTrgt;\n        var tOffsetV;\n        var eOffsetV;\n        var tClass;\n        if (closest(trgt, '.e-header-row')) {\n            eOffsetV = e.offsetX;\n            tOffsetV = trgt.offsetWidth;\n            tClass = 'e-colresize';\n            if (trgt.previousElementSibling) {\n                newTrgt = trgt.previousElementSibling;\n            }\n            else {\n                if (Number(trgt.getAttribute('aria-colindex')) > 1) {\n                    newTrgt = trgt;\n                }\n            }\n        }\n        else if (closest(trgt, '.e-row')) {\n            eOffsetV = e.offsetY;\n            tOffsetV = trgt.offsetHeight;\n            tClass = 'e-rowresize';\n            if (trgt.parentElement.previousElementSibling) {\n                newTrgt = trgt.parentElement.previousElementSibling.firstElementChild;\n            }\n            else {\n                if (Number(trgt.parentElement.getAttribute('aria-rowindex')) > 1) {\n                    newTrgt = trgt;\n                }\n            }\n        }\n        if (tOffsetV - 2 < 8 && eOffsetV !== Math.ceil((tOffsetV - 2) / 2)) {\n            if (eOffsetV < Math.ceil((tOffsetV - 2) / 2)) {\n                trgt.classList.add(tClass);\n                newTrgt.classList.add(tClass);\n            }\n            else if (eOffsetV > Math.ceil((tOffsetV - 2) / 2)) {\n                trgt.classList.add(tClass);\n            }\n        }\n        else if (tOffsetV - 5 < eOffsetV && eOffsetV <= tOffsetV && tOffsetV >= 10) {\n            trgt.classList.add(tClass);\n        }\n        else if (eOffsetV < 5 && newTrgt && tOffsetV >= 10) {\n            trgt.classList.add(tClass);\n            newTrgt.classList.add(tClass);\n        }\n        else {\n            var resEle = (tClass === 'e-colresize' ? trgt.parentElement.getElementsByClassName(tClass)\n                : this.parent.getRowHeaderTable().getElementsByClassName(tClass));\n            for (var index = 0; index < resEle.length; index++) {\n                resEle[index].classList.remove(tClass);\n            }\n        }\n    };\n    Resize.prototype.updateTarget = function (e, trgt) {\n        if (closest(trgt, '.e-header-row')) {\n            if ((trgt.offsetWidth < 10 && e.offsetX < Math.ceil((trgt.offsetWidth - 2) / 2)) || (e.offsetX < 5 &&\n                trgt.offsetWidth >= 10) && trgt.classList.contains('e-colresize')) {\n                var sheet = this.parent.getActiveSheet();\n                var prevIdx = Number(this.trgtEle.getAttribute('aria-colindex')) - 2;\n                if (trgt.previousElementSibling && !isHiddenCol(sheet, prevIdx)) {\n                    this.trgtEle = trgt.previousElementSibling;\n                }\n                else {\n                    if (prevIdx > -1) {\n                        this.trgtEle.classList.add('e-unhide-column');\n                    }\n                }\n            }\n        }\n        else {\n            if ((trgt.offsetHeight < 10 && e.offsetY < Math.ceil((trgt.offsetHeight - 2) / 2)) || (e.offsetY < 5 &&\n                trgt.offsetHeight >= 10) && trgt.classList.contains('e-rowresize')) {\n                var sheet = this.parent.getActiveSheet();\n                var prevIdx = Number(trgt.parentElement.getAttribute('aria-rowindex')) - 2;\n                if (trgt.parentElement.previousElementSibling || isHiddenRow(sheet, prevIdx)) {\n                    if (e.type === 'dblclick' && isHiddenRow(sheet, prevIdx)) {\n                        var selectRange = getSwapRange(getRangeIndexes(this.parent.getActiveSheet().selectedRange));\n                        var eventArgs = void 0;\n                        if (prevIdx <= selectRange[2] && prevIdx > selectRange[0]) {\n                            eventArgs = { startIndex: selectRange[0], endIndex: selectRange[2], hide: false, autoFit: true };\n                        }\n                        else {\n                            eventArgs = { startIndex: prevIdx, endIndex: prevIdx, hide: false, autoFit: true };\n                        }\n                        this.parent.notify(hideShow, eventArgs);\n                    }\n                    else {\n                        if (!isHiddenRow(sheet, prevIdx)) {\n                            this.trgtEle = trgt.parentElement.previousElementSibling.getElementsByClassName('e-header-cell')[0];\n                        }\n                    }\n                }\n            }\n        }\n    };\n    Resize.prototype.setAutoFitHandler = function (args) {\n        this.setAutofit(args.idx, args.isCol);\n    };\n    // tslint:disable-next-line:max-func-body-length\n    Resize.prototype.setAutofit = function (idx, isCol, prevData) {\n        var index = 0;\n        var sheet = this.parent.getActiveSheet();\n        var mainContent = this.parent.getMainContent();\n        var oldValue = isCol ? getColumnWidth(this.parent.getActiveSheet(), idx) + \"px\" :\n            getRowHeight(this.parent.getActiveSheet(), idx) + \"px\";\n        var contentClone = [];\n        var contentTable = mainContent.getElementsByClassName('e-content-table')[0];\n        if (this.parent.getActiveSheet().showHeaders) {\n            var headerTable = isCol ? this.parent.getColHeaderTable() : this.parent.getRowHeaderTable();\n            var headerRow = headerTable.getElementsByTagName('tr');\n        }\n        var headerText;\n        var isWrap = false;\n        if (isCol) {\n            var rowLength = sheet.rows.length;\n            for (var rowIdx = 0; rowIdx < rowLength; rowIdx++) {\n                if (sheet.rows[rowIdx] && sheet.rows[rowIdx].cells && sheet.rows[rowIdx].cells[idx]) {\n                    if (getCell(rowIdx, idx, sheet).wrap) {\n                        isWrap = true;\n                    }\n                    var td = this.parent.createElement('td', { className: 'e-cell' });\n                    td.textContent = this.parent.getDisplayText(sheet.rows[rowIdx].cells[idx]);\n                    if (sheet.rows[rowIdx].cells[idx].style) {\n                        var style = sheet.rows[rowIdx].cells[idx].style;\n                        if (style.fontFamily) {\n                            td.style.fontFamily = style.fontFamily;\n                        }\n                        if (style.fontSize) {\n                            td.style.fontSize = style.fontSize;\n                        }\n                    }\n                    contentClone[index] = td;\n                    index++;\n                }\n            }\n        }\n        else {\n            var colLength = sheet.rows[idx] && sheet.rows[idx].cells ? sheet.rows[idx].cells.length : 0;\n            for (var colIdx = 0; colIdx < colLength; colIdx++) {\n                if (sheet.rows[idx] && sheet.rows[idx].cells[colIdx]) {\n                    if (getCell(idx, colIdx, sheet).wrap) {\n                        isWrap = true;\n                    }\n                    var style = sheet.rows[idx].cells[colIdx].style;\n                    var td = this.parent.createElement('td');\n                    td.textContent = this.parent.getDisplayText(sheet.rows[idx].cells[colIdx]);\n                    if (sheet.rows[idx].cells[colIdx].style) {\n                        var style_1 = sheet.rows[idx].cells[colIdx].style;\n                        if (style_1.fontFamily) {\n                            td.style.fontFamily = style_1.fontFamily;\n                        }\n                        if (style_1.fontSize) {\n                            td.style.fontSize = style_1.fontSize;\n                        }\n                    }\n                    contentClone[index] = td;\n                    index++;\n                }\n            }\n        }\n        var contentFit = findMaxValue(contentTable, contentClone, isCol, this.parent, prevData, isWrap);\n        if (isCol) {\n            contentFit = this.getFloatingElementWidth(contentFit, idx);\n        }\n        var autofitValue = contentFit === 0 ? parseInt(oldValue, 10) : contentFit;\n        var threshold = parseInt(oldValue, 10) > autofitValue ?\n            -(parseInt(oldValue, 10) - autofitValue) : autofitValue - parseInt(oldValue, 10);\n        if (isCol) {\n            if (idx >= this.parent.viewport.leftIndex && idx <= this.parent.viewport.rightIndex) {\n                getColumn(sheet, idx).width = autofitValue > 0 ? autofitValue : 0;\n                this.parent.notify(colWidthChanged, { threshold: threshold, colIdx: idx });\n                this.resizeStart(idx, this.parent.getViewportIndex(idx, true), autofitValue + 'px', isCol, true, prevData);\n            }\n            else {\n                var oldWidth = getColumnWidth(sheet, idx);\n                var threshold_1;\n                if (autofitValue > 0) {\n                    threshold_1 = -(oldWidth - autofitValue);\n                }\n                else {\n                    threshold_1 = -oldWidth;\n                }\n                this.parent.notify(colWidthChanged, { threshold: threshold_1, colIdx: idx });\n                getColumn(sheet, idx).width = autofitValue > 0 ? autofitValue : 0;\n            }\n        }\n        else if (!isCol) {\n            if (idx >= this.parent.viewport.topIndex && idx <= this.parent.viewport.bottomIndex) {\n                autofitValue = autofitValue > 20 ? autofitValue : 20;\n                setRowHeight(sheet, idx, autofitValue > 0 ? autofitValue : 0);\n                this.parent.notify(rowHeightChanged, { threshold: threshold, rowIdx: idx });\n                this.resizeStart(idx, this.parent.getViewportIndex(idx), autofitValue + 'px', isCol, true, prevData);\n            }\n            else {\n                var oldHeight = getRowHeight(sheet, idx);\n                var threshold_2;\n                if (autofitValue > 0) {\n                    threshold_2 = -(oldHeight - autofitValue);\n                }\n                else {\n                    threshold_2 = -oldHeight;\n                }\n                this.parent.notify(rowHeightChanged, { threshold: threshold_2, rowIdx: idx });\n                setRowHeight(sheet, idx, autofitValue > 0 ? autofitValue : 0);\n            }\n        }\n    };\n    Resize.prototype.createResizeHandler = function (trgt, className) {\n        var editor = this.parent.createElement('div', { className: className });\n        if (trgt.classList.contains('e-colresize')) {\n            editor.style.height = this.parent.getMainContent().clientHeight + trgt.offsetHeight + 'px';\n            editor.style.left = this.event.clientX - this.parent.element.getBoundingClientRect().left + 'px';\n            editor.style.top = '0px';\n        }\n        else if (trgt.classList.contains('e-rowresize')) {\n            editor.style.width = this.parent.getMainContent().clientWidth + trgt.offsetWidth + 'px';\n            editor.style.left = '0px';\n            editor.style.top = this.event.clientY\n                - this.parent.element.getElementsByClassName('e-sheet-panel')[0].getBoundingClientRect().top + 'px';\n        }\n        this.parent.element.getElementsByClassName('e-sheet-panel')[0].appendChild(editor);\n        this.updateCursor(this.event);\n    };\n    Resize.prototype.setColWidth = function (index, viewportIdx, width, curWidth) {\n        var sheet = this.parent.getActiveSheet();\n        var threshold = width - curWidth;\n        if (threshold < 0 && curWidth < -(threshold)) {\n            threshold = -curWidth;\n        }\n        if (width > 0) {\n            if (this.isMouseMoved && this.trgtEle.classList.contains('e-unhide-column')) {\n                this.showHiddenColumns(index, width);\n                this.parent.notify(completeAction, {\n                    eventArgs: {\n                        index: index, width: 0 + \"px\", isCol: true, sheetIdx: this.parent.activeSheetIndex, oldWidth: curWidth + \"px\",\n                        hide: false\n                    }, action: 'resize'\n                });\n                return;\n            }\n            this.parent.notify(colWidthChanged, { threshold: threshold, colIdx: index });\n            this.resizeStart(index, viewportIdx, width + \"px\", true, false, curWidth + \"px\");\n            setColumn(sheet, index, { width: width, customWidth: true });\n        }\n        else {\n            if (this.isMouseMoved) {\n                this.parent.hideColumn(index);\n                this.parent.notify(completeAction, {\n                    eventArgs: {\n                        index: index, width: 0 + \"px\", isCol: true, sheetIdx: this.parent.activeSheetIndex, oldWidth: curWidth + \"px\",\n                        hide: true\n                    }, action: 'resize'\n                });\n            }\n        }\n    };\n    Resize.prototype.showHiddenColumns = function (index, width) {\n        var sheet = this.parent.getActiveSheet();\n        var selectedRange = getRangeIndexes(sheet.selectedRange);\n        var startIdx;\n        var endIdx;\n        var colgroup;\n        if (index >= selectedRange[1] && index <= selectedRange[3] && selectedRange[2] === sheet.rowCount - 1 &&\n            getCellIndexes(sheet.activeCell)[0] === getCellIndexes(sheet.topLeftCell)[0]) {\n            startIdx = selectedRange[1];\n            endIdx = selectedRange[3];\n            colgroup = this.parent.getMainContent().querySelector('colgroup');\n        }\n        else {\n            startIdx = endIdx = index;\n        }\n        if (width !== undefined) {\n            for (var i = startIdx; i <= endIdx; i++) {\n                setColumn(sheet, i, { width: width, customWidth: true });\n                if (i >= this.parent.viewport.leftIndex && i <= this.parent.viewport.rightIndex && !isHiddenCol(sheet, i)) {\n                    colgroup.children[this.parent.getViewportIndex(i, true)].style.width = width + \"px\";\n                }\n            }\n        }\n        this.trgtEle.classList.remove('e-unhide-column');\n        this.parent.hideColumn(startIdx, endIdx, false);\n        if (width === undefined) {\n            this.autoFit({ isRow: false, startIndex: startIdx, endIndex: endIdx });\n        }\n    };\n    Resize.prototype.setRowHeight = function (rowIdx, viewportIdx, height, prevData) {\n        var sheet = this.parent.getActiveSheet();\n        var eleHeight = parseInt(this.parent.getMainContent().getElementsByTagName('tr')[viewportIdx].style.height, 10);\n        var rowHeight = height;\n        var threshold = parseInt(rowHeight, 10) - eleHeight;\n        if (threshold < 0 && eleHeight < -(threshold)) {\n            threshold = -eleHeight;\n        }\n        this.parent.notify(rowHeightChanged, { threshold: threshold, rowIdx: rowIdx, isCustomHgt: true });\n        this.resizeStart(rowIdx, viewportIdx, rowHeight, false, false, prevData);\n        setRow(sheet, rowIdx, { height: parseInt(rowHeight, 10) > 0 ? parseInt(rowHeight, 10) : 0, customHeight: true });\n    };\n    Resize.prototype.resizeOn = function (e) {\n        var _this = this;\n        var idx;\n        var actualIdx;\n        if (this.trgtEle.classList.contains('e-rowresize')) {\n            var sheet = this.parent.getActiveSheet();\n            var prevIdx = Number(this.trgtEle.parentElement.getAttribute('aria-rowindex')) - 2;\n            if (this.isMouseMoved && isHiddenRow(sheet, prevIdx) && this.trgtEle.classList.contains('e-skip-resize') &&\n                e.clientY > this.trgtEle.getBoundingClientRect().top) {\n                this.trgtEle.classList.remove('e-skip-resize');\n                var eventArgs = { startIndex: prevIdx, endIndex: prevIdx, hide: false, skipAppend: true };\n                this.parent.notify(hideShow, eventArgs);\n                var rTbody = this.parent.getRowHeaderTable().tBodies[0];\n                var tbody = this.parent.getContentTable().tBodies[0];\n                eventArgs.hdrRow.style.display = 'none';\n                eventArgs.row.style.display = 'none';\n                rTbody.insertBefore(eventArgs.hdrRow, rTbody.children[eventArgs.insertIdx]);\n                tbody.insertBefore(eventArgs.row, tbody.children[eventArgs.insertIdx]);\n                this.trgtEle = eventArgs.hdrRow.firstElementChild;\n                eventArgs.hdrRow.nextElementSibling.classList.remove('e-hide-end');\n                eventArgs.mergeCollection.forEach(function (mergeArgs) { _this.parent.notify(setMerge, mergeArgs); });\n            }\n            else {\n                if (this.trgtEle.classList.contains('e-skip-resize')) {\n                    this.trgtEle.classList.remove('e-skip-resize');\n                    if ((!this.isMouseMoved && isHiddenRow(sheet, prevIdx)) || !this.trgtEle.parentElement.previousElementSibling) {\n                        return;\n                    }\n                    this.trgtEle = this.trgtEle.parentElement.previousElementSibling.getElementsByClassName('e-header-cell')[0];\n                }\n            }\n            actualIdx = idx = parseInt(this.trgtEle.parentElement.getAttribute('aria-rowindex'), 10) - 1;\n            idx = this.parent.getViewportIndex(actualIdx);\n            var prevData = this.parent.getMainContent().getElementsByClassName('e-row')[idx].style.height;\n            var rowHeight = e.clientY - this.event.clientY + parseInt(prevData, 10);\n            if (rowHeight <= 0) {\n                this.parent.hideRow(actualIdx);\n                setRow(sheet, actualIdx, { height: 0, customHeight: true });\n                this.parent.notify(completeAction, {\n                    eventArgs: { index: actualIdx, height: '0px', isCol: false, sheetIdx: this.parent.activeSheetIndex, oldHeight: prevData },\n                    action: 'resize'\n                });\n                return;\n            }\n            this.setRowHeight(actualIdx, idx, rowHeight + \"px\", prevData);\n            if (this.trgtEle.parentElement.style.display === 'none') {\n                var sheet_1 = this.parent.getActiveSheet();\n                var selectedRange = getSwapRange(getRangeIndexes(sheet_1.selectedRange));\n                if (actualIdx <= selectedRange[2] && actualIdx > selectedRange[0]) {\n                    rowHeight = sheet_1.rows[actualIdx].height;\n                    var count = void 0;\n                    for (var i = selectedRange[0]; i <= selectedRange[2]; i++) {\n                        if (i === actualIdx) {\n                            continue;\n                        }\n                        prevData = getRowHeight(sheet_1, i) + \"px\";\n                        setRow(sheet_1, i, { customHeight: true, height: rowHeight });\n                        if (isHiddenRow(sheet_1, i)) {\n                            if (!count) {\n                                count = i;\n                            }\n                        }\n                        else {\n                            this.parent.getRow(i).style.height = rowHeight + \"px\";\n                            if (sheet_1.showHeaders) {\n                                this.parent.getRow(i, this.parent.getRowHeaderTable()).style.height = rowHeight + \"px\";\n                            }\n                        }\n                        this.parent.notify(completeAction, {\n                            eventArgs: {\n                                index: i, height: rowHeight + \"px\", isCol: false,\n                                sheetIdx: this.parent.activeSheetIndex, oldHeight: prevData\n                            },\n                            action: 'resize'\n                        });\n                    }\n                    this.parent.hideRow(selectedRange[0], actualIdx - 1, false);\n                    idx += Math.abs(actualIdx - count);\n                }\n                else {\n                    if (idx !== 0 && !isHiddenRow(sheet_1, actualIdx - 1)) {\n                        this.trgtEle.parentElement.previousElementSibling.classList.remove('e-hide-start');\n                    }\n                    else {\n                        if (idx !== 0) {\n                            this.trgtEle.parentElement.classList.add('e-hide-end');\n                        }\n                    }\n                    this.parent.selectRange(sheet_1.selectedRange);\n                }\n                this.trgtEle.parentElement.style.display = '';\n                this.parent.getContentTable().rows[idx].style.display = '';\n            }\n        }\n        else if (this.trgtEle.classList.contains('e-colresize')) {\n            if (this.isMouseMoved && this.trgtEle.classList.contains('e-unhide-column') &&\n                e.clientX < this.trgtEle.getBoundingClientRect().left) {\n                this.trgtEle.classList.remove('e-unhide-column');\n                if (this.trgtEle.previousElementSibling) {\n                    this.trgtEle = this.trgtEle.previousElementSibling;\n                }\n            }\n            idx = parseInt(this.trgtEle.getAttribute('aria-colindex'), 10) - 1;\n            var curWidth = void 0;\n            if (this.trgtEle.classList.contains('e-unhide-column')) {\n                idx -= 1;\n                curWidth = 0;\n            }\n            else {\n                curWidth = getColumnWidth(this.parent.getActiveSheet(), idx);\n            }\n            this.setColWidth(idx, this.parent.getViewportIndex(idx, true), (e.clientX - this.event.clientX) + curWidth, curWidth);\n        }\n    };\n    Resize.prototype.setWidthAndHeight = function (trgt, value, isCol) {\n        if (isCol) {\n            trgt.style.width = parseInt(trgt.style.width, 10) + value + 'px';\n        }\n        else {\n            trgt.style.height = parseInt(trgt.style.height, 10) + value + 'px';\n        }\n    };\n    Resize.prototype.resizeStart = function (idx, viewportIdx, value, isCol, isFit, prevData) {\n        if (this.parent.getActiveSheet().showHeaders) {\n            setResize(viewportIdx, value, isCol, this.parent);\n        }\n        else {\n            if (isCol) {\n                var curEle = this.parent.element.getElementsByClassName('e-sheet-content')[0].getElementsByTagName('col')[viewportIdx];\n                curEle.style.width = value;\n            }\n            else {\n                var curEle = this.parent.element.getElementsByClassName('e-sheet-content')[0].getElementsByTagName('tr')[viewportIdx];\n                curEle.style.height = value;\n            }\n        }\n        var action = isFit ? 'resizeToFit' : 'resize';\n        var eventArgs;\n        var isAction;\n        if (isCol) {\n            eventArgs = { index: idx, width: value, isCol: isCol, sheetIdx: this.parent.activeSheetIndex, oldWidth: prevData };\n            isAction = prevData !== value;\n        }\n        else {\n            eventArgs = { index: idx, height: value, isCol: isCol, sheetIdx: this.parent.activeSheetIndex, oldHeight: prevData };\n            isAction = prevData !== value;\n        }\n        if (isAction) {\n            this.parent.notify(completeAction, { eventArgs: eventArgs, action: action });\n        }\n    };\n    Resize.prototype.updateCursor = function (e) {\n        if (this.parent.element.getElementsByClassName('e-colresize-handler')[0]) {\n            this.parent.element.classList.add('e-col-resizing');\n        }\n        else if (this.parent.element.classList.contains('e-col-resizing')) {\n            this.parent.element.classList.remove('e-col-resizing');\n        }\n        if (this.parent.element.getElementsByClassName('e-rowresize-handler')[0]) {\n            this.parent.element.classList.add('e-row-resizing');\n        }\n        else if (this.parent.element.classList.contains('e-row-resizing')) {\n            this.parent.element.classList.remove('e-row-resizing');\n        }\n    };\n    // To get the floating element width like filter\n    Resize.prototype.getFloatingElementWidth = function (oldWidth, colIdx) {\n        var floatingWidth = oldWidth;\n        var eventArgs = { filterRange: [], hasFilter: false };\n        this.parent.notify(getFilterRange, eventArgs);\n        if (eventArgs.hasFilter && eventArgs.filterRange) {\n            if (eventArgs.filterRange[1] <= colIdx && eventArgs.filterRange[3] >= colIdx) {\n                floatingWidth = oldWidth + 22; // default width and padding for button \n            }\n        }\n        return floatingWidth;\n    };\n    /**\n     * To destroy the resize module.\n     * @return {void}\n     */\n    Resize.prototype.destroy = function () {\n        this.unwireEvents();\n        this.removeEventListener();\n        this.parent = null;\n    };\n    /**\n     * Get the module name.\n     * @returns string\n     */\n    Resize.prototype.getModuleName = function () {\n        return 'resize';\n    };\n    return Resize;\n}());\nexport { Resize };\n","import { collaborativeUpdate, updateAction } from '../common/index';\n/**\n * Collaborative Editing module for real time changes in the Spreadsheet.\n */\nvar CollaborativeEditing = /** @class */ (function () {\n    function CollaborativeEditing(parent) {\n        this.parent = parent;\n        this.addEventListener();\n    }\n    CollaborativeEditing.prototype.refreshClients = function (options) {\n        updateAction(options, this.parent);\n    };\n    CollaborativeEditing.prototype.addEventListener = function () {\n        this.parent.on(collaborativeUpdate, this.refreshClients, this);\n    };\n    CollaborativeEditing.prototype.removeEventListener = function () {\n        if (!this.parent.isDestroyed) {\n            this.parent.off(collaborativeUpdate, this.refreshClients);\n        }\n    };\n    /**\n     * Destroy collaborative editing module.\n     */\n    CollaborativeEditing.prototype.destroy = function () {\n        this.removeEventListener();\n        this.parent = null;\n    };\n    /**\n     * Get the collaborative editing module name.\n     */\n    CollaborativeEditing.prototype.getModuleName = function () {\n        return 'collaborativeEditing';\n    };\n    return CollaborativeEditing;\n}());\nexport { CollaborativeEditing };\n","import { spreadsheetDestroyed, getUpdateUsingRaf } from '../common/index';\nimport { autoFit, hideShow, virtualContentLoaded, completeAction, setScrollEvent, onContentScroll, skipHiddenIdx } from '../common/index';\nimport { beginAction, hiddenMerge, updateTableWidth } from '../common/index';\nimport { getCellAddress, isHiddenRow, setRow, setColumn, isHiddenCol, getRangeAddress, getCell } from '../../workbook/index';\nimport { getCellIndexes, getColumnWidth, applyCellFormat } from '../../workbook/index';\nimport { activeCellMergedRange, setMerge } from '../../workbook/index';\nimport { detach } from '@syncfusion/ej2-base';\n/**\n * The `ShowHide` module is used to perform hide/show the rows and columns.\n * @hidden\n */\nvar ShowHide = /** @class */ (function () {\n    /**\n     * Constructor for the Spreadsheet show hide module.\n     * @private\n     */\n    function ShowHide(parent) {\n        this.parent = parent;\n        this.addEventListener();\n    }\n    ShowHide.prototype.hideShow = function (args) {\n        if (args.startIndex > args.endIndex) {\n            var temp = args.startIndex;\n            args.startIndex = args.endIndex;\n            args.endIndex = temp;\n        }\n        if (args.actionUpdate) {\n            this.parent.notify(beginAction, { eventArgs: args, action: 'hideShow' });\n        }\n        args.isCol ? this.hideCol(args) : this.hideRow(args);\n        if (args.actionUpdate) {\n            this.parent.notify(completeAction, { eventArgs: args, action: 'hideShow' });\n        }\n    };\n    // tslint:disable-next-line\n    ShowHide.prototype.hideRow = function (args) {\n        var _this = this;\n        var sheet = this.parent.getActiveSheet();\n        var cell;\n        var count = 0;\n        var idx;\n        var nextIdx;\n        var merge;\n        if (args.hide) {\n            var content = void 0;\n            var rowHdr = void 0;\n            var row = void 0;\n            for (var i = args.startIndex; i <= args.endIndex; i++) {\n                if (isHiddenRow(sheet, i)) {\n                    continue;\n                }\n                if (idx === undefined) {\n                    if (sheet.showHeaders) {\n                        rowHdr = this.parent.getRowHeaderTable();\n                    }\n                    content = this.parent.getContentTable();\n                    idx = this.parent.getViewportIndex(i);\n                    count = 0;\n                }\n                setRow(sheet, i, { hidden: true });\n                row = content.rows[idx];\n                if (row) {\n                    if (!merge) {\n                        for (var j = 0; j <= sheet.usedRange.colIndex; j++) {\n                            cell = getCell(i, j, sheet) || {};\n                            if ((cell.colSpan || cell.rowSpan) && (args.startIndex >= this.parent.viewport.topIndex ||\n                                this.parent.scrollSettings.enableVirtualization)) {\n                                merge = true;\n                                break;\n                            }\n                        }\n                    }\n                    if (merge) {\n                        continue;\n                    }\n                    if (sheet.showHeaders) {\n                        detach(rowHdr.rows[idx]);\n                    }\n                    detach(row);\n                    count++;\n                    row = content.rows[idx];\n                    if (row && i === args.endIndex) {\n                        var cell_1 = void 0;\n                        nextIdx = skipHiddenIdx(sheet, i + 1, true);\n                        var first = nextIdx !== skipHiddenIdx(sheet, 0, true) && nextIdx ===\n                            (this.parent.viewport.topIndex >= args.startIndex ? args.endIndex + 1 : this.parent.viewport.topIndex) ? 'Row' : '';\n                        for (var j = this.parent.viewport.leftIndex; j <= this.parent.viewport.rightIndex; j++) {\n                            var borderTop = this.parent.getCellStyleValue(['borderTop'], [nextIdx, j]).borderTop;\n                            if (borderTop !== '') {\n                                cell_1 = row.cells[j];\n                                this.parent.notify(applyCellFormat, { onActionUpdate: false, rowIdx: nextIdx, colIdx: j,\n                                    style: { borderTop: borderTop }, row: row, pRow: row.previousElementSibling,\n                                    first: first, cell: cell_1 });\n                            }\n                        }\n                    }\n                }\n                else {\n                    if (i <= this.parent.viewport.bottomIndex) {\n                        count++;\n                    }\n                    else {\n                        count--;\n                    }\n                }\n            }\n            if (merge && (args.startIndex >= this.parent.viewport.topIndex || !this.parent.scrollSettings.enableVirtualization)) {\n                this.parent.selectRange(sheet.selectedRange);\n                this.parent.renderModule.refreshUI({\n                    rowIndex: this.parent.viewport.topIndex, colIndex: this.parent.viewport.leftIndex, refresh: 'Row'\n                });\n                return;\n            }\n            if (!count) {\n                return;\n            }\n            this.parent.selectRange(sheet.selectedRange);\n            if (this.parent.scrollSettings.enableVirtualization) {\n                if (this.parent.viewport.topIndex >= args.startIndex) {\n                    this.parent.viewport.topIndex = args.endIndex + 1;\n                }\n                args.startIndex = this.parent.viewport.bottomIndex + 1;\n                args.endIndex = args.startIndex + count - 1;\n                var indexes = this.parent.skipHidden(args.startIndex, args.endIndex);\n                args.startIndex = indexes[0];\n                args.endIndex = indexes[1];\n                this.parent.viewport.bottomIndex = args.endIndex;\n                this.parent.renderModule.refreshUI({ colIndex: this.parent.viewport.leftIndex, direction: '', refresh: 'RowPart' }, getCellAddress(args.startIndex, this.parent.viewport.leftIndex) + \":\" + getCellAddress(args.endIndex, this.parent.viewport.leftIndex + this.parent.viewport.colCount + (this.parent.getThreshold('col') * 2)));\n            }\n            if (sheet.showHeaders) {\n                if (idx === 0) {\n                    if (rowHdr.rows[0]) {\n                        rowHdr.rows[0].classList.add('e-hide-end');\n                    }\n                }\n                else {\n                    if (rowHdr.rows[idx - 1]) {\n                        rowHdr.rows[idx - 1].classList.add('e-hide-start');\n                    }\n                    if (rowHdr.rows[idx]) {\n                        rowHdr.rows[idx].classList.add('e-hide-end');\n                    }\n                }\n            }\n        }\n        else {\n            var hFrag = void 0;\n            var frag = void 0;\n            var hRow = void 0;\n            var row = void 0;\n            var rowRenderer = void 0;\n            var rTBody = void 0;\n            var tBody = void 0;\n            var startRow = void 0;\n            var endRow = args.startIndex - 1;\n            var newStartRow = void 0;\n            var mergeCollection = [];\n            for (var i = args.startIndex, len = args.endIndex; i <= len; i++) {\n                if (!isHiddenRow(sheet, i)) {\n                    if (args.startIndex === args.endIndex) {\n                        return;\n                    }\n                    if (idx === undefined) {\n                        endRow++;\n                    }\n                    else {\n                        newStartRow = i;\n                    }\n                    continue;\n                }\n                if (newStartRow !== undefined) {\n                    len = i;\n                    continue;\n                }\n                if (i > this.parent.viewport.bottomIndex) {\n                    setRow(sheet, i, { hidden: false });\n                    if (startRow === undefined) {\n                        return;\n                    }\n                    continue;\n                }\n                if (startRow === undefined) {\n                    startRow = i;\n                }\n                setRow(sheet, i, { hidden: false });\n                if (idx === undefined) {\n                    hFrag = document.createDocumentFragment();\n                    frag = document.createDocumentFragment();\n                    rowRenderer = this.parent.serviceLocator.getService('row');\n                    if (sheet.showHeaders) {\n                        rTBody = this.parent.getRowHeaderTable().tBodies[0];\n                    }\n                    tBody = this.parent.getContentTable().tBodies[0];\n                    if (i < this.parent.viewport.topIndex) {\n                        this.parent.viewport.topIndex = i;\n                    }\n                    if (i === 0) {\n                        idx = 0;\n                    }\n                    else {\n                        idx = this.parent.getViewportIndex(i);\n                    }\n                }\n                endRow++;\n                if (sheet.showHeaders) {\n                    hRow = rowRenderer.refresh(i, null, null, true);\n                    hFrag.appendChild(hRow);\n                    detach(rTBody.lastElementChild);\n                }\n                row = frag.appendChild(rowRenderer.refresh(i, row, hRow));\n                detach(tBody.lastElementChild);\n                for (var j = this.parent.viewport.leftIndex; j <= this.parent.viewport.rightIndex; j++) {\n                    cell = getCell(i, j, sheet) || {};\n                    if (cell.rowSpan !== undefined) {\n                        var mergeArgs = { range: [i, j, i, j], isAction: false, merge: true,\n                            type: 'All', skipChecking: true };\n                        this.parent.notify(activeCellMergedRange, mergeArgs);\n                        if (!mergeCollection.length || mergeArgs.range[1] !== mergeCollection[mergeCollection.length - 1].range[1]) {\n                            mergeCollection.push(mergeArgs);\n                        }\n                    }\n                }\n            }\n            this.parent.viewport.bottomIndex = this.parent.viewport.topIndex + this.parent.viewport.rowCount +\n                (this.parent.getThreshold('row') * 2);\n            count = this.parent.hiddenCount(this.parent.viewport.topIndex, args.startIndex) +\n                this.parent.hiddenCount(args.endIndex + 1, this.parent.viewport.bottomIndex);\n            this.parent.viewport.bottomIndex += count;\n            args.insertIdx = idx;\n            args.row = frag.querySelector('.e-row');\n            args.mergeCollection = mergeCollection;\n            if (sheet.showHeaders) {\n                args.hdrRow = hFrag.querySelector('.e-row');\n                if (idx !== 0 && !isHiddenRow(sheet, endRow - 1) && rTBody.children[idx - 1]) {\n                    rTBody.children[idx - 1].classList.remove('e-hide-start');\n                }\n                if (args.startIndex !== 0 && isHiddenRow(sheet, args.startIndex - 1)) {\n                    args.hdrRow.classList.add('e-hide-end');\n                }\n                if (isHiddenRow(sheet, endRow + 1)) {\n                    hFrag.lastElementChild.classList.add('e-hide-start');\n                }\n                else {\n                    if (rTBody.children[idx]) {\n                        rTBody.children[idx].classList.remove('e-hide-end');\n                    }\n                }\n            }\n            if (row && tBody.children[idx]) {\n                nextIdx = skipHiddenIdx(sheet, endRow + 1, true);\n                for (var i = this.parent.viewport.leftIndex; i <= this.parent.viewport.rightIndex; i++) {\n                    var borderTop = this.parent.getCellStyleValue(['borderTop'], [nextIdx, i]).borderTop;\n                    if (borderTop !== '') {\n                        this.parent.notify(applyCellFormat, { onActionUpdate: false, rowIdx: nextIdx, colIdx: i,\n                            style: { borderTop: borderTop }, pRow: row, cell: tBody.children[idx].children[i],\n                            first: '' });\n                        var prevIdx = skipHiddenIdx(sheet, startRow - 1, false);\n                        if (prevIdx > -1) {\n                            if (tBody.children[idx - 1] && !this.parent.getCellStyleValue(['borderBottom'], [prevIdx, i]).borderBottom &&\n                                !this.parent.getCellStyleValue(['borderTop'], [startRow, i]).borderTop) {\n                                tBody.children[idx - 1].children[i].style.borderBottom = '';\n                            }\n                        }\n                        else {\n                            tBody.children[idx].children[i].style.borderTop = '';\n                        }\n                    }\n                }\n            }\n            if (args.skipAppend) {\n                return;\n            }\n            if (sheet.showHeaders) {\n                rTBody.insertBefore(hFrag, rTBody.children[idx]);\n            }\n            tBody.insertBefore(frag, tBody.children[idx]);\n            this.parent.selectRange(sheet.selectedRange);\n            if (args.autoFit && sheet.showHeaders) {\n                this.parent.notify(autoFit, { startIndex: args.startIndex, endIndex: args.endIndex, isRow: true });\n            }\n            mergeCollection.forEach(function (mergeArgs) { _this.parent.notify(setMerge, mergeArgs); });\n            if (newStartRow !== undefined && newStartRow !== args.endIndex) {\n                args.startIndex = newStartRow;\n                this.hideRow(args);\n            }\n        }\n    };\n    ShowHide.prototype.hideCol = function (args) {\n        var _this = this;\n        var sheet = this.parent.getActiveSheet();\n        var hiddenIndex = [];\n        var beforeViewportIdx = [];\n        var topLeftCell = getCellIndexes(sheet.topLeftCell);\n        var scrollable;\n        for (var i = args.startIndex; i <= args.endIndex; i++) {\n            if (args.hide ? isHiddenCol(sheet, i) : !isHiddenCol(sheet, i)) {\n                continue;\n            }\n            setColumn(sheet, i, { hidden: args.hide });\n            if (this.parent.scrollSettings.enableVirtualization && (i < this.parent.viewport.leftIndex ||\n                i > this.parent.viewport.rightIndex)) {\n                if (i < this.parent.viewport.leftIndex) {\n                    beforeViewportIdx.push(i);\n                }\n                continue;\n            }\n            hiddenIndex.push(i);\n            if (args.hide && topLeftCell[1] === i) {\n                scrollable = true;\n            }\n        }\n        if (!beforeViewportIdx.length && !hiddenIndex.length) {\n            return;\n        }\n        if (args.hide) {\n            if (!hiddenIndex.length) {\n                return;\n            }\n            if (hiddenIndex.length <= this.parent.getThreshold('col') || !this.parent.scrollSettings.enableVirtualization) {\n                this.removeCell(sheet, hiddenIndex);\n            }\n            if (this.parent.scrollSettings.enableVirtualization) {\n                if (hiddenIndex[0] === this.parent.viewport.leftIndex) {\n                    this.parent.viewport.leftIndex = skipHiddenIdx(sheet, hiddenIndex[hiddenIndex.length - 1] + 1, true, 'columns');\n                }\n                if (scrollable) {\n                    var scrollWidth_1 = 0;\n                    hiddenIndex.slice(0, hiddenIndex.indexOf(topLeftCell[1])).forEach(function (colIdx) {\n                        scrollWidth_1 += getColumnWidth(sheet, colIdx, true);\n                    });\n                    if (scrollWidth_1) {\n                        this.parent.notify(setScrollEvent, { set: false });\n                        var content = this.parent.getMainContent();\n                        content.scrollLeft -= scrollWidth_1;\n                        this.parent.notify(onContentScroll, { scrollLeft: content.scrollLeft, preventScroll: true, skipHidden: true });\n                        getUpdateUsingRaf(function () { return _this.parent.notify(setScrollEvent, { set: true }); });\n                    }\n                }\n                if (this.parent.scrollSettings.isFinite) {\n                    var colCount = skipHiddenIdx(sheet, sheet.colCount - 1, false, 'columns');\n                    var startIdx = this.parent.viewport.leftIndex;\n                    var endIndex = this.parent.viewport.rightIndex;\n                    if (endIndex + hiddenIndex.length >= colCount) {\n                        var index = skipHiddenIdx(sheet, startIdx - ((endIndex + hiddenIndex.length) - colCount), false, 'columns');\n                        if (index > -1) {\n                            this.parent.viewport.leftIndex = index;\n                            this.parent.viewport.leftIndex -= this.parent.hiddenCount(endIndex, colCount);\n                        }\n                        this.parent.viewport.rightIndex = colCount;\n                        if (startIdx !== this.parent.viewport.leftIndex || endIndex !== this.parent.viewport.rightIndex) {\n                            this.parent.renderModule.refreshUI({ skipUpdateOnFirst: this.parent.viewport.leftIndex === skipHiddenIdx(sheet, 0, true, 'columns'), rowIndex: this.parent.viewport.topIndex, colIndex: this.parent.viewport.leftIndex, refresh: 'Column' });\n                        }\n                        else {\n                            this.parent.notify(updateTableWidth, { refresh: 'Column' });\n                        }\n                        this.parent.selectRange(sheet.selectedRange);\n                        return;\n                    }\n                }\n                if (hiddenIndex.length <= this.parent.getThreshold('col')) {\n                    var indexes = this.parent.skipHidden(this.parent.viewport.rightIndex + 1, this.parent.viewport.rightIndex + hiddenIndex.length, 'columns');\n                    this.parent.viewport.rightIndex = indexes[1];\n                    this.parent.renderModule.refreshUI({ rowIndex: this.parent.viewport.topIndex, colIndex: indexes[0], direction: '', refresh: 'ColumnPart' }, \"\" + getRangeAddress([this.parent.viewport.topIndex, indexes[0], this.parent.viewport.bottomIndex, indexes[1]]));\n                }\n                else {\n                    this.parent.renderModule.refreshUI({ skipUpdateOnFirst: this.parent.viewport.leftIndex === skipHiddenIdx(sheet, 0, true, 'columns'), rowIndex: this.parent.viewport.topIndex, colIndex: this.parent.viewport.leftIndex,\n                        refresh: 'Column' });\n                }\n            }\n            this.parent.selectRange(sheet.selectedRange);\n        }\n        else {\n            if (beforeViewportIdx.length) {\n                beforeViewportIdx.sort(function (i, j) { return i - j; });\n                if (this.parent.scrollSettings.enableVirtualization && beforeViewportIdx[0] < this.parent.getThreshold('col')) {\n                    var rowIdx = getCellIndexes(sheet.topLeftCell)[0] + 1;\n                    this.parent.setSheetPropertyOnMute(sheet, 'topLeftCell', \"A\" + rowIdx);\n                    this.parent.renderModule.refreshUI({ skipUpdateOnFirst: true, rowIndex: this.parent.viewport.topIndex, colIndex: 0,\n                        refresh: 'Column' });\n                    this.parent.selectRange(sheet.selectedRange);\n                }\n                else {\n                    this.parent.goTo(getCellAddress(this.parent.viewport.topIndex, beforeViewportIdx[0]));\n                }\n                return;\n            }\n            if (hiddenIndex.length <= this.parent.getThreshold('col') || !this.parent.scrollSettings.enableVirtualization) {\n                this.appendCell(sheet, hiddenIndex);\n                if (this.parent.scrollSettings.enableVirtualization) {\n                    this.parent.notify(virtualContentLoaded, { refresh: 'Column' });\n                }\n            }\n            else {\n                this.parent.renderModule.refreshUI({ skipUpdateOnFirst: this.parent.viewport.leftIndex === skipHiddenIdx(sheet, 0, true, 'columns'), rowIndex: this.parent.viewport.topIndex, colIndex: this.parent.viewport.leftIndex,\n                    refresh: 'Column' });\n            }\n            this.parent.selectRange(sheet.selectedRange);\n        }\n    };\n    ShowHide.prototype.removeCell = function (sheet, indexes) {\n        var _this = this;\n        var startIdx;\n        var endIdx;\n        var hRow;\n        var row;\n        var hColgrp;\n        var colgrp;\n        var rowIdx = 0;\n        var cellIdx = this.parent.getViewportIndex(indexes[0], true) + 1;\n        var cell;\n        if (this.parent.scrollSettings.enableVirtualization) {\n            startIdx = this.parent.viewport.topIndex;\n            endIdx = this.parent.viewport.bottomIndex;\n        }\n        else {\n            startIdx = 0;\n            endIdx = sheet.rowCount - 1;\n        }\n        var table = this.parent.getContentTable();\n        var nextIdx;\n        colgrp = table.getElementsByTagName('colgroup')[0];\n        var colSpan;\n        if (sheet.showHeaders) {\n            var hTable = this.parent.getColHeaderTable();\n            hColgrp = hTable.getElementsByTagName('colgroup')[0];\n            hRow = hTable.rows[0];\n        }\n        var modelLen = indexes.length - 1;\n        var prevIdx;\n        while (startIdx <= endIdx) {\n            if (isHiddenRow(sheet, startIdx)) {\n                startIdx++;\n                continue;\n            }\n            row = table.rows[rowIdx];\n            indexes.forEach(function (idx, index) {\n                detach(row.cells[cellIdx]);\n                if (rowIdx === 0) {\n                    if (sheet.showHeaders) {\n                        detach(hRow.cells[cellIdx]);\n                        detach(hColgrp.children[cellIdx]);\n                    }\n                    detach(colgrp.children[cellIdx]);\n                }\n                if (index === 0) {\n                    cell = getCell(startIdx, idx, sheet) || {};\n                    if (cell.colSpan !== undefined && (cell.rowSpan === undefined || cell.colSpan > 1)) {\n                        _this.parent.notify(hiddenMerge, { rowIdx: startIdx, colIdx: idx, model: 'col',\n                            start: indexes[0], end: indexes[modelLen] });\n                    }\n                }\n                if (index === modelLen) {\n                    nextIdx = skipHiddenIdx(sheet, idx + 1, true, 'columns');\n                    var borderLeft = _this.parent.getCellStyleValue(['borderLeft'], [rowIdx, nextIdx]).borderLeft;\n                    if (borderLeft !== '') {\n                        _this.parent.notify(applyCellFormat, { onActionUpdate: false, rowIdx: rowIdx, colIdx: nextIdx,\n                            style: { borderLeft: borderLeft }, row: row, first: '' });\n                    }\n                    cell = getCell(startIdx, idx, sheet) || {};\n                    if (cell.colSpan !== undefined && (cell.rowSpan === undefined || cell.colSpan > 1)) {\n                        _this.parent.notify(hiddenMerge, { rowIdx: startIdx, colIdx: idx, model: 'col',\n                            start: indexes[0], end: indexes[modelLen], isEnd: true });\n                    }\n                }\n            });\n            startIdx++;\n            rowIdx++;\n        }\n        if (cellIdx - 1 > -1) {\n            if (sheet.showHeaders && hRow.cells[cellIdx - 1]) {\n                hRow.cells[cellIdx - 1].classList.add('e-hide-start');\n            }\n        }\n        if (hRow.cells[cellIdx]) {\n            hRow.cells[cellIdx].classList.add('e-hide-end');\n        }\n    };\n    ShowHide.prototype.appendCell = function (sheet, indexes) {\n        var _this = this;\n        var startIdx;\n        var endIdx;\n        var hRow;\n        var row;\n        var hColgrp;\n        var colgrp;\n        var rowIdx = 0;\n        var prevIdx;\n        var hFrag = document.createDocumentFragment();\n        var frag = document.createDocumentFragment();\n        var colFrag = document.createDocumentFragment();\n        if (this.parent.scrollSettings.enableVirtualization) {\n            startIdx = this.parent.viewport.topIndex;\n            endIdx = this.parent.viewport.bottomIndex;\n        }\n        else {\n            startIdx = 0;\n            endIdx = sheet.rowCount - 1;\n        }\n        var table = this.parent.getContentTable();\n        var hTable = this.parent.getColHeaderTable();\n        colgrp = table.getElementsByTagName('colgroup')[0];\n        if (sheet.showHeaders) {\n            hColgrp = hTable.getElementsByTagName('colgroup')[0];\n            hRow = hTable.rows[0];\n        }\n        var cellRenderer = this.parent.serviceLocator.getService('cell');\n        indexes.sort(function (i, j) { return i - j; });\n        var cellModel;\n        var mergeCollection = [];\n        var cellIdx = [];\n        var cell;\n        var refCell;\n        var modelLen = indexes.length - 1;\n        while (startIdx <= endIdx) {\n            if (isHiddenRow(sheet, startIdx)) {\n                startIdx++;\n                continue;\n            }\n            row = table.rows[rowIdx];\n            indexes.forEach(function (idx, index) {\n                if (rowIdx === 0) {\n                    cellIdx[index] = _this.parent.getViewportIndex(idx, true);\n                    if (colgrp.children[cellIdx[index]]) {\n                        colgrp.insertBefore(_this.parent.sheetModule.updateCol(sheet, idx), colgrp.children[cellIdx[index]]);\n                        if (sheet.showHeaders) {\n                            refCell = hRow.cells[cellIdx[index]];\n                            if (index === 0 && indexes[index] && !isHiddenCol(sheet, indexes[index] - 1)) {\n                                refCell.previousElementSibling.classList.remove('e-hide-start');\n                            }\n                            hRow.insertBefore(cellRenderer.renderColHeader(idx), refCell);\n                            if (index === modelLen) {\n                                refCell.classList.remove('e-hide-end');\n                            }\n                        }\n                    }\n                    else {\n                        colgrp.appendChild(_this.parent.sheetModule.updateCol(sheet, idx));\n                        if (sheet.showHeaders) {\n                            hRow.appendChild(cellRenderer.renderColHeader(idx));\n                        }\n                    }\n                    detach(colgrp.lastChild);\n                    if (sheet.showHeaders) {\n                        detach(hRow.lastChild);\n                        if (index === modelLen) {\n                            detach(hColgrp);\n                            hTable.insertBefore(colgrp.cloneNode(true), hTable.tHead[0]);\n                        }\n                    }\n                }\n                detach(row.lastChild);\n                refCell = row.cells[cellIdx[index]];\n                cell = cellRenderer.render({ rowIdx: startIdx, colIdx: idx, cell: getCell(startIdx, idx, sheet),\n                    address: getCellAddress(startIdx, idx), lastCell: idx === modelLen, isHeightCheckNeeded: true,\n                    first: idx !== skipHiddenIdx(sheet, 0, true, 'columns') && idx === _this.parent.viewport.leftIndex ? 'Column' : '',\n                    checkNextBorder: index === modelLen ? 'Column' : '' });\n                refCell ? row.insertBefore(cell, refCell) : row.appendChild(cell);\n                if (index === 0 && cell.previousSibling) {\n                    var borderLeft = _this.parent.getCellStyleValue(['borderLeft'], [rowIdx, skipHiddenIdx(sheet, indexes[indexes.length - 1] + 1, true, 'columns')]).borderLeft;\n                    if (borderLeft !== '') {\n                        prevIdx = skipHiddenIdx(sheet, indexes[0] - 1, false, 'columns');\n                        if (prevIdx > -1 && !_this.parent.getCellStyleValue(['borderRight'], [rowIdx, prevIdx]).borderRight &&\n                            !_this.parent.getCellStyleValue(['borderLeft'], [rowIdx, indexes[0]]).borderLeft) {\n                            cell.previousSibling.style.borderRight = '';\n                        }\n                    }\n                }\n                cellModel = getCell(rowIdx, idx, sheet) || {};\n                if (cellModel.colSpan !== undefined && (cellModel.rowSpan === undefined || cellModel.colSpan > 1)) {\n                    var mergeArgs = { range: [rowIdx, idx, rowIdx, idx], isAction: false, merge: true,\n                        type: 'All', skipChecking: true };\n                    _this.parent.notify(activeCellMergedRange, mergeArgs);\n                    if (!mergeCollection.length || mergeArgs.range[1] !== mergeCollection[mergeCollection.length - 1].range[1]) {\n                        mergeCollection.push(mergeArgs);\n                    }\n                }\n            });\n            startIdx++;\n            rowIdx++;\n        }\n        mergeCollection.forEach(function (mergeArgs) { _this.parent.notify(setMerge, mergeArgs); });\n        this.parent.viewport.rightIndex = skipHiddenIdx(sheet, this.parent.viewport.rightIndex - indexes.length, false, 'columns');\n    };\n    ShowHide.prototype.addEventListener = function () {\n        this.parent.on(hideShow, this.hideShow, this);\n        this.parent.on(spreadsheetDestroyed, this.destroy, this);\n    };\n    ShowHide.prototype.destroy = function () {\n        this.removeEventListener();\n        this.parent = null;\n    };\n    ShowHide.prototype.removeEventListener = function () {\n        this.parent.off(hideShow, this.hideShow);\n        this.parent.off(spreadsheetDestroyed, this.destroy);\n    };\n    return ShowHide;\n}());\nexport { ShowHide };\n","import { initiateHyperlink, locale, dialog, click, keyUp, createHyperlinkElement, getUpdateUsingRaf } from '../common/index';\nimport { editHyperlink, removeHyperlink, openHyperlink, editAlert } from '../common/index';\nimport { isNullOrUndefined, closest } from '@syncfusion/ej2-base';\nimport { getRangeIndexes, getCellIndexes, getCellAddress, getRangeAddress } from '../../workbook/common/address';\nimport { getTypeFromFormat, getCell } from '../../workbook/index';\nimport { beforeHyperlinkClick, afterHyperlinkClick } from '../../workbook/common/event';\nimport { isCellReference } from '../../workbook/index';\nimport { Tab, TreeView } from '@syncfusion/ej2-navigations';\n/**\n * `Hyperlink` module\n */\nvar SpreadsheetHyperlink = /** @class */ (function () {\n    /**\n     * Constructor for Hyperlink module.\n     */\n    function SpreadsheetHyperlink(parent) {\n        this.parent = parent;\n        this.addEventListener();\n    }\n    /**\n     * To destroy the Hyperlink module.\n     * @return {void}\n     */\n    SpreadsheetHyperlink.prototype.destroy = function () {\n        this.removeEventListener();\n        this.parent = null;\n    };\n    SpreadsheetHyperlink.prototype.addEventListener = function () {\n        this.parent.on(initiateHyperlink, this.initiateHyperlinkHandler, this);\n        this.parent.on(editHyperlink, this.editHyperlinkHandler, this);\n        this.parent.on(removeHyperlink, this.removeHyperlinkHandler, this);\n        this.parent.on(openHyperlink, this.openHyperlinkHandler, this);\n        this.parent.on(click, this.hyperlinkClickHandler, this);\n        this.parent.on(createHyperlinkElement, this.createHyperlinkElementHandler, this);\n        this.parent.on(keyUp, this.keyUpHandler, this);\n    };\n    SpreadsheetHyperlink.prototype.removeEventListener = function () {\n        if (!this.parent.isDestroyed) {\n            this.parent.off(initiateHyperlink, this.initiateHyperlinkHandler);\n            this.parent.off(editHyperlink, this.editHyperlinkHandler);\n            this.parent.off(removeHyperlink, this.removeHyperlinkHandler);\n            this.parent.off(openHyperlink, this.openHyperlinkHandler);\n            this.parent.off(click, this.hyperlinkClickHandler);\n            this.parent.off(createHyperlinkElement, this.createHyperlinkElementHandler);\n            this.parent.off(keyUp, this.keyUpHandler);\n        }\n    };\n    /**\n     * Gets the module name.\n     * @returns string\n     */\n    SpreadsheetHyperlink.prototype.getModuleName = function () {\n        return 'spreadsheetHyperlink';\n    };\n    SpreadsheetHyperlink.prototype.keyUpHandler = function (e) {\n        var trgt = e.target;\n        if (closest(trgt, '.e-document')) {\n            var hyperlinkText = document.querySelector('.e-hyp-text');\n            var hyperlinkSpan = this.parent.element.querySelector('.e-hyperlink-alert-span');\n            var dlgElement = closest(trgt, '.e-hyperlink-dlg') || closest(trgt, '.e-edithyperlink-dlg');\n            var footerEle = dlgElement.getElementsByClassName('e-footer-content')[0];\n            var insertBut = footerEle.firstChild;\n            if (hyperlinkText && hyperlinkText.value) {\n                if (!isCellReference(hyperlinkText.value.toUpperCase())) {\n                    this.showDialog();\n                    insertBut.setAttribute('disabled', 'true');\n                }\n                else if (hyperlinkSpan) {\n                    hyperlinkSpan.remove();\n                    insertBut.removeAttribute('disabled');\n                }\n            }\n        }\n        if (trgt.classList.contains('e-text') && closest(trgt, '.e-cont')) {\n            if (closest(trgt, '.e-webpage') && closest(trgt, '.e-webpage').getElementsByClassName('e-cont')[1] === trgt.parentElement) {\n                var dlgEle = closest(trgt, '.e-hyperlink-dlg') || closest(trgt, '.e-edithyperlink-dlg');\n                var ftrEle = dlgEle.getElementsByClassName('e-footer-content')[0];\n                var insertBut = ftrEle.firstChild;\n                if (trgt.value !== '') {\n                    insertBut.removeAttribute('disabled');\n                }\n                else {\n                    var linkDialog = closest(trgt, '.e-link-dialog');\n                    var webPage = linkDialog.querySelector('.e-webpage');\n                    var isUrl = webPage.querySelectorAll('.e-cont')[1].querySelector('.e-text').value ? true : false;\n                    if (!isUrl) {\n                        insertBut.setAttribute('disabled', 'true');\n                    }\n                }\n            }\n        }\n    };\n    SpreadsheetHyperlink.prototype.initiateHyperlinkHandler = function () {\n        var _this = this;\n        var l10n = this.parent.serviceLocator.getService(locale);\n        var sheet = this.parent.getActiveSheet();\n        if (sheet.isProtected && !sheet.protectSettings.insertLink) {\n            this.parent.notify(editAlert, null);\n            return;\n        }\n        if (!this.parent.element.querySelector('.e-hyperlink-dlg')) {\n            var dialogInst_1 = this.parent.serviceLocator.getService(dialog);\n            dialogInst_1.show({\n                width: 323, isModal: true, showCloseIcon: true, cssClass: 'e-hyperlink-dlg',\n                header: l10n.getConstant('InsertLink'),\n                beforeOpen: function (args) {\n                    var dlgArgs = {\n                        dialogName: 'InsertLinkDialog',\n                        element: args.element, target: args.target, cancel: args.cancel\n                    };\n                    _this.parent.trigger('dialogBeforeOpen', dlgArgs);\n                    if (dlgArgs.cancel) {\n                        args.cancel = true;\n                    }\n                    dialogInst_1.dialogInstance.content = _this.hyperlinkContent();\n                    dialogInst_1.dialogInstance.dataBind();\n                    _this.parent.element.focus();\n                },\n                buttons: [{\n                        buttonModel: {\n                            content: l10n.getConstant('Insert'), isPrimary: true, disabled: true\n                        },\n                        click: function () {\n                            _this.dlgClickHandler(dialogInst_1);\n                            dialogInst_1.hide();\n                        }\n                    }]\n            });\n        }\n    };\n    SpreadsheetHyperlink.prototype.dlgClickHandler = function (dialogInst) {\n        var value;\n        var address;\n        var spreadsheetInst = this.parent;\n        var item = this.parent.element.querySelector('.e-link-dialog').\n            getElementsByClassName('e-content')[0].querySelector('.e-item.e-active');\n        if (item) {\n            if (item.querySelector('.e-webpage')) {\n                value = item.getElementsByClassName('e-cont')[0].querySelector('.e-text').value;\n                address = item.getElementsByClassName('e-cont')[1].querySelector('.e-text').value;\n                var args = { address: address };\n                this.parent.insertHyperlink(args, this.parent.getActiveSheet().activeCell, value, false);\n            }\n            else {\n                value = item.getElementsByClassName('e-cont')[0].querySelector('.e-text').value;\n                address = item.getElementsByClassName('e-cont')[1].querySelector('.e-text').value;\n                var sheetIdx = void 0;\n                var dlgContent = item.getElementsByClassName('e-cont')[2];\n                if (dlgContent.getElementsByClassName('e-list-item')[0].querySelector('.e-active')) {\n                    var sheetName = item.getElementsByClassName('e-cont')[2].querySelector('.e-active').textContent;\n                    var sheets = spreadsheetInst.sheets;\n                    for (var idx = 0; idx < sheets.length; idx++) {\n                        if (sheets[idx].name === sheetName) {\n                            sheetIdx = idx + 1;\n                        }\n                    }\n                    address = sheetName + '!' + address.toUpperCase();\n                    var args = { address: address };\n                    this.parent.insertHyperlink(args, this.parent.getActiveSheet().activeCell, value, false);\n                }\n                else if (dlgContent.querySelector('.e-active')) {\n                    var definedName = item.getElementsByClassName('e-cont')[2].querySelector('.e-active').textContent;\n                    for (var idx = 0; idx < this.parent.definedNames.length; idx++) {\n                        if (this.parent.definedNames[idx].name === definedName) {\n                            var args = {\n                                address: this.parent.definedNames[idx].name,\n                            };\n                            this.parent.insertHyperlink(args, this.parent.getActiveSheet().activeCell, value, false);\n                        }\n                    }\n                }\n            }\n        }\n    };\n    SpreadsheetHyperlink.prototype.showDialog = function () {\n        if (this.parent.element.querySelector('.e-hyperlink-alert-span')) {\n            this.parent.element.querySelector('.e-hyperlink-alert-span').remove();\n        }\n        var l10n = this.parent.serviceLocator.getService(locale);\n        var hyperlinkSpan = this.parent.createElement('span', {\n            className: 'e-hyperlink-alert-span',\n            innerHTML: l10n.getConstant('HyperlinkAlert')\n        });\n        (this.parent.element.querySelector('.e-hyperlink-dlg').querySelector('.e-dlg-content')).appendChild(hyperlinkSpan);\n    };\n    SpreadsheetHyperlink.prototype.editHyperlinkHandler = function () {\n        var _this = this;\n        var isWeb = true;\n        var l10n = this.parent.serviceLocator.getService(locale);\n        var dialogInst = this.parent.serviceLocator.getService(dialog);\n        dialogInst.show({\n            width: 323, isModal: true, showCloseIcon: true, cssClass: 'e-edithyperlink-dlg',\n            header: l10n.getConstant('EditLink'),\n            beforeOpen: function (args) {\n                var dlgArgs = {\n                    dialogName: 'EditLinkDialog',\n                    element: args.element, target: args.target, cancel: args.cancel\n                };\n                _this.parent.trigger('dialogBeforeOpen', dlgArgs);\n                if (dlgArgs.cancel) {\n                    args.cancel = true;\n                }\n                dialogInst.dialogInstance.content = _this.hyperEditContent();\n                dialogInst.dialogInstance.dataBind();\n                _this.parent.element.focus();\n            },\n            buttons: [{\n                    buttonModel: {\n                        content: l10n.getConstant('Update'), isPrimary: true\n                    },\n                    click: function () {\n                        _this.dlgClickHandler(dialogInst);\n                        dialogInst.hide();\n                    }\n                }]\n        });\n    };\n    SpreadsheetHyperlink.prototype.openHyperlinkHandler = function () {\n        var cellIndexes = getCellIndexes(this.parent.getActiveSheet().activeCell);\n        var trgt = this.parent.getCell(cellIndexes[0], cellIndexes[1]);\n        if (trgt.getElementsByClassName('e-hyperlink')[0]) {\n            trgt = trgt.querySelector('.e-hyperlink');\n        }\n        this.hlOpenHandler(trgt);\n    };\n    SpreadsheetHyperlink.prototype.removeHyperlinkHandler = function (cell) {\n        this.parent.removeHyperlink(cell);\n    };\n    // tslint:disable-next-line:max-func-body-length\n    SpreadsheetHyperlink.prototype.hlOpenHandler = function (trgt) {\n        var _this = this;\n        if (trgt.classList.contains('e-hyperlink')) {\n            var range = ['', ''];\n            var selRange = void 0;\n            var rangeIndexes = void 0;\n            var isEmpty = true;\n            trgt.style.color = '#551A8B';\n            var sheet = this.parent.getActiveSheet();\n            var colIdx = parseInt(trgt.parentElement.getAttribute('aria-colindex'), 10) - 1;\n            var rowIdx = parseInt(trgt.parentElement.parentElement.getAttribute('aria-rowindex'), 10) - 1;\n            var rangeAddr = sheet.rows[rowIdx].cells[colIdx].hyperlink;\n            var address = void 0;\n            var befArgs = void 0;\n            var aftArgs = void 0;\n            befArgs = { hyperlink: rangeAddr, cell: this.parent.getActiveSheet().activeCell, target: '_blank', cancel: false };\n            this.parent.trigger(beforeHyperlinkClick, befArgs);\n            if (befArgs.cancel) {\n                return;\n            }\n            rangeAddr = befArgs.hyperlink;\n            aftArgs = { hyperlink: rangeAddr, cell: this.parent.getActiveSheet().activeCell };\n            if (typeof (rangeAddr) === 'string') {\n                address = rangeAddr;\n            }\n            if (typeof (rangeAddr) === 'object') {\n                address = rangeAddr.address;\n            }\n            var definedNameCheck = address;\n            if (address.indexOf('http://') === -1 && address.indexOf('https://') === -1 && address.indexOf('ftp://') === -1) {\n                if (!isNullOrUndefined(address)) {\n                    if (this.parent.definedNames) {\n                        for (var idx = 0; idx < this.parent.definedNames.length; idx++) {\n                            if (this.parent.definedNames[idx].name === address) {\n                                address = this.parent.definedNames[idx].refersTo;\n                                address = address.slice(1);\n                                break;\n                            }\n                        }\n                    }\n                    if (address.indexOf('!') !== -1) {\n                        range = address.split('!');\n                        if (range[0].indexOf(' ') !== -1) {\n                            range[0] = range[0].slice(1, range[0].length - 1);\n                        }\n                    }\n                    else {\n                        range[0] = this.parent.getActiveSheet().name;\n                        range[1] = address;\n                    }\n                    selRange = range[1];\n                    var sheetIdx_1;\n                    for (var idx = 0; idx < this.parent.sheets.length; idx++) {\n                        if (this.parent.sheets[idx].name === range[0]) {\n                            sheetIdx_1 = idx;\n                        }\n                    }\n                    sheet = this.parent.sheets[sheetIdx_1];\n                    if (range[1].indexOf(':') !== -1) {\n                        var colIndex = range[1].indexOf(':');\n                        var left = range[1].substr(0, colIndex);\n                        var right = range[1].substr(colIndex + 1, range[1].length);\n                        left = left.replace('$', '');\n                        right = right.replace('$', '');\n                        if (right.match(/\\D/g) && !right.match(/[0-9]/g) && left.match(/\\D/g) && !left.match(/[0-9]/g)) {\n                            selRange = left + '1' + ':' + right + sheet.rowCount;\n                            left = left + '1';\n                            right = right + sheet.rowCount;\n                            range[1] = left + ':' + right;\n                        }\n                        else if (!right.match(/\\D/g) && right.match(/[0-9]/g) && !left.match(/\\D/g) && left.match(/[0-9]/g)) {\n                            selRange = getCellAddress(parseInt(left, 10) - 1, 0) + ':' +\n                                getCellAddress(parseInt(right, 10) - 1, sheet.colCount - 1);\n                            rangeIndexes = [parseInt(left, 10) - 1, 0, parseInt(right, 10) - 1, sheet.colCount - 1];\n                            isEmpty = false;\n                        }\n                    }\n                    var isDefinedNamed = void 0;\n                    var definedname = this.parent.definedNames;\n                    if (!isNullOrUndefined(definedname)) {\n                        for (var idx = 0; idx < definedname.length; idx++) {\n                            if (definedname[idx].name === definedNameCheck) {\n                                isDefinedNamed = true;\n                                break;\n                            }\n                        }\n                    }\n                    if (isCellReference(range[1]) || isDefinedNamed) {\n                        rangeIndexes = isEmpty ? getRangeIndexes(range[1]) : rangeIndexes;\n                        if (this.parent.scrollSettings.enableVirtualization) {\n                            rangeIndexes[0] = rangeIndexes[0] >= this.parent.viewport.topIndex ?\n                                rangeIndexes[0] - this.parent.viewport.topIndex : rangeIndexes[0];\n                            rangeIndexes[1] = rangeIndexes[1] >= this.parent.viewport.leftIndex ?\n                                rangeIndexes[1] - this.parent.viewport.leftIndex : rangeIndexes[1];\n                        }\n                        if (!isNullOrUndefined(sheet)) {\n                            var rangeAddr_1 = getRangeAddress(rangeIndexes);\n                            if (sheet === this.parent.getActiveSheet()) {\n                                getUpdateUsingRaf(function () { _this.parent.goTo(rangeAddr_1); });\n                            }\n                            else {\n                                if (rangeAddr_1.indexOf(':') >= 0) {\n                                    var addArr = rangeAddr_1.split(':');\n                                    rangeAddr_1 = addArr[0] === addArr[1] ? addArr[0] : rangeAddr_1;\n                                }\n                                getUpdateUsingRaf(function () { _this.parent.goTo(_this.parent.sheets[sheetIdx_1].name + '!' + rangeAddr_1); });\n                            }\n                        }\n                    }\n                }\n            }\n            else {\n                trgt.setAttribute('target', befArgs.target);\n            }\n            this.parent.trigger(afterHyperlinkClick, aftArgs);\n        }\n    };\n    SpreadsheetHyperlink.prototype.hyperlinkClickHandler = function (e) {\n        var trgt = e.target;\n        if (closest(trgt, '.e-link-dialog') && closest(trgt, '.e-toolbar-item')) {\n            var dlgEle = closest(trgt, '.e-hyperlink-dlg') || closest(trgt, '.e-edithyperlink-dlg');\n            var ftrEle = dlgEle.getElementsByClassName('e-footer-content')[0];\n            var insertBut = ftrEle.firstChild;\n            var docEle = dlgEle.querySelector('.e-document');\n            var webEle = dlgEle.querySelector('.e-webpage');\n            var webEleText = webEle ? webEle.querySelectorAll('.e-cont')[0].querySelector('.e-text').value :\n                docEle.querySelectorAll('.e-cont')[0].querySelector('.e-text').value;\n            var docEleText = docEle ? docEle.querySelectorAll('.e-cont')[0].querySelector('.e-text').value :\n                webEleText;\n            var toolbarItems = closest(trgt, '.e-toolbar-items');\n            if (toolbarItems.getElementsByClassName('e-toolbar-item')[1].classList.contains('e-active')) {\n                var actEle = docEle.querySelectorAll('.e-cont')[2].querySelector('.e-active');\n                docEle.querySelectorAll('.e-cont')[0].querySelector('.e-text').value = webEleText;\n                if (closest(actEle, '.e-list-item').classList.contains('e-level-2') && insertBut.hasAttribute('disabled')) {\n                    insertBut.removeAttribute('disabled');\n                }\n                else if (closest(actEle, '.e-list-item').classList.contains('e-level-1') && !insertBut.hasAttribute('disabled')) {\n                    insertBut.setAttribute('disabled', 'true');\n                }\n            }\n            else {\n                var isEmpty = webEle.querySelectorAll('.e-cont')[1].querySelector('.e-text').value ? false : true;\n                webEle.querySelectorAll('.e-cont')[0].querySelector('.e-text').value = docEleText;\n                if (isEmpty && !insertBut.hasAttribute('disabled')) {\n                    insertBut.setAttribute('disabled', 'true');\n                }\n                else if (!isEmpty && insertBut.hasAttribute('disabled')) {\n                    insertBut.removeAttribute('disabled');\n                }\n            }\n        }\n        if (closest(trgt, '.e-list-item') && trgt.classList.contains('e-fullrow')) {\n            var item = this.parent.element.getElementsByClassName('e-link-dialog')[0].\n                getElementsByClassName('e-content')[0].getElementsByClassName('e-active')[0];\n            var cellRef = item.getElementsByClassName('e-cont')[1].getElementsByClassName('e-text')[0];\n            var dlgEle = closest(trgt, '.e-hyperlink-dlg') || closest(trgt, '.e-edithyperlink-dlg');\n            var ftrEle = dlgEle.getElementsByClassName('e-footer-content')[0];\n            var insertBut = ftrEle.firstChild;\n            if (closest(trgt, '.e-list-item').classList.contains('e-level-2')) {\n                if (closest(trgt, '.e-list-item').getAttribute('data-uid') === 'defName') {\n                    if (!cellRef.classList.contains('e-disabled') && !cellRef.hasAttribute('readonly')) {\n                        cellRef.setAttribute('readonly', 'true');\n                        cellRef.classList.add('e-disabled');\n                        cellRef.setAttribute('disabled', 'true');\n                    }\n                }\n                else if (closest(trgt, '.e-list-item').getAttribute('data-uid') === 'sheet') {\n                    if (cellRef.classList.contains('e-disabled') && cellRef.hasAttribute('readonly')) {\n                        cellRef.removeAttribute('readonly');\n                        cellRef.classList.remove('e-disabled');\n                        cellRef.removeAttribute('disabled');\n                    }\n                }\n                if (insertBut.hasAttribute('disabled')) {\n                    insertBut.removeAttribute('disabled');\n                }\n            }\n            else if (closest(trgt, '.e-list-item').classList.contains('e-level-1')) {\n                insertBut.setAttribute('disabled', 'true');\n            }\n        }\n        else {\n            this.hlOpenHandler(trgt);\n        }\n    };\n    SpreadsheetHyperlink.prototype.createHyperlinkElementHandler = function (args) {\n        var cell = args.cell;\n        var td = args.td;\n        var rowIdx = args.rowIdx;\n        var colIdx = args.colIdx;\n        var hyperEle = this.parent.createElement('a', { className: 'e-hyperlink e-hyperlink-style' });\n        if (!isNullOrUndefined(cell.hyperlink)) {\n            var hyperlink = cell.hyperlink;\n            if (typeof (hyperlink) === 'string') {\n                if (hyperlink.indexOf('http://') === -1 && hyperlink.indexOf('https://') === -1 &&\n                    hyperlink.indexOf('ftp://') === -1 && hyperlink.indexOf('www.') !== -1) {\n                    hyperlink = 'http://' + hyperlink;\n                }\n                if (hyperlink.indexOf('http://') === 0 || hyperlink.indexOf('https://') === 0 || hyperlink.indexOf('ftp://') === 0) {\n                    hyperEle.setAttribute('href', hyperlink);\n                    hyperEle.setAttribute('target', '_blank');\n                }\n                else if (hyperlink.includes('=') || hyperlink.includes('!')) {\n                    hyperEle.setAttribute('ref', hyperlink);\n                }\n                hyperEle.innerText = td.innerText !== '' ? td.innerText : hyperlink;\n                td.textContent = '';\n                td.innerText = '';\n                td.appendChild(hyperEle);\n            }\n            else if (typeof (hyperlink) === 'object') {\n                if (hyperlink.address.indexOf('http://') === 0 || hyperlink.address.indexOf('https://') === 0 ||\n                    hyperlink.address.indexOf('ftp://') === 0) {\n                    hyperEle.setAttribute('href', hyperlink.address);\n                    hyperEle.setAttribute('target', '_blank');\n                }\n                else if (hyperlink.address.includes('=') || hyperlink.address.includes('!')) {\n                    hyperEle.setAttribute('ref', hyperlink.address);\n                }\n                if (getTypeFromFormat(cell.format) === 'Accounting') {\n                    hyperEle.innerHTML = td.innerHTML;\n                }\n                else {\n                    hyperEle.innerText = td.innerText !== '' ? td.innerText : hyperlink.address;\n                }\n                td.textContent = '';\n                td.innerText = '';\n                td.appendChild(hyperEle);\n            }\n        }\n        else if (td.querySelector('a') && cell.hyperlink) {\n            if (typeof (cell.hyperlink) === 'string') {\n                td.querySelector('a').setAttribute('href', cell.hyperlink);\n            }\n        }\n    };\n    SpreadsheetHyperlink.prototype.hyperEditContent = function () {\n        var isWeb = true;\n        var dialog = this.hyperlinkContent();\n        var indexes = getRangeIndexes(this.parent.getActiveSheet().activeCell);\n        var cell = this.parent.sheets[this.parent.getActiveSheet().id - 1].rows[indexes[0]].cells[indexes[1]];\n        if (this.parent.scrollSettings.enableVirtualization) {\n            indexes[0] = indexes[0] - this.parent.viewport.topIndex;\n            indexes[1] = indexes[1] - this.parent.viewport.leftIndex;\n        }\n        var value = this.parent.getDisplayText(cell);\n        var address;\n        var hyperlink = cell.hyperlink;\n        if (typeof (hyperlink) === 'string') {\n            address = hyperlink;\n            value = value || address;\n            if (address.indexOf('http://') === -1 && address.indexOf('https://') === -1 && address.indexOf('ftp://') === -1) {\n                isWeb = false;\n            }\n        }\n        else if (typeof (hyperlink) === 'object') {\n            address = hyperlink.address;\n            value = value || address;\n            if (address.indexOf('http://') === -1 && address.indexOf('https://') === -1 && address.indexOf('ftp://') === -1) {\n                isWeb = false;\n            }\n        }\n        var item = dialog.querySelector('.e-content');\n        if (isWeb) {\n            var webContElem = item.querySelector('.e-webpage');\n            webContElem.getElementsByClassName('e-cont')[0].getElementsByClassName('e-text')[0].setAttribute('value', value);\n            if (typeof (hyperlink) === 'string') {\n                webContElem.getElementsByClassName('e-cont')[1].querySelector('.e-text').setAttribute('value', hyperlink);\n            }\n            else {\n                var address_1;\n                address_1 = webContElem.getElementsByClassName('e-cont')[1].querySelector('.e-text');\n                address_1.setAttribute('value', hyperlink.address);\n            }\n        }\n        else {\n            var isDefinedNamed = void 0;\n            var docContElem = item.querySelector('.e-document');\n            docContElem.getElementsByClassName('e-cont')[0].getElementsByClassName('e-text')[0].setAttribute('value', value);\n            var rangeArr = void 0;\n            var sheet = this.parent.getActiveSheet();\n            var sheetIdx = void 0;\n            if (this.parent.definedNames) {\n                for (var idx = 0; idx < this.parent.definedNames.length; idx++) {\n                    if (this.parent.definedNames[idx].name === address) {\n                        isDefinedNamed = true;\n                        break;\n                    }\n                }\n            }\n            if (isDefinedNamed) {\n                var cellRef = void 0;\n                cellRef = docContElem.getElementsByClassName('e-cont')[1].getElementsByClassName('e-text')[0];\n                cellRef.setAttribute('readonly', 'true');\n                cellRef.classList.add('e-disabled');\n                cellRef.setAttribute('disabled', 'true');\n                var treeCont = docContElem.getElementsByClassName('e-cont')[2];\n                var listEle = treeCont.querySelectorAll('.e-list-item.e-level-1')[1];\n                for (var idx = 0; idx < listEle.getElementsByTagName('li').length; idx++) {\n                    if (listEle.getElementsByTagName('li')[idx].innerText === address) {\n                        listEle.getElementsByTagName('li')[idx].classList.add('e-active');\n                    }\n                }\n            }\n            else {\n                if (address && address.indexOf('!') !== -1) {\n                    rangeArr = address.split('!');\n                    sheetIdx = parseInt(rangeArr[0].replace(/\\D/g, ''), 10) - 1;\n                    sheet = this.parent.sheets[sheetIdx];\n                }\n                var sheetName = rangeArr[0];\n                docContElem.getElementsByClassName('e-cont')[1].querySelector('.e-text').setAttribute('value', rangeArr[1]);\n                var treeCont = docContElem.getElementsByClassName('e-cont')[2];\n                var listEle = treeCont.querySelectorAll('.e-list-item.e-level-1')[0];\n                for (var idx = 0; idx < listEle.getElementsByTagName('li').length; idx++) {\n                    if (listEle.getElementsByTagName('li')[idx].innerText === sheetName) {\n                        if (listEle.getElementsByTagName('li')[idx].classList.contains('e-active')) {\n                            break;\n                        }\n                        else {\n                            listEle.getElementsByTagName('li')[idx].classList.add('e-active');\n                        }\n                    }\n                    else {\n                        if (listEle.getElementsByTagName('li')[idx].classList.contains('e-active')) {\n                            listEle.getElementsByTagName('li')[idx].classList.remove('e-active');\n                        }\n                    }\n                }\n            }\n        }\n        return dialog;\n    };\n    // tslint:disable-next-line:max-func-body-length\n    SpreadsheetHyperlink.prototype.hyperlinkContent = function () {\n        var l10n = this.parent.serviceLocator.getService(locale);\n        var idx = 0;\n        var selIdx = 0;\n        var isWeb = true;\n        var isDefinedName;\n        var isCellRef = true;\n        var address;\n        var indexes = getRangeIndexes(this.parent.getActiveSheet().activeCell);\n        var sheet = this.parent.getActiveSheet();\n        var cell = getCell(indexes[0], indexes[1], sheet);\n        var isEnable = true;\n        if (cell) {\n            if ((cell.value && typeof (cell.value) === 'string' && cell.value.match('[A-Za-z]+') !== null) ||\n                cell.value === '' || isNullOrUndefined(cell.value)) {\n                isEnable = true;\n            }\n            else {\n                isEnable = false;\n            }\n            var hyperlink = cell.hyperlink;\n            if (typeof (hyperlink) === 'string') {\n                var hl = hyperlink;\n                if (hl.indexOf('http://') === -1 && hl.indexOf('https://') === -1 && hl.indexOf('ftp://') === -1) {\n                    address = hyperlink;\n                    isWeb = false;\n                }\n            }\n            else if (typeof (hyperlink) === 'object') {\n                var hl = hyperlink.address;\n                if (hl.indexOf('http://') === -1 && hl.indexOf('https://') === -1 && hl.indexOf('ftp://') === -1) {\n                    address = hyperlink.address;\n                    isWeb = false;\n                }\n            }\n            if (isWeb) {\n                selIdx = 0;\n            }\n            else {\n                selIdx = 1;\n            }\n            if (this.parent.definedNames) {\n                for (var idx_1 = 0; idx_1 < this.parent.definedNames.length; idx_1++) {\n                    if (this.parent.definedNames[idx_1].name === address) {\n                        isDefinedName = true;\n                        isCellRef = false;\n                        break;\n                    }\n                }\n            }\n        }\n        var dialogElem = this.parent.createElement('div', { className: 'e-link-dialog' });\n        var webContElem = this.parent.createElement('div', { className: 'e-webpage' });\n        var docContElem = this.parent.createElement('div', { className: 'e-document' });\n        var headerTabs = new Tab({\n            selectedItem: selIdx,\n            items: [\n                {\n                    header: { 'text': l10n.getConstant('WebPage') },\n                    content: webContElem\n                },\n                {\n                    header: { 'text': l10n.getConstant('ThisDocument') },\n                    content: docContElem\n                },\n            ]\n        });\n        headerTabs.appendTo(dialogElem);\n        if (isWeb) {\n            dialogElem.querySelector('.e-toolbar-items').querySelector('.e-indicator').setAttribute('style', 'left: 0; right: 136px');\n        }\n        else {\n            dialogElem.querySelector('.e-toolbar-items').querySelector('.e-indicator').setAttribute('style', 'left: 136px; right: 0');\n        }\n        var textCont = this.parent.createElement('div', { className: 'e-cont' });\n        var urlCont = this.parent.createElement('div', { className: 'e-cont' });\n        var textH = this.parent.createElement('div', { className: 'e-header', innerHTML: l10n.getConstant('DisplayText') });\n        var urlH = this.parent.createElement('div', { className: 'e-header', innerHTML: l10n.getConstant('Url') });\n        var textInput = this.parent.createElement('input', { className: 'e-input e-text', attrs: { 'type': 'Text' }, });\n        if (!isEnable) {\n            textInput.classList.add('e-disabled');\n            textInput.setAttribute('readonly', 'true');\n            textInput.setAttribute('disabled', 'true');\n        }\n        if (cell && isNullOrUndefined(cell.hyperlink)) {\n            textInput.setAttribute('value', this.parent.getDisplayText(cell));\n        }\n        var urlInput = this.parent.createElement('input', { className: 'e-input e-text', attrs: { 'type': 'Text' } });\n        textInput.setAttribute('placeholder', l10n.getConstant('EnterTheTextToDisplay'));\n        urlInput.setAttribute('placeholder', l10n.getConstant('EnterTheUrl'));\n        textCont.appendChild(textInput);\n        textCont.insertBefore(textH, textInput);\n        urlCont.appendChild(urlInput);\n        urlCont.insertBefore(urlH, urlInput);\n        webContElem.appendChild(urlCont);\n        webContElem.insertBefore(textCont, urlCont);\n        var cellRef = [];\n        var definedName = [];\n        var sheets = this.parent.sheets;\n        for (idx; idx < this.parent.sheets.length; idx++) {\n            var sheetName = this.parent.sheets[idx].name;\n            if (sheets[idx] === this.parent.getActiveSheet()) {\n                cellRef.push({\n                    nodeId: 'sheet',\n                    nodeText: sheetName.indexOf(' ') !== -1 ? '\\'' + sheetName + '\\'' : sheetName,\n                    selected: true\n                });\n            }\n            else {\n                cellRef.push({\n                    nodeId: 'sheet',\n                    nodeText: sheetName.indexOf(' ') !== -1 ? '\\'' + sheetName + '\\'' : sheetName\n                });\n            }\n        }\n        for (idx = 0; idx < this.parent.definedNames.length; idx++) {\n            definedName.push({\n                nodeId: 'defName',\n                nodeText: this.parent.definedNames[idx].name\n            });\n        }\n        var data = [\n            {\n                nodeId: '01', nodeText: l10n.getConstant('CellReference'), expanded: isCellRef,\n                nodeChild: cellRef\n            },\n            {\n                nodeId: '02', nodeText: l10n.getConstant('DefinedNames'), expanded: isDefinedName,\n                nodeChild: definedName\n            },\n        ];\n        var treeObj = new TreeView({\n            fields: { dataSource: data, id: 'nodeId', text: 'nodeText', child: 'nodeChild' }\n        });\n        var cellrefCont = this.parent.createElement('div', { className: 'e-cont' });\n        var cellrefH = this.parent.createElement('div', { className: 'e-header', innerHTML: l10n.getConstant('CellReference') });\n        var cellrefInput = this.parent.createElement('input', {\n            className: 'e-input e-text e-hyp-text',\n            attrs: { 'type': 'Text' }\n        });\n        cellrefInput.setAttribute('value', 'A1');\n        cellrefCont.appendChild(cellrefInput);\n        cellrefCont.insertBefore(cellrefH, cellrefInput);\n        var textCont1 = this.parent.createElement('div', { className: 'e-cont' });\n        var textH1 = this.parent.createElement('div', { className: 'e-header', innerHTML: l10n.getConstant('DisplayText') });\n        var textInput1 = this.parent.createElement('input', { className: 'e-input e-text', attrs: { 'type': 'Text' } });\n        if (!isEnable) {\n            textInput1.classList.add('e-disabled');\n            textInput1.setAttribute('readonly', 'true');\n            textInput1.setAttribute('disabled', 'true');\n        }\n        if (cell && isNullOrUndefined(cell.hyperlink)) {\n            textInput1.setAttribute('value', this.parent.getDisplayText(cell));\n        }\n        textInput1.setAttribute('placeholder', l10n.getConstant('EnterTheTextToDisplay'));\n        textCont1.appendChild(textInput1);\n        textCont1.insertBefore(textH1, textInput1);\n        var sheetCont = this.parent.createElement('div', { className: 'e-cont' });\n        var sheetH = this.parent.createElement('div', { className: 'e-header', innerHTML: l10n.getConstant('Sheet') });\n        var refCont = this.parent.createElement('div', { className: 'e-refcont' });\n        sheetCont.appendChild(refCont);\n        sheetCont.insertBefore(sheetH, refCont);\n        docContElem.appendChild(cellrefCont);\n        docContElem.insertBefore(textCont1, cellrefCont);\n        treeObj.appendTo(refCont);\n        docContElem.appendChild(sheetCont);\n        return dialogElem;\n    };\n    return SpreadsheetHyperlink;\n}());\nexport { SpreadsheetHyperlink };\n","import { locale, deleteImage, createImageElement } from '../../spreadsheet/index';\nimport { performUndoRedo, updateUndoRedoCollection, enableToolbarItems, completeAction } from '../common/index';\nimport { setActionData, getBeforeActionData, updateAction, initiateFilterUI } from '../common/index';\nimport { setUndoRedo } from '../common/index';\nimport { selectRange, clearUndoRedoCollection, setMaxHgt, getMaxHgt, setRowEleHeight } from '../common/index';\nimport { getRangeFromAddress, getRangeIndexes, getSheet, workbookEditOperation } from '../../workbook/index';\nimport { getCell, setCell, getSheetIndex, wrapEvent, getSheetIndexFromId } from '../../workbook/index';\nimport { setMerge, getRangeAddress, getColumnHeaderText } from '../../workbook/index';\nimport { addClass } from '@syncfusion/ej2-base';\nimport { getFilteredCollection, setCellFormat } from '../../workbook/index';\n/**\n * UndoRedo module allows to perform undo redo functionalities.\n */\nvar UndoRedo = /** @class */ (function () {\n    function UndoRedo(parent) {\n        this.undoCollection = [];\n        this.redoCollection = [];\n        this.isUndo = false;\n        this.undoRedoStep = 100;\n        this.parent = parent;\n        this.addEventListener();\n    }\n    UndoRedo.prototype.setActionData = function (options) {\n        var sheet = this.parent.getActiveSheet();\n        var address;\n        var cells = [];\n        var cutCellDetails = [];\n        var args = options.args;\n        var eventArgs = args.eventArgs;\n        switch (args.action) {\n            case 'format':\n                address = getRangeIndexes(args.eventArgs.range);\n                break;\n            case 'clipboard':\n                var copiedInfo = eventArgs.copiedInfo;\n                address = getRangeIndexes(getRangeFromAddress(eventArgs.pastedRange));\n                if (copiedInfo.isCut) {\n                    cutCellDetails = this.getCellDetails(copiedInfo.range, getSheet(this.parent, getSheetIndexFromId(this.parent, copiedInfo.sId)));\n                }\n                break;\n            case 'beforeSort':\n                address = getRangeIndexes(args.eventArgs.range);\n                if (address[0] === address[2] && (address[2] - address[0]) === 0) { //if selected range is a single cell \n                    address[0] = 0;\n                    address[1] = 0;\n                    address[2] = sheet.usedRange.rowIndex;\n                    address[3] = sheet.usedRange.colIndex;\n                }\n                break;\n            case 'beforeCellSave':\n                address = getRangeIndexes(eventArgs.address);\n                break;\n            case 'beforeWrap':\n                address = this.parent.getAddressInfo(eventArgs.address).indices;\n                break;\n            case 'beforeReplace':\n                address = this.parent.getAddressInfo(eventArgs.address).indices;\n                break;\n            case 'beforeClear':\n                address = getRangeIndexes(eventArgs.range);\n                break;\n            case 'beforeInsertImage':\n                address = getRangeIndexes(eventArgs.range);\n                break;\n            case 'beforeInsertChart':\n                address = getRangeIndexes(eventArgs.range);\n                break;\n            case 'filter':\n                address = getRangeIndexes(eventArgs.range);\n                break;\n        }\n        cells = this.getCellDetails(address, sheet);\n        this.beforeActionData = { cellDetails: cells, cutCellDetails: cutCellDetails };\n    };\n    UndoRedo.prototype.getBeforeActionData = function (args) {\n        args.beforeDetails = this.beforeActionData;\n    };\n    UndoRedo.prototype.performUndoRedo = function (args) {\n        var undoRedoArgs = args.isUndo ? this.undoCollection.pop() : this.redoCollection.pop();\n        this.isUndo = args.isUndo;\n        if (undoRedoArgs) {\n            switch (undoRedoArgs.action) {\n                case 'cellSave':\n                case 'format':\n                case 'sorting':\n                case 'wrap':\n                    undoRedoArgs = this.performOperation(undoRedoArgs);\n                    break;\n                case 'clipboard':\n                    undoRedoArgs = this.undoForClipboard(undoRedoArgs);\n                    break;\n                case 'resize':\n                    undoRedoArgs = this.undoForResize(undoRedoArgs);\n                    break;\n                case 'hideShow':\n                    undoRedoArgs.eventArgs.hide = !undoRedoArgs.eventArgs.hide;\n                    updateAction(undoRedoArgs, this.parent);\n                    break;\n                case 'replace':\n                    undoRedoArgs = this.performOperation(undoRedoArgs);\n                    break;\n                case 'insert':\n                case 'filter':\n                    updateAction(undoRedoArgs, this.parent, !args.isUndo);\n                    break;\n                case 'delete':\n                    updateAction(undoRedoArgs, this.parent, !args.isUndo);\n                    break;\n                case 'validation':\n                    updateAction(undoRedoArgs, this.parent, !args.isUndo);\n                    break;\n                case 'merge':\n                    undoRedoArgs.eventArgs.merge = !undoRedoArgs.eventArgs.merge;\n                    updateAction(undoRedoArgs, this.parent);\n                    break;\n                case 'clear':\n                    undoRedoArgs = this.performOperation(undoRedoArgs);\n                    break;\n                case 'conditionalFormat':\n                    updateAction(undoRedoArgs, this.parent, !args.isUndo);\n                    break;\n                case 'clearCF':\n                    updateAction(undoRedoArgs, this.parent, !args.isUndo);\n                    break;\n                case 'insertImage':\n                    updateAction(undoRedoArgs, this.parent, !args.isUndo);\n                    break;\n                case 'imageRefresh':\n                    updateAction(undoRedoArgs, this.parent, !args.isUndo);\n                    break;\n                case 'insertChart':\n                case 'deleteChart':\n                    updateAction(undoRedoArgs, this.parent, !args.isUndo);\n                    break;\n                case 'chartRefresh':\n                    updateAction(undoRedoArgs, this.parent, !args.isUndo);\n                    break;\n            }\n            args.isUndo ? this.redoCollection.push(undoRedoArgs) : this.undoCollection.push(undoRedoArgs);\n            if (this.undoCollection.length > this.undoRedoStep) {\n                this.undoCollection.splice(0, 1);\n            }\n            if (this.redoCollection.length > this.undoRedoStep) {\n                this.redoCollection.splice(0, 1);\n            }\n            this.updateUndoRedoIcons();\n            var completeArgs = Object.assign({}, undoRedoArgs.eventArgs);\n            completeArgs.requestType = args.isUndo ? 'undo' : 'redo';\n            delete completeArgs.beforeActionData;\n            if (!args.isPublic) {\n                this.parent.notify(completeAction, { eventArgs: completeArgs, action: 'undoRedo' });\n            }\n        }\n    };\n    UndoRedo.prototype.updateUndoRedoCollection = function (options) {\n        var actionList = ['clipboard', 'format', 'sorting', 'cellSave', 'resize', 'resizeToFit', 'wrap', 'hideShow', 'replace',\n            'validation', 'merge', 'clear', 'conditionalFormat', 'clearCF', 'insertImage', 'imageRefresh', 'insertChart', 'deleteChart',\n            'chartRefresh', 'filter'];\n        if ((options.args.action === 'insert' || options.args.action === 'delete') && options.args.eventArgs.modelType !== 'Sheet') {\n            actionList.push(options.args.action);\n        }\n        var action = options.args.action;\n        if (actionList.indexOf(action) === -1 && !options.isPublic) {\n            return;\n        }\n        var eventArgs = options.args.eventArgs;\n        if (action === 'clipboard' || action === 'sorting' || action === 'format' || action === 'cellSave' ||\n            action === 'wrap' || action === 'replace' || action === 'validation' || action === 'clear' || action === 'conditionalFormat' ||\n            action === 'clearCF' || action === 'insertImage' || action === 'imageRefresh' || action === 'insertChart' ||\n            action === 'chartRefresh' || action === 'filter') {\n            var beforeActionDetails = { beforeDetails: { cellDetails: [] } };\n            this.parent.notify(getBeforeActionData, beforeActionDetails);\n            eventArgs.beforeActionData = beforeActionDetails.beforeDetails;\n        }\n        this.undoCollection.push(options.args);\n        this.redoCollection = [];\n        if (this.undoCollection.length > this.undoRedoStep) {\n            this.undoCollection.splice(0, 1);\n        }\n        this.updateUndoRedoIcons();\n    };\n    UndoRedo.prototype.clearUndoRedoCollection = function () {\n        this.undoCollection = [];\n        this.redoCollection = [];\n        this.updateUndoRedoIcons();\n    };\n    UndoRedo.prototype.updateUndoRedoIcons = function () {\n        var l10n = this.parent.serviceLocator.getService(locale);\n        this.parent.notify(enableToolbarItems, [{\n                tab: l10n.getConstant('Home'), items: [this.parent.element.id + '_undo'],\n                enable: this.undoCollection.length > 0\n            }]);\n        this.parent.notify(enableToolbarItems, [{\n                tab: l10n.getConstant('Home'), items: [this.parent.element.id + '_redo'],\n                enable: this.redoCollection.length > 0\n            }]);\n    };\n    UndoRedo.prototype.undoForClipboard = function (args) {\n        var _this = this;\n        var eventArgs = args.eventArgs;\n        var address = eventArgs.pastedRange.split('!');\n        var range = getRangeIndexes(address[1]);\n        var sheetIndex = getSheetIndex(this.parent, address[0]);\n        var sheet = getSheet(this.parent, sheetIndex);\n        var copiedInfo = eventArgs.copiedInfo;\n        var actionData = eventArgs.beforeActionData;\n        var isRefresh = this.checkRefreshNeeded(sheetIndex);\n        var pictureElem;\n        if (args.eventArgs.requestType === 'imagePaste') {\n            var copiedShapeInfo = eventArgs.copiedShapeInfo;\n            if (this.isUndo) {\n                pictureElem = copiedShapeInfo.pictureElem;\n                if (copiedShapeInfo.isCut) {\n                    this.parent.notify(deleteImage, {\n                        id: pictureElem.id, sheetIdx: eventArgs.pasteSheetIndex + 1\n                    });\n                    this.parent.notify(createImageElement, {\n                        options: {\n                            data: pictureElem.style.backgroundImage.replace(/url\\((['\"])?(.*?)\\1\\)/gi, '$2'),\n                            height: copiedShapeInfo.height, width: copiedShapeInfo.width, imageId: pictureElem.id\n                        },\n                        range: copiedShapeInfo.copiedRange, isPublic: false, isUndoRedo: true\n                    });\n                }\n                else {\n                    this.parent.notify(deleteImage, {\n                        id: eventArgs.pastedPictureElement.id, sheetIdx: eventArgs.pasteSheetIndex + 1\n                    });\n                }\n            }\n            else {\n                if (copiedShapeInfo.isCut) {\n                    pictureElem = copiedShapeInfo.pictureElem;\n                    this.parent.notify(deleteImage, {\n                        id: pictureElem.id, sheetIdx: copiedShapeInfo.sId\n                    });\n                    this.parent.notify(createImageElement, {\n                        options: {\n                            data: pictureElem.style.backgroundImage.replace(/url\\((['\"])?(.*?)\\1\\)/gi, '$2'),\n                            height: copiedShapeInfo.height, width: copiedShapeInfo.width, imageId: pictureElem.id\n                        },\n                        range: copiedShapeInfo.pastedRange, isPublic: false, isUndoRedo: true\n                    });\n                }\n                else {\n                    pictureElem = eventArgs.pastedPictureElement;\n                    this.parent.notify(createImageElement, {\n                        options: {\n                            data: pictureElem.style.backgroundImage.replace(/url\\((['\"])?(.*?)\\1\\)/gi, '$2'),\n                            height: pictureElem.offsetHeight, width: pictureElem.offsetWidth, imageId: pictureElem.id\n                        },\n                        range: copiedShapeInfo.pastedRange, isPublic: false, isUndoRedo: true\n                    });\n                }\n            }\n        }\n        else {\n            if (this.isUndo) {\n                if (copiedInfo.isCut) {\n                    var cells = actionData.cutCellDetails;\n                    this.updateCellDetails(cells, getSheet(this.parent, getSheetIndexFromId(this.parent, copiedInfo.sId)), copiedInfo.range, isRefresh);\n                    this.parent.notify(getFilteredCollection, null);\n                    for (var i = 0; i < this.parent.sheets.length; i++) {\n                        var sheetIndex_1 = getSheetIndexFromId(this.parent, copiedInfo.sId);\n                        if (this.parent.filterCollection && this.parent.filterCollection[i] &&\n                            this.parent.filterCollection[i].sheetIdx === eventArgs.pasteSheetIndex) {\n                            var filterCol = this.parent.filterCollection[i];\n                            var fRange = getRangeIndexes(filterCol.filterRange);\n                            var endCol = getColumnHeaderText(range[3]);\n                            var fEndCol = getColumnHeaderText(fRange[3]);\n                            if (fRange[0] === range[0] && fRange[1] === range[1] && endCol === fEndCol) {\n                                this.parent.notify(initiateFilterUI, {\n                                    predicates: null, range: filterCol.filterRange,\n                                    sIdx: eventArgs.pasteSheetIndex, isCut: true\n                                });\n                                this.parent.notify(initiateFilterUI, {\n                                    predicates: null,\n                                    range: getRangeAddress(copiedInfo.range), sIdx: sheetIndex_1, isCut: true\n                                });\n                            }\n                        }\n                    }\n                }\n                this.updateCellDetails(actionData.cellDetails, sheet, range, isRefresh);\n                setMaxHgt(sheet, range[0], range[1], 20);\n                var hgt = getMaxHgt(sheet, range[0]);\n                setRowEleHeight(this.parent, sheet, hgt, range[0]);\n                eventArgs.mergeCollection.forEach(function (mergeArgs) {\n                    mergeArgs.merge = !mergeArgs.merge;\n                    _this.parent.notify(setMerge, mergeArgs);\n                    mergeArgs.merge = !mergeArgs.merge;\n                });\n            }\n            else {\n                updateAction(args, this.parent, copiedInfo.isCut);\n            }\n            if (isRefresh) {\n                this.parent.notify(selectRange, { indexes: range });\n            }\n        }\n        return args;\n    };\n    UndoRedo.prototype.undoForResize = function (args) {\n        var eventArgs = args.eventArgs;\n        if (eventArgs.hide === undefined) {\n            if (eventArgs.isCol) {\n                var temp = eventArgs.oldWidth;\n                eventArgs.oldWidth = eventArgs.width;\n                eventArgs.width = temp;\n            }\n            else {\n                var temp = eventArgs.oldHeight;\n                eventArgs.oldHeight = eventArgs.height;\n                eventArgs.height = temp;\n            }\n        }\n        else {\n            eventArgs.hide = !eventArgs.hide;\n        }\n        updateAction(args, this.parent);\n        return args;\n    };\n    UndoRedo.prototype.performOperation = function (args) {\n        var eventArgs = args.eventArgs;\n        var address = (args.action === 'cellSave' || args.action === 'wrap' || args.action === 'replace') ?\n            eventArgs.address.split('!')\n            : eventArgs.range.split('!');\n        var range = getRangeIndexes(address[1]);\n        var indexes = range;\n        var sheetIndex = getSheetIndex(this.parent, address[0]);\n        var sheet = getSheet(this.parent, sheetIndex);\n        var actionData = eventArgs.beforeActionData;\n        var isRefresh = this.checkRefreshNeeded(sheetIndex);\n        if (this.isUndo) {\n            this.updateCellDetails(actionData.cellDetails, sheet, range, isRefresh, args);\n            setMaxHgt(sheet, range[0], range[1], 20);\n            var hgt = getMaxHgt(sheet, range[0]);\n            setRowEleHeight(this.parent, sheet, hgt, range[0]);\n        }\n        else {\n            /* tslint:disable-next-line:no-any */\n            var argsEventArgs = args.eventArgs;\n            var activeCellIndexes = getRangeIndexes(sheet.activeCell);\n            var cellValue = this.parent.getCellStyleValue(['textDecoration'], activeCellIndexes).textDecoration;\n            if (argsEventArgs && argsEventArgs.style && argsEventArgs.style.textDecoration) {\n                var value = argsEventArgs.style.textDecoration;\n                var changedValue = value;\n                var changedStyle = void 0;\n                var removeProp = false;\n                if (cellValue === 'underline') {\n                    changedValue = value === 'underline' ? 'none' : 'underline line-through';\n                }\n                else if (cellValue === 'line-through') {\n                    changedValue = value === 'line-through' ? 'none' : 'underline line-through';\n                }\n                else if (cellValue === 'underline line-through') {\n                    changedValue = value === 'underline' ? 'line-through' : 'underline';\n                    removeProp = true;\n                }\n                if (changedValue === 'none') {\n                    removeProp = true;\n                }\n                argsEventArgs.style.textDecoration = changedValue;\n                args.eventArgs = argsEventArgs;\n                this.parent.notify(setCellFormat, {\n                    style: { textDecoration: changedValue }, range: activeCellIndexes, refreshRibbon: true,\n                    onActionUpdate: true\n                });\n                for (var i = indexes[0]; i <= indexes[2]; i++) {\n                    for (var j = indexes[1]; j <= indexes[3]; j++) {\n                        if (i === activeCellIndexes[0] && j === activeCellIndexes[1]) {\n                            continue;\n                        }\n                        changedStyle = {};\n                        cellValue = this.parent.getCellStyleValue(['textDecoration'], [i, j]).textDecoration;\n                        if (cellValue === 'none') {\n                            if (removeProp) {\n                                continue;\n                            }\n                            changedStyle.textDecoration = value;\n                        }\n                        else if (cellValue === 'underline' || cellValue === 'line-through') {\n                            if (removeProp) {\n                                if (value === cellValue) {\n                                    changedStyle.textDecoration = 'none';\n                                }\n                                else {\n                                    continue;\n                                }\n                            }\n                            else {\n                                changedStyle.textDecoration = value !== cellValue ? 'underline line-through' : value;\n                            }\n                        }\n                        else if (cellValue === 'underline line-through') {\n                            if (removeProp) {\n                                changedStyle.textDecoration = value === 'underline' ? 'line-through' : 'underline';\n                            }\n                            else {\n                                continue;\n                            }\n                        }\n                        this.parent.notify(setCellFormat, {\n                            style: { textDecoration: changedStyle.textDecoration }, range: [i, j, i, j], refreshRibbon: true,\n                            onActionUpdate: true\n                        });\n                    }\n                }\n                argsEventArgs.style.textDecoration = value;\n                args.eventArgs = argsEventArgs;\n            }\n            else {\n                updateAction(args, this.parent);\n            }\n        }\n        if (isRefresh) {\n            this.parent.notify(selectRange, { indexes: range });\n        }\n        return args;\n    };\n    UndoRedo.prototype.getCellDetails = function (address, sheet) {\n        var cells = [];\n        var cell;\n        for (var i = address[0]; i <= address[2]; i++) {\n            for (var j = address[1]; j <= address[3]; j++) {\n                cell = getCell(i, j, sheet);\n                cells.push({\n                    rowIndex: i, colIndex: j, format: cell ? cell.format : null,\n                    style: cell && cell.style ? Object.assign({}, cell.style) : null, value: cell ? cell.value : '', formula: cell ?\n                        cell.formula : '', wrap: cell && cell.wrap, rowSpan: cell && cell.rowSpan, colSpan: cell && cell.colSpan,\n                    hyperlink: cell && cell.hyperlink, image: cell && cell.image && cell.chart\n                });\n            }\n        }\n        return cells;\n    };\n    UndoRedo.prototype.updateCellDetails = function (cells, sheet, range, isRefresh, args) {\n        var len = cells.length;\n        var cellElem;\n        for (var i = 0; i < len; i++) {\n            setCell(cells[i].rowIndex, cells[i].colIndex, sheet, {\n                value: cells[i].value, format: cells[i].format,\n                style: cells[i].style && Object.assign({}, cells[i].style), formula: cells[i].formula,\n                wrap: cells[i].wrap, rowSpan: cells[i].rowSpan,\n                colSpan: cells[i].colSpan, hyperlink: cells[i].hyperlink\n            });\n            if (cells[i].formula) {\n                this.parent.notify(workbookEditOperation, {\n                    action: 'updateCellValue', address: [cells[i].rowIndex, cells[i].colIndex, cells[i].rowIndex,\n                        cells[i].colIndex], value: cells[i].formula\n                });\n            }\n            if (args && args.action === 'wrap' && args.eventArgs.wrap) {\n                this.parent.notify(wrapEvent, {\n                    range: [cells[i].rowIndex, cells[i].colIndex, cells[i].rowIndex,\n                        cells[i].colIndex], wrap: false, sheet: sheet\n                });\n            }\n            if (args && cells[i].hyperlink && args.action === 'clear') {\n                args.eventArgs.range = sheet.name + '!' + getRangeAddress([cells[i].rowIndex, cells[i].colIndex, cells[i].rowIndex,\n                    cells[i].colIndex]);\n                cellElem = this.parent.getCell(cells[i].rowIndex, cells[i].colIndex);\n                if (args.eventArgs.type === 'Clear All' || args.eventArgs.type === 'Clear Hyperlinks') {\n                    this.parent.addHyperlink(cells[i].hyperlink, args.eventArgs.range);\n                }\n                else if (args.eventArgs.type === 'Clear Formats') {\n                    addClass(cellElem.querySelectorAll('.e-hyperlink'), 'e-hyperlink-style');\n                }\n            }\n        }\n        if (isRefresh) {\n            this.parent.serviceLocator.getService('cell').refreshRange(range);\n        }\n    };\n    UndoRedo.prototype.checkRefreshNeeded = function (sheetIndex) {\n        var isRefresh = true;\n        if (sheetIndex !== this.parent.activeSheetIndex) {\n            this.parent.activeSheetIndex = sheetIndex;\n            this.parent.dataBind();\n            isRefresh = false;\n        }\n        return isRefresh;\n    };\n    UndoRedo.prototype.addEventListener = function () {\n        this.parent.on(performUndoRedo, this.performUndoRedo, this);\n        this.parent.on(updateUndoRedoCollection, this.updateUndoRedoCollection, this);\n        this.parent.on(setActionData, this.setActionData, this);\n        this.parent.on(getBeforeActionData, this.getBeforeActionData, this);\n        this.parent.on(clearUndoRedoCollection, this.clearUndoRedoCollection, this);\n        this.parent.on(setUndoRedo, this.updateUndoRedoIcons, this);\n    };\n    UndoRedo.prototype.removeEventListener = function () {\n        if (!this.parent.isDestroyed) {\n            this.parent.off(performUndoRedo, this.performUndoRedo);\n            this.parent.off(updateUndoRedoCollection, this.updateUndoRedoCollection);\n            this.parent.off(setActionData, this.setActionData);\n            this.parent.off(getBeforeActionData, this.getBeforeActionData);\n            this.parent.off(clearUndoRedoCollection, this.clearUndoRedoCollection);\n            this.parent.off(setUndoRedo, this.updateUndoRedoIcons);\n        }\n    };\n    /**\n     * Destroy undo redo module.\n     */\n    UndoRedo.prototype.destroy = function () {\n        this.removeEventListener();\n        this.parent = null;\n    };\n    /**\n     * Get the undo redo module name.\n     */\n    UndoRedo.prototype.getModuleName = function () {\n        return 'undoredo';\n    };\n    return UndoRedo;\n}());\nexport { UndoRedo };\n","import { closest, Browser } from '@syncfusion/ej2-base';\nimport { ribbonClick, inView, setMaxHgt, getMaxHgt, WRAPTEXT, setRowEleHeight, rowHeightChanged, beginAction } from '../common/index';\nimport { completeAction, getTextHeight, getLines, } from '../common/index';\nimport { getCell, wrap as wrapText, wrapEvent, getRow } from '../../workbook/index';\nimport { getRowHeight, getAddressFromSelectedRange, getColumnsWidth } from '../../workbook/index';\n/**\n * Represents Wrap Text support for Spreadsheet.\n */\nvar WrapText = /** @class */ (function () {\n    /**\n     * Constructor for the Spreadsheet Wrap Text module.\n     * @private\n     */\n    function WrapText(parent) {\n        this.parent = parent;\n        this.addEventListener();\n    }\n    WrapText.prototype.addEventListener = function () {\n        this.parent.on(ribbonClick, this.ribbonClickHandler, this);\n        this.parent.on(wrapEvent, this.wrapTextHandler, this);\n        this.parent.on(rowHeightChanged, this.rowHeightChangedHandler, this);\n    };\n    WrapText.prototype.removeEventListener = function () {\n        if (!this.parent.isDestroyed) {\n            this.parent.off(ribbonClick, this.ribbonClickHandler);\n            this.parent.off(wrapEvent, this.wrapTextHandler);\n            this.parent.off(rowHeightChanged, this.rowHeightChangedHandler);\n        }\n    };\n    WrapText.prototype.wrapTextHandler = function (args) {\n        if (inView(this.parent, args.range, true)) {\n            var ele = void 0;\n            var cell = void 0;\n            var colwidth = void 0;\n            var isCustomHgt = void 0;\n            var maxHgt = void 0;\n            var hgt = void 0;\n            for (var i = args.range[0]; i <= args.range[2]; i++) {\n                maxHgt = 0;\n                isCustomHgt = getRow(args.sheet, i).customHeight;\n                for (var j = args.range[1]; j <= args.range[3]; j++) {\n                    ele = args.initial ? args.td : this.parent.getCell(i, j);\n                    if (ele) {\n                        args.wrap ? ele.classList.add(WRAPTEXT) : ele.classList.remove(WRAPTEXT);\n                        if (isCustomHgt) {\n                            if (ele.children.length === 0 || !ele.querySelector('.e-wrap-content')) {\n                                ele.innerHTML\n                                    = this.parent.createElement('span', {\n                                        className: 'e-wrap-content',\n                                        innerHTML: ele.innerHTML\n                                    }).outerHTML;\n                            }\n                        }\n                    }\n                    if (Browser.isIE) {\n                        ele.classList.add('e-ie-wrap');\n                    }\n                    if (!isCustomHgt) {\n                        cell = getCell(i, j, args.sheet);\n                        colwidth = getColumnsWidth(args.sheet, j, cell.colSpan > 1 ? j + cell.colSpan - 1 : j);\n                        var displayText = this.parent.getDisplayText(cell);\n                        if (displayText.indexOf('\\n') < 0) {\n                            var editElem = this.parent.element.querySelector('.e-spreadsheet-edit');\n                            if (editElem) {\n                                if (editElem.textContent.indexOf('\\n') > -1) {\n                                    displayText = editElem.textContent;\n                                }\n                            }\n                        }\n                        if (displayText) {\n                            if (args.wrap) {\n                                if (ele && ele.classList.contains('e-alt-unwrap')) {\n                                    ele.classList.remove('e-alt-unwrap');\n                                }\n                                var lines = void 0;\n                                var n = 0;\n                                var p = void 0;\n                                if (displayText.indexOf('\\n') > -1) {\n                                    var splitVal = displayText.split('\\n');\n                                    var valLength = splitVal.length;\n                                    for (p = 0; p < valLength; p++) {\n                                        lines = getLines(splitVal[p], colwidth, cell.style, this.parent.cellStyle);\n                                        if (lines === 0) {\n                                            lines = 1; // for empty new line\n                                        }\n                                        n = n + lines;\n                                    }\n                                    lines = n;\n                                }\n                                else {\n                                    lines = getLines(displayText, colwidth, cell.style, this.parent.cellStyle);\n                                }\n                                hgt = getTextHeight(this.parent, cell.style || this.parent.cellStyle, lines) + 1;\n                                maxHgt = Math.max(maxHgt, hgt);\n                                setMaxHgt(args.sheet, i, j, hgt);\n                            }\n                            else {\n                                if (displayText.indexOf('\\n') > -1) {\n                                    ele.classList.add('e-alt-unwrap');\n                                }\n                                hgt = getTextHeight(this.parent, cell.style || this.parent.cellStyle, 1);\n                                setMaxHgt(args.sheet, i, j, hgt);\n                                maxHgt = Math.max(getMaxHgt(args.sheet, i), 20);\n                            }\n                        }\n                        else if (!args.wrap) {\n                            setMaxHgt(args.sheet, i, j, 20);\n                            maxHgt = 20;\n                        }\n                        if (j === args.range[3] && ((args.wrap && maxHgt > 20 && getMaxHgt(args.sheet, i) <= maxHgt) || (!args.wrap\n                            && getMaxHgt(args.sheet, i) < getRowHeight(args.sheet, i) && getRowHeight(args.sheet, i) > 20))) {\n                            setRowEleHeight(this.parent, args.sheet, maxHgt, i, args.row, args.hRow);\n                        }\n                    }\n                }\n            }\n        }\n    };\n    WrapText.prototype.ribbonClickHandler = function (args) {\n        var target = closest(args.originalEvent.target, '.e-btn');\n        if (target && target.id === this.parent.element.id + '_wrap') {\n            var wrap = target.classList.contains('e-active');\n            var address = getAddressFromSelectedRange(this.parent.getActiveSheet());\n            var eventArgs = { address: address, wrap: wrap, cancel: false };\n            this.parent.notify(beginAction, { action: 'beforeWrap', eventArgs: eventArgs });\n            if (!eventArgs.cancel) {\n                wrapText(this.parent.getActiveSheet().selectedRange, wrap, this.parent);\n                this.parent.notify(completeAction, { action: 'wrap', eventArgs: { address: address, wrap: wrap } });\n            }\n        }\n    };\n    WrapText.prototype.getTextWidth = function (text, style) {\n        if (style === void 0) { style = this.parent.cellStyle; }\n        var defaultStyle = this.parent.cellStyle;\n        var canvas = document.createElement('canvas');\n        var context = canvas.getContext('2d');\n        context.font = (style.fontStyle || defaultStyle.fontStyle) + ' ' + (style.fontWeight || defaultStyle.fontWeight) + ' '\n            + (style.fontSize || defaultStyle.fontSize) + ' ' + (style.fontFamily || defaultStyle.fontFamily);\n        return context.measureText(text).width;\n    };\n    WrapText.prototype.rowHeightChangedHandler = function (args) {\n        if (args.isCustomHgt) {\n            var sheet = this.parent.getActiveSheet();\n            var leftIdx = this.parent.viewport.leftIndex;\n            var rightIdx = leftIdx + this.parent.viewport.colCount + this.parent.getThreshold('col') * 2;\n            for (var i = leftIdx; i < rightIdx; i++) {\n                var cell = getCell(args.rowIdx, i, sheet);\n                if (cell && cell.wrap) {\n                    var ele = this.parent.getCell(args.rowIdx, i);\n                    if (ele.children.length === 0 || !ele.querySelector('.e-wrap-content')) {\n                        ele.innerHTML = this.parent.createElement('span', {\n                            className: 'e-wrap-content',\n                            innerHTML: ele.innerHTML\n                        }).outerHTML;\n                    }\n                }\n            }\n        }\n    };\n    /**\n     * For internal use only - Get the module name.\n     * @private\n     */\n    WrapText.prototype.getModuleName = function () {\n        return 'wrapText';\n    };\n    WrapText.prototype.destroy = function () {\n        this.removeEventListener();\n        this.parent = null;\n    };\n    return WrapText;\n}());\nexport { WrapText };\n","import { beginAction, completeAction, insertSheetTab, skipHiddenIdx, refreshImagePosition } from '../common/index';\nimport { insert, dataChanged } from '../../workbook/common/index';\nimport { getCell } from '../../workbook/index';\n/**\n * The `Insert` module is used to insert cells, rows, columns and sheets in to the spreadsheet.\n */\nvar Insert = /** @class */ (function () {\n    /**\n     * Constructor for the Spreadsheet insert module.\n     * @private\n     */\n    function Insert(parent) {\n        this.parent = parent;\n        this.addEventListener();\n    }\n    Insert.prototype.insert = function (args) {\n        var isAction;\n        if (args.isAction) {\n            isAction = true;\n            delete args.isAction;\n        }\n        if (isAction) {\n            this.parent.notify(beginAction, { eventArgs: args, action: 'insert' });\n        }\n        switch (args.modelType) {\n            case 'Sheet':\n                this.parent.notify(insertSheetTab, { startIdx: args.index, endIdx: args.index + (args.model.length - 1), preventUpdate: !isAction });\n                this.parent.renderModule.refreshSheet();\n                this.parent.element.focus();\n                break;\n            case 'Row':\n                if (!this.parent.scrollSettings.enableVirtualization || args.index <= this.parent.viewport.bottomIndex) {\n                    if (this.parent.scrollSettings.enableVirtualization) {\n                        if (args.index < this.parent.viewport.topIndex) {\n                            this.parent.viewport.topIndex += args.model.length;\n                        }\n                        this.parent.renderModule.refreshUI({\n                            skipUpdateOnFirst: this.parent.viewport.topIndex === skipHiddenIdx(this.parent.getActiveSheet(), 0, true), rowIndex: this.parent.viewport.topIndex, colIndex: this.parent.viewport.leftIndex, refresh: 'Row'\n                        });\n                    }\n                    else {\n                        this.parent.renderModule.refreshUI({ skipUpdateOnFirst: true, rowIndex: args.index, colIndex: 0, refresh: 'Row' });\n                    }\n                    this.parent.notify(dataChanged, args);\n                    this.parent.selectRange(this.parent.getActiveSheet().selectedRange);\n                }\n                break;\n            case 'Column':\n                if (!this.parent.scrollSettings.enableVirtualization || args.index <= this.parent.viewport.rightIndex) {\n                    if (this.parent.scrollSettings.enableVirtualization) {\n                        if (args.index < this.parent.viewport.leftIndex) {\n                            this.parent.viewport.leftIndex += args.model.length;\n                        }\n                        this.parent.renderModule.refreshUI({\n                            skipUpdateOnFirst: this.parent.viewport.leftIndex === skipHiddenIdx(this.parent.getActiveSheet(), 0, true, 'columns'), rowIndex: this.parent.viewport.topIndex, colIndex: this.parent.viewport.leftIndex, refresh: 'Column'\n                        });\n                    }\n                    else {\n                        this.parent.renderModule.refreshUI({\n                            skipUpdateOnFirst: true, rowIndex: 0, colIndex: args.index, refresh: 'Column'\n                        });\n                    }\n                    this.parent.selectRange(this.parent.getActiveSheet().selectedRange);\n                }\n                break;\n        }\n        this.refreshImgElement(args.model.length, this.parent.activeSheetIndex, args.modelType, args.index);\n        if (isAction) {\n            this.parent.notify(completeAction, { eventArgs: args, action: 'insert' });\n        }\n    };\n    Insert.prototype.refreshImgElement = function (count, sheetIdx, modelType, index) {\n        var sheet = this.parent.sheets[sheetIdx];\n        var cellObj;\n        var indexes = [0, 0, sheet.usedRange.rowIndex, sheet.usedRange.colIndex];\n        for (var i = 0; i <= indexes[2]; i++) {\n            for (var j = indexes[1]; j <= indexes[3]; j++) {\n                cellObj = getCell(i, j, sheet);\n                if (cellObj && cellObj.image && cellObj.image.length > 0) {\n                    if ((modelType === 'Row' && i >= index) || (modelType === 'Column' && j >= index)) {\n                        this.parent.notify(refreshImagePosition, {\n                            rowIdx: i, colIdx: j, sheetIdx: sheetIdx, type: modelType, count: count, status: 'insert'\n                        });\n                    }\n                }\n            }\n        }\n    };\n    Insert.prototype.addEventListener = function () {\n        this.parent.on(insert, this.insert, this);\n    };\n    /**\n     * Destroy insert module.\n     */\n    Insert.prototype.destroy = function () {\n        this.removeEventListener();\n        this.parent = null;\n    };\n    Insert.prototype.removeEventListener = function () {\n        if (!this.parent.isDestroyed) {\n            this.parent.off(insert, this.insert);\n        }\n    };\n    /**\n     * Get the insert module name.\n     */\n    Insert.prototype.getModuleName = function () {\n        return 'insert';\n    };\n    return Insert;\n}());\nexport { Insert };\n","import { beginAction, completeAction, skipHiddenIdx, refreshSheetTabs, refreshImagePosition } from '../common/index';\nimport { deleteAction, dataChanged } from '../../workbook/common/index';\nimport { getCell } from '../../workbook/index';\n/**\n * The `Delete` module is used to delete cells, rows, columns and sheets from the spreadsheet.\n */\nvar Delete = /** @class */ (function () {\n    /**\n     * Constructor for the Spreadsheet insert module.\n     * @private\n     */\n    function Delete(parent) {\n        this.parent = parent;\n        this.addEventListener();\n    }\n    Delete.prototype.delete = function (args) {\n        var isAction;\n        if (args.isAction) {\n            isAction = true;\n            delete args.isAction;\n        }\n        if (isAction) {\n            this.parent.notify(beginAction, { eventArgs: args, action: 'delete' });\n        }\n        if (args.modelType === 'Sheet') {\n            var activeSheetDeleted = args.activeSheetIndex >= args.startIndex && args.activeSheetIndex <= args.endIndex;\n            if (activeSheetDeleted) {\n                this.parent.setProperties({ activeSheetIndex: this.parent.skipHiddenSheets(args.startIndex < this.parent.sheets.length ? args.startIndex :\n                        (args.startIndex ? args.startIndex - 1 : 0)) }, true);\n            }\n            this.parent.notify(refreshSheetTabs, null);\n            if (activeSheetDeleted) {\n                this.parent.renderModule.refreshSheet();\n            }\n            this.parent.element.focus();\n        }\n        else if (args.modelType === 'Row') {\n            if (!this.parent.scrollSettings.enableVirtualization || args.startIndex <= this.parent.viewport.bottomIndex) {\n                if (this.parent.scrollSettings.enableVirtualization) {\n                    if (args.startIndex < this.parent.viewport.topIndex) {\n                        this.parent.viewport.topIndex -= args.model.length;\n                    }\n                    this.parent.renderModule.refreshUI({\n                        skipUpdateOnFirst: this.parent.viewport.topIndex === skipHiddenIdx(this.parent.getActiveSheet(), 0, true), rowIndex: this.parent.viewport.topIndex, refresh: 'Row',\n                        colIndex: this.parent.viewport.leftIndex\n                    });\n                }\n                else {\n                    this.parent.renderModule.refreshUI({ skipUpdateOnFirst: true, refresh: 'Row', rowIndex: args.startIndex, colIndex: 0 });\n                }\n            }\n            this.parent.selectRange(this.parent.getActiveSheet().selectedRange);\n        }\n        else {\n            if (!this.parent.scrollSettings.enableVirtualization || args.startIndex <= this.parent.viewport.rightIndex) {\n                if (this.parent.scrollSettings.enableVirtualization) {\n                    if (args.startIndex < this.parent.viewport.leftIndex) {\n                        this.parent.viewport.leftIndex -= args.model.length;\n                    }\n                    this.parent.renderModule.refreshUI({\n                        skipUpdateOnFirst: this.parent.viewport.leftIndex === skipHiddenIdx(this.parent.getActiveSheet(), 0, true, 'columns'), rowIndex: this.parent.viewport.topIndex, refresh: 'Column',\n                        colIndex: this.parent.viewport.leftIndex\n                    });\n                }\n                else {\n                    this.parent.renderModule.refreshUI({\n                        skipUpdateOnFirst: true, refresh: 'Column', rowIndex: 0,\n                        colIndex: args.startIndex\n                    });\n                }\n            }\n            this.parent.selectRange(this.parent.getActiveSheet().selectedRange);\n        }\n        this.refreshImgElement(args.deletedModel.length, this.parent.activeSheetIndex, args.modelType, args.startIndex);\n        if (isAction) {\n            this.parent.notify(completeAction, { eventArgs: args, action: 'delete' });\n        }\n        if (args.modelType === 'Row') {\n            this.parent.notify(dataChanged, args);\n        }\n    };\n    Delete.prototype.refreshImgElement = function (count, sheetIdx, modelType, index) {\n        var sheet = this.parent.sheets[sheetIdx];\n        var cell;\n        var address = [0, 0, sheet.usedRange.rowIndex, sheet.usedRange.colIndex];\n        for (var i = 0; i <= address[2]; i++) {\n            for (var j = address[1]; j <= address[3]; j++) {\n                cell = getCell(i, j, sheet);\n                if (cell && cell.image && cell.image.length > 0) {\n                    if ((modelType === 'Row' && i >= index) || (modelType === 'Column' && j >= index)) {\n                        this.parent.notify(refreshImagePosition, {\n                            rowIdx: i, colIdx: j, sheetIdx: sheetIdx, type: modelType, count: count, status: 'delete'\n                        });\n                    }\n                }\n            }\n        }\n    };\n    Delete.prototype.addEventListener = function () {\n        this.parent.on(deleteAction, this.delete, this);\n    };\n    /**\n     * Destroy delete module.\n     */\n    Delete.prototype.destroy = function () {\n        this.removeEventListener();\n        this.parent = null;\n    };\n    Delete.prototype.removeEventListener = function () {\n        if (!this.parent.isDestroyed) {\n            this.parent.off(deleteAction, this.delete);\n        }\n    };\n    /**\n     * Get the delete module name.\n     */\n    Delete.prototype.getModuleName = function () {\n        return 'delete';\n    };\n    return Delete;\n}());\nexport { Delete };\n","import { editAlert } from '../index';\nimport { isValidation, checkDateFormat, applyCellFormat, workbookEditOperation, activeCellChanged } from '../../workbook/common/event';\nimport { getCell, setCell } from '../../workbook/base/cell';\nimport { FormValidator, NumericTextBox } from '@syncfusion/ej2-inputs';\nimport { EventHandler, remove, closest, isNullOrUndefined, select } from '@syncfusion/ej2-base';\nimport { dialog, locale, initiateDataValidation, invalidData, editOperation, keyUp } from '../common/index';\nimport { formulaBarOperation, removeDataValidation } from '../common/index';\nimport { CheckBox } from '@syncfusion/ej2-buttons';\nimport { setRow } from '../../workbook/base/row';\nimport { getRangeIndexes, getIndexesFromAddress, getCellIndexes } from '../../workbook/common/address';\nimport { DropDownList } from '@syncfusion/ej2-dropdowns';\nimport { getSheet, getSheetIndex } from '../../workbook/index';\nimport { getColumn, isLocked } from '../../workbook/index';\n/**\n * Represents Data Validation support for Spreadsheet.\n */\nvar DataValidation = /** @class */ (function () {\n    /**\n     * Constructor for the Spreadsheet Data Validation module.\n     */\n    function DataValidation(parent) {\n        this.data = [];\n        this.parent = parent;\n        this.addEventListener();\n    }\n    /**\n     * To destroy the Data Validation module.\n     * @return {void}\n     */\n    DataValidation.prototype.destroy = function () {\n        this.removeEventListener();\n        var dataValPopup = select('#' + this.parent.element.id + '_datavalidation-popup');\n        if (dataValPopup) {\n            dataValPopup.remove();\n        }\n        this.parent = null;\n    };\n    DataValidation.prototype.addEventListener = function () {\n        EventHandler.add(this.parent.element, 'dblclick', this.listOpen, this);\n        EventHandler.add(document, 'mousedown', this.mouseDownHandler, this);\n        this.parent.on(initiateDataValidation, this.initiateDataValidationHandler, this);\n        this.parent.on(invalidData, this.invalidDataHandler, this);\n        this.parent.on(isValidation, this.checkDataValidation, this);\n        this.parent.on(activeCellChanged, this.listHandler, this);\n        this.parent.on(keyUp, this.keyUpHandler, this);\n        this.parent.on(removeDataValidation, this.removeValidationHandler, this);\n    };\n    DataValidation.prototype.removeEventListener = function () {\n        EventHandler.remove(this.parent.element, 'dblclick', this.listOpen);\n        EventHandler.remove(document, 'mousedown', this.mouseDownHandler);\n        if (!this.parent.isDestroyed) {\n            this.parent.off(initiateDataValidation, this.initiateDataValidationHandler);\n            this.parent.off(invalidData, this.invalidDataHandler);\n            this.parent.off(isValidation, this.checkDataValidation);\n            this.parent.off(activeCellChanged, this.listHandler);\n            this.parent.off(keyUp, this.keyUpHandler);\n            this.parent.off(removeDataValidation, this.removeValidationHandler);\n        }\n    };\n    DataValidation.prototype.removeValidationHandler = function (e) {\n        this.parent.removeDataValidation(this.parent.getActiveSheet().selectedRange);\n    };\n    DataValidation.prototype.mouseDownHandler = function (e) {\n        var target = e.target;\n        var parEle = closest(target, '.e-ddl');\n        if (parEle && parEle.getAttribute('id') === 'listValid_popup') {\n            this.parent.notify(formulaBarOperation, { action: 'refreshFormulabar', value: target.innerText });\n        }\n    };\n    DataValidation.prototype.keyUpHandler = function (e) {\n        var target = e.target;\n        var dlgEle = this.parent.element.querySelector('.e-datavalidation-dlg');\n        if (closest(target, '.e-values') && dlgEle && e.keyCode !== 13) {\n            var valuesCont = dlgEle.querySelector('.e-values');\n            var errorEle = valuesCont.querySelector('.e-dlg-error');\n            var footerCont = dlgEle.querySelector('.e-footer-content');\n            var primaryBut = footerCont.querySelector('.e-primary');\n            if (primaryBut.hasAttribute('disabled')) {\n                primaryBut.removeAttribute('disabled');\n            }\n            if (errorEle) {\n                valuesCont.removeChild(errorEle);\n            }\n        }\n    };\n    DataValidation.prototype.listOpen = function (e) {\n        var target = e.target;\n        if (this.listObj && target.classList.contains('e-cell') && target.querySelector('.e-validation-list')) {\n            this.listObj.showPopup();\n        }\n    };\n    DataValidation.prototype.invalidDataHandler = function (args) {\n        if (args.isRemoveHighlight) {\n            this.parent.removeInvalidHighlight();\n        }\n        else {\n            this.parent.addInvalidHighlight();\n        }\n    };\n    DataValidation.prototype.listHandler = function () {\n        var _this = this;\n        if (this.parent.allowDataValidation) {\n            var sheet = this.parent.getActiveSheet();\n            var mainCont = this.parent.getMainContent();\n            var indexes = getCellIndexes(sheet.activeCell);\n            var colIdx = indexes[1];\n            var rowIdx = indexes[0];\n            var cell_1 = getCell(indexes[0], indexes[1], sheet);\n            var tdEle_1;\n            tdEle_1 = this.parent.getCell(indexes[0], indexes[1]);\n            if (!tdEle_1) {\n                return;\n            }\n            if (document.getElementsByClassName('e-validation-list')[0]) {\n                remove(document.getElementsByClassName('e-validation-list')[0]);\n                this.data = [];\n            }\n            if (cell_1 && cell_1.validation && cell_1.validation.type === 'List') {\n                cell_1.validation.ignoreBlank = !isNullOrUndefined(cell_1.validation.ignoreBlank) ? cell_1.validation.ignoreBlank : true;\n                cell_1.validation.inCellDropDown = !isNullOrUndefined(cell_1.validation.inCellDropDown) ?\n                    cell_1.validation.inCellDropDown : true;\n                if (cell_1.validation.inCellDropDown) {\n                    var ddlCont = this.parent.createElement('div', { className: 'e-validation-list' });\n                    var ddlEle = this.parent.createElement('input', { id: 'listValid' });\n                    ddlCont.appendChild(ddlEle);\n                    if (!cell_1.validation.inCellDropDown) {\n                        ddlCont.style.display = 'none';\n                    }\n                    tdEle_1.insertBefore(ddlCont, tdEle_1.firstChild);\n                    this.listObj = new DropDownList({\n                        index: 0,\n                        dataSource: this.data,\n                        fields: { text: 'text', value: 'id' },\n                        width: '0px',\n                        popupWidth: '200px',\n                        popupHeight: '200px',\n                        beforeOpen: function () {\n                            _this.listObj.popupWidth = tdEle_1.offsetWidth - 1;\n                            _this.data = [];\n                            _this.updateDataSource(_this.listObj, cell_1);\n                        },\n                        change: function () { _this.listValueChange(_this.listObj.text); },\n                        open: function (args) {\n                            args.popup.offsetX = -(tdEle_1.offsetWidth - 20) + 4;\n                            args.popup.offsetY = -13;\n                        }\n                    });\n                    this.listObj.appendTo('#listValid');\n                }\n            }\n        }\n    };\n    DataValidation.prototype.updateDataSource = function (listObj, cell) {\n        var count = 0;\n        var value = cell.validation.value1;\n        var isRange = value.indexOf('=') !== -1;\n        if (isRange) {\n            var sheet = value.indexOf('!') > -1 ?\n                getSheet(this.parent, getSheetIndex(this.parent, value.split('=')[1].split('!')[0])) : this.parent.getActiveSheet();\n            var address = value.indexOf('!') > -1 ? value.split('!')[1] : value.split('=')[1];\n            var indexes = void 0;\n            var range = address.split(':');\n            if ((range[0].match(/[a-z]+$/ig) && range[1].match(/[a-z]+$/ig)) || (range[0].match(/^[0-9]/g) && range[1].match(/^[0-9]/g))) {\n                var addressInfo = this.parent.getIndexes(address);\n                if (addressInfo.isCol) {\n                    indexes = [0, addressInfo.startIdx, sheet.usedRange.rowIndex, addressInfo.startIdx];\n                }\n                else {\n                    indexes = [addressInfo.startIdx, 0, addressInfo.startIdx, sheet.usedRange.colIndex];\n                }\n            }\n            else {\n                indexes = getRangeIndexes(address);\n            }\n            for (var rowIdx = indexes[0]; rowIdx <= indexes[2]; rowIdx++) {\n                if (!sheet.rows[rowIdx]) {\n                    setRow(sheet, rowIdx, {});\n                }\n                for (var colIdx = indexes[1]; colIdx <= indexes[3]; colIdx++) {\n                    if (!sheet.rows[rowIdx].cells) {\n                        setCell(rowIdx, colIdx, sheet, {});\n                    }\n                    count += 1;\n                    cell = sheet.rows[rowIdx].cells[colIdx];\n                    var data = this.parent.getDisplayText(cell) ? this.parent.getDisplayText(cell) : '';\n                    this.data.push({ text: data, id: 'list-' + count });\n                }\n            }\n        }\n        else {\n            var listValues = value.split(',');\n            for (var idx = 0; idx < listValues.length; idx++) {\n                count += 1;\n                this.data.push({ text: listValues[idx], id: 'list-' + count });\n            }\n        }\n        listObj.dataSource = this.data;\n    };\n    DataValidation.prototype.listValueChange = function (value) {\n        var sheet = this.parent.getActiveSheet();\n        var cellIdx = getIndexesFromAddress(sheet.activeCell);\n        var cellObj = Object.assign({}, getCell(cellIdx[0], cellIdx[1], sheet));\n        if (sheet.isProtected && isLocked(cellObj, getColumn(sheet, cellIdx[1]))) {\n            this.parent.notify(editAlert, null);\n        }\n        else {\n            this.parent.notify(workbookEditOperation, { action: 'updateCellValue', address: sheet.activeCell, value: value });\n            this.parent.serviceLocator.getService('cell').refreshRange(cellIdx);\n            this.parent.trigger('cellSave', {\n                value: value, oldValue: cellObj && cellObj.value, address: sheet.name + '!' + sheet.activeCell,\n                displayText: this.parent.getDisplayText(getCell(cellIdx[0], cellIdx[1], sheet))\n            });\n        }\n    };\n    DataValidation.prototype.initiateDataValidationHandler = function () {\n        var _this = this;\n        var l10n = this.parent.serviceLocator.getService(locale);\n        var type;\n        var operator;\n        var value1;\n        var value2;\n        var ignoreBlank = true;\n        var inCellDropDown = true;\n        var isNew = true;\n        var sheet = this.parent.getActiveSheet();\n        var cell;\n        var indexes = getRangeIndexes(sheet.selectedRange);\n        for (var rowIdx = indexes[0]; rowIdx <= indexes[2]; rowIdx++) {\n            if (sheet.rows[rowIdx]) {\n                for (var colIdx = indexes[1]; colIdx <= indexes[3]; colIdx++) {\n                    if (sheet.rows[rowIdx].cells && sheet.rows[rowIdx].cells[colIdx]) {\n                        cell = sheet.rows[rowIdx].cells[colIdx];\n                        if (cell.validation) {\n                            isNew = false;\n                            type = cell.validation.type;\n                            operator = cell.validation.operator;\n                            value1 = cell.validation.value1;\n                            value2 = cell.validation.value2;\n                            ignoreBlank = !isNullOrUndefined(cell.validation.ignoreBlank) ?\n                                cell.validation.ignoreBlank : ignoreBlank;\n                            inCellDropDown = !isNullOrUndefined(cell.validation.inCellDropDown) ?\n                                cell.validation.inCellDropDown : inCellDropDown;\n                        }\n                    }\n                }\n            }\n        }\n        if (!this.parent.element.querySelector('.e-datavalidation-dlg')) {\n            var dialogInst_1 = this.parent.serviceLocator.getService(dialog);\n            dialogInst_1.show({\n                width: 375, showCloseIcon: true, isModal: true, cssClass: 'e-datavalidation-dlg',\n                header: l10n.getConstant('DataValidation'),\n                target: document.querySelector('.e-control.e-spreadsheet'),\n                beforeOpen: function (args) {\n                    var dlgArgs = {\n                        dialogName: 'ValidationDialog', element: args.element,\n                        target: args.target, cancel: args.cancel\n                    };\n                    _this.parent.trigger('dialogBeforeOpen', dlgArgs);\n                    if (dlgArgs.cancel) {\n                        args.cancel = true;\n                    }\n                    dialogInst_1.dialogInstance.content =\n                        _this.dataValidationContent(isNew, type, operator, value1, value2, ignoreBlank, inCellDropDown);\n                    dialogInst_1.dialogInstance.dataBind();\n                    _this.parent.element.focus();\n                },\n                buttons: [{\n                        buttonModel: {\n                            content: l10n.getConstant('CLEARALL'),\n                            cssClass: 'e-btn e-clearall-btn e-flat'\n                        },\n                        click: function () {\n                            dialogInst_1.dialogInstance.content =\n                                _this.dataValidationContent(true, type, operator, value1, value2, ignoreBlank, inCellDropDown);\n                            dialogInst_1.dialogInstance.dataBind();\n                            _this.parent.element.focus();\n                        }\n                    },\n                    {\n                        buttonModel: {\n                            content: l10n.getConstant('APPLY'), isPrimary: true\n                        },\n                        click: function () {\n                            _this.dlgClickHandler(dialogInst_1);\n                        }\n                    }]\n            });\n            dialogInst_1.dialogInstance.refresh();\n        }\n    };\n    // tslint:disable-next-line:max-func-body-length\n    DataValidation.prototype.dataValidationContent = function (isNew, type, operator, val1, val2, ignoreBlank, inCellDropDown) {\n        var _this = this;\n        var l10n = this.parent.serviceLocator.getService(locale);\n        var value1 = isNew ? '0' : val1;\n        var value2 = isNew ? '0' : val2;\n        var dlgContent = this.parent.createElement('div', { className: 'e-validation-dlg' });\n        var cellRangeCont = this.parent.createElement('div', { className: 'e-cellrange' });\n        var allowDataCont = this.parent.createElement('div', { className: 'e-allowdata' });\n        var valuesCont = this.parent.createElement('div', { className: 'e-values' });\n        var ignoreBlankCont = this.parent.createElement('div', { className: 'e-ignoreblank' });\n        dlgContent.appendChild(cellRangeCont);\n        dlgContent.appendChild(allowDataCont);\n        dlgContent.appendChild(valuesCont);\n        dlgContent.appendChild(ignoreBlankCont);\n        var cellRangeText = this.parent.createElement('span', { className: 'e-header', innerHTML: l10n.getConstant('CellRange') });\n        var cellRangeEle = this.parent.createElement('input', {\n            className: 'e-input',\n            attrs: { value: this.parent.getActiveSheet().selectedRange }\n        });\n        cellRangeCont.appendChild(cellRangeText);\n        cellRangeCont.appendChild(cellRangeEle);\n        var allowCont = this.parent.createElement('div', { className: 'e-allow' });\n        var dataCont = this.parent.createElement('div', { className: 'e-data' });\n        allowDataCont.appendChild(allowCont);\n        allowDataCont.appendChild(dataCont);\n        var allowText = this.parent.createElement('span', { className: 'e-header', innerHTML: l10n.getConstant('Allow') });\n        this.typeData = [\n            { text: l10n.getConstant('WholeNumber'), id: 'type-1' },\n            { text: l10n.getConstant('Decimal'), id: 'type-2' },\n            { text: l10n.getConstant('Date'), id: 'type-3' },\n            { text: l10n.getConstant('Time'), id: 'type-4' },\n            { text: l10n.getConstant('TextLength'), id: 'type-5' },\n            { text: l10n.getConstant('List'), id: 'type-6' }\n        ];\n        this.operatorData = [\n            { text: l10n.getConstant('Between'), id: 'operator-1' },\n            { text: l10n.getConstant('NotBetween'), id: 'operator-2' },\n            { text: l10n.getConstant('EqualTo'), id: 'operator-3' },\n            { text: l10n.getConstant('NotEqualTo'), id: 'operator-4' },\n            { text: l10n.getConstant('Greaterthan'), id: 'operator-5' },\n            { text: l10n.getConstant('Lessthan'), id: 'operator-6' },\n            { text: l10n.getConstant('GreaterThanOrEqualTo'), id: 'operator-7' },\n            { text: l10n.getConstant('LessThanOrEqualTo'), id: 'operator-8' }\n        ];\n        var allowSelectEle = this.parent.createElement('input', { className: 'e-select' });\n        var allowIdx = 0;\n        if (!isNew) {\n            for (var idx = 0; idx < this.typeData.length; idx++) {\n                if (type === this.typeData[idx].text.replace(' ', '')) {\n                    allowIdx = idx;\n                    break;\n                }\n            }\n        }\n        if (isNew || type !== 'List') {\n            var dataIdx = 0;\n            var dataText = this.parent.createElement('span', { className: 'e-header', innerHTML: l10n.getConstant('Data') });\n            var dataSelectEle = this.parent.createElement('input', { className: 'e-select' });\n            if (!isNew) {\n                for (var idx = 0; idx < this.operatorData.length; idx++) {\n                    if (operator === this.FormattedValue(this.operatorData[idx].text)) {\n                        dataIdx = idx;\n                        break;\n                    }\n                }\n            }\n            dataCont.appendChild(dataText);\n            dataCont.appendChild(dataSelectEle);\n            this.dataList = new DropDownList({\n                dataSource: this.operatorData,\n                index: dataIdx,\n                popupHeight: '200px',\n                change: function () { _this.userInput(listObj, _this.dataList); }\n            });\n            this.dataList.appendTo(dataSelectEle);\n        }\n        else {\n            var ignoreBlankEle_1 = this.parent.createElement('input', { className: 'e-checkbox' });\n            dataCont.appendChild(ignoreBlankEle_1);\n            var ignoreBlankObj_1 = new CheckBox({ label: l10n.getConstant('InCellDropDown'), checked: inCellDropDown });\n            ignoreBlankObj_1.appendTo(ignoreBlankEle_1);\n        }\n        allowCont.appendChild(allowText);\n        allowCont.appendChild(allowSelectEle);\n        var listObj = new DropDownList({\n            dataSource: this.typeData,\n            index: allowIdx,\n            popupHeight: '200px',\n            change: function () { _this.userInput(listObj, _this.dataList); }\n        });\n        listObj.appendTo(allowSelectEle);\n        if (isNew || (listObj.value !== 'List' && (this.dataList.value === 'Between' || this.dataList.value === 'Not between'))) {\n            var minimumCont = this.parent.createElement('div', { className: 'e-minimum' });\n            var maximumCont = this.parent.createElement('div', { className: 'e-maximum' });\n            valuesCont.appendChild(minimumCont);\n            valuesCont.appendChild(maximumCont);\n            var minimumText = this.parent.createElement('span', { className: 'e-header', innerHTML: l10n.getConstant('Minimum') });\n            var maximumText = this.parent.createElement('span', { className: 'e-header', innerHTML: l10n.getConstant('Maximum') });\n            var minimumInp = this.parent.createElement('input', {\n                id: 'minvalue',\n                className: 'e-input', attrs: { value: value1 }\n            });\n            var maximumInp = this.parent.createElement('input', {\n                id: 'maxvalue',\n                className: 'e-input', attrs: { value: value2 }\n            });\n            minimumCont.appendChild(minimumText);\n            minimumCont.appendChild(minimumInp);\n            maximumCont.appendChild(maximumText);\n            maximumCont.appendChild(maximumInp);\n            var numericMin = new NumericTextBox({\n                value: 0\n            });\n            numericMin.appendTo('#minvalue');\n            var numericMax = new NumericTextBox({\n                value: 0\n            });\n            numericMax.appendTo('#maxvalue');\n        }\n        else if (!isNew || type === ' List') {\n            var valueText = this.parent.createElement('span', {\n                className: 'e-header', innerHTML: l10n.getConstant('Sources')\n            });\n            var valueEle = this.parent.createElement('input', { className: 'e-input', attrs: { value: value1 } });\n            valuesCont.appendChild(valueText);\n            valuesCont.appendChild(valueEle);\n        }\n        else {\n            var valueText = this.parent.createElement('span', {\n                className: 'e-header', innerHTML: l10n.getConstant('Value')\n            });\n            var valueEle = this.parent.createElement('input', { className: 'e-input', attrs: { value: value1 } });\n            valuesCont.appendChild(valueText);\n            valuesCont.appendChild(valueEle);\n        }\n        var isChecked = ignoreBlank;\n        var ignoreBlankEle = this.parent.createElement('input', { className: 'e-checkbox' });\n        ignoreBlankCont.appendChild(ignoreBlankEle);\n        var ignoreBlankObj = new CheckBox({ label: l10n.getConstant('IgnoreBlank'), checked: isChecked });\n        ignoreBlankObj.appendTo(ignoreBlankEle);\n        return dlgContent;\n    };\n    DataValidation.prototype.userInput = function (listObj, listObj1) {\n        var dlgEle = this.parent.element.querySelector('.e-datavalidation-dlg');\n        var dlgCont = dlgEle.querySelector('.e-validation-dlg');\n        var allowDataCont = dlgCont.querySelector('.e-allowdata');\n        var valuesCont = dlgCont.querySelector('.e-values');\n        var l10n = this.parent.serviceLocator.getService(locale);\n        var dataCont = allowDataCont.querySelector('.e-data');\n        var opeEle = dataCont.querySelector('.e-valid-input');\n        while (valuesCont.lastChild) {\n            valuesCont.removeChild(valuesCont.lastChild);\n        }\n        if (listObj.value === 'List') {\n            while (dataCont.lastChild) {\n                dataCont.removeChild(dataCont.lastChild);\n            }\n            var ignoreBlankEle = this.parent.createElement('input', { className: 'e-checkbox' });\n            dataCont.appendChild(ignoreBlankEle);\n            var ignoreBlankObj = new CheckBox({ label: l10n.getConstant('InCellDropDown'), checked: true });\n            ignoreBlankObj.appendTo(ignoreBlankEle);\n        }\n        else {\n            if (dataCont.getElementsByClassName('e-checkbox-wrapper')[0]) {\n                while (dataCont.lastChild) {\n                    dataCont.removeChild(dataCont.lastChild);\n                }\n                var dataText = this.parent.createElement('span', { className: 'e-header', innerHTML: 'Data' });\n                var dataSelectEle = this.parent.createElement('input', { className: 'e-select' });\n                dataCont.appendChild(dataText);\n                dataCont.appendChild(dataSelectEle);\n                listObj1.appendTo(dataSelectEle);\n            }\n        }\n        if (listObj.value !== 'List' && (listObj1.value === 'Between' || listObj1.value === 'Not between')) {\n            var minimumCont = this.parent.createElement('div', { className: 'e-minimum' });\n            var maximumCont = this.parent.createElement('div', { className: 'e-maximum' });\n            valuesCont.appendChild(minimumCont);\n            valuesCont.appendChild(maximumCont);\n            var minimumText = this.parent.createElement('span', { className: 'e-header', innerHTML: l10n.getConstant('Minimum') });\n            var maximumText = this.parent.createElement('span', { className: 'e-header', innerHTML: l10n.getConstant('Maximum') });\n            var minimumInp = this.parent.createElement('input', { id: 'min', className: 'e-input', attrs: { value: '0' } });\n            var maximumInp = this.parent.createElement('input', { id: 'max', className: 'e-input', attrs: { value: '0' } });\n            var numericMin = new NumericTextBox({\n                value: 0\n            });\n            numericMin.appendTo('min');\n            var numericMax = new NumericTextBox({\n                value: 0\n            });\n            numericMax.appendTo('max');\n            minimumCont.appendChild(minimumText);\n            minimumCont.appendChild(minimumInp);\n            maximumCont.appendChild(maximumText);\n            maximumCont.appendChild(maximumInp);\n        }\n        else {\n            var text = listObj.value === 'List' ? l10n.getConstant('Sources') : l10n.getConstant('Value');\n            var valueText = this.parent.createElement('span', { className: 'e-header', innerHTML: text });\n            var valueEle = listObj.value === 'List' ? this.parent.createElement('input', {\n                className: 'e-input',\n                attrs: { placeholder: 'Enter value' }\n            }) :\n                this.parent.createElement('input', { className: 'e-input', attrs: { value: '0' } });\n            valuesCont.appendChild(valueText);\n            valuesCont.appendChild(valueEle);\n        }\n    };\n    DataValidation.prototype.dlgClickHandler = function (dialogInst) {\n        var l10n = this.parent.serviceLocator.getService(locale);\n        var isValidList = true;\n        var errorMsg;\n        var dlgEle = this.parent.element.querySelector('.e-datavalidation-dlg');\n        var dlgFooter = dlgEle.querySelector('.e-footer-content');\n        var dlgContEle = dlgEle.getElementsByClassName('e-dlg-content')[0].\n            getElementsByClassName('e-validation-dlg')[0];\n        var allowData = dlgContEle.getElementsByClassName('e-allowdata')[0];\n        var allowEle = allowData.getElementsByClassName('e-allow')[0].getElementsByTagName('input')[0];\n        var dataEle = allowData.getElementsByClassName('e-data')[0].getElementsByTagName('input')[0];\n        var values = dlgContEle.getElementsByClassName('e-values')[0];\n        var value1 = values.getElementsByTagName('input')[0].value;\n        var value2 = values.getElementsByTagName('input')[1] ? values.getElementsByTagName('input')[1].value : '';\n        var ignoreBlank = dlgContEle.querySelector('.e-ignoreblank').querySelector('.e-checkbox-wrapper').\n            getAttribute('aria-checked') === 'true' ? true : false;\n        var inCellDropDown = allowData.querySelector('.e-data').querySelector('.e-checkbox-wrapper') ?\n            allowData.querySelector('.e-data').querySelector('.e-checkbox-wrapper').querySelector('.e-check') ? true : false : null;\n        var range = dlgContEle.querySelector('.e-cellrange').getElementsByTagName('input')[0].value;\n        var operator;\n        var type = allowEle.value;\n        if (dataEle) {\n            operator = dataEle.value;\n            operator = this.FormattedValue(operator);\n        }\n        if (type) {\n            type = type.replace(' ', '');\n        }\n        var rangeAdd = [];\n        var valArr = [];\n        if (value1 !== '') {\n            valArr.push(value1);\n        }\n        if (value2 !== '') {\n            valArr.push(value2);\n        }\n        if (type === 'List') {\n            if (value1.indexOf('=') !== -1) {\n                if (value1.indexOf(':') !== -1) {\n                    var address = value1.indexOf('!') > -1 ? value1.split('!')[1] : value1.split('=')[1];\n                    var isSheetNameValid = value1.indexOf('!') > -1 ?\n                        getSheetIndex(this.parent, value1.split('=')[1].split('!')[0]) > -1 : true;\n                    rangeAdd = address.split(':');\n                    var isSingleCol = address.match(/[a-z]/gi) ?\n                        rangeAdd[0].replace(/[0-9]/g, '') === rangeAdd[1].replace(/[0-9]/g, '') : false;\n                    var isSingleRow = address.match(/\\d/g) ?\n                        rangeAdd[0].replace(/\\D/g, '') === rangeAdd[1].replace(/\\D/g, '') : false;\n                    isValidList = isSheetNameValid ? (isSingleCol ? true : isSingleRow ? true : false) : false;\n                    if (!isValidList) {\n                        errorMsg = l10n.getConstant('DialogError');\n                    }\n                }\n            }\n            else if (value1.length > 256) {\n                isValidList = false;\n                errorMsg = l10n.getConstant('ListLengthError');\n            }\n        }\n        if (type !== 'List' || isValidList) {\n            var sheet = this.parent.getActiveSheet();\n            var format = type;\n            var validDlg = this.isDialogValidator(valArr, format, operator);\n            errorMsg = validDlg.errorMsg;\n            isValidList = validDlg.isValidate;\n            if (isValidList) {\n                var indexes = getCellIndexes(this.parent.getActiveSheet().activeCell);\n                if (sheet && sheet.rows[indexes[0]] && sheet.rows[indexes[0]].cells[indexes[1]] &&\n                    sheet.rows[indexes[0]].cells[indexes[1]].validation &&\n                    sheet.rows[indexes[0]].cells[indexes[1]].validation.type === 'List') {\n                    var tdEle = this.parent.getMainContent().\n                        getElementsByTagName('tr')[indexes[0]].getElementsByClassName('e-cell')[indexes[1]];\n                    if (tdEle && tdEle.getElementsByClassName('e-validation-list')[0]) {\n                        tdEle.removeChild(tdEle.getElementsByClassName('e-validation-list')[0]);\n                        this.listObj.destroy();\n                    }\n                }\n                var rules = {\n                    type: type, operator: operator,\n                    value1: value1, value2: value2, ignoreBlank: ignoreBlank, inCellDropDown: inCellDropDown\n                };\n                this.parent.addDataValidation(rules, range);\n                if (type === 'List' && isValidList) {\n                    this.listHandler();\n                }\n                if (!document.getElementsByClassName('e-validationerror-dlg')[0]) {\n                    if (dialogInst.dialogInstance) {\n                        dialogInst.dialogInstance.hide();\n                    }\n                    else {\n                        dialogInst.hide();\n                    }\n                }\n            }\n        }\n        if (!isValidList) {\n            var errorEle = this.parent.createElement('div', {\n                className: 'e-dlg-error', id: 'e-invalid', innerHTML: errorMsg\n            });\n            values.appendChild(errorEle);\n            dlgFooter.querySelector('.e-primary').setAttribute('disabled', 'true');\n        }\n    };\n    DataValidation.prototype.FormattedValue = function (value) {\n        switch (value) {\n            case 'Between':\n                value = 'Between';\n                break;\n            case 'Not between':\n                value = 'NotBetween';\n                break;\n            case 'Equal to':\n                value = 'EqualTo';\n                break;\n            case 'Not equal to':\n                value = 'NotEqualTo';\n                break;\n            case 'Greater than':\n                value = 'GreaterThan';\n                break;\n            case 'Less than':\n                value = 'LessThan';\n                break;\n            case 'Greater than or equal to':\n                value = 'GreaterThanOrEqualTo';\n                break;\n            case 'Less than or equal to':\n                value = 'LessThanOrEqualTo';\n                break;\n            default:\n                value = 'Between';\n                break;\n        }\n        return value;\n    };\n    DataValidation.prototype.isDialogValidator = function (values, type, operator) {\n        var l10n = this.parent.serviceLocator.getService(locale);\n        var count = 0;\n        var isEmpty = false;\n        var formValidation;\n        if (type === 'List') {\n            isEmpty = values.length > 0 ? false : true;\n        }\n        else {\n            if (operator === 'Between' || operator === 'NotBetween') {\n                isEmpty = values.length === 2 ? false : true;\n            }\n            else {\n                isEmpty = values.length > 0 ? false : true;\n            }\n        }\n        if (!isEmpty) {\n            for (var idx = 0; idx < values.length; idx++) {\n                formValidation = this.formatValidation(values[idx], type);\n                if (formValidation.isValidate) {\n                    count = count + 1;\n                }\n                else {\n                    break;\n                }\n            }\n            formValidation.isValidate = count === values.length ? true : false;\n        }\n        else {\n            formValidation = { isValidate: false, errorMsg: l10n.getConstant('EmptyError') };\n        }\n        return { isValidate: formValidation.isValidate, errorMsg: formValidation.errorMsg };\n    };\n    // tslint:disable-next-line:max-func-body-length\n    DataValidation.prototype.isValidationHandler = function (args) {\n        var l10n = this.parent.serviceLocator.getService(locale);\n        args.value = args.value ? args.value : '';\n        var isValidate;\n        var errorMsg;\n        var enterValue = args.value;\n        var sheet = this.parent.sheets[args.sheetIdx];\n        var cell = getCell(args.range[0], args.range[1], sheet);\n        var value = args.value;\n        var value1 = cell.validation.value1;\n        var value2 = cell.validation.value2;\n        var opt = cell.validation.operator;\n        var type = cell.validation.type;\n        var ignoreBlank = !isNullOrUndefined(cell.validation.ignoreBlank) ? cell.validation.ignoreBlank : true;\n        var formValidation = this.formatValidation(args.value, type);\n        isValidate = formValidation.isValidate;\n        errorMsg = formValidation.errorMsg;\n        if (isValidate) {\n            isValidate = false;\n            if (type === 'Date' || type === 'Time') {\n                for (var idx = 0; idx <= 3; idx++) {\n                    args.value = idx === 0 ? args.value : idx === 1 ? cell.validation.value1 : cell.validation.value2;\n                    var dateEventArgs = {\n                        value: args.value,\n                        rowIndex: args.range[0],\n                        colIndex: args.range[1],\n                        sheetIndex: args.sheetIdx,\n                        updatedVal: ''\n                    };\n                    if (args.value !== '') {\n                        this.parent.notify(checkDateFormat, dateEventArgs);\n                    }\n                    var updatedVal = dateEventArgs.updatedVal;\n                    if (idx === 0) {\n                        value = type === 'Date' ? args.value : updatedVal.slice(updatedVal.indexOf('.') + 1, updatedVal.length);\n                    }\n                    else if (idx === 1) {\n                        value1 = type === 'Date' ? updatedVal : updatedVal.slice(updatedVal.indexOf('.') + 1, updatedVal.length);\n                    }\n                    else {\n                        value2 = type === 'Date' ? updatedVal : updatedVal.slice(updatedVal.indexOf('.') + 1, updatedVal.length);\n                    }\n                }\n            }\n            else if (cell.validation.type === 'TextLength') {\n                value = args.value.toString().length.toString();\n            }\n            if (type === 'List') {\n                if (value1.indexOf('=') !== -1) {\n                    for (var idx = 0; idx < this.data.length; idx++) {\n                        if (args.value === this.data[idx].text) {\n                            isValidate = true;\n                        }\n                    }\n                }\n                else {\n                    var values = value1.split(',');\n                    for (var idx = 0; idx < values.length; idx++) {\n                        if (args.value === values[idx]) {\n                            isValidate = true;\n                        }\n                    }\n                }\n            }\n            else {\n                if (type === 'Decimal') {\n                    value = parseFloat(value.toString());\n                    value1 = parseFloat(value1.toString());\n                    value2 = value2 ? parseFloat(value2.toString()) : null;\n                }\n                else {\n                    value = parseInt(value.toString(), 10);\n                    value1 = parseInt(value1.toString(), 10);\n                    value2 = value2 ? parseInt(value2.toString(), 10) : null;\n                }\n                switch (opt) {\n                    case 'EqualTo':\n                        if (value === value1) {\n                            isValidate = true;\n                        }\n                        else if (ignoreBlank && enterValue === '') {\n                            isValidate = true;\n                        }\n                        else {\n                            isValidate = false;\n                        }\n                        break;\n                    case 'NotEqualTo':\n                        if (value !== value1) {\n                            isValidate = true;\n                        }\n                        else if (ignoreBlank && enterValue === '') {\n                            isValidate = true;\n                        }\n                        else {\n                            isValidate = false;\n                        }\n                        break;\n                    case 'Between':\n                        if (value >= value1 && value <= value2) {\n                            isValidate = true;\n                        }\n                        else if (ignoreBlank && enterValue === '') {\n                            isValidate = true;\n                        }\n                        else {\n                            isValidate = false;\n                        }\n                        break;\n                    case 'NotBetween':\n                        if (value >= value1 && value <= value2) {\n                            isValidate = false;\n                        }\n                        else if (ignoreBlank && enterValue === '') {\n                            isValidate = true;\n                        }\n                        else {\n                            isValidate = true;\n                        }\n                        break;\n                    case 'GreaterThan':\n                        if (value > value1) {\n                            isValidate = true;\n                        }\n                        else if (ignoreBlank && enterValue === '') {\n                            isValidate = true;\n                        }\n                        else {\n                            isValidate = false;\n                        }\n                        break;\n                    case 'LessThan':\n                        if (value < value1) {\n                            isValidate = true;\n                        }\n                        else if (ignoreBlank && enterValue === '') {\n                            isValidate = true;\n                        }\n                        else {\n                            isValidate = false;\n                        }\n                        break;\n                    case 'GreaterThanOrEqualTo':\n                        if (value >= value1) {\n                            isValidate = true;\n                        }\n                        else if (ignoreBlank && enterValue === '') {\n                            isValidate = true;\n                        }\n                        else {\n                            isValidate = false;\n                        }\n                        break;\n                    case 'LessThanOrEqualTo':\n                        if (value <= value1) {\n                            isValidate = true;\n                        }\n                        else if (ignoreBlank && enterValue === '') {\n                            isValidate = true;\n                        }\n                        else {\n                            isValidate = false;\n                        }\n                        break;\n                    default:\n                        break;\n                }\n            }\n        }\n        errorMsg = l10n.getConstant('ValidationError');\n        if (isValidate) {\n            var style = this.parent.getCellStyleValue(['backgroundColor', 'color'], [args.range[0], args.range[1]]);\n            this.parent.notify(applyCellFormat, {\n                style: style, rowIdx: args.range[0],\n                colIdx: args.range[1], isHeightCheckNeeded: true, manualUpdate: true,\n                onActionUpdate: true\n            });\n        }\n        return { isValidate: isValidate, errorMsg: errorMsg };\n    };\n    DataValidation.prototype.checkDataValidation = function (args) {\n        var isValid = this.isValidationHandler({\n            value: args.value, range: args.range, sheetIdx: args.sheetIdx\n        });\n        if (!isValid.isValidate && args.isCell) {\n            this.validationErrorHandler(isValid.errorMsg);\n        }\n        this.parent.allowDataValidation = isValid.isValidate;\n    };\n    DataValidation.prototype.formatValidation = function (value, type) {\n        var sheetPanel = this.parent.element.getElementsByClassName('e-sheet-panel')[0];\n        var isValidate;\n        var errorMsg;\n        var formEle = this.parent.createElement('form', {\n            id: 'formId',\n            className: 'form-horizontal'\n        });\n        var inputEle = this.parent.createElement('input', {\n            id: 'e-validation', innerHTML: value\n        });\n        inputEle.setAttribute('name', 'validation');\n        inputEle.setAttribute('type', 'text');\n        inputEle.setAttribute('value', value);\n        formEle.appendChild(inputEle);\n        sheetPanel.appendChild(formEle);\n        var options;\n        switch (type) {\n            case 'Date':\n                options = {\n                    rules: {\n                        'validation': { date: true },\n                    },\n                    customPlacement: function (inputElement, error) {\n                        errorMsg = error.innerText;\n                    }\n                };\n                break;\n            case 'Decimal':\n                options = {\n                    rules: {\n                        'validation': { number: true },\n                    },\n                    customPlacement: function (inputElement, error) {\n                        errorMsg = error.innerText;\n                    }\n                };\n                break;\n            case 'WholeNumber':\n                options = {\n                    rules: {\n                        'validation': { regex: /^\\d*\\.?[0]*$/ },\n                    },\n                    customPlacement: function (inputElement, error) {\n                        errorMsg = error.innerText;\n                    }\n                };\n                break;\n            default:\n                break;\n        }\n        var formObj = new FormValidator('#formId', options);\n        isValidate = formObj.validate();\n        sheetPanel.removeChild(sheetPanel.getElementsByClassName('form-horizontal')[0]);\n        return { isValidate: isValidate, errorMsg: errorMsg };\n    };\n    DataValidation.prototype.validationErrorHandler = function (error) {\n        var _this = this;\n        var el = document.getElementsByClassName('e-spreadsheet-edit')[0];\n        var l10n = this.parent.serviceLocator.getService(locale);\n        if (!this.parent.element.querySelector('.e-validationerror-dlg')) {\n            var erroDialogInst_1 = this.parent.serviceLocator.getService(dialog);\n            var disableCancel = false;\n            var dlgModel = {\n                width: 400, height: 200, isModal: true, showCloseIcon: true, cssClass: 'e-validationerror-dlg',\n                target: document.querySelector('.e-control.e-spreadsheet'),\n                beforeOpen: function (args) {\n                    var dlgArgs = {\n                        dialogName: 'ValidationErrorDialog',\n                        element: args.element, target: args.target, cancel: args.cancel, content: error\n                    };\n                    _this.parent.trigger('dialogBeforeOpen', dlgArgs);\n                    if (dlgArgs.cancel) {\n                        _this.errorDlgHandler(erroDialogInst_1, 'Cancel');\n                        args.cancel = true;\n                    }\n                    el.focus();\n                    erroDialogInst_1.dialogInstance.content = dlgArgs.content;\n                    erroDialogInst_1.dialogInstance.dataBind();\n                },\n                buttons: [{\n                        buttonModel: {\n                            content: l10n.getConstant('Retry'), isPrimary: true,\n                        },\n                        click: function () {\n                            _this.errorDlgHandler(erroDialogInst_1, 'Retry');\n                        }\n                    },\n                    {\n                        buttonModel: {\n                            content: l10n.getConstant('Cancel'),\n                        },\n                        click: function () {\n                            _this.errorDlgHandler(erroDialogInst_1, 'Cancel');\n                        }\n                    }]\n            };\n            erroDialogInst_1.show(dlgModel, disableCancel);\n        }\n    };\n    DataValidation.prototype.errorDlgHandler = function (errorDialogInst, buttonName) {\n        if (buttonName === 'Retry') {\n            var el = document.getElementsByClassName('e-spreadsheet-edit')[0];\n            var mainCont = this.parent.getMainContent();\n            errorDialogInst.hide();\n            if (el.innerText) {\n                var range = document.createRange();\n                range.setStart(el.childNodes[0], 0);\n                range.setEnd(el.childNodes[0], el.innerText.length);\n                var selection = window.getSelection();\n                selection.removeAllRanges();\n                selection.addRange(range);\n                if (this.listObj) {\n                    this.listObj.showPopup();\n                }\n            }\n        }\n        else {\n            var indexes = getCellIndexes(this.parent.getActiveSheet().activeCell);\n            var value = this.parent.getDisplayText(this.parent.getActiveSheet().rows[indexes[0]].cells[indexes[1]]);\n            this.parent.notify(editOperation, {\n                action: 'cancelEdit', value: value, refreshFormulaBar: true,\n                refreshEditorElem: true, isAppend: false, trigEvent: true\n            });\n            errorDialogInst.hide();\n        }\n    };\n    /**\n     * Gets the module name.\n     * @returns string\n     */\n    DataValidation.prototype.getModuleName = function () {\n        return 'dataValidation';\n    };\n    return DataValidation;\n}());\nexport { DataValidation };\n","import { applyProtect, protectSheet, protectCellFormat, editAlert, enableFormulaInput } from '../common/event';\nimport { clearCopy, protectSelection, clearUndoRedoCollection } from '../common/index';\nimport { ListView } from '@syncfusion/ej2-lists';\nimport { EventHandler } from '@syncfusion/ej2-base';\nimport { locale, updateToggleItem } from '../common/index';\nimport { CheckBox } from '@syncfusion/ej2-buttons';\nimport { applyLockCells, setCell } from '../../workbook/index';\n/**\n * The `Protect-sheet` module is used to handle the Protecting functionalities in Spreadsheet.\n */\nvar ProtectSheet = /** @class */ (function () {\n    /**\n     * Constructor for protectSheet module in Spreadsheet.\n     * @private\n     */\n    function ProtectSheet(parent) {\n        this.parent = parent;\n        this.init();\n    }\n    ProtectSheet.prototype.init = function () {\n        this.addEventListener();\n    };\n    /**\n     * To destroy the protectSheet module.\n     * @return {void}\n     * @hidden\n     */\n    ProtectSheet.prototype.destroy = function () {\n        this.removeEventListener();\n        this.parent = null;\n    };\n    ProtectSheet.prototype.addEventListener = function () {\n        this.parent.on(applyProtect, this.protect, this);\n        this.parent.on(protectSheet, this.protectSheetHandler, this);\n        this.parent.on(editAlert, this.editProtectedAlert, this);\n        this.parent.on(applyLockCells, this.lockCellsHandler, this);\n    };\n    ProtectSheet.prototype.removeEventListener = function () {\n        if (!this.parent.isDestroyed) {\n            this.parent.off(applyProtect, this.protect);\n            this.parent.off(protectSheet, this.protectSheetHandler);\n            this.parent.off(editAlert, this.editProtectedAlert);\n            this.parent.off(applyLockCells, this.lockCellsHandler);\n        }\n    };\n    ProtectSheet.prototype.protect = function (args) {\n        this.parent.notify(clearCopy, null);\n        if (!args.isActive) {\n            this.createDialogue();\n        }\n        else {\n            this.parent.setSheetPropertyOnMute(this.parent.getActiveSheet(), 'isProtected', false);\n            this.parent.notify(updateToggleItem, { props: 'Protect' });\n            this.parent.notify(protectSheet, { isActive: args.isActive });\n            this.parent.notify(protectSelection, null);\n        }\n    };\n    ProtectSheet.prototype.createDialogue = function () {\n        var _this = this;\n        var l10n = this.parent.serviceLocator.getService(locale);\n        var listData = [\n            { text: l10n.getConstant('SelectCells'), id: '1' },\n            { text: l10n.getConstant('FormatCells'), id: '2' },\n            { text: l10n.getConstant('FormatRows'), id: '3' },\n            { text: l10n.getConstant('FormatColumns'), id: '4' },\n            { text: l10n.getConstant('InsertLinks'), id: '5' }\n        ];\n        this.optionList = new ListView({\n            width: '250px',\n            dataSource: listData,\n            showCheckBox: true,\n            select: this.dialogOpen.bind(this),\n        });\n        var protectHeaderCntent = this.parent.createElement('div', { className: 'e-protect-content',\n            innerHTML: l10n.getConstant('ProtectAllowUser') });\n        this.parent.setSheetPropertyOnMute(this.parent.getActiveSheet(), 'isProtected', false);\n        var checkbox = new CheckBox({ checked: true, label: l10n.getConstant('ProtectContent'), cssClass: 'e-protect-checkbox' });\n        var listViewElement = this.parent.createElement('div', { className: 'e-protect-option-list',\n            id: this.parent.element.id + '_option_list' });\n        var headerContent = this.parent.createElement('div', { className: 'e-header-content', innerHTML: l10n.getConstant('ProtectSheet') });\n        var checkBoxElement = this.parent.createElement('input', { id: this.parent.element.id + '_protect_check', attrs: { type: 'checkbox' } });\n        this.dialog = this.parent.serviceLocator.getService('dialog');\n        this.dialog.show({\n            header: headerContent.outerHTML,\n            content: checkBoxElement.outerHTML + protectHeaderCntent.outerHTML + listViewElement.outerHTML,\n            showCloseIcon: true, isModal: true,\n            cssClass: 'e-protect-dlg',\n            beforeOpen: function (args) {\n                var dlgArgs = {\n                    dialogName: 'ProtectSheetDialog',\n                    element: args.element, target: args.target, cancel: args.cancel\n                };\n                _this.parent.trigger('dialogBeforeOpen', dlgArgs);\n                if (dlgArgs.cancel) {\n                    args.cancel = true;\n                }\n                _this.parent.element.focus();\n            },\n            open: function () {\n                _this.okBtnFocus();\n            },\n            beforeClose: function () {\n                var checkboxElement = document.getElementById(_this.parent.element.id + '_protect_check');\n                EventHandler.remove(checkboxElement, 'focus', _this.okBtnFocus);\n                EventHandler.remove(checkbox.element, 'click', _this.checkBoxClickHandler);\n                _this.parent.element.focus();\n            },\n            buttons: [{ click: (this.selectOption.bind(this, this.dialog, this)),\n                    buttonModel: { content: l10n.getConstant('Ok'), isPrimary: true } }]\n        });\n        checkbox.appendTo('#' + this.parent.element.id + '_protect_check');\n        this.optionList.appendTo('#' + this.parent.element.id + '_option_list');\n        this.optionList.selectMultipleItems([{ id: '1' }]);\n        EventHandler.add(checkbox.element, 'click', this.checkBoxClickHandler, this);\n    };\n    ;\n    ProtectSheet.prototype.okBtnFocus = function () {\n        var _this = this;\n        var checkboxElement = document.getElementById(this.parent.element.id + '_protect_check');\n        checkboxElement.addEventListener('focus', function () {\n            _this.dialog.dialogInstance.element.getElementsByClassName('e-footer-content')[0].querySelector('button').focus();\n        });\n    };\n    ProtectSheet.prototype.checkBoxClickHandler = function () {\n        var ch = document.getElementById(this.parent.element.id + '_protect_check');\n        if (ch.checked === false) {\n            this.dialog.dialogInstance.element.getElementsByClassName('e-footer-content')[0].querySelector('button').disabled = true;\n        }\n        else {\n            this.dialog.dialogInstance.element.getElementsByClassName('e-footer-content')[0].querySelector('button').disabled = false;\n            this.dialog.dialogInstance.element.getElementsByClassName('e-footer-content')[0].querySelector('button').focus();\n        }\n    };\n    ProtectSheet.prototype.dialogOpen = function () {\n        this.dialog.dialogInstance.element.getElementsByClassName('e-footer-content')[0].querySelector('button').focus();\n    };\n    ProtectSheet.prototype.selectOption = function () {\n        var l10n = this.parent.serviceLocator.getService(locale);\n        var selectedItems = this.optionList.getSelectedItems();\n        this.parent.setSheetPropertyOnMute(this.parent.getActiveSheet(), 'isProtected', true);\n        var protectSettings = { selectCells: selectedItems.text.indexOf(l10n.getConstant('SelectCells')) > -1,\n            formatCells: selectedItems.text.indexOf(l10n.getConstant('FormatCells')) > -1,\n            formatRows: selectedItems.text.indexOf(l10n.getConstant('FormatRows')) > -1,\n            formatColumns: selectedItems.text.indexOf(l10n.getConstant('FormatColumns')) > -1,\n            insertLink: selectedItems.text.indexOf(l10n.getConstant('InsertLinks')) > -1 };\n        this.parent.protectSheet(null, protectSettings);\n        this.parent.notify(protectSelection, null);\n        this.parent.notify(clearUndoRedoCollection, null);\n        this.dialog.hide();\n    };\n    ProtectSheet.prototype.protectSheetHandler = function (args) {\n        var sheet = this.parent.getActiveSheet();\n        var id = this.parent.element.id;\n        var disableHomeBtnId = [id + '_undo', id + '_redo', id + '_cut', id + '_copy', id + '_paste', id + '_number_format',\n            id + '_font_name', id + '_font_size', id + '_bold', id + '_italic', id + '_line-through', id + '_underline',\n            id + '_font_color_picker', id + '_fill_color_picker', id + '_borders', id + '_merge_cells', id + '_text_align',\n            id + '_vertical_align', id + '_wrap', id + '_sorting', id + '_clear', id + '_conditionalformatting'];\n        var enableHomeBtnId = [id + '_cut', id + '_copy', id + '_number_format', id + '_font_name', id + '_font_size',\n            id + '_bold', id + '_italic', id + '_line-through', id + '_underline', id + '_font_color_picker', id + '_fill_color_picker',\n            id + '_borders', id + '_text_align', id + '_vertical_align', id + '_wrap', id + '_sorting',\n            id + '_clear', id + '_conditionalformatting'];\n        var enableFrmlaBtnId = [id + '_insert_function'];\n        var enableInsertBtnId = [id + '_hyperlink', id + '_', id + '_chart'];\n        var imageBtnId = [id + '_'];\n        var findBtnId = [id + '_find'];\n        var dataValidationBtnId = [id + '_datavalidation'];\n        var chartBtnId = [id + '_chart'];\n        var sheetElement = document.getElementById(this.parent.element.id + '_sheet_panel');\n        if (sheetElement) {\n            if ((sheet.isProtected && sheet.protectSettings.selectCells)) {\n                {\n                    sheetElement.classList.remove('e-protected');\n                }\n            }\n            else {\n                sheetElement.classList.add('e-protected');\n            }\n            if (!sheet.isProtected) {\n                sheetElement.classList.remove('e-protected');\n            }\n        }\n        this.parent.dataBind();\n        this.parent.notify(protectCellFormat, { disableHomeBtnId: disableHomeBtnId,\n            enableHomeBtnId: enableHomeBtnId, enableFrmlaBtnId: enableFrmlaBtnId, enableInsertBtnId: enableInsertBtnId,\n            findBtnId: findBtnId, dataValidationBtnId: dataValidationBtnId, imageBtnId: imageBtnId, chartBtnId: chartBtnId });\n        this.parent.notify(enableFormulaInput, null);\n        this.parent.notify(updateToggleItem, { props: 'Protect' });\n    };\n    ProtectSheet.prototype.editProtectedAlert = function () {\n        var _this = this;\n        var l10n = this.parent.serviceLocator.getService(locale);\n        this.dialog = this.parent.serviceLocator.getService('dialog');\n        this.dialog.show({\n            content: l10n.getConstant('EditAlert'),\n            isModal: true,\n            closeOnEscape: true,\n            showCloseIcon: true,\n            width: '400px',\n            cssClass: 'e-editAlert-dlg',\n            beforeOpen: function (args) {\n                var dlgArgs = {\n                    dialogName: 'EditAlertDialog',\n                    element: args.element, target: args.target, cancel: args.cancel\n                };\n                _this.parent.trigger('dialogBeforeOpen', dlgArgs);\n                if (dlgArgs.cancel) {\n                    args.cancel = true;\n                }\n                _this.parent.element.focus();\n            },\n            close: function () { return _this.parent.element.focus(); }\n        });\n    };\n    ProtectSheet.prototype.lockCellsHandler = function (args) {\n        var sheet = this.parent.getActiveSheet();\n        var cellObj = { isLocked: args.isLocked ? args.isLocked : false };\n        setCell(args.rowIdx, args.colIdx, sheet, cellObj, true);\n    };\n    /**\n     * Get the module name.\n     * @returns string\n     *\n     * @private\n     */\n    ProtectSheet.prototype.getModuleName = function () {\n        return 'protectSheet';\n    };\n    return ProtectSheet;\n}());\nexport { ProtectSheet };\n","import { findDlg, locale, dialog, gotoDlg, replace, findHandler, beginAction } from '../common/index';\nimport { completeAction } from '../common/index';\nimport { getComponent, isNullOrUndefined } from '@syncfusion/ej2-base';\nimport { goto, showDialog, findUndoRedo, count, replaceAllDialog, findKeyUp } from '../../workbook/index';\nimport { CheckBox } from '@syncfusion/ej2-buttons';\nimport { DropDownList } from '@syncfusion/ej2-dropdowns';\nimport { TextBox } from '@syncfusion/ej2-inputs';\n/**\n * `FindAndReplace` module is used to handle the search action in Spreadsheet.\n */\nvar FindAndReplace = /** @class */ (function () {\n    /**\n     * Constructor for FindAndReplace module.\n     */\n    function FindAndReplace(parent) {\n        this.shortValue = '';\n        this.parent = parent;\n        this.addEventListener();\n    }\n    FindAndReplace.prototype.addEventListener = function () {\n        this.parent.on(findDlg, this.renderFindDlg, this);\n        this.parent.on(gotoDlg, this.renderGotoDlg, this);\n        this.parent.on(goto, this.gotoHandler, this);\n        this.parent.on(findHandler, this.findHandler, this);\n        this.parent.on(replace, this.replaceHandler, this);\n        this.parent.on(showDialog, this.showDialog, this);\n        this.parent.on(replaceAllDialog, this.replaceAllDialog, this);\n        this.parent.on(findUndoRedo, this.findUndoRedo, this);\n        this.parent.on(findKeyUp, this.findKeyUp, this);\n    };\n    FindAndReplace.prototype.removeEventListener = function () {\n        if (!this.parent.isDestroyed) {\n            this.parent.off(findDlg, this.renderFindDlg);\n            this.parent.off(gotoDlg, this.renderGotoDlg);\n            this.parent.off(goto, this.gotoHandler);\n            this.parent.off(findHandler, this.findHandler);\n            this.parent.off(replace, this.replaceHandler);\n            this.parent.off(showDialog, this.showDialog);\n            this.parent.off(replaceAllDialog, this.replaceAllDialog);\n            this.parent.off(findUndoRedo, this.findUndoRedo);\n            this.parent.off(findKeyUp, this.findKeyUp);\n        }\n    };\n    FindAndReplace.prototype.findUndoRedo = function (options) {\n        var eventArgs = { address: options.address, compareVal: options.compareVal, cancel: false };\n        if (options.undoRedoOpt === 'before') {\n            this.parent.notify(beginAction, { action: 'beforeReplace', eventArgs: eventArgs });\n        }\n        else if (options.undoRedoOpt === 'after') {\n            if (!eventArgs.cancel) {\n                var eventArgs_1 = { address: options.address, compareVal: options.compareVal };\n                this.parent.notify(completeAction, { action: 'replace', eventArgs: eventArgs_1 });\n            }\n        }\n        else if (options.undoRedoOpt === 'beforeReplaceAll') {\n            if (!eventArgs.cancel) {\n                var eventArgs_2 = { replaceValue: options.replaceValue, addressCollection: options.Collection };\n                this.parent.notify(beginAction, { action: 'beforeReplaceAll', eventArgs: eventArgs_2 });\n            }\n        }\n        else if (options.undoRedoOpt === 'afterReplaceAll') {\n            if (!eventArgs.cancel) {\n                var eventArgs_3 = { replaceValue: options.replaceValue, addressCollection: options.Collection };\n                this.parent.notify(completeAction, { action: 'replaceAll', eventArgs: eventArgs_3 });\n            }\n        }\n    };\n    FindAndReplace.prototype.renderFindDlg = function () {\n        var _this = this;\n        var l10n = this.parent.serviceLocator.getService(locale);\n        var dialogInst = this.parent.serviceLocator.getService(dialog);\n        var cancelButton = false;\n        if (isNullOrUndefined(this.parent.element.querySelector('.e-find-dlg'))) {\n            var dlg = {\n                isModal: false, showCloseIcon: true, cssClass: 'e-find-dlg', allowDragging: true,\n                header: l10n.getConstant('FindAndReplace'), closeOnEscape: false,\n                beforeOpen: function (args) {\n                    var dlgArgs = {\n                        dialogName: 'FindAndReplaceDialog',\n                        element: args.element, target: args.target, cancel: args.cancel\n                    };\n                    _this.parent.trigger('dialogBeforeOpen', dlgArgs);\n                    if (dlgArgs.cancel) {\n                        args.cancel = true;\n                    }\n                    dialogInst.dialogInstance.content = _this.findandreplaceContent();\n                    dialogInst.dialogInstance.dataBind();\n                    _this.parent.element.focus();\n                },\n                buttons: [{\n                        buttonModel: {\n                            content: l10n.getConstant('FindPreviousBtn'), isPrimary: true, cssClass: 'e-btn-findPrevious', disabled: true\n                        },\n                        click: function () {\n                            _this.dialogMessage();\n                            _this.findDlgClick('prev');\n                        }\n                    }, {\n                        buttonModel: {\n                            content: l10n.getConstant('FindNextBtn'), isPrimary: true, cssClass: 'e-btn-findNext', disabled: true\n                        },\n                        click: function () {\n                            _this.dialogMessage();\n                            _this.findDlgClick('next');\n                        }\n                    }, {\n                        buttonModel: {\n                            content: l10n.getConstant('ReplaceBtn'), isPrimary: true, cssClass: 'e-btn-replace', disabled: true\n                        },\n                        click: function () {\n                            _this.dialogMessage();\n                            _this.findDlgClick('replace');\n                        }\n                    }, {\n                        buttonModel: {\n                            content: l10n.getConstant('ReplaceAllBtn'), isPrimary: true, cssClass: 'e-btn-replaceAll', disabled: true\n                        },\n                        click: function () {\n                            _this.dialogMessage();\n                            _this.findDlgClick('replaceAll');\n                        }\n                    }], open: function () {\n                    var findInput = _this.parent.element.querySelector('.e-text-findNext').value;\n                    if (findInput) {\n                        var prevButton = _this.parent.element.querySelector('.e-btn-findPrevious');\n                        var prevButtonObj = getComponent(prevButton, 'btn');\n                        prevButtonObj.disabled = false;\n                        getComponent(_this.parent.element.querySelector('.e-btn-findNext'), 'btn').disabled = false;\n                    }\n                }, close: function () {\n                    dialogInst.hide();\n                }\n            };\n            dialogInst.show(dlg, cancelButton);\n        }\n        else {\n            dialogInst.hide();\n        }\n    };\n    FindAndReplace.prototype.dialogMessage = function () {\n        if (this.parent.element.querySelector('.e-replace-alert-span')) {\n            this.parent.element.querySelector('.e-replace-alert-span').remove();\n        }\n        else if (this.parent.element.querySelector('.e-find-alert-span')) {\n            this.parent.element.querySelector('.e-find-alert-span').remove();\n        }\n    };\n    FindAndReplace.prototype.renderGotoDlg = function () {\n        var _this = this;\n        var l10n = this.parent.serviceLocator.getService(locale);\n        var dialogInst = this.parent.serviceLocator.getService(dialog);\n        var cancelBtn = false;\n        if (isNullOrUndefined(this.parent.element.querySelector('.e-find-dlg'))) {\n            var dlg = {\n                width: 300, isModal: false, showCloseIcon: true, cssClass: 'e-goto-dlg', allowDragging: true,\n                header: l10n.getConstant('GotoHeader'),\n                beforeOpen: function (args) {\n                    var dlgArgs = {\n                        dialogName: 'GoToDialog',\n                        element: args.element, target: args.target, cancel: args.cancel\n                    };\n                    _this.parent.trigger('dialogBeforeOpen', dlgArgs);\n                    if (dlgArgs.cancel) {\n                        args.cancel = true;\n                    }\n                    dialogInst.dialogInstance.content = _this.GotoContent();\n                    dialogInst.dialogInstance.dataBind();\n                    _this.parent.element.focus();\n                },\n                buttons: [{\n                        buttonModel: {\n                            content: l10n.getConstant('Ok'), isPrimary: true, cssClass: 'e-btn-goto-ok'\n                        },\n                        click: function () {\n                            _this.gotoHandler();\n                        },\n                    }], close: function () {\n                    dialogInst.hide();\n                }, open: function () {\n                    _this.textFocus();\n                },\n            };\n            dialogInst.show(dlg, cancelBtn);\n        }\n        else {\n            dialogInst.hide();\n        }\n    };\n    FindAndReplace.prototype.textFocus = function () {\n        var _this = this;\n        var element = this.parent.element.querySelector('.e-text-goto');\n        element.addEventListener('focus', function () {\n            if (_this.parent.element.querySelector('.e-goto-alert-span')) {\n                _this.parent.element.querySelector('.e-goto-alert-span').remove();\n            }\n        });\n    };\n    FindAndReplace.prototype.findDlgClick = function (findDlgArgs) {\n        if (findDlgArgs === 'prev') {\n            this.findHandler({ findOption: findDlgArgs });\n        }\n        else if (findDlgArgs === 'next') {\n            this.findHandler({ findOption: findDlgArgs });\n        }\n        else {\n            this.replaceHandler({ findDlgArgs: findDlgArgs });\n        }\n    };\n    FindAndReplace.prototype.findHandler = function (findOpt) {\n        var findInput = this.parent.element.querySelector('.e-text-findNext');\n        if (!findInput) {\n            findInput = this.parent.element.querySelector('.e-text-findNext-short');\n            if (!findInput) {\n                this.gotoAlert();\n            }\n        }\n        var value = findInput.value;\n        if (findInput.value !== '') {\n            var sheetIndex = this.parent.activeSheetIndex;\n            var checkCase = this.parent.element.querySelector('.e-findnreplace-checkcase');\n            var isCSen = void 0;\n            if (!checkCase) {\n                isCSen = false;\n            }\n            else {\n                var caseCheckbox = getComponent(checkCase, 'checkbox');\n                isCSen = caseCheckbox.checked;\n            }\n            var checkmatch = this.parent.element.querySelector('.e-findnreplace-checkmatch');\n            var isEMatch = void 0;\n            if (!checkmatch) {\n                isEMatch = false;\n            }\n            else {\n                var entireMatchCheckbox = getComponent(checkmatch, 'checkbox');\n                isEMatch = entireMatchCheckbox.checked;\n            }\n            var searchitem = this.parent.element.querySelector('.e-findnreplace-searchby');\n            var searchBy = void 0;\n            if (!searchitem) {\n                searchBy = 'By Row';\n            }\n            else {\n                var searchDDL = getComponent(searchitem, 'dropdownlist');\n                searchBy = searchDDL.value.toString();\n            }\n            var modeitem = this.parent.element.querySelector('.e-findnreplace-searchwithin');\n            var mode = void 0;\n            if (!modeitem) {\n                mode = 'Sheet';\n            }\n            else {\n                var modeDDL = getComponent(modeitem, 'dropdownlist');\n                mode = modeDDL.value.toString();\n            }\n            var args = {\n                value: value, sheetIndex: sheetIndex, findOpt: findOpt.findOption, mode: mode, isCSen: isCSen,\n                isEMatch: isEMatch, searchBy: searchBy\n            };\n            if (findOpt.findOption === 'next' || findOpt.findOption === 'prev') {\n                this.parent.find(args);\n            }\n            else if (findOpt.countArgs.countOpt === 'count') {\n                this.parent.notify(count, args);\n                findOpt.countArgs.findCount = args.findCount;\n            }\n        }\n    };\n    FindAndReplace.prototype.replaceHandler = function (replace) {\n        var sheetIndex = this.parent.activeSheetIndex;\n        var findInput = this.parent.element.querySelector('.e-text-findNext');\n        var replaceWith = this.parent.element.querySelector('.e-text-replaceInp');\n        var checkCase = this.parent.element.querySelector('.e-findnreplace-checkcase');\n        var caseCheckbox = getComponent(checkCase, 'checkbox');\n        var checkmatch = this.parent.element.querySelector('.e-findnreplace-checkmatch');\n        var eMatchCheckbox = getComponent(checkmatch, 'checkbox');\n        var searchitem = this.parent.element.querySelector('.e-findnreplace-searchby');\n        var searchDDL = getComponent(searchitem, 'dropdownlist');\n        var modeitem = this.parent.element.querySelector('.e-findnreplace-searchwithin');\n        var modeDDL = getComponent(modeitem, 'dropdownlist');\n        var findOption = 'next';\n        var args = {\n            value: findInput.value, mode: modeDDL.value.toString(), isCSen: caseCheckbox.checked,\n            isEMatch: eMatchCheckbox.checked, searchBy: searchDDL.value.toString(), findOpt: findOption, replaceValue: replaceWith.value,\n            replaceBy: replace.findDlgArgs ? replace.findDlgArgs : replace.replaceMode, sheetIndex: sheetIndex\n        };\n        this.parent.replace(args);\n    };\n    FindAndReplace.prototype.gotoHandler = function (address) {\n        if (address) {\n            this.parent.goTo(address.address);\n        }\n        else {\n            var item = this.parent.element.querySelector('.e-text-goto');\n            var gotoaddress = item.value;\n            var splitAddress = gotoaddress.split('');\n            if ((gotoaddress === '') || isNaN(parseInt(splitAddress[1], 10))) {\n                this.gotoAlert();\n                return;\n            }\n            else {\n                var address_1 = gotoaddress.toString().toUpperCase();\n                this.parent.goTo(address_1);\n            }\n        }\n    };\n    FindAndReplace.prototype.gotoAlert = function () {\n        var l10n = this.parent.serviceLocator.getService(locale);\n        var gotoSpan = this.parent.createElement('span', {\n            className: 'e-goto-alert-span',\n            innerHTML: l10n.getConstant('InsertingEmptyValue')\n        });\n        (this.parent.element.querySelector('.e-goto-dlg').querySelector('.e-dlg-content')).appendChild(gotoSpan);\n    };\n    FindAndReplace.prototype.showDialog = function () {\n        if (this.parent.element.querySelector('.e-replace-alert-span')) {\n            this.parent.element.querySelector('.e-replace-alert-span').remove();\n        }\n        var l10n = this.parent.serviceLocator.getService(locale);\n        var findSpan = this.parent.createElement('span', {\n            className: 'e-find-alert-span',\n            innerHTML: l10n.getConstant('NoElements')\n        });\n        (this.parent.element.querySelector('.e-find-dlg').querySelector('.e-dlg-content')).appendChild(findSpan);\n    };\n    FindAndReplace.prototype.replaceAllDialog = function (options) {\n        if (this.parent.element.querySelector('.e-find-alert-span')) {\n            this.parent.element.querySelector('.e-find-alert-span').remove();\n        }\n        var l10n = (this.parent.serviceLocator.getService(locale));\n        var replaceSpan = this.parent.createElement('span', {\n            className: 'e-replace-alert-span',\n            innerHTML: options.count + l10n.getConstant('ReplaceAllEnd') + options.replaceValue\n        });\n        if (this.parent.element.querySelector('.e-find-dlg')) {\n            (this.parent.element.querySelector('.e-find-dlg').querySelector('.e-dlg-content')).appendChild(replaceSpan);\n        }\n    };\n    FindAndReplace.prototype.findKeyUp = function (e) {\n        if (e.target, 'e-text-findNext') {\n            var findValue_1 = this.parent.element.querySelector('.e-text-findNext').value;\n            if (!isNullOrUndefined(findValue_1) && findValue_1 !== '') {\n                var prevButton = this.parent.element.querySelector('.e-btn-findPrevious');\n                var prevButtonObj = getComponent(prevButton, 'btn');\n                prevButtonObj.disabled = false;\n                getComponent(this.parent.element.querySelector('.e-btn-findNext'), 'btn').disabled = false;\n            }\n            else {\n                getComponent(this.parent.element.querySelector('.e-btn-findPrevious'), 'btn').disabled = true;\n                getComponent(this.parent.element.querySelector('.e-btn-findNext'), 'btn').disabled = true;\n                this.dialogMessage();\n            }\n        }\n        var findValue = this.parent.element.querySelector('.e-text-findNext').value;\n        var replaceValue = this.parent.element.querySelector('.e-text-replaceInp').value;\n        if (!isNullOrUndefined(findValue) && !isNullOrUndefined(replaceValue) && (findValue !== '') && (replaceValue !== '')) {\n            if (this.parent.getActiveSheet().isProtected === false) {\n                getComponent(this.parent.element.querySelector('.e-btn-replace'), 'btn').disabled = false;\n                getComponent(this.parent.element.querySelector('.e-btn-replaceAll'), 'btn').disabled = false;\n            }\n        }\n        else {\n            getComponent(this.parent.element.querySelector('.e-btn-replace'), 'btn').disabled = true;\n            getComponent(this.parent.element.querySelector('.e-btn-replaceAll'), 'btn').disabled = true;\n            this.dialogMessage();\n        }\n    };\n    FindAndReplace.prototype.findandreplaceContent = function () {\n        if (this.parent.element.querySelector('.e-text-findNext-short')) {\n            this.shortValue = this.parent.element.querySelector('.e-text-findNext-short').value;\n        }\n        var dialogElem = this.parent.createElement('div', { className: 'e-link-dialog' });\n        var findElem = this.parent.createElement('div', { className: 'e-find' });\n        var findCheck = this.parent.createElement('div', { className: 'e-findCheck' });\n        var l10n = this.parent.serviceLocator.getService(locale);\n        dialogElem.appendChild(findElem);\n        var findTextE = this.parent.createElement('div', { className: 'e-cont' });\n        var findTextH = this.parent.createElement('p', { className: 'e-header', innerHTML: l10n.getConstant('FindWhat') });\n        var findTextIp = this.parent.createElement('input', {\n            className: 'e-input e-text-findNext', attrs: {\n                'type': 'Text', 'placeholder': l10n.getConstant('FindValue'),\n                'value': this.shortValue\n            }\n        });\n        findTextE.appendChild(findTextIp);\n        findTextE.insertBefore(findTextH, findTextIp);\n        findElem.appendChild(findTextE);\n        var findTextBox = new TextBox({ width: '70%' });\n        findTextBox.createElement = this.parent.createElement;\n        findTextBox.appendTo(findTextIp);\n        var replaceTextE = this.parent.createElement('div', { className: 'e-cont' });\n        var replaceTextH = this.parent.createElement('p', { className: 'e-header', innerHTML: l10n.getConstant('ReplaceWith') });\n        var replaceTextIp = this.parent.createElement('input', {\n            className: 'e-input e-text-replaceInp', attrs: { 'type': 'Text', 'placeholder': l10n.getConstant('ReplaceValue') }\n        });\n        replaceTextE.appendChild(replaceTextIp);\n        replaceTextE.insertBefore(replaceTextH, replaceTextIp);\n        findElem.appendChild(replaceTextE);\n        var replaceTextBox = new TextBox({ width: '70%' });\n        replaceTextBox.createElement = this.parent.createElement;\n        replaceTextBox.appendTo(replaceTextIp);\n        var withinData = [\n            { Id: 'Sheet', Within: l10n.getConstant('Sheet') },\n            { Id: 'Workbook', Within: l10n.getConstant('Workbook') }\n        ];\n        var withInDDL = new DropDownList({\n            dataSource: withinData,\n            cssClass: 'e-searchby',\n            fields: { value: 'Id', text: 'Within' }, width: '50%', index: 0\n        });\n        var withIn = this.parent.createElement('input', {\n            className: 'e-findnreplace-searchwithin', attrs: { type: 'select', label: l10n.getConstant('SearchBy') }\n        });\n        var withinTextH = this.parent.createElement('p', { className: 'e-header', innerHTML: l10n.getConstant('SearchWithin') });\n        findElem.appendChild(withinTextH);\n        findElem.appendChild(withIn);\n        withInDDL.createElement = this.parent.createElement;\n        withInDDL.appendTo(withIn);\n        var searchData = [\n            { Id: 'By Row', Search: l10n.getConstant('ByRow') },\n            { Id: 'By Column', Search: l10n.getConstant('ByColumn') }\n        ];\n        var searchDDL = new DropDownList({\n            dataSource: searchData,\n            cssClass: 'e-searchby',\n            fields: { value: 'Id', text: 'Search' }, width: '50%', index: 0\n        });\n        var searchIn = this.parent.createElement('input', {\n            className: 'e-findnreplace-searchby', attrs: { type: 'select', label: l10n.getConstant('SearchBy') }\n        });\n        var searchTextH = this.parent.createElement('p', { className: 'e-header', innerHTML: l10n.getConstant('SearchBy') });\n        findElem.appendChild(searchTextH);\n        findElem.appendChild(searchIn);\n        searchDDL.createElement = this.parent.createElement;\n        searchDDL.appendTo(searchIn);\n        var isCSen = new CheckBox({\n            label: l10n.getConstant('MatchCase'), checked: false,\n            cssClass: 'e-findnreplace-casecheckbox'\n        });\n        var caaseCheckbox = this.parent.createElement('input', {\n            className: 'e-findnreplace-checkcase', attrs: { type: 'checkbox' }\n        });\n        findCheck.appendChild(caaseCheckbox);\n        isCSen.createElement = this.parent.createElement;\n        isCSen.appendTo(caaseCheckbox);\n        var isEMatch = new CheckBox({\n            label: l10n.getConstant('MatchExactCellElements'), checked: false,\n            cssClass: 'e-findnreplace-exactmatchcheckbox',\n        });\n        var entirematchCheckbox = this.parent.createElement('input', {\n            className: 'e-findnreplace-checkmatch', attrs: { type: 'checkbox' }\n        });\n        findCheck.appendChild(entirematchCheckbox);\n        isEMatch.createElement = this.parent.createElement;\n        isEMatch.appendTo(entirematchCheckbox);\n        findElem.appendChild(findCheck);\n        return dialogElem;\n    };\n    FindAndReplace.prototype.GotoContent = function () {\n        var l10n = this.parent.serviceLocator.getService(locale);\n        var dialogElem = this.parent.createElement('div', { className: 'e-link-dialog' });\n        var gotoElem = this.parent.createElement('div', { className: 'e-goto' });\n        dialogElem.appendChild(gotoElem);\n        var gotoTextE = this.parent.createElement('div', { className: 'e-cont' });\n        var gotoTextH = this.parent.createElement('p', { className: 'e-header', innerHTML: l10n.getConstant('Reference') });\n        var gotoTextBox = new TextBox({\n            placeholder: l10n.getConstant('EntercellAddress')\n        });\n        var gotoTextIp = this.parent.createElement('input', { className: 'e-text-goto', attrs: { 'type': 'Text' } });\n        gotoTextE.appendChild(gotoTextIp);\n        gotoTextE.insertBefore(gotoTextH, gotoTextIp);\n        gotoElem.appendChild(gotoTextE);\n        gotoTextBox.createElement = this.parent.createElement;\n        gotoTextBox.appendTo(gotoTextIp);\n        return dialogElem;\n    };\n    /**\n     * To destroy the find-and-replace module.\n     * @return {void}\n     */\n    FindAndReplace.prototype.destroy = function () {\n        this.removeEventListener();\n        this.parent = null;\n    };\n    /**\n     * Gets the module name.\n     * @returns string\n     */\n    FindAndReplace.prototype.getModuleName = function () {\n        return 'findAndReplace';\n    };\n    return FindAndReplace;\n}());\nexport { FindAndReplace };\n","import { applyMerge, activeCellMergedRange } from '../../workbook/common/index';\nimport { hiddenMerge, dialog, locale } from '../common/index';\nimport { checkPrevMerge, checkMerge } from '../common/index';\nimport { getCell, isHiddenCol, isHiddenRow } from '../../workbook/index';\n/**\n * The `Merge` module is used to to merge the range of cells.\n */\nvar Merge = /** @class */ (function () {\n    /**\n     * Constructor for the Spreadsheet merge module.\n     * @private\n     */\n    function Merge(parent) {\n        this.parent = parent;\n        this.addEventListener();\n    }\n    Merge.prototype.merge = function (args) {\n        var _this = this;\n        if (args.showDialog) {\n            this.parent.serviceLocator.getService(dialog).show({\n                target: this.parent.element,\n                height: 180, width: 400, isModal: true, showCloseIcon: true,\n                content: this.parent.serviceLocator.getService(locale).getConstant('PasteMergeAlert'),\n                beforeOpen: function (args) {\n                    var dlgArgs = {\n                        dialogName: 'MergeDialog',\n                        element: args.element, target: args.target, cancel: args.cancel\n                    };\n                    _this.parent.trigger('dialogBeforeOpen', dlgArgs);\n                    if (dlgArgs.cancel) {\n                        args.cancel = true;\n                    }\n                    _this.parent.element.focus();\n                },\n            });\n            return;\n        }\n        this.parent.serviceLocator.getService('cell').refresh(args.rowIdx, args.colIdx, args.lastCell, args.element);\n    };\n    Merge.prototype.hideHandler = function (args) {\n        var sheet = this.parent.getActiveSheet();\n        var mergeArgs = { range: [args.rowIdx, args.colIdx, args.rowIdx, args.colIdx] };\n        this.parent.notify(activeCellMergedRange, mergeArgs);\n        mergeArgs.range = mergeArgs.range;\n        var endIdx;\n        var cell = getCell(mergeArgs.range[0], mergeArgs.range[1], sheet) || {};\n        var startIdx = args.model === 'row' ? mergeArgs.range[0] : mergeArgs.range[1];\n        endIdx = startIdx + ((cell[args.model + \"Span\"] || 1) - 1);\n        if ((!args.isEnd && (args.start === startIdx || isHiddenCol(sheet, startIdx))) || (args.isEnd && (args.start > startIdx &&\n            !isHiddenCol(sheet, startIdx)))) {\n            return;\n        }\n        if (cell[args.model + \"Span\"] > 1 && endIdx >= args.start) {\n            if (args.model === 'row' ? isHiddenRow(sheet, startIdx) : isHiddenCol(sheet, startIdx)) {\n                if (args.end < endIdx && (endIdx - args.end > 1 || cell.rowSpan > 1)) {\n                    var cellEle = this.parent.getCell(args.rowIdx, args.end + 1);\n                    if (cellEle) {\n                        if (endIdx - args.end > 1) {\n                            cellEle.colSpan = endIdx - args.end;\n                        }\n                        cellEle.style.display = '';\n                    }\n                    if (cell.rowSpan > 1) {\n                        var rowSpan = cell.rowSpan - this.parent.hiddenCount(args.rowIdx, args.rowIdx + (cell.rowSpan - 1));\n                        if (rowSpan > 1) {\n                            cellEle.rowSpan = rowSpan;\n                        }\n                    }\n                }\n            }\n            else {\n                this.merge({ rowIdx: mergeArgs.range[0], colIdx: mergeArgs.range[1] });\n            }\n        }\n    };\n    Merge.prototype.checkPrevMerge = function (args) {\n        var cell;\n        var sheet = this.parent.getActiveSheet();\n        var mergeArgs;\n        var mergeCount;\n        if (args.isRow) {\n            if (args.rowIdx - 1 > -1 && isHiddenRow(sheet, args.rowIdx - 1)) {\n                cell = getCell(args.rowIdx - 1, args.colIdx, sheet) || {};\n                if ((cell.rowSpan !== undefined || cell.colSpan !== undefined) && (cell.colSpan === undefined || cell.colSpan > 1 ||\n                    (args.colIdx - 1 > -1 && isHiddenCol(sheet, args.colIdx - 1)))) {\n                    mergeArgs = { range: [args.rowIdx - 1, args.colIdx, args.rowIdx - 1, args.colIdx] };\n                    this.parent.notify(activeCellMergedRange, mergeArgs);\n                    mergeArgs.range = mergeArgs.range;\n                    if (isHiddenRow(sheet, mergeArgs.range[0]) && mergeArgs.range[2] >= args.rowIdx) {\n                        cell = getCell(mergeArgs.range[0], mergeArgs.range[1], sheet) || {};\n                        if (cell.rowSpan > 1) {\n                            mergeCount = (mergeArgs.range[2] - args.rowIdx) + 1 - this.parent.hiddenCount(args.rowIdx, args.rowIdx + (mergeArgs.range[2] - args.rowIdx));\n                            if (mergeCount > 1) {\n                                args.td.rowSpan = mergeCount;\n                                args.td.style.display = '';\n                            }\n                            if (cell.colSpan > 1 && !(args.colIdx - 1 > -1 && isHiddenCol(sheet, args.colIdx - 1))) {\n                                mergeCount = cell.colSpan - this.parent.hiddenCount(args.colIdx, args.colIdx + (cell.colSpan - 1), 'columns');\n                                if (mergeCount > 1) {\n                                    args.td.colSpan = mergeCount;\n                                    args.td.style.display = '';\n                                }\n                            }\n                        }\n                    }\n                }\n            }\n            return;\n        }\n        if (args.colIdx - 1 > -1 && isHiddenCol(sheet, args.colIdx - 1)) {\n            cell = getCell(args.rowIdx, args.colIdx - 1, sheet) || {};\n            if ((cell.colSpan !== undefined || cell.rowSpan !== undefined) && (cell.rowSpan === undefined || cell.rowSpan > 1 ||\n                (args.rowIdx - 1 > -1 && isHiddenRow(sheet, args.rowIdx - 1)))) {\n                mergeArgs = { range: [args.rowIdx, args.colIdx - 1, args.rowIdx, args.colIdx - 1] };\n                this.parent.notify(activeCellMergedRange, mergeArgs);\n                mergeArgs.range = mergeArgs.range;\n                if (isHiddenCol(sheet, mergeArgs.range[1]) && mergeArgs.range[3] >= args.colIdx) {\n                    cell = getCell(mergeArgs.range[0], mergeArgs.range[1], sheet) || {};\n                    if (cell.colSpan > 1) {\n                        mergeCount = (mergeArgs.range[3] - args.colIdx) + 1 - this.parent.hiddenCount(args.colIdx, args.colIdx + (cell.colSpan - 1), 'columns');\n                        if (mergeCount > 1) {\n                            args.td.colSpan = mergeCount;\n                            args.td.style.display = '';\n                        }\n                        if (cell.rowSpan > 1 && !(args.rowIdx - 1 > -1 && isHiddenRow(sheet, args.rowIdx - 1))) {\n                            mergeCount = cell.rowSpan - this.parent.hiddenCount(args.rowIdx, args.rowIdx + (cell.rowSpan - 1));\n                            if (mergeCount > 1) {\n                                args.td.rowSpan = mergeCount;\n                                args.td.style.display = '';\n                            }\n                        }\n                    }\n                }\n            }\n        }\n    };\n    Merge.prototype.checkMerge = function (args) {\n        var sheet = this.parent.getActiveSheet();\n        var cell = getCell(args.rowIdx, args.colIdx, sheet) || {};\n        if (args.isRow) {\n            if (cell.colSpan === undefined || isHiddenCol(sheet, args.colIdx - 1)) {\n                var mergeArgs = { range: [args.rowIdx, args.colIdx, args.rowIdx, args.colIdx] };\n                mergeArgs.range = mergeArgs.range;\n                this.parent.notify(activeCellMergedRange, mergeArgs);\n                if (isHiddenCol(sheet, args.colIdx - 1) && !isHiddenCol(sheet, mergeArgs.range[1])) {\n                    return;\n                }\n                cell = getCell(mergeArgs.range[0], mergeArgs.range[1], sheet);\n                var mergeCount = (mergeArgs.range[2] - args.rowIdx) + 1 - this.parent.hiddenCount(args.rowIdx, mergeArgs.range[2]);\n                if (mergeCount > 1) {\n                    this.merge({ rowIdx: mergeArgs.range[0], colIdx: mergeArgs.range[1], element: args.td });\n                    args.td.rowSpan = mergeCount;\n                    args.td.style.display = '';\n                }\n            }\n        }\n        else {\n            if (cell.rowSpan === undefined || isHiddenRow(sheet, args.rowIdx - 1)) {\n                var mergeArgs = { range: [args.rowIdx, args.colIdx, args.rowIdx, args.colIdx] };\n                mergeArgs.range = mergeArgs.range;\n                this.parent.notify(activeCellMergedRange, mergeArgs);\n                if (isHiddenRow(sheet, args.rowIdx - 1) && !isHiddenRow(sheet, mergeArgs.range[0])) {\n                    return;\n                }\n                cell = getCell(mergeArgs.range[0], mergeArgs.range[1], sheet);\n                var mergeCount = (mergeArgs.range[3] - args.colIdx) + 1 - this.parent.hiddenCount(args.colIdx, mergeArgs.range[3], 'columns');\n                if (mergeCount > 1) {\n                    this.merge({ rowIdx: mergeArgs.range[0], colIdx: mergeArgs.range[1], element: args.td });\n                    args.td.colSpan = mergeCount;\n                    args.td.style.display = '';\n                }\n            }\n        }\n    };\n    Merge.prototype.addEventListener = function () {\n        this.parent.on(applyMerge, this.merge, this);\n        this.parent.on(hiddenMerge, this.hideHandler, this);\n        this.parent.on(checkPrevMerge, this.checkPrevMerge, this);\n        this.parent.on(checkMerge, this.checkMerge, this);\n    };\n    /**\n     * Destroy merge module.\n     */\n    Merge.prototype.destroy = function () {\n        this.removeEventListener();\n        this.parent = null;\n    };\n    Merge.prototype.removeEventListener = function () {\n        if (!this.parent.isDestroyed) {\n            this.parent.off(applyMerge, this.merge);\n            this.parent.off(hiddenMerge, this.hideHandler);\n            this.parent.off(checkPrevMerge, this.checkPrevMerge);\n            this.parent.off(checkMerge, this.checkMerge);\n        }\n    };\n    /**\n     * Get the merge module name.\n     */\n    Merge.prototype.getModuleName = function () {\n        return 'merge';\n    };\n    return Merge;\n}());\nexport { Merge };\n","import { checkConditionalFormat, initiateConditionalFormat, locale, dialog, setCF } from '../common/index';\nimport { beginAction, completeAction } from '../common/index';\nimport { getCell, setRow, setCell } from '../../workbook/base/index';\nimport { getRangeIndexes, checkDateFormat, cFInitialCheck, isNumber, cFRender, cFDelete } from '../../workbook/common/index';\nimport { isDateTime, dateToInt, applyCellFormat, clearCF } from '../../workbook/common/index';\nimport { setCFRule, clearCells } from '../../workbook/common/index';\nimport { isNullOrUndefined } from '@syncfusion/ej2-base';\nimport { DropDownList } from '@syncfusion/ej2-dropdowns';\nimport { NumericTextBox } from '@syncfusion/ej2-inputs';\n/**\n * Represents Conditional Formatting support for Spreadsheet.\n */\nvar ConditionalFormatting = /** @class */ (function () {\n    /**\n     * Constructor for the Spreadsheet Conditional Formatting module.\n     */\n    function ConditionalFormatting(parent) {\n        this.parent = parent;\n        this.addEventListener();\n    }\n    /**\n     * To destroy the Conditional Formatting module.\n     * @return {void}\n     */\n    ConditionalFormatting.prototype.destroy = function () {\n        this.removeEventListener();\n    };\n    ConditionalFormatting.prototype.addEventListener = function () {\n        this.parent.on(cFRender, this.cFInitialRender, this);\n        this.parent.on(cFInitialCheck, this.cFInitialCheckHandler, this);\n        this.parent.on(checkConditionalFormat, this.checkConditionalFormatHandler, this);\n        this.parent.on(initiateConditionalFormat, this.initiateCFHandler, this);\n        this.parent.on(setCF, this.setCFHandler, this);\n        this.parent.on(cFDelete, this.cFDeleteHandler, this);\n        this.parent.on(clearCF, this.clearCFHandler, this);\n        this.parent.on(clearCells, this.addClearCFHandler, this);\n    };\n    ConditionalFormatting.prototype.removeEventListener = function () {\n        if (!this.parent.isDestroyed) {\n            this.parent.off(cFRender, this.cFInitialRender);\n            this.parent.off(cFInitialCheck, this.cFInitialCheckHandler);\n            this.parent.off(checkConditionalFormat, this.checkConditionalFormatHandler);\n            this.parent.off(initiateConditionalFormat, this.initiateCFHandler);\n            this.parent.off(setCF, this.setCFHandler);\n            this.parent.off(cFDelete, this.cFDeleteHandler);\n            this.parent.off(clearCF, this.clearCFHandler);\n        }\n    };\n    ConditionalFormatting.prototype.setCF = function (conditionalFormat) {\n        conditionalFormat.range = conditionalFormat.range || this.parent.getActiveSheet().selectedRange;\n        var eventArgs = {\n            range: conditionalFormat.range, type: conditionalFormat.type, cFColor: conditionalFormat.cFColor,\n            value: conditionalFormat.value, cancel: false\n        };\n        this.parent.notify(beginAction, { eventArgs: eventArgs, action: 'conditionalFormat' });\n        if (!eventArgs.cancel) {\n            conditionalFormat.type = eventArgs.type;\n            conditionalFormat.cFColor = eventArgs.cFColor;\n            conditionalFormat.value = eventArgs.value;\n            conditionalFormat.range = eventArgs.range;\n            this.parent.notify(setCFRule, { conditionalFormat: conditionalFormat });\n            delete eventArgs.cancel;\n            this.parent.notify(completeAction, { eventArgs: eventArgs, action: 'conditionalFormat' });\n        }\n    };\n    ConditionalFormatting.prototype.addClearCFHandler = function (args) {\n        var sheet = this.parent.getActiveSheet();\n        var clearCFormats = args.conditionalFormats;\n        var oldRange = args.oldRange;\n        var selectedRange = args.selectedRange;\n        var conditionalFormats = sheet.conditionalFormats;\n        for (var cCFIdx = 0; cCFIdx < clearCFormats.length; cCFIdx++) {\n            var isApply = false;\n            for (var cFIdx = 0; cFIdx < conditionalFormats.length; cFIdx++) {\n                if (conditionalFormats[cFIdx].type === clearCFormats[cCFIdx].type &&\n                    conditionalFormats[cFIdx].range === clearCFormats[cCFIdx].range) {\n                    isApply = true;\n                    conditionalFormats[cFIdx].range = oldRange[cCFIdx];\n                    sheet.conditionalFormats[cFIdx].range = oldRange[cCFIdx];\n                    var sRangeIdx = getRangeIndexes(selectedRange);\n                    var cFRanges = oldRange[cCFIdx].split(',');\n                    for (var cFRangeIdx = 0; cFRangeIdx < cFRanges.length; cFRangeIdx++) {\n                        var newRangeIdxs = getRangeIndexes(cFRanges[cFRangeIdx]);\n                        for (var cFRowIdx = newRangeIdxs[0]; cFRowIdx <= newRangeIdxs[2]; cFRowIdx++) {\n                            for (var cFColIdx = newRangeIdxs[1]; cFColIdx <= newRangeIdxs[3]; cFColIdx++) {\n                                for (var sRRowIdx = sRangeIdx[0]; sRRowIdx <= sRangeIdx[2]; sRRowIdx++) {\n                                    for (var sRColIdx = sRangeIdx[1]; sRColIdx <= sRangeIdx[3]; sRColIdx++) {\n                                        if (sRRowIdx === cFRowIdx && sRColIdx === cFColIdx) {\n                                            var td = this.parent.getCell(cFRowIdx, cFColIdx);\n                                            var cell = sheet.rows[cFRowIdx] ? sheet.rows[cFRowIdx].cells[cFColIdx] ?\n                                                sheet.rows[cFRowIdx].cells[cFColIdx] : null : null;\n                                            if (cell) {\n                                                this.cFInitialCheckHandler({\n                                                    rowIdx: cFRowIdx, colIdx: cFColIdx,\n                                                    cell: cell, td: td, conditionalFormat: conditionalFormats[cFIdx]\n                                                });\n                                            }\n                                        }\n                                    }\n                                }\n                            }\n                        }\n                    }\n                }\n            }\n            if (!isApply) {\n                var conditionalFormat = clearCFormats[cCFIdx];\n                conditionalFormat.range = oldRange[cCFIdx];\n                this.parent.notify(setCFRule, { conditionalFormat: conditionalFormat });\n            }\n        }\n    };\n    ConditionalFormatting.prototype.cFDeleteHandler = function (args) {\n        var td = this.parent.getCell(args.rowIdx, args.colIdx);\n        if (td) {\n            if (td.querySelector('.e-cf-databar')) {\n                td.removeChild(td.querySelector('.e-cf-databar'));\n            }\n            if (td.querySelector('.e-iconsetspan')) {\n                td.removeChild(td.querySelector('.e-iconsetspan'));\n            }\n        }\n    };\n    ConditionalFormatting.prototype.clearCFHandler = function (args) {\n        var sheet = this.parent.getActiveSheet();\n        var tdEle = this.parent.getCell(args.rIdx, args.cIdx);\n        var cell = getCell(args.rIdx, args.cIdx, sheet);\n        if (!tdEle) {\n            return;\n        }\n        tdEle.classList.remove('e-redft');\n        tdEle.classList.remove('e-yellowft');\n        tdEle.classList.remove('e-greenft');\n        tdEle.classList.remove('e-redf');\n        tdEle.classList.remove('e-redt');\n        tdEle.classList.remove('e-iconset');\n        if (tdEle.style) {\n            if (tdEle.style.backgroundColor) {\n                tdEle.style.backgroundColor = '';\n                var style = this.parent.getCellStyleValue(['backgroundColor'], [args.rIdx, args.cIdx]);\n                this.parent.notify(applyCellFormat, {\n                    style: style, rowIdx: args.rIdx, colIdx: args.cIdx\n                });\n            }\n            if (tdEle.style.color) {\n                tdEle.style.color = '';\n                var style = this.parent.getCellStyleValue(['color'], [args.rIdx, args.cIdx]);\n                this.parent.notify(applyCellFormat, {\n                    style: style, rowIdx: args.rIdx, colIdx: args.cIdx\n                });\n            }\n        }\n        if (tdEle.querySelector('.e-cf-databar')) {\n            tdEle.removeChild(tdEle.querySelector('.e-cf-databar'));\n            tdEle.textContent = this.parent.getDisplayText(cell);\n        }\n        if (tdEle.querySelector('.e-iconsetspan')) {\n            tdEle.removeChild(tdEle.querySelector('.e-iconsetspan'));\n            tdEle.textContent = this.parent.getDisplayText(cell);\n        }\n    };\n    ConditionalFormatting.prototype.setCFHandler = function (args) {\n        if (args.action === 'cf_databars') {\n            this.setCF({ type: args.id });\n        }\n        else if (args.action === 'cf_colorscales') {\n            this.setCF({ type: args.id });\n        }\n        else if (args.action === 'cf_iconsets') {\n            this.setCF({ type: args.id });\n        }\n    };\n    ConditionalFormatting.prototype.initiateCFHandler = function (args) {\n        var _this = this;\n        var l10n = this.parent.serviceLocator.getService(locale);\n        var dialogInst = this.parent.serviceLocator.getService(dialog);\n        dialogInst.show({\n            width: 375, showCloseIcon: true, isModal: true, cssClass: 'e-conditionalformatting-dlg',\n            header: args.action.replace('...', ''),\n            target: document.querySelector('.e-control.e-spreadsheet'),\n            beforeOpen: function () {\n                dialogInst.dialogInstance.content = _this.cFDlgContent(args.action);\n                dialogInst.dialogInstance.dataBind();\n                _this.parent.element.focus();\n            },\n            buttons: [{\n                    buttonModel: {\n                        content: l10n.getConstant('Ok'),\n                        isPrimary: true,\n                        cssClass: 'e-btn e-clearall-btn e-flat'\n                    },\n                    click: function () {\n                        _this.dlgClickHandler(args.action);\n                        dialogInst.hide();\n                    }\n                }]\n        });\n        dialogInst.dialogInstance.refresh();\n    };\n    ConditionalFormatting.prototype.dlgClickHandler = function (action) {\n        var value1 = '';\n        var value2 = '';\n        var dlgCont = this.parent.element.querySelector('.e-conditionalformatting-dlg').\n            getElementsByClassName('e-dlg-content')[0].querySelector('.e-cf-dlg');\n        var mainCont = dlgCont.querySelector('.e-cfmain');\n        if (mainCont) {\n            var inpEle = mainCont.getElementsByTagName('input')[0];\n            if (inpEle && inpEle.parentElement.classList.contains('e-cfmain')) {\n                value1 = mainCont.getElementsByTagName('input')[0].value;\n            }\n            value2 = mainCont.getElementsByTagName('input')[1] ?\n                dlgCont.querySelector('.e-cfmain').getElementsByTagName('input')[1].value : '';\n        }\n        var cFColor = this.getCFColor(dlgCont.querySelector('.e-cfsub').getElementsByTagName('input')[0].value);\n        var cFType = action === 'Duplicate Values...' ?\n            dlgCont.querySelector('.e-cfmain').getElementsByTagName('input')[0].value : this.getType(action);\n        if (value1 !== '' && value2 !== '') {\n            this.setCF({\n                type: cFType,\n                cFColor: cFColor, value: value1 + ',' + value2\n            });\n        }\n        else if (value1 !== '') {\n            this.setCF({\n                type: cFType,\n                cFColor: cFColor, value: value1\n            });\n        }\n        else {\n            this.setCF({\n                type: cFType,\n                cFColor: cFColor, value: value2\n            });\n        }\n    };\n    ConditionalFormatting.prototype.getType = function (action) {\n        var l10n = this.parent.serviceLocator.getService(locale);\n        var result = '';\n        switch (action) {\n            case l10n.getConstant('GreaterThan') + '...':\n                result = 'GreaterThan';\n                break;\n            case l10n.getConstant('LessThan') + '...':\n                result = 'LessThan';\n                break;\n            case l10n.getConstant('Between') + '...':\n                result = 'Between';\n                break;\n            case l10n.getConstant('CFEqualTo') + '...':\n                result = 'EqualTo';\n                break;\n            case l10n.getConstant('TextThatContains') + '...':\n                result = 'ContainsText';\n                break;\n            case l10n.getConstant('ADateOccuring') + '...':\n                result = 'DateOccur';\n                break;\n            case l10n.getConstant('Top10Items') + '...':\n                result = 'Top10Items';\n                break;\n            case l10n.getConstant('Bottom10Items') + '...':\n                result = 'Bottom10Items';\n                break;\n            case l10n.getConstant('Top10') + ' %...':\n                result = 'Top10Percentage';\n                break;\n            case l10n.getConstant('Bottom10') + ' %...':\n                result = 'Bottom10Percentage';\n                break;\n            case l10n.getConstant('AboveAverage') + '...':\n                result = 'AboveAverage';\n                break;\n            case l10n.getConstant('BelowAverage') + '...':\n                result = 'BelowAverage';\n                break;\n        }\n        return result;\n    };\n    ConditionalFormatting.prototype.getCFColor = function (value) {\n        var l10n = this.parent.serviceLocator.getService(locale);\n        var result = 'RedFT';\n        switch (value) {\n            case l10n.getConstant('LightRedFillWithDarkRedText'):\n                result = 'RedFT';\n                break;\n            case l10n.getConstant('YellowFillWithDarkYellowText'):\n                result = 'YellowFT';\n                break;\n            case l10n.getConstant('GreenFillWithDarkGreenText'):\n                result = 'GreenFT';\n                break;\n            case l10n.getConstant('RedFill'):\n                result = 'RedF';\n                break;\n            case l10n.getConstant('RedText'):\n                result = 'RedT';\n                break;\n        }\n        return result;\n    };\n    ConditionalFormatting.prototype.cFDlgContent = function (action) {\n        var dlgText = this.getDlgText(action);\n        var l10n = this.parent.serviceLocator.getService(locale);\n        var dlgContent = this.parent.createElement('div', { className: 'e-cf-dlg' });\n        var mainDiv = this.parent.createElement('div', { className: 'e-cfmain' });\n        var subDiv = this.parent.createElement('div', { className: 'e-cfsub' });\n        var value1Text = this.parent.createElement('span', { className: 'e-header e-top-header', innerHTML: dlgText });\n        var value1Inp = this.parent.createElement('input', { className: 'e-input', id: 'valueInput', attrs: { type: 'text' } });\n        var duplicateSelectEle = this.parent.createElement('input', { className: 'e-select' });\n        var subDivText = this.parent.createElement('span', { className: 'e-header', innerHTML: l10n.getConstant('With') });\n        var colorSelectEle = this.parent.createElement('input', { className: 'e-select' });\n        dlgContent.appendChild(mainDiv);\n        dlgContent.appendChild(subDiv);\n        mainDiv.appendChild(value1Text);\n        if (action !== l10n.getConstant('DuplicateValues') + '...') {\n            if (action !== l10n.getConstant('AboveAverage') + '...' && action !== l10n.getConstant('BelowAverage') + '...') {\n                mainDiv.appendChild(value1Inp);\n                if (action === l10n.getConstant('Top10Items') + '...' || action === l10n.getConstant('Top10') + ' %...' ||\n                    action === l10n.getConstant('Bottom10Items') + '...' || action === l10n.getConstant('Bottom10') + ' %...') {\n                    var numeric = new NumericTextBox({\n                        value: 10\n                    });\n                    numeric.appendTo(value1Inp);\n                }\n            }\n        }\n        else {\n            mainDiv.appendChild(duplicateSelectEle);\n            var dupData = [\n                { text: l10n.getConstant('Duplicate'), id: 'duplicate' },\n                { text: l10n.getConstant('Unique'), id: 'unique' },\n            ];\n            var dupList = new DropDownList({\n                dataSource: dupData,\n                index: 0,\n                popupHeight: '200px'\n            });\n            dupList.appendTo(duplicateSelectEle);\n        }\n        if (action === l10n.getConstant('Between') + '...') {\n            var value2Text = this.parent.createElement('span', { className: 'e-header e-header-2', innerHTML: l10n.getConstant('And') });\n            var value2Inp = this.parent.createElement('input', { className: 'e-input' });\n            mainDiv.appendChild(value2Text);\n            mainDiv.appendChild(value2Inp);\n        }\n        subDiv.appendChild(subDivText);\n        subDiv.appendChild(colorSelectEle);\n        var colorData = [\n            { text: l10n.getConstant('LightRedFillWithDarkRedText'), value: 'redft', id: 'redft' },\n            { text: l10n.getConstant('YellowFillWithDarkYellowText'), id: 'yellowft' },\n            { text: l10n.getConstant('GreenFillWithDarkGreenText'), id: 'greenft' },\n            { text: l10n.getConstant('RedFill'), id: 'redf' },\n            { text: l10n.getConstant('RedText'), id: 'redt' },\n        ];\n        var colorList = new DropDownList({\n            dataSource: colorData,\n            index: 0,\n            popupHeight: '200px'\n        });\n        colorList.appendTo(colorSelectEle);\n        return dlgContent;\n    };\n    ConditionalFormatting.prototype.checkCellHandler = function (rowIdx, colIdx, conditionalFormat) {\n        var isApply = false;\n        var ranges = conditionalFormat.range.trim().split(',');\n        for (var rangeIdx = 0; rangeIdx < ranges.length; rangeIdx++) {\n            var cFrange = ranges[rangeIdx];\n            cFrange = cFrange.indexOf(':') > -1 ? cFrange : cFrange + ':' + cFrange;\n            var indexes = getRangeIndexes(cFrange);\n            if (rowIdx >= indexes[0] && rowIdx <= indexes[2] && colIdx >= indexes[1] && colIdx <= indexes[3]) {\n                isApply = true;\n                break;\n            }\n        }\n        return isApply;\n    };\n    ConditionalFormatting.prototype.getDlgText = function (action) {\n        var l10n = this.parent.serviceLocator.getService(locale);\n        var result = '';\n        switch (action) {\n            case l10n.getConstant('GreaterThan') + '...':\n                result = l10n.getConstant('FormatCellsGreaterThan');\n                break;\n            case l10n.getConstant('LessThan') + '...':\n                result = l10n.getConstant('FormatCellsLessThan');\n                break;\n            case l10n.getConstant('Between') + '...':\n                result = l10n.getConstant('FormatCellsBetween');\n                break;\n            case l10n.getConstant('CFEqualTo') + '...':\n                result = l10n.getConstant('FormatCellsEqualTo');\n                break;\n            case l10n.getConstant('TextThatContains') + '...':\n                result = l10n.getConstant('FormatCellsThatContainTheText');\n                break;\n            case l10n.getConstant('ADateOccuring') + '...':\n                result = l10n.getConstant('FormatCellsThatContainADateOccurring');\n                break;\n            case l10n.getConstant('DuplicateValues') + '...':\n                result = l10n.getConstant('FormatCellsDuplicate');\n                break;\n            case l10n.getConstant('Top10Items') + '...':\n                result = l10n.getConstant('FormatCellsTop');\n                break;\n            case l10n.getConstant('Top10') + ' %...':\n                result = l10n.getConstant('FormatCellsTop');\n                break;\n            case l10n.getConstant('Bottom10Items') + '...':\n                result = l10n.getConstant('FormatCellsBottom');\n                break;\n            case l10n.getConstant('Bottom10') + ' %...':\n                result = l10n.getConstant('FormatCellsBottom');\n                break;\n            case l10n.getConstant('AboveAverage') + '...':\n                result = l10n.getConstant('FormatCellsAbove');\n                break;\n            case l10n.getConstant('BelowAverage') + '...':\n                result = l10n.getConstant('FormatCellsBelow');\n                break;\n        }\n        return result;\n    };\n    ConditionalFormatting.prototype.cFInitialRender = function (args) {\n        var cFRules = this.parent.getActiveSheet().conditionalFormats;\n        if (cFRules) {\n            for (var cFRIdx = 0; cFRIdx < cFRules.length; cFRIdx++) {\n                var isApply = false;\n                isApply = this.checkCellHandler(args.rowIdx, args.colIdx, cFRules[cFRIdx]);\n                if (isApply) {\n                    this.cFInitialCheckHandler({\n                        rowIdx: args.rowIdx, colIdx: args.colIdx,\n                        cell: args.cell, td: args.td, conditionalFormat: cFRules[cFRIdx]\n                    });\n                }\n            }\n        }\n    };\n    ConditionalFormatting.prototype.cFInitialCheckHandler = function (args) {\n        var sheet = this.parent.getActiveSheet();\n        var formatStyle;\n        var isApply = false;\n        var cFColors = ['e-redft', 'e-yellowft', 'e-greenft', 'e-redf', 'e-redt'];\n        var value = args.cell.value || '';\n        var cFRule = args.conditionalFormat;\n        var td = args.td || this.parent.getCell(args.rowIdx, args.colIdx);\n        if (!td) {\n            return;\n        }\n        cFRule.type = cFRule.type || 'GreaterThan';\n        cFRule.cFColor = cFRule.cFColor ? cFRule.cFColor : cFRule.format ? cFRule.cFColor : 'RedFT';\n        isApply = this.cFRCheck(cFRule, value, td, args.rowIdx, args.colIdx, true);\n        if (isApply) {\n            for (var idx = 0; idx < cFColors.length; idx++) {\n                if (td.classList.contains(cFColors[idx])) {\n                    td.classList.remove(cFColors[idx]);\n                    break;\n                }\n            }\n            if (cFRule.format && cFRule.format.style) {\n                formatStyle = cFRule.format.style;\n            }\n            var style = {};\n            if (cFRule.cFColor) {\n                td.classList.add('e-' + cFRule.cFColor.toLowerCase());\n                style = this.setFormat(style, cFRule);\n            }\n            else {\n                style = formatStyle;\n            }\n            if (style.backgroundColor) {\n                td.style.setProperty('background-color', style.backgroundColor);\n            }\n            if (style.color) {\n                td.style.setProperty('color', style.color);\n            }\n            if (style.fontWeight) {\n                td.style.setProperty('font-weight', style.fontWeight);\n            }\n            if (style.fontStyle) {\n                td.style.setProperty('font-style', style.fontStyle);\n            }\n            if (style.textDecoration) {\n                td.style.setProperty('text-decoration', style.textDecoration);\n            }\n        }\n    };\n    ConditionalFormatting.prototype.checkConditionalFormatHandler = function (args) {\n        var indexes;\n        var isApply = false;\n        var result = false;\n        var sheet = this.parent.getActiveSheet();\n        var cell = args.cell;\n        var td;\n        var cFRules = sheet.conditionalFormats;\n        var mainCnt = this.parent.getMainContent();\n        var value = !cell ? '' : !isNullOrUndefined(cell.value) ? cell.value : '';\n        var cFColors = ['e-redft', 'e-yellowft', 'e-greenft', 'e-redf', 'e-redt'];\n        var cFRIdx;\n        td = this.parent.getCell(args.rowIdx, args.colIdx);\n        if (!cFRules || cFRules.length < 1) {\n            return;\n        }\n        for (var cFRuleIdx = 0; cFRuleIdx < cFRules.length; cFRuleIdx++) {\n            var cFRanges = cFRules[cFRuleIdx].range.trim().split(',');\n            for (var rangeIdx = 0; rangeIdx < cFRanges.length; rangeIdx++) {\n                var range = cFRanges[rangeIdx];\n                range = range.indexOf(':') > -1 ? range : range + ':' + range;\n                indexes = getRangeIndexes(range);\n                if (args.rowIdx >= indexes[0] && args.colIdx >= indexes[1] && args.rowIdx <= indexes[2] && args.colIdx <= indexes[3]) {\n                    cFRIdx = cFRuleIdx;\n                    result = true;\n                    break;\n                }\n            }\n            if (result) {\n                if (('GreaterThan' + 'LessThan' + 'EqualTo' + 'Between' + 'ContainsText' +\n                    'DateOccur').includes(sheet.conditionalFormats[cFRuleIdx].type)) {\n                    var cellVal = getCell(args.rowIdx, args.colIdx, sheet) && getCell(args.rowIdx, args.colIdx, sheet).value ?\n                        getCell(args.rowIdx, args.colIdx, sheet).value : '';\n                    if (isNullOrUndefined(cellVal) && cellVal === '') {\n                        isApply = false;\n                    }\n                    else {\n                        isApply = this.cFRCheck(sheet.conditionalFormats[cFRuleIdx], cellVal, td);\n                    }\n                    this.setColor(td, args.rowIdx, args.colIdx, cFRuleIdx, isApply);\n                }\n                else if (('Top10Items' + 'Bottom10Items' + 'Top10%' + 'Bottom10%' + 'AboveAverage' +\n                    'BelowAverage' + 'Duplicate' + 'Unique').includes(sheet.conditionalFormats[cFRuleIdx].type)) {\n                    for (var rangeIdx = 0; rangeIdx < cFRanges.length; rangeIdx++) {\n                        var range = cFRanges[rangeIdx];\n                        range = range.indexOf(':') > -1 ? range : range + ':' + range;\n                        indexes = getRangeIndexes(range);\n                        for (var rIdx = indexes[0]; rIdx <= indexes[2]; rIdx++) {\n                            if (!sheet.rows[rIdx]) {\n                                setRow(sheet, rIdx, {});\n                            }\n                            for (var cIdx = indexes[1]; cIdx <= indexes[3]; cIdx++) {\n                                if (!sheet.rows[rIdx].cells || !sheet.rows[rIdx].cells[cIdx]) {\n                                    setCell(rIdx, cIdx, sheet, {});\n                                }\n                                var cellVal = getCell(rIdx, cIdx, sheet) && getCell(rIdx, cIdx, sheet).value ?\n                                    getCell(rIdx, cIdx, sheet).value : '';\n                                isApply = this.cFRCheck(sheet.conditionalFormats[cFRuleIdx], cellVal, td, rIdx, cIdx, false);\n                                td = this.parent.getCell(rIdx, cIdx);\n                                this.setColor(td, rIdx, cIdx, cFRuleIdx, isApply);\n                            }\n                        }\n                    }\n                }\n                else if (('BlueDataBar' + 'GreenDataBar' + 'RedDataBar' + 'OrangeDataBar' + 'LightBlueDataBar' + 'PurpleColorScale' +\n                    'GYRColorScale' + 'RYGColorScale' + 'GWRColorScale' + 'RWGColorScale' + 'BWRColorScale' + 'RWBColorScale' +\n                    'WRColorScale' + 'RWColorScale' + 'GWColorScale' + 'WGColorScale' + 'GYColorScale' + 'YGColorScale' + 'ThreeArrows' +\n                    'ThreeArrowsGray' + 'FourArrowsGray' + 'FourArrows' + 'FiveArrowsGray' + 'FiveArrows' + 'ThreeTrafficLights1' +\n                    'ThreeTrafficLights2' + 'ThreeSigns' + 'FourTrafficLights' + 'FourRedToBlack' + 'ThreeSymbols' + 'ThreeSymbols2' +\n                    'ThreeFlags' + 'FourRating' + 'FiveQuarters' + 'FiveRating' + 'ThreeTriangles' + 'ThreeStars' + 'FiveBoxes').\n                    includes(sheet.conditionalFormats[cFRuleIdx].type)) {\n                    for (var idx = 0; idx < cFColors.length; idx++) {\n                        if (td.classList.contains(cFColors[idx])) {\n                            td.classList.remove(cFColors[idx]);\n                        }\n                    }\n                    isApply = this.cFRCheck(sheet.conditionalFormats[cFRuleIdx], value, td, args.rowIdx, args.colIdx, false);\n                }\n                result = false;\n            }\n        }\n    };\n    ConditionalFormatting.prototype.setColor = function (td, rIdx, cIdx, cFRuleIdx, isApply) {\n        var sheet = this.parent.getActiveSheet();\n        var cFRules = sheet.conditionalFormats;\n        var cFColors = ['e-redft', 'e-yellowft', 'e-greenft', 'e-redf', 'e-redt'];\n        var isActiveCF = false;\n        if (cFRules[cFRuleIdx].cFColor) {\n            if (td && td.classList.contains('e-' + cFRules[cFRuleIdx].cFColor.toLowerCase())) {\n                isActiveCF = true;\n            }\n        }\n        else if (cFRules[cFRuleIdx].format.style.backgroundColor && td.style.backgroundColor) {\n            var rgb = this.hexToRgb(cFRules[cFRuleIdx].format.style.backgroundColor);\n            if ('rgb(' + rgb.r + ', ' + rgb.g + ', ' + rgb.b + ')' === td.style.backgroundColor) {\n                isActiveCF = true;\n            }\n        }\n        if (isApply) {\n            if (isActiveCF) {\n                for (var idx = 0; idx < cFColors.length; idx++) {\n                    if (td.classList.contains(cFColors[idx])) {\n                        td.classList.remove(cFColors[idx]);\n                        break;\n                    }\n                }\n            }\n            var style = {};\n            if (cFRules[cFRuleIdx].cFColor) {\n                td.classList.add('e-' + cFRules[cFRuleIdx].cFColor.toLowerCase());\n                style = this.setFormat(style, cFRules[cFRuleIdx]);\n            }\n            else {\n                style = cFRules[cFRuleIdx].format.style;\n            }\n            this.parent.notify(applyCellFormat, {\n                style: style, rowIdx: rIdx, colIdx: cIdx,\n                lastCell: true, isHeightCheckNeeded: true, manualUpdate: true\n            });\n        }\n        else {\n            if (isActiveCF) {\n                for (var idx = 0; idx < cFColors.length; idx++) {\n                    if (td.classList.contains(cFColors[idx])) {\n                        td.classList.remove(cFColors[idx]);\n                        break;\n                    }\n                }\n                td.removeAttribute('style');\n            }\n            var cell = getCell(rIdx, cIdx, this.parent.getActiveSheet());\n            var style = cell.style ? cell.style : {};\n            this.parent.notify(applyCellFormat, {\n                style: style, rowIdx: rIdx, colIdx: cIdx\n            });\n        }\n    };\n    ConditionalFormatting.prototype.hexToRgb = function (hex) {\n        var result = /^#?([a-f\\d]{2})([a-f\\d]{2})([a-f\\d]{2})$/i.exec(hex);\n        return result ? {\n            r: parseInt(result[1], 16),\n            g: parseInt(result[2], 16),\n            b: parseInt(result[3], 16)\n        } : null;\n    };\n    // tslint:disable-next-line:max-func-body-length\n    ConditionalFormatting.prototype.cFRCheck = function (cFRule, value, td, rIdx, cIdx, isInitial) {\n        var cFRuleValue1 = '';\n        var cFRuleValue2 = '';\n        var cellValue = value.toString();\n        if (cFRule.value) {\n            var valueArr = cFRule.value.split(',');\n            if (valueArr.length > 1) {\n                if (valueArr[0].split('(').length > 1) {\n                    var valueStr = '';\n                    for (var idx = 0; idx < valueArr.length; idx++) {\n                        valueStr += valueArr[idx] + ',';\n                        if (valueStr.split('(').length === valueStr.split(')').length && cFRuleValue1 === '') {\n                            cFRuleValue1 = valueStr.substring(0, valueStr.length - 1);\n                            valueStr = '';\n                        }\n                    }\n                    cFRuleValue2 = valueStr.substring(0, valueStr.length - 1);\n                }\n                else {\n                    cFRuleValue1 = valueArr[0];\n                    for (var idx = 1; idx < valueArr.length; idx++) {\n                        cFRuleValue2 += idx + 1 === valueArr.length ? valueArr[idx] : valueArr[idx] + ',';\n                    }\n                }\n            }\n            else {\n                cFRuleValue1 = cFRule.value;\n            }\n        }\n        var isApply = false;\n        var type = cFRule.type;\n        if (('BlueDataBar' + 'GreenDataBar' + 'RedDataBar' + 'OrangeDataBar' + 'LightBlueDataBar' + 'PurpleDataBar').includes(type)) {\n            type = 'DataBar';\n        }\n        if (('GYRColorScale' + 'RYGColorScale' + 'GWRColorScale' + 'RWGColorScale' + 'BWRColorScale' + 'RWBColorScale' + 'WRColorScale' +\n            'RWColorScale' + 'GWColorScale' + 'WGColorScale' + 'GYColorScale' + 'YGColorScale').includes(type)) {\n            type = 'ColorScale';\n        }\n        if (('ThreeArrows' + 'ThreeArrowsGray' + 'FourArrowsGray' + 'FourArrows' + 'FiveArrowsGray' +\n            'FiveArrows' + 'ThreeTrafficLights1' + 'ThreeTrafficLights2' + 'ThreeSigns' + 'FourTrafficLights' +\n            'FourRedToBlack' + 'ThreeSymbols' + 'ThreeSymbols2' + 'ThreeFlags' + 'FourRating' + 'FiveQuarters' +\n            'FiveRating' + 'ThreeTriangles' + 'ThreeStars' + 'FiveBoxes').includes(type)) {\n            type = 'IconSet';\n        }\n        switch (type) {\n            case 'GreaterThan':\n                isApply = this.isGreaterThanLessThan(cFRule, cellValue, cFRuleValue1, true);\n                break;\n            case 'LessThan':\n                isApply = this.isGreaterThanLessThan(cFRule, cellValue, cFRuleValue1, false);\n                break;\n            case 'Between':\n                isApply = this.isBetWeen(cFRule, cellValue, cFRuleValue1, cFRuleValue2);\n                break;\n            case 'EqualTo':\n                isApply = this.isEqualTo(cFRule, cellValue, cFRuleValue1);\n                break;\n            case 'ContainsText':\n                isApply = this.isContainsText(cellValue, cFRuleValue1);\n                break;\n            case 'DateOccur':\n                var dateEventArgs = {\n                    value: cFRuleValue1,\n                    rowIndex: 0,\n                    colIndex: 0,\n                    sheetIndex: 0,\n                    updatedVal: ''\n                };\n                this.parent.notify(checkDateFormat, dateEventArgs);\n                if (cellValue === dateEventArgs.updatedVal) {\n                    isApply = true;\n                }\n                break;\n            case 'Unique':\n            case 'Duplicate':\n                isApply = this.isDuplicateUnique(cellValue, cFRule, false);\n                break;\n            case 'Top10Items':\n                isApply = this.isTopBottomTenValue(cellValue, cFRuleValue1, cFRule, true);\n                break;\n            case 'Bottom10Items':\n                isApply = this.isTopBottomTenValue(cellValue, cFRuleValue1, cFRule, false);\n                break;\n            case 'Top10Percentage':\n                isApply = this.isTopBottomTenPercentage(cellValue, cFRuleValue1, cFRule, true);\n                break;\n            case 'Bottom10Percentage':\n                isApply = this.isTopBottomTenPercentage(cellValue, cFRuleValue1, cFRule, false);\n                break;\n            case 'AboveAverage':\n                isApply = this.isAboveBelowAverage(cellValue, cFRuleValue1, cFRule, true);\n                break;\n            case 'BelowAverage':\n                isApply = this.isAboveBelowAverage(cellValue, cFRuleValue1, cFRule, false);\n                break;\n            case 'DataBar':\n                this.isDataBarColorScalesIconSets(type, cellValue, cFRule, td, rIdx, cIdx, isInitial);\n                break;\n            case 'ColorScale':\n                this.isDataBarColorScalesIconSets(type, cellValue, cFRule, td, rIdx, cIdx, isInitial);\n                break;\n            case 'IconSet':\n                this.isDataBarColorScalesIconSets(type, cellValue, cFRule, td, rIdx, cIdx, isInitial);\n                break;\n        }\n        return isApply;\n    };\n    ConditionalFormatting.prototype.isDataBarColorScalesIconSets = function (type, cellValue, cFRule, td, rIdx, cIdx, isInitial) {\n        var sheet = this.parent.getActiveSheet();\n        if (isInitial) {\n            type === 'DataBar' ? this.applyDataBars(cellValue, cFRule, td, rIdx, cIdx) : type === 'ColorScale' ?\n                this.applyColorScale(cellValue, cFRule, td, rIdx, cIdx, isInitial) :\n                this.applyIconSet(cellValue, cFRule, td, rIdx, cIdx, isInitial);\n        }\n        else {\n            td = null;\n            var rangeArr = cFRule.range.split(',');\n            for (var rangeIdx = 0; rangeIdx < rangeArr.length; rangeIdx++) {\n                var selIndexes = getRangeIndexes(rangeArr[rangeIdx]);\n                for (var rIdx_1 = selIndexes[0]; rIdx_1 <= selIndexes[2]; rIdx_1++) {\n                    for (var cIdx_1 = selIndexes[1]; cIdx_1 <= selIndexes[3]; cIdx_1++) {\n                        if (getCell(rIdx_1, cIdx_1, sheet)) {\n                            var cellVal = getCell(rIdx_1, cIdx_1, sheet).value;\n                            td = this.parent.getCell(rIdx_1, cIdx_1);\n                            type === 'DataBar' ? this.applyDataBars(cellVal, cFRule, td, rIdx_1, cIdx_1) :\n                                type === 'ColorScale' ?\n                                    this.applyColorScale(cellVal, cFRule, td, rIdx_1, cIdx_1, isInitial) :\n                                    this.applyIconSet(cellVal, cFRule, td, rIdx_1, cIdx_1, isInitial);\n                        }\n                    }\n                }\n            }\n        }\n    };\n    ConditionalFormatting.prototype.applyIconSet = function (val, cFRule, tdEle, rIdx, cIdx, isInitial) {\n        var value = parseInt(val, 10);\n        var rowIdx;\n        var colIdx;\n        var iconList = this.getIconList(cFRule.type).split(',');\n        var min;\n        var max;\n        var valArr = [];\n        var sheet = this.parent.getActiveSheet();\n        var actCell = sheet.rows[rIdx] && sheet.rows[rIdx].cells[cIdx] ? sheet.rows[rIdx].cells[cIdx] : null;\n        if (!actCell) {\n            return;\n        }\n        var td = tdEle ||\n            this.parent.getMainContent().getElementsByClassName('e-row')[rIdx].getElementsByClassName('e-cell')[cIdx];\n        var rangeArr = cFRule.range.split(',');\n        for (var rIdx_2 = 0; rIdx_2 < rangeArr.length; rIdx_2++) {\n            var selIndexes = getRangeIndexes(rangeArr[rIdx_2]);\n            valArr = this.getNumericArray(selIndexes, valArr);\n        }\n        valArr = valArr.sort(function (n1, n2) { return n1 - n2; });\n        min = valArr[0];\n        max = valArr[valArr.length - 1];\n        var currentSymbol;\n        if (iconList.length === 3) {\n            var maxPercent = min + (0.67 * ((max) - (min)));\n            var minPercent = min + (0.33 * ((max) - (min)));\n            currentSymbol =\n                'e-' + (value >= maxPercent ? iconList[0].trim() : value >= minPercent ? iconList[1].trim() : iconList[2].trim());\n        }\n        else if (iconList.length === 4) {\n            var percent1 = min + (0.25 * ((max) - (min)));\n            var percent2 = min + (0.50 * ((max) - (min)));\n            var percent3 = min + (0.75 * ((max) - (min)));\n            currentSymbol =\n                'e-' + (value >= percent3 ? iconList[0].trim() : value >= percent2 ? iconList[1].trim() : value >= percent1 ?\n                    iconList[2].trim() : iconList[3].trim());\n        }\n        else if (iconList.length === 5) {\n            var percent1 = min + (0.20 * ((max) - (min)));\n            var percent2 = min + (0.40 * ((max) - (min)));\n            var percent3 = min + (0.60 * ((max) - (min)));\n            var percent4 = min + (0.80 * ((max) - (min)));\n            currentSymbol =\n                'e-' + (value >= percent4 ? iconList[0].trim() : value >= percent3 ? iconList[1].trim() : value >= percent2 ?\n                    iconList[2].trim() : value >= percent1 ? iconList[3].trim() : iconList[4].trim());\n        }\n        if (!isNullOrUndefined(actCell)) {\n            var cfIcon = this.parent.createElement('span', { className: 'e-icon' });\n            cfIcon.classList.add('e-iconsetspan');\n            cfIcon.classList.add(currentSymbol);\n            this.applyIconSetIcon({ rowIndex: rIdx, colIndex: cIdx }, cfIcon, td);\n        }\n    };\n    ConditionalFormatting.prototype.applyIconSetIcon = function (activeObj, cfIcon, td) {\n        var sheet = this.parent.getActiveSheet();\n        var rowIdx = activeObj.rowIndex;\n        var colIdx = activeObj.colIndex;\n        var cellVal = getCell(rowIdx, colIdx, sheet).value;\n        var activeEle = td;\n        var sheetIdx = sheet.index;\n        if (activeEle.classList.contains('e-iconset') && activeEle.querySelector('.e-iconsetspan')) {\n            activeEle.removeChild(activeEle.querySelector('.e-iconsetspan'));\n        }\n        if (isNumber(cellVal)) {\n            activeEle.insertBefore(cfIcon, activeEle.childNodes[0]);\n            activeEle.classList.add('e-iconset');\n        }\n    };\n    ConditionalFormatting.prototype.getIconList = function (iconName) {\n        var result = '3arrows-1,3arrows-2,3arrows-3';\n        switch (iconName) {\n            case 'ThreeArrows':\n                return '3arrows-1,3arrows-2,3arrows-3';\n            case 'ThreeArrowsGray':\n                return '3arrowsgray-1,3arrowsgray-2,3arrowsgray-3';\n            case 'FourArrowsGray':\n                return '4arrowsgray-1,4arrowsgray-2,4arrowsgray-3,4arrowsgray-4';\n            case 'FourArrows':\n                return '4arrows-1,4arrows-2,4arrows-3,4arrows-4';\n            case 'FiveArrowsGray':\n                return '5arrowsgray-1,5arrowsgray-2,5arrowsgray-3,5arrowsgray-4,5arrowsgray-5';\n            case 'FiveArrows':\n                return '5arrows-1,5arrows-2,5arrows-3,5arrows-4,5arrows-5';\n            case 'ThreeTrafficLights1':\n                return '3trafficlights-1,3trafficlights-2,3trafficlights-3';\n            case 'ThreeTrafficLights2':\n                return '3rafficlights2-1,3rafficlights2-2,3rafficlights2-3';\n            case 'ThreeSigns':\n                return '3signs-1,3signs-2,3signs-3';\n            case 'FourTrafficLights':\n                return '4trafficlights-1,4trafficlights-2,4trafficlights-3,4trafficlights-4';\n            case 'FourRedToBlack':\n                return '4redtoblack-1,4redtoblack-2,4redtoblack-3,4redtoblack-4';\n            case 'ThreeSymbols':\n                return '3symbols-1,3symbols-2,3symbols-3';\n            case 'ThreeSymbols2':\n                return '3symbols2-1,3symbols2-2,3symbols2-3';\n            case 'ThreeFlags':\n                return '3flags-1,3flags-2,3flags-3';\n            case 'FourRating':\n                return '4rating-1,4rating-2,4rating-3,4rating-4';\n            case 'FiveQuarters':\n                return '5quarters-1,5quarters-2,5quarters-3,5quarters-4,5quarters-5';\n            case 'FiveRating':\n                return '5rating-1,5rating-2,5rating-3,5rating-4,5rating-5';\n            case 'ThreeTriangles':\n                return '3triangles-1,3triangles-2,3triangles-3';\n            case 'ThreeStars':\n                return '3stars-1,3stars-2,3stars-3';\n            case 'FiveBoxes':\n                return '5boxes-1,5boxes-2,5boxes-3,5boxes-4,5boxes-5';\n        }\n        return result;\n    };\n    ConditionalFormatting.prototype.applyColorScale = function (val, cFRule, tdEle, rIdx, cIdx, isInitial) {\n        var sheet = this.parent.getActiveSheet();\n        var value = parseInt(val, 10);\n        var rowIdx;\n        var colIdx;\n        var id;\n        var valArr = [];\n        var colors = this.getColor(cFRule.type);\n        var actCell = sheet.rows[rIdx] && sheet.rows[rIdx].cells[cIdx] ? sheet.rows[rIdx].cells[cIdx] : null;\n        if (!actCell) {\n            return;\n        }\n        var rangeArr = cFRule.range.split(',');\n        var td = tdEle ||\n            this.parent.getMainContent().getElementsByClassName('e-row')[rIdx].getElementsByClassName('e-cell')[cIdx];\n        for (var rIdx_3 = 0; rIdx_3 < rangeArr.length; rIdx_3++) {\n            var selIndexes = getRangeIndexes(rangeArr[rIdx_3]);\n            valArr = this.getNumericArray(selIndexes, valArr);\n        }\n        valArr = valArr.sort(function (n1, n2) { return n1 - n2; }).reverse();\n        for (var i = 0; i < valArr.length; i++) {\n            if (valArr[i] === value) {\n                id = i;\n                break;\n            }\n        }\n        var hexcode = (id === 0) ? colors[0] : (id === valArr.length - 1) ? colors[colors.length - 1] :\n            (valArr.length === 3 && id === 1) ? colors[1] : this.getGradient(id, colors[0], colors[1], colors[2], valArr.length);\n        if (!isNullOrUndefined(actCell)) {\n            var style = {};\n            if (!isNullOrUndefined(id)) {\n                style = { backgroundColor: hexcode };\n                td.style.backgroundColor = hexcode;\n            }\n            else {\n                style = this.parent.getCellStyleValue(['backgroundColor'], [rIdx, cIdx]);\n                td.style.backgroundColor = style.backgroundColor;\n            }\n        }\n    };\n    // tslint:disable-next-line:max-func-body-length\n    ConditionalFormatting.prototype.applyDataBars = function (val, cFRule, tdEle, rIdx, cIdx) {\n        var value;\n        var rowIdx;\n        var colIdx;\n        var sheet = this.parent.getActiveSheet();\n        var left = {};\n        var right = {};\n        var posColor = '';\n        var negColor = '';\n        var cFColor = cFRule.type;\n        var actCell = sheet.rows[rIdx] && sheet.rows[rIdx].cells[cIdx] ? sheet.rows[rIdx].cells[cIdx] : null;\n        if (!actCell) {\n            return;\n        }\n        var valArr = [];\n        var row = this.parent.getMainContent().getElementsByClassName('e-row')[rIdx];\n        var td = tdEle ||\n            this.parent.getMainContent().getElementsByClassName('e-row')[rIdx].getElementsByClassName('e-cell')[cIdx];\n        var rowHeight = !row ? 20 : row.style ? parseInt(row.style.height, 10) : 20;\n        var posArr = [];\n        var negArr = [];\n        var topVal;\n        var leftStandardWidth = 0;\n        value = parseInt(val, 10);\n        var rangeArr = cFRule.range.split(',');\n        for (var rIdx_4 = 0; rIdx_4 < rangeArr.length; rIdx_4++) {\n            var selIndexes = getRangeIndexes(rangeArr[rIdx_4]);\n            valArr = this.getNumericArray(selIndexes, valArr);\n        }\n        for (var idx = 0; idx < valArr.length; idx++) {\n            valArr[idx] > 0 ? posArr.push(valArr[idx]) : negArr.push(valArr[idx]);\n        }\n        cFColor = cFColor === 'BlueDataBar' ? 'B' : cFColor === 'GreenDataBar' ? 'G' : cFColor === 'RedDataBar' ? 'R' :\n            cFColor === 'OrangeDataBar' ? 'O' : cFColor === 'LightBlueDataBar' ? 'LB' : cFColor === 'PurpleDataBar' ? 'P' : '';\n        posColor = this.getColor(cFColor)[0];\n        negColor = this.getColor('R')[0];\n        posArr = posArr.sort(function (n1, n2) { return n1 - n2; }).reverse();\n        negArr = negArr.sort(function (n1, n2) { return n1 - n2; });\n        if (negArr.length && posArr.length) {\n            topVal = posArr[0] + Math.abs(negArr[0]);\n            leftStandardWidth = (Math.abs((negArr[0] / topVal) * 100));\n        }\n        else if (negArr.length || posArr.length) {\n            topVal = negArr.length ? negArr[0] : posArr[0];\n        }\n        else {\n            return;\n        }\n        if (td) {\n            if (isNullOrUndefined(value) || val === '') {\n                if (td.getElementsByClassName('e-cf-databar')[0]) {\n                    td.removeChild(td.getElementsByClassName('e-cf-databar')[0]);\n                }\n            }\n        }\n        if (isNumber(value)) {\n            var databar = this.parent.createElement('div', { id: 'spreadsheet-databar', className: 'e-cf-databar' });\n            var leftSpan = this.parent.createElement('span', { id: 'spreadsheet-leftspan', className: 'e-databar' });\n            var rightSpan = this.parent.createElement('span', { id: 'spreadsheet-rightspan', className: 'e-databar' });\n            var dataSpan = this.parent.createElement('span', { id: 'spreadsheet-dataspan', className: 'e-databar-value' });\n            var iconSetSpan = void 0;\n            left = leftSpan.style;\n            right = rightSpan.style;\n            databar.appendChild(dataSpan);\n            databar.insertBefore(rightSpan, dataSpan);\n            databar.insertBefore(leftSpan, rightSpan);\n            if (td.querySelector('.e-iconsetspan')) {\n                iconSetSpan = td.querySelector('.e-iconsetspan');\n            }\n            td.textContent = '';\n            td.appendChild(databar);\n            if (iconSetSpan) {\n                td.insertBefore(iconSetSpan, td.firstElementChild);\n            }\n            dataSpan.innerHTML = this.parent.getDisplayText(actCell);\n            databar.style.height = rowHeight - 1 + 'px';\n            dataSpan.style.fontSize = '11pt';\n            if (!negArr.length) {\n                right.width = '' + Math.ceil(Math.abs((value / topVal) * 100)) + '%';\n                right.height = rowHeight - 3 + 'px';\n                right.backgroundColor = cFColor = posColor;\n                right.left = '0px';\n            }\n            else if (!posArr.length) {\n                right.width = '' + Math.ceil(Math.abs((value / topVal) * 100)) + '%';\n                right.height = rowHeight - 3 + 'px';\n                right.backgroundColor = cFColor = negColor;\n                right.left = '0px';\n            }\n            else {\n                if (value > -1) {\n                    left.width = leftStandardWidth + '%';\n                    left.height = rowHeight - 3 + 'px'; // -3 buffer of data bar.\n                    left.backgroundColor = 'transparent';\n                    left.left = '0px';\n                    right.width = '' + Math.ceil(Math.abs((value / topVal) * 100)) + '%';\n                    right.height = rowHeight - 3 + 'px';\n                    right.backgroundColor = cFColor = posColor;\n                    right.left = leftStandardWidth + '%';\n                }\n                else if (value < 0) {\n                    left.width = '' + Math.ceil(Math.abs((value / topVal) * 100)) + '%';\n                    left.height = rowHeight - 3 + 'px';\n                    left.backgroundColor = negColor;\n                    if (left.width === leftStandardWidth + '%') {\n                        left.left = '0px';\n                    }\n                    else {\n                        left.right = (100 - leftStandardWidth) + '%';\n                    }\n                }\n            }\n        }\n    };\n    ConditionalFormatting.prototype.getNumericArray = function (selIndexes, valArr) {\n        var sheet = this.parent.getActiveSheet();\n        for (var rIdx = selIndexes[0]; rIdx <= selIndexes[2]; rIdx++) {\n            for (var cIdx = selIndexes[1]; cIdx <= selIndexes[3]; cIdx++) {\n                var cellVal = getCell(rIdx, cIdx, sheet) && getCell(rIdx, cIdx, sheet).value ? getCell(rIdx, cIdx, sheet).value : '';\n                if (!isNullOrUndefined(cellVal) && !isNumber(cellVal) && !isDateTime(cellVal)) {\n                    continue;\n                }\n                else {\n                    var cellValue = parseInt(cellVal, 10);\n                    if (!isNullOrUndefined(cellVal) && cellVal !== '') {\n                        valArr.push(cellValue);\n                    }\n                }\n            }\n        }\n        return valArr;\n    };\n    ConditionalFormatting.prototype.getColor = function (cfColor) {\n        if (cfColor === 'LB') {\n            return ['#008aef'];\n        }\n        var colorCodeArr = cfColor.split('');\n        var colorArr = [];\n        for (var i = 0; i < colorCodeArr.length; i++) {\n            switch (colorCodeArr[i]) {\n                case 'G':\n                    colorArr.push('#63be7b');\n                    break;\n                case 'Y':\n                    colorArr.push('#ffeb84');\n                    break;\n                case 'R':\n                    colorArr.push('#f8696b');\n                    break;\n                case 'W':\n                    colorArr.push('#ffffff');\n                    break;\n                case 'B':\n                    colorArr.push('#5a8ac6');\n                    break;\n                case 'O':\n                    colorArr.push('#ffb628');\n                    break;\n                case 'LB':\n                    colorArr.push('#008aef');\n                    break;\n                case 'P':\n                    colorArr.push('#d6007b');\n                    break;\n            }\n        }\n        return colorArr;\n    };\n    ConditionalFormatting.prototype.getGradient = function (t, start, middle, end, large) {\n        if (isNullOrUndefined(end)) {\n            return this.getLinear(start, middle, t / large);\n        }\n        else {\n            var center = large / 2;\n            return t >= center ? this.getLinear(middle, end, Math.abs((t - center) / center)) : this.getLinear(start, middle, t / center);\n        }\n    };\n    ConditionalFormatting.prototype.getLinear = function (s, e, x) {\n        var r = this.byteLinear(s[1] + s[2], e[1] + e[2], x);\n        var g = this.byteLinear(s[3] + s[4], e[3] + e[4], x);\n        var b = this.byteLinear(s[5] + s[6], e[5] + e[6], x);\n        return '#' + r + g + b;\n    };\n    ConditionalFormatting.prototype.byteLinear = function (a, b, x) {\n        var y = (parseInt(a, 16) * (1 - x) + parseInt(b, 16) * x) | 0;\n        return Math.abs(y).toString(16);\n    };\n    ConditionalFormatting.prototype.isGreaterThanLessThan = function (cFRule, value, input, isGrearThan) {\n        var numRegx = new RegExp(/[^.0-9]+/g);\n        var txtRegx = new RegExp(/[^.-a-zA-Z 0-9]+/g);\n        var isApply = false;\n        if (isNumber(value)) {\n            if (isNumber(input)) {\n                isApply = isGrearThan ? parseFloat(value) > parseFloat(input.replace(txtRegx, '')) :\n                    parseFloat(value) < parseFloat(input.replace(txtRegx, ''));\n            }\n            else {\n                var dateEventArgs = {\n                    value: input,\n                    rowIndex: 0,\n                    colIndex: 0,\n                    sheetIndex: 0,\n                    isDate: false,\n                    updatedVal: '',\n                    isTime: false\n                };\n                this.parent.notify(checkDateFormat, dateEventArgs);\n                if (dateEventArgs.isDate || dateEventArgs.isTime) {\n                    isApply = isGrearThan ? value > dateEventArgs.updatedVal : value < dateEventArgs.updatedVal;\n                    cFRule.value = dateEventArgs.updatedVal.toString();\n                }\n                else {\n                    isApply = isGrearThan ? value.toLowerCase() > input.toLowerCase() : value.toLowerCase() < input.toLowerCase();\n                }\n            }\n        }\n        else if (value === '' && !isGrearThan) {\n            isApply = true;\n        }\n        return isApply;\n    };\n    ConditionalFormatting.prototype.isBetWeen = function (cFRule, value, input1, input2) {\n        var numRegx = new RegExp(/[^.0-9]+/g);\n        var txtRegx = new RegExp(/[^.-a-zA-Z 0-9]+/g);\n        var isApply = false;\n        input1 = input1.replace(txtRegx, '');\n        input2 = input2.replace(txtRegx, '');\n        if (isNumber(value)) {\n            if (isNumber(input1)) {\n                isApply = parseFloat(value) >= parseFloat(input1) && parseFloat(value) <= parseFloat(input2);\n            }\n            else {\n                if (input1 && input2) {\n                    var dateEventArgs1 = {\n                        value: input1,\n                        rowIndex: 0,\n                        colIndex: 0,\n                        sheetIndex: 0,\n                        isDate: false,\n                        updatedVal: '',\n                        isTime: false\n                    };\n                    var dateEventArgs2 = {\n                        value: input2,\n                        rowIndex: 0,\n                        colIndex: 0,\n                        sheetIndex: 0,\n                        isDate: false,\n                        updatedVal: '',\n                        isTime: false\n                    };\n                    this.parent.notify(checkDateFormat, dateEventArgs1);\n                    this.parent.notify(checkDateFormat, dateEventArgs2);\n                    if ((dateEventArgs1.isDate || dateEventArgs1.isTime) && (dateEventArgs2.isDate || dateEventArgs2.isTime)) {\n                        isApply = value >= dateEventArgs1.updatedVal && value <= dateEventArgs2.updatedVal;\n                        cFRule.value = dateEventArgs1.updatedVal.toString() + ',' + dateEventArgs2.updatedVal.toString();\n                    }\n                    else {\n                        isApply = value.toLowerCase() >= input1.toLowerCase() && value.toLowerCase() <= input2.toLowerCase();\n                    }\n                }\n            }\n        }\n        return isApply;\n    };\n    ConditionalFormatting.prototype.isEqualTo = function (cFRule, value, input) {\n        var numRegx = new RegExp(/[^.0-9]+/g);\n        var txtRegx = new RegExp(/[^.-a-zA-Z 0-9]+/g);\n        var isApply = false;\n        if (isNumber(value)) {\n            if (isNumber(input)) {\n                isApply = parseFloat(value) === parseFloat(input.replace(txtRegx, ''));\n            }\n            else {\n                var dateTimeArgs = {\n                    value: input,\n                    rowIndex: 0,\n                    colIndex: 0,\n                    sheetIndex: 0,\n                    isDate: false,\n                    updatedVal: '',\n                    isTime: false\n                };\n                this.parent.notify(checkDateFormat, dateTimeArgs);\n                if (dateTimeArgs.isTime || dateTimeArgs.isDate) {\n                    isApply = value === dateTimeArgs.updatedVal;\n                    cFRule.value = dateTimeArgs.updatedVal.toString();\n                }\n                else {\n                    isApply = value.toLowerCase() === input.toLowerCase();\n                }\n            }\n        }\n        return isApply;\n    };\n    ConditionalFormatting.prototype.isContainsText = function (value, input) {\n        var numRegx = new RegExp(/[^.0-9]+/g);\n        var txtRegx = new RegExp(/[^.-a-zA-Z 0-9]+/g);\n        var isApply = false;\n        if (isNullOrUndefined(value) || !value.length) {\n            isApply = false;\n        }\n        else if (isNumber(input.replace(txtRegx, ''))) {\n            input = input.replace(txtRegx, '');\n            if (isDateTime(value)) {\n                value = ((dateToInt(value))).toString();\n            }\n            isApply = value.indexOf(input) > -1;\n        }\n        else if (isDateTime(input)) {\n            if (isDateTime(value)) {\n                value = dateToInt(value).toString();\n            }\n            isApply = value.indexOf(dateToInt(input).toString()) > -1;\n        }\n        else {\n            isApply = value.toLowerCase().indexOf(input.toLowerCase()) > -1;\n        }\n        return isApply;\n    };\n    ConditionalFormatting.prototype.isTopBottomTenValue = function (cellValue, inp, cFRule, isTop) {\n        var sheet = this.parent.getActiveSheet();\n        var numRegx = new RegExp(/[^.0-9]+/g);\n        var txtRegx = new RegExp(/[^.-a-zA-Z 0-9]+/g);\n        var value = parseInt(cellValue, 10);\n        var input = parseInt(inp, 10);\n        var result = false;\n        if (isNumber(inp)) {\n            if (isNumber(cellValue)) {\n                value = parseFloat(cellValue);\n                input = parseFloat(inp.replace(txtRegx, ''));\n            }\n            else if (isDateTime(cellValue)) {\n                value = dateToInt(cellValue);\n                input = parseFloat(inp);\n            }\n            var dataArray = [];\n            var cellVal = void 0;\n            var rangeArr = cFRule.range.split(',');\n            for (var rangeIdx = 0; rangeIdx < rangeArr.length; rangeIdx++) {\n                var cFRuleIndexes = getRangeIndexes(rangeArr[rangeIdx]);\n                for (var rowIdx = cFRuleIndexes[0]; rowIdx <= cFRuleIndexes[2]; rowIdx++) {\n                    for (var colIdx = cFRuleIndexes[1]; colIdx <= cFRuleIndexes[3]; colIdx++) {\n                        cellVal = getCell(rowIdx, colIdx, sheet) && getCell(rowIdx, colIdx, sheet).value ?\n                            getCell(rowIdx, colIdx, sheet).value : '';\n                        if (cellVal && isNumber(cellVal)) {\n                            cellVal = parseFloat(cellVal);\n                            dataArray.push(cellVal);\n                        }\n                    }\n                }\n            }\n            dataArray =\n                isTop ? dataArray.sort(function (n1, n2) { return n1 - n2; }).reverse() : dataArray.sort(function (n1, n2) { return n1 - n2; });\n            dataArray = dataArray.slice(0, input);\n            result = (dataArray.indexOf(value) > -1);\n        }\n        return result;\n    };\n    ConditionalFormatting.prototype.isTopBottomTenPercentage = function (val, inp, cFRule, isTop) {\n        var sheet = this.parent.getActiveSheet();\n        var numRegx = new RegExp(/[^.0-9]+/g);\n        var txtRegx = new RegExp(/[^.-a-zA-Z 0-9]+/g);\n        var value = parseInt(val, 10);\n        var input = parseInt(inp, 10);\n        var result = false;\n        if (isNumber(inp)) {\n            if (isNumber(val)) {\n                value = parseFloat(val);\n                input = parseFloat(inp.replace(txtRegx, ''));\n            }\n            else if (isDateTime(val)) {\n                value = dateToInt(val);\n                input = parseFloat(inp);\n            }\n            var dataArr = [];\n            var cellVal = void 0;\n            var diff = void 0;\n            var count = 0;\n            var considerCount = void 0;\n            var rangeArr = cFRule.range.split(',');\n            for (var rangeIdx = 0; rangeIdx < rangeArr.length; rangeIdx++) {\n                var cFRuleIndexes = getRangeIndexes(rangeArr[rangeIdx]);\n                for (var rIdx = cFRuleIndexes[0]; rIdx <= cFRuleIndexes[2]; rIdx++) {\n                    for (var cIdx = cFRuleIndexes[1]; cIdx <= cFRuleIndexes[3]; cIdx++) {\n                        cellVal = getCell(rIdx, cIdx, sheet) && getCell(rIdx, cIdx, sheet).value ? getCell(rIdx, cIdx, sheet).value : '';\n                        if (cellVal && isNumber(cellVal)) {\n                            cellVal = parseFloat(cellVal);\n                            dataArr.push(cellVal);\n                        }\n                        count++;\n                    }\n                }\n            }\n            diff = 100 / count;\n            considerCount = input / diff;\n            considerCount = Math.ceil(considerCount);\n            dataArr =\n                isTop ? dataArr.sort(function (n1, n2) { return n1 - n2; }).reverse() : dataArr.sort(function (n1, n2) { return n1 - n2; });\n            dataArr = dataArr.slice(0, considerCount ? considerCount : 1);\n            result = (dataArr.indexOf(value) > -1);\n        }\n        return result;\n    };\n    ConditionalFormatting.prototype.isAboveBelowAverage = function (val, inp, cFRule, isAbove) {\n        var sheet = this.parent.getActiveSheet();\n        var value = parseFloat(val);\n        var rangeColl = cFRule.range.split(',');\n        var result = false;\n        var dataArr = [];\n        var cellValue;\n        var average = 0;\n        for (var rangeIdx = 0; rangeIdx < rangeColl.length; rangeIdx++) {\n            var cFRuleIndexes = getRangeIndexes(rangeColl[rangeIdx]);\n            for (var rIdx = cFRuleIndexes[0]; rIdx <= cFRuleIndexes[2]; rIdx++) {\n                for (var cIdx = cFRuleIndexes[1]; cIdx <= cFRuleIndexes[3]; cIdx++) {\n                    cellValue = getCell(rIdx, cIdx, sheet) && getCell(rIdx, cIdx, sheet).value ? getCell(rIdx, cIdx, sheet).value : '';\n                    if (cellValue && isNumber(cellValue)) {\n                        cellValue = parseFloat(cellValue);\n                        dataArr.push(cellValue);\n                    }\n                }\n            }\n        }\n        for (var idx = 0; idx < dataArr.length; idx++) {\n            average += dataArr[idx];\n        }\n        average = average / dataArr.length;\n        result = isAbove ? (value > average) : (value < average);\n        return result;\n    };\n    ConditionalFormatting.prototype.isDuplicateUnique = function (val, cFRule, isAbove) {\n        var type = cFRule.type;\n        var count = 0;\n        var sheet = this.parent.getActiveSheet();\n        var value = val;\n        var rangeColl = cFRule.range.split(',');\n        var cellValue;\n        if (isNullOrUndefined(value) || value === '') {\n            return false;\n        }\n        for (var rIdx = 0; rIdx < rangeColl.length; rIdx++) {\n            var cFRuleIndexes = getRangeIndexes(rangeColl[rIdx]);\n            for (var rowIdx = cFRuleIndexes[0]; rowIdx <= cFRuleIndexes[2]; rowIdx++) {\n                for (var colIdx = cFRuleIndexes[1]; colIdx <= cFRuleIndexes[3]; colIdx++) {\n                    cellValue = getCell(rowIdx, colIdx, sheet) && getCell(rowIdx, colIdx, sheet).value ?\n                        getCell(rowIdx, colIdx, sheet).value.toString() : '';\n                    if (cellValue && cellValue !== '') {\n                        count = value.toLowerCase() === cellValue.toLowerCase() ? count + 1 : count;\n                        if (count === 2) {\n                            return type === 'Duplicate' ? true : false;\n                        }\n                    }\n                }\n            }\n        }\n        return type === 'Duplicate' ? false : true;\n    };\n    ConditionalFormatting.prototype.setFormat = function (style, cFRule) {\n        switch (cFRule.cFColor) {\n            case 'RedFT':\n                style.backgroundColor = '#ffc7ce';\n                style.color = '#9c0055';\n                break;\n            case 'YellowFT':\n                style.backgroundColor = '#ffeb9c';\n                style.color = '#9c6500';\n                break;\n            case 'GreenFT':\n                style.backgroundColor = '#c6efce';\n                style.color = '#006100';\n                break;\n            case 'RedF':\n                style.backgroundColor = '#ffc7ce';\n                break;\n            case 'RedT':\n                style.color = '#9c0055';\n                break;\n        }\n        return style;\n    };\n    /**\n     * Gets the module name.\n     * @returns string\n     */\n    ConditionalFormatting.prototype.getModuleName = function () {\n        return 'conditionalFormatting';\n    };\n    return ConditionalFormatting;\n}());\nexport { ConditionalFormatting };\n","var __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    }\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nvar __assign = (this && this.__assign) || function () {\n    __assign = Object.assign || function(t) {\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\n            s = arguments[i];\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\n                t[p] = s[p];\n        }\n        return t;\n    };\n    return __assign.apply(this, arguments);\n};\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nimport { Component, Property, NotifyPropertyChanges, Event, ChildProperty } from '@syncfusion/ej2-base';\nimport { getComponent, closest, EventHandler, getUniqueID, isNullOrUndefined } from '@syncfusion/ej2-base';\nimport { Collection, Complex } from '@syncfusion/ej2-base';\nimport { Tab, Toolbar } from '@syncfusion/ej2-navigations';\nimport { Menu, Item, MenuItem } from '@syncfusion/ej2-navigations';\n/**\n * Objects used for configuring the Ribbon tab header properties.\n */\nvar RibbonHeader = /** @class */ (function (_super) {\n    __extends(RibbonHeader, _super);\n    function RibbonHeader() {\n        return _super !== null && _super.apply(this, arguments) || this;\n    }\n    __decorate([\n        Property('')\n    ], RibbonHeader.prototype, \"text\", void 0);\n    __decorate([\n        Property('')\n    ], RibbonHeader.prototype, \"iconCss\", void 0);\n    __decorate([\n        Property('left')\n    ], RibbonHeader.prototype, \"iconPosition\", void 0);\n    return RibbonHeader;\n}(ChildProperty));\nexport { RibbonHeader };\n/**\n * An array of object that is used to configure the Tab.\n */\nvar RibbonItem = /** @class */ (function (_super) {\n    __extends(RibbonItem, _super);\n    function RibbonItem() {\n        return _super !== null && _super.apply(this, arguments) || this;\n    }\n    __decorate([\n        Complex({}, RibbonHeader)\n    ], RibbonItem.prototype, \"header\", void 0);\n    __decorate([\n        Collection([], Item)\n    ], RibbonItem.prototype, \"content\", void 0);\n    __decorate([\n        Property('')\n    ], RibbonItem.prototype, \"cssClass\", void 0);\n    __decorate([\n        Property(false)\n    ], RibbonItem.prototype, \"disabled\", void 0);\n    return RibbonItem;\n}(ChildProperty));\nexport { RibbonItem };\n/**\n * Represents Ribbon component.\n */\nvar Ribbon = /** @class */ (function (_super) {\n    __extends(Ribbon, _super);\n    /**\n     * Constructor for creating the widget.\n     * @param  {RibbonModel} options?\n     * @param  {string|HTMLDivElement} element?\n     */\n    function Ribbon(options, element) {\n        return _super.call(this, options) || this;\n    }\n    /**\n     * For internal use only.\n     * @returns void\n     * @private\n     */\n    Ribbon.prototype.preRender = function () {\n        /** */\n    };\n    /**\n     * For internal use only.\n     * @returns void\n     * @private\n     */\n    Ribbon.prototype.render = function () {\n        if (!this.element.id) {\n            this.element.id = getUniqueID('ribbon');\n        }\n        this.renderRibbon();\n    };\n    /**\n     * Destroys the component (detaches/removes all event handlers, attributes, classes, and empties the component element).\n     * {% codeBlock src='spreadsheet/destroy/index.md' %}{% endcodeBlock %}\n     * @method destroy\n     * @return {void}\n     */\n    Ribbon.prototype.destroy = function () {\n        var expandCollapseElem = this.element.querySelector('.e-drop-icon');\n        if (expandCollapseElem) {\n            expandCollapseElem.removeEventListener('click', this.ribbonExpandCollapse.bind(this));\n        }\n        if (this.menuItems.length) {\n            var fileMenu = document.getElementById(this.element.id + \"_menu\");\n            if (fileMenu) {\n                getComponent(fileMenu, 'menu').destroy();\n            }\n        }\n        this.toolbarObj.destroy();\n        this.tabObj.destroy();\n        this.element.innerHTML = '';\n        this.toolbarObj = null;\n        this.tabObj = null;\n        _super.prototype.destroy.call(this);\n    };\n    Ribbon.prototype.getTabItems = function () {\n        var _this = this;\n        var tabItems = [];\n        if (this.menuItems.length) {\n            tabItems.push({\n                header: { text: this.initMenu(this.menuItems) },\n                content: this.toolbarObj.element,\n                cssClass: 'e-menu-tab'\n            });\n        }\n        this.items.forEach(function (item) {\n            tabItems.push({\n                header: item.header,\n                content: _this.toolbarObj.element\n            });\n        });\n        return tabItems;\n    };\n    Ribbon.prototype.initMenu = function (menuItems) {\n        var _this = this;\n        var menu = this.createElement('ul', { id: this.element.id + \"_menu\" });\n        this.element.appendChild(menu);\n        var menuObj = new Menu({\n            cssClass: 'e-file-menu',\n            items: menuItems,\n            showItemOnClick: true,\n            beforeOpen: function (args) {\n                if (args.parentItem.text === menuItems[0].text) {\n                    menuObj.showItemOnClick = false;\n                }\n                _this.trigger('beforeOpen', args);\n            },\n            select: function (args) {\n                _this.trigger('fileMenuItemSelect', args);\n            },\n            beforeClose: function (args) {\n                if (args.event.type === 'mouseover' && !closest(args.event.target, '.e-menu-popup')) {\n                    args.cancel = true;\n                    return;\n                }\n                _this.trigger('beforeClose', args);\n                if (!args.parentItem || args.parentItem.text === menuItems[0].text) {\n                    requestAnimationFrame(function () { return menuObj.setProperties({ showItemOnClick: true }, true); });\n                }\n            },\n            beforeItemRender: function (args) {\n                _this.trigger('beforeFileMenuItemRender', args);\n            }\n        });\n        menuObj.createElement = this.createElement;\n        menuObj.appendTo(menu);\n        return menu.parentElement;\n    };\n    Ribbon.prototype.renderRibbon = function () {\n        var _this = this;\n        var tabElement = this.createElement('div');\n        var tBarElement = this.createElement('div');\n        this.toolbarObj = new Toolbar({\n            items: this.items[this.selectedTab].content,\n            clicked: function (args) { return _this.trigger('clicked', args); }\n        });\n        this.toolbarObj.createElement = this.createElement;\n        this.toolbarObj.appendTo(tBarElement);\n        this.tabObj = new Tab({\n            selectedItem: this.getIndex(this.selectedTab),\n            animation: { next: { duration: 0 }, previous: { duration: 0 } },\n            items: this.getTabItems(),\n            selecting: function (args) {\n                if (_this.menuItems.length && args.selectingIndex === 0) {\n                    args.cancel = true;\n                }\n                else {\n                    if (args.selectingIndex === _this.getIndex(_this.selectedTab)) {\n                        return;\n                    }\n                    _this.updateToolbar(_this.getIndex(args.selectingIndex, true));\n                    _this.toolbarObj.dataBind();\n                    if (_this.element.classList.contains('e-collapsed')) {\n                        EventHandler.remove(args.selectedItem, 'click', _this.ribbonExpandCollapse);\n                    }\n                    var eventArgs = void 0;\n                    if (_this.menuItems.length) {\n                        eventArgs = __assign({}, args);\n                        eventArgs.selectingIndex -= 1;\n                        eventArgs.selectedIndex -= 1;\n                    }\n                    else {\n                        eventArgs = args;\n                    }\n                    _this.trigger('selecting', eventArgs);\n                }\n            },\n            selected: function (args) {\n                if (args.selectedIndex === _this.getIndex(_this.selectedTab)) {\n                    return;\n                }\n                _this.setProperties({ 'selectedTab': _this.getIndex(args.selectedIndex, true) }, true);\n                if (_this.element.classList.contains('e-collapsed')) {\n                    _this.element.classList.remove('e-collapsed');\n                    _this.trigger('expandCollapse', { element: _this.toolbarObj.element, expanded: true });\n                }\n            },\n            created: function () {\n                _this.toolbarObj.refreshOverflow();\n            }\n        });\n        this.element.appendChild(tabElement);\n        this.tabObj.createElement = this.createElement;\n        this.tabObj.appendTo(tabElement);\n        var collapseBtn = this.createElement('span', { className: 'e-drop-icon e-icons' });\n        collapseBtn.addEventListener('click', this.ribbonExpandCollapse.bind(this));\n        this.element.appendChild(collapseBtn);\n    };\n    Ribbon.prototype.ribbonExpandCollapse = function (e) {\n        var eventArgs = { element: this.toolbarObj.element, expanded: true };\n        var activeTab;\n        if (this.element.classList.contains('e-collapsed')) {\n            activeTab = this.tabObj.element.querySelector('.e-tab-header').getElementsByClassName('e-toolbar-item')[this.tabObj.selectedItem];\n            this.element.classList.remove('e-collapsed');\n            activeTab.classList.add('e-active');\n            EventHandler.remove(activeTab, 'click', this.ribbonExpandCollapse);\n            this.trigger('expandCollapse', eventArgs);\n        }\n        else {\n            activeTab = this.tabObj.element.querySelector('.e-tab-header .e-toolbar-item.e-active');\n            this.element.classList.add('e-collapsed');\n            eventArgs.expanded = false;\n            activeTab.classList.remove('e-active');\n            EventHandler.add(activeTab, 'click', this.ribbonExpandCollapse, this);\n            this.trigger('expandCollapse', eventArgs);\n        }\n    };\n    Ribbon.prototype.getIndex = function (index, decrement) {\n        return this.menuItems.length ? (decrement ? index - 1 : index + 1) : index;\n    };\n    Ribbon.prototype.updateToolbar = function (index) {\n        this.toolbarObj.items = this.items[index].content;\n        this.toolbarObj.dataBind();\n    };\n    /**\n     * To enable / disable the ribbon menu items.\n     * @param {string[]} items - Items that needs to be enabled / disabled.\n     * @param {boolean} enable - Set `true` / `false` to enable / disable the menu items.\n     * @param {boolean} isUniqueId? - Set `true` if the given menu items `text` is a unique id.\n     * @returns void.\n     */\n    Ribbon.prototype.enableMenuItems = function (items, enable, isUniqueId) {\n        if (enable === void 0) { enable = true; }\n        if (!this.menuItems.length) {\n            return;\n        }\n        getComponent(document.getElementById(this.element.id + \"_menu\"), 'menu').enableItems(items, enable, isUniqueId);\n    };\n    /**\n     * To show/hide the menu items in Ribbon.\n     * @param {string[]} items - Specifies the menu items text which is to be show/hide.\n     * @param {boolean} hide - Set `true` / `false` to hide / show the menu items.\n     * @param {boolean} isUniqueId? - Set `true` if the given menu items `text` is a unique id.\n     * @returns void.\n     */\n    Ribbon.prototype.hideMenuItems = function (items, hide, isUniqueId) {\n        if (hide === void 0) { hide = true; }\n        if (!this.menuItems.length) {\n            return;\n        }\n        var menuInstance = getComponent(document.getElementById(this.element.id + \"_menu\"), 'menu');\n        hide ? menuInstance.hideItems(items, isUniqueId) : menuInstance.showItems(items, isUniqueId);\n    };\n    /**\n     * To add custom menu items.\n     * @param {MenuItemModel[]} items - Specifies the Ribbon menu items to be inserted.\n     * @param {string} text - Specifies the existing file menu item text before / after which the new file menu items to be inserted.\n     * @param {boolean} insertAfter? - Set `false` if the `items` need to be inserted before the `text`.\n     * By default, `items` are added after the `text`.\n     * @param {boolean} isUniqueId? - Set `true` if the given menu items `text` is a unique id.\n     * @returns void.\n     */\n    Ribbon.prototype.addMenuItems = function (items, text, insertAfter, isUniqueId) {\n        if (insertAfter === void 0) { insertAfter = true; }\n        if (!this.menuItems.length) {\n            return;\n        }\n        var menuInstance = getComponent(document.getElementById(this.element.id + \"_menu\"), 'menu');\n        insertAfter ? menuInstance.insertAfter(items.reverse(), text, isUniqueId) : menuInstance.insertBefore(items, text, isUniqueId);\n    };\n    /**\n     * To show/hide the Ribbon tabs.\n     * @param {string[]} tabs - Specifies the tab header text which needs to be shown/hidden.\n     * @param {boolean} hide? - Set `true` / `false` to hide / show the ribbon tabs.\n     * @returns void.\n     */\n    Ribbon.prototype.hideTabs = function (tabs, hide) {\n        var _this = this;\n        if (hide === void 0) { hide = true; }\n        var idx;\n        var activeTab;\n        var stateChanged;\n        var isAllHidden;\n        if (!hide) {\n            isAllHidden = this.isAllHidden();\n        }\n        tabs.forEach(function (tab) {\n            idx = _this.getTabIndex(tab, -1);\n            if (idx > -1) {\n                if (hide) {\n                    if (!_this.items[idx].cssClass.includes(' e-hide')) {\n                        _this.items[idx].cssClass = _this.items[idx].cssClass + \" e-hide\";\n                        _this.tabObj.items[_this.getIndex(idx)].cssClass = _this.items[idx].cssClass;\n                        if (activeTab === undefined && idx === _this.selectedTab) {\n                            activeTab = true;\n                        }\n                        stateChanged = true;\n                    }\n                }\n                else {\n                    if (_this.items[idx].cssClass.includes(' e-hide')) {\n                        _this.items[idx].cssClass = _this.items[idx].cssClass.replace(' e-hide', '');\n                        _this.tabObj.items[_this.getIndex(idx)].cssClass = _this.items[idx].cssClass;\n                        if (activeTab === undefined && idx === _this.selectedTab) {\n                            activeTab = true;\n                        }\n                        stateChanged = true;\n                    }\n                }\n            }\n        });\n        this.setProperties({ 'items': this.items }, true);\n        this.tabObj.items = this.tabObj.items;\n        this.tabObj.dataBind();\n        if (hide) {\n            isAllHidden = this.isAllHidden();\n            if (isAllHidden) {\n                activeTab = false;\n            }\n        }\n        if (!hide && isAllHidden) {\n            activeTab = activeTab ? false : true;\n        }\n        if (stateChanged && isAllHidden) {\n            if (this.element.classList.contains('e-collapsed')) {\n                this.element.classList.remove('e-collapsed');\n                this.element.querySelector('.e-drop-icon').classList.remove('e-hide');\n            }\n            else {\n                this.element.classList.add('e-collapsed');\n                this.element.querySelector('.e-drop-icon').classList.add('e-hide');\n            }\n        }\n        if (activeTab) {\n            for (var i = 0; i < this.items.length; i++) {\n                if (!this.items[i].cssClass.includes(' e-hide')) {\n                    this.tabObj.selectedItem = this.getIndex(i);\n                    this.tabObj.dataBind();\n                    break;\n                }\n            }\n        }\n    };\n    Ribbon.prototype.isAllHidden = function () {\n        var allHidden = true;\n        for (var i = 0; i < this.items.length; i++) {\n            if (!this.items[i].cssClass.includes(' e-hide')) {\n                allHidden = false;\n                break;\n            }\n        }\n        return allHidden;\n    };\n    /**\n     * To enable / disable the Ribbon tabs.\n     * @param {string[]} tabs - Specifies the tab header text which needs to be enabled / disabled.\n     * @param {boolean} enable? - Set `true` / `false` to enable / disable the ribbon tabs.\n     * @returns void.\n     */\n    Ribbon.prototype.enableTabs = function (tabs, enable) {\n        var _this = this;\n        if (enable === void 0) { enable = true; }\n        tabs.forEach(function (tab) {\n            var idx = (_this.getTabIndex(tab, -1));\n            if (idx > -1) {\n                _this.items[idx].disabled = !enable;\n                idx = _this.getIndex(idx);\n                _this.tabObj.enableTab(idx, enable);\n            }\n        });\n        this.setProperties({ 'items': this.items }, true);\n    };\n    /**\n     * To add custom tabs.\n     * @param {RibbonItemModel[]} items - Specifies the Ribbon tab items to be inserted.\n     * @param {string} insertBefore? - Specifies the existing Ribbon header text before which the new tabs will be inserted.\n     * If not specified, the new tabs will be inserted at the end.\n     * @returns void.\n     */\n    Ribbon.prototype.addTabs = function (items, insertBefore) {\n        var _this = this;\n        var idx = this.getTabIndex(insertBefore);\n        items.forEach(function (item) {\n            item = new RibbonItem(_this.items[0], 'items', item, true);\n            _this.items.splice(idx, 0, item);\n            _this.tabObj.addTab([{ header: item.header, content: _this.toolbarObj.element }], _this.getIndex(idx));\n            idx++;\n        });\n        this.setProperties({ 'items': this.items }, true);\n        this.setProperties({ 'selectedTab': this.getIndex(this.tabObj.selectedItem, true) }, true);\n    };\n    Ribbon.prototype.getTabIndex = function (headerText, idx) {\n        if (idx === void 0) { idx = this.items.length; }\n        if (headerText) {\n            for (var i = 0; i < this.items.length; i++) {\n                if (this.items[i].header.text === headerText) {\n                    idx = i;\n                    break;\n                }\n            }\n        }\n        return idx;\n    };\n    /**\n     * To add the custom items in Ribbon toolbar.\n     * @param {string} tab - Specifies the ribbon tab header text under which the specified items will be inserted..\n     * @param {ItemModel[]} items - Specifies the ribbon toolbar items that needs to be inserted.\n     * @param {number} index? - Specifies the index text before which the new items will be inserted.\n     * If not specified, the new items will be inserted at the end of the toolbar.\n     */\n    Ribbon.prototype.addToolbarItems = function (tab, items, index) {\n        var _this = this;\n        var tabIdx = this.getTabIndex(tab);\n        if (isNullOrUndefined(index)) {\n            index = this.items[tabIdx].content.length;\n        }\n        items.forEach(function (item) {\n            item = new Item(_this.items[tabIdx].content[0], 'content', item, true);\n            _this.items[tabIdx].content.splice(index, 0, item);\n            index++;\n        });\n        this.setProperties({ 'items': this.items }, true);\n        if (tabIdx === this.selectedTab && items.length) {\n            this.updateToolbar(tabIdx);\n        }\n    };\n    /**\n     * Enables or disables the specified Ribbon toolbar items or all ribbon items.\n     * @param {string} tab - Specifies the ribbon tab header text under which the toolbar items need to be enabled / disabled.\n     * @param {string[]} items? - Specifies the toolbar item indexes / unique id's which needs to be enabled / disabled.\n     * If it is not specified the entire toolbar items will be enabled / disabled.\n     * @param  {boolean} enable? - Boolean value that determines whether the toolbar items should be enabled or disabled.\n     * @returns void.\n     */\n    Ribbon.prototype.enableItems = function (tab, items, enable) {\n        if (enable === undefined) {\n            enable = true;\n        }\n        if (items) {\n            var tabIdx = this.getTabIndex(tab, -1);\n            if (tabIdx < 0) {\n                return;\n            }\n            for (var i = 0; i < items.length; i++) {\n                if (typeof (items[i]) === 'string') {\n                    for (var j = 0; j < this.items[tabIdx].content.length; j++) {\n                        if (this.items[tabIdx].content[j].id === items[i]) {\n                            items[i] = j;\n                            break;\n                        }\n                    }\n                }\n                if (typeof (items[i]) === 'string') {\n                    return;\n                }\n                this.items[tabIdx].content[items[i]].disabled = !enable;\n            }\n            if (tabIdx === this.selectedTab) {\n                this.updateToolbar(tabIdx);\n            }\n        }\n        else {\n            this.toolbarObj.disable(!enable);\n        }\n    };\n    /**\n     * To show/hide the existing Ribbon toolbar items.\n     * @param {string} tab - Specifies the ribbon tab header text under which the specified items need to be hidden / shown.\n     * @param {string[]} indexes - Specifies the toolbar indexes which needs to be shown/hidden from UI.\n     * @param {boolean} hide? - Set `true` / `false` to hide / show the toolbar items.\n     * @returns void.\n     */\n    Ribbon.prototype.hideToolbarItems = function (tab, indexes, hide) {\n        var _this = this;\n        if (hide === void 0) { hide = true; }\n        var tabIdx;\n        for (var i = 0; i < this.items.length; i++) {\n            if (this.items[i].header.text === tab) {\n                tabIdx = i;\n                indexes.forEach(function (idx) {\n                    if (_this.items[tabIdx].content[idx]) {\n                        if (hide) {\n                            if (!_this.items[tabIdx].content[idx].cssClass.includes(' e-hide')) {\n                                _this.items[tabIdx].content[idx].cssClass = _this.items[tabIdx].content[idx].cssClass + ' e-hide';\n                            }\n                        }\n                        else {\n                            if (_this.items[tabIdx].content[idx].cssClass.includes(' e-hide')) {\n                                _this.items[tabIdx].content[idx].cssClass = _this.items[tabIdx].content[idx].cssClass.replace(' e-hide', '');\n                            }\n                        }\n                    }\n                });\n                break;\n            }\n        }\n        this.setProperties({ 'items': this.items }, true);\n        if (tabIdx !== undefined && tabIdx === this.selectedTab) {\n            this.updateToolbar(tabIdx);\n        }\n    };\n    /**\n     * Get component name.\n     * @returns string\n     * @private\n     */\n    Ribbon.prototype.getModuleName = function () {\n        return 'ribbon';\n    };\n    /**\n     * Get the properties to be maintained in the persisted state.\n     * @returns string\n     * @private\n     */\n    Ribbon.prototype.getPersistData = function () {\n        return this.addOnPersist([]);\n    };\n    /**\n     * Called internally if any of the property value changed.\n     * @param  {RibbonModel} newProp\n     * @param  {RibbonModel} oldProp\n     * @returns void\n     * @private\n     */\n    Ribbon.prototype.onPropertyChanged = function (newProp, oldProp) {\n        for (var _i = 0, _a = Object.keys(newProp); _i < _a.length; _i++) {\n            var prop = _a[_i];\n            switch (prop) {\n                case 'selectedTab':\n                    this.tabObj.selectedItem = this.getIndex(newProp.selectedTab);\n                    this.tabObj.dataBind();\n                    break;\n            }\n        }\n    };\n    __decorate([\n        Property('')\n    ], Ribbon.prototype, \"cssClass\", void 0);\n    __decorate([\n        Property(true)\n    ], Ribbon.prototype, \"menuType\", void 0);\n    __decorate([\n        Collection([], MenuItem)\n    ], Ribbon.prototype, \"menuItems\", void 0);\n    __decorate([\n        Property(0)\n    ], Ribbon.prototype, \"selectedTab\", void 0);\n    __decorate([\n        Collection([], RibbonItem)\n    ], Ribbon.prototype, \"items\", void 0);\n    __decorate([\n        Event()\n    ], Ribbon.prototype, \"selecting\", void 0);\n    __decorate([\n        Event()\n    ], Ribbon.prototype, \"fileMenuItemSelect\", void 0);\n    __decorate([\n        Event()\n    ], Ribbon.prototype, \"beforeFileMenuItemRender\", void 0);\n    __decorate([\n        Event()\n    ], Ribbon.prototype, \"beforeOpen\", void 0);\n    __decorate([\n        Event()\n    ], Ribbon.prototype, \"beforeClose\", void 0);\n    __decorate([\n        Event()\n    ], Ribbon.prototype, \"selectFormat\", void 0);\n    __decorate([\n        Event()\n    ], Ribbon.prototype, \"clicked\", void 0);\n    __decorate([\n        Event()\n    ], Ribbon.prototype, \"created\", void 0);\n    __decorate([\n        Event()\n    ], Ribbon.prototype, \"expandCollapse\", void 0);\n    Ribbon = __decorate([\n        NotifyPropertyChanges\n    ], Ribbon);\n    return Ribbon;\n}(Component));\nexport { Ribbon };\n","import { ColorPicker as ColorPickerComponent } from '@syncfusion/ej2-inputs';\nimport { addClass } from '@syncfusion/ej2-base';\nimport { spreadsheetDestroyed, fontColor, fillColor, beforeRibbonCreate, locale } from '../common/index';\nimport { setCellFormat } from '../../workbook/common/index';\n/**\n * `Color Picker` module is used to handle ColorPicker functionality.\n * @hidden\n */\nvar ColorPicker = /** @class */ (function () {\n    function ColorPicker(parent) {\n        this.parent = parent;\n        this.addEventListener();\n    }\n    ColorPicker.prototype.render = function () {\n        var _this = this;\n        var id = this.parent.element.id;\n        var input = this.parent.createElement('input', { attrs: { 'type': 'color' } });\n        this.fontColorPicker = new ColorPickerComponent({\n            value: '#000000ff',\n            mode: 'Palette',\n            showButtons: false,\n            presetColors: fontColor,\n            enableOpacity: false,\n            beforeClose: function (args) { return _this.beforeCloseHandler(_this.fontColorPicker); },\n            open: this.openHandler.bind(this),\n            beforeModeSwitch: function (args) { return _this.beforeModeSwitch(_this.fontColorPicker, args); },\n            change: function (args) {\n                var color = _this.fontColorPicker.getValue(args.currentValue.rgba);\n                var eventArgs = { style: { color: color }, onActionUpdate: true };\n                _this.parent.notify(setCellFormat, eventArgs);\n                if (eventArgs.cancel) {\n                    _this.fontColorPicker.setProperties({ 'value': _this.fontColorPicker.getValue(args.previousValue.rgba, 'HEXA') }, true);\n                }\n                else {\n                    _this.updateSelectedColor(eventArgs.style.color, _this.fontColorPicker.element);\n                }\n                _this.parent.element.focus();\n            },\n            created: function () { return _this.wireFocusEvent(_this.fontColorPicker.element, '#000000'); }\n        });\n        this.fontColorPicker.createElement = this.parent.createElement;\n        this.parent.element.appendChild(input);\n        this.fontColorPicker.appendTo(input);\n        input.parentElement.id = id + \"_font_color_picker\";\n        addClass([input.nextElementSibling.getElementsByClassName('e-selected-color')[0]], ['e-icons', 'e-font-color']);\n        input = this.parent.createElement('input', { attrs: { 'type': 'color' } });\n        this.filColorPicker = new ColorPickerComponent({\n            value: '#ffff00ff',\n            mode: 'Palette',\n            presetColors: fillColor,\n            showButtons: false,\n            enableOpacity: false,\n            open: this.openHandler.bind(this),\n            beforeClose: function (args) { return _this.beforeCloseHandler(_this.filColorPicker); },\n            beforeModeSwitch: function (args) { return _this.beforeModeSwitch(_this.filColorPicker, args); },\n            change: function (args) {\n                var color = _this.filColorPicker.getValue(args.currentValue.rgba);\n                var eventArgs = { style: { backgroundColor: color }, onActionUpdate: true };\n                _this.parent.notify(setCellFormat, eventArgs);\n                if (eventArgs.cancel) {\n                    _this.filColorPicker.setProperties({ 'value': _this.filColorPicker.getValue(args.previousValue.rgba, 'HEXA') }, true);\n                }\n                else {\n                    _this.updateSelectedColor(eventArgs.style.backgroundColor, _this.filColorPicker.element);\n                }\n                _this.parent.element.focus();\n            },\n            created: function () { return _this.wireFocusEvent(_this.filColorPicker.element, '#ffff00'); }\n        });\n        this.filColorPicker.createElement = this.parent.createElement;\n        this.parent.element.appendChild(input);\n        this.filColorPicker.appendTo(input);\n        input.parentElement.id = id + \"_fill_color_picker\";\n        addClass([input.nextElementSibling.getElementsByClassName('e-selected-color')[0]], ['e-icons', 'e-fill-color']);\n    };\n    ColorPicker.prototype.updateSelectedColor = function (color, ele) {\n        ele.nextElementSibling.querySelector('.e-selected-color').style.borderBottomColor = color;\n    };\n    ColorPicker.prototype.wireFocusEvent = function (element, color) {\n        var _this = this;\n        this.updateSelectedColor(color, element);\n        element = element.parentElement.querySelector('.e-split-colorpicker');\n        element.addEventListener('focus', function () {\n            _this.parent.element.focus();\n        });\n    };\n    ColorPicker.prototype.openHandler = function (args) {\n        args.element.querySelector('.e-mode-switch-btn').title =\n            this.parent.serviceLocator.getService(locale).getConstant('MoreColors');\n    };\n    ColorPicker.prototype.beforeCloseHandler = function (inst) {\n        if (!inst.modeSwitcher) {\n            inst.setProperties({ modeSwitcher: true }, true);\n        }\n        if (inst.showButtons) {\n            inst.setProperties({ showButtons: false }, true);\n        }\n    };\n    ColorPicker.prototype.beforeModeSwitch = function (inst, args) {\n        var l10n = this.parent.serviceLocator.getService(locale);\n        if (args.mode === 'Picker') {\n            inst.showButtons = true;\n            inst.dataBind();\n            args.element.querySelector('.e-apply').title = l10n.getConstant('Apply');\n            args.element.querySelector('.e-cancel').title = l10n.getConstant('Cancel');\n            args.element.querySelector('.e-mode-switch-btn').title = l10n.getConstant('StandardColors');\n        }\n        else {\n            inst.showButtons = false;\n            inst.dataBind();\n            args.element.querySelector('.e-mode-switch-btn').title = l10n.getConstant('MoreColors');\n        }\n    };\n    ColorPicker.prototype.destroy = function () {\n        if (this.parent) {\n            this.removeEventListener();\n            this.fontColorPicker.destroy();\n            this.fontColorPicker = null;\n            this.filColorPicker.destroy();\n            this.filColorPicker = null;\n            this.parent = null;\n        }\n    };\n    ColorPicker.prototype.addEventListener = function () {\n        this.parent.on(beforeRibbonCreate, this.render, this);\n        this.parent.on('destroyRibbonComponents', this.destroy, this);\n        this.parent.on(spreadsheetDestroyed, this.destroy, this);\n    };\n    ColorPicker.prototype.removeEventListener = function () {\n        this.parent.off(beforeRibbonCreate, this.render);\n        this.parent.off('destroyRibbonComponents', this.destroy);\n        this.parent.on(spreadsheetDestroyed, this.destroy, this);\n    };\n    return ColorPicker;\n}());\nexport { ColorPicker };\n","import { Ribbon as RibbonComponent } from '../../ribbon/index';\nimport { ribbon, selectionComplete, beforeRibbonCreate, removeDataValidation, clearViewer } from '../common/index';\nimport { initiateDataValidation, invalidData, setUndoRedo, initiateConditionalFormat, setCF } from '../common/index';\nimport { dialog, reapplyFilter, enableFileMenuItems, applyProtect, protectCellFormat } from '../common/index';\nimport { findHandler, insertChart } from '../common/index';\nimport { destroyComponent, performUndoRedo, beginAction, completeAction, applySort, hideRibbonTabs } from '../common/index';\nimport { enableToolbarItems, ribbonClick, paste, locale, refreshSheetTabs, initiateCustomSort, getFilteredColumn } from '../common/index';\nimport { tabSwitch, getUpdateUsingRaf, updateToggleItem, initiateHyperlink, editHyperlink } from '../common/index';\nimport { addRibbonTabs, addToolbarItems, hideFileMenuItems, addFileMenuItems, hideToolbarItems, enableRibbonTabs } from '../common/index';\nimport { Toolbar, Menu } from '@syncfusion/ej2-navigations';\nimport { ColorPicker } from '@syncfusion/ej2-inputs';\nimport { extend, isNullOrUndefined, getComponent, closest, detach, selectAll, select, EventHandler } from '@syncfusion/ej2-base';\nimport { getCellIndexes, getFormatFromType, getTypeFromFormat, setCell } from '../../workbook/index';\nimport { DropDownButton, SplitButton } from '@syncfusion/ej2-splitbuttons';\nimport { calculatePosition } from '@syncfusion/ej2-popups';\nimport { applyNumberFormatting, getFormattedCellObject, getRangeIndexes, setMerge } from '../../workbook/common/index';\nimport { activeCellChanged, textDecorationUpdate, isNumber } from '../../workbook/common/index';\nimport { sheetsDestroyed, getRangeAddress, clearCFRule } from '../../workbook/common/index';\nimport { getCell, setCellFormat } from '../../workbook/index';\nimport { Button } from '@syncfusion/ej2-buttons';\nimport { ColorPicker as RibbonColorPicker } from './color-picker';\nimport { Dialog as FindDialog } from '@syncfusion/ej2-popups';\nimport { findDlg } from '../common/index';\nimport { refreshRibbonIcons } from '../../workbook/common/index';\n/**\n * Represents Ribbon for Spreadsheet.\n */\nvar Ribbon = /** @class */ (function () {\n    function Ribbon(parent) {\n        this.border = '1px solid #000000';\n        this.fontNameIndex = 5;\n        this.numPopupWidth = 0;\n        this.findValue = '';\n        this.parent = parent;\n        this.addEventListener();\n        new RibbonColorPicker(parent);\n    }\n    Ribbon.prototype.getModuleName = function () {\n        return 'ribbon';\n    };\n    Ribbon.prototype.initRibbon = function (args) {\n        if (!this.parent.showRibbon && this.ribbon) {\n            this.destroy();\n            return;\n        }\n        this.parent.notify(beforeRibbonCreate, {});\n        if (this.parent.isMobileView()) {\n            this.createMobileView();\n        }\n        else {\n            this.createRibbon(args);\n        }\n    };\n    Ribbon.prototype.getRibbonMenuItems = function () {\n        var l10n = this.parent.serviceLocator.getService(locale);\n        var id = this.parent.element.id;\n        return [{\n                text: this.parent.isMobileView() ? '' : l10n.getConstant('File'),\n                iconCss: this.parent.isMobileView() ? 'e-icons e-file-menu-icon' : null, id: id + \"_File\",\n                items: [\n                    { text: l10n.getConstant('New'), id: id + \"_New\", iconCss: 'e-new e-icons' },\n                    { text: l10n.getConstant('Open'), id: id + \"_Open\", iconCss: 'e-open e-icons' },\n                    {\n                        text: l10n.getConstant('SaveAs'), iconCss: 'e-save e-icons', id: id + \"_Save_As\",\n                        items: [\n                            { text: l10n.getConstant('ExcelXlsx'), id: id + \"_Xlsx\", iconCss: 'e-xlsx e-icons' },\n                            { text: l10n.getConstant('ExcelXls'), id: id + \"_Xls\", iconCss: 'e-xls e-icons' },\n                            { text: l10n.getConstant('CSV'), id: id + \"_Csv\", iconCss: 'e-csv e-icons' }\n                        ]\n                    }\n                ]\n            }];\n    };\n    // tslint:disable-next-line:max-func-body-length\n    Ribbon.prototype.getRibbonItems = function () {\n        var _this = this;\n        var id = this.parent.element.id;\n        var l10n = this.parent.serviceLocator.getService(locale);\n        var items = [{\n                header: { text: l10n.getConstant('Home') },\n                content: [\n                    { prefixIcon: 'e-undo-icon', tooltipText: l10n.getConstant('Undo') + \" (Ctrl+Z)\", id: id + '_undo', disabled: true },\n                    { prefixIcon: 'e-redo-icon', tooltipText: l10n.getConstant('Redo') + \" (Ctrl+Y)\", id: id + '_redo', disabled: true },\n                    { type: 'Separator', id: id + '_separator_1' },\n                    { prefixIcon: 'e-cut-icon', tooltipText: l10n.getConstant('Cut') + \" (Ctrl+X)\", id: id + '_cut' },\n                    { prefixIcon: 'e-copy-icon', tooltipText: l10n.getConstant('Copy') + \" (Ctrl+C)\", id: id + '_copy' },\n                    { tooltipText: l10n.getConstant('Paste') + \" (Ctrl+V)\", template: this.getPasteBtn(id), id: id + '_paste',\n                        disabled: true\n                    }, { type: 'Separator', id: id + '_separator_2' },\n                    { template: this.getNumFormatDDB(id), tooltipText: l10n.getConstant('NumberFormat'), id: id + '_number_format' },\n                    { type: 'Separator', id: id + '_separator_3' },\n                    { template: this.getFontNameDDB(id), tooltipText: l10n.getConstant('Font'), id: id + '_font_name' },\n                    { type: 'Separator', id: id + '_separator_4' },\n                    { template: this.getFontSizeDDB(id), tooltipText: l10n.getConstant('FontSize'), id: id + '_font_size' },\n                    { type: 'Separator', id: id + '_separator_5' },\n                    { template: this.getBtn(id, 'bold'), tooltipText: l10n.getConstant('Bold') + \" (Ctrl+B)\", id: id + '_bold' },\n                    { template: this.getBtn(id, 'italic'), tooltipText: l10n.getConstant('Italic') + \" (Ctrl+I)\", id: id + '_italic' },\n                    { template: this.getBtn(id, 'line-through'), tooltipText: l10n.getConstant('Strikethrough') + \" (Ctrl+5)\",\n                        id: id + '_line-through' },\n                    { template: this.getBtn(id, 'underline'), tooltipText: l10n.getConstant('Underline') + \" (Ctrl+U)\",\n                        id: id + '_underline' },\n                    { template: document.getElementById(id + \"_font_color_picker\"), tooltipText: l10n.getConstant('TextColor'),\n                        id: id + '_font_color_picker' }, { type: 'Separator', id: id + '_separator_6' },\n                    { template: document.getElementById(id + \"_fill_color_picker\"), tooltipText: l10n.getConstant('FillColor'),\n                        id: id + '_fill_color_picker' },\n                    { template: this.getBordersDBB(id), tooltipText: l10n.getConstant('Borders'), id: id + '_borders' }, {\n                        template: this.getMergeSplitBtn(id), tooltipText: l10n.getConstant('MergeCells'), id: id + '_merge_cells',\n                        disabled: true\n                    }, { type: 'Separator', id: id + '_separator_7' },\n                    { template: this.getTextAlignDDB(id), tooltipText: l10n.getConstant('HorizontalAlignment'), id: id + '_text_align' }, { template: this.getVerticalAlignDDB(id), tooltipText: l10n.getConstant('VerticalAlignment'), id: id + '_vertical_align' },\n                    { template: this.getBtn(id, 'wrap', false), tooltipText: \"\" + l10n.getConstant('WrapText'), id: id + '_wrap' }\n                ]\n            },\n            {\n                header: { text: l10n.getConstant('Insert') }, content: [\n                    {\n                        prefixIcon: 'e-hyperlink-icon', text: l10n.getConstant('Link'),\n                        id: id + '_hyperlink', tooltipText: l10n.getConstant('Link'), click: function () { _this.getHyperlinkDlg(); }\n                    },\n                    {\n                        prefixIcon: 'e-image-icon', text: l10n.getConstant('Image'),\n                        id: id + '_', tooltipText: l10n.getConstant('Image'), click: function () {\n                            select('#' + id + '_imageUpload', _this.parent.element).click();\n                        }\n                    }\n                ]\n            },\n            {\n                header: { text: l10n.getConstant('Formulas') }, content: [{\n                        prefixIcon: 'e-insert-function', tooltipText: l10n.getConstant('InsertFunction'),\n                        text: l10n.getConstant('InsertFunction'), id: id + '_insert_function'\n                    }]\n            },\n            {\n                header: { text: l10n.getConstant('Data') }, content: [\n                    {\n                        prefixIcon: 'e-protect-icon', text: l10n.getConstant('ProtectSheet'), id: id + '_protect',\n                        tooltipText: l10n.getConstant('ProtectSheet')\n                    }, { type: 'Separator', id: id + '_separator_8' },\n                    {\n                        template: this.datavalidationDDB(id), tooltipText: l10n.getConstant('DataValidation'),\n                        id: id + '_datavalidation'\n                    }\n                ]\n            },\n            {\n                header: { text: l10n.getConstant('View') }, content: [\n                    {\n                        prefixIcon: 'e-hide-headers', text: this.getLocaleText('Headers'), id: id + '_headers',\n                        tooltipText: this.getLocaleText('Headers')\n                    }, { type: 'Separator', id: id + '_separator_9' },\n                    {\n                        prefixIcon: 'e-hide-gridlines', text: this.getLocaleText('GridLines'), id: id + '_gridlines',\n                        tooltipText: this.getLocaleText('GridLines')\n                    }\n                ]\n            }];\n        if (this.parent.allowConditionalFormat) {\n            items.find(function (x) { return x.header && x.header.text === l10n.getConstant('Home'); }).content.push({ type: 'Separator', id: id + '_separator_10' }, { template: this.getCFDBB(id), tooltipText: l10n.getConstant('ConditionalFormatting'), id: id + '_conditionalformatting' });\n        }\n        if (this.parent.allowChart) {\n            items.find(function (x) { return x.header && x.header.text === l10n.getConstant('Insert'); }).content.push({ type: 'Separator', id: id + '_separator_11' }, {\n                template: this.getChartDBB(id), text: l10n.getConstant('Chart'),\n                tooltipText: l10n.getConstant('Chart'), id: id + '_chart'\n            });\n        }\n        if (this.parent.allowCellFormatting) {\n            items.find(function (x) { return x.header && x.header.text === l10n.getConstant('Home'); }).content.push({ type: 'Separator', id: id + '_separator_12' }, { template: this.getClearDDB(id), tooltipText: l10n.getConstant('Clear'), id: id + '_clear' });\n        }\n        if (this.parent.allowSorting || this.parent.allowFiltering) {\n            items.find(function (x) { return x.header && x.header.text === l10n.getConstant('Home'); }).content.push({ template: this.getSortFilterDDB(id), tooltipText: l10n.getConstant('SortAndFilter'), id: id + '_sorting' });\n        }\n        if (this.parent.allowFindAndReplace) {\n            items.find(function (x) { return x.header && x.header.text === l10n.getConstant('Home'); }).content.push({\n                template: this.getFindDDb(id), prefixIcon: 'e-tbar-search-icon tb-icons',\n                tooltipText: l10n.getConstant('FindReplaceTooltip'), id: id + '_find'\n            });\n        }\n        return items;\n    };\n    Ribbon.prototype.getPasteBtn = function (id) {\n        var _this = this;\n        var btn = this.parent.element.appendChild(this.parent.createElement('button', { id: id + '_paste' }));\n        var l10n = this.parent.serviceLocator.getService(locale);\n        this.pasteSplitBtn = new SplitButton({\n            iconCss: 'e-icons e-paste-icon',\n            items: [\n                { text: l10n.getConstant('All'), id: 'All' },\n                { text: l10n.getConstant('Values'), id: 'Values' },\n                { text: l10n.getConstant('Formats'), id: 'Formats' }\n            ],\n            select: function (args) {\n                _this.parent.notify(paste, { type: args.item.id, isAction: true, isInternal: true });\n            },\n            click: function () {\n                _this.parent.notify(paste, { isAction: true, isInternal: true });\n            },\n            close: function () { _this.parent.element.focus(); }\n        });\n        this.pasteSplitBtn.createElement = this.parent.createElement;\n        this.pasteSplitBtn.appendTo(btn);\n        return btn.parentElement;\n    };\n    Ribbon.prototype.getHyperlinkDlg = function () {\n        var indexes = getRangeIndexes(this.parent.getActiveSheet().activeCell);\n        var row = this.parent.sheets[this.parent.getActiveSheet().id - 1].rows[indexes[0]];\n        var cell;\n        if (!isNullOrUndefined(row)) {\n            cell = row.cells[indexes[1]];\n        }\n        if (isNullOrUndefined(cell)) {\n            setCell(indexes[0], indexes[1], this.parent.getActiveSheet(), cell, false);\n        }\n        if (cell && cell.hyperlink) {\n            this.parent.notify(editHyperlink, null);\n        }\n        else {\n            this.parent.notify(initiateHyperlink, null);\n        }\n    };\n    Ribbon.prototype.getLocaleText = function (str, setClass) {\n        var text;\n        var l10n = this.parent.serviceLocator.getService(locale);\n        var sheet = this.parent.getActiveSheet();\n        if (sheet['show' + str]) {\n            if (setClass) {\n                this.parent.getMainContent().classList.remove('e-hide-' + str.toLowerCase());\n            }\n            text = l10n.getConstant('Hide' + str);\n        }\n        else {\n            if (setClass) {\n                this.parent.getMainContent().classList.add('e-hide-' + str.toLowerCase());\n            }\n            text = l10n.getConstant('Show' + str);\n        }\n        return text;\n    };\n    Ribbon.prototype.getLocaleProtectText = function (str, setClass) {\n        var text;\n        var l10n = this.parent.serviceLocator.getService(locale);\n        var sheet = this.parent.getActiveSheet();\n        if (sheet.isProtected) {\n            if (setClass) {\n                this.parent.getMainContent().classList.remove('e-hide-' + str.toLowerCase());\n            }\n            text = l10n.getConstant('Unprotect' + str);\n        }\n        else {\n            if (setClass) {\n                this.parent.getMainContent().classList.add('e-hide-' + str.toLowerCase());\n            }\n            text = l10n.getConstant('Protect' + str);\n        }\n        return text;\n    };\n    Ribbon.prototype.createRibbon = function (args) {\n        var ribbonElement = this.parent.createElement('div', { id: this.parent.element.id + \"_ribbon\" });\n        this.ribbon = new RibbonComponent({\n            selectedTab: 0,\n            menuItems: this.getRibbonMenuItems(),\n            items: this.getRibbonItems(),\n            fileMenuItemSelect: this.fileMenuItemSelect.bind(this),\n            beforeOpen: this.fileMenuBeforeOpen.bind(this),\n            beforeClose: this.fileMenuBeforeClose.bind(this),\n            clicked: this.toolbarClicked.bind(this),\n            created: this.ribbonCreated.bind(this),\n            selecting: this.tabSelecting.bind(this),\n            expandCollapse: this.expandCollapseHandler.bind(this),\n            beforeFileMenuItemRender: this.beforeRenderHandler.bind(this)\n        });\n        this.ribbon.createElement = this.parent.createElement;\n        if (args && args.uiUpdate) {\n            var refEle = this.parent.element.querySelector('.e-formula-bar-panel') ||\n                document.getElementById(this.parent.element.id + '_sheet_panel');\n            this.parent.element.insertBefore(ribbonElement, refEle);\n        }\n        else {\n            this.parent.element.appendChild(ribbonElement);\n        }\n        this.ribbon.appendTo(ribbonElement);\n    };\n    Ribbon.prototype.tabSelecting = function (args) {\n        if (args.selectingIndex !== this.ribbon.selectedTab) {\n            this.refreshRibbonContent(args.selectingIndex);\n            this.parent.notify(tabSwitch, { activeTab: args.selectingIndex });\n        }\n    };\n    Ribbon.prototype.beforeRenderHandler = function (args) {\n        var l10n = this.parent.serviceLocator.getService(locale);\n        if (args.item.text === l10n.getConstant('Open') && (!this.parent.openUrl || !this.parent.allowOpen)) {\n            args.element.classList.add('e-disabled');\n        }\n        if (args.item.text === l10n.getConstant('SaveAs') && (!this.parent.saveUrl || !this.parent.allowSave)) {\n            args.element.classList.add('e-disabled');\n        }\n    };\n    Ribbon.prototype.getNumFormatDDB = function (id) {\n        var _this = this;\n        var numFormatBtn = this.parent.createElement('button', { id: id + '_number_format' });\n        numFormatBtn.appendChild(this.parent.createElement('span', { className: 'e-tbar-btn-text', innerHTML: 'General' }));\n        this.numFormatDDB = new DropDownButton({\n            items: this.getNumFormatDdbItems(id),\n            content: '',\n            select: function (args) { return _this.numDDBSelect(args); },\n            open: function (args) { return _this.numDDBOpen(args); },\n            beforeItemRender: function (args) { return _this.previewNumFormat(args); },\n            close: function () { return _this.parent.element.focus(); },\n            cssClass: 'e-flat e-numformat-ddb',\n            beforeOpen: function (args) { return _this.tBarDdbBeforeOpen(args.element, args.items); }\n        });\n        this.numFormatDDB.createElement = this.parent.createElement;\n        this.numFormatDDB.appendTo(numFormatBtn);\n        return numFormatBtn;\n    };\n    Ribbon.prototype.getFontSizeDDB = function (id) {\n        var _this = this;\n        this.fontSizeDdb = new DropDownButton({\n            cssClass: 'e-font-size-ddb',\n            content: '11',\n            items: [{ text: '8' }, { text: '9' }, { text: '10' }, { text: '11' }, { text: '12' }, { text: '14' }, { text: '16' },\n                { text: '18' }, { text: '20' }, { text: '22' }, { text: '24' }, { text: '26' }, { text: '28' }, { text: '36' },\n                { text: '48' }, { text: '72' }],\n            beforeOpen: function (args) {\n                _this.tBarDdbBeforeOpen(args.element, args.items);\n                _this.refreshSelected(_this.fontSizeDdb, args.element, 'content', 'text');\n            },\n            select: function (args) {\n                var eventArgs = { style: { fontSize: args.item.text + \"pt\" }, onActionUpdate: true };\n                _this.parent.notify(setCellFormat, eventArgs);\n                if (!eventArgs.cancel) {\n                    _this.fontSizeDdb.content = eventArgs.style.fontSize.split('pt')[0];\n                    _this.fontSizeDdb.dataBind();\n                }\n            },\n            close: function () { return _this.parent.element.focus(); }\n        });\n        this.fontSizeDdb.createElement = this.parent.createElement;\n        this.fontSizeDdb.appendTo(this.parent.createElement('button', { id: id + '_font_size' }));\n        return this.fontSizeDdb.element;\n    };\n    // tslint:disable-next-line:max-func-body-length\n    Ribbon.prototype.getChartDBB = function (id) {\n        var _this = this;\n        var l10n = this.parent.serviceLocator.getService(locale);\n        this.chartMenu = new Menu({\n            cssClass: 'e-chart-menu',\n            items: [\n                {\n                    iconCss: 'e-icons e-column', text: l10n.getConstant('Column'),\n                    items: [{ id: 'column_chart' }]\n                },\n                {\n                    iconCss: 'e-icons e-bar', text: l10n.getConstant('Bar'),\n                    items: [{ id: 'bar_chart' }]\n                },\n                {\n                    iconCss: 'e-icons e-area', text: l10n.getConstant('Area'),\n                    items: [{ id: 'area_chart' }]\n                },\n                {\n                    iconCss: 'e-icons e-pie-doughnut', text: l10n.getConstant('PieAndDoughnut'),\n                    items: [{ id: 'pie_doughnut_chart' }]\n                },\n                {\n                    iconCss: 'e-icons e-line', text: l10n.getConstant('Line'),\n                    items: [{ id: 'line_chart' }]\n                },\n                // {\n                //     iconCss: 'e-icons e-radar', text: l10n.getConstant('Radar'),\n                //     items: [{ id: 'radar_chart' }]\n                // },\n                {\n                    iconCss: 'e-icons e-scatter', text: l10n.getConstant('Scatter'),\n                    items: [{ id: 'scatter_chart' }]\n                }\n            ],\n            orientation: 'Vertical',\n            beforeOpen: function (args) {\n                if (args.parentItem.text === l10n.getConstant('Column')) {\n                    args.element.firstChild.appendChild(column);\n                    args.element.parentElement.classList.add('e-column-chart');\n                }\n                else if (args.parentItem.text === l10n.getConstant('Bar')) {\n                    args.element.firstChild.appendChild(bar);\n                    args.element.parentElement.classList.add('e-bar-chart');\n                }\n                else if (args.parentItem.text === l10n.getConstant('Area')) {\n                    args.element.firstChild.appendChild(area);\n                    args.element.parentElement.classList.add('e-area-chart');\n                }\n                else if (args.parentItem.text === l10n.getConstant('Line')) {\n                    args.element.firstChild.appendChild(line);\n                    args.element.parentElement.classList.add('e-line-chart');\n                }\n                else if (args.parentItem.text === l10n.getConstant('PieAndDoughnut')) {\n                    args.element.firstChild.appendChild(pie);\n                    args.element.parentElement.classList.add('e-pie-doughnut-chart');\n                }\n                else if (args.parentItem.text === l10n.getConstant('Radar')) {\n                    args.element.firstChild.appendChild(radar);\n                    args.element.parentElement.classList.add('e-radar-chart');\n                }\n                else if (args.parentItem.text === l10n.getConstant('Scatter')) {\n                    args.element.firstChild.appendChild(scatter);\n                    args.element.parentElement.classList.add('e-scatter-chart');\n                }\n            },\n            select: this.chartSelected.bind(this)\n        });\n        this.chartMenu.createElement = this.parent.createElement;\n        var column = this.parent.createElement('div', { id: 'column_main', className: 'e-column-main' });\n        var column1Text = this.parent.createElement('div', { id: 'column1_text', className: 'e-column1-text', innerHTML: l10n.getConstant('Column') });\n        var column1Cont = this.parent.createElement('div', { id: 'column1_cont', className: 'e-column1-cont' });\n        var column2Text = this.parent.createElement('div', { id: 'column2_text', className: 'e-column2-text' });\n        var column2Cont = this.parent.createElement('div', { id: 'column2_cont', className: 'e-column2-cont' });\n        column.appendChild(column1Text);\n        column.appendChild(column1Cont);\n        //column.appendChild(column2Text);\n        //column.appendChild(column2Cont);\n        var clusteredColumn = this.parent.createElement('span', { id: 'clusteredColumn', className: 'e-clusteredcolumn e-column-icon e-menu-icon e-icons' });\n        var stackedColumn = this.parent.createElement('span', {\n            id: 'stackedColumn', className: 'e-stackedcolumn e-column-icon e-menu-icon e-icons'\n        });\n        var stackedColumn100 = this.parent.createElement('span', {\n            id: 'stackedColumn100', className: 'e-stackedcolumn100 e-column-icon e-menu-icon e-icons'\n        });\n        var clusteredColumn3D = this.parent.createElement('span', {\n            id: 'clusteredColumn3D', className: 'e-clusteredColumn3D e-column-icon'\n        });\n        var stackedColumn3D = this.parent.createElement('span', { id: 'stackedColumn3D', className: 'e-stackedColumn3D e-column-icon' });\n        var stackedColumn1003D = this.parent.createElement('span', { id: 'stackedColumn1003D', className: 'e-stackedColumn1003D e-column-icon' });\n        clusteredColumn.title = l10n.getConstant('ClusteredColumn');\n        stackedColumn.title = l10n.getConstant('StackedColumn');\n        stackedColumn100.title = l10n.getConstant('StackedColumn100');\n        stackedColumn1003D.title = l10n.getConstant('OrangeDataBar');\n        stackedColumn3D.title = l10n.getConstant('LightblueDataBar');\n        clusteredColumn3D.title = l10n.getConstant('PurpleDataBar');\n        column1Cont.appendChild(clusteredColumn);\n        column1Cont.appendChild(stackedColumn);\n        column1Cont.appendChild(stackedColumn100);\n        column2Cont.appendChild(clusteredColumn3D);\n        column2Cont.appendChild(stackedColumn3D);\n        column2Cont.appendChild(stackedColumn1003D);\n        var bar = this.parent.createElement('div', { id: 'bar_main', className: 'e-bar-main' });\n        var bar1Text = this.parent.createElement('div', { id: 'bar1_text', className: 'e-bar1-text', innerHTML: l10n.getConstant('Bar') });\n        var bar1Cont = this.parent.createElement('div', { id: 'bar1_cont', className: 'e-bar1-cont' });\n        var bar2Text = this.parent.createElement('div', { id: 'bar2_text', className: 'e-bar2-text' });\n        var bar2Cont = this.parent.createElement('div', { id: 'bar2_cont', className: 'e-bar2-cont' });\n        bar.appendChild(bar1Text);\n        bar.appendChild(bar1Cont);\n        //bar.appendChild(bar2Text);\n        //bar.appendChild(bar2Cont);\n        var clusteredBar = this.parent.createElement('span', { id: 'clusteredBar', className: 'e-clusteredbar e-bar-icon e-menu-icon e-icons' });\n        var stackedBar = this.parent.createElement('span', { id: 'stackedBar', className: 'e-stackedbar e-bar-icon e-menu-icon e-icons' });\n        var stackedBar100 = this.parent.createElement('span', { id: 'stackedBar100', className: 'e-stackedbar100 e-bar-icon e-menu-icon e-icons' });\n        var clusteredBar3D = this.parent.createElement('span', { id: 'clusteredBar3D', className: 'e-clusteredBar3D e-bar-icon' });\n        var stackedBar3D = this.parent.createElement('span', { id: 'stackedBar3D', className: 'e-stackedBar3D e-bar-icon' });\n        var stackedBar1003D = this.parent.createElement('span', { id: 'stackedBar1003D', className: 'e-stackedBar1003D e-bar-icon' });\n        clusteredBar.title = l10n.getConstant('ClusteredBar');\n        stackedBar.title = l10n.getConstant('StackedBar');\n        stackedBar100.title = l10n.getConstant('StackedBar100');\n        stackedBar1003D.title = l10n.getConstant('OrangeDataBar');\n        stackedBar3D.title = l10n.getConstant('LightblueDataBar');\n        clusteredBar3D.title = l10n.getConstant('PurpleDataBar');\n        bar1Cont.appendChild(clusteredBar);\n        bar1Cont.appendChild(stackedBar);\n        bar1Cont.appendChild(stackedBar100);\n        bar2Cont.appendChild(clusteredBar3D);\n        bar2Cont.appendChild(stackedBar3D);\n        bar2Cont.appendChild(stackedBar1003D);\n        var area = this.parent.createElement('div', { id: 'area_main', className: 'e-area-main' });\n        var areaText = this.parent.createElement('div', { id: 'area_text', className: 'e-area-text', innerHTML: l10n.getConstant('Area') });\n        var areaCont = this.parent.createElement('div', { id: 'area_cont', className: 'e-area-cont' });\n        area.appendChild(areaText);\n        area.appendChild(areaCont);\n        var defArea = this.parent.createElement('span', { id: 'area', className: 'e-area e-area-icon e-menu-icon e-icons' });\n        var stackedArea = this.parent.createElement('span', { id: 'stackedArea', className: 'e-stackedarea e-area-icon e-menu-icon e-icons' });\n        var stackedArea100 = this.parent.createElement('span', { id: 'stackedArea100', className: 'e-stackedarea100 e-area-icon e-menu-icon e-icons' });\n        defArea.title = l10n.getConstant('Area');\n        stackedArea.title = l10n.getConstant('StackedArea');\n        stackedArea100.title = l10n.getConstant('StackedArea100');\n        areaCont.appendChild(defArea);\n        areaCont.appendChild(stackedArea);\n        areaCont.appendChild(stackedArea100);\n        var line = this.parent.createElement('div', { id: 'line_main', className: 'e-line-main' });\n        var lineText = this.parent.createElement('div', { id: 'line_text', className: 'e-line-text', innerHTML: l10n.getConstant('Line') });\n        var lineCont = this.parent.createElement('div', { id: 'line_cont', className: 'e-line-cont' });\n        line.appendChild(lineText);\n        line.appendChild(lineCont);\n        var defLine = this.parent.createElement('span', { id: 'line', className: 'e-line e-line-icon e-menu-icon e-icons' });\n        var stackedLine = this.parent.createElement('span', { id: 'stackedLine', className: 'e-stackedline e-line-icon e-menu-icon e-icons' });\n        var stackedLine100 = this.parent.createElement('span', {\n            id: 'stackedline100', className: 'e-stackedline100 e-line-icon e-menu-icon e-icons'\n        });\n        defLine.title = l10n.getConstant('Line');\n        stackedLine.title = l10n.getConstant('StackedLine');\n        stackedLine100.title = l10n.getConstant('StackedLine100');\n        lineCont.appendChild(defLine);\n        lineCont.appendChild(stackedLine);\n        lineCont.appendChild(stackedLine100);\n        var pie = this.parent.createElement('div', { id: 'pie_main', className: 'e-pie-main' });\n        var pieText = this.parent.createElement('div', { id: 'pie_text', className: 'e-pie-text', innerHTML: l10n.getConstant('Pie') });\n        var pieCont = this.parent.createElement('div', { id: 'pie_cont', className: 'e-pie-cont' });\n        pie.appendChild(pieText);\n        pie.appendChild(pieCont);\n        var defPie = this.parent.createElement('span', { id: 'pie', className: 'e-pie e-pie-icon e-menu-icon e-icons' });\n        var doughnut = this.parent.createElement('span', { id: 'doughnut', className: 'e-doughnut e-pie-icon e-menu-icon e-icons' });\n        defPie.title = l10n.getConstant('Pie');\n        doughnut.title = l10n.getConstant('Doughnut');\n        pieCont.appendChild(defPie);\n        pieCont.appendChild(doughnut);\n        var radar = this.parent.createElement('div', { id: 'radar_main', className: 'e-radar-main' });\n        var radarText = this.parent.createElement('div', { id: 'radar_text', className: 'e-radar-text', innerHTML: 'Radar' });\n        var radarCont = this.parent.createElement('div', { id: 'radar_cont', className: 'e-radar-cont' });\n        radar.appendChild(radarText);\n        radar.appendChild(radarCont);\n        var defradar = this.parent.createElement('span', { id: 'radar', className: 'e-radar e-radar-icon e-menu-icon e-icons' });\n        var radarMarkers = this.parent.createElement('span', { id: 'radar_markers', className: 'e-radar-markers e-radar-icon e-menu-icon e-icons' });\n        defradar.title = l10n.getConstant('BlueDataBar');\n        radarMarkers.title = l10n.getConstant('GreenDataBar');\n        radarCont.appendChild(defradar);\n        radarCont.appendChild(radarMarkers);\n        var scatter = this.parent.createElement('div', { id: 'scatter_main', className: 'e-scatter-main' });\n        var scatterText = this.parent.createElement('div', { id: 'scatter_text', className: 'e-scatter-text', innerHTML: l10n.getConstant('Scatter') });\n        var scatterCont = this.parent.createElement('div', { id: 'scatter_cont', className: 'e-scatter-cont' });\n        scatter.appendChild(scatterText);\n        scatter.appendChild(scatterCont);\n        var defscatter = this.parent.createElement('span', { id: 'scatter', className: 'e-scatter e-scatter-icon e-menu-icon e-icons' });\n        defscatter.title = l10n.getConstant('Scatter');\n        scatterCont.appendChild(defscatter);\n        var ul = this.parent.element.appendChild(this.parent.createElement('ul', {\n            id: id + '_chart_menu', styles: 'display: none;'\n        }));\n        this.chartMenu.appendTo(ul);\n        ul.classList.add('e-ul');\n        this.chartDdb = new DropDownButton({\n            iconCss: 'e-icons e-chart-icon',\n            cssClass: 'e-chart-ddb',\n            target: this.chartMenu.element.parentElement,\n            created: function () { _this.chartMenu.element.style.display = ''; },\n            beforeClose: function (args) {\n                if (args.event && closest(args.event.target, '.e-chart-ddb')) {\n                    args.cancel = true;\n                }\n            },\n            close: function () { return _this.parent.element.focus(); }\n        });\n        this.chartDdb.createElement = this.parent.createElement;\n        var chartBtn = this.parent.createElement('button', { id: id + '_chart-btn' });\n        chartBtn.appendChild(this.parent.createElement('span', { id: id + '_chart', innerHTML: 'Chart' }));\n        this.chartDdb.appendTo(chartBtn);\n        return this.chartDdb.element;\n    };\n    // tslint:disable-next-line:max-func-body-length\n    Ribbon.prototype.getCFDBB = function (id) {\n        var _this = this;\n        var l10n = this.parent.serviceLocator.getService(locale);\n        this.cFMenu = new Menu({\n            cssClass: 'e-cf-menu',\n            items: [{\n                    iconCss: 'e-icons e-hlcellrules', text: l10n.getConstant('HighlightCellsRules'),\n                    items: [{ iconCss: 'e-icons e-greaterthan', id: 'cf_greaterthan', text: l10n.getConstant('GreaterThan') + '...' },\n                        { iconCss: 'e-icons e-lessthan', id: 'cf_lessthan', text: l10n.getConstant('LessThan') + '...' },\n                        { iconCss: 'e-icons e-between', id: 'cf_between', text: l10n.getConstant('Between') + '...' },\n                        { iconCss: 'e-icons e-equalto', id: 'cf_eqaulto', text: l10n.getConstant('CFEqualTo') + '...' }, {\n                            iconCss: 'e-icons e-textcontains', id: 'cf_textthatcontains',\n                            text: l10n.getConstant('TextThatContains') + '...'\n                        }, { iconCss: 'e-icons e-adateoccuring', id: 'cf_adateoccuring', text: l10n.getConstant('ADateOccuring') + '...' }, {\n                            iconCss: 'e-icons e-duplicate', id: 'cf_duplicatevalues',\n                            text: l10n.getConstant('DuplicateValues') + '...'\n                        }]\n                },\n                {\n                    iconCss: 'e-icons e-topbottomrules', text: l10n.getConstant('TopBottomRules'),\n                    items: [{ iconCss: 'e-icons e-top10items', id: 'cf_top10items', text: l10n.getConstant('Top10Items') + '...' },\n                        { iconCss: 'e-icons e-top10', id: 'cf_top10', text: l10n.getConstant('Top10') + ' %...' },\n                        { iconCss: 'e-icons e-bottom10items', id: 'cf_bottom10items', text: l10n.getConstant('Bottom10Items') + '...' },\n                        { iconCss: 'e-icons e-bottom10', id: 'cf_bottom10', text: l10n.getConstant('Bottom10') + ' %...' },\n                        { iconCss: 'e-icons e-aboveaverage', id: 'cf_aboveaverage', text: l10n.getConstant('AboveAverage') + '...' },\n                        { iconCss: 'e-icons e-belowaverage', id: 'cf_belowaverage', text: l10n.getConstant('BelowAverage') + '...' }]\n                },\n                {\n                    iconCss: 'e-icons e-databars', text: l10n.getConstant('DataBars'),\n                    items: [{ id: 'cf_databars' }]\n                },\n                {\n                    iconCss: 'e-icons e-colorscales', text: l10n.getConstant('ColorScales'),\n                    items: [{ id: 'cf_colorscales' }]\n                },\n                {\n                    iconCss: 'e-icons e-iconsets', text: l10n.getConstant('IconSets'),\n                    items: [{ id: 'cf_iconsets' }]\n                },\n                {\n                    iconCss: 'e-icons e-clearrules', text: l10n.getConstant('ClearRules'),\n                    items: [{ id: 'cf_cr_cells', text: l10n.getConstant('SelectedCells') },\n                        { id: 'cf_cr_sheet', text: l10n.getConstant('EntireSheet') }]\n                }],\n            orientation: 'Vertical',\n            beforeOpen: function (args) {\n                if (args.parentItem.text === l10n.getConstant('DataBars')) {\n                    args.element.firstChild.appendChild(dataBars);\n                    args.element.parentElement.classList.add('e-databars');\n                }\n                else if (args.parentItem.text === l10n.getConstant('ColorScales')) {\n                    args.element.firstChild.appendChild(colorScales);\n                    args.element.parentElement.classList.add('e-colorscales');\n                }\n                else if (args.parentItem.text === l10n.getConstant('IconSets')) {\n                    args.element.firstChild.appendChild(iconSets);\n                    args.element.parentElement.classList.add('e-iconsets');\n                }\n            },\n            select: this.cFSelected.bind(this)\n        });\n        var dataBars = this.parent.createElement('div', { id: 'db', className: 'e-db' });\n        var db1 = this.parent.createElement('div', { id: 'db1', className: 'e-db1' });\n        var db2 = this.parent.createElement('div', { id: 'db2', className: 'e-db2' });\n        dataBars.appendChild(db1);\n        dataBars.appendChild(db2);\n        var bBar = this.parent.createElement('span', { id: 'BlueDataBar', className: 'e-bdatabar e-databar-icon' });\n        var gBar = this.parent.createElement('span', { id: 'GreenDataBar', className: 'e-gdatabar e-databar-icon' });\n        var rBar = this.parent.createElement('span', { id: 'RedDataBar', className: 'e-rdatabar e-databar-icon' });\n        var oBar = this.parent.createElement('span', { id: 'OrangeDataBar', className: 'e-odatabar e-databar-icon' });\n        var lBBar = this.parent.createElement('span', { id: 'LightBlueDataBar', className: 'e-lbdatabar e-databar-icon' });\n        var pBar = this.parent.createElement('span', { id: 'PurpleDataBar', className: 'e-pdatabar e-databar-icon' });\n        bBar.title = l10n.getConstant('BlueDataBar');\n        gBar.title = l10n.getConstant('GreenDataBar');\n        rBar.title = l10n.getConstant('RedDataBar');\n        oBar.title = l10n.getConstant('OrangeDataBar');\n        lBBar.title = l10n.getConstant('LightblueDataBar');\n        pBar.title = l10n.getConstant('PurpleDataBar');\n        db1.appendChild(bBar);\n        db1.appendChild(gBar);\n        db1.appendChild(rBar);\n        db2.appendChild(oBar);\n        db2.appendChild(lBBar);\n        db2.appendChild(pBar);\n        this.cFMenu.createElement = this.parent.createElement;\n        var colorScales = this.parent.createElement('div', { id: 'db', className: 'e-cs' });\n        var cs1 = this.parent.createElement('div', { id: 'cs1', className: 'e-cs1' });\n        var cs2 = this.parent.createElement('div', { id: 'cs2', className: 'e-cs2' });\n        var cs3 = this.parent.createElement('div', { id: 'cs3', className: 'e-cs3' });\n        colorScales.appendChild(cs1);\n        colorScales.appendChild(cs2);\n        colorScales.appendChild(cs3);\n        var gyr = this.parent.createElement('span', { id: 'GYRColorScale', className: 'e-gyr e-colorscale-icon' });\n        var ryg = this.parent.createElement('span', { id: 'RYGColorScale', className: 'e-ryg e-colorscale-icon' });\n        var gwr = this.parent.createElement('span', { id: 'GWRColorScale', className: 'e-gwr e-colorscale-icon' });\n        var rwg = this.parent.createElement('span', { id: 'RWGColorScale', className: 'e-rwg e-colorscale-icon' });\n        var bwr = this.parent.createElement('span', { id: 'BWRColorScale', className: 'e-bwr e-colorscale-icon' });\n        var rwb = this.parent.createElement('span', { id: 'RWBColorScale', className: 'e-rwb e-colorscale-icon' });\n        var wr = this.parent.createElement('span', { id: 'WRColorScale', className: 'e-wr e-colorscale-icon' });\n        var rw = this.parent.createElement('span', { id: 'RWColorScale', className: 'e-rw e-colorscale-icon' });\n        var gw = this.parent.createElement('span', { id: 'GWColorScale', className: 'e-gw e-colorscale-icon' });\n        var wg = this.parent.createElement('span', { id: 'WGColorScale', className: 'e-wg e-colorscale-icon' });\n        var gy = this.parent.createElement('span', { id: 'GYColorScale', className: 'e-gy e-colorscale-icon' });\n        var yg = this.parent.createElement('span', { id: 'YGColorScale', className: 'e-yg e-colorscale-icon' });\n        gyr.title = l10n.getConstant('GYRColorScale');\n        ryg.title = l10n.getConstant('RYGColorScale');\n        gwr.title = l10n.getConstant('GWRColorScale');\n        rwg.title = l10n.getConstant('RWGColorScale');\n        bwr.title = l10n.getConstant('BWRColorScale');\n        rwb.title = l10n.getConstant('RWBColorScale');\n        wr.title = l10n.getConstant('WRColorScale');\n        rw.title = l10n.getConstant('RWColorScale');\n        gw.title = l10n.getConstant('GWColorScale');\n        wg.title = l10n.getConstant('WGColorScale');\n        gy.title = l10n.getConstant('GYColorScale');\n        yg.title = l10n.getConstant('YGColorScale');\n        cs1.appendChild(gyr);\n        cs1.appendChild(ryg);\n        cs1.appendChild(gwr);\n        cs1.appendChild(rwg);\n        cs2.appendChild(bwr);\n        cs2.appendChild(rwb);\n        cs2.appendChild(wr);\n        cs2.appendChild(rw);\n        cs3.appendChild(gw);\n        cs3.appendChild(wg);\n        cs3.appendChild(gy);\n        cs3.appendChild(yg);\n        var iconSets = this.parent.createElement('div', { id: 'is', className: 'e-is' });\n        var is1 = this.parent.createElement('div', { id: 'is1', className: 'e-is1', innerHTML: 'Directional' });\n        var is2 = this.parent.createElement('div', { id: 'is2', className: 'e-is2' });\n        var is3 = this.parent.createElement('div', { id: 'is3', className: 'e-is3', innerHTML: 'Shapes' });\n        var is4 = this.parent.createElement('div', { id: 'is4', className: 'e-is4' });\n        var is5 = this.parent.createElement('div', { id: 'is5', className: 'e-is5', innerHTML: 'Indicators' });\n        var is6 = this.parent.createElement('div', { id: 'is6', className: 'e-is6' });\n        var is7 = this.parent.createElement('div', { id: 'is7', className: 'e-is7', innerHTML: 'Ratings' });\n        var is8 = this.parent.createElement('div', { id: 'is8', className: 'e-is8' });\n        is1.title = l10n.getConstant('GYColorScale');\n        is2.title = l10n.getConstant('YGColorScale');\n        is3.title = l10n.getConstant('GYColorScale');\n        is4.title = l10n.getConstant('YGColorScale');\n        is5.title = l10n.getConstant('GYColorScale');\n        is6.title = l10n.getConstant('YGColorScale');\n        is7.title = l10n.getConstant('GYColorScale');\n        is8.title = l10n.getConstant('YGColorScale');\n        iconSets.appendChild(is1);\n        iconSets.appendChild(is2);\n        iconSets.appendChild(is3);\n        iconSets.appendChild(is4);\n        iconSets.appendChild(is5);\n        iconSets.appendChild(is6);\n        iconSets.appendChild(is7);\n        iconSets.appendChild(is8);\n        var directional1 = this.parent.createElement('div', { id: 'ThreeArrows', className: 'e-3arrows e-is-wrapper' });\n        var directional2 = this.parent.createElement('div', { id: 'ThreeArrowsGray', className: 'e-3arrowsgray e-is-wrapper' });\n        var directional3 = this.parent.createElement('div', { id: 'ThreeTriangles', className: 'e-3triangles e-is-wrapper' });\n        var directional4 = this.parent.createElement('div', { id: 'FourArrowsGray', className: 'e-4arrowsgray e-is-wrapper' });\n        var directional5 = this.parent.createElement('div', { id: 'FourArrows', className: 'e-4arrows e-is-wrapper' });\n        var directional6 = this.parent.createElement('div', { id: 'FiveArrowsGray', className: 'e-5arrowsgray e-is-wrapper' });\n        var directional7 = this.parent.createElement('div', { id: 'FiveArrows', className: 'e-5arrows e-is-wrapper' });\n        directional1.title = l10n.getConstant('ThreeArrowsColor');\n        directional2.title = l10n.getConstant('ThreeArrowsGray');\n        directional3.title = l10n.getConstant('ThreeTriangles');\n        directional4.title = l10n.getConstant('FourArrowsColor');\n        directional5.title = l10n.getConstant('FourArrowsGray');\n        directional6.title = l10n.getConstant('FiveArrowsColor');\n        directional7.title = l10n.getConstant('FiveArrowsGray');\n        is2.appendChild(directional1);\n        is2.appendChild(directional2);\n        is2.appendChild(directional3);\n        is2.appendChild(directional4);\n        is2.appendChild(directional5);\n        is2.appendChild(directional6);\n        is2.appendChild(directional7);\n        var shapes1 = this.parent.createElement('div', { id: 'ThreeTrafficLights1', className: 'e-3trafficlights e-is-wrapper' });\n        var shapes2 = this.parent.createElement('div', { id: 'ThreeTrafficLights2', className: 'e-3rafficlights2 e-is-wrapper' });\n        var shapes3 = this.parent.createElement('div', { id: 'ThreeSigns', className: 'e-3signs e-is-wrapper' });\n        var shapes4 = this.parent.createElement('div', { id: 'FourTrafficLights', className: 'e-4trafficlights e-is-wrapper' });\n        var shapes5 = this.parent.createElement('div', { id: 'FourRedToBlack', className: 'e-4redtoblack e-is-wrapper' });\n        shapes1.title = l10n.getConstant('ThreeTrafficLights1');\n        shapes2.title = l10n.getConstant('ThreeTrafficLights2');\n        shapes3.title = l10n.getConstant('ThreeSigns');\n        shapes4.title = l10n.getConstant('FourTrafficLights');\n        shapes5.title = l10n.getConstant('RedToBlack');\n        is4.appendChild(shapes1);\n        is4.appendChild(shapes2);\n        is4.appendChild(shapes3);\n        is4.appendChild(shapes4);\n        is4.appendChild(shapes5);\n        var indicators1 = this.parent.createElement('div', { id: 'ThreeSymbols', className: 'e-3symbols e-is-wrapper' });\n        var indicators2 = this.parent.createElement('div', { id: 'ThreeSymbols2', className: 'e-3symbols2 e-is-wrapper' });\n        var indicators3 = this.parent.createElement('div', { id: 'ThreeFlags', className: 'e-3flags e-is-wrapper' });\n        indicators1.title = l10n.getConstant('ThreeSymbols1');\n        indicators2.title = l10n.getConstant('ThreeSymbols2');\n        indicators3.title = l10n.getConstant('ThreeFlags');\n        is6.appendChild(indicators1);\n        is6.appendChild(indicators2);\n        is6.appendChild(indicators3);\n        var ratings1 = this.parent.createElement('div', { id: 'ThreeStars', className: 'e-3stars e-is-wrapper' });\n        var ratings2 = this.parent.createElement('div', { id: 'FourRating', className: 'e-4rating e-is-wrapper' });\n        var ratings3 = this.parent.createElement('div', { id: 'FiveQuarters', className: 'e-5quarters e-is-wrapper' });\n        var ratings4 = this.parent.createElement('div', { id: 'FiveRating', className: 'e-5rating e-is-wrapper' });\n        var ratings5 = this.parent.createElement('div', { id: 'FiveBoxes', className: 'e-5boxes e-is-wrapper' });\n        ratings1.title = l10n.getConstant('ThreeStars');\n        ratings2.title = l10n.getConstant('FourRatings');\n        ratings3.title = l10n.getConstant('FiveQuarters');\n        ratings4.title = l10n.getConstant('FiveRatings');\n        ratings5.title = l10n.getConstant('FiveBoxes');\n        is8.appendChild(ratings1);\n        is8.appendChild(ratings2);\n        is8.appendChild(ratings3);\n        is8.appendChild(ratings4);\n        is8.appendChild(ratings5);\n        directional1.appendChild(this.createElement('span', 'e-3arrows-1 e-iconsetspan'));\n        directional1.appendChild(this.createElement('span', 'e-3arrows-2 e-iconsetspan'));\n        directional1.appendChild(this.createElement('span', 'e-3arrows-3 e-iconsetspan'));\n        directional2.appendChild(this.createElement('span', 'e-3arrowsgray-1 e-iconsetspan'));\n        directional2.appendChild(this.createElement('span', 'e-3arrowsgray-2 e-iconsetspan'));\n        directional2.appendChild(this.createElement('span', 'e-3arrowsgray-3 e-iconsetspan'));\n        directional3.appendChild(this.createElement('span', 'e-3triangles-1 e-iconsetspan'));\n        directional3.appendChild(this.createElement('span', 'e-3triangles-2 e-iconsetspan'));\n        directional3.appendChild(this.createElement('span', 'e-3triangles-3 e-iconsetspan'));\n        directional4.appendChild(this.createElement('span', 'e-4arrowsgray-1 e-iconsetspan'));\n        directional4.appendChild(this.createElement('span', 'e-4arrowsgray-2 e-iconsetspan'));\n        directional4.appendChild(this.createElement('span', 'e-4arrowsgray-3 e-iconsetspan'));\n        directional4.appendChild(this.createElement('span', 'e-4arrowsgray-4 e-iconsetspan'));\n        directional5.appendChild(this.createElement('span', 'e-4arrows-1 e-iconsetspan'));\n        directional5.appendChild(this.createElement('span', 'e-4arrows-2 e-iconsetspan'));\n        directional5.appendChild(this.createElement('span', 'e-4arrows-3 e-iconsetspan'));\n        directional5.appendChild(this.createElement('span', 'e-4arrows-4 e-iconsetspan'));\n        directional6.appendChild(this.createElement('span', 'e-5arrowsgray-1 e-iconsetspan'));\n        directional6.appendChild(this.createElement('span', 'e-5arrowsgray-2 e-iconsetspan'));\n        directional6.appendChild(this.createElement('span', 'e-5arrowsgray-3 e-iconsetspan'));\n        directional6.appendChild(this.createElement('span', 'e-5arrowsgray-4 e-iconsetspan'));\n        directional6.appendChild(this.createElement('span', 'e-5arrowsgray-5 e-iconsetspan'));\n        directional7.appendChild(this.createElement('span', 'e-5arrows-1 e-iconsetspan'));\n        directional7.appendChild(this.createElement('span', 'e-5arrows-2 e-iconsetspan'));\n        directional7.appendChild(this.createElement('span', 'e-5arrows-3 e-iconsetspan'));\n        directional7.appendChild(this.createElement('span', 'e-5arrows-4 e-iconsetspan'));\n        directional7.appendChild(this.createElement('span', 'e-5arrows-5 e-iconsetspan'));\n        shapes1.appendChild(this.createElement('span', 'e-3trafficlights-1 e-iconsetspan'));\n        shapes1.appendChild(this.createElement('span', 'e-3trafficlights-2 e-iconsetspan'));\n        shapes1.appendChild(this.createElement('span', 'e-3trafficlights-3 e-iconsetspan'));\n        shapes2.appendChild(this.createElement('span', 'e-3rafficlights2-1 e-iconsetspan'));\n        shapes2.appendChild(this.createElement('span', 'e-3rafficlights2-2 e-iconsetspan'));\n        shapes2.appendChild(this.createElement('span', 'e-3rafficlights2-3 e-iconsetspan'));\n        shapes3.appendChild(this.createElement('span', 'e-3signs-1 e-iconsetspan'));\n        shapes3.appendChild(this.createElement('span', 'e-3signs-2 e-iconsetspan'));\n        shapes3.appendChild(this.createElement('span', 'e-3signs-3 e-iconsetspan'));\n        shapes4.appendChild(this.createElement('span', 'e-4trafficlights-1 e-iconsetspan'));\n        shapes4.appendChild(this.createElement('span', 'e-4trafficlights-2 e-iconsetspan'));\n        shapes4.appendChild(this.createElement('span', 'e-4trafficlights-3 e-iconsetspan'));\n        shapes4.appendChild(this.createElement('span', 'e-4trafficlights-4 e-iconsetspan'));\n        shapes5.appendChild(this.createElement('span', 'e-4redtoblack-1 e-iconsetspan'));\n        shapes5.appendChild(this.createElement('span', 'e-4redtoblack-2 e-iconsetspan'));\n        shapes5.appendChild(this.createElement('span', 'e-4redtoblack-3 e-iconsetspan'));\n        shapes5.appendChild(this.createElement('span', 'e-4redtoblack-4 e-iconsetspan'));\n        indicators1.appendChild(this.createElement('span', 'e-3symbols-1 e-iconsetspan'));\n        indicators1.appendChild(this.createElement('span', 'e-3symbols-2 e-iconsetspan'));\n        indicators1.appendChild(this.createElement('span', 'e-3symbols-3 e-iconsetspan'));\n        indicators2.appendChild(this.createElement('span', 'e-3symbols2-1 e-iconsetspan'));\n        indicators2.appendChild(this.createElement('span', 'e-3symbols2-2 e-iconsetspan'));\n        indicators2.appendChild(this.createElement('span', 'e-3symbols2-3 e-iconsetspan'));\n        indicators3.appendChild(this.createElement('span', 'e-3flags-1 e-iconsetspan'));\n        indicators3.appendChild(this.createElement('span', 'e-3flags-2 e-iconsetspan'));\n        indicators3.appendChild(this.createElement('span', 'e-3flags-3 e-iconsetspan'));\n        ratings1.appendChild(this.createElement('span', 'e-3stars-1 e-iconsetspan'));\n        ratings1.appendChild(this.createElement('span', 'e-3stars-2 e-iconsetspan'));\n        ratings1.appendChild(this.createElement('span', 'e-3stars-3 e-iconsetspan'));\n        ratings2.appendChild(this.createElement('span', 'e-4rating-1 e-iconsetspan'));\n        ratings2.appendChild(this.createElement('span', 'e-4rating-2 e-iconsetspan'));\n        ratings2.appendChild(this.createElement('span', 'e-4rating-3 e-iconsetspan'));\n        ratings2.appendChild(this.createElement('span', 'e-4rating-4 e-iconsetspan'));\n        ratings3.appendChild(this.createElement('span', 'e-5quarters-1 e-iconsetspan'));\n        ratings3.appendChild(this.createElement('span', 'e-5quarters-2 e-iconsetspan'));\n        ratings3.appendChild(this.createElement('span', 'e-5quarters-3 e-iconsetspan'));\n        ratings3.appendChild(this.createElement('span', 'e-5quarters-4 e-iconsetspan'));\n        ratings3.appendChild(this.createElement('span', 'e-5quarters-5 e-iconsetspan'));\n        ratings4.appendChild(this.createElement('span', 'e-5rating-1 e-iconsetspan'));\n        ratings4.appendChild(this.createElement('span', 'e-5rating-2 e-iconsetspan'));\n        ratings4.appendChild(this.createElement('span', 'e-5rating-3 e-iconsetspan'));\n        ratings4.appendChild(this.createElement('span', 'e-5rating-4 e-iconsetspan'));\n        ratings4.appendChild(this.createElement('span', 'e-5rating-5 e-iconsetspan'));\n        ratings5.appendChild(this.createElement('span', 'e-5boxes-1 e-iconsetspan'));\n        ratings5.appendChild(this.createElement('span', 'e-5boxes-2 e-iconsetspan'));\n        ratings5.appendChild(this.createElement('span', 'e-5boxes-3 e-iconsetspan'));\n        ratings5.appendChild(this.createElement('span', 'e-5boxes-4 e-iconsetspan'));\n        ratings5.appendChild(this.createElement('span', 'e-5boxes-5 e-iconsetspan'));\n        var ul = this.parent.element.appendChild(this.parent.createElement('ul', {\n            id: id + '_cf_menu', styles: 'display: none;'\n        }));\n        this.cFMenu.appendTo(ul);\n        ul.classList.add('e-ul');\n        this.cFDdb = new DropDownButton({\n            iconCss: 'e-icons e-conditionalformatting-icon',\n            cssClass: 'e-cf-ddb',\n            target: this.cFMenu.element.parentElement,\n            created: function () { _this.cFMenu.element.style.display = ''; },\n            beforeClose: function (args) {\n                if (args.event && closest(args.event.target, '.e-cf-ddb')) {\n                    args.cancel = true;\n                }\n            },\n            close: function () { return _this.parent.element.focus(); }\n        });\n        this.cFDdb.createElement = this.parent.createElement;\n        this.cFDdb.appendTo(this.parent.createElement('button', { id: id + '_conditionalformatting' }));\n        return this.cFDdb.element;\n    };\n    Ribbon.prototype.createElement = function (tag, className, id) {\n        return this.parent.createElement(tag, { className: className });\n    };\n    Ribbon.prototype.getBordersDBB = function (id) {\n        var _this = this;\n        var cPickerWrapper;\n        var l10n = this.parent.serviceLocator.getService(locale);\n        this.bordersMenu = new Menu({\n            cssClass: 'e-borders-menu',\n            items: [{ iconCss: 'e-icons e-top-borders', text: l10n.getConstant('TopBorders') }, {\n                    iconCss: 'e-icons e-left-borders',\n                    text: l10n.getConstant('LeftBorders')\n                }, { iconCss: 'e-icons e-right-borders', text: l10n.getConstant('RightBorders') }, {\n                    iconCss: 'e-icons e-bottom-borders', text: l10n.getConstant('BottomBorders')\n                }, {\n                    iconCss: 'e-icons e-all-borders', text: l10n.getConstant('AllBorders')\n                }, { iconCss: 'e-icons e-horizontal-borders', text: l10n.getConstant('HorizontalBorders') }, {\n                    iconCss: 'e-icons e-vertical-borders', text: l10n.getConstant('VerticalBorders')\n                }, {\n                    iconCss: 'e-icons e-outside-borders',\n                    text: l10n.getConstant('OutsideBorders')\n                }, { iconCss: 'e-icons e-inside-borders', text: l10n.getConstant('InsideBorders') },\n                { iconCss: 'e-icons e-no-borders', text: l10n.getConstant('NoBorders') }, { separator: true }, {\n                    text: l10n.getConstant('BorderColor'), items: [{ id: id + \"_border_colors\" }]\n                }, {\n                    text: l10n.getConstant('BorderStyle'), items: [\n                        { iconCss: 'e-icons e-selected-icon', id: id + \"_1px\" }, { id: id + \"_2px\" },\n                        { id: id + \"_3px\" }, { id: id + \"_dashed\" },\n                        { id: id + \"_dotted\" }, { id: id + \"_double\" }\n                    ]\n                }],\n            orientation: 'Vertical',\n            beforeOpen: function (args) {\n                if (args.parentItem.text === 'Border Color') {\n                    _this.colorPicker.refresh();\n                    cPickerWrapper = _this.colorPicker.element.parentElement;\n                    args.element.firstElementChild.appendChild(cPickerWrapper);\n                    cPickerWrapper.style.display = 'inline-block';\n                    args.element.parentElement.classList.add('e-border-color');\n                }\n                else {\n                    args.element.classList.add('e-border-style');\n                }\n            },\n            beforeClose: function (args) {\n                if (args.parentItem.text === 'Border Color') {\n                    if (!closest(args.event.target, '.e-border-colorpicker') ||\n                        closest(args.event.target, '.e-apply') || closest(args.event.target, '.e-cancel')) {\n                        _this.colorPicker = getComponent(cPickerEle, 'colorpicker');\n                        if (_this.colorPicker.mode === 'Picker') {\n                            _this.colorPicker.mode = 'Palette';\n                            _this.colorPicker.dataBind();\n                        }\n                        cPickerWrapper.style.display = '';\n                        _this.parent.element.appendChild(cPickerWrapper);\n                    }\n                    else {\n                        args.cancel = true;\n                    }\n                }\n            },\n            onOpen: function (args) {\n                if (args.parentItem.text === 'Border Color') {\n                    args.element.parentElement.style.overflow = 'visible';\n                }\n            },\n            select: this.borderSelected.bind(this)\n        });\n        this.bordersMenu.createElement = this.parent.createElement;\n        var ul = this.parent.element.appendChild(this.parent.createElement('ul', {\n            id: id + '_borders_menu', styles: 'display: none;'\n        }));\n        this.bordersMenu.appendTo(ul);\n        ul.classList.add('e-ul');\n        var cPickerEle = this.parent.createElement('input', { id: id + \"_cell_border_color\", attrs: { 'type': 'color' } });\n        this.parent.element.appendChild(cPickerEle);\n        this.colorPicker = new ColorPicker({\n            cssClass: 'e-border-colorpicker',\n            mode: 'Palette',\n            inline: true,\n            change: function (args) {\n                var border = _this.border.split(' ');\n                border[2] = args.currentValue.hex;\n                _this.border = border.join(' ');\n            },\n            created: function () { cPickerWrapper = _this.colorPicker.element.parentElement; }\n        });\n        this.colorPicker.createElement = this.parent.createElement;\n        this.colorPicker.appendTo(cPickerEle);\n        this.bordersDdb = new DropDownButton({\n            iconCss: 'e-icons e-bottom-borders',\n            cssClass: 'e-borders-ddb',\n            target: this.bordersMenu.element.parentElement,\n            created: function () { _this.bordersMenu.element.style.display = ''; },\n            beforeOpen: function (args) { return _this.tBarDdbBeforeOpen(args.element.firstElementChild, _this.bordersMenu.items, 1); },\n            beforeClose: function (args) {\n                if (args.event && closest(args.event.target, '.e-borders-menu')) {\n                    args.cancel = true;\n                }\n            },\n            close: function () { return _this.parent.element.focus(); }\n        });\n        this.bordersDdb.createElement = this.parent.createElement;\n        this.bordersDdb.appendTo(this.parent.createElement('button', { id: id + '_borders' }));\n        return this.bordersDdb.element;\n    };\n    Ribbon.prototype.chartSelected = function (args) {\n        var eleId = args.element.id;\n        if (('column_chart' + 'bar_chart' + 'area_chart' + 'pie_doughnut_chart' +\n            'line_chart' + 'radar_chart' + 'scatter_chart').includes(eleId)) {\n            var id = args.event.target.id;\n            this.parent.notify(insertChart, { action: eleId, id: id });\n        }\n    };\n    Ribbon.prototype.cFSelected = function (args) {\n        var eleId = args.element.id;\n        if (('cf_greaterthan' + 'cf_lessthan' + 'cf_between' + 'cf_eqaulto' + 'cf_textthatcontains' +\n            'cf_adateoccuring' + 'cf_duplicatevalues' + 'cf_top10items' + 'cf_top10' + 'cf_bottom10items' +\n            'cf_bottom10' + 'cf_aboveaverage' + 'cf_belowaverage').includes(eleId)) {\n            this.parent.notify(initiateConditionalFormat, { action: args.item.text });\n        }\n        else if (('cf_databars' + 'cf_colorscales').includes(eleId)) {\n            var id = args.event.target.id;\n            this.parent.notify(setCF, { action: eleId, id: id });\n        }\n        else if ('cf_iconsets' === args.element.id) {\n            var target = args.event.target;\n            var iconName = (target.id === '') ? target.parentElement.id : target.id;\n            this.parent.notify(setCF, { action: eleId, id: iconName });\n        }\n        if (eleId === 'cf_cr_cells') {\n            this.parent.notify(clearCFRule, { range: this.parent.getActiveSheet().selectedRange, isPublic: false });\n        }\n        else if (eleId === 'cf_cr_sheet') {\n            var sheet = this.parent.getActiveSheet();\n            var range = getRangeAddress([0, 0, sheet.rowCount - 1, sheet.colCount - 1]);\n            this.parent.conditionalFormat = null;\n            this.parent.notify(clearCFRule, { range: range, isPublic: false });\n        }\n    };\n    Ribbon.prototype.borderSelected = function (args) {\n        if (args.item.items.length || args.item.id === this.parent.element.id + \"_border_colors\") {\n            return;\n        }\n        if (!args.item.text) {\n            var id = this.parent.element.id;\n            var border = this.border.split(' ');\n            var prevStyleId_1 = border[1] === 'solid' ? id + \"_\" + border[0] : id + \"_\" + border[1];\n            if (prevStyleId_1 === args.item.id) {\n                return;\n            }\n            if (args.item.id === id + \"_1px\" || args.item.id === id + \"_2px\" || args.item.id === id + \"_3px\") {\n                border[0] = args.item.id.split(id + \"_\")[1];\n                border[1] = 'solid';\n            }\n            else {\n                border[1] = args.item.id.split(id + \"_\")[1];\n                border[0] = border[1] === 'double' ? '3px' : '1px';\n            }\n            this.border = border.join(' ');\n            this.bordersMenu.items[12].items.forEach(function (item) {\n                if (item.id === prevStyleId_1) {\n                    item.iconCss = null;\n                }\n                if (item.id === args.item.id) {\n                    item.iconCss = 'e-icons e-selected-icon';\n                }\n            });\n            this.bordersMenu.setProperties({ 'items': this.bordersMenu.items }, true);\n            return;\n        }\n        this.bordersDdb.toggle();\n        this.parent.showSpinner();\n        switch (args.item.text) {\n            case 'Top Borders':\n                this.parent.notify(setCellFormat, { style: { borderTop: this.border }, onActionUpdate: true });\n                break;\n            case 'Left Borders':\n                this.parent.notify(setCellFormat, { style: { borderLeft: this.border }, onActionUpdate: true });\n                break;\n            case 'Right Borders':\n                this.parent.notify(setCellFormat, { style: { borderRight: this.border }, onActionUpdate: true });\n                break;\n            case 'Bottom Borders':\n                this.parent.notify(setCellFormat, { style: { borderBottom: this.border }, onActionUpdate: true });\n                break;\n            case 'All Borders':\n                this.parent.notify(setCellFormat, { style: { border: this.border }, onActionUpdate: true });\n                break;\n            case 'Horizontal Borders':\n                this.parent.notify(setCellFormat, { style: { border: this.border }, onActionUpdate: true, borderType: 'Horizontal' });\n                break;\n            case 'Vertical Borders':\n                this.parent.notify(setCellFormat, { style: { border: this.border }, onActionUpdate: true, borderType: 'Vertical' });\n                break;\n            case 'Outside Borders':\n                this.parent.notify(setCellFormat, { style: { border: this.border }, onActionUpdate: true, borderType: 'Outer' });\n                break;\n            case 'Inside Borders':\n                this.parent.notify(setCellFormat, { style: { border: this.border }, onActionUpdate: true, borderType: 'Inner' });\n                break;\n            case 'No Borders':\n                this.parent.notify(setCellFormat, { style: { border: '' }, onActionUpdate: true });\n                break;\n        }\n        this.parent.hideSpinner();\n    };\n    Ribbon.prototype.getFontNameDDB = function (id) {\n        var _this = this;\n        var fontNameBtn = this.parent.createElement('button', { id: id + '_font_name' });\n        fontNameBtn.appendChild(this.parent.createElement('span', { className: 'e-tbar-btn-text', innerHTML: 'Calibri' }));\n        this.fontNameDdb = new DropDownButton({\n            cssClass: 'e-font-family',\n            items: this.getFontFamilyItems(),\n            select: function (args) {\n                var eventArgs = { style: { fontFamily: args.item.text }, onActionUpdate: true };\n                _this.parent.notify(setCellFormat, eventArgs);\n                if (!eventArgs.cancel) {\n                    _this.refreshFontNameSelection(eventArgs.style.fontFamily);\n                }\n            },\n            close: function () { return _this.parent.element.focus(); },\n            beforeOpen: function (args) { return _this.tBarDdbBeforeOpen(args.element, args.items); }\n        });\n        this.fontNameDdb.createElement = this.parent.createElement;\n        this.fontNameDdb.appendTo(fontNameBtn);\n        return fontNameBtn;\n    };\n    Ribbon.prototype.getBtn = function (id, name, bindEvent) {\n        if (bindEvent === void 0) { bindEvent = true; }\n        var btnObj = new Button({ iconCss: \"e-icons e-\" + name + \"-icon\", isToggle: true });\n        btnObj.createElement = this.parent.createElement;\n        btnObj.appendTo(this.parent.createElement('button', { id: id + \"_\" + name }));\n        if (bindEvent) {\n            btnObj.element.addEventListener('click', this.toggleBtnClicked.bind(this));\n        }\n        return btnObj.element;\n    };\n    Ribbon.prototype.datavalidationDDB = function (id) {\n        var _this = this;\n        var l10n = this.parent.serviceLocator.getService(locale);\n        this.datavalidationDdb = new DropDownButton({\n            cssClass: 'e-datavalidation-ddb',\n            iconCss: 'e-datavalidation-icon e-icons',\n            items: [\n                { text: l10n.getConstant('DataValidation') },\n                { text: l10n.getConstant('HighlightInvalidData') },\n                { text: l10n.getConstant('ClearHighlight') },\n                { text: l10n.getConstant('ClearValidation') }\n            ],\n            beforeOpen: function (args) {\n                _this.refreshSelected(_this.datavalidationDdb, args.element, 'iconCss');\n            },\n            select: function (args) {\n                switch (args.item.text) {\n                    case l10n.getConstant('DataValidation'):\n                        _this.parent.notify(initiateDataValidation, null);\n                        break;\n                    case l10n.getConstant('HighlightInvalidData'):\n                        _this.parent.notify(invalidData, { isRemoveHighlight: false });\n                        break;\n                    case l10n.getConstant('ClearHighlight'):\n                        _this.parent.notify(invalidData, { isRemoveHighlight: true });\n                        break;\n                    case l10n.getConstant('ClearValidation'):\n                        _this.parent.notify(removeDataValidation, null);\n                        break;\n                    default:\n                        var direction = args.item.text === l10n.getConstant('SortAscending') ? 'Ascending' : 'Descending';\n                        _this.parent.notify(applySort, { sortOptions: { sortDescriptors: { order: direction } } });\n                        break;\n                }\n            },\n            close: function () { return _this.parent.element.focus(); }\n        });\n        this.datavalidationDdb.createElement = this.parent.createElement;\n        this.datavalidationDdb.appendTo(this.parent.createElement('button', { id: id + '_datavalidation' }));\n        return this.datavalidationDdb.element;\n    };\n    Ribbon.prototype.getTextAlignDDB = function (id) {\n        var _this = this;\n        this.textAlignDdb = new DropDownButton({\n            cssClass: 'e-align-ddb',\n            iconCss: 'e-icons e-left-icon',\n            items: [{ iconCss: 'e-icons e-left-icon' }, { iconCss: 'e-icons e-center-icon' }, { iconCss: 'e-icons e-right-icon' }],\n            beforeItemRender: this.alignItemRender.bind(this),\n            beforeOpen: function (args) {\n                _this.refreshSelected(_this.textAlignDdb, args.element, 'iconCss');\n            },\n            select: function (args) {\n                var eventArgs = {\n                    style: { textAlign: args.item.iconCss.split(' e-')[1].split('-icon')[0] }, onActionUpdate: true\n                };\n                _this.parent.notify(setCellFormat, eventArgs);\n                if (!eventArgs.cancel) {\n                    _this.textAlignDdb.iconCss = \"e-icons e-\" + eventArgs.style.textAlign + \"-icon\";\n                    _this.textAlignDdb.dataBind();\n                }\n            },\n            close: function () { return _this.parent.element.focus(); }\n        });\n        this.textAlignDdb.createElement = this.parent.createElement;\n        this.textAlignDdb.appendTo(this.parent.createElement('button', { id: id + '_text_align' }));\n        return this.textAlignDdb.element;\n    };\n    Ribbon.prototype.getVerticalAlignDDB = function (id) {\n        var _this = this;\n        this.verticalAlignDdb = new DropDownButton({\n            cssClass: 'e-align-ddb',\n            iconCss: 'e-icons e-bottom-icon',\n            items: [{ iconCss: 'e-icons e-top-icon' }, { iconCss: 'e-icons e-middle-icon' }, { iconCss: 'e-icons e-bottom-icon' }],\n            beforeItemRender: this.alignItemRender.bind(this),\n            beforeOpen: function (args) {\n                _this.refreshSelected(_this.verticalAlignDdb, args.element, 'iconCss');\n            },\n            select: function (args) {\n                var eventArgs = {\n                    style: { verticalAlign: args.item.iconCss.split(' e-')[1].split('-icon')[0] }, onActionUpdate: true\n                };\n                _this.parent.notify(setCellFormat, eventArgs);\n                if (!eventArgs.cancel) {\n                    _this.verticalAlignDdb.iconCss = \"e-icons e-\" + eventArgs.style.verticalAlign + \"-icon\";\n                    _this.verticalAlignDdb.dataBind();\n                }\n            },\n            close: function () { return _this.parent.element.focus(); }\n        });\n        this.verticalAlignDdb.createElement = this.parent.createElement;\n        this.verticalAlignDdb.appendTo(this.parent.createElement('button', { id: id + '_vertical_align' }));\n        return this.verticalAlignDdb.element;\n    };\n    Ribbon.prototype.getMergeSplitBtn = function (id) {\n        var _this = this;\n        this.parent.element.appendChild(this.parent.createElement('button', { id: id + '_merge' }));\n        var l10n = this.parent.serviceLocator.getService(locale);\n        this.mergeSplitBtn = new SplitButton({\n            cssClass: 'e-merge-ddb',\n            iconCss: 'e-icons e-merge-icon',\n            items: [{ text: l10n.getConstant('MergeAll'), id: id + \"_merge_all\" }, { text: l10n.getConstant('MergeHorizontally'), id: id + \"_merge_horizontally\" }, { text: l10n.getConstant('MergeVertically'), id: id + \"_merge_vertically\" },\n                { separator: true, id: id + \"_merge_separator\" }, { text: l10n.getConstant('Unmerge'), id: id + \"_unmerge\" }],\n            select: this.mergeSelectHandler.bind(this),\n            close: function () { return _this.parent.element.focus(); },\n            click: function (args) {\n                if (args.element.classList.contains('e-active')) {\n                    _this.toggleActiveState(false);\n                    _this.unMerge();\n                }\n                else {\n                    _this.toggleActiveState(true);\n                    _this.merge(_this.parent.element.id + \"_merge_all\");\n                }\n            },\n            created: function () {\n                _this.mergeSplitBtn.element.title = l10n.getConstant('MergeCells');\n                _this.mergeSplitBtn.element.nextElementSibling.title = l10n.getConstant('SelectMergeType');\n            }\n        });\n        this.mergeSplitBtn.createElement = this.parent.createElement;\n        this.mergeSplitBtn.appendTo('#' + id + '_merge');\n        return this.mergeSplitBtn.element.parentElement;\n    };\n    Ribbon.prototype.mergeSelectHandler = function (args) {\n        args.item.id === this.parent.element.id + \"_unmerge\" ? this.unMerge() : this.merge(args.item.id);\n    };\n    Ribbon.prototype.unMerge = function () {\n        this.parent.showSpinner();\n        this.parent.notify(setMerge, { merge: false, range: this.parent.getActiveSheet().selectedRange,\n            isAction: true, refreshRibbon: true, type: 'All' });\n        this.parent.hideSpinner();\n    };\n    Ribbon.prototype.merge = function (itemId) {\n        var _this = this;\n        var sheet = this.parent.getActiveSheet();\n        var indexes = getRangeIndexes(sheet.selectedRange);\n        var cell;\n        var isDataPresent;\n        for (var i = indexes[0]; i <= indexes[2]; i++) {\n            for (var j = indexes[1]; j <= indexes[3]; j++) {\n                if (i === indexes[0] && j === indexes[1] && itemId.includes('merge_all')) {\n                    continue;\n                }\n                if (i === indexes[0] && itemId.includes('merge_vertically')) {\n                    continue;\n                }\n                if (j === indexes[1] && itemId.includes('_merge_horizontally')) {\n                    continue;\n                }\n                cell = getCell(i, j, sheet) || {};\n                if (cell.value || cell.formula) {\n                    isDataPresent = true;\n                }\n            }\n        }\n        if (!isDataPresent) {\n            this.performMerge(itemId);\n            return;\n        }\n        var dialogInst = this.parent.serviceLocator.getService(dialog);\n        dialogInst.show({\n            target: this.parent.element, height: 200, width: 400, isModal: true, showCloseIcon: true,\n            content: this.parent.serviceLocator.getService(locale).getConstant('MergeCellsAlert'),\n            beforeOpen: function (args) {\n                var dlgArgs = {\n                    dialogName: 'MergeAlertDialog',\n                    element: args.element, target: args.target, cancel: args.cancel\n                };\n                _this.parent.trigger('dialogBeforeOpen', dlgArgs);\n                if (dlgArgs.cancel) {\n                    args.cancel = true;\n                }\n                _this.parent.element.focus();\n            },\n            buttons: [{\n                    buttonModel: { content: this.parent.serviceLocator.getService(locale).getConstant('Ok'), isPrimary: true },\n                    click: function () { dialogInst.hide(); _this.performMerge(itemId); }\n                }]\n        });\n    };\n    Ribbon.prototype.performMerge = function (itemId) {\n        var id = this.parent.element.id;\n        this.parent.showSpinner();\n        switch (itemId) {\n            case id + \"_merge_all\":\n                this.parent.notify(setMerge, { merge: true, range: this.parent.getActiveSheet().selectedRange,\n                    type: 'All', isAction: true, refreshRibbon: true });\n                break;\n            case id + \"_merge_horizontally\":\n                this.parent.notify(setMerge, { merge: true, range: this.parent.getActiveSheet().selectedRange,\n                    type: 'Horizontally', isAction: true });\n                break;\n            case id + \"_merge_vertically\":\n                this.parent.notify(setMerge, { merge: true, range: this.parent.getActiveSheet().selectedRange,\n                    type: 'Vertically', isAction: true });\n                break;\n        }\n        this.parent.hideSpinner();\n    };\n    Ribbon.prototype.getSortFilterDDB = function (id) {\n        var _this = this;\n        var l10n = this.parent.serviceLocator.getService(locale);\n        this.sortingDdb = new DropDownButton({\n            cssClass: 'e-sort-filter-ddb',\n            iconCss: 'e-icons e-sort-filter-icon',\n            items: [\n                { text: l10n.getConstant('SortAscending'), iconCss: 'e-icons e-sort-asc' },\n                { text: l10n.getConstant('SortDescending'), iconCss: 'e-icons e-sort-desc' },\n                { text: l10n.getConstant('CustomSort') + '...', iconCss: 'e-icons e-sort-custom' },\n                { separator: true },\n                { text: l10n.getConstant('Filter'), iconCss: 'e-icons e-filter-apply', id: id + '_applyfilter' },\n                { text: l10n.getConstant('ClearAllFilter'), iconCss: 'e-icons e-filter-clear', id: id + '_clearfilter' },\n                { text: l10n.getConstant('ReapplyFilter'), iconCss: 'e-icons e-filter-reapply', id: id + '_reapplyfilter' }\n            ],\n            beforeItemRender: function (args) {\n                var eventArgs = { isFiltered: false, isClearAll: true };\n                _this.parent.notify(getFilteredColumn, eventArgs);\n                if (args.item.id === id + '_clearfilter' || args.item.id === id + '_reapplyfilter') {\n                    if (!eventArgs.isFiltered) {\n                        args.element.classList.add('e-disabled');\n                    }\n                    else {\n                        args.element.classList.remove('e-disabled');\n                    }\n                }\n            },\n            beforeOpen: function (args) {\n                _this.refreshSelected(_this.sortingDdb, args.element, 'iconCss');\n            },\n            select: function (args) {\n                switch (args.item.text) {\n                    case l10n.getConstant('Filter'):\n                        _this.parent.applyFilter();\n                        break;\n                    case l10n.getConstant('ClearAllFilter'):\n                        _this.parent.clearFilter();\n                        break;\n                    case l10n.getConstant('ReapplyFilter'):\n                        _this.parent.notify(reapplyFilter, null);\n                        break;\n                    case l10n.getConstant('CustomSort') + '...':\n                        _this.parent.notify(initiateCustomSort, null);\n                        break;\n                    default:\n                        var direction = args.item.text === l10n.getConstant('SortAscending') ? 'Ascending' : 'Descending';\n                        _this.parent.notify(applySort, { sortOptions: { sortDescriptors: { order: direction } } });\n                        break;\n                }\n            },\n            close: function () { return _this.parent.element.focus(); }\n        });\n        this.sortingDdb.createElement = this.parent.createElement;\n        this.sortingDdb.appendTo(this.parent.createElement('button', { id: id + '_sorting' }));\n        return this.sortingDdb.element;\n    };\n    Ribbon.prototype.getFindDDb = function (id) {\n        var _this = this;\n        var findToolbtn = this.parent.createElement('button', { id: id + '_findbtn' });\n        this.findDdb = new Button({\n            cssClass: 'e-spreadsheet-find-ddb e-caret-hide',\n            iconCss: 'e-icons e-search-icon'\n        });\n        this.findDdb.createElement = this.parent.createElement;\n        this.findDdb.appendTo(findToolbtn);\n        findToolbtn.onclick = function () {\n            _this.findToolDlg();\n        };\n        return this.findDdb.element;\n    };\n    Ribbon.prototype.findToolDlg = function () {\n        var _this = this;\n        var countArgs;\n        if (isNullOrUndefined(this.parent.element.querySelector('.e-findtool-dlg'))) {\n            var toolbarObj_1;\n            var findTextElement = this.parent.createElement('div', { className: 'e-input-group' });\n            var findTextInput = this.parent.createElement('input', {\n                className: 'e-input e-text-findNext-short', attrs: { 'type': 'Text', value: this.findValue },\n            });\n            findTextInput.setAttribute('placeholder', 'FindValue');\n            var findSpan_1 = this.parent.createElement('span', { className: 'e-input-group-icon' });\n            findTextInput.onkeyup = function () {\n                countArgs = { countOpt: 'count', findCount: '' };\n                _this.parent.notify(findHandler, { countArgs: countArgs });\n                findSpan_1.textContent = countArgs.findCount;\n                var element = document.querySelector('.e-text-findNext-short');\n                var value = element.value;\n                var nextElement = document.querySelector('.e-findRib-next');\n                var prevElement = document.querySelector('.e-findRib-prev');\n                if (isNullOrUndefined(value) || (value === '') || (countArgs.findCount === '0 of 0')) {\n                    toolbarObj_1.enableItems(nextElement, false);\n                    toolbarObj_1.enableItems(prevElement, false);\n                    findSpan_1.textContent = '0 of 0';\n                }\n                else if (!isNullOrUndefined(value) || (countArgs.findCount !== '0 of 0')) {\n                    toolbarObj_1.enableItems(nextElement, true);\n                    toolbarObj_1.enableItems(prevElement, true);\n                }\n            };\n            findTextInput.onkeydown = function (e) {\n                countArgs = { countOpt: 'count', findCount: '' };\n                _this.parent.notify(findHandler, { countArgs: countArgs });\n                var count = countArgs.findCount;\n                _this.findOnKeyDown(e, count);\n            };\n            findTextElement.appendChild(findTextInput);\n            findTextElement.appendChild(findSpan_1);\n            var toolItemModel = [\n                { type: 'Input', template: findTextElement },\n                {\n                    prefixIcon: 'e-icons e-prev-icon', tooltipText: 'Find Previous', type: 'Button', cssClass: 'e-findRib-prev',\n                    disabled: true\n                },\n                { prefixIcon: 'e-icons e-next-icon', tooltipText: 'Find Next', type: 'Button', cssClass: 'e-findRib-next', disabled: true },\n                { type: 'Separator' },\n                { prefixIcon: 'e-icons e-option-icon', tooltipText: 'More Options', type: 'Button', cssClass: 'e-findRib-more' },\n                { prefixIcon: 'e-icons e-close', tooltipText: 'Close', type: 'Button', cssClass: 'e-findRib-close' }\n            ];\n            toolbarObj_1 = new Toolbar({\n                clicked: function (args) {\n                    if (args.item.cssClass === 'e-findRib-next') {\n                        _this.parent.notify(findHandler, { findOption: 'next' });\n                        countArgs = { countOpt: 'count', findCount: '' };\n                        _this.parent.notify(findHandler, { countArgs: countArgs });\n                        findSpan_1.textContent = countArgs.findCount;\n                    }\n                    else if (args.item.cssClass === 'e-findRib-prev') {\n                        _this.parent.notify(findHandler, { findOption: 'prev' });\n                        countArgs = { countOpt: 'count', findCount: '' };\n                        _this.parent.notify(findHandler, { countArgs: countArgs });\n                        findSpan_1.textContent = countArgs.findCount;\n                    }\n                    else if (args.item.cssClass === 'e-findRib-more') {\n                        _this.parent.notify(findDlg, null);\n                        _this.findDialog.hide();\n                    }\n                }, width: 'auto', height: 'auto', items: toolItemModel, cssClass: 'e-find-toolObj'\n            });\n            var toolbarElement_1 = this.parent.createElement('div', { className: 'e-find-toolbar' });\n            var dialogDiv = this.parent.createElement('div', { className: 'e-dlg-div' });\n            this.findDialog = new FindDialog({\n                isModal: false, showCloseIcon: false, cssClass: 'e-findtool-dlg', content: toolbarElement_1, visible: false,\n                allowDragging: true, target: this.parent.element.querySelector('.e-main-panel'),\n                beforeOpen: function () {\n                    EventHandler.add(document, 'click', _this.closeDialog, _this);\n                },\n                open: function () {\n                    _this.textFocus(toolbarObj_1.element);\n                },\n                beforeClose: function () {\n                    _this.findValue = _this.parent.element.querySelector('.e-text-findNext-short').value;\n                    toolbarObj_1.destroy();\n                    var element = document.querySelector('.e-find-toolbar');\n                    EventHandler.remove(element, 'focus', _this.textFocus);\n                    EventHandler.remove(document, 'click', _this.closeDialog);\n                    _this.parent.element.focus();\n                },\n                created: function () {\n                    toolbarObj_1.createElement = _this.parent.createElement;\n                    toolbarObj_1.appendTo(toolbarElement_1);\n                    _this.findDialog.width = getComputedStyle(document.querySelector('.e-findtool-dlg')).width;\n                    var calculate = _this.parent.element.querySelector('.e-main-panel').getBoundingClientRect();\n                    var dialogWidth = _this.findDialog.width;\n                    var rightValue = calculate.width - parseInt(dialogWidth.toString(), 10) - 14; /** 14- width of scroll bar */\n                    /** 31- height of sheetHeader */\n                    var topValue = _this.parent.sheets[_this.parent.activeSheetIndex].showHeaders ? 31 : 0;\n                    _this.findDialog.position = { X: rightValue, Y: topValue };\n                    _this.findDialog.dataBind();\n                    _this.findDialog.show();\n                },\n            });\n            this.findDialog.createElement = this.parent.createElement;\n            this.findDialog.appendTo(dialogDiv);\n        }\n        else {\n            if (!isNullOrUndefined(this.parent.element.querySelector('.e-findtool-dlg'))) {\n                this.findDialog.hide();\n                detach(this.parent.element.querySelector('.e-findtool-dlg'));\n                this.findDialog = null;\n                this.parent.element.focus();\n            }\n        }\n    };\n    Ribbon.prototype.findOnKeyDown = function (e, count) {\n        if (document.querySelector('.e-text-findNext-short').value) {\n            if (count !== '0 of 0') {\n                if (e.shiftKey) {\n                    if (e.keyCode === 13) {\n                        var buttonArgs = { findOption: 'prev' };\n                        this.parent.notify(findHandler, buttonArgs);\n                    }\n                }\n                else if (e.keyCode === 13) {\n                    var buttonArg = { findOption: 'next' };\n                    this.parent.notify(findHandler, buttonArg);\n                }\n            }\n        }\n    };\n    Ribbon.prototype.closeDialog = function (e) {\n        if ((closest(e.target, '.e-findRib-close')) || (!closest(e.target, '.e-spreadsheet'))) {\n            if (!isNullOrUndefined(this.findDialog)) {\n                this.findDialog.hide();\n                detach(this.parent.element.querySelector('.e-findtool-dlg'));\n                this.findDialog = null;\n            }\n        }\n    };\n    Ribbon.prototype.textFocus = function (element) {\n        element = document.querySelector('.e-find-toolbar');\n        element.addEventListener('focus', function () {\n            var elements = document.querySelector('.e-text-findNext-short');\n            elements.focus();\n            elements.classList.add('e-input-focus');\n            (elements).setSelectionRange(0, elements.value.length);\n        });\n    };\n    Ribbon.prototype.getClearDDB = function (id) {\n        var _this = this;\n        var l10n = this.parent.serviceLocator.getService(locale);\n        this.clearDdb = new DropDownButton({\n            cssClass: 'e-clear-ddb',\n            iconCss: 'e-icons e-clear-icon',\n            items: [\n                { text: l10n.getConstant('ClearAll') },\n                { text: l10n.getConstant('ClearFormats') },\n                { text: l10n.getConstant('ClearContents') },\n                { text: l10n.getConstant('ClearHyperlinks') }\n            ],\n            select: function (args) {\n                _this.parent.notify(clearViewer, { options: { type: args.item.text } });\n            },\n            close: function () { return _this.parent.element.focus(); }\n        });\n        this.clearDdb.createElement = this.parent.createElement;\n        this.clearDdb.appendTo(this.parent.createElement('button', { id: id + '_clear' }));\n        return this.clearDdb.element;\n    };\n    Ribbon.prototype.ribbonCreated = function () {\n        this.ribbon.element.querySelector('.e-drop-icon').title\n            = this.parent.serviceLocator.getService(locale).getConstant('CollapseToolbar');\n    };\n    Ribbon.prototype.alignItemRender = function (args) {\n        var text = args.item.iconCss.split(' e-')[1].split('-icon')[0];\n        text = text[0].toUpperCase() + text.slice(1, text.length);\n        args.element.title = this.parent.serviceLocator.getService(locale).getConstant('Align' + text);\n    };\n    Ribbon.prototype.toggleBtnClicked = function (e) {\n        var target = closest(e.target, '.e-btn');\n        var parentId = this.parent.element.id;\n        var id = target.id;\n        var property = setCellFormat;\n        var value;\n        var defaultModel;\n        var activeModel;\n        var eventArgs;\n        var key;\n        switch (id) {\n            case parentId + \"_bold\":\n                defaultModel = { fontWeight: 'normal' };\n                activeModel = { fontWeight: 'bold' };\n                key = 'fontWeight';\n                break;\n            case parentId + \"_italic\":\n                defaultModel = { fontStyle: 'normal' };\n                activeModel = { fontStyle: 'italic' };\n                key = 'fontStyle';\n                break;\n            case parentId + \"_line-through\":\n                property = textDecorationUpdate;\n                defaultModel = { textDecoration: 'line-through' };\n                activeModel = defaultModel;\n                key = 'textDecoration';\n                break;\n            case parentId + \"_underline\":\n                property = textDecorationUpdate;\n                defaultModel = { textDecoration: 'underline' };\n                activeModel = defaultModel;\n                key = 'textDecoration';\n                break;\n        }\n        if (target.classList.contains('e-active')) {\n            value = activeModel[key];\n            eventArgs = { style: activeModel, onActionUpdate: true };\n            this.parent.notify(property, eventArgs);\n            if (eventArgs.cancel) {\n                target.classList.remove('e-active');\n            }\n        }\n        else {\n            value = defaultModel[key];\n            eventArgs = { style: defaultModel, onActionUpdate: true };\n            this.parent.notify(property, eventArgs);\n            if (eventArgs.cancel) {\n                target.classList.add('e-active');\n            }\n        }\n        if (!eventArgs.cancel && value !== eventArgs.style[key]) {\n            this.refreshToggleBtn(getCellIndexes(this.parent.getActiveSheet().activeCell));\n        }\n        this.parent.element.focus();\n    };\n    Ribbon.prototype.getCellStyleValue = function (cssProp, indexes) {\n        var cell = getCell(indexes[0], indexes[1], this.parent.getActiveSheet());\n        var value = this.parent.cellStyle[cssProp];\n        if (cell && cell.style && cell.style[cssProp]) {\n            value = cell.style[cssProp];\n        }\n        return value;\n    };\n    Ribbon.prototype.refreshSelected = function (inst, element, key, itemKey) {\n        if (itemKey === void 0) { itemKey = key; }\n        for (var i = 0; i < inst.items.length; i++) {\n            if (inst.items[i][itemKey] === inst[key]) {\n                element.children[i].classList.add('e-selected');\n                break;\n            }\n        }\n    };\n    Ribbon.prototype.expandCollapseHandler = function (args) {\n        var target = this.ribbon.element.querySelector('.e-drop-icon');\n        var l10n = this.parent.serviceLocator.getService(locale);\n        if (args.expanded) {\n            target.title = l10n.getConstant('CollapseToolbar');\n        }\n        else {\n            target.title = l10n.getConstant('ExpandToolbar');\n        }\n        this.parent.setPanelSize();\n    };\n    Ribbon.prototype.getNumFormatDdbItems = function (id) {\n        var l10n = this.parent.serviceLocator.getService(locale);\n        return [\n            { id: id + 'item1', text: l10n.getConstant('General') },\n            { id: id + 'item2', text: l10n.getConstant('Number') },\n            { id: id + 'item3', text: l10n.getConstant('Currency') },\n            { id: id + 'item4', text: l10n.getConstant('Accounting') },\n            { id: id + 'item5', text: l10n.getConstant('ShortDate') },\n            { id: id + 'item6', text: l10n.getConstant('LongDate') },\n            { id: id + 'item7', text: l10n.getConstant('Time') },\n            { id: id + 'item8', text: l10n.getConstant('Percentage') },\n            { id: id + 'item9', text: l10n.getConstant('Fraction') },\n            { id: id + 'item10', text: l10n.getConstant('Scientific') },\n            { id: id + 'item11', text: l10n.getConstant('Text') }\n        ];\n    };\n    Ribbon.prototype.getFontFamilyItems = function () {\n        return [{ text: 'Arial' }, { text: 'Arial Black' }, { text: 'Axettac Demo' }, { text: 'Batang' }, { text: 'Book Antiqua' },\n            { text: 'Calibri', iconCss: 'e-icons e-selected-icon' }, { text: 'Courier' }, { text: 'Courier New' },\n            { text: 'Din Condensed' }, { text: 'Georgia' }, { text: 'Helvetica' }, { text: 'Helvetica New' }, { text: 'Roboto' },\n            { text: 'Tahoma' }, { text: 'Times New Roman' }, { text: 'Verdana' }];\n    };\n    Ribbon.prototype.numDDBSelect = function (args) {\n        var eventArgs = {\n            format: getFormatFromType(args.item.text),\n            range: this.parent.getActiveSheet().selectedRange, cancel: false, requestType: 'NumberFormat'\n        };\n        var actionArgs = {\n            range: this.parent.getActiveSheet().name + '!' + eventArgs.range,\n            format: eventArgs.format, requestType: 'NumberFormat'\n        };\n        this.parent.trigger('beforeCellFormat', eventArgs);\n        this.parent.notify(beginAction, { eventArgs: eventArgs, action: 'format' });\n        if (eventArgs.cancel) {\n            return;\n        }\n        this.parent.notify(applyNumberFormatting, eventArgs);\n        this.parent.notify(selectionComplete, { type: 'mousedown' });\n        this.refreshNumFormatSelection(args.item.text);\n        this.parent.notify(completeAction, { eventArgs: actionArgs, action: 'format' });\n    };\n    Ribbon.prototype.tBarDdbBeforeOpen = function (element, items, separatorCount) {\n        if (separatorCount === void 0) { separatorCount = 0; }\n        var viewportHeight = this.parent.viewport.height;\n        var actualHeight = (parseInt(getComputedStyle(element.firstElementChild).height, 10) * (items.length - separatorCount)) +\n            (parseInt(getComputedStyle(element).paddingTop, 10) * 2);\n        if (separatorCount) {\n            var separatorStyle = getComputedStyle(element.querySelector('.e-separator'));\n            actualHeight += (separatorCount * (parseInt(separatorStyle.borderBottomWidth, 10) + (parseInt(separatorStyle.marginTop, 10) * 2)));\n        }\n        if (actualHeight > viewportHeight) {\n            element.style.height = viewportHeight + \"px\";\n            element.style.overflowY = 'auto';\n        }\n        else {\n            if (element.style.height) {\n                element.style.height = '';\n                element.style.overflowY = '';\n            }\n        }\n    };\n    Ribbon.prototype.numDDBOpen = function (args) {\n        this.numPopupWidth = 0;\n        var elemList = args.element.querySelectorAll('span.e-numformat-preview-text');\n        for (var i = 0, len = elemList.length; i < len; i++) {\n            if (this.numPopupWidth < elemList[i].offsetWidth) {\n                this.numPopupWidth = elemList[i].offsetWidth;\n            }\n        }\n        var popWidth = this.numPopupWidth + 160;\n        document.querySelector('.e-numformat-ddb.e-dropdown-popup').style.width = popWidth + \"px\";\n    };\n    Ribbon.prototype.previewNumFormat = function (args) {\n        var cellIndex = getCellIndexes(this.parent.getActiveSheet().activeCell);\n        var cell = getCell(cellIndex[0], cellIndex[1], this.parent.getActiveSheet());\n        var eventArgs = {\n            type: args.item.text,\n            formattedText: '',\n            value: cell && cell.value ? cell.value : '',\n            format: getFormatFromType(args.item.text),\n            sheetIndex: this.parent.activeSheetIndex,\n            onLoad: true\n        };\n        var numElem = this.parent.createElement('div', {\n            className: 'e-numformat-text',\n            styles: 'width:100%',\n            innerHTML: args.element.innerHTML\n        });\n        args.element.innerHTML = '';\n        this.parent.notify(getFormattedCellObject, eventArgs);\n        var previewElem = this.parent.createElement('span', {\n            className: 'e-numformat-preview-text',\n            styles: 'float:right;',\n            innerHTML: eventArgs.formattedText.toString()\n        });\n        numElem.appendChild(previewElem);\n        args.element.appendChild(numElem);\n    };\n    Ribbon.prototype.refreshRibbonContent = function (activeTab) {\n        if (!this.ribbon) {\n            return;\n        }\n        if (isNullOrUndefined(activeTab)) {\n            activeTab = this.ribbon.selectedTab;\n        }\n        var l10n = this.parent.serviceLocator.getService(locale);\n        var sheet = this.parent.getActiveSheet();\n        switch (this.ribbon.items[activeTab].header.text) {\n            case l10n.getConstant('Home'):\n                this.refreshHomeTabContent(getCellIndexes(sheet.activeCell));\n                break;\n            case l10n.getConstant('Insert'):\n                // Second tab functionality comes here\n                break;\n            case l10n.getConstant('Formulas'):\n                // Third tab functionality comes here\n                break;\n            case l10n.getConstant('Data'):\n                this.refreshDataTabContent(activeTab);\n                break;\n            case l10n.getConstant('View'):\n                this.refreshViewTabContent(activeTab);\n                break;\n        }\n    };\n    Ribbon.prototype.refreshHomeTabContent = function (indexes) {\n        if (!isNullOrUndefined(document.getElementById(this.parent.element.id + '_number_format'))) {\n            this.numFormatDDB = getComponent(document.getElementById(this.parent.element.id + '_number_format'), DropDownButton);\n        }\n        var sheet = this.parent.getActiveSheet();\n        var actCell = getCellIndexes(this.parent.getActiveSheet().activeCell);\n        var l10n = this.parent.serviceLocator.getService(locale);\n        var cell = getCell(actCell[0], actCell[1], this.parent.getActiveSheet()) || {};\n        var type = getTypeFromFormat(cell.format ? cell.format : 'General');\n        if (this.numFormatDDB) {\n            if (sheet.isProtected && !sheet.protectSettings.formatCells) {\n                type = 'General';\n                this.refreshNumFormatSelection(type);\n            }\n            else {\n                this.refreshNumFormatSelection(l10n.getConstant(type));\n            }\n        }\n        if (this.fontNameDdb) {\n            if (sheet.isProtected && !sheet.protectSettings.formatCells) {\n                this.refreshFontNameSelection('Calibri');\n            }\n            else {\n                this.refreshFontNameSelection(this.getCellStyleValue('fontFamily', indexes));\n            }\n        }\n        if (this.fontSizeDdb) {\n            var value = this.getCellStyleValue('fontSize', indexes);\n            if (sheet.isProtected && !sheet.protectSettings.formatCells) {\n                this.fontSizeDdb.content = '11';\n            }\n            else {\n                value = value.includes('pt') ? value.split('pt')[0] : '11';\n                if (value !== this.fontSizeDdb.content) {\n                    this.fontSizeDdb.content = value;\n                    this.fontSizeDdb.dataBind();\n                }\n            }\n        }\n        if (this.textAlignDdb) {\n            var style = this.getCellStyleValue('textAlign', indexes);\n            if (sheet.isProtected && !sheet.protectSettings.formatCells) {\n                this.textAlignDdb.iconCss = 'e-icons e-left-icon';\n            }\n            else {\n                if (cell.value !== undefined && style === 'left' && (type === 'Accounting' || isNumber(cell.value))) {\n                    style = 'right';\n                }\n                var value = \"e-icons e-\" + style.toLowerCase() + \"-icon\";\n                if (value !== this.textAlignDdb.iconCss) {\n                    this.textAlignDdb.iconCss = value;\n                    this.textAlignDdb.dataBind();\n                }\n            }\n        }\n        if (this.verticalAlignDdb) {\n            var value = \"e-icons e-\" + this.getCellStyleValue('verticalAlign', indexes).toLowerCase() + \"-icon\";\n            if (sheet.isProtected && !sheet.protectSettings.formatCells) {\n                this.verticalAlignDdb.iconCss = 'e-icons e-bottom-icon';\n            }\n            else {\n                if (value !== this.verticalAlignDdb.iconCss) {\n                    this.verticalAlignDdb.iconCss = value;\n                    this.verticalAlignDdb.dataBind();\n                }\n            }\n        }\n        this.refreshToggleBtn(indexes);\n        if (!sheet.isProtected && (cell.rowSpan > 1 || cell.colSpan > 1)) {\n            this.enableToolbarItems([{ tab: l10n.getConstant('Home'), items: [this.parent.element.id + \"_merge_cells\"],\n                    enable: true }]);\n            this.toggleActiveState(true);\n        }\n        else {\n            var indexes_1 = getRangeIndexes(sheet.selectedRange);\n            this.enableToolbarItems([{ tab: l10n.getConstant('Home'), items: [this.parent.element.id + \"_merge_cells\"],\n                    enable: indexes_1[0] !== indexes_1[2] || indexes_1[1] !== indexes_1[3] ? true : false }]);\n            this.toggleActiveState(false);\n        }\n    };\n    Ribbon.prototype.toggleActiveState = function (active) {\n        var l10n = this.parent.serviceLocator.getService(locale);\n        if (!this.parent.getActiveSheet().isProtected) {\n            if (active) {\n                this.mergeSplitBtn.element.classList.add('e-active');\n                this.mergeSplitBtn.element.title = l10n.getConstant('UnmergeCells');\n            }\n            else {\n                if (this.mergeSplitBtn.element.classList.contains('e-active')) {\n                    this.mergeSplitBtn.element.classList.remove('e-active');\n                }\n                this.mergeSplitBtn.element.title = l10n.getConstant('MergeCells');\n            }\n        }\n    };\n    Ribbon.prototype.refreshToggleBtn = function (indexes) {\n        var _this = this;\n        var sheet = this.parent.getActiveSheet();\n        var btn;\n        var id = this.parent.element.id;\n        var value;\n        var isActive;\n        var cell = getCell(indexes[0], indexes[1], sheet);\n        var fontProps = ['fontWeight', 'fontStyle', 'textDecoration', 'textDecoration'];\n        ['bold', 'italic', 'line-through', 'underline', 'wrap'].forEach(function (name, index) {\n            btn = document.getElementById(id + \"_\" + name);\n            if (btn) {\n                if (sheet.isProtected && !sheet.protectSettings.formatCells) {\n                    btn.classList.remove('e-active');\n                }\n                else if (name === 'wrap') {\n                    isActive = cell && cell.wrap;\n                }\n                else {\n                    value = _this.getCellStyleValue(fontProps[index], indexes).toLowerCase();\n                    isActive = value.indexOf(name) > -1;\n                }\n                if (isActive) {\n                    btn.classList.add('e-active');\n                }\n                else {\n                    if (btn.classList.contains('e-active')) {\n                        btn.classList.remove('e-active');\n                    }\n                }\n            }\n        });\n    };\n    Ribbon.prototype.refreshFontNameSelection = function (fontFamily) {\n        if (fontFamily !== this.fontNameDdb.items[this.fontNameIndex].text) {\n            this.fontNameDdb.element.firstElementChild.textContent = fontFamily;\n            for (var i = 0; i < this.fontNameDdb.items.length; i++) {\n                if (this.fontNameDdb.items[i].text === fontFamily) {\n                    this.fontNameDdb.items[i].iconCss = 'e-icons e-selected-icon';\n                    this.fontNameDdb.items[this.fontNameIndex].iconCss = '';\n                    this.fontNameDdb.setProperties({ 'items': this.fontNameDdb.items }, true);\n                    this.fontNameIndex = i;\n                    break;\n                }\n            }\n        }\n    };\n    Ribbon.prototype.refreshNumFormatSelection = function (type) {\n        var l10n = this.parent.serviceLocator.getService(locale);\n        for (var i = 0; i < this.numFormatDDB.items.length; i++) {\n            if (this.numFormatDDB.items[i].iconCss !== '') {\n                this.numFormatDDB.items[i].iconCss = '';\n            }\n            if (this.numFormatDDB.items[i].text === type) {\n                this.numFormatDDB.items[i].iconCss = 'e-icons e-selected-icon';\n            }\n        }\n        this.numFormatDDB.element.firstElementChild.textContent = type;\n        this.numFormatDDB.setProperties({ 'items': this.numFormatDDB.items }, true);\n    };\n    Ribbon.prototype.fileMenuItemSelect = function (args) {\n        var _this = this;\n        var selectArgs = extend({ cancel: false }, args);\n        this.parent.trigger('fileMenuItemSelect', selectArgs);\n        var id = this.parent.element.id;\n        if (!selectArgs.cancel) {\n            switch (args.item.id) {\n                case id + \"_Open\":\n                    select('#' + id + '_fileUpload', this.parent.element).click();\n                    break;\n                case id + \"_Xlsx\":\n                case id + \"_Xls\":\n                case id + \"_Csv\":\n                    this.parent.save({ saveType: args.item.id.split(id + \"_\")[1] });\n                    break;\n                case id + \"_New\":\n                    var dialogInst_1 = this.parent.serviceLocator.getService(dialog);\n                    dialogInst_1.show({\n                        height: 200, width: 400, isModal: true, showCloseIcon: true,\n                        content: this.parent.serviceLocator.getService(locale).getConstant('DestroyAlert'),\n                        beforeOpen: function (args) {\n                            var dlgArgs = {\n                                dialogName: 'DestroySheetDialog',\n                                element: args.element, target: args.target, cancel: args.cancel\n                            };\n                            _this.parent.trigger('dialogBeforeOpen', dlgArgs);\n                            if (dlgArgs.cancel) {\n                                args.cancel = true;\n                            }\n                            _this.parent.element.focus();\n                        },\n                        buttons: [{\n                                buttonModel: {\n                                    content: this.parent.serviceLocator.getService(locale).getConstant('Ok'), isPrimary: true\n                                },\n                                click: function () {\n                                    _this.parent.sheets.length = 0;\n                                    _this.parent.createSheet();\n                                    dialogInst_1.hide();\n                                    _this.parent.activeSheetIndex = _this.parent.sheets.length - 1;\n                                    _this.parent.notify(refreshSheetTabs, {});\n                                    _this.parent.notify(sheetsDestroyed, {});\n                                    _this.parent.renderModule.refreshSheet();\n                                }\n                            }]\n                    });\n                    break;\n            }\n        }\n    };\n    Ribbon.prototype.toolbarClicked = function (args) {\n        if (!(args.item.id === 'spreadsheet_find')) {\n            var parentId = this.parent.element.id;\n            var sheet = this.parent.getActiveSheet();\n            switch (args.item.id) {\n                case parentId + '_headers':\n                    var evtHArgs = {\n                        isShow: !sheet.showHeaders,\n                        sheetIdx: this.parent.activeSheetIndex,\n                        cancel: false\n                    };\n                    this.parent.notify(completeAction, { eventArgs: evtHArgs, action: 'headers' });\n                    if (evtHArgs.cancel) {\n                        return;\n                    }\n                    this.parent.setSheetPropertyOnMute(sheet, 'showHeaders', !sheet.showHeaders);\n                    this.parent.serviceLocator.getService('sheet').showHideHeaders();\n                    this.toggleRibbonItems({ props: 'Headers', activeTab: this.ribbon.selectedTab });\n                    this.parent.element.focus();\n                    break;\n                case parentId + '_gridlines':\n                    var evtglArgs = {\n                        isShow: !sheet.showGridLines,\n                        sheetIdx: this.parent.activeSheetIndex,\n                        cancel: false\n                    };\n                    this.parent.notify(completeAction, { eventArgs: evtglArgs, action: 'gridLines' });\n                    if (evtglArgs.cancel) {\n                        return;\n                    }\n                    this.parent.setSheetPropertyOnMute(sheet, 'showGridLines', !sheet.showGridLines);\n                    this.toggleRibbonItems({ props: 'GridLines', activeTab: this.ribbon.selectedTab });\n                    this.parent.element.focus();\n                    break;\n                case parentId + '_protect':\n                    this.parent.setSheetPropertyOnMute(sheet, 'isProtected', !sheet.isProtected);\n                    var isActive = false;\n                    sheet.isProtected ? isActive = false : isActive = true;\n                    this.parent.notify(applyProtect, { isActive: isActive, id: parentId + '_protect' });\n                    break;\n                case parentId + '_undo':\n                    this.parent.notify(performUndoRedo, { isUndo: true });\n                    break;\n                case parentId + '_redo':\n                    this.parent.notify(performUndoRedo, { isUndo: false });\n                    break;\n            }\n            this.parent.notify(ribbonClick, args);\n        }\n    };\n    Ribbon.prototype.toggleRibbonItems = function (args) {\n        var viewtabHeader = this.parent.serviceLocator.getService(locale).getConstant('View');\n        var datatabHeader = this.parent.serviceLocator.getService(locale).getConstant('Data');\n        if (this.ribbon.items[this.ribbon.selectedTab].header.text === viewtabHeader) {\n            if (isNullOrUndefined(args.activeTab)) {\n                for (var i = 0, len_1 = this.ribbon.items.length; i < len_1; i++) {\n                    if (this.ribbon.items[i].header.text === viewtabHeader) {\n                        args.activeTab = i;\n                        break;\n                    }\n                }\n            }\n            var text = this.getLocaleText(args.props, true);\n            var id = this.parent.element.id + \"_\" + args.props.toLowerCase();\n            var len = this.ribbon.items[args.activeTab].content.length;\n            for (var i = void 0; i < len; i++) {\n                if (this.ribbon.items[args.activeTab].content[i].type === 'Separator') {\n                    continue;\n                }\n                if (this.ribbon.items[args.activeTab].content[i].id === id) {\n                    this.ribbon.items[args.activeTab].content[i].text = text;\n                    this.ribbon.setProperties({ 'items': this.ribbon.items }, true);\n                }\n            }\n            if (this.ribbon.items[this.ribbon.selectedTab].header.text === viewtabHeader) {\n                this.updateToggleText(args.props.toLowerCase(), text);\n            }\n        }\n        if (this.ribbon.items[this.ribbon.selectedTab].header.text === datatabHeader) {\n            if (isNullOrUndefined(args.activeTab)) {\n                for (var i = 0, len_2 = this.ribbon.items.length; i < len_2; i++) {\n                    if (this.ribbon.items[i].header.text === datatabHeader) {\n                        args.activeTab = i;\n                        break;\n                    }\n                }\n            }\n            var text = this.getLocaleProtectText('Sheet', true);\n            var id = this.parent.element.id + \"_\" + args.props.toLowerCase();\n            var len = this.ribbon.items[args.activeTab].content.length;\n            for (var i = void 0; i < len; i++) {\n                if (this.ribbon.items[args.activeTab].content[i].type === 'Separator') {\n                    continue;\n                }\n                if (this.ribbon.items[args.activeTab].content[i].id === id) {\n                    this.ribbon.items[args.activeTab].content[i].text = text;\n                    this.ribbon.setProperties({ 'items': this.ribbon.items }, true);\n                }\n            }\n            if (this.ribbon.items[this.ribbon.selectedTab].header.text === datatabHeader) {\n                this.updateToggleText(args.props.toLowerCase(), text);\n            }\n        }\n    };\n    Ribbon.prototype.enableFileMenuItems = function (args) {\n        this.ribbon.enableMenuItems(args.items, args.enable, args.isUniqueId);\n    };\n    Ribbon.prototype.hideRibbonTabs = function (args) {\n        this.ribbon.hideTabs(args.tabs, args.hide);\n    };\n    Ribbon.prototype.addRibbonTabs = function (args) {\n        this.ribbon.addTabs(args.items, args.insertBefore);\n        var nextTab = select('.e-ribbon .e-tab-header .e-toolbar-item:not(.e-menu-tab).e-hide', this.parent.element);\n        if (nextTab) {\n            this.parent.updateActiveBorder(selectAll('.e-ribbon .e-tab-header .e-toolbar-item:not(.e-menu-tab)', this.parent.element)[this.ribbon.selectedTab]);\n        }\n    };\n    Ribbon.prototype.updateToggleText = function (item, text) {\n        var _this = this;\n        getUpdateUsingRaf(function () {\n            select(\"#\" + _this.parent.element.id + \"_\" + item + \" .e-tbar-btn-text\", _this.ribbon.element).textContent = text;\n        });\n    };\n    Ribbon.prototype.refreshViewTabContent = function (activeTab) {\n        var id = this.parent.element.id;\n        var updated;\n        for (var i = 0; i < this.ribbon.items[activeTab].content.length; i++) {\n            if (this.ribbon.items[activeTab].content[i].type === 'Separator') {\n                continue;\n            }\n            if (this.ribbon.items[activeTab].content[i].id === id + \"_headers\") {\n                this.updateViewTabContent(activeTab, 'Headers', i);\n                if (updated) {\n                    break;\n                }\n                updated = true;\n            }\n            if (this.ribbon.items[activeTab].content[i].id === id + \"_gridlines\") {\n                this.updateViewTabContent(activeTab, 'GridLines', i);\n                if (updated) {\n                    break;\n                }\n                updated = true;\n            }\n        }\n    };\n    Ribbon.prototype.updateViewTabContent = function (activeTab, item, idx) {\n        var sheet = this.parent.getActiveSheet();\n        var l10n = this.parent.serviceLocator.getService(locale);\n        if (sheet['show' + item]) {\n            if (this.ribbon.items[activeTab].content[idx].text === l10n.getConstant('Show' + item)) {\n                this.updateShowHideBtn('Hide', item, idx, activeTab);\n            }\n        }\n        else {\n            if (this.ribbon.items[activeTab].content[idx].text === l10n.getConstant('Hide' + item)) {\n                this.updateShowHideBtn('Show', item, idx, activeTab);\n            }\n        }\n    };\n    Ribbon.prototype.updateShowHideBtn = function (showHideText, item, idx, activeTab) {\n        var l10n = this.parent.serviceLocator.getService(locale);\n        var text = l10n.getConstant(showHideText + item);\n        this.ribbon.items[activeTab].content[idx].text = text;\n        this.ribbon.setProperties({ 'items': this.ribbon.items }, true);\n        this.updateToggleText(item.toLowerCase(), text);\n    };\n    Ribbon.prototype.refreshDataTabContent = function (activeTab) {\n        var id = this.parent.element.id;\n        var updated;\n        for (var j = 0; j < this.ribbon.items[activeTab].content.length; j++) {\n            if (this.ribbon.items[activeTab].content[j].type === 'Separator') {\n                continue;\n            }\n            if (this.ribbon.items[activeTab].content[j].id === id + \"_protect\") {\n                this.updateDataTabContent(activeTab, 'Sheet', j);\n                if (updated) {\n                    break;\n                }\n                updated = true;\n            }\n        }\n    };\n    Ribbon.prototype.updateDataTabContent = function (activeTab, item, idx) {\n        var sheet = this.parent.getActiveSheet();\n        var l10n = this.parent.serviceLocator.getService(locale);\n        if (sheet.isProtected) {\n            if (this.ribbon.items[activeTab].content[idx].text === l10n.getConstant('Protect' + item)) {\n                this.ribbon.items[activeTab].content[idx].cssClass = 'e-active';\n                this.updateProtectBtn('Unprotect', item, idx, activeTab);\n            }\n        }\n        else {\n            this.updateProtectBtn('Protect', item, idx, activeTab);\n        }\n    };\n    Ribbon.prototype.updateProtectBtn = function (protectText, item, idx, activeTab) {\n        var l10n = this.parent.serviceLocator.getService(locale);\n        var text = l10n.getConstant(protectText + item);\n        this.ribbon.items[activeTab].content[idx].text = text;\n        this.ribbon.setProperties({ 'items': this.ribbon.items }, true);\n        this.updateToggleText('protect', text);\n    };\n    Ribbon.prototype.addToolbarItems = function (args) {\n        this.ribbon.addToolbarItems(args.tab, args.items, args.index);\n    };\n    Ribbon.prototype.enableToolbarItems = function (args) {\n        var _this = this;\n        args.forEach(function (arg) {\n            _this.ribbon.enableItems(arg.tab || _this.ribbon.items[_this.ribbon.selectedTab].header.text, arg.items, arg.enable);\n        });\n    };\n    Ribbon.prototype.createMobileView = function () {\n        var _this = this;\n        var parentId = this.parent.element.id;\n        var toobar = this.parent.createElement('div', { className: 'e-header-toolbar' });\n        var menu = this.parent.createElement('ul');\n        toobar.appendChild(menu);\n        var toolbarObj = new Toolbar({\n            items: [\n                { prefixIcon: 'e-tick-icon', align: 'Left', id: parentId + 'focused_tick', cssClass: 'e-focused-tick' },\n                { template: menu, align: 'Right', id: parentId + 'file_menu' },\n            ],\n            clicked: function (args) {\n                switch (args.item.id) {\n                    case parentId + 'focused_tick':\n                        _this.parent.element.classList.remove('e-mobile-focused');\n                        _this.parent.renderModule.setSheetPanelSize();\n                        break;\n                }\n            },\n            created: function () {\n                var menuObj = new Menu({\n                    cssClass: 'e-mobile e-file-menu',\n                    enableRtl: true,\n                    showItemOnClick: true,\n                    items: _this.getRibbonMenuItems(),\n                    select: _this.fileMenuItemSelect.bind(_this),\n                    beforeOpen: function (args) {\n                        args.element.parentElement.classList.remove('e-rtl');\n                        _this.fileMenuBeforeOpen(args);\n                    },\n                    beforeClose: _this.fileMenuBeforeClose.bind(_this)\n                });\n                menuObj.createElement = _this.parent.createElement;\n                menuObj.appendTo(menu);\n            }\n        });\n        toolbarObj.createElement = this.parent.createElement;\n        toolbarObj.appendTo(toobar);\n        this.parent.element.insertBefore(toobar, this.parent.element.firstElementChild);\n        this.renderMobileToolbar();\n    };\n    Ribbon.prototype.renderMobileToolbar = function () {\n        var _this = this;\n        var toolbarPanel = this.parent.createElement('div', { className: 'e-toolbar-panel e-ribbon' });\n        var toolbar = this.parent.createElement('div');\n        var ddb = this.parent.createElement('button');\n        toolbarPanel.appendChild(toolbar);\n        toolbarPanel.appendChild(ddb);\n        toolbarPanel.style.display = 'block';\n        this.parent.element.appendChild(toolbarPanel);\n        var ddbObj = new DropDownButton({\n            cssClass: 'e-caret-hide',\n            content: this.ribbon.items[0].header.text,\n            items: [\n                { text: this.ribbon.items[0].header.text },\n                { text: this.ribbon.items[1].header.text },\n                { text: this.ribbon.items[2].header.text },\n                { text: this.ribbon.items[3].header.text }\n            ],\n            select: function (args) {\n                if (args.item.text !== ddbObj.content) {\n                    toolbarObj.element.style.display = 'none';\n                    ddbObj.content = args.item.text;\n                    ddbObj.dataBind();\n                    toolbarObj.items = _this.ribbon.items[ddbObj.items.indexOf(args.item) + 1].content;\n                    toolbarObj.width = \"calc(100% - \" + ddb.getBoundingClientRect().width + \"px)\";\n                    toolbarObj.element.style.display = '';\n                    toolbarObj.dataBind();\n                    toolbarObj.items[0].text = args.item.text;\n                    toolbarObj.dataBind();\n                }\n            },\n            open: function (args) {\n                var element = args.element.parentElement;\n                var clientRect = element.getBoundingClientRect();\n                var offset = calculatePosition(ddbObj.element, 'right', 'bottom');\n                element.style.left = offset.left - clientRect.width + \"px\";\n                element.style.top = offset.top - clientRect.height + \"px\";\n                for (var i = 0; i < ddbObj.items.length; i++) {\n                    if (ddbObj.content === ddbObj.items[i].text) {\n                        args.element.children[i].classList.add('e-selected');\n                        break;\n                    }\n                }\n            },\n            close: function () { return _this.parent.element.focus(); }\n        });\n        ddbObj.createElement = this.parent.createElement;\n        ddbObj.appendTo(ddb);\n        var toolbarObj = new Toolbar({\n            width: \"calc(100% - \" + ddb.getBoundingClientRect().width + \"px)\",\n            items: this.ribbon.items[0].content,\n            clicked: this.toolbarClicked.bind(this)\n        });\n        toolbarObj.createElement = this.parent.createElement;\n        toolbarObj.appendTo(toolbar);\n        toolbarPanel.style.display = '';\n    };\n    Ribbon.prototype.fileMenuBeforeOpen = function (args) {\n        var _this = this;\n        var l10n = this.parent.serviceLocator.getService(locale);\n        var wrapper;\n        var contents = ['.xlsx', '.xls', '.csv'];\n        if (args.parentItem.text === l10n.getConstant('SaveAs')) {\n            [].slice.call(args.element.children).forEach(function (li, index) {\n                wrapper = _this.parent.createElement('div', { innerHTML: li.innerHTML });\n                li.innerHTML = '';\n                wrapper.appendChild(_this.parent.createElement('span', { className: 'e-extension', innerHTML: contents[index] }));\n                li.appendChild(wrapper);\n            });\n        }\n        this.parent.trigger('fileMenuBeforeOpen', args);\n    };\n    Ribbon.prototype.enableRibbonTabs = function (args) {\n        this.ribbon.enableTabs(args.tabs, args.enable);\n    };\n    Ribbon.prototype.fileMenuBeforeClose = function (args) {\n        this.parent.trigger('fileMenuBeforeClose', args);\n    };\n    Ribbon.prototype.hideFileMenuItems = function (args) {\n        this.ribbon.hideMenuItems(args.items, args.hide, args.isUniqueId);\n    };\n    Ribbon.prototype.addFileMenuItems = function (args) {\n        this.ribbon.addMenuItems(args.items, args.text, args.insertAfter, args.isUniqueId);\n    };\n    Ribbon.prototype.hideToolbarItems = function (args) {\n        this.ribbon.hideToolbarItems(args.tab, args.indexes, args.hide);\n    };\n    Ribbon.prototype.protectSheetHandler = function (args) {\n        var sheet = this.parent.getActiveSheet();\n        var l10n = this.parent.serviceLocator.getService(locale);\n        if ((sheet.isProtected && sheet.protectSettings.formatCells) || !sheet.isProtected) {\n            this.enableToolbarItems([{ tab: l10n.getConstant('Home'), items: args.enableHomeBtnId, enable: true }]);\n            this.parent.notify(setUndoRedo, null);\n        }\n        else {\n            this.enableToolbarItems([{ tab: l10n.getConstant('Home'), items: args.disableHomeBtnId, enable: false }]);\n        }\n        if ((sheet.isProtected && sheet.protectSettings.insertLink) || !sheet.isProtected) {\n            this.enableToolbarItems([{ tab: l10n.getConstant('Insert'), items: args.enableInsertBtnId, enable: true }]);\n        }\n        else {\n            this.enableToolbarItems([{ tab: l10n.getConstant('Insert'), items: args.enableInsertBtnId, enable: false }]);\n        }\n        if ((sheet.isProtected && sheet.protectSettings.selectCells) || !sheet.isProtected) {\n            this.enableToolbarItems([{ tab: l10n.getConstant('Home'), items: args.findBtnId, enable: true }]);\n        }\n        else {\n            this.enableToolbarItems([{ tab: l10n.getConstant('Home'), items: args.findBtnId, enable: false }]);\n        }\n        if (sheet.isProtected) {\n            this.enableToolbarItems([{ tab: l10n.getConstant('Data'), items: args.dataValidationBtnId, enable: false }]);\n            this.enableToolbarItems([{ tab: l10n.getConstant('Formulas'), items: args.enableFrmlaBtnId, enable: false }]);\n            this.enableToolbarItems([{ tab: l10n.getConstant('Insert'), items: args.imageBtnId, enable: false }]);\n            this.enableToolbarItems([{ tab: l10n.getConstant('Insert'), items: args.chartBtnId, enable: false }]);\n        }\n        else {\n            this.enableToolbarItems([{ tab: l10n.getConstant('Data'), items: args.dataValidationBtnId, enable: true }]);\n            this.enableToolbarItems([{ tab: l10n.getConstant('Formulas'), items: args.enableFrmlaBtnId, enable: true }]);\n            this.enableToolbarItems([{ tab: l10n.getConstant('Insert'), items: args.imageBtnId, enable: true }]);\n            this.enableToolbarItems([{ tab: l10n.getConstant('Insert'), items: args.chartBtnId, enable: true }]);\n        }\n    };\n    Ribbon.prototype.updateMergeItem = function (e) {\n        if (e.type === 'mousemove' || e.type === 'pointermove' || (e.shiftKey && e.type === 'mousedown')) {\n            var indexes = getRangeIndexes(this.parent.getActiveSheet().selectedRange);\n            if ((indexes[1] !== indexes[3] || indexes[0] !== indexes[2]) && !this.parent.getActiveSheet().isProtected) {\n                this.enableToolbarItems([{ tab: this.parent.serviceLocator.getService(locale).getConstant('Home'),\n                        items: [this.parent.element.id + \"_merge_cells\"], enable: true }]);\n                this.toggleActiveState(false);\n            }\n        }\n    };\n    Ribbon.prototype.addEventListener = function () {\n        this.parent.on(ribbon, this.initRibbon, this);\n        this.parent.on(enableToolbarItems, this.enableToolbarItems, this);\n        this.parent.on(activeCellChanged, this.refreshRibbonContent, this);\n        this.parent.on(updateToggleItem, this.toggleRibbonItems, this);\n        this.parent.on(enableFileMenuItems, this.enableFileMenuItems, this);\n        this.parent.on(hideRibbonTabs, this.hideRibbonTabs, this);\n        this.parent.on(addRibbonTabs, this.addRibbonTabs, this);\n        this.parent.on(addToolbarItems, this.addToolbarItems, this);\n        this.parent.on(hideFileMenuItems, this.hideFileMenuItems, this);\n        this.parent.on(addFileMenuItems, this.addFileMenuItems, this);\n        this.parent.on(hideToolbarItems, this.hideToolbarItems, this);\n        this.parent.on(enableRibbonTabs, this.enableRibbonTabs, this);\n        this.parent.on(protectCellFormat, this.protectSheetHandler, this);\n        this.parent.on(selectionComplete, this.updateMergeItem, this);\n        this.parent.on(refreshRibbonIcons, this.refreshToggleBtn, this);\n    };\n    Ribbon.prototype.destroy = function () {\n        var parentElem = this.parent.element;\n        var ribbonEle = this.ribbon.element;\n        var id = parentElem.id;\n        ['bold', 'italic', 'line-through', 'underline'].forEach(function (name) {\n            destroyComponent(select('#' + (id + \"_\" + name), parentElem), Button);\n        });\n        this.pasteSplitBtn.destroy();\n        this.pasteSplitBtn = null;\n        this.mergeSplitBtn.destroy();\n        this.mergeSplitBtn = null;\n        this.numFormatDDB.destroy();\n        this.numFormatDDB = null;\n        this.fontSizeDdb.destroy();\n        this.fontSizeDdb = null;\n        this.fontNameDdb.destroy();\n        this.fontNameDdb = null;\n        this.textAlignDdb.destroy();\n        this.textAlignDdb = null;\n        this.verticalAlignDdb.destroy();\n        this.verticalAlignDdb = null;\n        this.sortingDdb.destroy();\n        this.sortingDdb = null;\n        this.clearDdb.destroy();\n        this.clearDdb = null;\n        this.colorPicker.destroy();\n        this.colorPicker = null;\n        this.bordersMenu.destroy();\n        this.bordersMenu = null;\n        this.bordersDdb.destroy();\n        this.bordersDdb = null;\n        this.findDdb.destroy();\n        this.findDdb = null;\n        this.chartDdb.destroy();\n        this.chartDdb = null;\n        this.chartMenu.destroy();\n        this.chartMenu = null;\n        this.parent.notify('destroyRibbonComponents', null);\n        this.ribbon.destroy();\n        if (ribbonEle) {\n            detach(ribbonEle);\n        }\n        this.ribbon = null;\n        this.removeEventListener();\n    };\n    Ribbon.prototype.removeEventListener = function () {\n        if (!this.parent.isDestroyed) {\n            this.parent.off(ribbon, this.initRibbon);\n            this.parent.off(enableToolbarItems, this.enableToolbarItems);\n            this.parent.off(activeCellChanged, this.refreshRibbonContent);\n            this.parent.off(updateToggleItem, this.toggleRibbonItems);\n            this.parent.off(enableFileMenuItems, this.enableFileMenuItems);\n            this.parent.off(hideRibbonTabs, this.hideRibbonTabs);\n            this.parent.off(addRibbonTabs, this.addRibbonTabs);\n            this.parent.off(addToolbarItems, this.addToolbarItems);\n            this.parent.off(hideFileMenuItems, this.hideFileMenuItems);\n            this.parent.off(addFileMenuItems, this.addFileMenuItems);\n            this.parent.off(hideToolbarItems, this.hideToolbarItems);\n            this.parent.off(enableRibbonTabs, this.enableRibbonTabs);\n            this.parent.off(protectCellFormat, this.protectSheetHandler);\n            this.parent.off(selectionComplete, this.updateMergeItem);\n            this.parent.off(refreshRibbonIcons, this.refreshToggleBtn);\n        }\n    };\n    return Ribbon;\n}());\nexport { Ribbon };\n","import { formulaBar, locale, selectionComplete, enableFormulaInput } from '../common/index';\nimport { mouseUpAfterSelection, click } from '../common/index';\nimport { getRangeIndexes, getRangeFromAddress, getCellAddress, getCellIndexes } from './../../workbook/common/address';\nimport { getSheetName, getTypeFromFormat, getSheet, checkIsFormula } from '../../workbook/index';\nimport { updateSelectedRange, getSheetNameFromAddress, getSheetIndex } from '../../workbook/index';\nimport { ComboBox, DropDownList } from '@syncfusion/ej2-dropdowns';\nimport { rippleEffect, EventHandler, detach, Internationalization, isNullOrUndefined, closest, select } from '@syncfusion/ej2-base';\nimport { isUndefined } from '@syncfusion/ej2-base';\nimport { editOperation, formulaBarOperation, keyDown, keyUp, formulaOperation, editAlert, editValue } from '../common/event';\nimport { intToDate } from '../../workbook/common/math';\nimport { ListView } from '@syncfusion/ej2-lists';\nimport { workbookFormulaOperation } from '../../workbook/common/event';\nimport { isFormulaBarEdit } from '../common/event';\n/**\n * Represents Formula bar for Spreadsheet.\n */\nvar FormulaBar = /** @class */ (function () {\n    function FormulaBar(parent) {\n        this.categoryCollection = [];\n        this.formulaCollection = [];\n        this.isGoto = false;\n        this.parent = parent;\n        this.addEventListener();\n    }\n    FormulaBar.prototype.getModuleName = function () {\n        return 'formulaBar';\n    };\n    FormulaBar.prototype.createFormulaBar = function (args) {\n        if (!this.parent.showFormulaBar && this.insertFnRipple) {\n            this.destroy();\n            return;\n        }\n        var l10n = this.parent.serviceLocator.getService(locale);\n        var id = this.parent.element.id;\n        var fBarWrapper = this.parent.createElement('div', { className: 'e-formula-bar-panel' });\n        if (!this.parent.isMobileView()) {\n            var nameBox = this.parent.createElement('input', { id: id + '_name_box', attrs: { type: 'text' } });\n            fBarWrapper.appendChild(nameBox);\n            this.comboBoxInstance = new ComboBox({\n                value: 'A1',\n                cssClass: 'e-name-box',\n                width: '',\n                noRecordsTemplate: '',\n                fields: { text: 'name', value: 'refersTo' },\n                beforeOpen: this.nameBoxBeforeOpen.bind(this),\n                blur: this.nameBoxBlur.bind(this),\n                select: this.nameBoxSelect.bind(this),\n                change: function (args) {\n                    /** */\n                }\n            });\n            this.comboBoxInstance.createElement = this.parent.createElement;\n            this.comboBoxInstance.appendTo(nameBox);\n            this.comboBoxInstance.element.parentElement.title = l10n.getConstant('NameBox');\n        }\n        var insertFnBtn = fBarWrapper.appendChild(this.parent.createElement('button', {\n            className: 'e-btn e-css e-flat e-icon-btn e-insert-function', attrs: { 'title': l10n.getConstant('InsertFunction') }\n        }));\n        insertFnBtn.appendChild(this.parent.createElement('span', { className: 'e-btn-icon e-icons' }));\n        this.insertFnRipple = rippleEffect(fBarWrapper, { selector: '.e-insert-function' });\n        fBarWrapper.appendChild(this.parent.createElement('div', { className: 'e-separator' }));\n        var textarea = fBarWrapper.appendChild(this.parent.createElement('textarea', {\n            className: 'e-formula-bar e-css', id: id + '_formula_input',\n            attrs: { 'title': l10n.getConstant('FormulaBar'), 'spellcheck': 'false' }\n        }));\n        textarea.rows = 1;\n        if (this.parent.isMobileView()) {\n            textarea.placeholder = l10n.getConstant('MobileFormulaBarPlaceHolder');\n            EventHandler.add(textarea, 'focus', this.textAreaFocusIn, this);\n            EventHandler.add(textarea, 'blur', this.textAreaFocusOut, this);\n        }\n        else {\n            fBarWrapper.appendChild(this.parent.createElement('span', {\n                className: 'e-drop-icon e-icons', attrs: { 'title': l10n.getConstant('ExpandFormulaBar') }\n            }));\n        }\n        if (args && args.uiUpdate) {\n            this.parent.element.insertBefore(fBarWrapper, document.getElementById(id + '_sheet_panel'));\n        }\n        else {\n            this.parent.element.appendChild(fBarWrapper);\n        }\n    };\n    FormulaBar.prototype.textAreaFocusIn = function (e) {\n        var formulaPanel = this.parent.element.querySelector('.e-formula-bar-panel');\n        var tickBtn = this.parent.createElement('button', { className: 'e-btn e-css e-flat e-icon-btn e-formula-submit' });\n        tickBtn.appendChild(this.parent.createElement('span', { className: 'e-btn-icon e-icons e-tick-icon' }));\n        formulaPanel.classList.add('e-focused');\n        formulaPanel.appendChild(tickBtn);\n    };\n    FormulaBar.prototype.textAreaFocusOut = function (e) {\n        var formulaPanel = this.parent.element.querySelector('.e-formula-bar-panel');\n        formulaPanel.classList.remove('e-focused');\n        detach(formulaPanel.querySelector('.e-formula-submit'));\n    };\n    FormulaBar.prototype.keyDownHandler = function (e) {\n        var trgtElem = e.target;\n        if (this.parent.isEdit && !this.parent.getActiveSheet().isProtected) {\n            if ((checkIsFormula(trgtElem.value) || (trgtElem.validity && trgtElem.value.toString().indexOf('=') === 0)) &&\n                e.keyCode === 16) {\n                return;\n            }\n            if (trgtElem.classList.contains('e-formula-bar')) {\n                this.parent.notify(editOperation, { action: 'refreshEditor', value: trgtElem.value, refreshEditorElem: true });\n            }\n        }\n    };\n    FormulaBar.prototype.keyUpHandler = function (e) {\n        if (this.parent.isEdit) {\n            var trgtElem = e.target;\n            if (trgtElem.classList.contains('e-formula-bar')) {\n                var eventArg = { action: 'getCurrentEditValue', editedValue: '' };\n                this.parent.notify(editOperation, eventArg);\n                if (eventArg.editedValue !== trgtElem.value && e.keyCode !== 16) {\n                    this.parent.notify(editOperation, { action: 'refreshEditor', value: trgtElem.value, refreshEditorElem: true });\n                }\n            }\n        }\n    };\n    FormulaBar.prototype.nameBoxBeforeOpen = function (args) {\n        if (this.comboBoxInstance.element.classList.contains('e-name-editing')) {\n            args.cancel = true;\n        }\n        else {\n            this.comboBoxInstance.element.select();\n        }\n    };\n    FormulaBar.prototype.nameBoxBlur = function (args) {\n        if (this.comboBoxInstance.element.classList.contains('e-name-editing')) {\n            this.comboBoxInstance.element.classList.remove('e-name-editing');\n            this.UpdateValueAfterMouseUp();\n        }\n    };\n    FormulaBar.prototype.nameBoxSelect = function (args) {\n        if (args.isInteracted) {\n            var refersTo = args.itemData.refersTo.substr(1);\n            var sheetIdx = getSheetIndex(this.parent, getSheetNameFromAddress(refersTo));\n            var range = getRangeFromAddress(refersTo);\n            var sheet = getSheet(this.parent, sheetIdx);\n            if (range.indexOf(':') !== -1) {\n                var colIndex = range.indexOf(':');\n                var left = range.substr(0, colIndex);\n                var right = range.substr(colIndex + 1, range.length);\n                left = left.replace('$', '');\n                right = right.replace('$', '');\n                if (right.match(/\\D/g) && !right.match(/[0-9]/g) && left.match(/\\D/g) && !left.match(/[0-9]/g)) {\n                    left = left + '1';\n                    right = right + sheet.rowCount;\n                    range = left + ':' + right;\n                }\n                else if (!right.match(/\\D/g) && right.match(/[0-9]/g) && !left.match(/\\D/g) && left.match(/[0-9]/g)) {\n                    left = getCellAddress(parseInt(left, 10) - 1, 0);\n                    right = getCellAddress(parseInt(right, 10) - 1, sheet.colCount - 1);\n                    range = left + ':' + right;\n                }\n            }\n            if ((sheetIdx) === this.parent.activeSheetIndex) {\n                this.parent.selectRange(range);\n                this.parent.element.focus();\n            }\n            else {\n                updateSelectedRange(this.parent, range, sheet);\n                this.parent.activeSheetIndex = sheetIdx;\n            }\n        }\n    };\n    FormulaBar.prototype.formulaBarUpdateHandler = function (e) {\n        var _this = this;\n        var sheet = this.parent.getActiveSheet();\n        var range = sheet.selectedRange.split(':');\n        var address;\n        var intl = new Internationalization();\n        if (e.type === 'mousemove' || e.type === 'pointermove') {\n            var indexes1 = getRangeIndexes(range[0]);\n            var indexes2 = getRangeIndexes(range[1]);\n            address = Math.abs(indexes1[0] - indexes2[0]) + 1 + \"R x \" + (Math.abs(indexes1[1] - indexes2[1]) + 1) + \"C\";\n            if (this.parent.isEdit) {\n                this.parent.notify(editValue, null);\n            }\n        }\n        else {\n            address = range[0];\n            var data = this.parent.getData(getSheetName(this.parent) + \"!\" + address);\n            data.then(function (values) {\n                var value = '';\n                var intDate;\n                values.forEach(function (cell, key) {\n                    var type = cell && cell.format ? getTypeFromFormat(cell.format) : 'General';\n                    if (cell) {\n                        if (!isNullOrUndefined(cell.value)) {\n                            intDate = intToDate(Number(cell.value));\n                            if (intDate.toString() !== 'Invalid Date' && (type === 'ShortDate' || type === 'LongDate')) {\n                                value = intl.formatDate(intDate, {\n                                    type: 'date',\n                                    skeleton: 'yMd'\n                                });\n                            }\n                            else if (intDate.toString() !== 'Invalid Date' && type === 'Time') {\n                                value = intl.formatDate(intDate, {\n                                    type: 'dateTime',\n                                    skeleton: 'yMd'\n                                }) + ' ' + intl.formatDate(intDate, {\n                                    type: 'dateTime',\n                                    skeleton: 'hms'\n                                });\n                            }\n                            else {\n                                value = cell.value;\n                            }\n                        }\n                        if (cell.formula) {\n                            value = cell.formula;\n                        }\n                    }\n                    var eventArgs = { action: 'getCurrentEditValue', editedValue: '' };\n                    _this.parent.notify(editOperation, eventArgs);\n                    var isFormulaEdit = (eventArgs.editedValue && eventArgs.editedValue.toString().indexOf('=') === 0) ||\n                        checkIsFormula(eventArgs.editedValue);\n                    var formulaInp = document.getElementById(_this.parent.element.id + '_formula_input');\n                    var addressRange = getRangeIndexes(address);\n                    var cellEle = _this.parent.getCell(addressRange[0], addressRange[1]);\n                    if (cell && !cell.formula && cellEle) {\n                        formulaInp.value = cellEle.textContent;\n                    }\n                    else {\n                        formulaInp.value = value;\n                    }\n                    if (!isNullOrUndefined(value) && !isFormulaEdit) {\n                        _this.parent.notify(editOperation, { action: 'refreshEditor', value: formulaInp.value, refreshEditorElem: true });\n                    }\n                    if (_this.parent.isEdit) {\n                        _this.parent.notify(editValue, null);\n                    }\n                });\n            });\n        }\n        this.updateComboBoxValue(address);\n    };\n    FormulaBar.prototype.UpdateValueAfterMouseUp = function () {\n        this.updateComboBoxValue(this.parent.getActiveSheet().selectedRange.split(':')[0]);\n    };\n    FormulaBar.prototype.updateComboBoxValue = function (value) {\n        var sheet = this.parent.getActiveSheet();\n        var range = getSheetName(this.parent) + '!' + sheet.selectedRange;\n        var eventArgs = {\n            action: 'getNameFromRange', range: range, definedName: null\n        };\n        this.parent.notify(formulaOperation, eventArgs);\n        if (eventArgs.definedName) {\n            value = eventArgs.definedName.name;\n        }\n        if (!this.parent.isMobileView()) {\n            if (this.comboBoxInstance.text === value) {\n                return;\n            }\n            this.comboBoxInstance.text = value;\n            this.comboBoxInstance.dataBind();\n        }\n    };\n    FormulaBar.prototype.disabletextarea = function () {\n        var element = this.getFormulaBar();\n        if (this.parent.getActiveSheet().isProtected) {\n            element.disabled = true;\n        }\n        else {\n            element.disabled = false;\n        }\n    };\n    FormulaBar.prototype.formulaBarScrollEdit = function () {\n        var index = getRangeIndexes(this.parent.getActiveSheet().selectedRange);\n        var viewportIndexes = getCellIndexes(this.parent.getActiveSheet().topLeftCell);\n        if (index[0] < viewportIndexes[0]) {\n            this.parent.goTo(this.parent.getActiveSheet().selectedRange);\n            this.isGoto = true;\n        }\n        this.parent.notify(editOperation, { action: 'startEdit', refreshCurPos: false });\n    };\n    FormulaBar.prototype.formulaBarClickHandler = function (e) {\n        var _this = this;\n        var target = e.target;\n        if (target.classList.contains('e-drop-icon') && closest(target, '.e-formula-bar-panel')) {\n            this.toggleFormulaBar(target);\n        }\n        else if (target.classList.contains('e-formula-bar')) {\n            if (!this.parent.isEdit && !this.parent.getActiveSheet().isProtected) {\n                this.formulaBarScrollEdit();\n            }\n            else if (this.parent.getActiveSheet().isProtected) {\n                this.parent.notify(editAlert, null);\n            }\n        }\n        else if (target.parentElement && target.parentElement.classList.contains('e-name-box')) {\n            if (target.classList.contains('e-ddl-icon')) {\n                var eventArgs = { action: 'getNames', names: [] };\n                this.parent.notify(formulaOperation, eventArgs);\n                this.comboBoxInstance.dataSource = eventArgs.names;\n            }\n            else {\n                this.comboBoxInstance.element.classList.add('e-name-editing');\n                this.comboBoxInstance.element.select();\n            }\n        }\n        if (!isNullOrUndefined(target.offsetParent) && ((target.offsetParent.classList.contains('e-insert-function')) ||\n            (target.classList.contains('e-insert-function')) || (this.parent.element.id + '_insert_function' === target.offsetParent.id)\n            || (this.parent.element.id + '_insert_function' === target.id) ||\n            target.parentElement.classList.contains('e-insert-function')\n            || (this.parent.element.id + '_insert_function' === target.parentElement.id))) {\n            if (this.parent.getActiveSheet().isProtected) {\n                this.parent.notify(editAlert, null);\n                return;\n            }\n            var isOpen = !this.parent.isEdit;\n            var args = { action: 'getCurrentEditValue', editedValue: '' };\n            if (!isOpen) {\n                var eventArgs = { action: 'isFormulaEditing', isFormulaEdit: false };\n                this.parent.notify(formulaOperation, eventArgs);\n                isOpen = eventArgs.isFormulaEdit;\n                this.parent.notify(editOperation, args);\n            }\n            if (isOpen || args.editedValue === '') {\n                if (args.editedValue === '') {\n                    this.parent.notify(editOperation, { action: 'refreshEditor', value: '=' });\n                }\n                var l10n = this.parent.serviceLocator.getService(locale);\n                var formulaDescription = this.parent.createElement('div', { className: 'e-formula-description', id: this.parent.element.id + '_description_content' });\n                var categoryContent = this.parent.createElement('div', {\n                    className: 'e-category-content', id: this.parent.element.id + '_category_content',\n                    innerHTML: l10n.getConstant('PickACategory')\n                });\n                var dropDownElement = this.parent.createElement('input', { className: 'e-formula-category', id: this.parent.element.id + '_formula_category' });\n                var listViewElement = this.parent.createElement('div', { className: 'e-formula-list', id: this.parent.element.id + '_formula_list' });\n                var descriptionContent = this.parent.createElement('div', { className: 'e-description-content', innerHTML: l10n.getConstant('Description') });\n                var headerContent = this.parent.createElement('div', { className: 'e-header-content', innerHTML: l10n.getConstant('InsertFunction') });\n                var categoryArgs = {\n                    action: 'getFormulaCategory', categoryCollection: []\n                };\n                this.parent.notify(workbookFormulaOperation, categoryArgs);\n                this.categoryCollection = categoryArgs.categoryCollection;\n                this.categoryList = new DropDownList({\n                    dataSource: this.categoryCollection, index: 0, width: '285px', popupHeight: '210px',\n                    select: this.dropDownSelect.bind(this)\n                });\n                var listArgs = {\n                    action: 'getLibraryFormulas', formulaCollection: []\n                };\n                this.parent.notify(workbookFormulaOperation, listArgs);\n                this.formulaCollection = listArgs.formulaCollection;\n                this.formulaList = new ListView({\n                    dataSource: this.formulaCollection.sort(),\n                    actionComplete: this.updateFormulaList.bind(this),\n                    select: this.listSelected.bind(this), width: '285px', height: '200px'\n                });\n                this.dialog = this.parent.serviceLocator.getService('dialog');\n                this.dialog.show({\n                    header: headerContent.outerHTML,\n                    content: categoryContent.outerHTML + dropDownElement.outerHTML + listViewElement.outerHTML +\n                        descriptionContent.outerHTML + formulaDescription.outerHTML,\n                    width: '320px', height: '485px', cssClass: 'e-spreadsheet-function-dlg',\n                    showCloseIcon: true, isModal: true,\n                    beforeOpen: function (args) {\n                        var dlgArgs = {\n                            dialogName: 'InsertFunctionDialog', element: args.element, target: args.target, cancel: args.cancel\n                        };\n                        _this.parent.trigger('dialogBeforeOpen', dlgArgs);\n                        if (dlgArgs.cancel) {\n                            args.cancel = true;\n                        }\n                        _this.parent.element.focus();\n                    },\n                    open: this.dialogOpen.bind(this), beforeClose: this.dialogBeforeClose.bind(this), close: this.dialogClose.bind(this),\n                    buttons: [\n                        {\n                            click: (this.selectFormula.bind(this, this.dialog, this)),\n                            buttonModel: { content: l10n.getConstant('Ok'), isPrimary: true }\n                        }\n                    ]\n                });\n                this.categoryList.appendTo('#' + this.parent.element.id + '_formula_category');\n                this.formulaList.appendTo('#' + this.parent.element.id + '_formula_list');\n                EventHandler.add(this.formulaList.element, 'dblclick', this.formulaClickHandler, this);\n            }\n        }\n    };\n    FormulaBar.prototype.toggleFormulaBar = function (target) {\n        var parent = target.parentElement;\n        var l10n = this.parent.serviceLocator.getService(locale);\n        if (parent.classList.contains('e-expanded')) {\n            parent.classList.remove('e-expanded');\n            document.getElementById(this.parent.element.id + '_formula_input').rows = 1;\n            target.title = l10n.getConstant('ExpandFormulaBar');\n        }\n        else {\n            parent.classList.add('e-expanded');\n            document.getElementById(this.parent.element.id + '_formula_input').rows = 3;\n            target.title = l10n.getConstant('CollapseFormulaBar');\n        }\n        this.parent.setPanelSize();\n    };\n    FormulaBar.prototype.dialogOpen = function () {\n        this.focusOkButton();\n    };\n    FormulaBar.prototype.dialogClose = function () {\n        var args = { action: 'getCurrentEditValue', editedValue: '' };\n        this.parent.notify(editOperation, args);\n        if (args.editedValue.toString().trim() === '=') {\n            this.parent.notify(editOperation, { action: 'refreshEditor', value: '' });\n        }\n    };\n    FormulaBar.prototype.dialogBeforeClose = function () {\n        EventHandler.remove(this.formulaList.element, 'dblclick', this.formulaClickHandler);\n        var dialogContentEle = document.getElementById('_dialog-content');\n        dialogContentEle.parentNode.removeChild(dialogContentEle);\n        /* tslint:disable-next-line:no-any */\n        this.dialog.dialogInstance.storeActiveElement = document.getElementById(this.parent.element.id + '_edit');\n    };\n    FormulaBar.prototype.selectFormula = function (dialog, formulaBarObj) {\n        var formulaText = formulaBarObj.formulaList.getSelectedItems().text;\n        var sheet = getSheet(this.parent, this.parent.activeSheetIndex);\n        if (this.parent.isEdit) {\n            this.parent.notify(editOperation, {\n                action: 'refreshEditor', value: formulaText + '(', refreshFormulaBar: true,\n                refreshEditorElem: true, isAppend: true\n            });\n        }\n        else {\n            this.parent.notify(editOperation, { action: 'startEdit', value: '=' + formulaText + '(', address: sheet.activeCell });\n            this.parent.notify(formulaBarOperation, { action: 'refreshFormulabar', value: '=' + formulaText + '(' });\n        }\n        dialog.hide();\n    };\n    FormulaBar.prototype.listSelected = function () {\n        this.updateFormulaDescription();\n    };\n    FormulaBar.prototype.updateFormulaList = function () {\n        this.activeListFormula();\n        this.updateFormulaDescription();\n    };\n    FormulaBar.prototype.dropDownSelect = function (args) {\n        this.formulaCollection = [];\n        var listArgs = {\n            action: 'getLibraryFormulas',\n            formulaCollection: []\n        };\n        if (args.item.textContent === 'All') {\n            this.parent.notify(workbookFormulaOperation, listArgs);\n            this.formulaCollection = listArgs.formulaCollection;\n        }\n        else {\n            var category = args.item.textContent;\n            var selectArgs = {\n                action: 'dropDownSelectFormulas',\n                formulaCollection: [],\n                selectCategory: category,\n            };\n            this.parent.notify(workbookFormulaOperation, selectArgs);\n            this.formulaCollection = selectArgs.formulaCollection;\n        }\n        this.formulaList.dataSource = this.formulaCollection.sort();\n    };\n    FormulaBar.prototype.focusOkButton = function () {\n        var focusEle = document.getElementById('_dialog-content');\n        (focusEle.nextElementSibling.firstElementChild).focus();\n    };\n    FormulaBar.prototype.activeListFormula = function () {\n        var acListEle = document.getElementById(this.parent.element.id + '_formula_list');\n        var firstElement = acListEle.children[0].children[0].firstElementChild;\n        this.formulaList.selectItem(firstElement);\n    };\n    FormulaBar.prototype.updateFormulaDescription = function () {\n        var descriptionArea;\n        var selectedFormula = this.formulaList.getSelectedItems().text;\n        var descriptionArgs = {\n            action: 'getFormulaDescription',\n            description: '',\n            selectedList: selectedFormula,\n        };\n        this.parent.notify(workbookFormulaOperation, descriptionArgs);\n        this.focusOkButton();\n        descriptionArea = document.getElementById(this.parent.element.id + '_description_content');\n        selectedFormula = (selectedFormula === 'AND') ? 'CalculateAND' : (selectedFormula === 'OR') ? 'CalculateOR' : selectedFormula;\n        descriptionArea.innerHTML = this.parent.serviceLocator.getService(locale).getConstant(selectedFormula);\n    };\n    FormulaBar.prototype.formulaClickHandler = function (args) {\n        var trgtElem = args.target;\n        var sheet = getSheet(this.parent, this.parent.activeSheetIndex);\n        if (trgtElem.offsetParent.classList.contains('e-text-content') || trgtElem.classList.contains('e-list-item')) {\n            if (this.parent.isEdit) {\n                this.parent.notify(editOperation, {\n                    action: 'refreshEditor', value: trgtElem.innerText + '(', refreshFormulaBar: true,\n                    refreshEditorElem: true, isAppend: true\n                });\n            }\n            else {\n                this.parent.notify(editOperation, { action: 'startEdit', value: '=' + trgtElem.innerText + '(', address: sheet.activeCell });\n                this.parent.notify(formulaBarOperation, { action: 'refreshFormulabar', value: '=' + trgtElem.innerText + '(' });\n            }\n            this.dialog.hide();\n        }\n    };\n    FormulaBar.prototype.addEventListener = function () {\n        this.parent.on(formulaBar, this.createFormulaBar, this);\n        this.parent.on(click, this.formulaBarClickHandler, this);\n        this.parent.on(keyDown, this.keyDownHandler, this);\n        this.parent.on(keyUp, this.keyUpHandler, this);\n        this.parent.on(selectionComplete, this.formulaBarUpdateHandler, this);\n        this.parent.on(mouseUpAfterSelection, this.UpdateValueAfterMouseUp, this);\n        this.parent.on(formulaBarOperation, this.editOperationHandler, this);\n        this.parent.on(enableFormulaInput, this.disabletextarea, this);\n        this.parent.on(isFormulaBarEdit, this.isFormulaBarEdit, this);\n    };\n    FormulaBar.prototype.destroy = function () {\n        this.removeEventListener();\n        this.comboBoxInstance.destroy();\n        this.comboBoxInstance = null;\n        this.insertFnRipple();\n        this.insertFnRipple = null;\n        var formulaPanel = this.parent.element.querySelector('.e-formula-bar-panel');\n        if (formulaPanel) {\n            detach(formulaPanel);\n        }\n    };\n    FormulaBar.prototype.removeEventListener = function () {\n        if (!this.parent.isDestroyed) {\n            this.parent.off(formulaBar, this.createFormulaBar);\n            this.parent.off(click, this.formulaBarClickHandler);\n            this.parent.off(keyDown, this.keyDownHandler);\n            this.parent.off(keyUp, this.keyUpHandler);\n            this.parent.off(selectionComplete, this.formulaBarUpdateHandler);\n            this.parent.off(mouseUpAfterSelection, this.UpdateValueAfterMouseUp);\n            this.parent.off(formulaBarOperation, this.editOperationHandler);\n            this.parent.off(enableFormulaInput, this.disabletextarea);\n            this.parent.off(isFormulaBarEdit, this.isFormulaBarEdit);\n        }\n    };\n    FormulaBar.prototype.editOperationHandler = function (args) {\n        var action = args.action;\n        switch (action) {\n            case 'refreshFormulabar':\n                this.getFormulaBar().value = isUndefined(args.value) ? '' : args.value;\n                break;\n            case 'getPosition':\n                args.position = this.getFormulaBar().getBoundingClientRect();\n                break;\n        }\n    };\n    FormulaBar.prototype.isFormulaBarEdit = function (args) {\n        var edit = this.parent.isEdit;\n        if (edit && this.isGoto) {\n            args.isEdit = true;\n        }\n        else {\n            args.isEdit = false;\n        }\n    };\n    FormulaBar.prototype.getFormulaBar = function () {\n        return select('#' + this.parent.element.id + '_formula_input', this.parent.element);\n    };\n    return FormulaBar;\n}());\nexport { FormulaBar };\n","import { formulaOperation, keyUp, keyDown, click, refreshFormulaDatasource } from '../common/event';\nimport { editOperation, formulaBarOperation } from '../common/event';\nimport { workbookFormulaOperation } from '../../workbook/common/event';\nimport { AutoComplete } from '@syncfusion/ej2-dropdowns';\nimport { detach, isNullOrUndefined, select } from '@syncfusion/ej2-base';\nimport { checkIsFormula, getSheet, getSheetName, getCellIndexes } from '../../workbook/index';\nimport { dialog, locale } from '../common/index';\n/**\n * @hidden\n * The `Formula` module is used to handle the formulas and its functionalities in Spreadsheet.\n */\nvar Formula = /** @class */ (function () {\n    /**\n     * Constructor for formula module in Spreadsheet.\n     * @private\n     */\n    function Formula(parent) {\n        this.isFormulaBar = false;\n        this.isFormula = false;\n        this.isPopupOpened = false;\n        this.isPreventClose = false;\n        this.isSubFormula = false;\n        this.keyCodes = {\n            UP: 38,\n            DOWN: 40,\n            LEFT: 37,\n            RIGHT: 39,\n            FIRSTALPHABET: 65,\n            LASTALPHABET: 90,\n            SPACE: 32,\n            BACKSPACE: 8,\n            TAB: 9,\n            DELETE: 46,\n            ENTER: 13,\n            ESC: 27\n        };\n        this.parent = parent;\n        this.addEventListener();\n        //Spreadsheet.Inject(WorkbookFormula);\n    }\n    /**\n     * Get the module name.\n     * @returns string\n     * @private\n     */\n    Formula.prototype.getModuleName = function () {\n        return 'formula';\n    };\n    /**\n     * To destroy the formula module.\n     * @return {void}\n     * @hidden\n     */\n    Formula.prototype.destroy = function () {\n        this.removeEventListener();\n        if (this.autocompleteInstance) {\n            this.autocompleteInstance.destroy();\n            if (this.autocompleteInstance.element) {\n                this.autocompleteInstance.element.remove();\n            }\n        }\n        this.autocompleteInstance = null;\n        this.parent = null;\n    };\n    Formula.prototype.addEventListener = function () {\n        this.parent.on(formulaOperation, this.performFormulaOperation, this);\n        this.parent.on(keyUp, this.keyUpHandler, this);\n        this.parent.on(keyDown, this.keyDownHandler, this);\n        this.parent.on(click, this.formulaClick, this);\n        this.parent.on(refreshFormulaDatasource, this.refreshFormulaDatasource, this);\n    };\n    Formula.prototype.removeEventListener = function () {\n        if (!this.parent.isDestroyed) {\n            this.parent.off(formulaOperation, this.performFormulaOperation);\n            this.parent.off(keyUp, this.keyUpHandler);\n            this.parent.off(keyDown, this.keyDownHandler);\n            this.parent.off(click, this.formulaClick);\n            this.parent.off(refreshFormulaDatasource, this.refreshFormulaDatasource);\n        }\n    };\n    Formula.prototype.performFormulaOperation = function (args) {\n        var _this = this;\n        var action = args.action;\n        switch (action) {\n            case 'renderAutoComplete':\n                this.renderAutoComplete();\n                break;\n            case 'endEdit':\n                this.endEdit();\n                break;\n            case 'addDefinedName':\n                args.isAdded = this.addDefinedName(args.definedName);\n                break;\n            case 'getNames':\n                if (!args.sheetName) {\n                    args.sheetName = getSheetName(this.parent);\n                }\n                args.names = this.getNames(args.sheetName);\n                break;\n            case 'getNameFromRange':\n                args.definedName = this.getNameFromRange(args.range);\n                break;\n            case 'isFormulaEditing':\n                args.isFormulaEdit = this.isFormula;\n                break;\n            case 'isCircularReference':\n                var l10n = this.parent.serviceLocator.getService(locale);\n                var dialogInst = this.parent.serviceLocator.getService(dialog);\n                dialogInst.show({\n                    height: 180, width: 400, isModal: true, showCloseIcon: true,\n                    content: l10n.getConstant('CircularReference'),\n                    beforeOpen: function (args) {\n                        var dlgArgs = {\n                            dialogName: 'CircularReferenceDialog',\n                            element: args.element, target: args.target, cancel: args.cancel\n                        };\n                        _this.parent.trigger('dialogBeforeOpen', dlgArgs);\n                        if (dlgArgs.cancel) {\n                            args.cancel = true;\n                        }\n                    },\n                });\n                args.argValue = '0';\n                break;\n        }\n    };\n    Formula.prototype.renderAutoComplete = function () {\n        if (!select('#' + this.parent.element.id + '_ac', this.parent.element)) {\n            var acElem = this.parent.createElement('input', { id: this.parent.element.id + '_ac', className: 'e-ss-ac' });\n            this.parent.element.appendChild(acElem);\n            var eventArgs = {\n                action: 'getLibraryFormulas',\n                formulaCollection: []\n            };\n            this.parent.notify(workbookFormulaOperation, eventArgs);\n            var autoCompleteOptions = {\n                dataSource: eventArgs.formulaCollection,\n                cssClass: 'e-ss-atc',\n                popupWidth: '130px',\n                allowFiltering: true,\n                filterType: 'StartsWith',\n                sortOrder: 'Ascending',\n                open: this.onSuggestionOpen.bind(this),\n                close: this.onSuggestionClose.bind(this),\n                select: this.onSelect.bind(this),\n                actionComplete: this.onSuggestionComplete.bind(this)\n            };\n            this.autocompleteInstance = new AutoComplete(autoCompleteOptions, acElem);\n            this.autocompleteInstance.createElement = this.parent.createElement;\n        }\n    };\n    Formula.prototype.onSuggestionOpen = function (e) {\n        var _this = this;\n        this.isPopupOpened = true;\n        var position = this.getPopupPosition();\n        e.popup.offsetX = position.left;\n        e.popup.offsetY = (position.top + position.height);\n        e.popup.refreshPosition();\n        e.popup.element.firstChild.style.maxHeight = '180px';\n        new Promise(function (resolve, reject) {\n            setTimeout(function () { resolve(); }, 100);\n        }).then(function () {\n            _this.triggerKeyDownEvent(_this.keyCodes.DOWN);\n        });\n    };\n    Formula.prototype.onSuggestionClose = function (e) {\n        if (this.isPreventClose) {\n            e.cancel = true;\n        }\n        else {\n            this.isPopupOpened = false;\n        }\n    };\n    Formula.prototype.onSelect = function (e) {\n        var updatedFormulaValue = '=' + e.itemData.value + '(';\n        if (this.isSubFormula) {\n            var editValue = this.getEditingValue();\n            var parseIndex = editValue.lastIndexOf(this.getArgumentSeparator());\n            if (parseIndex > -1) {\n                updatedFormulaValue = editValue.slice(0, parseIndex + 1);\n            }\n            else {\n                parseIndex = editValue.lastIndexOf('(');\n                if (parseIndex > -1) {\n                    updatedFormulaValue = editValue.slice(0, parseIndex + 1);\n                }\n            }\n            updatedFormulaValue += e.itemData.value + '(';\n        }\n        this.parent.notify(editOperation, {\n            action: 'refreshEditor', value: updatedFormulaValue,\n            refreshFormulaBar: true, refreshEditorElem: true, refreshCurPos: !this.isFormulaBar\n        });\n    };\n    Formula.prototype.onSuggestionComplete = function (args) {\n        this.isPreventClose = args.result.length > 0;\n        if (!this.isPreventClose) {\n            args.cancel = true;\n            this.hidePopUp();\n        }\n    };\n    Formula.prototype.refreshFormulaDatasource = function () {\n        var eventArgs = {\n            action: 'getLibraryFormulas',\n            formulaCollection: []\n        };\n        this.parent.notify(workbookFormulaOperation, eventArgs);\n        this.autocompleteInstance.dataSource = eventArgs.formulaCollection;\n    };\n    Formula.prototype.keyUpHandler = function (e) {\n        if (this.parent.isEdit) {\n            var editValue = this.getEditingValue();\n            this.isFormula = checkIsFormula(editValue);\n            if (this.isFormula || this.isPopupOpened) {\n                if (e.keyCode !== this.keyCodes.TAB && this.isFormula) {\n                    editValue = this.getSuggestionKeyFromFormula(editValue);\n                }\n                this.refreshFormulaSuggestion(e, editValue);\n            }\n        }\n        else if (this.isPopupOpened) {\n            this.hidePopUp();\n        }\n    };\n    Formula.prototype.keyDownHandler = function (e) {\n        var keyCode = e.keyCode;\n        if (this.isFormula) {\n            if (this.isPopupOpened) {\n                switch (keyCode) {\n                    case this.keyCodes.UP:\n                    case this.keyCodes.DOWN:\n                        e.preventDefault();\n                        this.triggerKeyDownEvent(keyCode);\n                        break;\n                    case this.keyCodes.TAB:\n                        e.preventDefault();\n                        this.triggerKeyDownEvent(this.keyCodes.ENTER);\n                        break;\n                }\n            }\n        }\n        else {\n            var trgtElem = e.target;\n            if (trgtElem.id === this.parent.element.id + '_name_box') {\n                switch (keyCode) {\n                    case this.keyCodes.ENTER:\n                        this.addDefinedName({ name: trgtElem.value });\n                        this.parent.element.focus();\n                        break;\n                    case this.keyCodes.ESC:\n                        this.parent.element.focus();\n                        break;\n                }\n            }\n        }\n    };\n    Formula.prototype.formulaClick = function (e) {\n        if (this.parent.isEdit) {\n            var trgtElem = e.target;\n            this.isFormulaBar = trgtElem.classList.contains('e-formula-bar');\n        }\n    };\n    Formula.prototype.refreshFormulaSuggestion = function (e, formula) {\n        if (formula.length > 0) {\n            var autoCompleteElem = this.autocompleteInstance.element;\n            var keyCode = e.keyCode;\n            var isSuggestionAlreadyOpened = this.isPopupOpened;\n            if (!this.isNavigationKey(keyCode)) {\n                autoCompleteElem.value = formula;\n                autoCompleteElem.dispatchEvent(new Event('input'));\n                autoCompleteElem.dispatchEvent(new Event('keyup'));\n                if (isSuggestionAlreadyOpened) {\n                    this.triggerKeyDownEvent(this.keyCodes.DOWN);\n                }\n            }\n        }\n        else {\n            if (this.isPopupOpened) {\n                this.isPreventClose = false;\n                this.hidePopUp();\n            }\n        }\n    };\n    Formula.prototype.endEdit = function () {\n        this.isSubFormula = false;\n        this.isPreventClose = false;\n        this.isFormula = false;\n        this.isFormulaBar = false;\n        if (this.isPopupOpened) {\n            this.hidePopUp();\n            var suggPopupElem = select('#' + this.parent.element.id + '_ac_popup');\n            if (suggPopupElem) {\n                detach(suggPopupElem);\n            }\n            this.isPopupOpened = false;\n        }\n    };\n    Formula.prototype.hidePopUp = function () {\n        this.autocompleteInstance.hidePopup();\n    };\n    Formula.prototype.getSuggestionKeyFromFormula = function (formula) {\n        var suggestValue = '';\n        formula = formula.substr(1); //remove = char.\n        if (formula) {\n            var bracketIndex = formula.lastIndexOf('(');\n            formula = formula.substr(bracketIndex + 1);\n            var fSplit = formula.split(this.getArgumentSeparator());\n            if (fSplit.length === 1) {\n                suggestValue = fSplit[0];\n                this.isSubFormula = bracketIndex > -1;\n            }\n            else {\n                suggestValue = fSplit[fSplit.length - 1];\n                this.isSubFormula = true;\n            }\n            var isAlphaNumeric = suggestValue.match(/\\w/);\n            if (!isAlphaNumeric || (isAlphaNumeric && isAlphaNumeric.index !== 0)) {\n                suggestValue = '';\n            }\n        }\n        return suggestValue;\n    };\n    Formula.prototype.getPopupPosition = function () {\n        var eventArgs = { position: null };\n        if (this.isFormulaBar) {\n            eventArgs.action = 'getPosition';\n            this.parent.notify(formulaBarOperation, eventArgs);\n        }\n        else {\n            eventArgs.action = 'getPosition';\n            this.parent.notify(editOperation, eventArgs);\n        }\n        return eventArgs.position;\n    };\n    Formula.prototype.getEditingValue = function () {\n        var eventArgs = { action: 'getCurrentEditValue', editedValue: '' };\n        this.parent.notify(editOperation, eventArgs);\n        return eventArgs.editedValue;\n    };\n    Formula.prototype.isNavigationKey = function (keyCode) {\n        return (keyCode === this.keyCodes.UP) || (keyCode === this.keyCodes.DOWN) || (keyCode === this.keyCodes.LEFT)\n            || (keyCode === this.keyCodes.RIGHT);\n    };\n    Formula.prototype.triggerKeyDownEvent = function (keyCode) {\n        var autoCompleteElem = this.autocompleteInstance.element;\n        autoCompleteElem.dispatchEvent(new Event('input'));\n        var eventArg = new Event('keydown');\n        // tslint:disable:no-string-literal\n        eventArg['keyCode'] = keyCode;\n        eventArg['which'] = keyCode;\n        eventArg['altKey'] = false;\n        eventArg['shiftKey'] = false;\n        eventArg['ctrlKey'] = false;\n        // tslint:enable:no-string-literal\n        autoCompleteElem.dispatchEvent(eventArg);\n    };\n    Formula.prototype.getArgumentSeparator = function () {\n        if (this.argumentSeparator) {\n            return this.argumentSeparator;\n        }\n        else {\n            var eventArgs = {\n                action: 'getArgumentSeparator', argumentSeparator: ''\n            };\n            this.parent.notify(workbookFormulaOperation, eventArgs);\n            this.argumentSeparator = eventArgs.argumentSeparator;\n            return eventArgs.argumentSeparator;\n        }\n    };\n    Formula.prototype.getNames = function (sheetName) {\n        var names = this.parent.definedNames.filter(function (name) { return name.scope === 'Workbook' || name.scope === '' || name.scope === sheetName; });\n        return names;\n    };\n    Formula.prototype.getNameFromRange = function (range) {\n        var singleRange = range.slice(0, range.indexOf(':'));\n        var sRange = range.slice(range.indexOf('!') + 1).split(':');\n        var isSingleCell = sRange.length > 1 && sRange[0] === sRange[1];\n        var name = this.parent.definedNames.filter(function (name, index) {\n            if (isSingleCell && name.refersTo === '=' + singleRange) {\n                return true;\n            }\n            return name.refersTo === '=' + range;\n        });\n        return name && name[0];\n    };\n    Formula.prototype.addDefinedName = function (definedName) {\n        var _this = this;\n        var name = definedName.name;\n        var isAdded = false;\n        if (!definedName.refersTo) {\n            var sheet = getSheet(this.parent, this.parent.activeSheetIndex);\n            var sheetName = getSheetName(this.parent);\n            sheetName = sheetName.indexOf(' ') !== -1 ? '\\'' + sheetName + '\\'' : sheetName;\n            var selectRange = sheet.selectedRange;\n            if (!isNullOrUndefined(selectRange)) {\n                var colIndex = selectRange.indexOf(':');\n                var left = selectRange.substr(0, colIndex);\n                var right = selectRange.substr(colIndex + 1, selectRange.length);\n                if (parseInt(right.replace(/\\D/g, ''), 10) === sheet.rowCount && parseInt(left.replace(/\\D/g, ''), 10) === 1) {\n                    right = right.replace(/[0-9]/g, '');\n                    left = left.replace(/[0-9]/g, '');\n                    selectRange = '$' + left + ':$' + right;\n                }\n                else if (getCellIndexes(right)[1] === sheet.colCount - 1 && getCellIndexes(left)[1] === 0) {\n                    right = right.replace(/\\D/g, '');\n                    left = left.replace(/\\D/g, '');\n                    selectRange = '$' + left + ':$' + right;\n                }\n                else {\n                    selectRange = left === right ? left : selectRange;\n                }\n            }\n            definedName.refersTo = sheetName + '!' + selectRange;\n            definedName.scope = 'Workbook';\n        }\n        if (name.length > 0 && (/^([a-zA-Z_0-9.]){0,255}$/.test(name))) {\n            var eventArgs = {\n                action: 'addDefinedName', definedName: definedName, isAdded: false\n            };\n            this.parent.notify(workbookFormulaOperation, eventArgs);\n            isAdded = eventArgs.isAdded;\n            if (!eventArgs.isAdded) {\n                this.parent.serviceLocator.getService(dialog).show({\n                    content: this.parent.serviceLocator.getService(locale).getConstant('DefineNameExists'),\n                    width: '300',\n                    beforeOpen: function (args) {\n                        var dlgArgs = {\n                            dialogName: 'DefineNameExistsDialog',\n                            element: args.element, target: args.target, cancel: args.cancel\n                        };\n                        _this.parent.trigger('dialogBeforeOpen', dlgArgs);\n                        if (dlgArgs.cancel) {\n                            args.cancel = true;\n                        }\n                    },\n                });\n            }\n        }\n        else {\n            this.parent.serviceLocator.getService(dialog).show({\n                content: this.parent.serviceLocator.getService(locale).getConstant('DefineNameInValid'),\n                width: '300',\n                beforeOpen: function (args) {\n                    var dlgArgs = {\n                        dialogName: 'DefineNameInValidDialog',\n                        element: args.element, target: args.target, cancel: args.cancel\n                    };\n                    _this.parent.trigger('dialogBeforeOpen', dlgArgs);\n                    if (dlgArgs.cancel) {\n                        args.cancel = true;\n                    }\n                },\n            });\n        }\n        return isAdded;\n    };\n    return Formula;\n}());\nexport { Formula };\n","import { Tab } from '@syncfusion/ej2-navigations';\nimport { refreshSheetTabs, locale, insertSheetTab, cMenuBeforeOpen, dialog, renameSheet, hideSheet, beginAction } from '../common/index';\nimport { sheetNameUpdate, clearUndoRedoCollection, completeAction, showAggregate } from '../common/index';\nimport { sheetTabs, renameSheetTab, removeSheetTab, activeSheetChanged, onVerticalScroll, onHorizontalScroll } from '../common/index';\nimport { protectSheet, editOperation } from '../common/index';\nimport { getSheetName, aggregateComputation } from '../../workbook/index';\nimport { isSingleCell, getRangeIndexes, getSheet, getSheetIndex } from '../../workbook/index';\nimport { DropDownButton } from '@syncfusion/ej2-splitbuttons';\nimport { isCollide, calculatePosition } from '@syncfusion/ej2-popups';\nimport { rippleEffect, closest, EventHandler, remove, isNullOrUndefined } from '@syncfusion/ej2-base';\nimport { sheetsDestroyed, activeCellChanged, workbookFormulaOperation } from '../../workbook/common/index';\nimport { insertModel, checkIsFormula } from './../../workbook/common/index';\n/**\n * Represents SheetTabs for Spreadsheet.\n */\nvar SheetTabs = /** @class */ (function () {\n    function SheetTabs(parent) {\n        this.aggregateContent = '';\n        this.isSelectCancel = false;\n        this.selaggregateCnt = 'Sum';\n        this.parent = parent;\n        this.addEventListener();\n    }\n    SheetTabs.prototype.getModuleName = function () {\n        return 'sheetTabs';\n    };\n    SheetTabs.prototype.createSheetTabs = function () {\n        var _this = this;\n        if (!this.parent.showSheetTabs && this.tabInstance) {\n            this.destroy();\n            return;\n        }\n        var l10n = this.parent.serviceLocator.getService(locale);\n        var panel = this.parent.createElement('div', {\n            className: 'e-sheet-tab-panel', id: this.parent.element.id + '_sheet_tab_panel'\n        });\n        var addBtn = this.parent.createElement('button', {\n            className: 'e-add-sheet-tab e-btn e-css e-flat e-icon-btn' + (this.parent.allowInsert ? '' : ' e-disabled'),\n            attrs: { 'title': l10n.getConstant('AddSheet') }\n        });\n        addBtn.appendChild(this.parent.createElement('span', { className: 'e-btn-icon e-icons e-add-icon' }));\n        addBtn.addEventListener('click', this.addSheetTab.bind(this));\n        addBtn.disabled = !this.parent.allowInsert;\n        panel.appendChild(addBtn);\n        if (this.parent.allowInsert) {\n            this.addBtnRipple = rippleEffect(panel, { selector: '.e-add-sheet-tab' });\n        }\n        var ddb = this.parent.createElement('button', { attrs: { 'title': l10n.getConstant('ListAllSheets') } });\n        panel.appendChild(ddb);\n        this.parent.element.appendChild(panel);\n        var items = this.getSheetTabItems();\n        this.dropDownInstance = new DropDownButton({\n            iconCss: 'e-icons',\n            items: items.ddbItems,\n            beforeItemRender: function (args) {\n                var sheet = _this.parent.sheets[_this.dropDownInstance.items.indexOf(args.item)];\n                if (sheet.state === 'Hidden') {\n                    args.element.classList.add('e-hide');\n                }\n                else if (sheet.state === 'VeryHidden') {\n                    args.element.style.display = 'none';\n                }\n            },\n            select: function (args) { return _this.updateSheetTab({ idx: _this.dropDownInstance.items.indexOf(args.item) }); },\n            beforeOpen: function (args) { return _this.beforeOpenHandler(_this.dropDownInstance, args.element); },\n            open: function (args) { return _this.openHandler(_this.dropDownInstance, args.element, 'left'); },\n            cssClass: 'e-sheets-list e-flat e-caret-hide',\n            close: function () { return _this.parent.element.focus(); }\n        });\n        this.dropDownInstance.createElement = this.parent.createElement;\n        this.dropDownInstance.appendTo(ddb);\n        var sheetTab = this.parent.createElement('div', { className: 'e-sheet-tab' });\n        this.tabInstance = new Tab({\n            selectedItem: this.parent.activeSheetIndex,\n            overflowMode: 'Scrollable',\n            items: items.tabItems,\n            scrollStep: 250,\n            selecting: function (args) {\n                var beginEventArgs = {\n                    currentSheetIndex: args.selectingIndex, previousSheetIndex: args.selectedIndex, cancel: false\n                };\n                if (!_this.isSelectCancel) {\n                    _this.parent.notify(beginAction, { eventArgs: beginEventArgs, action: 'gotoSheet' });\n                }\n                _this.isSelectCancel = beginEventArgs.cancel;\n            },\n            selected: function (args) {\n                if (args.selectedIndex === args.previousIndex) {\n                    return;\n                }\n                if (_this.parent.isEdit) {\n                    _this.parent.endEdit();\n                }\n                if (_this.isSelectCancel) {\n                    _this.tabInstance.selectedItem = args.previousIndex;\n                    _this.tabInstance.dataBind();\n                    _this.parent.element.focus();\n                }\n                else {\n                    _this.parent.activeSheetIndex = args.selectedIndex;\n                    _this.parent.dataBind();\n                    _this.updateDropDownItems(args.selectedIndex, args.previousIndex);\n                    _this.parent.element.focus();\n                    var completeEventArgs = {\n                        previousSheetIndex: args.previousIndex, currentSheetIndex: args.selectedIndex\n                    };\n                    _this.parent.notify(completeAction, { eventArgs: completeEventArgs, action: 'gotoSheet' });\n                    var eventArgs = {\n                        action: 'registerGridInCalc',\n                        sheetID: (args.selectedIndex + 1).toString()\n                    };\n                    _this.parent.notify(workbookFormulaOperation, eventArgs);\n                }\n            },\n            created: function () {\n                var tBarItems = _this.tabInstance.element.querySelector('.e-toolbar-items');\n                tBarItems.classList.add('e-sheet-tabs-items');\n                EventHandler.add(tBarItems, 'dblclick', _this.renameSheetTab, _this);\n            },\n        });\n        panel.appendChild(sheetTab);\n        this.tabInstance.createElement = this.parent.createElement;\n        this.tabInstance.appendTo(sheetTab);\n        // tslint:disable-next-line:no-any\n        EventHandler.remove(this.tabInstance.element, 'keydown', this.tabInstance.spaceKeyDown);\n        var sheetCount = items.tabItems.length;\n        for (var i = 0; i < sheetCount; i++) {\n            var sheetName = getSheetName(this.parent, i);\n            var arg = { action: 'addSheet', sheetName: 'Sheet' + (i + 1), index: i + 1, visibleName: sheetName };\n            this.parent.notify(workbookFormulaOperation, arg);\n        }\n        this.parent.notify(workbookFormulaOperation, { action: 'initiateDefinedNames' });\n        this.parent.notify(protectSheet, null);\n    };\n    SheetTabs.prototype.updateDropDownItems = function (curIdx, prevIdx) {\n        if (prevIdx > -1) {\n            this.dropDownInstance.items[prevIdx].iconCss = '';\n        }\n        this.dropDownInstance.items[curIdx].iconCss = 'e-selected-icon e-icons';\n        this.dropDownInstance.setProperties({ 'items': this.dropDownInstance.items }, true);\n    };\n    SheetTabs.prototype.beforeOpenHandler = function (instance, element) {\n        var viewportHeight = this.parent.viewport.height;\n        var actualHeight = (parseInt(getComputedStyle(element.firstElementChild).height, 10) *\n            instance.items.length) + (parseInt(getComputedStyle(element).paddingTop, 10) * 2);\n        if (actualHeight > viewportHeight) {\n            element.style.height = viewportHeight + \"px\";\n            element.style.overflowY = 'auto';\n        }\n        element.parentElement.style.visibility = 'hidden';\n    };\n    SheetTabs.prototype.openHandler = function (instance, element, positionX) {\n        var wrapper = element.parentElement;\n        var height;\n        var collide = isCollide(wrapper);\n        if (collide.indexOf('bottom') === -1) {\n            height = element.style.overflowY === 'auto' ? this.parent.viewport.height : wrapper.getBoundingClientRect().height;\n            var offset = calculatePosition(instance.element, positionX, 'top');\n            if (positionX === 'right') {\n                offset.left -= wrapper.getBoundingClientRect().width;\n            }\n            wrapper.style.left = offset.left + \"px\";\n            wrapper.style.top = offset.top - height + \"px\";\n        }\n        wrapper.style.visibility = '';\n    };\n    SheetTabs.prototype.getSheetTabItems = function () {\n        var _this = this;\n        var tabItems = [];\n        var ddbItems = [];\n        var sheetName;\n        this.parent.sheets.forEach(function (sheet, index) {\n            sheetName = getSheetName(_this.parent, index);\n            tabItems.push({ header: { 'text': sheetName }, cssClass: sheet.state === 'Visible' ? '' : 'e-hide' });\n            ddbItems.push({ text: sheetName, iconCss: index === _this.parent.activeSheetIndex ? 'e-selected-icon e-icons' : '' });\n        });\n        return { tabItems: tabItems, ddbItems: ddbItems };\n    };\n    SheetTabs.prototype.refreshSheetTab = function () {\n        var items = this.getSheetTabItems();\n        this.dropDownInstance.items = items.ddbItems;\n        this.dropDownInstance.setProperties({ 'items': this.dropDownInstance.items }, true);\n        this.tabInstance.items = items.tabItems;\n        this.tabInstance.selectedItem = this.parent.activeSheetIndex;\n        this.tabInstance.dataBind();\n    };\n    SheetTabs.prototype.addSheetTab = function () {\n        var eventArgs = { action: 'getCurrentEditValue', editedValue: '' };\n        this.parent.notify(editOperation, eventArgs);\n        var val = eventArgs.editedValue;\n        var isFormulaEdit = checkIsFormula(val) || val && val !== '' ? val.indexOf('=') === 0 : false;\n        this.parent.notify(insertModel, { model: this.parent, start: this.parent.activeSheetIndex + 1, end: this.parent.activeSheetIndex + 1, modelType: 'Sheet', isAction: true, activeSheetIndex: this.parent.activeSheetIndex + 1 });\n        this.parent.element.focus();\n    };\n    SheetTabs.prototype.insertSheetTab = function (args) {\n        if (!args.preventUpdate || args.startIdx === this.tabInstance.selectedItem) {\n            this.dropDownInstance.items[this.tabInstance.selectedItem].iconCss = '';\n        }\n        for (var i = args.startIdx; i <= args.endIdx; i++) {\n            var sheetName = this.parent.sheets[i].name;\n            this.dropDownInstance.items.splice(i, 0, { text: sheetName });\n            this.tabInstance.addTab([{ header: { text: sheetName }, content: '' }], i);\n        }\n        if (!args.preventUpdate || args.startIdx === this.tabInstance.selectedItem) {\n            this.dropDownInstance.items[args.startIdx].iconCss = 'e-selected-icon e-icons';\n        }\n        this.dropDownInstance.setProperties({ 'items': this.dropDownInstance.items }, true);\n        if (args.preventUpdate) {\n            if (args.startIdx !== this.tabInstance.selectedItem) {\n                this.refreshSheetTab();\n            }\n        }\n        else {\n            this.updateSheetTab({ idx: args.startIdx });\n        }\n    };\n    SheetTabs.prototype.updateSheetTab = function (args) {\n        if (args.name === 'activeSheetChanged') {\n            args.idx = this.parent.skipHiddenSheets(args.idx);\n        }\n        else {\n            if (this.parent.sheets[args.idx].state === 'Hidden') {\n                this.parent.setSheetPropertyOnMute(this.parent.sheets[args.idx], 'state', 'Visible');\n                this.tabInstance.items[args.idx].cssClass = '';\n                this.tabInstance.items = this.tabInstance.items;\n                this.tabInstance.dataBind();\n            }\n        }\n        this.tabInstance.selectedItem = args.idx;\n        this.tabInstance.dataBind();\n        this.parent.notify(protectSheet, null);\n    };\n    SheetTabs.prototype.switchSheetTab = function (args) {\n        var target = closest(args.event.target, '.e-toolbar-item');\n        if (!target) {\n            return;\n        }\n        var text = target.querySelector('.e-tab-text').textContent;\n        for (var i = 0, len = this.tabInstance.items.length; i < len; i++) {\n            if (this.tabInstance.items[i].header.text === text) {\n                if (this.parent.activeSheetIndex !== i) {\n                    this.updateSheetTab({ idx: i });\n                }\n                break;\n            }\n        }\n        if (args.element.classList.contains('e-contextmenu') && args.items[0] &&\n            args.items[0].id === this.parent.element.id + \"_cmenu_insert_sheet\") {\n            if (this.skipHiddenSheets() === 1) {\n                //let id: string = `${this.parent.element.id}_cmenu`;\n                //this.parent.enableFileMenuItems([`${id}_hide_sheet`, `${id}_delete_sheet`], false, true);\n                args.element.children[1].classList.add('e-disabled');\n                args.element.children[3].classList.add('e-disabled');\n            }\n            if (!this.parent.allowInsert) {\n                args.element.children[0].classList.add('e-disabled');\n            }\n            if (!this.parent.allowDelete) {\n                args.element.children[1].classList.add('e-disabled');\n            }\n        }\n    };\n    SheetTabs.prototype.skipHiddenSheets = function () {\n        var count = this.parent.sheets.length;\n        this.parent.sheets.forEach(function (sheet) {\n            if (sheet.state !== 'Visible') {\n                --count;\n            }\n        });\n        return count;\n    };\n    SheetTabs.prototype.renameSheetTab = function () {\n        var target = this.tabInstance.element.querySelector('.e-toolbar-item.e-active');\n        if (target) {\n            target = target.querySelector('.e-text-wrap');\n            var value = target.querySelector('.e-tab-text').textContent;\n            var input = this.parent.createElement('input', {\n                id: this.parent.element.id + '_rename_input',\n                className: 'e-input e-sheet-rename', styles: \"width: \" + target.getBoundingClientRect().width + \"px\", attrs: {\n                    'type': 'text', 'name': 'Rename', 'required': '', 'value': value, 'spellcheck': 'false', 'maxlength': '31'\n                }\n            });\n            target.firstElementChild.style.display = 'none';\n            target.appendChild(input);\n            EventHandler.add(document, 'mousedown touchstart', this.renameInputFocusOut, this);\n            EventHandler.add(input, 'input', this.updateWidth, this);\n            input.focus();\n            input.setSelectionRange(0, value.length);\n            EventHandler.remove(closest(target, '.e-toolbar-items'), 'dblclick', this.renameSheetTab);\n        }\n    };\n    SheetTabs.prototype.updateWidth = function (e) {\n        var target = e.target;\n        var len = target.value.length;\n        var value = target.value.split(' ');\n        if (value.length) {\n            var spaceLen = value.length - 1;\n            len -= spaceLen;\n            len += (spaceLen * 0.5);\n        }\n        target.style.width = len + \"ch\";\n    };\n    SheetTabs.prototype.renameInputFocusOut = function (e) {\n        var target = e.target;\n        if ((e.type === 'mousedown' || e.type === 'touchstart') && (target.classList.contains('e-sheet-rename') ||\n            closest(target, '.e-dlg-container'))) {\n            return;\n        }\n        target = document.getElementById(this.parent.element.id + '_rename_input');\n        if (e.type === 'keydown' && e.keyCode === 27) {\n            this.removeRenameInput(target);\n            this.parent.element.focus();\n            return;\n        }\n        var value = target.value;\n        var l10n = this.parent.serviceLocator.getService(locale);\n        if (value) {\n            var idx = this.tabInstance.selectedItem;\n            if (!value.match(new RegExp('.*[\\\\[\\\\]\\\\*\\\\\\\\\\/\\\\?].*'))) {\n                if (this.tabInstance.items[idx].header.text !== value) {\n                    for (var i = 0, len = this.parent.sheets.length; i < len; i++) {\n                        if (i !== this.parent.activeSheetIndex && this.parent.sheets[i].name.toLowerCase() === value.toLowerCase()) {\n                            this.showRenameDialog(target, l10n.getConstant('SheetRenameAlreadyExistsAlert'));\n                            return;\n                        }\n                    }\n                }\n                var items = this.removeRenameInput(target);\n                if (this.tabInstance.items[idx].header.text !== value) {\n                    this.parent.setSheetPropertyOnMute(this.parent.sheets[idx], 'name', value);\n                    this.updateSheetName({ value: value, idx: idx, items: items });\n                }\n                if (e.type === 'keydown' || (closest(e.target, '.e-spreadsheet'))) {\n                    this.parent.element.focus();\n                }\n            }\n            else {\n                this.showRenameDialog(target, l10n.getConstant('SheetRenameInvalidAlert'));\n            }\n        }\n        else {\n            this.showRenameDialog(target, l10n.getConstant('SheetRenameEmptyAlert'));\n        }\n        var sheetIndex = this.parent.getActiveSheet().id;\n        var args = { action: 'renameUpdation', value: value, sheetId: sheetIndex };\n        this.parent.notify(workbookFormulaOperation, args);\n        var eventArgs = {\n            index: sheetIndex,\n            value: value\n        };\n        this.parent.notify(completeAction, { eventArgs: eventArgs, action: 'renameSheet' });\n    };\n    SheetTabs.prototype.updateSheetName = function (args) {\n        this.tabInstance.items[args.idx].header.text = args.value;\n        this.dropDownInstance.items[args.idx].text = args.value;\n        this.dropDownInstance.setProperties({ 'items': this.dropDownInstance.items }, true);\n        if (args.value.indexOf('  ') > -1) {\n            this.tabInstance.setProperties({ 'items': this.tabInstance.items }, true);\n            args.items.querySelector('.e-toolbar-item.e-active .e-tab-text').textContent = args.value;\n        }\n        else {\n            this.tabInstance.items = this.tabInstance.items;\n            this.tabInstance.dataBind();\n        }\n    };\n    SheetTabs.prototype.hideSheet = function () {\n        this.parent.setSheetPropertyOnMute(this.parent.getActiveSheet(), 'state', 'Hidden');\n        this.tabInstance.items[this.parent.activeSheetIndex].cssClass = 'e-hide';\n        this.tabInstance.items = this.tabInstance.items;\n        this.tabInstance.dataBind();\n        this.tabInstance.selectedItem = this.parent.skipHiddenSheets(this.parent.activeSheetIndex === this.parent.sheets.length - 1 ? this.parent.activeSheetIndex - 1 :\n            this.parent.activeSheetIndex + 1);\n        this.tabInstance.dataBind();\n    };\n    SheetTabs.prototype.removeRenameInput = function (target) {\n        var textEle = target.parentElement.querySelector('.e-tab-text');\n        var sheetItems = closest(target, '.e-toolbar-items');\n        EventHandler.add(sheetItems, 'dblclick', this.renameSheetTab, this);\n        EventHandler.remove(document, 'mousedown touchstart', this.renameInputFocusOut);\n        EventHandler.remove(target, 'input', this.updateWidth);\n        remove(target);\n        textEle.style.display = '';\n        return sheetItems;\n    };\n    SheetTabs.prototype.showRenameDialog = function (target, content) {\n        var _this = this;\n        var dialogInst = this.parent.serviceLocator.getService(dialog);\n        dialogInst.show({\n            target: document.getElementById(this.parent.element.id + '_sheet_panel'),\n            height: 180, width: 400, isModal: true, showCloseIcon: true,\n            content: content,\n            beforeOpen: function (args) {\n                var dlgArgs = {\n                    dialogName: 'SheetRenameDialog',\n                    element: args.element, target: args.target, cancel: args.cancel\n                };\n                _this.parent.trigger('dialogBeforeOpen', dlgArgs);\n                if (dlgArgs.cancel) {\n                    args.cancel = true;\n                }\n                target.focus();\n            },\n            close: function () { return target.setSelectionRange(0, target.value.length); }\n        });\n    };\n    SheetTabs.prototype.focusRenameInput = function () {\n        var input = document.getElementById(this.parent.element.id + '_rename_input');\n        if (input) {\n            input.focus();\n        }\n    };\n    SheetTabs.prototype.removeSheetTab = function (args) {\n        var _this = this;\n        if (args.count && (args.count === this.parent.sheets.length)) {\n            return;\n        }\n        var l10n = this.parent.serviceLocator.getService(locale);\n        if (this.skipHiddenSheets() > 1) {\n            var sheet = args.sheetName ? getSheet(this.parent, getSheetIndex(this.parent, args.sheetName)) :\n                this.parent.getActiveSheet();\n            var sheetIndex_1 = args.index || getSheetIndex(this.parent, sheet.name);\n            var eventArgs_1 = {\n                index: sheetIndex_1,\n                sheetCount: this.parent.sheets.length,\n                sheetName: sheet.name\n            };\n            var isDataAvail = sheet.rows && sheet.rows.length ?\n                (sheet.rows.length === 1 ? (sheet.rows[0].cells && sheet.rows[0].cells.length ? true : false) : true) : false;\n            if (isDataAvail) {\n                var dialogInst_1 = this.parent.serviceLocator.getService(dialog);\n                if (args.clicked) {\n                    this.forceDelete(sheetIndex_1);\n                }\n                else {\n                    dialogInst_1.show({\n                        height: 200, width: 400, isModal: true, showCloseIcon: true,\n                        content: l10n.getConstant('DeleteSheetAlert'),\n                        beforeOpen: function (args) {\n                            var dlgArgs = {\n                                dialogName: 'DeleteSheetDialog',\n                                element: args.element, target: args.target, cancel: args.cancel\n                            };\n                            _this.parent.trigger('dialogBeforeOpen', dlgArgs);\n                            if (dlgArgs.cancel) {\n                                args.cancel = true;\n                            }\n                            _this.parent.element.focus();\n                        },\n                        buttons: [{\n                                buttonModel: {\n                                    content: l10n.getConstant('Ok'), isPrimary: true\n                                },\n                                click: function () {\n                                    dialogInst_1.hide();\n                                    _this.forceDelete(sheetIndex_1);\n                                    _this.parent.notify(clearUndoRedoCollection, null);\n                                    if (args && !args.isAction) {\n                                        eventArgs_1.sheetCount = _this.parent.sheets.length;\n                                        _this.parent.notify(completeAction, { eventArgs: eventArgs_1, action: 'removeSheet' });\n                                    }\n                                }\n                            }]\n                    });\n                }\n            }\n            else {\n                var sheetArgs = {\n                    action: 'deleteSheetTab', sheetName: '', index: sheetIndex_1 + 1\n                };\n                this.parent.notify(workbookFormulaOperation, sheetArgs);\n                this.destroySheet(sheetIndex_1);\n                this.parent.notify(clearUndoRedoCollection, null);\n                if (args && !args.isAction) {\n                    eventArgs_1.sheetCount = this.parent.sheets.length;\n                    this.parent.notify(completeAction, { eventArgs: eventArgs_1, action: 'removeSheet' });\n                }\n            }\n        }\n        else {\n            this.parent.serviceLocator.getService(dialog).show({\n                target: document.getElementById(this.parent.element.id + '_sheet_panel'),\n                height: 180, width: 400, isModal: true, showCloseIcon: true,\n                content: l10n.getConstant('DeleteSingleLastSheetAlert'),\n                beforeOpen: function (args) {\n                    var dlgArgs = {\n                        dialogName: 'DeleteSingleSheetDialog',\n                        element: args.element, target: args.target, cancel: args.cancel\n                    };\n                    _this.parent.trigger('dialogBeforeOpen', dlgArgs);\n                    if (dlgArgs.cancel) {\n                        args.cancel = true;\n                    }\n                    _this.parent.element.focus();\n                },\n            });\n        }\n    };\n    SheetTabs.prototype.forceDelete = function (sheetIndex) {\n        var sheetArgs = {\n            action: 'deleteSheetTab', sheetName: '', index: sheetIndex + 1\n        };\n        this.parent.notify(workbookFormulaOperation, sheetArgs);\n        this.destroySheet(sheetIndex);\n    };\n    SheetTabs.prototype.destroySheet = function (sheetIndex) {\n        var activeSheetIdx = sheetIndex || this.parent.activeSheetIndex;\n        this.parent.removeSheet(activeSheetIdx);\n        this.parent.notify(sheetsDestroyed, { sheetIndex: activeSheetIdx });\n        this.dropDownInstance.items.splice(activeSheetIdx, 1);\n        this.dropDownInstance.setProperties({ 'items': this.dropDownInstance.items }, true);\n        this.tabInstance.removeTab(activeSheetIdx);\n        var activeIndex = this.parent.skipHiddenSheets(this.tabInstance.selectedItem);\n        this.parent.activeSheetIndex = activeIndex;\n        this.parent.setProperties({ activeSheetIndex: activeIndex }, true);\n        this.parent.renderModule.refreshSheet();\n        this.tabInstance.selectedItem = activeIndex;\n        this.tabInstance.dataBind();\n        this.updateDropDownItems(activeIndex);\n        this.parent.notify(protectSheet, null);\n        this.parent.element.focus();\n    };\n    SheetTabs.prototype.showAggregate = function () {\n        var _this = this;\n        if (isSingleCell(getRangeIndexes(this.parent.getActiveSheet().selectedRange))) {\n            return;\n        }\n        var eventArgs = { Count: 0, Sum: '0', Avg: '0', Min: '0', Max: '0', countOnly: true };\n        this.parent.notify(aggregateComputation, eventArgs);\n        if (eventArgs.Count > 1) {\n            this.aggregateContent = eventArgs.countOnly ? 'Count' : this.selaggregateCnt;\n            if (eventArgs.countOnly) {\n                this.aggregateContent = 'Count';\n                delete eventArgs.Sum;\n                delete eventArgs.Avg;\n                delete eventArgs.Min;\n                delete eventArgs.Max;\n            }\n            var btnClass = eventArgs.countOnly ? 'e-aggregate-list e-flat e-aggregate-list-countonly e-caret-hide'\n                : 'e-aggregate-list e-flat';\n            delete eventArgs.countOnly;\n            var key = this.aggregateContent;\n            var content = key + \": \" + eventArgs[key];\n            if (!this.aggregateDropDown) {\n                var aggregateEle = this.parent.createElement('button');\n                document.getElementById(this.parent.element.id + \"_sheet_tab_panel\").appendChild(aggregateEle);\n                this.aggregateDropDown = new DropDownButton({\n                    content: content,\n                    items: this.getAggregateItems(eventArgs),\n                    select: function (args) { return _this.updateAggregateContent(args.item.text, eventArgs, true); },\n                    beforeOpen: function (args) {\n                        return _this.beforeOpenHandler(_this.aggregateDropDown, args.element);\n                    },\n                    open: function (args) { return _this.openHandler(_this.aggregateDropDown, args.element, 'right'); },\n                    close: function () { return _this.parent.element.focus(); },\n                    cssClass: btnClass\n                });\n                this.aggregateDropDown.createElement = this.parent.createElement;\n                this.aggregateDropDown.appendTo(aggregateEle);\n            }\n            else {\n                this.updateAggregateContent(content, eventArgs);\n            }\n        }\n        else {\n            this.removeAggregate();\n        }\n    };\n    SheetTabs.prototype.getAggregateItems = function (args) {\n        var _this = this;\n        var items = [];\n        var text;\n        var iconCss;\n        Object.keys(args).forEach(function (key) {\n            if (args[key] !== aggregateComputation) {\n                text = key + \": \" + args[key];\n                iconCss = key === _this.aggregateContent ? 'e-selected-icon e-icons' : '';\n                items.push({ text: text, iconCss: iconCss });\n            }\n        });\n        return items;\n    };\n    SheetTabs.prototype.updateAggregateContent = function (text, eventArgs, isSelect) {\n        this.aggregateContent = text.split(': ')[0];\n        if (isSelect) {\n            this.selaggregateCnt = text.split(': ')[0];\n        }\n        this.aggregateDropDown.content = text;\n        this.aggregateDropDown.dataBind();\n        this.aggregateDropDown.setProperties({ 'items': this.getAggregateItems(eventArgs) }, true);\n    };\n    SheetTabs.prototype.removeAggregate = function () {\n        if (!isNullOrUndefined(this.aggregateDropDown)) {\n            this.aggregateDropDown.destroy();\n            remove(this.aggregateDropDown.element);\n            this.aggregateDropDown = null;\n        }\n    };\n    SheetTabs.prototype.addEventListener = function () {\n        this.parent.on(sheetTabs, this.createSheetTabs, this);\n        this.parent.on(refreshSheetTabs, this.refreshSheetTab, this);\n        this.parent.on(insertSheetTab, this.insertSheetTab, this);\n        this.parent.on(removeSheetTab, this.removeSheetTab, this);\n        this.parent.on(renameSheetTab, this.renameSheetTab, this);\n        this.parent.on(cMenuBeforeOpen, this.switchSheetTab, this);\n        this.parent.on(activeSheetChanged, this.updateSheetTab, this);\n        this.parent.on(renameSheet, this.renameInputFocusOut, this);\n        this.parent.on(activeCellChanged, this.removeAggregate, this);\n        this.parent.on(onVerticalScroll, this.focusRenameInput, this);\n        this.parent.on(onHorizontalScroll, this.focusRenameInput, this);\n        this.parent.on(sheetNameUpdate, this.updateSheetName, this);\n        this.parent.on(hideSheet, this.hideSheet, this);\n        this.parent.on(showAggregate, this.showAggregate, this);\n    };\n    SheetTabs.prototype.destroy = function () {\n        this.removeEventListener();\n        this.dropDownInstance.destroy();\n        this.dropDownInstance = null;\n        this.tabInstance.destroy();\n        this.tabInstance = null;\n        this.aggregateDropDown = null;\n        this.aggregateContent = null;\n        this.addBtnRipple();\n        this.addBtnRipple = null;\n        EventHandler.remove(document, 'mousedown touchstart', this.renameInputFocusOut);\n        var ele = document.getElementById(this.parent.element.id + '_sheet_tab_panel');\n        if (ele) {\n            remove(ele);\n        }\n        this.parent = null;\n    };\n    SheetTabs.prototype.removeEventListener = function () {\n        if (!this.parent.isDestroyed) {\n            this.parent.off(sheetTabs, this.createSheetTabs);\n            this.parent.off(refreshSheetTabs, this.refreshSheetTab);\n            this.parent.off(insertSheetTab, this.insertSheetTab);\n            this.parent.off(removeSheetTab, this.removeSheetTab);\n            this.parent.off(renameSheetTab, this.renameSheetTab);\n            this.parent.off(cMenuBeforeOpen, this.switchSheetTab);\n            this.parent.off(activeSheetChanged, this.updateSheetTab);\n            this.parent.off(renameSheet, this.renameInputFocusOut);\n            this.parent.off(activeCellChanged, this.removeAggregate);\n            this.parent.off(onVerticalScroll, this.focusRenameInput);\n            this.parent.off(onHorizontalScroll, this.focusRenameInput);\n            this.parent.off(sheetNameUpdate, this.updateSheetName);\n            this.parent.off(hideSheet, this.hideSheet);\n            this.parent.off(showAggregate, this.showAggregate);\n        }\n    };\n    return SheetTabs;\n}());\nexport { SheetTabs };\n","import { refreshSheetTabs, completeAction } from '../common/event';\nimport { dialog } from '../common/index';\nimport { openSuccess, openFailure } from '../../workbook/index';\nvar Open = /** @class */ (function () {\n    function Open(parent) {\n        this.parent = parent;\n        this.addEventListener();\n        this.renderFileUpload();\n        //Spreadsheet.Inject(WorkbookOpen);\n    }\n    /**\n     * Adding event listener for success and failure\n     */\n    Open.prototype.addEventListener = function () {\n        this.parent.on(openSuccess, this.openSuccess, this);\n        this.parent.on(openFailure, this.openFailed, this);\n    };\n    /**\n     * Removing event listener for success and failure\n     */\n    Open.prototype.removeEventListener = function () {\n        if (!this.parent.isDestroyed) {\n            this.parent.off(openSuccess, this.openSuccess);\n            this.parent.off(openFailure, this.openFailed);\n        }\n    };\n    /**\n     * Rendering upload component for importing files.\n     */\n    Open.prototype.renderFileUpload = function () {\n        var uploadID = this.parent.element.id + '_fileUpload';\n        this.parent.element.appendChild(this.parent.createElement('input', {\n            id: uploadID,\n            attrs: { type: 'file', accept: '.xls, .xlsx, .csv, .xlsm', name: 'fileUpload' }\n        }));\n        var uploadBox = document.getElementById(uploadID);\n        uploadBox.onchange = this.fileSelect.bind(this);\n        uploadBox.onerror = this.openFailed.bind(this);\n        uploadBox.style.display = 'none';\n    };\n    /**\n     * Process after select the excel and image file.\n     * @param {Event} args - File select native event.\n     */\n    Open.prototype.fileSelect = function (args) {\n        /* tslint:disable-next-line:no-any */\n        var filesData = args.target.files[0];\n        if (filesData && filesData.length < 1) {\n            return;\n        }\n        var impArgs = {\n            file: filesData\n        };\n        this.parent.open(impArgs);\n        document.getElementById(this.parent.element.id + '_fileUpload').value = '';\n    };\n    /**\n     * File open success event declaration.\n     * @param {string} response - File open success response text.\n     */\n    Open.prototype.openSuccess = function (response) {\n        var _this = this;\n        var openError = ['UnsupportedFile', 'InvalidUrl'];\n        if (openError.indexOf(response.data) > -1) {\n            this.parent.serviceLocator.getService(dialog).show({\n                content: this.parent.serviceLocator.getService('spreadsheetLocale')\n                    .getConstant(response.data),\n                width: '300',\n                beforeOpen: function (args) {\n                    var dlgArgs = {\n                        dialogName: 'OpenDialog',\n                        element: args.element, target: args.target, cancel: args.cancel\n                    };\n                    _this.parent.trigger('dialogBeforeOpen', dlgArgs);\n                    if (dlgArgs.cancel) {\n                        args.cancel = true;\n                    }\n                },\n            });\n            this.parent.hideSpinner();\n            return;\n        }\n        if (!this.parent.element) {\n            return;\n        }\n        this.parent.trigger('openComplete', { response: response });\n        this.parent.notify(completeAction, { response: response, action: 'import' });\n        this.parent.renderModule.refreshSheet();\n        this.parent.notify(refreshSheetTabs, this);\n        this.parent.hideSpinner();\n    };\n    /**\n     * File open failure event declaration.\n     * @param {object} args - Open failure arguments.\n     */\n    Open.prototype.openFailed = function (args) {\n        this.parent.trigger('openFailure', args);\n        this.parent.hideSpinner();\n        /* Need to Implement */\n    };\n    /**\n     * To Remove the event listeners.\n     */\n    Open.prototype.destroy = function () {\n        this.removeEventListener();\n        this.parent = null;\n    };\n    /**\n     * Get the sheet open module name.\n     */\n    Open.prototype.getModuleName = function () {\n        return 'open';\n    };\n    return Open;\n}());\nexport { Open };\n","import { dialog } from '../index';\nimport { beginSave, saveCompleted, saveError } from '../../workbook/common/event';\n/**\n * `Save` module is used to handle the save action in Spreadsheet.\n */\nvar Save = /** @class */ (function () {\n    /**\n     * Constructor for Save module in Spreadsheet.\n     * @private\n     */\n    function Save(parent) {\n        this.parent = parent;\n        this.addEventListener();\n        //Spreadsheet.Inject(WorkbookSave);\n    }\n    /**\n     * To destroy the Save module.\n     * @return {void}\n     * @hidden\n     */\n    Save.prototype.destroy = function () {\n        this.removeEventListener();\n        this.parent = null;\n    };\n    Save.prototype.addEventListener = function () {\n        this.parent.on(beginSave, this.initiateSave, this);\n        this.parent.on(saveCompleted, this.saveCompleted, this);\n        this.parent.on(saveError, this.showErrorDialog, this);\n    };\n    Save.prototype.removeEventListener = function () {\n        if (!this.parent.isDestroyed) {\n            this.parent.off(beginSave, this.initiateSave);\n            this.parent.off(saveCompleted, this.saveCompleted);\n            this.parent.off(saveError, this.showErrorDialog);\n        }\n    };\n    /**\n     * Get the module name.\n     * @returns string\n     * @private\n     */\n    Save.prototype.getModuleName = function () {\n        return 'save';\n    };\n    /**\n     * Initiate save process.\n     * @hidden\n     */\n    Save.prototype.initiateSave = function (args) {\n        this.parent.showSpinner();\n    };\n    /**\n     * Save action completed.\n     * @hidden\n     */\n    Save.prototype.saveCompleted = function (args) {\n        this.parent.hideSpinner();\n    };\n    Save.prototype.showErrorDialog = function (args) {\n        var _this = this;\n        var dialogInst = this.parent.serviceLocator.getService(dialog);\n        dialogInst.show({\n            target: this.parent.element, isModal: true, showCloseIcon: true, height: 180, width: 400, content: args.content,\n            beforeOpen: function () { return _this.parent.element.focus(); }\n        });\n    };\n    return Save;\n}());\nexport { Save };\n","import { ContextMenu as ContextMenuComponent } from '@syncfusion/ej2-navigations';\nimport { closest, extend, detach } from '@syncfusion/ej2-base';\nimport { removeSheetTab, cMenuBeforeOpen, renameSheetTab, cut, copy, paste } from '../common/index';\nimport { addContextMenuItems, removeContextMenuItems, enableContextMenuItems, initiateCustomSort, hideSheet } from '../common/index';\nimport { openHyperlink, initiateHyperlink, editHyperlink, hideShow, applyProtect } from '../common/index';\nimport { filterByCellValue, reapplyFilter, clearFilter, getFilteredColumn, applySort, locale } from '../common/index';\nimport { getRangeIndexes, getColumnHeaderText, getCellIndexes, insertModel } from '../../workbook/common/index';\nimport { getSwapRange } from '../../workbook/index';\n/**\n * Represents context menu for Spreadsheet.\n */\nvar ContextMenu = /** @class */ (function () {\n    /**\n     * Constructor for ContextMenu module.\n     */\n    function ContextMenu(parent) {\n        this.parent = parent;\n        this.init();\n    }\n    ContextMenu.prototype.init = function () {\n        this.initContextMenu();\n        this.addEventListener();\n    };\n    ContextMenu.prototype.initContextMenu = function () {\n        var ul = document.createElement('ul');\n        ul.id = this.parent.element.id + '_contextmenu';\n        this.parent.element.appendChild(ul);\n        this.contextMenuInstance = new ContextMenuComponent({\n            cssClass: 'e-spreadsheet-contextmenu',\n            target: '#' + this.parent.element.id,\n            filter: 'e-numericcontainer e-active-cell e-selection e-row e-header-row e-select-all-cell e-sheet-tabs-items',\n            select: this.selectHandler.bind(this),\n            beforeOpen: this.beforeOpenHandler.bind(this),\n            beforeClose: this.beforeCloseHandler.bind(this)\n        }, ul);\n    };\n    /**\n     * Before close event handler.\n     */\n    ContextMenu.prototype.beforeCloseHandler = function (args) {\n        this.parent.trigger('contextMenuBeforeClose', args);\n    };\n    /**\n     * Select event handler.\n     */\n    // tslint:disable-next-line\n    ContextMenu.prototype.selectHandler = function (args) {\n        var selectArgs = extend({ cancel: false }, args);\n        this.parent.trigger('contextMenuItemSelect', selectArgs);\n        var id = this.parent.element.id + '_cmenu';\n        if (!selectArgs.cancel) {\n            var l10n = this.parent.serviceLocator.getService(locale);\n            var indexes = void 0;\n            switch (args.item.id) {\n                case id + '_cut':\n                    this.parent.notify(cut, { isAction: true, promise: Promise });\n                    break;\n                case id + '_copy':\n                    this.parent.notify(copy, { isAction: true, promise: Promise });\n                    break;\n                case id + '_paste':\n                    this.parent.notify(paste, { isAction: true, isInternal: true });\n                    break;\n                case id + '_pastevalues':\n                    this.parent.notify(paste, { type: 'Values', isAction: true, isInternal: true });\n                    break;\n                case id + '_pasteformats':\n                    this.parent.notify(paste, { type: 'Formats', isAction: true, isInternal: true });\n                    break;\n                case id + '_rename':\n                    this.parent.notify(renameSheetTab, {});\n                    break;\n                case id + '_delete_sheet':\n                    this.parent.notify(removeSheetTab, {});\n                    break;\n                case id + '_insert_sheet':\n                    this.parent.notify(insertModel, { model: this.parent, start: this.parent.activeSheetIndex,\n                        end: this.parent.activeSheetIndex, modelType: 'Sheet', isAction: true });\n                    break;\n                case id + '_hide_sheet':\n                    this.parent.notify(hideSheet, null);\n                    break;\n                case id + '_ascending':\n                    this.parent.notify(applySort, null);\n                    break;\n                case id + '_descending':\n                    this.parent.notify(applySort, { sortOptions: { sortDescriptors: { order: 'Descending' } } });\n                    break;\n                case id + '_customsort':\n                    this.parent.notify(initiateCustomSort, null);\n                    break;\n                case id + '_filtercellvalue':\n                    this.parent.notify(filterByCellValue, null);\n                    break;\n                case id + '_clearfilter':\n                    var field = getColumnHeaderText(getCellIndexes(this.parent.getActiveSheet().activeCell)[1] + 1);\n                    this.parent.notify(clearFilter, { field: field });\n                    break;\n                case id + '_reapplyfilter':\n                    this.parent.notify(reapplyFilter, null);\n                    break;\n                case id + '_hide_row':\n                    indexes = getRangeIndexes(this.parent.getActiveSheet().selectedRange);\n                    this.parent.notify(hideShow, {\n                        startIndex: indexes[0], endIndex: indexes[2], hide: true, isCol: false, actionUpdate: true\n                    });\n                    this.parent.element.focus();\n                    break;\n                case id + '_unhide_row':\n                    indexes = getRangeIndexes(this.parent.getActiveSheet().selectedRange);\n                    this.parent.notify(hideShow, {\n                        startIndex: indexes[0], endIndex: indexes[2], hide: false, isCol: false, actionUpdate: true\n                    });\n                    this.parent.element.focus();\n                    break;\n                case id + '_hide_column':\n                    indexes = getRangeIndexes(this.parent.getActiveSheet().selectedRange);\n                    this.parent.notify(hideShow, {\n                        startIndex: indexes[1], endIndex: indexes[3], hide: true, isCol: true, actionUpdate: true\n                    });\n                    this.parent.element.focus();\n                    break;\n                case id + '_unhide_column':\n                    indexes = getRangeIndexes(this.parent.getActiveSheet().selectedRange);\n                    this.parent.notify(hideShow, {\n                        startIndex: indexes[1], endIndex: indexes[3], hide: false, isCol: true, actionUpdate: true\n                    });\n                    this.parent.element.focus();\n                    break;\n                case id + '_insert_row_above':\n                case id + '_delete_row':\n                    indexes = getRangeIndexes(this.parent.getActiveSheet().selectedRange);\n                    this.parent.notify(args.item.id.substr(id.length + 1, 6) + \"Model\", { model: this.parent.getActiveSheet(), start: indexes[0], end: indexes[2], modelType: 'Row', isAction: true,\n                        insertType: 'above' });\n                    this.parent.element.focus();\n                    break;\n                case id + '_insert_row_below':\n                    indexes = getSwapRange(getRangeIndexes(this.parent.getActiveSheet().selectedRange));\n                    this.parent.notify(insertModel, { model: this.parent.getActiveSheet(), start: indexes[2] + 1, end: indexes[2] + 1 + (indexes[2] - indexes[0]), modelType: 'Row', isAction: true,\n                        insertType: 'below' });\n                    this.parent.element.focus();\n                    break;\n                case id + '_insert_column_before':\n                case id + '_delete_column':\n                    indexes = getRangeIndexes(this.parent.getActiveSheet().selectedRange);\n                    this.parent.notify(args.item.id.substr(id.length + 1, 6) + \"Model\", { model: this.parent.getActiveSheet(), start: indexes[1], end: indexes[3], modelType: 'Column', isAction: true });\n                    this.parent.element.focus();\n                    break;\n                case id + '_insert_column_after':\n                    indexes = getSwapRange(getRangeIndexes(this.parent.getActiveSheet().selectedRange));\n                    this.parent.notify(insertModel, { model: this.parent.getActiveSheet(), start: indexes[3] + 1, end: indexes[3] + 1 + (indexes[3] - indexes[1]), modelType: 'Column', isAction: true });\n                    this.parent.element.focus();\n                    break;\n                case id + '_hyperlink':\n                    this.parent.notify(initiateHyperlink, null);\n                    break;\n                case id + '_editHyperlink':\n                    this.parent.notify(editHyperlink, null);\n                    break;\n                case id + '_openHyperlink':\n                    this.parent.notify(openHyperlink, null);\n                    break;\n                case id + '_removeHyperlink':\n                    this.parent.removeHyperlink(this.parent.getActiveSheet().selectedRange);\n                    break;\n                case id + '_protect':\n                    var sheet = this.parent.getActiveSheet();\n                    this.parent.setSheetPropertyOnMute(sheet, 'isProtected', !sheet.isProtected);\n                    var isActive = void 0;\n                    sheet.isProtected ? isActive = false : isActive = true;\n                    this.parent.notify(applyProtect, { isActive: isActive });\n                    break;\n            }\n        }\n    };\n    ContextMenu.prototype.getInsertModel = function (startIndex, endIndex) {\n        var model = [];\n        for (var i = startIndex; i <= endIndex; i++) {\n            if (i === startIndex) {\n                model.push({ index: i });\n            }\n            else {\n                model.push({});\n            }\n        }\n        return model;\n    };\n    /**\n     * Before open event handler.\n     */\n    ContextMenu.prototype.beforeOpenHandler = function (args) {\n        var target = this.getTarget(args.event.target);\n        var items;\n        if (args.element.classList.contains('e-contextmenu')) {\n            items = this.getDataSource(target);\n            this.contextMenuInstance.items = items;\n            this.contextMenuInstance.dataBind();\n        }\n        else {\n            items = args.items;\n        }\n        if (target === 'ColumnHeader' || target === 'RowHeader') {\n            if (args.element && args.element.childElementCount > 0) {\n                var insertEle = target === 'ColumnHeader' ? args.element.querySelector('#' + this.parent.element.id + '_cmenu_insert_column') :\n                    args.element.querySelector('#' + this.parent.element.id + '_cmenu_insert_row');\n                var deleteEle = target ===\n                    'ColumnHeader' ? args.element.querySelector('#' + this.parent.element.id + '_cmenu_delete_column') :\n                    args.element.querySelector('#' + this.parent.element.id + '_cmenu_delete_row');\n                if (this.parent.allowInsert && insertEle.classList.contains('e-disabled')) {\n                    insertEle.classList.remove('e-disabled');\n                }\n                else if (!this.parent.allowInsert && !insertEle.classList.contains('e-disabled')) {\n                    insertEle.classList.add('e-disabled');\n                }\n                if (this.parent.allowDelete && deleteEle.classList.contains('e-disabled')) {\n                    deleteEle.classList.remove('e-disabled');\n                }\n                else if (!this.parent.allowDelete && !deleteEle.classList.contains('e-disabled')) {\n                    deleteEle.classList.add('e-disabled');\n                }\n            }\n        }\n        this.parent.trigger('contextMenuBeforeOpen', args);\n        this.parent.notify(cMenuBeforeOpen, extend(args, { target: target, items: items }));\n    };\n    /**\n     * To get target area based on right click.\n     */\n    ContextMenu.prototype.getTarget = function (target) {\n        if (closest(target, '.e-sheet-content')) {\n            return 'Content';\n        }\n        else if (closest(target, '.e-column-header')) {\n            return 'ColumnHeader';\n        }\n        else if (closest(target, '.e-row-header')) {\n            return 'RowHeader';\n        }\n        else if (closest(target, '.e-sheet-tabs-items')) {\n            return 'Footer';\n        }\n        else if (closest(target, '.e-selectall-container')) {\n            return 'SelectAll';\n        }\n        else {\n            return '';\n        }\n    };\n    /**\n     * To populate context menu items based on target area.\n     */\n    ContextMenu.prototype.getDataSource = function (target) {\n        var l10n = this.parent.serviceLocator.getService(locale);\n        var items = [];\n        var id = this.parent.element.id + '_cmenu';\n        if (target === 'Content') {\n            this.setClipboardData(items, l10n, id);\n            items.push({ separator: true });\n            //push filter and sort items here\n            this.setFilterItems(items, id);\n            this.setSortItems(items, id);\n            items.push({ separator: true });\n            this.setHyperLink(items, id);\n        }\n        else if (target === 'RowHeader') {\n            this.setClipboardData(items, l10n, id);\n            var indexes = getRangeIndexes(this.parent.getActiveSheet().selectedRange);\n            this.setInsertDeleteItems(items, l10n, 'Row', id, [indexes[0], indexes[2]], ['Above', 'Below']);\n            this.setHideShowItems(items, l10n, 'Row', id, [indexes[0], indexes[2]]);\n        }\n        else if (target === 'ColumnHeader') {\n            this.setClipboardData(items, l10n, id);\n            var indexes = getRangeIndexes(this.parent.getActiveSheet().selectedRange);\n            this.setInsertDeleteItems(items, l10n, 'Column', id, [indexes[1], indexes[3]], ['Before', 'After']);\n            this.setHideShowItems(items, l10n, 'Column', id, [indexes[1], indexes[3]]);\n        }\n        else if (target === 'SelectAll') {\n            this.setClipboardData(items, l10n, id);\n            this.setFilterItems(items, id);\n            this.setSortItems(items, id);\n        }\n        else if (target === 'Footer') {\n            items.push({\n                text: l10n.getConstant('Insert'), id: id + '_insert_sheet'\n            });\n            items.push({\n                text: l10n.getConstant('Delete'), iconCss: 'e-icons e-delete', id: id + '_delete_sheet'\n            });\n            items.push({\n                text: l10n.getConstant('Rename'), id: id + '_rename'\n            });\n            items.push({\n                text: l10n.getConstant('Hide'), id: id + '_hide_sheet'\n            });\n            this.setProtectSheetItems(items, id);\n        }\n        return items;\n    };\n    ContextMenu.prototype.setProtectSheetItems = function (items, id) {\n        var l10n = this.parent.serviceLocator.getService(locale);\n        if (this.parent.getActiveSheet().isProtected) {\n            items.push({\n                text: l10n.getConstant('UnprotectSheet'), id: id + '_protect', iconCss: 'e-icons e-protect-icon',\n            });\n        }\n        else {\n            items.push({\n                text: l10n.getConstant('ProtectSheet'), id: id + '_protect', iconCss: 'e-icons e-protect-icon',\n            });\n        }\n    };\n    /**\n     * Sets sorting related items to the context menu.\n     */\n    ContextMenu.prototype.setFilterItems = function (items, id) {\n        if (this.parent.allowFiltering) {\n            var l10n = this.parent.serviceLocator.getService(locale);\n            var args = { clearFilterText: null, isFiltered: false };\n            this.parent.notify(getFilteredColumn, args);\n            items.push({\n                text: l10n.getConstant('Filter'), id: id + '_filter',\n                iconCss: '',\n                items: [\n                    { text: args.clearFilterText, iconCss: 'e-icons e-filter-clear', id: id + '_clearfilter' },\n                    { text: l10n.getConstant('ReapplyFilter'), iconCss: 'e-icons e-filter-reapply', id: id + '_reapplyfilter' },\n                    { separator: true },\n                    { text: l10n.getConstant('FilterCellValue'), iconCss: '', id: id + '_filtercellvalue' }\n                ]\n            });\n        }\n    };\n    /**\n     * Sets sorting related items to the context menu.\n     */\n    ContextMenu.prototype.setSortItems = function (items, id) {\n        var l10n = this.parent.serviceLocator.getService(locale);\n        if (this.parent.allowSorting) {\n            items.push({\n                text: l10n.getConstant('Sort'), id: id + '_sort',\n                iconCss: 'e-icons e-sort-icon',\n                items: [\n                    { text: l10n.getConstant('SortAscending'), iconCss: 'e-icons e-sort-asc', id: id + '_ascending' },\n                    { text: l10n.getConstant('SortDescending'), iconCss: 'e-icons e-sort-desc', id: id + '_descending' },\n                    { text: l10n.getConstant('CustomSort') + '...', iconCss: 'e-icons e-sort-custom', id: id + '_customsort' }\n                ]\n            });\n        }\n    };\n    ContextMenu.prototype.setHyperLink = function (items, id) {\n        var sheet = this.parent.getActiveSheet();\n        if (this.parent.allowHyperlink) {\n            var l10n = this.parent.serviceLocator.getService(locale);\n            if ((!document.activeElement.getElementsByClassName('e-hyperlink')[0] &&\n                !document.activeElement.classList.contains('e-hyperlink')) || (sheet.isProtected && !sheet.protectSettings.insertLink)) {\n                items.push({\n                    text: l10n.getConstant('Hyperlink'), iconCss: 'e-icons e-hyperlink-icon', id: id + '_hyperlink'\n                });\n            }\n            else {\n                items.push({ text: l10n.getConstant('EditHyperlink'), iconCss: 'e-icons e-edithyperlink-icon', id: id + '_editHyperlink' }, { text: l10n.getConstant('OpenHyperlink'), iconCss: 'e-icons e-openhyperlink-icon', id: id + '_openHyperlink' }, { text: l10n.getConstant('RemoveHyperlink'), iconCss: 'e-icons e-removehyperlink-icon', id: id + '_removeHyperlink' });\n            }\n        }\n    };\n    ContextMenu.prototype.setClipboardData = function (items, l10n, id) {\n        if (this.parent.enableClipboard) {\n            items.push({\n                text: l10n.getConstant('Cut'),\n                iconCss: 'e-icons e-cut-icon', id: id + '_cut'\n            });\n            items.push({\n                text: l10n.getConstant('Copy'),\n                iconCss: 'e-icons e-copy-icon', id: id + '_copy'\n            });\n            items.push({\n                text: l10n.getConstant('Paste'),\n                iconCss: 'e-icons e-paste-icon', id: id + '_paste'\n            });\n            items.push({\n                text: l10n.getConstant('PasteSpecial'), id: id + '_pastespecial',\n                items: [\n                    { text: l10n.getConstant('Values'), id: id + '_pastevalues' },\n                    { text: l10n.getConstant('Formats'), id: id + '_pasteformats' }\n                ]\n            });\n        }\n    };\n    ContextMenu.prototype.setInsertDeleteItems = function (items, l10n, layout, id, indexes, subItems) {\n        items.push({ separator: true });\n        ['Insert', 'Delete'].forEach(function (action) {\n            if (indexes[0] === indexes[1]) {\n                items.push({ text: l10n.getConstant(\"\" + action + layout), id: id + (\"_\" + action.toLowerCase() + \"_\" + layout.toLowerCase()) });\n            }\n            else {\n                items.push({ text: l10n.getConstant(\"\" + action + layout + \"s\"), id: id + (\"_\" + action.toLowerCase() + \"_\" + layout.toLowerCase()) });\n            }\n            if (action === 'Insert') {\n                items[items.length - 1].items = [];\n                subItems.forEach(function (item) {\n                    items[items.length - 1].items.push({\n                        text: l10n.getConstant(item), id: items[items.length - 1].id + \"_\" + item.toLowerCase()\n                    });\n                });\n            }\n        });\n    };\n    ContextMenu.prototype.setHideShowItems = function (items, l10n, layout, id, indexes) {\n        if (indexes[0] === indexes[1]) {\n            items.push({ text: l10n.getConstant(\"Hide\" + layout), id: id + (\"_hide_\" + layout.toLowerCase()) });\n        }\n        else {\n            items.push({ text: l10n.getConstant(\"Hide\" + layout + \"s\"), id: id + (\"_hide_\" + layout.toLowerCase()) });\n        }\n        if (this.parent.hiddenCount(indexes[0], indexes[1], layout.toLowerCase() + \"s\")) {\n            items.push({ text: l10n.getConstant(\"UnHide\" + layout + \"s\"), id: id + (\"_unhide_\" + layout.toLowerCase()) });\n        }\n    };\n    /**\n     * To add event listener.\n     */\n    ContextMenu.prototype.addEventListener = function () {\n        this.parent.on(addContextMenuItems, this.addItemsHandler, this);\n        this.parent.on(removeContextMenuItems, this.removeItemsHandler, this);\n        this.parent.on(enableContextMenuItems, this.enableItemsHandler, this);\n    };\n    /**\n     * To add context menu items before / after particular item.\n     */\n    ContextMenu.prototype.addItemsHandler = function (args) {\n        if (args.insertAfter) {\n            this.contextMenuInstance.insertAfter(args.items, args.text, args.isUniqueId);\n        }\n        else {\n            this.contextMenuInstance.insertBefore(args.items, args.text, args.isUniqueId);\n        }\n    };\n    /**\n     * To remove context menu items.\n     */\n    ContextMenu.prototype.removeItemsHandler = function (args) {\n        this.contextMenuInstance.removeItems(args.items, args.isUniqueId);\n    };\n    /**\n     * To enable / disable context menu items.\n     */\n    ContextMenu.prototype.enableItemsHandler = function (args) {\n        this.contextMenuInstance.enableItems(args.items, args.enable, args.isUniqueId);\n    };\n    /**\n     * To remove event listener.\n     */\n    ContextMenu.prototype.removeEventListener = function () {\n        if (!this.parent.isDestroyed) {\n            this.parent.off(addContextMenuItems, this.addItemsHandler);\n            this.parent.off(removeContextMenuItems, this.removeItemsHandler);\n            this.parent.off(enableContextMenuItems, this.enableItemsHandler);\n        }\n    };\n    /**\n     * To get module name.\n     */\n    ContextMenu.prototype.getModuleName = function () {\n        return 'contextMenu';\n    };\n    /**\n     * Destroy method.\n     */\n    ContextMenu.prototype.destroy = function () {\n        this.removeEventListener();\n        this.contextMenuInstance.destroy();\n        var ele = document.getElementById(this.parent.element.id + '_contextmenu');\n        if (ele) {\n            detach(ele);\n        }\n        this.parent = null;\n    };\n    return ContextMenu;\n}());\nexport { ContextMenu };\n","import { refreshCellElement } from '../../workbook/common/event';\nimport { isNullOrUndefined } from '@syncfusion/ej2-base';\n/**\n * Specifies number format.\n */\nvar NumberFormat = /** @class */ (function () {\n    function NumberFormat(parent) {\n        this.parent = parent;\n        this.addEventListener();\n        //Spreadsheet.Inject(WorkbookNumberFormat);\n    }\n    NumberFormat.prototype.refreshCellElement = function (args) {\n        var cell = this.parent.getCell(args.rowIndex, args.colIndex);\n        if (!isNullOrUndefined(cell)) {\n            this.parent.refreshNode(cell, args);\n        }\n    };\n    /**\n     * Adding event listener for number format.\n     * @hidden\n     */\n    NumberFormat.prototype.addEventListener = function () {\n        this.parent.on(refreshCellElement, this.refreshCellElement, this);\n    };\n    /**\n     * Removing event listener for number format.\n     * @hidden\n     */\n    NumberFormat.prototype.removeEventListener = function () {\n        if (!this.parent.isDestroyed) {\n            this.parent.off(refreshCellElement, this.refreshCellElement);\n        }\n    };\n    /**\n     * To Remove the event listeners.\n     */\n    NumberFormat.prototype.destroy = function () {\n        this.removeEventListener();\n        this.parent = null;\n    };\n    /**\n     * Get the workbook import module name.\n     */\n    NumberFormat.prototype.getModuleName = function () {\n        return 'numberFormat';\n    };\n    return NumberFormat;\n}());\nexport { NumberFormat };\n","import { initiateCustomSort, locale, dialog, getFilterRange } from '../index';\nimport { applySort, completeAction, beginAction } from '../index';\nimport { sortComplete, beforeSort, getFormattedCellObject } from '../../workbook/common/event';\nimport { getIndexesFromAddress, getSwapRange, getCell, inRange } from '../../workbook/index';\nimport { getColumnHeaderText, getRangeAddress } from '../../workbook/index';\nimport { getUniqueID, getComponent, enableRipple } from '@syncfusion/ej2-base';\nimport { DropDownList } from '@syncfusion/ej2-dropdowns';\nimport { RadioButton, CheckBox } from '@syncfusion/ej2-buttons';\nimport { ListView } from '@syncfusion/ej2-lists';\n/**\n * `Sort` module is used to handle the sort action in Spreadsheet.\n */\nvar Sort = /** @class */ (function () {\n    /**\n     * Constructor for sort module.\n     */\n    function Sort(parent) {\n        this.parent = parent;\n        this.addEventListener();\n    }\n    /**\n     * To destroy the sort module.\n     * @return {void}\n     */\n    Sort.prototype.destroy = function () {\n        this.removeEventListener();\n        this.parent = null;\n    };\n    Sort.prototype.addEventListener = function () {\n        this.parent.on(applySort, this.applySortHandler, this);\n        this.parent.on(sortComplete, this.sortCompleteHandler, this);\n        this.parent.on(initiateCustomSort, this.initiateCustomSortHandler, this);\n    };\n    Sort.prototype.removeEventListener = function () {\n        if (!this.parent.isDestroyed) {\n            this.parent.off(applySort, this.applySortHandler);\n            this.parent.off(sortComplete, this.sortCompleteHandler);\n            this.parent.off(initiateCustomSort, this.initiateCustomSortHandler);\n        }\n    };\n    /**\n     * Gets the module name.\n     * @returns string\n     */\n    Sort.prototype.getModuleName = function () {\n        return 'sort';\n    };\n    /**\n     * Validates the range and returns false when invalid.\n     */\n    Sort.prototype.isValidSortRange = function () {\n        var sheet = this.parent.getActiveSheet();\n        var range = getSwapRange(getIndexesFromAddress(sheet.selectedRange));\n        if (range[0] > sheet.usedRange.rowIndex || range[1] > sheet.usedRange.colIndex) {\n            return false;\n        }\n        return true;\n    };\n    /**\n     * Shows the range error alert dialog.\n     * @param error - range error string.\n     */\n    Sort.prototype.sortRangeAlertHandler = function (args) {\n        var _this = this;\n        var dialogInst = this.parent.serviceLocator.getService(dialog);\n        dialogInst.show({\n            height: 180, width: 400, isModal: true, showCloseIcon: true,\n            content: args.error,\n            beforeOpen: function (args) {\n                var dlgArgs = {\n                    dialogName: 'SortRangeDialog',\n                    element: args.element, target: args.target, cancel: args.cancel\n                };\n                _this.parent.trigger('dialogBeforeOpen', dlgArgs);\n                if (dlgArgs.cancel) {\n                    args.cancel = true;\n                }\n            },\n        });\n        this.parent.hideSpinner();\n    };\n    /**\n     * Initiates the custom sort dialog.\n     */\n    Sort.prototype.initiateCustomSortHandler = function () {\n        var _this = this;\n        var l10n = this.parent.serviceLocator.getService(locale);\n        if (!this.isValidSortRange()) {\n            this.sortRangeAlertHandler({ error: l10n.getConstant('SortOutOfRangeError') });\n            return;\n        }\n        var dialogInst = this.parent.serviceLocator.getService(dialog);\n        dialogInst.show({\n            height: 400, width: 560, isModal: true, showCloseIcon: true, cssClass: 'e-customsort-dlg',\n            header: l10n.getConstant('CustomSort'),\n            beforeOpen: function (args) {\n                var dlgArgs = {\n                    dialogName: 'CustomSortDialog',\n                    element: args.element, target: args.target, cancel: args.cancel\n                };\n                _this.parent.trigger('dialogBeforeOpen', dlgArgs);\n                if (dlgArgs.cancel) {\n                    args.cancel = true;\n                }\n                dialogInst.dialogInstance.content = _this.customSortContent();\n                dialogInst.dialogInstance.dataBind();\n                _this.parent.element.focus();\n            },\n            buttons: [{\n                    buttonModel: {\n                        content: l10n.getConstant('Ok'), isPrimary: true\n                    },\n                    click: function () {\n                        var element = dialogInst.dialogInstance.content;\n                        var list = element.getElementsByClassName('e-list-sort e-listview e-lib')[0];\n                        var listview = getComponent(list, 'listview');\n                        var data = listview.dataSource;\n                        _this.clearError();\n                        var errorElem = element.getElementsByClassName('e-sort-error')[0];\n                        errorElem.style.display = 'block';\n                        if (!_this.validateError(data, element, errorElem)) {\n                            dialogInst.hide();\n                            var headercheck = element.getElementsByClassName('e-sort-checkheader')[0];\n                            var headerCheckbox = getComponent(headercheck, 'checkbox');\n                            var caseCheckbox = getComponent(element.getElementsByClassName('e-sort-checkcase')[0], 'checkbox');\n                            var hasHeader = headerCheckbox.checked;\n                            _this.applySortHandler({ sortOptions: { sortDescriptors: data, containsHeader: hasHeader, caseSensitive: caseCheckbox.checked } });\n                        }\n                    }\n                }]\n        });\n    };\n    /**\n     * Validates the errors of the sort criteria and displays the error.\n     * @param json - listview datasource.\n     * @param dialogElem - dialog content element.\n     * @param errorElem - element to display error.\n     */\n    Sort.prototype.validateError = function (json, dialogElem, errorElem) {\n        var l10n = this.parent.serviceLocator.getService(locale);\n        var hasEmpty = json.some(function (element) { return element.field.toString() === ''; });\n        if (hasEmpty) {\n            Array.prototype.some.call(dialogElem.getElementsByClassName('e-sort-field'), function (dropDown) {\n                var hasError = !getComponent(dropDown, 'dropdownlist').value;\n                if (hasError) {\n                    dropDown.parentElement.classList.add('e-error');\n                }\n                return hasError; //breaks the loop if only one error added.\n            });\n            errorElem.innerText = l10n.getConstant('SortEmptyFieldError');\n            return true;\n        }\n        var temp = new Set();\n        var duplicateField = '';\n        var hasDuplicate = json.some(function (element) {\n            duplicateField = element.field.toString();\n            return temp.size === temp.add(element.field).size;\n        });\n        var errorField = '';\n        if (hasDuplicate) {\n            var count_1 = 0;\n            Array.prototype.some.call(dialogElem.getElementsByClassName('e-sort-field'), function (dropDown) {\n                var dropDownList = getComponent(dropDown, 'dropdownlist');\n                if (dropDownList.value === duplicateField) {\n                    dropDown.parentElement.classList.add('e-error');\n                    errorField = dropDownList.text;\n                    count_1++;\n                }\n                return count_1 === 2; //breaks the loop when 2 errors added.\n            });\n            errorElem.innerHTML = '<strong>' + errorField + '</strong>' + l10n.getConstant('SortDuplicateFieldError');\n            return true;\n        }\n        return false;\n    };\n    /**\n     * Creates all the elements and generates the dialog content element.\n     */\n    Sort.prototype.customSortContent = function () {\n        var dialogElem = this.parent.createElement('div', { className: 'e-sort-dialog' });\n        var fields = this.getFields();\n        var listId = getUniqueID('customSort');\n        var listviewObj = this.getCustomListview(listId);\n        this.setHeaderTab(dialogElem, listviewObj, fields);\n        var contentElem = this.parent.createElement('div', {\n            className: 'e-sort-listsection',\n            styles: ''\n        });\n        dialogElem.appendChild(contentElem);\n        var listview = this.parent.createElement('div', { className: 'e-list-sort', styles: '' });\n        contentElem.appendChild(listview);\n        listviewObj.createElement = this.parent.createElement;\n        listviewObj.appendTo(listview);\n        this.renderListItem(listId, listviewObj, true, fields);\n        var errorElem = this.parent.createElement('div', { className: 'e-sort-error' });\n        dialogElem.appendChild(errorElem);\n        return dialogElem;\n    };\n    /**\n     * Gets the fields data from the selected range.\n     */\n    Sort.prototype.getFields = function () {\n        var sheet = this.parent.getActiveSheet();\n        var range = getSwapRange(getIndexesFromAddress(sheet.selectedRange));\n        if (range[0] === range[2] && (range[2] - range[0]) === 0) { //for entire range\n            range[0] = 0;\n            range[1] = 0;\n            range[3] = sheet.usedRange.colIndex;\n            var args = { filterRange: [], hasFilter: false };\n            this.parent.notify(getFilterRange, args);\n            if (args.hasFilter && args.filterRange) {\n                range[0] = args.filterRange[0];\n            }\n        }\n        var fields = [];\n        var fieldName;\n        for (range[1]; range[1] <= range[3]; range[1]++) {\n            var cell = getCell(range[0], range[1], sheet);\n            if (cell && cell.value) {\n                var eventArgs = {\n                    formattedText: cell.value,\n                    value: cell.value,\n                    format: cell.format,\n                    onLoad: true\n                };\n                if (cell.format) {\n                    this.parent.notify(getFormattedCellObject, eventArgs);\n                }\n                fieldName = eventArgs.formattedText;\n            }\n            else {\n                fieldName = 'Column ' + getColumnHeaderText(range[1] + 1);\n            }\n            fields.push({ text: fieldName, value: 'Column ' + getColumnHeaderText(range[1] + 1) });\n        }\n        return fields;\n    };\n    /**\n     * Creates the header tab for the custom sort dialog.\n     * @param dialogElem - dialog content element.\n     * @param listviewObj - listview instance.\n     * @param fields - fields data.\n     */\n    Sort.prototype.setHeaderTab = function (dialogElem, listviewObj, fields) {\n        var _this = this;\n        var l10n = this.parent.serviceLocator.getService(locale);\n        var headerTabElement = this.parent.createElement('div', {\n            className: 'e-sort-header',\n            styles: '',\n            innerHTML: ''\n        });\n        dialogElem.appendChild(headerTabElement);\n        var addButton = this.parent.createElement('button', {\n            className: 'e-btn e-sort-addbtn e-flat',\n            innerHTML: l10n.getConstant('AddColumn')\n        });\n        var footer = this.parent.element.querySelector('.e-customsort-dlg .e-footer-content');\n        footer.insertBefore(addButton, footer.firstElementChild);\n        addButton.addEventListener('click', function () {\n            if (listviewObj) {\n                var listId = getUniqueID('customSort');\n                listviewObj.addItem([{ id: listId, text: l10n.getConstant('ThenBy'), field: '', order: 'ascending' }]);\n                _this.renderListItem(listId, listviewObj, checkHeaderObj.checked, fields, true);\n            }\n        });\n        var checkHeaderObj = new CheckBox({\n            label: l10n.getConstant('ContainsHeader'),\n            checked: true,\n            change: function (args) {\n                var fieldsMap = args.checked ? { text: 'text', value: 'value' } : { text: 'value' };\n                Array.prototype.forEach.call(dialogElem.getElementsByClassName('e-sort-field e-dropdownlist e-lib'), function (dropDown) {\n                    var dropDownListObj = getComponent(dropDown, 'dropdownlist');\n                    dropDownListObj.dataSource = null; //reset datasource.\n                    dropDownListObj.dataSource = fields;\n                    dropDownListObj.fields = fieldsMap;\n                    dropDownListObj.dataBind();\n                });\n            },\n            cssClass: 'e-sort-headercheckbox'\n        });\n        var headerCheckbox = this.parent.createElement('input', {\n            className: 'e-sort-checkheader', attrs: { type: 'checkbox' }\n        });\n        headerTabElement.appendChild(headerCheckbox);\n        checkHeaderObj.createElement = this.parent.createElement;\n        checkHeaderObj.appendTo(headerCheckbox);\n        var checkCaseObj = new CheckBox({\n            label: l10n.getConstant('CaseSensitive'),\n            checked: false,\n            cssClass: 'e-sort-casecheckbox'\n        });\n        var caseCheckbox = this.parent.createElement('input', {\n            className: 'e-sort-checkcase', attrs: { type: 'checkbox' }\n        });\n        headerTabElement.appendChild(caseCheckbox);\n        checkCaseObj.createElement = this.parent.createElement;\n        checkCaseObj.appendTo(caseCheckbox);\n    };\n    /**\n     * Creates a listview instance.\n     * @param listId - unique id of the list item.\n     */\n    Sort.prototype.getCustomListview = function (listId) {\n        var l10n = this.parent.serviceLocator.getService(locale);\n        var data = [{ id: listId, text: l10n.getConstant('SortBy'), field: '', order: 'ascending' }];\n        enableRipple(false);\n        var listviewObj = new ListView({\n            dataSource: data,\n            fields: { id: 'id' },\n            height: '100%',\n            template: '<div class=\"e-sort-listwrapper\">' +\n                '<span class=\"text\">${text}</span>' +\n                '<div class=\"e-sort-row\"><div class=\"e-sort-field\"></div>' +\n                '<div class=\"e-sort-order\">' +\n                '<span class=\"e-sort-ordertxt\" style=\"display:none;\">${order}</span></div>' +\n                '<span class=\"e-icons e-sort-delete\"></span></div>',\n            cssClass: 'e-sort-template',\n        });\n        return listviewObj;\n    };\n    /**\n     * Triggers the click event for delete icon.\n     * @param element - current list item element.\n     * @param listviewObj - listview instance.\n     */\n    Sort.prototype.deleteHandler = function (element, listviewObj) {\n        var iconEle = element.getElementsByClassName('e-sort-delete')[0];\n        //Event handler to bind the click event for delete icon\n        iconEle.addEventListener('click', function () {\n            if (element) {\n                listviewObj.removeItem(element);\n            }\n        });\n    };\n    /**\n     * Renders the dropdown and radio button components inside list item.\n     * @param id - unique id of the list item.\n     * @param listviewObj - listview instance.\n     * @param containsHeader - data contains header.\n     * @param fields - fields data.\n     */\n    Sort.prototype.renderListItem = function (id, lvObj, containsHeader, fields, btn) {\n        var _this = this;\n        var l10n = this.parent.serviceLocator.getService(locale);\n        var element = lvObj.element.querySelector('li[data-uid=' + id + ']');\n        var fieldsMap = containsHeader ? { text: 'text', value: 'value' } : { text: 'value' };\n        var dropDown = element.getElementsByClassName('e-sort-field')[0];\n        var dropDownListObj = new DropDownList({\n            dataSource: fields,\n            width: 'auto',\n            cssClass: 'e-sort-field-ddl',\n            fields: fieldsMap,\n            placeholder: l10n.getConstant('SelectAColumn'),\n            change: function (args) {\n                if (!args.value) {\n                    return;\n                }\n                Array.prototype.some.call(lvObj.dataSource, function (item) {\n                    if (item.id === id) {\n                        item.field = args.value.toString().replace('Column ', '');\n                    }\n                    return item.id === id; //breaks the loop when proper id found\n                });\n                _this.clearError();\n            }\n        });\n        dropDownListObj.createElement = this.parent.createElement;\n        dropDownListObj.appendTo(dropDown);\n        if (!btn) {\n            dropDownListObj.index = 0;\n        }\n        /* sort ascending radio button */\n        var orderRadio = element.getElementsByClassName('e-sort-order')[0];\n        var ordertxtElem = orderRadio.getElementsByClassName('e-sort-ordertxt')[0];\n        var isAscending = ordertxtElem.innerText.toLocaleLowerCase() === 'ascending';\n        var radiobutton = new RadioButton({\n            label: l10n.getConstant('SortAscending'),\n            name: 'sortAZ_' + id, value: 'ascending', checked: isAscending, cssClass: 'e-sort-radiobutton',\n            change: function (args) { _this.setRadioBtnValue(lvObj, id, args.value); }\n        });\n        var radio = this.parent.createElement('input', {\n            id: 'orderAsc_' + id, className: 'e-sort-radioasc', styles: '', attrs: { type: 'radio' }\n        });\n        orderRadio.appendChild(radio);\n        radiobutton.createElement = this.parent.createElement;\n        radiobutton.appendTo(radio);\n        /* sort descending radio button */\n        var radiobutton2 = new RadioButton({\n            label: l10n.getConstant('SortDescending'),\n            name: 'sortAZ_' + id, value: 'descending', checked: !isAscending, cssClass: 'e-sort-radiobutton',\n            change: function (args) { _this.setRadioBtnValue(lvObj, id, args.value); }\n        });\n        var radio2 = this.parent.createElement('input', {\n            id: 'orderDesc_' + id, className: 'e-sort-radiodesc', styles: '', attrs: { type: 'radio' }\n        });\n        orderRadio.appendChild(radio2);\n        radiobutton2.createElement = this.parent.createElement;\n        radiobutton2.appendTo(radio2);\n        this.deleteHandler(element, lvObj);\n    };\n    /**\n     * Sets the new value of the radio button.\n     * @param listviewObj - listview instance.\n     * @param id - unique id of the list item.\n     * @param value - new value.\n     */\n    Sort.prototype.setRadioBtnValue = function (listviewObj, id, value) {\n        if (!value) {\n            return;\n        }\n        Array.prototype.some.call(listviewObj.dataSource, function (item) {\n            if (item.id === id) {\n                item.order = value;\n            }\n            return item.id === id; //breaks the loop when proper id found\n        });\n    };\n    /**\n     * Clears the error from the dialog.\n     * @param dialogElem - dialog content element.\n     */\n    Sort.prototype.clearError = function () {\n        var dialogElem = document.getElementsByClassName('e-sort-dialog')[0];\n        var errorElem = dialogElem.getElementsByClassName('e-sort-error')[0];\n        if (errorElem.style.display !== 'none' && errorElem.innerHTML !== '') {\n            errorElem.style.display = 'none';\n            Array.prototype.forEach.call(dialogElem.getElementsByClassName('e-error'), function (element) {\n                element.classList.remove('e-error');\n            });\n        }\n    };\n    /**\n     * Triggers sort events and applies sorting.\n     */\n    Sort.prototype.applySortHandler = function (args) {\n        var _this = this;\n        var sheet = this.parent.getActiveSheet();\n        var address = args && args.range || sheet.selectedRange;\n        var sortOptions = args && args.sortOptions || { sortDescriptors: {} };\n        var beforeArgs = { range: address, sortOptions: sortOptions, cancel: false };\n        this.parent.trigger(beforeSort, beforeArgs);\n        if (beforeArgs.cancel) {\n            return;\n        }\n        this.parent.notify(beginAction, { eventArgs: beforeArgs, action: 'beforeSort' });\n        this.parent.showSpinner();\n        var range = getSwapRange(getIndexesFromAddress(beforeArgs.range));\n        var eventArgs = { filterRange: [], hasFilter: false };\n        if (range[0] === range[2] && (range[2] - range[0]) === 0) { //check for filter range\n            this.parent.notify(getFilterRange, eventArgs);\n            if (eventArgs.hasFilter && inRange(eventArgs.filterRange, range[0], range[1])) {\n                range[0] = eventArgs.filterRange[0];\n                range[1] = 0;\n                range[2] = sheet.usedRange.rowIndex;\n                range[3] = sheet.usedRange.colIndex;\n                beforeArgs.sortOptions.containsHeader = true;\n            }\n        }\n        this.parent.sort(beforeArgs.sortOptions, getRangeAddress(range)).then(function (sortArgs) {\n            _this.parent.trigger(sortComplete, sortArgs);\n            _this.parent.notify(completeAction, { eventArgs: sortArgs, action: 'sorting' });\n            return Promise.resolve(sortArgs);\n        }).catch(function (error) {\n            _this.sortRangeAlertHandler({ error: error });\n            return Promise.reject(error);\n        });\n    };\n    /**\n     * Invoked when the sort action is completed.\n     */\n    Sort.prototype.sortCompleteHandler = function (args) {\n        var range = getIndexesFromAddress(args.range);\n        this.parent.serviceLocator.getService('cell').refreshRange(range);\n        this.parent.hideSpinner();\n    };\n    return Sort;\n}());\nexport { Sort };\n","import { locale, dialog, mouseDown, renderFilterCell, initiateFilterUI } from '../index';\nimport { reapplyFilter, filterCellKeyDown } from '../index';\nimport { getFilteredColumn, cMenuBeforeOpen, filterByCellValue, clearFilter, getFilterRange, applySort, getCellPosition } from '../index';\nimport { filterRangeAlert, filterComplete, beforeFilter, clearAllFilter, getFilteredCollection } from '../../workbook/common/event';\nimport { getRangeIndexes } from '../../workbook/index';\nimport { getIndexesFromAddress, getSwapRange, getColumnHeaderText } from '../../workbook/index';\nimport { getData, getTypeFromFormat, getCell, getCellIndexes, getRangeAddress, getSheet } from '../../workbook/index';\nimport { getComponent } from '@syncfusion/ej2-base';\nimport { ExcelFilterBase, beforeFltrcMenuOpen, CheckBoxFilterBase } from '@syncfusion/ej2-grids';\nimport { beforeCustomFilterOpen, parentsUntil, filterCboxValue } from '@syncfusion/ej2-grids';\nimport { Button } from '@syncfusion/ej2-buttons';\nimport { Query, DataManager } from '@syncfusion/ej2-data';\nimport { beginAction, completeAction } from '../../spreadsheet/index';\n/**\n * `Filter` module is used to handle the filter action in Spreadsheet.\n */\nvar Filter = /** @class */ (function () {\n    /**\n     * Constructor for filter module.\n     */\n    function Filter(parent) {\n        this.parent = parent;\n        this.filterCollection = new Map();\n        this.filterClassList = new Map();\n        this.filterRange = new Map();\n        this.addEventListener();\n    }\n    /**\n     * To destroy the filter module.\n     * @return {void}\n     */\n    Filter.prototype.destroy = function () {\n        this.removeEventListener();\n        this.filterRange = null;\n        this.filterCollection = null;\n        this.filterClassList = null;\n        this.parent = null;\n    };\n    Filter.prototype.addEventListener = function () {\n        this.parent.on(filterRangeAlert, this.filterRangeAlertHandler, this);\n        this.parent.on(initiateFilterUI, this.initiateFilterUIHandler, this);\n        this.parent.on(mouseDown, this.filterMouseDownHandler, this);\n        this.parent.on(renderFilterCell, this.renderFilterCellHandler, this);\n        this.parent.on(clearAllFilter, this.clearAllFilterHandler, this);\n        this.parent.on(beforeFltrcMenuOpen, this.beforeFilterMenuOpenHandler, this);\n        this.parent.on(beforeCustomFilterOpen, this.beforeCustomFilterOpenHandler, this);\n        this.parent.on(reapplyFilter, this.reapplyFilterHandler, this);\n        this.parent.on(filterByCellValue, this.filterByCellValueHandler, this);\n        this.parent.on(clearFilter, this.clearFilterHandler, this);\n        this.parent.on(getFilteredColumn, this.getFilteredColumnHandler, this);\n        this.parent.on(cMenuBeforeOpen, this.cMenuBeforeOpenHandler, this);\n        this.parent.on(filterCboxValue, this.filterCboxValueHandler, this);\n        this.parent.on(getFilterRange, this.getFilterRangeHandler, this);\n        this.parent.on(filterCellKeyDown, this.filterCellKeyDownHandler, this);\n        this.parent.on(getFilteredCollection, this.getFilteredCollection, this);\n    };\n    Filter.prototype.removeEventListener = function () {\n        if (!this.parent.isDestroyed) {\n            this.parent.off(filterRangeAlert, this.filterRangeAlertHandler);\n            this.parent.off(initiateFilterUI, this.initiateFilterUIHandler);\n            this.parent.off(mouseDown, this.filterMouseDownHandler);\n            this.parent.off(renderFilterCell, this.renderFilterCellHandler);\n            this.parent.off(clearAllFilter, this.clearAllFilterHandler);\n            this.parent.off(beforeFltrcMenuOpen, this.beforeFilterMenuOpenHandler);\n            this.parent.off(beforeCustomFilterOpen, this.beforeCustomFilterOpenHandler);\n            this.parent.off(reapplyFilter, this.reapplyFilterHandler);\n            this.parent.off(filterByCellValue, this.filterByCellValueHandler);\n            this.parent.off(clearFilter, this.clearFilterHandler);\n            this.parent.off(getFilteredColumn, this.getFilteredColumnHandler);\n            this.parent.off(cMenuBeforeOpen, this.cMenuBeforeOpenHandler);\n            this.parent.on(filterCboxValue, this.filterCboxValueHandler);\n            this.parent.off(getFilterRange, this.getFilterRangeHandler);\n            this.parent.off(filterCellKeyDown, this.filterCellKeyDownHandler);\n            this.parent.off(getFilteredCollection, this.getFilteredCollection);\n        }\n    };\n    /**\n     * Gets the module name.\n     * @returns string\n     */\n    Filter.prototype.getModuleName = function () {\n        return 'filter';\n    };\n    /**\n     * Validates the range and returns false when invalid.\n     */\n    Filter.prototype.isInValidFilterRange = function (sheet, range) {\n        var selectedRange = range ? getSwapRange(getIndexesFromAddress(range)) :\n            getSwapRange(getIndexesFromAddress(sheet.selectedRange));\n        return selectedRange[0] > sheet.usedRange.rowIndex || selectedRange[1] > sheet.usedRange.colIndex;\n    };\n    /**\n     * Shows the range error alert dialog.\n     * @param error - range error string.\n     */\n    Filter.prototype.filterRangeAlertHandler = function (args) {\n        var _this = this;\n        var dialogInst = this.parent.serviceLocator.getService(dialog);\n        dialogInst.show({\n            content: args.error, isModal: true,\n            height: 180, width: 400, showCloseIcon: true,\n            beforeOpen: function (args) {\n                var dlgArgs = {\n                    dialogName: 'FilterRangeDialog',\n                    element: args.element, target: args.target, cancel: args.cancel\n                };\n                _this.parent.trigger('dialogBeforeOpen', dlgArgs);\n                if (dlgArgs.cancel) {\n                    args.cancel = true;\n                }\n            },\n        });\n        this.parent.hideSpinner();\n    };\n    /**\n     * Triggers before filter context menu opened and used to add sorting items.\n     */\n    Filter.prototype.beforeFilterMenuOpenHandler = function (args) {\n        var l10n = this.parent.serviceLocator.getService(locale);\n        args.element.classList.add('e-spreadsheet-contextmenu'); // to show sort icons\n        var ul = args.element.querySelector('ul');\n        this.addMenuItem(ul, l10n.getConstant('SortDescending'), 'e-filter-sortdesc', 'e-sort-desc');\n        this.addMenuItem(ul, l10n.getConstant('SortAscending'), 'e-filter-sortasc', 'e-sort-asc');\n        args.element.appendChild(ul);\n    };\n    /**\n     * Creates new menu item element\n     */\n    Filter.prototype.addMenuItem = function (ul, text, className, iconCss) {\n        var li = this.parent.createElement('li', { className: className + ' e-menu-item' });\n        li.innerHTML = text;\n        li.insertBefore(this.parent.createElement('span', { className: 'e-menu-icon e-icons ' + iconCss }), li.firstChild);\n        ul.insertBefore(li, ul.firstChild);\n    };\n    /**\n     * Initiates the filter UI for the selected range.\n     */\n    Filter.prototype.initiateFilterUIHandler = function (args) {\n        var _this = this;\n        var predicates = args ? args.predicates : null;\n        var sheetIdx = args.sIdx;\n        if (!sheetIdx && sheetIdx !== 0) {\n            sheetIdx = this.parent.activeSheetIndex;\n        }\n        if (this.filterRange.size > 0 && this.filterRange.has(sheetIdx)) { //disable filter\n            this.removeFilter(sheetIdx);\n            if (!predicates) {\n                return;\n            }\n        }\n        var sheet = getSheet(this.parent, sheetIdx);\n        if (this.isInValidFilterRange(sheet, args.range)) {\n            var l10n = this.parent.serviceLocator.getService(locale);\n            this.filterRangeAlertHandler({ error: l10n.getConstant('FilterOutOfRangeError') });\n            return;\n        }\n        var selectedRange = sheet.selectedRange;\n        var rangeIdx = getRangeIndexes(selectedRange);\n        if (rangeIdx[0] === rangeIdx[2] && rangeIdx[1] === rangeIdx[3]) {\n            rangeIdx[0] = 0;\n            rangeIdx[1] = 1;\n            rangeIdx[2] = sheet.usedRange.rowIndex;\n            rangeIdx[3] = sheet.usedRange.colIndex;\n            selectedRange = getRangeAddress(rangeIdx);\n        }\n        var eventArgs = {\n            range: args.range ? args.range : selectedRange,\n            filterOptions: { predicates: args.predicates }, cancel: false\n        };\n        if (!args.isCut) {\n            this.parent.notify(beginAction, { action: 'filter', eventArgs: eventArgs });\n        }\n        this.processRange(sheet, sheetIdx, args ? args.range : null);\n        if (predicates) {\n            var range = this.filterRange.get(sheetIdx).slice();\n            range[0] = range[0] + 1; // to skip first row.\n            range[2] = sheet.usedRange.rowIndex; //filter range should be till used range.\n            getData(this.parent, sheet.name + \"!\" + getRangeAddress(range), true, true).then(function (jsonData) {\n                _this.filterSuccessHandler(new DataManager(jsonData), {\n                    action: 'filtering',\n                    filterCollection: predicates, field: predicates[0].field, sIdx: args.sIdx\n                });\n                predicates.forEach(function (predicate) {\n                    if (_this.filterClassList.get(sheetIdx)[predicate.field] &&\n                        _this.filterClassList.get(sheetIdx)[predicate.field].indexOf(' e-filtered') < 0) {\n                        _this.filterClassList.get(sheetIdx)[predicate.field] += ' e-filtered';\n                    }\n                });\n                _this.refreshFilterRange(null, false, args.sIdx);\n            });\n        }\n        if (!args.isCut) {\n            this.parent.notify(completeAction, { action: 'filter', eventArgs: eventArgs });\n        }\n    };\n    /**\n     * Processes the range if no filter applied.\n     */\n    Filter.prototype.processRange = function (sheet, sheetIdx, filterRange) {\n        var range = getSwapRange(getIndexesFromAddress(filterRange || sheet.selectedRange));\n        if (range[0] === range[2] && range[1] === range[3]) { //if selected range is a single cell \n            range[0] = 0;\n            range[1] = 0;\n            range[2] = sheet.usedRange.rowIndex;\n            range[3] = sheet.usedRange.colIndex;\n        }\n        this.filterRange.set(sheetIdx, range);\n        this.filterCollection.set(sheetIdx, []);\n        this.filterClassList.set(sheetIdx, {});\n        this.refreshFilterRange(range, false, sheetIdx);\n    };\n    /**\n     * Removes all the filter related collections for the active sheet.\n     */\n    Filter.prototype.removeFilter = function (sheetIdx) {\n        if (this.filterCollection.get(sheetIdx).length) {\n            this.parent.clearFilter();\n        }\n        var range = this.filterRange.get(sheetIdx).slice();\n        this.filterRange.delete(sheetIdx);\n        this.filterCollection.delete(sheetIdx);\n        this.filterClassList.delete(sheetIdx);\n        this.refreshFilterRange(range, true, sheetIdx);\n    };\n    /**\n     * Handles filtering cell value based on context menu.\n     */\n    Filter.prototype.filterByCellValueHandler = function () {\n        var _this = this;\n        var sheetIdx = this.parent.activeSheetIndex;\n        var sheet = this.parent.getActiveSheet();\n        if (this.isInValidFilterRange(sheet)) {\n            var l10n = this.parent.serviceLocator.getService(locale);\n            this.filterRangeAlertHandler({ error: l10n.getConstant('FilterOutOfRangeError') });\n            return;\n        }\n        var cell = getCellIndexes(sheet.activeCell);\n        if (!this.isFilterRange(sheetIdx, cell[0], cell[1])) {\n            this.processRange(sheet, sheetIdx);\n        }\n        var range = this.filterRange.get(sheetIdx).slice();\n        range[0] = range[0] + 1; // to skip first row.\n        range[2] = sheet.usedRange.rowIndex; //filter range should be till used range.\n        var field = getColumnHeaderText(cell[1] + 1);\n        var type = this.getColumnType(sheet, cell[1] + 1, range);\n        var predicates = [{\n                field: field,\n                operator: type === 'date' || type === 'datetime' || type === 'boolean' ? 'equal' : 'contains',\n                value: getCell(cell[0], cell[1], sheet).value, matchCase: false, type: type\n            }];\n        getData(this.parent, sheet.name + \"!\" + getRangeAddress(range), true, true).then(function (jsonData) {\n            _this.filterSuccessHandler(new DataManager(jsonData), { action: 'filtering', filterCollection: predicates, field: field });\n        });\n    };\n    /**\n     * Creates filter buttons and renders the filter applied cells.\n     */\n    Filter.prototype.renderFilterCellHandler = function (args) {\n        var sheetIdx = args.sIdx | this.parent.activeSheetIndex;\n        if (this.filterRange.has(sheetIdx) && this.isFilterCell(sheetIdx, args.rowIndex, args.colIndex)) {\n            if (!args.td) {\n                return;\n            }\n            var field = getColumnHeaderText(args.colIndex + 1);\n            if (this.filterClassList.has(sheetIdx) && !this.filterClassList.get(sheetIdx)[field]) {\n                this.filterClassList.get(sheetIdx)[field] = '';\n            }\n            if (args.td.querySelector('.e-filter-btn')) {\n                var element = args.td.querySelector('.e-filter-iconbtn');\n                var filterBtnObj = getComponent(element, 'btn');\n                filterBtnObj.iconCss = 'e-icons e-filter-icon' + this.filterClassList.get(sheetIdx)[field];\n            }\n            else {\n                var filterButton = this.parent.createElement('div', { className: 'e-filter-btn' });\n                var filterBtnObj = new Button({ iconCss: 'e-icons e-filter-icon' + this.filterClassList.get(sheetIdx)[field], cssClass: 'e-filter-iconbtn' });\n                args.td.insertBefore(filterButton, args.td.firstChild);\n                filterBtnObj.createElement = this.parent.createElement;\n                filterBtnObj.appendTo(filterButton);\n            }\n        }\n    };\n    /**\n     * Refreshes the filter header range.\n     */\n    Filter.prototype.refreshFilterRange = function (filterRange, remove, sIdx) {\n        var sheetIdx = sIdx;\n        if (!sheetIdx && sheetIdx !== 0) {\n            sheetIdx = this.parent.activeSheetIndex;\n        }\n        var range = filterRange || this.filterRange.get(sheetIdx).slice();\n        for (var index = range[1]; index <= range[3]; index++) {\n            var cell = this.parent.getCell(range[0], index);\n            if (remove) {\n                if (cell && cell.hasChildNodes()) {\n                    var element = cell.querySelector('.e-filter-btn');\n                    if (element) {\n                        cell.removeChild(element);\n                    }\n                }\n            }\n            else {\n                this.renderFilterCellHandler({ td: cell, rowIndex: range[0], colIndex: index, sIdx: sheetIdx });\n            }\n        }\n    };\n    /**\n     * Checks whether the provided cell is a filter cell.\n     */\n    Filter.prototype.isFilterCell = function (sheetIdx, rowIndex, colIndex) {\n        var range = this.filterRange.get(sheetIdx);\n        return (range && range[0] === rowIndex && range[1] <= colIndex && range[3] >= colIndex);\n    };\n    /**\n     * Checks whether the provided cell is in a filter range\n     */\n    Filter.prototype.isFilterRange = function (sheetIdx, rowIndex, colIndex) {\n        var range = this.filterRange.get(sheetIdx);\n        return (range && range[0] <= rowIndex && range[2] >= rowIndex && range[1] <= colIndex && range[3] >= colIndex);\n    };\n    /**\n     * Gets the filter information from active cell\n     */\n    Filter.prototype.getFilteredColumnHandler = function (args) {\n        var sheetIdx = this.parent.activeSheetIndex;\n        var l10n = this.parent.serviceLocator.getService(locale);\n        args.clearFilterText = l10n.getConstant('ClearFilter');\n        if (this.filterRange.has(sheetIdx)) {\n            var filterCollection = this.filterCollection.get(sheetIdx);\n            if (args.isClearAll) {\n                args.isFiltered = filterCollection && filterCollection.length > 0;\n                return;\n            }\n            var range = this.filterRange.get(sheetIdx).slice();\n            var sheet = this.parent.getActiveSheet();\n            var cell = getCellIndexes(sheet.activeCell);\n            if (this.isFilterRange(sheetIdx, cell[0], cell[1])) {\n                args.field = getColumnHeaderText(cell[1] + 1);\n                var headerCell = getCell(range[0], cell[1], sheet);\n                var cellValue = this.parent.getDisplayText(headerCell);\n                args.clearFilterText = l10n.getConstant('ClearFilterFrom') + '\\\"'\n                    + (cellValue ? cellValue.toString() : 'Column ' + args.field) + '\\\"';\n                filterCollection.some(function (value) {\n                    args.isFiltered = value.field === args.field;\n                    return args.isFiltered;\n                });\n            }\n        }\n    };\n    /**\n     * Triggers before context menu created to enable or disable items.\n     */\n    Filter.prototype.cMenuBeforeOpenHandler = function (e) {\n        var id = this.parent.element.id + '_cmenu';\n        if (e.parentItem && e.parentItem.id === id + '_filter' && e.target === '') {\n            var args = { isFiltered: false };\n            this.getFilteredColumnHandler(args);\n            this.parent.enableContextMenuItems([id + '_clearfilter', id + '_reapplyfilter'], !!args.isFiltered, true);\n        }\n    };\n    /**\n     * Closes the filter popup.\n     */\n    Filter.prototype.closeDialog = function () {\n        var filterPopup = this.parent.element.querySelector('.e-filter-popup');\n        var excelFilter = getComponent(filterPopup, 'dialog');\n        if (excelFilter) {\n            excelFilter.hide();\n        }\n    };\n    /**\n     * Returns true if the filter popup is opened.\n     */\n    Filter.prototype.isPopupOpened = function () {\n        var filterPopup = this.parent.element.querySelector('.e-filter-popup');\n        return filterPopup && filterPopup.style.display !== 'none';\n    };\n    Filter.prototype.filterCellKeyDownHandler = function (args) {\n        var sheetIdx = this.parent.activeSheetIndex;\n        var sheet = this.parent.getActiveSheet();\n        var indexes = getCellIndexes(sheet.activeCell);\n        if (this.isFilterCell(sheetIdx, indexes[0], indexes[1])) {\n            args.isFilterCell = true;\n            var pos = getCellPosition(sheet, indexes);\n            var target = this.parent.getCell(indexes[0], indexes[1]);\n            if (this.isPopupOpened()) {\n                this.closeDialog();\n            }\n            this.openDialog(target, pos.left, pos.top);\n        }\n        else {\n            args.isFilterCell = false;\n        }\n    };\n    /**\n     * Opens the filter popup dialog on filter button click.\n     */\n    Filter.prototype.filterMouseDownHandler = function (e) {\n        var target = e.target;\n        if (target.classList.contains('e-filter-icon')) {\n            if (this.isPopupOpened()) {\n                this.closeDialog();\n                return;\n            }\n            this.openDialog(target, e.x, e.y);\n        }\n        else if (this.isPopupOpened()) {\n            if (!target.classList.contains('e-searchinput') && !target.classList.contains('e-searchclear')\n                && (target.offsetParent && !target.offsetParent.classList.contains('e-filter-popup'))) {\n                this.closeDialog();\n            }\n            else {\n                this.selectSortItemHandler(target);\n            }\n        }\n    };\n    /**\n     * Opens the excel filter dialog based on target.\n     */\n    Filter.prototype.openDialog = function (target, xPos, yPos) {\n        var _this = this;\n        var cell = parentsUntil(target, 'e-cell');\n        var colIndex = parseInt(cell.getAttribute('aria-colindex'), 10);\n        var field = getColumnHeaderText(colIndex);\n        //Update datasource dynamically\n        this.parent.showSpinner();\n        var sheetIdx = this.parent.activeSheetIndex;\n        var range = this.filterRange.get(sheetIdx).slice();\n        var sheet = this.parent.getActiveSheet();\n        var filterCell = getCell(range[0], colIndex - 1, sheet);\n        var displayName = this.parent.getDisplayText(filterCell);\n        range[0] = range[0] + 1; // to skip first row.\n        range[2] = sheet.usedRange.rowIndex; //filter range should be till used range.\n        getData(this.parent, sheet.name + \"!\" + getRangeAddress(range), true, true).then(function (jsonData) {\n            //to avoid undefined array data\n            var checkBoxData;\n            jsonData.some(function (value, index) {\n                if (value) {\n                    checkBoxData = new DataManager(jsonData.slice(index));\n                }\n                return !!value;\n            });\n            var options = {\n                type: _this.getColumnType(sheet, colIndex, range), field: field, displayName: displayName || 'Column ' + field,\n                dataSource: checkBoxData, height: _this.parent.element.classList.contains('e-bigger') ? 800 : 500, columns: [],\n                hideSearchbox: false, filteredColumns: _this.filterCollection.get(sheetIdx), column: { 'field': field, 'filter': {} },\n                handler: _this.filterSuccessHandler.bind(_this, new DataManager(jsonData)), target: target,\n                position: { X: xPos, Y: yPos }, localeObj: _this.parent.serviceLocator.getService(locale)\n            };\n            var excelFilter = new ExcelFilterBase(_this.parent, _this.getLocalizedCustomOperators());\n            excelFilter.openDialog(options);\n            _this.parent.hideSpinner();\n        });\n    };\n    /**\n     * Formats cell value for listing it in filter popup.\n     */\n    Filter.prototype.filterCboxValueHandler = function (args) {\n        if (args.column && args.data) {\n            var fieldKey = 'field';\n            var field = args.column[fieldKey];\n            var dataKey = 'dataObj';\n            var rowKey = '__rowIndex';\n            if (args.value) {\n                var indexes = getCellIndexes(field + args.data[dataKey][rowKey]);\n                var cell = getCell(indexes[0], indexes[1], this.parent.getActiveSheet());\n                if (cell && cell.format) {\n                    args.value = this.parent.getDisplayText(cell);\n                }\n            }\n        }\n    };\n    /**\n     * Triggers when sorting items are chosen on context menu of filter popup.\n     */\n    Filter.prototype.selectSortItemHandler = function (target) {\n        var sortOrder = target.classList.contains('e-filter-sortasc') ? 'Ascending'\n            : target.classList.contains('e-filter-sortdesc') ? 'Descending' : null;\n        if (!sortOrder) {\n            return;\n        }\n        var sheet = this.parent.getActiveSheet();\n        var sheetIdx = this.parent.activeSheetIndex;\n        var range = this.filterRange.get(sheetIdx).slice();\n        range[0] = range[0] + 1; // to skip first row.\n        range[2] = sheet.usedRange.rowIndex; //filter range should be till used range.\n        this.parent.notify(applySort, { sortOptions: { sortDescriptors: { order: sortOrder } }, range: getRangeAddress(range) });\n        var cell = getIndexesFromAddress(sheet.activeCell);\n        var field = getColumnHeaderText(cell[1] + 1);\n        for (var _i = 0, _a = Object.keys(this.filterClassList.get(sheetIdx)); _i < _a.length; _i++) {\n            var key = _a[_i];\n            var className = this.filterClassList.get(sheetIdx)[key].replace(/\\se-sortasc-filter|\\se-sortdesc-filter/gi, '');\n            if (key === field) {\n                className += sortOrder === 'Ascending' ? ' e-sortasc-filter' : ' e-sortdesc-filter';\n            }\n            this.filterClassList.get(sheetIdx)[key] = className;\n        }\n        this.refreshFilterRange();\n        this.closeDialog();\n    };\n    /**\n     * Triggers when OK button or clear filter item is selected\n     */\n    Filter.prototype.filterSuccessHandler = function (dataSource, args) {\n        var sheetIdx = args.sIdx;\n        if (!sheetIdx && sheetIdx !== 0) {\n            sheetIdx = this.parent.activeSheetIndex;\n        }\n        var predicates = this.filterCollection.get(sheetIdx);\n        var dataManager = new DataManager(predicates);\n        var query = new Query();\n        var fields = dataManager.executeLocal(query.where('field', 'equal', args.field));\n        for (var index = 0; index < fields.length; index++) {\n            var sameIndex = -1;\n            for (var filterIndex = 0; filterIndex < predicates.length; filterIndex++) {\n                if (predicates[filterIndex].field === fields[index].field) {\n                    sameIndex = filterIndex;\n                    break;\n                }\n            }\n            if (sameIndex !== -1) {\n                predicates.splice(sameIndex, 1);\n            }\n        }\n        if (args.action === 'filtering') {\n            predicates = predicates.concat(args.filterCollection);\n            if (predicates.length && this.filterClassList.get(sheetIdx)[args.field].indexOf(' e-filtered') < 0) {\n                this.filterClassList.get(sheetIdx)[args.field] += ' e-filtered';\n            }\n        }\n        else {\n            this.filterClassList.get(sheetIdx)[args.field] = this.filterClassList.get(sheetIdx)[args.field].replace(' e-filtered', '');\n        }\n        this.filterCollection.set(sheetIdx, predicates);\n        var filterOptions = {\n            datasource: dataSource,\n            predicates: this.getPredicates(sheetIdx),\n        };\n        this.filterRange.get(sheetIdx)[2] = getSheet(this.parent, sheetIdx).usedRange.rowIndex; //extend the range if filtered\n        this.applyFilter(filterOptions, getRangeAddress(this.filterRange.get(sheetIdx)));\n    };\n    /**\n     * Triggers events for filtering and applies filter.\n     */\n    Filter.prototype.applyFilter = function (filterOptions, range) {\n        var _this = this;\n        var args = { range: range, filterOptions: filterOptions, cancel: false };\n        this.parent.trigger(beforeFilter, args);\n        if (args.cancel) {\n            return;\n        }\n        this.parent.showSpinner();\n        this.parent.filter(filterOptions, range).then(function (args) {\n            _this.refreshFilterRange();\n            _this.parent.hideSpinner();\n            _this.parent.trigger(filterComplete, args);\n            return Promise.resolve(args);\n        }).catch(function (error) {\n            _this.filterRangeAlertHandler({ error: error });\n            return Promise.reject(error);\n        });\n    };\n    /**\n     * Gets the predicates for the sheet\n     */\n    Filter.prototype.getPredicates = function (sheetIdx) {\n        var predicateList = [];\n        var excelPredicate = CheckBoxFilterBase.getPredicate(this.filterCollection.get(sheetIdx));\n        for (var _i = 0, _a = Object.keys(excelPredicate); _i < _a.length; _i++) {\n            var prop = _a[_i];\n            predicateList.push(excelPredicate[prop]);\n        }\n        return predicateList;\n    };\n    /**\n     * Gets the column type to pass it into the excel filter options.\n     */\n    Filter.prototype.getColumnType = function (sheet, colIndex, range) {\n        var num = 0;\n        var str = 0;\n        var date = 0;\n        var time = 0;\n        for (var i = range[0]; i <= sheet.usedRange.rowIndex; i++) {\n            var cell = getCell(i, colIndex - 1, sheet);\n            if (cell) {\n                if (cell.format) {\n                    var type = getTypeFromFormat(cell.format).toLowerCase();\n                    switch (type) {\n                        case 'number':\n                        case 'currency':\n                        case 'accounting':\n                        case 'percentage':\n                            num++;\n                            break;\n                        case 'shortdate':\n                        case 'longdate':\n                            date++;\n                            break;\n                        case 'time':\n                            num++;\n                            break;\n                        default:\n                            str++;\n                            break;\n                    }\n                }\n                else {\n                    if (typeof cell.value === 'string') {\n                        str++;\n                    }\n                    else {\n                        num++;\n                    }\n                }\n            }\n            else {\n                str++;\n            }\n        }\n        return (num > str && num > date && num > time) ? 'number' : (str > num && str > date && str > time) ? 'string'\n            : (date > num && date > str && date > time) ? 'date' : 'datetime';\n    };\n    /**\n     * Triggers before the custom filter dialog opened.\n     */\n    Filter.prototype.beforeCustomFilterOpenHandler = function () {\n        this.closeDialog();\n    };\n    /**\n     * Clears all the filtered columns in the active sheet.\n     */\n    Filter.prototype.clearAllFilterHandler = function () {\n        if (this.filterRange.has(this.parent.activeSheetIndex)) {\n            this.filterCollection.set(this.parent.activeSheetIndex, []);\n            for (var _i = 0, _a = Object.keys(this.filterClassList.get(this.parent.activeSheetIndex)); _i < _a.length; _i++) {\n                var key = _a[_i];\n                this.filterClassList.get(this.parent.activeSheetIndex)[key] = '';\n            }\n            this.refreshFilterRange();\n        }\n    };\n    /**\n     * Clear filter from the field.\n     */\n    Filter.prototype.clearFilterHandler = function (args) {\n        this.filterSuccessHandler(null, { action: 'clear-filter', filterCollection: [], field: args.field });\n    };\n    /**\n     * Reapplies the filter.\n     */\n    Filter.prototype.reapplyFilterHandler = function () {\n        var sheetIdx = this.parent.activeSheetIndex;\n        if (this.filterRange.has(sheetIdx)) {\n            this.applyFilter({ predicates: this.getPredicates(sheetIdx) }, getRangeAddress(this.filterRange.get(sheetIdx)));\n        }\n    };\n    /**\n     * Gets the filter information of the sheet.\n     */\n    Filter.prototype.getFilterRangeHandler = function (args) {\n        var sheetIdx = args.sheetIdx;\n        if (this.filterRange && this.filterRange.has(sheetIdx)) {\n            args.hasFilter = true;\n            args.filterRange = this.filterRange.get(sheetIdx);\n        }\n        else {\n            args.hasFilter = false;\n            args.filterRange = null;\n        }\n    };\n    /**\n     * Returns the custom operators for filter items.\n     */\n    Filter.prototype.getLocalizedCustomOperators = function () {\n        var l10n = this.parent.serviceLocator.getService(locale);\n        var numOptr = [\n            { value: 'equal', text: l10n.getConstant('Equal') },\n            { value: 'greaterthan', text: l10n.getConstant('GreaterThan') },\n            { value: 'greaterthanorequal', text: l10n.getConstant('GreaterThanOrEqual') },\n            { value: 'lessthan', text: l10n.getConstant('LessThan') },\n            { value: 'lessthanorequal', text: l10n.getConstant('LessThanOrEqual') },\n            { value: 'notequal', text: l10n.getConstant('NotEqual') }\n        ];\n        var customOperators = {\n            stringOperator: [\n                { value: 'startswith', text: l10n.getConstant('StartsWith') },\n                { value: 'endswith', text: l10n.getConstant('EndsWith') },\n                { value: 'contains', text: l10n.getConstant('Contains') },\n                { value: 'equal', text: l10n.getConstant('Equal') },\n                { value: 'notequal', text: l10n.getConstant('NotEqual') }\n            ],\n            numberOperator: numOptr,\n            dateOperator: numOptr,\n            datetimeOperator: numOptr,\n            booleanOperator: [\n                { value: 'equal', text: l10n.getConstant('Equal') },\n                { value: 'notequal', text: l10n.getConstant('NotEqual') }\n            ]\n        };\n        return customOperators;\n    };\n    /**\n     * To get filtered range and predicates collections\n     */\n    Filter.prototype.getFilteredCollection = function () {\n        var sheetLen = this.parent.sheets.length;\n        var col = [];\n        var fil;\n        for (var i = 0; i < sheetLen; i++) {\n            var range = void 0;\n            var hasFilter = void 0;\n            var args = { sheetIdx: i, filterRange: range, hasFilter: hasFilter };\n            this.getFilterRangeHandler(args);\n            if (args.hasFilter) {\n                var colCollection = [];\n                var condition = [];\n                var value = [];\n                var type = [];\n                var predicate = this.filterCollection.get(args.sheetIdx);\n                for (var i_1 = 0; i_1 < predicate.length; i_1++) {\n                    if (predicate[i_1].field && predicate[i_1].operator) {\n                        var colIdx = getCellIndexes(predicate[i_1].field + '1')[1];\n                        colCollection.push(colIdx);\n                        condition.push(predicate[i_1].operator);\n                        value.push(predicate[i_1].value);\n                        type.push(predicate[i_1].type);\n                    }\n                }\n                var address = getRangeAddress(args.filterRange);\n                fil = {\n                    sheetIdx: args.sheetIdx, filterRange: address, hasFilter: args.hasFilter, column: colCollection,\n                    criteria: condition, value: value, dataType: type\n                };\n                col.push(fil);\n            }\n        }\n        if (fil) {\n            this.parent.filterCollection = col;\n        }\n    };\n    return Filter;\n}());\nexport { Filter };\n","import { getColIdxFromClientX, createImageElement, deleteImage, refreshImagePosition } from '../common/event';\nimport { insertImage, refreshImgElem, refreshImgCellObj, getRowIdxFromClientY, } from '../common/event';\nimport { overlay, dialog } from '../common/index';\nimport { removeClass } from '@syncfusion/ej2-base';\nimport { getCell, setCell, getSheetIndex } from '../../workbook/index';\nimport { getRangeIndexes, setImage } from '../../workbook/index';\nvar SpreadsheetImage = /** @class */ (function () {\n    function SpreadsheetImage(parent) {\n        this.pictureCount = 1;\n        this.parent = parent;\n        this.addEventListener();\n        this.renderImageUpload();\n    }\n    /**\n     * Adding event listener for success and failure\n     */\n    SpreadsheetImage.prototype.addEventListener = function () {\n        this.parent.on(insertImage, this.insertImage, this);\n        this.parent.on(refreshImgElem, this.refreshImgElem, this);\n        this.parent.on(refreshImgCellObj, this.refreshImgCellObj, this);\n        this.parent.on(createImageElement, this.createImageElement, this);\n        this.parent.on(deleteImage, this.deleteImage, this);\n        this.parent.on(refreshImagePosition, this.refreshInsDelImagePosition, this);\n    };\n    /**\n     * Rendering upload component for importing images.\n     */\n    SpreadsheetImage.prototype.renderImageUpload = function () {\n        var uploadID = this.parent.element.id + '_imageUpload';\n        this.parent.element.appendChild(this.parent.createElement('input', {\n            id: uploadID,\n            attrs: { type: 'file', accept: '.image, .jpg, .png, .gif ,jpeg', name: 'fileUpload' }\n        }));\n        var uploadBox = document.getElementById(uploadID);\n        uploadBox.onchange = this.imageSelect.bind(this);\n        uploadBox.style.display = 'none';\n    };\n    /**\n     * Process after select the excel and image file.\n     * @param {Event} args - File select native event.\n     */\n    SpreadsheetImage.prototype.imageSelect = function (args) {\n        /* tslint:disable-next-line:no-any */\n        var filesData = args.target.files[0];\n        if (filesData && filesData.length < 1) {\n            return;\n        }\n        var impArgs = {\n            file: filesData\n        };\n        /* tslint:disable-next-line:no-any */\n        if (impArgs.file.type.indexOf('image') === 0) {\n            this.insertImage(impArgs);\n        }\n        else {\n            this.parent.serviceLocator.getService(dialog).show({\n                content: this.parent.serviceLocator.getService('spreadsheetLocale')\n                    .getConstant('UnsupportedFile'),\n                width: '300'\n            });\n        }\n        document.getElementById(this.parent.element.id + '_imageUpload').value = '';\n    };\n    /**\n     * Removing event listener for success and failure\n     */\n    SpreadsheetImage.prototype.removeEventListener = function () {\n        if (!this.parent.isDestroyed) {\n            this.parent.off(insertImage, this.insertImage);\n            this.parent.off(refreshImgCellObj, this.refreshImgCellObj);\n            this.parent.off(createImageElement, this.createImageElement);\n            this.parent.off(deleteImage, this.deleteImage);\n            this.parent.off(refreshImagePosition, this.refreshInsDelImagePosition);\n        }\n    };\n    // tslint:disable\n    SpreadsheetImage.prototype.insertImage = function (args, range) {\n        var _this = this;\n        this.binaryStringVal(args).then(function (src) { return _this.createImageElement({ options: { src: src }, range: range, isPublic: true }); });\n    };\n    SpreadsheetImage.prototype.binaryStringVal = function (args) {\n        return new Promise(function (resolve, reject) {\n            var reader = new FileReader();\n            reader.readAsDataURL(args.file);\n            reader.onload = function () { return resolve(reader.result); };\n            reader.onerror = function (error) { return reject(error); };\n        });\n    };\n    // tslint:enable\n    SpreadsheetImage.prototype.createImageElement = function (args) {\n        var range = args.range ? (args.range.indexOf('!') > 0) ? args.range.split('!')[1] : args.range.split('!')[0]\n            : this.parent.getActiveSheet().selectedRange;\n        var sheetIndex = (args.range && args.range.indexOf('!') > 0) ?\n            getSheetIndex(this.parent, args.range.split('!')[0]) : this.parent.activeSheetIndex;\n        var overlayObj = this.parent.serviceLocator.getService(overlay);\n        var id = args.options.imageId ? args.options.imageId : this.parent.element.id + '_overlay_picture_' + this.pictureCount;\n        var indexes = getRangeIndexes(range);\n        var sheet = sheetIndex ? this.parent.sheets[sheetIndex] : this.parent.getActiveSheet();\n        if (document.getElementById(id)) {\n            return;\n        }\n        var eventArgs = {\n            requestType: 'beforeInsertImage', range: sheet.name + '!' + range,\n            imageData: args.options.src, sheetIndex: sheetIndex\n        };\n        if (args.isPublic) {\n            this.parent.notify('actionBegin', { eventArgs: eventArgs, action: 'beforeInsertImage' });\n        }\n        if (eventArgs.cancel) {\n            return;\n        }\n        var element = overlayObj.insertOverlayElement(id, range, sheetIndex);\n        element.style.backgroundImage = 'url(\\'' + args.options.src + '\\')';\n        if (args.options.height || args.options.left) {\n            element.style.height = args.options.height + 'px';\n            element.style.width = args.options.width + 'px';\n            element.style.top = args.options.top + 'px';\n            element.style.left = args.options.left + 'px';\n        }\n        if (!args.options.imageId) {\n            this.pictureCount++;\n        }\n        var imgData = {\n            src: args.options.src, id: id, height: parseFloat(element.style.height.replace('px', '')),\n            width: parseFloat(element.style.width.replace('px', '')), top: parseFloat(element.style.top.replace('px', '')),\n            left: parseFloat(element.style.left.replace('px', ''))\n        };\n        this.parent.setUsedRange(indexes[0], indexes[1]);\n        if (args.isPublic || args.isUndoRedo) {\n            this.parent.notify(setImage, { options: [imgData], range: sheet.name + '!' + range });\n        }\n        var currCell = getCell(indexes[0], indexes[1], sheet);\n        if (!currCell.image[currCell.image.length - 1].id) {\n            currCell.image[currCell.image.length - 1].id = imgData.id;\n        }\n        eventArgs = {\n            requestType: 'insertImage', range: sheet.name + '!' + range, imageHeight: args.options.height ? args.options.height : 300,\n            imageWidth: args.options.width ? args.options.width : 400, imageData: args.options.src, id: id, sheetIndex: sheetIndex\n        };\n        if (!args.isUndoRedo && args.isPublic) {\n            this.parent.notify('actionComplete', { eventArgs: eventArgs, action: 'insertImage' });\n        }\n    };\n    SpreadsheetImage.prototype.refreshImgElem = function () {\n        var overlayElem = document.getElementsByClassName('e-ss-overlay-active')[0];\n        if (overlayElem) {\n            removeClass([overlayElem], 'e-ss-overlay-active');\n        }\n    };\n    SpreadsheetImage.prototype.refreshInsDelImagePosition = function (args) {\n        var count = args.count;\n        var sheetIdx = args.sheetIdx;\n        var sheet = this.parent.sheets[sheetIdx];\n        var pictureElements;\n        var currCellObj = getCell(args.rowIdx, args.colIdx, sheet);\n        var imageLen = currCellObj.image.length;\n        var top;\n        var left;\n        for (var i = 0; i < imageLen; i++) {\n            pictureElements = document.getElementById(currCellObj.image[i].id);\n            top = (args.type === 'Row') ? (args.status === 'insert') ? currCellObj.image[i].top + (count * 20) :\n                currCellObj.image[i].top - (count * 20) : currCellObj.image[i].top;\n            left = (args.type === 'Column') ? (args.status === 'insert') ? currCellObj.image[i].left + (count * 64) :\n                currCellObj.image[i].left - (count * 64) : currCellObj.image[i].left;\n            currCellObj.image[i].top = top;\n            currCellObj.image[i].left = left;\n            pictureElements.style.top = top + 'px';\n            pictureElements.style.left = left + 'px';\n        }\n    };\n    SpreadsheetImage.prototype.refreshImgCellObj = function (args) {\n        var prevRowIdx = { clientY: args.prevTop, isImage: true };\n        this.parent.notify(getRowIdxFromClientY, prevRowIdx);\n        var currRowIdx = { clientY: args.currentTop, isImage: true };\n        this.parent.notify(getRowIdxFromClientY, currRowIdx);\n        var prevColIdx = { clientX: args.prevLeft, isImage: true };\n        this.parent.notify(getColIdxFromClientX, prevColIdx);\n        var currColIdx = { clientX: args.currentLeft, isImage: true };\n        this.parent.notify(getColIdxFromClientX, currColIdx);\n        var sheet = this.parent.sheets[this.parent.activeSheetIndex];\n        var prevCellObj = getCell(prevRowIdx.clientY, prevColIdx.clientX, sheet);\n        var currCellObj = getCell(currRowIdx.clientY, currColIdx.clientX, sheet);\n        var prevCellImg = prevCellObj ? prevCellObj.image : [];\n        var prevImgObj;\n        var currImgObj;\n        var prevCellImgLen = (prevCellImg && prevCellImg.length) ? prevCellImg.length : 0;\n        if (prevCellObj && prevCellObj.image && prevCellImg.length > 0) {\n            for (var i = 0; i < prevCellImgLen; i++) {\n                if (prevCellImg[i].id === args.id) {\n                    prevImgObj = prevCellImg[i];\n                    prevImgObj.height = args.currentHeight;\n                    prevImgObj.width = args.currentWidth;\n                    prevImgObj.top = args.currentTop;\n                    prevImgObj.left = args.currentLeft;\n                    prevCellImg.splice(i, 1);\n                }\n            }\n            if (currCellObj && currCellObj.image) {\n                currImgObj = currCellObj.image;\n                if (prevImgObj) {\n                    currImgObj.push(prevImgObj);\n                }\n            }\n            (currImgObj) ? setCell(currRowIdx.clientY, currColIdx.clientX, sheet, { image: currImgObj }, true) :\n                setCell(currRowIdx.clientY, currColIdx.clientX, sheet, { image: [prevImgObj] }, true);\n            if (args.requestType === 'imageRefresh' && !args.isUndoRedo) {\n                var eventArgs = {\n                    requestType: 'imageRefresh', currentRowIdx: currRowIdx.clientY, currentColIdx: currColIdx.clientX,\n                    prevRowIdx: prevRowIdx.clientY, prevColIdx: prevColIdx.clientX, prevTop: args.prevTop, prevLeft: args.prevLeft,\n                    currentTop: args.currentTop, currentLeft: args.currentLeft, currentHeight: args.currentHeight,\n                    currentWidth: args.currentWidth, prevHeight: args.prevHeight, prevWidth: args.prevWidth,\n                    id: args.id, sheetIdx: this.parent.activeSheetIndex\n                };\n                this.parent.notify('actionComplete', { eventArgs: eventArgs, action: 'imageRefresh' });\n            }\n        }\n    };\n    SpreadsheetImage.prototype.deleteImage = function (args) {\n        var sheet;\n        var pictureElements = document.getElementById(args.id);\n        var rowIdx;\n        var colIdx;\n        var cellObj;\n        var prevCellImg;\n        var imgLength;\n        if (pictureElements) {\n            var imgTop = { clientY: pictureElements.offsetTop, isImage: true };\n            this.parent.notify(getRowIdxFromClientY, imgTop);\n            var imgleft = { clientX: pictureElements.offsetLeft, isImage: true };\n            this.parent.notify(getColIdxFromClientX, imgleft);\n            document.getElementById(args.id).remove();\n            rowIdx = imgTop.clientY;\n            colIdx = imgleft.clientX;\n            sheet = this.parent.sheets[this.parent.activeSheetIndex];\n        }\n        else {\n            var rangeVal = args.range ? args.range.indexOf('!') > 0 ? args.range.split('!')[1] : args.range.split('!')[0] :\n                this.parent.getActiveSheet().selectedRange;\n            var sheetIndex = args.range && args.range.indexOf('!') > 0 ? getSheetIndex(this.parent, args.range.split('!')[0]) :\n                this.parent.activeSheetIndex;\n            var index = getRangeIndexes(rangeVal);\n            rowIdx = index[0];\n            colIdx = index[1];\n            sheet = this.parent.sheets[sheetIndex];\n        }\n        cellObj = getCell(rowIdx, colIdx, sheet);\n        prevCellImg = cellObj.image;\n        imgLength = prevCellImg.length;\n        for (var i = 0; i < imgLength; i++) {\n            if (prevCellImg[i].id === args.id) {\n                prevCellImg.splice(i, 1);\n            }\n        }\n        setCell(rowIdx, colIdx, sheet, { image: prevCellImg }, true);\n    };\n    /**\n     * To Remove the event listeners.\n     */\n    SpreadsheetImage.prototype.destroy = function () {\n        this.removeEventListener();\n        this.parent = null;\n    };\n    /**\n     * Get the sheet picture module name.\n     */\n    SpreadsheetImage.prototype.getModuleName = function () {\n        return 'spreadsheetImage';\n    };\n    return SpreadsheetImage;\n}());\nexport { SpreadsheetImage };\n","import { getSheetIndex, isHiddenRow, getCell, setCell } from '../../workbook/base/index';\nimport { initiateChart, getRangeIndexes, isNumber, isDateTime, dateToInt } from '../../workbook/common/index';\nimport { overlay, locale, refreshChartCellObj, getRowIdxFromClientY, getColIdxFromClientX, deleteChart } from '../common/index';\nimport { beginAction, completeAction, clearChartBorder, focusBorder } from '../common/index';\nimport { Chart, ColumnSeries, Category, StackingColumnSeries, BarSeries } from '@syncfusion/ej2-charts';\nimport { AreaSeries, StackingAreaSeries, AccumulationChart } from '@syncfusion/ej2-charts';\nimport { Legend, StackingBarSeries, LineSeries, StackingLineSeries, ScatterSeries } from '@syncfusion/ej2-charts';\nimport { AccumulationLegend, PieSeries, AccumulationTooltip, AccumulationDataLabel } from '@syncfusion/ej2-charts';\nimport { isNullOrUndefined, getComponent, closest, detach } from '@syncfusion/ej2-base';\nimport { Tooltip } from '@syncfusion/ej2-popups';\nimport { getTypeFromFormat } from '../../workbook/integrations/index';\nimport { updateChart, deleteChartColl, getFormattedCellObject, setChart, getCellAddress } from '../../workbook/common/index';\nimport { insertChart, chartRangeSelection } from '../common/index';\nChart.Inject(ColumnSeries, LineSeries, BarSeries, AreaSeries, StackingColumnSeries, StackingLineSeries, StackingBarSeries, ScatterSeries);\nChart.Inject(StackingAreaSeries, Category, Legend, Tooltip);\nAccumulationChart.Inject(PieSeries, AccumulationTooltip, AccumulationDataLabel, AccumulationLegend);\n/**\n * Represents Chart support for Spreadsheet.\n */\nvar SpreadsheetChart = /** @class */ (function () {\n    /**\n     * Constructor for the Spreadsheet Chart module.\n     */\n    function SpreadsheetChart(parent) {\n        this.parent = parent;\n        this.addEventListener();\n    }\n    /**\n     * Adding event listener for success and failure\n     */\n    SpreadsheetChart.prototype.addEventListener = function () {\n        this.parent.on(initiateChart, this.initiateChartHandler, this);\n        this.parent.on(refreshChartCellObj, this.refreshChartCellObj, this);\n        this.parent.on(updateChart, this.updateChartHandler, this);\n        this.parent.on(deleteChart, this.deleteChart, this);\n        this.parent.on(clearChartBorder, this.clearBorder, this);\n        this.parent.on(insertChart, this.insertChartHandler, this);\n        this.parent.on(chartRangeSelection, this.chartRangeHandler, this);\n    };\n    SpreadsheetChart.prototype.insertChartHandler = function (args) {\n        var chartType = 'Column';\n        switch (args.id) {\n            case 'clusteredColumn':\n                chartType = 'Column';\n                break;\n            case 'stackedColumn':\n                chartType = 'StackingColumn';\n                break;\n            case 'stackedColumn100':\n                chartType = 'StackingColumn100';\n                break;\n            case 'clusteredBar':\n                chartType = 'Bar';\n                break;\n            case 'stackedBar':\n                chartType = 'StackingBar';\n                break;\n            case 'stackedBar100':\n                chartType = 'StackingBar100';\n                break;\n            case 'area':\n                chartType = 'Area';\n                break;\n            case 'stackedArea':\n                chartType = 'StackingArea';\n                break;\n            case 'stackedArea100':\n                chartType = 'StackingArea100';\n                break;\n            case 'line':\n                chartType = 'Line';\n                break;\n            case 'stackedLine':\n                chartType = 'StackingLine';\n                break;\n            case 'stackedLine100':\n                chartType = 'StackingLine100';\n                break;\n            case 'pie':\n                chartType = 'Pie';\n                break;\n            case 'doughnut':\n                chartType = 'Doughnut';\n                break;\n            //  case 'radar':\n            //     chartType = ;\n            //     break;\n            //  case 'radar_markers':\n            //     chartType = 'Column';\n            //     break;\n            case 'scatter':\n                chartType = 'Scatter';\n                break;\n        }\n        var chart = [{ type: chartType }];\n        this.parent.notify(setChart, { chart: chart });\n    };\n    SpreadsheetChart.prototype.chartRangeHandler = function () {\n        var overlayEle = document.querySelector('.e-datavisualization-chart.e-ss-overlay-active');\n        if (overlayEle) {\n            var chartId = overlayEle.getElementsByClassName('e-control')[0].id;\n            var chartColl = this.parent.chartColl;\n            var chartCollLen = chartColl.length;\n            for (var idx = 0; idx < chartCollLen; idx++) {\n                var chartEle = document.getElementById(chartColl[idx].id);\n                if (overlayEle && chartEle && chartColl[idx].id === chartId) {\n                    this.parent.notify(initiateChart, {\n                        option: chartColl[idx], chartCount: this.parent.chartCount, isRefresh: true\n                    });\n                }\n            }\n        }\n    };\n    SpreadsheetChart.prototype.getPropertyValue = function (rIdx, cIdx, sheetIndex) {\n        var sheets = this.parent.sheets;\n        if (sheets[sheetIndex] && sheets[sheetIndex].rows[rIdx] && sheets[sheetIndex].rows[rIdx].cells[cIdx]) {\n            var cell = getCell(rIdx, cIdx, this.parent.sheets[sheetIndex]);\n            var value = '';\n            if (cell.format) {\n                var formatObj = {\n                    type: getTypeFromFormat(cell.format),\n                    value: cell && cell.value, format: cell && cell.format ?\n                        cell.format : 'General', formattedText: cell && cell.value,\n                    onLoad: true, isRightAlign: false, cell: cell,\n                    rowIdx: rIdx.toString(), colIdx: cIdx.toString()\n                };\n                if (cell) {\n                    this.parent.notify(getFormattedCellObject, formatObj);\n                    if (typeof (formatObj.value) === 'number') {\n                        var escapeRegx = new RegExp('[!@#$%^&()+=\\';,{}|\\\":<>~_-]', 'g');\n                        formatObj.formattedText = (formatObj.formattedText.toString()).replace(escapeRegx, '');\n                        value = parseInt(formatObj.formattedText.toString(), 10);\n                    }\n                    else {\n                        value = formatObj.formattedText.toString();\n                        parseFloat('');\n                    }\n                }\n            }\n            else {\n                value = this.parent.sheets[sheetIndex].rows[rIdx].cells[cIdx].value;\n            }\n            return value;\n        }\n        else {\n            return '';\n        }\n    };\n    SpreadsheetChart.prototype.updateChartHandler = function (args) {\n        var series = this.initiateChartHandler({ option: args.chart, isRefresh: true });\n        var chartObj = this.parent.element.querySelector('.' + args.chart.id);\n        if (chartObj) {\n            var chartComp = getComponent(chartObj, 'chart');\n            chartComp.series = series;\n        }\n    };\n    SpreadsheetChart.prototype.refreshChartCellObj = function (args) {\n        var currRowIdx = { clientY: args.currentTop, isImage: true };\n        this.parent.notify(getRowIdxFromClientY, currRowIdx);\n        var prevRowIdx = { clientY: args.prevTop, isImage: true };\n        this.parent.notify(getRowIdxFromClientY, prevRowIdx);\n        var currColIdx = { clientX: args.currentLeft, isImage: true };\n        this.parent.notify(getColIdxFromClientX, currColIdx);\n        var prevColIdx = { clientX: args.prevLeft, isImage: true };\n        this.parent.notify(getColIdxFromClientX, prevColIdx);\n        var sheet = this.parent.sheets[this.parent.activeSheetIndex];\n        var prevCellObj = getCell(prevRowIdx.clientY, prevColIdx.clientX, sheet);\n        var currCellObj = getCell(currRowIdx.clientY, currColIdx.clientX, sheet);\n        var prevCellChart = prevCellObj ? prevCellObj.chart : [];\n        var prevChartObj;\n        var currChartObj;\n        var prevCellImgLen = (prevCellChart && prevCellChart.length) ? prevCellChart.length : 0;\n        if (prevCellObj && prevCellObj.chart) {\n            for (var i = 0; i < prevCellImgLen; i++) {\n                var overlayEle = document.getElementById(args.id);\n                var chartEleClassName = document.getElementById(prevCellChart[i].id);\n                if (closest(chartEleClassName, '.' + overlayEle.classList[1]) === overlayEle) {\n                    prevChartObj = prevCellChart[i];\n                    prevChartObj.height = args.currentHeight;\n                    prevChartObj.width = args.currentWidth;\n                    prevChartObj.top = args.currentTop;\n                    prevChartObj.left = args.currentLeft;\n                    prevCellChart.splice(i, 1);\n                }\n            }\n            if (currCellObj && currCellObj.chart) {\n                currChartObj = currCellObj.chart;\n                if (prevChartObj) {\n                    currChartObj.push(prevChartObj);\n                }\n            }\n            (currChartObj) ? setCell(currRowIdx.clientY, currColIdx.clientX, sheet, { chart: currChartObj }, true) :\n                setCell(currRowIdx.clientY, currColIdx.clientX, sheet, { chart: [prevChartObj] }, true);\n            if (args.requestType === 'chartRefresh' && !args.isUndoRedo) {\n                var eventArgs = {\n                    requestType: 'chartRefresh', currentRowIdx: currRowIdx.clientY, currentColIdx: currColIdx.clientX,\n                    currentWidth: args.currentWidth, prevHeight: args.prevHeight, prevWidth: args.prevWidth,\n                    prevRowIdx: prevRowIdx.clientY, prevColIdx: prevColIdx.clientX, prevTop: args.prevTop, prevLeft: args.prevLeft,\n                    currentTop: args.currentTop, currentLeft: args.currentLeft, currentHeight: args.currentHeight,\n                    id: args.id, sheetIdx: this.parent.activeSheetIndex\n                };\n                this.parent.notify('actionComplete', { eventArgs: eventArgs, action: 'chartRefresh' });\n            }\n        }\n    };\n    SpreadsheetChart.prototype.processChartRange = function (range, dataSheetIdx, opt) {\n        var xRange;\n        var yRange;\n        var lRange;\n        var trVal;\n        var blVal;\n        var tlVal;\n        var minr = range[0];\n        var minc = range[1];\n        var isStringSeries = false;\n        var maxr = range[2];\n        var maxc = range[3];\n        var isSingleRow = minr === maxr;\n        var isSingleCol = minc === maxc;\n        trVal = this.getPropertyValue(minr, maxc, dataSheetIdx);\n        // trVal = this.getParseValue(trVal);\n        blVal = this.getPropertyValue(maxr, minc, dataSheetIdx);\n        // blVal = this.getParseValue(blVal);\n        tlVal = this.getPropertyValue(minr, minc, dataSheetIdx);\n        // tlVal = this.getParseValue(tlVal);\n        if (!isNumber(blVal) || !tlVal) {\n            isStringSeries = true;\n        }\n        if (isNullOrUndefined(tlVal) && !isSingleRow && !isSingleCol || (opt.type === 'Scatter' && range[3] - range[1] === 1)) {\n            xRange = [minr + 1, minc, maxr, minc];\n            yRange = [minr + 1, minc + 1, maxr, maxc];\n            lRange = [minr, minc + 1, minr, maxc];\n        }\n        else if ((!isNullOrUndefined(blVal) && isStringSeries && !isSingleRow && !isSingleCol)) {\n            if (!isNullOrUndefined(trVal) && (!isNumber(trVal) || !tlVal)) {\n                xRange = [minr + 1, minc, maxr, minc];\n                yRange = [minr + 1, minc + 1, maxr, maxc];\n                lRange = [minr, minc + 1, minr, maxc];\n            }\n            else {\n                xRange = [minr, minc, maxr, minc];\n                yRange = [minr, minc + 1, maxr, maxc];\n            }\n        }\n        else {\n            yRange = [minr, minc, maxr, maxc];\n            if ((!isNullOrUndefined(trVal) && !isNumber(trVal) && !isDateTime(trVal))) {\n                lRange = [minr, minc, minr, maxc];\n                yRange[0] = yRange[0] + 1;\n            }\n            else if (isNullOrUndefined(tlVal) && (isSingleRow || isSingleCol)) {\n                lRange = [minr, minc, minr, maxc];\n                if (isSingleRow) {\n                    yRange[1] = yRange[1] + 1;\n                    lRange[3] = lRange[1];\n                }\n                else {\n                    yRange[0] = yRange[0] + 1;\n                }\n            }\n        }\n        return { xRange: xRange, yRange: yRange, lRange: lRange };\n    };\n    SpreadsheetChart.prototype.toIntrnlRange = function (range, sheetIdx) {\n        if (!range) {\n            range = getRangeIndexes[this.parent.sheets[sheetIdx].selectedRange];\n        }\n        else if (typeof (range) === 'string') {\n            range = getRangeIndexes[range];\n        }\n        return range;\n    };\n    SpreadsheetChart.prototype.getRangeData = function (options) {\n        options.sheetIdx = isNullOrUndefined(options.sheetIdx) ? this.parent.getActiveSheet().index : options.sheetIdx;\n        var sheet = this.parent.sheets[options.sheetIdx];\n        options.range = this.toIntrnlRange(options.range, options.sheetIdx);\n        var minc;\n        var minr;\n        var maxr;\n        var maxc;\n        var skipVirtualHiddenRow;\n        var isRowHidden;\n        var rowIdx = [];\n        var arr = [];\n        skipVirtualHiddenRow = false;\n        minr = options.range[0];\n        maxr = options.range[2];\n        maxc = options.range[3];\n        isRowHidden = isHiddenRow(sheet, minr);\n        if (skipVirtualHiddenRow && isRowHidden) {\n            maxr++;\n        }\n        else if (!isRowHidden) {\n            minc = skipVirtualHiddenRow ? 0 : options.range[1];\n            this.pushRowData(options, minr, minc, maxr, maxc, arr, rowIdx, true, options.isYvalue);\n        }\n        return arr;\n    };\n    SpreadsheetChart.prototype.pushRowData = function (options, minr, minc, maxr, maxc, arr, rowIdx, isDataSrcEnsured, isYvalue) {\n        var minCol = minc;\n        while (minr <= maxr) {\n            minc = minCol;\n            while (minc <= maxc) {\n                var value = '';\n                var cell = getCell(minr, minc, this.parent.getActiveSheet());\n                if (cell && cell.format && !isYvalue) {\n                    var forArgs = {\n                        value: cell && cell.value, format: cell && cell.format ? cell.format : 'General',\n                        formattedText: cell && cell.value, onLoad: true,\n                        type: cell && getTypeFromFormat(cell.format),\n                        rowIdx: minr.toString(), colIdx: minc.toString(),\n                        isRightAlign: false, cell: cell,\n                    };\n                    this.parent.notify(getFormattedCellObject, forArgs);\n                    value = forArgs.formattedText.toString();\n                }\n                else {\n                    value = this.parent.getValueRowCol(options.sheetIdx, minr + 1, minc + 1);\n                }\n                // = this.parent.getValueRowCol(options.sheetIdx, minr + 1, minc + 1);\n                arr.push({ value: value });\n                minc++;\n            }\n            minr++;\n        }\n        rowIdx.push(minr);\n    };\n    SpreadsheetChart.prototype.toArrayData = function (args) {\n        var prop = 'value';\n        var obj;\n        var i = 0;\n        var temp = [];\n        var len = args.length;\n        while (i < len) {\n            obj = args[i];\n            if (Object.keys(obj).length) {\n                if (prop in obj) {\n                    temp.push(obj[prop]);\n                }\n            }\n            else {\n                temp.push('');\n            }\n            i++;\n        }\n        return temp;\n    };\n    SpreadsheetChart.prototype.getVirtualXValues = function (limit) {\n        var i = 1;\n        var arr = [];\n        while (i < limit) {\n            arr.push(i.toString());\n            i++;\n        }\n        return arr;\n    };\n    // tslint:disable-next-line:max-func-body-length\n    SpreadsheetChart.prototype.processChartSeries = function (options, sheetIndex, xRange, yRange, lRange) {\n        options = options || {};\n        var seriesName = '';\n        var val;\n        var len;\n        var xValue;\n        var yValue;\n        var lValue;\n        var diff;\n        var pArr;\n        var pObj = {};\n        var j;\n        var inc;\n        var i = 0;\n        var yInc = 0;\n        var sArr = [];\n        var tArr = ['value2'];\n        var dtVal;\n        yValue = this.getRangeData({ range: yRange, sheetIdx: sheetIndex, skipFormula: true, isYvalue: true });\n        var rDiff = (yRange[2] - yRange[0]) + 1;\n        var cDiff = (yRange[3] - yRange[1]) + 1;\n        if (options.isSeriesInRows) {\n            xValue = lRange ? this.toArrayData(this.getRangeData({ range: lRange, sheetIdx: sheetIndex, skipFormula: false, isYvalue: false })) :\n                this.getVirtualXValues(cDiff + 1);\n            if (xRange) {\n                lValue = this.toArrayData(this.getRangeData({ range: xRange, sheetIdx: sheetIndex, skipFormula: false, isYvalue: false }));\n            }\n            diff = rDiff;\n        }\n        else {\n            xValue = xRange ? this.toArrayData(this.getRangeData({ range: xRange, sheetIdx: sheetIndex, skipFormula: false, isYvalue: false })) :\n                this.getVirtualXValues(rDiff + 1);\n            if (lRange) {\n                lValue = this.toArrayData(this.getRangeData({ range: lRange, sheetIdx: sheetIndex, skipFormula: false, isYvalue: false }));\n            }\n            diff = cDiff;\n        }\n        len = xValue.length;\n        inc = options.isSeriesInRows ? 1 : diff;\n        while (i < diff) {\n            j = 0;\n            pArr = [];\n            yInc = options.isSeriesInRows ? yInc : i;\n            while (j < len) {\n                if (yValue[yInc]) {\n                    val = yValue[yInc].value;\n                    if (isNumber(val)) {\n                        val = Number(val);\n                    }\n                    else {\n                        dtVal = dateToInt(val);\n                        val = isNaN(dtVal) ? 0 : dtVal;\n                    }\n                    pArr.push({ x: xValue[j], y: val });\n                }\n                yInc += inc;\n                j++;\n            }\n            if (lValue && lValue.length > 0) {\n                seriesName = lValue[i];\n            }\n            else {\n                seriesName = 'series' + i;\n            }\n            if (options.type) {\n                var type = options.type;\n                if (type === 'Line' || type === 'StackingLine' || type === 'StackingLine100') {\n                    pObj = {\n                        dataSource: pArr, type: options.type, xName: 'x', yName: 'y', name: seriesName.toString(), marker: {\n                            visible: true,\n                            width: 10,\n                            height: 10\n                        }\n                    };\n                }\n                else if (type === 'Scatter') {\n                    pObj = {\n                        dataSource: pArr, type: options.type, xName: 'x', yName: 'y', name: seriesName.toString(), marker: {\n                            visible: false,\n                            width: 12,\n                            height: 12,\n                            shape: 'Circle'\n                        }\n                    };\n                }\n                else if (type === 'Pie' || type === 'Doughnut') {\n                    var innerRadius = options.type === 'Pie' ? '0%' : '40%';\n                    pObj = {\n                        dataSource: pArr,\n                        dataLabel: {\n                            visible: true, position: 'Inside', name: 'text', font: { fontWeight: '600' }\n                        },\n                        radius: '100%', xName: 'x', yName: 'y', startAngle: 0, endAngle: 360, innerRadius: innerRadius, explode: true,\n                        explodeOffset: '10%', explodeIndex: 0, name: 'Browser'\n                    };\n                }\n                else {\n                    pObj = { dataSource: pArr, type: options.type, xName: 'x', yName: 'y', name: seriesName.toString() };\n                }\n            }\n            sArr.push(pObj);\n            i++;\n        }\n        var retVal;\n        if (options.type) {\n            var type = options.type;\n            retVal = {\n                series: sArr, xRange: options.isSeriesInRows ? lRange : xRange,\n                yRange: yRange, lRange: options.isSeriesInRows ? xRange : lRange\n            };\n        }\n        return retVal;\n    };\n    SpreadsheetChart.prototype.primaryYAxisFormat = function (yRange) {\n        if (isNullOrUndefined(yRange)) {\n            return '{value}';\n        }\n        var type;\n        var cell = getCell(yRange[0], yRange[1], this.parent.getActiveSheet());\n        if (cell && cell.format) {\n            type = getTypeFromFormat(cell.format);\n            if (type === 'Accounting') {\n                return '${value}';\n            }\n            else if (type === 'Currency') {\n                return '${value}';\n            }\n            else if (type === 'Percentage') {\n                return '{value}%';\n            }\n        }\n        return '{value}';\n    };\n    SpreadsheetChart.prototype.focusChartRange = function (xRange, yRange, lRange) {\n        var border = ['e-rcborderright', 'e-rcborderbottom', 'e-vcborderright', 'e-vcborderbottom', 'e-bcborderright', 'e-bcborderbottom'];\n        this.clearBorder();\n        if (lRange) {\n            this.parent.notify(focusBorder, {\n                startcell: { rowIndex: lRange[0], colIndex: lRange[1] },\n                endcell: { rowIndex: lRange[2], colIndex: lRange[3] }, classes: [border[0], border[1]]\n            });\n        }\n        if (xRange) {\n            this.parent.notify(focusBorder, {\n                startcell: { rowIndex: xRange[0], colIndex: xRange[1] },\n                endcell: { rowIndex: xRange[2], colIndex: xRange[3] }, classes: [border[2], border[3]]\n            });\n        }\n        this.parent.notify(focusBorder, {\n            startcell: { rowIndex: yRange[0], colIndex: yRange[1] },\n            endcell: { rowIndex: yRange[2], colIndex: yRange[3] }, classes: [border[4], border[5]]\n        });\n    };\n    SpreadsheetChart.prototype.clearBorder = function () {\n        var mainCont = this.parent.getMainContent();\n        var border = ['e-rcborderright', 'e-rcborderbottom', 'e-vcborderright', 'e-vcborderbottom', 'e-bcborderright', 'e-bcborderbottom'];\n        for (var borderIdx = 0; borderIdx < border.length; borderIdx++) {\n            var eleColl = mainCont.querySelectorAll('.' + border[borderIdx]);\n            for (var tdIdx = 0; tdIdx < eleColl.length; tdIdx++) {\n                var td = eleColl[tdIdx];\n                td.classList.remove(border[borderIdx]);\n            }\n        }\n    };\n    // tslint:disable-next-line:max-func-body-length\n    SpreadsheetChart.prototype.initiateChartHandler = function (argsOpt) {\n        var isRangeSelect = true;\n        isRangeSelect = isNullOrUndefined(argsOpt.isInitCell) ? true : !argsOpt.isInitCell;\n        var l10n = this.parent.serviceLocator.getService(locale);\n        argsOpt.isUndoRedo = isNullOrUndefined(argsOpt.isUndoRedo) ? true : argsOpt.isUndoRedo;\n        var seriesModel;\n        argsOpt.isRefresh = isNullOrUndefined(argsOpt.isRefresh) ? false : argsOpt.isRefresh;\n        var sheet = this.parent.getActiveSheet();\n        var range = argsOpt.option.range ? (argsOpt.option.range.indexOf('!') > 0) ?\n            argsOpt.option.range.split('!')[1] : argsOpt.option.range.split('!')[0]\n            : this.parent.getActiveSheet().selectedRange;\n        var rangeIdx = getRangeIndexes(range);\n        var top;\n        var left;\n        var position;\n        var options = {};\n        var isRowLesser;\n        var xRange;\n        var yRange;\n        var lRange;\n        var eventArgs;\n        if (!this.parent.allowChart && sheet.isProtected) {\n            return seriesModel;\n        }\n        var sheetIdx = (argsOpt.option.range && argsOpt.option.range.indexOf('!') > 0) ?\n            getSheetIndex(this.parent, argsOpt.option.range.split('!')[0]) : this.parent.activeSheetIndex;\n        var args = {\n            sheetIndex: sheetIdx, reqType: 'shape', type: 'actionBegin', shapeType: 'chart',\n            action: 'create', options: argsOpt.option, range: range, operation: 'create',\n        };\n        options = args.options;\n        range = args.range;\n        options = options || {};\n        var chartOptions;\n        var chartRange;\n        var type = 'chart';\n        if (rangeIdx.length > 0) {\n            var rDiff = rangeIdx[2] - rangeIdx[0];\n            var cDiff = rangeIdx[3] - rangeIdx[1];\n            if (rDiff < cDiff) {\n                isRowLesser = true;\n            }\n        }\n        options.isSeriesInRows = isRowLesser ? true : options.isSeriesInRows ? options.isSeriesInRows : false;\n        argsOpt.dataSheetIdx = isNullOrUndefined(argsOpt.dataSheetIdx) ? sheetIdx : argsOpt.dataSheetIdx;\n        chartRange = this.processChartRange(rangeIdx, argsOpt.dataSheetIdx, options);\n        xRange = chartRange.xRange;\n        yRange = chartRange.yRange;\n        lRange = chartRange.lRange;\n        if (sheetIdx === this.parent.activeSheetIndex && isRangeSelect) {\n            this.focusChartRange(xRange, yRange, lRange);\n        }\n        chartOptions = this.processChartSeries(options, argsOpt.dataSheetIdx, xRange, yRange, lRange);\n        var primaryXAxis = {\n            majorGridLines: { width: 0 },\n            minorGridLines: { width: 0 },\n            majorTickLines: { width: 0 },\n            minorTickLines: { width: 0 },\n            lineStyle: { width: 0 },\n            valueType: 'Category'\n        };\n        var primaryYAxis = {\n            lineStyle: { width: 0 },\n            majorTickLines: { width: 0 },\n            majorGridLines: { width: 1 },\n            minorGridLines: { width: 1 },\n            minorTickLines: { width: 0 },\n            labelFormat: this.primaryYAxisFormat(yRange)\n        };\n        if (argsOpt.isRefresh) {\n            return chartOptions.series;\n        }\n        if (argsOpt.isUndoRedo) {\n            eventArgs = {\n                type: argsOpt.option.type, theme: argsOpt.option.theme, isSeriesInRows: argsOpt.option.isSeriesInRows,\n                range: argsOpt.option.range, height: argsOpt.option.height, width: argsOpt.option.width, id: argsOpt.option.id,\n                posRange: argsOpt.range, isInitCell: argsOpt.isInitCell, cancel: false\n            };\n            this.parent.notify(beginAction, { eventArgs: eventArgs, action: 'beforeInsertChart' });\n            if (eventArgs.cancel) {\n                return [];\n            }\n            argsOpt.option.type = eventArgs.type;\n            argsOpt.option.theme = eventArgs.theme;\n            argsOpt.option.isSeriesInRows = eventArgs.isSeriesInRows;\n            argsOpt.option.range = eventArgs.range;\n            argsOpt.option.id = eventArgs.id;\n            argsOpt.option.height = eventArgs.height;\n            argsOpt.option.width = eventArgs.width;\n        }\n        var id = argsOpt.option.id + '_overlay';\n        var sheetIndex = (argsOpt.option.range && argsOpt.option.range.indexOf('!') > 0) ?\n            getSheetIndex(this.parent, argsOpt.option.range.split('!')[0]) : this.parent.activeSheetIndex;\n        var overlayObj = this.parent.serviceLocator.getService(overlay);\n        var eleRange = !isNullOrUndefined(argsOpt.isInitCell) && argsOpt.isInitCell ? argsOpt.range : range;\n        var element = overlayObj.insertOverlayElement(id, eleRange, sheetIndex);\n        element.classList.add('e-datavisualization-chart');\n        element.style.width = argsOpt.option.width + 'px';\n        element.style.height = argsOpt.option.height + 'px';\n        element.style.top = isNullOrUndefined(argsOpt.option.top) ? element.style.top : (argsOpt.option.top + 'px');\n        element.style.left = isNullOrUndefined(argsOpt.option.left) ? element.style.left : (argsOpt.option.left + 'px');\n        argsOpt.option.top = parseInt(element.style.top.replace('px', ''), 10);\n        argsOpt.option.left = parseInt(element.style.left.replace('px', ''), 10);\n        var chartContent = this.parent.createElement('div', {\n            id: argsOpt.option.id, className: argsOpt.option.id\n        });\n        if (argsOpt.option.type !== 'Pie' && argsOpt.option.type !== 'Doughnut') {\n            this.chart = new Chart({\n                primaryXAxis: primaryXAxis,\n                primaryYAxis: primaryYAxis,\n                chartArea: {\n                    border: {\n                        width: 0\n                    }\n                },\n                series: chartOptions.series,\n                tooltip: {\n                    enable: true\n                },\n                width: element.style.width,\n                height: element.style.height,\n                load: function (args) {\n                    var selectedTheme = argsOpt.option.theme;\n                    selectedTheme = selectedTheme ? selectedTheme : 'Material';\n                    args.chart.theme = (selectedTheme.charAt(0).toUpperCase() +\n                        selectedTheme.slice(1)).replace(/-dark/i, 'Dark').replace(/contrast/i, 'Contrast');\n                },\n                beforeResize: function (args) {\n                    args.cancelResizedEvent = true; // This is for cancel the resized event.\n                }\n            });\n            this.chart.appendTo(chartContent);\n        }\n        else {\n            this.chart = new AccumulationChart({\n                series: chartOptions.series,\n                width: element.style.width,\n                height: element.style.height,\n                center: { x: '50%', y: '50%' },\n                enableSmartLabels: true,\n                enableAnimation: true,\n                legendSettings: { visible: true, position: 'Bottom' },\n                load: function (args) {\n                    var selectedTheme = location.hash.split('/')[1];\n                    selectedTheme = selectedTheme ? selectedTheme : 'Material';\n                    args.accumulation.theme = (selectedTheme.charAt(0).toUpperCase() +\n                        selectedTheme.slice(1)).replace(/-dark/i, 'Dark').replace(/contrast/i, 'Contrast');\n                }\n            });\n            this.chart.appendTo(chartContent);\n        }\n        element.appendChild(chartContent);\n        if (argsOpt.isUndoRedo) {\n            this.parent.notify(completeAction, { eventArgs: eventArgs, action: 'insertChart' });\n        }\n        return seriesModel;\n    };\n    SpreadsheetChart.prototype.deleteChart = function (args) {\n        this.clearBorder();\n        var chartElements = null;\n        var sheet;\n        if (isNullOrUndefined(args.id)) {\n            chartElements = document.querySelector('.e-datavisualization-chart.e-ss-overlay-active');\n            args.id = chartElements ? chartElements.getElementsByClassName('e-control')[0].id : null;\n        }\n        else {\n            args.id = args.id.includes('overlay') ? args.id : args.id + '_overlay';\n            chartElements = document.getElementById(args.id);\n        }\n        if (isNullOrUndefined(args.id) || isNullOrUndefined(chartElements)) {\n            return;\n        }\n        else {\n            args.id = args.id.includes('overlay') ? args.id : args.id + '_overlay';\n        }\n        var rowIdx;\n        var colIdx;\n        var cellObj;\n        var prevCellChart;\n        var chartLength;\n        var isRemoveEle = false;\n        var chartObj;\n        for (var i = 0; i < this.parent.chartColl.length; i++) {\n            if (this.parent.chartColl[i].id === args.id.split('_overlay')[0]) {\n                chartObj = this.parent.chartColl[i];\n                break;\n            }\n        }\n        var eventArgs = {\n            id: chartObj.id, range: chartObj.range, type: chartObj.type, theme: chartObj.theme, height: chartObj.height,\n            width: chartObj.width, isSeriesInRows: chartObj.isSeriesInRows, isInitCell: true, posRange: null, cancel: false\n        };\n        if (chartElements) {\n            this.parent.notify(deleteChartColl, { id: args.id });\n            var imgTop = { clientY: chartElements.offsetTop, isImage: true };\n            this.parent.notify(getRowIdxFromClientY, imgTop);\n            var imgleft = { clientX: chartElements.offsetLeft, isImage: true };\n            this.parent.notify(getColIdxFromClientX, imgleft);\n            isRemoveEle = true;\n            rowIdx = imgTop.clientY;\n            colIdx = imgleft.clientX;\n            sheet = this.parent.sheets[this.parent.activeSheetIndex];\n        }\n        else {\n            this.parent.notify(deleteChartColl, { id: args.id });\n            var sheetIndex = args.range && args.range.indexOf('!') > 0 ? getSheetIndex(this.parent, args.range.split('!')[0]) :\n                this.parent.activeSheetIndex;\n            var rangeVal = args.range ? args.range.indexOf('!') > 0 ? args.range.split('!')[1] : args.range.split('!')[0] :\n                this.parent.getActiveSheet().selectedRange;\n            var index = getRangeIndexes(rangeVal);\n            rowIdx = index[0];\n            colIdx = index[1];\n            sheet = this.parent.sheets[sheetIndex];\n        }\n        cellObj = getCell(rowIdx, colIdx, sheet);\n        if (cellObj) {\n            prevCellChart = cellObj.chart;\n        }\n        chartLength = prevCellChart ? prevCellChart.length : chartLength;\n        for (var i = 0; i < chartLength; i++) {\n            var overlayEle = document.getElementById(args.id);\n            var chartEleClassName = document.getElementById(prevCellChart[i].id);\n            if (closest(chartEleClassName, '.' + overlayEle.classList[1]) === overlayEle) {\n                prevCellChart.splice(i, 1);\n            }\n        }\n        if (isRemoveEle) {\n            document.getElementById(args.id).remove();\n        }\n        setCell(rowIdx, colIdx, sheet, { chart: prevCellChart }, true);\n        eventArgs.posRange = getCellAddress(rowIdx, colIdx);\n        this.parent.notify(completeAction, { eventArgs: eventArgs, action: 'deleteChart' });\n    };\n    /**\n     * Removing event listener for success and failure\n     */\n    SpreadsheetChart.prototype.removeEventListener = function () {\n        if (!this.parent.isDestroyed) {\n            this.parent.off(initiateChart, this.initiateChartHandler);\n            this.parent.off(refreshChartCellObj, this.refreshChartCellObj);\n            this.parent.off(updateChart, this.updateChartHandler);\n            this.parent.off(deleteChart, this.deleteChart);\n            this.parent.off(clearChartBorder, this.clearBorder);\n            this.parent.off(insertChart, this.insertChartHandler);\n            this.parent.off(chartRangeSelection, this.chartRangeHandler);\n        }\n    };\n    /**\n     * To Remove the event listeners.\n     */\n    SpreadsheetChart.prototype.destroy = function () {\n        this.removeEventListener();\n        this.parent = null;\n        var chartEle = null;\n        if (this.chart) {\n            chartEle = this.chart.element;\n            this.chart.destroy();\n        }\n        if (chartEle) {\n            detach(chartEle);\n        }\n        this.chart = null;\n    };\n    /**\n     * Get the sheet chart module name.\n     */\n    SpreadsheetChart.prototype.getModuleName = function () {\n        return 'spreadsheetChart';\n    };\n    return SpreadsheetChart;\n}());\nexport { SpreadsheetChart };\n","import { Spreadsheet } from '../index';\nimport { Selection, Edit, KeyboardNavigation, KeyboardShortcut, Clipboard, WrapText, Insert, Delete, ProtectSheet } from '../actions/index';\nimport { CellFormat, CollaborativeEditing, UndoRedo, Resize, SpreadsheetHyperlink, FindAndReplace, Merge } from '../actions/index';\nimport { Formula, Sort, Filter, SpreadsheetImage, SpreadsheetChart } from '../integrations/index';\nimport { Ribbon, FormulaBar, SheetTabs, Open, ContextMenu, Save, NumberFormat } from '../integrations/index';\nimport { DataBind } from '../../workbook/index';\nimport { DataValidation } from '../actions/data-validation';\nimport { ConditionalFormatting } from '../actions/conditional-formatting';\n/**\n * Spreadsheet basic module.\n * @private\n */\nvar BasicModule = /** @class */ (function () {\n    /**\n     * Constructor for Spreadsheet basic module.\n     * @private\n     */\n    function BasicModule() {\n        Spreadsheet.Inject(Ribbon, FormulaBar, SheetTabs, Selection, Edit, KeyboardNavigation, KeyboardShortcut, Clipboard, DataBind, Open, ContextMenu, Save, NumberFormat, CellFormat, Formula, Sort, CollaborativeEditing, UndoRedo, Resize, Filter, SpreadsheetHyperlink, WrapText, Insert, Delete, ProtectSheet, DataValidation, FindAndReplace, Merge, ConditionalFormatting, SpreadsheetImage, SpreadsheetChart);\n    }\n    /**\n     * For internal use only - Get the module name.\n     * @private\n     */\n    BasicModule.prototype.getModuleName = function () {\n        return 'basic';\n    };\n    /**\n     * Destroys the Spreadsheet basic module.\n     * @return {void}\n     */\n    BasicModule.prototype.destroy = function () {\n        /* code snippet */\n    };\n    return BasicModule;\n}());\nexport { BasicModule };\n","import { Spreadsheet } from '../index';\nimport { Selection, Edit, KeyboardNavigation, KeyboardShortcut, Clipboard, CellFormat, WrapText, ProtectSheet } from '../actions/index';\nimport { CollaborativeEditing, UndoRedo, Resize, SpreadsheetHyperlink, Insert, Delete, FindAndReplace, Merge } from '../actions/index';\nimport { Ribbon, FormulaBar, SheetTabs, Open, Save, NumberFormat, Formula, Sort, Filter, SpreadsheetImage } from '../integrations/index';\nimport { SpreadsheetChart } from '../integrations/index';\nimport { DataBind } from '../../workbook/integrations/index';\nimport { DataValidation } from '../actions/data-validation';\nimport { ConditionalFormatting } from '../actions/conditional-formatting';\n/**\n * Spreadsheet all module.\n * @private\n */\nvar AllModule = /** @class */ (function () {\n    /**\n     * Constructor for Spreadsheet all module.\n     * @private\n     */\n    function AllModule() {\n        Spreadsheet.Inject(Ribbon, FormulaBar, SheetTabs, Selection, Edit, KeyboardNavigation, KeyboardShortcut, Clipboard, DataBind, Open, Save, NumberFormat, CellFormat, Formula, Sort, Resize, CollaborativeEditing, UndoRedo, Filter, SpreadsheetHyperlink, WrapText, Insert, Delete, DataValidation, ProtectSheet, FindAndReplace, Merge, SpreadsheetImage, ConditionalFormatting, SpreadsheetChart);\n    }\n    /**\n     * For internal use only - Get the module name.\n     * @private\n     */\n    AllModule.prototype.getModuleName = function () {\n        return 'all';\n    };\n    /**\n     * Destroys the Spreadsheet all module.\n     * @return {void}\n     */\n    AllModule.prototype.destroy = function () {\n        /* code snippet */\n    };\n    return AllModule;\n}());\nexport { AllModule };\n","var __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    }\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nimport { Property, ChildProperty } from '@syncfusion/ej2-base';\n/**\n * Represents the scroll settings.\n */\nvar ScrollSettings = /** @class */ (function (_super) {\n    __extends(ScrollSettings, _super);\n    function ScrollSettings() {\n        return _super !== null && _super.apply(this, arguments) || this;\n    }\n    __decorate([\n        Property(false)\n    ], ScrollSettings.prototype, \"isFinite\", void 0);\n    __decorate([\n        Property(true)\n    ], ScrollSettings.prototype, \"enableVirtualization\", void 0);\n    return ScrollSettings;\n}(ChildProperty));\nexport { ScrollSettings };\n/**\n * Represents the selection settings.\n */\nvar SelectionSettings = /** @class */ (function (_super) {\n    __extends(SelectionSettings, _super);\n    function SelectionSettings() {\n        return _super !== null && _super.apply(this, arguments) || this;\n    }\n    __decorate([\n        Property('Multiple')\n    ], SelectionSettings.prototype, \"mode\", void 0);\n    return SelectionSettings;\n}(ChildProperty));\nexport { SelectionSettings };\n","/** @hidden */\nexport var DISABLED = 'e-disabled';\n/** @hidden */\nexport var WRAPTEXT = 'e-wraptext';\n/** @hidden */\nexport var locale = 'spreadsheetLocale';\n/** @hidden */\nexport var dialog = 'dialog';\n/** @hidden */\nexport var actionEvents = 'actionEvents';\n/** @hidden */\nexport var overlay = 'shape';\n/** @hidden */\nexport var fontColor = {\n    'Custom': [\n        '#ffffff', '#000000', '#e7e6e6', '#44546a', '#4472c4', '#ed7d31', '#a5a5a5', '#ffc000', '#70ad47', '#ff0000',\n        '#f2f2f2', '#808080', '#cfcdcd', '#d5dce4', '#d9e2f3', '#fbe4d5', '#ededed', '#fff2cc', '#e2efd9', '#ffcccc',\n        '#d9d9d9', '#595959', '#aeaaaa', '#acb9ca', '#b4c6e7', '#f7caac', '#dbdbdb', '#ffe599', '#c5e0b3', '#ff8080',\n        '#bfbfbf', '#404040', '#747070', '#8496b0', '#8eaadb', '#f4b083', '#c9c9c9', '#ffd966', '#a8d08d', '#ff3333',\n        '#a6a6a6', '#262626', '#3b3838', '#323e4f', '#2f5496', '#c45911', '#7b7b7b', '#bf8f00', '#538135', '#b30000',\n        '#7f7f7f', '#0d0d0d', '#161616', '#212934', '#1f3763', '#823b0b', '#525252', '#7f5f00', '#375623', '#660000'\n    ]\n};\n/** @hidden */\nexport var fillColor = {\n    'Custom': [\n        '#ffffff', '#000000', '#ffff00', '#00ff00', '#00ffff', '#0000ff', '#ff0000', '#000080', '#800080', '#996633',\n        '#f2f2f2', '#808080', '#ffffcc', '#b3ffb3', '#ccffff', '#ccccff', '#ffcccc', '#ccccff', '#ff80ff', '#f2e6d9',\n        '#d9d9d9', '#595959', '#ffff80', '#80ff80', '#b3ffff', '#8080ff', '#ff8080', '#8080ff', '#ff00ff', '#dfbf9f',\n        '#bfbfbf', '#404040', '#ffff33', '#33ff33', '#33ffff', '#3333ff', '#ff3333', '#0000b3', '#b300b3', '#c68c53',\n        '#a6a6a6', '#262626', '#e6e600', '#00b300', '#009999', '#000099', '#b30000', '#000066', '#660066', '#86592d',\n        '#7f7f7f', '#0d0d0d', '#999900', '#006600', '#006666', '#000066', '#660000', '#00004d', '#4d004d', '#734d26',\n    ]\n};\n/**\n * Default locale text\n * @hidden\n */\nexport var defaultLocale = {\n    FindValue: 'Find value',\n    ReplaceValue: 'Replace value',\n    FindReplaceTooltip: 'Find & Replace',\n    InsertingEmptyValue: 'Reference value is not valid.',\n    ReplaceAllEnd: ' matches replaced with ',\n    ByRow: 'By Rows',\n    ByColumn: 'By Columns',\n    MatchCase: 'Match case   ',\n    MatchExactCellElements: 'Match exact cell contents',\n    Replace: 'Replace...',\n    Find: 'Find and Replace...',\n    Goto: 'Goto...',\n    EntercellAddress: 'Enter cell address',\n    GotoSpecial: 'GotoSpecial...',\n    FindAndReplace: 'Find and Replace',\n    FindNextBtn: 'Find Next',\n    FindPreviousBtn: 'Find Previous',\n    ReplaceBtn: 'Replace',\n    ReplaceAllBtn: 'Replace All',\n    GotoHeader: 'Go To',\n    GotoSpecialHeader: 'Go To Special',\n    Sheet: 'Sheet',\n    Workbook: 'Workbook',\n    NoElements: 'We couldn\\'t find what you were looking for.',\n    FindWhat: 'Find what',\n    ReplaceWith: 'Replace with',\n    Cut: 'Cut',\n    Copy: 'Copy',\n    Paste: 'Paste',\n    PasteSpecial: 'Paste Special',\n    Link: 'Link',\n    SpreadsheetHyperlink: 'SpreadsheetHyperlink',\n    Hyperlink: 'Hyperlink',\n    EditHyperlink: 'Edit Hyperlink',\n    OpenHyperlink: 'Open Hyperlink',\n    RemoveHyperlink: 'Remove Hyperlink',\n    InsertLink: 'Insert Link',\n    EditLink: 'Edit Link',\n    All: 'All',\n    Values: 'Values',\n    Formats: 'Formats',\n    Bold: 'Bold',\n    Font: 'Font',\n    FontSize: 'Font Size',\n    Italic: 'Italic',\n    Underline: 'Underline',\n    Strikethrough: 'Strikethrough',\n    TextColor: 'Text Color',\n    FillColor: 'Fill Color',\n    HorizontalAlignment: 'Horizontal Alignment',\n    AlignLeft: 'Align Left',\n    AlignCenter: 'Center',\n    AlignRight: 'Align Right',\n    VerticalAlignment: 'Vertical Alignment',\n    AlignTop: 'Align Top',\n    AlignMiddle: 'Align Middle',\n    AlignBottom: 'Align Bottom',\n    WrapText: 'Wrap Text',\n    MergeCells: 'Merge Cells',\n    MergeAll: 'Merge All',\n    MergeHorizontally: 'Merge Horizontally',\n    MergeVertically: 'Merge Vertically',\n    Unmerge: 'Unmerge',\n    UnmergeCells: 'Unmerge Cells',\n    SelectMergeType: 'Select Merge Type',\n    MergeCellsAlert: 'Merging cells will only preserve the top-leftmost(Uppermost) value. Merge anyway?',\n    PasteMergeAlert: 'We can\"t do that to a merge cell.',\n    Borders: 'Borders',\n    TopBorders: 'Top Borders',\n    LeftBorders: 'Left Borders',\n    RightBorders: 'Right Borders',\n    BottomBorders: 'Bottom Borders',\n    AllBorders: 'All Borders',\n    HorizontalBorders: 'Horizontal Borders',\n    VerticalBorders: 'Vertical Borders',\n    OutsideBorders: 'Outside Borders',\n    InsideBorders: 'Inside Borders',\n    NoBorders: 'No Borders',\n    BorderColor: 'Border Color',\n    BorderStyle: 'Border Style',\n    InsertFunction: 'Insert Function',\n    Insert: 'Insert',\n    Delete: 'Delete',\n    Rename: 'Rename',\n    Hide: 'Hide',\n    Unhide: 'Unhide',\n    NameBox: 'Name Box',\n    ShowHeaders: 'Show Headers',\n    HideHeaders: 'Hide Headers',\n    ShowGridLines: 'Show Gridlines',\n    HideGridLines: 'Hide Gridlines',\n    AddSheet: 'Add Sheet',\n    ListAllSheets: 'List All Sheets',\n    FullScreen: 'Full Screen',\n    CollapseToolbar: 'Collapse Toolbar',\n    ExpandToolbar: 'Expand Toolbar',\n    CollapseFormulaBar: 'Collapse Formula Bar',\n    ExpandFormulaBar: 'Expand Formula Bar',\n    File: 'File',\n    Home: 'Home',\n    Formulas: 'Formulas',\n    View: 'View',\n    New: 'New',\n    Open: 'Open',\n    SaveAs: 'Save As',\n    Update: 'Update',\n    ExcelXlsx: 'Microsoft Excel',\n    ExcelXls: 'Microsoft Excel 97-2003',\n    CSV: 'Comma-separated values',\n    FormulaBar: 'Formula Bar',\n    Sort: 'Sort',\n    SortAscending: 'Ascending',\n    SortDescending: 'Descending',\n    CustomSort: 'Custom Sort',\n    AddColumn: 'Add Column',\n    ContainsHeader: 'Data contains header',\n    CaseSensitive: 'Case sensitive',\n    SortBy: 'Sort by',\n    ThenBy: 'Then by',\n    SelectAColumn: 'Select a column',\n    SortEmptyFieldError: 'Sort criteria column should not be empty.',\n    SortDuplicateFieldError: ' is mentioned more than once. Duplicate columns must be removed.',\n    SortOutOfRangeError: 'Select a cell or range inside the used range and try again.',\n    SortAndFilter: 'Sort & Filter',\n    Filter: 'Filter',\n    ClearAllFilter: 'Clear',\n    ClearFilterFrom: 'Clear Filter From ',\n    ReapplyFilter: 'Reapply',\n    FilterCellValue: 'Filter by Value of Selected Cell',\n    FilterOutOfRangeError: 'Select a cell or range inside the used range and try again.',\n    HideRow: 'Hide Row',\n    HideRows: 'Hide Rows',\n    UnHideRows: 'UnHide Rows',\n    HideColumn: 'Hide Column',\n    HideColumns: 'Hide Columns',\n    UnHideColumns: 'UnHide Columns',\n    InsertRow: 'Insert Row',\n    InsertRows: 'Insert Rows',\n    Above: 'Above',\n    Below: 'Below',\n    InsertColumn: 'Insert Column',\n    InsertColumns: 'Insert Columns',\n    Before: 'Before',\n    After: 'After',\n    DeleteRow: 'Delete Row',\n    DeleteRows: 'Delete Rows',\n    DeleteColumn: 'Delete Column',\n    DeleteColumns: 'Delete Columns',\n    Ok: 'Ok',\n    Close: 'Close',\n    Cancel: 'Cancel',\n    Apply: 'Apply',\n    MoreColors: 'More Colors',\n    StandardColors: 'Standard Colors',\n    General: 'General',\n    Number: 'Number',\n    Currency: 'Currency',\n    Accounting: 'Accounting',\n    ShortDate: 'Short Date',\n    LongDate: 'Long Date',\n    Time: 'Time',\n    Percentage: 'Percentage',\n    Fraction: 'Fraction',\n    Scientific: 'Scientific',\n    Text: 'Text',\n    MobileFormulaBarPlaceHolder: 'Enter value or Formula',\n    NumberFormat: 'Number Format',\n    PasteAlert: 'You can\\'t paste this here, because the copy area and paste area aren\\'t in the same size. ' +\n        'Please try pasting in a different range.',\n    DestroyAlert: 'Are you sure you want to destroy the current workbook without saving and create a new workbook?',\n    SheetRenameInvalidAlert: 'Sheet name contains invalid character.',\n    SheetRenameEmptyAlert: 'Sheet name cannot be empty.',\n    SheetRenameAlreadyExistsAlert: 'Sheet name already exists. Please enter another name.',\n    DeleteSheetAlert: 'You can\\'t undo deleting sheets, and you might be removing some data. If you don\\'t need it, click OK to delete.',\n    DeleteSingleLastSheetAlert: 'A Workbook must contain at least one visible worksheet.',\n    PickACategory: 'Pick a category',\n    Description: 'Description',\n    UnsupportedFile: 'Unsupported File',\n    InvalidUrl: 'Invalid URL',\n    SUM: 'Adds a series of numbers and/or cells.',\n    SUMIF: 'Adds the cells based on specified condition.',\n    SUMIFS: 'Adds the cells based on specified conditions.',\n    ABS: 'Returns the value of a number without its sign.',\n    RAND: 'Returns a random number between 0 and 1.',\n    RANDBETWEEN: 'Returns a random integer based on specified values.',\n    FLOOR: 'Rounds a number down to the nearest multiple of a given factor.',\n    CEILING: 'Rounds a number up to the nearest multiple of a given factor.',\n    PRODUCT: 'Multiplies a series of numbers and/or cells.',\n    INT: 'Returns a number to the nearest integer.',\n    ROUNDUP: 'Rounds a number away from zero.',\n    SUMPRODUCT: 'Returns sum of the product of given ranges of arrays.',\n    TODAY: 'Returns the current date as date value.',\n    AVERAGE: 'Calculates average for the series of numbers and/or cells excluding text.',\n    AVERAGEIF: 'Calculates average for the cells based on specified criterion.',\n    AVERAGEIFS: 'Calculates average for the cells based on specified conditions.',\n    AVERAGEA: 'Calculates the average for the cells evaluating TRUE as 1, text and FALSE as 0.',\n    COUNT: 'Counts the cells that contain numeric values in a range.',\n    COUNTIF: 'Counts the cells based on specified condition.',\n    COUNTIFS: 'Counts the cells based on specified conditions.',\n    COUNTA: 'Counts the cells that contains values in a range.',\n    MIN: 'Returns the smallest number of the given arguments.',\n    MAX: 'Returns the largest number of the given arguments.',\n    DATE: 'Returns the date based on given year, month, and day.',\n    DAY: 'Returns the day from the given date.',\n    DAYS: 'Returns the number of days between two dates.',\n    IF: 'Returns value based on the given expression.',\n    IFS: 'Returns value based on the given multiple expressions.',\n    CalculateAND: 'Returns TRUE if all the arguments are TRUE, otherwise returns FALSE.',\n    CalculateOR: 'Returns TRUE if any of the arguments are TRUE, otherwise returns FALSE.',\n    IFERROR: 'Returns value if no error found else it will return specified value.',\n    CHOOSE: 'Returns a value from list of values, based on index number.',\n    INDEX: 'Returns a value of the cell in a given range based on row and column number.',\n    FIND: 'Returns the position of a string within another string, which is case sensitive',\n    CONCATENATE: 'Combines two or more strings together.',\n    CONCAT: 'Concatenates a list or a range of text strings.',\n    SUBTOTAL: 'Returns subtotal for a range using the given function number.',\n    RADIANS: 'Converts degrees into radians.',\n    MATCH: 'Returns the relative position of a specified value in given range.',\n    LN: 'Returns the natural logarithm of a number.',\n    INTERCEPT: 'Calculates the point of the Y-intercept line via linear regression.',\n    SLOPE: 'Returns the slope of the line from linear regression of the data points.',\n    DefineNameExists: 'This name already exists, try different name.',\n    DefineNameInValid: 'The name that you entered is not valid.',\n    CircularReference: 'When a formula refers to one or more circular references, this may result in an incorrect calculation.',\n    ShowRowsWhere: 'Show rows where:',\n    OR: 'OR',\n    AND: 'AND',\n    CustomFilterDatePlaceHolder: 'Choose a date',\n    CustomFilterPlaceHolder: 'Enter the value',\n    CustomFilter: 'Custom Filter',\n    Between: 'Between',\n    DateTimeFilter: 'DateTime Filters',\n    Undo: 'Undo',\n    Redo: 'Redo',\n    DateFilter: 'Date Filters',\n    TextFilter: 'Text Filters',\n    NumberFilter: 'Number Filters',\n    ClearFilter: 'Clear Filter',\n    NoResult: 'No Matches Found',\n    FilterFalse: 'False',\n    FilterTrue: 'True',\n    Blanks: 'Blanks',\n    SelectAll: 'Select All',\n    GreaterThanOrEqual: 'Greater Than Or Equal',\n    GreaterThan: 'Greater Than',\n    LessThanOrEqual: 'Less Than Or Equal',\n    LessThan: 'Less Than',\n    NotEqual: 'Not Equal',\n    Equal: 'Equal',\n    Contains: 'Contains',\n    EndsWith: 'Ends With',\n    StartsWith: 'Starts With',\n    ClearButton: 'Clear',\n    FilterButton: 'Filter',\n    CancelButton: 'Cancel',\n    OKButton: 'OK',\n    Search: 'Search',\n    ProtectSheet: 'Protect Sheet',\n    UnprotectSheet: 'Unprotect Sheet',\n    LockCells: 'Lock Cells',\n    SelectCells: 'Select cells',\n    FormatCells: 'Format cells',\n    FormatRows: 'Format rows',\n    FormatColumns: 'Format columns',\n    InsertLinks: 'Insert links',\n    ProtectContent: 'Protect the contents of locked cells',\n    ProtectAllowUser: ' Allow all users of this worksheet to:',\n    EditAlert: 'The cell you\\'re trying to change is protected. To make change, unprotect the sheet.',\n    SearchWithin: 'Search within',\n    SearchBy: 'Search by',\n    Reference: 'Reference',\n    DataValidation: 'Data Validation',\n    CLEARALL: 'CLEAR ALL',\n    APPLY: 'APPLY',\n    CellRange: 'Cell Range',\n    Allow: 'Allow',\n    Data: 'Data',\n    Minimum: 'Minimum',\n    Maximum: 'Maximum',\n    IgnoreBlank: 'Ignore blank',\n    WholeNumber: 'Whole Number',\n    Decimal: 'Decimal',\n    Date: 'Date',\n    TextLength: 'Text Length',\n    List: 'List',\n    NotBetween: 'Not between',\n    EqualTo: 'Equal to',\n    NotEqualTo: 'Not equal to',\n    Greaterthan: 'Greater than',\n    Lessthan: 'Less than',\n    GreaterThanOrEqualTo: 'Greater than or equal to',\n    LessThanOrEqualTo: 'Less than or equal to',\n    InCellDropDown: 'In-cell-dropdown',\n    Sources: 'Sources',\n    Value: 'Value',\n    Retry: 'Retry',\n    EnterValue: 'Enter value',\n    DialogError: 'The list source must be a reference to single row or column.',\n    ListLengthError: 'The list values allows only upto 256 charcters',\n    ValidationError: 'This value doesn' + '\\'' + 't match the data validation restrictions defined for the cell.',\n    EmptyError: 'You must enter a value',\n    ClearHighlight: 'Clear Highlight',\n    HighlightInvalidData: 'Highlight Invalid Data',\n    ClearValidation: 'Clear Validation',\n    HighlightCellsRules: 'Highlight Cells Rules',\n    CFEqualTo: 'Equal To',\n    TextThatContains: 'Text that Contains',\n    ADateOccuring: 'A Date Occuring',\n    DuplicateValues: 'Duplicate Values',\n    TopBottomRules: 'Top/Bottom Rules',\n    Top10Items: 'Top 10 Items',\n    Top10: 'Top 10',\n    Bottom10Items: 'Bottom 10 Items',\n    Bottom10: 'Bottom 10',\n    AboveAverage: 'Above Average',\n    BelowAverage: 'Below Average',\n    FormatCellsGreaterThan: 'Format cells that are GREATER THAN:',\n    FormatCellsLessThan: 'Format cells that are LESS THAN:',\n    FormatCellsBetween: 'Format cells that are BETWEEN:',\n    FormatCellsEqualTo: 'Format cells that are EQUAL TO:',\n    FormatCellsThatContainTheText: 'Format cells that contain the text:',\n    FormatCellsThatContainADateOccurring: 'Format cells that contain a date occurring:',\n    FormatCellsDuplicate: 'Format cells that contain:',\n    FormatCellsTop: 'Format cells that rank in the TOP:',\n    FormatCellsBottom: 'Format cells that rank in the BOTTOM:',\n    FormatCellsAbove: 'Format cells that are ABOVE AVERAGE:',\n    FormatCellsBelow: 'Format cells that are BELOW AVERAGE:',\n    With: 'with',\n    DataBars: 'Data Bars',\n    ColorScales: 'Color Scales',\n    IconSets: 'Icon Sets',\n    ClearRules: 'Clear Rules',\n    SelectedCells: 'Clear Rules from Selected Cells',\n    EntireSheet: 'Clear Rules from Entire Sheet',\n    ISNUMBER: 'Returns true when the value parses as a numeric value.',\n    ROUND: 'Rounds a number to a specified number of digits.',\n    GEOMEAN: 'Returns the geometric mean of an array or range of positive data.',\n    POWER: 'Returns the result of a number raised to power',\n    LOG: 'Returns the logarithm of a number to the base that you specify.',\n    TRUNC: 'Returns the truncated value of a number to a specified number of decimal places.',\n    EXP: 'Returns e raised to the power of the given number.',\n    Clear: 'Clear',\n    ClearContents: 'Clear Contents',\n    ClearAll: 'Clear All',\n    ClearFormats: 'Clear Formats',\n    ClearHyperlinks: 'Clear Hyperlinks',\n    LightRedFillWithDarkRedText: 'Light Red Fill with Dark Red Text',\n    YellowFillWithDarkYellowText: 'Yellow Fill with Dark Yellow Text',\n    GreenFillWithDarkGreenText: 'Green Fill with Dark Green Text',\n    RedFill: 'Red Fill',\n    RedText: 'Red Text',\n    Duplicate: 'Duplicate',\n    Unique: 'Unique',\n    And: 'and',\n    WebPage: 'WEB PAGE',\n    ThisDocument: 'THIS DOCUMENT',\n    DisplayText: 'Display Text',\n    Url: 'URL',\n    CellReference: 'Cell Reference',\n    DefinedNames: 'Defined Names',\n    EnterTheTextToDisplay: 'Enter the text to display',\n    EnterTheUrl: 'Enter the URL',\n    Image: 'Image',\n    ConditionalFormatting: 'Conditional Formatting',\n    BlueDataBar: 'Blue Data Bar',\n    GreenDataBar: 'Green Data Bar',\n    RedDataBar: 'Red Data Bar',\n    OrangeDataBar: 'Orange Data Bar',\n    LightblueDataBar: 'Light blue Data Bar',\n    PurpleDataBar: 'Purple Data Bar',\n    GYRColorScale: 'Green - Yellow - Red Color Scale',\n    RYGColorScale: 'Red - Yellow - Green Color Scale',\n    GWRColorScale: 'Green - White - Red Color Scale',\n    RWGColorScale: 'Red - White - Green Color Scale',\n    BWRColorScale: 'Blue - White - Red Color Scale',\n    RWBColorScale: 'Red - White - Blue Color Scale',\n    WRColorScale: 'White - Red Color Scale',\n    RWColorScale: 'Red - White Color Scale',\n    GWColorScale: 'Green - White Color Scale',\n    WGColorScale: 'White - Green Color Scale',\n    GYColorScale: 'Green - Yellow Color Scale',\n    YGColorScale: 'Yellow - Green Color Scale',\n    ThreeArrowsColor: '3 Arrows (Colored)',\n    ThreeArrowsGray: '3 Arrows (Gray)',\n    ThreeTriangles: '3 Triangles',\n    FourArrowsColor: '4 Arrows (Gray)',\n    FourArrowsGray: '4 Arrows (Colored)',\n    FiveArrowsColor: '5 Arrows (Gray)',\n    FiveArrowsGray: '5 Arrows (Colored)',\n    ThreeTrafficLights1: '3 Traffic Lights (Unrimmed)',\n    ThreeTrafficLights2: '3 Traffic Lights (Rimmed)',\n    ThreeSigns: '3 Signs',\n    FourTrafficLights: '4 Traffic Lights',\n    RedToBlack: 'Red To Black',\n    ThreeSymbols1: '3 Symbols (Circled)',\n    ThreeSymbols2: '3 Symbols (Uncircled)',\n    ThreeFlags: '3 Flags',\n    ThreeStars: '3 Stars',\n    FourRatings: '4 Ratings',\n    FiveQuarters: '5 Quarters',\n    FiveRatings: '5 Ratings',\n    FiveBoxes: '5 Boxes',\n    Chart: 'Chart',\n    Column: 'Column',\n    Bar: 'Bar',\n    Area: 'Area',\n    Pie: 'Pie',\n    Doughnut: 'Doughnut',\n    PieAndDoughnut: 'Pie/Doughnut',\n    Line: 'Line',\n    Radar: 'Radar',\n    Scatter: 'Scatter',\n    ChartDesign: 'Chart Design',\n    ClusteredColumn: 'Clustered Column',\n    StackedColumn: 'Stacked Column',\n    StackedColumn100: '100% Stacked Column',\n    ClusteredBar: 'Clustered Bar',\n    StackedBar: 'Stacked Bar',\n    StackedBar100: '100% Stacked Bar',\n    StackedArea: 'Stacked Area',\n    StackedArea100: '100% Stacked Area',\n    StackedLine: 'Stacked Line',\n    StackedLine100: '100% Stacked Line',\n};\n","import { formatUnit, detach, attributes, isNullOrUndefined } from '@syncfusion/ej2-base';\nimport { getRangeIndexes } from './../../workbook/common/address';\nimport { getColumnWidth, isHiddenCol } from '../../workbook/base/column';\nimport { contentLoaded, editOperation, getUpdateUsingRaf, removeAllChildren } from '../common/index';\nimport { beforeContentLoaded, getColGroupWidth, virtualContentLoaded, setAriaOptions, dataBound } from '../common/index';\nimport { beforeHeaderLoaded, created, spreadsheetDestroyed, skipHiddenIdx, isReact } from '../common/index';\nimport { checkMerge, forRefSelRender, initiateEdit, chartRangeSelection, renderReactTemplates } from '../common/index';\nimport { getCell, isHiddenRow } from '../../workbook/index';\n/**\n * Sheet module is used to render Sheet\n * @hidden\n */\nvar SheetRender = /** @class */ (function () {\n    function SheetRender(parent) {\n        this.freezePane = false;\n        this.colGroupWidth = 30; //Row header and selectall table colgroup width\n        this.parent = parent;\n        this.col = parent.createElement('col');\n        this.rowRenderer = parent.serviceLocator.getService('row');\n        this.cellRenderer = parent.serviceLocator.getService('cell');\n        this.addEventListener();\n    }\n    SheetRender.prototype.refreshSelectALLContent = function () {\n        var cell;\n        if (this.freezePane) {\n            var tHead = this.getSelectAllTable().querySelector('thead');\n            var row = this.rowRenderer.render();\n            tHead.appendChild(row);\n            cell = this.parent.createElement('th', { className: 'e-select-all-cell' });\n            row.appendChild(cell);\n        }\n        else {\n            cell = this.headerPanel.firstElementChild;\n            cell.classList.add('e-select-all-cell');\n        }\n        cell.appendChild(this.parent.createElement('button', { className: 'e-selectall e-icons',\n            id: this.parent.element.id + \"_select_all\" }));\n    };\n    SheetRender.prototype.updateLeftColGroup = function (width, rowHdr) {\n        if (width) {\n            this.colGroupWidth = width;\n        }\n        if (!rowHdr) {\n            rowHdr = this.getRowHeaderPanel();\n        }\n        var table = rowHdr.querySelector('table');\n        this.detachColGroup(table);\n        var colGrp = this.parent.createElement('colgroup');\n        var colGrpWidth = this.colGroupWidth + \"px\";\n        var col = this.col.cloneNode();\n        col.style.width = colGrpWidth;\n        colGrp.appendChild(col);\n        table.insertBefore(colGrp, table.querySelector('tbody'));\n        rowHdr.style.width = colGrpWidth;\n        if (this.freezePane) {\n            table = this.getSelectAllTable();\n            this.detachColGroup(table);\n            table.insertBefore(colGrp.cloneNode(true), table.querySelector('thead'));\n        }\n        else {\n            this.getSelectAllContent().style.width = colGrpWidth;\n        }\n        if (this.parent.getActiveSheet().showHeaders) {\n            this.getColHeaderPanel().style.width = \"calc(100% - \" + colGrpWidth + \")\";\n            this.getContentPanel().style.width = \"calc(100% - \" + colGrpWidth + \")\";\n        }\n    };\n    SheetRender.prototype.detachColGroup = function (table) {\n        var colGrp = table.querySelector('colgroup');\n        if (colGrp) {\n            detach(colGrp);\n        }\n    };\n    SheetRender.prototype.renderPanel = function () {\n        this.contentPanel = this.parent.createElement('div', { className: 'e-main-panel' });\n        var sheet = this.parent.getActiveSheet();\n        var id = this.parent.element.id;\n        if (sheet.showHeaders) {\n            this.contentPanel.appendChild(this.parent.createElement('div', { className: 'e-row-header', id: id + \"_row_header\" }));\n            this.initHeaderPanel();\n            if (this.parent.allowScrolling) {\n                this.parent.scrollModule.setPadding();\n            }\n        }\n        else {\n            this.updateHideHeaders();\n        }\n        var content = this.contentPanel.appendChild(this.parent.createElement('div', { className: 'e-sheet-content', id: id + \"_main_content\" }));\n        if (!sheet.showGridLines) {\n            content.classList.add('e-hide-gridlines');\n        }\n        if (!this.parent.allowScrolling) {\n            content.style.overflow = 'hidden';\n        }\n    };\n    SheetRender.prototype.initHeaderPanel = function () {\n        var id = this.parent.element.id;\n        this.headerPanel = this.parent.createElement('div', { className: 'e-header-panel' });\n        this.headerPanel.appendChild(this.parent.createElement('div', { className: 'e-selectall-container', id: id + \"_selectall\" }));\n        this.headerPanel.appendChild(this.parent.createElement('div', { className: 'e-column-header', id: id + \"_col_header\" }));\n    };\n    SheetRender.prototype.createTable = function () {\n        if (this.parent.getActiveSheet().showHeaders) {\n            this.createHeaderTable();\n        }\n        this.updateTable('tbody', 'content', this.contentPanel.lastElementChild);\n    };\n    SheetRender.prototype.createHeaderTable = function (rowHdrEle) {\n        if (rowHdrEle === void 0) { rowHdrEle = this.contentPanel.querySelector('.e-row-header'); }\n        if (this.freezePane) {\n            this.updateTable('thead', 'selectall', this.headerPanel.querySelector('.e-selectall-container'));\n        }\n        this.updateTable('thead', 'colhdr', this.headerPanel.querySelector('.e-column-header'));\n        this.updateTable('tbody', 'rowhdr', rowHdrEle);\n        this.updateLeftColGroup(null, rowHdrEle);\n    };\n    SheetRender.prototype.updateTable = function (tagName, name, appendTo) {\n        var table = this.parent.createElement('table', { className: 'e-table', attrs: { 'role': 'grid' } });\n        table.classList.add(\"e-\" + name + \"-table\");\n        appendTo.appendChild(table);\n        table.appendChild(this.parent.createElement(tagName));\n    };\n    /**\n     * It is used to refresh the select all, row header, column header and content of the spreadsheet.\n     */\n    SheetRender.prototype.renderTable = function (args) {\n        var _this = this;\n        var indexes;\n        var row;\n        var hRow;\n        var sheet = this.parent.getActiveSheet();\n        var frag = document.createDocumentFragment();\n        this.createTable();\n        var colGrp = this.parent.createElement('colgroup');\n        var cTBody = this.contentPanel.querySelector('.e-sheet-content tbody');\n        var rHdrTBody;\n        var cHdrTHead;\n        var cHdrRow;\n        if (sheet.showHeaders) {\n            frag.appendChild(this.headerPanel);\n            this.refreshSelectALLContent();\n            rHdrTBody = this.contentPanel.querySelector('.e-row-header tbody');\n            cHdrTHead = this.headerPanel.querySelector('.e-column-header thead');\n            this.getColHeaderTable().insertBefore(colGrp, cHdrTHead);\n            cHdrRow = this.rowRenderer.render();\n            cHdrTHead.appendChild(cHdrRow);\n        }\n        frag.appendChild(this.contentPanel);\n        this.parent.notify(beforeContentLoaded, { startColIdx: args.indexes[1] });\n        var colCount = sheet.colCount.toString();\n        var rowCount = sheet.colCount.toString();\n        var layout = args.top && args.left ? 'RowColumn' : (args.top ? 'Row' : (args.left ? 'Column' : ''));\n        if (sheet.showHeaders) {\n            this.parent.getColHeaderTable().setAttribute('aria-colcount', colCount);\n            this.parent.getRowHeaderTable().setAttribute('aria-rowcount', rowCount);\n        }\n        attributes(this.parent.getContentTable(), { 'aria-rowcount': rowCount, 'aria-colcount': colCount });\n        args.cells.forEach(function (value, key) {\n            indexes = getRangeIndexes(key);\n            if (indexes[1] === args.indexes[1]) {\n                if (sheet.showHeaders) {\n                    hRow = _this.rowRenderer.render(indexes[0], true);\n                    rHdrTBody.appendChild(hRow);\n                    hRow.appendChild(_this.cellRenderer.renderRowHeader(indexes[0]));\n                }\n                row = _this.rowRenderer.render(indexes[0]);\n                cTBody.appendChild(row);\n            }\n            row.appendChild(_this.cellRenderer.render({ colIdx: indexes[1], rowIdx: indexes[0], cell: value,\n                address: key, lastCell: indexes[1] === args.indexes[3], isHeightCheckNeeded: true, row: row, hRow: hRow,\n                pRow: row.previousSibling, pHRow: sheet.showHeaders ? hRow.previousSibling : null,\n                first: layout ? (layout.includes('Row') ? (indexes[0] === args.indexes[0] ? 'Row' : (layout.includes('Column') ? (indexes[1] === args.indexes[1] ? 'Column' : '') : '')) : (indexes[1] === args.indexes[1] ? 'Column' : '')) : '' }));\n            if (indexes[0] === args.indexes[0]) {\n                _this.updateCol(sheet, indexes[1], colGrp);\n                if (sheet.showHeaders) {\n                    cHdrRow.appendChild(_this.cellRenderer.renderColHeader(indexes[1]));\n                }\n            }\n        });\n        if (this.parent[isReact]) {\n            this.parent[renderReactTemplates]();\n        }\n        cTBody.parentElement.insertBefore(colGrp.cloneNode(true), cTBody);\n        getUpdateUsingRaf(function () {\n            var content = _this.parent.getMainContent();\n            var sheetContent = document.getElementById(_this.parent.element.id + '_sheet');\n            sheetContent.appendChild(frag);\n            if (args.top) {\n                content.scrollTop = args.top;\n                if (sheet.showHeaders) {\n                    _this.parent.getRowHeaderContent().scrollTop = args.top;\n                }\n            }\n            if (args.left) {\n                content.scrollLeft = args.left;\n                if (sheet.showHeaders) {\n                    _this.parent.getColumnHeaderContent().scrollLeft = args.left;\n                }\n            }\n            _this.parent.notify(contentLoaded, null);\n            _this.parent.notify(editOperation, { action: 'renderEditor' });\n            if (!args.initLoad && !_this.parent.isOpen) {\n                _this.parent.hideSpinner();\n            }\n            setAriaOptions(_this.parent.getMainContent(), { busy: false });\n            _this.parent.trigger(dataBound, {});\n            if (_this.parent.isEdit) {\n                _this.parent.notify(initiateEdit, null);\n            }\n            if (args.initLoad) {\n                var triggerEvent = true;\n                if (_this.parent.scrollSettings.enableVirtualization) {\n                    for (var i = 0; i < sheet.ranges.length; i++) {\n                        if (sheet.ranges[i].info.count - 1 > _this.parent.viewport.bottomIndex) {\n                            triggerEvent = false;\n                            break;\n                        }\n                    }\n                }\n                if (triggerEvent) {\n                    _this.triggerCreatedEvent();\n                }\n            }\n        });\n    };\n    SheetRender.prototype.triggerCreatedEvent = function () {\n        if (!this.parent.isOpen) {\n            this.parent.hideSpinner();\n        }\n        if (this.parent.createdHandler) {\n            if (this.parent.createdHandler.observers) {\n                this.parent[created].observers = this.parent.createdHandler.observers;\n            }\n            else {\n                this.parent.setProperties({ created: this.parent.createdHandler }, true);\n            }\n            this.parent.createdHandler = undefined;\n            this.parent.trigger(created, null);\n        }\n    };\n    SheetRender.prototype.refreshColumnContent = function (args) {\n        var _this = this;\n        var indexes;\n        var row;\n        var table;\n        var count = 0;\n        var cell;\n        var sheet = this.parent.getActiveSheet();\n        var frag = document.createDocumentFragment();\n        var hFrag = document.createDocumentFragment();\n        var tBody = this.parent.element.querySelector('.e-sheet-content tbody');\n        tBody = frag.appendChild(tBody.cloneNode(true));\n        var colGrp = this.parent.element.querySelector('.e-sheet-content colgroup');\n        colGrp = colGrp.cloneNode();\n        var hRow;\n        var tHead;\n        if (sheet.showHeaders) {\n            hFrag.appendChild(colGrp);\n            tHead = this.parent.element.querySelector('.e-column-header thead');\n            tHead = hFrag.appendChild(tHead.cloneNode(true));\n            hRow = tHead.querySelector('tr');\n            hRow.innerHTML = '';\n        }\n        args.cells.forEach(function (value, key) {\n            indexes = getRangeIndexes(key);\n            if (indexes[0] === args.indexes[0]) {\n                _this.updateCol(sheet, indexes[1], colGrp);\n                if (sheet.showHeaders) {\n                    hRow.appendChild(_this.cellRenderer.renderColHeader(indexes[1]));\n                }\n            }\n            if (indexes[1] === args.indexes[1]) {\n                row = tBody.children[count];\n                if (row) {\n                    row.innerHTML = '';\n                    count++;\n                }\n                else {\n                    return;\n                }\n            }\n            cell = row.appendChild(_this.cellRenderer.render({\n                colIdx: indexes[1], rowIdx: indexes[0], cell: value, address: key, row: row, pRow: row.previousSibling,\n                first: !args.skipUpdateOnFirst && indexes[1] === args.indexes[1] ? 'Column' : (_this.parent.scrollSettings.\n                    enableVirtualization && indexes[0] === args.indexes[0] && _this.parent.viewport.topIndex !== skipHiddenIdx(sheet, 0, true)\n                    ? 'Row' : '')\n            }));\n            _this.checkColMerge(indexes, args.indexes, cell, value);\n        });\n        frag.insertBefore(colGrp.cloneNode(true), tBody);\n        getUpdateUsingRaf(function () {\n            if (sheet.showHeaders) {\n                table = _this.getColHeaderTable();\n                removeAllChildren(table);\n                table.appendChild(hFrag);\n            }\n            table = _this.getContentTable();\n            removeAllChildren(table);\n            table.appendChild(frag);\n            _this.parent.notify(virtualContentLoaded, { refresh: 'Column' });\n            if (_this.parent.isEdit) {\n                _this.parent.notify(forRefSelRender, {});\n            }\n            if (_this.parent.allowChart) {\n                _this.parent.notify(chartRangeSelection, null);\n            }\n            if (!_this.parent.isOpen) {\n                _this.parent.hideSpinner();\n            }\n            setAriaOptions(_this.parent.getMainContent(), { busy: false });\n        });\n    };\n    SheetRender.prototype.refreshRowContent = function (args) {\n        var _this = this;\n        var indexes;\n        var row;\n        var hdrRow;\n        var colGroupWidth = this.colGroupWidth;\n        var sheet = this.parent.getActiveSheet();\n        var hFrag;\n        var hTBody;\n        var cell;\n        var frag = document.createDocumentFragment();\n        var tBody = this.parent.createElement('tbody');\n        if (sheet.showHeaders) {\n            hFrag = document.createDocumentFragment();\n            hTBody = tBody.cloneNode();\n            hFrag.appendChild(hTBody);\n        }\n        frag.appendChild(tBody);\n        args.cells.forEach(function (value, key) {\n            indexes = getRangeIndexes(key);\n            if (indexes[1] === args.indexes[1]) {\n                if (sheet.showHeaders) {\n                    hdrRow = _this.rowRenderer.render(indexes[0], true);\n                    hTBody.appendChild(hdrRow);\n                    hdrRow.appendChild(_this.cellRenderer.renderRowHeader(indexes[0]));\n                    colGroupWidth = getColGroupWidth(indexes[0] + 1);\n                }\n                row = _this.rowRenderer.render(indexes[0]);\n                tBody.appendChild(row);\n            }\n            cell = row.appendChild(_this.cellRenderer.render({ rowIdx: indexes[0], colIdx: indexes[1], cell: value, address: key, lastCell: indexes[1] === args.indexes[3], row: row, hRow: hdrRow, pRow: row.previousSibling, pHRow: sheet.showHeaders ?\n                    hdrRow.previousSibling : null, isHeightCheckNeeded: true, first: !args.skipUpdateOnFirst && indexes[0] === args.indexes[0] ?\n                    'Row' : (_this.parent.scrollSettings.enableVirtualization && indexes[1] === args.indexes[1] && _this.parent.viewport.leftIndex\n                    !== skipHiddenIdx(sheet, 0, true, 'columns') ? 'Column' : '') }));\n            _this.checkRowMerge(indexes, args.indexes, cell, value);\n        });\n        if (this.colGroupWidth !== colGroupWidth) {\n            this.updateLeftColGroup(colGroupWidth);\n        }\n        if (sheet.showHeaders) {\n            if (this.contentPanel.querySelector('.e-row-header tbody')) {\n                detach(this.contentPanel.querySelector('.e-row-header tbody'));\n                this.getRowHeaderTable().appendChild(hFrag);\n            }\n        }\n        if (this.contentPanel.querySelector('.e-sheet-content tbody')) {\n            detach(this.contentPanel.querySelector('.e-sheet-content tbody'));\n            this.getContentTable().appendChild(frag);\n        }\n        this.parent.notify(virtualContentLoaded, { refresh: 'Row' });\n        if (this.parent.allowChart) {\n            this.parent.notify(chartRangeSelection, {});\n        }\n        if (this.parent.isEdit) {\n            this.parent.notify(forRefSelRender, null);\n        }\n        if (!this.parent.isOpen) {\n            this.parent.hideSpinner();\n        }\n        setAriaOptions(this.parent.getMainContent(), { busy: false });\n    };\n    SheetRender.prototype.updateCol = function (sheet, idx, appendTo) {\n        var col = this.col.cloneNode();\n        col.style.width = formatUnit(getColumnWidth(sheet, idx));\n        return appendTo ? appendTo.appendChild(col) : col;\n    };\n    SheetRender.prototype.updateColContent = function (args) {\n        var _this = this;\n        getUpdateUsingRaf(function () {\n            var indexes;\n            var row;\n            var table;\n            var refChild;\n            var cell;\n            var hRow;\n            var rowCount = 0;\n            var col;\n            var hRefChild;\n            var sheet = _this.parent.getActiveSheet();\n            if (sheet.showHeaders) {\n                hRow = _this.parent.element.querySelector('.e-column-header .e-header-row');\n                hRefChild = hRow.firstElementChild;\n            }\n            var colGrp = _this.parent.element.querySelector('.e-sheet-content colgroup');\n            var colRefChild = colGrp.firstElementChild;\n            var skipRender;\n            var tBody = _this.parent.element.querySelector('.e-sheet-content tbody');\n            args.cells.forEach(function (value, key) {\n                if (skipRender) {\n                    return;\n                }\n                indexes = getRangeIndexes(key);\n                if (args.direction === 'first' && indexes[1] === args.indexes[1]) {\n                    _this.checkColMerge([indexes[0], _this.parent.viewport.leftIndex], args.indexes, (tBody.rows[rowCount] || { cells: [] }).cells[(args.indexes[3] - args.indexes[1]) + 1], getCell(indexes[0], _this.parent.viewport.leftIndex, sheet) || {});\n                }\n                if (indexes[0] === args.indexes[0]) {\n                    if (args.direction === 'last') {\n                        col = _this.col.cloneNode();\n                        col.style.width = formatUnit(getColumnWidth(sheet, indexes[1]));\n                        colGrp.insertBefore(col, colRefChild);\n                        if (sheet.showHeaders) {\n                            hRow.insertBefore(_this.cellRenderer.renderColHeader(indexes[1]), hRefChild);\n                        }\n                    }\n                    else {\n                        _this.updateCol(sheet, indexes[1], colGrp);\n                        if (sheet.showHeaders) {\n                            hRow.appendChild(_this.cellRenderer.renderColHeader(indexes[1]));\n                        }\n                    }\n                    if (_this.parent.scrollSettings.enableVirtualization && args.direction) {\n                        // tslint:disable\n                        detach(colGrp[args.direction + 'ElementChild']);\n                        if (sheet.showHeaders) {\n                            detach(hRow[args.direction + 'ElementChild']);\n                        }\n                        // tslint:enable\n                    }\n                }\n                if (indexes[1] === args.indexes[1]) {\n                    row = tBody.children[rowCount];\n                    rowCount++;\n                    if (!row) {\n                        skipRender = true;\n                        return;\n                    }\n                    refChild = row.firstElementChild;\n                }\n                cell = _this.cellRenderer.render({ colIdx: indexes[1], rowIdx: indexes[0], cell: value, address: key,\n                    lastCell: indexes[1] === args.indexes[3], isHeightCheckNeeded: args.direction === 'first',\n                    first: args.direction === 'last' && !args.skipUpdateOnFirst && indexes[1] === args.indexes[1] ? 'Column' : '',\n                    checkNextBorder: args.direction === 'last' && indexes[3] === args.indexes[3] ? 'Column' : '', });\n                if (args.direction === 'last') {\n                    _this.checkColMerge(indexes, args.indexes, cell, value, (tBody.rows[rowCount - 1] || { cells: [] }).cells[0]);\n                    row.insertBefore(cell, refChild);\n                }\n                else {\n                    row.appendChild(cell);\n                }\n                if (_this.parent.scrollSettings.enableVirtualization && args.direction) {\n                    // tslint:disable-next-line:no-any\n                    detach(row[args.direction + 'ElementChild']);\n                }\n            });\n            if (sheet.showHeaders) {\n                table = _this.getColHeaderTable();\n                detach(table.querySelector('colgroup'));\n                table.insertBefore(colGrp.cloneNode(true), table.querySelector('thead'));\n            }\n            if (_this.parent.scrollSettings.enableVirtualization) {\n                _this.parent.notify(virtualContentLoaded, { refresh: 'Column' });\n            }\n            if (_this.parent.allowChart) {\n                _this.parent.notify(chartRangeSelection, null);\n            }\n            if (_this.parent.isEdit) {\n                _this.parent.notify(forRefSelRender, {});\n            }\n            if (!_this.parent.isOpen) {\n                _this.parent.hideSpinner();\n            }\n            setAriaOptions(_this.parent.getMainContent(), { busy: false });\n        });\n    };\n    SheetRender.prototype.updateRowContent = function (args) {\n        var _this = this;\n        var colGroupWidth = this.colGroupWidth;\n        var row;\n        var hRow;\n        var cell;\n        var sheet = this.parent.getActiveSheet();\n        var cellModel;\n        var count = 0;\n        var tBody = this.parent.getMainContent().querySelector('tbody');\n        var rTBody;\n        var rFrag;\n        var index;\n        if (sheet.showHeaders) {\n            rFrag = document.createDocumentFragment();\n            rTBody = this.parent.getRowHeaderContent().querySelector('tbody');\n        }\n        var indexes;\n        var frag = document.createDocumentFragment();\n        this.parent.showSpinner();\n        args.cells.forEach(function (value, cKey) {\n            indexes = getRangeIndexes(cKey);\n            if (args.direction === 'first' && indexes[0] === args.indexes[0]) {\n                _this.checkRowMerge([_this.parent.viewport.topIndex, indexes[1]], args.indexes, (tBody.rows[(args.indexes[2] - args.indexes[0]) + 1] || { cells: [] }).cells[count], getCell(_this.parent.viewport.topIndex, indexes[1], sheet) || {});\n            }\n            if (indexes[1] === args.indexes[1]) {\n                if (sheet.showHeaders) {\n                    hRow = _this.rowRenderer.render(indexes[0], true);\n                    rFrag.appendChild(hRow);\n                    hRow.appendChild(_this.cellRenderer.renderRowHeader(indexes[0]));\n                    colGroupWidth = getColGroupWidth(indexes[0] + 1);\n                    if (_this.parent.scrollSettings.enableVirtualization && args.direction) {\n                        // tslint:disable-next-line:no-any\n                        detach(rTBody[args.direction + 'ElementChild']);\n                    }\n                }\n                row = _this.rowRenderer.render(indexes[0]);\n                frag.appendChild(row);\n                if (_this.parent.scrollSettings.enableVirtualization && args.direction) {\n                    // tslint:disable-next-line:no-any\n                    detach(tBody[args.direction + 'ElementChild']);\n                }\n            }\n            cell = row.appendChild(_this.cellRenderer.render({ colIdx: indexes[1], rowIdx: indexes[2], cell: value, address: cKey, lastCell: indexes[1] === args.indexes[3], row: row, pHRow: sheet.showHeaders ? hRow.previousSibling : null,\n                checkNextBorder: args.direction === 'last' && indexes[2] === args.indexes[2] ? 'Row' : '', pRow: row.previousSibling,\n                isHeightCheckNeeded: args.direction === 'first' || args.direction === '', hRow: hRow, first: args.direction === 'last' &&\n                    !args.skipUpdateOnFirst && indexes[0] === args.indexes[0] ? 'Row' : '' }));\n            if (args.direction === 'last') {\n                _this.checkRowMerge(indexes, args.indexes, cell, value, tBody.rows[0].cells[count]);\n            }\n            count++;\n        });\n        if (this.colGroupWidth !== colGroupWidth) {\n            this.updateLeftColGroup(colGroupWidth);\n        }\n        if (args.direction === 'last') {\n            if (sheet.showHeaders) {\n                rTBody.insertBefore(rFrag, rTBody.firstElementChild);\n            }\n            tBody.insertBefore(frag, tBody.firstElementChild);\n        }\n        else {\n            if (sheet.showHeaders) {\n                rTBody.appendChild(rFrag);\n            }\n            tBody.appendChild(frag);\n        }\n        if (this.parent.scrollSettings.enableVirtualization) {\n            this.parent.notify(virtualContentLoaded, { refresh: 'Row' });\n        }\n        if (this.parent.isEdit) {\n            this.parent.notify(forRefSelRender, null);\n        }\n        if (this.parent.allowChart) {\n            this.parent.notify(chartRangeSelection, {});\n        }\n        if (!this.parent.isOpen) {\n            this.parent.hideSpinner();\n        }\n        setAriaOptions(this.parent.getMainContent(), { busy: false });\n    };\n    SheetRender.prototype.checkRowMerge = function (indexes, range, cell, model, firstcell) {\n        if (this.parent.scrollSettings.enableVirtualization && cell &&\n            (!isNullOrUndefined(model.rowSpan) || !isNullOrUndefined(model.colSpan))) {\n            if (indexes[0] === this.parent.viewport.topIndex) {\n                if (model.rowSpan < 0) {\n                    this.parent.notify(checkMerge, { td: cell, rowIdx: indexes[0], colIdx: indexes[1], isRow: true });\n                    if (this.parent.viewport.topIndex >= range[0]) {\n                        this.refreshPrevMerge(range[0] + 1, indexes[1]);\n                    }\n                }\n                if (firstcell && (firstcell.colSpan || firstcell.rowSpan)) {\n                    this.cellRenderer.refresh(indexes[0] + (range[2] - range[0]) + 1, indexes[1], null, firstcell);\n                }\n            }\n            else if (model.rowSpan > 1) {\n                var prevTopIdx = range[2] + 1;\n                if (indexes[0] + model.rowSpan - 1 > prevTopIdx && indexes[0] < prevTopIdx) {\n                    this.refreshPrevMerge(prevTopIdx, indexes[1], this.parent.viewport.topIndex);\n                }\n            }\n        }\n    };\n    SheetRender.prototype.refreshPrevMerge = function (prevTopIdx, colIndex, currTopIdx) {\n        var td = this.parent.getCell(prevTopIdx, colIndex, this.parent.getRow(currTopIdx ? currTopIdx : 0));\n        if (td && td.rowSpan > 1) {\n            this.cellRenderer.refresh(prevTopIdx, colIndex, null, td);\n        }\n    };\n    SheetRender.prototype.checkColMerge = function (indexes, range, cell, model, firstcell) {\n        if (this.parent.scrollSettings.enableVirtualization && cell && indexes[1] === this.parent.viewport.leftIndex &&\n            (!isNullOrUndefined(model.rowSpan) || !isNullOrUndefined(model.colSpan))) {\n            if (model.colSpan < 0) {\n                this.parent.notify(checkMerge, { td: cell, colIdx: indexes[1], rowIdx: indexes[0] });\n            }\n            if (firstcell && (firstcell.colSpan || firstcell.rowSpan)) {\n                this.cellRenderer.refresh(indexes[0], indexes[1] + (range[3] - range[1]) + 1, null, firstcell);\n            }\n        }\n    };\n    /**\n     * Used to toggle row and column headers.\n     */\n    SheetRender.prototype.showHideHeaders = function () {\n        var _this = this;\n        var sheet = this.parent.getActiveSheet();\n        if (sheet.showHeaders) {\n            if (this.parent.scrollSettings.enableVirtualization) {\n                var indexes = [this.parent.viewport.topIndex, this.parent.viewport.leftIndex,\n                    this.parent.viewport.bottomIndex, this.parent.viewport.rightIndex];\n                this.renderHeaders([indexes[0], indexes[2]], [indexes[1], indexes[3]]);\n            }\n            else {\n                this.renderHeaders([0, sheet.rowCount - 1], [0, sheet.colCount - 1]);\n                if (sheet.topLeftCell !== 'A1') {\n                    this.parent.goTo(sheet.topLeftCell);\n                }\n            }\n        }\n        else {\n            getUpdateUsingRaf(function () {\n                detach(_this.headerPanel);\n                detach(_this.getRowHeaderPanel());\n                _this.getContentPanel().style.width = '';\n                _this.updateHideHeaders();\n            });\n        }\n    };\n    SheetRender.prototype.renderHeaders = function (rowIndexes, colIndexes) {\n        var _this = this;\n        var sheet = this.parent.getActiveSheet();\n        this.initHeaderPanel();\n        var cFrag = document.createDocumentFragment();\n        var rFrag = document.createDocumentFragment();\n        cFrag.appendChild(this.headerPanel);\n        var rowHdrEle = rFrag.appendChild(this.parent.createElement('div', { className: 'e-row-header', id: this.parent.element.id + \"_row_header\" }));\n        this.createHeaderTable(rowHdrEle);\n        this.parent.notify(beforeHeaderLoaded, { element: rowHdrEle });\n        this.refreshSelectALLContent();\n        var rTBody = rowHdrEle.querySelector('tbody');\n        var cTHead = this.headerPanel.querySelector('.e-column-header thead');\n        var cRow = this.rowRenderer.render();\n        cTHead.appendChild(cRow);\n        var row;\n        for (var i = colIndexes[0]; i <= colIndexes[1]; i++) {\n            if (!isHiddenCol(sheet, i)) {\n                cRow.appendChild(this.cellRenderer.renderColHeader(i));\n            }\n        }\n        var colGroupWidth = getColGroupWidth(rowIndexes[1]);\n        if (this.colGroupWidth !== colGroupWidth) {\n            this.updateLeftColGroup(colGroupWidth, rowHdrEle);\n        }\n        for (var i = rowIndexes[0]; i <= rowIndexes[1]; i++) {\n            if (!isHiddenRow(sheet, i)) {\n                row = this.rowRenderer.render(i, true);\n                row.appendChild(this.cellRenderer.renderRowHeader(i));\n                rTBody.appendChild(row);\n            }\n        }\n        getUpdateUsingRaf(function () {\n            _this.getColHeaderTable().insertBefore(_this.getContentTable().querySelector('colgroup').cloneNode(true), cTHead);\n            var sheet = document.getElementById(_this.parent.element.id + '_sheet');\n            sheet.classList.remove('e-hide-headers');\n            sheet.insertBefore(cFrag, _this.contentPanel);\n            var content = _this.getContentPanel();\n            _this.contentPanel.insertBefore(rFrag, content);\n            _this.parent.scrollModule.setPadding();\n            rowHdrEle.scrollTop = content.scrollTop;\n            _this.getColHeaderPanel().scrollLeft = content.scrollLeft;\n        });\n    };\n    SheetRender.prototype.updateHideHeaders = function () {\n        document.getElementById(this.parent.element.id + '_sheet').classList.add('e-hide-headers');\n        this.headerPanel = null;\n    };\n    /**\n     * Get the select all table element of spreadsheet\n     * @return {HTMLElement}\n     */\n    SheetRender.prototype.getSelectAllContent = function () {\n        return this.headerPanel.getElementsByClassName('e-selectall-container')[0];\n    };\n    /**\n     * Get the select all table element of spreadsheet\n     * @return {Element}\n     */\n    SheetRender.prototype.getSelectAllTable = function () {\n        return this.headerPanel.getElementsByClassName('e-selectall-table')[0];\n    };\n    /**\n     * Get the column header element of spreadsheet\n     * @return {HTMLTableElement}\n     */\n    SheetRender.prototype.getColHeaderTable = function () {\n        return this.headerPanel.getElementsByClassName('e-colhdr-table')[0];\n    };\n    /**\n     * Get the row header table element of spreadsheet\n     * @return {HTMLTableElement}\n     */\n    SheetRender.prototype.getRowHeaderTable = function () {\n        return this.contentPanel.getElementsByClassName('e-rowhdr-table')[0];\n    };\n    /**\n     * Get the main content table element of spreadsheet\n     * @return {Element}\n     */\n    SheetRender.prototype.getContentTable = function () {\n        return this.contentPanel.getElementsByClassName('e-content-table')[0];\n    };\n    /**\n     * Get the row header div element of spreadsheet\n     * @return {Element}\n     */\n    SheetRender.prototype.getRowHeaderPanel = function () {\n        return this.contentPanel.getElementsByClassName('e-row-header')[0];\n    };\n    /**\n     * Get the column header div element of spreadsheet\n     * @return {Element}\n     */\n    SheetRender.prototype.getColHeaderPanel = function () {\n        return this.headerPanel.getElementsByClassName('e-column-header')[0];\n    };\n    /**\n     * Get the main content div element of spreadsheet\n     * @return {Element}\n     */\n    SheetRender.prototype.getContentPanel = function () {\n        return this.contentPanel.getElementsByClassName('e-sheet-content')[0];\n    };\n    SheetRender.prototype.addEventListener = function () {\n        this.parent.on(created, this.triggerCreatedEvent, this);\n        this.parent.on(spreadsheetDestroyed, this.destroy, this);\n    };\n    SheetRender.prototype.destroy = function () {\n        this.removeEventListener();\n        this.parent = null;\n    };\n    SheetRender.prototype.removeEventListener = function () {\n        this.parent.off(created, this.triggerCreatedEvent);\n        this.parent.off(spreadsheetDestroyed, this.destroy);\n    };\n    return SheetRender;\n}());\nexport { SheetRender };\n","import { skipHiddenIdx } from '../common/index';\nimport { getRowHeight, getCell, isHiddenRow } from '../../workbook/base/index';\nimport { attributes } from '@syncfusion/ej2-base';\nimport { getCellAddress } from '../../workbook/common/index';\n/**\n * Sheet module is used for creating row element\n * @hidden\n */\nvar RowRenderer = /** @class */ (function () {\n    function RowRenderer(parent) {\n        this.parent = parent;\n        this.element = this.parent.createElement('tr', { attrs: { 'role': 'row' } });\n        this.cellRenderer = parent.serviceLocator.getService('cell');\n    }\n    RowRenderer.prototype.render = function (index, isRowHeader, skipHidden) {\n        var row = this.element.cloneNode();\n        if (index === undefined) {\n            row.classList.add('e-header-row');\n            return row;\n        }\n        row.classList.add('e-row');\n        var sheet = this.parent.getActiveSheet();\n        attributes(row, { 'aria-rowindex': (index + 1).toString() });\n        row.style.height = getRowHeight(sheet, index) + \"px\";\n        if (isRowHeader && !skipHidden) {\n            if (isHiddenRow(sheet, index + 1) && !isHiddenRow(sheet, index - 1)) {\n                row.classList.add('e-hide-start');\n            }\n            if (index !== 0 && isHiddenRow(sheet, index - 1) && !isHiddenRow(sheet, index + 1)) {\n                row.classList.add('e-hide-end');\n            }\n        }\n        return row;\n    };\n    RowRenderer.prototype.refresh = function (index, pRow, hRow, header) {\n        var row;\n        var sheet = this.parent.getActiveSheet();\n        if (header) {\n            row = this.render(index, true, true);\n            row.appendChild(this.cellRenderer.renderRowHeader(index));\n        }\n        else {\n            row = this.render(index);\n            var len = this.parent.viewport.leftIndex + this.parent.viewport.colCount + (this.parent.getThreshold('col') * 2);\n            for (var i = this.parent.viewport.leftIndex; i <= len; i++) {\n                row.appendChild(this.cellRenderer.render({ colIdx: i, rowIdx: index, cell: getCell(index, i, sheet),\n                    address: getCellAddress(index, i), lastCell: i === len, row: row, hRow: hRow, isHeightCheckNeeded: true, pRow: pRow,\n                    first: index === this.parent.viewport.topIndex && skipHiddenIdx(sheet, index, true) !== skipHiddenIdx(sheet, 0, true) ?\n                        'Row' : '' }));\n            }\n        }\n        return row;\n    };\n    return RowRenderer;\n}());\nexport { RowRenderer };\n","import { inView, renderFilterCell, checkConditionalFormat } from '../common/index';\nimport { hasTemplate, createHyperlinkElement, checkPrevMerge, createImageElement } from '../common/index';\nimport { getColumnHeaderText, getRangeIndexes, getRangeAddress } from '../../workbook/common/index';\nimport { setChart, refreshChart, getCellAddress } from '../../workbook/common/index';\nimport { getCell, skipDefaultValue, isHiddenRow, isHiddenCol } from '../../workbook/base/index';\nimport { getRowHeight, setRowHeight } from '../../workbook/base/index';\nimport { addClass, attributes, getNumberDependable, extend, compile, isNullOrUndefined } from '@syncfusion/ej2-base';\nimport { getFormattedCellObject, applyCellFormat, workbookFormulaOperation, wrapEvent, cFRender } from '../../workbook/common/event';\nimport { getTypeFromFormat } from '../../workbook/index';\nimport { checkIsFormula } from '../../workbook/common/util';\n/**\n * CellRenderer class which responsible for building cell content.\n * @hidden\n */\nvar CellRenderer = /** @class */ (function () {\n    function CellRenderer(parent) {\n        this.parent = parent;\n        this.element = this.parent.createElement('td');\n        this.th = this.parent.createElement('th', { className: 'e-header-cell' });\n        this.tableRow = parent.createElement('tr', { className: 'e-row' });\n        this.parent.on('updateView', this.updateView, this);\n    }\n    CellRenderer.prototype.renderColHeader = function (index) {\n        var headerCell = this.th.cloneNode();\n        attributes(headerCell, { 'role': 'columnheader', 'aria-colindex': (index + 1).toString(), 'tabindex': '-1' });\n        headerCell.innerHTML = getColumnHeaderText(index + 1);\n        var sheet = this.parent.getActiveSheet();\n        if (isHiddenCol(sheet, index + 1)) {\n            headerCell.classList.add('e-hide-start');\n        }\n        if (index !== 0 && isHiddenCol(sheet, index - 1)) {\n            headerCell.classList.add('e-hide-end');\n        }\n        return headerCell;\n    };\n    CellRenderer.prototype.renderRowHeader = function (index) {\n        var headerCell = this.element.cloneNode();\n        addClass([headerCell], 'e-header-cell');\n        attributes(headerCell, { 'role': 'rowheader', 'tabindex': '-1' });\n        headerCell.innerHTML = (index + 1).toString();\n        return headerCell;\n    };\n    CellRenderer.prototype.render = function (args) {\n        args.td = this.element.cloneNode();\n        args.td.className = 'e-cell';\n        attributes(args.td, { 'role': 'gridcell', 'aria-colindex': (args.colIdx + 1).toString(), 'tabindex': '-1' });\n        var sheet = this.parent.getActiveSheet();\n        if (this.checkMerged(args)) {\n            return args.td;\n        }\n        var compiledTemplate = this.processTemplates(args.cell, args.rowIdx, args.colIdx);\n        if (typeof compiledTemplate === 'string') {\n            args.td.innerHTML = compiledTemplate;\n        }\n        else {\n            args.td.appendChild(compiledTemplate);\n        }\n        args.isRefresh = false;\n        this.update(args);\n        if (args.cell && args.td) {\n            this.parent.notify(cFRender, { rowIdx: args.rowIdx, colIdx: args.colIdx, cell: args.cell, td: args.td, isChecked: false });\n            if (args.td && args.td.children[0] && args.td.children[0].className === 'e-cf-databar') {\n                if (args.cell.style && args.cell.style.fontSize) {\n                    args.td.children[0].querySelector('.e-databar-value').style.fontSize = args.cell.style.fontSize;\n                }\n                args.td.children[0].style.height = '100%';\n                args.td.children[0].firstElementChild.nextElementSibling.style.height = '100%';\n            }\n        }\n        if (!hasTemplate(this.parent, args.rowIdx, args.colIdx, this.parent.activeSheetIndex)) {\n            this.parent.notify(renderFilterCell, { td: args.td, rowIndex: args.rowIdx, colIndex: args.colIdx });\n        }\n        var evtArgs = { cell: args.cell, element: args.td, address: args.address };\n        this.parent.trigger('beforeCellRender', evtArgs);\n        this.updateRowHeight({\n            rowIdx: args.rowIdx,\n            cell: evtArgs.element,\n            lastCell: args.lastCell,\n            rowHgt: 20,\n            row: args.row,\n            hRow: args.hRow\n        });\n        var isWrap = args.td.classList.contains('e-wraptext');\n        var cellValue = args.td.innerHTML;\n        if (cellValue.indexOf('\\n') > -1 && !isWrap) {\n            var splitVal = cellValue.split('\\n');\n            if (splitVal.length > 1) {\n                this.parent.notify(wrapEvent, {\n                    range: [args.rowIdx, args.colIdx, args.rowIdx, args.colIdx], wrap: true, initial: true, sheet: this.parent.getActiveSheet(), td: args.td, row: args.row, hRow: args.hRow\n                });\n            }\n        }\n        return evtArgs.element;\n    };\n    // tslint:disable-next-line:max-func-body-length\n    CellRenderer.prototype.update = function (args) {\n        if (args.isRefresh) {\n            if (args.td.rowSpan) {\n                args.td.removeAttribute('rowSpan');\n            }\n            if (args.td.colSpan) {\n                args.td.removeAttribute('colSpan');\n            }\n            if (this.checkMerged(args)) {\n                return;\n            }\n        }\n        if (args.cell && args.cell.formula && !args.cell.value) {\n            var isFormula = checkIsFormula(args.cell.formula);\n            var eventArgs = {\n                action: 'refreshCalculate', value: args.cell.formula, rowIndex: args.rowIdx, colIndex: args.colIdx, isFormula: isFormula\n            };\n            this.parent.notify(workbookFormulaOperation, eventArgs);\n            args.cell.value = getCell(args.rowIdx, args.colIdx, this.parent.getActiveSheet()).value;\n        }\n        var formatArgs = {\n            type: args.cell && getTypeFromFormat(args.cell.format),\n            value: args.cell && args.cell.value, format: args.cell && args.cell.format ? args.cell.format : 'General',\n            formattedText: args.cell && args.cell.value, onLoad: true, isRightAlign: false, cell: args.cell,\n            rowIdx: args.rowIdx.toString(), colIdx: args.colIdx.toString()\n        };\n        if (args.cell) {\n            this.parent.notify(getFormattedCellObject, formatArgs);\n        }\n        if (!isNullOrUndefined(args.td)) {\n            this.parent.refreshNode(args.td, { type: formatArgs.type, result: formatArgs.formattedText,\n                curSymbol: getNumberDependable(this.parent.locale, 'USD'), isRightAlign: formatArgs.isRightAlign,\n                value: formatArgs.value || ''\n            });\n        }\n        var style = {};\n        if (args.cell) {\n            if (args.cell.style) {\n                if (args.cell.style.properties) {\n                    style = skipDefaultValue(args.cell.style, true);\n                }\n                else {\n                    style = args.cell.style;\n                }\n            }\n            if (args.cell.chart && args.cell.chart.length > 0) {\n                this.parent.notify(setChart, { chart: args.cell.chart, isInitCell: true, range: getCellAddress(args.rowIdx, args.colIdx) });\n            }\n            if (args.cell.hyperlink) {\n                this.parent.notify(createHyperlinkElement, { cell: args.cell, td: args.td, rowIdx: args.rowIdx, colIdx: args.colIdx });\n            }\n            if (args.cell.wrap) {\n                this.parent.notify(wrapEvent, {\n                    range: [args.rowIdx, args.colIdx, args.rowIdx, args.colIdx], wrap: true, sheet: this.parent.getActiveSheet(), initial: true, td: args.td, row: args.row, hRow: args.hRow\n                });\n            }\n            if (args.cell.rowSpan > 1) {\n                var rowSpan = args.cell.rowSpan - this.parent.hiddenCount(args.rowIdx, args.rowIdx + (args.cell.rowSpan - 1));\n                if (rowSpan > 1) {\n                    args.td.rowSpan = rowSpan;\n                }\n            }\n            if (args.cell.colSpan > 1) {\n                var colSpan = args.cell.colSpan -\n                    this.parent.hiddenCount(args.colIdx, args.colIdx + (args.cell.colSpan - 1), 'columns');\n                if (colSpan > 1) {\n                    args.td.colSpan = colSpan;\n                }\n            }\n            if (args.cell.image) {\n                for (var i = 0; i < args.cell.image.length; i++) {\n                    this.parent.notify(createImageElement, {\n                        options: {\n                            src: args.cell.image[i].src, imageId: args.cell.image[i].id,\n                            height: args.cell.image[i].height, width: args.cell.image[i].width,\n                            top: args.cell.image[i].top, left: args.cell.image[i].left\n                        },\n                        range: getRangeAddress([args.rowIdx, args.colIdx, args.rowIdx, args.colIdx]), isPublic: false\n                    });\n                }\n            }\n        }\n        if (args.isRefresh) {\n            this.removeStyle(args.td, args.rowIdx, args.colIdx);\n        }\n        if (this.parent.allowConditionalFormat && args.lastCell) {\n            this.parent.notify(checkConditionalFormat, { rowIdx: args.rowIdx, colIdx: args.colIdx, cell: args.cell });\n        }\n        if (this.parent.allowChart && args.lastCell) {\n            this.parent.notify(refreshChart, {\n                cell: args.cell, rIdx: args.rowIdx, cIdx: args.colIdx, sheetIdx: this.parent.activeSheetIndex\n            });\n        }\n        if (Object.keys(style).length || Object.keys(this.parent.commonCellStyle).length || args.lastCell) {\n            this.parent.notify(applyCellFormat, {\n                style: extend({}, this.parent.commonCellStyle, style), rowIdx: args.rowIdx, colIdx: args.colIdx, cell: args.td,\n                first: args.first, row: args.row, lastCell: args.lastCell, hRow: args.hRow, pRow: args.pRow, isHeightCheckNeeded: args.isHeightCheckNeeded, manualUpdate: args.manualUpdate\n            });\n        }\n        if (args.checkNextBorder === 'Row') {\n            var borderTop = this.parent.getCellStyleValue(['borderTop'], [Number(this.parent.getContentTable().rows[0].getAttribute('aria-rowindex')) - 1, args.colIdx]).borderTop;\n            if (borderTop !== '' && (!args.cell || !args.cell.style || !args.cell.style.bottomPriority)) {\n                this.parent.notify(applyCellFormat, { style: { borderBottom: borderTop }, rowIdx: args.rowIdx,\n                    colIdx: args.colIdx, cell: args.td });\n            }\n        }\n        if (args.checkNextBorder === 'Column') {\n            var borderLeft = this.parent.getCellStyleValue(['borderLeft'], [args.rowIdx, args.colIdx + 1]).borderLeft;\n            if (borderLeft !== '' && (!args.cell || !args.cell.style || (!args.cell.style.borderRight && !args.cell.style.border))) {\n                this.parent.notify(applyCellFormat, { style: { borderRight: borderLeft }, rowIdx: args.rowIdx, colIdx: args.colIdx,\n                    cell: args.td });\n            }\n        }\n        if (args.cell && args.cell.hyperlink && !hasTemplate(this.parent, args.rowIdx, args.colIdx, this.parent.activeSheetIndex)) {\n            var address = void 0;\n            if (typeof (args.cell.hyperlink) === 'string') {\n                address = args.cell.hyperlink;\n                if (address.indexOf('http://') !== 0 && address.indexOf('https://') !== 0 && address.indexOf('ftp://') !== 0) {\n                    args.cell.hyperlink = address.toLowerCase().indexOf('www.') === 0 ? 'http://' + address : address;\n                }\n            }\n            else {\n                address = args.cell.hyperlink.address;\n                if (address.indexOf('http://') !== 0 && address.indexOf('https://') !== 0 && address.indexOf('ftp://') !== 0) {\n                    args.cell.hyperlink.address = address.toLowerCase().indexOf('www.') === 0 ? 'http://' + address : address;\n                }\n            }\n            this.parent.notify(createHyperlinkElement, { cell: args.cell, td: args.td, rowIdx: args.rowIdx, colIdx: args.colIdx });\n        }\n    };\n    CellRenderer.prototype.checkMerged = function (args) {\n        if (args.cell && (args.cell.colSpan < 0 || args.cell.rowSpan < 0)) {\n            args.td.style.display = 'none';\n            if (args.cell.colSpan < 0) {\n                this.parent.notify(checkPrevMerge, args);\n            }\n            if (args.cell.rowSpan < 0) {\n                args.isRow = true;\n                this.parent.notify(checkPrevMerge, args);\n            }\n            return true;\n        }\n        return false;\n    };\n    CellRenderer.prototype.processTemplates = function (cell, rowIdx, colIdx) {\n        var sheet = this.parent.getActiveSheet();\n        var ranges = sheet.ranges;\n        var range;\n        for (var j = 0, len = ranges.length; j < len; j++) {\n            if (ranges[j].template) {\n                range = getRangeIndexes(ranges[j].address.length ? ranges[j].address : ranges[j].startCell);\n                if (range[0] <= rowIdx && range[1] <= colIdx && range[2] >= rowIdx && range[3] >= colIdx) {\n                    if (cell) {\n                        return this.compileCellTemplate(ranges[j].template);\n                    }\n                    else {\n                        if (!getCell(rowIdx, colIdx, sheet, true)) {\n                            return this.compileCellTemplate(ranges[j].template);\n                        }\n                    }\n                }\n            }\n        }\n        return '';\n    };\n    CellRenderer.prototype.compileCellTemplate = function (template) {\n        var compiledStr;\n        if (typeof template === 'string') {\n            var templateString = void 0;\n            if (template.trim().indexOf('#') === 0) {\n                templateString = document.querySelector(template).innerHTML.trim();\n            }\n            else {\n                templateString = template;\n            }\n            compiledStr = compile(templateString);\n            return compiledStr({}, null, null, '', true)[0].outerHTML;\n        }\n        else {\n            compiledStr = compile(template);\n            return compiledStr({}, this.parent, 'ranges', '')[0];\n        }\n    };\n    CellRenderer.prototype.updateRowHeight = function (args) {\n        if (args.cell && args.cell.children.length) {\n            var clonedCell = args.cell.cloneNode(true);\n            this.tableRow.appendChild(clonedCell);\n        }\n        if (args.lastCell && this.tableRow.childElementCount) {\n            var sheet = this.parent.getActiveSheet();\n            var tableRow = args.row || this.parent.getRow(args.rowIdx);\n            var previouseHeight = getRowHeight(sheet, args.rowIdx);\n            var rowHeight = this.getRowHeightOnInit();\n            if (rowHeight > previouseHeight) {\n                tableRow.style.height = rowHeight + \"px\";\n                if (sheet.showHeaders) {\n                    (args.hRow || this.parent.getRow(args.rowIdx, this.parent.getRowHeaderTable())).style.height =\n                        rowHeight + \"px\";\n                }\n                setRowHeight(sheet, args.rowIdx, rowHeight);\n            }\n            this.tableRow.innerHTML = '';\n        }\n    };\n    CellRenderer.prototype.getRowHeightOnInit = function () {\n        var tTable = this.parent.createElement('table', { className: 'e-table e-test-table' });\n        var tBody = tTable.appendChild(this.parent.createElement('tbody'));\n        tBody.appendChild(this.tableRow);\n        this.parent.element.appendChild(tTable);\n        var height = Math.round(this.tableRow.getBoundingClientRect().height);\n        this.parent.element.removeChild(tTable);\n        return height < 20 ? 20 : height;\n    };\n    CellRenderer.prototype.removeStyle = function (element, rowIdx, colIdx) {\n        var cellStyle;\n        if (element.style.length) {\n            cellStyle = this.parent.getCellStyleValue(['borderLeft', 'border'], [rowIdx, colIdx + 1]);\n            var rightBorder_1 = cellStyle.borderLeft || cellStyle.border;\n            cellStyle = this.parent.getCellStyleValue(['borderTop', 'border'], [rowIdx + 1, colIdx]);\n            var bottomBorder_1 = cellStyle.borderTop || cellStyle.border;\n            if (rightBorder_1 || bottomBorder_1) {\n                [].slice.call(element.style).forEach(function (style) {\n                    if ((rightBorder_1 && !(style.indexOf('border-right') > -1) && !bottomBorder_1) ||\n                        (bottomBorder_1 && !(style.indexOf('border-bottom') > -1) && !rightBorder_1)) {\n                        element.style.removeProperty(style);\n                    }\n                });\n            }\n            else {\n                element.removeAttribute('style');\n            }\n        }\n        var prevRowCell = this.parent.getCell(rowIdx - 1, colIdx);\n        if (prevRowCell && prevRowCell.style.borderBottom) {\n            var prevRowIdx = Number(prevRowCell.parentElement.getAttribute('aria-rowindex')) - 1;\n            cellStyle = this.parent.getCellStyleValue(['borderBottom', 'border'], [prevRowIdx, colIdx]);\n            if (!(cellStyle.borderBottom || cellStyle.border)) {\n                prevRowCell.style.borderBottom = '';\n            }\n        }\n        var prevColCell = element.previousElementSibling;\n        if (prevColCell && prevColCell.style.borderRight) {\n            colIdx = Number(prevColCell.getAttribute('aria-colindex')) - 1;\n            cellStyle = this.parent.getCellStyleValue(['borderRight', 'border'], [rowIdx, colIdx]);\n            if (!(cellStyle.borderRight || cellStyle.border)) {\n                prevColCell.style.borderRight = '';\n            }\n        }\n    };\n    /** @hidden */\n    CellRenderer.prototype.refreshRange = function (range) {\n        var sheet = this.parent.getActiveSheet();\n        var cRange = range.slice();\n        if (inView(this.parent, cRange, true)) {\n            for (var i = cRange[0]; i <= cRange[2]; i++) {\n                if (isHiddenRow(sheet, i)) {\n                    continue;\n                }\n                for (var j = cRange[1]; j <= cRange[3]; j++) {\n                    var cell = this.parent.getCell(i, j);\n                    if (cell) {\n                        this.update({ rowIdx: i, colIdx: j, td: cell, cell: getCell(i, j, sheet), lastCell: j === cRange[3], isRefresh: true, isHeightCheckNeeded: true, manualUpdate: true, first: '' });\n                        this.parent.notify(renderFilterCell, { td: cell, rowIndex: i, colIndex: j });\n                    }\n                }\n            }\n        }\n    };\n    CellRenderer.prototype.refresh = function (rowIdx, colIdx, lastCell, element) {\n        var sheet = this.parent.getActiveSheet();\n        if (!element && (isHiddenRow(sheet, rowIdx) || isHiddenCol(sheet, colIdx))) {\n            return;\n        }\n        if (element || !this.parent.scrollSettings.enableVirtualization || (rowIdx >= this.parent.viewport.topIndex && rowIdx <=\n            this.parent.viewport.bottomIndex && colIdx >= this.parent.viewport.leftIndex && colIdx <=\n            this.parent.viewport.rightIndex)) {\n            var cell = element || this.parent.getCell(rowIdx, colIdx);\n            this.update({ rowIdx: rowIdx, colIdx: colIdx, td: cell, cell: getCell(rowIdx, colIdx, sheet), lastCell: lastCell, isRefresh: true, isHeightCheckNeeded: true,\n                manualUpdate: true, first: '' });\n            this.parent.notify(renderFilterCell, { td: cell, rowIndex: rowIdx, colIndex: colIdx });\n        }\n    };\n    CellRenderer.prototype.updateView = function (args) {\n        this.refreshRange(args.indexes);\n    };\n    return CellRenderer;\n}());\nexport { CellRenderer };\n","import { initialLoad, ribbon, formulaBar, beforeVirtualContentLoaded, setAriaOptions, getSiblingsHeight } from '../common/index';\nimport { SheetRender, RowRenderer, CellRenderer } from './index';\nimport { remove } from '@syncfusion/ej2-base';\nimport { getSheetName, getRowsHeight, getColumnsWidth } from '../../workbook/base/index';\nimport { getCellAddress, getCellIndexes, workbookFormulaOperation } from '../../workbook/common/index';\nimport { dataRefresh, sheetTabs, onContentScroll, deInitProperties, beforeDataBound, isReact } from '../common/index';\nimport { spreadsheetDestroyed, isFormulaBarEdit, editOperation, renderReactTemplates } from '../common/index';\n/**\n * Render module is used to render the spreadsheet\n * @hidden\n */\nvar Render = /** @class */ (function () {\n    function Render(parent) {\n        this.parent = parent;\n        this.addEventListener();\n    }\n    Render.prototype.render = function () {\n        this.parent.activeSheetIndex = this.parent.skipHiddenSheets(this.parent.activeSheetIndex);\n        if (!this.parent.isMobileView()) {\n            this.parent.notify(ribbon, null);\n            this.parent.notify(formulaBar, null);\n        }\n        var sheetPanel = this.parent.createElement('div', {\n            id: this.parent.element.id + '_sheet_panel', className: 'e-sheet-panel'\n        });\n        if (this.parent.enableRtl) {\n            sheetPanel.classList.add('e-rtl');\n        }\n        this.parent.element.appendChild(sheetPanel);\n        if (this.parent.showSheetTabs) {\n            this.parent.notify(sheetTabs, null);\n        }\n        else { // for formula calculation\n            var sheetName = getSheetName(this.parent, 0);\n            var arg = { action: 'addSheet', sheetName: 'Sheet1', index: 1, visibleName: sheetName };\n            this.parent.notify(workbookFormulaOperation, arg);\n            this.parent.notify(workbookFormulaOperation, { action: 'initiateDefinedNames' });\n        }\n        if (this.parent.isMobileView()) {\n            this.parent.notify(formulaBar, null);\n            this.parent.notify(ribbon, null);\n        }\n        this.setSheetPanelSize();\n        this.renderSheet(sheetPanel);\n        this.checkTopLeftCell(true);\n    };\n    Render.prototype.checkTopLeftCell = function (initLoad) {\n        var sheet = this.parent.getActiveSheet();\n        if (!this.parent.scrollSettings.enableVirtualization || sheet.topLeftCell === 'A1') {\n            this.refreshUI({ rowIndex: 0, colIndex: 0, refresh: 'All' }, null, initLoad);\n        }\n        else {\n            var indexes = getCellIndexes(sheet.topLeftCell);\n            var top_1 = indexes[0] ? getRowsHeight(sheet, 0, indexes[0] - 1) : 0;\n            var left = indexes[1] ? getColumnsWidth(sheet, 0, indexes[1] - 1) : 0;\n            this.parent.notify(onContentScroll, { scrollLeft: left, scrollTop: top_1, preventScroll: true });\n            var threshold = this.parent.getThreshold('row');\n            var rowIndex = indexes[0] > threshold ? indexes[0] - threshold : 0;\n            threshold = this.parent.getThreshold('col');\n            var colIndex = indexes[1] > threshold ? indexes[1] - threshold : 0;\n            this.refreshUI({ rowIndex: rowIndex, colIndex: colIndex, refresh: 'All', top: top_1, left: left });\n        }\n    };\n    Render.prototype.renderSheet = function (panel) {\n        if (panel === void 0) { panel = document.getElementById(this.parent.element.id + '_sheet_panel'); }\n        panel.appendChild(this.parent.createElement('div', { className: 'e-sheet', id: this.parent.element.id + '_sheet' }));\n        this.parent.serviceLocator.getService('sheet').renderPanel();\n    };\n    Render.prototype.refreshUI = function (args, address, initLoad) {\n        var _this = this;\n        var sheetModule = this.parent.serviceLocator.getService('sheet');\n        var sheet = this.parent.getActiveSheet();\n        var sheetName = getSheetName(this.parent);\n        this.parent.showSpinner();\n        if (!address) {\n            if (this.parent.scrollSettings.enableVirtualization) {\n                var lastRow = args.rowIndex + this.parent.viewport.rowCount + (this.parent.getThreshold('row') * 2);\n                var count = sheet.rowCount - 1;\n                if (this.parent.scrollSettings.isFinite && lastRow > count) {\n                    lastRow = count;\n                }\n                var lastCol = args.colIndex + this.parent.viewport.colCount + (this.parent.getThreshold('col') * 2);\n                count = sheet.colCount - 1;\n                if (this.parent.scrollSettings.isFinite && lastCol > count) {\n                    lastCol = count;\n                }\n                var indexes = this.parent.skipHidden(args.rowIndex, lastRow);\n                var startRow = args.rowIndex;\n                if (args.rowIndex !== indexes[0]) {\n                    var topLeftCell = getCellIndexes(sheet.topLeftCell);\n                    if (topLeftCell[0] === args.rowIndex) {\n                        this.parent.setSheetPropertyOnMute(sheet, 'topLeftCell', getCellAddress(indexes[0], topLeftCell[1]));\n                    }\n                    args.rowIndex = indexes[0];\n                }\n                lastRow = indexes[1];\n                indexes = this.parent.skipHidden(args.colIndex, lastCol, 'columns');\n                var startCol = args.colIndex;\n                if (args.colIndex !== indexes[0]) {\n                    var topLeftCell = getCellIndexes(sheet.topLeftCell);\n                    if (topLeftCell[1] === args.colIndex) {\n                        this.parent.setSheetPropertyOnMute(sheet, 'topLeftCell', getCellAddress(topLeftCell[0], indexes[0]));\n                    }\n                    args.colIndex = indexes[0];\n                }\n                lastCol = indexes[1];\n                this.parent.viewport.topIndex = args.rowIndex;\n                this.parent.viewport.bottomIndex = lastRow;\n                this.parent.viewport.leftIndex = args.colIndex;\n                this.parent.viewport.rightIndex = lastCol;\n                address = getCellAddress(startRow, startCol) + \":\" + getCellAddress(lastRow, lastCol);\n            }\n            else {\n                address = \"A1:\" + getCellAddress(sheet.rowCount - 1, sheet.colCount - 1);\n            }\n        }\n        if (args.refresh === 'All') {\n            this.parent.trigger(beforeDataBound, {});\n        }\n        setAriaOptions(this.parent.getMainContent(), { busy: true });\n        var sheetsLen = this.parent.sheets.length;\n        this.parent.getData(sheetName + \"!\" + address).then(function (values) {\n            if (args.refresh === 'All') {\n                if (sheetsLen < _this.parent.sheets.length) {\n                    return;\n                }\n                var sheetIdx = _this.parent.sheets.indexOf(sheet);\n                if (sheetIdx === -1 || sheetIdx !== _this.parent.activeSheetIndex) {\n                    if (sheetIdx > -1) {\n                        _this.checkTopLeftCell();\n                    }\n                    return;\n                }\n            }\n            var indexes = [args.rowIndex, args.colIndex].concat(getCellIndexes(address.split(':')[1]));\n            switch (args.refresh) {\n                case 'All':\n                    sheetModule.renderTable({ cells: values, indexes: indexes, top: args.top, left: args.left, initLoad: initLoad });\n                    break;\n                case 'Row':\n                    sheetModule.refreshRowContent({ cells: values, indexes: indexes, skipUpdateOnFirst: args.skipUpdateOnFirst });\n                    var isEdit = false;\n                    var arg = { isEdit: isEdit };\n                    _this.parent.notify(isFormulaBarEdit, arg);\n                    if (arg.isEdit) {\n                        _this.parent.notify(editOperation, { action: 'startEdit', refreshCurPos: false });\n                    }\n                    break;\n                case 'Column':\n                    sheetModule.refreshColumnContent({ cells: values, indexes: indexes, skipUpdateOnFirst: args.skipUpdateOnFirst });\n                    break;\n                case 'RowPart':\n                    sheetModule.updateRowContent({\n                        cells: values, indexes: indexes, direction: args.direction, skipUpdateOnFirst: args.skipUpdateOnFirst\n                    });\n                    break;\n                case 'ColumnPart':\n                    sheetModule.updateColContent({\n                        cells: values, indexes: indexes, direction: args.direction, skipUpdateOnFirst: args.skipUpdateOnFirst\n                    });\n                    break;\n            }\n            if (_this.parent[isReact]) {\n                _this.parent[renderReactTemplates]();\n            }\n        });\n        this.parent.notify(beforeVirtualContentLoaded, { refresh: args.refresh });\n    };\n    Render.prototype.removeSheet = function () {\n        remove(document.getElementById(this.parent.element.id + '_sheet'));\n    };\n    /**\n     * Refresh the active sheet\n     */\n    Render.prototype.refreshSheet = function () {\n        this.removeSheet();\n        this.renderSheet();\n        this.parent.notify(deInitProperties, {});\n        this.checkTopLeftCell();\n    };\n    /**\n     * Used to set sheet panel size.\n     */\n    Render.prototype.setSheetPanelSize = function () {\n        var panel = document.getElementById(this.parent.element.id + '_sheet_panel');\n        var offset = this.parent.element.getBoundingClientRect();\n        var height;\n        if (this.parent.height === 'auto') {\n            panel.style.height = '260px';\n            height = 230;\n        }\n        else {\n            height = offset.height - getSiblingsHeight(panel);\n            panel.style.height = height + \"px\";\n            height -= 32;\n        }\n        this.parent.viewport.height = height;\n        this.parent.viewport.width = offset.width - 32;\n        this.parent.viewport.rowCount = this.roundValue(height, 20);\n        this.parent.viewport.colCount = this.roundValue(offset.width, 64);\n    };\n    Render.prototype.roundValue = function (size, threshold) {\n        var value = size / threshold;\n        var roundedValue = Math.round(value);\n        return Math.abs(value - roundedValue) < 0.5 ? roundedValue : roundedValue - 1;\n    };\n    /**\n     * Registing the renderer related services.\n     */\n    Render.prototype.instantiateRenderer = function () {\n        this.parent.serviceLocator.register('cell', new CellRenderer(this.parent));\n        this.parent.serviceLocator.register('row', new RowRenderer(this.parent));\n        this.parent.serviceLocator.register('sheet', new SheetRender(this.parent));\n    };\n    /**\n     * Destroy the Render module.\n     * @return {void}\n     */\n    Render.prototype.destroy = function () {\n        this.removeEventListener();\n        this.parent = null;\n    };\n    Render.prototype.addEventListener = function () {\n        this.parent.on(initialLoad, this.instantiateRenderer, this);\n        this.parent.on(dataRefresh, this.refreshSheet, this);\n        this.parent.on(spreadsheetDestroyed, this.destroy, this);\n    };\n    Render.prototype.removeEventListener = function () {\n        this.parent.off(initialLoad, this.instantiateRenderer);\n        this.parent.off(dataRefresh, this.refreshSheet);\n        this.parent.off(spreadsheetDestroyed, this.destroy);\n    };\n    return Render;\n}());\nexport { Render };\n","import { Dialog as DialogComponent } from '@syncfusion/ej2-popups';\nimport { extend, remove, isNullOrUndefined } from '@syncfusion/ej2-base';\nimport { locale } from '../common/index';\n/**\n * Dialog Service.\n * @hidden\n */\nvar Dialog = /** @class */ (function () {\n    /**\n     * Constructor for initializing dialog service.\n     */\n    function Dialog(parent) {\n        this.parent = parent;\n    }\n    /**\n     * To show dialog.\n     */\n    Dialog.prototype.show = function (dialogModel, cancelBtn) {\n        var _this = this;\n        var btnContent;\n        cancelBtn = isNullOrUndefined(cancelBtn) ? true : false;\n        var closeHandler = dialogModel.close || null;\n        var model = {\n            header: 'Spreadsheet',\n            cssClass: this.parent.cssClass,\n            target: this.parent.element,\n            buttons: []\n        };\n        dialogModel.close = function () {\n            _this.dialogInstance.destroy();\n            remove(_this.dialogInstance.element);\n            _this.dialogInstance = null;\n            if (closeHandler) {\n                closeHandler();\n            }\n        };\n        extend(model, dialogModel);\n        if (cancelBtn) {\n            btnContent = this.parent.serviceLocator.getService(locale).getConstant(model.buttons.length ? 'Cancel' : 'Ok');\n            model.buttons.push({\n                buttonModel: { content: btnContent, isPrimary: model.buttons.length === 0 },\n                click: this.hide.bind(this),\n            });\n        }\n        var div = this.parent.createElement('div');\n        document.body.appendChild(div);\n        this.dialogInstance = new DialogComponent(model);\n        this.dialogInstance.createElement = this.parent.createElement;\n        this.dialogInstance.appendTo(div);\n        this.dialogInstance.refreshPosition();\n    };\n    /**\n     * To hide dialog.\n     */\n    Dialog.prototype.hide = function () {\n        if (this.dialogInstance) {\n            this.dialogInstance.hide();\n        }\n    };\n    /**\n     * To clear private variables.\n     */\n    Dialog.prototype.destroy = function () {\n        this.parent = null;\n    };\n    return Dialog;\n}());\nexport { Dialog };\n","import { completeAction, beginAction } from '../common/index';\nimport { setActionData, updateUndoRedoCollection } from '../common/index';\n/**\n *  Begin and complete events.\n * @hidden\n */\nvar ActionEvents = /** @class */ (function () {\n    /**\n     * Constructor for initializing action begin and action complete services.\n     */\n    function ActionEvents(parent) {\n        this.parent = parent;\n        this.addEventListener();\n        //this.initializeActionBegin();\n        //this.initializeActionComplete();\n    }\n    ActionEvents.prototype.initializeActionBegin = function () {\n        var _this = this;\n        var cellFormat = this.parent.beforeCellFormat;\n        this.parent.beforeCellFormat = function (args) {\n            _this.actionEventHandler({ evtArgs: args, evtFunc: cellFormat, actionType: 'begin', eventType: 'format' });\n        };\n        var beforeOpen = this.parent.beforeOpen;\n        this.parent.beforeOpen = function (args) {\n            _this.actionEventHandler({ evtArgs: args, evtFunc: beforeOpen, actionType: 'begin', eventType: 'beforeOpen' });\n        };\n        var beforeSave = this.parent.beforeSave;\n        this.parent.beforeSave = function (args) {\n            _this.actionEventHandler({ evtArgs: args, evtFunc: beforeSave, actionType: 'begin', eventType: 'beforeSave' });\n        };\n        var beforeSort = this.parent.beforeSort;\n        this.parent.beforeSort = function (args) {\n            _this.actionEventHandler({ evtArgs: args, evtFunc: beforeSort, actionType: 'begin', eventType: 'beforeSort' });\n        };\n    };\n    ActionEvents.prototype.initializeActionComplete = function () {\n        var _this = this;\n        var sortComplete = this.parent.sortComplete;\n        this.parent.sortComplete = function (args) {\n            _this.actionEventHandler({ evtArgs: args, evtFunc: sortComplete, actionType: 'complete', eventType: 'sorting' });\n        };\n        var cellSave = this.parent.cellSave;\n        this.parent.cellSave = function (args) {\n            _this.actionEventHandler({ evtArgs: args, evtFunc: cellSave, actionType: 'complete', eventType: 'cellSave' });\n        };\n    };\n    ActionEvents.prototype.actionEventHandler = function (args) {\n        if (args.evtFunc) {\n            args.evtFunc.apply(this, [args]);\n        }\n        if (args.actionType === 'begin') {\n            this.actionBeginHandler({ eventArgs: args.evtArgs, action: args.eventType });\n        }\n        else {\n            this.actionCompleteHandler({ eventArgs: args.evtArgs, action: args.eventType });\n        }\n    };\n    ActionEvents.prototype.actionBeginHandler = function (args) {\n        this.parent.trigger('actionBegin', { action: args.action, args: args });\n        if (args.action === 'clipboard' || args.action === 'beforeSort' || args.action === 'format' || args.action === 'cellSave'\n            || args.action === 'beforeWrap' || args.action === 'beforeReplace'\n            || args.action === 'beforeClear' || args.action === 'beforeInsertImage' || args.action === 'beforeInsertChart'\n            || args.action === 'filter') {\n            this.parent.notify(setActionData, { args: args });\n        }\n    };\n    ActionEvents.prototype.actionCompleteHandler = function (args) {\n        this.parent.trigger('actionComplete', args);\n        if (args.action !== 'undoRedo' && args.action !== 'gotoSheet') {\n            this.parent.notify(updateUndoRedoCollection, { args: args });\n        }\n    };\n    ActionEvents.prototype.addEventListener = function () {\n        this.parent.on(completeAction, this.actionCompleteHandler, this);\n        this.parent.on(beginAction, this.actionBeginHandler, this);\n    };\n    ActionEvents.prototype.removeEventListener = function () {\n        this.parent.off(completeAction, this.actionCompleteHandler);\n        this.parent.off(beginAction, this.actionBeginHandler);\n    };\n    return ActionEvents;\n}());\nexport { ActionEvents };\n","import { getCellPosition, refreshImgCellObj, refreshChartCellObj } from '../common/index';\nimport { getRangeIndexes, refreshChartSize, focusChartBorder } from '../../workbook/index';\nimport { EventHandler, removeClass, closest } from '@syncfusion/ej2-base';\n/**\n * Specifes to create or modify overlay.\n * @hidden\n */\nvar Overlay = /** @class */ (function () {\n    /**\n     * Constructor for initializing Overlay service.\n     */\n    function Overlay(parent) {\n        this.minHeight = '300px';\n        this.minWidth = '400px';\n        this.isOverlayClicked = false;\n        this.isResizerClicked = false;\n        this.currentWidth = 400;\n        this.currenHeight = 300;\n        this.parent = parent;\n    }\n    /**\n     * To insert a shape.\n     * @hidden\n     */\n    Overlay.prototype.insertOverlayElement = function (id, range, sheetIndex) {\n        var div = this.parent.createElement('div', {\n            id: id,\n            attrs: { 'class': 'e-ss-overlay' },\n            styles: 'width: ' + this.minWidth + ';  height: ' + this.minHeight\n        });\n        var indexes = getRangeIndexes(range);\n        var sheet = this.parent.sheets[sheetIndex];\n        var pos = getCellPosition(sheet, indexes);\n        div.style.top = pos.top + 'px';\n        div.style.left = pos.left + 'px';\n        this.parent.getMainContent().appendChild(div);\n        this.renderResizeHandles(div);\n        this.addEventListener(div);\n        this.originalWidth = parseFloat(getComputedStyle(div, null).getPropertyValue('width').replace('px', ''));\n        this.originalHeight = parseFloat(getComputedStyle(div, null).getPropertyValue('height').replace('px', ''));\n        return div;\n    };\n    Overlay.prototype.addEventListener = function (div) {\n        var overlayElem = div;\n        EventHandler.add(overlayElem, 'mousedown', this.overlayClickHandler, this);\n        EventHandler.add(overlayElem, 'mousemove', this.overlayMouseMoveHandler, this);\n        EventHandler.add(this.parent.getMainContent(), 'mousemove', this.overlayMouseMoveHandler, this);\n        EventHandler.add(document, 'mouseup', this.overlayMouseUpHandler, this);\n    };\n    Overlay.prototype.overlayMouseMoveHandler = function (e) {\n        var target = e.target;\n        var overlayElem = document.getElementsByClassName('e-ss-overlay-active')[0];\n        if (this.isOverlayClicked && this.isResizerClicked) {\n            switch (this.resizer) {\n                case 'e-ss-overlay-t':\n                    var height1 = Math.max(this.originalMouseY - e.clientY + this.originalHeight, 20);\n                    var top_1 = e.clientY - (this.originalMouseY - this.originalResizeTop);\n                    if (height1 > 180 && top_1 > -1) {\n                        overlayElem.style.height = height1 + 'px';\n                        overlayElem.style.top = top_1 + 'px';\n                        this.resizedReorderTop = top_1; // resized divTop\n                        this.currenHeight = height1;\n                        this.parent.notify(refreshChartSize, {\n                            height: overlayElem.style.height, width: overlayElem.style.width, overlayEle: overlayElem\n                        });\n                    }\n                    break;\n                case 'e-ss-overlay-r':\n                    var width1 = this.originalWidth + (e.pageX - this.originalMouseX);\n                    if (width1 > 180) {\n                        overlayElem.style.width = width1 + 'px';\n                        this.currentWidth = width1;\n                        this.parent.notify(refreshChartSize, {\n                            height: overlayElem.style.height, width: overlayElem.style.width, overlayEle: overlayElem\n                        });\n                    }\n                    break;\n                case 'e-ss-overlay-b':\n                    var height2 = this.originalHeight + (e.pageY - this.originalMouseY);\n                    if (height2 > 180) {\n                        overlayElem.style.height = height2 + 'px';\n                        this.currenHeight = height2;\n                        this.parent.notify(refreshChartSize, {\n                            height: overlayElem.style.height, width: overlayElem.style.width, overlayEle: overlayElem\n                        });\n                    }\n                    break;\n                case 'e-ss-overlay-l':\n                    var width2 = Math.max(this.originalMouseX - e.clientX + this.originalWidth, 20);\n                    var left = e.clientX - (this.originalMouseX - this.originalResizeLeft);\n                    if (width2 > 180 && left > -1) {\n                        overlayElem.style.width = width2 + 'px';\n                        overlayElem.style.left = left + 'px';\n                        this.resizedReorderLeft = left; //resized divLeft\n                        this.currentWidth = width2;\n                        this.parent.notify(refreshChartSize, {\n                            height: overlayElem.style.height, width: overlayElem.style.width, overlayEle: overlayElem\n                        });\n                    }\n                    break;\n            }\n        }\n        else if (this.isOverlayClicked) {\n            var posX = e.clientX;\n            var posY = e.clientY;\n            var aX = posX - this.diffX;\n            var aY = posY - this.diffY;\n            if (aX > -1) {\n                overlayElem.style.left = aX + 'px';\n            }\n            if (aY > -1) {\n                overlayElem.style.top = aY + 'px';\n            }\n            this.resizedReorderLeft = aX; //resized divLeft\n            this.resizedReorderTop = aY; // resized divTop\n        }\n    };\n    Overlay.prototype.overlayMouseUpHandler = function (e) {\n        if (this.parent.getActiveSheet().isProtected) {\n            return;\n        }\n        this.isOverlayClicked = false;\n        this.isResizerClicked = false;\n        var elem = e.target;\n        if (!elem.classList.contains('e-ss-overlay')) {\n            elem = closest(e.target, '.e-datavisualization-chart') ?\n                closest(e.target, '.e-datavisualization-chart') : elem;\n        }\n        var eventArgs = {\n            prevTop: this.originalReorderTop, prevLeft: this.originalReorderLeft,\n            currentTop: this.resizedReorderTop ? this.resizedReorderTop : this.originalReorderTop, currentLeft: this.resizedReorderLeft ?\n                this.resizedReorderLeft : this.originalReorderLeft, id: elem.id, currentHeight: this.currenHeight,\n            currentWidth: this.currentWidth, requestType: 'imageRefresh',\n            prevHeight: this.originalHeight, prevWidth: this.originalWidth\n        };\n        if (elem.id.indexOf('overlay') > 0 || elem.classList.contains('e-ss-resizer')) {\n            if (this.originalReorderTop !== this.resizedReorderTop || this.originalReorderLeft !== this.resizedReorderLeft) {\n                eventArgs.id = elem.id;\n                if (elem.classList.contains('e-datavisualization-chart')) {\n                    eventArgs.requestType = 'chartRefresh';\n                    this.parent.notify(refreshChartCellObj, eventArgs);\n                }\n                this.parent.notify(refreshImgCellObj, eventArgs);\n                this.resizedReorderTop = this.originalReorderTop;\n                this.resizedReorderLeft = this.originalReorderLeft;\n            }\n            else if (this.currenHeight !== this.originalHeight || this.originalWidth !== this.currentWidth) {\n                eventArgs.id = elem.id.indexOf('overlay') > 0 ? elem.id : elem.parentElement.id;\n                if (elem.classList.contains('e-datavisualization-chart')) {\n                    eventArgs.requestType = 'chartRefresh';\n                    this.parent.notify(refreshChartCellObj, eventArgs);\n                }\n                this.parent.notify(refreshImgCellObj, eventArgs);\n                this.originalHeight = this.currenHeight;\n                this.originalWidth = this.currentWidth;\n            }\n        }\n    };\n    Overlay.prototype.overlayClickHandler = function (e) {\n        if (this.parent.getActiveSheet().isProtected) {\n            return;\n        }\n        this.isOverlayClicked = true;\n        var target = e.target;\n        var overlayElem = e.target;\n        if (!target.classList.contains('e-ss-overlay')) {\n            overlayElem = target.parentElement;\n            if (closest(e.target, '.e-datavisualization-chart')) {\n                overlayElem = closest(e.target, '.e-datavisualization-chart');\n                this.currentWidth = parseFloat(getComputedStyle(overlayElem, null).getPropertyValue('width').replace('px', ''));\n                this.currenHeight = parseFloat(getComputedStyle(overlayElem, null).getPropertyValue('height').replace('px', ''));\n            }\n        }\n        this.originalReorderLeft = parseInt(overlayElem.style.left, 10); //divLeft\n        this.originalReorderTop = parseInt(overlayElem.style.top, 10); // divTop\n        this.resizedReorderLeft = parseInt(overlayElem.style.left, 10); //resized divLeft\n        this.resizedReorderTop = parseInt(overlayElem.style.top, 10); // resized divTop\n        this.originalResizeTop = this.originalReorderTop;\n        this.originalResizeLeft = this.originalReorderLeft;\n        this.originalMouseX = e.clientX; // posX\n        this.originalMouseY = e.clientY; // posY\n        this.diffX = this.originalMouseX - this.originalReorderLeft;\n        this.diffY = this.originalMouseY - this.originalReorderTop;\n        var actOverlayElem = document.getElementsByClassName('e-ss-overlay-active')[0];\n        if (actOverlayElem) {\n            removeClass([actOverlayElem], 'e-ss-overlay-active');\n        }\n        document.getElementById(overlayElem.id).classList.add('e-ss-overlay-active');\n        if (target.classList.contains('e-ss-resizer')) {\n            this.resizer = target.classList[0];\n            this.originalWidth = parseFloat(getComputedStyle(overlayElem, null).getPropertyValue('width').replace('px', ''));\n            this.originalHeight = parseFloat(getComputedStyle(overlayElem, null).getPropertyValue('height').replace('px', ''));\n            this.isResizerClicked = true;\n        }\n        if (overlayElem.classList.contains('e-datavisualization-chart')) {\n            this.parent.notify(focusChartBorder, { id: overlayElem.id });\n        }\n    };\n    Overlay.prototype.renderResizeHandles = function (div) {\n        var handles = ['e-ss-overlay-t', 'e-ss-overlay-r', 'e-ss-overlay-b', 'e-ss-overlay-l'];\n        var i = 0;\n        var handleElem;\n        var overlay = div;\n        while (handles.length > i) {\n            handleElem = this.parent.createElement('div', {\n                attrs: { 'class': handles[i] + ' ' + 'e-ss-resizer' },\n                styles: 'width: 8px; height: 8px; border-radius: 4px;'\n            });\n            overlay.appendChild(handleElem);\n            i++;\n        }\n    };\n    Overlay.prototype.removeEventListener = function () {\n        var overlayElem = document.getElementById(this.parent.element.id + '_overlay');\n        EventHandler.remove(overlayElem, 'mousedown', this.overlayClickHandler);\n        EventHandler.remove(overlayElem, 'mousemove', this.overlayMouseMoveHandler);\n        EventHandler.remove(this.parent.getMainContent(), 'mousemove', this.overlayMouseMoveHandler);\n        EventHandler.remove(document, 'mouseup', this.overlayMouseUpHandler);\n    };\n    /**\n     * To clear private variables.\n     */\n    Overlay.prototype.destroy = function () {\n        this.removeEventListener();\n        this.parent = null;\n    };\n    return Overlay;\n}());\nexport { Overlay };\n","var __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    }\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\n/// <reference path='../../workbook/base/workbook-model.d.ts'/>\nimport { Property, NotifyPropertyChanges, Event, isUndefined } from '@syncfusion/ej2-base';\nimport { addClass, removeClass, Complex, formatUnit, L10n, isNullOrUndefined, Browser } from '@syncfusion/ej2-base';\nimport { detach, select, closest, setStyleAttribute, EventHandler } from '@syncfusion/ej2-base';\nimport { initialLoad, mouseDown, spreadsheetDestroyed, keyUp, clearViewer, blankWorkbook } from '../common/index';\nimport { hideShow, performUndoRedo, overlay, createImageElement, deleteImage } from '../common/index';\nimport { sheetNameUpdate, updateUndoRedoCollection, getUpdateUsingRaf, setAutoFit, created } from '../common/index';\nimport { actionEvents, keyDown, enableFileMenuItems, hideToolbarItems, updateAction } from '../common/index';\nimport { colWidthChanged, rowHeightChanged, hideRibbonTabs, addFileMenuItems, getSiblingsHeight } from '../common/index';\nimport { defaultLocale, locale, setAriaOptions, setResize, initiateFilterUI, clearFilter, clearTemplate, isReact } from '../common/index';\nimport { ribbon, formulaBar, sheetTabs, formulaOperation, addRibbonTabs } from '../common/index';\nimport { addContextMenuItems, removeContextMenuItems, enableContextMenuItems, selectRange, addToolbarItems } from '../common/index';\nimport { cut, copy, paste, dialog, editOperation, activeSheetChanged, refreshFormulaDatasource } from '../common/index';\nimport { Render } from '../renderer/render';\nimport { Scroll, VirtualScroll, Edit, CellFormat, Selection, KeyboardNavigation, KeyboardShortcut, WrapText } from '../actions/index';\nimport { Clipboard, ShowHide, UndoRedo, SpreadsheetHyperlink, Resize, Insert, Delete, FindAndReplace, Merge } from '../actions/index';\nimport { ProtectSheet } from '../actions/index';\nimport { click, hideFileMenuItems } from '../common/index';\nimport { Dialog, ActionEvents, Overlay } from '../services/index';\nimport { ServiceLocator } from '../../workbook/services/index';\nimport { getColumnsWidth, getSheetIndex, WorkbookHyperlink } from './../../workbook/index';\nimport { getCellAddress } from './../../workbook/common/index';\nimport { activeCellChanged, afterHyperlinkCreate, getColIndex } from './../../workbook/index';\nimport { WorkbookInsert, WorkbookDelete, WorkbookMerge } from './../../workbook/index';\nimport { getSheetNameFromAddress, DataBind, beforeHyperlinkCreate } from './../../workbook/index';\nimport { sortComplete, dataSourceChanged } from './../../workbook/index';\nimport { getSheetIndexFromId, WorkbookEdit, WorkbookOpen, WorkbookSave, WorkbookCellFormat, WorkbookSort } from './../../workbook/index';\nimport { findKeyUp } from './../../workbook/index';\nimport { Workbook } from '../../workbook/base/workbook';\nimport { getRequiredModules, ScrollSettings, enableToolbarItems } from '../common/index';\nimport { SelectionSettings, getStartEvent, enableRibbonTabs } from '../common/index';\nimport { createSpinner, showSpinner, hideSpinner } from '@syncfusion/ej2-popups';\nimport { setRowHeight, getRowsHeight, getColumnWidth, getRowHeight } from './../../workbook/base/index';\nimport { getRangeIndexes, getIndexesFromAddress, getCellIndexes, WorkbookNumberFormat, WorkbookFormula } from '../../workbook/index';\nimport { Ribbon, FormulaBar, SheetTabs, Open, ContextMenu, Save, NumberFormat, Formula } from '../integrations/index';\nimport { Sort, Filter, SpreadsheetImage, SpreadsheetChart } from '../integrations/index';\nimport { isNumber, getColumn, WorkbookFilter } from '../../workbook/index';\nimport { DataValidation } from '../actions/index';\nimport { WorkbookDataValidation, WorkbookConditionalFormat, WorkbookFindAndReplace } from '../../workbook/actions/index';\nimport { findAllValues } from './../../workbook/common/index';\nimport { ConditionalFormatting } from '../actions/conditional-formatting';\nimport { WorkbookImage, WorkbookChart } from '../../workbook/integrations/index';\nimport { WorkbookProtectSheet } from '../../workbook/actions/index';\n/**\n * Represents the Spreadsheet component.\n * ```html\n * <div id='spreadsheet'></div>\n * <script>\n *  var spreadsheetObj = new Spreadsheet();\n *  spreadsheetObj.appendTo('#spreadsheet');\n * </script>\n * ```\n */\nvar Spreadsheet = /** @class */ (function (_super) {\n    __extends(Spreadsheet, _super);\n    /**\n     * Constructor for creating the widget.\n     * @param  {SpreadsheetModel} options? - Configures Spreadsheet options.\n     * @param  {string|HTMLElement} element? - Element to render Spreadsheet.\n     */\n    function Spreadsheet(options, element) {\n        var _this = _super.call(this, options) || this;\n        /** @hidden */\n        _this.viewport = {\n            rowCount: 0, colCount: 0, height: 0, topIndex: 0, leftIndex: 0, width: 0,\n            bottomIndex: 0, rightIndex: 0\n        };\n        _this.needsID = true;\n        Spreadsheet_1.Inject(Ribbon, FormulaBar, SheetTabs, Selection, Edit, KeyboardNavigation, KeyboardShortcut, Clipboard, DataBind, Open, ContextMenu, Save, NumberFormat, CellFormat, Formula, WrapText, WorkbookEdit, WorkbookOpen, WorkbookSave, WorkbookCellFormat, WorkbookNumberFormat, WorkbookFormula, Sort, WorkbookSort, Resize, UndoRedo, WorkbookFilter, Filter, SpreadsheetHyperlink, WorkbookHyperlink, Insert, Delete, WorkbookInsert, WorkbookDelete, DataValidation, WorkbookDataValidation, ProtectSheet, WorkbookProtectSheet, FindAndReplace, WorkbookFindAndReplace, Merge, WorkbookMerge, SpreadsheetImage, ConditionalFormatting, WorkbookImage, WorkbookConditionalFormat, SpreadsheetChart, WorkbookChart);\n        if (element) {\n            _this.appendTo(element);\n        }\n        return _this;\n    }\n    Spreadsheet_1 = Spreadsheet;\n    /**\n     * To get cell element.\n     * @returns HTMLElement\n     * @hidden\n     */\n    Spreadsheet.prototype.getCell = function (rowIndex, colIndex, row) {\n        colIndex = this.getViewportIndex(colIndex, true);\n        if (!row) {\n            row = this.getRow(rowIndex);\n        }\n        return row ? row.cells[colIndex] : row;\n    };\n    /**\n     * Get cell element.\n     * @returns HTMLTableRowElement\n     * @hidden\n     */\n    Spreadsheet.prototype.getRow = function (index, table) {\n        index = this.getViewportIndex(index);\n        table = table || this.getContentTable();\n        return table ? table.rows[index] : null;\n    };\n    /**\n     * To get hidden row/column count between two specified index.\n     * Set `layout` as `columns` if you want to get column hidden count.\n     * @hidden\n     */\n    Spreadsheet.prototype.hiddenCount = function (startIndex, endIndex, layout) {\n        if (layout === void 0) { layout = 'rows'; }\n        var sheet = this.getActiveSheet();\n        var count = 0;\n        for (var i = startIndex; i <= endIndex; i++) {\n            if ((sheet[layout])[i] && (sheet[layout])[i].hidden) {\n                count++;\n            }\n        }\n        return count;\n    };\n    /**\n     * To get row/column viewport index.\n     * @hidden\n     */\n    Spreadsheet.prototype.getViewportIndex = function (index, isCol) {\n        if (this.scrollSettings.enableVirtualization) {\n            if (isCol) {\n                index -= this.hiddenCount(this.viewport.leftIndex, index, 'columns');\n                index -= this.viewport.leftIndex;\n            }\n            else {\n                index -= this.hiddenCount(this.viewport.topIndex, index);\n                index -= this.viewport.topIndex;\n            }\n        }\n        return index;\n    };\n    /**\n     * To initialize the services;\n     * @returns void\n     * @hidden\n     */\n    Spreadsheet.prototype.preRender = function () {\n        _super.prototype.preRender.call(this);\n        this.serviceLocator = new ServiceLocator;\n        this.initServices();\n    };\n    Spreadsheet.prototype.initServices = function () {\n        this.serviceLocator.register(locale, new L10n(this.getModuleName(), defaultLocale, this.locale));\n        this.serviceLocator.register(dialog, new Dialog(this));\n        this.serviceLocator.register(actionEvents, new ActionEvents(this));\n        this.serviceLocator.register(overlay, new Overlay(this));\n    };\n    /**\n     * To Initialize the component rendering.\n     * @returns void\n     * @hidden\n     */\n    Spreadsheet.prototype.render = function () {\n        _super.prototype.render.call(this);\n        this.element.setAttribute('tabindex', '0');\n        setAriaOptions(this.element, { role: 'grid' });\n        this.renderModule = new Render(this);\n        this.notify(initialLoad, null);\n        this.renderSpreadsheet();\n        this.wireEvents();\n        if (this.created) {\n            if (this[created].observers) {\n                if (this[created].observers.length > 0) {\n                    this.createdHandler = { observers: this[created].observers };\n                    this[created].observers = [];\n                }\n            }\n            else {\n                this.createdHandler = this.created;\n                this.setProperties({ created: undefined }, true);\n            }\n        }\n    };\n    Spreadsheet.prototype.renderSpreadsheet = function () {\n        if (this.cssClass) {\n            addClass([this.element], this.cssClass.split(' '));\n        }\n        this.setHeight();\n        this.setWidth();\n        createSpinner({ target: this.element }, this.createElement);\n        if (this.isMobileView() && this.cssClass.indexOf('e-mobile-view') === -1) {\n            this.element.classList.add('e-mobile-view');\n        }\n        this.sheetModule = this.serviceLocator.getService('sheet');\n        if (this.allowScrolling) {\n            this.scrollModule = new Scroll(this);\n        }\n        if (this.scrollSettings.enableVirtualization) {\n            new VirtualScroll(this);\n        }\n        this.renderModule.render();\n        new ShowHide(this);\n    };\n    /**\n     * By default, Spreadsheet shows the spinner for all its actions. To manually show spinner you this method at your needed time.\n     * {% codeBlock src='spreadsheet/showSpinner/index.md' %}{% endcodeBlock %}\n     * @return {void}\n     */\n    Spreadsheet.prototype.showSpinner = function () {\n        showSpinner(this.element);\n    };\n    /**\n     * To hide showed spinner manually.\n     * {% codeBlock src='spreadsheet/hideSpinner/index.md' %}{% endcodeBlock %}\n     * @return {void}\n     */\n    Spreadsheet.prototype.hideSpinner = function () {\n        hideSpinner(this.element);\n    };\n    /**\n     * To protect the particular sheet.\n     * {% codeBlock src='spreadsheet/protectSheet/index.md' %}{% endcodeBlock %}\n     * @param {number | string} sheet - Specifies the sheet to protect.\n     * @param {ProtectSettingsModel} protectSettings - Specifies the protect sheet options.\n     * @default { selectCells: 'false', formatCells: 'false', formatRows: 'false', formatColumns:'false', insertLink:'false' }\n     * @return {void}\n     */\n    Spreadsheet.prototype.protectSheet = function (sheet, protectSettings) {\n        if (typeof (sheet) === 'string') {\n            sheet = getSheetIndex(this, sheet);\n        }\n        if (sheet) {\n            this.setSheetPropertyOnMute(this.sheets[sheet], 'isProtected', true);\n            this.setSheetPropertyOnMute(this.sheets[sheet], 'protectSettings', protectSettings);\n        }\n        sheet = this.getActiveSheet().index;\n        this.setSheetPropertyOnMute(this.getActiveSheet(), 'isProtected', true);\n        _super.prototype.protectSheet.call(this, sheet, protectSettings);\n    };\n    /**\n     * To unprotect the particular sheet.\n     * {% codeBlock src='spreadsheet/unprotectSheet/index.md' %}{% endcodeBlock %}\n     * @param {number | string} sheet - Specifies the sheet to Unprotect.\n     * @return {void}\n     */\n    Spreadsheet.prototype.unprotectSheet = function (sheet) {\n        if (typeof (sheet) === 'string') {\n            sheet = getSheetIndex(this, sheet);\n        }\n        if (sheet) {\n            this.sheets[sheet].isProtected = false;\n        }\n        else {\n            this.getActiveSheet().isProtected = false;\n        }\n        _super.prototype.unprotectSheet.call(this, sheet);\n    };\n    /**\n     * To find the specified cell value.\n     * {% codeBlock src='spreadsheet/find/index.md' %}{% endcodeBlock %}\n     * @param {FindOptions} args - Specifies the replace value with find args to replace specified cell value.\n     * @param {string} args.value - Specifies the value to be find.\n     * @param {FindModeType} args.mode - Specifies the value to be find within sheet or workbook.\n     * @param {string} args.searchBy - Specifies the value to be find by row or column.\n     * @param {boolean} args.isCSen - Specifies the find match with case sensitive or not.\n     * @param {boolean} args.isEMatch - Specifies the find match with entire match or not.\n     * @param {string} args.findOpt - Specifies the next or previous find match.\n     * @param {number} args.sheetIndex - Specifies the current sheet to find.\n     * @default { mode: 'Sheet', searchBy: 'By Row', isCSen: 'false', isEMatch:'false' }\n     * @return {void}\n     */\n    Spreadsheet.prototype.find = function (args) {\n        _super.prototype.findHandler.call(this, args);\n    };\n    /**\n     * To replace the specified cell value.\n     * {% codeBlock src='spreadsheet/replace/index.md' %}{% endcodeBlock %}\n     * @param {FindOptions} args - Specifies the replace value with find args to replace specified cell value.\n     * @param {string} args.replaceValue - Specifies the replacing value.\n     * @param {string} args.replaceBy - Specifies the value to be replaced for one or all.\n     * @param {string} args.value - Specifies the value to be replaced\n     * @return {void}\n     */\n    Spreadsheet.prototype.replace = function (args) {\n        args = {\n            value: args.value, mode: args.mode ? args.mode : 'Sheet', isCSen: args.isCSen ? args.isCSen : false,\n            isEMatch: args.isEMatch ? args.isEMatch : false, searchBy: args.searchBy ? args.searchBy : 'By Row',\n            replaceValue: args.replaceValue, replaceBy: args.replaceBy,\n            sheetIndex: args.sheetIndex ? args.sheetIndex : this.activeSheetIndex, findOpt: args.findOpt ? args.findOpt : ''\n        };\n        _super.prototype.replaceHandler.call(this, args);\n    };\n    /**\n     * To Find All the Match values Address within Sheet or Workbook.\n     * {% codeBlock src='spreadsheet/findAll/index.md' %}{% endcodeBlock %}\n     * @param {string} value - Specifies the value to find.\n     * @param {FindModeType} mode - Specifies the value to be find within Sheet/Workbook.\n     * @param {boolean} isCSen - Specifies the find match with case sensitive or not.\n     * @param {boolean} isEMatch - Specifies the find match with entire match or not.\n     * @param {number} sheetIndex - Specifies the sheetIndex. If not specified, it will consider the active sheet.\n     * @return {string[]}\n     */\n    Spreadsheet.prototype.findAll = function (value, mode, isCSen, isEMatch, sheetIndex) {\n        mode = mode ? mode : 'Sheet';\n        sheetIndex = sheetIndex ? sheetIndex : this.activeSheetIndex;\n        isCSen = isCSen ? isCSen : false;\n        isEMatch = isEMatch ? isEMatch : false;\n        var findCollection = [];\n        var findAllArguments = {\n            value: value, mode: mode, sheetIndex: sheetIndex, isCSen: isCSen,\n            isEMatch: isEMatch, findCollection: findCollection\n        };\n        this.notify(findAllValues, findAllArguments);\n        return findCollection;\n    };\n    /**\n     * Used to navigate to cell address within workbook.\n     * {% codeBlock src='spreadsheet/goTo/index.md' %}{% endcodeBlock %}\n     * @param {string} address - Specifies the cell address you need to navigate.\n     * You can specify the address in two formats,\n     * `{sheet name}!{cell address}` - Switch to specified sheet and navigate to specified cell address.\n     * `{cell address}` - Navigate to specified cell address with in the active sheet.\n     * @return {void}\n     */\n    Spreadsheet.prototype.goTo = function (address) {\n        if (address.includes('!')) {\n            var addrArr = address.split('!');\n            var idx = getSheetIndex(this, addrArr[0]);\n            if (idx === undefined) {\n                return;\n            }\n            if (idx !== this.activeSheetIndex) {\n                var activeCell = addrArr[1].split(':')[0];\n                this.setSheetPropertyOnMute(this.sheets[idx], 'activeCell', activeCell);\n                this.setSheetPropertyOnMute(this.sheets[idx], 'selectedRange', addrArr[1]);\n                var cellIndex = getCellIndexes(activeCell);\n                if (cellIndex[0] < this.viewport.rowCount) {\n                    cellIndex[0] = 0;\n                }\n                if (cellIndex[1] < this.viewport.colCount) {\n                    cellIndex[1] = 0;\n                }\n                this.setSheetPropertyOnMute(this.sheets[idx], 'topLeftCell', getCellAddress(cellIndex[0], cellIndex[1]));\n                this.activeSheetIndex = idx;\n                this.dataBind();\n                return;\n            }\n        }\n        var indexes = getRangeIndexes(address);\n        var sheet = this.getActiveSheet();\n        var insideDomCount = indexes[0] >= this.viewport.topIndex && indexes[0] < this.viewport.bottomIndex && indexes[1] >=\n            this.viewport.leftIndex && indexes[1] < this.viewport.rightIndex;\n        if (insideDomCount) {\n            this.selectRange(address);\n            var viewportIndexes = getCellIndexes(sheet.topLeftCell);\n            viewportIndexes[2] = viewportIndexes[0] + this.viewport.rowCount;\n            viewportIndexes[3] = viewportIndexes[1] + this.viewport.colCount;\n            if (indexes[0] >= viewportIndexes[0] && indexes[0] < viewportIndexes[2] && indexes[1] >= viewportIndexes[1] &&\n                indexes[1] < viewportIndexes[3]) {\n                return;\n            }\n        }\n        var content = this.getMainContent();\n        var vTrack;\n        var cVTrack;\n        var rVTrack;\n        var offset;\n        var vWidth;\n        var vHeight;\n        var scrollableSize;\n        if (indexes[0] === 0) {\n            offset = getRowsHeight(sheet, 0);\n        }\n        else {\n            offset = getRowsHeight(sheet, 0, indexes[0] - 1);\n            if (this.scrollSettings.enableVirtualization) {\n                scrollableSize = offset + this.getContentTable().getBoundingClientRect().height;\n                vHeight = parseInt(content.querySelector('.e-virtualtrack').style.height, 10);\n                if (scrollableSize > vHeight) {\n                    scrollableSize += 10;\n                    vTrack = content.querySelector('.e-virtualtrack');\n                    vTrack.style.height = scrollableSize + \"px\";\n                    if (sheet.showHeaders) {\n                        rVTrack = this.getRowHeaderContent().querySelector('.e-virtualtrack');\n                        rVTrack.style.height = scrollableSize + \"px\";\n                    }\n                    getUpdateUsingRaf(function () {\n                        vTrack.style.height = vHeight + \"px\";\n                        if (sheet.showHeaders) {\n                            rVTrack.style.height = vHeight + \"px\";\n                        }\n                    });\n                }\n            }\n        }\n        content.scrollTop = offset;\n        if (indexes[1] === 0) {\n            offset = getColumnsWidth(sheet, 0);\n        }\n        else {\n            offset = getColumnsWidth(sheet, 0, indexes[1] - 1);\n            if (this.scrollSettings.enableVirtualization) {\n                scrollableSize = offset + this.getContentTable().getBoundingClientRect().width;\n                vWidth = parseInt(content.querySelector('.e-virtualtrack').style.width, 10);\n                if (scrollableSize > vWidth) {\n                    scrollableSize += 10;\n                    vTrack = content.querySelector('.e-virtualtrack');\n                    vTrack.style.width = scrollableSize + \"px\";\n                    if (sheet.showHeaders) {\n                        cVTrack = this.getColumnHeaderContent().querySelector('.e-virtualtrack');\n                        cVTrack.style.width = scrollableSize + \"px\";\n                    }\n                    getUpdateUsingRaf(function () {\n                        vTrack.style.width = vWidth + \"px\";\n                        if (sheet.showHeaders) {\n                            cVTrack.style.width = vWidth + \"px\";\n                        }\n                    });\n                }\n            }\n        }\n        content.scrollLeft = offset;\n        if (!insideDomCount) {\n            this.selectRange(address);\n        }\n    };\n    /**\n     * Used to resize the Spreadsheet.\n     * {% codeBlock src='spreadsheet/resize/index.md' %}{% endcodeBlock %}\n     */\n    Spreadsheet.prototype.resize = function () {\n        this.renderModule.setSheetPanelSize();\n        if (this.scrollSettings.enableVirtualization) {\n            this.renderModule.refreshSheet();\n        }\n    };\n    /**\n     * To cut the specified cell or cells properties such as value, format, style etc...\n     * {% codeBlock src='spreadsheet/cut/index.md' %}{% endcodeBlock %}\n     * @param {string} address - Specifies the range address to cut.\n     */\n    Spreadsheet.prototype.cut = function (address) {\n        var promise = new Promise(function (resolve, reject) { resolve((function () { })()); });\n        this.notify(cut, address ? {\n            range: getIndexesFromAddress(address),\n            sId: this.sheets[getSheetIndex(this, getSheetNameFromAddress(address))].id,\n            promise: promise\n        } : { promise: promise });\n        return promise;\n    };\n    /**\n     * To copy the specified cell or cells properties such as value, format, style etc...\n     * {% codeBlock src='spreadsheet/copy/index.md' %}{% endcodeBlock %}\n     * @param {string} address - Specifies the range address.\n     */\n    Spreadsheet.prototype.copy = function (address) {\n        var activeAddress = this.getActiveSheet().name + '!' + this.getActiveSheet().activeCell;\n        address = !isNullOrUndefined(address) ? address : activeAddress;\n        var promise = new Promise(function (resolve, reject) { resolve((function () { })()); });\n        this.notify(copy, address ? {\n            range: getIndexesFromAddress(address),\n            sId: this.sheets[getSheetIndex(this, getSheetNameFromAddress(address))].id,\n            promise: promise\n        } : { promise: promise });\n        return promise;\n    };\n    /**\n     * This method is used to paste the cut or copied cells in to specified address.\n     * {% codeBlock src='spreadsheet/paste/index.md' %}{% endcodeBlock %}\n     * @param {string} address - Specifies the cell or range address.\n     * @param {PasteSpecialType} type - Specifies the type of paste.\n     */\n    Spreadsheet.prototype.paste = function (address, type) {\n        this.notify(paste, {\n            range: getIndexesFromAddress(address), sIdx: getSheetIndex(this, getSheetNameFromAddress(address)),\n            type: type, isAction: false, isInternal: true\n        });\n    };\n    /**\n     * To update the action which need to perform.\n     * {% codeBlock src='spreadsheet/updateAction/index.md' %}{% endcodeBlock %}\n     * @param {string} options - It describes an action and event args to perform.\n     * @param {string} options.action - specifies an action.\n     * @param {string} options.eventArgs - specifies an args to perform an action.\n     */\n    Spreadsheet.prototype.updateAction = function (options) {\n        updateAction(options, this);\n    };\n    Spreadsheet.prototype.setHeight = function () {\n        if (this.height.toString().indexOf('%') > -1) {\n            this.element.style.minHeight = '400px';\n        }\n        this.element.style.height = formatUnit(this.height);\n    };\n    Spreadsheet.prototype.setWidth = function () {\n        if (this.width.toString().indexOf('%') > -1 || this.width === 'auto') {\n            this.element.style.minWidth = '300px';\n        }\n        this.element.style.width = formatUnit(this.width);\n    };\n    /**\n     * Set the width of column.\n     * {% codeBlock src='spreadsheet/setColWidth/index.md' %}{% endcodeBlock %}\n     * @param {number} width\n     * @param {number} colIndex\n     * @param {number} sheetIndex\n     */\n    Spreadsheet.prototype.setColWidth = function (width, colIndex, sheetIndex) {\n        if (width === void 0) { width = 64; }\n        if (colIndex === void 0) { colIndex = 0; }\n        var colThreshold = this.getThreshold('col');\n        var lastIdx = this.viewport.leftIndex + this.viewport.colCount + (colThreshold * 2);\n        var sheet = isNullOrUndefined(sheetIndex) ? this.getActiveSheet() : this.sheets[sheetIndex];\n        if (sheet) {\n            var mIndex = colIndex;\n            var colWidth = (typeof width === 'number') ? width + 'px' : width;\n            colIndex = isNullOrUndefined(colIndex) ? getCellIndexes(sheet.activeCell)[1] : colIndex;\n            if (sheet === this.getActiveSheet()) {\n                if (colIndex >= this.viewport.leftIndex && colIndex <= lastIdx) {\n                    if (this.scrollSettings.enableVirtualization) {\n                        colIndex = colIndex - this.viewport.leftIndex;\n                    }\n                    var trgt = this.getColumnHeaderContent().getElementsByClassName('e-header-cell')[colIndex];\n                    var eleWidth = parseInt(this.getMainContent().getElementsByTagName('col')[colIndex].style.width, 10);\n                    var threshold = parseInt(colWidth, 10) - eleWidth;\n                    if (threshold < 0 && eleWidth < -(threshold)) {\n                        getCellIndexes(sheet.activeCell);\n                        threshold = -eleWidth;\n                    }\n                    var oldIdx = parseInt(trgt.getAttribute('aria-colindex'), 10) - 1;\n                    if (this.getActiveSheet() === sheet) {\n                        this.notify(colWidthChanged, { threshold: threshold, colIdx: oldIdx });\n                        setResize(colIndex, colWidth, true, this);\n                    }\n                }\n                else {\n                    var oldWidth = getColumnWidth(sheet, colIndex);\n                    var threshold = void 0;\n                    if (parseInt(colWidth, 10) > 0) {\n                        threshold = -(oldWidth - parseInt(colWidth, 10));\n                    }\n                    else {\n                        threshold = -oldWidth;\n                    }\n                    this.notify(colWidthChanged, { threshold: threshold, colIdx: colIndex });\n                }\n            }\n            getColumn(sheet, mIndex).width = parseInt(colWidth, 10) > 0 ? parseInt(colWidth, 10) : 0;\n            sheet.columns[mIndex].customWidth = true;\n        }\n    };\n    /**\n     * Set the height of row.\n     * {% codeBlock src='spreadsheet/setRowHeight/index.md' %}{% endcodeBlock %}\n     * @param {number} height? - Specifies height needs to be updated. If not specified, it will set the default height 20.\n     * @param {number} rowIndex? - Specifies the row index. If not specified, it will consider the first row.\n     * @param {number} sheetIndex? - Specifies the sheetIndex. If not specified, it will consider the active sheet.\n     */\n    Spreadsheet.prototype.setRowHeight = function (height, rowIndex, sheetIndex, edited) {\n        if (height === void 0) { height = 20; }\n        if (rowIndex === void 0) { rowIndex = 0; }\n        var sheet = isNullOrUndefined(sheetIndex) ? this.getActiveSheet() : this.sheets[sheetIndex - 1];\n        if (sheet) {\n            var mIndex = rowIndex;\n            var rowHeight = (typeof height === 'number') ? height + 'px' : height;\n            rowIndex = isNullOrUndefined(rowIndex) ? getCellIndexes(sheet.activeCell)[0] : rowIndex;\n            if (sheet === this.getActiveSheet()) {\n                if (rowIndex <= this.viewport.bottomIndex && rowIndex >= this.viewport.topIndex) {\n                    if (this.scrollSettings.enableVirtualization) {\n                        rowIndex = rowIndex - this.viewport.topIndex;\n                    }\n                    var trgt = this.getRowHeaderContent().getElementsByClassName('e-header-cell')[rowIndex];\n                    var eleHeight = parseInt(this.getMainContent().getElementsByTagName('tr')[rowIndex].style.height, 10);\n                    var threshold = parseInt(rowHeight, 10) - eleHeight;\n                    if (threshold < 0 && eleHeight < -(threshold)) {\n                        threshold = -eleHeight;\n                    }\n                    var oldIdx = parseInt(trgt.parentElement.getAttribute('aria-rowindex'), 10) - 1;\n                    if (this.getActiveSheet() === sheet) {\n                        this.notify(rowHeightChanged, { threshold: threshold, rowIdx: oldIdx });\n                        if (isNullOrUndefined(edited)) {\n                            edited = false;\n                        }\n                        if (!edited) {\n                            setResize(rowIndex, rowHeight, false, this);\n                            edited = false;\n                        }\n                    }\n                }\n                else {\n                    var oldHeight = getRowHeight(sheet, rowIndex);\n                    var threshold = void 0;\n                    if (parseInt(rowHeight, 10) > 0) {\n                        threshold = -(oldHeight - parseInt(rowHeight, 10));\n                    }\n                    else {\n                        threshold = -oldHeight;\n                    }\n                    this.notify(rowHeightChanged, { threshold: threshold, rowIdx: rowIndex });\n                }\n            }\n            setRowHeight(sheet, mIndex, parseInt(rowHeight, 10) > 0 ? parseInt(rowHeight, 10) : 0);\n            sheet.rows[mIndex].customHeight = true;\n        }\n    };\n    /**\n     * This method is used to autofit the range of rows or columns\n     * {% codeBlock src='spreadsheet/autoFit/index.md' %}{% endcodeBlock %}\n     * @param {string} range - range that needs to be autofit.\n     *\n     * ```html\n     * <div id='Spreadsheet'></div>\n     * ```\n     * ```typescript\n     * let spreadsheet = new Spreadsheet({\n     *      allowResizing: true\n     * ...\n     * }, '#Spreadsheet');\n     * spreadsheet.autoFit('A:D'); // Auto fit from A to D columns\n     * Spreadsheet.autoFit('1:4'); // Auto fit from 1 to 4 rows\n     *\n     * ```\n     */\n    Spreadsheet.prototype.autoFit = function (range) {\n        var values = this.getIndexes(range);\n        var startIdx = values.startIdx;\n        var endIdx = values.endIdx;\n        var isCol = values.isCol;\n        var maximumColInx = isCol ? getColIndex('XFD') : 1048576;\n        if (startIdx <= maximumColInx) {\n            if (endIdx > maximumColInx) {\n                endIdx = maximumColInx;\n            }\n        }\n        else {\n            return;\n        }\n        for (startIdx; startIdx <= endIdx; startIdx++) {\n            this.notify(setAutoFit, { idx: startIdx, isCol: isCol });\n        }\n    };\n    /** @hidden */\n    Spreadsheet.prototype.getIndexes = function (range) {\n        var startIsCol;\n        var endIsCol;\n        var start;\n        var end;\n        var isCol;\n        if (range.indexOf(':') !== -1) {\n            var starttoend = range.split(':');\n            start = starttoend[0];\n            end = starttoend[1];\n        }\n        else {\n            start = range;\n            end = range;\n        }\n        if (!isNullOrUndefined(start)) {\n            var startValues = this.getAddress(start);\n            start = startValues.address;\n            startIsCol = startValues.isCol;\n        }\n        if (!isNullOrUndefined(end)) {\n            var endValues = this.getAddress(end);\n            end = endValues.address;\n            endIsCol = endValues.isCol;\n        }\n        isCol = startIsCol === true && endIsCol === true ? true : false;\n        var startIdx = isCol ? getColIndex(start.toUpperCase()) : parseInt(start, 10);\n        var endIdx = isCol ? getColIndex(end.toUpperCase()) : parseInt(end, 10);\n        return { startIdx: startIdx, endIdx: endIdx, isCol: isCol };\n    };\n    Spreadsheet.prototype.getAddress = function (address) {\n        var isCol;\n        if (address.substring(0, 1).match(/\\D/g)) {\n            isCol = true;\n            address = address.replace(/[0-9]/g, '');\n            return { address: address, isCol: isCol };\n        }\n        else if (address.substring(0, 1).match(/[0-9]/g) && address.match(/\\D/g)) {\n            return { address: '', isCol: false };\n        }\n        else {\n            address = (parseInt(address, 10) - 1).toString();\n            return { address: address, isCol: isCol };\n        }\n    };\n    /**\n     * To add the hyperlink in the cell\n     * {% codeBlock src='spreadsheet/addHyperlink/index.md' %}{% endcodeBlock %}\n     * @param {string | HyperlinkModel} hyperlink\n     * @param {string} address\n     */\n    Spreadsheet.prototype.addHyperlink = function (hyperlink, address) {\n        this.insertHyperlink(hyperlink, address, '', true);\n    };\n    /**\n     * To remove the hyperlink in the cell\n     * {% codeBlock src='spreadsheet/removeHyperlink/index.md' %}{% endcodeBlock %}\n     * @param {string} range\n     */\n    Spreadsheet.prototype.removeHyperlink = function (range) {\n        var rangeArr;\n        var sheet = this.getActiveSheet();\n        var sheetIdx;\n        if (range && range.indexOf('!') !== -1) {\n            rangeArr = range.split('!');\n            var sheets = this.sheets;\n            for (var idx = 0; idx < sheets.length; idx++) {\n                if (sheets[idx].name === rangeArr[0]) {\n                    sheetIdx = idx;\n                }\n            }\n            sheet = this.sheets[sheetIdx];\n            range = rangeArr[1];\n        }\n        var rangeIndexes = range ? getRangeIndexes(range) : getRangeIndexes(this.getActiveSheet().activeCell);\n        var cellMod;\n        for (var rowIdx = rangeIndexes[0]; rowIdx <= rangeIndexes[2]; rowIdx++) {\n            for (var colIdx = rangeIndexes[1]; colIdx <= rangeIndexes[3]; colIdx++) {\n                if (sheet && sheet.rows[rowIdx] && sheet.rows[rowIdx].cells[colIdx]) {\n                    cellMod = sheet.rows[rowIdx].cells[colIdx];\n                    if (cellMod) {\n                        if (typeof (cellMod.hyperlink) === 'string') {\n                            cellMod.value = cellMod.value ? cellMod.value : cellMod.hyperlink;\n                        }\n                        else {\n                            cellMod.value = cellMod.value ? cellMod.value : cellMod.hyperlink.address;\n                        }\n                        delete (cellMod.hyperlink);\n                        if (sheet === this.getActiveSheet()) {\n                            var eleRowIdx = void 0;\n                            var eleColIdx = void 0;\n                            if (this.scrollSettings.enableVirtualization) {\n                                eleRowIdx = rowIdx - this.viewport.topIndex;\n                                eleColIdx = colIdx - this.viewport.leftIndex;\n                            }\n                            var cell = this.element.getElementsByClassName('e-sheet-content')[0].\n                                getElementsByClassName('e-row')[eleRowIdx].getElementsByClassName('e-cell')[eleColIdx];\n                            if (cell.getElementsByClassName('e-hyperlink')[0]) {\n                                cell.innerText = cell.getElementsByClassName('e-hyperlink')[0].innerHTML;\n                            }\n                        }\n                    }\n                }\n            }\n        }\n    };\n    /** @hidden */\n    Spreadsheet.prototype.insertHyperlink = function (hyperlink, address, displayText, isMethod) {\n        if (this.allowHyperlink) {\n            var value = void 0;\n            var addrRange = void 0;\n            var sheetIdx = void 0;\n            var cellIdx = void 0;\n            var sheet = this.getActiveSheet();\n            var isEmpty = void 0;\n            address = address ? address : this.getActiveSheet().activeCell;\n            var befArgs = { hyperlink: hyperlink, cell: address, cancel: false };\n            var aftArgs = { hyperlink: hyperlink, cell: address };\n            if (!isMethod) {\n                this.trigger(beforeHyperlinkCreate, befArgs);\n            }\n            if (!befArgs.cancel) {\n                hyperlink = befArgs.hyperlink;\n                address = befArgs.cell;\n                _super.prototype.addHyperlink.call(this, hyperlink, address);\n                if (address && address.indexOf('!') !== -1) {\n                    addrRange = address.split('!');\n                    var sheets = this.sheets;\n                    for (var idx = 0; idx < sheets.length; idx++) {\n                        if (sheets[idx].name === addrRange[0]) {\n                            sheetIdx = idx;\n                        }\n                    }\n                    sheet = this.sheets[sheetIdx];\n                    address = addrRange[1];\n                }\n                if (!sheet) {\n                    return;\n                }\n                address = address ? address : this.getActiveSheet().activeCell;\n                cellIdx = getRangeIndexes(address);\n                if (typeof (hyperlink) === 'string') {\n                    value = hyperlink;\n                }\n                else {\n                    value = hyperlink.address;\n                }\n                var mCell = sheet.rows[cellIdx[0]].cells[cellIdx[1]];\n                if (isNullOrUndefined(mCell.value) || mCell.value === '') {\n                    isEmpty = true;\n                }\n                if (!isMethod) {\n                    this.trigger(afterHyperlinkCreate, aftArgs);\n                }\n                if (sheet === this.getActiveSheet()) {\n                    this.serviceLocator.getService('cell').refreshRange(cellIdx);\n                }\n            }\n        }\n    };\n    /**\n     * This method is used to add data validation.\n     * {% codeBlock src='spreadsheet/addDataValidation/index.md' %}{% endcodeBlock %}\n     * @param {ValidationModel} rules - specifies the validation rules.\n     * @param {string} range - range that needs to be add validation.\n     */\n    Spreadsheet.prototype.addDataValidation = function (rules, range) {\n        _super.prototype.addDataValidation.call(this, rules, range);\n    };\n    /**\n     * This method is used for remove validation.\n     * {% codeBlock src='spreadsheet/removeDataValidation/index.md' %}{% endcodeBlock %}\n     * @param {string} range - range that needs to be remove validation.\n     */\n    Spreadsheet.prototype.removeDataValidation = function (range) {\n        _super.prototype.removeDataValidation.call(this, range);\n    };\n    /**\n     * This method is used to highlight the invalid data.\n     * {% codeBlock src='spreadsheet/addInvalidHighlight/index.md' %}{% endcodeBlock %}\n     * @param {string} range - range that needs to be highlight the invalid data.\n     */\n    Spreadsheet.prototype.addInvalidHighlight = function (range) {\n        _super.prototype.addInvalidHighlight.call(this, range);\n    };\n    /**\n     * This method is used for remove highlight from invalid data.\n     * {% codeBlock src='spreadsheet/removeInvalidHighlight/index.md' %}{% endcodeBlock %}\n     * @param {string} range - range that needs to be remove invalid highlight.\n     */\n    Spreadsheet.prototype.removeInvalidHighlight = function (range) {\n        _super.prototype.removeInvalidHighlight.call(this, range);\n    };\n    /**\n     * This method is used to add conditional formatting.\n     * {% codeBlock src='spreadsheet/conditionalFormat/index.md' %}{% endcodeBlock %}\n     * @param  {string} type - Conditional formatting HighlightCell, TopBottom, DataBar, ColorScale, IconSet Type.\n     * HighlightCell- 'GreaterThan' | 'LessThan' | 'Between' | 'EqualTo' | 'ContainsText' | 'DateOccur' | 'Duplicate' | 'Unique',\n     * TopBottom - 'Top10Items' | 'Bottom10Items' | 'Top10Percentage' | 'Bottom10Percentage' | 'BelowAverage' | 'AboveAverage',\n     * DataBar - 'BlueDataBar' | 'GreenDataBar' | 'RedDataBar' | 'OrangeDataBar' | 'LightBlueDataBar' | 'PurpleDataBar',\n     * ColorScale - 'GYRColorScale' | 'RYGColorScale' | 'GWRColorScale' | 'RWGColorScale' | 'BWRColorScale' | 'RWBColorScale' |\n     * 'WRColorScale' | 'RWColorScale' | 'GWColorScale' | 'WGColorScale' | 'GYColorScale' | 'YGColorScale',\n     * IconSet - 'ThreeArrows' | 'ThreeArrowsGray' | 'FourArrowsGray' | 'FourArrows' | 'FiveArrowsGray' | 'FiveArrows' |\n     * 'ThreeTrafficLights1' | 'ThreeTrafficLights2' | 'ThreeSigns' | 'FourTrafficLights' | 'FourRedToBlack' | 'ThreeSymbols' |\n     * 'ThreeSymbols2' | 'ThreeFlags' | 'FourRating' | 'FiveQuarters' | 'FiveRating' | 'ThreeTriangles' | 'ThreeStars' | 'FiveBoxes';\n     * @param  {string} cFColor - Pass the cFcolor to set the conditional formatting.\n     * CFColor - 'RedFT' | 'YellowFT' | 'GreenFT' | 'RedF' | 'RedT'.\n     * @param  {string} value - Pass the value to set the conditional formatting.\n     * @param  {string} range - Pass the range to set the conditional formatting.\n     */\n    Spreadsheet.prototype.conditionalFormat = function (conditionalFormat) {\n        _super.prototype.conditionalFormat.call(this, conditionalFormat);\n    };\n    /**\n     * This method is used for remove conditional formatting.\n     * {% codeBlock src='spreadsheet/clearConditionalFormat/index.md' %}{% endcodeBlock %}\n     * @param {string} range - range that needs to be remove conditional formatting.\n     */\n    Spreadsheet.prototype.clearConditionalFormat = function (range) {\n        range = range || this.getActiveSheet().selectedRange;\n        _super.prototype.clearConditionalFormat.call(this, range);\n    };\n    /** @hidden */\n    Spreadsheet.prototype.setPanelSize = function () {\n        if (this.height !== 'auto') {\n            var panel = document.getElementById(this.element.id + '_sheet_panel');\n            panel.style.height = this.element.getBoundingClientRect().height - getSiblingsHeight(panel) + \"px\";\n        }\n    };\n    /**\n     * Opens the Excel file.\n     * {% codeBlock src='spreadsheet/open/index.md' %}{% endcodeBlock %}\n     * @param {OpenOptions} options - Options for opening the excel file.\n     */\n    Spreadsheet.prototype.open = function (options) {\n        this.isOpen = true;\n        _super.prototype.open.call(this, options);\n        if (this.isOpen) {\n            this.showSpinner();\n        }\n    };\n    /** @hidden */\n    Spreadsheet.prototype.hideRow = function (startIndex, endIndex, hide) {\n        if (endIndex === void 0) { endIndex = startIndex; }\n        if (hide === void 0) { hide = true; }\n        if (this.renderModule) {\n            this.notify(hideShow, { startIndex: startIndex, endIndex: endIndex, hide: hide });\n        }\n        else {\n            _super.prototype.hideRow.call(this, startIndex, endIndex, hide);\n        }\n    };\n    /** @hidden */\n    Spreadsheet.prototype.hideColumn = function (startIndex, endIndex, hide) {\n        if (endIndex === void 0) { endIndex = startIndex; }\n        if (hide === void 0) { hide = true; }\n        if (this.renderModule) {\n            this.notify(hideShow, { startIndex: startIndex, endIndex: endIndex, hide: hide, isCol: true });\n        }\n        else {\n            _super.prototype.hideColumn.call(this, startIndex, endIndex, hide);\n        }\n    };\n    /**\n     * This method is used to Clear contents, formats and hyperlinks in spreadsheet.\n     * {% codeBlock src='spreadsheet/clear/index.md' %}{% endcodeBlock %}\n     *    * @param {ClearOptions} options - Options for clearing the content, formats and hyperlinks in spreadsheet.\n     */\n    Spreadsheet.prototype.clear = function (options) {\n        this.notify(clearViewer, { options: options, isPublic: true });\n    };\n    /**\n     * Used to refresh the spreadsheet.\n     * {% codeBlock src='spreadsheet/refresh/index.md' %}{% endcodeBlock %}\n     * @param {boolean} isNew - Specifies `true` / `false` to create new workbook in spreadsheet.\n     * @returns void\n     */\n    Spreadsheet.prototype.refresh = function (isNew) {\n        if (this[isReact]) {\n            this[clearTemplate]();\n        }\n        (isNew) ? this.notify(blankWorkbook, {}) : _super.prototype.refresh.call(this);\n    };\n    /**\n     * Used to set the image in spreadsheet.\n     * {% codeBlock src='spreadsheet/insertImage/index.md' %}{% endcodeBlock %}\n     * @param {ImageModel} images - Specifies the options to insert image in spreadsheet.\n     * @param {string} range - Specifies the range in spreadsheet.\n     * @returns void\n     */\n    Spreadsheet.prototype.insertImage = function (images, range) {\n        var i;\n        for (i = 0; i < images.length; i++) {\n            this.notify(createImageElement, {\n                options: images[i],\n                range: range ? range : this.getActiveSheet().selectedRange, isPublic: true\n            });\n        }\n    };\n    /**\n     * Used to delete the image in spreadsheet.\n     * {% codeBlock src='spreadsheet/deleteImage/index.md' %}{% endcodeBlock %}\n     * @param {string} id - Specifies the id of the image element to be deleted.\n     * @param {string} range - Specifies the range in spreadsheet.\n     * @returns void\n     */\n    Spreadsheet.prototype.deleteImage = function (id, range) {\n        this.notify(deleteImage, { id: id, range: range ? range : this.getActiveSheet().selectedRange });\n    };\n    /**\n     * Gets the row header div of the Spreadsheet.\n     * @return {Element}\n     * @hidden\n     */\n    Spreadsheet.prototype.getRowHeaderContent = function () {\n        return this.sheetModule.getRowHeaderPanel();\n    };\n    /**\n     * Gets the column header div of the Spreadsheet.\n     * @return {Element}\n     * @hidden\n     */\n    Spreadsheet.prototype.getColumnHeaderContent = function () {\n        return this.sheetModule.getColHeaderPanel();\n    };\n    /**\n     * Gets the main content div of the Spreadsheet.\n     * @return {Element}\n     * @hidden\n     */\n    Spreadsheet.prototype.getMainContent = function () {\n        return this.sheetModule.getContentPanel();\n    };\n    /**\n     * Get the main content table element of spreadsheet.\n     * @return {HTMLTableElement}\n     * @hidden\n     */\n    Spreadsheet.prototype.getContentTable = function () {\n        return this.sheetModule.getContentTable();\n    };\n    /**\n     * Get the row header table element of spreadsheet.\n     * @return {HTMLTableElement}\n     * @hidden\n     */\n    Spreadsheet.prototype.getRowHeaderTable = function () {\n        return this.sheetModule.getRowHeaderTable();\n    };\n    /**\n     * Get the column header table element of spreadsheet.\n     * @return {HTMLTableElement}\n     * @hidden\n     */\n    Spreadsheet.prototype.getColHeaderTable = function () {\n        return this.sheetModule.getColHeaderTable();\n    };\n    /**\n     * To get the backup element count for row and column virtualization.\n     * @hidden\n     */\n    Spreadsheet.prototype.getThreshold = function (layout) {\n        var threshold = Math.round((this.viewport[layout + 'Count'] + 1) / 2);\n        return threshold < 15 ? 15 : threshold;\n    };\n    /** @hidden */\n    Spreadsheet.prototype.isMobileView = function () {\n        return ((this.cssClass.indexOf('e-mobile-view') > -1 || Browser.isDevice) && this.cssClass.indexOf('e-desktop-view') === -1)\n            && false;\n    };\n    /** @hidden */\n    Spreadsheet.prototype.getValueRowCol = function (sheetIndex, rowIndex, colIndex) {\n        var val = _super.prototype.getValueRowCol.call(this, sheetIndex, rowIndex, colIndex);\n        return val;\n    };\n    /**\n     * To update a cell properties.\n     * {% codeBlock src='spreadsheet/updateCell/index.md' %}{% endcodeBlock %}\n     * @param {CellModel} cell - Cell properties.\n     * @param {string} address - Address to update.\n     */\n    Spreadsheet.prototype.updateCell = function (cell, address) {\n        address = address || this.getActiveSheet().activeCell;\n        _super.prototype.updateCell.call(this, cell, address);\n        this.serviceLocator.getService('cell').refreshRange(getIndexesFromAddress(address));\n        this.notify(activeCellChanged, null);\n    };\n    /**\n     * Sorts the range of cells in the active sheet.\n     * {% codeBlock src='spreadsheet/sort/index.md' %}{% endcodeBlock %}\n     * @param sortOptions - options for sorting.\n     * @param range - address of the data range.\n     */\n    Spreadsheet.prototype.sort = function (sortOptions, range) {\n        var _this = this;\n        if (!this.allowSorting) {\n            return Promise.reject();\n        }\n        return _super.prototype.sort.call(this, sortOptions, range).then(function (args) {\n            _this.notify(sortComplete, args);\n            return Promise.resolve(args);\n        });\n    };\n    /** @hidden */\n    Spreadsheet.prototype.setValueRowCol = function (sheetIndex, value, rowIndex, colIndex) {\n        if (value === 'circular reference: ') {\n            var circularArgs = {\n                action: 'isCircularReference', argValue: value\n            };\n            this.notify(formulaOperation, circularArgs);\n            value = circularArgs.argValue;\n        }\n        _super.prototype.setValueRowCol.call(this, sheetIndex, value, rowIndex, colIndex);\n        sheetIndex = getSheetIndexFromId(this, sheetIndex);\n        this.notify(editOperation, {\n            action: 'refreshDependentCellValue', rowIdx: rowIndex, colIdx: colIndex,\n            sheetIdx: sheetIndex\n        });\n    };\n    /**\n     * Get component name.\n     * @returns string\n     * @hidden\n     */\n    Spreadsheet.prototype.getModuleName = function () {\n        return 'spreadsheet';\n    };\n    /** @hidden */\n    Spreadsheet.prototype.refreshNode = function (td, args) {\n        var value;\n        if (td) {\n            var spanElem = select('#' + this.element.id + '_currency', td);\n            var alignClass = 'e-right-align';\n            if (args) {\n                args.result = isNullOrUndefined(args.result) ? '' : args.result.toString();\n                if (spanElem) {\n                    detach(spanElem);\n                }\n                if (args.type === 'Accounting' && isNumber(args.value)) {\n                    if (td.querySelector('a')) {\n                        td.querySelector('a').textContent = args.result.split(args.curSymbol).join('');\n                    }\n                    else {\n                        td.innerHTML = '';\n                    }\n                    td.appendChild(this.createElement('span', {\n                        id: this.element.id + '_currency',\n                        innerHTML: \"\" + args.curSymbol,\n                        styles: 'float: left'\n                    }));\n                    if (!td.querySelector('a')) {\n                        td.innerHTML += args.result.split(args.curSymbol).join('');\n                    }\n                    td.classList.add(alignClass);\n                    return;\n                }\n                else {\n                    if (args.result && (args.result.toLowerCase() === 'true' || args.result.toLowerCase() === 'false')) {\n                        args.result = args.result.toUpperCase();\n                        alignClass = 'e-center-align';\n                        args.isRightAlign = true; // Re-use this to center align the cell.\n                    }\n                    value = args.result;\n                }\n                args.isRightAlign ? td.classList.add(alignClass) : td.classList.remove(alignClass);\n            }\n            value = !isNullOrUndefined(value) ? value : '';\n            if (!isNullOrUndefined(td)) {\n                var node = td.lastChild;\n                if (td.querySelector('.e-hyperlink')) {\n                    node = td.querySelector('.e-hyperlink').lastChild;\n                }\n                if (node && (node.nodeType === 3 || node.nodeType === 1)) {\n                    node.nodeValue = value;\n                }\n                else {\n                    td.appendChild(document.createTextNode(value));\n                }\n            }\n        }\n    };\n    /** @hidden */\n    Spreadsheet.prototype.calculateHeight = function (style, lines, borderWidth) {\n        if (lines === void 0) { lines = 1; }\n        if (borderWidth === void 0) { borderWidth = 1; }\n        var fontSize = (style && style.fontSize) || this.cellStyle.fontSize;\n        var threshold = style.fontFamily === 'Arial Black' ? 1.44 : 1.24;\n        return ((fontSize.indexOf('pt') > -1 ? parseInt(fontSize, 10) * 1.33 : parseInt(fontSize, 10)) * threshold * lines) +\n            (borderWidth * threshold);\n    };\n    /** @hidden */\n    Spreadsheet.prototype.skipHidden = function (startIdx, endIdx, layout) {\n        if (layout === void 0) { layout = 'rows'; }\n        var sheet = this.getActiveSheet();\n        var totalCount;\n        if (this.scrollSettings.isFinite) {\n            totalCount = (layout === 'rows' ? sheet.rowCount : sheet.colCount) - 1;\n        }\n        for (var i = startIdx; i <= endIdx; i++) {\n            if ((sheet[layout])[i] && (sheet[layout])[i].hidden) {\n                if (startIdx === i) {\n                    startIdx++;\n                }\n                endIdx++;\n                if (totalCount && endIdx > totalCount) {\n                    endIdx = totalCount;\n                    break;\n                }\n            }\n        }\n        return [startIdx, endIdx];\n    };\n    /** @hidden */\n    Spreadsheet.prototype.updateActiveBorder = function (nextTab, selector) {\n        if (selector === void 0) { selector = '.e-ribbon'; }\n        var indicator = select(selector + \" .e-tab-header .e-indicator\", this.element);\n        indicator.style.display = 'none';\n        setStyleAttribute(indicator, { 'left': '', 'right': '' });\n        setStyleAttribute(indicator, {\n            'left': nextTab.offsetLeft + 'px', 'right': nextTab.parentElement.offsetWidth - (nextTab.offsetLeft + nextTab.offsetWidth) + 'px'\n        });\n        indicator.style.display = '';\n    };\n    /**\n     * To perform the undo operation in spreadsheet.\n     * {% codeBlock src='spreadsheet/undo/index.md' %}{% endcodeBlock %}\n     */\n    Spreadsheet.prototype.undo = function () {\n        this.notify(performUndoRedo, { isUndo: true, isPublic: true });\n    };\n    /**\n     * To perform the redo operation in spreadsheet.\n     * {% codeBlock src='spreadsheet/redo/index.md' %}{% endcodeBlock %}\n     */\n    Spreadsheet.prototype.redo = function () {\n        this.notify(performUndoRedo, { isUndo: false, isPublic: true });\n    };\n    /**\n     * To update the undo redo collection in spreadsheet.\n     * {% codeBlock src='spreadsheet/updateUndoRedoCollection/index.md' %}{% endcodeBlock %}\n     * @param {object} args - options for undo redo.\n     */\n    Spreadsheet.prototype.updateUndoRedoCollection = function (args) {\n        this.notify(updateUndoRedoCollection, { args: args, isPublic: true });\n    };\n    /**\n     * Adds the defined name to the Spreadsheet.\n     * {% codeBlock src='spreadsheet/addDefinedName/index.md' %}{% endcodeBlock %}\n     * @param {DefineNameModel} definedName - Specifies the name.\n     * @return {boolean} - Return the added status of the defined name.\n     */\n    Spreadsheet.prototype.addDefinedName = function (definedName) {\n        var eventArgs = {\n            action: 'addDefinedName',\n            isAdded: false,\n            definedName: definedName\n        };\n        this.notify(formulaOperation, eventArgs);\n        return eventArgs.isAdded;\n    };\n    /**\n     * Removes the defined name from the Spreadsheet.\n     * {% codeBlock src='spreadsheet/removeDefinedName/index.md' %}{% endcodeBlock %}\n     * @param {string} definedName - Specifies the name.\n     * @param {string} scope - Specifies the scope of the defined name.\n     * @return {boolean} - Return the removed status of the defined name.\n     */\n    Spreadsheet.prototype.removeDefinedName = function (definedName, scope) {\n        return _super.prototype.removeDefinedName.call(this, definedName, scope);\n    };\n    Spreadsheet.prototype.mouseClickHandler = function (e) {\n        this.notify(click, e);\n    };\n    Spreadsheet.prototype.mouseDownHandler = function (e) {\n        this.notify(mouseDown, e);\n    };\n    Spreadsheet.prototype.keyUpHandler = function (e) {\n        if (closest(e.target, '.e-find-dlg')) {\n            this.notify(findKeyUp, e);\n        }\n        else {\n            this.notify(keyUp, e);\n        }\n    };\n    Spreadsheet.prototype.keyDownHandler = function (e) {\n        if (!closest(e.target, '.e-findtool-dlg')) {\n            this.notify(keyDown, e);\n        }\n    };\n    /**\n     * Binding events to the element while component creation.\n     */\n    Spreadsheet.prototype.wireEvents = function () {\n        EventHandler.add(this.element, 'click', this.mouseClickHandler, this);\n        EventHandler.add(this.element, getStartEvent(), this.mouseDownHandler, this);\n        EventHandler.add(this.element, 'keyup', this.keyUpHandler, this);\n        EventHandler.add(this.element, 'keydown', this.keyDownHandler, this);\n        EventHandler.add(this.element, 'noderefresh', this.refreshNode, this);\n    };\n    /**\n     * Destroys the component (detaches/removes all event handlers, attributes, classes, and empties the component element).\n     */\n    Spreadsheet.prototype.destroy = function () {\n        if (this[isReact]) {\n            this[clearTemplate]();\n        }\n        this.unwireEvents();\n        this.notify(spreadsheetDestroyed, null);\n        _super.prototype.destroy.call(this);\n        this.element.innerHTML = '';\n        this.element.removeAttribute('tabindex');\n        this.element.removeAttribute('role');\n        this.element.style.removeProperty('height');\n        this.element.style.removeProperty('width');\n        this.element.style.removeProperty('min-height');\n        this.element.style.removeProperty('min-width');\n    };\n    /**\n     * Unbinding events from the element while component destroy.\n     */\n    Spreadsheet.prototype.unwireEvents = function () {\n        EventHandler.remove(this.element, 'click', this.mouseClickHandler);\n        EventHandler.remove(this.element, getStartEvent(), this.mouseDownHandler);\n        EventHandler.remove(this.element, 'keyup', this.keyUpHandler);\n        EventHandler.remove(this.element, 'keydown', this.keyDownHandler);\n        EventHandler.remove(this.element, 'noderefresh', this.refreshNode);\n    };\n    /**\n     * To add context menu items.\n     * {% codeBlock src='spreadsheet/addContextMenu/index.md' %}{% endcodeBlock %}\n     * @param {MenuItemModel[]} items - Items that needs to be added.\n     * @param {string} text - Item before / after that the element to be inserted.\n     * @param {boolean} insertAfter - Set `false` if the `items` need to be inserted before the `text`.\n     * By default, `items` are added after the `text`.\n     * @param {boolean} isUniqueId - Set `true` if the given `text` is a unique id.\n     */\n    Spreadsheet.prototype.addContextMenuItems = function (items, text, insertAfter, isUniqueId) {\n        if (insertAfter === void 0) { insertAfter = true; }\n        this.notify(addContextMenuItems, { items: items, text: text, insertAfter: insertAfter, isUniqueId: isUniqueId });\n    };\n    /**\n     * To remove existing context menu items.\n     * {% codeBlock src='spreadsheet/removeContextMenuItems/index.md' %}{% endcodeBlock %}\n     * @param {string[]} items - Items that needs to be removed.\n     * @param {boolean} isUniqueId - Set `true` if the given `text` is a unique id.\n     */\n    Spreadsheet.prototype.removeContextMenuItems = function (items, isUniqueId) {\n        this.notify(removeContextMenuItems, { items: items, isUniqueId: isUniqueId });\n    };\n    /**\n     * To enable / disable context menu items.\n     * {% codeBlock src='spreadsheet/enableContextMenuItems/index.md' %}{% endcodeBlock %}\n     * @param {string[]} items - Items that needs to be enabled / disabled.\n     * @param {boolean} enable - Set `true` / `false` to enable / disable the menu items.\n     * @param {boolean} isUniqueId - Set `true` if the given `text` is a unique id.\n     */\n    Spreadsheet.prototype.enableContextMenuItems = function (items, enable, isUniqueId) {\n        if (enable === void 0) { enable = true; }\n        this.notify(enableContextMenuItems, { items: items, enable: enable, isUniqueId: isUniqueId });\n    };\n    /**\n     * To enable / disable file menu items.\n     * {% codeBlock src='spreadsheet/enableFileMenuItems/index.md' %}{% endcodeBlock %}\n     * @param {string[]} items - Items that needs to be enabled / disabled.\n     * @param {boolean} enable? - Set `true` / `false` to enable / disable the menu items.\n     * @param {boolean} isUniqueId? - Set `true` if the given file menu items `text` is a unique id.\n     * @returns void.\n     */\n    Spreadsheet.prototype.enableFileMenuItems = function (items, enable, isUniqueId) {\n        if (enable === void 0) { enable = true; }\n        this.notify(enableFileMenuItems, { items: items, enable: enable, isUniqueId: isUniqueId });\n    };\n    /**\n     * To show/hide the file menu items in Spreadsheet ribbon.\n     * {% codeBlock src='spreadsheet/hideFileMenuItems/index.md' %}{% endcodeBlock %}\n     * @param {string[]} items - Specifies the file menu items text which is to be show/hide.\n     * @param {boolean} hide? - Set `true` / `false` to hide / show the file menu items.\n     * @param {boolean} isUniqueId? - Set `true` if the given file menu items `text` is a unique id.\n     * @returns void.\n     */\n    Spreadsheet.prototype.hideFileMenuItems = function (items, hide, isUniqueId) {\n        if (hide === void 0) { hide = true; }\n        this.notify(hideFileMenuItems, { items: items, hide: hide, isUniqueId: isUniqueId });\n    };\n    /**\n     * To add custom file menu items.\n     * {% codeBlock src='spreadsheet/addFileMenuItems/index.md' %}{% endcodeBlock %}\n     * @param {MenuItemModel[]} items - Specifies the ribbon file menu items to be inserted.\n     * @param {string} text - Specifies the existing file menu item text before / after which the new file menu items to be inserted.\n     * @param {boolean} insertAfter? - Set `false` if the `items` need to be inserted before the `text`.\n     * By default, `items` are added after the `text`.\n     * @param {boolean} isUniqueId? - Set `true` if the given file menu items `text` is a unique id.\n     * @returns void.\n     */\n    Spreadsheet.prototype.addFileMenuItems = function (items, text, insertAfter, isUniqueId) {\n        if (insertAfter === void 0) { insertAfter = true; }\n        this.notify(addFileMenuItems, { items: items, text: text, insertAfter: insertAfter, isUniqueId: isUniqueId });\n    };\n    /**\n     * To show/hide the existing ribbon tabs.\n     * {% codeBlock src='spreadsheet/hideRibbonTabs/index.md' %}{% endcodeBlock %}\n     * @param {string[]} tabs - Specifies the tab header text which needs to be shown/hidden.\n     * @param {boolean} hide? - Set `true` / `false` to hide / show the ribbon tabs.\n     * @returns void.\n     */\n    Spreadsheet.prototype.hideRibbonTabs = function (tabs, hide) {\n        if (hide === void 0) { hide = true; }\n        this.notify(hideRibbonTabs, { tabs: tabs, hide: hide });\n    };\n    /**\n     * To enable / disable the existing ribbon tabs.\n     * {% codeBlock src='spreadsheet/enableRibbonTabs/index.md' %}{% endcodeBlock %}\n     * @param {string[]} tabs - Specifies the tab header text which needs to be enabled / disabled.\n     * @param {boolean} enable? - Set `true` / `false` to enable / disable the ribbon tabs.\n     * @returns void.\n     */\n    Spreadsheet.prototype.enableRibbonTabs = function (tabs, enable) {\n        if (enable === void 0) { enable = true; }\n        this.notify(enableRibbonTabs, { tabs: tabs, enable: enable });\n    };\n    /**\n     * To add custom ribbon tabs.\n     * {% codeBlock src='spreadsheet/addRibbonTabs/index.md' %}{% endcodeBlock %}\n     * @param {RibbonItemModel[]} items - Specifies the ribbon tab items to be inserted.\n     * @param {string} insertBefore? - Specifies the existing ribbon header text before which the new tabs will be inserted.\n     * If not specified, the new tabs will be inserted at the end.\n     * @returns void.\n     */\n    Spreadsheet.prototype.addRibbonTabs = function (items, insertBefore) {\n        this.notify(addRibbonTabs, { items: items, insertBefore: insertBefore });\n    };\n    /**\n     * Enables or disables the specified ribbon toolbar items or all ribbon items.\n     * {% codeBlock src='spreadsheet/enableToolbarItems/index.md' %}{% endcodeBlock %}\n     * @param {string} tab - Specifies the ribbon tab header text under which the toolbar items need to be enabled / disabled.\n     * @param {string[]} items? - Specifies the toolbar item indexes / unique id's which needs to be enabled / disabled.\n     * If it is not specified the entire toolbar items will be enabled / disabled.\n     * @param  {boolean} enable? - Boolean value that determines whether the toolbar items should be enabled or disabled.\n     * @returns void.\n     */\n    Spreadsheet.prototype.enableToolbarItems = function (tab, items, enable) {\n        this.notify(enableToolbarItems, [{ tab: tab, items: items, enable: enable === undefined ? true : enable }]);\n    };\n    /**\n     * To show/hide the existing Spreadsheet ribbon toolbar items.\n     * {% codeBlock src='spreadsheet/hideToolbarItems/index.md' %}{% endcodeBlock %}\n     * @param {string} tab - Specifies the ribbon tab header text under which the specified items needs to be hidden / shown.\n     * @param {string[]} indexes - Specifies the toolbar indexes which needs to be shown/hidden from UI.\n     * @param {boolean} hide? - Set `true` / `false` to hide / show the toolbar items.\n     * @returns void.\n     */\n    Spreadsheet.prototype.hideToolbarItems = function (tab, indexes, hide) {\n        if (hide === void 0) { hide = true; }\n        this.notify(hideToolbarItems, { tab: tab, indexes: indexes, hide: hide });\n    };\n    /**\n     * To add the custom items in Spreadsheet ribbon toolbar.\n     * {% codeBlock src='spreadsheet/addToolbarItems/index.md' %}{% endcodeBlock %}\n     * @param {string} tab - Specifies the ribbon tab header text under which the specified items will be inserted.\n     * @param {ItemModel[]} items - Specifies the ribbon toolbar items that needs to be inserted.\n     * @param {number} index? - Specifies the index text before which the new items will be inserted.\n     * If not specified, the new items will be inserted at the end of the toolbar.\n     * @returns void.\n     */\n    Spreadsheet.prototype.addToolbarItems = function (tab, items, index) {\n        this.notify(addToolbarItems, { tab: tab, items: items, index: index });\n    };\n    /**\n     * Selects the cell / range of cells with specified address.\n     * {% codeBlock src='spreadsheet/selectRange/index.md' %}{% endcodeBlock %}\n     * @param {string} address - Specifies the range address.\n     */\n    Spreadsheet.prototype.selectRange = function (address) {\n        this.notify(selectRange, { indexes: getRangeIndexes(address) });\n    };\n    /**\n     * Start edit the active cell.\n     * {% codeBlock src='spreadsheet/startEdit/index.md' %}{% endcodeBlock %}\n     * @return {void}\n     */\n    Spreadsheet.prototype.startEdit = function () {\n        this.notify(editOperation, { action: 'startEdit', isNewValueEdit: false });\n    };\n    /**\n     * Cancels the edited state, this will not update any value in the cell.\n     * {% codeBlock src='spreadsheet/closeEdit/index.md' %}{% endcodeBlock %}\n     * @return {void}\n     */\n    Spreadsheet.prototype.closeEdit = function () {\n        this.notify(editOperation, { action: 'cancelEdit' });\n    };\n    /**\n     * If Spreadsheet is in editable state, you can save the cell by invoking endEdit.\n     * {% codeBlock src='spreadsheet/endEdit/index.md' %}{% endcodeBlock %}\n     * @return {void}\n     */\n    Spreadsheet.prototype.endEdit = function () {\n        this.notify(editOperation, { action: 'endEdit' });\n    };\n    /**\n     * Called internally if any of the property value changed.\n     * @param  {SpreadsheetModel} newProp\n     * @param  {SpreadsheetModel} oldProp\n     * @returns void\n     * @hidden\n     */\n    Spreadsheet.prototype.onPropertyChanged = function (newProp, oldProp) {\n        var _this = this;\n        _super.prototype.onPropertyChanged.call(this, newProp, oldProp);\n        for (var _i = 0, _a = Object.keys(newProp); _i < _a.length; _i++) {\n            var prop = _a[_i];\n            switch (prop) {\n                case 'enableRtl':\n                    newProp.enableRtl ? document.getElementById(this.element.id + '_sheet_panel').classList.add('e-rtl') :\n                        document.getElementById(this.element.id + '_sheet_panel').classList.remove('e-rtl');\n                    break;\n                case 'cssClass':\n                    if (oldProp.cssClass) {\n                        removeClass([this.element], oldProp.cssClass.split(' '));\n                    }\n                    if (newProp.cssClass) {\n                        addClass([this.element], newProp.cssClass.split(' '));\n                    }\n                    break;\n                case 'activeSheetIndex':\n                    this.renderModule.refreshSheet();\n                    this.notify(activeSheetChanged, { idx: newProp.activeSheetIndex });\n                    break;\n                case 'width':\n                    this.setWidth();\n                    this.resize();\n                    break;\n                case 'height':\n                    this.setHeight();\n                    this.resize();\n                    break;\n                case 'showRibbon':\n                    this.notify(ribbon, { uiUpdate: true });\n                    break;\n                case 'showFormulaBar':\n                    this.notify(formulaBar, { uiUpdate: true });\n                    break;\n                case 'showSheetTabs':\n                    this.notify(sheetTabs, null);\n                    break;\n                case 'cellStyle':\n                    this.renderModule.refreshSheet();\n                    break;\n                case 'allowEditing':\n                    if (this.allowEditing) {\n                        this.notify(editOperation, { action: 'renderEditor' });\n                    }\n                    break;\n                case 'sheets':\n                    // Object.keys(newProp.sheets).forEach((sheetIdx: string): void => {\n                    // if (this.activeSheetIndex === Number(sheetIdx)) {\n                    //     if (newProp.sheets[sheetIdx].showGridLines !== undefined) {\n                    //         this.notify(updateToggleItem, { props: 'GridLines', pos: 2 });\n                    //     }\n                    //     if (newProp.sheets[sheetIdx].showHeaders !== undefined) {\n                    //         this.sheetModule.showHideHeaders();\n                    //         this.notify(updateToggleItem, { props: 'Headers', pos: 0 });\n                    //     }\n                    // }\n                    // if (newProp.sheets[sheetIdx].name !== undefined) {\n                    //     this.notify(sheetNameUpdate, {\n                    //         items: this.element.querySelector('.e-sheet-tabs-items').children[sheetIdx],\n                    //         value: newProp.sheets[sheetIdx].name,\n                    //         idx: sheetIdx\n                    //     });\n                    // }\n                    // if (newProp.sheets[sheetIdx].range) {\n                    //     this.sheets[sheetIdx].range = newProp.sheets[sheetIdx].range;\n                    Object.keys(newProp.sheets).forEach(function (sheetIdx, index) {\n                        var sheet = newProp.sheets[sheetIdx];\n                        if (sheet.ranges && Object.keys(sheet.ranges).length) {\n                            var ranges_1 = Object.keys(sheet.ranges);\n                            var newRangeIdx_1;\n                            ranges_1.forEach(function (rangeIdx, idx) {\n                                if (!sheet.ranges[rangeIdx].info) {\n                                    newRangeIdx_1 = idx;\n                                }\n                            });\n                            ranges_1.forEach(function (rangeIdx, idx) {\n                                if (sheet.ranges[rangeIdx].dataSource && (isUndefined(newRangeIdx_1)\n                                    || (!isUndefined(newRangeIdx_1) && newRangeIdx_1 === idx))) {\n                                    _this.notify(dataSourceChanged, {\n                                        sheetIdx: sheetIdx, rangeIdx: rangeIdx,\n                                        isLastRange: ranges_1.length - 1 === idx\n                                    });\n                                }\n                            });\n                        }\n                        else {\n                            if (index === 0) {\n                                _this.renderModule.refreshSheet();\n                            }\n                            if (_this.showSheetTabs && sheet.name) {\n                                _this.notify(sheetNameUpdate, {\n                                    items: _this.element.querySelector('.e-sheet-tabs-items').children[sheetIdx],\n                                    value: sheet.name,\n                                    idx: sheetIdx\n                                });\n                            }\n                        }\n                    });\n                    break;\n                case 'locale':\n                    this.refresh();\n                    break;\n            }\n        }\n    };\n    /**\n     * To provide the array of modules needed for component rendering.\n     * @return {ModuleDeclaration[]}\n     * @hidden\n     */\n    Spreadsheet.prototype.requiredModules = function () {\n        return getRequiredModules(this);\n    };\n    /**\n     * Appends the control within the given HTML Div element.\n     * {% codeBlock src='spreadsheet/appendTo/index.md' %}{% endcodeBlock %}\n     * @param {string | HTMLElement} selector - Target element where control needs to be appended.\n     */\n    Spreadsheet.prototype.appendTo = function (selector) {\n        _super.prototype.appendTo.call(this, selector);\n    };\n    /**\n     * Filters the range of cells in the sheet.\n     * @hidden\n     */\n    Spreadsheet.prototype.filter = function (filterOptions, range) {\n        if (!this.allowFiltering) {\n            return Promise.reject();\n        }\n        range = range || this.getActiveSheet().selectedRange;\n        return _super.prototype.filter.call(this, filterOptions, range);\n    };\n    /**\n     * Clears the filter changes of the sheet.\n     * {% codeBlock src='spreadsheet/clearFilter/index.md' %}{% endcodeBlock %}\n     */\n    Spreadsheet.prototype.clearFilter = function (field) {\n        if (field) {\n            this.notify(clearFilter, { field: field });\n        }\n        else {\n            _super.prototype.clearFilter.call(this);\n        }\n    };\n    /**\n     * Applies the filter UI in the range of cells in the sheet.\n     * {% codeBlock src='spreadsheet/applyFilter/index.md' %}{% endcodeBlock %}\n     */\n    Spreadsheet.prototype.applyFilter = function (predicates, range) {\n        this.notify(initiateFilterUI, { predicates: predicates, range: range });\n    };\n    /**\n     * To add custom library function.\n     *  {% codeBlock src='spreadsheet/addCustomFunction/index.md' %}{% endcodeBlock %}\n     * @param {string} functionHandler - Custom function handler name\n     * @param {string} functionName - Custom function name\n     */\n    Spreadsheet.prototype.addCustomFunction = function (functionHandler, functionName) {\n        _super.prototype.addCustomFunction.call(this, functionHandler, functionName);\n        this.notify(refreshFormulaDatasource, null);\n    };\n    var Spreadsheet_1;\n    __decorate([\n        Property('')\n    ], Spreadsheet.prototype, \"cssClass\", void 0);\n    __decorate([\n        Property(true)\n    ], Spreadsheet.prototype, \"allowScrolling\", void 0);\n    __decorate([\n        Property(true)\n    ], Spreadsheet.prototype, \"allowResizing\", void 0);\n    __decorate([\n        Property(true)\n    ], Spreadsheet.prototype, \"enableClipboard\", void 0);\n    __decorate([\n        Property(true)\n    ], Spreadsheet.prototype, \"enableContextMenu\", void 0);\n    __decorate([\n        Property(true)\n    ], Spreadsheet.prototype, \"enableKeyboardNavigation\", void 0);\n    __decorate([\n        Property(true)\n    ], Spreadsheet.prototype, \"enableKeyboardShortcut\", void 0);\n    __decorate([\n        Property(true)\n    ], Spreadsheet.prototype, \"allowUndoRedo\", void 0);\n    __decorate([\n        Property(true)\n    ], Spreadsheet.prototype, \"allowWrap\", void 0);\n    __decorate([\n        Complex({}, SelectionSettings)\n    ], Spreadsheet.prototype, \"selectionSettings\", void 0);\n    __decorate([\n        Complex({}, ScrollSettings)\n    ], Spreadsheet.prototype, \"scrollSettings\", void 0);\n    __decorate([\n        Event()\n    ], Spreadsheet.prototype, \"beforeCellRender\", void 0);\n    __decorate([\n        Event()\n    ], Spreadsheet.prototype, \"beforeSelect\", void 0);\n    __decorate([\n        Event()\n    ], Spreadsheet.prototype, \"select\", void 0);\n    __decorate([\n        Event()\n    ], Spreadsheet.prototype, \"contextMenuBeforeOpen\", void 0);\n    __decorate([\n        Event()\n    ], Spreadsheet.prototype, \"fileMenuBeforeOpen\", void 0);\n    __decorate([\n        Event()\n    ], Spreadsheet.prototype, \"contextMenuBeforeClose\", void 0);\n    __decorate([\n        Event()\n    ], Spreadsheet.prototype, \"dialogBeforeOpen\", void 0);\n    __decorate([\n        Event()\n    ], Spreadsheet.prototype, \"fileMenuBeforeClose\", void 0);\n    __decorate([\n        Event()\n    ], Spreadsheet.prototype, \"contextMenuItemSelect\", void 0);\n    __decorate([\n        Event()\n    ], Spreadsheet.prototype, \"fileMenuItemSelect\", void 0);\n    __decorate([\n        Event()\n    ], Spreadsheet.prototype, \"beforeDataBound\", void 0);\n    __decorate([\n        Event()\n    ], Spreadsheet.prototype, \"dataBound\", void 0);\n    __decorate([\n        Event()\n    ], Spreadsheet.prototype, \"dataSourceChanged\", void 0);\n    __decorate([\n        Event()\n    ], Spreadsheet.prototype, \"cellEdit\", void 0);\n    __decorate([\n        Event()\n    ], Spreadsheet.prototype, \"cellEditing\", void 0);\n    __decorate([\n        Event()\n    ], Spreadsheet.prototype, \"cellSave\", void 0);\n    __decorate([\n        Event()\n    ], Spreadsheet.prototype, \"beforeCellSave\", void 0);\n    __decorate([\n        Event()\n    ], Spreadsheet.prototype, \"created\", void 0);\n    __decorate([\n        Event()\n    ], Spreadsheet.prototype, \"beforeSort\", void 0);\n    __decorate([\n        Event()\n    ], Spreadsheet.prototype, \"beforeHyperlinkCreate\", void 0);\n    __decorate([\n        Event()\n    ], Spreadsheet.prototype, \"afterHyperlinkCreate\", void 0);\n    __decorate([\n        Event()\n    ], Spreadsheet.prototype, \"beforeHyperlinkClick\", void 0);\n    __decorate([\n        Event()\n    ], Spreadsheet.prototype, \"afterHyperlinkClick\", void 0);\n    __decorate([\n        Event()\n    ], Spreadsheet.prototype, \"actionBegin\", void 0);\n    __decorate([\n        Event()\n    ], Spreadsheet.prototype, \"actionComplete\", void 0);\n    __decorate([\n        Event()\n    ], Spreadsheet.prototype, \"openComplete\", void 0);\n    __decorate([\n        Event()\n    ], Spreadsheet.prototype, \"sortComplete\", void 0);\n    Spreadsheet = Spreadsheet_1 = __decorate([\n        NotifyPropertyChanges\n    ], Spreadsheet);\n    return Spreadsheet;\n}(Workbook));\nexport { Spreadsheet };\n"],"names":["getRangeIndexes","range","cellindexes","indexes","indexOf","split","forEach","address","getCellIndexes","push","parseInt","match","getColIndex","toUpperCase","text","colIdx","i","reverse","join","length","charCodeAt","Math","pow","getCellAddress","sRow","sCol","getColumnHeaderText","getRangeAddress","isNullOrUndefined","colIndex","floor","String","fromCharCode","getIndexesFromAddress","getRangeFromAddress","getAddressFromSelectedRange","sheet","name","selectedRange","getAddressInfo","context","sIdx","getSheetIndex","getSheetNameFromAddress","activeSheetIndex","sheetIndex","indices","getSwapRange","clonedRange","slice","swap","x","y","tmp","isSingleCell","executeTaskAsync","taskFn","callbackFn","data","preventCallback","WorkerHelper","toFraction","val","strVal","toString","top_1","bottom","replace","abs","getGcd","a","b","Number","intToDate","Date","getTime","dateToInt","isTime","startDate","date","isDateTime","startDateUTC","UTC","getFullYear","getMonth","getDate","getHours","getMinutes","getSeconds","getMilliseconds","diffDays","Object","prototype","call","isNaN","valueOf","isNumber","parseFloat","toDate","intl","format","defaultDateFormats","getDefaultDateObject","availabelDateTimeFormat","dateTimeFormats","availableFormats","dObj","dateObj","isCustom","type","parseDate","_i","_a","keys","dateFormats","key","skeleton","_b","_c","time","toLocaleTimeString","_d","_e","timeFormats","getFormatFromType","code","getTypeFromFormat","getSkeletonVal","value","getModules","modules","includeBasicFormulas","member","args","getValue","nameSpace","obj","splits","j","isUndefined","setValue","keyValues","start","fromObj","undefined","getAlphalabel","col","cols","n","aCharNo","chs","getWorkbookRequiredModules","allowSave","allowOpen","allowEditing","allowNumberFormatting","allowCellFormatting","allowSorting","allowHyperlink","allowFiltering","allowFindAndReplace","allowInsert","allowDelete","allowDataValidation","allowMerge","allowImage","allowChart","checkIsFormula","isCellReference","rangeSplit","isValidCellReference","isChar","inRange","rowIdx","isLocked","cell","column","endNum","numArr","cellText","textLength","cellTextLength","substring","cellNumber","getCell","rowIndex","isInitRow","returnEmptyObjIfNull","row","getRow","cells","rows","setCell","isExtend","extend","skipDefaultValue","style","defaultKey","defaultProps","fontFamily","verticalAlign","textIndent","backgroundColor","color","textAlign","fontSize","fontWeight","fontStyle","textDecoration","border","borderLeft","borderTop","borderRight","borderBottom","changedProps","propName","wrap","addressInfo","rng","getSheet","setProperties","sheets","notify","wrapEvent","getData","columnWiseData","valueOnly","Promise","resolve","reject","Map","sheetIdx","index","promise","updateSheetFromDataSource","then","getDisplayText","isDate","checkDateFormat","getValueFromFormat","cellObj","assign","colSpan","rowSpan","cell_1","len","k","len_1","formula","isHiddenRow","isHiddenCol","eventArgs","trigger","queryCellInfo","set","processIdx","model","isSheet","cnt","out_i_1","diff","_loop_1","createSheet","splice","id","getMaxSheetId","setSheetPropertyOnMute","getSheetNameCount","cellCnt_1","max","clearRange","sCIdx","eCIdx","sRIdx","eRIdx","cFDelete","idx","toLowerCase","getSheetIndexFromId","getSheetIndexByName","info","updateSelectedRange","sheetNameCount","initSheet","rowCount","colCount","topLeftCell","activeCell","usedRange","ranges","columns","showHeaders","showGridLines","state","maxHgts","protectSettings","selectCells","formatCells","formatRows","formatColumns","insertLink","isProtected","initRow","getSheetName","setRow","hidden","getRowHeight","height","setRowHeight","getRowsHeight","startRow","endRow","getColumn","setColumn","curColumn","getColumnWidth","skipHidden","width","customWidth","getColumnsWidth","startCol","endCol","getRequiredModules","showRibbon","showFormulaBar","showSheetTabs","enableContextMenu","selectionSettings","mode","enableKeyboardNavigation","enableKeyboardShortcut","enableClipboard","allowResizing","allowUndoRedo","allowWrap","allowConditionalFormat","pushBasicModules","getUpdateUsingRaf","fn","requestAnimationFrame","removeAllChildren","parent","firstChild","removeChild","getColGroupWidth","getScrollBarWidth","scrollAreaWidth","htmlDivNode","document","createElement","result","cssText","body","appendChild","offsetWidth","clientWidth","getSiblingsHeight","element","classList","classes","getHeightFromDirection","direction","sibling","some","contains","offsetHeight","inView","isModify","scrollSettings","enableVirtualization","topIdx","viewport","topIndex","leftIdx","leftIndex","bottomIdx","getThreshold","rightIdx","inView_1","getCellPosition","offset","left","size","top","locateElem","ele","isRtl","swapRange","cellPosition","startIndex","skipHiddenIdx","attrs","setStyleAttribute","styles","setBaseStyleAttribute","getStartEvent","Browser","isPointer","getMoveEvent","getEndEvent","isTouchStart","e","pointerType","isTouchMove","isTouchEnd","getClientX","changedTouches","clientX","getClientY","clientY","setAriaOptions","target","options","setAttribute","config","destroyComponent","component","compObj","getComponent","destroy","setResize","isCol","curEle","curEleH","curEleC","preEle","preEleH","preEleC","nxtEle","nxtEleH","getActiveSheet","getElementsByClassName","getElementsByTagName","hdrRow","getRowHeaderContent","hdrClone","cloneNode","hdrFntSize","findMaxValue","getRowHeaderTable","contentRow","getMainContent","contentClone","cntFntSize","getContentTable","fntSize","add","lineHeight","removeProperty","remove","previousElementSibling","nextElementSibling","setWidthAndHeight","nxtIndex","getAttribute","getColHeaderTable","trgt","table","prevData","isWrap","myTableDiv","className","myTable","myTr","tr","offsetWidthValue","offsetHeightValue","getBoundingClientRect","ceil","updateAction","spreadsheet","isRedo","action","sortArgs","sortOptions","cancel","initiateSort","serviceLocator","getService","refreshRange","cellEvtArgs","cellValue","updateCell","requestType","cellFormat","numberFormat","copiedInfo","isCut","cut","copiedRange","copy","paste","pastedRange","isShow","hide","setColWidth","hideColumn","hideRow","removeSheetTab","isAction","count","sheetCount","clicked","endIndex","compareVal","initiateFilterUI","predicates","delete","modelType","insertModel","end","checkCount","deletedModel","columnCellsModel","deletedCellsModel","rules","operator","value1","value2","ignoreBlank","inCellDropDown","setValidation","removeValidation","setMerge","clearViewer","isPublic","conditionalFormat","cFColor","setCFRule","clearCFRule","clearCells","conditionalFormats","cFormats","oldRange","createImageElement","src","imageData","imageHeight","imageWidth","imageId","isUndoRedo","deleteImage","getElementById","refreshImgCellObj","prevTop","currentTop","prevLeft","currentLeft","currentHeight","prevHeight","currentWidth","prevWidth","chartOptions","theme","isSeriesInRows","setChart","chart","isInitCell","posRange","deleteChart","chartOpts","chartElement","refreshChartSize","overlayEle","hasTemplate","workbook","template","startCell","setRowEleHeight","hRow","notifyRowHgtChange","prevHgt","edit","querySelector","innerHTML","actCell","splitVal","valLength","lines","getLines","cellStyle","getTextHeight","rowHeightChanged","threshold","fontSizePx","getTextWidth","parentStyle","getContext","font","measureText","colwidth","textArr","spaceWidth","txt","lWidth","cWidth","setMaxHgt","rIdx","cIdx","hgt","getMaxHgt","maxHgt","rowHgt","increase","layout","task","defaultListener","taskData","this","workerTask","workerData","initWorker","terminate","worker","URL","revokeObjectURL","workerUrl","taskBlob","Blob","getFnCode","createObjectURL","Worker","onmessage","messageFromWorker","bind","onerror","onError","postMessage","apply","message","workerCode","workerFunction","isHaveFunction","getMessageFn","getCallbackMessageFn","workbookDestroyed","dataSourceChanged","dataChanged","workbookOpen","beginSave","getFilteredCollection","saveCompleted","applyNumberFormatting","getFormattedCellObject","refreshCellElement","setCellFormat","findAllValues","textDecorationUpdate","applyCellFormat","updateUsedRange","workbookFormulaOperation","workbookEditOperation","getFormattedBarText","activeCellChanged","openSuccess","openFailure","sheetCreated","sheetsDestroyed","aggregateComputation","sortComplete","beforeHyperlinkCreate","afterHyperlinkCreate","beforeHyperlinkClick","afterHyperlinkClick","setLinkModel","initiateFilter","filterComplete","filterRangeAlert","clearAllFilter","onSave","insert","deleteAction","deleteModel","isValidation","addHighlight","findNext","findPrevious","goto","replaceHandler","replaceAllHandler","showDialog","findUndoRedo","findKeyUp","removeHighlight","protectSheetWorkBook","updateToggle","protectsheetHandler","replaceAllDialog","unprotectsheetHandler","setLockCells","applyLockCells","applyMerge","mergedRange","activeCellMergedRange","insertMerge","pasteMerge","cFInitialCheck","cFRender","clear","clearCF","setImage","initiateChart","refreshRibbonIcons","refreshChart","updateChart","deleteChartColl","focusChartBorder","saveError","WorkbookNumberFormat","localeObj","getNumericObject","locale","decimalSep","decimal","groupSep","group","addEventListener","numberFormatting","getFormattedCell","fResult","rightAlign","currencySymbol","getNumberDependable","dateEventArgs","updatedVal","processFormats","isRightAlign","curSymbol","onLoad","setUsedRange","formattedText","Internationalization","autoDetectGeneralFormat","curCode","applyNumberFormat","currencyFormat","percentageFormat","accountingFormat","shortDateFormat","longDateFormat","timeFormat","fractionFormat","scientificFormat","res","trim","isEdit","findSuffix","zeros","resultSuffix","suffixLen","substr","isCustomFormat","formatArr","formatNumber","currency","shortDate","formatDate","longDate","prefix","findDecimalPlaces","toExponential","fractionResult","suffix","eIndex","decIndex","checkedDate","checkCustomDateFormat","dateArr","months","formattedBarText","beforeText","on","removeEventListener","isDestroyed","off","getModuleName","DataBind","requestedInfo","updateSheetFromDataSourceHandler","dataSourceChangedHandler","dataChangedHandler","flds","sCellIdx","remoteUrl","dataManager","sRowIdx","sColIdx","loadedInfo","_this","requestedRange","sRanges","deferred","Deferred","sRange","eRange","dataSource","DataManager","url","isLocalData","showFieldAsHeader","isEndReached","insertRowCount","this_1","initRangeInfo","getMaxCount","getLoadedInfo","unloadedRange","insertRowRange","isNotLoaded","query","Query","clone","executeQuery","requiresCount","fldLen","insertColumnRange","insertCount_1","insertRange","field","includes","item","getCellDataFromProp","checkDataForFormat","loadedRange","rangeSettingCount","unloadedArgs","pop","checkResolve","resolved","isSameRng","JSON","stringify","isLoaded","prop","hyperlink","queries","min","nos","rangeIdx","checkRangeHasChanges","showFieldAsHeader_1","indexes_1","refreshRange_1","bottomIndex","rightIndex","args_1","isAngular","changedRangeIdx","dataRange","deleteRowDetails","cellIndices","changedData","isNewRow","concat","insertType","_loop_2","fld","rangeIndex","ribbon","formulaBar","sheetTabs","refreshSheetTabs","isFormulaBarEdit","dataRefresh","initialLoad","contentLoaded","mouseDown","spreadsheetDestroyed","editOperation","formulaOperation","formulaBarOperation","click","keyUp","keyDown","onVerticalScroll","onHorizontalScroll","beforeContentLoaded","beforeVirtualContentLoaded","virtualContentLoaded","cellNavigate","mouseUpAfterSelection","selectionComplete","cMenuBeforeOpen","insertSheetTab","renameSheetTab","ribbonClick","enableToolbarItems","tabSwitch","selectRange","clearCopy","beforeDataBound","addContextMenuItems","removeContextMenuItems","enableContextMenuItems","enableFileMenuItems","hideFileMenuItems","addFileMenuItems","hideRibbonTabs","enableRibbonTabs","addRibbonTabs","addToolbarItems","hideToolbarItems","beforeRibbonCreate","colWidthChanged","beforeHeaderLoaded","onContentScroll","deInitProperties","activeSheetChanged","renameSheet","initiateCustomSort","applySort","collaborativeUpdate","hideShow","autoFit","updateToggleItem","initiateHyperlink","editHyperlink","openHyperlink","removeHyperlink","createHyperlinkElement","sheetNameUpdate","hideSheet","performUndoRedo","updateUndoRedoCollection","setActionData","getBeforeActionData","clearUndoRedoCollection","renderFilterCell","reapplyFilter","filterByCellValue","clearFilter","getFilteredColumn","completeAction","beginAction","filterCellKeyDown","getFilterRange","setAutoFit","refreshFormulaDatasource","setScrollEvent","initiateDataValidation","invalidData","protectSheet","applyProtect","protectCellFormat","gotoDlg","findDlg","findHandler","created","editAlert","setUndoRedo","enableFormulaInput","protectSelection","hiddenMerge","checkPrevMerge","checkMerge","removeDataValidation","showAggregate","initiateConditionalFormat","checkConditionalFormat","setCF","initiateFormulaReference","initiateCur","clearCellRef","editValue","addressHandle","initiateEdit","forRefSelRender","blankWorkbook","insertImage","refreshImgElem","getRowIdxFromClientY","getColIdxFromClientX","refreshChartCellObj","refreshImagePosition","updateTableWidth","focusBorder","clearChartBorder","insertChart","chartRangeSelection","isReact","renderReactTemplates","clearTemplate","WorkbookOpen","open","jsonObject","fetchSuccess","formData","FormData","file","append","requestData","method","fetch","openUrl","response","ok","json","status","statusText","catch","error","fetchFailure","isOpen","impData","parse","Workbook","updateModel","workbookModel","setSelectAllRange","definedNames","isImport","selectedIndex","SaveWorker","processSheet","Array","isArray","processSave","saveJSON","saveSettings","customParams","blob","reader","FileReader","onload","str","atob","dialog","readAsDataURL","__extends","extendStatics","d","setPrototypeOf","__proto__","p","hasOwnProperty","__","constructor","create","WorkbookSave","_super","isProcessCompleted","isFullPost","needBlobData","events.beginSave","initiateSave","saveType","fileName","updateBasicSettings","processSheets","jsonStr","getStringifyObject","basicSettings","updateSheet","getSheetLength","save","events.onSave","initiateFullPostSave","updateSaveResult","blobData","events.saveError","content","ClientFileDownload","events.saveCompleted","anchor","download","getFileNameWithExtension","href","formElem","inputElem","submit","detach","skipProp","properties","filename","fileExt","getFileExtension","lastIndexOf","CalculateCommon","ModuleLoader","loadedModules","inject","requiredModules","moduleList","reqLengthVal","clearUnusedModule","modl","moduleList_1","module","modName","isModuleLoaded","moduleObject","createInstance","memberName","getMemberName","isProperty","loadedModule","clean","classFunction","params","arrayParam","unshift","Function","moduleListName","usedModule","map","arg","removeModule_1","filter","moduleName","deleteObject","CommonErrors","FormulasErrorsStrings","BasicFormulas","formulas","formulaName","category","description","isConcat","init","addFormulaCollection","functionName","formulaCategory","libraryFormulas","fName","handler","ComputeSUM","arguments","formulaErrorStrings","invalid_arguments","orgValue","sum","argArr","argValue","cellCollection","getCellCollection","tic","getValueFromArg","getErrorStrings","trueValue","falseValue","ComputeINT","num","ComputeTODAY","dt","now","calculateDate","ComputeSUMPRODUCT","mulValues","startsWith","s1","col1","col2","cellRef","convertAlpha","ComputeROUNDUP","arg1","arg2","toFixed","digits","ComputeCOUNT","wrong_number_arguments","argVal","cellColl","ComputeDATE","year","month","day","days","getSerialDateFromDate","fromOADate","ComputeFLOOR","fnum","significance","argCount","splitArg","divzero","ComputeCEILING","cnum","ComputeDAY","serialNumber","dateVal","ComputeIF","condition","requires_3_args","ComputeIFERROR","arithMarker","ComputePRODUCT","parseVal","product","argsHit","rangevalue","ComputeDAYS","argsArr","endDate","toDateString","d1","d2","round","ComputeCHOOSE","cond","indexNum","ComputeSUMIF","improper_formula","computeSumIfAndAvgIf","ComputeABS","absValue","absVal","cellvalue","ComputeAVERAGE","calculateAvg","ComputeAVERAGEIF","argList","resultVal","ComputeCONCATENATE","argsList","tempStr","i_1","ComputeCONCAT","ComputeMAX","computeMinMax","ComputeMIN","ComputeRAND","random","ComputeAND","computeAndOr","ComputeOR","ComputeFIND","findText","removeTics","withinText","loc","startNum","ComputeINDEX","ref","rangeValue","rangeArr","i_2","ComputeIFS","na","ComputeCOUNTA","ComputeAVERAGEA","cellCol","parseValue","argArrs","ComputeCOUNTIF","stack","op","findWildCardValue","processLogical","ComputeSUMIFS","computeIfsFormulas","ComputeTEXT","checkArgs","argsLength","splitIndex","frtArg","scndArg","checkScndArg","s2","dTime","checkString","parseDouble","toOADate","formatChar","isH","isMFound","lastCharIndex","totalCharforM","c","getSkeleton","getDateFormat","dFormatter","ComputeCOUNTIFS","ComputeAVERAGEIFS","ComputeMATCH","lookupVal","matchType","indexVal","ComputeLOOKUP","computeLookup","ComputeVLOOKUP","computeVLookup","ComputeSUBTOTAL","ComputeRADIANS","radVal","PI","ComputeRANDBETWEEN","ComputeSLOPE","yPoints","xPoints","xPointsRange","yPointsRange","getDataCollection","sumXY","sumX2","sumX","sumY","ComputeINTERCEPT","xValues","yValues","yValuesRange","xValuesRange","ComputeLN","logValue","logVal","log","ComputeISNUMBER","ComputeROUND","numStr","digStr","mult","ComputePOWER","orgNumValue","orgPowValue","logNumValue","logPowValue","ComputeLOG","orgBaseValue","logBaseValue","LN10","ComputeTRUNC","normalizer","orgDigitValue","ComputeEXP","exp","ComputeGEOMEAN","dev","r","s","cellVal","cellsData","NaN","Parser","emptyStr","storedStringText","sheetToken","tokenAdd","tokenSubtract","tokenMultiply","tokenDivide","tokenLess","charEm","charEp","tokenGreater","tokenEqual","tokenLessEq","tokenGreaterEq","tokenNotEqual","tokenAnd","tokenEm","tokenEp","tokenOr","charAnd","charLess","charGreater","charEqual","charLessEq","charGreaterEq","charNoEqual","stringGreaterEq","stringLessEq","stringNoEqual","stringAnd","stringOr","charOr","charAdd","charSubtract","charMultiply","charDivide","fixedReference","spaceString","ignoreBracet","isError","isFormulaParsed","findNamedRange","stringsColl","tokens","charNOTop","specialSym","isFailureTriggered","fkey","isTextEmpty","getFormulaCharacter","namedRanges","storedData","checkForNamedRangeAndKeyValue","formulaString","storeStrings","indexOfAny","family","getSheetFamilyItem","grid","sheetNameToParentObject","setTokensForSheets","getSheetToken","scopedRange","checkScopedRange","markLibraryFormulas","formulaAutoCorrection","ex","exception","isForceCalculable","formulaCorrection","computeForceCalculate","invalid_expression","get","formulaText","FormulaError","mismatched_parentheses","empty_expression","parseSimple","exceptionArgs","errorMessage","getErrorLine","setStrings","arithemeticArr","logicalSym","form","firstOp","secondprevOp","secondnextOp","firstDigit","secondDigit","countDigit","isDigit","rightBracket","has","leftBracket","isUpperChar","getParseArgumentSeparator","getSheetID","v","token","sheetNameToToken","s_1","parentObject","getNamedRanges","tempString","storedString","mismatched_tics","expTokenArray","mulTokenArray","addTokenArray","mulCharArray","addCharArray","compareTokenArray","compareCharArray","expCharArray","andTokenArray","andCharArray","orCharArray","orTokenArray","parseSimpleOperators","markers","operators","right","findLeftMarker","cannot_parse","bracketCount","l","period","getParseDecimalSeparator","number_contains_2_decimal_points","getCellFrom","updateDependentCell","expression_cannot_end_with_an_operator","uFound","findRightMarker","jTemp","inbracket","noCellReference","arithMarker2","isCharacter","checkLetter","oneTokenFound","textLen","ret","bracketLevel","parseFormula","fKey","bracCount","rightParens","markNamedRanges","parenCount","leftParens","libFormula","getFunction","swapInnerParens","addParensToArgs","fSubstr","rightSides","lastIndexOfAny","oneTimeOnly","getTableRange","namerangeValue","findNextEndIndex","found","__decorate","decorators","desc","getOwnPropertyDescriptor","Reflect","decorate","defineProperty","Calculate","lFormulas","keyToRowsMap","rowsToKeyMap","emptyString","leftBrace","rightBrace","cellPrefix","treatEmptyStringAsZero","singleTic","parseDecimalSeparator","dependentCells","dependentFormulaCells","minValue","MIN_SAFE_INTEGER","maxValue","MAX_SAFE_INTEGER","categoryCollection","dependencyLevel","refreshedCells","computedValues","randomValues","isRandomVal","randCollection","errorStrings","parseArgumentSeparator","dateTime1900","isParseDecimalSeparatorChanged","isArgumentSeparatorChanged","sheetFamilyID","defaultFamilyItem","sheetFamiliesList","modelToSheetID","tokenCount","sortedSheetNames","tempSheetPlaceHolder","formulaInfoTable","oaDate","millisecondsOfaDay","parseDateTimeSeparator","moduleLoader","Calculate_1","Inject","injectedModules","parser","formulaColl","enumerable","configurable","setParseArgumentSeparator","getParseDateTimeSeparator","setTreatEmptyStringAsZero","getTreatEmptyStringAsZero","setParseDateTimeSeparator","getInjectedModules","onPropertyChanged","newProp","oldProp","charCode","resetKeys","parentObjectToToken","getDependentCells","formulaCells","addToFormulaDependentCells","cell1","getDependentFormulaCells","isSheetMember","sheetDependentCells","sheetDependentFormulaCells","getLibraryFormulas","getFormulaInfoTable","sheetFormulaInfotable","getFormula","getFormulaText","setParseDecimalSeparator","temp","bad_index","grd","isLetter","CalcSheetFamilyItem","setKeyValue","FormulaInfo","fInfo","clearFormulaDependentCells","setFormulaText","getFormulaValue","setParsedFormula","setFormulaValue","dependentFormula","dependent","arrayRemove","array","getKeyValue","fText","computeFormula","getParsedFormula","addNamedRange","sheetScopeName","removeNamedRange","arrCol","aCharValue","arr","cellRange","sheetTokenIndex","row1","row2","parsedText","lastIndexOfq","formulatResult","fNested","nestedFormula","findLastIndexOfq","sFormula","customArgs","processNestedFormula","q","computeValue","criteria","opt","checkCriteria","criteriaRangeArray","sumRange","criteriaRange","getComputeSumIfValue","checkCrte","findMaxVal","criterias","lookupRangeArray","lookupRange","maxVal","sort","minVal","lookupValue","firstCol","secCol","lookupCol","lookupCell","lookVal","finalText","checStr1","checStr2","newIndex","compRight","compLeft","leftVal","rightVal","sumRangeVal","tempdate","last","r1","c1","c2","r2","pFormula","textName","getParentObjectCellValue","stackValue","errIndex","getValArithmetic","countValue","num1","num2","val1","val2","localeCompare","computeStoreCells","sCell","cellRanges","argArray","isCriteria","storeCell","storedCells","isCountIfs","isCountIfS","countVal","rangeLength","tempStoredCell","newCell","newCount","cellAlpha","newCellAlpha","isAvgIfs","storedCell","pText","doubleNumber","setTime","isValidMonth","tempDay","dateTime","fString","pObjCVal","f","circular_reference","dateval","cellTxt","sheetToken1","containsBoth","isAlpha","isNum","charArray","sortedSheetNamesCollection","getSortedSheetNames","textSplit","tokenToParentObject","saveCell","cValue","getParentCellValue","getValueRowCol","defineFunction","window","valueChanged","changeArgs","isCalculate","pgrid","isComputedValueChanged","isCompute","calcFamily","getRowIndex","randStrVal","setValueRowCol","getComputedValue","refresh","formulaValue","arr_1","errorStack","createSheetFamilyID","operation","countStrVal","sumCell","avgVal","countNum","registerGridAsSheet","refName","tempRef","unregisterGridAsSheet","refName1","computeExpression","parsedFormula","dispose","refreshRandValues","tokenRef","stringCollection","dCell","formulaInfo","Property","Event","NotifyPropertyChanges","Base","calcID","MIN_VALUE","calcID1","ValueChangedArgs","setRowIndex","setColIndex","WorkbookFormula","uniqueOBracket","uniqueCBracket","uniqueCSeparator","uniqueCOperator","uniquePOperator","uniqueSOperator","uniqueMOperator","uniqueDOperator","uniqueModOperator","uniqueConcateOperator","uniqueEqualOperator","uniqueExpOperator","uniqueGTOperator","uniqueLTOperator","sheetInfo","initCalculate","registerSheet","calculateInstance","performFormulaOperation","from","values","formulaCollection","collection","selectCategory","selectedList","updateSheetInfo","unRegisterSheet","autoCorrectFormula","refreshCalculate","isFormula","argumentSeparator","isAdded","addDefinedName","definedName","isRemoved","removeDefinedName","scope","initiateDefinedNames","renameUpdation","sheetId","visibleName","sheetName","length_1","sheetDeletion","refError","referenceError","addCustomFunction","functionHandler","calcValue","sheetID","refreshInsDelFormula","insertArgs","refreshNamedRange","getSheetInfo","delSheetName","rowId","colId","formulaVal","removeSheetTokenIndex","dependentCellRef","updateDataContainer","visible","savedTokens","isSheetRenamed","sheetNames","name_1","sheetData","rowData","colObj","parseSheetRef","regx","escapeRegx","RegExp","cellArgs","referenceCollection","refValue","tempArgs","isEqual","lessEq","greaterEq","equal","lessOp","greaterOp","equalOp","definedname","refersTo","isLink","isValidate","visibleRefersTo","comment","checkIsNameExist","getIndexFromNameColl","calcName","formatedValues","actCellModel","actCellfrmt","countOnly","Count","Sum","Avg","Min","Max","clearFormula","startIdx","refreshFormula","diff1","nAlpha","fArg","ridx","pVal","actSheet","deleteIdxs","splitFormula","updatedFormulaVal","sheetLen","markSpecialChar","isUniqueChar","getUniqueCharVal","newRange","isChanged","modelDefinedNames","definedNameCnt","WorkbookSort","initiateSortHandler","sortDescriptors","containsHeader","workbookLocale","getConstant","getSortDataRange","isSameStyle","header","jsonData","comparerFn","sortComparer","caseSensitive","sortBy","colName","firstCellStyle","secondCellStyle","sameStyle","prevleftIdx","prevrightIdx","topReached","btmReached","leftReached","rightReached","btmIdx","sortDescriptor","order","comparer","DataUtil","fnSort","caseOptions","sensitivity","collator","Intl","Collator","compare","WorkbookFilter","filterRange","initiateFilterHandler","clearAllFilterHandler","filterOptions","datasource","setFilter","filterEventArgs","address_1","where","Predicate","and","result_1","executeLocal","WorkbookImage","oldImgData","imgRange","imgData","image","WorkbookChart","setChartHandler","refreshChartData","isPaste","chartCount","isIdAvailabe","idAvailable","option","dataSheetIdx","chartColl","charts","isInRange","rangeSheetIdx","chartCnt","sheetCnt","chartObj","excelFilter","chartEle","closest","isRefresh","overlayElement","WorkbookCellFormat","triggerEvent","onActionUpdate","borderType","setTypedBorder","checkAdjustantBorder","checkFullBorder","setCellBorder","setBottomBorderPriority","isFullBorder","setFullBorder","setCellStyle","lastCell","isHeightCheckNeeded","manualUpdate","refreshRibbon","pIdx","skipHiddenRows","getCellStyleValue","bottomPriority","actionUpdate","style_1","textDecorationActionUpdate","changedStyle","changedValue","activeCellIndexes","removeProp","prevBorder","first","clearCellObj","eColIdx","clrRange","eRowIdx","WorkbookEdit","performEditOperation","updateCellValue","isValueOnly","checkDecimalPoint","parseIntValue","test","WorkbookHyperlink","setLinkHandler","cellIdx","cellAddr","WorkbookInsert","mergeCollection","isModel","curIdx","insertCount","cellModel","mergeArgs","id_1","skipHiddenSheets","updateRangeModel","setInsertInfo","totalKey","WorkbookDelete","sheetLength","modelName","deletedCells","prevCell","mergeArgsCollection","update","preventRefresh","merge","skipChecking","prevCell_1","setDeleteInfo","total","WorkbookDataValidation","addValidationHandler","removeValidationHandler","addHighlightHandler","removeHighlightHandler","ValidationHandler","isRemoveValidation","validation","InvalidDataHandler","isRemoveHighlightedData","lastRowIdx","lastColIdx","range_1","isCell","isValid","WorkbookFindAndReplace","replaceAll","totalCount","cidx","valueOfCell","activecell","endColumn","stringValue","startColumn","lcValueOfCell","ivalueOfCell","lowerCaseIndex","searchBy","findNextArgs","loopCount","findNxtRow","findNxtCol","sheetsLen","noCellfound","nextCommon","noFound","rowCol","cellType","cellval","isCSen","isEMatch","lcValue","ivalue","findPrevArgs","findPreRow","findPreCol","usedRan","sheetsLength","noValueBoolean","commonCondition","prevCommon","isTrue","currentCell","findOpt","activecel","replaceAddress","replaceAllCollection","undoRedoOpt","caseInSensitive","replaceValue","replaceAllCollection_1","newValue","replaceAllCollection_2","updateValue","replaceAllCollection_3","startSheet","addressCollection","lowerCaseValue","regExepression","Collection","countNumber","columnIndex","requiredCount","findCount","argsVal","lowerCaseVal","findAllArguments","initialSheet","findCollection","WorkbookProtectSheet","props","lockCells","WorkbookMerge","mergeHorizontally","mergeVertically","mergeAll","curCell","getCellValue","mergeCount","activeCellRange","forward","forwardReverse","reverseForward","endRowIdx","endColIdx","isActiveCell","startRowIdx","startColIdx","startRowIndex","colnIdx","cellIndex","rIndex","cIndex","insertHandler","pasteHandler","nextCell","prevSheet","WorkbookConditionalFormat","setCFrulHandler","clearRules","cfrCount","frontColIdx","backColIdx","topRowIdx","bottomRowIdx","isFirst","cFRules","rangeIndexes","cFRulesIdx","isPresent","cFRule","cFRanges","cFRangeIdx","isFull","cFRangeIndexes","cFRRowIdx","cFRColIdx","rRowIdx","rColIdx","WorkbookBasicModule","WorkbookAllModule","CellStyle","ChildProperty","FilterCollection","DefineName","ProtectSettings","Hyperlink","Validation","Format","Complex","ConditionalFormat","Chart","Image","localeData","SortOutOfRangeError","Cell","Range","muteOnChange","parentObj","currRangeIdx","controlParent","isComplexArraySetter","setTimeout","tagObjects","instance","hasChanges","isInitChanges","rangeIdx_1","list","UsedRange","Sheet","ServiceLocator","services","register","__assign","t","Workbook_1","commonCellStyle","initWorkbookServices","dataBind","initEmptySheet","preRender","refreshing","L10n","render","getPersistData","addOnPersist","cssProps","cssProp","events.applyNumberFormatting","events.workbookFormulaOperation","removeSheet","events.workbookDestroyed","appendTo","selector","setBorder","insertRow","insertColumn","insertSheet","endSheet","initIdx","hiddenCount","errArgs","events.workbookEditOperation","events.workbookOpen","openFromJson","saveOptions","saveUrl","saveAsJson","addHyperlink","cellAddress","events.findNext","events.findPrevious","replaceBy","events.replaceHandler","events.replaceAllHandler","events.protectsheetHandler","unprotectSheet","events.unprotectsheetHandler","events.initiateSort","addDataValidation","events.setValidation","events.removeValidation","addInvalidHighlight","events.addHighlight","removeInvalidHighlight","events.removeHighlight","events.setCFRule","clearConditionalFormat","events.clearCFRule","wrapText","images","filterArgs","events.initiateFilter","events.clearAllFilter","events.clear","events.getFormattedCellObject","isProtectedOnChange","Component","Row","Column","role","selected","multiselectable","busy","colcount","Clipboard","externalMerge","contenteditable","getClipboardEle","clearCopiedInfo","tabSwitchHandler","cMenuBeforeOpenHandler","ribbonClickHandler","initCopyIndicator","EventHandler","parentId","focus","activeTab","copiedShapeInfo","hidePaste","l10n","delRowItems","hideRowItems","delColItems","hideColItems","actCellIndex","isCellLocked","setCopiedInfo","copiedSheet","rfshRange","isExternal","clipboardData","copiedIdx","getCopiedIdx","copyInfo","isInternal","cSIdx","curSheet","selIdx","getExternalCells","internal","cellLength","isRepeative","beginEventArgs","copiedIndex","pictureElem","chartInfo","backgroundImage","pastedCell","imgLen","pasteSheetIndex","pastedPictureElement","pasteType","cRows","inRange_1","copiedCell","isFinite","colInd","externalMergeRow","newFormula","sId","cellElem","oldValue","displayText","cutInfo","updateFilter","select","isFilterCut","filterCollection","fRange","fEndCol","asc","filterCol","filteredCell","cRng","pRng","cIdxValue","difIndex","formulaOperators","splitArray","newAddress","getEmptyStyle","pictureElements","pictureLen","showSpinner","imgRowIdx","offsetTop","isImage","imgColIdx","offsetLeft","getChartElemInfo","isIE","execCommand","hideSpinner","setExternalCells","chartId","copyIndicator","show","isModal","showCloseIcon","beforeOpen","dlgArgs","dialogName","items","enable","regex","setData","preventDefault","html","querySelectorAll","td","textContent","cSpan","rSpan","getStyle","whiteSpace","children","child","char","charAt","Edit","editorElem","editCellData","isCellEdit","isNewValueEdit","isAltEnter","validCharacters","keyCodes","BACKSPACE","SPACE","TAB","DELETE","ESC","ENTER","FIRSTALPHABET","LASTALPHABET","FIRSTNUMBER","LASTNUMBER","FIRSTNUMPAD","LASTNUMPAD","SYMBOLSETONESTART","SYMBOLSETONEEND","SYMBOLSETTWOSTART","SYMBOLSETTWOEND","FIREFOXEQUALPLUS","FIREFOXMINUS","F2","dblClickHandler","mouseDownHandler","keyUpHandler","keyDownHandler","initiateCurPosition","updateFormulaBarValue","addressHandler","initiateRefSelection","refSelectionRender","renderEditor","refreshEditor","refreshFormulaBar","refreshEditorElem","isAppend","trigEvent","refreshCurPos","setCursorPosition","startEdit","endEdit","cancelEdit","editedValue","refreshDependentCellValue","position","altKey","keyCode","altEnter","formulaRefIndicator","parentElement","editValue_1","formulaSheetIdx","trgtElem","shiftKey","ctrlKey","metaKey","isFormulaEdit","isWindows","goTo","fullAddr","hasFormulaSuggSelected","isAlphabet","isNumeric","isNumpadKeys","isSymbolkeys","isFirefoxExceptionkeys","isF2Edit","isBackSpace","isLockCellDelete","editingHandler","editor","contentEditable","spellcheck","preventFormulaReference","cellEle","isDelTemplate","value_1","updateEditCellDetail","initiateEditor","positionEditor","elem","selection","getSelection","createRange","setStart","collapse","removeAllRanges","addRange","suggDdlElem","visibility","editText","curPos","focusOffset","actCellIdx","selectionEnd","curPos_1","addr","tdElem","minHeight","minWidth","editWidth","inlineStyles","enableRtl","updateEditedValue","tdRefresh","oldCellValue","innerText","sheet_1","cellIndex_1","getRefreshNodeArgs","refreshNode","fCode","event","fSize","resetEditState","focusElement","removeAttribute","eventName","originalEvent","textBefore","textAfter","node","anchorNode","nodeType","anchorOffset","setEnd","elemRefresh","editorEle","isSelect","setFormulaBarCurPosition","input","selectionStart","setSelectionRange","el","childNodes","valueLength","Selection","invalidOperators","formulaRange","tableRangesFormula","mouseMoveEvt","mouseMoveHandler","virtualContentLoadedHandler","cellNavigateHandler","protectHandler","initiateFormulaSelection","clearBorder","chartBorderHandler","getActiveCell","getSelectionElement","rowStart","rowEnd","colStart","colEnd","selectRangeByIdx","actRange","createSelectionElement","cont","overlayElem","getSheetElement","activeIdx","isRowSelected","isColSelected","getColumnHeaderContent","which","isSelected","passive","mouseUpHandler","touchEvt","isMobileView","renderModule","setSheetPanelSize","getScrollContent","clientRect","prevIndex","isScrollDown","isScrollUp","isScrollRight","isScrollLeft","clearInterval","scrollInterval","setInterval","scrollTop","scrollLeft","highlightHdr","getScrollLeft","scrollModule","prevScroll","cliRect","initFormulaReferenceIndicator","forRefIndicator","isScrollRefresh","isActCellChanged","isInit","isMergeRange","getOffset","eArgs","UpdateRowColSelected","updateActiveCell","topLeftIdx","isRowRefresh","isColRefresh","rowHdr","colHdr","getHdrIndexes","selectAll","removeClass","addClass","hiddenRowCount","hiddenColCount","processFormulaEditRange","formulaStartSheetIdx","actSheetIdx","parsedVal","ctrlKeyCount","formulaBorder","splitStr","updateFormulaEditRange","dStartCell","dEndCell","startcell","endcell","isChart","minr","minc","maxr","maxc","getEleFromRange","rowCells","startRIndex","startCIndex","endRIndex","endCIndex","tempCells","getRowCells","tdCol","second","borderEleColl","classArr","idx_1","formulaStr","Scroll","initProps","scrollArgs","prevSize","initScrollValue","scrollRight","getColOffset","cur","prev","preventScroll","updateTopLeftCell","updateNonVirtualCols","scrollDown","getRowOffset","updateNonVirtualRows","refreshUI","Infinity","onScroll","setPadding","allowScrolling","colHeader","rowHeader","scrollWidth","padding","marginBottom","VirtualScroll","scroll","createVirtualElement","container","colVTrack","rowVTrack","vTrack","initScroll","domCount","setScrollCount","translateX","translateY","transform","activeSheetIdx","getRowAddress","getColAddress","updateScrollCount","usedRangeCount","prevIdx","idxDiff","lastIdx","prevTopIdx","skippedHiddenIdx","skipUpdateOnFirst","getThresholdHeight","checkLastIdx","endIdx","prevLeftIdx","getThresholdWidth","translate","updateColumnWidth","getVTrackHeight","updateVTrack","createHeaderElement","heightArr","updateVTrackHeight","updateVTrackWidth","hdrVTrack","cntVTrack","hdrColumn","cntColumn","sizeStr","deInitProps","updateScrollProps","sliceScrollProps","KeyboardNavigation","activeElement","isNavigate","isFilterCell","actIdxes","scrollNavigation","stopPropagation","isScroll","topLeftIdxes","getBottomIdx","getRightIdx","contWidth","KeyboardShortcut","isUndo","toolBarElem","applyFilter","CellFormat","checkHeight","curStyle_1","setLeftBorder","setTopBorder","pRow","pHRow","setThickBorderHeight","customHeight","isFontSize","updateRowHeight","isLastCell","borderSize","firstElementChild","display","getBorderSize","calculateHeight","clearObj","Resize","wireEvents","setAutoFitHandler","isRow","trgtEle","setAutofit","wireResizeCursorEvent","setTarget","unWireResizeCursorEvent","unwireEvents","sheetPanel","colResizeHandler","rowResizeHandler","isMouseMoved","offsetSize","offsetY","updateTarget","createResizeHandler","resizeOn","resizeHandler","updateCursor","colIndx","showHiddenColumns","rowIndx","newTrgt","tOffsetV","eOffsetV","tClass","offsetX","resEle","mainContent","contentTable","rowLength","colLength","contentFit","getFloatingElementWidth","autofitValue","resizeStart","getViewportIndex","threshold_1","oldWidth","threshold_2","oldHeight","clientHeight","viewportIdx","curWidth","colgroup","eleHeight","rowHeight","isCustomHgt","actualIdx","skipAppend","rTbody","tBodies","tbody","insertBefore","insertIdx","isFit","floatingWidth","hasFilter","CollaborativeEditing","refreshClients","ShowHide","hideCol","nextIdx","hFrag","frag","rowRenderer","rTBody","tBody","newStartRow","createDocumentFragment","lastElementChild","scrollable","hiddenIndex","beforeViewportIdx","removeCell","scrollWidth_1","appendCell","hColgrp","colgrp","hTable","modelLen","isEnd","cellRenderer","refCell","sheetModule","updateCol","renderColHeader","lastChild","tHead","checkNextBorder","previousSibling","SpreadsheetHyperlink","initiateHyperlinkHandler","editHyperlinkHandler","removeHyperlinkHandler","openHyperlinkHandler","hyperlinkClickHandler","createHyperlinkElementHandler","hyperlinkText","hyperlinkSpan","insertBut","dialogInst_1","cssClass","dialogInstance","hyperlinkContent","buttons","buttonModel","isPrimary","disabled","dlgClickHandler","dialogInst","spreadsheetInst","insertHyperlink","dlgContent","hyperEditContent","cellIndexes","hlOpenHandler","isEmpty","rangeAddr","befArgs","aftArgs","definedNameCheck","sheetIdx_1","isDefinedNamed","rangeAddr_1","addArr","dlgEle","docEle","webEle","webEleText","docEleText","actEle","hasAttribute","hyperEle","isWeb","webContElem","docContElem","listEle","isDefinedName","isCellRef","isEnable","hl","dialogElem","Tab","selectedItem","textCont","urlCont","textH","urlH","textInput","urlInput","nodeId","nodeText","expanded","nodeChild","treeObj","TreeView","fields","cellrefCont","cellrefH","cellrefInput","textCont1","textH1","textInput1","sheetCont","sheetH","refCont","UndoRedo","undoCollection","redoCollection","undoRedoStep","cutCellDetails","getCellDetails","beforeActionData","cellDetails","beforeDetails","undoRedoArgs","performOperation","undoForClipboard","undoForResize","updateUndoRedoIcons","completeArgs","actionList","beforeActionDetails","tab","actionData","checkRefreshNeeded","updateCellDetails","sheetIndex_1","argsEventArgs","WrapText","wrapTextHandler","rowHeightChangedHandler","initial","WRAPTEXT","outerHTML","editElem","defaultStyle","Insert","preventUpdate","refreshSheet","refreshImgElement","Delete","activeSheetDeleted","DataValidation","dataValPopup","listOpen","initiateDataValidationHandler","invalidDataHandler","checkDataValidation","listHandler","parEle","valuesCont","errorEle","primaryBut","listObj","showPopup","isRemoveHighlight","tdEle_1","ddlCont","ddlEle","DropDownList","popupWidth","popupHeight","updateDataSource","change","listValueChange","popup","getIndexes","listValues","isNew","dataValidationContent","cellRangeCont","allowDataCont","ignoreBlankCont","cellRangeText","cellRangeEle","allowCont","dataCont","allowText","typeData","operatorData","allowSelectEle","allowIdx","dataIdx","dataText","dataSelectEle","FormattedValue","dataList","userInput","ignoreBlankEle_1","CheckBox","label","checked","minimumCont","maximumCont","minimumText","maximumText","minimumInp","maximumInp","NumericTextBox","valueText","valueEle","isChecked","ignoreBlankEle","listObj1","dlgCont","placeholder","errorMsg","isValidList","dlgFooter","dlgContEle","allowData","allowEle","dataEle","rangeAdd","valArr","isSheetNameValid","isSingleCol","isSingleRow","validDlg","isDialogValidator","tdEle","formValidation","formatValidation","isValidationHandler","enterValue","validationErrorHandler","formEle","inputEle","customPlacement","inputElement","number","FormValidator","validate","erroDialogInst_1","dlgModel","errorDlgHandler","errorDialogInst","buttonName","ProtectSheet","protect","protectSheetHandler","editProtectedAlert","lockCellsHandler","isActive","createDialogue","listData","optionList","ListView","showCheckBox","dialogOpen","protectHeaderCntent","checkbox","listViewElement","headerContent","checkBoxElement","okBtnFocus","beforeClose","checkboxElement","checkBoxClickHandler","selectOption","selectMultipleItems","selectedItems","getSelectedItems","disableHomeBtnId","enableHomeBtnId","enableFrmlaBtnId","enableInsertBtnId","imageBtnId","findBtnId","dataValidationBtnId","chartBtnId","sheetElement","closeOnEscape","close","FindAndReplace","shortValue","renderFindDlg","renderGotoDlg","gotoHandler","eventArgs_1","eventArgs_2","eventArgs_3","dlg","allowDragging","findandreplaceContent","dialogMessage","findDlgClick","prevButton","GotoContent","textFocus","findDlgArgs","findOption","findInput","gotoAlert","checkCase","checkmatch","searchitem","modeitem","find","countArgs","countOpt","replaceWith","caseCheckbox","eMatchCheckbox","searchDDL","modeDDL","replaceMode","gotoaddress","splitAddress","gotoSpan","findSpan","replaceSpan","findValue_1","findValue","findElem","findCheck","findTextE","findTextH","findTextIp","findTextBox","TextBox","replaceTextE","replaceTextH","replaceTextIp","replaceTextBox","withinData","Id","Within","withInDDL","withIn","withinTextH","searchData","Search","searchIn","searchTextH","caaseCheckbox","entirematchCheckbox","gotoElem","gotoTextE","gotoTextH","gotoTextBox","gotoTextIp","Merge","hideHandler","ConditionalFormatting","cFInitialRender","cFInitialCheckHandler","checkConditionalFormatHandler","initiateCFHandler","setCFHandler","cFDeleteHandler","clearCFHandler","addClearCFHandler","clearCFormats","cCFIdx","isApply","cFIdx","sRangeIdx","newRangeIdxs","cFRowIdx","cFColIdx","sRRowIdx","sRColIdx","cFDlgContent","mainCont","inpEle","getCFColor","cFType","getType","dlgText","getDlgText","mainDiv","subDiv","value1Text","value1Inp","duplicateSelectEle","subDivText","colorSelectEle","dupData","value2Text","value2Inp","colorData","checkCellHandler","cFrange","cFRIdx","formatStyle","cFColors","cFRCheck","setFormat","setProperty","cFRuleIdx","setColor","isActiveCF","rgb","hexToRgb","g","hex","exec","isInitial","cFRuleValue1","cFRuleValue2","valueArr","valueStr","isGreaterThanLessThan","isBetWeen","isEqualTo","isContainsText","isDuplicateUnique","isTopBottomTenValue","isTopBottomTenPercentage","isAboveBelowAverage","isDataBarColorScalesIconSets","applyDataBars","applyColorScale","applyIconSet","selIndexes","rIdx_1","cIdx_1","iconList","getIconList","rIdx_2","getNumericArray","n1","n2","currentSymbol","minPercent","percent1","percent2","percent3","cfIcon","applyIconSetIcon","activeObj","activeEle","iconName","colors","getColor","rIdx_3","hexcode","getGradient","posColor","negColor","topVal","posArr","negArr","leftStandardWidth","rIdx_4","databar","leftSpan","rightSpan","dataSpan","iconSetSpan","cfColor","colorCodeArr","colorArr","middle","large","getLinear","center","byteLinear","isGrearThan","txtRegx","input1","input2","dateEventArgs1","dateEventArgs2","dateTimeArgs","inp","isTop","dataArray","cFRuleIndexes","dataArr","considerCount","isAbove","rangeColl","average","RibbonHeader","RibbonItem","Item","Ribbon","getUniqueID","renderRibbon","expandCollapseElem","ribbonExpandCollapse","menuItems","fileMenu","toolbarObj","tabObj","getTabItems","tabItems","initMenu","menu","menuObj","Menu","showItemOnClick","parentItem","beforeItemRender","tabElement","tBarElement","Toolbar","selectedTab","getIndex","animation","next","duration","previous","selecting","selectingIndex","updateToolbar","refreshOverflow","collapseBtn","decrement","enableMenuItems","isUniqueId","enableItems","hideMenuItems","menuInstance","hideItems","showItems","addMenuItems","insertAfter","hideTabs","tabs","stateChanged","isAllHidden","getTabIndex","allHidden","enableTabs","enableTab","addTabs","addTab","headerText","tabIdx","disable","MenuItem","ColorPicker","fontColorPicker","ColorPickerComponent","showButtons","presetColors","fontColor","enableOpacity","beforeCloseHandler","openHandler","beforeModeSwitch","currentValue","rgba","previousValue","updateSelectedColor","wireFocusEvent","filColorPicker","fillColor","borderBottomColor","title","inst","modeSwitcher","fontNameIndex","numPopupWidth","RibbonColorPicker","initRibbon","createMobileView","createRibbon","getRibbonMenuItems","iconCss","getRibbonItems","prefixIcon","tooltipText","getPasteBtn","getNumFormatDDB","getFontNameDDB","getFontSizeDDB","getBtn","getBordersDBB","getMergeSplitBtn","getTextAlignDDB","getVerticalAlignDDB","getHyperlinkDlg","datavalidationDDB","getLocaleText","getCFDBB","getChartDBB","getClearDDB","getSortFilterDDB","getFindDDb","btn","pasteSplitBtn","SplitButton","setClass","getLocaleProtectText","ribbonElement","RibbonComponent","fileMenuItemSelect","fileMenuBeforeOpen","fileMenuBeforeClose","toolbarClicked","ribbonCreated","tabSelecting","expandCollapse","expandCollapseHandler","beforeFileMenuItemRender","beforeRenderHandler","uiUpdate","refEle","refreshRibbonContent","numFormatBtn","numFormatDDB","DropDownButton","getNumFormatDdbItems","numDDBSelect","numDDBOpen","previewNumFormat","tBarDdbBeforeOpen","fontSizeDdb","refreshSelected","chartMenu","orientation","bar","area","line","pie","radar","scatter","chartSelected","column1Text","column1Cont","column2Cont","clusteredColumn","stackedColumn","stackedColumn100","clusteredColumn3D","stackedColumn3D","stackedColumn1003D","bar1Text","bar1Cont","bar2Cont","clusteredBar","stackedBar","stackedBar100","clusteredBar3D","stackedBar3D","stackedBar1003D","areaText","areaCont","defArea","stackedArea","stackedArea100","lineText","lineCont","defLine","stackedLine","stackedLine100","pieText","pieCont","defPie","doughnut","radarText","radarCont","defradar","radarMarkers","scatterText","scatterCont","defscatter","ul","chartDdb","chartBtn","cFMenu","dataBars","colorScales","iconSets","cFSelected","db1","db2","bBar","gBar","rBar","oBar","lBBar","pBar","cs1","cs2","cs3","gyr","ryg","gwr","rwg","bwr","rwb","wr","rw","gw","wg","gy","yg","is1","is2","is3","is4","is5","is6","is7","is8","directional1","directional2","directional3","directional4","directional5","directional6","directional7","shapes1","shapes2","shapes3","shapes4","shapes5","indicators1","indicators2","indicators3","ratings1","ratings2","ratings3","ratings4","ratings5","cFDdb","tag","cPickerWrapper","bordersMenu","separator","colorPicker","cPickerEle","onOpen","overflow","borderSelected","inline","bordersDdb","eleId","prevStyleId_1","toggle","fontNameBtn","fontNameDdb","getFontFamilyItems","refreshFontNameSelection","bindEvent","btnObj","Button","isToggle","toggleBtnClicked","datavalidationDdb","textAlignDdb","alignItemRender","verticalAlignDdb","mergeSplitBtn","mergeSelectHandler","toggleActiveState","unMerge","itemId","isDataPresent","performMerge","sortingDdb","isFiltered","isClearAll","findToolbtn","findDdb","onclick","findToolDlg","toolbarObj_1","findTextElement","findTextInput","findSpan_1","onkeyup","nextElement","prevElement","onkeydown","findOnKeyDown","toolItemModel","findDialog","toolbarElement_1","dialogDiv","FindDialog","closeDialog","getComputedStyle","calculate","dialogWidth","rightValue","topValue","X","Y","elements","clearDdb","defaultModel","activeModel","property","refreshToggleBtn","itemKey","setPanelSize","actionArgs","refreshNumFormatSelection","separatorCount","viewportHeight","actualHeight","paddingTop","separatorStyle","borderBottomWidth","marginTop","overflowY","elemList","popWidth","numElem","previewElem","refreshHomeTabContent","refreshDataTabContent","refreshViewTabContent","active","fontProps","selectArgs","evtHArgs","showHideHeaders","toggleRibbonItems","evtglArgs","viewtabHeader","datatabHeader","updateToggleText","len_2","updateActiveBorder","updated","updateViewTabContent","updateShowHideBtn","showHideText","updateDataTabContent","updateProtectBtn","protectText","toobar","align","renderMobileToolbar","toolbarPanel","toolbar","ddb","ddbObj","calculatePosition","wrapper","contents","li","updateMergeItem","parentElem","ribbonEle","FormulaBar","isGoto","createFormulaBar","insertFnRipple","fBarWrapper","nameBox","comboBoxInstance","ComboBox","noRecordsTemplate","nameBoxBeforeOpen","blur","nameBoxBlur","nameBoxSelect","rippleEffect","textarea","textAreaFocusIn","textAreaFocusOut","formulaPanel","tickBtn","validity","eventArg","UpdateValueAfterMouseUp","isInteracted","itemData","formulaBarUpdateHandler","indexes1","indexes2","intDate","formulaInp","addressRange","updateComboBoxValue","disabletextarea","getFormulaBar","formulaBarScrollEdit","viewportIndexes","formulaBarClickHandler","toggleFormulaBar","names","offsetParent","formulaDescription","categoryContent","dropDownElement","descriptionContent","categoryArgs","categoryList","dropDownSelect","listArgs","formulaList","actionComplete","updateFormulaList","listSelected","dialogBeforeClose","dialogClose","selectFormula","formulaClickHandler","focusOkButton","dialogContentEle","parentNode","storeActiveElement","formulaBarObj","updateFormulaDescription","activeListFormula","firstElement","selectItem","descriptionArea","selectedFormula","descriptionArgs","editOperationHandler","Formula","isFormulaBar","isPopupOpened","isPreventClose","isSubFormula","UP","DOWN","LEFT","RIGHT","autocompleteInstance","formulaClick","renderAutoComplete","getNames","getNameFromRange","acElem","autoCompleteOptions","filterType","sortOrder","onSuggestionOpen","onSuggestionClose","onSelect","onSuggestionComplete","AutoComplete","getPopupPosition","refreshPosition","maxHeight","triggerKeyDownEvent","updatedFormulaValue","getEditingValue","parseIndex","getArgumentSeparator","hidePopUp","getSuggestionKeyFromFormula","refreshFormulaSuggestion","autoCompleteElem","isSuggestionAlreadyOpened","isNavigationKey","dispatchEvent","suggPopupElem","hidePopup","suggestValue","bracketIndex","fSplit","isAlphaNumeric","singleRange","SheetTabs","aggregateContent","isSelectCancel","selaggregateCnt","createSheetTabs","tabInstance","panel","addBtn","addSheetTab","addBtnRipple","getSheetTabItems","dropDownInstance","ddbItems","updateSheetTab","beforeOpenHandler","sheetTab","overflowMode","scrollStep","currentSheetIndex","previousSheetIndex","previousIndex","updateDropDownItems","completeEventArgs","tBarItems","spaceKeyDown","positionX","isCollide","refreshSheetTab","switchSheetTab","required","maxlength","renameInputFocusOut","updateWidth","spaceLen","removeRenameInput","showRenameDialog","updateSheetName","textEle","sheetItems","focusRenameInput","forceDelete","sheetArgs","destroySheet","removeTab","activeIndex","btnClass","aggregateDropDown","updateAggregateContent","aggregateEle","getAggregateItems","removeAggregate","Open","renderFileUpload","openFailed","uploadID","accept","uploadBox","onchange","fileSelect","filesData","files","impArgs","Save","showErrorDialog","ContextMenu","initContextMenu","contextMenuInstance","ContextMenuComponent","selectHandler","getInsertModel","getTarget","getDataSource","childElementCount","insertEle","deleteEle","setClipboardData","setFilterItems","setSortItems","setHyperLink","setInsertDeleteItems","setHideShowItems","setProtectSheetItems","clearFilterText","subItems","addItemsHandler","removeItemsHandler","enableItemsHandler","removeItems","NumberFormat","Sort","applySortHandler","sortCompleteHandler","initiateCustomSortHandler","isValidSortRange","sortRangeAlertHandler","customSortContent","clearError","errorElem","validateError","headercheck","headerCheckbox","hasHeader","dropDown","hasError","Set","duplicateField","errorField","count_1","dropDownList","getFields","listId","listviewObj","getCustomListview","setHeaderTab","contentElem","listview","renderListItem","fieldName","headerTabElement","addButton","footer","addItem","checkHeaderObj","fieldsMap","dropDownListObj","checkCaseObj","enableRipple","deleteHandler","removeItem","lvObj","orderRadio","isAscending","toLocaleLowerCase","radiobutton","RadioButton","setRadioBtnValue","radio","radiobutton2","radio2","beforeArgs","Filter","filterClassList","filterRangeAlertHandler","initiateFilterUIHandler","filterMouseDownHandler","renderFilterCellHandler","beforeFltrcMenuOpen","beforeFilterMenuOpenHandler","beforeCustomFilterOpen","beforeCustomFilterOpenHandler","reapplyFilterHandler","filterByCellValueHandler","clearFilterHandler","getFilteredColumnHandler","filterCboxValue","filterCboxValueHandler","getFilterRangeHandler","filterCellKeyDownHandler","isInValidFilterRange","addMenuItem","removeFilter","processRange","filterSuccessHandler","predicate","refreshFilterRange","isFilterRange","getColumnType","matchCase","filterBtnObj","filterButton","hasChildNodes","headerCell","filterPopup","pos","openDialog","selectSortItemHandler","xPos","yPos","parentsUntil","filterCell","displayName","checkBoxData","hideSearchbox","filteredColumns","ExcelFilterBase","getLocalizedCustomOperators","sameIndex","filterIndex","getPredicates","predicateList","excelPredicate","CheckBoxFilterBase","getPredicate","numOptr","stringOperator","numberOperator","dateOperator","datetimeOperator","booleanOperator","fil","colCollection","dataType","SpreadsheetImage","pictureCount","renderImageUpload","refreshInsDelImagePosition","imageSelect","binaryStringVal","overlayObj","overlay","insertOverlayElement","currCell","currCellObj","imageLen","prevRowIdx","currRowIdx","prevColIdx","currColIdx","prevImgObj","currImgObj","prevCellObj","prevCellImg","prevCellImgLen","currentRowIdx","currentColIdx","imgLength","imgTop","imgleft","rangeVal","ColumnSeries","LineSeries","BarSeries","AreaSeries","StackingColumnSeries","StackingLineSeries","StackingBarSeries","ScatterSeries","StackingAreaSeries","Category","Legend","Tooltip","AccumulationChart","PieSeries","AccumulationTooltip","AccumulationDataLabel","AccumulationLegend","SpreadsheetChart","initiateChartHandler","updateChartHandler","insertChartHandler","chartRangeHandler","chartType","chartCollLen","getPropertyValue","formatObj","series","prevChartObj","currChartObj","prevCellChart","chartEleClassName","processChartRange","xRange","yRange","lRange","trVal","blVal","tlVal","isStringSeries","toIntrnlRange","getRangeData","pushRowData","isYvalue","isDataSrcEnsured","minCol","forArgs","toArrayData","getVirtualXValues","limit","processChartSeries","xValue","yValue","lValue","pArr","inc","dtVal","seriesName","pObj","yInc","sArr","skipFormula","rDiff","cDiff","xName","yName","marker","shape","dataLabel","radius","startAngle","endAngle","innerRadius","explode","explodeOffset","explodeIndex","retVal","primaryYAxisFormat","focusChartRange","borderIdx","eleColl","tdIdx","argsOpt","isRangeSelect","isRowLesser","reqType","shapeType","chartRange","primaryYAxis","lineStyle","majorTickLines","majorGridLines","minorGridLines","minorTickLines","labelFormat","eleRange","chartContent","primaryXAxis","valueType","chartArea","tooltip","load","selectedTheme","beforeResize","cancelResizedEvent","enableSmartLabels","enableAnimation","legendSettings","location","hash","accumulation","chartElements","chartLength","isRemoveEle","BasicModule","Spreadsheet","AllModule","ScrollSettings","SelectionSettings","Custom","defaultLocale","FindValue","ReplaceValue","FindReplaceTooltip","InsertingEmptyValue","ReplaceAllEnd","ByRow","ByColumn","MatchCase","MatchExactCellElements","Replace","Find","Goto","EntercellAddress","GotoSpecial","FindNextBtn","FindPreviousBtn","ReplaceBtn","ReplaceAllBtn","GotoHeader","GotoSpecialHeader","NoElements","FindWhat","ReplaceWith","Cut","Copy","Paste","PasteSpecial","Link","EditHyperlink","OpenHyperlink","RemoveHyperlink","InsertLink","EditLink","All","Values","Formats","Bold","Font","FontSize","Italic","Underline","Strikethrough","TextColor","FillColor","HorizontalAlignment","AlignLeft","AlignCenter","AlignRight","VerticalAlignment","AlignTop","AlignMiddle","AlignBottom","MergeCells","MergeAll","MergeHorizontally","MergeVertically","Unmerge","UnmergeCells","SelectMergeType","MergeCellsAlert","PasteMergeAlert","Borders","TopBorders","LeftBorders","RightBorders","BottomBorders","AllBorders","HorizontalBorders","VerticalBorders","OutsideBorders","InsideBorders","NoBorders","BorderColor","BorderStyle","InsertFunction","Rename","Hide","Unhide","NameBox","ShowHeaders","HideHeaders","ShowGridLines","HideGridLines","AddSheet","ListAllSheets","FullScreen","CollapseToolbar","ExpandToolbar","CollapseFormulaBar","ExpandFormulaBar","File","Home","Formulas","View","New","SaveAs","Update","ExcelXlsx","ExcelXls","CSV","SortAscending","SortDescending","CustomSort","AddColumn","ContainsHeader","CaseSensitive","SortBy","ThenBy","SelectAColumn","SortEmptyFieldError","SortDuplicateFieldError","SortAndFilter","ClearAllFilter","ClearFilterFrom","ReapplyFilter","FilterCellValue","FilterOutOfRangeError","HideRow","HideRows","UnHideRows","HideColumn","HideColumns","UnHideColumns","InsertRow","InsertRows","Above","Below","InsertColumn","InsertColumns","Before","After","DeleteRow","DeleteRows","DeleteColumn","DeleteColumns","Ok","Close","Cancel","Apply","MoreColors","StandardColors","General","Currency","Accounting","ShortDate","LongDate","Time","Percentage","Fraction","Scientific","Text","MobileFormulaBarPlaceHolder","PasteAlert","DestroyAlert","SheetRenameInvalidAlert","SheetRenameEmptyAlert","SheetRenameAlreadyExistsAlert","DeleteSheetAlert","DeleteSingleLastSheetAlert","PickACategory","Description","UnsupportedFile","InvalidUrl","SUM","SUMIF","SUMIFS","ABS","RAND","RANDBETWEEN","FLOOR","CEILING","PRODUCT","INT","ROUNDUP","SUMPRODUCT","TODAY","AVERAGE","AVERAGEIF","AVERAGEIFS","AVERAGEA","COUNT","COUNTIF","COUNTIFS","COUNTA","MIN","MAX","DATE","DAY","DAYS","IF","IFS","CalculateAND","CalculateOR","IFERROR","CHOOSE","INDEX","FIND","CONCATENATE","CONCAT","SUBTOTAL","RADIANS","MATCH","LN","INTERCEPT","SLOPE","DefineNameExists","DefineNameInValid","CircularReference","ShowRowsWhere","OR","AND","CustomFilterDatePlaceHolder","CustomFilterPlaceHolder","CustomFilter","Between","DateTimeFilter","Undo","Redo","DateFilter","TextFilter","NumberFilter","ClearFilter","NoResult","FilterFalse","FilterTrue","Blanks","SelectAll","GreaterThanOrEqual","GreaterThan","LessThanOrEqual","LessThan","NotEqual","Equal","Contains","EndsWith","StartsWith","ClearButton","FilterButton","CancelButton","OKButton","UnprotectSheet","LockCells","SelectCells","FormatCells","FormatRows","FormatColumns","InsertLinks","ProtectContent","ProtectAllowUser","EditAlert","SearchWithin","SearchBy","Reference","CLEARALL","APPLY","CellRange","Allow","Data","Minimum","Maximum","IgnoreBlank","WholeNumber","Decimal","TextLength","List","NotBetween","EqualTo","NotEqualTo","Greaterthan","Lessthan","GreaterThanOrEqualTo","LessThanOrEqualTo","InCellDropDown","Sources","Value","Retry","EnterValue","DialogError","ListLengthError","ValidationError","EmptyError","ClearHighlight","HighlightInvalidData","ClearValidation","HighlightCellsRules","CFEqualTo","TextThatContains","ADateOccuring","DuplicateValues","TopBottomRules","Top10Items","Top10","Bottom10Items","Bottom10","AboveAverage","BelowAverage","FormatCellsGreaterThan","FormatCellsLessThan","FormatCellsBetween","FormatCellsEqualTo","FormatCellsThatContainTheText","FormatCellsThatContainADateOccurring","FormatCellsDuplicate","FormatCellsTop","FormatCellsBottom","FormatCellsAbove","FormatCellsBelow","With","DataBars","ColorScales","IconSets","ClearRules","SelectedCells","EntireSheet","ISNUMBER","ROUND","GEOMEAN","POWER","LOG","TRUNC","EXP","Clear","ClearContents","ClearAll","ClearFormats","ClearHyperlinks","LightRedFillWithDarkRedText","YellowFillWithDarkYellowText","GreenFillWithDarkGreenText","RedFill","RedText","Duplicate","Unique","And","WebPage","ThisDocument","DisplayText","Url","CellReference","DefinedNames","EnterTheTextToDisplay","EnterTheUrl","BlueDataBar","GreenDataBar","RedDataBar","OrangeDataBar","LightblueDataBar","PurpleDataBar","GYRColorScale","RYGColorScale","GWRColorScale","RWGColorScale","BWRColorScale","RWBColorScale","WRColorScale","RWColorScale","GWColorScale","WGColorScale","GYColorScale","YGColorScale","ThreeArrowsColor","ThreeArrowsGray","ThreeTriangles","FourArrowsColor","FourArrowsGray","FiveArrowsColor","FiveArrowsGray","ThreeTrafficLights1","ThreeTrafficLights2","ThreeSigns","FourTrafficLights","RedToBlack","ThreeSymbols1","ThreeSymbols2","ThreeFlags","ThreeStars","FourRatings","FiveQuarters","FiveRatings","FiveBoxes","Bar","Area","Pie","Doughnut","PieAndDoughnut","Line","Radar","Scatter","ChartDesign","ClusteredColumn","StackedColumn","StackedColumn100","ClusteredBar","StackedBar","StackedBar100","StackedArea","StackedArea100","StackedLine","StackedLine100","SheetRender","freezePane","colGroupWidth","refreshSelectALLContent","getSelectAllTable","headerPanel","updateLeftColGroup","getRowHeaderPanel","detachColGroup","colGrp","colGrpWidth","getSelectAllContent","getColHeaderPanel","getContentPanel","renderPanel","contentPanel","initHeaderPanel","updateHideHeaders","createTable","createHeaderTable","updateTable","rowHdrEle","tagName","renderTable","rHdrTBody","cHdrTHead","cHdrRow","cTBody","attributes","aria-rowcount","aria-colcount","renderRowHeader","initLoad","triggerCreatedEvent","createdHandler","observers","refreshColumnContent","checkColMerge","refreshRowContent","hTBody","checkRowMerge","formatUnit","updateColContent","refChild","hRefChild","skipRender","colRefChild","updateRowContent","rFrag","cKey","firstcell","refreshPrevMerge","currTopIdx","renderHeaders","rowIndexes","colIndexes","cFrag","cTHead","cRow","RowRenderer","isRowHeader","aria-rowindex","CellRenderer","th","tableRow","updateView","aria-colindex","tabindex","checkMerged","compiledTemplate","processTemplates","evtArgs","formatArgs","removeStyle","compileCellTemplate","templateString","compile","compiledStr","clonedCell","previouseHeight","getRowHeightOnInit","tTable","rightBorder_1","bottomBorder_1","prevRowCell","prevColCell","cRange","Render","renderSheet","checkTopLeftCell","lastRow","lastCol","roundValue","roundedValue","instantiateRenderer","Dialog","dialogModel","cancelBtn","btnContent","closeHandler","div","DialogComponent","ActionEvents","initializeActionBegin","beforeCellFormat","actionEventHandler","evtFunc","actionType","eventType","beforeSave","beforeSort","initializeActionComplete","cellSave","actionBeginHandler","actionCompleteHandler","Overlay","isOverlayClicked","isResizerClicked","currenHeight","class","renderResizeHandles","originalWidth","originalHeight","overlayClickHandler","overlayMouseMoveHandler","overlayMouseUpHandler","resizer","height1","originalMouseY","originalResizeTop","resizedReorderTop","width1","pageX","originalMouseX","height2","pageY","width2","originalResizeLeft","resizedReorderLeft","posX","posY","aX","diffX","aY","diffY","originalReorderTop","originalReorderLeft","actOverlayElem","handleElem","handles","needsID","Spreadsheet_1","initServices","renderSpreadsheet","setHeight","setWidth","createSpinner","findAll","addrArr","insideDomCount","cVTrack","rVTrack","vWidth","vHeight","scrollableSize","resize","activeAddress","colThreshold","mIndex","colWidth","eleWidth","oldIdx","edited","maximumColInx","startIsCol","endIsCol","starttoend","startValues","getAddress","endValues","cellMod","eleRowIdx","eleColIdx","isMethod","addrRange","mCell","isDevice","circularArgs","spanElem","alignClass","createTextNode","nodeValue","borderWidth","nextTab","indicator","undo","redo","mouseClickHandler","closeEdit","newRangeIdx_1","ranges_1","isLastRange"],"mappings":"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"}