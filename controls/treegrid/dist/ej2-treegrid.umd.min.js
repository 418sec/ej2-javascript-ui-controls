!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("@syncfusion/ej2-base"),require("@syncfusion/ej2-grids"),require("@syncfusion/ej2-buttons"),require("@syncfusion/ej2-data"),require("@syncfusion/ej2-popups")):"function"==typeof define&&define.amd?define(["exports","@syncfusion/ej2-base","@syncfusion/ej2-grids","@syncfusion/ej2-buttons","@syncfusion/ej2-data","@syncfusion/ej2-popups"],t):t(e.ej={},e.ej2Base,e.ej2Grids,e.ej2Buttons,e.ej2Data,e.ej2Popups)}(this,function(e,t,i,r,n,o){"use strict";function s(e){if(e.dataSource instanceof n.DataManager){var t=e.dataSource.adaptor;return t instanceof n.ODataAdaptor||t instanceof n.WebApiAdaptor||t instanceof n.WebMethodAdaptor||t instanceof n.CacheAdaptor||t instanceof n.UrlAdaptor}return!1}function a(e){var t;t=[];for(var r=0,n=Object.keys(e).length;r<n;r++){i.getObject("hasChildRecords",e[r])&&t.push(e[r])}return t}function l(e,i,r){var n,o=t.isNullOrUndefined(i.parentItem)?null:u(e,i.parentItem.uniqueID);return null==o||(!e.initialRender||t.isNullOrUndefined(o[e.expandStateMapping])||o[e.expandStateMapping]?!1!==o.expanded&&(!o.parentItem||((n=u(e,o.parentItem.uniqueID))&&e.initialRender&&!t.isNullOrUndefined(n[e.expandStateMapping])&&!n[e.expandStateMapping]?(n.expanded=!1,!1):(!n||!1!==n.expanded)&&(!n||l(e,n,r)))):(o.expanded=!1,!1))}function d(e){var i=[];if(t.isNullOrUndefined(e)||!e.hasChildRecords)return[];for(var r=e.childRecords,n=0,o=Object.keys(r).length;n<o;n++)i.push(r[n]),r[n].hasChildRecords&&(i=i.concat(d(r[n])));return i}function p(e){if(s(e)){var i=e.dataSource;return!t.isNullOrUndefined(i.ready)}return!0}function c(e){for(var t,i,r=[],n=0;n<e.length;n++){i=Object.keys(e[n]),t={};for(var o=0;o<i.length;o++)t[i[o]]=e[n][i[o]];r.push(t)}return r}function h(e){return delete e.hasChildRecords,delete e.childRecords,delete e.index,delete e.parentItem,delete e.level,e}function u(e,t,i){if(i){return e.uniqueIDFilterCollection[t]}return e.uniqueIDCollection[t]}function g(e,i,r,o,s,a,l){var d,p,u=e.value,g=e.action,m=i.grid.getPrimaryKeyFieldNames()[0],v=i.dataSource instanceof n.DataManager?i.dataSource.dataSource.json:i.dataSource,w=[],x=u,C=!1;i.grid.getCurrentViewRecords();if("add"===g){var b=function(e,i,r,n,o,s,a){var l,d=!1,p=r.grid.getCurrentViewRecords();switch(l=t.extend({},e.value),l=h(l),r.editSettings.newRowPosition){case"Top":i.unshift(l),d=!0;break;case"Bottom":i.push(l),d=!0;break;case"Above":l=t.isNullOrUndefined(a)?p[o+1]:a;break;case"Below":case"Child":l=t.isNullOrUndefined(a)?p[o]:a,-1===s&&(i.unshift(l),d=!0)}return{value:l,isSkip:d}}(e,v,i,0,o,s,l);u=b.value,C=b.isSkip}if(u instanceof Array?w=c(u):w.push(t.extend({},u)),!C&&("add"!==g||"Top"!==i.editSettings.newRowPosition&&"Bottom"!==i.editSettings.newRowPosition))for(var S=0;S<w.length;S++){var R=Object.keys(w[S]);d=v.length;for(var M=function(){if(v[d][m]===w[S][m]){if("delete"!==g){if("edit"===g)for(p=0;p<R.length;p++)!v[d].hasOwnProperty(R[p])||"Cell"===i.editSettings.mode&&R[p]!==a||(v[d][R[p]]=w[S][R[p]]);else if("add"===g){var e=void 0;"Child"===i.editSettings.newRowPosition?r?(x[i.parentIdMapping]=v[d][i.idMapping],v.splice(d+1,0,x)):(v[d].hasOwnProperty(i.childMapping)||(v[d][i.childMapping]=[]),v[d][i.childMapping].push(x),y(m,v[d],g,i,r)):"Below"===i.editSettings.newRowPosition?v.splice(d+1,0,x):o?"Above"===i.editSettings.newRowPosition&&v.splice(d,0,x):(e=0,v.splice(e,0,x))}return"break"}var n=v[d];if(v.splice(d,1),r){if(!t.isNullOrUndefined(n[i.parentIdMapping]))for(var s=i.flatData.filter(function(e){return e[i.idMapping]===n[i.parentIdMapping]})[0],l=s?s[i.childMapping]:[],c=l.length-1;c>=0;c--)if(l[c][i.idMapping]===n[i.idMapping]){l.splice(c,1),l.length||(s.hasChildRecords=!1,y(m,s,g,i,r));break}return"break"}}else t.isNullOrUndefined(v[d][i.childMapping])||f(v[d][i.childMapping],w[S],g,m,i,r,x,a)&&y(m,v[d],g,i,r)};d--&&d>=0;){if("break"===M())break}}}function f(e,i,r,n,o,s,a,l){for(var d=!1,p=e.length;p--&&p>=0;)if(e[p][n]===i[n]||s&&e[p][o.parentIdMapping]===i[o.idMapping]){if("edit"===r){for(var c=Object.keys(i),h=0;h<c.length;h++)!e[p].hasOwnProperty(c[h])||"Cell"===o.editSettings.mode&&c[h]!==l||(e[p][c[h]]=i[c[h]]);break}if("add"===r)"Child"===o.editSettings.newRowPosition?s?(a[o.parentIdMapping]=e[p][o.idMapping],e.splice(p+1,0,a),y(n,e[p],r,o,s)):(e[p].hasOwnProperty(o.childMapping)||(e[p][o.childMapping]=[]),e[p][o.childMapping].push(a),y(n,e[p],r,o,s)):"Above"===o.editSettings.newRowPosition?e.splice(p,0,a):"Below"===o.editSettings.newRowPosition&&e.splice(p+1,0,a);else{e[p].parentItem;e.splice(p,1),e.length||(d=!0)}}else t.isNullOrUndefined(e[p][o.childMapping])||f(e[p][o.childMapping],i,r,n,o,s,a,l)&&y(n,e[p],r,o,s);return d}function y(e,i,r,n,o,s){var a,l=n.grid.getCurrentViewRecords();if(l.map(function(t,r){t[e]!==i[e]||(a=r)}),i=l[a],i.hasChildRecords=!1,"add"===r){i.expanded=!0,i.hasChildRecords=!0,n.sortSettings.columns.length&&t.isNullOrUndefined(s)&&(s=l.filter(function(e){return e.parentUniqueID===i.uniqueID?e:null}));var d=s?s instanceof Array?s[0]:s:l[a+1];i.hasOwnProperty("childRecords")||(i.childRecords=[]),-1===i.childRecords.indexOf(d)&&i.childRecords.unshift(d),o&&(i.hasOwnProperty(n.childMapping)||(i[n.childMapping]=[]),-1===i.childRecords.indexOf(d)&&i[n.childMapping].unshift(d))}n.grid.setRowData(e,i);var p=n.getRowByIndex(a);n.renderModule.cellRender({data:i,cell:p.cells[n.treeColumnIndex],column:n.grid.getColumns()[n.treeColumnIndex]})}var m=function(){return function(e){this.allowEditing=!0,this.edit={},this.allowReordering=!0,this.showColumnMenu=!0,this.allowFiltering=!0,this.allowSorting=!0,this.allowResizing=!0,this.filter={},t.merge(this,e)}}(),v=function(){var e=function(t,i){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(t,i)};return function(t,i){function r(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),w=function(e,t,i,r){var n,o=arguments.length,s=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,r);else for(var a=e.length-1;a>=0;a--)(n=e[a])&&(s=(o<3?n(s):o>3?n(t,i,s):n(t,i))||s);return o>3&&s&&Object.defineProperty(t,i,s),s},x=function(e){function r(){return null!==e&&e.apply(this,arguments)||this}return v(r,e),w([t.Collection([],i.Predicate)],r.prototype,"columns",void 0),w([t.Property("FilterBar")],r.prototype,"type",void 0),w([t.Property()],r.prototype,"mode",void 0),w([t.Property(!0)],r.prototype,"showFilterBarStatus",void 0),w([t.Property(1500)],r.prototype,"immediateModeDelay",void 0),w([t.Property()],r.prototype,"operators",void 0),w([t.Property(!1)],r.prototype,"ignoreAccent",void 0),w([t.Property("Parent")],r.prototype,"hierarchyMode",void 0),r}(t.ChildProperty),C="rowDataBound",b="queryCellInfo",S="beforeDataBound",R="actionBegin",M="actionComplete",I="rowSelected",P="checkboxChange",E="rowDeselected",O="toolbarClick",D="beforeExcelExport",k="beforePdfExport",A="resizeStop",N="expanded",q="collapsed",j="collapsing",L="remoteExpand",T="localPagedExpandCollapse",U="pagingActions",F="printGrid-Init",B="contextMenuOpen",V="contextMenuClick",_="crudAction",H="beginEdit",G="beginAdd",Q="recordDoubleClick",z="cellSave",W="cellEdit",K="batchCancel",J="key-pressed",X="double-tap",Y="edit-form",Z="before-batch-cancel",$=function(){function e(e){this.parent=e,this.selectedItems=[],this.selectedIndexes=[],this.addEventListener()}return e.prototype.getModuleName=function(){return"selection"},e.prototype.addEventListener=function(){this.parent.on("headerCheckbox",this.headerCheckbox,this),this.parent.on("columnCheckbox",this.columnCheckbox,this),this.parent.on("updateGridActions",this.updateGridActions,this),this.parent.on("checkboxSelection",this.checkboxSelection,this)},e.prototype.removeEventListener=function(){this.parent.isDestroyed||(this.parent.off("renderHeaderCheckbox",this.headerCheckbox),this.parent.off("renderCheckbox",this.columnCheckbox),this.parent.off("checkboxSelection",this.checkboxSelection),this.parent.off("updateCheckboxes",this.updateGridActions))},e.prototype.destroy=function(){this.removeEventListener()},e.prototype.checkboxSelection=function(e){var t,r=i.getObject("target",e),n=i.parentsUntil(r,"e-checkbox-wrapper");if(n&&n.querySelectorAll(".e-treecheckselect").length>0){t=n.querySelector('input[type="checkbox"]');var o=void 0;(o=[]).push(r.closest("tr").rowIndex);this.triggerChkChangeEvent(t,t.nextElementSibling.classList.contains("e-check"),r.closest("tr")).cancel||this.selectCheckboxes(o)}else if(n&&n.querySelectorAll(".e-treeselectall").length>0&&this.parent.autoCheckHierarchy){var s=!n.querySelector(".e-frame").classList.contains("e-check")&&!n.querySelector(".e-frame").classList.contains("e-stop");this.headerSelection(s)}},e.prototype.triggerChkChangeEvent=function(e,t,i){var r={checked:t,target:e,cancel:!1,rowElement:i,rowData:this.parent.getCurrentViewRecords()[i.rowIndex]};return this.parent.trigger(P,r),r},e.prototype.getCheckboxcolumnIndex=function(){for(var e,t,i=this.parent.columns,r=0;r<i.length;r++)i[r].showCheckbox&&(e=this.parent.columns[r].uid);for(var n=this.parent.getHeaderTable().querySelectorAll(".e-headercelldiv").length,o=0;o<n;o++){this.parent.getHeaderTable().querySelectorAll(".e-headercelldiv")[o].getAttribute("e-mappinguid")===e&&(t=o)}return t},e.prototype.headerCheckbox=function(){if(this.columnIndex=this.getCheckboxcolumnIndex(),this.columnIndex>-1&&0===this.parent.getHeaderTable().querySelectorAll(".e-treeselectall").length){var e=this.parent.getHeaderTable().querySelectorAll(".e-headercelldiv")[this.columnIndex],i=void 0,n=this.parent.createElement("input",{className:"e-treeselectall",attrs:{type:"checkbox"}});(i=r.createCheckBox(this.parent.createElement,!1,{checked:!1,label:" "})).classList.add("e-hierarchycheckbox"),i.insertBefore(n.cloneNode(),i.firstChild),t.isNullOrUndefined(e)||e.insertBefore(i,e.firstChild),this.headerSelection()}},e.prototype.renderColumnCheckbox=function(e){var i,n=this.parent.createElement("input",{className:"e-treecheckselect",attrs:{type:"checkbox"}}),o=e.data;e.cell.classList.add("e-treegridcheckbox"),e.cell.setAttribute("aria-label","checkbox");var s=!t.isNullOrUndefined(o.checkboxState)&&"uncheck"!==o.checkboxState;if((i=r.createCheckBox(this.parent.createElement,!1,{checked:s,label:" "})).classList.add("e-hierarchycheckbox"),"indeterminate"===o.checkboxState){var a=i.querySelectorAll(".e-frame")[0];t.removeClass([a],["e-check","e-stop","e-uncheck"]),i.querySelector(".e-frame").classList.add("e-stop")}return i.insertBefore(n.cloneNode(),i.firstChild),i},e.prototype.columnCheckbox=function(e){var i=this.renderColumnCheckbox(e),r=e.cell.querySelector(".e-treecolumn-container");if(t.isNullOrUndefined(r)){var n=i.querySelector(".e-label"),o=e.cell.innerHTML;e.cell.innerHTML="",n.innerHTML=o,e.cell.appendChild(i)}else r.insertBefore(i,r.querySelectorAll(".e-treecell")[0])},e.prototype.selectCheckboxes=function(e){for(var t=0;t<e.length;t++){var i=this.parent.getCurrentViewRecords()[e[t]],r="uncheck"===i.checkboxState?"check":"uncheck";i.checkboxState=r;for(var n=Object.keys(i),o=u(this.parent,i.uniqueID),s=0;s<n.length;s++)o.hasOwnProperty(n[s])&&(o[n[s]]=i[n[s]]);this.traverSelection(i,r,!1),this.parent.autoCheckHierarchy&&this.headerSelection()}},e.prototype.traverSelection=function(e,i,r){var n=0;if(this.updateSelectedItems(e,i),!r&&e.parentItem&&this.parent.autoCheckHierarchy&&this.updateParentSelection(e.parentItem),e.childRecords&&this.parent.autoCheckHierarchy){var o=e.childRecords;!t.isNullOrUndefined(this.parent.filterModule)&&this.parent.filterModule.filteredResult.length>0&&this.parent.autoCheckHierarchy&&(o=this.getFilteredChildRecords(o)),n=o.length;for(var s=0;s<n;s++)o[s].hasChildRecords?this.traverSelection(o[s],i,!0):this.updateSelectedItems(o[s],i)}},e.prototype.getFilteredChildRecords=function(e){var t=this;return e.filter(function(e){return t.parent.filterModule.filteredResult.indexOf(e)>-1})},e.prototype.updateParentSelection=function(e){var i=0,r=[],n=u(this.parent,e.uniqueID);n&&n.childRecords&&(r=n.childRecords),!t.isNullOrUndefined(this.parent.filterModule)&&this.parent.filterModule.filteredResult.length>0&&this.parent.autoCheckHierarchy&&(r=this.getFilteredChildRecords(r)),i=r&&r.length;var o=0,s=0;if(!t.isNullOrUndefined(n)){for(var a=0;a<r.length;a++)"indeterminate"===r[a].checkboxState?o++:"check"===r[a].checkboxState&&s++;n.checkboxState=o>0||s>0&&s!==i?"indeterminate":0===s&&0===o?"uncheck":"check",this.updateSelectedItems(n,n.checkboxState),n.parentItem&&this.updateParentSelection(n.parentItem)}},e.prototype.headerSelection=function(e){var i=0,r=!t.isNullOrUndefined(this.parent.filterModule)&&this.parent.filterModule.filteredResult.length>0?this.parent.filterModule.filteredResult:this.parent.flatData;if(!t.isNullOrUndefined(e))for(var n=0;n<r.length;n++)if(e){if("check"===r[n].checkboxState)continue;r[n].checkboxState="check",this.updateSelectedItems(r[n],r[n].checkboxState)}else this.selectedItems.indexOf(r[n])>-1&&(r[n].checkboxState="uncheck",this.updateSelectedItems(r[n],r[n].checkboxState),this.parent.autoCheckHierarchy&&this.updateParentSelection(r[n]));i=this.selectedItems.length;var o=this.parent.getHeaderTable().querySelectorAll(".e-frame")[0];i>0&&r.length>0?i!==r.length?(t.removeClass([o],["e-check"]),o.classList.add("e-stop")):(t.removeClass([o],["e-stop"]),o.classList.add("e-check")):t.removeClass([o],["e-check","e-stop"])},e.prototype.updateSelectedItems=function(e,i,r){var n,o=this.parent.getCurrentViewRecords().filter(function(t){return t.uniqueID===e.uniqueID}),s=this.parent.getCurrentViewRecords().indexOf(o[0]);if(s>-1){n=this.parent.getRows()[s].querySelectorAll(".e-frame")[0],t.isNullOrUndefined(n)||t.removeClass([n],["e-check","e-stop","e-uncheck"])}if(e.checkboxState=i,"check"===i&&t.isNullOrUndefined(e.isSummaryRow))-1!==s&&-1===this.selectedIndexes.indexOf(s)&&this.selectedIndexes.push(s),-1===this.selectedItems.indexOf(e)&&-1!==s&&!t.isNullOrUndefined(this.parent.filterModule)&&this.parent.filterModule.filteredResult.length>0&&this.selectedItems.push(e),-1!==this.selectedItems.indexOf(e)||t.isNullOrUndefined(this.parent.filterModule)||0!==this.parent.filterModule.filteredResult.length||this.selectedItems.push(e),-1===this.selectedItems.indexOf(e)&&t.isNullOrUndefined(this.parent.filterModule)&&this.selectedItems.push(e);else if(("uncheck"===i||"indeterminate"===i)&&t.isNullOrUndefined(e.isSummaryRow)){var a=this.selectedItems.indexOf(e);if(-1!==a&&this.selectedItems.splice(a,1),-1!==this.selectedIndexes.indexOf(s)){var l=this.selectedIndexes.indexOf(s);this.selectedIndexes.splice(l,1)}}var d="indeterminate"===i?"e-stop":"e-"+i;s>-1&&(t.isNullOrUndefined(n)||n.classList.add(d))},e.prototype.updateGridActions=function(e){var i,r,n=this,o=e.requestType;if(this.parent.autoCheckHierarchy)if("sorting"===o||"paging"===o){r=(i=this.parent.getCurrentViewRecords()).length,this.selectedIndexes=[];for(var s=0;s<r;s++)this.updateSelectedItems(i[s],i[s].checkboxState,!0)}else if("delete"===o||"add"===e.action){var a=[];"delete"===o?a=e.data:a.push(e.data);for(s=0;s<a.length;s++){if("delete"===o){var l=this.parent.flatData.indexOf(a[s]),d=this.selectedIndexes.indexOf(l);this.selectedIndexes.splice(d,1),this.updateSelectedItems(a[s],"uncheck")}t.isNullOrUndefined(a[s].parentItem)||this.updateParentSelection(a[s].parentItem)}}else"add"===e.requestType&&this.parent.autoCheckHierarchy?e.data.checkboxState="uncheck":"filtering"!==o&&"searching"!==o||(this.selectedItems=[],this.selectedIndexes=[],(i=this.parent.filterModule.filteredResult.length>0?this.parent.getCurrentViewRecords():this.parent.flatData).forEach(function(e){e.hasChildRecords?n.updateParentSelection(e):n.updateSelectedItems(e,e.checkboxState)}),this.headerSelection())},e.prototype.getCheckedrecords=function(){return this.selectedItems},e.prototype.getCheckedRowIndexes=function(){return this.selectedIndexes},e}(),ee=function(){function e(e){i.Grid.Inject(i.ColumnMenu),this.parent=e}return e.prototype.getColumnMenu=function(){return this.parent.grid.columnMenuModule.getColumnMenu()},e.prototype.destroy=function(){},e.prototype.getModuleName=function(){return"columnMenu"},e}(),te=function(){function e(e){this.parent=e,i.Grid.Inject(i.Print),this.addEventListener()}return e.prototype.getModuleName=function(){return"print"},e.prototype.addEventListener=function(){this.parent.grid.on(F,this.printTreeGrid,this)},e.prototype.removeEventListener=function(){this.parent.grid.off(F,this.printTreeGrid)},e.prototype.printTreeGrid=function(e){var r=i.getObject("printgrid",e),n=i.getObject("element",e);r.addEventListener(b,this.parent.grid.queryCellInfo),r.addEventListener(C,this.parent.grid.rowDataBound),r.addEventListener(S,this.parent.grid.beforeDataBound),t.addClass([n],"e-treegrid")},e.prototype.print=function(){this.parent.grid.print()},e.prototype.destroy=function(){this.removeEventListener()},e}(),ie=function(){var e=function(t,i){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(t,i)};return function(t,i){function r(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),re=function(e,t,i,r){var n,o=arguments.length,s=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,r);else for(var a=e.length-1;a>=0;a--)(n=e[a])&&(s=(o<3?n(s):o>3?n(t,i,s):n(t,i))||s);return o>3&&s&&Object.defineProperty(t,i,s),s},ne=function(e){function i(){return null!==e&&e.apply(this,arguments)||this}return ie(i,e),re([t.Property()],i.prototype,"fields",void 0),re([t.Property(!1)],i.prototype,"ignoreCase",void 0),re([t.Property()],i.prototype,"operators",void 0),re([t.Property()],i.prototype,"key",void 0),re([t.Property()],i.prototype,"hierarchyMode",void 0),i}(t.ChildProperty),oe=function(){var e=function(t,i){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(t,i)};return function(t,i){function r(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),se=function(e,t,i,r){var n,o=arguments.length,s=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,r);else for(var a=e.length-1;a>=0;a--)(n=e[a])&&(s=(o<3?n(s):o>3?n(t,i,s):n(t,i))||s);return o>3&&s&&Object.defineProperty(t,i,s),s},ae=function(e){function i(){return null!==e&&e.apply(this,arguments)||this}return oe(i,e),se([t.Property("Row")],i.prototype,"mode",void 0),se([t.Property("Flow")],i.prototype,"cellSelectionMode",void 0),se([t.Property("Single")],i.prototype,"type",void 0),se([t.Property(!1)],i.prototype,"persistSelection",void 0),se([t.Property("Default")],i.prototype,"checkboxMode",void 0),se([t.Property(!1)],i.prototype,"checkboxOnly",void 0),i}(t.ChildProperty),le=function(){function e(e){this.parent=e}return e.prototype.RowModifier=function(e){if(e.data){var r,n=e.data,o=n.parentItem;if(t.isNullOrUndefined(n.parentItem)||this.parent.allowPaging&&"Root"!==this.parent.pageSettings.pageSizeMode&&(!s(this.parent)||p(this.parent)))r=+e.row.getAttribute("aria-rowindex");else{r=n.parentItem.index;(this.parent.initialRender&&(!(t.isNullOrUndefined(o[this.parent.expandStateMapping])||o[this.parent.expandStateMapping])||this.parent.enableCollapseAll)||!l(this.parent,e.data,this.parent.grid.getCurrentViewRecords()))&&(e.row.style.display="none")}if(s(this.parent)&&!p(this.parent)){var a=this.parent,d=this.parent.getCurrentViewRecords().filter(function(e){return t.getValue(a.idMapping,e)===t.getValue(a.parentIdMapping,n)});if(d.length>0){var c=d[0].expanded?"table-row":"none";e.row.setAttribute("style","display: "+c+";")}}t.addClass([e.row],"e-gridrowindex"+r+"level"+e.data.level);i.getObject("isSummaryRow",e.data)&&t.addClass([e.row],"e-summaryrow"),this.parent.trigger(C,e)}},e.prototype.cellRender=function(e){if(e.data){var r,n=this.parent.grid,o=e.data,s=t.isNullOrUndefined(o.filterLevel)?o.level:o.filterLevel,a=0,d=this.parent.getColumnByField(e.column.field),p=o.isSummaryRow;if(n.getColumnIndexByUid(e.column.uid)===this.parent.treeColumnIndex){for(var c=t.createElement("div",{className:"e-treecolumn-container"}),h=t.createElement("span",{className:"e-icons e-none",styles:"width: 10px; display: inline-block"}),u=0;u<s;u++)a+=10,c.appendChild(h.cloneNode());var g=t.isNullOrUndefined(o.hasFilteredChildRecords)?o.hasChildRecords:o.hasFilteredChildRecords;if(g&&!t.isNullOrUndefined(o.childRecords)&&(g=!(0===o.childRecords.length)),g){t.addClass([e.cell],"e-treerowcell");var f=t.createElement("span",{className:"e-icons"}),y=void 0;y=this.parent.initialRender?o.expanded&&(t.isNullOrUndefined(o[this.parent.expandStateMapping])||o[this.parent.expandStateMapping])&&!this.parent.enableCollapseAll:!(!o.expanded||!l(this.parent,o,this.parent.grid.getCurrentViewRecords()));var m=!0;t.isNullOrUndefined(o.parentItem)||t.isNullOrUndefined(o[this.parent.expandStateMapping])||!o[this.parent.expandStateMapping]||this.parent.allowPaging&&"Root"!==this.parent.pageSettings.pageSizeMode||(m=!l(this.parent,e.data,this.parent.grid.getCurrentViewRecords())),t.addClass([f],y&&m?"e-treegridexpand":"e-treegridcollapse"),a+=18,c.appendChild(f),h.style.width="7px",a+=7,c.appendChild(h.cloneNode())}else s&&(a+=20,c.appendChild(h.cloneNode()),c.appendChild(h.cloneNode()));r=t.createElement("span",{className:"e-treecell"}),this.parent.allowTextWrap&&(r.style.width="Calc(100% - "+a+"px)");var v=null!=e.cell.querySelector(".e-treecell")?e.cell.querySelector(".e-treecell").innerHTML:e.cell.innerHTML;r.innerHTML=v,c.appendChild(r),e.cell.innerHTML="",e.cell.appendChild(c)}if(!t.isNullOrUndefined(d)&&d.showCheckbox&&(this.parent.notify("columnCheckbox",e),this.parent.allowTextWrap)){var w=e.cell.querySelectorAll(".e-frame")[0];a+=parseInt(w.style.width,16),r.style.width="Calc(100% - "+a+"px)"}if(p){t.addClass([e.cell],"e-summarycell");var x=i.getObject(e.column.field,e.data);null!=e.cell.querySelector(".e-treecell")?e.cell.querySelector(".e-treecell").innerHTML=x:e.cell.innerHTML=x}this.parent.trigger(b,e)}},e}(),de=function(){function e(e){i.Grid.Inject(i.Sort),this.parent=e,this.taskIds=[],this.flatSortedData=[],this.storedIndex=-1,this.isSelfReference=!t.isNullOrUndefined(this.parent.parentIdMapping),this.addEventListener()}return e.prototype.getModuleName=function(){return"sort"},e.prototype.addEventListener=function(){this.parent.on("updateModel",this.updateModel,this),this.parent.on("createSort",this.createdSortedRecords,this)},e.prototype.removeEventListener=function(){this.parent.isDestroyed||(this.parent.off("updateModel",this.updateModel),this.parent.off("createSort",this.createdSortedRecords))},e.prototype.createdSortedRecords=function(e){var t=e.modifiedData,i=e.srtQry;this.iterateSort(t,i),this.storedIndex=-1,this.parent.notify("updateAction",{result:this.flatSortedData}),this.flatSortedData=[]},e.prototype.iterateSort=function(e,i){for(var r=0;r<e.length;r++)if(this.parent.grid.filterSettings.columns.length>0?t.isNullOrUndefined(u(this.parent,e[r].uniqueID,!0))||(this.storedIndex++,this.flatSortedData[this.storedIndex]=e[r]):(this.storedIndex++,this.flatSortedData[this.storedIndex]=e[r]),e[r].hasChildRecords){var o=new n.DataManager(e[r].childRecords).executeLocal(i);this.iterateSort(o,i)}},e.prototype.sortColumn=function(e,t,i){this.parent.grid.sortColumn(e,t,i)},e.prototype.removeSortColumn=function(e){this.parent.grid.removeSortColumn(e)},e.prototype.updateModel=function(){this.parent.sortSettings=this.parent.grid.sortSettings},e.prototype.clearSorting=function(){this.parent.grid.clearSorting(),this.updateModel()},e.prototype.destroy=function(){this.removeEventListener()},e}(),pe=function(){function e(e){this.parent=e,this.parentItems=[],this.taskIds=[],this.hierarchyData=[],this.storedIndex=-1,this.sortedData=[],this.isSortAction=!1,this.addEventListener(),this.dataResults={},this.isSelfReference=!t.isNullOrUndefined(this.parent.parentIdMapping)}return e.prototype.addEventListener=function(){this.parent.on("updateRemoteLevel",this.updateParentRemoteData,this),this.parent.grid.on("sorting-begin",this.beginSorting,this),this.parent.on("updateAction",this.updateData,this),this.parent.on(L,this.collectExpandingRecs,this),this.parent.on("dataProcessor",this.dataProcessor,this)},e.prototype.removeEventListener=function(){this.parent.isDestroyed||(this.parent.off(L,this.collectExpandingRecs),this.parent.off("updateRemoteLevel",this.updateParentRemoteData),this.parent.off("updateAction",this.updateData),this.parent.off("dataProcessor",this.dataProcessor),this.parent.grid.off("sorting-begin",this.beginSorting))},e.prototype.destroy=function(){this.removeEventListener()},e.prototype.isRemote=function(){return this.parent.dataSource instanceof n.DataManager},e.prototype.convertToFlatData=function(e){var r=this;if(this.parent.flatData=0===Object.keys(e).length?this.parent.dataSource:[],this.parent.parentData=[],s(this.parent)&&!p(this.parent)&&e instanceof n.DataManager){var o=this.parent.dataSource;if(this.parent.parentIdMapping&&(this.parent.query=t.isNullOrUndefined(this.parent.query)?new n.Query:this.parent.query,this.parent.parentIdMapping&&this.parent.query.where(this.parent.parentIdMapping,"equal",null),!this.parent.hasChildMapping)){var a=this.parent.query.clone();a.queries=[],a=a.select([this.parent.parentIdMapping]),o.executeQuery(a).then(function(e){r.parentItems=n.DataUtil.distinct(e.result,r.parent.parentIdMapping,!1);0===i.getObject("dataSource.requests",r.parent).filter(function(e){return"OK"!==e.httpRequest.statusText}).length&&(t.setValue("grid.contentModule.isLoaded",!0,r.parent),t.isNullOrUndefined(r.zerothLevelData)||(t.setValue("cancel",!1,r.zerothLevelData),t.getValue("grid.renderModule",r.parent).dataManagerSuccess(r.zerothLevelData),r.zerothLevelData=null),r.parent.grid.hideSpinner())})}}else if(e instanceof Array){this.hierarchyData=[],this.taskIds=[];for(var l=0;l<Object.keys(e).length;l++){var d=e[l];this.hierarchyData.push(t.extend({},d)),t.isNullOrUndefined(d[this.parent.idMapping])||this.taskIds.push(d[this.parent.idMapping])}if(this.isSelfReference){var c=[],h=new n.DataManager(this.hierarchyData).executeLocal((new n.Query).group(this.parent.parentIdMapping));for(l=0;l<h.length;l++){var u=h[l],g=this.taskIds.indexOf(u.key);if(!t.isNullOrUndefined(u.key)&&g>-1){var f=u.items;this.hierarchyData[g][this.parent.childMapping]=f}else c.push.apply(c,u.items)}this.hierarchyData=this.selfReferenceUpdate(c)}Object.keys(this.hierarchyData).length?this.createRecords(this.hierarchyData):this.parent.flatData=this.parent.dataSource,this.storedIndex=-1}},e.prototype.selfReferenceUpdate=function(e){for(var t=[];this.hierarchyData.length>0&&e.length>0;){var i=e.indexOf(this.hierarchyData[0]);-1===i?this.hierarchyData.shift():(t.push(this.hierarchyData.shift()),e.splice(i,1))}return t},e.prototype.updateParentRemoteData=function(e){var i=e.result;if(this.parent.hasChildMapping||this.parentItems.length)for(var r=0;r<i.length;r++)(i[r][this.parent.hasChildMapping]||-1!==this.parentItems.indexOf(i[r][this.parent.idMapping]))&&t.isNullOrUndefined(i[r].index)&&(i[r].level=0,i[r].index=Math.ceil(1e3*Math.random()),i[r].hasChildRecords=!0);else this.zerothLevelData=e,t.setValue("cancel",!0,e);e.result=i,this.parent.notify("updateResults",e)},e.prototype.collectExpandingRecs=function(e){var r=this,n={row:e.parentRow,data:e.record};if(e.rows.length>0){e.record.expanded=!0;for(var s=0;s<e.rows.length;s++)e.rows[s].style.display="table-row";this.parent.trigger(N,n)}else{var a=this.parent.dataSource,l=this.parent.grid.getDataModule().generateQuery(),d=l.queries.filter(function(e){return"onPage"!==e.fn&&"onWhere"!==e.fn});l.queries=d,l.where(this.parent.parentIdMapping,"equal",e.record[this.parent.idMapping]),o.showSpinner(this.parent.element),a.executeQuery(l).then(function(s){for(var a=r.parent.grid.currentViewData,l=a.indexOf(e.record),d=i.getObject("actual.nextLevel",s),p=s.result,c=0;c<p.length;c++)p[c].level=e.record.level+1,p[c].index=Math.ceil(1e3*Math.random()),p[c].parentItem=e.record,!p[c][r.parent.hasChildMapping]&&-1===r.parentItems.indexOf(p[c][r.parent.idMapping])||d&&!d[c]||(p[c].hasChildRecords=!0,p[c].expanded=!1),a.splice(l+c+1,0,p[c]);t.setValue("result",a,s),t.setValue("action","beforecontentrender",s),r.parent.trigger(M,s),o.hideSpinner(r.parent.element),s.count=r.parent.grid.pageSettings.totalRecordsCount,t.getValue("grid.renderModule",r.parent).dataManagerSuccess(s),r.parent.trigger(N,n)})}},e.prototype.beginSorting=function(){this.isSortAction=!0},e.prototype.createRecords=function(e,r){for(var n=0,o=Object.keys(e).length;n<o;n++){var s=e[n],a=0;if(this.storedIndex++,s.index=this.storedIndex,t.isNullOrUndefined(s[this.parent.childMapping])||(s.childRecords=s[this.parent.childMapping],s.hasChildRecords=!0,s.expanded=!!t.isNullOrUndefined(s[this.parent.expandStateMapping])||s[this.parent.expandStateMapping]),s.index=(s.hasChildRecords,this.storedIndex),this.isSelfReference&&t.isNullOrUndefined(s[this.parent.parentIdMapping])&&this.parent.parentData.push(s),s.uniqueID=i.getUid(this.parent.element.id+"_data_"),t.setValue("uniqueIDCollection."+s.uniqueID,s,this.parent),!t.isNullOrUndefined(r)){var l=t.extend({},r);delete l.childRecords,delete l[this.parent.childMapping],s.parentItem=l,s.parentUniqueID=l.uniqueID,a=r.level+1}s.level=a,s.checkboxState="uncheck",(t.isNullOrUndefined(s[this.parent.parentIdMapping])||s.parentItem)&&this.parent.flatData.push(s),this.isSelfReference||0!==s.level||this.parent.parentData.push(s),t.isNullOrUndefined(s[this.parent.childMapping]&&s[this.parent.childMapping].length)||this.createRecords(s[this.parent.childMapping],s)}},e.prototype.dataProcessor=function(e){var r,o=i.getObject("isExport",e),s=i.getObject("expresults",e),a=i.getObject("exportType",e),l=i.getObject("actionArgs",e),d=i.getObject("requestType",e),p=i.getObject("data",e),c=i.getObject("action",e);(!t.isNullOrUndefined(l)&&Object.keys(l).length||"save"===d)&&(d=d||l.requestType.toString(),p=p||i.getObject("data",l),"add"===(c=c||i.getObject("action",l))&&(this.parent.grid.currentViewData=e.result),this.parent.isLocalData&&("delete"!==d&&"save"!==d||this.parent.notify(_,{value:p,action:c||d})));var h=(r=o&&!t.isNullOrUndefined(s)?s:this.parent.grid.dataSource)instanceof n.DataManager?r.dataSource.json:r,u=h.length;if(this.parent.grid.allowFiltering&&this.parent.grid.filterSettings.columns.length||this.parent.grid.searchSettings.key.length>0){var g=new n.Query,f=i.getObject("query",e);t.isNullOrUndefined(f)&&(f=new n.Query,f=t.getValue("grid.renderModule.data",this.parent).filterQuery(f),f=t.getValue("grid.renderModule.data",this.parent).searchQuery(f));var y=f.queries.filter(function(e){return"onWhere"===e.fn}),m=f.queries.filter(function(e){return"onSearch"===e.fn});g.queries=y.concat(m);var v=new n.DataManager(h).executeLocal(g);if(this.parent.notify("updateFilterRecs",{data:v}),h=this.dataResults.result,this.dataResults.result=null,this.parent.grid.aggregates.length>0){var w=i.getObject("query",e);t.isNullOrUndefined(f)&&(f=t.getValue("grid.renderModule.data",this.parent).aggregateQuery(new n.Query));var x=w.queries.filter(function(e){return"onAggregates"===e.fn});h=this.parent.summaryModule.calculateSummaryValue(x,h,!0)}}if(this.parent.grid.aggregates.length&&0===this.parent.grid.sortSettings.columns.length&&0===this.parent.grid.filterSettings.columns.length&&!this.parent.grid.searchSettings.key.length){f=i.getObject("query",e);t.isNullOrUndefined(f)&&(f=t.getValue("grid.renderModule.data",this.parent).aggregateQuery(new n.Query));x=f.queries.filter(function(e){return"onAggregates"===e.fn});h=this.parent.summaryModule.calculateSummaryValue(x,this.parent.flatData,!0)}if(this.parent.grid.sortSettings.columns.length>0||this.isSortAction){this.isSortAction=!1;var C=void 0;C=this.parent.parentData;w=i.getObject("query",e);this.parent.sortModule=new de(this.parent);for(var b=new n.Query,S=this.parent.grid.sortSettings.columns.length-1;S>=0;S--){var R=this.parent.getColumnByField(this.parent.grid.sortSettings.columns[S].field),M=R.sortComparer&&!this.isRemote()?R.sortComparer.bind(R):this.parent.grid.sortSettings.columns[S].direction;b.sortBy(this.parent.grid.sortSettings.columns[S].field,M)}var I=new n.DataManager(C).executeLocal(b);if(this.parent.notify("createSort",{modifiedData:I,filteredData:h,srtQry:b}),h=this.dataResults.result,this.dataResults.result=null,this.sortedData=h,this.parent.notify("updateModel",{}),this.parent.grid.aggregates.length>0){x=i.getObject("query",e).queries.filter(function(e){return"onAggregates"===e.fn});h=this.parent.summaryModule.calculateSummaryValue(x,this.sortedData,!1)}}u=h.length,!this.parent.allowPaging||o&&"CurrentPage"!==a||(this.parent.notify(U,{result:h,count:u}),h=this.dataResults.result,u=this.dataResults.count),e.result=h,e.count=u,this.parent.notify("updateResults",e)},e.prototype.updateData=function(e){this.dataResults=e},e}();!function(e){e[e.Add=0]="Add",e[e.Edit=1]="Edit",e[e.Update=2]="Update",e[e.Delete=3]="Delete",e[e.Cancel=4]="Cancel",e[e.Search=5]="Search",e[e.ExpandAll=6]="ExpandAll",e[e.CollapseAll=7]="CollapseAll",e[e.ExcelExport=8]="ExcelExport",e[e.PdfExport=9]="PdfExport",e[e.CsvExport=10]="CsvExport",e[e.Print=11]="Print",e[e.RowIndent=12]="RowIndent",e[e.RowOutdent=13]="RowOutdent"}(e.ToolbarItem||(e.ToolbarItem={})),function(e){e[e.AutoFit=0]="AutoFit",e[e.AutoFitAll=1]="AutoFitAll",e[e.SortAscending=2]="SortAscending",e[e.SortDescending=3]="SortDescending",e[e.Edit=4]="Edit",e[e.Delete=5]="Delete",e[e.Save=6]="Save",e[e.Cancel=7]="Cancel",e[e.PdfExport=8]="PdfExport",e[e.ExcelExport=9]="ExcelExport",e[e.CsvExport=10]="CsvExport",e[e.FirstPage=11]="FirstPage",e[e.PrevPage=12]="PrevPage",e[e.LastPage=13]="LastPage",e[e.NextPage=14]="NextPage",e[e.AddRow=15]="AddRow"}(e.ContextMenuItems||(e.ContextMenuItems={}));var ce=function(){var e=function(t,i){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(t,i)};return function(t,i){function r(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),he=function(e,t,i,r){var n,o=arguments.length,s=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,r);else for(var a=e.length-1;a>=0;a--)(n=e[a])&&(s=(o<3?n(s):o>3?n(t,i,s):n(t,i))||s);return o>3&&s&&Object.defineProperty(t,i,s),s},ue=function(e){function i(){return null!==e&&e.apply(this,arguments)||this}return ce(i,e),he([t.Property(12)],i.prototype,"pageSize",void 0),he([t.Property(8)],i.prototype,"pageCount",void 0),he([t.Property(1)],i.prototype,"currentPage",void 0),he([t.Property()],i.prototype,"totalRecordsCount",void 0),he([t.Property(!1)],i.prototype,"enableQueryString",void 0),he([t.Property(!1)],i.prototype,"pageSizes",void 0),he([t.Property(null)],i.prototype,"template",void 0),he([t.Property("All")],i.prototype,"pageSizeMode",void 0),i}(t.ChildProperty),ge=function(){var e=function(t,i){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(t,i)};return function(t,i){function r(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),fe=function(e,t,i,r){var n,o=arguments.length,s=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,r);else for(var a=e.length-1;a>=0;a--)(n=e[a])&&(s=(o<3?n(s):o>3?n(t,i,s):n(t,i))||s);return o>3&&s&&Object.defineProperty(t,i,s),s},ye=function(e){function r(){var i=null!==e&&e.apply(this,arguments)||this;return i.intl=new t.Internationalization,i.templateFn={},i}return ge(r,e),r.prototype.setFormatter=function(e){this.format&&(this.format.skeleton||this.format.format)&&(this.formatFn=this.getFormatFunction(this.format))},r.prototype.getFormatFunction=function(e){return e.type?this.intl.getDateFormat(e):this.intl.getNumberFormat(e)},r.prototype.getFormatter=function(){return this.formatFn},r.prototype.setTemplate=function(e){void 0===e&&(e={}),void 0!==this.footerTemplate&&(this.templateFn[t.getEnumValue(i.CellType,i.CellType.Summary)]={fn:t.compile(this.footerTemplate,e),property:"footerTemplate"})},r.prototype.getTemplate=function(e){return this.templateFn[t.getEnumValue(i.CellType,e)]},r.prototype.setPropertiesSilent=function(e){this.setProperties(e,!0)},fe([t.Property()],r.prototype,"type",void 0),fe([t.Property()],r.prototype,"footerTemplate",void 0),fe([t.Property()],r.prototype,"field",void 0),fe([t.Property()],r.prototype,"format",void 0),fe([t.Property()],r.prototype,"columnName",void 0),fe([t.Property()],r.prototype,"customAggregate",void 0),r}(t.ChildProperty),me=function(e){function i(){return null!==e&&e.apply(this,arguments)||this}return ge(i,e),fe([t.Collection([],ye)],i.prototype,"columns",void 0),fe([t.Property(!0)],i.prototype,"showChildSummary",void 0),i}(t.ChildProperty),ve=function(){var e=function(t,i){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(t,i)};return function(t,i){function r(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),we=function(e,t,i,r){var n,o=arguments.length,s=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,r);else for(var a=e.length-1;a>=0;a--)(n=e[a])&&(s=(o<3?n(s):o>3?n(t,i,s):n(t,i))||s);return o>3&&s&&Object.defineProperty(t,i,s),s},xe=function(e){function i(){return null!==e&&e.apply(this,arguments)||this}return ve(i,e),we([t.Property(!1)],i.prototype,"allowAdding",void 0),we([t.Property(!1)],i.prototype,"allowEditing",void 0),we([t.Property(!1)],i.prototype,"allowDeleting",void 0),we([t.Property("Cell")],i.prototype,"mode",void 0),we([t.Property("Top")],i.prototype,"newRowPosition",void 0),we([t.Property(!0)],i.prototype,"allowEditOnDblClick",void 0),we([t.Property(!0)],i.prototype,"showConfirmDialog",void 0),we([t.Property(!1)],i.prototype,"showDeleteConfirmDialog",void 0),we([t.Property("")],i.prototype,"template",void 0),i}(t.ChildProperty),Ce=function(){var e=function(t,i){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(t,i)};return function(t,i){function r(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),be=function(e,t,i,r){var n,o=arguments.length,s=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,r);else for(var a=e.length-1;a>=0;a--)(n=e[a])&&(s=(o<3?n(s):o>3?n(t,i,s):n(t,i))||s);return o>3&&s&&Object.defineProperty(t,i,s),s},Se=function(e){function i(){return null!==e&&e.apply(this,arguments)||this}return Ce(i,e),be([t.Property()],i.prototype,"field",void 0),be([t.Property()],i.prototype,"direction",void 0),i}(t.ChildProperty),Re=function(e){function i(){return null!==e&&e.apply(this,arguments)||this}return Ce(i,e),be([t.Collection([],Se)],i.prototype,"columns",void 0),be([t.Property(!0)],i.prototype,"allowUnsort",void 0),i}(t.ChildProperty),Me=function(){var e=function(t,i){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(t,i)};return function(t,i){function r(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),Ie=function(e,t,i,r){var n,o=arguments.length,s=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,r);else for(var a=e.length-1;a>=0;a--)(n=e[a])&&(s=(o<3?n(s):o>3?n(t,i,s):n(t,i))||s);return o>3&&s&&Object.defineProperty(t,i,s),s},Pe=function(r){function a(e,t){var n=r.call(this,e,t)||this;return n.dataResults={},n.uniqueIDCollection={},n.uniqueIDFilterCollection={},l.Inject($),n.grid=new i.Grid,n}Me(a,r),l=a,a.prototype.excelExport=function(e,t,i,r){return this.excelExportModule.Map(e,t,i,r,!1)},a.prototype.csvExport=function(e,t,i,r){return this.excelExportModule.Map(e,t,i,r,!0)},a.prototype.pdfExport=function(e,t,i,r){return this.pdfExportModule.Map(e,t,i,r)},a.prototype.getModuleName=function(){return"treegrid"},a.prototype.preRender=function(){this.TreeGridLocale(),this.initProperties(),this.defaultLocale={Above:"Above",Below:"Below",AddRow:"Add Row",ExpandAll:"Expand All",CollapseAll:"Collapse All"},this.isSelfReference&&t.isNullOrUndefined(this.childMapping)&&(this.childMapping="Children")},a.prototype.sortByColumn=function(e,t,i){this.sortModule.sortColumn(e,t,i)},a.prototype.clearSorting=function(){this.sortModule.clearSorting()},a.prototype.removeSortColumn=function(e){this.sortModule.removeSortColumn(e)},a.prototype.search=function(e){this.grid.search(e)},a.prototype.autoFitColumns=function(e){this.resizeModule.autoFitColumns(e),this.updateColumnModel()},a.prototype.reorderColumns=function(e,t){this.grid.reorderColumns(e,t)},a.prototype.TreeGridLocale=function(){var e,r=t.L10n.locale;e={},t.setValue(this.locale,{},e);var n;n={},n=i.getObject(this.locale,r);var o;o={},o=i.getObject(this.getModuleName(),n),t.setValue("grid",o,i.getObject(this.locale,e)),t.L10n.load(e)},a.prototype.print=function(){this.printModule.print()},a.prototype.treeGridkeyActionHandler=function(e){if(this.allowKeyboard)switch(e.action){case"ctrlDownArrow":this.expandAll();break;case"ctrlUpArrow":this.collapseAll();break;case"ctrlShiftUpArrow":var i=e.target.closest(".e-rowcell").closest("tr");this.expandCollapseRequest(i.querySelector(".e-treegridexpand"));break;case"ctrlShiftDownArrow":var r=e.target.closest(".e-rowcell").closest("tr");this.expandCollapseRequest(r.querySelector(".e-treegridcollapse"));break;case"downArrow":var n=e.target.parentElement,o=this.findnextRowElement(n);if(null!==o){var s=o.rowIndex;this.selectRow(s);var a=e.target.cellIndex,l=o.children[a];t.addClass([l],"e-focused"),t.addClass([l],"e-focus")}else this.clearSelection();break;case"upArrow":var d=e.target.parentElement,p=this.findPreviousRowElement(d);if(null!==p){var c=p.rowIndex;this.selectRow(c);var h=e.target.cellIndex,u=p.children[h];t.addClass([u],"e-focused"),t.addClass([u],"e-focus")}else this.clearSelection()}},a.prototype.findnextRowElement=function(e){var t=e.nextSibling;return null===t||-1===t.className.indexOf("e-summaryrow")&&"none"!==t.style.display||(t=this.findnextRowElement(t)),t},a.prototype.findPreviousRowElement=function(e){var t=e.previousSibling;return null===t||-1===t.className.indexOf("e-summaryrow")&&"none"!==t.style.display||(t=this.findPreviousRowElement(t)),t},a.prototype.initProperties=function(){this.defaultLocale={},this.flatData=[],this.parentData=[],this.columnModel=[],this.isExpandAll=!1,this.keyConfigs={ctrlDownArrow:"ctrl+downarrow",ctrlUpArrow:"ctrl+uparrow",ctrlShiftUpArrow:"ctrl+shift+uparrow",ctrlShiftDownArrow:"ctrl+shift+downarrow",downArrow:"downArrow",upArrow:"upArrow"},this.isLocalData=!(this.dataSource instanceof n.DataManager)||this.dataSource.dataSource.offline||!t.isNullOrUndefined(this.dataSource.ready)||this.dataSource.adaptor instanceof n.RemoteSaveAdaptor,this.isSelfReference=!t.isNullOrUndefined(this.parentIdMapping)},a.prototype.wireEvents=function(){t.EventHandler.add(this.element,"click",this.mouseClickHandler,this),t.EventHandler.add(this.element,"touchend",this.mouseClickHandler,this),this.keyboardModule=new t.KeyboardEvents(this.element,{keyAction:this.treeGridkeyActionHandler.bind(this),keyConfigs:this.keyConfigs,eventName:"keydown"}),this.allowKeyboard&&(this.element.tabIndex=-1===this.element.tabIndex?0:this.element.tabIndex)},a.prototype.requiredModules=function(){var e=[];return this.isDestroyed?e:(e.push({member:"filter",args:[this,this.filterSettings]}),t.isNullOrUndefined(this.toolbar)||e.push({member:"toolbar",args:[this]}),this.contextMenuItems&&e.push({member:"contextMenu",args:[this]}),this.allowPaging&&e.push({member:"pager",args:[this,this.pageSettings]}),this.allowReordering&&e.push({member:"reorder",args:[this]}),this.allowSorting&&e.push({member:"sort",args:[this]}),this.aggregates.length>0&&e.push({member:"summary",args:[this]}),this.allowResizing&&e.push({member:"resize",args:[this]}),this.allowExcelExport&&e.push({member:"ExcelExport",args:[this]}),this.allowPdfExport&&e.push({member:"PdfExport",args:[this]}),this.showColumnMenu&&e.push({member:"columnMenu",args:[this]}),(this.editSettings.allowAdding||this.editSettings.allowDeleting||this.editSettings.allowEditing)&&e.push({member:"edit",args:[this]}),this.isCommandColumn(this.columns)&&e.push({member:"commandColumn",args:[this]}),this.allowSelection&&e.push({member:"selection",args:[this]}),e)},a.prototype.isCommandColumn=function(e){var t=this;return e.some(function(e){return e.columns?t.isCommandColumn(e.columns):!(!e.commands&&!e.commandsTemplate)})},a.prototype.unwireEvents=function(){t.EventHandler.remove(this.element,"click",this.mouseClickHandler)},a.prototype.render=function(){o.createSpinner({target:this.element},this.createElement),this.renderModule=new le(this),this.dataModule=new pe(this),this.printModule=new te(this),this.columnMenuModule=new ee(this),this.trigger("load"),this.autoGenerateColumns(),this.convertTreeData(this.dataSource),this.initialRender=!0,this.loadGrid(),this.addListener();var e=t.createElement("div",{id:this.element.id+"_gridcontrol"});t.addClass([this.element],"e-treegrid"),t.isNullOrUndefined(this.height)||"string"!=typeof this.height||-1===this.height.indexOf("%")||(this.element.style.height=this.height),t.isNullOrUndefined(this.width)||"string"!=typeof this.width||-1===this.width.indexOf("%")||(this.element.style.width=this.width),this.element.appendChild(e),this.grid.appendTo(e),this.wireEvents()},a.prototype.convertTreeData=function(e){var i=this;e instanceof Array&&e.length>0&&e[0].hasOwnProperty("level")?(this.flatData=e,this.flatData.filter(function(e){t.setValue("uniqueIDCollection."+e.uniqueID,e,i),0===e.level&&i.parentData.push(e)})):this.dataModule.convertToFlatData(e)},a.prototype.bindGridProperties=function(){this.grid.dataSource=s(this)?this.dataSource:this.flatData,this.grid.enableRtl=this.enableRtl,this.grid.allowKeyboard=this.allowKeyboard,this.grid.columns=this.getGridColumns(this.columns),this.grid.allowExcelExport=this.allowExcelExport,this.grid.allowPdfExport=this.allowPdfExport,this.grid.query=this.query,this.grid.columnQueryMode=this.columnQueryMode,this.grid.allowPaging=this.allowPaging,this.grid.pageSettings=i.getActualProperties(this.pageSettings),this.grid.pagerTemplate=this.pagerTemplate,this.grid.showColumnMenu=this.showColumnMenu,this.grid.allowSorting=this.allowSorting,this.grid.allowFiltering=this.allowFiltering,this.grid.width=this.width,this.grid.height=this.height,this.grid.enableAltRow=this.enableAltRow,this.grid.allowReordering=this.allowReordering,this.grid.allowTextWrap=this.allowTextWrap,this.grid.allowResizing=this.allowResizing,this.grid.enableHover=this.enableHover,this.grid.rowHeight=this.rowHeight,this.grid.gridLines=this.gridLines,this.grid.allowSelection=this.allowSelection,this.grid.toolbar=i.getActualProperties(this.getGridToolbar()),this.grid.toolbarTemplate=this.toolbarTemplate,this.grid.filterSettings=i.getActualProperties(this.filterSettings),this.grid.selectionSettings=i.getActualProperties(this.selectionSettings),this.grid.sortSettings=i.getActualProperties(this.sortSettings),this.grid.searchSettings=i.getActualProperties(this.searchSettings),this.grid.aggregates=i.getActualProperties(this.aggregates),this.grid.textWrapSettings=i.getActualProperties(this.textWrapSettings),this.grid.printMode=i.getActualProperties(this.printMode),this.grid.locale=i.getActualProperties(this.locale),this.grid.selectedRowIndex=this.selectedRowIndex,this.grid.contextMenuItems=i.getActualProperties(this.getContextMenu()),this.grid.columnMenuItems=i.getActualProperties(this.columnMenuItems),this.grid.editSettings=this.getGridEditSettings(),this.grid.rowTemplate=i.getActualProperties(this.rowTemplate)},a.prototype.triggerEvents=function(e){this.trigger(i.getObject("name",e),e)},a.prototype.bindGridEvents=function(){var e=this,r=this;this.grid.rowSelecting=this.triggerEvents.bind(this),this.grid.rowSelected=function(t){e.selectedRowIndex=e.grid.selectedRowIndex,e.trigger(I,t)},this.grid.rowDeselected=function(t){e.selectedRowIndex=e.grid.selectedRowIndex,e.trigger(E,t)},this.grid.toolbarClick=function(t){e.trigger(O,t),t.cancel||e.notify(O,t)},this.grid.resizeStop=function(t){e.updateColumnModel(),e.trigger(A,t)},this.grid.excelQueryCellInfo=function(t){e.notify("excelCellInfo",t),t=e.dataResults},this.grid.pdfQueryCellInfo=function(t){e.notify("pdfCellInfo",t),t=e.dataResults},this.grid.checkBoxChange=function(t){e.trigger(P,t)},this.grid.pdfExportComplete=this.triggerEvents.bind(this),this.grid.excelExportComplete=this.triggerEvents.bind(this),this.grid.excelHeaderQueryCellInfo=this.triggerEvents.bind(this),this.grid.pdfHeaderQueryCellInfo=this.triggerEvents.bind(this),this.grid.dataSourceChanged=this.triggerEvents.bind(this),this.grid.dataStateChange=this.triggerEvents.bind(this),this.grid.recordDoubleClick=this.triggerEvents.bind(this),this.grid.rowDeselecting=this.triggerEvents.bind(this),this.grid.cellDeselected=this.triggerEvents.bind(this),this.grid.cellSelecting=this.triggerEvents.bind(this),this.grid.cellDeselecting=this.triggerEvents.bind(this),this.grid.columnMenuOpen=this.triggerEvents.bind(this),this.grid.columnMenuClick=this.triggerEvents.bind(this),this.grid.cellSelected=this.triggerEvents.bind(this),this.grid.headerCellInfo=this.triggerEvents.bind(this),this.grid.resizeStart=this.triggerEvents.bind(this),this.grid.resizing=this.triggerEvents.bind(this),this.grid.columnDrag=this.triggerEvents.bind(this),this.grid.columnDragStart=this.triggerEvents.bind(this),this.grid.columnDrop=this.triggerEvents.bind(this),this.grid.beforePrint=this.triggerEvents.bind(this),this.grid.printComplete=this.triggerEvents.bind(this),this.grid.beginEdit=this.triggerEvents.bind(this),this.grid.cellEdit=this.triggerEvents.bind(this),this.grid.actionFailure=this.triggerEvents.bind(this),this.grid.dataBound=function(r){if(e.updateColumnModel(),e.notify("headerCheckbox",{}),e.trigger("dataBound",r),s(e)&&!p(e)&&!e.hasChildMapping){var n=i.getObject("dataSource.requests",e).filter(function(e){return"OK"!==e.httpRequest.statusText}).length;t.setValue("grid.contentModule.isLoaded",!(n>0),e)}e.initialRender=!1},this.grid.beforeDataBound=function(e){if(s(r)&&!p(r))r.notify("updateRemoteLevel",e),e=r.dataResults;else if(0===r.flatData.length&&p(r)&&r.dataSource instanceof n.DataManager){var i=r.dataSource;r.dataModule.convertToFlatData(i.dataSource.json),e.result=r.flatData}s(r)||r.notify("dataProcessor",e),t.extend(e,r.dataResults),this.isPrinting||r.trigger(S,e)},this.extendedGridEvents(),this.extendedGridEditEvents()},a.prototype.extendedGridEditEvents=function(){var e=this;this.grid.cellSave=function(i){if(e.grid.isContextMenuOpen()){var r=void 0;r=e.grid.contextMenuModule.contextMenu.element.getElementsByClassName("e-selected")[0],(t.isNullOrUndefined(r)||r.id!==e.element.id+"_gridcontrol_cmenu_Save")&&(i.cancel=!0)}e.trigger(z,i),i.cancel||e.notify(z,i)},this.grid.cellEdit=function(t){e.notify(W,t)},this.grid.batchCancel=function(t){"Cell"!==e.editSettings.mode&&e.trigger(K,t),e.notify(K,t)}},a.prototype.extendedGridEvents=function(){var e=this,r=this;this.grid.recordDoubleClick=function(t){e.trigger(Q,t),e.notify(Q,t)},this.grid.actionBegin=function(r){var n=i.getObject("requestType",r),o=i.getObject("target",r);"reorder"===n&&e.notify("getColumnIndex",{}),s(e)||t.isNullOrUndefined(e.filterModule)||0!==e.grid.filterSettings.columns.length&&0!==e.grid.searchSettings.key.length||(e.notify("clearFilters",{flatData:e.grid.dataSource}),e.grid.dataSource=e.dataResults.result),t.isNullOrUndefined(o)||"sorting"!==n||!o.parentElement.classList.contains("e-hierarchycheckbox")?(e.trigger(R,r),e.notify(H,r)):t.setValue("cancel",!0,r)},this.grid.actionComplete=function(t){e.updateColumnModel(),"reorder"===t.requestType&&e.notify("setColumnIndex",{}),e.isLocalData&&("add"===t.requestType&&"Top"!==e.editSettings.newRowPosition&&"Bottom"!==e.editSettings.newRowPosition&&e.notify(G,t),"batchsave"===t.requestType&&e.notify("batchSave",t),e.notify("updateGridActions",t)),e.trigger(M,t)},this.grid.rowDataBound=function(e){if(e.row instanceof DocumentFragment){var i=e.row.querySelector("tr");e.row=i}if(t.isNullOrUndefined(this.isPrinting)?t.setValue("isPrinting",!1,e):t.setValue("isPrinting",this.isPrinting,e),r.renderModule.RowModifier(e),r.rowTemplate){var n=e.row.cells[r.treeColumnIndex],o={data:e.data,row:e.row,cell:n,column:this.getColumns()[r.treeColumnIndex]};this.queryCellInfo(o)}},this.grid.queryCellInfo=function(e){t.isNullOrUndefined(this.isPrinting)?t.setValue("isPrinting",!1,e):t.setValue("isPrinting",this.isPrinting,e),r.renderModule.cellRender(e)},this.grid.contextMenuClick=function(t){e.notify(V,t),e.trigger(V,t)},this.grid.contextMenuOpen=function(t){e.notify(B,t),e.trigger(B,t)},this.grid.queryCellInfo=function(t){e.renderModule.cellRender(t)}},a.prototype.loadGrid=function(){this.bindGridProperties(),this.bindGridEvents(),t.setValue("registeredTemplate",this.registeredTemplate,this.grid)},a.prototype.autoGenerateColumns=function(){if(!this.columns.length&&!this.dataModule.isRemote()&&Object.keys(this.dataSource).length){var e=void 0;e=this.dataSource[0];for(var t=Object.keys(e),i=0;i<t.length;i++)-1===[this.childMapping,this.parentIdMapping].indexOf(t[i])&&this.columns.push(t[i])}},a.prototype.getGridEditSettings=function(){var e={};switch(e.allowAdding=this.editSettings.allowAdding,e.allowEditing=this.editSettings.allowEditing,e.allowDeleting=this.editSettings.allowDeleting,e.newRowPosition="Bottom"===this.editSettings.newRowPosition?"Bottom":"Top",e.allowEditOnDblClick=this.editSettings.allowEditOnDblClick,e.showConfirmDialog=this.editSettings.showConfirmDialog,e.template=this.editSettings.template,e.showDeleteConfirmDialog=this.editSettings.showDeleteConfirmDialog,this.editSettings.mode){case"Dialog":e.mode=this.editSettings.mode;break;case"Row":e.mode="Normal";break;case"Cell":e.mode="Normal",e.showConfirmDialog=!1}return e},a.prototype.getContextMenu=function(){if(this.contextMenuItems){for(var t=[],i=0;i<this.contextMenuItems.length;i++)switch(this.contextMenuItems[i]){case"AddRow":case e.ContextMenuItems.AddRow:t.push({text:"AddRow",target:".e-content",id:this.element.id+"_gridcontrol_cmenu_AddRow",items:[{text:"Above",id:"Above"},{text:"Below",id:"Below"}]});break;default:t.push(this.contextMenuItems[i])}return t}return null},a.prototype.getGridToolbar=function(){if(this.toolbar){this.l10n=new t.L10n("treegrid",this.defaultLocale,this.locale);for(var i=[],r=0;r<this.toolbar.length;r++)switch(this.toolbar[r]){case"Search":case e.ToolbarItem.Search:i.push("Search");break;case"Print":case e.ToolbarItem.Print:i.push("Print");break;case"ExpandAll":case e.ToolbarItem.ExpandAll:var n=this.l10n.getConstant("ExpandAll");i.push({text:n,tooltipText:n,prefixIcon:"e-expand",id:this.element.id+"_gridcontrol_expandall"});break;case"CollapseAll":case e.ToolbarItem.CollapseAll:var o=this.l10n.getConstant("CollapseAll");i.push({text:o,tooltipText:o,prefixIcon:"e-collapse",id:this.element.id+"_gridcontrol_collapseall"});break;default:i.push(this.toolbar[r])}return i}return null},a.prototype.getGridColumns=function(e){var t=e;this.columnModel=[];for(var i,r,n=[],o=0;o<t.length;o++){if(r={},i={},"string"==typeof this.columns[o])r.field=i.field=this.columns[o];else for(var s=0,a=Object.keys(t[o]);s<a.length;s++){var l=a[s];r[l]=i[l]=t[o][l]}t[o].columns?this.getGridColumns(e[o].columns):this.columnModel.push(new m(i)),n.push(r)}return n},a.prototype.onPropertyChanged=function(e,r){for(var o=!1,s=0,a=Object.keys(e);s<a.length;s++){var l=a[s];switch(l){case"columns":this.grid.columns=this.getGridColumns(this.columns);break;case"treeColumnIndex":this.grid.refreshColumns();break;case"allowPaging":this.grid.allowPaging=this.allowPaging;break;case"pageSettings":this.grid.pageSettings=i.getActualProperties(this.pageSettings),o=!0;break;case"toolbar":this.grid.toolbar=this.getGridToolbar();break;case"allowSelection":this.grid.allowSelection=this.allowSelection;break;case"selectionSettings":this.grid.selectionSettings=i.getActualProperties(this.selectionSettings);break;case"allowSorting":this.grid.allowSorting=this.allowSorting;break;case"allowMultiSorting":this.grid.allowMultiSorting=this.allowMultiSorting;break;case"sortSettings":this.grid.sortSettings=i.getActualProperties(this.sortSettings);break;case"searchSettings":this.grid.searchSettings=i.getActualProperties(this.searchSettings);break;case"allowFiltering":this.grid.allowFiltering=this.allowFiltering;break;case"filterSettings":this.grid.filterSettings=i.getActualProperties(this.filterSettings);break;case"showColumnMenu":this.grid.showColumnMenu=this.showColumnMenu;break;case"aggregates":this.grid.aggregates=i.getActualProperties(this.aggregates);break;case"dataSource":this.isLocalData=!(this.dataSource instanceof n.DataManager)||!t.isNullOrUndefined(this.dataSource.ready)||this.dataSource.adaptor instanceof n.RemoteSaveAdaptor,this.convertTreeData(this.dataSource),this.isLocalData?this.grid.dataSource=this.flatData:this.grid.dataSource=this.dataSource;break;case"query":this.grid.query=this.query;break;case"enableCollapseAll":e[l]?this.collapseAll():this.expandAll();break;case"expandStateMapping":this.refresh();break;case"gridLines":this.grid.gridLines=this.gridLines;break;case"rowTemplate":this.grid.rowTemplate=i.getActualProperties(this.rowTemplate);break;case"rowHeight":this.grid.rowHeight=this.rowHeight;break;case"height":t.isNullOrUndefined(this.height)||"string"!=typeof this.height||-1===this.height.indexOf("%")||(this.element.style.height=this.height),this.grid.height=this.height;break;case"width":t.isNullOrUndefined(this.width)||"string"!=typeof this.width||-1===this.width.indexOf("%")||(this.element.style.width=this.width),this.grid.width=this.width;break;case"enableAltRow":this.grid.enableAltRow=this.enableAltRow;break;case"enableHover":this.grid.enableHover=this.enableHover;break;case"allowExcelExport":this.grid.allowExcelExport=this.allowExcelExport;break;case"allowPdfExport":this.grid.allowPdfExport=this.allowPdfExport;break;case"enableRtl":this.grid.enableRtl=this.enableRtl;break;case"allowReordering":this.grid.allowReordering=this.allowReordering;break;case"allowResizing":this.grid.allowResizing=this.allowResizing;break;case"textWrapSettings":this.grid.textWrapSettings=i.getActualProperties(this.textWrapSettings);break;case"allowTextWrap":this.grid.allowTextWrap=i.getActualProperties(this.allowTextWrap);break;case"contextMenuItems":this.grid.contextMenuItems=this.getContextMenu();break;case"columnMenuItems":this.grid.columnMenuItems=i.getActualProperties(this.columnMenuItems);break;case"editSettings":this.grid.isEdit&&"Normal"===this.grid.editSettings.mode&&e[l].mode&&("Cell"===e[l].mode||"Row"===e[l].mode)&&this.grid.closeEdit(),this.grid.editSettings=this.getGridEditSettings()}o&&this.refresh()}},a.prototype.destroy=function(){this.removeListener(),this.unwireEvents(),r.prototype.destroy.call(this),this.grid.destroy(),this.dataModule.destroy();for(var e=["dataModule","sortModule","renderModule","filterModule","printModule","excelExportModule","pdfExportModule","toolbarModule","summaryModule","reorderModule","resizeModule","pagerModule","keyboardModule","columnMenuModule","contextMenuModule","editModule","selectionModule"],t=0;t<e.length;t++)this[e[t]]&&(this[e[t]]=null);this.element.innerHTML="",this.grid=null},a.prototype.dataBind=function(){r.prototype.dataBind.call(this),this.grid.dataBind()},a.prototype.getPersistData=function(){var e=this,t=["pageSettings","sortSettings","filterSettings","columns","searchSettings","selectedRowIndex"],i={pageSettings:["template","pageSizes","pageSizeMode","enableQueryString","totalRecordsCount","pageCount"],filterSettings:["type","mode","showFilterBarStatus","immediateModeDelay","ignoreAccent","hierarchyMode"],searchSettings:["fields","operator","ignoreCase"],sortSettings:[],columns:[],selectedRowIndex:[]};return t.forEach(function(t){for(var r=e[t],n=0,o=i[t];n<o.length;n++){delete r[o[n]]}}),this.ignoreInArrays(["filter","edit","filterBarTemplate","headerTemplate","template","commandTemplate","commands","dataSource"],this.columns),this.addOnPersist(t)},a.prototype.ignoreInArrays=function(e,t){var i=this;t.forEach(function(t){t.columns?(i.ignoreInColumn(e,t),i.ignoreInArrays(e,t.columns)):i.ignoreInColumn(e,t)})},a.prototype.ignoreInColumn=function(e,t){e.forEach(function(e){delete t[e],t.filter={}})},a.prototype.mouseClickHandler=function(e){if(t.isNullOrUndefined(e.touches)){var i=e.target;(i.classList.contains("e-treegridexpand")||i.classList.contains("e-treegridcollapse"))&&this.expandCollapseRequest(i),this.notify("checkboxSelection",{target:i})}},a.prototype.getRows=function(){return this.grid.getRows()},a.prototype.getPager=function(){return this.grid.getPager()},a.prototype.addRecord=function(e,t,i){this.editModule.addRecord(e,t,i)},a.prototype.closeEdit=function(){this.grid.editModule.closeEdit()},a.prototype.deleteRecord=function(e,t){this.grid.editModule.deleteRecord(e,t)},a.prototype.startEdit=function(){this.grid.editModule.startEdit()},a.prototype.endEdit=function(){this.grid.editModule.endEdit()},a.prototype.deleteRow=function(e){this.grid.editModule.deleteRow(e)},a.prototype.getPrimaryKeyFieldNames=function(){return this.grid.getPrimaryKeyFieldNames()},a.prototype.setCellValue=function(e,t,i){this.grid.setCellValue(e,t,i)},a.prototype.setRowData=function(e,t){this.grid.setRowData(e,t)},a.prototype.goToPage=function(e){this.grid.pagerModule.goToPage(e)},a.prototype.getCellFromIndex=function(e,t){return this.grid.getCellFromIndex(e,t)},a.prototype.getColumnByField=function(e){return i.iterateArrayOrObject(this.columnModel,function(t,i){if(t.field===e)return t})[0]},a.prototype.getColumnByUid=function(e){return i.iterateArrayOrObject(this.columnModel,function(t,i){if(t.uid===e)return t})[0]},a.prototype.getColumnFieldNames=function(){return this.grid.getColumnFieldNames()},a.prototype.getFooterContent=function(){return this.grid.getFooterContent()},a.prototype.getFooterContentTable=function(){return this.grid.getFooterContentTable()},a.prototype.showColumns=function(e,t){return this.grid.showColumns(e,t)},a.prototype.hideColumns=function(e,t){return this.grid.hideColumns(e,t)},a.prototype.getColumnHeaderByField=function(e){return this.grid.getColumnHeaderByField(e)},a.prototype.getColumnHeaderByIndex=function(e){return this.grid.getColumnHeaderByIndex(e)},a.prototype.getColumnHeaderByUid=function(e){return this.grid.getColumnHeaderByUid(e)},a.prototype.getColumnIndexByField=function(e){return this.grid.getColumnIndexByField(e)},a.prototype.getColumnIndexByUid=function(e){return this.grid.getColumnIndexByUid(e)},a.prototype.getColumns=function(e){return this.updateColumnModel(this.grid.getColumns(e)),this.columnModel},a.prototype.updateColumnModel=function(e){var i,r=t.isNullOrUndefined(e)?this.grid.getColumns():e;this.columnModel=[];for(var n=0;n<r.length;n++){i={};for(var o=0,s=Object.keys(r[n]);o<s.length;o++){var a=s[o];i[a]=r[n][a]}this.columnModel.push(new m(i))}return this.setProperties({columns:this.columnModel},!0),this.columnModel},a.prototype.getContent=function(){return this.grid.getContent()},a.prototype.getContentTable=function(){return this.grid.getContentTable()},a.prototype.getDataRows=function(){for(var e=[],t=this.grid.getDataRows(),i=0,r=t.length;i<r;i++)t[i].classList.contains("e-summaryrow")||e.push(t[i]);return e},a.prototype.getCurrentViewRecords=function(){return this.grid.currentViewData},a.prototype.getHeaderContent=function(){return this.grid.getHeaderContent()},a.prototype.getHeaderTable=function(){return this.grid.getHeaderTable()},a.prototype.getRowByIndex=function(e){return this.grid.getRowByIndex(e)},a.prototype.getRowInfo=function(e){return this.grid.getRowInfo(e)},a.prototype.getUidByColumnField=function(e){return this.grid.getUidByColumnField(e)},a.prototype.getVisibleColumns=function(){for(var e=[],t=0,i=this.columnModel;t<i.length;t++){var r=i[t];r.visible&&e.push(r)}return e},a.prototype.showSpinner=function(){o.showSpinner(this.element)},a.prototype.hideSpinner=function(){o.hideSpinner(this.element)},a.prototype.refresh=function(){this.grid.refresh()},a.prototype.getCheckedRecords=function(){return this.selectionModule.getCheckedrecords()},a.prototype.getCheckedRowIndexes=function(){return this.selectionModule.getCheckedRowIndexes()},a.prototype.selectCheckboxes=function(e){this.selectionModule.selectCheckboxes(e)},a.prototype.refreshColumns=function(){this.grid.columns=this.getGridColumns(this.columns),this.grid.refreshColumns()},a.prototype.refreshHeader=function(){this.grid.refreshHeader()},a.prototype.expandCollapseRequest=function(e){var t=e.closest(".e-treerowcell").parentElement,i=this.getCurrentViewRecords()[t.rowIndex];e.classList.contains("e-treegridexpand")?this.collapseRow(t,i):this.expandRow(t,i)},a.prototype.expandRow=function(e,t){var i={data:t=this.getCollapseExpandRecords(e,t),row:e,cancel:!1};if(this.trigger("expanding",i),!i.cancel&&(this.expandCollapse("expand",e,t),!s(this)||p(this))){var r={data:t,row:e};this.trigger(N,r)}},a.prototype.getCollapseExpandRecords=function(e,i){return this.allowPaging&&"All"===this.pageSettings.pageSizeMode&&this.isExpandAll&&t.isNullOrUndefined(i)?i=this.flatData.filter(function(e){return e.hasChildRecords}):t.isNullOrUndefined(i)&&(i=this.grid.getCurrentViewRecords()[e.rowIndex]),i},a.prototype.collapseRow=function(e,t){var i={data:t=this.getCollapseExpandRecords(e,t),row:e,cancel:!1};if(this.trigger(j,i),!i.cancel){this.expandCollapse("collapse",e,t);var r={data:t,row:e};this.trigger(q,r)}},a.prototype.expandAtLevel=function(e){if(this.allowPaging&&"All"===this.pageSettings.pageSizeMode){var t=this.flatData.filter(function(t){return t.hasChildRecords&&t.level===e&&(t.expanded=!0),t.hasChildRecords&&t.level===e});this.expandRow(null,t)}else{t=this.getRecordDetails(e);for(var r=i.getObject("rows",t),n=i.getObject("records",t),o=0;o<n.length;o++)this.expandRow(r[o],n[o])}},a.prototype.getRecordDetails=function(e){var t=this.getRows().filter(function(t){return-1!==t.className.indexOf("level"+e)&&(t.querySelector(".e-treegridcollapse")||t.querySelector(".e-treegridexpand"))});return{records:this.getCurrentViewRecords().filter(function(t){return t.level===e&&t.hasChildRecords}),rows:t}},a.prototype.collapseAtLevel=function(e){if(this.allowPaging&&"All"===this.pageSettings.pageSizeMode){var t=this.flatData.filter(function(t){return t.hasChildRecords&&t.level===e&&(t.expanded=!1),t.hasChildRecords&&t.level===e});this.collapseRow(null,t)}else{t=this.getRecordDetails(e);for(var r=i.getObject("rows",t),n=i.getObject("records",t),o=0;o<n.length;o++)this.collapseRow(r[o],n[o])}},a.prototype.expandAll=function(){this.expandCollapseAll("expand")},a.prototype.collapseAll=function(){this.expandCollapseAll("collapse")},a.prototype.expandCollapseAll=function(e){var t=this.getRows().filter(function(t){return t.querySelector(".e-treegrid"+("expand"===e?"collapse":"expand"))});if(this.isExpandAll=!0,this.allowPaging&&"All"===this.pageSettings.pageSizeMode)this.flatData.filter(function(t){t.hasChildRecords&&(t.expanded="collapse"!==e)}),"collapse"===e?this.collapseRow(t[0]):this.expandRow(t[0]);else for(var i=0;i<t.length;i++)"collapse"===e?this.collapseRow(t[i]):this.expandRow(t[i]);this.isExpandAll=!1},a.prototype.expandCollapse=function(e,i,r,n){var o=this.getRows();if(t.isNullOrUndefined(i)?i=o[r.index]:+i.getAttribute("aria-rowindex"),this.allowPaging&&"All"===this.pageSettings.pageSizeMode&&!s(this))this.notify(T,{action:e,row:i,record:r});else{var a=void 0;if("expand"===e){a="table-row",n||(r.expanded=!0);var l=i.getElementsByClassName("e-treegridcollapse")[0];if(t.isNullOrUndefined(l))return;t.addClass([l],"e-treegridexpand"),t.removeClass([l],"e-treegridcollapse")}else{a="none",n||(r.expanded=!1);l=i.getElementsByClassName("e-treegridexpand")[0];if(t.isNullOrUndefined(l))return;t.addClass([l],"e-treegridcollapse"),t.removeClass([l],"e-treegridexpand")}var d={data:r,row:i};if(s(this)&&!p(this)){var c=o.filter(function(e){return e.classList.contains("e-gridrowindex"+r.index+"level"+(r.level+1))});"expand"===e?this.notify(L,{record:r,rows:c,parentRow:i}):(this.collapseRemoteChild(c),this.trigger(q,d))}else for(var h=this.getCurrentViewRecords().filter(function(e){return e.parentUniqueID===r.uniqueID||e.isSummaryRow}),u=(h[0].parentItem.index,c=o.filter(function(e){return e.classList.contains("e-gridrowindex"+r.index+"level"+(r.level+1))}),0);u<c.length;u++)c[u].style.display=a,t.isNullOrUndefined(h[u].childRecords)||"expand"===e&&!t.isNullOrUndefined(h[u].expanded)&&!h[u].expanded||this.expandCollapse(e,c[u],h[u],!0)}},a.prototype.collapseRemoteChild=function(e){for(var i=function(i){var n=r.grid.getRowObjectFromUID(e[i].getAttribute("data-Uid")).data;if(n.expanded=!1,e[i].style.display="none",e[i].querySelector(".e-treecolumn-container .e-treegridexpand")){t.removeClass([e[i].getElementsByClassName("e-icons")[0]],"e-treegridexpand"),t.addClass([e[i].getElementsByClassName("e-icons")[0]],"e-treegridcollapse");var o=r.getRows().filter(function(e){return e.classList.contains("e-gridrowindex"+n.index+"level"+(n.level+1))});r.collapseRemoteChild(o)}},r=this,n=0;n<e.length;n++)i(n)},a.prototype.addListener=function(){this.on("updateResults",this.updateResultModel,this)},a.prototype.updateResultModel=function(e){this.dataResults=e},a.prototype.removeListener=function(){this.isDestroyed||this.off("updateResults",this.updateResultModel)},a.prototype.filterByColumn=function(e,t,i,r,n,o,s,a){this.grid.filterByColumn(e,t,i,r,n,o,s,a)},a.prototype.clearFiltering=function(){this.grid.clearFiltering()},a.prototype.removeFilteredColsByField=function(e,t){this.grid.removeFilteredColsByField(e,t)},a.prototype.selectRow=function(e,t){this.grid.selectRow(e,t)},a.prototype.selectRows=function(e){this.grid.selectRows(e)},a.prototype.clearSelection=function(){this.grid.clearSelection()},a.prototype.selectCell=function(e,t){this.grid.selectCell(e,t)},a.prototype.getSelectedRows=function(){return this.grid.getSelectedRows()},a.prototype.getSelectedRowIndexes=function(){return this.grid.getSelectedRowIndexes()},a.prototype.getSelectedRowCellIndexes=function(){return this.grid.getSelectedRowCellIndexes()},a.prototype.getSelectedRecords=function(){return this.grid.getSelectedRecords()},a.prototype.getDataModule=function(){return{baseModule:this.grid.getDataModule(),treeModule:this.dataModule}};var l;return Ie([t.Property([])],a.prototype,"columns",void 0),Ie([t.Property(null)],a.prototype,"childMapping",void 0),Ie([t.Property(null)],a.prototype,"hasChildMapping",void 0),Ie([t.Property(0)],a.prototype,"treeColumnIndex",void 0),Ie([t.Property(null)],a.prototype,"idMapping",void 0),Ie([t.Property(null)],a.prototype,"parentIdMapping",void 0),Ie([t.Property(!1)],a.prototype,"enableCollapseAll",void 0),Ie([t.Property(null)],a.prototype,"expandStateMapping",void 0),Ie([t.Property([])],a.prototype,"dataSource",void 0),Ie([t.Property()],a.prototype,"query",void 0),Ie([t.Property()],a.prototype,"cloneQuery",void 0),Ie([t.Property("AllPages")],a.prototype,"printMode",void 0),Ie([t.Property(!1)],a.prototype,"allowPaging",void 0),Ie([t.Property(!1)],a.prototype,"allowTextWrap",void 0),Ie([t.Complex({},i.TextWrapSettings)],a.prototype,"textWrapSettings",void 0),Ie([t.Property(!1)],a.prototype,"allowReordering",void 0),Ie([t.Property(!1)],a.prototype,"allowResizing",void 0),Ie([t.Property(!1)],a.prototype,"autoCheckHierarchy",void 0),Ie([t.Complex({},ue)],a.prototype,"pageSettings",void 0),Ie([t.Property()],a.prototype,"pagerTemplate",void 0),Ie([t.Property(!1)],a.prototype,"showColumnMenu",void 0),Ie([t.Property(!1)],a.prototype,"allowSorting",void 0),Ie([t.Property(!0)],a.prototype,"allowMultiSorting",void 0),Ie([t.Complex({},Re)],a.prototype,"sortSettings",void 0),Ie([t.Collection([],me)],a.prototype,"aggregates",void 0),Ie([t.Complex({},xe)],a.prototype,"editSettings",void 0),Ie([t.Property(!1)],a.prototype,"allowFiltering",void 0),Ie([t.Complex({},x)],a.prototype,"filterSettings",void 0),Ie([t.Complex({},ne)],a.prototype,"searchSettings",void 0),Ie([t.Property()],a.prototype,"toolbar",void 0),Ie([t.Property()],a.prototype,"toolbarTemplate",void 0),Ie([t.Property("Default")],a.prototype,"gridLines",void 0),Ie([t.Property()],a.prototype,"contextMenuItems",void 0),Ie([t.Property()],a.prototype,"columnMenuItems",void 0),Ie([t.Property()],a.prototype,"rowTemplate",void 0),Ie([t.Property(null)],a.prototype,"rowHeight",void 0),Ie([t.Property(!0)],a.prototype,"enableAltRow",void 0),Ie([t.Property(!0)],a.prototype,"allowKeyboard",void 0),Ie([t.Property(!0)],a.prototype,"enableHover",void 0),Ie([t.Property("auto")],a.prototype,"height",void 0),Ie([t.Property("auto")],a.prototype,"width",void 0),Ie([t.Property("All")],a.prototype,"columnQueryMode",void 0),Ie([t.Event()],a.prototype,"created",void 0),Ie([t.Event()],a.prototype,"load",void 0),Ie([t.Event()],a.prototype,"expanding",void 0),Ie([t.Event()],a.prototype,"expanded",void 0),Ie([t.Event()],a.prototype,"collapsing",void 0),Ie([t.Event()],a.prototype,"collapsed",void 0),Ie([t.Event()],a.prototype,"actionBegin",void 0),Ie([t.Event()],a.prototype,"actionComplete",void 0),Ie([t.Event()],a.prototype,"beginEdit",void 0),Ie([t.Event()],a.prototype,"cellEdit",void 0),Ie([t.Event()],a.prototype,"actionFailure",void 0),Ie([t.Event()],a.prototype,"dataBound",void 0),Ie([t.Event()],a.prototype,"dataSourceChanged",void 0),Ie([t.Event()],a.prototype,"dataStateChange",void 0),Ie([t.Event()],a.prototype,"recordDoubleClick",void 0),Ie([t.Event()],a.prototype,"rowDataBound",void 0),Ie([t.Event()],a.prototype,"queryCellInfo",void 0),Ie([t.Property(!0)],a.prototype,"allowSelection",void 0),Ie([t.Event()],a.prototype,"rowSelecting",void 0),Ie([t.Event()],a.prototype,"rowSelected",void 0),Ie([t.Event()],a.prototype,"rowDeselecting",void 0),Ie([t.Event()],a.prototype,"rowDeselected",void 0),Ie([t.Event()],a.prototype,"headerCellInfo",void 0),Ie([t.Event()],a.prototype,"cellSelecting",void 0),Ie([t.Event()],a.prototype,"columnMenuOpen",void 0),Ie([t.Event()],a.prototype,"columnMenuClick",void 0),Ie([t.Event()],a.prototype,"cellSelected",void 0),Ie([t.Event()],a.prototype,"cellDeselecting",void 0),Ie([t.Event()],a.prototype,"cellDeselected",void 0),Ie([t.Event()],a.prototype,"resizeStart",void 0),Ie([t.Event()],a.prototype,"resizing",void 0),Ie([t.Event()],a.prototype,"resizeStop",void 0),Ie([t.Event()],a.prototype,"columnDragStart",void 0),Ie([t.Event()],a.prototype,"columnDrag",void 0),Ie([t.Event()],a.prototype,"columnDrop",void 0),Ie([t.Event()],a.prototype,"checkboxChange",void 0),Ie([t.Event()],a.prototype,"printComplete",void 0),Ie([t.Event()],a.prototype,"beforePrint",void 0),Ie([t.Event()],a.prototype,"toolbarClick",void 0),Ie([t.Event()],a.prototype,"beforeDataBound",void 0),Ie([t.Event()],a.prototype,"contextMenuOpen",void 0),Ie([t.Event()],a.prototype,"contextMenuClick",void 0),Ie([t.Property(-1)],a.prototype,"selectedRowIndex",void 0),Ie([t.Complex({},ae)],a.prototype,"selectionSettings",void 0),Ie([t.Property(!1)],a.prototype,"allowExcelExport",void 0),Ie([t.Property(!1)],a.prototype,"allowPdfExport",void 0),Ie([t.Event()],a.prototype,"pdfQueryCellInfo",void 0),Ie([t.Event()],a.prototype,"pdfHeaderQueryCellInfo",void 0),Ie([t.Event()],a.prototype,"excelQueryCellInfo",void 0),Ie([t.Event()],a.prototype,"excelHeaderQueryCellInfo",void 0),Ie([t.Event()],a.prototype,"beforeExcelExport",void 0),Ie([t.Event()],a.prototype,"excelExportComplete",void 0),Ie([t.Event()],a.prototype,"beforePdfExport",void 0),Ie([t.Event()],a.prototype,"pdfExportComplete",void 0),a=l=Ie([t.NotifyPropertyChanges],a)}(t.Component),Ee=function(){function e(e,t){i.Grid.Inject(i.Reorder),this.parent=e,this.addEventListener()}return e.prototype.getModuleName=function(){return"reorder"},e.prototype.addEventListener=function(){this.parent.on("getColumnIndex",this.getTreeColumn,this)},e.prototype.removeEventListener=function(){this.parent.isDestroyed||this.parent.off("getColumnIndex",this.getTreeColumn)},e.prototype.destroy=function(){this.removeEventListener()},e.prototype.getTreeColumn=function(){for(var e,t=this.parent.columns[this.parent.treeColumnIndex],r=this.parent.getColumns(),n=0;n<r.length;n++){if(i.getObject("field",t)===i.getObject("field",r[n])){e=n;break}}this.parent.setProperties({treeColumnIndex:e},!0)},e}(),Oe=function(){function e(e){i.Grid.Inject(i.Resize),this.parent=e}return e.prototype.autoFitColumns=function(e){this.parent.grid.autoFitColumns(e)},e.prototype.getModuleName=function(){return"resize"},e.prototype.destroy=function(){this.parent.isDestroyed||this.parent.grid.resizeModule.destroy()},e}(),De=function(){function e(e){i.Grid.Inject(i.Filter),this.parent=e,this.isHierarchyFilter=!1,this.filteredResult=[],this.flatFilteredData=[],this.filteredParentRecs=[],this.addEventListener()}return e.prototype.getModuleName=function(){return"filter"},e.prototype.destroy=function(){this.removeEventListener()},e.prototype.addEventListener=function(){this.parent.on("updateFilterRecs",this.updatedFilteredRecord,this),this.parent.on("clearFilters",this.clearFilterLevel,this)},e.prototype.removeEventListener=function(){this.parent.isDestroyed||(this.parent.off("updateFilterRecs",this.updatedFilteredRecord),this.parent.off("clearFilters",this.clearFilterLevel))},e.prototype.updatedFilteredRecord=function(e){t.setValue("uniqueIDFilterCollection",{},this.parent),this.flatFilteredData=e.data,this.filteredParentRecs=[],this.filteredResult=[],this.isHierarchyFilter=!1;for(var r=0;r<this.flatFilteredData.length;r++){var n=this.flatFilteredData[r];this.addParentRecord(n),"Child"!==this.parent.filterSettings.hierarchyMode&&"None"!==this.parent.filterSettings.hierarchyMode&&"Child"!==this.parent.searchSettings.hierarchyMode&&"None"!==this.parent.searchSettings.hierarchyMode||(this.isHierarchyFilter=!0);var o=i.getObject("childRecords",n);!t.isNullOrUndefined(o)&&o.length&&t.setValue("hasFilteredChildRecords",this.checkChildExsist(n),n);var s=i.getObject("parentItem",n);if(!t.isNullOrUndefined(s)){var a=u(this.parent,n.parentItem.uniqueID,!0);t.setValue("hasFilteredChildRecords",!0,a)}}this.flatFilteredData.length>0&&this.isHierarchyFilter&&this.updateFilterLevel(),this.parent.notify("updateAction",{result:this.filteredResult})},e.prototype.addParentRecord=function(e){var i=u(this.parent,e.parentUniqueID);if("None"===this.parent.filterSettings.hierarchyMode||"None"===this.parent.searchSettings.hierarchyMode)if(t.isNullOrUndefined(i)){if(-1!==this.flatFilteredData.indexOf(e))return void(-1===this.filteredResult.indexOf(e)&&(this.filteredResult.push(e),t.setValue("uniqueIDFilterCollection."+e.uniqueID,e,this.parent),e.hasFilteredChildRecords=!0))}else this.addParentRecord(i),-1!==this.flatFilteredData.indexOf(i)||-1!==this.filteredResult.indexOf(i)?-1===this.filteredResult.indexOf(e)&&(this.filteredResult.push(e),t.setValue("uniqueIDFilterCollection."+e.uniqueID,e,this.parent)):-1===this.filteredResult.indexOf(e)&&-1!==this.flatFilteredData.indexOf(e)&&(this.filteredResult.push(e),t.setValue("uniqueIDFilterCollection."+e.uniqueID,e,this.parent));else t.isNullOrUndefined(i)||("Child"===this.parent.filterSettings.hierarchyMode||"Child"===this.parent.searchSettings.hierarchyMode?-1!==this.flatFilteredData.indexOf(i)&&this.addParentRecord(i):this.addParentRecord(i)),-1===this.filteredResult.indexOf(e)&&(this.filteredResult.push(e),t.setValue("uniqueIDFilterCollection."+e.uniqueID,e,this.parent))},e.prototype.checkChildExsist=function(e){for(var r=i.getObject("childRecords",e),n=!1,o=0;o<r.length;o++){var s=r[o].childRecords;if("Child"!==this.parent.filterSettings.hierarchyMode&&"Both"!==this.parent.filterSettings.hierarchyMode&&"Child"!==this.parent.searchSettings.hierarchyMode&&"Both"!==this.parent.searchSettings.hierarchyMode||(this.filteredResult.push(r[o]),t.setValue("uniqueIDFilterCollection."+r[o].uniqueID,r[o],this.parent),n=!0),("None"===this.parent.filterSettings.hierarchyMode||"None"===this.parent.searchSettings.hierarchyMode)&&this.flatFilteredData.indexOf(-1!==r[o])){n=!0;break}!t.isNullOrUndefined(s)&&s.length&&(n=this.checkChildExsist(r[o]))}return n},e.prototype.updateFilterLevel=function(){for(var e=this.filteredResult,t=this.filteredResult.length,i=0;i<t;i++){var r=u(this.parent,e[i].parentUniqueID);if(-1!==e.indexOf(r)){var n=u(this.parent,e[i].parentUniqueID,!0);e[i].filterLevel=n.filterLevel+1}else e[i].filterLevel=0,this.filteredParentRecs.push(e[i])}},e.prototype.clearFilterLevel=function(e){for(var i,r=0,n=e.flatData,o=n.length;r<o;r++){var s=(i=n[r]).filterLevel;!s&&0!==s&&t.isNullOrUndefined(i.hasFilteredChildRecords)||(i.hasFilteredChildRecords=null,i.filterLevel=null)}this.filteredResult=[],this.parent.notify("updateResults",{result:n,count:n.length})},e}(),ke=function(){function e(e){i.Grid.Inject(i.ExcelExport),this.parent=e,this.dataResults={},this.addEventListener()}return e.prototype.getModuleName=function(){return"ExcelExport"},e.prototype.addEventListener=function(){this.parent.on("updateResults",this.updateExcelResultModel,this),this.parent.on("excelCellInfo",this.excelQueryCellInfo,this)},e.prototype.destroy=function(){this.removeEventListener()},e.prototype.removeEventListener=function(){this.parent.isDestroyed||(this.parent.off("updateResults",this.updateExcelResultModel),this.parent.off("excelCellInfo",this.excelQueryCellInfo))},e.prototype.updateExcelResultModel=function(e){this.dataResults=e},e.prototype.Map=function(e,r,o,s,a){var l=this,d=this.parent.dataSource,p=Object();return t.setValue("isCsv",a,p),t.setValue("cancel",!1,p),new Promise(function(c,h){var u=l.isLocal()?new n.DataManager(d):l.parent.dataSource,g=new n.Query;if(l.isLocal()||(g=l.generateQuery(g),t.setValue("query",g,p)),l.parent.trigger(D,t.extend(p,e)),i.getObject("cancel",p))return null;u.executeQuery(g).then(function(t){return e=l.manipulateExportProperties(e,d,t),l.parent.grid.excelExportModule.Map(l.parent.grid,e,r,o,a,s)})})},e.prototype.generateQuery=function(e,r){return!t.isNullOrUndefined(r)&&"CurrentPage"===r.exportType&&this.parent.allowPaging&&(r.exportType="AllPages",e.addParams("ExportType","CurrentPage"),e.where(this.parent.parentIdMapping,"equal",null),e=i.getObject("grid.renderModule.data.pageQuery",this.parent)(e)),e},e.prototype.manipulateExportProperties=function(e,r,o){var s=Object();return t.setValue("query",this.parent.grid.getDataModule().generateQuery(!0),s),t.setValue("isExport",!0,s),t.isNullOrUndefined(e)||t.isNullOrUndefined(e.exportType)||t.setValue("exportType",e.exportType,s),this.isLocal()&&t.isNullOrUndefined(this.parent.parentIdMapping)||(this.parent.parentData=[],this.parent.dataModule.convertToFlatData(i.getObject("result",o)),t.setValue("expresults",this.parent.flatData,s)),this.parent.notify("dataProcessor",s),s=this.dataResults,r=t.isNullOrUndefined(s.result)?this.parent.flatData.slice(0):s.result,this.isLocal()||(this.parent.flatData=[]),e=t.isNullOrUndefined(e)?Object():e,e.dataSource=new n.DataManager({json:r}),e},e.prototype.excelQueryCellInfo=function(e){if(this.parent.grid.getColumnIndexByUid(e.column.uid)===this.parent.treeColumnIndex){var i={},r=e.data,n=t.isNullOrUndefined(r.filterLevel)?r.level:r.filterLevel;i.indent=n,e.style=i}this.parent.notify("updateResults",e),this.parent.trigger("excelQueryCellInfo",e)},e.prototype.isLocal=function(){return!s(this.parent)&&p(this.parent)},e}(),Ae=function(){function e(e){i.Grid.Inject(i.PdfExport),this.parent=e,this.dataResults={},this.addEventListener()}return e.prototype.getModuleName=function(){return"PdfExport"},e.prototype.addEventListener=function(){this.parent.on("pdfCellInfo",this.pdfQueryCellInfo,this),this.parent.on("updateResults",this.updatePdfResultModel,this)},e.prototype.removeEventListener=function(){this.parent.isDestroyed||(this.parent.off("pdfCellInfo",this.pdfQueryCellInfo),this.parent.off("updateResults",this.updatePdfResultModel))},e.prototype.destroy=function(){this.removeEventListener()},e.prototype.updatePdfResultModel=function(e){this.dataResults=e},e.prototype.Map=function(e,r,o,a){var l=this,d=this.parent.dataSource,c=Object(),h=!s(this.parent)&&p(this.parent);return t.setValue("cancel",!1,c),new Promise(function(s,p){var u=h?new n.DataManager(d):l.parent.dataSource,g=new n.Query;if(h||(g=l.generateQuery(g),t.setValue("query",g,c)),l.parent.trigger(k,t.extend(c,e)),i.getObject("cancel",c))return null;u.executeQuery(g).then(function(t){return e=l.manipulatePdfProperties(e,d,t),l.parent.grid.pdfExportModule.Map(l.parent.grid,e,r,o,a)})})},e.prototype.generateQuery=function(e,r){return!t.isNullOrUndefined(r)&&"CurrentPage"===r.exportType&&this.parent.allowPaging&&(r.exportType="AllPages",e.addParams("ExportType","CurrentPage"),e.where(this.parent.parentIdMapping,"equal",null),e=i.getObject("grid.renderModule.data.pageQuery",this.parent)(e)),e},e.prototype.manipulatePdfProperties=function(e,i,r){var o={},a=!s(this.parent)&&p(this.parent);return t.setValue("query",this.parent.grid.getDataModule().generateQuery(!0),o),t.setValue("isExport",!0,o),t.isNullOrUndefined(e)||t.isNullOrUndefined(e.exportType)||t.setValue("exportType",e.exportType,o),a&&t.isNullOrUndefined(this.parent.parentIdMapping)||(this.parent.parentData=[],this.parent.dataModule.convertToFlatData(t.getValue("result",r)),t.setValue("expresults",this.parent.flatData,o)),this.parent.notify("dataProcessor",o),o=this.dataResults,i=t.isNullOrUndefined(o.result)?this.parent.flatData.slice(0):o.result,a||(this.parent.flatData=[]),e=t.isNullOrUndefined(e)?{}:e,e.dataSource=new n.DataManager({json:i}),e},e.prototype.pdfQueryCellInfo=function(e){if(this.parent.grid.getColumnIndexByUid(e.column.uid)===this.parent.treeColumnIndex){var r={},n=i.getObject("data",e),o=t.isNullOrUndefined(n.filterLevel)?n.level:n.filterLevel;r.paragraphIndent=3*o,e.style=r}this.parent.notify("updateResults",e),this.parent.trigger("pdfQueryCellInfo",e)},e}(),Ne=function(){function e(e){i.Grid.Inject(i.Page),this.parent=e,this.addEventListener()}return e.prototype.addEventListener=function(){this.parent.on(T,this.collapseExpandPagedchilds,this),this.parent.on(U,this.pageAction,this)},e.prototype.removeEventListener=function(){this.parent.isDestroyed||(this.parent.off(T,this.collapseExpandPagedchilds),this.parent.off(U,this.pageAction))},e.prototype.getModuleName=function(){return"pager"},e.prototype.refresh=function(){this.parent.grid.pagerModule.refresh()},e.prototype.destroy=function(){this.removeEventListener()},e.prototype.goToPage=function(e){this.parent.grid.pagerModule.goToPage(e)},e.prototype.updateExternalMessage=function(e){this.parent.grid.pagerModule.updateExternalMessage(e)},e.prototype.collapseExpandPagedchilds=function(e){e.record.expanded="collapse"!==e.action;var i={result:this.parent.flatData,row:e.row,action:e.action,record:e.record,count:this.parent.flatData.length};t.getValue("grid.renderModule",this.parent).dataManagerSuccess(i)},e.prototype.pageRoot=function(e,i,r){for(var n=t.isNullOrUndefined(r)?[]:r,o=function(t){n.push(i[t]);var r=[];i[t].hasChildRecords&&(r=e.filter(function(e){return i[t].uniqueID===e.parentUniqueID}),n=s.pageRoot(e,r,n))},s=this,a=0;a<i.length;a++)o(a);return n},e.prototype.pageAction=function(e){var t=this,i=new n.DataManager(e.result);if("Root"===this.parent.pageSettings.pageSizeMode){var r=[],o=this.parent.grid.filterSettings.columns.length>0&&("Child"===this.parent.filterSettings.hierarchyMode||"None"===this.parent.filterSettings.hierarchyMode)?"filterLevel":"level",s=(new n.Query).where(o,"equal",0);r=i.executeLocal(s),e.count=r.length;var a=(g=this.parent.grid.pageSettings.pageSize)*(this.parent.grid.pageSettings.currentPage-1);s=s.skip(a).take(g),r=i.executeLocal(s);var d=this.pageRoot(e.result,r);e.result=d}else{var p=new n.DataManager(e.result),c=new n.Predicate("expanded","notequal",null).or("expanded","notequal",void 0),h=p.executeLocal((new n.Query).where(c)),u=h.filter(function(e){return l(t.parent,e,h)});e.count=u.length;var g;s=new n.Query,a=(g=this.parent.grid.pageSettings.pageSize)*(this.parent.grid.pageSettings.currentPage-1);s=s.skip(a).take(g),p.dataSource.json=u,e.result=p.executeLocal(s)}this.parent.notify("updateAction",e)},e}(),qe=function(){function e(e){i.Grid.Inject(i.Toolbar),this.parent=e,this.addEventListener()}return e.prototype.getModuleName=function(){return"toolbar"},e.prototype.addEventListener=function(){this.parent.on(O,this.toolbarClickHandler,this)},e.prototype.removeEventListener=function(){this.parent.isDestroyed||this.parent.off(O,this.toolbarClickHandler)},e.prototype.toolbarClickHandler=function(e){"Cell"===this.parent.editSettings.mode&&"Batch"===this.parent.grid.editSettings.mode&&e.item.id===this.parent.grid.element.id+"_update"&&(e.cancel=!0,this.parent.grid.editModule.saveCell()),e.item.id===this.parent.grid.element.id+"_expandall"&&this.parent.expandAll(),e.item.id===this.parent.grid.element.id+"_collapseall"&&this.parent.collapseAll()},e.prototype.getToolbar=function(){return this.parent.grid.toolbarModule.getToolbar()},e.prototype.enableItems=function(e,t){this.parent.grid.toolbarModule.enableItems(e,t)},e.prototype.destroy=function(){this.removeEventListener()},e}(),je=function(){function e(e){i.Grid.Inject(i.Aggregate),this.parent=e,this.flatChildRecords=[],this.summaryQuery=[]}return e.prototype.getModuleName=function(){return"summary"},e.prototype.removeEventListener=function(){this.parent.isDestroyed},e.prototype.calculateSummaryValue=function(e,r,n){this.summaryQuery=e;var o,s;s=[];for(var l=0,d=Object.keys(r).length;l<d;l++){i.getObject("isSummaryRow",r[l])||s.push(r[l])}var p,c=a(s);p=s.slice();var h,u=Object.keys(this.parent.columns).length,g=Object.keys(this.parent.aggregates).length,f=0;for(d=Object.keys(c).length;f<d;f++){o=c[f],h=this.getChildRecordsLength(o,p);for(var y=function(e,r){var s=void 0;s={};for(var a=0,l=u;a<l;a++){s[t.isNullOrUndefined(i.getObject("field",m.parent.columns[a]))?m.parent.columns[a]:i.getObject("field",m.parent.columns[a])]=null}if(!m.parent.aggregates[e-1].showChildSummary)return"continue";s=m.createSummaryItem(s,m.parent.aggregates[e-1]);var d;p.map(function(e,t){e.uniqueID!==o.uniqueID||(d=t)});var c=d+h+e,g=t.extend({},o);delete g.childRecords,delete g[m.parent.childMapping],t.setValue("parentItem",g,s);var f=i.getObject("level",g);t.setValue("level",f+1,s);i.getObject("index",g);if(t.setValue("isSummaryRow",!0,s),n){i.getObject("childRecords",o).push(s)}p.splice(c,0,s)},m=this,v=1,w=g;v<=w;v++)y(v);this.flatChildRecords=[]}return p},e.prototype.getChildRecordsLength=function(e,r){for(var n,o=0,s=Object.keys(r).length;o<s;o++){n=r[o];if(e===(t.isNullOrUndefined(n.parentItem)?null:r.filter(function(e){return e.uniqueID===n.parentItem.uniqueID})[0])){this.flatChildRecords.push(n);if(!i.getObject("hasChildRecords",n))continue;this.getChildRecordsLength(n,r)}}return this.flatChildRecords.length},e.prototype.createSummaryItem=function(e,i){for(var r=0,n=Object.keys(i.columns).length;r<n;r++)for(var o=t.isNullOrUndefined(i.columns[r].columnName)?i.columns[r].field:i.columns[r].columnName,s=0,a=Object.keys(e);s<a.length;s++){var l=a[s];l===o&&(e[l]=this.getSummaryValues(i.columns[r],this.flatChildRecords))}return e},e.prototype.getSummaryValues=function(e,r){var o,s=this,a=new n.Query;o={};var l={},d=t.isNullOrUndefined(e.field)?void 0:this.parent.getColumnByField(e.field).type;e.setPropertiesSilent({format:this.getFormatFromType(e.format,d)}),e.setFormatter(this.parent.grid.locale);var p=e.getFormatter()||function(e){return e};e.setTemplate(l);var c=e.getTemplate(2);a.queries=this.summaryQuery,a.requiresCount();var h,u=new n.DataManager(r).executeLocal(a);e.type;[e.type].forEach(function(r){h=r;var n=e.field+" - "+r.toLowerCase(),a="Custom"!==r?i.getObject("aggregates",u):i.calculateAggregate(r,u,e,s.parent),l=e.columnName,d="Custom"!==r?a[n]:a;o[l]=o[l]||{},o[l][n]=d,o[l][r]=t.isNullOrUndefined(a)?" ":p(d)}),l.format=e.getFormatter();var g=t.createElement("td",{className:"e-summary"});i.appendChildren(g,c.fn(o[e.columnName],this.parent,c.property));var f=o[e.columnName][h];return-1===g.innerHTML.indexOf(f)?g.innerHTML+f:g.innerHTML},e.prototype.getFormatFromType=function(e,i){if(t.isNullOrUndefined(i)||"string"!=typeof e)return e;var r;switch(i){case"number":r={format:e};break;case"datetime":r={type:"dateTime",skeleton:e};break;case"date":r={type:i,skeleton:e}}return r},e.prototype.destroy=function(){this.removeEventListener()},e}(),Le=function(){function e(e){i.Grid.Inject(i.ContextMenu),this.parent=e,this.addEventListener()}return e.prototype.addEventListener=function(){this.parent.on("contextMenuOpen",this.contextMenuOpen,this),this.parent.on("contextMenuClick",this.contextMenuClick,this)},e.prototype.removeEventListener=function(){this.parent.isDestroyed||(this.parent.off("contextMenuOpen",this.contextMenuOpen),this.parent.off("contextMenuClick",this.contextMenuClick))},e.prototype.contextMenuOpen=function(e){var i=e.element.querySelector("#"+this.parent.element.id+"_gridcontrol_cmenu_AddRow"),r=e.element.querySelector("#"+this.parent.element.id+"_gridcontrol_cmenu_Edit");i&&(!1===this.parent.grid.editSettings.allowAdding?i.style.display="none":i.style.display="block"),"Cell"!==this.parent.editSettings.mode||t.isNullOrUndefined(r)||r.classList.contains("e-menu-hide")||(r.style.display="none")},e.prototype.contextMenuClick=function(e){"Above"!==e.item.id&&"Below"!==e.item.id||(this.parent.notify("savePreviousRowPosition",e),this.parent.setProperties({editSettings:{newRowPosition:e.item.id}},!0),this.parent.addRecord())},e.prototype.getModuleName=function(){return"contextMenu"},e.prototype.destroy=function(){this.removeEventListener()},e.prototype.getContextMenu=function(){return this.parent.grid.contextMenuModule.getContextMenu()},e}(),Te=function(){function e(e){i.Grid.Inject(i.Edit),this.parent=e,this.isSelfReference=!t.isNullOrUndefined(e.parentIdMapping),this.previousNewRowPosition=null,this.addEventListener()}return e.prototype.getModuleName=function(){return"edit"},e.prototype.addEventListener=function(){this.parent.on(_,this.crudAction,this),this.parent.on(H,this.beginEdit,this),this.parent.on(G,this.beginAdd,this),this.parent.on(Q,this.recordDoubleClick,this),this.parent.on(z,this.cellSave,this),this.parent.on(K,this.batchCancel,this),this.parent.grid.on(J,this.keyPressed,this),this.parent.grid.on("content-ready",this.contentready,this),this.parent.on(W,this.cellEdit,this),this.parent.grid.on(X,this.recordDoubleClick,this),this.parent.on("savePreviousRowPosition",this.savePreviousRowPosition,this),this.parent.grid.on(Y,this.beforeStartEdit,this),this.parent.grid.on(Z,this.beforeBatchCancel,this)},e.prototype.beforeStartEdit=function(e){this.parent.trigger(R,e)},e.prototype.beforeBatchCancel=function(e){e.type="cancel",this.parent.trigger(M,e)},e.prototype.removeEventListener=function(){this.parent.isDestroyed||(this.parent.off(_,this.crudAction),this.parent.off(H,this.beginEdit),this.parent.off(G,this.beginAdd),this.parent.off(Q,this.recordDoubleClick),this.parent.off(z,this.cellSave),this.parent.off(K,this.batchCancel),this.parent.grid.off(J,this.keyPressed),this.parent.grid.off("content-ready",this.contentready),this.parent.off(W,this.cellEdit),this.parent.grid.off(X,this.recordDoubleClick),this.parent.off("savePreviousRowPosition",this.savePreviousRowPosition),this.parent.grid.off(Y,this.beforeStartEdit),this.parent.grid.off(Z,this.beforeBatchCancel))},e.prototype.destroy=function(){this.removeEventListener()},e.prototype.applyFormValidation=function(e){this.parent.grid.editModule.applyFormValidation(e)},e.prototype.recordDoubleClick=function(e){var t=e.target;this.doubleClickTarget=t;var i=this.parent.grid.getColumnByIndex(+t.closest("td").getAttribute("aria-colindex"));"Cell"!==this.parent.editSettings.mode||this.isOnBatch||!i||i.isPrimaryKey||!i.allowEditing||t.classList.contains("e-treegridexpand")||t.classList.contains("e-treegridcollapse")||(this.isOnBatch=!0,this.parent.grid.setProperties({selectedRowIndex:e.rowIndex},!0),this.updateGridEditMode("Batch"))},e.prototype.updateGridEditMode=function(e){this.parent.grid.setProperties({editSettings:{mode:e}},!0);i.getObject("updateEditObj",this.parent.grid.editModule).apply(this.parent.grid.editModule),this.parent.grid.isEdit=!1},e.prototype.keyPressed=function(e){this.isOnBatch&&(this.keyPress=e.action),"f2"===e.action&&this.recordDoubleClick(e)},e.prototype.deleteUniqueID=function(e){delete this.parent.uniqueIDFilterCollection[e];delete this.parent.uniqueIDCollection[e]},e.prototype.cellEdit=function(e){if("enter"!==this.keyPress&&this.parent.trigger(W,e),this.doubleClickTarget&&(this.doubleClickTarget.classList.contains("e-treegridexpand")||this.doubleClickTarget.classList.contains("e-treegridcollapse")))return e.cancel=!0,void(this.doubleClickTarget=null);"Cell"===this.parent.editSettings.mode&&("tab"===this.keyPress||"shiftTab"===this.keyPress?this.keyPress=null:"enter"===this.keyPress&&(e.cancel=!0,this.keyPress=null),e.cancel||this.enableToolbarItems("edit"))},e.prototype.enableToolbarItems=function(e){if(!t.isNullOrUndefined(this.parent.grid.toolbarModule)){var i=this.parent.element.id+"_gridcontrol_";this.parent.grid.toolbarModule.enableItems([i+"add",i+"edit",i+"delete"],"save"===e),this.parent.grid.toolbarModule.enableItems([i+"update",i+"cancel"],"edit"===e)}},e.prototype.batchCancel=function(e){if("Cell"===this.parent.editSettings.mode){var i=t.getValue("editModule.cellDetails",this.parent.grid.editModule),r=i.rowIndex;this.parent.renderModule.cellRender({data:i.rowData,cell:this.parent.getRows()[r].cells[this.parent.treeColumnIndex],column:this.parent.grid.getColumns()[this.parent.treeColumnIndex]}),this.updateGridEditMode("Normal"),this.isOnBatch=!1}},e.prototype.cellSave=function(e){if("Cell"===this.parent.editSettings.mode&&this.parent.element.querySelector("form")){e.cancel=!0,t.setValue("isEdit",!1,this.parent.grid),e.rowData[e.columnName]=e.value;var i,r=e.cell.parentNode,n=this.parent.getPrimaryKeyFieldNames();t.isNullOrUndefined(r)?this.parent.grid.getCurrentViewRecords().filter(function(t,r){t[n[0]]!==e.rowData[n[0]]||(i=r)}):i=r.rowIndex;var o={};if(t.extend(o,e),o.cancel=!1,o.type="save",r=this.parent.grid.getRows()[i],this.parent.trigger(R,o),o.cancel)this.parent.grid.isEdit=!0;else{this.updateCell(e,i),this.parent.grid.aggregateModule&&this.parent.grid.aggregateModule.refresh(e.rowData),this.parent.grid.editModule.formObj.destroy(),"tab"!==this.keyPress&&"shiftTab"!==this.keyPress&&(this.updateGridEditMode("Normal"),this.isOnBatch=!1),this.enableToolbarItems("save"),t.removeClass([r],["e-editedrow","e-batchrow"]),t.removeClass(r.querySelectorAll(".e-rowcell"),["e-editedbatchcell","e-updatedtd"]),g({value:e.rowData,action:"edit"},this.parent,this.isSelfReference,this.addRowIndex,this.selectedIndex,e.columnName,this.addRowRecord);var s={type:"save",column:this.parent.getColumnByField(e.columnName),data:e.rowData,previousData:e.previousValue,row:r,target:e.cell};this.parent.trigger(M,s)}}},e.prototype.updateCell=function(e,t){this.parent.grid.editModule.updateRow(t,e.rowData),this.parent.grid.getRowsObject()[t].data=e.rowData},e.prototype.crudAction=function(e,i){g(e,this.parent,this.isSelfReference,this.addRowIndex,this.selectedIndex,i,this.addRowRecord),this.parent.parentData=[];for(var r=this.parent.grid.dataSource,n=0;n<this.parent.grid.dataSource.length;n++)r[n].index=n,t.setValue("uniqueIDCollection."+r[n].uniqueID+".index",n,this.parent),r[n].level||this.parent.parentData.push(r[n]);"add"===e.action&&null!=this.previousNewRowPosition&&(this.parent.setProperties({editSettings:{newRowPosition:this.previousNewRowPosition}},!0),this.previousNewRowPosition=null)},e.prototype.updateIndex=function(e,i,r){for(var n=0;n<this.parent.getRows().length;n++){var o=r[n],s=t.getValue("uniqueIDCollection."+o.uniqueID+".index",this.parent);if(o.index=s,!t.isNullOrUndefined(o.parentItem)){var a=t.getValue("uniqueIDCollection."+o.parentItem.uniqueID+".index",this.parent);o.parentItem.index=a}}for(var l=0;l<this.parent.getRows().length;l++){var d=r[l],p=(s=d.index,d.level),c=i[l];t.isNullOrUndefined(d.parentItem)||(s=t.getValue("uniqueIDCollection."+d.parentItem.uniqueID+".index",this.parent));for(var h=0;h<c.classList.length;h++){var u=c.classList[h];null!=u.match(/e-gridrowindex/i)&&t.removeClass([c],u)}t.addClass([c],"e-gridrowindex"+s+"level"+p)}},e.prototype.beginAdd=function(e){var i,r=this.addRowIndex,n=this.parent.grid.getCurrentViewRecords(),o=this.parent.grid.getDataRows();if("Dialog"!==this.parent.editSettings.mode&&("Child"===this.parent.editSettings.newRowPosition&&!n[r].expanded&&n[r].hasChildRecords&&this.parent.expandRow(o[r+1],n[r]),"Above"===this.parent.editSettings.newRowPosition?i="before":("Below"===this.parent.editSettings.newRowPosition||"Child"===this.parent.editSettings.newRowPosition)&&this.selectedIndex>-1&&(i="after",r+=d(n[r]).length),this.selectedIndex>-1&&(r||"Child"===this.parent.editSettings.newRowPosition||"Below"===this.parent.editSettings.newRowPosition))){r>=o.length&&(r=o.length-2);var s=document.activeElement;if(o[r+1][i](o[0]),"Row"===this.parent.editSettings.mode||"Cell"===this.parent.editSettings.mode){for(var a=this.parent.grid.getContentTable().querySelectorAll(".e-griderror"),l=0;l<a.length;l++)a[l].remove();t.setValue("errorRules",[],this.parent.grid.editModule.formObj)}s.focus()}},e.prototype.beginEdit=function(e){if("refresh"===e.requestType&&this.isOnBatch)e.cancel=!0;else if("Cell"!==this.parent.editSettings.mode||"beginEdit"!==e.requestType){if(this.doubleClickTarget&&(this.doubleClickTarget.classList.contains("e-treegridexpand")||this.doubleClickTarget.classList.contains("e-treegridcollapse")||this.doubleClickTarget.classList.contains("e-frame")))return e.cancel=!0,void(this.doubleClickTarget=null);if("delete"===e.requestType)for(var t=e.data,i=0;i<t.length;i++){this.deleteUniqueID(t[i].uniqueID);for(var r=d(t[i]),n=0;n<r.length;n++)this.deleteUniqueID(r[n].uniqueID);e.data=t.concat(r)}"add"===e.requestType&&(this.selectedIndex=this.parent.grid.selectedRowIndex,this.addRowIndex=this.parent.grid.selectedRowIndex>-1?this.parent.grid.selectedRowIndex:0,this.addRowRecord=this.parent.getSelectedRecords()[0]),e=this.beginAddEdit(e)}else e.cancel=!0},e.prototype.savePreviousRowPosition=function(e){null===this.previousNewRowPosition&&(this.previousNewRowPosition=this.parent.editSettings.newRowPosition)},e.prototype.beginAddEdit=function(e){var r=e.data;if("add"===e.action){var o=this.parent.grid.getPrimaryKeyFieldNames()[0],s=null,a=this.parent.grid.getCurrentViewRecords(),l=this.addRowIndex;r.uniqueID=i.getUid(this.parent.element.id+"_data_"),t.setValue("uniqueIDCollection."+r.uniqueID,r,this.parent);var p=void 0,c=void 0,h=void 0,u=void 0,g=void 0;if(a.length&&(p=a[this.addRowIndex].level,a[this.addRowIndex].index,c=a[this.addRowIndex][this.parent.idMapping],g=a[this.addRowIndex][this.parent.parentIdMapping],a[this.addRowIndex].parentItem&&(h=a[this.addRowIndex].parentItem.uniqueID),u=a[this.addRowIndex].parentItem),"Top"!==this.parent.editSettings.newRowPosition){if("Above"===this.parent.editSettings.newRowPosition)s="before",l=a[this.addRowIndex].index;else if("Below"===this.parent.editSettings.newRowPosition){s="after";var f=d(a[this.addRowIndex]).length,m=a[this.addRowIndex].index;l=f>0?m+f:m}else if("Child"===this.parent.editSettings.newRowPosition){s="after",this.selectedIndex>-1&&(r.parentItem=t.extend({},a[this.addRowIndex]),r.parentUniqueID=r.parentItem.uniqueID,delete r.parentItem.childRecords,delete r.parentItem[this.parent.childMapping]);var v=d(a[this.addRowIndex]).length,w=a[this.addRowIndex].index;l=v>0?w+v:w,r.level=p+1,this.isSelfReference&&(r[this.parent.parentIdMapping]=c,t.isNullOrUndefined(r.parentItem)||y(o,r.parentItem,"add",this.parent,this.isSelfReference,r))}if("Above"!==this.parent.editSettings.newRowPosition&&"Below"!==this.parent.editSettings.newRowPosition||(this.selectedIndex>-1&&p&&(r.parentUniqueID=h,r.parentItem=t.extend({},u),delete r.parentItem.childRecords,delete r.parentItem[this.parent.childMapping]),r.level=p,this.isSelfReference&&(r[this.parent.parentIdMapping]=g,t.isNullOrUndefined(r.parentItem)||y(o,r.parentItem,"add",this.parent,this.isSelfReference,r))),null!=s&&this.selectedIndex>-1&&(e.index="before"===s?l:l+1),"Bottom"===this.parent.editSettings.newRowPosition){var x=this.parent.grid.dataSource instanceof n.DataManager?this.parent.grid.dataSource.dataSource.json:this.parent.grid.dataSource;e.index=x.length}}r.hasChildRecords=!1,r.childRecords=[],r.index=0}return e},e.prototype.addRecord=function(e,t,i){this.previousNewRowPosition=this.parent.editSettings.newRowPosition,e?(t>-1?(this.selectedIndex=t,this.addRowIndex=t):(this.selectedIndex=this.parent.selectedRowIndex,this.addRowIndex=this.parent.selectedRowIndex),i&&this.parent.setProperties({editSettings:{newRowPosition:i}},!0),this.parent.grid.editModule.addRecord(e,t)):this.parent.grid.editModule.addRecord(e,t)},e.prototype.editFormValidate=function(){return this.parent.grid.editModule.editFormValidate()},e.prototype.destroyForm=function(){this.parent.grid.editModule.destroyForm()},e.prototype.contentready=function(e){t.isNullOrUndefined(e.args.requestType)||"delete"!==e.args.requestType.toString()&&"save"!==e.args.requestType.toString()||this.updateIndex(this.parent.grid.dataSource,this.parent.getRows(),this.parent.getCurrentViewRecords())},e}(),Ue=function(){function e(e){i.Grid.Inject(i.CommandColumn),this.parent=e}return e.prototype.getModuleName=function(){return"commandColumn"},e.prototype.destroy=function(){},e}();e.TreeGrid=Pe,e.load="load",e.rowDataBound=C,e.dataBound="dataBound",e.queryCellInfo=b,e.beforeDataBound=S,e.actionBegin=R,e.actionComplete=M,e.rowSelecting="rowSelecting",e.rowSelected=I,e.checkboxChange=P,e.rowDeselected=E,e.toolbarClick=O,e.beforeExcelExport=D,e.beforePdfExport=k,e.resizeStop=A,e.expanded=N,e.expanding="expanding",e.collapsed=q,e.collapsing=j,e.remoteExpand=L,e.localPagedExpandCollapse=T,e.pagingActions=U,e.printGridInit=F,e.contextMenuOpen=B,e.contextMenuClick=V,e.savePreviousRowPosition="savePreviousRowPosition",e.crudAction=_,e.beginEdit=H,e.beginAdd=G,e.recordDoubleClick=Q,e.cellSave=z,e.cellSaved="cellSaved",e.cellEdit=W,e.batchDelete="batchDelete",e.batchCancel=K,e.batchAdd="batchAdd",e.beforeBatchAdd="beforeBatchAdd",e.beforeBatchSave="beforeBatchSave",e.batchSave="batchSave",e.keyPressed=J,e.updateData="update-data",e.doubleTap=X,e.beforeStartEdit=Y,e.beforeBatchCancel=Z,e.batchEditFormRendered="batcheditform-rendered",e.DataManipulation=pe,e.Reorder=Ee,e.Resize=Oe,e.Column=m,e.EditSettings=xe,e.FilterSettings=x,e.PageSettings=ue,e.SearchSettings=ne,e.SelectionSettings=ae,e.AggregateColumn=ye,e.AggregateRow=me,e.Render=le,e.isRemoteData=s,e.findParentRecords=a,e.getExpandStatus=l,e.findChildrenRecords=d,e.isOffline=p,e.extendArray=c,e.getPlainData=h,e.getParentData=u,e.Filter=De,e.ExcelExport=ke,e.PdfExport=Ae,e.Page=Ne,e.Toolbar=qe,e.Aggregate=je,e.Sort=de,e.ColumnMenu=ee,e.ContextMenu=Le,e.Edit=Te,e.CommandColumn=Ue,e.Selection=$,Object.defineProperty(e,"__esModule",{value:!0})});
//# sourceMappingURL=ej2-treegrid.umd.min.js.map
