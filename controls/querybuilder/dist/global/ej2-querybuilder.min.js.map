{"version":3,"file":"ej2-querybuilder.min.js","sources":["../../src/query-builder/query-builder.js"],"sourcesContent":["var __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    }\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\n/**\n * Query Builder Source\n */\nimport { Component, NotifyPropertyChanges, getComponent, Browser } from '@syncfusion/ej2-base';\nimport { Property, ChildProperty, Complex, L10n, closest, extend } from '@syncfusion/ej2-base';\nimport { getInstance, addClass, removeClass, rippleEffect, detach } from '@syncfusion/ej2-base';\nimport { Internationalization } from '@syncfusion/ej2-base';\nimport { Button, RadioButton } from '@syncfusion/ej2-buttons';\nimport { DropDownList, CheckBoxSelection } from '@syncfusion/ej2-dropdowns';\nimport { MultiSelect } from '@syncfusion/ej2-dropdowns';\nimport { Event, EventHandler, getValue } from '@syncfusion/ej2-base';\nimport { Query, Predicate, DataManager } from '@syncfusion/ej2-data';\nimport { TextBox, NumericTextBox } from '@syncfusion/ej2-inputs';\nimport { DatePicker } from '@syncfusion/ej2-calendars';\nimport { DropDownButton } from '@syncfusion/ej2-splitbuttons';\nimport { Tooltip } from '@syncfusion/ej2-popups';\nMultiSelect.Inject(CheckBoxSelection);\nvar Columns = /** @class */ (function (_super) {\n    __extends(Columns, _super);\n    function Columns() {\n        return _super !== null && _super.apply(this, arguments) || this;\n    }\n    __decorate([\n        Property(null)\n    ], Columns.prototype, \"field\", void 0);\n    __decorate([\n        Property(null)\n    ], Columns.prototype, \"label\", void 0);\n    __decorate([\n        Property(null)\n    ], Columns.prototype, \"type\", void 0);\n    __decorate([\n        Property(null)\n    ], Columns.prototype, \"values\", void 0);\n    __decorate([\n        Property(null)\n    ], Columns.prototype, \"operators\", void 0);\n    __decorate([\n        Property(null)\n    ], Columns.prototype, \"template\", void 0);\n    __decorate([\n        Property(null)\n    ], Columns.prototype, \"validation\", void 0);\n    __decorate([\n        Property(null)\n    ], Columns.prototype, \"format\", void 0);\n    __decorate([\n        Property(null)\n    ], Columns.prototype, \"step\", void 0);\n    return Columns;\n}(ChildProperty));\nexport { Columns };\nvar Rules = /** @class */ (function (_super) {\n    __extends(Rules, _super);\n    function Rules() {\n        return _super !== null && _super.apply(this, arguments) || this;\n    }\n    __decorate([\n        Property('')\n    ], Rules.prototype, \"condition\", void 0);\n    __decorate([\n        Property()\n    ], Rules.prototype, \"rules\", void 0);\n    __decorate([\n        Property(null)\n    ], Rules.prototype, \"field\", void 0);\n    __decorate([\n        Property(null)\n    ], Rules.prototype, \"label\", void 0);\n    __decorate([\n        Property(null)\n    ], Rules.prototype, \"type\", void 0);\n    __decorate([\n        Property(null)\n    ], Rules.prototype, \"operator\", void 0);\n    __decorate([\n        Property(null)\n    ], Rules.prototype, \"value\", void 0);\n    return Rules;\n}(ChildProperty));\nexport { Rules };\nvar Rule = /** @class */ (function (_super) {\n    __extends(Rule, _super);\n    function Rule() {\n        return _super !== null && _super.apply(this, arguments) || this;\n    }\n    __decorate([\n        Property('and')\n    ], Rule.prototype, \"condition\", void 0);\n    __decorate([\n        Property()\n    ], Rule.prototype, \"rules\", void 0);\n    return Rule;\n}(ChildProperty));\nexport { Rule };\nvar ShowButtons = /** @class */ (function (_super) {\n    __extends(ShowButtons, _super);\n    function ShowButtons() {\n        return _super !== null && _super.apply(this, arguments) || this;\n    }\n    __decorate([\n        Property(true)\n    ], ShowButtons.prototype, \"ruleDelete\", void 0);\n    __decorate([\n        Property(true)\n    ], ShowButtons.prototype, \"groupInsert\", void 0);\n    __decorate([\n        Property(true)\n    ], ShowButtons.prototype, \"groupDelete\", void 0);\n    return ShowButtons;\n}(ChildProperty));\nexport { ShowButtons };\nvar QueryBuilder = /** @class */ (function (_super) {\n    __extends(QueryBuilder, _super);\n    function QueryBuilder(options, element) {\n        var _this = _super.call(this, options, element) || this;\n        _this.groupIdCounter = 0;\n        _this.ruleIdCounter = 0;\n        _this.btnGroupId = 0;\n        _this.isImportRules = false;\n        _this.parser = [];\n        _this.intl = new Internationalization();\n        _this.customOperators = {};\n        _this.operators = {\n            equal: '=', notequal: '!=', greaterthan: '>', greaterthanorequal: '>=', lessthan: '<', in: 'IN', notin: 'NOT IN',\n            lessthanorequal: '<=', startswith: 'LIKE', endswith: 'LIKE', between: 'BETWEEN', notbetween: 'NOT BETWEEN', contains: 'LIKE'\n        };\n        _this.operatorValue = {\n            equal: 'Equal', greaterthan: 'GreaterThan', greaterthanorequal: 'GreaterThanOrEqual',\n            lessthan: 'LessThan', lessthanorequal: 'LessThanOrEqual', notequal: 'NotEqual', empty: 'Empty', notempty: 'NotEmpty',\n            between: 'Between', in: 'in', notin: 'NotIn', notbetween: 'NotBetween', startswith: 'StartsWith', endswith: 'EndsWith',\n            contains: 'Contains'\n        };\n        // validRules\n        _this.validationRules = {};\n        return _this;\n    }\n    QueryBuilder.prototype.getPersistData = function () {\n        return this.addOnPersist(['rule']);\n    };\n    /**\n     * Clears the rules without root rule.\n     * @returns void.\n     */\n    QueryBuilder.prototype.reset = function () {\n        this.isImportRules = false;\n        var bodeElem = this.element.querySelector('.e-group-body');\n        detach(bodeElem.children[0]);\n        bodeElem.appendChild(this.createElement('div', { attrs: { class: 'e-rule-list' } }));\n        this.levelColl[this.element.id + '_e_group0'] = [0];\n        this.rule = { condition: 'and', rules: [] };\n    };\n    QueryBuilder.prototype.getWrapper = function () {\n        return this.element;\n    };\n    QueryBuilder.prototype.getModuleName = function () {\n        return 'query-builder';\n    };\n    QueryBuilder.prototype.initialize = function () {\n        if (this.dataSource.length) {\n            var columnKeys = Object.keys(this.dataSource[0]);\n            var cols = [];\n            var type = void 0;\n            var isDate = false;\n            var value = void 0;\n            if (this.columns.length) {\n                if (this.sortDirection.toLowerCase() === 'descending') {\n                    this.columns = new DataManager(this.columns).executeLocal(new Query().sortByDesc('field'));\n                }\n                else if (this.sortDirection.toLowerCase() === 'ascending') {\n                    this.columns = new DataManager(this.columns).executeLocal(new Query().sortBy('field'));\n                }\n                var columns = this.columns;\n                for (var i = 0, len = columns.length; i < len; i++) {\n                    if (!columns[i].type) {\n                        if (columnKeys.indexOf(columns[i].field) > -1) {\n                            value = this.dataSource[0][columns[i].field];\n                            type = typeof value;\n                            if (type === 'string') {\n                                isDate = !isNaN(Date.parse(value));\n                            }\n                            else if (type === 'object') {\n                                isDate = value instanceof Date && !isNaN(value.getTime());\n                                type = 'string';\n                            }\n                            columns[i].type = type;\n                            isDate = false;\n                        }\n                        type = 'string';\n                    }\n                }\n            }\n            else {\n                for (var i = 0, len = columnKeys.length; i < len; i++) {\n                    value = this.dataSource[0][columnKeys[i]];\n                    type = typeof value;\n                    if (type === 'string') {\n                        isDate = !isNaN(Date.parse(value));\n                    }\n                    else if (type === 'object') {\n                        isDate = value instanceof Date && !isNaN(value.getTime());\n                        type = 'string';\n                    }\n                    cols[i] = { 'field': columnKeys[i], 'label': columnKeys[i], 'type': isDate ? 'date' : type };\n                    isDate = false;\n                }\n                this.columns = cols;\n            }\n        }\n    };\n    QueryBuilder.prototype.clickEventHandler = function (event) {\n        var target = event.target;\n        this.isImportRules = false;\n        if (target.tagName === 'SPAN') {\n            target = target.parentElement;\n        }\n        if (target.tagName === 'BUTTON') {\n            if (target.className.indexOf('e-removerule') > -1) {\n                if (target.className.indexOf('e-tooltip') > -1) {\n                    getComponent(target, 'tooltip').destroy();\n                }\n                this.deleteRule(target);\n            }\n            else if (target.className.indexOf('e-deletegroup') > -1) {\n                getComponent(target, 'tooltip').destroy();\n                this.deleteGroup(closest(target, '.e-group-container'));\n            }\n            else if (target.className.indexOf('e-edit-rule') > -1) {\n                document.getElementById(this.element.id + '_summary_content').style.display = 'none';\n                if (this.element.querySelectorAll('.e-group-container').length < 1) {\n                    this.addGroupElement(false, this.element, this.rule.condition);\n                    var mRules = extend({}, this.rule, {}, true);\n                    this.setGroupRules(mRules);\n                    this.renderSummaryCollapse();\n                }\n                else {\n                    var groupElem = this.element.querySelector('.e-group-container');\n                    if (groupElem.querySelectorAll('.e-collapse-rule').length < 1) {\n                        this.renderSummaryCollapse();\n                    }\n                    groupElem.style.display = 'block';\n                }\n            }\n            else if (target.className.indexOf('e-collapse-rule') > -1) {\n                var groupElem = this.element.querySelector('.e-group-container');\n                groupElem.style.display = 'none';\n                this.element.querySelector('.e-summary-text').textContent = this.getSqlFromRules(this.rule);\n                document.getElementById(this.element.id + '_summary_content').style.display = 'block';\n            }\n            else if (target.className.indexOf('e-collapse-rule') > -1) {\n                this.element.querySelector('.e-group-container').style.display = 'none';\n                this.element.querySelector('.e-summary-text').textContent = this.getSqlFromRules(this.rule);\n                document.getElementById(this.element.id + '_summary_content').style.display = 'block';\n            }\n        }\n        else if (target.tagName === 'LABEL' && target.parentElement.className.indexOf('e-btn-group') > -1) {\n            var element = closest(target, '.e-group-container');\n            var args = { groupID: element.id, selectedItem: target, cancel: false };\n            this.trigger('beforeConditionChange', args);\n            var rule = this.getGroup(element);\n            rule.condition = target.textContent.toLowerCase();\n            args = { groupID: element.id, selectedItem: target };\n            this.trigger('conditionChanged', args);\n        }\n    };\n    QueryBuilder.prototype.selectBtn = function (target, event) {\n        if (event.name === 'beforeOpen') {\n            addClass([event.element.querySelector('li span.e-addgroup').parentElement], 'e-button-hide1');\n        }\n        else if (event.element.children[0].className.indexOf('e-addrule') > -1) {\n            this.addRuleElement(closest(target, '.e-group-container'), {});\n        }\n        else if (event.element.children[0].className.indexOf('e-addgroup') > -1) {\n            this.addGroupElement(true, closest(target, '.e-group-container'), '', true);\n        }\n    };\n    QueryBuilder.prototype.addRuleElement = function (target, rule) {\n        var ruleElem = this.ruleElem.cloneNode(true);\n        if (this.displayMode === 'Vertical' || this.element.className.indexOf('e-device') > -1) {\n            ruleElem.className = 'e-rule-container e-vertical-mode';\n        }\n        else {\n            ruleElem.className = 'e-rule-container e-horizontal-mode';\n        }\n        var groupLevel;\n        var rules;\n        var i;\n        var len;\n        var dropDownList;\n        var ruleListElem = target.querySelector('.e-rule-list');\n        var element = ruleElem.querySelector('button');\n        var height;\n        if (this.element.className.indexOf('e-device') > -1 || this.displayMode === 'Vertical') {\n            element.textContent = this.l10n.getConstant('Remove');\n        }\n        else {\n            addClass([element], 'e-round');\n            addClass([element], 'e-icon-btn');\n            var tooltip = new Tooltip({ content: this.l10n.getConstant('DeleteRule') });\n            tooltip.appendTo(element);\n            element = this.createElement('span', { attrs: { class: 'e-btn-icon e-icons e-delete-icon' } });\n            ruleElem.querySelector('button').appendChild(element);\n        }\n        ruleElem.setAttribute('id', target.id + '_e_rule' + this.ruleIdCounter);\n        this.ruleIdCounter++;\n        ruleElem.querySelector('.e-filter-input').setAttribute('id', ruleElem.id + '_filterkey');\n        ruleListElem.appendChild(ruleElem);\n        height = (this.element.className.indexOf('e-device') > -1) ? '250px' : '200px';\n        dropDownList = new DropDownList({\n            dataSource: this.columns,\n            fields: { text: 'label', value: 'field' },\n            placeholder: this.l10n.getConstant('SelectField'),\n            popupHeight: ((this.columns.length > 5) ? height : 'auto'),\n            change: this.changeField.bind(this),\n            value: rule ? rule.field : null\n        });\n        dropDownList.appendTo('#' + ruleElem.id + '_filterkey');\n        if (this.allowValidation) {\n            ruleElem.querySelector('.e-filter-input').setAttribute('name', ruleElem.id + 'field');\n            addClass([ruleElem.querySelector('.e-filter-input')], 'e-error');\n            this.validationRules[ruleElem.id + 'field'] = { required: true };\n        }\n        this.filterIndex = dropDownList.index;\n        groupLevel = this.levelColl[target.id];\n        if (!this.isImportRules) {\n            rules = this.rule;\n            for (i = 0, len = groupLevel.length; i < len; i++) {\n                rules = this.findGroupByIdx(groupLevel[i], rules, i === 0);\n            }\n            if (Object.keys(rule).length) {\n                rules.rules.push({\n                    'field': rule.field, 'type': rule.type, 'label': rule.label, 'operator': rule.operator, value: rule.value\n                });\n            }\n            else {\n                rules.rules.push({ 'field': '', 'type': '', 'label': '', 'operator': '', 'value': [] });\n            }\n        }\n        if (Object.keys(rule).length) {\n            this.changeRule(rule, {\n                element: dropDownList.element,\n                itemData: this.columns[this.filterIndex]\n            });\n        }\n    };\n    QueryBuilder.prototype.validateFields = function () {\n        var keys = Object.keys(this.validationRules);\n        var i;\n        var len = keys.length;\n        var element;\n        var groupElem;\n        var rules;\n        var ruleElem;\n        var index;\n        for (i = 0; i < len; i++) {\n            element = this.element.querySelector('[name=' + keys[i] + ' ]');\n            if (element) {\n                groupElem = closest(element, '.e-group-container');\n                rules = this.getGroup(groupElem);\n                ruleElem = closest(element, '.e-rule-container');\n                index = 0;\n                while (ruleElem && ruleElem.previousElementSibling !== null) {\n                    ruleElem = ruleElem.previousElementSibling;\n                    index++;\n                }\n                if (closest(element, '.e-rule-filter')) {\n                    if (!rules.rules[index].field) {\n                        addClass([element.parentElement], 'e-error');\n                    }\n                    else {\n                        removeClass([element.parentElement], 'e-error');\n                    }\n                }\n                if (closest(element, '.e-rule-operator')) {\n                    if (!rules.rules[index].operator) {\n                        addClass([element.parentElement], 'e-error');\n                    }\n                    else {\n                        removeClass([element.parentElement], 'e-error');\n                    }\n                }\n                if (closest(element, '.e-rule-value')) {\n                    if (!rules.rules[index].value) {\n                        addClass([element.parentElement], 'e-error');\n                    }\n                    else {\n                        removeClass([element.parentElement], 'e-error');\n                    }\n                }\n            }\n        }\n    };\n    QueryBuilder.prototype.groupTemplate = function () {\n        var groupElem;\n        var grpBodyElem;\n        var groupHdrElem;\n        var rulesElem;\n        var glueElem;\n        var inputElem;\n        var labelElem;\n        var grpActElem;\n        var groupBtn;\n        groupElem = this.createElement('div', { attrs: { class: 'e-group-container' } });\n        groupHdrElem = this.createElement('div', { attrs: { class: 'e-group-header' } });\n        grpBodyElem = this.createElement('div', { attrs: { class: 'e-group-body' } });\n        rulesElem = this.createElement('div', { attrs: { class: 'e-rule-list' } });\n        groupElem.appendChild(groupHdrElem);\n        grpBodyElem.appendChild(rulesElem);\n        groupElem.appendChild(grpBodyElem);\n        // create button group in OR and AND process\n        glueElem = this.createElement('div', { attrs: { class: 'e-btn-group' } });\n        inputElem = this.createElement('input', { attrs: { type: 'radio', class: 'e-btngroup-and', value: 'AND' } });\n        inputElem.setAttribute('checked', 'true');\n        glueElem.appendChild(inputElem);\n        labelElem = this.createElement('label', { attrs: { class: 'e-btn e-btngroup-and-lbl' }, innerHTML: 'AND' });\n        glueElem.appendChild(labelElem);\n        inputElem = this.createElement('input', { attrs: { type: 'radio', class: 'e-btngroup-or', value: 'OR' } });\n        glueElem.appendChild(inputElem);\n        labelElem = this.createElement('label', { attrs: { class: 'e-btn e-btngroup-or-lbl' }, innerHTML: 'OR' });\n        glueElem.appendChild(labelElem);\n        groupHdrElem.appendChild(glueElem);\n        grpActElem = this.createElement('div', { attrs: { class: 'e-group-action' } });\n        groupBtn = this.createElement('button', { attrs: { type: 'button', class: 'e-add-btn' } });\n        grpActElem.appendChild(groupBtn);\n        groupHdrElem.appendChild(grpActElem);\n        return groupElem;\n    };\n    QueryBuilder.prototype.ruleTemplate = function () {\n        var ruleElem;\n        var filterElem;\n        var tempElem;\n        var delBtnElem;\n        var fieldElem;\n        ruleElem = this.createElement('div');\n        fieldElem = this.createElement('div', { attrs: { class: 'e-rule-field' } });\n        tempElem = this.createElement('div', { attrs: { class: 'e-rule-filter' } });\n        filterElem = this.createElement('input', { attrs: { type: 'text', class: 'e-filter-input' } });\n        tempElem.appendChild(filterElem);\n        fieldElem.appendChild(tempElem);\n        tempElem = this.createElement('div', { attrs: { class: 'e-rule-operator' } });\n        fieldElem.appendChild(tempElem);\n        tempElem = this.createElement('div', { attrs: { class: 'e-rule-value' } });\n        fieldElem.appendChild(tempElem);\n        ruleElem.appendChild(fieldElem);\n        delBtnElem = this.createElement('button', { attrs: { class: 'e-removerule e-rule-delete e-control e-btn e-small' } });\n        fieldElem.appendChild(delBtnElem);\n        return ruleElem;\n    };\n    QueryBuilder.prototype.addGroupElement = function (isGroup, target, condition, isBtnClick) {\n        if (this.element.querySelectorAll('.e-group-container').length >= this.maxGroupCount) {\n            return;\n        }\n        var dltGroupBtn;\n        var groupElem = this.groupElem.cloneNode(true);\n        groupElem.setAttribute('id', this.element.id + '_e_group' + this.groupIdCounter);\n        this.groupIdCounter++;\n        var andInpElem = groupElem.querySelector('.e-btngroup-and');\n        var orInpElem = groupElem.querySelector('.e-btngroup-or');\n        var andLblElem = groupElem.querySelector('.e-btngroup-and-lbl');\n        var orLblElem = groupElem.querySelector('.e-btngroup-or-lbl');\n        andInpElem.setAttribute('id', this.element.id + '_and' + this.btnGroupId);\n        orInpElem.setAttribute('id', this.element.id + '_or' + this.btnGroupId);\n        andInpElem.setAttribute('name', this.element.id + '_and' + this.btnGroupId);\n        orInpElem.setAttribute('name', this.element.id + '_and' + this.btnGroupId);\n        andLblElem.setAttribute('for', this.element.id + '_and' + this.btnGroupId);\n        orLblElem.setAttribute('for', this.element.id + '_or' + this.btnGroupId);\n        this.btnGroupId++;\n        if (isGroup) {\n            dltGroupBtn = this.createElement('button', { attrs: { class: 'e-deletegroup' } });\n            var button = new Button({ iconCss: 'e-icons e-delete-icon', cssClass: 'e-small e-round' });\n            button.appendTo(dltGroupBtn);\n            var tooltip = new Tooltip({ content: this.l10n.getConstant('DeleteGroup') });\n            tooltip.appendTo(dltGroupBtn);\n            rippleEffect(dltGroupBtn, { selector: '.deletegroup' });\n            groupElem.querySelector('.e-group-action').appendChild(dltGroupBtn);\n            var ruleList = target.querySelector('.e-rule-list');\n            var grpLen = target.querySelectorAll('.e-group-container').length;\n            ruleList.appendChild(groupElem);\n            var level = this.levelColl[target.id].slice(0);\n            level.push(grpLen);\n            this.levelColl[groupElem.id] = level;\n            if (!this.isImportRules) {\n                this.addGroups([], target.id);\n                if (isBtnClick) {\n                    this.addRuleElement(groupElem, {});\n                }\n            }\n        }\n        else {\n            target.appendChild(groupElem);\n            this.levelColl[groupElem.id] = [0];\n        }\n        groupElem.querySelector('.e-btngroup-and').setAttribute('checked', 'true');\n        if (condition === 'or') {\n            groupElem.querySelector('.e-btngroup-or').setAttribute('checked', 'true');\n        }\n        var groupBtn = groupElem.querySelector('.e-add-btn');\n        var btnObj = new DropDownButton({\n            items: this.items,\n            cssClass: 'e-round e-small e-caret-hide e-addrulegroup',\n            iconCss: 'e-icons e-add-icon',\n            beforeOpen: this.selectBtn.bind(this, groupBtn),\n            select: this.selectBtn.bind(this, groupBtn)\n        });\n        btnObj.appendTo(groupBtn);\n        rippleEffect(groupBtn, { selector: '.e-round' });\n    };\n    QueryBuilder.prototype.notifyChange = function (value, element) {\n        var tempColl = closest(element, '.e-rule-value').querySelectorAll('.e-template');\n        var valueColl = [];\n        for (var i = 0, iLen = tempColl.length; i < iLen; i++) {\n            if (tempColl[i].nextElementSibling) {\n                if (tempColl[i].nextElementSibling.className.indexOf('e-check') > -1) {\n                    valueColl.push(tempColl[i].textContent);\n                }\n            }\n        }\n        this.updateRules(element, (tempColl.length > 1) ? valueColl : value);\n    };\n    QueryBuilder.prototype.changeValue = function (i, args) {\n        var eventsArgs;\n        var element;\n        if (args.event) {\n            element = args.event.target;\n        }\n        else {\n            var multiSelectArgs = args;\n            element = multiSelectArgs.element;\n        }\n        if (element.className.indexOf('e-day') > -1) {\n            var calenderArgs = args;\n            element = calenderArgs.element;\n        }\n        var groupElem = closest(element, '.e-group-container');\n        var dateElement = args;\n        if (dateElement.element && dateElement.element.className.indexOf('e-datepicker') > -1) {\n            element = dateElement.element;\n        }\n        var value;\n        if (element.className.indexOf('e-radio') > -1) {\n            value = getComponent(element, 'radio').label;\n        }\n        else if (element.className.indexOf('e-multiselect') > -1) {\n            value = getComponent(element, 'multiselect').value;\n        }\n        else {\n            value = args.value;\n        }\n        eventsArgs = { groupID: groupElem.id, filterID: element.id, value: value, cancel: false };\n        this.trigger('beforeValueChange', eventsArgs);\n        this.updateRules(element, value, i);\n        eventsArgs = { groupID: groupElem.id, filterID: element.id, value: value, cancel: false };\n        this.trigger('valueChanged', eventsArgs);\n    };\n    QueryBuilder.prototype.changeField = function (args) {\n        var groupElem = closest(args.element, '.e-group-container');\n        var rules = this.getGroup(groupElem);\n        var ruleElem = closest(args.element, '.e-rule-container');\n        var index = 0;\n        while (ruleElem && ruleElem.previousElementSibling !== null) {\n            ruleElem = ruleElem.previousElementSibling;\n            index++;\n        }\n        this.changeRule(rules.rules[index], args);\n    };\n    QueryBuilder.prototype.changeRule = function (rule, args) {\n        if (!args.itemData) {\n            return;\n        }\n        var tempRule = {};\n        var operatorList;\n        var filterElem;\n        var operatorElem;\n        var oprElem;\n        filterElem = closest(args.element, '.e-rule-filter');\n        operatorElem = closest(args.element, '.e-rule-operator');\n        var dropDownObj = getComponent(args.element, 'dropdownlist');\n        var element = closest(args.element, '.e-group-container');\n        if (filterElem) {\n            var eventsArgs = {\n                groupID: element.id, filterID: args.element.id, selectedItem: args.item, cancel: false\n            };\n            this.trigger('beforeFieldChange', eventsArgs);\n            tempRule.type = this.columns[dropDownObj.index].type;\n        }\n        if (operatorElem) {\n            var eventsArgs = {\n                groupID: element.id, filterID: args.element.id, selectedItem: args.item, cancel: false\n            };\n            this.trigger('beforeFieldChange', eventsArgs);\n            tempRule.operator = args.itemData.value;\n            var filtElem = document.getElementById(args.element.id.replace('operatorkey', 'filterkey'));\n            var filtObj = getComponent(filtElem, 'dropdownlist');\n            if (!this.columns[filtObj.index].template) {\n                if (tempRule.operator.toLowerCase().indexOf('between') > -1 || (tempRule.operator.toLowerCase().indexOf('in') > -1\n                    && tempRule.operator.toLowerCase().indexOf('contains') < 0)) {\n                    filterElem = operatorElem.previousElementSibling;\n                    tempRule.type = rule.type;\n                }\n                if (args.previousItemData) {\n                    var prevValue = args.previousItemData.value.toLowerCase();\n                    if (prevValue.indexOf('between') > -1 || (prevValue.indexOf('in') > -1 && prevValue.indexOf('contains') < 0)) {\n                        filterElem = operatorElem.previousElementSibling;\n                        tempRule.type = rule.type;\n                    }\n                }\n            }\n        }\n        if (filterElem) {\n            operatorElem = filterElem.nextElementSibling;\n            if (operatorElem.childElementCount) {\n                this.renderValues(operatorElem, args.itemData, args.previousItemData, true, rule, tempRule);\n            }\n            else {\n                var ruleId = closest(operatorElem, '.e-rule-container').id;\n                oprElem = this.createElement('input', { attrs: { type: 'text', id: ruleId + '_operatorkey' } });\n                operatorElem.appendChild(oprElem);\n                if (this.columns[dropDownObj.index].operators) {\n                    operatorList = this.columns[dropDownObj.index].operators;\n                }\n                else if (args.itemData) {\n                    operatorList = this.customOperators[this.columns[dropDownObj.index].type + 'Operator'];\n                }\n                var height = (this.element.className.indexOf('e-device') > -1) ? '250px' : '200px';\n                var dropDownList = new DropDownList({\n                    dataSource: operatorList,\n                    fields: { text: 'key', value: 'value' },\n                    placeholder: this.l10n.getConstant('SelectOperator'),\n                    popupHeight: ((operatorList.length > 5) ? height : 'auto'),\n                    change: this.changeField.bind(this),\n                    index: 0,\n                    value: rule ? this.l10n.getConstant(this.operatorValue[rule.operator]) : null\n                });\n                dropDownList.appendTo('#' + ruleId + '_operatorkey');\n                if (this.allowValidation) {\n                    oprElem.setAttribute('name', ruleId + 'operator');\n                    addClass([oprElem], 'e-error');\n                    this.validationRules[ruleId + 'operator'] = { required: true };\n                }\n                tempRule.operator = rule ? rule.operator : '';\n                if (this.isImportRules) {\n                    dropDownList.value = rule.operator;\n                    dropDownList.dataBind();\n                    tempRule.type = this.columns[dropDownObj.index].type;\n                    tempRule.operator = rule.operator;\n                }\n                this.renderValues(operatorElem, this.columns[dropDownObj.index], args.previousItemData, false, rule, tempRule);\n            }\n        }\n        if (!this.isImportRules) {\n            this.updateRules(args.element, args.item);\n        }\n    };\n    // tslint:disable-next-line:no-any\n    QueryBuilder.prototype.destroyControls = function (target) {\n        var inputElement;\n        inputElement = target.nextElementSibling.querySelectorAll('input.e-control');\n        var divElement;\n        divElement = target.nextElementSibling.querySelectorAll('div.e-control');\n        var columns = this.columns;\n        for (var i = 0, len = inputElement.length; i < len; i++) {\n            if (inputElement[i].classList.contains('e-textbox')) {\n                getComponent(inputElement[i], 'textbox').destroy();\n                detach(target.nextElementSibling.querySelector('input#' + inputElement[i].id));\n            }\n            else if (inputElement[i].classList.contains('e-dropdownlist')) {\n                getComponent(inputElement[i], 'dropdownlist').destroy();\n            }\n            else if (inputElement[i].classList.contains('e-radio')) {\n                getComponent(inputElement[i], 'radio').destroy();\n            }\n            else if (inputElement[i].classList.contains('e-numerictextbox')) {\n                getComponent(inputElement[i], 'numerictextbox').destroy();\n                detach(target.nextElementSibling.querySelector('input#' + inputElement[i].id));\n            }\n            else if (inputElement[i].classList.contains('e-datepicker')) {\n                getComponent(inputElement[i], 'datepicker').destroy();\n            }\n            else if (inputElement[i].classList.contains('e-multiselect')) {\n                getComponent(inputElement[i], 'multiselect').destroy();\n            }\n            else if (inputElement[i].className.indexOf('e-template') > -1) {\n                var clsName = inputElement[i].className;\n                for (var j = 0, jLen = columns.length; j < jLen; j++) {\n                    if (columns[j].template && clsName.indexOf(columns[j].field) > -1) {\n                        this.templateDestroy(columns[j], inputElement[i].id);\n                        break;\n                    }\n                }\n            }\n            detach(inputElement[i]);\n        }\n        for (var i = 0, len = divElement.length; i < len; i++) {\n            if (divElement[i].className.indexOf('e-template') > -1) {\n                var clsName = divElement[i].className;\n                for (var j = 0, jLen = columns.length; j < jLen; j++) {\n                    if (columns[j].template && clsName.indexOf(columns[j].field) > -1) {\n                        this.templateDestroy(columns[j], divElement[i].id);\n                        break;\n                    }\n                }\n            }\n            detach(divElement[i]);\n        }\n    };\n    QueryBuilder.prototype.templateDestroy = function (column, elemId) {\n        var temp = column.template.destroy;\n        if (column.template && column.template.destroy) {\n            if (typeof temp === 'string') {\n                temp = getValue(temp, window);\n                temp({ elementId: elemId });\n            }\n            else {\n                column.template.destroy({ elementId: elemId });\n            }\n        }\n    };\n    QueryBuilder.prototype.getDistinctValues = function (dataSource, field) {\n        var original = {};\n        var result = [];\n        for (var i = 0, iLen = dataSource.length; i < iLen; i++) {\n            var value = dataSource[i][field];\n            var data = {};\n            if (!(value in original)) {\n                original[value] = 1;\n                data[field] = value;\n                result.push(data);\n            }\n        }\n        return result;\n    };\n    QueryBuilder.prototype.renderMultiSelect = function (rule, parentId, i, selectedValue) {\n        var ds = this.getDistinctValues(this.dataSource, rule.field);\n        var multiSelectObj = new MultiSelect({\n            dataSource: new DataManager(ds),\n            query: new Query([rule.field]),\n            fields: { text: rule.field, value: rule.field },\n            value: selectedValue,\n            mode: 'CheckBox',\n            width: '100%,',\n            change: this.changeValue.bind(this, i)\n        });\n        multiSelectObj.appendTo('#' + parentId + '_valuekey' + i);\n        addClass([document.getElementById(parentId).querySelector('.e-rule-value')], 'e-rule-multiselect');\n    };\n    QueryBuilder.prototype.processTemplate = function (target, itemData, rule, tempRule) {\n        var tempElements = closest(target, '.e-rule-container').querySelectorAll('.e-template');\n        if (tempElements.length < 2) {\n            if (this.isImportRules) {\n                if (itemData.template && typeof itemData.template.write === 'string') {\n                    getValue(itemData.template.write, window)({ elements: tempElements[0], values: rule.value });\n                }\n                else if (itemData.template && itemData.template.write) {\n                    itemData.template.write({ elements: tempElements[0], values: rule.value });\n                }\n            }\n            else {\n                if (itemData.template && typeof itemData.template.write === 'string') {\n                    getValue(itemData.template.write, window)({ elements: tempElements[0] });\n                }\n                else if (itemData.template && itemData.template.write) {\n                    itemData.template.write({ elements: tempElements[0] });\n                }\n            }\n        }\n        else {\n            if (this.isImportRules) {\n                if (itemData.template && typeof itemData.template.write === 'string') {\n                    getValue(itemData.template.write, window)({ elements: tempElements, values: rule.value });\n                }\n                else if (itemData.template && itemData.template.write) {\n                    itemData.template.write({ elements: tempElements, values: rule.value });\n                }\n            }\n            else {\n                if (itemData.template && typeof itemData.template.write === 'string') {\n                    getValue(itemData.template.write, window)({ elements: tempElements });\n                }\n                else if (itemData.template && itemData.template.write) {\n                    itemData.template.write({ elements: tempElements });\n                }\n            }\n        }\n    };\n    QueryBuilder.prototype.renderControls = function (target, itemData, rule, tempRule) {\n        if (itemData.template) {\n            this.processTemplate(target, itemData, rule, tempRule);\n        }\n        else {\n            var length_1 = (tempRule.type === 'boolean' ||\n                tempRule.operator && tempRule.operator.toLowerCase().indexOf('between') > -1) ? 2 : 1;\n            var parentId = closest(target, '.e-rule-container').id;\n            var ruleValElem = void 0;\n            if (target.className.indexOf('e-rule-operator') > -1 || target.className.indexOf('e-rule-filter') > -1) {\n                ruleValElem = target.parentElement.querySelector('.e-rule-value');\n                if (this.element.className.indexOf('e-device') < 0) {\n                    ruleValElem.style.width = '200px';\n                }\n            }\n            for (var i = 0; i < length_1; i++) {\n                switch (tempRule.type) {\n                    case 'string':\n                        {\n                            var selectedValue = this.isImportRules ? rule.value : '';\n                            if (tempRule.operator === 'in' || tempRule.operator === 'notin') {\n                                var selectedVal = this.isImportRules ? rule.value : [];\n                                this.renderMultiSelect(rule, parentId, i, selectedVal);\n                                if (this.element.className.indexOf('e-device') < 0) {\n                                    ruleValElem.style.width = '300px';\n                                }\n                            }\n                            else {\n                                var inputobj = new TextBox({\n                                    placeholder: 'Value',\n                                    input: this.changeValue.bind(this, i)\n                                });\n                                inputobj.appendTo('#' + parentId + '_valuekey' + i);\n                                inputobj.value = selectedValue;\n                                inputobj.dataBind();\n                                if (this.allowValidation && itemData.validation) {\n                                    inputobj.element.setAttribute('name', parentId + i);\n                                    addClass([inputobj.element], 'e-error');\n                                    this.validationRules[parentId + i] = { required: true };\n                                }\n                            }\n                        }\n                        break;\n                    case 'number':\n                        {\n                            var selectedValue = this.isImportRules ? rule.value : 0;\n                            if (tempRule.operator === 'in' || tempRule.operator === 'notin') {\n                                var selectedVal = this.isImportRules ? rule.value : [];\n                                this.renderMultiSelect(rule, parentId, i, selectedVal);\n                                if (this.element.className.indexOf('e-device') < 0) {\n                                    ruleValElem.style.width = '300px';\n                                }\n                            }\n                            else {\n                                var numeric = new NumericTextBox({\n                                    value: selectedValue,\n                                    format: '#',\n                                    width: '100%',\n                                    change: this.changeValue.bind(this, i)\n                                });\n                                numeric.appendTo('#' + parentId + '_valuekey' + i);\n                                if (this.allowValidation) {\n                                    numeric.element.setAttribute('name', parentId + i);\n                                    addClass([numeric.element], 'e-error');\n                                    this.validationRules[parentId + i] = { required: true };\n                                }\n                            }\n                        }\n                        break;\n                    case 'boolean':\n                        {\n                            var values = itemData.values && itemData.values.length ? itemData.values : ['True', 'False'];\n                            var isCheck = this.isImportRules ? Boolean(rule.value) : true;\n                            var radiobutton = void 0;\n                            radiobutton = new RadioButton({\n                                label: values[i],\n                                name: parentId + 'default',\n                                checked: isCheck,\n                                change: this.changeValue.bind(this, i)\n                            });\n                            radiobutton.appendTo('#' + parentId + '_valuekey' + i);\n                        }\n                        break;\n                    case 'date':\n                        {\n                            var selectedValue = this.isImportRules ? new Date(rule.value) : new Date();\n                            var datepick = new DatePicker({\n                                value: selectedValue,\n                                format: 'dd-MMM-yy',\n                                change: this.changeValue.bind(this, i)\n                            });\n                            datepick.appendTo('#' + parentId + '_valuekey' + i);\n                            if (this.allowValidation) {\n                                datepick.element.setAttribute('name', parentId + i);\n                                this.validationRules[parentId + i] = { required: true };\n                            }\n                        }\n                        break;\n                }\n            }\n        }\n    };\n    QueryBuilder.prototype.renderValues = function (target, itemData, prevItemData, isRender, rule, tempRule) {\n        if (isRender) {\n            var ddlObj = getComponent(target.querySelector('input'), 'dropdownlist');\n            if (itemData.operators) {\n                ddlObj.dataSource = itemData.operators;\n                ddlObj.index = ddlObj.index !== 0 ? 0 : 1;\n                ddlObj.dataBind();\n            }\n            else if (itemData.type) {\n                ddlObj.dataSource = this.customOperators[itemData.type + 'Operator'];\n                ddlObj.index = ddlObj.index !== 0 ? 0 : 1;\n                ddlObj.dataBind();\n            }\n        }\n        var parentId = closest(target, '.e-rule-container').id;\n        if (prevItemData && prevItemData.template) {\n            this.templateDestroy(prevItemData, parentId + '_valuekey0');\n            detach(target.nextElementSibling.querySelector('#' + parentId + '_valuekey0'));\n        }\n        if (isRender) {\n            this.destroyControls(target);\n        }\n        if (itemData.template) {\n            var valElem = void 0;\n            if (itemData.template && typeof itemData.template.create === 'string') {\n                valElem = getValue(itemData.template.create, window)();\n            }\n            else if (itemData.template && itemData.template.create) {\n                valElem = itemData.template.create();\n            }\n            if (valElem instanceof Element) {\n                valElem.id = parentId + '_valuekey0';\n                addClass([valElem], 'e-template');\n                addClass([valElem], 'e-' + itemData.field);\n                target.nextElementSibling.appendChild(valElem);\n            }\n            else {\n                addClass(valElem, 'e-template');\n                for (var i = 0, iLen = valElem.length; i < iLen; i++) {\n                    valElem[i].id = parentId + '_valuekey' + i;\n                    target.nextElementSibling.appendChild(valElem[i]);\n                }\n            }\n            if (this.element.className.indexOf('e-device') < 0) {\n                var parentElem = target.parentElement.querySelector('.e-rule-value');\n                parentElem.style.width = '200px';\n            }\n        }\n        else {\n            if (tempRule.type === 'boolean' || tempRule.operator && tempRule.operator.toLowerCase().indexOf('between') > -1) {\n                for (var i = 0; i < 2; i++) {\n                    var valElem = void 0;\n                    valElem = this.createElement('input', { attrs: { type: 'text', id: parentId + '_valuekey' + i } });\n                    target.nextElementSibling.appendChild(valElem);\n                }\n            }\n            else {\n                var valElem = this.createElement('input', { attrs: { type: 'text', id: parentId + '_valuekey0' } });\n                target.nextElementSibling.appendChild(valElem);\n            }\n        }\n        this.renderControls(target, itemData, rule, tempRule);\n    };\n    QueryBuilder.prototype.updateValues = function (element, rule) {\n        var controlName = element.className.split(' e-')[1];\n        var i = parseInt(element.id.slice(-1), 2);\n        switch (controlName) {\n            case 'textbox':\n                rule.value = getComponent(element, controlName).value;\n                break;\n            case 'dropdownlist':\n                rule.value = getComponent(element, controlName).value;\n                break;\n            case 'radio':\n                rule.value = getComponent(element, controlName).value;\n                break;\n            case 'numerictextbox':\n                if (rule.operator.indexOf('between') > -1) {\n                    rule.value[i] = getComponent(element, controlName).value;\n                }\n                else {\n                    rule.value = getComponent(element, controlName).value;\n                }\n                break;\n            case 'datepicker':\n                var format = { type: 'dateTime', format: 'dd-MMM-yy' };\n                if (rule.operator.indexOf('between') > -1) {\n                    rule.value[i] = getComponent(element, controlName).value;\n                }\n                else {\n                    rule.value = this.intl.formatDate(getComponent(element, controlName).value, format);\n                }\n                break;\n        }\n    };\n    QueryBuilder.prototype.updateRules = function (target, selectedValue, i) {\n        var groupElem = closest(target, '.e-group-container');\n        var rule = this.getGroup(groupElem);\n        var ruleElem = closest(target, '.e-rule-container');\n        var index = 0;\n        var dropDownObj;\n        var eventsArgs;\n        while (ruleElem && ruleElem.previousElementSibling !== null) {\n            ruleElem = ruleElem.previousElementSibling;\n            index++;\n        }\n        ruleElem = closest(target, '.e-rule-container');\n        if (closest(target, '.e-rule-filter')) {\n            dropDownObj = getComponent(target, 'dropdownlist');\n            rule.rules[index].field = this.columns[dropDownObj.index].field;\n            rule.rules[index].type = this.columns[dropDownObj.index].type;\n            rule.rules[index].label = this.columns[dropDownObj.index].label;\n            var ruleElement = closest(target, '.e-rule-filter');\n            var element = ruleElement.nextElementSibling.querySelector('input.e-control');\n            var operator = getComponent(element, 'dropdownlist').value;\n            rule.rules[index].operator = operator;\n            element = ruleElement.nextElementSibling.nextElementSibling.querySelector('input.e-control');\n            if (!element) {\n                element = ruleElement.nextElementSibling.nextElementSibling.querySelector('div.e-control');\n            }\n            eventsArgs = { groupID: groupElem.id, filterID: target, selectedItem: selectedValue, cancel: false };\n            this.trigger('fieldChanged', eventsArgs);\n            this.updateValues(element, rule.rules[index]);\n            if (!rule.rules[index].field) {\n                addClass([target.parentElement], 'e-error');\n            }\n            else {\n                removeClass([target.parentElement], 'e-error');\n            }\n        }\n        else if (closest(target, '.e-rule-operator')) {\n            dropDownObj = getComponent(target, 'dropdownlist');\n            rule.rules[index].operator = dropDownObj.value;\n            var inputElem = void 0;\n            inputElem = ruleElem.querySelectorAll('.e-rule-value input.e-control');\n            rule.rules[index].value = [];\n            eventsArgs = { groupID: groupElem.id, filterID: target, selectedItem: selectedValue, cancel: false };\n            this.trigger('operatorChanged', eventsArgs);\n            if (!rule.rules[index].operator) {\n                addClass([target.parentElement], 'e-error');\n            }\n            else {\n                removeClass([target.parentElement], 'e-error');\n            }\n            for (var i_1 = 0; i_1 < inputElem.length; i_1++) {\n                this.updateValues(inputElem[i_1], rule.rules[index]);\n            }\n        }\n        else if (closest(target, '.e-rule-value')) {\n            if (selectedValue !== null) {\n                if (target.className.indexOf('e-template') > -1) {\n                    var oper = rule.rules[index].operator.toLowerCase();\n                    if (selectedValue instanceof Array) {\n                        if ((oper.indexOf('in') > -1 && oper.indexOf('contains') < 0) || oper.indexOf('between') > -1) {\n                            rule.rules[index].value = selectedValue;\n                        }\n                        else {\n                            rule.rules[index].value = selectedValue[0];\n                        }\n                    }\n                    else {\n                        rule.rules[index].value = selectedValue;\n                    }\n                    eventsArgs = { groupID: groupElem.id, filterID: target, selectedItem: selectedValue, cancel: false };\n                    this.trigger('valueChanged', eventsArgs);\n                }\n                else if (target.className.indexOf('e-spin') > -1 || target.className.indexOf('e-numeric') > -1) {\n                    if ((rule.rules[index].operator.indexOf('between') > -1)\n                        || (rule.rules[index].operator.indexOf('in') > -1 && rule.rules[index].operator.indexOf('contains') < 0)) {\n                        rule.rules[index].value[i] = selectedValue;\n                    }\n                    else {\n                        rule.rules[index].value = selectedValue;\n                    }\n                }\n                else if (target.className.indexOf('e-radio') > -1) {\n                    rule.rules[index].value = selectedValue;\n                }\n                else if (target.className.indexOf('e-multiselect') > -1) {\n                    rule.rules[index].value = selectedValue;\n                }\n                else if (target.className.indexOf('e-textbox') > -1) {\n                    rule.rules[index].value = selectedValue;\n                }\n                else if (target.className.indexOf('e-datepicker') > -1) {\n                    var ddlInst = getInstance(ruleElem.querySelector('.e-rule-filter input'), DropDownList);\n                    var format = { type: 'dateTime', format: this.columns[ddlInst.index].format || 'dd/MM/yyy' };\n                    if (format.type) {\n                        if ((rule.rules[index].operator.indexOf('between') > -1) || (rule.rules[index].operator.indexOf('in') > -1\n                            && rule.rules[index].operator.indexOf('contains') < 0)) {\n                            rule.rules[index].value[i] = this.intl.formatDate(selectedValue, format);\n                        }\n                        else {\n                            rule.rules[index].value = this.intl.formatDate(selectedValue, format);\n                        }\n                    }\n                }\n                if (!rule.rules[index].value) {\n                    addClass([target.parentElement], 'e-error');\n                }\n                else {\n                    removeClass([target.parentElement], 'e-error');\n                }\n            }\n        }\n    };\n    QueryBuilder.prototype.findGroupByIdx = function (groupIdx, rule, isRoot) {\n        var ruleColl = rule.rules;\n        if (!isRoot && ruleColl[groupIdx]) {\n            rule = ruleColl[groupIdx];\n            if (rule.rules) {\n                return rule;\n            }\n            else {\n                for (var j = groupIdx + 1, jLen = ruleColl.length; j < jLen; j++) {\n                    rule = ruleColl[j];\n                    if (rule.rules) {\n                        return rule;\n                    }\n                }\n            }\n        }\n        return rule;\n    };\n    /**\n     * Removes the component from the DOM and detaches all its related event handlers.\n     * Also it maintains the initial input element from the DOM.\n     * @method destroy\n     * @return {void}\n     */\n    QueryBuilder.prototype.destroy = function () {\n        var element;\n        var i;\n        var len;\n        element = this.element.querySelectorAll('.e-addrulegroup');\n        len = element.length;\n        for (i = 0; i < len; i++) {\n            getComponent(element[i], 'dropdown-btn').destroy();\n            detach(element[i]);\n        }\n        this.reset();\n        this.unWireEvents();\n    };\n    /**\n     * Adds single or multiple rules.\n     * @returns void.\n     */\n    QueryBuilder.prototype.addRules = function (rule, groupID) {\n        var args = { groupID: groupID, filterID: '' };\n        this.trigger('ruleDelete', args);\n        for (var i = 0, len = rule.length; i < len; i++) {\n            this.addRuleElement(document.getElementById(groupID), rule[i]);\n        }\n    };\n    /**\n     * Adds single or multiple groups, which contains the collection of rules.\n     * @returns void.\n     */\n    QueryBuilder.prototype.addGroups = function (groups, groupID) {\n        var groupElem = document.getElementById(groupID);\n        var rule = this.getGroup(groupElem);\n        var grouplen = groups.length;\n        var args = { groupID: groupID };\n        this.trigger('ruleDelete', args);\n        if (grouplen) {\n            for (var i = 0, len = groups.length; i < len; i++) {\n                this.importRules(groups[i], groupElem);\n            }\n        }\n        else {\n            rule.rules.push({ 'condition': 'and', rules: [] });\n        }\n    };\n    QueryBuilder.prototype.initWrapper = function () {\n        if (this.cssClass) {\n            addClass([this.element], this.cssClass);\n        }\n        if (this.enableRtl) {\n            addClass([this.element], 'e-rtl');\n        }\n        if (this.width) {\n            this.element.style.width = this.width;\n        }\n        if (this.height) {\n            this.element.style.height = this.height;\n        }\n        if (this.rule.rules.length) {\n            this.isImportRules = true;\n        }\n        else {\n            this.addGroupElement(false, this.element);\n        }\n        if (Browser.isDevice || this.displayMode === 'Vertical') {\n            if (Browser.isDevice) {\n                this.element.style.width = '100%';\n                this.element.classList.add('e-device');\n            }\n            removeClass(document.querySelectorAll('.e-rule-container'), 'e-horizontal-mode');\n            addClass(document.querySelectorAll('.e-rule-container'), 'e-vertical-mode');\n            this.displayMode = 'Vertical';\n        }\n        else {\n            this.displayMode = 'Horizontal';\n        }\n        if (this.isImportRules && this.summaryView) {\n            this.renderSummary();\n        }\n        else {\n            if (this.columns.length && this.isImportRules) {\n                this.addGroupElement(false, this.element, this.rule.condition);\n                var mRules = extend({}, this.rule, {}, true);\n                this.setGroupRules(mRules);\n            }\n            else if (this.columns.length) {\n                this.addRuleElement(this.element.querySelector('.e-group-container'), {});\n            }\n            var buttons = document.querySelectorAll('label.e-btn');\n            var button = void 0;\n            for (var i = 0; i < buttons.length; i++) {\n                button = buttons.item(i);\n                rippleEffect(button, { selector: '.e-btn' });\n            }\n        }\n    };\n    QueryBuilder.prototype.renderSummary = function () {\n        var contentElem = this.createElement('div', { attrs: { class: 'e-summary-content',\n                id: this.element.id + '_summary_content' } });\n        var textElem = this.createElement('textarea', { attrs: { class: 'e-summary-text', readonly: 'true' } });\n        var editElem = this.createElement('button', { attrs: { class: 'e-edit-rule e-control e-btn e-small' } });\n        contentElem.appendChild(textElem);\n        textElem.textContent = this.getSqlFromRules(this.rule);\n        editElem.textContent = this.l10n.getConstant('Edit');\n        contentElem.appendChild(editElem);\n        this.element.appendChild(contentElem);\n    };\n    QueryBuilder.prototype.renderSummaryCollapse = function () {\n        var collapseElem = this.createElement('button', { attrs: {\n                class: 'e-collapse-rule e-control e-btn e-small'\n            } });\n        collapseElem.appendChild(this.createElement('span', { attrs: { class: 'e-btn-icon e-icons e-collapse-icon' } }));\n        this.element.querySelector('.e-group-header').appendChild(collapseElem);\n    };\n    QueryBuilder.prototype.onPropertyChanged = function (newProp, oldProp) {\n        var properties = Object.keys(newProp);\n        for (var _i = 0, properties_1 = properties; _i < properties_1.length; _i++) {\n            var prop = properties_1[_i];\n            switch (prop) {\n                case 'summaryView':\n                    var groupElem = this.element.querySelector('.e-group-container');\n                    var summaryElem = this.element.querySelector('.e-summary-content');\n                    if (newProp.summaryView) {\n                        groupElem.style.display = 'none';\n                        if (this.element.querySelectorAll('.e-summary-content').length < 1) {\n                            this.renderSummary();\n                            summaryElem = this.element.querySelector('.e-summary-content');\n                        }\n                        else {\n                            this.element.querySelector('.e-summary-text').textContent = this.getSqlFromRules(this.rule);\n                        }\n                        summaryElem.style.display = 'block';\n                    }\n                    else {\n                        if (groupElem.querySelectorAll('.e-collapse-rule').length > -1) {\n                            this.renderSummaryCollapse();\n                        }\n                        groupElem.style.display = 'block';\n                        summaryElem.style.display = 'none';\n                    }\n                    break;\n                case 'displayMode':\n                    if (newProp.displayMode === 'Horizontal') {\n                        addClass(this.element.querySelectorAll('.e-rule-container'), 'e-horizontal-mode');\n                        removeClass(this.element.querySelectorAll('.e-rule-container'), 'e-vertical-mode');\n                    }\n                    else {\n                        addClass(this.element.querySelectorAll('.e-rule-container'), 'e-vertical-mode');\n                        removeClass(this.element.querySelectorAll('.e-rule-container'), 'e-horizontal-mode');\n                    }\n                    break;\n                case 'showButtons':\n                    if (newProp.showButtons.ruleDelete) {\n                        removeClass(this.element.querySelectorAll('e-rule-delete'), 'e-button-hide');\n                    }\n                    else {\n                        addClass(this.element.querySelectorAll('e-rule-delete'), 'e-button-hide');\n                    }\n                    if (newProp.showButtons.groupDelete) {\n                        removeClass(this.element.querySelectorAll('e-deletegroup'), 'e-button-hide');\n                    }\n                    else {\n                        addClass(this.element.querySelectorAll('e-deletegroup'), 'e-button-hide');\n                    }\n                    break;\n                case 'cssClass':\n                    if (oldProp.cssClass) {\n                        removeClass([this.element], oldProp.cssClass.split(' '));\n                    }\n                    if (newProp.cssClass) {\n                        addClass([this.element], newProp.cssClass.split(' '));\n                    }\n                    break;\n                case 'enableRtl':\n                    if (newProp.enableRtl) {\n                        this.element.classList.add('e-rtl');\n                    }\n                    else {\n                        this.element.classList.remove('e-rtl');\n                    }\n                    break;\n                case 'enablePersistence':\n                    this.enablePersistence = newProp.enablePersistence;\n                    break;\n                case 'dataSource':\n                    this.dataSource = newProp.dataSource;\n                    break;\n                case 'columns':\n                    this.columns = newProp.columns;\n                    if (this.sortDirection.toLowerCase() === 'ascending') {\n                        this.columns = new DataManager(this.columns).executeLocal(new Query().sortBy('field'));\n                    }\n                    else if (this.sortDirection.toLowerCase() === 'descending') {\n                        this.columns = new DataManager(this.columns).executeLocal(new Query().sortByDesc('field'));\n                    }\n                    break;\n                case 'sortDirection':\n                    this.sortDirection = newProp.sortDirection;\n                    break;\n                case 'maxGroupCount':\n                    this.maxGroupCount = newProp.maxGroupCount;\n                    break;\n                case 'height':\n                    this.height = newProp.height;\n                    this.element.style.height = this.height;\n                    break;\n                case 'rules':\n                    this.rule = newProp.rule;\n                    break;\n                case 'width':\n                    this.width = newProp.width;\n                    this.element.style.width = this.width;\n                    break;\n                case 'locale':\n                    this.locale = newProp.locale;\n                    break;\n            }\n        }\n    };\n    QueryBuilder.prototype.preRender = function () {\n        this.defaultLocale = {\n            StartsWith: 'Starts With',\n            EndsWith: 'Ends With',\n            Contains: 'Contains',\n            Equal: 'Equal',\n            NotEqual: 'Not Equal',\n            LessThan: 'Less Than',\n            LessThanOrEqual: 'Less Than Or Equal',\n            GreaterThan: 'Greater Than',\n            GreaterThanOrEqual: 'Greater Than Or Equal',\n            Between: 'Between',\n            NotBetween: 'Not Between',\n            Empty: 'Empty',\n            NotEmpty: 'Not Empty',\n            In: 'In',\n            NotIn: 'Not In',\n            NotContains: 'Not Contains',\n            Remove: 'REMOVE',\n            SelectField: 'Select a field',\n            SelectOperator: 'Select operator',\n            DeleteRule: 'Remove this condition',\n            DeleteGroup: 'Delete group',\n            AddGroup: 'Add Group',\n            AddCondition: 'Add Condition',\n            Edit: 'EDIT'\n        };\n        this.l10n = new L10n('querybuilder', this.defaultLocale, this.locale);\n        this.customOperators = {\n            stringOperator: [\n                { value: 'startswith', key: this.l10n.getConstant('StartsWith') },\n                { value: 'endswith', key: this.l10n.getConstant('EndsWith') },\n                { value: 'contains', key: this.l10n.getConstant('Contains') },\n                { value: 'equal', key: this.l10n.getConstant('Equal') },\n                { value: 'notequal', key: this.l10n.getConstant('NotEqual') },\n                { value: 'in', key: this.l10n.getConstant('In') },\n                { value: 'notin', key: this.l10n.getConstant('NotIn') }\n            ],\n            dateOperator: [\n                { value: 'equal', key: this.l10n.getConstant('Equal') },\n                { value: 'greaterthan', key: this.l10n.getConstant('GreaterThan') },\n                { value: 'greaterthanorequal', key: this.l10n.getConstant('GreaterThanOrEqual') },\n                { value: 'lessthan', key: this.l10n.getConstant('LessThan') },\n                { value: 'lessthanorequal', key: this.l10n.getConstant('LessThanOrEqual') },\n                { value: 'notequal', key: this.l10n.getConstant('NotEqual') }\n            ],\n            booleanOperator: [\n                { value: 'equal', key: this.l10n.getConstant('Equal') },\n                { value: 'notequal', key: this.l10n.getConstant('NotEqual') }\n            ],\n            numberOperator: [\n                { value: 'equal', key: this.l10n.getConstant('Equal') },\n                { value: 'greaterthanorequal', key: this.l10n.getConstant('GreaterThanOrEqual') },\n                { value: 'greaterthan', key: this.l10n.getConstant('GreaterThan') },\n                { value: 'between', key: this.l10n.getConstant('Between') },\n                { value: 'lessthan', key: this.l10n.getConstant('LessThan') },\n                { value: 'notbetween', key: this.l10n.getConstant('NotBetween') },\n                { value: 'lessthanorequal', key: this.l10n.getConstant('LessThanOrEqual') },\n                { value: 'notequal', key: this.l10n.getConstant('NotEqual') },\n                { value: 'in', key: this.l10n.getConstant('In') },\n                { value: 'notin', key: this.l10n.getConstant('NotIn') }\n            ],\n        };\n    };\n    QueryBuilder.prototype.render = function () {\n        this.levelColl = {};\n        this.items = [\n            {\n                text: this.l10n.getConstant('AddGroup'),\n                iconCss: 'e-icons e-add-icon e-addgroup'\n            },\n            {\n                text: this.l10n.getConstant('AddCondition'),\n                iconCss: 'e-icons e-add-icon e-addrule',\n            }\n        ];\n        this.ruleElem = this.ruleTemplate();\n        this.groupElem = this.groupTemplate();\n        this.initWrapper();\n        this.initialize();\n        this.wireEvents();\n    };\n    QueryBuilder.prototype.wireEvents = function () {\n        var wrapper = this.getWrapper();\n        EventHandler.add(wrapper, 'click', this.clickEventHandler, this);\n    };\n    QueryBuilder.prototype.unWireEvents = function () {\n        var wrapper = this.getWrapper();\n        EventHandler.remove(wrapper, 'click', this.clickEventHandler);\n    };\n    QueryBuilder.prototype.getGroup = function (target, isParent) {\n        var groupLevel = this.levelColl[target.id];\n        var len = isParent ? groupLevel.length - 1 : groupLevel.length;\n        var rule = this.rule;\n        for (var i = 0; i < len; i++) {\n            rule = this.findGroupByIdx(groupLevel[i], rule, i === 0);\n        }\n        return rule;\n    };\n    QueryBuilder.prototype.deleteGroup = function (target) {\n        var groupElem = target;\n        var groupId = groupElem.id;\n        var rule = this.getGroup(groupElem, true);\n        var index = 0;\n        var i;\n        var len;\n        var args = { groupID: groupId, filterID: groupId };\n        this.trigger('groupDelete', args);\n        var element = groupElem.querySelectorAll('.e-group-container');\n        for (i = 0, len = element.length; i < len; i++) {\n            delete this.levelColl[element[i].id];\n        }\n        while (groupElem.previousElementSibling !== null) {\n            groupElem = groupElem.previousElementSibling;\n            index++;\n        }\n        rule.rules.splice(index, 1);\n        delete this.levelColl[groupId];\n        detach(target);\n    };\n    QueryBuilder.prototype.deleteRule = function (target) {\n        var groupElem = closest(target, '.e-group-container');\n        var rule = this.getGroup(groupElem);\n        var ruleElem = closest(target, '.e-rule-container');\n        var clnruleElem = ruleElem;\n        var args = { groupID: groupElem.id, filterID: ruleElem.id };\n        var index = 0;\n        while (ruleElem.previousElementSibling !== null) {\n            ruleElem = ruleElem.previousElementSibling;\n            index++;\n        }\n        rule.rules.splice(index, 1);\n        this.trigger('ruleDelete', args);\n        detach(clnruleElem);\n    };\n    QueryBuilder.prototype.setGroupRules = function (rule) {\n        this.reset();\n        this.groupIdCounter = 1;\n        this.ruleIdCounter = 0;\n        this.isImportRules = true;\n        this.rule = rule;\n        this.importRules(this.rule, this.element.querySelector('.e-group-container'), true);\n    };\n    /**\n     * Set the rule or rules collection.\n     * @returns void.\n     */\n    QueryBuilder.prototype.setRules = function (rule) {\n        var mRules = extend({}, rule, {}, true);\n        this.setGroupRules(mRules);\n    };\n    /**\n     * Gets the rule or rule collection.\n     * @returns object.\n     */\n    QueryBuilder.prototype.getRules = function () {\n        return this.rule;\n    };\n    /**\n     * Deletes the group or groups based on the group ID.\n     * @returns void.\n     */\n    QueryBuilder.prototype.deleteGroups = function (groupID) {\n        var i;\n        var len = groupID.length;\n        for (i = 0; i < len; i++) {\n            this.deleteGroup(document.getElementById(groupID[i]));\n        }\n    };\n    /**\n     * Gets the predicate from collection of rules.\n     * @returns object.\n     */\n    QueryBuilder.prototype.getFilteredRecords = function () {\n        var query = new Query().where(this.getPredicate(this.rule));\n        var filteredDS = [];\n        new DataManager(this.dataSource).executeQuery(query)\n            .then(function (e) {\n            e.result.forEach(function (data) {\n                filteredDS.push(data);\n            });\n        });\n        return filteredDS;\n    };\n    /**\n     * Deletes the rule or rules based on the rule ID.\n     * @returns void.\n     */\n    QueryBuilder.prototype.deleteRules = function (filterID) {\n        var i;\n        var len = filterID.length;\n        for (i = 0; i < len; i++) {\n            this.deleteRule(document.getElementById(filterID[i]));\n        }\n    };\n    /**\n     * Gets the query for Data Manager.\n     * @returns string.\n     */\n    QueryBuilder.prototype.getDataManagerQuery = function (rule) {\n        var predicate = this.getPredicate(rule);\n        var query;\n        var fields = [];\n        for (var i = 0, len = Object.keys(this.columns); i < len.length; i++) {\n            fields.push(this.columns[i].field);\n        }\n        if (rule.rules.length) {\n            query = new Query().select(fields).where(predicate);\n        }\n        else {\n            query = new Query().select(fields);\n        }\n        return query;\n    };\n    /**\n     * Get the predicate from collection of rules.\n     * @returns null\n     */\n    QueryBuilder.prototype.getPredicate = function (rule) {\n        var ruleColl = rule.rules;\n        var pred;\n        var pred2;\n        var ruleValue;\n        var ignoreCase = false;\n        for (var i = 0, len = ruleColl.length; i < len; i++) {\n            var keys = Object.keys(ruleColl[i]);\n            if (keys.indexOf('rules') > -1) {\n                pred2 = this.getPredicate(ruleColl[i]);\n                if (pred2) {\n                    if (rule.condition === 'and') {\n                        pred = pred.and(pred2);\n                    }\n                    else {\n                        pred = pred.or(pred2);\n                    }\n                }\n            }\n            else if (ruleColl[i].operator.length) {\n                if (ruleColl[i].type === 'date') {\n                    ruleValue = new Date(ruleColl[i].value);\n                }\n                else {\n                    ruleValue = ruleColl[i].value;\n                }\n                var oper = ruleColl[i].operator.toLowerCase();\n                ignoreCase = (oper === 'contains' || oper === 'startswith' || oper === 'endswith');\n                if (i === 0) {\n                    if ((oper.indexOf('in') > -1 || oper.indexOf('between') > -1) && oper !== 'contains') {\n                        pred = this.arrayPredicate(ruleColl[i]);\n                    }\n                    else {\n                        var value = ruleValue;\n                        if (value !== '') {\n                            pred = new Predicate(ruleColl[i].field, ruleColl[i].operator, ruleValue, ignoreCase);\n                        }\n                    }\n                }\n                else {\n                    if (rule.condition === 'and') {\n                        if ((oper.indexOf('in') > -1 || oper.indexOf('between') > -1) && oper !== 'contains') {\n                            pred = this.arrayPredicate(ruleColl[i], pred, rule.condition);\n                        }\n                        else {\n                            var value = ruleValue;\n                            if (pred && value !== '') {\n                                pred = pred.and(ruleColl[i].field, ruleColl[i].operator, ruleValue, ignoreCase);\n                            }\n                        }\n                    }\n                    else {\n                        if ((oper.indexOf('in') > -1 || oper.indexOf('between') > -1) && oper !== 'contains') {\n                            pred = this.arrayPredicate(ruleColl[i], pred, rule.condition);\n                        }\n                        else {\n                            var value = ruleValue;\n                            if (pred && value !== '') {\n                                pred = pred.or(ruleColl[i].field, ruleColl[i].operator, ruleValue, ignoreCase);\n                            }\n                        }\n                    }\n                }\n            }\n        }\n        return pred;\n    };\n    QueryBuilder.prototype.arrayPredicate = function (ruleColl, predicate, condition) {\n        var value = ruleColl.value;\n        var pred;\n        for (var j = 0, jLen = value.length; j < jLen; j++) {\n            if (value[j] !== '') {\n                if (j === 0) {\n                    switch (ruleColl.operator) {\n                        case 'between':\n                            pred = new Predicate(ruleColl.field, 'greaterthan', value[j]);\n                            break;\n                        case 'notbetween':\n                            pred = new Predicate(ruleColl.field, 'lessthan', value[j]);\n                            break;\n                        case 'in':\n                            pred = new Predicate(ruleColl.field, 'equal', value[j]);\n                            break;\n                        case 'notin':\n                            pred = new Predicate(ruleColl.field, 'notequal', value[j]);\n                            break;\n                    }\n                }\n                else {\n                    switch (ruleColl.operator) {\n                        case 'between':\n                            pred = pred.and(ruleColl.field, 'lessthan', value[j]);\n                            break;\n                        case 'notbetween':\n                            pred = pred.or(ruleColl.field, 'greaterthan', value[j]);\n                            break;\n                        case 'in':\n                            pred = pred.or(ruleColl.field, 'equal', value[j]);\n                            break;\n                        case 'notin':\n                            pred = pred.and(ruleColl.field, 'notequal', value[j]);\n                            break;\n                    }\n                }\n            }\n        }\n        if (pred) {\n            if (condition === 'and') {\n                predicate = predicate.and(pred);\n            }\n            else if (condition === 'or') {\n                predicate = predicate.or(pred);\n            }\n            else {\n                predicate = pred;\n            }\n        }\n        return predicate;\n    };\n    QueryBuilder.prototype.importRules = function (rule, parentElem, isReset) {\n        if (!isReset) {\n            parentElem = this.renderGroup(rule.condition, parentElem);\n        }\n        var ruleColl = rule.rules;\n        for (var i = 0, len = ruleColl.length; i < len; i++) {\n            var keys = Object.keys(ruleColl[i]);\n            if (keys.indexOf('rules') > -1) {\n                parentElem = this.renderGroup(ruleColl[i].condition, parentElem);\n                parentElem = this.importRules(ruleColl[i], parentElem, true);\n            }\n            else {\n                this.renderRule(ruleColl[i], parentElem);\n            }\n        }\n        parentElem = closest(parentElem, '.e-rule-list');\n        if (parentElem) {\n            parentElem = closest(parentElem, '.e-group-container');\n        }\n        return parentElem;\n    };\n    QueryBuilder.prototype.renderGroup = function (condition, parentElem) {\n        this.addGroupElement(true, parentElem, condition); //Child group\n        var element = parentElem.querySelectorAll('.e-group-container');\n        return element[element.length - 1];\n    };\n    QueryBuilder.prototype.renderRule = function (rule, parentElem) {\n        if (parentElem.className.indexOf('e-group-container') > -1) {\n            this.addRuleElement(parentElem, rule); //Create rule\n        }\n        else {\n            this.addRuleElement(parentElem.querySelector('.e-group-container'), rule); //Create group\n        }\n    };\n    QueryBuilder.prototype.getSqlString = function (rules, queryStr) {\n        var isRoot = false;\n        if (!queryStr) {\n            queryStr = '';\n            isRoot = true;\n        }\n        else {\n            queryStr += '(';\n        }\n        var condition = rules.condition;\n        for (var j = 0, jLen = rules.rules.length; j < jLen; j++) {\n            if (rules.rules[j].rules) {\n                queryStr = this.getSqlString(rules.rules[j], queryStr);\n            }\n            else {\n                var rule = rules.rules[j];\n                var valueStr = '';\n                if (rule.value instanceof Array) {\n                    valueStr += '(' + rule.value + ')';\n                }\n                else {\n                    if (rule.operator === 'startswith') {\n                        valueStr += '(\"' + rule.value + '%\")';\n                    }\n                    else if (rule.operator === 'endswith') {\n                        valueStr += '(\"%' + rule.value + '\")';\n                    }\n                    else if (rule.operator === 'contains') {\n                        valueStr += '(\"%' + rule.value + '%\")';\n                    }\n                    else {\n                        if (rule.type === 'number') {\n                            valueStr += rule.value;\n                        }\n                        else {\n                            valueStr += '\"' + rule.value + '\"';\n                        }\n                    }\n                }\n                queryStr += rule.field + ' ' + this.operators[rule.operator] + ' ' + valueStr;\n            }\n            if (j !== jLen - 1) {\n                queryStr += ' ' + condition + ' ';\n            }\n        }\n        if (!isRoot) {\n            queryStr += ')';\n        }\n        return queryStr;\n    };\n    /**\n     * Sets the rules from the sql query.\n     */\n    QueryBuilder.prototype.setRulesFromSql = function (sqlString) {\n        var ruleModel = this.getRulesFromSql(sqlString);\n        this.setRules({ condition: ruleModel.condition, rules: ruleModel.rules });\n    };\n    /**\n     * Get the rules from SQL query.\n     * @returns object.\n     */\n    QueryBuilder.prototype.getRulesFromSql = function (sqlString) {\n        this.parser = [];\n        this.sqlParser(sqlString);\n        this.rule = { condition: '', rules: [] };\n        return this.processParser(this.parser, this.rule, [0]);\n    };\n    /**\n     * Gets the sql query from rules.\n     * @returns object.\n     */\n    QueryBuilder.prototype.getSqlFromRules = function (rule) {\n        return this.getSqlString(rule).replace(/\"/g, '\\'');\n    };\n    QueryBuilder.prototype.sqlParser = function (sqlString) {\n        var st = 0;\n        var str;\n        do {\n            str = sqlString.slice(st);\n            st += this.parseSqlStrings(str);\n        } while (str !== '');\n        return this.parser;\n    };\n    QueryBuilder.prototype.parseSqlStrings = function (sqlString) {\n        var operators = ['=', '!=', '<', '>', '<=', '>='];\n        var conditions = ['and', 'or'];\n        var betweenOp = ['BETWEEN', 'NOT BETWEEN'];\n        var subOp = ['IN', 'NOT IN', 'LIKE', 'NOT LIKE'];\n        var regexStr;\n        var regex;\n        var matchValue;\n        for (var i = 0, iLen = operators.length; i < iLen; i++) {\n            regexStr = /^\\w+$/.test(operators[i]) ? '\\\\b' : '';\n            regex = new RegExp('^(' + operators[i] + ')' + regexStr, 'ig');\n            if (regex.exec(sqlString)) {\n                this.parser.push(['Operators', operators[i].toLowerCase()]);\n                return operators[i].length;\n            }\n        }\n        for (var i = 0, iLen = conditions.length; i < iLen; i++) {\n            regexStr = /^\\w+$/.test(conditions[i]) ? '\\\\b' : '';\n            regex = new RegExp('^(' + conditions[i] + ')' + regexStr, 'ig');\n            if (regex.exec(sqlString)) {\n                this.parser.push(['Conditions', conditions[i].toLowerCase()]);\n                return conditions[i].length;\n            }\n        }\n        for (var i = 0, iLen = subOp.length; i < iLen; i++) {\n            regexStr = /^\\w+$/.test(subOp[i]) ? '\\\\b' : '';\n            regex = new RegExp('^(' + subOp[i] + ')' + regexStr, 'ig');\n            if (regex.exec(sqlString)) {\n                this.parser.push(['SubOperators', subOp[i].toLowerCase()]);\n                return subOp[i].length;\n            }\n        }\n        //Left Parenthesis\n        if (/^\\(/.exec(sqlString)) {\n            this.parser.push(['Left', '(']);\n            return 1;\n        }\n        //Right Parenthesis\n        if (/^\\)/.exec(sqlString)) {\n            this.parser.push(['Right', ')']);\n            return 1;\n        }\n        //Literals\n        if (/^`?([a-z_][a-z0-9_]{0,}(\\:(number|float|string|date|boolean))?)`?/i.exec(sqlString)) {\n            matchValue = /^`?([a-z_][a-z0-9_]{0,}(\\:(number|float|string|date|boolean))?)`?/i.exec(sqlString)[1];\n            this.parser.push(['Literal', matchValue]);\n            return matchValue.length;\n        }\n        //String\n        if (/^'((?:[^\\\\']+?|\\\\.|'')*)'(?!')/.exec(sqlString)) {\n            matchValue = /^'((?:[^\\\\']+?|\\\\.|'')*)'(?!')/.exec(sqlString)[0];\n            this.parser.push(['String', matchValue]);\n            return matchValue.length;\n        }\n        //Double String\n        if (/^\"([^\\\\\"]*(?:\\\\.[^\\\\\"]*)*)\"/.exec(sqlString)) {\n            matchValue = /^\"([^\\\\\"]*(?:\\\\.[^\\\\\"]*)*)\"/.exec(sqlString)[0];\n            this.parser.push(['DoubleString', matchValue]);\n            return matchValue.length;\n        }\n        //Number\n        if (/^[0-9]+(\\.[0-9]+)?/.exec(sqlString)) {\n            matchValue = /^[0-9]+(\\.[0-9]+)?/.exec(sqlString)[0];\n            this.parser.push(['Number', matchValue]);\n            return matchValue.length;\n        }\n        return 1;\n    };\n    QueryBuilder.prototype.getOperator = function (value, operator) {\n        var operators = {\n            '=': 'equal', '!=': 'notequal', '<': 'lessthan', '>': 'greaterthan', '<=': 'lessthanorequal',\n            '>=': 'greaterthanorequal'\n        };\n        if (value.indexOf('%') === 0 && value.indexOf('%') === value.length - 1) {\n            return 'contains';\n        }\n        else if (value.indexOf('%') === 0 && value.indexOf('%') !== value.length - 1) {\n            return 'startswith';\n        }\n        else if (value.indexOf('%') !== 0 && value.indexOf('%') === value.length - 1) {\n            return 'endswith';\n        }\n        return operators[operator];\n    };\n    QueryBuilder.prototype.processParser = function (parser, rules, levelColl) {\n        var rule;\n        var numVal = [];\n        var strVal = [];\n        var subRules;\n        var j;\n        var jLen;\n        var k;\n        var kLen;\n        var l;\n        var lLen;\n        var grpCount;\n        var operator;\n        for (var i = 0, iLen = parser.length; i < iLen; i++) {\n            if (parser[i][0] === 'Literal') {\n                rule = { label: parser[i][1], field: parser[i][1] };\n                if (parser[i + 1][0] === 'SubOperators') {\n                    rule.operator = this.getOperator(parser[i + 3][1].replace(/'/g, ''), parser[i + 1][1]);\n                    operator = parser[i + 1][1];\n                    i++;\n                    j = i + 1;\n                    jLen = iLen;\n                    for (j = i + 1; j < jLen; j++) {\n                        if (parser[j][0] === 'Right') {\n                            i = j;\n                            break;\n                        }\n                        else {\n                            if (operator === 'like' && parser[j][0] === 'String') {\n                                rule.value = parser[j][1].replace(/'/g, '').replace(/%/g, '');\n                                rule.type = 'string';\n                            }\n                            else {\n                                if (parser[j][0] === 'Number') {\n                                    numVal.push(Number(parser[j][1]));\n                                }\n                                else if (parser[j][0] === 'String') {\n                                    strVal.push(parser[j][1].replace(/'/g, ''));\n                                }\n                            }\n                        }\n                    }\n                    if (operator !== 'like') {\n                        if (parser[j - 1][0] === 'Number') {\n                            rule.value = numVal;\n                            rule.type = 'integer';\n                        }\n                        else if (parser[j - 1][0] === 'String') {\n                            rule.value = strVal;\n                            rule.type = 'string';\n                        }\n                    }\n                }\n                else if (parser[i + 1][0] === 'Operators') {\n                    rule.operator = this.getOperator(parser[i + 2][1], parser[i + 1][1]);\n                    if (parser[i + 2][0] === 'Number') {\n                        rule.type = 'integer';\n                        rule.value = Number(parser[i + 2][1]);\n                    }\n                    else {\n                        rule.type = 'string';\n                        rule.value = parser[i + 2][1].replace(/'/g, '');\n                    }\n                }\n                rules.rules.push(rule);\n            }\n            else if (parser[i][0] === 'Left') {\n                subRules = { condition: '', rules: [] };\n                this.parser = parser.splice(i + 1, iLen - (i + 1));\n                grpCount = 0;\n                //To get the group position\n                kLen = rules.rules.length;\n                for (k = 0; k < kLen; k++) {\n                    if (rules.rules[k].rules) {\n                        grpCount++;\n                    }\n                }\n                levelColl.push(grpCount);\n                rules.rules.push(subRules);\n                subRules = this.processParser(this.parser, subRules, levelColl);\n                return rules;\n            }\n            else if (parser[i][0] === 'Conditions') {\n                rules.condition = parser[i][1];\n            }\n            else if (parser[i][0] === 'Right') {\n                this.parser = parser.splice(i + 1, iLen - (i + 1));\n                //To get the parent Group\n                levelColl.pop();\n                rules = this.rule;\n                lLen = levelColl.length;\n                for (l = 0; l < lLen; l++) {\n                    rules = this.findGroupByIdx(levelColl[l], rules, l === 0);\n                }\n                return this.processParser(this.parser, rules, levelColl);\n            }\n        }\n        return rules;\n    };\n    __decorate([\n        Event()\n    ], QueryBuilder.prototype, \"created\", void 0);\n    __decorate([\n        Event()\n    ], QueryBuilder.prototype, \"beforeConditionChange\", void 0);\n    __decorate([\n        Event()\n    ], QueryBuilder.prototype, \"beforeFieldChange\", void 0);\n    __decorate([\n        Event()\n    ], QueryBuilder.prototype, \"beforeOperatorChange\", void 0);\n    __decorate([\n        Event()\n    ], QueryBuilder.prototype, \"beforeValueChange\", void 0);\n    __decorate([\n        Event()\n    ], QueryBuilder.prototype, \"conditionChanged\", void 0);\n    __decorate([\n        Event()\n    ], QueryBuilder.prototype, \"fieldChanged\", void 0);\n    __decorate([\n        Event()\n    ], QueryBuilder.prototype, \"valueChanged\", void 0);\n    __decorate([\n        Event()\n    ], QueryBuilder.prototype, \"operatorChanged\", void 0);\n    __decorate([\n        Event()\n    ], QueryBuilder.prototype, \"groupDelete\", void 0);\n    __decorate([\n        Event()\n    ], QueryBuilder.prototype, \"ruleDelete\", void 0);\n    __decorate([\n        Event()\n    ], QueryBuilder.prototype, \"groupInsert\", void 0);\n    __decorate([\n        Event()\n    ], QueryBuilder.prototype, \"ruleInsert\", void 0);\n    __decorate([\n        Property(ShowButtons)\n    ], QueryBuilder.prototype, \"showButtons\", void 0);\n    __decorate([\n        Property(false)\n    ], QueryBuilder.prototype, \"summaryView\", void 0);\n    __decorate([\n        Property(false)\n    ], QueryBuilder.prototype, \"allowValidation\", void 0);\n    __decorate([\n        Property([])\n    ], QueryBuilder.prototype, \"columns\", void 0);\n    __decorate([\n        Property('')\n    ], QueryBuilder.prototype, \"cssClass\", void 0);\n    __decorate([\n        Property([])\n    ], QueryBuilder.prototype, \"dataSource\", void 0);\n    __decorate([\n        Property('Horizontal')\n    ], QueryBuilder.prototype, \"displayMode\", void 0);\n    __decorate([\n        Property(false)\n    ], QueryBuilder.prototype, \"enableRtl\", void 0);\n    __decorate([\n        Property(false)\n    ], QueryBuilder.prototype, \"enablePersistence\", void 0);\n    __decorate([\n        Property('Default')\n    ], QueryBuilder.prototype, \"sortDirection\", void 0);\n    __decorate([\n        Property(5)\n    ], QueryBuilder.prototype, \"maxGroupCount\", void 0);\n    __decorate([\n        Property('auto')\n    ], QueryBuilder.prototype, \"height\", void 0);\n    __decorate([\n        Property('auto')\n    ], QueryBuilder.prototype, \"width\", void 0);\n    __decorate([\n        Complex({ condition: 'and', rules: [] }, Rule)\n    ], QueryBuilder.prototype, \"rule\", void 0);\n    QueryBuilder = __decorate([\n        NotifyPropertyChanges\n    ], QueryBuilder);\n    return QueryBuilder;\n}(Component));\nexport { QueryBuilder };\n"],"names":["__extends","extendStatics","d","b","Object","setPrototypeOf","__proto__","Array","p","hasOwnProperty","__","this","constructor","prototype","create","__decorate","decorators","target","key","desc","c","arguments","length","r","getOwnPropertyDescriptor","Reflect","decorate","i","defineProperty","ej2Dropdowns","Inject","CheckBoxSelection","Columns","_super","apply","Property","ChildProperty","Rules","Rule","ShowButtons","QueryBuilder","options","element","_this","call","groupIdCounter","ruleIdCounter","btnGroupId","isImportRules","parser","intl","Internationalization","customOperators","operators","equal","notequal","greaterthan","greaterthanorequal","lessthan","in","notin","lessthanorequal","startswith","endswith","between","notbetween","contains","operatorValue","empty","notempty","validationRules","getPersistData","addOnPersist","reset","bodeElem","querySelector","detach","children","appendChild","createElement","attrs","class","levelColl","id","rule","condition","rules","getWrapper","getModuleName","initialize","dataSource","columnKeys","keys","cols","type","isDate","value","columns","sortDirection","toLowerCase","DataManager","executeLocal","Query","sortByDesc","sortBy","len","indexOf","field","isNaN","Date","parse","getTime","label","clickEventHandler","event","tagName","parentElement","className","getComponent","destroy","deleteRule","deleteGroup","closest","document","getElementById","style","display","querySelectorAll","addGroupElement","mRules","extend","setGroupRules","renderSummaryCollapse","groupElem","textContent","getSqlFromRules","args","groupID","selectedItem","cancel","trigger","getGroup","selectBtn","name","addClass","addRuleElement","ruleElem","cloneNode","displayMode","groupLevel","dropDownList","height","ruleListElem","l10n","getConstant","Tooltip","content","appendTo","setAttribute","DropDownList","fields","text","placeholder","popupHeight","change","changeField","bind","allowValidation","required","filterIndex","index","findGroupByIdx","push","operator","changeRule","itemData","validateFields","previousElementSibling","removeClass","groupTemplate","grpBodyElem","groupHdrElem","rulesElem","glueElem","inputElem","labelElem","grpActElem","groupBtn","innerHTML","ruleTemplate","filterElem","tempElem","delBtnElem","fieldElem","isGroup","isBtnClick","maxGroupCount","dltGroupBtn","andInpElem","orInpElem","andLblElem","orLblElem","Button","iconCss","cssClass","rippleEffect","selector","ruleList","grpLen","level","slice","addGroups","DropDownButton","items","beforeOpen","select","notifyChange","tempColl","valueColl","iLen","nextElementSibling","updateRules","changeValue","eventsArgs","dateElement","filterID","operatorList","operatorElem","oprElem","tempRule","dropDownObj","item","filtElem","replace","filtObj","template","previousItemData","prevValue","childElementCount","renderValues","ruleId","dataBind","destroyControls","inputElement","divElement","classList","clsName","j","jLen","templateDestroy","column","elemId","temp","getValue","window","elementId","getDistinctValues","original","result","data","renderMultiSelect","parentId","selectedValue","ds","MultiSelect","query","mode","width","processTemplate","tempElements","write","elements","values","renderControls","length_1","ruleValElem","selectedVal","inputobj","TextBox","input","validation","numeric","NumericTextBox","format","isCheck","Boolean","RadioButton","checked","datepick","DatePicker","prevItemData","isRender","ddlObj","valElem","Element","updateValues","controlName","split","parseInt","formatDate","ruleElement","i_1","oper","ddlInst","getInstance","groupIdx","isRoot","ruleColl","unWireEvents","addRules","groups","grouplen","importRules","initWrapper","enableRtl","Browser","isDevice","add","summaryView","renderSummary","buttons","button","contentElem","textElem","readonly","editElem","collapseElem","onPropertyChanged","newProp","oldProp","_i","properties_1","summaryElem","showButtons","ruleDelete","groupDelete","remove","enablePersistence","locale","preRender","defaultLocale","StartsWith","EndsWith","Contains","Equal","NotEqual","LessThan","LessThanOrEqual","GreaterThan","GreaterThanOrEqual","Between","NotBetween","Empty","NotEmpty","In","NotIn","NotContains","Remove","SelectField","SelectOperator","DeleteRule","DeleteGroup","AddGroup","AddCondition","Edit","L10n","stringOperator","dateOperator","booleanOperator","numberOperator","render","wireEvents","wrapper","EventHandler","isParent","groupId","splice","clnruleElem","setRules","getRules","deleteGroups","getFilteredRecords","where","getPredicate","filteredDS","executeQuery","then","e","forEach","deleteRules","getDataManagerQuery","predicate","pred","pred2","ruleValue","ignoreCase","and","or","arrayPredicate","Predicate","parentElem","isReset","renderGroup","renderRule","getSqlString","queryStr","valueStr","setRulesFromSql","sqlString","ruleModel","getRulesFromSql","sqlParser","processParser","str","st","parseSqlStrings","regexStr","matchValue","conditions","subOp","test","RegExp","exec","getOperator","=","!=","<",">","<=",">=","subRules","k","kLen","l","lLen","grpCount","numVal","strVal","Number","pop","Event","Complex","NotifyPropertyChanges","Component"],"mappings":"iFAAA,IAAIA,GAAwC,WACxC,GAAIC,GAAgB,SAAUC,EAAGC,GAI7B,OAHAF,EAAgBG,OAAOC,iBAChBC,uBAA2BC,QAAS,SAAUL,EAAGC,GAAKD,EAAEI,UAAYH,IACvE,SAAUD,EAAGC,GAAK,IAAK,GAAIK,KAAKL,GAAOA,EAAEM,eAAeD,KAAIN,EAAEM,GAAKL,EAAEK,MACpDN,EAAGC,GAE5B,OAAO,UAAUD,EAAGC,GAEhB,QAASO,KAAOC,KAAKC,YAAcV,EADnCD,EAAcC,EAAGC,GAEjBD,EAAEW,UAAkB,OAANV,EAAaC,OAAOU,OAAOX,IAAMO,EAAGG,UAAYV,EAAEU,UAAW,GAAIH,QAGnFK,EAA0C,SAAUC,EAAYC,EAAQC,EAAKC,GAC7E,GAA2HjB,GAAvHkB,EAAIC,UAAUC,OAAQC,EAAIH,EAAI,EAAIH,EAAkB,OAATE,EAAgBA,EAAOf,OAAOoB,yBAAyBP,EAAQC,GAAOC,CACrH,IAAuB,gBAAZM,UAAoD,kBAArBA,SAAQC,SAAyBH,EAAIE,QAAQC,SAASV,EAAYC,EAAQC,EAAKC,OACpH,KAAK,GAAIQ,GAAIX,EAAWM,OAAS,EAAGK,GAAK,EAAGA,KAASzB,EAAIc,EAAWW,MAAIJ,GAAKH,EAAI,EAAIlB,EAAEqB,GAAKH,EAAI,EAAIlB,EAAEe,EAAQC,EAAKK,GAAKrB,EAAEe,EAAQC,KAASK,EAChJ,OAAOH,GAAI,GAAKG,GAAKnB,OAAOwB,eAAeX,EAAQC,EAAKK,GAAIA,EAKhEM,eAaYC,OAAOC,oBACnB,IAAIC,GAAyB,SAAUC,GAEnC,QAASD,KACL,MAAkB,QAAXC,GAAmBA,EAAOC,MAAMvB,KAAMU,YAAcV,KA6B/D,MA/BAX,GAAUgC,EAASC,GAInBlB,GACIoB,WAAS,OACVH,EAAQnB,UAAW,YAAS,IAC/BE,GACIoB,WAAS,OACVH,EAAQnB,UAAW,YAAS,IAC/BE,GACIoB,WAAS,OACVH,EAAQnB,UAAW,WAAQ,IAC9BE,GACIoB,WAAS,OACVH,EAAQnB,UAAW,aAAU,IAChCE,GACIoB,WAAS,OACVH,EAAQnB,UAAW,gBAAa,IACnCE,GACIoB,WAAS,OACVH,EAAQnB,UAAW,eAAY,IAClCE,GACIoB,WAAS,OACVH,EAAQnB,UAAW,iBAAc,IACpCE,GACIoB,WAAS,OACVH,EAAQnB,UAAW,aAAU,IAChCE,GACIoB,WAAS,OACVH,EAAQnB,UAAW,WAAQ,IACvBmB,GACTI,iBAEEC,EAAuB,SAAUJ,GAEjC,QAASI,KACL,MAAkB,QAAXJ,GAAmBA,EAAOC,MAAMvB,KAAMU,YAAcV,KAuB/D,MAzBAX,GAAUqC,EAAOJ,GAIjBlB,GACIoB,WAAS,KACVE,EAAMxB,UAAW,gBAAa,IACjCE,GACIoB,cACDE,EAAMxB,UAAW,YAAS,IAC7BE,GACIoB,WAAS,OACVE,EAAMxB,UAAW,YAAS,IAC7BE,GACIoB,WAAS,OACVE,EAAMxB,UAAW,YAAS,IAC7BE,GACIoB,WAAS,OACVE,EAAMxB,UAAW,WAAQ,IAC5BE,GACIoB,WAAS,OACVE,EAAMxB,UAAW,eAAY,IAChCE,GACIoB,WAAS,OACVE,EAAMxB,UAAW,YAAS,IACtBwB,GACTD,iBAEEE,EAAsB,SAAUL,GAEhC,QAASK,KACL,MAAkB,QAAXL,GAAmBA,EAAOC,MAAMvB,KAAMU,YAAcV,KAQ/D,MAVAX,GAAUsC,EAAML,GAIhBlB,GACIoB,WAAS,QACVG,EAAKzB,UAAW,gBAAa,IAChCE,GACIoB,cACDG,EAAKzB,UAAW,YAAS,IACrByB,GACTF,iBAEEG,EAA6B,SAAUN,GAEvC,QAASM,KACL,MAAkB,QAAXN,GAAmBA,EAAOC,MAAMvB,KAAMU,YAAcV,KAW/D,MAbAX,GAAUuC,EAAaN,GAIvBlB,GACIoB,YAAS,IACVI,EAAY1B,UAAW,iBAAc,IACxCE,GACIoB,YAAS,IACVI,EAAY1B,UAAW,kBAAe,IACzCE,GACIoB,YAAS,IACVI,EAAY1B,UAAW,kBAAe,IAClC0B,GACTH,iBAEEI,EAA8B,SAAUP,GAExC,QAASO,GAAaC,EAASC,GAC3B,GAAIC,GAAQV,EAAOW,KAAKjC,KAAM8B,EAASC,IAAY/B,IAoBnD,OAnBAgC,GAAME,eAAiB,EACvBF,EAAMG,cAAgB,EACtBH,EAAMI,WAAa,EACnBJ,EAAMK,eAAgB,EACtBL,EAAMM,UACNN,EAAMO,KAAO,GAAIC,wBACjBR,EAAMS,mBACNT,EAAMU,WACFC,MAAO,IAAKC,SAAU,KAAMC,YAAa,IAAKC,mBAAoB,KAAMC,SAAU,IAAKC,GAAI,KAAMC,MAAO,SACxGC,gBAAiB,KAAMC,WAAY,OAAQC,SAAU,OAAQC,QAAS,UAAWC,WAAY,cAAeC,SAAU,QAE1HvB,EAAMwB,eACFb,MAAO,QAASE,YAAa,cAAeC,mBAAoB,qBAChEC,SAAU,WAAYG,gBAAiB,kBAAmBN,SAAU,WAAYa,MAAO,QAASC,SAAU,WAC1GL,QAAS,UAAWL,GAAI,KAAMC,MAAO,QAASK,WAAY,aAAcH,WAAY,aAAcC,SAAU,WAC5GG,SAAU,YAGdvB,EAAM2B,mBACC3B,EA+3DX,MAr5DA3C,GAAUwC,EAAcP,GAwBxBO,EAAa3B,UAAU0D,eAAiB,WACpC,MAAO5D,MAAK6D,cAAc,UAM9BhC,EAAa3B,UAAU4D,MAAQ,WAC3B9D,KAAKqC,eAAgB,CACrB,IAAI0B,GAAW/D,KAAK+B,QAAQiC,cAAc,gBAC1CC,UAAOF,EAASG,SAAS,IACzBH,EAASI,YAAYnE,KAAKoE,cAAc,OAASC,OAASC,MAAO,kBACjEtE,KAAKuE,UAAUvE,KAAK+B,QAAQyC,GAAK,cAAgB,GACjDxE,KAAKyE,MAASC,UAAW,MAAOC,WAEpC9C,EAAa3B,UAAU0E,WAAa,WAChC,MAAO5E,MAAK+B,SAEhBF,EAAa3B,UAAU2E,cAAgB,WACnC,MAAO,iBAEXhD,EAAa3B,UAAU4E,WAAa,WAChC,GAAI9E,KAAK+E,WAAWpE,OAAQ,CACxB,GAAIqE,GAAavF,OAAOwF,KAAKjF,KAAK+E,WAAW,IACzCG,KACAC,MAAO,GACPC,GAAS,EACTC,MAAQ,EACZ,IAAIrF,KAAKsF,QAAQ3E,OAAQ,CACoB,eAArCX,KAAKuF,cAAcC,cACnBxF,KAAKsF,QAAU,GAAIG,eAAYzF,KAAKsF,SAASI,cAAa,GAAIC,UAAQC,WAAW,UAEvC,cAArC5F,KAAKuF,cAAcC,gBACxBxF,KAAKsF,QAAU,GAAIG,eAAYzF,KAAKsF,SAASI,cAAa,GAAIC,UAAQE,OAAO,UAGjF,KAAK,GADDP,GAAUtF,KAAKsF,QACVtE,EAAI,EAAG8E,EAAMR,EAAQ3E,OAAQK,EAAI8E,EAAK9E,IACtCsE,EAAQtE,GAAGmE,OACRH,EAAWe,QAAQT,EAAQtE,GAAGgF,QAAU,IAG3B,YADbb,SADAE,EAAQrF,KAAK+E,WAAW,GAAGO,EAAQtE,GAAGgF,SAGlCZ,GAAUa,MAAMC,KAAKC,MAAMd,IAEb,WAATF,IACLC,EAASC,YAAiBa,QAASD,MAAMZ,EAAMe,WAC/CjB,EAAO,UAEXG,EAAQtE,GAAGmE,KAAOA,EAClBC,GAAS,GAEbD,EAAO,cAId,CACD,IAAK,GAAInE,GAAI,EAAG8E,EAAMd,EAAWrE,OAAQK,EAAI8E,EAAK9E,IAGjC,YADbmE,SADAE,EAAQrF,KAAK+E,WAAW,GAAGC,EAAWhE,MAGlCoE,GAAUa,MAAMC,KAAKC,MAAMd,IAEb,WAATF,IACLC,EAASC,YAAiBa,QAASD,MAAMZ,EAAMe,WAC/CjB,EAAO,UAEXD,EAAKlE,IAAOgF,MAAShB,EAAWhE,GAAIqF,MAASrB,EAAWhE,GAAImE,KAAQC,EAAS,OAASD,GACtFC,GAAS,CAEbpF,MAAKsF,QAAUJ,KAI3BrD,EAAa3B,UAAUoG,kBAAoB,SAAUC,GACjD,GAAIjG,GAASiG,EAAMjG,MAKnB,IAJAN,KAAKqC,eAAgB,EACE,SAAnB/B,EAAOkG,UACPlG,EAASA,EAAOmG,eAEG,WAAnBnG,EAAOkG,QACP,GAAIlG,EAAOoG,UAAUX,QAAQ,iBAAmB,EACxCzF,EAAOoG,UAAUX,QAAQ,cAAgB,GACzCY,eAAarG,EAAQ,WAAWsG,UAEpC5G,KAAK6G,WAAWvG,OAEf,IAAIA,EAAOoG,UAAUX,QAAQ,kBAAoB,EAClDY,eAAarG,EAAQ,WAAWsG,UAChC5G,KAAK8G,YAAYC,UAAQzG,EAAQ,2BAEhC,IAAIA,EAAOoG,UAAUX,QAAQ,gBAAkB,EAEhD,GADAiB,SAASC,eAAejH,KAAK+B,QAAQyC,GAAK,oBAAoB0C,MAAMC,QAAU,OAC1EnH,KAAK+B,QAAQqF,iBAAiB,sBAAsBzG,OAAS,EAAG,CAChEX,KAAKqH,iBAAgB,EAAOrH,KAAK+B,QAAS/B,KAAKyE,KAAKC,UACpD,IAAI4C,GAASC,YAAWvH,KAAKyE,SAAU,EACvCzE,MAAKwH,cAAcF,GACnBtH,KAAKyH,6BAGDC,EAAY1H,KAAK+B,QAAQiC,cAAc,uBAC7BoD,iBAAiB,oBAAoBzG,OAAS,GACxDX,KAAKyH,wBAETC,EAAUR,MAAMC,QAAU,YAG7B,IAAI7G,EAAOoG,UAAUX,QAAQ,oBAAsB,EAAG,CACvD,GAAI2B,GAAY1H,KAAK+B,QAAQiC,cAAc,qBAC3C0D,GAAUR,MAAMC,QAAU,OAC1BnH,KAAK+B,QAAQiC,cAAc,mBAAmB2D,YAAc3H,KAAK4H,gBAAgB5H,KAAKyE,MACtFuC,SAASC,eAAejH,KAAK+B,QAAQyC,GAAK,oBAAoB0C,MAAMC,QAAU,YAEzE7G,GAAOoG,UAAUX,QAAQ,oBAAsB,IACpD/F,KAAK+B,QAAQiC,cAAc,sBAAsBkD,MAAMC,QAAU,OACjEnH,KAAK+B,QAAQiC,cAAc,mBAAmB2D,YAAc3H,KAAK4H,gBAAgB5H,KAAKyE,MACtFuC,SAASC,eAAejH,KAAK+B,QAAQyC,GAAK,oBAAoB0C,MAAMC,QAAU,aAGjF,IAAuB,UAAnB7G,EAAOkG,SAAuBlG,EAAOmG,cAAcC,UAAUX,QAAQ,gBAAkB,EAAG,CAC/F,GAAIhE,GAAUgF,UAAQzG,EAAQ,sBAC1BuH,GAASC,QAAS/F,EAAQyC,GAAIuD,aAAczH,EAAQ0H,QAAQ,EAChEhI,MAAKiI,QAAQ,wBAAyBJ,GAC3B7H,KAAKkI,SAASnG,GACpB2C,UAAYpE,EAAOqH,YAAYnC,cACpCqC,GAASC,QAAS/F,EAAQyC,GAAIuD,aAAczH,GAC5CN,KAAKiI,QAAQ,mBAAoBJ,KAGzChG,EAAa3B,UAAUiI,UAAY,SAAU7H,EAAQiG,GAC9B,eAAfA,EAAM6B,KACNC,YAAU9B,EAAMxE,QAAQiC,cAAc,sBAAsByC,eAAgB,kBAEvEF,EAAMxE,QAAQmC,SAAS,GAAGwC,UAAUX,QAAQ,cAAgB,EACjE/F,KAAKsI,eAAevB,UAAQzG,EAAQ,0BAE/BiG,EAAMxE,QAAQmC,SAAS,GAAGwC,UAAUX,QAAQ,eAAiB,GAClE/F,KAAKqH,iBAAgB,EAAMN,UAAQzG,EAAQ,sBAAuB,IAAI,IAG9EuB,EAAa3B,UAAUoI,eAAiB,SAAUhI,EAAQmE,GACtD,GAAI8D,GAAWvI,KAAKuI,SAASC,WAAU,EACd,cAArBxI,KAAKyI,aAA8BzI,KAAK+B,QAAQ2E,UAAUX,QAAQ,aAAe,EACjFwC,EAAS7B,UAAY,mCAGrB6B,EAAS7B,UAAY,oCAEzB,IAAIgC,GACA/D,EACA3D,EACA8E,EACA6C,EAGAC,EAFAC,EAAevI,EAAO0D,cAAc,gBACpCjC,EAAUwG,EAASvE,cAAc,SAkCrC,IAhCIhE,KAAK+B,QAAQ2E,UAAUX,QAAQ,aAAe,GAA0B,aAArB/F,KAAKyI,YACxD1G,EAAQ4F,YAAc3H,KAAK8I,KAAKC,YAAY,WAG5CV,YAAUtG,GAAU,WACpBsG,YAAUtG,GAAU,cACN,GAAIiH,YAAUC,QAASjJ,KAAK8I,KAAKC,YAAY,gBACnDG,SAASnH,GACjBA,EAAU/B,KAAKoE,cAAc,QAAUC,OAASC,MAAO,sCACvDiE,EAASvE,cAAc,UAAUG,YAAYpC,IAEjDwG,EAASY,aAAa,KAAM7I,EAAOkE,GAAK,UAAYxE,KAAKmC,eACzDnC,KAAKmC,gBACLoG,EAASvE,cAAc,mBAAmBmF,aAAa,KAAMZ,EAAS/D,GAAK,cAC3EqE,EAAa1E,YAAYoE,GACzBK,EAAU5I,KAAK+B,QAAQ2E,UAAUX,QAAQ,aAAe,EAAK,QAAU,SACvE4C,EAAe,GAAIS,iBACfrE,WAAY/E,KAAKsF,QACjB+D,QAAUC,KAAM,QAASjE,MAAO,SAChCkE,YAAavJ,KAAK8I,KAAKC,YAAY,eACnCS,YAAexJ,KAAKsF,QAAQ3E,OAAS,EAAKiI,EAAS,OACnDa,OAAQzJ,KAAK0J,YAAYC,KAAK3J,MAC9BqF,MAAOZ,EAAOA,EAAKuB,MAAQ,QAElBkD,SAAS,IAAMX,EAAS/D,GAAK,cACtCxE,KAAK4J,kBACLrB,EAASvE,cAAc,mBAAmBmF,aAAa,OAAQZ,EAAS/D,GAAK,SAC7E6D,YAAUE,EAASvE,cAAc,oBAAqB,WACtDhE,KAAK2D,gBAAgB4E,EAAS/D,GAAK,UAAaqF,UAAU,IAE9D7J,KAAK8J,YAAcnB,EAAaoB,MAChCrB,EAAa1I,KAAKuE,UAAUjE,EAAOkE,KAC9BxE,KAAKqC,cAAe,CAErB,IADAsC,EAAQ3E,KAAKyE,KACRzD,EAAI,EAAG8E,EAAM4C,EAAW/H,OAAQK,EAAI8E,EAAK9E,IAC1C2D,EAAQ3E,KAAKgK,eAAetB,EAAW1H,GAAI2D,EAAa,IAAN3D,EAElDvB,QAAOwF,KAAKR,GAAM9D,OAClBgE,EAAMA,MAAMsF,MACRjE,MAASvB,EAAKuB,MAAOb,KAAQV,EAAKU,KAAMkB,MAAS5B,EAAK4B,MAAO6D,SAAYzF,EAAKyF,SAAU7E,MAAOZ,EAAKY,QAIxGV,EAAMA,MAAMsF,MAAOjE,MAAS,GAAIb,KAAQ,GAAIkB,MAAS,GAAI6D,SAAY,GAAI7E,WAG7E5F,OAAOwF,KAAKR,GAAM9D,QAClBX,KAAKmK,WAAW1F,GACZ1C,QAAS4G,EAAa5G,QACtBqI,SAAUpK,KAAKsF,QAAQtF,KAAK8J,gBAIxCjI,EAAa3B,UAAUmK,eAAiB,WACpC,GACIrJ,GAEAe,EACA2F,EACA/C,EACA4D,EACAwB,EAPA9E,EAAOxF,OAAOwF,KAAKjF,KAAK2D,iBAExBmC,EAAMb,EAAKtE,MAMf,KAAKK,EAAI,EAAGA,EAAI8E,EAAK9E,IAEjB,GADAe,EAAU/B,KAAK+B,QAAQiC,cAAc,SAAWiB,EAAKjE,GAAK,MAC7C,CAKT,IAJA0G,EAAYX,UAAQhF,EAAS,sBAC7B4C,EAAQ3E,KAAKkI,SAASR,GACtBa,EAAWxB,UAAQhF,EAAS,qBAC5BgI,EAAQ,EACDxB,GAAgD,OAApCA,EAAS+B,wBACxB/B,EAAWA,EAAS+B,uBACpBP,GAEAhD,WAAQhF,EAAS,oBACZ4C,EAAMA,MAAMoF,GAAO/D,MAIpBuE,eAAaxI,EAAQ0E,eAAgB,WAHrC4B,YAAUtG,EAAQ0E,eAAgB,YAMtCM,UAAQhF,EAAS,sBACZ4C,EAAMA,MAAMoF,GAAOG,SAIpBK,eAAaxI,EAAQ0E,eAAgB,WAHrC4B,YAAUtG,EAAQ0E,eAAgB,YAMtCM,UAAQhF,EAAS,mBACZ4C,EAAMA,MAAMoF,GAAO1E,MAIpBkF,eAAaxI,EAAQ0E,eAAgB,WAHrC4B,YAAUtG,EAAQ0E,eAAgB,cAStD5E,EAAa3B,UAAUsK,cAAgB,WACnC,GAAI9C,GACA+C,EACAC,EACAC,EACAC,EACAC,EACAC,EACAC,EACAC,CAwBJ,OAvBAtD,GAAY1H,KAAKoE,cAAc,OAASC,OAASC,MAAO,uBACxDoG,EAAe1K,KAAKoE,cAAc,OAASC,OAASC,MAAO,oBAC3DmG,EAAczK,KAAKoE,cAAc,OAASC,OAASC,MAAO,kBAC1DqG,EAAY3K,KAAKoE,cAAc,OAASC,OAASC,MAAO,iBACxDoD,EAAUvD,YAAYuG,GACtBD,EAAYtG,YAAYwG,GACxBjD,EAAUvD,YAAYsG,GAEtBG,EAAW5K,KAAKoE,cAAc,OAASC,OAASC,MAAO,kBACvDuG,EAAY7K,KAAKoE,cAAc,SAAWC,OAASc,KAAM,QAASb,MAAO,iBAAkBe,MAAO,UACxF8D,aAAa,UAAW,QAClCyB,EAASzG,YAAY0G,GACrBC,EAAY9K,KAAKoE,cAAc,SAAWC,OAASC,MAAO,4BAA8B2G,UAAW,QACnGL,EAASzG,YAAY2G,GACrBD,EAAY7K,KAAKoE,cAAc,SAAWC,OAASc,KAAM,QAASb,MAAO,gBAAiBe,MAAO,QACjGuF,EAASzG,YAAY0G,GACrBC,EAAY9K,KAAKoE,cAAc,SAAWC,OAASC,MAAO,2BAA6B2G,UAAW,OAClGL,EAASzG,YAAY2G,GACrBJ,EAAavG,YAAYyG,GACzBG,EAAa/K,KAAKoE,cAAc,OAASC,OAASC,MAAO,oBACzD0G,EAAWhL,KAAKoE,cAAc,UAAYC,OAASc,KAAM,SAAUb,MAAO,eAC1EyG,EAAW5G,YAAY6G,GACvBN,EAAavG,YAAY4G,GAClBrD,GAEX7F,EAAa3B,UAAUgL,aAAe,WAClC,GAAI3C,GACA4C,EACAC,EACAC,EACAC,CAcJ,OAbA/C,GAAWvI,KAAKoE,cAAc,OAC9BkH,EAAYtL,KAAKoE,cAAc,OAASC,OAASC,MAAO,kBACxD8G,EAAWpL,KAAKoE,cAAc,OAASC,OAASC,MAAO,mBACvD6G,EAAanL,KAAKoE,cAAc,SAAWC,OAASc,KAAM,OAAQb,MAAO,oBACzE8G,EAASjH,YAAYgH,GACrBG,EAAUnH,YAAYiH,GACtBA,EAAWpL,KAAKoE,cAAc,OAASC,OAASC,MAAO,qBACvDgH,EAAUnH,YAAYiH,GACtBA,EAAWpL,KAAKoE,cAAc,OAASC,OAASC,MAAO,kBACvDgH,EAAUnH,YAAYiH,GACtB7C,EAASpE,YAAYmH,GACrBD,EAAarL,KAAKoE,cAAc,UAAYC,OAASC,MAAO,wDAC5DgH,EAAUnH,YAAYkH,GACf9C,GAEX1G,EAAa3B,UAAUmH,gBAAkB,SAAUkE,EAASjL,EAAQoE,EAAW8G,GAC3E,KAAIxL,KAAK+B,QAAQqF,iBAAiB,sBAAsBzG,QAAUX,KAAKyL,eAAvE,CAGA,GAAIC,GACAhE,EAAY1H,KAAK0H,UAAUc,WAAU,EACzCd,GAAUyB,aAAa,KAAMnJ,KAAK+B,QAAQyC,GAAK,WAAaxE,KAAKkC,gBACjElC,KAAKkC,gBACL,IAAIyJ,GAAajE,EAAU1D,cAAc,mBACrC4H,EAAYlE,EAAU1D,cAAc,kBACpC6H,EAAanE,EAAU1D,cAAc,uBACrC8H,EAAYpE,EAAU1D,cAAc,qBAQxC,IAPA2H,EAAWxC,aAAa,KAAMnJ,KAAK+B,QAAQyC,GAAK,OAASxE,KAAKoC,YAC9DwJ,EAAUzC,aAAa,KAAMnJ,KAAK+B,QAAQyC,GAAK,MAAQxE,KAAKoC,YAC5DuJ,EAAWxC,aAAa,OAAQnJ,KAAK+B,QAAQyC,GAAK,OAASxE,KAAKoC,YAChEwJ,EAAUzC,aAAa,OAAQnJ,KAAK+B,QAAQyC,GAAK,OAASxE,KAAKoC,YAC/DyJ,EAAW1C,aAAa,MAAOnJ,KAAK+B,QAAQyC,GAAK,OAASxE,KAAKoC,YAC/D0J,EAAU3C,aAAa,MAAOnJ,KAAK+B,QAAQyC,GAAK,MAAQxE,KAAKoC,YAC7DpC,KAAKoC,aACDmJ,EAAS,CACTG,EAAc1L,KAAKoE,cAAc,UAAYC,OAASC,MAAO,mBAChD,GAAIyH,WAASC,QAAS,wBAAyBC,SAAU,oBAC/D/C,SAASwC,GACF,GAAI1C,YAAUC,QAASjJ,KAAK8I,KAAKC,YAAY,iBACnDG,SAASwC,GACjBQ,eAAaR,GAAeS,SAAU,iBACtCzE,EAAU1D,cAAc,mBAAmBG,YAAYuH,EACvD,IAAIU,GAAW9L,EAAO0D,cAAc,gBAChCqI,EAAS/L,EAAO8G,iBAAiB,sBAAsBzG,MAC3DyL,GAASjI,YAAYuD,EACrB,IAAI4E,GAAQtM,KAAKuE,UAAUjE,EAAOkE,IAAI+H,MAAM,EAC5CD,GAAMrC,KAAKoC,GACXrM,KAAKuE,UAAUmD,EAAUlD,IAAM8H,EAC1BtM,KAAKqC,gBACNrC,KAAKwM,aAAclM,EAAOkE,IACtBgH,GACAxL,KAAKsI,eAAeZ,WAK5BpH,GAAO6D,YAAYuD,GACnB1H,KAAKuE,UAAUmD,EAAUlD,KAAO,EAEpCkD,GAAU1D,cAAc,mBAAmBmF,aAAa,UAAW,QACjD,OAAdzE,GACAgD,EAAU1D,cAAc,kBAAkBmF,aAAa,UAAW,OAEtE,IAAI6B,GAAWtD,EAAU1D,cAAc,aAC1B,IAAIyI,mBACbC,MAAO1M,KAAK0M,MACZT,SAAU,8CACVD,QAAS,qBACTW,WAAY3M,KAAKmI,UAAUwB,KAAK3J,KAAMgL,GACtC4B,OAAQ5M,KAAKmI,UAAUwB,KAAK3J,KAAMgL,KAE/B9B,SAAS8B,GAChBkB,eAAalB,GAAYmB,SAAU,eAEvCtK,EAAa3B,UAAU2M,aAAe,SAAUxH,EAAOtD,GAGnD,IAAK,GAFD+K,GAAW/F,UAAQhF,EAAS,iBAAiBqF,iBAAiB,eAC9D2F,KACK/L,EAAI,EAAGgM,EAAOF,EAASnM,OAAQK,EAAIgM,EAAMhM,IAC1C8L,EAAS9L,GAAGiM,oBACRH,EAAS9L,GAAGiM,mBAAmBvG,UAAUX,QAAQ,YAAc,GAC/DgH,EAAU9C,KAAK6C,EAAS9L,GAAG2G,YAIvC3H,MAAKkN,YAAYnL,EAAU+K,EAASnM,OAAS,EAAKoM,EAAY1H,IAElExD,EAAa3B,UAAUiN,YAAc,SAAUnM,EAAG6G,GAC9C,GAAIuF,GACArL,GAEAA,EADA8F,EAAKtB,MACKsB,EAAKtB,MAAMjG,OAGCuH,EACI9F,SAElB2E,UAAUX,QAAQ,UAAY,IAEtChE,EADmB8F,EACI9F,QAE3B,IAAI2F,GAAYX,UAAQhF,EAAS,sBAC7BsL,EAAcxF,CACdwF,GAAYtL,SAAWsL,EAAYtL,QAAQ2E,UAAUX,QAAQ,iBAAmB,IAChFhE,EAAUsL,EAAYtL,QAE1B,IAAIsD,EAEAA,GADAtD,EAAQ2E,UAAUX,QAAQ,YAAc,EAChCY,eAAa5E,EAAS,SAASsE,MAElCtE,EAAQ2E,UAAUX,QAAQ,kBAAoB,EAC3CY,eAAa5E,EAAS,eAAesD,MAGrCwC,EAAKxC,MAEjB+H,GAAetF,QAASJ,EAAUlD,GAAI8I,SAAUvL,EAAQyC,GAAIa,MAAOA,EAAO2C,QAAQ,GAClFhI,KAAKiI,QAAQ,oBAAqBmF,GAClCpN,KAAKkN,YAAYnL,EAASsD,EAAOrE,GACjCoM,GAAetF,QAASJ,EAAUlD,GAAI8I,SAAUvL,EAAQyC,GAAIa,MAAOA,EAAO2C,QAAQ,GAClFhI,KAAKiI,QAAQ,eAAgBmF,IAEjCvL,EAAa3B,UAAUwJ,YAAc,SAAU7B,GAK3C,IAJA,GAAIH,GAAYX,UAAQc,EAAK9F,QAAS,sBAClC4C,EAAQ3E,KAAKkI,SAASR,GACtBa,EAAWxB,UAAQc,EAAK9F,QAAS,qBACjCgI,EAAQ,EACLxB,GAAgD,OAApCA,EAAS+B,wBACxB/B,EAAWA,EAAS+B,uBACpBP,GAEJ/J,MAAKmK,WAAWxF,EAAMA,MAAMoF,GAAQlC,IAExChG,EAAa3B,UAAUiK,WAAa,SAAU1F,EAAMoD,GAChD,GAAKA,EAAKuC,SAAV,CAGA,GACImD,GACApC,EACAqC,EACAC,EAJAC,IAKJvC,GAAapE,UAAQc,EAAK9F,QAAS,kBACnCyL,EAAezG,UAAQc,EAAK9F,QAAS,mBACrC,IAAI4L,GAAchH,eAAakB,EAAK9F,QAAS,gBACzCA,EAAUgF,UAAQc,EAAK9F,QAAS,qBACpC,IAAIoJ,EAAY,CACRiC,GACAtF,QAAS/F,EAAQyC,GAAI8I,SAAUzF,EAAK9F,QAAQyC,GAAIuD,aAAcF,EAAK+F,KAAM5F,QAAQ,EAErFhI,MAAKiI,QAAQ,oBAAqBmF,GAClCM,EAASvI,KAAOnF,KAAKsF,QAAQqI,EAAY5D,OAAO5E,KAEpD,GAAIqI,EAAc,CACd,GAAIJ,IACAtF,QAAS/F,EAAQyC,GAAI8I,SAAUzF,EAAK9F,QAAQyC,GAAIuD,aAAcF,EAAK+F,KAAM5F,QAAQ,EAErFhI,MAAKiI,QAAQ,oBAAqBmF,GAClCM,EAASxD,SAAWrC,EAAKuC,SAAS/E,KAClC,IAAIwI,GAAW7G,SAASC,eAAeY,EAAK9F,QAAQyC,GAAGsJ,QAAQ,cAAe,cAC1EC,EAAUpH,eAAakH,EAAU,eACrC,KAAK7N,KAAKsF,QAAQyI,EAAQhE,OAAOiE,YACzBN,EAASxD,SAAS1E,cAAcO,QAAQ,YAAc,GAAM2H,EAASxD,SAAS1E,cAAcO,QAAQ,OAAS,GAC1G2H,EAASxD,SAAS1E,cAAcO,QAAQ,YAAc,KACzDoF,EAAaqC,EAAalD,uBAC1BoD,EAASvI,KAAOV,EAAKU,MAErB0C,EAAKoG,kBAAkB,CACvB,GAAIC,GAAYrG,EAAKoG,iBAAiB5I,MAAMG,eACxC0I,EAAUnI,QAAQ,YAAc,GAAMmI,EAAUnI,QAAQ,OAAS,GAAKmI,EAAUnI,QAAQ,YAAc,KACtGoF,EAAaqC,EAAalD,uBAC1BoD,EAASvI,KAAOV,EAAKU,OAKrC,GAAIgG,EAEA,IADAqC,EAAerC,EAAW8B,oBACTkB,kBACbnO,KAAKoO,aAAaZ,EAAc3F,EAAKuC,SAAUvC,EAAKoG,kBAAkB,EAAMxJ,EAAMiJ,OAEjF,CACD,GAAIW,GAAStH,UAAQyG,EAAc,qBAAqBhJ,EACxDiJ,GAAUzN,KAAKoE,cAAc,SAAWC,OAASc,KAAM,OAAQX,GAAI6J,EAAS,kBAC5Eb,EAAarJ,YAAYsJ,GACrBzN,KAAKsF,QAAQqI,EAAY5D,OAAOrH,UAChC6K,EAAevN,KAAKsF,QAAQqI,EAAY5D,OAAOrH,UAE1CmF,EAAKuC,WACVmD,EAAevN,KAAKyC,gBAAgBzC,KAAKsF,QAAQqI,EAAY5D,OAAO5E,KAAO,YAE/E,IAAIyD,GAAU5I,KAAK+B,QAAQ2E,UAAUX,QAAQ,aAAe,EAAK,QAAU,QACvE4C,EAAe,GAAIS,iBACnBrE,WAAYwI,EACZlE,QAAUC,KAAM,MAAOjE,MAAO,SAC9BkE,YAAavJ,KAAK8I,KAAKC,YAAY,kBACnCS,YAAe+D,EAAa5M,OAAS,EAAKiI,EAAS,OACnDa,OAAQzJ,KAAK0J,YAAYC,KAAK3J,MAC9B+J,MAAO,EACP1E,MAAOZ,EAAOzE,KAAK8I,KAAKC,YAAY/I,KAAKwD,cAAciB,EAAKyF,WAAa,MAE7EvB,GAAaO,SAAS,IAAMmF,EAAS,gBACjCrO,KAAK4J,kBACL6D,EAAQtE,aAAa,OAAQkF,EAAS,YACtChG,YAAUoF,GAAU,WACpBzN,KAAK2D,gBAAgB0K,EAAS,aAAgBxE,UAAU,IAE5D6D,EAASxD,SAAWzF,EAAOA,EAAKyF,SAAW,GACvClK,KAAKqC,gBACLsG,EAAatD,MAAQZ,EAAKyF,SAC1BvB,EAAa2F,WACbZ,EAASvI,KAAOnF,KAAKsF,QAAQqI,EAAY5D,OAAO5E,KAChDuI,EAASxD,SAAWzF,EAAKyF,UAE7BlK,KAAKoO,aAAaZ,EAAcxN,KAAKsF,QAAQqI,EAAY5D,OAAQlC,EAAKoG,kBAAkB,EAAOxJ,EAAMiJ,GAGxG1N,KAAKqC,eACNrC,KAAKkN,YAAYrF,EAAK9F,QAAS8F,EAAK+F,QAI5C/L,EAAa3B,UAAUqO,gBAAkB,SAAUjO,GAC/C,GAAIkO,EACJA,GAAelO,EAAO2M,mBAAmB7F,iBAAiB,kBAC1D,IAAIqH,EACJA,GAAanO,EAAO2M,mBAAmB7F,iBAAiB,gBAExD,KAAK,GADD9B,GAAUtF,KAAKsF,QACVtE,EAAI,EAAG8E,EAAM0I,EAAa7N,OAAQK,EAAI8E,EAAK9E,IAAK,CACrD,GAAIwN,EAAaxN,GAAG0N,UAAUnL,SAAS,aACnCoD,eAAa6H,EAAaxN,GAAI,WAAW4F,UACzC3C,SAAO3D,EAAO2M,mBAAmBjJ,cAAc,SAAWwK,EAAaxN,GAAGwD,SAEzE,IAAIgK,EAAaxN,GAAG0N,UAAUnL,SAAS,kBACxCoD,eAAa6H,EAAaxN,GAAI,gBAAgB4F,cAE7C,IAAI4H,EAAaxN,GAAG0N,UAAUnL,SAAS,WACxCoD,eAAa6H,EAAaxN,GAAI,SAAS4F,cAEtC,IAAI4H,EAAaxN,GAAG0N,UAAUnL,SAAS,oBACxCoD,eAAa6H,EAAaxN,GAAI,kBAAkB4F,UAChD3C,SAAO3D,EAAO2M,mBAAmBjJ,cAAc,SAAWwK,EAAaxN,GAAGwD,SAEzE,IAAIgK,EAAaxN,GAAG0N,UAAUnL,SAAS,gBACxCoD,eAAa6H,EAAaxN,GAAI,cAAc4F,cAE3C,IAAI4H,EAAaxN,GAAG0N,UAAUnL,SAAS,iBACxCoD,eAAa6H,EAAaxN,GAAI,eAAe4F,cAE5C,IAAI4H,EAAaxN,GAAG0F,UAAUX,QAAQ,eAAiB,EAExD,IAAK,GADD4I,GAAUH,EAAaxN,GAAG0F,UACrBkI,EAAI,EAAGC,EAAOvJ,EAAQ3E,OAAQiO,EAAIC,EAAMD,IAC7C,GAAItJ,EAAQsJ,GAAGZ,UAAYW,EAAQ5I,QAAQT,EAAQsJ,GAAG5I,QAAU,EAAG,CAC/DhG,KAAK8O,gBAAgBxJ,EAAQsJ,GAAIJ,EAAaxN,GAAGwD,GACjD,OAIZP,SAAOuK,EAAaxN,IAExB,IAAK,GAAIA,GAAI,EAAG8E,EAAM2I,EAAW9N,OAAQK,EAAI8E,EAAK9E,IAAK,CACnD,GAAIyN,EAAWzN,GAAG0F,UAAUX,QAAQ,eAAiB,EAEjD,IAAK,GADD4I,GAAUF,EAAWzN,GAAG0F,UACnBkI,EAAI,EAAGC,EAAOvJ,EAAQ3E,OAAQiO,EAAIC,EAAMD,IAC7C,GAAItJ,EAAQsJ,GAAGZ,UAAYW,EAAQ5I,QAAQT,EAAQsJ,GAAG5I,QAAU,EAAG,CAC/DhG,KAAK8O,gBAAgBxJ,EAAQsJ,GAAIH,EAAWzN,GAAGwD,GAC/C,OAIZP,SAAOwK,EAAWzN,MAG1Ba,EAAa3B,UAAU4O,gBAAkB,SAAUC,EAAQC,GACvD,GAAIC,GAAOF,EAAOf,SAASpH,OACvBmI,GAAOf,UAAYe,EAAOf,SAASpH,UACf,gBAATqI,IACPA,EAAOC,WAASD,EAAME,UACfC,UAAWJ,IAGlBD,EAAOf,SAASpH,SAAUwI,UAAWJ,MAIjDnN,EAAa3B,UAAUmP,kBAAoB,SAAUtK,EAAYiB,GAG7D,IAAK,GAFDsJ,MACAC,KACKvO,EAAI,EAAGgM,EAAOjI,EAAWpE,OAAQK,EAAIgM,EAAMhM,IAAK,CACrD,GAAIqE,GAAQN,EAAW/D,GAAGgF,GACtBwJ,IACEnK,KAASiK,KACXA,EAASjK,GAAS,EAClBmK,EAAKxJ,GAASX,EACdkK,EAAOtF,KAAKuF,IAGpB,MAAOD,IAEX1N,EAAa3B,UAAUuP,kBAAoB,SAAUhL,EAAMiL,EAAU1O,EAAG2O,GACpE,GAAIC,GAAK5P,KAAKqP,kBAAkBrP,KAAK+E,WAAYN,EAAKuB,MACjC,IAAI6J,gBACrB9K,WAAY,GAAIU,eAAYmK,GAC5BE,MAAO,GAAInK,UAAOlB,EAAKuB,QACvBqD,QAAUC,KAAM7E,EAAKuB,MAAOX,MAAOZ,EAAKuB,OACxCX,MAAOsK,EACPI,KAAM,WACNC,MAAO,QACPvG,OAAQzJ,KAAKmN,YAAYxD,KAAK3J,KAAMgB,KAEzBkI,SAAS,IAAMwG,EAAW,YAAc1O,GACvDqH,YAAUrB,SAASC,eAAeyI,GAAU1L,cAAc,kBAAmB,uBAEjFnC,EAAa3B,UAAU+P,gBAAkB,SAAU3P,EAAQ8J,EAAU3F,EAAMiJ,GACvE,GAAIwC,GAAenJ,UAAQzG,EAAQ,qBAAqB8G,iBAAiB,cACrE8I,GAAavP,OAAS,EAClBX,KAAKqC,cACD+H,EAAS4D,UAA+C,gBAA5B5D,GAAS4D,SAASmC,MAC9CjB,WAAS9E,EAAS4D,SAASmC,MAAOhB,SAAUiB,SAAUF,EAAa,GAAIG,OAAQ5L,EAAKY,QAE/E+E,EAAS4D,UAAY5D,EAAS4D,SAASmC,OAC5C/F,EAAS4D,SAASmC,OAAQC,SAAUF,EAAa,GAAIG,OAAQ5L,EAAKY,QAIlE+E,EAAS4D,UAA+C,gBAA5B5D,GAAS4D,SAASmC,MAC9CjB,WAAS9E,EAAS4D,SAASmC,MAAOhB,SAAUiB,SAAUF,EAAa,KAE9D9F,EAAS4D,UAAY5D,EAAS4D,SAASmC,OAC5C/F,EAAS4D,SAASmC,OAAQC,SAAUF,EAAa,KAKrDlQ,KAAKqC,cACD+H,EAAS4D,UAA+C,gBAA5B5D,GAAS4D,SAASmC,MAC9CjB,WAAS9E,EAAS4D,SAASmC,MAAOhB,SAAUiB,SAAUF,EAAcG,OAAQ5L,EAAKY,QAE5E+E,EAAS4D,UAAY5D,EAAS4D,SAASmC,OAC5C/F,EAAS4D,SAASmC,OAAQC,SAAUF,EAAcG,OAAQ5L,EAAKY,QAI/D+E,EAAS4D,UAA+C,gBAA5B5D,GAAS4D,SAASmC,MAC9CjB,WAAS9E,EAAS4D,SAASmC,MAAOhB,SAAUiB,SAAUF,IAEjD9F,EAAS4D,UAAY5D,EAAS4D,SAASmC,OAC5C/F,EAAS4D,SAASmC,OAAQC,SAAUF,KAKpDrO,EAAa3B,UAAUoQ,eAAiB,SAAUhQ,EAAQ8J,EAAU3F,EAAMiJ,GACtE,GAAItD,EAAS4D,SACThO,KAAKiQ,gBAAgB3P,EAAQ8J,EAAU3F,EAAMiJ,OAE5C,CACD,GAAI6C,GAA8B,YAAlB7C,EAASvI,MACrBuI,EAASxD,UAAYwD,EAASxD,SAAS1E,cAAcO,QAAQ,YAAc,EAAK,EAAI,EACpF2J,EAAW3I,UAAQzG,EAAQ,qBAAqBkE,GAChDgM,MAAc,IACdlQ,EAAOoG,UAAUX,QAAQ,oBAAsB,GAAKzF,EAAOoG,UAAUX,QAAQ,kBAAoB,KACjGyK,EAAclQ,EAAOmG,cAAczC,cAAc,iBAC7ChE,KAAK+B,QAAQ2E,UAAUX,QAAQ,YAAc,IAC7CyK,EAAYtJ,MAAM8I,MAAQ,SAGlC,KAAK,GAAIhP,GAAI,EAAGA,EAAIuP,EAAUvP,IAC1B,OAAQ0M,EAASvI,MACb,IAAK,SAEOwK,EAAgB3P,KAAKqC,cAAgBoC,EAAKY,MAAQ,EACtD,IAA0B,OAAtBqI,EAASxD,UAA2C,UAAtBwD,EAASxD,SAAsB,CACzDuG,EAAczQ,KAAKqC,cAAgBoC,EAAKY,QAC5CrF,MAAKyP,kBAAkBhL,EAAMiL,EAAU1O,EAAGyP,GACtCzQ,KAAK+B,QAAQ2E,UAAUX,QAAQ,YAAc,IAC7CyK,EAAYtJ,MAAM8I,MAAQ,aAG7B,CACD,GAAIU,GAAW,GAAIC,YACfpH,YAAa,QACbqH,MAAO5Q,KAAKmN,YAAYxD,KAAK3J,KAAMgB,IAEvC0P,GAASxH,SAAS,IAAMwG,EAAW,YAAc1O,GACjD0P,EAASrL,MAAQsK,EACjBe,EAASpC,WACLtO,KAAK4J,iBAAmBQ,EAASyG,aACjCH,EAAS3O,QAAQoH,aAAa,OAAQuG,EAAW1O,GACjDqH,YAAUqI,EAAS3O,SAAU,WAC7B/B,KAAK2D,gBAAgB+L,EAAW1O,IAAO6I,UAAU,IAI7D,KACJ,KAAK,SAEO8F,EAAgB3P,KAAKqC,cAAgBoC,EAAKY,MAAQ,CACtD,IAA0B,OAAtBqI,EAASxD,UAA2C,UAAtBwD,EAASxD,SAAsB,CAC7D,GAAIuG,GAAczQ,KAAKqC,cAAgBoC,EAAKY,QAC5CrF,MAAKyP,kBAAkBhL,EAAMiL,EAAU1O,EAAGyP,GACtCzQ,KAAK+B,QAAQ2E,UAAUX,QAAQ,YAAc,IAC7CyK,EAAYtJ,MAAM8I,MAAQ,aAG7B,CACD,GAAIc,GAAU,GAAIC,mBACd1L,MAAOsK,EACPqB,OAAQ,IACRhB,MAAO,OACPvG,OAAQzJ,KAAKmN,YAAYxD,KAAK3J,KAAMgB,IAExC8P,GAAQ5H,SAAS,IAAMwG,EAAW,YAAc1O,GAC5ChB,KAAK4J,kBACLkH,EAAQ/O,QAAQoH,aAAa,OAAQuG,EAAW1O,GAChDqH,YAAUyI,EAAQ/O,SAAU,WAC5B/B,KAAK2D,gBAAgB+L,EAAW1O,IAAO6I,UAAU,IAI7D,KACJ,KAAK,UAEG,GAAIwG,GAASjG,EAASiG,QAAUjG,EAASiG,OAAO1P,OAASyJ,EAASiG,QAAU,OAAQ,SAChFY,GAAUjR,KAAKqC,eAAgB6O,QAAQzM,EAAKY,MAElC,IAAI8L,gBACd9K,MAAOgK,EAAOrP,GACdoH,KAAMsH,EAAW,UACjB0B,QAASH,EACTxH,OAAQzJ,KAAKmN,YAAYxD,KAAK3J,KAAMgB,KAE5BkI,SAAS,IAAMwG,EAAW,YAAc1O,EAExD,MACJ,KAAK,OAEG,GAAI2O,GAAgB3P,KAAKqC,cAAgB,GAAI6D,MAAKzB,EAAKY,OAAS,GAAIa,MAChEmL,EAAW,GAAIC,eACfjM,MAAOsK,EACPqB,OAAQ,YACRvH,OAAQzJ,KAAKmN,YAAYxD,KAAK3J,KAAMgB,IAExCqQ,GAASnI,SAAS,IAAMwG,EAAW,YAAc1O,GAC7ChB,KAAK4J,kBACLyH,EAAStP,QAAQoH,aAAa,OAAQuG,EAAW1O,GACjDhB,KAAK2D,gBAAgB+L,EAAW1O,IAAO6I,UAAU,OAQ7EhI,EAAa3B,UAAUkO,aAAe,SAAU9N,EAAQ8J,EAAUmH,EAAcC,EAAU/M,EAAMiJ,GAC5F,GAAI8D,EAAU,CACV,GAAIC,GAAS9K,eAAarG,EAAO0D,cAAc,SAAU,eACrDoG,GAAS1H,WACT+O,EAAO1M,WAAaqF,EAAS1H,UAC7B+O,EAAO1H,MAAyB,IAAjB0H,EAAO1H,MAAc,EAAI,EACxC0H,EAAOnD,YAEFlE,EAASjF,OACdsM,EAAO1M,WAAa/E,KAAKyC,gBAAgB2H,EAASjF,KAAO,YACzDsM,EAAO1H,MAAyB,IAAjB0H,EAAO1H,MAAc,EAAI,EACxC0H,EAAOnD,YAGf,GAAIoB,GAAW3I,UAAQzG,EAAQ,qBAAqBkE,EAQpD,IAPI+M,GAAgBA,EAAavD,WAC7BhO,KAAK8O,gBAAgByC,EAAc7B,EAAW,cAC9CzL,SAAO3D,EAAO2M,mBAAmBjJ,cAAc,IAAM0L,EAAW,gBAEhE8B,GACAxR,KAAKuO,gBAAgBjO,GAErB8J,EAAS4D,SAAU,CACf0D,MAAU,EAOd,IANItH,EAAS4D,UAAgD,gBAA7B5D,GAAS4D,SAAS7N,OAC9CuR,EAAUxC,WAAS9E,EAAS4D,SAAS7N,OAAQgP,UAExC/E,EAAS4D,UAAY5D,EAAS4D,SAAS7N,SAC5CuR,EAAUtH,EAAS4D,SAAS7N,UAE5BuR,YAAmBC,SACnBD,EAAQlN,GAAKkL,EAAW,aACxBrH,YAAUqJ,GAAU,cACpBrJ,YAAUqJ,GAAU,KAAOtH,EAASpE,OACpC1F,EAAO2M,mBAAmB9I,YAAYuN,OAErC,CACDrJ,WAASqJ,EAAS,aAClB,KAAK,GAAI1Q,GAAI,EAAGgM,EAAO0E,EAAQ/Q,OAAQK,EAAIgM,EAAMhM,IAC7C0Q,EAAQ1Q,GAAGwD,GAAKkL,EAAW,YAAc1O,EACzCV,EAAO2M,mBAAmB9I,YAAYuN,EAAQ1Q,IAGlDhB,KAAK+B,QAAQ2E,UAAUX,QAAQ,YAAc,IAC5BzF,EAAOmG,cAAczC,cAAc,iBACzCkD,MAAM8I,MAAQ,aAI7B,IAAsB,YAAlBtC,EAASvI,MAAsBuI,EAASxD,UAAYwD,EAASxD,SAAS1E,cAAcO,QAAQ,YAAc,EAC1G,IAAS/E,EAAI,EAAGA,EAAI,EAAGA,IAAK,CACpB0Q,MAAU,EACdA,GAAU1R,KAAKoE,cAAc,SAAWC,OAASc,KAAM,OAAQX,GAAIkL,EAAW,YAAc1O,KAC5FV,EAAO2M,mBAAmB9I,YAAYuN,OAGzC,CACD,GAAIA,GAAU1R,KAAKoE,cAAc,SAAWC,OAASc,KAAM,OAAQX,GAAIkL,EAAW,eAClFpP,GAAO2M,mBAAmB9I,YAAYuN,GAG9C1R,KAAKsQ,eAAehQ,EAAQ8J,EAAU3F,EAAMiJ,IAEhD7L,EAAa3B,UAAU0R,aAAe,SAAU7P,EAAS0C,GACrD,GAAIoN,GAAc9P,EAAQ2E,UAAUoL,MAAM,OAAO,GAC7C9Q,EAAI+Q,SAAShQ,EAAQyC,GAAG+H,OAAO,GAAI,EACvC,QAAQsF,GACJ,IAAK,UAGL,IAAK,eAGL,IAAK,QACDpN,EAAKY,MAAQsB,eAAa5E,EAAS8P,GAAaxM,KAChD,MACJ,KAAK,iBACGZ,EAAKyF,SAASnE,QAAQ,YAAc,EACpCtB,EAAKY,MAAMrE,GAAK2F,eAAa5E,EAAS8P,GAAaxM,MAGnDZ,EAAKY,MAAQsB,eAAa5E,EAAS8P,GAAaxM,KAEpD,MACJ,KAAK,aACD,GAAI2L,IAAW7L,KAAM,WAAY6L,OAAQ,YACrCvM,GAAKyF,SAASnE,QAAQ,YAAc,EACpCtB,EAAKY,MAAMrE,GAAK2F,eAAa5E,EAAS8P,GAAaxM,MAGnDZ,EAAKY,MAAQrF,KAAKuC,KAAKyP,WAAWrL,eAAa5E,EAAS8P,GAAaxM,MAAO2L,KAK5FnP,EAAa3B,UAAUgN,YAAc,SAAU5M,EAAQqP,EAAe3O,GAOlE,IANA,GAII2M,GACAP,EALA1F,EAAYX,UAAQzG,EAAQ,sBAC5BmE,EAAOzE,KAAKkI,SAASR,GACrBa,EAAWxB,UAAQzG,EAAQ,qBAC3ByJ,EAAQ,EAGLxB,GAAgD,OAApCA,EAAS+B,wBACxB/B,EAAWA,EAAS+B,uBACpBP,GAGJ,IADAxB,EAAWxB,UAAQzG,EAAQ,qBACvByG,UAAQzG,EAAQ,kBAAmB,CACnCqN,EAAchH,eAAarG,EAAQ,gBACnCmE,EAAKE,MAAMoF,GAAO/D,MAAQhG,KAAKsF,QAAQqI,EAAY5D,OAAO/D,MAC1DvB,EAAKE,MAAMoF,GAAO5E,KAAOnF,KAAKsF,QAAQqI,EAAY5D,OAAO5E,KACzDV,EAAKE,MAAMoF,GAAO1D,MAAQrG,KAAKsF,QAAQqI,EAAY5D,OAAO1D,KAC1D,IAAI4L,GAAclL,UAAQzG,EAAQ,kBAC9ByB,EAAUkQ,EAAYhF,mBAAmBjJ,cAAc,mBACvDkG,EAAWvD,eAAa5E,EAAS,gBAAgBsD,KACrDZ,GAAKE,MAAMoF,GAAOG,SAAWA,GAC7BnI,EAAUkQ,EAAYhF,mBAAmBA,mBAAmBjJ,cAAc,sBAEtEjC,EAAUkQ,EAAYhF,mBAAmBA,mBAAmBjJ,cAAc,kBAE9EoJ,GAAetF,QAASJ,EAAUlD,GAAI8I,SAAUhN,EAAQyH,aAAc4H,EAAe3H,QAAQ,GAC7FhI,KAAKiI,QAAQ,eAAgBmF,GAC7BpN,KAAK4R,aAAa7P,EAAS0C,EAAKE,MAAMoF,IACjCtF,EAAKE,MAAMoF,GAAO/D,MAInBuE,eAAajK,EAAOmG,eAAgB,WAHpC4B,YAAU/H,EAAOmG,eAAgB,eAMpC,IAAIM,UAAQzG,EAAQ,oBAAqB,CAC1CqN,EAAchH,eAAarG,EAAQ,gBACnCmE,EAAKE,MAAMoF,GAAOG,SAAWyD,EAAYtI,KACzC,IAAIwF,OAAY,EAChBA,GAAYtC,EAASnB,iBAAiB,iCACtC3C,EAAKE,MAAMoF,GAAO1E,SAClB+H,GAAetF,QAASJ,EAAUlD,GAAI8I,SAAUhN,EAAQyH,aAAc4H,EAAe3H,QAAQ,GAC7FhI,KAAKiI,QAAQ,kBAAmBmF,GAC3B3I,EAAKE,MAAMoF,GAAOG,SAInBK,eAAajK,EAAOmG,eAAgB,WAHpC4B,YAAU/H,EAAOmG,eAAgB,UAKrC,KAAK,GAAIyL,GAAM,EAAGA,EAAMrH,EAAUlK,OAAQuR,IACtClS,KAAK4R,aAAa/G,EAAUqH,GAAMzN,EAAKE,MAAMoF,QAGhD,IAAIhD,UAAQzG,EAAQ,kBACC,OAAlBqP,EAAwB,CACxB,GAAIrP,EAAOoG,UAAUX,QAAQ,eAAiB,EAAG,CAC7C,GAAIoM,GAAO1N,EAAKE,MAAMoF,GAAOG,SAAS1E,aAClCmK,aAAyB/P,OACpBuS,EAAKpM,QAAQ,OAAS,GAAKoM,EAAKpM,QAAQ,YAAc,GAAMoM,EAAKpM,QAAQ,YAAc,EACxFtB,EAAKE,MAAMoF,GAAO1E,MAAQsK,EAG1BlL,EAAKE,MAAMoF,GAAO1E,MAAQsK,EAAc,GAI5ClL,EAAKE,MAAMoF,GAAO1E,MAAQsK,EAE9BvC,GAAetF,QAASJ,EAAUlD,GAAI8I,SAAUhN,EAAQyH,aAAc4H,EAAe3H,QAAQ,GAC7FhI,KAAKiI,QAAQ,eAAgBmF,OAE5B,IAAI9M,EAAOoG,UAAUX,QAAQ,WAAa,GAAKzF,EAAOoG,UAAUX,QAAQ,cAAgB,EACpFtB,EAAKE,MAAMoF,GAAOG,SAASnE,QAAQ,YAAc,GAC9CtB,EAAKE,MAAMoF,GAAOG,SAASnE,QAAQ,OAAS,GAAKtB,EAAKE,MAAMoF,GAAOG,SAASnE,QAAQ,YAAc,EACtGtB,EAAKE,MAAMoF,GAAO1E,MAAMrE,GAAK2O,EAG7BlL,EAAKE,MAAMoF,GAAO1E,MAAQsK,MAG7B,IAAIrP,EAAOoG,UAAUX,QAAQ,YAAc,EAC5CtB,EAAKE,MAAMoF,GAAO1E,MAAQsK,MAEzB,IAAIrP,EAAOoG,UAAUX,QAAQ,kBAAoB,EAClDtB,EAAKE,MAAMoF,GAAO1E,MAAQsK,MAEzB,IAAIrP,EAAOoG,UAAUX,QAAQ,cAAgB,EAC9CtB,EAAKE,MAAMoF,GAAO1E,MAAQsK,MAEzB,IAAIrP,EAAOoG,UAAUX,QAAQ,iBAAmB,EAAG,CACpD,GAAIqM,GAAUC,cAAY9J,EAASvE,cAAc,wBAAyBoF,gBACtE4H,GAAW7L,KAAM,WAAY6L,OAAQhR,KAAKsF,QAAQ8M,EAAQrI,OAAOiH,QAAU,YAC3EA,GAAO7L,OACFV,EAAKE,MAAMoF,GAAOG,SAASnE,QAAQ,YAAc,GAAOtB,EAAKE,MAAMoF,GAAOG,SAASnE,QAAQ,OAAS,GAClGtB,EAAKE,MAAMoF,GAAOG,SAASnE,QAAQ,YAAc,EACpDtB,EAAKE,MAAMoF,GAAO1E,MAAMrE,GAAKhB,KAAKuC,KAAKyP,WAAWrC,EAAeqB,GAGjEvM,EAAKE,MAAMoF,GAAO1E,MAAQrF,KAAKuC,KAAKyP,WAAWrC,EAAeqB,IAIrEvM,EAAKE,MAAMoF,GAAO1E,MAInBkF,eAAajK,EAAOmG,eAAgB,WAHpC4B,YAAU/H,EAAOmG,eAAgB,aAQjD5E,EAAa3B,UAAU8J,eAAiB,SAAUsI,EAAU7N,EAAM8N,GAC9D,GAAIC,GAAW/N,EAAKE,KACpB,KAAK4N,GAAUC,EAASF,GAAW,CAE/B,IADA7N,EAAO+N,EAASF,IACP3N,MACL,MAAOF,EAGP,KAAK,GAAImK,GAAI0D,EAAW,EAAGzD,EAAO2D,EAAS7R,OAAQiO,EAAIC,EAAMD,IAEzD,IADAnK,EAAO+N,EAAS5D,IACPjK,MACL,MAAOF,GAKvB,MAAOA,IAQX5C,EAAa3B,UAAU0G,QAAU,WAC7B,GAAI7E,GACAf,EACA8E,CAGJ,KADAA,GADA/D,EAAU/B,KAAK+B,QAAQqF,iBAAiB,oBAC1BzG,OACTK,EAAI,EAAGA,EAAI8E,EAAK9E,IACjB2F,eAAa5E,EAAQf,GAAI,gBAAgB4F,UACzC3C,SAAOlC,EAAQf,GAEnBhB,MAAK8D,QACL9D,KAAKyS,gBAMT5Q,EAAa3B,UAAUwS,SAAW,SAAUjO,EAAMqD,GAC9C,GAAID,IAASC,QAASA,EAASwF,SAAU,GACzCtN,MAAKiI,QAAQ,aAAcJ,EAC3B,KAAK,GAAI7G,GAAI,EAAG8E,EAAMrB,EAAK9D,OAAQK,EAAI8E,EAAK9E,IACxChB,KAAKsI,eAAetB,SAASC,eAAea,GAAUrD,EAAKzD,KAOnEa,EAAa3B,UAAUsM,UAAY,SAAUmG,EAAQ7K,GACjD,GAAIJ,GAAYV,SAASC,eAAea,GACpCrD,EAAOzE,KAAKkI,SAASR,GACrBkL,EAAWD,EAAOhS,OAClBkH,GAASC,QAASA,EAEtB,IADA9H,KAAKiI,QAAQ,aAAcJ,GACvB+K,EACA,IAAK,GAAI5R,GAAI,EAAG8E,EAAM6M,EAAOhS,OAAQK,EAAI8E,EAAK9E,IAC1ChB,KAAK6S,YAAYF,EAAO3R,GAAI0G,OAIhCjD,GAAKE,MAAMsF,MAAOvF,UAAa,MAAOC,YAG9C9C,EAAa3B,UAAU4S,YAAc,WA+BjC,GA9BI9S,KAAKiM,UACL5D,YAAUrI,KAAK+B,SAAU/B,KAAKiM,UAE9BjM,KAAK+S,WACL1K,YAAUrI,KAAK+B,SAAU,SAEzB/B,KAAKgQ,QACLhQ,KAAK+B,QAAQmF,MAAM8I,MAAQhQ,KAAKgQ,OAEhChQ,KAAK4I,SACL5I,KAAK+B,QAAQmF,MAAM0B,OAAS5I,KAAK4I,QAEjC5I,KAAKyE,KAAKE,MAAMhE,OAChBX,KAAKqC,eAAgB,EAGrBrC,KAAKqH,iBAAgB,EAAOrH,KAAK+B,SAEjCiR,UAAQC,UAAiC,aAArBjT,KAAKyI,aACrBuK,UAAQC,WACRjT,KAAK+B,QAAQmF,MAAM8I,MAAQ,OAC3BhQ,KAAK+B,QAAQ2M,UAAUwE,IAAI,aAE/B3I,cAAYvD,SAASI,iBAAiB,qBAAsB,qBAC5DiB,WAASrB,SAASI,iBAAiB,qBAAsB,mBACzDpH,KAAKyI,YAAc,YAGnBzI,KAAKyI,YAAc,aAEnBzI,KAAKqC,eAAiBrC,KAAKmT,YAC3BnT,KAAKoT,oBAEJ,CACD,GAAIpT,KAAKsF,QAAQ3E,QAAUX,KAAKqC,cAAe,CAC3CrC,KAAKqH,iBAAgB,EAAOrH,KAAK+B,QAAS/B,KAAKyE,KAAKC,UACpD,IAAI4C,GAASC,YAAWvH,KAAKyE,SAAU,EACvCzE,MAAKwH,cAAcF,OAEdtH,MAAKsF,QAAQ3E,QAClBX,KAAKsI,eAAetI,KAAK+B,QAAQiC,cAAc,yBAInD,KAAK,GAFDqP,GAAUrM,SAASI,iBAAiB,eACpCkM,MAAS,GACJtS,EAAI,EAAGA,EAAIqS,EAAQ1S,OAAQK,IAChCsS,EAASD,EAAQzF,KAAK5M,GACtBkL,eAAaoH,GAAUnH,SAAU,aAI7CtK,EAAa3B,UAAUkT,cAAgB,WACnC,GAAIG,GAAcvT,KAAKoE,cAAc,OAASC,OAASC,MAAO,oBACtDE,GAAIxE,KAAK+B,QAAQyC,GAAK,sBAC1BgP,EAAWxT,KAAKoE,cAAc,YAAcC,OAASC,MAAO,iBAAkBmP,SAAU,UACxFC,EAAW1T,KAAKoE,cAAc,UAAYC,OAASC,MAAO,wCAC9DiP,GAAYpP,YAAYqP,GACxBA,EAAS7L,YAAc3H,KAAK4H,gBAAgB5H,KAAKyE,MACjDiP,EAAS/L,YAAc3H,KAAK8I,KAAKC,YAAY,QAC7CwK,EAAYpP,YAAYuP,GACxB1T,KAAK+B,QAAQoC,YAAYoP,IAE7B1R,EAAa3B,UAAUuH,sBAAwB,WAC3C,GAAIkM,GAAe3T,KAAKoE,cAAc,UAAYC,OAC1CC,MAAO,4CAEfqP,GAAaxP,YAAYnE,KAAKoE,cAAc,QAAUC,OAASC,MAAO,yCACtEtE,KAAK+B,QAAQiC,cAAc,mBAAmBG,YAAYwP,IAE9D9R,EAAa3B,UAAU0T,kBAAoB,SAAUC,EAASC,GAE1D,IAAK,GAAIC,GAAK,EAAGC,EADAvU,OAAOwF,KAAK4O,GACeE,EAAKC,EAAarT,OAAQoT,IAElE,OADWC,EAAaD,IAEpB,IAAK,cACD,GAAIrM,GAAY1H,KAAK+B,QAAQiC,cAAc,sBACvCiQ,EAAcjU,KAAK+B,QAAQiC,cAAc,qBACzC6P,GAAQV,aACRzL,EAAUR,MAAMC,QAAU,OACtBnH,KAAK+B,QAAQqF,iBAAiB,sBAAsBzG,OAAS,GAC7DX,KAAKoT,gBACLa,EAAcjU,KAAK+B,QAAQiC,cAAc,uBAGzChE,KAAK+B,QAAQiC,cAAc,mBAAmB2D,YAAc3H,KAAK4H,gBAAgB5H,KAAKyE,MAE1FwP,EAAY/M,MAAMC,QAAU,UAGxBO,EAAUN,iBAAiB,oBAAoBzG,QAAU,GACzDX,KAAKyH,wBAETC,EAAUR,MAAMC,QAAU,QAC1B8M,EAAY/M,MAAMC,QAAU,OAEhC,MACJ,KAAK,cAC2B,eAAxB0M,EAAQpL,aACRJ,WAASrI,KAAK+B,QAAQqF,iBAAiB,qBAAsB,qBAC7DmD,cAAYvK,KAAK+B,QAAQqF,iBAAiB,qBAAsB,qBAGhEiB,WAASrI,KAAK+B,QAAQqF,iBAAiB,qBAAsB,mBAC7DmD,cAAYvK,KAAK+B,QAAQqF,iBAAiB,qBAAsB,qBAEpE,MACJ,KAAK,cACGyM,EAAQK,YAAYC,WACpB5J,cAAYvK,KAAK+B,QAAQqF,iBAAiB,iBAAkB,iBAG5DiB,WAASrI,KAAK+B,QAAQqF,iBAAiB,iBAAkB,iBAEzDyM,EAAQK,YAAYE,YACpB7J,cAAYvK,KAAK+B,QAAQqF,iBAAiB,iBAAkB,iBAG5DiB,WAASrI,KAAK+B,QAAQqF,iBAAiB,iBAAkB,gBAE7D,MACJ,KAAK,WACG0M,EAAQ7H,UACR1B,eAAavK,KAAK+B,SAAU+R,EAAQ7H,SAAS6F,MAAM,MAEnD+B,EAAQ5H,UACR5D,YAAUrI,KAAK+B,SAAU8R,EAAQ5H,SAAS6F,MAAM,KAEpD,MACJ,KAAK,YACG+B,EAAQd,UACR/S,KAAK+B,QAAQ2M,UAAUwE,IAAI,SAG3BlT,KAAK+B,QAAQ2M,UAAU2F,OAAO,QAElC,MACJ,KAAK,oBACDrU,KAAKsU,kBAAoBT,EAAQS,iBACjC,MACJ,KAAK,aACDtU,KAAK+E,WAAa8O,EAAQ9O,UAC1B,MACJ,KAAK,UACD/E,KAAKsF,QAAUuO,EAAQvO,QACkB,cAArCtF,KAAKuF,cAAcC,cACnBxF,KAAKsF,QAAU,GAAIG,eAAYzF,KAAKsF,SAASI,cAAa,GAAIC,UAAQE,OAAO,UAEnC,eAArC7F,KAAKuF,cAAcC,gBACxBxF,KAAKsF,QAAU,GAAIG,eAAYzF,KAAKsF,SAASI,cAAa,GAAIC,UAAQC,WAAW,UAErF,MACJ,KAAK,gBACD5F,KAAKuF,cAAgBsO,EAAQtO,aAC7B,MACJ,KAAK,gBACDvF,KAAKyL,cAAgBoI,EAAQpI,aAC7B,MACJ,KAAK,SACDzL,KAAK4I,OAASiL,EAAQjL,OACtB5I,KAAK+B,QAAQmF,MAAM0B,OAAS5I,KAAK4I,MACjC,MACJ,KAAK,QACD5I,KAAKyE,KAAOoP,EAAQpP,IACpB,MACJ,KAAK,QACDzE,KAAKgQ,MAAQ6D,EAAQ7D,MACrBhQ,KAAK+B,QAAQmF,MAAM8I,MAAQhQ,KAAKgQ,KAChC,MACJ,KAAK,SACDhQ,KAAKuU,OAASV,EAAQU,SAKtC1S,EAAa3B,UAAUsU,UAAY,WAC/BxU,KAAKyU,eACDC,WAAY,cACZC,SAAU,YACVC,SAAU,WACVC,MAAO,QACPC,SAAU,YACVC,SAAU,YACVC,gBAAiB,qBACjBC,YAAa,eACbC,mBAAoB,wBACpBC,QAAS,UACTC,WAAY,cACZC,MAAO,QACPC,SAAU,YACVC,GAAI,KACJC,MAAO,SACPC,YAAa,eACbC,OAAQ,SACRC,YAAa,iBACbC,eAAgB,kBAChBC,WAAY,wBACZC,YAAa,eACbC,SAAU,YACVC,aAAc,gBACdC,KAAM,QAEVjW,KAAK8I,KAAO,GAAIoN,QAAK,eAAgBlW,KAAKyU,cAAezU,KAAKuU,QAC9DvU,KAAKyC,iBACD0T,iBACM9Q,MAAO,aAAc9E,IAAKP,KAAK8I,KAAKC,YAAY,gBAChD1D,MAAO,WAAY9E,IAAKP,KAAK8I,KAAKC,YAAY,cAC9C1D,MAAO,WAAY9E,IAAKP,KAAK8I,KAAKC,YAAY,cAC9C1D,MAAO,QAAS9E,IAAKP,KAAK8I,KAAKC,YAAY,WAC3C1D,MAAO,WAAY9E,IAAKP,KAAK8I,KAAKC,YAAY,cAC9C1D,MAAO,KAAM9E,IAAKP,KAAK8I,KAAKC,YAAY,QACxC1D,MAAO,QAAS9E,IAAKP,KAAK8I,KAAKC,YAAY,WAEjDqN,eACM/Q,MAAO,QAAS9E,IAAKP,KAAK8I,KAAKC,YAAY,WAC3C1D,MAAO,cAAe9E,IAAKP,KAAK8I,KAAKC,YAAY,iBACjD1D,MAAO,qBAAsB9E,IAAKP,KAAK8I,KAAKC,YAAY,wBACxD1D,MAAO,WAAY9E,IAAKP,KAAK8I,KAAKC,YAAY,cAC9C1D,MAAO,kBAAmB9E,IAAKP,KAAK8I,KAAKC,YAAY,qBACrD1D,MAAO,WAAY9E,IAAKP,KAAK8I,KAAKC,YAAY,cAEpDsN,kBACMhR,MAAO,QAAS9E,IAAKP,KAAK8I,KAAKC,YAAY,WAC3C1D,MAAO,WAAY9E,IAAKP,KAAK8I,KAAKC,YAAY,cAEpDuN,iBACMjR,MAAO,QAAS9E,IAAKP,KAAK8I,KAAKC,YAAY,WAC3C1D,MAAO,qBAAsB9E,IAAKP,KAAK8I,KAAKC,YAAY,wBACxD1D,MAAO,cAAe9E,IAAKP,KAAK8I,KAAKC,YAAY,iBACjD1D,MAAO,UAAW9E,IAAKP,KAAK8I,KAAKC,YAAY,aAC7C1D,MAAO,WAAY9E,IAAKP,KAAK8I,KAAKC,YAAY,cAC9C1D,MAAO,aAAc9E,IAAKP,KAAK8I,KAAKC,YAAY,gBAChD1D,MAAO,kBAAmB9E,IAAKP,KAAK8I,KAAKC,YAAY,qBACrD1D,MAAO,WAAY9E,IAAKP,KAAK8I,KAAKC,YAAY,cAC9C1D,MAAO,KAAM9E,IAAKP,KAAK8I,KAAKC,YAAY,QACxC1D,MAAO,QAAS9E,IAAKP,KAAK8I,KAAKC,YAAY,aAIzDlH,EAAa3B,UAAUqW,OAAS,WAC5BvW,KAAKuE,aACLvE,KAAK0M,QAEGpD,KAAMtJ,KAAK8I,KAAKC,YAAY,YAC5BiD,QAAS,kCAGT1C,KAAMtJ,KAAK8I,KAAKC,YAAY,gBAC5BiD,QAAS,iCAGjBhM,KAAKuI,SAAWvI,KAAKkL,eACrBlL,KAAK0H,UAAY1H,KAAKwK,gBACtBxK,KAAK8S,cACL9S,KAAK8E,aACL9E,KAAKwW,cAET3U,EAAa3B,UAAUsW,WAAa,WAChC,GAAIC,GAAUzW,KAAK4E,YACnB8R,gBAAaxD,IAAIuD,EAAS,QAASzW,KAAKsG,kBAAmBtG,OAE/D6B,EAAa3B,UAAUuS,aAAe,WAClC,GAAIgE,GAAUzW,KAAK4E,YACnB8R,gBAAarC,OAAOoC,EAAS,QAASzW,KAAKsG,oBAE/CzE,EAAa3B,UAAUgI,SAAW,SAAU5H,EAAQqW,GAIhD,IAAK,GAHDjO,GAAa1I,KAAKuE,UAAUjE,EAAOkE,IACnCsB,EAAM6Q,EAAWjO,EAAW/H,OAAS,EAAI+H,EAAW/H,OACpD8D,EAAOzE,KAAKyE,KACPzD,EAAI,EAAGA,EAAI8E,EAAK9E,IACrByD,EAAOzE,KAAKgK,eAAetB,EAAW1H,GAAIyD,EAAY,IAANzD,EAEpD,OAAOyD,IAEX5C,EAAa3B,UAAU4G,YAAc,SAAUxG,GAC3C,GAIIU,GACA8E,EALA4B,EAAYpH,EACZsW,EAAUlP,EAAUlD,GACpBC,EAAOzE,KAAKkI,SAASR,GAAW,GAChCqC,EAAQ,EAGRlC,GAASC,QAAS8O,EAAStJ,SAAUsJ,EACzC5W,MAAKiI,QAAQ,cAAeJ,EAC5B,IAAI9F,GAAU2F,EAAUN,iBAAiB,qBACzC,KAAKpG,EAAI,EAAG8E,EAAM/D,EAAQpB,OAAQK,EAAI8E,EAAK9E,UAChChB,MAAKuE,UAAUxC,EAAQf,GAAGwD,GAErC,MAA4C,OAArCkD,EAAU4C,wBACb5C,EAAYA,EAAU4C,uBACtBP,GAEJtF,GAAKE,MAAMkS,OAAO9M,EAAO,SAClB/J,MAAKuE,UAAUqS,GACtB3S,SAAO3D,IAEXuB,EAAa3B,UAAU2G,WAAa,SAAUvG,GAO1C,IANA,GAAIoH,GAAYX,UAAQzG,EAAQ,sBAC5BmE,EAAOzE,KAAKkI,SAASR,GACrBa,EAAWxB,UAAQzG,EAAQ,qBAC3BwW,EAAcvO,EACdV,GAASC,QAASJ,EAAUlD,GAAI8I,SAAU/E,EAAS/D,IACnDuF,EAAQ,EAC+B,OAApCxB,EAAS+B,wBACZ/B,EAAWA,EAAS+B,uBACpBP,GAEJtF,GAAKE,MAAMkS,OAAO9M,EAAO,GACzB/J,KAAKiI,QAAQ,aAAcJ,GAC3B5D,SAAO6S,IAEXjV,EAAa3B,UAAUsH,cAAgB,SAAU/C,GAC7CzE,KAAK8D,QACL9D,KAAKkC,eAAiB,EACtBlC,KAAKmC,cAAgB,EACrBnC,KAAKqC,eAAgB,EACrBrC,KAAKyE,KAAOA,EACZzE,KAAK6S,YAAY7S,KAAKyE,KAAMzE,KAAK+B,QAAQiC,cAAc,uBAAuB,IAMlFnC,EAAa3B,UAAU6W,SAAW,SAAUtS,GACxC,GAAI6C,GAASC,YAAW9C,MAAU,EAClCzE,MAAKwH,cAAcF,IAMvBzF,EAAa3B,UAAU8W,SAAW,WAC9B,MAAOhX,MAAKyE,MAMhB5C,EAAa3B,UAAU+W,aAAe,SAAUnP,GAC5C,GAAI9G,GACA8E,EAAMgC,EAAQnH,MAClB,KAAKK,EAAI,EAAGA,EAAI8E,EAAK9E,IACjBhB,KAAK8G,YAAYE,SAASC,eAAea,EAAQ9G,MAOzDa,EAAa3B,UAAUgX,mBAAqB,WACxC,GAAIpH,IAAQ,GAAInK,UAAQwR,MAAMnX,KAAKoX,aAAapX,KAAKyE,OACjD4S,IAOJ,OANA,IAAI5R,eAAYzF,KAAK+E,YAAYuS,aAAaxH,GACzCyH,KAAK,SAAUC,GAChBA,EAAEjI,OAAOkI,QAAQ,SAAUjI,GACvB6H,EAAWpN,KAAKuF,OAGjB6H,GAMXxV,EAAa3B,UAAUwX,YAAc,SAAUpK,GAC3C,GAAItM,GACA8E,EAAMwH,EAAS3M,MACnB,KAAKK,EAAI,EAAGA,EAAI8E,EAAK9E,IACjBhB,KAAK6G,WAAWG,SAASC,eAAeqG,EAAStM,MAOzDa,EAAa3B,UAAUyX,oBAAsB,SAAUlT,GAInD,IAAK,GAHDmT,GAAY5X,KAAKoX,aAAa3S,GAE9B4E,KACKrI,EAAI,EAAG8E,EAAMrG,OAAOwF,KAAKjF,KAAKsF,SAAUtE,EAAI8E,EAAInF,OAAQK,IAC7DqI,EAAOY,KAAKjK,KAAKsF,QAAQtE,GAAGgF,MAQhC,OANIvB,GAAKE,MAAMhE,QACH,GAAIgF,UAAQiH,OAAOvD,GAAQ8N,MAAMS,IAGjC,GAAIjS,UAAQiH,OAAOvD,IAQnCxH,EAAa3B,UAAUkX,aAAe,SAAU3S,GAM5C,IAAK,GAJDoT,GACAC,EACAC,EAHAvF,EAAW/N,EAAKE,MAIhBqT,GAAa,EACRhX,EAAI,EAAG8E,EAAM0M,EAAS7R,OAAQK,EAAI8E,EAAK9E,IAE5C,GADWvB,OAAOwF,KAAKuN,EAASxR,IACvB+E,QAAQ,UAAY,GACzB+R,EAAQ9X,KAAKoX,aAAa5E,EAASxR,OAG3B6W,EADmB,QAAnBpT,EAAKC,UACEmT,EAAKI,IAAIH,GAGTD,EAAKK,GAAGJ,QAItB,IAAItF,EAASxR,GAAGkJ,SAASvJ,OAAQ,CAE9BoX,EADqB,SAArBvF,EAASxR,GAAGmE,KACA,GAAIe,MAAKsM,EAASxR,GAAGqE,OAGrBmN,EAASxR,GAAGqE,KAE5B,IAAI8M,GAAOK,EAASxR,GAAGkJ,SAAS1E,aAEhC,IADAwS,EAAuB,aAAT7F,GAAgC,eAATA,GAAkC,aAATA,EACpD,IAANnR,GACKmR,EAAKpM,QAAQ,OAAS,GAAKoM,EAAKpM,QAAQ,YAAc,IAAe,aAAToM,EAC7D0F,EAAO7X,KAAKmY,eAAe3F,EAASxR,IAItB,MADVqE,EAAQ0S,KAERF,EAAO,GAAIO,aAAU5F,EAASxR,GAAGgF,MAAOwM,EAASxR,GAAGkJ,SAAU6N,EAAWC,QAKjF,IAAuB,QAAnBvT,EAAKC,UACL,IAAKyN,EAAKpM,QAAQ,OAAS,GAAKoM,EAAKpM,QAAQ,YAAc,IAAe,aAAToM,EAC7D0F,EAAO7X,KAAKmY,eAAe3F,EAASxR,GAAI6W,EAAMpT,EAAKC,eAElD,CACGW,EAAQ0S,CACRF,IAAkB,KAAVxS,IACRwS,EAAOA,EAAKI,IAAIzF,EAASxR,GAAGgF,MAAOwM,EAASxR,GAAGkJ,SAAU6N,EAAWC,QAK5E,KAAK7F,EAAKpM,QAAQ,OAAS,GAAKoM,EAAKpM,QAAQ,YAAc,IAAe,aAAToM,EAC7D0F,EAAO7X,KAAKmY,eAAe3F,EAASxR,GAAI6W,EAAMpT,EAAKC,eAElD,CACD,GAAIW,GAAQ0S,CACRF,IAAkB,KAAVxS,IACRwS,EAAOA,EAAKK,GAAG1F,EAASxR,GAAGgF,MAAOwM,EAASxR,GAAGkJ,SAAU6N,EAAWC,KAO3F,MAAOH,IAEXhW,EAAa3B,UAAUiY,eAAiB,SAAU3F,EAAUoF,EAAWlT,GAGnE,IAAK,GADDmT,GADAxS,EAAQmN,EAASnN,MAEZuJ,EAAI,EAAGC,EAAOxJ,EAAM1E,OAAQiO,EAAIC,EAAMD,IAC3C,GAAiB,KAAbvJ,EAAMuJ,GACN,GAAU,IAANA,EACA,OAAQ4D,EAAStI,UACb,IAAK,UACD2N,EAAO,GAAIO,aAAU5F,EAASxM,MAAO,cAAeX,EAAMuJ,GAC1D,MACJ,KAAK,aACDiJ,EAAO,GAAIO,aAAU5F,EAASxM,MAAO,WAAYX,EAAMuJ,GACvD,MACJ,KAAK,KACDiJ,EAAO,GAAIO,aAAU5F,EAASxM,MAAO,QAASX,EAAMuJ,GACpD,MACJ,KAAK,QACDiJ,EAAO,GAAIO,aAAU5F,EAASxM,MAAO,WAAYX,EAAMuJ,QAK/D,QAAQ4D,EAAStI,UACb,IAAK,UACD2N,EAAOA,EAAKI,IAAIzF,EAASxM,MAAO,WAAYX,EAAMuJ,GAClD,MACJ,KAAK,aACDiJ,EAAOA,EAAKK,GAAG1F,EAASxM,MAAO,cAAeX,EAAMuJ,GACpD,MACJ,KAAK,KACDiJ,EAAOA,EAAKK,GAAG1F,EAASxM,MAAO,QAASX,EAAMuJ,GAC9C,MACJ,KAAK,QACDiJ,EAAOA,EAAKI,IAAIzF,EAASxM,MAAO,WAAYX,EAAMuJ,IAiBtE,MAXIiJ,KAEID,EADc,QAAdlT,EACYkT,EAAUK,IAAIJ,GAEP,OAAdnT,EACOkT,EAAUM,GAAGL,GAGbA,GAGbD,GAEX/V,EAAa3B,UAAU2S,YAAc,SAAUpO,EAAM4T,EAAYC,GACxDA,IACDD,EAAarY,KAAKuY,YAAY9T,EAAKC,UAAW2T,GAGlD,KAAK,GADD7F,GAAW/N,EAAKE,MACX3D,EAAI,EAAG8E,EAAM0M,EAAS7R,OAAQK,EAAI8E,EAAK9E,IACjCvB,OAAOwF,KAAKuN,EAASxR,IACvB+E,QAAQ,UAAY,GACzBsS,EAAarY,KAAKuY,YAAY/F,EAASxR,GAAG0D,UAAW2T,GACrDA,EAAarY,KAAK6S,YAAYL,EAASxR,GAAIqX,GAAY,IAGvDrY,KAAKwY,WAAWhG,EAASxR,GAAIqX,EAOrC,QAJAA,EAAatR,UAAQsR,EAAY,mBAE7BA,EAAatR,UAAQsR,EAAY,uBAE9BA,GAEXxW,EAAa3B,UAAUqY,YAAc,SAAU7T,EAAW2T,GACtDrY,KAAKqH,iBAAgB,EAAMgR,EAAY3T,EACvC,IAAI3C,GAAUsW,EAAWjR,iBAAiB,qBAC1C,OAAOrF,GAAQA,EAAQpB,OAAS,IAEpCkB,EAAa3B,UAAUsY,WAAa,SAAU/T,EAAM4T,GAC5CA,EAAW3R,UAAUX,QAAQ,sBAAwB,EACrD/F,KAAKsI,eAAe+P,EAAY5T,GAGhCzE,KAAKsI,eAAe+P,EAAWrU,cAAc,sBAAuBS,IAG5E5C,EAAa3B,UAAUuY,aAAe,SAAU9T,EAAO+T,GACnD,GAAInG,IAAS,CACRmG,GAKDA,GAAY,KAJZA,EAAW,GACXnG,GAAS,EAMb,KAAK,GADD7N,GAAYC,EAAMD,UACbkK,EAAI,EAAGC,EAAOlK,EAAMA,MAAMhE,OAAQiO,EAAIC,EAAMD,IAAK,CACtD,GAAIjK,EAAMA,MAAMiK,GAAGjK,MACf+T,EAAW1Y,KAAKyY,aAAa9T,EAAMA,MAAMiK,GAAI8J,OAE5C,CACD,GAAIjU,GAAOE,EAAMA,MAAMiK,GACnB+J,EAAW,EACXlU,GAAKY,gBAAiBzF,OACtB+Y,GAAY,IAAMlU,EAAKY,MAAQ,IAGT,eAAlBZ,EAAKyF,SACLyO,GAAY,KAAOlU,EAAKY,MAAQ,MAET,aAAlBZ,EAAKyF,SACVyO,GAAY,MAAQlU,EAAKY,MAAQ,KAEV,aAAlBZ,EAAKyF,SACVyO,GAAY,MAAQlU,EAAKY,MAAQ,MAGf,WAAdZ,EAAKU,KACLwT,GAAYlU,EAAKY,MAGjBsT,GAAY,IAAMlU,EAAKY,MAAQ,IAI3CqT,GAAYjU,EAAKuB,MAAQ,IAAMhG,KAAK0C,UAAU+B,EAAKyF,UAAY,IAAMyO,EAErE/J,IAAMC,EAAO,IACb6J,GAAY,IAAMhU,EAAY,KAMtC,MAHK6N,KACDmG,GAAY,KAETA,GAKX7W,EAAa3B,UAAU0Y,gBAAkB,SAAUC,GAC/C,GAAIC,GAAY9Y,KAAK+Y,gBAAgBF,EACrC7Y,MAAK+W,UAAWrS,UAAWoU,EAAUpU,UAAWC,MAAOmU,EAAUnU,SAMrE9C,EAAa3B,UAAU6Y,gBAAkB,SAAUF,GAI/C,MAHA7Y,MAAKsC,UACLtC,KAAKgZ,UAAUH,GACf7Y,KAAKyE,MAASC,UAAW,GAAIC,UACtB3E,KAAKiZ,cAAcjZ,KAAKsC,OAAQtC,KAAKyE,MAAO,KAMvD5C,EAAa3B,UAAU0H,gBAAkB,SAAUnD,GAC/C,MAAOzE,MAAKyY,aAAahU,GAAMqJ,QAAQ,KAAM,MAEjDjM,EAAa3B,UAAU8Y,UAAY,SAAUH,GACzC,GACIK,GADAC,EAAK,CAET,IACID,EAAML,EAAUtM,MAAM4M,GACtBA,GAAMnZ,KAAKoZ,gBAAgBF,SACd,KAARA,EACT,OAAOlZ,MAAKsC,QAEhBT,EAAa3B,UAAUkZ,gBAAkB,SAAUP,GAQ/C,IAAK,GAHDQ,GAEAC,EANA5W,GAAa,IAAK,KAAM,IAAK,IAAK,KAAM,MACxC6W,GAAc,MAAO,MAErBC,GAAS,KAAM,SAAU,OAAQ,YAI5BxY,EAAI,EAAGgM,EAAOtK,EAAU/B,OAAQK,EAAIgM,EAAMhM,IAG/C,GAFAqY,EAAW,QAAQI,KAAK/W,EAAU1B,IAAM,MAAQ,GACxC,GAAI0Y,QAAO,KAAOhX,EAAU1B,GAAK,IAAMqY,EAAU,MAC/CM,KAAKd,GAEX,MADA7Y,MAAKsC,OAAO2H,MAAM,YAAavH,EAAU1B,GAAGwE,gBACrC9C,EAAU1B,GAAGL,MAG5B,KAAK,GAAIK,GAAI,EAAGgM,EAAOuM,EAAW5Y,OAAQK,EAAIgM,EAAMhM,IAGhD,GAFAqY,EAAW,QAAQI,KAAKF,EAAWvY,IAAM,MAAQ,GACzC,GAAI0Y,QAAO,KAAOH,EAAWvY,GAAK,IAAMqY,EAAU,MAChDM,KAAKd,GAEX,MADA7Y,MAAKsC,OAAO2H,MAAM,aAAcsP,EAAWvY,GAAGwE,gBACvC+T,EAAWvY,GAAGL,MAG7B,KAAK,GAAIK,GAAI,EAAGgM,EAAOwM,EAAM7Y,OAAQK,EAAIgM,EAAMhM,IAG3C,GAFAqY,EAAW,QAAQI,KAAKD,EAAMxY,IAAM,MAAQ,GACpC,GAAI0Y,QAAO,KAAOF,EAAMxY,GAAK,IAAMqY,EAAU,MAC3CM,KAAKd,GAEX,MADA7Y,MAAKsC,OAAO2H,MAAM,eAAgBuP,EAAMxY,GAAGwE,gBACpCgU,EAAMxY,GAAGL,MAIxB,OAAI,MAAMgZ,KAAKd,IACX7Y,KAAKsC,OAAO2H,MAAM,OAAQ,MACnB,GAGP,MAAM0P,KAAKd,IACX7Y,KAAKsC,OAAO2H,MAAM,QAAS,MACpB,GAGP,qEAAqE0P,KAAKd,IAC1ES,EAAa,qEAAqEK,KAAKd,GAAW,GAClG7Y,KAAKsC,OAAO2H,MAAM,UAAWqP,IACtBA,EAAW3Y,QAGlB,iCAAiCgZ,KAAKd,IACtCS,EAAa,iCAAiCK,KAAKd,GAAW,GAC9D7Y,KAAKsC,OAAO2H,MAAM,SAAUqP,IACrBA,EAAW3Y,QAGlB,8BAA8BgZ,KAAKd,IACnCS,EAAa,8BAA8BK,KAAKd,GAAW,GAC3D7Y,KAAKsC,OAAO2H,MAAM,eAAgBqP,IAC3BA,EAAW3Y,QAGlB,qBAAqBgZ,KAAKd,IAC1BS,EAAa,qBAAqBK,KAAKd,GAAW,GAClD7Y,KAAKsC,OAAO2H,MAAM,SAAUqP,IACrBA,EAAW3Y,QAEf,GAEXkB,EAAa3B,UAAU0Z,YAAc,SAAUvU,EAAO6E,GAClD,GAAIxH,IACAmX,IAAK,QAASC,KAAM,WAAYC,IAAK,WAAYC,IAAK,cAAeC,KAAM,kBAC3EC,KAAM,qBAEV,OAA2B,KAAvB7U,EAAMU,QAAQ,MAAcV,EAAMU,QAAQ,OAASV,EAAM1E,OAAS,EAC3D,WAEqB,IAAvB0E,EAAMU,QAAQ,MAAcV,EAAMU,QAAQ,OAASV,EAAM1E,OAAS,EAChE,aAEqB,IAAvB0E,EAAMU,QAAQ,MAAcV,EAAMU,QAAQ,OAASV,EAAM1E,OAAS,EAChE,WAEJ+B,EAAUwH,IAErBrI,EAAa3B,UAAU+Y,cAAgB,SAAU3W,EAAQqC,EAAOJ,GAa5D,IAAK,GAZDE,GAGA0V,EACAvL,EACAC,EACAuL,EACAC,EACAC,EACAC,EACAC,EACAtQ,EAVAuQ,KACAC,KAUK1Z,EAAI,EAAGgM,EAAO1K,EAAO3B,OAAQK,EAAIgM,EAAMhM,IAC5C,GAAqB,YAAjBsB,EAAOtB,GAAG,GAAkB,CAE5B,GADAyD,GAAS4B,MAAO/D,EAAOtB,GAAG,GAAIgF,MAAO1D,EAAOtB,GAAG,IACtB,iBAArBsB,EAAOtB,EAAI,GAAG,GAAuB,CAMrC,IALAyD,EAAKyF,SAAWlK,KAAK4Z,YAAYtX,EAAOtB,EAAI,GAAG,GAAG8M,QAAQ,KAAM,IAAKxL,EAAOtB,EAAI,GAAG,IACnFkJ,EAAW5H,EAAOtB,EAAI,GAAG,GAEzB4N,IADA5N,EACQ,EACR6N,EAAO7B,EACF4B,EAAI5N,EAAI,EAAG4N,EAAIC,EAAMD,IAAK,CAC3B,GAAqB,UAAjBtM,EAAOsM,GAAG,GAAgB,CAC1B5N,EAAI4N,CACJ,OAGiB,SAAb1E,GAAwC,WAAjB5H,EAAOsM,GAAG,IACjCnK,EAAKY,MAAQ/C,EAAOsM,GAAG,GAAGd,QAAQ,KAAM,IAAIA,QAAQ,KAAM,IAC1DrJ,EAAKU,KAAO,UAGS,WAAjB7C,EAAOsM,GAAG,GACV6L,EAAOxQ,KAAK0Q,OAAOrY,EAAOsM,GAAG,KAEP,WAAjBtM,EAAOsM,GAAG,IACf8L,EAAOzQ,KAAK3H,EAAOsM,GAAG,GAAGd,QAAQ,KAAM,KAKtC,SAAb5D,IACyB,WAArB5H,EAAOsM,EAAI,GAAG,IACdnK,EAAKY,MAAQoV,EACbhW,EAAKU,KAAO,WAEc,WAArB7C,EAAOsM,EAAI,GAAG,KACnBnK,EAAKY,MAAQqV,EACbjW,EAAKU,KAAO,eAIM,cAArB7C,EAAOtB,EAAI,GAAG,KACnByD,EAAKyF,SAAWlK,KAAK4Z,YAAYtX,EAAOtB,EAAI,GAAG,GAAIsB,EAAOtB,EAAI,GAAG,IACxC,WAArBsB,EAAOtB,EAAI,GAAG,IACdyD,EAAKU,KAAO,UACZV,EAAKY,MAAQsV,OAAOrY,EAAOtB,EAAI,GAAG,MAGlCyD,EAAKU,KAAO,SACZV,EAAKY,MAAQ/C,EAAOtB,EAAI,GAAG,GAAG8M,QAAQ,KAAM,KAGpDnJ,GAAMA,MAAMsF,KAAKxF,OAEhB,CAAA,GAAqB,SAAjBnC,EAAOtB,GAAG,GAAe,CAM9B,IALAmZ,GAAazV,UAAW,GAAIC,UAC5B3E,KAAKsC,OAASA,EAAOuU,OAAO7V,EAAI,EAAGgM,GAAQhM,EAAI,IAC/CwZ,EAAW,EAEXH,EAAO1V,EAAMA,MAAMhE,OACdyZ,EAAI,EAAGA,EAAIC,EAAMD,IACdzV,EAAMA,MAAMyV,GAAGzV,OACf6V,GAMR,OAHAjW,GAAU0F,KAAKuQ,GACf7V,EAAMA,MAAMsF,KAAKkQ,GACjBA,EAAWna,KAAKiZ,cAAcjZ,KAAKsC,OAAQ6X,EAAU5V,GAC9CI,EAEN,GAAqB,eAAjBrC,EAAOtB,GAAG,GACf2D,EAAMD,UAAYpC,EAAOtB,GAAG,OAE3B,IAAqB,UAAjBsB,EAAOtB,GAAG,GAAgB,CAM/B,IALAhB,KAAKsC,OAASA,EAAOuU,OAAO7V,EAAI,EAAGgM,GAAQhM,EAAI,IAE/CuD,EAAUqW,MACVjW,EAAQ3E,KAAKyE,KACb8V,EAAOhW,EAAU5D,OACZ2Z,EAAI,EAAGA,EAAIC,EAAMD,IAClB3V,EAAQ3E,KAAKgK,eAAezF,EAAU+V,GAAI3V,EAAa,IAAN2V,EAErD,OAAOta,MAAKiZ,cAAcjZ,KAAKsC,OAAQqC,EAAOJ,IAGtD,MAAOI,IAEXvE,GACIya,WACDhZ,EAAa3B,UAAW,cAAW,IACtCE,GACIya,WACDhZ,EAAa3B,UAAW,4BAAyB,IACpDE,GACIya,WACDhZ,EAAa3B,UAAW,wBAAqB,IAChDE,GACIya,WACDhZ,EAAa3B,UAAW,2BAAwB,IACnDE,GACIya,WACDhZ,EAAa3B,UAAW,wBAAqB,IAChDE,GACIya,WACDhZ,EAAa3B,UAAW,uBAAoB,IAC/CE,GACIya,WACDhZ,EAAa3B,UAAW,mBAAgB,IAC3CE,GACIya,WACDhZ,EAAa3B,UAAW,mBAAgB,IAC3CE,GACIya,WACDhZ,EAAa3B,UAAW,sBAAmB,IAC9CE,GACIya,WACDhZ,EAAa3B,UAAW,kBAAe,IAC1CE,GACIya,WACDhZ,EAAa3B,UAAW,iBAAc,IACzCE,GACIya,WACDhZ,EAAa3B,UAAW,kBAAe,IAC1CE,GACIya,WACDhZ,EAAa3B,UAAW,iBAAc,IACzCE,GACIoB,WAASI,IACVC,EAAa3B,UAAW,kBAAe,IAC1CE,GACIoB,YAAS,IACVK,EAAa3B,UAAW,kBAAe,IAC1CE,GACIoB,YAAS,IACVK,EAAa3B,UAAW,sBAAmB,IAC9CE,GACIoB,gBACDK,EAAa3B,UAAW,cAAW,IACtCE,GACIoB,WAAS,KACVK,EAAa3B,UAAW,eAAY,IACvCE,GACIoB,gBACDK,EAAa3B,UAAW,iBAAc,IACzCE,GACIoB,WAAS,eACVK,EAAa3B,UAAW,kBAAe,IAC1CE,GACIoB,YAAS,IACVK,EAAa3B,UAAW,gBAAa,IACxCE,GACIoB,YAAS,IACVK,EAAa3B,UAAW,wBAAqB,IAChDE,GACIoB,WAAS,YACVK,EAAa3B,UAAW,oBAAiB,IAC5CE,GACIoB,WAAS,IACVK,EAAa3B,UAAW,oBAAiB,IAC5CE,GACIoB,WAAS,SACVK,EAAa3B,UAAW,aAAU,IACrCE,GACIoB,WAAS,SACVK,EAAa3B,UAAW,YAAS,IACpCE,GACI0a,WAAUpW,UAAW,MAAOC,UAAahD,IAC1CE,EAAa3B,UAAW,WAAQ,IACnC2B,EAAezB,GACX2a,yBACDlZ,IAELmZ"}